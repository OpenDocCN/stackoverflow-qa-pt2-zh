# StackOverflow 问答 13622000-13622999

# php - 有没有办法访问以前创建的 div？

> ID：13622002
> 
> 赞同：0
> 
> 时间：2012-11-29T08:55:26.940
> 
> 标签：php, mysql

我正在使用 php 创建具有动态名称的 div，例如：

```
echo "<div class=\"".$row['country']."\">" 
```

因此，它将首先创建一系列 div，例如...

```
<div class="America">
   //stuff goes in here
</div>

<div class="Germany">
   //stuff goes in here
</div>

<div class="Singapore">
   //stuff goes in here
</div> 
```

但是稍后在“Germany”div 已经创建后的代码中，我将对另一个表进行另一个 mysql 查询，并且我想访问“Ge​​rmany”类并在其中添加内容。然后它变成了......

```
 <div class="Germany">
    <p> Germany has x number of people </p>
    <p> The most popular car in Germany is x </p>
</div> 
```

我知道 Jquery 有 append() 函数。PHP中是否有类似的东西我可以访问已经创建的div并向其中添加内容？

注意：所有这些都在一个 php 文件中，该文件会在页面加载时加载所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T08:58:53.383

可以办到。您可以使用输出缓冲来捕获所有输出。然后，您可以使用 HTML DOM 解析器来修改该输出。之后，您可以冲洗该批次。

但这只会工作一次，并且会严重减慢您的脚本速度。不要这样做，它闻起来很糟糕的设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T08:57:11.303

您最好的选择是创建多个变量，例如

```
$css['America'];
$css['Germany'];
$general_output; 
```

等等，并且在您构建站点时，只需将信息添加到所需的变量即可。

一旦你到达页面的末尾，以正确的顺序打印它们，你就完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T08:58:10.123

如果您真的需要重新访问该元素，您可能正在寻找[DOM 函数](http://php.net/manual/en/book.dom.php)或[phpQuery](https://code.google.com/p/phpquery/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:05:34.977

我认为你可以创建一个像

```
$div["Amereica"] = "America" 
```

将来您可以将值附加到此数组。例如。

```
$div["Amereica"] .= 'text to append'; 
```

最后，您可以使用 implode 函数或使用其他数组函数来创建最终的 html。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T09:09:30.370

简单的答案是否定的。

您无法更改 PHP 生成的 HTML 代码，因为该代码已经发送到浏览器，并且 PHP 在服务器端运行。

复杂的答案之一是@GolezTrol 答案。

# batch-file - 批处理文件帮助更改文本文件

> ID：13622006
> 
> 赞同：-2
> 
> 时间：2012-11-29T08:55:49.307
> 
> 标签：batch-file

我有一个庞大的电子邮件列表——大约 8,000 封。

它们目前采用长列表格式。

例如。

```
someone@website.com
someone2@website.com 
```

电子邮件发送程序要求它们采用以下格式。

```
Company
E-mail: someone@website.com

Company
E-mail: someone2@website.com 
```

它需要有公司，然后是电子邮件：，然后是一个空白行，然后再进入下一行。

任何人都可以帮助处理批处理文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:21:34.423

```
@echo off
for /f %%a in (textfile.txt) do (
echo Company
echo Email: %%a
echo.
) >>temp.txt
del textfile.txt /f /q
ren temp.txt textfile.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:23:10.333

```
@Echo OFF

For /F "Tokens=*" %%# in ('Type "File.txt"') Do (
    (
      Echo Company
      Echo E-mail: %%#
      Echo+
    ) >> ".\Output.txt"
)

Pause&Exit 
```

# iphone - 从相机拍摄图像后裁剪图像

> ID：13622007
> 
> 赞同：1
> 
> 时间：2012-11-29T08:55:54.850
> 
> 标签：iphone, objective-c, ios

我的问题是我想在我的 PocketWallet 应用程序中添加裁剪图像功能。我想从相机拍摄图像并将其保存在 ImageView 之后，我想裁剪该图像。我已经阅读了许多类似的问题，但不幸的是没有找到所需的答案。

请告诉我如何使用从相机拍摄的确切图像大小更改图像视图大小。

我正在使用 uiview 来裁剪图像的特定部分。但是当我裁剪图像时，没有得到我想要裁剪的确切部分。我裁剪的图像代码如下，

```
-(UIImage *)cropImage{
    float tempx=CGRectGetMinX(cropedAngle.frame);
    float tempy=CGRectGetMinY(cropedAngle.frame);

   CGRect rect=CGRectMake(tempx, tempy, 320, 200);

    CGImageRef image = [imgView.image CGImage];

    CGImageRef imageRef = CGImageCreateWithImageInRect(image,rect);
    UIImage *imge = [UIImage imageWithCGImage:imageRef];
    CGImageRelease(imageRef);
    // Create and show the new image from bitmap
    return imge;
} 
```

首先告诉我的逻辑是否正确裁剪图像？其中这个代码croppedAngle 是我用来裁剪图像特定部分的uiview。

我哪里错了？

# sqlite - 传递 Listview OnClick 以从数据库中获取数据

> ID：13622010
> 
> 赞同：0
> 
> 时间：2012-11-29T08:56:12.290
> 
> 标签：sqlite, listview

我有一个 ListView，它显示静态数据和图像（比如 Activity A）。当我单击 ListVoew 项目时，数据被捕获并传递到下一个活动（我们称之为活动 B）。在活动 B 中，我想将选定的值传递到 DB select where 子句并获取数据并显示与选择有关的相关信息。这是我的代码片段...

**活动一**：

```
String subproduct = ((TextView) view.findViewById(R.id.product_label)).getText().toString();
                      // Launching new Activity on selecting single List Item

                      SharedPreferences sharedPreferences = getSharedPreferences("pref",MODE_WORLD_READABLE);
                      SharedPreferences.Editor editor = sharedPreferences.edit();
                      editor.clear();
                      editor.putString("subproduct", subproduct);
                      editor.commit();
                      Intent myIntent = new Intent(getApplicationContext(),Details.class);                 
                      startActivity(myIntent); 
```

这是我的**活动 B**：`enter code here`

```
public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        this.setContentView(R.layout.details1);

SharedPreferences myPrefs = this.getSharedPreferences("pref", MODE_WORLD_READABLE); 
String subproduct = myPrefs.getString("subproduct","null");     
TextView txtProduct1 = (TextView) findViewById(R.id.detail_item);
txtProduct1.setText(subproduct); 
```

这是我的**DBHelper.java**。在这里，我想传递选定的值。请帮助我如何实现这一目标...

```
public Cursor getData(){
        //SharedPreferences myPrefs = this.getSharedPreferences("pref", 0);
        //String subproduct = myPrefs.getString("subproduct","null");
        Cursor c = myDataBase.rawQuery("SELECT * FROM Destmain WHERE destname= " + ? + " ", null);
        while (c.moveToNext()){
            DestInfo q = new DestInfo();
            q.setDestination(c.getString(1));
            q.setCity(c.getString(2));
            q.setCountry(c.getString(3));
            q.setPeriod(c.getString(4));
            q.setType(c.getString(5));
            q.setCurrency(c.getString(6));
            q.setBriefhistory(c.getString(7));
            q.setHighlights(c.getString(8));

        }
        c.close();
        return c; 
```

谁能帮助我如何将 ListView (Activity A) 选择的值传递给获取 DB 数据并在 Activity B 中显示？万分感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T11:43:23.853

By using method `onItemcClick` in Activity A you can get the Id and pass it to the second Activity B.

```
onItemClick(AdapterView<?> adapterView, View view, int pos, long id)
newActivity.putExtra("key", id); 
```

then in Activity B you can use this Id to search on the Database.

```
Intent newActivity = getIntent();
long id = newActivity.getLongExtras("key", -1); 
```

in some other case you can use `getLunchDetails` method

# android - 如果未安装条形码阅读器应用程序，则条形码扫描不起作用

> ID：13622011
> 
> 赞同：2
> 
> 时间：2012-11-29T08:56:18.327
> 
> 标签：android, zxing, barcode-scanner, android-vision

我正在尝试制作一个可以在手机上扫描条形码的应用程序。所以我尝试了下面的代码，但它给了我这个错误

```
11-28 11:18:45.750: E/AndroidRuntime(772): FATAL EXCEPTION: main
11-28 11:18:45.750: E/AndroidRuntime(772): android.content.ActivityNotFoundException: No Activity found to handle Intent { act=com.google.zxing.client.android.SCAN (has extras) }
11-28 11:18:45.750: E/AndroidRuntime(772):  at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1622) 
```

我仍在尝试在我的笔记本电脑上使用模拟器和外接摄像头。所以你能帮帮我吗

这是代码：

```
public class MainActivity extends Activity {
      @Override
      public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        HandleClick hc = new HandleClick();
        findViewById(R.id.butQR).setOnClickListener(hc);
        findViewById(R.id.butProd).setOnClickListener(hc);
        findViewById(R.id.butOther).setOnClickListener(hc);
      }
      private class HandleClick implements OnClickListener{
        public void onClick(View arg0) {

            Intent intent = new Intent("com.google.zxing.client.android.SCAN");
          switch(arg0.getId()){
            case R.id.butQR:
              intent.putExtra("SCAN_MODE", "QR_CODE_MODE");
            break;
            case R.id.butProd:
              intent.putExtra("SCAN_MODE", "PRODUCT_MODE");
            break;
            case R.id.butOther:
              intent.putExtra("SCAN_FORMATS", "CODE_39,CODE_93,CODE_128,DATA_MATRIX,ITF,CODABAR");
            break;
          }
          startActivityForResult(intent, 0);    //Barcode Scanner to scan for us
        }
      }
      public void onActivityResult(int requestCode, int resultCode, Intent intent) {
        if (requestCode == 0) {
          TextView tvStatus=(TextView)findViewById(R.id.tvStatus);
          TextView tvResult=(TextView)findViewById(R.id.tvResult);
          if (resultCode == RESULT_OK) {
            tvStatus.setText(intent.getStringExtra("SCAN_RESULT_FORMAT"));
            tvResult.setText(intent.getStringExtra("SCAN_RESULT"));
          } else if (resultCode == RESULT_CANCELED) {
            tvStatus.setText("Press a button to start a scan.");
            tvResult.setText("Scan cancelled.");
          }
        }
      }
    } 
```

这是清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="sdk.example.test"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-permission android:name="android.permission.INTERNET" />

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" 
        >
        <activity
            android:name="sdk.example.test.MainActivity"
            android:label="@string/app_name" >

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:00:23.610

您的手机上没有安装读取条形码的应用程序先安装此应用程序。

[点击这里](https://play.google.com/store/apps/details?id=com.google.zxing.client.androidtest&hl=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:04:06.773

您需要使用[ScanningViaIntent](http://code.google.com/p/zxing/wiki/ScanningViaIntent)它处理所有事情。很好 ：）

# c# - 在Repeater中呈现自定义复合控件的子控件

> ID：13622013
> 
> 赞同：1
> 
> 时间：2012-11-29T08:56:19.263
> 
> 标签：c#, asp.net

我有一个从该类派生的自定义控件`CompositeControl`，定义为：

```
[ToolboxData("<{0}:ContractControl runat=server></{0}:ContractControl>")]
public class ContractControl : CompositeControl
{
    private int contractID = 0;
    private ContractTileControl tileControl = null;
    private ContractDetailControl detailControl = null;

    private HtmlGenericControl contractMainDiv = null;

    public int ContractID
    {
        get { return this.contractID; }
        set { this.contractID = value; }
    }

    public ContractTileControl TileControl
    {
        get { return this.tileControl; }
        set { this.tileControl = value; }
    }

    public ContractDetailControl DetailControl
    {
        get { return this.detailControl; }
        set { this.detailControl = value; }
    }

    public ContractControl()
    {
        this.contractMainDiv = new HtmlGenericControl("div");
        this.contractMainDiv.ID = "contractMainDiv";
        this.contractMainDiv.Attributes.Add("class", "contractMain");
    }

    #region protected override void OnPreRender(EventArgs e)
    protected override void OnPreRender(EventArgs e)
    {
        base.OnPreRender(e);
        CreateChildControls();
    }
    #endregion

    #region protected override void CreateChildControls()
    protected override void CreateChildControls()
    {
        if (tileControl != null)
        {
            this.contractMainDiv.Controls.Add(tileControl);
        }

        if (detailControl != null)
        {
            this.contractMainDiv.Controls.Add(detailControl);
        }

        this.Controls.Add(contractMainDiv);
    }

    #endregion

} 
```

当我将它们中的一些添加到占位符控件时，它们渲染得很好，但是当我尝试将相同的控件绑定到 a`Repeater`时，子复合控件`tileControl`并且`detailControl`不渲染，只有这样`contractMainDiv`做。

中继器定义为：

```
<asp:Repeater ID="myRepeater" runat="server" EnableTheming="true">
  <HeaderTemplate>
    <table border="0" cellpadding="0" cellspacing="0">
  </HeaderTemplate>

  <ItemTemplate>
    <tr><td><easit:ContractControl ID="contractControl" runat="server" />
    </td></tr>
  </ItemTemplate>

  <FooterTemplate>
    </table>
  </FooterTemplate>
</asp:Repeater> 
```

我通过首先生成 a`List<ContractControl>`然后调用来绑定它：

```
 List<ContractControl> controls = new List<ContractControl>();

 //Generate custom controls for each element in input dictionary

 //Create TileControl and DetailControl

 //Create ContractControl and add it to collection
 ContractControl contractControl = new ContractControl();
 contractControl.ContractID = contract.Contract.Id;
 contractControl.TileControl = tile;
 contractControl.DetailControl = detail;
 controls.Add(contractControl);

 myRepeater.DataSource = controls;
 myRepeater.DataBind(); 
```

然而，结果表包含正确数量的项目，但子 'CompositeControl' 根本没有被渲染，只有`contractMainDiv`显示。

# javascript - Meteor 中的路由

> ID：13622016
> 
> 赞同：17
> 
> 时间：2012-11-29T08:56:24.473
> 
> 标签：javascript, meteor

在 Meteor 中，我使用 Backbone 为我的应用程序中的不同页面提供路由。我目前有一个个人资料和一个管理页面。当我进入个人资料页面时，它会按原样显示，但是当我进入管理页面时，Meteor 会退回到主页。

作为旁注，如果有人对 Meteor 中的页面有更好的模式或最佳实践，请随时分享，因为这非常麻烦。

我使用以下模板来决定要显示的页面：

```
<template name="root">
    {{> navbar}}
    {{#if pageIs "profile"}}
      {{> profile}}
      {{else}}{{#if pageIs "administration"}}
        {{> administration}}
      {{else}}
        {{> main_page}}
      {{/if}}
    {{/if}}
</template> 
```

pageIs方法如下：

```
Template.root.pageIs = function(page){
    console.log(Session.get('page'));
    return page === Session.get('page');
} 
```

我的主干路由器中的以下代码：

```
var ProtonRouter = Backbone.Router.extend({
    routes: {
        "profile": "profile",
        "admin": "administration",
        "administration":"administration"
    },
    profile: function () {
        Session.set('page','profile');
    },
    administration: function (){
        Session.set('page', 'administraion');
    },
    mainPage: function(){
        Session.set('page',null);
    }
}); 
```

pageIs 方法中的日志语句将记录 undefined 几次，然后记录正确的页面，即使在管理时也是如此，但是 Meteor 似乎无论如何都不会重新加载选定的页面，并且模板仍然会命中最后一个 else 语句。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-09-13T21:39:16.463

**更新**： Iron 路由器被弃用，取而代之的是 Flow 路由器。有[强烈的迹象表明，未来流路由器将作为核心 Meteor](https://forums.meteor.com/t/iron-router-becoming-incompatible-switch-to-flow-router-or-wait-for-mdg-router/)的一部分得到支持。

> [https://github.com/meteorhacks/flow-router](https://github.com/meteorhacks/flow-router)

**OUTDATED**：以前常用的路由器是 Iron Router：

> [https://github.com/EventedMind/iron-router](https://github.com/EventedMind/iron-router)

在发布时，Iron Router 结合了两个最广泛使用的流星路由器（[meteor-router](https://github.com/tmeasday/meteor-router)和[mini-pages](https://github.com/cmather/meteor-mini-pages)）的作者的努力，并且是流路由器之前 Meteor 的事实上的官方路由器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-29T19:10:33.413

很多人使用这个路线系统：

[https://github.com/tmeasday/meteor-router](https://github.com/tmeasday/meteor-router)

它非常易于使用并且专为 Meteor 制作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-28T07:56:08.983

在 Meteor 的早期，推荐使用 Backbone 进行路由。

Andrew 在他的帖子中指出的路由器，已经成为最受欢迎的选择：[https ://github.com/iron-meteor/iron-router](https://github.com/iron-meteor/iron-router)

一个更简约的解决方案是流路由器：[https ://github.com/meteorhacks/flow-router](https://github.com/meteorhacks/flow-router)

要做出明智的决定使用哪一个，您可以[阅读](https://github.com/meteorhacks/flow-router#difference-with-iron-router)两个路由器的差异。

# android - Android可拖动水平自定义菜单

> ID：13622018
> 
> 赞同：0
> 
> 时间：2012-11-29T08:56:36.987
> 
> 标签：android, android-layout, android-ui

我可以在android中创建自定义水平菜单吗？我的意思是这样的： ![在此处输入图像描述](../Images/88e2814e3651d8b25afa2382d476baa0.png)

我希望能够通过手指选择级别和拖动级别。
我应该使用什么方法？
`LinearLayout`用`android.orientation="horizontal"`, 或其他东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T08:57:51.567

Android`HorizontalScrollView`为此提供了一个。

有关更多信息，请访问[开发人员指南](http://developer.android.com/reference/android/widget/HorizontalScrollView.html)

# syslog-ng - Syslog-ng 日志模板 \\011 字符

> ID：13622023
> 
> 赞同：5
> 
> 时间：2012-11-29T08:56:54.833
> 
> 标签：syslog-ng

我对 syslog-ng 有疑问。我想让 syslog-ng 格式化日志，如下所示：

```
template("$YEAR-$MONTH-$DAY\\011$HOUR:$MIN:$SEC\\011$HOST\\011$MSGHDR$MSGONLY\n") 
```

但它记录没有“\”。只是“011”。例子：

> 预期：2012-11-28\\01116:33:51\\011host_name\\011app_name[26250]：消息
> 
> 发生：2012-11-2801116:33:51011host_name011app_name[26250]：消息

如何做到这一点？有任何想法吗？：） 提前致谢 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T16:11:09.137

`\`模板函数似乎接受转义字符，因此您需要为每个字符添加额外的：

```
template("$YEAR-$MONTH-$DAY\\\\011$HOUR:$MIN:$SEC\\\\011$HOST\\\\011$MSGHDR$MSGONLY\n") 
```

# windows - 如何在 Nodejs 中使用来自 Windows 应用商店的服务器证书

> ID：13622025
> 
> 赞同：11
> 
> 时间：2012-11-29T08:57:04.877
> 
> 标签：windows, node.js, certificate, store

我目前正在实现一个 NodeJS 服务器，它在 Windows 机器上运行。我的要求是为客户端服务器通信启用证书验证。目前，我的代码如下所示，效果很好（请注意，所有客户端都发送了服务器根 CA 证书）。

```
var ssl_options = {
    key: fs.readFileSync(options.key),
    cert: fs.readFileSync(options.cert),
    ca: null        
};

server = https.createServer(ssl_options, function (request, response) {
    // server logic
} 
```

但是，我的要求是使用 Windows 商店中已经存在的证书，如果不从证书中提取私钥，我将无法正确执行此操作。

我尝试使用 Httpsys 模块，它工作正常，但看起来它是一个非常新的模块，尚未正确测试。因此，想知道是否有任何其他替代方法可以直接在 Nodejs 中使用 windows 证书而不提取密钥。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-09T16:42:05.947

您可以查看 npm 模块[https://www.npmjs.com/package/windows-certs](https://www.npmjs.com/package/windows-certs)并在您的应用程序中使用它或重用它的代码。这个想法很简单——你启动你的应用程序，将证书导出到 ram，然后用于 ssl 连接。初始格式转换应该无关紧要。

# android - android：strings.xml 的动态 getString(R.string.report_TJ)

> ID：13622026
> 
> 赞同：0
> 
> 时间：2012-11-29T08:57:10.477
> 
> 标签：android, string, variables

我很抱歉这个主题，但我不知道如何匹配我的问题。

在我的 strings.xml 中，我有不同的语言，例如

```
getString(R.string.report_TJ) 
```

我得到了json数据

```
e.getString("artID") 
```

但我需要这样的东西：

```
getString(R.string.report_TJ_1) 
```

你看，最后 1\. artID = 1

我该怎么做？

我这样尝试：

```
try{
    //String text = getString(R.string.report_TJ);
    JSONArray  earthquakes = json.getJSONArray("uTraf");
    mylist.clear();
    String report_TJ_btn = null;
            for(int i=0;i<earthquakes.length();i++){                        
                HashMap<String, String> map = new HashMap<String, String>();    
                JSONObject e = earthquakes.getJSONObject(i);

                String imageString=report_TJ_btn+e.getString("artID");

                map.put("id",  String.valueOf(i));
                map.put("first", getString(getResources().getIdentifier(imageString, "", getPackageName())) + "Stau: " + e.getString("road") + ", " + e.getString("county"));
                map.put("second", e.getString("timestamp") + ", " + e.getString("suburb"));
                mylist.add(map);            
            }       
  } 
```

出现此错误：11-29 10:40:08.544: W/ResourceType(487): No package identifier when getting value for resource number 0x00000000

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:01:36.433

你可以这样使用

```
String imageString=report_TJ_+e.getString("artID");
getString(getResources().getIdentifier(imageString, "", getPackageName())); 
```

# node.js - 如何更改文本文件编码？

> ID：13622028
> 
> 赞同：-1
> 
> 时间：2012-11-29T08:57:11.663
> 
> 标签：node.js, encoding

我想更改文件编码 utf-8 -> euc-kr。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:00:42.857

使用[`iconv`](http://linux.die.net/man/1/iconv)工具：

```
iconv -f utf-8 -t euc-kr file 
```

[https://github.com/bnoordhuis/node-iconv](https://github.com/bnoordhuis/node-iconv)上有一个 node.js 库，它可以帮助您，而无需借助外部工具。

# mysql - 无法加载 csv 数据

> ID：13622029
> 
> 赞同：1
> 
> 时间：2012-11-29T08:57:12.897
> 
> 标签：mysql

这个脚本

```
DROP TABLE IF EXISTS cmx_siusd_m1;
CREATE TABLE cmx_siusd_m1(trade_date DATETIME, si_open DECIMAL(8,5), si_high DECIMAL(8,5), si_low DECIMAL(8,5), si_close DECIMAL(8,5), si_ticks INT, 

si_oi INT, PRIMARY KEY(trade_date));

LOAD DATA INFILE 'D:/datafolder/cmx_siusd_m1.csv' IGNORE INTO TABLE cmx_siusd_m1 FIELDS TERMINATED BY ','
IGNORE 1 LINES (@trade_date, si_open, si_high, si_low, si_close, si_ticks, si_oi)
SET trade_date = STR_TO_DATE(@trade_date, '%Y.%m.%d %H:%i'); 
```

无法读取此数据

```
2009.04.17 13:45,11.95000,11.97000,11.94000,11.96000,41,0  
2009.04.17 13:46,11.95000,11.97000,11.94000,11.95000,34,0  
2009.04.17 13:47,11.96000,11.97000,11.94000,11.96000,32,0  
2009.04.17 13:48,11.95000,11.97000,11.93000,11.96000,39,0  
2009.04.17 13:49,11.97000,11.98000,11.94000,11.97000,42,0  
2009.04.17 13:50,11.95000,11.98000,11.95000,11.97000,32,0  
2009.04.17 13:51,11.96000,11.98000,11.96000,11.96000,34,0 
```

对于 mysql 中的每个列表，我得到错误不正确的十进制值、不正确的整数值和不正确的日期时间值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:13:13.593

在评论中讨论后 - 你的问题是你的文本文件的格式。在尝试`\r\n`并`\n`终止行后，我们尝试使用 windows 格式创建新文件并且它有效。

所以问题是奇怪的文件格式，未知的行终止。如果您需要使用该文件格式（它来自某些东西并且您不想每次导入都重新编写新文件） - 您可以在 hexeditor 中打开该文件并查看行尾的字符代码。

也许这是`\n\r`（不是`\r\n`）。

# c# - 实体框架与 .NET 4.0 多对多关联

> ID：13622033
> 
> 赞同：2
> 
> 时间：2012-11-29T08:57:23.123
> 
> 标签：c#, .net, database, entity-framework

我是 .NET 和 EF 的新手，我正在开发一个需要动态查询实体的应用程序。我有一个带有 3 个表的数据库：

```
**Employee**      **EmployeeSkills**      **Skill**
Employee_ID       Id                      Skill_ID
Name              Employee_ID             Name
Address           Skill_ID                etc.
etc.              Level 
```

我将从我的客户端发送用于选择的属性名称和带有用于过滤的属性值对的字典，例如 {"name", "skill",[{"skillId="1"},{"level=2"}] } 将返回所有具有 id 1 相关技能和 2 级该技能知识的员工。

我真的需要设计我的实体，使查询尽可能简单，这意味着没有连接或复杂的 sql。我已经设法实现了用于选择和过滤属性的所有内容，但我仍在为多对多关系而苦苦挣扎。

我知道，如果我的中间表只有 Employee_ID 和 Skill_ID 字段，那么我可以使用 Employee.Skills 引用技能。有没有办法使用我当前的表结构来解决这个问题？

我希望有某种映射，例如在 Employee 实体上定义某种导航属性，该属性存储获取具有其级别的员工的所有技能所需的查询。

PS 我使用的是 VS 2012，EF 运行时版本 4.0.3，版本 4.4.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:06:21.100

如果您使用 codefirst 方法，您可以配置与 Fluent API 的关系：

```
HasMany(e => e.Skills).WithMany(s=>s.Employees).Map(se =>
            {
                se.MapLeftKey("Skill_ID");
                se.MapRightKey("Employee_ID");
                se.ToTable("EmployeeSkills");
            }); 
```

**更新**在 DB-First 方法中，您不能在您的情况下配置导航属性。 [这是您可以阅读在您的情况下可以做什么的链接。](http://smehrozalam.wordpress.com/2010/06/29/entity-framework-queries-involving-many-to-many-relationship-tables/)

# azure - UDP 文件上传到 Windows Azure 媒体服务

> ID：13622034
> 
> 赞同：1
> 
> 时间：2012-11-29T08:57:22.967
> 
> 标签：azure

我正在尝试使用 UDP 协议将视频文件上传到 Windows Azure 媒体服务。我还没有找到任何代码示例或文档来让我领先一步。有人可以在这件事上帮助我并提供一些代码示例或文档或概念吗？

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T16:26:17.730

Azure 媒体服务是使用 Azure 作为后端的平台即服务。具体来说，它使用 Azure 存储。如果您使用 .Net 媒体服务 SDK 进行上传，那么您可能不会注意到它正在包装 AzStorage SDK 调用以进行传输。如果您直接使用 REST，您会注意到任何 PUT 调用都直接指向您的存储帐户。在这两种情况下，所有媒体服务都在提供用于上传到后端存储的 SAS URL。

目前，AzStorage 仅支持用于上传的 HTTP PUT。

此外，Azure 最近加入了用于快速上传的第 3 方解决方案，在市场上寻找 Aspera。请注意，这是一项分层订阅服务，可能需要购买客户端软件（与 Amazon S3 相同的模型，以防您进行并排比较）。几个月前，我在我的博客上做了一个完整的演练： [http](http://blog-ndrouin.azurewebsites.net/?p=561) ://blog-ndrouin.azurewebsites.net/?p=561 该博客需要一些维护，因为该服务不再处于预览状态，但是你'会明白的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:23:05.227

媒体服务仍然[是一个预览功能](https://www.windowsazure.com/en-us/home/features/preview/)。UDP 仅[在 RTM 版本](https://www.windowsazure.com/en-us/develop/net/other-resources/windows-azure-media-services-preview-for-developers/)中可用：

> 通过 RTM 版本，媒体服务将提供与合作伙伴组件的集成，以提供快速 UDP（用户数据报协议）上传解决方案。

# c - 如何判断函数参数是否是立即数？

> ID：13622036
> 
> 赞同：3
> 
> 时间：2012-11-29T08:57:24.630
> 
> 标签：c, gcc, ld, gnu-assembler

我有一个包含内联程序集的内联函数定义。我希望根据参数在构建时是否已知这一事实来选择不同的内联汇编实现。

我的问题是如何在 C 代码或内联汇编中询问**地址**值是否在构建时是已知的，因此是否适合立即值。如果您正在考虑 __builtin_constant_p - 请提前阅读。

这是一些说明我的意图的代码：我正在尝试找到一种实现“is_immediate”的方法。

```
static char arr[5];

void __attribute__((always_inline)) do_something(char * buf)
{
   if(is_immediate(buf) {

        // Argument is constant, can use immediate form

        asm volatile ("insn1 %0" : : "i"(buf));

   } else {

        // Argument is computed at runtime, use a register

        unsigned long tmp = (unsigned long)buf + 1;

        asm volatile("insn2 %0" : : "r"(tmp));

}

int main(void) 
{
   do_something(&arr);
} 
```

第一印象 __builtin_constant_p() 似乎正是需要的魔法，但它不起作用。

原因是不起作用的是，虽然在链接器将数组放入内存并为其选择地址之后，数组的地址将是已知的（因此它确实符合内联汇编的直接约束），但它不是在链接之前的**编译**时已知。

所以，我正在寻找的是一种询问方式——“这个变量是否适合作为直接值？” 而不是“这是一个常量表达式吗？”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:45:02.633

如果我看看我的 x86 编译器生成了什么（毕竟这个 insn 没有意义），它就在这里：

```
static char arr[5];

void __attribute__((always_inline)) do_something(char * buf)
{

        // Argument is constant, can use immediate form

        asm volatile ("insn1 %0" : : "r"(buf));

        unsigned long tmp = (unsigned long)buf;

        asm volatile("insn2 %0" : : "r"(tmp));

}

int main(void)
{
   char brr[5];
   do_something(arr);
   do_something(brr);
} 
```

来到

```
 .file   "inl.c"
        .text
.globl do_something
        .type   do_something, @function
do_something:
        pushl   %ebp
        movl    %esp, %ebp
        movl    8(%ebp), %eax
#APP
# 8 "inl.c" 1
        insn1 %eax
# 0 "" 2
# 12 "inl.c" 1
        insn2 %eax
# 0 "" 2
#NO_APP
        popl    %ebp
        ret
        .size   do_something, .-do_something
.globl main
        .type   main, @function
main:
        pushl   %ebp
        movl    $arr, %eax
        movl    %esp, %ebp
        subl    $16, %esp
#APP
# 8 "inl.c" 1
        insn1 %eax
# 0 "" 2
# 12 "inl.c" 1
        insn2 %eax
# 0 "" 2
#NO_APP
        leal    -5(%ebp), %eax
#APP
# 8 "inl.c" 1
        insn1 %eax
# 0 "" 2
# 12 "inl.c" 1
        insn2 %eax
# 0 "" 2
#NO_APP
        leave
        ret
        .size   main, .-main
        .local  arr
        .comm   arr,5,4
        .ident  "GCC: (SUSE Linux) 4.5.1 20101208 [gcc-4_5-branch revision 167585]"
        .section        .comment.SUSE.OPTs,"MS",@progbits,1
        .string "OSpwg"
        .section        .note.GNU-stack,"",@progbits 
```

所以我认为立即可能是有意义的，因为`$arr`可能是立即的（虽然`leal -5(%ebp), %eax`不是）。可能不支持上述优化。

但另一方面，

```
 movl    $arr, %eax
            insn1 %eax 
```

并不比

```
 insn1 $arr 
```

所以它仍然是可以接受的，恕我直言。

# .net - 比较两个数据集并将唯一值放在另一个数据集中

> ID：13622038
> 
> 赞同：1
> 
> 时间：2012-11-29T08:57:34.770
> 
> 标签：.net, dataset

我有两个数据集，一个保存来自 excel 工作表的数据，另一个来自数据库现在我需要比较数据集并将 excel 网格中的唯一值放置到另一个数据集中

# svg - 为什么我在尝试使用 D3.js 绘制地图时会得到一系列 NAN？

> ID：13622040
> 
> 赞同：0
> 
> 时间：2012-11-29T08:57:38.580
> 
> 标签：svg, maps, d3.js, gis, geojson

我正在尝试使用 GeoJSON 使用 d3.js 绘制地图，但生成的路径如下所示：

```
<path d="MNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,‌​NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,N‌​aNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,Na‌​NLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaN‌​LNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNL‌​NaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLN‌​aN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNLNaN,NaNZ"> 
```

代码和数据在这个 Gist 中： [https ://gist.github.com/4157853](https://gist.github.com/4157853)

我可以在 QGIS 上很好地加载数据。

有谁知道是什么原因造成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T18:12:04.977

您在墨卡托投影中指定偏移的方式似乎不正确。projection.translate 方法需要一个二元数组：

[https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-mercator_translate](https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-mercator_translate)

所以而不是：

```
proj.translate(-43.8,-23.2).scale(10); 
```

你需要说：

```
proj.translate([-43.8,-23.2]).scale(10); 
```

- 编辑 -

查看projection.translate的来源：[https ://github.com/mbostock/d3/blob/3.0/src/geo/projection.js#L139](https://github.com/mbostock/d3/blob/3.0/src/geo/projection.js#L139)

```
 projection.translate = function(_) {
    if (!arguments.length) return [x, y];
    x = +_[0];
    y = +_[1];
    return reset();
  }; 
```

如果参数`_`不是数组，则`+_[0]`返回 a `NaN`，因此`x`and`y`将变为`NaN`s。（这是因为试图从一个数字（例如 213[0]）中获取一个元素会返回`undefined`并转换`undefined`为一个数字（例如 +undefined）会产生`NaN`。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T09:14:19.460

如果您在 gist 中发布的代码是您尝试运行的所有内容，那么您显示的数据`data.json`不会在任何地方加载。无论如何，您的`draw`函数正在作用于由变量定义的数据`map`（第 16 行），该`simulation`变量指的是未在任何地方设置的变量。即使是这样，第 34 行也会引用`features`作为 json 传入的对象的属性，而该属性`map`没有。

总之，您需要将您在 gist 中发布的 JSON 传递给您的绘图函数。那么它可能会奏效。如果您不将有效数据传递给 d3 SVG 助手，您将得到一堆`NaN`结果。

# git - 控制 OpenShift 中的源代码访问

> ID：13622041
> 
> 赞同：0
> 
> 时间：2012-11-29T08:57:42.833
> 
> 标签：git, openshift

我有一个在 OpenShift 上运行的 drupal 站点。我可以使用 ssh 访问源代码。我怎样才能让开发团队中的其他人访问源代码的特定部分，而不能分叉整个项目。如果不是，我如何访问类似于 bitbucket 或 github 的 openshift 的 git gui？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:10:40.490

我不知道 OpenShift 是如何工作的，但您可能可以选择添加协作者。如果没有，您可以使用您的代码创建 GitHub 组，然后将您的协作者添加到该组中并具有写入权限。然后他们可以直接推送到这个仓库，而无需分叉和发送拉取请求。

# dialog - KNOCKOUT - 重用 jqm 对话框来更新不同的元素

> ID：13622043
> 
> 赞同：0
> 
> 时间：2012-11-29T08:57:46.063
> 
> 标签：dialog, knockout.js

我有这个问题。我在 jquery mobile 上运行了一个对话框。使用此对话框，我执行搜索，如果搜索通过淘汰赛成功，我将更新我的视图模型。问题是我会重用对话框来更新具有相同 json 结构但放置在我的 vm 中不同位置的项目（换句话说，我不会为相同类型的对象创建特定的函数和特定的搜索对话框，但总是使用相同，并在运行时更新正确/当前项目）。我的想法是在打开对话框时传递当前元素的上下文以更新，但我没有成功。

这可能吗。执行此操作的最佳做​​法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:19:37.530

# c - Ms-Dos 的 C99 编译器？

> ID：13622044
> 
> 赞同：3
> 
> 时间：2012-11-29T08:57:46.843
> 
> 标签：c, dos

是否有支持某些 C99 功能的 ms-dos 的 c 编译器？我无法搜索可以在我的系统上运行的最新编译器。实际上，当我不在家且无法访问互联网时，我需要通过 Dos Box 在我的 Playbook 上安装一个编译器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:06:42.033

这个编译器应该在 MSDOS 上工作（gcc 适配）

[http://personal.ee.surrey.ac.uk/Personal/R.Bowden/C/dos-gcc/index.htm](http://personal.ee.surrey.ac.uk/Personal/R.Bowden/C/dos-gcc/index.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-13T16:12:57.337

[CC386](http://ladsoft.tripod.com/cc386_compiler.html)支持 C99。但它需要一个386。

# javascript - Dojo 1.8 过滤选择自动建议功能在 IE 8 中给出符号

> ID：13622050
> 
> 赞同：0
> 
> 时间：2012-11-29T08:57:57.710
> 
> 标签：javascript, dojox.grid, dojo

以下是 IE 8 中 DOJO 1.8 自动建议的行为

[http://dojotoolkit.org/reference-guide/1.8/dijit/form/FilteringSelect.html](http://dojotoolkit.org/reference-guide/1.8/dijit/form/FilteringSelect.html)

它在 IE8 中的文本之间显示特殊字符。检查上面的链接以查看确切的行为。

我想问题出在最新的 DOJO 版本上，请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:23:45.353

FilteringSelect 使用 unicode 注释字符来突出显示建议的匹配部分。我在这里看到了同样的事情，所以我猜 IE 在渲染它们时遇到了问题，并且它通过了 dojo 测试。

不知道如何修复它，但作为临时措施，您可以将 FilteringSelect 的“highlightMatch”设置为“none”。

编辑：这似乎是与构建工具/shrinksafe 相关的已知错误：http: [//bugs.dojotoolkit.org/ticket/15969](http://bugs.dojotoolkit.org/ticket/15969)

# objective-c - 无法创建唯一的 NSNumber 数组 - iOS

> ID：13622051
> 
> 赞同：0
> 
> 时间：2012-11-29T08:57:58.903
> 
> 标签：objective-c, ios

我在一些关于制作独特数组的 SO 线程上阅读，不幸的是，它对我不起作用。

背景资料 -

*   我有一个 objectArray，里面有 20 个对象。
*   带有字段 NSNumber * number 的 NSObject sampleData；
*   maxCount 是一个 int，用户可以输入他们想要的随机数。
*   下面是我在 Xcode 中的代码和调用函数的返回

.m

```
-(IBAction) testButton
{
[self chooseNumber];
}

-(void)chooseNumber
{
    maxCount = [numberOfClues.text intValue];
   // NSInteger rdmNumber = arc4random()%objectArray.count;

    int count = 0;
    do {

        NSInteger rdmNumber = arc4random()%objectArray.count;
        if (![dataArray containsObject:[NSNumber numberWithInt:rdmNumber]])
        {
            currentData.number = [NSNumber numberWithInt:rdmNumber];
            [dataArray addObject:currentData];
            currentData=nil;
            currentData= [[sampleData alloc]init];
            count++;    
            NSLog(@"random no - %d",rdmNumber);
        }
    } while (count < maxCount);
    NSLog(@"Array got %d numbers",dataArray.count);
} 
```

从 NSLog 返回值

```
2012-11-29 08:26:50.888 randomNumbers[1255:11303] random no - 5
2012-11-29 08:26:50.892 randomNumbers[1255:11303] random no - 8
2012-11-29 08:26:50.926 randomNumbers[1255:11303] random no - 5
2012-11-29 08:26:50.930 randomNumbers[1255:11303] random no - 10
2012-11-29 08:26:50.933 randomNumbers[1255:11303] random no - 4
2012-11-29 08:26:50.946 randomNumbers[1255:11303] random no - 10
2012-11-29 08:26:50.949 randomNumbers[1255:11303] random no - 9
2012-11-29 08:26:50.952 randomNumbers[1255:11303] random no - 12
2012-11-29 08:26:50.955 randomNumbers[1255:11303] random no - 0
2012-11-29 08:26:50.957 randomNumbers[1255:11303] random no - 15
2012-11-29 08:26:50.960 randomNumbers[1255:11303] random no - 1
2012-11-29 08:26:50.963 randomNumbers[1255:11303] random no - 8
2012-11-29 08:26:50.964 randomNumbers[1255:11303] random no - 18
2012-11-29 08:26:50.966 randomNumbers[1255:11303] random no - 14
2012-11-29 08:26:50.968 randomNumbers[1255:11303] random no - 12
2012-11-29 08:26:50.977 randomNumbers[1255:11303] random no - 14
2012-11-29 08:26:50.980 randomNumbers[1255:11303] random no - 3
2012-11-29 08:26:50.983 randomNumbers[1255:11303] random no - 6
2012-11-29 08:26:50.986 randomNumbers[1255:11303] random no - 15
2012-11-29 08:26:50.989 randomNumbers[1255:11303] random no - 7
2012-11-29 08:26:50.992 randomNumbers[1255:11303] Array got 20 numbers 
```

如何使数组获得所有唯一编号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:03:24.583

你真的需要一个数组吗？为什么不使用 NSMutableSet？

[从文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableSet_Class/Reference/NSMutableSet.html)：

> NSMutableSet 类声明了一个可变的、无序的不同对象集合的编程接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:05:55.060

问题出在这里

```
if (![dataArray containsObject:[NSNumber numberWithInt:rdmNumber]]) {
     currentData.number = [NSNumber numberWithInt:rdmNumber];
     [dataArray addObject:currentData]; 
```

您正在检查`NSNumber`实例，但没有放入`NSNumber`数组中，而是放入了完全不同的东西（`currentData`）。

如果您需要排序（您真的需要排序吗？）和唯一性，可以使用 和 的组合来提高效率`NSArray`。`NSSet`当然，这只有在您执行大量需要唯一性检查的操作时才会更有效。如果您只想创建一个数组并在不更改的情况下使用它，那么您的实现（使用`[NSArray containsObject:]`会更好。将所有内容抽象到一个特殊的类中始终是一个很好的解决方案：

```
@interface UniqueArray

@property (nonatomic, strong, readonly) NSArray* elements;

- (BOOL)addObject:(id)object;

@end 
```

```
@interface UniqueArray ()

@property (nonatomic, strong, readwrite) NSArray* elements;
@property (nonatomic, strong, readwrite) NSMutableSet* set;

@end

@implementation UniqueArray

- (id)init {
   self = [super init];

   if (!self) {
      return nil;
   }

   self.elements = [NSMutableArray array];
   self.set = [NSMutableSet set];

   return self;
}

- (BOOL)addObject:(id)object {
   if ([self.set containsObject:object]) {
      return NO;
   }

   [self.set addObject:object];
   [(NSMutableArray*) self.elements addObject:object];

   return YES;
}

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:20:15.437

我想这已经被问过了。您可以用数字 1 到 20 填充数组，将数组打乱，然后从打乱的数组中选择前 (n) 个数字。

我在这里回答：[https ://stackoverflow.com/a/12649065/210171](https://stackoverflow.com/a/12649065/210171)

# java - JPA+Hibernate - 实体关系中的循环 - 级联策略

> ID：13622070
> 
> 赞同：10
> 
> 时间：2012-11-29T08:59:02.667
> 
> 标签：java, hibernate, jpa, cascade

我有一组相互连接形成循环的实体，即父实体 P 与两个子实体 C1 和 C2 具有两个一对多关系，并且每个实体与另一个实体具有一对多关系A. 实体 A 实现了这些实体（C1，C2）的关联，并定义了关系的属性（它不仅仅是一个连接表）。所有的关系都可以双向导航。
![领域对象](../Images/7b265671974fafdaf12cb77cc6c3d04c.png)
这个设计产生了以下问题：考虑到您总是在根实体 P 上调用实体管理器操作，应该采用什么级联策略才能使实体 A 可以持久化/合并？A 应该可以从两条路径级联到达吗？

**注意事项：**似乎如果应用程序选择只提供一个级联路径，则可能存在引发 TransientObjectException 的场景。如果它提供了两条路径，那么这些路径必须完成整个循环，例如可以尝试通过 A 保存 C1。

版本：JPA 2.0、Hibernate 核心 4.1.7、hibernate-jpa-2.0-api 1.0.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T18:56:49.150

我可以给你我的 2 美分，对不起，如果我的回答有点长。

如果您有这种级联冲突，可能是因为您的级联方法或域模型没有很好地定义。我会小心地将级联策略推广到整个图或一组不相关的元素。

我的建议是，级联策略应该只应用于紧密联系在一起的数据集，并且是相同类型的，比如 java 世界中的类及其（私有）内部类。母类与其子类之间的关系也应该是排他的（在 UML 中称为非共享关联）。

当然，您可以不这样做（我们都可以是懒惰的），但最终您可能会在单个持久性流（或持久性配置）和业务流之间创建一个耦合网络。您将不得不管理大量异常，并围绕您之前放置的级联策略（保存、更新、删除）执行大量配置逻辑。

极端的方法是有些人可能只想保存一个大根对象。为什么不？其余的“应该继续级联”。但事实上，这可能会严重限制系统的可维护性。此外，在加载、保存和合并大图时，您可能必须管理大图在内存中的状态。

如果您使用 Web 应用程序或任何客户端-服务器应用程序，您的 Web 工作流应该能够在每次请求时保存一组有限的对象，而不必保存根元素中的所有内容。我知道我没有直接回答你的问题。所以让我们回到你的例子：

假设 P 是一家银行，C1 和 C2 是两个客户，A 是一个产品。

我有两个简单的答案：1）每一层都可以单独保存而无需任何级联。但它可以在同一个事务中完成，如果你愿意，也可以在同一个 DAO 中完成。

2）P和C“可以”级联。但是 A 必须保存在不同的工作流程中。

这让我想起了 Peter Coad 的一章，他谈到了“领域驱动分析”：[http ://www.petercoad.com/download/bookpdfs/jmcuch01.pdf](http://www.petercoad.com/download/bookpdfs/jmcuch01.pdf)

本章解释了如何在不同的原型中分离图中的不同对象。事务数据和描述或“事物”之间的持久性工作流不应该相同。这有助于制定更好的级联策略：

```
 The four archetypes of Peter Coad are:
 - Is it a moment or interval? 
 - Is it a role played? 
 - Is it a catalog-entry-like description? 
 - Otherwise, it's a party, place, or thing. 
```

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T12:01:57.047

通常一个好主意是仅在紧密关联中级联，并且仅在**父->子**（或所有者->拥有）方向。在您的情况下，它可能是`P->C1`and `P->C2`。由于`A`没有一个明显的父级，因此应单独保存。这可以像 @etienno 在你的 DAO 中提到的那样在单个事务中与`P`(and `C1`, `C2`) 一起完成。我不知道您的域模型，但甚至可能`A`在概念级别上是一个单独的实体，在这种情况下，单独保存更加合理。

从长远来看，级联到许多不密切相关的对象可能会使整个图在变大时变得难以管理。

在这种情况下，最好问“没有 Hibernate 你会怎么做”这个问题。在您的情况下，您可能会首先保存`P`，然后`C1`，`C2`然后`A`。AFAIK JPA/Hibernate 没有提供任何明确的方式来强制执行这种顺序，所以有些事情必须由您手动完成。

# apache - Interceptor - Apache Axis 下的 Logger

> ID：13622071
> 
> 赞同：2
> 
> 时间：2012-11-29T08:59:05.477
> 
> 标签：apache, logging, soap, axis, interceptor

我已经通过 Axis 1 创建了一个 Web 服务，我打算将它部署在 Tomcat 中。为了让 Web 服务记录收到的 SOAP 消息，我必须调整任何配置/代码吗？

我找到了这个参考：[http](http://wiki.apache.org/ws/FrontPage/Axis/AxisClientConfiguration/ViewSOAPMessages) ://wiki.apache.org/ws/FrontPage/Axis/AxisClientConfiguration/ViewSOAPMessages 但它指的是客户端日志记录，而我需要利用服务器端日志记录。

任何帮助将非常感激。

# forms - Chrome HTML5 字段验证消息在 dom 下消失？

> ID：13622073
> 
> 赞同：1
> 
> 时间：2012-11-29T08:59:07.207
> 
> 标签：forms, html, validation, google-chrome

我正在处理 html5 表单，并且我有一个带有必需属性集的字段。当用户想要提交表单时，chrome 会显示验证消息，即该字段不能为空。奇怪的是，这条消息似乎滑到了其他 html 标记之下。我认为我没有任何可能导致此问题的 CSS 设置。

这是一个错误还是我错过了什么？

[http://www.abload.de/img/errorogbcv.png](http://www.abload.de/img/errorogbcv.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-14T16:47:03.247

由于溢出：隐藏，html5 验证消息被切断/在 dom 下。

# sql - Zend sql注入预防

> ID：13622076
> 
> 赞同：0
> 
> 时间：2012-11-29T08:59:16.483
> 
> 标签：sql, zend-framework, sql-injection

嗨，我有这个基于 ZEND 框架的 Web 应用程序的小代码片段，它不安全，因为“名称”是从发布请求中获取的。是否有标准的 ZEND 方法来防止 $data 中出现特殊符号？就像 $where 有quoteInto。

```
$name = $this->_request->getParam('name');

// update query
$data = array(
    'name' => $name
);
$where = array(
    $users->getDbAdapter()->quoteInto('user_id = ?', $userId),
);
$users->update($data, $where); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:30:21.440

这对于 SQL 注入是安全的。`Zend_Db`将您传递给`update()`的数组视为命名参数的数组，因此这些值会自动转义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:18:52.190

如果有点简洁的话，蒂姆是正确的。:)

Zend_Db 中更新语句中的 $data 数组被分解为绑定参数。您可以在 中找到确切的代码`Zend_Db_Adapter_Abstract`。

涉及许多过程，但数组最终在此语句中结束。

`$set[] = $this->quoteIdentifier($col, true) . ' = ' . $val;`

你的原始数组在哪里`$col => $val`

然后创建 SQL：

```
 $sql = "UPDATE "
         . $this->quoteIdentifier($table, true)
         . ' SET ' . implode(', ', $set)
         . (($where) ? " WHERE $where" : ''); 
```

它看起来对 SQL 注入相当安全。

但是，您始终可以使用`Zend_Filter_Input`并`Zend_Validate`真正`Zend_Filter`清理您的输入值。

# java - 如何判断数据库中的表是否存在？

> ID：13622078
> 
> 赞同：1
> 
> 时间：2012-11-29T08:59:18.890
> 
> 标签：java, mysql, oracle

我正在尝试更新数据库表，表的名称格式是employee_yearName_monthName。因为我想将每个月的数据保存在单独的表中。

现在在月初没有那个月的表。所以我应该创建表格。但问题是如何判断表是否存在？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:02:03.893

`I want to keep each month's data on a separate table`

这是非常糟糕的设计！如果您有**大量**数据（至少在 50-100GB 范围内，大约一亿行），则更喜欢**分区**（--> [Oracle](http://docs.oracle.com/cd/B28359_01/server.111/b32024/partition.htm)，--> [MySQL](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)。如果您没有那么多数据，只需不用担心，将数据存储在一张表中，使用适当的列，并设置适当的索引！

为什么这是一个糟糕的设计？想想这些：

*   您将如何制定查询，例如针对所有用户的年度报告？
*   如果用户有 32 个字符的名字怎么办？您的表名将太长，例如 Oracle 无法处理
*   您如何制定关于一个月中有一半，下一个月有另一周的查询？

**编辑**作为 OP 披露了更多细节

*   您可以重构数据库 - 这需要管理决策。您应该评估与维护当前结构与重构数据库相关的成本，并将其呈现给决策者......
*   在Oracle中，你可以使用[`USER_TABLES`](http://docs.oracle.com/cd/B28359_01/server.111/b28320/statviews_5443.htm)管理表来查询表名：`SELECT * FROM USER_TABLES WHERE TABLE_NAME LIKE 'employeeName%`例如。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:04:18.917

正如其他人所提到的，这不是一个好的设计。但是，如果你想坚持你的设计，你可以使用

```
CREATE TABLE IF NOT EXISTS tablename ( ... ) 
```

# android - ImageView onImageChangedListener Android

> ID：13622081
> 
> 赞同：13
> 
> 时间：2012-11-29T08:59:28.170
> 
> 标签：android, image, imageview, actionlistener

ImageView 上有 onImageChangedListener() 吗？

当图像从 ImageView 更改时，我需要该事件。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-29T09:16:21.327

Android 中没有默认侦听器 .. 但我们可以创建 imagechange 侦听器 .. 复制该类，而不是使用 ImageView 使用 MyImageView..

```
 public class MyImageView extends ImageView {

        private OnImageChangeListiner onImageChangeListiner;

        public MyImageView(Context context) {
            super(context);
        }

        public MyImageView(Context context, AttributeSet attributeSet) {         
            super(context, attributeSet); 
        }

        public void setImageChangeListiner(
                OnImageChangeListiner onImageChangeListiner) {
            this.onImageChangeListiner = onImageChangeListiner;
        }

        @Override
        public void setBackgroundResource(int resid) {
            super.setBackgroundResource(resid);
            if (onImageChangeListiner != null)
                onImageChangeListiner.imageChangedinView(this);
        }

        @Override
        public void setBackgroundDrawable(Drawable background) {
            super.setBackgroundDrawable(background);
            if (onImageChangeListiner != null)
                onImageChangeListiner.imageChangedinView(this);
        }

        public static interface OnImageChangeListiner {
            public void imageChangedinView(ImageView mImageView);
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T09:33:14.437

检查 grepcode 中的 imageview 代码。你不知道它什么时候被改变或重绘。这是因为在你 setImageDrawable() 之后，imageview 会失效。此时，在调用 ondraw 之前，图像不会正确更改。

反正为什么要知道onimagechangedlistener？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-22T07:43:44.037

如果你想从网络加载图像并检查 imageview 的变化，你可以使用 imageView.isAttachedToWindow()。我尝试从网络下载图像并在图像下载并附加到窗口后禁用进度条。采用，

```
 if(imageView.isAttachedToWindow()){ 
            //your code here
          } 
```

# c# - 为什么在字典声明中使用接口？

> ID：13622086
> 
> 赞同：2
> 
> 时间：2012-11-29T08:59:42.350
> 
> 标签：c#, generics, dictionary

我在我们的项目中注意到了这段代码

```
Dictionary<int, IList> someDict = new Dictionary<int, IList>(); 
```

使用接口获取价值的想法是什么？这是否意味着我可以放入每个实现/支持 IList 的列表？例如，我可以将 L`List<int>`和`List<string>`for 值放在字典中吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:02:20.927

它允许您拥有更通用的类型，因此如果您稍后更改类型，重构将变得更容易。

[列表<T> 或 IList<T>](https://stackoverflow.com/questions/400135/c-sharp-listt-or-ilistt)

减少重构工作的最佳方法是尽可能使用 IEnumerable。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:04:48.823

您可以将任何实现`IList`作为值

```
Dictionary<int, IList> someDict = new Dictionary<int, IList>();
someDict[1] = new List<string>() { "Hello", "World" };
someDict[2] = new List<int>() { 42 };
someDict[3] = new int[] { 1, 2, 3 };
someDict[4] = new ArrayList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:02:25.517

是的，你想从一个特殊的类中分离出来，你只是想确保字典中使用的类型提供了 IList 功能。只要您的类型提供此功能，您就可以使用它，包括`List<T>`. 它就像一个确保类型的一组方法/属性的合同

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T09:03:19.917

是的，您可以使用从声明的类型继承的类型。在您的情况下`List<int>`，是从 构建的泛型类型`List<T>`，而后者又继承自`IList`. 因此，是的，您可以`List<int>`在字典中使用。

# c# - 在 C# .Net Compact Framework 中创建文化信息时出现 DateTimeFormat 异常

> ID：13622092
> 
> 赞同：0
> 
> 时间：2012-11-29T09:00:20.480
> 
> 标签：c#, compact-framework

当我尝试`CultureInfo`在我的应用程序中初始化时出现异常。

以下是我正在使用的代码：

```
public void SetLanguage(string cultureCode)
        {
            if (string.IsNullOrEmpty(cultureCode))
            {
                _cultureInfo = new CultureInfo("en");
            }
            else
            {
                _cultureInfo = new CultureInfo(cultureCode);
            }           
        } 
```

我正在尝试为`"no"`文化代码创建文化信息，但`PlateformNotSupported`由于无法创建`CompareCulture`而出现异常，`DateTimeFormat`以下是异常：

```
 System.Globalization.CultureInfo.Check Neutral(CultureInfo culture)         System.Globalization.CultureInfo.get_DateTimeFormat() 
```

这里缺少什么，任何想法都会被应用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:05:47.830

[MSDN](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.createspecificculture.aspx)建议获取支持的文化列表，并尝试从该列表中获取所需的文化。否则使用默认文化。

# javascript - js-yaml - 在 Javascript 中解析 YAML 文件

> ID：13622097
> 
> 赞同：1
> 
> 时间：2012-11-29T09:00:43.350
> 
> 标签：javascript, yaml

我想用Javascript解析以下文件，保存为example.yml：

```
images:
    main   : [tester_tester/dic.jpg]
    red    : [tester_tester/red.jpg]
    blue   : [tester_tester/blue.jpg]
    green  : [tester_tester/green.jpg,tester_tester/green2.jpg]
categories:
    cat1   : [Yes, No]
    cat2   : [Aa,Bb,Cc]
    cat3   : []
    cat4   : [1,2,3,4,5] 
```

我在 js-yaml.min.js 中使用 YAML 解析器，但我只能使用以下方法解析 YAML 字符串：

```
var fake = "images: {red: boat}\ncategories: {cat1 : []}";  
var YAMLfile = jsyaml.load(fake); 
```

然后 YAML 被存储为嵌套对象。我将如何使用这个库来加载和解析 YAML 文件，而不是仅仅给它字符串？在他们的网站[https://github.com/nodeca/js-yaml](https://github.com/nodeca/js-yaml)上，API 说要使用 require 函数，但这不起作用。有什么想法吗？

我本质上是在寻找这里的功能：http: [//nodeca.github.com/js-yaml/](http://nodeca.github.com/js-yaml/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-20T22:24:28.597

该示例将 textarea 的值与 YAML 一起使用。解析它并更新结果元素内容。

这是您正在寻找的真实代码：

```
 /*global window, document, location, CodeMirror, jsyaml, inspect, base64, hasher*/

window.runDemo = function runDemo() {
  'use strict';

  var source, result, initial, permalink, timer1, timer2 = null,
      fallback = document.getElementById('source').value || '';

  var SexyYamlType = new jsyaml.Type('!sexy', {
    kind: 'sequence', // See node kinds in YAML spec: http://www.yaml.org/spec/1.2/spec.html#kind//
    construct: function (data) {
      return data.map(function (string) { return 'sexy ' + string; });
    }
  });

  var SEXY_SCHEMA = jsyaml.Schema.create([ SexyYamlType ]);

  function parse() {
    var str, obj;

    try {
      str = source.getValue();
      obj = jsyaml.load(str, { schema: SEXY_SCHEMA });

      permalink.href = '#yaml=' + base64.encode(str);

      result.setOption('mode', 'javascript');
      result.setValue(inspect(obj, false, 10));
    } catch (err) {
      result.setOption('mode', 'text/plain');
      result.setValue(err.stack || err.message || String(err));
    }
  }

  function updateSource() {
    var yaml;

    if (location.hash && '#yaml=' === location.hash.toString().slice(0,6)) {
      yaml = base64.decode(location.hash.slice(6));
    }

    source.setValue(yaml || fallback);
    parse();
  }

  permalink = document.getElementById('permalink');

  source = CodeMirror.fromTextArea(document.getElementById('source'), {
    mode: 'yaml',
    undoDepth: 1,
    onKeyEvent: function (_, evt) {
      switch (evt.keyCode) {
        case 37:
        case 38:
        case 39:
        case 40:
          return;
      }

      if (evt.type === 'keyup') {
        window.clearTimeout(timer1);
        timer1 = window.setTimeout(parse, 500);

        if (null === timer2) {
          timer2 = setTimeout(function () {
            window.clearTimeout(timer1);
            window.clearTimeout(timer2);
            timer2 = null;
            parse();
          }, 1000);
        }
      }
    }
  });

  result = CodeMirror.fromTextArea(document.getElementById('result'), {
    readOnly: true
  });

  // initial source
  updateSource();

  // start monitor hash change
  hasher.prependHash = '';
  hasher.changed.add(updateSource);
  hasher.initialized.add(updateSource);
  hasher.init();
}; 
```

# node.js - 如何在与 node_modules 不同的文件夹下安装节点模块？

> ID：13622103
> 
> 赞同：1
> 
> 时间：2012-11-29T09:01:14.427
> 
> 标签：node.js, npm

我将所有新模块保存在`npm install MODULE_NAME --save`node_modules 下。有没有办法以不同的名称保存它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:08:10.140

我浏览了 npm 的源代码，我相信答案是否定的，你不能——有几个对“node_modules”字符串的硬编码引用。由于 npm 是 Node 的包管理器，并且 Node 使用该`node_modules`文件夹来加载本地模块，我怀疑这会改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-15T19:10:26.120

常见问题解答很清楚：你不能也永远不能（使用普通的 npm）：

[https://npmjs.org/doc/faq.html](https://npmjs.org/doc/faq.html)

# android - 如何更改android中数据表的文本颜色？

> ID：13622104
> 
> 赞同：2
> 
> 时间：2012-11-29T09:01:15.420
> 
> 标签：android, android-tablelayout

这是我的问题：我从 XML 文件中加载一些数据并将其放入名为 Data Table 的自定义类中。当我在表格布局中打开它（表格布局包含在滚动视图中）时，加载的整个文本都是浅灰色且难以阅读。有没有办法改变显示文本的颜色？

xml 从 ftp 服务器下载并动态加载到 tablelayout 中。

这是自定义类数据表

```
 public class DataTable {

private Vector<String> _columnNames;
private Vector<Vector<String>> _table;
private String _name;

/**
 * 
 */
public DataTable() {
    // TODO Auto-generated constructor stub

    _name = "";

    _columnNames = new Vector<String>(0, 1);
    _table = new Vector<Vector<String>>(0, 1);
}

public void addColumn(String columnName) {
    if (!_columnNames.contains(columnName)) {
        _columnNames.add(columnName);
    }
}

public void addRow() {
    Vector<String> newRow = new Vector<String>(_columnNames.size());
    _table.add(newRow);
}

public void removeRow(int rowIndex) {
    if (rowIndex >= 0 && rowIndex < _table.size()) {
        _table.remove(rowIndex);
    }
}

public String getValue(int rowIndex, int columnIndex) {
    return _table.get(rowIndex).get(columnIndex);
}

public String getValue(int rowIndex, String columnName) {
    return getValue(rowIndex, _columnNames.indexOf(columnName));
}

public void setValue(String value, int rowIndex, int columnIndex) {
    if (rowIndex >= _table.size()) {
        rowIndex = _table.size();
        addRow();
    }

    Vector<String> row = _table.get(rowIndex);
    if (columnIndex >= row.size()) {
        row.add(value);
    } else {
        row.setElementAt(value, columnIndex);
    }
}

public void setValue(String value, int rowIndex, String columnName) {
    addColumn(columnName);
    setValue(value, rowIndex, _columnNames.indexOf(columnName));
}

public int rowCount() {
    return _table.size();
}

public int columnCount() {
    if (_table.size() > 0) {
        return _table.get(0).size();
    } else {
        return 0;
    }
}

public String getName() {
    return _name;
}

public void setName(String tableName) {
    _name = tableName;
}

public String getColumnName(int columnIndex) {
    return _columnNames.get(columnIndex);
}

public Vector<String> getRow(int rowIndex){
    return _table.get(rowIndex);
} 
```

这是 XML 文件

```
<newdataset>
   <view>
     <label>Codice Ispezione</label>
       <value>AD3008STIs</value>
   </view>

   <view>
     <label>Città</label>
     <value>Roma</value>
   </view>

   <view>
     <label>Tipologia Report</label>
     <value>Totale copertura ultimo comune</value>
   </view>

   <view>
     <label>Causale Ispezione</label>
     <value>Programmazione sito estesa</value>
   </view>
 </newdataset> 
```

# linux - 如何在linux中比较两个ls的输出

> ID：13622107
> 
> 赞同：4
> 
> 时间：2012-11-29T09:01:33.753
> 
> 标签：linux, unix, sed, awk

所以这是我无法解决的任务。我有一个包含 .h 文件的目录和一个包含 .i 文件的目录，它们与 .h 文件同名。我只想通过键入命令来获得所有未找到的 .h 文件作为 .i 文件。这不是一个难题，我可以用某种编程语言来做，但我只是好奇它在 cmd 中的样子:)。更具体地说，这里是算法：

*   从 ls *.h 获取不带扩展名的文件名
*   从 ls *.i 获取不带扩展名的文件名
*   比较它们
*   打印 1 中未在 2 中遇到的所有名称

祝你好运！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:09:50.020

```
diff \
  <(ls dir.with.h | sed 's/\.h$//') \
  <(ls dir.with.i | sed 's/\.i$//') \
| grep '$<' \
| cut -c3- 
```

`diff <(ls dir.with.h | sed 's/\.h$//') <(ls dir.with.i | sed 's/\.i$//')`在两个目录上执行`ls`，切断扩展，并比较两个列表。然后`grep '$<'`找到仅在第一个列表中的文件，并`cut -c3-`切断插入的`"< "`字符`diff`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:14:45.370

```
ls ./dir_h/*.h | sed -r -n  's:.*dir_h/([^.]*).h$:dir_i/\1.i:p' | xargs ls 2>&1 | \
grep "No such file or directory" | awk '{print $4}' | sed -n -r 's:dir_i/([^:]*).*:dir_h/\1:p' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:36:43.053

```
ls -1 dir1/*.hh dir2/*.ii | awk -F"/" '{print $NF}' |awk -F"." '{a[$1]++;b[$0]}END{for(i in a)if(a[i]==1 && b[i".hh"]) print i}' 
```

解释：

```
ls -1 dir1/*.hh dir2/*.ii 
```

上面将列出两个目录中的所有文件 *.hh 和 *.ii 文件。

```
awk -F"/" '{print $NF}' 
```

上面将只打印文件名，不包括文件的完整路径。

```
awk -F"." '{a[$1]++;b[$0]}END{for(i in a)if(a[i]==1 && b[i".hh"]) print i}' 
```

上面将创建两个关联数组，一个包含文件名，一个不包含扩展名。如果 hh 和 ii 文件都存在，则关联数组中的值将为 2 如果只有一个文件，则该值将为 1。所以我们需要值为 1 的数组项，它应该是一个头文件 (.hh)。这可以使用在 END 块中完成的 asso..array b 来检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T10:43:25.087

假设 bash 是你的外壳：

```
for file in $( ls dir_with_h/*.h ); do
    name=${file%\.h};         # trim trailing ".h" file extension
    name=${name#dir_with_h/}; # trim leading folder name
    if [ ! -e dir_with_i/${name}.i ]; then
        echo ${name};
    fi
done 
```

毫无疑问，这可以移植到几乎所有其他 shell。我发现这比其他一些方法不那么神秘（尽管这肯定是我的问题），但它*有点*罗嗦。像这样。shell 脚本可能有助于回忆它。

# c# - 对现有对象进行 DTO，而不会丢失其余现有对象数据

> ID：13622109
> 
> 赞同：1
> 
> 时间：2012-11-29T09:01:39.460
> 
> 标签：c#, automapper, dto

考虑 ：

```
class OriginalContact
{
    public int Id{set;get;}
    public string Name{set;get;}
    public string CustomerCode{set;get;}
}

class DTOContact
{
    public int Id{set;get;}
    public string Name{set;get;}
}

OriginalContact originalContact = new OriginalContact
{
    CustomerCode="123";
}

DTOContact dtoContact= new DTOContact
{
    Id=1,
    Name="David"
}

Mapper.Map(dtoContact, originalContact); 
```

在这个映射之后，我失去了**CustomerCode**值

有没有办法在保持原始值的同时进行映射？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:13:26.737

您应该能够在创建地图配置中“忽略”目标值：

```
Mapper.CreateMap<DTOContact,OriginalContact>()
  .ForMember(dest => dest.CustomerCode, options => options.Ignore()); 
```

# iphone - localnotification 不显示为弹出窗口

> ID：13622110
> 
> 赞同：0
> 
> 时间：2012-11-29T09:01:42.787
> 
> 标签：iphone, ios, xcode

我的本地通知显示在通知中心但没有弹出是否有任何原因？有什么设置让它弹出吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:03:29.717

本地通知将与所有其他通知一样显示，您作为开发人员无能为力。

通知的默认设置是将它们显示为屏幕顶部的横幅，而不像以前版本的 iOS 中的警报视图。

只有用户可以在设置应用通知部分设置显示样式。

# android - PreferenceScreen 关闭后更新调用活动？

> ID：13622112
> 
> 赞同：0
> 
> 时间：2012-11-29T09:01:46.767
> 
> 标签：android, preferenceactivity, updating, start-activity

我有一个活动 A，我通过正常的 startActivity 调用 PreferenceAvtivity P。用户可以在那里更新一些设置，在 P 关闭后，活动 A 应该更新自己以获取新设置。

现在我在这里阅读了[如何从首选项屏幕返回到主要活动？](http://www.google.at/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDMQFjAA&url=https://stackoverflow.com/questions/3936536/how-to-return-from-preference-screen-to-main-activity&ei=oyK3UMrKN82AhQekhYGYAg&usg=AFQjCNGKSQLdlHVXVH_h0P2kJx-qtAnTjw)您不应该/不得通过 startActivityForResult 打开首选项，而是在活动 A 中实现 OnSharedPreferenceChangeListener。

我的问题是，活动 A 中的更新任务可能很繁重，当活动 A 监听 PreferenceChanges 时，只要 P 中的某些内容发生更改，它就会更新。

--> 我只需要 A 更新一次，这是在 P 关闭之后。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:04:22.473

简单：阅读活动 A 的 onResume() 中的相关偏好。

编辑：大尼克顺便说一句

# javascript - 检查变量是否不为空

> ID：13622115
> 
> 赞同：1
> 
> 时间：2012-11-29T09:02:03.340
> 
> 标签：javascript

我正在开发一个 CRM 系统，该系统允许我在其界面中编写自定义 HTML 和 JavaScript，并且我可以通过使用哈希值来引用 CRM 变量（例如当前流程状态、日期等）`#variable.variablename#`。因此，我尝试编写以下 JavaScript，但问题是无论三个变量是否存在，都不会显示任何链接：

```
<script type="text/javascript">
if ( #variable.1# != null) {
<div><a href="/Service1.svc/vf/img?imgid=5#variable.1#" >View Page</a></div> }

if ( #variable.2# != null) {
<div><a href="/Service1.svc/vf/img?imgid=5#variable.2#" >View Page</a></div>
}

if ( #variable.3# !=null) {
<div><a href="/Service1.svc/vf/img?imgid=5#variable.3#" >View Page</a></div>
}

</script> 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:04:41.303

我会客串`#variable.1#`（2 和 3）的内容不是有效的 javascript。也许您需要将它们括在引号中，例如`"#variable.1#"`

此外，您需要`document.write`html - 您不能只是将其放在一条线上并期望出现。

```
<script type="text/javascript">
var html = '';
if ( "#variable.1#" != null) {
    html += '<div><a href="/Service1.svc/vf/img?imgid=5#variable.1#" >View Page</a></div>'
}

if ( "#variable.2#" != null) {
    html += '<div><a href="/Service1.svc/vf/img?imgid=5#variable.2#" >View Page</a></div>'
}

if ( "#variable.3#" !=null) {
    html += '<div><a href="/Service1.svc/vf/img?imgid=5#variable.3#" >View Page</a></div>'
}

document.write(html); 
```

此外，考虑使用“查看源代码”（ Firefox 上的`Ctrl`+ `U`）来查看您构建的实际 Javascript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:04:28.397

这些是无效的 JS 语句。要将内容写入文档，请使用`document.write`：

```
document.write('<div><a href="/Service1.svc/vf/img?imgid=5#variable.1#">View Page</a></div>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:04:44.993

尝试将您的 CRM 变量括在单引号中，以便它们在 javascript 中被解释为字符串类型，并用于`document.write`编写 html 内容，如下所示：

```
if ( '#variable.1#' != null) {
   document.write('<div><a href="/Service1.svc/vf/img?imgid=5#variable.1#" >View Page</a></div>');
}
if ( '#variable.2#' != null) {
   document.write('<div><a href="/Service1.svc/vf/img?imgid=5#variable.2#" >View Page</a></div>');
}

if ( '#variable.3#' !=null) {
   document.write('<div><a href="/Service1.svc/vf/img?imgid=5#variable.3#" >View Page</a></div>');
} 
```

# android - SAX Parser android中的连接错误

> ID：13622123
> 
> 赞同：0
> 
> 时间：2012-11-29T09:02:28.413
> 
> 标签：android, xml, xml-parsing, android-listview, concatenation

我在 Sax Parser 中有多个字符串标签的连接问题。我的 Xml 数据看起来（巨大的列表）就像..

```
<Table diffgr:id="Table1" msdata:rowOrder="0">
<ID>213</ID>
<LastName>Sirk</LastName>
<FirstName>Thomas</FirstName>
<Height>6 ft 4 inches</Height>
<HomeTown>Glen St. Mary's</HomeTown>
<TeamName>Blue Devils</TeamName>
<Age>19</Age>
<FullName>1 Thomas Sirk</FullName>
</Table>

<Table diffgr:id="Table2" msdata:rowOrder="1">
<ID>17</ID>
<LastName>Vernon</LastName>
<FirstName>Conner</FirstName>
<Height>6 ft 1 inches</Height>
<HomeTown>Miami Fl</HomeTown>
<TeamName>Blue Devils</TeamName>
<Age>22</Age>
<FullName>2 Conner Vernon</FullName>
 </Table>

<Table diffgr:id="Table3" msdata:rowOrder="2">
<ID>203</ID>
<LastName>Crowder</LastName>
<FirstName>Jamison</FirstName>
<Height>5 ft 9 inches</Height>
<HomeTown>Monroe NC</HomeTown>
<TeamName>Blue Devils</TeamName>
<Age>19</Age>
<FullName>3 Jamison Crowder</FullName>
 </Table> 
```

我在这样的处理程序中使用了这段代码。

```
class MyHandler extends DefaultHandler{

            boolean is_sno=false;
        boolean is_sname=false;
        boolean is_sclass=false;
        boolean is_sphno=false;
        boolean is_semail=false;
        boolean mIsSegment = false;
        int mCurrentIndex = -1;

            @Override
        public void startDocument() throws SAXException {
            // TODO Auto-generated method stub
            super.startDocument();
        }

        @Override
        public void startElement(String uri, String localName, String name,
                Attributes attributes) throws SAXException {
            super.startElement(uri, localName, name, attributes);

             if (localName.equals("Table")) {
                    mCurrentIndex++;
                    al_sno.add("");
                    al_sname.add("");
                    al_sclass.add("");
                            al_sphno.add("");
                            al_semail.add("");
                }

             else if(localName.equals("ID")){
                is_sno=true;
            }
            else if(localName.equals("TeamName")){
                is_sname=true;
            }
            else if(localName.equals("Fullname")){
                is_sclass=true;
            }
            /*else if(localName.equals("HomeTown")){
                is_sphno=true;
            }
            else if(localName.equals("Height")){
                is_semail=true;
            }*/
        }

        @Override
        public void characters(char[] ch, int start, int length)
                throws SAXException {
            // TODO Auto-generated method stub
            super.characters(ch, start, length);
            if(is_sno){
                 al_sno.set(mCurrentIndex, new String(ch, start, length));
            }
            else if (is_sname) {
                if (!mIsSegment) {
                    al_sname.set(mCurrentIndex, new String(ch, start, length));
                } else {
                    al_sname.set(mCurrentIndex,
                            al_sname.get(al_sname.size() - 1)
                                    + new String(ch, start, length));
                }
                mIsSegment = true;
            }
            else if(is_sclass){

            if (!mIsSegment) {
                al_sclass.set(mCurrentIndex, new String(ch, start, length));
            } else {
                al_sclass.set(mCurrentIndex,
                        al_sclass.get(al_sclass.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
            }

        else if(is_sphno){
            if (!mIsSegment) {
                al_sphno.set(mCurrentIndex, new String(ch, start, length));
            } else {
                al_sphno.set(mCurrentIndex,
                        al_sphno.get(al_sphno.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;}
        }
        else if(is_semail){
            if (!mIsSegment) {
                al_semail.set(mCurrentIndex, new String(ch, start, length));
            } else {
                al_semail.set(mCurrentIndex,
                        al_semail.get(al_semail.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;}

        }
        }

        @Override
        public void endElement(String uri, String localName, String name)
                throws SAXException {
            // TODO Auto-generated method stub
            super.endElement(uri, localName, name);

            if(localName.equals("ID")){
                is_sno=false;
            }
            else if(localName.equals("TeamName")){
                is_sname=false;
                 mIsSegment = false;
            }
            else if(localName.equals("Fullname")){
                is_sclass=false;
                            mIsSegment = false;
            }
            else if(localName.equals("HomeTown")){
                is_sphno=false;
                           mIsSegment = false;
            }
            else if(localName.equals("Height")){
                is_semail=false;
                             mIsSegment = false;
            }
        }

        @Override
        public void endDocument() throws SAXException {
            // TODO Auto-generated method stub
            super.endDocument();
        }

    } 
```

我试图在一页中显示团队的玩家列表，但大多数字符串都出现了高度、家乡、全名、团队名称的串联问题。我在这里遵循了一些[代码](https://stackoverflow.com/questions/13578630/listview-data-spliting-into-another-row-after-sax-parsing/13591630#comment18679602_13591630)。它适用于单个字符串而不是多个字符串。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T11:56:57.007

我已经重写了处理程序`SaxParser`：

```
// the Lists of data 
ArrayList<String> mIdList = new ArrayList<String>();
ArrayList<String> mLastNameList = new ArrayList<String>();
ArrayList<String> mFirstNameList = new ArrayList<String>();
ArrayList<String> mHeightList = new ArrayList<String>();
ArrayList<String> mHomeTownList = new ArrayList<String>();
ArrayList<String> mTeamNameList = new ArrayList<String>();
ArrayList<String> mAgeList = new ArrayList<String>();
ArrayList<String> mFullNameList = new ArrayList<String>(); 
```

`MyHandler`班级：

```
class MyHandler extends DefaultHandler {

    private boolean isIDTag = false;
    boolean isLastNameTag = false;
    boolean isFirstNameTag = false;
    boolean isHeightTag = false;
    boolean isHomeTownTag = false;
    boolean isTeamNameTag = false;
    boolean isAgeTag = false;
    boolean isFullNameTag = false;
    boolean mIsSegment = false;
    private int mCurrentIndex = -1;

    @Override
    public void startElement(String uri, String localName, String name,
            Attributes attributes) throws SAXException {
        if (localName.equals("Table")) {
            mCurrentIndex++;
            mIdList.add("");
            mLastNameList.add("");
            mFirstNameList.add("");
            mHeightList.add("");
            mHomeTownList.add("");
            mTeamNameList.add("");
            mAgeList.add("");
            mFullNameList.add("");
        } else if (localName.equals("ID")) {
            isIDTag = true;
        } else if (localName.equals("LastName")) {
            isLastNameTag = true;
        } else if (localName.equals("FirstName")) {
            isFirstNameTag = true;
        } else if (localName.equals("Height")) {
            isHeightTag = true;
        } else if (localName.equals("HomeTown")) {
            isHomeTownTag = true;
        } else if (localName.equals("TeamName")) {
            isTeamNameTag = true;
        } else if (localName.equals("Age")) {
            isAgeTag = true;
        } else if (localName.equals("FullName")) {
            isFullNameTag = true;
        }
    }

    @Override
    public void characters(char[] ch, int start, int length)
            throws SAXException {
        if (isIDTag) {
            // the ID
            mIdList.set(mCurrentIndex, new String(ch, start, length));
        } else if (isLastNameTag) {
            if (!mIsSegment) {
                mLastNameList.set(mCurrentIndex, new String(ch, start,
                        length));
            } else {
                mLastNameList.set(mCurrentIndex,
                        mLastNameList.get(mLastNameList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        } else if (isFirstNameTag) {
            if (!mIsSegment) {
                mFirstNameList.set(mCurrentIndex, new String(ch, start,
                        length));
            } else {
                mFirstNameList.set(mCurrentIndex,
                        mFirstNameList.get(mFirstNameList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        } else if (isHeightTag) {
            if (!mIsSegment) {
                mHeightList.set(mCurrentIndex,
                        new String(ch, start, length));
            } else {
                mHeightList.set(mCurrentIndex,
                        mHeightList.get(mHeightList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        } else if (isHomeTownTag) {
            if (!mIsSegment) {
                mHomeTownList.set(mCurrentIndex, new String(ch, start,
                        length));
            } else {
                mHomeTownList.set(mCurrentIndex,
                        mHomeTownList.get(mHomeTownList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        } else if (isTeamNameTag) {
            if (!mIsSegment) {
                mTeamNameList.set(mCurrentIndex, new String(ch, start,
                        length));
            } else {
                mTeamNameList.set(mCurrentIndex,
                        mTeamNameList.get(mTeamNameList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        } else if (isAgeTag) {
            if (!mIsSegment) {
                mAgeList.set(mCurrentIndex, new String(ch, start, length));
            } else {
                mAgeList.set(mCurrentIndex,
                        mAgeList.get(mAgeList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        } else if (isFullNameTag) {
            if (!mIsSegment) {
                mFullNameList.set(mCurrentIndex, new String(ch, start,
                        length));
            } else {
                mFullNameList.set(mCurrentIndex,
                        mFullNameList.get(mFullNameList.size() - 1)
                                + new String(ch, start, length));
            }
            mIsSegment = true;
        }
    }

    @Override
    public void endElement(String uri, String localName, String name)
            throws SAXException {
        if (localName.equals("ID")) {
            isIDTag = false;
        } else if (localName.equals("LastName")) {
            isLastNameTag = false;
            mIsSegment = false;
        } else if (localName.equals("FirstName")) {
            isFirstNameTag = false;
            mIsSegment = false;
        } else if (localName.equals("Height")) {
            isHeightTag = false;
            mIsSegment = false;
        } else if (localName.equals("HomeTown")) {
            isHomeTownTag = false;
            mIsSegment = false;
        } else if (localName.equals("TeamName")) {
            isTeamNameTag = false;
            mIsSegment = false;
        } else if (localName.equals("Age")) {
            isAgeTag = false;
            mIsSegment = false;
        } else if (localName.equals("FullName")) {
            isFullNameTag = false;
            mIsSegment = false;
        }
    }

} 
```

它现在应该可以工作了。

# android - 错误：android.os.NetworkOnMainThreadException

> ID：13622125
> 
> 赞同：0
> 
> 时间：2012-11-29T09:02:36.387
> 
> 标签：android, android-activity

我在activity的入口处添加了版本检测。并在 onCreate 方法中添加以下代码。

```
new Thread(){
         public void run(){
         try{
         checkToUpdate();
         }
            catch(Exception e) {
            }
         }
            }.run(); 
```

现在它有了一个新线程。但是为什么它有错误：android 4.0中的android.os.NetworkOnMainThreadException？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:05:30.517

它应该是***start()***而不是***run()***

```
new Thread(){
         public void run()
         {
            try{
            checkToUpdate();
         }
            catch(Exception e) {
            }
         }
            }.start(); 
```

并且可能是您没有在清单文件中添加互联网权限

```
<manifest xlmns:android...>
 ...
 <uses-permission android:name="android.permission.INTERNET"></uses-permission>
</manifest> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:05:34.227

您应该调用该`start()`方法。

`run()`在当前线程上调用该方法，而该方法`start()`创建一个新线程并`run()`在新创建的线程上调用该方法。

在早期的 Android 版本中，如果您在主 (UI) 线程上运行长时间操作，您不会立即收到异常，只有在 Dalvik 检测到应用程序几秒钟没有响应之后。现在，如果您尝试在主线程上执行网络通信，则会引发异常，以便您在开发时轻松发现这些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:05:27.137

您需要使用`AsyncTask`，否则`Handler with Thread`您不能再使用主线程来执行网络进程`HONEY COMB`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:12:25.213

长时间运行的任务和网络操作不应该放在 onCreate() 方法上，因为会分配一小段时间来完成 onCreate() 方法（可能 4 秒或更短），你将它移到 onResume() 方法，如果可能的话把它放在 AsyncTask 中。

# css - 检测 css 3d 变换

> ID：13622127
> 
> 赞同：3
> 
> 时间：2012-11-29T09:02:38.867
> 
> 标签：css, 3d, transform

我正在尝试检测浏览器是否支持 3d css 转换。我研究了网上提供的每一个解决方案，但没有一个对我有用，然后我尝试使用 @support css 属性来完成我的工作。它在 Linux 的 chrome 和 firefox 中完美运行，但在 windows 中却没有。

可能是因为我在两个操作系统中都使用 chrome 23 进行了测试，并且根据[https://developer.mozilla.org/en-US/docs/CSS/@supports#Browser_compatibility](https://developer.mozilla.org/en-US/docs/CSS/@supports#Browser_compatibility)中的兼容性表， 只有 chrome 24 支持 @支持规则。

这种方法是否适合检查对 3d 的支持有什么想法吗？我只关心 chrome 23.x 及更高版本和 firefox 18 及更高版本，而不关心任何其他浏览器，

```
 @supports(-webkit-transform: perspective( 1px ) )or
                 (-moz-transform: perspective( 1px) ) or
                 (-o-transform: perspective( 1px) ) or
                 (transform: perspective( 1px) ){

              #supports {
                  display:block;
              }

            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:10:30.223

您可以使用[Modernizr](http://modernizr.com/)：

```
if (Modernizr.csstransforms3d) {
  // CSS 3D Transforms supported
} else {
  // not supported
} 
```

# ios - 截断的推文 iOS

> ID：13622129
> 
> 赞同：1
> 
> 时间：2012-11-29T09:03:00.817
> 
> 标签：ios, json, twitter, truncate, truncated

我在我的应用程序中放置了一个推特提要，无论我尝试做什么来让推文完整显示，我都没有完全成功。大多数推文都显示得很好，但真正让我头疼的是那些很长的推文。我认为这是因为我的 textLabel 中没有足够的行，但我注意到如果用户通过多次按 Enter 拉长了他们的推文，推文会显示得很好。这让我相信它会在一定数量的字符后被截断。我不知道我做错了什么，或者这只是 Twitter 的问题。如果有人可以在我的代码中看到任何错误，或者可以更改以解决此问题，请告诉我。谢谢

```
#import "TwitterFeedTVC.h"
#import "TweetVC.h"
#import <QuartzCore/QuartzCore.h>
#import "GTMNSString+HTML.h"

#define REFRESH_HEADER_HEIGHT 52.0f
#define FONT_SIZE 14.0f
#define CELL_CONTENT_WIDTH 320.0f
#define CELL_CONTENT_MARGIN 10.0f

@implementation TwitterFeedTVC

@synthesize textPull, textRelease, textLoading, refreshHeaderView, refreshLabel, refreshArrow, refreshSpinner, twitterFeedName, twitterFeedTitle;

- (id)initWithStyle:(UITableViewStyle)style {
self = [super initWithStyle:style];
if (self != nil) 
{
    [self setupStrings]; 
}
return self;
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
self = [super initWithCoder:aDecoder];
if (self != nil)
{
    [self setupStrings];
}
return self;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self != nil)
{
    [self setupStrings];
}
return  self;
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
[super viewDidLoad];
self.twitterFeedTitle.text = self.twitterFeedName;
self.navigationItem.title = self.twitterFeedName;

[self fetchTweets];
[self addPullToRefreshHeader];
}

- (void)fetchTweets
{
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"https://api.twitter.com/1/statuses/user_timeline.json?include_rts=true&screen_name=johnnelm9r&count=100"]];

    if (data == nil)
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Warning"
                                                        message:@"Twitter Is Not Responding. Please Try Again Later!"
                                                       delegate:self
                                              cancelButtonTitle:@"Kali Baby" 
                                              otherButtonTitles: nil];

        [alert show];
    }

    else

    {
    NSError *error;

    tweets = [NSJSONSerialization JSONObjectWithData:data
                                             options:kNilOptions
                                               error:&error];
    }

    dispatch_async(dispatch_get_main_queue(), ^{
        [self.tableView reloadData];
    });

});

}

- (void)viewDidUnload
{
[super viewDidUnload];

textPull = nil;
textRelease = nil;
textLoading = nil;
refreshHeaderView = nil;
refreshLabel = nil;
refreshArrow = nil;
refreshSpinner = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
[super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
[super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
[super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
[super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotate
{
return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
return UIInterfaceOrientationMaskPortrait;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
return tweets.count;
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;
{
NSDictionary *tweet = [tweets objectAtIndex:indexPath.row];
NSString *text = [tweet objectForKey:@"text"];

CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), CGFLOAT_MAX);

CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:NSLineBreakByWordWrapping];

CGFloat height = MAX(size.height, 44.0f);

return height + ((CELL_CONTENT_MARGIN * 2) + 9);
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"TweetCell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil)
    {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

NSDictionary *tweet = [tweets objectAtIndex:indexPath.row];

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setFormatterBehavior:NSDateFormatterBehavior10_4];
[dateFormatter setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
[dateFormatter setDateFormat:@"EEE MMM dd HH:mm:ss +0000 yyyy"];

NSDate *currentDate = [dateFormatter dateFromString:[tweet objectForKey:@"created_at"]];
NSDate *todayDate = [NSDate date];
NSString *date = [dateFormatter stringFromDate:currentDate];

double timeInterval = [currentDate timeIntervalSinceDate:todayDate];
timeInterval = timeInterval * -1;
if (timeInterval < 1)
{
    date = @"never";
}
else if (timeInterval <60)
{
    date = @"less than a minute ago";
}
else if (timeInterval <3600)
{
    int diff = round(timeInterval / 60);
    date = [NSString stringWithFormat:@"%d minutes ago", diff];
}
else if (timeInterval < 86400)
{
    int diff = round(timeInterval / 60 / 60);
    date = [NSString stringWithFormat:@"%d hours ago", diff];
}
else if (timeInterval < 2629743)
{
    int diff = round(timeInterval / 60 / 60 / 24);
    date = [NSString stringWithFormat:@"%d days ago", diff];
}
else
{
    date = @"never";
}

cell.textLabel.text = [[tweet objectForKey:@"text"] gtm_stringByUnescapingFromHTML];
cell.detailTextLabel.text = [NSString stringWithFormat:@"%@", date];

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    NSString *imageUrl = [[tweet objectForKey:@"user"] objectForKey:@"profile_image_url"];
    NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:imageUrl]];

    dispatch_async(dispatch_get_main_queue(), ^{
        cell.imageView.image = [UIImage imageWithData:data];
        [cell addSubview:cell.imageView];

    });
});

return cell;
}

- (void)setupStrings
{
textPull = @"Pull Down To Be Fresh...";
textRelease = @"Release To Be Fresh...";
textLoading = @"Getting Loaded...";
}

- (void)addPullToRefreshHeader
{
refreshHeaderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0 - REFRESH_HEADER_HEIGHT, 320, REFRESH_HEADER_HEIGHT)];
refreshHeaderView.backgroundColor = [UIColor clearColor];

refreshLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 320, REFRESH_HEADER_HEIGHT)];
refreshLabel.backgroundColor = [UIColor clearColor];
refreshLabel.font = [UIFont boldSystemFontOfSize:12.0];
refreshLabel.textAlignment = UITextAlignmentCenter;

refreshArrow = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"KrizzOpener.png"]];
refreshArrow.frame = CGRectMake(floorf((REFRESH_HEADER_HEIGHT - 27) / 2),
                                (floorf(REFRESH_HEADER_HEIGHT - 44) / 2),
                                27, 44);

refreshSpinner = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
refreshSpinner.frame = CGRectMake(floorf(floorf(REFRESH_HEADER_HEIGHT - 20) / 2), floorf((REFRESH_HEADER_HEIGHT - 20) / 2), 20, 20);
refreshSpinner.hidesWhenStopped = YES;

[refreshHeaderView addSubview:refreshLabel];
[refreshHeaderView addSubview:refreshArrow];
[refreshHeaderView addSubview:refreshSpinner];
[self.tableView addSubview:refreshHeaderView];

}

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView
{
if (isLoading) return;
isDragging = YES;
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
if (isLoading) {

    if (scrollView.contentOffset.y > 0)
        self.tableView.contentInset = UIEdgeInsetsZero;
    else if (scrollView.contentOffset.y >= -REFRESH_HEADER_HEIGHT)
        self.tableView.contentInset = UIEdgeInsetsMake(-scrollView.contentOffset.y, 0, 0, 0);
} else if (isDragging && scrollView.contentOffset.y < 0) {

    [UIView beginAnimations:nil context:NULL];
    if (scrollView.contentOffset.y < -REFRESH_HEADER_HEIGHT) {

        refreshLabel.text = self.textRelease;
    } else { 
        refreshLabel.text = self.textPull;
    }
    [UIView commitAnimations];
}
}

- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
if (isLoading) return;
isDragging = NO;
if (scrollView.contentOffset.y <= -REFRESH_HEADER_HEIGHT)
{
    [self startLoading];
}
}

- (void)startLoading {
isLoading = YES;

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.3];
self.tableView.contentInset = UIEdgeInsetsMake(REFRESH_HEADER_HEIGHT, 0, 0, 0);
refreshLabel.text = self.textLoading;
refreshArrow.hidden = YES;
[refreshSpinner startAnimating];
[UIView commitAnimations];

[self refresh];
}

- (void)stopLoading {
isLoading = NO;

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDelegate:self];
[UIView setAnimationDuration:0.3];
[UIView setAnimationDidStopSelector:@selector(stopLoadingComplete:finished:context:)];
self.tableView.contentInset = UIEdgeInsetsZero;
UIEdgeInsets tableContentInset = self.tableView.contentInset;
tableContentInset.top = 0.0;
self.tableView.contentInset = tableContentInset;
[UIView commitAnimations];
}

- (void)stopLoadingComplete:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context {

refreshLabel.text = self.textPull;
refreshArrow.hidden = NO;
[refreshSpinner stopAnimating];

}

- (void)refresh {

[self fetchTweets];

[self performSelector:@selector(stopLoading) withObject:nil afterDelay:2.7];
}

#pragma mark - Table view delegate

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
if ([segue.identifier isEqualToString:@"tweetVC"])
{
    NSInteger row = [[self tableView].indexPathForSelectedRow row];
    NSDictionary *tweet = [tweets objectAtIndex:row];

    TweetVC *tweetVC = segue.destinationViewController;
    tweetVC.detailItem = tweet;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T05:06:54.280

经过大量调查后，我在某处发现一篇文章说 text 键和 retweeted_status.text 键之间存在差异。事实上，被截断的推文是用户使用文本键转发的。但是， retweeted_status.text 键只是被转发的推文，没有最初发布推文的用户。这很糟糕，因为 retweeted_status.text 键没有被截断。啊，编程的乐趣。希望新的 twitter API 能够解决这个问题。我希望这个答案对某人有所帮助。

如果有人感兴趣，这是我发现的链接：[http ://code.google.com/p/twitter-api/issues/detail?id=2261](http://code.google.com/p/twitter-api/issues/detail?id=2261)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T09:46:19.610

我没有仔细阅读你的代码，但我想提一下这一点，Twitter 只允许 140 个字符长的推文！这是推文的基本规则。所以无论你用 mode 做什么推文都会被截断超过 140 个字符。

我希望这不是问题？

# google-chrome - PDF 查看器与 Google chrome 中页面上的其他对象重叠

> ID：13622136
> 
> 赞同：0
> 
> 时间：2012-11-29T09:03:20.620
> 
> 标签：google-chrome, pdf, pdf-viewer

我在使用 Google chrome 浏览页面时遇到问题。禁用 Google chrome 插件“Chrome PDF 查看器”后，显示的 PDF 会与每个对象重叠。下面是一个示例代码。

```
<html>
<head>

</head>
<body>
    <div style="border: solid red 2px; position:absolute;z-index:100;background-color:Green;height:100px;width:250px;"></div>

    <div style="position:absolute;z-index:10;margin-left:100px;">
    <iframe visible="true" id="ipdf" src="http://www.irs.gov/pub/irs-pdf/fw4.pdf" height="1000" width="1000" runat="server" frameborder="0" scrolling="auto" >

     </iframe>
     </div>

</body>
</html> 
```

任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T12:21:35.343

你认为它在带有 Adob​​e Reader 插件的 Internet Explorer 中效果更好吗？据我所知，它有同样的问题，你必须使用另一个 iframe 来覆盖区域。

# json - 如何在 jquery 中显示 php json 响应 COUNT(e_u.med_id)

> ID：13622140
> 
> 赞同：0
> 
> 时间：2012-11-29T09:03:31.430
> 
> 标签：json, jquery

`[{"med_name":"Test","COUNT(e_u.med_id)":"3"}]`我正在使用要显示的 jquery ajax从 php 文件中获取 json 响应。如何显示 COUNT(e_u.med_id) 我的 jquery 代码是

```
 $.ajax({
         type:'POST',
         dataType: 'json',
         url:'Myphp.php',
         data:{some-rec: 'test'},
         success:   function(rows){ 
         $('#e_use').empty();
          //alert("test");
         if(rows.success != false){
             $('#t_e_use').show();
             //alert("if");
            var len = rows.length;
            //alert(len);
            for (i = 0; i < len; i++) {
            $('#e_use').append("<tr><td style='color:#FFF'>"+
            rows[i].med_name
            +"</td><td style='color:#FFF'>"+
            COUNT(e_u.med_id)+
            "</td><tr>");
            }
        }
        else{
            $('#e_e_use').show();
        $('#e_e_use').text("No medicines are below the mandatory quantity");
        }
    }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:06:11.870

我建议：

```
rows[i]["COUNT(e_u.med_id)"]; 
```

但这是一个奇怪的变量名！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:04:51.227

试试这个

```
rows[i].COUNT(e_u.med_id) 
```

代替

```
COUNT(e_u.med_id) 
```

**更新**

更改`COUNT(e_u.med_id)`为 `count_emed_id`并将其视为

```
rows[i].count_emed_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:08:51.940

试试这个..但是请更改变量名！

```
+"</td><td style='color:#FFF'>"+
rows[i]['COUNT(e_u.med_id)']+
"</td><tr>"); 
```

# javascript - 将UTC转换为本地时间的Javascript

> ID：13622142
> 
> 赞同：44
> 
> 时间：2012-11-29T09:03:49.293
> 
> 标签：javascript, datetime

好的，说 JSON 解析字符串 UTC 日期如下：

```
2012-11-29 17:00:34 UTC 
```

现在，如果我想将此 UTC 日期转换为我的本地时间，我该怎么做？

如何将其格式化为其他内容`yyyy-MM-dd HH:mm:ss z`？

这`date.toString('yyyy-MM-dd HH:mm:ss z');`永远不会解决：/

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-11-29T09:06:08.113

尝试：

```
var date = new Date('2012-11-29 17:00:34 UTC');
date.toString(); 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-11-29T09:18:23.350

```
var offset = new Date().getTimezoneOffset(); 
```

`offset`将是从本地时间到 UTC 的时间间隔（以分钟为单位）。要从 UTC 日期获取本地时间，您需要从日期中减去分钟数。

```
utc_date.setMinutes(utc_date.getMinutes() - offset); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-02T11:12:56.967

要格式化您的日期，请尝试以下功能：

```
var d = new Date();
var fromatted = d.toLocaleFormat("%d.%m.%Y %H:%M (%a)"); 
```

但这样做的缺点是，它是一个**非标准**函数，在 Chrome 中不起作用，但在 FF (afaik) 中起作用。

克里斯

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-11-10T04:20:23.237

这是另一个输出 mm/dd/yy 的选项：

```
const date = new Date('2012-11-29 17:00:34 UTC');
date.toLocaleString();
//output 11/29/2012 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-21T07:12:06.443

上述解决方案是正确的，但可能会在 FireFox 和 Safari 中崩溃！这就是[webility.js](https://github.com/KhaledElAnsari/webility.js)试图解决的问题。检查`toUTC`功能，它适用于大多数主要浏览器，并以 ISO 格式返回时间

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-09T13:49:49.840

您可以查看**[日期和时间](https://github.com/knowledgecode/date-and-time#api)**api 以轻松进行日期操作。

```
let now = date.format(new Date(), 'YYYY-MM-DD HH:mm:ss', true);
console.log(now);
```

```
<script src="https://cdn.jsdelivr.net/npm/date-and-time/date-and-time.min.js"></script>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-29T09:06:08.187

这应该工作

```
var date = new Date('2012-11-29 17:00:34 UTC');
date.toString() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-21T04:40:13.440

这适用于**Chrome**和**Firefox**。
*未在其他浏览器上测试。*

```
const convertToLocalTime = (dateTime, notStanderdFormat = true) => {
  if (dateTime !== null && dateTime !== undefined) {
    if (notStanderdFormat) {
      // works for 2021-02-21 04:01:19
      // convert to 2021-02-21T04:01:19.000000Z format before convert to local time
      const splited = dateTime.split(" ");
      let convertedDateTime = `${splited[0]}T${splited[1]}.000000Z`;
      const date = new Date(convertedDateTime);
      return date.toString();
    } else {
      // works for 2021-02-20T17:52:45.000000Z or  1613639329186
      const date = new Date(dateTime);
      return date.toString();
    }
  } else {
    return "Unknown";
  }
};

// TEST

console.log(convertToLocalTime('2012-11-29 17:00:34 UTC'));
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-23T16:10:07.090

```
// d = "2021-09-23T15:51:48.31"

console.log(new Date(d + "z").toLocaleDateString());  // gives 9/23/2021

console.log(new Date(d + "z").toLocaleString()); // gives 9/23/2021, 10:51:48 AM
console.log(new Date(d + "z").toLocaleTimeString()); // gives 10:51:48 AM 
```

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2015-01-08T08:30:19.830

```
/*
 * convert server time to local time
 *  simbu
*/
function convertTime(serverdate) {
    var date = new Date(serverdate);
    // convert to utc time
    var toutc = date.toUTCString();
    //convert to local time
    var locdat = new Date(toutc + " UTC");
    return locdat;
} 
```

# c++ - 如何可靠地调用直接父级的虚函数

> ID：13622145
> 
> 赞同：1
> 
> 时间：2012-11-29T09:04:13.367
> 
> 标签：c++, polymorphism, overriding, virtual

考虑这段代码

```
class Base
{
public:
    virtual void print ()
    {
        std::cout << "Base::print" << std::endl;
    }
};

class BaseA : public Base
{
public:
    virtual void print ()
    {
        std::cout << "BaseA::print" << std::endl;
    }
};

class Derived : public Base
{
public:
    virtual void print ()
    {
        Base::print (); // <= this will always call Base::print even if I derive from BaseA
        std::cout << "Derived::print" << std::endl;
    }

};

int main ()
{
    Base* a = new Derived;
    a->print ();
    delete a;
} 
```

From `Derived::print`I call`Base::print`这很好，直到我决定从我那里派生`Derived`，`BaseA`因此我当然想调用`BaseA::print`. 在这个特定示例中更改`Base::print`为`BaseA::print`不是问题，但是如果我有 20 个这样的虚拟函数怎么办？

如何要求编译器调用直接父版本的`print`任何内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:13:05.510

使用 typedef：

```
class Derived: public BaseA {
    typedef BaseA Base;
    ... 
```

[尽管有一些提议（例如http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3326.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3326.pdf)），但目前无法对类的直接基础进行编译时自省。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:21:00.717

您可以尝试使用模板：

```
template <class base>
class test: public base
{
    virtual void testmethod()
    {
        base::testmethod();
    }
}; 
```

然后你可以添加一个typedef：

```
typedef test<myBaseClass> myDerivedClass; 
```

# javascript - 使用媒体查询加载 base64 编码图像

> ID：13622146
> 
> 赞同：0
> 
> 时间：2012-11-29T09:04:14.050
> 
> 标签：javascript, media-queries

我的移动网站上有很多小图片。因此，我将它们加载为用 css 编码的 base64。

```
<link rel="stylesheet" media="max-resolution: 239dpi" href="small-images-base64.css" />
<link rel="stylesheet" media="min-resolution: 240dpi" href="big-images-base64.css" /> 
```

问题是 small-images-base64.css 和 big-images-base64.css 无论如何都会被加载。有没有办法只加载我真正需要的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:37:36.867

只要您链接它们，CSS 就会始终被加载。

一种解决方案是制作更多的 css 文件并根据页面仅加载您需要的文件。

另一个可能是如果您将图像从 CSS 中取出并直接加载到 html 中，就像...

```
<img src="data:image/gif;base64,AAAAAAAA........"/> 
```

# javascript - 如何在jsp中动态显示'✔'

> ID：13622167
> 
> 赞同：1
> 
> 时间：2012-11-29T09:05:31.270
> 
> 标签：javascript, ajax, jsp, thickbox

我正在使用 Unicode 值`"\u2713"` 在一行表中显示 '✔' 一个刻度线（就像 .jsp 中的静态方式），现在我需要动态地显示 '✔' ，每当我在使用请求中单击一个`upload`按钮时。`thickbox``java-script``ajax`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:11:02.847

请先谷歌。

在 HTML 中使用这个`&#10004;`

在 javascript 中使用`write()`

```
document.write('&#10004;'); 
```

或者

```
domDIV.innerHTML = '&#10004;'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:11:35.433

# android - 构建布局的最有效方法

> ID：13622179
> 
> 赞同：1
> 
> 时间：2012-11-29T09:06:07.207
> 
> 标签：android, android-layout

我会有数百个这样的布局（请参见下图），所以我需要以最有效的方式构建它。共有三个区域，两个第一个按底线对齐，左边一个包含`ImageView`，第二个两个`TextView`在另一个下方。在第二个视图下还有另一种视图`TextView`。我应该`TableLayout`用作容器和`LinearLayout`第二个吗？会不会有效率？谢谢你。

![在此处输入图像描述](../Images/e8ca8b64d509f1c1f1f4bc7aa1b89477.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:14:22.047

第一个建议是让 ImageView “更高”，使其在高度上覆盖两个 TextView，或者使底部 TextView 更宽以覆盖 ImageView 和上部 TextView..

在我看来它会更好看，这个空旷的空间让我的眼睛刺痛..

然后我会推荐 TableLayout，当然还有这个布局在单独的文件中，所以你可以用 include.. 重用它；）

干杯，希望它有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:14:38.853

在里面`RelativeLayout`你应该添加`Image View`，`AlignParentLeft="true"`然后`alignParenttop = "true"`添加第一个`TextView`作为`RightOff`imageView 和第二个文本视图将它添加到`LayoutBottom`第一个`TextView`

使用`Relative Layouts`时，它们被认为是从更轻的`Linear Layouts`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:16:21.090

试试这个

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="41dp"
    android:layout_marginTop="39dp"
    android:src="@drawable/ic_launcher" />

<LinearLayout
    android:id="@+id/linearLayout1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignTop="@+id/imageView1"
    android:layout_marginLeft="10dp"
    android:layout_toRightOf="@+id/imageView1"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView 1" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView 2" />
</LinearLayout>

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/linearLayout1"
    android:layout_alignParentBottom="true"
    android:layout_alignParentRight="true"
    android:layout_below="@+id/imageView1"
    android:text="TextView" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:19:49.087

试试这个，它会为您提供您在问题中描述的布局：

```
 <LinearLayout 
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
        android:orientation="horizontal"
        >
        <ImageView 
           android:layout_width="0dp"
           android:layout_height="wrap_content"
           android:layout_weight="1"
           android:src="@drawable/img" />

        <RelativeLayout 
           android:layout_width="0dp"
           android:layout_height="wrap_content"
           android:layout_weight="1">

           <TextView 
              android:id="@+id/txt1"
              android:layout_alignParentTop="true"
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:text="textView1" />

          <TextView 
             android:id="@+id/txt2"
             android:layout_below="@+id/txt1"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:text="textView1" />
       </RelativeLayout>
   </LinearLayout> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T09:27:37.160

试试这个：

![在此处输入图像描述](../Images/06f481bea83944088ac33bca58a3f2c9.png)

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/bg_l_l"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/bg_l_l"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="chintan"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <TextView
            android:id="@+id/textView2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="khetiya"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/bg_l_l"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/textView3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="this is extra text and this will not spred under the imageview as you can see."
                android:textAppearance="?android:attr/textAppearanceMedium" />
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
```

# c# - 如何在视图状态中存储多个复选框值？

> ID：13622183
> 
> 赞同：0
> 
> 时间：2012-11-29T09:06:13.083
> 
> 标签：c#, asp.net

这是我的视图状态的代码。但它只存储一个值。我需要的是它将选定的多个值保留在复选框中。这种方法是在分页情况的gridview中保持/保持复选框的值。

```
public void chkAssignee_OnCheckedChanged(object sender, EventArgs e)
       {
        CheckBox selectBox = (CheckBox)sender;
        GridViewRow myRow = (GridViewRow)selectBox.Parent.Parent;  // the row
        GridView myGrid = (GridView)myRow.Parent.Parent; // the gridview
        string ID = myGrid.DataKeys[myRow.RowIndex].Value.ToString();
        GridViewRow rowSelect = (GridViewRow)selectBox.Parent.Parent;

        int a = rowSelect.RowIndex;

        ViewState["id"] = ID;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T11:31:05.153

尝试遵循以下代码可能会对您有所帮助。

```
 public void chkAssignee_OnCheckedChanged(object sender, EventArgs e)
    {
        CheckBox selectBox = (CheckBox)sender;
        GridViewRow myRow = (GridViewRow)selectBox.Parent.Parent;  // the row
        GridView myGrid = (GridView)myRow.Parent.Parent; // the gridview
        string ID = myGrid.DataKeys[myRow.RowIndex].Value.ToString();
        GridViewRow rowSelect = (GridViewRow)selectBox.Parent.Parent;

```
 int a = rowSelect.RowIndex;
    ArrayList SelecterdRowIndices=new ArrayList();
    if(ViewState["SelectedRowIndices"]!=null)
    {
        SelecterdRowIndices=(ArrayList)ViewState["SelectedRowIndices"];
        bool flag=false;
        foreach (int i in SelecterdRowIndices)
        {
            if(i==Convert.ToInt32(ID))
            {
                flag=true;
                break;
            }   
        }
        if(!flag)
        {
            SelecterdRowIndices.Add(ID);
        }
    }  
    else
    {
         SelecterdRowIndices.Add(ID);
    }
    ViewState["SelectedRowIndices"] = SelecterdRowIndices;

} 
``` 
```

# eclipse - JSF 2.0 应用程序找不到资源

> ID：13622189
> 
> 赞同：3
> 
> 时间：2012-11-29T09:06:20.617
> 
> 标签：eclipse, jsf-2, glassfish

我是在 JSF 上开发的新手（也是一般 Web 开发的新手），我正在尝试将图像放在页面上。我正在 Eclipse 中开发我的 JSF 应用程序并在 Glassfish 3.1.2 上运行它。我已在 Eclipse 中将 Glassfish 注册为服务器，并通过 Eclipse 运行该应用程序。

我在我的 xhtml 页面上使用以下标记：

```
<h:graphicImage library="images" name="logo.png"/> 
```

我复制了 META-INF/resources/images/logo.png 中的图像。图像没有出现在页面上，当我查看页面源时，我看到了元素

```
<img src="RES_NOT_FOUND" /> 
```

表示找不到图片。

当我将我的应用程序导出到 war 文件并通过 autodeploy 文件夹将其部署到 Glassfish 时，我得到了相同的结果 - 页面显示，但图像没有出现。

谁能告知为什么找不到图像资源？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T11:48:29.560

> *我将图像复制到 META-INF/resources/images/logo.png*

只有当项目代表一个独立的模块 JAR 并最终`/WEB-INF/lib`在 WAR 中时，此位置才有效。

在您的特定情况下，情况似乎并非如此。您的问题中没有任何内容表明您确实正在开发模块 JAR 文件。显然，您已经以这种方式将其直接放在 WAR 中。这个不对。

您需要将`/resources`文件夹直接放在公共 Web 内容中，而不是放在`META-INF`文件夹中。

```
WebContent
 |-- META-INF
 |-- WEB-INF
 |    |-- faces-config.xml
 |    `-- web.xml
 |-- resources
 |    `-- images
 |         `-- logo.png
 `-- index.xhtml 
```

### 也可以看看：

*   [具有共享代码的多个 JSF 项目的结构](https://stackoverflow.com/questions/8320486/structure-for-multiple-jsf-projects-with-shared-code/8320738#8320738)
*   [为什么有些资源文件放在 META-INF 目录下](https://stackoverflow.com/questions/5609272/why-some-resource-files-are-put-under-meta-inf-directory/5609325#5609325)

* * *

**与具体问题无关**，使用`images`as library name 看起来并不完全正确。只需使用

```
<h:graphicImage name="images/logo.png"/> 
```

### 也可以看看：

*   [JSF 资源库有什么用途，应该如何使用？](https://stackoverflow.com/questions/11988415/what-is-the-jsf-resource-library-for-and-how-should-it-be-used)

# ios - 带有导航控制器方向的标签栏控制器ios 6

> ID：13622194
> 
> 赞同：2
> 
> 时间：2012-11-29T09:06:43.057
> 
> 标签：ios, uinavigationcontroller, ios6, uitabbarcontroller

我目前正在开发一个项目，我们有一个带有 4 个选项卡的选项卡栏控制器，每个选项卡都有一个导航控制器。在这些导航控制器中的每一个上，都推送了多个视图控制器。

我在这里和其他地方阅读了很多帖子，我们目前做了以下工作：

**子类化的 UITabbar 控制器**

```
- (BOOL)shouldAutorotate
{

    return [[[self.viewControllers objectAtIndex:self.selectedIndex]topViewController] shouldAutorotate];

}

- (NSUInteger) supportedInterfaceOrientations
{
    return [[[self.viewControllers objectAtIndex:self.selectedIndex]topViewController]supportedInterfaceOrientations];
}

- (BOOL) shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation{
    return [[[self.viewControllers objectAtIndex:self.selectedIndex]topViewController] shouldAutorotateToInterfaceOrientation:toInterfaceOrientation];
} 
```

如果我们在每个视图控制器中指定以下内容，这可以正常工作：

```
- (NSUInteger) supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskPortrait;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation{
    return YES;
} 
```

这将按预期将其锁定为纵向。

但现在真正的问题出现了！如果我们在其中一个选项卡上的视图控制器中指定它应该旋转到横向，它可以正常工作，但是当我们更改选项卡时它仍然是横向的，这不是我们想要的！

总而言之，有没有人找到解决方案来解决如何将几乎所有视图锁定到给定方向（期望一个），并且可以更改它们在您指定方向（此处为纵向）中的选项卡？

我还阅读了这篇文章[iOS 6 UITabBarController 支持当前 UINavigation 控制器的方向](https://stackoverflow.com/questions/12504464/ios-6-uitabbarcontroller-supported-orientation-with-current-uinavigation-control)，但正如一个评论还提到“这几乎对我有用。问题是如果我在将标签切换到仅纵向视图时已经处于横向状态，它仍然存在在横向。旋转纵向修复它，它不会旋转回横向，但我仍然需要它在第一次加载时是纵向的“这在这里几乎是一样的..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:27:34.550

我自己也遇到了这个问题，我想出了一个解决方案，它不漂亮，但它有效。

在你的 TabbarController 子类中实现这个 tabbarcontroller 委托函数（记得设置委托）：

```
-(void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController{
    int selected = self.selectedIndex;
    UIViewController *con = [[UIViewController alloc] initWithNibName:@"XIBName" bundle:nil];
    [[self.viewControllers objectAtIndex:selected] pushViewController:con animated:NO];
    [[self.viewControllers objectAtIndex:selected]popViewControllerAnimated:NO];
    [[self.viewControllers objectAtIndex:selected] setDelegate:nil];
} 
```

在标签导航控制器中的 uinavigationcontroller 上的推送和弹出将使标签栏控制器再次触发其方向功能，如果您正确实现了方向代码，它将更改为您想要的方向。

我希望这会有所帮助，如果我需要详细解释任何内容，请随时发表评论。

最好的问候莫腾

# javascript - 动画正在进行时如何禁用jquery中的所有其他事件

> ID：13622195
> 
> 赞同：0
> 
> 时间：2012-11-29T09:06:51.737
> 
> 标签：javascript, html, css

我再次写在这里，因为我的页面中的脚本有一些问题。我有一个菜单焦点问题，我在一两个星期前在这个论坛上写了它，但是这个很棒的脚本表明我一个用户有一个错误，我不知道如何解决它。我已经尝试了很多合理的解决方案，但问题仍然存在。

这是 Fiddle 的代码，它模拟了我的问题：http: [//jsfiddle.net/PRZYN/15/](http://jsfiddle.net/PRZYN/15/)

```
$(document).ready(function() {
    $('#handle').mouseenter(slideIn);
    $("#box").mouseleave(function() {
        $(this).animate({
            left: "-=180px"
        }, "fast");
        $('#handle').mouseenter(slideIn);
    });
    $("[name='skin']").mouseleave(function(e) {
        e.stopPropagation();
    });

});

function slideIn() {
    if ($("#box")) $("#box").animate({
        left: "+=180px"
    }, "slow");
    $(this).unbind("mouseenter");
} 
```

如您所见，有一个div（蓝绿色的一个显示左侧菜单弹出窗口），当div获得焦点时显示，当div失去焦点时隐藏。

该脚本中的问题是，这两个 div 何时处于动画状态，如果用户在前端动画和后端动画中快速移动鼠标，则脚本会混淆，菜单开始显示和隐藏，这很烦人。当菜单出现相同的错误时，还有其他一些方法，但我没有很好地定位它。我认为，当用户将这个 div 悬停并且鼠标停在某个地方时，这个问题也会显示出来——这有时会有所不同。

我以某种方式找到了问题，但我不知道如何解决它。我需要在菜单处于动画状态时禁用此 div 上的所有其他事件（但不是 .animation()），当鼠标不在 div 上时禁用元素上的所有其他事件，然后在动画完成并且用户想要再次打开或隐藏菜单时再次启用它。

我希望你能理解我的问题，如果有人能帮助我解决问题，我会很高兴。

问候，米哈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:23:52.980

您可以使用`.stop()`取消动画队列并阻止动画在用户停止与元素交互后运行。此外，最好使用 的固定值`left`，因为使用`+=`and`-=`会导致框在快速移入和移出容器后不正确对齐。即使用`"-180px"`and`"0px"`而不是`"-=180px"`and之类的值`"+=180px"`。

JSFiddle：http: [//jsfiddle.net/PRZYN/16/](http://jsfiddle.net/PRZYN/16/)

# c# - 对于 LINQ/Entity Framework 中的方法语法和查询语法，延迟执行的工作方式是否相同？

> ID：13622197
> 
> 赞同：1
> 
> 时间：2012-11-29T09:07:02.527
> 
> 标签：c#, linq, entity-framework

我想知道是否`Deferred Execution`可以用于**方法语法**和**查询语法**中的查询，我很想知道是否有任何区别。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:09:08.270

实际上只有*方法语法*。当您使用*查询语法*编写查询时，编译器会将其转换为方法语法（实际上是静态方法调用）。

例子：

扩展方法调用（方法语法）

```
var query = sequence.Select(x => x.Property); 
```

编译为（是的，扩展方法只是调用静态类方法的语法糖）

```
var query = Queryable.Select(sequence, x => x.Property); 
```

给出相同的结果（这是相同的 Queryable/Enumerable 方法调用的语法糖）

```
var query = from x in sequence
            select x.Property; 
```

因此，两种语法都会产生相同的代码。因此，您使用的语法没有区别 - 延迟执行（和其他任何东西）将以相同的方式工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T09:08:46.117

查询语法只是方法语法的语法糖，所以没有区别。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T09:11:31.067

两者的延迟执行是相同的。查询语法实际上在编译时编译为方法语法。

[LINQ 查询语法与方法语法 (C#) - MSDN](http://msdn.microsoft.com/en-us/library/bb397947.aspx)

> 介绍性 LINQ 文档中的大多数查询都是使用 C# 3.0 中引入的声明性查询语法编写为查询表达式。但是，.NET 公共语言运行时 (CLR) 本身没有查询语法的概念。因此，**在编译时，查询表达式被转换为 CLR 可以理解的东西：方法调用**。这些方法称为标准查询运算符，它们的名称有 Where、Select、GroupBy、Join、Max、Average 等。您可以使用方法语法而不是查询语法直接调用它们。

# javascript - 防止 $('img').click 多次触发

> ID：13622202
> 
> 赞同：1
> 
> 时间：2012-11-29T09:07:09.873
> 
> 标签：javascript, jquery

我想知道如何防止多次提示确认消息，在此先感谢！

javascript

```
$('img.delete').click(function () {         
    if(confirm("This selected record will be deleted. Are you sure?")){
        //Do something...
    }
}); 
```

html

```
<tbody>
    <tr>
        <td><img class="delete" src="/images/delete.gif"><input value="708" type="hidden"></td>
        <td>aaa</td>
    </tr>
    <tr>
        <td><img class="delete" src="/images/delete.gif"><input value="595" type="hidden"></td>
        <td>bbb</td>
    </tr>
    <tr>
        <td><img class="delete" src="/images/delete.gif"><input value="19" type="hidden"></td>
        <td>ccc</td>
    </tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:18:25.800

您的代码中的问题是您多次应用点击处理程序；这从您发布的代码中看不到，但这绝对是原因。

如果您`$('img.delete').click(fn)`多次运行，它不会覆盖之前的点击处理程序；相反，它添加了另一个处理程序。之后，当`img.delete`被点击时，所有注册的处理程序都被连续调用，导致一个弹出窗口接着另一个。

应该先打电话补救`.unbind()`；这样做将有效地用新的单击处理程序替换以前的单击处理程序。

```
$('img.delete')
    .unbind('click')
    .click(function () {         
        if(confirm("This selected record will be deleted. Are you sure?")){
            //Do something...

            // remove the image here I guess?
        }
    }); 
```

但是，如果您也能找到根本原因，那就更好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:16:07.257

你可以通过在 jquery 中解除绑定来做到这一点

```
$(function(){
    $('img.delete').click(function () {         
        if(confirm("This selected record will be deleted. Are you sure?")){
            //Do something...
        }
        $('img.delete').unbind('click');
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:17:12.230

使用 Jquery [.one()](http://api.jquery.com/one/)方法，这就是它的用途。

```
 $('img.delete'.one('click',function () {         
            if(confirm("This selected record will be deleted. Are you sure?")){
                //Do something...
            }
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:18:45.487

如果您担心这一点，您可以确保单击后没有事件处理程序：

```
var confirm_me=function () {
    if(confirm("This selected record will be deleted. Are you sure?")){
        //Do something...
    }
    //restore event handler
    $(this).one('click',confirm_me);
    //prevent event propagation
    return false;
    }

//BE sure that you not do that in loop. if possible do - see second code
$('img.delete').one('click',confirm_me); 
```

* * *

其他情况：

```
var confirm_me=function () {
     var t=$(this);
    //check processing flag
    if (t.data('processing')) return false;
    //Set processing flag
    t.data('processing',1);

    if(confirm("This selected record will be deleted. Are you sure?")){
        //Do something...
    }

    //restore event handler
    t.one('click',confirm_me);
    //remove processing flag
    t.data('processing',0);
    //prevent event propagation
    return false;
    }

$('img.delete').one('click',confirm_me); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T09:21:25.897

使用它，它由我验证。

```
<script type="text/javascript">
var check = false;
$(document).ready(function () {
        $('img.delete').click(function () {
        if (check != true) {
            if (confirm("This selected record will be deleted. Are you sure?"))
                check = true;
        }
        else {
            alert('you have deleted one');
        }
        });
     });
</script> 
```

# php - 无法在 php 中使用存储过程插入记录

> ID：13622206
> 
> 赞同：0
> 
> 时间：2012-11-29T09:07:30.300
> 
> 标签：php

我有下一个代码，我已经尝试了在数据库中插入的问题，存储过程正常工作：

**存储过程是：**

```
DELIMITER //
CREATE PROCEDURE newProduct

(   
IN tipo VARCHAR(10),
IN categoria VARCHAR(10),
IN marca VARCHAR(10),
IN modelo VARCHAR(10),
IN color VARCHAR(10),
IN talla DOUBLE,
IN corte VARCHAR(15),
IN cveprecio VARCHAR(20),
IN precio DECIMAL(7,2),
IN sugp DECIMAL(7,2)        
)
BEGIN
START TRANSACTION;

INSERT INTO tipos (tipo) VALUES (tipo);
INSERT INTO marcas (marca,modelo) VALUES (marca,modelo);
INSERT INTO colores (color) VALUES (color);
INSERT INTO tallas (talla) VALUES (talla);
INSERT INTO corte (corte) VALUES (corte);
INSERT INTO precios (cveprecio,precio,sugp) VALUES (cveprecio,precio,sugp);

COMMIT;
END//
DELIMITER ; 
```

**在 MYSQL 中调用存储过程（有效）**

call newProduct('Tenis','Hombre','Nike','ACG90','Negro',26.5,'Sintetico','6p90',690.50,750.50);

**用于连接数据库的 PHP 代码**

```
<?php//connect.php
$connect= mysqli_connect('localhost','root','xxxx','bancodedatos');
if (!$connect)
{
printf("Can't connect to MySQL Server.", mysqli_connect_error());
exit;
}
?> 
```

**插入和调用存储过程的代码**

```
<?php//insert.php
include("../connect.php");
$tipo= isset($_POST['tipo']) ? $_POST['tipo'] : NULL;
$categoria= isset($_POST['categoria']) ? $_POST['categoria'] : NULL;
$marca= isset($_POST['marca']) ? $_POST['marca'] : NULL;
$modelo= isset($_POST['modelo']) ? $_POST['modelo'] : NULL;
$color= isset($_POST['color']) ? $_POST['color'] : NULL;
$talla= isset($_POST['talla']) ? $_POST['talla'] : NULL;
$corte= isset($_POST['corte']) ? $_POST['corte'] : NULL;
$cveprecio= isset($_POST['cveprecio']) ? $_POST['cveprecio'] : NULL;
$precio= isset($_POST['precio']) ? $_POST['precio'] : NULL;
$sugp= isset($_POST['sugp']) ? $_POST['sugp'] : NULL;
$createProduct=mysqli_query($connect,"CALL newProduct($tipo,$categoria,$marca,$modelo,$color,$talla,$corte,$cveprecio,$precio,$sugp)"); 

mysql_close ($connect);

?> 
```

***从 php 调用它不会插入数据库，谢谢，来自墨西哥的问候***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:12:48.467

改变

```
$createProduct=mysqli_query($connect,"CALL newProduct($tipo,$categoria,$marca,$modelo,$color,$talla,$corte,$cveprecio,$precio,$sugp)"); 
```

至

```
$createProduct=mysqli_query($connect,"CALL newProduct('$tipo','$categoria','$marca','$modelo','$color','$talla','$corte','$cveprecio','$precio','$sugp')"); 
```

用于`mysqli_real_escape_string()`转义`'`和`"`变量值

# c - 在循环中从文本文件中读取数据 C

> ID：13622209
> 
> 赞同：0
> 
> 时间：2012-11-29T09:07:44.007
> 
> 标签：c, data-structures, text-files

我被要求实施具有以下规格的日历

*   将事件添加到日历
*   显示特定日历日期的事件。
*   显示整个日历。
*   从日历中删除事件。
*   将日历的事件写入文本文件。
*   从文本文件中读取日历的事件。

我从文本文件中读取数据时遇到问题。我有正确的语法。但是，我的程序在从文本文件中读取事件时崩溃，并且恰好在 for 循环内。（请注意函数内部有一些调试语句`ReadfromText`）代码如下：

```
 /************************************************************************************************
    Input file: None
    Output file: None
    Description: This calendar program is mainly a menu interactive program that prompts
                 the user for a date and its events, then the entry is stored in its appropriate
                 place inside an array of structures.
                 This program handles 5 main operations:
                    . Add an event to the calendar.
                    . Display events for a specific calendar date.
                    . Display the whole calendar.
                    . Delete the event from the calendar.
                    . Writes the events of a calendar to a text file.
                    . Reads the events of a calendar from a text file.
    ************************************************************************************************/

    #include <stdio.h>
    #include <string.h>
    #include<time.h>
    #define MAXEVS 100   // Defining the maximum number of events as being 100
    typedef enum {FALSE = 0, TRUE = 1} BOOLEAN;
    typedef struct {
        int hours,
            minutes,
            seconds;
    } tm_t;

    typedef struct {
        char month [20];
        int day,
            year; 
    } date_t;

    typedef struct {
        char ev_name [40];
        date_t dt;
        tm_t tm;
    } event_t;

    typedef struct {
        BOOLEAN valid;
        event_t event_list [MAXEVS];
        int num_events;
    } calentry_t; 

        int counter = 0; //Global counter variable used to keep track of number of events
        void menu (); // This function displays the menu to the user 
        void InitializeCalender(calentry_t calendar[][31]  ); // Initializes the calendar for valid and invalid dates
        int ReadEvent ( calentry_t calendar[][31],char eventname[], char month[], int *day, int *year, int *h, int *min); // This function min role is to get the input from the user (the whole calendar entry)
        int MonthStr2Num ( char* month); // This function converts a string containing a month to its appropriate number
        void AddEvent (calentry_t calendar[][31], char eventname[], int* monthnum, int *day, int *year, int *h, int *min); // This function places the calendar entry places the event inside its appropriate place inside the 2D array
        char* MonthNum2Str (int* m); // Converts a number to its appropriate month
        void DisplayCalendar (calentry_t calendar[][31], int* monthnum, int* day, int* year); // Displays the calendar entry for a specific date
        void DisplayWholeCalendar ( calentry_t calendar[][31]); // This function displays the whole entries stored inside the calendar
        int DeleteEvent (calentry_t calendar [][31]); // This function deletes an event from the calendar
        void SavetoText (calentry_t calendar [][31], FILE* fp, time_t tt);
        void ReadfromText(calentry_t calendar [][31],char eventname[], int* monthnum, int *day, int *year, int *h, int *min, FILE* fp);
    main (){
        time_t t = time(NULL);
        FILE *fp;

        int choice;
        calentry_t calendar[12][31]; // Declaring a 2D array of structure calentry_t
        calentry_t calendarf[12][31]; // Declaring a 2D array of structure calentry_t

        char eventname [100];
        char month[20];
        int day, year, h, min, monthnum;
        char temp;

        InitializeCalender(calendar);
        InitializeCalender(calendarf);
        do{ // loop that continues to execute the program until the user decides to quit
        menu ();

        scanf ("%d",&choice);
        switch (choice)
        {
            case 0:
            printf("Calendar will now quit.\n");
            break;
            case 1:
            monthnum = ReadEvent(calendar ,eventname, month, &day, &year, &h, &min);
            AddEvent (calendar, eventname, &monthnum, &day, &year, &h, &min);
            break;
            case 2:
            printf ("What is the date that you want to display its events? input like ( 12 January 2012 ) ");
            scanf ("%d %s %d", &day, month, &year);
            monthnum = MonthStr2Num (month); 
            DisplayCalendar (calendar ,&monthnum, &day, &year);
            break;
            case 3:
            printf ("The whole calendar will be displayed immediately\n");
            DisplayWholeCalendar (calendar);
            break;
            case 4: 
            DeleteEvent (calendar);
            break;
            case 5:
            SavetoText (calendar, fp, t);
            break;
            case 6:
            ReadfromText (calendarf, eventname, &monthnum, &day, &year, &h, &min, fp);
            break;
        }
        }
        while (choice !=0);
    } //End of the main function

    void menu ()
    {
        printf("___________________________________________________________________________\n");
        printf("\tHere is the menu:\n");
        printf("\t0\. Quit the Program.\n");
        printf("\t1\. Add an event to the calendar.\n");
        printf("\t2\. Display events for a specific calendar date.\n");
        printf("\t3\. Display the whole calendar.\n");
        printf("\t4\. Delete the event from the calendar.\n");
        printf("\t5\. Save the calendar to a text file.\n");
        printf("\t6\. Read the calendar from a text file.\n"); 
        printf("____________________________________________________________________________\n");
        printf("\tYour choice Please: ");
    }

    void InitializeCalender(calentry_t calendar[][31]){
    int x, y;
        for(x = 0; x < 12; x ++) {
            if (x==1){
                for(y = 0; y < 28; y ++){ 
                    (calendar[x][y]).valid = TRUE;
                    (calendar[x][y]).num_events = FALSE;
                }
                for (y=28; y< 31; y++){
                    (calendar[x][y]).valid = FALSE;
                }
            }
            else if  (x==3 || x==5 || x==8 || x==10){
                for(y = 0; y < 30; y ++){ 
                    (calendar[x][y]).valid = TRUE;
                    (calendar[x][y]).num_events = FALSE;

                }
                for (y=30; y< 31; y++){
                    (calendar[x][y]).valid = FALSE;
                }
            }
            else if (x==0 || x==2||x==4||x==6||x==7||x==9||x==11){
                for(y = 0; y < 31; y ++){ 
                    (calendar[x][y]).valid = TRUE;
                    (calendar[x][y]).num_events = FALSE;
                }
            }
        }
    }

    int ReadEvent (calentry_t calendar[][31] ,char eventname[], char month[], int *day, int *year, int *h, int *min){

        char temp, answer;
        int monthnum;

            printf ("\n\tOkay, for event number %d:\n",counter+1 );
            printf ("\n\tWhat is the name of the event? ");
            scanf ("%c",&temp);
            gets (eventname);

            printf("\n\twhat is the date of the event? input like ( 12 January 2012 ) ");   
            scanf ("%d %s %d", day, month, year);
            monthnum = MonthStr2Num (month);
                if ( calendar [(monthnum-1)][(*day-1)]. valid ==FALSE || *day>=32 ){
                    while ( calendar [(monthnum-1)][(*day-1)]. valid ==FALSE || *day>=32 ) { //Loop that checks invalid dates
                    printf ("\tSorry that'san invalid date!!!!!\n");
                    printf("\n\twhat is the date of the event? input like ( 12 January 2012 ) ");   
                    scanf ("%d %s %d", day, month, year);
                    monthnum = MonthStr2Num (month);
                    } 
                }

            printf ("\n\tWhat is the time of the event? input like (12:30) ");
            scanf ("%d:%d", h,min);
                if ( *h>=24 || *h<0 || *min>=60 || *min<0){ //Loop that checks invalid times
                    while ( *h>=24 || *h<0 || *min>=60 || *min<0){
                        printf ("\tInvalid Time !!!!! \n");
                        printf ("\n\tWhat is the time of the event? input like (12:30) ");
                        scanf ("%d:%d", h,min);
                    }
                }
            monthnum = MonthStr2Num (month);
            return monthnum;

    }
    int MonthStr2Num ( char* month){
            int i,
                m=0;
        // Converting all the month characters to uppercase in order to handle all the cases of how the user 
        // enters the month
        for(i=0;i<=strlen(month);i++)
        {
        if(month[i]>=97&&month[i]<=122)
        month[i]=month[i]-32;
        }

        if (strcmp((month), "JANUARY")==0){ 

            m = 1;}

        else if (strcmp((month), "FEBRUARY")==0)
        m = 2;
        else if (strcmp((month), "MARCH")==0)
        m = 3;
        else if (strcmp((month), "APRIL")==0)
        m = 4;
        else if (strcmp((month), "MAY")==0)
        m = 5;
        else if (strcmp((month), "JUNE")==0)
        m = 6;
        else if (strcmp((month), "JULY")==0)
        m = 7;
        else if (strcmp((month), "AUGUST")==0)
        m = 8;
        else if (strcmp((month), "SEPTEMBER")==0)
        m = 9;
        else if (strcmp((month), "OCTOBER")==0)
        m = 10;
        else if (strcmp((month), "NOVEMBER")==0)
        m = 11;
        else if (strcmp((month), "DECEMBER")==0)
        m = 12;
        return m;
    }

    void AddEvent (calentry_t calendar[][31], char eventname[], int* monthnum, int *day, int *year, int *h, int *min){
        char monthstr [20];
        strcpy(monthstr,MonthNum2Str(monthnum));
        strcpy ( calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].ev_name,eventname );
        strcpy ( calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].dt.month,monthstr );  
        calendar [(*monthnum-1)][(*day-1)].num_events++;
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].dt.day = (*day);
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].dt.year = (*year); 
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].tm.hours = (*h);
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].tm.minutes = (*min);           
        counter++;

    }

    char* MonthNum2Str (int* m){ 
        if (*m==1)
        return "January";
        else if (*m==2)
        return "February";
        else if (*m==3)
        return "March";
        else if (*m==4)
        return "April";
        else if (*m==5)
        return "May";
        else if (*m==6)
        return "June";
        else if (*m==7)
        return "July";
        else if (*m==8)
        return "August";
        else if (*m==9)
        return "September";
        else if (*m==10)
        return "October";
        else if (*m==11)
        return "November";
        else if (*m==12)
        return "December";
    }

    void DisplayCalendar (calentry_t calendar[][31], int* monthnum, int* day, int* year){
        int i;

        if ( calendar [(*monthnum-1)][(*day-1)].num_events==0)
            printf ("\n\tNo events on this date!!!!!!\n");
            else{
            printf ("\n\tOn %d-%s-%d You have %d event(s): \n", *day, calendar [(*monthnum-1)][(*day-1)]. event_list[(calendar[(*monthnum-1)][(*day-1)].num_events)-1].dt.month, *year, calendar[(*monthnum-1)][(*day-1)].num_events);
                for (i=0; i<calendar[(*monthnum-1)][(*day-1)].num_events; i++){
                    printf ("\t\n Event %d: ", i+1);
                    printf ("\t\n Name of the event: %s", calendar [(*monthnum-1)][(*day-1)]. event_list[i].ev_name );
                    printf ("\t\n Time of the event: %d:%d\n", calendar [(*monthnum-1)][(*day-1)]. event_list[i+1].tm.hours, calendar [(*monthnum-1)][(*day-1)]. event_list[i+1].tm.minutes);
                }
            }
    }

    void DisplayWholeCalendar ( calentry_t calendar[][31]){
        int x, y, i;

        printf ("You have a total of %d event(s)\n", counter);

        for(x = 0; x < 12; x ++) {
            for (y=0; y< 31; y++){
                if ((calendar[x][y]).valid == FALSE ||(calendar[x][y]).num_events == FALSE){
                }
                else {
                printf ("On %d-%s-%d You have %d event(s): \n", y+1, calendar [x][y]. event_list[(calendar[x][y].num_events)-1].dt.month, calendar [x][y]. event_list[calendar[x][y].num_events].dt.year, calendar[x][y].num_events);
                    for (i=0; i<calendar[x][y].num_events; i++){
                    printf ("\t\n Event %d: ", i+1);
                    printf ("\t\n Name of the event: %s", calendar [x][y]. event_list[i].ev_name );
                    printf ("\t\n Time of the event: %d:%d\n", calendar [x][y]. event_list[i+1].tm.hours, calendar [x][y]. event_list[i+1].tm.minutes);
                    }
                }
            }
        }
    }

    int DeleteEvent (calentry_t calendar [][31]){
        int day, year, monthnum, choice, c;
        char month [20];

        printf ("\n\tWhat is the date that you want to delete one of its events? input like ( 12 January 2012 )  ");
        scanf ("%d %s %d", &day, month, &year);
        monthnum = MonthStr2Num (month);
        if ( calendar [(monthnum-1)][(day-1)].num_events==0){
            printf ("No events on this date!!!!!!\n");
            return 0;
        }
        if ((calendar[(monthnum-1)][(day-1)]).valid == FALSE){
            printf ("Invalid date !!!!\n");
            return 0;
        }
        else {
        DisplayCalendar (calendar ,&monthnum, &day, &year);
        printf ("\n\nWhat is the event that you want to delete (press 1 for event 1 or 2 for event 2...) ");
        scanf ("%d", &choice);
            if ( choice >= (calendar [(monthnum-1)][(day-1)].num_events)+1 )
                 printf("\n\tDeletion not possible.\n");

            else {
                for ( c = choice - 1 ; c < (calendar [monthnum-1][day-1].num_events) ; c++ ){
              calendar [monthnum-1][day-1]. event_list[c] =calendar [monthnum-1][day-1]. event_list[c+1];   
                }         calendar [monthnum-1][day-1].num_events--;
                            printf ("\n\tEvent deleted \n");
                            counter--;
            }
        }

    }

    void SavetoText (calentry_t calendar [][31], FILE* fp, time_t tt)
    {
        char buf[80];
        struct tm* st = localtime(&tt);
        strftime(buf, 80, "eventlog_%d-%B-%y_%H.%M.txt", st);
            fp= fopen (buf, "w");
            if (fp== NULL)
            printf ("\tError! File could not be opened\n");
            else
            {
            int x, y, i;

        for(x = 0; x < 12; x ++) {
            for (y=0; y< 31; y++){
                if ((calendar[x][y]).valid == FALSE ||(calendar[x][y]).num_events == FALSE){
                }
                else {
                        fprintf (fp, "%d %s %d\n",y+1,calendar [x][y]. event_list[(calendar[x][y].num_events)-1].dt.month, calendar [x][y]. event_list[calendar[x][y].num_events].dt.year);

                        fprintf (fp, "%d\n", calendar[x][y].num_events );
                    for (i=0; i<calendar[x][y].num_events; i++){
                        fprintf (fp, "%s %d %d\n", calendar [x][y]. event_list[i].ev_name , calendar [x][y]. event_list[i+1].tm.hours,calendar [x][y]. event_list[i+1].tm.minutes);
                    }
                }
            }
        }   
     }
     printf ("\tEvents were printed in the textfile file successfully!\n");
     fclose (fp); 
    }

    void ReadfromText(calentry_t calendar [][31],char eventname[], int* monthnum, int *day, int *year, int *h, int *min,  FILE* fp)
    {   
        char filename [20];
        char month[20];
        int numevents, i;
        printf ("\n\tWhat is the name of the file that you want to open (input like: eventlog_29-November-12_1.22.txt): ");
        scanf ("%s", &filename);
        fp= fopen (filename, "r");
        if (fp==NULL)
        printf ("\tError! File could not be opened\n");
        else 
        {
            while (!feof(fp))
            {
                fscanf (fp, "%d %s %d\n",  &day, month, &year);
                fscanf (fp, "%d\n", &numevents);
                (*monthnum) = MonthStr2Num (month);
                printf ("The month number is %d", (*monthnum));
                printf ("The number of events is %d\n", numevents);
                    for (i=0; i<numevents; i++)
                    {   printf ("I am inside the loop\n");
                        fscanf (fp, "%s %d %d\n", eventname , &h, &min);
                        printf ("%s %d %d\n", eventname , h, min);
                        AddEvent (calendar, eventname, monthnum, day, year, h, min); 
                        printf ("Added to the calendar\n");
                    }

            }
        }
        DisplayWholeCalendar (calendar);    
    } 
```

任何人都可以帮忙吗？先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:27:17.233

将函数声明更改为

```
void ReadfromText(calentry_t calendar [][31],char eventname[], int* monthnum, int day, int year, int h, int min, FILE* fp); 
```

称它为：

```
case 6:
ReadfromText (calendarf, eventname, &monthnum, day, year, h, min, fp); 
```

在里面`ReadFromText`，调用`AddEvent`为

```
printf ("%s %d %d\n", eventname , h, min);
AddEvent (calendar, eventname, monthnum, &day, &year, &h, &min); 
printf ("Added to the calendar\n"); 
```

在里面`ReadFromText`做这个改变

```
fscanf (fp, "%d %s %d\n",  &day, month, &year); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:27:21.160

好吧，该功能的一些或多或少明显的问题`ReadFromText()`是：

1.  不要那样使用`feof()`；*在*您尝试读取失败之前，它的返回值无效。
2.  在依赖输出*之前*检查 的返回值`fscanf()`以确保它成功。
**   奇怪的是你传入`fp`，然后在函数内部覆盖它，但我没有从函数中追踪到这可能意味着什么。*

# java - TestNG - 从不同的类导入/运行测试

> ID：13622226
> 
> 赞同：1
> 
> 时间：2012-11-29T09:08:45.690
> 
> 标签：java, testng

我的情况是：

```
public class ExampleTest extends AbstractExampleTest {
    @Test(dependsOnMethods={"someMethodFromAbstractExampleTest"}
    public void firstTest() {
        // Assert
    }

    // here I would like to call CommonTests
}

public class CommonTests {
    @Test
    public void sharedTest() {
        // Assert
    }
} 
```

像 CommonTests 这样的东西存在的原因是它会包含一个重复的测试序列。我目前将信息从 ExampleTest 传递到 CommonTests 的方式是通过静态方法完成的，这似乎可行，但可能不是最好的。

如果我根据 TestNG 文档以编程方式调用 CommonTests，这可以正常工作。我遇到的问题是结果没有记录在 ExampleTest 的运行器中。

```
@Test
public void actionBasedTest(ITestContext context) {
    TestListenerAdapter tla = new TestListenerAdapter();
    TestNG testng = new TestNG();
    testng.setTestClasses(new Class[] { ExampleAction.class });
    testng.addListener(tla);
    context.getSuite().addListener(tla);
    testng.run();
} 
```

上面的情况稍微好一些，但报告仅限于“org.testng.TestRunner@####”之类的内容，并且不会公开运行的测试方法。

所以我的问题是：我可以从另一个类（而不是通过继承）运行测试并将结果记录到同一个侦听器吗？

编辑：我想避免 testng.xml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:55:02.457

回答你的最后一个问题，你可以使用 testng.xml 运行任何类的测试，它允许你以任何你喜欢的方式构建你的测试。您可以在套件标签中指定您的侦听器，这将是用于所有类的侦听器。请参阅此[示例](http://testng.org/doc/documentation-main.html#testng-xml)。

# jquery - $(document.body).height() 返回与 $(window).height() 相同的值

> ID：13622227
> 
> 赞同：1
> 
> 时间：2012-11-29T09:08:46.953
> 
> 标签：jquery, height

我的基本结构是这样的：

```
<body>
    <div id="controlBar"></div>
    <div id="placeholder"></div>
    <div id="pageHeader">
      <nav><ul><li><li></ul></nav>
    </div>
    <section id="pageContent"></section>
    <footer id="pageFooter"></footer>
</body> 
```

其中`#controlBar`有一个固定的位置，并且与`#placeholder`具有相同的高度`#controlBar`。身体内的组合高度约为 400 像素。

我正在尝试使用 获取身体的高度`$(document.body).height()`，但返回的值与 相同`$(window).height()`，超过 900 像素。我也试过了`$(document).height()`，结果还是一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:12:27.337

If you'd like to know the actual size of the `window` you could check it like this:

```
window.innerHeight 
```

# c# - Linq Mapping dbml - 捕获存储的 proc 参数以报告错误

> ID：13622235
> 
> 赞同：4
> 
> 时间：2012-11-29T09:09:21.313
> 
> 标签：c#, linq, linq-to-sql, stored-procedures, error-handling

在 Visual Studio 中使用 dbml 自动生成时，存储过程调用通常看起来像这样

```
 [global::System.Data.Linq.Mapping.FunctionAttribute(Name="MYDB.ui_index_group_upd")]
    public int ui_index_group_upd([global::System.Data.Linq.Mapping.ParameterAttribute(DbType="Int")] System.Nullable<int> group_id, [global::System.Data.Linq.Mapping.ParameterAttribute(DbType="VarChar(32)")] string group_code)
    {
        IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), group_id, group_code);
        return ((int)(result.ReturnValue));
    } 
```

这通常会这样称呼....

```
 using (var db = new L2SDataContext(base._connectionString))
  {
    var result = db.ui_index_group_upd(1, "foo");
  } 
```

这一切都很好。

然而，我试图实现的是一种全局的错误捕获和报告所有此类方法调用的方式，以记录proc的名称，以及在出现问题时传递的所有参数的值

我宁愿不为每种方法编写特定的代码 proc 代码，并且出于明显的原因肯定不想修改 autogen 代码。

我正在考虑我的调用和 dbml 方法之间的一个层，但我认为也许有人遇到了类似的问题，所以我想我会把它放在那里，然后再花一天时间搞砸，直到我得到一个合理的答案。我认为诀窍是枚举参数和过程名称等的优雅方式

我希望这是有道理的，感谢所有反馈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:32:03.093

我认为用`MSLinqToSqlGenerator`其他东西替换是最干净的解决方案，它可以通过多种方式完成。例如，您可以

1.  使用[T4 Toolbox: LINQ to SQL classes generator](http://www.olegsych.com/2009/01/t4-toolbox-linq-to-sql-classes-generator/)或[Reegenerator](http://www.reegenerator.com/Home.aspx/Features)之类的工具，并修改提供的模板以满足您的需要。这可能是最简单的方法。

2.  使用自定义模板通过[T4](http://msdn.microsoft.com/en-us/library/bb126445.aspx)生成代码。您将需要创建一个 T4 模板，该模板将[使用 .DBML 文件中的 XML 数据](http://dotnet.dzone.com/news/reading-xml-file-t4-templates)。您可能需要通过将自定义工具属性设置为空白来禁用 DBML 代码生成。缺点是每次修改 .DBML 文件后都需要运行 T4 生成。

3.  创建一个[自定义工具](http://msdn.microsoft.com/en-us/library/bb166817.aspx)，使用来自 .DBML 文件的 XML 数据和一些模板解决方案（可能是 T4 或 XSLT）为您生成代码。这种方法可以说是最灵活的一种，唯一的缺点是您必须在每个开发人员的机器上使用自定义工具。

我不确定什么最适合您的情况，但我可能会首先考虑使用 T4 Toolbox。它使用的 T4 模板非常标准，如有必要，可以轻松修改。

# c++ - 在遍历字符串时更改字符会导致程序崩溃

> ID：13622236
> 
> 赞同：1
> 
> 时间：2012-11-29T09:09:22.513
> 
> 标签：c++, macos, gcc

> **可能重复：**
> [为什么在写入字符串时会出现分段错误？](https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string)
> [char a[] = “string”; 和有什么区别？和 char *p = “字符串”；](https://stackoverflow.com/questions/9460260/what-is-the-difference-between-char-a-string-and-char-p-string)

谁能指出以下程序中的问题：

```
#include <stdio.h>

int main()
{
    char *c = "Hello World!! !!";
    char c2 = 'X';
    while(c)
    {
        if(*c == ' ')
        {
            printf("%s",c);
            *c = c2;
        }
        c++;
    }
    return 0;
} 
```

它崩溃并`*c = c2;`出现以下错误：

```
Thread [1] (Suspended : Signal : EXC_BAD_ACCESS:Could not access memory)    
    main() at mainclass.cpp:64 0x100000d74 
```

我在 MAC OSX 上使用 GCC 作为编译器，在 IDE 上使用 Eclipse。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:10:41.037

在您的代码中，`c`指向字符串文字。该行`*c = c2`尝试修改字符串文字，这是[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)。未定义行为的一种可能表现是字符串文字被放入只读内存中，并且您得到一个[`SIGSEGV`](http://en.wikipedia.org/wiki/Unix_signal)或类似的。

如果您按如下方式更改代码，它应该可以工作：

```
char arr[] = "Hello World!! !!";
char* c = arr; 
```

现在`c`指向一个数组。与字符串文字不同，允许修改数组的内容。

最后，您的 while 循环错误地以指针的值为条件，而不是它指向的*值*。您正在寻找一个空终止符 ('\0')。它应该如下所示：

```
while (*c)
{
    ...
    c++;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:12:40.783

当你这样做时：`char *c = "Hello World!! !!";`那么***c***是一个指向**代码部分中的内存**的指针，所以你*不能*改变它。

但是如果你有`char c[] = "Hello World!! !!";`那么***c***是**堆栈上的一个字符数组**，所以你*可以*改变它。

在这种情况下，最好这样做：`char const *c = "Hello World!! !!";`因为那样的话，如果您尝试更改字符串，您的程序不会崩溃，它会出现编译器错误并且不会运行程序，这样会更好.

# xpath - xpath - 条件表达式

> ID：13622240
> 
> 赞同：1
> 
> 时间：2012-11-29T09:09:42.707
> 
> 标签：xpath

我有以下文件：

```
<Ships>
   <Class name = "Kongo" >
        <Ship name "Kongo" launched = "1913" />
        <Ship name = "Hiei" launched = "1914"/>
        <Ship name = "Haruna" launched = "1915" />
   </Class>
   <Class name = "North Carolina">
        <Ship name = "Washington" launched= "1941"/>
   </Class>
</Ships> 
```

我需要找出与他们的级别同名的船只发射的年份。应该是哪个

```
/Ships/Class/Ship[..]/@launched 
```

'...' 部分已被省略，因为它应该是指定船名与其类名相同的条件。有谁知道如何引用更高级别元素的属性？查询应返回“1913”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:13:54.337

```
Ships/Class/Ship[@name = ../@name]/@launched 
```

# amazon - 无法使用 jwplayer 从云端流式传输视频

> ID：13622241
> 
> 赞同：1
> 
> 时间：2012-11-29T09:09:45.467
> 
> 标签：amazon, jwplayer, amazon-cloudfront

我无法使用 jwplayer 从云端流式传输文件。这是我的代码：

```
jwplayer("container").setup({
    file: "mp4:mediaTest.mp4",
    height: "480",
    provider: "rtmp",
    streamer: "rtmp://s1cp0j2rq4xbq.cloudfront.net:1935/cfx/st",
    width: "853"
}); 
```

[您可以在http://stritfun.com/](http://stritfun.com/)找到代码

但是当我改变

```
file: "mp4:mediaTest.mp4", 
```

和：

```
file: "http://s3.amazonaws.com/idastreaming/mediaTest.mp4", 
```

流式传输成功。

文件有什么问题：`mp4:mediaTest.mp4`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T12:56:58.567

您正在使用的“流媒体/文件”设置由旧版本的 JW Player (JW5) 使用，但不是由最新版本 (JW6) 使用。我们仍在与 Cloudfront 来回更新他们的文档……

无论如何，仅使用单个“文件”设置 RTMP 流将适用于 JW6：

> 文件：“rtmp://s1cp0j2rq4xbq.cloudfront.net/cfx/st/mp4:mediaTest.mp4”

# linux - 在资源有限的linux容器中执行mongod

> ID：13622243
> 
> 赞同：0
> 
> 时间：2012-11-29T09:09:50.037
> 
> 标签：linux, mongodb, lxc

您能告诉我如何在资源有限的隔离环境中启动 mongodb 吗？

Mongod 一直在填满我所有的 RAM，所以我想限制它。

我正在考虑像 LXC 这样的 linux 容器。

你能给我一个如何做到这一点的例子吗？

谢谢

# database - 具有静态加密和审计功能的开源数据库

> ID：13622244
> 
> 赞同：2
> 
> 时间：2012-11-29T09:09:50.783
> 
> 标签：database, postgresql, open-source

我工作的组织通常使用 Oracle 或 SQL Server 作为我们的数据库。但是，我们只需要创建一个小型数据库，但它将保存的少量数据是高度敏感的（IL3）。

已经指定我们需要对“静态”数据进行加密，并对查看数据库中记录的任何人进行审计。

我们知道 SQL Server 和 Oracle 可以做到这一点。但由于该服务器将无法利用现有许可证，因此需要一个昂贵的数据库版本来提供所需的功能。因此，我们正在考虑许可成本较低或无许可成本的替代方案。

我们还需要能够使用来自 Entity Framework Connector 的连接器。

是否有任何开源数据库可以提供该功能？
Postgresql 可以提供该功能吗？

谢谢，大卫C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:50:31.490

加密很简单——只需设置一个加密分区并将您的数据保存在那里。这使得加密完全远离 RDBMS。

对于审核，这取决于您需要有多严格。没有办法阻止具有完全超级用户访问权限的人摆弄日志等。

但是，您可以记录所有查询并将日志复制到另一台机器（大概也将日志保存在加密分区上）。

对于日常访问，通过自定义功能直接访问所有访问，这些功能将访问与用户详细信息一起记录。

# sql - 具有标识的 SQL 表中的附加自动编号

> ID：13622246
> 
> 赞同：1
> 
> 时间：2012-11-29T09:09:52.543
> 
> 标签：sql, sql-server, sql-server-2008

如何在我的 SQL 表中获得额外的自动编号。我已经有一个 IDENTITY 列，但我需要一个也自动递增的附加列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:11:49.947

您可以使用一组[**排名函数。**](http://msdn.microsoft.com/en-us/library/ms189798%28v=sql.100%29.aspx)例如，您可以`ROW_NUMBER()`像这样使用该函数：

```
SELECT *, ROW_NUMBER() OVER (ORDER BY somefield) rownum
FROM table; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:14:54.093

如果您有两个自动递增的列，那么它们必须始终相差一个常数，所以这样做没有任何价值吗？如果您真的希望它成为一列，那么您可以根据自动递增列的值将其设为计算列，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:13:05.557

你可以做这样的事情，

假设您有一个带有 columnName 的表`ColA`，这就是您要增加的内容，

```
INSERT INTO tableName (colA, colB)
SELECT  COALESCE((SELECT MAX(colA) + 1 FROM tableName),1) as ColA, 
        'colBValue' AS colB
FROM tableName 
```

# javascript - 获取初始化/创建全局对象的函数名称

> ID：13622249
> 
> 赞同：0
> 
> 时间：2012-11-29T09:09:58.400
> 
> 标签：javascript

我有一个 DatePicker 类，它在不同位置的不同函数中使用不同的选项调用。

现在我添加了一个选择框，它根据所选值加载 DatePicker 的额外选项。

在 Selectbox 的 onchange 事件上，我想用额外的选项刷新 DatePicker。

但是由于可以从不同的函数调用 DatePicker，具有不同的选项/设置，并且 onChange 事件实际上不知道最后调用了哪个函数，但是我有一个 Global datapicker 对象。

有没有办法再次调用上次调用来显示 DataPicker 的 Same 函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:20:27.510

您可以更新 DatePicker 类中的变量 - 一个包含调用者 ID、名称或任何您想要的变量的变量。如果一个函数调用了 DatePicker，它也会通过类的“initializer”更新类变量，然后在 onChange 中，你可以通过检查该变量来检查谁调用了 DatePicker，并做相关的事情。;)

# javascript - 在 html 中附加一个函数

> ID：13622251
> 
> 赞同：0
> 
> 时间：2012-11-29T09:10:09.393
> 
> 标签：javascript, jquery

我有一个`onclick`添加 HTML 的函数：

```
jQuery(".test").click(function() {
    jQuery(this).prevAll("input").val("5")
    jQuery(".after").append("<div><input /><a class='.test'>click doesn't work !</a></div>")
}); 
```

所以，当我点击我的班级时`.test`，该功能被触发。这行得通，但是我附加了另一个类`.test`，当我单击它时，不会触发该功能。为什么 ？谢谢。

小提琴：http: [//jsfiddle.net/csL8G/3/](http://jsfiddle.net/csL8G/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:14:46.957

[`jQuery.on()`](http://api.jquery.com/on/)如果您使用的是 jQuery 1.7+，则可以使用方法

```
//.on( events [, selector] [, data], handler(eventObject) )

$(document).on('click', '.test', function(){
   //....
}); 
```

对于以前的版本，您可以使用`.live()`或`.bind()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:14:07.173

使用它来检查动态添加的 .test 元素：

```
jQuery("body").on('click', '.test', function() {
   jQuery(this).prevAll("input").val("5");
   jQuery(".after").append("<div><input /><a class='.test'>click doesn't work !</a></div>");
}); 
```

如果您使用的 jQuery 低于 1.8，请使用 live 代替：

```
jQuery('.test').live('click', function() { ... 
```

基本上原因是当 DOM 加载时，初始点击功能仅适用于文档中已经存在的元素。但是使用 on() 处理程序，您可以设置一个侦听器来检查领域（主体）内哪些内容具有测试类，并使点击事件在该类上工作......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:18:32.757

嘿检查你写的html：

```
<a class=".test"></a> 
```

它应该只是`class="test"`

```
jQuery("body").on('click', '.test', function() {
   jQuery(this).prevAll("input").val("5");
   jQuery(".after").append("<div><input /><a class='test'>click doesn't work !</a></div>");
}); 
```

# ios - 删除使用情节提要插入的导航控制器

> ID：13622255
> 
> 赞同：7
> 
> 时间：2012-11-29T09:10:23.167
> 
> 标签：ios, uinavigationcontroller, storyboard

我在工作开始时在我的项目中插入一个导航控制器，使用`editor->embed in->Navigation Controller`. 现在我意识到插入标签栏而不是导航控制器更好，但我无法删除它！编辑器菜单中未嵌入的项目总是灰色的，我选择的每个项目......我该如何做这项工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T11:38:38.397

只需在情节提要中选择 navController 并将其删除。然后你需要向它添加一个标签栏控制器（你可以这样做与导航控制器相同：编辑器->嵌入->标签栏控制器）并根据需要将它与视图控制器连接起来。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-10T05:06:22.847

“unembed”函数用于在 stackView 中取消嵌入“stack”，而不是用于“navigation controller”或“tab bar controller”。这就是编辑器菜单中未嵌入的项目始终为灰色的原因。

# c++ - 指针向量的内存管理

> ID：13622266
> 
> 赞同：0
> 
> 时间：2012-11-29T09:10:49.883
> 
> 标签：c++

假设我有这样的课程：

```
class MyClass : private vector<AnotherClass*> {
//some codes
} 
```

如何实现它的析构函数？我是 C++ 新手，对此一无所知。

提前致谢！

编辑：修正了语法，谢谢我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:16:28.590

不要从 std::vector 派生。更好地使用 std::vector 和智能指针类，如 shared_ptr 或 unique_ptr（另见[此处](https://stackoverflow.com/questions/4577838/smart-pointers-in-container-like-stdvector)）。

还有一个警告：不要在容器中使用 std::auto_ptr ，因为在大多数情况下它不会按预期工作。

# mongodb - 判断 mongodb save 方法是否真的更新了一条记录

> ID：13622268
> 
> 赞同：1
> 
> 时间：2012-11-29T09:10:52.373
> 
> 标签：mongodb, save

我的问题很清楚，如标题所示。当我的服务请求更新 mongoDb 中的相关记录时，我们使用“保存”方法。

但是，我想了解 save 方法是否真的更新了记录。

换句话说，我想知道要保存的内容是否与mongoDb中的现有内容相同。因此，即使执行保存方法没有任何错误，是否可以了解它是否真的更新了？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T03:57:35.273

Save 方法总是写入记录。

在 Mongo 中不会发生写入的情况，因为正在保存的记录与已经存在的记录相同。写入将简单地发生并用新数据“覆盖”现有数据（恰好是相同的）。

您可以判断的唯一方法是比较旧文档和新文档 - 这是很多额外的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T10:13:23.747

有几种方法可以检查这一点。

首先是调用Save之后，就是调用getLastError方法。在控制台中，这只是 db.getLastError()。

这将告诉您在上次操作期间是否发生错误。更多详细信息可以在以下地址[http://docs.mongodb.org/manual/core/write-operations/#write-concern](http://docs.mongodb.org/manual/core/write-operations/#write-concern)中找到。

另一种方法是调用 findAndModify，这将允许您更新文档并取回更新的文档。 [http://docs.mongodb.org/manual/reference/command/findAndModify/](http://docs.mongodb.org/manual/reference/command/findAndModify/)

这两个都在所有官方驱动程序中可用。

# networking - 神话电视盒上的 WOL

> ID：13622273
> 
> 赞同：0
> 
> 时间：2012-11-29T09:11:19.493
> 
> 标签：networking, ubuntu, hardware, lan, wake-on-lan

我试图让 WOL 在我的 MythTV 盒子上工作，但我做错了一些事情，因为我无法打开盒子。

我正在运行 Mythbuntu 12.04。MB是华硕P8H61-I LX R2.0，据我所知支持WOL。

当我`ethtool eth0`通过终端运行时，我得到了这个：

```
Supports Wake-on: pumbg
Wake-on: g 
```

所以我知道网卡也支持WOL。

当我关闭盒子然后尝试发送一个魔术包时，什么也没有发生。所以要么我在盒子上设置错误，要么我以错误的方式发送数据包。

我的路由器是 Netgear CG3000，但如果需要设置任何东西，我不确定我必须在其中设置什么才能使其正常工作。

盒子的本地IP是192.168.0.11

是否有设置或我在某处缺少的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T09:48:19.407

这是主板的网卡问题

# c# - 简单的圣诞节 wpf 样式

> ID：13622276
> 
> 赞同：2
> 
> 时间：2012-11-29T09:11:30.317
> 
> 标签：c#, wpf

我不确定这样的问题是否符合条件，但是

我有一个用于我们公司的 wpf (4.0) 软件，我想通过应用程序的 UI 为我们的东西制作一些圣诞魔法。

您对圣诞主题有任何简单的想法或已经实现的样式吗？

# ios - 调整图像大小并保存在文档崩溃中

> ID：13622279
> 
> 赞同：0
> 
> 时间：2012-11-29T09:11:34.400
> 
> 标签：ios, ipad, uiimage

在我的应用程序中，我需要通过代码创建将要使用的图像。我下载全屏版本的图像，然后创建我需要的所有剪报。这种方法减少了用户将从服务器下载的 MB。下载的图像约为 300。iPad 非视网膜尺寸为 1024x768，iPad 视网膜尺寸为 2048x1536。

这是我用来调整图像大小以创建我需要的剪报的算法。为每个图像创建另一个缩小版本，然后将保存在 Document 文件夹中。

我使用ARC和GCD。

```
 CGFloat screenScale = [UIScreen mainScreen].scale;

    NSString * imagePath = [[NSBundle mainBundle]pathForResource:imageName ofType:nil];
    UIImage * image = [UIImage imageWithContentsOfFile:imagePath];
    CGSize newImageSize = [image resizeImageSettingWidth:(380.0f * screenScale)];

    UIGraphicsBeginImageContext(newImageSize);
    [image drawInRect:CGRectMake(0,0,newImageSize.width,newImageSize.height)];
    UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    NSData *jpegData = UIImageJPEGRepresentation(newImage, 0.9f);
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsPath = [paths objectAtIndex:0];

    NSString * newImageName;
    if ([[UIScreen mainScreen] respondsToSelector:@selector(displayLinkWithTarget:selector:)] &&
        ([UIScreen mainScreen].scale == 2.0)) {

        newImageName = [NSString stringWithFormat:@"%@-article@2x.jpg", [imageName stringByDeletingPathExtension]];

    }
    else {

        newImageName = [NSString stringWithFormat:@"%@-article.jpg", [imageName stringByDeletingPathExtension]];
    }

    NSString *filePath = [documentsPath stringByAppendingPathComponent:newImageName]; 
    [jpegData writeToFile:filePath atomically:YES]; 
```

在未知数量的调整大小后，应用程序可能因内存警告而崩溃。崩溃仅发生在第四代 iPad 上，在 iPad2 上完美运行。也许问题是自动释放对象释放较晚，这会产生内存积累？

# sql - 动态、跨数据库触发器创建

> ID：13622282
> 
> 赞同：1
> 
> 时间：2012-11-29T09:11:46.413
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我正在尝试跨两个数据库动态创建多个触发器，但是在切换数据库时我遇到了 Create Trigger 语句的问题

```
SET @SQL = 'SELECT Name FROM ' + @DB + '.sys.triggers WHERE Name = ' + '''' 
           + @Table + '_DELTATrigger' + ''''
EXEC(@SQL)

IF @@RowCount > 0   
BEGIN
  SET @SQL = 'USE ' + @DB + '; DROP TRIGGER [dbo].[' + @Table + '_DELTATrigger]'
  EXEC(@SQL)
END

SET @SQL = 'CREATE TRIGGER [dbo].[' + @Table + '_DELTATrigger] 
                ON [dbo].[' + @Table + '] 
                AFTER INSERT, UPDATE 
                AS 
                BEGIN 
                  SET NOCOUNT ON 
                  UPDATE [' + @Table + '] 
                  SET [Delta] = 1 
                  FROM inserted 
                  WHERE inserted.[ID] = [' + @Table + '].[ID] 
                END;'               
EXEC (@SQL) 
```

如果我运行此语句，我会收到以下问题

> *错误 8197，级别 16，状态 4，过程 tblBuild_DataPlate_DELTATrigger，第 1 行
> 消息：对象“dbo.tblBuild_DataPlate”不存在或对于此操作无效。*

更改动态创建触发器以包含 USE 语句不起作用，因为创建触发器必须是第一个语句

```
SET @SQL = 'USE ' + @DB + '; CREATE TRIGGER [dbo].[' + @Table + '_DELTATrigger]
            ON [dbo].[' + @Table + '] 
            AFTER INSERT, UPDATE 
            AS 
            BEGIN 
              SET NOCOUNT ON 
              UPDATE [' + @Table + '] 
              SET [Delta] = 1 
              FROM inserted 
              WHERE inserted.[ID] = [' + @Table + '].[ID] 
            END;'               
EXEC (@SQL)

Error 111, Level 15, State 1, Procedure -, 
Line 1, Message: 'CREATE TRIGGER' must be the first 
statement in a query batch. 
```

在这种情况下，您无法使用数据库完全限定对象，因为您收到以下错误

> *错误 166，级别 15，状态 1，过程 -，第 1 行，
> 消息：“CREATE/ALTER TRIGGER”不允许将数据库名称指定为对象名称的前缀。*

有没有动态的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:28:57.593

下面的代码将`sp_executesql`在选定的数据库 (@DB) 上运行，因此，您可以在正确的位置创建触发器：

```
SET @SQL = 'EXEC ' + @DB + '..sp_executesql N''
CREATE TRIGGER [dbo].[' + @Table + '_DELTATrigger] 
                            ON [dbo].[' + @Table + '] 
                            AFTER INSERT, UPDATE 
                        AS 
                        BEGIN 
                            SET NOCOUNT ON 

                        END;'''               
            EXEC (@SQL) 
```

# iphone - iPad3 Gray line issue while Split keyboard

> ID：13622286
> 
> 赞同：2
> 
> 时间：2012-11-29T09:11:55.623
> 
> 标签：iphone, ios, ipad

I am new to ios development and i am facing the strange problem when we split the keyboard.

I am using custom keypad for data input in the textfield so i hide system keyboard and for that i have used the method `[textfield setInputview:label];` in that i am giving textfield inputview to label of `size(0,0,1,1)`.

Now when there is splitkeyboard then there is a gray line in bottom! And when there is normal keyboard(Without Split) then there is no problem.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T16:53:07.750

尝试使用 (0, 0, 0, 0) 大小作为`inputView`标签，这对我来说效果很好（在我的情况下，我使用`UIView`(0, 0, 0, 0) 大小`inputView`来解决这个问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:20:02.650

我记得苹果给我发了一条关于 ios 6.1 beta 2 预更新的信息，解决了这个问题。你也应该收到那封电子邮件。（苹果开发者）

# xslt - XSLT date comparison not working

> ID：13622290
> 
> 赞同：1
> 
> 时间：2012-11-29T09:12:08.460
> 
> 标签：xslt, date-comparison

I am trying to implement an XSLT date comparison but doesn't seem to work, here is my code:

```
<xsl:variable name="CreatedDate" select="@createDate"/>
                <xsl:variable name="IDAppendedDate" select="2012-01-01" />

                 <b>date: <xsl:value-of select="$CreatedDate"/></b> 

                 <xsl:if test="$CreatedDate > $IDAppendedDate">
                   <h2> mooooooooooooo </h2>
                </xsl:if> 
```

thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:26:52.937

也许您可以将一些[XSLT 日期/时间函数](http://www.w3schools.com/xpath/xpath_functions.asp#datetime)应用于您的 IDAppendedDate 而不是简单的字符串值。

# jquery - JQuery DataTables + KnockOut (+ BootStrap) 错误？

> ID：13622291
> 
> 赞同：2
> 
> 时间：2012-11-29T09:12:08.697
> 
> 标签：jquery, twitter-bootstrap, knockout.js, datatables

我已将 KnockOut observableArray 绑定到 jQuery DataTable。当我将项目动态添加到此数组时，新项目会正确地呈现在表中，但是数据表本身的某些选项不会被刷新。寻呼机没有得到更新。“无可用数据”消息也不会消失。

HTML：

```
<table class="table table-striped" id="tblSample">
    <thead>
        <tr>
            <th>Name</th>
        </tr>
    </thead>

    <tbody data-bind="foreach: List">
        <tr>
            <td data-bind="text: Name"></td>
        </tr>
    </tbody>
</table>
<button class="btn" type="button" data-bind="click: AddSample">Test</button> 
```

淘汰模型：

```
var Sample = function(name) {
    this.Name = ko.observable(name);
};

var ViewModel = function() {
    var self = this;
    self.List = ko.observableArray();
    self.AddSample = function() {
        self.List.push(new Sample('New'));
    };
};

ko.applyBindings(new ViewModel());​ 
```

DOM 准备好了：

```
$(document).ready(function() {

    $('#tblSample').dataTable({
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "sPaginationType": "bootstrap",
        "bFilter": true,
        "bLengthChange": false,
        "bSort": true,
        "iDisplayLength": 15,
        "oLanguage": {
            "sLengthMenu": "_MENU_ records per pagina"
        }
    });
}); 
```

工作 JSFiddle：http: [//jsfiddle.net/PhpDk/1](http://jsfiddle.net/PhpDk/1)

我做错了什么，还是这是一个错误？

谢谢，尼科

（编辑：jsfiddle 中的固定 CDN 链接）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T10:01:13.940

有一个本地淘汰网格称为 KoGrid [https://github.com/ericmbarnard/KoGrid](https://github.com/ericmbarnard/KoGrid)

但是，如果您真的想使用 Datatables，则可以使用它准备好淘汰绑定（仅适用于 1.9.0）

我已经在 Github 上分叉了该绑定并对其进行了一些扩展（您可以从 ViewModel 访问 Datables 对象以刷新、过滤、排序等），您可以在此处找到它

[https://github.com/AndersMalmgren/Knockout.Extensions](https://github.com/AndersMalmgren/Knockout.Extensions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-22T17:51:45.327

这就是这样做的方法......我做了一个jsfiddle来展示这个：

为了让它工作，我必须在原始的淘汰赛 foreach 绑定定义中添加两个回调方法。我目前正在尝试将这些事件纳入最新版本的淘汰赛。我需要添加一个 beforeRenderAll 和 afterRenderAll 回调来销毁数据表并在敲除 foreach 绑定添加 html 后重新初始化数据表。这就像一个魅力展示这个的 JSFiddle 有一个完全可编辑的 jquery 数据表，它通过淘汰赛绑定到 ViewModel。

```
ko.bindingHandlers.DataTablesForEach = {
init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
    return ko.bindingHandlers.foreach.init(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext);
},
update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {

        var value = ko.unwrap(valueAccessor()),
        key = "DataTablesForEach_Initialized";

        var newValue = function () {
            return {
                data: value.data || value,
                beforeRenderAll: function(el, index, data){
                    if (ko.utils.domData.get(element, key)) {                                   
                        $(element).closest('table').DataTable().destroy();
                    }
                },
                afterRenderAll: function (el, index, data) {
                    $(element).closest('table').DataTable(value.options);
                }

            };
        };

        ko.bindingHandlers.foreach.update(element, newValue, allBindingsAccessor, viewModel, bindingContext);

        //if we have not previously marked this as initialized and there is currently items in the array, then cache on the element that it has been initialized
        if (!ko.utils.domData.get(element, key) && (value.data || value.length)) {
            ko.utils.domData.set(element, key, true);
        }

        return { controlsDescendantBindings: true };
} 
```

};

[带有引导程序的jsfiddle](http://jsfiddle.net/zachpainter77/wv3rjygy/)

# search - 修改 Windows 7 开始菜单搜索算法？

> ID：13622292
> 
> 赞同：9
> 
> 时间：2012-11-29T09:12:19.503
> 
> 标签：search, windows-7, fuzzy-search, windows-search

[我真的很喜欢Sublime Text 2](http://www.sublimetext.com/)用于其命令调色板的模糊匹配搜索算法，我希望创建类似的东西，它可以通过 Windows 7 开始菜单搜索运行。

我已经找到了[适用于 .NET Framework 的 Windows API 代码包，](http://archive.msdn.microsoft.com/WindowsAPICodePack)但它似乎只为在我自己的应用程序中使用现有的 Windows 搜索提供了 API 挂钩。

有没有办法修改或替换“开始”菜单搜索用于搜索已安装应用程序和文件的搜索算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-26T15:44:54.687

我很确定这是不可能的。但是编写一些覆盖搜索框和（如果搜索框中有东西）还有结果区域的东西应该不难。有了这个自定义小工具，使用您想要的任何搜索算法都不难。

# c++ - 在结构中使用枚举时 C++ 错误编译 C2275

> ID：13622296
> 
> 赞同：0
> 
> 时间：2012-11-29T09:12:30.893
> 
> 标签：c++, compilation, struct, typedef

我尝试使用 Windows 8 SDK 编译此代码：

```
typedef struct {
    enum { red, blue, green } eColor;
    /* other params here */
} StMyStruct;

void Myfunction(StMyStruct *pst) 
{
    if (pst->eColor==StMyStruct.red) {
        /* some code here */
    }

} 
```

**但是如果 pst->eColor==StMyStruct.red**，我会在线收到此错误：

> 错误 C2275：“StMyStruct”：非法使用此类型作为表达式

知道如何解决吗？

我使用 Windows SDK 7 成功编译了此代码，错误仅发生在 Windows 8 SDK 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:15:16.910

试试`StMyStruct::red`。

此外，您不需要`typedef`, 主要用于开发 C —— 在 C++ 中，您可以直接引用结构和类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:18:26.713

我不确定为什么用 SDK7 编译，但我认为枚举值是静态成员，`StMyStruct`所以应该通过`StMyStruct::`

```
typedef struct {
    enum { red, blue, green } eColor;
} StMyStruct;

void Myfunction(StMyStruct *pst) 
{
    if (pst->eColor==StMyStruct::red) {
        /* some code here */
    }
} 
```

使用 GCC 和 Visual Studio 为我干净地编译。

# vb.net - 如何从原始 URL Visual Basic .NET 中获取重定向的 URL

> ID：13622297
> 
> 赞同：4
> 
> 时间：2012-11-29T09:12:35.543
> 
> 标签：vb.net, vb.net-2010, url-redirection

# 如何从原始 URL 或短 URL 获取重定向 URL？

例如：

```
 URL_1 (Short URL) = "http://af.ly/FQhAo" 
```

这将重定向到

```
 URL_2 (Original URL) = "http://download.bitdefender.com/windows/desktop/t_security/2013/en-us/bitdefender_ts_2013_32b.exe" 
```

那么我们如何从 URL_1 获取 URL_2 呢？请帮忙。（我用谷歌搜索但没有找到任何解决方案）

项目信息：

*   平台：Visual Basic Express 2010
*   .NET 框架版本：2.0

谢谢你的时间。 **编辑：**

我只有一个 URL，即 URL_1，我想借助 URL1 获取 URL_2。

请参阅下图，著名软件如何立即从 URL_1（即短 URL 和已知字符串）获取 URL_2（即 100% 未知字符串）。我想在我的 Visual Basic .net 程序中做同样的事情。

![看到这张图片](../Images/0fd52c1e33fe352c1365f978bbe94498.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T20:00:33.830

我的问题现在解决了，感谢 google 和[Daniweb](http://www.daniweb.com/software-development/vbnet/threads/397434/how-to-get-redirected-url-as-string-after-request) 这里是解决方案

```
Dim req As HttpWebRequest = DirectCast(HttpWebRequest.Create("Your short URL here"), HttpWebRequest)
        Dim response As HttpWebResponse
        Dim resUri As String
        response = req.GetResponse
        resUri = response.ResponseUri.AbsoluteUri
        MsgBox(resUri) 
```

这将返回 URL_2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:50:47.457

为什么不将原始 URL 作为查询字符串参数传递？即在 url_1 中，重定向到：`http://pastehtml.com/view/b95qx66rc.html?redirectfrom=http://goo.gl/ouCeb`

然后在 url_2 中使用以下代码：

```
Dim OriginalURL As String = request.querystring("redirectfrom") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T17:39:08.813

URL_2 = "http://" & URL_1 & "/view/b95qx66rc.html"

# visual-studio-2008 - 尝试为文件 **** 附加自动命名数据库失败

> ID：13622299
> 
> 赞同：2
> 
> 时间：2012-11-29T09:12:40.660
> 
> 标签：visual-studio-2008, sql-server-express

我`app_data`在 VS2008 的解决方案文件夹中添加了新的数据库文件。

但是当我尝试从服务器资源管理器中扩展它时，我收到了这个错误

> *尝试为文件...附加自动命名的数据库失败。*

找到在 vs2008 IDE 中发生的错误的屏幕截图。

![在此处输入图像描述](../Images/104502d275458a7beb24488f40f4126b.png)

谁能告诉我问题是什么？

以及如何解决

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T15:48:35.757

该对话框中的错误很明显，您尝试附加的文件位于 UNC 共享上（任何以 \\ 开头的文件路径都是 UNC 路径），这是不受支持的。您需要将文件移动到您尝试将其附加到的服务器并通过其本地文件名引用它，例如 S:\SQLdata\TimeCard.mdf

# xaml - How to design a Conversation view in windows 8 Metro App?

> ID：13622300
> 
> 赞同：1
> 
> 时间：2012-11-29T09:12:40.043
> 
> 标签：xaml, windows-8, microsoft-metro

I'm Trying to design the Conversation View for a chat Application in windows 8 Metro App. I'm new to xaml designs, how to set the Conversation view like the image below,

![Conversation View](../Images/9cf18bfe532816db2fb752962c3a058f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:19:16.917

虽然第一次看起来这种布局可以适合三列的网格，但我相信你在某些时候需要滚动。因此，您可以只使用`Canvas`，它允许自由浮动控件。将它们与`Canvas.Left`附加`Canvas.Top`属性一起放置。

更新：我的意思的说明：

```
<Canvas Width="300" Height="200">
    <Border Width="40" Height="40" Canvas.Left="10" Canvas.Top="60" Background="Red"/>
    <Border Width="160" Height="80" Canvas.Left="60" Canvas.Top="60" Background="LightGray"/>
    <Border Width="40" Height="40" Canvas.Left="250" Canvas.Top="150" Background="Red"/>
    <Border Width="160" Height="30" Canvas.Left="80" Canvas.Top="150" Background="LightGray"/>
</Canvas> 
```

让我们假设红色边框是用户图片（放在`Image`里面），灰色边框是消息（放在`RichTextBlock`里面）。Canvas 允许您自由移动这些块。

# java - How to add simple product query in android App

> ID：13622302
> 
> 赞同：1
> 
> 时间：2012-11-29T09:12:42.517
> 
> 标签：java, android

I am new to Android. I have some Products like a0, a1, a2\. I want to add their definitions in the second line as x0, x1, x2.

Here is my main code:

```
private ListView lv;
ArrayAdapter<String> adapter;
ArrayList<HashMap<String, String>> productList;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_eagle);

 String products[] = {"a0", "a1","a2", };
 String definitions[] = {"x0", "x1","x2",};

lv = (ListView) findViewById(R.id.list_view);
    inputSearch = (EditText) findViewById(R.id.inputSearch);

    // Adding items to listview
    adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.product_name, products);
    lv.setAdapter(adapter); 
```

## What I find:

a0

* * *

a1

* * *

a2

* * *

**How can I find them in this way:**

* * *

a0

x0

* * *

a1

x1

* * *

a2

x2

* * *

Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:20:36.097

**-****默认** 只能`ArrayAdapter`处理**一个** 。`TextView`

**-**所以如果你想做一些类似显示 2 的事情`TextView`，那么最好使用`Custom ArrayAdapter`.

**请参阅此链接以获取自定义 ArrayAdapter 示例：**

[http://www.ezzylearning.com/tutorial.aspx?tid=1763429](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:20:41.640

您需要将适配器更改为以下内容：

```
adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_2, products){
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if(convertView == null)
             convertView = View.inflate(getBaseContext(), android.R.layout.simple_list_item_2, null);

        ((TextView) convertView.findViewById(android.R.id.text1)).setText(products[position]);
        ((TextView) convertView.findViewById(android.R.id.text2)).setText(definitions[position]);

        return convertView;
    }
}; 
```

# c# - 检索代码中的评分量表值

> ID：13622308
> 
> 赞同：0
> 
> 时间：2012-11-29T09:13:05.713
> 
> 标签：c#, sharepoint, scale, rating

我进行了一项调查，以在我的组织内登记知识。例如：

问题：

微软开发；

子问题：

共享点

客户关系管理

WCF

ETC...

人们可以使用评分量表对他们的熟练程度进行评分。最小值为 0，最大值为 6。

我不想从新图形功能中的响应中检索值。

我是新手，到目前为止这是我的代码：

```
var thisWeb = SPContext.Current.Web;

foreach (SPList item in thisWeb.Lists)
{
    if (item.Title.Contains("Knowledge"))
    {
         foreach (SPListItem child in item.GetItems())
         {
             foreach (SPField field in child.Fields)
             {
                  Debug.WriteLine(field.Title);
                  if (field.TypeAsString == "GridChoice")
                  {
                      var ratingscale = field.GetFieldValue(field.);
                      //var x = ratingscale.GetFieldValue(ratingscale.Choices.ToString());
                  }
              }
           } 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:57:49.280

```
 foreach (SPField field in item.Fields)
  {
        if (field.Type == SPFieldType.GridChoice)
        {

        SPFieldRatingScale srsc = (SPFieldRatingScale)field;
        Debug.WriteLine(srsc.GetFieldValueAsText(item[field.Title]));

          }
      } 
```

这将以下面的格式返回您的值。问题 1;#answer#question 2;#answer# .....

# sql - 如何在链接表中查找所有重复项？

> ID：13622309
> 
> 赞同：4
> 
> 时间：2012-11-29T09:13:10.497
> 
> 标签：sql, sql-server-2008

我有一个包含这些列的表：

```
1\. ID_Table1
2\. ID_Table1LinkTable2
3\. ID_Table1LinkTable2 
```

我需要按列查找所有重复项`ID_Table1LinkTable2, ID_Table1LinkTable2`

并删除这些行。

我怎样才能做到这一点？

感谢提前

例如我有

```
ID_Table1  ID_Table1LinkTable2 ID_Table1LinkTable2
--------------------------------------------------    
     1            123                   322
     2            123                   432
     3            123                  3432
     4            123                   322 
```

我需要删除最后一行

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T09:23:39.323

```
delete from yourtable
where ID_Table1 not in 
(select MIN(ID_Table1) from yourtable group by ID_Table1LinkTable2, ID_Table1LinkTable2) 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-29T09:16:02.063

`ALTER IGNORE TABLE table ADD UNIQUE(ID_Table1)`

`ALTER IGNORE TABLE table ADD UNIQUE(ID_Table1LinkTable2)`

这将删除重复项。

# openoffice.org - 为 Windows 编辑 .sdi 文件的程序

> ID：13622310
> 
> 赞同：0
> 
> 时间：2012-11-29T09:13:12.803
> 
> 标签：openoffice.org

我想编辑`.sdi`在 Open Office 文件中使用的文件。我可以用 OO Calc 打开它，但保存后它不再工作了。我读到了这个`sCal`Linux 程序。但我找不到类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:52:23.933

错误在于 Open Office Calc 使用了`;`和`whitespaces`.

应该只是`whitespaces`

# python - __deepcopy__ 和在 __init__ 中更改参数的继承

> ID：13622313
> 
> 赞同：2
> 
> 时间：2012-11-29T09:13:16.590
> 
> 标签：python, inheritance, deep-copy

当从基类继承时，实现`__deepcopy__`并且继承类更改了中的参数`__init__`，如何`__deepcopy__`在继承类中重用来自基类的参数？

这里有一个例子：

```
class A(object):
    def __init__(self, arg1, arg2):
        self.arg1 = arg1
        self.arg2 = arg2

    def __deepcopy__(self, memo):
        newone = type(self)(self.arg1, self.arg2)
        ...

class B(A):
    def __init__(self, arg1):
        A.__init__(self, arg1, None)

    def __deepcopy__(self, memo):
        newone = A.__deepcopy__(self, memo) # fails, because __deepcopy__ of
                                            # A tries to create an instance of
                                            # B with to many arguments
        ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:16:35.777

你可以通过接受任意数量的参数来解决这个问题，在你自己的构造函数中忽略它们：

```
class B(A):
    def __init__(self, arg1, *ignored):
        # `ignored` is.. ignored
        A.__init__(self, arg1, None) 
```

由于无论如何您都将`A.__init__()`with作为第二个位置参数调用，因此在再次将其传递回实例初始化程序`None`时忽略相同的参数是安全的。`__deepcopy__`

# javascript - 如何防止 MVC 对必填字段的不显眼验证也激活电子邮件验证？

> ID：13622319
> 
> 赞同：4
> 
> 时间：2012-11-29T09:13:33.360
> 
> 标签：javascript, asp.net, asp.net-mvc-3, jquery-validate

我有一个 ASP.NET MVC 登录表单，它使用客户端不显眼的验证。

我的登录模型有一个带有`[Required]`属性的用户名。输入的大多数用户名都是电子邮件地址，所以在触摸设备上，我想展示一个漂亮的电子邮件友好型键盘。所以我设置`type="email"`了`<input>`，像这样：

```
@Html.TextBoxFor(m => m.UserName, new { type = "email" }) 
```

现在，我不想验证电子邮件地址（因为非电子邮件用户名是有效的），但不知何故，因为我有一个`[Required]`属性，默认的 jquery.validate 电子邮件验证也会启动，给我一个“请输入有效的电子邮件地址错误。

有什么方法可以防止这种情况，同时保持必填字段验证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:25:22.897

解决方案非常简单：

```
$('#loginform').data("validator").settings.rules["UserName"].email = false; 
```

使用多个规则集（来自 jquery.validate.js）验证输入字段：

```
 var data = $.validator.normalizeRules(
    $.extend(
        {},
        $.validator.metadataRules(element),
        $.validator.classRules(element),
        $.validator.attributeRules(element),
        $.validator.staticRules(element)
    ), element); 
```

这`attributeRules`是导致电子邮件验证被激活的原因，但是由于`staticRules`优先考虑，电子邮件验证在我们上面的任务中被停用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:42:51.060

也许是一个愚蠢的建议，但如何删除 [Required] 属性并在控制器中处理它的后期操作？:)

# python - 在python中拆分文本文件

> ID：13622326
> 
> 赞同：1
> 
> 时间：2012-11-29T09:14:05.763
> 
> 标签：python, text

我有一个文本文件，其中一些记录具有相似的字段。

```
 name:
    Class:
    Subject:
    name:
    Class:
    Subject: 
```

如上所述，这个文件可以有任意数量的记录，我想用各自的字段分隔每条记录。以下是我为了解决这个问题可以达到的程度。

```
 def counter(file_path):
       count = 0
       file_to_read = open(file_path)
       text_to_read = file_to_read.readlines()
       file_to_read.close()
       for line in text_to_read:
           if line.find('name') != -1:
              count = count + 1
       return count 
```

这样我就可以数数了。文件中存在的记录，现在我发现很难将整个文本文件分成等于 no 的段。的记录。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:20:45.500

```
def records(file_path):
    with open(file_path) as f:
        chunk = []
        for line in f:
            if 'name' in line:
                if chunk:
                    yield chunk
                chunk = [line]
            else:
                chunk.append(line)
        if chunk:
            yield chunk

for record in records('data.txt'):
    print '--------'
    print ''.join(record) 
```

印刷

```
--------
    name:
    Class:
    Subject:

--------
    name:
    Class:
    Subject: 
```

# c# - 如何在 AutoMapper 中指定特定类型之间的自定义映射？

> ID：13622331
> 
> 赞同：1
> 
> 时间：2012-11-29T09:14:15.337
> 
> 标签：c#, .net, automapper

我需要将所有 DateTime 值呈现为本地值，但将它们存储为 UTC。我如何告诉 AutoMpapper 将 MappedViewModel 映射到 EntityBase 时，它​​必须将日期从本地转换为 UTC，反之亦然？

我已经知道如何进行转换，所以这个问题只适用于映射。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:17:45.323

你能用[自定义类型转换器](http://automapper.codeplex.com/wikipage?title=Custom%20Type%20Converters)做到这一点吗？注册后，它们似乎是全局范围的，因此理论上，您可以将其应用于所有 DateTime 类型。

# xml - 如何在 XSLT 中实现 if-else 语句？

> ID：13622338
> 
> 赞同：192
> 
> 时间：2012-11-29T09:14:45.603
> 
> 标签：xml, xslt, if-statement

我正在尝试在 XSLT 中实现 if -else 语句，但我的代码无法解析。有没有人有任何想法？

```
 <xsl:variable name="CreatedDate" select="@createDate"/>
  <xsl:variable name="IDAppendedDate" select="2012-01-01" />
  <b>date: <xsl:value-of select="$CreatedDate"/></b> 

  <xsl:if test="$CreatedDate > $IDAppendedDate">
    <h2> mooooooooooooo </h2>
  </xsl:if>
  <xsl:else>
    <h2> dooooooooooooo </h2>
  </xsl:else> 
```

* * *

## 回答 #1

> 赞同：365
> 
> 时间：2012-11-29T09:17:25.917

您必须使用`<xsl:choose>`标签重新实现它：

```
<xsl:choose>
  <xsl:when test="$CreatedDate > $IDAppendedDate">
    <h2> mooooooooooooo </h2>
  </xsl:when>
  <xsl:otherwise>
    <h2> dooooooooooooo </h2>
  </xsl:otherwise>
</xsl:choose> 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2012-11-29T09:23:49.410

if 语句用于快速检查一个条件。当您有多个选项时，请`<xsl:choose>`如下图所示使用：

```
 <xsl:choose>
     <xsl:when test="$CreatedDate > $IDAppendedDate">
       <h2>mooooooooooooo</h2>
     </xsl:when>
     <xsl:otherwise>
      <h2>dooooooooooooo</h2>
     </xsl:otherwise>
   </xsl:choose> 
```

此外，您可以使用多个`<xsl:when>`标签来表达`If .. Else If`或`Switch`模式，如下图所示：

```
 <xsl:choose>
     <xsl:when test="$CreatedDate > $IDAppendedDate">
       <h2>mooooooooooooo</h2>
     </xsl:when>
     <xsl:when test="$CreatedDate = $IDAppendedDate">
       <h2>booooooooooooo</h2>
     </xsl:when>
     <xsl:otherwise>
      <h2>dooooooooooooo</h2>
     </xsl:otherwise>
   </xsl:choose> 
```

前面的例子等价于下面的伪代码：

```
 if ($CreatedDate > $IDAppendedDate)
   {
       output: <h2>mooooooooooooo</h2>
   }
   else if ($CreatedDate = $IDAppendedDate)
   {
       output: <h2>booooooooooooo</h2>
   }
   else
   {
       output: <h2>dooooooooooooo</h2>
   } 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2014-10-21T16:19:12.050

*如果我可以提供一些建议（两年后但希望对未来的读者有所帮助）*：

*   分解出共同的`h2`元素。
*   分解出常见的`ooooooooooooo`文本。
*   `if/then/else`如果使用 XSLT 2.0 ，请注意新的 XPath 2.0构造。

## XSLT 1.0 解决方案^([[（也适用于 XSLT 2.0）]])

```
<h2>
  <xsl:choose>
    <xsl:when test="$CreatedDate > $IDAppendedDate">m</xsl:when>
    <xsl:otherwise>d</xsl:otherwise>
  </xsl:choose>
  ooooooooooooo
</h2> 
```

## XSLT 2.0 解决方案

```
<h2>
   <xsl:value-of select="if ($CreatedDate > $IDAppendedDate) then 'm' else 'd'"/>
   ooooooooooooo
</h2> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-02-29T18:05:24.770

最初来自这篇[博文](https://aabingunz.com/xsl-if-else/)。我们可以通过使用下面的代码来实现 if else

```
<xsl:choose>
    <xsl:when test="something to test">

    </xsl:when>
    <xsl:otherwise>

    </xsl:otherwise>
</xsl:choose> 
```

所以这就是我所做的

```
<h3>System</h3>
    <xsl:choose>
        <xsl:when test="autoIncludeSystem/autoincludesystem_info/@mdate"> <!-- if attribute exists-->
            <p>
                <dd><table border="1">
                    <tbody>
                        <tr>
                            <th>File Name</th>
                            <th>File Size</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>AM/PM</th>
                        </tr>
                        <xsl:for-each select="autoIncludeSystem/autoincludesystem_info">
                            <tr>
                                <td valign="top" ><xsl:value-of select="@filename"/></td>
                                <td valign="top" ><xsl:value-of select="@filesize"/></td>
                                <td valign="top" ><xsl:value-of select="@mdate"/></td>
                                <td valign="top" ><xsl:value-of select="@mtime"/></td>
                                <td valign="top" ><xsl:value-of select="@ampm"/></td>
                            </tr>
                        </xsl:for-each>
                    </tbody>
                </table>
                </dd>
            </p>
        </xsl:when>
        <xsl:otherwise> <!-- if attribute does not exists -->
            <dd><pre>
                <xsl:value-of select="autoIncludeSystem"/><br/>
            </pre></dd> <br/>
        </xsl:otherwise>
    </xsl:choose> 
```

**我的输出**

![在此处输入图像描述](../Images/e4dcb5fc9edeace45a6dd23230621d78.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-14T03:16:49.623

最直接的方法是进行第二次 if 测试，但条件相反。这种技术比选择时嵌套块更短，更容易看，也更容易正确：

```
<xsl:variable name="CreatedDate" select="@createDate"/>
     <xsl:variable name="IDAppendedDate" select="2012-01-01" />
     <b>date: <xsl:value-of select="$CreatedDate"/></b> 
     <xsl:if test="$CreatedDate &gt; $IDAppendedDate">
        <h2> mooooooooooooo </h2>
     </xsl:if>
     <xsl:if test="$CreatedDate &lt;= $IDAppendedDate">
        <h2> dooooooooooooo </h2>
     </xsl:if> 
```

这是政府网站样式表中使用的技术的真实示例： [http ://w1.weather.gov/xml/current_obs/latest_ob.xsl](http://w1.weather.gov/xml/current_obs/latest_ob.xsl)

# c# - Outlook-addin 中的“GDI 中发生一般错误”

> ID：13622339
> 
> 赞同：3
> 
> 时间：2012-11-29T09:14:49.157
> 
> 标签：c#, image, user-interface, gdi+, outlook-addin

我们的产品是 Microsoft Office 的插件，其中包含一些 GUI。

我们`Graphics.DrawImage`用来绘制图像。

问题是我们有一个**特定的用户**报告了一些问题，即 GUI 没有出现在 Microsoft Outlook 中，但同时它在 Microfot Word 中运行良好。

我在日志中看到的错误是：

```
System.Runtime.InteropServices.ExternalException: A generic error occurred in GDI+.
    at System.Drawing.Graphics.CheckErrorStatus(Int32 status)
    at System.Drawing.Graphics.DrawImage(Image image, Int32 x, Int32 y, Int32 width, Int32 height) 
```

我知道这可能意味着某种资源有限的问题，但问题是相同的 GUI 在 Microsoft Word 中运行得非常好。此外，我们尝试绘制的图像是一个 16x16 的小图标。

特定过程是否存在任何可能导致这种情况的限制？

**更新**：问题出现在未从文件流正确加载的特定图像上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T16:44:42.790

使用 a`MemoryStream`时，重要的是在图像的所有使用过程中保持流处于活动状态，直到图像被释放。这是因为图像有时需要从内存流所代表的内存区域中读取。

如果在处理图像之前关闭流，则内存区域可能会或可能不会变得无效。

~~当您处理图像时，流也将被关闭。~~

# primefaces - PrimeFaces 从 3.4 更新到 3.4.2 后向导组件不起作用

> ID：13622342
> 
> 赞同：2
> 
> 时间：2012-11-29T09:14:53.963
> 
> 标签：primefaces, upgrade, wizard

**由于PickList**组件中的性能错误，我最近将**PrimeFaces**从**3.4**升级到**3.4.2 。**此次升级后，我的**向导**组件已停止运行。

 ****我正在使用自定义按钮进行导航，使用`widgetVar`,`next()`和`prev()`用户指南 3.4 定义的。

```
<p:wizard widgetVar="wiz" flowListener="#{wizard.onFlowProcess}"
            showStepStatus="false" showNavBar="false">

<p:commandButton value="Weiter" onclick="wiz.next()" update="dialogRespHeader"> 
```

这在 3.4 版中有效。单击按钮后更新后，无论我等待多长时间，都会显示等待*进度动画，并且没有任何反应。*没有对服务器的挂起请求：单击按钮后立即发送请求，响应也随之而来。它看起来正确：

```
<partial-response>
<changes>
<update id="mainForm:j_id1831660928_7d431f69"> [some content]
<extension ln="primefaces" type="args">{"currentStep":"internUserTab"}</extension>
<extension ln="primefaces" type="args">{"currentStep":"internUserTab"}</extension>
</changes>
</partial-response> 
```

所以问题是：这个版本之间有什么变化？这是一个错误，还是 API 更改（我找不到有关此组件的 api 更改的任何信息）。

**更新** FireBug 控制台显示错误：

```
SyntaxError: JSON.parse: unexpected non-whitespace character after JSON data 
```

它会是 jQuery 1.8.2 中的错误吗？这是这些版本之间最大和最危险的变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T10:58:45.823

这是PrimeFaces 中的一个**错误，它通过浏览器****缓存**资源。

jQuery 的版本发生了变化，但资源的名称保持不变，因此浏览器将从缓存中加载旧版本的 jQuery，**直到您清除缓存**。

从 3.4 迁移到 3.5 多次复制。在各种组件的所有情况下都会发生，摆脱它的唯一方法是向所有用户发送信息，并附上清理浏览器缓存的说明。****

# php - 一次更改所有页面上的“DIV”内容的最简单方法

> ID：13622345
> 
> 赞同：0
> 
> 时间：2012-11-29T09:15:08.707
> 
> 标签：php, css, html

网站中的某些 DIV 通常可以保持不变...

IE 网页的页脚通常不会改变，应该是所有页面的标准。

在网站 CSS 中，您将拥有以下内容；

```
.FooterDIV {
     Background: #FFFFFF;
     Color: #000000;
 } 
```

我想知道在 DIV 中指定标准文本的最佳方法是什么，这仅在 CSS 中可行吗？PHP 也许？

经过一些“谷歌搜索”后，我没有找到明确的答案 - 很难知道如何措辞。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:19:05.167

一种简单的方法是将这些“全局”元素分别放入一个单独的 php 文件中，您将其包含在所有页面中。例如：

页脚.php

```
<div>Copyright 2012, Acme Corp.</div> 
```

然后只需在您希望页脚出现的任何位置添加以下行

```
<?php include('footer.php'); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:17:30.403

> 级联样式表 (CSS) 是一种样式表语言，用于描述以标记语言编写的文档的表示语义（外观和格式）。

即你应该用 CSS 来设置你的数据样式。您不应该使用它来指定您的数据是什么。肯定有更好的方法来解决您的问题吗？就像将您网站上重复出现的元素/div 拆分为包含文件一样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:20:05.407

这通常在服务器端完成，在您的情况下，在 PHP 中，您创建一个编写 html 页脚的函数，然后为您的任何 php 页面调用此函数。

此外，如果您正在使用模板引擎，例如当您使用 MVC PHP 框架时，那么模板引擎通常会让您创建一个包含页脚内容的模板文件，并且您将在所有不同的页面模板中包含相同的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:20:16.983

你所描述的不能在css中完成。如果您使用的是 php，我会将页脚分隔到单独的文件中，例如“footer.php”，然后将其[包含](http://php.net/manual/en/function.include.php "包括")在每个页面的底部。

# assembly - 什么是汇编程序中的不可用内存？（TASM）

> ID：13622346
> 
> 赞同：0
> 
> 时间：2012-11-29T09:15:11.657
> 
> 标签：assembly

正如我在书中读到的，通过地址 [2]，我们可以找到不可用内存的第一个字节的地址。我试着写一些东西然后读它。如果我没有犯错，我做了这个操作。那么汇编程序中什么是不可用内存？

```
CODE SEGMENT                  
ASSUME CS:CODE, DS:CODE, ES:NOTHING

org 256     
;------start-------
STARTPROC       PROC

        mov di, 2
        ;in ax is adress of unavailible byte                    
        mov ax, [di]                                
        ;now es point on unavailable memory
        mov es, ax
        mov bx, 0FFFFh
        ;write with offset=2
        mov es:[di], bx

        ;read es:[di]
        mov ax, es:[di]
        mov di, offset temp
        add di, 3
        call WRD_TO_HEX
        mov dx, offset temp

        mov ah, 09h
        int 21h

        ret
STARTPROC       ENDP    

temp        db 4    DUP ('0'), '$'

TETR_TO_HEX     PROC near
        and AL, 0Fh
        cmp AL, 09
        jbe NEXT
        add AL, 07
   NEXT:add AL, 30h
        ret
TETR_TO_HEX     ENDP

BYTE_TO_HEX     PROC near
        push CX
        mov AH, AL
        call TETR_TO_HEX
        xchg AL,AH
        mov CL, 4
        shr AL, CL
        call TETR_TO_HEX
        pop CX
        ret
BYTE_TO_HEX     ENDP

WRD_TO_HEX      PROC near
        push BX
        mov BH, AH
        call BYTE_TO_HEX
        mov [DI], AH
        dec DI
        mov [DI], AL
        dec DI
        mov AL, BH
        call BYTE_TO_HEX
        mov [DI], AH
        dec DI
        mov [DI], AL
        pop BX
        ret
WRD_TO_HEX      ENDP

CODE ENDS
        end STARTPROC 
```

解析信息需要 Proc TETR_TO_HEX、BYTE_TO_HEX、WRD_TO_HEX。

我将 FFFF 写入偏移量 = 2 的不可用内存，然后正确读取。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:27:31.293

第二条指令

```
 mov ax, [di] 
```

似乎假设 ds 指向段 0。您想要的地址可能在绝对地址（实模式）上，因此是 0000:0002，因此请确保保存一个段寄存器，用 0 加载它，并在上面的指令中使用它。

在更改段寄存器之前，先将其压入堆栈，然后再将其弹出。（在您返回或调用另一个过程或系统之前）

# dynamics-crm-2011 - 从 web 资源中引用 web 资源

> ID：13622349
> 
> 赞同：0
> 
> 时间：2012-11-29T09:15:16.510
> 
> 标签：dynamics-crm-2011

我上传了两个资源 - *a.HTML*和*b.PNG*。在*a*我想显示*b*并且根据[这个博客](http://blogs.msdn.com/b/darrenliu/archive/2011/02/07/reference-an-image-in-web-resource-from-site-map-or-ribbon.aspx)我应该这样。

```
<img src="$webresource:b.png"> 
```

但是，我想知道是否还有其他语法（最好是不包含*$webresource:*部分的语法）。我尝试了一些不同的组合，但并没有真正成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T10:12:01.620

您链接到的文章解释了如何从功能区或站点地图中引用 Web 资源。这与您的目标不同，您的目标是从另一个引用一个 Web 资源。

[CRM SDK](http://msdn.microsoft.com/en-us/library/gg309473.aspx#BKMK_ReferencingWebResources)指出：

> 从不支持使用 $webresource: 指令的区域引用 Web 资源时，...

（请注意，Web 资源本身不支持该`$webresource:`指令）

> ...可以使用相对 URL。要启用此功能，我们建议您对反映虚拟文件结构的 Web 资源使用一致的命名约定。解决方案发布者的自定义前缀将始终作为 Web 资源名称的前缀。这可以代表该发布者添加的所有 Web 资源的虚拟“根”文件夹。然后，您可以使用正斜杠字符 (/) 来模拟 Web 服务器将采用的文件夹结构。

因此，如果您有两个名为的 Web 资源：

1.  new_/html/mypage.html
2.  new_/img/myimage.png

您`mypage.html`可以这样参考图像：

```
<img src="../img/myimage.png"/> 
```

暗示，如果您的资源 (`a.HTML`和`b.PNG`) 没有虚拟路径，则像这样引用图像就足够了（尽管我强烈建议使用上述虚拟路径约定）：

```
<img src="b.PNG"/> 
```

# c - 有没有办法只在运行二进制文件时从特定位置加载用户库

> ID：13622351
> 
> 赞同：3
> 
> 时间：2012-11-29T09:15:29.193
> 
> 标签：c, unix, gcc

我在 /opt/my_prog/lib 和 /home/user1/lib 中有一个共享库的 libmyworld.so，无论我在 LD_LIBRARY_PATH (LD_LIBRARY_PATH=/home/user1/lib;/opt/myprog/lib) 中指定的顺序如何；我的二进制文件应该总是在 /opt/my_prog/lib 中寻找 libmyworld.so FIRST；

这可以在编译期间使用 GCC 来完成吗？无需修改 my_prog 二进制文件。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T10:25:10.413

Linux 中动态库的搜索顺序（来自 ld.so 手册页）如下

> *   使用二进制文件的 DT_RPATH 动态部分属性（如果存在）并且 DT_RUNPATH 属性不存在。不推荐使用 DT_RPATH。
> *   使用环境变量 LD_LIBRARY_PATH。除非可执行文件是 setuid/setgid 二进制文件，在这种情况下它会被忽略。
> *   使用二进制文件的 DT_RUNPATH 动态部分属性（如果存在）。
> *   来自缓存文件 /etc/ld.so.cache，其中包含先前在扩充库路径中找到的候选库的编译列表。但是，如果使用 -z nodeflib 链接器选项链接二进制文件，则会跳过默认库路径中的库。
>     *   在默认路径 /lib 中，然后是 /usr/lib。如果二进制文件使用 -z nodeflib 链接器选项链接，则跳过此步骤。

链接时，设置

*   DT_RUNPATH：使用 -Wl,--enable-new-dtags -Wl,-R$(RUNPATH)
*   DT_RPATH：使用 -Wl,--disable-new-dtags -Wl,-R$(RPATH)

理论上，最好使用 DT_RUNPATH 作为用户可以控制的 LD_LIBRARY_PATH 优先。但是这里要避免用户控制，所以使用DT_RPATH。在您的链接行中：

```
-Wl,--disable-new-dtags -Wl,-R/opt/my_prog/lib 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:35:18.290

你总是可以启动你的二进制文件（这里称为*foo*）

```
$ LD_LIBRARY_PATH=/opt/my_prog/lib foo 
```

或使用上面的行制作一个 shell 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T12:05:45.290

编译源代码时使用以下命令 gcc -o [desired_executable_file_name] -L [Your shared library path] -l [your shared library name] -I [Header file path]

例如在你的情况下 gcc -o my_word_exe -L /opt/my_prog/lib -lmyworld -I [header path if they]

然后它会在 /opt/my_prog/lib 这个路径中使用 libmyworld.so

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-29T09:49:59.800

使用 LD_PRELOAD。

`LD_PRELOAD=/home/lib/libmyworld.so mybinary`

优点是您不必摆弄 LD_LIBRARY_PATH - 您的二进制文件可能依赖于其他共享库，并且可能需要适当的`LD_LIBRARY_PATH/ld.so.conf/whatever`.

PS。这是侵入性最小且灵活的解决方案，因为不影响其他库的加载，也不会对用户可执行文件中的路径进行硬编码。

# c++ - hash_map/unordered_map 中的项目顺序是否稳定？

> ID：13622361
> 
> 赞同：1
> 
> 时间：2012-11-29T09:16:12.297
> 
> 标签：c++, stl, hashmap, unordered-map

是否保证当 hash_map/unordered_map 加载相同的项目时，它们在迭代时将具有相同的顺序？基本上我有一个从文件加载的哈希图，我会定期将有限数量的项目提供给例程，然后释放哈希图。消费完项目后，我将相同的文件重新加载到哈希图中，并希望在我上次停止的点之后获取下一批项目。我停止的点将由钥匙识别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:29:16.247

从技术上讲，不，不能保证它们按任何特定顺序排列。

然而，在实践中，鉴于您使用确定性哈希函数，您想要做的应该没问题。

考虑

```
std::string name;
std::string value;

std::unordered_map <std::string, std::string> map1;
std::unordered_map <std::string, std::string> map2;

while (read_pair (name, value))
{
    map1[name] = value;
    map2[name] = value;
} 
```

您可以合理地期望名称-值对以相同`map1`的`map2`顺序出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T10:00:50.430

不，你不能安全地做到这一点。首先，标准并不能保证，但即使您忽略标准并查看实际实现，这也是一个坏主意。

大多数哈希表结构都不是*历史独立*的。即：哈希表的状态不仅取决于它包含什么项目，还取决于它们被插入的*顺序。*

这是一个具体的例子：

```
#include <unordered_map>
#include <string>
#include <iostream>

static const char* const NAMES[] = {
    "joe",
    "bob",
    "alexander",
    "warren",
    "paul",
    "michael",
    "george",
    "david",
    "peter"
};
static const int NAME_COUNT = sizeof(NAMES)/sizeof(NAMES[0]);

static void print_umap(const std::unordered_map<std::string, int>& m) {
    for (const auto& item : m) {
        std::cout << "  " << item.first << "\n";
    }
}

int main(void) {
    std::unordered_map<std::string, int> a;
    std::unordered_map<std::string, int> b;
    std::unordered_map<std::string, int> c;

    for (int i = 0; i < NAME_COUNT; ++i) {
        a[NAMES[i]] = 0;
        b[NAMES[NAME_COUNT - 1 - i]] = 0;
    }

    for (const auto& item : a) {
        c[item.first] = 0;
    }

    std::cout << "a:\n";
    print_umap(a);
    std::cout << "\n\nb:\n";
    print_umap(b);
    std::cout << "\n\nc:\n";
    print_umap(c);
    return 0;
} 
```

当我使用[clang](http://clang.llvm.org/)和 C++ 标准库的[libc++](http://libcxx.llvm.org/)实现构建它时，我得到以下输出：

```
a:
  peter
  george
  michael
  david
  paul
  bob
  warren
  alexander
  joe

b:
  joe
  alexander
  bob
  warren
  david
  paul
  michael
  george
  peter

c:
  joe
  alexander
  warren
  bob
  paul
  david
  michael
  george
  peter 
```

请注意，每种情况下的顺序都不同。这对于哈希表来说一点也不稀奇。

# java - 如何避免使用 Maven 在 EAR/WAR 中重复派生依赖项？

> ID：13622365
> 
> 赞同：3
> 
> 时间：2012-11-29T09:16:20.010
> 
> 标签：java, jakarta-ee, maven

为了使示例尽可能简单，假设我有经典的 Java EE 5 应用程序。
假设我`x-lib`在 EAR 模块中使用，并`x-lib`使用`commons-io`.
我`y-lib`也在 WAR 模块中使用，并且也`y-lib`使用`commons-io`。EAR 设置为WAR中*提供的。*

我得到的结果是：

```
- app.ear
    /lib
       x-lib.jar
       commons-io.jar
    /app.war
       /WEB-INF
          /lib
             y-lib.jar
             commons-io.jar 
```

我不希望将 commons-io`app.war/WEB-INF/lib`打包在`app.ear/lib`.

在我的战争 pom.xml 我有：

```
<dependency>
   <groupId>my.group</groupId>
   <artifactId>app</artifactId>
   <type>ejb</artifact>
   <scope>provided</scope>  
   <version>${project.version}</version>
</dependency>

<dependency>
   <groupId>some.other.group</groupId>
   <artifactId>y-lib</artifactId> <!-- This loads commons-io as compile dependency -->
   <version>1.2.3</version>
</dependency> 
```

有没有办法告诉 maven 我希望与应用程序 ejb 依赖项一起提供的所有内容都应该设置为提供而不包含在 WAR 中？

**我不想跟踪所有那些重复的 JAR 并将它们设置为提供或明确排除。**

*编辑*

我知道瘦身战解决方案。但是我不喜欢在 WAR 和 EAR 中复制依赖项的 drwaback。也许你知道如何克服这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-05T15:32:44.633

从 2.7 版开始`maven-ear-plugin`，您可以使用 SkinnyWars。
请参阅此处了解规格： [https ://maven.apache.org/plugins/maven-ear-plugin/examples/skinny-wars.html](https://maven.apache.org/plugins/maven-ear-plugin/examples/skinny-wars.html)

基本上，您可以将`skinnyWars`标签添加到插件配置中：

```
<plugin>
  <artifactId>maven-ear-plugin</artifactId>
  <version>2.10.1</version>
  <configuration>
    <defaultLibBundleDir>lib/</defaultLibBundleDir>
    <skinnyWars>true</skinnyWars>
  </configuration>
</plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T14:38:46.370

> 有没有办法告诉 maven 我希望与应用程序 ejb 依赖项一起提供的所有内容都应该设置为提供而不包含在 WAR 中？

在这种情况下，现在最好的选择是[在依赖排除中使用通配符](https://jira.codehaus.org/browse/MNG-3832)。它仅在 maven 3 中受支持。

下面是一个如何从 war 项目中声明 ejbmodule 依赖项的示例：

```
 <dependency>
        <groupId>ejbModuleGroupId</groupId>
        <artifactId>ejbModuleArtifactId</artifactId>
        <scope>provided</scope>
        <type>ejb</type>
        <exclusions>
          <exclusion>
            <groupId>*</groupId>
            <artifactId>*</artifactId>                
          </exclusion>
        </exclusions>
    </dependency> 
```

在向 ejb 客户端声明依赖项时，您可以使用相同的策略。

根据您的 maven 3 版本，您会收到一个[讨厌的警告](https://jira.codehaus.org/browse/MNG-5537)，但在较新的版本中它一定没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:53:30.620

如果您将 EJB 模块作为提供的依赖项添加到您的 war 模块并让该 EJB 的所有依赖项传递过来，那么这应该是自动的。所以不要将重叠的依赖项添加到你的war pom中，让Maven来处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:21:14.253

您需要像这样添加排除项：

```
<dependency>
   <groupId>some.other.group</groupId>
   <artifactId>y-lib</artifactId>
   <version>1.2.3</version>
   <exclusions>
      <exclusion>
          <groupId>commons-io</groupId>
          <artifactId>commons-io</artifactId>
      </exclusion>
   </exclusions>
</dependency> 
```

# testing - RSpec：如何用重音编写测试？

> ID：13622367
> 
> 赞同：2
> 
> 时间：2012-11-29T09:16:35.010
> 
> 标签：testing, rspec, cucumber

我是黄瓜和 rspec 的新手，我正在尝试测试一个文本为“Regístrate”的按钮（看看重音“í”）。

在我的应用程序中，我有很多用西班牙语编写的控件，带有重音 á é í ó ú。但是由于这些带有重音的元音，我得到了一个错误。我确信有一个简单的解决方案，但我没有找到解决方案。

我可以更改测试描述，但不能更改用户应用程序中的文字……有什么建议吗？

```
describe "signup" do

  before { visit signup_path }

  let(:submit) { "Regístrate" }

  describe "con información válida" do
    it "no debería crear el usuario" do
      expect { click_button submit }.not_to change(User, :count)
    end
  end

  describe "con información válida" do
    before do
      fill_in "Nombre",         with: "Example User"
      fill_in "Email",        with: "user@example.com"
      fill_in "Password",     with: "foobar"
      fill_in "Confirmación", with: "foobar"
    end

    it "debería crear el usuario" do
      expect { click_button submit }.to change(User, :count).by(1)
    end
  end
end 
```

错误：

```
user_signup_steps.rb:3: syntax error, unexpected $end, expecting keyword_end
"Regístrate"
   ^ (SyntaxError) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:23:36.337

看起来像一个编码错误。尝试将此行添加到规范文件的顶部：

```
# encoding: utf-8 
```

# php - 更新时查询为空

> ID：13622369
> 
> 赞同：1
> 
> 时间：2012-11-29T09:16:55.267
> 
> 标签：php, mysql

我在更新时遇到“查询为空”的问题。

我的查询是：

```
$infnav = mysql_query(utf8_decode("UPDATE `Opérations n°1` SET nomnav='$nomnav', typenav='$typenav', callsign='$callsign', imo='$imo', mmsi='$mmsi', immat='$immat', proprio='$proprio', portbase='$portbase', flag='$flag', long='$long'")); 
```

当我删除 long='$long' 时，我的查询工作得很好。当我将数据放入 long 时，回显 $long; 返回正确的值并返回查询为空错误。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:19:33.897

这是因为您的查询有语法错误，`LONG`是一个**[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)**，所以您应该使用反引号将其转义

```
UPDATE ...... portbase='$portbase', flag='$flag', `long`='$long' 
```

并且您的查询很容易受到`SQL injection`，请阅读下面的文章以防止它，

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection)

# ubuntu-10.04 - 在 Ubuntu 10.04 单节点上安装 Cloudstack 3.0

> ID：13622371
> 
> 赞同：0
> 
> 时间：2012-11-29T09:17:02.263
> 
> 标签：ubuntu-10.04, citrix

是否可以使用具有虚拟化支持 CPU 的 ubuntu 10.04 64 位在单个节点上安装 cloudstack 3.0？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T12:07:13.650

Yes, there are two approaches, but first some background.

For readers unaccustomed to cloud OS, let me explain that you will need at least two machines: one to run the CloudOS and another to be the compute node. The CloudOS is a managment server that allocates compute resources, the compute node is a machine running a hypervisor that supplies the resources being allocated.

'Single node' can mean either one physical server running the whole cloud or a cloud managing a single physical server, depending on whether you count the management server as a node.

To run everything on a single machine, you can simulate the compute node using a hypervisor. An example of this is [DevCloud](https://cwiki.apache.org/confluence/display/CLOUDSTACK/DevCloud), which runs the whole Cloudstack using VirtualBox. Provided you can get Virtualbox to run on Ubuntu 10.04, you are sorted.

If instead you want have two machines, and Ubuntu 10.04 is installed on the machine that you want to be the CloudStack management server, then you need to install the management server on Ubuntu. The binaries for running on Ubuntu 10.04 are at the bottom of the [Latest Release page](http://incubator.apache.org/cloudstack/downloads.html). There is a [video demonstrating the installation on youtube](http://www.youtube.com/watch?v=qAHdEPiXq74)

However, a better solution to upgrade. CloudStack 4.0 is built to run on Ubuntu 12.04\. Why not use this?

# php - Silex - 选项方法

> ID：13622377
> 
> 赞同：6
> 
> 时间：2012-11-29T09:17:17.330
> 
> 标签：php, rest, symfony, silex, http-method

我正在使用[Silex 框架](http://silex.sensiolabs.org/)来模拟 REST 服务器。我需要为 OPTIONS http 方法创建 uri，但`Application`类只提供 PUT、GET、POST 和 DELETE 方法。是否可以添加和使用自定义 http 方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:37:44.323

我做了同样的事情，但我不太记得我是如何让它工作的。我现在不能尝试。当然，您必须扩展`ControllerCollection`：

```
class MyControllerCollection extends ControllerCollection
{
    /**
     * Maps an OPTIONS request to a callable.
     *
     * @param string $pattern Matched route pattern
     * @param mixed  $to      Callback that returns the response when matched
     *
     * @return Controller
     */
    public function options($pattern, $to)
    {
        return $this->match($pattern, $to)->method('OPTIONS');
    }
} 
```

然后在您的自定义`Application`类中使用它：

```
class MyApplication extends Application
{
    public function __construct()
    {
        parent::__construct();

        $app = $this;

        $this['controllers_factory'] = function () use ($app) {
            return new MyControllerCollection($app['route_factory']);
        };
    }

    /**
     * Maps an OPTIONS request to a callable.
     *
     * @param string $pattern Matched route pattern
     * @param mixed  $to      Callback that returns the response when matched
     *
     * @return Controller
     */
    public function options($pattern, $to)
    {
        return $this['controllers']->options($pattern, $to);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-03T17:09:07.193

由于这个问题在谷歌搜索中仍然排名很高，我会注意到现在已经过了几年，Silex 添加了一个处理程序方法`OPTIONS`

[http://silex.sensiolabs.org/doc/usage.html#other-methods](http://silex.sensiolabs.org/doc/usage.html#other-methods)

当前可以直接用作函数调用的动词列表是：`get`, `post`, `put`, `delete`, `patch`, `options`. 所以：

```
$app->options('/blog/{id}', function($id) {
  // ...
}); 
```

应该工作得很好。

# asp.net - FormView/GridView 主/详细信息

> ID：13622380
> 
> 赞同：1
> 
> 时间：2012-11-29T09:17:27.740
> 
> 标签：asp.net, linq, entity-framework-4, ado.net, master-detail

我正在努力`asp.net framework 4`
寻找以下案例的一个很好的例子：

我有 formview 作为主数据，它包含人员数据：

*   person_data_id
*   人名
*   年龄
*   ……

formview 包含一个数据网格作为家庭成员的详细信息数据：

*   family_member_id
*   person_data_id
*   姓名
*   …………

我需要将详细数据保存到“DataTable”

页面有一个`insert`按钮，将主数据和明细数据都插入到 sql server 数据库中。我正在使用 linq 获取数据

我不知道如何在页面之间创建这种关系，也不知道如何`formview`一次`datagrid`将数据保存到数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:24:44.897

有很多教程，我建议asp.net网站，这里是数据访问点

[http://www.asp.net/web-forms/tutorials/data-access](http://www.asp.net/web-forms/tutorials/data-access)

一个类似的答案：[当用户选择记录时，推荐哪种方式来填充 Web 表单上的所有控件？](https://stackoverflow.com/questions/11358559/which-is-the-recommended-way-to-fill-all-controls-on-a-web-form-when-user-select/11358903#11358903)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T18:27:52.353

我解决了自己的问题，因为每个人都需要解决方案使用 RadGrid 我使用 NeedDataSource 事件绑定了详细信息 DataTable，从 Db 填充 DataTable 并设置为 datagrid 数据源

在 InsertCommand 中：从 datagrid 中读取值并将新行插入 DataTable

# iphone - NSFetchedResultsController 试图插入 nil 对象？

> ID：13622384
> 
> 赞同：4
> 
> 时间：2012-11-29T09:17:50.080
> 
> 标签：iphone, ios, core-data

很长一段时间以来，我遇到了一个奇怪的错误，我的大部分表格视图都变黑了（只有几个单元格保持[http://cl.ly/LFlS](http://cl.ly/LFlS)），而在其他视图中（连接到同一个 MOC）还有一些其他的视觉出现故障：[http](http://cl.ly/LH3c) ://cl.ly/LH3c （注意重复的部分标题）。我一直认为这是 CoreData 的一个错误，但直到今天它被连接到调试器时我才得以重现它。这是我在它发生之前得到的例外：

> CoreData：错误：严重的应用程序错误。在调用 -controllerDidChangeContent: 期间，从 NSFetchedResultsController 的委托中捕获了一个异常。 *** -[__NSArrayM insertObject:atIndex:]: 对象不能为 nil 和 userInfo (null)

`[tableView endUpdates]`它在我的`controllerDidChangeContent:`方法中停止了。然后，如果我单击继续，应用程序不会崩溃，但用户交互会变得非常缓慢。我四处寻找可能是导致该异常的原因，但找不到任何东西。有什么线索吗？

我的 NSFetchedResultsController 更改处理看起来很像 Apple 的样板文件。我的 NSFRC 的 init 如下所示：

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];

NSEntityDescription *entity = [NSEntityDescription entityForName:@"Artist" inManagedObjectContext:[SWDataManager sharedManager].mainObjectContext];
[request setEntity:entity];

[request setFetchBatchSize:100];

NSSortDescriptor *sortByName = [[NSSortDescriptor alloc] initWithKey:@"sortName" ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)];
[request setSortDescriptors:@[sortByName]];

fetchedResultsController = [[NSFetchedResultsController alloc]
                            initWithFetchRequest:request
                            managedObjectContext:mainObjectContext
                            sectionNameKeyPath:@"firstLetter"
                            cacheName:nil];

fetchedResultsController.delegate = self;
[self refreshDataSource]; // set fetch request predicate and call performFetch on NSFRC
return fetchedResultsController; 
```

编辑：我可以补充一点，这肯定发生在一堆对象从我的 MOC 中删除之后，因此从表视图中删除。

根据要求，我的`controllerDidChangeContent:`代码：

```
- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller {
    [self.tableView endUpdates];

    // this updates the section index and footer cell and other kind of stuff
    [self performSelector:@selector(layoutSpecialCells) withObject:nil afterDelay:0.3];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:05:24.070

我最终向 Apple 申请了 TSI，这是我得到的答案的要点：

> 为了保护数据存储的完整性，Core Data 会捕获一些在其操作期间发生的异常。有时这意味着如果 Core Data 通过委托方法调用您的代码，Core Data 最终可能会捕获您的代码抛出的异常。
> 
> 在这种情况下，Core Data 通过您的 -controllerDidChangeContent: 方法捕获了一个异常，该异常是由尝试使用 -insertObject:atIndex 放入`nil`NSMutableArray 引起的。

所以基本上这个异常是由我的代码引发的，而不一定是由核心数据框架引发的。我仍然找不到异常的根本原因，所以建议：

> 多线程错误是神秘 Core Data 问题的最常见原因。

走了很长一段路，我意识到我的一些核心数据代码没有封装在`performBlock:`调用中。一旦我解决了这个问题，我就再也没有看到这个问题再次发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:26:19.110

为什么之后更新UI `[tableView endUpdates];`？为什么要延迟在单独的选择器上执行此操作？

在我看来，这似乎是非常有问题的设计，并且可能是您遇到问题的原因。我强烈建议您在指定的方法中执行由 NSFetchedResultsControllerDelegate 生成的所有 UI 更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-23T22:41:46.593

我们可能没有完全相同的问题，但您描述的错误与我的相同。当你看到这个时，我正在使用一些不存在的较新的 API，但我想我解决了我的问题。如果您好奇，请查看更新 5。[NSFetchedResultsController 试图插入 nil 对象](https://stackoverflow.com/questions/19462645/nsfetchedresultscontroller-attempting-to-insert-nil-object)

# actionscript-3 - Youtube as3 API 似乎不再起作用

> ID：13622387
> 
> 赞同：7
> 
> 时间：2012-11-29T09:17:57.703
> 
> 标签：actionscript-3, flash, youtube, youtube-api

我正在使用 as3 Youtube 官方 API，我需要将 API Player 加载到 swf 文件中。

我已经在几个项目上完成了，一切都很好，但是几个小时后，我所有的项目现在都坏了。

这是崩溃的代码：

```
Security.allowDomain("www.youtube.com");
loader = new Loader();
loader.contentLoaderInfo.addEventListener(Event.INIT, playerLoaded);
loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, playerError) ; 
loader.load(new URLRequest("http://www.youtube.com/apiplayer?version=3")); 
```

现在发送一个空且不是很有帮助的 IOErrorEvent ：

```
 [ErrorEvent type="onError" bubbles=false cancelable=false eventPhase=2 text=""] 
```

由于昨天一切正常，我使用 YoutubePlayer 检查了其他 Flash 站点，它们似乎都已损坏。

有人遇到同样的问题吗？Youtube 对此只字未提。

为了完成我的请求，即使在我的浏览器中加载[http://www.youtube.com/apiplayer?version=3](http://www.youtube.com/apiplayer?version=3)也会引发调试播放器错误！谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:33:15.780

Youtube 目前已关闭，并且已经关闭了大约一个小时： [http ://downrightnow.com/youtube#refresh](http://downrightnow.com/youtube#refresh)

# html - Internet Explorer 中丑陋的字体渲染

> ID：13622391
> 
> 赞同：4
> 
> 时间：2012-11-29T09:18:18.037
> 
> 标签：html, css, internet-explorer, firefox

Internet Explorer - Windows 中的丑陋字体渲染是否有任何解决方法？

```
 font-family: "Helvetica Neue",Helvetica,Arial,sans-serif; 
```

![在此处输入图像描述](../Images/88fc54d32ebe6403e568ab39819bf03b.png)

[这是 100% 的裁剪图：](http://d.pr/i/qFoS+)
左：IE
右：FF

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:39:07.747

该页面非常复杂，并且为不同的浏览器提供了不同的 CSS 规则。但字体渲染差异最终很简单，从这个意义上说，这个问题可能被视为是[Mozilla Firefox 和 Internet Explorer 之间的字体差异](https://stackoverflow.com/questions/10849849/font-differences-between-mozilla-firefox-and-internet-explorer)的副本。

可以通过一个非常简单的设置来证明这种差异，其中 CSS 代码简化为以下内容：

```
a {
 padding: 1px 2px;
 color: #FFFFFF;
 background: rgb(38, 127, 234);
 font: 13px Arial;
 font-weight: bold;
} 
```

所以它只是 13px 大小的 Arial Bold，带有一定的蓝色背景和白色。在 IE 上，由于字体渲染算法的差异，某些笔画看起来比 Firefox 上粗，现在或在可预见的将来，您对此无能为力，除非这可能会导致您重新考虑字体和样式的选择。

以下是您得到的（在 Windows 7 上生成；左侧是 Firefox，右侧是 IE）：

![在此处输入图像描述](../Images/5ada51618d8dc1b1bf74ff4f26f8b9f7.png)

如果您放大它以使像素变得可辨别，您会看到很多差异：

![在此处输入图像描述](../Images/fcc1bd1ab03160a9550067754987dbbd.png)

# datasource - Kendo UI 条形图数据分组

> ID：13622402
> 
> 赞同：5
> 
> 时间：2012-11-29T09:18:39.100
> 
> 标签：datasource, kendo-ui

不确定这是否可能。在我的示例中，我使用 json 作为源，但这可以是任何大小。在我关于[小提琴](http://jsfiddle.net/jqIndy/ZPUr4/3/)的示例中，我将通过仅绑定两列 ProductFamily (xAxis) 和 Value (yAxis) 以共享方式使用此数据，但我希望能够使用聚合对列进行分组。

在这个没有分组的例子中，它显示了 FamilyA 的多个列。**可以将其分组到一列中，并且无论数据量如何都可以汇总值？**

所以结果将显示一列 FamilyA 的值 4850 + 4860 = 9710 等？

在线所有示例的一个问题是每个类别始终存在正确的数据量。不确定这是否有意义？

[http://jsfiddle.net/jqIndy/ZPUr4/3/](http://jsfiddle.net/jqIndy/ZPUr4/3/)

```
//Sample data (see fiddle for complete sample)
[{
        "Client":"",
        "Date":"2011-06-01",
        "ProductNumber":"5K190",
        "ProductName":"CABLE USB",
        "ProductFamily":"FamilyC",
        "Status":"OPEN",
        "Units":5000,
        "Value":5150.0,
        "ShippedToDestination":"CHINA"
 }]

var productDataSource = new kendo.data.DataSource({
  data: dr,
  //group: {
  //  field: "ProductFamily",
  //},
  sort: {
    field: "ProductFamily",
    dir: "asc"
  },
  //aggregate: [
  //      { field: "Value", aggregate: "sum" }
  //],
  //schema: {
  //  model: {
  //    fields: {
  //      ProductFamily: { type: "string" },
  //      Value: { type: "number" },
  //    }
  //  }
  //}
          })

 $("#product-family-chart").kendoChart({
        dataSource: productDataSource,
        //autoBind: false,
        title: {
          text: "Product Family (past 12 months)"
        },
        seriesDefaults: {
          overlay: {
            gradient: "none"
          },
          markers: {
            visible: false
          },
          majorTickSize: 0,
          opacity: .8
        },
        series: [{
          type: "column",
          field: "Value"
        }],
        valueAxis: {
          line: {
            visible: false
          },
          labels: {
            format: "${0}",
            skip: 2,
            step: 2,
            color: "#727f8e"
          }
        },
        categoryAxis: {
          field: "ProductFamily"
        },
        legend: {
          visible: false
        },
        tooltip: {
          visible: true,
          format: "Value: ${0:N0}"
        }
      });​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T08:27:54.403

Kendo UI 图表不支持绑定到组聚合。至少现在还没有。

我的建议是：

1.  移动聚合定义，因此它是按组计算的：

    ```
    group: {
        field: "ProductFamily",
        aggregates: [ {
            field: "Value",
            aggregate: "sum"
         }]
     } 
    ```

2.  在更改处理程序中提取聚合值：

    ```
    var view = products.view();
    var families = $.map(view, function(v) {
        return v.value;
    });
    var values = $.map(view, function(v) {
        return v.aggregates.Value.sum;
    }); 
    ```

3.  手动绑定组和类别：

    ```
    series: [ {
        type: "column",
        data: values
    }],
    categoryAxis: {
        categories: families
    } 
    ```

工作演示可以在这里找到：http: [//jsbin.com/ofuduy/5/edit](http://jsbin.com/ofuduy/5/edit)

我希望这有帮助。

# mysql - MYSQL：用户 id 的计数类型

> ID：13622405
> 
> 赞同：0
> 
> 时间：2012-11-29T09:18:46.460
> 
> 标签：mysql

请参考数据库表图像。

![在此处输入图像描述](../Images/86792034bcd2800e2344c9dbd16272e2.png)

我想为每个用户 ID 计算具有值“Q”的类型。无论我写的是否正确，我都感到困惑。

```
"SELECT COUNT(type),userid FROM '$db_prefix'posts WHERE type=Q GROUP BY userid"; 
```

因此，它将显示 x 用户 ID 的 Q 总数，如下所示：

```
userid 1 has 25 Q
userid 2 has 11 Q
.... 
```

A 和 C 的方式相同，但我认为如果我会得到 Q，那么它对 A 和 C 的工作方式相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:41:17.033

这个查询没问题：

```
select count(type), userid
from posts
where type='Q'
group by userid 
```

您忘记了 **'**Q *'上的引号**

此查询一次完成所有字母。

```
select userid, type, count(*) as count
from posts
group by userid, type 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:23:17.147

实际上，您可以通过单个查询为每种类型获取它。像这样：

```
SELECT type, userid, COUNT(*) AS `n` FROM posts GROUP BY type, userid; 
```

此查询将那些具有相同类型和用户 ID 值的行分组。

回声声明：

`echo $q['userid'] .' has '. $q['n'] $q['type'] .' question';`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:21:06.060

```
"SELECT userid, type, COUNT(*) 
FROM {$db_prefix}posts 
GROUP BY userid, type" 
```

# postgresql - 为什么在我的测试中 PostgreSQL 9.2 比 9.1 慢？

> ID：13622406
> 
> 赞同：4
> 
> 时间：2012-11-29T09:18:52.600
> 
> 标签：postgresql, benchmarking

我已经从 PostgreSQL 9.1.5 升级到 9.2.1：

```
"PostgreSQL 9.1.5 on x86_64-unknown-linux-gnu, compiled by gcc (GCC) 4.4.6 20120305 (Red Hat 4.4.6-4), 64-bit"
"PostgreSQL 9.2.1 on x86_64-unknown-linux-gnu, compiled by gcc (GCC) 4.4.6 20120305 (Red Hat 4.4.6-4), 64-bit" 
```

它与默认的 PostgreSQL 配置文件位于同一台机器上（仅更改了端口）。

出于测试目的，我有一个简单的表格：

```
CREATE TEMP TABLE test_table_md_speed(id serial primary key, n integer); 
```

我使用函数测试：

```
CREATE OR REPLACE FUNCTION TEST_DB_SPEED(cnt integer) RETURNS text AS $$
DECLARE
    time_start timestamp;
    time_stop timestamp;
    time_total interval;
BEGIN
    time_start := cast(timeofday() AS TIMESTAMP);
    FOR i IN 1..cnt LOOP
        INSERT INTO test_table_md_speed(n) VALUES (i);
    END LOOP;
    time_stop := cast(timeofday() AS TIMESTAMP);
    time_total := time_stop-time_start;

    RETURN extract (milliseconds from time_total);
END;
$$ LANGUAGE plpgsql; 
```

我打电话给：

```
SELECT test_db_speed(1000000); 
```

我看到了奇怪的结果。对于 PostgreSQL 9.1.5，我得到“8254.769”，对于 9.2.1，我得到：“9022.219”。这意味着新版本速度较慢。我找不到原因。

任何想法为什么这些结果不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:55:46.100

你说两者都在同一台机器上。据推测，较新版本的数据文件是后来添加的。后来的文件往往被添加到靠近盘片中心的位置，那里的访问速度较慢。

[Greg Smith 关于 PostgreSQL 性能的书中](http://www.postgresql.org/docs/books/)有一个很好的部分，包括测量和绘制效果的方法。通过巧妙地使用该`dd`实用程序，您可以对每个位置的相对速度进行一些临时测试，至少对于读取而言。

9.2 版本通常比早期版本更好地扩展到大量内核，尽管在某些基准测试中，单独运行的单个查询的性能略有下降。不过，我没有看到任何基准测试显示出接近这么大的效果。我敢打赌它是驱动器上的位置的结果——这只是为了表明做良好的基准测试是多么困难。

* * *

**更新**：9.2.0 中为提高某些查询的性能所做的更改使其他一些查询的性能更差。最终确定此更改应还原，这发生在版本 9.2.3 中；因此，在升级到该维护版本后检查性能是值得的。9.3.0 中将包含一个正确的修复程序，该修复程序已被确认可以修复恢复的补丁修复的问题而不会导致回归。

# c# - c#/c++ 如何将结构的结构与 marshal.sizeof 联合

> ID：13622412
> 
> 赞同：-2
> 
> 时间：2012-11-29T09:19:38.060
> 
> 标签：c#, c++, struct, marshalling, unions

问题是我试图在我的 c# 程序中使用 c++ 结构。

我们正在使用 Mail slot 与用户界面进行通信，由于复杂性和年代久远，没有其他方法可以做到这一点，并且它在全球 1000 多台机器上运行。

我们的结构看起来像这样

```
// Message data
typedef struct _t_messageData
{
    t_messageHeader header;
    t_messageBody body;
    t_messageParameter parameter;
} t_messageData;

typedef struct _t_messageHeader 
{
    UCHAR  stx;
    UCHAR  packetType;
    USHORT packetCount;
    USHORT checksum;
    UCHAR  sourceAddress;
    USHORT sourcePID;
    UCHAR  destinationAddress;
    USHORT destinationPID;
    UCHAR  destinationNet;
    USHORT packetSequenceNumber;
    USHORT packetID;
} t_messageHeader;

// Message body
typedef struct _t_messageBody 
{
    char    order[4];
    USHORT  module;
    USHORT  station;
    USHORT  part;
    USHORT  position;
} t_messageBody;

// Message parameter
typedef union _t_messageParameter 
{
    t_internalProcessData internalProcess;
    char data[PACKET_DATA_SIZE];
} t_messageParameter;

typedef struct _t_internalProcessData
{
    USHORT command;
    UCHAR data[PACKET_DATA_SIZE-2];
} t_internalProcessData; 
```

在 c# 中，所有大小都由这些值固定。

```
public const int PACKET_HEADER_SIZE = 17;
public const int PACKET_BODY_SIZE = 12;
public const int PACKET_COMPLETE_SIZE = 4204;
public const int PACKET_DATA_SIZE = PACKET_DATA_SIZE = 4175; 
```

现在问题不在于标题或正文，这很容易管理。问题在于工会。

```
class MailslotData
{
    // Message header
    [StructLayout(LayoutKind.Sequential, Pack=1)]
    public struct SMessageHeader
    {
        public byte stx;
        public byte packetType;
        public ushort packetCount;
        public ushort checksum;
        public byte sourceAddress;
        public ushort sourcePID;
        public byte destinationAddress;
        public ushort destinationPID;
        public byte destinationNet;
        public ushort packetSequenceNumber;
        public ushort packetID;
    };

    // Message body
    [StructLayout(LayoutKind.Sequential, Pack=1)]
    public struct SMessageBody
    {
        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 4)]
        public char[] order;
        public ushort placeHolder1;     // Old ModuleNbr
        public ushort station;
        public ushort part;
        public ushort placeHolder2;     // Old PositionNbr
    }; 
```

现在问题来了。工会。使用 Fieldoffset，我可以将具有相同大小的字节数组和击球粘贴到同一位置。

```
[StructLayout(LayoutKind.Explicit, Pack = 1)]
public struct SMessageParameter
{
    [FieldOffset(0)]
    public SInternalProcessData strInternalProcess;
    [FieldOffset(0)]
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = PACKET_DATA_SIZE)]
    public byte[] data;
}; 
```

以这种方式定义它时，我在CalculateChecksum() 处得到一个ArgumentException。我用 new 声明我的结构，并且我只使用 SInternalProcess ，就像在这里看到的那样。

```
public void CreateInternalProcessMessage(ushort station, ushort part, ushort command)
{
    CreateMessageHeader(PACKETTYPE_SINGLE_PACKET, ADDRESS_USERINT, PID_USERINT, DESTINATIONNET_USERINT, 0);

    CreateMessageBody (INTERNAL_PROCESS_MESSAGE.ToCharArray(), station, part);

    messageData.parameter.strInternalProcess.command = command;
    messageData.header.packetCount += (ushort)Marshal.SizeOf (messageData.parameter.strInternalProcess.command);

    messageData.parameter.strInternalProcess.data = new byte[PACKET_DATA_SIZE - 2];

    messageData.parameter.strInternalProcess.data[0] = (byte)ETX;
    messageData.header.packetCount += 1;
    CalculateChecksum();
} 
```

在CalculateChecksum()中我会得到ArgumentException{“类型不能被编组，因为嵌入数组实例的长度与布局中声明的长度不匹配。”}

您可以在此处的图像中看到。

> //这是本来有图片的部分，但我没有足够的声誉。所以我必须把它写下来。:-(我会尽快发布我的repu达到10。 ![在此处输入图像描述](../Images/c0408c8ee99cab4ef81b5bc70a39c942.png)

```
unsafe void CalculateChecksum()
{
    int i = 0;
    ushort checksum = 0;
    i = Marshal.SizeOf(messageData);
    i = sizeof(ushort);

    byte[] byteArray = new byte[Marshal.SizeOf(messageData)];

    fixed (byte* pArray = byteArray)Marshal.StructureToPtr(messageData, new IntPtr (pArray), false);

    // Calculate the checksum
    messageData.header.checksum = 0;
    for (byte u = 0; u < messageData.header.packetCount; u++)
        checksum += byteArray[u];

    messageData.header.checksum = checksum;
} 
```

> *messageData.parameter.data -> 0x00cc1bfc 和 *messageData.parameter.strInternalProcess.data -> 0x00cc1bfc

两个数据数组都指向同一个位置，这是错误的，因为 ushort 命令应该至少有 2 个字节的偏移量。

我的 byte[] byteArray 是 4204

因此，在阅读了更多内容并尝试自己弄清楚之后，我找到了两种可能的解决方案。但是每个解决方案都有一个我自己无法解决的问题。

首先，我在到目前为止所做的所有事情中都做错了什么，或者我发布的代码是否有一个简单的解决方案。

所以现在我将介绍我想到的可能的解决方案，但我将在这篇文章下面单独发布它们。

感谢你的帮助。我感谢每一个答案，因为我现在被困在这一点上一个多星期了，不知道还有什么可以尝试的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:24:57.703

该问题的可能解决方案是一个我自己无法解决的新问题。

我更改了以下定义：

```
 public byte[] data;   
    to look as followed
    public fixed byte data[PACKET_DATA_SIZE]; 
```

在这里你可以看到整个变化

```
public unsafe struct SInternalProcessData
{
    public ushort command;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = PACKET_DATA_SIZE - 2)]
    public fixed byte data[PACKET_DATA_SIZE - 2];
};

[StructLayout(LayoutKind.Explicit, Pack = 1)]
public unsafe struct SMessageParameter
{
    [FieldOffset(0)]
    public SInternalProcessData strInternalProcess;
    [FieldOffset(0)]
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = PACKET_DATA_SIZE)]
    public fixed byte data[PACKET_DATA_SIZE];
};

public const int PACKET_HEADER_SIZE = 17;
public const int PACKET_BODY_SIZE = 12;
public const int PACKET_COMPLETE_SIZE = 4204;
public const int PACKET_DATA_SIZE = PACKET_COMPLETE_SIZE - PACKET_HEADER_SIZE - PACKET_BODY_SIZE;
//value PACKET_DATA_SIZE = 4175 
```

这解决了我在两个数据数组都指向同一位置时遇到的问题。正如你在图片中看到的那样。但它产生了一个新问题。

![参数异常](../Images/1ce5f88aab12eece90c7d1cedeafb643.png)

```
Type 'GettingStartedClient.MailslotData+SMessageData' cannot 
be marshaled as an unmanaged structure; no meaningful size or offset can be computed. 
```

所以我使用了 [MarshalAs(UnmanagedType.) 的设置，但我找不到可以正常工作的配置。

我使用我的结构 Marshal.SizeOf(messageData.parameter.data) 的子集测试了所有设置

所以这是我的问题，我需要一些帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:29:14.343

> 类型“GettingStartedClient.MailslotData+SMessageData”不能作为非托管结构编组；无法计算出有意义的大小或偏移量。
> 
> 所以我使用了 [MarshalAs(UnmanagedType.) 的设置，但我找不到可以正常工作的配置。

现在我知道为什么了。因此，了解背景可以使一切变得清晰。我试图混搭一个固定的数组。mashel 所做的是重新排列结构，使其看起来像您已经决定的样子。mashal 命令无法对固定数组执行此操作。

所以解决方案非常简单。删除捣碎和瞧。一切正常。

```
[StructLayout(LayoutKind.Explicit, Size = PACKET_DATA_SIZE, Pack = 1)]
public unsafe struct SInternalProcessData
{
    [FieldOffset(0)]
    public ushort command;
    [FieldOffset(1)]
    public fixed byte data[PACKET_DATA_SIZE - 2];
};

[StructLayout(LayoutKind.Explicit, Size = PACKET_DATA_SIZE, Pack = 1)]
public unsafe struct SMessageParameter
{
    [FieldOffset(0)]
    public SInternalProcessData strInternalProcess;
    [FieldOffset(0)]
    public fixed byte data[PACKET_DATA_SIZE];
}; 
```

# tcl - 如何在 solaris sparc 上安装 tcl

> ID：13622425
> 
> 赞同：1
> 
> 时间：2012-11-29T09:20:24.183
> 
> 标签：tcl, solaris, expect, sparc

我有一台solaris机器配置：`SunOS indevel07 5.10 Generic_147440-15 sun4v sparc sun4v`. 我正在尝试`expect utility`在此安装。expect 实用程序需要安装 tcl。我也尝试安装它，但出现错误。我已经从 sunfreeware 下载了*tcl-8.5.12-sol10-sparc-local.gz*和*expect-5.45-sol10-sparc-* local.gz。我已将它们解压缩并尝试像`pkgadd -d pkgname`. 我收到如下错误：

```
ERROR: attribute verification of </usr/local/man/man3/Tcl_Seek.3> failed
    pathname does not exist 
```

有很多这样的错误。我试图通过谷歌搜索对其进行故障排除，但找不到任何相关信息。因为这个，我被我的发展困住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T17:11:19.290

尝试从源代码构建 Tcl/Tk 和 Expect。这是指令 -[如何编译 Tcl](http://www.tcl.tk/doc/howto/compile.html)。Expect 下载 -[获取适用于 UNIX 的 Expect](http://expect.sourceforge.net/#unix)。这在 Solaris 10 上对我有用，而且我没有遇到任何严重的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T04:41:28.680

对于那些想要安装 tcl 的人，请参考这个 URL。它已经采取了措施来做到这一点。网址：[http ://www.wellho.net/mouth/1174_Installing-Tcl-and-Expect-on-Solaris-10-a-checklist.html](http://www.wellho.net/mouth/1174_Installing-Tcl-and-Expect-on-Solaris-10-a-checklist.html)

# java - IntelliJ IDEA 项目中的用户相关文件

> ID：13622433
> 
> 赞同：0
> 
> 时间：2012-11-29T09:20:47.677
> 
> 标签：java, intellij-idea

我们有一个小团队使用 IntelliJ IDEA 作为 Java IDE，并使用 git 管理我们的源代码。IDEA 项目被创建为基于目录的格式。我发现下面的一些文件`.idea`与用户相关。

是否有我可以过滤掉的与用户相关的文件的完整列表`.gitignore`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T11:42:08.947

请[查看常见问题解答](http://devnet.jetbrains.net/docs/DOC-1186)。

我还建议检查您要共享的其他文件以获取敏感信息。例如，IntelliJ IDEA 12 中的新 Android 工件可以包含密钥库密码（以加密形式，但可以解密）。

您的问题也是这些的重复：

*   [.idea 文件夹中的 gitignore 是什么？](https://stackoverflow.com/questions/11968531/what-to-gitignore-from-the-idea-folder)
*   [Intellij Idea 9/10，要签入（或不签入）源代码控制的文件夹？](https://stackoverflow.com/questions/3041154/intellij-idea-9-10-what-folders-to-check-into-or-not-check-into-source-contro)
*   [Git源码控制下IntelliJ IDEA项目文件不断变化如何处理？](https://stackoverflow.com/questions/7060727/how-to-deal-with-intellij-idea-project-files-under-git-source-control-constantly)

# c# - 客户端安装 windows 安装程序时如何在客户端计算机上安装 Crystal Reports 查看器

> ID：13622436
> 
> 赞同：0
> 
> 时间：2012-11-29T09:20:54.680
> 
> 标签：c#, crystal-reports, c#-3.0

我在另一台计算机上运行相同的 exe 文件，但它给出了错误。该应用程序可以在我的电脑上运行，但不能在用户的电脑上运行。我尝试在其他开发机器上编译应用程序，它运行良好，问题是我的应用程序不能在用户的电脑上运行。

> *无法加载文件或程序集“CrystalDecision.Shared，Version=10.5.3700.0，Culture=neutral，PublicKeyToken=692fbea5521e1304”或其依赖项之一。该系统找不到指定的文件。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:25:31.633

Programs 文件夹中有一个名为 Microsoft Visual Studio 9.0\Crystal Reports\CRRedist\IA64 的文件夹。在那里你会找到一个可再分发的包。只需将此文件添加到您的安装项目 - 用户定义的操作 - 并安装它。

编辑：正如你提到的 setupProject CustomActions 只允许 exe/dll 文件

我找到了另一个解决方案。希望这些能满足您的需求。

将 mergeModul 添加到您的 setupProject ：

（在 setupProject 上右键单击解决方案资源管理器，添加 mergeModul）。

一个名为 C:\Program Files (x86)\Common Files\Merge Modules 的文件夹应该会自动出现。在那里您可能会找到一个名为 CrystallReportsRedistxxx.msm 的文件。

将此添加到您的项目中，它也应该安装。

[BusinessObjects_CrystallReports](http://resources.businessobjects.com/support/additional_downloads/runtime.asp)

[MS 水晶报表](http://msdn.microsoft.com/en-us/library/aa287924%28v=vs.71%29.aspx)

[将组件添加到安装项目](http://msdn.microsoft.com/en-us/library/ms227420%28VS.80%29.aspx)

[如何在 VS Studio 2008 中使用 Crystal Report 创建安装和部署项目](http://www.fryan0911.com/2010/07/how-to-create-setup-and-deployment.html)

# c# - .Net Compact Framework 3.5 上 CultureInfo.GetCultureInfo("no") 中的 PlatformNotSupportedException

> ID：13622437
> 
> 赞同：0
> 
> 时间：2012-11-29T09:20:55.337
> 
> 标签：c#, compact-framework

我`PlatformNotSupportedException`在尝试创建一个`CultureInfo`.

```
 CultureInfo ci =  CultureInfo.GetCultureInfo("no"); 
```

任何想法 ？

# java - 从SQL Server 2005升级到SQL Server 2008，JAVA应用程序会不会出现错误？

> ID：13622442
> 
> 赞同：0
> 
> 时间：2012-11-29T09:21:01.170
> 
> 标签：java, sql-server-2008, sql-server-2005

我打算将 SQL SERVER 2008 用于 JAVA 应用程序。该应用程序当前在 SQL Server 2005 上运行。

会不会有什么问题？我会收到任何与语法相关的错误，还是我的所有 SQL 查询都能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:25:57.467

使用[SQL Server 2008 升级顾问](http://www.microsoft.com/en-us/download/details.aspx?id=11455)来识别可能影响升级的功能和配置更改。虽然这不会给你一个明确的“它会起作用”，但它可以让你了解可能出了什么问题。

# eclipse - 如何在使用 Tycho 构建的 Eclipse 产品中设置属性 eclipse.update.reconcile=true

> ID：13622445
> 
> 赞同：2
> 
> 时间：2012-11-29T09:21:07.287
> 
> 标签：eclipse, maven, eclipse-rcp, tycho, e4

我使用 Maven Tycho 0.15.0 构建我的 Eclipse 4 应用程序。一切正常，除了事实是，当我添加

```
<configurations>
...
<property name="org.eclipse.update.reconcile" value="true" />
</configurations> 
```

Tycho 忽略该属性并将 org.eclipse.update.reconcile=false 写入 config.ini。

我希望我的应用程序使用我放在插件文件夹中的每个包，因此我添加了 org.eclipse.update.configurator 和上述属性。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-18T13:40:05.527

如[官方网站](http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Ftasks%2Fpde_p2_configuringproducts.htm)所述：

> 在为 org.eclipse.update.configurator 设置启动级别时，PDE/Build 还会自动设置除这些属性外，org.eclipse.update.reconcile=false。

事实上，如果你指出

```
<plugin id="org.eclipse.update.configurator"/> 
```

在 .product 文件中，您始终具有默认的启动级别

```
org.eclipse.update.reconcile=false 
```

在您的 config.ini 文件中。

未指定解决方案

```
<plugin id="org.eclipse.update.configurator"/> 
```

在 .product 文件中。它仍然会在插件中。

# iphone - 自定义 UITableViewCell 高度宽度提供了错误的值。

> ID：13622446
> 
> 赞同：1
> 
> 时间：2012-11-29T09:21:09.433
> 
> 标签：iphone, objective-c, cocoa-touch, ios4

我在.xib中设计了UITableViewCell，它的高度和宽度是：

从 Xcode 中检索 -> 显示尺寸检查器。

```
Width : 358   Height : 562 
```

**表视图代表：**

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    return 800;
 } 
```

**我在尝试什么？**

在下面的方法中，我试图找到单元格的宽度和高度，以便我可以在单元格中绘制一条垂直线。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:   (NSIndexPath *)indexPath 
{
  /* FINDING THE WIDTH AND HEIGHT */
   my Custom Cell instance say : cell

   cell.contentView.bounds.size.width   Give  me the value -> 320,
   cell.contentView.bounds.size.height  Gives me the value -> 44,
} 
```

**问题？..**

如何获得自定义单元格的正确高度/宽度？

如果我的理解有误，请告诉我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:39:25.880

您需要覆盖`-tableView:willDisplayCell:forRowAtIndexPath:`. 在这种方法中，表格视图已经设置了正确的尺寸。

# jquery - 多列 JQuery Draggable 在其中一列中呈现 droppable 时无法正确排序

> ID：13622450
> 
> 赞同：1
> 
> 时间：2012-11-29T09:21:25.537
> 
> 标签：jquery, sorting, jquery-ui-sortable, multiple-columns

我已经构建了一个多列界面，该界面使用 MVC3 中的 JQuery Sortables 动态呈现。

Droppables 呈现在按列排列的两个列表之一或第三个列表中，最后用户在组织列时可以用来存储他们的 droppables。

当用户将项目放入列中的某个位置时，ajax 调用将顺序和列信息保存到数据库中，以便保存排列。然后，当用户下次访问该页面时，可以将项目呈现在它们排列的位置。

问题是，如果页面呈现的项目已经在其中一个列表中，排序随后会静默失败。项目可以拖到列，但不能正常排序。这些列中的项目可以移动到列表的底部，但不能移动到顶部或其他项目之间。

如果一列最初呈现为空，则可以正常删除项目并对其进行排序。

我做了一个演示问题的小提琴：[Fiddle Link](http://jsfiddle.net/stevenaburton/GGBNu/43/)

这是HTML代码：

```
 <div id="processSteps" class="formulaProcessstepsColumn" >
        <div class="draggableItem" id="process-step-1">Item 1</div>
        <div class="draggableItem" id="process-step-2">Item 2</div>
        <div class="draggableItem" id="process-step-3">Item 3</div>        
    </div>
    <div class="clearboth"/>
    <div class="formula-processsteps-container">
        <div class="drop-column-header">Column A</div>
        <div class="drop-column-header">Column B</div>
    </div>
    <div class="clearboth"/>
    <div class="formula-processsteps-container">
        <div id="formula-processsteps-column-1" class="formulaProcessstepsColumn">
            <div class="draggableItem" id="process-step-4">Item 4</div>
        </div>
        <div id="formula-processsteps-column-2" class="formulaProcessstepsColumn"></div>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T01:13:05.580

For anyone else who runs into this problem...

The cause of the problem is that sortable fails if a list item is rendered in-situ in the HTML as it was here:

```
<div id="formula-processsteps-column-1" class="formulaProcessstepsColumn">
     <div class="draggableItem" id="process-step-4">Item 4</div>
</div> 
```

The solution is to add the list item dynamically AFTER the HTML sortable has been rendered. We can do this by first defining the empty sortable in HTML:

```
<div id="formula-processsteps-column-1" class="formulaProcessstepsColumn">
     <!--- note the list item that used to be here has been removed --->
</div> 
```

Then add the list item dynamically using Javascript:

```
$(document).ready(function() {
...
    $('#formula-processsteps-column-1').html('<div class="draggableItem" id="process-step-4">Item 4</div>')
} 
```

I updated the [fiddle](http://jsfiddle.net/stevenaburton/GGBNu/55/) if you want to see the working example

# asp.net - 请求用户的数字证书

> ID：13622451
> 
> 赞同：0
> 
> 时间：2012-11-29T09:21:30.397
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, iis-7.5, digital-certificate

我有一个数字证书，但它是一张卡，所以我无法访问我的私钥。我正在开发一个应用程序，我希望用户可以选择使用其证书登录。

我希望我的应用程序请求用户证书。

我该如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:39:11.527

```
Request.ClientCertificate.Subject; 
```

做的工作！;O)

# google-app-engine - 如何确保 GAE 上的 MemCache 和 Datastore 之间的一致性？

> ID：13622452
> 
> 赞同：3
> 
> 时间：2012-11-29T09:21:37.183
> 
> 标签：google-app-engine, google-cloud-datastore

我正在使用事务将多个实体写入数据存储区。我也想将这些实体保留在 MemCache 中。如何确保 MemCache 中的实体副本实际上等于 Datastore 中的副本？

例如我可以这样做：

```
tx.begin()
datastore.put(entity)
if (memcache.putIfUntoched(key, entity))
  tx.commit() 
```

但是，如果事务失败，实体可能会在 MemCache 中结束，而不是在 Datastore 中。另一方面，如果我这样做：

```
tx.begin()
datastore.put(entity)
tx.commit()
memcache.putIfUntoched(key, entity)) 
```

那么 Datastore 事务可能会成功，但 MemCache 更新可能会失败。如何确保一致性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:27:14.940

根据我的经验，如果您同时写入数据库和缓存，它可能没有那么有用。一般来说，将数据库事务与其他东西（例如文件系统）混合起来很难做到正确。

我建议你改变你的程序逻辑，这样

1.  创建新记录时，仅写入 DB
2.  当您更新现有记录时，写入数据库并使缓存中的相应插槽无效
3.  在查找记录时，只需检查缓存即可。如果不存在，从数据库加载并填写缓存

# google-chrome - 如何在谷歌浏览器中禁用网站图标获取

> ID：13622455
> 
> 赞同：8
> 
> 时间：2012-11-29T09:21:48.207
> 
> 标签：google-chrome, browser, favicon, chromium

如何告诉 chrome*不要从网络服务器获取*任何 favicon.ico 文件？对于 Web 开发和调试，当我阅读服务器端日志时，我觉得这很烦人。在测量和优化我的页面加载时间时，加载图标也是有偏差的，所以我想在 chrome的*客户端完全禁用它。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T10:20:09.357

看看这个[我讨厌你的 favicon](https://chrome.google.com/webstore/detail/i-hate-your-favicon/laggbmpbikikiablknnppgglelkncemk)的 Chrome 扩展，或者构建你自己的扩展，它利用[webRequest](https://developer.chrome.com/extensions/webRequest.html)模块并捕获所有对 favicon 的传出请求。

您也可以设置一个广告拦截扩展程序来完成相同的工作。

[PS 你可以在 Chromium 项目的issue 39402](http://code.google.com/p/chromium/issues/detail?id=39402)中阅读关于是否将其视为错误或功能的讨论，我认为它也适用于 Chrome。在不久的将来，似乎没有简单的方法可以通过选项关闭这种行为。

# python - 如何使用twisted每隔几秒发送一次IRC消息？

> ID：13622457
> 
> 赞同：1
> 
> 时间：2012-11-29T09:21:50.210
> 
> 标签：python, twisted, irc

扭曲的文档提供了[如何创建 IRC 机器人的示例](http://twistedmatrix.com/documents/11.1.0/core/howto/clients.html#auto6)

这是我目前拥有的代码（来自上面的示例）：

```
from twisted.words.protocols import irc
from twisted.internet import protocol
from twisted.internet import reactor

class Bot(irc.IRCClient):
    def _get_nickname(self):
        return self.factory.nickname
    nickname = property(_get_nickname)

    def signedOn(self):
        self.join(self.factory.channel)
        print "Signed on as %s." % (self.nickname,)

    def joined(self, channel):
        print "Joined %s." % (channel,)

    def privmsg(self, user, channel, msg):
        print msg

class BotFactory(protocol.ClientFactory):
    protocol = Bot

    def __init__(self, channel, nickname='test-nick-name'):
        self.channel = channel
        self.nickname = nickname

    def clientConnectionLost(self, connector, reason):
        print "Lost connection (%s), reconnecting." % (reason,)
        connector.connect()

    def clientConnectionFailed(self, connector, reason):
        print "Could not connect: %s" % (reason,)

if __name__ == "__main__":

    channel = '#test-channel-123'
    reactor.connectTCP('irc.freenode.net', 6667, BotFactory(channel))
    reactor.run() 
```

现在我想添加每 5 秒向频道发送一条消息的功能。我该怎么做呢？如何从外部获取 Bot.msg 方法的句柄？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:36:39.970

> 每 5 秒向频道发送一条消息

看看，您可以使用它每隔*n*秒[`LoopingCall`](http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.task.LoopingCall.html)调用一次方法。

 *```
from twisted.internet import task

task.LoopingCall(yourSendingMethodHere).start(5.0) 
```

* * *

> 如何从外部获取 Bot.msg 方法的句柄？

由你决定。您创建 的实例`BotFactory`，并且每个`Bot`都有对其工厂的引用。*

# javascript - 如何在javascript中清除浏览器哈希历史

> ID：13622460
> 
> 赞同：0
> 
> 时间：2012-11-29T09:22:01.657
> 
> 标签：javascript, jquery, ajax, navigation

我使用[hashchange](http://benalman.com/code/projects/jquery-hashchange/examples/document_domain/)插件来模仿 ajax 导航，我想通过文件夹创建导航，例如：

> **#root/ -> #root/文件夹 -> #root/文件夹/子文件夹 -> #root/**

但是当我转到列表中的最后一个**#root/**时，我想清除以前的导航历史记录

> **#root/文件夹 -> #root/文件夹/子文件夹**

有没有能力做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:58:45.793

支持 HTML5 的现代浏览器支持通过`window.history`. 根据[Mozilla Developer Network 的文档](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)，唯一支持的操作是*添加*和*替换*历史记录。

因此**不支持**删除浏览器历史记录，但也许[`history.replaceState()`](https://developer.mozilla.org/en-US/docs/DOM/window.history)可以用来满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:36:23.277

Javascript中有一种方法可以导航到新页面，而不会在浏览器哈希中留下任何历史记录...只需使用 `window.location.replace("any URL");`...查看您的浏览器的页面导航按钮被禁用..并且右侧也没有“返回”选项可用鼠标点击..希望这对你有帮助:)

# c++ - 在 64 位操作系统上运行的 32 位应用程序

> ID：13622462
> 
> 赞同：1
> 
> 时间：2012-11-29T09:22:23.517
> 
> 标签：c++, windows, visual-c++, windows-7, x86-64

我们已经使用 vc++ express 8 版本在 32 位 Windows 上开发了一个应用程序...现在，在 Windows 64 位操作系统上执行此应用程序时，我们收到以下错误“CreateProcess error=14001, The application has failed to start because of its side -by-side 配置不正确。请查看应用程序事件日志或使用命令行 sxstrace.exe 工具了解更多详细信息"

现在，您能帮忙解决上述问题吗？

我关注了stackoverflow中的一些链接，但无法解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:32:43.470

您需要安装正确版本的 VC 运行时，这意味着您应该在目标机器上安装 Visual C++ 2008 Redistributable Package。你可以从[这里下载](http://www.microsoft.com/en-us/download/details.aspx?id=29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T12:22:28.370

正如[西蒙](https://stackoverflow.com/a/13622657/193892)指出的那样，您需要确保安装了编译器的运行时，或者您可以[静态链接您的 EXE](https://stackoverflow.com/questions/2035287/static-runtime-library-linking-for-visual-c-express-2008)。

# java - 在使用数据源连接池连接到数据库时需要帮助

> ID：13622464
> 
> 赞同：1
> 
> 时间：2012-11-29T09:22:27.363
> 
> 标签：java, jakarta-ee, jdbc

我想创建一个连接到数据库的简单程序。我不知道问题是什么。

这是我的代码：

Products.java/getter***和 setter* *** /

* * *

```
ProductsDao.java

public class ProductsDao {

    public ArrayList getAllProducts() throws NamingException, SQLException{
        Connection conn = null;
        Statement stmt = null;
        ResultSet rs = null;

        conn = ConnectionFactory.getConnection();
        stmt = conn.createStatement();
        rs = stmt.executeQuery("SELECT * FROM products");
        ArrayList products = new ArrayList();

        while(rs.next()){
            Products product = new Products();
            product.setId(rs.getInt("id"));
            products.add(product);
        }

        return products;
    } 
```

}

* * *

上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<Context path="/grocerific">
    <Resource 
    auth="Container"
    driverClassname="com.mysql.jdbc.Driver"
    name="/pool/grocerific"
    maxActive="100"
    maxIdle="30"
    maxWait="1000"
    type="javax.sql.DataSource"
    url="jdbc:mysql://localhost:3306/grocerific"
    username="root"
    password="secret"
    />
</Context> 
```

* * *

ConnectionFactory.java

```
 public static Connection getConnection() throws NamingException, SQLException{
        Context ctx = new InitialContext();
        DataSource ds = (DataSource) ctx.lookup("java:comp/env/jdbc/grocerific");
        Connection conn = ds.getConnection();
        return conn;
    } 
```

* * *

```
 GetProductsServlet.java

  protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException, NamingException, SQLException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();

    try {
        /* TODO output your page here. You may use following sample code. */
        ProductsDao productsDao = new ProductsDao();
        ArrayList products = productsDao.getAllProducts();
        out.println(products);
    } finally {            
        out.println("error!");
    }
} 
```

* * *

我还从数据库节点配置并扩展了服务并创建了一个新连接。我测试了一下，说成功了。我还在库中添加了`mysql-jdbc-connector.zip`库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:41:47.870

我看到一个 context.xml，所以我假设这是在 Tomcat 上运行的（非常有用的信息让你知道）。

Tomcat 还要求您在 web.xml 中为数据源添加一个条目 - Tomcat 文档非常清楚地解释了所有这些。

[http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html](http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html)

# c# - C# - 将打开的 Pdf 与 Pdf 阅读器一起使用

> ID：13622465
> 
> 赞同：0
> 
> 时间：2012-11-29T09:22:27.997
> 
> 标签：c#, visual-studio-2010, c#-4.0, itextsharp

我在用

```
 axAcroPDF1.LoadFile(path); 
```

在容器中加载pdf现在我在同一个类中声明了另一个函数，我正在使用itextsharp来阅读我使用的这个

```
 PdfReader reader = new PdfReader(); 
```

并且 () 内部没有传递任何内容我如何确保 PdfReader 仅使用打开的 Pdf。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:35:42.537

AFAIK PdfReader 类中没有无参数构造函数。您应该为它提供文件、流或字节的路径：

```
 const string pdfFilename = "/path/to/pdf/filename.pdf";
        PdfReader reader = new PdfReader(pdfFilename); 
```

# java - 如何替换 XML 文件中的内容值？

> ID：13622471
> 
> 赞同：0
> 
> 时间：2012-11-29T09:22:51.677
> 
> 标签：java, xml

什么是最好或最容易使用的库来执行 XML 替换？

例子：

```
<content>
<employee>
  <name>membersound</name>
  <id>1</id>
</employee>
</content> 
```

我想找标签

```
<employee><name> 
```

并替换`<id>`标签内的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:36:59.363

您可以定义一个 xslt 来查找`<employee>`元素并替换/删除其`<id>`内部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T18:17:53.873

与您的其他问题一样，您可以尝试[Jsoup](http://jsoup.org) - 即使它是 Html 解析器。

```
Element xmlDoc = // ...

/* If 'name' is not relevant you can use "employee > id" instead */
for( Element e : xmlDoc.select("employee > name + id") )
{
    e.text("30");
}

System.out.println(xmlDoc.select("employee")); 
```

**输出：**

```
<employee> 
 <name>
  membersound
 </name> 
 <id>
  30
 </id> 
</employee> 
```

# php - Kohana __() 在 iF rame 中的翻译

> ID：13622472
> 
> 赞同：0
> 
> 时间：2012-11-29T09:22:58.130
> 
> 标签：php, kohana, kohana-3

我实际上有两个问题：

1.  我正在使用一个灯箱插件，单击该插件时会加载页面的 iFrame，如何让它指向视图文件夹中的文件？
2.  第二个问题是否允许使用该`__()`方法翻译 iFrame 的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:26:01.347

你不能只将它指向一个视图文件，你想创建一个到最终将显示该视图的控制器/动作的路由；就像您在 Kohana 中创建任何其他页面一样。在这种情况下，是的，您将能够使用`__()`它来翻译其内容。

例子; 在路由文件中：

```
Route::set('default', 'iframe(/<action>)')
->defaults(array(
    'controller' => 'iframe',
    'action'     => 'index',
)); 
```

然后，您可以创建一个控制器`iframe.php`并添加`index`您想在 iframe 中使用的操作或任何其他（我假设是静态的）页面。例如：

```
class Controller_Iframe extends Controller
{
    public function action_index()
    {
        $this->request->response = View::factory('iframes/index');
    }
} 
```

然后`iframes/index.php`在您的视图文件夹中创建，瞧。您可以使用 url 访问它`mysite/iframe/`

:)

# iphone - ScrollView 根据 UIView 中的内容自动调整其高度？

> ID：13622473
> 
> 赞同：0
> 
> 时间：2012-11-29T09:23:00.063
> 
> 标签：iphone, xcode, uiscrollview

我需要自动调整 UIScrollView 的高度。实际上我的 ScrollView 在 UIView 中。在 UIView 中，我有一个静态大小的标签、UIButton、textField。现在，当单击按钮时，UITableView 中加载了一些数据。tableView 中的数据根据​​数组中对象的数量是动态的。

总结一下：在 viewLoad 上，只有标签、文本字段、按钮被加载。在 buttonClick tableView 被加载之后。

所以我需要根据这个标准调整scrollView的高度。但无法做到..

```
-(IBAction)buttonClick
{

                [testscroll setScrollEnabled:YES];
                [testscroll setContentSize:CGSizeMake(320,90+[array count]*180)];
                [self.view addSubview:testscroll];
  self.tableView=[[UITableView alloc] initWithFrame:CGRectMake(0,150,327,[array count]*180) style:UITableViewStylePlain];
                self.tableView.delegate=self;
                self.tableView.dataSource=self;
                self.tableView.rowHeight=180;
                self.tableView.scrollEnabled = NO;
                [self.view addSubview:self.tableView];
                [tableView release];

} 
```

我无法在按钮单击时添加 cd scrollView ..我怎样才能得到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:30:23.287

试试下面的代码..

```
 self.tableView.frame=CGRectMake(self.tableView.frame.origin.x, 150, self.tableView.frame.size.width, self.tableView.frame.size.height); /// you can set self.tableView.contentSize.height for set dynamic height of table with data ..

    float fscrview = self.tableView.frame.origin.y + self.tableView.frame.size.height + 20;
    yourScrollView.contentSize=CGSizeMake(320, fscrview); 
```

# java - 使用 JSF 1.2 将属性或参数从 js/jsp 传递到支持 bean

> ID：13622479
> 
> 赞同：0
> 
> 时间：2012-11-29T09:23:19.150
> 
> 标签：java, jsp, netbeans, jsf-1.2

我正在为 Oracle 数据库编写一个非常简单的前端。它基于 JSF 1.2、jsp，部署在 glassfish-ee-2.1 上，使用 NetBeans 6.5.1 开发。

是的，我知道这是2012年。

必须阅读内容，可能会对其进行更新，然后将其保存回数据库。

它适用于基于文本的元素。我向我的 UI 元素添加了绑定属性，我可以从 bean 访问它们以检索各种文本字段的值等。

我正在使用（这是一个要求？！）基于 jquery 的 msDropdown 组件（[官方页面](http://www.marghoobsuleman.com/jquery-image-dropdown)），它允许有一个带有图像和文本的漂亮下拉菜单。

然而，由于这个元素不是标准的，我没有找到一种方法来使用绑定属性从支持 bean 访问它。

这意味着我无法在页面加载时设置文本，就像我可以设置文本元素一样，此外，在处理支持 bean 中的提交时，我无法获取所选组件的值。

msDropDown 在 JSP 中是这样定义的：

```
<webuijsf:markup>
    <select id="status" name="status" style="left: 150px; top: 62px; width:100px">
        <option data-description="" data-image="base_3.gif" value=""></option>
        <option data-description="" data-image="base_0.gif" value="0"></option>
        <option data-description="" data-image="base_1.gif" value="1"></option>
        <option data-description="" data-image="base_2.gif"  value="2"></option>
    </select>
</webuijsf:markup> 
```

我创建了一个 js 变量来保存我的下拉列表，以便稍后访问它的值。

```
<webuijsf:script>
    var oHandler1 = $("#status").msDropdown().data("dd");
    var index = oHandler1.selectedIndex;
</webuijsf:script> 
```

然后我尝试像这样将该变量传递给我的支持bean：

```
<webuijsf:button actionListenerExpression="#{editApplication.submitUpdate}" actionExpression="#{editApplication.update_action}" id="update"
                                     style="height: 24px; left: 623px; top: 408px; position: absolute; width: 72px" text="Update">
    <f:attribute name="currentIndex" value="#{currentRow.value['APPNAME']}"/>
    <f:attribute name="currentStatus" value="<%=index%>"/>
</webuijsf:button> 
```

但是我总是得到已经报告的错误 < 可能未在值中使用。

知道如何从 bean 访问那个特殊的下拉列表吗？或者将它的价值传递给bean？

非常感谢您的帮助，如果您需要更多代码，请告诉我！

来自 2006 年的奥利。/。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:30:53.583

msDropdown 通过彻底检查普通的 html 选择来工作。但是如果你真的在你的 jsf 文档中插入一个 html 选择，你将不会与 jsf 生命周期有任何集成。

解决方案是使用实际的 jsf 组件，即[selectOneMenu](http://www.jsftoolbox.com/documentation/help/12-TagReference/html/h_selectOneMenu.html)。它将完全集成到生命周期中，这意味着您不需要任何黑客来检索值。它将像您页面上的任何其他组件一样提交。

渲染就像客户端上的`selectOneMenu`普通 html 选择一样，这意味着您可以使用 msDropDown 。唯一的困难是获取组件的 id。我建议使用 a`styleClass`代替。它会更容易。

```
<h:selectOneMenu id="status" styleClass="statusSelect" style="left: 150px; top: 62px; width:100px">
    <f:selectItem itemValue=""></option>
    <f:selectItem itemValue="0"></option>
    <f:selectItem itemValue="1"></option>
    <f:selectItem itemValue="2"></option>
</h:selectOneMenu>

<webuijsf:script>
  //setup metadata (images and such)
  var $select = $('.statusSelect');
  var children = $select.children('option');
  $(children[0]).data('image','base0.gif');
  //... and so on to add your metadata

  var oHandler1 = $select.msDropdown().data("dd");
  var index = oHandler1.selectedIndex;
</webuijsf:script> 
```

# php - 不带引号的 PHP 数组访问

> ID：13622486
> 
> 赞同：9
> 
> 时间：2012-11-29T09:23:34.393
> 
> 标签：php, arrays, apostrophe

我在现有的 php 源中发现了一个现象，字段访问没有撇号，如下所示：$_GET[test]。

我不确定，也不知道这是一种可能的方法，所以我写了一个简短的测试示例：

```
echo "Array Test, fields without apostrophe, like \$_GET[fieldname]<BR><BR>";
$a = array();
$a['test'] = "ArrayValue";
echo "case 1 -> \$a['test']: " . $a['test'] . "<BR>";
echo "case 2 -> \$a[\"test\"]: " . $a["test"] . "<BR>";
echo "case 3 -> \$a[test]: " . $a[test] . "<BR>"; 
```

它有效，每个结果都有值（ArrayValue）。

我更喜欢案例2这样的访问方法。

案例 3 是 php 中正常的、允许的编码风格吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T09:34:12.097

这里发生的是 PHP 看到[一个](http://php.net/manual/en/language.constants.php)名为`test`. 如果定义了常量，则返回值，如果没有定义，PHP 会回退到 string `"test"`。例如：

```
$array = array("A" => "Foo", "B" => "Bar", "C" => "Baz")
define("B", "C");

echo $array[A];   // The constant "A" is undefined, 
                  // so PHP falls back to the string "A", 
                  // which has the value "Foo".
echo $array["B"]; // The result is "Bar".
echo $array[B];   // The value of constant "B" is the string "C".
                  // The result is "Baz". 
```

它是为了向后兼容，你永远不应该使用它。如果您[打开通知](http://php.net/manual/en/function.error-reporting.php)，您会看到 PHP 抱怨它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T09:29:27.640

如果您不将密钥放在引号中，它将作为未定义的常量处理（假设它没有在任何地方定义），这可能暂时有效，但在未来的 PHP 版本中可能会失败。因此它是错误的，PHP 文档也指出这个变体是错误的。查看“[数组的注意事项](http://php.net/manual/de/language.types.array.php)”。

顺便说一句：如果将键放在双引号中，它会将变量呈现在键名中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:33:31.147

使用不带引号的数组键名是 PHP 中的一项遗留功能。它最初是这样做的方式，但不再推荐它，并且仍然支持向后兼容。如果您启用了严格模式，它将引发警告消息。

它起作用的原因是它将这种形式的键名视为一个常量。当 PHP 看到一个未知常量时，它默认将常量的名称作为值，因此它可以作为字符串替换。

`define()`如果您在程序中的其他地方设置了该常量的值，它将中断。如果您的键名包含空格、以数字开头或由于任何其他原因是无效的常量名，它也不起作用。

由于这些原因，不建议使用此方法。

但最重要的是，PHP 开发人员公开表示这不是好的做法，这很可能意味着未来的 PHP 版本将取消编写这样的代码的能力。

# jquery - 将 .on 添加到 jQuery .16.1

> ID：13622488
> 
> 赞同：0
> 
> 时间：2012-11-29T09:23:38.383
> 
> 标签：jquery

我需要为 CMS 运行 jQuery 1.6.1，但是我们使用的上传插件使用 jQuery 1.7 的 .on 函数。

我想知道是否有一种方法可以扩展我们的 1.6 以包含 .on 功能。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:33:59.570

除非您有其他非向前兼容的插件，否则我真的看不出不升级到更新的 jQuery 版本的意义。

然而，这里是猴子修补的尝试，利用签名之间的相似性。不过这可能很脆弱，因此您可能还必须补偿其他签名，具体取决于插件如何使用`on`.

```
jQuery.fn.extend( {
        on: function(eventsmap, selector, data, handler) {
            return this.delegate(selector, eventsmap, data, handler)
        }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:33:01.083

在@looper 建议重新阅读[http://api.jquery.com/on/之后](http://api.jquery.com/on/)之后，我尝试使用 .one ，果然它确实有效。不完全确定为什么，但确实如此。

因此，如果您需要在 1.6 上使用 .on，请尝试使用 .one！

# web-services - Apache Cxf Wsdl2java 创建 Web 服务客户端编码错误

> ID：13622491
> 
> 赞同：1
> 
> 时间：2012-11-29T09:23:44.267
> 
> 标签：web-services, wsdl, cxf, wsdl2java

我尝试创建 Web 服务客户端，然后我看到该编码错误。

我更改了eclipse编码属性、JVM编码属性和文件编码属性并设置了UTF-8，但这并没有改变任何东西！

```
 WSDLToJava Error: Schema Error : s4s-att-invalid-value: Invalid attribute value for 'attributeFormDefault' in element 'schema'. Recorded reason: cvc-enumeration-valid: Value 'unqualıfıed' is not facet-valid with respect to enumeration '(qualified | unqualified)'. It must be a value from the enumeration.

org.apache.cxf.tools.common.ToolException: Schema Error : s4s-att-invalid-value: Invalid attribute value for 'attributeFormDefault' in element 'schema'. Recorded reason: cvc-enumeration-valid: Value 'unqualıfıed' is not facet-valid with respect to enumeration '(qualified | unqualified)'. It must be a value from the enumeration.
    at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.validateSchema(JAXBDataBinding.java:911)
    at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.addSchemas(JAXBDataBinding.java:588)
    at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.initialize(JAXBDataBinding.java:391)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.generateTypes(WSDLToJavaContainer.java:589)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.processWsdl(WSDLToJavaContainer.java:242)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:139)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:286)
    at org.apache.cxf.tools.common.toolspec.ToolRunner.runTool(ToolRunner.java:103)
    at org.apache.cxf.tools.wsdlto.WSDLToJava.run(WSDLToJava.java:113)
    at org.apache.cxf.tools.wsdlto.WSDLToJava.run(WSDLToJava.java:86)
    at org.apache.cxf.tools.wsdlto.WSDLToJava.main(WSDLToJava.java:184)
Caused by: org.xml.sax.SAXParseException: s4s-att-invalid-value: Invalid attribute value for 'attributeFormDefault' in element 'schema'. Recorded reason: cvc-enumeration-valid: Value 'unqualıfıed' is not facet-valid with respect to enumeration '(qualified | unqualified)'. It must be a value from the enumeration.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.reportSchemaErr(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.reportSchemaError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSAttributeChecker.reportSchemaError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSAttributeChecker.checkAttributes(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSAttributeChecker.checkAttributes(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDocumentInfo.<init>(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.constructTrees(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.parseSchema(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadSchema(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadGrammar(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadGrammar(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.validation.XMLSchemaFactory.newSchema(Unknown Source)
    at javax.xml.validation.SchemaFactory.newSchema(Unknown Source)
    at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.validateSchema(JAXBDataBinding.java:906)
    ... 10 more 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-10T09:35:01.710

*   从 wsdl 中删除**attributeFormDefault="unqualified" elementFormDefault="unqualified"行**
*   更改您的所有区域设置美国/英国
*   当您导入 WSDL 时，从 Apache CXF 向导中选择**开发客户端**

# c++ - 如何将 C++ 对象转换为 PyObject？

> ID：13622496
> 
> 赞同：4
> 
> 时间：2012-11-29T09:23:55.513
> 
> 标签：c++, python, python-c-api

我有两个 c++ 对象

```
 int queueIndex
    Timer timer_obj 
```

这是计时器类的定义

```
class Timer
{

private:
    struct timeval tStart; /**< @brief Stores the system time when the timer is started */
    struct timeval tFinish; /**< @brief Stores the system time when the timer is stopped */

protected:
    float getElapsedTime(struct timeval, struct timeval);

public:
    Timer();
    string currentTime();
    float currentElapsedTime();
    void restart();
    float stop();
    int high_pres_usleep_untill(unsigned long long int);
    string getStringStartTimer();
    void setStartTimerFromString(string);
    void sleep(long int);
    unsigned long long int get_clock(); 
```

我需要将这两个对象转换为 PyObj*。我为此目的使用了 boost::python。我现在希望在没有 boost 或 swig 的情况下做到这一点。我成功转换了索引，但我对 timer_obj 毫无头绪

```
 PyObject* pyo=PyInt_FromLong(queueIndex) 
```

如果有人可以帮助我，我将不胜感激。我只需要一个示例，您不需要给我完整的代码。而且类中定义的函数有点复杂，所以我没有在这里给出。是否可以转换 timer_obj 然后分配一个新的引用，还是我必须为类中的所有结构和函数获取新的引用并使用这些引用创建一个新类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T22:34:21.733

您需要做的是创建一个[扩展类型](http://docs.python.org/2/extending/newtypes.html)。不幸的是，这个过程相对复杂，需要几百行代码。这就是 boost::python 和 SWIG 的整个 python，用于删除所有样板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T12:38:22.010

正如 Nathan 所说，扩展类型是相对复杂的。您想为此探索 Cython，因为语法更简单，并且它负责在内部生成样板。[http://docs.cython.org/src/userguide/wrapping_CPlusPlus.html](http://docs.cython.org/src/userguide/wrapping_CPlusPlus.html)

您还可以查看 Niklas 在[https://stackoverflow.com/a/8933819/2156678中发布的示例](https://stackoverflow.com/a/8933819/2156678)

# php - JURI::getInstance() 查询缺失

> ID：13622499
> 
> 赞同：0
> 
> 时间：2012-11-29T09:24:13.797
> 
> 标签：php, joomla, uri

我想在 Joomla 页面上有一个小的登录链接。如果我单击此链接并登录，它应该会返回到我之前的页面。为此，我需要当前页面的查询，例如`option=com_component&article=....`但如果我使用`JURI::getInstance()`查询为空（假）。

这是代码：

```
<?php
$user = & JFactory::getUser();
$site = & JURI::getInstance()->getQuery();
$return = urlencode(base64_encode('index.php?'.$site));
?>
<a class="<?php echo $user->id? 'logout-a' : 'login-a';?>" href="index.php?option=com_users&amp;view=login&amp;return=<?php echo $return ?>">
<?php
    if ($user->id) echo 'Logout';
    else echo 'Login';
?>
</a> 
```

回报有效，但它只会让我回到`index.php`，而不是`index.php?option=...`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:47:06.753

使用`JFactory::getURI()`。这可能会帮助你

```
<?php
$user = & JFactory::getUser();
$site = & JFactory::getURI();
$return = $uri->toString();
?>
<a class="<?php echo $user->id? 'logout-a' : 'login-a';?>" href="index.php?option=com_users&amp;view=login&amp;return=<?php echo $return ?>">
<?php
    if ($user->id) echo 'Logout';
    else echo 'Login';
?>
</a> 
```

# c++ - 在 hashmap/unordered_map 中，当 value 已经包含 key 时，是否可以避免数据重复

> ID：13622501
> 
> 赞同：5
> 
> 时间：2012-11-29T09:24:20.873
> 
> 标签：c++, stl, hashmap, unordered-map

给定以下代码：

```
struct Item
{
    std::string name;
    int someInt;
    string someString;
    Item(const std::string& aName):name(aName){}
};
std::unordered_map<std::string, Item*> items;
Item* item = new Item("testitem");
items.insert(make_pair(item.name, item); 
```

项目名称将在内存中存储两次——一次作为 Item 结构的一部分，一次作为映射条目的键。是否可以避免重复？对于大约 100M 的记录，这种开销变得巨大。

注意：我需要在 Item 结构中包含名称，因为我使用 hashmap 作为另一个 Item-s 容器的索引，并且我无法访问映射的键值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:35:45.377

好的，既然你说你使用指针作为值，我特此让我的答案恢复活力。

有点hacky，但应该可以。基本上你使用指针和自定义散列函数

```
struct Item
{
    std::string name;
    int someInt;
    string someString;
    Item(const std::string& aName):name(aName){}

    struct name_hash  
    { 
       size_t operator() (std::string* name)
       {
           std::hash<std::string> h;
           return h(*name);
       }
    };
};
std::unordered_map<std::string*, Item*, Item::name_hash> items;
Item* item = new Item ("testitem");
items.insert(make_pair(&(item->name), item); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T10:17:08.943

假设您用于存储项目的结构首先是一个简单的列表，您可以将其替换为[多索引容器](http://www.boost.org/doc/libs/1_52_0/libs/multi_index/doc/index.html)。

这些方面的东西（未经测试）应该满足您的要求：

```
typedef multi_index_container<
    Item,
    indexed_by<
        sequenced<>,
        hashed_unique<member<Item, std::string, &Item::name
    >
> itemContainer;

itemContainer items; 
```

现在您可以按插入顺序访问项目，也可以按名称查找它们：

```
itemContainer::nth_index<0>::type & sequentialItems = items.get<O>();
// use sequentialItems as a regular std::list

itemContainer::nth_index<1>::type & associativeItems = items.get<1>();
// uses associativeItems as a regular std::unordered_set 
```

根据您的需要，您也可以使用其他索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:26:33.983

不要`std::string name`在结构中存储字段。无论如何，当您执行查找时，您已经知道名称字段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T09:34:11.287

不，没有。你可以：

*   不要单独存放`name`和`Item`传递。
*   Create `Item`，`ItemData`除了`Item`name 和
    *   派生`Item`自`std::pair<std::string, ItemData>`(=`value_type`的类型) 或
    *   使其可转换为该类型。
*   使用对字符串的引用作为键。您应该能够用作键并为键和搜索`std::reference_wrapper<const std::string>`传递键。你可能需要专攻，但这应该很容易。`std::cref(value.name)``std::cref(std::string(whatever))``std::hash<std::reference_wrapper<const std::string>>`
*   使用`std::unordered_set`，但它的缺点是查找会`Item`为查找创建虚拟对象。
    *   当您实际上具有`Item *`as 值类型时，您可以将名称移动到基类并使用多态性来避免该缺点。
*   创建自定义哈希映射，例如使用[Boost.Intrusive](http://www.boost.org/doc/html/intrusive.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-29T09:36:14.513

**TL；DR**如果您使用的是 libstdc++（与 gcc 一起提供），那么您已经可以了。

有3种方法，2种是“简单的”：

*   将您的对象拆分为两个键/值，并停止重复值中的键
*   将您的对象存储在 a`unordered_set`中

第三个更复杂，除非您的编译器提供：

*   使用`std::string`引用计数的实现（例如 libstdc++ 的）

在这种情况下，当您将 a 复制`std::string`到另一个时，内部缓冲区的引用计数器会递增……仅此而已。复制被推迟到所有者之一请求修改的时间：[写时复制](http://en.wikipedia.org/wiki/Copy-on-write)。

# python - 如果我在文件名中使用字母 a 到 f，则会出现错误“文件名无效”

> ID：13622506
> 
> 赞同：0
> 
> 时间：2012-11-29T09:24:40.503
> 
> 标签：python, python-2.7, file-handling

我正在使用 pyton 2.7。我写了一个脚本，当它执行时，它会调用并运行一些名为 abc.py 的其他文件。但我收到错误

```
IOError: [Errno 22] invalid mode ('r') or filename: 'F:\x07bc.c' 
```

如果我更改文件名，它工作正常。只有当我使用从 a 到 f 的字母作为文件名的第一个字母时，它才会显示错误请帮助。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:39:58.757

考虑 Python 字符串`'\a'`。如[文档](http://docs.python.org/2/reference/lexical_analysis.html#string-literals)中所述，反斜杠字符被解释为转义字符。`'\a'`事实上 ASCII Bell 字符也是如此，字符编号 7。

您的文件名是`'F:\abc.c'`，并且其中的文件名被`\a`解释为 ASCII Bell。您可以在解释器中清楚地看到这一点：

```
>>> 'F:\abc.c'
'F:\x07bc.c'
>>> print 'F:\abc.c'
F:bc.c 
```

当您打印该字符串时，请注意`\a`不会出现。那是因为它变成了一个隐形的铃控角色。

要包含反斜杠，您可以使用正确的转义序列`\\`。把它们放在一起，你的文件名应该是：`'F:\\abc.c'`. 作为替代方案，您可以为字符串添加前缀`r`以使其成为原始字符串。[这在文档](http://docs.python.org/2/reference/lexical_analysis.html#string-literals)中也有详细说明。

```
>>> 'F:\\abc.c'
'F:\\abc.c'
>>> print 'F:\\abc.c'
F:\abc.c
>>> r'F:\abc.c'
'F:\\abc.c'
>>> print r'F:\abc.c'
F:\abc.c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:26:11.110

试试这个：

```
open(r'F:\abc.c') 
```

即`r`在引号之前添加。

**更新**对不起，我误解了代码（尽管我的解决方案是正确的）。@DavidHeffernan 是对的，它`\a`被读作 ASCII 钟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:27:10.727

`\`用另一个反斜杠转义，如下所示：

```
print 'F:\\x07bc.c' 
```

# php - 值从 php 到存储过程

> ID：13622509
> 
> 赞同：1
> 
> 时间：2012-11-29T09:24:49.530
> 
> 标签：php, mysql, stored-procedures

这是我的 php 代码

```
<?php
$code='1,2,3';
$this->db->query("CALL SP_db(\"$code\"));
?> 
```

如果`var_dump($code)`我得到这个`string(5) "1,2,3"`

这是我的存储过程代码

```
CREATE DEFINER=`test`@`localhost` PROCEDURE `SP_db`(v_company varchar(10))

begin

select * from blabla where company_id in (v_company);
.
.
. 
```

如果我使用此代码，我使用此代码将一些值插入到表中，我从 php 获取 v_company 它不起作用

但是如果我尝试填充它的值

```
CREATE DEFINER=`test`@`localhost` PROCEDURE `SP_db`(v_company varchar(10))

    begin

    select * from blabla where company_id in (1,2,3); 
```

但是 php 发送的值是由存储过程接收的，我尝试将 v_company 值保存到表中以确保它可以工作

因为来自 php 的值输入到表中

所以有人可以告诉代码错在哪里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:33:24.813

当您将 '1,2,3' 传递给您的过程时，您会得到一个字符串，并且您的查询变为

```
select * from blabla where company_id in ('1,2,3'); 
```

不是

```
select * from blabla where company_id in (1,2,3); 
```

您可以使用`find_in_set`insted`in`

```
select * from blabla where find_in_set(company_id, v_company); 
```

但它不会像使用索引那样好`in`；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:28:32.027

我想你不见了`"`。

```
$this->db->query("CALL SP_db(\"$code\") "); 
```

或者试试这个

```
$this->db->query("CALL SP_db('".$code."') "); 
```

# java - 从另一个类访问 MainActivity 中的方法

> ID：13622510
> 
> 赞同：0
> 
> 时间：2012-11-29T09:24:57.810
> 
> 标签：java, android, class, android-activity, listener

我想我在某个地方的 Android 应用程序中犯了一个设计错误。我的（简化的）代码粘贴在下面。

我在 MainActivity 中使用 writeMidi 方法。但是，当在自定义侦听器中触发“onItemSelected”时，我也想使用它，或者实际上只是触发它。

我对如何做到这一点感到有些不知所措。我应该重新设计此代码以适应主要活动中的自定义侦听器吗？

谢谢你的帮助。

```
public class MainActivity extends Activity{

    int song = 0;
    int[] music;
    public int instrument;
    public CustomOnItemSelectedListener listener;

    // *******************************************************
    // set Layout - on create
    // *******************************************************
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        instrument = 0;

        listener = new CustomOnItemSelectedListener();
        addListenerOnSpinnerItemSelection();

        //more stuff, including using the writeMidi method

};

    public void addListenerOnSpinnerItemSelection(){

        instrumentSp = (Spinner) findViewById(R.id.instrument);
        instrumentSp.setOnItemSelectedListener(listener);
    }

    public void writeMidi(int[] music, int count) {
        // so some stff
    }

} 
```

并在一个单独的文件中；

```
public class CustomOnItemSelectedListener implements OnItemSelectedListener {

    private int instrument = 0;

      public void onItemSelected(AdapterView<?> parent, View view, int pos,long id) {
        Toast.makeText(parent.getContext(), 
            "Please wait a minute for the instrument to be changed. ", Toast.LENGTH_SHORT).show();
         instrument = pos;

      }

      public int getInstrument(){
          return instrument;
      }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:29:16.940

在主类中使用广播接收器并发送不同类型的广播（不同的消息）来激活主活动中的不同方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:29:51.183

您可以创建一个侦听器接口“InstrumentSelectedListener”，或类似的东西。然后让您的 MainActivity 实现该接口，将其注册为您的 CustomOnItemSelectedListener 上的侦听器，并在您的 onItemSelected 中触发“writeMidiNow”事件。

你最终会得到类似的东西：

```
public class MainActivity extends Activity implements OnInstrumentSelectedListener{

int song = 0;
int[] music;
public int instrument;
public CustomOnItemSelectedListener listener;

// *******************************************************
// set Layout - on create
// *******************************************************
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    instrument = 0;

    listener = new CustomOnItemSelectedListener();
    addListenerOnSpinnerItemSelection();

    //more stuff, including using the writeMidi method

};

public void addListenerOnSpinnerItemSelection(){

    instrumentSp = (Spinner) findViewById(R.id.instrument);
    instrumentSp.setOnItemSelectedListener(listener);
}

public void onInstrumentSelected(int instrument) {
    //  do some stuff with the instrument.
}

public void writeMidi(int[] music, int count) {
    // so some stff
}

} 
```

和

```
public class CustomOnItemSelectedListener implements OnItemSelectedListener {

public interface OnInstrumentSelectedListener{
    public void onInstrumentSelected(int instrument);
}

private int instrument = 0;
private OnInstrumentSelectedListener instrumentlistener;
  public void onItemSelected(AdapterView<?> parent, View view, int pos,long id) {
    Toast.makeText(parent.getContext(), 
        "Please wait a minute for the instrument to be changed. ", Toast.LENGTH_SHORT).show();
     instrument = pos;

     if(instrumentListener != null)
        instrumentListener.onInstrumentSelected(instrument);

  }

  public void setInstrumentListener(OnInstrumentSelectedListener listener) {
      this.instrumentListener = listener;
  }

  public int getInstrument(){
      return instrument;
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:31:47.310

**2种方法来做到这一点：**

**-**首先将类的上下文传递`MainActivity`给`CustomOnItemSelectedListener`类。

**-**第二种方法是快速而肮脏的，将`writeMidi()`方法设为**静态**，但你应该记住，`static methods`只能**访问** `static members`，不能访问**非静态成员。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T15:56:15.107

我尝试了一些建议的解决方案，但没有一个能够完全发挥作用。

所以我通过不使用这样的单独类来解决它：

```
instrumentSp.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {   
     public void onItemSelected(AdapterView<?> parent, View view, int pos,long id) { 
```

# python - 在python中用序列号字符串替换模式

> ID：13622517
> 
> 赞同：8
> 
> 时间：2012-11-29T09:25:24.937
> 
> 标签：python, replace, sequential

我正在尝试在 python 中实现以下替换。用 {n} 替换所有 html 标签并创建 [tag, {n}] 的哈希
原始字符串 -> “`<h>`这是一个字符串。`</H><P>`这是另一部分。`</P>`”
替换文本 -> “{0} 这是一个字符串。{ 1}{2}这是另一部分。{3}"

这是我的代码。我已经开始替换，但我坚持替换逻辑，因为我无法找出以连续方式替换每个事件的最佳方法，即使用 {0}、{1} 等：

```
import re
text = "<h> This is a string. </H><p> This is another part. </P>"

num_mat = re.findall(r"(?:<(\/*)[a-zA-Z0-9]+>)",text)
print(str(len(num_mat)))

reg = re.compile(r"(?:<(\/*)[a-zA-Z0-9]+>)",re.VERBOSE)

phctr = 0
#for phctr in num_mat:
#    phtxt = "{" + str(phctr) + "}"
phtxt = "{" + str(phctr) + "}"
newtext = re.sub(reg,phtxt,text)

print(newtext) 
```

有人可以帮助以更好的方式实现这一目标吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T09:42:58.193

```
import re
import itertools as it

text = "<h> This is a string. </H><p> This is another part. </P>"

cnt = it.count()
print re.sub(r"</?\w+>", lambda x: '{{{}}}'.format(next(cnt)), text) 
```

印刷

```
{0} This is a string. {1}{2} This is another part. {3} 
```

仅适用于简单标签（标签中没有属性/空格）。对于扩展标签，您必须调整正则表达式。

此外，不重新初始化`cnt = it.count()`将使编号继续进行。

**更新**以获取映射字典：

```
import re
import itertools as it

text = "<h> This is a string. </H><p> This is another part. </P>"

cnt = it.count()
d = {}
def replace(tag, d, cnt):
    if tag not in d:
        d[tag] = '{{{}}}'.format(next(cnt))
    return d[tag]
print re.sub(r"(</?\w+>)", lambda x: replace(x.group(1), d, cnt), text)
print d 
```

印刷：

```
{0} This is a string. {1}{2} This is another part. {3}
{'</P>': '{3}', '<h>': '{0}', '<p>': '{2}', '</H>': '{1}'} 
```

# hibernate - 将多个 JPA 实体管理器与单个数据库一起使用

> ID：13622519
> 
> 赞同：2
> 
> 时间：2012-11-29T09:25:29.250
> 
> 标签：hibernate, jakarta-ee

我有以下设置，客户端 <--> Web <--> 具有 Hibernate 的多个数据服务（在不同的服务器中）<--> 数据库

这种设置可以吗？（单个数据库的多个 Hibernate 实例）。如果是这样，如果我在 Hibernate 端启用缓存，如何检索正确的数据？因为在其中一台服务器中，旧数据可能会被缓存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:36:25.860

是的。这个有可能。我们有一个使用相同机制的应用程序。我不确定hibernates是否管理分布式缓存（如oracle coherence）。但是对于我们的应用程序，我们已经实现了一个分布式缓存来管理这个场景。

# php - 如何不从表单而是从所见即所得更新 mysql

> ID：13622521
> 
> 赞同：1
> 
> 时间：2012-11-29T09:25:32.130
> 
> 标签：php, mysql, wysiwyg

我想通过在表单中​​使用所见即所得来更新 mysql 我将所见即所得放在表单内的页面中并定义它的 id="editor" 如下所示：

```
<form Method="post" action="post.php">
<input type="text" name="title" />
<div id="editor"></div>
<input type="submit" name="update" value="update">
</form> 
```

在 post.php 文件中：

```
<?php
 if (isset($_POST['update'])){
 $title=$_POST['title'];
 $body=$_POST['editor'];
 mysql_connect("x", "y","z")or die (mysql_error());
 mysql_select_db('t')or die (mysql_error());
 mysql_query("UPDATE news SET title='$title', body='$body' WHERE  `id`='$_GET[update]'");
 mysql_close();
 header("location:new_page.php"); 
 ?> 
```

问题是在 mysql 中更新的第一个输入，但 $body 没有所见即所得的 sam 值，或者它没有在 mysql 中更新？并且所见即所得的编辑器还推荐了一个 div 在编辑中写入

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:30:30.517

假设您使用的是 TinyMCE - 您必须强制 textarea 从表单提交处理程序中的编辑器更新。

[jQuery 和 TinyMCE：textarea 值不提交](https://stackoverflow.com/questions/2122085/problem-jquery-and-tinymce-textarea-value-doesnt-submit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:36:36.453

“编辑器”不是输入所以，而不是 `<div id="editor">` 你需要 `<textarea id="editor" name="editor"></textarea>`

# wpf - 当 AutoGenerateColumns="True" 时如何使数据网格的特定列成为组合框

> ID：13622522
> 
> 赞同：4
> 
> 时间：2012-11-29T09:25:35.553
> 
> 标签：wpf, mvvm

我是 MVVM 新手。我在我的项目中使用 wpf 和 MVVM。所以我现在正在测试一些东西，然后再深入研究我需要编写的应用程序。

我的页面（EmpDetailsWindow.xaml）是这样的

```
<Grid>
    <DataGrid Name="dgEmployee" Grid.Row="0" AutoGenerateColumns="True" ItemsSource="{Binding EmployeeDataTable}" CanUserAddRows="True" CanUserDeleteRows="True" IsReadOnly="False"  />
    <Button x:Name="btnSubmit" Content="Submit" Command="{Binding SubmitCommand}" CommandParameter="sample param" HorizontalAlignment="Left" Margin="212,215,0,0" VerticalAlignment="Top" Width="75"/>
</Grid> 
```

我的模型（EmpDetailsWindowViewModel）如下

```
public class EmpDetailsWindowViewModel : INotifyPropertyChanged
    {
        public ICommand SubmitCommand { get; set; }
        public EmpDetailsWindowViewModel()
        {
            EmployeeDataTable = DataTableCreator.EmployeeDataTable();
            GenderDataTable = DataTableCreator.GenderDataTable();
            SubmitCommand = new SubmitCommand();
        }

        DataTable _employeeDataTable;
        public DataTable EmployeeDataTable
        {
            get { return _employeeDataTable;}
            set
            {
                _employeeDataTable = value;
                RaisePropertyChanged("EmployeeDataTable");
            }
        }

        DataTable _genderDataTable;
        public DataTable GenderDataTable
        {
            get { return _genderDataTable; }
            set
            {
                _genderDataTable = value;
                RaisePropertyChanged("GenderDataTable");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void RaisePropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    } 
```

datagrid 已成功绑定到数据表。现在我在数据网格中有一个“性别”列。这应该是一个组合框，并且组合框的项目源来自视图模型的 GenderDataTable 。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T11:46:22.387

你可以这样做

```
<DataGrid AutoGeneratingColumn="DataGrid_AutoGeneratingColumn"/>

private void DataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
    if (e.PropertyName == "Gender")
    {
        var cb = new DataGridComboBoxColumn();
        cb.ItemsSource = (DataContext as MyVM).GenderDataTable;
        cb.SelectedValueBinding = new Binding("Gender");
        e.Column = cb;
    }        
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-07T12:09:53.460

这里似乎没有一个完整的答案，所以我将发布我从这个问题和实验中发现的内容。我敢肯定这违反了许多规则，但它很简单而且很有效

```
public partial class MainWindow : Window
    {
        // define a dictionary (key vaue pair). This is your drop down code/value
        public static Dictionary<string, string> 
              dCopyType = new Dictionary<string, string>() { 
                 { "I", "Incr." }, 
                 { "F", "Full" } 
              };

// If you autogenerate columns, you can use this event 
// To selectively override each column
// You need to define this event on the grid in the event tab in order for it to be called
private void Entity_AutoGeneratingColumn(object sender,
                                         DataGridAutoGeneratingColumnEventArgs e)
        {

            // The name of the database column
            if (e.PropertyName == "CopyType")
            {
                // heavily based on code above
                var cb = new DataGridComboBoxColumn();
                cb.ItemsSource = dCopyType;  // The dictionary defined above
                cb.SelectedValuePath = "Key";  
                cb.DisplayMemberPath = "Value";
                cb.Header = "Copy Type"; 
                cb.SelectedValueBinding = new Binding("CopyType");
                e.Column = cb;
            }

        }
  } // end public partial class MainWindow 
```

# c# - 将表单绑定到另一个进程的窗口

> ID：13622525
> 
> 赞同：0
> 
> 时间：2012-11-29T09:25:46.657
> 
> 标签：c#, winforms

对于我的项目，我需要将我的 Winform 绑定到另一个进程的窗口，在本例中是标题为“客户端”的浏览器页面，以便它只能在该窗口中移动它。最好和稳定的方法是什么？

我试过按标题获取窗口进程，它成功了。我通过使用 getWindowRect 方法获得了窗口矩形，但这似乎并没有真正起作用，因为表单无法正确绑定到表单。

```
IntPtr hWnd = FindWindow(null, this.windowTitle);
RECT rect1;
GetWindowRect(hWnd, out rect1);

RECT rect2;
GetWindowRect(this.Handle, out rect2);

if (!(rect2.Y >= rect1.Y && rect2.Y + rect2.Height <= rect1.Y + rect1.Height && rect2.X >= rect1.X && rect2.X + rect2.Width <= (rect1.X + rect1.Width) - (rect1.Width / 3)))
{
Console.WriteLine("You can't leave the window with this form! Naughty!");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T12:48:39.083

```
if (!(rect2.Y >= rect1.Y && rect2.Y + rect2.Height <= rect1.Y + rect1.Height ... 
```

显然，您对 RECT 的声明是虚假的。它没有 Height 或 Width 属性，它的行为不像 .NET Rectangle 类型。始终使用 pinvoke.net 网站或 Pinvoke Interop Assistant 工具等良好来源仔细检查您的 pinvoke 声明。正确的声明是：

```
private struct RECT {
    public int Left, Top, Right, Bottom;
} 
```

相应地调整您的 if() 语句。

# c++ - 使用 QMathGL 绘制实时数据？

> ID：13622526
> 
> 赞同：2
> 
> 时间：2012-11-29T09:25:46.820
> 
> 标签：c++, multithreading, qt, boost, mathgl

真的被卡住了，需要一些建议或真实的例子。

1）我有 boost::thread 向量生产者线程（数据快速到达〜每秒 100 个样本）2）我希望 QMathGL 在数据到达时绘制数据 3）我不希望我的 Qt gui 冻结

我试图将 QMathGL::update() 移动到单独的线程 - Qt 认为 QPixmap 不允许在单独的线程中使用。

在不修改 QMathGL 的情况下，我应该尝试什么？

唯一想到的是在计时器上重绘（fps？），但我不喜欢这个解决方案，如果我错了，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:29:08.280

我强烈建议使用计时器。重绘操作成本高昂，我假设没有用户可以实际每秒处理超过 10 个打印的矢量。所以我看不到对最终用户的真正好处，除了显示更新更“流畅”和条目输入。但是你可以通过动画更容易地实现这些效果；）

每次数据更改都重新绘制时，您会得到所描述的烦人行为。解决这个问题（恕我直言）不值得麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T09:35:59.167

我有时也会遇到类似的问题。

我使用的通常解决方案是缓冲数据并在计时器上重新绘制。这沿着这条线（伪代码）：

```
void Widget::OnNewData(void *dataSample)
{
    this->threadSafebuffer->appendData(dataSample);
}
void Widget::OnTimeout()
{
    DataBuffer renderBatch = this->threadSafebuffer->interlockedExchange();
    /* Do UI updates according to renderBatch */

} 
```

这假定在后台线程上调用 OnNewData。OnTimeout 从 UI-EventLoop 上的 QTimer 调用。为了防止争用，它只是将当前缓冲区指针与第二个缓冲区进行互锁交换。所以不需要繁重的同步（例如 Mutext/Semaphore）。

这仅在渲染渲染批处理的工作量小于超时时才有效。

# ruby-on-rails - Ruby on Rails：如何使用名为“open”的范围？

> ID：13622531
> 
> 赞同：2
> 
> 时间：2012-11-29T09:26:02.187
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, scope, ruby-on-rails-3.2

我在我的项目中使用 Rails 3.2.8，我想使用名为“open”的范围

`scope :open, where(:closed => false)`

为了用 JSON 发送它。类似的东西`json.open @foo.bar.open.count`。但是 Rails 将其识别`.open`为 Ruby 方法（我猜与打开的文件有关），而不是我的范围（并抛出错误 "wrong number of arguments (0 for 1)"）。如何强制 Rails 使用我的范围，而不是 Ruby 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:30:44.347

在 Rails 3 中，`scope`和`class method`基本上是一回事。

我认为您正在调用 the`instance method`而不是`class method`.

```
class Foo
  scope :open, where(:closed => false)

  def open
    #instance_method
  end
end
# how to call them
Foo.open # scope/class method
Foo.new.open # instance_method 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:38:47.797

`open`不是`ActiveRecord::Base` *class*上的保留方法名称，所以这应该不是问题。

例如：

```
class Post < ActiveRecord::Base
  scope :open, :where(:closed => false)
  ...
end

Post.open
#=> [#<Post id: 1, closed: false>, #<Post id: 5, closed: false>, ... ] 
```

（@oldergod 发布了类似的内容并删除了他的答案。）

# python - 如何在python中修剪字符串的n个字符？

> ID：13622535
> 
> 赞同：1
> 
> 时间：2012-11-29T09:26:12.943
> 
> 标签：python, string, strip

我是 python 新手。**只有当最后 6 位数字为零时，**我才想修剪一个字符串。我检查了**strip()**方法，但我没有看到一个指示要从右侧修剪的**n 个字符的方法。**

示例字符串：

```
20121124000000 
```

结果字符串应该是：

```
20121124 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T09:26:58.893

```
s = s[:-6] if s.endswith('000000') else s 
```

或定义一个函数：

```
def rstrip_chars(s, chars):
    return s[:-len(chars)] if s.endswith(chars) else s

s = rstrip_chars(s, '000000') 
```

# .net - 使用 Stream 并关闭流时出现错误的 WebFaultException

> ID：13622537
> 
> 赞同：7
> 
> 时间：2012-11-29T09:26:14.693
> 
> 标签：.net, wcf, rest, exception, exception-handling

我们有一个使用 WCF 构建的 REST API。

我们使用 WebFaultException 处理所有异常后端，如下所示：

```
throw new WebFaultException<string>(e.Message, HttpStatusCode.NotAcceptable); 
```

这工作得很好，除了在我们使用流进行 Post 的一种情况下。

**一个例子：**

```
[WebInvoke(Method = "POST", UriTemplate = "saveUser?sessionId={sessionId}&userId={userId}",
        RequestFormat = WebMessageFormat.Json,
        ResponseFormat = WebMessageFormat.Json,            
        BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    [OperationContract]
    string SaveUser(string sessionId, int userId, Stream stream); 
```

在 using 语句中处理此流时，每当我们遇到异常时，我们都会不断收到：

**从提琴手：**

```
HTTP/1.1 400 Bad Request 
  <p>The server encountered an error processing the request. The exception message is 'The message object has been disposed.'. See server logs for more details. The exception stack trace is: </p>
  <p>  at System.ServiceModel.Channels.ByteStreamMessage.InternalByteStreamMessage.get_Properties()
   at System.ServiceModel.OperationContext.get_IncomingMessageProperties()
   at System.ServiceModel.Dispatcher.WebErrorHandler.ProvideFault(Exception error, MessageVersion version, Message&amp; fault)</p> 
```

看起来它与正在处理的流和 StreamReader 有关。

然后，我尝试删除将处理 StreamReader 的任何内容，并且这确实有效。处理这个的代码现在看起来像这样：

![在此处输入图像描述](../Images/6ebcad79347c0d850da4e95f05bb19ba.png)

这解决了发送正确异常消息的问题，但这会对我们的应用程序造成多大的影响，而不是关闭或处置我们的 StreamReader？您是否看到任何其他解决此问题的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T13:40:38.983

发生这种情况是因为 StreamReader 接管了流的“所有权”。换句话说，它使自己负责关闭源流。一旦您的程序调用 Dispose 或 Close（在您的情况下保留 using 语句范围），它也会处理源流。在您的情况下调用 sr.Dispose() 。所以文件流之后就死了。

如果你不想要这个，你可以创建一个继承自 StreamReader 的新类并覆盖 Close 方法；在您的 Close 方法中，调用不会关闭流的 Dispose(false)。

您还可以使用`NonClosingStreamWrapper`Jon Skeet 的[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)库中的类，它正是用于此目的。

但是最好不要在没有处理它的情况下离开 StreamReader，因为它无法清理任何非托管资源。

# xslt-1.0 - XSLT 获得前五个唯一结果

> ID：13622539
> 
> 赞同：0
> 
> 时间：2012-11-29T09:26:20.940
> 
> 标签：xslt-1.0, transformation, xslt

我是 XSLT 1.0 的初学者。我正在使用 XSLT 将 XML 转换为 XML。我想从收到的 XML 中获取前 5 个唯一航空公司。

**源 XML：**

```
<Response>
    <Flights>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>AB</Airline>
                </Segment>
            </Segments>
        </Flight>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>CD</Airline>
                </Segment>
            </Segments>
        </Flight>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>EF</Airline>
                </Segment>
            </Segments>
        </Flight>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>EF</Airline>
                </Segment>
            </Segments>
        </Flight>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>EF</Airline>
                </Segment>
            </Segments>
        </Flight>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>EF</Airline>
                </Segment>
            </Segments>
        </Flight>
        <Flight>
            <Segments>
                <Segment>
                    <Airline>SD</Airline>
                </Segment>
            </Segments>
        </Flight>
    </Flights>
    <OtherRecommens>
        <RecommFlight>
            <Airline>XY</Airline>
        </RecommFlight>
        <RecommFlight>
            <Airline>ZZ</Airline>
        </RecommFlight>
        <RecommFlight>
            <Airline>XY</Airline>
        </RecommFlight>
        <RecommFlight>
            <Airline>AB</Airline>
        </RecommFlight>
    </OtherRecommens>
</Response> 
```

**XSLT：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

    <xsl:output method="xml" indent="yes" />

    <xsl:template match="Response">
        <xsl:element name="Root">
            <xsl:variable name="Airlines" select="//Airline"/>
            <xsl:for-each select="$Airlines">
                <xsl:if test="not(preceding::Airline[.=current()/text()])">
                    <xsl:element name="SpecificAirline">
                        <xsl:value-of select="text()"/>
                    </xsl:element>
                </xsl:if>
            </xsl:for-each>
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

通过应用上面的 XSLT，我得到以下输出：

**输出：**

```
<Root>
  <SpecificAirline>AB</SpecificAirline>
  <SpecificAirline>CD</SpecificAirline>
  <SpecificAirline>EF</SpecificAirline>
  <SpecificAirline>SD</SpecificAirline>
  <SpecificAirline>XY</SpecificAirline>
  <SpecificAirline>ZZ</SpecificAirline>
</Root> 
```

根据我的要求，我只需要获得前五家航空公司

**预期输出：**

```
<Root>
  <SpecificAirline>AB</SpecificAirline>
  <SpecificAirline>CD</SpecificAirline>
  <SpecificAirline>EF</SpecificAirline>
  <SpecificAirline>SD</SpecificAirline>
  <SpecificAirline>XY</SpecificAirline>
</Root> 
```

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:53:23.427

我使用了这里描述的分组：[how to apply group by on xslt elements](https://stackoverflow.com/questions/2146648/how-to-apply-group-by-on-xslt-elements)

`5 >= position()`此处描述的数组索引限制：http: [//www.w3schools.com/xpath/xpath_functions.asp#context](http://www.w3schools.com/xpath/xpath_functions.asp#context)

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

    <xsl:output method="xml" indent="yes" />

    <xsl:key name="airlinetext" match="Airline" use="text()" />

    <xsl:template match="Response">
        <xsl:element name="Root">
            <xsl:apply-templates select="(//Airline[generate-id(.)=generate-id(key('airlinetext',text())[1])])[5&gt;=position()]"/>
        </xsl:element>
    </xsl:template>

    <xsl:template match="Airline">
                <xsl:element name="SpecificAirline">
                    <xsl:value-of select="text()"/>
                </xsl:element>
    </xsl:template>

</xsl:stylesheet> 
```

# ajax - ajax 中的错误（jquery 1.8.3）

> ID：13622542
> 
> 赞同：0
> 
> 时间：2012-11-29T09:26:30.983
> 
> 标签：ajax, jquery

我在javascript中有这段代码

```
$(document).ready(function() {
    $('#form_country').bind({
        'change' : function(){
            var value = $(this).find('option:selected').val();
            if(value>=0){
                $.ajax({
                    type: "POST",
                    url: "{{ path('fill_form_select') }}",
                    dataType: 'json',
                    data: {
                        val : value
                    },
                    success : function(json){
                        var $formSelect2 = $('#form_city');
                        $formSelect2.attr('disabled',false);
                        $formSelect2.empty();

                        for(i=0; i<json.length; i++){
                            alert(json[i]);
                        }
                    },
                    error: function(){
                        alert('ERROR');
                    }
                })
            }
        }
    })
}) 
```

但是当我加载我的页面时，我有 alert('ERROR') 为什么？

我想我在这一行有错误： url: "{{ path('fill_form_select') }}"

如何通过路由器传递路径？

# version-control - 如何更好地控制我的小框架？

> ID：13622544
> 
> 赞同：0
> 
> 时间：2012-11-29T09:26:34.360
> 
> 标签：version-control

我有一个用于 HTML 开发的小 php 框架。我基本上通过编写返回一些 HTML 标记的函数来使 HTML 具有半功能性。例如：

```
P('Some, text' . a('Link', '#'), 'my_class); 
```

返回如下内容：

```
<p class="my_class">Some, text<a href="#">Link</a></p> 
```

除了写起来更短之外，它也快了很多，不仅因为它更短，而且因为与输入等效标记相比，输入函数调用所需的奇怪字符组合更少。

这个框架仍在开发中，但我在不同的项目中使用它。我目前的布局是这样的：

```
~/publkic_html/
   ->core/
   ->project_1/
     ->core/
   ->project_2/
     ->core/
   ->project_3/
     ->core/ 
```

如您所见，该框架称为核心，我在顶层目录中有一个副本，然后，每个项目都有自己的副本。我目前所做的不是任何形式的版本控制，当我对项目的核心进行更改时，我将项目上的核心复制回顶级目录核心。

例如，假设我正在处理 project_1，并且我意识到我需要将一些东西添加到核心中，所以我添加了它。然后我将 project_1 上的核心复制到顶部核心：

```
cp -rvu ~/public_html/project_1/core/ ~/public_html/ 
```

我进行递归更新。我喜欢详细，因为我可以看到正在复制的内容。

当我需要处理另一个项目时，比如说 project_2，我会做相反的事情，使用 ~/public_html/core 中的内容更新 project_2/core/

如您所见，这是一个问题。它不仅烦人，而且还很容易出现问题。例如，我可能在更改项目本地的核心后忘记进行更新。这会带来很多问题，比如在两个不同项目上更改同一个文件而不进行更新可能会导致更改被覆盖和丢失。

我怎样才能以更有效和安全的方式管理它？更不用说理智了！

我在看 git，但似乎我最终会得到许多不同的版本控制版本的核心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:42:16.823

您可以（真的 -**必须**）使用任何允许代码重用和共享（而不是克隆）的 SCM（而且我不知道任何没有**此**功能的 VCS）

1.  颠覆
    *   外在
2.  水银
    *   子仓库（guestrepo）
3.  吉特
    *   子模块（git-subtree）

PS：Git 作为第一个 VCS 是最糟糕的选择

# c# - 来自 C# Facebook sdk 问题的 C# 动态解析搜索结果

> ID：13622547
> 
> 赞同：1
> 
> 时间：2012-11-29T09:26:43.583
> 
> 标签：c#, facebook-c#-sdk

尝试在 Facebook 上搜索页面

```
 if (sq.ObjectType.Equals("page"))
    {
        searchPath = "/search";

        req.q = sq.Query;
        req.type = sq.ObjectType;

    }

    dynamic results = FBClient_.Get(req); 
```

而且我不知道如何解析结果。我不能只是简单地循环它们。

而且我也看不到该结构，因为它是动态对象，它具有以下结构：

```
{
   "data": [
      {
         "name": "Platform-3",
         "category": "Health/medical/pharmacy",
         "id": "362034114769"
      },
      {
         "name": "Platform Expos",
         "category": "Product/service",
         "id": "521000451259682"
      },
      {
         "name": "eXo Platform",
         "category": "Software",
         "id": "152603664817327"
      },
      {
         "name": "Platform 28",
         "category": "Bar",
         "id": "104411956289378"
      },
} 
```

但如何得到它我不确定。如何将其转换为可读格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T03:34:57.963

这里有一些映射。

```
objects => IDictionary<string, object> or IDictionary<string, dynamic>
arrays => IList<object> or IList<dynamic>
number => long if whole number, double if have decimal values
string => string
boolean => bool 
```

所以在你的情况下你可以这样做。

```
dynamic result = fb.Get("...")
foreach(var data in result.data) {
    var name = data.name;
    var category = data.category;
    var id = data.id
} 
```

由于`result.data`是动态的，实际上`IList<object>`您可以在其上使用 foreach 。你也可以试试这个。

```
dynamic result = fb.Get("...")
IList<dynamic> data = result.data;
foreach(var d in data) {
    string name = d.name;
    string category = d.category;
    string id = d.id
} 
```

或者你是强类型的。

```
public class SearchResults {
    public IList<SearchResult> data { get; set;}
}

public class SearchResult {
    public string id { get; set; }
    public string name { get; set; }
    public string category { get; set; }
}

var result = fb.Get<SearchResults>(...) 
```

如果您想遵循 C# 命名标准，请使用`DataContract`和`DataMember`.

```
[DataContract]
public class SearchResults {
    [DataMember(Name = "data")]
    public IList<SearchResult> Data { get; set;}
}

[DataContract]
public class SearchResult {
    [DataMember(Name = "id")]
    public string Id { get; set; }

    [DataMember(Name = "Name")]
    public string Name { get; set; }

    [DataMember(Name = "Category")]
    public string Category { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T03:39:18.637

您要么必须创建强类型类来表示 prabir 发布的 JSON 数据，要么可以使用 JSON 库（例如[Json.NET](http://james.newtonking.com/pages/json-net.aspx)），它可以让您更轻松地与数据交互。这是他们页面中的一个示例：

```
string json = @"{
  ""Name"": ""Apple"",
  ""Expiry"": new Date(1230422400000),
  ""Price"": 3.99,
  ""Sizes"": [
    ""Small"",
    ""Medium"",
    ""Large""
  ]
}";

JObject o = JObject.Parse(json);

string name = (string)o["Name"];
// Apple

JArray sizes = (JArray)o["Sizes"];

string smallest = (string)sizes[0]; 
```

# phpdoc - html 包含文件中的 phpDocumentor 页面级 docBlock

> ID：13622548
> 
> 赞同：2
> 
> 时间：2012-11-29T09:26:48.610
> 
> 标签：phpdoc

我正在使用来自 phpdoc.org 的工具，当我有一个 PHP 文件（例如 header.inc.php），其中只有 HTML 时，我被卡住了。

```
<?php
    /**
    * Header content
    *
    * @author  My name
    *
    * @since 1.0.0
    */
?>
<!DOCTYPE html>
<html lang="fr" class="no-js"> 
    <head>
... 
```

我的 phpdoc 中出现错误“在文件中找不到页面级 DocBlock...”。我用谷歌搜索了它，但我没有找到任何与我的案例有关的用户。

如何修复该错误？欢迎任何提示。

谢谢！

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T01:11:07.327

我刚刚看到这个帖子，虽然它比较旧，但我想我会加两分钱。虽然 sylouuu 将命名空间直接放在预期的页面级 DocBlock 之后是正确的，但我相信现在需要在 DocBlock 中放置“@package”标签。在处理逻辑与分层“包”时，这里有一些注意事项。这种行为基本上取决于您使用的 PHPDocumentor 版本。

来自： http: [//manual.phpdoc.org/HTMLSmartyConverter/HandS/phpDocumentor/tutorial_elements.pkg.html](http://manual.phpdoc.org/HTMLSmartyConverter/HandS/phpDocumentor/tutorial_elements.pkg.html) “在 phpDocumentor 版本 1.2.2 中，如果页面级 DocBlock 包含 @package 标记，则它是文件中的第一个 DocBlock 。”

在[https://github.com/phpDocumentor/phpDocumentor2/issues/910](https://github.com/phpDocumentor/phpDocumentor2/issues/910)可以看到，就在一个月前，没有 PHP 代码/节点的文件中的页面级 DocBlocks 问题仍在处理中。因此，正如 sylouuu 所说的添加命名空间，一旦你这样做了，你就有了一个可记录的元素，你的问题应该得到解决。此外，由于在没有节点的情况下很可能不会创建页面文档，因此这允许您的 html-only 文件创建其文档。

希望能帮助到你！dw

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T09:41:19.623

好的 anwser 发现：[https ://github.com/phpDocumentor/phpDocumentor2/issues/695](https://github.com/phpDocumentor/phpDocumentor2/issues/695)

TL;DR：目前，它还没有修复，只是忽略这些警告。

# python - 在 Python 中，当收益率超过返回列表时？

> ID：13622551
> 
> 赞同：2
> 
> 时间：2012-11-29T09:26:54.560
> 
> 标签：python

在很多情况下，人们都在说“使用`yield`懒惰创建元素”。但我认为一切都有成本，包括`yield`和它的迭代器。

在有效的北方人眼中，我认为这是一个很好的问题。所以，例如，当我得到一个函数时。

```
def list_gen(n):
    if n > MAGIC_NUM:
        return xrange(n)
    else:
        return range(n) 
```

MAGIC_NUM 的剂量是多少？

**更新**对不起这个错误，我的原意是比较迭代器的成本和列表成本。

**再次更新**请对案例进行成像。是否有一个条件，即内存如此有限以至于无法创建迭代器。

哈，这个问题现在更有趣了。
**再次更新**为什么创建迭代器并保存产量上下文比创建列表要少？或者迭代器的成本是多少？（对不起我的侮辱）多少字节？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:46:40.967

你把几件事混在一起了。

```
def list_gen(n):
    i=0
    while i<n:
        yield i
        i += 1 
```

这个函数是一个**生成器**。调用它会返回一个生成器对象，它是一个**迭代器**。

迭代器是具有 的事物`next()`，即它可以被遍历一次。每当`iter`您执行`for i in something`.

```
def list_gen(n):
    return range(n)

def list_gen(n):
    return xrange(n) 
```

这些函数是常规函数。一个返回一个`list`，另一个返回一个`xrange`对象。列表和 xrange 都是**可迭代**的，即可以为它们创建多个独立的迭代器。

* * *

所以回到你的问题：你问是返回一个`list`还是一个`xrange`对象。

这取决于，显然！这取决于你想对结果做什么。

*   如果你想以某种方式对其进行变异，那么你需要一个真实的列表。直接使用`range`。

*   如果您只想迭代它，那么它在语义上并没有什么不同：`xrange`对象和`list`返回的对象`range`都会产生一个迭代器，该迭代器迭代相同的序列。

    但是，如果您使用`xrange`，您将永远不会在内存中创建整个列表。`list`如果你想做的只是一个简单的迭代，为什么还要在内存中创建一个成熟的对象呢？您不需要在需要`for`循环时分配临时的大内存缓冲区，对吗？

**因此：坚持使用 是安全的`xrange`，因为调用者总是可以从中获利`list`。**

* * *

让我们用一个基准来确认这一点。我们想知道迭代 xranges 是否比迭代 by 构造的列表更快`range`（当然包括`range`调用成本）。

代码：

```
import timeit

ns = [1,2,3, 5, 10, 50, 100]
print 'n', '\t', 'range', '\t', 'xrange'
for n in ns:
    t1 = timeit.timeit("for i in range({}): pass".format(n))
    t2 = timeit.timeit("for i in xrange({}): pass".format(n))
    print n, '\t', t1, '\t', t2 
```

结果：

```
n       range           xrange
1       0.566222990493  0.418698436395
2       0.594136874362  0.477882061758
3       0.630704800817  0.488603362929
5       0.725149288913  0.540597548519
10      0.90297752809   0.687031507818
50      2.44493085566   1.89102105759
100     4.31189321914   3.33713522433 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T09:30:21.243

它与您生成的迭代器的长度无关，而是与您之后需要如何使用它有关。如果您只需要使用一次，那么您绝对应该选择**yield**，如果您要多次使用它，您可以跳过**yield**并获得一个常规列表。请记住，您使用 yield 获得的生成器只能迭代**一次**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T10:00:00.663

尽管您的问题及其标题仍然有些混淆，但我会尝试以我理解的方式回答。

如果您只想遍历 的结果，对于更短和更长的范围`(x)range()`，`xrange()`（特殊对象）比`range()`（列表）更好：

```
$ python -m timeit 'a=range(3)' 'for i in a: pass'
1000000 loops, best of 3: 0.608 usec per loop
$ python -m timeit 'a=xrange(3)' 'for i in a: pass'
1000000 loops, best of 3: 0.466 usec per loop

$ python -m timeit 'a=xrange(30000)' 'for i in a: pass'
1000 loops, best of 3: 1.01 msec per loop
$ python -m timeit 'a=range(30000)' 'for i in a: pass'
1000 loops, best of 3: 1.49 msec per loop 
```

所以`xrange()`总是使用会更好。

* * *

如果您看一下一般情况，可能会略有不同：您比较“预生产”值/对象，将它们存储在列表中，然后在生产后直接使用它们进行处理：

```
def gen(num):
    import random
    i = 0
    while i < num:
        value = random.random()
        yield value
        i += 1

def process(value): pass

def test1(num):
    data = list(gen(num))
    for i in data: process(num)

def test2(num):
    for i in gen(num): process(num) 
```

这取决于生产和消费如何相互作用，以及开销有多大。

如果您希望它们独立行动，您可以使用线程“同时执行两者”：

```
def list_eater(l):
    while l:
        yield l.pop(0)
def test3(num):
    data = []
    def producer():
        for i in gen(num): data.append(i)
    import threading
    consumerthread = threading.Thread(target=producer)
    consumerthread.start()
    while data or consumerthread.isAlive():
        for item in list_eater(data): process(item)
        # Optimizeable. Does idle waiting; a threading.Condition might be quite useful here... 
```

运行生产并消耗所有物品，因为它们在这里需要生产或消耗它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-29T09:38:38.800

使用`yield`或生成器大多与列表大小无关，例如：

*   如果您不需要处理整个列表并且可能很快就会中断，那么使用生成器会更有效。
*   模拟无限大小的流，例如素数生成器。

但是，如果您的内存有限，例如嵌入式系统，并且无法立即创建整个列表，则有必要使用生成器。

至于成本，使用生成器有额外的成本，如果你计算每次调用生成器时评估调用的成本，但是使用列表会占用更多内存，所以你不能一般说生成器是比列表更好，因为它涉及内存和性能之间的一些权衡，是否使用生成器取决于您的需求和情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-29T09:40:28.333

请注意，不能同时使用`yield`和`return`。函数可以是生成器函数或普通函数，但不能同时是两者。

通常`yield`避免创建中间列表，而是一个一个地产生元素。例如，当您递归地走一棵树时，这可能很有用。有关示例，请参见此链接：http: [//code.activestate.com/recipes/105873-walk-a-directory-tree-using-a-generator/](http://code.activestate.com/recipes/105873-walk-a-directory-tree-using-a-generator/)

生成器的另一种用途是当您想要返回大量元素，但您的用户可能只对前几个元素感兴趣（例如搜索结果）。

避免中间列表将节省内存，但前提是调用者不需要从结果中创建列表。一般来说，优点是它可以让你更简洁地编写你的生成器函数。

# iphone - 作为子视图访问时如何为uibutton设置图片

> ID：13622552
> 
> 赞同：0
> 
> 时间：2012-11-29T09:26:54.977
> 
> 标签：iphone, objective-c, ios, xcode, uiview

所以我在视图中有一个按钮，我知道如何访问它，但我不知道如何更改该按钮上的图片。这是我得到的：

```
for(UIView *button in [okvir subviews]){

        if([button isKindOfClass:[UIButton class]]){
                    UIImage *picture=[UIImage imageWithData:slika];
                    [button setImage:picture forState:UIControlStateNormal];
                }
            } 
```

但是，这会导致错误：

```
No visible @interface for 'UIView' declares the selector 'setImage:forState:' 
```

我猜那是因为按钮是 UIView 而不是 UIButton，知道该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:27:46.197

您需要转换指针，以便编译器将其识别为 a`UIButton`而不是 generic `UIView`。这是完全安全的，因为您正在检查指向对象的运行时类型，因此您可以确定它是`UIButton`.

用这个：

```
 [(UIButton*)button setImage:picture forState:UIControlStateNormal]; 
```

# javascript - 无法从 javascript 打印 BSON 对象

> ID：13622563
> 
> 赞同：18
> 
> 时间：2012-11-29T09:27:20.300
> 
> 标签：javascript, mongodb, find, bson

我的 mongoDB 集合如下所示：

```
{
    "_id" : ObjectId("5070310e0f3350482b00011d"),
    "emails" : [
            {
                    "_id" : ObjectId("5070310e0f3350482b000120"),
                    "_type" : "Email",
                    "name" : "work",
                    "email" : "peter.loescher@siemens.com",
                    "current" : true
            }
    ]
} 
```

这是`.js`我用来打印内容的代码：

```
c = db.contacts.findOne( { "emails.email" : { $ne : null } }, { "emails" : 1 } )

print(c._id.toString() + " " + c.emails[0]); 
```

当我尝试运行这个 javascript 文件时，它只显示 id 而不是电子邮件数组。

```
output:
5070310e0f3350482b00011d [object bson_object] 
```

但是当我尝试`c.emails[0].email`给出正确的结果时。IE`peter.loescher@siemens.com`

我只需要显示整个电子邮件嵌入对象。

```
i.e.
"emails" : [
        {
                "_id" : ObjectId("5070310e0f3350482b000120"),
                "_type" : "Email",
                "name" : "work",
                "email" : "peter.loescher@siemens.com",
                "current" : true
        }
] 
```

我哪里错了？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-29T09:40:13.320

您需要`printjson`输出格式良好的 JSON：

```
printjson(c.emails[0]); 
```

这是[文档](http://www.mongodb.org/display/DOCS/Scripting+the+shell#Scriptingtheshell-Printing)。

# wpf - 为什么stream.size总是比字符串的长度长

> ID：13622568
> 
> 赞同：0
> 
> 时间：2012-11-29T09:27:40.187
> 
> 标签：wpf, stream

我有一个文本块，里面有一些文本。当我将文本块中的字符串转换为流时，stream.size 总是比 textblock.text.length 长，为什么？总是多出 4 个字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:45:51.917

这是我的测试和结果：

在 XAML 中：

```
<TextBlock x:Name="txtbx" Text="Four" /> 
```

在 C# 中：

```
int txt = txtbx.Text.Length;
long streamLength = 0;
using (Stream test = new MemoryStream())
{
    test.Write(txtbx.Text.Select(t => (byte)(int)t).ToArray(), 0, txtbx.Text.Length);
    streamLength = test.Length;
}
// Result: txt = 4
//        streamLength = 4 
```

所以我的回答是：要么你有编码问题，要么你把流弄错了。如果我猜测一下，您将 Stream.Write 的最后两个参数弄乱了。

# php - 在 mysql 中使用 LIKE 获取自动完成列表

> ID：13622571
> 
> 赞同：0
> 
> 时间：2012-11-29T09:27:54.660
> 
> 标签：php, mysql

我正在使用 LIKE 子句来获取自动完成列表。当我使用

```
name LIKE '%value%' 
```

它给了我包含“值”的名称列表，但它没有正确显示这个列表，例如。当给出值“san”并且我在表中有“sanclose”但它没有在结果中显示这个值。所以我想可能我应该从前面删除 % 通配符。所以在删除前面的 % 通配符之后

```
name LIKE 'value%' 
```

现在它没有给我任何结果。我的专栏也有全文搜索索引。

请建议我是否遗漏了什么或有其他更好的方法来获得更好的结果？

提前致谢。

这是我正在尝试的完整 sql

```
SELECT z.zone_id, CONCAT(z.name,',',c.name) as zone FROM zone z LEFT JOIN country c ON z.country_id = c.country_id WHERE z.name LIKE 'span%' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:34:16.530

也许你应该试试`name LIKE '%value'`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:40:00.503

我不明白为什么 LIKE 表现得区分大小写，但下面的修改对我有用。

```
SELECT z.zone_id, CONCAT( z.name,  ',', c.name ) AS zone FROM zone z
LEFT JOIN country c ON z.country_id = c.country_id
WHERE LOWER( z.name ) LIKE  'san%' 
```

上面的查询给了我完美的结果。谢谢大家的帮助。

# java - 如何使 Java 对象在子 mxml 中对 Flex 中的主 mxml 文件可见？

> ID：13622573
> 
> 赞同：0
> 
> 时间：2012-11-29T09:27:59.000
> 
> 标签：java, apache-flex, flex4, blazeds

在我使用 Flex-Blazeds-java 的应用程序中...，在我的 Flex 应用程序端有两个 mxml 文件

1.  主.mxml
2.  登录.mxml

在 Main.mxml 文件中有一个名为`Login`单击此按钮的按钮打开一个`Login.mxml` 在此文件中调用的弹出窗口我有身份验证逻辑来​​连接 java...示例代码`

```
public var userService:UserService = new UserService();
[Bindable] public var userVO1:UserVO = new UserVO();
protected function loginUser(event:MouseEvent):void
{

var rpcAuthenticateUser:AsyncToken = userService.authenticateUser(userid_id.text, password_id.text);//Hear authenticateUser(-,-) is a java method it return UserVO object
rpcAuthenticateUser.addResponder(new mx.rpc.Responder(handler_success, handler_failure));

}
private function handler_failure(event:FaultEvent): void {
Alert.show("in handler_failure :" + event.message);

}

   private function handler_success(event:ResultEvent): void {
    userVO = event.result as UserVO;
     Alert.show("test "+userVO.loginId);
        } 
```

根据我的数据库逻辑听到登录工作完美，如果它是 ResultEvent，警报框显示正确的值（例如：loginId 是' `narasimham`'）......并且一切工作完美，在 Login.mxml 中没有默认值

```
Now The Problem Start... 
```

我想`UserVO`在 Main.mxml 文件中使用对象，所以我正在使用以下代码..

```
 public var loginUserVar:Login = new Login();
  protected function afterLoginUser(event:FlexEvent):void
   {
    Alert.show("LoginId ="+loginUserVar.userVO.loginId);        
   } 
```

实际上，我认为这个警报框提供了价值`narasimham`，但它正在提供`null`价值。

为什么它给出 Null 值？他们的任何 Scope 是否指定创建变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T12:39:58.490

在`handler_success`您需要设置的值，`userVO1`否则它将无法在您的 mxml 文件之外使用。您还需要在`afterLoginUser`as`userVO1`而不是`userVO`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T07:33:32.850

正确的 Ethrbunny 我没有存储 userVO 对象的值，因此它不可用于外部 mxml 文件....

这就是在 Login.mxml 文件中的 Flex(3.5) 应用程序中的方式，我正在添加以下代码...

```
Application.application.userVO = event.result as UserVO;
//Hear userVO is Object defined in Main.mxml file.... 
```

# jpa-2.0 - 要添加自定义实体侦听器，persistence.xml 文件的属性是什么？

> ID：13622577
> 
> 赞同：0
> 
> 时间：2012-11-29T09:28:28.017
> 
> 标签：jpa-2.0, eclipselink

我无法使用 Eclipselink 找到 persistence.xml 文件的属性来添加默认实体侦听器。仅适用于 orm.xml 文件的示例。

该属性是否存在于持久化单元配置文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T19:31:33.377

persistence.xml 中没有这样的属性。对于 EclipseLink 和其他 JPA 实现，它们在 orm.xml（或`mapping-file`元素 persistence.xml 引用的其他文件）中定义如下：

```
<persistence-unit-metadata>
  <persistence-unit-defaults>
    <entity-listeners>
      <entity-listener class="somepackage.YourListener">
        <pre-persist method-name="method1"/>
        <post-persist method-name="method2"/>
        <pre-remove method-name="method3"/>
        <post-remove method-name="method4"/>
        <pre-update method-name="method5"/>
        <post-update method-name="method6"/>
        <post-load method-name="method7"/>
      </entity-listener>
      <entity-listener class="other">
        <pre-persist method-name="someMethod"/>            
      </entity-listener>
    </entity-listeners>
  </persistence-unit-defaults>
</persistence-unit-metadata> 
```

# android - 操作栏列表弹出选择器被忽略

> ID：13622579
> 
> 赞同：0
> 
> 时间：2012-11-29T09:28:35.177
> 
> 标签：android, android-actionbar, actionbarsherlock

在 android 上，当我在列表模式下使用操作栏时，微调器的 dropDownSelector 将被忽略。

我使用了一个覆盖 actionDropDownStyle 属性并设置自定义 dropDownSelector 的主题，但仍显示默认值。应用了我以相同样式定义的自定义背景。

如何自定义操作栏微调器的选择器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:56:54.043

这似乎是一个平台错误：[https ://code.google.com/p/android/issues/detail?id=24922](https://code.google.com/p/android/issues/detail?id=24922)

在 android:dropDownListViewStyle 中设置 android:listSelector 来自定义 (= every) 选择器。

# php - Preg 用数组中的单词替换

> ID：13622580
> 
> 赞同：2
> 
> 时间：2012-11-29T09:28:36.230
> 
> 标签：php, regex

我有一组必须从字符串中替换的单词，我们称之为`$my_replacements`. 我还有一个字符串，我们称之为它`$my_string`，它可以包含其中的一些值。

现在我有这个：

```
foreach ($my_replacements as $replacement) {
    $replaced_value = preg_replace("/(^|[\n\r\f\t \.\,])" . $replacement . "([\n\r\f\t \.\,]|$)/iu", '', $my_string);
    if($replaced_value !== $my_string) {
       break;
    }
} 
```

如果在第一次替换时我想退出 foreach，这很好。但是，如果字符串包含一个或多个要替换的值，它将不起作用。如何使用 preg_replace 查找这些单词并将它们全部替换？重要的是我知道是否已经完成了任何替换。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:33:43.353

您可以将索引数组与`preg_replace()`.

```
<?php
$string = 'The quick brown fox jumped over the lazy dog.';
$patterns = array();
$patterns[0] = '/quick/';
$patterns[1] = '/brown/';
$patterns[2] = '/fox/';
$replacements = array();
$replacements[0] = 'slow';
$replacements[1] = 'black';
$replacements[2] = 'bear';
echo preg_replace($patterns, $replacements, $string);
?> 
```

上面的示例将输出：

```
The slow black bear jumped over the lazy dog. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:45:18.940

```
$word              = array("test","test1");
$search_string     = "(".implode("|",$word).")";
$value             = preg_replace("/$search_string\s+\S+)/i","$1",$text); 
```

尝试这个..

# drupal - 如何使用 DRUPAL 从分类法创建页面内容

> ID：13622582
> 
> 赞同：0
> 
> 时间：2012-11-29T09:28:42.337
> 
> 标签：drupal, drupal-7, drupal-views

我是使用 Drupal 的新手，我有疑问。

我有一个类别，里面有一些类别：具有子类别（书籍、报纸、信件）的服务（主类别）。

每个子类别都有一个图像、一个标题和一个简短的描述。我创建了一个名为**Services**的分类，并将子类别添加为术语。（我不知道这是否是这样做的正确方法。任何建议都将被接受并感谢）。

现在我想在主页上显示如下内容：

![我想展示的](../Images/d34554fc2f7f7cec09a85374c188cd3d.png)

所以，我想在我的主页上显示我的子类别的网格视图，其中包含图像和标题，当我单击它时，转到子类别并显示其内容。

抱歉没有更具体，但我真的很新...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T10:25:05.593

如果我理解正确，您的词汇表如下所示：

```
[Category]
- Sub-category 1
 - term 1
 - term 2
- Sub-category 2
 - term 3
 - term 4
- Sub-category 3
 - term 5
etc. 
```

在创建术语时，您还可以为每个子类别术语添加描述。

因此，要仅输出一级术语（子类别），您应该使用[Views](http://drupal.org/project/views)模块创建一个页面/块。

在创建新视图时，请注意`Show: Taxonomy terms`在“添加新视图”表单上方进行选择并选择您的词汇表。

然后，为了只输出 1 级术语，您应该添加关系 - 按 Advanced/Relationships 并选择`Taxonomy term: Parent term`。然后添加新的`Filter criteria`-`Taxonomy term: Parent term`设置`Relationship`为`Parent`并`Operator`设置为`Is empty (NULL)`

要添加描述，只需添加新字段 - `Taxonomy term: Term description`。

所有其他自定义（将标题包装在标签中，将字段输出为表格/网格等）也可以在视图中使用。

到目前为止，我还没有尝试向术语添加 img，但我想有办法做到这一点：通过 CSS（通过添加 'background:' 属性）或使用一些模块，例如[Taxonomy Image](http://drupal.org/project/taxonomy_image)。

附言

如果重要的话，以上都是关于 Drupal 7 的，我不确定它是否适用于 Drupal 6。

# symfony - Symfony2中的分组复选框

> ID：13622586
> 
> 赞同：6
> 
> 时间：2012-11-29T09:29:04.570
> 
> 标签：symfony, symfony-forms

Symfony2 Form 组件似乎无法处理这种常见情况。下面是**我**在我的 html 中想要的

![在此处输入图像描述](../Images/e017d315449fd19384964c20efa784d2.png)

代码如下所示：

```
 ->add('code', 'choice', array(
            'choices' => array(
                'Food'  => array('pizza', 'burger', 'icecream'),
                'Music' => array('poney', 'little', 'pocket'),
            ),
            'multiple' => true,
            'expanded' => true,
            'required' => true
        )); 
```

这实际上给出了错误的输出：

![在此处输入图像描述](../Images/e9e92f40c8294c0e350f6a825eae3857.png)

这很奇怪，因为案例`expanded => false`处理得当

![在此处输入图像描述](../Images/372d8ca5479f94e1f22e00f27df23db7.png)

请问这种情况怎么处理？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T10:11:27.770

好的，这是 form_theme 解决方案

```
{% block _user_code_widget %}
    <div {{ block('widget_container_attributes') }}>
        {% for name, choices in form.vars.choices %}
            <ul>
                <li class="checkbox_category">
                    <input type="checkbox" class="checkallsub" /> {{ name }}
                </li>

                {% for key,choice in choices %}
                    <li class="indent">
                        {{ form_widget(form[key]) }}
                        {{ form_label(form[key]) }}
                    </li>
                {% endfor %}
            </ul>
        {% endfor %}
    </div>
{% endblock %} 
```

当然缺少额外的 js 层，但你明白了。

# javascript - 获取具有 oveflow:hidden 样式的 div 的内容高度

> ID：13622589
> 
> 赞同：0
> 
> 时间：2012-11-29T09:29:11.987
> 
> 标签：javascript, jquery

我正在为 jquery 设计一个垂直滚动条插件。我的插件接受**高度**值作为选项，如果 div 高度超过给定高度，滚动条将可见。现在的问题是我需要获取 div 内容的真实高度。

```
 <div id="scroll">
     Contents Here
    </div> 
```

jQuery：

```
 $.fn.vscrollbar = function (options) {
    .
    .
    .
    var contentHeight=this.contents().height() //that is not working correctly
    if(contentHeight > options.height){
    this.css({overflow : 'hidden'}).height(options.height); 
    }
    .
    .
    .
    })(jQuery); 
```

我可以在应用“溢出：隐藏”之前获得 div 的高度，但问题是我希望它能够工作，即使它从一开始就有溢出：隐藏样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:32:41.433

您应该`div`在页面上有一个隐藏的，相同`width`但`overflow auto`. 调用/实例化您的插件后，立即获取隐藏的高度`div`并执行您想要的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:37:39.433

我知道应该工作的一种方法是在溢出内有一个内容元素并获取它的高度，因为它应该保留其高度值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:38:17.177

.css() 方法应该可以工作

```
$(this).css('height'); 
```

# java - 在表达式中使用 for 循环

> ID：13622591
> 
> 赞同：0
> 
> 时间：2012-11-29T09:29:15.397
> 
> 标签：java, el

我需要使用`Java EL`. 请注意，这不是在 中`JSP/Web context`，而是在独立的 Java 客户端（使用`juel-2.2.4.jar`）中。表达式的形式为：

```
${for(int i=1; i<Employees.length; i++){Employee[i].Name + "--" }} 
```

我已经有一个`ELResolver`理解`Employee`对象的习惯。我期望的输出是`String`所有员工的姓名，中间有分隔符。

这在独立的`Java EL`应用程序中是否可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:31:40.010

```
String allName="";
for(int i=1; i<Employees.length; i++){
allName+=Employee[i].Name + "--" 
} 
```

最后`allName`包含串联的名称。当您从 i=1 开始时，请确保您没有遗漏第一个员工的姓名；

您在评论中问的内容不能直接写出符合您要求的内容。尽管您可以执行以下操作；

```
public String getConcatenatedString(String property){
String allName="";
    for(int i=1; i<Employees.length; i++){
     if(property.equals("name")) 
     allName+=Employee[i].Name + "--";
     else if(property.equals("designation"))
      allName+=Employee[i].designation + "--"; 
    }
return allName;
} 
```

您将使用名称或属性调用该方法。您将获得连接的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:35:53.593

您可以使用以下代码：

```
StringBuffer allEmployeeName= new StringBuffer();
for(int i=1; i<Employees.length; i++){
   allEmployeeName += Employee[i].Name + "--" 
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T10:03:52.780

您可能必须创建一个辅助函数，afaik，java 无法使用开箱即用的表达式来处理这个问题。

```
${Employee.joinEmployeesByName(Employees, "--")} 
```

类中的代码`Employee`：

```
public static String joinEmployeesByName( Employee[] arr, String separator ) {
    //implement
} 
```

这是使用反射的动态示例：

```
public static String getFieldByName(Employee obj, String fieldName) {
    String ret = null;
    Class<?> c = obj.getClass();
    try {
        Field field = c.getDeclaredField(fieldName);
        ret = field.get(obj).toString();
    } catch (NoSuchFieldException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    }
    return ret;
}

public static String joinEmployeesByField(Employee[] arr, String fieldName, String separator) {
    if(arr.length < 1) {
        return "";
    }
    StringBuilder ret = new StringBuilder();
    ret.append(getFieldByName(arr[0], fieldName));
    for( int i = 1; i < arr.length; ++i ) {
        ret.append( separator );
        ret.append( getFieldByName( arr[i], fieldName) );
    }
    return ret.toString();
} 
```

用法是：

```
${Employee.joinEmployeesByField(Employees, "Name", "--")}
${Employee.joinEmployeesByField(Employees, "Designation", "--")} 
```

# javascript - HTML5 Canvas 两次调用相同的函数？

> ID：13622599
> 
> 赞同：1
> 
> 时间：2012-11-29T09:29:47.807
> 
> 标签：javascript, html, function, canvas

我在这里变得非常困惑，尽管我对 HTML 5 画布很陌生。

基本上我有这个功能：

```
function drawcircle(x,y)
{
    context.save();
    context.strokeStyle = '#00ff00';
    context.fillStyle = '#000000';
    context.lineWidth=10;
    context.beginPath();
    context.arc(x,y,50,0,Math.PI * 2,false)
    context.stroke();
    context.fill();
    context.endPath();
    context.restore();
} 
```

然后我尝试像这样调用它两次：

```
 // call the initialise and draw functions
initialise();
drawcircle(100, 100);
drawcircle(100, 200); 
```

但是，它似乎只会绘制第一个圆圈，无论绘制第一个圆圈而不是第二个圆圈的顺序如何，我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:32:43.470

应该是`closePath()`，不是`endPath()`，您的函数之前会出错，`.restore()`因此它永远不会被调用，并且第二次调用将发生前一次调用留下的状态。

```
function drawcircle(x,y)
{
    context.save();
    context.strokeStyle = '#00ff00';
    context.fillStyle = '#000000';
    context.lineWidth=10;
    context.beginPath();
    context.arc(x,y,50,0,Math.PI * 2,false)
    context.stroke();
    context.fill();
    context.closePath(); //Changed
    context.restore();
} 
```

[http://jsfiddle.net/kwHT5​​/](http://jsfiddle.net/kwHT5/)

您应该始终检查 javascript 控制台是否有错误。

# php - 如何获取特定用户的最后 7 个投注单 (BetSlipID)

> ID：13622603
> 
> 赞同：1
> 
> 时间：2012-11-29T09:29:57.580
> 
> 标签：php, mysql, sql

我当前的代码显示最近 7 天的投注单，但无论日期如何，我都需要显示最近 7 个投注单。

```
select 
  betsliphistory.MatchID,Team1.Name as HomeTeam ,
  Team2.Name as AwayTeam, BetSlipID , userid , TipID , 
  matches.ResultTipID ,betsliphistory.`Date`
from betsliphistory
inner join matches on betsliphistory.MatchID = matches.MatchID
inner join teams as Team1 on matches.HomeTeamID = Team1.TeamID
inner join teams as Team2 on matches.AwayTeamID = Team2.TeamID
where userid =".$user." 
  and betsliphistory.`Date` between CURDATE()-7 and CURDATE() 
order by BetSlipID , MatchID; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:31:47.937

> 但无论日期如何，我都需要出示最近 7 次投注单。

*   `WHERE`从子句中删除日期条件。
*   将`ORDER By BetSlipID DESC`with`LIMIT 7`用于前 7 名`BetSlipID`，如下所示：

    ```
     ... -- Your current query
     WHERE userid = ".$user." 
     ORDER BetSlipID  DESC
     LIMIT 7; 
    ```

**请注意：**您的代码以这种方式容易受到[**SQL Injection**](http://en.wikipedia.org/wiki/SQL_injection)的攻击。请改用 PDO 或准备好的语句。有关更多详细信息，请参见：

*   [**PHP：防止 SQL 注入的最佳方法？**](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:32:17.720

试试这个：：

```
 select betsliphistory.MatchID,Team1.Name as HomeTeam , 
                      Team2.Name as AwayTeam, BetSlipID , userid , TipID , matches.ResultTipID ,betsliphistory.`Date`
                      from betsliphistory
                      inner join matches on betsliphistory.MatchID = matches.MatchID
                      inner join teams as Team1 on matches.HomeTeamID = Team1.TeamID
                      inner join teams as Team2 on matches.AwayTeamID = Team2.TeamID
                      inner join (Select DISTINCT(BetSlipID) tempBetSlip from betsliphistory where userid =".$user."  order by `Date` limit 7) temp_betHistory on temp_betHistory.tempBetSlip = BetSlipID
                          where userid =".$user." order by `BetSlipID` 
```

# javascript - 再次调用调用者函数

> ID：13622606
> 
> 赞同：1
> 
> 时间：2012-11-29T09:30:04.600
> 
> 标签：javascript

我正在通过

```
arguments.callee.caller 
```

但是如果我想再次调用调用者函数，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:38:19.067

只需再次调用该函数。

```
arguments.callee.caller() 
```

例子：

```
function A(){
    B();
}
function B(){
    arguments.callee.caller(); // It will call the A again.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:39:10.213

函数里面`arguments.callee.caller`是对调用者函数的引用，其实`typeof arguments.callee.caller === 'function'`这样就可以直接调用了：

```
arguments.callee.caller(arg1, arg2, arg3, [...]); 
```

或者你可以这样做：

```
arguments.callee.caller.call(context, arg1, arg2, arg3, [...]); 
```

或这个：

```
arguments.callee.caller.apply(context, [arg1, arg2, arg3, [...]]); 
```

正如其他人所说，请注意性能问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:34:01.560

我的第一个提示是：

```
var nm = arguments.callee.caller.name 
```

然后调用“nm”。使用 eval 或一些 switch-cases。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:46:48.123

你应该喜欢 Function.caller 而不是 arguments.callee.caller （尤其是因为人们无法决定这是否被弃用）

[为什么 JavaScript 中不推荐使用 arguments.callee.caller 属性？](https://stackoverflow.com/questions/103598/why-was-the-arguments-callee-caller-property-deprecated-in-javascript)

举例说明用法：

```
var i = 0;

function foo () {
    bar();
}

function bar() {
    if ( i < 10 ) {
        i += 1;
        bar.caller();
    }
}

foo();

// Logs 10
console.log(i); 
```

尽管在现实世界中，您可能希望在调用它之前检查调用者是一个函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T09:40:44.080

注意无限循环：

```
// The 'callee'
function f(arg) { 
   var cf = arguments.callee.caller; 
   cf.call(42); 
}

// .. and the caller
function g(arg) {
   if (arg === 42) {
      alert("The Answer to..");
   } else {
      f(1); // or whatever
   }
}

// call the caller
g(21) 
```

# ssl - TLS v1.0 中的客户端完成消息

> ID：13622607
> 
> 赞同：0
> 
> 时间：2012-11-29T09:30:07.900
> 
> 标签：ssl

JKJS

“客户端完成的消息是所有握手消息的加密”。

但不清楚：

1）它是否只包含客户端发送的握手消息？
2）它是否只包含从服务器收到的握手消息？
3）或者它是否包含以上两者？
4）握手消息是否包含“更改密码规范”消息？

请帮我。

JKJS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:42:18.123

Finished Message 将包含从服务器和客户端发送的握手消息。它不包含更改密码规范消息，因为它不被视为握手消息的一部分。

RFC 2246 中的以下段落很好地解释了这一点：

> 服务器发送的已完成消息中包含的哈希包含 Sender.server；客户端发送的那些包含 Sender.client。值 handshake_messages 包括从客户端问候开始的所有握手消息，但不包括此完成的消息。这可能与第 7.4.8 节中的 handshake_messages 不同，因为它将包括证书验证消息（如果已发送）。此外，客户端发送的已完成消息的握手消息将与服务器发送的已完成消息的握手消息不同，因为第二个发送的消息将包括前一个消息。
> 
> > **注意：**更改密码规范消息、警报和任何其他记录类型都不是握手消息，也不包含在哈希计算中。此外，握手散列中省略了 Hello Request 消息。

# c# - is-operator 有什么好的用法

> ID：13622610
> 
> 赞同：15
> 
> 时间：2012-11-29T09:30:20.557
> 
> 标签：c#

is-operator有什么*好的用法？*

下面的强制转换构造不是推荐的方法，几乎​​所有文档都更喜欢带有空检查的 as-operator。

```
if(obj is SomeClass)
{
  SomeClass some = (SomeClass)obj;
  ....
} 
```

当然，这是一个（非常小的）性能提升，有些人甚至提到了胎面安全性。是的，这是真的……

那么，为什么我们有 is-operator 呢？
“带有空检查的操作员”在哪里不起作用或不是要走的路？
is 是否具有限制使用 is-operator 获得的声明范围的优势？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T09:32:56.317

`as`不适用于不可为空`struct`的 s：

```
object o = 123;
int i = o as int; // compile error 
```

然而：

```
object o = 123;
if(o is int) {
    int i = (int)o;
    //...
} 
```

当然，从 2.0 开始你也可以使用：

```
int? i = o as int?; 
```

并`null`像往常一样测试。

还有一种情况是你不关心对象的值......你只需要知道它是什么*：*

```
if(obj is Something)
    throw new InvalidOperationException("Seriously, don't do that");
// phew! dodged a bullet; we're ok here... 
```

请注意，这`GetType()`不适合此操作，因为您不想手动考虑子类、接口等。

# html - 如何使用 Bootstrap 在一行中对齐控件

> ID：13622614
> 
> 赞同：3
> 
> 时间：2012-11-29T09:30:22.253
> 
> 标签：html, twitter-bootstrap

我正在尝试使用 bootstrap class = "form-inline" 将几个控件对齐在一行中，但它似乎无法正常工作。我究竟做错了什么？

目前我在两行中得到结果。我希望它们显示在一行中

我正在使用的代码如下

```
<div class="form-inline">
    <i class="icon-list-alt"></i>
    <label class="control-label">
        Please enter TB Id or TBR Id</label>
    <div class="form-search">
        <div class="input-append">
            <input id="inputValue" type="text" class="span2 search-query" />
            <div class="btn-group">
                <button class="btn dropdown-toggle" data-toggle="dropdown">
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                    <li><a id="POA" tabindex="-1" href="#">1</a></li>
                    <li><a id="MOD" tabindex="-1" href="#">2</a></li>
                    <li><a id="LC" tabindex="-1" href="#">3</a></li>
                </ul>
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:14:54.470

检查此代码，希望对您有所帮助：

```
<div class="form-inline">
    <i class="icon-list-alt"></i>
    <label class="control-label">
        Please enter TB Id or TBR Id</label>
    <span class="form-search">
        <div class="input-append">
            <input id="inputValue" type="text" class="span2 search-query" />
            <div class="btn-group">
                <button class="btn dropdown-toggle" data-toggle="dropdown">
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                    <li><a id="POA" tabindex="-1" href="#">1</a></li>
                    <li><a id="MOD" tabindex="-1" href="#">2</a></li>
                    <li><a id="LC" tabindex="-1" href="#">3</a></li>
                </ul>
            </div>
        </div>
    </span>
</div> 
```

# visual-studio-2010 - 在 VS2010 中使用 Ctrl-Tab 切换文档需要返回

> ID：13622618
> 
> 赞同：2
> 
> 时间：2012-11-29T09:30:29.580
> 
> 标签：visual-studio-2010, visual-studio-extensions

在 VS2010 中使用 Ctrl-Tab 在文档之间切换时，文档切换窗口不会消失，直到我多次按下 Tab 选择一个条目然后按回车键。我*确定*它以前不需要返回：只要您按住 Ctrl 并释放它就会切换到当前选定的文档，该窗口只会保持不变。如果您只想快速按 ctrl-tab 转到最后一个文档，这真的很烦人。

我确实安装了一些扩展，包括 Productivity Power Tools、Power Commands 和 VSVim，并且我还安装了一些用于调查可访问性的工具（平台 SDK 中的 NVDA、UIA Verifier），因此其中一个可能有以某种方式改变了选项。

所以，我的问题是：

1.  VS2010的默认行为是文档切换窗口仅在按住Ctrl键时起作用，还是我的内存有问题？
2.  如果默认行为是我记得的，我该如何恢复呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:53:05.363

我认为这是一个处于半启用状态的可访问性设置。在 Windows 辅助功能设置中，我多次切换了粘滞键的状态，现在它又可以正常工作了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-05T06:50:46.827

这刚刚发生在我身上，经过一番谷歌搜索后，我找到[了解决方案](http://andyclymer.blogspot.de/2010/02/visual-studio-ctrltab-sticking.html)：它确实是我偶尔按`Win`+启动的放大镜应用程序`Grey Plus`。一旦我关闭它，Visual Studio 就可以正常工作而无需重新启动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:36:36.127

关于第 2 点。转到工具：导入和导出设置。然后，您可以选择再次重置默认环境设置。

还要确保它不是提供与您期望不同的功能的“加载项”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-10T08:26:01.687

与 VS2012 的行为相同：当放大镜应用程序打开时（例如，通过按 Windows 徽标键‌ +“+”（加号））即使放大率设置为 100%，也会发生此行为。

# java - 在特定代码后在 Android 上获取电池电量

> ID：13622620
> 
> 赞同：1
> 
> 时间：2012-11-29T09:30:34.040
> 
> 标签：java, android, android-intent

我正在尝试在某个代码后更换电池。我正在使用以下代码，但不幸的是没有运气。我得到零任何想法请

在上创建一个：

```
batteryIntent = registerReceiver(null,new IntentFilter(Intent.ACTION_BATTERY_CHANGED));

private double batteryLevel() {
   int rawlevel = batteryIntent.getIntExtra("level", -1);
   double scale = batteryIntent.getIntExtra("scale", -1);
   double level = -1;
   if (rawlevel >= 0 && scale > 0) {
       level = rawlevel / scale;

   }
return level;

 } 
```

在 onClick 上：

```
double startbatterylevel = batteryLevel();

//certain code

double estimatedbattery  =  startbatterylevel -  endbatterylevel ;
Estbatterylevel.setText("estimated battery"+estimatedbattery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:35:12.157

看到我发现一些链接会帮助你

[http://developer.android.com/training/monitoring-device-state/battery-monitoring.html](http://developer.android.com/training/monitoring-device-state/battery-monitoring.html)

[http://www.techrepublic.com/blog/app-builder/androids-batterymanager-and-progressbar-two-for-one-tutorial/703](http://www.techrepublic.com/blog/app-builder/androids-batterymanager-and-progressbar-two-for-one-tutorial/703)

[在 Android 中获取电池电量和状态](https://stackoverflow.com/questions/3291655/get-battery-level-and-state-in-android)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T09:56:15.437

如您所写，我们不知道问题出在电池电量检测方法还是减法上。该方法的输出是什么`batteryLevel();`？它是准确的还是始终是默认值？

您可以尝试调整此页面上的示例：http: [//mobiledevtuts.com/android/android-sdk-get-device-battery-information/](http://mobiledevtuts.com/android/android-sdk-get-device-battery-information/)

```
public void onCreate(Bundle savedInstanceState) {
    ...
    this.registerReceiver(this.batteryInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    ...
}

private BroadcastReceiver batteryInfoReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        int level = intent.getIntExtra(BatteryManager.EXTRA_LEVEL, 0);
        Estbatterylevel.setText("estimated battery" + level);
    }
}; 
```

如果仍然显示 0，则可能存在兼容性问题。你能提供你的设备规格和安卓版本吗？

# c# - C++ 中的客户端，C# 中的服务器

> ID：13622626
> 
> 赞同：2
> 
> 时间：2012-11-29T09:31:04.803
> 
> 标签：c#, c++, client, client-server

我正在创建一个 MMO 游戏。我将使用 TCP 客户端/服务器通信。起初我的方法是用 C++ 编写客户端和服务器，但现在我开始考虑用 C# 编写服务器是否更容易。

客户端将用 C++ 编写，因为它需要跨平台，但服务器将始终在 Windows 系统上。我考虑选择 C#，因为它具有更简单的处理线程、内置 XML 解析器等的方法。

我的问题是这是否是一个好的解决方案？性能对我来说仍然很重要，所以如果选择 C# 而不是 C++ 会对性能产生巨大影响，我会坚持使用 C++。

另外，如果您认为这是个好主意，您是否知道是否有任何教程介绍了 C# 服务器和 C++ 客户端之间的通信？

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:35:00.577

C++ 和 C# 之间的性能差异并不像您想象的那么大。

对于通信，如果您对性能感到困扰，请使用套接字和[Google Protocol Buffers](https://developers.google.com/protocol-buffers/)或[Thrift](http://thrift.apache.org/)之类的东西。如果您不太关心性能，请使用 HTTP 和 JSON 或 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:35:37.403

为客户端和服务器使用不同的语言会迫使你用不同的语言重写很多东西，我个人希望保持同步：

*   序列化和反序列化，尽管您当然可以为此使用一些库。我想到了 Google Protocol Buffers，因为它们明确设计用于节省带宽和“跨语言”工作。
*   几乎游戏中的每个实体都会有一组或多或少的共同属性。当使用不同的语言时，您必须手动保持这些同步，并且可能会编写两次。这对于更复杂的设置器尤其烦人；）
*   您将需要一些共享逻辑来“模拟”客户端上的服务器答案。在客户端预测服务器为获得“快速”行为所做的事情很重要。还有什么可以比为服务器和客户端使用相同的代码库更好地模拟这种行为？

不过，在服务器上使用 C# 时，我不会看到很大的性能问题。这不应该是强烈影响您的决定的一个方面。

# php - php中的openssl命令

> ID：13622630
> 
> 赞同：2
> 
> 时间：2012-11-29T09:31:07.173
> 
> 标签：php, openssl, x509certificate

我想生成`example.com.crt`和`example.com.pem`使用 php。获取文件的 Linux 命令如下：

```
openssl req -newkey rsa:2048 -new -x509 -days 3652 -nodes 
            -out example.com.crt -keyout example.com.pem 
```

我想在 php.ini 中获取两个字符串中的两个文件内容。这个的 php 等效代码是什么？

更新：请不要要求执行 Linux 命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-23T09:09:13.210

这里有另一个命令：

```
<?php 
// generate 2048-bit RSA key
$pkGenerate = openssl_pkey_new(array(
    'private_key_bits' => 2048,
    'private_key_type' => OPENSSL_KEYTYPE_RSA
));

// get the private key
openssl_pkey_export($pkGenerate,$pkGeneratePrivate); // NOTE: second argument is passed by reference

// get the public key
$pkGenerateDetails = openssl_pkey_get_details($pkGenerate);
$pkGeneratePublic = $pkGenerateDetails['key'];

// free resources
openssl_pkey_free($pkGenerate);

// fetch/import public key from PEM formatted string
// remember $pkGeneratePrivate now is PEM formatted...
// this is an alternative method from the public retrieval in previous
$pkImport = openssl_pkey_get_private($pkGeneratePrivate); // import
$pkImportDetails = openssl_pkey_get_details($pkImport); // same as getting the public key in previous
$pkImportPublic = $pkImportDetails['key'];
openssl_pkey_free($pkImport); // clean up

// let's see 'em
echo "\n".$pkGeneratePrivate
    ."\n".$pkGeneratePublic
    ."\n".$pkImportPublic
    ."\n".'Public keys are '.(strcmp($pkGeneratePublic,$pkImportPublic)?'different':'identical').'.';
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T16:04:09.573

您可以使用[phpseclib，一个纯 PHP X.509 实现](http://phpseclib.sourceforge.net)：

[http://phpseclib.sourceforge.net/x509/examples.html#selfsigned](http://phpseclib.sourceforge.net/x509/examples.html#selfsigned)

```
<?php
include('File/X509.php');
include('Crypt/RSA.php');

// create private key / x.509 cert for stunnel / website
$privKey = new Crypt_RSA();
extract($privKey->createKey());
$privKey->loadKey($privatekey);

$pubKey = new Crypt_RSA();
$pubKey->loadKey($publickey);
$pubKey->setPublicKey();

$subject = new File_X509();
$subject->setDNProp('id-at-organizationName', 'phpseclib demo cert');
//$subject->removeDNProp('id-at-organizationName');
$subject->setPublicKey($pubKey);

$issuer = new File_X509();
$issuer->setPrivateKey($privKey);
$issuer->setDN($subject->getDN());

$x509 = new File_X509();
//$x509->setStartDate('-1 month'); // default: now
//$x509->setEndDate('+1 year'); // default: +1 year

$result = $x509->sign($issuer, $subject);
echo "the stunnel.pem contents are as follows:\r\n\r\n";
echo $privKey->getPrivateKey();
echo "\r\n";
echo $x509->saveX509($result);
echo "\r\n";
?> 
```

这将创建一个私钥和一个自签名 X.509 证书（如您的 CLI 示例所做的那样），其中私钥对应于公钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:46:26.720

[使用exec()](http://www.php.net/manual/en/function.exec.php)或[system()](http://www.php.net/system)函数执行命令，然后使用[file_get_contents()](http://www.php.net/file_get_contents)读取输出文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:47:46.117

PHP有OpenSSL扩展，你应该检查它是否对你来说还不够，因为它会更好地使用它而不是`exec()`：

[http://php.net/manual/en/book.openssl.php](http://php.net/manual/en/book.openssl.php)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-29T09:46:13.590

也许这不是最好的解决方案，但您可以使用 exec() 和 file_get_contents()，例如：

```
exec("openssl req -newkey rsa:2048 -new -x509 -days 3652 -nodes -out example.com.crt -keyout example.com.pem");
$crtFile = file_get_contents("example.com.crt");
$pemFile = file_get_contents("example.com.pem"); 
```

请注意文件权限和明显的文件路径。如果您围绕这些命令添加一些错误处理，那就更好了。

阅读更多： http: [//php.net/manual/en/function.exec.php](http://php.net/manual/en/function.exec.php)

并且： http: [//php.net/manual/en/function.file-get-contents.php](http://php.net/manual/en/function.file-get-contents.php)

# pdf - 恢复PDF中的图形状态后是否可以为路径绘制笔画？

> ID：13622632
> 
> 赞同：3
> 
> 时间：2012-11-29T09:31:14.740
> 
> 标签：pdf

我在 PDF 中画线，我想以 1:1 以外的比例缩放。

问题是我得到的笔触看起来像是用书法笔绘制的。

是否可以在 PDF 中以某种方式调整路径大小，恢复图形状态，然后绘制上一个路径的笔划。

这就是我在 PDF 中获得书法线条笔触的方式：

```
5 w               // width of stroke
q                 // saves the current graphics state 
0 1 0 0.2 0 0 cm  // transformation matrix scaling with height reduced to 20%
0 10 m            // Start of line
10 10 l           // line to
20 100 l
30 100 l
40 10 l
S                 // draws stroke
Q                 // Restores graphics state 
```

在 HTML5 画布中，可以在恢复图形状态后绘制笔触，以便用等宽的线绘制路径。

[http://www.html5canvastutorials.com/advanced/html5-canvas-ovals/](http://www.html5canvastutorials.com/advanced/html5-canvas-ovals/)

在 PDF 中将 S 放在 Q 之后不起作用。

有没有办法在 PDF 中获得相同的结果，其中只有线条路径被缩放，而不是笔划本身？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T10:32:44.437

[查看 PDF 规范ISO 32000-1:2008](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/PDF32000_2008.pdf)第 113 页的图 9 - 图形对象。它说明一旦您开始构建路径，唯一允许的运算符是用于路径构建、路径剪切和路径绘制的运算符。**Q**作为一个特殊的图形状态操作符只允许在路径绘制操作符之后，例如你的**S**。

这也在图形正下方的示例中说明：

> 路径构造运算符**m**和**re**表示路径对象的开始。在路径对象内部，允许使用额外的路径构造操作符，剪裁路径操作符**W**和 **W***也是如此，但不包括一般的图形状态操作符，例如**w**或**J。**路径绘制运算符（例如**S**或**f**）结束路径对象并返回到页面描述级别。

因此，响应“是否有某种方法可以在 PDF 中获得相同的结果，其中只有线条路径被缩放，而不是笔划本身？”：不，您必须明确选择较小的笔划宽度以补偿由转换矩阵。

![ISO 32000-1:2008 的第 113 页显示了图 9 - 图形对象](../Images/ea5225bd65fcb80b320eb015682a59f5.png)

# unix - 在unix文件中查找字符串的快速方法

> ID：13622645
> 
> 赞同：13
> 
> 时间：2012-11-29T09:32:01.220
> 
> 标签：unix

我想在 unix 的文件中查找字符串模式。我使用以下命令：

```
$grep 2005057488 filename 
```

但是文件包含数百万行，我有很多这样的文件。除了grep之外，什么是最快的获取模式的方法。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-29T12:38:59.390

`grep`通常是尽可能快。它是为一件事和一件事而设计的——它做得很好。[你可以在这里](https://stackoverflow.com/questions/12629749/how-does-grep-run-so-fast)阅读为什么。

但是，为了加快速度，您可以尝试几件事。首先，看起来您正在寻找的模式是一个固定的字符串。幸运的是，`grep`有一个“固定字符串”选项：

```
-F, --fixed-strings
       Interpret PATTERN as a list of fixed strings, separated by newlines, any of which is to be matched. (-F is specified by POSIX.) 
```

其次，因为`grep`通常在 上很慢`UTF-8`，您可以尝试通过设置 environment 来禁用国家语言支持（NLS）`LANG=C`。因此，您可以尝试这种混合物：

```
LANG=C grep -F "2005057488" file 
```

第三，您的问题并不清楚，但如果您只尝试查找文件中是否存在一次，您也可以尝试添加最大次数来查找模式。因此， when `-m 1`,`grep`将在找到第一个匹配项后立即退出。您的命令现在可能如下所示：

```
LANG=C grep -m 1 -F "2005057488" file 
```

最后，如果你有一个多核 CPU，你可以试试[GNU 并行](http://www.gnu.org/software/parallel/)。它甚至附带了[如何与 grep 一起使用它的说明](http://www.gnu.org/software/parallel/man.html#example__parallel_grep)。每个核心运行 1.5 个作业并给 1000 个参数`grep`：

```
find . -type f | parallel -k -j150% -n 1000 -m grep -H -n STRING {} 
```

`grep`并行使用的大`--pipe`文件：

```
< bigfile parallel --pipe grep STRING 
```

根据您的磁盘和 CPU，读取更大的块可能会更快：

```
< bigfile parallel --pipe --block 10M grep STRING 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-21T05:58:47.913

grep 的工作速度比 sed 快。

```
$grep 2005057488 filename
$sed -n '/2005057488/p' filename 
```

仍然两者都可以在文件中获取特定的字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:58:26.620

```
sed -n '/2005057488/p' filename 
```

不确定这是否比 grep 快。

# joomla - 为什么 Joomla 2.5.3 说“Joomla！是最新的”

> ID：13622646
> 
> 赞同：0
> 
> 时间：2012-11-29T09:32:03.210
> 
> 标签：joomla, themes, joomla2.5

我有 Joomla 2.5 网站，我在其中使用[yootheme 的 Nano 主题](http://www.yootheme.com/themes)。当我在控制面板上看到时，我总是看到**Joomla！2.5.3**，但是 2.5 的最新版本是 2.5.7。

为什么我看不到其他主题的更新信息？

如何将 2.5.3 更新到 2.5.7？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:49:24.903

你什么时候安装的Joomla！直到 2.5.3，您是否进行了任何自动更新？我真的怀疑这与主题有关。

您可以手动更新 Joomla！到 2.5.8，检查[Joomla！2.5.8 发布页面。](http://www.joomla.org/announcements/release-news/5470-joomla-2-5-8-released.html).

当然不要忘记在升级之前备份所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:27:11.217

Joomla 本身帮助了我...

从[**这里开始**](http://docs.joomla.org/Upgrading_from_an_existing_version)**执行步骤**2b 。[](http://docs.joomla.org/Upgrading_from_an_existing_version)

# c# - 将 wcf 服务的引用添加到 silverlight 应用程序

> ID：13622648
> 
> 赞同：0
> 
> 时间：2012-11-29T09:32:05.667
> 
> 标签：c#, asp.net, wcf, silverlight-4.0

我的代码如下：

```
 ServiceReference1.ImageFile imagefile = new ServiceReference3.ImageFile();
            imagefile.ImageName = fileName;
            imagefile.Imagestream = bytes;

            ServiceReference3.Service1Client service = new ServiceReference3.Service1Client();
            service.UploadCompleted += new EventHandler<ServiceReference3.UploadCompletedEventArgs>(service_UploadCompleted);
            service.UploadAsync(imagefile); 
```

此处未创建 ServiceReference1 如何创建服务引用并使 ServiceReference1 在 xaml.cs 页面中可用。任何帮助我的人都非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:50:24.513

MSDN 教程 : [**How to: Access a Service from Silverlight**](http://msdn.microsoft.com/en-us/library/cc197937%28v=vs.95%29.aspx) fir 添加服务参考

或供网络参考

您可以这样做，请查看本文以了解详细信息：[将 Web 引用添加到 Silverlight 应用程序](http://jkumarsahoo.wordpress.com/2011/10/05/add-web-reference-to-silverlight-application/)

![在此处输入图像描述](../Images/d2ad0be26d420e8e6cef36d3b47e1ab0.png)

# objective-c - 我应该使用 GCD dispatch_X 保留参数（还是保留它）

> ID：13622649
> 
> 赞同：2
> 
> 时间：2012-11-29T09:32:07.447
> 
> 标签：objective-c, memory-management, ios6, selector, grand-central-dispatch

据我记得，`performSelectorOnMainThread:`在 Apple 的文档中，我们有类似（和变体）保留对象直到方法完成执行“。那么我们可以依赖 ios6 中的这种行为吗？因为[NSObject 类参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html)中没有任何信息现在。同样的问题，如果我更喜欢使用 GCD `dispatch_async`/ `sync`- 如果我在后台线程中创建了对象 - 我应该选择`dispatch_sync(dispatch_get_main_queue)`确保在选择器执行之前不会释放该对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:20:38.823

关于 Cocoa 内存管理系统的事情是你永远不必关心这个。内存管理完全是本地的——你从不关心其他函数做什么。基本规则是——**调用者保证在函数被调用时对象参数是有效的，并且不保证其他任何事情**。

如果一个函数以某种方式存储了一个对象以供以后使用，它必须（通过演绎）以某种方式保留它，因为它不再假定该对象是有效的。相反，作为函数的调用者，您不需要考虑函数的作用或它是否异步执行某些操作，因为您无法保证函数在调用后的任何时候其参数都处于活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:35:35.060

块，GCD 调度**捕获**它们的上下文：在这种情况下，这意味着它们保留它们引用的所有内容，直到执行:)

# c - 如何处理父窗口中的所有按键

> ID：13622651
> 
> 赞同：0
> 
> 时间：2012-11-29T09:32:13.723
> 
> 标签：c, winapi

我一直在为一个基本的用户界面而苦苦挣扎。我有一个父窗口和几个子窗口。对于按钮（BS_CHECKBOX 样式）和编辑等子窗口，我无法处理任何按下 ESC 键事件的消息。我可以对子窗口进行子类化，但仅仅处理一个事件似乎有点过头了。我也有一个 listview 孩子，出于某种原因，我可以正确处理 VK_ESCAPE。我还检查了 spy++ 并注意到当按下 ESC 键时没有消​​息发送到父窗口（并且孩子被聚焦）。如果我将 spy++ 设置为仅记录子消息，则会为按键生成正确的消息——它们只是不会传递给父消息。有什么想法（不）做什么？

主窗口循环：

```
 MSG Msg;
  while (GetMessage(&Msg, NULL, 0, 0))
  {
    TranslateMessage (&Msg);
    DispatchMessage (&Msg);
  } 
```

父级 WndProc 中用于处理 listview 按键的工作代码：

```
case WM_NOTIFY:
    switch (((LPNMHDR)lParam)->code)
    {
    case LVN_KEYDOWN:
        if (((LPNMLVKEYDOWN)lParam)->wVKey == VK_ESCAPE)
            Exit();
        break;
    }
    break; 
```

谢谢，

克拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:38:26.803

一种方法是在它被分派到焦点窗口之前在消息循环中捕获它，例如：

```
MSG Msg;
while (GetMessage(&Msg, NULL, 0, 0))
{
    if (Msg.message == WM_KEYDOWN && Msg.wParam == VK_ESCAPE)
    {
        // process escape key
    }
    else
    {
        TranslateMessage(&Msg);
        DispatchMessage(&Msg);
    }
} 
```

当然还有其他方法可以做到，但这是一个非常简单的解决方案。

# php - 每次我从 PHP 创建 zip 文件时，都会有一个空文件夹“\data”

> ID：13622654
> 
> 赞同：0
> 
> 时间：2012-11-29T09:32:36.747
> 
> 标签：php, zip, directory

每次我从 PHP 创建 zip 文件时，都会有一个空文件夹“\data”。但是服务器中没有这样的文件夹。当我解压缩 zip 文件并浏览该空文件夹时，它显示的路径如下：

\data/www/subdomains/site/httpdocs/

它看起来像我要压缩的文件夹的绝对路径。

这是我的代码：

```
<?php 

$file = tempnam("tmp","zip");
zip_directory($_GET['catname'].'/'.$_GET['directtozip'].'/',$file);

header('Content-Type: application/zip');
header('Content-Length: ' . filesize($file));
header('Content-Disposition: attachment; filename="'.$_GET['directtozip'].'.zip"');

readfile($file);
unlink($file); 

function zip_directory($source,$tempfile){
if(!extension_loaded('zip') || !file_exists($source)) return false;
$zip = new ZipArchive();
if(!$zip->open($tempfile,ZIPARCHIVE::CREATE)) return false;
$source = str_replace('\\','/',realpath($source));
if(is_dir($source) === true){
    $files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($source),         RecursiveIteratorIterator::SELF_FIRST);
    foreach($files as $file){

    // Excluded folders or file from zip.
    $chk_1 = strstr($file,$source .'/'.'.svn');

    if($chk_1){continue;}

     $file = str_replace('\\', '/', realpath($file));

        if (is_dir($file) === true)
        {
            $zip->addEmptyDir(str_replace($source . '/', '', $file . '/'));
        }
        else if (is_file($file) === true)
        {
            $zip->addFromString(str_replace($source . '/', '', $file),     file_get_contents($file));
        }
    }
}
elseif(is_file($source) === true) $zip->addFromString(basename($source),     file_get_contents($source));

return $zip->close();
}

zip_directory($source,$tempfile);

?> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:58:42.857

最后一行是什么，`zip_directory($source,$tempfile);`因为 $tempfile 没有定义。

你的代码对我来说没问题

```
<?php 

$file = tempnam("tmp","zip");

zip_directory('__z/', $file);

header('Content-Type: application/zip');
header('Content-Length: ' . filesize($file));
header('Content-Disposition: attachment; filename="_zzz.zip"');

readfile($file);
unlink($file); 

function zip_directory($source, $tempfile){
    if(!extension_loaded('zip') || !file_exists($source)) {
        return false;
    }
    $zip = new ZipArchive();
    if(!$zip->open($tempfile, ZIPARCHIVE::CREATE)) {
        return false;
    }
    $source = str_replace('\\','/', realpath($source));
    if( is_dir($source) === true ) {
        $files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($source), RecursiveIteratorIterator::SELF_FIRST);
        foreach($files as $file){
            $chk_1 = strstr($file,$source .'/'.'.svn');
            if($chk_1){continue;}
            $file = str_replace('\\', '/', realpath($file));
            if (is_dir($file) === true) {
                $zip->addEmptyDir(str_replace($source . '/', '', $file . '/'));
            } else if (is_file($file) === true) {
                $zip->addFromString(str_replace($source . '/', '', $file),     file_get_contents($file));
            }
        }
    } elseif( is_file($source) === true ) {
        $zip->addFromString(basename($source), file_get_contents($source));
    }
    return $zip->close();
}

?> 
```

# php - Magento：编辑订单中的现有订单项

> ID：13622655
> 
> 赞同：0
> 
> 时间：2012-11-29T09:32:39.733
> 
> 标签：php, magento

我们可以编辑订单中的现有订单项（更改状态、订购数量、处理数量、价格、折扣金额）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:33:14.597

无法在后台手动编辑它。

1.  您可以通过 BO 中的操作更改它们
2.  您可以从 Mage_Sales_Model_*（Mage_Sales_Model_Order、Mage_Sales_Model_Order_Item 等）编写代码加载模型并对其进行操作
3.  您可以在表格中的 PHPMyAdmin 中手动更改数据
    *   sales_flat_order
    *   sales_flat_order_item

# c++ - 使用友元类的单例实现 (C++)

> ID：13622659
> 
> 赞同：3
> 
> 时间：2012-11-29T09:32:45.393
> 
> 标签：c++, visual-c++, g++, c++03

我在尝试创建单例时想出了这个。示例：（我正在尝试制作`MySelf`一个线程安全且不使用双重检查锁定的单例）

```
class MySelf
{
private:
    string Name;
    int Age;

    MySelf()
    {
        Name = "Deamonpog";
        Age = 24;
        cout << "Constructing MySelf : " << Name << endl;
    };

    friend class MySingleton;

public:
    ~MySelf(){ cout << "Destructing MySelf : " << Name << endl; };

    int MyAge() const
    {
        return Age;
    }
};

class MySingleton
{
private:
    static MySelf mself;
public:
    static MySelf * GetInstance()
    {
        return &mself;
    }
};

MySelf MySingleton::mself; 
```

现在我可以轻松地使用它，

```
cout << "I am " << MySingleton::GetInstance()->MyAge() << endl; 
```

我不想要延迟初始化，因为我要创建的类将从头到尾都存在。但是这个线程安全吗？（据我所知，这似乎还可以）

如果这没问题，那么我应该使用这样的通用编程，

```
template <class T>
class GenericSingleton
{
private:
    static T _instance;

public:
    static T * GetInstance()
    {
        return &_instance;
    }
};

template <class T>
T GenericSingleton<T>::_instance; 
```

所以我也可以将它与任何其他类一起使用。我只需要添加`friend class GenericSingleton<MySelf>;`到所需的 sigleton（例如添加到 MySelf 类）。

这种实现会引起麻烦吗？我实际上正在创建一个库。一些单例将被导出，而有些则不会。另外，如果这不是一个库，而只是另一个应用程序怎么办？

- 编辑 -

所以现在我必须这样做（因为我使用的是仍然不支持 C++11 的 VC++），

```
static MySelf & GetInstance()
{
    WaitForMutex(mymutex); // some function from the threading library
    if( NULL == _instance )
    {
         _instance = new MySelf();
    }
    ReleaseMutex(mymutex); // release function of the same library
    Return _instance;
} 
```

并告诉用户使用该功能一次，然后将其缓存以供使用。（或者我也可以将函数重命名为`Initialize()`并创建另一种方法来仅返回引用而无需任何锁定或创建。）那么`mymutex`应该在哪里？它应该在哪里初始化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T09:48:42.937

**不**，但这不是主要问题。

全局对象（如`static`）的初始化跨翻译单元是无序的；这意味着如果在创建我调用的一个全局变量期间，`MySingleton::GetInstance()`我最终可能会得到一个指向未初始化内存的指针。

请参阅[初始化顺序惨败](https://stackoverflow.com/questions/5299095/static-initialization-order-fiasco)。

最重要的是，如果我要在这个初始化阶段启动第二个线程，它可以访问部分初始化的对象。

一般来说，建议使用 Meyer 的 Singleton：

```
MySelf& MySelf::Instance() { static MySelf S; return S; } 
```

它以两种方式回避了初始化顺序的失败：

*   保证`Instance()`返回时对象被初始化
*   从 C++11 开始，编译器需要对初始化代码进行检测，以便在初始化期间检测到重入访问（gcc 在 C++03 中已经完成）

此外，从 C++11 开始，这需要是线程安全的：也就是说，如果`Instance()`在构造对象时另一个线程调用，它将耐心等待直到构造结束，然后返回与所有其他对象相同的实例线程（gcc 已经在 C++03 中做了）。

*注意：使用无关的类只是更多的输入而没有附加值，放弃它。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T09:38:01.760

这是更简单的实现：

```
template <class T>
class GenericSingleton
{
public:
    static T& GetInstance()
    {
        static T _instance;
        return _instance;
    }
}; 
```

**它在C++11**中也是线程安全的，因为静态变量在任何线程之前创建。

# handlebars.js - 如何在handlebar.js中表示整数数组

> ID：13622660
> 
> 赞同：1
> 
> 时间：2012-11-29T09:32:47.293
> 
> 标签：handlebars.js

我有一个 json 对象“FoundAt”：[1, 3] 如何使用 handlebar.js 表示数组中的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T20:26:53.727

如果您指的是迭代数组，您可以使用`{{each}}`块来执行此操作，参考上面定义的数组使用以下内容：

```
 {{#each jsonObjectName.FoundAt}}
  {{this}}
 {{/each}} 
```

或者

```
 {{#each number in jsonObjectName.FoundAt}}
  {{number}}
 {{/each}} 
```

在官方[文档中查找 Simple Iterators](http://handlebarsjs.com/block_helpers.html)

# insert - 在 yii 中如何通过覆盖现有条目在表中插入记录

> ID：13622661
> 
> 赞同：1
> 
> 时间：2012-11-29T09:32:52.273
> 
> 标签：insert, yii

> **可能重复：**
> [在 yii 中如何通过覆盖旧密码来插入新密码](https://stackoverflow.com/questions/13620878/in-yii-how-to-insert-new-password-by-overriding-old-password)

我对使用 Yii 框架非常陌生。

我正在 Yii 中创建密码重新创建功能。如果电子邮件 ID 存在，则将向该用户显示 password.php 页面，请求输入新密码。

假设这是我的视图文件

```
<?php $form=$this->beginWidget('CActiveForm', array(
        'id'=>'email-form',
        'enableClientValidation'=>true,
));

        echo CHtml::textField('password');
        echo CHtml::textField('repeatPassword');
        echo CHtml::submitButton('Submit');
        $this->endWidget();` 
```

现在用户需要输入新密码。我想通过覆盖旧密码将这个新输入的密码放入 User 表中的数据库中，它是密码字段。但我不知道如何实现这一目标。

有小费吗？

# c++ - C++11 中的泛型函数指针

> ID：13622663
> 
> 赞同：5
> 
> 时间：2012-11-29T09:32:58.120
> 
> 标签：c++, c++11, function-pointers

我目前正在用 C++x0 编写方法执行队列。我已经实现并验证了基本队列机制，但想通过一个选项对其进行修改，以`push()`自动删除所有先前对特定方法的调用：

```
queue.push(this, &Obj::foo, 1);
queue.push(this, &Obj::foo, 2);
queue.push(this, &Obj::foo, 3); 
```

应该与仅调用相同

```
queue.push(this, &Obj::foo, 3); 
```

到目前为止，我的代码如下所示：

队列.h：

```
#pragma once

#include <functional>
#include <vector>

using std::vector;
using std::function;
using std::bind;

class Queue
{

    private:
        struct functioncall {
            std::function<void()> call;
        };

        vector<functioncall> queue;

    public:
        Queue();
        ~Queue();

        template<typename T, typename F, typename... Args>
        int push(T, F , Args... args);

        int pop();
        bool empty();
        size_t size();
};

template<typename T, typename F, typename... Args>
int Queue::push(T instance, F func, Args... args)
{
    functioncall newelem = { bind(func, instance, args...) };
    queue.push_back(newelem);
    return queue.size();
} 
```

队列.cpp：

```
#include "Queue.h"

Queue::Queue() : queue()
{
}

Queue::~Queue()
{
    delete &queue;
}

int Queue::pop()
{
    if(!queue.empty())
    {
        queue.front().call();
        queue.erase(queue.begin());
        return queue.size();
    }
    return 0;
}

bool Queue::empty()
{
    return queue.empty();
}

size_t Queue::size()
{
    return queue.size();
} 
```

我已经准备好向量`queue`来获取一个结构，我不仅要保存结果，`std::bind`还要保存指向被调用方法的指针，这样我就可以查找该指针并删除旧条目。

问题是传递给的函数`push()`可以接受任意数量的参数。是否有可以做到这一点的通用指针类型（它不必是可执行的，只是当我重复将相同的函数推送到队列时相同）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:51:05.553

根据 5.2.10p10，您可以将指向成员函数的指针转换`T::*(A1, A2, ...)`为指向成员函数类型的另一个指针`U::*(B1, ...)`并返回，而不会丢失信息；`std::less`可以比较指向成员函数的指针，因此通过转换为指向成员的虚拟指针类型`void (Impl::*)()`，您可以比较指向具有相同签名的成员函数的指针。

但是，不能保证指向具有不同签名的成员函数的指针在转换为指向相同成员类型的指针时会比较不同，因此您需要在可比较类型中对签名进行编码。 `typeid`将在这里工作：

```
auto key = std::make_pair(&typeid(F), reinterpret_cast<void (Queue::*)()>(func)); 
```

这假设这`F`确实是一个指向成员函数的指针；如果用户尝试传递一些其他可调用对象，那么这将中断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T10:50:49.717

[`std::function::target<>()`](http://en.cppreference.com/w/cpp/utility/functional/function/target)可用于检查包装函数类型：

```
template <class F> bool is_same_call(const functionalcall& prevCall, F newCall)
{
   const F* pf = prevCall.call.target<F>();
   return pf ? *pf == newCall : false;
} 
```

请注意，如果用 object 包装的函数`std::function::target()`的类型不同于.`nullptr``std::function``F`

# jquery - 制作第一行的固定标题

> ID：13622664
> 
> 赞同：6
> 
> 时间：2012-11-29T09:32:58.687
> 
> 标签：jquery, asp.net, html, css

[演示](http://jsbin.com/uwuqut/2/edit)

```
<div id="divScroll" style="overflow-x: hidden">
    <table id="tableAppointment" bgcolor="#fcfcfc" border="1" cellspacing="1" width="100%">

            <tr>
                <td class="csstextheader" width="70px"></td>
                <td class="csstextheader" width="70px">
                    <b>Time Slot&nbsp;</b>
                </td>
                <td><b>Room 7</b></td>
                <td><b>Room 8</b></td>
                <td><b>Room 9</b></td>
                <td><b>Room 10</b></td>
            </tr>

            <tr class="csstablelisttd">
                <td width="70px">08:00AM</td>
                <td>00</td>
                <td class="csstdred">John</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>                                     
            </tr>
    </table>
</div> 
```

调用窗口加载

```
function resolutionIndependent()
        {
            var height;
            var tableMain;
            var divScroll;

            if (document.body && document.body.offsetWidth)
            {
                height = document.body.offsetHeight;
            }
            if (document.compatMode == 'CSS1Compat' && document.documentElement && document.documentElement.offsetWidth)
            {
                height = document.documentElement.offsetHeight;
            }
            if (window.innerWidth && window.innerHeight)
            {
                height = window.innerHeight;
            }
            tableMain = document.getElementById('tableMain');
            divScroll = document.getElementById('divScroll');
            tableMain.style.height = parseFloat(height - 170) + 'px';
            divScroll.style.height = parseFloat(height - 170) + 'px';
            divScroll.style.overflow = "auto";
        }
 //***tableMain which is outer table of divScroll*** 
```

我必须制作第一行的固定标题。我要添加`style="position:fixed"`到第一行的每个单元格。但没有得到输出..怎么可能

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-07T12:39:22.923

嘿，您甚至可以使用一个简单的 jquery 函数，它可以在不更改 html 代码的情况下为您提供结果

```
var tdWidth = $("#tableAppointment tbody tr td").width();
$("#tableAppointment thead").css({'position': 'fixed','top': '0','left': '-0.2%', 'background-color': '#f94d4d','color': '#FFFFFF','text-align': 'center','width': '100%'});

$("#tableAppointment thead tr th").width(tdWidth); 
```

工作示例是[jsfiddle](http://jsfiddle.net/h6hfX/41/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-03T08:41:53.010

我已经为您的问题创建了简单的编码。请参考以下内容以查看它的实际效果：http: [//jsfiddle.net/john_rock/h6hfX/1/](http://jsfiddle.net/john_rock/h6hfX/1/)

**HTML部分：**

```
<table>
<thead>
<tr><th>Head1</th><th>Head2</th><th>Head3</th><th>Head4</th><th>Head5</th><th>Head6</th></tr>
</thead>
<tfoot>
<tr><td>Foot1</td><td>Foot2</td><td>Foot3</td><td>Foot4</td><td>Foot5</td><td>Foot6</td></tr>
</tfoot>
<tbody>
<tr><td>r1c1</td><td>r1c2</td><td>r1c3</td><td>r1c4</td><td>r1c5</td><td>r1c6</td></tr>
<tr><td>r2c1</td><td>r2c2</td><td>r2c3</td><td>r2c4</td><td>r2c5</td><td>r2c6</td></tr>
<tr><td>r3c1</td><td>r3c2</td><td>r3c3</td><td>r3c4</td><td>r3c5</td><td>r3c6</td></tr>
<tr><td>r4c1</td><td>r4c2</td><td>r4c3</td><td>r4c4</td><td>r4c5</td><td>r4c6</td></tr>
<tr><td>r5c1</td><td>r5c2</td><td>r5c3</td><td>r5c4</td><td>r5c5</td><td>r5c6</td></tr>
<tr><td>r6c1</td><td>r6c2</td><td>r6c3</td><td>r6c4</td><td>r6c5</td><td>r6c6</td></tr>
<tr><td>r7c1</td><td>r7c2</td><td>r7c3</td><td>r7c4</td><td>r7c5</td><td>r7c6</td></tr>
<tr><td>r8c1</td><td>r8c2</td><td>r8c3</td><td>r8c4</td><td>r8c5</td><td>r8c6</td></tr>
<tr><td>r9c1</td><td>r9c2</td><td>r9c3</td><td>r9c4</td><td>r9c5</td><td>r9c6</td></tr>
<tr><td>r10c1</td><td>r10c2</td><td>r10c3</td><td>r10c4</td><td>r10c5</td><td>r10c6</td></tr>
<tr><td>r11c1</td><td>r11c2</td><td>r11c3</td><td>r11c4</td><td>r11c5</td><td>r11c6</td></tr>
<tr><td>r12c1</td><td>r12c2</td><td>r12c3</td><td>r12c4</td><td>r12c5</td><td>r12c6</td></tr>
<tr><td>r13c1</td><td>r13c2</td><td>r13c3</td><td>r13c4</td><td>r13c5</td><td>r13c6</td></tr>
<tr><td>r14c1</td><td>r14c2</td><td>r14c3</td><td>r14c4</td><td>r14c5</td><td>r14c6</td></tr>
<tr><td>r15c1</td><td>r15c2</td><td>r15c3</td><td>r15c4</td><td>r15c5</td><td>r15c6</td></tr>
</tbody>
</table>​ 
```

**CSS部分：**

```
table {width:100%; border:1px solid #000000;}
thead {background-color:#000268;color:#FFFFFF;text-align:center; position:fixed; top:0px;}
thead th { height:50px; width:120px; text-align:center;border-width: 1px;border-style: outset;}
tbody {color:#000000;text-align:center; height:150px; overflow: scroll; margin:0px;}
tbody td { height:60px; width:100px;border-width: 1px;border-style: outset;}
tfoot {background-color:#000268; color:#FFFFFF;text-align:center; position:fixed; bottom:0px;}
tfoot td { height:50px; width:120px; text-align:center;border-width: 1px;border-style: outset;}​ 
```

我认为这可以帮助您解决问题。

注意：这是您问题的示例答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T11:18:18.173

如果你要使用 jQuery，第一次克隆表

```
var clone  = $('.tableAppointment').clone() 
```

然后删除克隆中不需要/不显示在将成为克隆的固定标题中的部分

```
clone.remove('.csstablelisttd') 
```

然后隐藏/删除表中支持修复的部分，以免造成混乱，当两个标题（显示克隆和原始）时，并向原始添加一个类，我们将使用它来引用我们想要的位置添加克隆（在它之前）

```
$('.tableAppointment').remove('.firstrowclassname').addClass('beforeHeader') 
//you have not given the 1st row an ID/class, you need to, for refering in jQuery 
```

现在为克隆提供固定的标题 CSS 样式并将 if 放在原始标题之前

```
clone.css({position: fixed}).insertBefore('.beforeHeader') 
```

您基本上所做的是创建了两个标题，从一个中删除了应该修复的部分，并从另一个中删除了不应该修复的部分，并将两者一起显示而不会丢失表格的样式，只有这一次表是固定的，具有所需行的表

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-06T13:51:38.293

can i use css for it ? i have simple answer ... Use `:first-child` selector like this

```
thead tr:first-child {
   position:fixed;
} 
```

This is only example not ready to try ... Change it before with your element ... Good luck

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-07T10:36:02.743

你可以使用像[jqGrid](http://www.trirand.com/blog/)这样的 jQuery 插件吗？

此外，如果第一行是标题，您应该使用表格标题标签`th`

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-11-29T09:44:06.563

尝试 ：

```
 <thead>
    <tr  style="position: fixed; background-color: grey;">
        <td class="csstextheader" width="70px"></td>
        <td class="csstextheader" width="70px">
            <b>Time Slot&nbsp;</b>
        </td>
        <td><b>Room 7</b></td>
        <td><b>Room 8</b></td>
        <td><b>Room 9</b></td>
        <td><b>Room 10</b></td>
    </tr>
</thead> 
```

将第一行设为固定位置并使用 css 为所有单元格添加宽度，这样会很好

# c# - 如果元素不存在，C# xmlTextReader 错误

> ID：13622670
> 
> 赞同：0
> 
> 时间：2012-11-29T09:33:15.407
> 
> 标签：c#, xml, xmltextreader

我正在尝试使用 xmlTextReader 读取 xml 文件并将其存储在列表中，但我正在努力克服这个烦人的小错误。让我再解释一下：

我将文件中的所有节点存储在 XmlNodeList 中，并使用 foreach 循环读取每个节点并使用此类模板将其添加到我的列表中：

```
public class getGamesList
{
    public int id { get; set; }
    public string title { get; set; }        
    public string release { get; set; }        
    public string platform { get; set; }
} 
```

这是主要代码：

```
List<getGamesList> list = new List<getGamesList>();
        String URLString = "http://thegamesdb.net/api/GetGamesList.php?name="+name;
        XmlTextReader tr = new XmlTextReader(URLString);

        XmlDocument xml = new XmlDocument();
        xml.Load(tr);
        XmlNodeList xnList = xml.SelectNodes("/Data/Game");

        foreach (XmlNode xn in xnList)
        {
            list.Add(new getGamesList()
            {
                id = Convert.ToInt32(xn["id"].InnerText),
                title = xn["GameTitle"].InnerText,
                release = xn["ReleaseDate"].InnerXml,
                platform = xn["Platform"].InnerText
            });
        } 
```

代码工作正常，直到第 3 个 xml 元素，其中缺少“ReleaseDate”节点。它只是没有。所以抛出一个错误。

我知道我需要在读取节点之前找出一种方法来检查节点是否存在，但是我有点混乱；到目前为止，没有任何事情是成功的。有没有人有任何想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:36:53.787

尝试检查是否为空：

```
release = (null != xn["ReleaseDate"]) ? xn["ReleaseDate"].InnerXml : "", 
```

**编辑：**

我想使用的其他方法是向您的类添加 XML 属性：

```
[Serializable]
public class getGamesList
{
    [XmlElement("...")]
    public int id { get; set; }
    [XmlElement("...")]
    public string title { get; set; }        
    [XmlElement("ReleaseDate")]
    public string release { get; set; }        
    [XmlElement("...")]
    public string platform { get; set; }
} 
```

此重构将允许您使用[XmlSerializer.Deserialize](http://msdn.microsoft.com/ru-ru/library/dsh84875.aspx)（示例部分）方法并将 XML 自动映射到您的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:36:54.340

在访问任何属性之前检查对象是否为空。

```
release = xn["ReleaseDate"] != null ? xn["ReleaseDate"].InnerXml : string.Empty 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T10:00:29.257

你可以做一个扩展方法，比如

```
 public static T GetXmlValue<T>(this XmlNode node, string name, T defaultValue)
    {
        if (node != null && node[name] != null)
        {
            if (typeof(T) == typeof(string))
            {
                return (T)(object)node[name].InnerText;
            }
            else if (typeof(T) == typeof(int))
            {
                int value = 0;
                if (int.TryParse(node[name].InnerText, out value))
                {
                    return (T)(object)value;
                }
            }
        }
        return defaultValue;
    } 
```

用法：

```
list.Add(new getGamesList()
{
    id = xn.GetXmlValue<int>("id", 0),
    title = xn.GetXmlValue<string>("GameTitle", string.Empty),
    release = xn.GetXmlValue<string>("ReleaseDate", string.Empty),
    platform = xn.GetXmlValue<string>("Platform", string.Empty)
}); 
```

# android - 自定义对话框上的 Android 轨迹球

> ID：13622674
> 
> 赞同：1
> 
> 时间：2012-11-29T09:33:24.240
> 
> 标签：android, dialog, trackball

我有一个自定义对话框，它扩展了 Dialog 类和一个简单的自定义布局，如下所示：

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:drawable/list_selector_background"
    >

<TextView
        android:id="@+id/text_view"
        android:layout_width="fill_parent"
        android:layout_height="50dp"
        android:gravity="center_vertical"
        android:paddingLeft="10dp"
        android:background="@color/transparent"
        android:textColor="@color/black"
        android:textSize="16sp"
        android:focusable="true"/> 
```

我的问题是，当像附件图像中选择一行时，轨迹球使文本不可见。

![在此处输入图像描述](../Images/ef3fdf8c3fb9e490eea2d0a2e73f61e7.png)

list_selector_background 代码来自 Android，如下所示：

```
<?xml version="1.0" encoding="utf-8"?> 
```

`Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.` -->

```
<item android:state_window_focused="false" android:drawable="@color/transparent" />

<!-- Even though these two point to the same resource, have two states so the drawable will invalidate itself when coming out of pressed state. -->
<item android:state_focused="true"  android:state_enabled="false" android:state_pressed="true" android:drawable="@drawable/list_selector_background_disabled" />
<item android:state_focused="true"  android:state_enabled="false"                              android:drawable="@drawable/list_selector_background_disabled" />
<item android:state_focused="true"                                android:state_pressed="true" android:drawable="@drawable/list_selector_background_transition" />
<item android:state_focused="false"                               android:state_pressed="true" android:drawable="@drawable/list_selector_background_transition" />
<item android:state_focused="true"                                                             android:drawable="@drawable/list_selector_background_focus" /> 
```

我的 ListView xml 代码是这样的：

```
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          android:drawSelectorOnTop="true"
          android:background="@color/white"
          android:cacheColorHint="@color/transparent">

</ListView> 
```

我在 AlertDialog（来自 Android 的那个）上看到它工作正常。我应该怎么做才能解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:56:24.603

试试这个：从这一行中删除“android”文本。像;

```
android:background="@drawable/list_selector_background" 
```

在列表视图中添加

```
android:cacheColorHint="@android:color/transparent"
android:drawSelectorOnTop="false"
android:listSelector="@android:color/transparent"
android:fadingEdge="none" 
```

这对我有用

# java - 如果客户端从不发送 FIN 数据包关闭连接，连接是否超时？

> ID：13622676
> 
> 赞同：3
> 
> 时间：2012-11-29T09:33:31.457
> 
> 标签：java, networking, tcp, netty, tcplistener

我有一个用 Netty 实现的 HTTP 服务器。将消息推送到浏览器需要长轮询连接。在大多数情况下，服务器不会尝试关闭连接。

在 TCP 会话中，如果任何一方想要关闭连接，它会向另一方发送一个 FIN 数据包。如果服务器没有收到来自客户端的 FIN，例如 1) 用户有硬网络故障或 2) 有人试图攻击服务器，是否保证 Netty 服务器会收到超时（或其他某种）在给定时间后的异常？

如果是真的，我不需要在我的通道管道中添加一个 Read/WriteTimeoutHandler，它会在定时器触发超时时关闭通道。无论哪种方式我都必须关闭通道，否则我会泄漏资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:43:31.713

> 是否保证 Netty 服务器在给定时间后会收到超时（或其他类型的）异常？

否。`SocketTimeoutException`如果套接字处于阻塞模式并且设置了读取超时，则会抛出一个。如果启用了 TCP keepalive 并且连接确实保持断开 2 小时，则`IOException: connection reset`可能会发生这种情况：这不包括对等方仅保持沉默而连接保持有效的情况。否则没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T06:59:37.140

根据 TCP 状态图，双方都应该发送 FIN 来关闭双方的连接。但是，如果 FIN 在您的场景中丢失，TCP 将通过适当的超时值克服。

# php - 缓存 readdir()

> ID：13622677
> 
> 赞同：0
> 
> 时间：2012-11-29T09:33:37.437
> 
> 标签：php, caching

反正有缓存 readdir() 结果吗？现在，每当我在网站上输入特定网页时，我都会在目录树上执行 readdir()。

**更新：**

*   所有用户的目录结构都相同。
*   不幸的是，我的共享主机不支持 APC 或 memcache :-(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:06:35.017

你可以`Memcache`使用`filemtime`

```
$path = __DIR__ . "/test";
$cache = new Memcache();
$cache->addserver("localhost");

$key = sha1($path);
$info = $cache->get(sha1($path));

if ($info && $info->time == filemtime($path)) {
    echo "Cache Copy ", date("Y-m-d g:i:s", $info->time);
} else {
    $info = new stdClass();
    $info->readDir = array_map("strval", iterator_to_array(new FilesystemIterator($path, FilesystemIterator::SKIP_DOTS)));
    $info->time = filemtime($path);
    $cache->set($key, $info, MEMCACHE_COMPRESSED, 0);
    echo "Path Changed ", date("Y-m-d g:i:s", $info->time);
}

var_dump(array_values($info->readDir)); 
```

**更新**

> 不幸的是，我的共享主机不支持 APC 或 memcache :-(

您可以使用文件系统

```
$path = __DIR__ . "/test";
$cache = new MyCache(__DIR__ . "/a");

$key = sha1($path);
$info = $cache->get($key);

if ($info && $info->time == filemtime($path)) {
    echo "Cache Copy ", date("Y-m-d g:i:s", $info->time);
} else {
    $info = new stdClass();
    $info->readDir = array_map("strval", iterator_to_array(new FilesystemIterator($path, FilesystemIterator::SKIP_DOTS)));
    $info->time = filemtime($path);
    $cache->set($key, $info, MEMCACHE_COMPRESSED, 0);
    echo "Path Changed ", date("Y-m-d g:i:s", $info->time);
}

var_dump(array_values((array) $info->readDir)); 
```

使用的类

```
class MyCache {
    private $path;

    function __construct($path) {
        is_writable($path) or trigger_error("Path Not Writeable");
        is_dir($path) or trigger_error("Path Not a Directory");
        $this->path = $path;
    }

    function get($key) {
        $file = $this->path . DIRECTORY_SEPARATOR . $key . ".cache";
        if (! is_file($file))
            return false;
        $data = file_get_contents($file);
        substr($data, 0, 2) == "##" and $data = gzinflate(substr($data, 2));
        return json_decode($data);
    }

    function set($key, $value, $compression = 0) {
        $data = json_encode($value);
        $compression and $data = gzdeflate($data, 9) and $data = "##" . $data;
        return file_put_contents($this->path . DIRECTORY_SEPARATOR . $key . ".cache", $data);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:36:54.160

如果您启动会话，您可以将其存储在会话变量中。查看 session_start() 函数等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:38:25.320

您可以使用多种方法缓存任何可序列化的 PHP 结构。这些天 PHP 附带 APC，所以我建议查看 APC 对象缓存。

[http://uk1.php.net/manual/en/ref.apc.php](http://uk1.php.net/manual/en/ref.apc.php)

当目录结构改变时，一定要有一些清除缓存的逻辑。

# python - 绳索自动导入不起作用

> ID：13622687
> 
> 赞同：1
> 
> 时间：2012-11-29T09:34:15.470
> 
> 标签：python, emacs, rope, ropemacs

```
virtualenv env
pip install -e git+https://github.com/pinard/Pymacs.git@v0.24-beta2#egg=Pymacs-dev
pip install -e hg+https://bitbucket.org/agr/rope#egg=rope-dev
pip install -e hg+https://bitbucket.org/agr/ropemacs#egg=ropemacs-trunk
pip install -e hg+https://bitbucket.org/agr/ropemode#egg=ropemode-trunk
cd env/src/pymacs
make install 
```

将以下内容添加到 .emacs (setq virtual-env (getenv "VIRTUAL_ENV")) (setq load-path (append (list (concat virtual-env "/src/pymacs" )) load-path))

```
(if (not (equal virtual-env 'nil))
    (let ((foo 'bar))
      (require 'pymacs)
      (pymacs-load "ropemacs" "rope-")
      (setq ropemacs-enable-autoimport 't)
      (setq ropemacs-autoimport-modules '("os" "shutil"))
      )) 
```

之后，我可以获得完整的代码、文档、定义。

**但是**，输入rmtree，执行rope-auto-imoport后，“from shutil import rmtree”没有出现。

相反，我收到消息“**未找到全局名称 rmtree！** ”

帮我！

我已经尝试了 config.py 并添加了 extension_modules 和 python_path。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T11:49:32.993

```
M-x rope-generate-autoimport-cache 
```

# android - 用于按钮的 Android 滑动抽屉

> ID：13622689
> 
> 赞同：1
> 
> 时间：2012-11-29T09:34:28.450
> 
> 标签：android, slidingdrawer

我在屏幕底部有一个布局，其中有五个水平按钮，其中一个是“更多按钮”。

单击“更多按钮”时，我想打开一个带有三个按钮或文本视图的滑动抽屉：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/global_bg" >

<LinearLayout
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true" >

    <ImageView
        android:id="@+id/imageView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/navicon_search" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imageView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_video" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imageView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_news" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imageView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_ecommerce" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imgMore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_more" />
</LinearLayout>

<ImageView
    android:id="@+id/ImageView01"
    android:layout_width="match_parent"
    android:layout_height="10dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:background="@null"
    android:scaleType="fitXY"
    android:src="@drawable/top_color_bar" />

<RelativeLayout
    android:id="@+id/relativeLayout1"
    android:layout_width="wrap_content"
    android:layout_height="80dp"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/ImageView01"
    android:background="@drawable/global_masthead" >

    <ImageView
        android:id="@+id/imgbtnBackFromResetAddTime"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:src="@drawable/topnav_backarrow_small" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="Add Time"
        android:textSize="20dp"
        android:textStyle="bold" />

    <ImageView
        android:id="@+id/imgListOpen"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/imageView1"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:src="@drawable/topnav_geomap_small" />
</RelativeLayout> 
```

单击“imgMore”时，应打开一个带有 3 个按钮的滑动抽屉。

请修改我的布局以适应更改。

这个我试过了......

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/global_bg" >

<LinearLayout
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true" >

    <ImageView
        android:id="@+id/imageView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/navicon_search" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imageView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_video" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imageView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_news" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <ImageView
        android:id="@+id/imageView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_icon_ecommerce" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:src="@drawable/nav_divider" />

    <SlidingDrawer
        android:id="@+id/SlidingDrawer"
        android:layout_width="wrap_content"
        android:layout_height="250dip"
        android:content="@+id/contentLayout"
        android:handle="@+id/imgMore"
        android:orientation="horizontal"
        android:padding="10dip" >

        <ImageView
            android:id="@+id/imgMore"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:src="@drawable/nav_icon_more" />

        <LinearLayout
            android:id="@+id/contentLayout"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#cccccc"
            android:gravity="center"
            android:orientation="vertical"
            android:padding="10dip" >

            <Button
                android:id="@+id/Button01"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_margin="2dp"
                android:text="Option1" >
            </Button>

            <Button
                android:id="@+id/Button02"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_margin="2dp"
                android:text="Option2" >
            </Button>

            <Button
                android:id="@+id/Button03"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_margin="2dp"
                android:text="Option3" >
            </Button>

            <Button>
            </Button>
        </LinearLayout>
    </SlidingDrawer>
</LinearLayout>

<ImageView
    android:id="@+id/ImageView01"
    android:layout_width="match_parent"
    android:layout_height="10dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:background="@null"
    android:scaleType="fitXY"
    android:src="@drawable/top_color_bar" />

<RelativeLayout
    android:id="@+id/relativeLayout1"
    android:layout_width="wrap_content"
    android:layout_height="80dp"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/ImageView01"
    android:background="@drawable/global_masthead" >

    <ImageView
        android:id="@+id/imgbtnBackFromResetAddTime"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:src="@drawable/topnav_backarrow_small" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="Add Time"
        android:textSize="20dp"
        android:textStyle="bold" />

    <ImageView
        android:id="@+id/imgListOpen"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@+id/imageView1"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:src="@drawable/topnav_geomap_small" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:39:48.360

看[这个](http://android-er.blogspot.in/2011/10/slidingdrawer-in-horizontal.html)例子会对你有所帮助。在此示例中，如果您想添加取决于您的文本，它只会显示一个按钮，无论它是静态的还是动态的。

这仅用于指导您。

# android - Android：如何同时清除所有应用程序的缓存

> ID：13622690
> 
> 赞同：3
> 
> 时间：2012-11-29T09:34:27.577
> 
> 标签：android, android-intent

我对安卓很陌生。我想开发一个应用程序进行研究，单击一个按钮将清除 android 设备中所有已安装应用程序的缓存。我知道这种类型的应用程序在 google play 上可用，但我想自己开发。我尝试以下代码，但它清除了当前一个应用程序的缓存并抛出空指针异常。我需要同时清除每个应用程序的缓存。请帮我解决这个问题。在此先感谢..

```
Intent mainIntent = new Intent(Intent.ACTION_MAIN, null);

    mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);

    List<ResolveInfo> mainList = getPackageManager().queryIntentActivities(mainIntent, 0);

     Context context;

for(ResolveInfo rInfo : mainList)
  {

     String packageName = rInfo.activityInfo.applicationInfo.packageName;

     context = createPackageContext(packageName, Context.CONTEXT_IGNORE_SECURITY);

     clearApplicationData(context);

  }

public void clearApplicationData(Context context) {

  if(context.getCacheDir()!=null)
        {

     File cache = context.getCacheDir();

        File appDir = new File(cache.getParent());
        if(appDir.exists()){
            String[] children = appDir.list();
            for(String s : children){
                if(!s.equals("lib")){
                    deleteDir(new File(appDir, s));
                    Log.i("TAG", "File /data/data/APP_PACKAGE/" + s +" DELETED");
                }
            }
        }
   } 
public static boolean deleteDir(File dir) {
    if (dir != null && dir.isDirectory()) {
        String[] children = dir.list();
        for (int i = 0; i < children.length; i++) {
            boolean success = deleteDir(new File(dir, children[i]));
            if (!success) {
                return false;
            }
        }
    }
    return dir.delete();
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-06-10T05:09:18.577

```
private void clearAllCache() {
		PackageManager  pm = getPackageManager();
		Method[] methods = pm.getClass().getDeclaredMethods();
		for (Method m : methods) {
			if (m.getName().equals("freeStorage")) {
				try {
					long desiredFreeStorage = Long.MAX_VALUE;
					m.invoke(pm, desiredFreeStorage , null);
				} catch (Exception e) {
					e.printStackTrace();
				}
				break;
			}
		}
}
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-18T23:01:06.313

不要将 ClearApplicationData 放置在 ClearApplicationDataAll 之类的位置，或者将其放置在所有应用程序的目标位置。

# yii - PHP YII：如何上传视频

> ID：13622693
> 
> 赞同：0
> 
> 时间：2012-11-29T09:34:44.237
> 
> 标签：yii

我的模型代码：

```
 public $image;

      return array(
        array('filename', 'required'),
        array('image', 'file', 'types'=>''),
        array('filename', 'length', 'max'=>11),
        array('id, filename', 'safe', 'on'=>'search'),
    ); 
```

我的视图代码：

```
 <?php echo CHtml::activeFileField($model, 'image'); ?> 
```

我的控制器代码：

```
 $model =  new TblUpload;
     $model->attributes=$_POST['TblUpload'];
     $img = CUploadedFile::getInstance($model,'image');
     if($img->saveAs(Yii::app()->basePath.'/../images/'.$img))
            {       
                $model->filename = $img;
                $model->save(false);
            }
     }
    $this->render('uploadfile',array('model'=>$model));
} 
```

嗨，使用此代码的朋友，我可以上传所有类型的文件，例如图像和文档，但我无法上传视频....我也更改了我的 php.ini 文件 max_upload_size...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T06:44:59.693

最后我整理了如何上传图片......这是我的控制器代码......

公共函数 actionUploadfile()

```
{
        $model =  new TblUpload;    
        if(isset($_POST['TblUpload']))
        {           
            $model->image=CUploadedFile::getInstance($model,'image');
            if($model->save())
            {
            $model->image->saveAs('/wamp/www/fileupload/images/'.$fileName);
            }*/
            $model->attributes=$_POST['TblUpload'];
            $img = CUploadedFile::getInstance($model,'image');
            if($img->saveAs(Yii::app()->basePath.'/../images/'.$img))
            {

                $model->filename = $img;
                $model->save(false);
            }   
        }
    $this->render('uploadfile',array('model'=>$model));
} 
```

这是我弄错的地方......但现在我正在使用uploadify扩展来上传各种文件并对其进行编辑以一次用于多次上传

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T11:05:28.263

In your form view, have you set the enctype for the form?

```
$form = $this->beginWidget(
    'CActiveForm', array(
        'id' => 'my-form',
        'htmlOptions' => array(
            'enctype' => 'multipart/form-data'
        ),
    )
); 
```

It could also possibly be the path to the folder you are trying to upload to doesn't exists or is incorrect. Try using getcwd(), eg:

```
$model->my_image->saveAs(getcwd()."/uploads/myfile.jpg"); 
```

This is most likely the problem, your path in your code above is:

```
 if($img->saveAs(Yii::app()->basePath.'/../images/'.$img)) 
```

The basepath and followed by the ../ probably wrong unless you areally are trying to upload in the directory before your root?

# xslt - 运行 xsl 时出现静态错误

> ID：13622697
> 
> 赞同：0
> 
> 时间：2012-11-29T09:34:55.783
> 
> 标签：xslt

为了尝试从 java 传递 Xpath，我使用 saxon:evaluate() 方法修改了我的 xsl 文件。但我得到以下错误，

```
Static error in XPath expression supplied to saxon:evaluate: XPath syntax error at char 0 in {}:
        Unexpected token "<eof>" in path expression 
```

**XSLT：**

```
 <?xml version="1.0" encoding="utf-8"?>
   <xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ve="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml">

<xsl:output method="text" encoding="utf-8"/>

    <xsl:param name="xPath1"/>
    <xsl:param name="xPath2"/>

    <xsl:template match="/">

        <xsl:for-each select="saxon:evaluate($xPath1)">
            <xsl:value-of select="saxon:evaluate($xPath2)"/>        
        </xsl:for-each>

    </xsl:template>
</xsl:stylesheet>

xPath1=//w:p[w:pPr/w:pStyle[matches(@w:val,'tablecaption|figcaption')] and w:r[w:rPr/w:rStyle[matches(@w:val,'citation')]]]
xPath2=w:r[w:rPr/w:rStyle[matches(@w:val,'citation')]] 
```

# sharepoint-2010 - 从 Sharepoint Claims Base Athentication Webapplication 中的代码访问 windows 共享

> ID：13622701
> 
> 赞同：1
> 
> 时间：2012-11-29T09:34:59.357
> 
> 标签：sharepoint-2010, impersonation, c2wts

我想通过代码访问另一台机器上的共享资源。我的环境是在声明身份验证模式下工作的 Sharepoint 2010 WebApplication。应用程序的 Windows 身份是 NT AUTHORITY\IUSR - 不是已登录的用户，因此要访问另一台机器上的网络共享资源，我需要执行模拟。由于我没有有效的 Windows 令牌来执行模拟，我需要使用对 Windows 令牌服务的声明，我已将其配置为能够由 NT AUTHORITY\IUSR 访问。该服务作为本地系统帐户运行。我可以使用以下代码从我用来执行模拟的服务中获取模拟级别的 Windows 令牌：

```
using (wi = S4UClient.UpnLogon(upn))
{
    using(WindowsImpersonationContext wic2 = wi.Impersonate())
    {
     //code to access windows shares
    }  
} 
```

该服务正在正确返回令牌并且模拟成功，当我使用以下代码返回当前登录用户的身份时：

```
WindowsIdentity.GetCurrent().Name; 
```

我正在获取登录到共享点的用户的用户名。

问题是尝试访问网络资源时出现“拒绝访问”错误。问题很明显是因为通过 c2wts 进行的模拟，因为当我使用以下代码提供实际凭据（登录名和密码）来模拟用户时：

```
 [DllImport("advapi32.dll", SetLastError = true)]
    private static extern Int32 LogonUser(string lpszUsername, string lpszDomain, string lpszPassword, Int32 dwLogonType, Int32 dwLogonProvider, ref IntPtr phToken);

    [DllImport("advapi32.dll", SetLastError = true)]
    private static extern Int32 ImpersonateLoggedOnUser(IntPtr hToken);

private static IntPtr ImpersonateUser(string user, string domain, string password)
    {
        IntPtr lnToken = new IntPtr(0);
        Int32 TResult = LogonUser(user, domain, password, LOGON32_LOGON_NETWORK_CLEARTEXT, LOGON32_PROVIDER_WINNT50, ref lnToken);

        if (TResult > 0)
        {
            ImpersonateLoggedOnUser(lnToken);
        }

        return lnToken;
    } 
```

我能够毫无问题地枚举服务器上的共享。

根据我在 Internet 上找到的信息，要正确配置服务以访问另一台服务器上的 sql 数据库，我需要在 Active Directory 中启用协议转换和约束委派，并将该约束设置为 mysql 服务。我仍然不确定在这种情况下如何启用委派，因为我想要实现的是能够访问任何机器上的任何共享，只要用户有权这样做。

总而言之，我想从基于 Sharepoint 声明的身份验证 WebApplication 中模拟用户以访问其他计算机上的网络共享，但即使使用 c2wts 进行艰难的模拟似乎也是成功的（检查当前用户名时返回正确的用户名）我无法访问另一台计算机上的资源。另一方面，当使用代码中直接提供的登录名和密码进行模拟时，一切正常，但这对我来说不是一个选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:14:03.007

好的，我实际上设法解决了它。

我所做的是将我的 web 应用程序的 web.config 中的模拟设置为 false：

```
<identity impersonate="false" /> 
```

在那种情况下，我能够看到本地共享上的文件。为了在其他计算机上启用访问权限，我必须为运行我的 web 应用程序的帐户创建服务主体名称 (SPN)。

```
SETSPN -A HTTP/ServerName myDomain\webAppAccountUserName
SETSPN -A HTTP/FQDNServerName myDomain\webAppAccountUserName 
```

以及运行 webapplication 和 c2wts（c2wts 作为 LocalSystem）运行的计算机的 SPN

```
SETSPN -A HOST/ServerName ServerName 
SETSPN -A HOST/FQDNServerName ServerName 
```

下一步是配置约束委派和协议转换，以便我们可以委派到另一台计算机上的文件共享，我们需要打开 Active Directory 用户和计算机工具并为 c2wts 正在工作的 Web 应用程序帐户和计算机帐户配置委派上。具体来说，我们需要：

*   选择我们感兴趣的账户，比如电脑账户，
*   右键点击，
*   选择属性，
*   选择委派选项卡，
*   选择“信任此计算机仅委托给指定的服务”和“使用任何身份验证协议”，
*   **从我们要连接**的计算机中添加“通用 Internet 文件系统 (cifs)”

 **我们需要对 webapp 账户做同样的事情

设置值“信任此计算机以委派任何服务”将不起作用！**

# javascript - 正则表达式与但不是正则表达式

> ID：13622702
> 
> 赞同：2
> 
> 时间：2012-11-29T09:35:01.527
> 
> 标签：javascript, regex

我试过这个正则表达式：

```
(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d 
```

在文本类型的输入中，它可以正常工作：

```
<input type="Text" pattern="(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d"  title="Must be DD.MM.YYYY (ex: 29.11.2012)" class="std_input_long" id="toDate"> 
```

但是，当我尝试使用正则表达式对象在 JavaScript 中执行此操作时，它不起作用，任何人都可以解决这个问题。

JavaScript：

```
var regex = new RegExp('(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d');
var startDate = "23.11.2012";
var endDate = "11.12.2012";
var bStartDate = regex.test(startDate);
alert(bStartDate);
if (bStartDate) {
    var bendDate = regex.test(endDate);
    alert(bendDate);
    if (bendDate) {
        alert('both correct')
    } else {
        alert('End date incorrect must be DD.MM.YYYY \n\n\
               Example: 29.11.2012');
    }
} else {
    alert('Start date incorrect must be DD.MM.YYYY \n\n\
               Example: 29.11.2012');
}​ 
```

这是一个[JSfiddle](http://jsfiddle.net/sXPBX/)进行试验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:36:14.317

它应该是

```
var regex = /(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d/; 
```

字符串文字在传递给正则表达式引擎之前要经过解释，例如`'\.'`，`/./`与`'\d'``/d/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:59:19.350

您需要转义正则表达式字符串中的反斜杠：

```
"(0[1-9]|[12][0-9]|3[01])\\.(0[1-9]|1[012])\\.(19|20)\\d\\d" 
```

但是，使用正则表达式文字更容易，例如：

```
/(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d/.test("23.11.2012") 
```

或使用字符串方法：

```
"23.11.2012".match(/(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d/) 
```

# lua - Corona Lua 分析器

> ID：13622704
> 
> 赞同：0
> 
> 时间：2012-11-29T09:35:04.237
> 
> 标签：lua, profiling, profiler, coronasdk

我正在使用 Lua Corona SDK 制作一些游戏并尝试优化我的代码。是否有免费的分析器可以用来集中我的优化注意力？

我看到有一个名为 Corona Profiler 的工具，但它需要一些钱。我可以使用标准 Lua Profiler 吗？有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T12:38:31.823

不幸的是，您需要使用 Corona Profiler，或者编写自己的标准 lua 分析器，我测试过的这些分析器有一些 Corona 没有提供的需求，或者它们没有正确分析某些东西（即：Corona Obj-C/Java 代码正在运行做事，特别是在 GPU 上）。

我自己买了 Corona Profiler，我必须说它有点好，不是很好，但它有点帮助。

诚然，我认为如果您编写自己的分析器，您将无法轻松匹配 Corona Profiler，他们对 Corona 进行了一些广泛的逆向工程以了解某些内容的含义（我认为他们在 Coronalabs 的支持下做到了）

# python - 如何保护自己免受 gzip 或 bzip2 炸弹的伤害？

> ID：13622706
> 
> 赞同：21
> 
> 时间：2012-11-29T09:35:06.797
> 
> 标签：python, security, gzip, bzip2

这与[有关 zip 炸弹](https://stackoverflow.com/questions/1459080/how-can-i-protect-myself-from-a-zip-bomb)的问题有关，但要考虑 gzip 或 bzip2 压缩，例如接受`.tar.gz`文件的 Web 服务。

Python 提供了一个方便的[tarfile 模块](http://docs.python.org/2/library/tarfile.html)，使用起来很方便，但似乎没有提供针对 zipbombs 的保护。

在使用 tarfile 模块的 python 代码中，检测 zip 炸弹最优雅的方法是什么，最好不要从 tarfile 模块复制太多逻辑（例如透明解压缩支持）？

而且，只是为了让它不那么简单：不涉及真正的文件；输入是一个类似文件的对象（由 Web 框架提供，代表用户上传的文件）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-24T17:39:02.067

您可以使用[`resource`模块](http://docs.python.org/2/library/resource.html)来限制您的进程及其子进程可用的资源。

如果您需要在内存中解压缩，那么您可以设置`resource.RLIMIT_AS`（或`RLIMIT_DATA`, `RLIMIT_STACK`），例如，使用上下文管理器将其自动恢复到以前的值：

```
import contextlib
import resource

@contextlib.contextmanager
def limit(limit, type=resource.RLIMIT_AS):
    soft_limit, hard_limit = resource.getrlimit(type)
    resource.setrlimit(type, (limit, hard_limit)) # set soft limit
    try:
        yield
    finally:
        resource.setrlimit(type, (soft_limit, hard_limit)) # restore

with limit(1 << 30): # 1GB 
    # do the thing that might try to consume all memory 
```

如果达到限制；`MemoryError`被提出。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-23T15:42:45.367

这将确定 gzip 流的未压缩大小，同时使用有限的内存：

```
#!/usr/bin/python
import sys
import zlib
f = open(sys.argv[1], "rb")
z = zlib.decompressobj(15+16)
total = 0
while True:
    buf = z.unconsumed_tail
    if buf == "":
        buf = f.read(1024)
        if buf == "":
            break
    got = z.decompress(buf, 4096)
    if got == "":
        break
    total += len(got)
print total
if z.unused_data != "" or f.read(1024) != "":
    print "warning: more input after end of gzip stream" 
```

提取时，它将返回对 tar 文件中所有文件所需空间的略微高估。长度包括那些文件，以及 tar 目录信息。

gzip.py 代码不控制解压缩的数据量，除了输入数据的大小。在 gzip.py 中，它一次读取 1024 个压缩字节。因此，如果您对未压缩数据的内存使用量最多约为 1056768 字节（1032 * 1024，其中 1032:1 是 deflate 的最大压缩比），您可以使用 gzip.py。这里的解决方案`zlib.decompress`与第二个参数一起使用，它限制了未压缩数据的数量。gzip.py 没有。

这将通过解码 tar 格式准确确定提取的 tar 条目的总大小：

```
#!/usr/bin/python

import sys
import zlib

def decompn(f, z, n):
    """Return n uncompressed bytes, or fewer if at the end of the compressed
       stream.  This only decompresses as much as necessary, in order to
       avoid excessive memory usage for highly compressed input.
    """
    blk = ""
    while len(blk) < n:
        buf = z.unconsumed_tail
        if buf == "":
            buf = f.read(1024)
        got = z.decompress(buf, n - len(blk))
        blk += got
        if got == "":
            break
    return blk

f = open(sys.argv[1], "rb")
z = zlib.decompressobj(15+16)
total = 0
left = 0
while True:
    blk = decompn(f, z, 512)
    if len(blk) < 512:
        break
    if left == 0:
        if blk == "\0"*512:
            continue
        if blk[156] in ["1", "2", "3", "4", "5", "6"]:
            continue
        if blk[124] == 0x80:
            size = 0
            for i in range(125, 136):
                size <<= 8
                size += blk[i]
        else:
            size = int(blk[124:136].split()[0].split("\0")[0], 8)
        if blk[156] not in ["x", "g", "X", "L", "K"]:
                total += size
        left = (size + 511) // 512
    else:
        left -= 1
print total
if blk != "":
    print "warning: partial final block"
if left != 0:
    print "warning: tar file ended in the middle of an entry"
if z.unused_data != "" or f.read(1024) != "":
    print "warning: more input after end of gzip stream" 
```

您可以使用它的变体来扫描 tar 文件中的炸弹。这样做的好处是在您甚至必须解压缩该数据之前就可以在标头信息中找到较大的尺寸。

至于 .tar.bz2 档案，Python bz2 库（至少从 3.3 开始）对于消耗过多内存的 bz2 炸弹不可避免地不安全。该`bz2.decompress`函数不提供第二个参数`zlib.decompress`。更糟糕的是，由于运行长度编码，bz2 格式的最大压缩率比 zlib 高得多。bzip2 将 1 GB 的零压缩为 722 字节。因此，即使没有第二个参数，您也无法`bz2.decompress`通过测量输入来测量输出。`zlib.decompress`对解压后的输出大小没有限制是 Python 接口的一个根本缺陷。

我查看了 3.3 中的 _bz2module.c 以查看是否有未记录的方式来使用它来避免此问题。没有其他办法了。那里的`decompress`函数只是不断增长结果缓冲区，直到它可以解压缩所有提供的输入。_bz2module.c 需要修复。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T10:06:25.803

如果你是为linux开发的，你可以在单独的进程中运行解压并使用ulimit来限制内存使用。

```
import subprocess
subprocess.Popen("ulimit -v %d; ./decompression_script.py %s" % (LIMIT, FILE)) 
```

请记住，decompression_script.py 应该在写入磁盘之前解压缩内存中的整个文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-23T11:15:02.757

我想答案是：没有简单的、现成的解决方案。这是我现在使用的：

```
class SafeUncompressor(object):
    """Small proxy class that enables external file object
    support for uncompressed, bzip2 and gzip files. Works transparently, and
    supports a maximum size to avoid zipbombs.
    """
    blocksize = 16 * 1024

    class FileTooLarge(Exception):
        pass

    def __init__(self, fileobj, maxsize=10*1024*1024):
        self.fileobj = fileobj
        self.name = getattr(self.fileobj, "name", None)
        self.maxsize = maxsize
        self.init()

    def init(self):
        import bz2
        import gzip
        self.pos = 0
        self.fileobj.seek(0)
        self.buf = ""
        self.format = "plain"

        magic = self.fileobj.read(2)
        if magic == '\037\213':
            self.format = "gzip"
            self.gzipobj = gzip.GzipFile(fileobj = self.fileobj, mode = 'r')
        elif magic == 'BZ':
            raise IOError, "bzip2 support in SafeUncompressor disabled, as self.bz2obj.decompress is not safe"
            self.format = "bz2"
            self.bz2obj = bz2.BZ2Decompressor()
        self.fileobj.seek(0)

    def read(self, size):
        b = [self.buf]
        x = len(self.buf)
        while x < size:
            if self.format == 'gzip':
                data = self.gzipobj.read(self.blocksize)
                if not data:
                    break
            elif self.format == 'bz2':
                raw = self.fileobj.read(self.blocksize)
                if not raw:
                    break
                # this can already bomb here, to some extend.
                # so disable bzip support until resolved.
                # Also monitor http://stackoverflow.com/questions/13622706/how-to-protect-myself-from-a-gzip-or-bzip2-bomb for ideas
                data = self.bz2obj.decompress(raw)
            else:
                data = self.fileobj.read(self.blocksize)
                if not data:
                    break
            b.append(data)
            x += len(data)

            if self.pos + x > self.maxsize:
                self.buf = ""
                self.pos = 0
                raise SafeUncompressor.FileTooLarge, "Compressed file too large"
        self.buf = "".join(b)

        buf = self.buf[:size]
        self.buf = self.buf[size:]
        self.pos += len(buf)
        return buf

    def seek(self, pos, whence=0):
        if whence != 0:
            raise IOError, "SafeUncompressor only supports whence=0"
        if pos < self.pos:
            self.init()
        self.read(pos - self.pos)

    def tell(self):
        return self.pos 
```

它不适用于 bzip2，因此部分代码被禁用。原因是它`bz2.BZ2Decompressor.decompress`已经可以产生不需要的大量数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-28T03:06:05.173

我还需要处理上传的 zip 文件中的 zip 炸弹。

我通过创建一个固定大小的 tmpfs 并解压缩到它来做到这一点。如果提取的数据太大，则 tmpfs 将耗尽空间并给出错误。

这是创建 200M tmpfs 以解压缩到的 linux 命令。

```
sudo mkdir -p /mnt/ziptmpfs
echo 'tmpfs   /mnt/ziptmpfs         tmpfs   rw,nodev,nosuid,size=200M          0  0' | sudo tee -a /etc/fstab 
```

# android - GMail 应用程序如何在 ActionBar 中实现其选择摘要？

> ID：13622709
> 
> 赞同：3
> 
> 时间：2012-11-29T09:35:18.653
> 
> 标签：android

当在 GMail 应用程序中选择删除电子邮件时，ActionBar 如下所示：

![在此处输入图像描述](../Images/c6c119e88fe633b663cd6ef612e0e64b.png)

显示复选标记和选择计数，并带有微妙的进入和退出动画。它似乎是位于 ActionBar 顶部或替换它的覆盖层。

因为我不知道这个小部件的名称，所以我很难找到有关它的信息。

*   它是 API 的一部分吗？Google 日历在创建事件时有类似的覆盖，这让我认为它可能是 API 的一部分。
*   如果是，它叫什么？
*   ActionBar 如何使用行选择计数进行更新？（无需代码，只需简要说明如何将内容写入图像中显示的 ActionBar 叠加层）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T11:12:50.453

为我自己的问题提供部分答案。希望这可以帮助某人。

从 Level 11 开始，它就是 API 的一部分，被称为 contextual [ActionMode](http://developer.android.com/reference/android/view/ActionMode.html)。这个想法是让用户在不离开`Activity`or的情况下执行一些特定的操作`Fragment`。参考文档是这样描述的：

> 表示用户界面的上下文模式。动作模式可用于提供替代交互模式并替换部分正常 UI 直到完成。

Android 开发人员对此有一个[部分](http://developer.android.com/guide/topics/ui/menus.html#context-menu)，说：

> 上下文操作模式在 Android 3.0（API 级别 11）及更高版本上可用，并且是在可用时显示上下文操作的首选技术

Lars Vogella 提供了一个[教程](http://www.vogella.com/articles/Android/article.html#tutorial_contextualmenu)，屏幕截图显示它与 GMail 应用程序中看到的覆盖相同。

这是来自 Android Developers 的屏幕截图（屏幕截图在 Apache 2.0 下获得许可）：

![在此处输入图像描述](../Images/edd9bff3e0d056f4693d934a0ba75b40.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:56:41.643

首先，它不是 API 的一部分，要更新操作栏中的计数，只需在检查时添加一个侦听器以增加计数，在取消检查时减少计数，如此简单:)

**更新**

或者，您可以使用此自定义[操作栏](http://actionbarsherlock.com/)

# mysql - Mysql 空间扩展。如何检查线串是否包含点？

> ID：13622712
> 
> 赞同：1
> 
> 时间：2012-11-29T09:35:33.680
> 
> 标签：mysql, spatial, spatial-index

我正在尝试确定 Linestring 是否有 Point.... fe

```
SET ls = geomfromtext('LINESTRING(1 0,3 0)');
SET p = geomfromtext('POINT(2 0)'); 
```

如果我这样做，`CONTAINS(ls,p)`我有真实的。但是没有点（2 0）在行

我需要完全包含。它有什么功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:50:13.027

我尝试了文档中的所有功能，但没有一个能满足我的需要。铁

```
SELECT ASTEXT(path) FROM paths WHERE INTERSECTS(path, GEOMFROMTEXT('POINT(604 0)')) 
```

给出“错误”的结果

```
LINESTRING(572 0,600 0,601 0,602 0,603 0,604 0,605 0,606 0,607 0,608 0,402 0)
LINESTRING(402 0,609 0,610 0,611 0,612 0,613 0,614 0,615 0,616 0,617 0,618 0,619 0,620 0,621 0,622 0,623 0)
LINESTRING(359 0,449 0,801 0,422 0,802 0,803 0,498 0)
LINESTRING(572 0,795 0,796 0,797 0,798 0,799 0,800 0,345 0,359 0)
LINESTRING(792 0,768 0,793 0,794 0,572 0)
LINESTRING(342 0,904 0,905 0,906 0)
LINESTRING(912 0,914 0,915 0,916 0,341 0)
LINESTRING(344 0,917 0,918 0,919 0,920 0,800 0)
LINESTRING(918 0,922 0,923 0,924 0,925 0,926 0,927 0,343 0)
LINESTRING(940 0,947 0,948 0,949 0,604 0) 
```

MBRWITHIN 给出相同的结果

我写了一个函数，但它非常非常慢：

```
FUNCTION `IDIL`(`id` INT, `line` LINESTRING) RETURNS INT(1)
    NO SQL
    DETERMINISTIC
BEGIN
DECLARE n INT DEFAULT 0; 
DECLARE p1X INT(20); 
DECLARE p1Y INT(20); 
DECLARE p1 POINT; 
DECLARE i INT DEFAULT 0; 
DECLARE result INT(1) DEFAULT 0; 
SET n = NUMPOINTS(line); 
WHILE i<n DO 
    SET p1 = POINTN(line, (i+1)); 
    SET p1X = X(p1); 
    SET p1Y = Y(p1); 
    IF p1X=id OR p1Y=id THEN RETURN 1; END IF; 
    SET i = i + 1; 
END WHILE; 
RETURN result; 
    END$$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:19:58.200

你能看看[这篇文章的以下参考吗](http://www.tu-chemnitz.de/docs/mysql-man/manual_GIS_spatial_extensions_in_MySQL.html)

*   [SQLFIDDLE](http://sqlfiddle.com/#!2/84420/1)

    `SET @ls = 'LineString(1 0,3 0)';`

    `SET @xs = geomfromtext(@ls);`

    `SET @p = geomfromtext('POINT(2 0)');`

    `SELECT MBRWithin(@xs,@p);`

对不起，我给出了错误的链接。

结果

```
MBRWITHIN(@XS,@P)
0 
```

看着你的线 1 0, 3 0 --> 2 0 点存在于它上面。

![在此处输入图像描述](../Images/5ac918b0a2068968f89cba8459268ddc.png)

# spring - JBoss - 自动装配列表 - @Resource，@Inject 抛出 NoSuchBeanDefinitionException

> ID：13622718
> 
> 赞同：0
> 
> 时间：2012-11-29T09:35:49.740
> 
> 标签：spring, jboss, autowired

环境 - JBoss 5.1、Spring 3.1.2、jdk 1.5

我正在尝试自动装配列表。根据此处的讨论[Auto-wiring a List using util schema 会给出 NoSuchBeanDefinitionException](https://stackoverflow.com/questions/1363310/auto-wiring-a-list-using-util-schema-gives-nosuchbeandefinitionexception)，@Resource 不适用于 JBoss。

```
<util:list id="reportTypes">
  <value>PDF</value>
  <value>CSV</value>
  <value>XML</value>
</util:list>

@Inject
private List<String> reportTypes; 
```

我也尝试过使用@Inject，但我得到了同样的异常。我错过了什么？

我正在为@Inject 使用 JSR 330，com.springsource.javax.inject-0.9.0.PFD.jar 文件，如此处所述[http://forum.springsource.org/showthread.php?78737-JSR-330-Inject -春天-3-0](http://forum.springsource.org/showthread.php?78737-JSR-330-Inject-Spring-3-0)

```
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException:
No matching bean of type [java.lang.String] found for dependency 
[collection of java.lang.String]: expected at least 1 bean which qualifies as autowire
candidate for this dependency. Dependency annotations: {@javax.inject.Inject()} 
```

**编辑**使用

```
@Resource(name = "reportTypes")
private List<String> reportTypes; 
```

投掷

```
java.lang.RuntimeException: mapped-name is required for reportTypes of deployment app.war 
at org.jboss.web.tomcat.service.injection.WebResourceHandler.loadXmlResourceEnvRefs(WebResourceHandler.java:287)
at org.jboss.web.tomcat.service.injection.WebResourceHandler.loadXml(WebResourceHandler.java:325)
at org.jboss.web.tomcat.service.TomcatInjectionContainer.processMetadata(TomcatInjectionContainer.java:550)
at org.jboss.web.tomcat.service.WebCtxLoader.start(WebCtxLoader.java:158) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:41:23.680

我自己曾多次与这个问题作斗争。除了我已经开始使用 @Inject @Named 对这一事实之外，我对您的问题没有确切的答案。这似乎在大多数情况下都有效。

@Resource 不起作用的原因，据我所知，不是 jboss 本身的错，而是 jboss 捆绑的 tomcat 版本的错。

# sharepoint - 通过 Web 服务填充共享点查找列

> ID：13622720
> 
> 赞同：0
> 
> 时间：2012-11-29T09:35:58.133
> 
> 标签：sharepoint, sharepoint-2007

我正在尝试通过 Web 服务填充列表中的查找列。我从 asp.net Web 表单获取数据并使用 Web 服务方法 UpdateListItems 并发送批处理 XML。但是，除非用户输入查找使用的确切数据，否则 Web 服务会返回错误。

无论如何，我可以为网络表单的用户提供类似的查找功能，以便传递的数据相同吗？

我正在使用共享点 2007 共享点中查找列的数据源是活动目录。_x0028_HR_x0029__x0020_Partner 是查找列，输入用户登录名将查找他们的全名/您可以从列表中选择。

非常感谢您的帮助。

```
 ClasService.Lists NewStarterList = new ClasService.Lists();
        NewStarterList.Credentials = new System.Net.NetworkCredential(ConfigurationManager.AppSettings["SPUserName"].ToString(),
            ConfigurationManager.AppSettings["SPPassword"].ToString(), ConfigurationManager.AppSettings["SPDomain"].ToString());

        NewStarterList.Url = ConfigurationManager.AppSettings["SPUrl"].ToString() + ConfigurationManager.AppSettings["SPServicePath"].ToString();

        try
        {
            string strBatch = "<Method ID='1' Cmd='Update'>" +
                "<Field Name='ID'>" + clasStarter.ClasID + "</Field>" +
                "<Field Name='Title'>" + clasStarter.Name + "</Field>" +
                "<Field Name='_x0028_HR_x0029__x0020_Job_x0020'>" + clasStarter.JobTitle + "</Field>" +
                "<Field Name='Entity'>" + clasStarter.Entity + "</Field>" +
                "<Field Name='Practice_x0020_Groups'>" + clasStarter.PracticeGroup + "</Field>" +
                "<Field Name='Dept'>" + clasStarter.Department + "</Field>" +
                "<Field Name='Physical_x0020_Desk_x0020_Locati'>" + clasStarter.Location + ", " + clasStarter.LocationInBuilding + ", " + clasStarter.Department + "</Field>" +
                "<Field Name='_x0028_HR_x0029__x0020_Line_x002'>" + clasStarter.LineManager + "</Field>" +
                "<Field Name='_x0028_HR_x0029__x0020_Buddy'>" + clasStarter.Buddy + "</Field>" +
                "<Field Name='_x0028_HR_x0029__x0020_Partner'>" + clasStarter.Partner + "</Field>" +//is a look up

                "</Method>";

            XmlDocument xmlDoc = new System.Xml.XmlDocument();

            System.Xml.XmlElement elBatch = xmlDoc.CreateElement("Batch");

            elBatch.SetAttribute("OnError", "Continue");
            elBatch.SetAttribute("ListVersion", "1");
            elBatch.SetAttribute("ViewName", ConfigurationManager.AppSettings["SPViewID"].ToString());

            elBatch.InnerXml = strBatch;

            XmlNode ndReturn = NewStarterList.UpdateListItems(ConfigurationManager.AppSettings["SPListID"].ToString(), elBatch);

        }
        catch (Exception exp)
        {
            throw new Exception("NewStarterForm - Clas Update failed ", exp);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:12:41.777

我还没有想出一个完整的解决方案我的问题，但我已经想出了它的一部分。

共享点查找列有两个部分，一个 id 和一个值。如果您不知道该值，那么您可以使用 -1;# 作为 ID 的替代品

这方面的一个例子是

```
"<Field Name='Partner'>-1;#" + partnerLogOnId + "</Field>" 
```

我可能会使用一个列表，允许我的表单的用户选择人员，并将 partnerLogOnId 传递给我的 Web 服务方法。

# php - file_get_contents 在本地主机上工作，但在服务器上超时

> ID：13622722
> 
> 赞同：2
> 
> 时间：2012-11-29T09:36:00.190
> 
> 标签：php, timeout, file-get-contents

我有这个代码：

```
$feed = 'urltorss';
$feeds =  new SimpleXmlElement( file_get_contents($feed) );

$feed = 'http://www.businessweek.com/feeds/homepage.rss';
$feeds =  new SimpleXmlElement( file_get_contents($feed) ); 
```

现在**两个**url 都没有任何特殊字符需要对它们进行 url 编码，但是第二个 url`.rss`如果相关，则具有扩展名。

第一次调用有效，当我在我的服务器上尝试时，我在第二次超时，但在 localhost 上完美运行。

这是我得到的错误：

```
 Severity: Warning

Message: file_get_contents('http://www.businessweek.com/feeds/homepage.rss')
[function.file-get-contents]: 
failed to open stream: Connection timed out

Filename: controllers/mailsystem.php

Line Number: 36 
```

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:41:39.267

首先，检查您的路径，
`echo $feed; // just for debug`
然后检查内容
`$content = @file_get_contents($feed);`
，最后，获取 XML
`if( $content ) { $feeds = new SimpleXmlElement( file_get_contents($feed) ); }`

编辑：URL 的 file_get_contents 仅在您有 allow_url_fopen = 1 时才有效。获取[http://www.businessweek.com/feeds/的内容homepage.rss](http://www.businessweek.com/feeds/homepage.rss)你需要一个获取内容的 cURL 函数。类似[http://davidwalsh.name/curl-download](http://davidwalsh.name/curl-download)

# regex - 需要一个正则表达式

> ID：13622723
> 
> 赞同：1
> 
> 时间：2012-11-29T09:36:04.417
> 
> 标签：regex

我需要一个正则表达式来从此字符串中获取 MyName （ MyName 可能包含除 " 之外的任何字符）：

```
lablabla name="MyName" user="MyUser" lablabla 
```

我用了：

```
boost::regex reg(".*name=\"(?<action>.*)\"\\s.*", boost::regex::perl); 
```

但它返回：

```
MyName" user="MyUser 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:38:11.390

怎么样：

```
boost::regex reg(".*name=\"(?<action>.*?)\"\\s.*", boost::regex::perl); 
```

这使它变得不贪心；或者：

```
boost::regex reg(".*name=\"(?<action>[^\"]*)\"\\s.*", boost::regex::perl); 
```

它明确指定操作不能包含双引号。

# wpf - 在 BackgroundWorker.DoWork 上旋转图像

> ID：13622726
> 
> 赞同：0
> 
> 时间：2012-11-29T09:36:17.780
> 
> 标签：wpf, image, rotation, backgroundworker, eventtrigger

我有一个可以根据需要工作的后台工作人员。但是我希望我的视图中的图像从调用 backgroundworker.DoWork 到调用 backgroundworker.completed 的那一刻持续旋转。

我已经尝试了一些事件触发器，但我无法让它工作。关于我如何处理这个问题的任何建议？

我使用 c#、wpf、.Net 4.0、MVVM。

BR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:42:28.307

DoWork 不是访问 UI 元素的最佳位置，因为它不是在 UI 线程中触发的，您应该使用 ProgressChanged 事件

我建议为它创建[RotateTransform](http://msdn.microsoft.com/en-us/library/system.windows.media.rotatetransform.aspx)和[StoryBoard](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.storyboard.aspx)

```
<Window.Resources>
        <Storyboard x:Key="sbdRotation">
            <DoubleAnimation
            Storyboard.TargetName="image"
            Storyboard.TargetProperty="(Image.LayoutTransform).(RotateTransform.Angle)"
            By="6" Duration="0:0:0.2"
            RepeatBehavior="1x"/>
        </Storyboard>
</Window.Resources>

...
<Image Name="image" Width="50" Height="50" Source="OK.png">
        <Image.LayoutTransform>
            <RotateTransform CenterX="0.5" CenterY="0.5" />
        </Image.LayoutTransform>
</Image> 
```

在 ProgressChanged 事件中，使用[FindResource](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.findresource.aspx) ("sbdRotation") 找到 StoryBoard；并调用[开始](http://msdn.microsoft.com/en-us/library/cc190590.aspx)

# jquery - jQueryMobile：获取页面加载失败的结果

> ID：13622729
> 
> 赞同：1
> 
> 时间：2012-11-29T09:36:25.260
> 
> 标签：jquery, jquery-mobile

我当前的链接导致 404 这是正确的行为。

现在服务器返回我想用作页面的html代码。

```
$(document).bind('pageloadfailed', function(e, data) {
    // use html from 404 result as var page that should be displayed now
    data.deferred.reject(data.absUrl, data.options, page);
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:44:09.773

从[W3C 上的 XMLHttpRequest 帮助页面](http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp)和检查 jQuery Mobile 代码，我想说应该可以这样：

```
$(document).bind('pageloadfailed', function(e, data) {
    // use html from 404 result as var page that should be displayed now
    var htmlSource = data.xhr.responseText; // this should contain your page source
    data.deferred.reject(data.absUrl, data.options, page);
    return false;
}); 
```

# javascript - jQuery 自动将 div 定位在屏幕中心

> ID：13622737
> 
> 赞同：1
> 
> 时间：2012-11-29T09:36:51.310
> 
> 标签：javascript, jquery, html

我有这个 jQuery 函数：

```
 $(window).resize(function(){
  $('#modal').css({
    left: ($(window).width() - $('#modal').outerWidth())/2,
    top: ($(window).height() - $('#modal').outerHeight())/2
  });
}); 
```

这就是我需要做的：“在窗口调整大小时将 div 放在屏幕的中心”。唯一的问题是，当我将窗口缩小到足够（400-500 像素）或从低分辨率设备（手机）访问网页时，标题会超出边界，您再也看不到它了。

为什么会发生这种情况以及如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:41:51.107

您可以添加一个小测试：

```
$(window).resize(function(){
  var topPos = ($(window).height() - $('#modal').outerHeight())/2;

  $('#modal').css({
    left: ($(window).width() - $('#modal').outerWidth())/2,
    top: topPos > 0 ? topPos : 0
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:43:22.363

此功能可能会有所帮助：

```
function setToCenterOfParent( obj, parentObj ) {
    var height = $( obj ).height();
    var width = $( obj ).width();
    if ( parentObj == window ) {
        $( obj ).css( 'top', ( $( parentObj ).height() / 2 ) - ( height / 2 ) );
        $( obj ).css( 'left', ( $( parentObj ).width() / 2 ) - ( width / 2 ) );
    }
    else {
        $( obj ).css( 'top', ( $( parentObj ).height() / 2 ) - ( height / 2 ) + $( parentObj ).position().top );
        $( obj ).css( 'left', ( $( parentObj ).width() / 2 ) - ( width / 2 ) + $( parentObj ).position().left );
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:44:18.373

如果窗口小于模态窗口，您将进入负值。重要的是考虑在这种情况下应该发生什么。我通常停止定位窗口并让模态覆盖整个窗口：使用 CSS 媒体查询，我从定义的 px 值更改模态大小以匹配屏幕大小的相对值。

```
 #modal {
      width: 500px;
   }

    @media only screen and (max-width: 500px) {
      #modal { 
          width: 100%;
      }
    } 
```

# dotnetnuke-5 - 如何禁用 DNN 5 新用户注册电子邮件给管理员？

> ID：13622739
> 
> 赞同：0
> 
> 时间：2012-11-29T09:36:51.897
> 
> 标签：dotnetnuke-5

有没有办法在 DNN 5 上关闭向管理员发送新用户注册的电子邮件通知？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:36:51.897

唯一的解决方案是在 DNN“用户管理”中编辑 ADMIN 用户并将电子邮件地址更改为另一个，即别名。

然后您可以在您的邮件客户端上创建一个规则。

此解决方案适用于旧 DNN 安装 5.X。

# jquery - 动态分配“活动”类

> ID：13622746
> 
> 赞同：0
> 
> 时间：2012-11-29T09:37:14.257
> 
> 标签：jquery, html, css

我想为类动态分配不同的链接`"active"`以更改 CSS。有谁知道如何做到这一点？

```
<div class="livello2">
    <div class="live">
        <a href="./Live.php"><img src="templates/css/comp/pulsante_live_off.png"></a>
    </div>
    <nav class="menu">
        <ul>
            <a href="./index.php"><li>HOME</li></a>
            <a href="./Concerti.php"><li>CONCERTI</li></a>
        </ul>
    </nav>
</div> 
```

* * *

我有这个：

```
<div class="livello2">
                 <div class="live">
                     <a href="./Live.php"><img src="templates/css/comp/pulsante_live_off.png"></a>
                 </div>
                 <nav class="menu">
                     <ul>
                         <a href="./index.php"><li>HOME</li></a>
                         <a href="./Concerti.php"><li>CONCERTI</li></a>

                     </ul>
                 </nav>
       </div> 
```

我认为 jquery 脚本应该是这样的：

```
click(function(){
   $link.removeClass('active');
    $link2.addClass('active');
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:43:43.167

```
document.getElementById("yourElementsId").classList.toggle("active"); 
```

这首先通过其 id 获取您希望修改的项目，然后简单地切换“活动”类。您还可以使用以下方法：

```
classList.add("active");
classList.remove("active"); 
```

* * *

要在 jQuery 中执行此操作，您只需执行以下操作：

```
$("#yourElementsId").addClass("active");
$("#yourElementsId").removeClass("active");
$("#yourElementsId").toggleClass("active"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:43:14.953

此解决方案假定您要向菜单链接添加“活动”：

HTML：

```
<div class="livello2">
    <div class="live">
        <a href="./Live.php"><img src="templates/css/comp/pulsante_live_off.png"></a>
    </div>
    <nav class="menu">
        <ul>
            <li><a href="./index.php">HOME</a></li>
            <li><a href="./Concerti.php">CONCERTI</a></li>
        </ul>
    </nav>
</div> 
```

jQuery：

```
$(function() {
    $('.menu a').click(function(e) {
        // you usually want to prevent default for handling link clicks,
        // otherwise the browser follows the href (if that's intended skip this)
        e.preventDefault();

        $('.menu a').not(this).removeClass('active');
        $(this).addClass('active');
    });
}); 
```

# c# - 批量编辑 ISingleResult

> ID：13622748
> 
> 赞同：0
> 
> 时间：2012-11-29T09:37:16.297
> 
> 标签：c#, asp.net-mvc, edit

我有一个存储过程，我在视图中显示以进行编辑。我做了一个强类型的存储过程。当我编辑字段然后按保存按钮时，参数“cm”始终为空。它没有显示列表，而只是显示 1 条记录。

自定义模型：

```
public class CustomModel
    {
        public string Description { get; set; }
        public System.Data.Linq.ISingleResult<GetItems_ListResult> ItemList { get; set;}
    } 
```

控制器的这一部分将其发送到视图：

```
 public ActionResult Details(int id)
 {
    var row = dataContext.Items.FirstOrDefault(x => x.ItemID == id);
    var cm = new CustomModel();
    cm.ItemList = dataContext.GetItem_List(row);
    cm.Description = row.Description;

    return View(cm);
 } 
```

这个控制器从视图接收数据：

```
[HttpPost]
public ActionResult UpdateItems(CustomModel cm)
{

   return RedirectToAction("Index");
} 
```

这是视图：

```
@model TestWeb.Models.CustomModel

@using (Html.BeginForm("UpdateItems", "Item", FormMethod.Post))
{

     <table>
            <tr>
                <th>Name</th>
                <th>Description</th>
            </tr>
        @foreach (var p in Model.ItemList.ToList())
        {
            <tr>
                <td>
                    @Html.HiddenFor(mdl => p.ItemId)
                </td>
                <td>@p.Name</td>
                <td>
                    @Html.EditorFor(mdl => p.Description)
                </td>
            </tr>
        }
    </table>

    <p>
        <input type="submit" value="save" />
    </p>
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:20:52.800

尝试以下操作：

做一个`GetItems_ListResult.cshtml`这样的：

```
<tr>
 <td>
    @Html.HiddenFor(mdl => mdl.ItemId)
 </td>
  <td>@Model.Name</td>
 <td>
    @Html.EditorFor(mdl => mdl.Description)
 </td>
</tr> 
```

然后在你的 for 循环中这样做：

```
@for (int i = 0; i < Model.ItemList.Count(); i++)
{
   @Html.EditorFor(m => m.ItemsList[i])
} 
```

**更新：**我没有注意到您使用的是 ISingleResult。你可以这样做：

```
//Since it'll have none or one element..
if(Model.ItemList != null  && Model.ItemList.Any())
{
  @Html.EditorFor(m => m.ItemList.First())
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:16:48.047

你读过这篇博文吗？[http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/) Steve 涵盖了在 asp mvc 中的编辑列表。

一旦你阅读了这个 nuget 包[http://nuget.org/packages/BeginCollectionItem](http://nuget.org/packages/BeginCollectionItem)

# c# - 如何在 Main() 方法之前在 C# 中运行静态初始化方法？

> ID：13622754
> 
> 赞同：22
> 
> 时间：2012-11-29T09:37:38.120
> 
> 标签：c#, .net, static-methods, static-classes, static-initialization

给定一个带有初始化方法的静态类：

```
public static class Foo
{
    // Class members...

    internal static init()
    {
        // Do some initialization...
    }
} 
```

如何确保初始化程序在之前运行`Main()`？

我能想到的最好的方法是将其添加到`Foo`：

```
private class Initializer
{
    private static bool isDone = false;
    public Initializer()
    {
        if (!isDone)
        {
            init();
            isDone = true;
        }
    }
}

private static readonly Initializer initializer = new Initializer(); 
```

这会起作用还是有一些不可预见的警告？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-29T09:40:25.627

只需在[静态构造函数](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-constructors)中为`Foo`.

从文档中：

> 在创建第一个实例或引用任何静态成员之前，会自动调用静态构造函数来初始化类。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-29T09:46:41.917

您可以使用 C#中的[静态构造函数。](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-constructors)

```
public static class Foo
{
    // Class members...

    static Foo(){
        init();
        // other stuff
    }

    internal static init()
    {
        // Do some initialization...
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-29T09:45:57.670

将代码从`internal static`方法移动到[`static`构造函数](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-constructors)，如下所示：

```
public static class Foo
{
  // Class members...

  static Foo()
  {
    // Do some initialization...
  }
} 
```

这样，您可以确定静态构造函数将在第一次提及您的`Foo`类时运行，无论是实例的构造还是对静态成员的访问。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-12-10T21:19:07.883

将初始化代码放在类的静态构造函数中

```
static Foo()
{
    // Initialization code
} 
```

此构造函数在第一次访问该类时运行。

您可以`RunClassConstructor`在使用类之前触发类的静态构造函数。例如，如果此类将自身注册到 IOC 容器或类似的东西中，这将很有用。

```
RuntimeHelpers.RunClassConstructor(typeof(Foo).TypeHandle); 
```

您可以`RuntimeHelpers`在`System.Runtime.CompilerServices`命名空间中找到 。

C# 9.0 添加了[模块初始化](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/module-initializers)程序，允许您为程序集编写初始化代码，而无需显式调用任何内容。

将该`[ModuleInitializer]`属性应用于静态 void 无参数方法以使其成为模块初始化程序。

```
[ModuleInitializer]
internal static void MyAssemblyInitializer()
{
    // ...
} 
```

# uinavigationcontroller - 如何在 UINavigationController 上设置 backgroundColor (tintColor)

> ID：13622757
> 
> 赞同：0
> 
> 时间：2012-11-29T09:37:47.707
> 
> 标签：uinavigationcontroller, xcode4.3, xcode4.5, tintcolor

我希望你能帮我设置控制器的背景颜色。

奇怪的是，当我在 Xcode 4.5.2 中构建代码时，它看起来如下图所示。如您所见，背景颜色消失了，它应该是（黄色）作为下一张图片 ![使用 Xcode 4.5.2 构建](../Images/752dc2ca84535e456ccdf08650c2e1d2.png)

当我在 Xcode 4.3.3 中构建代码时，它如下图所示。这就是它应该的样子。 ![使用 Xcode 4.3.3 构建](../Images/ffc78a188ee92ef2953772bdb4c163b6.png)

我的代码是这样的：

------------------InstantCabAppDelegate.m 文件-----------开始-------

```
//InstantCabAppDelegate.m file

orderController = [[OrderController2 alloc] initWithNibName:@"Order2" bundle:nil];
UINavigationController* firstnavigationController = [[UINavigationController alloc] initWithRootViewController:orderController]; 
```

------------------OrderController2.m 文件-----------开始-------

```
//OrderController2.m file

- (void)viewDidLoad 
{   
    [super viewDidLoad];

    [self.tableView setBackgroundColor:TABLE_VIEW_BACKGROUND_COLOR];
    [self.tableView setSeparatorColor:TABLE_VIEW_SEPARATOR_COLOR];
    [self.tableView setSeparatorStyle:UITableViewCellSeparatorStyleSingleLine];

    self.parentViewController.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"background-nologo"]];

    UIView *logoParentView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.tableView.frame.size.width, 75)];
    UIImageView *logoView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"logo_order_page"]];
    CGRect logoViewFrame = logoView.frame;
    logoViewFrame.origin.x = (self.view.frame.size.width / 2) - (logoViewFrame.size.width / 2);
    logoViewFrame.origin.y = 8;
    [logoView setFrame:logoViewFrame];
    [logoParentView addSubview:logoView];

    self.tableView.tableHeaderView = logoParentView;
    self.tableView.rowHeight = 50;

    [self.navigationController.navigationBar setTintColor:NAVIGATION_BAR_TINT_COLOR];

    [[MyLocation singleton] setDelegate:self];
    [self reset];

    UIView *footerView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.tableView.frame.size.width, 50)];

    UIButton *orderButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [orderButton setFrame:CGRectMake(5, 0, footerView.frame.size.width - 10, 50)];

    [orderButton setBackgroundImage:[UIImage imageNamed:@"yellow_btn"] forState:UIControlStateNormal];
    [orderButton setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
    [orderButton setTitle:AMLocalizedString(@"kOrderOrderTaxiAlt", @"") forState:UIControlStateNormal];

    [[orderButton titleLabel] setFont:[UIFont boldSystemFontOfSize:orderButton.titleLabel.font.pointSize]];
    [orderButton addTarget:self action:@selector(checkOrder) forControlEvents:UIControlEventTouchUpInside];
    [footerView addSubview:orderButton];
    [self.tableView setTableFooterView:footerView];

    isShowingModalViewController = NO;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T09:22:56.727

**I got this from Apple support:**

UITableView applies a background view to itself when the table view's style is set to UITableViewStyleGrouped. The background view is used to draw the default pattern associated with that style table view but it also covers any custom background color that has been set. You can remove this background view by calling self.tableView.backgroundView = nil; from within viewDidLoad. Doing so will make your custom background color visible again.

? Apple Inc. | Apple Developer Technical Support

# php - 如何获取从数据表单发布到当前页面的页面的 url（在 php 中）？

> ID：13622763
> 
> 赞同：1
> 
> 时间：2012-11-29T09:38:01.360
> 
> 标签：php, url, post

我想获取将数据发布到当前页面的 url。假设我在当前页面中捕获了一个数据，例如 -

```
$connect=$_POST['connect']; 
```

我想确保数据来自特定的 url，而不是来自其他任何地方。所以，我想从数据最初来自的地方获取该页面的 url。我怎样才能通过 php 做到这一点？

-谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:40:12.280

你可以看看`$_SERVER['HTTP_REFERER']`。但请注意，它不可靠，因为客户端可以轻松修改或完全忽略它（如果用户使用代理，则尤其如此）。

在这里查看详细信息：http: [//php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:40:35.273

你应该通过阅读推荐人来得到这个

```
$_SERVER['HTTP_REFERER']; 
```

但请注意：用户只需关闭提交引荐来源网址即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:41:01.067

尝试访问

```
$_SERVER['HTTP_REFERER']; 
```

那会成功的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T09:41:02.940

尝试这个

```
$_SERVER['HTTP_REFERER']; 
```

翻阅文件。。

[http://php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T11:16:40.917

根据**cem、Jan Hančič、Fredrik**和**bipen**的回答。

谢谢大家的帮助。最后我得到一个结论，我可以通过使用获取页面的 url（从表单数据发布到当前页面的位置） -

```
$url=$_SERVER['HTTP_REFERER']; 
```

但这不能完全信任，因为“http 标头”信息可能会被更改或被黑客入侵，或者用户可能使用代理服务器（参考：-

> “但请注意它不可靠，因为客户端可以轻松修改或完全忽略它（如果用户使用代理，则尤其如此”
> -Jan Hančič

） 或者

> “但请注意：用户可以简单地关闭提交推荐人。”
> -cem

. 而且我没有找到一种可以完全信任的方法来获取发布数据的网页的网址。在这种情况下，可以使用“https”，但不知道它的安全性如何，所以总是会为此头疼。

任何人帮助获得完全值得信赖的方式将不胜感激，也将被接受。

-太感谢了。

# mongodb - ReactiveMongo + TypeSafe Stack => 生产？

> ID：13622770
> 
> 赞同：4
> 
> 时间：2012-11-29T09:38:24.173
> 
> 标签：mongodb, playframework, playframework-2.0, typesafe-stack

我现在可以以某种方式将 ReactiveMongo 与 TypeSafe Stack 集成吗？据我所知，ReactiveMongo 需要 Play！2.1，它还没有准备好生产吗？有没有人有任何积极的经验？或者，如果我今天太梦幻了，那么也许对这个组合什么时候可行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T10:06:14.710

该组合有效。Play 2.1 在 RC1 中，所以它非常稳定，而 Reactive Mongo 是我在为实时应用程序切片面包以来看到的最好的想法。

也就是说，它还不是正式版本，所以在生产中使用它有一定的风险。如果您的应用程序是非关键或业余项目，请使用它，它会很好。否则，不要。

# c++ - C++ 未命名（匿名）命名空间定义

> ID：13622781
> 
> 赞同：7
> 
> 时间：2012-11-29T09:38:42.427
> 
> 标签：c++, namespaces

C++03 Standard 7.3.1.1 [namespace.unnamed] 第 1 段：（和 C++11 Standard 也使用类似的定义）

> 未*命名的命名空间定义的*行为就像它被替换为
> 
> ```
> namespace unique { /* empty body */ }
> using namespace unique;
> namespace unique { namespace-body } 
> ```

为什么不简单地遵循定义？

```
namespace unique { namespace-body }
using namespace unique; 
```

附带问题：[MSDN](http://msdn.microsoft.com/en-us/library/yct4x9k5.aspx)以后一种形式定义。它在技术上是否违反标准？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T10:08:29.307

你不能再这样做了

```
namespace { typedef int a; ::a x; } 
```

请注意，在随后的 中`namespace { ... }`，您突然可以。这将是非常不一致的。

还要注意这种情况，有两个不同的有效结果

```
namespace A { void f(long); }
using namespace A;

namespace { 
  void f(int);
  void g() {
    ::f(0);
  }
} 
```

对于 ISO C++，这调用`int`了`f`. 使用您的替代定义，它会调用`long`版本。

# iphone - 如何从 Web 服务显示 pdf 文档？

> ID：13622782
> 
> 赞同：0
> 
> 时间：2012-11-29T09:38:42.473
> 
> 标签：iphone, pdf

我从 Web 服务获取 NSString，使用 dataWithBase64EncodedString 方法将其转换为 NSData，然后使用以下代码将 NSData 转换为 pdf：

```
CFDataRef myPDFData = (__bridge CFDataRef) retrievedData;
    CGDataProviderRef provider = CGDataProviderCreateWithCFData(myPDFData);
    CGPDFDocumentRef pdf = (CGPDFDocumentCreateWithProvider(provider)); 
```

现在我不知道如何在 iPhone 的屏幕上显示这个 pdf。

```
+ (id)dataWithBase64EncodedString:(NSString *)string;
{
if (string == nil)
    [NSException raise:NSInvalidArgumentException format:nil];
if ([string length] == 0)
    return [NSData data];

static char *decodingTable = NULL;
if (decodingTable == NULL)
{
    decodingTable = malloc(256);
    if (decodingTable == NULL)
        return nil;
    memset(decodingTable, CHAR_MAX, 256);
    NSUInteger i;
    for (i = 0; i < 64; i++)
        decodingTable[(short)encodingTable[i]] = i;
}

const char *characters = [string cStringUsingEncoding:NSASCIIStringEncoding];
if (characters == NULL)     //  Not an ASCII string!
    return nil;
char *bytes = malloc((([string length] + 3) / 4) * 3);
if (bytes == NULL)
    return nil;
NSUInteger length = 0;

NSUInteger i = 0;
while (YES)
{
    char buffer[4];
    short bufferLength;
    for (bufferLength = 0; bufferLength < 4; i++)
    {
        if (characters[i] == '\0')
            break;
        if (isspace(characters[i]) || characters[i] == '=')
            continue;
        buffer[bufferLength] = decodingTable[(short)characters[i]];
        if (buffer[bufferLength++] == CHAR_MAX)      //  Illegal character!
        {
            free(bytes);
            return nil;
        }
    }

    if (bufferLength == 0)
        break;
    if (bufferLength == 1)      //  At least two characters are needed to produce one byte!
    {
        free(bytes);
        return nil;
    }

    //  Decode the characters in the buffer to bytes.
    bytes[length++] = (buffer[0] << 2) | (buffer[1] >> 4);
    if (bufferLength > 2)
        bytes[length++] = (buffer[1] << 4) | (buffer[2] >> 2);
    if (bufferLength > 3)
        bytes[length++] = (buffer[2] << 6) | buffer[3];
}

realloc(bytes, length);
return [NSData dataWithBytesNoCopy:bytes length:length];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:41:11.200

创建一个上下文，如果您没有任何上下文，然后为给定页面 ( `index`) 执行以下操作：

```
- (void)drawPDF:(CGPDFDocumentRef)pdf pageIndex:(NSUInteger)index context:(CGContextRef)ctx {

    CGPDFPageRef page = CGPDFDocumentGetPage(pdf, index);
    CGAffineTransform transform = aspectFit(CGPDFPageGetBoxRect(page, kCGPDFMediaBox),
                                        CGContextGetClipBoundingBox(ctx));
    CGContextConcatCTM(ctx, transform);
    CGContextDrawPDFPage(ctx, page);
} 
```

要获得要绘制的上下文，您可以执行以下操作：

```
CGSize pageSize = ...;
UIGraphicsBeginImageContextWithOptions(pageSize, YES, 0.0);
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextClipToRect(context, CGRectMake(0, 0, pageSize.width, pageSize.height));

    <DRAW PAGE HERE>
    [self drawPDF:pdf pageIndex:N context:context];

UIGraphicsEndImageContext(); 
```

编辑，您还应该定义以下 C 函数（在任何类之外），它处理将 PDF 缩放到视图大小：

```
CGAffineTransform aspectFit(CGRect innerRect, CGRect outerRect) {
  CGFloat scaleFactor = MIN(outerRect.size.width/innerRect.size.width, outerRect.size.height/innerRect.size.height);
  CGAffineTransform scale = CGAffineTransformMakeScale(scaleFactor, scaleFactor);
  CGRect scaledInnerRect = CGRectApplyAffineTransform(innerRect, scale);
  CGAffineTransform translation = 
  CGAffineTransformMakeTranslation((outerRect.size.width - scaledInnerRect.size.width) / 2 - scaledInnerRect.origin.x, 
                                 (outerRect.size.height - scaledInnerRect.size.height) / 2 - scaledInnerRect.origin.y);
  return CGAffineTransformConcat(scale, translation);
} 
```

或者，您可以删除以下行：

```
 CGAffineTransform transform = aspectFit(CGPDFPageGetBoxRect(page, kCGPDFMediaBox),
                                        CGContextGetClipBoundingBox(ctx));
    CGContextConcatCTM(ctx, transform); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:06:44.530

您可以在 UIWebview 中加载您的 pdf 文件，该文件将显示其具有许多 pdf 阅读器功能。

# chat - 在 Skype 中阻止群聊

> ID：13622786
> 
> 赞同：2
> 
> 时间：2012-11-29T09:39:01.393
> 
> 标签：chat, block, skype

有什么方法可以在不屏蔽所有群聊的情况下屏蔽 Skype 中的群聊。我不想离开群组，因为这会导致我的朋友重新添加我。想在不通知其他组员的情况下逃离组。是否可以？如果是怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T09:44:13.097

我正在使用“对话”菜单中的“通知设置”。这使得保持聊天成为可能，但不会一直收到所有烦人的通知。只需输入您的姓名/昵称，Skype 只会在提及您的姓名时通知您。

# asp.net-mvc-3 - 使用不同的 stringbuilder 对象创建一个电子表格

> ID：13622792
> 
> 赞同：0
> 
> 时间：2012-11-29T09:39:19.397
> 
> 标签：asp.net-mvc-3, web-services, c#-4.0

我目前有一个从 Web 服务生成报告的应用程序。报告基本上是由 Web 服务（使用存储过程）从数据库中提取的数据表。

前 50 条记录显示在屏幕上（发送到视图），但还有一个用户可以单击的按钮将整个查询下载到 Excel 电子表格。这是通过将查询结果传递到模型中，然后将其写入用于创建电子表格的字符串构建器来实现的。该动作方法的代码如下：

```
// WebService call
var reportResult = SubscriberService.GetReport(reportName, criteria.CurrentPageNumber - 1, 0, getReportParameters(model.GroupId, criteria));
  model.Result = getModel(reportResult);     

  // if file name is not ended with .csv we there it as prefix and file will be prefix_{date}.csv
  if (String.IsNullOrEmpty(fileName) || fileName.LastIndexOf(".csc", StringComparison.InvariantCultureIgnoreCase) != fileName.Length - 4)
    fileName = string.Format("{0}_{1}.csv", fileName, DateTime.Now.ToShortDateString());

  HttpContext.Response.ContentType = "text/csv";
  HttpContext.Response.AddHeader("Content-Disposition", "attachment; filename=" + fileName);

  if (model.Result != null)
  {
    StringBuilder sb = new StringBuilder();
    exportRowHeader(sb);
    HttpContext.Response.Write(sb.ToString());
    sb.Clear();

    foreach (var item in model.Result.Members)
    {
      exportRowData(sb, model.Result, item);
      HttpContext.Response.Write(sb.ToString());
      sb.Clear();
    }
    HttpContext.Response.Write(sb.ToString());
  }
  else
  {
    HttpContext.Response.Write(ReportResources.Report_Exporting_NoDataAvailable);
  }

  HttpContext.Response.Flush(); 
```

我的问题是，对于大型查询，与 Web 服务的通信需要很长时间并且超时。可以通过 WebService 发送的最大数据量也存在问题。

所以我想做的是分解 WebService 调用。WebService 能够对它发回的结果进行分页。所以我基本上一次调用 200 个结果（直到所有结果都返回）。

这是否可以通过简单地创建额外的 stringbuilder 对象然后将它们组合在一起来制作一个结果电子表格来实现？这会导致内存问题吗？

如果这似乎不可能，您可以建议替代解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T12:52:48.423

通过使用 do-while 循环，我最终让它工作起来相当轻松。将所有这些内容保存在 HttpContext.Response 中似乎没有任何内存问题，尽管创建一个包含 72,000 行和 25 列的电子表格需要 3 分半钟：

```
int pageNum = 0;
  int pageSize = 2000;

  // if file name is not ended with .csv we there it as prefix and file will be prefix_{date}.csv
  if (String.IsNullOrEmpty(fileName) || fileName.LastIndexOf(".csc", StringComparison.InvariantCultureIgnoreCase) != fileName.Length - 4)
    fileName = string.Format("{0}_{1}.csv", fileName, DateTime.Now.ToShortDateString());

  HttpContext.Response.ContentType = "text/csv";
  HttpContext.Response.AddHeader("Content-Disposition", "attachment; filename=" + fileName);

  do
  {

    var reportResult = SubscriberService.GetReport(reportName, pageNum, pageSize,
                                                   getReportParameters(model.GroupId, criteria));
    model.Result = getModel(reportResult);

    if (model.Result != null)
    {
      StringBuilder sb = new StringBuilder();

      if (pageNum == 0)
      {
        exportRowHeader(sb);
        HttpContext.Response.Write(sb.ToString());
        sb.Clear();
      }

      foreach (var item in model.Result.Members)
      {
        exportRowData(sb, model.Result, item);
        HttpContext.Response.Write(sb.ToString());
        sb.Clear();
      }
      HttpContext.Response.Write(sb.ToString());
    }
    else
    {
      HttpContext.Response.Write(ReportResources.Report_Exporting_NoDataAvailable);
      break;
    }

    pageNum++;

  } while (model.Result.Members.Count==pageSize); 

  HttpContext.Response.Flush(); 
```

# c - 这也是 C 中的灵活数组结构成员吗？

> ID：13622797
> 
> 赞同：0
> 
> 时间：2012-11-29T09:39:37.657
> 
> 标签：c, arrays, struct

> **可能重复：**
> [C 中的灵活数组成员 - 不好？](https://stackoverflow.com/questions/246977/flexible-array-members-in-c-bad)

我阅读了以下代码：

```
struct hello {
    int number;
    int data[1];
}; 
```

我知道灵活的数组成员允许我们声明最后一个元素是`array of unspecified size`这样的：

```
struct hello {
    int number;
    int data[];
}; 
```

在 this`struct`中，最后一个元素没有指定大小，那么这两者有什么区别呢？第一个声明是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:45:08.950

这种数组：

```
struct hello {
    int number;
    int data[];
}; 
```

仅作为结构的最后一个元素才有意义，并且仅在您从堆中分配结构时才有意义，并且通常使标头字段包含数组的实际大小：

```
struct hello *helloptr = malloc(sizeof (struct hello) + count*(sizeof int));
helloptr->number = count; 
```

用途是用一个结构方便地分配头和数据缓冲区。

另外：分配大小为 1 的数组的版本与分配大小为 1 的数组的差异`sizeof struct hello`会更大，因为数组分配有一个元素，而不是 undefined=0。这要么浪费一个项目的内存，要么使大小计算更加复杂，并且在概念上有点“丑陋”（你的代码有大小为 1 的数组，而实际上你的意思是“未定义”，甚至可能是 0）。

在 OOP C++ 中，最好将动态分配的缓冲区包装在一个类中，这确实是一种“黑客”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:47:36.617

> **`data[1]`和 和有什么不一样`data[0]`？**

区别是没有的，两者都可以用于实现灵活大小的结构。

Raymond Chen[恰如其分地回答](http://blogs.msdn.com/b/oldnewthing/archive/2004/08/26/220873.aspx)：

> 好吧，你可能会说，那为什么不使用长度为零的数组而不是长度为 1 的数组呢？
> 
> 因为时间旅行还没有完善。
> 
> 零长度数组直到 1999 年才成为合法的标准 C。由于 Windows 早在那之前就出现了，它无法利用 C 语言中的这一功能。

请注意，从技术上讲，第二个代码示例都不是有效的 C++ 代码。^([参考 1])但是很多现有代码都使用了这个功能，而且这个代码几乎总是可以工作的。

* * *

^([参考 1])**参考：**

**C++11 标准：8.3.4 数组**

> 在有表格的声明`T` `D`中`D`
> 
> ```
> D1 [ constant-expressionopt] attribute-specifier-seqopt 
> ```
> 
> ....... 如果常量表达式 (5.19) 存在，它应该是一个整数常量表达式并且**它的值应该大于零**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T10:14:06.780

即使您只访问第一个元素，两者在 C 中也不完全等价。一个灵活的数组可以有与固定大小的数组不同的对齐方式。因此，即使`sizeof`两者都可以为您提供不同的结果，您也不应该在同一代码中混合这两种变体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T10:01:57.483

它不是一个灵活的数组成员，但在一些需要与旧编译器或 c++ 编译器一起使用的代码中使用。

将其用作灵活的数组成员可能会引发未定义的行为。在实际代码中，这应该可以按预期工作，因为这个技巧用于太多代码，编译器无法做出任何意想不到的事情。

# java - 如何使用空日期进行 SQL 查询？

> ID：13622809
> 
> 赞同：1
> 
> 时间：2012-11-29T09:40:32.453
> 
> 标签：java, sql, postgresql, jdbc

我想做这个查询：

```
 Class.forName("org.postgresql.Driver");
    Connection conn= null;
    conn = DriverManager.getConnection("jdbc:postgresql://localhost:5432/postgis","postgres","123456");
    PreparedStatement ps = null;
    String sql = "SELECT num FROM parcels WHERE code_initial_right =(SELECT code_document FROM documents WHERE number_document=? or date_document='"+docd+"')";
    ps = conn.prepareStatement(sql);
    ps.setString(1,docn);
    ResultSet rs = ps.executeQuery(); 
```

但`docd`可以等于`null`。当我尝试这个时，我得到一个错误：

```
javax.servlet.ServletException: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type date: "" 
```

我能用这个做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:42:42.970

使用`IS NULL`谓词：

```
....
OR docd IS NULL OR date_document = docd; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:54:34.053

使用`if`：

```
StringBuilder sql = new StringBuilder("SELECT num FROM parcels WHERE code_initial_right =");
if (docd != null) {
   sql.append("(SELECT code_document FROM documents WHERE number_document=? or date_document='"+docd+"')");
}else {
   sql.append("(SELECT code_document FROM documents WHERE number_document=?)");
}
ps = conn.prepareStatement(sql.toString()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:55:45.747

像这样尝试**ISNULL** (date_document, default_date)：

```
String sql = "SELECT num FROM parcels WHERE code_initial_right =(SELECT code_document FROM documents WHERE number_document=? or isnull(date_document, '"+docd+"') ='"+docd+"')"; 
```

# delphi - 尝试加载 XML 时出现未定义错误

> ID：13622812
> 
> 赞同：1
> 
> 时间：2012-11-29T09:40:38.593
> 
> 标签：delphi, delphi-7

我有一个 400kb 的大 xml 文件。

当我尝试使用以下方法加载它时：

*   IXMLDocument 的 LoadXMLData 或
*   CreateOLEObject('MSXML2.DOMDocument.4.0')' 加载方法

我在这两种方法中都得到了未定义的错误。我拿了文件并粘贴到 xml 验证网页，它验证了 ok...

我还可以做些什么？

顺便问一下，元素中的属性是否有最大长度？

## 编辑

似乎它无法加载长属性...我在 xml 的属性值中有另一个 xml 的一部分...

```
An error pops up: Undefined error. Line: 1 (here is the begining of the xml)
Class of the exception is: EDOMParseError 
```

一般来说，我想达到这样的目标：

```
<doc type="X223">
  <params id_param="51" value="XML_1" />
  <params id_param="52" value="XML_2" />
  <params id_param="53" value="XML_3" />
</doc> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T11:29:31.800

如果您可以更改您的架构，最好将您的内部 XML 文件存储到[`CDATA section`](http://www.w3schools.com/xml/xml_cdata.asp)，如果不能，请尝试考虑以下内容。

解析器在您的元素属性值上失败很可能是由于您尝试存储在那里的 XML 文件中包含引号字符。例如，考虑以下情况：

```
<params id_param="51" value="<innerxmlattributevalue="value">"/> 
```

如您所见，您可能会将解析器与来自该内部 XML 的引号字符混淆，因此它可以将上面的行视为：

```
<params id_param="51" value="<innerxmlattributevalue="
value">"/>     <-- here is expected to be another attribute or closing bracket 
```

当您想要保留当前模式时，您可以做的最简单的事情是转义内部 XML 文件的所有引用字符。

从[`RFC 2629`](https://www.rfc-editor.org/rfc/rfc2629)规范（由我强调）：

> 确保所有属性值都被引用，例如，`"<example name='value'>"`如果该值包含一个引用字符，则使用另一个引用该值，例如，`"<example name='"'>"`如果 **该值包含两个引用字符，则使用其中一个引用值，并用`'&apos;'`（撇号）或（引号）替换属性值中该字符的出现`"&quot;"` ，例如，`"<example name='"&apos;"'>"`**。

# c++ - 从 std::set 复制到 std::deque - 内存问题

> ID：13622813
> 
> 赞同：0
> 
> 时间：2012-11-29T09:40:41.720
> 
> 标签：c++, valgrind

我正在开发一个 C++ 应用程序，我需要将 std::set 的内容复制到 std::deque。类似于我在我的应用程序中所做的事情如下。（这是简化版）

```
class A
{
public:
    A(){};
    ~A() {};

    void UpdateDataSet(std::set<C>& _setData);

private:
    std::deque<C>   deque_Data;//contains ohlc data for the symbol   
};

void A::UpdateDataSet(std::set<C>& _setData)
{
    std::set<C>::iterator itrSet =  _setData.begin();
    std::set<C>::iterator itrSetEnd =  _setData.end();

    while(itrSet != itrSetEnd)
    {
        deque_Data.push_back(*itrSet);
        ++itrSet;
    }
}

int main()
{
    A* pA = new A();

    std::set<C> setData;
    C mC1(5,10);
    C mC2(10,20);
    C mC2(30,40);

    C.insert(mC1);
    C.insert(mC2);
    C.insert(mC3);

    pA->UpdateDataSet(setData);

    return 0;
} 
```

这里 C 是一个包含两个整数的类。上面的代码按我的预期工作得很好。但问题是当我使用 valgrind memcheck 对我的代码进行分析时，它指出了代码块附近可能丢失的一些数据

```
deque_Data.push_back(*itrSet); 
```

valgrind 输出如下。

```
==3469== 1,032,640 bytes in 180 blocks are possibly lost in loss record 1,337 of 1,346
==3469==    at 0x4006355: operator new(unsigned int) (vg_replace_malloc.c:214)
==3469==    by 0x46B92AF: __gnu_cxx::new_allocator<C*>::allocate(unsigned int, void const*) (new_allocator.h:88)
==3469==    by 0x46B92E7: std::_Deque_base<C, std::allocator<C> >::_M_allocate_map(unsigned int) (stl_deque.h:424)
==3469==    by 0x46B94F9: std::deque<C, std::allocator<C> >::_M_reallocate_map(unsigned int, bool) (deque.tcc:750)
==3469==    by 0x46B960B: std::deque<C, std::allocator<C> >::_M_reserve_map_at_back(unsigned int) (stl_deque.h:1444)
==3469==    by 0x46B96C5: std::deque<C, std::allocator<C> >::_M_push_back_aux(C const&) (deque.tcc:348)
==3469==    by 0x46B9822: std::deque<C, std::allocator<C> >::push_back(C const&) (stl_deque.h:1045)
==3469==    by 0x46B6B09: A::UpdateDataSet(std::set<C, std::less<C>, std::allocator<C> >&) 
```

有人可以帮我找出这里的内存问题。这个 valgrind 输出真的意味着内存泄漏吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:42:28.900

您没有在 main 末尾执行“删除 pA”...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T11:19:29.923

You are missing something in your example, there is no memory leak.

I complied and ran this code

```
 #include <set>
 #include <deque>

 class C
 {
 public:
     C (int a, int b)
         :   m_a (a)
         ,   m_b (b)
     {
     }

     bool operator <(const C& c) const
     {
         return m_a < c.m_a || (m_a == c.m_a && m_b < c.m_b);
     }

 private:
     int m_a;
     int m_b;
 };
 class A
 {
     public:
         A(){};
         ~A() {};

         void UpdateDataSet(std::set<C>& _setData);

     private:
         std::deque<C>   deque_Data;//contains ohlc data for the symbol
 };

 void A::UpdateDataSet(std::set<C>& _setData)
 {
     std::set<C>::iterator itrSet =  _setData.begin();
     std::set<C>::iterator itrSetEnd =  _setData.end();

     while(itrSet != itrSetEnd)
     {
         deque_Data.push_back(*itrSet);
         ++itrSet;
     }
 }

 int main()
 {
     A* pA = new A();

     std::set<C> setData;
     C mC1(5,10);
     C mC2(10,20);
     C mC3(30,40);

     setData.insert(mC1);
     setData.insert(mC2);
     setData.insert(mC3);

     pA->UpdateDataSet(setData);
     delete pA;

     return 0;
 } 
```

valgrind doesn't report anything suspicious, as expected

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T11:07:31.803

There are two reasons I can think of why the memory allocated by a deque might not get deallocated, assuming a correct implementation of your standard library:

1.  **Violently accessing the deque's internals.** Using memset/memcpy or `reinterpet_cast`/C-style casts might give you access to memory locations where the deque stores its private members, e.g. pointers to allocated memory. If you mess around with those private members in any way, deque might not be able to deallocate its dynamically allocated memory, leading to memleaks. Normally such agressive acts lead to access violations of many kinds, so you would observe rather crashes than just memleaks.
2.  **Missing deque destructor call.** If for any reason a deque's destructor gets not called, it has no opportunity to "clean up", i.e. deallocate its owned dynamic memory, leading to said memleaks. In Your case, the deque destructor automatically gets called by A's destructor, *unless you have a `deque*` and allocated the deque itself on the free store/heap (see below).* Reason for a missing call of A's destructor might be one or more of the following:
    *   Missing delete: delete calls the destructor of an object and releases the memory where the object had been. In that case, you should see another memleak, pointing where the object was allocated and created (in your sample code the new `A()`)
    *   Calling `free()` instead of delete: free only frees the memory but does not call any destructors. Never match new and free, even better try not to use malloc/free with C++ objects unless you are very careful and know what you do (placement new...)
    *   "Jumping" out of code. I you somehow "jump" out of scopes, the compiler might not be able to do the automated destructor calls at the end of the scope blocks. This does not apply for exceptions, because compilers know what to do and how to clean up. This *should* not apply for `goto`'s, since most compilers emit errors if you violate object lifetime boundaries with goto. Nevertheless, try not to use `goto` in C++, as there are other features you can use. The only "jumping" i could emagine here is `longjmp`, which is a C feature that does not respect scope boundaries and thus ignores the need for destructor calls, amongst others. *Never* use `longjmp` in C++ code.

If anybody can think of more reasons for the memleak, missing destructor calls or others, give me a hint, I'll edit this answer :-)

PS: I just saw I missed the "see below" part - so what's the deal if you have a `deque*` in A instead of a `deque`? In that case, A is responsible for correctly constructing and destructing the deque, meaning - call new whenever you need to create the queue - call delete at least in the destructor - handle especially copy/move assignment and copy/move construction correctly However, if you have a `deque*` and messed up the pointer handling you should see another memleak, pointing you to any of the `new deque` calls you will have.

# wpf - WPF：绑定到我的自定义控件不会更新

> ID：13622815
> 
> 赞同：3
> 
> 时间：2012-11-29T09:40:44.843
> 
> 标签：wpf, data-binding, binding, user-controls, dependency-properties

我创建了一个用户控件来“浏览”文件，它基本上由一个文本框和一个按钮组成。

它有几个属性，允许我选择一个目录，一个现有的（打开文件对话框）或一个不存在的文件（保存文件对话框），指定过滤器，...

我正在使用这样的依赖属性：

```
 public static readonly DependencyProperty FilePathProperty = DependencyProperty.Register(
        "FilePath",
        typeof(String),
        typeof(BrowseFileControl),
        new PropertyMetadata(default(String), InvokeFilePathChanged)
    );
    public String FilePath { get { return (String)GetValue(FilePathProperty); } set { SetValue(FilePathProperty, value); } }

    private static void InvokeFilePathChanged(DependencyObject property, DependencyPropertyChangedEventArgs args)
    {
        BrowseFileControl view = (BrowseFileControl)property;
        view.InvokeFilePathChanged((String)args.OldValue, (String)args.NewValue);
    }
    protected virtual void InvokeFilePathChanged(String oldValue, String newValue)
    {
        InvokePropertyChanged("FilePath");
    } 
```

在我看来，我有一个列表框，允许我选择要编辑的“配置”，并且我的所有字段（包括我的用户控件）都绑定到 CurrentConfiguration（并且 CurrentConfiguration 绑定到 SelectedItem）。

我的问题：第一次加载总是可以的，但是如果我选择另一个配置，它就不会更新并保留旧文本。

我的绑定是这样的：

```
<userContols:BrowseFileControl  Grid.Row="4" Grid.Column="1" 
    Margin="2" FilePath="{Binding CurrentConfiguration.TagListFile, 
    ValidatesOnDataErrors=true, NotifyOnValidationError=true}"
    IsFolder="False" Filter="All files (*.*)|*.*" CanBeInexistantFile="False"/> 
```

如果我使用一个简单的文本框，具有完全相同的绑定，它会正确更新！

```
<TextBox Grid.Row="4" Grid.Column="1" 
    Text="{Binding CurrentConfiguration.TagListFile,ValidatesOnDataErrors=true, NotifyOnValidationError=true}" 
    Margin="2"/> 
```

我也没有在 Visual Studio 的输出窗口中看到任何绑定错误。

那么我的绑定有什么问题呢？

编辑：用户控件的 xaml：

```
<Grid DataContext="{Binding ElementName=uxBrowseFileControl}">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
    </Grid.ColumnDefinitions>
    <TextBox Padding="2" Text="{Binding FilePath, ValidatesOnDataErrors=true, NotifyOnValidationError=true}"/>
    <Button Content="Browse" Grid.Column="1" Padding="2" Command="{Binding BrowseCommand}"/>
</Grid> 
```

uxBrowseFileControl 是`<UserControl>`

编辑 2：事实上，如果我通过 userControl 更改某些内容，它也不会在模型中复制：/

**Edit3：**我在 currentItem.FilePath->UserControl 的绑定中加入了“Mode=TwoWay”，现在它似乎可以工作了，但为什么呢？具有相同绑定的文本框正在工作！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:59:41.347

您应该删除 DependencyProperty 的更改回调。您不需要任何特殊的逻辑来使依赖属性在更改时更新 UI - 这已经内置到依赖属性中。

这就是你所需要的：

```
public static readonly DependencyProperty FilePathProperty = DependencyProperty.Register(
    "FilePath",
    typeof(String),
    typeof(BrowseFileControl),
    new PropertyMetadata(default(String))
);

public String FilePath { get { return (String)GetValue(FilePathProperty); } set { SetValue(FilePathProperty, value); } } 
```

您可能还希望将依赖项属性设置`TwoWay`为默认绑定，（控件的`Text`属性`TextBox`也这样做）：

```
public static readonly DependencyProperty FilePathProperty = DependencyProperty.Register(
    "FilePath",
    typeof(String),
    typeof(BrowseFileControl),
    new FrameworkPropertyMetadata(default(String), FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)
); 
```

这样您就不必`Mode=TwoWay`在绑定该属性时显式设置。

# php - 在 PHP 中使用 JavaScript 自动填充

> ID：13622818
> 
> 赞同：0
> 
> 时间：2012-11-29T09:40:57.407
> 
> 标签：php, javascript, html

当另一个文本框字段具有值时，我需要填充一个文本框。在 JavaScript 中我遇到了一个问题，它不能完美地工作。

首先，让我们看看表单本身的 html 代码：

```
<div style="width: 145px; height: 30px; float: left; margin-top: 5px; margin-left: 3px;">
    <label>Product Segment</label><label style="color: #F00;">*</label>
</div>
<div class="ui-widget"
    style="width: 145px; height: 30px; float: left; margin-top: 5px; margin-left: 3px;">
    <input type="text" name="productsegment" id="productsegment" onkeyup="getagentids();" value="<?php echo $productsegment;?>" />
</div>
<!--Row3 end-->

<!--Row3 -->
<div style="width: 145px; height: 30px; float: left; margin-top: 5px; margin-left: 3px;">
    <label>Product Group</label><label style="color: #F00;">*</label>
</div>
<div
    style="width: 145px; height: 30px; float: left; margin-top: 5px; margin-left: 3px;">
    <input type="text" name="productgroup" id="productgroup" value="<?php echo $productgroup;?>" />
</div> 
```

脚本代码：

```
<script type="text/javascript"> 
var url = "productgroupautofill.php?param=";

function GetHttpObject() {
    if (window.ActiveXObject)
        return new ActiveXObject("Microsoft.XMLHTTP");
    else if (window.XMLHttpRequest)
        return new XMLHttpRequest();
    else {
        alert("Your browser does not support AJAX.");
        return null;
    }
}
function getagentids() {
    httpobject = GetHttpObject();

    if (httpobject != null) {
        var idValue = document.getElementById("productsegment").value;
        var myRandom = parseInt(Math.random() * 99999999);
        // cache buster

        http.open("GET", url + escape(idValue) + "&rand=" + myRandom, true); // from
        // here
        // it
        // wont
        // work
        http.onreadystatechange = handleHttpResponse;
        http.send(null);

    }
}
function handleHttpResponse() {
    if (http.readyState == 4) {
        results = http.responseText;
        alert(results);
        document.getElementById('productgroup').value = results;
    }
}            
</script> 
```

productgroupautofill.php 文件内容。

```
<?php
require_once 'Mysql.php';
$dblink = new Mysql();
$dblink->__construct();

if(strlen($param)>0)
{
    $result = mysql_query("select productgroup from productsegmentmaster where productgroup LIKE '$param%'");
    if(mysql_num_rows($result)==1)
    {
        while($myrow = mysql_fetch_array($result))
        {
            $agentname = $myrow["productgroup"];
            $textout .= $agentname;
        }
    }
    else
    {
        $textout=" , , ,".$param;
    }
}
echo $textout; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:54:56.300

```
var url = "productgroupautofill.php?param=";
var httpobject;
function GetHttpObject() {
    if (window.ActiveXObject)
        return new ActiveXObject("Microsoft.XMLHTTP");
    else if (window.XMLHttpRequest)
        return new XMLHttpRequest();
    else {
        alert("Your browser does not support AJAX.");
        return null;
    }
}
function getagentids() {
    httpobject = GetHttpObject();

    if (httpobject != null) {
        var idValue = document.getElementById("productsegment").value;
        var myRandom = parseInt(Math.random() * 99999999);
        // cache buster

        httpobject.open("GET", url + escape(idValue) + "&rand=" + myRandom, true); // from
        // here
        // it
        // wont
        // work
        httpobject.onreadystatechange = handleHttpResponse;
        httpobject.send(null);

    }
}
function handleHttpResponse() {
    if (httpobject.readyState == 4) {
        results = httpobject.responseText;
        alert(results);
        document.getElementById('productgroup').value = results;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:45:52.070

**请尝试在productgroupautofill.php**中使用以下代码

 **```
require_once 'Mysql.php';
$dblink = new Mysql();
$dblink->__construct();
$param=$_GET['param'];
if(strlen($param)>0)
{ 
$result = mysql_query("select productgroup from productsegmentmaster where productgroup LIKE '$param%'"); 
if(mysql_num_rows($result)==1) 
{
 while($myrow = mysql_fetch_array($result))
 {
  $agentname = $myrow["productgroup"]; 

  $textout .= $agentname; 
  } 
  } 
  else 
  { 
  $textout=" , , ,".$param; 
  } 
  } 
  echo $textout; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:49:54.307

你定义`httpobject`为：

```
httpobject = GetHttpObject(); 
```

但是然后您尝试使用`http`：

```
http.open( ... ) 
```

将您的定义更改为此，因为您`http`在整个代码中使用：

```
http = GetHttpObject(); 
```

您可能还想在全局范围内声明它：

```
var url = "productgroupautofill.php?param=";
var http; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T17:29:34.883

You cannot use your tectout variable outside of the loop. Try using echo inside your loop and you should see some results coming through, In fact you don't need that variable at all. Just echo $myrow["productgroup"]; if condition is true and assign ' , , , '$param to anothher variable and echo if false**

# asp.net - asp.net如何在按钮点击事件中添加动态LinkBut ton？

> ID：13622821
> 
> 赞同：0
> 
> 时间：2012-11-29T09:41:03.343
> 
> 标签：asp.net

有没有办法在单击提交按钮后添加 LinkBut​​ton 并让它正确回发。以这种情况为例。

页面加载了一个上传控件和一个提交按钮。做出选择并且用户单击提交按钮后，我想在另一个分隔符中显示已上传的文件，并在文件名旁边使用可选的删除按钮。问题是，当用户单击提交按钮时，我尝试在单击处理程序上添加控件，因为这是请求文件的位置，但是当我尝试在控件响应中添加链接按钮时，事件当然不会挂钩.

```
<form .....
<telerik:RadAsyncUpload ID="CtrlRadAsyncUpload" runat="server">
</telerik:RadAsyncUpload>
<asp:Button ID="CtrlSave" runat="server" Text="Submit Plans" />

protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    CtrlSave.Click += new EventHandler(CtrlSave_Click);
}

protected void Page_Load(object sender, EventArgs e)
{
 //the problem is here, the new files are not created until after telerik has processed it own button click. I could add the buttons here, but the files are not posted yet. So i try to add them in the button click event. see below.
}

void CtrlSave_Click(object sender, EventArgs e)
{
 any LinkButtons created and added to the controls collection are there, but they do not post back properly

 //get uploaded data
 LinkButton pDelete = new LinkButton();
            pDelete.Text = "Remove";
            pDelete.Command += new CommandEventHandler(pDelete_Command);
            pDelete.CommandArgument = pFile;
            pDelete.CommandName = "Delete";
            Controls.Add(pDelete);
} 
```

有没有人有解决这个问题的好主意？我浏览了整个网络，我认为我对页面生命周期有相当不错的掌握。但这很烦人。我似乎经常被这些问题困住。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:44:48.270

您可以`LinkButton pDelete`在开始时添加，但是在单击时将其设置为可见和其他属性，那么它将始终存在并且问题将消失。

# cmd - 如何从另一个批处理文件调用其路径中有空格的批处理文件并将控制权返回给父批处理文件

> ID：13622822
> 
> 赞同：4
> 
> 时间：2012-11-29T09:41:04.610
> 
> 标签：cmd, batch-file

我试图从另一个批处理文件中调用一个批处理文件，在第二个批处理文件执行后，控件应该返回到第一个批处理文件并且它应该恢复执行。目前我在我的父批处理文件中使用以下命令：

```
call "cmd /c start /b %ROOT_HOME%\folder1\bin\bat1.bat" 
```

只要 %ROOT_HOME% 的路径中没有**空格**，它就可以正常工作。

如果路径中包含空格，上述命令将失败。

我已经尝试了**cmd**、**start**、**call**的每种组合，但仍然无法达到预期的结果。

bat1.bat 里面也没有**出口**，也不能修改。所以单独使用**call**只会执行子批处理文件，不会返回父批处理文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T11:50:33.840

您根本不需要`call`那里，因为无论如何您都在通过以下方式生成新批次`cmd`：

```
start "" /b "%ROOT_HOME%\folder1\bin\bat1.bat" 
```

尽管我想知道为什么要使用`start /b`，除非您担心环境污染（可以通过在调用周围使用`setlocal`/轻松恢复），但也应该足够：`endlocal``call`

```
call "%ROOT_HOME%\folder1\bin\bat1.bat" 
```

作为一般规则：围绕某事物进行更多层的解析和执行只会使事情变得更加复杂，并且很少会使问题消失。参照。`iex`在 PowerShell 中过度使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T11:22:43.497

如果您尝试使用短路径怎么办：

```
for /f %%P in (%ROOT_HOME%) do set SHORT_ROOT_HOME=%%~sP
call "cmd /c start /b  %SHORT_ROOT_HOME%\folder1\bin\bat1.bat" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T10:32:32.790

它应该像这样简单

```
call cmd /c start /b "" "%ROOT_HOME%\folder1\bin\bat1.bat" 
```

# javascript - 验证在 ja vascript 中提交的表单日期

> ID：13622826
> 
> 赞同：0
> 
> 时间：2012-11-29T09:41:25.467
> 
> 标签：javascript

> **可能重复：**
> [JS 日期格式和日期比较](https://stackoverflow.com/questions/13481353/js-date-format-and-date-comparison)

我有这个 javascript，我想编写代码以确保日期在未来。日期的格式是这样的

dd/mmm/yyyy 例如。2012 年 11 月 24 日

```
var date = $j('#date').val();

if(date =='' || date is not a date in the future){  
dateError = 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:47:09.423

尝试这个：

```
new Date("24-NOV-2012") < new Date() 
```

# javascript - 构建火车运动图

> ID：13622829
> 
> 赞同：5
> 
> 时间：2012-11-29T09:41:41.793
> 
> 标签：javascript, graph, svg, d3.js, data-visualization

我需要建立一个图表来反映每天的火车运动。像这样的东西：

![在此处输入图像描述](../Images/059fbea2471dadaa7c0b6147876f7ddc.png)

我从来没有建立过这样的图表。你知道我应该从什么开始吗？我找到了一个图形库`d3.js`，但还没有使用它的经验。

你能指导我一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T11:49:39.850

您的首要任务是组织和理解您的数据。从我在您的（小）图像中可以看到，您有一个网格，上面覆盖着对角线。假设您使用图形库，我将首先绘制网格，将网格交点坐标添加到数据结构中。那么遍历你的数据并绘制对角线应该是一个相对简单的事情。

你要求指导。试一试，如果您遇到困难，请返回您开发的代码和数据结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T19:43:50.290

这看起来像 EJ Marey 的 1880 年的火车时刻表，它在[Tufte 的“定量信息的视觉显示”](http://www.edwardtufte.com/tufte/books_vdqi)的封面上，并在[这篇博](http://marlenacompton.com/?p=103)文中进行了描述。

实际上有一个[CalTrain 时间表的交互式可视化，](http://mbostock.github.com/protovis/ex/caltrain.html)它复制了 Marey 的可视化，内置在 Protovis 中。尽管 Protovis 不再被积极开发，但您也许可以使用该示例。

然而，正如@HBP 所说，这种可视化非常简单，无需学习任何专门的可视化库即可手动构建。

# sqlalchemy - Sqlalchemy-migrate 使用默认值创建列

> ID：13622832
> 
> 赞同：3
> 
> 时间：2012-11-29T09:41:51.020
> 
> 标签：sqlalchemy, sqlalchemy-migrate

我正在使用[SQLAlchemy-migrate 0.6.1](https://sqlalchemy-migrate.readthedocs.org/en/latest/)来处理我的 mysql 数据库的版本控制。链接指向文档。但他们似乎已经删除了 0.6.1 的文档。

我正在尝试将具有外键约束的新列添加到如下表中：

```
fk = Column('fk',CHAR(36),ForeignKey('table_b.id'),server_default='11c137c0-ee7e-4f9c-91c5-8c77cec22b2c',nullable=False)
fk.create(table_a) 
```

这是可行的，除了 mysql 会将 server_default 存储为默认值并将其添加到所有新记录中。就我而言，这个默认值不会保持不变。

我想用默认值填充列，但不将其作为默认值存储在 mysql 中。

我在文档中找到了这个：

```
fk = Column('fk',CHAR(36),ForeignKey('table_b.id'),default='11c137c0-ee7e-4f9c-91c5-8c77cec22b2c',nullable=False)
fk.create(table_a, populate_default=True) 
```

但我怀疑它是在更新版本的 sqlalchemy-migrate 中添加的。任何人都知道这在 0.6.1 版本的 sqlalchemy-migrate 中是否可行？

# php - 根据单选按钮选择的值更改复选框组合？

> ID：13622833
> 
> 赞同：1
> 
> 时间：2012-11-29T09:41:54.087
> 
> 标签：php, javascript, jquery, html

我有一个系统，学生必须通过单选按钮选择他的班级。然后我想通过复选框显示为该课程提供的课程，以便他可以检查主题。或者简单地说，我想为不同的单选按钮选择值显示不同的复选框。需要帮助吗？

```
BCA
<input type="radio" name="Course_BCA" value="BCA">
B.Com
<input type="radio" name="Course_BCA" value="B.Com">
B.Sc
<input type="radio" name="Course_BCA" value="B.Sc">
B.A
<input type="radio" name="Course_BCA" value="B.A"> 
```

这里应该是复选框，如果用户选择了 BCA，那么

```
<input type="checkbox" name="eng" value="English">
<input type="checkbox" name="math" value="math"> 
```

将被显示。如果他选择 B.Com 然后

```
<input type="checkbox" name="stat" value="stat">
<input type="checkbox" name="comp" value="comp"> 
```

应该向他展示。同样是两个人休息的情况。我将如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:50:52.987

```
<script type="text/javascript">
function fnc(myid)
{

    value=document.getElementById(myid).value;

    if(value=='BCA')
    {document.getElementById("eng").disabled=false;
    document.getElementById("math").disabled=false;
    document.getElementById("stat").disabled=true;
    document.getElementById("comp").disabled=true;
    }
    else if(value=='B.Com')
    {
        document.getElementById("eng").disabled=true;
    document.getElementById("math").disabled=true;
        document.getElementById("stat").disabled=false;
    document.getElementById("comp").disabled=false;
    }

}
</script>

BCA
<input type="radio" name="Course_BCA" id="BCA" value="BCA" onChange="fnc(this.id)">
B.Com
<input type="radio" name="Course_BCA" id="B.Com" value="B.Com" onChange="fnc(this.id)">
B.Sc
<input type="radio" name="Course_BCA"  id="B.Sc" value="B.Sc">
B.A
<input type="radio" name="Course_BCA"  id="B.A" value="B.A">

<input type="checkbox" name="eng" id="eng" value="English" disabled>
<input type="checkbox" name="math" id="math" value="math" disabled>
<input type="checkbox" name="stat" id="stat" value="stat" disabled>
<input type="checkbox" name="comp" id="comp" value="comp" disabled> 
```

希望对你有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:56:10.017

假设您也使用 jquery，您可能希望查找单选按钮更改事件，然后通过 Ajax 加载正确的复选框

```
$(function(){
    $('.radioBut').change(function(){
       $('#checkboxes').load('generateCheckboxes.php',{'studentsClass' : $(this).val()});
    });
}); 
```

所有单选按钮都应该有一个“radioBut”类，并且应该有一个 id='checkBoxes' 的目标 div

您的 php 脚本应根据单选按钮值回显复选框。

希望这可以帮助

# mysql - 子请求 MySQL

> ID：13622837
> 
> 赞同：1
> 
> 时间：2012-11-29T09:42:14.733
> 
> 标签：mysql, sql, subquery

我尝试执行的子请求被阻止，但我不知道该怎么做。我有 4 张桌子：

*   jos_vm_products => 存储的所有产品
*   jos_vm_order_items => 订单中的项目
*   jos_vm_order => 一个订单
*   stock_web_brut => 我的产品库存

我想获取特定产品的所有信息：

*   库存数量（完成）
*   jos_vm_products 表中的产品信息（完成）
*   特定产品的“待处理”订单数量（已冻结）

这是我的第一个请求：

```
SELECT  `product_id` ,  `product_weight` ,  `cdate` ,  `mdate` ,  `product_name` ,  `product_sales` ,  `product_sku` ,  `product_in_stock` , SUM( stock_bloque ) AS  'stock_bloque', SUM( stock_total ) AS  'stock_total', SUM( stock_vente ) AS  'stock_vente', ref
FROM jos_vm_product t1
INNER JOIN  `stock_web_brut` t2 ON t1.product_sku LIKE CONCAT( t2.ref,  '%' ) 
GROUP BY product_id; 
```

我想我应该做一个这样的子请求：

```
SELECT 

     (
        SELECT  COUNT(t5.product_id) 
        FROM jos_vm_product t5 
        INNER JOIN jos_vm_order_item t6 ON  t5.product_id = t6.product_id 
        WHERE order_status = 'P' AND t5.product_id = 12
     ) AS "nombre_produit_pending",  
    `product_id` ,  
    `product_weight` ,  
    `cdate` ,  `mdate` ,  
    `product_name` ,  
    `product_sales` ,  
    `product_sku` ,  
    `product_in_stock` , 
    SUM( stock_bloque ) AS  'stock_bloque', 
    SUM( stock_total ) AS  'stock_total', 
    SUM( stock_vente ) AS  'stock_vente', 
    ref
FROM jos_vm_product t1
INNER JOIN  `stock_web_brut` t2 ON t1.product_sku LIKE CONCAT( t2.ref,  '%' ) 
GROUP BY product_id 
```

而不是« 12 »，我想我应该做一些类似的事情：

```
WHERE order_status = 'P' AND t5.product_id = t1.product_id 
```

但我有一个循环

以下是表格： http: [//kai23.fr/myam.svg](http://kai23.fr/myam.svg) （我无法发布图片）

对于结果，它会是这样的：

```
`product_id` | [...] | 'number_of_orders_in_pending_for_this_product' |
    12       | [...] |               15
    13       | [...] |               5
    14       | [...] |               3 
```

如果有人有想法。

开23

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:53:57.113

在这种情况下，您使用的子选择有点错误。使用 sub-select in `left outer join`，如下所示：

```
SELECT 
    `nombre_produit_pending`.`count`
    `product_id` ,  
    `product_weight` ,  
    `cdate` ,  `mdate` ,  
    `product_name` ,  
    `product_sales` ,  
    `product_sku` ,  
    `product_in_stock` , 
    SUM( stock_bloque ) AS  'stock_bloque', 
    SUM( stock_total ) AS  'stock_total', 
    SUM( stock_vente ) AS  'stock_vente', 
    ref
FROM jos_vm_product t1
INNER JOIN  `stock_web_brut` t2 ON t1.product_sku LIKE CONCAT( t2.ref,  '%' ) 
LEFT OUTER JOIN (select count(t5.product_id) as count, t5.product_id as pid FROM jos_vm_product t5 
        INNER JOIN jos_vm_order_item t6 ON t5.product_id = t6.product_id 
        WHERE order_status = 'P'
     ) AS nombre_produit_pending ON nombre_produit_pending.pid = t1.product_id    
GROUP BY product_id 
```

PS！我没有检查您的数据库结构和查询，我只是按照不同的顺序复制了您自己的查询，所以如果您从 mysql 收到任何错误，我可以帮助您解决它们:)

关键是子选择应该查询所有挂单并按 ID 对它们进行分组（给出 2 个值作为 return:`id`和`count`），因此您使用它的 id 加入子结果，并且应该将相应的计数作为一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T17:42:17.543

感谢 tiit，这是最后的请求：

```
SELECT 
`nombre_produit_pending`.`count`,
`product_id` ,  
`product_weight` ,  
`cdate` ,  `mdate` ,  
`product_name` ,  
`product_sales` ,  
`product_sku` ,  
`product_in_stock` , 
SUM( stock_bloque ) AS  'stock_bloque', 
SUM( stock_total ) AS  'stock_total', 
SUM( stock_vente ) AS  'stock_vente', 
ref
FROM jos_vm_product t1
INNER JOIN  `stock_web_brut` t2 ON t1.product_sku LIKE CONCAT( t2.ref,  '%' ) 
LEFT OUTER JOIN (SELECT COUNT(t5.product_id) AS count, t5.product_id AS pid FROM         jos_vm_product t5 
    INNER JOIN jos_vm_order_item t6 ON t5.product_id = t6.product_id 
    WHERE order_status = 'P'
    GROUP BY t5.product_id
 ) AS nombre_produit_pending ON nombre_produit_pending.pid = t1.product_id    
GROUP BY product_id 
```

# java - 如何摆脱警告：使用 '$' 而不是 '.' 对于 Eclipse 中的内部类

> ID：13622838
> 
> 赞同：22
> 
> 时间：2012-11-29T09:42:14.867
> 
> 标签：java, android, eclipse, android-manifest

我是 Android 开发的新手。在我将我的 eclipse 和 Android SDK 更新到最新版本后，我收到了一个警告：

```
Use '$' instead of '.' for inner classes (or use only lowercase letters in package names)   AndroidManifest.xml 
```

[我在这个链接](https://android.googlesource.com/platform/sdk/+/7ce6049cd1d368d7cd08ac5e22f855f23b2110a7%5E1..7ce6049cd1d368d7cd08ac5e22f855f23b2110a7/)上找到了一些信息。

```
"When you reference an inner class in a manifest file, you must use '$' instead of '.' " +
    "as the separator character, e.g. Outer$Inner instead of Outer.Inner.\n" +
    "\n" +
    "(If you get this warning for a class which is not actually an inner class, it's " +
    "because you are using uppercase characters in your package name, which is not " +
    "conventional.)" 
```

我相信我在子包名称中使用了大写字符，例如`com.abc.app.Promotion`.

问题是：在 manifest.xml 中消除此警告的最佳方法是什么？它仍然可以构建和运行，但我觉得它很烦人。

我尝试使用重构来重命名包并修改了 manifest.xml`android:name="com.abc.app.promotion.Promotion"`但得到了这个错误：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.abc.app/com.abc.app.TabView}: android.content.ActivityNotFoundException: Unable to find explicit activity class {com.abc.app/com.abc.app.promotion.Promotion}; have you declared this activity in your AndroidManifest.xml? 
```

感谢您的帮助！

编辑：原始 manifest.xml

```
<activity android:name=".Promotion.Promotion" ></activity> 
```

更新 manifest.xml

```
<activity android:name="promotion.Promotion" ></activity> 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2015-10-07T07:02:23.700

如果您收到一个实际上不是内部类的类的警告，那是因为您**在包名中使用了大写字符**，这不符合惯例。

我还尝试仅将包名称的第一个字母更改为小写，警告消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-11T18:06:38.903

您必须在包名中使用**小写字母**

或在应用程序标签中添加此 atrr

```
tools:ignore="InnerclassSeparator" 
```

**忽略**这个Waring

# java - Java - 在任何时区将当前日期转换为 UTC 和 UTC

> ID：13622841
> 
> 赞同：3
> 
> 时间：2012-11-29T09:42:18.930
> 
> 标签：java, timezone

我需要两件事：

1.  将当前时间转换为 UTC（所以我可以以 UTC 格式存储日期）-> **result = java.util.Date.**

2.  将加载日期（UTC 格式）转换为任何 TimeZone --> **result = java.util.Date 或毫秒**。

对于这两点，请牢记日光。

1）我在stackoverflow上发现了以下内容：

```
Calendar c = Calendar.getInstance();
System.out.println("current: "+c.getTime());

TimeZone z = c.getTimeZone();
int offset = z.getRawOffset();
if(z.inDaylightTime(new Date())){
    offset = offset + z.getDSTSavings();
}
int offsetHrs = offset / 1000 / 60 / 60;
int offsetMins = offset / 1000 / 60 % 60;

System.out.println("offset: " + offsetHrs);
System.out.println("offset: " + offsetMins);

c.add(Calendar.HOUR_OF_DAY, (-offsetHrs));
c.add(Calendar.MINUTE, (-offsetMins));

System.out.println("GMT Time: "+c.getTime()); 
```

--> 结果等于 UTC？

2)

```
public static long getTimeMillisFromTimeZone(long utcTimeMillis,
        String timeZoneId) {
    System.out.println("input millis: " + utcTimeMillis);
    Calendar calendar = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
    calendar.setTimeInMillis(utcTimeMillis);
    TimeZone fromTimeZone = calendar.getTimeZone();
    TimeZone toTimeZone = TimeZone.getTimeZone(timeZoneId);

    calendar.setTimeZone(fromTimeZone);
    calendar.add(Calendar.MILLISECOND, fromTimeZone.getRawOffset() * -1);
    if (fromTimeZone.inDaylightTime(calendar.getTime())) {
        calendar.add(Calendar.MILLISECOND, calendar.getTimeZone()
                .getDSTSavings() * -1);
    }

    calendar.add(Calendar.MILLISECOND, toTimeZone.getRawOffset());
    if (toTimeZone.inDaylightTime(calendar.getTime())) {
        calendar.add(Calendar.MILLISECOND, toTimeZone.getDSTSavings());
    }

    System.out.println(calendar.getTime());

    System.out.println("output millis: " + calendar.getTime().getTime());
    return calendar.getTime().getTime();
} 
```

--> 我遇到了问题 --> 丢了 1h！

在我的示例中，我将 TimeZone “Europe/Vienna”（使用日光）中的日期以 UTC 格式存储到数据库中。欧洲/维也纳 --> 10:00 UTC --> 09:00

现在我想将此UTC（09:00）转换为“欧洲/维也纳”，我得到：09:00 =我失去了一个小时..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T10:07:01.737

您是否考虑过只使用现有的 DateTime API，例如[Joda](http://joda-time.sourceforge.net/ "乔达")？

**更新**

1.  已经回答：[Joda Time - 时区不同](https://stackoverflow.com/questions/11629936/joda-time-different-between-timezones)

2.  会是一样的，我想只是使用`withZone`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T11:18:35.460

请尝试以下代码（我正在使用**Joda Time**）在时区之间转换日期：

```
public static Date convertDate(Date sourceDate, DateTimeZone sourceTimeZone, DateTimeZone resultTimeZone) {
    LocalDateTime localDateTime = new LocalDateTime(date.getTime());
    DateTime sourceDateTime = localDateTime.toDateTime(sourceTimeZone);
    DateTime resultDateTime = sourceDateTime.withZone(resultTimeZone);
    return resultDateTime.toLocalDateTime().toDateTime().toDate();
} 
```

转换为*UTC*可以简化为：

```
public static Date toUtcDate(Date sourceDate, DateTimeZone sourceTimeZone) {
    return convertDate(sourceDate, sourceTimeZone, DateTimeZone.UTC);
} 
```

这个电话成功为我增加了 1 小时：

```
convertDate(new Date(), DateTimeZone.UTC, DateTimeZone.forID("Europe/Vienna")); 
```

# android - 对话框内的相机方向问题

> ID：13622844
> 
> 赞同：1
> 
> 时间：2012-11-29T09:42:29.620
> 
> 标签：android, dialog, camera, orientation

我正在为平板电脑开发一个 android 应用程序。在我的应用程序中，我提供了条形码扫描功能。我提供了一个相机按钮，单击按钮后将打开一个对话框。在对话框中，我正在显示相机预览。我面临的问题是关于方向。我的应用程序在revesr landscaple 上处于横向模式，所有其他元素以及相应的对话框方向，但对话框内的相机显示颠倒预览。如何在配置更改事件中捕获反向事件在这里没有帮助。![在此处输入图像描述](../Images/8bc46477006cd1069b16823bfa628e41.png)

请提供一些解决方案，因为我搜索了很多但无法解决此问题![在此处输入图像描述](../Images/8bc46477006cd1069b16823bfa628e41.png)

# c# - 是否可以将本地数据部分加载到剑道网格？

> ID：13622845
> 
> 赞同：1
> 
> 时间：2012-11-29T09:42:40.787
> 
> 标签：c#, kendo-ui

我在本地有大量数据，但不想一次将所有数据加载到网格中。是否可以将某些内容加载到页面，然后在滚动到另一个页面后，加载本地数据的另一部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:48:29.317

我假设您在这里使用 ORM：

当然只是返回数据访问代码`IQueryable<T>`

欲了解更多信息，请阅读：

[http://docs.kendoui.c​​om/getting-started/using-kendo-with/aspnet-mvc/helpers/grid/ajax-binding](http://docs.kendoui.com/getting-started/using-kendo-with/aspnet-mvc/helpers/grid/ajax-binding)

它解释了 Kendo 如何为您进行分页和排序。所以生成的 SQL 只会返回网格上显示的内容，而不是所有数据。

从剑道网站：

**如何实现分页、排序、过滤和分组？**

如果您的模型支持 IQueryable 接口或者是 DataTable，则网格将自动进行分页、排序、过滤、分组和聚合。对于服务器绑定方案，不需要额外的步骤 - 只需将 IQueryable 传递给 Grid 构造函数。检查服务器绑定帮助主题以获取更多信息。

对于 ajax 绑定场景，必须使用 ToDataSourceResult 扩展方法来执行数据处理。查看 ajax 绑定帮助主题以获取更多信息。如果您的模型没有实现 IQueryable 自定义绑定，则应该实现。这意味着开发人员负责对数据进行分页、排序、过滤和分组。更多信息可以在自定义绑定帮助主题中找到。

**重要的：**

如果底层 IQueryable 提供程序支持将表达式树转换为 SQL，则所有数据操作都将在数据库服务器级别执行。ASP.NET MVC 的 Kendo Grid 已使用以下框架进行了测试：

实体框架

LINQ转SQL

Telerik OpenAccess

休眠

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:48:33.623

是的，您必须[`serverPaging`](http://docs.kendoui.com/api/framework/datasource#serverpaging%20booleandefault)在 DataSource 定义中启用。您可能也对 KendoUI Grid 感兴趣[`scrollable.virtual`](http://docs.kendoui.com/api/web/grid#scrollablevirtual%20boolean%20default)。

# css - 将填充应用于内部元素时如何自动调整包装高度

> ID：13622848
> 
> 赞同：2
> 
> 时间：2012-11-29T09:42:46.933
> 
> 标签：css

首先请允许我提一下，我知道如何在正常情况下调整高度。尽管如此，我现在遇到了一些棘手的问题，并且我没有在其他帖子中找到解决方案。

我有一个名为“header”的div，占据了页面的整个宽度。
在那个 div 里面有一个名为“wrapper”的 div。它使用边距居中。
在该包装内，左侧有一个徽标浮动，右侧有一个菜单浮动。
前两个 div（标题和包装）假设根据内容（徽标和菜单）自动调整它们的高度。为此，我在浮动 div 之后添加了一个“更清晰”的 div。它工作正常，除非我在菜单的 li 元素上添加一些填充。在这种情况下，div 不会调整。请参阅下面小提琴中的蓝色 li。希望清楚，希望有人可以提供帮助。谢谢你。

小提琴：http : [//jsfiddle.net/Gynft/](http://jsfiddle.net/Gynft/)

HTML：

```
 <div id="header">
        <div id="wrapper">
            <div id="logo">
                [ logo ]
            </div>
            <ul id="menu">
                <li><a href="" class="">AGENDA</a></li>
                <li><a href="" class="">MESSAGERIE</a></li>
                <li><a href="" class="">COMMUNAUTEE</a></li>
                <li><a href="" class="">DECONNEXION</a></li>
            </ul>
            <div class="clearer"></div>
        </div>    
    </div>​ 
```

CSS：

```
body {
font-family:arial;
font-size:10px;
}

.clearer {
clear:both;
}

#header{
background:yellow;

}

#wrapper {
background:green;
width:560px;
margin:20px auto;
}

#logo {
background:purple;
float:left;
}

#menu {
background:orange;
float:right;
}

#menu li {
display:inline;
padding:5px 10px;
background:blue;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:46:34.103

我不能确定为什么这可以解决您的问题，但是将蓝色 li 更改`display`为`inline-block`而不仅仅是 inline 似乎可行！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:46:31.553

嘿，马克很简单，您可以通过以下方式获得所需的结果：`overflow:hidden;`

它是因为你没有清除你的`parent div`并且你已经使用`floating`了你的`child div`所以我有`cleared`你`parent div`的`overflow:hidden;`，现在它可以根据你的要求正常工作。

我希望你看起来像这样......

**CSS**

```
#header, #wrapper {
overflow:hidden;
}

#header{
background:yellow;
}

#wrapper {
background:green;
width:560px;
margin:20px auto;
} 
```

[**演示**](http://jsfiddle.net/Gynft/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:49:46.137

试试这个：

```
#wrapper {
     background: none repeat scroll 0 0 green;
     margin: 20px auto; overflow: hidden;
     width: 560px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-10T04:25:57.030

```
<!DOCTYPE html>
<html>
    <head>
        <title>Page Title</title>
        <style>
            body{
                background:#ededed;
                margin:0 auto;
            }
            .main{
                width:720px;
                border:1px solid red;
                padding:5px;
            }
            .menu-item {
            padding:0;
            margin:0;
            width: 100%;
            border-bottom: 0;
            }
            .menu-item li{
                display: table-cell;
                width: 1%;
                float: none;
                border:1px solid green;
                margin:2px;
                padding:10px;
                text-align:center;
            }
        </style>
    </head>
    <body>
       <div class="main">
                <ul class="menu-item">
                    <li><a href="#">menu item 1</a></li>
                    <li><a href="#">menu item 2</a></li>
                    <li><a href="#">menu item 3</a></li>
                    <li><a href="#">menu item 4</a></li>
                    <li><a href="#">menu item 5</a></li>
                </ul>
       </div>
    </body>
</html> 
```

# ios - 我想在选择 UITableViewCell 的子视图时将其从更改背景中排除

> ID：13622856
> 
> 赞同：4
> 
> 时间：2012-11-29T09:43:07.550
> 
> 标签：ios, uitableview

我想在选择 UITableViewCell 的子视图（**viewz**）时将其排除在更改背景之外。

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
cell.selectionStyle = UITableViewCellSelectionStyleBlue;

UIView *viewz = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 30, 30)];
viewz.backgroundColor = [UIColor redColor];
[cell.contentView addSubview:viewz]; 
```

未选择单元格。一切都好。

[http://img32.imageshack.us/img32/1599/screenshot20121129at123.png](http://img32.imageshack.us/img32/1599/screenshot20121129at123.png)

单元格已将颜色更改为蓝色。没关系。但我不希望我的**viewz**将背景颜色更改为蓝色。我怎样才能做到这一点？

![在此处输入图像描述](../Images/1e2a103a33b1f763d84cf1d8895dee90.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T09:48:47.830

将 setSelected:animated: 方法的空实现添加到 UITableViewCell 子类

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated {

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T13:13:38.047

看来您需要*触摸*背景颜色，否则默认单元格实现会为您更改它。如果您添加彩色边框，您会看到`viewz`仍然存在，即使您评论我更改背景颜色的行：

```
#define VIEWZ_TAG 1234

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    ... 
    UIView *viewz = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 30, 30)];
    viewz.backgroundColor = [UIColor redColor];
    viewz.tag = VIEWZ_TAG;
    viewz.layer.borderWidth = 1;
    viewz.layer.borderColor = [UIColor whiteColor].CGColor;
    [cell.contentView addSubview:viewz];
    ...
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    if ([cell isSelected]) {
        UIView *viewz = [cell viewWithTag:VIEWZ_TAG];
        viewz.backgroundColor = [UIColor greenColor];
    }
} 
```

如果您想在选择单元格时对其进行精细控制，您可以使用自定义`UITableViewCell`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T09:58:45.583

您只需添加自定义单元格，并在选择行上更改该视图的背景颜色。

# java - 在不存在 NDK 的情况下使用的基于 JNI 的 Android 库

> ID：13622857
> 
> 赞同：2
> 
> 时间：2012-11-29T09:43:10.377
> 
> 标签：java, android, c++, sdk, android-ndk

我的任务是编写一个 Android 库，该库将使用 JNI 链接在 C++ 中部分实现。但是，这个库将提供给外部开发人员，我不想麻烦他们安装 NDK 框架。

有没有人有开发包含 JNI 链接、不需要用户环境包含 NDK 的 Java 库的经验？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T12:52:34.510

即使您要提供完整的源代码，也要为 NDK 支持的所有架构提供 so 文件。这样他们就不需要使用 NDK 一遍又一遍地构建相同的共享对象 (so) 文件。

您可以通过添加`APP_ABI := all`您的`Application.mk`. 所有这些功能都记录在`$NDK/docs`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T13:35:37.200

是的，您可以分发预编译的原生二进制文件，“经典”Android 开发人员无需安装 NDK 即可使用这些文件。他们可以将二进制文件放入**libs/<ABI>**文件夹（对于您和他们想要支持的所有 ABI），甚至将这些二进制文件保存在他们的源代码控制系统中。

他们应该知道，当他们更新任何这些二进制文件时，Eclipse 不会自动重建 APK。

# objective-c - 如何在Objective C中释放另一个对象拥有的对象

> ID：13622864
> 
> 赞同：0
> 
> 时间：2012-11-29T09:43:24.983
> 
> 标签：objective-c, ios, xcode

在Objective C中，如何显式释放另一个对象拥有的对象？或者也许等效地通知拥有对象它不再拥有子对象。考虑以下：

```
- (void) testWithNSString:(NSString *)val
{
  NSData *data = [val dataUsingEncoding:NSASCIIStringEncoding];
  // ...
  // now I want to explicitly release data e.g. due to low memory
} 
```

`[val dataUsingEncoding:NSASCIIStringEncoding]`返回一个对象，并且`NSData`我假设（由于所有权的一般约定）它将在何时`val`释放。从不泄漏的角度来看，这似乎是可以接受的。但这种策略提出了两个问题：

1.  如果我想`data`立即显式释放对象，例如由于内存不足怎么办？
2.  如果我不希望调用者`testWithNSString`留下一个突然拥有新对象所有权的`NSString val`对象（在返回之后）怎么办？`testWithNSString`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:49:44.713

首先，你**永远不**应该释放不属于你的对象。释放时返回的`NSData`对象**不会**`val`被释放。这两个对象是完全独立的（`data`源自 的除外`val`）。

`dataUsingEncoding:`返回一个自动释放的对象。这意味着`data`将在运行循环结束时释放。

如果您担心内存不足并希望它更早释放，您可以使用[`NSAutoreleasePool`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSAutoreleasePool_Class/Reference/Reference.html)池：

```
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
NSData *data = [val dataUsingEncoding:NSASCIIStringEncoding];
// do something with data.
[pool release]; 
```

这将`data`在您释放池时释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:47:04.573

> 在 [val dataUsingEncoding:NSASCIIStringEncoding] 中返回一个 NSData 对象，我假设（由于所有权的一般约定）它会在 val 被释放时被释放

这是不正确的。`dataUsingEncoding`将创建一个与（就生命周期`NSData`而言）没有关系的新对象。`val`它是一个`autoreleased`对象，它将在运行循环的下一个周期被释放（大约，我们不知道确切），除非你以某种方式保留它。

> 如果我想立即显式释放数据对象，例如由于内存不足怎么办？

如果您希望立即释放对象，并且您正在使用 ARC，您可以简单地将 nil 分配给它的指针：

```
data = nil; 
```

如果您不使用 ARC，最好的选择是等待运行循环自动释放池完成其工作。或者您可以在您的方法中创建一个本地自动释放池，以便自动释放的对象在方法结束时排出，而不是在下一个运行循环周期。这只会在长时间运行的方法（或方法链）的情况下产生影响，所以我不知道这对你的情况是否有意义。

> 如果我不希望 testWithNSString 的调用者留下一个 NSString val 对象（在 testWithNSString 返回之后），它突然拥有新对象的所有权怎么办？

正如我所说，`val`没有所有权`data`。

总而言之，您的`data`对象是自动释放的，并且在您的方法结束后很快就会释放（除非它是一个长时间运行的方法）；所以`data`内存将以一种有效的方式恢复，我不会担心它（除非它是一种长时间运行的方法，正如我所说的）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-29T09:48:12.500

假设您使用的是 ARC，设置`val`为 nil 应该会释放它。

# c# - 隐藏 Windows 7 通知区域

> ID：13622866
> 
> 赞同：0
> 
> 时间：2012-11-29T09:43:32.060
> 
> 标签：c#, windows, api

我们的 IT 团队非常烦人地设置了一个组策略来显示所有通知图标。显然我们的一些员工找不到打印机图标。我目前正在查看 18 个图标。

我的问题是，最好使用 c#，我可以强制 Windows 将通知区域返回到其通常的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:08:37.447

我只是给 IT 部门发电子邮件。要求被排除在此特定 GPO 之外。这里不需要编码。

[此链接](http://www.grouppolicy.biz/2010/05/how-to-exclude-individual-users-or-computers-from-a-group-policy-object/)看起来像是您可以转发给 IT 部门的内容。以供将来参考，解释如何完成此特定任务。

**编辑**

如果您是计算机上的本地管理员，您还可以尝试遵循[超级用户问题](https://serverfault.com/questions/65011/how-can-i-override-group-policy-using-a-local-administrator-account)中关于覆盖 GPO 的建议。

# wpf - 交互式形状的设计注意事项

> ID：13622867
> 
> 赞同：1
> 
> 时间：2012-11-29T09:43:38.517
> 
> 标签：wpf, xaml

我有`Grid`一个任意数量（可能是数千个）填充[形状](http://msdn.microsoft.com/en-us/library/ms747393.aspx)的状态（鼠标悬停，选择，拖动......）。如果多个对象重叠，悬停/单击它们应选择其中心点最接近鼠标位置的对象。

考虑到性能和代码设计，解决这个问题的最佳方法是什么？

## 一些问题

1.  我应该在后面的代码中创建形状并将它们添加到某些网格的子项中，还是应该将一些巧妙的 XAML 绑定到某些对象的列表（有教程会很好）？
2.  我想处理鼠标事件。每个形状是否应该有自己的鼠标处理程序，或者我应该为父网格有*一个*鼠标处理程序，我在其中寻找最近的形状？
3.  形状样式应该可由用户编辑。我应该在后面的代码中将它们定义为资源或属性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:50:27.190

一些想法：

1.  为什么要使用网格？看起来[Canvas](http://wpftutorial.net/Canvas.html)会更好地满足您的需求。

2.  使用路由事件。只需处理容器的事件（鼠标xxx，然后找出鼠标所在的位置以及必须接收动作的形状是什么）。

3.  您必须定义一个具有公共 Style 属性的通用形状控件，最终用户可以在其中声明自己的样式。

# sql-server - SQL Server 2008 指示要匹配的第一行，而不是其他行

> ID：13622869
> 
> 赞同：1
> 
> 时间：2012-11-29T09:43:43.440
> 
> 标签：sql-server, sql-server-2008

这是一个疯狂的问题，但基本上我们需要标记与条件匹配的第一行，而不是其余的，例如，我们有所有用户每日登录的历史记录，但每个月我们都希望显示特定日期之前的登录，例如：

```
UserId     LoginDate
1          2011-12-31
2          2012-12-31
1          2012-01-01
2          2012-01-02
1          2012-01-02
2          2012-01-03 
```

ETC....

我们想要一个 SQL 查询，它将返回每个月的第一个登录名，结果集中类似于：

```
UserId     LoginDate     WasFirstLoginOfMonth
1          2011-12-31    0
2          2012-12-31    0
1          2012-01-01    1
2          2012-01-02    1
1          2012-01-02    0
2          2012-01-03    0 
```

ETC....

我知道这似乎是一个疯狂的要求，但我们需要知道哪个登录满足特定的日期条件，但只有一个可以，其余的不能。

有没有什么办法可以做到这一点，而无需对每一行进行缓慢的子选择以查看它是否是第一行？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:50:36.020

该`row_number()` 功能允许您对数据进行分区和排序。

所以在这个查询中， rn 代表登录的序号，按用户、年份和月份，所以当该值为 时`1`，即是该月的第一次登录。

```
select * 
from
(
select *, 
       row_number() over 
       (
            partition by userID, 
            year(logindate),
            month(logindate)
            order by logindate
       ) rn
from yourtable
)  v
where rn = 1 
```

# magento - Magmi 导入脚本停止

> ID：13622870
> 
> 赞同：1
> 
> 时间：2012-11-29T09:43:55.267
> 
> 标签：magento, magmi

我有用于 Magento 的神奇脚本 Magmi，但是当我导入大型 CSV 时，它似乎每次都停在同一个地方。我尝试从浏览器和 curl 运行，但得到相同的结果。

我正在进口 100 万件产品，但它在 100,000 件左右或进口大约 8-9 分钟时停止。我在浏览器中没有收到任何错误，它只是在 10% 左右停止。而在 CURL 中它就退出了。

如果我再次运行导入以仅导入新的，它将最多导入大约 200,000 个。

有任何想法吗？php mem 限制 2gb，php 最大执行超时 3000000，apache 超时 3000000。

干杯

麦克风

# django - django 精确和 iexact 提供相同的结果

> ID：13622871
> 
> 赞同：0
> 
> 时间：2012-11-29T09:43:57.643
> 
> 标签：django, django-models

我有下表条目，

```
mysql> select id,name from categories;
+----+------------------------+
| id | name                   |
+----+------------------------+
|  8 | Application Process    |
|  9 | Payments               |
| 11 | Account Information    |
| 12 | Customer Support       |
| 13 | Technical Issues       |
| 15 | Most Popular Questions |
+----+------------------------+
6 rows in set (0.01 sec) 
```

我给出了以下两个查询，并且都给出了相同的结果：

```
>>> categories.objects.filter(name__exact="payments")[0].name
u'Payments'
>>> c.objects.filter(name__iexact="payments")[0].name
u'Payments' 
```

这是我的模型：

```
class categories(models.Model):
 name  = models.CharField(max_length=32)
 parent  = models.ForeignKey('self', null=True, blank=True, related_name='children')
 frequency=models.IntegerField(max_length=10, blank = True, null = True)
 class Meta:
  db_table='categories' 
```

我的问题是，为什么精确和 iexact 提供相同的结果？为什么有两种不同的功能/方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T10:54:42.073

[正如Django 文档所建议](https://docs.djangoproject.com/en/dev/ref/models/querysets/#exact)的那样，您似乎必须更改数据库排序规则；另请参阅有关[mysql 排序规则](https://docs.djangoproject.com/en/dev/ref/databases/#mysql-collation)的说明。例如，使用 utf8_general_ci_swedish，不可能进行不区分大小写的比较。用 utf8_bin 试试。

# android - Eclipse android应用程序min3d错误

> ID：13622873
> 
> 赞同：1
> 
> 时间：2012-11-29T09:44:00.880
> 
> 标签：android, opengl-es, java-3d

我已经从谷歌代码中检查了 min3d 并尝试将其导入到 Eclipse 中。

为此，我转到 File -> New -> other -> Android 并选择 Open existing Android application from source

并选择`min3d-read-only\sampleProjects\min3dSampleProject1` 并单击下一步

现在我收到以下错误`" Build path contains duplicate entry :'src' for project "SplashActivity"`

原因`" Build path contains duplicate entry :'src' for project "SplashActivity"`

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T07:18:28.673

您下载的文件并不意味着您可以作为应用程序运行，它只是供您参考的源代码。

如果您想查看应用程序，您可以到 Google Play 下载应用程序，

您可以将 src 文件夹中提供的库包含到您的应用程序项目中。

# php - PHP 显示没有 Echo/Print 的 HTML 标签

> ID：13622875
> 
> 赞同：1
> 
> 时间：2012-11-29T09:44:05.733
> 
> 标签：php, html

我有这个代码：

```
foreach($result as $i->$res)
{
    $link = "Company/" . str_replace(" ", "-", $view->result[$i]->node_title);

    $query = mysql_query("select * from url_alias where alias = '$link'");

    if(mysql_num_rows($query) > 0)
    {
        $result[$i]->node_title = "<a href = 'http://www.google.com'>asdf</a>";
    }
    else
    {
        $result[$i]->node_title = $result[$i]->node_title;
    }           
    $i++;
} 
```

如何将锚文本显示为链接而不回显或打印？现在锚文本只显示为纯文本。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:51:08.203

如果您的页面是 html 文件

然后像这样回显链接

```
 <a href = 'http://www.google.com'>asdf</a> 
```

如果您的页面是 php，则在您编写时回显链接。

如果您的页面是 html，那么它将无法使用该链接。

# user-interface - 有没有办法以编程方式调用 GuiSize 标签？

> ID：13622880
> 
> 赞同：0
> 
> 时间：2012-11-29T09:44:15.453
> 
> 标签：user-interface, autohotkey

`Gosub`不让`A_GUI`和`A_GUIEvent`被访问。`WinMove`并将消息 0x03 发送到窗口不起作用。

我在 GUISize 标签中有一些窗口调整例程，当我使用`GUIControl, Show/Hide`控件时，出现了一些渲染问题；控件不出现。`WinSet, Redraw,`没有帮助。但是，如果我手动调整窗口大小并调用 GUISize 标签及其例程，它会重新绘制正常。

所以我正在寻找一种人工触发GUI尺寸标签的方法。可能吗？

```
Gui, New, hwndhwndGUI Resize 
Gui, Margin, 30, 30
Gui, Add, Text, w100, Hello World
Gui, Show, Center
Return
GuiSize:
    tooltip % A_GUI ", " A_GUIEvent
Return

^1::GoSub, GuiSize      ; A_GUI, A_GUIEvent are not sent 
^2::
    WinGetPos, X, Y, W, H, ahk_id %hwndGUI%
    WinMove, X+1, Y, W+1, H, ahk_id %hwndGUI%   ; does not trigger the GUISize label.
Return
^3::SendMessage, 0x03,,,, ahk_id %hwndGUI%   ; does not work 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T19:03:39.300

好的，这行得通。

```
SendMessage, 0x05,,,, ahk_id %hwndGUI% 
```

# .net - XmlDocument 加载 Xml 而不进行验证

> ID：13622882
> 
> 赞同：0
> 
> 时间：2012-11-29T09:44:17.440
> 
> 标签：.net, xml

有一些不好的 xml ，例如：

```
NaN&lt;/td>&lt;td id=&quot;DemTechLimit8&quot;>NaN&lt;/td>&lt;td id=&quot;DemCommercLimit8&quot;>NaN&lt;/td>&lt;td id=&quot;AoValue8&quot;>NaN&lt;/td>&lt;/tr>&lt;tr>&lt;td id=&quot;DemInt9&quot;>8:00 - 9:00
&lt;/td>&lt;td id=&quot;DemValue9&quot;>1&lt;/td>&lt;td id=&quot;DemValueDeclined9&quot;>NaN&lt;/td>&lt;td id=&quot;CalcValue9&quot;>NaN&lt;/td>&lt;td id=&quot;LoadLoss9&quot;>NaN&lt;/td>&lt;td id=&quot;DemTechLimit9&quot;>NaN&lt;/td>&lt;td id=&quot;DemCommercLimit9&quot;>NaN&lt;/td>&lt;td id=&quot;AoValue9&quot;>NaN&lt;/td>&lt;/tr>&lt;tr>&lt;td id=&quot;DemInt10&quot;>9:00 - 10:00
&lt;/td>&lt;td id=&quot;DemValue10&quot;>1&lt;/td>&lt;td id=&quot;DemValueDeclined10&quot;>NaN&lt;/td>&lt;td id=&quot;CalcValue10&quot;>NaN&lt;/td>&lt;td id=&quot;LoadLoss10&quot;>NaN&lt;/td>&lt;td id=&quot;DemTechLimit10 
```

如何在没有任何验证或 dtd 的情况下将其加载到 XmlDocument 中？

它用于数字签名目的，所以我不能替换特殊字符或格式化它。

这是关于 JS 的示例，但我需要 .NET 代码：

```
xmldoce.async = false;
xmldoce.validateOnParse = false;
xmldoce.preserveWhiteSpace = false;
xmldoce.resolveExternals = false;
xmldoce.loadXML(...); 
```

**编辑：**

我需要将该内容加载到由模式定义的对象：

```
<complexType name="ObjectType" mixed="true">
<sequence minOccurs="0" maxOccurs="unbounded">
<any namespace="##any" processContents="lax"/>
</sequence> 
</complexType> 
```

也许没有 XmlDocument 是可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:49:21.640

它不是一个 xml 。它似乎是一个 html。您可以将其解码为

```
var html = HttpUtility.HtmlDecode(input); 
```

并且很可能您将需要[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)来解析它。

下面的示例从您的字符串中提取一些有用的东西

```
var html = HttpUtility.HtmlDecode(input);
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);
var result = doc.DocumentNode.Descendants("tr")
              .Select(tr=>tr.Descendants("td").Select(td => td.InnerText).ToList())
              .ToList(); 
```

# javascript - 剑道网格更新窗口缩放效果坏了

> ID：13622884
> 
> 赞同：1
> 
> 时间：2012-11-29T09:44:22.880
> 
> 标签：javascript, kendo-ui

我在 KendoUI 以前的版本中有一个基于 Web 的网格，现在将 KendoUI 刷新到 Kendo Web 2012 Q3，但是在以前版本中工作的网格产生了一个错误：当我尝试打开更新或创建窗口时，它开始了使用 0.01 缩放（我认为是 CSS3），并且它没有动画到 1 缩放，保持在 0.01。

![你可以在这张图片中看到它](../Images/1f15bd57cb475b2ba057621fba26319b.png).

临时解决方案现在是“关闭”缩放效果，重写这一行：

```
createToggleEffect("zoom", "scale", 0.01); 
```

到

```
createToggleEffect("zoom", "scale", 1); 
```

在`kendo.web.js`文件中，在第 3780 行，但我想恢复我的缩放效果。

这是一个记录在案的错误，还是我的错误？任何人都可以帮助我如何解决它？

PS：我在 Chromium 和 Firefox 上测试过，都显示了这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T07:14:40.423

这是由 jQuery 1.7 和 1.8 之间的 css() 方法行为变化引起的问题。我们在最新的内部版本中修复了该问题，但作为一种解决方法，您只需升级到 jQuery 1.8，问题就会消失。

# haskell - Haskell 中的内存高效虚拟值

> ID：13622886
> 
> 赞同：4
> 
> 时间：2012-11-29T09:44:38.940
> 
> 标签：haskell, map, set, trie, singleton-type

如果我有键到值的映射，那么键集可以实现为键到固定虚拟值的映射。

有许多假人候选人：

*   `data`- 没有构造函数的定义类型
*   其他无人居住的类型（例如`forall a . a`）
*   单例类型
*   未装箱的类型

对我来说最明显的解决方案是使用库存单例类型`()`，但`case`我可以从底部区分`()`，所以我认为内存表示`()`包括间接。

我有两个问题：

*   是否`Map.fromList [(1, ()), (2, ())]`占用更多内存`let dummy = () in Map.fromList [(1, dummy), (2, dummy)]`？
*   考虑到内存占用、cpu 使用率和正确性，建议从[bytestring-trie](http://hackage.haskell.org/packages/archive/bytestring-trie/0.1.4/doc/html/Data-Trie.html)`dummy`构造集合的值是多少？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T11:56:51.033

Nullary 构造函数只分配一次。然后共享它们的所有用途（在 GHC 中；这种行为不受 Haskell 标准的规定）。

`()`是单元类型的空构造函数`()`。因此，到处使用`()`几乎不会消耗任何内存。但是，如果您将类型参数实例化为`()`，您仍然需要为该参数的存在付费。这就是为什么例如有一个专门`Set a`的而不是 using的原因`Map a ()`。

对于键值数据结构，您需要具有适当值的类型。因此，`()`是正确的选择，而空数据类型则不是。多态类型，例如，`forall a. a`还需要包装在另一个数据类型中，或者如果用作参数，则需要不可预测性，这通常不受很好的支持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T13:10:24.427

键都将是（表示为）指向单个分配的`()`构造函数的指针。

# sql - 使用访问查询中的条件全选

> ID：13622890
> 
> 赞同：2
> 
> 时间：2012-11-29T09:44:55.110
> 
> 标签：sql, ms-access, ms-access-2007, criteria

我有一个 Access 2007 查询。在条件中，如果表单中的过滤器设置为“查看所有组织”，我需要它来选择所有记录。但是，我无法让它工作。以下标准：

```
=IIf([Forms]![Reports]![Referrals - Business Filter]="View all organisations","Like '*'") 
```

该标准通常有效 - 如果我将“Like '*'”更改为特定的内容，例如“Barclays”，那么它会选择该业务下列出的正确联系人，但这不是我想要实现的。

我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:58:53.313

你遇到了一些有趣的事情！您试图让查询*评估*的“Like *”不是文字字符串，而是一个逻辑表达式（其评估结果为 True 或 False）。

当您使用 Iif 在 SQL 中的不同比较表达式之间切换时（严格来说，Iif 是 Access VBA，而不是 SQL，但 Access 允许您在一定程度上在查询中使用 VBA），您只能在文字值之间切换。例如 1、453.5、“This”、“A customer name”。

切换到“LIKE *”表达式相当于即时编写 SQL。就像我在说“我今天喝了 (Iif(It's Friday, (5-4), (6/2)) 杯咖啡”。你的大脑可以在上下文中处理这种从字面英语到必须是评估（并且今天，相当于英文字面单词“one”）；Access也可以 - 在一定程度上。但不是评估这个：

```
[AColumn] = "Like *" 
```

并将其解释为

```
[AColumn] LIKE "*" 
```

解决方法是将检查“查看全部”是否选择到单独的测试中：

```
WHERE
([Selection on the form]="View all") OR
([AColumn]=[Selection on the form]) 
```

# google-drive-api - Google Drive Site Publishing 的限制和加载速度是什么？

> ID：13622894
> 
> 赞同：9
> 
> 时间：2012-11-29T09:45:11.150
> 
> 标签：google-drive-api

*   允许多少请求？
*   允许多少带宽？
*   加载速度与亚马逊的 S3 / CloudFront 相比如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T08:05:23.560

请求：您可以从 API 仪表板 (https://code.google.com/apis/console/) 中找到 Drive API 每日 500,000 个请求/天的配额（“礼貌限制”）

带宽：Google Apps for Business 和 Education 已发布带宽限制，但我不知道这些是否与 Drive API 相同：

```
Download: 750 MB/hr and 1250 MB/day
Upload: 300 MB/hr and 500 MB/day 
```

[http://support.google.com/a/bin/answer.py?hl=en&answer=1071518](http://support.google.com/a/bin/answer.py?hl=en&answer=1071518)

与亚马逊的 S3 / CloudFront 相比？我不相信这是同类比较。Drive 必须与 DropBox、Box.com、SkyDrive、iCloud 等进行比较。

> Google Cloud Storage 使应用程序开发人员能够以非常高的可靠性、性能和可用性将他们的数据存储在 Google 的基础架构上。如果您希望将个人数据存储在云中，请考虑改用 Google Drive。或者，如果您是想要与 Google Drive 集成的应用程序开发人员，您可以使用 Google Drive SDK 来实现。 [https://developers.google.com/storage/docs/getting-started](https://developers.google.com/storage/docs/getting-started)

# python - 通过 Google App Engine 在 Web2Py 中的交易

> ID：13622895
> 
> 赞同：0
> 
> 时间：2012-11-29T09:45:15.053
> 
> 标签：python, google-app-engine, web2py

我正在通过 Google App Engine 在 Web2Py 中制作房间预订系统。当用户预订房间时，系统必须确保该房间确实可用，并且之前没有其他人预订过。为了确保我查询房间是否可用，然后我进行预订。问题是我怎样才能以一种“互斥”的方式进行交易，以确保这个房间真的是给这个用户的？

谢谢！！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T12:25:54.057

DBMS 中已经内置了互斥，所以我们只需要使用它。让我们举个例子。

首先，您在模型中的表应该以这样一种方式定义，即您的房间号应该是唯一的（使用 UNIQUE 约束）。

当 User1 和 User2 都查询房间时，他们应该得到一个回复​​说房间是空的。当两个用户同时发送该房间的“BOOK”请求时，预订功能应直接将两个用户的“BOOK”请求插入数据库。但实际上只有一个会被执行（因为 UNIQUE 约束），另一个会产生 DAL 异常。捕捉异常并回复“预订”请求不成功的用户，说你只是瞬间错过了这个房间:-)

希望这有帮助。

# javascript - 如果使用javascript存在辅助监视器，我怎么能设法在辅助监视器中打开一个弹出窗口？

> ID：13622897
> 
> 赞同：-2
> 
> 时间：2012-11-29T09:45:22.973
> 
> 标签：javascript

如果使用javascript存在辅助监视器，我怎么能设法在辅助监视器中打开一个弹出窗口？太感谢了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:49:29.630

您无法使用 JavaScript 检测“辅助监视器”。JS 无法访问硬件，就像那样。

更不用说用户通常不喜欢浏览器控制窗口的事实（调整大小/移动它们等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:50:20.310

这是不可能的，感谢这一点，如果用户有两个显示器，他决定选择在哪个显示器中显示哪些应用程序，而不是相反。

# android - 如何在图像视图中拖动时找到图像的结尾

> ID：13622903
> 
> 赞同：1
> 
> 时间：2012-11-29T09:45:59.357
> 
> 标签：android, matrix, bitmap, android-imageview

我有一个图像视图并使用位图显示图像。捏缩放由矩阵完成。对于缩放，我使用“ **Matrix.postScale** ”方法。在平移（拖动）图像时，我需要限制拖动。当它到达图像的末尾时，我需要停止拖动。

虽然缩放图像得到扩展，但图像视图的高度和宽度以及位图保持不变。拖动时到达图像末尾时如何找到。

我在下面给出的代码和 xml。

```
<AbsoluteLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/framlayout"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#000000"
android:orientation="vertical" >

 <ImageView 
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="0.70"
    android:layout_gravity="center"
    android:background="#000000"
    android:scaleType="matrix"
    /> 
```

Java代码在这里

```
 public boolean onTouch(View v, MotionEvent event) {

        ImageView view = (ImageView) v;
       switch (event.getAction() & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN:
            savedMatrix.set(matrix);
            start.set(event.getX(), event.getY());
            mode = DRAG;
            break;
        case MotionEvent.ACTION_POINTER_DOWN:
            oldDist = spacing(event);
            if (oldDist > 10f) {
                savedMatrix.set(matrix);
                midPoint(mid, event);
                mode = ZOOM;
            }
            break;
        case MotionEvent.ACTION_UP:
            if(!IsZoomMode){
            matrix.set(savedMatrix);
            matrix.postTranslate(0,0);
            }
            break;
        case MotionEvent.ACTION_POINTER_UP:

             mode = NONE;
            break;
        case MotionEvent.ACTION_MOVE:
            if(nTimerCountM < 30 &&  !bEnabledTaggingM)
             {              
                 nTimerCountM = 0;
            if (mode == DRAG) {
                matrix.set(savedMatrix);
                matrix.postTranslate(event.getX() - start.x, event.getY()
                        - start.y);                   
            } else if (mode == ZOOM) {
                IsZoomMode = true;
                float newDist = spacing(event);
                if (newDist > 10f) {
                    matrix.set(savedMatrix);
                    float scale = newDist / oldDist;
                    matrix.postScale(scale, scale, mid.x, mid.y);
                }                 
            }
          }
            break;
        }
        view.setImageMatrix(matrix);         
  }               
        return true;        
    }  
    /** Determine the space between the first two fingers */
private float spacing(MotionEvent event) {
    float x = event.getX(0) - event.getX(1);
    float y = event.getY(0) - event.getY(1);
    return FloatMath.sqrt(x * x + y * y);
}

/** Calculate the mid point of the first two fingers */
private void midPoint(PointF point, MotionEvent event) {
    float x = event.getX(0) + event.getX(1);
    float y = event.getY(0) + event.getY(1);
    point.set(x / 2, y / 2); 
```

# list - 带有添加项目功能的煎茶触摸列表

> ID：13622905
> 
> 赞同：2
> 
> 时间：2012-11-29T09:46:02.630
> 
> 标签：list, sencha-touch-2, add

我有一个列表（Ext.dataview.List），我想在列表末尾添加一个文本框，以便向该列表中添加一个项目。我的问题有内置的解决方案吗？

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:32:09.677

没有内置解决方案，但我曾经做过这样的事情。

[看看我的回答here。](https://stackoverflow.com/questions/8892792/dynamically-add-input-to-list-item-ios5-reminder-like)

希望这有帮助

# php - 通过php限制用户输入

> ID：13622908
> 
> 赞同：1
> 
> 时间：2012-11-29T09:46:13.510
> 
> 标签：php, validation, input, special-characters

我有一个用户名文本框。它应该只接受 3 到 10 个字符，它应该只接受 (0, 9) 和 (A , Z) 值，或者可能是 (- 和 _)，仅此而已
。

如果用户输入一个像 $%^# 这样的值，它应该会给出一个错误
，我想用 PHP 来做这个，而不是 Jquery。谁能帮我这个？

我知道我可以使用

```
<input name="1" type="text" value="1" maxlength="10" /> 
```

但它不会给用户一个错误，只是过滤输入值。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:52:23.057

正则表达式可以工作

```
if (preg_match("%^[A-Za-z0-9-_]{3,10}$%", $_POST["1"])) {
    // OK
} else {
    // ERROR
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:51:59.993

`$_REQUEST`当值提交到您的 PHP 脚本时，您可以通过全局变量查看它。在这种情况下，您将引用`$_REQUEST["1"]`. 要确保它包含的值具有一定的大小，请使用该`strlen()`函数。要确保该值仅包含某些字符，您可以使用`preg_match_all()`适当的正则表达式，如下所示：

```
[A-Za-z0-9] 
```

# python - Matplotlib：如何有效地将大量线段着色为独立渐变

> ID：13622909
> 
> 赞同：8
> 
> 时间：2012-11-29T09:46:17.410
> 
> 标签：python, matplotlib, gradient

Python。*matplotlib*：**如何有效地将大量线段着色为独立渐变？**
已经阅读[***了这个***](https://stackoverflow.com/questions/8500700/how-to-plot-a-gradient-color-line-in-matplotlib)、[***这个***](http://matplotlib.org/examples/pylab_examples/multicolored_line.html)和其他的东西；他们都不是我们的答案！

我们有许多单独的线希望以渐变颜色绘制每条线。

上面第一个链接中提到的解决方案，如果您有多个字符串，则不起作用。换句话说，改变颜色循环会影响绘图中的所有内容，而不是唯一的兴趣线。*这根本不符合我们的兴趣。*

指向 matplotlib 站点的第二个链接使用将每行分割成许多行。这不是一个好方法，因为对于大量的行，比如 10000 甚至更多；即使您只选择每行 10 段，结果也太大了！即使这样，产生的线条也根本没有平滑着色！如果你将分割的数量作为线段的函数以获得更好的梯度，那么结果将非常巨大！难以显示，难以正确保存为文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-30T17:11:08.497

一个（次要）加速将是添加单个行集合而不是 10000 个单独的行集合。

只要所有线条共享相同的颜色图，您就可以将它们组合成一个线条集合，并且每条线条仍然可以具有独立的渐变。

Matplotlib 对于这种事情仍然很慢。它针对质量输出进行了优化，而不是快速绘制时间。但是，您可以稍微加快速度（~3x）。

所以，作为我认为你现在可能（？）这样做的一个例子：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.collections import LineCollection
# Make random number generation consistent between runs
np.random.seed(5)

def main():
    numlines, numpoints = 2, 3
    lines = np.random.random((numlines, numpoints, 2))

    fig, ax = plt.subplots()
    for line in lines:
        # Add "num" additional segments to the line
        segments, color_scalar = interp(line, num=20)
        coll = LineCollection(segments)
        coll.set_array(color_scalar)
        ax.add_collection(coll)
    plt.show()

def interp(data, num=20):
    """Add "num" additional points to "data" at evenly spaced intervals and
    separate into individual segments."""
    x, y = data.T
    dist = np.hypot(np.diff(x - x.min()), np.diff(y - y.min())).cumsum()
    t = np.r_[0, dist] / dist.max()

    ti = np.linspace(0, 1, num, endpoint=True)
    xi = np.interp(ti, t, x)
    yi = np.interp(ti, t, y)

    # Insert the original vertices
    indices = np.searchsorted(ti, t)
    xi = np.insert(xi, indices, x)
    yi = np.insert(yi, indices, y)

    return reshuffle(xi, yi), ti

def reshuffle(x, y):
    """Reshape the line represented by "x" and "y" into an array of individual
    segments."""
    points = np.vstack([x, y]).T.reshape(-1,1,2)
    points = np.concatenate([points[:-1], points[1:]], axis=1)
    return points

if __name__ == '__main__':
    main() 
```

相反，我建议按照这些思路做一些事情（唯一的区别在于`main`函数）：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.collections import LineCollection
# Make random number generation consistent between runs
np.random.seed(5)

def main():
    numlines, numpoints = 2, 3
    points = np.random.random((numlines, numpoints, 2))

    # Add "num" additional segments to each line
    segments, color_scalar = zip(*[interp(item, num=20) for item in points])

    segments = np.vstack(segments)
    color_scalar = np.hstack(color_scalar)

    fig, ax = plt.subplots()
    coll = LineCollection(segments)
    coll.set_array(color_scalar)
    ax.add_collection(coll)

    plt.show()

def interp(data, num=20):
    """Add "num" additional points to "data" at evenly spaced intervals and
    separate into individual segments."""
    x, y = data.T
    dist = np.hypot(np.diff(x - x.min()), np.diff(y - y.min())).cumsum()
    t = np.r_[0, dist] / dist.max()

    ti = np.linspace(0, 1, num, endpoint=True)
    xi = np.interp(ti, t, x)
    yi = np.interp(ti, t, y)

    # Insert the original vertices
    indices = np.searchsorted(ti, t)
    xi = np.insert(xi, indices, x)
    yi = np.insert(yi, indices, y)

    return reshuffle(xi, yi), ti

def reshuffle(x, y):
    """Reshape the line represented by "x" and "y" into an array of individual
    segments."""
    points = np.vstack([x, y]).T.reshape(-1,1,2)
    points = np.concatenate([points[:-1], points[1:]], axis=1)
    return points

if __name__ == '__main__':
    main() 
```

两个版本都生成相同的图：

![在此处输入图像描述](../Images/96dda953aa8f82fecf1e0ab0ddbe05f1.png)

* * *

但是，如果我们将行数增加到 10000 行，我们将开始看到性能上的显着差异。

使用 10000 行，每行 3 个点，另外还有 20 个点用于颜色渐变（每行 23 段），并查看将图形保存到 png 所需的时间：

```
Took 10.866694212 sec with a single collection
Took 28.594727993 sec with multiple collections 
```

因此，在这种特殊情况下，使用单行集合将提供不到 3 倍的加速。它不是一流的，但总比没有好。

这是时序代码和输出图，无论其价值如何（由于绘图的顺序不同，输出图并不完全相同。如果您需要控制 z 级别，则必须坚持使用单独的线集） ：

![在此处输入图像描述](../Images/54993eaae4265786fde090724b509bd0.png)

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.collections import LineCollection
import time
# Make random number generation consistent between runs
np.random.seed(5)

def main():
    numlines, numpoints = 10000, 3
    lines = np.random.random((numlines, numpoints, 2))

    # Overly simplistic timing, but timeit is overkill for this exmaple
    tic = time.time()
    single_collection(lines).savefig('/tmp/test_single.png')
    toc = time.time()
    print 'Took {} sec with a single collection'.format(toc-tic)

    tic = time.time()
    multiple_collections(lines).savefig('/tmp/test_multiple.png')
    toc = time.time()
    print 'Took {} sec with multiple collections'.format(toc-tic)

def single_collection(lines):
    # Add "num" additional segments to each line
    segments, color_scalar = zip(*[interp(item, num=20) for item in lines])
    segments = np.vstack(segments)
    color_scalar = np.hstack(color_scalar)

    fig, ax = plt.subplots()
    coll = LineCollection(segments)
    coll.set_array(color_scalar)
    ax.add_collection(coll)
    return fig

def multiple_collections(lines):
    fig, ax = plt.subplots()
    for line in lines:
        # Add "num" additional segments to the line
        segments, color_scalar = interp(line, num=20)
        coll = LineCollection(segments)
        coll.set_array(color_scalar)
        ax.add_collection(coll)
    return fig

def interp(data, num=20):
    """Add "num" additional points to "data" at evenly spaced intervals and
    separate into individual segments."""
    x, y = data.T
    dist = np.hypot(np.diff(x - x.min()), np.diff(y - y.min())).cumsum()
    t = np.r_[0, dist] / dist.max()

    ti = np.linspace(0, 1, num, endpoint=True)
    xi = np.interp(ti, t, x)
    yi = np.interp(ti, t, y)

    # Insert the original vertices
    indices = np.searchsorted(ti, t)
    xi = np.insert(xi, indices, x)
    yi = np.insert(yi, indices, y)

    return reshuffle(xi, yi), ti

def reshuffle(x, y):
    """Reshape the line represented by "x" and "y" into an array of individual
    segments."""
    points = np.vstack([x, y]).T.reshape(-1,1,2)
    points = np.concatenate([points[:-1], points[1:]], axis=1)
    return points

if __name__ == '__main__':
    main() 
```

# android - AudioRecord - 空缓冲区

> ID：13622913
> 
> 赞同：1
> 
> 时间：2012-11-29T09:46:30.643
> 
> 标签：android, audiorecord

我正在尝试使用 AudioRecord 类录制一些音频。这是我的代码：

```
 int audioSource = AudioSource.MIC;
    int sampleRateInHz = 44100;
    int channelConfig = AudioFormat.CHANNEL_IN_MONO;
    int audioFormat = AudioFormat.ENCODING_PCM_16BIT;
    int bufferSizeInShorts = 44100;
    int bufferSizeInBytes = 2*bufferSizeInShorts;

    short Data[] = new short[bufferSizeInShorts];
    Thread recordingThread;

    AudioRecord audioRecorder = new AudioRecord(audioSource,
                                                sampleRateInHz,
                                                channelConfig,
                                                audioFormat,
                                                bufferSizeInBytes);

        @Override
        protected void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.activity_main);
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
                getMenuInflater().inflate(R.menu.activity_main, menu);
                return true;
        }

        public void startRecording(View arg0) {
                audioRecorder.startRecording();
                recordingThread = new Thread(new Runnable() {
                    public void run() {
                        while (Data[bufferSizeInShorts-1] == 0)
                                audioRecorder.read(Data, 0, bufferSizeInShorts);
                    }
                });
                audioRecorder.stop();
        } 
```

不幸的是，录制结束后我的短数组是空的。我可以请你帮我找出问题所在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T17:01:39.227

我想这段代码可以帮助您更好地使用所需的示例：-[与示例链接](http://capycoding.blogspot.in/2012/10/play-audio-file-mp3-from-asset-folder.html)。

# python - 安装 Python 程序

> ID：13622920
> 
> 赞同：1
> 
> 时间：2012-11-29T09:46:57.203
> 
> 标签：python

我正在尝试安装一个名为sonLib 的python 程序，但我无法通过单元测试。我想知道为什么，因为我认为我在 bashrc 中正确设置了 PYTHONPATH ...

我试过：

```
1\. PYTHONPATH=$PYTHONPATH:$HOME/programs/sonLib
   export PYTHONPATH

2\. export PYTHONPATH="home/user/programs/sonLib" 
```

你们有人可以告诉我如何让它工作吗？

[sonLib 的链接](https://github.com/benedictpaten/sonLib)

安装sonLib。

1.  将包含sonLib 的目录放在你的python 路径上。即 PYTHONPATH=${PYTHONPATH}:FOO 其中 FOO/sonLib 是指向sonLib 基目录的路径。
2.  编译C代码：在sonLib中输入'make all'然后'make test'来测试安装

链接 C 库：所有构建的库都放在“sonLib/lib”中

错误信息：

```
cd externalTools && make all
make[1]: Entering directory `/home/user/programs/sonLib/externalTools'
cd cutest && make all
make[2]: Entering directory `/home/user/programs/sonLib/externalTools/cutest'
make[2]: Nothing to be done for `all'.
make[2]: Leaving directory `/home/user/programs/sonLib/externalTools/cutest'
make[1]: Leaving directory `/home/user/programs/sonLib/externalTools'
cd C && make all
make[1]: Entering directory `/home/user/programs/sonLib/C'
make[1]: Nothing to be done for `all'.
make[1]: Leaving directory `/home/user/programs/sonLib/C'
PYTHONPATH=.. PATH=../../bin:$PATH python allTests.py --testLength=SHORT --logLevel=CRITICAL
ImportError: No module named site
make: *** [test] Error 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:51:51.793

它说`"Place the directory containing sonLib on your python path. i.e. PYTHONPATH=${PYTHONPATH}:FOO where FOO/sonLib is the path to the base directory of sonLib."`。

你声明`PYTHONPATH=$PYTHONPATH:$HOME/programs/sonLib.`它应该是这样的：`PYTHONPATH=$PYTHONPATH:$HOME/programs`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:52:49.260

也许您应该尝试将sonLib 基本目录直接放在您的python 路径文件夹中。如果您有easy_install，站点包应该是完美的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T10:20:10.210

好吧，伙计们不知道为什么，但如果我`unset PYTHONHOME`通过测试

# c++ - 将内存中的 sqlite 数据库转换为 blob/char 数组

> ID：13622923
> 
> 赞同：3
> 
> 时间：2012-11-29T09:47:04.193
> 
> 标签：c++, sqlite

我有一个内存中的 sqlite 数据库，我想将它转换为一个简单的 blob，并且我希望最好不使用任何序列化库来执行此操作。

我还使用 sqlite api 备份调用将其序列化到磁盘，这也可以用于我的目的吗？

或者，是否可以以任何其他方式简单地将数据库从内存复制到 char 数组？（开发使用 C++ 完成）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:15:27.887

SQLite 不允许您直接访问内存数据库的内部存储。

你可以[实现你自己的 VFS](http://www.sqlite.org/vfs.html)来为 blob 创建一个“文件”接口，但是仅仅通过一个（临时）磁盘文件听起来要容易得多。

# ruby - 读取文本文件的特定部分 Ruby

> ID：13622928
> 
> 赞同：0
> 
> 时间：2012-11-29T09:47:19.607
> 
> 标签：ruby, text

嗨，我在 Ruby 1.9.3 中将 PDF 转换为 txt 文件

这是txt文件的一部分：

```
 [["Rate", "Card", "February", "29,", "2012"]]
    [["Termination", "Color", "Test", "No", "Rate", "Currency", "Notes"]]
    [["x", "A", "CAMEL", "56731973573", "$", "0.1400", "USD", "30/45/100%"]]
    ["y", "A", "CARDINAL", "56731972501", "$", "0.1400", "USD", "30/45/100%"]]
    [["z", "A", "CARNELIAN", "56731971654", "$", "0.1400", "USD", "30/45/100%"]]
    .....
    ....
    [["Rate", "Card", "February", "29,", "2012"]]
    [["Termination", "Color", "Test", "No", "Rate", "Currency", "Notes"]] 
```

我将每一行存储在不同的数组中，但问题是我不想阅读在我的 txt 文件中多次出现的前两行，因为这些行是 pdf 每一页的标题。关于如何做到这一点的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:55:52.803

您可以将文件读入数组并拒绝不需要的行：

```
rejected = [
  '[["Rate", "Card", "February", "29,", "2012"]]',
  '[["Termination", "Color", "Test", "No", "Rate", "Currency", "Notes"]]',
]
lines = File.readlines('/path/to/file').reject { |line| rejected.include? line } 
```

# android - 当用户按下主页按钮时通知

> ID：13622930
> 
> 赞同：1
> 
> 时间：2012-11-29T09:47:28.050
> 
> 标签：android

我知道我不能像使用后退按钮那样覆盖主页按钮。但是如果按下主页按钮，android系统可以触发事件吗？我想捕捉这个动作，以便在用户按下主页按钮时显示警告消息。我研究了几个选项，最明显的一个，对于初学者来说是覆盖主页按钮

```
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_HOME) {
        // action goes here
    } else {
        return super.onKeyDown(keyCode, event);
    }
} 
```

但这不起作用，我完全意识到这一点。

`Activity`一旦当前完成，将调用 onPause 方法。`Activity`当用户在我的应用程序中更改时，也会调用此方法。那么当他按下主页按钮时，我是否可以向用户显示一个通知框？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:57:15.140

实际上，它不可能**像其他人一样捕获主页按钮按下事件**，这是保护用户的功能。

但是对于您的情况有一个**技巧**：

```
@Override
public void onAttachedToWindow()
{  
    this.getWindow().setType(WindowManager.LayoutParams.TYPE_KEYGUARD_DIALOG);     
    super.onAttachedToWindow();  
} 
```

[onAttachedToWindow](http://developer.android.com/reference/android/view/View.html#onAttachedToWindow%28%29)

> 当**视图附加**到窗口时调用

你可以阅读[Activity Lifecycle](https://stackoverflow.com/questions/8515936/android-activity-life-cycle-what-are-all-these-methods-for/8516056#8516056)这个 hack 是如何工作的。

此外，[这里有证据](https://stackoverflow.com/q/7583553/323659)表明这种方法有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T10:40:22.487

```
@Override
    protected void onUserLeaveHint() {
        // TODO Auto-generated method stub
        super.onUserLeaveHint();
    } 
```

这也可以帮助

# php - PHP : YYYY-MM-DD 与 strtotime

> ID：13622933
> 
> 赞同：0
> 
> 时间：2012-11-29T09:47:40.587
> 
> 标签：php, mysql, date, strtotime

我想要一些关于将数据插入 MySQL 以供以后比较的见解。我知道这些格式`date(Y-m-d)`并且`strtotime(date(Y-m-d))`有自己特定的用法。但我是 MySQL 和 PHP 领域的新手。所以我需要一份你们之间使用的利弊清单。您使用的是哪一个，请告诉我一些原因。

**哪个更有效，使用更正确`date(Y-m-d)`？`strtotime(date(Y-m-d))`**

我想知道在比较这些查询之间的时间方面是否有任何优势：

```
 1\. `select * from table where '2012-11-01' between date1 and date2`
 2\. `select * from table where '1351702800' between date1 and date2` 
```

您能否指出在处理大型 MySQL 数据集时哪个更快？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:42:13.550

在我看来，日期类型更好用。将时间戳转换回可读格式所需的 ms 将与 SQL 查询从数据库中读取整个日期所需的时间相比有所损失。

**Timestamp 更加优化**，但是您需要 PHP 来转换**速度较慢**。

**日期类型已经是可读格式**，无需转换——**更快**。

**编辑：** MySQL 具有处理日期类型的强大功能！

# windows-8 - 在 ARM 模拟器上检查 Windows 应用商店应用程序

> ID：13622935
> 
> 赞同：2
> 
> 时间：2012-11-29T09:47:40.953
> 
> 标签：windows-8, microsoft-metro, simulator

我的国家现在没有像 Surface RT 这样的 ARM 设备，有什么方法可以在 Visual Studio 的 ARM 模拟器上测试我的应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T17:17:40.567

正如上面评论中所说，没有可用的 ARM 模拟器。

也就是说，ARM 设备的功能与 x86 PC 非常相似。您只需测试模拟器中可用的所有分辨率和像素密度。

请注意，Surface RT 的速度可能比普通 PC 慢 10 倍以上。因此，如果您的 PC 上的计算需要半秒钟，那么在 Surface 上可能需要的时间太长了。

# javascript - 对话框内的对话框在自身上渲染 N 次

> ID：13622939
> 
> 赞同：2
> 
> 时间：2012-11-29T09:47:56.647
> 
> 标签：javascript, jquery, asp.net-mvc, jquery-ui, jquery-ui-dialog

使用 ASP.NET MVC 4、jQuery 1.6.2、jQuery UI 1.8.11。目前在 Firefox 16.0.2 中调试。

我试图让这个东西工作，所以我有一个可重用的 jQuery UI 模态对话框，`autoOpen: false`它可以从主页打开。到现在为止还挺好。该可重用的 jQuery UI 对话框将打开一个新的模态对话框，该对话框稍后会在需要时被销毁并再次创建（我试图使另一个也可重用但我失败了，它在第一个对话框中一直显示为 div，而不是作为新的单独对话应该如此，最终我决定每次需要时都创建它）。

当我第一次打开第一个对话框时，我可以毫无问题地打开和关闭第二个对话框。但是，当我关闭第一个对话框并再次打开它时，就会出现问题。它的行为就像我打开第一个对话框的次数一样多的对话框占位符 div。虽然我很确定我每次关闭它时都会销毁第二个对话框并删除占位符 div。

我已将对话框代码放入 /Views/Shared/_Layout.cshtml 文件中，并且该布局文件由主页引用。对于不熟悉 ASP.NET MVC 的人来说，布局文件是一个共享文件，其中包含定义网页布局的页眉、页脚和其他 html 元素，以便您可以从网站的任何视图中引用它. 因此，布局实际上与引用该布局的任何 View 一起呈现。

这是我的布局文件中的（伪）代码：

```
<html>
    <head>
        <script type="text/javascript">
            $.ajaxSetup({ cache: false });
            $(document).ready(function () {
                $("#veliki").dialog({
                    close: function () {
                        $("#veliki").html("");
                        $("#maleni").dialog("destroy");
                        $("body").find("#maleni").remove(); /* a desperate attempt to remove ALL divs which hold the 2nd dialog, was just: $("#maleni").remove(); */
                    },
                    modal: true,
                    height: 600,
                    width: 800,
                    left: 0,
                    autoOpen: false
                });

                $(".openDialog").live("click", function (e) {
                    e.preventDefault();
                    $("#veliki").load($(this).attr('data-url'));
                    $("#veliki").dialog("open");
                });
            });
        </script>
    </head>
    <body>
        <div id="veliki"></div>
        @RenderBody(); <!-- The ASP.NET MVC view gets rendered here -->
    </body>
</html> 
```

与第二个对话框相关的代码放置在引用另一个布局（不包含任何 jQuery 代码的布局）的视图之一中。该视图中的代码如下所示：

```
<script type="text/javascript">
    $(document).ready(function () {
        $(".openSubDialog").live("click", function (e) {
            e.preventDefault();
            $('<div id="maleni"></div>')
            .appendTo("body")
            .dialog({
                close: function () {
                    $("#maleni").dialog("destroy");
                    $("#maleni").remove();
                    $("body").find("#maleni").remove(); /* delete them all. but where did "they" appear from?! */
                },
                modal: true,
                height: 450,
                width: 600,
                left: 0
            })
            .load($(this).attr('data-url'));
        });
    });
</script> 
```

把它们加起来：

1.  `#veliki`我通过单击主页中的链接打开对话框。
2.  我通过单击第一个对话框中的链接来创建并打开`#maleni`对话框。
3.  我关闭`#maleni`对话框，销毁它并删除`#maleni`div。
4.  我关闭`#veliki`对话框。
5.  `#veliki`我通过单击主页中的另一个链接打开对话框。
6.  我创建并打开`#maleni`现在神奇地出现两次的对话框（如在 FireBug 中看到的）。
7.  我用头撞墙，这并没有解决任何问题。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:15:53.193

为什么不使用已经存在但内容不同的窗口？我用这个功能创建了一个小提琴：http: [//jsfiddle.net/scaillerie/wEX42/](http://jsfiddle.net/scaillerie/wEX42/)。

要点是您不必处理窗口的`close`事件`#maleni`：您只需关闭它，`$("#maleni").dialog("close");`当您再次需要它时，您重新打开它：`$("#maleni").dialog("open");`。

在您的情况下，实施示例如下：

**布局页面：**

```
<html>
    <head>
        <script type="text/javascript">
            $.ajaxSetup({ cache: false });
            $(document).ready(function () {
                $("#veliki").dialog({
                    close: function () {
                        $("#maleni").dialog("close");
                    },
                    modal: true,
                    height: 600,
                    width: 800,
                    left: 0,
                    autoOpen: false
                });

                $("body").delegate(".openDialog", "click", function (e) {
                    $("#veliki").dialog("open").load($(this).attr('data-url'));
                });

                $("#veliki").delegate(".openSubDialog", "click", function (e) {
                    $("#maleni").dialog("open").load($(this).attr('data-url'));
                });
            });
        </script>
    </head>
    <body>
        <div id="veliki"></div>
        @RenderBody(); <!-- The ASP.NET MVC view gets rendered here -->
    </body>
</html> 
```

**子页面：**

```
<div id="maleni"></div>
<script type="text/javascript">
    $(document).ready(function () {
        $("#maleni").dialog({
                modal: true,
                height: 450,
                width: 600,
                left: 0,
                autoOpen: false
         })
         .load($(this).attr('data-url'));
        });
    });
</script> 
```

# objective-c - 如何以编程方式删除 UIBarButtonItem 发光？

> ID：13622941
> 
> 赞同：1
> 
> 时间：2012-11-29T09:48:02.407
> 
> 标签：objective-c, ios, uibarbuttonitem

不幸的是，UIBarButtonItem 没有 showTouchWhenHighlighted，我无法从工具栏中编辑我的按钮......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:59:55.273

负责此操作的属性可在 UIButton 类中访问：

```
myButton.showsTouchWhenHighlighted = NO; 
```

您可以通过将 UIButton 分配给条形按钮项的 customView 属性并配置按钮，在 UIBarButtonItem 中访问它（以编程方式）。您也可以在 Interface Builder 中执行此操作：将 UIButton 拖到 UIToolbar 上，它会自动为您将其嵌入 UIBarButtonItem 中 - 然后在按钮设置下查找“Shows Touch On Highlight”复选框。

顺便说一句，我不知道您是如何自定义按钮的，因此请随意忽略这一点，但如果您的按钮看起来和行为类似于标准工具栏项，那么用户会期待发光效果。

[从这里](https://stackoverflow.com/questions/5916342/turn-off-highlighting-on-uibarbuttonitem)回答

**编辑**：

那么试试这个：

```
UIImage* buttonImage = [UIImage imageNamed: @"header.navigation.back.png"];     
UIButton *aButton = [UIButton buttonWithType:UIButtonTypeCustom];
[aButton setImage:buttonImage forState:UIControlStateNormal];
aButton.frame =  CGRectMake(0.0, 0.0, buttonImage.size.width/2, 32);
UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithCustomView:aButton];
[aButton addTarget:self action:@selector(backToPriorView) forControlEvents:UIControlEventTouchUpInside];
self.navigationItem.leftBarButtonItem = backButton;
[backButton release]; 
```

# php - 我的ajax响应很慢

> ID：13622943
> 
> 赞同：1
> 
> 时间：2012-11-29T09:48:04.123
> 
> 标签：php, html, ajax

我正在使用以下代码通过 ajax 传递和获取数据。

```
function passdata(id) 
{

    var top = document.getElementById("tname").value;
    var first = document.getElementById("fname").value;

    var font_top = document.getElementById("font_top").value;
    var font_first = document.getElementById("font_first").value;

    var image_top = document.getElementById("image_top").value;
    var image_first = document.getElementById("image_first").value;

var poststr = "id=" + id +
"&top=" + top +
"&first=" + first +
"&font_top=" + font_top +
"&font_first=" + font_first +
"&image_top=" + image_top +
"&image_first=" + image_first +
"&actype=getevent"; 

var reqAddCart = new Subsys_JsHttpRequest_Js();

reqAddCart.onreadystatechange = function() {
if (reqAddCart.readyState == 4) {
if (reqAddCart.responseJS) {
document.location.href = reqAddCart.responseJS.ajax_redirect;
return;
}
else {
 //alert(reqAddCart.responseText); 
//showModal('abc');

document.getElementById('data_content').innerHTML = reqAddCart.responseText; 

result = (reqAddCart.responseText||'');

var brokenresult=result.split("@");

}
}
}
var senddata = new Object();

var url = 'product.php?'+poststr; 
//alert(url);

reqAddCart.caching = false;
reqAddCart.open( 'GET', url, true);
reqAddCart.send( senddata );

return false;
} 
```

我正在使用 passdata 函数在产品页面中传递数据。此函数有效，但我的响应速度非常慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:56:31.800

AJAX 请求完成所需的时间受服务器和客户端上的网络延迟和连接速度以及服务器上脚本的执行时间的影响。

我希望在测试时本地发出的 AJAX 请求能够更快地返回，因为它消除了通过 Internet 传输数据的需要。

# android - 在android中打开一个obj文件

> ID：13622944
> 
> 赞同：1
> 
> 时间：2012-11-29T09:48:08.827
> 
> 标签：android, cordova, 3d, rotation

我是一名 PHP 程序员，正在尝试 phonegap + HTML 和 android

我有一个来自客户的要求是一个 android 应用程序。他们需要像在 Maya 等 3D 应用程序中一样旋转 obj 文件（静态），然后捕获其屏幕截图并将其保存为该应用程序中的文件。

我想亲自尝试这个应用程序。我听说过 min3d 。

我可以用 min3d 满足我的要求吗？或者是否有任何其他应用程序（简单）满足此要求？

请帮忙

# android - 在操作栏主页图标上设置 OnClickListener 会使图标松动按下状态

> ID：13622951
> 
> 赞同：4
> 
> 时间：2012-11-29T09:48:32.000
> 
> 标签：android, android-actionbar

设置以下使主页图标显示为按下状态：

```
actionBar.setHomeButtonEnabled(true); 
```

但是，设置 OnClickListener 后，主页图标停止显示按下状态：

```
ImageView iconImage = (ImageView) activity.findViewById(android.R.id.home);
iconImage.setOnClickListener(new android.view.View.OnClickListener() {
    @Override
    public void onClick(View v) {
    }
}); 
```

关于如何防止禁用新闻状态的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T09:50:47.690

处理`home`图标的点击，不需要设置`onClickListener`，需要做以下..

```
public boolean onOptionsItemSelected(MenuItem item) {
    if(item.getItemId() == android.R.id.home) { //app icon in action bar clicked; go back
        //do something
        return true;
    }

    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-29T06:24:48.260

```
public class MainActivity extends Activity {

     Fragment fr;
      FragmentManager fm;
      Button btn1,btn2;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

          ActionBar actionBar = getActionBar();
         actionBar.setHomeButtonEnabled(true);

        btn1=(Button)findViewById(R.id.button1);
        btn2=(Button)findViewById(R.id.button2);
        fm = getFragmentManager();

        btn1.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                     fr = new frag22();
                     FragmentTransaction ft = fm.beginTransaction();
                     ft.replace(R.id.fragment, fr);
                     ft.commit();

            }
        });
    }

@Override
public boolean onCreateOptionsMenu(Menu menu) {

    getMenuInflater().inflate(R.menu.main, menu);
    // TODO Auto-generated method stub
    return super.onCreateOptionsMenu(menu);
}

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        // TODO Auto-generated method stub

          if(item.getItemId() == android.R.id.home) { //app icon in action bar clicked; go back
                //do something

              Toast.makeText(getApplicationContext(), "set click", Toast.LENGTH_LONG).show();
                return true;
            }

        return super.onOptionsItemSelected(item);
    }
} 
```

# c# - 基于 MongoDB 的系统的最佳服务器设计（需要低响应时间）

> ID：13622955
> 
> 赞同：1
> 
> 时间：2012-11-29T09:48:36.743
> 
> 标签：c#, mongodb, database-design, architecture

我正在开发一个网络服务，它将为世界各地的用户提供服务。

该服务器基于托管在 IIS 上的 C# WCF 应用程序。它使用一个 MsSQL 配置数据库（访问时间在这里并不重要）和一个包含所有重要数据的 MongoDB 数据库（访问时间在这里非常重要）。它还提供小图像（48px * 48px JPEG）。

现在，对于图像托管，我可能会使用亚马逊的 CloudFront CDN 托管（除非你们有更好的建议）。

我的问题是保持对 Web 应用程序和 MongoDB 的低访问时间 (ping)。

我想在新加坡 + 美国 + 欧洲 + 中东租用 4 台服务器，以缩短响应时间。

每台服务器都将保存 Web 应用程序和一个 MongoDB 实例。一台服务器将保存 MsSQL 实例。

我需要同步所有 MongoDB（如果有问题，则不是立即同步）。

你会用什么设计？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T11:46:48.407

访问时间短是成本与收益的函数。首先你需要识别，多低是低。您是否需要应用程序的整体响应时间为 100 毫秒？还是1s？

一旦你这样做了，你就可以绘制出不同的成本。

```
 Total time taken = time for request + //across internet 
processing by web app + request for data + 
preparing the response + response back to client. 
```

如果您想要的延迟是 100 毫秒，那么无论您的服务器有多快，它都很有可能无法完成，这很简单，因为网络流量可能需要太长时间。

您需要分析数据集。查询 1000 个文档不同于查询 10 亿个文档。您需要计算索引占用的大小，以及它是否在 RAM 中。如果索引不在 RAM 中，您的访问速度会很慢。

**MongoDB配置**

Mongodb 可以在集群中工作，具有自动同步（立即或延迟，这是可配置的）和自动故障转移（或手动，这也是可配置的）。如果您的数据集很大，它还支持分片，因此请求被发送到实际包含数据的服务器。

同样，您需要查看您的应用服务器并弄清楚组件的慢/快程度才能获得保证的响应时间。

根据您提供的信息，这是我可以给出的详细回复。

**分析然后优化**

如果您的请求中有 80% 来自中东，那么您应该首先为他们快速处理。使用相同的原理，您需要找出响应时间最慢的组件，并改进它们。为此，您需要收集数据。

**聚类**

在一个大陆或跨大陆设置集群，将帮助您提供冗余、自动故障转移（如果已配置）和负载平衡（取决于您的配置方式）。如果您有大量数据，请考虑分片。

考虑通过文档进行[复制](http://docs.mongodb.org/manual/replication/)和[分片](http://docs.mongodb.org/manual/sharding/)。

**示例服务器设置**

假设您想要有 10 个复制因子为 3 的分片，即您的数据被分成 10 台服务器，并且每台服务器实际上是 3 台服务器的副本集（用于可用性和故障转移），即副本集中的每台服务器都包含重复数据。

这里符号 s1p1 表示，shard1 - 主 1 和 s1s1 是 shard 1 辅助 1 等等

```
s1p1 s2p1 ...  s10p1
s1s1 s2s1  ... s10s1
s1s2 s2s2  ... s10s2 
```

分片 1-10 划分数据，其中每个分片大约保留总数的 1/10。每个分片由一个副本集组成，该副本集具有一个主副本和 2 个辅助副本。如果需要更多冗余，可以增加此值。尽量保持奇数，因此在选举期间会有决胜局。如果您只想拥有 2 个数据副本，那么您还可以引入一个“Arbiter”来打破平局。

您可以分析您的查询，并选择一个分片键，以便它们转到最近的服务器或为该区域提供服务的服务器。您很可能需要进行某种分析来优化这一点。

希望能帮助到你。

# java - 将 xls 转换为图像

> ID：13622956
> 
> 赞同：1
> 
> 时间：2012-11-29T09:48:38.667
> 
> 标签：java, image, apache-poi, xls

我正在尝试在 PPT（不是 PPTX）中创建多个复杂的表，我使用 POI Apache HSLF，问题是我有时有多种带有多个标题的表，我想然后在 xls 文件上创建我的表而不是转换它们进行图像处理，最后将它们嵌入到我生成的 PPT 中

我知道这是一个复杂的理论，但我现在需要将我的 XLS 转换为图像

请有任何帮助

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-20T14:02:22.797

你不能用 POI 来做，但你可以使用 J XL 或 Aspose Cells 转换或复制图表（图形）（Aspose 不是免费的）。

这是将excel图表提取到图像的代码片段

```
public class ExportChartToImage
{
    public static void main(String[] args) throws Exception
    {
        //Start Excel
        Application excelApp = new Application();
        excelApp.setVisible(true);

        //Create test workbook
        Workbook workbook = excelApp.createWorkbook("/home/tejus/Desktop/Chart Test");

        //Get the first (and the only) worksheet
        final Worksheet worksheet1 = workbook.getWorksheet(1);

        //Fill-in the first worksheet with sample data
        worksheet1.getCell("A1").setValue("Date");
        worksheet1.getCell("A2").setValue("March 1");
        worksheet1.getCell("A3").setValue("March 8");
        worksheet1.getCell("A4").setValue("March 15");

        worksheet1.getCell("B1").setValue("Customer");
        worksheet1.getCell("B2").setValue("Smith");
        worksheet1.getCell("B3").setValue("Jones");
        worksheet1.getCell("B4").setValue("James");

        worksheet1.getCell("C1").setValue("Sales");
        worksheet1.getCell("C2").setValue("23");
        worksheet1.getCell("C3").setValue("17");
        worksheet1.getCell("C4").setValue("39");

        excelApp.getOleMessageLoop().doInvokeAndWait(new Runnable()
        {
            public void run()
            {
                final Variant unspecified = Variant.createUnspecifiedParameter();
                final Int32 localeID = new Int32(LocaleID.LOCALE_SYSTEM_DEFAULT);

                Range sourceDataNativePeer = worksheet1.getRange("A1:C4").getPeer();
                _Worksheet worksheetNativePeer = worksheet1.getPeer();

                IDispatch chartObjectDispatch = worksheetNativePeer.chartObjects(unspecified, localeID);

                ChartObjectsImpl chartObjects = new ChartObjectsImpl(chartObjectDispatch);
                ChartObject chartObject = chartObjects.add(new DoubleFloat(100), new DoubleFloat(150), new DoubleFloat(300), new DoubleFloat(225));

                _Chart chart = chartObject.getChart();
                chart.setSourceData(sourceDataNativePeer, new Variant(XlRowCol.xlRows));

                BStr fileName = new BStr("/home/tejus/Desktop/chart.gif");
                Variant filterName = new Variant("gif");
                Variant interactive = new Variant(false);

                chart.export(fileName, filterName, interactive);

                chart.setAutoDelete(false);
                chart.release();

                chartObject.setAutoDelete(false);
                chartObject.release();

                chartObjects.setAutoDelete(false);
                chartObjects.release();

                chartObjectDispatch.setAutoDelete(false);
                chartObjectDispatch.release();
            }
        });

        System.out.println("Press 'Enter' to terminate the application");
        System.in.read();

        //Close the MS Excel application.
        boolean saveChanges = false;
        workbook.close(saveChanges);
        boolean forceQuit = true;
        excelApp.close(forceQuit);
    }

} 
```

我用了 J excel

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T10:21:37.657

有 3rd 方产品，如`aspose`提供用于将工作表转换为图像文件的 API。但是，您可以首先创建一个渲染引擎，该引擎执行几何布局并将工作表上可用的所有数据写入画布，然后创建一个转换器，该转换器从画布获取像素数据并渲染到文件。

# paypal - 使用参考交易检测 Paypal 计费协议设置的取消

> ID：13622957
> 
> 赞同：1
> 
> 时间：2012-11-29T09:48:40.393
> 
> 标签：paypal, paypal-ipn

我正在使用 Paypal express checkout api 的“参考交易”为我们的客户设置定期计费方案。我选择了这种方法，因为每月的账单金额会有所不同，并且在签订账单协议时没有首期付款。

**我的问题是，我可以使用 paypal IPN 来检测用户何时取消此操作吗？**我知道，如果客户签订本协议，他们有权登录自己的 Paypal 帐户并取消协议。我应该通过 IPN 监听哪些变量？

虽然我在 IPN 文档中看到了定期付款和定期付款配置文件的提及，但它们实际上与通过参考交易设置定期计费方案不同（定期付款和参考交易位于通用 paypal api 文档的两个不同部分）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-16T02:36:01.047

在您的 PayPal 帐户中启用 IPN，然后 PayPal 将通过 IPN 通知您有关客户取消计费协议的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-14T10:55:28.930

如果您在 SetExpressCheckout 中包含 IPN，它将无法与参考事务一起使用。您需要在 PayPal 网站上启用 IPN。

# c# - PageRequestManagerServerErrorException 由于文本框内容

> ID：13622960
> 
> 赞同：2
> 
> 时间：2012-11-29T09:48:51.703
> 
> 标签：c#, asp.net, .net

我有一个非常奇怪的问题。我花了一段时间才找到。基本上，当我将数据库中的数据加载到一堆 TextBox 中时，我会弹出 Microsoft JScript 运行时错误。

它在 Sys.Observer.RaiseEvent(this, "endRequest", eventArgs) 之后被抛出我已经看到这个错误可以被忽略，但是在我的更新面板触发后它没有回发。按钮不起作用，带有 AutoPostbacks 的列表框不会触发。

所以最终我将它追踪到一个文本框。如果我不填充它一切正常。

文本框越来越多：

```
 MO-SU 0700-0230        <<SEE GEN INFO>>        <<HRS T-1 ONLY>> 
```

我的第一个想法是那里一定有一个转义字符，或者有什么东西弄乱了更新面板。我将删除“<<”和“>>”，但我只是想知道是否有人可以解释为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:56:40.427

因此，`<<`您`>>`的部分帖子被服务器视为 XSS 攻击。由于您使用包含字符串的文本框加载文本框，`<`并且`>`它将在下次发布到服务器并且由于`<script>`标签也以 < > 字符开始/结束服务器检查 XSS 敏感字符并拒绝请求。在服务器控件中发布数据和加载数据时，最好使用asp.net 提供的`HTTPUtility.HtmlEncode`And方法发布这样的数据。`HTTPUtility.HtmlDecode`请参阅以下示例：-

```
string DecHtml = HttpUtility.HtmlDecode(value1);
string EncHtml = HttpUtility.HtmlEncode(value2); 
```

查找有关 HTMLEncode 输入的[更多信息](http://msdn.microsoft.com/en-us/library/system.web.httputility.htmlencode.aspx)如果你想了解 XSS，你应该遵循[这个](http://en.wikipedia.org/wiki/Cross-site_scripting)

不过幸运的是，我们可以在 ASPX 的 page 指令中关闭验证：

```
<%@ Page Language="C#" MasterPageFile="~/Site.Master"
AutoEventWireup="true" CodeBehind="webpage.aspx.cs"
Inherits="Web.webpage" Title="webpageSite" ValidateRequest="false" %> 
```

或者，可以在 web.config 中关闭整个站点的请求验证：

```
<pages validateRequest="false" /> 
```

**对于 .NET 4.0** ，在 .NET 4 请求验证模式下运行时，您不能再在页面级别将其关闭，为了能够禁用验证，我们需要让 web.config 退回到 2.0 验证模式：

```
<httpRuntime requestValidationMode="2.0" /> 
```

坦率地说，这根本不是一个聪明的主意，除非您有充分的理由要从站点的每个页面中删除此安全网。因此，恕我直言，最好的方法是尽可能使用编码和解码。[在这里](http://www.troyhunt.com/2010/05/owasp-top-10-for-net-developers-part-2.html)找到更多

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:54:23.927

更改页面设置[ValidateRequestMode](http://msdn.microsoft.com/ru-ru/library/system.web.ui.page.validaterequestmode.aspx)但您应该手动检查所有用户输入以防止攻击。

# silverlight - 如何为 Stackpanel 的孩子设置样式？

> ID：13622965
> 
> 赞同：1
> 
> 时间：2012-11-29T09:49:12.983
> 
> 标签：silverlight, styles, stackpanel

这是我的场景。我有一个堆栈面板，我想为里面的孩子设置样式。所以我想为我的堆栈面板编写一个样式，其中我提到了它所有孩子的默认样式。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-07T07:00:51.150

[在此链接](http://www.silverlightshow.net/items/Implicit-Styles-in-Silverlight-4.aspx)中找到了我所需要 的概念称为隐式样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:24:34.263

我建议您使用[ItemsControl](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol%28v=vs.95%29.aspx)（它内部使用`StackPanel`）类并定义您的[ItemTemplate](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplate%28v=vs.95%29.aspx)。

# asp.net-mvc - 如何更改视图模型中隐式必需属性的错误消息？

> ID：13622969
> 
> 赞同：4
> 
> 时间：2012-11-29T09:49:20.530
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我在我的视图模型中声明了属性，例如：

```
 [Required(ErrorMessage = "The Date field is required for Start.")]
    [Display(Name = "Start")]
    public DateTime DateStart { get; set; } 
```

但是，我仍然收到默认*的“开始”字段是必需的*错误消息。`DateTime`我认为这是因为隐式需要不可为空的，并且该`Required`属性被忽略。除了使它们可以为空之外，有没有办法为这些特定属性自定义我的错误消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T06:32:09.673

没错，您的问题是您的财产不可为空。对于不可为空的属性，属性`Required`是没有意义的。当没有 StartDate 值时，验证不会转到您的`Required`属性并在上一步失败。如果你想得到你的`ErrorMessage`，你应该使用：

```
[Required(ErrorMessage = "The Date field is required for Start.")]
[Display(Name = "Start")]
public DateTime? DateStart { get; set; } 
```

**您不能为在模型绑定时为空的不可空类型自定义 ErrorMessage，因为它在 MVC 框架中被硬编码。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T11:06:20.107

我已经开始在 MVC 4 中刷新新的测试项目并创建一个测试模型

```
 public class TestModel {
        [Required(ErrorMessage = "The Date field is required for Start.")]
        [Display(Name = "Start")]
        public DateTime DateStart { get; set; }

    } 
```

然后在我的模型中，我只有这个：

```
@using(Html.BeginForm()){
    @Html.ValidationMessageFor(a => a.DateStart);
    @Html.TextBoxFor(a => a.DateStart)
    <input type="submit" value="add"/>
} 
```

当我删除清除文本框并点击提交时，我收到的是自定义错误消息而不是默认错误消息。

```
The Date field is required for Start. 
```

这对我来说很有意义，想象一下如果这是一个多语言应用程序，您肯定需要为该国家/地区自定义错误消息。不需要火箭科学家就能意识到定制信息的必要性。我希望 MVC 团队已经涵盖了这一点。

# iphone - 出现压缩视频画面时处理 UIIMagePickerController

> ID：13622972
> 
> 赞同：2
> 
> 时间：2012-11-29T09:49:33.633
> 
> 标签：iphone, objective-c, background, uiimagepickercontroller, photo-gallery

我正在使用 UIImagePicker 从库中选择视频并尝试在我的应用程序中使用视频。为此，我正在使用这样的代码

```
picker = [[UIImagePickerController alloc] init];
picker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;

picker.delegate = self;
picker.mediaTypes=[NSArray arrayWithObject:(NSString*)kUTTypeMovie];
[self presentModalViewController:picker animated:YES]; 
```

Now the problem is that when any video is selected it shows compressing video message alongwith a progress bar.Meanwhile If I send my app in background I want to cancel this compression and dismismodalviewController so that corrupted compression does not occur.Is there any way to avoid此压缩或处理此压缩以使结果成功或失败。设置 videoQuality 并不能解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-27T10:28:37.897

就我而言，来自的 URL`UIImagePickerControllerMediaType`是`nil`. 解决方案是从以下位置获取视频 URL `UIImagePickerControllerReferenceURL`：

```
-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info{
            NSURL* url = [info objectForKey:UIImagePickerControllerReferenceURL];
            //... read video with ALAssetsLibrary
} 
```

可以在此处找到有关如何阅读视频的更多信息：[如何从资产 url 保存视频](https://stackoverflow.com/questions/6568210/how-to-save-video-from-assets-url)

# python - 从文件号获取文件对象

> ID：13622973
> 
> 赞同：7
> 
> 时间：2012-11-29T09:49:32.837
> 
> 标签：python, file

假设我有一个打开文件的列表（实际上是文件编号）：

```
import resource
import fcntl

def get_open_fds():
    fds = []
    soft, hard = resource.getrlimit(resource.RLIMIT_NOFILE)
    for fd in range(3, soft):
        try:
            flags = fcntl.fcntl(fd, fcntl.F_GETFD)
        except IOError:
            continue
        fds.append(fd)
    return fds 
```

现在我想获取这些文件的名称。我怎样才能做到这一点？

## 编辑

只是为了澄清，对于那些反对这一点的人：fd 是一个整数。它**不是**文件描述符。很抱歉让您与名称混淆，但代码是不言自明的。

## 编辑2

我对此感到愤怒，我认为是因为我选择了`fd`表示文件号。我刚刚检查了[文档](http://docs.python.org/2/library/fcntl.html)：

> 该模块中的所有函数都将文件描述符 fd 作为其第一个参数。这可以是一个整数文件描述符，例如由 sys.stdin.fileno() 返回，也可以是一个文件对象，例如 sys.stdin 本身，它提供了一个返回真正文件描述符的 fileno()。

所以`fd`确实是一个整数。它也可以是一个文件对象，但在一般情况下，`fd`它不是`.name`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T10:39:40.343

根据[这个答案](https://stackoverflow.com/a/1189582/989121)：

```
for fd in get_open_fds():
    print fd, os.readlink('/proc/self/fd/%d' % fd) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-16T22:30:57.657

我在同一条船上。我最终做的是编写我自己的`open`来跟踪所有打开的文件。然后在最初的 Python 文件中，首先发生的事情是内置的`open`被我的替换，然后我可以查询它以获取当前打开的文件。这是它的样子：

```
class Open(object):
    builtin_open = open
    _cache = {}
    @classmethod
    def __call__(cls, name, *args):
        file = cls.builtin_open(name, *args)
        cls._cache[name] = file
        return file
    @classmethod
    def active(cls, name):
        cls.open_files()
        try:
            return cls._cache[name]
        except KeyError:
            raise ValueError('%s has been closed' % name)
    @classmethod
    def open_files(cls):
        closed = []
        for name, file in cls._cache.items():
            if file.closed:
                closed.append(name)
        for name in closed:
            cls._cache.pop(name)
        return cls._cache.items()

import __builtin__
__builtin__.open = Open() 
```

然后后来...

```
daemon.files_preserve = [open.active('/dev/urandom')] 
```

# bash - 奇怪的 hg 日志输出

> ID：13622975
> 
> 赞同：0
> 
> 时间：2012-11-29T09:49:44.107
> 
> 标签：bash, mercurial

每天早上 10:00 crontab 设置为在 bash 脚本中运行此命令（以下日期是示例，它们是使用脚本中的 linux date 命令计算的）：

```
hg log -R some-repo -b some-branch --date "2012-11-28 10:00 to 2012-11-29 10:00" 
```

上面的命令在所有开发人员推送他们的代码的远程仓库的服务器上运行。输出存储在一个字符串中并通过电子邮件发送给我。但它总是空的！如果我在几分钟后手动运行脚本，我会得到预期的输出。

我已经比较了脚本由 crontab 运行之前的历史记录，并验证了某些内容确实已提交/推送到远程仓库。

任何想法为什么在 10:00 之后运行上述脚本会给出正确的输出，而不是在 10:00 运行时？

在脚本中我这样做：

```
logString=$(hg log -R "$path-to-repo" -b $branch --date "$YESTERDAY to $TODAY")
if [ -z "$logString" ]; then
   logString="Nothing"
fi 
```

编辑：只有当脚本由 crontab 运行时，hg 日志才为空。

已解决：我需要为 cron 指定 hg (/usr/local/bin/hg) 的完整路径才能看到它。有点奇怪，因为它不需要 svn 的完整路径，而且之前它在没有 hg 的完整路径的情况下运行良好。

如何查看 cron 在其 PATH 中的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:05:16.093

`crontab`环境非常有限。如果您假设某些变量将从您的 .profile （或等效项）中可用，则很可能不会存在。如果您需要它，则必须将其来源到您的脚本中。

看起来您还包含了较长脚本的片段。制作应该工作的最简单的脚本并将其添加到 cron 中。这将使调试更容易。例如，如果您对脚本中的日期进行硬编码，您应该能够使其工作。一旦你有了这个工作，你可以逐渐增加复杂性，直到你弄清楚什么不工作。

# c# - 获取本地 Dropbox 帐户信息 c#

> ID：13622979
> 
> 赞同：2
> 
> 时间：2012-11-29T09:49:49.577
> 
> 标签：c#, dropbox

我的 Windows 7 系统中安装了 Dropbox。有没有办法以编程方式检索与本地保管箱帐户链接的用户电子邮件？我可以通过扫描本地应用程序目录中的 host.db 文件来检索文件夹位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-10T10:43:36.473

是的 ！您可以在“/account/info”的帮助下以编程方式检索与本地保管箱帐户链接的用户电子邮件。

/帐户信息

*   描述：检索有关用户帐户的信息。
*   网址结构：[https ://api.dropboxapi.com/1/account/info](https://api.dropboxapi.com/1/account/info)
*   方法：获取
*   参数：区域设置 - 用于指定用户错误消息和其他语言特定文本的语言设置。有关支持的语言环境的更多信息，请参阅上面的注释。
*   返回：用户帐户信息。

    示例 JSON 响应 { "uid": 12345678, "display_name": "John User", "name_details": { "familiar_name": "John", "given_name": "John", "surname": "User" }, " “referral_link”：“ [https://www.dropbox.com/referrals/r1a2n3d4m5s6t7](https://www.dropbox.com/referrals/r1a2n3d4m5s6t7) ”，“国家”：“美国”，“语言环境”：“en”，“电子邮件”：“john@example.com”，“email_verified” ：假，“is_paired”：假，“团队”：{“名称”：“Acme Inc.”，“团队ID”：“dbtid：1234abcd”}，“配额信息”：{“共享”：253738410565，“配额”：107374182400000，“正常”：680031877871 } }

返回值定义

字段说明

*   uid ：用户的唯一 Dropbox ID。
*   display_name ：用户的显示名称。
*   name_details/given_name ：用户的名字。
*   name_details/surname ：用户的姓氏。
*   name_details/familiar_name ：用户的区域设置相关的熟悉名称。
*   refer_link ：用户的推荐链接。
*   country ：用户的两个字母的国家/地区代码（如果有）。
*   locale ：用户设置的区域设置首选项（例如 en-us）。
*   email ：用户的电子邮件地址。
*   email_verified ：如果为 true，则用户的电子邮件地址已被验证属于该用户。
*   is_paired ：如果为 true，则有一个与此用户关联的配对帐户。
*   team ：如果用户属于某个团队，则包含团队信息。否则为空。
*   team/name ：用户所属团队的名称。
*   eam/team_id ：用户所属团队的 ID。quota_info/normal 用户在共享文件夹之外使用的配额（字节）。
*   quota_info/shared ：用户在共享文件夹中使用的配额（字节）。如果用户属于一个团队，这包括在用户自己使用的配额（字节）之外贡献给团队配额的所有使用量。
*   quota_info/quota ：用户的总配额分配（字节）。如果用户属于一个团队，则该团队的总配额分配（字节）。

# objective-c - 为什么在 Objective-C 中允许 [object.delegate self]？

> ID：13622983
> 
> 赞同：3
> 
> 时间：2012-11-29T09:50:07.783
> 
> 标签：objective-c, cocoa-touch, cocoa, selector, self

我见过几个需要定义委托的 Objective-C 代码示例。例如，在使用 MapKit 时，我看到如下语句：

```
[self.mapView.delegate self]; 
```

我有时也会看到以下内容：

```
[self.mapView setDelegate:self]; 
```

我仍然找到一些执行以下操作的示例：

```
self.mapView.delegate = self; 
```

我知道第二个和第三个是如何等效的，但是我不明白第一个是如何运行的，更不用说编译了。我的意思是：`self`在这种情况下，一个有效的选择器如何？此代码如何转换为委托属性的赋值语句？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-05-18T18:27:32.263

`self` in `[self.mapView.delegate self];` and `[self.mapView setDelegate:self];` are different — yet related things. while the latter self represents the object in its scope it is used, `[object self]` is a method `-(id)self` defined in the NSObject protocol.

[from the doc](https://developer.apple.com/library/mac/documentation/cocoa/reference/foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/doc/uid/20000052-BBCGEBBJ):

> **self**
> Returns the receiver. (required)
> 
> ```
> - (id)self 
> ```
> 
> Return Value The receiver.
> 
> Availability Available in OS X v10.0 and later.

As the NSObject class implements the NSObject protocol, nearly any object we use in our codes will understand this method.

A clue, what it useful for, gives us the [GNUStep documentation](http://www.gnustep.org/resources/documentation/Developer/Base/Reference/NSObject.html#method%24%28NSObject%29-self):

> self
> 
> ```
> - (id) self; 
> ```
> 
> Availability: OpenStep
> 
> Returns the receiver. In a proxy, this may (but is not required to) return the proxied object.

We can use it for proxies.
Also in KVC it can be useful that there is a method called `self`, as the operator needs a right key path, but actually the object itself is what we need:

```
NSArray *numbers = @[@1, @1, @2 ,@3, @5]
NSNumber* sum = [numbers valueForKeyPath: @"@sum.self"]; 
```

`sum` will be `12`.

* * *

`[self.mapView setDelegate:self];` and `self.mapView.delegate = self;` are equivalent and `self` sends for the object it is used in. Basically each Objective-C message translates to a C function, that takes at least two parameters. `-setDelegate:` would be translation in runtime to

```
void setDelegate(id self, SEL _cmd, id delegate)
{
    // implementation ....
} 
```

As you can see here, `self` is just the default name of the object passed in as the first parameter by the runtime and refers to the object of the class the method is defined on.

Although it is often referred as a keyword, `self` isn't. it is just a convention. As it is possible to construct Objective-C methods by using C functions, the Implementation IMP type and selector SEL type, you could decide to call the first object differently, like `this` if you would like to have C++ naming.

# javascript - 更改全日历中一系列日期的背景颜色

> ID：13622985
> 
> 赞同：2
> 
> 时间：2012-11-29T09:50:16.710
> 
> 标签：javascript, jquery, css, fullcalendar

我需要更改某些日期的背景颜色。我从 rails controller 获取这些日期作为数组。可以说[“2012-12-14”，“2012-11-05”，“2012-11-16”]。我需要更改这 3 个日期的背景颜色。我如何实现它。请帮忙。我是JS的新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T10:38:25.197

这是rails方式（我猜是转发）：

[Jquery FullCalendar-根据 ruby​​ 应用程序中的 even_type 更改事件颜色](https://stackoverflow.com/questions/11790704/jquery-fullcalendar-change-event-color-according-to-even-type-in-ruby-app)

这里的JS方式：

[http://blog.shinetech.com/2011/08/05/building-a-shared-calendar-with-backbone-js-and-fullcalendar-a-step-by-step-tutorial/](http://blog.shinetech.com/2011/08/05/building-a-shared-calendar-with-backbone-js-and-fullcalendar-a-step-by-step-tutorial/)

一般来说，数组应该包含一个日期和一个分配的事件。根据该事件，您可以设置颜色。

数组应该看起来像

```
[["2012-12-14","work"],["2012-11-05","work"],["2012-11-16","freetime"]] 
```

# rotation - Kineticjs - 将图像顺时针旋转 90 度

> ID：13622987
> 
> 赞同：1
> 
> 时间：2012-11-29T09:50:21.817
> 
> 标签：rotation, kineticjs

我真的很喜欢 kineticjs lib，但我很难找到有关旋转动态图像对象的任何资源/示例。

我见过很多旋转形状，但从外观上看，它们似乎都在旋转整个画布而不是图像对象。

这是真的吗？如果不是，有人可以指出任何文件吗？

问候

ps

对于那些想要代码的人来说，这只是标准的图像删除：

```
mainImage = new Kinetic.Image({
    image: imageObj,
    x: 0,
    y: 0,
    draggable: true,
    startScale: 1
}); 
```

并尝试过：

```
function rotateLeft(){
    $('#rotate-left').bind( $bind, function(){
        mainImage.rotate(90);
        layer.draw();
    });
} 
```

这使图像消失...

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T11:15:50.253

Kinetic.Image 从 Kinetic.Node 类继承 rotateDeg 和 rotate 方法。rotateDeg 是您正在寻找的那个。旋转是相同的，但使用弧度而不是度数。这些将相对于当前旋转旋转。

还有 setRotate 和 setRotateDeg 方法，它们会将旋转设置为某个绝对值。

所以试试这个：

```
mainImage.rotateDeg(90); 
```

我希望这有帮助！

# javascript - 日期的 Javascript 日期格式

> ID：13622989
> 
> 赞同：0
> 
> 时间：2012-11-29T09:50:24.327
> 
> 标签：javascript, datetime

如何将 Javascript 中的日期格式化为“yyyy-MM-dd HH:mm:ss z”？

这`date.toString('yyyy-MM-dd HH:mm:ss z');`对我来说永远不会奏效：/

任何想法？

======

我解决了我自己的问题，我这样重写：

```
var parseDate = function(date) {
    var m = /^(\d{4})-(\d\d)-(\d\d) (\d\d):(\d\d):(\d\d) UTC$/.exec(date);
    var tzOffset = new Date(+m[1], +m[2] - 1, +m[3], +m[4], +m[5], +m[6]).getTimezoneOffset();

    return new Date(+m[1], +m[2] - 1, +m[3], +m[4], +m[5] - tzOffset, +m[6]);
}

var formatDateTime = function(data) {
    var utcDate = parseDate(data);

    var theMonth = utcDate.getMonth() + 1;
    var myMonth = ((theMonth < 10) ? "0" : "") + theMonth.toString();

    var theDate = utcDate.getDate();
    var myDate = ((theDate < 10) ? "0" : "") + theDate.toString();

    var theHour = utcDate.getHours();
    var myHour = ((theHour < 10) ? "0" : "") + theHour.toString();

    var theMinute = utcDate.getMinutes(); 
    var myMinute = ((theMinute < 10) ? "0" : "") + theMinute.toString();

    var theSecond = utcDate.getSeconds(); 
    mySecond = ((theSecond < 10) ? "0" : "") + theSecond.toString();

    var theTimezone = new Date().toString();
    var myTimezone = theTimezone.indexOf('(') > -1 ? 
            theTimezone.match(/\([^\)]+\)/)[0].match(/[A-Z]/g).join('') : 
            theTimezone.match(/[A-Z]{3,4}/)[0];

    if (myTimezone == "GMT" && /(GMT\W*\d{4})/.test(theTimezone)) {
        myTimezone = RegExp.$1;
    }

    if (myTimezone == "UTC" && /(UTC\W*\d{4})/.test(theTimezone)) {
        myTimezone = RegExp.$1;
    }

    var dateString = utcDate.getFullYear() + "-" + 
                     myMonth + "-" +
                     myDate + " " +
                     myHour + ":" +
                     myMinute + ":" +
                     mySecond + " " +
                     myTimezone;

    return dateString;
} 
```

我得到：2012-11-15 22:08:08 MPST :) 完美！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:00:28.460

```
function formatDate(dateObject) //pass date object
{
  return (dateObject.getFullYear() + "-" + (dateObject.getMonth() + 1)) + "-" + dateObject.getDate()   ;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T09:59:54.610

[使用这个库让你的生活更轻松：](http://blog.stevenlevithan.com/archives/date-time-format)

```
var formattedDate = new Date().format('yyyy-MM-dd h:mm:ss');
document.getElementById("time").innerHTML= formattedDate; 
```

[演示](http://jsfiddle.net/4duy3/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T10:32:16.447

基本上，我们有三种方法，您必须自己组合字符串：

> getDate()：返回日期
> 
> getMonth()：返回月份
> 
> getFullYear()：返回年份

例子：

> var d = 新日期（）；
> 
> ```
> var curr_date = d.getDate();
> 
> var curr_month = d.getMonth() + 1; //Months are zero based
> var curr_year = d.getFullYear();
> document.write(curr_date + "-" + curr_month + "-" + curr_year); </script> 
> ```

有关更多详细信息，请查看[格式化日期和时间的 10 个步骤，](http://www.webdevelopersnotes.com/tips/html/10_ways_to_format_time_and_date_using_javascript.php3)并[检查此](http://www.elated.com/articles/working-with-dates/)

# java - 标记的语法错误，错误的构造

> ID：13622992
> 
> 赞同：3
> 
> 时间：2012-11-29T09:50:33.197
> 
> 标签：java, hashmap

我有代码：

```
Map<String, String> map = new HashMap<String, String>; 
```

现在在 Eclipse 中是`new HashMap<String, String>`红色下划线的。

```
The Error: Syntax error on token(s), misplaced construct(s) 
```

这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T09:51:20.117

它应该是

```
Map<String, String> map = new HashMap<String, String>(); //<-- add parentheses 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T09:51:42.137

只需添加一个（）！`Map<String, String> map = new HashMap<String, String>();`

使用**new HashMap**，您可以调用`HashMap.java`. 要初始化 HashMap，您应该调用 Constructer。这里有（）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T09:52:36.383

您缺少一些括号：

```
Map<String, String> map = new HashMap<String, String>(); 
```

# javascript - 如何将整数附加到链接名称？

> ID：13622995
> 
> 赞同：-1
> 
> 时间：2012-11-29T09:50:34.773
> 
> 标签：javascript, html

我已经定义了以下 JavaScript：-

```
<script type="text/javascript">
var html = ' ';
var i = 1 ;

if ( "#variable.1#" != null) {
    html += '<div><a href="/Service1.svc/vf/img?imgid=#variable.1#" >"View Page" + i </a></div>';
i =i +1;
}

if ( "#variable.2#" != null) {
   html  += '<div><a href="/Service1.svc/vf/img?imgid=#variable.2#"> "View Page"  i </a></div>';
i = i=1;
}

if ( "#variable.3#" !=null) {
    html += '<div><a href="/Service1.svc/vf/img?imgid=#variable.3#" >"View Page" + i </a></div>';
i = i+1;
}

document.write(html);
</script> 
```

但是如果所有变量都不为空，上述javascript的输出将是：-

```
"View Page" + i
"View Page" i
"View Page" + i 
```

那么我如何强制输出为外部集成图像

```
View Page 1
View Page 2
View Page 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:56:25.793

利用

```
html += '<div><a href="/Service1.svc/vf/img?imgid=#variable.3#" >View Page '+i+'</a></div>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T09:56:56.857

您需要按如下方式格式化字符串：

```
html += '<div><a href="/Service1.svc/vf/img?imgid=#variable.3#" >"View Page" ' + i + '</a></div>' 
```

这将获取的值`i`并将其附加到字符串中，而不是`i`本身。

作为附加信息，请记住，在 JavaScript 中，当将字符串添加到整数时，整数会被解析为字符串而不是逆字符串。正如评论中指出的那样，

```
var answer = 1 + 1 + "1"
// answer = 21, not "111" and not 3 
```

# java - 休眠缓存问题？

> ID：13622996
> 
> 赞同：1
> 
> 时间：2012-11-29T09:50:38.267
> 
> 标签：java, hibernate, jpa, jboss, jboss5.x

我正在使用 JPA 和 Hibernate，在 JBOSS 5.1 中运行。

我遇到了一个奇怪的行为，因为当我通过事务中的 EntityManager 写入一些数据时，我提交了这个事务，并且在我开始一个新事务来读取这个写入的数据之后，新数据不会由查询返回（但是旧的），但我看到数据库中提交的新数据（我通过另一个进程看到它）。

我可以根据需要多次重复此读取（在同一事务中的调试模式下），不会返回新数据。

然后，如果我执行 entityManager.clear()，下一次读取（在同一事务中）最终返回数据。

有趣的部分从这里开始：安装在另一台机器上的相同 JBoss（物理副本、库、配置、所有内容），指向相同的物理数据库工作正常（它无需清除 EM 即可获取数据）。所以它必须与环境有关......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:10:24.507

检查`JBoss/server/default/deployers/ejb3.deployer/META-INF/persistence.properties`两台服务器。

不幸的是，默认情况下它只包含`hibernate.cache.provider_class=org.hibernate.cache.HashtableCacheProvider`非事务性的，应该用`org.hibernate.cache.jbc2.JBossCacheRegionFactory`or替换`org.hibernate.cache.jbc2.JndiMultiplexedJBossCacheRegionFactory`。

也可以看看

[https://community.jboss.org/wiki/ClusteredJPAHibernateSecondLevelCachinginJBossAS5](https://community.jboss.org/wiki/ClusteredJPAHibernateSecondLevelCachinginJBossAS5)

[http://www.mastertheboss.com/hibernate-cache/using-hibernate-second-level-cache-with-jboss-as-5-6-7](http://www.mastertheboss.com/hibernate-cache/using-hibernate-second-level-cache-with-jboss-as-5-6-7)