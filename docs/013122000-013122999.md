# StackOverflow 问答 13122000-13122999

# java - 如何获取具有 http://www.europewebsite.co.uk 等 URL 的服务器的主机名？

> ID：13122000
> 
> 赞同：1
> 
> 时间：2012-10-29T12:50:45.990
> 
> 标签：java, url, webserver, httprequest, hostname

我正在处理的项目有多个实例（即不同的网站）在单个代码库中运行。根据 URL，我们显示相应的网站。

例如，如果`http://www.uswebsite.com/`我们显示美国网站。如果`http://www.cawebsite.com/` 将显示加拿大网站。为检测这一点而编写的代码是

```
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

String server` = httpRequest.getServerName(); 
```

如果请求来自`http://www.uswebsite.com/`那么根据上面的代码`String server = uswebsite`所以我们编写了额外的代码来弹出相应的站点

我们现在计划将欧洲实例包含在同一代码库中，我看到欧洲站点的 URL 将类似于[http://www.europewebsite.co.uk/](http://www.europewebsite.co.uk/)。使用上面的 getServer() 它将获取`String server=europewebsite`. 最后加上 .co.uk 后，上面的代码仍然会得到`String server=europewebsite`，或者`String server=europewebsite.co`请告知，因为我无法在我的本地测试它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T12:52:35.533

您问题的措辞相当混乱，因此我假设您只是想从分层 URL 字符串中提取主机名。

最可靠的方法是为 url 字符串构造`java.net.URL`or的实例`java.net.URI`，并使用相关的 getter 来提取主机名。

* * *

另一方面，如果您尝试在 servlet 中检测当前请求的虚拟主机名，那么您`httpRequest.getServerName()`会为您提供该主机名，因为它出现在 HTTP 请求的第一行（除非有东西重写了它......）。

* * *

另一方面，如果您只是想`"europewebsite"`从 DNS 名称中提取`"www.europewebsite.co.uk"`，则没有通用的解决方案。我建议将 DNS 转换为全小写，并在您已使用您准备识别的所有变体预先初始化的表中进行查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T12:59:43.040

通常 httpRequest.getServerName() 将返回主机名，在您的情况下它是完整的名称，即。“欧洲网站.co.uk”。

# python - 使用python以错误的顺序从目录中提取文件

> ID：13122005
> 
> 赞同：20
> 
> 时间：2012-10-29T12:50:58.143
> 
> 标签：python, list, tkinter

我正在使用目录中的文件填充 tkinter 列表框。文件的名称都以 01 - n 的数字开头。当我查看目录中的文件时，它们按数字顺序显示。但是，当我将文件加载到列表框中时，它们没有按数字排序。我可以更改前导数字，但相同的文件将始终出现在同一个位置。

我只是使用简化的项目名称来保持这个例子的简单。它仍然表明它们没有按字母顺序或数字排序。

该列表应在我的列表框中显示如下

```
01\. itemA
02\. itemB
03\. itemC
04\. itemD 
```

但它显示为：

```
01\. itemA
04\. itemD
02\. itemB
03\. itemC 
```

我可以更改前导数字，但文件将始终以相同的顺序填充（按名称，而不是数字）。奇怪的是，它甚至不是字母顺序。

我用过这个

```
i = 0
for filename in os.listdir(directory):
      fileList.insert(i, filename)
      i = i + 1 
```

还有这个

```
 for filename in os.listdir(directory):
        fileList.insert(END, filename) 
```

两者都导致同样的事情。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-29T12:55:14.313

[`os.listdir`](http://docs.python.org/2/library/os.html#os.listdir)不保证目录内容的任何顺序。如果您希望对项目进行排序，只需使用内置函数对它们进行排序（必要时`sorted`使用适当的函数）。`key`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-29T12:57:28.127

试试这个。

```
for index, filename in enumerate(sorted(os.listdir(directory))):
        print '{0:02d}. {1}'.format(index + 1, filename) 
```

如果数字是文件名的一部分，请参考@FabienAndre 的评论。

```
for filename in sorted(os.listdir(directory)):
        print filename 
```

# jquery - jQuery Accordion 单击一次展开/单击时折叠

> ID：13122010
> 
> 赞同：2
> 
> 时间：2012-10-29T12:51:27.723
> 
> 标签：jquery, accordion, double-click

我从这里下载了我的手风琴：[http](http://www.snyderplace.com/demos/accordion.html) ://www.snyderplace.com/demos/accordion.html并且我的老板告诉我他希望在用户单击每个标题时打开和关闭该功能。

例如，当您单击一个标题时，它会打开，当您单击另一个标题时，它也会打开，但之前打开的标题不会关闭，除非再次单击该标题。

我可以通过更改以下代码来实现这一点：

```
 animateClose: function (elem, opts) { 
```

对此：

```
 animateClose: function (elem) { 
```

现在的问题是标题需要单击一次而不是两次。有没有办法解决这个问题？

这是完整的代码：

```
 <script type="text/javascript">
    $(document).ready(function() {

    //syntax highlighter
    hljs.tabReplace = ' ';
    hljs.initHighlightingOnLoad();

    //accordion
    $('h3.accordion').accordion({
    defaultOpen: 'section1',
    cookieName: 'accordion_nav',
    speed: 'slow',
    animateOpen: function (elem, opts) { //replace the standard slideUp with custom function
    elem.next().slideFadeToggle(opts.speed);
    },
    animateClose: function (elem) { //replace the standard slideDown with custom function
    elem.next().slideFadeToggle(opts.speed);
    }
    });
    $('h3.accordion2').accordion({
    defaultOpen: 'sample-1',
    cookieName: 'accordion2_nav',
    speed: 'slow',
    cssClose: 'accordion2-close', //class you want to assign to a closed accordion header
    cssOpen: 'accordion2-open',
    });

    //custom animation for open/close
    $.fn.slideFadeToggle = function(speed, easing, callback) {
    return this.animate({opacity: 'toggle', height: 'toggle'}, speed, easing, callback);
    };

    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T12:59:20.250

**[jsBin 演示](http://jsbin.com/uleloy/2/edit)**

HTML：

```
 <div class="accordion">
    <h3>Title 1</h3>
    <div>Content 1...</div>
    <h3>Title 2</h3>
    <div>Content 2...</div>  
    <h3>Title 3</h3>
    <div>Content 3...</div>  
    <h3>Title 4</h3>
    <div>Content 4...</div>  
  </div> 
```

jQuery：

```
var $accordionIO = $('.accordion h3');
$accordionIO.next('div:gt(0)').hide(); // hide all but first section

$accordionIO.click(function(){
  $(this).next('div').slideToggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:00:08.573

如果您通读源文件`jquery.accordion.js`- ，您将看到以下代码：

```
//opens a accordion panel
function open($this, opts) {
    close(opts);
    //give the proper class to the linked element
    $this.removeClass(opts.cssClose).addClass(opts.cssOpen);

    //open the element
    opts.animateOpen($this, opts);

    //do cookies if plugin available
    if (useCookies(opts)) {
        // split the cookieOpen string by ","
        id = $this.attr('id');
        setCookie(id, opts);
    }
} 
```

正如你所看到的，这个函数做的第一件事是——

```
 close(opts); 
```

那就是关闭所有打开的标题。我认为，如果您对此行发表评论，您将实现所需的目标。

# opencl - 如何使用 opencl 在内核中显示图像？

> ID：13122016
> 
> 赞同：3
> 
> 时间：2012-10-29T12:51:34.630
> 
> 标签：opencl

我是opencl的新手。任务是：

1.  加载预先存在的图像
2.  使用opencl编写主机代码将图像ptr发送到内核
3.  计算内核中加载图像的hsl阈值
4.  显示阈值或二值图像

我已经使用 opencv 在我的程序中加载预先存在的 2D 图像。我使用开放的 cl 缓冲区对象来分配内存并将图像指针发送到内核。在内核执行之后，为了显示来自内核的计算图像，我需要 clEnqueueReadBuffer。然后我使用 opencv 显示来自主机的图像。我在下面附上了代码

由于这需要更多时间在 GPU 和 CPU 上，我想切换到图像内存。

但我想知道图像的使用是否还需要 clenqueueReadImage 将图像从内核复制到主机，或者我们有什么方法可以在内核本身中显示阈值图像？

```
//My code using opencl buffers    
IplImage *src = cvLoadImage("../Input/im2.png",CV_LOAD_IMAGE_COLOR );

int a=src->height;
int b=src->width;

cl_context CreateContext()
{
    cl_int errNum;
    cl_uint numPlatforms;
    cl_platform_id firstPlatformId;
    cl_context context = NULL;
    errNum = clGetPlatformIDs(1, &firstPlatformId, &numPlatforms);
    if (errNum != CL_SUCCESS || numPlatforms <= 0)
    {
        std::cerr << "Failed to find any OpenCL platforms." << std::endl;
        return NULL;
    }

    cl_context_properties contextProperties[] =
    {
        CL_CONTEXT_PLATFORM,
        (cl_context_properties)firstPlatformId,
        0
    };
    context = clCreateContextFromType(contextProperties, CL_DEVICE_TYPE_GPU,
                                      NULL, NULL, &errNum);
    if (errNum != CL_SUCCESS)
    {
        std::cout << "Could not create GPU context, trying CPU..." << std::endl;
        context = clCreateContextFromType(contextProperties, CL_DEVICE_TYPE_CPU, NULL, NULL, &errNum);
        if (errNum != CL_SUCCESS)
        {
            std::cerr << "Failed to create an OpenCL GPU or CPU context." << std::endl;
            return NULL;
        }
    }
    return context;
}

cl_command_queue CreateCommandQueue(cl_context context, cl_device_id *device)
{
    cl_int errNum;
    cl_device_id *devices;
    cl_command_queue commandQueue = NULL;
    size_t deviceBufferSize = -1;
    errNum = clGetContextInfo(context, CL_CONTEXT_DEVICES, 0, NULL, &deviceBufferSize);
    if (errNum != CL_SUCCESS)
    {
        std::cerr << "Failed call to clGetContextInfo(...,GL_CONTEXT_DEVICES,...)";
        return NULL;
    }

    if (deviceBufferSize <= 0)
    {
        std::cerr << "No devices available.";
        return NULL;
    }
    devices = new cl_device_id[deviceBufferSize / sizeof(cl_device_id)];
    errNum = clGetContextInfo(context, CL_CONTEXT_DEVICES, deviceBufferSize, devices, NULL);
    if (errNum != CL_SUCCESS)
    {
        delete [] devices;
        std::cerr << "Failed to get device IDs";
        return NULL;
    }

    commandQueue = clCreateCommandQueue(context, devices[0],CL_QUEUE_PROFILING_ENABLE, &errNum );

    if (commandQueue == NULL)
    {
        delete [] devices;
        std::cerr << "Failed to create commandQueue for device 0";
        return NULL;
    }

    *device = devices[0];
    delete [] devices;
    return commandQueue;
}

cl_program CreateProgram(cl_context context, cl_device_id device, const char* fileName)
{
    cl_int errNum;
    cl_program program;

    std::ifstream kernelFile(fileName, std::ios::in);
    if (!kernelFile.is_open())
    {
        std::cerr << "Failed to open file for reading: " << fileName << std::endl;
        return NULL;
    }

    std::ostringstream oss;
    oss << kernelFile.rdbuf();

    std::string srcStdStr = oss.str();
    const char *srcStr = srcStdStr.c_str();
    program = clCreateProgramWithSource(context, 1,
                                        (const char**)&srcStr,
                                        NULL, NULL);
    if (program == NULL)
    {
        std::cerr << "Failed to create CL program from source." << std::endl;
        return NULL;
    }
    errNum = clBuildProgram(program, 0, NULL, NULL, NULL, NULL);

    if (errNum != CL_SUCCESS)
    {
        char buildLog[16384];
        clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG,
                              sizeof(buildLog), buildLog, NULL);
        std::cerr << "Error in kernel: " << std::endl;
        std::cerr << buildLog;
        clReleaseProgram(program);
        return NULL;
    }
    return program;
}

bool CreateMemObjects(cl_context context, cl_mem memObjects[2], unsigned char *src_ptr)
{
    memObjects[0] = clCreateBuffer(context, CL_MEM_READ_ONLY | CL_MEM_COPY_HOST_PTR, sizeof(unsigned char) *(a*b*3) , src_ptr , NULL);
    memObjects[1] = clCreateBuffer(context, CL_MEM_READ_WRITE, sizeof(unsigned char) *(a*b) , NULL, NULL);

   if (memObjects[0] == NULL || memObjects[1] == NULL)
    {
        std::cerr << "Error creating memory objects" << std::endl;
        return false;
    }
    return true;
}

void Cleanup(cl_context context, cl_command_queue commandQueue, cl_program program, cl_kernel kernel, cl_mem memObjects[2])
{
    for (int i = 0; i < 2; i++)
    {
        if (memObjects[i] != 0)
            clReleaseMemObject(memObjects[i]);
    }
    if (commandQueue != 0)
        clReleaseCommandQueue(commandQueue);

    if (kernel != 0)
        clReleaseKernel(kernel);

    if (program != 0)
        clReleaseProgram(program);

    if (context != 0)
        clReleaseContext(context);
}

int main()
{
    cl_context context = 0;
    cl_command_queue commandQueue = 0;
    cl_program program = 0;
    cl_device_id device = 0;
    cl_kernel kernel = 0;
    cl_mem memObjects[2] = { 0,0 };
    cl_int errNum;
    cl_event myEvent;

    cl_ulong start_time,end_time;
    double kernelExecTimeNs;

    IplImage *thres_img1 = cvCreateImage(cvGetSize(src), IPL_DEPTH_8U, 1);

    unsigned char *tur_image1,*src_ptr;
    tur_image1 = (unsigned char*) malloc((a*b) * sizeof(unsigned char));
    src_ptr = (unsigned char*) malloc ((a*b*3) * sizeof(unsigned char));

    context = CreateContext();
    if (context == NULL)
    {
        std::cerr << "Failed to create OpenCL context." <<std::endl;
        return 1;
    }

    commandQueue = CreateCommandQueue(context, &device);
    if (commandQueue == NULL)
    {
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }

    program = CreateProgram(context, device, "hsl_threshold.cl");
    if (program == NULL)
    {
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }

    kernel = clCreateKernel(program, "HSL_threshold", NULL);
    if (kernel == NULL)
    {
        std::cerr << "Failed to create kernel" << std::endl;
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }

    printf("height:%d\n",a);//image height
    printf("width:%d\n",b);//image width

    cvShowImage("color image",src);
    cvWaitKey(0);

    memcpy(src_ptr,src->imageData,(a*b*3));

    if (!CreateMemObjects(context, memObjects, src_ptr))
    {
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }

        errNum  = clSetKernelArg(kernel, 0, sizeof(cl_mem), &memObjects[0]);
    errNum |= clSetKernelArg(kernel, 1, sizeof(cl_mem), &memObjects[1]);

    if (errNum != CL_SUCCESS)
    {
        std::cerr << "Error setting kernel arguments" << std::endl;
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }

    cout<<"Kernel arguments set successfully";
    size_t globalWorkSize[1]={a*b};
    size_t localWorkSize[1]={512};

    errNum = clEnqueueNDRangeKernel(commandQueue, kernel, 1, NULL, globalWorkSize, localWorkSize, 0, NULL, &myEvent);

    clWaitForEvents(1,&myEvent);

    if (errNum != CL_SUCCESS)
    {
        std::cerr << "Error queuing kernel for execution." << std::endl;
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }
    clFinish(commandQueue);

    clGetEventProfilingInfo(myEvent, CL_PROFILING_COMMAND_START, sizeof(start_time), &start_time, NULL);
    clGetEventProfilingInfo(myEvent, CL_PROFILING_COMMAND_END, sizeof(end_time), &end_time, NULL);

    kernelExecTimeNs = end_time-start_time;

    printf("\nExecution time in milliseconds = %0.3f ms\n",( kernelExecTimeNs / 1000000.0) );
    cout<<"\n Kernel timings \n"<<kernelExecTimeNs<<"seconds";

    errNum = clEnqueueReadBuffer(commandQueue, memObjects[1], CL_TRUE,
                                 0, (a*b) * sizeof(unsigned char), tur_image1,
                                 0, NULL, NULL);

    if (errNum != CL_SUCCESS)
    {
        std::cerr << "Error reading result buffer." << std::endl;
        Cleanup(context, commandQueue, program, kernel, memObjects);
        return 1;
    }

    memcpy(thres_img1->imageData,tur_image1,sizeof(unsigned char)*(a*b));

    cvShowImage( "hsl_thresh",thres_img1);
    cvSaveImage( "../Output/hsl_threshold.png",thres_img1);
    cvWaitKey(0);

    std::cout<<std::endl;
    std::cout<<"Image displayed Successfully"<<std::endl;

    Cleanup(context,commandQueue,program,kernel,memObjects);
    printf("\n Free opencl resources");
    std::cin.get();
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T14:34:41.657

有一些方法可以通过 OpenGL 直接处理 OpenCL 计算的数据。您的 OCL 实现必须支持扩展`cl_khr_gl_sharing`。
这种模式称为 CL/GL 互操作模式。

如果您首先创建一个 OpenGL 实例并使用指向您的 GL 实例的指针初始化 OpenCL，则每个实现都可以访问彼此的数据。

*（所有片段均取自使用 CL-C++-Bindings 的代码，我想这对于一般理解来说是可以的）*

```
cl_context_properties properties[] = 
  // Take this line to create an OCL context in GL-CL-interop-mode. 
  // OpenGL must already be initialised. 
  // For interop init see: http://www.khronos.org/registry/cl/extensions/khr/cl_khr_gl_sharing.txt
  // USING: CL_GL_CONTEXT_KHR: Rendering Context [Use your OGL-HGLRC variable or do wglGetCurrentContext(); ]
  //   AND: CL_WGL_HDC_KHR: Device Context [Use your OGL-HDC variable or do wglGetCurrentDC(); ]
  { 
    CL_CONTEXT_PLATFORM, (cl_context_properties)(_platforms->at(0))(), 
    CL_GL_CONTEXT_KHR, (cl_context_properties)myGL->hRC, 
    CL_WGL_HDC_KHR, (cl_context_properties)myGL->hDC, 0
  }; 
```

现在您可以基于 OGL 纹理创建 OCL 图像

```
//The following data can be accessed both from OCL and OGL
cl::Image2D imageFromGL = new cl::Image2DGL(*_context, CL_MEM_READ_WRITE,  GL_TEXTURE_2D, 0, myGL->textures[0]); 
```

在 OCL 中使用内存之前，您必须要求 OGL 释放它

```
//Ask OGL to release memory. All OGL actions must be finished before doing so!
_queue->enqueueAcquireGLObjects(&imageFromGL, NULL, &evt); 
```

现在，做你想做的，然后把它还给 OGL：

```
//Hand memory back to OGL. All OCL actions must be finished before doing so!
_queue->enqueueReleaseGLObjects(&imageFromGL, NULL, &evt); 
```

最后，您可以使用 OpenGL 代码在屏幕上显示数据。

# javascript - 带有编码点的谷歌地图 api 绘制的折线

> ID：13122020
> 
> 赞同：8
> 
> 时间：2012-10-29T12:51:47.867
> 
> 标签：javascript, html, google-maps-api-3

我是 javascript 和谷歌地图 api 的新手，所以我对这样的点进行了编码：“yzocFzynhVq}@n}@o}@nzD”并尝试用它绘制折线，我还没有找到主题或文档来解决我的问题. 如何解码它的主题很少，但我不需要做那件事。我只需要使用编码点绘制折线。有人能给我举个例子吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-29T13:03:22.207

请参阅[decodePath 的几何库文档](https://developers.google.com/maps/documentation/javascript/reference#encoding)

这会将您的编码字符串转换为可用于创建[折线的 google.maps.LatLng 对象数组](https://developers.google.com/maps/documentation/javascript/reference#Polyline)

[工作示例](http://www.geocodezip.com/v3_GoogleEx_polygon-simple_fromEncoded.html)

工作代码片段：

```
function initialize() {
  var myLatLng = new google.maps.LatLng(24.886436490787712, -70.2685546875);
  var mapOptions = {
    zoom: 13,
    center: myLatLng,
    mapTypeId: google.maps.MapTypeId.TERRAIN
  };

  var bermudaTriangle;

  var map = new google.maps.Map(document.getElementById('map_canvas'),
    mapOptions);

  // Construct the polygon
  bermudaTriangle = new google.maps.Polygon({
    paths: google.maps.geometry.encoding.decodePath("yzocFzynhVq}@n}@o}@nzD"),
    strokeColor: '#FF0000',
    strokeOpacity: 0.8,
    strokeWeight: 2,
    fillColor: '#FF0000',
    fillOpacity: 0.35
  });

  bermudaTriangle.setMap(map);
  map.setCenter(bermudaTriangle.getPath().getAt(Math.round(bermudaTriangle.getPath().getLength() / 2)));
}
google.maps.event.addDomListener(window, 'load', initialize);
```

```
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}
#map_canvas {
  height: 100%;
}
@media print {
  html,
  body {
    height: auto;
  }
  #map_canvas {
    height: 650px;
  }
}
```

```
<script src="https://maps.googleapis.com/maps/api/js?libraries=geometry&key=AIzaSyCkUOdZ5y7hMm0yrcCQoCvLwzdM6M8s5qk"></script>
<div id="map_canvas"></div>
```

# regex - perl 替换文本块

> ID：13122034
> 
> 赞同：2
> 
> 时间：2012-10-29T12:52:27.313
> 
> 标签：regex, perl, replace

我非常坚持创建我需要的 perl。

我有一个文件，其中包含以下内容

```
 define(`CONFM4_AST_MODULES', `NOLOAD => app_thingie.so
    NOLOAD => app_thingie2.so
    NOLOAD => app_thingie3.so') 
```

现在我需要能够重写整个块，所以我正在考虑匹配“（`CONFM4_AST_MODULES”和“'）”之间的所有内容删除它然后再次附加它。在文件的末尾。是否可以正则表达式这样的事情？如果是这样怎么办？

由于有时会发生变化，因此无法对我的 perl 脚本中的整个文本进行硬编码。

如果您对如何解决这个问题有任何其他想法，我很乐意听到它:)

文件中存在的东西的数量也从 3 变为 20。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T12:59:51.457

是的，有可能。您可以将整个文件读入一个变量并进行替换：

```
my $var = do { local $/; <> };                           # Read in the file.
my $re = qr/(define\(`CONFM4_AST_MODULES',[^)]+\)\n?)/;  # How to search for the defines.
my @defs = $var =~ /$re/g;                               # Remember the defines.
$var =~ s/$re//g;                                        # Remove them.
print $var, @defs; 
```

**更新**：代码改进和测试。

# jquery - 如何控制preventDefault？

> ID：13122039
> 
> 赞同：0
> 
> 时间：2012-10-29T12:52:38.833
> 
> 标签：jquery, preventdefault

我想`preventDefault`在父元素上使用，但我不希望它影响子元素。这可以做到吗？

*我设置了一个 JsFiddle 来帮助说明我的意思*：http: [//jsfiddle.net/StephenMeehan/FdwST/5/](http://jsfiddle.net/StephenMeehan/FdwST/5/)

我一直在为这个问题挠头几个小时，无法弄清楚......

**HTML**：

```
<ul id="SidebarNav">
<li><a href="#">Toys &amp; Games</a></li>
<li><a href="#">Audio Visual</a></li>
<li><a href="#">Electrical</a></li>
<li><a href="#">Photography</a></li>
<li><a href="http://www.google.com">Furniture (Hover over this)</a>
<ul>
<li><a href="http://www.bbc.co.uk">Menu item 1</a></li>
<li><a href="#">Menu item 2</a></li>
<li><a href="#">Menu item 3</a></li>
<li><a href="#">Menu item 4</a></li>
<li><a href="#">Menu item 5</a></li>
</ul>
</li>
<li><a href="#">Music</a></li>
<li><a href="#">Gadgets</a></li>
<li><a href="#">Laptops</a></li>
<li><a href="http://www.google.com">Furniture (Hover over this)</a>
<ul>
<li><a href="http://www.bbc.co.uk">Menu item 1</a></li>
<li><a href="#">Menu item 2</a></li>
<li><a href="#">Menu item 3</a></li>
<li><a href="#">Menu item 4</a></li>
<li><a href="#">Menu item 5</a></li>
</ul> 
```

**JavaScript：**

```
// This is my first attempt at writing something useful in jQuery.
$(document).ready(function() {

    $("#SidebarNav ul").hide();

    $("li:has(ul)").addClass("SubMenu");

    // preventDefault removes default events on #SidebarNav a and it's children. 
    //Is there a way to only target list items with a class of .SubMenu?
    // I want to use preventDefault only on .SubMenu a, and still be able to use the links in the drop down menu.
    $(".SubMenu a").click(function(e) {
        e.preventDefault();
    });

    // This works, but it sometimes gets confused if there's more than one drop down and the mouse is moved around too fast. Is there a way to force collapse all other SubMenu items on rollover?
    $(".SubMenu").on("hover", function() {
        $(this).children("ul").delay(100).slideToggle("fast").stop();
    });

});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:08:49.870

在我能理解之后，您只需在选择器中添加一个`:first`以`.SubMenu a`选择第一个`a`以防止默认行为。

所以使用：`$(".SubMenu a:first").click ....`

查看选择器上的[jQuery 文档](http://api.jquery.com/first-selector/)`:first`

编辑：为您[准备的 JS Fiddle](http://jsfiddle.net/FdwST/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:08:13.567

`>`允许您选择元素的直接子元素，玩这些应该可以。

所以在你的情况下如何：

```
$(".SubMenu > a").click(function(e) {
    e.preventDefault();
}); 
```

有关 jquery 直接后代选择器的更多信息，请参阅：[api.jquery.com/child-selector](http://api.jquery.com/child-selector)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T17:18:24.017

感谢 ThoKra 回答问题。我最终得到了这个工作。这将在 .SubMenu 的所有类中找到所有第一个 a 标签。

```
$(".SubMenu").find("a:first").click(function(e) {
e.preventDefault();
}); 
```

下面的 JQuery 只会在 .SubMenu 的第一个实例中找到第一个 a 标签，我的页面有多个 .SubMenu 实例，所以不太正确。

```
$(".SubMenu a:first").click(function(e) {
e.preventDefault();
}); 
```

*希望这可以帮助任何寻找类似解决方案的人。再次感谢 ThoKra。*

# python - python虚拟环境中的Qt4问题

> ID：13122044
> 
> 赞同：0
> 
> 时间：2012-10-29T12:52:49.473
> 
> 标签：python, qt4, virtualenv

当我尝试从虚拟环境中导入 Qt4 模块时，出现以下错误：

```
$ python -c 'from PyQt4 import QtCore, QtGui'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named PyQt4 
```

包`python-qt4`、`python-qt4-dev`和`pyqt4-dev-tools`都安装在系统上，当我从虚拟环境外部运行相同的命令时，我没有收到任何错误。任何想法如何解决这一问题？我正在使用 Ubuntu 10.04、python 2.6 和 virtualenv 1.8.2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T12:58:45.280

virtualenv 的全部意义在于它与系统的其余部分隔离。现代版本的 virtualenv 默认配置不包括系统 Python 包。如果您想检查您的 virtualenv 是否是在没​​有站点包的情况下创建的，请按照[此问题](https://stackoverflow.com/questions/8887445/how-to-check-whether-virtualenv-was-created-with-no-site-packages)中接受的答案的建议进行操作。

您需要在 virtualenv 中安装 PyQt4。该过程可能会使第一个计时器跳闸-因此请先阅读[此问题](https://stackoverflow.com/questions/1961997/is-it-possible-to-add-pyqt4-pyside-packages-on-a-virtualenv-sandbox)的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T12:58:41.887

从 virtualenv 1.7 开始 --no-site-packages 成为默认行为。要使全局站点包可导入（过去是默认设置），您必须在创建 virtualenv 时使用选项 --system-site-packages。

# .net - 从不用于比较的 lambda 函数创建表达式

> ID：13122052
> 
> 赞同：1
> 
> 时间：2012-10-29T12:53:12.950
> 
> 标签：.net, vb.net, linq, lambda, linq-expressions

我目前正在构建一个构建查询的 UI，我希望能够以 lambda 函数的形式存储其他表达式（因为它可以很容易地使用智能感知等添加它们）。但是，我找不到任何方法来获取例如。一个执行成员访问以转换为表达式的 lambda，然后我可以将其插入到表达式树中。

注意。我需要的不仅仅是成员访问

IE。我正在尝试填写以下函数的主体

```
Function GetExpression(Of ParamType, ReturnType) _
    (f As Func(Of ParamType, ReturnType)) As Expression 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T15:02:15.520

将您的方法参数更改为：

```
Function GetExpression(Of ParamType, ReturnType) _
    (f As Expression(Of Func(Of ParamType, ReturnType))) As Expression 
```

当您使用 lambda 调用它时，编译器会将标记化的表达式树提供给方法而不是编译的委托。

[将执行 lambda 的Enumerable.Where](http://msdn.microsoft.com/en-us/library/bb534803.aspx)与不执行 lambda 的[Queryable.Where](http://msdn.microsoft.com/en-us/library/bb535040.aspx)进行比较和对比。

# asp.net - 如何创建将请求中继到另一个网站并显示响应的 ASP.NET 应用程序？

> ID：13122054
> 
> 赞同：2
> 
> 时间：2012-10-29T12:53:21.713
> 
> 标签：asp.net

我在一个封闭的网络中有一个简单的网站，我们称之为“受限制的网站”。受限站点有一些超链接到其他页面，而不是显示来自不同文件的日志信息的索引。

我正在尝试创建一个 ASP.NET 站点，该站点将向外界公开，但仍与受限站点位于同一网络中。让我们将此站点称为“公共站点”。

在公共站点中，我需要将所有请求转发到受限站点，然后显示来自受限站点的响应。换言之，公共站点将充当受限站点的代理。

如何在 ASP.NET 中实现这一点？如果您有任何简单的代码可以分享，请做。

**到目前为止**我所尝试的：我尝试过创建一个像这样的 HttpHandler（没有运气）：[HttpHandler](http://www.codeproject.com/Articles/7135/Simple-HTTP-Reverse-Proxy-with-ASP-NET-and-IIS)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T16:04:57.550

我最终使用了两个 IIS 扩展来做我想做的事。

我使用了这些扩展： - 应用程序请求重新路由 - URL 重写

您可以搜索“IIS 中的反向代理”，您会发现很多关于如何设置它的不同文章。

提示：如果您想在一个有 CMS 的网站上设置它。您可以在该站点中创建一个虚拟目录并仅为该虚拟目录设置 URL 重写规则。

# jquery - Slideup完成jquery时向下滑动

> ID：13122058
> 
> 赞同：0
> 
> 时间：2012-10-29T12:53:28.760
> 
> 标签：jquery, slidedown, slideup

我正在制作一个图像浏览器，您可以在其中通过单击图像本身来编辑图像的名称。然后 tr 会出现在它的底部，并带有一个可以更改图像名称的表单。一切正常，除了幻灯片动画。

首先，我检查是否已经显示了 editRow。如果是，它会先上滑，然后从网站上删除。之后，我为单击的图像附加了一个新的 editRow。我必须有幻灯片动画。我怎样才能让它正常工作？现在幻灯片工作正常。它向上滑动并删除 editRow div。之后，什么也没有发生。

此外，div 只会在第一次出现。

```
$('.imgItem').click(function() {
        imgID = $(this).parent().find('div').attr('id').replace(/image/, '');;
        if($('.editRow').length){
            $('.editRow').slideUp(300, function(){
                $('.editRow').remove();
                $(this).parent().parent().parent().after('<tr class="editRow"><td class="editItem" colspan="4"></td></tr>');
                $('.editRow').hide();
                $('.editItem').load("ajax.editImage.php",{imgID:imgID});
                $('.editRow').slideDown().show();
            });         
        }else{
            $(this).parent().parent().parent().after('<tr class="editRow"><td class="editItem" colspan="4"></td></tr>');
            $('.editRow').hide();
            $('.editItem').load("ajax.editImage.php",{imgID:imgID});
            $('.editRow').slideDown().show();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T12:55:32.957

那是因为您要删除所有具有类 editRow 的元素。我想你需要：

```
$('.editRow').slideUp(300, function(){
            ...
            $(this).remove(); 
```

最后删除它，因为否则`$(this).parent()`什么都没有，因为`this`已从 DOM 中删除。

# google-app-engine - 如何以编程方式查找谷歌应用实例

> ID：13122060
> 
> 赞同：1
> 
> 时间：2012-10-29T12:53:39.643
> 
> 标签：google-app-engine

我已经实现了实例 mem-caches，因为我们有非常静态的数据，而且与实例缓存相比，memcache 不是很可靠而且相当慢。

但是，在某些情况下，我想使实例缓存无效。有什么办法可以查到它们吗？

示例管理员 A 更新实例 A 上的大型游戏表，该实例查找所有其他实例并使用简单的 REST api 更新数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:20:13.573

TL;DR：你不能。

与[后端](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/backends/BackendService#getBackendAddress%28java.lang.String,%20int%29)不同，前端实例不可单独寻址；也就是说，您无法对特定的前端实例进行 RESTy URLFetch 调用。即使它们是，也没有用于枚举前端实例的内置机制，因此您需要自己滚动，例如在数据存储中保留一个活动实例列表并在预热请求中添加到它并在重复连接失败时删除。但是此时您刚刚实现了一个速度较慢、成本更高且可用的内存缓存服务更少。

如果您将所有缓存服务移动到后端（使用您的实例本地静态，或者，例如，将[用 Go 编写的 memcached](http://dustin.github.com/2009/11/12/gomemcached.html)作为不同的应用程序版本运行），那么您确实会获得一定程度的控制（或至少是透明度）关于驱逐。可用性、速度和成本仍可能会受到影响。

# c# - 如何从多个 .cs 文件访问类中的相同列表？

> ID：13122061
> 
> 赞同：0
> 
> 时间：2012-10-29T12:53:42.513
> 
> 标签：c#, wpf, silverlight

我猜是一个相当简单的问题.. 我正在尝试访问公共类中的列表（只是我项目中的一个 .CS 文件。）。

在一个 .xaml.cs 中，我使用

```
DataClass dataClass = new DataClass(); 
```

当我尝试在另一个 .xaml.cs 文件中访问它时，我使用了 DataClass dataClass = new DataClass(); 再次。当然，这会创建一个 NEW 类（因此存储在其中的所有信息都不存在。

如何在不创建新课程的情况下访问课程？

亲切的问候，尼尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T12:55:03.447

您可以使列表成为DataClass 中的[**静态数据成员**](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.80%29.aspx)，并创建从其他类访问它的方法。静态数据成员是该类所有实例的共享副本。如果列表应该由不同的线程使用锁访问，您可以将其设为并发列表。您可以将[**ConcurrentBag**](http://msdn.microsoft.com/en-us/library/dd381779.aspx)用于多线程环境。值得一读的是在类似情况下经常使用的[**单例模式。**](http://msdn.microsoft.com/en-us/library/ff650316.aspx)

```
 public class DataClass 
 { 
    public string Timestamp { get; set; }
    private static DataClass instance; 
    private DataClass() { }
    public static DataClass Instance 
    {
        get 
        {
            if(instance==null) 
            { 
                instance = new DataClass(); 
            } 
             return instance; 
        } 
    }  
}

public class Class1
{
     public void SetValue(string str)
     {
         DataClass ds = DataClass.Instance;
         ds.Timestamp  = "value1";
     }
}

public class Class2
{
     public string GetValue(string str)
     {
         DataClass ds = DataClass.Instance;
         return ds.Timestamp;
     }
}

Class1 c1 = new Class1();
c1.SetValue("hello");
Class2 c2 = new Class2();
string value = c2.GetValue(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T12:58:28.907

有一个名为 Singleton 的模式。我想它可以帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:40:34.290

使其成为只读属性，在第一次访问时实例化一个新实例，如下所示：

```
private DataClass dataClass;
public DataClass DataClass
{
    get
    {
        if(dataClass  == null)
        {
             dataClass = new DataClass();
        }
        return dataClass;
    }
} 
```

# jquery - 绑定到 Jquery Nicescroll 事件。哪些活动可用？

> ID：13122065
> 
> 赞同：4
> 
> 时间：2012-10-29T12:53:51.663
> 
> 标签：jquery, scroll, jquery-plugins, nicescroll

我正在使用[Nicescroll](http://areaaperta.com/nicescroll/)并希望绑定到定义 nicescroll-plugin 的 div 的滚动事件。

有点像：

```
$("#sec_menu").niceScroll();  
$("#sec_menu").scroll(function(e){   //do stuff here }); 
```

但是，上述方法不起作用。我可以绑定哪个事件（可能是由 nicescroll 定义的自定义事件）在滚动时触发？我似乎在文档中找不到任何东西。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T03:59:55.310

您只能使用自定义事件：

```
 $("#id").niceScroll().scrollstart(function(info){
      //do something here 
  })
  // or
  $("#id").niceScroll().scrollend(function(info){
      //do something here 
  }) 
```

# javascript - 在 paper.path 中有一个带有 raphael 的背景图像？

> ID：13122067
> 
> 赞同：1
> 
> 时间：2012-10-29T12:53:54.017
> 
> 标签：javascript, svg, raphael

我想把一些背景图片放到我用 raphael 创建的 paper.path

```
paper.path(arc([xCenter, yCenter], radius, startAngle, endAngle)).attr({
                'stroke': "#ccc",
                'stroke-width': rinc - 1
            }); 
```

结果：http: [//jsfiddle.net/n4Rvr/](http://jsfiddle.net/n4Rvr/)

我只想放一些图像而不是#ccc 颜色。是否可以？但是，我没有在互联网上找到有趣的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T19:02:52.697

你想填充路径的笔触吗？Raphaël 中不支持在笔划上使用图案，因此它不像在纯 svg 中那样简单，您可以使用图案进行笔划或使用给定路径遮盖图像以获得所需的效果。

要在 Raphaël 中获得类似的东西，您需要将描边路径构建为新路径，基本上围绕内部和外部弧线进行跟踪，以便您可以填充它。然后使用 'fill' 而不是 'stroke' 并传入你想要的图像的 url。

# drupal - 如何从命令行创建 Drupal 角色？没有角色命名：组织者

> ID：13122069
> 
> 赞同：1
> 
> 时间：2012-10-29T12:53:55.753
> 
> 标签：drupal, drush

我可以从命令行创建用户并将用户添加到角色：

```
$ drush user-create organizer1

$ drush user-add-role organizer organizer1
There is no role named: organizer 
```

但是，我不知道如何从命令行创建角色。

我发现这个模块可以修改角色的权限：

[http://drupal.org/project/drush_role](http://drupal.org/project/drush_role)

但我仍然无法找到创建角色的方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T23:02:53.710

答案在这里：[https ://drupal.stackexchange.com/questions/56451/creating-a-new-user-role-with-drush](https://drupal.stackexchange.com/questions/56451/creating-a-new-user-role-with-drush)

总结是：更新到最新的 Drush 就可以做到了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T16:50:47.713

显然你没有 drush 命令来做这件事。我已经通过直接访问数据库来解决它：

```
$ drush sql-query --db-prefix "INSERT INTO {role} (name, weight) VALUES('organizer', 3)"
test_command "sql-query --db-prefix \"INSERT INTO {role} (name, weight) VALUES('organizer', 3)\"" $?

$ drush sql-query --db-prefix "UPDATE {role} SET weight=4 WHERE (name='administrator')" 
```

请注意此解决方案仅适用于 MySQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:43:24.283

应该由 drush 命令使用。

```
drush user-add-role "power user" 5,user3 
```

将“超级用户”角色添加到具有名称、ID 或电子邮件 5 或 user3 的帐户

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-11T22:14:22.203

这在 D7 中对我有用：

```
drush php-eval 'user_role_save((object) array("name"=>"administrator"));' 
```

如果您还想让新角色成为超级管理员角色：

```
drush php-eval 'variable_set("user_admin_role", end(array_keys(user_roles())))'; 
```

之后，以下创建一个新的“超级管理员”用户：

```
drush user-create Dries --mail="dries@example.com" --password="iheartjoomla"
drush user-add-role administrator Dries 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-28T03:33:18.813

```
drush rcrt 'test role' 
```

来源：[http ://drushcommands.com/drush-7x/role/role-create](http://drushcommands.com/drush-7x/role/role-create)

# .net - 基于每个应用程序域的字符串哈希码计算的实际使用

> ID：13122070
> 
> 赞同：4
> 
> 时间：2012-10-29T12:54:02.677
> 
> 标签：.net

在 .NET 4.5 中，可以选择使用随机字符串哈希码生成。这意味着，在不同的应用程序域中计算的相同字符串的哈希码将是不同的。（见[http://msdn.microsoft.com/en-us/library/jj152924.aspx](http://msdn.microsoft.com/en-us/library/jj152924.aspx)）

问题是：这个选项的实际用途是什么？换句话说，在什么场景（scenarios）我需要开启它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:30:01.073

我相信这个的一般应用是为了防止可能的针对散列机制的 DoS 攻击。

由于`GetHashCode()`在内部被`Dictionary<,>`, 和“正常”数据使用，散列值应该合理分布，以便散列冲突不会“太频繁”发生。当哈希冲突确实发生时，`Dictionary<,>`回退到对具有相同哈希码的所有项目进行线性搜索。

在可公开访问的应用程序中，了解散列机制的攻击者可能会提交包含大量具有相同散列码的字符串的请求，从而导致通常的 O(1) 查找变为 O(N) 查找任何添加了这些值的字典。

特别是对于 Web 应用程序，我相信诸如标头和查询字符串参数之类的东西会被添加到字典中，以便应用程序快速访问，因为这样攻击者可以提交包含数千个参数的请求以及冲突的哈希值，从而导致请求明显更多比“正常”请求更需要资源。这对任何 DoS 尝试都有放大作用，即使攻击者只有相对有限的可用带宽，也允许攻击发生。

通过随机化每个 AppDomain 的哈希值，攻击者不太可能使用冲突哈希来制作字符串，从而防止此类攻击。

**编辑寻址注释：**

虽然 MSDN 文章没有提到它，但设置的*目的不是*提供一种让不同的 AppDomains 创建不同的字符串哈希的方法，它是一种安全功能，可以防止第三方创建许多具有相同哈希的字符串。

在 .NET 4.5 之前（或禁用此设置），只要我运行与您相同的 .NET 版本，`"some string".GetHashCode()`在我的机器上将给出与您相同的值。由于使用的散列机制很简单（当然不是加密安全的散列），因此逆向工程并创建许多具有相同散列的字符串相对容易，然后如上所述使用这些来放大 DoS 攻击。

启用此设置后，随机元素将添加到字符串的哈希码生成中，使攻击者更难以可靠地制作碰撞字符串。

它是每个 AppDomain 的事实是哈希码具有某些必需属性这一事实的副产品，例如，两个相同的字符串具有相同的哈希码。因此，AppDomain 为设置的效果提供了一个合理的边界，因为大多数应用程序在启用此设置的情况下将运行得非常好。

此新设置可能会进一步解决此漏洞披露中提出的问题：与利用 ASP.NET 应用程序中的哈希冲突相关的[CVE-2011-3414](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3414)（我相信，通过限制密钥数量，该问题在其他 .NET 版本中已“修复”可以在请求中提供，防止攻击者创建如此多的冲突，从而显着降低性能）。引用的[论文](http://www.nruns.com/_downloads/advisory28122011.pdf)特别提到缺乏随机字符串散列是导致该问题广泛传播的一个因素。

# asp.net - .NET MVC3 Routing URL Rewriting

> ID：13122078
> 
> 赞同：0
> 
> 时间：2012-10-29T12:54:33.913
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, url-rewriting, asp.net-mvc-routing

> **Possible Duplicate:**
> [How does StackOverflow generate its SEO-friendly URLs?](https://stackoverflow.com/questions/25259/how-does-stackoverflow-generate-its-seo-friendly-urls)

I have an MVC3 site for which I would like to clean up the urls that contain spaces in the names of the products.

Currently, the url displays as: `/products/some%20ugly%20url`

I would like to display: `/products/some-clean-url`

Is it possible with MVC3 routing to rewrite the ugly url to the clean one?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T12:56:51.383

Short answer: **yes this is possible**. Just look up. StackExchange runs on ASP.NET MVC.

Try creating a product **slug**. A slug is a unique string that identifies your item that you want to fetch.

```
/products/fake-blood
/products/spiders-webs
/products/vampire-teeth 
```

You can then key off the slug, instead of an ID. Many solutions store the slug in the database.

# curl - 使用 curl 将视频上传到 youtube

> ID：13122079
> 
> 赞同：1
> 
> 时间：2012-10-29T12:54:45.587
> 
> 标签：curl

我正在尝试将视频从本地服务器上传到 youtube.com。

如果我使用下面的表格，视频会上传到 youtube。登录后，我可以从 youtube 获取响应并采用以下表单中的响应。

```
 <form action="<?php echo( $response->url ); ?>?nexturl=<?php echo( urlencode( $nexturl ) ); ?>" method="post" enctype="multipart/form-data">
            <p class="block">
                <label>Upload Video</label>
                <span class="youtube-input">
                    <input id="file" type="file" name="file" />
                </span>                        
            </p>
            <input type="hidden" name="token" value="<?php echo( $response->token ); ?>"/>
            <input type="submit" value="Upload Video" />
        </form> 
```

但是，如果尝试对 curl 进行如下操作，则它不起作用.. 有什么建议吗？？

```
 $file_name_with_full_path = $video_path; //$video_path is like /path/to/abc.mp4                    
                $post = array('file'=>'@'.$file_name_with_full_path, 'token' => $response->token,);

                $ch = curl_init();
                curl_setopt($ch, CURLOPT_URL,$response->url."?nexturl=".urlencode($nexturl));
                curl_setopt($ch, CURLOPT_POST,1);
                curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
                $result=curl_exec ($ch);
                curl_close ($ch);
                echo $result;
                die(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T20:04:39.047

这是一个较老的问题，但我相信您现在可以使用 youtube API 上传视频：[https ://developers.google.com/youtube/v3/docs/videos/insert](https://developers.google.com/youtube/v3/docs/videos/insert)

# javascript - Flash Javascript 界面

> ID：13122084
> 
> 赞同：0
> 
> 时间：2012-10-29T12:55:00.547
> 
> 标签：javascript, actionscript-3, flash, actionscript

假设我有这个 javascript 函数：

```
 function updateMainBuff(buff) {
                // do some stuff
    } 
```

我的 Flash 项目中有这个功能（完整来源：[bitly.com/SnyhGT](http://bitly.com/SnyhGT)）：

```
protected function recordSampleDataHandler(event:SampleDataEvent):void
                    {       
                            while(event.data.bytesAvailable)
                            {       
                                    var sample:Number = event.data.readFloat();

                                    buffer.writeFloat(sample);
                                    if(buffer.length % 40000 == 0){
                                            triggerEvent('recordingProgress', recordingDuration(),  microphone.activityLevel);
                                    }       
                            }
                    } 
```

我需要做的是将每个`var sample`浮点数推送到 javascript 函数中`updateMainBuff`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:04:26.010

这应该这样做

```
ExternalInterface.call("updateMainBuff", sample); 
```

# ruby - 登录后如何使用机械化处理自动翻页？

> ID：13122086
> 
> 赞同：1
> 
> 时间：2012-10-29T12:55:02.543
> 
> 标签：ruby, mechanize

我在使用mechanize登录网站时遇到了一些问题。这是我的代码。

```
require 'rubygems'
require 'mechanize'

agent = Mechanize.new
page = agent.get("https://example.com/login")
login_form = page.forms.first
login_form.username = 'username'
login_form.password = 'password'
page = agent.submit(login_form)
pp page 
```

但是我发现登录后有一个翻页，当我使用浏览器时，它持续了大约 3 秒。所以它返回这样一个页面。

```
#<Mechanize::Page
 {url #<URI::HTTPS:0xb6c5e764 URL:https://example.com/takelogin.php>}
 {meta_refresh #<Mechanize::Page::MetaRefresh "" "index.php">}
 {title nil}
 {iframes}
 {frames}
 {links}
 {forms}> 
```

我想知道我能用它做什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:15:07.503

我认为您需要设置 Mechanize 以遵循元刷新：

```
agent.follow_meta_refresh = true 
```

# android - UNITY JNI android 插件 GetApplicationContext()

> ID：13122087
> 
> 赞同：3
> 
> 时间：2012-10-29T12:55:03.880
> 
> 标签：android, java-native-interface, unity3d

我正在使用 JNI 为 Unity Android 开发一个插件。我使用我的 Java 代码创建 .jar 文件，然后使用 c++ 桥创建 .so 文件。当我从 Unity 端调用我的库时，一切正常。所以，我的问题是，在我的 Java 代码的几个部分中，我需要访问主要活动 (UnityPlayer3d) 的上下文。我需要一个指向此活动的指针来调用函数 GetApplicationContext()。

我怎样才能获得这个指针？我考虑将 Unity 中的指针作为参数传递给我的 Java 类，但首先我必须在 Unity 端获取它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:12:27.107

下面是一些获取活动 JNI 样式的代码：

```
var unityPlayerClass = new AndroidJavaClass("com.unity3d.player.UnityPlayer");
var unityActivity = unityPlayerClass.GetStatic<AndroidJavaObject>("currentActivity"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-22T02:02:04.657

我认为您的逻辑是错误的，您不需要将 Context 指针从 Unity(C#) 传递给 Java，您可以在 Android Pluglin MainActivity 中获取 Context（这是您在帖子中提到的主要活动（UnityPlayer3d））直接作为跟随：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    context = this.getApplicationContext();
} 
```

然后，您可以在 JAVA 中操作上下文来做一些事情，而不是用 Unity(C#) 编写它，希望对您有所帮助。:)

# c# - SSLStream：“对 SSPI 的调用失败”异常

> ID：13122093
> 
> 赞同：3
> 
> 时间：2012-10-29T12:55:32.653
> 
> 标签：c#, mono, .net-2.0, sslstream, sspi

我有一个奇怪的问题：我在基于 .net2 的 c# 中编写了一个服务器和客户端，它们通过 .net 2 SslStream 聊天。Cl 和 S 之间有 1 个连接用于发送命令，cl 和 s 之间有一个用于发送文件的连接。
本地一切都在我的Windows机器上运行良好。但是，如果我在我的 Linux 服务器上运行服务器（使用单声道），则在某些情况下共享文件不起作用。我有不同的文件类别，在 3 个中的 2 个中，它的工作，在第三个中，服务器挂起`SSLStream.AuthenticateAsServer(....);`并且客户端抛出一个异常，并显示消息“对 SSPI 的调用失败，请参阅内部异常”。内部异常是 System.ComponentModel.Win32Exception，带有消息“收到的消息意外或格式错误。”

我认为我在 linux 上运行它的方式可能是错误的。实际上我使用 VS2012 进行本地开发，当我想把它放在服务器上时，我通过 VS 上传编译的 exe 并使用`mono server.exe`它来启动它。但是我也尝试在 Windows 上使用 monodevelop 来编译它（从 monodevelop 编译的东西也可以在本地工作）并在 linux 服务器上使用它，但这以相同的结果结束。

任何帮助将不胜感激。

这是我的缩短代码：

客户：

```
//gets auth guid before, then it does
Thread Thre = new Thread(sendfile);
Thre.Start(authguid);

private void sendfile(string guid){
TcpClient cl = new TcpClient();
cl.Connect(hostname, 8789);
SslStream Stream = new SslStream(cl.GetStream(), true, new RemoteCertificateValidationCallback(ServerConnector.ValidateServerCertificate));
Stream.AuthenticateAsClient(hostname);//throws the exception
//sends auth guid and file

} 
```

服务器：

```
 public class FServer
    {

        protected static bool halt = false;
        protected List<FConnection> connections;
        private TcpListener tcpServer;
        private IPEndPoint ipEnde = new IPEndPoint(IPAddress.Any, 8789);
        private delegate void dlgAccept();
        private dlgAccept accepting;
        private IAsyncResult resAccept;

        public FServer()
        {
            tcpServer = new TcpListener(ipEnde);
            connections = new List<FConnection>();
            tcpServer.Start();
            accepting = new dlgAccept(accept);
            resAccept = accepting.BeginInvoke(null, null);

        }

        public void accept()
        {
            do
            {
                if (tcpServer.Pending())
                    connections.Add(new FConnection(tcpServer.AcceptTcpClient(), this));

                else
                    Thread.Sleep(750);
            } while (!halt && tcpServer != null);
        }

        public class FConnection 
        {
           public SslStream stream;
            //.....some other properties

           public static bool ValidateClientCertificate (object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)
            {
                return true;

            }

            public FConnection(TcpClient cl, FServer inst)
            {
                instance = inst;
                client = cl;

                    stream = new SslStream(client.GetStream(), false, new RemoteCertificateValidationCallback(ValidateClientCertificate), null);
                    stream.AuthenticateAsServer(instance.mainserver.serverCert, false, SslProtocols.Tls, false);//hangs sometimes on this
                    if (stream.IsAuthenticated && stream.IsEncrypted)
                    {
                    }
                    else
                    {
                        this.Dispose();
                    }

                    //auth and receiving file

            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T14:55:53.167

好的，我对内部异常进行了更深入的研究，并在这里找到了解决方案：

[http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/18b4a0ce-b348-403d-8655-fe9d558f8d6b](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/18b4a0ce-b348-403d-8655-fe9d558f8d6b)

**功劳来自 MSDN的*paksys***

问题出在客户端，我改变了

```
Stream.AuthenticateAsClient(hostname); 
```

到

```
X509Certificates.X509Certificate2Collection xc = new X509Certificates.X509Certificate2Collection();
Stream.AuthenticateAsClient(hostname, xc, Security.Authentication.SslProtocols.Tls, false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-08T17:19:20.940

我只是遇到了同样的问题，接受的答案对我不起作用。问题是服务器证书使用的是 SHA-2。这是我用来修复它的代码：

```
X509Certificates.X509Certificate2Collection xc = new X509Certificates.X509Certificate2Collection();
Stream.AuthenticateAsClient(hostname, xc, Security.Authentication.SslProtocols.Tls12, false); 
```

*   请注意，与接受的答案的唯一区别是 sslProtocol

希望它可以帮助某人

# php - 无法从自定义 Symfony2 命令中发送电子邮件，但可以从应用程序的其他地方发送

> ID：13122096
> 
> 赞同：9
> 
> 时间：2012-10-29T12:55:34.600
> 
> 标签：php, symfony, swiftmailer

我编写了一个自定义控制台命令来查询我的数据库、生成报告并将其通过电子邮件发送到一个地址；但是我似乎无法成功发送电子邮件。我可以从应用程序中其他地方的普通控制器中正常发送电子邮件，如果我手动创建和配置 Swift_Mailer 实例而不是通过容器获取它，我也可以从控制台命令中发送它。

这是我的控制台命令的精简版本：

```
<?php

namespace Foo\ReportBundle\Command;

use Symfony\Bundle\FrameworkBundle\Command\ContainerAwareCommand;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;

class ExpiryCommand extends ContainerAwareCommand
{
    protected function configure()
    {
        $this->setName('report:expiry')
            ->setDescription('Compile and send e-mail listing imminent expiries');
    }

    protected function execute(InputInterface $input, OutputInterface $output)
    {
        /* ... */
        $message = \Swift_Message::newInstance()
            ->setSubject('Expiry report')
            ->setFrom('DoNotReply@domain.com')
            ->setTo('recipient@domain.com')
            ->setBody($body);

        $mailer = $this->getContainer()->get('mailer');

/*      This works...
        $transport = \Swift_SmtpTransport::newInstance('smtp.domain.com', 25)
            ->setUsername('username')
            ->setPassword('password');
        $mailer = \Swift_Mailer::newInstance($transport);
*/
        $result = $mailer->send($message);
        $output->writeln($result);
    }
} 
```

`app/config/config.yml`Swiftmailer 配置为通过我的文件中的SMTP 发送（`delivery_address: dev@domain.com`也在 中设置`app/config/config_dev.yml`）：

```
swiftmailer:
    transport: smtp
    host: smtp.domain.com
    username: username
    password: password
    spool:
        type: memory 
```

运行命令时，它会打印`1`到命令行，我认为这意味着它是成功的。但是我同时监控我的邮件服务器的日志，它甚至没有连接。

为了确认我的配置已加载到邮件程序中，我在运行命令时将假脱机从 更改`memory`为`file`并且消息正在假脱机到文件系统，并且我可以在命令行上使用`php app/console swiftmailer:spool:send`.

有没有人对这里发生的事情有任何想法，或者对如何进一步调试它有任何建议？我的`app/logs/dev.log`文件中没有任何内容。我正在使用 Symfony 2.1.3-DEV。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-29T14:10:34.203

通过挖掘一些 Symfony 和 SwiftMailer 代码，我可以看到内存假脱机`kernel.terminate`在响应发送后发生的事件上被刷新。我不确定它是否适用于命令，但我可能错了。

尝试在命令末尾添加此代码，看看是否有帮助：

```
$transport = $this->container->get('mailer')->getTransport();
if (!$transport instanceof \Swift_Transport_SpoolTransport) {
    return;
}

$spool = $transport->getSpool();
if (!$spool instanceof \Swift_MemorySpool) {
    return;
}

$spool->flushQueue($this->container->get('swiftmailer.transport.real')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:23:56.853

使用文件假脱机代替内存假脱机。修改你的`app/config/config.yml`：

```
swiftmailer:
    transport: "%mailer_transport%"
    host:      "%mailer_host%"
    username:  "%mailer_user%"
    password:  "%mailer_password%"
    spool:     { type: file, path: %kernel.root_dir%/spool } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-21T13:12:32.330

只需将其添加到执行操作的末尾：

```
$container = $this->getContainer();
$mailer = $container->get('mailer'); 
$spool = $mailer->getTransport()->getSpool();    
$transport = $container->get('swiftmailer.transport.real');
$spool->flushQueue($transport); 
```

# jquery - 如何设置一个不显眼的验证组？

> ID：13122097
> 
> 赞同：1
> 
> 时间：2012-10-29T12:55:35.540
> 
> 标签：jquery, asp.net-mvc, unobtrusive-validation

我创建了一个 MVC 4 验证属性，它将比较代表年份范围的 2 个字段，以验证结束年份不在开始年份之前。

我创建了以下 JS：

```
jQuery.validator.unobtrusive.adapters.add(
        'yearrange', ['startyear', 'endyear'], function (options) {
            options.rules['yearrange'] = options.params;
            options.messages['yearrange'] = options.message;        
        }
    );

jQuery.validator.addMethod(
            'yearrange', function (value, element, params) {

                var startYearElementName = params.startyear;
                var endYearElementName = params.endyear;

                var startYear = $('#' + startYearElementName).val();
                var endYear = $('#' + endYearElementName).val();

                if (startYear == '' || endYear == '') {
                    return true;
                }

                return (+startYear <= +endYear);

            }, ''); 
```

我将验证属性应用于我的 ViewModel 中的两个属性：

```
[YearRange("StartYear", "EndYear", "yearRangeInvalid")]
public int StartYear { get; set; }

[YearRange("StartYear", "EndYear", "yearRangeInvalid")]
public int EndYear { get; set; } 
```

我不想使用摘要验证消息。

当一个字段被更改时，我可以使用验证组来触发两个字段的重新验证吗？

并且可以在上面的 adapters.add 回调中配置吗？

我没有成功地尝试过类似的东西：

```
jQuery.validator.unobtrusive.adapters.add(
        'yearrange', ['startyear', 'endyear'], function (options) {
            options.rules['yearrange'] = options.params;
            options.messages['yearrange'] = options.message;

            jQuery.validator.groups[options.params.startyear] = "yearrange";
            jQuery.validator.groups[options.params.endyear] = "yearrange";

        }
    ); 
```

# javascript - 每次创建新的选择选项

> ID：13122099
> 
> 赞同：0
> 
> 时间：2012-10-29T12:55:38.957
> 
> 标签：javascript, json

我想每次在通过以下行创建 JSON 的选项列表中重置新值：

```
var o=document.createElement("option");
document.getElementById("shipTo").options.add(o); 
o.text= address[i]; 
```

但是新的选项值被添加到列表中，我希望选项中没有前面的：

```
var counter;
function GetAddress() {
    var customerId = document.getElementById("invoiceTo").value;
    var xml;
    if (window.XMLHttpRequest) {
        xml = new XMLHttpRequest();
    } else {
        xml = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xml.onreadystatechange = function() {
        if (xml.readyState == 4 && xml.status == 200) {
            var address = JSON.parse(xml.responseText);
            document.getElementById("billingAddress").value = address[0];
            document.getElementById("shipAddress").value = address[0];
            if (counter == 1) { {
                    for (var i = 0; i < address.length; i++) {
                        var removeMe = document.getElementById(o[i]);
                        removeMe.parentNode.removeChild(removeMe);
                        var o = document.createElement("option");
                        document.getElementById("shipTo").options.add(o);
                        o.text = address[i];
                    }
                }
            } else if (counter != 1) {
                for (var i = 0; i < address.length; i++) {
                    var o = document.createElement("option");
                    document.getElementById("shipTo").options.add(o);
                    o.text = address[i];
                }
            }
            counter = 1;
        }
        alert(counter);
    }
    xml.open("GET", "GenerateInvoice?customerId=" + customerId, true);
    xml.send();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:02:54.883

您需要先清除选项：

```
var oDDL = document.getElementById("shipTo");
while (oDDL.options.length > 0)
    oDDL.options.remove(0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T10:14:52.543

```
function GetAddress()
{
var customerId = document.getElementById("invoiceTo").value;
var xml;
if (window.XMLHttpRequest)
{
xml=new XMLHttpRequest();
}
else
{
xml=new ActiveXObject("Microsoft.XMLHTTP");
}
xml.onreadystatechange= function()
{
if(xml.readyState==4 && xml.status==200)
{
var address= JSON.parse(xml.responseText);
document.getElementById("billingAddress").value=address[0];
document.getElementById("shipAddress").value= address[0];
var oDDL = document.getElementById("shipTo");//ship to id of the select in jsp
while (oDDL.options.length > 0)
{
oDDL.options.remove(0);//clears selects option each time
}
for(var i=0;i<address.length;i++)
{
var o = document.createElement("option");//creates optin
document.getElementById("shipTo").options.add(o);//adds option in the list
o.text= address[i];//inserts text in the option
}
}
}
xml.open("GET","GenerateInvoice?customerId="+customerId,true);
xml.send();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:20:11.197

如果我理解正确，您想在添加新选项之前从选择元素中清除所有旧选项。

只需设置 options.length = 0;

例子：

```
 var o = document.createElement("option");
 theSelect.options.length = 0;
 o.text = '400';                    
 theSelect.options.add(o); 
```

[http://jsfiddle.net/asaf/77sqX/4/](http://jsfiddle.net/asaf/77sqX/4/)

# c# - 我可以在这个片段中以某种方式用 using 块替换 Initialize() 和 Close() 方法调用吗？

> ID：13122102
> 
> 赞同：0
> 
> 时间：2012-10-29T12:55:44.120
> 
> 标签：c#, .net, idisposable, streamwriter, using-statement

您是否可以建议帮助摆脱调用 Initialize() 和 Close() 方法并将其替换为 using 块？

还是这种方法完全可以？

（想法是确保当 FooWriter 的消费者写入一些字符串并以此结束时，Writer 将被释放。）

```
class Program
    {
        static void Main(string[] args)
        {
            var writer  = new FooWriter();

            writer.Initialize();

            foreach (var s in args)
                writer.Write(s);

            writer.Cose();
    }

public class FooWriter
{

    public StreamWriter Writer;

    public void Initialize()
    {
        Writer = new StreamWriter("MyFile.txt", false);
    }

    public void Write(string line)
    {
        if(Writer==null)
            throw new NullReferenceException(Writer, "Writer"); // Guard Writer

        Writer.WriteLine(line);
    }

    public void Close()
    {
        Writer.Dispose();
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T12:59:11.957

您可以通过制作`FooWriter`一个`IDisposable`. 并将初始化移动到其构造函数中：

```
public class FooWriter : IDisposable {

    public StreamWriter Writer;

    public FooWriter()
    {
        Writer = new StreamWriter("MyFile.txt", false);
    }

    public void Write(string line)
    {
        // You do not need to guard the writer, because constructor sets it
        if(Writer==null)
            throw new NullReferenceException(Writer, "Writer"); // Guard Writer

        Writer.WriteLine(line);
    }

    public void Dispose()
    {
        Writer.Dispose();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:01:44.850

你可以让 FooWriter 实现 IDisposable 并在构造函数中调用 Initialize() ，然后你可以使用 at 如下：

```
class FooWriter : IDisposable
{
   private StreamWriter Writer;
   public FooWriter()
   {
      Writer = new StreamWriter("MyFile.txt", false);
   }
   public void Write(string line)
   {
     Writer.WriteLine(line);
   }
   public void Dispose()
   {
        Writer.Dispose();
   }
}

// use it

using (var writer = new FooWriter())
{
  foreach (var s in args)
                writer.Write(s);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:02:55.087

我会像这样改变你的实现：

*   使类实现 IDisposable
*   在构造函数中初始化编写器
*   删除异常

    公共类 FooWriter : IDisposable { public StreamWriter Writer { get; 私人套装；}

    ```
    public FooWriter(string fileName)
    {
        Writer = new StreamWriter(fileName, false);
    }

    public void Write(string line)
    {                        
        Writer.WriteLine(line);
    }      

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposeManaged)
    {
        if (disposeManaged)
            Writer.Dispose();
    } 
    ```

    }

# php - 云端签名的 urls ip 地址

> ID：13122105
> 
> 赞同：6
> 
> 时间：2012-10-29T12:55:50.547
> 
> 标签：php, json, amazon-s3, amazon-web-services, amazon-cloudfront

我在 Cloudfront 上的签名 URL 在 PHP 中运行良好。存储桶策略适用于 S3 上的 HTTP 引荐来源网址，但由于 Cloudfront 不支持 HTTP 引荐来源网址检查，我只需将文件提供给一个 IP 地址（理想情况下是请求文件并生成签名 URL 的客户端或我的 Web 服务器）。

有人可以帮我将 IP 地址元素添加到 JSON 代码中以使其正常工作吗？

```
"IpAddress":{"AWS:SourceIp":"192.0.2.0/24"}, 
```

我迷失了 PHP 和政策声明，但认为对于知道的人来说可能很容易：http: [//tinyurl.com/9czr5lp](http://tinyurl.com/9czr5lp)

它对自定义策略的编码/签名略有不同：http: [//docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/private-content-creating-signed-url-custom-policy.html#private-content-custom -政策声明](http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/private-content-creating-signed-url-custom-policy.html#private-content-custom-policy-statement)

下面是一个 AWS 示例，除了 IP 地址锁定无效。

如果有人可以请帮我两分钟，我可以很快测试这个！

非常感谢您的帮助:)

乔恩

```
 function getSignedURL($resource, $timeout)
    {
        $keyPairId = "XXXXXXXXXXXX";
        $expires = time() + $timeout;
        $json = '{"Statement":[{"Resource":"'.$resource.'","Condition":{"DateLessThan":     {"AWS:EpochTime":'.$expires.'}}}]}';
        $fp=fopen("pk-XXXXXXXX.pem","r");

        $priv_key=fread($fp,8192);
        fclose($fp);

        $key = openssl_get_privatekey($priv_key);
        if(!$key)
        {
                echo "<p>Failed to load private key!</p>";
                return;
        }

        //Sign the policy with the private key

        if(!openssl_sign($json, $signed_policy, $key, OPENSSL_ALGO_SHA1))
        {
                echo '<p>Failed to sign policy: '.openssl_error_string().'</p>';
                return;
        }
        //Create url safe signed policy
        $base64_signed_policy = base64_encode($signed_policy);
        $signature = str_replace(array('+','=','/'), array('-','_','~'), $base64_signed_policy);
        //Construct the URL
        $url = $resource.'?Expires='.$expires.'&Signature='.$signature.'&Key-Pair-Id='.$keyPairId;
        return $url;
}
$url = getSignedURL("http://s675765.cloudfront.net/filename.mp4", 600);
print $url; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:48:09.497

```
{"Statement":[{"Resource":"testRes","Condition":{"DateLessThan":{"AWS:EpochTime":1357034400},"IpAddress":{"AWS:SourceIp":"192.0.2.0\/24"}}}]} 
```

这是一个包含填充值和转义值的有效 JSON 字符串。如果您将 IP 地址作为变量传递，请确保您转义`/`

例如

```
$escapedIp = str_replace( '/', '\/', $ipAddress ); 
```

看看 php json extension 这会让事情变得更容易：

示例语句作为 php 数组

```
$statement = array( 
    'Statement' => array( 
        array(
            'Resource' => $resource, 
            'Condition' => array( 
                'DateLessThan' => array( 
                    'AWS:EpochTime' => $expires 
                ),
                'IpAddress' => array( 
                    'AWS:SourceIp' => $ipAddress 
                ) 
            ) 
        )
    ) 
);

$json = json_encode( $statement ); 
```

# ios - ShareKit -facebook 错误 - 链接必须具有“href”和“文本”属性

> ID：13122106
> 
> 赞同：0
> 
> 时间：2012-10-29T12:55:55.817
> 
> 标签：ios, facebook, cocoa, fbconnect, sharekit

我在 WebView 中收到以下错误：

标题：

> **发布到墙上**

身体：

> **操作链接必须具有字符串“href”和“文本”属性”**

其他按钮（导航）：

> **好的**

上下文：ShareKit build 134529c，FBConnect 已插入。我正在尝试将 url (http://www.google.com) 发布到我的墙上。

身份验证没问题，url 不为零。我想我应该在某处添加这些属性，但我不想修改 FBConnect 类。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:16:03.477

问题是我在 myDefaultSHKConfigurator 中将 appURL 留空。应该有一些东西来指示哪些字段是**强制性**的......

```
- (NSString*)appURL {
    return @""; //wrong
} 
```

代替

```
- (NSString*)appURL {
    return @"http://www.google.com"; //OK
} 
```

我把问题留在这里，也许有一天有人会遇到它。

# ruby-on-rails - 错误命令：heroku 运行 rake db:migrate

> ID：13122108
> 
> 赞同：0
> 
> 时间：2012-10-29T12:56:07.780
> 
> 标签：ruby-on-rails, heroku, web, migration, production

我有一个使用 rails 3.2.8 和 MySQL 的简单应用程序正在开发中，当我尝试使用此命令 > heroku run rake db:migrate 我有这个错误： **PG::Error: ERROR: column "name" of relationship "users"已经存在：ALTER TABLE“用户”添加列“名称”字符变化（255）**

这是我的 schema.rb

[http://pastie.org/5132185](http://pastie.org/5132185)

我不知道该怎么做，以解决此错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:21:12.073

Heroku 仅使用 PostgreSql，因此您必须将 gemfile 从 mysql 更改为 PG，或者仅将 mysql 用于测试/本地和 PG 用于生产

```
gem 'PG' :group => :production 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T15:09:21.763

您在 Gemfile 中正确设置了生产数据库：

```
group :production do
  gem 'pg'
end 
```

但是由于第 14 行，您还可以将 gem 包含在所有环境中：

```
gem 'pg' 
```

您应该指定 mysql 是仅用于开发/测试的 gem：

```
group :development, :test do
  gem 'mysql'
end 
```

至于您的错误，听起来用户表中已经存在列名。另一个迁移是否添加了该列？

# java - 使用自定义标签包装 spring mvc 选择标签时出现 IllegalStateException

> ID：13122115
> 
> 赞同：0
> 
> 时间：2012-10-29T12:56:32.057
> 
> 标签：java, jsp, spring-mvc, jsp-tags

**基本问题**
我在编写自己的自定义 JSP 标记以“包装”spring MVC 表单标记时遇到了一些问题。我已经成功地包装了其他标签，但与 select 和 options 标签分离，这会引发 IllegalStateException。我调试了spring代码，发现options标签寻找祖先选择标签。我正在使用标签文件执行此操作，因此弹簧选择标签实际上位于不同的标签文件中。我想这就是它找不到它的原因。

所以问题是我能做些什么来解决这个问题？

**可能的解决方案**
我尝试寻找解决方案，但我发现的只是其他人有同样的问题但没有发布解决方案。我确实考虑过在不使用弹簧标签的情况下编写自己的选择和选项标签，但我真的不想复制它免费提供的绑定。我不介意更改为使用 Java 类而不是标记文件，但我之前发现输出不会被评估为 JSP，因此您无法输出另一个 JSP 标记。

**这样做的原因**
自从第一次提出这个问题以来，我已经考虑了一周，现在我更清楚我想要实现的目标。

*   为了简化我的 JSP 中所需的标记
*   分解出通用代码（例如输入后的表单：错误或从 spring:message 获取翻译）
*   封装外观和感觉（CSS 有很长的路要走，但通常你也需要更改标记）
*   能够构建扩展弹簧标签功能的增强组件（例如，将多选呈现为选项列表或将只读输入显示为文本标签）

我很想听听人们的想法。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T23:05:22.030

首先，我不确定您想要控制样式是什么意思。我认为您可以将 class 和 id 属性传递给 Spring 标签，然后通过它们复制它们（？-尽管我可能对 Grail 标签感到困惑，因为我最近一直在编写 Grails 应用程序）。编辑：另外，您可以通过引用外部元素来设置 Spring 生成的标签的样式。例如，用 div 包围您的表单元素，然后设置表单元素的样式，例如：`#myDiv input { color: red; }`.

根据我的经验（10 多年的 webapp 开发），不值得付出额外的努力来尝试和未来证明您的应用程序。当您选择像 Spring MVC 这样的框架时，您会免费获得很多东西，而这些东西通常需要您自己编写。这些免费东西的成本是一定数量的锁定（如你所说）。Spring 在这方面非常好——您可以根据需要使用尽可能少或尽可能多的资源，如果将来需要，它通常可以直接进行设计。

所以我的看法是：“按原样”使用 Spring 标签。您将来需要删除 Spring 方面的可能性非常小。因此，如果/直到这种情况出现，“推迟”是值得的风险。您可能已经花费了尽可能多的时间和代码来尝试设计面向未来的解决方案，就像您花费在删除 Spring 标记上的一样——它超过了它可能提供的任何好处。此外，**您已经**编写了该代码，而您和/或其他人现在必须维护该代码，而不是让 Spring 开发人员为您维护代码。

最后，如果您真的不想锁定并希望完全控制样式，那么请手动编写表单元素。

```
<select name="foo_select">
    <option value="">-- select a foo type --</option>
    <c:forEach var="foo" items="${fooGroups}">
        <option value="${foo}">${foo}</option>
    </c:forEach>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T16:08:07.430

我已经考虑了一个很好的一周，这是入围名单：

*   放弃并直接使用我的JSP中的spring标签
*   根本不要使用弹簧标签，并在我自己的标签中复制它们的逻辑
*   可能写一个标签类，扩展或利用spring标签类
*   扩展我的标签范围以包装选择和选项标签

鉴于想要这样做的原因（我现在已经在问题中澄清了），我决定选择最后一个选项。我最初并不热衷于此，因为我认为我最终可能会得到数百个参数，但实际上并不算太糟糕。标签文件是为包装常见的标记位而设计的，所以这就是它们的用途。我还进一步包装了我自己的标签，所以有一个选择列表标签，它输出我的自定义选择标签，然后编写初始化它所需的 JS。

根据我想要实现的目标，我认为这是我遇到的最好的解决方案。这就是我要解决的问题，但如果他们认为他们有更好的解决方案，我仍然很想听听其他人的解决方案。

# php - 在非 wordpress php 页面之外显示 wordpress 帖子

> ID：13122116
> 
> 赞同：2
> 
> 时间：2012-10-29T12:56:34.753
> 
> 标签：php, wordpress

我需要在非 wordpress php 页面中显示 wordpress 博客文章。我已经尝试了以下代码。

```
<?php
// Include WordPress
define('WP_USE_THEMES', false);
//exact path for wp-load.php.
// This file is kept in the root of wordpress install
require('http://test.com/wordpress/blog/wp-load.php');
//Query wordpress for latest 4 posts
query_posts('showposts=5');
?>
<?php while (have_posts ()): the_post(); ?>
    <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
<?php the_excerpt(); ?>

<?php endwhile; ?> 
```

但它向我显示了以下错误

```
Fatal error: Call to undefined function query_posts() 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:32:46.003

请查看您的代码中的以下行

```
require('http://test.com/wordpress/blog/wp-load.php'); 
```

在 require 函数中，您应该使用相对或物理路径。您不应该包含网址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:11:29.750

由于您需要 wordpress 数据库和框架，这似乎根本不可能工作。尝试从您的 wordpress 中获取 XML、RSS 或 JSON 数据，您可以使用自制脚本获取这些数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:36:50.277

对于外部集成，通过 RSS 路由进行处理可能更可靠。完成这项工作的最简单也可能是最懒惰的方法是使用**simplexml_load_file**（和 HTTP 流）。

```
$t = simplexml_load_file( "http://blogs.voanews.com/breaking-news/feed/" );

foreach( $t->channel->item as $item ) {
    printf(
        "<div>%s <a href='%s'>%s</a></div><hr/>",
        $item->description,
        $item->link,
        $item->title
    );
} 
```

这会输出您希望看到的提要。请注意，这不使用任何类型的缓存，因此每个页面请求都会命中原始提要。

```
<div>Some Chinese officials are furious at Apple's iPhone for apparently 
helping users have too much of a good time. Chinese media say the complaints
surround the iPhone's voice-activated personal assistant, known as
&#8220;Siri,&#8221; which has been helping some users find prostitutes and
brothels. The Mandarin language version can apparently present users with as
many as [...] <a href='...(snip)...)'>iPhone Under Fire in China over
Prostitution</a></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:14:33.653

您可以使用 rss 选项，您可以编写一个新的隐藏代码并使用该文件读取数据...以 JSON 格式

也许要做的第一件事是搜索为您执行此操作的扩展/插件/模块；

我认为您不是第一个想要这样做的人：p

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-07T19:07:09.157

包含 wp-load.php 后，您必须像这样实例化查询：

```
$wp_query = new \WP_Query();
$wp_query->query('showposts=5'); 
```

之后，您的循环应如下所示：

```
<?php while ($wp_query->have_posts()) :
    $wp_query->the_post();
    <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
    <?php the_excerpt(); ?>

<?php endwhile; ?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-27T11:28:06.173

要在 wordpress 设置之外显示最近的帖子，首先包含 wp-load.php 文件。

```
require( './blog/wp-load.php' );
    // Load the recent top 10 posts
    $args = array( 'posts_per_page' => 10, 'post_status'=>"any", 'post_type'=>"post", 'orderby'=>"date","order"=> "DESC", "suppress_filters"=>true);
    $postslist = get_posts( $args ); 
```

现在您可以循环访问 $postlist 变量。

```
foreach ($postslist as $post) : setup_postdata($post);?> 
      <ul class="media-list">
        <li class="media">
          <div class="media-left"> <?php the_post_thumbnail( array(80,80));?> </div>
          <div class="media-body">
            <a target="_blank" href="<?php the_permalink();?>"><h5 class="media-heading"><?php the_title(); ?></h5></a>
            <p><?php echo $post->post_content; ?></p>
          </div>
        </li>
      </ul>

<?php endforeach; 
```

# c# - 如何在 IHttpModule 中以 404 结束请求？

> ID：13122124
> 
> 赞同：1
> 
> 时间：2012-10-29T12:56:51.327
> 
> 标签：c#, asp.net, httpmodule

我正在写一个新的 IHttpModule。我想使用`BeginRequest`事件处理程序使某些带有 404 的请求无效。如何终止请求并返回 404？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T14:41:35.193

您可以将状态代码显式设置为 404，例如：

```
HttpContext.Current.Response.StatusCode = 404; 
HttpContext.Current.Response.End(); 
```

响应将停止执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:26:16.523

你可以试试

```
throw new HttpException(404, "File Not Found"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-26T15:44:31.843

另一种可能是：

```
HttpContext.Current.Response.StatusCode = 404; 
HttpContext.Current.Response.Flush(); // Sends all currently buffered output to the client.
HttpContext.Current.Response.SuppressContent = true;  // Gets or sets a value indicating whether to send HTTP content to the client.
HttpContext.Current.ApplicationInstance.CompleteRequest(); // Causes ASP.NET to bypass all events and filtering in the HTTP pipeline chain of execution and directly execute the EndRequest event. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T14:38:03.203

您可以执行以下操作：

```
HttpContext.Current.Response.Clear();
HttpContext.Current.Response.AddHeader("Location", l_notFoundPageUrl);
HttpContext.Current.Response.Status = "404 Not Found";
HttpContext.Current.Response.End(); 
```

将 l_notFoundPageUrl 分配给您的 404 页面。

# apache - 使用 WAMP / Joomla “禁用”文件夹

> ID：13122125
> 
> 赞同：0
> 
> 时间：2012-10-29T12:56:57.707
> 
> 标签：apache, joomla, wamp

我很好奇 WAMP + Joomla 的功能......

在我的项目文件夹和 /www/ 内，我有几个可访问的 Joomla 文件夹（里面的功能可用）但是当直接从 Web 浏览器打开时不显示任何内容（但不显示错误消息）......这是一种行为我想让其他文件夹有，但我似乎无法得到它！

如果在 Web 浏览器中打开一个名为“CLI”的文件夹，让我进一步解释一下：

.../成分

返回一个空白屏幕...但是我的一些模块正在使用其中的内容，因此文件夹不受限制，但通过 Web 浏览器看不到内容。

现在我有另一个文件夹：

.../客户

我需要以与我网站的许多模块需要的相同的方式运行，但我不能让它对用户“开放”（如果有人在他们的网络浏览器上输入“.../clients”，我需要输出为空白，与上面的 .../components 文件夹相同）。目前，如果有人在网络浏览器上输入 .../clients，他们可以看到其中的所有文件，这对我来说是一个严重的安全错误。

我已经通过在 httpd.conf 中执行 DENY FROM ALL 成功禁用了它们。但是，这是无效的，因为它绝对限制了文件夹中的所有内容，导致我的模块崩溃。

希望你明白这一点，如果没有，很高兴澄清:)

非常感谢您的支持！！！

PS - 如果可能，请以虚拟的方式回答，因为我对所有这些 Apache 的东西都是新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:48:46.807

Joomla 返回空白屏幕的方式是在其中添加一个空白 index.html 文件。浏览器优先显示 index.html 文件以显示 index.php 文件等。因此，将 index.html 文件放入包含以下内容的子文件夹中：

```
<html>
  <body bgcolor="#FFFFFF">
  </body>
</html> 
```

# css - 填充+宽度

> ID：13122126
> 
> 赞同：0
> 
> 时间：2012-10-29T12:57:01.287
> 
> 标签：css

我有底部边框的链接，在 CSS 中是这样的：

```
a {
    display: block;
    width: 100%;
    padding-top: 8px;
    padding-bottom: 8px;
    padding-left: 30px;
    border-bottom: 1px solid #EEE;
} 
```

我有问题，因为“填充”值被添加​​到宽度值并且边框底部太长：

[http://screenshooter.net/9186066/advygxa](http://screenshooter.net/9186066/advygxa)

你有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:01:18.517

padding 和 width 很难共存；只需删除您的宽度声明。由于你的锚是块状的，它们会自动占据 100% 的宽度（包括填充）：

```
a {
    display: block;
    padding-top: 8px;
    padding-bottom: 8px;
    padding-left: 30px;
    border-bottom: 1px solid #EEE;
} 
```

现在它应该占据 100% 的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:05:23.023

将此添加到包含链接的 div 中。

```
overflow-x:hidden; 
```

演示：http: [//jsfiddle.net/calder12/zXmG3/](http://jsfiddle.net/calder12/zXmG3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:08:07.187

它工作正常，检查[http://jsfiddle.net/GjMQe/](http://jsfiddle.net/GjMQe/)

```
a {
display: block;
width: 100%;
padding-top: 8px;
padding-bottom: 8px;
padding-left: 30px;
border-bottom: 1px solid #EEE; 
```

}​</p>

也许您忘记在模板中包含 reset.css 文件。

检查[Normalize.css](http://necolas.github.com/normalize.css/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:00:01.423

这就是填充的作用。看看布局模型是如何工作的：相应地调整。如果您正在寻找一个灵活的解决方案，那么您需要从`a`元素中移除填充并添加类似内部的东西，该内部`span`具有适当的边距，`a`并且其他刻度盘也相应地进行了调整。

# java - 如何获取非最终 ArrayList 的元素？

> ID：13122128
> 
> 赞同：0
> 
> 时间：2012-10-29T12:57:08.450
> 
> 标签：java, android, arraylist, final

我有一个类角色：

```
String name;
Int age; 
```

我有一个`ArrayList<Persona>`，然后

我用一个 for 循环填充 ArrayList，该循环`add(new Persona(name,age))`使用 JSON 解析数据（这个 JSON 解析是从 PHP 请求到 MySQL DB，它返回随机数的“Persona”）。

当循环结束时，我想获得这个 Persona 之一，但 Eclipse IDE 对我说，要使用`get(i)`我必须声明 ArrayList 之类`final`的，如果这样做，我无法填充它。

这是代码：

```
ArrayList<Persona> personas = new ArrayList<Persona>();
JSONParser jParser = new JSONParser();
JSONObject json = jParser.getJSONFromUrl(url);

try {
    personas = json.getJSONArray(TAG);
    for(int i = 0; i < putas.length(); i++) {
        JSONObject c = personas.getJSONObject(i);
        String name = c.getString(TAG_NAME);
        Int age = c.getString(TAG_AGE);
        personas.add(new Persona(name, age));
} catch (...) {
    ...
}

int i = 4;
Persona p = personas.get(i); 
```

使用此代码，IDE 向我显示一个错误并“提议”我将“final”修饰符添加到 ArrayList，但这很荒谬。

PD：问题出在 Android 应用程序上，但我认为这是 Java 问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:03:58.467

[`final`与 C++ 不同`const`](https://stackoverflow.com/questions/4971286/javas-final-vs-cs-const)。声明`personas`为`final`引用并不会阻止您更改引用所引用的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:02:22.093

尝试在 try 块中初始化数组 List ...

```
 ArrayList<Persona> personas;
 JSONParser jParser;
 JSONObject json;
 try
 {
   personas = new ArrayList<Persona>();
   jParser = new JSONParser();
   json = jParser.getJSONFromUrl(url);

   // rest of the code
 }
 catch(Exception e){} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:11:59.070

除非你在那里编译，否则它应该没有理由无法编译`final`。你一定错过了什么。

无论哪种方式，`final`关键字只是意味着您不能再为该字段分配某些内容，而不是您不能调用它的方法。

你是对的，如果你做了，`personas` `final`那么你的代码将无法工作，因为`personas = json.getJSONArray(TAG)`不会被允许。

由于您在编译时收到关于非最终版本的抱怨，我假设您实际上在此之后有一些代码，它使用`personas`. 如果您尝试在这样的内部使用它：

`Runnable r = new Runnable() { public void run() { personas.get(0); } };`

您可能正在为`View`听众或其他东西做这件事。

那，将要求您将其定为最终版本。最简单的解决方案就是制作另一个局部变量，并将其设为最终变量。

`final ArrayList<Persona> finalPersonas = personas`

# php - Symfony getter 和 setter 生成 - 如何忽略一个属性

> ID：13122129
> 
> 赞同：2
> 
> 时间：2012-10-29T12:57:10.820
> 
> 标签：php, symfony, doctrine

使用 Symfony2.0，我知道如何使用命令`doctrine:generate:entities`生成 getter 和 setter。

问题：是否有任何注释、参数等使命令忽略某些我不需要方法的属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:57:46.953

不[，生成器](http://symfony.com/doc/current/book/doctrine.html#generating-getters-and-setters)是用来快速启动的——而不是用来完成你的编码工作。因此，生成一个实体，然后删除您不需要的任何内容。

# java - 如何将 jPCT 与 Vuforia SDK 一起使用？

> ID：13122131
> 
> 赞同：3
> 
> 时间：2012-10-29T12:57:18.280
> 
> 标签：java, android, opengl-es, rendering, qcar-sdk

有人可以概述混合 Jpct 和 Qualcomm Vuforia SDK 吗？将 Java 渲染引擎与 Vuforia 一起使用是个好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:19:19.407

基本上，QCAR 的整个过程是计算变形的预定义目标图像的变换矩阵。它为您提供了两个重要的 4x4 矩阵，您可以使用 OpenGL 来叠加您的图形。

*   **模型视图**矩阵
*   **投影**矩阵

如果您熟悉 OpenGL，则这两个足以用于渲染目的。但是，如果您想使用**jPCT 之**类的渲染引擎，请使用带有**相机**的 ModelView 矩阵并从 Projection 矩阵中提取**FOV 。**查看 ImageTarget 示例应用程序，您将了解必须更改代码的哪一部分。

更不用说，您还应该从本机代码中注释掉不必要的渲染代码。由于 jPCT 是基于 Java 的，因此您需要将矩阵从本机代码传递到 Java，这是一项 JNI 任务。否则，您可以使用基于 C++ 的引擎（如*Ogre3D*或*OpenFramework*）来呈现本机代码。

如果您遇到问题，请回来询问更多。

# android - 录制时拍摄相机截图 - 就像在 Galaxy S3 中一样？

> ID：13122134
> 
> 赞同：3
> 
> 时间：2012-10-29T12:57:24.313
> 
> 标签：android, video, camera, surfaceview

我正在开发一个使用 SurfaceView 进行显示的相机应用程序。

我可以
使用 getDrawingCache() （在包装 SurfaceView 的布局上）
以及 canvas.drawBitmap(...) 截取 SurfaceView 的屏幕截图（并将其保存为位图）

但是在这两种方式中，位图始终是透明/空白的。

我有 Galaxy S3，我可以看到他们的相机中有这个功能，他们是如何做到的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T16:54:46.297

几个小时后，我得到了一个很好的解决方案。
也许这不是最好的方法，但对我来说已经足够了。

```
private long start;
private long end;
private long period; 
```

首先在媒体记录器启动后立即获取开始时间：

```
private void startRecording()
{
   mMediaRecoder.start();
   start = System.currentTimeMillis();
} 
```

然后，当您按下屏幕/按钮进行截图时，保存期间：

```
private void captureImage()
{
   end = System.currentTimeMillis();
   period = end - start;
} 
```

最后，当您停止录制时，使用句点和媒体检索器获取位图：

```
private void saveVideo()
{
   MediaMetadataRetriever retriever = new MediaMetadataRetriever();
   //path -> the path to the video
   retriever.setDataSource(path);
   Bitmap bitmap = retriever.getFrameAtTime(period * 1000,MediaMetadataRetriever.OPTION_CLOSEST);
} 
```

希望对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:04:05.863

没有为表面视图维护缓存。这就是您无法获取缓存位图的原因。实际上，当任何视图被渲染并且它的缓存被打开时，视图位图被渲染时，系统不会进行数学计算来绘制以提高视图的渲染效率。

# python - 如何在 Bash 脚本中激活 virtualenv

> ID：13122137
> 
> 赞同：144
> 
> 时间：2012-10-29T12:57:30.547
> 
> 标签：python, bash, virtualenv

如何创建 Bash 脚本来激活 Python virtualenv？

我有一个目录结构，如：

```
.env
    bin
        activate
        ...other virtualenv files...
src
    shell.sh
    ...my code... 
```

我可以通过以下方式激活我的 virtualenv：

```
user@localhost:src$ . ../.env/bin/activate
(.env)user@localhost:src$ 
```

但是，从 Bash 脚本中执行相同操作不会执行任何操作：

```
user@localhost:src$ cat shell.sh
#!/bin/bash
. ../.env/bin/activate
user@localhost:src$ ./shell.sh
user@localhost:src$ 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-10-29T13:02:45.787

当您获取资源时，您正在将激活脚本加载到您的活动 shell 中。

当您在脚本中执行此操作时，您将其加载到该 shell 中，该 shell 在您的脚本完成时退出并且您返回到原始的未激活 shell。

您最好的选择是在函数中执行此操作

```
activate () {
  . ../.env/bin/activate
} 
```

或别名

```
alias activate=". ../.env/bin/activate" 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2016-02-02T14:53:54.733

您应该使用源代码调用 bash 脚本。

这是一个例子：

```
#!/bin/bash
# Let's call this script venv.sh
source "<absolute_path_recommended_here>/.env/bin/activate" 
```

在你的 shell 上就这样称呼它：

```
> source venv.sh 
```

或者正如@outmind 建议的那样：（请注意，这不适用于 zsh）

```
> . venv.sh 
```

好了，shell 指示将放置在您的提示符上。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-10-29T14:46:36.390

虽然它没有在 shell 提示符中添加“(.env)”前缀，但我发现这个脚本可以按预期工作。

```
#!/bin/bash
script_dir=`dirname $0`
cd $script_dir
/bin/bash -c ". ../.env/bin/activate; exec /bin/bash -i" 
```

例如

```
user@localhost:~/src$ which pip
/usr/local/bin/pip
user@localhost:~/src$ which python
/usr/bin/python
user@localhost:~/src$ ./shell
user@localhost:~/src$ which pip
~/.env/bin/pip
user@localhost:~/src$ which python
~/.env/bin/python
user@localhost:~/src$ exit
exit 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-10-29T13:04:41.043

Sourcing 在您当前的 shell 中运行 shell 命令。当您像上面那样在脚本内部获取源时，您正在影响该脚本的环境，但是当脚本退出时，环境更改将被撤消，因为它们实际上已经超出了范围。

如果您的意图是在 virtualenv 中运行 shell 命令，您可以在获取激活脚本后在脚本中执行此操作。如果您的意图是与 virtualenv 中的 shell 交互，那么您可以在脚本中生成一个继承环境的子 shell。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-06-24T19:01:23.940

这是我经常使用的脚本。运行它`$ source script_name`

```
#!/bin/bash -x
PWD=`pwd`
/usr/local/bin/virtualenv --python=python3 venv
echo $PWD
activate () {
    . $PWD/venv/bin/activate
}

activate 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-06-13T05:54:25.327

您也可以使用子shell 来更好地控制您的使用 - 这是一个实际示例：

```
#!/bin/bash

commandA --args

# Run commandB in a subshell and collect its output in $VAR
# NOTE
#  - PATH is only modified as an example
#  - output beyond a single value may not be captured without quoting
#  - it is important to discard (or separate) virtualenv activation stdout
#    if the stdout of commandB is to be captured
#
VAR=$(
    PATH="/opt/bin/foo:$PATH"
    . /path/to/activate > /dev/null  # activate virtualenv
    commandB  # tool from /opt/bin/ which requires virtualenv
)

# Use the output from commandB later
commandC "$VAR" 
```

这种风格在以下情况下特别有用

*   不同版本的`commandA`或`commandC`存在于`/opt/bin`
*   `commandB`存在于系统中`PATH`或很常见
*   这些命令在 virtualenv 下失败
*   需要各种不同的虚拟环境

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-29T13:18:20.263

采购 bash 脚本的目的是什么？

1.  如果您打算在多个 virtualenv 之间切换或快速进入一个 virtualenv，您尝试过`virtualenvwrapper`吗？它提供了很多实用程序，例如`workon venv`，`mkvirtualenv venv`等等。

2.  如果您只是在某个 virtualenv 中运行 python 脚本，请使用`/path/to/venv/bin/python script.py`它来运行它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-10T12:52:23.090

当我学习 venv 时，我创建了一个脚本来提醒我如何激活它。

```
#!/bin/sh
# init_venv.sh
if [ -d "./bin" ];then
  echo "[info] Ctrl+d to deactivate"
  bash -c ". bin/activate; exec /usr/bin/env bash --rcfile <(echo 'PS1=\"(venv)\${PS1}\"') -i"
fi 
```

这样做的好处是它改变了提示。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-11-19T14:51:39.443

如其他答案所述，当您运行脚本时，它会创建一个子外壳。当脚本退出时，对该 shell 的所有修改都将丢失。

实际上，我们需要的是在虚拟环境处于活动状态的情况下运行一个新的 shell，而**不是**从中退出。请注意，这是一个**新**的shell，**而不是**在您运行脚本之前正在使用的 shell。这意味着，如果您输入`exit`它，它将退出子shell，并返回到前一个（运行脚本的那个），它不会关闭您的 xterm 或其他任何东西，正如您可能预期的那样。

麻烦的是，当我们执行 bash 时，它会读取它的 rc 文件（/etc/bash.bashrc，~/.bashrc），这**会**改变 shell 环境。解决方案是为 bash 提供一种照常设置 shell 的方法，同时**激活**虚拟环境。为此，我们创建一个临时文件，重新创建原始 bash 行为，并添加一些我们需要启用 venv 的东西。然后我们要求 bash 使用它而不是它通常的 rc 文件。

拥有一个“专用”给我们的 venv 的新 shell 的一个有益副作用是，要停用虚拟环境，唯一需要做的就是退出 shell。我在下面公开的脚本中使用它来提供“停用”选项，该选项通过向新外壳 ( ) 发送信号来起作​​用`kill -SIGUSR1`，该信号被拦截 ( `trap ...`) 并引发外壳退出。注意：我使用 SIGUSR1 以不干扰可以在“正常”行为中设置的任何内容。

我使用的脚本：

```
#!/bin/bash

PYTHON=python3

myname=$(basename "$0")
mydir=$(cd $(dirname "$0") && pwd)
venv_dir="${mydir}/.venv/dev"

usage() {
    printf "Usage: %s (activate|deactivate)\n" "$myname"
}

[ $# -eq 1 ] || { usage >&2; exit 1; }

in_venv() {
    [ -n "$VIRTUAL_ENV" -a "$VIRTUAL_ENV" = "$venv_dir" -a -n "$VIRTUAL_ENV_SHELL_PID" ]
}

case $1 in
    activate)
        # check if already active
        in_venv && {
            printf "Virtual environment already active\n"
            exit 0
        }

        # check if created
        [ -e "$venv_dir" ] || {
            $PYTHON -m venv --clear --prompt "venv: dev" "$venv_dir" || {
                printf "Failed to initialize venv\n" >&2
                exit 1
            }
        }

        # activate
        tmp_file=$(mktemp)
        cat <<EOF >"$tmp_file"
# original bash behavior
if [ -f /etc/bash.bashrc ]; then
    source /etc/bash.bashrc
fi
if [ -f ~/.bashrc ]; then
    source ~/.bashrc
fi

# activating venv
source "${venv_dir}/bin/activate"

# remove deactivate function:
# we don't want to call it by mistake
# and forget we have an additional shell running
unset -f deactivate

# exit venv shell
venv_deactivate() {
    printf "Exitting virtual env shell.\n" >&2
    exit 0
}
trap "venv_deactivate" SIGUSR1

VIRTUAL_ENV_SHELL_PID=$$
export VIRTUAL_ENV_SHELL_PID

# remove ourself, don't let temporary files laying around
rm -f "${tmp_file}"
EOF
        exec "/bin/bash" --rcfile "$tmp_file" -i || {
            printf "Failed to execute virtual environment shell\n" >&2
            exit 1
        }
    ;;
    deactivate)
        # check if active
        in_venv || {
            printf "Virtual environment not found\n" >&2
            exit 1
        }

        # exit venv shell
        kill -SIGUSR1 $VIRTUAL_ENV_SHELL_PID || {
            printf "Failed to kill virtual environment shell\n" >&2
            exit 1
        }
        exit 0
    ;;
    *)
        usage >&2
        exit 1
    ;;
esac 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-05T15:38:55.773

You should use multiple commands in one line. for example:

```
os.system(". Projects/virenv/bin/activate && python Projects/virenv/django-project/manage.py runserver") 
```

when you activate your virtual environment in one line, I think it forgets for other command lines and you can prevent this by using multiple commands in one line. It worked for me :)

# c# - git log 路径的 LibGit2Sharp 等价物是什么？

> ID：13122138
> 
> 赞同：11
> 
> 时间：2012-10-29T12:57:42.103
> 
> 标签：c#, git, libgit2, libgit2sharp

如何获取包含特定文件的提交列表，即相当于`git log path`for `LibGit2Sharp`。

它没有被实施还是有我遗漏的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T15:53:58.417

我正在努力使用 LibGit2Sharp 将相同的功能添加到我的应用程序中。

我编写了下面的代码，它将列出包含该文件的所有提交。不包括 GitCommit 类，但它只是属性的集合。

我的意图是让代码仅列出文件已更改的提交，类似于 SVN 日志，但我还没有写那部分。

*请注意，代码尚未优化，这只是我的初步尝试，但我希望它会有用。*

```
/// <summary>
/// Loads the history for a file
/// </summary>
/// <param name="filePath">Path to file</param>
/// <returns>List of version history</returns>
public List<IVersionHistory> LoadHistory(string filePath)
{
    LibGit2Sharp.Repository repo = new Repository(this.pathToRepo);

    string path = filePath.Replace(this.pathToRepo.Replace(System.IO.Path.DirectorySeparatorChar + ".git", string.Empty), string.Empty).Substring(1);
    List<IVersionHistory> list = new List<IVersionHistory>();

    foreach (Commit commit in repo.Head.Commits)
    {
        if (this.TreeContainsFile(commit.Tree, path) && list.Count(x => x.Date == commit.Author.When) == 0)
        {
            list.Add(new GitCommit() { Author = commit.Author.Name, Date = commit.Author.When, Message = commit.MessageShort} as IVersionHistory);
        }
    }

    return list;
}

/// <summary>
/// Checks a GIT tree to see if a file exists
/// </summary>
/// <param name="tree">The GIT tree</param>
/// <param name="filename">The file name</param>
/// <returns>true if file exists</returns>
private bool TreeContainsFile(Tree tree, string filename)
{
    if (tree.Any(x => x.Path == filename))
    {
        return true;
    }
    else
    {
        foreach (Tree branch in tree.Where(x => x.Type == GitObjectType.Tree).Select(x => x.Target as Tree))
        {
            if (this.TreeContainsFile(branch, filename))
            {
                return true;
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T13:13:39.317

[LibGit2Sharp](https://github.com/libgit2/libgit2sharp)来自 C 库[libgit2](http://libgit2.github.com/) ...它首先没有包含`git log`；）

然而，LibGit2Sharp 有它自己的`git log`功能：
它的[页面`git log`](https://github.com/libgit2/libgit2sharp/wiki/git-log)涉及[**Filters**](https://github.com/libgit2/libgit2sharp/blob/vNext/LibGit2Sharp/Filter.cs)，但 Filter 似乎没有按路径过滤（详见“[如何在查询 refs 时排除存储？](https://stackoverflow.com/a/10840451/6309) ”）。
所以目前似乎没有实施。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-11T16:16:46.500

每次更改树/blob 时，它都会获得新的 id 哈希。您只需要与父提交树/blob 项目哈希进行比较：

```
var commits = repository.Commits
   .Where(c => c.Parents.Count() == 1 && c.Tree["file"] != null &&
      (c.Parents.FirstOrDefault().Tree["file"] == null ||
         c.Tree["file"].Target.Id !=
         c.Parents.FirstOrDefault().Tree["file"].Target.Id)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-06T06:17:35.287

与 dmck 的答案非常相似，但更新的更多

```
private bool TreeContainsFile(Tree tree, string filePath)
{
    //filePath is the relative path of your file to the root directory
    if (tree.Any(x => x.Path == filePath))
    {
        return true;
    }

    return tree.Where(x => x.GetType() == typeof (TreeEntry))
        .Select(x => x.Target)
        .OfType<Tree>()
        .Any(branch => TreeContainsFile(branch, filePath));
} 
```

# javascript - Javascript空值控制

> ID：13122142
> 
> 赞同：-1
> 
> 时间：2012-10-29T12:57:52.633
> 
> 标签：javascript, jquery

代码的 if(usern == "") 部分正在工作。但是当我按下键盘上的空格按钮进行“输入”时，它会转到 else 语句。我怎样才能解决这个问题？

```
usern = $("input").val();

if(usern == "")
        //don't do 
else 
        //do something 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T12:59:04.227

用于[`$.trim()`](http://api.jquery.com/jQuery.trim/)首先从值中删除空格：

```
var usern = $.trim($("input").val()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T12:58:56.867

您可以使用`$.trim`实用程序功能：

```
var usern = $.trim( $("input").val() ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-29T12:59:13.977

[**jQuery.trim()**](http://api.jquery.com/jQuery.trim/)：

```
if ( $.trim( usern ) === "" ) {

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-29T12:59:41.653

采用`usern = $("input").val().trim();`

# bash - 防止用反引号括起来的表达式在 heredocs 中求值

> ID：13122147
> 
> 赞同：24
> 
> 时间：2012-10-29T12:58:13.377
> 
> 标签：bash, shell

我有这样的文字：

```
foo bar
`which which` 
```

如果我使用 heredoc 执行此操作，我会得到一个空白文件：

```
➜  ~  echo <<EOT > out
heredoc> foo bar
heredoc> `which which`
heredoc> EOT
➜  ~  cat out

➜  ~ 
```

我怎样才能做到这一点？

### 编辑

哦，对不起，我本来打算这样做`cat`的。问题是它将它写入文件：`which: shell built-in command`，即评估反引号。有什么方法可以在不评估的情况下做到这一点？

`cat`，我得到

```
➜  ~  cat <<EOT > out
heredoc> foo bar
heredoc> `which which`
heredoc> EOT
➜  ~  cat out
foo bar
which: shell built-in command
➜  ~ 
```

我不想`which which`被评价。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-10-29T13:02:32.713

引用标签以防止评估反引号。

```
$ cat << "EOT" > out
foo bar
`which which`
EOT

$ cat out
foo bar
`which which` 
```

# jpa - 在 LIKE 条件的列值中使用通配符

> ID：13122149
> 
> 赞同：0
> 
> 时间：2012-10-29T12:58:19.403
> 
> 标签：jpa, wildcard, sql-like

我有一种情况，我需要找到与给定文件名匹配的实体。文件名采用以下形式：

```
filename1 = "ABCD_126518.pdf";
filename2 = "XYZ_32162.pdf"; 
```

在 Oracle DB 中，我有具有如下文件名模式的实体：

```
ID | filename_pattern
1  | ABCD_
2  | KLM
3  | XYZ_ 
```

我需要找到给定文件名匹配的模式 ID。在给定的示例中，文件名 1 的 ID = 1 和文件名 2 的 ID = 3。命名查询在 Java 中的查询应该如何？

我需要类似的东西

```
SELECT p FROM FilenamePattern p WHERE p.filename_pattern || "%" LIKE :param; 
```

我们使用 Oracle DB 和 JPA 1.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:07:58.180

怎么样，

```
SELECT p FROM FilenamePattern p WHERE :param LIKE CONCAT(p.filename_pattern, "%") 
```

# iphone - 通过单击 iPhone 中的链接安装应用程序

> ID：13122153
> 
> 赞同：1
> 
> 时间：2012-10-29T12:58:32.503
> 
> 标签：iphone, cocoa-touch

我如何使用构建在服务器或本地 Mac 机器上的链接或路径来安装应用程序。

解释：

我创建了一个名为“ **app1** ”的应用程序。模拟器上已经安装了另一个名为“ **app2 ”的应用程序。**我只想通过单击 app2 中提供的链接将 app1 安装到模拟器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:21:53.947

创建一个正确签名的 IPA 和一个`manifest.plist`文件，然后将它们上传到您的服务器就足够了 - 请参阅有关该主题的[完整教程。](http://mobiledevelopertips.com/xcode/distribute-ad-hoc-applications-over-the-air-ota.html)

# vb.net - 从多个富文本编辑器写入 vb.net 中的 RTF 文件

> ID：13122160
> 
> 赞同：0
> 
> 时间：2012-10-29T12:58:57.883
> 
> 标签：vb.net, richtextbox, rtf

我有一个带有 4 个富文本编辑器的基于文本的应用程序。当我点击保存按钮时，所有这些富文本编辑器的内容都必须保存到一个 RTF 文件中！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:42:55.377

这是一个可行的，虽然不是特别优雅的解决方案：

```
 Dim temprtb As New RichTextBox
    With temprtb
        .Select(temprtb.TextLength, 0)
        .SelectedRtf = RichTextBox1.Rtf
        .Select(temprtb.TextLength, 0)
        .SelectedRtf = RichTextBox2.Rtf
        .Select(temprtb.TextLength, 0)
        .SelectedRtf = RichTextBox3.Rtf
        .Select(temprtb.TextLength, 0)
        .SelectedRtf = RichTextBox4.Rtf
        .SaveFile("C:\Users\Admin\Documents\test.rtf")
    End With 
```

它创建一个新的富文本框，附加现有富文本框的内容，并保存文件。

编辑一个更优雅的解决方案可能是将所有richtextboxes放在一个面板中并循环它们：

```
 Dim temprtb As New RichTextBox
    For Each c As Control In Panel1.Controls
        If TypeOf (c) Is RichTextBox Then
            temprtb.Select(temprtb.TextLength, 0)
            temprtb.SelectedRtf = DirectCast(c, RichTextBox).Rtf
        End If

    Next
    temprtb.SaveFile("C:\Users\Admin\Documents\test.rtf") 
```

# c# - 首先使用 TPH 在 EF 4.3.1 代码中定义外键

> ID：13122166
> 
> 赞同：0
> 
> 时间：2012-10-29T12:59:22.220
> 
> 标签：c#, .net, entity-framework, ef-code-first, entity-framework-4.3

我创建了三个不同的类和一个存储不同类型地址的基类。基类是与用户相关的邮政地址（当前地址附加到谁）和邮政，其中包含有关邮政编码和城市的信息。

```
public class PostalAddress
{
    public virtual User User { get; set; }
    public DateTime LastUsed { get; private set; }

    public string OrientationNumber { get; set; }
    public int UserId { get; set; }

    public int PostId { get; set; }

    public int Id { get; set; }
    public virtual Post Post { get; private set; }

    public string Street  { get; set; }
}

public class Post
{
    public Post()
    {
        InvoicingAddresses = new List<InvoicingAddress>();
        ShippingAddresses = new List<ShippingAddress>();
        UserAddresses = new List<UserAddress>();
    }

    public virtual City City { get; set; }
    public virtual ICollection<InvoicingAddress> InvoicingAddresses { get; private set; }
    public virtual ICollection<ShippingAddress> ShippingAddresses { get; private set; }
    public virtual ICollection<UserAddress> UserAddresses { get; private set; }
    public int CityId { get; set; }
    public int Id { get; set; }
    public string ZipCode { get; set; }   
} 
```

使用 PostalAddressMap 类映射 PostalAddress 类

```
public class PostalAddressMap : EntityTypeConfiguration<PostalAddress>
{
    public PostalAddressMap()
    {
        // Primary Key
        HasKey(t => t.Id);

        // Properties
        // Table & Column Mappings
        ToTable("PostalAddress");
        Property(t => t.Id).HasColumnName("Id");
        Property(t => t.LastUsed).HasColumnName("LastUsed").HasColumnType("datetime2");
        Property(t => t.OrientationNumber).HasColumnName("OrientationNumber");
        Property(t => t.UserId).HasColumnName("UserId");
        Property(t => t.PostId).HasColumnName("PostId");
        Property(t => t.Street).HasColumnName("Street");            

        // Relationships
        HasRequired(t => t.Post).WithMany(t => t.InvoicingAddresses).HasForeignKey(d => d.PostId);
        HasRequired(t => t.User)
            .WithMany(t => t.UserAddressess)
            .HasForeignKey(d => d.UserId);

    }
} 
```

InvoicingAddress、ShippingAddress 和 UserAddress 类使用[Table per hierarchy](http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx)方法从 PostalAddress 类继承。如果我想使用 line 设置关系

```
 HasRequired(t => t.Post).WithMany(t => t.InvoicingAddresses).HasForeignKey(d => d.PostId); 
```

我收到编译器错误**无法将类型“System.Collections.Generic.ICollection<InvoicingAddress>”隐式转换为“System.Collections.Generic.ICollection<PostalAddress>”。存在显式转换（您是否缺少演员表？）**

请问，你能帮我如何在 PostalAddress 子类和其他 TPT 类型之间设置外键吗？

感谢您提供任何有用的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T15:56:19.003

您必须将`PostId`和`Post`属性从基类移动`PostalAddress`到派生类`InvoicingAddress`等...

```
public class InvoicingAddress : PostalAddress
{
    //...
    public int PostId { get; set; }
    public virtual Post Post { get; private set; }
} 
```

...然后使用派生类的映射：

```
public class InvoicingAddressMap : EntityTypeConfiguration<InvoicingAddress>
{
    public InvoicingAddressMap()
    {
        HasRequired(t => t.Post)
            .WithMany(t => t.InvoicingAddresses)
            .HasForeignKey(d => d.PostId);
    }
} 
```

`Post`或者您必须对基类使用单个集合：

```
public virtual ICollection<PostalAddress> Addresses { get; private set; } 
```

然后你可以使用你原来的映射。

后一种方法的缺点是，当你使用 eager 或 lazy loading 时，所有的`PostalAddress`es 都会被加载，你无法控制要加载哪种类型的地址。加载地址后，您可以按内存中的类型进行过滤：

```
var invoicingAddresses = post.Addresses.OfType<InvoicingAddress>(); 
```

通过显式加载，您也可以过滤：

```
var post = context.Posts.Single(p => p.Id == 1);
context.Entry(post).Collection(p => p.Addresses).Query()
    .OfType<InvoicingAddress>().Load(); 
```

...这将仅使用 es填充`Addresses`集合。`InvoicingAddress`

# grails - Grails：响应标头已满且未发送响应

> ID：13122180
> 
> 赞同：2
> 
> 时间：2012-10-29T12:59:57.260
> 
> 标签：grails, spring-security, http-headers

```
| Error 2012-10-29 14:51:19,847 [http-bio-8443-exec-3] ERROR http11.Http11Processor  - Error processing request
Message: An attempt was made to write more data to the response headers than there was room available in the buffer. Increase maxHttpHeaderSize on the connector or write less data into the response headers.
   Line | Method
->> 886 | runTask in java.util.concurrent.ThreadPoolExecutor$Worker
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   908 | run     in     ''
^   680 | run . . in java.lang.Thread
| Error 2012-10-29 14:51:19,850 [http-bio-8443-exec-3] ERROR http11.Http11Processor  - Error finishing response
Message: An attempt was made to write more data to the response headers than there was room available in the buffer. Increase maxHttpHeaderSize on the connector or write less data into the response headers.
   Line | Method
->> 886 | runTask in java.util.concurrent.ThreadPoolExecutor$Worker
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   908 | run     in     ''
^   680 | run . . in java.lang.Thread 
```

*这在我的本地开发环境（ grails run-app -https*）中非常随机地发生。不管是什么浏览器。

我在 Mac OSX 上使用以下插件运行 Grails 2.1.0：

```
aws-sdk             1.3.12           --  AWS SDK Grails Plugin
cookie-session      0.1.2            --  Cookie Session Plugin
hibernate           2.1.0            --  Hibernate for Grails
jquery              1.7.1            --  JQuery for Grails
jquery-ui           1.8.15           --  jQuery UI resources
mail                1.0              --  Provides Mail support to a running Grails application
newrelic            0.1              --  Newrelic Plugin
qrcode              0.3              --  QR Code plugin
quartz              1.0-RC2          --  Quartz plugin for Grails
resources           1.1.6            --  Resources
spring-security-core1.2.7.3          --  Spring Security Core Plugin
tomcat              2.1.0            --  Apache Tomcat plugin for Grails
webxml              1.4.1            --  WebXmlConfig 
```

有什么想法可能导致这种情况吗？

**编辑：** 注意到当浏览器被转发到 j_spring_security_check 时，这似乎发生在登录（Spring 安全登录表单）之后。使用 Chrome 和 Firefox，可以通过重置浏览器来暂时阻止这种情况的发生。IE 的行为并不相似，而是不断给出此错误（该错误仅在 grails 控制台中显示）。

有一些东西填满了标题。可能是*cookie-session*插件？

# javascript - Json 输入到 javascript 数组中

> ID：13122182
> 
> 赞同：-1
> 
> 时间：2012-10-29T12:59:58.317
> 
> 标签：javascript, jquery, arrays, json

我在尝试将一些 Json 数据转换为特定格式时遇到了一些问题。

我基本上需要这个 Json 数据：

```
{
query: [ ],
products:  [
 {
title: "title 1",
price: "6.00",
magazine: "magazine name 1",
image: "/p/c/pc_90_cover.jpg",
type: "Magazine",
market: "Technology",
zinio: "http:www.zinio.com",
newsstand: "http://www.link1.php"
},

 {
title: "title 2",
price: "6.00",
magazine: "magazine name 2",
image: "/p/c/pc_90_cover.jpg",
type: "Magazine",
market: "Technology",
zinio: "http:www.zinio.com",
newsstand: "http://www.link2.php"
},

 {
title: "title 3",
price: "6.00",
magazine: "magazine name 3",
image: "/p/c/pc_90_cover.jpg",
type: "Magazine",
market: "Technology",
zinio: "http:www.zinio.com",
newsstand: "http://www.link3.php"
}
] 
```

要进入这个 javascript 数组：

```
var arrProducts = [
                          title:  "{{ product.title }}",
                          url:  "{{ product.url }}",
                          label:  "{{ product.title }}",
                          magazine: "{{ product.magazine }}",
                          image: "{{ product.imageThumb }}",
                          newsstand: "{{ product.newsstand }}",
                          kindle: "{{ product.kindle }}",
                          barnesnoble: "{{ product.barnesnoble }}",
                          zinio: "{{ product.zinio }}",
                          kobo: "{{ product.kobo }}",
                          waterstones: "{{ product.waterstones }}",
                          type: "{{ product.type }}",
                      },
             ]; 
```

我试过使用：

```
var allProducts = $.get("http://localhost:8888/web/app_dev.php/api/v1/search/search.json, function(data) {

var productsArray = data.products; 

console.log(productsArray);

}); 
```

但是该方法不会以我需要的格式构建数组。Console.log 输出一堆对象。也许 for each 循环可能是一个解决方案？- 任何帮助表示赞赏，我的 Javascript 不是那么好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:22:17.673

使用[http://jsonlint.com](http://jsonlint.com)来验证您的 json。如果它不会通过那里，它也不会通过ajax。您的示例在对象键和起始大括号上缺少双引号，并且有额外的逗号，并且您的文件`var arrProducts =`在被 ajax 使用时不应包含

但是，如果在初始页面加载期间在页面中放置带有此文件的脚本标记，则会有所不同。然后`var arrProducts =`需要，对象键上的引号不是。然后，您可以简单地循环变量而不是 ajax`arrProducts`

**编辑：**

循环第一个样本

```
$.getJSON( url, function(data) { 
    var productsArray = data.products;  
    $.each(  productsArray, function( i, item){ 

         console.log( 'Title is '+ item.title)

    })

}) 
```

有很多关于如何解析 json 和循环对象和数组的信息……你试过搜索吗？

# javascript - Javascript 向表单提交数据两次

> ID：13122185
> 
> 赞同：0
> 
> 时间：2012-10-29T13:00:01.427
> 
> 标签：javascript, forms, double-submit-problem

假设我有一个简单的表格：

```
​&lt;form id="new_stuff">
    <label>Title </label>
        <input id="title" maxlength="255" name="new[title]" size="50" type="text"><br /><br />
    <label>Message </label>
        <input id="message"  name="new[message]" size="50" type="text" value="general"><br />
    <label>Upload </label>
        <input id="upload_data" name="new[upload]" size="30" type="file"><br />
    <input id="submitform" action="form.php" type="button" value="submit me" formmethod="post"/>
​&lt;/form> 
```

当用户填写数据并点击提交时，我需要一种获取数据的方法，更改标题（假设在用户输入的任何内容的末尾添加单词“TESTING”）然后提交表单两次；一次使用原始数据，另一次使用更改后的数据。

任何人都可以帮助我在 JS 中执行此操作的方法。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:07:25.253

一点点 jQuery 让这很容易。

```
$( "#new_stuff" ).submit( function () {
  var self = this;
  // Save the form data as-is, before making any changes
  var originalFormData = $( self ).serialize();

  // Make changes to the values that you want to change.
  $( "#title" ).val( $( "#title" ).val() + ' TESTING' );

  // Serialize the form a second time
  var modifiedFormData = $( self ).serialize();

  // Post the form to your location.
  $.post('url', originalFormData);
  $.post('url', modifiedFormData);

  // Return false, otherwise the form action will post (a third time).
  return false;
}); 
```

# android - 获取当前预订时间

> ID：13122186
> 
> 赞同：0
> 
> 时间：2012-10-29T13:00:03.663
> 
> 标签：android, date

我知道这是一个非常简单的问题，但我做不到。我有一个获取当前时间的代码，但这个时间不准确。

```
 booking.CreateDateTime = DateTime.Now.ToUniversalTime(); 
```

当我在 12:00 预订时，在数据库中存储 1:00，这意味着 1 小时的差异。

我怎样才能得到准确的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:09:21.720

用于`System.currentTimeMillis()`获取自纪元以来的当前 GMT 时间（以毫秒为单位）。然后，您可以使用该值创建一个新的 Date 或 Calendar 对象，并将其本地化到用户所在的任何位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:18:28.373

我不熟悉你在那里有什么，但`ToUniversalTime`向我建议这是将你的时间调整到某个固定时区（可能是格林威治标准时间）

使用[Date](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html "日期")获取现在的时间，然后使用[Calendar](http://docs.oracle.com/javase/6/docs/api/java/util/GregorianCalendar.html "日历")对其进行任何您想要的时区更改。

例如，假设`CreateDateTime`实际上是您所说的字符串：

```
Date date = new Date();
Calendar calendar = new GregorianCalendar();
calendar.setTime(date);
booking.CreateDateTime = calendar.get(Calendar.HOUR_OF_DAY) + ":" + calendar.get(Calendar.MINUTE)); 
```

# perl - Perl 脚本 - 将日期添加到日期以获取新日期

> ID：13122197
> 
> 赞同：13
> 
> 时间：2012-10-29T13:00:54.947
> 
> 标签：perl, date

我正在编写一个 perl 脚本来为日期添加天数并显示新日期：

```
use Time::ParseDate;
use Time::CTime;

my $date = "02/01/2003";
my $numdays = 30;

my $time = parsedate($date);

# add $numdays worth of seconds
my $newtime = $time + ($numdays * 24 * 60 * 60);

my $newdate = strftime("%m/%d/%Y",localtime($newtime));

print "$newdate\n";

    The output will be:

    03/03/2003 
```

现在如何将日期字段的输入设置为 yyyymmdd 例如：my $date = "20030102"

输出也需要是：20030303

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-29T19:13:08.823

您使用[Time::Piece](http://search.cpan.org/~msergeant/Time-Piece/Piece.pm) + [Time::Seconds](http://search.cpan.org/dist/Time-Piece/Seconds.pm)（自 Perl 5.10 以来的核心），

```
use Time::Piece ();
use Time::Seconds;
my $date = '20030102';
my $numdays = 60; # 30 doesn't get us to march

my $dt = Time::Piece->strptime( $date, '%Y%m%d');
$dt += ONE_DAY * $numdays;
print $dt->strftime('%Y%m%d'); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-29T14:45:01.737

您可以使用`DateTime`+ `DateTime::Format::Strptime`：

```
#!/usr/bin/perl
use strict;

use DateTime;
use DateTime::Format::Strptime;

my $strp = DateTime::Format::Strptime->new(
    pattern => '%m/%d/%Y'
);

# convert date to 
my $date = '02/01/2003';
my $dt   = $strp->parse_datetime($date);
printf "%s -> %s\n", $date, $dt->add(days => 30)->strftime("%d/%m/%Y"); 
```

**输出**

```
02/01/2003 -> 03/03/2003 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-29T13:30:37.563

将 $date 从输入格式转换为旧格式：

```
$date =~ s%(....)(..)(..)%$3/$2/$1%; 
```

如果输出格式不应该是`%m/%d/%Y`，则不要将其设置为它。你显然需要`%Y%m%d`.

# iphone - 图像数组在 UIScrollview 和 Paging 中成功显示，但无法正确放大滚动视图中的图像

> ID：13122199
> 
> 赞同：1
> 
> 时间：2012-10-29T13:01:14.617
> 
> 标签：iphone, objective-c, uiscrollview

我正在使用 ImageArray 处理 UIScrollview。滚动和分页正在工作，但我无法缩放每个图像。我的图像滚动视图代码如下：-

`#define IMAGE_WIDTH 320`

`#define IMAGE_HEIGHT 360`

```
 - (void)viewDidLoad
 {
[super viewDidLoad];

// TODO – fill with your photos
NSArray *photos = [[NSArray arrayWithObjects:
                    [UIImage imageNamed:@"photo1m.jpg"],
                    [UIImage imageNamed:@"photo2m.jpg"],
                    [UIImage imageNamed:@"photo3m.jpg"],
                    [UIImage imageNamed:@"photo4m.jpg"],
                    nil] retain];
// note that the view contains a UIScrollView in aScrollView

    int i=0;
    for ( NSString *image in photos )
    {
       UIImage *images = [photos objectAtIndex:i];
       imageView = [[UIImageView alloc] initWithImage:images];
       imageView.contentMode = UIViewContentModeScaleAspectFit;
       imageView.clipsToBounds = YES;

       imageView.frame = CGRectMake( IMAGE_WIDTH * i++, 0, IMAGE_WIDTH, IMAGE_HEIGHT);

       [self.scrollViewimages addSubview:imageView];
      [imageView release];
     }
      self.scrollViewimages.contentSize = CGSizeMake(IMAGE_WIDTH*i, IMAGE_HEIGHT);
      self.scrollViewimages.delegate = self; 
 } 
```

需要帮助实现每个图像的捏缩放。请帮忙 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-30T03:32:31.720

```
for ( NSString *image in photos )
    {
       UIImage *images = [photos objectAtIndex:i];
       imageView = [[UIImageView alloc] initWithImage:images];
       imageView.contentMode = UIViewContentModeScaleAspectFit;
       imageView.clipsToBounds = YES;
       imageView.tag = 1;

       UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake( IMAGE_WIDTH * i++, 0, IMAGE_WIDTH, IMAGE_HEIGHT)];
       scrollView.delegate = self;
       scrollView.maximumZoomScale = 3.0f
       imageView.frame = scrollView.bounds;
       [scrollView addSubview:imageView];
       [imageView release];

       [self.scrollViewimages addSubview:scrollView];

     } 
```

并在 UIScrollViewDelegate 中实现委托方法

```
- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView {
    return [scrollView viewWithTag:1];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-11T10:14:33.733

```
#define IMAGE_FOR_ZOOM_TAG (1) 
```

调用以下自定义方法

```
-(void) setupProductImageViewContainerUI
{
    UIWindow *window = [[[UIApplication sharedApplication] delegate] window];

    if(self.dimView)
    {
        for(UIView *subView in self.dimView.subviews)
            [subView removeFromSuperview];
        [self.dimView removeFromSuperview]; self.dimView = nil;
    }

    self.dimView = [[UIView alloc] initWithFrame:window.bounds];
    self.dimView.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:.5];
    self.dimView.userInteractionEnabled = YES;
    [window addSubview:self.dimView];

    self.imgContainerView = [[UIView alloc] init];
    self.imgContainerView.frame = CGRectMake(0, 0, window.frame.size.width, window.frame.size.height);
    self.imgContainerView.backgroundColor = [UIColor whiteColor];
    [self.dimView addSubview:self.imgContainerView];

    UIScrollView *mainScrollView = [[UIScrollView alloc] initWithFrame:window.bounds];
    mainScrollView.pagingEnabled = YES;
    mainScrollView.delegate = self;
    mainScrollView.showsHorizontalScrollIndicator = NO;
    mainScrollView.showsVerticalScrollIndicator = NO;
    [self.imgContainerView addSubview:mainScrollView];
    CGRect innerScrollFrame = mainScrollView.bounds;

    IndexOfSlidingPhoto = 0;
    for(int i = 0 ; i < listOfImages.count; i++)
    {
        UIImage *imgProduct = [GeneralClass getImageForSreenFromScreenTable:@"" orCustomTable:@"" OrDefaultImga:[listOfImages objectAtIndex:i]];
        UIImageView *imageForZooming = [[UIImageView alloc] initWithImage:imgProduct];
        imageForZooming.frame = CGRectMake(0, 0, window.frame.size.width, window.frame.size.height);
        imageForZooming.tag = IMAGE_FOR_ZOOM_TAG;
        imageForZooming.contentMode = UIViewContentModeScaleAspectFit;

        UIScrollView *pageScrollView = [[UIScrollView alloc] initWithFrame:innerScrollFrame];
        pageScrollView.minimumZoomScale = 1.0f;
        pageScrollView.maximumZoomScale = 20;
        pageScrollView.zoomScale = 1.0f;
        pageScrollView.contentSize = imageForZooming.bounds.size;
        pageScrollView.delegate = self;
        pageScrollView.showsHorizontalScrollIndicator = NO;
        pageScrollView.showsVerticalScrollIndicator = NO;
        [pageScrollView addSubview:imageForZooming];        
        [mainScrollView addSubview:pageScrollView];

        if (i < listOfImages.count -1)
            innerScrollFrame.origin.x += innerScrollFrame.size.width;

    mainScrollView.contentSize = CGSizeMake(innerScrollFrame.origin.x + innerScrollFrame.size.width, mainScrollView.bounds.size.height);

    [window bringSubviewToFront:self.dimView];
}

#pragma Mark -
#pragma Mark - UIScrollView Delegate Methods

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView
{
    return [scrollView viewWithTag:IMAGE_FOR_ZOOM_TAG];
} 
```

# sql - SQL Server Profiler，ObjectName 列，“拆分”

> ID：13122202
> 
> 赞同：0
> 
> 时间：2012-10-29T13:01:18.670
> 
> 标签：sql, sql-server, sql-server-profiler

`ObjectName`SQL Server Profiler 中的列是什么意思？

这个[http://msdn.microsoft.com/en-us/library/aa173882(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa173882(v=sql.80).aspx)给出了相当简洁的定义。

对于我感兴趣的记录，它要么是空白的——在执行语句时——要么它包含一个存储过程名称。但我最近才注意到它可能还包含“Split”作为值。

那么这样的记录（Profiler 中的条目）是什么意思呢？

# ios - 如何在 UILabel 中制作带下划线的文本？

> ID：13122207
> 
> 赞同：28
> 
> 时间：2012-10-29T13:01:48.590
> 
> 标签：ios, cocoa-touch, text, uilabel, underline

如何在中添加下划线文本`UILabel`？

我曾尝试制作`UILabel`高度为**0.5f**的 a并将其放在文本下方。**当我在iPhone 4.3**和**iPhone 4.3 模拟器**中运行我的应用程序时，此行标签不可见，但在**iPhone 5.0 模拟器**之后可见。为什么？

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-10-29T13:22:31.743

### Objective-C

**iOS 6.0 > 版本**

`UILabel`支持`NSAttributedString`

```
NSMutableAttributedString *attributeString = [[NSMutableAttributedString alloc] initWithString:@"Hello Good Morning"];
[attributeString addAttribute:NSUnderlineStyleAttributeName
                        value:[NSNumber numberWithInt:1]
                        range:(NSRange){0,[attributeString length]}]; 
```

### 迅速

```
let attributeString: NSMutableAttributedString =  NSMutableAttributedString(string: "Hello Good Morning")
attributeString.addAttribute(NSUnderlineStyleAttributeName, value: 1, range: NSMakeRange(0, attributeString.length)) 
```

**定义**：

```
- (void)addAttribute:(NSString *)name value:(id)value range:(NSRange)aRange 
```

`Parameters List:`

**name**：指定属性名称的字符串。属性键可以由另一个框架提供，也可以是您定义的自定义键。有关在何处查找系统提供的属性键的信息，请参阅 NSAttributedString 类参考中的概述部分。

**value**：与 name 关联的属性值。

**aRange**：指定属性/值对适用的字符范围。

现在像这样使用：

```
yourLabel.attributedText = [attributeString copy]; 
```

* * *

### iOS 5.1.1 < 版本

您需要`3 party attributed Label`显示`attributed text`：

1) 参考[TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)链接。其最好的第三方`attributed` `Label`要`display`归功于`text`。

2)为第三方参考[OHAttributedLabel](https://github.com/AliSoftware/OHAttributedLabel)`attributed` `Label`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-09-30T05:39:55.997

我正在使用 Xcode 9 和 iOS 11。使 UILabel 在其下方带有下划线。您可以同时使用 1\. 使用代码 2\. 使用 xib

使用代码：

```
NSMutableAttributedString *attributeString = [[NSMutableAttributedString alloc] initWithString:@"I am iOS Developer"];
[attributeString addAttribute:NSUnderlineStyleAttributeName
                        value:[NSNumber numberWithInt:1]
                        range:(NSRange){0,[attributeString length]}];
lblAttributed.attributedText = attributeString; 
```

使用 Xib： [![在此处输入图像描述](../Images/88f3d90a0054d034c1b34244222bd07a.png)](https://i.stack.imgur.com/0Ak3d.png)

[![在此处输入图像描述](../Images/796b15ef5f309cab54a3d6ea0fc607d5.png)](https://i.stack.imgur.com/UyuAC.png)

[![在此处输入图像描述](../Images/7d083a116b951e8c49c85dd81ec60320.png)](https://i.stack.imgur.com/yjAN8.png)

[![在此处输入图像描述](../Images/dd2a933057f92b8ffe560ae29b3e8035.png)](https://i.stack.imgur.com/7ZF27.png)

我们也可以使用 for 按钮。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-12-04T03:19:59.177

## 设计师方式 - 高度可定制的版本

我个人更喜欢尽可能地定制我的设计。有时，您会发现使用内置的下划线工具并不容易自定义。

这是我的做法：

`1`首先，我为下划线创建一个 UIView。然后，您可以在 IB 中或以编程方式选择背景颜色。约束是这里的关键。

[![创建下划线视图](../Images/0c6fb46aec048eeab743eeffc7215a88.png)](https://i.stack.imgur.com/TjCBx.png)

`2`然后，您可以根据需要自定义下划线。例如，要调整下划线的宽度以获得更好的视觉效果，请在 Interface Builder 中创建与约束的出口连接

[![在此处输入图像描述](../Images/da434ec9e54829f69add8493b2802d8a.png)](https://i.stack.imgur.com/aaSPp.png)

`3`然后，您可以轻松地以编程方式自定义下划线视图。例如在这里，为了给你一个想法，我们将使下划线比标题“面包”宽 20 px：

```
var originalString: String = "Breads"
let myString: NSString = originalString as NSString
let size: CGSize = myString.size(attributes: [NSFontAttributeName: UIFont.systemFont(ofSize: 14.0)])
self.widthUnderlineTitle.constant = size.width + 20 
```

`Results:`

[![在此处输入图像描述](../Images/396b85f278ad26b7e21d03d6b22225ff.png)](https://i.stack.imgur.com/1Bmv6.jpg)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-29T13:23:00.977

看看[TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)。如果您被允许使用 3d 方组件，只需在您需要的地方用 TTTAttributedLabel 替换您的 UILabel（直接替换）。适用于 iOS < 6.0！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-08T18:46:42.073

**UILabel 上的 Swift 扩展：**

仍需改进，欢迎提出任何想法：

```
extension UILabel{

    func underLine(){    
        if let textUnwrapped = self.text{
            let underlineAttribute = [NSUnderlineStyleAttributeName: NSUnderlineStyle.StyleSingle.rawValue]
            let underlineAttributedString = NSAttributedString(string: textUnwrapped, attributes: underlineAttribute)
            self.attributedText = underlineAttributedString   
        }   
    }
} 
```

我现在能想到的一个缺点是每次文本更改时都需要调用它，并且没有实际的方法来关闭它......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-10T10:55:05.853

**斯威夫特 4.0**

```
var attributeString = NSMutableAttributedString(string: "Hello Good Morning")
attributeString.addAttribute(NSUnderlineStyleAttributeName, value: 1, range: NSRange) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-12-10T12:32:02.560

斯威夫特 5

```
let attributeString: NSMutableAttributedString =  NSMutableAttributedString(string: yourLabel.text ?? "")
attributeString.addAttribute(NSAttributedString.Key.underlineStyle, value: 1, range: NSMakeRange(0, attributeString.length))
yourLabel.attributedText = attributeString 
```

# json - 数据表列和 JSON 格式

> ID：13122208
> 
> 赞同：0
> 
> 时间：2012-10-29T13:01:56.397
> 
> 标签：json, datatables

我已经根据以下 html 设置了一个数据表

```
 <script>
       $('#tableListing').dataTable({
        "bAutoWidth" : true,
        "bProcessing" : true,
        "bServerSide" : true,
        "sAjaxSource" : '${actionUrl}',
        "aoColumns":[ 
                       { "sTitle": "ID", "mData": "id" },
                       { "sTitle": "Username", "mData": "userName" },
                       { "sTitle": "Password", "mData": "password" }
                     ]

            }
    });
    </script>

<table id="tableListing" class="display datatable">
            <thead>
                <tr>
                    <th><spring:message code="columnLabel.id" /></th>
                    <th><spring:message code="columnLabel.username" /></th>
                    <th><spring:message code="columnLabel.enabled" /></th>
                </tr>
            </thead>
</table> 
```

来自服务器的 JSON 响应是`[1,"abiieez",true]`并且运行良好。但是，我已将服务器的响应更改为：

**编辑（更新 JSON 响应）**

```
{
    "iTotalDisplayRecords": 11,
    "iTotalRecords": 11,
    "aaData": "[{\"creationTime\":0,\"enabled\":true,\"id\":1,\"loginDuration\":0,\"online\":false,\"password\":\"asdasd\",\"userName\":\"abiieez\"},{\"creationTime\":0,\"enabled\":false,\"id\":105,\"loginDuration\":0,\"online\":false,\"password\":\"asdasd\",\"userName\":\"asd1212123\"},{\"creationTime\":0,\"enabled\":false,\"id\":106,\"loginDuration\":0,\"online\":false,\"password\":\"asdsdasd\",\"userName\":\"asdasd23123\"},{\"creationTime\":0,\"enabled\":false,\"id\":107,\"loginDuration\":0,\"online\":false,\"password\":\"asdsdasd\",\"userName\":\"asdasd23123\"},{\"creationTime\":0,\"enabled\":false,\"id\":108,\"loginDuration\":0,\"online\":false,\"password\":\"anak jalanan\",\"userName\":\"alibaba90\"},{\"creationTime\":1351338218227,\"enabled\":false,\"id\":109,\"loginDuration\":0,\"online\":false,\"password\":\"asdasdasda\",\"userName\":\"asdasdasda\"},{\"creationTime\":1351338263527,\"enabled\":false,\"id\":110,\"loginDuration\":0,\"online\":false,\"password\":\"asdasdasda\",\"userName\":\"asdasdasda\"},{\"creationTime\":1351338265078,\"enabled\":false,\"id\":111,\"loginDuration\":0,\"online\":false,\"password\":\"asdasdasda\",\"userName\":\"asdasdasda\"},{\"creationTime\":1351338266329,\"enabled\":false,\"id\":112,\"loginDuration\":0,\"online\":false,\"password\":\"asdasdasda\",\"userName\":\"asdasdasda\"},{\"creationTime\":1351338267247,\"enabled\":false,\"id\":113,\"loginDuration\":0,\"online\":false,\"password\":\"asdasdasda\",\"userName\":\"asdasdasda\"}]",
    "sEcho": "1"
} 
```

数据表不接受上面的json，我相信是因为列数不匹配。

有没有办法让我检索这个 json 对象并选择我想在客户端的表上显示哪些列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:58:19.783

您可以像这样在 aoColumns 中使用 mData 属性：

```
 $(document).ready(function() {
            $('#tableListing').dataTable({
               "aoColumns":[ 
                             { "sTitle": "user", "mData": "userName" },
                             { "sTitle": "pass", "mData": "password" },
                             ...
                           ]
                "bAutoWidth" : true,
                "bProcessing" : true,
                "bServerSide" : true,
                "sAjaxSource" : '${actionUrl}'
            });
    }); 
```

# objective-c - 动态格式化 NSString 中的浮点数

> ID：13122210
> 
> 赞同：4
> 
> 时间：2012-10-29T13:02:01.360
> 
> 标签：objective-c, nsstring

考虑一下：

`NSString *whatever=[NSString stringWithFormat:@"My float: %.2f",aFloat];`

`aFloat`构建字符串时，这会将我的小数点四舍五入到 2 位`whatever`

假设我希望`2`这个语句中的 是可分配的，这样，根据`aFloat`I 的值，它可能会显示 2 或 4 个小数位。我怎样才能把它建成`stringWithFormat`？

我希望能够做到这一点，而无需`if`针对不同情况简单地重复整行，而是以某种方式动态地仅更改`%.2f`部分。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-29T13:34:44.440

正确的答案是使用 NSNumberFormatter。

但是，使用格式字符串的简单答案是使用星号说明符。根据[Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265-SW1)，格式字符串符合[IEEE printf 规范](http://pubs.opengroup.org/onlinepubs/009695399/functions/printf.html)。本规范规定如下：

> 字段宽度或精度或两者都可以用星号 ('*') 表示。在这种情况下，int 类型的参数提供字段宽度或精度。

这意味着

```
int precision = 2;
NSString *whatever=[NSString stringWithFormat:@"My float: %.*f", precision,aFloat];
//                                   Asterisk in place of 2^^    ^^^^^^^^^ int variable 
```

应该管用。我不得不说，我还没有尝试过，我倾向于使用 NSNumberFormatters。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T13:08:09.863

您需要先构建格式：

```
NSInteger precision = 2;
NSString *format = [@"My float: %." stringByAppendingFormat:@"%d", precision];
format = [format stringByAppendingString:@"f"];

NSString *whatever=[NSString stringWithFormat:format, aFloat]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:08:33.647

转义`%`为`%%`构建格式字符串：

```
NSUInteger digits = aFloat > 10.0f ? 2 : 4;
NSString *format = [NSString stringWithFormat:@"My float: %%.%if", digits];
NSString *whatever = [NSString stringWithFormat:format, aFloat]; 
```

# java - 解压缩文件 Zip 异常：无效条目大小（预期为 193144 但得到 193138 字节）

> ID：13122212
> 
> 赞同：7
> 
> 时间：2012-10-29T13:02:05.807
> 
> 标签：java, zip, unzip

我正在尝试解压缩文件（从 FTP 服务器检索）：

```
ZipInputStream zis = new ZipInputStream(
    new FileInputStream(zipFile));
    ZipEntry ze = zis.getNextEntry();
    while (ze != null) {
        String fileName = ze.getName();
        File newFile = new File(outputFileName+outputFolder + File.separator + fileName);
        System.out.println("file unzip : " + newFile.getAbsoluteFile());
        FileOutputStream fos = new FileOutputStream(newFile);
        int len;
        while ((len = zis.read(buffer)) > 0) {
            fos.write(buffer, 0, len);
        }
        fos.close();
        sendFile = newFile;
        ze = zis.getNextEntry();
    }
    zis.closeEntry();
    zis.close();
    System.out.println("Done"); 
```

我的 .zip 文件中只有一个文本文件。此代码在我的本地 Windows 机器上运行良好。但是，当部署到 ubuntu 服务器上时，它会抛出以下异常..

```
java.util.zip.ZipException: invalid entry size (expected 193144 but got 193138 bytes)
at java.util.zip.ZipInputStream.readEnd(ZipInputStream.java:386)
at java.util.zip.ZipInputStream.read(ZipInputStream.java:156)
at java.io.FilterInputStream.read(FilterInputStream.java:90) 
```

在 com.empress.Xsync.updater.ClientConfiguration.unZipFile(ClientConfiguration.java:246)

我已经手动解压缩它..工作正常。原始 .txt 文件大小为 193144 字节。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-29T13:06:46.190

看起来您的 zip 文件在将其传输到 Ubuntu 机器的过程中已损坏。尝试从 Ubuntu 机器上的命令行解压缩相同的文件，看看它是否也报告了问题。

如果我随机猜测，那将是您通过 FTP 传输 ZIP 文件并使用“ascii”模式而不是“二进制”模式。（FTP 可以转换`'\r\n'`为`'\n'`六次...）

# winforms - 云中的桌面应用程序

> ID：13122216
> 
> 赞同：3
> 
> 时间：2012-10-29T13:02:28.973
> 
> 标签：winforms, cloud

是否可以在云（例如 Azure）中运行桌面应用程序（WinForms、MS SQL）？不幸的是，我们有无法用 ASP 或 PHP 重写的遗留应用程序，但我们的客户在他的位置没有任何基础设施（当然除了 PC）并且不想购买和维护任何服务器。此外，应用程序需要 Web 服务器 (IIS) 来执行某些功能。

# php - 上传非常大的文件（>5GB）

> ID：13122218
> 
> 赞同：4
> 
> 时间：2012-10-29T13:02:34.240
> 
> 标签：php, jquery, upload, blob, filereader

我需要你的帮助。我想用 HTML、JQuery 和 PHP 创建一个上传脚本。是否可以编写一个脚本，可以上传非常大的文件（> 5 GB）？

我已经尝试使用 FileReader、FormData 和 Blob，但即使使用这些，我也无法上传大文件（我的浏览器在选择大文件后崩溃）。

PS：我想自己写。不要发布任何完成的脚本。

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:12:29.690

是的。一年前我写了 PHP 来上传 5GB 以上的文件。

FileReader、FormData 和 Blob 将失败，因为它们都需要在上传之前进行预处理并在 javascript 中转换。

但是，您可以使用简单的 XMLHttpRequest 轻松上传大文件。

```
var xhr=new XMLHttpRequest();
xhr.send(document.forms[0]['fileinput']); 
```

它不是标准的或记录的方式，但是，很少有 Chrome 和 Firefox 支持。但是，它按原样发送文件内容，而不是 multipart/form-data，而不是 http form-data。您需要准备自己的 http 标头以提供其他信息。

```
var xhr=new XMLHttpRequest(), fileInput=document.forms[0]['fileinput'];
xhr.setRequestHeader("X-File-Name", encodeURIComponent(getInputFileName(fileInput)));
xhr.setRequestHeader("X-File-Size", getFileSize(fileInput));
xhr.send(fileInput); 
```

* * *

PS。好吧，实际上它不是 PHP。它混合了 PHP 和 Java Servlet。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:09:23.503

查看**“分块”**，可能使用[**AX Ajax multi uploader**](http://code.google.com/p/ax-jquery-multiuploader/)之类的插件，它应该有助于客户端和服务器端文件大小限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:09:37.083

请记住，重要的是调整您的**PHP.ini**变量（与脚本时间有关），称为每个脚本的最大执行时间，以秒为单位`max_execution_time = xxxx`，以防止您的脚本超时，因为上传大文件就像您知道耗时。还要检查 variable `max_input_time = xxxx`，这是每个脚本可能花费在解析请求数据上的最长时间。最好在生产服务器上限制此时间，以消除意外长时间运行的脚本，但在您的情况下，您可能需要增加它。还考虑更改以下变量`memory_limit`, `upload_max_filesize`,`post_max_size`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T13:11:04.123

问题是，它不是很实用。首先你有一个问题，当你遇到浏览器问题时，你必须重新开始上传。当您上传大文件时，可能会发生这种情况。

这是 Ajax 的另一个解决方案：

[php 上传大文件](https://stackoverflow.com/questions/11590395/php-uploading-large-files)
[AX-JQuery Uploader](http://code.google.com/p/ax-jquery-multiuploader/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-29T13:15:04.573

我不认为网络上传是针对 5gb+ 类型的文件，或者浏览器会愉快地传输这种信息。文件系统限制也是一个问题。您应该根据使用场景考虑/重新考虑文件上传。网络是唯一的选择吗？FTP、流式传输、远程转储可能是更好的解决方案，在传输时不会阻止您的网络服务器/网页。HTTP 不是最好的协议。

认为浏览器、PHP 和 Apache 它们的内存都是有限的。当 chrome 每页使用超过 250 MB（这不正常）时，我的防病毒软件会向我发出警告。PHP 有一个默认的 128 MB 专用内存，想象一下有 100 个 Apache 用户同时上传 5GB 文件。这就是他们发明FTP的原因。

为什么你认为 PHP、apache 中存在这些限制……？因为是一种攻击方式，一个安全问题和一种阻止服务器的方式，可以很容易地被......每个人利用。

# drupal-6 - 从刚刚创建的节点获取数据并将其传递给 url

> ID：13122220
> 
> 赞同：2
> 
> 时间：2012-10-29T13:02:50.980
> 
> 标签：drupal-6

我需要创建一个将在保存某个内容类型节点后触发的操作，我需要脚本从提交的节点收集 zip 位置数据并将其提交到视图 ulr

这是插入数据的表单。

```
<fieldset class="location">
  <legend>Location</legend>
  <div id="edit-locations-0-postal-code-wrapper" class="form-item">
    <label for="edit-locations-0-postal-code">
      Postal code:
      <span title="This field is required." class="form-required">*</span>
    </label>
    <input type="text" class="form-text required" value="" size="16"
           id="edit-locations-0-postal-code" name="locations[0][postal_code]" 
           maxlength="16">
  </div>
</fieldset> 
```

这是我要插入数据的网址

www.mysite.com/testview?distance[postal_code]=DATA_GOES_HERE

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T11:33:35.530

你必须选择：

1）安装模块：[令牌](http://drupal.org/project/token)+[规则](http://drupal.org/project/rules)

启用模块后，请按照以下一般步骤操作：

*   创建新规则
*   事件：保存新内容后
*   添加条件：节点：内容具有类型（选择您希望此规则适用的内容类型）
*   添加一个动作：系统：页面重定向
*   使用令牌替换模式来构建您希望重定向的 URL（您应该可以访问所有节点字段，包括 CCK 字段）

2）在您的自定义模块中实现[hook_nodeapi()](http://api.drupal.org/api/drupal/developer%21hooks%21core.php/function/hook_nodeapi/6)

通过实现这个钩子，你可以访问 $node 对象，传递给钩子的第二个参数`$op`告诉你正在执行什么操作。在您的情况下，您可能对以下内容感兴趣：

> “插入”：节点刚刚被创建（插入到数据库中）。

您的问题与此问题非常相似，因此请看一下：[Redirect a user after the node has been saved](https://drupal.stackexchange.com/questions/7138/redirect-a-user-after-the-node-has-been-saved)

# html - 绝对元素继承父宽度，但我希望它根据其子元素进行拉伸

> ID：13122230
> 
> 赞同：3
> 
> 时间：2012-10-29T13:03:27.507
> 
> 标签：html, css

我正在构建一个像这样的 jsfiddle 的 CSS 菜单：http: [//jsfiddle.net/YXT7j/48/](http://jsfiddle.net/YXT7j/48/)

HTML：

```
<ul id="nav">
<li><a>item 1</a>
    <ul class="sub" style="width: 200px;">
        <li><a>item 1.1</a>
            <ul>
                <li><a>item 1.1.1</a></li>
                <li><a>item 1.1.2</a></li>
                <li><a>item 1.1.3</a></li>
            </ul>
        </li>
        <li><a>item 1.2</a>
            <ul>
                <li><a>item 1.1.1</a></li>
                <li><a>item 1.1.2</a></li>
                <li><a>item 1.1.3</a></li>
            </ul>           
        </li>
    </ul>
</li>
<li><a>item 2</a>
    <ul class="sub">
        <li><a>item 2.1</a></li>
        <li><a>item 2.2</a></li>
        <li><a>item 2.3</a></li>
    </ul>  
</li>
<li><a>item 3</a>
    <ul class="sub">
        <li><a>item 3.1</a></li>
        <li><a>item 3.2</a></li>
        <li><a>item 3.3</a></li>
    </ul>  
</li>
</ul> 
```

CSS：

```
#nav>li {
    float: left; 
    margin: 0 10px;   
    position: relative;   
}
.sub {
    display: none;    
    position: absolute;
    top: 1em;
    left: 0;
}
.sub>li {
    float: left; 
    width: 100px;        
}
#nav>li:hover .sub {
    display: block;
} 
```

​ ​</p>

在第 1 项下，您可以看到 2 个列表彼此相邻。同样在 html 中，您会看到一个内联宽度集。如果没有内联宽度（或等效的 css），列表将显示在彼此下方而不是彼此相邻（[http://jsfiddle.net/YXT7j/34/](http://jsfiddle.net/YXT7j/34/)）。

现在子菜单中的列表数量是动态的。这就是为什么我不能在 css 中设置宽度，而我现在使用的是内联样式（100*numlists+'px'）。但这只是丑陋的。我希望子菜单像任何其他元素一样调整为其 li-children 的大小。不幸的是，如果没有设置宽度，子菜单将遵循其父菜单项的宽度。

所以，tl/dr：如何在 ul.sub 上不设置明确宽度的情况下获得[http://jsfiddle.net/YXT7j/48/ 。](http://jsfiddle.net/YXT7j/48/)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-30T12:33:27.380

这是我的解决方案的 js-fiddle：http: [//jsfiddle.net/YXT7j/66/](http://jsfiddle.net/YXT7j/66/)

您必须在子菜单内联块中制作列表，而不是浮动它们。然后你告诉子菜单不要用空格包装内联项目： nowrap;

这是我以前在其他问题上看到的类似答案。尽管这些答案是为了防止文本（该标准是内联的）包装，而不是完整的块元素。

因此，为了完整起见，代码：

```
<ul id="nav">
    <li><a>item 1</a>
        <ul class="sub multi">
            <li><a>item 1.1</a>
                <ul>
                    <li><a>item 1.1.1</a></li>
                    <li><a>item 1.1.2</a></li>
                    <li><a>item 1.1.3</a></li>
                </ul>
            </li>
            <li><a>item 1.2</a>
                <ul>
                    <li><a>item 1.1.1</a></li>
                    <li><a>item 1.1.2</a></li>
                    <li><a>item 1.1.3</a></li>
                </ul>           
            </li>
        </ul>
    </li>
    <li><a>item 2</a>
        <ul class="sub">
            <li><a>item 2.1</a></li>
            <li><a>item 2.2</a></li>
            <li><a>item 2.3</a></li>
        </ul>  
    </li>
    <li><a>item 3</a>
        <ul class="sub">
            <li><a>item 3.1</a></li>
            <li><a>item 3.2</a></li>
            <li><a>item 3.3</a></li>
        </ul>  
    </li>
</ul>
​ 
```

​</p>

```
#nav>li {
    float: left; 
    margin: 0 10px;   
    position: relative;   
}
.sub {
    display: none;    
    position: absolute;
    top: 1em;
    left: 0;

    white-space: nowrap;
}
.sub>li {
    width: 100px;   
}
.multi.sub>li { 
    display: inline-block;
}
#nav>li:hover .sub {
    display: block;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T13:24:16.543

当您等待更好的答案时，一个 hacky 解决方案是这样做：

```
#nav>li:hover .sub {
    display: block;
    width:1000%;
} 
```

[http://jsfiddle.net/YXT7j/39/](http://jsfiddle.net/YXT7j/39/)

# css - Font-Awesome 如何让字体按比例缩放？

> ID：13122231
> 
> 赞同：11
> 
> 时间：2012-10-29T13:03:30.670
> 
> 标签：css, font-awesome

我正在拼命地让我的放大镜字体把它渲染得更大。下面的代码在 Firefox 中运行良好，但在 Chrome 或 IE9 中运行良好。

我错过了什么？

```
.icon-larger
{
   font-size:50px;
}

<div class="search-icon"><i class="icon-search icon-larger"></i></div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-06T11:07:43.163

查看此[页面](http://fortawesome.github.io/Font-Awesome/examples/)并查看缩放图标大小的示例。

您最多可以将其放大 5 倍。

例子：

```
<i class="fa fa-camera-retro fa-lg"></i> fa-lg
<i class="fa fa-camera-retro fa-2x"></i> fa-2x
<i class="fa fa-camera-retro fa-3x"></i> fa-3x
<i class="fa fa-camera-retro fa-4x"></i> fa-4x
<i class="fa fa-camera-retro fa-5x"></i> fa-5x 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-07T02:11:12.267

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-02T08:32:52.080

老问题，但我有同样的问题，似乎我忘了包括 Font Awesome css 例如：`<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet">`

您仍然会看到该图标，但如果缺少该图标，它将不会缩放。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T13:52:40.900

添加`display:block`或`display:inline-block`

# install4j - 通过脚本动态设置 TextArea 文本

> ID：13122235
> 
> 赞同：1
> 
> 时间：2012-10-29T13:03:54.503
> 
> 标签：install4j

[这是安装屏幕上控制台输出](https://stackoverflow.com/questions/13068395/console-output-on-installation-screen)的后续问题吗？

我已经配置了一个包含文本区域组件（“log.display”）的屏幕，它应该显示我安装过程中发生的事情。安装在附加到此屏幕的脚本中运行。完成安装步骤后，我执行以下操作（之前已初始化 displayLog）：

```
 displayLog = displayLog + currentStep + " done. \n";
    context.setVariable("log.display",displayLog); 
```

不幸的是，文本区域组件不会因此而更新。我可以（必须）做什么来从我的脚本动态更新文本区域？

**编辑：**

我发现：

```
 formPanelContainer = (FormPanelContainer)context.getScreenById(<screenID>); 
    formPanelContainer.getFormEnvironment().reinitializeFormComponents(); 
```

这似乎可行，但有一个问题：如果使用此解决方案显示的“日志”包含的行数超过了文本区域可以显示的行数，它会显示垂直滚动条，但不会自动滚动到最后一行。有没有办法让文本区域做到这一点？

还有一个问题：是否可以在不指定 screenID 的情况下询问当前屏幕的上下文（可以更改什么）？

谢谢！坦率

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T11:52:32.250

The solution for my problem seems to be: get the ConfigurationObject of the TextArea component:

```
FormPanelContainer formPanelContainer = (FormPanelContainer)context.getScreenById(<ScreenID>);
FormEnvironment formEnvironment = formPanelContainer.getFormEnvironment();
FormComponent logComponent = formEnvironment.getFormComponentById(<TextAreaComponentID>);
JTextArea logComponentObject = (JTextArea)logComponent.getConfigurationObject(); 
```

and each time, something has to be logged:

```
logComponentObject.append("Text to log" + "\n");
logComponentObject.setCaretPosition(logComponentObject.getDocument().getLength()); 
```

This works fine in my setup.

# security - 提供到管理区域的公共链接 - 坏主意？

> ID：13122239
> 
> 赞同：0
> 
> 时间：2012-10-29T13:04:08.627
> 
> 标签：security

我有一个客户要求我们在主（公共）网站上添加指向系统管理区域的链接，以便他们可以访问该网站并单击 URL。

你会认为这是一个坏主意吗？我觉得他们不记得去 /admin 有点奇怪 - 看起来很像你在邀请某人尝试闯入，不是吗？

我一直在尝试想出一些其他的方法。如果是我，我只会将其添加为书签，但是我的客户是一个......'老先生'的财团，几乎没有计算知识。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:51:03.077

虽然我无法想象这真的可以被描述为“良好做法”，但通过*不*公开链接行政区域为您提供的额外“安全性”似乎相对微乎其微。

由于常见的“管理区域”类型路径数量有限 - `/admin`、`/administrator`等`/admincp`，并且（假设您的问题没有被审查）您确实在使用其中一个，您可能只是将最业余的人拒之门外攻击者通过不链接到它，并且您希望他们会被您在管理区域中肯定拥有的登录机制击败。

其余更坚定的对手无疑会设法找到管理员。无论您是否链接到公共路径，都可以通过简单地探测公共路径来实现该区域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T18:14:06.010

拥有指向管理区域的链接本身并不是安全风险。如果您在保护管理区域方面做得很好，那么公开地址真的没关系。如果将 URL 设为私有可提高安全性，则意味着您处于危险之中。

# php - JSON编码几个数组

> ID：13122241
> 
> 赞同：1
> 
> 时间：2012-10-29T13:04:21.823
> 
> 标签：php, json

我正在使用 JSON_encode 将数据发送到 js 文件以获取曲目。一个用户可能有一个或多个轨道，这就是问题所在。不知道如何组织我的阵列以允许多个阵列。我不能在数组中使用数组，因为所有 JSON 数据都需要最好分开，所以会有类似的东西；

```
track1 {ID:110232....}
track2 {ID:21402....} 
```

如果只有一首曲目，我现在所拥有的效果很好。

```
$ID = $_GET['ID'];
$result = mysql_query("SELECT * FROM tracks WHERE ID = '$ID' ORDER BY timestamp DESC");
while($row = mysql_fetch_array($result)){
    $T_ID = $row['T_ID'];
    $T_url = $row['url'];
    $T_name = $row['name'];
    $T_timestamp = $row['timestamp'];
    $arr = array('T_ID' => $ID,'T_name' => $T_name, 'T_url' => $T_url, 'T_timestamp' => $T_timestamp );

    echo json_encode($arr);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:07:45.220

为什么不能像这样在容器数组中使用（关联）数组：

```
$cont = array();
while($row = mysql_fetch_array($result)){
  $T_ID = $row['T_ID'];
  $T_url = $row['url'];
  $T_name = $row['name'];
  $T_timestamp = $row['timestamp'];
  $arr = array('T_ID' => $ID,'T_name' => $T_name, 'T_url' => $T_url, 'T_timestamp' => $T_timestamp );

  $cont[] = $arr;
}

echo json_encode($cont); 
```

这会产生一个像这样的 JSON 结构，它将所有曲目保存在单独的对象中：

```
[ 
  {'T_ID': 1, 'T_name': 1, ... },
  {'T_ID': 2, 'T_name': 2, ... },
  {'T_ID': 3, 'T_name': 3, ... },
  ...
] 
```

^(如评论中所述，您应该切换到[PDO](http://php.net/pdo)或[mysqli-](http://php.net/mysqli)函数，但这对于手头的问题无关紧要。).

# vb.net - 在 vb .net，VS 2008 中使用 oledb 在 oracle 数据库中插入值

> ID：13122243
> 
> 赞同：0
> 
> 时间：2012-10-29T13:04:30.247
> 
> 标签：vb.net, oledbconnection

```
Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
        Dim insertOk As Boolean = True
        Dim con1 As OleDb.OleDbConnection
        Dim cmd As OleDb.OleDbCommand
        Dim query As String
        Dim temp As Integer
        con1 = New OleDb.OleDbConnection("Provider=MSDAORA.1;Data Source=localhost;Persist Security Info=True;Password=sys;User ID=nitishok")

        con1.Open()

        query = "insert into APPLICANTS(APPLICANT_ID,FIRST_NAME,MIDDLE_NAME,LAST_NAME,SEX,F_H,TOWN,TALUKA,DISTRICT,LANDLINE,MOBILE,BLOOD_GROUP,EDU,DOB) values(:aid,:fn,:mn,:ln,:s,:fh,:tw,:tl,:ds,:land,:mob,:bg,:edu,:dob)"

        cmd = New OleDb.OleDbCommand(query, con1)

        cmd.Parameters.Add(":aid", OleDb.OleDbType.VarChar).Value = TextBox7.Text
        cmd.Parameters.Add(":fn", OleDb.OleDbType.LongVarChar).Value = TextBox1.Text
        cmd.Parameters.Add(":mn", OleDb.OleDbType.LongVarChar).Value = TextBox12.Text
        cmd.Parameters.Add(":ln", OleDb.OleDbType.LongVarChar).Value = TextBox11.Text
        cmd.Parameters.Add(":s", OleDb.OleDbType.LongVarChar).Value = ComboBox1.Text
        cmd.Parameters.Add(":fh", OleDb.OleDbType.LongVarChar).Value = TextBox2.Text
        cmd.Parameters.Add(":tw", OleDb.OleDbType.LongVarChar).Value = TextBox10.Text
        cmd.Parameters.Add(":tl", OleDb.OleDbType.LongVarChar).Value = TextBox8.Text
        cmd.Parameters.Add(":ds", OleDb.OleDbType.LongVarChar).Value = TextBox9.Text
        cmd.Parameters.Add(":land", OleDb.OleDbType.LongVarChar).Value = TextBox5.Text
        cmd.Parameters.Add(":mob", OleDb.OleDbType.LongVarChar).Value = TextBox6.Text
        cmd.Parameters.Add(":bg", OleDb.OleDbType.LongVarChar).Value = ComboBox2.Text
        cmd.Parameters.Add(":edu", OleDb.OleDbType.LongVarChar).Value = TextBox4.Text

        cmd.Parameters.Add(":dob", OleDb.OleDbType.Date).Value = DateTimePicker1.Value

        cmd.CommandType = CommandType.Text
        temp = cmd.ExecuteNonQuery()

        If temp > 0 Then
            MessageBox.Show("Record Added!")
        Else
            MessageBox.Show("Record Not Added!")
        End If

        con1.Close()
    End Sub 
```

我对 vb .net 完全陌生。我为我的学期工作做了一个简单的项目。

请向我解释如何插入值。

我得到这个错误 ORA-01008: not all variables bound....

我正在使用 vb.net VS 2008 oracle 数据库 oledb 连接

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:36:19.833

使用问题 (?) 占位符而不是命名参数，因为您使用的是`System.Data.OleDb`. 我建议下载 ODP.NET - [Oracle Data Provider for .NET](http://www.oracle.com/technetwork/topics/dotnet/index-085163.html)。

例如，

```
query = "insert into APPLICANTS(APPLICANT_ID,FIRST_NAME) values(?,?)"
cmd.Parameters.Add("?", OleDb.OleDbType.VarChar,30).Value = TextBox7.Text
cmd.Parameters.Add("?", OleDb.OleDbType.LongVarChar,40).Value = TextBox1.Text
.... 
```

# javascript - 在 Blogger Post 中显示 Javascript 和 HTML 的结果

> ID：13122245
> 
> 赞同：1
> 
> 时间：2012-10-29T13:04:34.020
> 
> 标签：javascript, html, blogger

这是我拥有的 javascript 和 html 代码。

```
function convertinput() {
    document.getElementById('first').value
    var string = document.getElementById('first').value
    var newString = "@@[0:1: " + string + "]]"
    document.getElementById('output').value = newString
} 
```

​</p>

```
<input id="first"></input>
<br>
<input id="output"></input>
<br>
<input type='button' onclick='convertinput()' value='convert'>
​ 
```

jsfiddle 中的代码编辑器是[http://jsfiddle.net/FEC7S/3/](http://jsfiddle.net/FEC7S/3/)

我希望此代码显示在我的博客文章中，因为它在这里 [http://www.trickiezone.com/2012/10/facebook-blue-text-generator-by.html](http://www.trickiezone.com/2012/10/facebook-blue-text-generator-by.html)

如果我通过 jsfiddle 或 tinkerbin 将它嵌入到我的博客中，整个网页就会显示出来。我只需要将结果显示在我的博客文章中。
怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:44:15.610

我在我的博客中添加了工作演示：

[由 miliodiguine 签署](http://milindanantwar.blogspot.in/)

去做：

1) 登录您的博客。

2）添加新帖子

3）粘贴此代码

```
<div dir="ltr" style="text-align: left;" trbidi="on">
<br />
<script language="javascript" type="text/javascript">
function convertinput() {
    document.getElementById('first').value
    var string = document.getElementById('first').value
    var newString = "@@[0:1: " + string + "]]"
    document.getElementById('output').value = newString
}
</script>

<input id="first"></input>
<br>
 <input id="output"></input>
<br>
<input type='button' onclick='convertinput()' value='convert'>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:28:23.993

您可以使用您的 id 在 css 中设置显示属性...

```
function convertinput() {
    document.getElementById('output').value = "@@[0:1: " + document.getElementById('first').value + "]]";
   document.getElementById('output').style.display = 'block';
}

<input id="first"></input>
<br>
<input id="output" style="display:none;"></input>
<br>
<input type='button' onclick='convertinput()' value='convert'> 
```

[http://jsfiddle.net/FEC7S/7/](http://jsfiddle.net/FEC7S/7/)

# iphone - 如何提高 iOS 应用程序的性能？

> ID：13122249
> 
> 赞同：0
> 
> 时间：2012-10-29T13:04:47.657
> 
> 标签：iphone, objective-c, ios, ipad

我开发了一个适用于 iPhone-3GS、iPhone-4、iPhone-4S 的应用程序。

启动过程，**iPhone-4s 需要 30 秒，** iPhone-3gs需要**50-55 秒**。在同一网络上测试。（它不是与网络或互联网有关的问题；**在模拟器中只需要 5 秒。**）

在这个启动过程中，App 会执行一些操作，例如从数据库中删除旧数据、调用 WebService 并将响应数据插入到数据库中。**应用程序使用 performSelectorOnMainThread 方法（顺序）在主线程上**调用近 8 个 Web 服务。

我正在使用 SQLite 和编译查询结构进行插入。我想提高应用程序的性能，并希望减少应用程序的启动时间。

Android 团队使用相同的后端，他们也在做同样的事情。仅在 Galaxy note 上需要 20 秒**（团队 android 正在使用对象关系模式与 Sqlite 数据库进行通信）**。

这是性能更快的原因吗？

在处理 Sqlite（特定于处理器，耗时更少）时，是否有任何与 Java 中的 ORM 相同的方法来提高 Objective-C 的性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:11:38.503

首先，您不应该在主线程上进行网络操作（Web 服务调用）。这应该在后台线程上完成。我对直接使用 SQLite 知之甚少，但使用 CoreData，您可以在后台线程上进行“数据库”更新，然后使用主线程将两者合并`ManagedObjectContexts`。

我想将您的 WS 调用移动到后台线程（顺便说一句，AFNetworking 是一个很棒的框架），您会看到很多改进。

我的一个例子是一个基于 Web 服务的应用程序，它从 SQL Server DB 获取 7000 条记录并创建一个 NSArray（数据以 JSON 形式出现），该过程需要 7-10 秒。我通过同时执行我的自动身份验证过程进一步减少对用户的影响。

30 秒太长，无法让用户等待 IMO。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-03T15:32:22.767

此处提供 14 个最佳技巧[提高 iOS 应用性能的最佳步骤](http://code-ios.blogspot.in/2014/12/tips-to-increase-performance-of-ios-apps.html)

在本教程中，第 13 点提供了您需要的信息。

# c - CGI c文件打开

> ID：13122250
> 
> 赞同：0
> 
> 时间：2012-10-29T13:04:50.750
> 
> 标签：c, file, cgi

我在c中创建了一个cgi文件。我有一个 html 文件，用户可以在其中选择他/她要上传的文件。

问题是当我选择文件时，文件的值只是文件名而不是目录，所以我无法读取文件。

我应该如何访问该文件？

```
<form action="./cgi-bin/paperload.cgi" method="get">
                <pre>Title: <input type="text" name="title"><br></pre>
                <pre>Author: <input type="text" name="author"><br></pre>
                <pre>File: <input type="file" name="file"><br></pre>
                <pre><input type="submit" value="Upload paper"></pre>
            </form> 
```

c - cgi代码

```
 void getParam(const char *Name, char Value[256]) { 
    char *pos1 = strstr(data, Name); 

    if (pos1) { 
    pos1 += strlen(Name); 
    if (*pos1 == '=') { // Make sure there is an '=' where we expect it 
        pos1++; 
         while (*pos1 && *pos1 != '&') { 
            if (*pos1 == '%') { // Convert it to a single ASCII character and store at our Valueination 
                *Value++ = (char)ToHex(pos1[1]) * 16 + ToHex(pos1[2]); 
                pos1 += 3; 
            } else if( *pos1=='+' ) { // If it's a '+', store a space at our Valueination 
            *Value++ = ' '; 
            pos1++; 
            } else { 
            *Value++ = *pos1++; // Otherwise, just store the character at our Valueination 
                } 
        } 

             *Value++ = '\0';
             return; 
        } 
        } 

    strcpy(Value, "undefine");  // If param not found, then use default parameter 
    return; 
} 
```

主要代码

```
 // check for a correct id 
data = getenv("QUERY_STRING");

getParam("title",paper->author_name);
getParam("author",paper->paper_title);

getParam("file",paper->paper_file_name);
paper_file = fopen(paper->paper_file_name, "r+");
if (paper_file) {

            // we continue to read until we reach end of file
            while(!feof(paper_file)){
                fread(paper->paper_content,BUFSIZ, 1, paper_file);
            }
            //close the file
            fclose(paper_file);
        }
        else {
            fprintf(stderr, "Unable to open file %s", paper->paper_file_name);
            exit(-1);
        } 
```

即使我使用 POST 方法，问题仍然存在。问题不在于如何解析来自 html 的输入。问题是当我尝试在主代码中进行操作时。

如果我将 html 中的类型从文件更改为文本并尝试手动提供文件的路径，语法应该如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:33:41.367

您不需要目录信息，文件内容附加到 POST 请求，您需要从那里获取它。我建议你使用[cgic](http://www.boutell.com/cgic/)和[qdecoder](http://www.qdecoder.org/wiki/qdecoder)作为 CGI 库来为你处理这个过程。或者您至少可以了解他们如何解析请求标头，并且可能在您自己的应用程序中应用相同的逻辑。

Qdecoder 上传文件示例：[http ://www.qdecoder.org/releases/current/examples/uploadfile.c](http://www.qdecoder.org/releases/current/examples/uploadfile.c)

# ruby-on-rails - Capistrano sudo 密码提示

> ID：13122258
> 
> 赞同：2
> 
> 时间：2012-10-29T13:05:29.033
> 
> 标签：ruby-on-rails, ruby, capistrano

我对 capistrano 和 sudo 提示密码有疑问。当我运行`cap deploy`它时，它要求我输入 sudo 密码，但我输入它并按回车键，但它似乎仍在等待更多输入。我怎么知道我已经打字了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:13:04.673

部署过程不是向您询问密码，而是从远程服务器上的执行过程中询问密码，因此您无法访问远程提示。我曾经遇到过这个问题。一些解决方案：

*   （坏的）。在 deploy.rb 中使用 sudo_password
*   （好的）。设置完全不使用 sudo 访问的权利和权限。

第二个建议好多了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-28T02:36:57.060

您是否在 deploy.rb 中尝试过这个？

```
default_run_options[:pty] = true 
```

# ruby-on-rails - Rails 嵌套表单和模型继承

> ID：13122261
> 
> 赞同：1
> 
> 时间：2012-10-29T13:05:55.597
> 
> 标签：ruby-on-rails, inheritance, nested, nested-forms, polymorphic-associations

我是 Rails 新手，我试图了解是否可以同时使用嵌套模型表单（如 Railscasts #196-197 中）和模型继承。

我正在开发一个应用程序来创建类似于[Google Form](https://docs.google.com/spreadsheet/newform?usp=apps_start&hl=en)的问卷调查。

我有带有标题和一组问题的模型问卷。所以 Question 是 Questionnaire 的嵌套模型（可以在创建问卷时添加和删除问题）。

但就像在谷歌表单中一样，有几种类型的问题取决于几种类型的答案（文本字段、复选框、单选框等）。所以我想为问题的所有子类（Question_text，Question_checkbox，...）创建几个模型。但我不确定这是处理这种情况的正确方法以及如何实施它。

# android - 不同的分辨率与dpi

> ID：13122262
> 
> 赞同：3
> 
> 时间：2012-10-29T13:06:10.210
> 
> 标签：android, resolution, dpi

我想获得有关使用不同分辨率图形或使用倾角大小调整它们的建议、利弊。

我的意思是，如果我的应用程序将具有所有可能的分辨率，一种方法是为每个 ldp/mdp/hdp/xhdp 创建 png，但我认为为了节省维护应用程序的工作和时间，可能更容易，包括具有最大分辨率、xhdp 的 png，并根据屏幕在 .xml 或 .java 中使用 dip 或相对大小指定大小。

你对此有何看法？优点和缺点？

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-31T11:26:32.027

缺点（反对只有一种大小）：不必要地使用内存。图像是需要大量内存的对象，当您将其分辨率乘以两倍时，您的内存成本就会乘以 4。低分辨率设备的内存也可能更少，加载不必要的大图像可能会导致内存异常。

# c++ - FreeType“通用”与 c++/cx 关键字冲突

> ID：13122266
> 
> 赞同：11
> 
> 时间：2012-10-29T13:06:21.667
> 
> 标签：c++, windows-runtime, freetype, c++-cx

我在将 c++ 和 c++/cx 放在一起时遇到问题。我需要使用 FreeType 库，但他们对某些变量使用“通用”名称。我还需要启用 VC++ 扩展，因为 WinRT 应用程序会导致名称冲突（通用是 c++/cx 中的关键字）

```
1>freetype2\include\freetype\freetype.h(1391): error C2059: syntax error : 'generic' 
```

我只在我的项目属性中添加了 freetype 引用和附加的包含目录。

有什么办法可以解决这种情况吗？谢谢你的帮助:) 托马斯

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-29T13:09:48.183

使用预处理器临时重命名此关键字：

```
#define generic GenericFromFreeTypeLibrary
#include .... files from FreeTypeLibrary
#undef generic 
```

这个解决方案不是很好，但应该可以。

# apache - 使用 Google Drive Directory 作为 Apache 虚拟主机

> ID：13122267
> 
> 赞同：4
> 
> 时间：2012-10-29T13:06:22.680
> 
> 标签：apache, wamp, virtualhost, google-drive-api

我正在尝试使用我的 google 驱动器文件夹设置 Apache 2.4 服务器。我已经使用 Dropbox 完成了它并且工作正常，但是使用谷歌驱动器，Apache 无法找到该目录。

经过一番研究，我发现 google drive 文件夹的真实路径在

> C:\Users\ME\AppData\Local\Google\Drive\sync_config.db

但这都是编译的。有没有办法获得路径？

我已经尝试过使用这个 KiXtart 脚本：

> [http://www.kixtart.org/forums/ubbthreads.php?ubb=showflat&Number=204938](http://www.kixtart.org/forums/ubbthreads.php?ubb=showflat&Number=204938)

...这不再起作用了。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-21T18:05:14.653

这是一个权限问题。右键单击“Google Drive”文件夹 -> 属性 -> 安全选项卡 -> 高级 -> 更改权限... -> 选中“包括来自父文件夹的可继承权限”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-17T07:29:25.123

这只是一个权限问题。更改 Google Drive 文件夹的权限以继承父文件夹的所有权限，然后您就可以开始了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T14:47:55.557

您可以将 google 驱动器文件夹映射到驱动器，然后将 wmap/虚拟主机安装到此路径：

```
subst x: "C:\{pathname}\{foldername}" 
```

编辑：在 {foldername} 中添加引号括起空格（例如 /Google Drive/）

# iphone - Shell脚本调用错误xcode 4.5.1

> ID：13122268
> 
> 赞同：0
> 
> 时间：2012-10-29T13:06:28.343
> 
> 标签：iphone, objective-c, ios, xcode

当我尝试在设备上运行我的应用程序时，出现以下错误。

```
CodeSign error: code signing is required for product type 'Application' in SDK 'iOS 6.0'. 
```

将构建设置中的任何 ios sdk 更改为 iPhone Developer 后，现在出现以下错误。

```
/Users/chandrasekhar/Library/Developer/Xcode/DerivedData/UnitConverter-
dhznawqrnkbqwvcrkgpzpkjmooox/Build/Intermediates/UnitConverter.build/Debug-
iphoneos/UnitConverter.build/Script-50524F424C454D533F.sh: line 4: 
/Library/JailCoder/Entitlements/Entitlements.py: No such file or directory 
```

帮我解决这个错误。重新安装 Xcode 不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T14:26:23.713

再次下载 Jailcoder 并 Unpatch 项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:18:18.433

看起来该脚本正在使用[JailCoder](http://jailcoder.com/)，它似乎没有安装（或需要重新安装）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-15T07:54:59.033

知道了！我无法让 jailcoder 取消补丁，所以你必须做的是进入构建阶段，一旦你花时间深入了解应用程序的内容，就可以很容易地删除将 jailcoder 插入构建阶段的部分！

# cocoa-touch - 使用 CIRandomGenerator 过滤器时，CIContext 返回 nil CGImageRef

> ID：13122269
> 
> 赞同：1
> 
> 时间：2012-10-29T13:06:35.757
> 
> 标签：cocoa-touch, cocoa, core-image, cifilter

我正在尝试使用以下代码获取 CoreImage CIRandomGenerator 过滤器的输出：

```
CIContext *context = [CIContext contextWithOptions:nil];

CIFilter *randomNoise = [CIFilter filterWithName:@"CIRandomGenerator"];
[randomNoise setDefaults];

CIImage *output = randomNoise.outputImage;

// This returns nil
CGImageRef ref = [context createCGImage:output
                               fromRect:output.extent];
self.photoView.image = [UIImage imageWithCGImage:ref];
CGImageRelease(ref); 
```

然而，createCGImage:fromRect: 总是返回一个 nil CGImageRef。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T05:32:26.643

你需要确保裁剪`extent`它，使其不是无限的。

# r - 如何使用 r 将饼图添加到地理地图

> ID：13122273
> 
> 赞同：1
> 
> 时间：2012-10-29T13:06:53.343
> 
> 标签：r, dictionary, pie-chart, rworldmap

在与一些地图苦苦挣扎之后，我来到了我不知道的地步。我想将饼图添加到地理地图。

这是我的数据：

```
 zip city      state  latitude   longitude   plan_chosen
  10001 New York    NY  40.75074    -73.99653   3
  10001 New York    NY  40.75074    -73.99653   1
  10001 New York    NY  40.75074    -73.99653   1
  10017 New York    NY  40.75216    -73.97231   3 
```

这也适用于其他位置。我想做的是定义一个plan_chosen的饼图。这由数字 1 到 4 组成，我想把这个饼图放在纽约地区和其他一些选定地区的州地图上。我真的找不到有关如何执行此操作的教程，也不知道最好使用哪个包。只是为了映射我一直在使用包地图

我使用此代码来定义地图

```
map('state', fill=FALSE, col="#cccccc") 
```

在此我想添加 3 到 4 个饼图。我是否需要进一步修改数据或哪个包有用？

我一直在尝试包 rworldmap 和这段代码

```
mapPies( tel,nameX="longitude", nameY="latitude" , nameZs=plan_chosen,mapRegion='america' , add=TRUE) 
```

但在这里我的问题是它不会把馅饼分成 4 部分，它只是把它涂成黑色。有什么建议或帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T18:25:14.450

plotrix 包中有一个函数可以创建浮动饼图。但请注意，该函数的作者不鼓励使用它们，他写它是为了表明 R 可以下降到制作与 excel 一样无用的图，希望用户随后可以转换为更好的方式来呈现他们的数据。

您还可以使用`subplot`TeachingDemos 包中的功能将任何类型的图表添加到现有绘图（地图）中，因此它可以与饼图或其他更有用的图表一起使用。还可以查看`my.symbols`同一包中的函数，了解将信息添加到现有绘图/地图的其他方法。

其他人提到了爱德华·塔夫特（很好的建议），但也寻找威廉·克利夫兰研究不同类型地块的有效性（或缺乏有效性）。

# javascript - 验证 ssl 证书/密钥的格式

> ID：13122275
> 
> 赞同：2
> 
> 时间：2012-10-29T13:07:02.900
> 
> 标签：javascript, perl, ssl

我有一个简单的控制面板的 web 表单，用户可以在其中输入他们的 ssl 证书以在新的虚拟主机上使用，有没有办法在将证书添加到 webserver 配置之前检查证书至少以正确的格式和密钥对证书有效。

我必须使用 perl 或 javascript。

寻找正确的方向来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T13:11:21.373

听起来像[Crypt::OpenSSL::X509](http://search.cpan.org/~daniel/Crypt-OpenSSL-X509-1.800.2/X509.pm)可以帮助 perl 实现..

# ios5 - 如何在 iOS 6 (XCode 4.5) 中为 iPhone 4 创建 UI？

> ID：13122293
> 
> 赞同：0
> 
> 时间：2012-10-29T13:08:08.283
> 
> 标签：ios5, ios6, iphone-4, iphone-5

我必须创建一个新应用程序，并且我使用的是 X Code 4.5 和 iOS 6，但是当我使用 XIB 创建一个 UIViewController 类时，它给了我 iPhone 5 的视图。我明白这一点，但我想为 iPhone 4 创建 UI也是。如何为 iPhone 4 添加 XIB？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:11:53.280

我不认为可以为 iPhone4 和 iPhone5 更改 XIB 文件。我认为您只需要`UIComponents`在XIB文件中设置，考虑到iPhone4的屏幕尺寸并设置框架`UIComponents`内的框架即`320*480`iPhone4。将其余空间留空。它适用于 iPhone 4。如果您希望应用程序也适用于 iPhone5，那么只需将属性设置为`Use AutoLayout`on。数据吧。。

# weblogic - 战争和耳朵的罐子差异

> ID：13122299
> 
> 赞同：0
> 
> 时间：2012-10-29T13:08:24.817
> 
> 标签：weblogic

我有一个包含 EJB 和 war 文件的耳朵，这个耳朵部署在 weblogic 服务器中

现在我有一个 jar，它是战争内外类的依赖项。

当我在 app/lib 和 web-inf/lib 中包含此依赖项并将其部署在 weblogic 服务器中时，我收到一个异常，提示找不到类。现在，当我从 App-INF 中排除 jar 时，删除依赖于该 jar 的 EJB 并部署它。它工作正常。

有什么方法可以将依赖项放在 APP-INF 和 WEB-INf 中，并且仍然可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:15:58.470

您希望您的 JAR 出现在 EAR 的 APP-INF/lib 级别上。这样，WAR 也会自动看到 JAR。然后，您应该不需要在 WAR 中使用您的 JAR。

否则，请在此处使用 Oracle 搜索“可选包”。您可以部署您的 JAR 并让 EAR 和 WAR 引用它。

# iphone - 在 Xcode 4.3.3 中不兼容

> ID：13122303
> 
> 赞同：0
> 
> 时间：2012-10-29T13:08:39.283
> 
> 标签：iphone

我开发了一个应用程序。我的 xcode 版本是 xcode 4.3.3。我正在使用分发证书进行应用商店提交。而我的ios开发目标是ios 3.0。在存档时，我收到了类似的错误

> “此捆绑包无效。键 uirequireddevicecapabilities 包含值 armv7 '，它与 '3.0' 的 minimumosversion 值不兼容”

所以请告诉我如何解决这个问题。在创建该分发配置证书时，我没有添加任何设备。所以有人知道是什么原因请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:30:41.287

首先，错误与您的密钥设置为`ARMv7`的事实有关，但您的目标是 iOS 3.0，因此 Apple 也希望您支持. 只需从.`info.plist``uirequireddevicecapabilities``ARMv7``ARMv6``ARMv7``info.plist`

如果您将分发配置文件设置为 AppStore，您将无法添加设备，因为此配置文件仅用于上传应用以供应用商店查看。

# iphone - SBJSON 解析器内存不足警告

> ID：13122305
> 
> 赞同：0
> 
> 时间：2012-10-29T13:08:47.000
> 
> 标签：iphone, ios, ipad, sbjson

![在此处输入图像描述](../Images/7da6c56c88013d7f9ef8280e259fbff8.png)![在此处输入图像描述](../Images/b8aaf693bb27f975cae127e37d7ce7ee.png)我正在使用大量图像下载和数据解析进行 JSON 数据解析。我有以下解析代码

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
  {   

     NSString *responseString = [[NSString alloc] initWithData:webdata encoding:NSASCIIStringEncoding];
     [webdata release];
     [connection release];
     NSDictionary *values = [(NSDictionary*)[responseString JSONValue] objectForKey:@"UserId"];
     NSDictionary *Active = [(NSDictionary*)[responseString JSONValue] objectForKey:@"Active"];
     [responseString release];
     NSString *UserID=[NSString stringWithFormat:@"%@",values];
     NSString *Status=[NSString stringWithFormat:@"%@",Active];
     [WSDelegate WServiceResponseMsg:@"WS_Authenticate_User" withResponse:UserID forParam:Status];
} 
```

我有许多具有上述代码的类用于解析，但由于 SBJSON 解析器，应用程序在一段时间后崩溃。在仪器中，由于内存不足警告，它使应用程序崩溃。![在此处输入图像描述](../Images/a7418523722cad2fe4fbbbbe780fd91d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:17:27.533

大多数开发人员在使用 SBJSONParser 时都认为它存在内存泄漏，这是一个非常错误的假设。SBJSONParser 没有任何泄漏，也不会在您的代码中引入泄漏。确实，INSTRUMENTS 告诉您泄漏是因为 SBJSONParser，但它表示其他东西。泄漏是因为您实现 SBJSONParser API 的方式。您一定在代码中做错了什么。

去你仪器的泄漏处。打开扩展详细信息工具栏，查看有泄漏的代码行。Instruments 会告诉您最近的泄漏位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:22:17.127

更好的选择是使用`NSJSONSerialization`它作为 iOS 5 及更高版本的一部分

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
  {  
    NSMutableDictionary *values = [NSJSONSerialization JSONObjectWithData:receivedData options:NSJSONReadingMutableContainers error:&error];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T07:16:07.183

终于得到了解决方案。只需使用下面的行进行 JSON 解析。删除 NSMutableDictionary 并使用 id ：

```
 NSError *jsonError = nil;

 id allValues = [NSJSONSerialization JSONObjectWithData:webdata
                                                   options:0
                                                     error:&jsonError];

 NSArray *array = [allValues objectForKey:@"Contestants"]; 
```

# performance - System.Diagnostics.Stopwatch 计时器关闭因子 3

> ID：13122308
> 
> 赞同：1
> 
> 时间：2012-10-29T13:09:06.160
> 
> 标签：performance, timer

我正在尝试使用`Stopwatch`但始终获得比实际经过时间低约 3.1 倍的时间来测量经过的时间。我无法解释为什么会发生这种情况，代码非常简单。我已经在 3 台机器上尝试了代码并获得了相同的结果（尽管硬件和软件几乎相同）。

i5-2500k、i5-2500、Windows 7 64 位、Windows 8 RTM 64 位

```
Stopwatch sw = new Stopwatch();
sw.Restart();
DateTime start = DateTime.Now;

for (int i = 0; i < 5; i++)
{
    Thread.Sleep(1000);
}

DateTime end = DateTime.Now;
sw.Stop();

Console.WriteLine("Time passed: " + StringFormatter.ToShortString(sw));
Console.WriteLine("Time passed: " + StringFormatter.ToShortString(end - start)); 
```

结果始终是〜3.1倍。

```
Time passed: 00:00:01.6347
Time passed: 00:00:05.0600 
```

延迟 10 秒：

```
Time passed: 00:00:03.2358
Time passed: 00:00:10.0100 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:15:43.353

好吧，这很愚蠢。`Stopwatch.ElapsedTicks`就像时间跨度一样被使用。需要针对打印逻辑调整分辨率。

# asp.net - 将参数传递给 sp_startjob 运行的包

> ID：13122309
> 
> 赞同：0
> 
> 时间：2012-10-29T13:09:08.763
> 
> 标签：asp.net, ssis, sql-agent-job

我们有一个通过 SQLAgent 作业运行的 SSIS 包。我们正在从 ASP.NET 网页中启动作业（通过 sp_startjob）。登录到 UI 的用户需要使用用户启动的 SSIS 包登录 - 因此我们需要将 userId 传递给 SSIS 包。问题是我们无法将参数传递给 sp_startjob。

有谁知道如何实现和/或知道上述方法的替代方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:50:59.410

它不能通过 sp_startjob 完成。您不能将参数传递给作业步骤，因此该选项已失效。

如果您不关心并发性，并且考虑到您不能同时运行相同的作业，您可以通过将作业步骤从 SQL Server Integration Services 类型更改为类似 OS 命令的方式来破解它。让操作系统命令调用网页创建/修改的批处理脚本。最终结果是您像这样启动您的包`dtexec.exe /file MyPackage /Set \Package.Variables[User::DomainUser].Properties[Value];\"Domain\MyUser\"`此时，您的包中的变量 DomainUser 将具有 Domain\MyUser 的值。

我不知道你的要求，所以也许你可以调用 .NET 框架并从网页启动你的包。尽管您可能希望确保异步调用。否则，除非您的 SSIS 包非常快，否则用户可能会尝试导航离开，垃圾邮件刷新等等待它到页面“工作”。

顺便说一句，所有这些只是将一个值推入 SSIS 包。在这种情况下，用户名。它不会传递他们的凭据，因此调用`SYSTEM_USER`会报告 SQL 代理用户帐户（或作业步骤的操作员）之类的东西。

# c++ - xmlrpc 无法访问串行端口；不同的响应（AT cmd、C++、python）

> ID：13122310
> 
> 赞同：0
> 
> 时间：2012-10-29T13:09:18.503
> 
> 标签：c++, python, serial-port, xml-rpc, at-command

我有一些 C++ 代码可以与调制解调器通信，这些代码基于使用 boost 中的串行库的类`BufferedAsyncSerial`（参见[此处）。](http://www.webalice.it/fede.tft/serial_port/serial_port.html)用这样的 C++ 短代码

```
BufferedAsyncSerial device("/dev/ttyACM0",9600);
device.writeString("AT\r");
std::cout << device.readString() << std::endl;
boost::this_thread::sleep(boost::posix_time::seconds(2));
std::cout << device.readString() << std::endl;
device.close() 
```

我能够`AT`在串行端口向模拟调制解调器发送命令，`/dev/ttyACM0`并从端口接收正确答案，即“ `OK`”。中间的睡眠是为了确保调制解调器有一些时间来处理输入。

所有这些我都包装在一个 xmlrpc 类中，以在不同的计算机上进行读/写通信（对于测试，它实际上是相同的），因此要使用`xmlrpc`python 访问该功能：

```
device = xmlrpclib.ServerProxy("http://localhost:8080/RPC2")
device.serial.open("/dev/ttyACM0")
device.serial.send("AT\r")
for i in range(100):
    time.sleep(0.1)
    print device.serial.read() 
```

在 C++ 服务器端，打开/关闭/读取/写入函数被相应地包装，端口名称和波特率相同。但是，当执行这些 python 函数时，它`AT`被发送到调制解调器（我可以通过 xmlrpc 连接读回它！），但是`OK`无论我尝试多久或多久尝试一次，都不会出现。

如果有可用的 C++/boost/serial/xmlrpc/python 专家，我将不胜感激。以下是一些额外的评论和说明：

*   使用的C++ xmlrpc服务器是abyss/xmlrpc-c，我都不熟悉
*   如果我将所有打开/写入/读取/关闭链编码在一个函数中，我无法通过 xmlrpc，我得到预期的结果
*   我检查了对实际 BufferedAsyncSerial 实例的访问是通过一个类完成的，并记录了每个命令的顺序和详细信息。它们在两种情况下都是相同的，我不会错过任何东西。
*   我还检查了我正在处理的对象是同一个对象，即在内存中具有相同的地址

# java - 从服务中检索 JNLP 文件

> ID：13122313
> 
> 赞同：1
> 
> 时间：2012-10-29T13:09:26.657
> 
> 标签：java, jnlp, java-web-start

是否有返回“调用者”.jnlp 文件的 API？我正在尝试创建一个通用安装程序（见下文，SOURCE_JNLP），它可以以编程方式访问用于启动 WebStart 客户端的 JNPL。

```
BasicService bs = (BasicService)ServiceManager.lookup("javax.jnlp.BasicService");
String myJNLPFile = new URL(bs.getCodeBase()+ "/"+SOURCE_JNLP)); 
```

谢谢，

# sql - 如何存储复杂记录以参考历史修订？

> ID：13122318
> 
> 赞同：0
> 
> 时间：2012-10-29T13:09:54.753
> 
> 标签：sql, sql-server

我的数据库中有一张表格，其中概述了[工作分解结构](http://en.wikipedia.org/wiki/Work_breakdown_structure)中的复杂流程（类似于用于创建甘特图的内容）。特定流程有多行，每行概述特定流程的分层步骤。

然后我有一个包含一些产品类型的表，每个产品类型都链接到一个特定的过程。当特定产品的订单下达时 - 将使用相关流程进行制造。

在我的情况下，这些过程可以是动态的（例如，添加或删除步骤）。

我很好奇捕获每个流程的当前和历史修订的最佳方法是什么，这样即使流程可能随着时间的推移而演变 - 我可以从历史上回到特定的顺序并确定流程的样子那时。

我确信有多种方法可以解决这个问题，使用日志记录或触发器和一个新的历史表——但我没有做过这样的事情的经验，我想知道什么对其他人有用。

# xml - 使用 XSLT 的 XML 排序问题

> ID：13122327
> 
> 赞同：0
> 
> 时间：2012-10-29T13:10:46.183
> 
> 标签：xml, xslt, sorting

我想对 xml 进行排序

我的xml格式是

```
<OTA_HotelAvailRS xmlns="http://www.opentravel.org/OTA" EchoToken="" SequenceNmbr="1" Target="Production" TimeStamp="2012-09-28T08:29:44Z" Version="1">
    <SummaryResponse>    
        <AdditionalDetails>    
           <AdditionalDetail Amount="212,20 EUR" Code="TotalPackagePrice" CurrencyCode="EUR" DecPart="20" IntPart="212" Type="PackageInformation"></AdditionalDetail>
          </AdditionalDetails>

    </SummaryResponse>
    <SummaryResponse>

       <AdditionalDetails>
          <AdditionalDetail Amount="212,20 EUR" Code="TotalPackagePrice" CurrencyCode="EUR" DecPart="20" IntPart="500" Type="PackageInformation"></AdditionalDetail>
        </AdditionalDetails>
    </SummaryResponse>
</OTA_HotelAvailRS> 
```

我正在使用的 XSL 是

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:output method="xml" version="1.0" encoding="iso-8859-1" indent="yes"/>

<xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

<xsl:template match="OTA_HotelAvailRS">
  <xsl:copy>   
    <xsl:apply-templates select="SummaryResponse/AdditionalDetails">
       <xsl:sort select="AdditionalDetail/@IntPart" data-type="number" order="descending"/>
    </xsl:apply-templates>
    Value of :<xsl:value-of select="AdditionalDetail/@IntPart" />
  </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

我想使用 AdditionalDetail 的 IntPart 属性进行排序。

请有人帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:58:45.570

这实际上不是排序问题，而是命名空间问题！在您的原始 XML 中，您指定了默认命名空间

```
<OTA_HotelAvailRS xmlns="http://www.opentravel.org/OTA" 
```

这意味着您的 XML 中的所有元素都在该名称空间内。但是，在您的 XSLT 中，您没有引用此名称空间，而是在寻找根本不在名称空间中的元素。

为了解决这个问题，您需要在 XSLT 中指定名称空间，使用您喜欢的任何字母前缀，然后为元素名称添加前缀以表明它们需要位于该名称空间中。

试试这个 XSLT

```
<xsl:stylesheet 
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0" 
     xmlns:a="http://www.opentravel.org/OTA">

   <xsl:output method="xml" version="1.0" encoding="iso-8859-1" indent="yes"/>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="a:OTA_HotelAvailRS">
      <xsl:copy>
         <xsl:apply-templates select="a:SummaryResponse/a:AdditionalDetails">
            <xsl:sort select="a:AdditionalDetail/@IntPart" data-type="number" order="descending"/>
         </xsl:apply-templates>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="a:AdditionalDetails">
     Value of : <xsl:value-of select="a:AdditionalDetail/@IntPart"/>
   </xsl:template>
</xsl:stylesheet> 
```

请注意，我还添加了一个模板来匹配**AdditionalDetails**，因为看起来您想要输出元素的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T08:49:54.803

如果您只想对`SummaryResponse`元素进行排序，则此样式表有效：

```
<xsl:stylesheet version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:ota="http://www.opentravel.org/OTA">

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="ota:OTA_HotelAvailRS">
    <xsl:copy>
      <xsl:apply-templates select="ota:SummaryResponse">
        <xsl:sort select="ota:AdditionalDetails/ota:AdditionalDetail/@IntPart" data-type="number" order="descending"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

# javascript - 使用 JavaScript 向 CSS id 添加属性

> ID：13122329
> 
> 赞同：1
> 
> 时间：2012-10-29T13:10:54.470
> 
> 标签：javascript, css, class

我有一个简单的 JavaScript，它在单击链接时更改元素的内部 HTML，它看起来像这样：

```
function changeHeader(Index)
{
    var headers = new Array("Coffee tables","Side tables","Stand tables","Dinner tables","Stools","Pedestals");
    document.getElementById("header").innerHTML = headers[Index];

} 
```

的CSS`header`如下：

```
#header
{
    cursor: hand; 
    cursor: pointer;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

HTML基本上是这样的：

```
<p id="header">Press a link</p>
<a href=# onclick="changeHeader(1)">Coffee tables</a>
<a href=# onclick="changeHeader(2)">Side tables</a>
<a href=# onclick="changeHeader(3)">Stand tables</a> 
```

等等。我的问题是我想`header`根据按下的链接在元素上使用不同的背景颜色。第一个链接可能是红色背景，第二个是蓝色，第三个是绿色，依此类推。

如何使用 JavaScript 将属性添加到已经存在的 CSS id？我不使用 jQuery，所以请只使用纯 JavaScript :)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-29T13:14:06.057

你可以使用`style`财产

```
document.getElementById("header").style.backgroundColor = 'red'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:15:54.103

你可以稍微改变你的方法：

```
function changeHeader(Index) {
    var headers = [
        {color: 'red', text: "Coffee tables"},
        {color: 'blue', text: "Side tables",
        {color: '#DDD', text: "Stand tables"},
        {color: "#ACD12A", text: "Dinner tables"},
        {color: "Chuck Norris", text: "Stools"}
    ];
    var header = document.getElementById("header"),
    header.innerHTML = headers[Index].text;
    header.style.backgroundColor = headers[Index].color;
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:14:17.770

您不需要向 ID 添加额外的属性，或者向元素添加内联样式，或者如果您不想使用内联样式，则向元素添加额外的类，这会设置正确的背景颜色。

这是一个如何在不使用 jQuery 的情况下从元素中添加/删除类的示例：http: [//snipplr.com/view/3561/addclass-removeclass-hasclass/](http://snipplr.com/view/3561/addclass-removeclass-hasclass/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:21:54.710

请参阅此页面中的示例代码：http: [//jsfiddle.net/Rd4y5/](http://jsfiddle.net/Rd4y5/)

js：

```
d = document.getElementById("d1");
console.log(d.style);
d.style.backgroundColor="red";
d.style.width = "300px";
d.style.height="300px";
    console.log(d.style); 
```

html：

```
<div id='d1'>a<div>​ 
```

# mysql - IFNULL 可以与 select 语句一起用于求和吗？

> ID：13122334
> 
> 赞同：4
> 
> 时间：2012-10-29T13:11:32.630
> 
> 标签：mysql, sql

我有两个带有十进制值的表，使用以下语句我可以将它们全部加起来并得到总数。

```
SELECT(
(SELECT SUM(total) from recruitment where quote_id = 1)
+
(SELECT SUM(cost) from cost WHERE quote_id = 1)
)AS total 
```

但是，如果任一选择返回 null 则总数为 null 所以我尝试使用 ISNULL 返回 0 而不是 null ，如下所示：

```
SELECT(
(IFNULL(SELECT SUM(total) FROM recruitment WHERE quote_id = 1),0)
+
(IFNULL(SELECT SUM(cost) FROM cost WHERE quote_id = 1),0)
)AS total 
```

这没有用，所以我只是想知道最好的方法是如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T13:12:42.733

使用[`COALESCE()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)which 返回其第一个非空参数，并且可以用零替换整个表达式。

```
SELECT(
  COALESCE((SELECT SUM(total) FROM recruitment WHERE quote_id = 1),0)
  +
  COALESCE((SELECT SUM(cost) FROM cost WHERE quote_id = 1),0)
)AS total 
```

`IFNULL()`在这种情况下应该以相同的方式工作 - 我怀疑您可能有不正确的括号导致语法错误。

```
/* Should work too. Make sure the inner SELECT is enclosed in () */
SELECT(
  IFNULL((SELECT SUM(total) FROM recruitment WHERE quote_id = 1),0)
  +
  IFNULL((SELECT SUM(cost) FROM cost WHERE quote_id = 1),0)
)AS total 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:36:31.930

尝试使用

```
 SELECT(
(SELECT IFNULL((SELECT SUM(total) FROM recruitment WHERE quote_id=1),0))
+
(SELECT IFNULL((SELECT SUM(cost) FROM cost WHERE quote_id=1), 0))
)AS total 
```

`IFNULL`是一种必须在`SELECT`语句中使用的结构，例如

```
SELECT IFNULL(expr0,expr1); 
```

并且将返回`expr1`以防万一。`expr0``NULL`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:13:10.197

`COALESCE`在总结之前使用。

```
SELECT ((SELECT SUM(COALESCE(total,0)) FROM recruitment WHERE quote_id = 1) +
        (SELECT SUM(COALESCE(cost,0)) FROM cost WHERE quote_id = 1)) AS TOtal 
```

# c# - .NET Razor 获得前一年

> ID：13122338
> 
> 赞同：0
> 
> 时间：2012-10-29T13:11:56.560
> 
> 标签：c#, asp.net, datetime

我正在为 .NET MVC3 应用程序开发一些模板，我唯一可以访问的是 cshtml 模板文件。我真的对.NET 一无所知，所以我只是想拼凑一些东西。在我的一个模板中，我需要输出上一年。

我知道我可以得到当前年份，`@DateTime.Now.Year`但我找不到任何关于如何得到上一年的信息。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-29T13:13:49.750

```
@DateTime.Now.AddYears(-1).Year; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-29T13:13:22.390

去年的今天：

```
DateTime lastYear = DateTime.Now.AddYears(-1); 
```

要不就`@DateTime.Now.AddYears(-1).year;`

# c# - 批量更新从更新返回意外的行数 - 更新行数？

> ID：13122341
> 
> 赞同：1
> 
> 时间：2012-10-29T13:12:20.213
> 
> 标签：c#, sql, fluent-nhibernate

在删除一个表后立即在表中添加新行时，我收到这样的错误：“批量更新从更新返回了意外的行数；实际行数：%x；预期：%(x+1)”，其中 x - 是删除后插入前的行数。

删除代码：

```
using (var session = factory.OpenSession())
{
    using (var transaction = session.BeginTransaction())
    {
        foreach (var row in rows)
        {
            session.Delete((Word)row.DataBoundItem);
        }
        transaction.Commit();
        session.Flush();
    }
} 
```

添加代码：

```
using (var session = factory.OpenSession())
{
    using (var transaction = session.BeginTransaction())
    {
        language.AddWord(word);
        session.SaveOrUpdate(language);
        transaction.Commit();
        session.Flush();
    }
} 
```

映射：

```
public WordMapping()
{
    Id(x => x.Id).GeneratedBy.Native();
    Map(x => x.Word1);
    Map(x => x.Word2);
        Map(x => x.Count);
        References(x => x.Language)
            .Not.LazyLoad();
} 
```

为调试而编写的 SQL 代码：

```
NHibernate: INSERT INTO [Word] (Word1, Word2, Count, Language_id) 
    VALUES (@p0, @p1, @p2, @p3); 
    select SCOPE_IDENTITY();
    @p0 = 't2' [Type: String (4000)], 
    @p1 = 't2' [Type: String (4000)], 
    @p2 = 10 [Type: Int32 (0)], 
    @p3 = 1 [Type: Int32 (0)] 
```

你能告诉我该怎么做吗？也许我应该以某种方式更新行数？

# python - 如何获得 int 的 32 位二进制补码位模式？

> ID：13122342
> 
> 赞同：1
> 
> 时间：2012-10-29T13:12:21.073
> 
> 标签：python

有没有办法获得实际的位表示，而不是垃圾'-0bx'？我需要真正能够看到这些位。它是否出现大/小端无关紧要。这是为了一个任务。有谁知道如何在python中查看整数的实际2的补码位表示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:16:20.620

因为数字不受位范围的限制，所以没有规范的“位”表示。输出将是`0b1`, `0b11111111`,`0b1111111111111111`等，具体取决于您碰巧想要的位范围。

以下会给你想要的吗？

```
> x = -1
> print(bin(x & 0xffffffff)) # 32-bit output
0b11111111111111111111111111111111 
```

注意：这不会`0`像 Ned 的建议那样用 es 填充以提供固定长度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T13:21:07.580

```
>>> x = -1
>>> "{:032b}".format(x & 0xffffffff)
'11111111111111111111111111111111' 
```

# c++ - Shell 输入作为变量

> ID：13122344
> 
> 赞同：0
> 
> 时间：2012-10-29T13:12:26.653
> 
> 标签：c++, input, parameters

我目前有一个 c++ Linux 程序，它从文件中读取参数“P”并将其加载到 RAM 中以进行进一步操作。该文件具有以下行：

```
P = 123 
```

我希望程序从 shell 输入而不是文件中获取 P。我对所有选项持开放态度，只要我可以在 SSH 连接时手动输入 P。我想到的是输入提示：

```
sudo myprogram start
enter P value : (I would manually enter "123" here) 
```

或者也许是一个论点：

```
sudo myprogram start 123 
```

做起来一定很简单，但我不知道怎么做，所以非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:37:40.393

如果这是文件具有的唯一数据，则文件操作是不必要的。只需将 123（或其他）传递给您的 C++ 程序并将字符串转换为整数。

假设您将整数作为第二个参数传递，那么：

```
int  p = atoi(argv[2]); 
```

更好的选择是使用 strtol：

```
char *s, *ptr;

s = argv[1];
int p = strtol(s, &ptr, 10); 
```

* * *

如果您无法更改 C++ 代码，那么只需执行以下操作：

```
echo "P = 123" > file && myprogram start 
```

* * *

如果您的文件有更多内容并且您不能简单地*回*显，请将现有行替换为新值：

```
 sed -i "s/P = [0-9]*/P = 123/" file && myprogram start 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:33:44.610

第一个版本（从键盘输入）：

```
echo -n "enter P value: "
read P 
```

第二个版本（作为 shell 脚本参数传递）：

```
P=$1 
```

第三版（学习 bash/shell 编程）：

*   [高级 Bash 脚本指南](http://tldp.org/LDP/abs/html)
*   [BASH 编程 - 介绍 HOW-TO](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html)
*   [和许多其他人](http://www.google.de/search?q=bash+tutorial)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:36:33.750

这是基本的 C++。查看下面的示例代码或访问我从中复制它的[站点。](http://www.cplusplus.com/forum/articles/13355/)

```
#include <iostream>

// When passing char arrays as parameters they must be pointers
int main(int argc, char* argv[]) {
    if (argc < 5) { // Check the value of argc. If not enough parameters have been passed, inform user and exit.
        std::cout << "Usage is -in <infile> -out <outdir>\n"; // Inform the user of how to use the program
        std::cin.get();
        exit(0);
    } else { // if we got enough parameters...
        char* myFile, myPath, myOutPath;
        std::cout << argv[0];
        for (int i = 1; i < argc; i++) { /* We will iterate over argv[] to get the parameters stored inside.
                                          * Note that we're starting on 1 because we don't need to know the 
                                          * path of the program, which is stored in argv[0] */
            if (i + 1 != argc) // Check that we haven't finished parsing already
                if (argv[i] == "-f") {
                    // We know the next argument *should* be the filename:
                    myFile = argv[i + 1];
                } else if (argv[i] == "-p") {
                    myPath = argv[i + 1];
                } else if (argv[i] == "-o") {
                    myOutPath = argv[i + 1];
                } else {
                    std::cout << "Not enough or invalid arguments, please try again.\n";
                    Sleep(2000); 
                    exit(0);
            }
            std::cout << argv[i] << " ";
        }
        //... some more code
        std::cin.get();
        return 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:49:12.283

您不只是想在您的 C++ 程序中被提示输入值吗？如果这是您想要的，这个简单的代码将完成这项工作：

```
#include <iostream>
int main(int argc, char **argv) {
  int p = 0;
  std::cout << "Enter P value: ";
  std::cin >> p;
  std::cout << "Entered value: " << p << std::endl;
  return 0;
} 
```

# exception - Zend 框架 2 在 ActionController 中的 set_exception_handler

> ID：13122346
> 
> 赞同：1
> 
> 时间：2012-10-29T13:12:41.673
> 
> 标签：exception, exception-handling, zend-framework2, zend-controller

我尝试使用“set_exception_handler”函数来捕获我的 ActionController 异常。

在任何视图（例如 index.phtml）中，此代码都可以正常工作，视图显示 Helloooo。

```
 <?php 
    namespace App;
    echo $this->doctype();

    class Fun {
        static function exception_handler(\Exception $ex){
            echo "Heloooo";
        }
        function method(){
            set_exception_handler('App\Fun::exception_handler');
            throw new \Exception('One Exception');
        }
    }
    $f = new Fun();
    $f->method(); 
```

我不明白，因为 ActionController.php 中的相同代码 set_exception_handler() 没有捕获异常。在这种情况下，视图显示带有“一个异常”消息的 zend 异常模板。

顺便说一句，异常堆栈没有显示任何警告消息，那么我假设 set_exception_handler() 参数很好。

```
 namespace App\Controller;
    use Zend\....... //All namespaces used

    class Fun {
        static function exception_handler(\Exception $ex){
            echo "Helloooo";
        }
        function method(){
            set_exception_handler('App\Controller\Fun::exception_handler');
            throw new \Exception('One Exception');
        }
    }
    $f = new Fun();
    $f->method();

    class MainController extends AbstractActionController {
        //The Controller Code (in this test it doesn't execute).
    } 
```

我认为 Zend Framework 使用任何技术来捕获其他级别的控制器异常。请问有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T13:04:41.013

我必须更正我以前的帖子。这似乎是ZF的一个已知错误。看看这个：

[http://grokbase.com/t/php/php-bugs/128zn2emcx/php-bug-bug-62985-new-set-exception-handler-doesnt-work-from-command-line](http://grokbase.com/t/php/php-bugs/128zn2emcx/php-bug-bug-62985-new-set-exception-handler-doesnt-work-from-command-line)

# python - 无论如何在Python中结合正则表达式匹配和检查None？

> ID：13122350
> 
> 赞同：0
> 
> 时间：2012-10-29T13:12:58.723
> 
> 标签：python, regex

假设我正在编写一个简单的解析器。它有一个调度程序，根据输入表达式的类型调用相应的解析函数。

```
def dispatcher(expression):
    m = pattern1.match(expression):
    if m is not None:
        handle_type1(expression, m)
    # ... other types 
```

我的问题是，有没有将匹配和检查结合起来`None`？我的意思是，类似于以下 C 代码：

```
void dispatcher(char *expression)
{
    if ((m = pattern1.match(expression)) != NULL) {
        // ... handle expression type 1
    }
    else if ((m = pattern2.match(expression)) != NULL) {
        // ... handle expression type 2
    }
    // ... other cases
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:19:17.357

这实际上并不是将模式匹配与无检查相结合，而是关于您是否可以分配给一个变量并在一个表达式中评估该分配的结果，因为 pattern.match() 调用可以是任何返回值的函数。

一般来说，答案是否定的，因为[在 Python 中赋值是一个语句](http://effbot.org/pyfaq/why-can-t-i-use-an-assignment-in-an-expression.htm)，而不是 C 中的表达式。

在这种情况下，我可以看到的唯一区别是您为自己节省了一个额外的回车，这不是那么有用。assign-and-compare 习惯用法在循环中更有用，但在 Python 中，您只需要在两行中执行（必要时使用 break）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:32:14.333

你不觉得你的类似 C 的例子有点重复吗？如果你发现你一遍又一遍地重复代码，那么考虑用循环替换它。这样的事情避免了重复匹配和测试：

```
def dispatcher(expression):
    for pattern, action in [
        (pattern1, handle_type1),
        (pattern2, handle_type2),
        ]:
        m = pattern.match(expression):
        if m is not None:
           action(expression, m)
           break 
```

您还可以通过各种方式将模式和处理程序列表拉出循环，例如，如果处理程序是同一类的所有方法，您可以定义一个装饰器以使用处理程序旁边定义的模式自动构建列表。

```
@patternhandler('some regex')
def handle_type1(expression, match):
    ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T13:31:04.750

你能做的最好的，并且有一些争论是否更好，就是创建一个类来完成这项工作。然后该类可以保持状态，例如匹配的最后一个模式：

```
class Matcher(object):
    def __init__(self):
        self.m = None

    def match(self, pattern, text):
        self.m = re.match(pattern, text)
        return self.m

def dispatcher(expression):
    matcher = Matcher()
    if matcher.match(pattern1, expression):
        handle_type1(expression, matcher.m)
    if matcher.match(pattern2, expression):
        handle_type2(expression, matcher.m) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-18T06:48:05.257

如今（从 Python 3.8 开始）“海象运算符”`:=`实现了赋值表达式，允许更简单的公式：

```
if (m := pattern1.match(expression) is not None: 
```

这完全按照您想要的方式结合了评估和分配。

# python - 使用 lxml.html 解析 html

> ID：13122353
> 
> 赞同：0
> 
> 时间：2012-10-29T13:13:07.320
> 
> 标签：python, parsing, screen-scraping, lxml

我正在 scraperwiki.com 开发 Python 刮板，我需要解析一个包含以下内容的 html 页面：

```
<div class="items">
  <div class="item">
       ItemLine1 ItemLine1 ItemLine1
       <br> 
       ItemLine2 ItemLine2 ItemLine2
 </div>
 <br>
</div> 
```

我现在正在做的是：

```
import scraperwiki
import lxml.html

#.......................
raw_string = lxml.html.fromstring(scraperwiki.scrape(url_to_scrape))
my_line = ((raw_string.cssselect("div.items div.item")[0]).text)
print (my_line) 
```

它只打印`ItemLine1 ItemLine1 ItemLine1`。当我将 [0] 更改为 [1] 时，它会引发异常。

我怎么刮那个？我应该使用 xpath 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:50:10.483

XPath 是最直接的解决方案：

```
items = raw_string.cssselect('div.items div.item')

texts = [item.xpath('br[1]/preceding-sibling::node()') for item in items] 
```

XPath`br[1]`选择 ; 的第一个`br`孩子`div.item`。`preceding-sibling::`轴包含出现在第一个之前的所有节点`br`；`node()`选择该轴上的每种节点（文本或元素）。

如果您的更大目标是按`br`元素拆分节点的子节点，则可以采用几种不同的方法。这是如此棘手的原因是元素喜欢`br`并且`hr`设计不良的标记。使用像 sgml、html 或 xml 这样的树状标记语言，应该在一起的东西应该由一个公共的父元素分组，而不是由一个没有子元素的分隔符元素分割。

我将扩展您的测试用例以演示一些更复杂的情况：

```
html = """<div class="items">
  <div class="item">
   <br>
   ItemLine1 ItemLine1 ItemLine1
   <a href="">item</a>
   Itemline1-b
   <br> 
   <a class="z">item2</a>
   ItemLine2 ItemLine2 ItemLine2
   <br><br>
   Itemline3
 </div>
 <br>
</div>"""

doc = lxml.html.fromstring(html)
itemlist = doc.cssselect('div.items div.item') 
```

第一种方法是简单地获取段落中的所有节点并将它们拆分为不同的列表`br`。如果您使用这种方法，请不要使用 ElementTree API 的`text`和`tail`属性，因为您最终可能会复制文本。

```
def paras_by_br_nodes(parent):
    """Return a list of node children of parent (including text nodes) grouped by "paragraphs" which are delimited by <br/> elements."""
    paralist = []
    paras = []
    for node in parent.xpath('node()'):
        if getattr(node, 'tag', None) == 'br':
            paralist.append(paras)
            paras = []
        else:
            paras.append(node)
        paralist.append(paras)
        return paralist

print paras_by_br_nodes(itemlist[0]) 
```

这会产生如下列表：

```
[['\n       '],
 ['\n       ItemLine1 ItemLine1 ItemLine1\n\t\t', <Element a at 0x10498a350>, '\n\t\tItemline1-b\n       '],
 [<Element a at 0x10498a230>, '\n       ItemLine2 ItemLine2 ItemLine2\n       '],
 [], 
 ['\n       Itemline3\n ']] 
```

第二种方法是利用 ElementTree API 并将文本节点保留在`text`和`tail`属性中。这种方法的缺点是，如果没有附加文本的元素，我们只需要包含文本节点。这个非同质类型列表使用起来有点麻烦。

```
def paras_by_br_text(parent):
    paralist=[]
    para=[parent.text]
    for item in parent:
        if item.tag=='br':
            paralist.append(para)
            para = [item.tail]
        else:
            para.append(item)
    paralist.append(para)
    return paralist

print paras_by_br_text(itemlist[0]) 
```

这会产生一个像这样的列表。请注意，与前一个列表相比，它仅在列表的第一个位置具有文本节点节点。这对应于`br.tail`文本或`parent.text`（即第一个元素之前的文本）。

```
[['\n       '],
 ['\n       ItemLine1 ItemLine1 ItemLine1\n\t\t', <Element a at 0x1042f5170>],
 [<Element a at 0x1042f5290>],
 [],
 ['\n       Itemline3\n ']] 
```

我认为最好的方法是引入新元素。这个 html`br`在它应该使用的时候使用`p`或者其他一些容器元素。因此，让我们*修复 html*并返回元素列表而不是节点列表：

```
def paras_by_br(parent):
    paralist = []
    para = lxml.html.etree.Element('para')
    if parent.text:
        para.text = parent.text
    for item in parent:
        if item.tag=='br':
            paralist.append(para)
            para = lxml.html.etree.Element('para')
            if item.tail:
                para.text = item.tail
        else:
            para.append(item)
    return paralist

paralist = paras_by_br(itemlist[0])

print "\n--------\n".join(lxml.html.etree.tostring(para) for para in paralist) 
```

这将打印以下内容：

```
<para>
       </para>
--------
<para>
       ItemLine1 ItemLine1 ItemLine1
        <a href="">item</a>
        Itemline1-b
       </para>
--------
<para><a class="z">item2</a>
       ItemLine2 ItemLine2 ItemLine2
       </para>
--------
<para/> 
```

查看项目如何按`para`原始文档中不存在的新元素进行分组。

# ftp - 将远程文件移动到远程目录

> ID：13122356
> 
> 赞同：0
> 
> 时间：2012-10-29T13:13:15.037
> 
> 标签：ftp

仅使用 ftp 命令，如何将目录中的所有文件移动到另一个目录？

我不知道文件的名称，只知道它们所在的目录。例如，我想将所有文件移入`base_dir`

```
base_dir/file1
base_dir/file2
base_dir/destination_dir/ 
```

到里面的目录`base_dir`：

```
base_dir/destination_dir/file1
base_dir/destination_dir/file2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:24:00.457

我认为这应该可以解决问题：

```
RNFR base_dir
RNTO base_dir_temp

MKD base_dir

RNFR base_dir_temp
RNTO base_dir/destination_dir 
```

# c# - 如何在asp.net 2.0 C#中找到datagrid行

> ID：13122360
> 
> 赞同：1
> 
> 时间：2012-10-29T13:13:26.660
> 
> 标签：c#, asp.net

我正在使用 dot net 2.0 和 c#。

我有一个要求，我必须找到数据网格的行，然后将其作为函数中的参数传递，您能否提供在 datagird 中查找行的代码。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:16:26.713

你可以试试`ItemDataBound event on your datagrid`

```
void Item_Bound(Object sender, DataGridItemEventArgs e) 
{
      if((e.Item.ItemType == ListItemType.Item) || 
             (e.Item.ItemType == ListItemType.AlternatingItem))
         {
             var control = (Label)e.Item.FindControl("YourLabel");
             control.Text="pass your value";
         }
}

<asp:DataGrid id="DataGrid1" 
   runat="server" 
   AutoGenerateColumns="False" OnItemDataBound="Item_Bound">
   <Columns>
      <asp:TemplateColumn HeaderText="Sample">
         <ItemTemplate>
            <asp:Label id="YourLabel" runat="server"/>
         </ItemTemplate>
      </asp:TemplateColumn>
   </Columns>
</asp:DataGrid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:24:30.267

您可以循环您的 gridview / datagrid 行并在某些条件与您正在寻找的内容匹配时做任何您想做的事情。

```
 foreach (GridViewRow gvr in gvDemo.Rows) {
        if (gvr.DataItem != null) { 

            //depending on how or what you want to find 
            //check a key
            if (gvDemo.DataKeys[gvr.RowIndex].Values[0] == "xx") { 

            }
            //or a field value
            if (gvr.Cells[0].ToString() == "123") { 

            }

            //or first cast your row data item back to a known class
            CarBrand carBrand = (CarBrand)gvr.DataItem;
            if (carBrand.Name == "Porsche") { 
            //
            }

            //or pass the whole row to whatever function
            if (xx == yy) {
                DoSomething(gvr);
            }

        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:23:26.027

您只需将数据网格放入 ItemDataBound 并调用 Event ItemDataBound_click 写这个

```
string rownumber = e.Item.FindControl("your id for the label") As Label 
```

并在转换等效数据类型后使用，您将其用作参数。

# c# - 将 WebClient 与 socks 代理一起使用

> ID：13122369
> 
> 赞同：21
> 
> 时间：2012-10-29T13:13:49.353
> 
> 标签：c#, .net, socks, webclient

有什么方法可以使用 socks 代理`WebClient`吗？特别`DownloadString`是它提供的方法？

我不想使用任何第三方的东西，比如 privoxy、freecap 等等，我不能使用像 Chilkat 那样的商业图书馆。我尝试使用来自[http://www.mentalis.org/](http://www.mentalis.org/)的东西，事实上我使用了他们的`WebRequest`实现，但他们似乎没有类似的东西用于 WebClient。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-29T14:36:29.650

[`WebRequest`](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)/[`WebResponse`](http://msdn.microsoft.com/en-us/library/system.net.webresponse.aspx)类和扩展的[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)类不直接支持[SOCKS](http://en.wikipedia.org/wiki/SOCKS)（它依赖于`WebRequest`它的工作）。

它真的不能，因为它在传输层 (TCP/IP) 上工作，而不是通过简单的重定向到转发 HTTP 请求的服务器（这是`WebRequest`/`WebResponse`类工作的级别）。

您可以创建[/的](http://ditrans.blogspot.com/2009/03/making-witty-work-with-socks-proxy.html)[专门派生`WebRequest``WebResponse`](http://ditrans.blogspot.com/2009/03/making-witty-work-with-socks-proxy.html)（用于[`ProxySocket`](http://www.mentalis.org/soft/class.qpx?id=9)处理低级握手，然后），然后创建一个覆盖and方法的专门[`WebClient`类。](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)[`GetWebRequest`](http://msdn.microsoft.com/en-us/library/system.net.webclient.getwebrequest.aspx)[`GetWebResponse`](http://msdn.microsoft.com/en-us/library/system.net.webclient.getwebresponse.aspx)

一旦你用那个类代替了你的`WebClient`实例，它应该可以正常工作（但你可能必须在使用它的每种情况下设置代理）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-06T18:46:39.480

这是我最终的做法，谢谢casperOne的回答

```
public class SocksWebClient : WebClient
    {
        public IProxyDetails ProxyDetails { get; set; }
        public string UserAgent { get; set; }

        protected override WebRequest GetWebRequest(Uri address)
        {
            WebRequest result = null;

            if (ProxyDetails != null)
            {
                if (ProxyDetails.ProxyType == ProxyType.Proxy)
                {
                    result = (HttpWebRequest)WebRequest.Create(address);
                    result.Proxy = new WebProxy(ProxyDetails.FullProxyAddress);
                    if (!string.IsNullOrEmpty(UserAgent))
                        ((HttpWebRequest)result).UserAgent = UserAgent;
                }
                else if (ProxyDetails.ProxyType == ProxyType.Socks)
                {
                    result = SocksHttpWebRequest.Create(address);
                    result.Proxy = new WebProxy(ProxyDetails.FullProxyAddress);
                    //TODO: implement user and password

                }
                else if (ProxyDetails.ProxyType == ProxyType.None)
                {
                    result = (HttpWebRequest)WebRequest.Create(address);
                    if (!string.IsNullOrEmpty(UserAgent))
                        ((HttpWebRequest)result).UserAgent = UserAgent;
                }
            }
            else
            {
                result = (HttpWebRequest)WebRequest.Create(address);
                if (!string.IsNullOrEmpty(UserAgent))
                    ((HttpWebRequest)result).UserAgent = UserAgent;
            }

            return result;
        }

    } 
```

该类`SocksHttpWebRequest`取自@casperOne 链接的[博客](http://ditrans.blogspot.co.uk/2009/03/making-witty-work-with-socks-proxy.html)，其代码如下：

```
using System;
using System.Collections.Specialized;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Text;
using Org.Mentalis.Network.ProxySocket;

namespace Ditrans
{
    public class SocksHttpWebRequest : WebRequest
    {

        #region Member Variables

        private readonly Uri _requestUri;
        private WebHeaderCollection _requestHeaders;
        private string _method;
        private SocksHttpWebResponse _response;
        private string _requestMessage;
        private byte[] _requestContentBuffer;

        // darn MS for making everything internal (yeah, I'm talking about you, System.net.KnownHttpVerb)
        static readonly StringCollection validHttpVerbs =
            new StringCollection { "GET", "HEAD", "POST", "PUT", "DELETE", "TRACE", "OPTIONS" };

        #endregion

        #region Constructor

        private SocksHttpWebRequest(Uri requestUri)
        {
            _requestUri = requestUri;
        }

        #endregion

        #region WebRequest Members

        public override WebResponse GetResponse()
        {
            if (Proxy == null)
            {
                throw new InvalidOperationException("Proxy property cannot be null.");
            }
            if (String.IsNullOrEmpty(Method))
            {
                throw new InvalidOperationException("Method has not been set.");
            }

            if (RequestSubmitted)
            {
                return _response;
            }
            _response = InternalGetResponse();
            RequestSubmitted = true;
            return _response;
        }

        public override Uri RequestUri
        {
            get { return _requestUri; }
        }

        public override IWebProxy Proxy { get; set; }

        public override WebHeaderCollection Headers
        {
            get
            {
                if (_requestHeaders == null)
                {
                    _requestHeaders = new WebHeaderCollection();
                }
                return _requestHeaders;
            }
            set
            {
                if (RequestSubmitted)
                {
                    throw new InvalidOperationException("This operation cannot be performed after the request has been submitted.");
                }
                _requestHeaders = value;
            }
        }

        public bool RequestSubmitted { get; private set; }

        public override string Method
        {
            get
            {
                return _method ?? "GET";
            }
            set
            {
                if (validHttpVerbs.Contains(value))
                {
                    _method = value;
                }
                else
                {
                    throw new ArgumentOutOfRangeException("value", string.Format("'{0}' is not a known HTTP verb.", value));
                }
            }
        }

        public override long ContentLength { get; set; }

        public override string ContentType { get; set; }

        public override Stream GetRequestStream()
        {
            if (RequestSubmitted)
            {
                throw new InvalidOperationException("This operation cannot be performed after the request has been submitted.");
            }

            if (_requestContentBuffer == null)
            {
                _requestContentBuffer = new byte[ContentLength];
            }
            else if (ContentLength == default(long))
            {
                _requestContentBuffer = new byte[int.MaxValue];
            }
            else if (_requestContentBuffer.Length != ContentLength)
            {
                Array.Resize(ref _requestContentBuffer, (int) ContentLength);
            }
            return new MemoryStream(_requestContentBuffer);
        }

        #endregion

        #region Methods

        public static new WebRequest Create(string requestUri)
        {
            return new SocksHttpWebRequest(new Uri(requestUri));
        }

        public static new WebRequest Create(Uri requestUri)
        {
            return new SocksHttpWebRequest(requestUri);
        }

        private string BuildHttpRequestMessage()
        {
            if (RequestSubmitted)
            {
                throw new InvalidOperationException("This operation cannot be performed after the request has been submitted.");
            }

            var message = new StringBuilder();
            message.AppendFormat("{0} {1} HTTP/1.0\r\nHost: {2}\r\n", Method, RequestUri.PathAndQuery, RequestUri.Host);

            // add the headers
            foreach (var key in Headers.Keys)
            {
                message.AppendFormat("{0}: {1}\r\n", key, Headers[key.ToString()]);
            }

            if (!string.IsNullOrEmpty(ContentType))
            {
                message.AppendFormat("Content-Type: {0}\r\n", ContentType);
            }
            if (ContentLength > 0)
            {
                message.AppendFormat("Content-Length: {0}\r\n", ContentLength);
            }

            // add a blank line to indicate the end of the headers
            message.Append("\r\n");

            // add content
            if(_requestContentBuffer != null && _requestContentBuffer.Length > 0)
            {
                using (var stream = new MemoryStream(_requestContentBuffer, false))
                {
                    using (var reader = new StreamReader(stream))
                    {
                        message.Append(reader.ReadToEnd());
                    }
                }
            }

            return message.ToString();
        }

        private SocksHttpWebResponse InternalGetResponse()
        {
            var response = new StringBuilder();
            using (var _socksConnection =
                new ProxySocket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))
            {
                var proxyUri = Proxy.GetProxy(RequestUri);
                var ipAddress = GetProxyIpAddress(proxyUri);
                _socksConnection.ProxyEndPoint = new IPEndPoint(ipAddress, proxyUri.Port);
                _socksConnection.ProxyType = ProxyTypes.Socks5;

                // open connection
                _socksConnection.Connect(RequestUri.Host, 80);
                // send an HTTP request
                _socksConnection.Send(Encoding.ASCII.GetBytes(RequestMessage));
                // read the HTTP reply
                var buffer = new byte[1024];

                var bytesReceived = _socksConnection.Receive(buffer);
                while (bytesReceived > 0)
                {
                    response.Append(Encoding.ASCII.GetString(buffer, 0, bytesReceived));
                    bytesReceived = _socksConnection.Receive(buffer);
                }
            }
            return new SocksHttpWebResponse(response.ToString());
        }

        private static IPAddress GetProxyIpAddress(Uri proxyUri)
        {
            IPAddress ipAddress;
            if (!IPAddress.TryParse(proxyUri.Host, out ipAddress))
            {
                try
                {
                    return Dns.GetHostEntry(proxyUri.Host).AddressList[0];
                }
                catch (Exception e)
                {
                    throw new InvalidOperationException(
                        string.Format("Unable to resolve proxy hostname '{0}' to a valid IP address.", proxyUri.Host), e);
                }
            }
            return ipAddress;
        }

        #endregion

        #region Properties

        public string RequestMessage
        {
            get
            {
                if (string.IsNullOrEmpty(_requestMessage))
                {
                    _requestMessage = BuildHttpRequestMessage();
                }
                return _requestMessage;
            }
        }

        #endregion

    }
} 
```

[请注意，正如@casperOne 指出的那样，这使用了一个名为ProxySocket](http://www.mentalis.org/soft/class.qpx?id=9)的（免费）第三方库。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-12-09T13:42:24.710

为了做到这一点，我正在寻找图书馆。最后我发现`MihaZupan/HttpToSocks5Proxy`它是一个真正的救星。就像这样你可以使用它：

```
using MihaZupan;

var proxy = new HttpToSocks5Proxy("127.0.0.1", 1080,
   "username", "password" // optional
);
var handler = new HttpClientHandler { Proxy = proxy };
HttpClient httpClient = new HttpClient(handler, true);

var result = await httpClient.SendAsync(
    new HttpRequestMessage(HttpMethod.Get, "https://httpbin.org/ip"));

Console.WriteLine("HTTPS GET: " + await result.Content.ReadAsStringAsync()); 
```

如果您想要一个更方便的、`WebClient`-esque API 来读取内容，您可以将 response-read 调用包装到一个扩展方法中：

```
public static class ExtensionMethods
{
  public static async Task<string> DownloadStringAsync(this HttpClient client, string url)
  {
    var response = await client.SendAsync(new HttpRequestMessage(
      HttpMethod.Get, url));

    return await response.Content.ReadAsStringAsync();
  }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-10-26T23:05:48.990

我也遇到了这个，发现了不错的[BetterHttpClient](https://github.com/Yozer/BetterHttpClient)

它派生自 WebClient 并允许您指定 socks 代理：

```
BetterHttpClient.HttpClient client = new BetterHttpClient.HttpClient(new BetterHttpClient.Proxy("IP address", port, BetterHttpClient.ProxyTypeEnum.Socks)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-09-20T21:02:18.400

对于未来的读者：从 .NET 6 开始，HttpClient 原生[支持socks 代理。](https://github.com/dotnet/runtime/issues/17740)

```
var handler = new HttpClientHandler
{
    Proxy = new WebProxy("socks5://127.0.0.1", 9050)
};
var httpClient = new HttpClient(handler); 
```

### 笔记：

在撰写此答案时，`WebClient`被认为已过时。`HttpClient`应改为使用。

# visual-studio-2012 - 在设计时隐藏控件

> ID：13122371
> 
> 赞同：2
> 
> 时间：2012-10-29T13:14:02.247
> 
> 标签：visual-studio-2012

在我的应用程序中，我添加了很多相互叠加的控件（winforms 设计器性质），并且变得非常难以管理；但是对于用户来说没有问题，因为控件是按需显示的。

那么如何在设计器中隐藏一些控件以便更易于管理呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-10-22T16:30:25.853

嗯，像往常一样`Hans Passant`的回答是令人满意的。

> TabControl 有很好的设计时支持，像这样隐藏标签：[stackoverflow.com/a/2798241/17034](https://stackoverflow.com/a/2798241/17034) – Hans Passant

# wordpress - 如何更改 WordPress 存档 URL 模式？

> ID：13122373
> 
> 赞同：3
> 
> 时间：2012-10-29T13:14:07.007
> 
> 标签：wordpress, archive

我在右侧边栏中有一个档案部分。你可以在这里查看。默认情况下，存档部分提供**/blog/2012/08/** URL 模式。

但我希望**/blog/archive/2012/08/**模式不改变永久链接模式作为使用**blog/post_name**的主要帖子，它不应该改变。我怎样才能完成这项工作？

我是 WordPress 新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-04-25T17:19:55.410

今晚我来到这个问题没有答案。虽然现在回答已经很晚了，但我尝试回答它以供将来参考。您可以将以下代码片段添加到`functions.php`文件中。

```
function change_archive_links() {
global $wp_rewrite;
// add 'archive'
$wp_rewrite->date_structure ='blog/archive/%year%/%monthnum%/';
}
add_action('init','change_archive_links'); 
```

添加片段后不要忘记刷新 WordPress 重写规则。为此，请转到 WP Dashboard > Settings > Permalinks，然后按 Save Changes 按钮。

# ios - 根据 1 个标签动态更改 UITableViewCell 的高度？

> ID：13122374
> 
> 赞同：0
> 
> 时间：2012-10-29T13:14:12.557
> 
> 标签：ios, uilabel, uitableview

如何根据其中的内容量缩放 UITableViewCells？在我的单元格中，我使用了 3 个代表论坛的标签。这些标签被命名为“别名”、“日期”和“评论”。第三个标签注释，可以是任意数量的行。因此，我的单元格需要根据“评论”标签中的文本数量（大小）而动态变化。以下是我的相关代码：

```
- (UITableViewCell *)tableView:(UITableView *)pTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"ForumthreadCell";
UITableViewCell *cell = [pTableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil)
{
cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

Feedback *item = [self.items objectAtIndex:indexPath.row];

UILabel *aliasLabel = (UILabel *)[cell viewWithTag:1];
UILabel *commentLabel = (UILabel *)[cell viewWithTag:2];
UILabel *dateLabel = (UILabel *)[cell viewWithTag:3];

[aliasLabel setText:item.alias];
[commentLabel setText:item.comment];
[dateLabel setText:[self.dateFormatter stringFromDate:[NSDate dateWithTimeIntervalSince1970:(double)item.time]]];

commentLabel.numberOfLines = 0;
[commentLabel sizeToFit];

return cell;
} 
```

在这种方法中，我应该根据commentLabel 高度设置tableViewCell 的高度。唯一的问题是我不知道该怎么做？

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
if (????) {

    return ????;
    //return [indexPath row] + 50;

}

return ????;
} 
```

我需要有人试图查看我的代码并举例说明如何使这项工作发挥作用。毕竟，它只有 1 个标签....我已经看过几个教程但无法使其工作...感谢您的时间和帮助。这是一个带有一些旧代码的旧屏幕。这或多或少是论坛现在的样子：[http ://tinypic.com/view.php?pic=16h7me9&s=6](http://tinypic.com/view.php?pic=16h7me9&s=6)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:24:06.907

您需要的是一种计算使用特定字体呈现的文本大小的方法。幸运的是，UIKit 通过[NSString UIKit Additions](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/NSString_UIKit_Additions/Reference/Reference.html)`sizeWithFont:`中的各种方法为您提供了这一点。

# macos - Mac OSX 上的磁盘队列长度

> ID：13122382
> 
> 赞同：6
> 
> 时间：2012-10-29T13:14:56.407
> 
> 标签：macos

在 Linux 上，可以通过分析 iostat 的来源来计算磁盘队列长度。它有列 avgqu-sz 这是队列大小 - [http://www.cyberciti.biz/tips/linux-disk-performance-monitoring-howto.html](http://www.cyberciti.biz/tips/linux-disk-performance-monitoring-howto.html)

但是在 Mac OSX 上我没有找到类似的东西。它拥有的最接近的计数器是纳秒的读写延迟，但是我看不到如何从它们获取磁盘队列长度（以及 OSX 公开的所有计数器 - [https://developer.apple.com/library/mac/#文档/内核/参考/IOBlockStorageDriver_header_reference/Reference/reference.html](https://developer.apple.com/library/mac/#documentation/Kernel/Reference/IOBlockStorageDriver_header_reference/Reference/reference.html)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-23T19:14:58.353

dtrace 脚本[iopening](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/iopending.1m.html)对磁盘队列长度进行采样并显示直方图。

# symfony - 在日期表单字段中隐藏日期和月份小部件

> ID：13122385
> 
> 赞同：0
> 
> 时间：2012-10-29T13:15:19.563
> 
> 标签：symfony, symfony-forms, symfony-2.1

这并没有完全隐藏月份和日期小部件......

```
{% block date_widget %}
    {% spaceless %}
        {% if widget == 'single_text' %}
            {{ block('field_widget') }}
        {% else %}
            <div {{ block('widget_container_attributes') }}>
                {{ date_pattern|replace({
                '{{ year }}':  form_widget(form.year),
                '{{ month }}': form_widget(form.month, { 'attr' : { 'style': 'display:none' }}),
                '{{ day }}': form_widget(form.day, { 'attr' : { 'style': 'display:none' }}),
                })|raw }}
            </div>
        {% endif %}
    {% endspaceless %}
{% endblock date_widget %} 
```

...还有这个：

```
'{{ month }}': '',
'{{ day }}': '', 
```

在验证期间失败。

**有什么想法可以从日期表单字段中删除日期和月份小部件吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:47:47.270

`date`没有`month`and部分的类型`day`只是一个`year`类型。那么，为什么不创建一个而不是滥用日期类型呢？

您可以使用该类型或基于它[`choice`](http://symfony.com/doc/current/reference/forms/types/choice.html)创建一个类型。`year`您还可以查看类型的[`years`](http://symfony.com/doc/current/reference/forms/types/birthday.html#years)选项[`birthday`](http://symfony.com/doc/current/reference/forms/types/birthday.html)并将类似的选项添加到您的新类型。

# php - 付款页面无法从 authorize.net 回发到网站

> ID：13122389
> 
> 赞同：0
> 
> 时间：2012-10-29T13:15:32.560
> 
> 标签：php, authorize.net

当我使用 authorize.net 进行卡交易时，我正在使用 php 进行支付 intigration，URl 必须停留在 dll 页面上，但 POST 方法或 GET 方法对 url 没有响应。

# sql-server - 从 Excel 导入 SQL Server 2008 中删除添加到列名的引号

> ID：13122395
> 
> 赞同：1
> 
> 时间：2012-10-29T13:15:42.960
> 
> 标签：sql-server, sql-server-2008, tsql

我注意到，当我使用 SSMS 将 Excel 电子表格导入 SQL Server 时，会添加引号。我在某处读到过，无论出于何种原因，Excel 都必须这样做。一旦进入 SQL Server，列名周围的这些引号就没有用了，我希望有一种编程方式来删除它们。我试图做的最接近但不起作用的东西是`EXEC sp_rename 'Table.["withquotes"]', NewColumnName, 'replace(Table.["withquotes",'"','']`. 我想遍历表中的所有列名，并`replace`在这些列名包含引号的地方使用该函数。有没有一种典型的、惯用的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T17:29:02.367

我相信这应该会有所帮助...

```
DECLARE @tbl sysname, @col sysname
DECLARE @cmd nvarchar(max)

DECLARE cCol CURSOR FOR
    SELECT TABLE_NAME, COLUMN_NAME
    FROM INFORMATION_SCHEMA.COLUMNS 
    WHERE COLUMN_NAME LIKE '"%"'

OPEN cCol
FETCH NEXT FROM cCol INTO @tbl, @col
WHILE @@fetch_status = 0
BEGIN
  SET @cmd = 
    N'EXEC sp_rename ''[' + @tbl + '].[' + @col + ']'', ' + 
    '''' + REPLACE(@col, '"', '') + N''', ''COLUMN''' 

  --PRINT @cmd

  EXEC sp_executeSQL @cmd

  FETCH NEXT FROM cCol INTO @tbl, @col
END

CLOSE cCol 
DEALLOCATE cCol 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-12T13:04:06.080

仅供参考，我对 OzrenTkalcecKrznaric 的程序有误。搜索后，这是由于缺少架构名称。所以这是我的版本，更新为包含该架构名称：

```
DECLARE @tbl sysname, @col sysname, @sch sysname
DECLARE @cmd nvarchar(max)

DECLARE cCol CURSOR FOR
    SELECT TABLE_NAME, COLUMN_NAME, TABLE_SCHEMA
    FROM INFORMATION_SCHEMA.COLUMNS 
    WHERE COLUMN_NAME LIKE '"%"' 

OPEN cCol
FETCH NEXT FROM cCol INTO @tbl, @col, @sch
WHILE @@fetch_status = 0
BEGIN
  SET @cmd = 
    N'EXEC sp_rename ''[' + @sch + '].[' + @tbl + '].[' + @col + ']'', ' + 
    '''' + REPLACE(@col, '"', '') + N''', ''COLUMN''' 

  --PRINT @cmd

  EXEC sp_executeSQL @cmd

  FETCH NEXT FROM cCol INTO @tbl, @col, @sch
END

CLOSE cCol 
DEALLOCATE cCol 
```

* * *

还可以生成语句，然后复制、粘贴和执行：

```
USE myDb
select 'Exec sp_rename ''' + QuoteName(Schema_Name(tables.schema_id)) + '.' + QuoteName(tables.name) + '.' + QuoteName(columns.name) + '''' +
   ',''' + REPLACE ( columns.name , '"' , '') + ''', ''COLUMN'''
from sys.columns
join sys.tables on columns.object_id = tables.object_id
join sys.schemas on tables.schema_id = schemas.schema_id
where sys.columns.name like '"%"' AND sys.schemas.name =  'mySchema' 
```

（将 myDb 和 mySchema 替换为您的值）

# java - 使用统计设计程序

> ID：13122401
> 
> 赞同：1
> 
> 时间：2012-10-29T13:16:03.240
> 
> 标签：java, object, uml

我即将开始我的最新项目，它基本上是一个从数据库中获取一些数据然后将这些数据显示为图表的应用程序！

现在，尽管这看起来很简单，但在面向对象编程方面以非常正确的方式完成对我来说很重要。

现在我的想法如下：

我想创建以下四个类：

**适配器：**

将应用程序连接到数据库并接收数据的类

**呼叫队列：**

这是一个对象，其差异取决于从数据库中接收的数据类型以及您希望在图表上显示的数据类型。这方面的一个例子是奶酪和水果。它们都是食物，但它们是非常不同类型的食物。

**统计数据**

这将是一个用于计算从数据库接收的信息的工具类（例如将其更改为百分比而不是原始数据）

**图形**

这将是从统计类获取信息并将数字转换为图形的类

**图形用户界面**

这当然是我将在其中发布图表的 GUI 类！

现在我想让项目尽可能面向对象。但我的问题是来自数据库的信息并不总是相同的。例如，如果每天获取数据，它将与每月不同。这意味着信息总是会根据用户的需要而改变。

我将如何使这个程序面向对象？以及我的班级之间应该有什么类型的联系才能使其最容易访问。我必须创建子类以简化它吗？

我应该将数据库中的所有信息直接添加到 CallQueue 类中，还是应该稍后创建该对象？

**更新 - 详细说明**

名称 callQueue 不是流式实现，它只是一个对象，应该包含从数据库接收的数据值（请注意，这仍处于构思阶段，没有任何实现）。这个想法是用户打开程序，然后选择一天，然后选择一天，例如：04/11/2012 到 10/11/2012。对象值更改的原因是当日期更改为例如以下情况时：04/11/2012 - 04/12/2012 然后将创建一个新图表，将计算来自数据库的新信息等。

我也很困惑的一件事是：当您有一个从数据库创建的对象时（请注意，如果你们有更好的想法，这可能会被优化）那么您将如何计算统计数据？调用数据适配器的统计类然后处理数据然后创建包含计算数据的对象会更好吗？

然后 Graph 类需要获取对象数据并插入到图中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:24:29.200

从设计大型系统甚至更小的系统的经验来看，最好的方法是考虑**组件**而不是**类**。这将使您能够将问题分解成更小的（并且大部分是独立的）部分。

例如，您将拥有一个组件，该组件的唯一责任是将数据带到您的应用程序进行处理。该组件将需要能够处理多个数据源等......然后成为一个子系统，您可以独立于应用程序的其余部分进行设计并处理比整体更小的特定问题。

如果子问题仍然比应有的大，请继续将它们分解为子组件，直到组件的实现变得几乎微不足道。那时，您可以开始引入类的概念，因为您对系统中的主角有足够的了解。

简而言之，我非常强调关注点分离。通过将子问题隔离为子组件，您还可以隔离解决方案，从而更容易纠正您的设计错误或替换实施，而不会影响整个系统。

就我的两分钱...

# android - 多个 ListView Android

> ID：13122402
> 
> 赞同：0
> 
> 时间：2012-10-29T13:16:02.807
> 
> 标签：android, android-listview

我正在尝试进行 6`ListView`合一活动。没有两个同时可见。在选择第一个列表时，我想确保`View`它是可见的。那么我如何知道哪个`ListView`是可见的，以便我可以处理它。有什么办法知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:21:32.290

```
mListview.isShown(); 
```

如果视图可见性设置为 View.VISIBLE，则将返回布尔值 y/n

# c - 为什么我们需要在 pthread_cond_wait 之前进行条件检查

> ID：13122406
> 
> 赞同：20
> 
> 时间：2012-10-29T13:16:31.643
> 
> 标签：c, linux, multithreading, pthreads, mutex

我正在尝试学习 pthread_cond_wait 的基础知识。在所有用法中，我看到

```
if(cond is false)
   pthread_cond_wait 
```

或者

```
while(cond is false)
   pthread_cond_wait 
```

我的问题是，我们只想 cond_wait 因为条件为假。那我为什么要痛苦地明确放置一个 if/while 循环。我可以理解，在`cond_wait`我们直接点击它之前没有任何 if/while 检查，它根本不会返回。条件检查只是为了解决这个目的还是有其他意义。如果它用于解决不必要的条件等待，那么进行条件检查并避免 cond_wait 类似于轮询？？我正在像这样使用 cond_wait 。

```
void* proc_add(void *name){
    struct vars *my_data = (struct vars*)name;
    printf("In thread Addition and my id = %d\n",pthread_self());
    while(1){
    pthread_mutex_lock(&mutexattr);
    while(!my_data->ipt){  // If no input get in
            pthread_cond_wait(&mutexaddr_add,&mutexattr);  // Wait till signalled
            my_data->opt = my_data->a + my_data->b;
            my_data->ipt=1;
            pthread_cond_signal(&mutexaddr_opt);
    }
    pthread_mutex_unlock(&mutexattr);
    if(my_data->end)
            pthread_exit((void *)0);
    }
} 
```

逻辑是，只要输入可用，我就要求输入线程处理数据，并向输出线程发出信号以打印它。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-29T13:18:57.047

您需要一个 while 循环，因为即使未达到您等待的条件，调用的线程也`pthread_cond_wait`可能会唤醒。这种现象称为“虚假唤醒”。

这不是错误，它是条件变量的实现方式。

这也可以在手册页中找到：

> *可能会发生*来自 pthread_cond_timedwait() 或 pthread_cond_wait() 函数的虚假唤醒。由于 pthread_cond_timedwait() 或 pthread_cond_wait() 的返回并不意味着该谓词的任何值，因此*应在返回时重新评估谓词*。

**关于实际代码的更新：**

```
void* proc_add(void *name) 
{
    struct vars *my_data = (struct vars*)name;

    printf("In thread Addition and my id = %d\n",pthread_self());

    while(1) {

        pthread_mutex_lock(&mutexattr);

        while(!my_data->ipt){  // If no input get in
            pthread_cond_wait(&mutexaddr_add,&mutexattr);  // Wait till signalled
        }

        my_data->opt = my_data->a + my_data->b;
        my_data->ipt=1;
        pthread_cond_signal(&mutexaddr_opt);

        pthread_mutex_unlock(&mutexattr);

        if(my_data->end)
            pthread_exit((void *)0);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-29T14:04:39.080

您必须在等待之前测试互斥锁下的条件，因为条件变量的信号没有排队（条件变量不是信号量）。也就是说，如果一个线程`pthread_cond_signal()`在没有线程被阻塞在`pthread_cond_wait()`该条件变量上时调用，那么信号什么也不做。

这意味着如果您有一个线程设置条件：

```
pthread_mutex_lock(&m);
cond = true;
pthread_cond_signal(&c);
pthread_mutex_unlock(&m); 
```

然后另一个线程无条件*地*等待：

```
pthread_mutex_lock(&m);
pthread_cond_wait(&c, &m);
/* cond now true */ 
```

这第二个线程将永远阻塞。这可以通过让第二个线程检查条件来避免：

```
pthread_mutex_lock(&m);
if (!cond)
    pthread_cond_wait(&c, &m);
/* cond now true */ 
```

由于`cond`仅使用`m`持有的互斥锁进行修改，这意味着当且仅当`cond`为假时，第二个线程才等待。

`while ()`在健壮的代码中使用循环而不是循环的原因`if ()`是因为`pthread_cond_wait()`不能保证它不会被虚假唤醒。使用 a`while ()`还意味着向条件变量发出信号始终是完全安全的——“额外”信号不会影响程序的正确性，这意味着您可以执行诸如将信号移到代码锁定部分之外的操作。

# openlaszlo - 如何在 openlaszlo 中集成 textarea？

> ID：13122407
> 
> 赞同：1
> 
> 时间：2012-10-29T13:16:31.773
> 
> 标签：openlaszlo, lzx

我只是想将 textarea 集成到 dhtml 环境中。我能够看到文本区域但我无法在文本区域中输入任何内容。附上一段代码片段。

```
<canvas debug="true">
 <attribute name="htmlsnippet" type="string" value="" />

    <handler name="oninit" args="e">
    <![CDATA[
        canvas.htmlsnippet = '<textarea id="textArea" rows="8" cols="50"></textarea>';
    ]]>
    </handler>

    <simplelayout axis="y" spacing="30" />

    <text id="textcont" width="530" height="350" bgcolor="#cccccc" />

    <button text="modify text" onclick="textcont.sprite.setText(canvas.htmlsnippet)" />
</canvas> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T17:46:08.353

虽然可以在运行时生成 HTML 元素并将其添加到视图的显示对象，但 OpenLaszlo 内核将处理所有鼠标和按键事件，而不会将它们传递到您创建的文本区域。

OpenLaszlo 中的`<inputtext>`组件实例化了一个内部`<textarea>`. 编译以下 OpenLaszlo DHTML 应用程序：

```
<canvas debug="true">

  <inputtext id="iText" multiline="true" width="100" resize="true" bgcolor="red">
    <handler name="oninit"><![CDATA[
        this.setAttribute('text', 'Just\na\ntest!');
    ]]></handler>
  </inputtext>

</canvas> 
```

现在通过在浏览器 JavaScript 控制台中输入这个表达式来检查文本对象：

`iText.sprite.__LZdiv.children[0]`

你会看到类似的东西：

`<textarea class="lzswfinputtextmultiline" name="" style="color: rgb(0, 0, 0); width: 96px; height: 40px; pointer-events: auto;">`

根据浏览器的不同，样式值可能会有所不同。

不幸的是，OpenLaszlo 没有提供一个 API 来将您的自定义文本区域添加到应用程序，而无需自己处理文本区域的按键、焦点和鼠标事件。这实际上是 LFC/内核类（[LzText.lzs](http://svn.openlaszlo.org/openlaszlo/trunk/WEB-INF/lps/lfc/views/LzText.lzs)、[LzInputText.lzs](http://svn.openlaszlo.org/openlaszlo/trunk/WEB-INF/lps/lfc/views/LzInputText.lzs)、[LzTextSprite.js](http://svn.openlaszlo.org/openlaszlo/trunk/WEB-INF/lps/lfc/kernel/dhtml/LzTextSprite.js)、[LzInputTextSprite.js](http://svn.openlaszlo.org/openlaszlo/trunk/WEB-INF/lps/lfc/kernel/dhtml/LzInputTextSprite.js)）的组合所做的：它们复制 DHTML 的 SWF 文本类行为 - 因为 OpenLaszlo 在 DHTML 运行时之前具有 SWF 运行时。

这对于 HTML5 来说不是最优的，并且可能是 OpenLaszlo 平台的最大弱点之一。因此，最好不要将您自己`<textarea>`的应用程序添加到 DHTML 运行时应用程序中 - 除非您将其放入 iFrame/单独的 HTML 页面中。

# c++ - 设置一个等于 369 的字符给出与 113 相同的二进制模式是 UB 行为吗？

> ID：13122410
> 
> 赞同：2
> 
> 时间：2012-10-29T13:16:45.600
> 
> 标签：c++, binary

众所周知，一个 char 是 8 位的，所以它可以存储从 0 到 255 的值，

如果我用更大的值（如 369）初始化一个字符，我会得到与 113 相同的二进制模式，即 MSVC12 下的 01110001

它是标准，还是未定义的行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:22:30.633

请注意`369 - 256 == 113`.

4.7 积分转换，第 2 和第 3 段：

> 如果目标类型是无符号的，则结果值是与源整数一致的最小无符号整数（模 2^n，其中 n 是用于表示无符号类型的位数）。
> 
> 如果目标类型是有符号的，则如果它可以在目标类型（和位域宽度）中表示，则该值不变；否则，该值是实现定义的。

但是是否`char`意味着相同`unsigned char`或`signed char`也是实现定义的。

所以这种行为确实取决于编译器，尽管大多数人会这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:29:39.420

按标准`char`大小，8 位不是必需的，可以是有符号或无符号的，因此它是实现定义的。

引用 C++11 标准：

> **3.9.1 基本类型[basic.fundamental]**
> 
> 声明为字符 (char) 的对象应足够大以存储实现的基本字符集的任何成员。
> 
> ...
> 
> char 对象是否可以保存负值是实现定义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T13:19:39.343

它溢出了。369 - 256 = 113。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-29T13:26:49.887

A`char`不一定是 8 位。它可以是任意数量的位，具体取决于平台。即使在你的平台上`char`是 8 位类型，也并不意味着它的范围是`0..255`. 类型可以带符号，这意味着它的范围将是`-128..+127`（假设 2 的补码表示）。

如果在您的平台上类型 char 恰好是 8 位且无符号，那么这种行为是有保证的。无符号整数类型遵循模运算规则。`369`保证被截断模`256`并产生`113`.

如果在您的平台上类型 char 是 8 位且有符号，则行为是实现定义的。

# android - 突出显示或下划线选定的 TabPageIndicator

> ID：13122423
> 
> 赞同：14
> 
> 时间：2012-10-29T13:17:54.367
> 
> 标签：android, android-layout, android-viewpager, tabcontrol, viewpagerindicator

我在平板电脑大小的横向布局上有一个双窗格，我正在使用片段。

在左边我有一个带有列表视图的片段。当单击项目列表之一时，右侧片段会加载详细信息。

在右侧（详细）片段的布局中，有一个`com.viewpagerindicator.TabPageIndicator`和一个`android.support.v4.view.ViewPager.` ViewPager 将加载 2 个元素，每个元素都有其`com.viewpagerindicator.TabPageIndicator`. 我试图突出显示或下划线选定的选项卡，但我没有这样做。

我希望你有一些建议:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-03T13:57:00.637

默认情况下，TabPageIndicator 不应用任何样式。要从 ViewPagerIndicator 启用默认样式，请将以下行添加到您的`application`标签或适当的`activity`标签中`manifest.xml`

```
android:theme="@style/Theme.MyTheme" 
```

然后`res\values\styles.xml`在你的项目中添加一个文件，内容如下

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="Theme.MyTheme" parent="@android:style/Theme.Light">
        <item name="vpiTabPageIndicatorStyle">@style/Widget.TabPageIndicator</item>
    </style>  
</resources> 
```

我正在为我的应用程序使用 android light 主题，但您可能希望将其更改为您现在使用的主题。

如果要更改默认 VPI 样式，请将`styles.xml`文件更改为以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

  <style name="Theme.MyTheme" parent="@android:style/Theme.Light">
    <item name="vpiTabPageIndicatorStyle">@style/MyTabPageIndicator</item>
  </style>  

  <style name="MyTabPageIndicator" parent="Widget.TabPageIndicator">
    <item name="android:gravity">center</item>
    <item name="android:background">@drawable/vpi__tab_indicator</item>
    <item name="android:paddingLeft">22dip</item>
    <item name="android:paddingRight">22dip</item>
    <item name="android:paddingTop">12dp</item>
    <item name="android:paddingBottom">12dp</item>
    <item name="android:textAppearance">@style/MyTabPageIndicator.Text</item>
    <item name="android:textSize">12sp</item>
    <item name="android:maxLines">1</item>
  </style>

  <style name="MyTabPageIndicator.Text" parent="TextAppearance.TabPageIndicator">
    <item name="android:textStyle">bold</item>
    <item name="android:textColor">@color/vpi__dark_theme</item>
  </style>

</resources> 
```

请注意，上面的设置与 TabPageIndicactor 的默认 VPI 样式完全相同，因此您仍然需要进行您想要的更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-28T06:23:34.927

只需使用两个库 1) Sherlock 操作栏 2) ViewPageIndicator 并实现 tabPageIndicator 视图，它将为您提供默认选项卡，并为 highliget 选项卡提供下划线。如果您想更改下划线颜色，则需要更改在 underlinbe 中使用的可绘制第 9 个补丁图像。

这是示例代码

XML 视图示例

```
 <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:orientation="vertical" >

        <com.viewpagerindicator.TabPageIndicator
            android:id="@+id/indicator"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@color/lock_background_greeen"
           />

        <android.support.v4.view.ViewPager
            android:id="@+id/pager"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1" />
    </LinearLayout>
</FrameLayout> 
```

片段代码

```
 final FragmentPagerAdapter adapter = new  FragmentChildPageAdapter(getChildFragmentManager());//getActivity().getSupportFragmentManager()

    final ViewPager pager = (ViewPager) v.findViewById(R.id.pager);
    pager.setAdapter(adapter);

    final TabPageIndicator indicator = (TabPageIndicator) v.findViewById(R.id.indicator);
    indicator.setViewPager(pager); 
```

# c# - 更改访问数据库连接字符串

> ID：13122427
> 
> 赞同：1
> 
> 时间：2012-10-29T13:18:20.153
> 
> 标签：c#, database, winforms

在我的应用程序中，我有一个包含客户列表的访问数据库，该数据库被导入到我的项目中。组合框数据源设置为显示所有客户。

我还创建了一个表单，以便用户可以更改某些文件的某些设置和位置。为此，我使用`this.properties.settings.KlantenDB()`创建的字符串并将路径保存到客户数据库。

如何更改当前的 Access 数据库连接字符串，使其使用 KlantenDB 路径？

![在此处输入图像描述](../Images/20fd5206d423982bbffa7f360566ed16.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:30:21.433

称呼

```
AppDomain.CurrentDomain.SetData("DataDirectory", path); 
```

并提供数据文件的完整路径。

应该提供完整的`KlantenConnectionString`连接字符串。连接字符串的那`|DataDirectory|`部分将替换为您使用上述调用设置的值`SetData`。

在您的情况下，以下调用应该有效

```
AppDomain.CurrentDomain.SetData("DataDirectory", "C:"); 
```

# forms - Codeigniter 表单提交

> ID：13122430
> 
> 赞同：0
> 
> 时间：2012-10-29T13:18:28.487
> 
> 标签：forms, codeigniter, onchange

我有一个控制器，它加载一个用于将记录插入数据库的视图。此视图包含下拉选择。因此，当加载此视图时，我想检查下拉列表的选定值并执行以下操作：

```
if($this->input->post('my_select') == FALSE)
{
   //do something
}
else
{
   //do something else
} 
```

因此，当此下拉列表更改时，我想重新加载并再次检查。我想根据选择的值显示视图。所以我想使用 onChange="this.form.submit()" 但不幸的是这在 Codeigniter 中不起作用。

所以我的问题只是如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:21:21.907

您很可能希望使用某种 AJAX 调用来请求控制器并正确放置数据。

使用 jQuery 的示例：

```
$('#element').change(function()
{ 
    $.post('index.php/endpoint', function(data)
    {
        // do something here.
        $('#another_element').html(data);
    }
} 
```

您的控制器可以射出任何东西，但我更喜欢它是 JSON 数据。这样你就可以在上面跑`JSON.parse()`了。

# scala - 如何过滤scala中的元组列表？

> ID：13122432
> 
> 赞同：0
> 
> 时间：2012-10-29T13:18:43.447
> 
> 标签：scala, filter, tuples, scala-collections

我在 Scala 中有以下列表，我想根据一个条件进行过滤，这样如果有任何具有重复第一个值的元组，就像下面的示例一样，我想排除

```
List((a,1), (a,2)) 
```

因为它有“a”作为重复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T14:02:44.207

您想`result`使用仅保留那些没有重复“键”的列表的功能来过滤您的

```
result filter noDuplicateKeys 
```

此过滤函数必须采用对列表，`List[(A,B)]`并且仅当对第一个元素不存在于所有元素的其他地方时才返回 true，并且可以实现为

```
def noDuplicateKeys[A, B](xs: List[(A, B)]) = 
    (xs groupBy (_._1)).values forall {_.size < 2} 
```

它将元素分组到 a`Map`中，其键是s，其值是与该键配对`A`的 s 的对应列表。`B`

从此值中，您只能接受大小不超过 1 的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:45:18.743

我相信下面的代码会做你想做的事（只删除第一对，对吧？）：

我正在使用模式匹配来做到这一点，如果您想过滤所有内容，您可以对您的列表进行递归或执行 Kyle 建议的操作。看一下这个：

```
val a = "a"                                      
val b = "b"                                     

var result =
    List(
      List(),
      List((a, 1), (a, 2)),
      List((a, 1), (b, 1)),
      List((a, 1), (b, 2)),
      List((a, 2), (b, 1)),
      List((a, 2), (b, 2)),
      List((b, 1), (b, 2)),
      List((a, 1), (a, 2), (b, 1)),
      List((a, 1), (a, 2), (b, 2)),
      List((a, 1), (b, 1), (b, 2)),
      List((a, 2), (b, 1), (b, 2)),
      List((a, 1), (a, 2), (b, 1), (b, 2))) 

val filteredResult = (for (list <- result)
    yield list match {
    case x :: y :: xys if (x._1 == y._1) =>  xys
    case _ => list
  }).distinct 
```

结果：

```
//> List()
//| List((a,1), (b,1))
//| List((a,1), (b,2))
//| List((a,2), (b,1))
//| List((a,2), (b,2))
//| List((b,1))
//| List((b,2))
//| List((a,1), (b,1), (b,2))
//| List((a,2), (b,1), (b,2))
//| List((b,1), (b,2)) 
```

distinct 只会过滤生成的空列表。

干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T18:07:07.127

我认为这是过滤掉 `List[List[Tuple2[Char, Int]]]` 列表元素具有相同元素的项目。在这种情况下，当元素相同时`List[Tuple2[Char, Int]]`，我想返回列表中的一个`Boolean`元素。这`List[Tuple2[Char, Int]]`被映射到 的第一个元素，`Tuple`然后使用 distinct 和 size 将逻辑应用于新的字符列表，以检查元素是否相同并保留那些只有一个元素的元素。

过滤器

```
filter(xs => xs.map(ys => ys._1).distinct.size != 1 || xs.size == 1) 
```

测试数据：

```
scala> val a = List(List(('a',1)))
a: List[List[(Char, Int)]] = List(List((a,1)))

scala> val aa = List(List(('a',1),('a',1)))
aa: List[List[(Char, Int)]] = List(List((a,1), (a,1)))

scala> val ab = List(List(('a',1),('b',1)))
ab: List[List[(Char, Int)]] = List(List((a,1), (b,1)))

scala> val aba = List(List(('a',1),('b',1),('a',1)))
aba: List[List[(Char, Int)]] = List(List((a,1), (b,1), (a,1))) 
```

测试用例。

```
scala> a.filter(xs => xs.map(ys => ys._1).distinct.size != 1 || xs.size == 1)
res34: List[List[(Char, Int)]] = List(List((a,1)))

scala> aa.filter(xs => xs.map(ys => ys._1).distinct.size != 1 || xs.size == 1)
res35: List[List[(Char, Int)]] = List()

scala> ab.filter(xs => xs.map(ys => ys._1).distinct.size != 1 || xs.size == 1)
res36: List[List[(Char, Int)]] = List(List((a,1), (b,1)))

scala> aba.filter(xs => xs.map(ys => ys._1).distinct.size != 1 || xs.size == 1)
res37: List[List[(Char, Int)]] = List(List((a,1), (b,1), (a,1))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-27T20:08:25.997

基于@pagoda_5b 解决方案，我认为我们可以找到更好的解决方案。

你有什么想法：

```
def noDuplicateKeys(l: List[(Char, Int)]): Boolean = l.toMap.size == l.size

list filter noDuplicateKeys 
```

;)

# java - 我如何知道使用 JDBC 为批量更新创建了哪些自动增量值？

> ID：13122434
> 
> 赞同：0
> 
> 时间：2012-10-29T13:18:52.070
> 
> 标签：java, sql, sqlite, jdbc

我认为这个问题总结得很好，这是我目前的代码，但它没有给我所需的结果。我想返回一个 int 数组，其中包含为该批次中创建的每一行生成的自动增量 ID。

```
CREATE_APPOINTMENT = database.prepareStatement("INSERT INTO " + TABLE_APPOINTMENTS + " VALUES (?, ?, ?, ?, ?)");

   public static int[] createAppointment(Appointment... appointments) {
    int[] ids = new int[appointments.length];
    int count = 0;
    try {
        for (Appointment a : appointments) {
            CREATE_APPOINTMENT.setDate(2, a.date);
            CREATE_APPOINTMENT.setTime(3, a.time);
            CREATE_APPOINTMENT.setInt(4, a.duration);
            CREATE_APPOINTMENT.setString(5, a.clientName);
            CREATE_APPOINTMENT.addBatch();
        }
        CREATE_APPOINTMENT.executeBatch();

        ResultSet resultSet = CREATE_APPOINTMENT.getGeneratedKeys();
        if (resultSet != null)
            while (resultSet.next()) {
                ids[count++] = resultSet.getInt(1);
            }

    } catch (SQLException ex) {
        System.err.println(ex);
    }
    return ids;
} 
```

我尝试创建 8 个约会，并且根据数据库成功创建了他们的 id，但我的返回数组只包含最后一个 id，其余的都是零。我在哪里错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:47:32.020

尝试像这样更改准备语句：

```
CREATE_APPOINTMENT = database.prepareStatement("INSERT INTO " + TABLE_APPOINTMENTS + " VALUES (?, ?, ?, ?, ?)", Statement.RETURN_GENERATED_KEYS); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T19:05:54.953

实际上这是不可能的。***stmt.getGeneratedKeys()***将始终只返回一个值，因为 sqlite-jdbc 驱动程序中的此方法是这样实现的：

```
    结果集 getGeneratedKeys() 抛出 SQLException {
            如果（getGeneratedKeys == null）
                getGeneratedKeys = conn.prepareStatement("select last_insert_rowid();");
            返回 getGeneratedKeys.executeQuery();
        }

```

您的数组用零值初始化，然后将最后生成的 id 分配给数组的第一个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:40:35.317

好吧，[JDBC 规范](http://jcp.org/aboutJava/communityprocess/final/jsr221/index.html)第 13.6 节：检索自动生成的值提供了有关如何执行此操作的信息：

```
String keyColumn[] = {"ORDER_ID"};
...
Statement stmt = conn.createStatement();
int rows = stmt.executeUpdate("INSERT INTO ORDERS " +
"(ISBN, CUSTOMERID) " +
"VALUES (966431502, ’BILLG’)",
keyColumn);
ResultSet rs = stmt.getGeneratedKeys(); 
```

在这个例子之后的两段，规范说：

> 调用 executeBatch 方法后 getGeneratedKeys 是否返回生成的值是实现定义的。

所以，我想你可以测试你的驱动程序，看看它是否支持它。

# bash - 如何在 while 循环中“读取”变量

> ID：13122441
> 
> 赞同：43
> 
> 时间：2012-10-29T13:19:21.043
> 
> 标签：bash, variables, while-loop

如何从变量中读取`while read line`？

例如：

```
the_list=$(..code..)

while read line
do
        echo $line

done < $the_list 
```

使用上面的代码给我错误：

```
./copy.sh: line 25: $the_list: ambiguous redirect 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-10-29T13:22:59.427

你可以写：

```
while IFS= read -r line
do
    echo "$line"
done <<< "$the_list" 
```

请参阅[*Bash 参考手册*](http://www.gnu.org/software/bash/manual/bashref.html#Here-Strings)[中的第 3.6.7 节“此处的字符串”](http://www.gnu.org/software/bash/manual/bashref.html#Here-Strings)*。*

 *（我还冒昧地添加了一些双引号，并添加了`-r`and `IFS=`to `read`，以避免过多地混淆变量的内容。）

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-10-29T13:32:53.240

如果您不将变量用于其他任何事情，您甚至可以不使用它：

```
while read line ; do
    echo $line
done < <( ... code ... ) 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-10-29T13:22:08.807

你可以使用

```
your_code | while read line;
do
    echo $line
done 
```

如果您不介意在子 shell 中执行的 while 循环（您修改的任何变量在 之后的父项中都不可见`done`）。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-06-25T23:18:27.227

脚本文件应为 Linux 模式。以前它处于dos模式。我使用 `dos2unix filename`.

例如：

```
dos2unix sshcopy.sh 
```

现在它对我有用。*

# session - Symfony 2：会话和存储之间的区别？

> ID：13122442
> 
> 赞同：0
> 
> 时间：2012-10-29T13:19:28.327
> 
> 标签：session, symfony

谁能向我解释 Symfony 2 中“会话”和“存储”之间的区别？

我正在使用 PdoSessionStorage ，但看不到以下任何关系：

*   Symfony\组件\HttpFoundation\Session
*   Symfony\Component\HttpFoundation\Session\PdoSessionStorage

...而且这两个类似乎都被实例化了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:42:07.017

一个代表会话，另一个代表会话的存储方式。PdoSessionStorage 将通过数据库上的 PDO 处理存储。这是一种将会话的实际概念和内容与其存储分离的方式，因为它可以以不同的方式存储。

为什么会引起你的关注？

会话处理似乎也被重构了，我认为你没有使用最新版本的 symfony。但无论如何，你不应该担心这些类。

# c++ - 在 Windows 上使用 clang 编译 c++11 程序时出错

> ID：13122453
> 
> 赞同：5
> 
> 时间：2012-10-29T13:20:37.343
> 
> 标签：c++, windows, visual-c++, c++11, clang

我在 windows 上构建了 clang 3.2，并试图构建一个简单的 hello world 程序。但是我遇到了很多错误，如下所示。

```
d:\Marius\xyz>clang++ -stdlib=libc++ -std=c++11 -Wall xyz.cpp -o xyz.exe
clang++: warning: argument unused during compilation: '-stdlib=libc++'
In file included from xyz.cpp:12:
In file included from ./stdafx.h:18:
In file included from C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\algorithm:6:
In file included from C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\xmemory:6:
In file included from C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\xmemory0:9:
In file included from C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\xutility:8:
In file included from C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\utility:8:
C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\type_traits:1072:
33: error:
  '_Ty' does not refer to a value
            _HAS_TRIVIAL_MOVE_CONSTRUCTOR(_Ty)
                                          ^

...

C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\xstddef:540:50: note:
      expanded from macro '_VARIADIC_EXPAND_4'
#define _VARIADIC_EXPAND_4(FUNC, X1, X2, X3, X4) \
                                                 ^
C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\include\xrefwrap:222:22:note:
      expanded from macro '_CLASS_RESULT_OF_PMF_OPT_0X'
                        __thiscall, X2, X3, X4)
                                          ^
fatal error: too many errors emitted, stopping now [-ferror-limit=]
20 errors generated. 
```

我收到很多类似的错误，来自 VC++ 2012 标头。是否有可能在 Windows 上使用 clang++ 构建 C++11 代码？我必须提供额外的命令开关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T21:33:56.710

Clang 在由 Visual Studio 构建时无法正常工作（据说它在由 MinGW 构建时可以正常工作，但我自己无法验证）。

构建 Clang 时，它被配置为使用用于构建它的库。由于您使用 Visual Studio 构建了 Clang，因此 Clang 将尝试使用 Visual Studio 头文件和库。不幸的是，Clang 和 Visual Studio 的内部结构不同，以至于 Clang*无法*使用 VS 特定的标头。

在可以为 Windows 编译[libc++之前，Clang 将（几乎可以肯定）在由 Visual Studio 编译时永远不会工作。](http://libcxx.llvm.org/)尝试使用 MinGW 构建它（并发表一篇博客文章或关于你如何做到的东西！），看看它是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T12:24:02.093

clang 默认包含用于构建它的工具链。但与 MS 的情况一样，使用的扩展可能是特定于供应商的。clang 自己的 libc++ 可用性有望大大缓解该问题。手动指定正确的包含目录。

在构建过程中还要分开编译和链接阶段。这将导致链接使用正确的二进制库而不是 VS 默认值。

# jenkins - 我所有的 Jenkins 配置在哪里消失了？

> ID：13122456
> 
> 赞同：0
> 
> 时间：2012-10-29T13:20:58.917
> 
> 标签：jenkins

我已经在 Apache Tomcat 上运行 Jenkins 几个月了。然后我终止了该进程，以便可以将其部署到另一个端口上。我这样做并重新启动了 Jenkins，只是看到我的启动屏幕是空的，没有作业 :) 然后我将端口重新设置回 8080 并重新启动 Tomcat，但屏幕仍然是空的。所有下载的插件都为零。刚刚发生了什么，如何找回我的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:27:47.770

好的，这只是因为我以另一个用户身份重新启动它:)

# ajax - 检查响应文本需要什么类型的全局 ajax 设置？

> ID：13122457
> 
> 赞同：1
> 
> 时间：2012-10-29T13:20:59.293
> 
> 标签：ajax, jquery

我想配置全局 ajax 设置意味着这适用于将在此语句之后触发的所有 ajax 请求。

我想检查所有 ajax 响应文本，可以吗？

如果作为回应，我会得到“再见”，我想重定向到其他 url 意味着登录页面。

“再见”是通过动作发送的。

下面是无法正常工作的示例代码。

```
$(document).ready(function () {

     $(this).on('ajaxComplete',byebye);

});

function byebye(e, xhr, settings){
        console.log('byebye()'+xhr.responseText);
        if(xhr.responseText=='bye')
        {
            window.location('login.jsp');
        }
} 
```

这会在控制台上打印 bye 关键字，但不会调用 to `byebye()`；

有什么解决办法吗？

byebye() 的执行完成但没有执行 window.location();

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:27:48.813

window.location.replace() 在某些浏览器上什么都不做。您必须为 window.location 分配值，这是重定向页面的正确方法，如下所示：

```
window.location = newUrl; 
```

也许您可以尝试使用 ajaxComplete() 全局函数回调来查看发生了什么。

```
$(document).ready(function () {
    $(this).on('ajaxComplete',byebye);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:45:29.400

尝试：

```
$(document).ready(function () {

     $(window).on('ajaxComplete',byebye);

});

function byebye(e, xhr, settings){
        console.log('byebye()'+xhr.responseText);
        if(xhr.responseText=='bye')
        {
            window.location('login.jsp');
        }
} 
```

分配给`window`对象而不是`document`对象可能会解决您的问题，因为我认为在范围内触发了全局 AJAX 事件`window`。

# javascript - 如何在网页中将存储在数据库中的图像显示为 blob

> ID：13122459
> 
> 赞同：4
> 
> 时间：2012-10-29T13:21:10.273
> 
> 标签：javascript, html, sql, image, webpage

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T13:25:31.563

You should convert image data to base64 and then write to response, for example:

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAM0AAAD
 NCAMAAAAsYgRbAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5c
 cllPAAAABJQTFRF3NSmzMewPxIG//ncJEJsldTou1jHgAAAARBJREFUeNrs2EEK
 gCAQBVDLuv+V20dENbMY831wKz4Y/VHb/5RGQ0NDQ0NDQ0NDQ0NDQ0NDQ
 0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0PzMWtyaGhoaGhoaGhoaGhoaGhoxtb0QGho
 aGhoaGhoaGhoaGhoaMbRLEvv50VTQ9OTQ5OpyZ01GpM2g0bfmDQaL7S+ofFC6x
 v3ZpxJiywakzbvd9r3RWPS9I2+MWk0+kbf0Hih9Y17U0nTHibrDDQ0NDQ0NDQ0
 NDQ0NDQ0NTXbRSL/AK72o6GhoaGhoRlL8951vwsNDQ0NDQ1NDc0WyHtDTEhD
 Q0NDQ0NTS5MdGhoaGhoaGhoaGhoaGhoaGhoaGhoaGposzSHAAErMwwQ2HwRQ
 AAAAAElFTkSuQmCC" alt="beastie.png" /> 
```

[http://www.techerator.com/2011/12/how-to-embed-images-directly-into-your-html/](http://www.techerator.com/2011/12/how-to-embed-images-directly-into-your-html/)

Or you can make a link to server script which return header with content type of any image and write image data directly to response.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-11T13:09:46.290

Here's the code I used when I had to render a binary image from the database (SQL Server) into a html page using Ajax

```
stm = conn.prepareStatement("SELECT IMAGE FROM TABLE" );
rs = stm.executeQuery();
return rs 
```

The raw rs is then received using ajax(stored in the "response"):

```
 $.post('./getImagePage.jsp', {
            action : 'getImage'
        }, function(response) {         
            if (response != ''){                                                        
                var arrayBufferView = new Uint8Array( response[0].IMAGE);                                       
                var blob = new Blob( [ arrayBufferView ], { type: "image/jpg" } );
                var urlCreator = window.URL || window.webkitURL;
                var imageUrl = urlCreator.createObjectURL( blob );                                  
                var img = document.querySelector("#fotoMb");
                img.src = imageUrl;                     
        }); 
```

And the HTML:

```
<img id="fotoMb" style="border:5px solid;"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T14:09:07.187

I suggest you to don't save image to database ! That's can make your database server loading slowly ! Short answer, save image on folder of you web server and only refer the url where you save your file. Good luck !

# java - Java 搜索算法

> ID：13122462
> 
> 赞同：-7
> 
> 时间：2012-10-29T13:21:17.267
> 
> 标签：java, algorithm, search

任何人都可以通过以下实现告诉 java 示例/算法在数组中搜索元素：
- O(n^2) 算法和
- O(n) 算法

注意：这不是家庭作业。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:25:38.677

*   在数组中搜索单个项目是`O(N)`
*   `O(N^2)`如果您使用具有两个嵌套循环的简单算法，则在数组中搜索最长的递增数字^*

注意：这*不是*Java 特定的。

* * *

^*存在更快的算法来执行此搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:31:48.120

做一个`O(n²)`搜索算法是没有意义的。

要执行`O(n)`算法，只需搜索列表中的元素。

```
for(int i=0;i<array.length;i++)
  if(array[i]==search)
    return array[i]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:25:30.547

好吧`O(n)`，这只是线性搜索；从头到尾遍历列表，直到遇到要搜索的内容。

奇怪的是你想要一个`O(n²)`算法......但是你可以做的是，在你的 for 循环的每次迭代中（在`O(n)`搜索中），休眠一个由数组长度定义的持续时间（`Thread.sleep(array.length)`）。“休眠”周期将`O(n)`线性依赖于数组的长度，并且整体线性搜索也将是`O(n)`，因此整个过程将是`O(n²)`。

* * *

***`O(n)`***

```
for (int i = 0 ; i < array.length ; i++) {
    if (array[i] == SOME_ELEMENT) {
        // ...
        break;
    }
 } 
```

***`O(n²)`***

```
for (int i = 0 ; i < array.length ; i++) {
    Thread.sleep(array.length);
    if (array[i] == SOME_ELEMENT) {
        // ...
        break;
    }
 } 
```

# r - 在 R 中查找独特的投资组合组合

> ID：13122465
> 
> 赞同：2
> 
> 时间：2012-10-29T13:21:23.710
> 
> 标签：r

给定一个股票代码符号向量：

```
 sp500 <- c("ABT", "ANF", "ADBE", "AMD", "AES", "AET" .. ) 
```

对于 N 个资产的投资组合，我如何找到这些的所有独特组合？因此，例如，如果 N=3 我想返回一个表/矩阵：

```
 A1   |    A2    |    A3
--------------------------
"ABT"      "ANF"     "ABDE"
"ABT"      "AMD"     "ABDE"
"ABT"      "AMD"     "AES"
  .          .          .
  .          .          .
"YHOO"    "YUM"      "ZMH" 
```

顺序无关紧要，所以我相信它是“组合”而不是“排列”。我正在尝试为此使用 R。

非常感谢我可以为此使用哪种功能/方法的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:35:46.137

`help.search("combination")`会给你答案：

```
combn(sp500,3) 
```

# php - PDO 对象未正确构造

> ID：13122468
> 
> 赞同：0
> 
> 时间：2012-10-29T13:21:34.087
> 
> 标签：php, mysql, pdo

我正在创建一个这样的 PDO 对象：

```
try {                                      
   $dbh = new PDO( "mysql:host=$host;dbname=$db_name" , $user, $passwd );     
} catch( PDOException $e ) {
   echo 'Caught exception: ', $e->getMessage(), "\n";
   die();
} 
```

但是没有错误，没有异常，并且 PDO 对象中没有任何内容：

```
var_dump( $dbh ); 
```

输出：

```
object(PDO)#5 (0) {
} 
```

用户名/密码和数据库名称都正确。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:25:24.100

这应该是一个有效的 PDO 对象。尝试使用它来确认。

是什么让您认为它“构造不正确”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:25:28.187

尝试 thi 进行 pdo 连接

```
 <?php
/* Connect to an ODBC database using driver invocation */
$dsn = 'mysql:dbname=testdb;host=127.0.0.1';
$user = 'dbuser';
$password = 'dbpass';

try {
    $dbh = new PDO($dsn, $user, $password);
} catch (PDOException $e) {
    echo 'Connection failed: ' . $e->getMessage();
}

?> 
```

当你运行这个时，你会得到 vardump($dbh) 作为

= 对象(PDO)#1 (0) { } =

参考：[这里](http://in1.php.net/manual/en/pdo.construct.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:35:09.617

您能否通过使用 PDO 安装在服务器上的 phpinfo() 函数来确认。如果 PDO 安装在服务器上，则使用以下方法连接到数据库：

```
 $dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass); 
```

主机：本地主机或取决于您的服务器。

dbname : 数据库名称

$user : 数据库用户名

$pass : 数据库密码

# iphone - 导航栏上的状态保存、导航控制器堆栈保存和手势识别器

> ID：13122469
> 
> 赞同：0
> 
> 时间：2012-10-29T13:21:42.447
> 
> 标签：iphone, ios, cocoa-touch, state-saving

我正在像这样加载我的视图控制器：

```
NSArray *viewControllerNames = [NSArray arrayWithContentsOfFile:path];
    for (NSString *viewControllerClass in viewControllerNames) {

        NSString *filePath = [self filePathForClass:NSClassFromString(viewControllerClass)];
        if ([[NSFileManager defaultManager] fileExistsAtPath:filePath]) {
            id viewController = [NSKeyedUnarchiver unarchiveObjectWithData:[NSData dataWithContentsOfFile:filePath]];

            [self pushViewController:viewController animated:NO];
        }
    } 
```

在我的堆栈的根视图控制器上，我在导航栏中添加了一个手势识别器。

但是，如果我将某个视图控制器推到顶部，它将不会加载此手势，因为`viewDidLoad`不会调用根视图控制器，并且如果我访问它的`viewControllers`属性，`UINavigationController`则返回 nil。

任何想法如何继续这个手势？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:28:50.030

如何使用`setViewControllers:animated:`而不是一一推送单个视图控制器？

```
NSMutableArray * viewControllers = [[NSMutableArray alloc] init];
for(...) { // the same for loop you have 
    ...
    [viewControllers addObject:viewController];
}
[self setViewControllers:viewControllers animated:YES]; 
```

# git - 如何使用 maven 进行 git push

> ID：13122471
> 
> 赞同：2
> 
> 时间：2012-10-29T13:21:48.667
> 
> 标签：git, maven

作为我构建的一部分，我正在创建一些文件。我希望 Maven 提交并推送这些文件。

我查看了 maven-scm 插件，但看不到如何推送。我可以看到提交但看不到推送。

有什么办法可以用 maven 做 git push 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:28:09.923

见[http://maven.apache.org/scm/maven-scm-plugin/checkin-mojo.html#pushChanges](http://maven.apache.org/scm/maven-scm-plugin/checkin-mojo.html#pushChanges)

> **推送更改**
> 
> 是否应该将分布式更改推送到中央存储库？对于像 Git 这样的许多分布式 SCM，像提交这样的更改只存储在存储库的本地副本中。推送更改可以让您更轻松地与其他用户共享它。
> 
> 类型：布尔值
> 
> 自：1.4
> 
> 要求：否
> 
> 表达式：${pushChanges}
> 
> 默认值：真

（没有更多上下文，很难判断这是否真的是一个好主意。这取决于。）

# android - org.apache.commons.collections.BeanMap：找不到引用的类 java.beans.Introspector

> ID：13122476
> 
> 赞同：4
> 
> 时间：2012-10-29T13:22:09.967
> 
> 标签：android, intellij-idea, proguard

我正在尝试使用 Proguard 来混淆我的 Android 应用程序。此外，我正在使用 IntelliJ Idea 11.1.3 构建发布签名的 APK，并在 Open Module Settings -> Facets -> Compiler -> Run Proguard 中选择了*Run Proguard选项。*

当我不使用 Proguard 但使用 Proguard 时，应用程序正在编译且没有任何错误，但出现以下错误

```
Error:[MyApp] Warning: org.apache.commons.collections.BeanMap: can't find referenced class java.beans.Introspector
Error:[MyApp] Warning: org.apache.commons.collections.BeanMap: can't find referenced class java.beans.BeanInfo
Error:[MyApp] Warning: org.apache.commons.collections.BeanMap: can't find referenced class java.beans.PropertyDescriptor
Error:[MyApp] Warning: org.apache.commons.collections.BeanMap: can't find referenced class java.beans.IntrospectionException
Error:[MyApp] Warning: there were 14 unresolved references to classes or interfaces.
Error:[MyApp]          You may need to specify additional library jars (using '-libraryjars').
Error:[MyApp] Error: Please correct the above warnings first. 
```

如何消除这些错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-30T15:31:03.483

我添加了以下几行并删除了错误

```
-dontwarn org.apache.commons.collections.BeanMap
-dontwarn java.beans.** 
```

# php - 维护模式期间超级管理员的应用程序可见性

> ID：13122477
> 
> 赞同：0
> 
> 时间：2012-10-29T13:22:09.873
> 
> 标签：php, .htaccess, maintenance-mode

我的应用程序现在已经完全构建好了。但有时我需要将其关闭以进行维护。所以我创建了一个 .htaccess 文件，现在当用户尝试打开应用程序时，他们会被重定向到一个包含维护图像的不同页面。问题是超级管理员完成维护后，他们需要检查应用程序现在是否正常运行。但是没有办法做到这一点，因为即使他们被导航到维护页面。解决方案之一是创建测试环境。但是他们还有其他简单的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:30:13.020

如果您在 .htaccess 文件中有一些静态 IP，您可以尝试执行以下操作：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REMOTE_ADDR} !^11\.111\.111\.111
RewriteCond %{REQUEST_URI} !^/maintenance\.html$
RewriteRule ^(.*)$ http://domain.com/maintenance.html [R=307,L] 
```

如果需要，Ypu 可以为超过 1 个 'admin' ip 指定多个 REMOTE_ADDR 行。

这会将未提及 IP 的任何人发送到维护页面。

一种**替代**方法是在 PHP 中处理维护模式...基本上，您可以在 php 脚本中拥有 IP 列表并显示维护页面或正常运行应用程序...显然这样的解决方案需要正确放置在流程中你的代码和一些简单的机制来启用/禁用站点。

# crash-reports - 核心转储，批准，没有崩溃报告

> ID：13122480
> 
> 赞同：3
> 
> 时间：2012-10-29T13:22:23.757
> 
> 标签：crash-reports, coredump

我正在使用 ubuntu 12.04，并且我有一个应用程序，当我运行时，退出：

```
./ardrone_navigation 
Setting locale to en_GB.UTF-8
Errore di segmentazione (core dump creato) 
```

如果我像普通用户或 root 一样运行它，问题是一样的

，但我找不到核心转储.....，我已经检查过了

```
cat /proc/sys/kernel/core_pattern
|/usr/share/apport/apport %p %s %c 
```

但

```
apport-cli 
Nessuna segnalazione di crash pendente. Provare --help per maggiori informazioni.
(no crash pending) 
```

然后我尝试

```
strace ./ardrone_navigation 
```

现在，我有很多输出到控制台，如果我再次运行 apport-cli ，它有一个报告，但对于 strace 程序......

为什么？我需要知道什么？（我是这个问题的新手）

strace 最后一行是

```
open("/usr/lib/locale/locale-archive", O_RDONLY|O_LARGEFILE|O_CLOEXEC) = 5
fstat64(5, {st_mode=S_IFREG|0644, st_size=4455872, ...}) = 0
mmap2(NULL, 4096, PROT_READ, MAP_PRIVATE, 5, 0x432) = 0xb5c5a000
close(5)                                = 0
fstat64(1, {st_mode=S_IFCHR|0600, st_rdev=makedev(136, 6), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb5c59000
write(1, "Setting locale to en_GB.UTF-8\n", 30Setting locale to en_GB.UTF-8) = 30
socket(PF_NETLINK, SOCK_RAW, 0)         = 5
bind(5, {sa_family=AF_NETLINK, pid=0, groups=00000000}, 12) = 0
getsockname(5, {sa_family=AF_NETLINK, pid=4221, groups=00000000}, [12]) = 0
time(NULL)                              = 1351515893
sendto(5, "\24\0\0\0\22\0\1\3\365~\216P\0\0\0\0\0\0\0\0", 20, 0, {sa_family=AF_NETLINK,pid=0, groups=00000000}, 12) = 20
recvmsg(5, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"\340\3\0\0\20\0\2\0\365~\216P}\20\0\0\0\0\4\3\1\0\0\0I\0\1\0\0\0\0\0"..., 4096}],msg_controllen=0, msg_flags=0}, 0) = 3008
recvmsg(5, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"\350\3\0\0\20\0\2\0\365~\216P}\20\0\0\0\0\1\0\4\0\0\0C\20\1\0\0\0\0\0"..., 4096}],msg_controllen=0, msg_flags=0}, 0) = 2988
recvmsg(5, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"\24\0\0\0\3\0\2\0\365~\216P}\20\0\0\0\0\0\0\4\0\0\0C\20\1\0\0\0\0\0"..., 4096}],msg_controllen=0, msg_flags=0}, 0) = 20
sendto(5, "\24\0\0\0\26\0\1\3\366~\216P\0\0\0\0\0\0\0\0", 20, 0, {sa_family=AF_NETLINK, pid=0, groups=00000000}, 12) = 20
recvmsg(5, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"0\0\0\0\24\0\2\0\366~\216P}\20\0\0\2\10\200\376\1\0\0\0\10\0\1\0\177\0\0\1"..., 4096}],     msg_controllen=0, msg_flags=0}, 0) = 228
recvmsg(5, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"@\0\0\0\24\0\2\0\366~\216P}\20\0\0\n\200\200\376\1\0\0\0\24\0\1\0\0\0\0\0"..., 4096}],     msg_controllen=0, msg_flags=0}, 0) = 448
recvmsg(5, {msg_name(12)={sa_family=AF_NETLINK, pid=0, groups=00000000}, msg_iov(1)=[{"\24\0\0\0\3\0\2\0\366~\216P}\20\0\0\0\0\0\0\1\0\0\0\24\0\1\0\0\0\0\0"..., 4096}],     msg_controllen=0, msg_flags=0}, 0) = 20
>close(5)                                = 0
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV (core dumped) +++
Errore di segmentazione (core dump creato) 
```

dmsg 是：

```
[ 2650.115445] ardrone_navigat[4026]: segfault at 0 ip 080a99c3 sp bf91c1d0 error 4 in ardrone_navigation[8048000+29b000]
[ 2960.022708] ardrone_navigat[4206]: segfault at 0 ip 080a99c3 sp bfcdeec0 error 4 in ardrone_navigation[8048000+29b000]
[ 3588.294821] ardrone_navigat[4236]: segfault at 0 ip 080a99c3 sp bfedf3b0 error 4 in ardrone_navigation[8048000+29b000] 
```

仅当我不称它为 trought strace 时才填充

谢谢大卫

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T05:11:29.887

如果您想要一个核心转储文件，即使将核心转储发送到 apport，请确保您的 RLIMIT_CORE 设置（通常使用 ulimit -c 设置）大于 0（并且您可能希望它足够大以至于它不会截断您的核心转储）。如果它大于 0，apport 似乎尊重此设置并在当前工作目录中生成一个核心文件。

（我仅在 Ubuntu 12.04 下对此进行了测试。）

# android - 如何通过单击一个按钮来更改完整的 android 应用程序的颜色？

> ID：13122484
> 
> 赞同：2
> 
> 时间：2012-10-29T13:22:38.623
> 
> 标签：android, android-theme

目前我正在为Android上的智能手机构建一个应用程序，用于控制望远镜。要求之一是能够通过按一个按钮切换到“夜景”模式。

在“夜景”模式下，应用程序的盖子很暗，所有的 UI 元素都是一种颜色（红色）。

在所有生命周期变化期间，颜色和照明级别应该相同。因此，当更改到应用程序的另一部分、使用微调器、使用内置键盘输入文本或执行某些其他任务时，不会出现白色闪烁。

虽然我是 Android 编程的新手，但我知道如何更改 XML 文件中 UI 元素的颜色或通过按按钮以编程方式更改。我无法对应用程序中的所有元素和内置键盘执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:29:45.343

您将需要为您的应用程序创建两个不同的主题，其中包含按钮 textColor、背景颜色和所有恶作剧的样式信息。然后在您的 xml 中，您将希望引用样式而不是颜色/文本等的特定颜色。

按下按钮切换主题，这些主题将具有不同（但名称相似）的样式，您的 xml 布局现在将引用这些样式。

在按下按钮时，你会想要做这样的事情。

```
 setTheme(R.style.Theme_Day); 
```

更多看这里。 [http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

# c# - 如何禁用 MVC 4 模型验证？

> ID：13122485
> 
> 赞同：6
> 
> 时间：2012-10-29T13:22:39.103
> 
> 标签：c#, asp.net-mvc, model-validation

我正在开发一个在 mvc 4 上编写的项目，该项目有几个类似向导的行为实例——通过相同的半填充模型的少数视图链。从第二个视图开始，控件最初显示为无效（这是逻辑模型，传递给控制器​​方法的相应属性为空）。当前 `ModelState.Clear();` 使用了解决方案，但将其放入每个方法中，模型作为参数看起来很难看。与此处找到的方法相同[在 Asp.Net MVC 中禁用模型验证](https://stackoverflow.com/questions/3578781/disable-model-validation-in-asp-net-mvc)

```
ModelBinders.Binders[typeof(MyModelType)] = new NonValidatingModelBinder(); 
```

项目有太多（超过 100 个）模型类，无法手动注册每个模型类。

是否有更简单的方法（可能是 .config 中的键）完全关闭模型验证？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-29T13:29:28.280

我不知道这是否可行，但您尝试过吗（引导代码或 global.asax）

```
ModelValidatorProviders.Providers.Clear(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T14:08:05.193

我知道它并不能真正回答您的问题，而只是为了扩展我的评论：-

听起来你有类似的东西： -

```
public class MyModel
{
  [Required]
  public string Foo { get; set; } // Populated in step 1
  [Required]
  public string Bar { get; set; } // Populated in step 2
} 
```

您在发布第 1 步时遇到问题，因为用户尚未输入值`Bar`，所以有一个`ModelStateError`.

我首选的解决方案，而不是试图搞乱你的持久性模型的验证，将你的 View 实现与你的 Model 实现分离，每个向导步骤都有一个 ViewModel，例如：-

```
public class MyModel
{
  [Required]
  public string Foo { get; set; }
  [Required]
  public string Bar { get; set; }
}

public class StepOneModel
{
  [Required]
  public string Foo { get; set; }
}

public class StepTwoModel
{
  // This really depends on the behaviour you want.
  // In this example, the model isn't persisted until
  // the last step, but you could equally well persist
  // the partial model server-side and just include a
  // key in subsequent wizard steps.
  [Required]
  public StepOneModel StepOne { get; set; }

  [Required]
  public string Bar { get; set; }
} 
```

您的控制器操作如下所示：-

```
public ActionResult StepOne()
{
  return View(new StepOneViewModel());
}
[HttpPost]
public ActionResult StepOne(StepOneViewModel model)
{
  if(ModelState.IsValid)
  {
    var stepTwoModel = new StepTwoViewModel ()
    {
      StepOne = model
    };

    // Again, there's a bunch of different ways
    // you can handle flow between steps, just
    // doing it simply here to give an example
    return View("StepTwo", model);
  }

  return View(model);
}
[HttpPost]
public ActionResult StepTwo(StepTwoViewModel model)
{
  if (ModelState.IsValid)
  {
    // You could also add a method to the final ViewModel
    // to do this mapping, or use something like AutoMapper
    MyModel model = new MyModel()
    {
      Foo = model.StepOne.Foo
      Bar = model.Bar
    };

    this.Context.MyModels.Add(model);
    this.Context.SaveChanges();
  }

  return View(model);
} 
```

您的 StepOne 视图类似于：-

```
@model StepOneModel
@using (html.BeginForm()) {
   @html.EditorFor(x => x.Foo);
} 
```

您的 StepTwo 视图类似于：-

```
@model StepTwoModel
@using (html.BeginForm("StepTwo")) {
  @html.HiddenFor(x => x.StepOne);
  @html.EditorFor(x => x.Bar);
} 
```

与仅关闭模型验证相比的主要优点是，您可以将当前步骤的验证要求放在 ViewModel 上 - 您可以确保第一步中的所有值都有效，然后再进行第二步。

*   如果您想要一种更 RESTful 的方法（您的控制器不关心数据来自向导样式的视图），另一种流行的解决方案是将每个步骤包装在 <div> 客户端并使用 javascript 隐藏/显示他们随着用户的进步。

*   如果您的模型需要在步骤之间保持不变，那么您需要考虑模型上的 ValidationAttributes 以及它们的含义。如果您已使用 注释`User.DateOfBirth`，`Required`但您需要能够在填充它的步骤之前将其持久化，那么实际上`User.DateOfBirth` *不需要*（例如，EF CodeFirst 不能使列 NOT NULL，因为我们需要能够持久化同时为空值）。您需要进行一些条件验证（例如[IValidatableObject](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.ivalidatableobject.aspx)、[MvcFoolproof](http://foolproof.codeplex.com/)、[Fluent Validation](http://fluentvalidation.codeplex.com/)），以便稍后验证您的完整模型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T13:27:08.037

我不知道 web.config 中的所有选项或类似的东西。但是你可以使用这个：

```
Assembly.GetExecutingAssembly()
   .GetTypes()
   .Where(t => t.IsClass && t.Namespace == "Your.Name.Space")
   .ToList()
   .ForEach(t => ModelBinders.Binders[t] = new NonValidatingModelBinder()); 
```

或者

```
typeof(MyModelType)
   .Assembly
   .GetTypes()
   .Where(t => t.IsClass && t.Namespace == "Your.Name.Space")
   .ToList()
   .ForEach(t => ModelBinders.Binders[t] = new NonValidatingModelBinder()); 
```

或者删除该`&& t.Namespace == "Your.Name.Space"`部分，以便它将程序集中的**所有**类添加到 NonValidatingModelBinder。

不要忘记添加`using System.Linq;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-05T11:24:57.207

```
@{
HtmlHelper.ClientValidationEnabled = false;
} 
```

# haskell - 什么是 Monad 的一个例子，它是一个 Alternative 但不是 MonadPlus？

> ID：13122489
> 
> 赞同：26
> 
> 时间：2012-10-29T13:22:53.190
> 
> 标签：haskell, monads, applicative, alternative-functor, monadplus

Edward Kmett在[回答](https://stackoverflow.com/a/10168111/237428)[“类型类](https://stackoverflow.com/q/10167879/237428)[、](https://stackoverflow.com/q/10167879/237428)[和](https://stackoverflow.com/q/10167879/237428)? 之间的区别[”</a> 问题时说](https://stackoverflow.com/q/10167879/237428)[`MonadPlus``Alternative``Monoid`](https://stackoverflow.com/q/10167879/237428)

 [> 此外，即使`Applicative`是 的超类`Monad`，你最终还是需要这个`MonadPlus`类，因为服从
> 
> ```
> empty <*> m = empty 
> ```
> 
> 不足以证明
> 
> ```
> empty >>= f = empty 
> ```
> 
> 因此，声称某物是 a`MonadPlus`比声称它是 强`Alternative`。

很明显，任何不是monad 的 applicative functor 都会自动成为 an which is not a*的*一个例子，但 Edward Kmett 的回答暗示存在一个*monad*，它是 an但不是 a ：它并且会满足定律，¹但不是法律。² 我自己想不出这样的例子；有人知道吗？`Alternative``MonadPlus`*`Alternative``MonadPlus``empty``<|>``Alternative`^(`MonadPlus`)*

 ** * **](https://stackoverflow.com/q/10167879/237428) 

*[¹我无法找到一组`Alternative`法律的规范参考，但我列出了我认为它们大约是我对“类型类](https://stackoverflow.com/q/10167879/237428)[的含义](https://stackoverflow.com/q/13080606/237428)[及其与其他类型的关系](https://stackoverflow.com/q/13080606/237428)感到困惑”问题[的答案的一半](https://stackoverflow.com/a/13081604/237428)[类”</a>（搜索短语“右分布”）。](https://stackoverflow.com/q/13080606/237428)[我认为应该遵守的四项法则是：](https://stackoverflow.com/q/13080606/237428)[`Alternative`](https://stackoverflow.com/q/13080606/237428)*

 *[1.  **（的）右分配`<*>`：**  `(f <|> g) <*> a = (f <*> a) <|> (g <*> a)`
2.  **右吸收（对于`<*>`）：**  `empty <*> a = empty`
3.  **左分布（的`fmap`）：**  `f <$> (a <|> b) = (f <$> a) <|> (f <$> b)`
4.  **左吸收（对于`fmap`）：**  `f <$> empty = empty`

我也很乐意接受获得一套更有用的`Alternative`法律。](https://stackoverflow.com/q/13080606/237428) 

[²我知道](https://stackoverflow.com/q/13080606/237428)[法律是](http://www.haskell.org/haskellwiki/MonadPlus)[什么有些含糊不清`MonadPlus`](http://www.haskell.org/haskellwiki/MonadPlus)；我对使用左分布或左捕获的答案感到满意，尽管我更喜欢前者。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-29T15:19:52.140

您的答案的线索在[HaskellWiki 关于 MonadPlus 您链接到](http://www.haskell.org/haskellwiki/MonadPlus)：

> 有哪些规则？Martin & Gibbons 选择 Monoid、Left Zero 和 Left Distribution。这会`[]`生成 MonadPlus，但不会生成`Maybe`or `IO`。

所以根据你喜欢的选择，`Maybe`不是 MonadPlus （虽然有一个实例，但它不满足左分布）。让我们证明它满足替代方案。

## `Maybe`是另一种选择

1.  **（的）右分配`<*>`：** `(f <|> g) <*> a = (f <*> a) <|> (g <*> a)`

案例一`f=Nothing`：：

```
(Nothing <|> g) <*> a =                    (g) <*> a  -- left identity <|>
                      = Nothing         <|> (g <*> a) -- left identity <|>
                      = (Nothing <*> a) <|> (g <*> a) -- left failure <*> 
```

案例2 `a=Nothing`：：

```
(f <|> g) <*> Nothing = Nothing                             -- right failure <*>
                      = Nothing <|> Nothing                 -- left identity <|>
                      = (f <*> Nothing) <|> (g <*> Nothing) -- right failure <*> 
```

案例3：`f=Just h, a = Just x`

```
(Just h <|> g) <*> Just x = Just h <*> Just x                      -- left bias <|>
                          = Just (h x)                             -- success <*>
                          = Just (h x) <|> (g <*> Just x)          -- left bias <|>
                          = (Just h <*> Just x) <|> (g <*> Just x) -- success <*> 
```

1.  **右吸收（对于`<*>`）：** `empty <*> a = empty`

这很容易，因为

```
Nothing <*> a = Nothing    -- left failure <*> 
```

1.  **左分布（的`fmap`）：** `f <$> (a <|> b) = (f <$> a) <|> (f <$> b)`

情况1：`a = Nothing`

```
f <$> (Nothing <|> b) = f <$> b                        -- left identity <|>
                 = Nothing <|> (f <$> b)          -- left identity <|>
                 = (f <$> Nothing) <|> (f <$> b)  -- failure <$> 
```

案例二：`a = Just x`

```
f <$> (Just x <|> b) = f <$> Just x                 -- left bias <|>
                     = Just (f x)                   -- success <$>
                     = Just (f x) <|> (f <$> b)     -- left bias <|>
                     = (f <$> Just x) <|> (f <$> b) -- success <$> 
```

1.  **左吸收（对于`fmap`）：** `f <$> empty = empty`

另一个简单的：

```
f <$> Nothing = Nothing   -- failure <$> 
```

## `Maybe`不是 MonadPlus

让我们证明`Maybe`不是 MonadPlus 的断言：我们需要证明它`mplus a b >>= k = mplus (a >>= k) (b >>= k)`并不总是成立。与以往一样，诀窍是使用一些绑定将非常不同的值偷偷出来：

```
a = Just False
b = Just True

k True = Just "Made it!"
k False = Nothing 
```

现在

```
mplus (Just False) (Just True) >>= k = Just False >>= k
                                     = k False
                                     = Nothing 
```

在这里，我使用 bind从胜利的`(>>=)`口中抢夺失败（`Nothing`），因为`Just False`看起来像成功。

```
mplus (Just False >>= k) (Just True >>= k) = mplus (k False) (k True)
                                           = mplus Nothing (Just "Made it!")
                                           = Just "Made it!" 
```

这里的失败（`k False`）是提前计算出来的，所以被忽略了，我们`"Made it!"`。

所以，`mplus a b >>= k = Nothing`但是`mplus (a >>= k) (b >>= k) = Just "Made it!"`。

您可以将其视为我`>>=`用来打破`mplus`for的左偏`Maybe`。

## 我的证明的有效性：

以防你觉得我没有做足够乏味的推导，我将证明我使用的身份：

首先

```
Nothing <|> c = c      -- left identity <|>
Just d <|> c = Just d  -- left bias <|> 
```

来自实例声明

```
instance Alternative Maybe where
    empty = Nothing
    Nothing <|> r = r
    l       <|> _ = l 
```

第二

```
f <$> Nothing = Nothing    -- failure <$>
f <$> Just x = Just (f x)  -- success <$> 
```

这只是来自`(<$>) = fmap`和

```
instance  Functor Maybe  where
    fmap _ Nothing       = Nothing
    fmap f (Just a)      = Just (f a) 
```

第三，其他三个需要更多的工作：

```
Nothing <*> c = Nothing        -- left failure <*>
c <*> Nothing = Nothing        -- right failure <*>
Just f <*> Just x = Just (f x) -- success <*> 
```

这来自定义

```
instance Applicative Maybe where
    pure = return
    (<*>) = ap

ap :: (Monad m) => m (a -> b) -> m a -> m b
ap =  liftM2 id

liftM2  :: (Monad m) => (a1 -> a2 -> r) -> m a1 -> m a2 -> m r
liftM2 f m1 m2          = do { x1 <- m1; x2 <- m2; return (f x1 x2) }

instance  Monad Maybe  where
    (Just x) >>= k      = k x
    Nothing  >>= _      = Nothing
    return              = Just 
```

所以

```
mf <*> mx = ap mf mx
          = liftM2 id mf mx
          = do { f <- mf; x <- mx; return (id f x) }
          = do { f <- mf; x <- mx; return (f x) }
          = do { f <- mf; x <- mx; Just (f x) }
          = mf >>= \f ->
            mx >>= \x ->
            Just (f x) 
```

所以 if `mf`or `mx`are Nothing，结果也是`Nothing`，而 if `mf = Just f`and `mx = Just x`，结果是`Just (f x)`*

# html - 使用 div 标签链接网页的多个部分

> ID：13122490
> 
> 赞同：-2
> 
> 时间：2012-10-29T13:22:55.437
> 
> 标签：html

我使用 div 标签将网页垂直分为两部分。

我想要的是左 div 的锚标签应该在点击链接时显示内容，在右 div 中。我如何使用或不使用 javascript 进行 dis 操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:31:52.850

看看这个：

[http://www.w3schools.com/html/html_iframe.asp](http://www.w3schools.com/html/html_iframe.asp)

和

[http://www.w3schools.com/html/tryit.asp?filename=tryhtml_iframe_target](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_iframe_target)

我认为这很简单......

无论如何，这是一个很好的衡量标准：

在要填充的 div 中放置一个 iframe，如下所示：

```
<iframe 
      src="url_of_whatever_stuff_you_want_to_populate_it_with_initially" 
      name="my_iframe>
</iframe> 
```

然后为每个锚添加目标属性：

```
<a target = "my_iframe" etc etc... 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-29T13:29:18.080

没有 Javascript 是不可能的，除非你想使用古怪、不直观的 C​​SS 样式。

请参阅此处：[如何使用 css 通过 href #id 隐藏锚标记](https://stackoverflow.com/questions/9165479/how-to-hide-an-anchor-tag-by-href-id-using-css)

你最好使用一个简单的 onClick 事件来显示和隐藏这些 div。

# c++ - 有效文件夹名称的正则表达式 c++ (windows)

> ID：13122492
> 
> 赞同：0
> 
> 时间：2012-10-29T13:22:59.977
> 
> 标签：c++, regex, qt, directory

我正在尝试使用正则表达式验证给定的文件夹名称，我尝试了一些测试并且效果很好，如果我完全安全或者我的 reg 表达式遗漏了什么，请告诉我：

```
 QRegExp regExp("^( [a-zA-Z] )( ( [a-zA-Z_\-\s0-9\.\)\(] )( [^\\!@#$%^&/:*?<>""|]* ) )*$" );
        QStringList ForbidenNameU;
        ForbidenNameU<<"CON"<<"PRN"<<"AUX"<<"NUL"<<"COM"<<"COM1"<<"COM2"<<"COM3"<<"COM4"<<"COM5"<<"COM6"<<"COM7"<<"COM8"<<"COM9"<<"LPT"<<"LPT1"<<"LPT2"<<"LPT3"<<"LPT4"<<"LPT5"<<"LPT6"<<"LPT7"<<"LPT8"<<"LPT9";
        QStringList ForbidenName;
        ForbidenName<<"con"<<"prn"<<"aux"<<"nul"<<"com"<<"com1"<<"com2"<<"com3"<<"com4"<<"com5"<<"com6"<<"com7"<<"com8"<<"com9"<<"lpt"<<"lpt1"<<"lpt2"<<"lpt3"<<"lpt4"<<"lpt5"<<"lpt6"<<"lpt7"<<"lpt8"<<"lpt9";

        if((Dirname->text().contains(regExp))&& !ForbidenNameU.contains(Dirname->text())&& !ForbidenName.contains(Dirname->text()))
        {
            validname=true;
            qDebug()<<"match in dir name = "<<regExp.cap(0);
            emit completeChanged();
        }... 
```

PS（我不想使用`GetInvalidFileNameChars()`或任何其他 api ）

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:52:00.530

在 Windows 环境中：

```
^(?!(?:CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])(?:\.[^.]*)?$)[^<>:"/\\|?*\x00-\x1F]*[^<>:"/\\|?*\x00-\x1F\ .]$ 
```

使用 CASE_INSENSITIVE 和 UNICODE_CASE 修饰符。

* * *

```
^                                # Anchor to start of string.        
(?!                              # Assert filename is not: CON, PRN, 
  (?:                            # AUX, NUL, COM1, COM2, COM3, COM4, 
    CON|PRN|AUX|NUL|             # COM5, COM6, COM7, COM8, COM9,     
    COM[1-9]|LPT[1-9]            # LPT1, LPT2, LPT3, LPT4, LPT5,     
  )                              # LPT6, LPT7, LPT8, and LPT9...     
  (?:\.[^.]*)?                   # followed by optional extension    
  $                              # and end of string.                 
)                                # End negative lookahead assertion. 
[^<>:"/\\|?*\x00-\x1F]*          # Zero or more valid filename chars.
[^<>:"/\\|?*\x00-\x1F\ .]        # Last char is not a space or dot.  
$                                # Anchor to end of string. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:56:23.850

对于某些系统来说这肯定是错误的，因为有效的目录名称取决于系统，甚至可能取决于实际的文件系统：远程安装的文件系统通常必须遵守文件系统主机的约定，而不是本地系统。

面对这种情况，有两种解决方案，具体看你要解决的实际问题。最简单的一种就是尝试创建文件，并检查返回的错误。这将使您快速轻松地检查名称在当前环境中是否合法。但是，如果您需要创建以后可以在任何地方读取的层次结构，最好的解决方案是采用非常保守的方法，只允许字母数字字符和一个`'_'`，甚至可能只允许小写和数字（以避免意外创建的任何风险两个目录，其名称只是大小写不同）。您可能还想限制长度。（从历史上看，有些系统只允许六个字符，但今天听起来有点过分了。）

关于禁止名称：这也非常依赖于系统，并且可能取决于创建目录的位置。（在 Unix 下没有保留名称，但如果您尝试在特定目录中使用某些名称，几乎肯定会遇到麻烦：`"local"`一般来说没问题，但我不会尝试在 . 下创建它`"/usr/"`。）

# android - 管理android应用程序的生命周期

> ID：13122495
> 
> 赞同：2
> 
> 时间：2012-10-29T13:23:04.997
> 
> 标签：android, service, android-intent

在我的 android 项目中，我有一个包含流地址列表（音乐）的类

我应该保留该课程，这样我就不必重新填写该列表了吗？

可能有许多不同的屏幕（活动），我会将它们推入屏幕或从中拉回。

在这些和屏幕变化之间（破坏活动），列表将丢失......

这个逻辑是否需要服务来保存列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:17:56.027

您可以将列表存储在静态单例中，或者存储在扩展`Application`. 反过来可以从带有`getApplication()`.

如果使用得当，静态单例将与应用程序类以相同的方式运行，除了单例可以从任何地方访问，而应用程序类只能通过上下文访问。

[这里](https://stackoverflow.com/questions/3826905/singletons-vs-application-context-in-android)有一个相关的问题，关于 Application 和 singleton 之间的区别是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:32:02.773

不，你不需要这样做。

通常，如果您有一个长时间运行的类需要在整个 Activity 生命周期中生存，那么将它放在绑定服务中就可以了。它需要您通过 IPC 传输数据。在这种情况下，应该没关系。由于您本质上是在处理一个`String`数组，因此您可以将其放入您即将开始的`Intent`对象中或放入对象中。`Activity``Bundle``Intent`

在创建 Activity 时，只需`Bundle`使用`Intent#getExtras()`方法打开并重建您的列表。与带有`Service`.

编辑：

您可以尝试的一件事是覆盖该`Application`对象。您必须在 中指定新的入口点`Manifest`，但如果您`Singleton`从`Application`类构建并在那里保存引用，只要您的应用程序正在运行，它就应该保持活动状态。但是，当您离开时，它将被销毁。

# iphone - 在建筑物上创建叠加层（在校园大学中）

> ID：13122503
> 
> 赞同：1
> 
> 时间：2012-10-29T13:23:54.143
> 
> 标签：iphone, ios, xcode, ios6, mapquest

今年我正在做我的项目，我的任务是创建一个与校园建筑互动的 iPhone 应用程序。我正在运行 iOS6，因此我无法使用 Apple Maps。经过数小时的搜索，我找到了 MapQuest(OSM)。目前，我已经实现了在建筑物上绘制叠加层，但这需要很多时间，才能找到并传递正确的纬度/经度。过去，我在 Android 手机上工作过，我使用 KML 文件来绘制路线等。直到现在，我找不到任何与 MapQuest 类似的东西（点与谷歌地图略有不同）。

有谁知道一种有效的方法来检索建筑物的精确纬度/经度点并使用 MapQuest 绘制其叠加层？实现这一点很重要，因为我的主要目标是让用户可以点击该建筑物或区域。请帮忙，我迷路了。

提前致谢

# vbscript - 使用 vbscript 转到路径并读取 txt 文件

> ID：13122504
> 
> 赞同：0
> 
> 时间：2012-10-29T13:23:55.090
> 
> 标签：vbscript

我有一个完整的目录列表，我想遍历这些目录并打开 txt 文件。然后读取该txt文件中的数据并分配给一个变量。

这是目录列表的示例，如下所示：

```
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[ Go! Go! Heaven!!]_____________25 -______ ___- [525067]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[12CUT] _____ (Gakkou no Kaidan) [518382]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[2____] _____!__CD__________ [521206]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[Ability] _____________________ [514182]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[Abo Manten] Kyuusho seme maniacs vol. 3 (Weak Spot Maniacs vol.3) [521993]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[Afro] Futanari angel cg collection [521560]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[Aim-ZERO] Case Vol.4 [519927]\test.txt
C:\Documents and Settings\Administrator\Desktop\ArtistCG\[Air Hike] ________CG_2 [525114]\test.txt 
```

现在这里是代码

```
Option Explicit

Dim objFSO, strTextFile, strData, strLine, arrLines
CONST ForReading = 1

'name of the text file
strTextFile = "C:\Documents and Settings\Administrator\Desktop\ArtistCG\folders.txt"

'Create a File System Object
Set objFSO = CreateObject("Scripting.FileSystemObject")

'Open the text file - strData now contains the whole file
strData = objFSO.OpenTextFile(strTextFile,ForReading).ReadAll

'Split the text file into lines
arrLines = Split(strData,vbCrLf)

'Step through the lines
For Each strLine in arrLines
wscript.echo strLine
Next

'Cleanup
Set objFSO = Nothing 
```

现在代码的问题是它读取folders.txt的数据，而不是去目录并读取test.txt文件。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:34:16.190

而不是这个：

```
wscript.echo strLine 
```

你需要这样做：

```
text = objFSO.OpenTextFile(strLine, ForReading).ReadAll 
```

但是，这会在每次迭代时覆盖变量的内容`text`，因此您需要决定是将所有文件的文本放入单个变量（将从文件读取的文本附加到变量中）还是放入单独的变量中（将每个文件读入数组的单独字段或类似的字段）。

# java - Java，托管应用程序关闭作为对 CTRL^D 的响应

> ID：13122505
> 
> 赞同：0
> 
> 时间：2012-10-29T13:23:57.583
> 
> 标签：java, event-handling, shutdown, multiplatform

我开发了一个 Java 在线分布式应用程序，它通常一直处于活动状态（**不是 GUI**）。

我有兴趣在关机前执行一些步骤，以防管理员对此类关机感兴趣。

我知道 CTRL^C 会停止 JVM，我想知道我是否可以在 JVM 关闭之前挂钩 CTRL^C 并执行一些额外的操作，或者在 CTRL^D 事件中添加一些挂钩以执行相同的操作。

我几乎可以肯定某处有一篇文章描述了类似的问题，我会很感激这些帖子的链接。

我对任何第三方外部 jar 或任何 JNI 解决方案都不感兴趣。

如果没有讨论相同问题的帖子，我将不胜感激代码示例片段。

附加限制：**此解决方案应适用于 UNIX 和 Windows。**

**编辑**

这里提出的一种解决方案是使用`Runtime.getRuntime().addShutdownHook(new Thread() {})`

据我了解，创建了一个新线程，它将侦听并等待关闭事件发生。

1.  我想知道是否可以以某种方式向主线程发出关闭发生的信号（我有一个分布式系统，正如我提到的，我需要通知每个单个线程此类事件）？

2.  我可以添加多个线程来监听这个事件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:10:42.193

要对 CTRL+C 做出反应，您必须添加一个关闭挂钩：

```
Runtime.getRuntime().addShutdownHook(new Thread() {
    public void run() {
        System.out.println("I'll be back!");
    }
}); 
```

# show-hide - 根据先前选择的答案显示说明

> ID：13122510
> 
> 赞同：1
> 
> 时间：2012-10-29T13:24:07.840
> 
> 标签：show-hide

我需要创建一个非常简单的基于 Web 的工具，用于根据用户回答的问题向用户提供与开源许可相关的说明。我希望一次显示一个问题，然后根据上一个问题的答案显示下一个问题或说明。

这应该很容易实现，但是零编程技能我无法自己做到这一点。有人能用这个引导我走向正确的方向吗？以下是规格：

1 选择许可证 a) Apache b) MIT c) BSD d) LGPL v2 e) LGPL v3 f) GPL v2 g) GPL v3

*   如果 A、B 或 C > 显示指令 X
*   如果 D、E、F、G > 显示问题 2

2 GPL/LGPL 组件是否已分发？a) 是 b) 不是

*   如果 A > 显示问题 3
*   如果 B > 显示指令 Y

3 商业/专有许可证可用吗？a) 是 b) 否 c) 是，但负担不起

*   如果 A > 显示指令 Z
*   如果 B > 如果 1D/1E 显示问题 4 或如果 1F/1G 显示指令 Q
*   如果 C > 如果 1D/1E 则显示问题 4 或如果 1F/1G 则显示指令 Q

4 LGPL 组件是否与公司的专有软件相结合？a) 是 b) 不是

*   如果 A > 显示指令 R
*   如果 B > 显示指令 E

# javascript - 检查日期是否早于今天

> ID：13122512
> 
> 赞同：0
> 
> 时间：2012-10-29T13:24:15.377
> 
> 标签：javascript

```
 alert(date2);//Sat Oct 29 0112 00:00:00 GMT+0100 (GMT Daylight Time) 
   alert(date1);//Fri Oct 12 2012 00:00:00 GMT+0100 (GMT Daylight Time)

if (date1.getTime()<date2.getTime()) {
     alert('your date can not be earlier than today.');
} 
```

我的问题是为什么我没有看到警报？有什么不对吗？

编辑：

```
var today = new Date();
date2 = new Date(today.getYear(), today.getMonth(), today.getDate()); 
```

为什么这个年份显示为 0112？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:25:44.933

您的日期 1 在 2012 年，而您的 date2 在 112 年，您测试 date1 是否低于 date2。2012 年优于 112 年，所以这里没有错

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:31:44.490

首先，您将两个日期拆分为其月、日和年的不同值。您可以使用月份数组来找出月份的数字。然后：

```
var date1 = new Date;
var date2 = new Date;
date1.setDate(29);
date1.setMonth(10);
date1.setFullYear(2012);

date2.setDate(12);
date2.setMonth(10);
date2.setFullYear(2012);

if(date1>date2)
alert('Date1 is greater');
else
alert('Date2 is greater'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T13:33:49.867

使用`getFullYear()`，不使用`getYear()`。

在某些实现中，getYear() 返回自 1900 年以来的年数。这就是为什么您获得 112 年的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:26:27.823

那么日期 1 是 2012 年，日期 2 是 0112 年，所以日期 2 早于日期 1，因此您没有看到警报。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T13:26:51.373

date2 的年份是 0112，date1 的年份是 2012

# python - 使用 twistd 服务 Pyramid 应用程序

> ID：13122519
> 
> 赞同：2
> 
> 时间：2012-10-29T13:24:50.730
> 
> 标签：python, twisted, pyramid

我有一个 Pyramid 应用程序，其中也有一些 Twisted 代码，所以我想使用 twistd 为应用程序提供服务，用一块石头杀死两只鸟。

这是我的 .tac 文件：

```
from twisted.web.server import Site
from twisted.web.wsgi import WSGIResource
from twisted.internet import reactor
from twisted.application import internet, service
import os

from pyramid.paster import get_app, setup_logging

config='/path/to/app/production.ini'
config = os.path.abspath(config)
port = 8888

application = get_app(config, 'main')

# Twisted WSGI server setup...
resource = WSGIResource(reactor, reactor.getThreadPool(), application)
factory = Site(resource)

service = internet.TCPServer(port, factory)

service.setServiceParent(application) 
```

为了运行它，我使用了：

```
twistd -y myApp.tac 
```

我收到错误消息，告诉我 get_app() 方法没有返回可以以这种方式使用的对象。例如：

```
"Failed to load application: 'PrefixMiddleware' object has no attribute 'addService'" 
```

使用 twistd 运行 Pyramid 应用程序的最佳方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T12:05:14.963

您可以使用 Twisted Web`twistd`插件中的 WSGI 支持来缩短它并使其更易于配置。像这样创建一个模块：

```
from pyramid.paster import get_app

config = '/path/to/app/production.ini'
myApp = get_app(config, 'main') 
```

然后`twistd`像这样运行：

```
$ twistd web --port tcp:8888 --wsgi foo.myApp 
```

`foo`您创建的模块的名称在哪里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T14:56:49.313

我找到了一个可行的解决方案。这是工作的 .tac 文件：

```
from twisted.web.server import Site
from twisted.web.wsgi import WSGIResource
from twisted.internet import reactor
from twisted.application import internet, service
import os

from pyramid.paster import get_app, setup_logging

config='/path/to/app/production.ini'
config = os.path.abspath(config)
port = 8888

# Get the WSGI application
myApp = get_app(config, 'main')

# Twisted WSGI server setup
resource = WSGIResource(reactor, reactor.getThreadPool(), myApp)
factory = Site(resource)

# Twisted Application setup
application = service.Application('mywebapp')
internet.TCPServer(port, factory).setServiceParent(application) 
```

get_app() 获取 Pyramid WSGI 应用程序，而 internet.TCPServer 需要一个 Twisted Application 对象，因此这些不应混淆。

此代码将在 TCP 端口 8888 上启动应用程序。

如果有人有更好/更清晰的方法来实现这一点，请添加您的答案。

# node.js - 如何强制早午餐 0.8.1 使用 coffescript 1.2

> ID：13122521
> 
> 赞同：1
> 
> 时间：2012-10-29T13:25:01.673
> 
> 标签：node.js, coffeescript, version, npm, brunch

花了好几个小时试图找出这个东西，但无济于事。我确信它就像语法一样简单，但也许我已经盯着这个问题太久了。我正在尝试为一段旧代码构建一个开发环境。由于当前代码库的大小，重构不是一种选择。

当然，最大的问题是我试图模仿 11 个月前建成的环境，需要以下内容

节点 v0.6.11 npm v1.1.1 早午餐 v0.8.1 咖啡脚本 v1.2

package.json 目前有

```
 "dependencies": {
    "coffee-script": ">= 1.1.1",
    "underscore":    ">= 1.1.7",
    "eco":           ">= 1.0.3",
    "nomnom":        "1.0.0",
    "stylus":        ">= 0.13.7",
    "async":         ">= 0.1.9",
    "yaml":          ">= 0.2.1",
    "file":          ">= 0.1.1",
    "stitch":        ">= 0.3.2",
    "uglify-js":     ">= 1.0.6"
  },
  "devDependencies": {
    "coffee-script": ">= 1.1.1",
    "express":       ">= 2.4.3",
    "nodeunit":      ">= 0.5.3",
    "zombie":        ">= 0.9.7"
  } 
```

问题当然是最初安装的咖啡脚本是 1.4，我需要使用 1.2 进行编译。我尝试在依赖项部分将 package.json 更改为“coffee-script”：“1.2”，然后运行“cake setup”。但这并没有改变什么。我在哪里错了，或者我在接近这一切都是错的？

我在同一系统上有一份正确版本的咖啡脚本（1.2）的本地副本，但我不知道如何指出早午餐使用该版本而不是安装在其子目录中的版本。

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:46:06.340

`npm``node_modules`可以在项目文件旁边的节点中本地安装依赖项，`package.json`如果`npm install`使用`-g`标志运行（通常在 中`/usr/local/lib/node_modules/`），则可以全局安装依赖项。

正如您所注意到的，您似乎在全局和本地安装了不同版本的咖啡脚本，并且您想强制 brunch-0.8.1 使用咖啡脚本 1.2。这是我要尝试的：

*   和之前一样，更改`coffee-script`为`1.2`.`package.json`
*   删除刚才编辑的`node_modules`目录中的目录。`package.json`
*   在同一目录下运行`npm install`，它将读取更新版本的已编辑 package.json 文件并重新安装所有依赖项`node_modules`。

这些步骤会将您的*本地*咖啡脚本副本设置为 1.2。通过查看 中的`version`属性来确认这一点`node_modules/coffee-script/package.json`。

但是，这仍然可能不起作用：

*   该`cake setup`命令可能正在尝试执行咖啡脚本的*全局*版本。

我不确定该`cake setup`任务如何寻找咖啡脚本的细节，但如果它确实适用于本地安装的版本，那么你应该很高兴。

如果没有，您需要执行`npm uninstall -g coffee-script`并遵循它，`npm install -g npm install coffee-script@1.2`这会将您的咖啡脚本的*全球*`1.2`版本设置为.

希望这可以帮助。在 npm 中找出依赖关系可能会很棘手，但是当有疑问时查看`package.json`文件版本和运行`npm list <package name>`可能会很有用。

# windows - windows wmi 获取快照 EnabledState

> ID：13122525
> 
> 赞同：1
> 
> 时间：2012-10-29T13:25:21.033
> 
> 标签：windows, wmi, virtualization, snapshot

我正在尝试使用 wmi 获取虚拟机快照的 EnabledState。也就是说，我尝试获取拍摄快照时虚拟机当前的 EnabledState。

到目前为止，我知道如何列出机器的所有快照。为此，我使用：

```
winrm e wmi/root/virtualization/* -filter:"select * from Msvm_VirtualSystemSettingData where SettingType = 5" 
```

这提供了很多关于快照的信息，但它没有给我虚拟机的启用状态。有什么想法我怎么能得到它？

# sencha-touch - xtype 中的 Sencha 2-0：文本字段，省略号不起作用

> ID：13122531
> 
> 赞同：2
> 
> 时间：2012-10-29T13:25:28.067
> 
> 标签：sencha-touch, extjs, sencha-touch-2

对于 Sencha 文本字段中的文本溢出，我需要省略号而不是文本被裁剪，所以我添加了一些内联样式，但省略号不会出现，文本总是被裁剪，代码添加在下面以供参考

```
 xtype: 'textfield',
                label: 'First Name',
                name: 'firstName',
                clearIcon: false,
                style: 'white-space:nowrap;overflow:hidden;text-overflow:ellipsis;', 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T21:09:55.537

另一种方法是使用从 SASS 源中使用 Compass 编译的自定义 CSS 类：

```
{
  xtype: 'textfield',
  label: 'First Name',
  name: 'firstName',
  clearIcon: false,
  cls: my-textfield
} 
```

您可以在其中使用 SASS 特定调用来包含省略号：

```
.my-textfield {
  @include ellipsis;
} 
```

# database - 使用个人用户帐户执行 flyway 迁移

> ID：13122535
> 
> 赞同：3
> 
> 时间：2012-10-29T13:25:38.147
> 
> 标签：database, oracle, migration, flyway

作为我们将 SQL 脚本迁移到 flyway 迁移工作的一部分，我们遇到了一些大量使用 Oracle sqlplus[`CONNECT`语句](http://docs.oracle.com/cd/B19306_01/server.102/b14357/ch12015.htm)的脚本。不幸的是，删除它们并使用具有所需权限的用户（例如`SYSTEM`）不是一种选择。

我们现在想知道是否有一种优雅的方式来使用不同的帐户执行单个迁移？如果支持这一点，围绕`CONNECT`语句拆分脚本可能会导致我们问题的优雅解决方案。

其他人如何处理需要不同帐户的数据库迁移？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:41:25.277

尝试的一种选择是将每个帐户的迁移生命周期分开。

然后，您可以为每个账户拥有一个 Flyway 实例，配置相应的用户并仅处理该特定账户的对象。

# fade - 淡出 UIImageView，然后自动将其带回

> ID：13122537
> 
> 赞同：-1
> 
> 时间：2012-10-29T13:25:39.100
> 
> 标签：fade

大家好，我正在尝试在图像褪色到 alpha 0 后自动恢复图像，但无法弄清楚。

```
[UIImageView beginAnimations:nil context:NULL];

[UIImageView setAnimationDuration:4.0];

[_imageflushdownwater setAlpha:0];
self.imageflushdownwater.transform = CGAffineTransformRotate(_imageflushdownwater.transform, M_PI / 1);
[UIImageView commitAnimations]; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:33:21.137

您不必弄清楚，通读[UIView 的类参考就足够了……](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW111)（拜托！拜托！）

无论如何...

使用旧的、基于类的 API（这就是您**正在**使用的）：

```
[UIView setAnimationTarget:self];
[UIView setAnimationDidStopSelector:@selector(animationFinished:completed:context:)];

- (void)animationFinished:(NSString *)name completed:(NSNumber *)completed context:(void *)ctx
{
    imageView.alpha = 1.0f;
    imageView.transform = CGAffineTransformIdentity;
} 
```

使用新的、基于块的 API（这就是您**应该**使用的）：

```
[UIView animateWithDuration:4.0 animations:^{
    imageView.alpha = 0.0;
    imageView.transform = CGAffineTransformMakeRotation(M_PI);
} completion:^{
    imageView.alpha = 1.0f;
    imageView.transform = CGAffineTransformIdentity;
}]; 
```

# eclipse - 以编程方式将 IncludePathEntry 添加到 JavaScriptProject

> ID：13122541
> 
> 赞同：2
> 
> 时间：2012-10-29T13:25:49.827
> 
> 标签：eclipse, eclipse-plugin, jsdt

我有一个 Eclipse 插件，它贡献了一个需要 jsdt javaScriptNature 的项目性质。我现在想以编程方式将插件中包含的 javascript 库添加到项目的包含路径中。有没有办法我可以做到这一点？

我阅读了一些关于 JsGlobalScopeContainer 和 JsGlobalScopeContainerInitializer 的内容并尝试了它们，但这似乎很令人困惑。我只想从我的插件中添加一个包含一些 .js 文件的库。我只是无法理解这个概念。

到目前为止，这是我想出的：

```
IJavaScriptProject jsProj = JavaScriptCore.create(p);
Path pa = new Path("/src/de/otris/eclipse/portalscripting/psLibrary/library.js");
IIncludePathEntry entry = JavaScriptCore.newProjectEntry(pa);               
IIncludePathEntry[] ipaths = jsProj.getRawIncludepath();
IIncludePathEntry[] newpaths = new IIncludePathEntry[ipaths.length +1];
System.arraycopy(ipaths, 0, newpaths, 0, ipaths.length);
newpaths[ipaths.length] = entry;
jsProj.setRawIncludepath(newpaths, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:28:18.513

我终于找到了一种直接从我的插件添加我的库的方法。尽管尤金的回答没有错，但它缺乏一些解释。我将尝试展示如何做到这一点。

如果你想添加一个包含多个文件的库，你可以这样做：

1.  创建一个扩展**JsGlobalScopeContainerInitializer的类**
2.  **为扩展点org.eclipse.wst.jsdt.core.JsGlobalScopeContainerInitializer**贡献一个扩展
***   添加一个**IIncludePathEntry**，使用它的 id 指向 JsGlobalScopeContainer ，到你想在其中使用库的项目**

 ****1.**创建一个扩展JsGlobalScopeContainerInitializer的类

那里有一些非常令人困惑的教程（包括 eclipse wiki 上的教程），起初使人们更难理解这一点。我想出了以下内容：

```
[... package and imports ommited ...]
public class LibInitializer extends JsGlobalScopeContainerInitializer {

    private static final String LIBRARY_ID = "com.testvendor.testplugin.library";

     public IPath getPath() {    
         return new Path(LIBRARY_ID);
     }

    @Override
    public LibraryLocation getLibraryLocation() {   
        return null;
    }

    @Override
    public String getDescription() {
        return "Test Library";
    }

    @Override
    public String getDescription(IPath containerPath, IJavaScriptProject project) {
        return getDescription();
    }

    @Override
    public IIncludePathEntry[] getIncludepathEntries() {

        try {
            //get the Bundle object of the plugin
            Bundle bundle = Platform.getBundle("com.testvendor.testplugin");
            //get the java.io.File object corresponding to the root of the bundles installation directory
            File bundleFile = FileLocator.getBundleFile(bundle);
            //add the location pointing to the library relative to that bundle root
            File libraryLocation = new File(bundleFile, "bin/com/testvendor/testplugin/library/");              
            //create a Path object from it
            IPath pa = new Path(libraryLocation.getAbsolutePath());

            /* create an IIncludePathEntry of the type "library" from this path
            my library only contains one folder (for now) so this is it */
            IIncludePathEntry entry = JavaScriptCore.newLibraryEntry(pa, pa, pa);
            //put the entry (or entries if you had more) into an array and return
            IIncludePathEntry[] entries = {entry};
            return entries;

        } catch (IOException e) { 
            e.printStackTrace();
        }       
        return null;
    }   
} 
```

最有趣的部分是方法**getIncludepathEntries()**，其中将从容器中检索实际条目。由于 IIncludePathEntry 不适用于“file://”伪协议的 URL，因此 Eugene 建议的“toFileURL”方法在这里不起作用。

**2.**为 JSGlobalScope... 扩展点贡献一个扩展

要告诉项目包含 id 为*com.testvendor.testplugin.library*的容器条目，最简单的方法是向扩展点 *org.eclipse.wst.jsdt.core.JsGlobalScopeContainerInitializer** 贡献代码，如下所示：

```
<extension point="org.eclipse.wst.jsdt.core.JsGlobalScopeContainerInitializer">            
  <JsGlobalScopeContainerInitializer                                          
     id="com.testvendor.testplugin.library"                                                        
     class="com.testvendor.testplugin.library.LibInitializer"/>                           
</extension> 
```

其中课程当然是指第 1 步中的 JsGlobalScopeContainerInitializer。

**3.**将 IIncludePathEntry 添加到项目中

```
IJavaScriptProject jsProj = ... get your project object from somewhere ...
//create an instance of the container from step 1.
JsGlobalScopeContainerInitializer container = new LibInitializer();
//create an includepath entry refering to the container         
IIncludePathEntry entry = JavaScriptCore.newContainerEntry(container.getPath());

IIncludePathEntry[] ipaths = jsProj.getRawIncludepath();    
IIncludePathEntry[] newpaths = new IIncludePathEntry[ipaths.length +1];

System.arraycopy(ipaths, 0, newpaths, 0, ipaths.length);
//add the new entry
newPaths[ipaths.length] = enty;
// set the new includepath to the project
jsProj.setRawIncludepath(newpaths, null); 
```

如果您现在幸运的话，您的 JavaScript 资源中将有一个库条目，其中包含您使用 ContainerIntitializer 添加的库文件夹中包含的所有 JavaScript 对象和类。所有这些对象和类都将在代码完成建议中可用。

![终于有图书馆了！](../Images/4908129dfae82dc4eba6eaefeed66711.png)

我希望这可以防止其他人花费数小时的时间在一个**可能**比实际更简单的主题上。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-29T17:57:43.270

要设置项目包含路径，您应该使用[IJavaScriptProject::setRawIncludepath](http://help.eclipse.org/juno/topic/org.eclipse.wst.jsdt.doc/reference/api/org/eclipse/wst/jsdt/core/IJavaScriptProject.html#setRawIncludepath%28org.eclipse.wst.jsdt.core.IIncludePathEntry%5b%5d,%20IProgressMonitor%29)方法之一。IIncludePathEntries 是通过调用与条目类型对应的[JavaScriptCore::new*Entry方法创建的。](http://help.eclipse.org/juno/topic/org.eclipse.wst.jsdt.doc/reference/api/org/eclipse/wst/jsdt/core/JavaScriptCore.html#newContainerEntry%28IPath%29)**

# node.js - 找不到模块眼睛

> ID：13122542
> 
> 赞同：1
> 
> 时间：2012-10-29T13:25:51.327
> 
> 标签：node.js, vows

我已经使用“npm install vows”安装了 vows，并确保我有“eyes”，但在终端中运行“npm install eyes”。我检查了本地用户的 node_modules 文件夹中有一个 eye 文件夹。但是当我使用'vows'关键字运行一些测试时，我得到了眼睛模块的这个错误。我曾多次尝试卸载并重新安装誓言和眼睛，但没有成功。谁能帮我解决这个问题。

module.js:340 抛出错误；

错误：找不到模块“眼睛”

```
at Function.Module._resolveFilename (module.js:338:15)
at Function.Module._load (module.js:280:25)
at Module.require (module.js:362:17)
at require (module.js:378:17)
at Object.<anonymous> (/usr/bin/vows:32:15)
at Module._compile (module.js:449:26)
at Object.Module._extensions..js (module.js:467:10)
at Module.load (module.js:356:32)
at Function.Module._load (module.js:312:12)
at Module.runMain (module.js:487:10) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-12T01:07:09.923

我觉得是位置问题。你是从你的 npm 的不同源安装的，node.js 不是默认的。

你可以运行：

```
whereis eyes
where is npm 
```

在您的终端中检查您的安装位置。

# javascript - Javascript多种方法

> ID：13122543
> 
> 赞同：3
> 
> 时间：2012-10-29T13:25:52.967
> 
> 标签：javascript

我是 javascript 新手，我正在尝试弄清楚如何做这样的事情

```
SomeClass = {

    confirm: function(){
        if(!confirm('Sure?'))
        {
            return false;
        }
    },

    someMethod: function(){
        alert("OK");
    }

} 
```

这就是我真正想做的

```
SomeClass.confirm().someMethod(); 
```

事实上，我需要通过在实际方法前面添加 .confirm() 来确认操作。这甚至可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:28:16.473

```
SomeClass = {

    confirm: function(){
        if(!confirm('Sure?'))
        {
            this.status=false;
            return this;
        }
    },

    someMethod: function(){
        if(this.status){
            alert("OK");
        }
    }

} 
```

这种方法链接只有在您返回对象本身时才有可能。您可以使用状态来指示用户是否确认。

您也可以只返回一个带有适当的对象`somemethod`，尽管我怀疑您希望方法链接比这更通用：

```
SomeClass = {

    confirm: function(){
        if(!confirm('Sure?'))
        {
            return {someMethod:function(){alert("Canceled");}};
        }
        return {someMethod:function(){alert("OK");}};
    }

} 
```

不过，理想情况下，您将通过构造函数创建对象，并且 confirm 方法将返回标志设置为 true 或 false的**新**实例。`SomeClass``status`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:29:17.300

要做一个[流畅的接口](http://en.wikipedia.org/wiki/Fluent_interface)，你需要从每个函数调用中返回对象本身。这意味着重构你的 if 逻辑：

```
SomeClass = {

wasConfirmed: false,

confirm: function(){
    this.wasConfirmed = confirm('Sure?');

    return this;
},

someMethod: function(){
    if(this.wasConfirmed) alert("OK");
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:27:22.637

尝试

```
var SomeClass = {
  state: null,

  confirm: function(){
    this.state = confirm('Sure?');    

    return this;
  },

  someMethod: function() {
    alert(this.state ? 'OK' : 'Error');
  }
};

SomeClass.confirm().someMethod(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:29:42.200

您将无法以您描述的方式链接方法调用：

```
SomeClass.confirm().someMethod(); 
```

如果您的确认方法返回的`SomeClass`对象不是已`someMethod()`定义的对象。

你可能已经在 jQuery 中看到过这样的事情：

```
// trigger click handlers of the element with id="id" and hide it:
$("#id").click().hide(); 
```

它之所以有效，是因为该`click()`方法返回调用它本身的同一对象，因此可以在**该**`hide()`返回的对象上调用该方法。即使在 jQuery 中也不能链接返回任何非 jQuery 对象的方法（仅作为链中的最后一个方法）。

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T13:32:39.310

如果我对您的理解正确，您希望任何操作都是“可确认的”，那么您可以编写一个类，该类将消息显示给用户，以及在“确认”时执行的操作

```
var Confirmer = {

  confirm: function(msg, action){
       if(confirm(msg)){
          action();
       }
  }

} 
```

然后你会这样称呼它：

```
Confirmer.confirm("Are you sure?", function(){ alert("hello"); }); 
```

使用第二个参数，您希望在用户确认后调用的任何函数。**

# xml - 将每个单词的第一个字符转换为大写

> ID：13122545
> 
> 赞同：12
> 
> 时间：2012-10-29T13:26:00.760
> 
> 标签：xml, xslt, xslt-1.0, title-case

我有一个字符串，我需要将每个单词的第一个字母转换为大写，然后使用 xsl 转换为小写，例如，

输入字符串= dInEsh sAchdeV kApil Muk

所需的输出字符串 = Dinesh Sachdev Kapil Muk

虽然，我知道我必须为此目的使用翻译功能，但是如何使用 XSLT 1.0 将每个单词的第一个宪章翻译成大写并全部小写

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-29T13:53:59.040

以下不是“好”，我敢肯定有人（主要是 Dimitri）可以想出更简单的东西（尤其是在 XSLT 2.0 中）......但我已经[测试过它并且它有效](http://www.xmlplayground.com/94P8gA)

```
<xsl:template name="CamelCase">
  <xsl:param name="text"/>
  <xsl:choose>
    <xsl:when test="contains($text,' ')">
      <xsl:call-template name="CamelCaseWord">
        <xsl:with-param name="text" select="substring-before($text,' ')"/>
      </xsl:call-template>
      <xsl:text> </xsl:text>
      <xsl:call-template name="CamelCase">
        <xsl:with-param name="text" select="substring-after($text,' ')"/>
      </xsl:call-template>
    </xsl:when>
    <xsl:otherwise>
      <xsl:call-template name="CamelCaseWord">
        <xsl:with-param name="text" select="$text"/>
      </xsl:call-template>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template>

<xsl:template name="CamelCaseWord">
  <xsl:param name="text"/>
  <xsl:value-of select="translate(substring($text,1,1),'abcdefghijklmnopqrstuvwxyz','ABCDEFGHIJKLMNOPQRSTUVWXYZ')" /><xsl:value-of select="translate(substring($text,2,string-length($text)-1),'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz')" />
</xsl:template> 
```

基本思想是`CamelCase`，如果找到空格，则调用 ，然后在空格*之前*`CamelCaseWord`的所有内容（即第一个单词）上运行，然后在空格*之后*的所有内容（即句子的其余部分）上再次调用。否则，如果没有找到空格（因为它已经到了句子中的最后一个单词），那么它只会调用.*`CamelCase`*`CamelCaseWord`**

 **该`CamelCaseWord`模板仅将第一个字符从小写转换为大写（如有必要），并将所有剩余字符从大写转换为小写（如有必要）。

因此，要调用它，您将拥有...

```
<xsl:call-template name="CamelCase">
   <xsl:with-param name="text">dInEsh sAchdeV kApil Muk</xsl:with-param>
</xsl:call-template> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T14:18:14.797

**额外的：**

我错过了问题中的 1.0 要求。这仅适用于 2.0 版。

下面的原始答案。

我相信这个在不久前对我有用。声明一个函数：

```
<xsl:function name="my:titleCase" as="xs:string">
    <xsl:param name="s" as="xs:string"/>
    <xsl:choose>
        <xsl:when test="lower-case($s)=('and','or')">
            <xsl:value-of select="lower-case($s)"/>
        </xsl:when>
        <xsl:when test="$s=upper-case($s)">
            <xsl:value-of select="$s"/>
        </xsl:when>
        <xsl:otherwise>
            <xsl:value-of select="concat(upper-case(substring($s, 1, 1)), lower-case(substring($s, 2)))"/>
        </xsl:otherwise>
    </xsl:choose>
</xsl:function> 
```

并使用它：

```
<xsl:sequence select="string-join(for $x in tokenize($text,'\s') return my:titleCase($x),' ')"/> 
```

归功于**samjudson** => [http://p2p.wrox.com/xslt/80938-title-case-string.html](http://p2p.wrox.com/xslt/80938-title-case-string.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-29T22:52:58.050

**这是一个已有 8 年历史的 FXSL 1.x（一个完全用 XSLT 1.0 编写的 XSLT 1.0 库）解决方案：**

测试-strSplit-to-Words10.xsl：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
>
   <xsl:import href="strSplitWordDel.xsl"/>

   <!-- To be applied on: test-strSplit-to-Words10.xml -->

   <xsl:output indent="yes" omit-xml-declaration="yes"/>
   <xsl:variable name="vLower" 
        select="'abcdefgijklmnopqrstuvwxyz'"/>
   <xsl:variable name="vUpper" 
        select="'ABCDEFGIJKLMNOPQRSTUVWXYZ'"/>

    <xsl:template match="/">
      <xsl:variable name="vwordNodes">
        <xsl:call-template name="str-split-word-del">
          <xsl:with-param name="pStr" select="/"/>
          <xsl:with-param name="pDelimiters" 
                          select="', .(&#9;&#10;&#13;'"/>
        </xsl:call-template>
      </xsl:variable>

      <xsl:apply-templates select="ext:node-set($vwordNodes)/*"/>
    </xsl:template>

    <xsl:template match="word">
       <xsl:choose>
         <xsl:when test="not(position() = last())">
           <xsl:value-of 
           select="translate(substring(.,1,1),$vLower,$vUpper)"/>
           <xsl:value-of select="substring(.,2)"/>
         </xsl:when>
         <xsl:otherwise>
           <xsl:value-of select="."/>
         </xsl:otherwise>
       </xsl:choose>
    </xsl:template>

    <xsl:template match="delim">
      <xsl:value-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档 (test-strSplit-to-Words10.xml) 时：**

```
<t>004.lightning crashes (live).mp3</t> 
```

**结果是**：

```
004.Lightning Crashes (Live).mp3 
```

**应用于此 XML 文档（您提供的示例）时：**

```
dInEsh sAchdeV kApil Muk 
```

**结果是**：

```
DInEsh SAchdeV KApil Muk 
```

**只需一周时间，我们就可以得到以下代码**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
>
   <xsl:import href="strSplitWordDel.xsl"/>

   <!-- To be applied on: test-strSplit-to-Words10.xml -->

   <xsl:output indent="yes" omit-xml-declaration="yes"/>
   <xsl:variable name="vLower" 
        select="'abcdefgijklmnopqrstuvwxyz'"/>
   <xsl:variable name="vUpper" 
        select="'ABCDEFGIJKLMNOPQRSTUVWXYZ'"/>

    <xsl:template match="/">
      <xsl:variable name="vwordNodes">
        <xsl:call-template name="str-split-word-del">
          <xsl:with-param name="pStr" select="/"/>
          <xsl:with-param name="pDelimiters" 
                          select="', .(&#9;&#10;&#13;'"/>
        </xsl:call-template>
      </xsl:variable>

      <xsl:apply-templates select="ext:node-set($vwordNodes)/*"/>
    </xsl:template>

    <xsl:template match="word">
           <xsl:value-of 
           select="translate(substring(.,1,1),$vLower,$vUpper)"/>
           <xsl:value-of select="translate(substring(.,2), $vUpper, $vLower)"/>
    </xsl:template>

    <xsl:template match="delim">
      <xsl:value-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

**现在产生了想要的结果**：

```
Dinesh Sachdev Kapil Muk 
```

**说明**：

**[FXSL](http://fxsl.sf.net)**的`str-split-word-del`模板可用于将（可能不止一个）分隔符指定为字符串参数的标记化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-09T22:36:58.197

这是另一个简短的解决方案。它使用纯 XSL-T 2.0。我知道 OP 对 XSL-T 1.0 有要求，但由于此页面在 2015 年的“xsl-t 标题案例功能”在 Google 上排名第一，这似乎更相关：

```
<xsl:function name="xx:fixCase">
    <xsl:param name="text" />
    <xsl:for-each select="tokenize($text,' ')">
        <xsl:value-of select="upper-case(substring(.,1,1))" />
        <xsl:value-of select="lower-case(substring(.,2))" />
        <xsl:if test="position() ne last()">
            <xsl:text> </xsl:text>
        </xsl:if>
    </xsl:for-each>
</xsl:function> 
```

其中“xx”是您自己的命名空间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-06T15:19:59.023

你也可以试试这个：

[http://www.xsltfunctions.com/xsl/functx_camel-case-to-words.html](http://www.xsltfunctions.com/xsl/functx_camel-case-to-words.html)

```
 <xsl:function name="functx:camel-case-to-words" as="xs:string"
                  xmlns:functx="http://www.functx.com">
      <xsl:param name="arg" as="xs:string?"/>
      <xsl:param name="delim" as="xs:string"/>

      <xsl:sequence select="
       concat(substring($arg,1,1),
                 replace(substring($arg,2),'(\p{Lu})',
                            concat($delim, '$1')))
     "/>

</xsl:function> 
```

和向后： [http ://www.xsltfunctions.com/xsl/functx_words-to-camel-case.html](http://www.xsltfunctions.com/xsl/functx_words-to-camel-case.html)

```
<xsl:function name="functx:words-to-camel-case" as="xs:string"
              xmlns:functx="http://www.functx.com">
  <xsl:param name="arg" as="xs:string?"/>

  <xsl:sequence select="
     string-join((tokenize($arg,'\s+')[1],
       for $word in tokenize($arg,'\s+')[position() > 1]
       return functx:capitalize-first($word))
      ,'')
 "/>

</xsl:function> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-17T19:05:38.230

XQUERY 上的相同功能：

函数 Xquery 到骆驼案例。

```
declare function xf:toCamelCase($text as xs:string?) as xs:string{
    if(contains($text,' ')) then
        fn:concat(xf:CamelCaseWord(substring-before($text,' ')),' ', xf:toCamelCase(substring-after($text,' ')))
    else
        xf:CamelCaseWord($text)
};

declare function xf:CamelCaseWord($text as xs:string?) as xs:string{
    fn:concat( translate(substring($text,1,1),'abcdefghijklmnopqrstuvwxyz','ABCDEFGHIJKLMNOPQRSTUVWXYZ'), 
                translate(substring($text,2,string-length($text)-1),'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz'))
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-04T13:30:55.527

一个非常简短的解决方案，利用 EXSLT 的`split()`功能：

```
<xsl:variable name='text' select='"dInEsh sAchdeV kApil Muk"' />
<xsl:variable name='lowers' select='"abcdefghijklmnopqrstuvwxyz"' />
<xsl:variable name='uppers' select='"ABCDEFGHIJKLMNOPQRSTUVWXYZ"' />

<xsl:template match="/">

    <xsl:for-each select='str:split($text, " ")'>
        <xsl:value-of select='concat(
            translate(substring(., 1, 1), $lowers, $uppers),
            translate(substring(., 2), $uppers, $lowers),
            " "
        )' />
    </xsl:for-each>
</xsl:template> 
```

工作演示：[http ://www.xmlplayground.com/CNmKdF](http://www.xmlplayground.com/CNmKdF)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-23T10:23:29.560

可以使用单行表达式来实现。试试这个

```
string-join(for $x in tokenize($text,'\s') return concat(upper-case(substring($x, 1, 1)), lower-case(substring($x, 2))),' ') 
```

注意 - 这已经通过 Orbeon Forms 公式进行了验证。**

# asp.net-mvc - HttpContext.Request.Browser.IsMobileDevice 不能仅在生产环境中工作？

> ID：13122546
> 
> 赞同：1
> 
> 时间：2012-10-29T13:26:10.067
> 
> 标签：asp.net-mvc, mobile

我有一个相当标准的 MVC 网站联系页面，其中包括用于清除机器人的 ReCaptcha。一切正常。我向站点添加了移动页面，并且由于可见性问题，目前希望在控制器中仅对移动页面省略重新验证码验证。

在本地，这非常有效，因为我检查了无效的验证码，如果不是移动设备，我将错误添加到模型并在 Catch 块中捕获。如果手机不担心验证码，只需验证模型即可。

```
 [HttpPost, RecaptchaControlMvc.CaptchaValidator]
    [ValidateAntiForgeryToken]
    public ActionResult Submit(ContactFormViewModel viewModel, bool captchaValid, string captchaErrorMessage)
    {
        try
        {
            if (!captchaValid)
                if (!HttpContext.Request.Browser.IsMobileDevice)
                    ModelState.AddModelError("captcha", captchaErrorMessage);

            if (ModelState.IsValid)
            {
                if (viewModel.Save(viewModel))
                    return RedirectToAction("Thanks");
            }
            return View("Create");
        }
        catch (Exception ex)
        { //. . . error processing
        } 
```

如上所述，这在本地对设置为 iPhone、iPad 等的 Safari UserAgent 以及适用于各种手机的 Opera 模拟器都非常有效。然而，当我部署到生产环境时，我不断收到提交时抛出的错误，并显示我的验证码错误。对我来说，这意味着 .IsMobileDevice 测试失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T12:47:03.963

好的-这就是我“解决”我的问题的方法。我认为这可能与传递给标准 Web 表单使用的“提交”对象的 Recaptcha 参数有关，因此对于移动版本，我修改了表单提交以调用不期望任何内容的“MobileSubmit”方法Recaptcha 相关。

结果很简单：

```
 //
    // POST: /Contact/Create
    [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult MobileSubmit(ContactFormViewModel viewModel)
    {
        try
        {
            if (ModelState.IsValid)
            {
                if (viewModel.Save(viewModel))
                    return RedirectToAction("Thanks");
            }
            return View("Create");
        }
        catch (Exception ex)
        { . . . 
         } 
```

然后来自移动视图的调用很简单：

```
@using (Html.BeginForm("MobileSubmit", "Contact", null, FormMethod.Post, new { data_ajax = "false" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Contact</legend>
        @Html.Partial("_ContactFormPartial")

        <br />
        <input type="submit" value="Submit" />
        &nbsp;
        <input type="reset" value="Reset" />
    </fieldset>
} 
```

所以仍然不确定为什么 IsMobile 调用最初不起作用，但我推测添加 Recaptcha 参数会导致副作用。

干杯，丹

# c# - 在 C# 中链接到 VS 2012 Express for Desktop 中的 Windows API 的问题

> ID：13122547
> 
> 赞同：3
> 
> 时间：2012-10-29T13:26:10.373
> 
> 标签：c#, windows, pinvoke, dllimport

我是 Windows 桌面编程的新手（或者至少我从 Windows 3.0 开始就没有做过）。我已经安装了 VS 2012 Express for Desktop。我创建并运行了一个基于表单的默认项目。现在我想添加一个 Windows API，[每个 pinvoke.net](http://pinvoke.net/default.aspx/user32.SetLayeredWindowAttributes)包含以下行：

```
[DllImport("user32.dll")]
static extern bool SetLayeredWindowAttributes(IntPtr hwnd, uint crKey, byte bAlpha, uint dwFlags); 
```

我收到此代码的两个错误：

1.  修饰符“extern”对此项目无效（在属性的右方括号上）
2.  预期的类、委托、枚举、接口或结构（on `bool`）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:29:45.040

确保将此声明放在类定义中，而不是在它之外。

通常，您会将 P/Invokes 保存在一个名为 的静态类`NativeMethods`中，然后您可以使用类似的调用来调用它`NativeMethods.SetLayeredWindowedAttributes(...)`。例如：

```
internal static class NativeMethods
{
    [DllImport("user32.dll")]
    public static extern bool SetLayeredWindowAttributes(IntPtr hwnd, uint crKey, byte bAlpha, uint dwFlags);
} 
```

如果你想在没有类型引用的情况下调用它，那么你需要把它放在你调用它的同一个类中，但除非你确定你不会在其他任何地方使用这个 P/Invoke，否则我不会不推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:32:03.180

因为您必须将此代码封装在类上

```
class MainClass 
{
   [DllImport("user32.dll")]
   static extern bool SetLayeredWindowAttributes(IntPtr hwnd, uint crKey, byte bAlpha, uint dwFlags);
   .....

} 
```

# android - 来自 Android 的 Google Drive 的 2-Leged OAuth？

> ID：13122549
> 
> 赞同：2
> 
> 时间：2012-10-29T13:26:16.623
> 
> 标签：android, google-drive-api

我可以使用 Google Drive 通过 Android 应用程序上传图像吗？我也不希望用户参与身份验证过程，因为所有图像都应该只上传到特定用户的驱动器。我认为这只能通过 2-legged OAuth 实现，但是 Drive 是否存在 2-legged OAuth？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T15:09:52.723

Google Drive 上不存在 2-legged OAuth。最接近的行为是使用模拟服务帐户。如果您有 google apps 域，您可以使用 Provisioning API 来查找域的用户并以编程方式模拟他们

# underscore.js - 试图理解 _Underscore 库

> ID：13122550
> 
> 赞同：1
> 
> 时间：2012-10-29T13:26:18.660
> 
> 标签：underscore.js

很难理解[_Underscore](http://underscorejs.org)库，我认为我正在学习的基础知识，但我认为这是给我带来问题的术语。

例如我有以下对象：

```
CA3 "BAA"
vol_2007 0.15
vol_2008 0.2
vol_2009 0.25
vol_2010 0.3
vol_2011 0.600

CA3 "LUF"
vol_2007 1.13
vol_2008 0.4
vol_2009 1.6
vol_2010 2.8
vol_2011 0.43 
```

我已经达到了以下几点：

```
var fieldtogroup = 'CA3';

var groups = _.groupBy(tmp,function (name) { return name[fieldtogroup] });
var sums = _.map(groups, function (group) {
    return _.reduce(group, function (a, b) { return b; }, 0);
}); 
```

我遇到的第一个问题是，如果我使用：

```
return _.reduce(group, function (a, b) { return a + b; }, 0); 
```

我得到了一个垃圾对象，我可以看到 _Underscore 文档完美地解释了“a”是当前值而“b”是新值，但这只是行不通。有人可以解释这是为什么吗？在进行计算之前，我是否需要在函数中使用一个子句来确定这些值是否为数字？

此外，最终，我希望能够返回类似于以下内容的对象数组：

```
vol_2007: 0.15,1.13
vol_2008: 0.2,0.4
vol_2009: 0.25, 1.6
vol_2010: 0.3, 2.8
vol_2011: 0.600,0.43 
```

我已经设法通过“有点”旋转对象、多次遍历数组并将值推入另一个数组来做到这一点，但我很肯定 _Underscore 能够为我做到这一点，但我不明白怎么做。

如果有人能启发我这些我真的很感激，我已经掌握了图书馆的基础知识，但这让我很难过！

*   编辑 *

解决了该[`_.pluck`](http://underscorejs.org/#pluck)命令的最后一个问题，这很棒，但在使用 Reduce 时仍然出现错误。

![在此处输入图像描述](../Images/460929b137937bac08ea03a2a6f23d15.png)

“更多”仅包含 vol_2009 -> vol_2011 的值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:47:06.093

您正在对错误的对象应用减和。看看你的`groups = _.groupBy(tmp, 'CA3')`回报：

```
{ // arrays of objects grouped by their CA3 property:
    BAA: [
        {
            CA3: "BAA",
            vol_2007: 0.15
            …
        },
        …
    ],
    Rum: [
        {
            CA3: "Rum",
            …
        }, {
            CA3: "Rum",
            …
        },
        …
    ],
    …
} 
```

你不能总结这些对象。

相反，您似乎想再次按属性名称对这些数组中对象的属性值进行分组：

```
byCAandVol = _.map(groups, function(arr) {
    var res = {};
    for (var i=0; i<arr.length; i++)
        for (var prop in arr[i])
            if (prop != "CA3")
                if (prop in res)
                    res[prop].pus(arr[i][prop]);
                else
                    res[prop] = [arr[i][prop]];
    return res;
}); 
```

这有点像逐个属性分组。现在你有

```
{ // arrays of objects grouped by their CA3 property:
    BAA: {
        vol_2007: [0.15, …],
        vol_2008: […]
        …
    },
    Rum: {
        vol_2007: …
    },
    …
} 
```

现在你可以用你的 reduce 函数对这些数组求​​和，封装在两个映射中：

```
sumsByCAandVol = _.map(byCAandVol, function (group) {
    return _.map(group, function(vols) {
        return _.reduce(vols, function (a, b) { return a + b; }, 0);
    });
}); 
```

或者，您不会在一个额外的步骤中执行此操作，而是在 group-by-each-property 函数中构建总和而不是数组。

# ssl-certificate - 移动文件，现在我在 vqmod for opencart 中收到解析错误

> ID：13122553
> 
> 赞同：1
> 
> 时间：2012-10-29T13:26:38.583
> 
> 标签：ssl-certificate, web-hosting, opencart

我的客户正在使用 Yahoo 网络托管（呃），为了在他们的服务器上拥有 SSL 证书，您必须创建一个文件夹并将所有您想要保护的文件移动到该文件夹​​中。我将所有`OpenCart`文件放在一个名为 shop 的文件夹中，所以我只是将整个文件夹移到那里，这样我就不会对链接等进行大量更新。

在我这样做之前，一切都运行良好。现在，当我尝试查看商店或转到管理面板时收到此消息：

```
Parse error: parse error, unexpected T_CLASS in /ssl/shop/vqmod/vqmod.php on line 6 
```

第 6 行唯一的代码是这样的：

```
final class VQMod { 
```

请帮忙！我正在尝试在今天或明天为我的客户启动这个网站。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:42:47.400

This sounds like your file hasn't been uploaded correctly or you're running on an old version of PHP (PHP 4)

# instance - PreparingEventArgs 中的实例属性？

> ID：13122554
> 
> 赞同：1
> 
> 时间：2012-10-29T13:26:40.213
> 
> 标签：instance, registration, autofac

根据文档， PreparingEventArgs 应该具有 Instance 属性，因此您可以提供替代实例而不是默认实例。

但据我所知，该属性不存在。它应该存在还是不存在？

（我知道我可以在激活事件中交换实例，但我想避免创建一个实例，如果我不得不把它扔掉的话。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T16:41:41.943

您使用的是什么版本的 Autofac？

在最新的来源中，该`Instance`属性确实被删除了。另一种方法是挂钩[`Activating`](http://docs.autofac.org/en/latest/lifetime/events.html?highlight=ReplaceInstance)事件并使用.`ReplaceInstance``ActivatingEventArgs`

# vb.net - 如何跳到下一个文本框

> ID：13122555
> 
> 赞同：2
> 
> 时间：2012-10-29T13:26:42.263
> 
> 标签：vb.net

我有 n 个文本框

```
text1.text = ""
text2.text = ""
... 
```

表格1

```
id txt1 txt2 txt3  

01 0 0 1
02 1 1 0
..... 
```

txt1, txt2 是位数据类型

我想从 table1 检查文本框位是否为 0，然后我不想关注文本框，然后移动到下一个文本框，如果位为 1，那么我想关注文本框。怎么做。

例如

```
table1

txt1 1
txt2 0
txt3 1

textbox1.focus then textbox3.focus.  
textbox2 should not focus 
```

我要编写代码离开事件或获得焦点事件的事件。任何建议

需要VB.Net代码帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:34:17.463

我会改用这个[`Enter`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.enter.aspx)事件，因为[`MSDN`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.gotfocus.aspx)注意到

> GotFocus 和 LostFocus 事件是与 WM_KILLFOCUS 和 WM_SETFOCUS Windows 消息相关联的低级焦点事件。通常，GotFocus 和 LostFocus 事件仅在更新 UICues 或编写自定义控件时使用。相反**，Enter 和 Leave 事件应用于**除 Form 类之外的所有控件，Form 类使用 Activated 和 Deactivate 事件。

您可以在那里使用您的逻辑并调用[`SelectNextControl`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.selectnextcontrol.aspx)如果这`TextBox`不应该得到关注。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:34:03.650

你可以定义`TabIndex property`在`your controls`

链接： http: [//msdn.microsoft.com/en-us/library/aa445718 (v=vs.60).aspx](http://msdn.microsoft.com/en-us/library/aa445718(v=vs.60).aspx)

# android - 在 android 文件资源管理器中看不到数据库

> ID：13122559
> 
> 赞同：0
> 
> 时间：2012-10-29T13:26:57.287
> 
> 标签：android

我是 android 编程新手，现在使用 SQLite 数据库。我有一个简单的示例并创建代码：

```
public TimeTrackerOpenHelper(Context context) {
    super(context, "timetracker.db", null, 1);

}

@Override
public void onCreate(SQLiteDatabase db) {

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

} 
```

在我的活动类的 onCreate 方法中，我为 TimeTrackerOpenHelper 创建了一个 openHelper：

```
 TimeTrackerOpenHelper openHelpler = new TimeTrackerOpenHelper(this); 
```

我正在运行代码并按照路径 data/data/ 打开文件资源管理器，但我看不到数据库文件夹。为什么不显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:36:07.393

```
I'm running the code and opening the file explorer following the path data/data/ but i can't see databases folder. why it isn't showed? 
```

如果您在设备上进行测试，那么由于安全原因，除非您的设备已植根，否则您将看不到 DB 文件**。**

如果您想查看您的数据库文件。您可以使用`ADV`

# c# - 拆分字符串并将它们逐行放置

> ID：13122562
> 
> 赞同：1
> 
> 时间：2012-10-29T13:27:16.950
> 
> 标签：c#, string, list, split

我有一个问题，我怎样才能分割字符串并使分割的字符串逐行显示？

细绳：

```
What is "that" ENUM "No", "Yes", "OK", "Cancel"; 
```

我想要数据表：

```
Name   Type    Comment
"that" ENUM    "No"       // all of them
               "Yes"      // should be
               "OK"       // in the same
               "Cancel"   // cell 
```

一定是有`string[] tmpList = tmp.Split(new Char[] { ' ',',', ';' }, StringSplitOptions.RemoveEmptyEntries);`然后`attributeDEF.Rows.Add(new object[] { tmpList1[1], tmpList1[2], tmpList1[3] + "\n" + tmpList[a]+ "\n"});`

有人可以给我一个线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:35:51.020

以下代码将为您生成一行：

```
string tmp = @"What is ""that"" ENUM ""No"", ""Yes"", ""OK"", ""Cancel";

string[] tmpList = tmp.Split(new Char[] { ' ',',', ';' }, StringSplitOptions.RemoveEmptyEntries);

var row = new object[] { tmpList[0], tmpList[3], string.Join("\n", tmpList.Skip(4).ToArray()) }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:38:04.453

如果您询问为最后一个单元格连接字符串，那么这可能是一种选择：

```
var result = String.Join("\n", tmpList.Skip(4).ToArray()); 
```

# c# - AJAX UpdatePanel 中的 GridView 在删除时不刷新

> ID：13122566
> 
> 赞同：1
> 
> 时间：2012-10-29T13:27:28.797
> 
> 标签：c#, gridview, updatepanel

由于某种原因，在删除一行后，gridview 不会自动刷新。当我调试代码时，它会到达 UserAccessGrid_RowDeleted 方法，但页面上没有任何反应。这是我的代码。

```
 <ajax:UpdatePanel ID="UserAccessGridUpdatePanel" runat="server" RenderMode="Inline" UpdateMode="Conditional">
    <ContentTemplate>
        <asp:GridView ID="UserAccessGrid" runat="server" DataKeyNames="UserID" AutoGenerateColumns="False" OnRowDeleting="UserAccessGrid_RowDeleting" OnRowDeleted="UserAccessGrid_RowDeleted"
            CellPadding="3" Width="100%">
            <RowStyle CssClass="GridRow" />
            <AlternatingRowStyle CssClass="GridAltRow" />
            <HeaderStyle HorizontalAlign="Left" />
            <Columns>     
                <asp:TemplateField>
                    <ItemTemplate>
                        <asp:LinkButton ID="DeleteButton" runat="server" CommandName="Delete" Text="Delete" OnClientClick="return confirm('Are you sure you want to delete this user?');"></asp:LinkButton>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Employee Name">
                    <ItemTemplate>
                        <a href="AddUser.aspx?uid=<%# QueryStringEncryption.Encrypt( DataBinder.Eval(Container.DataItem, "UserID").ToString() )%>">
                            <%#DataBinder.Eval(Container.DataItem, "EmployeeName") %>
                        </a>
                    </ItemTemplate>                        
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Email">
                    <ItemTemplate>
                        <%#DataBinder.Eval(Container.DataItem, "EmailAddress")%>
                    </ItemTemplate>                        
                </asp:TemplateField>
                <asp:CheckBoxField 
                    DataField="IsCSEAdmin" 
                    HeaderText="CSE Administrator" 
                    ReadOnly="True" 
                    ItemStyle-HorizontalAlign="Center" >
                <ItemStyle HorizontalAlign="Center" />
                </asp:CheckBoxField>
                <asp:CheckBoxField 
                    DataField="IsAdmin" 
                    HeaderText="Country Administrator" 
                    ReadOnly="True" 
                    ItemStyle-HorizontalAlign="Center" >
                <ItemStyle HorizontalAlign="Center" />
                </asp:CheckBoxField>
            </Columns>
        </asp:GridView>
    </ContentTemplate>
    <Triggers>
        <ajax:AsyncPostBackTrigger ControlID="UserAccessGrid" />
    </Triggers>
</ajax:UpdatePanel> 
```

后面的代码：

```
 protected void Page_Load(object sender, EventArgs e)
{
    if (!(Master.user.IsAdmin || Master.user.IsCSEAdmin))
        Response.Redirect("Unauthorized.aspx");

    //UserAccessDS.SelectParameters["UserID"].DefaultValue = Master.user.UserID;
    if (!Page.IsPostBack)
    {
        UserAccessGridBind();
    }
}

protected void UserAccessGrid_RowDeleting(object sender, GridViewDeleteEventArgs e)
{
    int UserID = (int)UserAccessGrid.DataKeys[e.RowIndex].Value;
    if (Convert.ToInt32(Master.user.UserID) == UserID)
    {
        ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "Alert", "alert('Delete action permitted on that user!');", true);
    }
    else
    {
        OleDbCommand command = new OleDbCommand("dbo.usp_DeleteUserbyUserID", Master.connection);
        command.Connection.Open();

        try
        {
            command.CommandType = CommandType.StoredProcedure;
            OleDbParameter param = command.Parameters.Add("@UserID", OleDbType.Integer);
            param.Value = UserID;

            command.ExecuteNonQuery();

            ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "Information", "alert('Delete complete.');", true);
        }
        catch (Exception ex)
        {
            ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "Alert", "alert('An error occured : " + ex.Message + "');", true);
        }
        finally
        {
            command.Connection.Close();
        }
    }
}

protected void UserAccessGrid_RowDeleted(object sender, GridViewDeletedEventArgs e)
{
    UserAccessGridUpdatePanel.Update();
}

private void UserAccessGridBind()
{
    int UserID = Convert.ToInt32(Master.user.UserID);

    OleDbDataAdapter adapter = new OleDbDataAdapter();
    OleDbCommand command = new OleDbCommand("dbo.usp_GetAccessListByUserID", Master.connection);

    command.CommandType = CommandType.StoredProcedure;
    command.Parameters.AddWithValue("UserID", UserID);

    adapter.SelectCommand = command;

    DataSet UserAccess = new DataSet();
    adapter.Fill(UserAccess);

    UserAccessGrid.DataSource = UserAccess;
    UserAccessGrid.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:29:30.603

删除后需要重新绑定网格。正如你之前绑定的那样。

删除记录后调用`UserAccessGridBind()`方法刷新网格。

# unit-testing - xsl-fo 的单元测试框架

> ID：13122570
> 
> 赞同：3
> 
> 时间：2012-10-29T13:27:47.707
> 
> 标签：unit-testing, xsl-fo

我需要在 xsl-fo 上运行单元测试。我想知道是否有我可以使用的框架。utf-x 好像很复杂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-01T13:18:41.310

天线房屋回归测试系统（[http://www.antennahouse.com/antenna1/antenna-house-regression-testing-system/](http://www.antennahouse.com/antenna1/antenna-house-regression-testing-system/)）可以运行您的 FO，并在格式化输出和参考之间进行逐像素比较输出。

如果您想测试生成 FO 的 XSLT，请查看 XSpec ( [https://github.com/expath/xspec](https://github.com/expath/xspec) )。

# php - 使用 CURL PHP 执行 javascript 后获取 HTML 代码

> ID：13122574
> 
> 赞同：4
> 
> 时间：2012-10-29T13:27:57.223
> 
> 标签：php, javascript, html, curl

我想获取由 javascript 生成的网页的 html 源代码，`Curl(PHP)` 我尝试了 curl，但我只得到一个 javascript 代码:(

我可以使用 ruby​​ 来解决我的问题吗？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:31:19.277

javascript由浏览器执行以生成HTML。如果您使用 CURL 发出请求，它只会向您显示实际的 HTML 内容。在收到响应正文后，您需要一个 Javascript 引擎来处理 Javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:32:55.957

只需查看任何网络检查器工具（在 chrome 中只需 ctrl+shift+i）。在这里，您可以看到 javascript 在反映的页面上所做的更改。我不认为 curl 或任何类似 curl 的工具可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:54:53.203

这是一个棘手的问题，因为必须运行 JavaScript 才能获得正确的代码。我想说的是在本地下载所有代码，然后在代码中添加一个ajax调用，这样它就可以在所有js运行后将源ajax返回给你。然后在浏览器中运行代码。

如果您需要多次执行此操作，您可以将这些需要加载到数据库中的页面排队并使用 php.ini 加载所有页面。然后，一旦 js 将 ajax 代码返回到服务器，它就可以刷新并将下一页从队列中拉出。

如果您需要我澄清任何事情，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-18T14:05:26.323

这可以通过像 phantom js 这样的无头浏览器活动来完成，这是一种创建自己的逻辑的好方法，然后在控制台中为 php 获取结果数组，您可以在此处尝试活动[https://github.com/jonnnnyw/php-phantomjs](https://github.com/jonnnnyw/php-phantomjs) & 也[https://github.com/ariya/phantomjs](https://github.com/ariya/phantomjs)

# python - 如何通过删除python中的重复项进行压缩？

> ID：13122575
> 
> 赞同：3
> 
> 时间：2012-10-29T13:27:57.763
> 
> 标签：python, string, compression, whitespace

我有带有相同字符块的字符串，例如'1254,,,,,,,,,,,,,,,,,982'。我的目标是用类似 '1254(,16)982' 的方式替换它，以便可以重建原始字符串。如果有人能指出我正确的方向，将不胜感激

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T13:30:52.013

您正在寻找[运行长度编码](http://en.wikipedia.org/wiki/Run-length_encoding)：这是一个松散地基于此的 Python[实现](http://wordaligned.org/articles/runlength-encoding-in-python)。

```
import itertools

def runlength_enc(s):
    '''Return a run-length encoded version of the string'''
    enc = ((x, sum(1 for _ in gp)) for x, gp in itertools.groupby(s))
    removed_1s = [((c, n) if n > 1 else c) for c, n in enc]
    joined = [["".join(g)] if n == 1 else list(g)
                    for n, g in itertools.groupby(removed_1s, key=len)]
    return list(itertools.chain(*joined))

def runlength_decode(enc):
    return "".join((c[0] * c[1] if len(c) == 2 else c) for c in enc) 
```

对于您的示例：

```
print runlength_enc("1254,,,,,,,,,,,,,,,,982")
# ['1254', (',', 16), '982']
print runlength_decode(runlength_enc("1254,,,,,,,,,,,,,,,,982"))
# 1254,,,,,,,,,,,,,,,,982 
```

（请注意，只有在您的字符串中有很长的运行时，这才会有效）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:51:41.343

如果您不关心确切的压缩形式，您可能需要查看`zlib.compress`and `zlib.decompress`。`zlib`是一个标准的 Python 库，可以压缩单个字符串，并且可能会比自我实现的压缩算法获得更好的压缩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T15:53:54.703

使用正则表达式：

```
s = '1254,,,,,,,,,,,,,,,,982'

import re
c = re.sub(r'(.)\1+', lambda m: '(%s%d)' % (m.group(1), len(m.group(0))), s)
print c # 1254(,16)982 
```

使用迭代工具

```
import itertools
c = ''
for chr, g in itertools.groupby(s):
    k = len(list(g))
    c += chr if k == 1 else '(%s%d)' % (chr, k)
print c # 1254(,16)982 
```

# ruby-on-rails - 我处理我的 Rails 站点的架构是否正确？

> ID：13122579
> 
> 赞同：1
> 
> 时间：2012-10-29T13:28:19.017
> 
> 标签：ruby-on-rails

这是一个相当主观的问题。我正在寻找专家意见，因为这是我第一次构建企业 Rails 应用程序。

我决定让我的网站完全基于 AJAX，而且我根本不使用 Rails AJAX 助手。原因是：我是 Web 开发的新手，我想知道我正在编写的代码背后发生了什么。

此外，这是一个相当大的基于仪表板的分析应用程序，我绝对没有使用任何 erb 标签。所有数据都使用 AJAX 来来去去。

所以，每当我需要任何数据时，我都会写一个这样的rails路线

```
match "people/all" => "people#all"

respond_to do |format|
    format.json { all json is rendered here }
end 
```

POST 调用也是如此。

我做对了吗？

接下来我要做的是添加 CSRF 令牌安全性（如果不匹配，控制器将不发送 AJAX）

我还在这个项目中为移动应用程序开发了一个 API，但该 API 受密钥保护。

我知道可能像 ember 或微框架之类的东西可能是更好的选择，但我选择了 rails，因为我的应用程序将有很多功能，所以我坚持使用 rails 而不是潜入另一个框架。

所以，

1.  在没有erb标签的情况下制作rails视图并使用AJAX做所有事情在某种程度上是不是很糟糕？

2.  我的应用程序会以任何方式易受攻击吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T15:27:08.877

你不应该自己做这些，Rails 会为你做这些，包括处理 CSRF 令牌。您的应用程序控制器应该已经这样做了。

`resources :people`在您的路线中使用。“让所有人”的途径应该只是`/people`，而不是`/people/all`。

检查脚手架生成的控制器，以确定您的路由应如何映射到七个默认的 RESTful 操作。

# python - 具有互斥可选参数的python类/子类，使用超类的实例作为可能的构造函数

> ID：13122580
> 
> 赞同：2
> 
> 时间：2012-10-29T13:28:18.733
> 
> 标签：python, optional-parameters

我试图在python中定义一个类B，A的子类，它可以接受多种实例化方式，非常灵活。A 是一个成员很少的简单类。我知道如何编写 A 以允许混合位置/关键字参数并在省略某些参数时使用默认值。

我的问题来自 B 类。B 只是 A 有一个额外的成员。但是当我创建 B 的一个实例时，我希望有以下选择：

*   从位置/关键字参数混合创建的实例（非常像 A）
*   创建指定额外成员的实例和 A 的现有实例（或副本）
*   仅使用 A 的现有实例创建，并且额外成员获取默认值。
*   互斥地使用 A 的现有实例和位置/关键字参数

编辑：像这样

```
class A:
    def __init__(self, x1=1, x2='a', x3=4.0)
        self.x1=x1
        self.x2=x2
        self.x3=x3

class B(A):
    def __init__(self, x1=1, x2='a', x3=4.0, x4='t')
        self.x4=x4
        A.__init__(x1,x2,x3) 
```

但后来我想像这样使用它：

```
a1=A()
b1=B()         # takes all defaults
b2=B(x4='r')   # x1,x2,x3 gets defaults from A
b3=B(a1,x4='z')  # use a1, an instance of A
b4=B(x1,x2,x3,x4) # defines manually all arguments
b5=B(a1,x1=2) # this one should not work because x1 can come from the instance a1 or x1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:36:41.660

最简单的事情可能是使用`B`与使用相同的签名的简单直接的初始化器进行定义`A`，然后定义为类方法的附加工厂函数以执行更复杂的场景。这样，当两种不同的构造方法实际上采用完全无法区分的参数时，您就不会搞砸。

所以像：

```
class B(A):
    def __init__(self, some, args):
        A.__init__(self, some, args)

    @classmethod
    def fromA(cls, theA, extra=some_default):
        newB = cls(theA.some, theA.args)
        newB.extra = extra
        return newB 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:41:29.433

根据我的经验，处理此类复杂情况的最佳方法是`*args, **kwargs`通过一系列条件手动使用和处理它们，例如`B.__init__`：

```
if isinstance(arg[0], A):
    if has_other_args:
        raise TypeError
    else:
        do_something()
else:
    do_something_else() 
```

但是，这仍然会变得非常复杂，因此工厂函数（如 Duncan 所建议的）可能是最好的方法。

旁注：每当我发现自己需要这种功能时，这通常表明我的设计有问题。即使我实现了它，我通常最终也会用更整洁的东西替换整个结构。

# javascript - 将 javascript 添加到 drupal 无法识别某些 jquery

> ID：13122583
> 
> 赞同：2
> 
> 时间：2012-10-29T13:28:33.237
> 
> 标签：javascript, session, drupal

我试图让这段代码在drupal上工作，但只有当我按f5时才有效，链接或表单不起作用，知道这段代码有什么问题吗？

我的目标是在您关闭选项卡或关闭资源管理器时终止会话。此代码是对此链接的修改： http: [//eureka.ykyuen.info/2011/02/22/jquery-javascript-capture-the-browser-or-tab-closed-event/#comment-6936](http://eureka.ykyuen.info/2011/02/22/jquery-javascript-capture-the-browser-or-tab-closed-event/#comment-6936)

```
<code>
(function($) {

var validNavigation = false;

  var dont_confirm_leave = 0; //set dont_confirm_leave to 1 when you want the user to be able to leave withou confirmation
  var leave_message = 'Do you want to exit?';

  function goodbye(e) {
    if (!validNavigation) {
      if (dont_confirm_leave!==1) {
        if(!e) e = window.event;
        //e.cancelBubble is supported by IE - this will kill the bubbling process.
        e.cancelBubble = true;
        e.returnValue = leave_message;
        //e.stopPropagation works in Firefox.
        if (e.stopPropagation) {
          e.stopPropagation();
          e.preventDefault();
        }
        //return works for Chrome and Safari
        // window.open('DelLogged.php?Id=');
        return leave_message;
      }
    }
  }

   // Attach the event click for all links in the page
  $("a").click(function () {
    validNavigation = true;
    alert("Link press");
  });

  // Attach the event keypress to exclude the F5 refresh
  $(document).bind('keypress', function(e) {
    if (e.keyCode == 116){
      validNavigation = true;
      alert("F5 press");
    }
  });

  // Attach the event submit for all forms in the page
  $("form").bind("submit", function() {
    validNavigation = true;
    alert("Form press");
  });
  // Attach the event click for all inputs in the page
  $("input[type=submit]").bind("click", function() {
    validNavigation = true;
    alert("input press");
  });

window.onbeforeunload=goodbye;

})(jQuery);
</code> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T10:29:42.023

我认为您没有`(function($){}(jQuery));`正确使用闭包，因为括号的书写方式不正确。你写过

```
 (function($) {
   ...
 })(jQuery); 
```

关闭初始括号之前`(jQuery);`

尝试更改此设置，看看是否可以解决问题:)

# svn - svn 更新的提交后挂钩

> ID：13122584
> 
> 赞同：1
> 
> 时间：2012-10-29T13:28:38.763
> 
> 标签：svn, sudo

我有一个存储库和一个工作副本。

在存储库的提交后挂钩中，我编写了一个命令来执行一个运行 SVN 更新命令的文件。

我的存储库位于`/var/www/svnrepos/help/`

我的工作副本在`/var/www/autopostcommit/help/`

提交后文件位于`/var/www/svnrepos/help/hooks/`

在提交后我写了以下命令

```
 sudo /usr/local/bin/svn-post-commit-update 1>&2 
```

在`svn-post-commit-update`/usr/local/bin 中的文件中，我编写了以下命令。

```
 cd /var/www/autopostcommit/help/
    svn update --non-interactive --trust-server-cert \
               --username satish@108.166.92.199 --password mypassword 
```

我还尝试了其他版本的命令进行更新，例如没有密码和所有。

SVN 提交给了我以下错误

```
 Error: sudo: no tty present and no askpass program specified 
```

我怎样才能克服这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T16:39:21.977

您已配置`sudo`为要求输入密码，这在 post-commit 挂钩中无法做到。修复似乎很简单：重新配置`sudo`，这样它就不会在您的情况下要求输入密码。

谨慎的人无论如何都不想运行 post-commit 钩子`root`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:44:54.520

您需要找到其他方法来以正确的用户身份执行脚本。也许制作脚本 setuid 是您的选择？[http://en.wikipedia.org/wiki/Setuid](http://en.wikipedia.org/wiki/Setuid)

然后你可以删除 sudo。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T20:08:21.900

真正的问题：你想做什么？

当您执行提交后挂钩时，正在执行提交的用户必须等待它完成。如果您尝试更新远程工作目录，您的用户会非常沮丧，因为每次他们进行提交时，他们都需要花 10 到 20 秒的时间来转动拇指，然后才能恢复他们的计算机。

有些事情最好不要做为钩子。相反，使用一个 crontab 条目，它每分钟检查一次存储库是否有更新，如果有更新，则执行它需要做的任何事情。

我认为您正在更新网页。我提出一个小建议：不要使用`svn update`. 而是使用`svn export`which 将删除所有`.svn`文件（我猜 1.7 版不再那么糟糕了）。我建议做的是两个目录策略：

你不`/var/www/autopostcommit/help/`直接更新你的。相反，您`svn update`对另一个目录执行操作，然后在更新完成后，将其移至`/var/www/autopostcommit/help`其他位置，然后将您导出的目录移动到`/var/www/autopostcommit/help/`. 这样，您的`/var/www/autopostcommit/help`目录就不会处于两个修订之间的状态。

# android - 使用 NDK 处理图像以显示轮廓

> ID：13122586
> 
> 赞同：1
> 
> 时间：2012-10-29T13:28:43.583
> 
> 标签：android, c++, c, android-ndk

我是 android ndk 的新手。我已经开始通过 ruckus 和 IBM 博客的图像处理示例进行学习。我正在尝试显示图像的轮廓。这是我正在使用的代码

```
package com.example;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

public class OutlineClass extends Activity{
    private ImageView imageView;
      private Bitmap bitmap;
      private Button button;
      private Bitmap original;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.outline);

          original  = BitmapFactory.decodeResource(getResources(), R.drawable.wallace);
          bitmap    = BitmapFactory.decodeResource(getResources(), R.drawable.wallace);
          button    = (Button) findViewById(R.id.obutton);
          imageView = (ImageView) findViewById(R.id.oimageView2);
          button.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                  ShowOutline();

            }

        });

        }

        private void ShowOutline() {
            Bitmap oBitmap = original.copy(Bitmap.Config.ARGB_8888, true);
            Bitmap gBitmap = bitmap.copy(Bitmap.Config.ARGB_8888, true);

            showOutlineWithNative(oBitmap,gBitmap );
            imageView.setImageBitmap(gBitmap);

        }

        public native void showOutlineWithNative(Bitmap bmp1, Bitmap bmp2);
    } 
```

这是我用来显示图像行的c代码

```
/*
To show outline
Pixel operation
*/
JNIEXPORT void JNICALL Java_com_example_OutlineClass_showOutlineWithNative(JNIEnv
* env, jobject  obj, jobject bitmapedges,jobject bitmapgray)
{
    AndroidBitmapInfo  infogray;
        void*              pixelsgray;
        AndroidBitmapInfo  infoedges;
        void*              pixelsedge;
        int                ret;
        int             y;
        int             x;
        int             sumX,sumY,sum;
        int             i,j;
        int                Gx[3][3];
        int                Gy[3][3];
        uint8_t            *graydata;
        uint8_t            *edgedata;

        LOGI("findEdges running");

        Gx[0][0] = -1;Gx[0][1] = 0;Gx[0][2] = 1;
        Gx[1][0] = -2;Gx[1][1] = 0;Gx[1][2] = 2;
        Gx[2][0] = -1;Gx[2][1] = 0;Gx[2][2] = 1;

        Gy[0][0] = 1;Gy[0][1] = 2;Gy[0][2] = 1;
        Gy[1][0] = 0;Gy[1][1] = 0;Gy[1][2] = 0;
        Gy[2][0] = -1;Gy[2][1] = -2;Gy[2][2] = -1;

        if ((ret = AndroidBitmap_getInfo(env, bitmapedges, &infogray)) < 0) {
            LOGE("AndroidBitmap_getInfo() failed ! error=%d", ret);
            return;
        }

        if ((ret = AndroidBitmap_getInfo(env, bitmapgray, &infoedges)) < 0) {
            LOGE("AndroidBitmap_getInfo() failed ! error=%d", ret);
            return;
        }

        if (infogray.format != ANDROID_BITMAP_FORMAT_A_8) {
            LOGE("Bitmap format is not A_8 !");
            return;
        }

        if (infoedges.format != ANDROID_BITMAP_FORMAT_A_8) {
            LOGE("Bitmap format is not A_8 !");
            return;
        }

        if ((ret = AndroidBitmap_lockPixels(env, bitmapedges, &pixelsgray)) < 0) {
            LOGE("AndroidBitmap_lockPixels() failed ! error=%d", ret);
        }

        if ((ret = AndroidBitmap_lockPixels(env, bitmapgray, &pixelsedge)) < 0) {
            LOGE("AndroidBitmap_lockPixels() failed ! error=%d", ret);
        }

        // modify pixels with image processing algorithm

        LOGI("time to modify pixels....");

        graydata = (uint8_t *) pixelsgray;
        edgedata = (uint8_t *) pixelsedge;

        for (y=0;y<=infogray.height - 1;y++) {
            for (x=0;x<infogray.width -1;x++) {
                sumX = 0;
                sumY = 0;
                // check boundaries
                if (y==0 || y == infogray.height-1) {
                    sum = 0;
                } else if (x == 0 || x == infogray.width -1) {
                    sum = 0;
                } else {
                    // calc X gradient
                    for (i=-1;i<=1;i++) {
                        for (j=-1;j<=1;j++) {
                            sumX += (int) ( (*(graydata + x + i + (y + j)
    * infogray.stride)) * Gx[i+1][j+1]);
                        }
                    }

                    // calc Y gradient
                    for (i=-1;i<=1;i++) {
                        for (j=-1;j<=1;j++) {
                            sumY += (int) ( (*(graydata + x + i + (y + j)
    * infogray.stride)) * Gy[i+1][j+1]);
                        }
                    }

                    sum = abs(sumX) + abs(sumY);

                }

                if (sum>255) sum = 255;
                if (sum<0) sum = 0;

                *(edgedata + x + y*infogray.width) = 255 - (uint8_t) sum;

            }
        }

        AndroidBitmap_unlockPixels(env, bitmapgray);
        AndroidBitmap_unlockPixels(env, bitmapedges);

} 
```

我得到的结果是相同的图像，没有任何变化...我知道用于检测轮廓的 sebel 算法，但我不知道它是如何以编程方式检测边缘的，请让我知道代码中有什么问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:13:16.780

我怀疑这里有几个问题。

首先，在您的 NDK 代码中，检查输入位图是否编码为 Alpha_8 图像（即灰度图像）：

```
if (infogray.format != ANDROID_BITMAP_FORMAT_A_8) {
        LOGE("Bitmap format is not A_8 !");
        return;
}

if (infoedges.format != ANDROID_BITMAP_FORMAT_A_8) {
        LOGE("Bitmap format is not A_8 !");
        return;
} 
```

创建位图时，将 传递`Bitmap.Config.ARGB_8888`给`copy`函数。我怀疑这会导致这些检查失败，因此函数在处理图像之前返回。您应该使用创建位图`copy(Bitmap.Config.ALPHA_8, true)`

在我看来，您还试图在流程结束时显示错误的位图：您以`showOutlineWithNative`错误的顺序传递位图。您要显示的位图是`bitmapedges`本机函数的参数，在这里您将显示输入的灰度图像。

总而言之，在我看来，正确的代码`ShowOutline`应该是：

```
private void ShowOutline() {
        // grayscale version of the original bitmap:
        Bitmap gray = original.copy(Bitmap.Config.ALPHA_8, true);
        // receiver bitmap for the Sobel detector:
        Bitmap output = bitmap.copy(Bitmap.Config.ALPHA_8, true);

        showOutlineWithNative(output, gray);
        imageView.setImageBitmap(output);

} 
```

让我了解你的进展！

# image - Yootheme widgetkit 视频和图片库？

> ID：13122588
> 
> 赞同：1
> 
> 时间：2012-10-29T13:29:14.850
> 
> 标签：image, video, gallery, slideshow

我正在尝试找到一种在 yootheme widgetkit 库中播放视频的方法。

目前我只能显示图像，但我还想将 vimeo 视频添加到幻灯片中......

有什么想法请帮忙。

# oracle - 如何获取所有下拉值

> ID：13122589
> 
> 赞同：2
> 
> 时间：2012-10-29T13:29:15.673
> 
> 标签：oracle, jsp, jdbc

我有一个案例，我必须得到所有下拉元素的总数。我能够单独实现它。以下是适用于个人选择的代码。

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>  
<!DOCTYPE html>  
<html>  
<head>  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  
    <title>JSP Page</title>  
</head>  
<body><form name="Reports" method="post" action="Reports.jsp"><table><tr><td>  
    Select user:<select name="user" id="user">  
        <option value="">Select User</option>  
        <option value="Rakesh">Rakesh</option>  
        <option value="Hari">Hari</option>  
    </select></td><td>  
    Select Type:<select name="type" id="type">  
        <option value="'Updates','Multibases','DAIS','Acds','Legis','LegAll'">All</option>  
        <option value="Updates">Updates</option>    
        <option value="Multibases">Multibases</option>  
        <option value="DAIS">DAIS</option>  
        <option value="Acds">Admin Codes</option>  
        <option value="Legis">Legis</option>  
        <option value="LegAll">Legis-All</option>  
            </select></td>  
            <td><input type="submit" value="Generate" id="sub1" name="sub1"></td></tr>  
    </table> </form>   </body> 
```

jsp在下面

```
<%--   
Document   : Reports  
Created on : Oct 25, 2012, 4:53:23 PM  
Author     : u0138039  
--%>  

<%@page contentType="text/html" pageEncoding="UTF-8"%>  
<%@include file="DBCon.jsp" %>  
<!DOCTYPE html>  
<html>  
<head>  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  

</head>  
<body><table>  
    <%  

    String[] a=request.getParameterValues("type");  
    String b=request.getParameter("user");  
    try{  
        ps=con.prepareStatement("Select * from Scope1");  

        ps=con.prepareStatement("SELECT SUM(Update_Count) FROM Scope1 where type ='"+a+"' and Specialist='"+b+"'");  
        rs=ps.executeQuery();  
        while(rs.next())  
                           {%>  
                           <tr>  
                               <td><%=a%>:</td><td>  
                               <%=rs.getString(1)%>  
                               </td></tr>  
      <% }  

                   }  
    catch(Exception e)  
    {  
        out.println(e);  
}  
%> 
```

并从下拉列表中检索所有值，我使用下面的 sql 代码

```
SELECT SUM(Update_Count) FROM Scope1 where type IN ('All','Updates','Multibases','DAIS','Acds','Legis','LegAll') and Specialist='b'; 
```

并单独检索我使用下面的代码

```
 ps=con.prepareStatement("SELECT SUM(Update_Count) FROM Scope1 where type IN ('"+a+"') and Specialist='"+b+"'"); 
```

我希望这在单个语句中，并且我希望在全选时以表格格式显示输出。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:33:06.607

我看到的一个问题是在这个声明中

```
ps=con.prepareStatement("SELECT SUM(Update_Count) FROM Scope1 
where type ='"+a+"' and Specialist='"+b+"'"); 
```

因为`a`是数组类型，当您在上面的 sql 语句中分配它时，您提到`a`没有数组索引。因此这个 sql 语句一定是失败的。

```
String[] a=request.getParameterValues("type"); 
```

编辑

我可以看到另一个问题是

```
<%=rs.getString(1)%> 
```

你应该使用

```
<%=rs.getInt(1)%> 
```

因为`SELECT SUM(Update_Count)`返回数字，所以`getString`会给你一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:39:11.027

我相信您需要调整查询以拉回类型列，并包含一个分组依据。然后，这将在结果集中为您提供多行。您将需要适当地以编程方式调整 IN 子句中的内容。

SELECT SUM(Update_Count), type FROM Scope1 where type IN ('All','Updates','Multibases','DAIS','Acds','Legis','LegAll') and Specialist='b' group by type ;

# plone - AttributeError：“模块”对象没有属性“NavigationViewlet”

> ID：13122607
> 
> 赞同：2
> 
> 时间：2012-10-29T13:30:19.140
> 
> 标签：plone

这是我从 Plone 4.2.1 安装（在 SuSE Linux 上）的回溯：

```
Traceback (innermost last):

Module ZPublisher.Publish, line 126, in publish
Module ZPublisher.mapply, line 77, in mapply
Module ZPublisher.Publish, line 46, in call_object
Module OFS.ObjectManager, line 620, in manage_importObject
Module OFS.ObjectManager, line 638, in _importObjectFromFile
Module ZODB.ExportImport, line 92, in importFile
Module transaction._transaction, line 260, in savepoint
Module transaction._transaction, line 257, in savepoint
Module transaction._transaction, line 690, in __init__
Module ZODB.Connection, line 1123, in savepoint
Module ZODB.Connection, line 587, in _commit
Module ZODB.ExportImport, line 176, in _importDuringCommit

AttributeError: 'module' object has no attribute 'NavigationViewlet' 
```

奇怪的是，我不明白的是，为什么只有一个 Plone Site 在导入比 Plone 4.1.5 更新的实例时显示此错误？

Plone 站点仅安装了以下附加插件/产品（与其他插件一样，但它们都可以正常工作）：

*   LinguaPlone
*   PloneFormGen
*   产品.ZSyncer
*   集体快速上传

那么，我的错误/错误在哪里？

感谢您的帮助，因为该站点现在太大了，无法从头开始在新的 Plone 实例中“重建”它:-(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T16:42:14.400

已在2.2 版`plone.app.layout.viewlets.links.NavigationViewlet`中删除（请参阅[HTML5 PLIP 中的此条目](https://dev.plone.org/ticket/11300#comment:39)和[此提交](https://github.com/plone/plone.app.layout/commit/3aa2c5448646cd1b7db5ef8f5a06a5fae64b3795)）。`plone.app.layout`

ZEXP 导入到不同的版本堆栈通常充满了问题，这正是因为持久对象位置的变化。您必须导入到较早版本的软件堆栈，然后按照常规[Plone 升级路径](http://plone.org/documentation/manual/upgrade-guide)将自己升级到更新版本的 Plone。

例如，升级脚本负责删除对已删除视图的引用，例如这些。

# android - Android：如果用户离开当前活动，如何暂停下一个活动的启动？

> ID：13122609
> 
> 赞同：1
> 
> 时间：2012-10-29T13:30:19.923
> 
> 标签：android, splash-screen

我为我的应用程序创建了启动画面。5 秒后，它使用以下代码开始下一个活动。现在我的问题是，如果用户在 5 秒结束前离开当前活动，那么只要 5 秒结束，下一个活动（在我的情况下为 InfoActivity）就会出现在前面，即使我在另一个应用程序或其他任何地方。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.launch);
    new Handler().postDelayed(new Runnable() {

        public void run() {
            final Intent mainIntent = new Intent(LaunchActivity.this, InfoActivity.class);
            LaunchActivity.this.startActivity(mainIntent);
            LaunchActivity.this.finish();
        }
    }, 5000);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:35:20.600

你可以使用一个变量

```
shouldNavigate=true; 
```

您在原始活动的 onDestroy() 方法中取消设置。

```
onDestroy() {
    shouldNavigate=false;
    [...]
} 
```

然后在您的 postDelayed-run()-method 中检查

```
if(shouldNavigate) {...} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T11:38:00.437

这个程序对我有用。

> 标志=假；

```
runnable = new Runnable() {
    public void run() {

        if(!flag) {
            final Intent mainIntent = new Intent(LaunchActivity.this, InfoActivity.class);
            LaunchActivity.this.startActivity(mainIntent);
            LaunchActivity.this.finish();
            }
        }
    };
handler = new Handler();
handler.postDelayed(runnable, 5000);

onPause() {
super.onPause();
flag = true;
handler.removeCallbacks(runnable);
}

onRestart() {
super.onRestart();
flag = false;
handler.postDelayed(runnable, timeOfPause-timeOfCreate);
} 
```

# python - 将 Python 脚本转换为 Ruby 时出错

> ID：13122615
> 
> 赞同：3
> 
> 时间：2012-10-29T13:30:46.610
> 
> 标签：python, ruby, xml-rpc, xmlrpclib

我正在使用一个 Python 脚本，它使用`xmlrpclib`：

```
import xmlrpclib
srv = xmlrpclib.ServerProxy("http://demo.myslice.info:7080/", allow_none=True)

# authentication token
auth = {"AuthMethod": "password", "Username": "guest", "AuthString": "guest"}
ret = srv.Get(auth, "slice", [["slice_hrn", '=', "ple.upmc.myslicedemo"]], {}, ["slice_hrn"])
print ret 
```

我想使用 Ruby 进行类似的 XML-RPC 调用。为此，我使用了以下代码：

```
require "xmlrpc/client"
require "pp"

XMLRPC::Config.module_eval do
    remove_const :ENABLE_NIL_PARSER
    const_set :ENABLE_NIL_PARSER, true
end

ret = XMLRPC::Client.new2("http://demo.myslice.info:7080/")

auth = {"AuthMethod" => "password", "Username" => "guest", "AuthString" => "guest"}

pp ret.call("Get", auth, "slice", {"slice_hrn" => "ple.upmc.myslicedemo"}, ["slice_hrn"]) 
```

当我运行这个 Ruby 脚本时，我收到以下错误：

```
.../xmlrpc/client.rb:414:in `call': error (XMLRPC::FaultException) 
```

我能做些什么来解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T20:25:43.647

错误在转换中。我使用字典而不是列表中的列表。我解决了它：

```
require "xmlrpc/client"
require "pp"

XMLRPC::Config.module_eval do
    remove_const :ENABLE_NIL_PARSER
    const_set :ENABLE_NIL_PARSER, true
end

ret = XMLRPC::Client.new2("http://demo.myslice.info:7080/")

auth = {"AuthMethod" => "password", "Username" => "guest", "AuthString" => "guest"}

pp ret.call("Get", auth, "slice", [["slice_hrn", "=" ,"ple.upmc.myslicedemo"]], {}, ["slice_hrn"]) 
```

# php - 输入图像作为可点击按钮

> ID：13122619
> 
> 赞同：-2
> 
> 时间：2012-10-29T13:30:56.973
> 
> 标签：php, html, image, button, input

我想制作一个可点击的图像，以防它被点击时我`$_POST`用来获取它的价值并使用它。它看起来像这样：

```
if (isset($_POST['checked'])){
 $q = mysql_query("UPDATE table SET checked = 2 WHERE tr_id = ". $_POST['checked']);
}

<form action="" method="POST">
  <input type="image" src="images/checked.png" name="checked" value="<?php echo $info[0]; ?" />
</form> 
```

好吧，在 Chrome 中它可以工作，但后来我意识到在 IE 和 Mozilla 中它不起作用，任何人都可以建议我同样的事情，但它适用于所有浏览器吗？

主要是这个图像值字段从数据库中获取它的值`mysql_fetch_row`，我必须在更新查询中使用这个值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:33:41.850

如果关闭双引号和输入标签会很好：

```
 <input type="image" src="images/checked.png" name="checked" value="<?php echo $info[0]; ?>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:33:52.503

您缺少双引号`"`，`>`并在最后：D

```
value="<?php echo $info[0];"> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-29T13:33:55.470

它甚至可以在其他浏览器中使用，但是如果您希望按钮中包含丰富的 HTML，请坚持使用`<button>`：

```
<button>
  <img src="someImg.jpg" alt="">
</button> 
```

这也将提交您`<form>`的。

# python - 从提取的 HTML 页面处理 python 中的可变特殊字符

> ID：13122620
> 
> 赞同：1
> 
> 时间：2012-10-29T13:30:59.297
> 
> 标签：python, encoding, utf-8, ascii

当我使用 Mechanize 获取 html 数据时，我将其存储到一个变量中，我们称之为“HTML_RESPONSE”。完成后，我会对其进行解析并提取三项内容：标题、简短描述和详细描述。

我面临的问题是短或长描述有可能包含 - &、£、$ 等字符。

当我尝试将其放入 XML 并保存它时，就会出现问题，因为当我尝试解码这些时，python 会发疯。

例如，这里是页面的简短描述：

```
S_DESC = "Senior VP of Treasury and Corporate Finance & ERM, 
RTL Group, has been invited to the above conference to present a Case Study 
on Integrating Strategy and Risk into Enterprise Risk Management" 
```

我解码的方式-

```
#!/usr/bin/python
# -*- coding: ISO-8859-1 -*-

print S_DESC.decode('UTF-8').encode('ascii','xmlcharrefreplace') 
```

这适用于＆符号。如果然后我得到一个带有英镑符号的 S_DESC，我的脚本会因以下输出而中断：

**UnicodeEncodeError: 'ascii' 编解码器无法编码字符 u'\xa3'**

这段代码在我的脚本部分中失败的地方（上述异常在最后一行抛出，每次我得到一个英镑符号时）。我想知道是否有一种通用的方法可以告诉 python 自己处理这些字符。为每个可能的不兼容字符制作 100 个函数不是一种选择，同样，我不准备筛选整个网站（2k + 篇文章）以识别所有“可能”使我的代码失效的特殊字符。 ..

```
XML = """
    <MAIN>
        <ITEM>
            <Author>{0}</Author>
            <Author_UN>{1}</Author_UN>
            <Date_Modified>{2}</Date_Modified>
            <Date_Published>{3}</Date_Published>
            <Default_Group_Rights>
                {4}
            </Default_Group_Rights>
            <attachment>
                <file_name>{5}</file_name>
                <file_extension>{6}</file_extension>
                <file_stored_local>{7}</file_stored_local>
            </attachment>
            <title>{8}</title>
            <sm_desc>{9}</sm_desc>
            <lg_desc>
                <![CDATA[
                {10}
                ]]>
            </lg_desc>
        </ITEM>
    </MAIN>""".format(author_soup,  username,  date_modified,  published_date,  xrights,  attachment_text,  file_extension,  localstore,  item_title.decode('UTF-8').encode('ascii','xmlcharrefreplace'), short_description.decode('UTF-8').encode('ascii','xmlcharrefreplace'),  long_description.decode('UTF-8').encode('ascii','xmlcharrefreplace')) 
```

# [编辑]

这是我创建的示例代码，它完美地反映了错误，以防万一有人对此不感兴趣？

```
 #TESTING GROUND
# -*- coding: UTF-8 -*-

author_soup = "John Smith"
username = "jsmith"
date_modified = "25 December 2012, 15:42 PM"
published_date = "25 December 2012, 15:42 PM"
xrights = "r-w-x-x"
attachment_text = "Random Attachment"
file_extension = "txt"
localstore = "../Local"
item_title = "The NEw Financial Reforms of 2012"
short_description = " £16 Billion Spent on new reforms backfire."
long_description = '[<p>fullstory</p>, <p><a class="external-link" href="http://business.timesonline.co.uk/tol/business/industry_sectors/banking_and_finance/article4526065.ece">http://business.timesonline.co.uk/tol/business/industry_sectors/banking_and_finance/article4526065.ece</a></p>]'

XML = """
<MAIN>
    <ITEM>
        <Author>{0}</Author>
        <Author_UN>{1}</Author_UN>
        <Date_Modified>{2}</Date_Modified>
        <Date_Published>{3}</Date_Published>
        <Default_Group_Rights>
            {4}
        </Default_Group_Rights>
        <attachment>
            <file_name>{5}</file_name>
            <file_extension>{6}</file_extension>
            <file_stored_local>{7}</file_stored_local>
        </attachment>
        <title>{8}</title>
        <sm_desc>{9}</sm_desc>
        <lg_desc>
            <![CDATA[
            {10}
            ]]>
        </lg_desc>
    </ITEM>
</MAIN>""".format(author_soup,  username,  date_modified,  published_date,  xrights,  attachment_text,  file_extension,  localstore,  item_title.decode('UTF-8'), short_description.decode('UTF-8'),  long_description.decode('UTF-8')) 
```

# c# - 为多语言 umbraco 网站在保存时复制内容

> ID：13122623
> 
> 赞同：6
> 
> 时间：2012-10-29T13:31:19.013
> 
> 标签：c#, content-management-system, umbraco, duplication

[编辑] 实际上，我已经被允许使用文档名称，这使它更容易，但我仍然认为找出是否可能会很有趣。

我必须设置一个触发器以将内容复制到内容树上的不同分支，因为该站点将使用多种语言。有人告诉我，我不能按名称访问文档（因为它们可能会更改），我也不应该使用节点 ID（不是说我会知道如何使用，一段时间后会变得难以遵循结构）。

如何遍历树以将新文档插入其他语言的相关子分支中？有办法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T15:35:33.460

您可以使用 Document.AfterPublish 事件在特定文档对象发布后捕获它。我将使用此事件处理程序来检查节点类型别名是否是您要复制的别名，然后您可以调用 Document.MakeNew 并传递新位置的节点 ID。这意味着您不必使用特定的节点 ID 或文档名称来捕获事件。

例子：

```
using umbraco.cms.businesslogic.web;
using umbraco.cms.businesslogic;
using umbraco.BusinessLogic;

namespace MyWebsite {
    public class MyApp : ApplicationBase {
        public MyApp()
            : base() {
            Document.AfterPublish += new Document.PublishEventHandler(Document_AfterPublish);
        }

        void Document_AfterPublish(Document sender, PublishEventArgs e) {
            if (sender.ContentType.Alias == "DoctypeAliasOfDocumentYouWantToCopy") {
                int parentId = 0; // Change to the ID of where you want to create this document as a child.
                Document d = Document.MakeNew("Name of new document", DocumentType.GetByAlias(sender.ContentType.Alias), User.GetUser(1), parentId)
                foreach (var prop in sender.GenericProperties) {
                    d.getProperty(prop.PropertyType.Alias).Value = sender.getProperty(prop.PropertyType.Alias).Value;
                }
                d.Save();
                d.Publish(User.GetUser(1));
            }
        }
    }
} 
```

# asp.net-mvc - 根据模型值向元素添加样式

> ID：13122626
> 
> 赞同：4
> 
> 时间：2012-10-29T13:31:46.077
> 
> 标签：asp.net-mvc

如果满足特定条件，我想为我的 div 标签添加一个简单的内联样式。

我能够成功应用“禁用”类，但无法显示我的光标样式。

```
<div class="item  @(item.AvailableTimeSlots == "0" ? "disabled" : "")" @(item.AvailableTimeSlots == "0" ? "style='cursor: default;'" : "")> 
```

任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T14:06:05.570

**工作片段**

```
<div class="item  @("0" == "0" ? "disabled" : "")" @Html.Raw("0" == "0" ? "style='cursor: default;'" : "")> 
```

添加`Html.Raw()`解决了我的问题。没有它，你最终会得到类似的东西：

```
<div class="item  disabled" style=&#39;cursor: default;&#39;> 
```

我尝试了几种不同的浏览器，每个浏览器在检查 DOM 时都给出了不同的结果。IE8 破坏它；Chrome 错误地对其进行了改造；IE9 似乎正确地使其格式正确。

几点注意事项：

*   @James 删除内联样式的解决方案是一个很好的解决方案。当前的代码真的很难阅读，无论如何内联样式都不是一个好主意。
*   它看起来`item.AvailableTimeSlots`应该是一个整数，而不是一个字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T13:34:19.663

> 任何指针？

尽可能避免使用内联样式总是最好的。我建议您将`cursor`代码移动到它自己的 CSS 类中，并纯粹使用类，例如

**CSS**

```
.default {
    cursor: default;
}
.disabled {
    ...
} 
```

**看法**

```
@{
    var itemCLass = @item.AvailableTimeSlots == "0" ? "disabled" : "default";
}
<div class="item @itemClass" /> 
```

# javafx-2 - 在不同场景图分支之间拖放时的 Z 顺序

> ID：13122628
> 
> 赞同：2
> 
> 时间：2012-10-29T13:31:51.287
> 
> 标签：javafx-2

我有一个界面，我想将元素从元素列表拖到 GridPane。网格和列表位于场景图的不同分支中。因此，当我想将它拖到网格上时，我的可拖动节点消失在 GridPane 后面。

一种可能的解决方案是将可拖动节点添加到最前面的窗格中，它将位于所有其他节点的前面。不幸的是，这意味着在我知道拖放手势将成功之前，我必须将节点从其旧位置移除，这会导致各种额外的代码。

有没有办法让一个节点呈现在所有其他节点的前面而不改变它在场景图中的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:39:19.500

Is the "draggable Node" actually being moved around by the cursor? If so, you could create an Image from the node and drag that around?

# java - 将另一行组件添加到 relativelayout

> ID：13122631
> 
> 赞同：2
> 
> 时间：2012-10-29T13:31:58.143
> 
> 标签：java, android, layout, button

有谁知道如何得到这个结果？

![在此处输入图像描述](../Images/38182961f0b25f704bdea95e17b644cd.png)

***说明：*** 点击“+”按钮时，该行下方会显示*另一行EditText*、 *Spinner*、 *EditText*和*Button 。*如果用户单击“+”按钮，则会继续添加行。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:41:10.360

我认为最好的办法是实现一个在垂直方向上`ViewGroup`扩展 a的自定义。`LinearLayout`

您将`OnClickListener`在最后一个按钮上注册一个：如果该行是列表中的最后一个，您将添加一个新的`ingredients_item.xml`并将其添加到您的视图中（您还将从`+`to刷新可绘制对象`-`），否则删除当前行。

您的自定义视图将提供类似的方法`List<Ingredient> getIngredients()`，因此您可以将此列表传递给某个`save()`方法。

![截屏](../Images/2bd9f00c0c99b4b67350ad34304eb85d.png)

[我在 GitHub 上](https://github.com/RaffaeleSgarro/ingredients)推送了演示

# xslt - XSLT：我的转换添加了一个未选择的元素。我错过了什么？

> ID：13122632
> 
> 赞同：2
> 
> 时间：2012-10-29T13:32:00.600
> 
> 标签：xslt

好的，我正在从这里完成一些简单的教程：

[http://www.cch.kcl.ac.uk/legacy/teaching/7aavdh06/xslt/html/module_06.html](http://www.cch.kcl.ac.uk/legacy/teaching/7aavdh06/xslt/html/module_06.html)

第一个练习涉及创建一个产生特定输出的转换。不幸的是，虽然我很接近，但我在一开始就得到了一个不需要的元素。IE

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  version="2.0">

  <xsl:output method="xhtml"
    doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" />

  <xsl:template match="/div/placeName">
    <html>
      <head />
      <body>
        <Table>
          <tr>
            <td>Place Name</td>
            <td>
              <xsl:value-of select="name" />
            </td>
          </tr>
          <tr>
            <td>Place Name (regularised)</td>
            <td>
              <xsl:value-of select="@reg" />
            </td>
          </tr>
          <tr>
            <td>National Grid Reference</td>
            <td>
              <xsl:value-of select="@key" />
            </td>
          </tr>
          <tr>
            <td>Type of building/monument</td>
            <td>
              <xsl:value-of select="settlement/@type" />
            </td>
          </tr>
        </Table>
      </body>
    </html>
  </xsl:template>
</xsl:stylesheet> 
```

但我得到的输出是：

```
Location
Place Name  Old Warden
Place Name (regularised)    Old Warden, St Leonard
National Grid Reference TL 137 443
Type of building/monument   Parish church 
```

其余的都很好，但“位置”是不需要的。源 XML 在上面的链接中。知道如何阻止不需要的文本出现吗？或者，更好的是，告诉我哪里出错了！:)

编辑：这是输出

```
<?xml version="1.0" encoding="utf-8" ?>
Location
<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<body>
    <table>
        <tr>
            <td>Place Name</td>
            <td>Old Warden</td>
        </tr>
        <tr>
            <td>Place Name (regularised)</td>
            <td>Old Warden,  St Leonard</td>
        </tr>
        <tr>
            <td>National Grid Reference</td>
            <td>TL 137 443</td>
        </tr>
        <tr>
            <td>Type of building/monument</td>
            <td>Parish church</td>
        </tr>
    </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:08:51.713

正如 Stivel 提到的，“位置”文本确实来自 XML 中的**head**元素。

```
<div type="location">
    <head n="I">Location</head>
    <placeName reg="Old Warden,  St Leonard" key="TL 137 443"> 
```

它出现的原因是 XSTL 的内置模板，当您没有为它在 XSLT 中寻找的元素指定匹配项时，它会使用该模板。

[您可以在W3C 页面](http://www.w3.org/TR/xslt#built-in-rule)上阅读内置模板，但简而言之，如果 XSLT 找不到匹配项，它将继续处理元素的子元素（不复制元素），或者在文本或属性的情况下，输出价值。

XSLT 将首先查找文档元素的匹配项，如果您没有提供模板，它将继续查找根元素的模板，然后是其子元素，依此类推。

**在您的情况下，直到/div/placeName**之前您还没有提供模板来匹配任何内容，这意味着 XSLT 将为**div**元素使用内置模板。这有两个孩子；**头**和**地名**。您有一个模板可以用于**placeName**，但不能用于**head**，因此内置模板最终会输出**head**的文本，因为您没有告诉它任何其他内容。

解决方案是简单地添加一个模板来忽略**头部**元素

```
<xsl:template match="/div/head" /> 
```

这是完整的 XSLT

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  version="2.0">

  <xsl:output method="xhtml"
    doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" indent="yes" />

  <xsl:template match="/div/head" />

  <xsl:template match="/div/placeName">
    <html>
      <head />
      <body>
        <Table>
          <tr>
            <td>Place Name</td>
            <td>
              <xsl:value-of select="name" />
            </td>
          </tr>
          <tr>
            <td>Place Name (regularised)</td>
            <td>
              <xsl:value-of select="@reg" />
            </td>
          </tr>
          <tr>
            <td>National Grid Reference</td>
            <td>
              <xsl:value-of select="@key" />
            </td>
          </tr>
          <tr>
            <td>Type of building/monument</td>
            <td>
              <xsl:value-of select="settlement/@type" />
            </td>
          </tr>
        </Table>
      </body>
    </html>
  </xsl:template>
</xsl:stylesheet> 
```

当您使用它时，这应该会提供您需要的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:46:13.563

可能你`<head/>`可以参考

```
<head n="I">Location</head> 
```

在 xsl中删除`<head/>`并检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T14:05:41.863

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xhtml" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>
<xsl:template match="div">
<xsl:apply-templates select="placeName"/>
</xsl:template>
  <xsl:template match="placeName">
    <html>
      <head />
      <body>
        <Table>
          <tr>
            <td>Place Name</td>
            <td>
              <xsl:value-of select="name" />
            </td>
          </tr>
          <tr>
            <td>Place Name (regularised)</td>
            <td>
              <xsl:value-of select="@reg" />
            </td>
          </tr>
          <tr>
            <td>National Grid Reference</td>
            <td>
              <xsl:value-of select="@key" />
            </td>
          </tr>
          <tr>
            <td>Type of building/monument</td>
            <td>
              <xsl:value-of select="settlement/@type" />
            </td>
          </tr>
        </Table>
      </body>
    </html>
  </xsl:template> 
```

# c++ - C++; 编译期间“默认启用”的警告是什么意思？

> ID：13122636
> 
> 赞同：6
> 
> 时间：2012-10-29T13:32:06.753
> 
> 标签：c++, compiler-warnings

我的代码编译没有错误，但这意味着什么？

```
 etherate.cpp:432:11: warning: deleting array ‘unsigned char broadMAC [6]’ [enabled by default] 
```

它来自这一行，我正在删除一个无符号字符数组；

```
delete [] broadMAC; 
```

可以保持原样吗？如果不能，我该如何改进？

谢谢。

**更新**

*BroadMAC 是如何声明的？*

从之前的大约 10 行开始；

```
unsigned char broadMAC[6] = {destMAC[0], destMAC[1], destMAC[2], destMAC[3], destMAC[4], destMAC[5]}; 
```

destMAC 也是一个无符号字符数组，其中存储了值。我需要将它们复制出来，用 destMAC 做一些事情，然后恢复原始值；所以我已经声明了broadMAC，并希望在之后将其删除。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-29T13:34:34.427

`broadMAC`在自动内存中分配，如下所示：

```
unsigned char broadMAC[6]; 
```

然后你打电话

```
delete[] broadMAC; 
```

这是错误的，因为您没有将其分配给`new[]`.

在未分配 / 的内存上使用`delete`/会导致未定义的行为，并且您的编译器足够聪明，可以在这种情况下进行判断。`delete[]``new``new[]`

您不必担心释放内存，它会自动释放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:39:59.550

G++ 允许通过在命令行上指定它们来启用和禁用许多警告（例如`-Wctor-dtor-privacy`，、、`-Woverloaded-virtual`）`-W...`。某些警告已启用，无需在命令行上执行此操作，其他警告必须明确请求。

因此，一些警告是：

> “默认启用”

有些是：

> “默认禁用”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T13:35:00.100

您正在尝试释放您在堆栈中分配的数组，而不是堆。因此，当变量超出范围时，它将自行释放，您不应该/不能显式释放它。

# android - 优先考虑新活动

> ID：13122638
> 
> 赞同：3
> 
> 时间：2012-10-29T13:32:17.043
> 
> 标签：android, multithreading, android-activity

我有活动 A 需要在退出时执行操作 - 将内容保存到数据库 - 启动活动 B

由于保存可能需要一段时间，但我应该启动一个新线程以在后台运行数据库访问，而用户正忙于读取活动 B 的内容。（顺便说一句，B 不使用保存的数据）。

所以我在活动 A

```
 FinishStuff(){
 Intent ourIntent = new Intent(this, ActivityB.class);
 startActivity(ourIntent);

 handler = new Handler();
 handler.post(dbSaver);
}
 public Runnable dbSaver = new Runnable() {

 @Override
 public void run() {
     saveToDbs();
 } 
```

然而，发生的事情是立即调用活动 B 的 OnCreate()，但我的新活动应该去的屏幕空间是黑色的，直到 saveToDBs() 完成，在该阶段活动 B 被显示。有什么办法可以解决这个问题？TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T17:16:33.633

你误会`Handler`了`Thread`。

线程可以使用它`Handler`在另一个线程中运行一段代码（即更新 UI、通知进度等），而您需要的是一个新线程。

所以，你需要更换：

```
handler = new Handler();
handler.post(dbSaver); 
```

经过：

```
new Thread(dbSaver).start(); 
```

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T15:02:01.273

> 我虽然我应该启动一个新线程来让数据库访问在后台运行

正确的。但是，您并没有在上面显示的代码中启动新线程。

# java - Android Java 代码中的这种语法是什么意思？

> ID：13122640
> 
> 赞同：3
> 
> 时间：2012-10-29T13:32:18.390
> 
> 标签：java

任何人都可以向我解释以下代码吗？它[来自 Android 源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.3.7_r1/com/android/server/ConnectivityService.java?av=f)。

第一行在我看来是初始化一个整数数组，但是那些用大括号括起来的代码呢？我的意思是这些代码语法是否正确，因为大括号部分似乎很纠结？

```
 // high priority first
    mPriorityList = new int[mNetworksDefined];
    {
        int insertionPoint = mNetworksDefined-1;
        int currentLowest = 0;
        int nextLowest = 0;
        while (insertionPoint > -1) {
            for (NetworkAttributes na : mNetAttributes) {
                if (na == null) continue;
                if (na.mPriority < currentLowest) continue;
                if (na.mPriority > currentLowest) {
                    if (na.mPriority < nextLowest || nextLowest == 0) {
                        nextLowest = na.mPriority;
                    }
                    continue;
                }
                mPriorityList[insertionPoint--] = na.mType;
            }
            currentLowest = nextLowest;
            nextLowest = 0;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:36:37.377

是的，那些代码块绝对没问题。它们是可行的语法。相反，它们是有用的。

发生的情况是，代码只是转移到一个未命名的块，为它们提供一个块范围。因此，在该块内定义的任何变量都不会在外部可见。

```
int[] a = new int[10];
{
    int x = 10;
    a[0] = x;
    System.out.println(x);
}

System.out.println(x);  // Error. x not visible here. 
```

所以，那些`braces`只是创建一个`local block scope`，就是这样。他们没有什么特别的。但是，您不会在上面的代码中感受到这些块的魔力。

这种编码方式通常用于您`minimize`的范围`local variables`，这绝对是一个好主意，特别是当`variables`该块内创建的不会在其他任何地方使用时。

所以，如果不使用这些`braces`，那些变量就会在`hang`附近，等待`garbage collector`释放它们，同时享受`trip`接近尾声`current scope`，那可能会很长`method`。

# javascript - History.go(-1) 在 IE 中不起作用

> ID：13122647
> 
> 赞同：3
> 
> 时间：2012-10-29T13:32:45.550
> 
> 标签：javascript, asp.net

我有一个返回按钮，我在我的 aspx 页面中使用了以下代码

`<input type="button" runat="server" value="Back" onclick="Javascript:history.go(-1); return=false;" />`

问题是它在 Firefox 中运行良好，但是当我在 IE 中尝试它时它不起作用。有人可以分享他们的想法。

## 更新

错误地我写`return=false;`的实际代码是：

`<input type="button" runat="server" value="Back" onclick="Javascript:history.go(-1); return false;" />`仍然无法正常工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T13:35:19.310

您引用的代码不应该在任何浏览器上运行，它有一个语法错误 ( `return=false`)。以最小的变化：

```
<input type="button" runat="server" value="Back" onclick="history.go(-1); return false;" /> 
```

另请注意，您不需要（也不应该有）任何属性的任何`Javascript:`前缀。属性中`onXyz`的代码**始终**是JavaScript，实际上前缀（在那种情况下）不会触发 JavaScript，它会创建一个从未使用过的[标签](http://ecma-international.org/ecma-262/5.1/#sec-12.12)。您在需要链接的地方使用伪协议，例如元素上的属性。`onXyz`**`javascript:``href``a`**

 **旁注：我`ASP.Net`很长时间没有做过任何事情，我完全不确定拥有`runat=server`和`onclick`是否有意义`input`......如果你想要一个客户端的“后退”按钮，请删除`runat=server`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:37:38.263

使用`<a href="Javascript:history.go(-1); return false;">Back</a>` 或 `<input type="button" runat="server" value="Back" onclick="history.go(-1); return false;" />`

在你不需要任何`on...`事件之后`javascript`，你只需要它`href`。而在`return`你不需要`=`。**

# objective-c - 如何在 Xcode 4.5 中的项目中添加对 FORTRAN 代码的调用？

> ID：13122650
> 
> 赞同：10
> 
> 时间：2012-10-29T13:32:53.603
> 
> 标签：objective-c, xcode, fortran

我的公司有一堆 Fortran 代码。传统上，我们将需要的代码编译成 .dll 并在需要完成计算时调用该 .dll。我们现在正在尝试创建一个 iPad 应用程序，不幸的是，这意味着我们不能再只调用 .dll 了。

我的一位同事设法制作了一个简单的命令行工具项目，我们在其中调用 Fortran 文件在调试器中编写“Hello, World”。但是，当我尝试让它在基于视图的 iPad 应用程序上工作时，我收到一堆链接器错误，说找不到我正在使用的符号。我知道命令行工具使用 .cpp 文件来实际运行 Fortran，并且我已经看到很多关于在应用程序中调用 .cpp 文件的线程，但是我看到的所有线程都已过时，直接相互矛盾，他们的修复对我不起作用。

我的问题是，**有没有更直接的方法可以直接从 .m 文件调用 Fortran？** 如果没有，**我该怎么做才能使用有效的命令行工具并将其放入应用程序中？**

更新 1：按照评论中发布的教程，我已经能够从我的 Fortran 代码创建一个 .o 文件。我可以做一个 File-Add Files 来很容易地添加它，但现在我该如何调用它呢？

更新2：好的，宝贝步骤。我发现您可以使用终端命令从 .o 文件（“source_file.o”）创建一个 .a 静态库（我称之为“new_library”）`ar crv new_library.a source_file.o`（您可以通过`source_file2.o source_file3.o`添加尽可能多的 .o 文件 - 注意：确保使用`cd`进入 .o 文件所在的文件夹）。我很确定 Xcode 可以处理 .a 文件，但似乎仍然需要 .h 文件才能让项目中的其他文件（如视图控制器）调用 .a 文件中的内容。我知道我可以从 Xcode 本身创建一个新的 .a 文件（新项目 -> iOS -> 框架和库 -> Cocoa Touch 静态库），但是当我过去这样做时，我只是写了 normal . m 和 .h 文件，当我构建新库时，它只是将所有 .m 文件混合为 1 个 .a。当我想在另一个项目中使用那个 .a 中的代码时，我只需将 .a 和所有 .h 文件导入到新项目中，我可以调用 .a 文件中的方法，就像我已经导入了所有单独的 .m 文件。那么下一个问题是，**当我的 .a 是用终端而不是 Xcode 制作时，我还需要 .h 吗？** 如果是这样，**我将如何制作 Fortran 头文件？** 如果没有，**我如何在 .a 中调用我的 Fortran 代码？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T15:01:11.763

让我们试着总结一下：

1.  您需要一个可以生成 ARM 代码的 FORTRAN 交叉编译器。GCC 可能是一个不错的选择。但是您需要自己从源下载中构建它。

2.  编译您的 FORTRAN 代码并将其放入静态库中。此任务在 XCode 外部执行，可能从命令行执行。

3.  为您想直接从 C 调用的那些 FORTRAN 例程编写 C 头文件。您可能想查看[Fortran and C/C++ 混合编程](http://www.neurophys.wisc.edu/comp/docs/notes/not017.html)或[教程：同时使用 C/C++ 和 Fortran](http://www.yolinux.com/TUTORIALS/LinuxTutorialMixingFortranAndC.html)。这些页面解释了如何将 C 数据类型映射到 FORTRAN 数据类型，反之亦然。

4.  将 C 头文件和静态库添加到 XCode 项目。

5.  在需要的地方将 C 头文件导入到您的 Objective-C 文件 (.m) 中，并像调用 C 函数一样调用 FORTRAN 例程。

6.  使用 XCode 构建 iOS 应用程序。

# c# - 如何以编程方式在 IIS 中托管 WCF 服务？

> ID：13122652
> 
> 赞同：2
> 
> 时间：2012-10-29T13:32:55.937
> 
> 标签：c#, wcf, wcf-endpoint

我有一个 WCF 3.0 服务，它已在`web.config`我的 Web 应用程序中配置，它通过`.svc`文件托管：

```
<endpoint address="https://domain.co.uk/services/accountservice"
             binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IAccountService"
             contract="AccountServiceReference.IAccountService"
             name="BasicHttpBinding_IAccountService" /> 
```

地址值不应该是 web.config 中的纯文本，因为我们想使用我们拥有的加密算法对其进行加密，并且只将加密的值存储在那里。这怎么可能？

我在想也许我应该以编程方式在我们的 IIS 中托管 WCF 服务，以便可以在运行时通过读取`EncryptedAddress`值来设置地址，`AppSetting`然后在运行时对其进行解密。这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:40:46.803

您的问题在堆栈溢出中已经有几个答案，例如：

[如何以编程方式为 WCF 服务设置单个终结点](https://stackoverflow.com/questions/2059485/how-to-programatically-set-a-single-endpoint-for-a-wcf-service)

[如何在 IIS 环境中以编程方式注册 WCF 服务](https://stackoverflow.com/questions/11522733/how-can-i-register-a-wcf-service-programmatically-within-an-iis-environment)

# objective-c - Apple Push Notifications - Remove Badge But Not Notification Text

> ID：13122655
> 
> 赞同：1
> 
> 时间：2012-10-29T13:33:05.907
> 
> 标签：objective-c, ios, ios5, ios6, apple-push-notifications

We have a requirement in our iOS5/6 app to remove the badge number from our app icon, but leave the notification text in the notification center. Setting the badge number to 0 clears out the notification text as well.

Our potential solution is to set the badge number to -1, which seems to do exactly what we are looking for. Does anyone else have any experience with doing this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T21:12:18.940

When you open the app and set the application badge to 0, all the notifications of the notification center are cleared.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T15:53:41.160

This works as expected in iOS 5 and 6.0\. We are able to remove the badge icon, but not the notification text by setting the badge number to -1.

# python - Django：当它们已经被覆盖时不能覆盖管理模板？

> ID：13122656
> 
> 赞同：4
> 
> 时间：2012-10-29T13:33:13.707
> 
> 标签：python, django, django-templates, django-admin, django-guardian

要将一些内容添加到模型的 Django 管理视图中，我想覆盖`change_form.html`模板。根据[文档](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#overriding-admin-templates)，我需要在`change_form.html`文件夹中创建一个文件`/project-path/templates/admin/appname/modelname/`。当然，我需要确保这条路径在`TEMPLATE_DIRS`. 这样的文件可能如下所示：

```
{% extends "admin/change_form.html" %}
{% load i18n  %}

{% block after_field_sets %}
SOME CONTENT
{% endblock %} 
```

但是，我使用[django-guardian](https://github.com/lukaszb/django-guardian)来获得对象权限。这个 Django 应用程序也覆盖`change_form.html`（工作正常——相关源似乎在[这里](https://github.com/lukaszb/django-guardian/blob/master/guardian/admin.py)），但 Django 没有选择我的模板扩展文件（即上面示例中的“某些内容”没有显示）。我要覆盖的块/部分与 django-guardian 覆盖的块/部分*不同*，最终我希望添加`change_form.html`django-guardion*和*我的模板。

我在这里做错了什么？是否有可能让多个应用程序覆盖一个管理模板？

如果感兴趣，这是我的`TEMPLATE_LOADERS`设置：

```
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader'
) 
```

此外，django-guardian 是`INSTALLED_APPS`数组中的最后一个应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T14:43:04.463

一种可能的解决方案似乎是通过引用和覆盖 django-guardian 的模板（[在此处](https://github.com/lukaszb/django-guardian/blob/master/guardian/admin.py)定义）而不是 Django 的 general来显式定义继承链`change_form.html`。所以而不是使用

```
{% extends "admin/change_form.html" %} 
```

在我的自定义模板的开头，我需要使用

```
{% extends "admin/guardian/model/change_form.html" %} 
```

此外，我需要扩展我的`GuardedModelAdmin`子类模型以明确使用我自己的模板文件作为更改表单模板：

```
class MyModel(GuardedModelAdmin):
    change_form_template = 'admin/appname/mymodel/change_form.html' 
```

这可行，但它为模板和模型添加了明确的依赖关系。当然，无论如何，该模型都具有这种依赖性，但是如果还有一个仅引用默认值的解决方案，我会很感兴趣`change_form.html`-但是，我怀疑这实际上是不可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-13T06:47:46.827

如果模板的路径位于 中`TEMPLATE_DIRS`，那么您可以反转`TEMPLATE_LOADERS`.

如果您的模板在您的应用程序中，那么您需要在数组中的 django-guardian**之后添加您的应用程序。**`INSTALLED_APPS`

基本上，如果存在名称冲突，则将使用**最后**加载的模板。

# excel - Excel：条形图工具的重叠条

> ID：13122657
> 
> 赞同：1
> 
> 时间：2012-10-29T13:33:20.320
> 
> 标签：excel, graph, charts, schedule, gantt-chart

我想做一个类似于[甘特图的条形图](http://www.mrexcel.com/articles/timeline-chart-in-excel.php)（见图）

![甘特图](../Images/f983fc7b9fda820a2ceadee4c92065c2.png)

但**只显示一排，每个栏都与其他栏重叠**。我想这样做，假设我有不重叠的时期，最后的数字只有一行，有几个红色时期。

我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T15:45:22.970

您应该能够使用横向堆叠的条形图来实现这一点：

![SidwaysStackedBarChart1](../Images/924a38a6a9060efa4821dc02e0fc1793.png)

您可以调整轴的最小值和最大值以使其看起来更好 - 以及与其他一些东西相混淆。但这可能就是我会这样做的方式。祝你好运。

# php - 查询多次运行

> ID：13122659
> 
> 赞同：1
> 
> 时间：2012-10-29T13:33:28.107
> 
> 标签：php, mongodb

我正在尝试在 PHP 中运行以下代码来查询 MongoDB：

```
<?

$m = new Mongo(); // connect

$dogs = $m->dogs;
$races = $dogs->newdogs;

$js = "function() {
    return this.location == 'SHEFFIELD'
}";

$dataSet = $races->find(array('$where' => $js));

foreach ($dataSet as $r){

}

?> 
```

当我运行它并观察控制台时，我看到查询正在运行一次。

当我将 foreach 循环更改为嵌套在另一个循环中时，如下所示：

```
foreach(range(1,5) as $test){
    foreach ($dataSet as $r){

    }
} 
```

我看到查询在控制台中运行了 7 次？这是我在做的愚蠢的事情吗？范围界定问题？还是我只是误解了 MongoDB 应该如何工作？

谢谢啊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:44:12.290

发生这种情况是因为`$dataSet`它是一个[`MongoCursor`](http://www.php.net/manual/en/class.mongocursor.php)，而不是一个数组。A`MongoCursor`是查询的表示。它会“按需”变成一个数组，也就是说当你在它上面使用`foreach`的时候，`$dataSet`通过简单的查询就可以变成一个数组。

由于您在另一个循环`MongoCursor`中执行此操作，因此每次遇到`foreach`. 如果你不想要这种行为，你可以使用[`iterator_to_array`](http://php.net/manual/de/function.iterator-to-array.php)，因为 a`MongoCursor`只是一个迭代器：

```
$executed = iterator_to_array($dataSet); // Actual query execution
foreach($executed as $r) {               // Iterate the array, not the iterator
    // Hic sunt ponies
} 
```

**编辑**：请记住，`iterator_to_array`将整个结果集转换为内存中的数组。如果您有一个非常大的结果集，这可能会导致大量且不必要的内存消耗。建议坚持一次`foreach`调用，因为它一次只会将一行加载到内存中。

# java - Android 应用程序强制关闭且未显示任何错误

> ID：13122661
> 
> 赞同：6
> 
> 时间：2012-10-29T13:33:28.777
> 
> 标签：java, android

`Eclipse`当我在模拟器和手机上遇到强制关闭错误时，我正在使用 IDE 编写一个 android 应用程序。我刚刚更改了布局，`strings.xml`并且在 Eclipse 中没有显示任何错误，当我尝试在 Eclipse 模拟器或智能手机上打开应用程序时，它仍然显示“强制关闭”。这是我的布局，main.xml。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<Button
    android:id="@+id/connect"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/ButtonConnect" />

<Button
    android:id="@+id/device"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/connect"
    android:text="@string/ButtonDevice" />

<ImageView
    android:id="@+id/joystick_hulle"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/joystickhulle"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_marginBottom="30dp"
    android:layout_marginLeft="30dp"
    android:src="@drawable/joystick_bg" />

<ImageView
    android:id="@+id/joystick"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/joystick"
    android:layout_alignLeft="@+id/joystick_hulle"
    android:layout_alignTop="@+id/joystick_hulle"
    android:layout_marginLeft="17dp"
    android:layout_marginTop="17dp"
    android:src="@drawable/joystick" />

<Button
    android:id="@+id/M1P"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/device"
    android:layout_marginLeft="25dp"
    android:layout_toRightOf="@+id/device"
    android:text="@string/Pfeilhoch" />

<Button
    android:id="@+id/M2P"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M1P"
    android:layout_alignBottom="@+id/M1P"
    android:layout_marginLeft="25dp"
    android:layout_toRightOf="@+id/M1P"
    android:text="@string/Pfeilhoch" />

<Button
    android:id="@+id/M3P"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M2P"
    android:layout_alignBottom="@+id/M2P"
    android:layout_marginLeft="25dp"
    android:layout_toRightOf="@+id/M2P"
    android:text="@string/Pfeilhoch" />

<Button
    android:id="@+id/M4P"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M3P"
    android:layout_alignBottom="@+id/M3P"
    android:layout_marginLeft="25dp"
    android:layout_toRightOf="@+id/M3P"
    android:text="@string/Pfeilhoch" />

<Button
    android:id="@+id/M1N"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/M1P"
    android:layout_below="@+id/M1P"
    android:layout_marginTop="30dp"
    android:text="@string/Pfeilrunter" />

<Button
    android:id="@+id/M2N"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M1N"
    android:layout_alignBottom="@+id/M1N"
    android:layout_toLeftOf="@+id/M3P"
    android:text="@string/Pfeilrunter" />

<Button
    android:id="@+id/M5P"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/M1N"
    android:layout_marginLeft="25dp"
    android:layout_toRightOf="@+id/M4P"
    android:text="@string/Pfeilhoch" />

<Button
    android:id="@+id/M5N"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M2N"
    android:layout_alignBottom="@+id/M2N"
    android:layout_alignLeft="@+id/M5P"
    android:text="@string/Pfeilrunter" />

<Button
    android:id="@+id/M4N"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M5N"
    android:layout_alignBottom="@+id/M5N"
    android:layout_toLeftOf="@+id/M5P"
    android:text="@string/Pfeilrunter" />

<Button
    android:id="@+id/M3N"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M2N"
    android:layout_alignBottom="@+id/M2N"
    android:layout_alignLeft="@+id/M3P"
    android:text="@string/Pfeilrunter" />

<TextView
    android:id="@+id/M1T"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignRight="@+id/M1P"
    android:layout_below="@+id/M1P"
    android:text="@string/Motor1"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/M2T"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M1T"
    android:layout_alignBottom="@+id/M1T"
    android:layout_toLeftOf="@+id/M3P"
    android:text="@string/Motor2"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/M3T"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M2T"
    android:layout_alignBottom="@+id/M2T"
    android:layout_alignRight="@+id/M3P"
    android:text="@string/Motor3"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/M4T"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M3T"
    android:layout_alignBottom="@+id/M3T"
    android:layout_alignLeft="@+id/M4P"
    android:text="@string/Motor4"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/M5T"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/M4T"
    android:layout_alignBottom="@+id/M4T"
    android:layout_alignRight="@+id/M5P"
    android:text="@string/Motor5"
    android:textAppearance="?android:attr/textAppearanceMedium" />

</RelativeLayout> 
```

我希望你能帮助我。

编辑：这是logcat（只是复制了错误）：

```
10-29 13:10:20.245: E/Zygote(32): setreuid() failed. errno: 2
10-29 13:10:29.735: E/Zygote(32): setreuid() failed. errno: 17
10-29 13:10:31.146: E/BatteryService(58): usbOnlinePath not found
10-29 13:10:31.146: E/BatteryService(58): batteryVoltagePath not found
10-29 13:10:31.146: E/BatteryService(58): batteryTemperaturePath not found
10-29 13:10:31.175: E/SurfaceFlinger(58): Couldn't open /sys/power/wait_for_fb_sleep or /sys/power/wait_for_fb_wake
10-29 13:10:37.396: E/EventHub(58): could not get driver version for /dev/input/mouse0, Not a typewriter
10-29 13:10:37.396: E/EventHub(58): could not get driver version for /dev/input/mice, Not a typewriter
10-29 13:10:38.207: E/System(58): Failure starting core service
10-29 13:10:38.207: E/System(58): java.lang.SecurityException
10-29 13:10:38.207: E/System(58):   at android.os.BinderProxy.transact(Native Method)
10-29 13:10:38.207: E/System(58):   at android.os.ServiceManagerProxy.addService(ServiceManagerNative.java:146)
10-29 13:10:38.207: E/System(58):   at android.os.ServiceManager.addService(ServiceManager.java:72)
10-29 13:10:38.207: E/System(58):   at com.android.server.ServerThread.run(SystemServer.java:184)
10-29 13:10:39.256: E/SoundPool(58): error loading /system/media/audio/ui/Effect_Tick.ogg
10-29 13:10:39.266: E/SoundPool(58): error loading /system/media/audio/ui/KeypressStandard.ogg
10-29 13:10:39.266: E/SoundPool(58): error loading /system/media/audio/ui/KeypressSpacebar.ogg
10-29 13:10:39.276: E/SoundPool(58): error loading /system/media/audio/ui/KeypressDelete.ogg
10-29 13:10:39.286: E/SoundPool(58): error loading /system/media/audio/ui/KeypressReturn.ogg
10-29 13:10:41.646: E/ThrottleService(58): Could not open GPS configuration file /etc/gps.conf
10-29 13:10:42.796: E/logwrapper(143): executing /system/bin/tc failed: No such file or directory
10-29 13:10:42.936: E/logwrapper(145): executing /system/bin/tc failed: No such file or directory
10-29 13:10:42.956: E/logwrapper(147): executing /system/bin/tc failed: No such file or directory
10-29 13:10:52.650: E/HierarchicalStateMachine(58): TetherMaster - unhandledMessage: msg.what=3
10-29 13:11:10.122: E/AndroidRuntime(275): FATAL EXCEPTION: main
10-29 13:11:10.122: E/AndroidRuntime(275): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{android.androcrane.htlottakring/android.androcrane.htlottakring.Androcrane}: java.lang.ClassNotFoundException: android.androcrane.htlottakring.Androcrane in loader dalvik.system.PathClassLoader[/data/app/android.androcrane.htlottakring-2.apk]
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.os.Handler.dispatchMessage(Handler.java:99)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.os.Looper.loop(Looper.java:123)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread.main(ActivityThread.java:4627)
10-29 13:11:10.122: E/AndroidRuntime(275):  at java.lang.reflect.Method.invokeNative(Native Method)
10-29 13:11:10.122: E/AndroidRuntime(275):  at java.lang.reflect.Method.invoke(Method.java:521)
10-29 13:11:10.122: E/AndroidRuntime(275):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
10-29 13:11:10.122: E/AndroidRuntime(275):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
10-29 13:11:10.122: E/AndroidRuntime(275):  at dalvik.system.NativeStart.main(Native Method)
10-29 13:11:10.122: E/AndroidRuntime(275): Caused by: java.lang.ClassNotFoundException: android.androcrane.htlottakring.Androcrane in loader dalvik.system.PathClassLoader[/data/app/android.androcrane.htlottakring-2.apk]
10-29 13:11:10.122: E/AndroidRuntime(275):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
10-29 13:11:10.122: E/AndroidRuntime(275):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
10-29 13:11:10.122: E/AndroidRuntime(275):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
10-29 13:11:10.122: E/AndroidRuntime(275):  ... 11 more
: E/(): Device disconnected 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:49:43.917

这似乎已经发生，因为在相应的位置有一个缺失的类

这是您日志的摘录

```
 at dalvik.system.NativeStart.main(Native Method)
10-29 13:11:10.122: E/AndroidRuntime(275): Caused by: java.lang.ClassNotFoundException: android.androcrane.htlottakring.Androcrane in loader dalvik.system.PathClassLoader[/data/app/android.androcrane.htlottakring-2.apk]
10-29 13:11:10.122: E/AndroidRuntime(275):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
10-29 13:11:10.122: E/AndroidRuntime(275):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
10-29 13:11:10.122: E/AndroidRuntime(275):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
10-29 13:11:10.122: E/AndroidRuntime(275):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
10-29 13:11:10.122: E/AndroidRuntime(275):  ... 11 more 
```

所以确保这个类位于那里。避免这种情况

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-29T13:36:02.977

这可能是您的相对布局错误，有时 xml 中元素的顺序很重要并且可能导致崩溃。使用设计模式擦除您的布局并重新创建所有组件。

# javascript - 刷新数据表中的分页？

> ID：13122669
> 
> 赞同：1
> 
> 时间：2012-10-29T13:33:53.290
> 
> 标签：javascript, jquery, datatables

我遇到了一个奇怪的问题，它只出现在选定环境中的 dataTable 中。我编写了一个函数，允许用户删除一行，然后如果它是该特定页面上的最后一行，则重新加载表并将用户发送到“新”最后一页。

但是，在某些服务器上，它不能正常工作——我认为这与使用 fnClearTable 和 fnDraw 后，表格的分页仍然保留最后一个“空”页有关。

这是我现在正在使用的功能：

```
function fnDelete(elem) {

if (selected.length > 0) {
var c;
c = confirm("Are you sure you want to delete the selected Agency?");
if (c) {
    var deleteURL = urlstr.substring(0, urlstr.lastIndexOf("/") + 1) + "delete.do";
    deleteRecord(deleteURL, selected[0]);

    if ($(".tableViewer tbody tr:visible").length === 1) {
    oTable.fnClearTable();
    oTable.fnDraw();
    oTable.fnPageChange("last");

}}}} 
```

另外，这是我的删除功能。

```
function deleteRecord(deleteURL, iid){
    var didDelete = false;
    jQuery.ajax({
            type: "POST",
            url: deleteURL,
            dataType:"html",
            data:"recordID="+iid,
            async : false,
            success:function(response){
                didDelete = true;
                oTable.fnDraw(true);
                selected = [];
                selectedRecord = [];
                enableButtons(selected);
            },
            error:function (xhr, ajaxOptions, thrownError){
                <%-- is the message in a range we can handle? --%>
                if ((xhr.status >=400) && (xhr.status < 500)) {
                    alert(xhr.responseText);
                }
                else {
                    alert('<spring:message arguments="" text="Internal Server Error" code="ajax.internal.server.error"/>');
                }
            }   
        });

    return didDelete;
} 
```

同样，此问题仅在某些计算机上出现。任何人都可以帮忙吗？

另外，这是我的 DataTable 的配置：

```
oTable = $('#${tableName}_grid').dataTable({
        bDestroy: true,
        bSort: true,
        bFilter: true,
        bJQueryUI: true,
        bProcessing: true,
        bAutoWidth: true,
        bInfo: true,
        bLengthChange: true,
        iDisplayLength: ${sessionScope.displayLength},
        sPaginationType: 'full_numbers',
        bServerSide: true,
        sAjaxSource: "<c:url value='${dataUrl}'/>",
        aaSorting: [<c:forEach items="${sortInfo}" var="oneSort">    [${oneSort.columnIndex},'${oneSort.ascending ? "asc":"desc"}']</c:forEach>],
        aoColumns: [
            <c:forEach items="${columns}" var="curCol" varStatus="colLoop">
                {sName: '${curCol.fieldName}', bSortable: ${curCol.sortable}, bSearchable: false, sTitle: "<c:out value='${curCol.title}'/>", sType: '${curCol.displayType}', bVisible:${curCol.visible}, vdbType:'${curCol.vdbType}', sClass:'${curCol.displayType}'}${colLoop.last ? '' : ','}
            </c:forEach>
            ],
            aoColumnDefs:[{sClass:"color_col", aTargets:['color']}],

            fnRowCallback: function( nRow, aData, iDisplayIndex ) {
                $('#${tableName}_grid tbody tr').each( function () {
                    if ($.inArray(aData[0], selected)!=-1) {
                        $(this).addClass('row_selected');
                    }
                });
                return nRow;
            },
            fnInfoCallback: function( oSettings, iStart, iEnd, iMax, iTotal, sPre ) {

if(myPos>=iStart && myPos<=iEnd){
    //alert(myPos+" visible")
}else{
    selected = [];
    selected = [];
    selectedRecord = [];
    $('tr').removeClass('row_selected');
    enableButtons(selected);
}

},
            fnDrawCallback: function ( oSettings ) {

                $('#${tableName}_grid tbody tr').each( function () {
                    var iPos = myPos = oTable.fnGetPosition( this );
                    if (iPos!=null) {
                        var aData = oTable.fnGetData( iPos );
                        if ($.inArray(aData[0], selected)!=-1) {
                            $(this).addClass('row_selected');
                        }
                    }
                    var htxt = '';
                    $(this).find('.color').filter(function(i,tdata){
                        htxt = '';
                        htxt = '#'+($(tdata).text());
                        return true;
                     }).css("background",htxt);
                    $(this).dblclick( function(){
                        var iPos = myPos = oTable.fnGetPosition(this);
                        var aData = oTable.fnGetData(iPos);
                        var iId = aData[0];
                        selected = [];
                        selectedRecord = [];
                        selected.push(iId);
                        selectedRecord.push(aData);
                        $('tr').removeClass('row_selected');
                        $(this).addClass('row_selected');
                        enableButtons(selected);
                        <%-- in case there is no edit button or its enablement is more complex,
                        // click the button instead of assuming it will call fnEdit.
                        // Do first() because jQuery is returning the same element multiple times.--%>
                        $(".${tableName}_bttns > span.edit-doubleclick:not(.disabld)").first().click();
                    });
                    $(this).click( function () {
                    var iPos = myPos =  oTable.fnGetPosition(this);<%-- row index on_this_page --%>
                        var aData = oTable.fnGetData(iPos);
                        var iId = aData[0];
                        var is_in_array = $.inArray(iId, selected);
<%-- alert("iPos: " + iPos + "\nData: " + aData + "\niId: " + iId + "\nselected: " + selected + "\nis_in_array: " + is_in_array); --%>
                        selected = [];
                        selectedRecord = [];
                        if (is_in_array==-1) {                              
                            selected.push(iId);
                            selected.sort(function(a,b){return a-b});
                            selectedRecord.push(aData);
                            selectedRecord.sort(function(a,b){return a[0]-b[0]});
                        }
                        else {
                            selected = $.grep(selected, function(value) {
                                return value != iId;
                            });
                            selectedRecord = $.grep(selectedRecord, function(value) {
                                return value != aData;
                            });
                        }
                        if ( $(this).hasClass('row_selected') ) {
                            $(this).removeClass('row_selected');
                        }
                        else {
                            $('#${tableName}_grid tr').removeClass('row_selected');
                            $(this).addClass('row_selected');
                        }
                        enableButtons(selectedRecord);
                    });
                });
            } ,
            "sDom": '<"H"lTfr>t<"F"ip>',
            "oTableTools":{
                "aButtons":[ { 
                    "sExtends":"print", 
                    "bShowAll": true,
                    "sInfo": printmsg,
                    "sButtonClass":"ui-icon fg-button ui-button edit-print DTTT_button_print",
                    "sButtonClassHover":"ui-icon fg-button ui-button edit-print DTTT_button_print"
                } ] }
        });
        $('#${tableName}_grid_filter input').attr("maxlength", "255").attr("size", "35");

        $('#${tableName}_grid').ready(function(){

            $(".DTTT_containerc").remove();

            BuildToolBarButtons();

           var tt;
           $(".DTTT_containerc").each(function(){
                tt = $(this).find("#Print").attr("title");
                $(this).find("#Print").remove();  
                $(this).find(".DTTT_container").remove();  
                }
            );

            $(".DTTT_container > button").attr("title",tt).css("border","1px solid #9597A3").removeClass("ui-state-default");    
            $(".DTTT_containerc").append($(".DTTT_container").removeAttr("style"));
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:37:12.323

您的数据表配置为使用 ajax 加载数据。这意味着对数据的任何操作都是异步发生的。具体来说，fnDraw() 函数允许控制在新数据从服务器返回之前转到更改页面页面的语句。您应该将带您到最后一页的逻辑移动到 fnDrawCallback。我相信这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:46:40.817

以为我会写一个回复来帮助其他人展示我是如何修复它的。

@Gavin 是正确的，因为它位于错误的位置——我将有问题的函数移到了 AJAX 中的成功回调中。但是，要完全修复它，我必须“先发制人”读取正在删除的页面（使用 fn.PageChange 插件），减去 1（bc DataTables 是从零开始的）并将用户发送到那里。

希望这对任何人都有帮助！@Gavin，感谢您的帮助并引导我进入正确的方向！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-09T07:20:26.387

您可以在表格刷新后保持在同一页面上。刷新数据表后，您需要使用以下代码段来保持分页相同。只需将以下 js 代码复制粘贴到单独的文件中，然后将其与当前页面挂钩。

```
$.fn.dataTableExt.oApi.fnStandingRedraw = function(oSettings) {

   if(oSettings.oFeatures.bServerSide === false){
      var before = oSettings._iDisplayStart;
      oSettings.oApi._fnReDraw(oSettings);       
      oSettings._iDisplayStart = before;
      oSettings.oApi._fnCalculateEnd(oSettings);
   } 
    oSettings.oApi._fnDraw(oSettings);
}; 
```

现在，您可能会使用“fnDraw”来刷新数据表。所以现在，而不是那个代码。像这样改变它。

```
oTable1.fnStandingRedraw(); 
```

现在，您的 dataTable 将在刷新后保持相同的页面。

# groovy - 语法错误，插入“;” 完成声明。iReport 表达式中的多个“if” if (cond) then expr1 else expr2 endif

> ID：13122671
> 
> 赞同：0
> 
> 时间：2012-10-29T13:33:59.360
> 
> 标签：groovy, crystal-reports, jasper-reports, ireport

我必须将一些报告从 Crystal 转换为 Jasper，而 Groovy 让我很头疼。我有一个带有多个“if”的表达式：

```
if (cond) then expr1 else expr2 endif. 
```

在 iReport 这来了`(cond) ? expr1 : expr2`，但是如果我有另一个 if 条件并且我将它放在第一个条件下，我会得到错误。你能给我一些建议吗？谢谢！

要转换的表达式：

```
if not isnull({ZEM0000_T.PRUEFMERKMAL}) then
        text = {ZEM0000_T.PRUEFMERKMAL}
else
        text = ""
end if

if not isnull ({ZEM0000_T.ANWEISUNG1}) then
        text = text & Chr(13) & trim({ZEM0000_T.ANWEISUNG1})
end if

if not isnull ({ZEM0000_T.ANWEISUNG2}) then
        text = text & Chr(13) & trim({ZEM0000_T.ANWEISUNG2})
end if

if not isnull ({ZEM0000_T.ANWEISUNG3}) then
        text = text & Chr(13) & trim({ZEM0000_T.ANWEISUNG3})
end if

if not isnull ({@OT_NM_UT_2}) then
        text = text & Chr(13) & {@OT_NM_UT_2}
end if

formula = text 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:09:47.267

JasperReports 中的表达式仅限于单个表达式（即 Java/Groovy 中的单个语句）。不能给他们一个长的代码脚本来执行。Crystal Reports 中的表达式包含许多语句，因此将代码转换为 Groovy 是不够的，您还必须将其重构为一条语句。

幸运的是，当您连接字符串时，您只需使用`+`运算符来连接每个语句。所以你评论中的代码

```
text = ($F{PRUEFMERKMAL} != null) ? $F{PRUEFMERKMAL} : "" 
text = ($F{ANWEISUNG1} != null) ? text + chr(13) + trim($F{ANWEISUNG1}) : text 
```

需要看起来像这样：

```
(($F{PRUEFMERKMAL} != null) ? $F{PRUEFMERKMAL} : "") +
(($F{ANWEISUNG1} != null) ? text + chr(13) + trim($F{ANWEISUNG1}) : "") 
```

# c# - 在没有选择的网格视图上按下按钮

> ID：13122672
> 
> 赞同：0
> 
> 时间：2012-10-29T13:34:00.187
> 
> 标签：c#, gridview

我在 win 表单上有一个按钮，可以删除网格视图上的行。

```
numberSettingTable.SelectedRows[0] 
```

问题是当我按下没有行选择的按钮时，它发送空值，在 java -1 中返回它告诉没有选择行。那么我怎样才能在 c# 中实现同样的效果呢？

我试过if语句

```
numberSettingTable.SelectedRows[0] != null 
```

但它没有奏效。

以下是错误详情。

System.ArgumentOutOfRangeException 未处理 Message=Index 超出范围。必须是非负数且小于集合的大小。参数名称： index Source=mscorlib ParamName=index StackTrace： at System.Collections.ArrayList.get_Item(Int32 index) at System.Windows.Forms.DataGridViewSelectedRowCollection.get_Item(Int32 index) at VetoSmsServer.mainForm.removeEntryBt_Click(Object sender, EventArgs e ) 在 C:\WorkSpace\VetoSmsServer\VetoSmsServer\mainForm.cs：System.Windows.Forms.Control.OnClick(EventArgs e) 在 System.Windows.Forms.Button.OnClick(EventArgs e) 在 System.Windows 的第 310 行。 System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) 处 System.Windows.Forms.Control 处的 Forms.Button.OnMouseUp(MouseEventArgs 事件)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:36:40.987

改为执行此检查

```
numberSettingTable.SelectedRows != null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:40:34.300

您可以使用此代码

```
 // Get the currently selected row using the SelectedRow property.
    GridViewRow row = YourGridView.SelectedRow;
   if(row != null)
   {
     . . . .. 
   } 
```

链接完整示例：http: [//msdn.microsoft.com/fr-fr/library/system.web.ui.webcontrols.gridview.selectedrow.aspx](http://msdn.microsoft.com/fr-fr/library/system.web.ui.webcontrols.gridview.selectedrow.aspx)

2 另一种解决方案`RowCommand event`

```
void GridView_RowCommand(Object sender, GridViewCommandEventArgs e)
  {
    // If multiple buttons are used in a GridView control, use the
    // CommandName property to determine which button was clicked.
    if(e.CommandName=="Test")
    {
      // Convert the row index stored in the CommandArgument
      // property to an Integer.
      int index = Convert.ToInt32(e.CommandArgument);
    }
} 
```

链接：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:49:03.333

您需要检查`DataGridView`控件中是否选择了任何行。如果有，您可以删除第一个选定的或全部选定的。以下代码段演示了删除唯一一个选定的行。另外您应该注意不要尝试删除未提交的新行。因此，您可以使用以下行：

```
DataGridViewRow dgrvr = numberSettingTable.SelectedRows[0];
          if(!dgrvr.IsNewRow) 
```

完整的代码片段是这样的：

```
if(numberSettingTable.SelectedRows.Count>0)
{
      DataGridViewRow dgrvr = numberSettingTable.SelectedRows[0];
      if(!dgrvr.IsNewRow)
           numberSettingTable.Rows.Remove(dgrvr);   
} 
```

为了删除多个选定的行，只需遍历 SelectedRows 集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:53:25.163

numberSettingsTable.SelectedRows 永远不会为空，但是如果未选择任何行，则其 Count 属性将为 0（零）。

改为检查：

```
if(dataGridView1.SelectedRows.Count > 0)
{

} 
```

# java - Android App 谷歌电子表格表格数据发布

> ID：13122678
> 
> 赞同：1
> 
> 时间：2012-10-29T13:34:28.093
> 
> 标签：java, android, google-sheets, google-docs-api, google-spreadsheet-api

几天来，我一直在整理帖子，试图弄清楚这一点。我无法让我的 Android 表单应用程序发布到谷歌文档的电子表格，寻求帮助有人可以查看编码并告诉我是否遗漏了什么我做错了什么这是代码：

```
import java.io.IOException;
import java.io.InputStream;
import java.io.UnsupportedEncodingException;
import java.net.URL;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import android.os.AsyncTask;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;

public class SubmitForm extends AsyncTask<URL, Object, Object> implements OnClickListener{

EditText arrivalText;
EditText assignmentText;
EditText clientText;
EditText departureText;
Spinner employeeSpinner;
EditText jobDateText;
Spinner jobTypeSpinner;
EditText notesText;
Button submitButton;

List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);

public void onClick(View v) {
    // TODO Auto-generated method stub
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("https://docs.google.com/spreadsheet/ccc?key=0AsEKRuGCDAg_dE01ZXlyR2VoTHFrWUdTNUVwdnN0R0E#gid=0");

    try{
        nameValuePairs.add(new BasicNameValuePair("entry.0.single",
                employeeSpinner.getSelectedItem().toString()));
        nameValuePairs.add(new BasicNameValuePair("entry.1.single",
                jobTypeSpinner.getSelectedItem().toString()));
        nameValuePairs.add(new BasicNameValuePair("entry.2.single",
                clientText.getText().toString()));
        HttpResponse response = httpclient.execute(httppost);
        Log.d("RESPONSE", "info: ");
        HttpEntity entity = response.getEntity();
        InputStream inputstream = entity.getContent();
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        Log.d("YOUR_TAG", "An error has occurred", e);
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        Log.d("YOUR_TAG", "client protocol exception", e);
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        Log.d("YOUR_TAG", "io exception", e);
        e.printStackTrace();
    } finally {
    }
}

protected Object doInBackground(URL... params) {
    // TODO Auto-generated method stub
    return null;
}
} 
```

日志猫：

```
10-29 20:03:44.583: D/CLIPBOARD(28779): Hide Clipboard dialog at Starting input: finished by someone else... !
10-29 20:03:57.636: W/dalvikvm(28779): threadid=1: thread exiting with uncaught exception (group=0x40bef1f8)
10-29 20:03:57.646: E/AndroidRuntime(28779): FATAL EXCEPTION: main
10-29 20:03:57.646: E/AndroidRuntime(28779): java.lang.IllegalStateException: Could not find a method onClick(View) in the activity class com.matrixapps.assignmenttracker.AssignmentTracker for onClick handler on view class android.widget.Button with id 'submitButton'
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.view.View$1.onClick(View.java:3087)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.view.View.performClick(View.java:3627)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.view.View$PerformClick.run(View.java:14329)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.os.Handler.handleCallback(Handler.java:605)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.os.Handler.dispatchMessage(Handler.java:92)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.os.Looper.loop(Looper.java:137)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.app.ActivityThread.main(ActivityThread.java:4511)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at java.lang.reflect.Method.invokeNative(Native Method)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at java.lang.reflect.Method.invoke(Method.java:511)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:976)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:743)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at dalvik.system.NativeStart.main(Native Method)
10-29 20:03:57.646: E/AndroidRuntime(28779): Caused by: java.lang.NoSuchMethodException: onClick [class android.view.View]
10-29 20:03:57.646: E/AndroidRuntime(28779):    at java.lang.Class.getConstructorOrMethod(Class.java:460)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at java.lang.Class.getMethod(Class.java:915)
10-29 20:03:57.646: E/AndroidRuntime(28779):    at android.view.View$1.onClick(View.java:3080)
10-29 20:03:57.646: E/AndroidRuntime(28779):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-23T10:16:07.840

这为时已晚，但它可能会帮助尝试做类似事情的人， [这篇](http://codesmith.in/post-data-google-drive-sheet-through-mobile-app/)关于 codesmith 的文章详细介绍了您应该使用从 android 应用程序将数据发送到 Google 电子表格的过程。

# wampserver - Aestan 托盘菜单错误

> ID：13122679
> 
> 赞同：5
> 
> 时间：2012-10-29T13:34:30.320
> 
> 标签：wampserver

我在 windows xp 中安装了 wamp server 2.2e。当我启动 wamp 服务器时，它显示 windows 错误（Aestan Tray 菜单遇到问题需要关闭。对于给您带来的不便，我们深表歉意）。谁能建议如何解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-29T10:15:32.113

# 在安装 Wamp 之前！

如果已经安装，则卸载 WAMP（您可以备份文件夹**WWW**和 BIN>mysql> **data**），并首先安装 MS PACKAGES：

[Microsoft Visual C++ **2008** SP1 可再发行包](http://www.microsoft.com/en-us/download/details.aspx?id=5582)！
（或[**2010**](http://www.microsoft.com/en-in/download/details.aspx?id=8328)或[**2012**](http://www.microsoft.com/en-us/download/details.aspx?id=30679)版本.. 在某些情况下，也许**.Net Framework**也需要？））

之后，安装 WAMP！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T08:08:08.120

需要检查的几件事：

*   你安装了服务吗？托盘可能有点喜怒无常，但请查找安装服务批处理文件。这将使 apache 和 mysql 服务运行
*   你的配置OK吗？特别是，在命令行上检查 apache 的配置`httpd -t`（如果 httpd 不在您的路径中，请确保您在 apache/bin 文件夹中）
*   您是否获得了正确的版本（32 位与 64 位）？
*   你检查过你的 wamp 错误日志吗？
*   您是否安装了先决条件，例如 Microsoft VC++ 可再发行组件？

如果您仍然遇到问题，请查看官方论坛（例如这篇文章[http://forum.wampserver.com/read.php?2,53095](http://forum.wampserver.com/read.php?2,53095)）并在那里发帖寻求一些体面的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T11:20:25.993

可能是同样的问题（必须安装 Microsoft Visual C++ 2008 Redistributable Package）：

[无法启动 WAMP - Aestan 托盘菜单已停止工作](https://stackoverflow.com/questions/5631571/not-able-to-launch-wamp/6457092#6457092)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-28T10:13:53.653

尝试安装 .Net 框架最新版本。链接：[http](http://www.microsoft.com/en-us/download/details.aspx?id=21) ://www.microsoft.com/en-us/download/details.aspx?id= 21 在安装 WAMP 之前，请确保您已卸载旧版本。

# java - 数据库更新查询异常处理错误

> ID：13122681
> 
> 赞同：3
> 
> 时间：2012-10-29T13:34:37.853
> 
> 标签：java, jdbc, jdbc-odbc

```
String Query="insert into sms (Jobno, Mobilenumber, MStatus, ReceivedTime, AmountDeducted, Message, DoneTime)       values ("+jobnum +","+mobilenum+","+ smsstatus+",'"+ rxtimestamp+ "',"+ amt+",'"+smstxt+"','"+timedone1+"')"; 
```

注：通过Mysql，上述查询执行成功......

我在程序中导入了所有必需的库及其各自的接口......当我通过 java 面板/ide 执行时，它会抛出以下错误？

```
Exception in thread "main" com.mysql.jdbc.MysqlDataTruncation: Data truncation: Out of range value for column 'Mobilenumber' at row 1
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2983)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1631)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1723)
    at com.mysql.jdbc.Connection.execSQL(Connection.java:3277)
    at com.mysql.jdbc.Statement.executeUpdate(Statement.java:1402)
    at com.mysql.jdbc.Statement.executeUpdate(Statement.java:1317) 
```

请提出可能是什么问题............

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:49:09.913

来自变量 mobileNumber 的值超过了它的限制。因此，请检查您在 DB 和 java 程序中定义的数据类型，并验证您提供的要保存的 mobileNumber。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:49:17.790

尝试检查'Mobilenumber'列的类型、范围和长度，并将插入的值放入''以避免出现空格、插入的手机号码中的其他字符（例如“+”或“/”）和长手机号码的问题. 如果它是一个实数，MySQL 应该正确地将文本透明地转换为一个数字。

即生成的代码应该是：

```
String Query="insert into sms (Jobno, Mobilenumber, MStatus, ReceivedTime, AmountDeducted, Message, DoneTime)       values ('"+jobnum +"','"+mobilenum+"','"+ smsstatus+"','"+ rxtimestamp+ "','"+ amt+"','"+smstxt+"','"+timedone1+"')"; 
```

另一个提示：始终尝试使用[准备好的语句](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)来避免 SQL 注入攻击的可能性。

# android - 如何在 Listview 中实现 onClick

> ID：13122683
> 
> 赞同：0
> 
> 时间：2012-10-29T13:34:41.637
> 
> 标签：android, android-listview, onclick

我想这很简单。

当我点击它时，我想烤面包行中的文本。这是我的代码：

> 公共类 AndroidSQLite 扩展 Activity { private SQLiteAdapter mySQLiteAdapter;
> 
> ```
> @Override
> public void onCreate(Bundle savedInstanceState) {
>   super.onCreate(savedInstanceState);
>     setContentView(R.layout.main);
>     ListView listContent = (ListView)findViewById(R.id.contentlist);
>     mySQLiteAdapter = new SQLiteAdapter(this);
>     mySQLiteAdapter = new SQLiteAdapter(this);
>     mySQLiteAdapter.openToRead();
> 
>     Cursor cursor = mySQLiteAdapter.queueAll();
>     startManagingCursor(cursor);
> 
>     String[] from = new String[]{SQLiteAdapter.KEY_NOME};
>     int[] to = new int[]{R.id.text};
> 
>     SimpleCursorAdapter cursorAdapter =
>      new SimpleCursorAdapter(this, R.layout.row, cursor, from, to);
> 
>     listContent.setAdapter(cursorAdapter);
> 
>     mySQLiteAdapter.close();
> } 
> ```
> 
> }

谢谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:40:28.803

写下来

```
listContent.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> adapter, View arg1,
                    int position, long id) {

                Log.i("get ItemIDPosition",
                        "" + adapter.getItemIdAtPosition(position));
                Log.i("get ItemATPosition", "" + adapter.getItemAtPosition(position));

            }
        }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:37:46.607

您可以使用

```
listContent.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position,
                    long id) {

            }

        }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:38:02.360

像这样：

```
listContent.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position,
                long id) {

            String item = ...;

            Toast.makeText(getBaseContext(), item, Toast.LENGTH_LONG).show();

        }
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-30T05:12:38.873

试试这个代码的项目点击

```
listContent.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position,
            long id) {

        String text = <Get Your from database is here in this string>;

        Toast.makeText(getBaseContext(), text, Toast.LENGTH_LONG).show();

    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T13:39:49.513

使用 onitemclick evetn 而不是 onclick。

```
listview.setOnItemClickListener(...);

@Override
public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) 
```

arg2 是列表中的索引。

# java - Maven 构建清单信息配置

> ID：13122689
> 
> 赞同：0
> 
> 时间：2012-10-29T13:35:04.937
> 
> 标签：java, maven, manifest

我的问候！

我使用 maven 构建我的应用程序，我需要在构建信息中更改一件事。MANIFEST.mf 包含有关构建的基本信息，例如：

```
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Built-By: dev4
Build-Jdk: 1.6.0_35
Main-Class: com.*.Main 
```

我需要添加有关当前版本版本的信息，因此在清单文件中我们可以看到添加的行，例如“Revision: 1000”

有什么办法，所以我可以配置信息的属性，写入清单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:38:08.057

请参阅`Maven Archiver`更改清单文件[http://maven.apache.org/shared/maven-archiver/index.html](http://maven.apache.org/shared/maven-archiver/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:58:54.427

您可以为此使用[内部版本号 Maven 插件](http://mojo.codehaus.org/buildnumber-maven-plugin/)。

这将设置您可以在`archive`jar 插件的配置参数中使用的属性。有关配置清单的更多信息，请参阅[清单自定义](http://maven.apache.org/plugins/maven-jar-plugin/examples/manifest-customization.html)和[Maven 存档器。](http://maven.apache.org/shared/maven-archiver/index.html)

# vbscript - 如何在 Windows 中使用 vbs 写入相同的命令提示符？

> ID：13122691
> 
> 赞同：1
> 
> 时间：2012-10-29T13:35:09.513
> 
> 标签：vbscript, command-prompt

我有 vbs 脚本，它创建文件夹，制作存档并复制到该文件夹​​，上传到 ftp 等等。我希望它在每个执行步骤后将状态写入 cmd（创建文件夹后，zip ...）

以下打开 cmd.exe 并在那里写“创建文件夹”。这正是我想要的。

```
Dim objShell, strCmd

strCmd = "%comspec% /k echo creates folder"
Set objShell = CreateObject("Wscript.Shell")
objShell.Run strCmd, 1, True 
```

但是，我如何写入刚刚打开的同一个 cmd 窗口？如果我用这个

```
 strCmd = "%comspec% /k echo starting zip"    
    objShell.Run strCmd, 1, True 
```

它会打开新的 cmd 窗口，但我想将“启动 zip”写入先前打开的 cmd。我如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:58:00.213

要打印到命令提示符，请使用[wscript.echo](http://ss64.com/vb/echo.html)。

我想指出 .echo 的行为受脚本加载方式的影响。例如，如果我从命令提示符运行它，例如：`test.vbs`，则回显行显示为弹出窗口，因为默认情况下运行 wscript。但是，如果我像这样加载文件：`cscript text.vbs`所有输出都按预期进入控制台。

# jquery - 我可以在 Visual Studio 2008 中使用的最新版本的 Jquery 是什么？

> ID：13122694
> 
> 赞同：0
> 
> 时间：2012-10-29T13:35:19.413
> 
> 标签：jquery, visual-studio-2008

我是 Jquery 的新手，正在尝试在 ASP.NET 网页项目中使用它来简化 AJAX 调用。

我似乎无法让 Jquery 脚本在 Visual Studio 2008 中可靠地工作。我为 VS2008 安装了服务包 1，以及允许在 .js 文件上支持智能感知的 .vsdoc 支持的修补程序。

我从主站点 google、msdn（1.8.2 版）下载了 Jquery，所有这些文件都给我带来了问题。问题是：Visual Studio 不断用 JIT 调试器窗口提示我，说 typebuilder.exe 中存在未处理的异常。如果我调试它，它会突出显示 Jquery 文件的一部分。

我读过 typebuilder.exe 与智能感知有关，所以我删除了我的 vsdoc 文件，只保留了 jquery 文件。它没有改变任何东西。

有时我也会收到一条错误消息，指出无法识别 $，即使我的代码中有脚本引用。

```
<script src="Scripts/js/jquery-1.8.1.min.js" type="text/javascript"></script> 
```

我不能使用最新版本的 Jquery 创建项目吗？我怎样才能让这个库工作，最好使用 vsdoc 文件来支持智能感知。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:17:55.620

我会为可能遇到此问题的其他人发布我的解决方案。

我设法找到了一些关于我的问题的东西。在 CodeProject 上，发布了一些关于我遇到的同样沮丧的事情。

[http://www.codeproject.com/Articles/215666/How-to-fix-Visual-Studio-2008-Intellisense-for-JQu](http://www.codeproject.com/Articles/215666/How-to-fix-Visual-Studio-2008-Intellisense-for-JQu)

事实证明，该版本 1.4.1 是与 2008 一起使用的最后一个“测试”版本。MS CDN 上有用于更高版本的 vsdoc 文件，但它们似乎都以某种方式存在错误以与 2008 一起使用。那里概述的解决方案是让 1.6.1 工作。我跟着它，到目前为止一切看起来都很好。但是，我还不能使用 .min 版本的 1.6.1。

我想您可能可以手动修复其他文档以供以后的版本使用，它也可以工作，但我对 JS 并不精通，无法花时间在这上面。

暂时使用 1.6.1。

# java - 绘制控制流图

> ID：13122696
> 
> 赞同：4
> 
> 时间：2012-10-29T13:35:28.323
> 
> 标签：java, user-interface, compiler-construction, nodes, edges

我的任务是制作控制流图。首先，我设法将我的代码分成基本块。例如，这里的这个程序：

```
1 begin

2   int x, y, power;

3   float z;

4   input (x, y);

5   if (y<0)

6     power=-y;

7   else

8     power=y;

9   z=1;

10   while (power!=0){

11     z=z*x;

12   power=power-1;

13   }

14   if (y<0)

15     z=1/z;

16   output(z);

17 end 
```

将变成以下基本块：

区块 1

```
Line  2   int x, y, power;
Line  3   float z;
Line  4   input (x, y);
Line  5   if (y<0) 
```

区块 2

```
Line  6     power=-y; 
```

区块 3

```
Line  8     power=y; 
```

区块 4

```
Line  9   z=1; 
```

区块 5

```
Line 10   while (power!=0){ 
```

区块 6

```
Line 11     z=z*x;
Line 12   power=power-1; 
```

区块 7

```
Line 14   if (y<0) 
```

块 8

```
Line 15     z=1/z; 
```

第 9 块

```
Line 16   output(z); 
```

我通过扫描文件并使用 Pattern 和 Matcher 根据 if、while 等语句拆分程序来完成此操作。基本块是一个 ArrayList，所有这些块都保存在一个 ArrayList> 中。

接下来，我保留了哪些基本块相互连接的 HashMap。例如，块 1 将连接到块 2 和块 3，因为它是一个 if 语句（如果这是一条路，则走另一条路）。这个 HashMap 是 > 的块号，以及它所连接的块号列表。

所以，我有基本块，以及这些基本块之间的连接列表。我现在的问题是我不确定如何以图形形式显示它。之前，我使用paint() 方法并绘制圆和线来表示一个简单的控制图，其中每个块只有一个与下一个块的连接。但是，当有多个连接时，我不知道该怎么做。有什么简单的方法可以做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T07:25:57.260

对于绘制图表，我通常使用[dot](http://www.graphviz.org/)，它非常简单。

# database - 如何指定 Oracle 数字的精度/比例 JDBC 元数据？

> ID：13122697
> 
> 赞同：1
> 
> 时间：2012-10-29T13:35:28.530
> 
> 标签：database, oracle, jdbc

我需要强制结果列的精度和比例，对货币值进行自定义格式化（我假设每个 NUMBER(*,2) 都是货币值）。考虑以下查询：

```
select cast(1234.56 as NUMBER(6,2)) from dual; 
```

如有必要，它会进行预期的舍入，但结果元数据描述了一个具有未指定精度和比例的 Number 字段：

```
System.out.println( rs.getMetaData().getScale(1) ); // prints 0; 
```

我相信 JDBC 端发生了一些奇怪的事情，因为以下脚本确实按预期返回了 NUMBER(6,2)：

```
drop table temp;
create table temp as (
select cast(1234.56 as NUMBER(6,2)) x from dual
);
select * from temp; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:28:33.927

这不应该是

```
System.out.println( rs.getMetaData().getScale(1));  //For the first column
System.out.println( rs.getMetaData().getScale(2));  //For the second column 
```

等等。

你的代码

```
System.out.println( rs.getMetaData().getScale(0) ); //0th Column?? 
```

[从此](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/ResultSetMetaData.html#getPrecision%28int%29)链接引用-

> **`getPrecision`**

```
public int getPrecision(int column)
                  throws SQLException 
```

> 获取指定列的小数位数。
> 
> **参数**：**column** - 第一列为 1，第二列为 2，...
> 
> **返回**：精度
> 
> **抛出**：SQLException - 如果发生数据库访问错误

# meta-tags - 有什么方法可以消除对这么多 META 标签的需求？

> ID：13122701
> 
> 赞同：2
> 
> 时间：2012-10-29T13:35:44.347
> 
> 标签：meta-tags, bandwidth

这是`<head>`每个页面的一部分，因此用户每次加载页面时都会下载 - 其中大多数甚至不会影响浏览器：

```
<meta name="keywords" content="long list of keywords here" />
<meta name="description" content="Site's description here" />
<meta name="language" content="en_uk" />
<meta name="robots" content="nofollow" />
<meta name="application-name" content="Site name" />
<meta name="msapplication-tooltip" content="Site description" />
<meta name="msapplication-starturl" content="http://example.com/" />
<meta name="msapplication-navbutton-color" content="#004000" />
<meta name="msapplication-task" content="name=Do something;action-uri=http://example.com/page1;icon-uri=http://example.com/img/icon/action1.ico" />
<meta name="msapplication-task" content="name=Do something;action-uri=http://example.com/page2;icon-uri=http://example.com/img/icon/action2.ico" />
<meta name="msapplication-task" content="name=Do something;action-uri=http://example.com/page3;icon-uri=http://example.com/img/icon/action3.ico" />
<meta name="msapplication-task" content="name=Do something;action-uri=http://example.com/page4;icon-uri=http://example.com/img/icon/action4.ico" />
<meta name="msapplication-task" content="name=Do something;action-uri=http://example.com/page5;icon-uri=http://example.com/img/icon/action5.ico" />
<meta property="og:title" content="Site name (Again!)" />
<meta property="og:type" content="game" />
<meta property="og:url" content="http://example.com/" />
<meta property="og:image" content="http://example.com/img/ads/square3.png" />
<meta property="og:site_name" content="Site name (AGAIN!)" />
<meta property="fb:admins" content="FB UID" />
<meta property="og:description" content="Site descripion (AGAIN!)" /> 
```

正如你所看到的，甚至还有一些多余的属性，因为不同的刮板使用不同的东西。这没有任何 Google Plus1 按钮，或除 Facebook 之外的任何其他共享网站......

有没有办法收拾这个？也许我可以让它们只出现在首页上，然后有没有办法告诉任何真正想要元信息的东西可以在那里找到？

# oracle - 准备好的语句总是返回 -2 值

> ID：13122702
> 
> 赞同：1
> 
> 时间：2012-10-29T13:35:44.970
> 
> 标签：oracle, jdbc, batch-file, prepared-statement

我有一个准备好的合并语句，执行后它总是返回-2。

我的代码：

```
private StringBuilder sb = new StringBuilder();
sb.append("MERGE INTO EMP_BONUS EB USING (SELECT 1 FROM DUAL) on (EB.EMP_id = ?) WHEN MATCHED  THEN  UPDATE SET TA =?,DA=?,TOTAL=?,MOTH=?, NAME=? WHEN NOT MATCHED THEN "
        + "INSERT (EMP_ID, TA, DA, TOTAL, MOTH, NAME)VALUES(?,?,?,?,?,?) ");

public void executes(String threadName) throws Exception {
        ConnectionPro cPro = new ConnectionPro();
        Connection connE = cPro.getConection();

        threadN = threadN + "||" + threadName;

        PreparedStatement pStmt = connE.prepareStatement(sb.toString());
        try {
            count = count + 1;

            for (Employee employeeObj : employee) {

                pStmt.setInt(1, employeeObj.getEmp_id());
            pStmt.setDouble(2, employeeObj.getSalary() * .10);
            pStmt.setDouble(3, employeeObj.getSalary() * .05);
            pStmt.setDouble(4, employeeObj.getSalary()
                    + (employeeObj.getSalary() * .05)
                    + (employeeObj.getSalary() * .10));
            pStmt.setInt(5, count);
            pStmt.setString(6, threadN);
            pStmt.setInt(7, employeeObj.getEmp_id());
            pStmt.setDouble(8, employeeObj.getSalary() * .10);
            pStmt.setDouble(9, employeeObj.getSalary() * .05);
            pStmt.setDouble(10, employeeObj.getSalary()
                    + (employeeObj.getSalary() * .05)
                    + (employeeObj.getSalary() * .10));
            pStmt.setInt(11, count);
            pStmt.setString(12, threadN);    
                pStmt.addBatch();
            }

            int arr[] = pStmt.executeBatch();

            connE.commit();

            System.out.println("Size=" + arr.length);
            if (arr.length != 0) {
                for (int i = 0; i < arr.length; i++) {
                    System.out.println(i + "==" + arr[i]);
                }
            }
        } catch (Exception e) {
             connE.rollback();
            throw e;

        } finally {

            pStmt.close();
            connE.close();

        }
    } 
```

查看代码，准备好的语句总是返回-2（数组内的所有值都是-2）sql命令的值，如更新，合并等，我使用过像ojdbc6.jar，ojdbc5.jar等库

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T08:02:19.470

这不是坏的。

如果您阅读文档[http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#executeBatch%28%29](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#executeBatch%28%29)，您将看到 executeBatch 可以返回值 SUCCESS_NO_INFO。

如果您将得到的结果与 SUCCESS_NO_INFO 进行比较，您会发现它们是相同的——即 SUCCESS_NO_INFO = -2。

所以你的代码一直在工作。

# flash - NetConnection 视频结束后，移至演示文稿的第一帧

> ID：13122710
> 
> 赞同：0
> 
> 时间：2012-10-29T13:36:22.440
> 
> 标签：flash, actionscript-2, netstream, netconnection

早上好，感谢您的观看。这是 AS2，不是 AS3。

我已经使用这个演示设置好几年了，我还没有弄清楚如何让它从视频再次跳回第一帧。我通常只渲染与第一帧匹配的额外几分钟的视频，但这越来越烦人了。无论如何，这是我的设置：第一帧有停止命令和图片。图片有一个简单的 on(release){ gotoandplay(2);} 这很好用。 ![第一帧设置和代码](../Images/87e68b40e6742a502bf08ed5e1f6cba0.png) 第二帧如下所示： ![第二帧有网络连接的东西](../Images/1216315152a7cb3af3acdcd66e9490a6.png) 视频保留在文件夹中，因为它大约 200mb，并通过网络连接。

我希望演示文稿在视频完成播放后跳回第一帧，漂亮的标题幻灯片就在那里。我以前尝试过几种方法，但是我对这些东西的基本水平对我没有帮助。我可以添加一个侦听器来检测结束并允许我 gotoAndPlay(1) 吗？或者我什至可以将它复制到第 3 帧。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:49:58.533

将此代码添加到

```
ns.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);

private function netStatusHandler(evt:NetStatusEvent):void {
    if (evt.info.code == "NetStream.Play.Stop") {
        gotoAndPlay(1)
    }
} 
```

[编辑]

```
// do this instead of the code above
function myCallBack(o:Object):void{
  if (o.code == "NetStream.Play.Complete"){
    gotoAndPlay(1)
  }
}
ns.client = {onPlayStatus: myCallBack} 
```

# java - 实现 Comparable 的 Java 警告

> ID：13122718
> 
> 赞同：8
> 
> 时间：2012-10-29T13:36:41.303
> 
> 标签：java

我正在尝试在自定义对象的 ArrayList 上使用 Collections.sort，但我收到警告，我不知道为什么

```
Warning: Type safety: Unchecked invocation 
sort(ArrayList<CharProfile>) of the generic method sort(List<T>) 
of type Collections 
```

使用此代码：

```
ArrayList<CharProfile> charOccurrences = new ArrayList<CharProfile>();

...

Collections.sort(charOccurrences); 
```

这是我的方法：

```
public class CharProfile implements Comparable {

...

@Override
public int compareTo(Object o) {

        if (this.probability == ((CharProfile)o).getProbability()) {
            return 0;
        }
        else if (this.probability > ((CharProfile)o).getProbability()) {
            return 1;
        }
        else {
            return -1;
        }
 }
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-29T13:39:08.120

Comparable 应该使用类型安全来实现，这里是`<CharProfile>`.

```
public class CharProfile implements Comparable<CharProfile>{
       @Override
       public int compareTo(CharProfile cp) {
       ...
       }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:38:34.653

您正在使用泛型，因此请使用您传递给方法的类型`CharProfile`而不是`Object`.

我还建议如图所示重新排列比较，以防概率是双倍的。

```
@Override
public int compareTo(CharProfile o) {

        if (this.probability < o.getProbability()) {
            return -1;
        }
        else if (this.probability > o.getProbability()) {
            return 1;
        }
        else {
            return 0;
        }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-29T13:53:54.270

注意到已经回答了，但无论如何这是我的输入:)

```
import java.util.ArrayList;
import java.util.List;
import java.util.Collections;

public class CharProfile implements Comparable <CharProfile>{
  public void doStuff(){
    List<CharProfile> charOccurrences = new ArrayList<CharProfile>();
    Collections.sort(charOccurrences);
  }
  @Override
  public int compareTo(CharProfile o) {
    return -1;
  }
} 
```

# c++ - pthread_cond_broadcast() 会导致其他函数调用失败吗？

> ID：13122721
> 
> 赞同：0
> 
> 时间：2012-10-29T13:36:56.920
> 
> 标签：c++, c, pthreads, system-calls

[这个问题是对这个问题](https://stackoverflow.com/questions/12730477/close-is-not-closing-socket-properly)的跟进。总结是——我有一个服务器调用 close() 来完成连接，但似乎关闭序列从未发生过。客户端继续等待更多数据。close() 在服务器中返回 0。即使正确实现了条件队列，将我的线程安全队列从条件等待切换到信号量也解决了这个问题。我正在发布我的代码，看看是否有人对我有任何启发。

基于条件的队列：

```
 TASK *head;
  pthread_mutex_t mutex;
  pthread_cond_t cond;

  void init( ) {
    head = NULL;
    pthread_mutex_init(&mutex, NULL);
    pthread_cond_init(&cond, NULL);
  }

  TASK *get( ) {
    pthread_mutex_lock( &mutex );
    while(!head)
      pthread_cond_wait(&cond, &mutex);
    TASK *res = head;
    head = head->next;
    pthread_mutex_unlock( &mutex );
    return res;
  }

  void add( TASK *t ) {
    pthread_mutex_lock( &mutex );
    t->next = head;
    head = t;
    pthread_cond_broadcast( &cond );
    pthread_mutex_unlock( &mutex );
  } 
```

我确实意识到这是一个 LIFO 队列，下一个是 FIFO，但我只包含了有趣的位，因此它既快速又易于阅读。

基于信号量的队列：

```
 TASK *buf;
  TASK *next_reader;
  TASK *next_writer;
  TASK *endp;
  pthread_mutex_t writer_mutex;
  pthread_mutex_t reader_mutex;
  sem_t writer_sem;
  sem_t reader_sem;

  void init( int num_tasks ) {
    buf = calloc(sizeof(TASK), num_tasks);
    next_reader = buf;
    next_writer = buf;
    endp = buf + num_tasks;
    sem_init(&writer_sem, 0, num_tasks);
    sem_init(&reader_sem, 0, 0);
    pthread_mutex_init(&writer_mutex, NULL);
    pthread_mutex_init(&reader_mutex, NULL);
  }

  TASK *get( ) {
    TASK *res = NULL;
    sem_wait(&reader_sem);
    pthread_mutex_lock(&reader_mutex);
    res = next_reader;
    next_reader++;
    if(next_reader == endp)
      next_reader = buf;
    pthread_mutex_unlock(&reader_mutex);
    sem_post(&writer_sem);
    return res;
  }

  void add( TASK *t ) {
    sem_wait(&writer_sem);
    pthread_mutex_lock(&writer_mutex);
    *next_writer = *item;
    next_writer++;
    if(next_writer == endp)
      next_writer = buf;
    pthread_mutex_unlock(&writer_mutex);
    sem_post(&reader_sem);
  } 
```

我一生都看不到从条件队列到信号量队列的更改将如何解决我发布的上一个问题，除非如果线程正在关闭套接字并且在关闭期间调用 pthread_cond_broadcast 会发生一些时髦的事情。我假设一个操作系统错误，因为我找不到任何谴责我正在做的事情的文档。没有从信号处理程序调用队列操作。这是我的发行版：

Linux版本：2.6.21.7-2.fc8xen

Centos 版本：5.4（最终版）

谢谢

编辑----我刚刚添加了我正在做的初始化。在实际代码中，这些都是在模板类中实现的。我刚刚包括了相关部分。

# mercurial - mercurial：找出文件来自哪个版本

> ID：13122723
> 
> 赞同：0
> 
> 时间：2012-10-29T13:36:59.630
> 
> 标签：mercurial

给定一个来自某个版本的存储库的文件，并且可能已经被修改，是否有一种好方法可以识别它（最有可能）来自的版本？我希望，将其与所有文件的版本（或足够多的版本）进行比较并选择差异最小的版本。

我的用例：多年来，我编写并设置了各种仍在使用的乳胶样式。很多时候没有正式的“发布”，也没有版本号，有时我忘记更新版本号。我现在经常收到关于这个或那个文件的问题。我正在使用 mercurial 来跟踪样式的历史（其中一些是追溯性的），并且可以方便地快速找到脚本在历史中的位置，这样我就可以判断我是否正在处理我已经修复的问题。

我对如何将文件与回购历史相匹配感兴趣。前瞻性的解决方案很明确：始终使用版本号来避免问题。正如对相关问题的回答所暗示的那样，KeywordExtension 可以自动执行版本号[。](https://stackoverflow.com/a/12486188/699305)由于不推荐使用它，我也欢迎提出“更好”方法的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T08:31:31.760

1.  除了有问题的文件的校验和之外，您不能使用任何东西，它是历史修订
2.  Mercurial 模板中没有任何与校验和相关的关键字
3.  您可以使用 [alias] 部分向 Mercurial 添加新命令（甚至在别名定义中也允许使用 shell 命令）

以上得出的结论是至少有两种解决方案

*   您可以为 Mercurial 编写扩展程序，它添加和实现用于校验和的模板关键字、计算外部文件的校验和、获取文件 ( `hg log FILENAME --template "{md5(FILENAME)}\n"`) 的所有修订版的校验和并尝试查找命中
*   您将别名添加到 Mercurial 以进行校验和，`log FILENAME`将为您提供文件的所有修订， md5 -r REV FILENAME 再次生成基于 md5 的哈希：

`hg log FILENAME --template "{rev}\n" | xargs $(...)`

# java - 有没有办法知道两个 bean 之间的哪些属性不同？

> ID：13122724
> 
> 赞同：4
> 
> 时间：2012-10-29T13:37:00.257
> 
> 标签：java, javabeans

我想以类似于[Hibernate Envers](http://www.jboss.org/envers/)所做的方式保留对我的 bean 所做的更改（但我不能使用 Envers，因为我没有连接到 JDBC 后端）。

因此，为此，我想知道在给定 bean 类的两个实例之间，哪些属性具有不同的值。

更清楚地说，当给定 bean A 和 B 时，我希望有一个方法 ... 说 ... `diff(A, B)`，它将向我输出一个列表（或映射），将属性链接到它们的旧/新值。

就像是

```
<BeanClass> Collection<Field, Entry<Object, Object> diff(BeanClass a, BeanClass b) 
```

在 Java 世界中是否有一个库可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T15:27:55.633

好吧，解决方案是使用[java-object-diff](https://github.com/SQiShER/java-object-diff/)，它提供了对象之间差异的可访问树。结果，我们最终成功地使用了该库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:55:05.323

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:50:06.043

您可以使用 Reflection + [Apache Commons BeanUtils](https://commons.apache.org/proper/commons-beanutils/javadocs/v1.8.3/apidocs/org/apache/commons/beanutils/package-summary.html)。如果您想做深度差异，递归部分将是棘手的部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:50:12.563

编辑：当然有很多与反射有关的工作（如其他人所写），这是您应该开始的地方。

顺便说一句，我刚刚找到了一个应该做你正在寻找的项目，只需从存储库中签出主干：

[https://code.google.com/p/beandiff/source/checkout](https://code.google.com/p/beandiff/source/checkout)

希望有帮助

* * *

尝试查看 Apache [BeanComparator](http://commons.apache.org/beanutils/commons-beanutils-1.7.0/docs/bean-collections/org/apache/commons/beanutils/BeanComparator.html)；

> 此比较器通过指定的 bean 属性比较两个 bean。也可以基于嵌套的、索引的、组合的、映射的 bean 属性来比较 bean。请参阅 PropertyUtilsBean 文档以了解所有可能的属性名称。

```
compare(java.lang.Object o1, java.lang.Object o2)
          Compare two JavaBeans by their shared property. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T13:55:59.497

像这样的东西：

```
public <T> Map<Field, Entry<Object, Object>> diff(T a, T b){
    //... initialize the map
    for (Method m : a.getClass().getMethods()){
        if(m.getName().startsWith("get")){
            Object obj1 = m.invoke(a, null);
            Object obj2 = m.invoke(b, null);
            if(!obj1.equals(obj2)){
                //converts getName to name, for example
                String fieldName = m.getName()...; 
                map.put(a.getClass().getField(fieldName), new Entry(obj1, obj2));
            }
        }
    }
} 
```

考虑到您遵循 Java Beans 约定。

# gawk - AWK：从文件中提取列：行具有可变列

> ID：13122727
> 
> 赞同：1
> 
> 时间：2012-10-29T13:37:07.213
> 
> 标签：gawk, awk

我有一个以下格式的文本文件。每行都有可变数量的列。

文件：

```
gi|269201691|ref|YP_003280960.1| chromosomal replication initiation protein                                                            gi|57651109|ref|YP_184912.1| chromosomal replication initiation protein                                                                   %           1        0.0           2296      100.0
gi|269201692|ref|YP_003280961.1| DNA polymerase III subunit beta                                                                       gi|57651110|ref|YP_184913.1| DNA polymerase III subunit beta                                                                              %           1        0.0           1964      100.0 
```

生成的文件应如下所示：

```
gi|269201691|ref|YP_003280960.1| gi|57651109|ref|YP_184912.1| % 1        0.0           2296      100.0
gi|269201694|ref|YP_003280963.1| gi|57651112|ref|YP_184915.1| % 1        0.0           1767      100.0 
```

下面的代码有助于在每行中查找模式为“ref”的列。

```
awk '{for (i=1;i<=NF;i++) if ($i ~ /ref/) print $i }' 
```

关于如何做同样的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:46:05.610

我假设您的换行符在您的帖子中被破坏了，并且您的输入文件实际上每行只有一个条目。在这种情况下，我认为这可以满足您的要求：

```
awk -F '[|%]' '{printf("%s|%d|%s|%s|",$1,$2,$3,$4);if($6)printf(" %%%s",$6);printf("\n")}' 
```

编辑：好的，鉴于新的行号，你想要的可能是这样的：

```
awk -F '[|%]' '{printf("gi|%d|ref|%s|gi|%d|ref|%s| %%%s\n",$2,$4,$6,$8,$10)}' 
```

对于您的示例，这将为我生成以下输出

```
gi|269201691|ref|YP_003280960.1|gi|57651109|ref|YP_184912.1| % 1 0.0 2296 100.0
gi|269201692|ref|YP_003280961.1|gi|57651110|ref|YP_184913.1| % 1 0.0 1964 100.0 
```

这可以通过手动将字段分隔符设置为 | 或者 ％。因此，描述中的可变单词数不再是问题，我们可以直接索引我们想要的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:41:58.513

This might work for you (GNU sed):

```
sed 's/\(.*|.*|.*|.*|\)\(.*\)\(\S\+|.*|.*|.*|\)\2%/\1\3%/' file 
```

If the input file has multiline records:

```
sed 'N;s/\n//;s/\(.*|.*|.*|.*|\)\(.*\)\(\S\+|.*|.*|.*|\)\2%/\1\3%/' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T22:10:06.557

这是一种使用方法`GNU awk`：

```
awk 'BEGIN { OFS=FS="|" } { for (i=1; i<=NF; i++) if ($i ~ / gi$/) $i = " gi"; if (i = NF) sub(/.*%/," %",$i) }1' file.txt 
```

这是一种使用方法`GNU sed`：

```
sed 's/|[^|]* gi|/| gi|/; s/\(.*|\).*\(%.*\)/\1 \2/' file.txt 
```

结果：

```
gi|269201691|ref|YP_003280960.1| gi|57651109|ref|YP_184912.1| % 1 0.0 2296 100.0
gi|269201692|ref|YP_003280961.1| gi|57651110|ref|YP_184913.1| % 1 0.0 1964 100.0 
```

# c# - Windows 8 和触发 Windows 虚拟键盘的显示

> ID：13122728
> 
> 赞同：0
> 
> 时间：2012-10-29T13:37:08.967
> 
> 标签：c#, .net, winforms, c#-4.0

[这更像是对ForbesLindesay](https://stackoverflow.com/users/272958/forbeslindesay)去年提出的关于通过 .NET 代码显示或抑制 Windows 虚拟键盘的以下问题的后续行动：

[如何触发或抑制 Windows 虚拟键盘的显示](https://stackoverflow.com/questions/6871347/how-do-i-trigger-or-supress-the-display-of-windows-virtual-keyboard)

在这种情况下，我的应用程序是一个 WinForms 应用程序，它*大量*使用[Microsoft Ink](http://msdn.microsoft.com/en-us/library/ms828520.aspx)类并在 Windows XP、Vista、7 上运行，现在我们正在确保它与 8 一起正常工作。

我们注意到，在 Windows 8 中，当用户想要在我们的应用程序中使用时，虚拟键盘不会弹出，而它适用于正常的 Windows 操作。

那么 -**现在 Windows 8 已经推出**，有没有办法在 .NET 托管代码（或[PInvoke](http://www.pinvoke.net/)）中触发 Windows 虚拟键盘？

如果你说仍然没有办法做到这一点，你能提供一个参考来支持你的主张吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:11:16.320

我认为没有办法在 .NET 托管代码中触发 Windows 虚拟键盘。你可以看到微软本身并没有在它的桌面应用程序上触发键盘，比如文件浏览器：尝试创建文件夹，你应该填写名称，但没有显示键盘。

# php - s5 flex 菜单在 k2 画廊页面（joomla）上不起作用

> ID：13122733
> 
> 赞同：1
> 
> 时间：2012-10-29T13:37:45.090
> 
> 标签：php, joomla, joomla-k2

菜单下拉菜单在图库页面上不起作用。请查看以下两个链接，例如：- [http://www.midvaleapartments.com/](http://www.midvaleapartments.com/) http://www.midvaleapartments.com/gallery

该菜单似乎在除画廊页面之外的所有页面上都可以正常工作。可能是一些 js 有冲突。我试过 jQuery.noConflict(); 但它不起作用。任何人都可以提供上述问题的解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T16:09:30.440

您还可以通过将使用它的扩展的 jQuery 包含代码替换为以下内容来确保仅包含一次 jQuery。

```
if(!JFactory::getApplication()->get('jquery')){
   JFactory::getApplication()->set('jquery',true);
   $document =& JFactory::getDocument();
   $document->addScript(JURI::root() . "path/to/jquery/file/jquery-1.8.2.js");
} 
```

基本上，此代码搜索正在包含的现有 jquery 库，如果还没有，它包含一个。您必须根据文件的位置更改路径。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:51:26.493

1.  你已经包含了 jQuery 库 3 次

2.  jQuery 库与 mootools 冲突

排除旧的 jQuery 版本库并在包含后添加 jQuery.noConflict()。

要使用 jQuery 的登录`$`代码，请使用：

```
// Runs after document is loaded
jQuery(function($) {
    // Your code here
}); 
```

或者

```
(function($) {
    // Your code here
})(jQuery); 
```

# windows - 适用于多个平台和操作系统的 Windows INF 文件

> ID：13122735
> 
> 赞同：1
> 
> 时间：2012-10-29T13:37:46.917
> 
> 标签：windows, inf

我正在尝试创建一个 Windows INF 文件来安装可与 32 位或 64 位 Windows 7 或 Windows 8 一起使用的驱动程序。我有 4 个不同的 .SYS 文件，它们都具有相同的名称，每种情况一个。在我的发行版中，我创建了 4 个目录，每个目录都包含一个驱动程序文件。

在 INF 文件的 SourceDisksNames 部分中，我尝试使用装饰 .x86 和 .amd64，这些将在 32 位和 64 位 Windows 上的安装之间正确选择。

```
; 32-bit Windows
[SourceDisksNames.x86]
1=%DiskDescription%,,,"w7x86"

; 64-bit Windows
[SourceDisksNames.amd64]
1=%DiskDescription%,,,"w7x64" 
```

这工作正常，除了我还需要在 Windows 7 和 8 之间进行选择。阅读 MSDN 它说我可以使用补充装饰 .6.1（Windows 7）和 .6.2 用于 Windows 8。所以我最终得到了一个像这样的部分名称

```
; 64-bit Windows 7 
[SourceDisksNames.amd64.6.1]

; 64-bit Windows 8
[SourceDisksNames.amd64.6.2] 
```

但是现在无法完成安装。显示“无法添加请求的功能。错误是：在 INF 中找不到所需的行”对话框。

谁能看到我做错了什么。指向一个工作示例的指针会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:16:34.943

SourceDisksNames 和 SourceDisksFiles 部分中不允许使用 OS 版本修饰符。[有关详细信息，请参阅http://msdn.microsoft.com/en-us/library/windows/hardware/ff547478%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff547478%28v=vs.85%29.aspx)上的备注。您应该在制造商和模型部分使用 vesion 装饰。

# javascript - 无法仅将我的跨度集中在 Firefox 中

> ID：13122736
> 
> 赞同：0
> 
> 时间：2012-10-29T13:37:51.257
> 
> 标签：javascript, jquery, css

我创建了一个带有一些 Jquery 效果的菜单，它在除 Firefox 之外的所有浏览器上运行良好（我的最后一个菜单项没有居中），我不知道为什么会发生这种情况......它在 Firefox 中看起来像这样：[http：/ /robertpeic.com/future%20net/problem/problem.png](http://robertpeic.com/future%20net/problem/problem.png)                          在其他浏览器中呈现良好：[http](http://robertpeic.com/future%20net/problem/other.png)

://robertpeic.com/future%20net/problem/other.png为了解决这个问题，我尝试过：添加固定宽度和高度到我的最后一个锚标签（***失败***），尝试添加边距而不是填充（***失败***），尝试通过 CSS 使用 Firefox hack，但它破坏了我的 CSS 验证（***失败***），尝试增加一点填充，看起来不错Firefox，但在所有其他浏览器中都中断了（***失败***）。

我最后的手段是使用浏览器嗅探，但我**真的不想**在这么小的问题上使用它。
有人可以帮我解决这个问题吗？

[**小提琴示例在这里**](http://jsfiddle.net/QKaGK/)

CSS 代码：

```
.menu{
position:relative;
display:block;
margin:0px auto;
height:37px;
background:url(http://robertpeic.com/future%20net/template%20images/menu-bg.png);
width:959px;

}

.menu ul{
list-style-type:none;
display:block;
width:990px;
margin:0 auto;
}

.menu ul li a{
float:left;
color:#4e4e4e;
font-family:"Palatino Linotype", "Book Antiqua", Palatino, serif;
display:table-cell;
position:relative;
height:37px;
text-decoration:none;
background:url(http://robertpeic.com/future%20net/template%20images/main-menu-divider.png) 100% 0%;
background-repeat:no-repeat;
z-index:100;
padding:0px 18px 0px 18px;
line-height:37px;
text-align:left;
margin-left:2px;
}

.menu ul li a:hover{
float:left;
color:#780C71;
font-family:"Palatino Linotype", "Book Antiqua", Palatino, serif;
display:table-cell;
position:relative;
height:37px;
text-decoration:none;
background:url(http://robertpeic.com/future%20net/template%20images/main-menu-divider.png) 100% 0%;
background-repeat:no-repeat;
z-index:100;
padding:0px 18px 0px 18px;
line-height:38px;
text-align:center;
margin-left:2px;
}

.mainhover{
background-color:#BFC0C1;
z-index:50;
position:absolute;
border-radius:5px;
moz-border-radius:5px;
border-top: 1px solid #A09F9F;
border-left: 1px solid #B5B3B3;
border-right: 1px solid #EFEFEF;
border-bottom: 1px solid #EDEDED;
}

.remove{
background-color:#C4C3C2;
z-index:50;
position:absolute;
border-radius:5px;
moz-border-radius:5px;
border-top: 1px solid #A09F9F;
border-left: 1px solid #B5B3B3;
border-right: 1px solid #EFEFEF;
border-bottom: 1px solid #EDEDED;
}

.menu ul li a.contact{
background-image:none;
padding:0px 30px 0px 23px;
text-align:center;
margin-left:6px;
} 
```

jQuery代码：

```
 $(document).ready(function(){
      var manageWidth = 14;
      var manageHeight = 10;
      var manageMargin = 6;

  $('.menu ul li a').hover(function(){

  var getHeight = $(this).outerHeight(true);
  var getWidth = $(this).outerWidth(true);
  $('<span class="mainhover" />').insertAfter($(this));
  $('.menu ul li .mainhover').css({'width':getWidth-manageWidth,'height':getHeight-manageHeight,'margin-top':'4px','margin-left':-getWidth+manageMargin ,'opacity':'0'});
  $('.menu ul li .mainhover').stop().animate({opacity:1},700);
  //alert(getWidth);
  },function(){
  $('.menu ul li a').next().removeClass('mainhover').addClass('remove').stop().animate({opacity:0},700,function(){
  $(this).remove();
});

});

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:43:14.973

我建议你不要使用 span，使用 div 元素来修复它。或者你可以尝试添加'text-align:center;' 给父母，'text-align:left'给孩子。祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:46:30.360

我认为问题是因为 .menu ul 的宽度为 990px​​，只需使用 100%；

# magento - Magento 自定义选项 - 保存新值不起作用

> ID：13122738
> 
> 赞同：3
> 
> 时间：2012-10-29T13:38:02.363
> 
> 标签：magento, options, product, save

我在 Magento 中使用自定义选项时遇到了问题。对于各种产品，我使用具有 100 多个值的自定义选项（下拉菜单）。

问题是在某个时刻，选项值将不再保存。单击保存按钮时，会显示成功确认，但新添加的值已消失。

我在保存选项时已经观察到 ajax 发布请求，发现新值列在发布参数中，所以问题显然不在 javascript 中。

我正在尝试定位问题，但我不知道自定义选项的实际保存发生在哪里。有谁知道文件名/位置/功能？

或者更好的是，有人知道这里出了什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T15:02:38.833

我会毫不犹豫地猜测你现在有这么多自定义选项，以至于被发布的表单已经超过了你的 php.ini 中允许的 input_vars 的数量

把它放在你的 php.ini

; [http://www.php.net/manual/en/info.configuration.php#ini.max-input-vars](http://www.php.net/manual/en/info.configuration.php#ini.max-input-vars) max_input_vars = 2000

重新启动 Apache 并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T15:32:34.433

在您的 eav_attributes 中，您的自定义属性是 int 对吗？

将 int 更改为 text，它应该可以工作。

Gl 关于那个

# php - 在 Wordpress 中编辑现有的 WooCommerce 元框

> ID：13122742
> 
> 赞同：2
> 
> 时间：2012-10-29T13:38:13.477
> 
> 标签：php, wordpress, woocommerce

我正在尝试编辑由 Wordpress 中的插件（WooCommerce）添加的现有元框，但我不知道该怎么做。

使用这一行添加元框：

```
add_meta_box( 'woocommerce-product-data', __('Product Data', 'woocommerce'), 'woocommerce_product_data_box', 'product', 'normal', 'high' ); 
```

...所以将 HTML 输出到屏幕的函数是`woocommerce_product_data_box()`. 有什么方法可以在不丢失所有内容的情况下编辑此功能？我只想删除它的一部分而不编辑原始功能。

我可以用过滤器以某种方式完成这个吗？还是有其他想法？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T01:26:06.950

您可以在`writepanel-product_data.php`文件中找到为其写入元框的实际函数。在第 24 行：

```
function woocommerce_product_data_box() 
```

这列出了产品数据中的所有内容。您可以使用 WooCommerce API 添加文本框或下拉菜单。找到你想添加或删除的地方，然后——

对于文本字段 -

```
woocommerce_wp_text_input( array( 'id' => 'YOURCUSTOMID', 'class' => '', 'label' => __('THELABELOFTHEFIELD', 'woocommerce') ) ); 
```

对于下拉 -

```
woocommerce_wp_select( array( 'id' => 'YOURCUSTOMID', 'label' => __('THELABELOFTHEFIELD', 'woocommerce'), 'options' => array(
            'OPTION1' => __('Option 1', 'woocommerce'),
            'OPTION2' => __('Option 2', 'woocommerce'),
            'OPTION3' => __('Option 3', 'woocommerce'),
            'OPTION4' => __('Option 4', 'woocommerce'),
            'OPTION5' => __('Option 5', 'woocommerce')
            ) ) ); 
```

因此，您为输入提供一个 ID **YOURCUSTOMID**，然后将其标记为您希望管理员在填写字段**THELABELOFTHEFIELD**时看到的任何内容。

与 Wordpress 帖子/页面中的自定义元框相同，但您仍然必须保存它。`woocommerce_process_product_meta()`在第 600 行附近找到该函数。上面的注释将告诉您它正在保存元框数据。然后，插入一行代码来保存您刚刚收集的任何自定义 ID -

```
 update_post_meta( $post_id, 'YOURCUSTOMID', stripslashes( $_POST['YOURCUSTOMID'] ) ); 
```

并为您的自定义 ID 更改它。只要确保在`global`声明 s 之后将该行代码放在任何位置即可。

当然，对于删除字段，您只需注释掉您不想在这两个函数中收集的字段。

希望有帮助。

# c# - Web 服务应该有权读取另一台服务器上的文件但不能？

> ID：13122744
> 
> 赞同：0
> 
> 时间：2012-10-29T13:38:37.133
> 
> 标签：c#, windows, web-services

我在 c# 和 .Net framework 4.0 中开发了一个 Web 服务，并将其发布到服务器“A”。此 Web 服务必须读取托管在服务器“B”上的 dbf 表。但我收到以下错误：

```
System.Data.Odbc.OdbcException: ERROR [42S02] [Microsoft] [ODBC Visual FoxPro Driver] File 'cctedia.dbf' does not exist.
    at ws_saldomatico_fpro.DetalleCtaCte (String str_rut) in c: \ Inetpub \ wwwroot \ WS_Saldomatico \ App_Code \ ws_saldomatico_fpro.cs: line 293 
```

文件路径正确。执行的另一项测试是在发布 Web 服务的同一台服务器上托管 dbf 文件，这工作正常。两台服务器都运行 Windows Server 2003。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:43:31.713

应该是权限问题。您必须授予正在运行 WCF 服务的用户访问文件的适当权限。该用户是 IIS 中定义的应用程序池用户。

# macos - 使用 mac 时文件不会在 PGRFileManager 中上传

> ID：13122746
> 
> 赞同：2
> 
> 时间：2012-10-29T13:38:46.057
> 
> 标签：macos, file-upload, ckeditor

嗨，我们在 ckeditor 上使用 PGRFileManager 已经有一段时间了，但刚刚发现当使用 mac 用户无法上传文件时，有人知道可能是什么原因吗？

用户可以让文件浏览器出现并选择一个文件，但是当他们单击绿色箭头上传文件时，文件就会消失。

有没有人知道这个或如何解决它。我正在考虑尝试使用 kc finder 之类的东西，但由于用户习惯了 pgr 文件管理器，我认为我应该给它一个 bash 来修复它。

我已经阅读并使用会话变量来设置运行良好的位置。这是一个绝对的位置，所以没关系。（解决方案之一是确保是这种情况）

有没有人有任何进一步的想法？谢谢理查德

# android - 将 zxing 导入现有项目

> ID：13122747
> 
> 赞同：1
> 
> 时间：2012-10-29T13:38:49.550
> 
> 标签：android

我试图将 ZXing 导入到我目前正在开发的 Android 应用程序中，但每当我尝试启动该活动时，它就会崩溃。

```
 public void bcreader(View view)
{
    Intent intent = new Intent("com.google.zxing.client.android.SCAN");
    intent.putExtra("SCAN_MODE", "QR_CODE_MODE");
    startActivityForResult(intent, 0);
}

public void onActivityResult(int requestCode, int resultCode, Intent intent)
{
       if (requestCode == 0) 
       {
          if (resultCode == RESULT_OK) 
          {
             String contents = intent.getStringExtra("SCAN_RESULT");
             String format = intent.getStringExtra("SCAN_RESULT_FORMAT");
             // Handle successful scan
          } else if (resultCode == RESULT_CANCELED) 
          {
             // Handle cancel
          }
       }
} 
```

左边是我的 MainActivity 和 ZXing 源。我按照[本](http://damianflannery.wordpress.com/2011/06/13/integrate-zxing-barcode-scanner-into-your-android-app-natively-using-eclipse/)教程进行操作，但无济于事。我确保所有文件都已导入，并且 com.google.zxing... 设置为库等。我还确保 manifest.xml 具有适当的权限。

谁能告诉我我做错了什么？

错误日志：
10-30 00:26:06.919: D/AndroidRuntime(4194): 关闭 VM 10-30 00:26:06.919: W/dalvikvm(4194): threadid=1: 线程以未捕获的异常退出 (group=0x40a261f8) 10 -30 00:26:06.919: E/AndroidRuntime(4194): 致命异常: main 10-30 00:26:06.919: E/AndroidRuntime(4194): java.lang.RuntimeException: 无法实例化活动 ComponentInfo{com.google .zxing.client.android/com.google.zxing.client.android.CaptureActivity}：java.lang.ClassNotFoundException：com.google.zxing.client.android.CaptureActivity 10-30 00:26:06.919：E/AndroidRuntime（ 4194): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1993) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2104) 10 -30 00:26:06.919：E/AndroidRuntime(4194)：在 android.app.ActivityThread。访问$600(ActivityThread.java:132) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1157) 10-30 00:26:06.919 : E/AndroidRuntime(4194): 在 android.os.Handler.dispatchMessage(Handler.java:99) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 android.os.Looper.loop(Looper. java:137) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 android.app.ActivityThread.main(ActivityThread.java:4575) 10-30 00:26:06.919: E/AndroidRuntime(4194) : 在 java.lang.reflect.Method.invokeNative(Native Method) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 java.lang.reflect.Method.invoke(Method.java:511) 10- 30 00:26:06.919: E/AndroidRuntime(4194): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789) 10-30 00:26:06.919: E/AndroidRuntime(4194) : 在 com.android。internal.os.ZygoteInit.main(ZygoteInit.java:556) 10-30 00:26:06.919: E/AndroidRuntime(4194): at dalvik.system.NativeStart.main(Native Method) 10-30 00:26:06.919 : E/AndroidRuntime(4194): 由: java.lang.ClassNotFoundException: com.google.zxing.client.android.CaptureActivity 10-30 00:26:06.919: E/AndroidRuntime(4194): at dalvik.system.BaseDexClassLoader .findClass(BaseDexClassLoader.java:61) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:501) 10-30 00:26:06.919: E /AndroidRuntime(4194): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:461) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 android.app.Instrumentation.newActivity(Instrumentation.java: 1023) 10-30 00:26:06.919: E/AndroidRuntime(4194): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1984) 10-30 00:26:06.919: E/AndroidRuntime(4194): ... 11 更多 10-30 00:29:27.799: D/AndroidRuntime(4407): 关闭 VM 10-30 00:29:27.799 ：W / dalvikvm（4407）：threadid = 1：线程退出未捕获的异常（组= 0x40a261f8）10-30 00：29：27.799：E / AndroidRuntime（4407）：致命异常：主要10-30 00：29：27.799 ：E / AndroidRuntime（4407）：java.lang.RuntimeException：无法实例化活动ComponentInfo {com.google.zxing.client.android/com.google.zxing.client.android.CaptureActivity}：java.lang.ClassNotFoundException：com .google.zxing.client.android.CaptureActivity 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1993) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2104) 10-30 00:29:27.799:E/AndroidRuntime(4407): 在 android.app.ActivityThread.access$600(ActivityThread.java:132) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 android.app.ActivityThread$H.handleMessage( ActivityThread.java:1157) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 android.os.Handler.dispatchMessage(Handler.java:99) 10-30 00:29:27.799: E/AndroidRuntime( 4407): 在 android.os.Looper.loop(Looper.java:137) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 android.app.ActivityThread.main(ActivityThread.java:4575) 10 -30 00:29:27.799: E/AndroidRuntime(4407): 在 java.lang.reflect.Method.invokeNative(Native Method) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 java.lang。 reflect.Method.invoke(Method.java:511) 10-30 00:29:27.799: E/AndroidRuntime(4407): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556) 10-30 00:29:27.799: E/AndroidRuntime( 4407）：在 dalvik.system.NativeStart.main（本机方法）10-30 00:29:27.799：E/AndroidRuntime（4407）：引起：java.lang.ClassNotFoundException：com.google.zxing.client.android。 CaptureActivity 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 java .lang.ClassLoader.loadClass(ClassLoader.java:501) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:461) 10-30 00:29 :27.799: E/AndroidRuntime(4407): 在 android.app.Instrumentation.newActivity(Instrumentation.java:1023) 10-30 00:29:27.799: E/AndroidRuntime(4407): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1984) 10-30 00:29:27.799: E/AndroidRuntime(4407): ... 11 更多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T06:41:39.413

将以下内容添加到清单中。

```
 <activity
        android:name="com.google.zxing.client.android.CaptureActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="landscape"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:windowSoftInputMode="stateAlwaysHidden" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
        <intent-filter>
            <action android:name="com.google.zxing.client.android.SCAN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.google.zxing.client.android.encode.EncodeActivity"
        android:configChanges="orientation|keyboardHidden"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:windowSoftInputMode="stateAlwaysHidden" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
        <intent-filter>
            <action android:name="com.google.zxing.client.android.ENCODE" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

# google-chrome-extension - 页面加载失败时如何进行操作？

> ID：13122754
> 
> 赞同：0
> 
> 时间：2012-10-29T13:39:08.383
> 
> 标签：google-chrome-extension

我如何知道页面加载失败？当出现服务器错误时，我收到显示“Google Chrome 无法加载此页面...”或“此页面不可用”的灰色窗口？

我想在我的扩展程序中添加 10 秒后自动刷新的选项。我使用一些网络应用程序，有时服务器由于某种原因无法加载，刷新只是让它恢复生机。所以我在这种情况下寻找自动刷新。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:34:29.370

你可能想看看`chrome.webRequest.onErrorOccurred.addListener(function details){}`监听器。根据[文档](http://developer.chrome.com/extensions/webRequest.html)，在请求完成之前由任何事件触发的错误都会触发该`onErrorOccurred`方法。将`details`包含有关错误的信息，但在您的情况下，听起来任何触发的错误都应该导致刷新，所以可能是这样的（完全未经测试，更具理论性:)）：

```
chrome.webRequest.onErrorOccurred.addListener(function details){
    chrome.tabs.reload(details.tabId);
} 
```

# jquery - 悬停时图像放大，但鼠标悬停时垂直图像未恢复正常

> ID：13122756
> 
> 赞同：0
> 
> 时间：2012-10-29T13:39:15.463
> 
> 标签：jquery

水平图像放大并恢复正常，但垂直图像放大然后返回水平而不是垂直。我有[这个小提琴](http://jsfiddle.net/RwJhn/)。我不确定，但相信问题出在 jQuery 中。我对 jQuery 很陌生，但这似乎是实现我需要的唯一方法，因为每个图像也是一个表单提交按钮。这可以在 www.starcuts10.com/poems 看到

CSS：

```
#container {
    display: block;
    width: 100%;
    position: relative;
}

.img {
    position: relative;
    z-index: 0;
}

.end {
    margin-right: 0;
}

.clear {
    clear: both;
}

.img a img {
    position: relative;
    border: 0 solid #fff;
 }

.form_align {
    display: inline;
    float: left:
} 
```

jQuery：

```
$(document).ready(function() {
    var cont_left = $("#container").position().right;

    if ($('span').hasClass('horz')) {
        $("input").hover(function() {
            // hover in
            $(this).parent().parent().css("z-index", 1);
            $(this).animate({
                height: "405",
                width: "638",
                right: "+=50",
                bottom: "+=150"
            }, "fast");
        }, 
        function() {
            // hover out
            $(this).parent().parent().css("z-index", 0);
            $(this).animate({
                height: "250",
                width: "425",
                right: "-=50",
                bottom: "-=150"
            }, "fast");
        });

        $(".img").each(function(index) {
            var right = (index * 160) + cont_left;
            $(this).css("right", right + "px");
        });
    } 
    else {
        $("input").hover(function() {
            // hover in
            $(this).parent().parent().css("z-index", 1);
            $(this).animate({
                height: "638",
                width: "405",
                right: "+=50",
                bottom: "+=150"
            }, "fast");
        }, 
        function() {
            // hover out
            $(this).parent().parent().css("z-index", 0);
            $(this).animate({
                height: "425",
                width: "250",
                right: "-=50",
                bottom: "-=150"
            }, "fast");
        });

        $(".img").each(function(index) {
            var right = (index * 160) + cont_left;
            $(this).css("right", right + "px");
        });
    }
}); 
```

HTML：

```
<div id="container">
    <table>
        <tr>
            <span class="horz">
                <span class="vert">    
                    <td>
                        <form class="form_align" method ="post" action="#">
                            <a href=""><input type="image" src="http://starcuts10.com/images/blue_box.png" class="img"></a>
                            <input type="hidden" name="img" value="http://starcuts10.com/images/blue_box.png"> 
                            <input type="hidden" name="poem" value="">
                        </form>
                    </td>
                </span>
                <span class="vert">    
                <td>
                    <form class="form_align" method ="post" action="#">
                        <a href=""><input type="image" src="http://starcuts10.com/images/red_box.png" class="img"></a>
                        <input type="hidden" name="img" value="http://starcuts10.com/images/red_box.png"> 
                        <input type="hidden" name="poem" value="">
                    </form>
                </td>
            </span>  
        </tr>
    </table><br><br><br>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:57:57.433

你的jquery逻辑有问题。

你不需要`if ("span.horz") { .. } else { .. }`

您需要做的是对两者都有悬停效果：`$(".horz input")`和`$(".vert input")`.

另外，html是错误的。跨度应该在 TD 内

这是一个工作小提琴：http: [//jsfiddle.net/RwJhn/1/](http://jsfiddle.net/RwJhn/1/)

# ios - 使用未声明的标识符（带有操作的警报视图）

> ID：13122757
> 
> 赞同：1
> 
> 时间：2012-10-29T13:39:33.340
> 
> 标签：ios, uialertview, xcode4.5

我有一个带有按钮的 UIAlertView，我试图让这些按钮执行一个动作。问题是我的方法中有一个“未声明的标识符”。

我看到的问题[http://tinypic.com/view.php?pic=28qvhom&s=6](http://tinypic.com/view.php?pic=28qvhom&s=6)

编码

警报视图

```
 UIAlertView *alert = [[UIAlertView alloc]
    initWithTitle:@"Well done!"
    message: @"You got all 20 in Time: x"
    delegate:nil
    cancelButtonTitle:nil
    otherButtonTitles:@"Save and Quit", @"Quit", nil];

[alert show];} 
```

虚空

```
-(void)alertView:(UIAlertView* )alertView 
clickedButtonAtIndex:(NSInteger)buttonIndex         

{

    if(buttonIndex==0) {/*some action */ }
    else if(butonIndex==1){/*some action */}

}

     //I aso have <UIAlertViewDelegate> in my .h file. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:49:56.593

问题在于`else if(butonIndex==1)`您缺少单词按钮中的第二个“t”。

为了将来参考，Xcode 的“Fix-It”功能将为您修复此类小错误。

![在此处输入图像描述](../Images/42c5193ab991b4c744d8ce382f741a94.png)

单击红色圆圈以激活修复菜单，然后只需按 Enter。

**编辑：**

做这个：

```
- (void)myMethod{

}

-(void)alertView:(UIAlertView* )alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{

} 
```

不是这个：

```
- (void)someMethod
{
    -(void)alertView:(UIAlertView* )alertView clickedButtonAtIndex:(NSInteger)buttonIndex
    {

    }
} 
```

如果不是这种情况，那么您在警报视图委托之前的方法末尾缺少右大括号“}”。

# python - python、dpkt 和时间戳

> ID：13122758
> 
> 赞同：3
> 
> 时间：2012-10-29T13:39:39.493
> 
> 标签：python, http, timestamp, libpcap

我有个问题。

如何使用 dpkt 库和 ts 为 pcap 文件中的每个主机名获得 GET 和 HTTP/1.0 200 OK（我的意思是 Web 服务器的时间延迟）之间的响应时间差异？

我的初步代码：

```
#!/usr/bin/env python

import dpkt

f = open('mycapture.cap')
pcap = dpkt.pcap.Reader(f)

for ts, buf in pcap:
    eth = dpkt.ethernet.Ethernet(buf)
    ip = eth.data
    tcp = ip.data

    if tcp.dport == 80 and len(tcp.data) > 0:
        http = dpkt.http.Request(tcp.data)
        print ts, http.headers['host']

f.close() 
```

但它仍然只输出 GET 请求的时间戳。

它看起来像：

```
tcpdump -i eth0 -w pcapfile; python (command).py pcapfile

google.com 0.488183
facebook.com 0.045466
quora.com 0.032777 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T08:03:43.780

似乎您设法获得了第一个请求数据包，现在您需要获得响应的第一个数据包......类似于：

```
if tcp.sport == 80 and len(tcp.data) > 0:
     # Here you can save the timestamp of the response and calculate the difference 
```

祝你好运

# excel - 按年份过滤总和

> ID：13122759
> 
> 赞同：0
> 
> 时间：2012-10-29T13:39:44.457
> 
> 标签：excel, excel-formula

您好想使用我拥有的数据创建一些报告。下面是我所拥有的。

```
Date       Sold
22-Oct-11   22
23-Oct-11   28
24-Oct-11   10
22-Oct-12   22
23-Oct-12   28
24-Oct-12   10 
```

我想要的是创建年份和销售总额如下。

```
Year   Sold
2011    60
2012    87 
```

知道如何使用 excel 预定义函数来完成这项工作。

我知道这可以使用 MACRO 来完成，但是我不想使用 MACRO。

## 编辑 1

我也不想使用 Pivot 来执行此操作。仅 Excel 预定义函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:18:28.363

可以使用数组公式（在公式窗口按Ctrl-Shift-Enter输入，大括号将由Excel插入，而不是用户插入）：

```
={SUM(IF(YEAR(A1:A4)=2010,1,0)*B1:B4)} 
```

日期在 A 列，销售数量在 B 列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-01T17:03:53.273

试试这个公式：`=SUMIF($A$2:$A$7;"=*11";$B$2:$B$7)`. 我认为可以改进这个公式，但我只是一个初学者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:44:29.167

如果您可以添加一个额外的列，`=Year(date)`那么您可以使用小计来计算您的结果（数据小计）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T07:50:56.820

您可以使用数据透视表。将日期字段放在左侧，右键单击并按年份分组，然后将已售字段放在值区域中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-30T13:14:16.587

使用 Excel 2007（及更高版本），您可以访问`SUMIFS`函数假设您的数据按所示顺序位于 A 列和 B 列中，那么将 2011 年的所有数据相加的函数将是

```
=SUMIFS(B:B,A:A,">="&DATE(2011,1,1),A:A,"<="&DATE(2011,12,31)) 
```

当然，您可以引用包含年份编号的单元格来代替**2011**以使其可移植

# javascript - innerHTML 和使用 createTextNode 填充跨度之间有什么主要区别吗？

> ID：13122760
> 
> 赞同：35
> 
> 时间：2012-10-29T13:39:46.837
> 
> 标签：javascript, innerhtml, createtextnode

标题很清楚：`innerHTML`和`createTextNode`（与 一起使用`Append`）用文本填充跨度之间有什么主要区别吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-10-29T13:50:43.187

当然。[`createTextNode`](https://developer.mozilla.org/en-US/docs/DOM/document.createTextNode)将转义任何字符串并按原样显示它们，同时[`innerHTML`](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML)可以将类似 html 的字符串呈现到 DOM 中。如果您不希望这样（除非您确定文本不包含未转义的标签，例如直接分配文字时），您可以使用[`textContent`](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent)（或[`innerText`](http://msdn.microsoft.com/en-us/library/ie/ms533899%28v=vs.85%29.aspx)用于 IE）。

但是我推荐`createTextNode`，因为所有浏览器都支持它，没有任何怪癖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-05-24T02:32:47.457

在网上做一些研究，这是我发现的。这应该在高层次上涵盖它：

*   元素。**createTextNode**（文本）和 elem。**textContent** = text 做同样的事情 (src: [https://javascript.info/task/createtextnode-vs-innerhtml](https://javascript.info/task/createtextnode-vs-innerhtml) )

*   **textContent**返回节点中包含的全文，而innerText**仅**返回节点中包含的可见文本。（src：[textContent 与 innerText 之间的区别](https://stackoverflow.com/questions/35213147/difference-between-textcontent-vs-innertext)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-09T18:44:56.380

我的理解是，对 innerHTML 的某些操作会删除所有绑定事件，因此最好使用 createTextNode。

# android - 更改 Eclipse 的默认输出 bin 文件夹

> ID：13122763
> 
> 赞同：2
> 
> 时间：2012-10-29T13:39:49.837
> 
> 标签：android, eclipse

Eclipse 默认将二进制文件放在“项目文件夹/bin/”中。我想让 Eclipse 将生成的二进制文件等放在另一个文件夹中（在项目文件夹之外）。做安卓开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T08:29:32.623

我想在下面描述一种方法。

首先，在 eclipse 工作空间中本地**新建一个空项目**，用于存储生成的输出文件，比如 output_bin。

如上述步骤所述，现在从**默认输出文件夹**中，我们需要一个新变量来链接到我们的项目输出文件夹。

1.  默认输出文件夹 -> 浏览 ->**创建新文件夹...**
2.  -> 高级 -> 勾选“链接到文件系统中的文件夹” ->
3.  **变量**-> 新建 .. -> 名称 = PROJECT_OUT，位置 =“ **CHOOSE_PATH_TO\output_bin\bin\Project1bin** ” -> 好的

*注意*：Project1bin 是一个新目录，用于存储 bin 文件夹。output_bin 是一个空项目，您可以为各种项目创建多个 bin 文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T14:12:48.337

您可以更改 Java 项目的“输出文件夹”（默认为 bin）（请参阅“[如何在 Eclipse 中更改 Java 项目的 bin 文件夹？](https://stackoverflow.com/questions/3191693/how-do-i-change-a-java-projects-bin-folder-in-eclipse) ”）

但对于 Android 项目，如“[无法更改默认输出文件夹](https://stackoverflow.com/questions/8321853/cant-change-default-output-folder)”中所述，您也需要修改`build.properties`。
但这可能很危险，[正如评论](https://stackoverflow.com/questions/8321853/cant-change-default-output-folder#comment17552679_8865084)的那样：

> 请注意，在处理库项目时更改输出文件夹不起作用 - Ant 脚本的一部分是硬编码的，无论如何都可以在 libs 的 bin 文件夹中查找。

所以也许在这里使用 Dropbox的[排除选项更可取？](http://www.dropboxwiki.com/Using_Dropbox_CLI#EXCLUDE)

# java - java.util.List 实现的测试用例库

> ID：13122764
> 
> 赞同：6
> 
> 时间：2012-10-29T13:39:53.520
> 
> 标签：java, unit-testing, collections

> **可能重复：**
> [是否有 Java 自定义集合实现的测试套件？](https://stackoverflow.com/questions/7068503/is-there-a-testsuite-for-java-custom-collections-implementation)

是否有可用的测试用例库可用于确保`java.util.List`正确完成自定义实现？

我当然可以编写我的一个测试用例，但考虑到所有`List`方法的性质，确保测试是全面的似乎很棘手。

同样，为整个 Java 集合接口集提供测试用例也很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:43:35.720

[Guava 人](https://code.google.com/p/guava-libraries/)编写了一个集合测试库，称为因为`guava-testlib`......他们正在实现很多集合。

然而，我目前找到的最好的文档是[这篇第三方博客文章](http://www.gamlor.info/wordpress/2012/09/google-guava-collection-test-suite/)。在[他们的 ContributorSetUp Wiki 页面](https://code.google.com/p/guava-libraries/wiki/ContributorSetUp)中简要提到了这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:45:47.090

看看[`org.apache.commons.collections.list.AbstractTestList`](http://commons.apache.org/collections/testapidocs/org/apache/commons/collections/list/AbstractTestList.html#testListAddByIndex%28%29). 可能这就是你想要的。

# windows - 从 HKEY_USERS 写入

> ID：13122765
> 
> 赞同：0
> 
> 时间：2012-10-29T13:39:53.163
> 
> 标签：windows, vb.net, registry, sid

我正在尝试创建一个应用程序，该应用程序允许我输入用户名并通过修改 HKEY_USERS\UserSID 下的注册表来切换该用户的默认打印机。不过，我似乎无法将值写入注册表的该部分。也许这是 Windows 的限制？这是我到目前为止的代码。

```
 Dim strComputer = "."
    Dim objWMIService As Object = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
    Dim theUsername As String = TextBox1.Text
    Dim theDomain As String = TextBox2.Text

    Dim objAccount As Object = objWMIService.Get("Win32_UserAccount.Name='" & theUsername & "',Domain='" & theDomain & "'")

    Dim theport As RegistryKey
    theport = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows NT\\CurrentVersion\\Devices")
    Dim val As Object = theport.GetValue(ListBox1.SelectedItem)
    theport.Close()
    Dim theSid As String = objAccount.sid
    Dim theKey As RegistryKey = Registry.Users.OpenSubKey(theSid + "\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T13:36:05.800

我不认为有一些 Windows 限制，因为我多次写信给 HKEY_USERS\SIDs。但我为此使用了 vbscript。此外，我应该警告您，如果用户已登录，您只能读取和写入用户注册表。对于未登录的用户 - 使用 ActiveSetup。

我在 vbs 上有一个脚本，它将一些注册表写入所有登录的用户。希望您可以将其改编为 VB.NET。

```
Option Explicit

Const HKEY_USERS = &H80000003
Dim objReg, objWMI, colSessions, objSession, colList, colUsers, objUser, Domain, UserName, objUserAccount, SID, WshShell

Set WshShell = CreateObject("WScript.Shell")
Set objReg = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv")
Set objWMI = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2") 

Set colSessions = objWMI.ExecQuery("Select * from Win32_LogonSession Where LogonType = 2 Or LogonType = 10") 
If colSessions.Count <> 0 Then 
    For Each objSession in colSessions 
        Set colUsers = objWMI.ExecQuery("Associators of " & "{Win32_LogonSession.LogonId=" & objSession.LogonId & "} " & "Where AssocClass=Win32_LoggedOnUser Role=Dependent" )
        For Each objUser in colUsers 
            Domain = objUser.Domain : UserName = objUser.Name
            Set objUserAccount = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_UserAccount.Domain='" & Domain & "',Name='" & UserName & "'")
            SID = objUserAccount.SID
            objReg.CreateKey HKEY_USERS, SID & "\Control Panel\Desktop"
            objReg.SetStringValue HKEY_USERS, SID & "\Control Panel\Desktop", "Example", "1"
            objReg.SetDwordValue HKEY_USERS, SID & "\Control Panel\Desktop", "Example", "2"         

        Next 
    Next 
End If 
```

# plugins - Joomla！系统插件为所有模块添加额外的参数

> ID：13122767
> 
> 赞同：1
> 
> 时间：2012-10-29T13:39:59.680
> 
> 标签：plugins, joomla, joomla2.5, joomla-extensions

我需要创建一个具有一个目标的系统插件 - 向所有可用模块添加额外的参数组字段。

我知道一个解决方案 - 在每个模块的每个 XML 清单中添加额外的参数，但这是一个糟糕的解决方案，原因有两个：

1）在不丢失这些更改的情况下更新模块是不可能的
2）它的工作量很大
3）它使得这些参数的扩展几乎不可能

**我想做的事：**

我想制作一个系统插件，为每个已安装的模块添加一组参数。

**我要的是什么：**

我通过互联网寻找解决方案。我发现我不需要创建新的参数类型。我想使用内置类型 - 文本或列表。

有一些教程，其中包含有关将参数添加到单个模块并为此单个模块检索它们的信息`helper.php`。是的，这也是我不想要的。

我要求链接到一堆教程或建议如何在没有教程的情况下进一步进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:55:06.757

此模块正在使用您正在搜索的内容。如果你有时间，你可以分析它，也许你会找到答案。 [高级模块管理器](http://www.nonumber.nl/extensions/advancedmodulemanager)

# html - 如何在页面之间浏览而不闪烁？

> ID：13122769
> 
> 赞同：5
> 
> 时间：2012-10-29T13:40:10.437
> 
> 标签：html, css

我有两个经典的 HTML 页面（只有 HTML 和 CSS）以及它们之间的链接。
当我点击这些链接时，屏幕会闪烁（在转换之间它会很快变白）。
我试图把它放在头上 - 没有结果：

```
<meta http-equiv="Page-Enter" content="blendTrans(Duration=0.0)" />
<meta http-equiv="Page-Exit" content="blendTrans(Duration=0.0)" /> 
```

我通常可以打开其他网站而不会闪烁。
浏览器是 Firefox 16.0.1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:43:31.953

这`meta`仅适用于 IE，它们不适用于 FF。

您不能依靠防止在纯 HTML 中闪烁。我找到的最佳解决方案是用 JavaScript 调用替换每个链接，在该调用中使用 AJAX 下载页面，然后用新内容替换文档本身。页面刷新速度非常快，下载时您不会看到任何空白屏幕。

基本功能可能是这样的：

```
function followLink(pageUrl) 
{ 
    jQuery.ajax({ 
        url: pageUrl, 
        type: "GET", 
        dataType: 'html', 
        success: function(response){ 
            document.getElementsByTagName('html')[0].innerHTML = response
        } 
    }); 
} 
```

然后你必须替换你的链接：

```
<a href="mypage.html">Link</a> 
```

和：

```
<a href="javascript:followLink('mypage.html')">Link</a> 
```

有关此的更多详细信息：替换整个 HTML 文档] [1](https://stackoverflow.com/questions/2825586/inplace-replace-entire-html-document)：如何使用 jQuery 替换 HTML 文档的内容及其含义（并不总是那么明显）。

**改进**

使用此解决方案，您可以强制用户使用 JavaScript，以防万一未启用，他们将无法点击链接。出于这个原因，我会提供一个后备。首先不要改变`<a>`，而是用（例如）一个 CSS 类来装饰它们，比如`async-load`. 现在在页面的 onload 上将所有`href`s替换为`javascript:`对应的，如下所示：

```
jQuery().ready(function() {
    jQuery("a.asynch-load").each(function() { 
        this.href = "javascript:followLink(\"" + this.href + "\")";
    });
}); 
```

有了这个，您也可以处理加载动画（它的实现方式取决于您使用的内容和您的布局）。此外，在同一个地方，您可以提供淡入/淡出动画。

最后不要忘记，这种技术也可以用于片段（例如，如果您提供共享导航栏和当用户单击导航栏链接时替换的*内容*部分（因此您无需再次加载所有内容） .

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T14:02:20.880

只需将您的身体背景更改为：

```
body {
  background: url("Images/sky01.jpg") repeat scroll 0 0 #121210;
  font-family: Verdana,Geneva,sans-serif;
  font-size: 12px;
  margin: 0;
  padding: 0;
} 
```

背景颜色将防止加载背景图像时出现白色闪烁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-12T13:58:17.777

尝试嵌入图片，因为它会延迟最终页面加载，因此会延迟白色过渡时间

```
echo '<img src="data:image/png;base64,';
echo base64_encode(file_get_contents($file));
echo '"/>'; 
```

# objective-c - 添加常量问题 Xcode 4.5

> ID：13122770
> 
> 赞同：0
> 
> 时间：2012-10-29T13:40:18.020
> 
> 标签：objective-c, xcode

我有一个用于存储常量的类。

因此，有两个文件分别调用 Constant.h 和 Constant.m

这就是我在 .h 文件中的内容：

```
#import <Foundation/Foundation.h>

enum kParams {
    kFirstName = 0,
    kLastName = 1
};

extern NSString * const kNotificationUpdateMainMenu; 
```

这就是我在 .m 文件中的内容：

```
#import "Constants.h"

NSString * const kNotificationUpdateMainMenu = @"kNotificationUpdateMainMenu"; 
```

第一次效果很好，但是当我尝试添加其他一些常量（例如 kNotificationFbLoginSuccsess）时，其他类看不到它。

这是一条消息，向我展示了我遇到的问题。但是我不明白没有这个问题我的其他常量是如何工作的（我添加的只是新常量得到了这个错误）。

```
/Users/developer/Documents/Projects/Test/Test/Test/AppDelegate.m:121:64: Use of undeclared identifier 'kNotificationFbLoginSuccsess' 
```

我找到了一些解决方法：

*   打开组织者
*   清除派生数据
*   删除 project.xcworkspace 文件和 xcuserdata
*   关闭项目
*   重新启动 Xcode

但我认为操作太多，我可以添加一个常量。怎么会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T15:16:43.187

您的“全局”常量实际上不是外部的（单独编译并稍后链接在一起）。采取简单的方法并将`NSString * const kNotificationUpdateMainMenu = @"kNotificationUpdateMainMenu";`其放入头文件中。方法文件什么都不需要。

我会`#define kNotificationUpdateMainMenu @"kNotificationUpdateMainMenu"`用来执行拼写检查。编译器将为整个编译创建一个常量字符串的共享实例。

# xml - 在 REST 服务中使用 json 和 xml

> ID：13122776
> 
> 赞同：3
> 
> 时间：2012-10-29T13:40:34.223
> 
> 标签：xml, json, web-services, rest

我们什么时候应该在 REST 服务中使用 xml，什么时候使用 JSON？

使用 json 而不是 XML 的优缺点是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T13:42:40.833

这就像问：

> “说法语和说西班牙语的优缺点是什么”。

这取决于你所说的上下文和听众。

您的服务消费者的需求是什么？您是否将结果提供给其他服务器或浏览器的 ajax 请求？你有一个简单的对象、数组，还是一个非常复杂的对象，其中可能还有其他对象？通过提供此类详细信息，您可以列出优缺点。如果你只能做一个，这个问题将推动选择。

我通常允许客户端指定他们想要的格式并返回 json 或 xml。它只是同一资源的 2 个不同的“视图”或表示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:50:39.757

我真的不知道利弊是什么，这两种 MIME 类型都需要对您的数据进行序列化和反序列化。我可以说的是，向客户端应用程序提供请求特定内容类型的机会是一个好习惯，这样您的服务就可以被用不同语言编写的各种客户端使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T13:51:59.050

关于您应该如何响应客户端（xml 或 json），我同意 Ray 的观点。确实是一个好主意，同时实现两者并让客户选择决定响应的格式。我使用的大多数 Web 服务都支持这一点并且相当容易做到，因为您只需要为同一个对象实现两种不同的反序列化/序列化方法。

我想说的是，最近越来越多的 WS 以 json 格式提供数据，在我看来，在序列化/反序列化时它更灵活、更快。此外，我发现 JSON 更易于人类阅读，尤其是在复杂对象中。

# java - 在 Slick 2D 中使用 drawString 模糊文本

> ID：13122778
> 
> 赞同：2
> 
> 时间：2012-10-29T13:40:44.150
> 
> 标签：java, slick2d

`graphics.drawString();` 除非我处于全屏模式，否则我的 2d 游戏无法正确渲染，我遇到了这个奇怪的问题。

**截图**： [截图](http://i.stack.imgur.com/5bGol.png)

这是我到目前为止的代码（这基本上只是“简单游戏”教程。）

**声明**：

```
public Font font;
public TrueTypeFont trueTypeFont; 
```

**初始化**：

```
@Override
public void init(GameContainer gc) 
        throws SlickException {
    font = new Font("Verdana", Font.BOLD, 20);
    trueTypeFont = new TrueTypeFont(font, true);

} 
```

**渲染**：

```
public void render(GameContainer gc, Graphics g) 
        throws SlickException 
{
    // render some text to the screen
    trueTypeFont.drawString(20.0f, 20.0f, "Slick displaying True Type Fonts", Color.green);
    g.drawString("Hello", 300,300);
} 
```

我尝试将 VSync 设置为 true，并手动限制帧速率。但是没有，没有变化。

任何想法为什么会发生这种情况？它以全屏模式完美呈现文本。

# android - android中ldpi的xdpi图像

> ID：13122781
> 
> 赞同：1
> 
> 时间：2012-10-29T13:41:02.443
> 
> 标签：android, android-layout, android-emulator

我有一个高质量的图标。我将其复制到 drawable-xdpi 文件夹。我可以在不创建 drawable-ldpi 文件夹的情况下将 drawable-xdpi 中的图标用于低密度屏幕吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:46:28.923

认为它是 drawable-xhdpi 文件夹。是的，Android 会在最适合显示类型的文件夹中寻找可绘制对象。如果没有找到，它将尝试确定下一个最佳使用方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:46:13.533

是的。不要将该图标放在`drawable-ldpi`文件夹中。

如果您的应用在`ldpi`设备上运行并且操作系统未在`drawable-ldpi`. 然后它将使用`drawable-xhdpi`缩放后的资源。

更新

质量将不一样..因为它是`ldpi`设备。

它将像这样计算新图像的分辨率

xhdpi 图标的分辨率 = x * y ldpi 的分辨率将 = x/2 * y*2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:58:45.300

为什么不将图像放入 MDPI 或仅可绘制文件夹？

# css - 我的整个 CSS 在 ie7 模式下都死了

> ID：13122783
> 
> 赞同：1
> 
> 时间：2012-10-29T13:41:16.420
> 
> 标签：css, internet-explorer-7

这很奇怪。

该站点在除 IE7 之外的所有浏览器中都能完美运行。在 ie7 中没有任何效果。大多数css甚至都没有渲染。IE8？美好的。Ie9 完美。当然是 Firefox 和 Chrome。

想听更奇怪的吗？这是我以前使用过的模板网站。建立在基本相同模板上的其他站点在 ie7 中也可以工作。

这就是为什么我认为无论它是简单的。

我不想在这里粘贴代码 - 它非常庞大。但我会给你一个指向该站点和 css 站点的链接：[http](http://canadianrecovery.ca) ://canadianrecovery.ca css [http://canadianrecovery.ca/css/screen.css](http://canadianrecovery.ca/css/screen.css)

问题是，我将文档标准设置为 ie9 它在 ie7 模式下工作正常，文档标准设置为 ie9

但我注意到大多数 IE 浏览器不显示默认文档标准......这显然是 IE 本身的某种问题。但这令人沮丧……大多数最终用户不知道如何解决这个问题。

提前致谢。

埃拉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:46:25.717

我想我可能找到了原因。在你的 body-style 中（第 13 行），你有以下内容：

```
font-family: "Times New Roman; 
```

看到那个未封闭的报价了吗？似乎 Chrome、FF、IE9 等可以修复该错误，而早期版本的 IE 将 CSS 的其余部分作为您的字体系列声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:38:45.373

试试[Modernizr](http://modernizr.com/)，它可以在较旧/不太兼容的浏览器中轻松实现很多事情。尝试开发版本，看看它是否可以帮助您并针对您的特定需求编写您自己的生产版本，以最小化 javascript 库的大小（和速度）。

> Modernizr 是一个 JavaScript 库，可检测用户浏览器中的 HTML5 和 CSS3 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T16:32:37.520

感谢大家。我实际上找到了解决方案。寻找一个名为 ie7.js 的 js 脚本并将其包含在条件注释中。它解决了很多 ie7 问题

# firefox - 如何在 FireFox 中获取 SVG 元素尺寸？

> ID：13122790
> 
> 赞同：18
> 
> 时间：2012-10-29T13:41:44.537
> 
> 标签：firefox, svg

在大多数浏览器中，以下内容将起作用。

```
window.onload = function(){
    console.log( document.getElementById('svgElm').getBoundingClientRect().width );
}; 
```

这是一个[演示](http://jsbin.com/arisav/4/edit)。如果您在 Google Chrome 中尝试，控制台将输出`200`. 但是，FireFox 会返回`0`.

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-30T14:41:27.173

如果无法返回 SVG 属性，我最终会退回到父尺寸。这是一个演示[http://jsbin.com/uzoyik/1/edit](http://jsbin.com/uzoyik/1/edit)。

相关代码是：

```
svg.clientWidth || svg.parentNode.clientWidth
svg.clientHeight || svg.parentNode.clientHeight 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-03-25T22:14:28.930

我不认为“宽度”是 getBoundingClientRect 方法返回的对象的标准跨浏览器属性。我通常会做类似的事情：

```
var box = el.getBoundingClientRect();
var width = box.right-box.left;
var height = box.bottom-box.top; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T14:14:50.517

此 Firefox 错误已在 2014 年 10 月 14 日发布的 Firefox 33 中修复。

有关详细信息，请参阅[错误 530985](https://bugzilla.mozilla.org/show_bug.cgi?id=530985)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-31T08:45:13.757

我为此找到的解决方案是使用`.getComputedStyle()`. 由于`svg`旧的 IE8 浏览器不支持元素，`.getComputedStyle()`因此可以提供一致的结果。

所以我最终在我的库中使用了这个函数：

```
var heightComponents = ['height', 'paddingTop', 'paddingBottom', 'borderTopWidth', 'borderBottomWidth'],
    widthComponents = ['width', 'paddingLeft', 'paddingRight', 'borderLeftWidth', 'borderRightWidth'];

var svgCalculateSize = function (el) {

    var gCS = window.getComputedStyle(el), // using gCS because IE8- has no support for svg anyway
        bounds = {
            width: 0,
            height: 0
        };

    heightComponents.forEach(function (css) { 
        bounds.height += parseFloat(gCS[css]);
    });
    widthComponents.forEach(function (css) {
        bounds.width += parseFloat(gCS[css]);
    });
    return bounds;
}; 
```

# ruby-on-rails - Rails：模型验证与迁移

> ID：13122791
> 
> 赞同：15
> 
> 时间：2012-10-29T13:42:02.350
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3, validation

> **可能重复：**
> [Ruby on Rails：在模型中验证还是在数据库中验证更好？](https://stackoverflow.com/questions/2367281/ruby-on-rails-is-it-better-to-validate-in-the-model-or-the-database)

我看到可以在 Rails 模型和迁移中添加相同的约束/验证。但是哪一个是最好的方法？在模型和数据库级别（以及为什么）进行验证是一种好习惯吗？或者他们在rails中相同？

例如，我们可以在模型和迁移中对名称进行相同的验证

```
class User < ActiveRecord::Base
  validates :name, :uniqueness => true, :presence => true
end

class CreateUser < ActiveRecord::Migration
  def change
    create_table :users do |t|
      t.string :name, :unique => true, :null => false
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-29T14:13:54.613

尽可能在数据库级别和模型级别进行验证。

为什么？对于初学者，活动记录不会在所有上下文中强制验证。以下方法跳过验证，并将对象保存到数据库中而不管其有效性：

```
decrement!
decrement_counter
increment!
increment_counter
toggle!
touch
update_all
update_attribute
update_column
update_counters 
```

如果你传递`:validate => false`给`save`，它也会跳过验证。有关详细信息，请参阅跳过验证的[Active Record 验证和回调指南](http://guides.rubyonrails.org/active_record_validations_callbacks.html#skipping-validations)部分。（如果这让您担心，甚至还有禁用这些方法[的宝石](https://github.com/garybernhardt/do_not_want)。）

所以**原因 #1**是 Rails 验证无论如何都不是完全证明的：完全依赖它们是有风险的，特别是对于任务关键型验证，例如唯一性。

说到这一点，**原因 #2**（我想不通）：activerecord 验证容易出现竞争条件，尤其是 Rails 的唯一性验证器*不能保证唯一性*。这是众多[文章](http://nhw.pl/wp/2009/07/20/are-activerecord-validations-worth-anything)中的一篇，它记录了为什么会这样。

尽管它们可能很少发生，但违反唯一性约束可能会破坏整个数据集。在 Rails 即将执行此操作的极少数情况下，您希望不惜一切代价阻止它，这就是 DB 唯一性约束的用武之地：数据库是为处理这种情况而构建的，并且会始终如一地强制执行唯一性，即使 Rails 没有这样做。

**原因 #3**：为什么不在*模型*和数据库中都进行验证？当然，你会重复一些，但与 Rails 错过唯一性验证检查之类的东西相比，这通常是一个非常小的问题。这真的不是一个非此即彼的命题：在数据库中尽可能地重复验证*总是*更好，特别是对于任务关键型约束，例如唯一性。

无论如何，这些是我的想法，希望对您有所帮助。

参考：[强制正确性的地方](https://www.destroyallsoftware.com/screencasts/catalog/where-correctness-is-enforced)（Gary Bernhardt 的截屏视频，需要订阅才能查看）

# java - JXTable - 如何在排序表格时更新荧光笔

> ID：13122792
> 
> 赞同：1
> 
> 时间：2012-10-29T13:42:02.360
> 
> 标签：java, swing, swingx, jxtable, tablerowsorter

我有一个带有自定义表模型的 JXTable。我添加了 2 个带有自定义 HighlightPredicate 的 ColorHighlighter。

问题是当我单击列标题时，表格对行进行排序，但荧光笔仍然与旧视图一样。

排序表格后如何更新高亮状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:35:39.263

正如@kleopatra 提到的，我查看了我的谓词：

```
 HighlightPredicate spakowany = new HighlightPredicate() {
        @Override
        public boolean isHighlighted(Component renderer, ComponentAdapter adapter) {
            TableModel tableModel = table.getModel();
            if (tableModel instanceof StanTableModel) {
                StanTableModel stanTableModel = (StanTableModel) tableModel;
                // int rowIndex = adapter.row;  <-  this was the issue 
                int rowIndex = adapter.convertRowIndexToModel(adapter.row);
                StanTableRow myCustomRow = stanTableModel.getRow(rowIndex);
                if ((myCustomRow.isSpakowany()) {
                    return true;
                }
            }
            return false;
        }
    }; 
```

并使用@mKorbel 的想法：

曾是：

```
 int rowIndex = adapter.row; 
```

就是现在：

```
 int rowIndex = adapter.convertRowIndexToModel(adapter.row); 
```

它现在有效。

**StanTableModel**是我的自定义表格模型。它具有**getRow()**函数并返回一个**StanTableRow**对象，该对象又具有**isSpakowany()**函数。

# symfony - symfony2 表单修改密码

> ID：13122796
> 
> 赞同：2
> 
> 时间：2012-10-29T13:42:08.557
> 
> 标签：symfony

我正在尝试修改员工表格，但密码字段有问题。

当我在表单上时，如果没有在使用空白密码修改的密码中插入任何内容。这是不正确的，我希望如果用户对密码什么都不做，密码不会为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T18:12:05.907

如果未提交（修改），请不要更新密码字段。我想这就是你所需要的

```
/**
* @ORM\Entity
**/
class User 
{
   // your setters/getters

   public function setPassword($password) 
   {
       if (null === $password)  {
           return; 
       }

       $this->password = $password;
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T14:26:36.223

这里的问题是你使用一个字段来保存两个不同的东西：一个普通的密码和它的哈希。因此，只有当不为空时，才将它们拆分为`$plainPassword`and`$password`并更新字段：`$password``$plainPassword`

```
if ($plainPassword = $user->getPlainPassword()) {
    $encoder  = $this->get('security.encoder_factory')->getEncoder($user);
    $password = $encoder->encodePassword($plainPassword, $user->getSalt());
    $user->setPassword($password);
} 
```

# html - 防止提交表单后重新加载页面中的重复数据

> ID：13122798
> 
> 赞同：0
> 
> 时间：2012-10-29T13:42:09.547
> 
> 标签：html, forms

> **可能重复：**
> [如何通过浏览器刷新来防止重复帖子？](https://stackoverflow.com/questions/6718150/how-to-prevent-duplicate-posts-via-a-browser-refresh)

我有一个简单的 html`form`来提供用户的一些信息并注册两个数据库。一切正常。但开始时用户按 F5 或刷新页面的问题；在这种情况下，以前的信息再次注册到数据库并创建副本。

我的问题是如何在数据库中注册信息后删除标题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:43:45.950

一个常见的解决方案是让处理 POST 的服务器端脚本重定向到自身——然后浏览器将使用 GET 请求来获取页面，该页面可以安全地重新加载。或者，您可以将 POSTdata 复制到 SESSIONdata 并参考它以提供反馈，例如“已发送消息”或“已提交订单”或“已保存设置”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T14:03:41.647

查找[POST/REDIRECT/GET](http://community.developer.authorize.net/t5/The-Authorize-Net-Developer-Blog/Handling-Online-Payments-Part-6-Preventing-Duplicate-Submissions/ba-p/11168)。这就是解决这个问题的设计模式的名称。

# mysql - 将查询转换为休眠条件查询

> ID：13122799
> 
> 赞同：0
> 
> 时间：2012-10-29T13:42:24.090
> 
> 标签：mysql, hibernate, postgresql, sybase, hibernate-criteria

我有以下 Sybase 查询，

```
select *
  from dbo.translation_style_sheet t1
 where t1.create_date = (select max(t2.create_date) 
                           from dbo.translation_style_sheet t2
                          where t1.file_name = t2.file_name); 
```

我正在尝试将其转换为休眠条件查询，但无法弄清楚。我假设我需要使用 DetachedCriteria 来处理这个问题，但不确定如何使用它。

这就是我迄今为止所拥有的。

```
DetachedCriteria maxCreateDate = DetachedCriteria.forClass(TranslationStyleSheet.class, "translationStyleSheet2")
    .setProjection( Property.forName("createDate").max() )
    .add( Property.forName("translationStyleSheet2.fileName").eqProperty("translationStyleSheet.fileName") );

List<TranslationStyleSheet> translationStyleSheets = this.session.createCriteria(TranslationStyleSheet.class, "translationStyleSheet")
            .add( Property.forName("createDate").eq(maxCreateDate))
            .list(); 
```

我收到以下异常。

```
org.hibernate.exception.GenericJDBCException
could not execute query

SQL
    select this_.translation_style_sheet_id as translat1_20_0_, this_.create_date as create2_20_0_, this_.description as descript3_20_0_, this_.file_content as file4_20_0_, this_.file_extension as file5_20_0_, this_.file_name as file6_20_0_, this_.file_size as file7_20_0_, this_.style_sheet_content as style8_20_0_, this_.style_sheet_type as style9_20_0_ from translation_style_sheet this_ where this_.create_date = (select max(translationStyleSheet2_.create_date) as y0_ from translation_style_sheet translationStyleSheet2_ where translationStyleSheet2_.file_name=this_.file_name)
SQLState
    ZZZZZ 
```

有人知道我做错了什么吗？

**更新**

错误似乎发生在 max(translationStyleSheet2_.create_date) as y0_ as。当我在 sql 语句中删除 as y0_ 时，我可以运行查询，但是我不确定如何在休眠条件中修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:00:51.757

因此，我没有成功地将其用作条件查询，但我确实成功地将其用作 HQL 查询。

HQL 解决方案

```
this.session.createQuery("from TranslationStyleSheet this "
                + "where this.createDate = (select max(translationStyleSheet2.createDate) "
                + "from TranslationStyleSheet translationStyleSheet2 "
                + "where translationStyleSheet2.fileName=this.fileName)")
                .list(); 
```

我仍然有兴趣让查询作为条件查询工作。

# mongodb - 使用 MongoDB 进行弹性搜索：搜索 PDF

> ID：13122800
> 
> 赞同：0
> 
> 时间：2012-10-29T13:42:33.197
> 
> 标签：mongodb, elasticsearch

我试图将我的 pdf 文件保存在 Mongo Db 的 gridFS 中，然后使用弹性搜索在该 pdf 中进行搜索。我执行了以下操作：

1) Mongo DB 端：

```
mongod --port 27017 --replSet rs0 --dbpath "D:\Mongo-DB\mongodb-win32-i386-2.0.7\data17"
mongod --port 27018 --replSet rs0 --dbpath "D:\Mongo-DB\mongodb-win32-i386-2.0.7\data18"
mongod --port 27019 --replSet rs0 --dbpath "D:\Mongo-DB\mongodb-win32-i386-2.0.7\data19"

mongo localhost:27017
rs.initiate()
rs.add("hostname:27018")
rs.add("hostname:27019")

mongofiles -hlocalhost:27017 --db testmongo --collection files --type application/pdf put D:\Sherlock-Holmes.pdf 
```

2) Elastic Search Side (安装插件: bigdesk/head/mapper-attachments/river-mongodb)

-> 使用来自“任何请求”选项卡的以下请求的弹性搜索头

```
URL : http://localhost:9200/_river/mongodb/
_meta/PUT

{
  "type": "mongodb",
  "mongodb": {
    "db": "testmongo",
    "collection": "fs.files",
    "gridfs": true,
    "contentType": "",
    "content": "base64 /path/filename | perl -pe 's/\n/\\n/g'"
  },
  "index": {
    "name": "testmongo",
    "type": "files",
    "content_type": "application/pdf"
  }
} 
```

现在我正在尝试访问以下 URL：

```
http://localhost:9200/testmongo/files/508e82e21e43def09b5e1602?pretty=true 
```

我得到以下回复（我相信这是预期的）：

```
{
  "_index" : "testmongo",
  "_type" : "files",
  "_id" : "508e82e21e43def09b5e1602",
  "_version" : 1,
  "exists" : true, "_source" : {"_id":"508e82e21e43def09b5e1602","filename":"D:\\Sherlock-Holmes.pdf","chunkSize":262144,"uploadDate":"2012-10-29T13:21:38.969Z","md5":"025fa2046f9254d2aecb9e52ae851065","length":98272,"contentType":"application/pdf"}
} 
```

但是，当我尝试使用以下 URL 搜索此 pdf 时：

```
http://localhost:9200/testmongo/files/_search?q=Albers&pretty=true 
```

它给了我以下结果：

```
{
  "took" : 0,
  "timed_out" : false,
  "_shards" : {
    "total" : 5,
    "successful" : 5,
    "failed" : 0
  },
  "hits" : {
    "total" : 0,
    "max_score" : null,
    "hits" : [ ]
  }
} 
```

在这里，它显示我没有任何命中，但此 pdf 中存在“Albers”一词。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:00:53.203

我认为您必须指定要搜索的属性

```
http://localhost:9200/testmongo/files/_search?q=<PROPERTYNAME>:Albers&pretty=true 
```

甚至用于复杂的搜索

```
$ curl -XPOST 'http://localhost:9200testmongo/files/_search?q' -d '{
    <PROPERTYNAME> : "value",
    <PROPERTYNAME> : {
                          <PROPERTYNAME> : "value",
                          <PROPERTYNAME> : "value"
                     }
}
' 
```

但据我所知，您只能在索引数据后搜索您定义的属性。

# objective-c - 在 iPad 内加载 Flash

> ID：13122801
> 
> 赞同：0
> 
> 时间：2012-10-29T13:42:36.213
> 
> 标签：objective-c, ipad, flash

我有一个站点，用 php 编写，.php 站点内部有很多 swf (flash) 文件，我想在我的 iPad 应用程序中加载我的 php 站点，只需读取 php 站点的地址并加载它safari，我可以在我的 UIWebView 中加载我的 php 站点，但我看不到 flash 部分，

你能给我一些提示来解决我的问题吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:45:07.953

我要让你失望了：iOS 没有播放 Flash 的功能。

对于越狱设备，有[Frash](http://github.com/comex/frash) - 你可以从中获得一些想法。

# android - 如何在 Android 中管理 Pending Intent？

> ID：13122805
> 
> 赞同：2
> 
> 时间：2012-10-29T13:42:47.450
> 
> 标签：android, android-pendingintent

**我的应用程序中有待处理意图**的问题。

我有一个活动，一个有待启动该活动的通知。

当我的应用程序未**显示**（不是前景）时，我向下滚动通知栏并从通知启动我的应用程序。它工作正常。

但是当**我的应用程序处于前台**时，如果用户按下我的通知，我希望该**活动不会再次启动，**因为它已经显示。

**在这种情况下，我不希望我的待定意图启动该活动**。我该怎么做或请给我一些搜索关键词？

# ruby-on-rails-3 - CanCan 能力在应用程序中起作用但在测试中不起作用

> ID：13122807
> 
> 赞同：0
> 
> 时间：2012-10-29T13:42:59.897
> 
> 标签：ruby-on-rails-3, factory-bot, cancan

我的能力.rb 文件中有以下定义：

```
 can :index, Call, :country_id => user.countries 
```

我试图仅索引其 country_id 在当前用户的国家/地区数组中的呼叫。

当我尝试时，这似乎有效：它只向我显示由 current_user 所属的国家/地区标记的呼叫。

但是，我有以下似乎无法通过的测试：

```
 before :each do
    # Users
    @admin = FactoryGirl.create(:user, admin: true)
  end

  it "should show the call index page with just calls that have the same country tags as them" do
    anotheruser1 = FactoryGirl.create(:user)
    anotheruserscall1 = FactoryGirl.create(:call, user_id: anotheruser1.id)
    anotheruser2 = FactoryGirl.create(:user)
    anotheruserscall2 = FactoryGirl.create(:call, user_id: anotheruser2.id)
    @admin.countries << anotheruserscall1.country
    ability = Ability.new(@admin)
    ability.should be_able_to(:index, anotheruserscall1)
    ability.should_not be_able_to(:index, anotheruserscall2)
  end 
```

但我失败了：

```
Failures:

  1) Admin ability should show the call index page with just calls that have the same country tags as them
     Failure/Error: ability.should be_able_to(:index, anotheruserscall1)
       expected to be able to :index #<Call id: 1, subject: "Natus qui fuga ut.", description: "Consequatur aut veritatis earum dolor. Reprehenderi...", from: "2012-10-25 18:43:23", to: "2012-10-25 19:43:23", user_id: 7, status: "Tentative", created_at: "2012-10-29 13:41:07", updated_at: "2012-10-29 13:41:07", expert_id: nil, country_id: 1>
     # ./spec/models/ability_spec.rb:291:in `block (2 levels) in <top (required)>' 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:55:37.387

好的，我通过将详细信息作为块传递来解决此问题，如下所示：

```
 can :index, Call, ["country_id IN (?)", user.countries] do |call|
      user.countries.include?(call.country)
    end 
```

# java - 如何在 Ant echo 中转义特殊字符（在 xml 中无效）？

> ID：13122809
> 
> 赞同：1
> 
> 时间：2012-10-29T13:43:03.710
> 
> 标签：java, ant

我正在尝试在 Ant 中执行此操作：

```
<echo message="&#27;[44;1;37mSuccess!&#27;[m" /> 
```

但它不起作用：

```
BUILD FAILED
./build.xml:92: Character reference "&# 
```

怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T17:44:28.547

XML 内容中的 0x1B 字符无效 ( [Invalid Characters in XML](https://stackoverflow.com/a/5110103/772981) )。所以你需要一些解决方法。我会使用 javascript 解决方案，但我还提供了 2 个额外的解决方案：

## javascript

```
<script language="javascript">
  project.setNewProperty("esc", "\u001b");
</script>
<echo>${esc}</echo> 
```

## native2ascii

如果你想在一个文件中输出，那么你可以先使用 java escape 输出它`\u001b`，然后使用反向[Native2Ascii](http://ant.apache.org/manual/Tasks/native2ascii.html)例程转换它。无论选择何种编码，它总是解码`\u`序列。

```
<echo file="a.enc">\u001b</echo>
<native2ascii includes="a.enc" ext=".txt" dest="${basedir}"
              encoding="iso-8859-1" reverse="true" /> 
```

## 属性文件

最后，您可能在文件中有不幸的字符串常量：

```
<property file="prop.txt" />
<echo>myEsc:${myEsc}</echo> 
```

而`prop.txt`内容是：

```
myEsc=\u001b 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T22:02:37.917

只需使用 CDATA ：

```
<project>

 <echo><![CDATA[
  &#27;[44;1;37mSuccess!&#27;[m
  ]]>
 </echo>

</project> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:53:28.587

& 是 ant 中的一个特殊字符，所以你应该用 ' 替换它

```
<echo message="&amp;#27;[44;1;37mSuccess!&amp;#27;[m" /> 
```

# iphone - iOS：带有按钮图像的导航栏

> ID：13122817
> 
> 赞同：10
> 
> 时间：2012-10-29T13:43:41.867
> 
> 标签：iphone, ios, uinavigationbar

我想在 NavigationBar 的右侧创建一个带有图像作为按钮的 NavigationBar。

像下面的快照

![在此处输入图像描述](../Images/519e2ba26de6ea163b2ee672538c6af4.png)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-29T13:49:59.130

希望这可以帮助

```
viewController.navigationItem.titleView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"yourimage.png"]];
UIBarButtonItem * item = [[UIBarButtonItem alloc] initWithCustomView:[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"yourimage2.jpg"]]];    
viewController.navigationItem.rightBarButtonItem = item; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-29T13:56:08.613

这里的代码，只需从方法调用下面的`viewDidLoad` 方法

```
 - (void)addCustomButtonOnNavBar
  {
   UIBarButtonItem * item1= [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"passImageNmae1"] style:UIBarButtonItemStylePlain target:self action:@selector(yourButtonAction1)];
   UIBarButtonItem * item2= [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"passImageNmae2"] style:UIBarButtonItemStylePlain target:self action:@selector(yourButtonAction2)];
  NSArray * buttonArray =[NSArray arrayWithObjects:item1,item2 ,nil];

   self.navigationItem.rightBarButtonItems =buttonArray;

  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:49:00.973

```
UIView *viewWithButtons = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 44)];
//view customization
UIButton *leftButton = [UIButton buttonWithType:UIButtonTypeCustom];
//Button customiztaion
[viewWithButtons addSubview:leftButton];
UIButton *rightButton = [UIButton buttonWithType:UIButtonTypeCustom];
//Button customiztaion
[viewWithButtons addSubview:rightButton];
self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:viewWithButtons];
[viewWithButtons release]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-01T05:31:11.230

我为此使用了一个类别：

UIBarButtonItem+WithImageOnly.h：

```
#import <UIKit/UIKit.h>

@interface UIBarButtonItem (WithImageOnly)

- (id)initWithImageOnly:(UIImage*)image target:(id)target action:(SEL)action;

@end 
```

UIBarButtonItem+WithImageOnly.m:

```
#import "UIBarButtonItem+WithImageOnly.h"

@implementation UIBarButtonItem (WithImageOnly)

- (id)initWithImageOnly:(UIImage *)image target:(id)target action:(SEL)action {    
    CGRect frame = CGRectMake(0, 0, image.size.width, image.size.height);
    frame = CGRectInset(frame, -5, 0);

    UIButton *button = [[UIButton alloc] initWithFrame:frame];
    [button setImage:image forState:UIControlStateNormal];
    [button addTarget:target action:action forControlEvents:UIControlEventTouchUpInside];

    return [self initWithCustomView:button];
}

@end 
```

用法：

```
UIBarButtonItem *button = [[UIBarButtonItem alloc] initWithImageOnly:[UIImage imageNamed:@"image"] target:self action:@selector(someAction:)] 
```

# java - 如何对 JRebel 进行故障排除？

> ID：13122821
> 
> 赞同：0
> 
> 时间：2012-10-29T13:43:53.270
> 
> 标签：java, jakarta-ee, jboss, jrebel

我在 JBoss 5 上有一个应用程序（一些战争），但它并不总是使用 JRebel 正确部署。有时它有效，有时则无效。JRebel 没有开始的时候我不知道为什么。任何地方都没有错误（在控制台、日志、eclipse 问题等中），并且 JRebel 日志非常神秘，根本没有给出任何提示。经过多次重启、重建、eclipse 刷新并发布到 JBoss：它正在启动并且一切正常。

所以，我的问题是，如何排除 JRebel 的故障？Obvisouly我想有一个更稳定的发展环境。

带有 JRebel 版本 5.1.0 的 Eclipse Helios

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T19:12:23.643

我隶属于 JRebel 团队。通常，[急救指南](http://zeroturnaround.com/software/jrebel/resources/documentation/jrebel-first-aid/)旨在解决诸如“它不起作用”或“为什么它不起作用”之类的问题。但是，根据您的描述，我读到它对您有用，但有时您会遇到意想不到的行为。为此，最好向 JRebel 支持人员询问 - 如果您提供环境和问题的详细描述，他们将能够为您提供可能出现问题的提示。自己阅读 JRebel 日志并没有什么意义。它只对 JRebel 工程师有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T12:58:22.730

我认为在我的情况下，部署错误会使 JRebel 停止（没有任何关于原因的日志记录）。在有效使用 JRebel 之前，我需要在没有 Jrebel 的情况下进行正常部署以解决问题。

顺便说一句，JRebel 是一款出色的产品，可以节省大量时间。

# matlab - 如何通过 GUI 运行 matlab 命令？

> ID：13122824
> 
> 赞同：-1
> 
> 时间：2012-10-29T13:44:12.707
> 
> 标签：matlab, user-interface, matlab-guide

我正在从事模式识别项目，目前处于 GUI 创建阶段。我想要一个按钮，一旦单击按钮就能够执行以下命令：

```
a = imread(image_name);
b = rgb2gray(a);
glcm = graycomatrix(b);
glcm (:); 
```

我可以知道我应该使用什么功能来对按钮进行编程吗？非常感谢您的帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T14:09:56.410

在我看来，您似乎不知道如何制作回调函数。如果您以编程方式构建 GUI，请按照以下步骤操作：

```
% create the button
but = uicontrol(...
    'style', 'pushbutton', ...
    'string', 'my awesome button',...
    'callback', @buttonCallback);  % <--- SET CALLBACK HERE

function buttonCallback(~,~)  % <--- what's called back when pressing the button
    a = imread(image_name);
    b = rgb2gray(a);
    glcm = graycomatrix(b);
    glcm (:); 
end 
```

如何通过 GUIDE 执行此操作类似，并在[此处](http://www.matrixlab-examples.com/callback-function.html)详细概述。

# django - Django 模型 order_by 非数据库字段

> ID：13122826
> 
> 赞同：3
> 
> 时间：2012-10-29T13:44:17.553
> 
> 标签：django, sql-order-by

我有这个模型：

```
class Foo(models.Model):
    foo_id = models.IntegerField()
    foo_old_prize = models.FloatField()
    foo_new_prize = models.FloatField()

def get_dif(self):
    return self.foo_old_prize  - self.foo_new_prize 
```

有什么技巧可以做到这一点`Foo.objects.all().order_by('get_dif')`吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:53:22.583

查看[`extra`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.extra)Django 查询集运算符：

```
q = Foo.objects.extra(select={'dif': 'foo_old_prize - foo_new_prize'})
q = q.extra(order_by = ['dif']) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T13:54:17.330

您可以`extra`为此使用：

```
Foo.objects.extra(
    select={'diff':'foo_old_prize - foo_new_prize'},
    order_by=('diff',)
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:55:04.663

我不确定你能不能那样做。
这是另一种应该有效的方法：

```
objList = Foo.objects.all()
objList.sort(key = get_dif) 
```

# javascript - 如何从单独的 JavaScript 文件中获取会话变量？

> ID：13122827
> 
> 赞同：3
> 
> 时间：2012-10-29T13:44:17.007
> 
> 标签：javascript, asp.net, asp.net-session

我在 GoogleOauth2.js 文件中有简单的代码

```
function storedAccsessToken(token) {
    $.ajax({
        type: "GET",
        url: '<%=HttpContext.Current.Request.ApplicationPath %>/SaveToken.ashx?accToken=' + token,
        dataType: "text",
        complete: function (resp, status) {
            if (status == "success" || status == "notmodified") {
                if (resp.responseText != '');
                alert(resp.responseText);
                window.location = window.location;

            }
        }

    });

} 
```

和

```
function refresh() {
    var akkToken = '<%=Session["googleAccToken"]%>';
    $.ajax({
        url: 'https://www.googleapis.com/oauth2/v1/userinfo?access_token=' + akkToken,
        data: null,
        success: function (resp) {
            user = resp;
            alert(user.name);
        },
        dataType: "jsonp"
    });

} 
```

当我将 js 文件放入 teg 头时

```
<head runat="server">
    <title></title>
    <script type="text/javascript" src="Scripts/jquery-1.8.2.min.js"></script>
    <script src="Scripts/GoogleOauth2.js" type="text/javascript"></script>

</head> 
```

当我开始我的项目并调试 js 时，我看到 <%=Session["googleAccToken"]%> 编译器将其理解为文本，但是当我将 js 代码放在简单之间的 head 标签中时，`<script type="text/javascript"></script>`它工作正常，我在会话中得到了我的价值想知道我可以将此代码保存在单独的文件中并且它工作正常吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T14:14:45.400

您的错误是您已将`<%= %>`javascript`.js`文件包含在内，并且它们未编译以提供您期望的结果 - 它们保持原样。

有两种可能的解决方案。Ether 在 javascript 文件之前包含变量，ether full 将其移动到页面以便`<%= %>`可以编译。例如，您可以这样做：

```
<head runat="server">
    <script type="text/javascript" src="Scripts/jquery-1.8.2.min.js"></script>
    <script>
       var akkToken = '<%=Session["googleAccToken"]%>';
       var UrlTo = '<%=HttpContext.Current.Request.ApplicationPath %>SaveToken.ashx?accToken=';
    </script>
    <script src="Scripts/GoogleOauth2.js" type="text/javascript"></script>
</head> 
```

并`akkToken`从`GoogleOauth2.js`文件中删除，并放在`url:UrlTo + token`另一行也有`<%= %>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T14:12:21.633

这是因为在后一种情况下，javascript 是由 .NET 处理的。当脚本是 .NET 页面的一部分时，`<%= %>`标签将被处理并替换为计算出的任何值。

当脚本是外部文件时，浏览器会单独请求它（甚至在后续页面访问时被浏览器缓存），因此 .NET 不会处理它，从而产生字符串`'<%=Session["googleAccToken"]%>'`.

# c# - 如何总结 TimeSpan 的驻留 GridView

> ID：13122828
> 
> 赞同：-2
> 
> 时间：2012-10-29T13:44:19.280
> 
> 标签：c#, winforms

我无法使用 Array 对时间求和。我在 gridView 中有一个列，它存储了工人的额外时间，我想要总和，想要得到总小时数和分钟数，请问该怎么做？

```
 TimeSpan p = new TimeSpan();
  for ( int i = 0; i < grid_horas.Rows.Count; i++ )
  {

       //TimeSpan t2 = TimeSpan.Parse(grid_horas.Rows[i].Cells[7].Value.ToString());

  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:48:32.470

假设`.Value` *是*一个时间跨度，那么它应该像这样工作：

```
TimeSpan sum = TimeSpan.Zero;
for ( int i = 0; i < grid_horas.Rows.Count; i++ )
{
   sum += (TimeSpan)grid_horas.Rows[i].Cells[7].Value;
}
// now use sum.Hours, sum.TotalHours, sum.Minutes etc 
```

# php - php在我的时区获取日期

> ID：13122838
> 
> 赞同：1
> 
> 时间：2012-10-29T13:45:09.153
> 
> 标签：php, mysql, pdo

我是 php 新手。我能够得到时间，但问题是它在不同的时区。我想要的是在我的时区获得时间。这是我的代码：

```
<?php
date_default_timezone_set('UTC+8');
$mydate=date('h:i A');
?> 
```

上面的代码给了我错误的时间，我的时区是 UTC+8。例如我的时间是晚上 9:00，但上面的代码返回下午 1:00。我该如何解决这个问题？任何帮助将不胜感激。

更新：我现在开始工作了（感谢@enenen）。我的新代码返回我所在地区的正确时区：

```
<?php
date_default_timezone_set('Asia/Manila');
$mydate=date('h:i A');
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:50:31.243

我想你正在寻找

```
date_default_timezone_set('Etc/GMT+8'); 
```

或者

```
date_default_timezone_set('Asia/Manila'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-01T15:32:03.480

date_default_timezone_set('Etc/GMT+8'); 为我工作我来自菲律宾和亚洲/马尼拉不起作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:49:54.783

时区 ID“ `UTC+8`”无效。这是来自`PHP`引擎的通知，如果您的错误报告不包括通知，这就是没有看到它的原因。你应该使用类似' `Asia/Manila`'的东西。[请参阅此处](http://bg2.php.net/manual/en/function.date-default-timezone-set.php)的文档。

# jquery - jquery colorbox图像边框

> ID：13122843
> 
> 赞同：6
> 
> 时间：2012-10-29T13:45:55.067
> 
> 标签：jquery, colorbox

我正在开发一个使用 zenphoto 和 colorbox 插件的网站。两者都很棒，并且让我完成了 99% 的工作。

本页幻灯片的两个小问题..... [http://whatiswordpress.co.uk/rural/dsc_0118.jpg.php](http://whatiswordpress.co.uk/rural/dsc_0118.jpg.php)

1.  我可以删除幻灯片中使用的全尺寸图像周围以及放大照片时的黑色细边框吗？

2.  我可以增加#cboxOverlay 的不透明度吗？我可以加载背景图像，指定颜色，但无论我做什么，不透明度都保持在默认级别 0.8

我认为配置很复杂，因为我缺乏技能，而且我正试图通过我也不是专家的 zenphoto 来管理它。:(

感谢您的关注

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:52:02.803

> 我可以删除幻灯片中使用的全尺寸图像周围以及放大照片时的黑色细边框吗

是的，从 中删除以下行`colorbox.css`：

```
#cboxLoadedContent {
    background: none repeat scroll 0 0 #000000;
    padding: 1px; /* <-- Remove this */
} 
```

* * *

> 我可以增加#cboxOverlay 的不透明度吗？我可以加载背景图像，指定颜色，但无论我做什么，不透明度都保持在默认级别 0.8

`opacity`您可以使用以下设置：

```
$(".colorbox").colorbox({
    inline: true,
    href: "#imagemetadata",
    close: 'close',
    opacity: 1.0
}); 
```

# java - Java 32 位与 PAE 内核 + SO 32 位和 CPF 64 位

> ID：13122845
> 
> 赞同：1
> 
> 时间：2012-10-29T13:45:57.863
> 
> 标签：java, linux-kernel, jvm, cpu-architecture, cpu-speed

我在使用 JBOSS 4.2.3GA 的应用程序中遇到问题。我们有大约 20 个在线用户，通常 cpu 运行到 95%、99%。我们使用 jmeter 和其他测试在应用程序中搜索问题，但没有找到可能导致此问题的点或循环。

我们对负责我的客户数据中心的组织有一个历史性的问题。所以，我开始看它的架构，我在一些网站上读到“32 bits java x 64 bits java”和“32 bits SO vc 64 bits SO”，并提出了一些问题，希望有人能帮助我。

生产机器是 - 1 vCPU Intel Xeon E5506 2.13Ghz 5120Mb RAM 1 HD 80Gb (ark.intel.com/products/37096/Intel-Xeon-Processor-E5506-4M-Cache-2_13-GHz-4_80-GTs-Intel- QPI）-redhat 32 位（内核：2.6.18-274.7.1.el5PAE）-java 32 位。

问题是：

1.  cpu 是 64 位，SO 是 32 位，java 是 32 位。我们会得到一个深思熟虑的值改变 de SO 和 JAVA 到 64 位？
2.  我读到了一些使用带有 PAE 内核的 java 32 位的问题。（https://kb.groundworkopensource.com/display/SUPPORT/Using+the+32-bit+PAE+kernel+can+cause+JAVA+errors）和使用apache服务器的基准测试（http://www.phoronix .com/scan.php?page=article&item=ubuntu_32_pae&num=1)。这会是个问题吗？
3.  jboss的版本老了，换个新版本的jboss会得到一个体贴的价值吗？

如果有人可以帮助我解决我忘记的事情，请说出来:)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:57:54.467

> cpu 是 64 位，SO 是 32 位，java 是 32 位。我们会得到一个深思熟虑的值改变 de SO 和 JAVA 到 64 位？

要使用 64 位处理，您需要

*   支持 64 位的处理器。
*   64 位操作系统
*   一个 64 位的 JVM。

在您的情况下，您需要升级您的操作系统和 JVM。

我怀疑您的生产应用程序正在做一些您没有测试的事情。我建议您在生产中分析您的应用程序，以找出您没有测试的内容。

> jboss的版本老了，换个新版本的jboss会得到一个体贴的价值吗？

如果您的分析指出 JBoss 的性能瓶颈，升级它可能会有所帮助。否则，我会假设它是您的应用程序。

# c - 对齐宏内核

> ID：13122846
> 
> 赞同：16
> 
> 时间：2012-10-29T13:46:00.180
> 
> 标签：c, linux, linux-kernel, operators, bitwise-operators

我无法理解这个宏的作用。这些是定义的，`linux-kernel`但我的怀疑与此无关。我无法理解`(((x)+(mask))&~(mask))`line 的作用。

```
#define ALIGN(x,a)              __ALIGN_MASK(x,(typeof(x))(a)-1)
#define __ALIGN_MASK(x,mask)    (((x)+(mask))&~(mask)) 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-29T14:18:38.230

假设你有一个号码：`0x1006`

由于某些原因，您希望将其与`4`字节边界对齐。

使用 4 字节边界，您知道对齐的值是`0x1000`、`0x1004`、`0x1008`等。然后您还知道对齐的值`0x1006`是`0x1008`。

你会怎么得到`0x1008`？对齐值的对齐掩码`4`是`(4 - 1) = 0x03`

现在`0x1006 + 0x03 = 0x1009`和`0x1009 & ~0x03 = 0x1008`

这个操作就是 `__ALIGN_MASK`宏。

如果你想传递值`4`（对齐）而不是直接`0x03`（对齐掩码），你有`ALIGN`宏

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-29T13:53:54.337

```
#define ALIGN(x,a)              __ALIGN_MASK(x,(typeof(x))(a)-1) 
```

对齐方式 ,`a`被强制转换为`x`'s 类型，然后减去一个。对齐应该是 2 的幂，因此会产生一些' 类型的位模式`00..011..11`，即掩码（如果 1s ）。`x``k``a = 2^k`

然后

```
#define __ALIGN_MASK(x,mask)    (((x)+(mask))&~(mask)) 
```

将掩码的值添加到`x`，因此`(x)+ (mask)`至少与不小于`x`和小于下一个较大倍数的对齐的最小倍数一样大。然后按位和掩码的补码将该数字减少到对齐的倍数。

对于形式`2^k - 1`的掩码，计算

```
(x + mask) & ~mask 
```

是相同的

```
(x + 2^k - 1) - ((x + 2^k - 1) % (2^k)) 
```

或者

```
((x + 2^k - 1)/(2^k)) * (2^k) 
```

# c++ - 如何使用 QtCreator 检测 Qt Windows 桌面应用程序的内存泄漏

> ID：13122851
> 
> 赞同：1
> 
> 时间：2012-10-29T13:46:14.677
> 
> 标签：c++, windows, qt, memory, memory-leaks

> **可能重复：**
> [在 Windows 上使用 QT 和 MinGW32 进行内存泄漏检查](https://stackoverflow.com/questions/4527325/memory-leak-checking-on-windows-with-qt-and-mingw32)

我一直在寻找解决这个问题的方法，但一直没有找到任何东西。我需要能够检测我在 QtCreator 中开发的 Qt 应用程序中的小内存泄漏。[这个问题](https://stackoverflow.com/questions/6825376/how-to-detect-memory-leaks-in-qtcreator-on-windows)讨论了在 Qt 应用程序中检测 Qt 内存泄漏，但不是通过 QtCreator。我会在 linux 机器上运行我的应用程序并使用 Valgrind，但我有一些 Windows 特定的东西，所以它不是完全可移植的。任何人都可以帮忙吗？

谢谢

# html - 你如何制作 header-side-mainlayout

> ID：13122856
> 
> 赞同：0
> 
> 时间：2012-10-29T13:46:29.030
> 
> 标签：html, css

我想知道你们如何在 html 中制作页眉侧主页脚布局。

像这样：

```
<html>
  <div class="header"></div>
  <div class="content">
    <div class="side"></div>
    <div class="main"></div>
  </div>
  <div class="footer"></div>
</html> 
```

`div.header`和`div.footer`具有固定的高度。并且`div.content`将保持所有剩余高度，身体没有滚动条。

并且`div.side`将具有固定宽度，并且`div.main`将保持所有其余宽度。

`div.side`可以有 y 滚动条。

当窗口调整大小时，`div.content`会展开固定高度，没有滚动条。

顺便说一句，有时`div.side`和`div.main`可能会像这样交换位置：

```
<html>
  <div class="header"></div>
  <div class="content">
    <div class="main"></div>
    <div class="side"></div>
  </div>
  <div class="footer"></div>
</html> 
```

你怎么做到的？

更新：

div.main 不能设置为溢出：隐藏，因为它是我用来创建地图的容器。

```
var map=new google.maps.Map('main',{}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:57:43.283

这就是我在 html 中的做法，我会在它周围添加一个包装器以使居中变得容易，但这只是我。我认为您想了解 css，老实说，有很多方法可以解决这个问题，简单的是：

```
.header {
    width:whateverpx;
    margin:0 auto;
}
.content {
    width:100%;
    position:relative;
}
.content:after {
    clear:both;
    content:"";
    display:none;
}
.side {
    float:left;
    position:relative;
    width: your width for it;
}
.main {
    float:left;
    position:relative;
}
.footer {
    height: whateverpx;
    width: whateverpx;
    margin:0 auto;
} 
```

并且，如果您希望内容居中，请在其周围添加一个包装器并添加

```
.wrapper {
    width:whatever;
    marging:0 auto;
} 
```

或者

没有包装器，而是为 .content 执行此操作

```
.content {
    width: whatever
    margin:0 auto;
    position:relative;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:54:49.170

给`div.side`一个高度和宽度，然后`overflow:scroll` 喜欢：

```
div.side{
height:60%;
width: 60%;
overflow: scroll;
} 
```

和`div.content` `overflow:hidden`

# ruby - UDP 套接字和红宝石

> ID：13122858
> 
> 赞同：1
> 
> 时间：2012-10-29T13:46:40.787
> 
> 标签：ruby, http

我无法绑定到服务器地址。我有一个到服务器的连接（使用 Savon XML 库）。现在我只需要监听那个服务器并收集它发送的 HTTP 数据包。服务器每次发送：

```
http://200.34.12.168/Videos/1/frame/0
http://200.34.12.168/Videos/1/frame/1
http://200.34.12.168/Videos/1/frame/2
http://200.34.12.168/Videos/1/frame/3
http://200.34.12.168/Videos/1/frame/4
...
.. 
```

这是HTTP数据包。我正在尝试创建一个侦听这些的 UDP 服务器。这是我到目前为止所拥有的：

```
 s = UDPSocket.new
  s.bind('200.34.12.168', 80)

  5.times do
    text, sender = s.recvfrom(16)
    puts text
  end 
```

它在绑定功能上失败。如何使用 ruby​​ 监听 UDP 连接？

我得到的错误：“`bind'：无法分配请求的地址 - bind(2) (Errno::EADDRNOTAVAIL)”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:12:41.600

您是否正在运行 Web 浏览器 - 它可能已经绑定到端口 80..

# java - readInt() 如何在 Android 中工作？

> ID：13122859
> 
> 赞同：2
> 
> 时间：2012-10-29T13:46:46.327
> 
> 标签：java, android, stream, android-networking

我对网络编程很陌生。

我在一个线程中运行以下源代码。从我正在关闭的其他线程`istream`中，`ostream`并且`socket`，但仍然没有`IOException`从下面的代码中打印出来。我在 Android 手机上运行此代码。在某些 Android 手机上，该行为是正确的并且正在打印`IOException`，而在其他手机上则没有打印。

我真的很想知道`readInt()`真正的工作原理。某些手机​​不打印 IOException 可能有什么问题？

```
while(true){
try {
int readInt=istream.readInt();
}
catch(IOException e){
Log.i("Sample","IOException");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:52:02.957

您可以阅读 readInt() 的源代码以了解它的实际作用。如果您尝试读取流的末尾之外的内容，则应该始终收到 EOFException。

如果您要从另一个线程关闭线程。VM 应该触发 SocketClosedException，但某些 Android 手机可能不支持这种行为。

# linux - 在隔离的 Unix 环境中执行终端命令

> ID：13122860
> 
> 赞同：0
> 
> 时间：2012-10-29T13:46:53.143
> 
> 标签：linux, bash, web-applications, chroot, lxc

我正在编写一个 web 应用程序，用户可以在其中在服务器上执行 git、bzr 和 hg 命令。基本上，用户将 git/bzr/hg 命令写入 html 表单，点击按钮，命令被发送到服务器，并在用户拥有的目录中执行。

我怎样才能保证这个安全？我需要能够执行只能访问和更改一个特定目录的 bash 命令。最好是，执行命令的目录不应包含其他文件。我认为这对于 chroot 是必要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:33:32.960

与用户输入一样，在将其进一步传递给任何命令之前对其进行检查。

*   它是有效的 git/bzr/hg 子命令吗
*   是否有带有附加无关命令的分号
*   ...

您可以尝试在受限 shell ( `bash -r`) 中运行命令，这会阻止一些事情。

更安全但更复杂的解决方案当然是`chroot`虚拟机，甚至更好。

# mysql - Hibernate JPA+mysql：无法在 createNativeQuery 中禁用缓存

> ID：13122861
> 
> 赞同：4
> 
> 时间：2012-10-29T13:46:56.623
> 
> 标签：mysql, hibernate, caching, jpa

我将 Hibernate/JPA 与 mySQL 一起使用，并且由于遗留原因，在某一时刻 createNativeQuery。该应用程序与使用相同数据库的不同服务器一起工作，因此它根本不应该进行缓存，但始终显示最新结果。我通过在数据库编辑器中手动更改值来模拟其他服务器，但更改后它总是给出旧结果。

据我所知，我应该禁用任何二级缓存（不是很重要，因为我不使用任何 ORM 对象）， clear() 任何一级缓存，并禁用 mysql 查询缓存（已经在数据库级别完成）。我在哪里失败，或者我忘记了什么？它让我疯狂。

init(): servlet 的开始

```
 entityFactory = Persistence.createEntityManagerFactory("persistence-id"); 
```

getEntityManager()：每个请求的开始

```
 destroyEntityManager(); // just in case
    entityFactory.getCache().evictAll();
    entityManager = entityFactory.createEntityManager();
    entityManager.setProperty("javax.persistence.cache.storeMode",
            CacheStoreMode.BYPASS);
    entityManager.clear(); // just in case 
```

destroyEntityManager()：每次请求结束

```
 if (entityManager != null) {
        if (entityManager.getTransaction().isActive()) {
            entityManager.flush();
            entityManager.getTransaction().commit();
        }
        entityManager.clear();
        if (entityManager.isOpen()) {
            entityManager.close();
        }
        entityManager = null;
    } 
```

destroy(): servlet 结束

```
 destroyEntityManager();
    if (entityFactory != null) {
        entityFactory.close();
    } 
```

持久性.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">
<persistence-unit name="WallMountBackOffice-PU">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <class>...</class>
    <class>...</class>
    <properties>
        <property name="hibernate.connection.driver_class" value="com.mysql.jdbc.Driver" />
        <property name="hibernate.connection.url" value="jdbc:mysql://localhost/ourschema" />
        <property name="hibernate.connection.username" value="root" />
        <property name="hibernate.connection.password" value="" />
        <property name="hibernate.connection.pool_size" value="10" />
        <property name="hibernate.connection.autocommit" value="false" />
        <property name="hibernate.connection.release_mode" value="on_close" />
        <property name="dialect" value="org.hibernate.dialect.MySQLDialect" />
        <property name="hibernate.cache.use_second_level_cache"
            value="false" />
        <property name="hibernate.cache.use_query_cache" value="false" />
        <property name="javax.persistence.sharedCache.mode" value="NONE" />
        <property name="org.hibernate.cacheable" value="false" />
    </properties>
</persistence-unit> 
```

执行“选择...”的代码：

```
 ...
    Query jpaQuery = entityManager.createQuery(query);
    entityManager.getTransaction().begin();
    jpaQuery.executeUpdate();
    entityManager.getTransaction().commit(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-09T09:59:56.527

第一行有一个错误，一定是“BYPASS”而不是“REFRESH”，如下：

```
query.setHint("javax.persistence.cache.retrieveMode", "BYPASS"); 
```

并且建议使用 JPA 枚举而不是字符串文字，因此它将是：

```
query.setHint(QueryHints.CACHE_RETRIEVE_MODE, CacheRetrieveMode.BYPASS);
query.setHint(QueryHints.CACHE_STORE_MODE, CacheStoreMode.REFRESH); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T17:52:57.080

您可以使用`setHint()` `storeMode`或`retrieveMode`方法。如果您尝试检索记录，请使用`retrieveMode`with `BYPASS`。

对于休眠

```
query.setHint("javax.persistence.cache.storeMode", "REFRESH");

query.setHint("javax.persistence.cache.retrieveMode", "REFRESH"); 
```

对于 EclipseLink。

```
query.setHint("javax.persistence.cache.storeMode", "REFRESH"); 

query.setHint("javax.persistence.cache.retrieveMode", "REFRESH"); 
```

JPA 2.0 规范

```
public enum CacheRetrieveMode {

    /**
     * Read entity data from the cache: this is
     * the default behavior.
     */
    USE,

    /**
     * Bypass the cache: get data directly from
     * the database.
     */
    BYPASS
}

public enum CacheStoreMode {

    /**
     * Insert/update entity data into cache when read
     * from database and when committed into database:
     * this is the default behavior. Does not force refresh
     * of already cached items when reading from database.
     */
    USE,

    /**
     * Don't insert into cache.
     */
    BYPASS,

    /**
     * Insert/update entity data into cache when read
     * from database and when committed into database:
     * Forces refresh of cache for items read from database.
     */
    REFRESH
} 
```

# postgresql - 另一个存储过程语法错误 - IF-THEN-ELSE

> ID：13122862
> 
> 赞同：5
> 
> 时间：2012-10-29T13:46:58.137
> 
> 标签：postgresql, stored-procedures, triggers, syntax-error, plpgsql

使用 postgresql 8.4，我正在尝试编写一个函数，它看起来像这样：

```
CREATE OR REPLACE FUNCTION addorupdate( smallint, varchar(7) ) RETURNS void AS
$$
BEGIN
 IF EXISTS (SELECT * FROM consist WHERE slave = $1) THEN
   UPDATE consist SET
    master = $2
    where slave = $1;
 ELSE
   INSERT INTO consist(slave, master) VALUES ( $2, $1 );
 END IF;
END;
$$
LANGUAGE SQL; 
```

但是，它会像这样失败：

```
ERROR:  syntax error at or near "IF"
LINE 4:  IF EXISTS (SELECT * FROM consist WHERE slave = $1) THEN 
```

...而且我一直在浪费太多时间和咖啡因来找出原因，并且可以使用具有新眼光的人来帮助我。

如果不清楚我要达到的目标：奴隶是一列唯一值。如果存在，请使用当前主服务器对其进行更新。如果没有，请插入。

**更新：** 将语言更改为 plpgsql，现在抛出：

```
ERROR:  language "plpgsql" does not exist 
```

**更新：**

```
CREATE LANGUAGE plpgsql; 
```

**（： 解决 ：）**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T13:48:20.853

您的语言必须`plpgsql`不是`sql`.

# android - GreenDAO QueryBuilder 动态添加条件

> ID：13122872
> 
> 赞同：2
> 
> 时间：2012-10-29T13:47:51.613
> 
> 标签：android, sqlite, greendao

我目前有一个 userId 列表，我正在尝试创建一个查询以从我的数据库中获取所有这些。

这就是我的想法，我只是不确定它是否可能：

```
ArrayList<Users> listOfUsers = getCurrentUsers(); 
// lets assume that by now I have a list of users
QueryBuilder<Users> qb = getUsersDao().queryBuilder();
for(Users usr : listOfUsers) {
    qb.where(Properties.userId.eq(usr.getUserId());
}
List result = qb.list(); 
```

我还没有看到任何关于这样做的正确方法的文档，我想知道这是否是在 GreenDAO 中创建动态查询的正确方法。

***编辑：***

我试过这个，结果是`NullPointerException`在声明的行中`QueryBuilder`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T08:24:01.593

尝试改用`IN`查询，它会运行得更快+您可以缓存您的查询对象。所以可以说你有

```
List<String> userIds; 
```

您可以通过以下方式获取列表：

```
qb.where(Properties.UserId.in(userIds)) 
```

如果这是您经常执行的操作，最好将 Query 缓存起来。为此，只需按如下方式准备一次查询：

```
Query<User> query = qb.where(Properties.UserId.in("?")).build(); 
```

然后当你需要运行它时：

```
query.setParameter(0, userIds);
return query.list(); 
```

# javascript - img 标签是否向服务器发出异步请求？

> ID：13122873
> 
> 赞同：0
> 
> 时间：2012-10-29T13:47:58.930
> 
> 标签：javascript, html

如果在呈现页面后我从 javascript 更改 img 标签的 src，例如：

```
function changeImage(){
  img.src = 'getImage?imgId=232132'; //getImage is calling doGet() Method of Servlet   with  response content type "image/jpeg"
} 
```

这是进行异步调用并加载图像吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:49:19.820

是的。由 DOM 修改触发的内容加载不会阻塞 JavaScript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T13:49:51.577

是的，调用是异步的，除非它不是真正的远程调用，因为图像在缓存中（在这种情况下，图像将在脚本的下一行执行之前加载）。

如果您想在完成时收到通知，请执行以下操作：

```
img.onload = function(){alert('loaded!')};
img.src = 'getImage?imgId=232132'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T13:59:40.383

最简单的答案是肯定的，它将异步发生。但是，还有更多内容。

这个想法是，您在 javascript 期间所做的只是修改它应该显示的页面的模型 (DOM)。浏览器必须确保页面是根据模型中的新规范呈现的，基本上，在这种情况下，包括下载图像。但是，您的浏览器执行此渲染的方式由浏览器决定，尽管它不应该阻止您的 javascript。

事实上，我看到许多主要浏览器处理您所描述的情况的方式是确实会有对图像的异步请求，但直到您的 javascript 完成运行之后。换句话说，如果你用一个忙碌的等待（`while (true) {}`）来跟进它，图像根本不会被加载。但是，如果您要在更改`src`对于图像，页面会解释新的 src 并完成对图像的异步请求，但不能保证图像在第二秒过去时是否已经完成加载。但是，其他浏览器可能会以不同的方式执行此操作，最好不要依赖除您知道是正确的行为之外的任何行为（它不会阻止您的 javascript，并且如果您想在完成加载后做某事，您甚至应该使用适当的 DOM）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-29T14:01:49.010

请设置您的文件头。如果你使用 php，试试这个：

```
<?php
header("Content-type: image/jpeg");
?> 
```

祝你好运

# silverlight - Silverlight 5 客户端访问策略.xml

> ID：13122875
> 
> 赞同：2
> 
> 时间：2012-10-29T13:48:03.970
> 
> 标签：silverlight, iis-6, clientaccesspolicy.xml

我有一个 Silverlight 5 应用程序，它通过 HTTPS 在通过 IIS 6 托管的单独域（服务器）上（例如 mydomain.com/service.svc）向 WCF 数据服务发出请求。

silverlight 应用程序收到 SecurityException，我认为这与找不到正确的 clientaccesspolicy.xml 文件有关。我在 mydomain.com 的 wwwroot 文件夹中定义了一个 clientaccesspolicy.xml 文件，看起来像

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="*">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

奇怪的是，在查看 Fiddler 流量时，从未尝试过对 mydomain.com/clientaccesspolicy.xml 的请求。

另一件事是 clientaccesspolicy.xml 仅通过 https 提供服务（该服务器上的 IIS 设置仅允许 ssl/tls 连接），这可能是问题的一部分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:34:38.117

您可以尝试在您的允许来源中明确添加 https://：

```
<allow-from http-request-headers="*">
  <domain uri="http://*"/>
  <domain uri="https://*" />
</allow-from> 
```

我假设当您尝试直接点击文件时，您会看到它（IIS 实际上正在为它提供服务）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T15:19:55.593

试试这个：

```
<allow-from http-request-headers="*">
  <domain uri="*"/>
  <domain uri="https://*" />
</allow-from> 
```

# c# - 用属性声明一个类并同时填充这些属性的最佳方法是什么

> ID：13122877
> 
> 赞同：2
> 
> 时间：2012-10-29T13:48:12.707
> 
> 标签：c#, asp.net, asp.net-mvc-3, class, properties

以下是模型中代码的示例

```
public static class SomeClass
{
    // Description 
    public const string String1 = "String One"
    public const string String2 = "String Two";
    public const string String3 = " String Three";
    public const string String4 = " String Four";

    // Position
    public const int String1Position = 0;
    public const int String2Position = 1;
    public const int String3Position = 2;
    public const int String4Position = 3;

    // Filter Ranges
    public const int String2Minimum = 0100;
    public const int String2Maximum = 0199;

    public const int String3Minimum = 1000;
    public const int String3Maximum = 1099;

    public const int String4Unknown = 9999;

    private class SomeClassData
    {
        public string Description { get; set; }
        public int Position { get; set; }
        public int FilterMinimum { get; set; }
        public int FilterMaximum { get; set; }
    }
} 
```

我希望能够为每个不同的描述、位置和过滤器范围填充此类的属性，其中描述、位置和过滤器都相互关联。

```
SomeClassData.Description = "String Two";
SomeClassData.Position = 1;
SomeClassData.String2Minimum = 0100;
SomeClassData.String2Maximum = 0199; 
```

在控制器中使用了描述和位置，以便能够为视图提供属性以使用 Javascript/JQuery 填充下拉框。控制器将使用过滤器范围，以便能够从下拉框中接受位置值作为 ActionResult 的参数，以生成 linq 查询以从数据库中取回数据。

我开始认为最好的方法是为每种不同类型填充一个列表，然后将每个列表一起使用，但是尝试将列表正确链接在一起会变得混乱。我有这种感觉，我可能需要在对象填充 SomeClassData 的地方使用 a`Dictionary<string, object>`或 a 。`Dictionary<int, object>`不知道我是否在这一点上偏离了这个想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:57:06.790

是的，您可以使用`Dictionary<string,SomeClassData>`

```
var col = Dictionary<string, SomeClassData>
{
    { "Desc1", new SomeClassData{Position =1, String2Minimum =0100, String2Maximum = 0199}},
    { "Desc2", new SomeClassData{Position =1, String2Minimum =0100, String2Maximum = 0199}},
    ....
}; 
```

`Select` `Linq operator`

```
var fix = from entry in col 
          where entry.Key == "Desc1"
          select new entry.Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:55:11.963

您必须创建您调用的类的列表`SomeClassData`。每个元素都将具有相应的一组值。

# sql-server - sql server 分析服务的cube数据存储的数据结构是什么？

> ID：13122878
> 
> 赞同：2
> 
> 时间：2012-10-29T13:48:12.847
> 
> 标签：sql-server, data-structures, ssas, cube

我想知道用于存储多维数据集的数据结构是什么以及从中读取数据的机制是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:22:04.150

总的来说，这是一个相当复杂的答案。有关 SSAS 如何构建其数据的详细信息，我推荐《Microsoft SQL Server 2008 Analysis Services Unleashed (Paperback)》一书。它包含许多关于 SSAS 用于构建其数据的各种存储的详细信息。这不适合胆小的人，所以要为许多令人讨厌的细节做好准备:-)

话虽如此，基础是： - SSAS 的数据结构涉及围绕创建许多文件的专有架构。主要是每个分区的 *.data 文件并包含数据本身 - 还有许多索引、映射和聚合文件，允许 SSAS 查询数据聚合而不是直接扫描数据文件 - 还有标题(vs 数据) 文件为这些文件类型中的每一个。这些包含有关这些文件中存在的内容的元数据。

# performance - 在 R 中更快地实现 merge.data.frame()

> ID：13122882
> 
> 赞同：0
> 
> 时间：2012-10-29T13:48:39.173
> 
> 标签：performance, r, dataframe

假设`a`和`b`是两个数据帧。目标是编写一个 `f(a,b)`生成合并数据帧的函数，与合并的方式相同 `merge(a,b,all=TRUE)`，即在 NA 中`a`或`b`用 NA 填充缺失的变量。（问题`merge()`似乎很慢。）

这可以按如下方式完成（伪代码）：

```
for each variable `var` found in either `a` or `b`, do:
    unlist(list(a.srcvar, b.srcvar), recursive=FALSE, use.names=FALSE)

where:
x.srcvar is x$var if x$var exists, or else
            rep(NA, nrow(x)) if y$var !is.factor, or else
            as.factor(rep(NA, nrow(x))) 
```

然后将所有内容包装在数据框中。

这是一个“天真的”实现：

```
merge.datasets1 <- function(a, b) {
  a.fill <- rep(NA, nrow(a))
  b.fill <- rep(NA, nrow(b))
  a.fill.factor <- as.factor(a.fill)
  b.fill.factor <- as.factor(b.fill)
  out <- list()
  for (v in union(names(a), names(b))) {
    if (!v %in% names(a)) {
      b.srcvar <- b[[v]]
      if (is.factor(b.srcvar))
        a.srcvar <- a.fill.factor
      else
        a.srcvar <- a.fill
    } else {
      a.srcvar <- a[[v]]
      if (v %in% names(b))
        b.srcvar <- b[[v]]
      else if (is.factor(a.srcvar))
        b.srcvar <- b.fill.factor
      else
        b.srcvar <- b.fill
    }
    out[[v]] <- unlist(list(a.srcvar, b.srcvar),
                       recursive=FALSE, use.names=FALSE)
  }
  data.frame(out)
} 
```

这是使用“矢量化”函数的不同实现：

```
merge.datasets2 <- function(a, b) {
  srcvar <- within(list(var=union(names(a), names(b))), {
    a.exists <- var %in% names(a)
    b.exists <- var %in% names(b)
    a.isfactor <- unlist(lapply(var, function(v) is.factor(a[[v]])))
    b.isfactor <- unlist(lapply(var, function(v) is.factor(b[[v]])))
    a <- ifelse(a.exists, var, ifelse(b.isfactor, 'fill.factor', 'fill'))
    b <- ifelse(b.exists, var, ifelse(a.isfactor, 'fill.factor', 'fill'))
  })
  a <- within(a, {
    fill <- NA
    fill.factor <- factor(fill)
  })
  b <- within(b, {
    fill <- NA
    fill.factor <- factor(fill)
  })
  out <- mapply(function(x,y) unlist(list(a[[x]], b[[y]]),
                                     recursive=FALSE, use.names=FALSE),
                srcvar$a, srcvar$b, SIMPLIFY=FALSE, USE.NAMES=FALSE)
  out <- data.frame(out)
  names(out) <- srcvar$var
  out
} 
```

现在我们可以测试：

```
sample.datasets <- lapply(1:50, function(i) iris[,sample(names(iris), 4)])

system.time(invisible(Reduce(merge.datasets1, sample.datasets)))
>>   user  system elapsed 
>>  0.192   0.000   0.190 
system.time(invisible(Reduce(merge.datasets2, sample.datasets)))
>>   user  system elapsed 
>>  2.292   0.000   2.293 
```

因此，天真的版本比其他版本快几个数量级。怎么会这样？我一直认为`for`循环很慢，应该使用`lapply`和朋友并避开 R 中的循环。我欢迎任何关于如何在速度方面改进我的功能的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T00:07:02.077

事实上，您根本没有尝试复制`merge(a,b, all = TRUE)`，因为您没有尝试合并任何列。`NA`相反，您只是堆叠数据，在不存在列的地方填充。

```
 # note  that this is not what you want/
dim(merge(sample.datasets[[1]], sample.datasets[[2]], all = T))
 [1] 314   5 
```

慢的原因`merge(a,b, all = TRUE)`是它默认通过名称的交集进行合并。如果您转换为，`data.tables`那么该`merge.data.table`方法速度很快，但是对于您的测试数据，它将在每次连续合并上创建一个呈指数增长的数据集（而不是您希望结果的 7500 x 5）

一个简单的解决方案是`rbind.fill`从`plyr`包装中使用。

```
library(plyr)
system.time({.x <- Reduce(rbind.fill, sample.datasets)})
## user  system elapsed 
## 0.16    0.00    0.15 
# which is almost identical to
system.time(.old <- Reduce(merge.datasets1, sample.datasets))
##   user  system elapsed 
##   0.14    0.00    0.14 
```

# 编辑 2-11-2012

进一步考虑，请注意您可以将列表传递`data.frames`给`rbind.fill`so

```
 system.time(super_fast <- rbind.fill(sample.datasets))
 ##  user  system elapsed 
 ##  0.02    0.00    0.02 

identical(super_fast, .old)
[1] TRUE 
```

大部分时间花在开销上`Reduce`，这`rbind.fill`并不需要。

# android - 如何从 json 数组中获取 JSONObject

> ID：13122884
> 
> 赞同：-1
> 
> 时间：2012-10-29T13:48:45.607
> 
> 标签：android, arrays, json

我是 android 编程新手，我想知道如何从 JSONarray 获取某个对象。

我的 JSON 看起来像这样：

```
{"results" : [
  {
     "address_components" : [
        {
           "long_name" : "Contern",
           "short_name" : "Contern",
           "types" : [ "locality", "political" ]
        },

        {
           "long_name" : "Luxembourg",
           "short_name" : "Luxembourg",
           "types" : [ "administrative_area_level_1", "political" ]
        },

        {
           "long_name" : "Luxembourg",
           "short_name" : "LU",
           "types" : [ "country", "political" ]
        }
     ],

     "formatted_address" : "Contern, Luxembourg",

     "geometry" : {
        "bounds" : {
           "northeast" : {
              "lat" : 49.621830,
              "lng" : 6.302790
           },

           "southwest" : {
              "lat" : 49.56759010,
              "lng" : 6.195380
           }
        },

        "location" : {
           "lat" : 49.58515930,
           "lng" : 6.2274880
        }, 
```

我想从位置中提取经纬度和经度。我的代码是：

```
arr = json.getJSONArray("results");
        JSONObject location=arr.getJSONObject(4);
        double lng = location.getDouble("lng");
        double lat = location.getDouble("lat"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T14:10:19.603

我想说你的 json 文件是错误的，但仔细观察后我认为你的代码很糟糕 :) 我想它现在没有给你想要的东西。在这种情况下，“结果”是 JsonArray - 但是一个完整的 JsonObjects 数组，而不是它的属性！完整的 JsonObject 是具有地址组件、格式地址、几何等的对象。“位置”也是“几何”对象的一部分。

当您确定“结果”数组中只有一个对象时 - 您可以执行以下操作：

```
arr = json.getJSONArray("results");
if (arr.length() > 0){
   JSONObject resultObject = arr.getJSONObject(0);
   JSONObject geometry = resultObject.getJSONObject("geometry");
   JSONObject location = geometry.getJSONObject("location");
   double lng = location.getDouble("lng");
   double lat = location.getDouble("lat");
} 
```

当结果中有超过 1 个对象时 - 我想你需要遍历它们并找到你需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:54:33.593

你好参考下面的代码

JSON字符串

```
{
"result": "success",
"countryCodeList":
[
  {"countryCode":"00","countryName":"World Wide"},
  {"countryCode":"kr","countryName":"Korea"}
] 
} 
```

下面我正在获取国家/地区详细信息

```
JSONObject json = new JSONObject(jsonstring);
JSONArray nameArray = json.names();
JSONArray valArray = json.toJSONArray(nameArray);

JSONArray valArray1 = valArray.getJSONArray(1);

valArray1.toString().replace("[", "");
valArray1.toString().replace("]", "");

int len = valArray1.length();

for (int i = 0; i < valArray1.length(); i++) {

 Country country = new Country();
 JSONObject arr = valArray1.getJSONObject(i);
 country.setCountryCode(arr.getString("countryCode"));                        
 country.setCountryName(arr.getString("countryName"));
 arrCountries.add(country);
} 
```

# c# - 互操作字退出时关闭 winform 应用程序

> ID：13122887
> 
> 赞同：0
> 
> 时间：2012-10-29T13:48:55.210
> 
> 标签：c#, winforms-interop

我正在开发一个 winform 应用程序，每次按下按钮时都会打开一个新的 word 文档并关闭旧的。问题是：如果用户关闭 MS Word 应用程序而不是文档，如何让 winform 应用程序退出？我试过`word_DocumentBeforeClose()`了，但是当 word 应用程序或 word 文档关闭时会发生这种情况。

这是我正在使用的代码：

```
wordDocument.Close(Microsoft.Office.Interop.Word.WdSaveOptions.wdDoNotSaveChanges); 
word.DocumentBeforeClose += new ApplicationEvents4_DocumentBeforeCloseEventHandler(word_DocumentBeforeClose);
wordDocument = word.Documents.Open(FileName); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T16:15:31.830

您是否尝试过关注[`word.Quit`](http://msdn.microsoft.com/zh-tw/library/microsoft.office.interop.word.applicationevents2_event.quit.aspx)事件？

# visio - 在 C# 中将 Visio DataGraphic 添加到形状

> ID：13122889
> 
> 赞同：2
> 
> 时间：2012-10-29T13:48:59.943
> 
> 标签：visio

我需要使用 C# 将标志图标集 DataGraphic 添加到 Visio 2010 形状。我正在使用嵌入式 Visio 绘图控件，这一切都必须通过代码完成。

我在这方面遇到了很多困难，而且我在 Visio 本身中使用 Macro-Recorder 的常用策略在这里不起作用（我认为这可能是因为此功能是由加载项提供的）。

任何指针将不胜感激。

杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T17:22:12.557

请参阅[关于以图形方式显示数据 (Visio)](http://msdn.microsoft.com/en-us/library/office/ff766215.aspx)。

# ios - 使用 CFNetwork 从受密码保护的 FTP 服务器下载

> ID：13122901
> 
> 赞同：1
> 
> 时间：2012-10-29T13:49:20.807
> 
> 标签：ios, xcode

我正在制作一个可以从受用户名和密码文件保护的 FTP 服务器下载并将其保存在文档目录中的应用程序。我已经设法直接从 HTTP 下载文件，保存并显示它。现在我希望通过 FTP 这样做。这是我的代码：

```
-(IBAction)download:(id)sender
{
NSString *stringURL = @"http://www.image.png";
NSURL  *url = [NSURL URLWithString:stringURL];
NSData *urlData = [NSData dataWithContentsOfURL:url];
if ( urlData )
{
    NSArray   *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString  *documentsDirectory = [paths objectAtIndex:0];
    NSString  *filePath = [NSString stringWithFormat:@"%@/%@", documentsDirectory,@"filename3.png"];

    [urlData writeToFile:filePath atomically:YES];
}

}

-(IBAction)viewImage:(id)sender
{
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *getImagePath = [documentsDirectory stringByAppendingPathComponent:@"filename3.png"];
UIImage *img = [UIImage imageWithContentsOfFile:getImagePath];

[imageV setImage:img];
} 
```

谁能指点我CFNetwork的例子。我需要连接到 ftp 服务器，列出文件夹中的文件并下载它们。已经看过[http://developer.apple.com/library/ios/#Documentation/Networking/Conceptual/CFNetwork/CFFTPTasks/CFFTPTasks.html#//apple_ref/doc/uid/TP30001132-CH9-SW1](http://developer.apple.com/library/ios/#Documentation/Networking/Conceptual/CFNetwork/CFFTPTasks/CFFTPTasks.html#//apple_ref/doc/uid/TP30001132-CH9-SW1)但它不是非常明了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T14:52:42.097

考虑使用[BlackRaccoon](https://github.com/lloydsargent/BlackRaccoon)来处理 FTP。

# linux - elinks http autentication

> ID：13122905
> 
> 赞同：0
> 
> 时间：2012-10-29T13:49:42.097
> 
> 标签：linux, unix, elinks

我正在尝试使用 linux elinks 文本浏览器访问网站。此站点需要 http 身份验证。如果我按下转义键并隐藏登录提示一次，然后如果我尝试再次访问特定网站，它不会再次显示登录提示。我尝试“刷新所有缓存”，但在我关闭终端并获得新的终端之前它不起作用。有没有其他方法可以解决这个问题？

这应该是一个简单的问题。但我用谷歌搜索并找不到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T06:01:53.640

我刚刚在 Fedora 17 上使用 2.2 版的链接进行了尝试。我去了一个需要基本身份验证的网站，弹出密码对话框，点击转义，看到错误消息。然后我按 Ctrl-R 重新加载页面并再次显示用户名和密码提示。所以我点击“g”并输入“google.com”，然后去了谷歌。然后点击“g”并返回我的密码保护站点，我再次被要求输入用户名和密码。所以我无法重现这个问题。

# c# - 在控制台应用程序中隐藏 Chrome WebDriver

> ID：13122907
> 
> 赞同：0
> 
> 时间：2012-10-29T13:49:49.553
> 
> 标签：c#, .net, console-application, selenium-webdriver

有没有办法隐藏在 C# 控制台应用程序中使用 Selenium WebDriver 打开的 chrome 窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:52:10.903

似乎确实有解决方法。

具体来说，就是[**CreateNoWindow**](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.createnowindow.aspx)属性。

默认情况下，它的值为`false`，但请尝试将其设置为`true`。

`Start()`在你的方法里面`WebDriver\DriverService.cs`

你可以这样放置：

```
this.driverServiceProcess.StartInfo.CreateNoWindow = true; 
```

# objective-c - iOS App中是否创建了许多自动释放池？

> ID：13122908
> 
> 赞同：1
> 
> 时间：2012-10-29T13:49:50.500
> 
> 标签：objective-c, ios, nsautoreleasepool, nsrunloop

我怀疑何时自动释放对象。当我发现这个[问题](https://stackoverflow.com/questions/2498330/when-is-an-autoreleased-object-actually-released)时，

在线程接受的答案中，为运行循环执行提供了以下解释：

```
void int UIApplicationMain (int argc, char *argv[], NSString *principalClassName, NSString *delegateClassName) {
    UIApplication *app = /* create app using principalClassName */;
    [app setDelegate:/* create delegate using delegateClassName */];
    while (![app shouldTerminate]) {
        NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
        event = [app getNextEvent];
        [app dispatchEvent:event];
        [pool drain];
    }
} 
```

这是runloop执行的方式吗？

这是否意味着在每次执行 runloop 时，都会创建并释放一个新的自动释放池。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T13:56:33.710

是的。您在那里的每个循环都在创建一个新池并销毁它。

[这](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSAutoreleasePool_Class/Reference/Reference.html)解释了`drain`在引用计数环境中，如何等价于`release`，因此它被销毁。下一个循环，你`alloc`，`init`另一个。

# sql - 如何使用 postgres 排除 array_agg 中的空值，就像在 string_agg 中一样？

> ID：13122912
> 
> 赞同：136
> 
> 时间：2012-10-29T13:49:55.747
> 
> 标签：sql, postgresql, postgresql-9.1, postgresql-8.4

如果我`array_agg`用来收集姓名，我会用逗号分隔我的姓名，但如果有一个`null`值，该 null 也将作为聚合中的名称。例如 ：

```
SELECT g.id,
       array_agg(CASE WHEN g.canonical = 'Y' THEN g.users ELSE NULL END) canonical_users,
       array_agg(CASE WHEN g.canonical = 'N' THEN g.users ELSE NULL END) non_canonical_users
FROM groups g
GROUP BY g.id; 
```

它返回`,Larry,Phil`而不是仅仅返回`Larry,Phil`（在我的 9.1.2 中，它显示`NULL,Larry,Phil`）。

相反，如果我使用`string_agg()`，它只显示名称（没有空逗号或空值）。

问题是我已经`Postgres 8.4`安装在服务器上，并且`string_agg()`在那里不起作用。**有什么方法可以让 array_agg 工作类似于 string_agg() ？**

* * *

## 回答 #1

> 赞同：321
> 
> 时间：2014-04-14T02:17:54.593

使用 postgresql-9.3 可以做到这一点；

```
SELECT g.id,
   array_remove(array_agg(CASE WHEN g.canonical = 'Y' THEN g.users ELSE NULL END), NULL) canonical_users,
   array_remove(array_agg(CASE WHEN g.canonical = 'N' THEN g.users ELSE NULL END), NULL) non_canonical_users
FROM groups g 
GROUP BY g.id; 
```

**更新**：使用 postgresql-9.4；

```
SELECT g.id,
   array_agg(g.users) FILTER (WHERE g.canonical = 'Y') canonical_users,
   array_agg(g.users) FILTER (WHERE g.canonical = 'N') non_canonical_users
FROM groups g 
GROUP BY g.id; 
```

**更新（2022-02-19）**：也使用 postgresql-9.4；

当数组中的所有值都为 null 而不是返回 null 时，这会导致一个空数组；

```
SELECT g.id,
  coalesce( array_agg(g.users) FILTER (WHERE g.canonical = 'Y'), '{}' ) canonical_users,
  coalesce( array_agg(g.users) FILTER (WHERE g.canonical = 'N'), '{}' ) non_canonical_users
FROM groups g 
GROUP BY g.id; 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-10-29T14:11:24.563

```
select
    id,
    (select array_agg(a) from unnest(canonical_users) a where a is not null) canonical_users,
    (select array_agg(a) from unnest(non_canonical_users) a where a is not null) non_canonical_users
from (
    SELECT g.id,
           array_agg(CASE WHEN g.canonical = 'Y' THEN g.users ELSE NULL END) canonical_users,
           array_agg(CASE WHEN g.canonical = 'N' THEN g.users ELSE NULL END) non_canonical_users
    FROM groups g
    GROUP BY g.id
) s 
```

或者，更简单并且可能更便宜，使用`array_to_string`它可以消除空值：

```
SELECT
    g.id,
    array_to_string(
        array_agg(CASE WHEN g.canonical = 'Y' THEN g.users ELSE NULL END)
        , ','
    ) canonical_users,
    array_to_string(
        array_agg(CASE WHEN g.canonical = 'N' THEN g.users ELSE NULL END)
        , ','
    ) non_canonical_users
FROM groups g
GROUP BY g.id 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2020-05-02T01:05:48.927

如果您正在寻找**有关如何从数组中删除 NULL 的一般问题的现代答案**，它是：

```
array_remove(your_array, NULL) 
```

我对性能特别好奇，并想将其与最佳替代方案进行比较：

```
CREATE OR REPLACE FUNCTION strip_nulls(
    IN array_in ANYARRAY
)
RETURNS anyarray AS
'
SELECT
    array_agg(a)
FROM unnest(array_in) a
WHERE
    a IS NOT NULL
;
'
LANGUAGE sql
; 
```

进行 pgbench 测试证明（非常有把握地）**array_remove() 快两倍多一点**。我对具有各种数组大小（10、100 和 1000 个元素）以及介于两者之间的随机 NULL 的双精度数进行了测试。

* * *

还值得注意的是，这可用于删除空格（''！= NULL）。但是第二个参数接受`anyelement`，并且由于它们很可能会用字符串文字指示空白，因此请确保将其转换为您想要的形式，通常是非数组。

例如：

`select array_remove(array['abc', ''], ''::text);`

如果你试试：

`select array_remove(array['abc', ''], '');`

它将假定 '' 是 TEXT[] （数组）并会抛出此错误：

> 错误：格式错误的数组文字：“”

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-06-25T17:39:29.827

在解决从数组聚合中删除空值的一般问题时，有两种主要的解决方法：执行 array_agg(unnest(array_agg(x)) 或创建自定义聚合。

第一个是[上面](https://stackoverflow.com/a/13123302/299031)显示的形式：

```
SELECT 
    array_agg(u) 
FROM (
    SELECT 
        unnest(
            array_agg(v)
        ) as u 
    FROM 
        x
    ) un
WHERE 
    u IS NOT NULL; 
```

第二：

```
/*
With reference to
http://ejrh.wordpress.com/2011/09/27/denormalisation-aggregate-function-for-postgresql/
*/
CREATE OR REPLACE FUNCTION fn_array_agg_notnull (
    a anyarray
    , b anyelement
) RETURNS ANYARRAY
AS $$
BEGIN

    IF b IS NOT NULL THEN
        a := array_append(a, b);
    END IF;

    RETURN a;

END;
$$ IMMUTABLE LANGUAGE 'plpgsql';

CREATE AGGREGATE array_agg_notnull(ANYELEMENT) (
    SFUNC = fn_array_agg_notnull,
    STYPE = ANYARRAY,
    INITCOND = '{}'
); 
```

调用第二个（自然）比第一个更好看：

> 从 x 中选择 array_agg_notnull(v)；

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-02-25T00:41:14.373

即使这个线程已经很老了，我也会添加它，但是我遇到了这个在小型数组上效果很好的巧妙技巧。它在 Postgres 8.4+ 上运行，无需额外的库或函数。

```
string_to_array(array_to_string(array_agg(my_column)))::int[] 
```

该`array_to_string()`方法实际上摆脱了空值。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-02-04T11:11:37.910

你应该`array_agg`用[array_remove](https://w3resource.com/PostgreSQL/postgresql_array_remove-function.php)包装你的。

```
SELECT g.id,
       array_remove(array_agg(CASE WHEN g.canonical = 'Y' THEN g.users ELSE NULL END), NULL) canonical_users,
       array_remove(array_agg(CASE WHEN g.canonical = 'N' THEN g.users ELSE NULL END), NULL) non_canonical_users
FROM groups g
GROUP BY g.id; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-29T14:54:56.497

正如评论中所建议的，您可以编写一个函数来替换数组中的空值，但是正如评论中链接的线程中所指出的那样，如果您必须创建一个聚合，这种方式会降低聚合函数的效率，拆分它然后再次聚合它。

我认为在数组中保留空值只是 Array_Agg 的一个（也许是不需要的）特性。您可以使用子查询来避免这种情况：

```
SELECT  COALESCE(y.ID, n.ID) ID,
        y.Users,
        n.Users
FROM    (   SELECT  g.ID, ARRAY_AGG(g.Users) AS Users
            FROM    Groups g
            WHERE   g.Canonical = 'Y'
            GROUP BY g.ID
        ) y
        FULL JOIN 
        (   SELECT  g.ID, ARRAY_AGG(g.Users) AS Users
            FROM    Groups g
            WHERE   g.Canonical = 'N'
            GROUP BY g.ID
        ) n
            ON n.ID = y.ID 
```

**[SQL 小提琴](http://sqlfiddle.com/#!1/7f0e9/3)**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-29T12:37:01.167

这很简单，首先为**text[]创建一个新的****- （减号）**运算符：

 **```
CREATE OR REPLACE FUNCTION diff_elements_text
    (
        text[], text[] 
    )
RETURNS text[] as 
$$
    SELECT array_agg(DISTINCT new_arr.elem)
    FROM
        unnest($1) as new_arr(elem)
        LEFT OUTER JOIN
        unnest($2) as old_arr(elem)
        ON new_arr.elem = old_arr.elem
    WHERE old_arr.elem IS NULL
$$ LANGUAGE SQL IMMUTABLE;

CREATE OPERATOR - (
    PROCEDURE = diff_elements_text,
    leftarg = text[],
    rightarg = text[]
); 
```

并简单地减去数组[null]：

```
select 
    array_agg(x)-array['']
from
    (   select 'Y' x union all
        select null union all
        select 'N' union all
        select '' 
    ) x; 
```

就这样：

**{是，否}****

# sql - SQL - 查找所有订单已完成的帐户

> ID：13122916
> 
> 赞同：1
> 
> 时间：2012-10-29T13:50:06.933
> 
> 标签：sql, oracle9i

我已经在谷歌漫游了几个小时了。

有两张桌子：

```
AccountTable 
ID | AccountID | OrderID

OrderTable
ID | OrderID | OrderStatus 
```

OrderStatus 的值可以是 1、2、3、4，其中 4 是完成状态。

在订单表中，随着订单状态的更新，将添加多行。因此，对于一个已完成的订单，您将在 OrderTable 中有 4 行分别具有 1、2、3 和 4 状态。

一个账户可以有多个订单。

我想找到所有订单都已完成的帐户。

我发现了这么多：

```
select * from AccountTable
INNER JOIN OrderTable
ON AccountTable.OrderID = OrderTable.OrderID
AND OrderTable.OrderStatus = 4 
```

这将选择至少有一个订单处于已完成状态的帐户。

但这不会涵盖当一个订单完成而同一帐户的另一个订单未完成的情况。那时我不想选择帐户。

编辑：我只是想显示一些数据以使这一点更清楚：

```
AccountTable
1 | Name1 | Order1
2 | Name1 | Order2
3 | Name2 | Order3
4 | Name2 | Order4 
```

* * *

```
OrderTable
1 | Order1 | 1
2 | Order1 | 2
3 | Order1 | 3

4 | Order2 | 1
5 | Order2 | 2
6 | Order2 | 3
7 | Order2 | 4

8 | Order3 | 1
9 | Order3 | 2
10 | Order3 | 3
11 | Order3 | 4

12 | Order4 | 1
13 | Order4 | 2
14 | Order4 | 3
15 | Order4 | 4 
```

我只想检索 Name2 而不是 Name1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:08:13.990

假设您的业务逻辑不会被破坏，我认为您希望那些完成的订单数（状态 == 4）与发起的订单数（状态 == 1）相同的帐户：

```
 SELECT AccountID
    FROM (SELECT AccountTable.AccountID AS AccountID,
                 SUM(CASE OrderTable.OrderStatus WHEN 1 THEN 1 ELSE 0 END) AS o1,
                 SUM(CASE OrderTable.OrderStatus WHEN 4 THEN 1 ELSE 0 END) AS o4
            FROM AccountTable
            INNER JOIN
                 OrderTable
              ON AccountTable.OrderID = OrderTable.OrderID
        GROUP BY 1) d
   WHERE o1 = o4; 
```

您可以从那里加入以获取所有字段`AccountTable`。

顺便说一句，在我看来，您的表格名称有误导性。 `AccountTable`是一个*Account2Orders*表，`OrderTable`而是一个*OrderStagesOrLifeCycle*表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:59:53.140

编辑 - 现在更好地了解您的数据：

```
Select
  c.AccountID
From (
  Select
    a.AccountID,
    o.OrderID,
    Max(o.OrderStatus) As OrderState
  From
    AccountTable a
      Inner Join
    OrderTable o
      On a.OrderID = o.OrderID
  Group By
    a.AccountID,
    o.OrderID
) c
Group By
  c.AccountID
Having
  Min(c.OrderState) = 4; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:55:06.323

不加入，子选择。您也不会寻找已完成的订单 - 您会寻找没有订单且没有状态 4 条目的帐户。即存在订单的帐户没有状态 4。

为此检查 SQL Exists 子句和分组依据。您将首先获得一个显示没有状态 4 的订单的查询，然后您可以将其加入订单表。

# node.js - 在 node.js 中使用事件的最佳方式

> ID：13122923
> 
> 赞同：0
> 
> 时间：2012-10-29T13:50:36.697
> 
> 标签：node.js, events, event-handling, eventemitter

在 node.js 中监听/启动事件的最佳方法是什么？我一直在通过使用 EventEmitter 扩展模型来测试 node.js 中的事件启动和侦听，我想知道它是否有这种方法，因为只有在有模型实例时才会侦听事件。如何在节点应用程序处于活动状态时监听事件？

使用 eventEmitter 扩展模型的示例。

```
// myModel.js

var util = require('util');
var events2 = require('events').EventEmitter;
var MyModel = function() {

        events2.call(this);
        // Create a event listener
        this.on('myEvent', function(value) {
            console.log('hi!');
        });
    };

MyModel.prototype.dummyFunction = function(params) {
// just a dummy function.

}

util.inherits(MyModel, events2);
module.exports = MyModel; 
```

编辑：关于此的一个更明确的问题是：如何保持一个在应用程序执行期间侦听事件的永久进程并且它具有全局范围（类似于一个正在运行的事件管理器，它侦听应用程序中产生的事件）。在 app.js 中需要文件 myModel.js 是一种解决方案吗？node.js中如何解决这种事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T19:28:59.113

我不完全确定您所说的事件仅在有模型实例时才处于活动状态是什么意思，因为没有东西可以倾听并对它们做出反应，事件就不会发生。

话虽如此，这样做当然是合理的：

```
util.inherits(global,EventEmitter)
global.on('myEvent',function(){
    /* do something useful */
}); 
```

这将允许您：

```
global.emit('myEvent') 
```

甚至：

```
var ee=new EventEmitter();

ee.on('myEvent',...) 
```

至于如何正确使用EventEmitter：定义为

```
function EventEmitter() {} 
```

它不提供初始化，因此应该足以：

```
var Thing=function(){};
util.inherits(Thing,EventEmitter); 
```

这将扩展 Thing 的实例：

*   `setMaxListeners(num)`
*   `emit(type,...)`
*   `addListener(type,listener)`-- 别名为 on()
*   `once(type,listener)`
*   `removeListener(type,listener)`
*   `removeAllListeners()`
*   `listeners(type)`

唯一可能的“陷阱”是 EventEmitter 将自己的`_events`对象属性添加到任何扩展对象 ( `this`) 中，这表明您不应使用相同的名称命名您自己的任何对象属性，否则会出现意外行为。

# ios - 显示不占用整个屏幕的 UIPageViewController

> ID：13122925
> 
> 赞同：5
> 
> 时间：2012-10-29T13:50:40.710
> 
> 标签：ios, uipageviewcontroller

我想在横向 iPhone 上展示一本书，它会使用 UIPageViewController 中的页面卷曲，但我希望这本书不要占据整个屏幕。

澄清一下，假设背景是一张木桌图像，上面有可以使用 UIPageViewController 和 page curl 浏览的书，但只有书页参与 page curl，背景是完全静态的。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:53:31.717

对的，这是可能的。例如，我有一个 UIPageViewController 在屏幕的一半上使用。秘诀是将其添加到作为[自定义容器视图控制器的父视图控制器中](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

# javascript - 将表单字段中的数据添加到页面上的表格而不刷新整个页面

> ID：13122929
> 
> 赞同：0
> 
> 时间：2012-10-29T13:50:42.243
> 
> 标签：javascript, jquery, dynamic, html-table, refresh

我在这个网站上看到的大部分内容都是指从 php 向 div 添加信息。我只想获取用户的输入，将其动态添加到表格中，并在单击提交按钮时将其显示在 div 中。

在这一点上，我没有做任何将数据发布到数据库、没有 php 等的事情。

我也有 JQuery 来运行动态添加到数据库。它可以工作，但我必须在 javascript 中使用断点来单步执行并查看添加到行中的输入数据....问题是当该功能完成时，页面刷新，所有数据都消失了。

我需要一种方法将数据添加到 div 中的表中，而无需每次刷新页面并清除所有其他数据。

想象一个 div 中的父信息，而另一个 div 中添加子信息。当我添加每个子片段时，我不希望删除父信息，实际上希望它保留为“可编辑”信息。

- - - - - - - - - - - - - - - - - - - - - 编辑 - - - - ---------------------------------------
下面是我现在使用的代码建议，但我显然不完全理解，因为它会点击点击的事件处理程序，但不会进入函数内部，只是跳回，并且永远不会在那里遇到我的其他断点。

---------------------------------------最终编辑 --------- -------------------------------------
我终于把头从背后拉出来注意了查理告诉我的，得到了​​这个……当我从 onClick 事件调用函数时，它就起作用了。我无法将事件绑定到按钮单击，但这可能是因为我使用的是标签而不是设置。

```
function(addNoteRow){
            event.prevent.Default();
            var noteTxt = $('#noteEntry').val();
            var noteEntBy = 'BGM'
            noteEntDate = (Date());
            if (!document.getElementsByTagName) return;
            tabBody=document.getElementsByTagName("TBODY").item(0);
            row=document.createElement("TR");
            cell1=document.createElement("TD");
            cell2=document.createElement("TD");
            cell3=document.createElement("TD");
            textnode1=document.createTextNode(noteEntDate);
            textnode2=document.createTextNode(noteEntBy);
            textnode3=document.createTextNode(noteTxt);
            cell1.appendChild(textnode1);
            cell2.appendChild(textnode2);
            cell3.appendChild(textnode3);
            row.appendChild(cell1);
            row.appendChild(cell2);
            row.appendChild(cell3);
            tabBody.appendChild(row);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:51:52.673

尝试 AJAX 部分刷新部分页面，如 div 等。 [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:06:23.573

您提到您正在使用 jQuery，所以我将在我的示例中使这更容易。

```
 $('#submit_button').click( // Bind an event handler to the submit button
        function(event){
            event.preventDefualt(); //This is necessary if you are using a an submit button input element as normal behavior is to submit the form without ajax causing the page location to change. Event is automatically passed in, and we can call preventDefault() on this object to stop the browser from navigating away from our page.
            $.ajax({
                url:'http://youserver.com/script_that_will_respond.php', //Give the ajax call a target url
                data: $('#user_input').val(), //Supply some data to send with the request,
                success: function(data){ //Supply an anonymous function to execute on success. The parameter will be the response text.
                    $('#your_result_div').html(data); //On success of the ajax call, put the response text into an html element on your page
                }
            });
        }
    ); 
```

jQuery的ajax方法有很多设置。这是一个非常简单的例子。您可以在此处阅读有关各种选项的更多信息：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

编辑：我可能误解了。如果您不需要访问服务器，并且想在本地完成这一切，那就更简单了。

```
$('#submit_button').click( // Bind an event handler to the submit button
    function(event){
        event.preventDefault();
        /*
        We have to call this method on the event object bacause deafult behavior
        of a subnmit button is to submit the form, causing the browser to go to a new page.
        */
            var text = $('#some_input_element').val(); //Store the value of a text input in the variable text
            $('#your_div').html(text); //put the contents of the variable text into the "your_div" elemnt.
        }
); 
```

# php - 如何从js获取php文件中的变量？

> ID：13122932
> 
> 赞同：-4
> 
> 时间：2012-10-29T13:50:45.950
> 
> 标签：php, jquery, mysql

如何将变量从 js 文件传递​​到 php 文件。我想要变量从 checker.js 到 test.php

```
function SendData(id){
    $.ajax({
        type: "POST",
        url: "test.php",
        data: "id=" + id,
        cashe: false,
        success: function(response){
            alert("Record successfully updated")
        }
    })
}
$(document).ready(function(){
    SendData(10)
}) 
```

测试.php 文件

```
<?php
var_dump($_POST);
?> 
```

索引.html

```
<!DOCTYPE HTML>
<html>
<head>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
<script src="checker.js"></script>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:09:50.433

试试这个，看看你的控制台记录了什么：

```
function SendData(id){
    $.ajax({
        type: "POST",
        url: "test.php",
        data: "id=" + id,
        cache: false,
        success: function(response){
            console.log(response);
        }
    });
}
$(document).ready(function(){
    SendData(10)
}); 
```

我几乎可以肯定服务器正在返回一些东西，你只是没有在寻找它。

如果您想检索您的 ID，您可以将您的 php 更改为：

```
<?php
var_dump(json_encode($_POST));
?> 
```

和你的js：

```
function SendData(id){
    $.ajax({
        type: "POST",
        url: "test.php",
        data: "id=" + id,
        cache: false,
        success: function(response){
            var id = JSON.parse(response).id;
            //do something with id
        }
    });
}
$(document).ready(function(){
    SendData(10)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T13:55:23.983

函数中有语法错误（或未知键）`SendData`。更改`cashe`为`cache`.

而且您看不到 PHP 编写了哪些代码。`alert(response);`

如果要将 index.html 的内容替换为 test.php 的响应，请使用：

```
function SendData(id){
    $.ajax({
        type: "POST",
        url: "test.php",
        data: "id=" + id,
        cache: false,
        success: function(response){
            $("body").html(response);
        }
    })
}
$(document).ready(function(){
    SendData(10)
}) 
```

# php - WSDL 验证失败。如何使其有效

> ID：13122934
> 
> 赞同：1
> 
> 时间：2012-10-29T13:51:01.923
> 
> 标签：php, .net, web-services, soap, wsdl

我创建了一个小的 WSDL 文件，但验证失败。验证者说：

*   服务“PortalService”：端口“PortalPort”指向未定义的绑定
*   操作“UpdateKunde”的输入元素的消息未定义
*   操作“UpdateKunde”的输出元素的消息未定义
*   绑定“PortalBinding”引用未定义的 PortType

我认为问题必须在这些方面：

```
 <xsd:element name="UpdateKunde">
        <xsd:complexType>
           <xsd:sequence>
              <xsd:element name="Kunde" minOccurs="1" maxOccurs="unbounded">
                 <xsd:complexType>
                    <xsd:sequence>
                       <xsd:element name="Lastchange" type="xsd:dateTime" />
                       <xsd:element name="Vorname" minOccurs="0" type="xsd:string" />
                       <xsd:element name="Nachname" minOccurs="0" type="xsd:string" />                 
                    </xsd:sequence>
                 </xsd:complexType>
              </xsd:element>
           </xsd:sequence>
        </xsd:complexType>
     </xsd:element>   
     <xsd:element name="UpdateKundeResponse">
        <xsd:complexType>
           <xsd:sequence>
              <xsd:element name="Kunde" minOccurs="1" maxOccurs="unbounded">
                 <xsd:complexType>
                    <xsd:sequence>
                       <xsd:element name="Kundennummer" type="xsd:unsignedInt" />
                       <xsd:element name="Statuscode" type="xsd:int" />
                       <xsd:element name="Statusbeschreibung" minOccurs="0" type="xsd:string" />   
                    </xsd:sequence>
                 </xsd:complexType>
              </xsd:element>
           </xsd:sequence>
        </xsd:complexType>
     </xsd:element>

<wsdl:message name="UpdateKunde">
  <wsdl:part element="tns:UpdateKunde" name="UpdateKunde" />
</wsdl:message>
<wsdl:message name="UpdateKundeResponse">
  <wsdl:part element="tns:UpdateKundeResponse" name="UpdateKundeResponse" />
</wsdl:message>

<wsdl:portType name="PortalPortType">
  <wsdl:operation name="UpdateKunde">
     <wsdl:input message="tns:UpdateKunde" />
     <wsdl:output message="tns:UpdateKundeResponse" />
  </wsdl:operation>
</wsdl:portType>

 <wsdl:binding name="PortalBinding" type="tns:PortalPortType">
  <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http" />
  <wsdl:operation name="UpdateKunde">
     <soap:operation style="document" soapAction="" />
     <wsdl:input>
        <soap:body use="literal" />
     </wsdl:input>
     <wsdl:output>
        <soap:body use="literal" />
     </wsdl:output>
  </wsdl:operation>
</wsdl:binding>
<wsdl:service name="PortalService">
  <wsdl:port name="PortalPort" binding="tns:PortalBinding">
     <soap:address location="##########" />
  </wsdl:port>
</wsdl:service> 
```

肥皂地址存在，但我不允许显示它。我希望有人知道我做错了什么。

# c# - 在实体框架中调用存储过程时的字符串准备

> ID：13122940
> 
> 赞同：3
> 
> 时间：2012-10-29T13:51:07.803
> 
> 标签：c#, .net, sql, entity-framework, entity-framework-4.1

实际上，我有在 Visual Studio 2010 中使用 Entity Framework 4.1 的代码。除了一件事之外，一切都运行良好：它似乎没有像一个`[parameters.Add]`老好人习惯做的那样“准备”参数。

这是我的代码：

```
using (MyEnterprisesEntities dataContext = new 
                             MyEnterprisesEntities(entityBuilder.ToString()))
{
         dataContext.CompanyInitializer(connection.Catalog,
                                        args.CompanyId,
                                        args.CompanyName);
} 
```

因此，如果我公司的名称是`O'Brian and sons`（实际上它之前通过 WCF Web 服务传递，所以它更多地采用这种形式：）`O\'Brian and sons`，它似乎破坏了我的存储过程（包括允许 SQL 注入的可能性）。

有没有办法用 EDMX 避免这种情况，或者旧的方法更可靠？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T15:04:54.930

在调用存储过程之前，您不需要做任何事情。为了帮助您，请启动 SQL Profiler 以查看发送到数据库的参数是什么。我运行了一些测试，如果我使用像 O'Brian 这样的参数，框架会自动将查询中的引号加倍到 SQL。

# java - 支持多数据库oracle和mysql的hibernate HQL查询

> ID：13122943
> 
> 赞同：0
> 
> 时间：2012-10-29T13:51:25.077
> 
> 标签：java, mysql, oracle, hibernate

我有一个应该支持 oracle 和 mysql 数据库的应用程序。我将为不同的数据库获得不同的配置。

但我希望代码中使用的所有 HSQL 都完好无损。

但我无法在以下情况下这样做：

我创建了如下查询：

```
String SQL_QUERY = "select count(log) from dbtable where created_date='"+ givenDate
Query query = session.createQuery(SQL_QUERY);
query.uniqueResult(); 
```

这在 mysql 中效果很好，但在 oracle 中效果不佳

因为 oracle db 需要格式化 created_date 列的值

```
to_date(givenDate,"yyyy-MM-dd") 
```

所以我必须将上述查询更改为：

```
String SQL_QUERY = "select count(log) from dbtable where created_date=to_date('"+ givenDate+","yyyy-MM-dd") 
```

我可以以任何方式为 mysql 和 oracle 避免这种多重查询声明吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T13:53:43.557

从中创建一个并将`java.sql.Date`其`String`传递给查询；不要将转换嵌入数据库中。

更好的是，在它到达持久层之前将它绑定`String`到很长时间。`Date`Java 是一种面向对象的语言；从对象的角度思考。

# content-management-system - 用户子站点 - CMS Multisite 或其他解决方案

> ID：13122946
> 
> 赞同：2
> 
> 时间：2012-10-29T13:51:35.837
> 
> 标签：content-management-system, subdomain

大约 3 到 4 年以来，我一直在考虑一个在线想法，并且无法摆脱它，所以我决定采取行动，看看我是否可以让它发挥作用。目前正在从事 POC 和设计布局，我计划投标开发。

门户的主要部分和最重要的组件涉及用户子站点。我不确定如何处理用户在注册过程中创建子站点的过程和/或采取什么路径。

假设主站点是 www.abc.net - 然后用户将根据他们输入的凭据注册一个子站点。例如 user1.abc.net、mysite.abc.net 或 joeblog.abc.net ......任何他们想要的等等。无需 SEO - 网站模板相当基本，可通过主网站访问子网站。所以过程是：

1.  用户登录主站点并注册
2.  在注册期间，用户输入详细信息，包括他们想要的子站点名称
3.  选择他们想要的模板 - 基本上不同的配色方案。所有模板的功能都相同
4.  他们的网站已创建
5.  当用户登录时，他们会被定向到他们的子站点
6.  能够编辑他们的子站点 - 添加内容并添加额外页面，更改详细信息……。ETC
7.  一般用户（注册或匿名）将能够通过主站点浏览和搜索子站点的内容。

每个子站点相互独立——没有内容共享。基本上，它们是作为子站点托管的独立网站，但需要它们需要某种类型的编辑，例如 CMS。不确定是否可以共享 CMS，但所有者必须能够将内容修改到自己的子站点。

所以我的问题是……

我是否尝试使用具有多站点功能的 Drupal/Wordpress/Joomla CMS？

我是否尝试一个解决方案，其中我有一组用于子站点的简单站点，每个站点都有自己的数据库和某种类型的 CMS 或 WYSIWYG 进行编辑？每个子站点甚至可以使用单独的 CMS 吗？

任何投入将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T15:58:16.960

据我所知，这是不可能的，因为 CMS 无法访问创建子域的服务器。

使用 Joomla 可以提供类似的东西，因为它提供了将自定义样式（模板）应用于不同页面的选项。但是，您必须采用以下 URL 约定`www.yourdomain.com/userselectedtext`。

然后，您可以拥有一个用户在您的站点注册的页面，cms 创建他们的页面。

可以设置 joomla 中的用户权限，以便只有特定页面的所有者才能查看或编辑它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T10:14:19.370

您可以查看此来源：[http](http://www.drupalgardens.com/) ://www.drupalgardens.com/ 。谷歌它基于什么平台。也许你会找到一些信息。另请阅读有关此扩展的信息：http: [//www.joomplace.com/administration-extensions/multisitescontrol.html](http://www.joomplace.com/administration-extensions/multisitescontrol.html)。它适用于 Joomla 网站。我将此组件用于多站点内容管理。也许它也会帮助你。

# objective-c - 在仅纵向模式下伪造横向视图

> ID：13122948
> 
> 赞同：0
> 
> 时间：2012-10-29T13:51:40.447
> 
> 标签：objective-c, ios, xcode, uiview, orientation

我在 Android 上看到过类似的问题，但我的问题针对的是 iOS。我的应用程序只是**纵向**的，我已经设置了一个横向视图，我想将它添加到我当前的视图中，但是没有自动旋转，用户手动旋转设备。

我试过这样做，但是当我将它添加为子视图时，它的视图如下所示：

![](../Images/d702ad9ed6064b83e8a4b2175549f77d.png)

所以你可以看到它添加它就好像视图处于横向模式一样，我该如何修改它？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:02:45.707

在 Interface Builder 中将视图设为 480 宽和 320 高。然后使用：

```
-(void)viewDidLoad {
  myLandscapeView.transform =CGAffineTransformMake(0,1,-1,0,-80,80);
  [self.view addSubview:myLandscapeView];
} 
```

# telerik - 有一个 RadGrid 需要向列行添加工具提示

> ID：13122954
> 
> 赞同：1
> 
> 时间：2012-10-29T13:51:53.723
> 
> 标签：telerik, tooltip, radgrid

我正在使用 RadGrid。有一个名为 Comments 的列，我目前将其作为 Y/N，如果他们将鼠标悬停在 Comments 标题行上，我想添加一个工具提示。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T07:17:53.223

试试下面的代码片段。

```
protected void RadGrid2_ItemDataBound(object sender, GridItemEventArgs e) 
    { 
        if (e.Item is GridHeaderItem) 
        { 
            GridHeaderItem header = (GridHeaderItem)e.Item; 
            header["ColumnUniqueName"].ToolTip = "Custom Text"; 
        } 
    } 
```

# android - 布局没有在android自定义组件中膨胀

> ID：13122955
> 
> 赞同：5
> 
> 时间：2012-10-29T13:51:56.210
> 
> 标签：android, custom-component, android-custom-view, layout-inflater

我的自定义视图（从 a 派生`LinearLayout`）中出现空指针异常，因为它找不到它的子视图。这是代码：

```
public class MyView extends LinearLayout
{
    public MyView(Context context, AttributeSet attrs)
    {
        this(context, attrs, 0);
    }

    public MyView(Context context, AttributeSet attrs, int defStyle)
    {
        super(context, attrs, defStyle);
    }

    private TextView mText;

    @Override
    protected void onFinishInflate()
    {
        super.onFinishInflate();
        mText = (TextView) findViewById(R.id.text);

        if (isInEditMode())
        {
            mText.setText("Some example text.");
        }
    }
} 
```

这是布局（`my_view.xml`）：

```
<?xml version="1.0" encoding="utf-8"?>
<com.example.views.MyView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/text"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:ellipsize="end"
        android:maxLines="4"
        android:paddingLeft="8dp"
        android:paddingRight="8dp"
        android:text="Some text" />

</com.example.views.MyView> 
```

这是我将它放入 XML 文件的方式：

```
 <com.example.views.MyView
        android:id="@+id/my_view"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" /> 
```

但是当我尝试在布局编辑器中预览它时，我得到一个 NPE，`mText.setText(...)`因为`getViewById()`返回`null`.

这是怎么回事？

# 澄清

我希望这行得通的原因是，如果我这样做

```
MyView v = (MyView)inflater.inflate(R.layout.my_view);
((TextView)v.findViewById(R.id.text)).setText("Foo"); 
```

一切正常。这不是布局充气器在通过布局文件时所做的吗？无论如何，我怎样才能正确处理这两种情况（没有得到毫无意义的嵌套视图）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T14:06:09.543

在您的 XML 文件中，您尝试使用自定义视图类 (com.example.views.MyView)，同时尝试在其中添加 TextView。这是不可能的。

以下是您需要更改的内容：

您必须在代码中扩充 XML 文件：

```
public MyView(Context context, AttributeSet attrs, int defStyle)
{
    super(context, attrs, defStyle);
    LayoutInflater.from(context).inflate(R.layout.<your_layout>.xml, this);
} 
```

并像这样修改 XML 布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<TextView
    android:id="@+id/text"
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight="1"
    android:gravity="center"
    android:ellipsize="end"
    android:maxLines="4"
    android:paddingLeft="8dp"
    android:paddingRight="8dp"
    android:text="Some text" />

</LinearLayout> 
```

# ejb-3.0 - jBPM5 和 EJB 服务之间更好的集成方式是什么？

> ID：13122956
> 
> 赞同：0
> 
> 时间：2012-10-29T13:51:55.900
> 
> 标签：ejb-3.0, business-process-management

上周我学习了 jBPM 5.3 以及如何集成到我的 JEE6 Web 应用程序以执行人工任务的工作流。我的 Web 应用程序是标准的 3 层 Web 应用程序（JSF + EJB3 + Hibernate），我想我可以从 ejb 调用 jbpm 核心服务，从 jBPM ProcessEngine 调用 ejb 服务，但我想知道进行集成的更好方法是什么? 是否建议进入一个新的集成层？WorkItem 如何访问 EJB 服务（仅限 JNDI？）？谢谢你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T11:53:22.423

您可以在工作项处理程序中进行 jNDI 查找。你可以在 workItemHandler 实现中做任何你想做的事情。

干杯

# connection - Arduino Ethernet Shield 未连接到 WebServer

> ID：13122958
> 
> 赞同：4
> 
> 时间：2012-10-29T13:51:58.613
> 
> 标签：connection, webserver, client, arduino, ethernet

我在使我的 Arduino 以太网屏蔽与服务器通信时遇到问题，串行监视器上的结果始终是：

我的arduino代码是

```
#include <Ethernet.h>           //library for ethernet functions
#include <SPI.h>
#include <Dns.h>
#include <Client.h>             //library for client functions
#include <DallasTemperature.h>  //library for temperature sensors

// Ethernet settings
byte mac[] = {0x09,0xA2,0xDA,0x00,0x01,0x26};  //Replace with your Ethernet shield MAC
byte ip[] = { 192,168,0,54};  //The Arduino device IP address
byte subnet[] = { 255,255,255,0};
byte gateway[] = { 192,168,0,1};
IPAddress server(192,168,0,53);                  // IP-adress of server arduino sends data to

EthernetClient client;

bool connected = false;                                

void setup(void) {                                     

    Serial.begin(9600);                                
    Serial.println("Initializing Ethernet.");
    delay(1000);
    Ethernet.begin(mac, ip , gateway , subnet);    

}

void loop(void) {                                      

    if(!connected)   {                                 
      Serial.println("Not connected");
      if (client.connect(server, 80)) {                
          connected = true;
          int temp =analogRead(A1);                    
          Serial.print("Temp is ");                              
          Serial.println(temp);
          Serial.println();
          Serial.println("Sending to Server: ");                 
          client.print("GET /formSubmit.php?t0=");            
          Serial.print("GET /formSubmit.php?t0=");            
          client.print(temp);
          Serial.print(temp);
          client.println(" HTTP/1.1");                  
          Serial.println(" HTTP/1.1");                  
          client.println("Host: http://localhost/PhpProject1/");    
          Serial.println("Host: http://localhost/PhpProject1/");    
          client.println("User-Agent: Arduino");        
          Serial.println("User-Agent: Arduino");        
          client.println("Accept: text/html");          
          Serial.println("Accept: text/html");          
          //client.println("Connection: close");        
          //Serial.println("Connection: close");        
          client.println();                             
          Serial.println();
          delay(10000);                                            
      }
      else{
        Serial.println("Cannot connect to Server");               
      }
    }  
    else {
      delay(1000);                                              
      while (client.connected() && client.available()) {        
        char c = client.read();                                 
        Serial.print(c);                                        
      }                                                         
      Serial.println();                                         
      client.stop();                                            
      connected = false;                                        
    }
} 
```

服务器是一台运行在pc上的Apache服务器，代码中的服务器ip地址就是pc的ip地址。出于测试目的，我在我的家庭网络中工作，没有代理或防火墙，我还关闭了我电脑上的防病毒和防火墙。

串行监视器中的结果始终是：

```
Not connected
Cannot connect to Server 
```

有什么想法吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T12:57:57.640

它起作用了，问题出在`Ethernet.begin(mac, ip , gateway , subnet)`，我删除了这一行并使用 DHCP 配置了 Ethernet Shield，`Ethernet.begin(mac)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T08:44:13.857

您是否验证了 MAC 地址是否正确？

如果它仍然不起作用，请尝试使用

```
Client client(server, 80); 
```

代替

```
EthernetClient client 
```

并改变

```
if (client.connect(server, 80)) { 
```

到

```
if (client.connect()) { 
```

希望这可以帮助

# numpy - 将变量从 datetime.timedelta 转换为 numpy.timedelta64

> ID：13122960
> 
> 赞同：1
> 
> 时间：2012-10-29T13:52:01.003
> 
> 标签：numpy, timedelta

如何将变量从 Python 转换`datetime.timedelta`为`numpy.timedelta64`?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T13:53:47.837

```
array([datetime.timedelta(1)], dtype="timedelta64[ms]")[0] 
```

[这个链接](https://github.com/plaes/numpy/blob/master/doc/neps/datetime-proposal3.rst)解释了很多关于`datetime64`和的事情`timedelta64`。这也与转换`datetime.datetime`为`datetime64`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-24T20:37:20.630

您可以通过将（天、秒和微秒）中`np.array`的基本整数表示映射到相应的表示，然后求和来做到这一点，而无需创建一个。`datetime.timedelta``np.timedelta64`

这种方法的缺点是，虽然您将获得相同的增量持续时间，但您不会总是获得相同的单位。这种方法的好处是，如果您要转换单个值而不是大型值数组，它通常会比创建数组更快。

您也可以只`np.timedelta64()`用 a调用`datetime.timedelta`，但这种方法只返回 a`np.timedelta64()`微秒单位。

```
from functools import reduce
import operator

TIME_DELTA_ATTR_MAP = (
        ('days', 'D'),
        ('seconds', 's'),
        ('microseconds', 'us')
        )

def to_timedelta64(value: datetime.timedelta) -> np.timedelta64:
    return reduce(operator.add,
        (np.timedelta64(getattr(value, attr), code)
        for attr, code in TIME_DELTA_ATTR_MAP if getattr(value, attr) > 0)) 
```

# html - 音频 API：无法恢复音乐并对其进行可视化。html5-audio 中是否有错误？

> ID：13122965
> 
> 赞同：1
> 
> 时间：2012-10-29T13:52:38.770
> 
> 标签：html, google-chrome, audio, html5-audio, web-audio-api

我有一个按钮。每点击一次，就会播放一段音乐。第二次点击时，音乐继续播放。我也想把音乐形象化。

所以我从**html5 音频开始（** [http://jsfiddle.net/karenpeng/PAW7r/](http://jsfiddle.net/karenpeng/PAW7r/)中的完整代码）：

```
 $("#1").click(function(){
    audio1.src = '1.mp3';
    audio1.controls = true;
    audio1.autoplay = true;
    audio1.loop = true;

    source = context.createMediaElementSource(audio1);

    source.connect(analyser);
    analyser.connect(context.destination);
    }); 
```

但是当它被点击**不止一次**时，它 console.log 错误：

```
 Uncaught Error: INVALID_STATE_ERR: DOM Exception 11 
```

然后我更改为使用**网络音频 API**，并将源更改为：

```
 source = context.createBufferSource(); 
```

错误消失了。

然后，我需要将其可视化。但具有讽刺意味的是，**它只适用**于**html5 音频**！

[（ http://jsfiddle.net/karenpeng/FvgQF/](http://jsfiddle.net/karenpeng/FvgQF/)中的完整代码，它在 jsfiddle 中不起作用，因为我不知道如何正确编写 processing.js 脚本，但它确实在我的电脑上运行）

```
 var audio = new Audio();
     audio.src = '2.mp3';
     audio.controls = true;
     audio.autoplay = true;
     audio.loop=true;
     var context = new webkitAudioContext();
     var analyser = context.createAnalyser();

     var source = context.createMediaElementSource(audio);
     source.connect(analyser);
     analyser.connect(context.destination);

     var freqData = new Uint8Array(analyser.frequencyBinCount);
     analyser.getByteFrequencyData(freqData);

         //visualization using freqData 
```

当我将源更改为：

```
 source = context.createBufferSource(); 
```

它没有显示任何内容。

那么有没有办法将它可视化但没有错误并使其一次又一次地恢复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:09:13.743

实际上，我认为问题在于您正在尝试为同一媒体元素创建一个 SECOND 网络音频节点。（您的代码在单击时会重新设置 SRC、控件等，但它不会创建新的 Audio()。）您应该挂在您创建的 MediaElementAudioSourceNode 上，或者创建新的音频元素。

例如：

```
var context = new webkitAudioContext();
var analyser = context.createAnalyser();
var source = null;    
var audio0 = new Audio();

$("#0").click(function(){
    audio0.src = 'http://www.bornemark.se/bb/mp3_demos/PoA_Sorlin_-_Stay_Up.mp3';
    audio0.controls = true;
    audio0.autoplay = true;
    audio0.loop = true;

    if (source==null) {
        source = context.createMediaElementSource(audio0);
        source.connect(analyser);
        analyser.connect(context.destination);
    }
});​ 
```

希望有帮助！

——克里斯·威尔逊

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T09:35:06.093

据我所知，这很可能是因为`MediaElementSourceNode`可能只能接收`Audio`尚未播放的内容。该`Audio`对象是在`click`处理程序之外声明的，因此您尝试分析第二次单击时正在播放的音频。

请注意，API 似乎没有指定这一点，所以我不是 100% 确定，但这很直观。

# android - 在 SurfaceView 上打开默认摄像头并使用前置摄像头进行录制

> ID：13122966
> 
> 赞同：6
> 
> 时间：2012-10-29T13:52:39.937
> 
> 标签：android, camera

我已经编写了这段代码来在屏幕的surfaceview上打开前置摄像头，但是当你点击按钮时，我想用前置摄像头录制视频。

此代码崩溃。我为相机使用了两个不同的变量，但我没有找到我的错误:(..我遵循了谷歌指南。

```
public class MainActivity extends Activity {
    public static final int MEDIA_TYPE_VIDEO = 2;

    private Camera mCamera;
    private CameraPreview mPreview;
    public static final int MEDIA_TYPE_IMAGE = 1;
    protected static final String TAG = null;

    private MediaRecorder mMediaRecorder; 
    private Camera mCamerafront;
    private boolean isRecording = false;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        // Button captureButton = (Button) findViewById(id.button_capture);
        mCamera = getCameraInstance();

        // Create our Preview view and set it as the content of our activity.
        mPreview = new CameraPreview(this, mCamera);
        FrameLayout preview = (FrameLayout) findViewById(R.id.camera_preview);
        preview.addView(mPreview);

        // Add a listener to the Capture button
        Button captureButton = (Button) findViewById(id.button_capture);
        captureButton.setOnClickListener(
                new View.OnClickListener() {

                    public void onClick(View v) {
                        if (isRecording) {
                            // stop recording and release camera
                            mMediaRecorder.stop();  // stop the recording
                            releaseMediaRecorder(); // release the MediaRecorder object
                            mCamerafront.lock();         // take camera access back from MediaRecorder

                            // inform the user that recording has stopped
                            //setCaptureButtonText("Capture");
                            isRecording = false;
                        } else {
                            // initialize video camera
                            if (prepareVideoRecorder()) {
                                // Camera is available and unlocked, MediaRecorder is prepared,
                                // now you can start recording
                                mMediaRecorder.start();

                                // inform the user that recording has started
                                //setCaptureButtonText("Stop");
                                isRecording = true;
                            } else {
                                // prepare didn't work, release the camera
                                releaseMediaRecorder();
                                // inform user
                            }
                        }
                    }
                }
                );

        /*  captureButton.setOnClickListener(
                new View.OnClickListener() {
                    public void onClick(View v) {
                        // get an image from the camera
                        mCamera.takePicture(null, null, mPicture);
                    }
                }
            );*/
    }

    //*PARTE registrazione 
    private boolean prepareVideoRecorder(){
        int cameraCount = Camera.getNumberOfCameras()-1;
        mCamerafront=Camera.open(cameraCount); 

        mMediaRecorder = new MediaRecorder();
        mCamerafront.unlock();
        mMediaRecorder.setCamera(mCamerafront);
        mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
        mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
        mMediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_HIGH));
        mMediaRecorder.setOutputFile(getOutputMediaFile(MEDIA_TYPE_VIDEO).toString());

        try {
            mMediaRecorder.prepare();
        } catch (IllegalStateException e) {
            Log.d(TAG, "IllegalStateException preparing MediaRecorder: " + e.getMessage());
            // releaseMediaRecorder();
            return false;
        } catch (IOException e) {
            Log.d(TAG, "IOException preparing MediaRecorder: " + e.getMessage());
            //releaseMediaRecorder();
            return false;
        }
        return true;

    }

    private void releaseMediaRecorder(){
        if (mMediaRecorder != null) {
            mMediaRecorder.reset();   // clear recorder configuration
            mMediaRecorder.release(); // release the recorder object
            mMediaRecorder = null;
            mCamerafront.lock();           // lock camera for later use
        }
    }

    /** Check if this device has a camera */
    private boolean checkCameraHardware(Context context) {
        if (context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_CAMERA)){
            // this device has a camera
            return true;
        } else {
            // no camera on this device
            return false;
        }
    }

    /** A safe way to get an instance of the Camera object. */
    public static Camera getCameraInstance(){
        Camera c = null;
        try {
            c = Camera.open(); // attempt to get a Camera instance
        }
        catch (Exception e){
            // Camera is not available (in use or does not exist)
        }
        return c; // returns null if camera is unavailable
    }

    /** A basic Camera preview class */
    public class CameraPreview extends SurfaceView implements SurfaceHolder.Callback {
        private final String TAG = null;
        private SurfaceHolder mHolder;
        private Camera mCamera;

        public CameraPreview(Context context, Camera camera) {
            super(context);
            mCamera = camera;

            // Install a SurfaceHolder.Callback so we get notified when the
            // underlying surface is created and destroyed.
            mHolder = getHolder();
            mHolder.addCallback(this);
            // deprecated setting, but required on Android versions prior to 3.0
            mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        }

        public void surfaceCreated(SurfaceHolder holder) {
            // The Surface has been created, now tell the camera where to draw the preview.
            try {
                mCamera.setPreviewDisplay(holder);
                mCamera.startPreview();
            } catch (IOException e) {
                Log.d(TAG, "Error setting camera preview: " + e.getMessage());
            }
        }

        public void surfaceDestroyed(SurfaceHolder holder) {
            // empty. Take care of releasing the Camera preview in your activity.
        }

        public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
            // If your preview can change or rotate, take care of those events here.
            // Make sure to stop the preview before resizing or reformatting it.

            if (mHolder.getSurface() == null){
                // preview surface does not exist
                return;
            }

            // stop preview before making changes
            try {
                mCamera.stopPreview();
            } catch (Exception e){
                // ignore: tried to stop a non-existent preview
            }

            // set preview size and make any resize, rotate or
            // reformatting changes here

            // start preview with new settings
            try {
                mCamera.setPreviewDisplay(mHolder);
                mCamera.startPreview();

            } catch (Exception e){
                Log.d(TAG, "Error starting camera preview: " + e.getMessage());
            }
        }
    }

    @Override
    protected void onPause() {
        super.onPause();
        // if you are using MediaRecorder, release it first
        releaseCamera();              // release the camera immediately on pause event
    }

    private void releaseCamera(){
        if (mCamera != null){
            mCamera.release();        // release the camera for other applications
            mCamera = null;
        }
    }

    private PictureCallback mPicture = new PictureCallback() {

        public void onPictureTaken(byte[] data, Camera camera) {

            File pictureFile = getOutputMediaFile(MEDIA_TYPE_IMAGE);

            try {
                FileOutputStream fos = new FileOutputStream(pictureFile);
                fos.write(data);
                fos.close();
            } catch (FileNotFoundException e) {
                Log.d(TAG, "File not found: " + e.getMessage());
            } catch (IOException e) {
                Log.d(TAG, "Error accessing file: " + e.getMessage());
            }
        }
    };

    private static Uri getOutputMediaFileUri(int type){
        return Uri.fromFile(getOutputMediaFile(type));
    }

    /** Create a File for saving an image or video */
    private static File getOutputMediaFile(int type){
        // To be safe, you should check that the SDCard is mounted
        // using Environment.getExternalStorageState() before doing this.

        File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
                Environment.DIRECTORY_PICTURES), "MyCameraApp");
        // This location works best if you want the created images to be shared
        // between applications and persist after your app has been uninstalled.

        // Create the storage directory if it does not exist
        if (! mediaStorageDir.exists()){
            if (! mediaStorageDir.mkdirs()){
                Log.d("MyCameraApp", "failed to create directory");
                return null;
            }
        }

        // Create a media file name
        String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        File mediaFile;
        if (type == MEDIA_TYPE_IMAGE){
            mediaFile = new File(mediaStorageDir.getPath() + File.separator +
                    "IMG_"+ timeStamp + ".jpg");
        } else if(type == MEDIA_TYPE_VIDEO) {
            mediaFile = new File(mediaStorageDir.getPath() + File.separator +
                    "VID_"+ timeStamp + ".mp4");
        } else {
            return null;
        }

        return mediaFile;
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:14:47.373

您需要在您的 AndroidManifest.xml 文件中添加以下权限：

```
<uses-permission android:name="android.permission.RECORD_AUDIO" /> 
```

# java - 使用 EclipseLink MOXy 两次读取相同的元素

> ID：13122968
> 
> 赞同：1
> 
> 时间：2012-10-29T13:52:51.880
> 
> 标签：java, xpath, jaxb, eclipselink, moxy

是否可以使用 EclipseLink MOXy 将相同的元素读入两个不同的 Java 属性？

在下面的示例中，我将`<publication>`文档映射为一个类，并将`<date>`元素映射为 Java 类，`XmlAdapter`它是我的发布对象的一个​​属性。我还希望将`year`元素设置为Publication 类的*单独属性，**以及*`Date`我制作的复合类的一部分。但是，当我在 XML 绑定中进行设置时，仅年份始终为空，但日期会正确填充。

```
<publication>
    <date datetype="OriginalPub">
        <year>2011</year>
        <month>Feb.</month>
        <day>0</day>
    </date>
</publication 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T20:51:55.377

目前[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)不支持 XPath 将一个类属性映射到映射到另一个类的 XML 文档部分。您可以利用`afterUnmarshal`事件从日期对象中提取年份并将其设置在发布对象上。

```
package forum13122968;

import javax.xml.bind.Unmarshaller;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Publication {

    Date date;
    int year;

    private void afterUnmarshal(Unmarshaller unmarshaller, Object parent) {
        year = date.getYear();
    }

} 
```

# ruby-on-rails-3 - delay_job：从 rails 2 升级后，属性访问器值不会存储在 rails 3 中的 delayed_jobs 表中

> ID：13122969
> 
> 赞同：0
> 
> 时间：2012-10-29T13:52:56.230
> 
> 标签：ruby-on-rails-3, delayed-job

我们在 rails2 中是如何做到的：对于一个作业类，我们为作业对象设置了一堆 attr_accessor 方法，并将对象排入 delay_jobs 表中，这些访问器值也存储在表中。（我们使用延迟作业 2.0.3）

但是在 rails3 中，即使我们遵循与 rails2 中相同的过程，attr_accessor 值也不会存储到表中。谁能告诉我我们如何使用新的delayed_job gem(3.0.3) 将访问器值保存到表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:34:00.613

发现问题出在心理解析器上，它只考虑模型对象的数据库属性，而不考虑实例和类变量。这是该问题的更准确答案：[YAML，delayed_job : Psych vs Syck。如何让 pysch 读取 ruby​​ 对象的 attr_accessors](https://stackoverflow.com/questions/13125777/yaml-delayed-job-psych-vs-syck-how-to-make-pysch-read-attr-accessors-for-a-r)

# asp.net-mvc - 为 Asp.net Web API 使用服务总线

> ID：13122972
> 
> 赞同：4
> 
> 时间：2012-10-29T13:53:08.177
> 
> 标签：asp.net-mvc, asp.net-web-api, nservicebus, servicebus

我正在使用 ASP.NET Web API 开发服务，并计划使用服务总线进行消息交换。是否可以将服务总线与 ASP.NET Web API 一起使用？除了 Windows Azure 服务总线，微软对服务总线的回答是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-30T04:21:52.927

绝对没有什么可以阻止您使用带有 ASP.NET Web API 的服务总线。

我正在实施的项目中正是这样做的（web api），用户注册并且我需要发送激活电子邮件。电子邮件发送是从服务总线端点处理的，因此来自 Web api 的注册会立即返回。

我还在生产系统中实现了我的服务总线，尽管它是 MVC 3（4 个 Web 服务器）。

尽管任何服务总线都可以解决问题（NServiceBus、MassTransit 等），但您可能想看看我的 FOSS Shuttle ESB 项目：[http ://shuttle.codeplex.com/](http://shuttle.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T21:18:43.613

您看过 Microsoft 服务总线 1.0 吗？ [http://msdn.microsoft.com/en-us/library/windowsazure/jj193022](http://msdn.microsoft.com/en-us/library/windowsazure/jj193022(v=azure.10).aspx) (v=azure.10).aspx（它包括来自 Azure 服务总线的消息传递和排队功能）

对于分布式缓存（即 Azure 中的缓存服务），Windows Server 的 AppFabric 1.1 具有许多功能 [http://www.microsoft.com/en-us/download/details.aspx?id=27115](http://www.microsoft.com/en-us/download/details.aspx?id=27115)

您绝对可以在 ASP.NET Web API 中使用缓存服务。我还没有尝试使用 Microsoft Service Bus 1.0 在 Web API 上进行消息传递/排队。

# php - 使用 PHP 和关系数据生成无序列表

> ID：13122974
> 
> 赞同：0
> 
> 时间：2012-10-29T13:53:16.583
> 
> 标签：php, closures, tabular

我正在尝试使用来自闭包表查询的数据创建一个无序列表。

查询的结果返回关系表的长度和用于对查询结果进行排序的面包屑：

```
downline        length      breadcrumbs
Jack Black      0       3,4
John Seventeen      1       3,4,101
Pieter Betteerd     1       3,4,20
Andre Van Klerk     1       3,4,21
Hans Beyers         2       3,4,21,68
Cobus Ventering     1       3,4,22
Phillipus Sonkis    1       3,4,23
Andriet Joubert     2       3,4,23,58
Daniel Calitzdorp   1       3,4,63
Roelf Serfontein    2       3,4,63,81
Anke Van Blerk      3       3,4,63,81,83
Hermanus Pieters    1       3,4,69
Heinrich Brough     2       3,4,69,72 
```

我想将此结果输出到 html 中的无序列表，类似于：

```
 <ul>
   <li>
       Jack Black 
       <ul>
         <li>John Seventeen</li>
         <li>Pieter Betteerd</li>
         <li>Andre Van Klerk
           <ul>
             <li>Hans Beyers</li>
           </ul>
         </li>
         <li>Cobus Ventering</li>
         <li>Phillipus Sonkis
           <ul>
             <li>Andriet Joubert</li>
           </ul>
         </li>
         <li>Daniel Calitzdorp
           <ul>
             <li>Roelf Serfontein
              <ul>
                <li>Anke Van Blerk</li>
              </ul>
             </li>
           </ul>
         </li>
         <li>Hermanus Pieters
           <ul>
             <li>Heinrich Brough</li>
           </ul>
         </li>
       </ul>
     </li>
   </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T12:49:39.620

我曾经在 XML 中拥有它，但现在我想将它移动到 jOrgChart 并且呈现组织结构图需要无序的 HTML 代码。我的 XML 输出是这样生成的： $downline = ' '; $计数++; } 其他 { $downline .= ' '; } } $downline .= ' '; 但是即使在查看递归代码之后，我也不知道如何实现这一点。也许我的大脑真的是向后连接的，或者我只是因为睡眠不足而筋疲力尽：P

# google-shopping-api - 谷歌购物原子提要和实际谷歌购物网站数据

> ID：13122978
> 
> 赞同：0
> 
> 时间：2012-10-29T13:53:23.477
> 
> 标签：google-shopping-api

我正在使用 google 购物 api 将卖家数据作为 atom 提要获取，但有时 google atom 提要的商店少于使用相同搜索关键字或 ean 代码时我可以在 google 购物网站上看到的实际商店数量。

什么可能导致这种情况，商店是否可以选择将其产品数据隐藏在 atom 提要中？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:03:59.260

**编辑：**由于分页不是问题，OP 正确地指出商家可以通过 API 请求排除其结果。在[产品馈送规范](http://support.google.com/merchants/bin/answer.py?hl=en&answer=188494#other)中，有一个`excluded_destination`可以为[特定目的地](http://support.google.com/merchants/bin/answer.py?hl=en&answer=191180)配置的参数。

* * *

您可能会遇到某种`paging`情况。Google（和其他）API 通常不会在响应中返回特定查询的所有结果（想想如果您要查询返回 10,000,000 个结果的东西 - 这对于您的程序来说可能会很繁重，而且对于提供者提供）。

为了避免这种情况，许多 API 提供了一个参数，让您可以转到结果的“下一页”。Shopping API 只提供了这样一个参数 ( `nextLink`)，您可以将其附加到查询中以获取当前页面之后的结果页面

从[文档](https://developers.google.com/shopping-search/v1/reference-response-format)中：

```
{
  "kind": "shopping#products",
  "etag": value,
  "id": "tag:google.com,2010:shopping/products",

  "selfLink": value,
  "nextLink": value,
  "previousLink": value,

  "totalItems": value,
  "startIndex": value,
  "itemsPerPage": value,
  "currentItemCount": value,

  content module,
  ...
  content module,

  "items": [
    product resource
  ]
} 
```

其中`nextLink`=`Link to the next page of products, omitted if there is no next page`

# python - Python&PyGTK：将数据传输到线程

> ID：13122984
> 
> 赞同：1
> 
> 时间：2012-10-29T13:53:44.823
> 
> 标签：python, multithreading, pygtk

我想将数据传输到线程类，但我不知道出了什么问题。下面的代码来自this [question](https://stackoverflow.com/questions/13108018/pythonpygtk-stop-while-on-button-click/13108681)，我对其进行了一些更改。

这是一个代码：

```
import gtk, gobject, threading, time

gobject.threads_init()

class T(threading.Thread):
    pause = threading.Event()
    stop = False

    def start(self, data, *args):
        super(T, self).start()

    def run(self, data):
        while not self.stop:
            self.pause.wait()
            gobject.idle_add(lambda *a : self.rungui(data))
            time.sleep(0.1)

    def rungui(self, data):
        print "printed"
        print data

thread = T()

class Start:

        def toggle_thread(self, data=None, *args):
                if not thread.is_alive():
                    thread.start(data)
                    thread.pause.set()
                    self.button.set_label('Pause Thread')
                    return

                if thread.pause.is_set():
                    thread.pause.clear()
                    self.button.set_label('Resume Thread')
                else:
                    thread.pause.set()
                    self.button.set_label('Pause Thread')

        def __init__(self):
                thread = T()
                window = gtk.Window()
                self.button = gtk.ToggleButton('Start Thread')
                data = 3
                self.button.connect('toggled', lambda *a : self.start(data), None)
                window.add(self.button)
                self.button.show()
                window.show()

        def start(self, data=None):
                self.toggle_thread(data)

        def main(self):
                gtk.main()

if __name__ == "__main__":
        start = Start()
        start.main() 
```

我必须纠正什么才能使线程完全工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T14:55:45.467

不要在 gui 线程之外使用 gtk。关于：

```
gobject.idle_add(self.rungui) 
```

您链接上的示例工作正常，但需要 system kill 命令才能终止。并且 super() 不能为 run() 函数带来参数。

我的线程初始化如下所示：

```
class VirtService(threading.Thread):
        def __init__(self, queue):
                threading.Thread.__init__(self)
                self.queue = queue

        def thread_loop(self):
                while self.queue.qsize():
                        data_command = self.queue_get()

...

queue = Queue()

if __name__ == '__main__':
        gobject.threads_init()
        vs = VirtService(queue) 
```

您可以使用 Queue 进行双向数据转换。您也可以使用队列命令。在非图形线程中通过 Queue.qet() 创建 c++ poll() 模拟，并在 gui 线程中 queue.put()

# c++ - 在 C++ 中对两个字符数组进行异或运算

> ID：13122988
> 
> 赞同：1
> 
> 时间：2012-10-29T13:53:55.980
> 
> 标签：c++

我有两个 char 数组：

```
unsigned char a[8]; 
```

和

```
unsigned char b[8]; 
```

如何进行 XOR 操作：

```
p[i]=a[i]^b[i] 
```

感谢您的回答。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-29T14:10:19.307

```
std::transform(std::begin(a), std::end(a),
    std::begin(b),
    std::begin(p),
    std::bit_xor<unsigned char>()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T13:55:58.740

```
for(int i = 0; i < 8; ++i)
{
    p[i] = a[i] ^ b[i];
} 
```

假设 p 也是一个`unsigned char`足够大的数组 ( `>=8`)

这是另一种解决方案，但它真的很糟糕。只是为了好玩。想象有一个 8 字节长的类型。让类型的名称很长。你可以这样做（但不要:)）

```
unsigned long long aa;
unsigned long long bb;

memcpy(&aa, a, 8);
memcpy(&bb, b, 8);
unsigned long long pp = a^b;
memcpy(p, &pp, 8); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T13:57:50.017

您在那里编写的代码执行按位 XOR 就好了。把它放在一个里面`for(int i(0); i < 8; ++i){ ... }`

或者，如果您想要更复杂的比较，则可以使用以下方法：

在这个例子中，char 'y' 是 1，其他的都是 0。所以 XOR 应该给我们 y# 和 #y 的真值，而不是 yy 或 ##。

```
bool p[8];
for (int i(0); i<8; ++i)
{
  if ( a[i] == 'y')
  {
     if (b[i] == 'y')
     {
       p[i] = false;
     }
     else
     {
       p[i] = true;
     }
   }
   else
   {
     if (b[i] == 'y')
     {
       p[i] = true;
     }
     else
     {
       p[i] = false;
     }
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T13:56:20.267

单独对每个元素进行异或：

```
p[0] = a[0] ^ b[0];
p[1] = a[1] ^ b[1];
p[2] = a[2] ^ b[2];
p[3] = a[3] ^ b[3];
p[4] = a[4] ^ b[4];
p[5] = a[5] ^ b[5];
p[6] = a[6] ^ b[6];
p[7] = a[7] ^ b[7]; 
```

您可以使用 for 循环执行此操作，但出于说明目的，我在此处手动执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-09T14:31:47.763

```
 template <size_t SIZE>
  struct xor_word
  {
    template <typename T>
    static inline void crypt(T* pData, const T *key)
    {
        *pData ^= *key;

        xor_word<SIZE - 1>::crypt<T>(pData + 1, key + 1);
    }
  };

  template <>
  struct xor_word<0>
  {
    template <typename T>
    static inline void crypt(T *pData, const T *key)
    { /* nothing */ }
  }; 
```

和一些使用

```
unsigned char a[8] = ...;
unsigned char b[8] = ...;

static_assert( (sizeof(a) % sizeof(size_t)) == 0);
static_assert(sizeof(a) == sizeof(b));

xor_word< sizeof(a) / sizeof(size_t) >::crypt<size_t>(
                                      reinterpret_cast<size_t*>(a),
                                      reinterpret_cast<size_t*>(b)
                                     ); 
```

# iphone - 如果 Mac 中有许多同名的 XCode 项目，如何找到当前工作的 XCode 项目的位置？

> ID：13122989
> 
> 赞同：0
> 
> 时间：2012-10-29T13:53:55.443
> 
> 标签：iphone, objective-c, ios, xcode

我正在开发一个 XCode 项目，我的 Mac 中有许多同名的项目。如何找到当前项目的确切位置？

右键单击->在查找器中显示会引导我进入构建阶段

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:02:24.563

它非常简单

> 右键单击您的项目->在Finder中显示

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:34:24.633

右键单击 Xcode 项目顶部工具栏中的 .xcodeproj。它将显示项目的文件夹层次结构。希望这可以帮助...

# sql - 关于重复键奇怪的问题

> ID：13122991
> 
> 赞同：0
> 
> 时间：2012-10-29T13:53:59.437
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, activerecord

我在我的项目中使用 sql 查询，下一个代码：

```
ActiveRecord::Base.connection.execute "insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(", ")} on duplicate key update open_counter = open_counter + 1" 
```

我已经添加

```
add_index :open_offer_counters, :offer_id, :unique => true
add_index :open_offer_counters, :udid,  :unique => true 
```

进入迁移之一。但是，当我尝试添加一些只有 1 个重复键的记录时，这不起作用，而是发生了更新键。基本上，如果只有 2 个键（offer_id 和 udid）不同，则此代码有效。如果其中任何一个匹配另一个，AR 会更新我的 open_counter。如果只有 2 个键匹配（offer_id 和 udid），我如何更新 open_counter？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:17:44.620

通过添加解决的问题

```
add_index(:open_offer_counters, [:offer_id, :udid], :unique => true) 
```

代替

```
add_index :open_offer_counters, :offer_id, :unique => true
add_index :open_offer_counters, :udid,  :unique => t 
```

# c# - 为什么添加 SuspendLayout 和 ResumeLayout 会降低性能？

> ID：13122994
> 
> 赞同：13
> 
> 时间：2012-10-29T13:54:20.793
> 
> 标签：c#, winforms, layout, controls, suspend

我需要向父控件添加很多控件。

但是我发现如果我在将这些控件添加到父级之前和之后添加`ParentControl.SuspendLayout`and `ParentControl.ResumeLayout`，我会使用秒表来测量刻度：如果我删除代码`ParentControl.SuspendLayout`and `ParentControl.ResumeLayout`，它会更快。为什么会这样？

所以`SuspendLayout`不`ResumeLayout`应该减少添加子控件的时间，对吧？那么使用或者换句话说，如果我不使用`SuspendLayout`并且直接将子控件添加到父控件有什么好处，那有什么不好的呢？`ResumeLayout``SuspendLayout``ResumeLayout`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-08-23T11:45:01.313

您可能想改用 .ResumeLayout(false) 。调用 mySubPanel.ResumeLayout() 等于 .ResumeLayout(true)，这意味着它应该立即重新布局该控件（以及此时未暂停的所有子控件）。

MSDN 引用：“如果有任何挂起的布局请求，调用 ResumeLayout 方法 [不带参数] 会强制立即布局。” [1]

如果您想在面板中添加 100 个控件，则需要使用如下方法：

1.  mainPanel.SuspendLayout()
2.  创建子控件
3.  调用 child.SuspendLayout()
4.  更改子控件属性
5.  将子控件添加到 mainPanel
6.  调用 child.ResumeLayout(false) - 这意味着：下一个布局运行，重新布局此控件，但不是立即
7.  对每个子控件重复 (2-6)
8.  调用 mainPanel.ResumeLayout(true) - 这意味着：现在重新布局我的 mainPanel 和每个子控件！

注意：如果没有 SuspendLayout()，控件的每个属性更改都会调用布局例程——即使更改 .BackColor 也会使您的控件重新布局本身。

[1] [http://msdn.microsoft.com/en-us/library/y53zat12.aspx](http://msdn.microsoft.com/en-us/library/y53zat12.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-07T01:37:44.590

这是出于通常的原因，删除代码通常会使您的程序运行得更快。

Suspend/ResumeLayout() 被普遍误解。只有当您拥有具有非默认 AutoSize、Dock 或 Anchor 属性的控件时，它才会生效。当控件具有相互影响的布局属性时，它可以防止布局事故。

如果您有一个包含*数百个*控件的表单，那么您根本不可能使用这些属性。如此巨大的窗口不容易自动布局。因此，您调用的方法实际上并没有做任何事情，它们需要时间来迭代布局但没有任何好处。

# sql - T-SQL：解析名称以忽略空格和中间名首字母

> ID：13122997
> 
> 赞同：-1
> 
> 时间：2012-10-29T13:54:22.033
> 
> 标签：sql, sql-server-2008, tsql, parsing

我的数据库维护不善，其中包含员工信息。人力资源部要求提供一份报告，列出与保险范围相关的员工姓名与保险单上的姓名不匹配的情况。

两个表中名称的格式不一致。它始终是姓氏，然后是名字，但您可能会在任一表格中看到名为 Steven J. Smith 的虚构员工的以下任何内容：

1.  史密斯，史蒂文
2.  史密斯，史蒂文
3.  史密斯，史蒂文·J。
4.  史密斯，史蒂文·J。

我需要运行一个查询来查找 EMPLOYEE.EMP_NAME <> INSURANCE.SUBSCRIBER_NAME 的实例，同时允许名称格式存在差异，如上所示（即选择“Smith,Steven J.”和“Smith,Steven”（可能）同一个人并与他们联系）。

```
SELECT 
  EMPLOYEE.EMP_NO
, EMPLOYEE.EMP_NAME
, INSURANCE.SUBSCRIBER_NAME
, INSURANCE.PAYOR_NAME

FROM EMPLOYEE
     INNER JOIN INSURANCE ON EMPLOYEE.EMP_NO = INSURANCE.EMP_NO

WHERE EMPLOYEE.EMP_NAME <> INSURANCE.SUBSCRIBER_NAME 
```

我知道我想做一个子字符串来忽略中间的首字母，但是我该如何解释忽略逗号后是否有空格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:00:19.800

你可以简单地`replace`去掉逗号

```
 WHERE replace (EMPLOYEE.EMP_NAME,',','') <> replace (INSURANCE.SUBSCRIBER_NAME,',','') 
```

要找到大多数不匹配...

```
;with cE as 
(select 
     EMP_NO, 
     REPLACE(REPLACE(REPLACE(EMP_NAME,',',''),' ',''),'.','') as namekey 
from EMPLOYEE),
ci as 
(select 
     EMP_NO, 
     REPLACE(REPLACE(REPLACE(SUBSCRIBER_NAME,',',''),' ',''),'.','') as namekey 
from INSURANCE)
select *
from ce
    inner join ci on ce.EMP_NO = ci.EMP_NO
where
     not
     (
    (LEN(ce.namekey)< LEN(ci.namekey) and ci.namekey like ce.namekey+'%')
        or
    (LEN(ce.namekey)>= LEN(ci.namekey) and ce.namekey like ci.namekey+'%')
     ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T14:10:46.140

为什么不使用 REPLACE 删除所有逗号和空格？

```
WHERE REPLACE(REPLACE(EMPLOYEE.EMP_NAME,' ',''),',','') <> REPLACE(REPLACE(INSURANCE.SUBSCRIBER_NAME,' ',''),',','') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T14:34:30.913

您可以删除逗号后的空格，然后删除首字母

```
declare @Temp table (Name nvarchar(128))

insert into @Temp
select 'Smith, Steven' union all
select 'Smith,Steven' union all
select 'Smith, Steven J.' union all
select 'Smith,Steven J.'

select 
    case
        when N1.Name like '% %' then left(N1.Name, charindex(' ', N1.Name))
        else N1.Name
    end as Name_New,
    T.Name
from @Temp as T
    outer apply (select replace(T.Name, ', ', ',') as Name) as N1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T13:18:07.910

谢谢，你的回答很有帮助。我最终将名字切割成 [lastname][firstname] 没有空格，如果中间的首字母在那里，我就把它剪掉。以下是最终消除绝大多数同名匹配的方法：

```
((CASE
WHEN CHARINDEX(' ',REPLACE(REPLACE(EMPLOYEE.EMP_NAME,', ',''),',','')) = 0
THEN UPPER(REPLACE(REPLACE(EMPLOYEE.EMP_NAME,', ',''),',',''))
ELSE UPPER(LEFT(REPLACE(REPLACE(EMPLOYEE.EMP_NAME,', ',''),',',''),CHARINDEX(' ',REPLACE(REPLACE(EMPLOYEE.EMP_NAME,', ',''),',',''))))
END) <> 
(CASE
WHEN CHARINDEX(' ',REPLACE(REPLACE(INSURANCE.SUBSCRIBER_NAME
,', ',''),',','')) = 0
THEN UPPER(REPLACE(REPLACE(INSURANCE.SUBSCRIBER_NAME
,', ',''),',',''))
ELSE UPPER(LEFT(REPLACE(REPLACE(INSURANCE.SUBSCRIBER_NAME
,', ',''),',',''),CHARINDEX(' ',REPLACE(REPLACE(INSURANCE.SUBSCRIBER_NAME
,', ',''),',',''))))
END)) 
```

# asp.net-mvc - 在 Web 自动化测试上初始化数据库

> ID：13122999
> 
> 赞同：1
> 
> 时间：2012-10-29T13:54:38.250
> 
> 标签：asp.net-mvc, mongodb, selenium, bdd

我有一个使用 MongoDB 数据库的 asp.net MVC 应用程序。我使用 SpecFlow 和 Selenium WebDriver 对其进行自动测试（BDD），并且我想在导航到某个 URL 或进行某些操作之前将我的数据库初始化为某种状态。有可能这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T21:32:49.180

> 有可能这样做吗？

是的！

我通过以下方式做到了这一点：

1.当测试初始化​​ - 生成测试数据库（通过驱动程序以最简单的方式）。

```
users.Insert(new User(){ Id: "1", userName: "testUser" }) 
```

2.进行备份（我使用 mongodump 来做到这一点）

3.在测试开始之前，创建具有唯一名称 myApp_tests_guid 的数据库。将数据库名称保留在某处。

4.恢复数据库（mongorestore）

5.当测试完成或失败时——删除数据库。

6.一些特定测试的可选步骤是使用特定测试数据调整通用测试数据库。

就是这样。我使用备份/恢复方法的原因是性能。此外，对于测试，请确保您已禁用安全模式和日记功能——这会使事情变得更快。