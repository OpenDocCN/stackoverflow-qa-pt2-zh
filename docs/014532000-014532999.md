# StackOverflow 问答 14532000-14532999

# php - 如何通过单击锚标签链接到 codeigniter 中的其他页面？

> ID：14532000
> 
> 赞同：0
> 
> 时间：2013-01-25T23:32:37.313
> 
> 标签：php, codeigniter

我只是codeigniter的初学者，我试图通过单击超链接重定向到控制器页面（PageController.php）。我可能能够重定向到该特定页面，但该页面的布局不是我所期望的。该页面是我在 routes.php 中设置为默认控制器的页面。当我尚未单击超链接以重定向到该页面时，该页面正常且格式正确。我已经在本地机器上对此进行了测试。希望有人可以帮助我。谢谢！

这是我的代码：

PageController.php

```
    类***PageController***扩展*CI_Controller*
    {
        函数索引（）{
            $this->loadPageHeader();
            $this->loadMenuHeader();
            $this->loadAdvertisingVideo();
            $this->loadMainContent();
            $this->loadSidebar();
            $this->loadPageFooter();
        }
        函数 loadPageHeader(){
            // 正在这里加载页眉...
        }
        函数 loadMenuHeader(){
            // 在此处加载菜单标题...
        }
        函数加载广告视频（）{
            // 在这里加载一些东西...
        }
        函数加载主内容（）{

            // 这里正在加载页面的主要内容...
        }
        函数加载边栏（）{
            // 在这里加载一些...
        }
        函数加载页脚（）{
            // 正在加载页脚...
        }
    }

```

这是执行重定向到控制器页面的超链接。

<a href=<?php echo site_url('PageController');?>首页</a>
<a href=modules.php>模块</a>
<a href=aboutus.php>关于我们</a>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:38:49.193

根据您在此处显示的内容，您可能希望设置一条路线来捕获此控制器的所有内容。在您的配置 routes.php 文件中添加一行：

```
$route['PageController(/:any)'] = "PageController"; 
```

然后在您的控制器索引方法中，如果适用，您将像这样解析 uri 段...

```
 function index(){
        $arg_1 = $this->uri->segment(1);
        $arg_2 = $this->uri->segment(2);
        //etc.

        $this->loadPageHeader();
        $this->loadMenuHeader();
        $this->loadAdvertisingVideo();
        $this->loadMainContent();
        $this->loadSidebar();
        $this->loadPageFooter();
    } 
```

如果您想要一种方法来处理此控制器的所有请求，则 URL 段很有用，但在您的情况下可能不是必需的。我对你的场景了解不够。如果我遗漏了什么并且您有更多问题，请随时提问，我可能会更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:36:36.833

看看使用路由，例如，如果你有 myfile.php 调用控制器 myfile.php 和类 Myfile 等......那么你可以调用例如 /myfile/my_function 或将其映射到路由。

# google-app-engine - GAE 错误 ( : SystemId 失败

> ID：14532011
> 
> 赞同：0
> 
> 时间：2013-01-25T23:33:54.567
> 
> 标签：google-app-engine

知道为什么我会从 GAE 收到此错误吗？以及如何解决？

：系统ID未知；第 57 行；第 31 列；调用 setMethod 方法失​​败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T09:21:30.283

Xalan 的反射调用引起的问题。

修复： [http ://code.google.com/p/googleappengine/issues/detail?id=1367](http://code.google.com/p/googleappengine/issues/detail?id=1367) [https://github.com/www-eee/xalan-j/commits/xalan-gae-2_7_1-1](https://github.com/www-eee/xalan-j/commits/xalan-gae-2_7_1-1)

# .net - log4net 的 log2conosle 远程处理附加程序不起作用

> ID：14532015
> 
> 赞同：2
> 
> 时间：2013-01-25T23:34:17.947
> 
> 标签：.net, logging, log4net, log4net-appender, log4net-configuration

我有以下app.config：

```
 <log4net>
  <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
    <param name="File" value="S3Logger.log"/>
    <appendToFile value="true" />
    <rollingStyle value="Size" />
    <maxSizeRollBackups value="10" />
    <maximumFileSize value="10MB" />
    <staticLogFileName value="true" />
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %level %logger - %message%newline" />
    </layout>
  </appender>
  <appender name="RemotingAppender" type="log4net.Appender.RemotingAppender" >
    <sink value="tcp://localhost:7070/LoggingSink" />
    <lossy value="false" />
    <bufferSize value="1" />
  </appender>

  <!-- Setup the root category, add the appenders and set the default level -->
  <root>
    <appender-ref ref="RollingFileAppender" />
    <appender-ref ref="RemotingAppender" />
  </root>
</log4net> 
```

以及后面的代码：

```
 public partial class App : Application
{
    NameValueCollection appConfig = ConfigurationManager.AppSettings;
    private readonly ILog log = LogManager.GetLogger(typeof(App));
    private TaskbarIcon tb;

    public App()
    {
        InitializeComponent();
        XmlConfigurator.Configure();
        //initialize NotifyIcon
        if (getServiceStatus() == ServiceControllerStatus.Running)
        {
            tb = (TaskbarIcon)FindResource("ActiveServiceIcon");
        }
        else
        {
            tb = (TaskbarIcon)FindResource("InactiveServiceIcon");
        }
        log.Debug("Icon Created");

    }

} 
```

出于某种原因，我只在文件中获取日志记录，而不是通过 log2console “.net remoting reciever” 知道为什么吗？

（我正在使用通过 nuget 安装的 vs2012 和 log4net）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-25T12:53:11.950

log4net 远程附加程序的相同问题，所有设置都是正确的，但 Log2Console 只是保持沉默。试试 UDP appender，它对我来说很好用。

配置：

```
<appender name="UdpAppender" type="log4net.Appender.UdpAppender">
   <remoteAddress value="127.0.0.1" />
   <remotePort value="7071" />
   <layout type="log4net.Layout.XmlLayoutSchemaLog4j" />
</appender> 
```

Log2Console 接收器：

[![Log2Console 接收器](../Images/edcdc542d4054af7fab35f6358ee9fff.png)](https://i.stack.imgur.com/kY9jT.jpg)

# python - 在 Python 中，从类属性中获取类实例的另一个属性

> ID：14532019
> 
> 赞同：-3
> 
> 时间：2013-01-25T23:35:12.970
> 
> 标签：python, python-2.7

我如何或可以执行以下操作？请注意，虽然我声明了 b_class，但我并不总是直接实例化 b_class，而是由库实例化。

```
class a_class:
  def some_method(self):
    """
    get the class instance of b_class in which a_class is instantiated
    using that instance, get var1
    perform some action based on var1
    """

class b_class:
  var1 = "init by the constructor or a method"
  a_inst = a_class()
  """
  other attributes
  """ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:41:22.170

你不能，而不是`b_class`在你调用`some_method`或创建`a_class`实例时传递对实例的引用。

您可以在任何地方存储对该`a_class`实例的引用，因此，在 Python 中，您无法从实例方法中知道它被分配到的位置。

所以，这样做：

```
class a_class:
  def __init__(self, parent):
    self.parent = parent

  def some_method(self):
    self.parent.var1

class b_class:
  def __init__(self):
      self.var1 = "init by the constructor or a method"
      self.a_inst = a_class(self) 
```

现在`a_class`“知道”它们的父实例，并且可以通过`self.parent`实例变量引用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:26:50.270

让我先说：不要这样做；这是一个可怕的、过于复杂的 hack，正确的方法是在实例化后者时将实例传递`a_class`给您的实例，正如 Martijn 很好地说明的那样。`b_class`

也就是说，假设您的每个`a_class`实例最多与一个`b_class`实例相关联，您可以通过询问垃圾收集器来找出它。

```
import gc

class A(object):
    def get_my_B(self):
        # iterate over objects that point to us
        for ref in gc.get_referrers(self):
            if type(ref) is dict:   # could be instance's __dict__
                instances = [x for x in gc.get_referrers(ref) if type(x) is B]
                # if we have been found in the __dict__ of exactly one instance
                # and that __dict__contains a reference to us, we found our B
                if len(instances) == 1:
                    if getattr(instances[0], "__dict__", None) is ref:
                        if ref.get("a", None) is self:
                            return instances[0]
        return None

class B(object):
    def __init__(self):
        self.a = A()

b = B()
assert b.a.get_my_B() is b 
```

# opengl - C++ OpenGL Cube Map Perlin Noise to Sphere

> ID：14532022
> 
> 赞同：4
> 
> 时间：2013-01-25T23:35:33.357
> 
> 标签：opengl, geometry, mapping, perlin-noise, heightmap

我目前正在制作一些行星生成，主要是为了好玩，并希望最终能得到一些踢屁股的行星。我正在使用已通过标准化映射到球体的 Cube。![行星地形和天空](../Images/e6b3bfa026bdc59398ba9f1f053d3622.png)

这张照片中的地形尚未正确纹理化。这只是高度图的渲染。然而，这不是我的问题。从立方体创建球体时，您会留下 6 个弯曲成球体形状的面。因此，我没有可用于将球形高度图包裹在地形周围的纬度和经度。目前我正在使用立方体映射。但是，这会导致几个问题，如您所见： ![立方体到球体映射问题](../Images/2a22d3a54b2bc21e3ca5c10fd40cc771.png) ——我的问题变得很明显。问题是由于球体仍然具有立方体的拓扑结构。我必须为每个面生成一个高度图。我目前使用 Libnoise 作为高度图，这就是大问题的开始。我可以将它导出为球形高度图（如果我有一个球体，这将很有用），或者我可以使用必须映射到所有 6 个面的平面高度图。但是，由于映射的工作方式。我可以让 3 个面在中间排列并且是无缝的，但最后一个高度图不会加入第一个高度图，因为 Lib 噪声使用边界并创建坐标网格。

球体是这样创建的——

```
for(int i = 0; i < vertices.size(); i++)
{

    glm::vec3 oldVec = vertices[i];
    glm::vec3 newVec = glm::normalize(oldVec);
    vertices[i] = newVec * glm::vec3(500, 500, 500);
} 
```

这背后的原因可以在[这里](http://mathproofs.blogspot.co.uk/2005/07/mapping-cube-to-sphere.html)看到。

但是，球体的结构将使以后更容易以 Quad-Ttee 的形式实现 lod。无论如何我可以用 LibNoise 生成立方体贴图高度图吗？或者我可以做些什么来使球体能够使用球形高度图？

我想出了如何使用 Sphere Maps 进行渲染，但是当我开始使用四叉树时，这将不起作用。但是，它会产生一些不错的结果，例如：

![在此处输入图像描述](../Images/2cad5af931bf3e7c788833aaebc44c51.png)

所以，我几乎需要知道如何将噪声平铺到立方体贴图中。使用 Libnoise 或在顶点着色器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T13:25:43.777

我终于让它按我的意图工作了。为此，我通常在没有立方体贴图或球体贴图的情况下展开立方体。我以立方体贴图的形式应用具有 3D Perlin 噪声的高度，但我没有使用 UV 坐标，因此我没有将其展开为立方体贴图并不重要。然后我根据顶点的高度应用纹理，它似乎产生了很好的结果。也许我以后会遇到问题，谁知道呢。这是我现在得到的图片：

![在此处输入图像描述](../Images/33d83b55cc37deb57fc9c63e756f3bdf.png)

PS：那不是月亮，是太阳。出于测试目的，它更近了，我目前没有太阳纹理，所以我只使用了旧的灰度高度图纹理，这样我可以更好地看到它。这颗星球现在开始看起来很棒了。

# jquery-mobile - 替换 jquerymobile 持久页脚中的 img 源不起作用

> ID：14532027
> 
> 赞同：0
> 
> 时间：2013-01-25T23:36:16.067
> 
> 标签：jquery-mobile

这是一个基本的导航实现，单击 jquerymobile 导航栏中的按钮会将当前图标与“活动状态”图标交换，但这似乎不适用于我的 jquerymobile 实现。

仅打开活动图像的代码片段如下

```
$("#navigation_link").live("click", function(){
    $.mobile.changePage("testpage.php");
    toggleActiveBtn("navigation");
});

function toggleActiveBtn(btnId){

    $("#" + btnId).src = "img/" + btnId + "_active.png";
    /* toggle previously active image to "off" state
    ...
    */
    $("#home).trigger("refresh"); 
```

testpage.php 中的 HTML 很简单：

```
<div data-role="page" id="home">
<div data-role="header" data--position="fixed" data-id="app_header">
    ...
</div>
<div data-role="content" id="main">
    ...
</div>    

<div data-role="footer" data-position="fixed" data-id="app_footer">
    <div data-role="navbar" id="footer_menu">
        <ul>
            <li><a id="navigation_link" href="javascript:void(0);"><img id="navigation" src="img/navigation.png" /></a></li>
            ...
        </ul>
    </div>
</div> 
```

我试过了`$("#home).trigger("create")`，`$("#home").trigger("refresh")`都不管用。

提前感谢您的帮助，伙计们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T09:11:28.963

你做得对，只有错误是错误的触发参数。

这个功能：

```
$("#home).trigger("create"); 
```

只影响页面内容。要设置整个页面的样式（内容 + 页眉 + 页脚），必须使用此函数：

```
$("#home).trigger("pagecreate"); 
```

我为你做了一个简单的例子：http: [//jsfiddle.net/Gajotres/yAz8G/](http://jsfiddle.net/Gajotres/yAz8G/)

按下按钮更改导航栏图像。

# javascript - 保存并重新加载 textarea 输入而不访问数据库/服务器

> ID：14532032
> 
> 赞同：-1
> 
> 时间：2013-01-25T23:36:41.093
> 
> 标签：javascript, html, internet-explorer-8, save, reload

这里的第一个问题需要一些指导，

我有一个用于工作流目的的 html 页面，在该页面中，用户将信息输入到文本框中以帮助他们做出决定。在大多数情况下，没有必要保存他们的工作，但是在某些情况下，他们可能出于某种原因需要返回它。html 页面直接从用户的硬盘驱动器运行，不连接到数据库或服务器。

我的目标是为用户创建一种按下按钮并将所有输入数据保存到文本或 javascript 文件的方式，然后如果需要，他们可以在以后重新加载。

我已经环顾了一段时间，但找不到合适的解决方案，所以希望这里有人能给我指导。我宁愿不在 Excel/Access 中重新创建整个内容，因为该页面使用大量 javascript 进行逻辑/警告，而且我对 VB 并不太熟悉。

目前，“另存为”功能只要保存为文本文件就可以使用，但格式不是很用户友好，更不用说删除了 javascript 功能。

我应该注意到，所有用户都使用 Internet Explorer v8，此时交叉兼容性几乎没有问题。此外，浏览器的选择不是我的，我对是否/何时可能发生升级或更改也没有任何影响。

我知道这些限制很多，但我希望我们能想出一个解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:41:08.613

IE8 支持 localStorage，它允许您将数据保存在用户的浏览器中以供以后检索。这是一个很好的起点：[https ://developer.mozilla.org/en-US/docs/DOM/Storage](https://developer.mozilla.org/en-US/docs/DOM/Storage)

# c# - 将 WCF 服务用作类的一部分

> ID：14532035
> 
> 赞同：1
> 
> 时间：2013-01-25T23:37:11.613
> 
> 标签：c#, .net, wcf

一个奇怪/愚蠢的问题，但是.. 我创建了一个简单的 WCF 服务，用于侦听来自数据库的数据请求。它在我的机器上作为服务正常运行没问题，但我想知道 - 这个 WCF 服务可以用作普通类吗？说类似

```
public static void main (String [] args) {
    MyWcfService service = new MyWcfService ();
    /* Code to set-up and start listening for requests... */
} 
```

还是只需要在我的机器上作为服务运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:45:35.723

取决于你想达到什么：

*   如果使用类的功能，**是**的，你可以实例化它并调用它的成员
*   如果将其用作真正的 WCF 服务，**则不**，您需要先托管它。在 IIS 或 Windows 服务等中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T05:19:43.827

是的，如果您想要的话，您可以在控制台应用程序中自托管 WCF 服务。您不需要 IIS 或 Windows 服务来托管 WCF 服务。这对于开发和调试非常方便，但可能不是您想要的生产。有关详细示例，请参阅[此内容。](http://msdn.microsoft.com/en-us/library/ms750530.aspx)我已修改示例以在下面的代码中完全配置端点。再说一次，不是你一直想要的东西。

```
public static void Main()
{
    MyWcfService instance = new MyWcfService();
    using (ServiceHost serviceHost = new ServiceHost(instance))
    {
        var endpoint = serviceHost.AddServiceEndpoint(typeof(IMyWcfService), new NetTcpBinding(), "net.tcp://localhost:8000/MyWcfService");
        serviceHost.Open();

        // The service can now be accessed.
        Console.WriteLine("The service is ready at {0}", endpoint.Address);
        Console.WriteLine("Press <ENTER> to terminate service.");
        Console.WriteLine();
        Console.ReadLine();
    }
} 
```

请注意，这使用单个实例来服务所有调用，通常 WCF 会根据需要创建服务类的实例。

# php - 登录脚本中的未定义变量错误

> ID：14532037
> 
> 赞同：0
> 
> 时间：2013-01-25T23:37:18.440
> 
> 标签：php, pdo

这是我的登录脚本下面的一部分：

```
 $email = $_POST['email'];
$password = $_POST['password'];
$salt = "$2a$10$R.Baj0mvj5doNvtvzDjwP5$";

$crypt_pass=crypt($password,$salt);

$query = $db->prepare('SELECT * FROM Consultants WHERE email = :email');

$query->bindParam(":email",$email);

$results = $query->execute();

$total = $query->rowCount();
$row = $query->fetch(); 
```

错误：

> “PHP Notice: Undefined variable: R in /Users/Sites/pages/login.php on line 6” 这是发生错误的行 - $salt = "$2a$10$R.Baj0mvj5doNvtvzDjwP5$";

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:40:08.153

美元符号被解释为变量。您要么需要逃避它们：

```
$salt = "\$2a\$10\$R.Baj0mvj5doNvtvzDjwP5\$"; 
```

或使用单引号：

```
$salt = '$2a$10$R.Baj0mvj5doNvtvzDjwP5$'; 
```

之所以选择“R”，是因为以数字开头的变量名称在 PHP 中无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:40:16.907

使用单引号而不是双引号。使用双引号，PHP 试图插入变量名。单引号将防止这种行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:40:35.097

因为您使用的是双引号，所以它试图解析字符串中的变量。像这样使用单引号。

```
$salt = '$2a$10$R.Baj0mvj5doNvtvzDjwP5$'; 
```

# c# - ASP.NET MVC 自定义错误

> ID：14532039
> 
> 赞同：21
> 
> 时间：2013-01-25T23:37:36.977
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4

我的目标是在应用程序中创建一个错误处理来处理所有托管错误，而不仅仅是与 MVC 相关。所以我没有使用 HandleErrorAttribute 模式，因为它仅适用于 MVC 错误，而不适用于其他托管错误。

在我的 Global.asax 中，我有：

```
protected void Application_Error()
{
    string displayError = ConfigurationManager.AppSettings["DisplayError"];
    NameValueCollection serverVariables;
    int loop1, loop2;
    StringBuilder serverVariableKeys = new StringBuilder();
    Exception exception = Server.GetLastError();
    HttpException httpException = exception as HttpException;

    if (HttpContext.Current != null)
    {
            // loop through and get server vars
    }

    if (exception != null)
        // Log Error

    // Redirect to Error page if set to basic mode
    if (!string.IsNullOrWhiteSpace(displayError) && displayError.ToLower() == "basic")
    {
        Response.Clear();
    Server.ClearError(); // needed for redirect to work

    var routeData = new RouteData();
    routeData.Values["controller"] = "Error";
    routeData.Values["action"] = "General";
    routeData.Values["exception"] = exception;
    Response.StatusCode = 500;

    if (httpException != null)
    {
       Response.StatusCode = httpException.GetHttpCode();
       switch (Response.StatusCode)
        {
        case 403:
          routeData.Values["action"] = "Http403";
          break;
            case 404:
           routeData.Values["action"] = "Http404";
           break;
        }
    }

    IController errorsController = new Controllers.ErrorController();
    var rc = new RequestContext(new HttpContextWrapper(Context), routeData);
    errorsController.Execute(rc);
    }
} 
```

我有一个that `ErrorController`has`General`和Actions。我有对应于每个动作的视图。`Http403``Http404`

在我的 web.config 中，我有：

```
 <system.web>  
    <!-- removed bits to reduce space -->
    <customErrors mode="On" />
  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <modules >
      <remove name="UrlRoutingModule-4.0" />
      <add name="UrlRoutingModule-4.0" type="System.Web.Routing.UrlRoutingModule" preCondition="" />
      <remove name="Session"/>
      <add name="Session" type="System.Web.SessionState.SessionStateModule" preCondition=""/>
    </modules>
    <handlers>
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
    <httpErrors errorMode="Detailed" />
  </system.webServer> 
```

这适用于与托管代码相关的许多场景，但是当 IIS 接管时，例如错误的静态文件调用 (example.com/BadFileName.gif)，它将从 IIS 返回一个错误，该错误会泄露服务器详细信息，例如本地文件路径。这是因为 web.config 中的以下行：

```
<httpErrors errorMode="Detailed" /> 
```

但是，当我将 errorMode 设置为其他值（例如自定义）或仅删除该行时，我的自定义错误处理将停止运行，并且会为包括托管代码错误在内的所有内容返回默认的 IIS 错误消息。

我已经尝试了很多方法来让自定义错误在没有此设置的情况下正常工作，但没有任何运气，包括：

*   设置`CustomError`为`mode="Off"`
*   在下定义错误节点`customError`以重定向到我的控制器
*   在下定义错误节点`httpErrors`以重定向到我的控制器

当我逐步调试时，我可以看到对控制器的调用，但最终 IIS 发送了响应。错误日志确实被正确调用了 Application_Error，因此代码确实让应用程序将其处理到某个点。

申请详情：

*   ASP.NET MVC 4.0
*   托管在 IIS 7.5（Azure 网站预览版）上

有没有办法不使用`<httpErrors errorMode="Detailed" />`并使这项工作？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-29T08:41:01.640

您看到该行为的原因可能是您的`Application_Error`处理程序被正确调用（并调用您的控制器），但是 IIS 正在拦截 500 错误并显示其自己的错误页面。（尽管您的`Application_Error`处理程序本身也有可能抛出一个`Exception`，这是您要排除的事情）

因为您要处理所有错误（例如您提到的静态文件错误），您可能无法依赖 ASP.NET 或 ASP.NET MVC 为您进行初始错误检测。**并非所有错误都来自您的应用程序！**

最好的办法是尽可能多地依赖 IIS 7.5 的错误处理，而不是过早地参与其中。让 IIS 为您进行初始错误检测，这会容易得多。

尝试将以下内容放入您的 中`web.config`，替换您现有的`httpErrors`节点：-

```
<httpErrors errorMode="Custom" existingResponse="Replace">
  <clear />
  <error statusCode="400" responseMode="ExecuteURL" path="/Error" />
  <error statusCode="403" responseMode="ExecuteURL" path="/Error/Forbidden" />
  <error statusCode="404" responseMode="ExecuteURL" path="/Error/NotFound" />
  <error statusCode="500" responseMode="ExecuteURL" path="/Error" />
</httpErrors> 
```

完全删除`customErrors`节点。这是不必要的。

请记住并确保您的错误控制器正在设置正确的状态代码：-

```
public ActionResult Forbidden()
{
    Response.StatusCode = 403;
    return this.View();
} 
```

然后，您应该能够放弃除注销`Application_Error`处理程序之外的所有内容 - 尽管我认为您最好创建自己的`HttpModule`; `runAllManagedModulesForAllRequests`在你的 modules 节点上设置`web.config`可以帮助你捕获否则会漏掉的错误。

我已经在 Azure 网站预览版上运行了这个设置（虽然我个人使用 elmah 来进行日志记录），并且它可以捕获所有内容，除了明显来自于 failed to parse 的任何错误`web.config`。

我已经[在 github 上放了一个使用 httpErrors 自定义错误页面的完整示例](https://github.com/iaingalloway/ASP.NET-HttpErrors-Example)。您还可以[在 azure 网站上实时看到它](http://httperrors-example.azurewebsites.net/Home)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T09:28:31.027

如果你想在你的应用程序中处理这个问题，你可以编写一个自定义处理程序或使用 HandleError 属性[，这里](http://www.devcurry.com/2012/06/aspnet-mvc-handling-exceptions-and-404.html)是一个很好的例子，说明了一种方法来解决这个问题，而不必使用 IIS 作为拐杖。因为并非所有 IIS 主机提供商都允许在服务器级别进行这种类型的自定义，而 IMO 是一种不好的方法，因为它在部署时会创建额外的配置。

# html - 让 django 检查当前 URL，如果包含特定字符串，则添加到类中

> ID：14532043
> 
> 赞同：0
> 
> 时间：2013-01-25T23:38:18.250
> 
> 标签：html, django

Django有没有办法检查一个url，如果它包含一个给定的路径，然后将一个类添加到一个特定的项目中？

现在这就是我所拥有的，我想我对下一步将是什么感到困惑。

1.  尝试按照[http://gnuvance.wordpress.com/2007/09/14/a-django-template-tag-for-the-current-active-page/#comment-290](http://gnuvince.wordpress.com/2007/09/14/a-django-template-tag-for-the-current-active-page/#comment-290)上的教程进行操作。我已经创建了一个 tags.py 文件，并使用 {% load tags %} 将其加载到 HTML 文件中（效果很好）。现在我只是坚持我可以做些什么来将一些标签添加到 class="{% like an if tag comparison something%}CLASS TO ADD HERE {% endiftag comparison%}"。

让我知道这是否有意义或是否需要更多分类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:02:08.823

**page.html**

```
 {% extends 'base.html' %}
 {% load utility %}

 {% block content %}
 <ul class="big-menu">
     <li>
         <a href="{% url main:home %}" class="{% ifpathmatch "main:home" %}current{% endifpathmatch %}">Home</a>
     </li>
 </ul>
 {% endblock %} 
```

(template_tags) **实用程序.py**

```
 import re

 from django import template
 from django.core.urlresolvers import NoReverseMatch
 from django.templatetags.future import url as django_url_func

 register = template.Library()

 def ifurlmatch(parser, token):
     """
     This is a block tag similar to an {% if %}{% endif %} block.

     It will conditionally display the content between matching
     {% ifurlmatch %}{% endifurlmatch %} tags if the URL path (minus hostname)
     matches the parameter, which should be a string or regex pattern.
     """
     tag_name, pattern = token.split_contents()

     # Arg, split_contents doesn't remove encapsing quotes.
     pattern = pattern.strip('"\'')
     nodelist = parser.parse(('endifurlmatch'))
     parser.delete_first_token()
     return UrlMatchNode(nodelist, pattern)

 class UrlMatchNode(template.Node):
     def __init__(self, nodelist, pattern):
        self.pattern = pattern
        self.nodelist = nodelist

     def render(self, context):
        if self._path_matches(context):
            return self.nodelist.render(context)
        return ''

     def _path_matches(self, context):
        req = context['request']
        path = req.META.get('PATH_INFO', '/')
        return re.search(self.pattern, path) is not None

 register.tag("ifurlmatch", ifurlmatch)

def ifpathmatch(parser, token):
    """
    This is a block tag similar to an {% if %}{% endif %} block.
    It will conditionally display the content between matching
    {% ifpathmatch %}{% endifpathmatch %} tags if the current page's URL
    matches the named path from v1.py passed in as the parameters.

    BUG/NOTE: Currently all string parameters to this must be quoted, or it
    will never match. For example, to match the
    relationships:clients:activity URL path you would need to do the
    following:
        {% ifpathmatch "relationships:clients:activity" "my-client-slug" %}
    Parameters which aren't literal strings shouldn't be quoted.
    For example, if passing in a client object's slug:
        {% ifpathmatch "relationships:clients:activity" myclientobj.slug %}
    """

    nodelist = parser.parse(('endifpathmatch'))
    parser.delete_first_token()
    return NamedPathMatchNode(nodelist, parser, token, True)

def ifpathcontains(parser, token):
    """
    Similar to ifpathmatch, but will return true if url contains passed in path
    """
    nodelist = parser.parse(('endifpathcontains'))
    parser.delete_first_token()
    return NamedPathMatchNode(nodelist, parser, token, False)

class NamedPathMatchNode(template.Node):
    def __init__(self, nodelist, parser, token, strict):
        self.token = token
        self.nodelist = nodelist
        self.parser = parser
        self.strict = strict

    def render(self, context):
        reversed_url = None
        try:
            reversed_url = django_url_func(
               self.parser, self.token).render(context)
        except NoReverseMatch:
            pass

        if self.strict:
            if reversed_url is not None and self._path_matches(
               context, reversed_url):
               return self.nodelist.render(context)
        else:
            if reversed_url is not None and self._path_contains(
               context, reversed_url):
               return self.nodelist.render(context)
        return ''

    def _path_matches(self, context, reversed_url):
        req = context['request']
        return req.META.get('PATH_INFO', '/') == reversed_url

    def _path_contains(self, context, reversed_url):
        req = context['request']
        return reversed_url in req.META.get('PATH_INFO', '/')

 register.tag("ifpathmatch", ifpathmatch)
 register.tag("ifpathcontains", ifpathcontains) 
```

# css - 使用 grails 2.2.0 和资源插件找不到自定义 jquery css 图像

> ID：14532045
> 
> 赞同：1
> 
> 时间：2013-01-25T23:38:26.263
> 
> 标签：css, jquery-ui, grails-2.2

尝试使用资源插件在 grails 2.2.0 中使用自定义 jquery ui 主题。但是我似乎无法对其进行配置，以便在 custom.css 文件中引用的图像将呈现。例如，对于如下所示的 url，我继续收到 404 错误：

```
http://localhost:8080/myapp/static/css/themes/south-street/images/ui-icons_eeeeee_256x240.png 
```

我已经尝试过模块覆盖，我最近的尝试定义了以下模块：专门引用 css 文件。

```
 dashboard {
        dependsOn 'jquery'
            // dependsOn 'jquery-ui'
        resource url:'js/fg.menu.js'
        resource url:'jquery-ui/js/jquery-ui-1.8.24.custom.js'

        resource url:'css/main.css'
        resource url:'css/fg.menu.css'
        resource url:'css/arfnavigation.css'
        resource url:'css/themes/south-street/jquery-ui-1.8.24.custom.css'

    } 
```

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T14:03:06.373

试试这篇文章[Grails: Images / CSS missing from time to time](https://stackoverflow.com/questions/7432521/grails-images-css-missing-from-time-to-time/15174643#15174643)。

这是资源插件中的错误。

在插件中的 BuildConfig.groovy 中使用：

运行时“：资源：1.2.RC2”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T13:10:18.390

好吧，我通过创建一个图像模块并明确描述我的应用程序中由 CSS 文件引用的每个图像，然后包括该依赖项来实现此功能。我想知道这是否是标准解决方案，或者我是否错过了其他配置中可以自动处理的内容。

谢谢，

# asp-classic - 尝试使用脚本启动 Photoshop

> ID：14532048
> 
> 赞同：0
> 
> 时间：2013-01-25T23:38:29.827
> 
> 标签：asp-classic, photoshop

我试图在我的 Windows 服务器中使用 asp 编码启动 Photoshop，但现在我只能在我的浏览器中读取 2 天是**Server.CreateObject 失败**大声笑

使用这个：设置 PhotoshopApp = Server.CreateObject("Photoshop.Application")

看起来它是正确的调用，我想必须在服务器中设置一些东西。

有人可以给我一些灯吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T03:29:31.020

Photoshop 是一个桌面应用程序，它不是为了以这种方式启动而编写的。

但是您可以使用其他 COM 对象在桌面上启动它：

[http://classicasp.aspfaq.com/general/how-do-i-execute-a-dos-command/batch-file/exe-from-asp.html](http://classicasp.aspfaq.com/general/how-do-i-execute-a-dos-command/batch-file/exe-from-asp.html)

但根据我的个人经验，WScript.Shell 似乎不适用于较新的 IIS 版本。

如果您有权访问 SQL：

[如何从 ASP 页运行 sqlcmd.exe？](https://stackoverflow.com/questions/587189/how-can-i-run-sqlcmd-exe-from-an-asp-page)

如果可以注册 COM：

[http://www.shotdev.com/asp/asp-run-execute-exe/asp-execute-exe-wscript-shell/](http://www.shotdev.com/asp/asp-run-execute-exe/asp-execute-exe-wscript-shell/)

我过去使用过最后两种方法。

编辑：根据您的评论回复，ASP JPEG 可以完成您需要的一切：

[http://www.aspjpeg.com/manual_04.html](http://www.aspjpeg.com/manual_04.html)

# mysql - 移动数据库和驱动程序后无法启用约束错误

> ID：14532053
> 
> 赞同：2
> 
> 时间：2013-01-25T23:39:01.923
> 
> 标签：mysql, database, text, sqldatatypes

我正在将一个相当大的系统转移到一个新的服务器和新的 MySQL 数据库上。

该系统已经使用 ODBC 数据驱动程序在 MySQL 上运行了几年，我现在使用 MySQL 驱动程序并开始遇到问题。

```
Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints. 
```

一些谷歌搜索把我带到了这篇文章：

[http://weblogs.asp.net/rosherove/archive/2004/10/03/DataSet-hell-2D00-_2200_Failed-to-enable-constraints.-One-or-more-rows--contain-values_2E002E002E002E002200_.aspx *_* _](http://weblogs.asp.net/rosherove/archive/2004/10/03/DataSet-hell-_2D00_-_2200_Failed-to-enable-constraints.-One-or-more-rows--contain-values_2E002E002E002E002200_.aspx)

在阅读了包括 MySQL 文档在内的其他一些文档后，我发现问题在于`text`我的数据库中的某些字段具有相当大的内容。

我将问题的一个实例追溯到单独的记录，修改了其中一个`text`字段中的数据，使其更短并且消除了问题。

将内容放入 MS Word 后，字符数为 30,000，`LENGTH(report)`在 phpMyAdmin 上的 Query 中运行（报告是字段名称）（它会愉快地显示所有行）同意，它显示长度为 33108

所以，这一定是问题所在，但我肯定可以处理这种数据吗？

我不确定问题出在哪里，是新的数据库设置，还是 MySQL 驱动程序的使用？

我正在尝试`DataTable`按如下方式使用数据：

```
Public Shared Function getTable() as DataTable
    Dim connection As MySqlConnection = Common.getConnection()        
    connection.Open()
    Dim connect As MySqlCommand = Common.createCommand(sql, connection)
    Dim getData As New DataTable()
    getData.Load(connect.ExecuteReader(CommandBehavior.CloseConnection))
    return getData
End Function

Public Shared Function getConnection() As MySqlConnection
    Dim DBConnection As String
    DBConnection = ConfigurationManager.ConnectionStrings("dbConn").ConnectionString
    Dim oConnection As MySqlConnection = New MySqlConnection(DBConnection) 
    getConnection = New MySqlConnection(DBConnection)
End Function

Public Shared Function createCommand(sql As String, connection As MySqlConnection) As MySqlCommand
    createCommand = New MySqlCommand(sql, connection)
End Function 
```

（以前我使用`OdBcCommand`and `OdBcConnection`s 并且一切正常！）

我不确定从这里去哪里，没有过滤我不想做的所有数据，并删除所有长字段我不确定如何解决这个问题？

非常感谢任何建议！

=============

更新以防万一，从接受的答案（非常感谢）：

更改我的代码：

```
 Dim getData As New DataTable()
    getData.Load(connect.ExecuteReader(CommandBehavior.CloseConnection)) 
```

至：

```
 Dim dataset As New DataSet()
    Dim getData As New DataTable()
    dataset.Tables.Add(getData)
    getData.DataSet.EnforceConstraints = False
    getData.Load(connect.ExecuteReader(CommandBehavior.CloseConnection)) 
```

删除了这个问题，现在长字段工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T06:33:52.867

我找到的解决方案很少。

*   清除 Dataset / DataTable 并重新绑定绑定。[在这里](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/00698a44-8fd6-4f04-b168-5842b52487a6/#b17da25c-831d-48ae-8756-bbd27f9dbf86)继续阅读。

*   要么不调用 FillSchema，要么禁用对 Datatable 的约束检查。[在这里](http://bugs.mysql.com/bug.php?id=36364)继续阅读。

*   将 EnforceConstraints 设置为 false 并在此之后加载数据。

    ```
    Dim getData As New DataTable()
    getData.DataSet.EnforceConstraints = false;
    getData.Load(connect.ExecuteReader(CommandBehavior.CloseConnection))
    return getData 
    ```

    [在这里](http://msdn.microsoft.com/en-us/library/st1t2c35.aspx)继续阅读。

# c++ - 智能指针不适用于 Android NDK r8

> ID：14532057
> 
> 赞同：13
> 
> 时间：2013-01-25T23:39:13.603
> 
> 标签：c++, gcc, c++11, android-ndk, smart-pointers

我不知道如何在我的 Android 项目中使用共享指针。我在带有 Android NDK r8d 的 Mac OS X 上使用最新的 Eclipse ADT。

这是我的`Android.mk`文件中的内容：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_CPPFLAGS  := -std=c++11
LOCAL_MODULE    := native
LOCAL_SRC_FILES := native.cpp
include $(BUILD_SHARED_LIBRARY) 
```

这是我的`Application.mk`文件中的内容：

```
NDK_TOOLCHAIN_VERSION=4.7
APP_STL := stlport_shared 
```

我已经尝试过默认的 GCC 4.6、实验性 4.7 和 clang3.1 工具链。
我已经尝试链接到`stlport_shared`C `gnustl_shared`++ 运行时库。
我试过`FLAGS` `-std=c++11`,`-std=c++0x`和`-std=gnu++11`.

我能够使用 c++11 标准的 lambdas 和 auto，因此 C++11 标志似乎正在工作。但是，每当我尝试使用 shared_ptr、weak_ptr 或 unique_ptr 时，我都会收到错误消息`'suchandsuch_ptr' is not a member of 'std'`

我的`#include <memory>`cpp文件中有这个。现在 Eclipse 告诉我`Unresolved inclusion: <memory>`，但我得到了同样的东西，`<vector>`并且`<string>`那些似乎编译和工作得很好。

Android NDK 中包含的工具链中是否没有实现智能指针？
如果不是，为什么不呢？由于 GCC 和 clang 支持智能指针已经有一段时间了，这意味着我要么遗漏了一些东西，要么 Android 开发人员出于某种原因禁用了它们。
有什么线索吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T03:11:11.807

确保标准库包含路径（如`/android-ndk-r8d/sources/cxx-stl/gnu-libstdc++/4.7/include`）在目标设置中。

要让 IDE 识别 GNU 标准库中的 C++11 类，请将`__GXX_EXPERIMENTAL_CXX0X__`预定义宏添加到索引器中。（这个名字有点不合时宜，因为 C++11 是标准化的，并且支持不再是实验性的，但目前还是这么称呼的。）另外，请确保索引器设置为反映正确的构建目标。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-21T19:30:09.290

这些设置为我做到了：

**应用程序.mk：**

```
NDK_TOOLCHAIN_VERSION=4.7
APP_STL := gnustl_static 
```

**安卓.mk：**

```
LOCAL_CFLAGS :=-D__GXX_EXPERIMENTAL_CXX0X__  <--important
LOCAL_CPPFLAGS  := -std=c++11 
```

**Eclipse 设置：** C/C++ General\Path 和 Symbols 应包含：

```
C:\android\ndk\sources\cxx-stl\gnu-libstdc++\4.7\include
C:\android\ndk\sources\cxx-stl\gnu-libstdc++\4.7\libs\armeabi\include 
```

# regex - 测试参数是否为 5 位整数

> ID：14532058
> 
> 赞同：3
> 
> 时间：2013-01-25T23:39:22.880
> 
> 标签：regex, linux, bash, unix

我想测试我的`bash`脚本中的参数是否是 5 位整数。

```
if [ "$1" == [0-9][0-9][0-9][0-9][0-9] ]; then
    echo "first arg is 5 digits"
else
    echo "not 5 digits" 
```

这对我不起作用，有没有更简单的方法可以做到这一点，即使用该`expr`功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:46:53.370

见：`CONDITIONAL EXPRESSIONS`_`man bash`

```
if [[ "$1" =~ ^[0-9]{5}$ ]]; then
    echo "first arg is 5 digits"
else
    echo "not 5 digits"
fi 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T00:14:34.777

测试这种表达式时必须使用双括号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:47:45.343

```
case "$1" in
  [0-9][0-9][0-9][0-9][0-9]) echo "first arg is 5 digits" ;;
  *) echo "not 5 digits" ;;
esac 
```

# sql - 如果我在 where 子句中有用户定义的函数，如何改进

> ID：14532062
> 
> 赞同：0
> 
> 时间：2013-01-25T23:39:28.640
> 
> 标签：sql, sql-server, tsql

我有一个查询，它在 where 子句中使用用户定义的函数将数组拆分为值表。是这样的：

```
select ...
from ...
where EXISTS(SELECT Value FROM fn_Split(@Status,'#')
and EXISTS(SELECT Value FROM fn_Split(@Type,'#') 
```

@Status 和 @Type 由用户传入。他们可以选择多个值进行查询。

有没有办法删除这个用户定义的函数？你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:43:17.973

似乎`fn_Split(@Status, '#')`并不`fn_Split(@Type, '#')`依赖于您的外部查询。在这种情况下，您可以在执行查询之前调用这两个函数（我想它们可能会返回表），然后在查询中使用这些表。如果它们很大，您可以尝试向它们添加索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T03:06:04.290

您不能总是相信执行计划所说的内容，尤其是在涉及标量函数时。

您可以测试标量拆分函数的效果 - 将一些典型输入输入到这些函数中，并使用硬编码和 SET STATISTICS IO/TIME ON 进行选择，然后对拆分中的相同数据执行相同操作. 如果标量引起了问题，那应该是显而易见的。

# x11 - XSync - 丢弃参数是什么意思？

> ID：14532065
> 
> 赞同：5
> 
> 时间：2013-01-25T14:09:52.577
> 
> 标签：x11

根据[手册页](http://linux.die.net/man/3/xsync)，调用`XSync(dpy, 1)`会丢弃队列中的事件，但这究竟意味着什么？如果它们没有被丢弃，它们是否被发送了两次（一次通过`XSync()`调用，第二次在队列正常清空时）？或者它就像一个垃圾收集器（事件会在稍后被丢弃）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T14:52:43.703

[`XSync`](http://tronche.com/gui/x/xlib/event-handling/XSync.html)等待直到请求输出缓冲区被清空（发送到服务器）。如果`discard`参数为`True`，此函数将丢弃所有排队的事件。这些事件是从 X 服务器接收的。

考虑以下协议交换：

```
C -> S  QueryKeymap request
                                C <- S ConfigureNotify event
                                C <- S QueryKeymap reply 
```

您调用了向服务器发送协议消息`XQueryKeymap`的客户端应用程序。`QueryKeymap`这样做时，您调整了窗口的大小，从而调整了`ConfigureNotify`事件。

如果你`XSync(display, False)`在你的之后运行`XQueryKeymap`，那么客户端将等到收到回复。下一次`XPending(display)`调用将返回`1`用于上述`ConfigureNotify`事件的排队事件的数量。

当`XSync(display, True)`被使用时，则`XPending(display)`返回`0`上述情况。

如果您的代码要被其他人使用，请**不要**使用`True`. 有关使用 时可能出错的示例`True`，请参阅[http://bugzilla.libsdl.org/show_bug.cgi?id=1859](http://bugzilla.libsdl.org/show_bug.cgi?id=1859)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T15:07:59.870

似乎您误解了两件事：X 请求与 X 事件，这是不一样的。简而言之：

X 请求：

> ...客户端应用程序通过此连接向 X 服务器发送请求。这些请求由客户端应用程序中调用的 Xlib 函数发出。...

X 事件：

> ... 许多 Xlib 函数导致 X 服务器生成事件，而用户键入或移动指针可以异步生成事件。X 服务器向客户端返回事件...

有关更多信息，请查看[此](http://www.tronche.com/gui/x/)- 它非常有帮助。

XSync 以这种方式调用：`XSync(dpy, False)`做两件事（根据您指出的 manul）：

> XSync 函数刷新输出缓冲区，然后等待，直到所有请求都已被 X 服务器接收并处理。

XSync 以这种方式调用：`XSync(dpy, True)`执行上述两件事加上另外一项：丢弃（处理）队列中的所有事件。

> 如果您传递 True，XSync() 将丢弃队列中的所有事件，包括调用 XSync() 之前队列中的那些事件。

例如（伪代码）：

```
sendEvent2Xserver() //for example by pressing the key
endEvent2Xserver() //for example by mouse button press
XSendEvent() //sending chosen event to X server
XSync(dpy, True) // after this call, it's guaranteed that all the previous events were processed by the server 
```

# javascript - JavaScript UL 垂直文本

> ID：14532067
> 
> 赞同：0
> 
> 时间：2013-01-25T23:39:48.427
> 
> 标签：javascript, html-lists

我想要实现的是让 javascript 采用 UL 并垂直编写每个 LI，如下所示：

```
 O  T  T  F
  N  W  H  O
  E  O  R  U
        E  R
        E 
```

我可以使用 css 设置列表样式，但我需要使用 JavaScript 进行垂直编写。我对 JavaScript 不是很好，有人可以帮我解决这个问题吗？或者给我举个例子？

谢谢

编辑 - 对不起，我应该更清楚我想要做什么。我有一些 js 需要一个列表并在单击按钮时按字母顺序对其进行排序。我希望列表正常显示，直到单击按钮。然后它应该按字母顺序显示文本并垂直书写文本。这是我的[jsfiddle](http://jsfiddle.net/cates044/CFwJL/27/ "jsfiddle")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:42:32.390

您可以使用 CSS 进行垂直书写：

```
width:1px;
word-break:break-all; 
```

您可能需要调整边距以确保字母有足够的空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:42:27.770

您可以简单地使 li 元素的宽度仅足以容纳每行一个字符，并使用边距和填充来完成其余的工作。

# javascript - 包括带有 html 和 node.js 的 js 文件

> ID：14532071
> 
> 赞同：10
> 
> 时间：2013-01-25T23:40:24.343
> 
> 标签：javascript, html, node.js, eval

我正在通过 websockets 在 HTML5 客户端和在 node.js 上运行的服务器之间执行消息传递。自然地，我选择了 JSON 作为消息格式，因此创建了通用的 javascript 代码，定义了各种消息内容类型和转换操作。javascript 代码在两个项目之间共享。

我将我的 Web 客户端创建为一个 git 项目，将我的服务器创建为另一个 git 项目。部分原因是我正在使用 phonegap 为各种基于触摸的环境构建基于 webkit 的客户端。这也是各种逻辑的很好分离。

为了共享通用代码，我为通用逻辑创建了一个单独的项目，并使用 git 的子项目将代码“导入”到其他两个项目中。

现在这适用于基于 html5 的项目，因为我可以执行以下操作来包含代码：

```
<script src="common/js/comms.js" type="text/javascript"></script> 
```

但是对于节点，我在尝试获取代码时遇到了问题。为了获得代码，我最终做了以下事情：

```
var fs = require('fs');
eval(fs.readFileSync('./common/js/comms.js').toString()); 
```

虽然我采用的方法有效，但我注意到当我有依赖项时它开始变得非常混乱（例如，如果我想要 a.js，我需要 x.js、y.js 和 x.js），而且我必须为希望使用这些实体中的任何一个的每个 node.js js 文件执行此操作。

我也不习惯使用这种`eval`方法。我没有安全问题，尽管我想使用严格模式，我的理解是 eval 和严格模式像油和水一样结合在一起。

所以我的问题是，在 html 项目和 node.js 项目之间包含共享 js 文件的最佳方法是什么？我更喜欢遵循严格的东西。

我应该注意到，虽然围绕这个主题有几个问题，但我找不到任何可以解决我提出的具体问题的问题。我还应该补充一点，我不希望从“服务器”“提供”文件。HTML5 客户端是“独立的”。

* * *

澄清一下，我在“通用 js 文件”中的内容类似于以下内容：

```
var Comms = function (options) {
   ...
} 
```

在 HTML5 中，我可以只引用 via `new Comms()`，这也是我希望在 node.js 中做的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T23:48:21.420

你研究过 Node 模块是如何工作的吗？如果您正在使用此模式进行开发，那么`require('./common/js/comms')`在服务器上使用它相当简单，同时仍将其包含在您的客户端上。

本文应该为您指明正确的方向：[https ://caolan.org/posts/writing_for_node_and_the_browser.html](https://caolan.org/posts/writing_for_node_and_the_browser.html)

* * *

以下是 Tyler 在下面的评论中链接到的代码。

示例（example.js）：

```
if(typeof exports == "undefined"){
    exports = this;
}

Example = function() {
    this.init();
};

Example.prototype = {
    init: function() {
         console.log('hello world');
    }
};

exports.Example = new Example(); 
```

example.js（app.js）的node.js用法：

```
example = require('./example'); 
```

example.js（index.html）的html用法：

```
<html>
    <head>
        <title></title>
    </head>
    <body>
        <script src="./example.js"></script>
    </body> 
```

OP 的更改是分配`exports.Example`给`Example`而不是分配给新实例。因此 node.js 逻辑可以使用以下内容：

```
var Example = require('./example.js').Example;
var foo = new Example(); 
```

这样原问题就解决了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:48:59.783

看看[nodeJS 模块](http://nodejs.org/docs/latest/api/modules.html)。

将在 comm.js 中：

```
module.exports = function(/* any dependency? */){
   // things
   // you can return some object
} 
```

在你需要 comm.js 的文件中

```
require('./common/js/comm.js')();
// or you can assign it to a variable if it returned something 
```

希望有帮助！

# ruby-on-rails - RAILS 3 + Paperclip：克隆对象窃取原始对象的附件

> ID：14532076
> 
> 赞同：2
> 
> 时间：2013-01-25T23:40:49.103
> 
> 标签：ruby-on-rails, paperclip, clone

我很生气，`Paperclip`因为我需要克隆一个 ActiveRecord 对象（模型名称是`Product`）及其附件，但是克隆“窃取”了原始对象附件

这就是我的`products_controller.rb`：

```
original = Product.find_with_account(params[:id], @current_account)
clone_object = original.dup
clone_object.name = "#{original.name.split('-').first}-#{random_string}"
clone_object.product_photos = original.product_photos
clone_object.save 
```

（在中间我还添加了一个哈希以避免我的产品之间的命名冲突）。

换句话说，我想拥有：

```
ORIGINAL -> [Image1, Image2 ...] 
```

...克隆...

```
ORIGINAL -> [Image1, Image2 ...]
CLONED -> [Image1Clone, Image2Clone ...] 
```

你能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T15:40:07.700

`dup`不会复制关联的对象。您必须编写自己的克隆方法来复制原始附件并将它们与复制的产品相关联。

# python - 处理curses中的多个字符串

> ID：14532078
> 
> 赞同：0
> 
> 时间：2013-01-25T23:40:57.467
> 
> 标签：python, curses

`curses`我正在尝试使用Python 中的库制作一个类似于“Falldown”的游戏，这是我在高中时玩过的 TI-83 计算器游戏。它涉及一个永远下落的球，你必须通过洞来操纵它，如果你没有进入洞，球会在屏幕顶部被压扁（YouTube it）。

到目前为止，我只有一个甚至还没有漏洞的障碍类。我只希望我的障碍永远“向上滚动”。我可以让它为一个障碍（`obs1`）工作，但是当我尝试添加第二个（`obs2`）时，会发生不好的事情。在下面的代码中，两个障碍物都在屏幕上，但它们正好在彼此之上，所以它看起来只是一个障碍物。

`obs2`基本上，当`obs1`到达屏幕的一半时，我该如何开始？

```
#!/usr/bin/python

import curses
import time
import random

class obstacle:
  def __init__(self):
    self.pos = dims[0]-1
    self.s = ''
    for x in range(0,dims[1]-1):
      self.s += '='

  def scroll(self):
    self.pos -= 1

screen = curses.initscr()

curses.start_color()
curses.init_pair(1, curses.COLOR_GREEN, curses.COLOR_BLACK)
screen.nodelay(1)
dims = screen.getmaxyx()

q=-1
obs1 = obstacle()
obs2 = obstacle()

while q < 0:
  q = screen.getch()
  if obs1.pos < 0:
    obs1 = obstacle()
  if obs2.pos < 0:
    obs2 = obstacle()
  screen.clear()
  screen.addstr(obs1.pos, 0, obs1.s, curses.color_pair(1))
  screen.addstr(obs2.pos, 0, obs2.s, curses.color_pair(1))
  obs1.scroll()
  obs2.scroll()
  screen.refresh()
  time.sleep(.04)
screen.getch()
curses.endwin() 
```

最终我会想要一次在屏幕上出现大约 4 个障碍物，永远向上滚动。有什么提示可以让我从 2 开始吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:04:37.483

你需要考虑清楚你想要什么。什么是`obs2`之前`obs1`通过屏幕的一半？没什么吗？屏幕外的障碍物？一个正常工作但没有被绘制的障碍物？

无论您决定什么都非常容易编码。我会选择最困难的并展示如何让它发挥作用：我们甚至不会创建`obs2`，直到`obs1`足够远。这意味着我们必须检查`if obs2 is not None`我们使用它的任何地方，然后在适当的时候在某处添加一行来创建它。所以，像这样：

```
obs1 = obstacle()
obs2 = None

while q < 0:
  q = screen.getch()
  if obs1.pos < 0:
    obs1 = obstacle()
  if obs2 is not None and obs2.pos < 0:
    obs2 = obstacle()
  # Here's where we create obs2 on the fly
  if obs2 is None and obs1.pos == dims[0]/2:
    obs2 = obstacle()
  screen.clear()
  screen.addstr(obs1.pos, 0, obs1.s, curses.color_pair(1))
  if obs2 is not None:
    screen.addstr(obs2.pos, 0, obs2.s, curses.color_pair(1))
  obs1.scroll()
  if obs2 is not None:
    obs2.scroll()
  screen.refresh()
  time.sleep(.04) 
```

假设我们想从 开始`obs2`偏移一点`obs1`。在这种情况下，我们只想`pos`在第一次使用不同的方式构造它，其他所有内容都与您的原始代码保持不变：

```
class obstacle:
  def __init__(self, offset=1.0):
    self.pos = int((dims[0]-1) * offset)
    self.s = ''
    for x in range(0,dims[1]-1):
      self.s += '='

  def scroll(self):
    self.pos -= 1

screen = curses.initscr()

curses.start_color()
curses.init_pair(1, curses.COLOR_GREEN, curses.COLOR_BLACK)
screen.nodelay(1)
dims = screen.getmaxyx()

q=-1
obs1 = obstacle()
obs2 = obstacle(.5)

while q < 0:
  q = screen.getch()
  if obs1.pos < 0:
    obs1 = obstacle()
  if obs2.pos < 0:
    obs2 = obstacle()
  screen.clear()
  screen.addstr(obs1.pos, 0, obs1.s, curses.color_pair(1))
  screen.addstr(obs2.pos, 0, obs2.s, curses.color_pair(1))
  obs1.scroll()
  obs2.scroll()
  screen.refresh()
  time.sleep(.04)
screen.getch()
curses.endwin() 
```

# c++ - 相机的 C++ 速度不是预期的

> ID：14532083
> 
> 赞同：0
> 
> 时间：2013-01-25T23:41:42.420
> 
> 标签：c++, performance, graphics, camera

所以现在在 C++ 中，我有一个第一人称相机，控制正常，相机移动正常。但我唯一的问题是相机的速度不是预期的，让我解释一下：

（3D 场景）

10个物体->相机速度很快

1000 对象 -> 慢镜头速度

* * *

所以基本上我所做的就是像这样随着时间的推移而倍增：

Newpos += 速度 * DeltaTime；

但是当我的程序有负载时，相机速度会降低很多！那么这里发生了什么，我做错了什么？

时间码（结果看起来不错，以秒为单位）：

```
double DeltaTime::milliseconds_now() 
{
    static LARGE_INTEGER s_frequency;
    static BOOL s_use_qpc = QueryPerformanceFrequency(&s_frequency);
    if (s_use_qpc) {
        LARGE_INTEGER now;
        QueryPerformanceCounter(&now);
        return (1000LL * now.QuadPart) / s_frequency.QuadPart;
    } else {
        return GetTickCount();
    }
}

void DeltaTime::OnStart()
{
    //ticks = (float)GetTickCount();
    QueryPerformanceFrequency( &m_liPerformanceFrequency);
}

float DeltaTime::GetDelta()
{
    return ((float)dTime/(float)1000000.0f);
}

void DeltaTime::OnFinish()
{
    if (timeFirst)
    {
        //ticks = 0;
        dTime = 0;
        timeFirst = false;
        return;
    }

    //ticks = ((float)ticks = (float)GetTickCount() - (float)ticks);
    QueryPerformanceCounter( &liPerformanceCount);
    dTime = double(liPerformanceCount.QuadPart)/double(m_liPerformanceFrequency.QuadPart);
} 
```

框架：

```
void OnFrame(...)
{
 ...
 timeHandler.OnFinish();
 timeHandler.OnStart();
 ...
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T21:25:25.253

不知何故，我两次调用 on start 函数，但现在无论如何系统都被修改了。

# php - 单个可缓存的大型 CSS 与特定于页面的小型 CSS 片段

> ID：14532084
> 
> 赞同：1
> 
> 时间：2013-01-25T23:41:50.630
> 
> 标签：php, css, caching, latency, minimize

现在我的 CSS 文件看起来像这样：

![CSS 文件](../Images/751489094e1c17a0b2cfdd1dd6894c3a.png)

然后我有一个看起来像这样的 php 片段：

```
<?php $Compress->folder(Configuration::get('Public').'/style/',
                        '.css',
                        Configuration::get('Public').'/style.css'); ?> 
```

这将目录中存储的所有 css 文件最小化`public_html/style/`（如图所示），并在目录中创建一个`/public_html/`名为 style.css 的文件。它仅在需要时运行，尽管始终处于开发阶段。

然后我只包含大文件：`<link rel="stylesheet" href="http://newfutureuniversity.org/style.css" type="text/css" media="screen" >`.

我专注于 php 开发，现在我实际上开始开发网站的设计并希望对其进行优化。据我了解，用户必须下载的文件越少，文件越小越好（因此我的加入和最小化类）。然而，当页面特定的 CSS 文件很少时，这会引发其他问题。为什么我的主页必须加载表单 CSS 文件？还是主页面一的形式？据我所知，有3个主要选项：

## 1.第一次下载所有内容。

用户第一次访问该站点时，他会下载整个最小化的 css 文件。第一次会很慢，但每次访问都会快得多。它也更容易配置。

## 2\. 先下载通用代码，再下载页面专用代码。

每次访问都是中等速度；第一个稍微慢一点，然后下一个稍微快一点，但仍然不是最好的。第一次用户下载2个文件，普通的一个被缓存以备下次访问。

## 3.每个页面都有不同的CSS文件。

每个页面的 CSS 是需要的 CSS 加上页面特定的，所以它不能存储在缓存中。比 2 的第一次更快。但后来变慢了。

* * *

我只是猜测它归结为用户访问了多少页面以及特定于页面的代码量。如果普通用户访问 1 或 2 个页面，则您需要第二个甚至第三个选项。但是，如果用户访问您网站的 20 或 30 个页面，那么您需要第一个选项。

那么，哪种方法对服务器负载和用户延迟都更好，为什么？我正在处理的页面需要很小，因为需要移动访问和远程位置访问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:47:19.150

就个人而言，下载一个大的 CSS 文件比引发多个 HTTP 请求更可取，尤其是当您的网页通过浏览器查看时，该浏览器只允许每个域同时有两个 HTTP 请求。此外，样式表将被缓存以供后续请求使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:54:38.360

我猜第一次下载一切，我的论点：

*   即使是大 (>50KB) 的 CSS 文件也不会损害您的浏览器，通过适当的缩小和压缩，它可以减少到 ~15KB 或更少
*   你/我们可能已经包含了更大的文件（jQuery unminified uncompressed :~70KB），你/我们不会抱怨

# entity-framework - 实体框架数据库优先 - 关系

> ID：14532090
> 
> 赞同：0
> 
> 时间：2013-01-25T23:42:23.233
> 
> 标签：entity-framework, edmx, database-first

我想我已经了解 CodeFirst。现在我知道数据库优先 EF 设计是针对现有数据库的，但是如果我要快速进入并在 Management Studio 中创建一个新数据库并创建一些表，那么在 Management Studio 中为表创建关系是否正常？ edmx 设计器，我在 edmx 中尝试过，但在调试时出错。这里的最佳实践是什么？如果我要在设计器中创建表之间的关联，正确的步骤是什么？管理工作室中的数据库如何知道要更新？任何提示/建议表示赞赏。

![在此处输入图像描述](../Images/fefddae40514d0f5c53a003f9b006bb7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:54:56.653

在实体更新时，请尝试使用`Run Custom Tool`您的模型以避免错误。只是`Right Click`你的模型和`Run Custom Tool`。

# sql - 使用触发器时 SQL 数据库处于锁定状态

> ID：14532094
> 
> 赞同：1
> 
> 时间：2013-01-25T23:43:03.107
> 
> 标签：sql, sql-server, triggers, deadlock, sqltransaction

我有一个死锁的问题..

我正在尝试为我的数据库的更新提供 sql 依赖项。

我通过在一系列表上创建触发器来做到这一点。修改表时，我在辅助表中增加一个整数，例如。[dbo].[计数器]。然后我在这个表上放置一个 SQL 依赖项，以了解哪个表是从代码更新的。

但是，我放置触发器的目标表可以在事务中使用，在这种情况下，很容易使事务死锁。

即 tbl1 在插入/更新/删除时触发以更新计数器表 tbl2 在插入/更新/删除时触发以更新计数器表

事务 A 发生在 thread1 tbl1 被修改，触发了 counter 表的更新

事务 B 发生在线程 2 tbl2 被修改，这触发了计数器表的更新，线程 2 现在被阻塞等待线程 1

同时在 thread1 上，事务 A 继续，并更新另一个表（tbl1 或 tbl2）

现在发生死锁，其中一个线程被选为受害者。

我的问题是，是否有更好的方法来创建触发器以消除死锁的可能性？任何人都知道 ASP.NET 中的默认 SQLDependency 如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:46:20.607

你能容忍未使用的计数器值吗？如果是这样，只需在更新计数器时退出事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T17:22:24.993

好的总结一下，

死锁是由不同的事务在递增表上同时获取范围锁和行锁引起的。

ASP.NET SQLDependency 对触发器使用 ROWLOCK 提示来消除死锁情况。然而，这引入了阻塞行为，因此如果 2 个事务正在修改同一个递增表，则这些事务本质上是序列化的。

MS Support 的建议是将 ROWLOCK 提示更改为 READPAST。如果同时修改递增表中的不同行，这会减少阻塞行为。

由于通知不需要 RDBMS 的绝对 ACID 属性，因此一种高级策略可能是使用非阻塞全局变量（如 context_info）作为一组二进制标志来存储行已更改的事实（这将消除同一行的阻塞）表），但是需要对调用应用程序进行逻辑更改以处理和重置变量。

# spring - Spring Security 身份验证管理器自动装配

> ID：14532098
> 
> 赞同：0
> 
> 时间：2013-01-25T23:43:22.880
> 
> 标签：spring, security, authentication, autowired

经过几个小时的绝望试图找出为什么我的自定义身份验证管理器没有自动装配，我来这里寻求一点帮助。所以我有 Web 应用程序，在 Spring 上运行（使用 Stripes）。身份验证由我的自定义类完成。一切正常 - 在 jsp 中，我可以使用 jsp 标签和一切，http 拦截器可以正常工作。但是，当我尝试将身份验证管理器自动连接到 Jersey“REST 类”时，一切都出错了，并且没有注入任何东西。

所以，在 web xml 中我有两个上下文文件：

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/spring-context.xml
        /WEB-INF/spring-security.xml
    </param-value>
</context-param> 
```

弹簧安全.xml：

```
<context:component-scan base-package="org.springframework.security" />
<context:annotation-config/>

<http use-expressions="true" auto-config="true">

</http>

<authentication-manager alias="authManager">
    <authentication-provider ref="AuthenticationManagerBean" />
</authentication-manager> 

<beans:bean id="AuthenticationManagerBean" class="com.manager.services.MyAuthenticationManager"/>
<beans:bean id="expressionHandler" class="org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler" /> 
```

Jersey action bean 内部是这样的：

```
@Inject
@Qualifier("authManager")
protected AuthenticationManager authenticationManager; 
```

整个应用程序构建正常，码头服务器启动没有问题（MyAuthenticationManager 和 org.springframework.security.authenticationManager 都已成功预先设置），但是当尝试使用自动连接的 authmanager 时，我得到空指针。

**编辑：** 我已经成功地将 AuthenticationManager 自动装配到 Stripes 的动作 Bean 中，但是 Jersey 的动作 bean 仍然存在问题，其中构造 @Inject @Qualifier(...) 不适用于 AuthManager（但适用于其他自动装配的 bean，尽管没有 @Qualifier ，只是@Inject）。

**编辑 2：** 在试图找出 Spring 不将 authenticationManager 注入 Jersey Beans 的原因几个小时后，我解决了这个问题：

```
@Inject
@InjectParam("org.springframework.security.authenticationManager")
protected AuthenticationManager authenticationManager; 
```

我不知道它是否是好的解决方案，但它正在工作，现在 spring 注入了正确的身份验证管理器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:49:26.103

IANASG（IA 不是条纹大师。）我假设 Action Bean 是条纹构造？如果它不是由 spring 管理（实例化等），那么不会有任何东西被注入它，因为它是一个 POJO，而 Spring 对此一无所知。

这看起来不对

```
<context:component-scan base-package="org.springframework.security" /> 
```

基本包应该是您的代码中包含应扫描的 bean 的包。

# python - 通过重新排列列表构建可能的最大数字

> ID：14532105
> 
> 赞同：21
> 
> 时间：2013-01-25T23:44:24.020
> 
> 标签：python, algorithm, list, python-2.7, integer

假设我有一个正整数数组；我想操纵顺序，以便结果数组的串联是可能的最大数字。例如`[97, 9, 13]`结果`99713`；`[9,1,95,17,5]`结果`9955171`。我不确定答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-26T04:39:58.187

`sorted(x, cmp=lambda a, b: -1 if str(b)+str(a) < str(a)+str(b) else 1)`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-26T18:10:03.123

Intuitively, we can see that a reverse sort of single digit numbers would lead to the higest number:

```
>>> ''.join(sorted(['1', '5', '2', '9'], reverse=True))
'9521' 
```

so reverse sorting should work. The problem arises when there are multi-digit snippets in the input. Here, intuition again lets us order `9` before `95` and `17` before `1`, but why does that work? Again, if they had been the same length, it would have been clear how to sort them:

```
95 < 99
96 < 97
14 < 17 
```

The trick then, is to 'extend' shorter numbers so they can be compared with the longer ones and can be sorted automatically, lexicographically. All you need to do, really, is to *repeat the snippet* to beyond the maximum length:

*   comparing `9` and `95`: compare `999` and `9595` instead and thus `999` comes first.
*   comparing `1` and `17`: compare `111` and `1717` instead and thus `1717` comes first.
*   comparing `132` and `13`: compare `132132` and `1313` instead and thus `132132` comes first.
*   comparing `23` and `2341`: compare `232323` and `23412341` instead and thus `2341` comes first.

This works because python only needs to compare the two snippets until they differ somewhere; and it's (repeating) matching prefixes that we need to skip when comparing two snippets to determine which order they need to be in to form a largest number.

You only need to repeat a snippet until it is longer than the longest snippet * 2 in the input to guarantee that you can find the first non-matching digit when comparing two snippets.

You can do this with a `key` argument to `sorted()`, but you need to determine the maximum length of the snippets first. Using that length, you can 'pad' all snippets in the sort key until they are longer than that maximum length:

```
def largestpossible(snippets):
    snippets = [str(s) for s in snippets]
    mlen = max(len(s) for s in snippets) * 2  # double the length of the longest snippet
    return ''.join(sorted(snippets, reverse=True, key=lambda s: s*(mlen//len(s)+1))) 
```

where `s*(mlen//len(s)+1)` pads the snippet with itself to be more than `mlen` in length.

This gives:

```
>>> combos = {
...     '12012011': [1201, 120, 1],
...     '87887': [87, 878],
...     '99713': [97, 9, 13],
...     '9955171': [9, 1, 95, 17, 5],
...     '99799713': [97, 9, 13, 979],
...     '10100': [100, 10],
...     '13213': [13, 132],
...     '8788717': [87, 17, 878],
...     '93621221': [936, 21, 212],
...     '11101110': [1, 1101, 110],
... }
>>> def test(f):
...     for k,v in combos.items():
...         print '{} -> {} ({})'.format(v, f(v), 'correct' if f(v) == k else 'incorrect, should be {}'.format(k))
... 
>>> test(largestpossible)
[97, 9, 13] -> 99713 (correct)
[1, 1101, 110] -> 11101110 (correct)
[936, 21, 212] -> 93621221 (correct)
[13, 132] -> 13213 (correct)
[97, 9, 13, 979] -> 99799713 (correct)
[87, 878] -> 87887 (correct)
[1201, 120, 1] -> 12012011 (correct)
[100, 10] -> 10100 (correct)
[9, 1, 95, 17, 5] -> 9955171 (correct)
[87, 17, 878] -> 8788717 (correct) 
```

Note that this solution is a) 3 lines short and b) works on Python 3 as well without having to resort to `functools.cmp_to_key()` and c) does not bruteforce the solution (which is what the `itertools.permutations` option does).

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-25T23:46:36.050

提示一：你连接字符串，而不是整数。提示二：`itertools.permutations()`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-26T00:23:37.153

```
import itertools
nums =  ["9", "97", "13"]
m = max(("".join(p) for p in itertools.permutations(nums)), key = int) 
```

您可以按照提示使用 itertools.permutations 并在将它们与 join 函数连接后使用 max 函数的 key 参数（它告诉将哪个函数应用于每个元素以确定最大值）。

从一开始就使用字符串更容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-26T01:18:37.190

我不喜欢这种蛮力方法。对于大型集合，它需要大量的计算。

[您可以为sorted](http://docs.python.org/2/library/functions.html#sorted)内置方法编写自己的比较函数，该函数将根据您放入函数中的任何逻辑返回任何对的排序参数。

示例代码：

```
def compareInts(a,b):
    # create string representations
    sa = str(a)
    sb = str(b)

    # compare character by character, left to right
    # up to first inequality
    # if you hit the end of one str before the other, 
    # and all is equal up til then, continue to next step
    for i in xrange(min(len(sa), len(sb))):
        if sa[i] > sb[i]:
            return 1
        elif sa[i] < sb[i]:
            return -1

    # if we got here, they are both identical up to the length of the shorter
    # one.
    # this means we need to compare the shorter number again to the 
    # remainder of the longer
    # at this point we need to know which is shorter
    if len(sa) > len(sb): # sa is longer, so slice it
        return compareInts(sa[len(sb):], sb)
    elif len(sa) < len(sb): # sb is longer, slice it
        return compareInts(sa, sb[len(sa):])
    else:
        # both are the same length, and therefore equal, return 0
        return 0

def NumberFromList(numlist):
    return int(''.join('{}'.format(n) for n in numlist))

nums = [97, 9, 13, 979]
sortednums = sorted(nums, cmp = compareInts, reverse = True)
print nums # [97, 9, 13, 979]
print sortednums # [9, 979, 97, 13]
print NumberFromList(sortednums) # 99799713 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-26T02:27:14.757

您可以通过一些巧妙的排序来做到这一点。

如果两个字符串的长度相同，请选择两个字符串中较大的一个。简单的。

如果它们的长度不同，请弄清楚如果将最佳组合附加到较短的组合会产生什么结果。由于较短的后面的所有内容都必须等于或小于它，因此您可以通过将短的附加到自身来确定这一点，直到它与较长的大小相同。一旦它们的长度相同，您就可以像以前一样进行直接比较。

如果第二个比较相等，则您已经证明较短的字符串不可能比较长的字符串更好。取决于它与之配对的内容可能会变得更糟，所以应该先出现更长的那个。

```
def compare(s1, s2):
    if len(s1) == len(s2):
        return -1 if s1 > s2 else int(s2 > s1)
    s1x, s2x = s1, s2
    m = max(len(s1), len(s2))
    while len(s1x) < m:
        s1x = s1x + s1
    s1x = s1x[:m]
    while len(s2x) < m:
        s2x = s2x + s2
    s2x = s2x[:m]
    return -1 if s1x > s2x or (s1x == s2x and len(s1) > len(s2)) else 1

def solve_puzzle(seq):
    return ''.join(sorted([str(x) for x in seq], cmp=compare))

>>> solve_puzzle([9, 1, 95, 17, 5])
'9955171'
>>> solve_puzzle([97, 9, 13])
'99713'
>>> solve_puzzle([936, 21, 212])
'93621221'
>>> solve_puzzle([87, 17, 878])
'8788717'
>>> solve_puzzle([97, 9, 13, 979])
'99799713' 
```

这应该比遍历所有排列更有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-26T00:31:05.540

好吧，总是有蛮力的方法......

```
from itertools import permutations
lst = [9, 1, 95, 17, 5]

max(int(''.join(str(x) for x in y)) for y in permutations(lst))
=> 9955171 
```

或者这个，@Zah 的答案的改编，它接收整数列表并返回一个整数，如问题中所指定：

```
int(max((''.join(y) for y in permutations(str(x) for x in lst)), key=int))
=> 9955171 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-13T16:14:31.060

```
import itertools
def largestInt(a):
    b = list(itertools.permutations(a))
    c = []
    x = ""
    for i in xrange(len(b)):
        c.append(x.join(map(str, b[i])))
    return max(c) 
```

# python - 当传递错误类型的对象时，如何防止 Django ORM 出错？

> ID：14532110
> 
> 赞同：0
> 
> 时间：2013-01-25T23:44:43.887
> 
> 标签：python, django

我们在测试时发现了这一点，一台机器设置为 MyISAM 作为默认引擎，另一台机器设置为 InnoDB 作为默认引擎。我们有类似于以下的代码

```
class StudyManager(models.Manager):
    def scored(self, school=None, student=None):
        qset = self.objects.all()
        if school:
            qset = qset.filter(school=school)
        if student:
            qset = qset.filter(student=student)
        return qset.order_by('something') 
```

问题代码如下所示：

```
print Study.objects.scored(student).count() 
```

这意味着“学生”被视为学校。这通过了 MyISAM 的测试，因为 student.id == school.id 因为 MyISAM 无法进行回滚并完全重新创建每个测试（重置自动增量 id 字段）。InnoDB 捕获了这些错误，因为回滚显然不会重置自动增量字段。

`id`问题是，在测试期间，由于所有模型都有一个字段，因此可能有许多其他错误由于鸭子类型而未被捕获。我担心排队的对象（在生产或测试中）上的 id 会导致问题/无法找到错误。

我可以像这样添加断言：

```
class StudyManager(models.Manager):
    def scored(self, school=None, student=None):
        qset = self.objects.all()
        if school:
            assert(isinstance(school, School))
            qset = qset.filter(school=school)
        if student:
            assert(isinstance(student, Student))
            qset = qset.filter(student=student)
        return qset.order_by('something') 
```

但这看起来很糟糕，而且需要做很多工作（回去改造）。在调试模式下它也更慢。

我考虑过可以将模型的 id 字段强制转换为 `model_id` (student_id for Student, school_id for School) 这样学校就没有 student_id 的想法，这只涉及指定主键字段，但 django 有一个.pk 中的快捷方式所以我猜这可能在所有情况下都没有帮助。

有没有更优雅的解决方案来捕捉这种错误？作为一个老 C++ 手，我有点想念类型安全。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:58:14.623

*这是 Python 的一个方面，与 Django本身*无关。

通过为函数参数定义默认值，您并*没有*消除*位置参数*的概念——您只是可以在调用函数时不指定所有参数。@mVChr 说在调用例程时需要养成使用参数名称的习惯是正确的，特别是当调用例程存在固有的歧义时。

您还可以考虑使用两个独立的例程，它们的名称安静地清楚地标识了它们预期的参数类型。

# jquery - 我为最近丢失的功能开发的地图

> ID：14532111
> 
> 赞同：3
> 
> 时间：2013-01-25T23:45:11.027
> 
> 标签：jquery, google-maps-api-3, infowindow

我是我大学的网络开发人员，目前正在研究我们的地图。该网站可以在[这里](http://bit.ly/TOyCVq)找到。单击标题时，每个标题下都会出现图钉，当单击图钉时（在地图上或侧边栏中），应该会弹出一个信息窗口，其中包含有关该位置的简短片段，通常旁边有一张照片。不幸的是，在过去的两个月里，信息窗口都停止了显示。我已经尝试确保我们的 jquery 是最新的，并运行我们制作的自定义 javascript 以查看是否有任何重大更改（我可以说最好，没有）。我想知道 Google Maps API 最近是否有任何可能破坏这一点的更新。我正在逐步执行脚本，试图找出潜在的问题区域，但结果很枯燥。

（编辑）我会把相关代码贴到infowindows上，不然大家都头疼。

```
for (var i in data.d.Buildings) {
    var color = categories[4].Color.substring(1);
    var myLatLng = new google.maps.LatLng(data.d.Buildings[i].Latitude, data.d.Buildings[i].Longitude);
    var image = 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=' + data.d.Buildings[i].LegendKey + '|' + color + '|ffffff';
    categoryItems['search'][i].marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        icon: image,
        pushpinInfo: data.d.Buildings[i]
    });

    google.maps.event.addListener(categoryItems['search'][i].marker, 'click', function () {
        infowindow.content = '<div class="bubble"><h3>' + this.pushpinInfo.Name + '</h3>' + (this.pushpinInfo.ImageUrl != null ? '<img src="' + this.pushpinInfo.ImageUrl + '" alt="' + this.pushpinInfo.Acronym + '" />' : '') + this.pushpinInfo.Description + '</div>';
        infowindow.open(map, this);
    });

    addPushpinToMenu(categoryItems['search'][i], 'search', image);
    count++;
} 
```

* * *

```
 if (data.d.ParkingLots[i].Name != null && data.d.ParkingLots[i].Name != "") {
        google.maps.event.addListener(categoryItems['search'][count].marker, 'click', function () {
            infowindow.content = '<div class="bubble">' + (this.pushpinInfo.Name != null ? '<h3>' + this.pushpinInfo.Name + '</h3>' : '') + (this.pushpinInfo.Description != null ? this.pushpinInfo.Description : '') + '</div>';
            infowindow.setPosition(this.centerLatLng);
            infowindow.open(map);
        });
    } 
```

* * *

```
 google.maps.event.addListener(categoryItems['search'][count].marker, 'click', function () {
        infowindow.content = '<div class="bubble"><h3>' + this.pushpinInfo.Name + '</h3>' + (this.pushpinInfo.ImageUrl != null ? '<img src="' + this.pushpinInfo.ImageUrl + '" alt="' + this.pushpinInfo.Acronym + '" />' : '') + this.pushpinInfo.Description + '</div>';
        infowindow.open(map, this);
    }); 
```

* * *

```
 if (data.d[i].ParkingLots[a].Name != null && data.d[i].ParkingLots[a].Name != "") {
            google.maps.event.addListener(categoryItems[6][i].ParkingLots[a].marker, 'click', function () {
                infowindow.content = '<div class="bubble">' + (this.pushpinInfo.Name != null ? '<h3>' + this.pushpinInfo.Name + '</h3>' : '') + (this.pushpinInfo.Description != null ? this.pushpinInfo.Description : '') + '</div>';
                infowindow.setPosition(this.centerLatLng);
                infowindow.open(map);
            });
        } 
```

* * *

```
 google.maps.event.addListener(categoryItems[data.d[0].TypeID][i].marker, 'click', function () {
        infowindow.content = '<div class="bubble"><h3>' + this.pushpinInfo.Name + '</h3>' + (this.pushpinInfo.ImageUrl != null ? '<img src="' + this.pushpinInfo.ImageUrl + '" alt="' + this.pushpinInfo.Name + '" />' : '') + this.pushpinInfo.Description + '</div>';
        infowindow.open(map, this);
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T17:41:48.747

该问题与 jQuery 版本无关，是 Maps-API 版本破坏了它（自 3.10 起）

您直接设置 infoWindows 的内容属性，自 3.10 以来似乎失败了。

您可以修复脚本（`setContent()`改用）或指定 API 版本：

```
https://maps.googleapis.com/maps/api/js?v=3.9&sensor=false 
```

（但我建议修复它）

# c# - 我可以为 Protobuf-net 设置一个全局对象工厂吗？

> ID：14532116
> 
> 赞同：6
> 
> 时间：2013-01-25T23:45:39.507
> 
> 标签：c#, deserialization, ioc-container, protobuf-net

我在 Protobuf-net 上看到了 SetFactory 方法。但是，它似乎是按类型提供的。（还有 MethodInfo 还是一个字符串？我能听到`Func<T>`吗？）

我想要的是能够使用我的 IoC 容器的对象解析和构造能力进行所有反序列化。（我正在使用 Autofac。） Protobuf-net 应该首先尝试在任何构造上使用我的 IoC。如果返回 null 那么我想要默认行为。目前有什么方法可以做到这一点吗？谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T08:46:20.383

不是现在。它不接受委托的原因是它旨在静态编译模型 - MethodInfo 很好，但委托：不是那么多。但是，您提供的工厂方法可以采用序列化上下文，该上下文可以包含您需要的任何对象。

我可以考虑一个默认的工厂方法——这听起来可能；我需要让其中一个参数成为类型，但这不是问题。

设置“可以采用（如果需要）类型和序列化上下文的默认工厂 MethodInfo”的能力是否足够？

# regex - 常规 vs LALR(1)：什么更快

> ID：14532118
> 
> 赞同：2
> 
> 时间：2013-01-25T23:45:52.277
> 
> 标签：regex, parsing, lalr

假设我们有两种定义相同语言的文法：常规文法和 LALR(1) 文法。

常规和 LALR(1) 算法都是 O(n)，其中 n 是输入长度。

正则表达式通常是解析常规语言的首选。为什么？是否有正式的证据（或者可能很明显）证明它们更快？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:07:41.987

解析和识别之间有很大的区别。尽管您可以构建正则语言解析器，但它会受到极大的限制，因为大多数有用的语言都无法使用有用的明确正则语法进行解析。但是，大多数（如果不是全部）正则表达式库都*可以识别*，可能会添加有限数量的“捕获”。

无论如何，解析真的不再是性能瓶颈了。恕我直言，最好使用能够明显解析它们似乎解析的语言的工具。

另一方面，如果你想要做的只是识别一种语言——而且该语言恰好是正则——正则表达式更容易并且需要更少的基础设施（解析器生成器、专用 DSL、稍微复杂的 Makefile ， ETC。）

（作为不规则语言特征的一个例子，我给你：括号。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-15T14:55:38.897

您应该更喜欢无堆栈自动机而不是下推自动机，因为常规语言自动机的数学要发达得多。

我们能够对这两种类型的自动机进行确定，但我们**无法对 PDA 进行有效的最小化**。众所周知的事实是，对于每个 PDA，都存在一个具有唯一状态的等价物。这意味着我们应该在转换计数/最大堆栈深度/其他一些标准方面最小化它。

此外，检查两个不同的 PDA 在它们识别的语言方面是否等效的问题也是无法确定的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:50:10.763

人们更喜欢正则表达式，因为它们更容易编写。如果您的语言是常规语言，为什么还要为它创建 CFG 语法？

# jquery - easySlider 插件文本在滚动时不隐藏

> ID：14532138
> 
> 赞同：0
> 
> 时间：2013-01-25T23:48:28.373
> 
> 标签：jquery, easyslider

制作动画时，easySlider 1.7 jQuery 插件（可在[http://www.lunchboxbill.co.uk/](http://www.lunchboxbill.co.uk/)查看）很好地隐藏了图像，但标题中`<span>`也使用了文本。`<a>`

我错过了一些非常明显的事情吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:03:10.883

您缺少一个 position: relative 在您的滑块内，然后您可以将滑块调整为具有 top:0 而不是 top:11 的跨度，它会为您修复它。

```
#slider {
 border: 1px solid #999999;
 display: none;
 position: relative;
 }

 #slider a span {
 background-color: #999999;
 color: #FFFFFF;
 display: block;
 height: 40px;
 opacity: 0.4;
 position: absolute;
 top: 0px;
 width: 558px;
 } 
```

# php - PHP：递归字符串子集提取算法

> ID：14532139
> 
> 赞同：-5
> 
> 时间：2013-01-25T23:48:41.677
> 
> 标签：php, regex

我有一个字符串：

```
abc{def}ghij{kl{mn}o{pq}}r{s{t{u{v}}w}}xyz 
```

目标是提取括号内的所有内容：

```
1\. def
2\. kl{mn}o{pq}
3\. mn
4\. pq
5\. s{t{u{v}}w}
6\. t{u{v}}w
7\. u{v}
8\. v 
```

寻找任何解决方案，无论是正则表达式还是循环。

编辑：

好的，因为这开始变得有些发脾气，这就是我尝试过的：

```
preg_match("/(\{[^\{]+\})+/", $str, $matches); // matches only first occurrence
preg_match_all("/(\{[^\{\}]+\})+/", $str, $matches); // this matches only the final level occurrences 
```

实际上，我不知道如何实现这一目标。

所以现在，我最大的障碍是找到第一级的所有事件。这样我就可以递归地挖掘字符串并检索我需要的所有子集。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T00:00:41.027

您可以遍历字符串并将 的位置`{`放在堆栈上，从该堆栈中匹配`}`pop 。

然后您将获得该列表，但顺序不同：

```
abc{def}ghij{kl{mn}o{pq}}r{s{t{u{v}}w}}xyz 
```

1.  定义
2.  锰
3.  pq
4.  kl{mn}o{pq}
5.  v
6.  紫外线}
7.  t{u{v}}w
8.  s{t{u{v}}w}

这将是一个带有循环的解决方案。

# python - 服务器响应中的 BOM 搞砸了 json 解析

> ID：14532149
> 
> 赞同：8
> 
> 时间：2013-01-25T23:49:20.900
> 
> 标签：python, json, urllib2, urllib

我正在尝试编写一个 Python 脚本，将一些 JSON 发布到 Web 服务器并获取一些 JSON。我在 StackOverflow 上拼凑了几个不同的例子，我认为我有一些主要工作的东西。

```
import urllib2
import json

url = "http://foo.com/API.svc/SomeMethod"
payload = json.dumps( {'inputs': ['red', 'blue', 'green']} )
headers = {"Content-type": "application/json;"}

req = urllib2.Request(url, payload, headers)
f = urllib2.urlopen(req)
response = f.read()
f.close()

data = json.loads(response) # <-- Crashes 
```

最后一行抛出异常：

> ValueError：无法解码任何 JSON 对象

当我查看 时`response`，我看到了有效的 JSON，但前几个字符是 BOM：

```
>>> response
'\xef\xbb\xbf[\r\n  {\r\n    ... Valid JSON here 
```

所以，如果我手动去掉前三个字节：

```
data = json.loads(response[3::]) 
```

一切正常，并`response`变成了字典。

**我的问题：**

`json`当你给它一个 BOM 时，它似乎有点愚蠢。有什么不同的我可以做的`urllib`或者`json`图书馆让它知道这是一个 UTF8 字符串并这样处理它吗？我不想手动删除前 3 个字节。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T23:59:07.983

您可能应该对运行此服务的人大喊大叫，因为 UTF-8 文本上的 BOM 毫无意义。BOM 的存在是为了消除字节顺序的歧义，UTF-8 被定义为 little-endian。

也就是说，理想情况下，您应该先对字节进行解码，然后再对它们进行任何其他操作。幸运的是，Python 有一个可以识别和删除 BOM 的编解码器：`utf-8-sig`.

```
>>> '\xef\xbb\xbffoo'.decode('utf-8-sig')
u'foo' 
```

所以你只需要：

```
data = json.loads(response.decode('utf-8-sig')) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-09T15:35:03.547

如果我不是唯一遇到同样问题的人，而是使用`requests`module 而不是`urllib2`，这里有一个适用于 Python 2.6 和 3.3 的解决方案：

```
import requests
r = requests.get(url, params=my_dict, auth=(user, pass))
print(r.headers['content-type'])  # 'application/json; charset=utf8'
if r.text[0] == u'\ufeff':  # bytes \xef\xbb\xbf in utf-8 encoding
    r.encoding = 'utf-8-sig'
print(r.json()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-18T11:49:24.603

由于我缺乏足够的评论声誉，我会写一个答案。

当我需要保留未平仓的底层证券时，我通常会遇到这个`Stream`问题`StreamWriter`。但是，可以选择保持底层`Stream`打开的重载*需要*编码（在大多数情况下将是 UTF8），这里是如何在*不*发出 BOM 的情况下做到这一点。

```
/* Since Encoding.UTF8 (the one you'd normally use in those cases) **emits**
 * the BOM, use whats below instead!
 */

// UTF8Encoding has an overload which enables / disables BOMs in the output
UTF8Encoding encoding = new UTF8Encoding(false);

using (MemoryStream ms = new MemoryStream())
using (StreamWriter sw = new StreamWriter(ms, encoding, 4096, true))
using (JsonTextWriter jtw = new JsonTextWriter(sw))
{
    serializer.Serialize(jtw, myObject);
} 
```

# excel - 循环并计算包含数据的excel单元格，然后循环多次执行一个动作

> ID：14532152
> 
> 赞同：2
> 
> 时间：2013-01-25T23:49:36.740
> 
> 标签：excel, vba

我是一个新手 vba 编码器，迫切需要一些帮助。

使用另一篇文章中的以下代码，我已将其修改为初学者（可能是错误的方法），我需要

*   *循环遍历工作表Test*中的整个 A 列。
*   计算该区域中包含数据的单元格数。
*   使用该计数，我需要将文件复制到一个目录中，该目录多次将循环中的下一个数字附加到文件名。

因此，例如，如果我发现 210 个包含数据的单元格，我想获取此文件`C:\image\test.tif`并将其复制 210 次到`C:\temp\imagecopy\test (1).tif`, 然后`C:\temp\imagecopy\test (2).tif`"`C:\temp\imagecopy\test (3).tif`等等。

但我真的不知道如何实现这一目标。这是我到目前为止所拥有的。

```
Sub CountTextPatterns()
Dim rngToCheck As Range
Dim cl As Range

Set rngToCheck = Range("A1:A10000") //Set up the range that contains the text data

Dim nothingHere As Integer
Set nothingHere = ""

//Loop through range, match cell contents to pattern, and increment count accordingly
For Each cl In rngToCheck
    If nothingHere.Test(cl) Then
        nothingHere = nothingHere+ 1
    End If
Next

//For anything that isn't a letter or number, simply subtract from the and total row count
cntNumber = rngToCheck.Rows.Count - cntnothingHere

End Sub

//So at this point I believe I should have the total cells that are not blank.  Now I need to execute a file copy action that many times using the logic mentioned at the top. 
```

任何人都可以提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:15:47.893

像这样的东西

*   避免循环细胞计数，`Application.CountA`而是使用
*   用于`FileCopy`增量复制文件

您没有指定输出目录是否已经存在，要复制的文件名是用户指定的还是硬编码的等等。所以下面的代码可能会受益于测试/错误处理这些条件

**代码**

```
Sub CopyEm()
    Dim ws As Worksheet
    Dim strIn As String
    Dim strOut As String
    Dim strFile As String
    Dim strLPart As String
    Dim strRPart As String
    Dim lngCnt As Long
    Dim lngFiles As Long
    Set ws = Sheets("Test")
    lngCnt = Application.CountA(ws.Columns("A"))
    If lngCnt = 0 Then Exit Sub
    strIn = "C:\image\"
    strOut = "C:\imagecopy\"
    strFile = "test.tif"
    'extract string portions of the file name and type outside the copy loop 
    strLPart = Left$(strFile, InStr(strFile, ".") - 1)
    strRPart = Right$(strFile, Len(strFile) - Len(strLPart))
    For lngFiles = 1 To lngCnt
        FileCopy strIn & strFile, strOut & strLPart & "(" & lngFiles & ")" & strRPart
    Next
End Sub 
```

# arrays - t.test 数组函数

> ID：14532154
> 
> 赞同：1
> 
> 时间：2013-01-25T23:50:01.800
> 
> 标签：arrays, excel, function

我正在尝试分析一些数据。我在 excel 上有它，我对此很陌生，但我没有看到任何可以帮助我解决问题的主题。

我拥有的是不同工作表上的两组数据。我正在尝试确定这些数据之间的 P 值。但是我拥有数据的方式是这样显示在列中的，

*   如果条件 A 为真，`0`.
*   如果条件 B 为真，`1`.

所以裸数据是数组形式`{1,2,0,0,0,0,6,7,4,3,2}`。

我想计算唯一条件 A 的 P 值。所以我使用`IF(A1:A800=0,1,0)`了 array1 和 2。看起来像这样

```
=T.TEST(IF('Raw Data'!H6:H794=0,1,0),IF(J7:J39=0,1,0),2,2) 
```

我不断收到`#VALUE!`错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:16:11.277

数组公式需要使用特定的组合键输入

用公式选择单元格 - 按**`F2`**键选择公式，然后按住**`CTRL`**和**`SHIFT`**键的同时按**`ENTER`**。如果正确完成，这将在公式栏中的公式周围放置像 { 和 } 这样的花括号.....并且公式应该可以工作

修改公式需重复上述内容

# ocaml - 从语法 OCaml 构建函数

> ID：14532160
> 
> 赞同：0
> 
> 时间：2013-01-25T23:51:00.413
> 
> 标签：ocaml, context-free-grammar

我正在尝试从通用语法构建解析器
但首先我被要求从此更改语法（A是开始符号）：

```
(A,[(A,[C;B;C]);
    (A,[C]);
    (B,[A]);
    (C,[B])]) 
```

看起来像这样的东西：

```
 (A,
   function
   | A -> [[C;B;C];[C]]
   | B -> [[C]]
   | C -> [[B]]) 
```

如何从列表中的信息生成模式匹配器？
模式匹配器（函数 | 模式 | ... | 模式）由程序员定义，如何使用具有此结构的列表中的信息动态创建一个匹配器（A,[[C;B;C];[C ]]）：：休息 ？

如果您想查看更有意义的更大语法，请查看[此问题](https://stackoverflow.com/questions/1584247/parsing-grammars-using-ocaml)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T16:26:44.700

好的，我想我可能明白你的问题。以函数开头的数据结构就是函数！在 OCaml 中，函数是第一类对象，您可以创建新的对象，将它们保存在数据结构中，等等。为了使事情保持纯粹，您无法访问函数的文本表示（就像在某些语言中一样），但您仍然可以以有用的方式组合函数。

这是一个小例子。该函数`maketest`接受一个值`k`并返回一个测试`k`.

```
# let maketest k = fun x -> x = k;;
val maketest : 'a -> 'a -> bool = <fun>
# let t8 = maketest 8;;
val t8 : int -> bool = <fun>
# t8 3;;
- : bool = false
# t8 8;;
- : bool = true 
```

该函数`union`接受两个测试函数（如由 生成`maketest`的函数）并返回一个测试两组值的并集的函数：

```
# let union f g = fun x -> f x || g x;;
val union : ('a -> bool) -> ('a -> bool) -> 'a -> bool = <fun>
# let t812 = union t8 (maketest 12);;
val t812 : int -> bool = <fun>
# t812 8;;
- : bool = true
# t812 12;;
- : bool = true
# t812 14;;
- : bool = false
# 
```

该函数`sequence`采用两个测试函数（如由 生成的那些`maketest`）并测试以依次匹配两个函数的整数开头的列表。

```
# let sequence f g = function
  | []|[_] -> false
  | a :: b :: _ -> f a && g b;;
val sequence : ('a -> bool) -> ('a -> bool) -> 'a list -> bool = <fun>
# sequence (maketest 1) (maketest 4) [1;4;7];;
- : bool = true
# sequence (maketest 1) (maketest 4) [1;8;7];;
- : bool = false
# 
```

我不完全确定，但我认为您被要求为您的语法组件创建类似于这些的函数。要从这样的函数制作解析器，您需要通过输入流跟踪您的进度。通常的方法是让解析函数返回剩余的（未解析的）流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T10:38:36.850

您应该查看[ocamllex](http://caml.inria.fr/pub/docs/manual-ocaml/manual026.html)和[menhir](http://gallium.inria.fr/~fpottier/menhir/)，它们是为词法分析和解析而设计的工具。

# javascript - 如何在运行时发现和加载 js 文件？

> ID：14532161
> 
> 赞同：0
> 
> 时间：2013-01-25T23:51:09.737
> 
> 标签：javascript, node.js, dynamic, runtime

我正在编写一个基于 node.js 的服务器来管理一系列设备。基于 node.js 的服务器告诉连接的客户端它的能力。这些功能由单独的 js 文件定义，这些文件定义使用继承的对象`util.inherits()`。

我遇到的问题是，现在，我必须为新能力定义一个新的 js，然后将主 js 程序更新为`require`新的 js，更改代码以发布该能力可用，然后使用新能力，如果客户要求。

我想让主代码更通用，这样它可以

1.  检测新能力，
2.  自动包含它们，
3.  通知客户，以及
4.  利用代码。

我可以通过支持树浏览的各种 npm 模块进行检测，我可以为所有功能指定一个子目录并发现那里有哪些文件。我认为我可以`require`用于第 2 步（尽管不是 100% 确定），但是我不知道如何执行第 3 步和第 4 步，或者将第 2 步的结果与第 3 步和第 4 步一起使用。

我会重视有关如何解决此问题的任何反馈。

* * *

澄清我的问题。现在我的逻辑如下：

```
var logicA = requires('./capabilities/a.js');
var logicB = requires('./capabilities/b.js');
var logicC = requires('./capabilities/c.js');

var Comms.CAPABILITY_A = 'a';
var Comms.CAPABILITY_B = 'b';
var Comms.CAPABILITY_C = 'c';

var Comms.MSG_CAPABILITY = 0;
var Comms.MSG_DO_LOGIC = 1;

function onMessageReceived(comms, msgId, body) {
    switch (msgId) {
        case(MSG_DO_LOGIC):
           doLogic(body);
           break;
        ...
    }
}

function doLogic(flag) {
   switch(flag) {
      case(Comms.CAPABILITY_A):
          logicA.doLogic();
          break;

      case(Comms.CAPABILITY_B):
          logicB.doLogic();
          break;

      case(Comms.CAPABILITY_C):
          logicC.doLogic();
          break;
   }
} 
```

在客户端，我有硬编码逻辑来假设可用的内容。我可以通过让服务器向客户端发送一个功能数组来删除它，然后客户端可以选择数组中的一个元素并将其作为执行逻辑的请求传回。这不是我的问题。

我的问题是了解如何使主机程序动态加载所有逻辑，然后评估要在动态加载的逻辑上执行哪些逻辑。

我应该声明，当我说动态时，我的意思是可用的代码是在运行时确定的。但是，只有在服务器首次启动时才会执行评估。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T02:48:01.293

我通过创建一个保存所有协议的 register.js 解决了这个问题。每次我创建一个新协议时，我都会将它添加到注册表中。

通过寄存器，我可以获得所有已注册协议的数组。我可以将它们传递回客户端，客户端可以选择协议，我可以通过注册类请求协议的实例。

虽然有一些硬编码，但它仅限于与协议位于同一目录中的寄存器类。

所以在寄存器中我有以下功能：

```
getList()
getText()
validateProtocolId()
getProtocol() 
```

我`getList()`用来返回已注册的协议 ID 的数组。我`getText()`用来提供支持协议的人类可读列表。我用于`validateProtocolId()`验证从客户端返回的 id 以确认该 id 表示已注册协议，然后`getProtocol()`用于生成已注册协议的实例。

本质上，`getProtocol()`只是做`require('./<protocol file>.js')`适当的事情。

它不像自动发现那样优雅，但它允许对注册的内容进行更严格的控制，而无需强制自定义文件等。

# python - 有向无环图的哈希值

> ID：14532164
> 
> 赞同：24
> 
> 时间：2013-01-25T23:52:01.750
> 
> 标签：python, algorithm, hash, directed-acyclic-graphs

如何将有向无环图转换为哈希值，以便任何两个同构图哈希到相同的值？两个同构图散列到不同的值是可以接受的，但不可取，这就是我在下面的代码中所做的。我们可以假设图中的顶点数最多为 11 个。

我对 Python 代码特别感兴趣。

这就是我所做的。如果`self.lt`是从节点到后代（不是孩子！）的映射，那么我根据修改后的拓扑排序重新标记节点（如果可以的话，它更喜欢首先对具有更多后代的元素进行排序）。然后，我对排序后的字典进行哈希处理。一些同构图将散列到不同的值，尤其是随着节点数量的增长。

我已经包含了所有代码来激发我的用例。我正在计算找到 7 个数字的中位数所需的比较次数。同构图哈希到相同值的次数越多，需要重做的工作就越少。我考虑过首先放置更大的连接组件，但没有看到如何快速做到这一点。

```
from tools.decorator import memoized  # A standard memoization decorator

class Graph:
    def __init__(self, n):
        self.lt = {i: set() for i in range(n)}

    def compared(self, i, j):
        return j in self.lt[i] or i in self.lt[j]

    def withedge(self, i, j):
        retval = Graph(len(self.lt))
        implied_lt = self.lt[j] | set([j])
        for (s, lt_s), (k, lt_k) in zip(self.lt.items(),
                                        retval.lt.items()):
            lt_k |= lt_s
            if i in lt_k or k == i:
                lt_k |= implied_lt
        return retval.toposort()

    def toposort(self):
        mapping = {}
        while len(mapping) < len(self.lt):
            for i, lt_i in self.lt.items():
                if i in mapping:
                    continue
                if any(i in lt_j or len(lt_i) < len(lt_j)
                       for j, lt_j in self.lt.items()
                       if j not in mapping):
                    continue
                mapping[i] = len(mapping)
        retval = Graph(0)
        for i, lt_i in self.lt.items():
            retval.lt[mapping[i]] = {mapping[j]
                                     for j in lt_i}
        return retval

    def median_known(self):
        n = len(self.lt)
        for i, lt_i in self.lt.items():
            if len(lt_i) != n // 2:
                continue
            if sum(1
                   for j, lt_j in self.lt.items()
                   if i in lt_j) == n // 2:
                return True
        return False

    def __repr__(self):
        return("[{}]".format(", ".join("{}: {{{}}}".format(
            i,
            ", ".join(str(x) for x in lt_i))
                                       for i, lt_i in self.lt.items())))

    def hashkey(self):
        return tuple(sorted({k: tuple(sorted(v))
                             for k, v in self.lt.items()}.items()))

    def __hash__(self):
        return hash(self.hashkey())

    def __eq__(self, other):
        return self.hashkey() == other.hashkey()

@memoized
def mincomps(g):
    print("Calculating:", g)
    if g.median_known():
        return 0
    nodes = g.lt.keys()
    return 1 + min(max(mincomps(g.withedge(i, j)),
                       mincomps(g.withedge(j, i)))
                   for i in nodes
                   for j in nodes
                   if j > i and not g.compared(i, j))

g = Graph(7)
print(mincomps(g)) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-29T01:42:01.117

为了有效地测试图同构，您将需要使用[nauty](http://cs.anu.edu.au/people/bdm/nauty/)。专门针对 Python 有包装器[pynauty](http://web.cs.dal.ca/~peter/software/)，但我无法证明它的质量（为了正确编译它，我必须对其进行一些简单的修补`setup.py`）。如果这个包装器做的一切都是正确的，那么它为你感兴趣的用途简化了很多，它只是一个散列的问题`pynauty.certificate(somegraph)`——对于同构图来说，这将是相同的值。

一些快速测试表明，`pynauty`它为每个图（具有相同数量的顶点）提供相同的证书。但这只是因为将图形转换为 nauty 格式时包装器中的一个小问题。修复此问题后，它对我有用（我还使用了[http://funkybee.narod.ru/graphs.htm](http://funkybee.narod.ru/graphs.htm)上的图表进行比较）。这是一个简短的补丁，它还考虑了所需的修改`setup.py`：

```
diff -ur pynauty-0.5-orig/setup.py pynauty-0.5/setup.py
--- pynauty-0.5-orig/setup.py   2011-06-18 20:53:17.000000000 -0300
+++ pynauty-0.5/setup.py        2013-01-28 22:09:07.000000000 -0200
@@ -31,7 +31,9 @@

 ext_pynauty = Extension(
         name = MODULE + '._pynauty',
-        sources = [ pynauty_dir + '/' + 'pynauty.c', ],
+        sources = [ pynauty_dir + '/' + 'pynauty.c',
+            os.path.join(nauty_dir, 'schreier.c'),
+            os.path.join(nauty_dir, 'naurng.c')],
         depends = [ pynauty_dir + '/' + 'pynauty.h', ],
         extra_compile_args = [ '-O4' ],
         extra_objects = [ nauty_dir + '/' + 'nauty.o',
diff -ur pynauty-0.5-orig/src/pynauty.c pynauty-0.5/src/pynauty.c
--- pynauty-0.5-orig/src/pynauty.c      2011-03-03 23:34:15.000000000 -0300
+++ pynauty-0.5/src/pynauty.c   2013-01-29 00:38:36.000000000 -0200
@@ -320,7 +320,7 @@
     PyObject *adjlist;
     PyObject *p;

-    int i,j;
+    Py_ssize_t i, j;
     int adjlist_length;
     int x, y; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-28T18:13:22.753

[有向无环图的图同构仍然是 GI 完备的。](http://en.wikipedia.org/wiki/Graph_isomorphism_problem#GI-complete_classes_of_graphs)因此，目前没有已知的（最坏情况下的次指数）解决方案来保证两个同构有向无环图将产生相同的散列。只有当不同图之间的映射是已知的——例如，如果所有顶点都有唯一的标签——才能有效地保证匹配的哈希值。

好的，让我们对少数顶点进行暴力破解。我们必须找到一个独立于输入中顶点顺序的图表示，从而保证同构图产生相同的表示。此外，这种表示必须确保没有两个非同构图产生相同的表示。

最简单的解决方案是为所有 n 构造邻接矩阵！顶点的排列，并将邻接矩阵解释为 n ²位整数。然后我们可以选择最小或最大的数字作为规范表示。这个数字完全编码了图，因此确保没有两个非同构图产生相同的数字——人们可以认为这个函数是一个[完美的散列函数](http://en.wikipedia.org/wiki/Perfect_hash_function)。并且因为我们选择在所有可能的顶点排列下对图进行编码的最小或最大数字，我们进一步确保同构图产生相同的表示。

在 11 个顶点的情况下，这有多好或多坏？好吧，表示将有 121 位。我们可以将其减少 11 位，因为表示循环的对角线在非循环图中将全为零，并剩下 110 位。这个数字理论上可以进一步减少；并非所有剩余的 2 ^(110)个图都是非循环的，每个图最多可能有 11 个！- 大约 2 ^(25) - 同构表示，但实际上这可能很难做到。有人知道如何计算具有 n 个顶点的不同有向无环图的数量吗？

需要多长时间才能找到这个代表？天真11！或 39,916,800 次迭代。这不是什么，可能已经不切实际，但我没有实施和测试它。但我们可能可以加快一点速度。如果我们通过从左到右连接从上到下的行来将邻接矩阵解释为整数，我们希望第一行左侧有许多个（零）以获得大（小）数。因此，我们选择具有最大（最小）度（取决于表示的入度或出度）的一个（或一个顶点）作为第一个顶点，而不是在后续位置连接（未连接）到该顶点的顶点以使这些顶点（零） ） 向左转。

修剪搜索空间的可能性可能更多，但我不确定是否有足够的方法使其成为实用的解决方案。也许有或者也许其他人至少可以在这个想法的基础上建立一些东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-28T17:00:00.177

哈希必须有多好？我假设您**不**想要图形的完整序列化。散列很少保证没有第二个（但不同的）元素（图）评估为相同的散列。如果对您来说非常重要的是，同构图（以不同的表示形式）具有相同的散列，那么只使用在表示变化下不变的值。例如：

*   节点总数
*   （定向）连接的总数
*   `(indegree, outdegree) = (i,j)`任何元组的节点总数`(i,j)`不超过`(max(indegree), max(outdegree))`（或限制为不超过某个固定值的元组`(m,n)`）

所有这些信息都可以在 O(#nodes) [假设图形存储正确] 中收集。将它们连接起来，你就有了一个哈希值。如果您愿意，您可以使用一些众所周知的哈希算法`sha`，例如这些连接信息。如果没有额外的散列，它是一个*连续的散列*（它允许找到相似的图），如果选择的散列算法具有这些属性，那么它是*统一*的并且大小固定。

事实上，注册任何添加或删除的连接已经足够好了。它可能会错过已更改的连接（`a -> c`而不是`a -> b`）。

* * *

这种方法是模块化的，可以根据需要进行扩展。包含的任何其他属性都将减少冲突的数量，但会增加获取哈希值所需的工作量。还有一些想法：

*   与上述相同，但具有二阶进出度。IE。一条链可以到达的节点数`node->child->child`（=二阶外度）或分两步通向给定节点的节点数。
*   或更一般的 n 阶进出度（可以在 O((average-number-of-connections) ^ (n-1) * #nodes) 中计算）
*   [偏心率](http://en.wikipedia.org/wiki/Eccentricity_%28graph_theory%29)= x的节点数（同样适用于任何 x）
*   如果节点存储任何信息（除了它们的邻居），则使用`xor`所有节点内容的任何类型的散列。由于`xor`添加到散列的节点的特定顺序无关紧要。

* * *

您要求“唯一的哈希值”，显然我无法为您提供。但我认为术语“散列”和“每个图的唯一”是相互排斥的（当然不完全正确），并决定回答“散列”部分而不是“唯一”部分。一个“唯一散列”（[完美散列](http://en.wikipedia.org/wiki/Hash_function#Perfect_hashing)）基本上需要是图的全序列化（因为散列中存储的信息量要反映图中的信息总量）。如果这确实是您想要的，只需定义一些唯一的节点顺序（例如，按自己的出度排序，然后按入度，然后按子项的出度等，直到顺序明确）并以任何方式序列化图形（使用位置在前面提到的排序作为节点的索引）。

当然，这要复杂得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-20T10:45:47.147

几年前，我为这个问题创建了一个简单而灵活的算法（通过散列在化学结构数据库中找到重复的结构）。

我将它命名为“Powerhash”，创建算法需要两个见解。第一个是幂迭代图算法，也用于PageRank。第二个是能够用我们想要的任何东西替换幂迭代的内部阶跃函数。我用一个函数替换了它，该函数在每个步骤和每个节点上执行以下操作：

*   对节点邻居的哈希进行排序
*   散列连接的排序散列

第一步，节点的散列受到其直接邻居的影响。第二步，一个节点的哈希值受到距离它 2 跳的邻居的影响。在第 N 步，节点的哈希值将受到其周围 N 跳的邻域影响。所以你只需要继续运行 N = graph_radius 步骤的 Powerhash。最终，图中心节点的哈希值将受到整个图的影响。

要生成最终哈希，请对最后一步的节点哈希进行排序并将它们连接在一起。之后，您可以比较最终的哈希值来确定两个图是否同构。如果您有标签，则将它们添加到您为每个节点（以及每个步骤）计算的内部哈希中。

有关这方面的更多信息，您可以在此处查看我的帖子：

[https://plus.google.com/114866592715069940152/posts/fmBFhjhQcZF](https://plus.google.com/114866592715069940152/posts/fmBFhjhQcZF)

上面的算法是在“madIS”函数关系数据库中实现的。你可以在这里找到算法的源代码：

[https://github.com/madgik/madis/blob/master/src/functions/aggregate/graph.py](https://github.com/madgik/madis/blob/master/src/functions/aggregate/graph.py)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-28T10:33:23.177

恕我直言，如果可以对图进行拓扑排序，则存在非常简单的解决方案。

1.  对于索引为 i 的每个顶点，您可以构建他的（排序的）直接邻居的唯一哈希（例如，使用字符串的哈希技术）（如果顶点 1 有直接邻居 {43,23,2,7,12, 19,334} 散列函数应该散列 {2,7,12,19,23,43,334} 的数组）
2.  对于整个 DAG，您可以创建一个哈希，作为每个节点的哈希字符串的哈希： Hash(DAG) = Hash(vertex_1) U Hash(vertex_2) U ..... Hash(vertex_N); 我认为这个过程的复杂性在最坏的情况下约为 (N*N)。如果图形无法进行拓扑排序，建议的方法仍然适用，但您需要以独特的方式对顶点进行排序（这是困难的部分）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-28T10:57:05.177

我将描述一种算法来散列任意有向图，而不考虑该图是非循环的。事实上，即使计算给定顺序的无环图也是一项非常复杂的任务，我相信这只会使散列变得更加复杂，从而变得更慢。

图的唯一表示可以由邻域列表给出。为每个顶点创建一个包含所有邻居的列表。一个接一个地写下所有列表，并将每个列表的邻居数附加到前面。还要保持邻居按升序排序，以使每个图的表示唯一。因此，例如假设您有图表：

```
1->2, 1->5
2->1, 2->4
3->4
5->3 
```

我建议您将其转换为`({2,2,5}, {2,1,4}, {1,4}, {0}, {1,3})`，这里的大括号仅用于可视化表示，而不是 python 语法的一部分。所以列表实际上是：`(2,2,5, 2,1,4, 1,4, 0, 1,3)`.

现在要计算唯一哈希，您需要以某种方式对这些表示进行排序并为它们分配一个唯一编号。我建议你做一些类似字典排序的事情来做到这一点。假设您有两个序列`(a1, b1_1, b_1_2,...b_1_a1,a2, b_2_1, b_2_2,...b_2_a2,...an, b_n_1, b_n_2,...b_n_an)`和 `(c1, d1_1, d_1_2,...d_1_c1,c2, d_2_1, d_2_2,...d_2_c2,...cn, d_n_1, d_n_2,...d_n_cn)`，这里 c 和 a 是每个顶点的邻居数， b_i_j 和 d_k_l 是相应的邻居。对于排序，首先比较序列`(a1,a2,...an)`，`(c1,c2, ...,cn)`如果它们不同，则使用它来比较序列。如果这些序列不同，则从左到右比较列表，首先按字典顺序比较`(b_1_1, b_1_2...b_1_a1)`，`(d_1_1, d_1_2...d_1_c1)`依此类推，直到第一个不匹配。

事实上，我建议将一个大小的单词的字典序号用作散列，`N`该字母表是由 的元素子集的所有可能选择形成的`{1,2,3,...N}`。给定顶点的邻域列表是这个字母表上的一个字母，例如`{2,2,5}`是由集合的两个元素组成的子集，即`2`和`5`。

该集合的*字母表*（可能的*字母*集合）`{1,2,3}`将是（按*字典顺序*排列）：

`{0}, {1,1}, {1,2}, {1,3}, {2, 1, 2}, {2, 1, 3}, {2, 2, 3}, {3, 1, 2, 3}`

像上面的第一个数字是给定子集中元素的数量，其余数字是子集本身。所以从这个字母表中形成所有 3 个*字母的单词*，你将得到所有可能的有 3 个顶点的有向图。

现在集合的子集数`{1,2,3,....N}`是`2^N`，因此这个字母表的*字母*数是`2^N`。现在我们用一个单词编码每个有向图的`N`节点，该*单词*恰好来自这个*字母表中的*`N` *字母*，因此可能的哈希码的数量正好是：。这是为了表明哈希码随着 的增加而增长**得非常**快。这也是具有节点的可能不同有向图的数量，所以我建议的是最佳散列，因为它是双射并且没有更小的散列可以是唯一的。*`(2^N)^N`**`N``N`***

 ***在这种情况下，有一个线性算法可以在给定集合的所有子集的字典顺序中获得给定的子集编号`{1,2,....N}`。这是我为编码/解码数字子集而编写的代码，反之亦然。它是用写的，`C++`但我希望很容易理解。对于散列，您只需要代码函数，但由于我建议的散列是可逆的，我添加了解码函数 - 您将能够从散列重建图形，我认为这非常酷：

```
typedef long long ll;

// Returns the number in the lexicographical order of all combinations of n numbers
// of the provided combination. 
ll code(vector<int> a,int n)
{
    sort(a.begin(),a.end());  // not needed if the set you pass is already sorted.
    int cur = 0;
    int m = a.size();

    ll res =0;
    for(int i=0;i<a.size();i++)
    {
        if(a[i] == cur+1)
        {
            res++;
            cur = a[i];
            continue;
        }
        else
        {
            res++;
            int number_of_greater_nums = n - a[i];
            for(int j = a[i]-1,increment=1;j>cur;j--,increment++)
                res += 1LL << (number_of_greater_nums+increment);
            cur = a[i];
        }
    }
    return res;
}
// Takes the lexicographical code of a combination of n numbers and returns the 
// combination
vector<int> decode(ll kod, int n)
{
    vector<int> res;
    int cur = 0;

    int left = n; // Out of how many numbers are we left to choose.
    while(kod)
    {
        ll all = 1LL << left;// how many are the total combinations
        for(int i=n;i>=0;i--)
        {
            if(all - (1LL << (n-i+1)) +1 <= kod)
            {
                res.push_back(i);
                left = n-i;
                kod -= all - (1LL << (n-i+1)) +1;
                break;
            }
        }
    }
    return res;
} 
```

此代码还将结果存储在`long long`变量中，这仅适用于元素少于 64 个的图形。具有 64 个节点的图的所有可能散列将是`(2^64)^64`. 这个数字大约有 1280**位数字**，所以可能是一个很大的数字。我描述的算法仍然会运行得非常快，我相信你应该能够散列和“取消散列”具有很多顶点的图。

也看看[这个问题](https://stackoverflow.com/questions/14160942/perfect-minimal-hash-for-mathematical-combinations/14160991#14160991)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-28T16:58:52.300

我不确定它是否 100% 有效，但这是一个想法：

让我们将一个图编码成一个字符串，然后获取它的哈希值。

1.  空图的哈希是“”
2.  没有出边的顶点的哈希是“。”
3.  带有出边的顶点的散列是每个子散列与一些分隔符的连接（例如“，”）

要在第 3 步连接之前为同构图生成相同的散列，只需对散列进行排序（例如按字典顺序）。

对于图的散列，只需取其根的散列（或排序连接，如果有多个根）。

**编辑**虽然我希望生成的字符串能够描述没有冲突的图，但**hynekcer**发现有时非同构图会获得相同的哈希值。当一个顶点有几个父母时会发生这种情况 - 然后它为每个父母“复制”。例如，该算法不区分“钻石”{A->B->C,A->D->C} 和情况 {A->B->C,A->D->E}。

我不熟悉 Python，我很难理解示例中图形的存储方式，但这里有一些 C++ 代码，很可能很容易转换为 Python：

```
THash GetHash(const TGraph &graph)
{
    return ComputeHash(GetVertexStringCode(graph,FindRoot(graph)));
}
std::string GetVertexStringCode(const TGraph &graph,TVertexIndex vertex)
{
    std::vector<std::string> childHashes;
    for(auto c:graph.GetChildren(vertex))
        childHashes.push_back(GetVertexStringCode(graph,*c));
    std::sort(childHashes.begin(),childHashes.end());
    std::string result=".";
    for(auto h:childHashes)
        result+=*h+",";
    return result;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-30T01:58:38.967

当我看到这个问题时，我的想法与@example基本相同。我编写了一个函数，提供了一个图形标签，使得标签与两个同构图一致。

该标签由升序的出度序列组成。您可以使用您选择的字符串散列函数对该标签进行散列，以获得图形的散列。

**编辑：**我在@NeilG 的原始问题的背景下表达了我的建议。对他的代码进行的唯一修改是将`hashkey`函数重新定义为：

```
def hashkey(self): 
    return tuple(sorted(map(len,self.lt.values()))) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-30T20:44:40.230

我假设顶点或边上没有公共标签，因为那么您可以将图形置于规范形式中，这本身就是一个完美的散列。因此，该提议仅基于同构。

为此，尽可能多地为 DAG 的简单聚合特征组合哈希，选择那些可以快速计算的特征。这是一个入门列表：

1.  节点进出度的二维直方图。
2.  边缘 a->b 的 4d 直方图，其中 a 和 b 都以入/出度为特征。

**让** 我更明确一点。对于 1，我们将计算一组三元组`<I,O;N>`（其中没有两个三元组具有相同的`I`,`O`值），表示存在具有 in-degree和 out-degree的`N`节点。您可以散列这组三元组或更好地使用以某种规范顺序排列的整个集合，例如按字典顺序排序。对于 2，我们计算一组五元组，表示从具有 in degree和 out degree的节点到分别具有和的节点存在边。再次散列这些五元组，或者按规范顺序将它们原样用于最终散列的另一部分。`I``O``<aI,aO,bI,bO;N>``N``aI``aO``bI``bO`

从这个开始，然后查看仍然发生的冲突可能会提供有关如何变得更好的见解。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-28T17:54:49.460

对你的后代进行适当的排序（如果你有一个单独的根节点，不是给定的，但有合适的排序（可能包括一个虚拟根节点）），散列树的方法应该稍微修改一下。

[此 StackOverflow 答案](https://stackoverflow.com/a/1991408/34771)中的示例代码，修改将是在散列父级之前以某种确定性顺序（增加哈希？）对子级进行排序。

即使您有多个可能的根，您也可以创建一个合成的单根，所有根都作为子根。***

# jquery - 无法在使用 jquery .load() 方法加载的 (asp.net mvc4) 部分视图中打开 kendoui 下拉菜单

> ID：14532165
> 
> 赞同：0
> 
> 时间：2013-01-25T23:52:02.073
> 
> 标签：jquery, asp.net-mvc-4, kendo-ui, partial-views

虽然在第一个开发级别一切都很好，但我遇到了一个问题，我无法从 jquery 加载方法事件部分加载的 kendo ui 打开中获取下拉列表，

拿到

```
<link href="@Url.Content("~/Content/kendo/2012.3.1114/kendo.common.min.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/kendo/2012.3.1114/kendo.metro.min.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/kendo/2012.3.1114/kendo.web.min.js")"></script> 
```

和 jquery，样本在这里：

```
<div class="demo-section" style="width: 250px; text-align: center;">
<label for="titles">Select Title:</label>
<input id="titles" />
</div>
<script>
$(document).ready(function () {

    $("#titles").kendoDropDownList({
        dataTextField: "Name",
        dataValueField: "Id",
        dataSource: {
            type: "odata",
            serverFiltering: true,
            filter: [{
                field: "Name",
                operator: "contains",
                value: "Star Wars"
            }, {
                field: "BoxArt.SmallUrl",
                operator: "neq",
                value: null
            }],
            transport: {
                read: "http://odata.netflix.com/Catalog/Titles"
            }
        }
    });
});
</script> 
```

所有这些都装载着

```
$("#mydiv").load(url) 
```

有关信息，我有一些网格在部分内部工作，但可编辑网格的下拉列表具有相同的行为，它没有打开......

有人知道吗？

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T12:07:32.990

我试图在本地重现该问题但无济于事 - 提供的代码按预期工作。

你能检查一下[这个测试项目](http://uploading.com/c2927558/DropDownListTest-zip)，让我知道它与你的真实设置有什么不同吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T14:19:13.377

阅读 Vladimir 示例，我替换了我的剑道 ui 参考

和魔法！只是这条线使它工作

```
<script src="http://cdn.kendostatic.com/2012.3.1114/js/jquery.min.js"></script> 
```

似乎 asp.net mvc 模板中的 jquery 版本不适合使用

感谢您的样品！

# java - 使用 dom 解析器 api 在 Java 中覆盖现有的 XML 文档

> ID：14532167
> 
> 赞同：1
> 
> 时间：2013-01-25T23:52:19.563
> 
> 标签：java, xml, dom

我想知道如何使用 dom 解析器覆盖 Java 中的现有元素。例如，我有文件

我正在尝试覆盖元素**并将其替换为元素**

 **谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:45:56.413

算法很简单：

1.  读取文件并将其解析为 XML 文档
2.  进行任何您想要的更改
3.  用新内容覆盖现有文件

看我的例子：

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintWriter;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.transform.OutputKeys;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;

import org.w3c.dom.Document;
import org.w3c.dom.Element;

public class DomProgram {

    public static void main(String[] args) throws Exception {
        File xmlFile = new File("C:\\test.xml");

        Document document = readXmlDocument(xmlFile);

        makeChanges(document);

        Transformer transformer = createXmlTransformer();
        overwriteXmlFile(xmlFile, document, transformer);
    }

    private static void overwriteXmlFile(File xmlFile, Document document,
            Transformer transformer) throws FileNotFoundException,
            TransformerException {
        StreamResult result = new StreamResult(new PrintWriter(
                new FileOutputStream(xmlFile, false)));
        DOMSource source = new DOMSource(document);
        transformer.transform(source, result);
    }

    private static Transformer createXmlTransformer() throws Exception {
        Transformer transformer = TransformerFactory.newInstance()
                .newTransformer();
        transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
        transformer.setOutputProperty(OutputKeys.INDENT, "yes");
        return transformer;
    }

    private static void makeChanges(Document document) {
        Element root = document.getDocumentElement();
        root.setAttribute("test", "testvalue");
    }

    private static Document readXmlDocument(File xmlFile) throws Exception {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = factory.newDocumentBuilder();
        Document document = builder.parse(xmlFile);
        return document;
    }
} 
```

示例 XML 文件：

```
<note>
   <to>Ebele</to>
   <from>mykhaylo</from>
   <heading>Reminder</heading>
   <body>Read about problem before you ask ;)</body>
</note> 
```

另见：

*   [简单的 Java DOM XML 示例](http://www.genedavis.com/library/xml/java_dom_xml_creation.jsp)
*   [如何在 Java 中读取 XML 文件——（DOM 解析器）](http://www.mkyong.com/java/how-to-read-xml-file-in-java-dom-parser/)**

# c++ - 为什么天真的 C++ 矩阵乘法比 BLAS 慢 100 倍？

> ID：14532169
> 
> 赞同：14
> 
> 时间：2013-01-25T23:52:37.113
> 
> 标签：c++, linux, matlab, c++11, matrix-multiplication

我正在查看大型矩阵乘法并运行以下实验以形成基线测试：

1.  从标准标准（0 均值，1 标准差）随机生成两个 4096x4096 矩阵 X、Y。
2.  Z = X*Y
3.  对 Z 的元素求和（以确保它们被访问）并输出。

这是天真的 C++ 实现：

```
#include <iostream>
#include <algorithm>

using namespace std;

int main()
{
    constexpr size_t dim = 4096;

    float* x = new float[dim*dim];
    float* y = new float[dim*dim];
    float* z = new float[dim*dim];

    random_device rd;
    mt19937 gen(rd());
    normal_distribution<float> dist(0, 1);

    for (size_t i = 0; i < dim*dim; i++)
    {
        x[i] = dist(gen);
        y[i] = dist(gen);
    }

    for (size_t row = 0; row < dim; row++)
        for (size_t col = 0; col < dim; col++)
        {
            float acc = 0;

            for (size_t k = 0; k < dim; k++)
                acc += x[row*dim + k] * y[k*dim + col];

            z[row*dim + col] = acc;
        }

    float t = 0;

    for (size_t i = 0; i < dim*dim; i++)
        t += z[i];

    cout << t << endl;

    delete x;
    delete y;
    delete z;
} 
```

编译并运行：

```
$ g++ -std=gnu++11 -O3 test.cpp
$ time ./a.out 
```

这是 Octave/matlab 的实现：

```
X = stdnormal_rnd(4096, 4096);
Y = stdnormal_rnd(4096, 4096);
Z = X*Y;
sum(sum(Z)) 
```

跑：

```
$ time octave < test.octave 
```

引擎盖下的八度音阶正在使用 BLAS（我假设该`sgemm`功能）

硬件是 Linux x86-64 上的 i7 3930X，具有 24 GB 内存。BLAS 似乎使用了两个内核。也许是超线程对？

我发现使用 GCC 4.7 编译的 C++ 版本`-O3`需要 9 分钟才能执行：

```
real    9m2.126s
user    9m0.302s
sys         0m0.052s 
```

八度版本耗时 6 秒：

```
real    0m5.985s
user    0m10.881s
sys         0m0.144s 
```

我知道 BLAS 已针对所有地狱进行了优化，并且天真的算法完全忽略了缓存等等，但是认真的 - 90 次？

谁能解释这个区别？BLAS 实现的架构到底是什么？我看到它正在使用 Fortran，但是 CPU 级别发生了什么？它使用什么算法？它是如何使用 CPU 缓存的？它调用了哪些 x86-64 机器指令？（它是否使用了像 AVX 这样的高级 CPU 功能？）它从哪里获得这种额外的速度？

C++ 算法的哪些关键优化可以使其与 BLAS 版本相提并论？

我在 gdb 下运行 octave 并在计算中途停止了几次。它已经启动了第二个线程，这里是堆栈（所有停止看起来都相似）：

```
(gdb) thread 1
#0  0x00007ffff6e17148 in pthread_join () from /lib/x86_64-linux-gnu/libpthread.so.0
#1  0x00007ffff1626721 in ATL_join_tree () from /usr/lib/libblas.so.3
#2  0x00007ffff1626702 in ATL_join_tree () from /usr/lib/libblas.so.3
#3  0x00007ffff15ae357 in ATL_dptgemm () from /usr/lib/libblas.so.3
#4  0x00007ffff1384b59 in atl_f77wrap_dgemm_ () from /usr/lib/libblas.so.3
#5  0x00007ffff193effa in dgemm_ () from /usr/lib/libblas.so.3
#6  0x00007ffff6049727 in xgemm(Matrix const&, Matrix const&, blas_trans_type, blas_trans_type) () from /usr/lib/x86_64-linux-gnu/liboctave.so.1
#7  0x00007ffff6049954 in operator*(Matrix const&, Matrix const&) () from /usr/lib/x86_64-linux-gnu/liboctave.so.1
#8  0x00007ffff7839e4e in ?? () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#9  0x00007ffff765a93a in do_binary_op(octave_value::binary_op, octave_value const&, octave_value const&) () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#10 0x00007ffff76c4190 in tree_binary_expression::rvalue1(int) () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#11 0x00007ffff76c33a5 in tree_simple_assignment::rvalue1(int) () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#12 0x00007ffff76d0864 in tree_evaluator::visit_statement(tree_statement&) () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#13 0x00007ffff76cffae in tree_evaluator::visit_statement_list(tree_statement_list&) () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#14 0x00007ffff757f6d4 in main_loop() () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1
#15 0x00007ffff7527abf in octave_main () from /usr/lib/x86_64-linux-gnu/liboctinterp.so.1

(gdb) thread 2
#0  0x00007ffff14ba4df in ATL_dJIK56x56x56TN56x56x0_a1_b1 () from /usr/lib/libblas.so.3
(gdb) bt
#0  0x00007ffff14ba4df in ATL_dJIK56x56x56TN56x56x0_a1_b1 () from /usr/lib/libblas.so.3
#1  0x00007ffff15a5fd7 in ATL_dmmIJK2 () from /usr/lib/libblas.so.3
#2  0x00007ffff15a6ae4 in ATL_dmmIJK () from /usr/lib/libblas.so.3
#3  0x00007ffff1518e65 in ATL_dgemm () from /usr/lib/libblas.so.3
#4  0x00007ffff15adf7a in ATL_dptgemm0 () from /usr/lib/libblas.so.3
#5  0x00007ffff6e15e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0
#6  0x00007ffff6b41cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6
#7  0x0000000000000000 in ?? () 
```

它`gemm`按预期调用了 BLAS。

第一个线程似乎正在加入第二个线程，所以我不确定这两个线程是否占观察到的 200% CPU 使用率。

哪个库是 ATL_dgemm libblas.so.3，它的代码在哪里？

```
$ ls -al /usr/lib/libblas.so.3
/usr/lib/libblas.so.3 -> /etc/alternatives/libblas.so.3

$ ls -al /etc/alternatives/libblas.so.3
/etc/alternatives/libblas.so.3 -> /usr/lib/atlas-base/atlas/libblas.so.3

$ ls -al /usr/lib/atlas-base/atlas/libblas.so.3
/usr/lib/atlas-base/atlas/libblas.so.3 -> libblas.so.3.0

$ ls -al /usr/lib/atlas-base/atlas/libblas.so.3.0
/usr/lib/atlas-base/atlas/libblas.so.3.0

$ dpkg -S /usr/lib/atlas-base/atlas/libblas.so.3.0
libatlas3-base: /usr/lib/atlas-base/atlas/libblas.so.3.0

$ apt-get source libatlas3-base 
```

它是 ATLAS 3.8.4

以下是我后来实施的优化：

使用平铺方法，我将 64x64 的 X、Y 和 Z 块预加载到单独的数组中。

更改每个块的计算，使内部循环如下所示：

```
for (size_t tcol = 0; tcol < block_width; tcol++)
    bufz[trow][tcol] += B * bufy[tk][tcol]; 
```

这允许 GCC 自动矢量化为 SIMD 指令，还允许指令级并行（我认为）。

开机`march=corei7-avx`。这获得了 30% 的额外速度，但这是作弊，因为我认为 BLAS 库是预先构建的。

这是代码：

```
#include <iostream>
#include <algorithm>

using namespace std;

constexpr size_t dim = 4096;
constexpr size_t block_width = 64;
constexpr size_t num_blocks = dim / block_width;

double X[dim][dim], Y[dim][dim], Z[dim][dim];

double bufx[block_width][block_width];
double bufy[block_width][block_width];
double bufz[block_width][block_width];

void calc_block()
{
    for (size_t trow = 0; trow < block_width; trow++)
        for (size_t tk = 0; tk < block_width; tk++)
        {
            double B = bufx[trow][tk];

            for (size_t tcol = 0; tcol < block_width; tcol++)
                bufz[trow][tcol] += B * bufy[tk][tcol];
        }
}

int main()
{
    random_device rd;
    mt19937 gen(rd());
    normal_distribution<double> dist(0, 1);

    for (size_t row = 0; row < dim; row++)
        for (size_t col = 0; col < dim; col++)
        {
            X[row][col] = dist(gen);
            Y[row][col] = dist(gen);
            Z[row][col] = 0;
        }

    for (size_t block_row = 0; block_row < num_blocks; block_row++)
        for (size_t block_col = 0; block_col < num_blocks; block_col++)
        {
            for (size_t trow = 0; trow < block_width; trow++)
                for (size_t tcol = 0; tcol < block_width; tcol++)
                    bufz[trow][tcol] = 0;

            for (size_t block_k = 0; block_k < num_blocks; block_k++)
            {
                for (size_t trow = 0; trow < block_width; trow++)
                    for (size_t tcol = 0; tcol < block_width; tcol++)
                    {
                        bufx[trow][tcol] = X[block_row*block_width + trow][block_k*block_width + tcol];
                        bufy[trow][tcol] = Y[block_k*block_width + trow][block_col*block_width + tcol];
                    }

                calc_block();
            }

            for (size_t trow = 0; trow < block_width; trow++)
                for (size_t tcol = 0; tcol < block_width; tcol++)
                    Z[block_row*block_width + trow][block_col*block_width + tcol] = bufz[trow][tcol];

        }

    double t = 0;

    for (size_t row = 0; row < dim; row++)
        for (size_t col = 0; col < dim; col++)
            t += Z[row][col];

    cout << t << endl;
} 
```

所有的动作都在 calc_block 函数中——超过 90% 的时间都花在它上面。

新的时间是：

```
real    0m17.370s
user    0m17.213s
sys 0m0.092s 
```

哪个更接近。

calc_block函数的反编译如下：

```
0000000000401460 <_Z10calc_blockv>:
  401460:   b8 e0 21 60 00          mov    $0x6021e0,%eax
  401465:   41 b8 e0 23 61 00       mov    $0x6123e0,%r8d
  40146b:   31 ff                   xor    %edi,%edi
  40146d:   49 29 c0                sub    %rax,%r8
  401470:   49 8d 34 00             lea    (%r8,%rax,1),%rsi
  401474:   48 89 f9                mov    %rdi,%rcx
  401477:   ba e0 a1 60 00          mov    $0x60a1e0,%edx
  40147c:   48 c1 e1 09             shl    $0x9,%rcx
  401480:   48 81 c1 e0 21 61 00    add    $0x6121e0,%rcx
  401487:   66 0f 1f 84 00 00 00    nopw   0x0(%rax,%rax,1)
  40148e:   00 00 
  401490:   c4 e2 7d 19 01          vbroadcastsd (%rcx),%ymm0
  401495:   48 83 c1 08             add    $0x8,%rcx
  401499:   c5 fd 59 0a             vmulpd (%rdx),%ymm0,%ymm1
  40149d:   c5 f5 58 08             vaddpd (%rax),%ymm1,%ymm1
  4014a1:   c5 fd 29 08             vmovapd %ymm1,(%rax)
  4014a5:   c5 fd 59 4a 20          vmulpd 0x20(%rdx),%ymm0,%ymm1
  4014aa:   c5 f5 58 48 20          vaddpd 0x20(%rax),%ymm1,%ymm1
  4014af:   c5 fd 29 48 20          vmovapd %ymm1,0x20(%rax)
  4014b4:   c5 fd 59 4a 40          vmulpd 0x40(%rdx),%ymm0,%ymm1
  4014b9:   c5 f5 58 48 40          vaddpd 0x40(%rax),%ymm1,%ymm1
  4014be:   c5 fd 29 48 40          vmovapd %ymm1,0x40(%rax)
  4014c3:   c5 fd 59 4a 60          vmulpd 0x60(%rdx),%ymm0,%ymm1
  4014c8:   c5 f5 58 48 60          vaddpd 0x60(%rax),%ymm1,%ymm1
  4014cd:   c5 fd 29 48 60          vmovapd %ymm1,0x60(%rax)
  4014d2:   c5 fd 59 8a 80 00 00    vmulpd 0x80(%rdx),%ymm0,%ymm1
  4014d9:   00 
  4014da:   c5 f5 58 88 80 00 00    vaddpd 0x80(%rax),%ymm1,%ymm1
  4014e1:   00 
  4014e2:   c5 fd 29 88 80 00 00    vmovapd %ymm1,0x80(%rax)
  4014e9:   00 
  4014ea:   c5 fd 59 8a a0 00 00    vmulpd 0xa0(%rdx),%ymm0,%ymm1
  4014f1:   00 
  4014f2:   c5 f5 58 88 a0 00 00    vaddpd 0xa0(%rax),%ymm1,%ymm1
  4014f9:   00 
  4014fa:   c5 fd 29 88 a0 00 00    vmovapd %ymm1,0xa0(%rax)
  401501:   00 
  401502:   c5 fd 59 8a c0 00 00    vmulpd 0xc0(%rdx),%ymm0,%ymm1
  401509:   00 
  40150a:   c5 f5 58 88 c0 00 00    vaddpd 0xc0(%rax),%ymm1,%ymm1
  401511:   00 
  401512:   c5 fd 29 88 c0 00 00    vmovapd %ymm1,0xc0(%rax)
  401519:   00 
  40151a:   c5 fd 59 8a e0 00 00    vmulpd 0xe0(%rdx),%ymm0,%ymm1
  401521:   00 
  401522:   c5 f5 58 88 e0 00 00    vaddpd 0xe0(%rax),%ymm1,%ymm1
  401529:   00 
  40152a:   c5 fd 29 88 e0 00 00    vmovapd %ymm1,0xe0(%rax)
  401531:   00 
  401532:   c5 fd 59 8a 00 01 00    vmulpd 0x100(%rdx),%ymm0,%ymm1
  401539:   00 
  40153a:   c5 f5 58 88 00 01 00    vaddpd 0x100(%rax),%ymm1,%ymm1
  401541:   00 
  401542:   c5 fd 29 88 00 01 00    vmovapd %ymm1,0x100(%rax)
  401549:   00 
  40154a:   c5 fd 59 8a 20 01 00    vmulpd 0x120(%rdx),%ymm0,%ymm1
  401551:   00 
  401552:   c5 f5 58 88 20 01 00    vaddpd 0x120(%rax),%ymm1,%ymm1
  401559:   00 
  40155a:   c5 fd 29 88 20 01 00    vmovapd %ymm1,0x120(%rax)
  401561:   00 
  401562:   c5 fd 59 8a 40 01 00    vmulpd 0x140(%rdx),%ymm0,%ymm1
  401569:   00 
  40156a:   c5 f5 58 88 40 01 00    vaddpd 0x140(%rax),%ymm1,%ymm1
  401571:   00 
  401572:   c5 fd 29 88 40 01 00    vmovapd %ymm1,0x140(%rax)
  401579:   00 
  40157a:   c5 fd 59 8a 60 01 00    vmulpd 0x160(%rdx),%ymm0,%ymm1
  401581:   00 
  401582:   c5 f5 58 88 60 01 00    vaddpd 0x160(%rax),%ymm1,%ymm1
  401589:   00 
  40158a:   c5 fd 29 88 60 01 00    vmovapd %ymm1,0x160(%rax)
  401591:   00 
  401592:   c5 fd 59 8a 80 01 00    vmulpd 0x180(%rdx),%ymm0,%ymm1
  401599:   00 
  40159a:   c5 f5 58 88 80 01 00    vaddpd 0x180(%rax),%ymm1,%ymm1
  4015a1:   00 
  4015a2:   c5 fd 29 88 80 01 00    vmovapd %ymm1,0x180(%rax)
  4015a9:   00 
  4015aa:   c5 fd 59 8a a0 01 00    vmulpd 0x1a0(%rdx),%ymm0,%ymm1
  4015b1:   00 
  4015b2:   c5 f5 58 88 a0 01 00    vaddpd 0x1a0(%rax),%ymm1,%ymm1
  4015b9:   00 
  4015ba:   c5 fd 29 88 a0 01 00    vmovapd %ymm1,0x1a0(%rax)
  4015c1:   00 
  4015c2:   c5 fd 59 8a c0 01 00    vmulpd 0x1c0(%rdx),%ymm0,%ymm1
  4015c9:   00 
  4015ca:   c5 f5 58 88 c0 01 00    vaddpd 0x1c0(%rax),%ymm1,%ymm1
  4015d1:   00 
  4015d2:   c5 fd 29 88 c0 01 00    vmovapd %ymm1,0x1c0(%rax)
  4015d9:   00 
  4015da:   c5 fd 59 82 e0 01 00    vmulpd 0x1e0(%rdx),%ymm0,%ymm0
  4015e1:   00 
  4015e2:   c5 fd 58 80 e0 01 00    vaddpd 0x1e0(%rax),%ymm0,%ymm0
  4015e9:   00 
  4015ea:   48 81 c2 00 02 00 00    add    $0x200,%rdx
  4015f1:   48 39 ce                cmp    %rcx,%rsi
  4015f4:   c5 fd 29 80 e0 01 00    vmovapd %ymm0,0x1e0(%rax)
  4015fb:   00 
  4015fc:   0f 85 8e fe ff ff       jne    401490 <_Z10calc_blockv+0x30>
  401602:   48 83 c7 01             add    $0x1,%rdi
  401606:   48 05 00 02 00 00       add    $0x200,%rax
  40160c:   48 83 ff 40             cmp    $0x40,%rdi
  401610:   0f 85 5a fe ff ff       jne    401470 <_Z10calc_blockv+0x10>
  401616:   c5 f8 77                vzeroupper 
  401619:   c3                      retq   
  40161a:   66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-26T00:27:39.027

以下是导致您的代码和 BLAS 之间的性能差异的三个因素（加上关于 Strassen 算法的注释）。

在您的内部循环中，在 上`k`，您有`y[k*dim + col]`. 由于内存缓存的排列方式，相同的连续值`k`映射到相同的缓存集`dim`。`col`缓存的结构方式是，每个内存地址都有一个缓存集，当它在缓存中时，它的内容必须被保存。每个高速缓存集都有几行（通常为四行），每一行都可以保存映射到该特定高速缓存集的任何内存地址。

因为您的内部循环`y`以这种方式迭代，所以每次它使用 from 的元素时`y`，它必须将该元素的内存加载到与前一次迭代相同的集合中。这会强制驱逐集合中的先前缓存行之一。然后，在`col`循环的下一次迭代中， 的所有元素`y`都已从缓存中逐出，因此必须再次重新加载它们。

因此，**每次**循环加载 的元素时`y`，都必须从内存中加载它，这需要很多 CPU 周期。

高性能代码通过两种方式避免了这种情况。一，它将工作分成更小的块。行和列被划分为更小的尺寸，并使用更短的循环进行处理，这些循环能够使用高速缓存行中的所有元素，并在每个元素进入下一个块之前多次使用它们。因此，大多数对元素的引用`x`和元素`y`来自缓存，通常在单个处理器周期中。第二，在某些情况下，代码会将数据从矩阵的一列（由于几何形状而颠簸缓存）复制到临时缓冲区的行中（避免颠簸）。这再次允许从缓存而不是从内存中提供大多数内存引用。

另一个因素是使用单指令多数据 (SIMD) 功能。许多现代处理器的指令`float`在一条指令中加载多个元素（典型的是四个元素，但现在有些是八个），存储多个元素，添加多个元素（例如，对于这四个中的每一个，将其添加到这四个中的对应一个)，将多个元素相乘，等等。只要您能够安排工作以使用这些指令，只需立即使用这些指令即可使您的代码速度提高四倍。

这些指令在标准 C 中不能直接访问。一些优化器现在尽可能地尝试使用这些指令，但是这种优化很困难，并且从中获得太多好处并不常见。许多编译器提供了语言的扩展，可以访问这些指令。就个人而言，我通常更喜欢用汇编语言编写来使用 SIMD。

另一个因素是在处理器上使用指令级并行执行功能。请注意，在您的内部循环中，`acc`已更新。`acc`在上一次迭代完成更新之前，下一次迭代无法添加`acc`. 相反，高性能代码将保持多个总和并行运行（甚至是多个 SIMD 总和）。这样做的结果是，在执行一个总和的加法时，将开始另一个总和的加法。在当今的处理器上，一次支持四个或更多的浮点运算是很常见的。如所写，您的代码根本无法做到这一点。一些编译器会尝试通过重新排列循环来优化代码，但这要求编译器能够看到特定循环的迭代是相互独立的，或者可以与另一个循环交换，等等。

使用缓存有效地提供十倍的性能提升是完全可行的，SIMD 提供了另外四倍，指令级并行提供了另外四倍，总共提供了 160。

这是基于[此 Wikipedia 页面](http://en.wikipedia.org/wiki/Matrix_multiplication)的 Strassen 算法效果的非常粗略的估计。维基百科页面说 Strassen 在 n = 100 附近比直接乘法略好。这表明执行时间的常数因子的比率为 100 ³ / 100 ^(2.807) ≈ 2.4。显然，这将因处理器型号、与缓存效果交互的矩阵大小等而有很大差异。然而，简单的推断表明，在 n = 4096 ((4096/100) ^(3-2.807) ≈ 2.05) 时，Strassen 的性能大约是直接乘法的两倍。同样，这只是一个大概的估计。

至于后面的优化，请考虑在内循环中的这段代码：

```
bufz[trow][tcol] += B * bufy[tk][tcol]; 
```

一个潜在的问题是，`bufz`一般来说，可能会重叠`bufy`。`bufz`由于您对and使用全局定义`bufy`，因此编译器可能知道它们在这种情况下不会重叠。但是，如果您将此代码移动到作为参数传递的子例程中`bufz`，`bufy`特别是如果您在单独的源文件中编译该子例程，则编译器不太可能知道这一点`bufz`并且`bufy`不会重叠。在这种情况下，编译器无法对代码进行向量化或以其他方式重新排序，因为`bufz[trow][tcol]`本次迭代中的 可能与`bufy[tk][tcol]`另一次迭代中的相同。

即使编译器可以看到子例程在当前源模块中被不同的调用，如果例程具有`bufz`链接（默认），那么编译器必须允许从外部模块调用例程，所以它必须如果和重叠，则生成可以正常工作的代码。（编译器可以处理这个问题的一种方法是生成两个版本的例程，一个从外部模块调用，一个从当前正在编译的模块调用。是否这样做取决于您的编译器，优化开关，等等。）如果您将例程声明为`bufy``extern``bufz``bufy``static`，然后编译器知道它不能从外部模块调用（除非您获取它的地址并且地址有可能传递到当前模块之外）。

另一个潜在问题是，即使编译器将此代码向量化，它也不一定会为您执行的处理器生成最佳代码。查看生成的汇编代码，编译器似乎只是`%ymm1`重复使用。一遍又一遍，它将内存中的一个值乘以`%ymm1`，将内存中的一个值添加到`%ymm1`，然后将一个值存储`%ymm1`到内存中。这有两个问题。

一，您不希望这些部分和经常存储到内存中。您希望将许多加法累积到一个寄存器中，并且该寄存器只会很少写入内存。说服编译器这样做可能需要重写代码以明确将部分和保存在临时对象中并在循环完成后将它们写入内存。

第二，这些指令名义上是串行相关的。在乘法完成之前添加无法开始，并且在添加完成之前存储无法写入内存。Core i7 具有强大的乱序执行能力。因此，虽然它有等待开始执行的加法，但它稍后会在指令流中查看乘法并启动它。（即使乘法也使用`%ymm1`，处理器动态地重新映射寄存器，以便它使用不同的内部寄存器来执行此乘法运算。）即使您的代码充满了连续的依赖关系，处理器也会尝试一次执行多个指令。但是，有很多事情会干扰这一点。您可能会用完处理器用于重命名的内部寄存器。您使用的内存地址可能会遇到错误的冲突。（处理器查看十几个内存地址的低位，以查看该地址是否与它尝试从较早指令加载或存储的另一个地址相同。如果位相等，则处理器具有延迟当前的加载或存储，直到它可以验证整个地址是不同的。这种延迟可能会比当前的加载或存储更多。）所以，

这是我更喜欢在汇编中编写高性能代码的另一个原因。要在 C 中做到这一点，您必须说服编译器给您这样的指令，方法是编写一些您自己的 SIMD 代码（使用它们的语言扩展）和手动展开循环（编写多个迭代）。

复制进出缓冲区时，可能会出现类似问题。但是，您报告 90% 的时间都花在 中`calc_block`，所以我没有仔细研究过。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-26T00:35:19.000

与朴素算法相比，Strassen 算法有两个优点：

1.  正如其他答案正确指出的那样，就操作数量而言，时间复杂度更高；
2.  它是一种[缓存遗忘算法](http://en.wikipedia.org/wiki/Cache-oblivious_algorithm)。[缓存未命中数的差异](http://www.cs.au.dk/~gerth/emF03/slides/cacheoblivious.pdf)为`B*M½`，其中 B 是缓存行大小，M 是缓存大小。

我认为第二点在很大程度上解释了您所经历的放缓。如果您在 Linux 下运行应用程序，我建议您使用该`perf`工具运行它们，它会告诉您程序正在经历多少缓存未命中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T23:59:54.260

我不知道这些信息有多可靠，但[维基百科](http://en.wikipedia.org/wiki/Matrix_multiplication)说 BLAS 使用 Strassen 的大矩阵算法。你的确实很大。这大约是 O(n^2.807)，比你的 O(n^3) 天真的算法要好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-28T07:18:03.200

这是一个相当复杂的话题，Eric 在上面的帖子中回答得很好。我只想指出这个方向的有用参考，第 84 页：

[http://www.rrze.fau.de/dienste/arbeiten-rechnen/hpc/HPC4SE/](http://www.rrze.fau.de/dienste/arbeiten-rechnen/hpc/HPC4SE/)

这建议在阻塞之上进行“循环展开和堵塞”。

> 谁能解释这个区别？

A general explanation is that, the ratio of the number of operations/number of data is O(N^3)/O(N^2). Thus matrix-matrix multiplication is a cache-bound algorithm, which means that you don't suffer from common memory-bandwidth bottleneck, for large matrix sizes. You can get up to 90% of peak performance of your CPU if the code well-optimized. So the optimization potential, elaborated by Eric, is tremendous as you observed. Actually, it would be very interesting to see the best performing code, and compile your final program with another compiler (intel usually brags to be the best).

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-26T00:22:41.327

大约一半的差异用于算法改进。(4096*4096)^3 是算法的复杂度，即 4.7x10^21，(4096*4096)^2.807 是 1x10^20。这是大约 47 倍的差异。

其他 2 倍将通过更智能地使用缓存、SSE 指令和其他此类低级优化来解决。

编辑：我撒谎，n 是宽度，而不是宽度^2。该算法实际上只占大约 4 倍，所以还有大约 22 倍要走。线程、缓存和 SSE 指令可以很好地解释这些事情。

# http - 如何在php中使用cURL更改http标头以放置每个数据点

> ID：14532170
> 
> 赞同：0
> 
> 时间：2013-01-25T23:52:38.237
> 
> 标签：http, curl, libcurl, put

目前我正在尝试通过接受 PUT 的 REST API 上传文件。我需要提供两件事：描述目标字段的 xml/json 数据和原始数据。此操作的文档可在此处找到：

[http://lj.platformatyourservice.com/wiki/REST_API:record_Resource#Multipart_Operations_for_Raw_Data](http://lj.platformatyourservice.com/wiki/REST_API:record_Resource#Multipart_Operations_for_Raw_Data)

如果你想跳到这个问题，它就在底部附近。

到目前为止我所拥有的：

```
public function uploadDocument($aContract){
    $sUrl = $this->sRestUrl."/record/contract/1523";

    $sFileName = TMP_DIR."/".$aContract['Name'];
    $rTmpFile = fopen($sFileName, "w");
    $sContents = fwrite($rTmpFile, $aContract['Content']);

    $aData = array(
        '__json_data__' => '{
            "platform":{
                "record": {
                    "contract_file": "{$aContract[\'Name\']}"
                }
            }
        }',
        'contract_file' => "@$sFileName"
    );

    $ch = curl_init($sUrl);

    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_VERBOSE, 1);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLINFO_HEADER_OUT, true);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT");
    curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: multipart/form-data;'));
    curl_setopt($ch, CURLOPT_POSTFIELDS, $aData);

    $rResponse = curl_exec($ch);
    curl_close($ch);

    return $rResponse
} 
```

这几乎已经足够了。它生成这个请求：

```
PUT https://na.longjump.com/networking/rest/record/contract/1523 HTTP/1.1
Host: username.project
Accept: */*
Cookie: project=2943572094357209345
Content-Length: 304581
Expect: 100-continue
Content-Type: multipart/form-data; boundary=----------------------------a9sd7f039h2
------------------------------0849a88a4ca4 Content-Disposition: form-data; name="__json_data__" { "platform":{ "record": { "contract_file": "{$aContract['Name']}" } } } ------------------------------0849a88a4ca4 Content-Disposition: form-data; name="contract_file"; filename="/home/username/project/tmp/document.doc" Content-Type: application/octet-stream 
```

然后是所有原始编码的二进制数据（它确实成功地转换成一个单词文档）。

让我重新格式化标题，以便您可以更轻松地阅读它：

```
Content-Type: multipart/form-data; boundary=----------------------------a9sd7f039h2
------------------------------a9sd7f039h2
Content-Disposition: form-data;
name="__json_data__"
{ "platform":{ "record": { "contract_file": "{$aContract['Name']}" } } }     
------------------------------a9sd7f039h2
Content-Disposition: form-data; 
name="contract_file"; 
filename="/home/username/project/tmp/document.doc" 
Content-Type: application/octet-stream 
```

这让我得到以下回应：

```
HTTP/1.1 400 Bad Request Server: Apache-Coyote/1.1 Cache-Control: no-cache 
Pragma: no-cache Content-Type: application/json;charset=UTF-8 P3P: CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT" 
Date: Fri, 25 Jan 2013 23:49:36 GMT Transfer-Encoding: chunked Connection: close     
Connection: Transfer-Encoding {"platform": {"message": { "code": "-684", "description": "Invalid Content-Type" }}} 
```

**我认为这很好，只是我需要为 .json 的 json 数据设置一个 Content-Type 标头`Content-Type: application/json`。你是怎样做的？**

我已经看到建议这样做：

```
$aData = array(
    '__json_data__' => '{"data":"data"};type=application/json
); 
```

或者

```
$aData = array(
    '__json_data__' => '{"data":"data"};Content-Type=application/json
); 
```

但只在一处。我试过了，它并没有真正做任何事情，而且还是很草率。另外，我已经尝试过 http_build_query 的数据，但这也没有为我做。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:51:23.260

好的。经过大量的虚假，我想出了一个奇怪的解决方案。基本上，我向自己的服务器发出了 put 请求，将响应回显给自己，然后将其放入 CURLOPT_POSTFIELDS。这是代码（请记住它是简化的；真正的代码在函数中具有第二位，都在一个类中）：

```
function getRawHeader($ch){
    $sResponse = $this->executeCurl($ch);

    preg_match("/------------------------------(\w)+/", $sResponse, $aBoundary);
    if($aBoundary){
        $sBoundary = $aBoundary[0];
        $aResponse = explode($sBoundary, $sResponse);
        foreach($aResponse as &$sPart){
             // Find the string that defines content-type, and add it as a header (if there is one)
            preg_match("/;Content-Type:\s([\w\/])+/", $sPart, $aContentType);
            if($aContentType){
                $sContentType = $aContentType[0];
                // Get that out of the request
                $sPart = str_replace("$sContentType", "", $sPart);
                // Trim the fluff for the content type
                $sContentType = str_replace(";Content-Type: ", "", $sContentType);
                // Now insert the content type into the header.
                $sPart = str_replace(": form-data;", ": form-data; Content-Type: $sContentType;", $sPart);
            }

        }
        unset($sPart);

        return implode($sBoundary, $aResponse);
    }
    return $sResponse;
}

$sLongjumpUrl = $this->sRestUrl."/record/Contract_Custom/1001";
$sLocalUrl = HTML_ROOT."/echorequest.php";

$sFileName = TMP_DIR."/".$aContract['Name'];
$rTmpFile = fopen($sFileName, "w");
$sContents = fwrite($rTmpFile, $aContract['Content']);

$aData = array(
    '__json_data__' => json_encode(
        array(
            'platform' => array(
                'record' => array(
                    'contract_file' => $aContract['Name']
                )
            )
        )
    ).";Content-Type: application/json", // this gets parsed manually below
    'contract_file' => "@$sFileName"
);
// get our raw subheaders
$ch = $this->getCurl($sLocalUrl);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Content-Type: multipart/form-data"));
curl_setopt($ch, CURLOPT_POSTFIELDS, $aData);
$sResponse = $this->getRawHeader($ch);

// Get us a new curl, for actually sending the data to longjump
$ch = $this->getCurl($sLongjumpUrl);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT");
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Content-Type: multipart/form-data"));

// We gotta manually add a boundary consistent with the one automatically generated above.
preg_match("/------------------------------(\w)+/", $sResponse, $aBoundary);
$sBoundary = $aBoundary ? $aBoundary[0] : '';
$sBoundaryMarker = $sBoundary ? "boundary=" : '';
curl_setopt($ch, CURLOPT_POSTFIELDS, $sBoundaryMarker.preg_replace("/------------------------------(\w)+/", $sBoundary, $sResponse));

$sResponse = $this->executeCurl($ch); 
```

这似乎已经完成了获得我想要的自定义标题的工作，尽管我对此不是很有信心。我仍然遇到api返回空白字符串的问题，没有状态码，所以我不知道这是怎么回事。但我认为这个问题已经得到解决。

# java - JFrame 弹出窗口未出现在 JAR 中

> ID：14532172
> 
> 赞同：1
> 
> 时间：2013-01-25T23:53:01.070
> 
> 标签：java, swing, ant

我有一个用 Java 构建的应用程序，当在应用程序中按下某个按钮时，另一个 jframe 应该弹出一条消息。我制作的 ant 文件将可运行的 jar 放入我的 Eclipse 项目中的文件夹中。构建 jar 后，我在它所在的文件夹中运行 jar，它运行良好。我可以单击使弹出窗口出现的按钮，它确实出现了。

当我把罐子移到桌面上时，问题就来了。然后运行 ​​jar 启动应用程序，但按下按钮什么也不做（没有弹出窗口）。

现在，我知道我之前遇到过一些问题，包括一些图像资源，并且不得不使用 getResource() 等。我不明白为什么我必须做这样的事情，因为所有“资源”都只是指定的 .class 文件在构建路径中。我的意思是，所有应用程序应该做的就是创建一个 jframe ......

编辑：添加 build.xml 编辑：精简 build.xml ——我认为问题在于 JAR 的构建。

 `````
<!--Creates the deployable jar file  -->
<target name="jar" depends="compile">
    <echo>"Making Deployable Jar..."</echo>
    <jar destfile="${shipping.dir}/POSsystem.jar" basedir="${build.dir}">

        <fileset dir="." includes="${imgs.dir}/**"/>
        <fileset dir="." includes="db/**"/> 
```

```
 <manifest>
            <attribute name="Built-By" value="${user.name}"/>
            <attribute name="Main-Class" value="${main-class}" />
            <attribute name = "SplashScreen-Image" value="${splash-screen}" />
        </manifest>

    </jar>
    <echo>"Success Making Deployable Jar..."</echo>
</target> 
````  `编辑 3：添加了通过命令行运行的输出。

 `````
C:\Users\Matt\Desktop>java -jar POSsystem.jar
LOG COULD NOT BE CREATED!
java.io.IOException: The system cannot find the path specified
        at java.io.WinNTFileSystem.createFileExclusively(Native Method)
        at java.io.File.createNewFile(Unknown Source)
        at pos.log.GeneralLog.beginLog(Unknown Source)
        at pos.main.POSsystem.main(Unknown Source) 
````  `这是第一个错误。应用程序应在 JAR 中的日志文件夹中保留一个 log.txt。您可以在 build.xml（发布的第一件事）中看到我将要构建的日志文件夹添加到 JAR 中，这很好，但是我的 log.java 代码中的路径显然会给我带来问题，因为它很难 -编码路径。所以我的问题是：如何在 JAR 文件中包含资源的路径。我知道要包含图像，我会执行以下操作： javax.swing.ImageIcon(getClass().getResource("/images/pos_header_icon.png")); 但我不确定如何访问文件位置...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T10:25:05.707

> *应用程序应* `log.txt` *在 JAR 中的日志文件夹中保存一个。*

[如此处](https://stackoverflow.com/q/1224817/230513)所述，可以从 JAR 中提取文件、修改文件并恢复存档；但是改变当前加载的类正在运行的 JAR 是不切实际的。对于正在进行的日志来说，这将是一个特殊的问题。相反，使用请求合适的路径[`JFileChooser`](http://docs.oracle.com/javase/tutorial/uiswing/components/filechooser.html)并将其保存在应用程序的`java.util.Preferences`. 一些平台有推荐的路径，[例如](https://stackoverflow.com/a/14233171/230513).````

# javascript - 如何使箭头键和空格键不强制我的网页向下？

> ID：14532173
> 
> 赞同：1
> 
> 时间：2013-01-25T23:53:27.217
> 
> 标签：javascript, html, css

我建立了一个游戏，我使用箭头键移动和空格键射击，每次我按下向下键或空格键时它都会强制它向下到网页底部有没有办法修改 CSS 到让它专注于游戏 div 标签而不是滚动？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T23:55:10.817

您未能取消活动。如果它是一个内联事件，就`return false;`在它的末尾。如果用 完成`addEventListener`，请调用`***Event***.preventDefault()`and `return false;`。

# ios - 更改 UIToolbar UIBarMetrics

> ID：14532174
> 
> 赞同：2
> 
> 时间：2013-01-25T23:53:52.243
> 
> 标签：ios, objective-c, rotation, uitoolbar, uibarmetrics

无论如何，当设备旋转时，自定义 UIToolbar 的 UIBarMetrics 是否会发生变化？我希望它自动发生，但如果在轮换期间我可以做些什么也可以。我想使用 UIAppearance 所以手动调整栏的高度是行不通的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:28:23.950

我想你需要

> UIToolbar *toolbar = [UIToolbar 外观];
> 
> [工具栏 setBackgroundImage:[UIImage imageNamed:@"toolbarLandscapePhone"] forToolbarPosition:UIToolbarPositionBottom barMetrics:UIBarMetricsLandscapePhone];

您可以简单地将 BarMetrics 设置为 UIBarMetricsLandscapePhone

# php - WordPress/mySQL 如何将标签与帖子关联起来

> ID：14532175
> 
> 赞同：0
> 
> 时间：2013-01-25T23:53:53.307
> 
> 标签：php, mysql, wordpress, tags

> **可能重复：**
> [您如何建议实施标签或标记](https://stackoverflow.com/questions/20856/how-do-you-recommend-implementing-tags-or-tagging)

我正在学习一些 php/mysql 并且我想到了 wordpress 如何将标签与帖子相关联，更重要的是，标签与多个帖子相关联，而无需在每个帖子/行的几个不同单元格中重复标签本身-mysql

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:00:16.787

不是特定于 wordpress，而是任何关系数据库架构。基本上你有一个包含内容的表格和一个带有标签的表格。然后为了连接这两者，你有一个将一个与另一个相关联的表。

这是更深入描述的链接： [http ://www.anchor.com.au/hosting/support/CreatingAQuickMySQLRelationalDatabase](http://www.anchor.com.au/hosting/support/CreatingAQuickMySQLRelationalDatabase)

所以你有一个带有主键 id 的内容表。您还有一个带有自己的主键 ID 的标签表。您的关系表具有这两个 ID，就像这样...

```
----------------------------
| id | content_id | tag_id |
---------------------------- 
```

然后，您可以使用多种[连接](http://dev.mysql.com/doc/refman/5.0/en/join.html)来根据标签等选择内容。

不过，这个主题对于堆栈溢出来说太深入了。建议您对 mysql 数据库结构、关系表和连接进行一些基本的 google 搜索。这份清单可能会持续几天。

有什么具体问题吗？如果你问我可能会更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:06:13.343

php代码和MySQL查询可以在`wp-includes/taxonomy.php`文件中找到，特别是`wp_set_object_terms()`函数：[http ://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/taxonomy.php#L2147](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/taxonomy.php#L2147)

# image - 在底部对齐图像

> ID：14532180
> 
> 赞同：0
> 
> 时间：2013-01-25T23:54:10.607
> 
> 标签：image, css

所以我有一个 120x120 的图像空间，它用于缩略图，特别是在宽度上。这是一个包含图像的 div，链接到文章

我有一个 120x57 的图像，但它停留在 div 的顶部，让下一个 div 上的文本有太多空间

```
<div class="thumb">
<a href="http://link.com"><img src="http://link.com/media/thumb.png" border="0" alt="thumb" title="thumb" class="thumblist"></a>
</div> 
```

它的CSS：

```
margin: 8px 0;
width: auto;
height: 120px;
overflow: hidden; 
```

我试过垂直对齐：底部，但没有成功，没有其他干净的方法可以将其对齐到中间（或至少对齐到底部？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:41:43.520

你可以试试这个：

```
.thumb {
   margin: 8px 0;
   width: auto;
   height: 120px;
   overflow: hidden;

   display:table-cell;
   vertical-align:bottom;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:41:50.107

我可以想到几种方法，但没有一种特别优雅。

在背景中设置图像是最快的，但无法选择或打印图像（使用默认打印设置）。（为清楚起见，样式是内联的。）

```
<a href="#" style="display: block; width: 120px; height: 120px;
    background: url(thumb.jpg) bottom no-repeat;"></a> 
```

绝对定位是一个有效的选择，但它也有它的问题。

```
<a href="#" style="display: block; width: 120px; height: 120px; position: relative;">
<img src="thumb.jpg" style="display: block; position: absolute; bottom: 0px; left: 0px; width: 120px;" /></a> 
```

最简单和最可靠的方法之一就是制作一个方形图像，并根据需要进行填充。它涉及手动工作或额外的脚本来准备图像。

然后是桌子，但是，嗯，是桌子……

如果有方便的图像生成器或者没有太多缩略图可以自己在 Photoshop 中调整它们，我会选择方形图像。如果做不到这一点，背景在大多数情况下都可以正常工作。

# android - 哪些 Android Fragment 生命周期方法需要 super

> ID：14532182
> 
> 赞同：9
> 
> 时间：2013-01-25T23:54:17.120
> 
> 标签：android, overriding, super

`super`目前（Android API 17）， Android [Reference on Fragment](http://developer.android.com/reference/android/app/Fragment.html)中唯一提到的只是通过一些代码示例随便提及（不像[Activity 上的 Android Reference](http://developer.android.com/reference/android/app/Activity.html)，它仔细指出了`super`需要的地方）。

SO 建议根据需要[搜索网络](https://stackoverflow.com/questions/10843383/why-do-we-have-to-call-super-in-android-sometimes)，或等待崩溃，以确定需要调用的`super`位置。我要求 SO 用户分享他们关于哪些 Fragment 生命周期方法需要调用`super`.

## 片段生命周期方法 - 需要调用`super`

*   `onAttach()`
*   `onCreate()`- 大概是的，因为`Activity`版本需要它
*   `onCreateView()`- 无论有无似乎都可以
*   `onActivityCreated()`
*   `onViewStateRestored()`
*   `onStart()`- 大概是的，因为`Activity`版本需要它
*   `onResume()`- 大概是的，因为`Activity`版本需要它

*   `onPause()`- 大概是的，因为`Activity`版本需要它

*   `onStop()`- 大概是的，因为`Activity`版本需要它
*   `onDestroyView()`
*   `onDestroy()`- 大概是的，因为`Activity`版本需要它
*   `onDetach()`

*   `onSaveInstanceState()`- 大概是的，因为`Activity`版本需要它

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T00:15:36.910

所有对应的 Activity 生命周期方法，除了`onSaveInstanceState`需要调用 super。此外：

*   `onAttach()`- 是的
*   `onActivityCreated()`- 是的
*   `onViewStateRestored()`- 不是片段方法
*   `onDestroyView()`- 是的
*   `onDetach()`- 是的
*   `onSaveInstanceState()`- 从[Fragment#onSaveInstanceState](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/Fragment.java#Fragment.onSaveInstanceState%28android.os.Bundle%29)它看起来像一个否

所有需要调用 super 的方法在 android.app.Fragment 中共享其方法的第一行： `mCalled = true;`

这样，FragmentManager 可以检查 mCalled 是否为真，并在未调用时抛出 SuperNotCalledException。请参阅[FragmentManager#moveToState](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/FragmentManager.java#FragmentManagerImpl.moveToState%28android.app.Fragment,int,int,int,boolean%29)以查看此实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T13:10:17.230

使用 Eclipse 生成片段时，onCreateView 方法模板代码没有对 super.onCreateView 的调用。此外，WROX 出版的这本相当不错的书：Android 4 Application Development 在其示例生命周期代码中遗漏了它（它不会遗漏任何其他对 super 的调用）。

当然这两个来源都可能不正确，但是使用 Eclipse 模板而不添加 super.onCreateView 并没有给我带来问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-16T06:21:59.900

我正在输入大写字母“O”而不是小写字母“o”

表示： OnCreate 而不是 onCreate 方法。

这是一个愚蠢的错误，但需要记住:)

谢谢

# wcf-data-services - 具有可为空导航属性的 WCF 数据服务查询投影

> ID：14532184
> 
> 赞同：1
> 
> 时间：2013-01-25T23:54:35.607
> 
> 标签：wcf-data-services

我正在尝试针对 WCF 数据服务编写一个查询，该服务执行包含可空导航属性的投影（即基础数据模型中的 FK 列是可空的，因此关联为 0..1）。项目语言是 VB.NET，不是我选择的。查询的示例部分：

```
From t In DataServiceReference.Context.Transactions
Where t.ID = transactionID
Select
    CSM = t.WrittenByEmployee.Name, _
    t.CustomerFirstName 
```

当针对 WrittenByEmployee 为空的行执行此查询时，如预期的那样，我收到以下错误：

> 导航属性“WrittenByEmployee”返回的条目为空且无法初始化。您应该在访问此属性之前检查空值。

根据[此博客](http://blogs.msdn.com/b/marcelolr/archive/2010/05/10/wcf-data-service-projections-null-handling-and-expansion.aspx?Redirected=true)，可以在 C# 中使用三元 ?: 运算符进行条件空检查。然而，遗憾的是该项目是在 VB.NET 中，而不是 C#。我知道 VB 中的等价物是 If() 运算符，但它似乎没有按预期工作。如果我将上述查询更改为：

```
Select
    CSM = If(t.WrittenByEmployee IsNot Nothing, t.WrittenByEmployee.Name, String.Empty) 
```

我在运行时收到此错误：

> 不支持使用表达式 (t.WrittenBy Employee != null) 构造或初始化类型 (...) 的实例

我尝试反转测试但得到了类似的错误，只有 (t.WrittenByEmployee == null) 代替。

如何编写此查询以以 Data Services 将接受的方式检查 WrittenByEmployee 导航属性中的空值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T07:55:16.110

感谢一位同事指出，当导航属性为 null 时，链接的博客返回 null 而不是常量！

如果您将上述代码更改为在导航属性为 null 时返回 null/Nothing，则它在 C# 和 VB.NET 中有效！

```
Select
    CSM = If(t.WrittenByEmployee IsNot Nothing, t.WrittenByEmployee.Name, Nothing)
                                                                          ^^^^^^^ 
```

# awk - awk 能力削减能力

> ID：14532190
> 
> 赞同：0
> 
> 时间：2013-01-25T23:55:06.480
> 
> 标签：awk, grep, cut

我正在使用以下 ssh 命令来获取 id 列表。现在我想

1.  仅获取 id 列表中大于给定数字的 id；在这种情况下，我们说“231219”。我怎样才能将其纳入？

2.  我有一个本地文件“ids_ignore.txt”；我们放在这个列表中的任何id都应该被命令忽略..

可以 awk 或 cut 做上述吗？

```
ssh -p 29418 company.com gerrit query --commit-message --files --current-patch-set \
    status:open project:platform/code branch:master |
grep refs | cut -f4 -d'/' 
```

输出：-

```
231222
231221
231220
231219
230084
229092
228673
228635
227877
227759
226138
226118
225817
225815
225246
223554
223527
223452
223447
226137 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:58:57.477

```
... | awk '$1 > max' max=8888 | grep -v -F -f ids_ignore.txt 
```

或者，如果您想使用 awk 完成所有操作：

```
 ... | awk 'NR==FNR{ no[$1]++ } 
        NR!=FNR && $1 > max && ! no[$1]' max=NNN ids_ignore.txt - 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:56:13.957

`cut`不能对输入字段进行数值比较，它只是一个简单的字段提取工具。`awk`可以做grep和cut的工作：

```
ssh -p 29418 company.com gerrit ... |
awk -F/ -v min=231219 '
    NR == FNR {ignore[$1]; next} 
    /refs/ && $4>min && !($4 in ignore) {print $4}
' ids_ignore.txt - 
```

尾随`-`在 awk 命令的末尾很重要：它告诉 awk 在读取 ids_ignore 文件后从 stdin 读取。

# ajax - 和阿贾克斯

> ID：14532194
> 
> 赞同：1
> 
> 时间：2013-01-25T23:55:35.327
> 
> 标签：ajax, coldfusion, content-type, cfc

我在 CFC 文件上使用 Ajax。我无法从我从 Ajax 调用的函数中获得结果。我设置了调试消息 (Alert())，但看不到它。有什么建议吗？

```
function getDelegateChartAcct(LocFund){
   alert("#Arguments.PIUniversalID#");
   alert($F("DelegateFund"));                                                                                                                                                                                                                    

  new Ajax.Request( "?method=displayDelegateChartAcct",
            {
              parameters : {
                            PIUniversalID: "#Arguments.PIUniversalID#",
                            PILocFund: $F("DelegateFund")                                                                                
                            },
                            method : "post"
                             }
               );
     }

     <cffunction name="displayDelegateChartAcct" access="remote" output="true" 
      returntype="void">
          <CFArgument name="PIUniversalID" type="string" required="true" />
          <CFArgument name="LocFund" required="true" type="String" />

      <CFSET var chartacctlist = runChartAcctDelegationQuery 
                  (#Arguments.PIUniversalID#, #Arguments.LocFund#)>

        <CFContent type="text/x-javascript">               
          alert(“Hi”);     
          //      delegateChartAcctList();
          //      $("DelegateChartAcct").
           //     <CFOutput query="chartacctlist">           
            //     $("DelegateChartAcct").insert( new Element(
                    "option", { value : "#JSStringFormat( chart_acct )#", selected : 
            //        "selected" } ).update( "#JSStringFormat( chart_acct )#" ) );                                                        
            //                            </CFOutput>

            </cffunction> 
```

谢谢，克方

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T00:20:02.987

您没有从 CFC 返回任何内容（也不能在远程调用的函数中运行 JavaScript）。

你有两种方法可以处理这个问题：

1.  通过远程调用构建所需表单（或元素）的 .cfm 文件来加载所需的表单（或元素）。您可以使用*$("{place form will be displayed}").load("{url to .cfm page})*并且 jQuery 将发出 HTTP 请求并将结果加载到与选择器匹配的 DOM 元素中。

2.  更改您的 CFC 以返回查询并使用 JavsScript 填充客户端上的选择框。（这就是我会做的）

您的代码如下所示：

```
<cffunction name="displayDelegateChartAcct" access="remote" output="true" returntype="query">
      <cfargument name="PIUniversalID" type="string" required="true" />
      <cafrgument name="LocFund" required="true" type="String" />

  <cfset var chartacctlist = runChartAcctDelegationQuery (#Arguments.PIUniversalID#, #Arguments.LocFund#)>
    <cfreturn chartacctlist />
</cfcomponent> 
```

然后，您可以使用以下内容加载该数据（根据语法看起来像 Prototype）：

```
new Ajax.Request( "?method=displayDelegateChartAcct&returnFormat=json",
    {
        parameters : {
            PIUniversalID: "#Arguments.PIUniversalID#",
            PILocFund: $F("DelegateFund")                                                                                
        },
        method : "post",
        onSuccess: function(response) {
                // code in here will populate select
        }
     }
 ); 
```

'returnFormat=json' 告诉 ColdFusion 以 JSON 格式返回结果。

您只需要一个 JS 处理程序来获取该数据并使用它来填充 SELECT 框。

# html - 我的 HTML 生锈了，但我很确定出了点问题

> ID：14532199
> 
> 赞同：-1
> 
> 时间：2013-01-25T23:56:40.880
> 
> 标签：html, margin

因此，在离开 HTML 一个月后，我一直过得很艰难，没什么，但是我似乎失去了一些技巧，这让我的 div/任何 html 元素距离顶部不只有几个像素一个页面，即使有一个固定的 div，它仍然距离我页面的顶部和左侧大约 8 个像素，我不知道发生了什么。没有填充，没有边距，没有这样的东西，我完全不明白为什么会这样。

```
<html>
    <head>
        <title>
            CrystalBallStories
        </title>
        <link rel=stylesheet link="stylesheet" href="style.css" media="screen">
    </head>
    <body>
        <div id="main">
            <nav id="nav">
                <div class="nav_opt">
                    Home
                </div>
            </nav>
        </div>
    </body>
</html> 
```

是 HTML 和 CSS 是：

```
html
{
font-family:Corbel, 'Lucida Grande', Helvetica, sans-serif;
background: rgb(69,72,77); /* Old browsers */
background: -moz-linear-gradient(top,  rgba(69,72,77,1) 0%, rgba(0,0,0,1) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(69,72,77,1)), color-stop(100%,rgba(0,0,0,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%); /* IE10+ */
background: linear-gradient(to bottom,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#45484d', endColorstr='#000000',GradientType=0 ); /* IE6-9 */
}

::-webkit-scrollbar {
width: 12px;
}

::-webkit-scrollbar-track {
-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); 
border-radius: 10px;
}

::-webkit-scrollbar-thumb {
border-radius: 10px;
-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); 
}

#main
{ 
background-color:#000000;
position:fixed;
height:98%;
width:80%;
color:#DDDDDD;
overflow-y:scroll;
text-wrap:break-word;
margin-left:10%;
margin-right:10%;
border-top-left-radius:30px;
border-top-right-radius:10px;
}

#nav
{
background-color:rgba(69,72,77,0.8);
height:8%;

} 
```

这曾经对我有用，但由于某种原因，正如我之前所说，它离顶部和左边有点远，可以在网站上看到：[http ://www.crystallballstories.com](http://www.crystallballstories.com)

感谢任何帮助，因为这让我发疯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:58:15.603

```
html,body{margin:0} 
```

问题解决了。

# jquery - jQuery 古怪 - 影响类选择器可操作性的代码

> ID：14532201
> 
> 赞同：0
> 
> 时间：2013-01-25T23:56:47.240
> 
> 标签：jquery, jquery-ui

我想从一系列href中获取id ...我得到了我正在寻找的答案-但是它们在我现有代码的上下文中不起作用-

下面有两个功能-“删除确认”和“编辑对话框调用”都可以在 jsFiddle [http://jsfiddle.net/RK4Ye/](http://jsfiddle.net/RK4Ye/)中工作-但是我的链接是通过 jQuery 生成的（不是硬编码的），当我按原样运行页面时，这两个功能停止工作......我不知道原因是什么......但我已经删除了所有其他 js，这些都不起作用......其他信息 - 页面运行为jQueryUI 选项卡中的一个选项卡...

帮助PLZ ..我什至不知道如何找到问题，所有代码在添加这两个功能之前都可以工作......并且没有抛出错误......

问题：是编辑链接和删除链接都带你到href，类选择器没有捕获点击事件并停止请求......（我意识到ajax调用将无法完全复制行为- 但相信我的话它正在返回并正常运行 - 但我会包含一个 JSON 数据包以防万一）

```
$( function() {

function loadTable() {
    $.ajax({
        type: 'POST',   
        url: 'list.php',    
        dataType: 'json',   
        success: function ( data ) {                
            var items = [];
            var line = 1;

            // clear the table
            $( '#companies-list' ).html( '' );

            // the real data
            $.each( data.companies, function ( key, value ) {   
                var thisRowClass = 'odd';
                if ( line % 2 ) {
                    thisRowClass = 'even';
                }
                items.push( '<tr class="' + thisRowClass + '"><td nowrap>'  + value.company + 
                            '</td><td>' + value.address + 
                            '</td><td>' + value.city + 
                            '</td><td>' + value.state + 
                            '</td><td>' + value.zip + 
                            '</td><td nowrap>' + value.phone + 
                            '</td><td>' + value.contact + 
                            '</td><td>' + value.email + 
                            '</td><td>' + value.jobscurrent + 
                            '</td><td>' + value.jobsdone + 
                            '</td><td nowrap> <a href="m/company.php"  data-identity="' + value.id + '" class="uLink">edit</a> |  <a href="m/company.php?d=' + value.id + '" class="dLink">delete</a> ' +
                            '</td></tr>' ); 
                line++ ;
            }); 

            $( '#companies-list' ).append( items.join( '' ) );                                 

        },

        error: function () {    
            // there's an error
            $( '#message' ).html( '<p>There was a problem on the server... </p>' ); 
        }
    });
}

// pre load my list when page loads
loadTable();

// DELETE CONFIRM
$( '.dLink' ).click( function( event ) {
    var response = confirm( 'Are you sure you want to delete this item?' );
    //the following is the tertiary version of: if (response) { return true; } else { return false; }
    return( response ) ? true : false;
});

// EDIT DIALOG CALL     
$( '.uLink' ).click( function() {
    var id = $( this ).data( 'identity' );
    alert( id );

    return false;
});

}); 
```

HTML 看起来像这样

```
<div id="companies-container" class="ui-widget">
<h3>List of Companies</h3>
<table id="companies" class="ui-widget ui-widget-content list"> 
<thead>
    <tr class="ui-widget-header ">
        <th>Company</th>
        <th>Address</th>
        <th>City</th>       
        <th>State</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>Contact</th>
        <th>Email</th>      
        <th>Jobs Current</th>
        <th>Jobs Done</th>
        <th>&nbsp;</th>
    </tr>
</thead>

<tbody id="companies-list"> 
</tbody>

<tfoot> 
</tfoot>
</table>
</div> 
```

示例 JSON 数据包：

```
{ "count": "3", "companies": [{ "id":"2", "company":"Main Customer A", "address":"1234 street ", "city":"Gallatin", "state":"TN", "zip":"30766", "phone":"", "contact":"", "email":"", "jobscurrent":"", "jobsdone":"" },{ "id":"3", "company":"Sub Customer B", "address":"232 road ", "city":"Galatan ", "state":"TN", "zip":"60766", "phone":"", "contact":"", "email":"", "jobscurrent":"", "jobsdone":"" },{ "id":"4", "company":"Sub Customer C", "address":"333 pkwy ", "city":"Nashville", "state":"TN", "zip":"37204", "phone":"", "contact":"", "email":"", "jobscurrent":"", "jobsdone":"" } ] } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:08:25.123

您需要委托点击处理程序使用`on()`来说明代码运行后添加到 DOM 的元素。

假设桌子是永久资产，我们可以委托给桌子：

```
$('#companies').on('click', '.dLink' , function( event ) {
    var response = confirm( 'Are you sure you want to delete this item?' );
    //the following is the tertiary version of: if (response) { return true; } else { return false; }
    return( response ) ? true : false;
}); 
```

API 参考：[http ://api.jquery.com/on](http://api.jquery.com/on)

# grails - UrlMappings 不为同一控制器上的不同 URL 返回 405

> ID：14532205
> 
> 赞同：0
> 
> 时间：2013-01-25T23:56:55.687
> 
> 标签：grails, url-mapping

我写了一个 REST 控制器，我想允许在控制器上删除 /rest/id，但不允许 /rest/。这是我的 UrlMappings：

```
"/rest"(controller: "restController", parseRequest: true) {
  action = [GET: "list", POST: "save"]
}

"/rest/$id"(controller: "restController", parseRequest: true) {
  action = [GET: "show", PUT: "update", DELETE: "delete"]
} 
```

当我的 DELETE 请求命中 /rest 时，我希望得到“方法不允许”/405，但我得到一个 404。我想也许请求被转换为 /rest/0，但它没有达到我放入的断点控制器的删除方法。

知道为什么它会以这种方式工作，或者我可以考虑解决问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T02:50:22.937

我认为这有点模棱两可，因为 grails 从控制器的 allowedMethods 闭包中获取了 405。

由于 rest/ 没有到 DELETE 的映射，因此框架返回 404，这似乎是正确的。

该文档似乎希望您执行类似的操作

```
delete(Long id) {
  if(!id){
    response.sendError 405
  } else {
    ...
  }
} 
```

[http://grails.org/doc/latest/ref/Controllers/allowedMethods.html](http://grails.org/doc/latest/ref/Controllers/allowedMethods.html)

如果您认为这种行为不正确，可能值得提出 JIRA。从 grails-core 中的测试来看，它似乎根本没有处理 405s。

# android - android交互式谷歌街景API

> ID：14532208
> 
> 赞同：1
> 
> 时间：2013-01-25T23:57:15.950
> 
> 标签：android, google-street-view

是否有交互式谷歌街景 API？

我想为用户提供交互式街景体验（无论是否使用谷歌），基于传递坐标来获取图像是什么

我已经看到了静态街景 api，感谢您的洞察力

# html - 如何在用作背景图像的外部 SVG 文件中设置路径元素的样式？

> ID：14532213
> 
> 赞同：2
> 
> 时间：2013-01-25T23:57:41.510
> 
> 标签：html, css, svg

我有一个`div`在我的 CSS 中分配的背景图像。它是一个 svg 文件。有没有可能我可以访问路径来改变它们的颜色，即使它是背景图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T10:14:01.057

您可以添加一个

```
<?xml-stylesheet type="text/css" href="svg-stylesheet.css" ?> 
```

SVG 文件顶部的说明，然后在样式表中定义样式。

请参阅[http://www.w3.org/TR/SVG/styling.html#ReferencingExternalStyleSheets](http://www.w3.org/TR/SVG/styling.html#ReferencingExternalStyleSheets)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:07:26.790

我不知道您可以通过任何方式访问外部链接的 svg 文件的路径（例如在`img`或`object`标签中），但是如果您将 svg xml 直接包含在您的页面中，您可以访问这些路径，因此您可以使用相同的宽度、高度和 x、y 位置，在前景 div 下方给它一个 z-index 并将 svg xml 放在背景 div 的一侧，您可以模拟您正在尝试做的事情。

这是一个 jsfiddle，展示了如何使用 JQuery 通过获取 ajax 请求加载 svg 图像，更改路径样式，然后将修改后的 svg xml 嵌入到背景 div 中：

[http://jsfiddle.net/webchemist/j2Dgq/](http://jsfiddle.net/webchemist/j2Dgq/)

**编辑**

jsfiddle 更新为在 IE9 中工作，问题是对 wikimedia 的跨站点 ajax 请求而不是内联 svg ...

# compilation - 重新编译会影响正在运行的程序吗？

> ID：14532217
> 
> 赞同：0
> 
> 时间：2013-01-25T23:58:22.887
> 
> 标签：compilation, python-c-extension

如果我在程序仍在运行时重新编译，程序是否仍会像重新编译前一样执行？

我只是从[运行时重新编译可执行文件是否安全？](https://stackoverflow.com/questions/3356483/is-it-safe-to-recompile-an-executable-while-its-running)，但我有一个更复杂的情况：

我正在开发一个带有 C 扩展名的 python 包；

我可以只重新编译该 C 扩展中的共享对象；

我将不得不通过“qsub”将其提交到队列中......

谢谢！

# php - PHP Crypt加密/解密不返回相同的哈希标签

> ID：14532220
> 
> 赞同：0
> 
> 时间：2013-01-25T23:58:31.643
> 
> 标签：php, crypt

注册表单 - 密码是 123456：

```
$pwd = $_POST['pwd'];
$salt = '$2a$10$R.Baj0mvj5doNvtvzDjwP5$';
$password = crypt("$pwd", $salt); 
```

数据库中的哈希：

$2a$10$R.Baj0mvj5doNvtvzDjwPuN/W8Z3n6RVGyM0pM

用户登录时的哈希比较 - 再次输入密码，123456：

```
$salt = '$2a$10$R.Baj0mvj5doNvtvzDjwP5$';
$crypt_pass=crypt($password,$salt); 
```

$crypt_pass = $2a$10$R.Baj0mvj5doNvtvzDjwPuN/W8Z3n6RVGyM0pMQB89k2m9nYRIN6O 数据库中的密码哈希为：$2a$10$R.Baj0mvj5doNvtvzDjwPuN/W8Z3n6RVGyM0pM

当我用相同的盐对它们进行哈希处理时，为什么它们不匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:02:30.417

您使用 Blowfish 作为哈希类型。这将始终为相同的字符串和盐返回不同的值。如果您希望您的哈希值匹配，请使用 SHA 512。

```
$salt = '$6$rounds=5000$usesomesillystringforsalt$'; 
```

# javascript - Jquery Mobile 使脚本执行两次

> ID：14532221
> 
> 赞同：4
> 
> 时间：2013-01-25T23:58:34.887
> 
> 标签：javascript, jquery, html, jquery-mobile

为什么该`test`消息在以下位置显示两次：

```
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>
<body>
    <script type="text/javascript">
        alert("Test");
    </script>
</body>
</html> 
```

我从[http://jquerymobile.com/demos/1.2.0/docs/about/getting-started.html](http://jquerymobile.com/demos/1.2.0/docs/about/getting-started.html)复制了标题 ，当我开始做一些示例时，我注意到我的 javascript 方法被调用了两次。

这是 JsFiddle 中的代码：

[http://jsfiddle.net/LsxBW/2/](http://jsfiddle.net/LsxBW/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:26:42.817

正如 Explosion Pills 所说**，您必须遵守 jQM 规则**。至少：

*   对一个或多个页面使用适当的[jQM 标记](http://jquerymobile.com/test/docs/pages/page-anatomy.html)

```
<div data-role="page" id="page1">
    <div data-role="header">
        <h1>Page Title</h1>
    </div><!-- /header -->
    <div data-role="content">    
        <p>Page content goes here.</p>        
    </div><!-- /content -->
    <div data-role="footer">
        <h4>Page Footer</h4>
    </div><!-- /footer -->
</div><!-- /page --> 
```

*   [使用`pageinit`事件而不是 jQuery 就绪处理程序](http://jquerymobile.com/test/docs/api/events.html)。
    所以而不是

```
$(function() {   
    alert("Test");
}); 
```

采用

```
$(document).on("pageinit", "#page1", function(){
    alert("Test");
}); 
```

[jsFiddle 在这里](http://jsfiddle.net/pmatseykanets/YrRgp/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:58:22.140

您可以使用

```
$(function() {   
    alert("Test");
}); 
```

.. 很好，只要你用 data-role="page" 把它放在 div 之外。页面标记内不允许有脚本标记。

# applescript - 用于创建子文件夹和移动文件的 Applescript，带有部分名称

> ID：14532227
> 
> 赞同：0
> 
> 时间：2013-01-25T23:59:08.123
> 
> 标签：applescript, filenames, move, finder

我一直在寻找这样的脚本，但我找不到它。我怀疑它与[此相似](https://stackoverflow.com/questions/14527505/applescript-create-folders-subfolders-and-move-multiple-files)

但不完全是，我不确定如何修改它以适合我。

我有一组具有多个名称的文件，例如......

> 文件名 Vyear #01（年）.ext
> 
> 文件名 Vyear #01（年份）.ext

依此类推，约定总是相同的。

文件名（有时是多个单词）后跟 V 表示版本，然后是括号中的年份，然后是数字，然后是括号中的另一个年份。这很复杂，但这一切都是有原因的。我正在寻找的是一种仅基于该名称的第一部分自动将所有这些文件移动到子文件夹中的方法。所以像这样的文件...

> 迷雾 V2000 #01 (2011).zip

将被移动到名为 this 的文件夹中。

> 迷雾V2000

我经常不得不制作这样的文件，我很乐意将它们分类到子文件夹中。我的问题是我不确定如何仅选择名称中的第一个（标题中有两个或三个单词的文件的帐户）和卷号仅用于创建子文件夹，然后匹配移动的文件名.

我希望我能正确解释这一点。如果有人可以提供帮助，我将不胜感激。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T09:34:37.223

尝试这个。基本上，如果我们知道“#”字符在文件名中的位置，我们就可以计算文件夹名称。然后我们可以得到所有文本到那里 - 2个字符。然后你只需要创建那个文件夹并将文件移动到其中。简单的。祝你好运。

```
set sourceFolder to choose folder

tell application "Finder"
    set theFiles to files of sourceFolder

    repeat with aFile in theFiles
        set fileName to name of aFile

        if fileName contains "#" then
            set poundOffset to offset of "#" in fileName
            set folderName to text 1 thru (poundOffset - 2) of fileName

            set newFolder to (sourceFolder as text) & folderName & ":"
            if not (exists folder newFolder) then
                make new folder at sourceFolder with properties {name:folderName}
            end if

            move aFile to folder newFolder
        end if
    end repeat
end tell 
```

# hadoop - 坐在 Cassandra 上的数据分析和挖掘

> ID：14532230
> 
> 赞同：14
> 
> 时间：2013-01-25T23:59:37.660
> 
> 标签：hadoop, mapreduce, cassandra, analytics

我们有大量来自存储在 Cassandra 中的各种网站的用户交互数据，例如 cookie、页面访问、广告查看、广告点击等，我们希望对其进行报告。我们当前的 Cassandra 架构支持基本的报告和查询。但是，我们也希望构建大型查询，这些查询通常涉及大型列族（包含数百万行）上的联接。

什么方法最适合这个？一种可能性是将数据提取到关系数据库（如 mySQL）并在那里进行数据挖掘。替代方法可能是尝试使用带有 hive 或 pig 的 hadoop 来为此目的运行 map reduce 查询？我必须承认我对后者的经验为零。

任何人都经历过一种与另一种的性能差异？您是否会在实时 Cassandra 生产实例或备份副本上运行 map reduce 查询以防止查询负载影响写入性能？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-26T01:07:28.710

根据我的经验，Cassandra 更适合需要实时访问数据、快速随机读取以及通常只处理大流量负载的流程。但是，如果您开始进行复杂的分析，您的 Cassandra 集群的可用性可能会受到显着影响。一般来说，从我所看到的情况来看，让 Cassandra 集群保持独立符合您的最大利益，否则可用性开始受到影响。

听起来您需要一个分析平台，我肯定会建议将您的报告数据从 Cassandra 导出，以便在离线数据仓库系统中使用。

如果您负担得起，拥有一个真正的数据仓库将允许您在多个表上使用复杂的连接执行复杂的查询。这些数据仓库系统被广泛用于报告，以下是我认为主要参与者的列表：

*   内特扎
*   紫苑/TeraData
*   垂直

最近获得很大动力的是[Amazon Redshift](http://aws.amazon.com/redshift/)，但它目前处于测试阶段，但如果你能得到它，你可以尝试一下，因为它看起来像一个可靠的分析平台，价格更具吸引力比上述解决方案。

使用 Hadoop MapReduce/Hive/Pig 等替代方案也很有趣，但可能无法替代 Hadoop 技术。如果你有 SQL 背景，我会推荐 Hive，因为它很容易理解你在做什么，而且你可以轻松扩展。实际上已经有与 Hadoop 集成的库，例如[Apache Mahout](http://mahout.apache.org/)，它允许您在 Hadoop 集群上进行数据挖掘，您绝对应该尝试一下，看看它是否符合您的需求。

为了给你一个想法，我使用的一种到目前为止运行良好的方法是在 Hive 中预先聚合结果，然后在 Netezza 等数据仓库中生成报告本身来计算复杂的连接。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-28T05:09:28.720

披露：我是 DataStax 的工程师。

除了 Charles 的建议之外，您可能还想了解[DataStax Enterprise](http://www.datastax.com/products/enterprise) (DSE)，它提供了 Cassandra 与 Hadoop、Hive、Pig 和 Mahout 的良好集成。

正如 Charles 所提到的，您不希望直接针对处理实时应用程序需求的 Cassandra 节点运行分析，因为它们会对性能产生重大影响。为避免这种情况，DSE 允许您通过使用多个虚拟“数据中心”（在 NetworkToplogyStrategy 术语的意义上）将集群的一部分严格用于分析。作为 Hadoop 作业的一部分执行的查询只会影响这些节点，基本上不会影响您的普通 Cassandra 节点。此外，您可以根据性能需求分别向上或向下扩展集群的每个部分。

DSE 方法有几个好处。首先是您不需要在处理数据之前执行任何 ETL；Cassandra 的正常复制机制使专门用于分析的节点保持最新。其次，您不需要外部 Hadoop 集群。DSE 包括一个名为 CFS (CassandraFS) 的 HDFS 的直接替代品，因此 Hadoop 作业的所有源数据、中间结果和最终结果都可以存储在 Cassandra 集群中。

# ruby-on-rails - Rails：从控制器内部获取真实性令牌

> ID：14532232
> 
> 赞同：0
> 
> 时间：2013-01-25T23:59:50.063
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我需要从前一个控制器内部对另一个控制器进行 POST，如何从控制器内部获取authentity_token 的值？

泰，弗雷德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T06:00:19.720

`authenticity_token`你可以通过`params[:authenticity_token]`

尽管我不确定您的用例（从另一个用例调用控制器）是一个不错的选择。

# java - 为什么我不能将值传递给这些变量

> ID：14532242
> 
> 赞同：-2
> 
> 时间：2013-01-26T00:00:44.223
> 
> 标签：java, eclipse, variables, scope

我正在使用 eclipse 构建一个 Android Twitter 应用程序我试图将值传递给变量 itemOfClothing、clothingEmotion 和“用户”，但 eclipse 甚至不允许我启动具有相同名称的变量，更不用说将值传递给它们了。

我收到以下错误：

```
Duplicate field TwitterApp.itemOfClothing   
Duplicate field TwitterApp.clothingEmotion  
Duplicate field TwitterApp.user 
Syntax error on token ";", { expected after this token  
Syntax error, insert "}" to complete Block 
```

有人可以帮忙吗？

```
String itemOfClothing; //Item of clothing sending the message
String clothingEmotion; //Message of clothing
String user; //This comes from twitter sign in process 
```

//将传递给变量的示例！

```
itemOfClothing = "pants";
clothingEmotion = "I'm feeling left in the dark";
user = "stuart"; 
```

试图将值传递给`itemOfClothing`,`clothingEmotion`和“用户”，但它不会让我。我知道这很愚蠢，但我不知道为什么。有人可以给我一个答案吗？

```
public static String MESSAGE = itemOfClothing +": " + clothingEmotion + "! #" + user + "EmotionalClothing"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:07:46.760

静态变量只能引用其他静态变量。

```
private static String itemOfClothing; //Item of clothing sending the message
private static String clothingEmotion; //Message of clothing
private static String user; //This comes from twitter sign in process 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T00:07:31.797

```
public static String MESSAGE = itemOfClothing +": " + clothingEmotion + "! #" + user + "EmotionalClothing"; 
```

这是因为

`temOfClothing`,`clothingEmotion`并且`user` 是非**静态变量**，您正在尝试将其分配给 a `static variable MESSAGE`，因此您的编译器会抱怨

> 无法对非静态字段用户进行静态引用

使它们成为静态变量，您的代码就可以工作。

```
static String itemOfClothing = "pants";
    static String clothingEmotion = "I'm feeling left in the dark";
    static String user = "stuart";

    private static final String TWITTER_ACCESS_TOKEN_URL = "http://api.twitter.com/oauth/access_token";
    private static final String TWITTER_AUTHORZE_URL = "https://api.twitter.com/oauth/authorize";
    private static final String TWITTER_REQUEST_URL = "https://api.twitter.com/oauth/request_token";

    public static String MESSAGE = itemOfClothing +": " + clothingEmotion + "! #" + user + "EmotionalClothing"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T00:10:12.653

您已将这些变量声明为成员变量，但您正在尝试`static`使用静态初始化程序分配一个字符串变量。

静态初始化器只能访问静态变量或文字值。

您可以做的是将变量声明为静态：

```
static String itemOfClothing = "pants";
static String clothingEmotion = "I'm feeling left in the dark";
static String user = "stuart"; 
```

请注意，如果您不对这些变量使用静态初始化程序，它们将没有值。但是，如果要将这些值设置为程序逻辑的一部分，则要么将字符串声明为 NOT 为静态字符串，要么使用语句来分配不是“初始化程序”（声明的一部分）的值。

任何一个：

```
public String MESSAGE = itemOfClothing +": " + clothingEmotion + "! #" + user + "EmotionalClothing"; 
```

或者：

```
public static String MESSAGE;

//on another line as part of a program, after the variables get values
MESSAGE = itemOfClothing +": " + clothingEmotion + "! #" + user + "EmotionalClothing"; 
```

# java - Spring Rest：处理在域层识别的客户端输入错误

> ID：14532246
> 
> 赞同：1
> 
> 时间：2013-01-26T00:00:51.167
> 
> 标签：java, validation, spring-mvc, exception-handling

我有一个用于帐户的 REST 服务。控制器调用服务层来查找帐户。AccountService 可以抛出域异常。这通常是与客户端输入错误有关的情况。在这种情况下，我想用ClientException包装域异常。有没有办法可以向客户端显示状态代码 400 和异常消息？或者有没有更好的处理服务层检测到非法参数的情况？

```
@Controller
class AccountController
    @ResponseBody
    @RequestMapping("/accounts/${accountId}")
    public Account account(@PathVariable int accountId, HttpServletResponse response){
        try{
            return accountService.find("Account not found with id: " + accountId);
        }catch(Exception e){
            response.setStatus(400);
            throw new ClientException(e);
        }   
    }
}

class AccountService{
    public Account find(int accountId){
        if(acountId > 100){
            throw new AccountNotFoundException(accountId);
        }else{
            return new Account(accountId, "someone");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:21:02.553

如果这是一个 REST 服务，那么只需设置响应状态和 JSON 正文（带有错误消息）就足够了。没有必要抛出那个 ClientException。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T09:41:18.247

您可以创建一个异常处理程序，该处理程序接受异常并将其编组到 JSON 响应对象中。

我前段时间做过，效果很好，但是我知道不再有源代码可以分享。.

以 Spring MVC 的异常处理程序为起点。

# c++ - 如何检测输入是否从文件重定向？

> ID：14532247
> 
> 赞同：0
> 
> 时间：2013-01-26T00:01:00.777
> 
> 标签：c++, redirect, input

我编写了一个程序，它接受它的第一个参数并反转字母。因此，例如：

```
revstr cat 
```

会产生`tac`。

现在我希望当文件被重定向时它可以工作。所以，如果*filler.txt*是一个包含“现在是所有好人来帮助他们的国家的时候了！”的文件，那么：

```
revstr < filler.txt 
```

应该产生：

```
!yrtnuoc rieht fo dia eht ot emoc ot nem doog lla rof emit eht si woN 
```

但我不知道如何检测这种重定向正在发生！

这是我尝试过的 - 显然，这不好。我哪里错了？

```
int main(int argc, char* argv[]) {
string temp,input,output;//store input from file, and get which file//

ofstream out("output.txt");

if(argc == 3)
{
    if(ifstream(argv[2]))
    {
        input = argv[2];
        ifstream in(input);
        while(in.good())
        {
            in >> temp;
            ReverseWord(temp);
            cout << temp << endl;
            out << temp << endl;
        }
    }
    else
        ReverseWord(argv[2]);

    }
    else
} 
```

我对 C++ 还很陌生，并且正在尽我最大的努力学习。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T00:23:08.330

您有两种可能的方法（好吧，您甚至可以同时支持这两种方法）：

1.  您可以接受文件名作为命令行参数（使用接受参数的 main），然后使用该文件名作为要读取的流打开一个 ifstream。用户像使用你的程序一样`revstr filename.txt`。
2.  您可以从 std::cin 读取您的输入。然后用户需要使用重定向向您传递文件的内容。如果您的程序是使用: 启动的`revstr < filename.txt`，那么从 std::cin 读取将读取文件的**内容**。该程序甚至从未看到文件名。

如果你得到一个论点，你可以通过从 ifstream 中读取来支持这两者，如果你没有得到论点，你可以从 cin 中读取。读取的函数可以获取作为通用 istream& 传入的蒸汽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:11:45.557

您应该更改`main()`函数的定义，以便它接受从命令行传递的参数：

```
int main(int argc, char* argv[]) 
```

第一个变量将保存提供的命令行参数的数量，第二个变量是一个向量，其元素是指向以 NULL 结尾的字符串的指针。这些字符串本身就是命令行参数。请记住，第一个字符串将始终是可执行文件的名称。

例如，假设要打开的文件的名称将作为第一个参数传递：

```
int main(int argc, char* argv[])
{
    std::string filename;
    if (argc > 1)
    {
        // Oh, there's some command line arguments here...
        filename = argv[0];
    }

    // Go on processing...
} 
```

# listview - 带有 2 行布局的 ListView 的 AsyncTask

> ID：14532248
> 
> 赞同：-1
> 
> 时间：2013-01-26T00:01:06.670
> 
> 标签：listview, android-asynctask, android-listfragment

我有一个包含 2 种不同行类型的列表视图（就像在这个问题中一样）。它工作正常，但滚动时非常滞后。所以我读到解决这个问题的方法是使用 AsyncTask。当使用两种不同的行类型时，我该如何实现？

我尝试使用两个不同的 AsyncTasks（膨胀 doInBackground 中的行），但我得到了各种各样的错误：

在 getView() 中：

```
if (convertView == null) {

            switch (type) {
            case TYPE_DAY:

                new ForecastDayTask(position, forecastHolder, convertView,
                        forecastHolder, mInflater, forecastdata).execute();

                break;
            case TYPE_DATA:
                new ForecastTask(position, forecastHolder, convertView,
                        forecastHolder, mInflater, forecastdata).execute();
                break;
            } 
```

我也尝试过使用相同的 AsyncTask 类并传递相同的数据和 TYPE_DAY/TYPE_DATA 但这非常复杂，我得到了 NullPointerExceptions。

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T08:15:28.587

我这样解决了：

*   我扩展了一个 BaseAdapter，其中包含所有可能的 ListItems 的列表。
*   getView 使用 ViewHolderPattern 来回收视图
*   View 的宽度取决于 HolderItem 。在需要的时间（它是一个水平列表，显示不同持续时间的广播）
*   GetView 启动一个 AsyncTask，它需要两个 Holder，ViewHolder 和 DataHolder
*   需要 AsyncTask 来启动 onPostExecute 一个执行 GUIStuff、DrawRunnable 的线程
*   在 DrawRunnable 中，我决定如何为背景着色，以及应该根据广播的持续时间向用户呈现什么

我喜欢根据类型启动两个不同任务的方式。在我的情况下，这将是不同的持续时间类型。所以我应该在 onPostExecute 创建 DrawBroadcastRunnable 时决定哪个 DrawXTypeRunnable 应该开始。我用 if(XTYPE) 标记了代码中的位置

```
@Override
public View getView(final int position, View convertView, ViewGroup parent) {

    ViewBroadcastItemHolder viewItemHolder;
    if (convertView == null) {
        convertView = (RelativeLayout) layoutInflater.inflate(layoutId,
                parent, false);
        viewItemHolder = new ViewBroadcastItemHolder();
        viewItemHolder.logo = (ImageView) convertView
                .findViewById(R.id.broadcast_guide_image);
        viewItemHolder.time = (TextView) convertView
                .findViewById(R.id.broadcast_guide_time);
        viewItemHolder.title = (TextView) convertView
                .findViewById(R.id.broadcast_guide_title);
        viewItemHolder.divider = convertView
                .findViewById(R.id.broadcast_guide_divider);
        viewItemHolder.layout = (LinearLayout) convertView
                .findViewById(R.id.broadcast_guide_item_linear_layout);
        convertView.setTag(viewItemHolder);
    } else {
        viewItemHolder = (ViewBroadcastItemHolder) convertView.getTag();
        convertView.setVisibility(View.GONE);
    }
    BroadcastHolder broadcastItem = getItem(position);
    viewItemHolder.layout.getLayoutParams().width = broadcastItem.width;

    BroadcastHolderAsyncArgument holder = new BroadcastHolderAsyncArgument(
            convertView, viewItemHolder, broadcastItem, position);

    holder.bcViewHolder.logo
            .setImageBitmap(controller.getLogoPlaceholder());
    BroadcastHolderAsyncArgument[] argument = { holder };
    new AsyncTask<BroadcastHolderAsyncArgument, Void, BroadcastHolderAsyncArgument>() {

        @Override
        protected BroadcastHolderAsyncArgument doInBackground(
                BroadcastHolderAsyncArgument... bcHolderArg) {
            return bcHolderArg[0];
        }

        @Override
        protected void onPostExecute(
                BroadcastHolderAsyncArgument bcHolderArg) {
  // Where to put in the decision which Strategy has to get done
  //if(XTYPE){ new DrawBroadcast30ViewRunnable(..).run()}
        //else if(YTYPE){new DrawBroadcast200ViewRunnable(..).run()}
        //else if(ZTYPE){new DrawBroadcast10ViewRunnable(..).run()}
        //else{new DrawBroadcast5ViewRunnable(..).run()}

            new DrawBroadcastViewRunnable(bcHolderArg, position).run();
        }
    }.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, argument);

    return convertView;
}

public class DrawBroadcastViewRunnable implements Runnable {

    private BroadcastHolderAsyncArgument bcAsyncArgumentHolder;
    private int position;

    public DrawBroadcastViewRunnable(
            BroadcastHolderAsyncArgument bcHolderArgument, int position) {
        super();
        this.bcAsyncArgumentHolder = bcHolderArgument;
        this.position = position;
    }

    public void run() {

        if (bcAsyncArgumentHolder.position == position) {

            // Set Background Color of CatchUp, Live and Upcomming
            if (Helper.isLiveBroadcast(
                    bcAsyncArgumentHolder.bcItemHolder.start,
                    bcAsyncArgumentHolder.bcItemHolder.stop)) {
                bcAsyncArgumentHolder.bcViewHolder.isCatchup = false;
                bcAsyncArgumentHolder.convertView
                        .setBackgroundColor(context.getResources()
                                .getColor(R.color.guide_live_broadcast));
            } else if (bcAsyncArgumentHolder.bcViewHolder.isCatchup = Helper
                    .isCatchupBroadcast(
                            bcAsyncArgumentHolder.bcItemHolder.start,
                            bcAsyncArgumentHolder.bcItemHolder.stop)) {
                bcAsyncArgumentHolder.convertView
                        .setBackgroundColor(context.getResources()
                                .getColor(R.color.guide_replay_broadcast));
            } else {
                // Upcoming Broadcast
                bcAsyncArgumentHolder.convertView
                        .setBackgroundColor(context.getResources()
                                .getColor(R.color.guide_upcoming_broadcast));
                bcAsyncArgumentHolder.bcViewHolder.isCatchup = false;
            }

            // very large layout, more than 30min
            if (bcAsyncArgumentHolder.bcItemHolder.width >= 20 * controller
                    .getPixelPerMinute()) {
                bcAsyncArgumentHolder.bcViewHolder.logo
                        .setVisibility(View.VISIBLE);
                ImageLoader.getInstance().displayImage(
                        bcAsyncArgumentHolder.bcItemHolder.imageUrl,
                        bcAsyncArgumentHolder.bcViewHolder.logo);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setVisibility(View.VISIBLE);
                bcAsyncArgumentHolder.bcViewHolder.time
                        .setVisibility(View.VISIBLE);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setText(bcAsyncArgumentHolder.bcItemHolder.title);
                bcAsyncArgumentHolder.bcViewHolder.time.setText(Helper
                        .formatBroadcastTime(
                                bcAsyncArgumentHolder.bcItemHolder.start,
                                bcAsyncArgumentHolder.bcItemHolder.stop));
            }
            // medium layout, between 20 to 15min
            if (bcAsyncArgumentHolder.bcItemHolder.width < 20 * controller
                    .getPixelPerMinute()
                    && bcAsyncArgumentHolder.bcItemHolder.width > 15 * controller
                            .getPixelPerMinute()) {
                ImageLoader.getInstance().displayImage(
                        bcAsyncArgumentHolder.bcItemHolder.imageUrl,
                        bcAsyncArgumentHolder.bcViewHolder.logo);
                bcAsyncArgumentHolder.bcViewHolder.logo
                        .setVisibility(View.VISIBLE);
                bcAsyncArgumentHolder.bcViewHolder.time
                        .setVisibility(View.VISIBLE);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setVisibility(View.VISIBLE);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setText(bcAsyncArgumentHolder.bcItemHolder.title);
                bcAsyncArgumentHolder.bcViewHolder.time.setText(Helper
                        .formatBroadcastTime(
                                bcAsyncArgumentHolder.bcItemHolder.start,
                                bcAsyncArgumentHolder.bcItemHolder.stop));
            }

            // medium layout, between 15 to 5min
            if (bcAsyncArgumentHolder.bcItemHolder.width <= 15 * controller
                    .getPixelPerMinute()
                    && bcAsyncArgumentHolder.bcItemHolder.width > 5 * controller
                            .getPixelPerMinute()) {
                bcAsyncArgumentHolder.bcViewHolder.logo
                        .setVisibility(View.GONE);
                bcAsyncArgumentHolder.bcViewHolder.time
                        .setVisibility(View.GONE);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setVisibility(View.VISIBLE);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setText(bcAsyncArgumentHolder.bcItemHolder.title);
            }

            // smal layout, to 5min
            if (bcAsyncArgumentHolder.bcItemHolder.width <= 5 * controller
                    .getPixelPerMinute()) {
                bcAsyncArgumentHolder.bcViewHolder.logo
                        .setVisibility(View.GONE);
                bcAsyncArgumentHolder.bcViewHolder.time
                        .setVisibility(View.GONE);
                bcAsyncArgumentHolder.bcViewHolder.title
                        .setVisibility(View.GONE);
            }

            if (bcAsyncArgumentHolder.bcItemHolder.dummy) {
                bcAsyncArgumentHolder.bcViewHolder.divider
                        .setVisibility(View.GONE);
            } else {
                bcAsyncArgumentHolder.bcViewHolder.divider
                        .setVisibility(View.VISIBLE);
            }

            if (!bcAsyncArgumentHolder.bcItemHolder.id.equalsIgnoreCase("")) {
                bcAsyncArgumentHolder.bcViewHolder.broadcastId = Long
                        .parseLong(bcAsyncArgumentHolder.bcItemHolder.id);
            }
            bcAsyncArgumentHolder.convertView.setVisibility(View.VISIBLE);
        }
    } 
```

那么你是如何解决你的问题的呢？我的解决方案有问题，viewRecycling 导致视图混淆，导致渲染 5 分钟布局而不是 40 分钟布局，因为如果我快速滚动会有一些并发性。我知道为什么会这样，但我不知道如何解决它，但是:-D

# php - php地址的正则表达式

> ID：14532250
> 
> 赞同：0
> 
> 时间：2013-01-26T00:01:31.193
> 
> 标签：php, regex

我一直在努力解决这个问题。如果有人可以提供帮助会很棒

```
 $address= str_replace('/\s+/', ' ', $address_line_1.' '.$address_line_2.', '.$town_village_city.', '.$state_province_county.', '.$postal_code.', '.$country);
    return str_replace('/,+/',', ',$address); 
```

想用单个逗号单个空格格式化地址，地址的任何部分都可能丢失，甚至完整的地址

不希望 ,,,, 被返回，但在这种情况下简单没有字符

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:08:11.527

```
$address = implode(' ', array_filter(explode(' ',
   implode(', ', array_filter(explode(',', $address
)))))); 
```

这将在没有正则表达式的情况下工作，但考虑到正则表达式有多简单，我会坚持使用这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:03:34.377

如果您想使用正则表达式，请使用`preg_replace()`而不是`str_replace()`

# iphone - 如何在 iOS 上使用 Facebook 的转化跟踪像素

> ID：14532253
> 
> 赞同：6
> 
> 时间：2013-01-26T00:02:12.740
> 
> 标签：iphone, ios, facebook, facebook-graph-api, ads

我想在 iOS 应用程序中使用 Facebook 广告转换跟踪来跟踪用户安装后的事件。Facebook 有一种通过转化跟踪像素在网页上执行此操作的方法，我已经查看了该 JavaScript。它使用像素 ID 向 offsite_event.php 发出 GET 请求： [https ://www.facebook.com/offsite_event.php?id=6005000000&value=0](https://www.facebook.com/offsite_event.php?id=6005000000&value=0)

显然，仅凭像素 ID 不足以知道是哪个 Facebook 用户发出了请求。所以我假设这个 PHP 正在读取一个 facebook.com cookie 来确定用户。

Facebook 上的任何人都可以透露这个 PHP 代码需要哪些 cookie。“c_user”也许？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-30T03:05:16.793

添加到迈克尔的答案。

您使用“应用程序事件”而不是用于网站的转换像素来完成此操作。

查看“应用安装计数”以外的其他事件，这是“应用安装广告”的默认目标。转到广告管理器 > 报告 > 按“编辑列”按钮 > 导航到指标 > 操作 > 查找移动应用程序类别。

我的完整答案也是@ [https://stackoverflow.com/a/26644170/4188314](https://stackoverflow.com/a/26644170/4188314)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:29:55.563

Facebook 刚刚在最新的 3.2 iOS SDK 更新中添加了这个功能。

[https://developers.facebook.com/blog/post/2013/02/25/facebook-sdk-3-2-for-ios/](https://developers.facebook.com/blog/post/2013/02/25/facebook-sdk-3-2-for-ios/)

# jquery - jQuery - 仅选择具有特定类父级的图像的属性值

> ID：14532255
> 
> 赞同：0
> 
> 时间：2013-01-26T00:02:24.363
> 
> 标签：jquery, css

我有一个这样的列表：

```
<ul>
    <li><div class="thumb"><img src="image-1.jpg"></div></li>
    <li><div class="thumb"><img src="image-2.jpg"></div></li>
    <li><div class="thumb selected"><img src="image-3.jpg"></div></li>
</ul> 
```

如何选择具有 class=“selected”的 div 父级的 img 的 src 属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T00:03:16.873

获取当前`src`值：

```
var selectedSrc = $("div.selected img").attr("src") 
```

要更改`src`：

```
$("div.selected img").attr("src", "someImage.jpg"); 
```

（请注意，选择器`"div.selected img"`返回该 div 中的*所有*图像，这对您来说没问题，因为只有一个。如果有多个，`.attr("src")`将仅返回`src`第一个，但`.attr("src", "SomeImage.jpg")`会全部更改。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:05:21.903

作为简洁答案的替代方法，可以选择`img`然后过滤：

```
$('img').filter(function() {
    return $(this).closest('div.selected').length;
}).attr('src'); 
```

但这并不是非常有效，正如[jsPerf 所展示](http://jsperf.com/a-brief-comparison-of-selection-methods)的那样。

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [`filter()`](http://api.jquery.com/filter/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:06:10.537

```
$(".thumbselected").children("img").attr("src"); 
```

选择 Class `.thumbselected`，选择其子项`img`，获取`src`.

# java - 获取 TypeError：包含 java_import 的错误参数类型数组（预期模块）

> ID：14532265
> 
> 赞同：1
> 
> 时间：2013-01-26T00:03:20.697
> 
> 标签：java, include, jruby

我刚刚开始使用 JRuby，当我测试以下保存为脚本的代码时

```
include java_import
frame = javax.swing.JFrame.new
frame.getContentPane.add javax.swing.JLabel.new('Hello, World!')
frame.setDefaultCloseOperation javax.swing.JFrame::EXIT_ON_CLOSE
frame.pack
frame.set_visible true 
```

我收到以下错误

```
Switch to inspect mode.
irb(main):001:0> include java_import
TypeError: wrong argument type Array (expected Module)
    from org/jruby/RubyModule.java:2068:in `include'
    from (irb):1:in `evaluate'
    from org/jruby/RubyKernel.java:1066:in `eval'
    from org/jruby/RubyKernel.java:1392:in `loop'
    from org/jruby/RubyKernel.java:1174:in `catch'
    from org/jruby/RubyKernel.java:1174:in `catch'
    from C:\jruby-1.7.2\/bin/jirb_swing:54:in `(root)'
irb(main):002:0> 
```

有人可以帮我确定我做错了什么吗？我已经安装了 jruby-1.7.2 (C:\jruby-1.7.2)，添加到系统变量中的 PATH，并在 Windows 7 上运行。在命令提示符下，我可以正确测试 jruby 和 java 版本

我还通过 jruby(1.9.3).exe 启动了 jirb_swing 并在提示符下输入

```
irb(main):001:0> include java_import 
```

我得到同样的错误信息

**更新**

大家好

在 JRuby 和 Java 的 Internet 页面上进一步搜索后，我已经成功解决了这个问题。

首先是我从 JRuby 调用 Java 的两种方法：

1.  使用“include Java”（在我的脚本文件中不带引号，大写 J）
2.  使用 "require 'java'" (没有 " 引号，注意 java 周围的单引号，现在以小写 j 开头)

[当我在 GitHub ( https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby](https://github.com/jruby/jruby/wiki/CallingJavaFromJRuby) )上阅读详细文档时，我使用的“java_import”是我粗心的错误

我将更多地研究使用“include”与“require”语句的差异或缺乏并回发。作为一个真正的新手，这真是大开眼界

斯里兰卡

# c# - FileInfo.Length 可以转换为整数吗？

> ID：14532272
> 
> 赞同：0
> 
> 时间：2013-01-26T00:04:41.190
> 
> 标签：c#, casting, fileinfo

我正在使用 FileInfo.Length 来获取文件的大小，然后将其发布到 GoogleDoc。问题是我从 FileInfo.Length... 得到负值。

我在网上四处寻找一些解决方案，但找不到任何其他原因......除了 FileInfo.Length 应该是 Long 而我将其转换为 Int ......这可能与它？

这是我的代码：

```
 int size = (int)file.Length;
                string name = file.Name;
                googleBot.insertArchiveRow(name, size);
                progressBar.Value++;
                this.UpdateLayout(); 
```

铸造会在这里给我带来问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T00:06:18.597

是的。铸造可能会给您带来问题。

文件有多大？

> “FileInfo.Length 应该是 Long，我将其转换为 Int .....”

如果大于`2^31 - 1` 然后强制转换为 an`int`可能是负数....

例如

```
 long l = (long)Math.Pow(2, 31);
        int i = (int) l;
        Console.WriteLine("{0}", l);
        Console.WriteLine("{0}", i); 
```

印刷：

```
2147483648
-2147483648 
```

**底线**:`FileInfo.Length`是 a `long`，所以这样对待它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T00:24:19.057

避免这样的意外，让编译器生成代码来执行错误检查：

```
 int size = checked((int)file.Length); 
```

您现在将得到一个 OverflowException 而不是一个负值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T00:17:59.387

是的，很容易，事实上...

```
int.MaxValue ==  2147483647 == 0x7FFFFFFF
int.MinValue == -2147483648 == 0x80000000 
```

`int.MaxValue`是`2^31 - 1`，所以大小约为 2GB；任何比这更大的文件都会读为负数，直到你再次循环回来，也就是说。:)

# php - 在 `alert` 之后可见的 innerHTML 修改，但在其他情况下不可见

> ID：14532274
> 
> 赞同：0
> 
> 时间：2013-01-26T00:05:13.340
> 
> 标签：php, javascript, html

全部，

我有一个相当简单的 javascript 脚本，可以更改我的 html 页面中的一些文本。奇怪的是，只有当我收到警报时，数据才会更改。如果我将警报隐藏为评论，则数据不会出现在网页上。具体来说，以下是相关的 JS 代码：

```
var index=0;
var xmlObject=null;

function calcIndex(){
  return index++;
}

function showNextName(){
  retrieveNextName();
  var someText = xmlObject.getElementsByTagName("name")[0].childNodes[0].nodeValue;
  document.getElementById('nextName').innerHTML=someText;
}

function retrieveNextName(){
  var index=calcIndex();
  request = createRequest();
  if (request == null) {
    alert("Unable to create request");
    return;
  }
  var url= "Ajax_retrieveName.php?index=" + index;
  request.open("GET", url, true);
  request.onreadystatechange = createXml;
  request.send(null);
  alert("abc");
  //If the alert above is missing, the html is not modified...
}

function createXml() {
  if (request.readyState == 4) {
    if (request.status == 200) {
      xmlObject = request.responseXML;
    }else{
      return;
    }
  }else{
    return;
  }
} 
```

有谁知道可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:38:37.240

问题是 XML 对象不是立即可用的，因为请求还没有完成，所以回调还没有被调用。（警报允许请求在您关闭警报框之前的时间内完成。）

更好的解决方案是拥有一个 updateElementHtml(newHtml) 函数并从回调中调用*它*。

# xml - 我如何获得 WCF 的肥皂结构？

> ID：14532275
> 
> 赞同：-3
> 
> 时间：2013-01-26T00:05:21.347
> 
> 标签：xml, wcf, xsd, webservices-client

我需要将我的应用程序与另一个系统集成，并且我需要发送 Web 服务结构，所以为此我需要发送一个带有请求和响应消息的 xml。我使用一些工具来做到这一点，但没有任何成功。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T19:03:38.403

使用[Fiddler](http://www.fiddler2.com/fiddler2/)捕获对 Web 服务的请求和相应响应的示例。

使用 Web 服务的 WSDL - 如果它是 SOAP 服务，则应该有一个返回它的 URL。

# bash - 如何让下一个 bash 循环等到循环内的程序完成？

> ID：14532281
> 
> 赞同：2
> 
> 时间：2013-01-26T00:06:04.307
> 
> 标签：bash

我意识到 bash 脚本中的以下循环将发送`./a.out`到后台，并且运行将在单个`./a.out`运行完成之前返回系统。

```
#!/bin/bash
for i in 1,2,3
do
    echo $i
    ./a.out 
done 
```

问题是如何让下一个 bash 循环等到“./a.out”完成？

顺便说一句，我认为这应该是一个常见问题，但没有找到类似的问题，或者我可能需要更多的搜索技巧......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:10:15.167

您所描述的是默认行为。您可能会对循环只运行一次的事实感到困惑，使用`i="1,2,3"`，因此似乎一次打印所有内容然后立即退出。

试试看`for i in 1 2 3`，看看你是否得到了你期望的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:18:33.983

您可能会发现“C 风格” for 循环更容易，即： for ((i = 1 ; i < 4 ; i++))

# java - 如何在 Java 中设置默认的递增/递减值

> ID：14532292
> 
> 赞同：0
> 
> 时间：2013-01-26T00:07:08.943
> 
> 标签：java

好的，所以我有一个家庭作业问题。我正在构建一个用于我的讲师提供的测试员课程的课程。它只不过是一个基本的计数器。我已经将计数器设置为测试人员传递给我的班级的数字工作正常并且输出符合预期。但是，我的班级必须将初始计数设置为 0，并且默认增量/减量为 1。

这是我的课：

```
public class Counter
{
    private int count;
    private int stepValue;

    /**
     * This method transfers the values called from CounterTester to instance variables
     * and increases/decreases by the values passed to it. It also returns the value
     * of count. 
     *
     * @param args
     */ 
    public Counter (int initCount, int value)
    {       
        count=initCount;
        stepValue=value;
    }   

    public void increase ()
    {
        count = count + stepValue;
    }

    public void decrease ()
    {
        count = count - stepValue;
    }

    public int getCount()
    {
        return count;
    }

} 
```

这是测试器类：

```
public class CounterTester
{

    /**
     * This program is used to test the Counter class and does not expect any
     * command line arguments. 
     *
     * @param args
     */
    public static void main(String[] args)
    {
        Counter counter = new Counter();

        counter.increase();
        System.out.println("Expected Count: 1 -----> Actual Count: " + counter.getCount());

        counter.increase();
        System.out.println("Expected Count: 2 -----> Actual Count: " + counter.getCount());

        counter.decrease();
        System.out.println("Expected Count: 1 -----> Actual Count: " + counter.getCount());

        counter = new Counter(3, 10);
        System.out.println("Expected Count: 3 -----> Actual Count: " + counter.getCount());

        counter.increase();
        System.out.println("Expected Count: 13 ----> Actual Count: " + counter.getCount());

        counter.decrease();
        System.out.println("Expected Count: 3 -----> Actual Count: " + counter.getCount());

        counter.decrease();
        System.out.println("Expected Count: -7 ----> Actual Count: " + counter.getCount());
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:09:41.010

第一次实例化它时，您的 Counter 类中没有无参数构造函数，所以这样做

```
Counter counter = new Counter(0,1); 
```

哪个应该设置初始值和步长值。

或者您可以提供一个无参数构造函数：

```
public class Counter
{
  private int count;
  private int stepValue;

  public Counter () { //no argument constructor - must be explictly made now
    count=0;
    stepValue = 1;
  }

  public Counter (int initCount, int value)
  {       
    count=initCount;
    stepValue=value;
  }  

  //rest of code
} 
```

# c# - 将标准属性更改为 DependencyProperty

> ID：14532293
> 
> 赞同：0
> 
> 时间：2013-01-26T00:07:13.733
> 
> 标签：c#, wpf-controls, dependency-properties

在开发一些供内部使用的用户控件时，我遵循了 MSDN [http://msdn.microsoft.com/en-us/library/vstudio/ee712573(v=vs.100).aspx中的这个例子](http://msdn.microsoft.com/en-us/library/vstudio/ee712573(v=vs.100).aspx)

一个控件的公共值被另一个控件使用。我目前的工作方式是通过代码隐藏连接到第一个控件中触发的事件。我正在考虑制作一个或两个属性 DependencyProperties，这将消除对代码隐藏的需要。

```
public partial class UserControl1 : UserControl
{
    private DataModel1 dm;
    public UserControl1()
    {
        this.DataContext = new DataModel1();
        dm = (DataModel1)DataContext;
        InitializeComponent();
    }
    public DataValue CurrentValue
    {
        get { return dm.CurrentValue; }
        set { dm.CurrentValue = value; }
    }
}
public class DataModel1 : INotifyPropertyChanged
{
    private DataValue _myData = new DataValue();
    public DataValue CurrentValue
    {
        get { return _myData; }
        set { if (_myData != value) {_myData = value OnPropertyChanged("CurrentValue"); }
    }
    // INotifyPropertyChanged Section....
} 
```

该物业只是班级的通行证`DataModel1`。

两个 UserControl 的结构非常相似，并且具有相同的公共属性。我想用类似的 Binding 替换 eventhandler 后面的代码，我认为：

```
<my:UserControl1 Name="UserControl1" />
<my:UserControl2 CurrentValue={Binding ElementName="UserControl1", Path="CurrentValue"} /> 
```

但是 DependencyProperties 的标准示例有 getter 和 setter，它们使用`GetValue`和`SetValue`函数，它们使用生成的支持对象而不是允许通过。

```
public DataValue CurrentValue
{
    get { return (DataValue)GetValue(CurrentValueProperty); }
    set { SetValue(CurrentValueProperty, value); }
} 
```

我认为 DP 应该是这样的：

```
public static readonly DependencyProperty CurrentValueProperty = 
        DependencyProperty.Register("CurrentValue", typeof(DataValue), typeof(UserControl1)); 
```

如何更改公共支持属性的定义以支持数据绑定传递？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T15:23:28.590

I found that jumping into the OnPropertyChanged event allowed me to pass the data through to the `DataModel1`. I am not 100% sure that this is the correct answer but it gets the job done.

Here is the corrected code:

```
public static readonly DependencyProperty CurrentValueProperty =
       DependencyProperty.Register("CurrentValue", typeof(DataValue), typeof(UserControl1),
       new PropertyMetadata(new PropertyChangedCallback(OnCurrenValueChanged)));
private static void OnCurrentValueChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        UserControl1 uc = d as UserControl1;
        if (e.NewValue != null)
        {
            uc.dm.CurrentValue = e.NewValue as DataValue;
        }
    }
public DataValue CurrentValue
{
        get { return GetValue(CurrentValueProperty) as DataValue; }
        set { SetValue(CurrentValueProperty, value); }
    } 
```

# matlab - 如何在 MatLab 中设计 SOAP 调用

> ID：14532299
> 
> 赞同：1
> 
> 时间：2013-01-26T00:07:47.943
> 
> 标签：matlab, soap

我完全不清楚如何从 MatLab 调用 Web 服务。我正在尝试应用[本指南](http://www.mathworks.se/help/matlab/matlab_external/accessing-web-services-using-matlab-soap-functions.html)，但我不明白几个部分。比如这个。

*   在哪里指定它是 GET 或 POST？
*   什么是*命名空间*？
*   我应该如何提供我拥有的 WSDL 文件？

我很迷茫，所以任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:07:53.407

如果您有权访问 Web 服务定义列表 (WSDL)，则可以这样：

```
wsdl = createClassFromWsdl('http://server.domain/NameOfMethod.asmx?WSDL')
calls = methods(NameOfMethod)
response = HelloWorld(NameOfMethod, "Konrad") 
```

看到[这个信息](http://www.mathworks.se/help/matlab/ref/createclassfromwsdl.html)。这很容易理解并且直接掌握。我自己也很惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:20:20.397

由于您想使用 WSDL，因此您正在使用错误的文档。您链接到有关 SOAP 的指南。

要了解 WSDL，请阅读：[访问使用 WSDL 文档的 Web 服务](http://www.mathworks.co.uk/help/matlab/matlab_external/accessing-web-services-that-use-wsdl-documents.html)。当您使用 MATLAB 时`createClassFromWsdl`，您无需担心 SOAP 实现。生成的 MATLAB 类负责这一点。

# ios - 健全性检查：设计可在 iOS 和 OSX 中使用的视图的架构？

> ID：14532300
> 
> 赞同：1
> 
> 时间：2013-01-26T00:08:07.633
> 
> 标签：ios, objective-c, macos, sanity-check

我正在构建一个应用程序，我想在 iOS 和 OSX 中重用 99% 的代码。只是要求进行健全性检查。

**（编辑）**关于我的项目的更多信息可能会影响一些响应：我的应用程序涉及一个可定制的演示文稿，主要用于 iOS 设备。OSX 组件实际上是可定制呈现的设计器 - 一种指定要在选定的 iOS 设备上呈现的内容的方法。也就是说，OSX 应用程序将是一个完全正常的 OSX 应用程序，它允许用户为 iOS 设备选择、配置和定位一些元素 - 并显示该演示文稿的预览。当然，我希望预览尽可能类似于 iOS 渲染（而不实际调用 iOS 模拟器，我不希望它在所有 OSX 设备上都可用）。因此，我将演示文稿设计为一个视图，应该在 OSX 和 iOS 上尽可能以几乎相同的方式呈现。

为此，我从 iOS 中开始使用一些简单的视图绘图内容，现在我正在重新配置代码以便可以将其移植到 OSX。到目前为止，我的策略是将所有对 UIView / UIWindow / UIFont / UIColor 等的引用替换为 _View / _Window / _Font / _Color 等。对于 iOS 版本，我将包含一个名为 Wrapper.h 的文件，如下所示：

```
#define _Device UIDevice
#define _Application UIApplication
#define _ApplicationMain UIApplicationMain
#define _ApplicationDelegate UIApplicationDelegate
#define _Responder UIResponder
#define _Window UIWindow 
```

...使用基于 NS 的 OSX 定义（NSWindows 等）我知道一些细节会改变（比如视图中的 Y 坐标），但我可以处理。

我认为我不能像这样映射的唯一组件是手势识别器，因为 OSX 没有等效组件。我打算让它们成为在 iOS 包装器中实现的通用调用，并在 OSX 包装器中存根，因为我真的不需要 OSX 中的点击事件。

好主意？馊主意？有没有更好的方法来解决这个问题？谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T04:31:21.120

> 到目前为止，我的策略是将所有对 UIView / UIWindow / UIFont / UIColor 等的引用替换为 _View / _Window / _Font / _Color 等。

UIKit 不仅仅是 AppKit，所有出现的“NS”都更改为“UI”。尽管有很强的相似之处，但框架的工作方式和用户期望使用每个框架编写的软件的方式也存在重要差异。是否可以编写一个同时使用 UIKit 和 AppKit 实现的框架？毫无疑问，但您最终会遇到一些阻碍您充分利用这两个平台的东西。

> 好主意？馊主意？有没有更好的方法来解决这个问题？

海事组织，坏主意。如果您在设计数据模型方面做得很好，您应该能够在 Mac 和 iOS 实现之间共享它而无需更改。然后，与其花大量时间试图弄清楚如何编写一个单一的用户界面并想出一些双方都可以妥协的东西，不如把精力放在创建在两个平台上都引人注目的独立用户界面上。

# java - Selenium RC - 错误：无法找到或加载主类 jar

> ID：14532303
> 
> 赞同：2
> 
> 时间：2013-01-26T00:08:20.483
> 
> 标签：java, selenium, selenium-rc, runtime-error

我正在尝试在 GOOGLE CHROME 中运行 FIREFOX selenium IDE 生成的文件。

以下是对问题所在以及我尝试（到目前为止未成功）解决问题的逐步描述。

**环境**

```
Selenium IDE – installed**strong text**
Selenium RC – installed
Java version 1.7.0.05  - installed 
```

**我正在尝试做的事情：**

在 GOOGLE CHROME 步骤中运行 FIREFOX IDE 生成的测试

```
(1) Following three .htm files created using FIREFOX
a.  google_for_selenium_rc.htm
b.  google_for_testing.htm
c.  visit_google_videos

(2) Created suite.htm file (see attached)

(3) Run the following command in cmd:

java –jar selenium-server.jar –htmlSuite “C:\Program Files 
(x86)\Google\Chrome\Application\chrome.exe¬” “http://www.google.com.au” 
“C:\Users\shelleymoudgil\Documents\KB\Selenium\SeleniumIDE\suite.htm” 
“C:\Users\shelleymoudgil\Documents\KB\Selenium\SeleniumIDE\results.htm” 
```

**预期的**

```
(4) Script successfully executed in GOOGLE CROME 
```

**实际的**

```
(5) Following Error displayed: 
```

错误：

```
 Could not find or load main class ûjar 
```

**到目前为止尝试的解决方案**

*   将 C:\Program Files\Java\jre7\bin\ 添加到 PATH
*   将 C:\Program Files (x86)\Java\jre7\bin 添加到 PATH
*   将 C:\Program Files (x86)\Google\Chrome\Application\ 添加到 PATH

我是 java 和 selenium 的新手。我被困在过去的 1 天。有人可以指导和建议一个可能的解决方案或我可能做错了什么。

谢谢美国

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-31T20:13:05.857

仅从错误消息来看，您的`-jar`参数似乎不是`-`第一个字符，可能是一个破折号。然后它将解释`–jar`为要在类路径上搜索的类。尝试这样做会为我产生相同的错误消息，以系统上的错误消息发生的任何编码转换为模。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-02T03:48:51.360

从以下链接下载此 Jar 文件并将其粘贴到桌面上。

[https://code.google.com/p/selenium/downloads/detail?name=selenium-server-standalone-2.28.0.jar&can=2&q=](https://code.google.com/p/selenium/downloads/detail?name=selenium-server-standalone-2.28.0.jar&can=2&q=)

然后在命令提示符下键入以下内容并运行此 jar。

> cd 桌面 java -jar typejarname

在此之后，jar 将开始运行。现在执行代码，看看它是否工作。

# java - 如果只在里面做一个语句，你是否需要在 java 中的双 for 循环中使用括号？

> ID：14532318
> 
> 赞同：0
> 
> 时间：2013-01-26T00:10:26.070
> 
> 标签：java, for-loop

我不知道第二个 for 循环是否会被视为表示需要花括号的语句。

所以我要问的是这些`for-loops`：

```
for (int i=1;i<a.length;i++){
    for (int j=0;j<a[i].length;j++){
        a[i][j] = b[i][j]-c[i][j];
    }
} 
```

与这些意思相同`for-loops`：

```
for (int i=1;i<a.length;i++)
    for (int j=0;j<a[i].length;j++)
        a[i][j] = b[i][j]-c[i][j]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T00:11:33.243

**简短的回答：**没有

**长答案：**您不必这样做，但应该这样做。它增加了代码的可读性，它可以让你免于无用的调试和深夜工作。此外，[Oracle 的代码约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-142311.html#449)明确规定您应该始终使用大括号。

你也可以这样写：

```
for (int i=1;i<a.length;i++)
    for (int j=0;j<a[i].length;j++)
        if (a[i][j] > 500)
            if (checkForSomethingStupid(a[i][j]))
                a[i][j] = b[i][j]-c[i][j]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T00:20:13.790

你不需要它，但是很多人认为大括号可以提高可读性，特别是在缩进可能不准确的情况下。例如：

```
for (int i=1;i<a.length;i++)
    for (int j=0;j<a[i].length;j++)
a[i][j] = b[i][j]-c[i][j]; 
```

如果你读得这么快，你可能不会意识到第三行被执行了多次。但在这种情况下...

```
for (int i=1;i<a.length;i++) {
    for (int j=0;j<a[i].length;j++) {
a[i][j] = b[i][j]-c[i][j];
    }
} 
```

......这更明显。相信我，人们已经浪费了好几天的时间来寻找这样的错误！

这是另一个例子：

```
for (int i=1;i<a.length;i++) 
    for (int j=0;j<a[i].length;j++)
        a[i][j] = b[i][j]-c[i][j];
        count++; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T00:11:48.503

你不需要大括号，因为它是一个语句。但强烈建议这样做，否则有一次你会出现编码错误。（添加一个语句时）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T00:13:29.787

是的，它们是一样的。

因为花括号对于包含多个进一步的语句是必要的，但您在第一个语句之后只使用一个 for （使用另一个语句，但它包含在 for 循环中）。

然而，大括号的使用非常有用，因为它们简化了阅读，因此编写代码的更好方法是：

```
for (int i=1;i<a.length;i++)
{
    for (int j=0;j<a[i].length;j++)
    {
        a[i][j] = b[i][j]-c[i][j];
    }
} 
```

即使，正如在这种情况下所说的那样，它们没有必要..

但是，在以下情况下：

```
for (int i=1;i<a.length;i++)
    for (int j=0;j<a[i].length;j++)
    {
        a[i][j] = b[i][j]-c[i][j];
        a[i][j] = a[i][j]*a[i][j]; //or anything other statement you want to do in this for-cycle
    } 
```

第一个 for 循环不需要大括号，因为它只包含一个语句，第二个 for 循环需要大括号，因为它包含两个语句。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-26T00:19:03.630

是的，两个循环都是一样的。但根据编码约定，即使循环块中只有一行代码，也建议使用 curly。这是为了保持代码的可读性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-26T00:43:35.230

正如其他人所提到的，这不是必需的，但通常被认为是良好的做法。

但是，有一种情况可能是必要的。如果您正在处理一个自动化工具对您强制执行代码质量限制的项目（例如 checkstyle 或 PMD），那么省略大括号可能会导致构建失败。

# python - Selenium : WaitForElement (Python) : 没有要轮询的不同元素

> ID：14532319
> 
> 赞同：0
> 
> 时间：2013-01-26T00:10:43.690
> 
> 标签：python, selenium

所以我正在浏览分页数据...单击 [Next]，然后单击 WaitForElement-ing，因为它是 AJAX 驱动的。

但是，没有 DIFFERING 元素......如果 WaitForElement 立即返回 true，我该怎么办？如何确定 AJAX 已加载？

例如，在下面的例子中，如果 className 元素出现在每个 AJAX 加载的页面上，我该怎么办？

```
browser.find_element_by_link_text('[Next]').click()
wait.until(lambda b: b.find_elements_by_class_name('className')) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T14:29:09.460

当然有。我向您保证新页面中至少有一个不同的元素，否则当您单击 PREVIOUS 或 NEXT 时分页机制将不知道要显示哪个页面。继续看，会有类似“ *n* of *m* results”、an`<a href="/blah.blah.blah?page=n">Next</a>`或至少 an之类的东西`<input type="hidden" name="nextItem" value="n">`。这些类型的控件取决于驱动分页的客户端状态，并且它始终保留在页面内。

# joomla2.5 - Joomla：如何控制模块在不在菜单中的页面上显示，例如默认登录页面

> ID：14532324
> 
> 赞同：0
> 
> 时间：2013-01-26T00:11:16.060
> 
> 标签：joomla2.5, joomla-component, joomla-module

我试图控制在由组件生成的页面上显示哪些模块，例如当用户登录或尝试登录时。这些页面不在菜单结构中，因此我无法以通常的方式取消发布模块。

继续登录示例，网址将是“www.mysite.co.uk/index.php/component/users/?view=login”

如何控制此类页面上的模块发布，我宁愿不必使用覆盖。

Joomla v2.5

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:15:27.857

[在此处](http://extensions.joomla.org/extensions/style-a-design/modules-management/10307)使用 Joomla 高级模块管理器 - JED 链接。与在菜单页面上设置模块的常用方法相比，它为您提供了更多的控制 - 包括“在所有页面上显示模块的选项，除了选定的菜单项” - 即在除了登录页面等的所有页面上显示它。

# jquery - jQuery .removeClass() 不做任何事情的奇怪问题

> ID：14532327
> 
> 赞同：12
> 
> 时间：2013-01-26T00:11:28.680
> 
> 标签：jquery, css, jquery-ui, settimeout

我有一些代码向元素添加类，然后尝试删除它们并在 1 秒后添加不同的类。我遇到了一些非常奇怪的行为，我什至无法在一个简单的[jsfiddle 示例](http://jsfiddle.net/MvvmJ/)中重现。

这是我拥有的相关 JavaScript 代码：

```
console.log('before destroyed: ' + currentTile.get(0).className);
currentTile.addClass(classes.destroyed);
console.log('after destroyed: ' + currentTile.get(0).className);

setTimeout(function () {
    console.log('before blanking: ' + currentTile.get(0).className);
    currentTile.removeClass().addClass(classes.blank + ' ui-draggable');
    console.log('after blanking: ' + currentTile.get(0).className);
}, 2000); 
```

这是控制台所说的：

![在此处输入图像描述](../Images/d60fb7d244c3a498816e781d3e10e7f8.png)

如您所见，添加`destroyed`类工作正常，但对`removeClass()`内部的调用`setTimeout`似乎什么也没做，然后`.addClass(classes.blank + ' ui-draggable');`似乎也工作正常。此外，如果我将一个类传递给`removeClass`它，它会毫无问题地删除该类。

如果这是一个上下文问题或者`currentTile`是错误的元素，我认为它`addClass`也会失败？有人知道这里发生了什么吗？

附加信息：jQuery 最新版（我认为是 v.1.9.0）、jQuery UI v 1.10.0、Chrome v.24.0.1312.56 m

* * *

**编辑**：这个问题似乎与 jQuery UI 直接相关，并且可以在[这个 fiddle](http://jsfiddle.net/MvvmJ/3/)中看到。

* * *

**编辑 2**：这已被确认为[jQuery 中的错误](http://bugs.jqueryui.com/ticket/9015)，并已修复。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T02:02:38.050

尝试使用`.removeAttr('class')`而不是`.removeClass()`.

演示：

[http://jsfiddle.net/MvvmJ/8/](http://jsfiddle.net/MvvmJ/8/)

希望这会有所帮助，如果您有任何问题，请告诉我！

# visual-c++ - VS2012静态分析：这个指针作为输出指针？

> ID：14532330
> 
> 赞同：1
> 
> 时间：2013-01-26T00:11:44.507
> 
> 标签：visual-c++, visual-studio-2012, static-analysis

在此代码片段中，Init() 函数充当按需初始化程序，用于填充结构的所有成员变量。这样做是为了避免调用堆栈上大型数组的所有成员的默认构造函数：

```
struct Foo {
    int m_Member;
    void Init(int i);
};

void Foo::Init(int i) {
    m_Member = i;
    // Many other members initialized here.
}

void SomeFunction(int n) {
    Foo buffer[64];
    assert(n <= 64);
    // Explicitly initialize what is needed.
    for (int i = 0; i < n; ++i) {
        buffer[i].Init(i * 3);
    }
    // Use buffer[0] - buffer[n-1] somehow.
} 
```

这会在 VS2012 中使用 /analyze 触发静态分析错误：

```
warning C6001: Using uninitialized memory 'buffer'.: Lines: 17, 19, 20 
```

我正在寻找一种方法来注释 Foo::Init() 以便不会发生此警告。还有很多其他方法可以消除警告，包括：

*   添加一个空的构造函数
*   将 Init() 移至构造函数并在循环中调用placement new

但我想避免改变代码的结构。

我尝试了以下注释但没有成功：

```
void _At_(this, _Out_) Init(); 
```

此语法被接受，但仅将警告更改为：

```
warning C6001: Using uninitialized memory 'buffer'.: Lines: 18, 20, 21
warning C6001: Using uninitialized memory 'buffer[BYTE:0]'.: Lines: 18, 20, 21 
```

有谁知道我如何向静态分析引擎声明这个 Init() 函数的意图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T05:20:16.987

你的问题有点难以捉摸。您已经展示`SomeFunction`了服用`int`，但需要方法`Init`或构造函数的注释。

显示的警告绝对正确，`assert`不会隐藏警告。您需要 put`if`检查是否`n`大于`64`并重置`n`（或执行其他操作，但不要循环 when `n>=64`）。

对于注释，您需要使用`__in_bcount`或类似的替代方法。一个例子：

```
bool SetBuffer(__in_bcount(8) const char* sBuffer); 
```

这说 sBuffer 是`8` **字节**（不是元素）。

您可以阅读这篇[文章](http://www.codeproject.com/Articles/118018/Elucidating-all-about-Code-Analysis-in-Visual-C#MakeAnalyzable)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T18:57:41.200

添加一个额外的助手太丑了？

```
struct Foo {
    int m_Member;
    void Init(int i);
};

void Foo::Init(int i) {
    m_Member = i;
    // Many other members initialized here.
}

void Initialize(__in_bcount(sizeof(Foo) * n) Foo* buffer, int n) {
    // Explicitly initialize what is needed.
    for (int i = 0; i < n; ++i) {
        buffer[i].Init(i * 3);
    }
}

void SomeFunction(int n) {
    Foo buffer[64];
    assert(n <= 64);
    Initialize(buffer, n);
    // Use buffer[0] - buffer[n-1] somehow.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-27T16:03:16.930

我通过实现一个函数来索引数组找到了解决方法。我将返回值标记为无效，以便这个新函数仅在返回值仅用于初始化的特定情况下转义未初始化值检查。我只在 VS2017 中测试过这个。

```
#define _Ret_invalid_                     _SAL2_Source_(_Ret_invalid_, (), _Ret1_impl_(__notvalid_impl))

template <typename T>
_Ret_invalid_ T& UninitialzedIndex(T* pt, int index)
{
   return pt[index];
} 
```

然后，在索引值的地方，我调用 UninitialzedIndex 而不是 operator[]

```
void SomeFunction(int n) {
    Foo buffer[64];
    if (n <= 64)
      return;

    // Explicitly initialize what is needed.
    for (int i = 0; i < n; ++i) {
        UninitialzedIndex(buffer, i).Init(i * 3);
    }
    // Use buffer[0] - buffer[n-1] somehow.
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-26T00:14:21.550

只需添加一个默认构造函数（调用 Init()）。那有什么问题？

[编辑] 根本问题不是如何欺骗静态分析器或编译器。这是如何强制您不要让 foo 处于未初始化状态。添加默认构造函数没有任何问题。我想说不这样做的愿望会带来风险。

也许某些客户会使用构造不佳的 foo 类（在您编写它很久之后，在您离开之后很久），也许他们会忘记调用 .Init() ？然后怎样呢？他们将留下未初始化的数据。

如果您希望强制执行该规则，那么再多的静态分析也无济于事。

在安装屋顶之前，请先处理好地基。

# c# - 使用 C# 在 Umbraco 节点列表上使用 OrderBy

> ID：14532333
> 
> 赞同：1
> 
> 时间：2013-01-26T00:11:55.040
> 
> 标签：c#, umbraco

我在 C# 中有一个 Umbraco 节点列表。我可以使用节点类中内置的一些顶级属性（例如 node.Name）成功订购这些属性，但是当我尝试使用 GetProperty() 函数获取一些动态属性时，我得到了 NullReferenceException。

代码：

`nodes = nodes.OrderBy(n => n.GetProperty("fromPrice").ToString()).ToList();`

替换`n.GetProperty("fromPrice").ToString()`为`n.Name`作品，但我不想按此排序。

异常消息：

`System.NullReferenceException: Object reference not set to an instance of an object.`

不完全确定这意味着什么。任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:04:15.770

我认为您可以从查询中的 Where 子句中受益，例如（根据我的记忆编写，未经测试）

```
var nodes = nodes.Where(x => x.GetProperty("fromPrice") != null).OrderBy(n => n.GetProperty("fromPrice").Value); 
```

这应该首先过滤掉没有调用属性的节点，`"fromPrice"`然后执行排序。使用该`Node`对象时，我认为您不必调用`ToString()`，只需获取该对象即可`Value`。

让我知道这是如何工作的:-)

# c - 遇到“\n”和scanf问题

> ID：14532335
> 
> 赞同：2
> 
> 时间：2013-01-26T00:12:14.040
> 
> 标签：c, newline, printf, scanf

这是代码

```
 printf("\n");
       printf("Enter a integer vaule:");
       scanf("%d" , &num3);
       printf("You entered: %015d", num3);

       printf("Enter a float value:");
       scanf("%f", &deci3);
       printf("You entered: %15.2f", deci3);
       printf("\n"); 
```

输出是

```
 Enter a integer vaule:4.4
       You entered: 000000000000004
       Enter a float value:You entered:            0.40 
```

问题是这段代码没有停在

```
 printf("Enter a float value:"); 
```

这个scanf

```
 scanf("%f", &deci3); 
```

似乎从之前的 scanf 中获得了它的价值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:18:48.327

转换在整数停止的`%d`地方停止，这是一个小数点。如果你想丢弃那里的输入，明确地这样做......`getc`在循环中`fgets`，等等。这也允许您验证输入。该程序可能应该抱怨`4.4`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:32:14.840

这有效，但如果您为 int 键入 4.4，它不会抱怨

```
#include <stdio.h>

int main() {

char buffer[256];
int i;
float f;

printf("enter an integer : ");
fgets(buffer,256,stdin);
sscanf(buffer, "%d", &i);
printf("you entered : %d\n", i);

printf("enter a float : ");
fgets(buffer,256,stdin);
sscanf(buffer, "%f", &f);
printf("you entered : %f\n", f) ;

return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:57:06.000

该功能按照[规范](http://pubs.opengroup.org/onlinepubs/9699919799/functions/scanf.html)`scanf`以这种方式工作：

> 输入项应定义为输入字节的最长序列（直到任何指定的最大字段宽度，可以根据转换说明符以字符或字节为单位测量），它是**匹配序列的初始子序列。**[强调补充。]

在您的示例中，以下 C 字符串表示第一次调用请求输入时*stdin*的内容： 。`scanf``"4.4\n"`

对于此初始调用，您的格式字符串包含一个说明符`%d`，它表示一个整数。*这意味着该函数将从标准输入*中读取尽可能多的满足整数定义的字节。在您的示例中，这只是`4`，让*stdin*包含`".4\n"`（如果这让您感到困惑，您可能需要检查[什么是整数](http://en.wikipedia.org/wiki/Integer)）。

第二次调用`scanf`不要求用户提供任何额外的输入，因为*标准输入*已经包含`".4\n"`如上所示。使用格式字符串尝试从*stdin*`%f`的当前值读取浮点数。它读取的数字是（根据规范，在大多数情况下忽略空格）。*`.4``scanf``\n`*

 *要完全回答您的问题，问题不在于您在滥用`scanf`，而在于您输入的内容与您期望`scanf`的行为方式之间存在不匹配。

如果你想保证人们不会像那样搞乱输入，我建议使用`strtol`and`strtod`来`fgets`代替。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-05-02T15:15:54.007

在 first 之后使用一个 `fflush(stdin)`函数`scanf()`，这将刷新输入缓冲区。*

# javascript - 全局变量未在函数之间赋值

> ID：14532336
> 
> 赞同：0
> 
> 时间：2013-01-26T00:12:39.727
> 
> 标签：javascript, google-chrome, variables, global

我正在用 HTML/Javascript 编写 Google Chrome 的扩展。我正在尝试使用全局变量在两个函数之间传递信息，但是即使我在一个函数中分配了我的变量，当我从另一个函数中读取它时它也没有改变。

```
 var type = 0; //define global variable
    window.onload=function(){onCreated()}; //set onCreated function to run after loading HTML

    function onCreated()
    {
        chrome.history.search({'text': ''},function(historyItems){gotHistory(historyItems)});//search for historyItems and then pass them to the gotHistory function
    }

    function gotHistory(historyItems)
    {
        var idcount=0;//used to increment the ids of each new element added
        for(var count=0; count < historyItems.length; count++)//go through each history item
        {
            chrome.history.getVisits({'url':historyItems[count].url}, function(visitItems){gotVisits(visitItems)}); //search for visitItems for the url and pass the results to gotVisists function (atm all this function does is assign the global variable to =3)

            var body = document.getElementById("outputid");//find the body of the HTML
            var newt = document.createElement("p");//create a new element
            newt.setAttribute("id","url"+idcount);//give it a unique id

            newt.innerHTML = historyItems[count].title;//set the text to say the title of the url

            if(type != 0)//if the other function was successful, type=3 and the text should be green
            {
                newt.style.color="green";
            }   

            body.appendChild(newt);//add the new element to the body
            idcount++;

        }
    }
    function gotVisits(visitItems)
    {
//assign the global variable to be 3
        type = 3;
    } 
```

但是，元素永远不会是绿色的。它们应该始终是绿色的。这意味着在函数 gotVisits 中，类型未成功分配给 3。谁能解释这里发生了什么？

干杯，

Matt ps 我意识到 gotVisits 函数在这里真的没用，但我用它来说明一点。实际上，我将使用它将有用的信息传回给

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:14:06.990

而不是：

```
var type = 0; 
```

尝试：

```
window.type = 0; 
```

或者，您还可以使用闭包，例如：

```
(function() {

var type = 0;

    var type = 0; //define global variable
    window.onload=function(){onCreated()}; //set onCreated function to run after loading HTML

    function onCreated()
    {
        chrome.history.search({'text': ''},function(historyItems){gotHistory(historyItems)});//search for historyItems and then pass them to the gotHistory function
    }

    function gotHistory(historyItems)
    {
        var idcount=0;//used to increment the ids of each new element added
        for(var count=0; count < historyItems.length; count++)//go through each history item
        {
            chrome.history.getVisits({'url':historyItems[count].url}, function(visitItems){gotVisits(visitItems)}); //search for visitItems for the url and pass the results to gotVisists function (atm all this function does is assign the global variable to =3)

            var body = document.getElementById("outputid");//find the body of the HTML
            var newt = document.createElement("p");//create a new element
            newt.setAttribute("id","url"+idcount);//give it a unique id

            newt.innerHTML = historyItems[count].title;//set the text to say the title of the url

            if(type != 0)//if the other function was successful, type=3 and the text should be green
            {
                newt.style.color="green";
            }   

            body.appendChild(newt);//add the new element to the body
            idcount++;

        }
    }
    function gotVisits(visitItems)
    {
//assign the global variable to be 3
        type = 3;
    }

})(); 
```

这样可以避免污染`window`对象，无论如何都应该避免这样做，并允许内部函数访问`type`变量。

它应该做你想做的事。

您的外部函数包装器`window.onload`也是多余的，只需执行以下操作：

```
window.onload = onCreated; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:21:38.880

它看起来像`chrome.history.getVisits`异步执行回调，所以您首先尝试检查该变量，稍后会更新它。您可以使用一对`console.log`消息来验证这一点。

将其余代码移动到回调中，以便在正确的时间执行。

# c# - 使用选中的项目创建 ToolStripMenuItem

> ID：14532339
> 
> 赞同：1
> 
> 时间：2013-01-26T00:13:00.033
> 
> 标签：c#, toolstrip, toolstripmenu

我需要使用此功能在我的 ToolStripMenuItem 中创建一个项目：如果我选中它，则在应用程序中打开“留在顶部”属性。

我试过这段代码：

```
private void alwaysOnTopToolStripMenuItem_CheckedChanged(object sender, EventArgs e)
    {
        if (alwaysOnTopToolStripMenuItem.Checked)
            fForm1.TopMost = true;
        else
        {
            fForm1.TopMost = false;
        }
    } 
```

但我在 Visual Studio 2010（Windows 窗体）中收到此错误

![在此处输入图像描述](../Images/6ad1816f60b53a36c861a3d757aa6880.png)

我不知道如何解决这个战略问题。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:27:11.833

假设点击处理程序位于以下形式：

```
this.TopMost = alwaysOnTopToolStripMenuItem.Checked; 
```

# g-wan - Get/POST 参数的大小限制？

> ID：14532340
> 
> 赞同：0
> 
> 时间：2013-01-26T00:13:03.653
> 
> 标签：g-wan

我注意到一旦 GET 参数的长度超过 400 字节，或者 POST 参数的长度超过 2000 字节，G-WAN 就会返回 400 错误。有什么办法可以增加限制吗？

当我尝试 csp_entity.html 时，我也会收到 400 错误，因为文件大小小于实体大小限制。（超出预期的413错误文件）

注意：ubuntu 12.10 中最新的 G-WAN。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T07:07:21.730

两个例子正在开发中，一个有流媒体，一个没有。它们都将用于展示如何进行和测试实现的目的。

每个人都有相同的代码库，报告问题（如果有的话）会更容易。

请注意，v4.25 已于今天早上发货。它与 v4.24 所做的事情相同，但 v4.25 更正了一些编译器优化，这些优化在某些平台上为少数用户生成了错误（空文件、空日期）。

# java - java处理大量数据

> ID：14532346
> 
> 赞同：0
> 
> 时间：2013-01-26T00:14:10.173
> 
> 标签：java, large-files

我正在大型数据集上实现聚类算法。数据集位于文本文件中，包含超过 1 亿条记录。每条记录包含 3 个数字字段。

```
1,1503895,4
3,2207774,5
6,2590061,3
... 
```

如果可能，我需要将所有这些数据保存在内存中，因为根据我的聚类算法，我需要随机访问该文件中的记录。因此，我无法按照[在大文件中查找重复项中所述执行任何分区和合并方法](https://stackoverflow.com/questions/9215820/find-duplicates-in-large-file)

这个问题有哪些可能的解决方案？我可以使用像 ehcache 这样的缓存技术吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:23:43.690

3 亿个整数不应该消耗那么多内存。尝试实例化一个包含 3 亿个整数的数组。根据我的计算，在 64 位机器上，大约是 1.2 GB。

# python - Visual Studio 的 Python 工具：将破折号键重新映射为下划线的方法？

> ID：14532350
> 
> 赞同：2
> 
> 时间：2013-01-26T00:14:32.593
> 
> 标签：python, visual-studio-2010, keyboard-shortcuts, keymapping, ptvs

将 Visual Studio 2010 与 Visual Studio 的[Python 工具](http://pytools.codeplex.com/)结合使用。我发现在 python 变量名中输入下划线很不方便。

有没有办法将`-`(dash key) 重新映射到下划线和`Shif+-`(shift + dash) 到破折号？类似于[Emacs 中的 Smart-dash 模式](http://malsyned.net/smart-dash.html)（尽管在处理 python 项目时不需要那么花哨，简单的重新映射就可以了）。我不介意使用 3rd 方工具（例如自动热键）的解决方案，如果这是唯一的方法并且工作得相当好的话。

# javascript - Google 地图图标旋转始终为 200 度

> ID：14532354
> 
> 赞同：0
> 
> 时间：2013-01-26T00:15:06.070
> 
> 标签：javascript, google-maps

尝试旋转图标以指示车辆位置时，我遇到了一些奇怪的问题。我的 json 包含车辆的方位，如果车辆正在移动，则方位被传递到movingVehicle 对象中，然后在创建标记时使用该对象。我遇到的问题是每个标记都在 200 度。我单步执行了代码，看到正确的方位作为图标属性的一部分传递，但在脚本完成并绘制所有标记后，它们都处于 200 度。

有什么明显的吗？

```
var map;
var markersArray = [];

var mapOptions = {
                    zoom: 8,
                    center: new google.maps.LatLng(52.68, -1.26),
                    mapTypeId: google.maps.MapTypeId.ROADMAP
};

var movingVehicle = {
                    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
                    fillColor: "green",
                    fillOpacity: 1,
                    scale: 3,
                    strokeColor: "green",
                    strokeWeight: 1,
                    rotation:0
};

var staticVehicle = {
                    path: google.maps.SymbolPath.CIRCLE,
                    fillColor: "red",
                    fillOpacity: 1,
                    scale: 3,
                    strokeColor: "red",
                    strokeWeight: 5
};

function vehicleState(speed,bearing){
    if (speed){
        movingVehicle.rotation = bearing;
        return movingVehicle;
    }
    else
    {
        return staticVehicle;
    }
};

$(function(){
    map = new google.maps.Map(document.getElementById("mapContainer"), mapOptions);

    $.getJSON( PATH_TO_MY_JSON_WOULD_BE_HERE, function(data) { 
        $.each( data.vehicles, function(i, vehicle) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(vehicle.lat, vehicle.long),
                title:vehicle.vehicle,
                draggable: false,
                map: map,
                icon: vehicleState(vehicle.speed,vehicle.bearing)
            });
            markersArray.push(marker);
        });
    });

}); 
```

示例 json

```
{"vehicle":"xxxxLCJ","time":"2013-01-25T18:33:19","lat":53.47766,"long":-2.335671,"speed":24.5562,"bearing":231},
{"vehicle":"xxxxLCN","time":"2013-01-25T15:07:36","lat":52.45257,"long":1.604016,"speed":36.4176,"bearing":138},
{"vehicle":"xxxxLCP","time":"2013-01-25T23:17:12","lat":53.24011,"long":-0.554743,"speed":0,"bearing":0}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T12:37:57.240

不确定这是否是正确的方法，但通过克隆对象同时决定显示哪个图标来解决。

```
 function Clone(x) {
       for(p in x)
       this[p] = (typeof(x[p]) == 'object')? new Clone(x[p]) : x[p];
    };

    function vehicleState(speed,bearing){
        if (speed){
            var icon = new Clone(movingVehicle);
            icon.rotation = bearing;
            return icon;
        }
        else
        {
            var icon = new Clone(staticVehicle);
            return icon;
        }
    }; 
```

# javascript - 为什么“{} == {}”会导致 SyntaxError？

> ID：14532355
> 
> 赞同：3
> 
> 时间：2013-01-26T00:15:19.163
> 
> 标签：javascript, syntax-error

> **可能重复：**
> [为什么在 JavaScript 中使用 {} != ( {} )？](https://stackoverflow.com/questions/14115902/why-in-javascript)

我今天试了一下，今天它给我抛出了**SyntaxError**，这让我感到奇怪；这有什么问题？

```
{} === {}
{} == {} 
```

怎么了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-26T00:18:54.393

什么时候`{`是一行中的第一个标记，它被认为是块的开始。

```
{
  some();
  statements();
  here();
} 
```

而不是对象文字。代码块不能等于任何东西，它不是可分配的东西。

```
({}) === {} 
```

这将使解析器变直。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T00:18:00.453

使用括号。括号将模棱两可的代码转换为表达式：

```
({}) === ({}) 
```

或者：

```
({} === {}) 
```

# jquery - 防止单击按钮多次附加内容

> ID：14532359
> 
> 赞同：0
> 
> 时间：2013-01-26T00:15:42.417
> 
> 标签：jquery

嗨，我有一个代码可以在叠加层上打开外部链接

```
 $('body').append('<div class="overlay-2"><div class="contentWrap"></div>  </div>');
    $("a.overlay-2[rel]").live('click', function () {
    $("a.overlay-2[rel]").overlay({
        mask: '#333',
        onBeforeLoad: function() {
            var wrap = this.getOverlay().find(".contentWrap");
            wrap.load(this.getTrigger().attr("href"));
        }
    }).load();

    $(this).overlay().load();       
    return false;
}); 
```

这附加了 div 覆盖-contato

第一次点击链接打开一切正常，但每次我关闭覆盖并再次点击代码是多次追加 div 到正文。

按钮代码是

```
 <a href="/php/my-page.php"  class="overlay-2" rel=".overlay-contato">click </a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:18:10.513

只需检查一下您可能要附加的 div 是否首先存在。

```
// note i added an id to the overlay to simplify and improve selector performance
var overlay = $('#overlay');

if(overlay.length < 1) {
  overlay = $('<div id="overlay" class="overlay-2"><div class="contentWrap"></div></div>').appendTo('body');
}

// now you can also use overlay as a variable instead of querying it from the DOM 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:23:20.140

您应该在点击处理程序之外初始化覆盖。每次单击时，您都在创建叠加层的新实例，而您要做的就是显示它

# django - Amazon SQS 和 celery 事件（不是 JSON 可序列化的）

> ID：14532363
> 
> 赞同：2
> 
> 时间：2013-01-26T00:16:18.550
> 
> 标签：django, celery, django-celery, amazon-sqs

我今天正在研究将 Amazon SQS 作为在 EC2 实例上安装我自己的 RabbitMQ 的替代方法。

我已按照[此处所述的文档进行操作](http://docs.celeryproject.org/en/latest/getting-started/brokers/sqs.html)

在一段中它说：

> SQS 还不支持事件，因此不能与 celery 事件、celerymon 或 Django Admin 监视器一起使用。

我有点困惑`events`这里是什么意思。例如，在下面的场景中，我每分钟都有一个周期性任务，我在其中`sendEmail.delay(event)`异步调用。

例如

```
@celery.task(name='tasks.check_for_events')
@periodic_task(run_every=datetime.timedelta(minutes=1))  
def check_for_events():        
    now = datetime.datetime.utcnow().replace(tzinfo=utc,second=00, microsecond=00)
    events = Event.objects.filter(reminder_date_time__range=(now - datetime.timedelta(minutes=5), now))
    for event in events:        
        sendEmail.delay(event)

@celery.task(name='tasks.sendEmail')
def sendEmail(event):
    event.sendMail() 
```

使用 Amazon SQS 运行它时，我收到以下错误消息：

> tasks.check_for_events[7623fb2e-725d-4bb1-b09e-4eee24280dc6] 引发异常：TypeError(' is not JSON serializable',)

那么，这是文档中指出的 SQS 的限制，还是我在做一些根本错误的事情？非常感谢您的建议，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T11:39:28.523

我可能已经找到了解决方案。只需将事件内部的 sendMail() 函数重构为主要任务，因此无需将对象解析为 json：

```
@celery.task(name='tasks.check_for_events')
@periodic_task(run_every=datetime.timedelta(minutes=1))  
def check_for_events():    
    now = datetime.datetime.utcnow().replace(tzinfo=utc,second=00, microsecond=00)
    events = list(Event.objects.filter(reminder_date_time__range=(now - datetime.timedelta(minutes=5), now)))
    for event in events:        
        subject = 'Event Reminder'
        link = None
        message = ... 
        sendEmail.delay(subject, message, event.user.email)

@celery.task(name='tasks.sendEmail')
def sendEmail(subject, message, email):
    send_mail(subject, message, settings.DEFAULT_FROM_EMAIL, [email]) 
```

这适用于 Rabbitmq 和 Amazon SQS

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-21T11:37:51.510

对于返回这篇文章的人，当您的 celery 运行时配置中定义的序列化程序无法处理传递给 celery 任务的对象时，就会发生这种情况。

例如：如果配置将 JSON 作为必需格式并提供了一些 Model 对象，则可能会引发上述异常。

(Q): 是否明确需要定义这些参数 #CELERY_ACCEPT_CONTENT=['json', ], #CELERY_TASK_SERIALIZER='json', #CELERY_RESULT_SERIALIZER='json',

# php - 关于 cassandra 的 Solr 模式设计（无 sql 数据库）

> ID：14532364
> 
> 赞同：1
> 
> 时间：2013-01-26T00:16:19.327
> 
> 标签：php, solr, cassandra

我使用 cassandra 作为数据库，使用 solr 作为索引引擎。我是否需要像在 cassandra 中那样对这些数据进行任何 solr 架构设计？由于我们没有为 cassandra 使用模式并且没有字段类型，因此所有数据都保存为 utf 类型。所以我有点困惑，如果我们需要一个适当的 solr 模式设计，并考虑到 cassandra 中的字段？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T14:49:54.130

是的。与 Cassandra 不同，Solr 需要[模式定义](http://wiki.apache.org/solr/SchemaXml)。将新列插入 Cassandra 列族时，您的触发器必须更新 Solr 模式才能使这些字段可搜索。

回答提问者关于动态字段的以下评论：是的，您可以使用动态字段作为一种机制，将具有特定名称模式的以前未知的列映射到 Solr 索引中的类型。但是（为迂腐道歉），这*是*一个模式定义。

也许它可以实现您在将新列插入 Cassandra 时不必更新 Solr 模式的目标，但它不允许它们具有任意名称，因为 Cassandra 允许。

# scala - 蛋糕模式：每个实现一个组件，还是每个特征一个组件？

> ID：14532368
> 
> 赞同：4
> 
> 时间：2013-01-26T00:16:38.410
> 
> 标签：scala, cake-pattern

我目前正在我的应用程序中使用蛋糕图案。

在我在网上找到的示例中，这些示例是基本的，但不涉及更复杂的需求。我想做的不是那么花哨：我想在一个蛋糕模式应用程序中拥有两个相同类型的服务，使用不同的实现。

```
trait UserServiceComponent {
  self: UserRepositoryComponent =>
  val userService: UserService

  class DefaultUserService extends UserService {
    def getPublicProfile(id: String): Either[Error, User] = userRepository.getPublicProfile(id)
  }

  class AlternativeUserService extends UserService {
    def getPublicProfile(id: String): Either[Error, User] = call webservice here for exemple...
  }
}

trait UserService extends RepositoryDelegator[User] {
  def getPublicProfile(id: String): Either[Error, User]
} 
```

如果我一次使用一个实现，它工作得很好`UserService`，但是如果我同时需要两个实现，我真的不知道该怎么做。

我应该创建 2 个不同的组件吗？每一个都暴露一个不同的 userService 值名称？（默认用户服务/替代用户服务）。对两种实现都使用一个组件我不知道其他组件在使用该名称时如何知道使用了哪个实现，`userService`因为我的应用程序中有 2 个不同的实现。

顺便说一句，由于组件表达了对 的依赖`UserRepositoryComponent`，虽然并非所有实现都需要它，但我觉得只有一个组件有点奇怪，对吧？想象一下，我不想构建需要这两种实现的完整应用程序，但是对于测试，我需要只构建不需要的 AlternativeUserService ，`UserRepositoryComponent`必须提供这种依赖关系会很奇怪，因为它不会用过的。

有人可以给我一些建议，以便我知道该怎么做吗？

相关问题的种类： [蛋糕模式：如何获取组件提供的所有 UserService 类型的对象](https://stackoverflow.com/questions/14532428/cake-pattern-how-to-get-all-objects-of-type-userservice-provided-by-components)

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T12:14:40.480

首先，您应该`UserServiceComponent`从以下实现中解耦`UserService`：

```
trait UserService extends RepositoryDelegator[User] {
  def getPublicProfile(id: String): Either[Error, User]
}

trait UserServiceComponent {
  val userService: UserService
}

trait DefaultUserServiceComponent extends UserServiceComponent { self: UserRepositoryComponent =>
  protected class DefaultUserService extends UserService {
    def getPublicProfile(id: String): Either[Error, User] = userRepository.getPublicProfile(id)
  }
  val userService: UserService = new DefaultUserService
}

trait AlternativeUserServiceComponent extends UserServiceComponent {
  protected class AlternativeUserService extends UserService {
    def getPublicProfile(id: String): Either[Error, User] = call webservice here for exemple...
  }
  val userService: UserService = new AlternativeUserService
} 
```

如果这看起来很冗长，那就是。蛋糕图案不是特别简洁。

但请注意它如何解决您的问题，即`UserRepositoryComponent`即使在实际上不需要时（例如仅使用时`AlternativeUserService`）也存在依赖关系。

现在，在实例化应用程序时，我们所要做的就是混合使用`DefaultUserServiceComponent`或`AlternativeUserServiceComponent`。

如果您碰巧需要访问这两个实现，您确实应该公开两个 userService 值名称。好吧其实是3个名字，比如：

*   `DefaultUserService`实现 的 defaultUserService
*   `AlternativeUserService`用于实现 的替代用户服务
*   任何实现的 mainUserService `UserService`（应用程序在“混合时间”选择哪一个）。

举例：

```
trait UserService extends RepositoryDelegator[User] {
  def getPublicProfile(id: String): Either[Error, User]
}

trait MainUserServiceComponent {
  val mainUserService: UserService
}

trait DefaultUserServiceComponent { self: UserRepositoryComponent =>
  protected class DefaultUserService extends UserService {
    def getPublicProfile(id: String): Either[Error, User] = userRepository.getPublicProfile(id)
  }
  val defaultUserService: UserService = new DefaultUserService
}

trait AlternativeUserServiceComponent {
  protected class AlternativeUserService extends UserService {
    def getPublicProfile(id: String): Either[Error, User] = ??? // call webservice here for exemple...
  }
  val alternativeUserService: UserService = new AlternativeUserService
} 
```

然后你可以像这样实例化你的蛋糕：

```
object MyApp 
  extends MainUserServiceComponent 
  with DefaultUserServiceComponent 
  with AlternativeUserServiceComponent 
  with MyUserRepositoryComponent // Replace with your real UserRepositoryComponent here    
{
  //val userService = defaultUserService
  val mainUserService = alternativeUserService
} 
```

在上面的示例中，明确想要访问 的服务`DefaultUserService`将`DefaultUserServiceComponent`作为其组件的依赖项（与`AlternativeUserService`和相同`AlternativeUserServiceComponent`），而只需要*一些* `UserService`的服务将改为`MainUserServiceComponent`作为依赖项。您在“混合时间”决定哪个服务`mainUserService`指向（这里，它指向`DefaultUserService`实现。

# node.js - 如何向 node.js/express 发送输入流或获取其原始输出流？

> ID：14532373
> 
> 赞同：4
> 
> 时间：2013-01-26T00:17:34.460
> 
> 标签：node.js, stream, express

我在我的快速应用程序中提供了一条路线，该路线提供云文件的内容作为下载。我可以访问云文件的输入流，我想将其直接通过管道传输到响应的输出流中。但是，我使用的是 express，它似乎不支持输入流。

我希望我能做到这一点：

```
res.send (cloudInputStream); 
```

但这不起作用。Express 的发送需要一个正文或一个缓冲区，但显然不是输入流。

既然是这种情况，我想做的是使用 res.setHeader() 设置标头，然后访问原始输出流，然后：

`cloudInputStream.pipe (responseOutputStream);`

这可能吗？

或者，我可以将读取输入流转换为缓冲区，并提供该缓冲区进行发送。但是，这会一次将整个云文件的内容读入内存，我想避免这种情况。

有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-26T08:26:55.503

您所要做的就是`cloudInputStream.pipe(res)`在设置标题之后。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T00:42:16.530

你可以做任何节点可以做的事情。对流使用管道，对标头字段使用 res.set，或使用 res.sendfile。

# php - CGI 和 CLI 之间的 Linux 允许打开文件限制不同

> ID：14532374
> 
> 赞同：1
> 
> 时间：2013-01-26T00:17:36.930
> 
> 标签：php, linux, apache, cgi

通过命令行与通过 apache 运行我的脚本时，我的打开文件限制存在问题。

我的 apache 服务器在用户“apache”下运行，它的限制在`/etc/security/limits.conf`文件中被覆盖，如下所示：

```
apache soft nofile 10240
apache hard nofile 40960 
```

我有一个用于测试的简单脚本：

```
<?php
system('whoami');
system('ulimit -a | grep open'); 
```

当我通过浏览器点击这个脚本时，我得到：

```
apache
open files                      (-n) 1024 
```

但是当我在用户 apache 下的命令行中运行它时，我得到：

```
[reza@app pdf]$ sudo -u apache php script.php
apache
open files                      (-n) 10240 
```

有人可以向我解释什么会导致这种差异吗？

（不确定这是否是 ServerFault 问题，请随意将其移到那里）

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:22:09.270

当您从命令行运行时，适用于 apache 用户的限制。当您点击 Web 服务器时，启动 Web 服务器的环境的限制将适用。您可能希望将`ulimit`语句添加到启动 apache Web 服务器的脚本中。

# windows - 来自 Microsoft 序列化存储 (SST) 文件的 pem 文件

> ID：14532383
> 
> 赞同：3
> 
> 时间：2013-01-26T00:18:25.517
> 
> 标签：windows

我有来自 Microsoft 的 SST 文件，我需要将其添加到 java 信任库。

问题是微软提供的所有工具，将 SST 文件中的证书添加到 Windows 商店，因此很难从 SST 文件中获取 PEM 文件。如果我运行 certmgr.exe（不是 certmgr.msc），我可以获得公钥和所有这些，但没有证书（pem 或 der），我看到一堆 VB 脚本和 powershell 使用 SST 文件将它们加载到 System.Security 中。 Cryptography.X509Certificates.X509Certificate2Collection 对象，但仍然找不到输出为 PEM（或 der ）格式证书的方法。

有什么建议么？

小号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T16:06:49.153

您可以使用 CAPI 将 SST 文件作为证书存储打开，然后枚举文件中的证书。以下代码执行此操作并将 DER 形式的证书输出到使用证书的 SHA1 哈希作为文件名的文件。第一个参数是输出文件夹。剩下的一个或多个参数是您的 SST 文件。

```
 #include <stdio.h>
    #include <tchar.h>

    #include "windows.h"
    #include "wincrypt.h"
    #include "atlbase.h"

    #include <iostream>
    #include <sstream>
    #include <iomanip>
    #include <algorithm>

    std::string GetHexRepresentation(const unsigned char * Bytes, size_t Length)
    {
        std::ostringstream os;
        os.fill('0');
        os<<std::hex;
        for(const unsigned char * ptr=Bytes;ptr<Bytes+Length;ptr++)
            os<<std::setw(2)<<(unsigned int)*ptr;
        std::string retval = os.str();
        std::transform(retval.begin(), retval.end(),retval.begin(), ::toupper);
        return retval;
    }

    BOOL WriteToFileWithHashAsFilename(PCCERT_CONTEXT pPrevCertContext, TCHAR* outputDir)
    {
    #undef RETURN
    #define RETURN(rv) \
    { \
         if( hHash ) CryptDestroyHash(hHash); \
         if( hProv ) CryptReleaseContext(hProv, 0); \
        return rv; \
    } 

         HCRYPTPROV hProv = 0;
         HCRYPTHASH hHash = 0;

         BYTE byteFinalHash[20];
         DWORD dwFinalHashSize = 20;

         if (!CryptAcquireContext(&hProv, NULL, NULL, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))
         {
             std::cout << "CryptAcquireContext failed: " << GetLastError() << std::endl;
             RETURN(FALSE);
         }

         if (!CryptCreateHash(hProv, CALG_SHA1, 0, 0, &hHash))
         {
             std::cout << "CryptCreateHash failed: " << GetLastError() << std::endl;
             RETURN(FALSE);
         }

         if (!CryptHashData(hHash, pPrevCertContext->pbCertEncoded, pPrevCertContext->cbCertEncoded, 0))
         {
             std::cout << "CryptHashData failed: " << GetLastError() << std::endl;
             RETURN(FALSE);
         }

         if (!CryptGetHashParam(hHash, HP_HASHVAL, byteFinalHash, &dwFinalHashSize, 0))
         {
             std::cout << "CryptGetHashParam failed: " << GetLastError() << std::endl;
             RETURN(FALSE);
         }

         std::string strHash = GetHexRepresentation(byteFinalHash, dwFinalHashSize);
         std::wostringstream filename;
         filename << outputDir << strHash.c_str() << ".der" <<std::ends;

         FILE* f = _wfopen(filename.str().c_str(), L"wb+");
         if(!f)
         {
             std::wcout << "Failed to open file for writing: " << filename.str().c_str() << std::endl;
             RETURN(FALSE);
         }
         int bytesWritten = fwrite(pPrevCertContext->pbCertEncoded, 1, pPrevCertContext->cbCertEncoded, f);
         fclose(f);
         if(bytesWritten != pPrevCertContext->cbCertEncoded)
         {
             std::cout << "Failed to write file" << std::endl;
             RETURN(FALSE);
         }

         RETURN(TRUE); 
    }  

    //usage: DumpCertsFromSst <output directory> <SST file 1> ... <SST file n>
    int _tmain(int argc, _TCHAR* argv[])
    {
        SECURITY_ATTRIBUTES sa;   
        memset(&sa, 0, sizeof(SECURITY_ATTRIBUTES));
        sa.nLength = sizeof(SECURITY_ATTRIBUTES);
        sa.bInheritHandle = FALSE;  

        if(argc < 3)
        {
            std::cout << "At least two arguments must be provided: outputDirectory sstFile1 ... sstFileN etc" << std::endl;
            return 0;
        }

        TCHAR* outputDir = argv[1];

        for(int ii = 2; ii < argc; ++ii)
        {
            HANDLE       hFile = NULL;
            HCERTSTORE   hFileStore = NULL;
            LPCWSTR      pszFileName = argv[ii];

            //Open file
            hFile = CreateFile(pszFileName, GENERIC_READ, 0, &sa, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);                      
            if(INVALID_HANDLE_VALUE == hFile)
            {
                std::wcout << "Failed to open file: " << pszFileName  << std::endl;
                continue;
            }
            else
            {
                std::wcout << "Processing file: " << pszFileName  << std::endl;
            }

            //open certificate store
            hFileStore = CertOpenStore(CERT_STORE_PROV_FILE, 0, NULL, CERT_STORE_READONLY_FLAG, hFile);
            if(NULL == hFileStore)
            {
                CloseHandle(hFile);
                continue;
            }

            int count = 0;
            PCCERT_CONTEXT pPrevCertContext = NULL;
            pPrevCertContext = CertEnumCertificatesInStore(hFileStore, pPrevCertContext);
            while(NULL != pPrevCertContext)
            {
                if(WriteToFileWithHashAsFilename(pPrevCertContext, outputDir))
                    ++count;

                pPrevCertContext = CertEnumCertificatesInStore(hFileStore, pPrevCertContext);
            }

            std::wcout << "Wrote " << count << " certificates" << std::endl;
            CloseHandle(hFile);
            CertCloseStore(hFileStore, 0);
        }

        return 1;
    } 
```

# javascript - 使用 Kendo Ui Grid 和 jquery 1.9.2。我无法让模板工作

> ID：14532392
> 
> 赞同：-1
> 
> 时间：2013-01-26T00:19:31.877
> 
> 标签：javascript, asp.net-mvc, telerik, kendo-ui

我正在使用带有 Jquery 1.9.0 的 Kendo UI 版本 v2012.1.322，并且 Kendo Grid 在尝试呈现模板时出现 java 脚本错误，请参阅：http: [//jsfiddle.net/rodneyhickman/bLSbQ/1/](http://jsfiddle.net/rodneyhickman/bLSbQ/1/)切换 jQuery 框架工作从 1.8.3 到 1.9.0 并单击运行以查看脚本错误。

我得到的错误是： Uncaught TypeError: Object [object Object] has no method 'replace'

有什么建议么？

我的标记

```
<div class="assignment-portal-gird-module">
<div class="row-templates">
    <script id="rowTemplate" type="text/x-kendo-tmpl">
        <tr class="assignment-table-row1"> 
            <td class="assignment-table-points-column"><b>${ Points }</b></td>
            <td><b>${ ContactName }</b></td>
            <td><b>${ Title }</b></td>    
            <td><b>${ ProviderName }</b></td>
            <td><b>${ Phone }</b></td>
            <td><b>${ TimeZone }</b></td>
        </tr>
        <tr class="assignment-table-row2">
            <td></td>
            <td colspan="2">
                <span class="assignment-portal-note-label" >Latest Note</span><br/>
                <table  class="assignment-portal-note-table" >
                    <tr>
                        <td>${ LastNoteDate }</td> <td>${ LastNote }</td>
                    </tr>
                </table>
            </td>
            <td colspan="3">
                <span class="assignment-portal-note-label" >Exchange Level</span><br/>
                <b>Eval:</b> ${ HasEval } Touches: ${ Touches } Log-ins: ${ Sessions } ${ LastSessionDate }
            </td>
        </tr>
    </script>
    <script id="altRowTemplate" type="text/x-kendo-tmpl">
        <tr class="assignment-table-row1-alt"> 
         <td  class="assignment-table-points-column"><b>${ Points }</b></td>
            <td><b>${ ContactName }</b></td>
            <td><b>${ Title }</b></td>    
            <td><b>${ ProviderName }</b></td>
            <td><b>${ Phone }</b></td>
            <td><b>${ TimeZone }</b></td>
        </tr>
        <tr class="assignment-table-row2-alt">
            <td></td>
            <td colspan="2">
                <span class="assignment-portal-note-label" >Latest Note</span>
               <table class="assignment-portal-note-table" >
                    <tr>
                        <td>${ LastNoteDate }</td> <td>${ LastNote }</td>
                    </tr>
                </table>
            </td>
            <td colspan="3">
                <span class="assignment-portal-note-label" >Exchange Level</span><br/>
                <b>Eval:</b> ${ HasEval } Touches: ${ Touches } Log-ins: ${ Sessions } ${ LastSessionDate }
            </td>
        </tr>
    </script>
</div>
<div ID="gridAssignments"></div> 
```

我的脚本：

```
jQuery('#gridAssignments').kendoGrid({
    pageable: true,
    scrollable: false,
    rowTemplate: kendo.template($('#rowTemplate').html()),
    altRowTemplate: kendo.template($('#altRowTemplate').html()),
    sortable: true,
    dataSource: {
        data: [{
            Points: 888,
            KlasID: 14926,
            ContactName: 'John Johnson',
            Email: "test@test.com",
            Title: 'Chief Infomration Officer',
            ProviderName: 'West Coast Medical Center',
            ProviderId: 1143,
            Phone: '801-555-1234',
            TimeZone: '(E) 8:32 AM',
            LastNoteDate: '1/25/2013',
            LastNote: 'Sent Email - Requested to setup a call for 8:30 am Friday Feb 1st.',
            HasEval: 'Yes',
            Touches: 2,
            Sessions: '1',
            LastSessionDate: '1/23/2013  5:20 PM'
        }, {
            Points: 5,
            KlasID: 14926,
            ContactName: 'Jane Johnson',
            Email: "test@test.com",
            Title: 'Chief Infomration Officer',
            ProviderName: 'East Coast Medical Center',
            ProviderId: 1143,
            Phone: '801-555-4321',
            TimeZone: '(E) 8:32 AM',
            LastNoteDate: '1/15/2013',
            LastNote: 'Sent Email - Requested to setup a call for 8:30 am Friday Feb 1st. blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah ',
            HasEval: 'No',
            Touches: 3,
            Sessions: '1',
            LastSessionDate: '1/23/2013 8:45 AM'
        }, {
            Points: 18,
            KlasID: 14926,
            ContactName: 'John Doe',
            Email: "test@test.com",
            Title: 'Chief Infomration Officer',
            ProviderName: 'Florida Medical Center',
            ProviderId: 1143,
            Phone: '801-333-4321',
            TimeZone: '(E) 8:32 AM',
            LastNoteDate: '1/1/2013',
            LastNote: 'Sent Email - Requested to setup a call for Blah blah blah blah blah',
            HasEval: 'Yes',
            Touches: 4,
            Sessions: '1',
            LastSessionDate: '1/25/2013 12:04 PM'
        }],
        pageSize: 10
    },
    columns: [{
        width: 45,
        title: "P",
        field: "Points"
    }, {

        title: "Contact",
        field: "ProviderName"
    }, {

        title: "Title",
        field: "Title"
    }, {
        width: 300,
        title: "Provider",
        field: "ProviderName"
    }, {
        width: 120,
        title: "Phone",
        field: "Phone"
    }, {
        title: "Last Note",
        field: "LastNoteDate"
    }, {
        title: "Touches",
        field: "Touches"
    }, {
        width: 120,
        title: "Time Zone",
        field: "TimeZone"
    }]

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T10:20:40.093

KendoUI v2012.1.322 官方**仅支持 jQuery 1.7.1**，您应该将 jQuery 降级到该版本或将 KendoUI 升级到最新版本。

# regex - 在 Excel VBA 中分隔字符串

> ID：14532394
> 
> 赞同：0
> 
> 时间：2013-01-26T00:20:02.173
> 
> 标签：regex, vba, csv, excel

我有一系列（数千个）通话记录，我正在尝试创建一个电子表格。它们都在一个文本文件中。格式如下所示：

```
12/ 13/ 05 Syracuse, NY 10: 22 AM 111- 111- 1111 2 $ - $ - $ -
12/ 13/ 05 New York, NY 10: 28 AM 111- 111- 1111 (F) 2 $ - $ - $ -
12/ 13/ 05 Orlando, FL 10: 48 AM 111- 111- 1111 (F) 4 $ - $ - $ -

3/ 9/ 09 Internal 4: 51 PM 111- 111- 1111 (E) 23 $ - $ - $ -
10/ 14/ 11 Colorado Site 8: 12 AM 111- 111- 1111 14 $ - $ - $ -
1/ 3/ 12 Dept 27 3: 16 PM 111- 111- 1111 (F) 93 $ - $ - $ -

11/ 12/ 12 Internal 3: 13 PM 18765 (E) 16 $ - $ - $ -
11/ 14/ 12 Internal 11: 43 AM John Doe 3 $ - $ - $ - 
```

月/日/年/呼叫城市，州 HH：MM APM 123- 456 7890 OptionalCode $Charge $Tax $Total

这是，减去细节，直接来自文件。字符串周围没有引号，没有制表符。我尝试在列中使用文本，但有些城市确实有空间，而另一些则没有。

有人想指出我正确的方向吗？RegEx 也许（我听说过但从未使用过）？还有什么？

**更新：** 感谢您的早期反馈。该行是我文件中的实际数据，尽管我删除了城市和电话号码。我已经更新了城市信息以显示那里的差异。据我所知，没有一个城市名称有逗号，但我处理的总行数接近 120,000 行，而且显然还没有检查所有行。

显然，这座城市并不总是有空间——上面的雪城没有，但纽约却有。月份和日期也不总是 2 位数字——这也会影响长度检查。不过，我可以先阅读，然后再阅读第二个正斜杠 - 这些是在日期和月份值之后固定的。

括号中的代码并不总是出现......有时它在那里，有时不存在，尽管它们在到达时似乎只是一个字母。

我希望这可以解决一些问题。如果一开始就正确存储，这会容易得多。叹。

**更新 2,3 和 4**根据 Robin 的请求，从通话记录更改中添加了几行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T04:20:45.003

我知道您要求 VBA 解决方案，但我只在带有公式的电子表格中进行通话记录解析。

我在[这里上传了一个工作簿解决方案（版本 3）](https://docs.google.com/file/d/0BzGv4Y7oyJDaWFZpb19pN0lWaVk/edit "下载请点击这里。 然后，在打开的网页中单击“文件”一词并选择“下载”（在底部）。")。

打开工作簿后，将文本文件的内容复制并粘贴到 cell`A2`中。然后根据需要填写范围`B2:X2`。

这些公式适用于月、日、年、城市、州、时间、代码、费用、税金和总额的任何变化。

让我知道是否有任何线路中断。您可以通过使用标题中的自动筛选下拉菜单来选择错误/无关值来轻松检查这些内容。将任何有问题的行附加到您的问题中。

**更新：**

版本 2 处理了 City 字段包含位置名称而 State 字段为空白的情况。

版本 3 处理电话号码字段包含分机号码或姓名的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:58:34.737

如果城市名称中没有逗号，这样的事情可能会起作用。

```
Sub foo()
    thisLine = "12/ 13/ 05 City Name, ST 10: 28 AM 111- 111- 1111 (F) 2 $ - $ - $ -"
    thisDate = Mid(thisLine, 1, 10)
    thisLine = Mid(thisLine, 12)
    firstComma = InStr(1, thisLine, ",")
    City = Mid(thisLine, 1, firstComma - 1)
    thisLine = Mid(thisLine, firstComma + 2)
    State = Left(thisLine, 2)
    thisLine = Mid(thisLine, 4)
    thisTime = Left(thisLine, 9)
    thisLine = Mid(thisLine, 11)
    thisPhone = Left(thisLine, 14)
    thisLine = Mid(thisLine, 16)
    tempArray = Split(thisLine, "$")
    If UBound(tempArray) = 3 Then
    optionalCode = tempArray(0)
    charge = "$" & tempArray(1)
    tax = "$" & tempArray(2)
    Total = "$" & tempArray(3)
    Else
    ' throw an error something went wrong
    End If
End Sub 
```

# html - HTML5 数据列表值与内部文本

> ID：14532398
> 
> 赞同：9
> 
> 时间：2013-01-26T00:20:28.200
> 
> 标签：html, html-datalist

我在 Chrome 和 Firefox 对 HTML5 datalist 元素的处理之间出现了一个问题。

我可能正在滥用它，Firefox 正在以我期望的方式处理它，但 Chrome 不是。我还没有在 Opera 上尝试过。这是一个内部页面，所以我可以控制正在使用的浏览器。

我设置了一个值以及内部文本，如下所示：

```
<input list="Names" placeholder="Enter Name or ID" name="txtSearchValue" autocomplete="off"/>
<datalist id="Names"><%=OptionsList%></datalist> 
```

服务器端值“OptionsList”是从数据库查询中动态构建的。最终结果大致如下所示：

```
<option value="123">Sam's Fresh Sandwiches</option>
<option value="234">Sawatdee</option> 
```

等等

在 Firefox 上，我可以输入字母“S”，然后输入“A”（不区分大小写），上述两个条目都会出现。只要我键入“W”或用鼠标选择 Sawatdee，文本框就会填充 234。这就是我希望发生的事情 - 因为我希望将 234 发送回服务器而不是 Sawatdee。如果我输入“A”然后输入“T”，它也可以工作。

在 Chrome 上，我可以输入我想要的所有字母，但列表中不会出现任何内容。但是，如果我输入 2，则只会出现第二个条目；但在列表中它会显示一个 2，然后是 Sawatdee。

我是过度使用/滥用数据列表还是 Chrome 有问题？或者 Chrome 是否按照技术上应该的方式处理它并且我发现了一个 Firefox 错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T18:38:45.787

我正在尝试做类似的事情。我认为问题在于数据列表没有像下拉选项列表那样工作。一种解决方法是您生成一个 <%=OptionsList%> 和一个数组 <%=OptionListValues %>...所以一旦您在输入中获得文本值，您就可以使用 javascript 在OptionListValues 并将密钥而不是描述发送回服务器。后面的痛苦并在客户端增加了额外的数据负载，尽管我猜你也可以在服务器端执行此操作（在输入中发送文本，然后在服务器端查找文本并获取密钥）。

太糟糕了 Chrome 在这方面不像 FF 那样工作，也许将来浏览器会像 Mozilla 这样工作。

或者你可以做这样的事情。假设您有以下输入/数据列表

```
<input id="datalisttestinput" list="stuff" ></input>
        <datalist id="stuff">
            <option id="3" value="Collin" >
            <option id="5" value="Carl">
            <option id="1" value="Amy" >
            <option id="2" value="Kristal">
        </datalist> 
```

您可以使用 jQuery（或纯 javascript）来挖掘 id 值...这是我的示例，我相信这可以进行一些优化。

```
 function GetValue() {
            var x = $('#datalisttestinput').val();
            var z = $('#stuff');
            var val = $(z).find('option[value="' + x + '"]');
            var endval = val.attr('id');
            alert(endval);
        } 
```

那应该让你继续前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-13T05:56:10.893

稍微修改 infocyde 的答案以使用隐藏字段来包含最终发送到服务器的值。

```
$('#inputStates').change(function(){
    var c =  $('#inputStates').val();
    $('#inputStates').val(getTextValue());
    $('#statesHidden').val(c);
});

function getTextValue(){
  var val =  $('#inputStates').val();
  var states = $('#states');
  var endVal = $(states).find('option[value="' + val + '"]'); 
  //depending on your logic, if endVal is empty it means the value wasn't found in the datalist, you can take some action here
  return endVal.text();  
} 
```

# c++ - C++ 文件 I/O 问题

> ID：14532399
> 
> 赞同：0
> 
> 时间：2013-01-26T00:20:29.977
> 
> 标签：c++, file-io

努比警报。啊。我在`<stdio.h>`使用`<fstream>`. 它们看起来都很笨重且使用起来不直观。我的意思是，为什么 C++ 不能提供一种方法来获取`char*`指向文件中第一个字符的指针？这就是我想要的。

我正在做[Project Euler Question 13](http://projecteuler.net/problem=13)，需要玩 50 位数字。我在文件中存储了 150 个数字`13.txt`，我正在尝试创建一个 150x50 数组，以便我可以直接使用每个数字的数字。但我有很多麻烦。我尝试过使用 C++`<fstream>`库，最近直接`<stdio.h>`完成了它，但我不能点击某些东西。这就是我所拥有的；

```
#include <iostream>
#include <stdio.h>
int main() {

const unsigned N = 100;
const unsigned D = 50; 

unsigned short nums[N][D];

FILE* f = fopen("13.txt", "r");
//error-checking for NULL return

unsigned short *d_ptr = &nums[0][0];
int c = 0;
while ((c = fgetc(f)) != EOF) {
    if (c == '\n' || c == '\t' || c == ' ') {
        continue;
    }   
    *d_ptr = (short)(c-0x30);
    ++d_ptr;
}   
fclose(f);
//do stuff
return 0;
} 
```

有人可以提供一些建议吗？也许是 C++ 人，他们更喜欢哪个 I/O 库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:26:27.863

我会使用 fstream。您遇到的一个问题是，您显然无法将文件中的数字适合任何 C++ 的本机数字类型（double、long long 等）。

将它们读入字符串非常容易：

```
std::fstream in("13.txt");

std::vector<std::string> numbers((std::istream_iterator<std::string>(in)),
                                  std::istream_iterator<std::string>()); 
```

这会将每个数字读入一个字符串，因此第一行中的数字将在 中`numbers[0]`，第二行在 中`numbers[1]`，依此类推。

如果你真的想用 C 语言完成这项工作，它仍然比上面的要容易得多：

```
char *dupe(char const *in) {
    char *ret;
    if (NULL != (ret=malloc(strlen(in)+1))
        strcpy(ret, in);
    return ret;
}

// read the data:
char buffer[256];
char *strings[256];
size_t pos = 0;

while (fgets(buffer, sizeof(buffer), stdin)
    strings[pos++] = dupe(buffer); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:51:04.407

这是一个很好的有效解决方案（但不适用于管道）：

```
std::vector<char> content;
FILE* f = fopen("13.txt", "r");
// error-checking goes here
fseek(f, 0, SEEK_END);
content.resize(ftell(f));
fseek(f, 0, SEEK_BEGIN);
fread(&content[0], 1, content.size(), f);
fclose(f); 
```

这是另一个：

```
std::vector<char> content;
struct stat fileinfo;
stat("13.txt", &fileinfo);
// error-checking goes here
content.resize(fileinfo.st_size);
FILE* f = fopen("13.txt", "r");
// error-checking goes here
fread(&content[0], 1, content.size(), f);
// error-checking goes here
fclose(f); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:37:18.973

与其从文件中读取 100 个 50 位数字，为什么不直接从字符常量中读取它们呢？

你可以开始你的代码：

```
static const char numbers[] = 
 "37107287533902102798797998220837590246510135740250"
 "46376937677490009712648124896970078050417018260538"... 
```

最后一行有一个分号。

# mpi - 与 boost::mpi 发送/接收消息同步？

> ID：14532401
> 
> 赞同：1
> 
> 时间：2013-01-26T00:20:36.423
> 
> 标签：mpi, thread-synchronization, boost-mpi

我用“-np 2”调用 mpirun。我将等级 0 的进程称为“主”，将等级 1 的进程称为“从”。

**目标：**

1.  master 偶尔会向 slave 发送消息，例如`mpi::send(1, UPDATE, data);`. 其他消息类型包括 DIE、COMPUTE ...等。这些消息类型是具有唯一值的常量整数。
2.  slave 运行一个无限循环，“监听”来自 master 的任何消息。当它收到一条消息时，它会向主设备发送一个确认。

**执行：**

从运行：

```
...
int updateData, computeData;
mpi::request updateRequest = world.irecv(0,UPDATE, updateData);    
mpi::request computeRequest = world.irecv(0,COMPUTE, computeData);    

do {
  cerr << "slave ready to take a command" << endl;
  if(updateRequest.test()) {
    cerr << "slave ireceived UPDATE" << endl;
    world.send(0, UPDATE_ACK, 0);
    cerr << "slave sent UPDATE_ACK" << endl;

    /* do something useful 
    ...
    ...
    */

    updateRequest = world.irecv(0, UPDATE, updateData);

  } else if (computeRequest.test()) {
    ...
  } else {
    boost::this_thread::sleep( boost::posix_time::seconds(1) );
  }
} 
```

当主人运行时：

```
...
world.send(1, UPDATE, 10);
cerr << "master sent UPDATE" << endl;
int dummy;
world.recv(1, UPDATE_ACK, dummy);
cerr << "master received UPDATE_ACK" << endl;
... 
```

主代码的更多上下文：

```
...
// update1
world.send(1, UPDATE, params);
cerr << "master sent UPDATE" << endl;
int dummy;
world.recv(1, UPDATE_ACK, dummy);
cerr << "master received UPDATE_ACK" << endl;

// update2
world.send(1, UPDATE2, params2);
cerr << "master sent UPDATE2" << endl;
world.recv(1, UPDATE2_ACK, dummy);
cerr << "master received UPDATE2_ACK" << endl;

// update3
world.send(1, UPDATE3, params3);
cerr << "master sent UPDATE3" << endl;
world.recv(1, UPDATE3_ACK, dummy);
cerr << "master received UPDATE3_ACK" << endl;

...

// training iterations
do {

  mpi::request computeRecvReq1, computeRecvReq2;
  std::map<int, int> result1, result2;

  // for each line in a text file, the master asks the slave(s)
  // to compute two things and aggregates the results
  for(unsigned sentId = 0; sentId != data.size(); sentId++) {

    // these two functions won't return until at least one slave is "idle"
    CollectSlavesWork1(computeRecvReq1, result1);
    CollectSlavesWork2(computeRecvReq2, result2);

    // async ask the slave to compute and async get the results
    world.isend(1, COMPUTE, sentId);
    computeRecvReq1 = world.irecv(1, RESULT1, result1);
    computeRecvReq2 = world.irecv(1, RESULT2, result2);

  }

  // based on the slave(s) work, the master updates params1 
  // and send them again to the slave(s)
  world.send(1, UPDATE, params);
  cerr << "master sent UPDATE" << endl;
  world.recv(1, UPDATE_ACK, dummy);              // PROBLEM HAPPENS HERE
  cerr << "master received UPDATE_ACK" << endl;

} while(!ModelIsConverged())

... 
```

**输出：**

> ...
> 
> 奴隶准备接受命令
> 
> 主发送更新
> 
> 奴隶收到更新
> 
> 从机发送 UPDATE_ACK
> 
> 主控收到 UPDATE_ACK
> 
> 奴隶准备接受命令
> 
> ...
> 
> 奴隶准备接受命令
> 
> 主发送更新
> 
> 奴隶收到更新
> 
> 从机发送 UPDATE_ACK
> 
> 奴隶准备接受命令
> 
> ...

**问题：** 主人第一次发送更新消息时，一切似乎都很好。但是，在第二次中，主服务器没有收到 UPDATE_ACK。

# objective-c - 识别重叠项目

> ID：14532403
> 
> 赞同：1
> 
> 时间：2013-01-26T00:20:38.340
> 
> 标签：objective-c, image, coordinate-systems

我正在用 Objective C 编写应用程序。我有图像从屏幕上掉下来。另一个图像应该捕捉到它。我想要的是确定何时选择了图像。

我打算使用这些代码行：

```
imgCatcher.frame.origin.x, imgProg1.frame.origin.x 
```

在这个方法中：

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
```

那是项目中间的x坐标还是他最左边的坐标？关于这个任务有什么建议吗？最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:51:03.220

x 坐标是框架的左上角。您可以同时使用 x 和 y 坐标来获取确切的左上角点。我也可能只是将整个框架作为一个整体进行比较（如果图像大小不同）。或者当用户触摸图像时，在其中设置某种属性，指示它当前已被选中。

# javascript - facebook黑客杯中的输入

> ID：14532407
> 
> 赞同：-6
> 
> 时间：2013-01-26T00:21:12.547
> 
> 标签：javascript

输入文件是否需要程序直接处理？

在最新的美丽字符串问题中说，

> 5
> 
> ABbCcc
> 
> 祝今年 Facebook 黑客杯好运！
> 
> 请忽略标点符号:)
> 
> 有时测试用例很难弥补。
> 
> 所以我就去咨询 Dalves 教授

我将如何处理它在 javascript 中说的？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:40:02.010

为此，您可以使用[node.js 文件系统 api](http://nodejs.org/docs/latest/api/fs.html)（也可以在 node.js 中编写代码 - 它在 google v8 上，因此对于这个来说应该足够快）

**编辑**

我考虑了您的问题，并且可以更简单地解决（不使用 node.js）向文件发出 AJAX 请求。您可以这样实现：

```
var xmlhttp;
if (window.XMLHttpRequest)
  {   // code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp = new XMLHttpRequest();
  }
else
  {   // code for IE6, IE5
      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    // This logs the input.txt contents in the console.
    // You can do whatever you want with it
    console.log(xmlhttp.responseText);
    }
  }
xmlhttp.open("GET","input.txt",true);
xmlhttp.send();
} 
```

如果您是初学者，您可以在[W3Schools上阅读有关 AJAX 请求的更多内容](http://www.w3schools.com/ajax/default.ASP)

您可以选择更适合您的方法！祝你好运！

# dom - 如何在 DOM 加载后引用动态添加的元素而不需要对任何事件采取行动？

> ID：14532408
> 
> 赞同：5
> 
> 时间：2013-01-26T00:21:14.190
> 
> 标签：dom, reference, jquery, jquery-on

我知道 JQuery 有`.on`并且`.live (deprecated)`可以使用，但是那些假设您想要将事件处理程序附加到动态添加的元素的一个或多个事件，而我没有。我只需要引用它，这样我就可以访问它的一些属性。

更具体地说，有多个像这样的动态元素都带有`class="cluster"`set 并且每个都有不同的值：title 属性、top 属性和 left 属性。

**这些 jquery 选项都不起作用：**

```
var allClusters = $('.cluster');
var allClusters2 = $('#map').children('.cluster');
var allClusters3 = $('#map').find('.cluster'); 
```

同样，我不想附加任何事件处理程序，所以`.on`即使我要劫持它，添加一个虚假事件、一个 doNothing 处理程序，然后只引用我的属性，这似乎也不是正确的解决方案。
一定有更好的解决方案。有任何想法吗？

**更新：**
我错误地说明了标题，因为我的意思是元素是动态添加到 DOM 中的，但不是通过 JQuery。标题已更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:06:50.640

我想到了。元素没有显示，因为**DOM 还没有更新**。

我正在使用 Google Maps 和[MarkerClustererPlus](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/docs/reference.html)来提供更多上下文，当我使用 markerclustererplus 添加地图标记时，它们在添加后的 javascript 代码中不可用。

向我的谷歌地图添加[谷歌地图事件监听](https://developers.google.com/maps/documentation/javascript/reference#MapsEventListener)器解决了这个问题：

```
google.maps.event.addListener(myMarkerClusterer, 'clusteringend', function () {
    // access newly added DOM elements here
}); 
```

添加该侦听器后，上述所有 JQuery 选择器和/或方法都可以正常工作：

```
var allClusters = $('.cluster');
var allClusters3 = $('#map').find('.cluster'); 
```

虽然这个没有，但那是因为它只找到父母的直接后裔：

```
var allClusters2 = $('#map').children('.cluster'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:28:28.397

在ajax回调中做你需要做的事情：

```
$.ajax(...).done(function (html) {
   //append here
   allClusters = $('.cluster');
}); 
```

如果您希望它们分开，您始终可以在事后绑定处理程序，或使用`$.when`：

```
jqxhr = $.ajax(...).done(function (html) { /* append html */ });
jqxhr.done(function () { allClusters = $('.cluster') });
$.when(jqxhr).done(function () { /* you get it */ }); 
```

如果这些是在没有 ajax 更改的情况下附加的，那么只需将`cluster`-finding 代码移动到 DOM 更改发生的位置。

如果这不是一个选项，那么我想你只需要检查一个间隔。

# ruby-on-rails-3 - Rails 3：将 sort_by 转换为延迟加载

> ID：14532409
> 
> 赞同：0
> 
> 时间：2013-01-26T00:21:14.907
> 
> 标签：ruby-on-rails-3, activerecord, lazy-loading

我有一系列用户，他们每个人都发表了许多帖子（并且帖子会收到“视图”），并且我过去以各种方式对它们进行了排序。

例如，以下是浏览次数最多的 8 个用户：

```
@most_viewed = User.sort_by{|user| user.views} 
```

然后在我的模型中，user.rb 文件：

```
def views
    self.posts.sum(:views) || 0
end 
```

这在过去工作得很好。

问题是我的排序使用了 sort_by 方法，它不能很好地与 will_paginate gem 配合使用，因为它返回一个数组而不是关系。

如何在 Rails 3、Active Record 关系、延迟加载样式中执行以下操作？例如，作为命名范围？

*   拥有至少一篇帖子的用户
*   帖子总浏览量最多的用户
*   拥有最多查看次数的帖子的用户（不是总数）
*   拥有最新帖子的用户
*   发帖数最多的用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:32:47.697

您仍然可以对数组进行分页，但您必须要求 'will_paginate/array' 为此，您可以在 config/initializers 目录中创建一个文件（即：“will_paginate_array_fix.rb”）。将此添加为该文件中的唯一行：

```
require 'will_paginate/array' 
```

重新启动您的服务器，您应该能够对普通的 ruby​​ 数组进行分页。

你应该使用 order 方法。这将通过 SQL 执行排序，这首先会提供更好的性能:)

```
User.order("users.views DESC") 
```

或升序

```
User.order("users.views ASC") 
```

这将返回一个关系，因此您可以添加其他内容，例如 where 子句、范围等。

```
User.order("views DESC").where("name like 'r%'") 
```

对于名称以 r 开头的用户的有序列表

访问[http://guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html#ordering)获取官方解释

# javascript - Chrome 浏览器：Facebook API 错误代码：调用请求对话框时出现 191

> ID：14532410
> 
> 赞同：0
> 
> 时间：2013-01-26T00:21:30.757
> 
> 标签：javascript, google-chrome, heroku, apprequests, facebook-app-requests

我正在编写一个使用基本请求对话框的 Facebook 画布应用程序。当我从 index.php 调用它时，该对话框工作正常，但是当我从任何其他文件调用相同的代码时，我得到错误 191。（在我的例子中，代码在 file2.php 中，它是从 index.php 中的表单调用的，并且位于同一目录中）。该错误仅出现在 Chrome 中，而不出现在一切正常的 Firefox 或 IE 中。

用户没有看到请求对话框，而是得到：“API 错误代码：191 API 错误描述：指定的 URL 不属于应用程序错误消息：redirect_uri 不属于应用程序。”

我的配置如下（请注意“https:”和“//”之间没有空格）：

应用程序域：herokuapp.com

托管网址：https://mybrokenapp.herokuapp.com/

网站网址：https://mybrokenapp.herokuapp.com/

画布页面：http://apps.facebook.com/mybrokenapp

画布网址：http://mybrokenapp.herokuapp.com/

安全画布 URL：https://mybrokenapp.herokuapp.com/

页面标签 URL：http://mybrokenapp.herokuapp.com/

安全页面标签 URL：https://mybrokenapp.herokuapp.com/

调用对话框的代码：

```
 FB.ui({method: 'apprequests',
         to: 'nnnnnnnnn',
             message : 'My message',
     show_error: true
            },
            function (response){
              if (typeof response == 'undefined')
        alert('Request failed');
      else if (response == null)
        alert('Request canceled');
      else
                alert('The response was' + response);
            }
           ); 
```

谁能告诉我如何让它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T18:54:29.013

刚刚在我的应用程序中也遇到了这个问题。

转到 Facebook 建议添加的 Channel.html，然后将 javascript 更改为：

```
<script src="https://connect.facebook.net/en_US/all.js#xfbml=1" type="text/javascript"></script> 
```

如果您还没有添加 channel.html，您也可以在头部添加该行。

Chrome 对 HTTPS 的要求比其他浏览器严格得多。

# encryption - RSA Decrypt 为我们返回不同的 byte[] 结果

> ID：14532414
> 
> 赞同：0
> 
> 时间：2013-01-26T00:22:14.217
> 
> 标签：encryption, bytearray, rsa, rijndaelmanaged

[如http://msdn.microsoft.com/en-us/library/vstudio/system.security.cryptography.rsacryptoserviceprovider.encrypt(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/vstudio/system.security.cryptography.rsacryptoserviceprovider.encrypt(v=vs.90).aspx)中所示，我正在尝试使用存储的 RSA 密钥在用户容器中加密和解密存储在 app.config 文件中的 RijndaelManaged 密钥和 IV（在 NT 服务中）。

要创建加密密钥，我执行了以下操作，然后将字符串添加到配置文件

* * *

```
CspParameters cp = new CspParameters();
cp.KeyContainerName = "ContainerName";

// Get the existing or create a new RSA Key

RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(cp);

//Create a new instance of the RijndaelManaged class.

RijndaelManaged RM = new RijndaelManaged();

//Encrypt the symmetric key and IV.

byte[]  EncryptedSymmetricKey = rsa.Encrypt(RM.Key, false);

byte[]  EncryptedSymmetricIV = rsa.Encrypt(RM.IV, false);

string configKey = Convert.ToBase64String(EncryptedSymmetricKey));

string configIV = Convert.ToBase64String(EncryptedSymmetricIV)); 
```

* * *

当我从配置文件中使用 Key 和 IV 时，我执行以下操作：

* * *

```
//Get the existing RSA Key from the USER Container identified by Provider in the appsettings

CspParameters cp = new CspParameters();

cp.KeyContainerName = "ContainerName";

using (RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(cp))
{

    //Decrypt the RijndaelManaged KEY and IV from the config file using the RSA Key

    byte[] Encrypted_RM_Key = Convert.FromBase64String(AppSettings["configKey"]);
    byte[] Encrypted_RM_IV = Convert.FromBase64String(AppSettings["configIV"]);

    byte[] Decrypted_RM_Key = rsa.Decrypt(Encrypted_RM_Key, false);
    byte[] Decrypted_RM_IV = rsa.Decrypt(Encrypted_RM_IV, false);

    //Encrypt the file using RijndaelManaged
    RijndaelManaged RM = new RijndaelManaged();
    RM.Key = Decrypted_RM_Key;
    RM.IV = Decrypted_RM_IV;
    ....

} 
```

* * *

当服务运行时，RM.Key 和 RM.IV 保持不变。如果服务重新启动，RM.IV 和 RM.Key 中生成的字节数组不同，这会导致对在服务重新启动之前加密的数据进行的任何解密尝试失败，并出现 Padding Invalid 错误。

**问题：如果我在配置文件中的相同加密数据上使用相同的 RSA 密钥，为什么重新启动服务时生成的密钥和 IV 值不同？**

注意：如果我解密 OnStart() 服务方法中的值，然后尝试解密已添加到项目中的 dll 中的相同值，也会发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:48:00.743

大胆猜测：您的服务是否以您在容器中存储密钥的用户身份运行？您可以在此过程中添加一些跟踪（或调试），并查看您是否每次都获得相同的 RSA 密钥。

# python - 谷歌日历 - Python - 同步

> ID：14532415
> 
> 赞同：0
> 
> 时间：2013-01-26T00:22:24.983
> 
> 标签：python, google-calendar-api, sync

我一直在研究并且很难弄清楚如何解决我的解决方案。基本上，我的最终目标是能够登录 Google 日历并获取日期事件并使用这些信息。如果可能，可以使用多个帐户。我做了一些研究并且遇到了谷歌自己的 API，但我只是不知道从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:29:06.900

这是 API 文档（带有 python 代码示例）： [https ://developers.google.com/google-apps/calendar/v2/developers_guide_protocol](https://developers.google.com/google-apps/calendar/v2/developers_guide_protocol)

你将需要这个库： [http ://code.google.com/p/gdata-python-client/](http://code.google.com/p/gdata-python-client/)

更具体的你需要使用这个类： [http ://code.google.com/p/gdata-python-client/source/browse/src/gdata/calendar/client.py](http://code.google.com/p/gdata-python-client/source/browse/src/gdata/calendar/client.py)

为了从用户那里获取数据，您需要为每个用户提供 auth_token。

我不确定这个 API 是否允许您使用直接登录而不是 auth_token。

更新：当前 API 版本为 3：[https ://developers.google.com/google-apps/calendar/](https://developers.google.com/google-apps/calendar/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-05T02:27:41.810

**谷歌日历 V3 Python 客户端**

Google Calendar V3 提供了一个 API 客户端，可以使用以下方式进行身份验证：access_token、refresh_token、client_id 和 client_secret

[https://github.com/priyadarshy/google-calendar-v3](https://github.com/priyadarshy/google-calendar-v3)

# php - PHP Preg_replace 似乎对我不起作用

> ID：14532418
> 
> 赞同：1
> 
> 时间：2013-01-26T00:23:07.283
> 
> 标签：php, regex, preg-replace

我有许多文件需要更换零件。这种文件的一个例子是：

```
    u101p-fr-2_2
    PAN，'U101P-FR-2_2'，P，BLO='U101P'，DT=101，X=FR-2，AS4='M'；
    CUR, 'CB1', COL=洋红色, LTY=SOLID, YZ, 6390.45,5985.01/
          0, 7341.23,6752.51/
          0, 7341.22,6752.5/
          R400.01、7489.98、7063.74/
          0, 7489.98,8863.99;
    BOU，'U101P-Y7800'，SID=SB/'U101P-Z8800'，SID=BOT/'CB1'/Z=7063.74；
    PLA，MAT=20，MSI=FOR，QUA=A，POS=179，NO=1，AS4='P'；
    FLA，PRO=10,200,20，CUR，LIM=3，QUA=A，POS=734，NO=1，COL=YELLOW，
          CON=15，CUT=1100，EXC=30/CON=45，CUT=1402,30；
    EXC，TYP=TIP1，LIM=4，M1=30；
    非，R50，COR=2；

```

对于这个特定的示例，我必须将**POS=179**替换为**POS=115**并将**POS=734**替换为**POS=762**。

我可以使用 Notepad++ 来做到这一点：**\bPOS\=179\b** 另外，它似乎可以在不同的网站上使用，比如[http://regexr.com?33hti](http://regexr.com?33hti)

但是，在 PHP 中，使用 preg_replace 它不起作用。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:44:24.170

所以，你最终决定泄露你的代码：

```
foreach (glob($path_SCH_ModelBun.$unitatea."/*.sch") as $filename){ 
  $file = file_get_contents($filename);
  echo "<pre>".$file."</pre><br /><br />";
  $search_for = "/\bPOS".preg_quote("=".$search_for)."\b/g";
  $replace_with= "POS=".$replace_with;
  echo $res = preg_replace($search_for, $replace_with ,$file);
  echo " <pre>".$file."</pre> ";
} 
```

您错误地使用了该`/g`标志。启用[`error_reporting`](http://php.net/error_reporting)以了解您的正则表达式失败的原因。PHPs PCRE 不支持。

您还`$res =`用于分配修改后的文件内容。但是随后您`$file`又将未修改的原件写出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:37:42.730

> 我相信如果我有 POS=2 和 POS=21，例如，它会改变结果

您可以使用[`strtr`](http://php.net/manual/en/function.strtr.php)来避免这种情况：

例子：

```
$string = 'POS 2 POS 21 POS 27 POS 2 POS 21';

print strtr($string, array(
  'POS 27' => 'POS 420',          // find => replace
  'POS 2'  => 'POS 5',
  'POS 21' => 'POS 7',
)); 
```

最长的匹配将首先被替换，因此您不会遇到任何问题。

# ruby-on-rails-3 - 我的文件扩展名在参数列表中的位置

> ID：14532421
> 
> 赞同：2
> 
> 时间：2013-01-26T00:23:31.303
> 
> 标签：ruby-on-rails-3

我正在关注这个答案，同时试图弄清楚如何显示位于我的应用程序目录[Rails 3 中的图像，显​​示来自 RAILS_ROOT 上方本地文件系统的 jpg 图像](https://stackoverflow.com/questions/11959203/rails-3-displaying-jpg-images-from-the-local-file-system-above-rails-root)

我已经创建了一个控制器，如图所示，将该行添加到 routes.rb，并在测试网页中加载使用代码`match`调用的图像`test.jpg`

```
<img src="/serve_image/test.jpg" /> 
```

但是我收到一条错误消息，说`<...>/public/images/test`找不到文件。
然后我去重命名我的图像以便`.jpg`消失，然后脚本找到我的图像并根据需要加载它。

扩展名的任何想法？我不确定如何调试此问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T05:24:08.740

默认情况下，Rails 不匹配动态段中的点。所以对于这条路线：

```
match '/serve_image/:filename' => 'images#serve' 
```

`:filename`只会匹配它找到的第一个点。因此`/serve_image/test.jpg`将与`test`文件名匹配，并认为您期望 JPG 作为响应。您需要做的是告诉路由器您要在文件名中包含点，如下所示：

```
match '/serve_image/:filename' => 'images#serve', :constraints => {:filename => /[^\/]+/} 
```

这将匹配除正斜杠之外的任何内容，为您提供完整的文件名`params[:filename]`

有关更多信息，请参阅[动态段的 Rails 路由指南部分](http://guides.rubyonrails.org/routing.html#dynamic-segments)。

# scala - 蛋糕模式：如何获取组件提供的所有UserService类型的对象

> ID：14532428
> 
> 赞同：3
> 
> 时间：2013-01-26T00:24:29.970
> 
> 标签：scala, cake-pattern

这个问题可以帮助您了解我的需求。 [蛋糕模式：每个实现一个组件，还是每个特征一个组件？](https://stackoverflow.com/questions/14532368/cake-pattern-one-component-per-implementation-or-one-component-per-trait)

我有一个使用多个 UserService 实现的 Scala 应用程序，这些实现将由组件提供？

我想知道另一个组件中是否有一种方法可以“扫描”应用程序，以便我可以检索一组提供实现特征 UserService 的对象的所有组件？这样我就可以遍历我的蛋糕构建应用程序提供的所有 UserService 接口？

我想我可以有一个组件根据它的依赖关系构建一个 UserService 列表，但是是否可以让这个组件在没有任何硬编码依赖关系的情况下构建列表？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T13:42:30.817

您可以简单地将`UserService`实例列表放入`UserServiceComponent`中，并将基址`UserService`寄存器本身放在此列表中。

```
trait UserServiceComponent {
  private val _userServices = collection.mutable.Buffer[UserService]()
  def userServices: Seq[UserService] = _userServices.synchronized {
    _userServices.toList // defensive copy
  }
  private def registerUserService( service: UserService ) = _userServices.synchronized {
    _userServices += service
  }

  trait UserService {
    registerUserService( this )

    def getPublicProfile(id: String): Either[Error, User]
  }

  val mainUserService: UserService
}

trait DefaultUserServiceComponent extends UserServiceComponent { self: UserRepositoryComponent =>
  protected class DefaultUserService extends UserService {
    // NOTE: no need to register the service, this is handled by the base class
    def getPublicProfile(id: String): Either[Error, User] = userRepository.getPublicProfile(id)
  }
  val mainUserService: UserService = new DefaultUserService
} 
```

# web-services - 黑莓App启动Webservice Null

> ID：14532429
> 
> 赞同：0
> 
> 时间：2013-01-26T00:24:30.263
> 
> 标签：web-services, blackberry, blackberry-simulator

在我的应用程序启动后，我有一个版本命中检查。但是当模拟器加载它发送请求和所有这些东西时。在我的应用程序启动后，它会给出版本命中值 NULL，但在我关闭应用程序并再次打开它后，它会给出正确的值。

1）我的问题是为什么会发生这种行为，我应该怎么做应用程序启动和版本检查在第一次尝试时给出正确的值！

2）应用程序甚至没有被用户执行，为什么它的代码行被执行？？？？？？

```
public MyScreen()  { 
    Bitmap bitmap = Bitmap.getBitmapResource("background.png");
    this.getMainManager().setBackground(
            BackgroundFactory.createBitmapBackground(bitmap)); 

    synchronized (Application.getEventLock()) 
    {
        UiApplication.getUiApplication().invokeLater(new Runnable() 
        {
            public void run() 
            {
                Status.show("Please Wait...", Bitmap.getPredefinedBitmap(Bitmap.INFORMATION), 1000);
                LoginScreen();
            }
        }); 
    } 
```

现在它的作用是它只显示背景屏幕并且什么都没有发生没有服务但是当我再次启动它时它可以工作。有什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T10:00:01.637

如果您的`MyScreen`类实际上是一种`Screen`（通过继承），那么在这种情况下您无需同步事件锁。a 的构造函数`Screen`已经在 UI 线程上调用，因此，只需将您的代码简化为：

```
public MyScreen()  { 
    Bitmap bitmap = Bitmap.getBitmapResource("background.png");
    this.getMainManager().setBackground(
            BackgroundFactory.createBitmapBackground(bitmap)); 

    UiApplication.getUiApplication().invokeLater(new Runnable() 
    {
        public void run() 
        {
            Status.show("Please Wait...", Bitmap.getPredefinedBitmap(Bitmap.INFORMATION), 1000);
            LoginScreen();
        }
    }); 
```

此外，您也可以摆脱`invokeLater()`呼叫，留下以下内容：

```
public MyScreen()  { 
    Bitmap bitmap = Bitmap.getBitmapResource("background.png");
    this.getMainManager().setBackground(
            BackgroundFactory.createBitmapBackground(bitmap)); 

    Status.show("Please Wait...", Bitmap.getPredefinedBitmap(Bitmap.INFORMATION), 1000);
    LoginScreen(); 
```

`invokeLater()`如果您只是想`run()`从后台线程安全地启动其方法内的代码，或者如果您想在构造函数完成**后将其排入***队列*以运行，您通常会使用。

 **但是，如果您已经准备好让它立即发生，并且您只是使用该调用来确保

```
 Status.show("Please Wait...", Bitmap.getPredefinedBitmap(Bitmap.INFORMATION), 1000);
 LoginScreen(); 
```

是在 UI 线程上运行的，那么就没有必要了，因为正如我所说，您已经在`MyScreen`构造函数的 UI 线程上。

但是，我也看不到你在`MyScreen`构造函数结束时做了什么，所以 using 可能`invokeLater()`是合适的。

发布更多信息以回应我上面的评论，我会尽力提供更多帮助。**

# c++ - C++ 中的幂函数

> ID：14532432
> 
> 赞同：1
> 
> 时间：2013-01-26T00:24:53.907
> 
> 标签：c++

我正在玩幂函数的实现：

```
#include <iostream>
using namespace std;

int pow(int b, int e)
{
  int result;

  if (e == -1 && b != 0)
  {
    cout << "b = " << 1/b << endl;
    return 1/b;
  }

  else if (b != 0 && e != 0)
  {
    //int e_int(int (e));
    bool e_bool(e < 0);
    e = (e_bool*-e + !e_bool*e);
    result = b = pow(b, -e_bool)*(b*!e_bool + +e_bool);
    cout << endl << "\"result\" = " << result << " " << e << endl;

    for(int i = 1; i < e; i += 1)
    {
      result *= b;
    }
    return result;
  }

  else if (e != 0 && b == 0)
  {
    return 0;
  }

  else if (e == 0 && b != 0)
  {
    return 1;
  }

  else if (b == 1)
  {
    return 1;
  }

  else if (e == 1)
  {
    return b;
  }

  else
  {
    cout << endl << "Error";
    return -1;
  }
}

int main ()
{
  cout << endl << pow(-2, -1);

  return 0;
} 
```

输出[是](http://codepad.org/NMXX1Ejp)：

```
b = 0

0 
```

为什么 b 设置为 0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:28:14.220

整数除法只能产生整数结果。您的程序导致此行：

```
cout << "b = " << 1/b << endl; 
```

运行，如果`b`是任何大于 1 的整数，结果将是`0`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T00:27:51.750

我不会说`b`设置为 0。在你的函数中你有这个语句：

```
cout << "b = " << 1/b << endl; 
```

因为`b`是整数，`1/b`所以是*整数除法*，值最终是`0`。

# java - Java servlet如何转储静态html页面

> ID：14532433
> 
> 赞同：1
> 
> 时间：2013-01-26T00:24:54.387
> 
> 标签：java, servlets

我想从 servlet 转储静态 html 页面。使用 php 我会做类似的事情

```
$dbdiv = <<<XYZ
<div id="mystaticdiv"></div>
</div>; 
```

然后回显 XYZ

这可以用 Java servletsa 完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:30:17.437

使用[`RequestDispatcher#forward()`](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29)或[`include()`](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#include%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29)，具体取决于它是代表完整的还是部分的 HTML 内容。

```
request.getRequestDispatcher("/WEB-INF/some.html").forward(request, response); 
```

*（请注意，HTML 页面被隐藏起来，`/WEB-INF`以防止在不首先调用 servlet 的情况下直接访问）*

# javascript - jQuery TypeError: $("img").draggable(); 不是函数

> ID：14532434
> 
> 赞同：6
> 
> 时间：2013-01-26T00:25:23.407
> 
> 标签：javascript, jquery, html

**您好，在过去的 3 个小时里，我一直遇到此代码的问题，我希望有人能够在这里帮助我。**

**jQuery**

```
$(document).ready(function() { 
$("img").draggable();}); 
```

**HTML 标头**

```
<head>
    <title>Chess</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <link rel="stylesheet" type="text/css" href="reset.css" />
    <link rel="stylesheet" type="text/css" href="default.css"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
    <script type="text/javascript" src="default.js"></script>
</head> 
```

**萤火虫错误**

```
TypeError: $("img").draggable is not a function [Break On This Error] $("img").draggable(); 
```

**我的代码在[codecademy.com](http://www.codecademy.com/)上运行良好，但是当我在 localhost 或我的服务器上尝试时，我不断收到此错误消息。我在这里做错了什么？**

**完整的 HTML**

```
 <!DOCTYPE html>
 <html>
    <head>
        <title>Chess</title>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="reset.css" />
        <link rel="stylesheet" type="text/css" href="default.css"/>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
        <script type="text/javascript" src="default.js"></script>
    </head>
    <body>
     <div id="board">
        <ul id="first_row">
            <li class="white_space"><img src="pieces/Rook_Black.png" /></li>
            <li class="black_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="black_space"><img src="pieces/Rook_White.png" /></li>
        </ul>
        <ul id="second_row">
            <li class="black_space"><img src="pieces/Knight_Black.png" /></li>
            <li class="white_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="white_space"><img src="pieces/Knight_White.png" /></li>
        </ul>
        <ul id="third_row">
            <li class="white_space"><img src="pieces/Bishop_Black.png" /></li>
            <li class="black_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="black_space"><img src="pieces/Bishop_White.png" /></li>
        </ul>
        <ul id="forth_row">
            <li class="black_space"><img src="pieces/Queen_Black.png" /></li>
            <li class="white_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="white_space"><img src="pieces/King_White.png" /></li>
        </ul>
        <ul id="fifth_row">
            <li class="white_space"><img src="pieces/King_Black.png" /></li>
            <li class="black_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="black_space"><img src="pieces/Queen_White.png" /></li>
        </ul>
        <ul id="sixth_row">
            <li class="black_space"><img src="pieces/Bishop_Black.png" /></li>
            <li class="white_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="white_space"><img src="pieces/Bishop_White.png" /></li>
        </ul>
        <ul id="seventh_row">
            <li class="white_space"><img src="pieces/Knight_Black.png" /></li>
            <li class="black_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="black_space"><img src="pieces/Knight_White.png" /></li>
        </ul>
        <ul id="eight_row">
            <li class="black_space"><img src="pieces/Rook_Black.png" /></li>
            <li class="white_space"><img src="pieces/Pawn_Black.png" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="#" /></li>
            <li class="white_space"><img src="#" /></li>
            <li class="black_space"><img src="pieces/Pawn_White.png" /></li>
            <li class="white_space"><img src="pieces/Rook_White.png" /></li>
        </ul>
     </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-26T00:26:24.003

你没有加载 jquery，只有 jquery-ui。jquery 本身不由 jquery-ui 加载，因此您需要 2 个不同的`script`标签。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script> 
```

# c# - AIR NativeProcess 标准输入未连接到应用程序

> ID：14532442
> 
> 赞同：6
> 
> 时间：2013-01-26T00:27:01.877
> 
> 标签：c#, air

我正在编写一个启动 C# 控制台应用程序的 AIR 应用程序，它们需要进行通信。我想为此使用标准输入/标准输出，但我似乎无法让它工作。

当 C# 应用程序从标准输入获得输入时，它应该通过标准输出将其发送回，如果它收到“exit”则退出。我可以从命令行对此进行测试，它可以正常工作。当我从 AIR 发送一个字符串时，我没有收到来自 C# 应用程序的响应。

我在启动 C# 应用程序时发送了一个参数，并且确实得到了响应，因此我的 AIR 应用程序至少能够从标准输出接收消息，它只是标准输入不起作用。当我通过标准输入从 AIR 发送消息时，我收到一个进度事件，当我发送密钥代码时，bytesLoaded = 3，当我发送“exit”命令时，bytesLoaded = 5。

这是 C# 代码：

```
static void Main(string[] args)
{
    if (args.Length > 0)
    {
        Console.WriteLine(args[0]);
    }
    while (true)
    {
        string incoming = Console.ReadLine();
        string outgoing = "received: " + incoming;
        Console.WriteLine(outgoing);
        if (incoming == "exit")
            return;
    }
} 
```

这是 AS3 代码：

```
private function init(e:Event=null):void {
    this.removeEventListener(Event.ADDED_TO_STAGE, init);
    NativeApplication.nativeApplication.addEventListener(Event.EXITING, onAppClose);

    var info:NativeProcessStartupInfo = new NativeProcessStartupInfo();
    var file:File = File.applicationDirectory.resolvePath("test.exe");
    info.executable = file;

    process = new NativeProcess();
    info.arguments.push("native process started");
    process.addEventListener(ProgressEvent.STANDARD_OUTPUT_DATA, onOutputData);
    process.addEventListener(ProgressEvent.STANDARD_ERROR_DATA, onErrorData);
    process.addEventListener(ProgressEvent.STANDARD_INPUT_PROGRESS, onInputProgress);
    process.addEventListener(Event.STANDARD_OUTPUT_CLOSE, onOutputClose);
    process.addEventListener(Event.STANDARD_ERROR_CLOSE, onErrorClose);
    process.addEventListener(IOErrorEvent.STANDARD_ERROR_IO_ERROR, onIOError);
    process.addEventListener(IOErrorEvent.STANDARD_INPUT_IO_ERROR, onIOError);
    process.addEventListener(IOErrorEvent.STANDARD_OUTPUT_IO_ERROR, onIOError);
    stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);

    process.start(info);
}

private function onKeyUp(e:KeyboardEvent):void {
    if (e.keyCode == Keyboard.ESCAPE) 
        process.standardInput.writeUTFBytes("exit\n");
    else {
        var msg:String = e.keyCode + "\n";
        process.standardInput.writeUTFBytes(msg);
    }
}

private function onOutputData(e:ProgressEvent):void {
    var data:String = process.standardOutput.readUTFBytes(process.standardOutput.bytesAvailable); 
    trace("Got: ", data); 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:28:14.450

几个月前我遇到了这个问题，但我从未解决它，因为我只是使用了命令行参数。我刚刚回到它，因为我很想知道发生了什么。

我现在发现以 .NET 3.5 或更早版本为目标可以使其按预期工作。切换回 v4.0，我在标准输入上一无所获。我不确定问题出在哪里，但是如果您可以使用 v3.5，那么它可能是您的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-29T09:18:23.510

如果除了我之外的其他人仍然使用带有 C# 控制台应用程序的 Adob​​e AIR，这里有一个解决问题的方法：

就像@tom-makin 在[链接的答案](https://stackoverflow.com/questions/40228129/adobe-air-nativeprocess-not-sending-input)中指出的那样，您需要创建另一个在 .NET 3.5 上运行的控制台应用程序，然后打开较新的 .NET 控制台应用程序并将输入传递给它。这是我对这样一个应用程序的看法：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Threading;

namespace StdInPiper
{
    class Program
    {
        static void Main(string[] args)
        {
            // Remove the first arg from args, containing the newer .NET exePath.
            string exePath = args[0];
            var tempArgs = new List<string>(args);
            tempArgs.RemoveAt(0);
            string argsLine = "";
            foreach (string arg in tempArgs)
            {
                argsLine = argsLine + " " + arg;
            }
            argsLine = argsLine.Trim();

            var process = new Process();            
            process.EnableRaisingEvents = true;

            process.StartInfo.UseShellExecute = false;            
            process.StartInfo.RedirectStandardOutput = true;
            process.StartInfo.RedirectStandardError = true;
            process.StartInfo.RedirectStandardInput = true;
            process.StartInfo.Arguments = argsLine;
            process.StartInfo.FileName = exePath;

            process.OutputDataReceived += (sender, eventArgs) =>
            {
                Console.Write(eventArgs.Data);
            };

            process.ErrorDataReceived += (sender, eventArgs) =>
            {
                Console.Error.Write(eventArgs.Data);
            };

            process.Exited += (sender, eventArgs) =>
            {
                process.CancelOutputRead();
                process.CancelErrorRead();
                Environment.Exit(Environment.ExitCode);
            };

            process.Start();            
            process.BeginOutputReadLine();
            process.BeginErrorReadLine();                        

            while (true)
            {
                Thread.Sleep(20);
                string line = Console.ReadLine();
                if (line != null)
                {
                    process.StandardInput.WriteLine(line);
                }
            }            
        }
    }
} 
```

# f# - 使用 Clp 作为求解器的 F# 的 LP DSL

> ID：14532450
> 
> 赞同：2
> 
> 时间：2013-01-26T00:28:02.917
> 
> 标签：f#, clr, dsl, linear-programming, clp

由于 Microsoft Solver Foundation 已被弃用，我正在尝试寻找一种替代或合理的方式来创建我自己的 DSL。

我正在寻找的是必不可少的 DSL 来描述 F# 中的 LP，用 Clp 解决它并评估结果。

在我重新发明轮子之前：有人知道已经为 LP 提供了 DSL 的好的库吗？

否则，您将如何在 F# 中构建这样的 DSL？本质上，我希望能够写出类似的东西

```
let xs = createVars 100 in 0..1
let ys = [| 1 .. 100 |]
let f i x = i*x
let lp = 
    minimize sumprod(xs, ys) subjectTo [
      xs.[0] + xs.[1] = 1
      sum(xs) <= 1
      sum({for i in 1..100 -> f i xs.[i]}) <= 100
      // ...
    ]
let solver = Clp()
let result = solver.solve lp 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T09:43:15.970

> 在我重新发明轮子之前：有人知道已经为 LP 提供了 DSL 的好的库吗？

[不，除了Microsoft SolverFoundation](http://blogs.msdn.com/b/lengningliu/archive/2009/09/04/optimization-domain-specific-language-in-f-with-units-of-measure.aspx)本身的 ODSL ，我什么都不知道。

> 否则，您将如何在 F# 中构建这样的 DSL？

1.  决定语言的语法。尽管您想构建内部 DSL，但您必须决定什么是允许的，什么是您的语言无法表达的。

2.  使用[F# 引用](http://msdn.microsoft.com/en-us/library/dd233212.aspx)来获取 AST。为什么需要反思？首先，您创建一堆变量并将它们与浮点常量组合以形成线性约束。稍后，您将使用适当的值填充这些变量。反射允许您创建占位符并稍后计算结果。

3.  在 CLP 中将 AST 转换为线性程序并求解。似乎 CLP 没有 .NET API；您可以通过命令行与求解器进行通信，但它不是很方便和健壮。*在创建 DSL 之前开始构建低级 API 是个好主意。*

4.  （可选）在 F# 3.0 中，您可以为您的 DSL 创建查询语法。你可以看看[一个令人信服的例子](https://github.com/fsharp/fsharp/blob/master/src/fsharp/FSharp.Core/Query.fs)，内置[查询表达式](http://msdn.microsoft.com/en-us/library/vstudio/hh225374.aspx)。

> 由于 Microsoft Solver Foundation 已被弃用，我正在尝试寻找一种替代或合理的方式来创建我自己的 DSL。

无论如何，无国界医生将为您的工作提供有价值的例子。[您可以在此代码库](https://github.com/dungpa/OptQuery)中浏览 ODSL 源代码。实际上，从代码库中您可以看到 ODSL 已经完成了三个第一步。我正在 ODSL 之上构建优化查询语言（步骤 4），并且只完成了表面语法。例如，这个原始示例

```
<@
        let sa = var<Barrel/Day>()
        let vz = var<Barrel/Day>()

        minimise (20.0<Dollar/Barrel> * sa + 15.0<Dollar/Barrel> * vz)

        where
            [
                0.3 * sa + 0.4 * vz >= 2000.<Barrel/Day>;
                0.4 * sa + 0.2 * vz >= 1500.<Barrel/Day>;
                0.2 * sa + 0.3 * vz >= 500.<Barrel/Day>;
                sa <= 9000.<Barrel/Day>;
                vz <= 6000.<Barrel/Day>;
                sa >= 0.<Barrel/Day>;
                vz >= 0.<Barrel/Day>  
            ]
    @> 
```

将转变为

```
opt { let! sa = var<Barrel/Day>()
      let! vz = var<_>()
      assume (0.3 * sa + 0.4 * vz >= 2000.<_>)
      assume (0.4 * sa + 0.2 * vz >= 1500.<_>)
      assume (0.2 * sa + 0.3 * vz >= 500.<_>)
      assume (sa <= 9000.<_> && sa >= 0.<_>)
      assume (vz <= 6000.<_> && vz >= 0.<_>)   
      minimise (20.0<Dollar/Barrel> * sa + 15.0<_> * vz)
    } 
```

如果您有兴趣，我还在[这里翻译了一些 DSL 示例。](https://github.com/dungpa/dsls-in-action-fsharp)

# bash - 将变量存储到磁盘，以便下次运行进程时可以访问它

> ID：14532453
> 
> 赞同：1
> 
> 时间：2013-01-26T00:28:15.030
> 
> 标签：bash, unix

我有一个作为 cron 作业运行的进程，我希望它访问一个变量，该变量在最后一次执行某个操作（删除 db 表上的操作，由上一次运行中的同一作业执行）时存储信息。我知道我可以将时间戳写入文件，但有没有更简单的方法？我相信环境变量在 shell 会话结束时会丢失上下文，我希望进程在会话重新启动时看到该值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:30:31.070

您必须使用环境变量将数据存储在文件中，即使您执行 EXPORT yourvar，您的变量及其数据也将在该会话中可用，如果您重新启动计算机，它将丢失。您可以将该环境变量值存储在 bashrc 文件中，但您必须使用文件。

# matlab - MATLAB 中的矩阵运算

> ID：14532457
> 
> 赞同：2
> 
> 时间：2013-01-26T00:29:01.140
> 
> 标签：matlab, matrix, vectorization

我试图简化我的代码，我遇到了一个小问题。让

```
v  = [1; 2; 3];
a1 = [4; 5; 6];
a2 = [7; 8; 9];
A  = [a1, a2]; 
```

我的目标是计算

```
u = [v.*a1, v.*a2] 
```

只使用`v`一次。这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T00:43:55.213

是的，您可以使用 来执行此操作[`bsxfun`](http://www.mathworks.com/help/matlab/ref/bsxfun.html)，例如：

```
u = bsxfun(@times,A,v); 
```

或者也通过使用`repmat`

```
u= repmat(v,[1 2]).*A; 
```

或者也通过使用`kron`

```
u= kron(v,[1 1]).*A; 
```

或者最后，只使用矩阵乘法：

```
u = v*[1 1].*A; 
```

我敢肯定还有更多的方法，但我会停在这里......

# jquery - 使用 jquery .scroll() 和 scrollTop() 在 Div 中获取高度

> ID：14532461
> 
> 赞同：1
> 
> 时间：2013-01-26T00:29:19.443
> 
> 标签：jquery, infinite-scroll, scrolltop

我有一个可滚动的 div，当滚动到“几乎”底部时，会发出警报。（用于无限 ajax 滚动使用）

所以这是我的代码，代码实际上是有效的，但只有当我粘贴到 Google Chrome 控制台并运行它时。当我在“真实”滚动中测试时不起作用。任何的想法？

```
$('.div').scroll(function(){
  if ($('.div').scrollTop() + $('.div').height() > $('.lists').height() - 50) {
    alert('abc');
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:44:38.800

如果您使用的是ajax，`.scroll`则不会影响div，因为它不会找到它，因为它不存在。相反，委托`.on`：

```
$(document).on('scroll', '.div', function () { 
```

# c++ - pcap_lookupdev 未定义

> ID：14532462
> 
> 赞同：2
> 
> 时间：2013-01-26T00:29:27.520
> 
> 标签：c++, pcap, sniffing, network-security

我正在为 OSX 10.8 开发。我刚刚`libpcap`通过 MacPorts 安装并尝试运行一个简单的设备猎人（下）

```
#include <stdio.h>
#include <pcap.h>

int main(int argc,char *argv[])
{
    char *dev, errbuf[PCAP_ERRBUF_SIZE];

    dev = pcap_lookupdev(errbuf);
    if(dev == NULL)
    {
        fprintf(stderr, "Couldn't find default device: %s\n", errbuf);
        return(2);
    }

    printf("Device %s\n", dev);
    return(0);
} 
```

在尝试使用 g++ 编译时，我得到：

```
 Undefined symbols for architecture x86_64:
  "_pcap_lookupdev", referenced from:
      _main in ccIMp1m2.o 
```

任何有用的建议让我可以真正开始学习这些东西会很棒！我用谷歌搜索了整整 10 到 15 分钟，但在我的设置中找不到太多关于我的特定问题的信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T01:34:21.477

你需要链接`libpcap`。可能`-lpcap`添加到您的编译器命令行中会起作用。如果它安装在某个奇怪的地方（可能是，因为你是从 MacPorts 获得的），你可能需要`-L/path/to/libpcap -lpcap`.

# ios - UILocalNotification - 将 1 添加到当前图标徽章

> ID：14532468
> 
> 赞同：0
> 
> 时间：2013-01-26T00:30:41.327
> 
> 标签：ios, objective-c, notifications, uilocalnotification, badge

所以我有一个 UILocalNotification 设置来更改图标徽章。

```
[myNote setApplicationIconBadgeNumber:[[UIApplication sharedApplication] applicationIconBadgeNumber]+1]; 
```

因此，如果我在设置后不更改徽章编号，它就可以正常工作。如果徽章显示 2，比如说，当我设置通知时，它会在通知消失时变为 3。但是假设我在通知触发之前在应用程序中将其从 2 更改为 5，但在触发时仍将其更改为 3。

我需要它能够将 1 添加到当前徽章编号，而不是我第一次安排通知时徽章显示的编号。例如：如果我安排通知时它是 2，然后在应用程序中将其更改为 5，则通知应该在触发时将其更改为 6。

有没有办法做到这一点？我开始讨厌 UILocalNotification。

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:44:40.503

不幸的是，没有这样的 API。但是，您可以丢弃所有之前的通知并使用更新的徽章编号重新安排它们。但我同意你的观点，本地通知和徽章号码一定会触到砖墙并惹恼你。

# jquery - 用jquery获取垂直滚动条的高度

> ID：14532477
> 
> 赞同：0
> 
> 时间：2013-01-26T00:32:03.330
> 
> 标签：jquery

正在构建一个带有侧边栏的 web 应用程序，我希望侧边栏始终像这样安装在视口中 ![图像1](../Images/6befbdb2c459fc43b65c71a0018ae002.png)

并且在应用程序处于全屏模式时也适合视口。我怎样才能用 jquery 实现这一点。我尝试从文档的高度中减去标题的高度

```
$(document).ready(function() {
        var bodyheight = $('body').height();
        $(".app-sidebar").height(bodyheight);
    });

    // for the window resize
    $(window).resize(function() {
        var bodyheight = $(document).height();
        var header = $('.app-north').innerHeight();
        $(".app-sidebar").height(bodyheight - header);
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:40:36.647

为什么不使用 css position:fixed 并给侧边栏一个 min-height: 100%。使用 jQuery 或 javascript 来调整窗口大小时的 div 大小会非常不稳定。无论如何，要获得视口的高度，您应该使用`$(window).height`而不是`document`. 这是一个应该起作用的功能：

```
var prev,
  const_header_height = $('.app-north').innerHeight(),
  $app_sidebar = $('.app-sidebar'); // get the element first to avoid hitting the DOM each call of resize()

function resize () {
  var curr = $(window).height()
  // only resize if new height is different
  if (curr != prev) {
    $app_sidebar.height(curr - const_header_height);
    prev = curr;
  }
}

$(window).on("resize", resize)
$(document).ready(resize) 
```

# javascript - 如果包含三个版本的 jquery 并在中间包含一个使用 jquery $ 对象的脚本会发生什么

> ID：14532481
> 
> 赞同：2
> 
> 时间：2013-01-26T00:32:23.630
> 
> 标签：javascript, jquery, compilation, interpreter

我遇到了一个问题，我有多个插件在他们的 jquery 版本上发生冲突。现在我搜索了谷歌，我知道你最终应该只使用一个版本的 jquery 并将你的代码更新到那个版本的 jquery。但是，出于好奇，我很想知道当您执行以下操作时会发生什么：

```
<include latest jquery>
<include script that uses jquery>  <---and this jquery code is called back or triggered in some event handler function.. what happens then? what jquery $ version is used? the last jquery object that was added (the 'yet another version of jquery' )
<include some other version of jquery>
<include yet another version of jquery> 
```

使用什么版本的jquery？为什么？究竟发生了什么，每个脚本的加载和执行是如何发生的？它只是调用最新的 jquery 的 $ 别名吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T00:43:08.293

您可以使用 jQuery.noConflict() 来拥有多个版本的 jQuery。只有一个人会使用 $。

例如

```
<script src='jquery-1.3.2.js'></script>
<script>
var jq132 = jQuery.noConflict();
</script>
<script src='jquery-1.4.2.js'></script>
<script>
var jq142 = jQuery.noConflict();
</script> 
```

然后你可以使用 jq142 和 jq132。更多细节[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:37:31.920

当您包含 jQuery 时，它会覆盖该`jQuery`变量。因此，您实际上可以做您所假设的事情，并且它应该可以正常工作，即使使用`$`.

不这样做的原因是因为同时维护多个版本的软件并不好玩，您的客户端必须下载多个版本的 jQuery，并且您对将一些不应该放置的 JS 代码放在哪里有一种奇怪的依赖。那里。尽快从源头解决这个问题（即使用一个版本）。

在行动：http: [//jsfiddle.net/AbAgu/](http://jsfiddle.net/AbAgu/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:52:54.867

这将取决于。脚本将按顺序加载和执行。在中间脚本中立即执行的任何代码都将使用顶部脚本中的 jQuery。任何延迟到以后的代码（例如将由另一个脚本调用的函数定义，或者嵌套在事件处理程序中的函数定义）都将使用加载的最终版本。

如果这不是您想要的行为，您可以使用 jQuery.noConflict()，尽管这可能涉及修改您正在使用的插件以使用正确的版本。

# vba - VBA异常处理失败？

> ID：14532483
> 
> 赞同：2
> 
> 时间：2013-01-26T00:32:34.023
> 
> 标签：vba, outlook, windows-7, outlook-2010

我创建了这个脚本来在收到电子邮件时播放 wav 文件。关键是只在工作时间播放声音。如果在工作时间以外收到电子邮件，则不会播放任何声音。

```
Private Declare PtrSafe Function PlaySound Lib "winmm.dll" _
  Alias "PlaySoundA" (ByVal lpszName As String, _
  ByVal hModule As LongPtr, ByVal dwFlags As Long) As Long

Sub PlayWavFile(WavFileName As String, Wait As Boolean)
    If Dir(WavFileName) = "" Then Exit Sub ' no file to play
    If Wait Then ' play sound synchronously
        PlaySound WavFileName, 0, 0
    Else ' play sound asynchronously
        PlaySound WavFileName, 0, 1
    End If
End Sub

Sub PlayASoundDuringBusinessHours(Item As Outlook.MailItem)

  Dim SecondsSinceMidnight
  Dim SecondsPerHour
  Dim NineOclockAm
  Dim NineOclockPm
  Dim TooEarly
  Dim TooLate

  On Error GoTo ErrHandler:
  SecondsSinceMidnight = Timer
  SecondsPerHour = 60 * 60
  NineOclockAm = SecondsPerHour * 9
  NineOclockPm = SecondsPerHour * 21
  TooEarly = Timer < NineOclockAm
  TooLate = Timer > NineOclockPm

  If Not (TooEarly) And Not (TooLate) Then
    PlayWavFile "c:\windows\media\blahblahblah.wav", False
  End If

ExitProcedure:
  Exit Sub
ErrHandler:
    MsgBox Err.Description, _
    vbExclamation + vbOKCancel, _
    "Error: " & CStr(Err.Number)
    Resume ExitProcedure:
End Sub 
```

我在 Outlook 中有一条规则，它在邮件进入时使用此脚本并且它有效！有一段时间，无论如何。

我不知道问题是什么，但偶尔会在此脚本中发生错误，并且我从 Outlook 中收到一个对话框，显示“规则错误”和“操作失败”。发生这种情况时，使用此脚本的 Outlook 规则将被禁用。

我的异常处理是否不足？什么可能导致此错误，我该如何正确处理？

**更新：**

规则非常基本。它除了执行脚本之外几乎没有什么作用：

```
Apply this rule after the message arrives
on this computer only
run Project.PlayASoundDuringBusinessHours 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T02:11:58.593

Not a direct response to the question but my solution was to switch to ItemAdd.

Examples:

[http://msdn.microsoft.com/en-us/library/office/aa171270(v=office.11).aspx](http://msdn.microsoft.com/en-us/library/office/aa171270(v=office.11).aspx) [http://www.outlookcode.com/article.aspx?id=62](http://www.outlookcode.com/article.aspx?id=62)

# linux - find & sed：删除行

> ID：14532485
> 
> 赞同：-1
> 
> 时间：2013-01-26T00:32:38.107
> 
> 标签：linux, shell

我正在尝试删除 PHP 文件中的某些行。我尝试使用 find、exec 组合：

```
find . -name '*.php' -exec sed '/@category/d' {} \; 
```

但它只打印出文件内容。语法有什么问题吗？或者是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:37:00.563

你可以试试这个命令：

```
find . -name '*.php' -exec sed -i '/@category/d' {} \; 
```

我想你错过了 -i 选项

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:36:51.547

它有效，但可能不是您所期望的。

```
find . -name '*.php' -exec sed -i '/@category/d' {} \; 
```

将杀死有问题的线条。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T00:37:11.143

这应该是 sed 的命令，所以尝试添加 -i ：

`sed -i ".bak" '/culpa/d' test.txt`

`find . -name '*.php' -exec sed -i '/@category/d' {} \;`

答案来源： [Bash - 在文件中查找关键字并删除其行](https://stackoverflow.com/questions/7050717/bash-find-a-keyword-in-a-file-and-delete-its-line)

# c# - 如何通过按下例如 WinForm 中的 StopButton 来停止执行特定方法

> ID：14532487
> 
> 赞同：0
> 
> 时间：2013-01-26T00:32:53.270
> 
> 标签：c#

我有 2 个按钮，第一个按钮名为“Continuous”.. 第二个按钮“Stop”

我想在按下连续按钮时调用一个方法：

```
private void continuous_Click(object sender ,EvantArgs e) 

 {    // how to get stop event

while(!StopEvent) method();

  } 
```

我的问题是：如何通过按停止按钮来停止执行？

# css - 如何将键绑定添加到 gtk3 应用程序？

> ID：14532488
> 
> 赞同：6
> 
> 时间：2013-01-26T00:33:10.270
> 
> 标签：css, c, gtk3

我正在尝试通过 css 将键绑定添加到 gtk3 应用程序。这是我到目前为止所拥有的：

```
// add style provider
GtkCssProvider *css = gtk_css_provider_new();                               
gtk_style_context_add_provider_for_screen(gdk_screen_get_default(),         
        GTK_STYLE_PROVIDER(css), GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);         
gtk_css_provider_load_from_path(css, "bindings.css", NULL); 
```

这是在前一个代码段中加载的“bindings.css”：

```
@binding-set tree-view-bindings {
    bind "j" { "move-cursor" (display-lines, 1) };
    bind "k" { "move-cursor" (display-lines, -1) };
    bind "slash" { "start-interactive-search" () };
}

GtkTreeView {
    color: #F00;
    gtk-key-bindings: tree-view-bindings;
} 
```

颜色设置有效，因此不能完全破坏。但是没有一个键绑定工作。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-21T12:05:34.353

如果我错了，请原谅我，但我相信你把分号放在了错误的地方:)

`@binding-set tree-view-bindings { bind "j" { "move-cursor" (display-lines, 1); } bind "k" { "move-cursor" (display-lines, -1); } bind "slash" { "start-interactive-search" (); } }`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-16T20:23:12.223

它对我有用：

```
treeview { 
  -gtk-key-bindings: tree-view-bindings;
} 
```

所以`GtkTreeView`成为`treeview`和`gtk-key-bindings`成为`-gtk-key-bindings`

评论：

*   要使用正确的选择器，您始终可以使用检查器：启动您的应用程序`GTK_DEBUG=interactive`

# javascript - 将 JavaScript 字符串打印为字符串文字

> ID：14532489
> 
> 赞同：2
> 
> 时间：2013-01-26T00:33:22.113
> 
> 标签：javascript

我试图在 JavaScript 中将字符串打印为字符串文字，以便字符串将完全按照其编写方式打印：

```
printStringLiteral("\n\nHi!");//this prints "Hi!" instead of "\n\nHi!".
                              //What will I need to do in order to print
                              //the string as a string literal instead?

function printStringLiteral(toPrint){
    console.log("\"" toPrint + "\"");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T00:44:59.200

您可以使用 JSON：

```
JSON.stringify(toPrint); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:37:50.433

```
printStringLiteral("\\\n\\\nHi!");

function printStringLiteral(toPrint){
    console.log("\\\"" + toPrint + "\\\"");
} 
```

# java - 无法访问的语句错误

> ID：14532492
> 
> 赞同：0
> 
> 时间：2013-01-26T00:33:52.550
> 
> 标签：java, compiler-errors

为什么我在编译代码时会收到无法访问的语句错误。错误出现在代码的最后一行 ( `System.out`)。它在 main 方法中，我不明白为什么它无法访问。

```
public class Count {

    public static void main(String[] args) {
        Vector numberList = new Vector();
        double randomNum;

        //for loop to get numbers and add to vector
        for (int i = 0; i <= 9999; i++) {
            do {
                randomNum = Math.random();
            } while (randomNum < .01 || randomNum > .99);

            //takes the random number, rounds it, and multiplies it by 100
            //so that the numbers go from 1 to 99
            Math.round(randomNum *= 100);
            //converts the double to an int
            int tempNum = (int) randomNum;
            //the vector is built
            numberList.add(i, tempNum);
        }

        //sorts numbers
        Collections.sort(numberList);

        int count[] = new int[99];

        for (int j = 1;; j++) {
            for (int i = 0; i < 9999; i++) {
                if ((numberList.elementAt(i)) == j) {
                    count[j] += 1;
                }
            }
        }

        System.out.println(count[1]);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:35:02.463

您的外部`for`循环没有结束条件：

```
for(int j=1;;j++){ 
```

`j`将无限增加。您可能正在寻找：

```
for (int j = 0; j < count.length; j++) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:35:29.280

你的 for 循环中没有条件 for(int j=1;;j++){

更像 for(int j=1;j<1000;j++){ 修复它？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:40:29.277

```
if ((numberList.elementAt(i)) == j) 
```

不兼容的操作数类型 Object 和 int。

似乎上面的代码永远不会被执行。

# c++ - 阅读（简单）程序集以查找使用 C++ 模板产生的编译时计算

> ID：14532493
> 
> 赞同：2
> 
> 时间：2013-01-26T00:34:16.980
> 
> 标签：c++, assembly, fortran90

我正在比较 Fortran 90 与 C++ 的演示文稿。`g++`我的比较之一依赖于和为简单程序生成的程序集`gfortran`。

一个例子如下：

```
#include<cstdio> // quick and dirty number formatting

template<int N>
double dot(double x[], double y[]){
  return x[N-1] * y[N-1] + dot<N-1>(x, y);
}

template<>
double dot<1>(double x[], double y[]){
  return x[0] * y[0];
}

int main(){
  double x[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
  double y[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
  printf("x.y = %23.16E\n", dot<10>(x, y));
} 
```

以下汇编程序由`g++ -S -O3 myprogram.cpp`在 OS X 10.7.4 x86_64-apple-darwin11.4.2 上使用 g++ 4.7.2 的命令生成：

```
 .text
    .align 4,0x90
    .globl __Z3dotILi1EEdPdS0_
__Z3dotILi1EEdPdS0_:
LFB2:
    movsd   (%rdi), %xmm0
    mulsd   (%rsi), %xmm0
    ret
LFE2:
    .cstring
LC1:
    .ascii "x.y = %23.16E\12\0"
    .section __TEXT,__text_startup,regular,pure_instructions
    .align 4
    .globl _main
_main:
LFB3:
    leaq    LC1(%rip), %rdi
    subq    $8, %rsp
LCFI0:
    movl    $1, %eax
    movsd   LC0(%rip), %xmm0
    call    _printf
    xorl    %eax, %eax
    addq    $8, %rsp
LCFI1:
    ret
LFE3:
    .literal8
    .align 3
LC0:
    .long   0
    .long   1081610240
    .section __TEXT,__eh_frame,coalesced,no_toc+strip_static_syms+live_support
EH_frame1:
    .set L$set$0,LECIE1-LSCIE1
    .long L$set$0
LSCIE1:
    .long   0
    .byte   0x1
    .ascii "zR\0"
    .byte   0x1
    .byte   0x78
    .byte   0x10
    .byte   0x1
    .byte   0x10
    .byte   0xc
    .byte   0x7
    .byte   0x8
    .byte   0x90
    .byte   0x1
    .align 3
LECIE1:
LSFDE1:
    .set L$set$1,LEFDE1-LASFDE1
    .long L$set$1
LASFDE1:
    .long   LASFDE1-EH_frame1
    .quad   LFB2-.
    .set L$set$2,LFE2-LFB2
    .quad L$set$2
    .byte   0
    .align 3
LEFDE1:
LSFDE3:
    .set L$set$3,LEFDE3-LASFDE3
    .long L$set$3
LASFDE3:
    .long   LASFDE3-EH_frame1
    .quad   LFB3-.
    .set L$set$4,LFE3-LFB3
    .quad L$set$4
    .byte   0
    .byte   0x4
    .set L$set$5,LCFI0-LFB3
    .long L$set$5
    .byte   0xe
    .byte   0x10
    .byte   0x4
    .set L$set$6,LCFI1-LCFI0
    .long L$set$6
    .byte   0xe
    .byte   0x8
    .align 3
LEFDE3:
    .constructor
    .destructor
    .align 1
    .subsections_via_symbols 
```

点积是 385，似乎是在编译时计算的，但我似乎无法找到确切的位置。我怀疑它在以下汇编程序段中的某个地方：

```
 movl    $1, %eax
    movsd   LC0(%rip), %xmm0
    call    _printf
    xorl    %eax, %eax
    addq    $8, %rsp
LCFI1:
    ret
LFE3:
    .literal8
    .align 3
LC0:
    .long   0
    .long   1081610240
    .section __TEXT,__eh_frame,coalesced,no_toc+strip_static_syms+live_support 
```

我（非常、非常有限）对汇编的理解会告诉我，点积是由编译器计算的并放在寄存器（LC0）中。然后指令`movsd LC0(%rip), %xmm0`将值放入字符串中，并调用`printf`生成的格式化字符串。

是这样吗？实际数字 385 是包含在此输出中的某处，还是在其他地方计算的？

谢谢！

# 编辑：

如果有人想知道 gfortran 生成的程序集是什么样子的，我将其附在下面。请注意，即使在编译时已知，并且我使用 Fortran 的内部`dot_product`运算符，生成的程序集也大得多（130 行与 C++ 版本中的 90 行），并且似乎优化器无法减少手术。

程序（请注意，我使用的是内在的内置`dot_product`运算符）：

```
PROGRAM MAIN
  REAL(8), DIMENSION(10):: X = (/1, 2, 3, 4, 5, 6, 7, 8, 9, 10/)
  REAL(8), DIMENSION(10):: Y = (/1, 2, 3, 4, 5, 6, 7, 8, 9, 10/)
  PRINT "(A, E23.16)", "x.y = ", DOT_PRODUCT(X, Y)
ENDPROGRAM MAIN 
```

汇编（gfortran -S -O3 myprogram.cpp 在 OS X 10.7.4 x86_64-apple-darwin11.4.2 上使用 gcc 4.7.2）

```
 .cstring
LC0:
    .ascii "dotproduct-intrinsic.f90\0"
    .const
LC1:
    .ascii "(A, E23.16)"
LC2:
    .ascii "x.y = "
    .text
    .align 4,0x90
_MAIN__:
LFB0:
    leaq    LC0(%rip), %rax
    subq    $504, %rsp
LCFI0:
    movq    %rax, 24(%rsp)
    leaq    16(%rsp), %rdi
    leaq    LC1(%rip), %rax
    movl    $5, 32(%rsp)
    movq    %rax, 88(%rsp)
    movl    $11, 96(%rsp)
    movl    $4096, 16(%rsp)
    movl    $6, 20(%rsp)
    call    __gfortran_st_write
    leaq    16(%rsp), %rdi
    movl    $6, %edx
    leaq    LC2(%rip), %rsi
    call    __gfortran_transfer_character_write
    leaq    8(%rsp), %rsi
    movl    $8, %edx
    movabsq $4645480607818711040, %rax
    leaq    16(%rsp), %rdi
    movq    %rax, 8(%rsp)
    call    __gfortran_transfer_real_write
    leaq    16(%rsp), %rdi
    call    __gfortran_st_write_done
    addq    $504, %rsp
LCFI1:
    ret
LFE0:
    .section __TEXT,__text_startup,regular,pure_instructions
    .align 4
    .globl _main
_main:
LFB1:
    subq    $8, %rsp
LCFI2:
    call    __gfortran_set_args
    leaq    _options.3.1864(%rip), %rsi
    movl    $8, %edi
    call    __gfortran_set_options
    call    _MAIN__
    xorl    %eax, %eax
    addq    $8, %rsp
LCFI3:
    ret
LFE1:
    .const
    .align 5
_options.3.1864:
    .long   68
    .long   1023
    .long   0
    .long   0
    .long   1
    .long   1
    .long   0
    .long   1
    .section __TEXT,__eh_frame,coalesced,no_toc+strip_static_syms+live_support
EH_frame1:
    .set L$set$0,LECIE1-LSCIE1
    .long L$set$0
LSCIE1:
    .long   0
    .byte   0x1
    .ascii "zR\0"
    .byte   0x1
    .byte   0x78
    .byte   0x10
    .byte   0x1
    .byte   0x10
    .byte   0xc
    .byte   0x7
    .byte   0x8
    .byte   0x90
    .byte   0x1
    .align 3
LECIE1:
LSFDE1:
    .set L$set$1,LEFDE1-LASFDE1
    .long L$set$1
LASFDE1:
    .long   LASFDE1-EH_frame1
    .quad   LFB0-.
    .set L$set$2,LFE0-LFB0
    .quad L$set$2
    .byte   0
    .byte   0x4
    .set L$set$3,LCFI0-LFB0
    .long L$set$3
    .byte   0xe
    .byte   0x80,0x4
    .byte   0x4
    .set L$set$4,LCFI1-LCFI0
    .long L$set$4
    .byte   0xe
    .byte   0x8
    .align 3
LEFDE1:
LSFDE3:
    .set L$set$5,LEFDE3-LASFDE3
    .long L$set$5
LASFDE3:
    .long   LASFDE3-EH_frame1
    .quad   LFB1-.
    .set L$set$6,LFE1-LFB1
    .quad L$set$6
    .byte   0
    .byte   0x4
    .set L$set$7,LCFI2-LFB1
    .long L$set$7
    .byte   0xe
    .byte   0x10
    .byte   0x4
    .set L$set$8,LCFI3-LCFI2
    .long L$set$8
    .byte   0xe
    .byte   0x8
    .align 3
LEFDE3:
    .subsections_via_symbols 
```

# 编辑 2

感谢[@JerryCoffin 的回答](https://stackoverflow.com/a/14532584/104427)，我确实能够验证位模式

```
LC0:
    .long   0
    .long   1081610240 
```

在汇编输出中找到对应于数字 385。

我使用了[@JerryCoffin](https://stackoverflow.com/a/14532584/104427)提供的完全相同的程序，即：

```
#include <stdio.h>

    #pragma pack(1)
    struct x {
        long x, y;
    };    

    int main() { 
        x v = {0, 1081610240};

        printf("%f\n", *(double *)&v);
        return 0;
    } 
```

唯一需要注意的是，我必须使用 32 位 target: 来编译它`g++ verification.cpp -m32`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T00:46:57.507

是的——这个：

```
LC0:
    .long   0
    .long   1081610240 
```

是值为 385 ¹的 double 的位模式。所以发生的事情是这样的：

```
LCFI0:
    movl    $1, %eax
    movsd   LC0(%rip), %xmm0
    call    _printf 
```

...正在将该值加载到 XMM 寄存器中，然后调用`printf`以将其打印出来。我不能肯定地说，但如果我不得不猜测，我会说它`1`正在告诉它它正在传递一个要打印的参数。

* * *

¹如果您想验证这一点，请尝试以下操作：

```
#include <stdio.h>

#pragma pack(1)
struct x {
    long x, y;
};    

int main() { 
    x v = {0, 1081610240};

    printf("%f\n", *(double *)&v);
    return 0;
} 
```

当然，正式地说，这是不可移植的，等等，但是在同一台机器上使用相同的编译器，大约 99% 的机会你会得到与我相同的输出 - `385`。

# google-chrome - chrome和safari之间的css不一致

> ID：14532494
> 
> 赞同：0
> 
> 时间：2013-01-26T00:34:31.847
> 
> 标签：google-chrome, safari

我的 CSS 在 Chrome 和 Safari 中正确显示时遇到问题。因为它们都是 webkit 浏览器，所以我不明白为什么。

我的 css 定位和 div 大小在 FireFox 和 Safari 中都能完美显示，但在 chrome 中完全不正常。

我已经尝试过 css reset 但似乎没有任何效果。有任何想法吗？

网站在这里

[www.girlsskateaustralia.com](http://www.girlsskateaustralia.com)

# c++ - 尝试从 c++ linux 执行命令行代码

> ID：14532496
> 
> 赞同：11
> 
> 时间：2013-01-26T00:34:35.473
> 
> 标签：c++, linux, command-prompt

我尝试了以下代码，以从 C++ 代码与命令行进行通信。

```
#include<iostream>
#include<cv.h>

int main()
{
    system("gnome-terminal");
    system("cd");
} 
```

gnome-terminal 命令执行良好。在我关闭终端后，当我期望 cd 执行时，却没有发生。你能帮我指出原因吗？谢谢。我期待该功能使 cmd 进入主目录，但事实并非如此。我在linux下工作

我什至通过删除 gnome 进行了尝试。简单的 cd 不起作用。我在做什么？

如果我尝试 ls，它似乎工作正常！

我的主要目标是打开一个新终端，并通过打开新终端的当前程序在该新终端上执行命令。你能告诉我我怎么能做到这一点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T00:39:50.833

如果您想运行一个程序并在执行下一行之前等待它完成，请查看此页面和此处的示例代码：[http ://www.thegeekstuff.com/2012/03/c-process-control-functions /](http://www.thegeekstuff.com/2012/03/c-process-control-functions/)

但如果你想运行 gnome-terminal 并在新创建的窗口中执行命令，请执行以下操作：

```
system("gnome-terminal -x sh -c 'cd /tmp ; ls -la'"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-26T00:38:33.400

该`system`函数创建一个 shell 子进程来执行指定的命令。

`cd`是一个 shell 命令，它只改变那个 shell 进程的当前工作目录。

所以孩子`cd`可能工作正常，但它对你的 C++ 程序没有影响，这是一个不同的过程。

相反，您可能想查看 Linux 系统调用[`chdir`](http://linux.die.net/man/2/chdir)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:05:53.730

谢谢你的帮助！！此命令从此链接运行得非常好

[https://superuser.com/questions/198015/open-gnome-terminal-programmatically-and-execute-commands-after-bashrc-was-execu](https://superuser.com/questions/198015/open-gnome-terminal-programmatically-and-execute-commands-after-bashrc-was-execu)

```
 gnome-terminal -x sh -c 'command1; command2; exec bash' 
```

我在新窗口中输入了相应的命令。但是要更改shell中的工作目录，我还没有弄清楚。

# c - 保证 C 中 (void*) 数组中的精确数据宽度

> ID：14532498
> 
> 赞同：1
> 
> 时间：2013-01-26T00:34:46.430
> 
> 标签：c, arrays, types

我在 C 中有一个简单的函数，它提供了一个`void*`指向数据数组的指针。我知道这个内存块中每个单独数据点的大小（以字节为单位），并且需要保证我可以修改这个块中的每个数据点，而不会意外改变相邻的数据点。在此示例中，我想将每个值减 1。

所有数据点都是 8 位、16 位或 32 位。

例如：

```
void myFunction(void* data, size_t arraySize, size_t widthPerDataPoint)
{
  if(!data)
    return -1;
  size_t w = widthPerDataPoint;
  int numPoints = arraySize / widthPerDataPoint;
  int i;
  for(i=0; i<numPoints; i++)
  {
    if(w==1)       // 8 bit
      (*((int8_t*)data + i))--;
    else if(w==2)  // 16 bit
      (*((int16_t*)data + i))--;
    else if(w==4)  // 32 bit
      (*((int32_t*)data + i))--;
  }
} 
```

不幸的是，根据 C99 规范，int8_t 等数据类型仅保证其最小大小，而不是**确切**大小。有什么方法可以就地重新转换和修改数据并保证我不会破坏我的阵列或接触相邻的数据点？此外，是否有一种等效的技术可以以某种方式适用于其他数据宽度（即：24 位、60 位等）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:50:12.177

根据定义，将类型指针递增*n*会将其移位`T*`字节。因此，编译器向您保证一致性。不用担心。*`n * sizeof(T)`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T00:50:16.557

`int8_t`保证正好是 8 位，如果`CHAR_BIT==1`，正好是 1 字节。

引用最新 C 标准的[N1570](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)草案，第 7.20.1.1 节：

> typedef 名称**int** *N* **_t**指定宽度为*N*的有符号整数类型，没有填充位，并且是二进制补码表示。因此，**int8_t**表示这种宽度正好为 8 位的有符号整数类型。

`uint8_t`尽管出于您的目的，使用,`uint16_t`等可能更有意义。

如果实现不支持具有所需特性的类型，则不会定义它们；您可以通过检查来检测这一点，例如：

```
#include <stdint.h>
#ifdef UINT8_MAX
/* uint8_t exists */
#else
/* uint8_t doesn't exist */
#endif 
```

（如果`CHAR_BIT != 8`，那么既不`int8_t`也`uint8_t`不会被定义。）

它是标准只保证最小尺寸的`[u]intleast_N_t`和`[u]intfast_t`类型。

您必须保证数组和其中的偏移量都针对您用来访问它的类型正确对齐。我想你已经在处理这个问题了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T00:50:04.313

该代码似乎并非完全不合理。我个人可能会做这样的事情：

```
 switch(widthPerDataPoint)
 {
    case 1:
       {
          int8_t *dptr = data;
          for(i = 0; i < numPoints; i++)
             dptr[i]--;
       }
       break;
    case 2:
       {
          int16_t *dptr = data;
          for(i = 0; i < numPoints; i++)
             dptr[i]--;
       }
       break;

    case 4:
       {
          int32_t *dptr = data;
          for(i = 0; i < numPoints; i++)
             dptr[i]--;
       }
       break;

    default:
       fprintf(stderr, "Someone gave the wrong width - width=%d\n", 
               widthPerDatapoint);
       break;
} 
```

这里的好处是你不会在每个循环中得到一堆条件。无论如何，编译器可能会对其进行排序，但我并不总是相信编译器会解决这些问题——而且我认为它也更简洁一些。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-26T00:53:10.470

下面的呢？

1.  将值复制到任何大小的本地 int

2.  对局部变量执行减量

3.  使用适当的位掩码将数组中的位置清零（例如，~0xFF 表示 8 位）

4.  '和' 将局部变量放回数组中。*

# kendo-ui - 带有列表视图的 kendoGrid 弹出编辑器

> ID：14532500
> 
> 赞同：1
> 
> 时间：2013-01-26T00:35:10.197
> 
> 标签：kendo-ui, kendo-grid

这里有剑道 UI 的新手，感谢您的帮助。网格弹出编辑器窗口中的选定列表视图出现问题。

它显示并且是可选择的，但我无法将选定的列表视图数据发送到 JSON 字符串

发送到服务器的 json 字符串：

```
{"blog"=>{"id"=>"", "title"=>"New title", "content"=>"New content", "published"=>"", "img_name"=>""}} 
```

我的代码，kendo-grid 和 kendo-listview：

```
<script type="text/x-kendo-tmpl" id="image_template">
  <div class="product">
    <img src="/assets/blog/${img_name}" width="100" />
  </div>
</script>

<!-- popup editor template -->
<script id="popup_editor" type="text/x-kendo-template">
  <form class="form-horizontal">
    <div class="control-group">
      <label class="control-label" for="title">Title</label>
      <div class="controls">
        <input type="text" id="title" name="Title" data-bind="value:title">
      </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="published">Published</label>
      <div class="controls">
        <input type="checkbox" id="published" data-bind="checked: published" />
      </div>
    </div>
    <textarea id="editor" name="content" data-bind="value:content"></textarea>

    <div id="listView"></div>
    <div class="control-group">
      <label class="control-label" for="img_name">Image Name</label>
    <div class="controls">
    <input type="text" id="img_name" name="img_name" data-bind="value: img_name"/>
    </div>
        </div>
  </form>
</script>

<script>
    $(document).ready(function () {
        var crudServiceBaseUrl = "/posts";
        var blogimages = [
                    { "img_name": "image_one.jpg"},
                    { "img_name": "image_two.jpg"},
                    { "img_name": "image_three.jpg"},
                    { "img_name": "image_four.jpg"},
                    { "img_name": "image_five.jpg"}
        ];
        imageSource = new kendo.data.DataSource({
            data: blogimages
        });
        imageSource.read();

        dataSource = new kendo.data.DataSource({
            transport: {
                read:  {
                    url: crudServiceBaseUrl,
                    dataType: "json"

                },
                update: {
                    url: function(posts) {
                        return crudServiceBaseUrl + "/" + posts.id;
                    },
                    dataType: "json",
                    contentType: "application/json",
                    type: "PUT"
                },
                destroy: {
                    url: function(posts) {
                        return crudServiceBaseUrl + "/" + posts.id
                    },
                    dataType: "json",
                    type: "DELETE"
                },
                create: {
                    url: crudServiceBaseUrl,
                    dataType: "json",
                    contentType: "application/json",
                    type: "POST"
                },
                batch:false,
                parameterMap: function(posts, type) {
                    if (type === "create") {
                        return JSON.stringify({ post: posts });
                    }
                    else if(type === "update") {
                        return JSON.stringify({ post: posts }, replacer);
                    }
                }
            },

            pageSize: 10,
            schema: {
                model: {
                    id: "id",
                    fields: {
                        title: { editable: true, defaultValue: "New title" },
                        content: { editable: true, defaultValue: "New content" },
                        published: {editable: true},
                        img_name: {editable: true}
                    }
                }
            }
        });

        $("#grid").kendoGrid({
            dataSource: dataSource,
            editable: true,
            navigatable: true,
            sortable: {
                mode: "single",
                allowUnsort: false
            },
            pageable: true,
            selectable: "row",
            height: 490,
            toolbar: ["create"],
            editable: {
                mode: "popup",
                template: $("#popup_editor").html()
            },
            edit: function(e) {
                $("#editor").kendoEditor({
                    tools: [
                        "bold",
                        "italic",
                        "underline",
                        "justifyLeft",
                        "justifyCenter",
                        "justifyRight",
                        "justifyFull"
                            ]
                });
                $("#listView").kendoListView({
                    dataSource: imageSource,
                    selectable: "multiple",
                    change: onChange,
                    template: kendo.template($("#image_template").html())
                }).data("kendoGrid");

            },
            save: function(e) {

            },

            columns: [
                { field: "title",title:"Title", width: "25%" },
                { field: "created_at", title:"Created", width: "20%" },
                { field: "updated_at", title:"Updated", width: "20%" },
                { field: "published", title:"Published", width: "10%" },
                { command: ["edit", "destroy"], title: "&nbsp;", width: "20%" }]
        });

        function onChange() {
            var index = this.select().index();
            var dataItem = this.dataSource.at(index);
            $('#img_name').val(dataItem.img_name);
        }
    replacer = function(key, value){
        if (key=="id"||key=="created_at"||key=="updated_at"){
            return undefined;
        }else{
            return value;
        }
    }
});
</script>
<style scoped>
    .product
    {
        float: left;
        width: 100px;
        height: 60px;
        margin: 5px;
        padding: 5px;
        border: 1px solid #cccccc;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
        background-image: none;
        cursor: pointer;
        overflow: hidden;
    }
    .product img
    {
        float: left;
        width: 100px;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;

    }
    .k-listview:after
    {
        content: ".";
        display: block;
        height: 0;
        clear: both;
        visibility: hidden;
    }
    .k-listview
    {
        border: 0;
        padding: 0 0 20px 0;
        min-width: 0;
    }
</style> 
```

我可以通过输入文本成功发送img_name数据

```
<input type="text" id="img_name" name="img_name" data-bind="value: img_name"/> 
```

但是我无法使用 listview 中的 onChange 函数对其进行更改

对此有什么想法吗？

# php - DateTime 类的对象无法转换为字符串

> ID：14532501
> 
> 赞同：0
> 
> 时间：2013-01-26T00:35:11.010
> 
> 标签：php, sql-server, datetime

我正在尝试从 mssql 服务器表中提取数据以使用 php 在网页中打印 html 表，我拉下的数据是“DateTime”列，当我运行脚本时，我收到错误消息“类 DateTime 对象不能转换为字符串"

以下是我的脚本。谁能指出我正确的方法？非常感谢你。

```
$sql = "SELECT  DateCreated FROM Item WHERE Inactive = '0' ";

$stmt = sqlsrv_query( $conn, $sql );
if( $stmt === false) {
    die( print_r( sqlsrv_errors(), true) );
}

while( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC) ) {
   $html_table = '<table border="1" cellspacing="0" cellpadding="2">';
  $html_table .= '<tr><td width="100" align="center">' .$row['DateCreated'].'</td></tr>';

$html_table .= '</table>'; 
echo $html_table;  

}
sqlsrv_free_stmt( $stmt); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:45:01.343

一种方法是让 SQL 引擎本身在您的第一行代码中返回一个字符串值。 *在 PHP 端转换可能有更多的性能方法，但我对这方面的工作不太好。*

```
$sql = "SELECT CONVERT(varchar(10), DateCreated, 101) AS DateCreatedString 
FROM Item WHERE Inactive = '0' "; 
```

您可以使用[microsoft 的本指南](http://technet.microsoft.com/en-us/library/ms187928.aspx)中的第三个参数修改许多其他日期格式标准。我使用的 101 以 mm/dd/yyyy 格式返回日期，但实际上可以使用其他代码之一返回太阳下的每种格式，包括时间、月份名称、世纪、毫秒等。

# html - Jabref 自定义导出到 html 不起作用

> ID：14532507
> 
> 赞同：1
> 
> 时间：2013-01-26T00:36:20.610
> 
> 标签：html, linux, export, bibtex

我正在尝试将我的条目从 jabref 数据库导出到 html 文件。我去了“管理自定义导出”并添加了主布局文件以及开始和结束文件所在的目录。布局文件如下所示：

newHtmlBib.begin.layout：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<title>JabRef References output</title>
<style type="text/css">
body { font-size: 100%; font-family: Arial, sans-serif; }
</style>
</head>
<body> 
```

newHtmlBib.layout：

```
<p>\begin{author}<b>\format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer,HTMLChars]{\author}\end{author}</b>&nbsp;\begin{year}<b>\year</b>\end{year}.&nbsp;&nbsp;&nbsp;&nbsp;\begin{title}\format[HTMLChars]{\title}\end{title}.\begin{editor}
In \format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer,HTMLChars]{\editor} <i>(ed.)</i>\end{editor}\begin{chapter}
\format[HTMLChars]{\chapter}\end{chapter}\begin{journal}
<em>\format[HTMLChars]{\journal}, </em>\end{journal}
\begin{booktitle}<i>\format[HTMLChars]{\booktitle}</i>\end{booktitle}
\begin{school}<em>\format[HTMLChars]{\school}, </em>\end{school}\begin{institution}<em>\format[HTMLChars]{\institution}, </em>\end{institution}\begin{publisher}<em>\format[HTMLChars]{\publisher}, </em>\end{publisher}\begin{volume}<i>, \volume</i>\end{volume}\begin{pages}, \format[FormatPagesForHTML]{\pages}\end{pages}
</p> 
```

newHtmlBib.end.layout：

```
</body>
</html> 
```

但是，在导出我的条目后，这就是我得到的：

```
<!DOCTYPE HTML>
<html>
<head>
<title>JabRef references</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
body { font-size: 12px; font-family: Arial, sans-serif; }
dt { margin-top: 1em; font-weight: bold; }
@media print {
dt { page-break-after: avoid; }
dd { page-break-before: avoid; }
}
</style>
</head>
<body>
<dl>
<dt>inproceedings <a name="Barzdicnvs2008">(Barzdicnvs2008)</a></dt>
<dd>B&#257;rzdi&#326;&#353;, G., Gr&#363;z&#299;tis, N., Ne&#353;pore, G., Saul&#299;te, B., Auzicdna, I. and Lev&#257;ne-Petrova, K.</dd>
<dd><i>Multidimensional Ontologies: Integration of Frame Semantics and Ontological Semantics</i></dd>
<dd>Proceedings of the XIII Euralex International Congress</dd>
<dd><b>2008</b>, pp. 277-283</dd>

<dt>incollection <a name="Carbonell1982">(Carbonell1982)</a></dt>
<dd>Carbonell, J. G.</dd>
<dd><i>Metaphor: An inescapable phenomenon</i></dd>
<dd>Lehnert, W. G. &amp; Ringle, M. H. <i>(ed.)</i></dd>
<dd>Strategies for Natural Language Processing</dd>
<dd>Erlbaum, <b>1982</b>, pp. 415-434</dd>

<dt>inproceedings <a name="Carbonell1980">(Carbonell1980)</a></dt>
<dd>Carbonell, J. G.</dd>
<dd><i>Metaphor-- a key to extensible semantic analysis</i></dd>
<dd>ACL Proceedings, 18th Annual Meeting</dd>
<dd><b>1980</b>, pp. 17-21</dd>

<dt>unpublished <a name="Tewari2003">(Tewari2003)</a></dt>
<dd>Tewari, A.</dd>
<dd><i>Detecting metaphors involving motion verbs in online business news sources</i>  </dd>
<dd><b>2003</b></dd>

</dl>
</body>
</html> 
```

在我看来，某些默认导出过滤器正在覆盖我的自定义过滤器。我希望得到的是一个 html 文档，其中的条目如下所示：

```
<a name="Carbonell1980">(Carbonell1980)</a>
<dd>Carbonell, J. G.</dd>
<dd><i>Metaphor-- a key to extensible semantic analysis</i></dd>
<dd>ACL Proceedings, 18th Annual Meeting</dd>
<dd><b>1980</b>, pp. 17-21</dd>

<a name="Tewari2003">(Tewari2003)</a>
<dd>Tewari, A.</dd>
<dd><i>Detecting metaphors involving motion verbs in online business news sources</i></dd>
<dd><b>2003</b></dd> 
```

关于我导出时发生了什么的任何想法？

我对 Linux 和 Jabref 都很陌生，所以也许（希望）这很容易......

谢谢！！

# android - 如何使用 MediaExtractor 和 MediaCodec 设置流式音频？

> ID：14532511
> 
> 赞同：5
> 
> 时间：2013-01-26T00:37:11.893
> 
> 标签：android, media-player, android-mediaplayer

我正在尝试流式传输传入的 AMR_NB。我不能直接使用 MediaPlayer，因为它需要一个可搜索的文件。我想使用 MediaCodec，但要使用我需要的 MediaCodec（我想......请纠正我！） MediaExtractor 给我诸如presentationTime之类的东西。真的吗？我可以在没有 MediaExtractor 的情况下使用 MediaCodec 吗？

MediaExtractor 似乎需要可搜索的文件。该文档仅针对其中一个 setDataSource 操作特别说明了这一点，但是当我尝试使用其他任何操作时，由于查找尝试失败而失败。

那么，我该怎么做才能播放传入的 AMR 流？我知道一种方案，您可以将传入的数据保存到文件中并定期制作该文件的副本以提供给 MediaPlayer，但我真的更愿意找到一个真正诚实的流媒体解决方案。

是否可以在不使用 MediaExtractor 的情况下使用 MediaCodec？如果是这样，我如何找到演示时间和传递给 MediaCodec.createDecoderByType 的字符串？文档说“audio/3gpp”是我想要的，但是当我尝试使用它时，我收到以下错误：

```
codec = MediaCodec.createDecoderByType("audio/3gpp");

01-02 03:59:36.980: E/OMXMaster(21605): A component of name 'OMX.qcom.audio.decoder.aac' already exists, ignoring this one. 
```

所以我也不确定如何使用 MediaCodec。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T23:56:56.857

“我不能直接使用 MediaPlayer，因为它需要一个可搜索的文件” 这通常不是真的。我希望你在你的直播中试一试，并准确报告会发生什么。

“我可以在没有 MediaExtractor 的情况下使用 MediaCodec 吗？” 我对此表示怀疑：我相信它们是为一起使用而设计的。

我已经使用这些组件来播放流。但是，MediaExtractor 具有未记录的限制（据我所知）。所以使用一个小的代理服务器来提供它可以消化的东西。我有 1 个线程来运行 MediaExtractor，另一个线程从 MediaCodec 获取输出。然后我必须避免死锁并应对同步。但如果你只想打前锋，这还不错。那么你只有如何停止的问题！

我建议您先尝试 MediaPlayer。否则，如果您有足够的热情尝试使用 MediaExtractor，我们可以分享我们对它会消化和不会消化什么的发现。不要把任何事情视为理所当然。例如，它似乎会播放我的 MP3 文件，但无法发现它们的持续时间，或寻找它们！

# java - OpenGL VBO Cube 渲染不正确（Java，LWJGL）

> ID：14532516
> 
> 赞同：0
> 
> 时间：2013-01-26T00:37:41.017
> 
> 标签：java, rendering, lwjgl, cube, vbo

**注意：**对于链接/图像只不过是文本表示歉意 - 作为一个新用户，我不能发布图像，也不能发布 >2 个超链接。

所以我一直在使用已弃用的 OpenGL 一段时间，并在几周前决定最终转向更现代的方法。我使用[Open.gl](http://open.gl)作为资源（我发现 LWJGL 教程不一致且稀疏），并且能够渲染到[本教程的最后一张图像](http://open.gl/transformations)。但是，我在下一页（渲染立方体）遇到了一些严重的问题。

我已经对这个问题进行了大量研究，并多次改进/重组我的代码，以便完全理解每个组件的目的并确保我没有错过一些基本的东西（比如忘记翻转缓冲区），并且只管理了缩小我认为可能发生错误的区域。

所以，我的基本目标是渲染一个立方体，使用这个示例代码：`http://open.gl/content/code/c5_cube.txt` 这是我的比较代码：`http://pastie.org/5864112#241`

我从我的代码中得到的结果如下：

如果我只在 Z 方向平移 View Matrix，我得到的图像与上一个教程末尾的图像完全相同：`https://dl.dropbox.com/u/38489921/vbo11.png`

```
//set up view matrix - TODO: problem 1?
    Matrix4f view = new Matrix4f();
    view.setIdentity();
    view.translate(new Vector3f(0.0f, 0.0f, -2f)); 
    view.m13 = 1f;
    FloatBuffer viewSend = BufferUtils.createFloatBuffer(16);
    view.store(viewSend);
    viewSend.flip();
    int uniView = glGetUniformLocation(shaderProgram, "view");
    glUniformMatrix4(uniView, false, viewSend); 
```

这实际上可能是我的问题 - 示例代码使用了我无法访问的 glm::lookAt()，所以我可能只是对矩阵做完全错误的事情。

继续前进，如果我在 Y 方向上任意平移视图矩阵（代码如下图），我会得到一种扭曲的立方体：`https://dl.dropbox.com/u/38489921/vbo12.png`

```
//set up view matrix - TODO: problem 1?
    Matrix4f view = new Matrix4f();
    view.setIdentity();
    view.translate(new Vector3f(0.0f, 1.0f, -2f)); 
    view.m13 = 1f;
    FloatBuffer viewSend = BufferUtils.createFloatBuffer(16);
    view.store(viewSend);
    viewSend.flip();
    int uniView = glGetUniformLocation(shaderProgram, "view");
    glUniformMatrix4(uniView, false, viewSend); 
```

这让我相信这是透视投影的问题，所以我做了更多的研究并确保我的 perspective() 函数是正确的。几乎没有对投影实现的更改会改变视觉结果，所以我将在这里突出显示该功能以及我如何使用它：

```
//set up projection matrix //TODO: problem 2?
    Matrix4f proj = perspective(90f, 600f / 800f, 1f, 10f);
    FloatBuffer projSend = BufferUtils.createFloatBuffer(16);
    proj.store(projSend);
    projSend.flip();
    int uniPersp = glGetUniformLocation(shaderProgram, "proj");
    glUniformMatrix4(uniPersp, false, projSend);

private Matrix4f perspective(float fov, float aspectRatio, float zNear, float zFar) {
    float zm = zFar - zNear;
    float zp = zFar + zNear;

    Matrix4f persp = new Matrix4f();

    persp.m00 = (1 / (float)Math.tan(Math.toRadians(fov / 2))) / aspectRatio;
    persp.m11 = 1 / (float)Math.tan(Math.toRadians(fov / 2));
    persp.m22 = -zp / zm;
    persp.m23 = -1;
    persp.m32 = -((2 * zNear * zFar) / zm);

    return persp;
} 
```

在我看来，这是一个非常奇怪的错误，我完全无法理解。经过大量研究尝试自己修复它，老实说，它已经到了我的大脑受伤的地步，所以我想我会寻求一些帮助。

我的目标是确定导致此错误的原因、原因以及我将如何修复它（以及，如有必要，我可以使用任何特殊提示或技巧来确保此类错误不再发生）。我很感激任何帮助，并将提供所需的任何进一步信息。

非常感谢， - 乔诺。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T19:33:57.707

不太明白你的问题是什么。你说当你翻译你的视图矩阵时你会得到意想不到的行为......对吗？

我在您的矩阵设置中没有看到任何错误，因此，请提供您的 GLSL 着色器代码以及您声明图像顶点信息的时刻（不是图像作为纹理，而是图像作为空间中的 3D 对象）。我想这有什么问题（你不能只得到一个立方体，而你只有 4 个顶点，所以也许你有更多）。

另外，为了帮助您，这是“Modern gluLookAt”的代码

```
public Matrix4f set(float cameraX, float cameraY, float cameraZ, 
float lookX, float lookY, float lookZ){

//My advice to you: you shouldn't create new matrix everytime, 
//it will give you little glitches. 
//Create some new class containing this method, change type to void 
//and declare "matrix" as a field - make your own "camera" object (java object)

Matrix4f matrix = new Matrix4f();
Matrix4f aux = new Matrix4f();

Vector3f dir = new Vector3f(lookX - cameraX, lookY - cameraY, lookZ - cameraZ);
Vector3f up = new Vector3f(0, 1f, 0);
Vector3f right = new Vector3f();
dir.normalise();

Vector3f.cross(dir,up,right);
right.normalise();

Vector3f.cross(right,dir,up);
up.normalise();

matrix.m00 = right.getX();
matrix.m01 = right.getY();
matrix.m02 = right.getZ();
matrix.m03 = 0.0f;

matrix.m10 = up.getX();
matrix.m11 = up.getY();
matrix.m12 = up.getZ();
matrix.m13 = 0.0f;

matrix.m20 = -dir.getX();
matrix.m21 = -dir.getY();
matrix.m22 = -dir.getZ();
matrix.m23 =  0.0f;

matrix.m30 = 0.0f;
matrix.m31 = 0.0f;
matrix.m32 = 0.0f;
matrix.m33 = 1.0f;

//setup aux as a translation matrix by placing positions in the last column
aux.m30 = -cameraX;
aux.m31 = -cameraY;
aux.m32 = -cameraZ;

//multiplication(in fact translation) viewMatrix with aux
Matrix4f.mul(matrix, aux, matrix);

return matrix;
} 
```

**我发现了你的问题：**

```
view.m13 = 1f; 
```

这意味着您的相机位于第四个 W 维度，因此当您平移视图矩阵时，您的图像也会沿 W 方向移动。因此，删除此行。

**此外**，这是更好地理解 LWJGL 中的矩阵的提示：

**m00 | m10 | m20 | m30** |||_||| XX | Yx | Zx | Wx

**m01 | m11 | m21 | m31** |||_||| XY | 是的 | 齐| 怀

**m02 | m12 | m22 | m32** |||_||| Xz | YZ | 兹 | 威兹

**m03 | m13 | m23 | m33** |||_||| 许 | 是的 | Zw | 万维网

m03、m13、m23 几乎总是必须为 0，并且 m33 = 1。

*问候。*

# applescript - TextEdit 中的 AppleScript“另存为”HTML

> ID：14532518
> 
> 赞同：1
> 
> 时间：2013-01-26T00:37:46.440
> 
> 标签：applescript, textedit

我希望 AppleScript 循环遍历文件夹中的一组 RTF 文件并将它们保存为 HTML 文件。

到目前为止，这是我的简单代码。XXXX是我苦苦挣扎的地方：

```
tell application "Finder"
    set source_folder to choose folder
    set aList to every file in source_folder
    repeat with i from 1 to number of items in aList
        tell application "TextEdit"
            set aFile to (item i of aList)
            save as aFile XXXXXXXXX
        end tell
    end repeat
end tell 
```

我对此真的很陌生......非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T01:43:31.530

为此，您不需要 TextEdit。有一个命令行程序 textutil 可以完成这项工作，而无需打开和保存 TextEdit 所需的所有内容。我们可以修复您的 TextEdit 脚本（它有一些错误），但请先尝试一下，让我们知道它是否适合您。html 文件将具有相同的名称，但具有 html 扩展名，并将位于 source_folder 中。可以使用 textutil 的“-output”开关在代码中更改输出路径。如果您想了解它可以做的所有事情，请参阅“man textutil”。

还有一个普遍的问题……什么是 RTD 文件？你的意思是rtf还是rtfd？Textutil 将适用于 rtf/rtfd 但不适用于 rtd，所以我希望这不是你的文件类型。

```
set source_folder to choose folder with prompt "Choose a source folder."
set output_folder to choose folder with prompt "Choose an output folder."

tell application "Finder"
    set theFiles to (files of entire contents of source_folder) as alias list
end tell

repeat with aFile in theFiles
    tell application "Finder"
        set fileName to name of aFile
        set fileExt to name extension of aFile
    end tell

    set outputPath to (output_folder as text) & text 1 thru -((count of fileExt) + 1) of fileName & "html"

    do shell script "/usr/bin/textutil -convert html -output " & quoted form of POSIX path of outputPath & space & quoted form of POSIX path of aFile
end repeat 
```

你提到你是 applescript 的新手，所以我会给你一些在编写 applescript 代码时应该牢记的一般指示。

1.  避免将代码块彼此放在一起。您已经在 tell app Finder 中告诉 app TextEdit。那很糟。这样做是许多冲突的根源，因为您基本上是在告诉 Finder 告诉 TextEdit 做某事。这不好，因为命令可能会混淆，并且很难调试这类问题。因此，请将您的告诉块分开。
2.  避免告诉应用程序执行不在其 applescript 字典中的命令。您应该只告诉应用程序执行它知道的命令，而应用程序只知道其字典中的命令。例如，您告诉 Finder “选择文件夹”。Finder 不知道该命令。那是一个applescript命令。因此，按照您的做法进行操作是另一个可能的错误来源。在这种情况下，这是一个简单的命令，它会起作用，但通常避免这样做。
3.  关于 Finder，您应该避免过多地使用它。Finder 是您计算机上的主要程序，经常忙于处理与计算机相关的事情。因此，最好仅在必要时使用它。例如，您可以在我的代码中看到我从 Finder 中删除了“选择文件夹”和重复循环。我故意将“作为别名列表”附加到 Finder 命令的末尾，以使文件列表在 Finder 之外可用，告诉代码块。当然，如果需要，请使用 Finder，但如果您不需要它，最好不要使用它。
4.  使用应用程序的 applescript 字典。如上所述，字典列出了应用程序可以理解的所有术语和语法（当然，字典很难理解，但使用的次数越多，你就会越熟练）。在 AppleScript Editor 的文件菜单下，选择“打开字典”并显示所有理解 applescript 的应用程序的列表。从中选择一个应用程序以查看其字典。例如，您正试图找出 TextEdit 的“另存为”命令。你通常可以从字典中得到好的方向，所以你应该看一下。使用搜索字段进行搜索！

所以我希望这会有所帮助！祝你好运。

# wordpress - wp-admin 或 wp-login.php 上的重定向循环

> ID：14532520
> 
> 赞同：6
> 
> 时间：2013-01-26T00:37:57.057
> 
> 标签：wordpress, redirect, infinite-loop

我使用 MAMP 在本地构建了一个快速的 WordPress 站点，然后将其签入 SVN 存储库。然后我将其签出到我的开发服务器上。

[除了从 Interconnectit 运行搜索和替换工具](http://interconnectit.com/products/search-and-replace-for-wordpress-databases/)脚本以更新服务器数据库中站点的 URL之外，我没有进行任何更改。

最初，我收到 500 服务器错误。检查日志，我发现这个“SoftException”是因为`index.php`可以按组写入 - 权限是 664。没问题 - 将权限快速更改为 644 对此进行了排序。所以现在前端正在工作。

然而，奇怪的是，该站点的管理端不起作用。它只是在所有浏览器中产生了一个无限的重定向循环。

```
Error 310 (net::ERR_TOO_MANY_REDIRECTS): There were too many redirects. 
```

自本地开发版本以来没有任何变化。htaccess 文件只是一个标准的 WordPress 文件。没什么奇怪的......在本地仍然可以正常工作。

发生什么了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-02-07T04:23:30.447

无论出于何种原因， /wp-admin/ 路径会导致重定向循环，但 /wp-admin/index.php 不会。因此，我们可以使用 .htaccess 将 /wp-admin/ 路径重定向到 /wp-admin/index.php，方法是将以下行添加到“RewriteBase /”行之后的 .htaccess 文件中，如下所示：

```
RewriteBase /
RewriteRule  /wp-admin/ /wp-admin/index\.php [L,P] 
```

它对我有用。你最终的 .htaccess 可能看起来像这样：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule  /wp-admin/ /wp-admin/index\.php [L,P]
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-26T00:39:27.870

检查权限`wp-login.php`显示它们也以某种方式设置为 664 - 导致`index.php`失败并导致 500 服务器错误的相同权限。

我将权限更改`wp-login.php`为 644，嘿，WordPress 登录页面出现了。

但是在登录时，另一个重定向循环。所以，再一次看`/wp-admin/index.php`，权限是 664 而不是 644。

修复它们会导致下一个文件出现问题 - 仪表板一团糟。从 664 更改为 644 一项一项地纠正了问题（/wp-admin/load-scripts.php、/wp-admin/load-styles.php）。

因此很明显，递归更改权限是解决问题的唯一方法。

我的 UNIX 并不完全是一流的，但这似乎有效（从 Mac OS X 终端运行）。我从这个 WP 安装的根目录运行它。

```
find . -type f -perm 664 -print -exec chmod 644 {} \; 
```

可能有更好的命令，但我理解这意味着“查找所有具有 664 权限的文件并将它们更改为 644”。

它解决了我的问题。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-11-04T14:36:08.163

如果您使用的是 Cloudflare，您可能想尝试将其添加到 wp-config.php 文件的顶部：

```
define('WP_SITEURL', 'https://www.example.com');
define('WP_HOME', 'https://www.example.com');
define('FORCE_SSL_ADMIN', true);
define('FORCE_SSL_LOGIN', true);
if(isset($_SERVER['HTTP_CF_VISITOR']) && strpos($_SERVER['HTTP_CF_VISITOR'], 'https')){
  $_SERVER['HTTPS']='on';
} 
```

将它添加到 wp-config.php 文件的顶部很重要，否则您最终会收到“抱歉，您无权访问此页面”错误消息。

信用：[https ://www.meltajon.com/dev/wordpress-wp-admin-redirect-loop-with-cloudflare-ssl](https://www.meltajon.com/dev/wordpress-wp-admin-redirect-loop-with-cloudflare-ssl)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-16T06:35:17.563

如果你的网络服务器是 nginx，你可能需要检查你的 nginx 的配置文件。如果有

```
if (!-f $request_filename){
    rewrite ^/(.+)$ /index.php?$1& last;
} 
```

将这些行替换为

```
try_files $uri $uri/ /index.php?$args; 
```

另请参阅[Nginx Pitfalls](http://wiki.nginx.org/Pitfalls)，[nginx 上的 WordPress wiki 页面](http://codex.wordpress.org/Nginx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-25T01:39:11.023

使用 nginx 配置，我最初只有这一行并且遇到了相同的重定向问题：

```
location / {
    try_files   $uri /index.php$is_args$args;
} 
```

添加后一切都很好：

```
location /wp-admin/ {
    index index.php;
    try_files $uri $uri/ /index.php$args;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-12-24T12:19:38.193

如果您使用 Cloudflare，请从 Cloudflare 帐户的 SSL/TLS 选项卡中选择完全加密。它将解决问题。 [![SSL/TLS 设置](../Images/f8f018d429246fc134f3aced5fa68ad5.png)](https://i.stack.imgur.com/Qblba.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-10T10:27:05.320

我只需要刷新我的重定向。由于我无法访问管理员，我将其添加到我的 functions.php 文件的顶部：

`flush_rewrite_rules(); exit;`

保存并刷新了我的网站。然后从您的functions.php 文件中删除代码，然后再次刷新。那是为我做的。

我还认为重新保存您的永久链接可能是一个很好的措施。

PS。我认为主要问题来自主题-我的登录，因为它重定向到/登录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-17T13:44:40.070

尝试在我的 WP 站点中发布时，我得到了 DoS 页面。我发现建议将 function.php 文件中的权限更改为 600 可以解决问题，还可以向该文件添加脚本片段。这是一个 WP 帮助页面。我能够以一种变通的方式进行出版。当我尝试打开编辑器时仍然有 DoS。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-17T14:50:37.597

我的问题是硬盘已满。尝试登录 wordpress 管理面板将我重定向到 wp-login.php。在我删除一些文件的那一刻，我能够再次登录。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-05T13:09:33.077

删除线条

```
define('DOMAIN_CURRENT_SITE', 'www.sitename.de');

define('SITE_ID_CURRENT_SITE', 1);
define('BLOG_ID_CURRENT_SITE', 1); 
```

从`wp-config.php`应该做的工作。

这些线对于多线不是必需的

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-10-10T08:32:11.257

就我而言，这是 Apache 的`DirectoryIndex`问题。`wp-admin`正在被访问，但`wp-admin/index.php`不是`wp-admin`和显示`ERR_TOO_MANY_REDIRECTS`。

听起来 Apache 的`DirectoryIndex`设置可能“不正确”。尝试在文件顶部重置它`.htaccess`：

```
DirectoryIndex index.php 
```

在此处查看完整答案。 [在没有 /index.php 的情况下无法使用 wp-admin 访问管理仪表板](https://wordpress.stackexchange.com/a/305237)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-04-07T13:14:28.340

在启用站点的文件夹中，您需要编辑站点的配置并添加多站点重定向规则。对于 Ubuntu 14.04，您将能够在 /etc/nginx/sites-available 下找到路径

在您的服务器块中添加以下块，您应该能够避免无限重定向循环。

```
#Rewrite multisite '.../wp-.*' and '.../*.php'.
if (!-e $request_filename) {
    rewrite /wp-admin$ $scheme://$host$uri/ permanent;
    rewrite ^/[_0-9a-zA-Z-]+(/wp-.*) $1 last;
    rewrite ^/[_0-9a-zA-Z-]+(/.*\.php)$ $1 last;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-21T10:30:34.220

在我的情况下，我遇到了类似的问题，这是由于恢复了使用 WP Migrate DB 创建的数据库脚本。该脚本具有像“## DEV URL ##”这样的合并标签，我需要先修复它，然后再在 mysql 上运行脚本并将 wp-config.php 指向正确的数据库。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2017-03-04T21:53:16.690

如果你有 nginx，那么还要检查你的索引配置。至于我，我有一个问题：我设置了以下内容：

```
server {
    server_name _;
    root /var/www/html;
    index /index.php;
} 
```

如您所见，我设置了带有斜杠的 index.php，这意味着所有重写请求都将转到 document_root 中的 index.php。对于 WP 是错误的，因为 wp-admin 目录有自己的 index.php

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2017-06-15T15:52:42.867

上面的答案让我非常接近。在我们的特殊情况下，有人在某个时候向站点根目录和 admin 文件夹中的 htaccess 文件添加了一些规则，以阻止来自除某些白名单 IP 之外的任何地方的流量（尝试访问 wp-admin 时）。

例子：

```
<Files wp-login.php>
   order deny,allow
   Deny from all

   # Allow from this IP address
  allow from 123.45.67.89
</Files> 
```

将我们的 IP 添加到两个文件的白名单中可以解决问题。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2017-11-04T23:34:34.833

从其他服务器恢复备份后，我遇到了同样的问题，我以这种方式解决了这个问题。

```
 chown -R www-data:www-data          /var/www
  chmod -R g+rwx                     /var/www 
```

存放网站文件的地方 `/var/www`，根据你的配置替换成合适的路径，例如`/usr/share/nginx/www`<< default Nginx

# c# - Unity3D游戏：处理一个文件中的常量

> ID：14532521
> 
> 赞同：1
> 
> 时间：2013-01-26T00:37:57.297
> 
> 标签：c#, iphone, ios, unity3d

我需要将所有常量分组到一个文件中并在检查器上显示它们。这是我尝试过的：

1.  `#define`常数

    ```
    #define speed 10.0f
    #define hp 3 
    ```

    这不起作用，无论我把它们放在哪里，错误：

    > 在文件中的第一个标记之后无法定义或取消定义预处理器符号

2.  使用静态

    ```
    public static readonly float speed = 10.0f;
    public static readonly int hp = 3; 
    ```

    它可以工作，但是当我将它附加到主摄像机时，常量不会显示在检查器窗口中。现在我知道检查员不支持静态字段。

3.  按照建议使用单例

    ```
    using UnityEngine;
    using System.Collections;

    public class GameConfig : MonoBehaviour {

    private static GameConfig instance;

    public GameConfig() 
    {
        if (instance != null) 
        {
            Debug.LogError("GameConfig Warning: unable to create multiple instances");
        }
        instance = this;
    }

    public static GameConfig Instance 
    {
        get
        {
            if (instance == null) 
            {
                Debug.Log("GameConfig: Creating an instance");
                new GameConfig();
            }
            return instance;
        }
    } 
    ```

    现在，如果我添加：

    ```
    public float speed = 10.0f; 
    ```

    GameConfig.Instance.speed 可以访问，但单声道编辑器不会弹出自动完成。它得到这个消息：

    > CompareBaseObjects 只能从主线程调用。
    > 加载场景时，构造函数和字段初始化程序将从加载线程中执行。
    > 不要在构造函数或字段初始化程序中使用此函数，而是将初始化代码移至 Awake 或 Start 函数。

    如果我尝试：

    ```
    public float speed = 10.0f;
    public float Speed {get {return speed;}} 
    ```

    我得到同样的信息。

但是游戏仍然可以运行，并且变量正确显示在检查器上。注意：即使我修复了它，还有其他方法可以吗？因为编写具有 2 个名称（属性 + 字段）的常量和繁琐的工作似乎是多余的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:03:30.353

在 Unity 中使用 C# 在游戏对象中使用单例，不应该使用子类（GameConfig）的构造函数，而是创建一个游戏对象，然后将所需的组件添加到其中。像这样：

```
private static GameConfig _instance = null;
public static GameConfig instance 
{
    get {
        if (!_instance) {
            //check if an GameConfig is already in the scene
            _instance = FindObjectOfType(typeof(GameConfig)) as GameConfig;

            //nope create one
        if (!_instance) {
            var obj = new GameObject("GameConfig");
            DontDestroyOnLoad(obj);
            _instance = obj.AddComponent<GameConfig>();
            }
        }
        return _instance;
    }
} 
```

顺便说一句，在您的方法 2 中，您可以通过自己设置检查 UI 来完成任务。为 GameConfig 构建一个自定义编辑器并添加您想要检查的内容。有关详细信息，请参阅[CustomEditor 属性](http://docs.unity3d.com/Documentation/ScriptReference/CustomEditor.html)和[Editor.OnInspectorGUI](http://docs.unity3d.com/Documentation/ScriptReference/Editor.OnInspectorGUI.html)。如果您不知道如何自定义检查器或如何扩展默认编辑器，您可以在 Unity 网站的[扩展编辑器](http://docs.unity3d.com/Documentation/Components/gui-ExtendingEditor.html)中找到一些有用的指南（自定义检查器部分可能适合您）。

# css - 为什么字体在 Firefox 中不起作用？

> ID：14532523
> 
> 赞同：0
> 
> 时间：2013-01-26T00:38:10.190
> 
> 标签：css, font-face

我正在使用字体，它在 Safari 和 Chrome 中渲染得很好，但在 Firefox 中却没有。

```
@font-face {
    font-family: 'franchiseregular';
    src: url('franchise-bold-webfont.eot');
    src: url('franchise-bold-webfont.eot?#iefix') format('embedded-opentype'),
         url('franchise-bold-webfont.woff') format('woff'),
         url('franchise-bold-webfont.ttf') format('truetype'),
         url('franchise-bold-webfont.svg#franchiseregular') format('svg');
    font-style: normal;
}

h1 { 
font-family: 'franchiseregular', Helvetica, 'Helvetica Neue', Arial, sans-serif; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T16:16:22.557

Firefox 倾向于使用 woff 文件类型。您可能需要确保您的 Web 服务器设置为提供 woff 文件。您可以使用 mime 类型在服务器级别实现此目的，或者将以下内容添加到您的 Web 配置中。

```
<system.webServer>
   <staticContent>
      <mimeMap fileExtension=".woff" mimeType="application/font-woff" />
   </staticContent>
</system.webServer> 
```

# android - Android：为什么我不能在我的数组列表中保存更多对象

> ID：14532525
> 
> 赞同：0
> 
> 时间：2013-01-26T00:39:24.010
> 
> 标签：android, arraylist

为什么当我进行触摸精确定位时，它只需要数组列表中的最后一个精确定位。当我测量 arraylist 大小时，它说大小为 1，即使我保存了 2 个或更多精确点。

谷歌地图类。

```
public class GoogleMaps extends MapActivity implements LocationListener {

public void addLocation() {
    AlertDialog.Builder alert = new AlertDialog.Builder(this);
    final EditText input = new EditText(this);
    alert.setTitle("What do you want to call the location?");
    alert.setView(input);
    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int whichButton) {

            value = input.getText().toString().trim();
            checklocationTitle();
        }
    });

    alert.setNegativeButton("Cancel",
            new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int whichButton) {
                    dialog.cancel();
                }
            });
    alert.show();
}

public void checklocationTitle() {
    if (value.length() > 3) {
        Toast.makeText(this, "Name of the locations is know " + value,
                Toast.LENGTH_LONG).show();
        try {
            markedpinpoint = true;
            midllat = touchedPoint.getLatitudeE6() / 1E6;
            midlongi = touchedPoint.getLongitudeE6() / 1E6;
            Geocoder geocoder = new Geocoder(getBaseContext(),
                    Locale.getDefault());
            List<Address> adress = geocoder.getFromLocation(
                    touchedPoint.getLatitudeE6() / 1E6,
                    touchedPoint.getLongitudeE6() / 1E6, 1);
            if (adress.size() > 0) {
                String display = "";
                for (int i = 0; i < adress.get(0).getMaxAddressLineIndex(); i++) {
                    display += adress.get(0).getAddressLine(i) + "\n";
                    OverlayItem overlayitem = new OverlayItem(touchedPoint,
                            value, display);
                    custom = new Location_Service(d, GoogleMaps.this);
                    custom.insertLocation(overlayitem);
                    overlayList.add(custom);
                }
            } else {
                Toast.makeText(
                        this,
                        "There where a problem to locate the selected adresse",
                        Toast.LENGTH_LONG).show();
            }
        } catch (IOException e) {
        }
    } else {
        Toast.makeText(this,
                "Please provide a least 3 cifre Title for your location.",
                Toast.LENGTH_LONG).show();
        addLocation();
    }
}

public void buttonLocations(View view) {
    // stopLocationListner();
    // stopBackgroundService();
    Intent intent = new Intent(this, PinPoints.class);
    startActivity(intent);
    // Toast.makeText(this, "Gemte steder: " + custom.size(),
    // Toast.LENGTH_LONG).show();

} 
```

}

位置_服务类

```
public class Location_Service extends ItemizedOverlay<OverlayItem> {

    public ArrayList<OverlayItem> pinpoints = new ArrayList<OverlayItem>();

    public Location_Service(Drawable defaultMarker) {
        super(boundCenter(defaultMarker));
        // TODO Auto-generated constructor stub
    }

    public ArrayList<Locations> getData() {
        Locations hej = new Locations();
        ArrayList<Locations> tt = new ArrayList<Locations>();
        for (OverlayItem test : pinpoints) {
            hej.setAdress(test.getSnippet());
            hej.setMidlat(test.getPoint().getLatitudeE6());
            hej.setMidlong(test.getPoint().getLongitudeE6());
            hej.setTitle(test.getTitle());
            tt.add(hej);
        }
        return tt;
    }

    public Location_Service(Drawable m, Context context) {
        this(m);
    }

    @Override
    protected OverlayItem createItem(int i) {
        return pinpoints.get(i);
    }

    @Override
    public int size() {
        return pinpoints.size();
    }

    public void insertLocation(OverlayItem item) {
        pinpoints.add(item);
        this.populate();
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:59:55.963

您正在将相同的 Locations 对象重复添加到列表中`getData()`......您没有实例化一个新对象。

你可能真的是说

```
ArrayList<Locations> tt = new ArrayList<Locations>();
for (OverlayItem test : pinpoints) {
    Locations hej = new Locations(); //instantiate each time!
    hej.setAdress(test.getSnippet());
    hej.setMidlat(test.getPoint().getLatitudeE6());
    hej.setMidlong(test.getPoint().getLongitudeE6());
    hej.setTitle(test.getTitle());
    tt.add(hej);
}
return tt; 
```

# c# - 在 Codefirst Entity Framework 中创建数据库的时间是什么时候？

> ID：14532527
> 
> 赞同：2
> 
> 时间：2013-01-26T00:39:35.367
> 
> 标签：c#, entity-framework

我只是 Entity Framework 的新手，我目前在 Codefirst 上练习以生成我的模型。我遇到的一个困惑是，当我调用 DbContext 来创建整个架构时，我需要先将数据插入到任何表中，然后才能创建所有表。这有意义吗？或者，也许我刚刚对我的代码做错了什么。谢谢？

这是一个示例代码：

模型

```
public class Employee
{
    public int EmployeeID { get; set; }
    public string Firstname { get; set; }
    public string Middlename { get; set; }
    public string Lastname { get; set; }
} 
```

这是我的 DBContext：

```
public class MyContext : DBContext
{
    public MyContext():base(@"
    Data Source=(localdb)\v11.0;
    AttachDbFilename=c:\users\nsutgio\MyDB.mdb;
    Initial Catalog=MyDB;
    Integrated Security=true;
    Connection Timeout=30")
    {
    }
    // I override onModelCreating here...
    public DbSet<Employee> Employee { get; set; }
} 
```

加载数据库...

```
private void loadDB()
{
    using(MyDBContext ctx = new MyDBContext())
    {
        // The commented code here is the one I've said, If I'll comment out this code below 
        // the database will not be created. My question is do we really need to insert data 
        //first before the whole database will be created?

        //Employee _ee = new Employee();

        //_ee.Firstname = "nsutgio";
        //ctx.Employee.Add(_ee);

        ctx.SaveChanges();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:50:22.887

你可以管理这个过程。但默认情况下，每次在应用程序启动期间数据模型发生变化时，数据库都会重新创建。

如果你对这个过程很感兴趣，请阅读[这篇文章](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm)

# r - 在 R 中，将另一个因子中每个因子的行数相加，并在缺少“特定”数据时返回 0

> ID：14532528
> 
> 赞同：1
> 
> 时间：2013-01-26T00:39:39.173
> 
> 标签：r, zoo

我遇到了一个潜在的问题，希望你能帮助我:)

例如，我有以下显示多个商店的数据表，每次访问者进入商店时，都会记录时间和日期。这意味着每一行/每一行都是 1 位进入其中一家商店的访客。

```
data <- structure(list(store.ID = c("1", "1", "1", "1", "1", 
"2", "2", "2", "2", "2", "3", "3", "3", 
"3", "3", "4", "4", "4", "4", "4"), Time = structure(c(6L, 
7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 1L, 2L, 3L, 4L, 5L, 
16L, 17L, 18L, 19L, 20L), .Label = c("  12:09:19", "  12:09:25", 
"  13:09:30", "  13:09:35", "  14:09:40", " 12:00:03", " 12:00:09", 
" 12:00:14", " 14:00:25", " 16:00:32", " 12:27:19", " 13:27:25", 
" 14:27:41", " 14:27:46", " 17:27:59", " 12:46:10", " 12:46:19", " 13:46:29", 
" 14:46:39", " 15:46:50"), class = "factor"), Date = structure(c(1351728000, 
1351728000, 1351728000, 1351728000, 1351728000, 1351814400, 1351814400, 
1351814400, 1351814400, 1351814400, 1351814400, 1351814400, 1351814400, 
1351814400, 1351814400, 1351814400, 1351814400, 1351814400, 1351814400, 
1351814400), class = c("POSIXct", "POSIXt"), tzone = "UTC")), .Names = c("storeID", "Time", "Date"), class = "data.frame", row.names = c(NA, 
-20L)) 
```

**[EDIT]** The stores are open 24/7\. Now I would like is to have a solution / way that assigns each visit / row to one of the 24 hour periods in a day (i.e., 09.00-10.00 being 1, 10.00-11.00 being 2, etc). Then I would like to have the number of visitors per hour period over two consecutive days. I would like to be able to separate this for certain fixed factors, e.g., storeID and City (not shown in this example). Also, if no visitors enter the store, I would like the data file to show that within this time interval there was no visitor, which should in this case return 0). **[EDIT]**

Note that my data file is huge, having over 700k rows.

I hope I made my issue clear.

MvZB

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:52:00.843

`First method:`使用[**Dirk 在这里很好地说明**](https://stackoverflow.com/questions/5624140/binning-dates-in-r)`zoo`的包。我已经解释了内联代码。这样的事情应该这样做：[](https://stackoverflow.com/questions/5624140/binning-dates-in-r)

 **```
df <- data # I just prefer `df` to `data`
df$storeID <- as.numeric(as.character(df$storeID)) # make sure its numeric
# instantiate the zoo object by providing values corresponding to time
require(zoo)
z <- zoo(as.numeric(as.character(df$storeID)), 
              as.POSIXct(paste(df$Date, df$Time)))
# create output data.frame with all possible timings
open_time <- paste(9:18, "00", "00", sep=":")
open_date <- as.character(unique(df$Date))
out.df <- data.frame(Date = rep(open_date, each=length(open_time)-1), 
                     Start = rep(head(open_time, -1), length(open_date)), 
                     End = rep(tail(open_time, -1), length(open_date)))
# Pointer for matching later
out.df$Pointer <- as.POSIXct(paste(out.df$Date, out.df$Start))
# initialise count to 0
out.df$count <- 0

# aggregate using zoo's magic function!
# the first part contains the storeID and is aggregated by
# the second column which creates hourly interval from the times in z (your data)
# and the third column sums up all values that fall in each hourly interval
agg.out <- aggregate(z, time(z) - as.numeric(time(z)) %% 3600, length)

# once that is done, just match the corresponding times and place them rightly
m.idx <- match( out.df$Pointer, index(agg.out))
out.df$count[!is.na(m.idx)] <- agg.out[m.idx[!is.na(m.idx)]]
out.df <- subset(out.df, select=-c(Pointer))

# and you're done
> out.df
#          Date    Start      End count
# 1  2012-11-01  9:00:00 10:00:00     0
# 2  2012-11-01 10:00:00 11:00:00     0
# 3  2012-11-01 11:00:00 12:00:00     0
# 4  2012-11-01 12:00:00 13:00:00     3
# 5  2012-11-01 13:00:00 14:00:00     0
# 6  2012-11-01 14:00:00 15:00:00     1
# 7  2012-11-01 15:00:00 16:00:00     0
# 8  2012-11-01 16:00:00 17:00:00     1
# 9  2012-11-01 17:00:00 18:00:00     0
# 10 2012-11-02  9:00:00 10:00:00     0
# 11 2012-11-02 10:00:00 11:00:00     0
# 12 2012-11-02 11:00:00 12:00:00     0
# 13 2012-11-02 12:00:00 13:00:00     5
# 14 2012-11-02 13:00:00 14:00:00     4
# 15 2012-11-02 14:00:00 15:00:00     4
# 16 2012-11-02 15:00:00 16:00:00     1
# 17 2012-11-02 16:00:00 17:00:00     0
# 18 2012-11-02 17:00:00 18:00:00     1 
```

`Second Method:`[**不再从这里**](https://stackoverflow.com/questions/5356136/how-to-select-and-plot-hourly-averages-from-data-frame/5356233#5356233)使用`zoo`包装[**绘图的想法`Dirk`**](https://stackoverflow.com/questions/5356136/how-to-select-and-plot-hourly-averages-from-data-frame/5356233#5356233)。但我`data.table`用于快速访问。再次查看内联注释以获取解释。

```
require(data.table)
df <- data # I prefer df than data
# create an id column containing only the hours
df$id <- as.numeric(as.POSIXlt(paste(df$Date, df$Time))$hour)
# convert Date to character
df$Date <- as.character(df$Date)

# load package, create input data.table with Date and id as keys
require(data.table)
dt.in <- data.table(df)
setkey(dt.in, "Date", "id")
# get the count of customers / hour / date 
dt.tmp <- dt.in[, .N, by=c("Date", "id")]

# create the output template data.table with Date, Start and End
open_time <- paste(9:18, "00", "00", sep=":")
open_date <- as.character(unique(df$Date))
dt.out <- data.table(Date = rep(open_date, each=length(open_time)-1), 
                     Start = rep(head(open_time, -1), length(open_date)), 
                     End = rep(tail(open_time, -1), length(open_date)))
# create the id again by extracting hour                     
dt.out[, id := as.numeric(as.POSIXlt(paste(Date, Start))$hour)]
setkey(dt.out, "Date", "id")

# merge the two data.tables to get your output
dt.out <- dt.tmp[dt.out, list(Start, End, N)]
dt.out[, id := NULL]

> dt.out
#           Date    Start      End  N
#  1: 2012-11-01  9:00:00 10:00:00 NA
#  2: 2012-11-01 10:00:00 11:00:00 NA
#  3: 2012-11-01 11:00:00 12:00:00 NA
#  4: 2012-11-01 12:00:00 13:00:00  3
#  5: 2012-11-01 13:00:00 14:00:00 NA
#  6: 2012-11-01 14:00:00 15:00:00  1
#  7: 2012-11-01 15:00:00 16:00:00 NA
#  8: 2012-11-01 16:00:00 17:00:00  1
#  9: 2012-11-01 17:00:00 18:00:00 NA
# 10: 2012-11-02  9:00:00 10:00:00 NA
# 11: 2012-11-02 10:00:00 11:00:00 NA
# 12: 2012-11-02 11:00:00 12:00:00 NA
# 13: 2012-11-02 12:00:00 13:00:00  5
# 14: 2012-11-02 13:00:00 14:00:00  4
# 15: 2012-11-02 14:00:00 15:00:00  4
# 16: 2012-11-02 15:00:00 16:00:00  1
# 17: 2012-11-02 16:00:00 17:00:00 NA
# 18: 2012-11-02 17:00:00 18:00:00  1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T14:26:07.070

这是一个使用 lubridate 和因子的简单解决方案：

```
library(lubridate)

# Create a single date time variable
dt <- ymd_hms(paste(data$Date, data$Time))
# Extract the day
data$day <- floor_date(dt, "day")
# Extract the hour, converting it into a factor, so we
# get all hours shown
data$hour <- factor(hour(dt), 9:18)

# Count up with table
as.data.frame(table(data[c("day", "hour")])) 
```**

# flex-lexer - Flex（词法分析器）无法识别或操作

> ID：14532537
> 
> 赞同：0
> 
> 时间：2013-01-26T00:40:35.237
> 
> 标签：flex-lexer, lexical-analysis

我对 flex 有疑问。它无法识别此规则中的 or 运算符：

```
[0-9A-Za-z]+{CORRECT} | {CORRECT}[0-9A-Za-z]+ [0-9A-Za-z]+{CORRECT}[0-9A-Za-z]+ {...} 
```

如果我把它分成三个规则，那么它就会被识别：

```
[0-9A-Za-z]+{CORRECT}  {...}
{CORRECT}[0-9A-Za-z]+ { ...}
[0-9A-Za-z]+{CORRECT}[0-9A-Za-z]+ {...} 
```

为了更好地解释自己，我试图识别的模式是：

```
CORRECT [1-9]*_[1-9]*0 
```

为了让 flex 只有在没有被其他字符包围时才能识别正确的模式，我必须添加这三个规则。

完整的弹性代码：

```
%option noyywrap

%{
#include <stdio.h>
int num_lines=1;

%}

CORRECT [1-9]*_[1-9]*0

%%
{CORRECT} { printf("CORRECT TOKEN:%s\n",yytext); }

[0-9A-Za-z]+{CORRECT}  { printf("ERROR %d:Unidentified symbol: %s\n",num_lines,yytext);}
{CORRECT}[0-9A-Za-z]+ { printf("ERROR %d:Unidentified symbol: %s \n",num_lines,yytext);}
[0-9A-Za-z]+{CORRECT}[0-9A-Za-z]+ { printf("ERROR %d:Unidentified symbol: %s  \n",num_lines,yytext); }

"\n" { num_lines++; }

 " "
 "\t"
 "\r"

 . { printf("ERROR %d:Unidentified symbol: %s \n",num_lines,yytext);}

 %%

 int main(int argc,char **argv)
 {
++argv,--argc;
if(argc>0) 
    yyin=fopen(argv[0],"r");
else
    yyin=stdin;
yylex();
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:42:49.117

空格在 lex 模式中很重要。 `a | b`不一样`a|b`。在麻烦的模式中，你有我认为你不想要的空格。

也就是说，在我看来，您的 3 模式解决方案更易于阅读和维护。

# python - Python 2.7.3 - ImportError：没有名为 PyInstaller 的模块

> ID：14532542
> 
> 赞同：0
> 
> 时间：2013-01-26T00:40:56.627
> 
> 标签：python, python-2.7

在过去的几个小时里，我一直试图弄清楚 PyInstaller，但我一直收到这个错误。如果有人能指出我如何解决这个问题的正确方向，我将不胜感激。我正在使用 PyInstaller 2.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:45:52.250

您能否尝试将其添加到您的 python 代码中：

```
import sys
sys.path.append('.') 
```

# html - Bootstrap 导航栏在 ie 上不起作用

> ID：14532547
> 
> 赞同：1
> 
> 时间：2013-01-26T00:41:29.313
> 
> 标签：html, css, twitter-bootstrap

我使用引导程序创建了一个网站，主要用于学习目的。我正在使用`<div class="navbar navbar-inverse">`. 我把我的网站放到服务器上，并请我的一些朋友检查一下。每个人都打电话说它看起来很棒，但后来有人说当他使用 Internet Explorer 时一切都乱七八糟（不知道确切的版本，但肯定是旧版本）我在 Internet Explorer 上试了一下，导航栏很乱。

列表项不是内联的。栏比应有的大两倍，文本带有下划线和紫色......

在过去的几天里，我一直在尝试解决这个问题，但我就是做不到。我应该如何让我的网站在每个浏览器中都表现得足够相似，这样它看起来才不会损坏？

这真的很令人沮丧，我准备接受任何来源 1\. 了解这个和 2\. 解决这个问题。

谢谢！

HTML 代码：

```
<html>
<head>
    <!--[if lt IE 9]-->
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <!--[endif]-->
    <title> College GPA </title>
    <link rel = 'stylesheet' type = 'text/css' href = "assets/css/style.css">
    <link rel = 'stylesheet' type = 'text/css' href = 'assets/css/bootstrap.min.css'>

    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
    <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>

    <script src = "assets/js/dropdown.js">
    </script>
    <script> 
        $(".dropdown-toggle").dropdown();
    </script>

</head>

<body>
    <div class="navbar navbar-inverse">
        <div class="navbar-inner">
            <div class="container">

              <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
              <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>

              <!-- Be sure to leave the brand out there if you want it shown -->
              <a class="brand" href="#" style = "font-size: 23px;">LOGO</a>

              <!-- Everything you want hidden at 940px or less, place within here -->
             <div class="nav-collapse collapse">
                <!-- .nav, .navbar-search, .navbar-form, etc -->
                <ul class = "nav">
                    <li class = 'active'> <a href = "#"> Home </a></li>
                    <li class = 'dropdown'> 
                        <a href = "#" class = 'dropdown-toggle' id = "dLabel" data-toggle = "dropdown">Drop Down <b class = 'caret'> </b></a>
                        <ul class = 'dropdown-menu' role = 'menu' aria-labelledby="dLabel">
                            <li> <a href = "#">Drop Down 1 </a> </li>
                            <li> <a href = "#">Drop Down 2 </a> </li>
                            <li> <a href = "#"> Drop Down 3</a> </li>
                        </ul>
                    </li>
                    <li class = 'dropdown'> 
                        <a href = "#" class = 'dropdown-toggle' id = "dLabel" data-toggle = "dropdown">Drop Down  <b class = 'caret'> </b></a>
                        <ul class = 'dropdown-menu' role = 'menu' aria-labelledby="dLabel">
                            <li> <a href = "#"> Drop Down 1   </a> </li>
                            <li> <a href = "#"> Drop down 2 </a> </li>

                        </ul>
                    </li>

                </ul>
         </div>

    </div>
  </div>
    </div>

    <div class = 'wrapper'>

    </div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:53:05.897

你不知道他使用的是什么版本并没有多大帮助......也许你应该问他？如果它足够老，则引导程序可能不支持它（IE < 7）。

如果是这种情况，请忽略它。很少有公司仍然支持旧版本的 IE，而那些支持的公司往往有特定的原因。

如果您正在寻找一种处理旧浏览器的好方法，也许您可​​以显示升级到较新浏览器的选项，并警告它可能无法在他们的浏览器中正确显示。

[http://gs.statcounter.com/](http://gs.statcounter.com/)是获取旧浏览器使用统计信息的好来源。从那里您可以决定是否真的要支持他们。

最后，您可以随时查看您网站的分析（如果您碰巧有一个现有的流量），看看是否值得您花时间维护对旧版浏览器的支持。

# iphone - 在第二个 viewController 中的 viewDidLoad 之后 EXC BAD ACCESS

> ID：14532556
> 
> 赞同：1
> 
> 时间：2013-01-26T00:42:37.620
> 
> 标签：iphone

HDLogOnViewController 在 HDLogOnViewController 的 tableview:didSelectRowAtIndexPath 方法中将两个变量传递给 HDDomicileViewController。

在 HDDomicileViewController 的 viewDidLoad 方法之后，应用程序崩溃并出现 EXC BAD ACCESS 错误。变量在 HDDomicileViewController 中验证正确。

我在没有帮助的情况下启用了僵尸。当我启用 Guard Malloc 时，应用程序运行正常。在 XCode 的输出视图中，没有指示是什么导致了错误。我在这里研究了许多 EXC BAD ACCESS 线程，并尝试使用属性而不是实例变量。我使用了四个 if 语句而不是 if else if。执行此操作时，应用程序将仅使用一个 if 语句正常运行，但会因多个 if 语句而崩溃。此外，使用四个 if 语句，我可以注释掉每个语句，它会崩溃，看起来问题出在 if 条件中。

如何发现导致错误的原因？

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

NSString *cellLabel = [NSString stringWithString:[[[HDLogOnStore sharedStore] cellTitleLabels] objectAtIndex:[indexPath row]]];

if ([cellLabel isEqualToString:@"Domicile"]) {

    tableViewArray = [[HDLogOnStore sharedStore] domiciles];
    tableViewArrayName = @"domiciles";

    NSLog(@"indexPath row is %i", [indexPath row]);
    NSLog(@"array name is %@", [[[HDLogOnStore sharedStore] cellTitleLabels] objectAtIndex:[indexPath row]]);
}

else if  ([cellLabel isEqualToString:@"Position"]) {

    tableViewArray = [[HDLogOnStore sharedStore] positions];
    tableViewArrayName = @"positions";

    NSLog(@"indexPath row is %i", [indexPath row]);
    NSLog(@"array name is %@", [[[HDLogOnStore sharedStore] cellTitleLabels] objectAtIndex:[indexPath row]]);
}

 else if ([cellLabel isEqualToString:@"BidRound"]) {

    tableViewArray = [[HDLogOnStore sharedStore] bidRounds];
    tableViewArrayName = @"bidRounds";

    NSLog(@"indexPath row is %i", [indexPath row]);
    NSLog(@"array name is %@", [[[HDLogOnStore sharedStore] cellTitleLabels] objectAtIndex:[indexPath row]]);
}

else if ([cellLabel isEqualToString:@"Month"]) {

    tableViewArray = [[HDLogOnStore sharedStore] months];
    tableViewArrayName = @"months";

    NSLog(@"indexPath row is %i", [indexPath row]);
    NSLog(@"array name is %@", [[[HDLogOnStore sharedStore] cellTitleLabels] objectAtIndex:[indexPath row]]);
}

HDDomicileViewController *domicileViewController = [[HDDomicileViewController alloc]init];
[domicileViewController setSelectedArray:tableViewArray];
[domicileViewController setSelectedArrayName:tableViewArrayName];

[self.navigationController pushViewController:domicileViewController animated:YES]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T16:35:11.143

我开始出现不一致的行为，所以我回到这里阅读更多帖子。

我按照建议解决了这个问题，以纠正在分析项目后发现的所有错误。我更正了一些看似无关的错误，例如“在初始化期间存储到‘配对’的值永远不会被读取”。我不确定这是否直接解决了问题，但在过程中的某个地方问题消失了。

供参考

该应用程序在 viewDidLoad 方法之后和 viewWillAppear 方法之前崩溃。一步一步的调试使我得到了我一无所知的机器代码。

```
- (void)viewDidLoad
{
   [super viewDidLoad];

   NSLog(@"selectedArray count is %i",[selectedArray count]);
   NSLog(@"selectedArray name is %@",selectedArrayName);
   NSLog(@"checkedRowMonth is %i",[[HDLogOnStore sharedStore]checkedRowMonth]);

}

- (void) viewWillAppear:(BOOL)animated
{
   [super viewWillAppear:animated];
} 
```

# javascript - 如何将文本文件中的信息导入 html 或 javascript

> ID：14532557
> 
> 赞同：0
> 
> 时间：2013-01-26T00:42:44.407
> 
> 标签：javascript, html

我目前正在创建一个需要访问存储在文本文件中的文本并将其解析为数据结构的网站。我想使用 javascript 函数或 html 标记来包含或调用文件，以便我可以解析它。但是，我似乎找不到一个好的方法来做到这一点。有什么建议么？

我不确定如何更具体，但也许一些伪代码可能会有所帮助。当前代码将遵循以下几行：

```
mylist = new Array();

function myfunc()
{
    var str = [get information from website];
    mylist.push(str);
} 
```

也就是说，如果网站有以下文字：

```
"<tag attr=str attr=str>text</tag>" 
```

mylist 的最新（或最后一个）元素是`"<tag attr=str attr=str>text</tag>".`

谢谢！

编辑：感谢您的快速回复。我试图避开 jquery（实际上，我正在网站中实现 angular），但我试图使用原生 javascript 方法而不是库。从回复来看，没有。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:50:35.543

您应该使用[XHR Object](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)，也就是“AJAX”方法。

以下是有关如何开始使用它[的概述。](https://developer.mozilla.org/en/docs/AJAX)

这是一段摘录：

```
function makeRequest(url, callback) {
  if (window.XMLHttpRequest) { // Mozilla, Safari, ...
    httpRequest = new XMLHttpRequest();
  }
  //i'd omit this if I don't support older browsers
  else if (window.ActiveXObject) { // IE
    try {
      httpRequest = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
      try {
        httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
      } catch (e) {}
    }
  }
  if (!httpRequest) {
    alert('Giving up :( Cannot create an XMLHTTP instance');
    return false;
  }
  httpRequest.onreadystatechange = function () {
    if (httpRequest.readyState === 4 && httpRequest.status === 200) {
      callback(httpRequest.responseText);
    } else {
      alert('There was a problem with the request.');
    }
  }
  httpRequest.open('GET', url);
  httpRequest.send();
}
//using
makeRequest('path/to/your/file', function (contents) {
  myList.push(contents);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:48:45.823

使用 Ajax 在您的 JS 代码中从服务器加载内容。

您`[get information from website];`应该替换为获取数据的函数。

考虑[在 $.get() 上为这个 jQuery Docs使用 jQuery](http://api.jquery.com/jQuery.get/)

或在 Ajax 上使用本机 JavaScript ajax [MDN 文档](https://developer.mozilla.org/en-US/docs/AJAX)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:50:41.723

你可以使用 jQuery $.get()

```
$.get('test.txt', function(data) {
  $('.result').html(data);
}); 
```

有关详细信息，请参阅[http://api.jquery.com/jQuery.get/ 。](http://api.jquery.com/jQuery.get/)

# java - 摇摆外行分页

> ID：14532560
> 
> 赞同：1
> 
> 时间：2013-01-26T00:43:08.397
> 
> 标签：java, swing, pagination

在我开始之前，存在类似的（我的）问题，我希望删除那个问题，因为我没有很好地解释我的观点，但不是这个问题。谢谢你。

首先，我没有代码，这只是一个我想不通的概念。但这很有趣（至少对我来说）。

你们都知道 MSWord 是如何工作的。你写东西。然后，当您填写一个页面时，它将创建一个新页面并开始在该页面上书写。如果您将更多文本粘贴到第一页，所有内容都将被下推。如果您删除页面上的一大块文本，它会吸收前一页上的一些文本。如果您正在处理例如图片并且您在页面顶部有一个，如果有足够的空间容纳图片的缩小版本，则减小它的大小会导致它被吸到上一页。

既然您是这样想的，我想将这个概念转移到 Java Swing 中。页面是 JPanel，图片和文本块（或行）是适合页面 JPanel 的 JPanel。

我想出了一个使用填充器的方法（好吧，我撒谎了，我有一些代码，但它是一团糟，而且无论如何它都不起作用），这在所有情况下都不起作用。如果您想知道原因，请阅读两行之间的内容，否则请跳过它。

* * *

因此，结构本身很容易复制，但维护它是一件令人头疼的事情。您会看到，可能会发生两种主要类型的事件：

```
a) height of the page content has increased
b) height of the page content has decreased 
```

通过使用 Filler 作为页面的最后一个组件，并附加一个 componentAdapter (componentResized)，您可以监控这些更改。

这些变化可以进一步分为：

```
a) element is added/removed to/from page
b) height of the element has increased/decreased 
```

考虑到这些事件，可能会发生很多事情。跳过简单的案例，看这个例子：

```
Page 1:
{element 1
blabla
blabla}
{element 2
blabla}
{element 3}
{element 4
blabla
blabla
blabla
blabla}
{free space
---
---
---} 
```

/

```
Page 2:
{element 1
blabla
blabla
blabla
blabla}
{element 2
blabla
blabla
blabla
blabla}
{element 3}
{element 4
blabla
blabla
blabla} 
```

/

```
Page 3:
{element 1}
{element 2}
{element 3}
{element 4}
{element 5}
{free space
---
---
---
---
---
---
---
---
---} 
```

每页的高度为 15 行。现在看看如果将第二页的元素 1 的高度减少一行会发生什么。它将变为 4 行高，使其适合上一页，被吸起。这将在第二页上创建 5（1 个删除的行 + 4 个被吸收的行）行的可用空间。这将吸收第三页上的所有五个元素，并将第三页留空（现在应该删除）。

这不起作用的原因是因为在删除时，会为第二页触发一个侦听器，它必须将顶部元素向上推，并从前一页中吸收元素。由于这一切都是在侦听器中完成的，因此我必须等待它执行才能在我的程序中注册视觉变化。由于它必须更改页面上的两件事，因此会导致某种听众混乱。页面高度减少了两次，但只注册了一次，最后我只能完全移动顶部或底部，或每侧的单个组件。这不是一个很好的解释，但如果你了解摇摆的工作原理，你应该能够自己连接这些点。

正如我之前提到的，我已经为此编写了代码，但是它很长而且很难遵循，如果有人愿意看到它，我可以在这里发布它。我说的是SSCCE 本身。它真的不能缩短为几十行代码。

* * *

我想要的是跳过编写一个算法来维护“文档”的结构并移动所有元素，因为这是一件非常复杂的事情，需要考虑所有众多案例。

我想要的是另一种选择，我问你是否有任何想法。我想到的一件事是有一个类似于 JPanel 的组件。它将具有可以与其他组件一起填充的固定高度部分，并且在它们之间具有不可填充（？）或“实心”的固定高度部分。

它的工作方式是每次您向可填充（？）部分添加一些东西时，它们都会自动重新排列。如果某些东西不适合当前可填充的部分，它只是移动到下一个（类似于垂直框布局的工作原理，将一个东西添加到一个点会推动所有其他东西向下），但会跳过实体部分。

因为我还必须能够判断某个组件在哪个可填充部分中，所以我不知道在 Java swing 中是否可以创建这样的结构。

好吧，欢迎任何建议，包括外部库。

请记住，整个文档是包含页面的文档，这些页面将一个接一个地放置在 JScrollPane 的视口中，这是对其外观的唯一限制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T19:55:55.373

让布局完成工作：`add()`的实例`JPanel`，每个实例都有基于内容的首选大小，`Box`具有垂直布局。放入`Box`一个`JScrollPane`，可选地实现`Scrolable`. 根据需要使用滚动窗格的行和列标题；`JTable`是一个例子。您可以根据需要从和`remove()`面板中选择。`Box``revalidate()``repaint()`

附录：最初的答案仅涉及问题的视图方面。它可能有助于更严格地分离模型和视图，就像[文本组件](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html)一样；从模型中删除内容并通知视图相应地更新自身。[为了实现这一点，这里](https://stackoverflow.com/a/3072979/230513)提到了几种实现观察者模式的常用方法。

# visual-studio-2012 - 当 C++ 依赖项更改时，Visual Studio 2012 不会生成 C# 项目

> ID：14532568
> 
> 赞同：1
> 
> 时间：2013-01-26T00:44:29.457
> 
> 标签：visual-studio-2012

我的解决方案中有三个项目：一个名为 LibX 的 C++ 项目、一个名为 LibX.NET 的 C# 项目，它使用 P/Invoke 包装 LibX.dll，以及一个名为 TestX 的 C# WPF 应用程序。

LibX.NET 被标记为依赖于 LibX，并且 TestX 将 LibX.dll 复制到其输出目录作为构建后步骤的一部分（因为我想不出更好的方法来确保 TestX 可以使用 LibX.dll）。

在 VS2010 中，当我在 LibX 中更改文件并构建时，LibX.NET 和 TestX 都已构建，因此它们的构建后事件会触发并且所有内容都是最新的。

但是，在 VS2012 中，当我更改 LibX 中的文件时，VS 不会构建 LibX.NET 和 TestX，声称它们是“最新的”。这是 VS2012 中的错误/回归，还是故意的？如何让 TestX 运行其构建后步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:42:03.190

如果您希望 LibX 中的更改触发 LibX.Net 中的构建，您需要反转这两个项目之间的项目依赖关系。

由于您已标记 LibX.Net 依赖于 LibX，因此您需要编译 LiX.Net 以构建两个项目。当您这样做时，两个项目都将根据是否进行了更改而被编译/跳过。这与 VS2010 中的行为相同。

# java - 矩阵“可以删除条件逻辑”检查样式

> ID：14532576
> 
> 赞同：8
> 
> 时间：2013-01-26T00:45:11.870
> 
> 标签：java, checkstyle

```
public static boolean isCompatibleForMultiplcation(final Matrix a, final Matrix b)  
    {
        if (a == null)
        {
            throw new IllegalArgumentException("a cannot be null");
        }
        if (b == null)
        {
            throw new IllegalArgumentException("b cannot be null");
        }

        if(!(a.getNumberofColumns()== b.getNumberOfRows()))
        {
            return false;
        }
        else
        {
            return true;
        }

    } 
```

对于以下方法，我在 checkstyle 中得到一个“条件逻辑可以被删除”参数。我似乎无法弄清楚为什么......有人可以给我一个指针吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-26T00:47:00.360

它在这里抱怨这部分：

```
 if(a.getNumberofColumns() != b.getNumberOfRows())
    {
        return false;
    }
    else
    {
        return true;
    } 
```

每当您看到自己编写这样的代码时，您只需从 if 语句中返回条件即可轻松地将其替换为一行：

```
return a.getNumberofColumns() == b.getNumberOfRows(); 
```

`true`如果 a 的列数和 b 的行数相等，则此语句将返回，`false`否则返回。

# templates - 运行时模板引擎的最佳选择？

> ID：14532582
> 
> 赞同：0
> 
> 时间：2013-01-26T00:46:35.630
> 
> 标签：templates, xslt, razor, transform, t4

我们正在设计一个应用程序，它将生成许多不同类型的文本输出，例如电子邮件、html、sms 等。输出将使用某种模板生成，数据来自数据库。我们的要求包括：

1.  模板中的基本逻辑/计算字段。例如“ifs”和“for”循环，以及添加税收百分比等内容
2.  运行时编辑。我们的用户需要能够根据自己的需要调整模板，例如更改样板文本、添加新逻辑等
3.  多语种。我们需要为当前的文化选择正确的模板。
4.  文化敏感。例如，日期和货币将根据当前的 ui 文化输出。
5.  灵活性。我们需要模板能够处理多个重复组、层次结构等。
6.  不能使用商业软件作为解决方案（例如 InfoPath）。我们需要能够随时修改源代码。

该应用程序是 c#.net。我们正在考虑使用 T4、XML + XSLT 或托管 Razor 引擎。鉴于语法对于非技术用户来说不会太繁琐，我们希望得到您的意见，您认为哪个模板引擎适合我们。我们也很乐意考虑尚未提及的内容。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T09:35:20.040

我很犹豫要不要在论坛上回答这个问题，因为技术选择取决于比问题中传达的更多的因素，包括对风险的态度、对开源的态度、以前的好坏经历、政治XSLT 相对于 Razor 的最大优势在于它是一个标准，并且在多个平台上具有多个实现（包括 .NET 上的至少三个实现！），因此没有锁定；但这似乎不是您的要求陈述中的一个因素。而且您使用.NET 的事实表明，供应商锁定无论如何都不是您担心的事情。

需要记住的一件事是，非程序员通常比程序员更快地接受 XSLT。它基于规则的声明性方法和它的 XML 语法有时会让程序员感到不舒服（这与他们以前见过的任何东西都不一样），但最终用户往往会像鸭子一样接受它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T15:07:37.090

我们决定使用 Razor Hosting。我发布此答案的原因是我认为如果包含以下文章链接会对其他人有所帮助：

[http://www.west-wind.com/weblog/posts/2010/Dec/27/Hosting-the-Razor-Engine-for-Templating-in-NonWeb-Applications](http://www.west-wind.com/weblog/posts/2010/Dec/27/Hosting-the-Razor-Engine-for-Templating-in-NonWeb-Applications)

Rick Strahl 的这一出色工作使托管 Razor 变得非常容易。

# windows-8 - 当我单击 www 文件夹中的文件夹时，WAMP 服务器将我定向到 Internet 位置

> ID：14532594
> 
> 赞同：0
> 
> 时间：2013-01-26T00:48:57.870
> 
> 标签：windows-8, localhost, wamp, wampserver

我在运行 Windows 8 Pro 的笔记本电脑上安装了 WAMP 服务器。

`www`我在文件夹中创建了多个文件`wamp`夹。我的问题是，每当我尝试从网络浏览器中的本地主机页面访问文件夹时，我都会被带到该文件夹​​的互联网页面，即我有两个名为`family`&的文件夹`prestashop`。每当我单击它们时，我的浏览器中都会打开一个选项卡，将我定向到`http://family/`而不是`http://localhost/family/`

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:35:15.017

如果没有看到您的`httpd.conf`（或`httpd-vhosts.conf`），很难说出您的问题在哪里（或为什么会出现问题）。通常，要设置多个站点，您需要将虚拟主机添加到您的`httpd.conf`或`httpd-vhosts.conf`当人们尝试访问该文件夹时，它会告诉 WAMP 该怎么做。`http://localhost/family`一个看起来像的网址之间的区别`http://family`可能是您设置了一个虚拟主机，它允许您访问该目录而无需通过“localhost”运行。

你的里面有这样的东西`http-vhosts.conf`吗`C:\wamp\bin\apache\Apache<version>\conf\extras\`？

```
<VirtualHost *:80>
  DocumentRoot "C:\wamp/www/family/"
  ServerName "family"
</VirtualHost> 
```

# reflection - 为什么 Rebol 3 不尊重带括号的引用函数参数？

> ID：14532596
> 
> 赞同：6
> 
> 时间：2013-01-26T00:49:55.283
> 
> 标签：reflection, rebol, symbolic-computation, rebol3

DO方言使用PAREN范畴系列！优先级，并且通常会在调用函数之前煮掉底层的括号结构。

但是，在 Rebol 2 中，过去可以在函数定义中指定您希望它在调用点抑制对括号的求值。您通过在参数上使用“文字”撇号标记来做到这一点：

```
evaluated: func [param] [probe param]

non-evaluated: func ['param] [probe param]

>> evaluated (1 + 2)
3

>> non-evaluated (1 + 2)
(1 + 2) 
```

所以你通过了一个系列！类别类型，属于 PAREN!...在这种情况下，内部包含三个符号元素：`1`, `+`, `2`. 这在 Rebol 3 中不起作用：

```
>> non-evaluated (1 + 2)
3 
```

这是一个错误还是一个有目的的设计决定？有解决方法吗？请注意，将引号运算符放在调用点不起作用，因为它`quote`是被引用的符号词，然后是括号！自行评估以成为表达式的最终值：-/

```
>> non-evaluated quote (1 + 2)
quote
== 3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:29:59.530

此参数传递类型的行为已被故意更改。（包括我自己在内的许多用户都要求更改）。优点是您可以使用括号请求对该参数类型的评估（请求评估的另一种方法是使用 get-word）。如果您想要真正未经评估的参数传递，请参见：

```
quote: make function! [[
    "Returns the value passed to it without evaluation."
    :value [any-type!]
][
    :value
]] 
```

与 R2 相比，这又是一个改进，在 R2 中，此类功能的行为方式并不完全相同。

如果你真的想通过一个paren！到您的函数，同时不想更改其定义以使用“真正未评估的参数传递”，您可以尝试以下操作：

```
non-evaluated (quote (1 + 2)) 
```

# azure - 我可以在一个分区中插入数百万行吗？（不需要良好的负载平衡）

> ID：14532601
> 
> 赞同：3
> 
> 时间：2013-01-26T00:50:15.170
> 
> 标签：azure, azure-storage, azure-table-storage

我为辅助角色设计了一个数据访问层，它将在一个 Azure 表分区上执行范围查询和批量插入。此分区可能包含数百万行。

虽然这个partition只会被少数worker消费，访问率合理，性能好不是关键要求，这样做有什么问题吗？行键索引的大小有限制吗？

我当然读过[Real World: Designing a Scalable Partitioning Strategy for Windows Azure Table Storage](http://msdn.microsoft.com/en-us/library/windowsazure/hh508997.aspx)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T02:44:13.550

我知道的分区大小没有明确的限制。

确实知道每个分区的操作数量有限制（500/秒），并且存储的可用性是在分区级别（即：如果分区出现故障，则其中的所有内容都会出现故障）

显然，批量插入一次将限制为不超过 100 个实体

# string - Matlab strcat不返回字符串？

> ID：14532603
> 
> 赞同：4
> 
> 时间：2013-01-26T00:50:19.853
> 
> 标签：string, matlab

imgstr 无法识别来自 strcat 的输出字符串。

```
homedir = 'C:\Users\...\images\';
for img = {'01.bmp', '02.bmp', '03.bmp'}
  imgstr = strcat(homedir, img)
  I = imread(imgstr);
end; 
```

输出：

```
imgstr = 'C:\Users...\images\01.bmp'
Error using imread>parse_inputs (line 477)
The filename or url argument must be a string. 
```

strcat 应该返回一个字符串，而不是 char 数组，因为我的输入是字符串。不应该吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:00:51.327

您的问题在于 MATLAB 如何迭代元胞数组。 [这是一个相关的问题/答案。](https://stackoverflow.com/questions/10687611/iterating-over-a-list-of-strings-in-matlab)

在循环内添加 a`{1}`以提取 char 数组，它应该可以工作：

```
imgstr = strcat(homedir, img{1}) 
```

# c# - 更新绑定的 Observable 集合的一个元素

> ID：14532609
> 
> 赞同：3
> 
> 时间：2013-01-26T00:50:43.140
> 
> 标签：c#, listview, gridview, binding, observablecollection

我有一个可观察的集合，`songInfo`里面有一个自定义类。
它绑定到一个`ListView`. 这是绑定的代码：

**C#**：

```
var songData = new ObservableCollection<songInfo>();

public ObservableCollection<songInfo> _songData
{ 
    get 
    { 
        return songData; 
    } 
}

public class songInfo
{
    public string Title { get; set; }
    public string Artist { get; set; }
    public string Album { get; set; }
    public string Location { get; set; }
    public string Ext { get; set; }
    public bool isSongPlaying { get; set; }
} 
```

**XAML**：

```
<Window x:Class="Genesis.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Genesis (Alpha)" Height="897" Width="882" Loaded="Window_Loaded"
    DataContext="{Binding RelativeSource={RelativeSource Self}}" Name="Genesis">

    <ListView Margin="12,39,0,0" Name="Library" DataContext="{Binding}" ItemsSource="{Binding _songData}" Height="681" VerticalAlignment="Top" MouseDoubleClick="Library_MouseDoubleClick"  ContextMenu="{StaticResource MyContextMenu}" AlternationCount="2" Background="AliceBlue" HorizontalAlignment="Left" Width="846">
        <ListView.View>
            <GridView x:Name="gvLibrary">
                <GridViewColumn Width="20" Header="hi" DisplayMemberBinding="{Binding isSongPlaying}" x:Name="gvColumnPlaying" />
                <GridViewColumn Width="220" Header="Title" DisplayMemberBinding="{Binding Title}" x:Name="gvColumnTitle" />
                <GridViewColumn Width="180" Header="Artist" DisplayMemberBinding="{Binding Artist}" x:Name="gvColumnArtist" />
                <GridViewColumn Width="180" Header="Album" DisplayMemberBinding="{Binding Album}" x:Name="gvColumnAlbum" />
                <GridViewColumn Width="180" Header="Location" DisplayMemberBinding="{Binding Location}" x:Name="gvColumnLocation" />
                <GridViewColumn Width="80" Header="File Type" DisplayMemberBinding="{Binding Ext}" x:Name="gvColumnFileType" />
            </GridView>
        </ListView.View>
    </ListView> 
```

songInfo 填充在我的代码中的其他点。添加或删除元素时，会更新 ListView。但是，有些地方我只是简单地更改`songInfo.Ext`or`songInfo.Location`等​​。我找到了一种复杂的方法来执行此操作并进行更新，但我不得不删除该元素并重新添加它：

```
songInfo temp = songData[playing_song_index];
songData.RemoveAt(playing_song_index);
songData.Insert(playing_song_index, new songInfo()
{
    Title = temp.Title,
    Artist = temp.Artist,
    Album = temp.Album,
    Location = temp.Location,
    Ext = temp.Ext,
    isSongPlaying = true
}); 
```

这会将 isSongPlaying 更改为 true。

**有没有更简单的方法来更新 GridView 的一个“列”？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T00:56:16.813

你的`songInfo`班级需要实现[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx).

如果你正确地实现了这个接口，那么对类成员的更改将通过绑定自动反映在用户界面中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T00:58:50.427

如果 songInfo 不使用 INotifyPropertyChanged，那么您所做的将起作用。您可以通过以下方式对其进行清理：

```
var mySong = songData.//get your song
int index = songData.IndexOf( mySong );
songData.Remove( mySong  );
songData.Insert( index, mySong ); 
```

# android - 如何编写查询以连接 2 个表并仅返回在一组可能性中包含多个子记录的记录

> ID：14532610
> 
> 赞同：0
> 
> 时间：2013-01-26T00:50:44.437
> 
> 标签：android, sql, sqlite, join, left-join

> **可能重复：**
> [如何过滤 SQL 结果中的多通关系](https://stackoverflow.com/questions/7364969/how-to-filter-sql-results-in-a-has-many-through-relation)

我正在为我的 android 应用程序编写一条 SQL 语句，该应用程序具有特殊的 JOIN 要求。有 2 张桌子，一张用于 PERSON，一张用于 INTEREST。一个人可能有多个利益。

我正在寻找一个只返回具有**所有**指定兴趣的人的查询。这是我的示例表：

```
PERSON
_id | name
1   | Bob
2   | Harry
3   | Lucy
4   | Sally

INTERESTS
_id | person | interest
1   | bob    | skiing
2   | bob    | biking
3   | bob    | swimming
4   | harry  | skiing
5   | harry  | surfing
6   | harry  | swimming 
```

我希望查询找到所有喜欢滑雪和骑自行车的人（即只有鲍勃）。如果可能的话，我也会撒谎只为鲍勃返回一次记录。SQLite 可以做这样的查询吗？如果是这样，怎么做？

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:14:04.687

我通常会多次加入表格，但如果您不知道搜索条件，这可能会很棘手。这意味着，如果您按 2 个不同的兴趣进行搜索，您将加入兴趣表两次。

这样的事情将适用于您上面的问题：

```
select distinct p.name
from person p
    join interests i on p.name = i.person and i.interest = 'skiing'
    join interests i2 on p.name = i2.person and i2.interest = 'biking' 
```

这应该让您返回 Bob。

作为旁注，您应该将 personid 存储在您的兴趣表中，而不是名称中。并考虑引入带有 PersonId 和 InterestId 的 PersonInterests 表——这对于规范化会更好。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T06:33:11.263

也许这个：

SELECT p.name FROM person p JOINinterests i on p.name = i.person GROUP BY p.name HAVING count(*) = 2 WHERE i.interest in ('skiing', 'biking')。

我同意最好在兴趣表中使用人员 ID 而不是名称。另一个建议：你应该有一个单独的表和兴趣 id，并且表人兴趣中只有两个 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T08:44:53.703

除了其他解决方案之外，使用`Exists()`运算符是执行此类请求的一种简单方法，例如：

```
SELECT p.* FROM person p Where Exists (Select * from interests i where i.person = p.name and i.interest = 'skiing') and Exists (Select * from interests i where i.person = p.name and i.interest = 'biking') 
```

此外，您应该将表的 存储`_id`为表`person`中的外键，`interests`而不是`name`. 这样，您可以拥有多个同名的人，或者稍后更改一个人的姓名，而无需更改其他相关表中的值。

`interests`使用复数形式作为表名，而使用单数形式作为表名也不是一个好主意`person`。

# ruby-on-rails - 多级模型导轨

> ID：14532615
> 
> 赞同：0
> 
> 时间：2013-01-26T00:51:12.440
> 
> 标签：ruby-on-rails, controller, multi-step

我想由用户使用多个创建步骤来创建一个事件。目前我有以下问题，它在完成第二步后重定向到第一步。

以下是我的控制器

```
def new 
  @event = Event.new(params[:event])
  @user = current_user
  respond_to do |format|
    if @event.save
      format.html { render :template => "events/new2" }
      format.json { render json: event_new2, status: :created, location: @event }
    else
      format.html { render action: "new" }
      format.json { render json: @event.errors, status: :unprocessable_entity }
    end
  end
end

def event_new2
  @event = Event.find(params[:id])
  respond_to do |format|
    if @event.update_attributes(params[:event])
      format.html { render :template => "events/new3" }
      # format.json { render json: event_new2, status: :created, location: @event }
    else
      format.html { render action: "event_new2" }
      format.json { render json: @event.errors, status: :unprocessable_entity }
    end
  end
end

 # POST /events
 # POST /events.json
def create
  @event = Event.new(params[:event])
  @user = current_user
  respond_to do |format|
    if @event.save
      format.html { redirect_to @event, notice: 'event erfolgreich erstellt.' }
      format.json { render json: @event, status: :created, location: @event }
    else
      format.html { render action: "new" }
      format.json { render json: @event.errors, status: :unprocessable_entity }
    end
  end
end 
```

我的模型只需要存在标题和描述。意见如下：

步骤1

```
<%= simple_form_for (@event), :method => 'new' do |f| %>  
  <%= f.error_notification %>
  <%= f.input :title,:label => 'Event Titel' ,:placeholder=>"Titel des Events"%>
  <%= f.text_area :description,:label => 'Beschreibung',:placeholder=>"Beschreibung"%>
  <%= f.submit "Event erstellen", class: "btn btn-large btn-primary pull-right"%> 
```

第2步

```
<%= simple_form_for (@event), :method => 'new' do |f| %>  
  <%= f.error_notification %>
  <%= f.input :category%>
  <%= f.input :website, :label=>"Website"%> 
```

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T02:21:04.230

创建模型的常规一步法是让某人转到`new`将调用`new`控制器并呈现页面的`new`页面。用户填写表单并点击驱动`create`控制器的提交。如果可行，它会重定向到该`show`页面。

如果我要进行两步创建，我可能仍然会先转到`new`页面并让它调用`create`操作，但是我不会保存模型，而是渲染`step2`页面并让他们填写更多详细信息并包括隐藏字段中的详细信息的第一页。我会让该表单调用与第一个不同的操作，此时我将保存模型。相反，我可以让第一个表单调用该`step2`操作，然后让该页面调用该`create`操作。另一种选择是在步骤 1 之后保存模型并在步骤 2 中检索它。如果 step1 成功，但 step2 失败，这个选项会有点难看。

您的`new`控制器会将模型保存到数据库中（无需任何用户输入），然后呈现`new2`页面。我高度怀疑这是你想要的。如果是，我强烈建议不要这样做。

我假设 Step1 是您为之渲染的，`new2`而 Step 2 是您为之渲染的`new3`。然而，这两种形式都将调用`update`控制器（未显示）。该方法`new`也不标准，我有点惊讶它没有窒息。标准方法是`:get`、`:post`、`:put`和`:delete`。您也许可以在您的路线配置中创建非标准的，但我不推荐它。如果您想将表单定向到您的`new2`控制器，那么您需要设置一条路线并使用该`:url`选项将`form_for`其到达那里。

我希望这会有所帮助。

# android - 设置警报管理器

> ID：14532617
> 
> 赞同：0
> 
> 时间：2013-01-26T00:51:18.210
> 
> 标签：android, alarmmanager

我正在按照[此处](https://stackoverflow.com/questions/4459058/alarm-manager-example)发布的有关设置警报管理器的代码进行操作，但我根本无法使其正常工作。

这段代码在一个名为“Alarm”的类中：

```
package com.sjjgames.abortionapp;
    import android.app.AlarmManager;
    import android.app.PendingIntent;
    import android.content.BroadcastReceiver;
    import android.content.Context;
    import android.content.Intent;
    import android.os.PowerManager;
    import android.widget.Toast;

    public class Alarm extends BroadcastReceiver 
    {    
         @Override
         public void onReceive(Context context, Intent intent) 
         {   
             PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
             PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "");
             wl.acquire();

             // Put here YOUR code.
             Toast.makeText(context, "Alarm !!!!!!!!!!", Toast.LENGTH_LONG).show(); // For example

             wl.release();
         }

     public void SetAlarm(Context context)
     {
         AlarmManager am=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
         Intent i = new Intent(context, Alarm.class);
         PendingIntent pi = PendingIntent.getBroadcast(context, 0, i, 0);
         am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), 5000, pi); // Millisec * Second * Minute
     }

     public void CancelAlarm(Context context)
     {
         Intent intent = new Intent(context, Alarm.class);
         PendingIntent sender = PendingIntent.getBroadcast(context, 0, intent, 0);
         AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
         alarmManager.cancel(sender);
     }
 } 
```

我已将此代码添加到清单中：

```
<receiver android:process=":remote" android:name="Alarm"></receiver>
<service android:enabled="true" android:name="com.sjjgames.abortionapp.YourService" />
<uses-permission android:name="android.permission.WAKE_LOCK"/>
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/> 
```

这是在一个名为“YourService”的类中：

```
package com.sjjgames.abortionapp;
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.IBinder;

public class YourService extends Service
{
    Alarm alarm = new Alarm();
    public void onCreate()
    {
        super.onCreate();       
    }

    public void onStart(Context context,Intent intent, int startId)
    {
        alarm.SetAlarm(context);
    }

    @Override
    public IBinder onBind(Intent intent) 
    {
        return null;
    }
} 
```

我希望每 5 秒显示一次吐司。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:32:15.310

您的服务不调用 onStart() 方法。您需要使用 onStartCommand() 而不是 onStart() 方法：

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    alarm.setAlarm(this);
    return START_NOT_STICKY;
} 
```

我建议您为类中的每个重写方法添加 @Override 注释。因此，如果您将 @Override 添加到 onStart() 方法，代码将无法编译，并且更容易发现错误。

# mysql - SQL查询 - 查找不存在子帖子的父帖子

> ID：14532618
> 
> 赞同：0
> 
> 时间：2013-01-26T00:51:21.960
> 
> 标签：mysql, sql

我正在使用以下查询：

```
SELECT 
count(tblReplies.repDate) as comReplies,
tblReplies.repDate
FROM tblReplies, tblQuestions, tblUsers
WHERE
tblQuestions.queID = tblReplies.repQuestionID 
AND tblQuestions.queCompanyID = tblUsers.uCompanyID
AND tblUsers.uID = tblReplies.repUserID 
AND tblUsers.uCompanyID = $comID 
AND tblQuestions.queID = $queID 
GROUP BY tblReplies.repID 
ORDER BY tblReplies.repDate ASC 
```

现在，我正在尝试修改查询以查找 tblQuestions (queID) 中没有回复的帖子（数据库 tblReplies 中没有子项的问题）。任何人都有一个想法，我完全迷路了，希望那里有一个忍者:)

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:55:34.210

```
select q.*
from tblQuestions q 
left outer join tblReplies r on q.queID = r.repQuestionID
where r.repQuestionID is null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:54:49.627

使用[`NOT EXISTS`](http://dev.mysql.com/doc/refman/5.1/en//exists-and-not-exists-subqueries.html)：

```
SELECT q.* 
FROM   tblquestions q
WHERE  NOT EXISTS (SELECT 1 
                   FROM   tblreplies r
                   WHERE  r.repquestionid = q.queid) 
```

# perl - DBIx::Class::Schema::Loader 连接到不同机器上的数据库

> ID：14532619
> 
> 赞同：3
> 
> 时间：2013-01-26T00:51:35.027
> 
> 标签：perl, schema, catalyst, dbix-class

我正在通过命令行使用[DBIx::Class:Schema::Loader](https://metacpan.org/module/DBIx::Class::Schema::Loader)从我的数据库为我的 Catalyst 应用程序的 DBIx::Class 生成模式。这是我使用的命令：

```
script/myapp_create.pl model DB DBIC::Schema myapp::Schema create=static \
components=TimeStamp,PassphraseColumn dbi:mysql:mydb 'root' '' '{ AutoCommit => 1 }' 
```

但是，此命令现在不起作用，因为我的数据库位于单独的计算机上。我如何告诉它连接到什么IP？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:19:48.713

我最终弄清楚了该怎么做。似乎如果您在最后一个哈希之后传入另一个哈希，该哈希将用于您的连接信息。所以只需将其添加到末尾：

```
'{host=>"ip_here"}' 
```

解决了这个问题。这是完整的命令：

```
script/myapp_create.pl model DB DBIC::Schema myapp::Schema create=static \
components=TimeStamp,PassphraseColumn dbi:mysql:mydb 'root' ''           \
'{ AutoCommit => 1 }' '{host=>"ip_here"}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T00:59:07.640

dbi:mysql:... 参数是一个普通的 DBI 连接字符串。在第一个之后：是数据库驱动程序（DBD），在第二个之后是 DBD 特定参数。阅读 DBD::mysql 文档以了解如何在远程机器上指定数据库。

# eventbrite - 如何使用 app_key 获得 eventbrite 与会者？

> ID：14532621
> 
> 赞同：0
> 
> 时间：2013-01-26T00:51:48.100
> 
> 标签：eventbrite

我正在尝试让参与者参加我使用 [https://www.eventbrite.com/json/event_list_attendees?app_key=MYAPPKEY&id=MYEVENTID创建的活动](https://www.eventbrite.com/json/event_list_attendees?app_key=MYAPPKEY&id=MYEVENTID)

但是它失败并出现错误：

```
{"error": {"error_type": "Not Found", "error_message": "Invalid email and/or password."}} 
```

在示例中，我已经替换了 app_key 和 id，但它们是有效的。如果我将它们更改为无效值，我会收到“此应用程序密钥无效”。和“没有这样的事件。[XXX]”

由于该活动是由我请求 app_key 的同一帐户创建的，因此我认为我应该能够检索与会者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T19:17:04.387

请参阅[API 身份验证页面](http://developer.eventbrite.com/doc/authentication/)。访问此 API 方法时，您需要提供用户凭据（除了您的开发人员密钥）。

# java - Hibernate HQL 查询导致 SQLGrammarException

> ID：14532625
> 
> 赞同：2
> 
> 时间：2013-01-26T00:53:00.997
> 
> 标签：java, mysql, hibernate, sqlexception

执行随附的代码时，我收到一个 SQLGrammarException，没有进一步的解释。我正在对 mysql 数据库执行此代码。有人能理解这个查询有什么问题吗？

```
 public PatientId getPatientByAccount(String account_) {
    Session session = null;
    PatientId patient = null;
    try {

        session = HibernateUtils.beginTransaction("emscribedx");
        session.beginTransaction();
        String queryString = "from PatientId where acct = :acct";
        Query query = session.createQuery(queryString);
        query.setString("acct", account_);
        Object queryResult = query.uniqueResult();
        patient = (PatientId)queryResult;
        session.getTransaction().commit();

    } catch (HibernateException e_) {
        System.out.println("Problem getting patientId for acct=" + account_
                + " " + e_.toString());
        NTEVENT_LOG.error("Problem getting patientId for acct=" + account_
                + " " + e_.getStackTrace());
    } finally {
        if (session != null && session.isOpen()) {
            try {
                HibernateUtils.closeSessions();
            } catch (HibernateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }
    return patient;

} 
```

如果有帮助，查询将生成以下 sql：

```
 select
    patientid0_.pid as pid7_,
    patientid0_.aprdrg as aprdrg7_,
    patientid0_.fid as fid7_,
    patientid0_.acct as acct7_,
    patientid0_.create_date as create5_7_,
    patientid0_.mr as mr7_,
    patientid0_.sex as sex7_,
    patientid0_.race as race7_,
    patientid0_.age as age7_,
    patientid0_.AdmitDate as AdmitDate7_,
    patientid0_.admittime as admittime7_,
    patientid0_.DischargeDate as Dischar12_7_,
    patientid0_.held as held7_,
    patientid0_.drgweight as drgweight7_,
    patientid0_.drgtext as drgtext7_,
    patientid0_.encodersystem as encoder16_7_,
    patientid0_.mdc as mdc7_,
    patientid0_.illnessSeverity as illness18_7_,
    patientid0_.mortalityRisk as mortali19_7_,
    patientid0_.eminfo as eminfo7_,
    patientid0_.emtime as emtime7_,
    patientid0_.Dischargetime as Dischar22_7_,
    patientid0_.Birthdate as Birthdate7_,
    patientid0_.transferfrom as transfe24_7_,
    patientid0_.DischargeDisp as Dischar25_7_,
    patientid0_.transferto as transferto7_,
    patientid0_.patientType as patient27_7_,
    patientid0_.admitReason as admitRe28_7_,
    patientid0_.DischargeNum as Dischar29_7_,
    patientid0_.admitSource as admitSo30_7_,
    patientid0_.admitType as admitType7_,
    patientid0_.prevstatus as prevstatus7_,
    patientid0_.patientLast as patient33_7_,
    patientid0_.patientFirst as patient34_7_,
    patientid0_.patientMiddle as patient35_7_,
    patientid0_.drg as drg7_,
    patientid0_.assignTo as assignTo7_,
    patientid0_.groupid as groupid7_,
    patientid0_.newDocs as newDocs7_,
    patientid0_.assignOrder as assignO40_7_,
    patientid0_.serviceType as service41_7_,
    patientid0_.dischargeDispFlag as dischar42_7_,
    patientid0_.PendingInfo1 as Pending43_7_,
    patientid0_.MaritalStatus as Marital44_7_,
    patientid0_.FinancialClass as Financi45_7_,
    patientid0_.MedicalService as Medical46_7_,
    patientid0_.assign_date as assign47_7_,
    patientid0_.assignby as assignby7_,
    patientid0_.ADTID as ADTID7_,
    patientid0_.notes as notes7_,
    patientid0_.CycleBeginDate as CycleBe51_7_,
    patientid0_.CycleEndDate as CycleEn52_7_,
    patientid0_.grouper as grouper7_,
    patientid0_.EstReimbursement as EstReim54_7_,
    patientid0_.initialdrg as initialdrg7_,
    patientid0_.product as product7_,
    patientid0_.billtype as billtype7_,
    patientid0_.PendingInfo2 as Pending58_7_,
    patientid0_.pendinginfo as pending59_7_,
    patientid0_.location as location7_,
    patientid0_.status as status7_ 
from
    emscribedx.patientid patientid0_ 
where
    patientid0_.acct=? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T04:39:34.520

事实证明，数据库已更改，因此 hibernate 使用的底层模型具有不在数据库中的列。这导致休眠抛出 sqlgrammarException。不幸的是，Hibernate 异常不像直接 jdbc 调用数据库那样提供信息。

# drupal - Drupal 分类法 谷歌地图

> ID：14532629
> 
> 赞同：-1
> 
> 时间：2013-01-26T00:53:16.757
> 
> 标签：drupal, drupal-taxonomy

我正在尝试列出带有分类术语的地点列表。现在，我有一个显示我所有条款的视图，但我想为每个条款添加一个“在地图上查看”链接，以打开带有所选地点位置的谷歌地图。谁能指出我正确的方向来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T08:57:59.893

您可以尝试地理分类模块，您可以在其中为每个分类设置纬度/经度。我认为要实现您提到的“在地图上查看”功能，您需要从分类中获取纬度/日志并编写一些代码以在地图中显示该位置。

[http://drupal.org/project/geotaxonomy](http://drupal.org/project/geotaxonomy)

# meteor - 流星数据库延迟

> ID：14532630
> 
> 赞同：1
> 
> 时间：2013-01-26T00:53:21.920
> 
> 标签：meteor

我的流星目录由 2 个文件组成：

社会.js：

```
Messages = new Meteor.Collection("messages");

if (Meteor.isServer) {
}

if (Meteor.isClient) {
    Template.temple.messages = function() {
        return Messages.find();  
    };

    Meteor.startup(function () {
            console.log('console startup: ' + Messages.find().count());
    });

    console.log('console normal: ' + Messages.find().count());

    var ali = function() {
        console.log('console normal: ' + Messages.find().count());
    };

    setTimeout(function() {
        console.log('console normal: ' + Messages.find().count());
    }, 2000);
    // The callback function is not called on the following line:
    Meteor.subscribe('messages',function(){alert('ALERT!');});
} 
```

社会.html：

```
<head>
<title>naber</title>
</head>

<body>
{{> temple}}
</body>

<template name = "temple">
{{#each messages}}
{{message}} <br />
{{/each}}
</template> 
```

该集合仅在经过一段时间后才完全加载。如果我环绕一个`setTimeout`. 在数据库真正完全可用后，我能做些什么来确保我的功能被执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T22:33:25.760

`Meteor.subscribe(NAME)`与`Meteor.publish(NAME)`. 您的代码尝试订阅名为的`"messages"`内容，但您没有发布具有该名称的内容。

您正在获取数据的事实表明您正在使用默认`autopublish`包（请参阅`.meteor/packages`查看），这意味着您不必显式发布或订阅数据。不幸的是，当自动发布的数据准备好（这可能应该修复）时，没有办法获得回调。所以如果你想这样做，你会想要`meteor remove autopublish`并使用`Meteor.publish`来发布你想要发布的数据；然后，您实际上可以使用`Meteor.subscribe`回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T02:15:53.720

我通常会显示一个加载指示器，直到订阅加载完毕。看这个例子：[Meteorjs loading message](https://stackoverflow.com/questions/14171294/meteorjs-loading-message)

从服务器端发布集合：

```
if (Meteor.isServer) {
  Meteor.publish("messages", function () {
    return Messages.find(); // everything
  );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T14:54:48.743

由于 Meteor 中反应性的工作方式，您始终需要针对服务器尚未将数据发送到客户端的位置设计应用程序状态。您可以将此称为“加载”状态。

在`Template`声明中，您必须始终检查您依赖的数据是否可用。如果模板确实依赖于数据，则希望它首先呈现为空，然后在数据到达时进行更新，因为数据是一个反应式数据源。

使用您自己的函数，最好以它们也依赖于反应式数据源的方式编写它们，并使用类似`Meteor.autorun`的方法确保在此类数据源更改时重新执行它们。

总是把你想在页面加载后运行的代码放在里面`Meteor.startup`，否则当你的代码执行时你甚至可能没有 Meteor 可用。

以下是我将如何重写您的代码：

```
Messages = new Meteor.Collection("messages");
if (Meteor.isClient){
  Meteor.startup(function() {
    // anything you need to do, like subscriptions 
  });
  Template.temple.loading = function() {
    return Messages.find().count === 0 ? "Loading..." : "";
  }
  Template.temple.messages = function() {
    var messages = Messages.find();
    if (messages.count() > 0) return messages;
  }
}

<template name="messages">
  {{loading}}
  {{#each messages}}
    {{message}}<br>
  {{/messages}}
</template> 
```

`Meteor.subscribe`如果您只是在客户端上使用，则实际上不需要调用消息`Messages.find()`。

# git - 使用钩子在 git push 上重新启动服务器

> ID：14532632
> 
> 赞同：-1
> 
> 时间：2013-01-26T00:53:42.823
> 
> 标签：git, bash, rvm

我正在尝试让我的更新后 git 挂钩停止服务器，从更新的存储库中提取更改，然后再次启动服务器。钩子正在运行，但它不断吐出错误。

以下是错误：

```
remote: RVM is not a function, selecting rubies with 'rvm use ...' will not work.
remote: You need to change your terminal emulator preferences to allow login shell.
...
remote: /home/user/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find thin (>= 0) amongst [] (Gem::LoadError)
...
remote: fatal: Not a git repository: '.' 
```

这是更新后的文件：

```
#!/bin/sh
PATH=/home/... (the value of "echo $PATH" on the remote server)
rvm use 1.9.3
cd /home/project_directory
thin stop
git pull ../gitdirectory.git
thin start -e production -p 3000 -d 
```

即使将 rvm 和 thin 替换为它们的确切位置，即“哪个 rvm”，也无法解决错误。

任何人都可以对这里出了什么问题有所了解吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T03:59:37.027

这个`rvm`问题是众所周知的，令人恼火的，并[在其他地方得到了回答。](https://stackoverflow.com/a/11283066/877115)[尝试rvm 站点](https://rvm.io/workflow/scripting/)上列出的技术。至于`git`错误，看起来您只是在错误的目录中发出命令。您是否尝试过以钩子用户的身份在服务器上运行它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T12:13:10.117

因为`rvm use ...`您需要，`source $HOME/.rvm/scripts/rvm`但这不适用于您在 shebang 中使用的外壳`#!/bin/sh`。

而是尝试这个脚本：

```
#!/bin/sh

cd /home/project_directory
source $( $HOME/.rvm/bin/rvm in . do rvm env --path )
thin stop
git pull ../gitdirectory.git
thin start -e production -p 3000 -d 
```

# python - 减少 GAE hrd(db) 读取操作计数

> ID：14532634
> 
> 赞同：2
> 
> 时间：2013-01-26T00:53:54.997
> 
> 标签：python, google-app-engine, google-cloud-datastore

为了降低 GAE Python 的使用成本，我想优化 DB 读取操作。你有什么建议吗？

我不明白为什么 GAE 显示的数据库读取操作比我想象的要多。如果你能给出 GAE 如何计算数据库读取操作的一般逻辑，它也应该非常有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T03:32:11.553

您可以在此处获取低级别操作（小型、读取、写入）中高级操作（获取、查询、放置、删除...）成本的完整细分 - [https://developers.google.com /appengine/docs/billing](https://developers.google.com/appengine/docs/billing)（向下滚动大约一半）。

我强烈建议使用[AppStats](https://developers.google.com/appengine/docs/python/tools/appstats)来帮助追踪您的读取操作的来源。需要注意的一件大事是不要使用for 分页`offset`选项，因为这只会跳过结果，但仍然需要读取。`.fetch()`这意味着如果你这样做`.fetch(10, offset=20)`，它将花费你 30 次阅读。您想改用[查询游标](https://developers.google.com/appengine/docs/python/ndb/queries#cursors)。

另一个优化是通过键获取[`.get(keys)`](https://developers.google.com/appengine/docs/python/datastore/modelclass#Model_get)（但是`.get()`对于同一个实体，a 只需要读取 1 次。您可能还想查看使用[投影查询](https://developers.google.com/appengine/docs/python/ndb/queries#projection)，该查询花费 1 次读取，但每个检索到的投影实体只有 1 个小（*注意：*所有投影的属性都必须被索引）。

此外，如果您还没有，您应该使用[NDB API](https://developers.google.com/appengine/docs/python/ndb/)，它会自动[缓存](https://developers.google.com/appengine/docs/python/ndb/cache)fetches 并有助于减少您的读取操作。与官方文档一起，Rodrigo 和 Guido 的[NDB 备忘单](https://docs.google.com/document/d/1AefylbadN456_Z7BZOpZEXDq8cR8LYu7QgI7bt5V0Iw/edit)是从 ext.db 过渡到 ndb 的好方法。

*在此处管理数据存储使用情况*下有一些很好的提示： [https ://developers.google.com/appengine/articles/managing-resources](https://developers.google.com/appengine/articles/managing-resources)

最后，您可能还对使用[gae_mini_profiler](https://github.com/kamens/gae_mini_profiler)感兴趣，它可以方便地访问当前请求的 AppStats，以及其他有用的分析和日志记录信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:01:24.997

很难说为什么没有看到您的代码，但如果您还没有看到，请使用 memcache 来节省数据库读取。

[https://developers.google.com/appengine/docs/python/memcache/usingmemcache](https://developers.google.com/appengine/docs/python/memcache/usingmemcache)

# javascript - 在 localStorage 上调用 jquery changePage()

> ID：14532636
> 
> 赞同：0
> 
> 时间：2013-01-26T00:54:02.933
> 
> 标签：javascript, jquery, html, jquery-mobile

我有一个简单的 jquery 移动页面：

```
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.2">
    <link rel="stylesheet" href="js/jquery.mobile-1.2.0.css" />
    <script src="js/jquery-1.8.2.js"></script>
    <script src="js/jquery.mobile-1.2.0.js"></script>
</head>
  <body>
    <div id="MyContainer">

        <!-- ##################### Raw Part ##################### -->
        <div data-role="page">
            <div data-role="header">
                <h1> Hello World </h1>
            </div>                        
        </div>

    </div>
  </body>
</html> 
```

当我执行该页面时，它会呈现黑色标题和标题。

该页面正确加载的原因是jquery-mobile在需要的地方放置了新属性，实际上页面加载后MyContainer的innerHTML是：

```
<!-- ##################### Parsed Part ##################### -->
<div data-role="page" data-url="/jqueryMobile/TC_Page/main2.html" tabindex="0" class="ui-page ui-body-c ui-page-active" style="min-height: 1464px;">
    <div data-role="header" class="ui-header ui-bar-a" role="banner">
          <h1 class="ui-title" role="heading" aria-level="1">
                Hello World
          </h1>
    </div>
</div> 
```

换句话说，*Raw Part*变成了*Parsed Part*。

**我想知道是什么 jquery.mobile 函数将原始部分转换为解析部分！**

**功能`$.mobile.changePage()`，`$.mobile.loadPage()`使我能够做到这一点**例如我可以这样做：

```
// place response from SomeUrl inside the div MyContainer and convert it from raw to parsed!
$.mobile.loadPage('SomeUrl', { pageContainer: $('#MyContainer') });

// later then get the child child (note second child) of MyContainer and make that the child of MyContainer 
```

## 现在的问题是：

所有这些函数：loadPage、ChangePage 等都会进行 ajax 调用。**如果我已经有了要注入的 html 怎么办（我在 webBrowser 本地存储或 Cookie 中有它）！** 换句话说，我怎样才能使这项工作：

```
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.2">
    <link rel="stylesheet" href="js/jquery.mobile-1.2.0.css" />
    <script src="js/jquery-1.8.2.js"></script>
    <script src="js/jquery.mobile-1.2.0.js"></script>
</head>
  <body>
    <div id="MyContainer">

    </div>

    <script>
        function SomeFunction(){

             var someHTML = localStorate.html1;   // html1 = raw part = <div data-role="page"><div data-role="header"><h1> Hello World </h1></div></div>

             $("#MyContainer").html(someHTML);

             // now here I am stuck!!!!!!!!!!!!!!!
             // how can I make the content of MyContainer go from the raw part to the Parsed Part!
             // I am looking for something like:

             $JqueryMobile.ParseHTML($("#MyContainer"));
        }
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T08:36:14.220

# 解决方案

**`jQuery Mobile`**为小部件重新样式提供了许多功能，但只有其中一个功能可以重新设置整个页面的样式。

```
 $('#index').trigger('pagecreate'); 
```

**`#index`**你的页面的 id 应该在哪里**`DIV`**。

这里还有其他可以使用的函数，但与此函数不同的是，它只会设置带有**data-role="content"**属性的**`trigger('pagecreat');`**DIV 样式。要对此进行测试，jsFiddle 示例 应替换为****`trigger('pagecreate');`****`trigger('create');`****

 **```
 $('#index').trigger('create'); 
```

如果可能的话，不应在**BODY标签内使用****SCRIPT**标签，虽然它会起作用，但它可能会导致其他问题。如果您想了解有关此主题的更多信息以及如何处理动态添加的内容，请查看这篇**[文章](http://www.gajotres.net/jquery-mobile-and-how-to-enhance-the-markup-of-dynamically-added-content/)**，它是我的.****`jQuery Mobile`****`personal blog`****

 **## 例子

工作示例：[**jsFiddle**](http://jsfiddle.net/Gajotres/AzXdT/)

您应该对这部分代码感兴趣：

```
$('#index').append('<div data-role="footer" data-position="fixed"><h1>Dynamicaly added footer</h1></div> ');
$('#index [data-role="content"]').append('<fieldset data-role="controlgroup"><legend>Choose:</legend><input type="radio" name="radio" id="radio1" value="1" checked="checked" /><label for="radio1">option 1</label></fieldset>');
$('#index').trigger('pagecreate'); 
```

此代码用于将页脚和单选按钮动态附加到页面内容。****

# arrays - 从具有多个维度的数组中绘制 MATLAB 数据

> ID：14532640
> 
> 赞同：0
> 
> 时间：2013-01-26T00:54:32.497
> 
> 标签：arrays, matlab, plot, matlab-figure

考虑三维数组

```
A = rand(3,4,5);
B = rand(3,4,5);

plot(A(:,1,1),B(:,1,1))
plot(A(1,:,1),B(1,:,1)) 
```

这一切都很好，但是

```
>> plot(A(1,1,:),B(1,1,:))
Error using plot
Data may not have more than 2 dimension 
```

除了使用之外，有没有一种快速的方法来解决这个问题`reshape()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T01:03:33.303

您应该使用[`squeeze`](http://www.mathworks.com/help/matlab/ref/squeeze.html)删除单件维度：

```
plot(squeeze(A(1,1,:)),squeeze(B(1,1,:))) 
```

另一种选择是使用[`shiftdim`](http://www.mathworks.com/help/matlab/ref/shiftdim.html)

```
plot(shiftdim(A(1,1,:),1),shiftdim(B(1,1,:),1),'o') 
```

# ios - 如何在 iOS 可达性中检测网络信号强度

> ID：14532651
> 
> 赞同：16
> 
> 时间：2013-01-26T00:56:17.393
> 
> 标签：ios, networking, bandwidth, reachability

我正在 iOS 中创建一个新的旅行应用程序，该应用程序高度依赖于地图，并将包含两个地图。

> 1.  当用户具有强大的网络信号（Apple Maps）时，我的第一个地图将起作用。
> 2.  当它们不是任何网络或信号非常低（离线 MapBox）时，将使用我的第二张地图。

为什么我在一个应用程序中有两个不同的地图？我的应用程序是一个方向应用程序，因此当用户的网络非常低或没有网络时，它将转到离线地图`MapBox`。Apple Maps 也将集成 Yelp 而不是离线 Map `MapBox`。

所以我的问题：如何检测 WiFi、4G Lte 和 3G 中的网络信号。 ![MapBox 离线图片](../Images/28778fab7fb062bfd9a2c57d5c067221.png)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-29T13:44:28.733

我最初的想法是为文件的下载计时，看看需要多长时间：

```
@interface ViewController () <NSURLSessionDelegate, NSURLSessionDataDelegate>

@property (nonatomic) CFAbsoluteTime startTime;
@property (nonatomic) CFAbsoluteTime stopTime;
@property (nonatomic) long long bytesReceived;
@property (nonatomic, copy) void (^speedTestCompletionHandler)(CGFloat megabytesPerSecond, NSError *error);

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];

    [self testDownloadSpeedWithTimout:5.0 completionHandler:^(CGFloat megabytesPerSecond, NSError *error) {
        NSLog(@"%0.1f; error = %@", megabytesPerSecond, error);
    }];
}

/// Test speed of download
///
/// Test the speed of a connection by downloading some predetermined resource. Alternatively, you could add the
/// URL of what to use for testing the connection as a parameter to this method.
///
/// @param timeout             The maximum amount of time for the request.
/// @param completionHandler   The block to be called when the request finishes (or times out).
///                            The error parameter to this closure indicates whether there was an error downloading
///                            the resource (other than timeout).
///
/// @note                      Note, the timeout parameter doesn't have to be enough to download the entire
///                            resource, but rather just sufficiently long enough to measure the speed of the download.

- (void)testDownloadSpeedWithTimout:(NSTimeInterval)timeout completionHandler:(nonnull void (^)(CGFloat megabytesPerSecond, NSError * _Nullable error))completionHandler {
    NSURL *url = [NSURL URLWithString:@"http://insert.your.site.here/yourfile"];

    self.startTime = CFAbsoluteTimeGetCurrent();
    self.stopTime = self.startTime;
    self.bytesReceived = 0;
    self.speedTestCompletionHandler = completionHandler;

    NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration ephemeralSessionConfiguration];
    configuration.timeoutIntervalForResource = timeout;
    NSURLSession *session = [NSURLSession sessionWithConfiguration:configuration delegate:self delegateQueue:nil];
    [[session dataTaskWithURL:url] resume];
}

- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTask didReceiveData:(NSData *)data {
    self.bytesReceived += [data length];
    self.stopTime = CFAbsoluteTimeGetCurrent();
}

- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task didCompleteWithError:(NSError *)error {
    CFAbsoluteTime elapsed = self.stopTime - self.startTime;
    CGFloat speed = elapsed != 0 ? self.bytesReceived / (CFAbsoluteTimeGetCurrent() - self.startTime) / 1024.0 / 1024.0 : -1;

    // treat timeout as no error (as we're testing speed, not worried about whether we got entire resource or not

    if (error == nil || ([error.domain isEqualToString:NSURLErrorDomain] && error.code == NSURLErrorTimedOut)) {
        self.speedTestCompletionHandler(speed, nil);
    } else {
        self.speedTestCompletionHandler(speed, error);
    }
}

@end 
```

请注意，这会测量速度，包括启动连接的延迟。如果您想考虑初始延迟，您也可以初始化`startTime`in 。[`didReceiveResponse`](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSessionDataDelegate_protocol/index.html#//apple_ref/occ/intfm/NSURLSessionDataDelegate/URLSession:dataTask:didReceiveResponse:completionHandler:)

* * *

这样做之后，回想起来，我不喜欢花时间或带宽下载对应用程序没有实际好处的东西。因此，作为替代方案，我可能会建议一种更实用的方法：您为什么不尝试打开 a`MKMapView`并查看完成下载地图需要多长时间？如果失败或花费超过一定时间，则切换到您的离线地图。同样，这里有相当多的可变性（不仅因为网络带宽和延迟，还因为一些地图图像似乎被缓存了），因此请确保将 a 设置`kMaximumElapsedTime`为足够大以处理成功的所有合理排列连接（即不要过于激进地使用低值）。

为此，只需确保将您的视图控制器设置`delegate`为`MKMapView`. 然后你可以这样做：

```
@interface ViewController () <MKMapViewDelegate>
@property (nonatomic, strong) NSDate *startDate;
@end

static CGFloat const kMaximumElapsedTime = 5.0;

@implementation ViewController

// insert the rest of your implementation here

#pragma mark - MKMapViewDelegate methods

- (void)mapViewWillStartLoadingMap:(MKMapView *)mapView {
    NSDate *localStartDate = [NSDate date];
    self.startDate = localStartDate;

    double delayInSeconds = kMaximumElapsedTime;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        // Check to see if either:
        //   (a) start date property is not nil (because if it is, we 
        //       finished map download); and
        //   (b) start date property is the same as the value we set
        //       above, as it's possible this map download is done, but
        //       we're already in the process of downloading the next
        //       map.

        if (self.startDate && self.startDate == localStartDate)
        {
            [[[UIAlertView alloc] initWithTitle:nil
                                        message:[NSString stringWithFormat:@"Map timed out after %.1f", delayInSeconds]
                                       delegate:nil
                              cancelButtonTitle:@"OK"
                              otherButtonTitles:nil] show];
        }
    });
}

- (void)mapViewDidFailLoadingMap:(MKMapView *)mapView withError:(NSError *)error {
    self.startDate = nil;

    [[[UIAlertView alloc] initWithTitle:nil
                                message:@"Online map failed"
                               delegate:nil
                      cancelButtonTitle:@"OK"
                      otherButtonTitles:nil] show];
}

- (void)mapViewDidFinishLoadingMap:(MKMapView *)mapView
{
    NSTimeInterval elapsed = [[NSDate date] timeIntervalSinceDate:self.startDate];
    self.startDate = nil;
    self.statusLabel.text = [NSString stringWithFormat:@"%.1f seconds", elapsed];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-12-15T13:31:03.613

对于斯威夫特

```
class NetworkSpeedProvider: NSObject {

var startTime = CFAbsoluteTime()
var stopTime = CFAbsoluteTime()
var bytesReceived: CGFloat = 0
var speedTestCompletionHandler: ((_ megabytesPerSecond: CGFloat, _ error: Error?) -> Void)? = nil

func test() {

    testDownloadSpeed(withTimout: 5.0, completionHandler: {(_ megabytesPerSecond: CGFloat, _ error: Error?) -> Void in
        print("%0.1f; error = \(megabytesPerSecond)")
    })
  }
}

extension NetworkSpeedProvider: URLSessionDataDelegate, URLSessionDelegate {

func testDownloadSpeed(withTimout timeout: TimeInterval, completionHandler: @escaping (_ megabytesPerSecond: CGFloat, _ error: Error?) -> Void) {

    // you set any relevant string with any file
    let urlForSpeedTest = URL(string: "https://any.jpg")

    startTime = CFAbsoluteTimeGetCurrent()
    stopTime = startTime
    bytesReceived = 0
    speedTestCompletionHandler = completionHandler
    let configuration = URLSessionConfiguration.ephemeral
    configuration.timeoutIntervalForResource = timeout
    let session = URLSession(configuration: configuration, delegate: self, delegateQueue: nil)

    guard let checkedUrl = urlForSpeedTest else { return }

    session.dataTask(with: checkedUrl).resume()
}

func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data) {
    bytesReceived += CGFloat(data.count)
    stopTime = CFAbsoluteTimeGetCurrent()
}

func urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?) {
    let elapsed = (stopTime - startTime) //as? CFAbsoluteTime
    let speed: CGFloat = elapsed != 0 ? bytesReceived / (CGFloat(CFAbsoluteTimeGetCurrent() - startTime)) / 1024.0 / 1024.0 : -1.0
    // treat timeout as no error (as we're testing speed, not worried about whether we got entire resource or not
    if error == nil || ((((error as NSError?)?.domain) == NSURLErrorDomain) && (error as NSError?)?.code == NSURLErrorTimedOut) {
        speedTestCompletionHandler?(speed, nil)
    }
    else {
        speedTestCompletionHandler?(speed, error)
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T02:46:25.997

我相信谷歌搜索会有所帮助。

请留意 StackOverflow 上的以下线程——</p>

[iOS wifi扫描，信号强度](https://stackoverflow.com/questions/12054818/ios-wifi-scan-signal-strength)

[iPhone 信号强度](https://stackoverflow.com/questions/2959567/iphone-signal-strength)

因此，我认为如果不使用私有 API，您仍然无法做到这一点。

# matlab - 了解为什么我不能在 matlab 中对矩阵的大小函数的结果使用索引

> ID：14532652
> 
> 赞同：0
> 
> 时间：2013-01-26T00:56:44.300
> 
> 标签：matlab

尝试时：

```
a = [ 1 1 ; 1 1 ];
size(a)(1) 
```

我明白了

```
Error: ()-indexing must appear last in an index
expression 
```

我的理解是 size(a) 的结果是一个大小为 1 2 的矩阵。

问题：为什么 size(a)(1) 不起作用？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T01:06:18.243

因为您无法在不创建临时文件的情况下在 MATLAB 中对类似函数的结果进行索引。

```
temp = size(a);
temp(1) 
```

将工作。然而，通常还有其他方法可以得到你想要的东西。在您的示例中，您可以使用`dim`函数中的参数`size(X,dim)`：

```
size(a,1) 
```

这将直接为您提供第一个维度的大小，而无需创建临时变量。

# android - Android ARP清除时间

> ID：14532654
> 
> 赞同：2
> 
> 时间：2013-01-26T00:57:00.273
> 
> 标签：android, linux, mac-address, arp, wifi-direct

我正在为 WiFi 直接编写一个应用程序，它使用我通过另一种方法（有效）传输的 mac 地址，客户端将使用 ARP 表来查找主机的 IP，因为 groupownerintent 在 android 上根本不起作用. 但是我一直发现我的 arp 表只包含我的 WiFi 接入点（用于互联网访问），并且额外的 p2p 接口在不到 5 分钟内消失了。

Android 的 ARP 超时是多少，有没有办法延长它？也许在我的应用程序中这不是问题，但是当接口出现故障时调试是一个真正的痛苦，然后无法通过 WiFi 直接连接（因为如果你通过代码执行它似乎很糟糕）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T18:18:32.210

Android 基于 Linux 内核并使用相同类型的[ARP 超时策略](http://linux.die.net/man/7/arp)。缓存中的条目超时介于 base_reachable_time/2 和 3*base_reachable_time/2 之间，base_reachable_time 默认为 30 秒左右。您可以通过`proc`界面更改内核参数来更改此设置`/proc/sys/net/ipv4/neigh/eth0/base_reachable_time`，但手机需要root。您也可以在检查表之前 ping 您想要 MAC 的 IP，以保持缓存中的条目更新。

# html - 为什么使用 GET 发送的参数可以在多个请求中存活？

> ID：14532656
> 
> 赞同：1
> 
> 时间：2013-01-26T00:57:17.813
> 
> 标签：html, http, jsp, servlets

在我的 JSP 文件中，我有一个 HTML 表单，它通过 GET 将数据发送到我的 servlet。

```
<form method="GET">
      <input name="cmd" type="hidden" value="firstValue"/>
      .....
</form> 
```

如果我现在触发一个不同的表单，它也有一个名为 的变量`cmd`，但使用 POST，旧`cmd`值将保留在参数列表中，我可以像这样在我的 servlet 中读出`request.getParameterValues("cmd")`：

```
<form method="POST">
      <input name="cmd" type="hidden" value="secondValue"/>
      .....
</form> 
```

为什么 GET 参数可以在多个请求中存活？与 servlet 中的 POST 参数相比，它们存储在哪里/如何存储？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T02:17:15.533

如果未指定，表单的`action`URL 默认为您在浏览器地址栏中看到的当前请求 URL，包括查询字符串。如果您想避免这种情况，请明确指定`action`URL。

# java - 爪哇；尝试将包含 ISO-8859-1 编码的字符串转换为 UTF-8 但文件为 UTF-8

> ID：14532657
> 
> 赞同：3
> 
> 时间：2013-01-26T00:57:32.910
> 
> 标签：java, utf-8, character-encoding, iso-8859-1

我不知道这是否有意义，但这就是我所做的。

我正在使用 Eclipse 对我的所有文件使用 UTF-8 编码。在其中一个中，我需要将字符串从 ISO-8859-1 转换为 UTF-8。然而，该字符串是在文件本身中形成的（不是来自输入），这就是为什么我相信我的字符串以 UTF-8 开头并且转换没有按照我预期的方式进行。

字符串原始内容为：

```
||3.2|2013-01-25T17:24:00|ingreso|PAGO EN UNA SOLA EXHIBICION|6386.21|MXN|7408.00|No identificado|NAUCALPAN DE JUÁREZ, ESTADO DE MEXICO|CAOS640116HT5|OSCAR MARTIN CARRERA|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JUÁREZ|ESTADO DE MEXICO|MÉXICO|53100|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JUÁREZ|ESTADO DE MEXICO|MÉXICO|53100|Persona Física con Actividad Empresarial|BAÑ930616R66|BAÑOMOBIL, S.A. DE C.V.|Av. 1° de Mayo|197|San. Lorenzo|TLALNEPANTLA DE BAZ|ESTADO DE MEXICO|MÉXICO|54047|1|NO APLICA|Dominio .com|Dominio por 1 año www.sanitariosportatiles.com|586.21|586.21|1|NO APLICA|Hospedaje 2 Gb|Hospedaje 2 Gb por 1 año www.sanitariosportatiles.com|5800.00|5800.00|IVA|16.00|1021.79|1021.79|| 
```

哪个原始编码应该是 ISO-8859-1，当我将它转换为 UTF-8 时，它应该生成。

```
||3.2|2013-01-25T17:05:06|ingreso|PAGO EN UNA SOLA EXHIBICION|6386.21|MXN|7408.00|No identificado|NAUCALPAN DE JUÃREZ, ESTADO DE MEXICO|CAOS640116HT5|OSCAR MARTIN CARRERA|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JUÃREZ|ESTADO DE MEXICO|MÃ‰XICO|53100|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JUÃREZ|ESTADO DE MEXICO|MÃ‰XICO|53100|Persona FÃ­sica con Actividad Empresarial|BAÃ‘930616R66|BAÃ‘OMOBIL, S.A. DE C.V.|Av. 1Â° de Mayo|197|San. Lorenzo|TLALNEPANTLA DE BAZ|ESTADO DE MEXICO|MÃ‰XICO|54047|1|NO APLICA|Dominio .com|Dominio por 1 aÃ±o www.sanitariosportatiles.com|586.21|586.21|1|NO APLICA|Hospedaje 2 Gb|Hospedaje 2 Gb por 1 aÃ±o www.sanitariosportatiles.com|5800.00|5800.00|IVA|16.00|1021.79|1021.79|| 
```

这是我需要的，但我没有实现。

这是我到目前为止所尝试的。

```
 String input = null;
    input = "||3.2|2013-01-25T17:24:00|ingreso|PAGO EN UNA SOLA EXHIBICION|6386.21|MXN|7408.00|No identificado|NAUCALPAN DE JUÁREZ, ESTADO DE MEXICO|CAOS640116HT5|OSCAR MARTIN CARRERA|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JUÁREZ|ESTADO DE MEXICO|MÉXICO|53100|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JUÁREZ|ESTADO DE MEXICO|MÉXICO|53100|Persona Física con Actividad Empresarial|BAÑ930616R66|BAÑOMOBIL, S.A. DE C.V.|Av. 1° de Mayo|197|San. Lorenzo|TLALNEPANTLA DE BAZ|ESTADO DE MEXICO|MÉXICO|54047|1|NO APLICA|Dominio .com|Dominio por 1 año www.sanitariosportatiles.com|586.21|586.21|1|NO APLICA|Hospedaje 2 Gb|Hospedaje 2 Gb por 1 año www.sanitariosportatiles.com|5800.00|5800.00|IVA|16.00|1021.79|1021.79||";
    String intento1 = null, intento2 = null, intento3 = null;
    try {
        intento1 = new String(input.getBytes("ISO-8859-1"),"UTF-8");
        intento2 = new String(intento1.getBytes(), "UTF-8");
        intento3 = new String(input.getBytes(),"UTF-8");
    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    }
    System.out.println(intento1);
    System.out.println(intento2); 
    System.out.println(intento3); 
```

哪个返回

```
||3.2|2013-01-25T17:24:00|ingreso|PAGO EN UNA SOLA EXHIBICION|6386.21|MXN|7408.00|No identificado|NAUCALPAN DE JU?REZ, ESTADO DE MEXICO|CAOS640116HT5|OSCAR MARTIN CARRERA|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JU?REZ|ESTADO DE MEXICO|M?XICO|53100|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JU?REZ|ESTADO DE MEXICO|M?XICO|53100|Persona F?sica con Actividad Empresarial|BA?930616R66|BA?OMOBIL, S.A. DE C.V.|Av. 1? de Mayo|197|San. Lorenzo|TLALNEPANTLA DE BAZ|ESTADO DE MEXICO|M?XICO|54047|1|NO APLICA|Dominio .com|Dominio por 1 a?o www.sanitariosportatiles.com|586.21|586.21|1|NO APLICA|Hospedaje 2 Gb|Hospedaje 2 Gb por 1 a?o www.sanitariosportatiles.com|5800.00|5800.00|IVA|16.00|1021.79|1021.79||
||3.2|2013-01-25T17:24:00|ingreso|PAGO EN UNA SOLA EXHIBICION|6386.21|MXN|7408.00|No identificado|NAUCALPAN DE JU?REZ, ESTADO DE MEXICO|CAOS640116HT5|OSCAR MARTIN CARRERA|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JU?REZ|ESTADO DE MEXICO|M?XICO|53100|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JU?REZ|ESTADO DE MEXICO|M?XICO|53100|Persona F?sica con Actividad Empresarial|BA?930616R66|BA?OMOBIL, S.A. DE C.V.|Av. 1? de Mayo|197|San. Lorenzo|TLALNEPANTLA DE BAZ|ESTADO DE MEXICO|M?XICO|54047|1|NO APLICA|Dominio .com|Dominio por 1 a?o www.sanitariosportatiles.com|586.21|586.21|1|NO APLICA|Hospedaje 2 Gb|Hospedaje 2 Gb por 1 a?o www.sanitariosportatiles.com|5800.00|5800.00|IVA|16.00|1021.79|1021.79||
||3.2|2013-01-25T17:24:00|ingreso|PAGO EN UNA SOLA EXHIBICION|6386.21|MXN|7408.00|No identificado|NAUCALPAN DE JU?REZ, ESTADO DE MEXICO|CAOS640116HT5|OSCAR MARTIN CARRERA|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JU?REZ|ESTADO DE MEXICO|M?XICO|53100|CTO. ORADORES 33|33|CD. SATELITE|NAUCALPAN DE JU?REZ|ESTADO DE MEXICO|M?XICO|53100|Persona F?sica con Actividad Empresarial|BA?930616R66|BA?OMOBIL, S.A. DE C.V.|Av. 1? de Mayo|197|San. Lorenzo|TLALNEPANTLA DE BAZ|ESTADO DE MEXICO|M?XICO|54047|1|NO APLICA|Dominio .com|Dominio por 1 a?o www.sanitariosportatiles.com|586.21|586.21|1|NO APLICA|Hospedaje 2 Gb|Hospedaje 2 Gb por 1 a?o www.sanitariosportatiles.com|5800.00|5800.00|IVA|16.00|1021.79|1021.79|| 
```

这不是我想要的。

编辑1：当我从输入中获取字符串时，其中一个转换工作正常，但我需要它在文件中声明才能工作。

编辑 2：这基本上是我需要的[http://cryptosys.net/cgi-bin/manual.cgi?m=pki&name=CNV_UTF8FromLatin1](http://cryptosys.net/cgi-bin/manual.cgi?m=pki&name=CNV_UTF8FromLatin1)但在 java

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-01-09T13:03:02.980

简单来说，如果要将 charset=iso-8859-1 转换为 java 字符串（默认为 UTF-8）

```
 String response= new String(input.getBytes("ISO-8859-1"),"UTF-8"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-30T23:59:40.133

我终于让它显示了我在问题中指定的方式，我只是使用了错误的字符集。

```
intento2 = new String(input.getBytes(Charset.forName("UTF-8")), Charset.forName("Windows-1252")); 
```

这以我需要的方式显示了它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T01:22:28.243

我认为这里的根本问题是您的期望。

如果我理解正确，您希望能够通过更改字符编码`Á`来更改。`Ã`那不可能发生。这些是不同的字符；即不同的代码点 -`Á`是 Unicode 代码点 00C1（或 ISO-8859-1 中的 C1）并且`Ã`是 00C3 / C3。

因此，当您将`Á`ISO-8859-1 中的 a 转码为 Unicode 到 UTF-8 时，您*应该*得到完全相同的 character `Á`。如果你不这样做，那么翻译就会被破坏。

^(您还希望`MÉXICO`翻译为`MÃ‰XICO`... 这对我来说似乎很奇怪。也许您将字符转录到问题中存在问题......)

现在，如果您的语言/地区的词典规则说`Á`to`Ã`实际上是等效的，那么将“规范化”为首选形式是合理的。但是，进行这种与语言环境相关的翻译并不是字符编码/解码的作用。您需要自己编写代码......或找到其他一些库。

* * *

在字节级别搞乱（用一个字符集编码并用不同的字符集解码）不会“解决”这个问题。如果有的话，它会让事情变得更糟。你的乱七八糟正在生成无法映射到目标编码方案的字节序列......因此是问号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T03:12:14.823

从二进制表示加载任何数据时，您必须知道该表示使用什么编码才能解释或解码它。如果你假设错误的编码，那么你可能会得到垃圾——一些没有意义的东西。

为了从二进制数据构造字符串，您必须指定源数据的编码。否则你可能会得到垃圾——构造的字符串可能不包含源数据中表示的字符。

更具体地说，对于您的情况，如果您尝试使用 ISO-8859-1 编码加载 UTF-8 数据，您可能会得到垃圾。我说“可能”是因为这两种编码实际上有很多重叠：低 127 个代码点（如果我没记错的话）。如果仅使用这些低 127 个代码点，则解码实际上可能“工作”，但由于不能保证它不应该被依赖。

如果您告诉 Eclipse 使用 UTF-8 对源文件进行解码，那么您应该只使用能够使用 UTF-8 编码进行编辑的编辑器来编辑这些源文件。

还有一点：Java中String数据的内部表示是UTF-16。因此，说您拥有“包含 ISO-8859-1 编码”的字符串是不正确的。如果你有一个字符串，你总是有 UTF-16 数据。该数据是否正确取决于您如何构造字符串，如上所述。

# c++ - c++ for 循环被跳过

> ID：14532658
> 
> 赞同：1
> 
> 时间：2013-01-26T00:57:40.043
> 
> 标签：c++

这个小程序我做错了什么。

我刚刚开始学习 c++，而且我可以接受这是一个没有实际意义的问题。我正在阅读 Prata c++ 入门书，它给了我一个代码示例，它采用 char 数组并在 for 循环中使用 strcmp()，该循环按顺序遍历以“？”开头的 ASCII 代码。直到一个测试字符变量 ==sa 从另一个字符设置值。

认为我可以超越这本书，我试图创建一个类似的程序，它采用一个 char 数组，使用 for 循环将采用一个测试 char 数组并遍历数组的每个值，直到两个变量相等。

我将程序简化为仅获取 for 循环中每个数组的第一个，因为我遇到了一个问题，即程序似乎只是跳过了 for 循环并终止。

下面首先是 prata 代码片段，然后是我的一段代码。任何反馈（甚至是辱骂性的>_<）都会很有用。

```
#include <iostream>
#include <cstring>

int main() {
using namespace std;
char word[5] = "?ate";

for (char ch = ‘a’; strcmp(word, "mate"); ch++) {
cout << word << endl;
word[0] = ch;
}

cout << "After loop ends, word is " << word << endl;
return 0;
} 
```

我的代码（虽然可能做得不好，但我可以接受）

```
#include <iostream>
#include <cstring>

int main() {
    using namespace std;
    char word[5] = "word";
    char test[5] = "????";
    int j = 0;
    int i = 0;

    cout << "word is " << word << "\nTest is " << test << endl;
    cout << word[0] << " " << test[0] << endl;
    for (char temp = '?'; word[0] == test[0] || temp == 'z'; temp++) {
        if ((word[i]) == (test[j])) {
            test[j] = temp;
            j++;
            temp = '?';
        }
        test[j] = temp++;
        cout << test << endl; //Added to see if the for loop runs through once, 
                                  //which is does not
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T01:02:12.673

您的`for`循环永远不会开始，因为您的条件如下所示：

```
word[0] == test[0] || temp == 'z' 
```

在第一次通过时将始终返回 false。由于`temp`初始化为`'?'`并且`word[0]`( `w`) 不等于`test[0]`( `?`)，因此您的循环将永远不会开始。

此外，您已经初始化`temp`为`?`这样，[查看 ascii 图表](http://www.asciitable.com/index/asciifull.gif)`?`，您会看到在和 小写之间有很多非字母字符`z`。

此外，在`for`循环中，您增加`j`( `j++`) 但从不触摸`i`。由于您正在从with作为索引读取`char`s ，因此最终会成为.`word``i``test``"wwww"`

你好像把自己弄糊涂了，所以...

**让我们分解一下您要执行的操作：**

如果您要迭代字符串中的每个字符，然后检查该索引处的每个字母，您将有两个循环：

```
for(;;) {
    for(;;) {
    }
} 
```

第一个（遍历字符串中的每个索引应该在索引到达字符串末尾时结束（字符串文字以 a 终止`'\0'`）：

```
for(int i = 0; word[i] != '\0' && test[i] != '\0'; i++) {
    for(;;) {
    }
} 
```

第二个将检查字母表中的每个字母（`char temp = 'a'`和）与您在和（ ）`temp++`中给定的索引。如果它们不相等，它会将at index的字符设置为，直到找到正确的字母。把它们放在一起，你最终得到了这个：`word``test``word[i] != test[i];``test``i``temp`

```
for(int i = 0; word[i] != '\0' && test[i] != '\0'; i++) {
    for(char temp = 'a'; word[i] != test[i]; temp++) {
        test[i] = temp;
    }
} 
```

当然，如果您只追求结果而不是试图自学循环和编程基础知识，那么这只是一种非常迂回的 simplay 调用方式：

```
memcpy(temp, word, strlen(word)); 
```

# jquery - jQuery Mobile 和-webkit-transform 的问题：在移动设备中扩展

> ID：14532660
> 
> 赞同：0
> 
> 时间：2013-01-26T00:57:57.620
> 
> 标签：jquery, css, html, jquery-mobile, responsive-design

当我添加与`-webkit-transform: scale (x, x)`失去其属性相关联的 web jquery 移动元素时

```
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Galaxy Camara</title>
    <meta name="description" content="Test">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 

    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="js/jquery.mobile.js"></script>

</head>
<body>

    <header>
        <img id="test" src="css/img/marketIcon.png" style="-webkit-transform: scale(0.5, 0.5);">
        <img id="test2" src="css/img/marketIcon.png">
    </header>

</body>
</html> 
```

# oauth - 需要 OAuth 令牌机密来获取 OAuth 令牌机密吗？有没有搞错？

> ID：14532662
> 
> 赞同：1
> 
> 时间：2013-01-26T00:58:08.353
> 
> 标签：oauth, twitter, twitter-oauth

我一直在尝试实现“使用 Twitter 登录”，但我一直在努力研究如何为用户获取 OAuth 令牌密码。

Twitter API 文档（[这里](https://dev.twitter.com/docs/auth/implementing-sign-twitter)）说：

> 要启动登录流程，您的应用程序必须通过向POST oauth/request_token发送**签名消息来获取请求令牌**
> 
> ...
> 
> 响应正文将包含 oauth_token、**oauth_token_secret**和 oauth_callback_confirmed 参数

创建签名的文档（[此处](https://dev.twitter.com/docs/auth/creating-signature)）说：

> 标识您的应用程序所代表的帐户的值称为**oauth token secret**。可以通过多种方式获取此值，所有这些方式都在获取访问令牌中进行了描述。

并且“获取访问令牌”页面链接回[此处](https://dev.twitter.com/docs/auth/implementing-sign-twitter)，完成循环。

**如果我需要令牌密钥来签署获取令牌密钥的请求，我如何获取令牌密钥？**有没有搞错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:56:42.113

从有关创建签名的文档中：

```
Note that there are some flows, such as when obtaining a request token, 
where the token secret is not yet known. In this case, the signing key 
should consist of the percent encoded consumer secret followed by an 
ampersand character '&'. 
```

您在注册 API 密钥时收到了一个**使用者机密。**这就是您要签名以获取请求令牌的内容。

我强烈建议研究使用至少实现 oauth 基础知识的库，例如签名（如果不是[Twitter API 库](https://dev.twitter.com/docs/twitter-libraries)），假设您选择的语言可用。

# regex - Jena QueryParseException 遇到“正则表达式”

> ID：14532664
> 
> 赞同：0
> 
> 时间：2013-01-26T00:58:21.647
> 
> 标签：regex, debugging, exception, sparql, jena

我已经构建了这个 SPARQL 查询：

```
String query_splInfo = 
    "PREFIX foaf: <http://xmlns.com/foaf/0.1/>"+"\n"+
    "SELECT ?name"+"\n"+
    "WHERE {?x foaf:name ?name . " +
    "FILTER regex(?name, \"Studienprogrammleitung Informatik\")}"; 
```

Jena 返回错误消息：

> 失败：com.hp.hpl.jena.query.QueryParseException：在第 4 行第 73 列遇到““regex”“regex”。期待以下之一：“graph”...“optional”...“filter” ...“{”...“}”...“;” ……”，……“。” ...

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T18:00:35.270

```
"PREFIX foaf: <http://xmlns.com/foaf/0.1/>"+"\n"+
"SELECT ?name"+"\n"+
"WHERE {?x foaf:name ?name . "+"\n"+
"FILTER regex(?name, \"Studienprogrammleitung Informatik\")}"; 
```

# multithreading - 快速并行挑选/检查一些 ID（想想战利品滞后的非游戏应用）

> ID：14532665
> 
> 赞同：0
> 
> 时间：2013-01-26T00:58:23.377
> 
> 标签：multithreading, performance, algorithm, thread-safety, multiprocessing

因此，我正在验证新的运营管理系统，其中一个操作系统将选择列表发送到可扩展数量的手持设备。它使用消息发送这些，并且它们的选择列表可能包含重叠的作业。所以在我的虚拟世界中，我需要确保两个模拟人不会选择同一份工作——每当有人选择一份工作时，所有工作列表都会刷新，这样所选择的工作就不会再出现在其他人的手持设备上，但对我来说，消息仍在正在处理的队列中，所以我必须确保放弃该选项。

基本上我有一个带有互斥锁的巨大列表，“人”越多，我处理消息的速度就越慢，以至于我不再实时，这很糟糕，因为我不能实际上验证系统，因为我跟不上消息。（同一个岛上的两个人会认识到一个人会选择一个对象，而下一个人应该选择第二个项目，但我需要检查我将要选择的每一项工作，看看它是否已被某人认领否则已经）

我已经考虑过对列表进行本地化合并，但它实际上并没有解决在愚蠢的情况下无论如何都会破坏它的问题，大量的人在同一行工作。现在，这可能会让真实的人感到困惑，因为在现实生活中他们需要做同样的解决方案，但我很好奇目前公认的解决这个问题的“最佳”解决方案是什么。

PS - 我已经在 c++ 中实现了这个，它很快，足够快，在任何实际测试中我都“不需要”回答这个问题，更多的是因为我很好奇我在问。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T12:11:18.927

我在设计“带有（一个）互斥锁的巨型列表”中看到了一个问题。如果列表大小和/或访问速率不受限制，您根本无法以同步方式提供整个列表。基础数学对你不利。所以我要做的是在每项工作上设置一个互斥标志。您无法阻止某个工作显示在某人的屏幕上，但您可以确保他收到一个优雅的“没有更多可用”错误，然后是更新的列表。如果您曾经想在非常受欢迎的演出中预订座位，您可能已经目睹了解决方案。

# jquery - jQuery Sortable - 将新元素拖入列表时保存顺序

> ID：14532667
> 
> 赞同：7
> 
> 时间：2013-01-26T00:58:41.893
> 
> 标签：jquery, jquery-ui-sortable

我有两个可排序的列表，其中包含工作订单。第二个列表是`Route`第一个列表，只是所有尚未添加到列表中的工单的`Route`列表。这个想法是，用户以特定顺序将工作订单拖入其中`Route`，重新排列工作订单以创建员工将遵循的路线。

我的问题是管理拖到`Route`列表中的新工作订单的位置。在添加新项目时，是否有一种简单的方法来处理更新所有列表项目的位置（通过 ajax 调用在数据库方面）？

*为了清楚起见，提供更多信息...*

当`Route`列表为空（尚未添加工作订单）时，这很简单 - 用户将新工作订单拖到空列表上，进行 ajax 调用以保存`Route`对象和`Route Item`刚刚添加的对象的详细信息（在服务器上的基础记录上）。

当用户将第二个工作订单拖到`Route`列表中时，我想确定新工作订单是否会成为列表中的第一个，或者第二个，然后相应地更新列表中所有项目的所有信息（服务器端）。当我想将新的工作订单添加到`Route`已经有 30 个工作订单的情况时，事情变得非常复杂。

有没有一种简单的方法可以做到这一点，或者只是编写大量的 jQuery 和后端函数来管理它？我一直在网上寻找解决方案，但找不到任何确定的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T01:42:54.400

每次使用 ajax 调用进行更新时，您都可以保存每列的顺序。 [工作 JSFiddle 示例](http://jsfiddle.net/5aaPU/)

下面的解释：为此，您需要为每个可排序的项目提供一个唯一的 ID。例如：

```
 <ul id="sortable1" class="connectedSortable">
    <li class="ui-state-default" id='item1'>Item 1</li>
    <li class="ui-state-default" id='item2'>Item 2</li>
    <li class="ui-state-default" id='item3'>Item 3</li>
    <li class="ui-state-default" id='item4'>Item 4</li>
    <li class="ui-state-default" id='item5'>Item 5</li>
   </ul>
    <ul id="sortable2" class="connectedSortable">
        <li class="ui-state-highlight" id='item6'>Item 6</li>
        <li class="ui-state-highlight" id='item7'>Item 7</li>
        <li class="ui-state-highlight" id='item8'>Item 8</li>
        <li class="ui-state-highlight" id='item9'>Item 9</li>
        <li class="ui-state-highlight" id='item10'>Item 10</li>
    </ul> 
```

然后，您可以捕获每个可排序 li 的 id 并在 ajax 请求中返回 post。

```
 $(function () {
     $("#sortable1, #sortable2").sortable({
         connectWith: ".connectedSortable",
         update: function () {
             var order1 = $('#sortable1').sortable('toArray').toString();
             var order2 = $('#sortable2').sortable('toArray').toString();

             alert("Order 1:" + order1 + "\n Order 2:" + order2); //Just showing update
             $.ajax({
                 type: "POST",
                 url: "/echo/json/",
                 data: "order1=" + order1 + "&order2=" + order2,
                 dataType: "json",
                 success: function (data) {

                 }
             });

         }
     }).disableSelection();
 }); 
```

然后，您可以执行该过程以将订单保存在您正在请求的页面上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T01:12:18.907

> 有没有一种简单的方法可以做到这一点，或者只是编写大量的 jQuery 和后端函数来管理它？我一直在网上寻找解决方案，但找不到任何确定的东西。

几乎是的，但是如果您已经知道如何处理可排序的 Ajax 调用，那么混合两个列表就不是问题了。我正在使用[此页面](http://jqueryui.com/sortable/#connect-lists)上编码的修改版本。我正在使用[`receive`事件](http://api.jqueryui.com/sortable/#event-receive)和[`stop`事件](http://api.jqueryui.com/sortable/#event-stop)来展示如何将简单的函数挂钩到基本的可排序编码中：

```
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>jQuery UI Sortable - Connect lists</title>
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
  <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
  <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css" />
  <style>
  #sortable1, #sortable2 { list-style-type: none; margin: 0; padding: 0 0 2.5em; float: left; margin-right: 10px; }
  #sortable1 li, #sortable2 li { margin: 0 5px 5px 5px; padding: 5px; font-size: 1.2em; width: 120px; }
  </style>
  <script>
  $(function() {
    $( "#sortable1, #sortable2" ).sortable({
      connectWith: ".connectedSortable",
      receive: function( event, ui ) { alert('Receive!'); },
      stop: function( event, ui ) { alert('Stop!'); }
    }).disableSelection();
  });
  </script>
</head>
<body>

<ul id="sortable1" class="connectedSortable">
  <li class="ui-state-default">Item 1</li>
  <li class="ui-state-default">Item 2</li>
  <li class="ui-state-default">Item 3</li>
  <li class="ui-state-default">Item 4</li>
  <li class="ui-state-default">Item 5</li>
</ul>

<ul id="sortable2" class="connectedSortable">
  <li class="ui-state-highlight">Item 1</li>
  <li class="ui-state-highlight">Item 2</li>
  <li class="ui-state-highlight">Item 3</li>
  <li class="ui-state-highlight">Item 4</li>
  <li class="ui-state-highlight">Item 5</li>
</ul>

</body>
</html> 
```

所以当一个项目被排序并且排序停止时，“停止！” 弹出警告框。当一个新项目从另一个列表拖到一个列表中时，“接收！” 除了停止之外还会弹出警告框。您也许可以只使用该`stop`事件来触发 Ajax 调用，但`receive`如果/当将新项目添加到列表中时，该事件甚至可以用于执行其他操作。

# javascript - Javascript toString 对我来说毫无意义

> ID：14532671
> 
> 赞同：1
> 
> 时间：2013-01-26T00:59:34.027
> 
> 标签：javascript, syntax

好的，我只是这样做了，挠了挠头。我在 Chrome 控制台上尝试了以下操作：

```
var a = [];
toString.call(a); //[object Array]
a.toString(); //""
toString(a); //[object Object] I know it's blunder but still! 
```

toString 和 .toString 有什么区别我绝对知道它们来自不同的范围（对象），但是应该在什么时候使用哪个呢？为什么这么乱？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T01:11:29.283

首先我们要明确`toString`指的是`Object.prototype.toString`：

```
> toString === Object.prototype.toString
  true 
```

[规范的第 15.2.4.2 节](http://es5.github.com/#x15.2.4.2)`Object.prototype.toString`解释了工作原理：

> 1.  如果`this`值为`undefined`，则返回`"[object Undefined]"`。
> 2.  如果`this`值为`null`，则返回`"[object Null]"`。
> 3.  让`O`是调用`ToObject`将`this`值作为参数传递的结果。
> 4.  设`class`为 的`[[Class]]`内部属性的值`O`。
> 5.  `"[object "`返回作为连接三个 String 、`class`和的结果的 String 值`"]"`。

`toString.call(a)`与上述算法相同`Object.prototype.toString.call(a)`并根据上述算法工作：`this`引用数组`a`（因为您使用`.call`了 ），内部`[[Class]]`属性具有值`Array`，因此输出为`[object Array]`.

`a.toString()`: 数组会覆盖[第 15.4.4.2 节](http://es5.github.com/#x15.4.4.2)`toString`中定义的属性。简而言之，所有数组元素都被连接起来，并且由于数组为空，因此您会得到一个空字符串作为结果。

`toString(a)`是一样的`Object.prototype.toString()`。该论点被简单地忽略。因此`this`指的是`Object.prototype`，它是一个对象，根据上面提到的算法，输出是`[object Object]`。对于 的任何值，输出都是相同的`a`。

* * *

> 应该在什么时间使用哪一个？

这取决于你想做什么。就个人而言，我发现没有一个内置`toString`函数特别有用，除了一些快速和肮脏的调试。

* * *

> `toString.call(a)`应该`== a.toString()`

好吧，`Object.prototype.toString`这`Array.prototype.toString`只是两种不同的方法，因此您会得到不同的结果。

您可能会争辩说， 如果存在就`Object.prototype.toString`应该调用覆盖`toString`，但这不是`toString`实现方式。

# css - 网页布局的 CSS 参数

> ID：14532672
> 
> 赞同：1
> 
> 时间：2013-01-26T00:59:40.293
> 
> 标签：css, layout

我真的是制作网页的初学者。我阅读了大量的教程，我认为我取得了相当大的进步。但我被困在一个简单的问题上。我想用这种布局制作一个简单的网页：http: [//i49.tinypic.com/1r54l4.jpg](http://i49.tinypic.com/1r54l4.jpg)

我有一个有背景的身体。我希望此背景在 png 徽标的上方和下方可见。然后我在左侧有带有相同颜色背景的菜单的画布。然后页脚再次留有一点边距。代码如下所示：

```
body {
margin: 0;
padding-top: 10px;
background-image: url('pics/background.png');
background-repeat: repeat; 
}

#wrapper {
width:1200px;
height:100%;
margin-left:12%;
}

#content {
background: rgba(255, 251, 208, 0.9);
height:100%;
margin-top:10px;
}

#menu {
width:16%;
float:left;
}

#canvas {
width:84%;
float:right;
} 
```

有了这个，我得到的只是没有背景颜色的网页。例如，Firebug 显示包装器或内容的高度刚好在画布上方。我尝试了数十种不同的设置，但每次都有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:24:38.693

我认为您需要在包装器上使用 clearfix 类（[http://css-tricks.com/snippets/css/clear-fix/](http://css-tricks.com/snippets/css/clear-fix/)），据我所知，所有包装器内部元素都是浮动的

# backbone.js - Backbone Relational 中的事件：它们有什么用，它们做什么，触发器可以安全地删除吗？

> ID：14532676
> 
> 赞同：2
> 
> 时间：2013-01-26T01:00:11.563
> 
> 标签：backbone.js, backbone-relational

我一直在尝试破译backbone.relational 源代码。我发现它会触发很多自己的事件。我登录了我的一些模型，发现很多这些事件似乎无缘无故地触发了。

大问题是*我应该听哪些事件以及哪些是内部事件*

Backbone.Relational 似乎触发的事件是：

*   更新：[属性] 似乎触发 [第 725、941 行]
*   关系：添加 当在集合上调用 .add() 时，这似乎会触发
*   关系：删除 当在集合上调用 .remove() 时，这似乎会触发 [1651, 1003]
*   关系：重置这似乎没有韵律或理由（为什么在排序时被解雇！！！）[1664、1675]
*   关系：更改：[属性]：不知道这是做什么的 [1138]

有人可以解释每个的目的是什么以及是否可以从源中删除某些触发器

作为比较，Backbone 的原生事件：

*   "add" (model, collection, options) — 将模型添加到集合时。
*   "remove" (model, collection, options) — 当模型从集合中移除时。
*   "reset" (collection, options) — 当集合的全部内容被替换时。
*   "sort" (collection, options) — 当集合被重新排序时。
*   "change" (model, options) — 当模型的属性发生变化时。
*   "change:[attribute]" (model, value, options) — 当特定属性被更新时。
*   "destroy" (model, collection, options) — 当模型被销毁时。
*   "request" (model, xhr, options) — 当模型（或集合）开始向服务器发出请求时。
*   "sync" (model, resp, options) — 当模型（或集合）与服务器成功同步时。
*   "error" (model, xhr, options) — 当模型的保存调用在服务器上失败时。
*   "invalid" (model, error, options) — 当客户端上的模型验证失败时。
*   "route:[name]" (params) — 当特定路由匹配时由路由器触发。
*   "route" (router, route, params) — 当任何路由匹配时由历史（或路由器）触发。
*   “all”——这个特殊事件触发任何触发事件，将事件名称作为第一个参数传递。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T12:24:01.180

[Backbone.Relational 自述](https://github.com/PaulUithol/Backbone-relational/blob/master/README.md)文件中非常清楚地说明了每个事件的目的：

*   将新事件绑定到一个`Backbone.RelationalModel`for：
    *   除了`HasMany`关系（绑定到`add:<key>`）
    *   从`HasMany`关系中删除（绑定到`remove:<key>`）
    *   重置`HasMany`关系（绑定到`reset:<key>`）
    *   对键本身`HasMany`和`HasOne`关系的更改（绑定到`update:<key>`）

至于你应该听哪些事件：如果你需要的话，所有的。这就是为什么他们在那里，并记录在案。

至于哪些是内部使用的，可以在[Backbone.Relational 源码](https://github.com/PaulUithol/Backbone-relational/blob/master/backbone-relational.js)中找到答案。如果您`.bind`在源文件中搜索，您会看到它在内部侦听以下事件：

*   `relational:add`
*   `relational:remove`
*   `relational:change:key`
*   `relational:reset`

所以我怀疑任何事件触发器都可以“安全地”从源中删除。一般来说，我会说修补库源是解决问题的错误方法。

在过去的几天里，您发布了一些与 Backbone.Relational 事件相关的问题。也许尝试解释为什么这些事件会导致问题，我们会寻找解决方法？

# ruby-on-rails - 如何缩短单个资源丰富的 Rails 路线？

> ID：14532677
> 
> 赞同：1
> 
> 时间：2013-01-26T01:00:11.890
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-routing

所以，我有以下内容`routes.rb`：

```
scope(path_names: { new: "register" }) do
  resources :accounts
end 
```

这很有效，因为它会生成一条`/accounts/register`路线，但想将其更改为简单地说`/register`. 我知道我可以使用`match "/register" => "accounts#new"`，但我想知道是否有*更好*的方法来实现这一点，因为这仍然会使`/accounts/register`路线“开放”。我可能可以通过使用将其重命名为晦涩的名称`{new: "pygmy_puff"}`，但我不确定这是否是正确的方法。

我真的很想把这件事做对。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:28:11.803

就个人而言，我不会担心额外的路线，并使用额外的匹配语句。期待rails 4，虽然我认为用http方法编写会更好：

```
get "/register" => "accounts#new" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:38:17.343

试试这个：

```
match "/register" => "accounts#new"
# ...
 scope(path_names: { new: "register" }) do
  resources :accounts, :except => :new
end 
```

以该顺序。

# c++ - 非 eigen float* 到 eigen::MatrixXf 的深拷贝

> ID：14532679
> 
> 赞同：2
> 
> 时间：2013-01-26T01:00:37.680
> 
> 标签：c++, eigen

如果`x`是浮点数的非特征向量，我可以将其映射到`eigen::MatrixXf`：

```
MatrixXf x_cen=Map<MatrixXf>(*x,*n,*p); 
```

但是，由于它们共享内存，`x_cen`因此也会报告对的修改。`x`我想要的是避免这种情况。我想深拷贝`x`到 an`eigen::MatrixXf` `x_cen`以确保对 所做的更改`x_cen`不会报告给`x`. 怎么可能呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T10:04:41.687

你的代码：

```
MatrixXf x_cen=Map<MatrixXf>(*x,*n,*p); 
```

已经在做深拷贝了！所以你很好。Eigen 中没有浅拷贝。

只是为了完整起见，可以命名一个`Map<>`对象以像这样使用它`MatrixXf`：

```
Map<MatrixXf> x_cen(*x,*n,*p); 
```

在这种情况下，并且只有在这种情况下，对 的修改`x_cen`才会报告给`x`。

# javascript - 平移缩略图时平移更大的图像

> ID：14532681
> 
> 赞同：0
> 
> 时间：2013-01-26T01:00:58.817
> 
> 标签：javascript, html, canvas, pan

对不起，糟糕的标题，我不确定要使用的正确术语。

我在网页上放了一张世界地图，图像上有一个画布窗口。这张世界地图太大而无法立即查看，因此用户可以在窗口内平移图像。我还想在页面上放置一个“缩略图”版本的图像，并在缩略图顶部放置一个矩形光标。当用户将光标移到缩略图上时，大地图将移动（自平移）以匹配缩略图上矩形光标下的区域！[在此处输入图像描述][1]

提供的图像中有一个示例。您将看到世界地图的一小部分。右侧是带有矩形光标的图像缩略图。移动该光标时，世界地图将平移。

我正在使用 HTML5 和 javascript。没有其他语言。如果有人能指出我的榜样或让我走上正确的道路，我将不胜感激。

谢谢你！

# javascript - 这个 javascript/HTML 有什么问题

> ID：14532684
> 
> 赞同：1
> 
> 时间：2013-01-26T01:01:11.580
> 
> 标签：javascript, javascript-events

我想我只需要第二双眼睛看这个。div 的 onclick 事件似乎不起作用。有任何想法吗？

```
<!DOCTYPE html> 
<html> 
 <head>
 <meta charset="UTF-8">
 <title="My First Program"/>

 <script type="text/javascript">
      window.onload = function(){
           window.alert("If you see me then the page has loaded"); 
           click(); 
      }

      //we do programming here 
      /*because
        it is 
        fun*/
      window.alert("Helo World!"); 

      function click(){
           window.alert("CLICK!!!!");
      }

 </script>

 </head>
 <body>
      <div>This web page will run my first program</div>
      <!--this will be awesome-->
      <br>
      <br>
      <br>
      <div id="d1" onclick="click()">Click me</div>
 </body> 
```

另外，为了记录，这不是我的第一个程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T01:04:54.050

您的 html 格式错误。标题标签需要如下所示：

```
<title>My First Program</title> 
```

此外，您似乎有命名冲突，因为您将函数命名为与内置函数相同的名称。将您的“点击”功能重命名为“myclick”或其他名称。

一旦你解决了这个问题，其他一切都应该是好的。

当事情变得奇怪时，您应该始终做的第一件事是验证您的标记。

[http://validator.w3.org/check](http://validator.w3.org/check)

这是标记的完整工作版本。

```
<!DOCTYPE html> 
<html> 
 <head>
 <meta charset="UTF-8">
 <title>My First Program</title>

 <script type="text/javascript">
      window.onload = function(){
           window.alert("If you see me then the page has loaded"); 
           click(); 
      }

      //we do programming here 
      /*because
        it is 
        fun*/
      window.alert("Helo World!"); 

      function myclick(){
           window.alert("CLICK!!!!");
      }

 </script>

 </head>
 <body>
      <div>This web page will run my first program</div>
      <!--this will be awesome-->
      <br>
      <br>
      <br>
      <div id="d1" onclick="myclick()">Click me</div>
 </body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:14:55.200

每次我在任何地方看到这样的问题时，我给出的典型答案是“不要使用 Netscape 模型进行事件处理”。

读一读 - [http://www.quirksmode.org/js/introevents.html](http://www.quirksmode.org/js/introevents.html)

更新：看起来“点击”不是一个很好的函数名称，因为它已经注册了事件等，这可能是它不起作用的原因。我应该抓住它。

# javascript - JavaScript API SDK 安全性

> ID：14532685
> 
> 赞同：1
> 
> 时间：2013-01-26T01:01:18.163
> 
> 标签：javascript, jquery, api, restful-authentication

我已经为我的新服务开发了一个 API，并且正在为此 API 开发 SDK（php、ruby 和 JavaScript）。

一些对 API 的调用对公众开放，但有些需要 API 密钥和 API 机密。我的问题是，我如何确保人们在使用 JavaScript API 时可以隐藏他们的密钥和秘密。

我会想象这样的电话：

```
jQuery.ajax({
    url:'http://api.domain.com/v1/display/',
    data: {offset:0, limit:0, apiKey:'apikeynotlikelogin',apiSecret:'apisecretlikepassword'},
    success: function(data){
        alert(data);
    }
}); 
```

但是现在几乎每个人都知道，如果他们在chrome中打开firebug甚至更简单的ctrl+shift+j，他们可以看到代码以及上面的所有信息。我考虑了很多选项，但在我看来，似乎没有办法在前端隐藏 apiKey 和 apiSecret。

有什么建议么？我肯定有办法。

谢谢！

编辑：

感谢大家的回答并试图解决问题。以下是一些答案，为什么仍然不是我需要的：

1.  在请求中使用域名以确保其来自正确的客户端。这是有效的建议，但仍然很容易被伪造

2.  为每个呼叫生成唯一密钥这似乎更高级，但我再次发现它不适用于我的情况。我需要授权“应用程序”（人们在系统中注册以获得凭据并授权 API），因为用户将拥有不同级别的隐私设置，并且根据这些客户端将获得结果。

因此，如果我让客户端首先调用“握手”以获取会话唯一密钥，但随后（在握手或下一个请求中），客户端必须发送他的 apiKey 和 apiSecret 以授权 API 并获得正确的结果（根据政策等）所以最后和没有握手请求完全一样，任何知道apiKey和apiSecret的人都可以先调用握手然后授权。希望有意义

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:07:18.320

你可以让它变得更难，但你不能真正保护它。

您可以让他们注册他们将要发出请求的页面，并在检查身份验证时检查请求是否来自授权来源。不完美，因为这可以被伪造，但对于普通用户来说更难。

或者他们可以通过服务器进行代理，但这并没有多大帮助，因为他们需要保护对其代理的访问。

# r - 在 R 中重构市场数据

> ID：14532691
> 
> 赞同：0
> 
> 时间：2013-01-26T01:02:15.897
> 
> 标签：r

我对 R 和 stackoverflow 很陌生。我的数据正在作为 csv 文件读入 R。我已经想出了如何在 R 中自行重组货币 1，但是，我正在处理 900 多列数据，并且需要一种循环 R 脚本的方法，以将我对第 1 到第 7 列所做的操作应用到其他 900 列.

目前我的数据如下所示：

```
Currency 1                                                     Blank    Currency 2
Date        Contract    Last    Open   High    Low   Volume    Column   Date        Contract    Last    Open   High    Low   Volume
10/10/2012   Dec        100     101     105    99    20000     
10/11/2012   Dec        101     102     106    98    20100     
10/12/2012   Jan        102     103     107    97    20120 
```

如您所见，数据是水平发送给我的。在每种货币之间有一个空白列，我需要将数据堆叠在一起。

我希望数据看起来像这样：

```
Date        Contract    Last    Open   High    Low   Volume    Market
10/10/2012   Dec        100     101     105    99    20000     Currency 1
10/11/2012   Dec        101     102     106    98    20100     Currency 1
10/12/2012   Jan        102     103     107    97    20120     Currency 1
10/10/2012   Dec        50      52      49     99    20530     Currency 2
10/11/2012   Dec        53      56      43     98    24300     Currency 2
10/12/2012   Jan        56      52      48     97    22320     Currency 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T05:29:25.303

如果我理解正确，并且您的源数据的格式确实很好，您可能可以执行以下操作。在这里，[我链接到一个包含三组货币的 csv，这些货币](http://ideone.com/t3cGcA)复制了我*认为*您的源数据的样子。

首先，在 using 中读取文件`read.csv`但跳过第一行。使用`check.names = FALSE`以便允许重复的列名。

```
temp <- read.csv("http://ideone.com/plain/t3cGcA", 
                 header = TRUE, skip = 1,
                 check.names = FALSE)
temp
#         Date Contract Last Open High Low Volume          Date
# 1 10/10/2012      Dec  100  101  105  99  20000 NA 10/10/2012
# 2 10/11/2012      Dec  101  102  106  98  20100 NA 10/11/2012
# 3 10/12/2012      Jan  102  103  107  97  20120 NA 10/12/2012
#   Contract Last Open High Low Volume
# 1      Dec   50   52   49  99  20530
# 2      Dec   53   56   43  98  24300
# 3      Jan   56   52   48  97  22320
#   structure(c("NA", "NA", "NA"), class = "AsIs")       Date Contract
# 1                                             NA 10/10/2012      Dec
# 2                                             NA 10/11/2012      Dec
# 3                                             NA 10/12/2012      Jan
#   Last Open High Low Volume
# 1  500  501  605  99  20000
# 2  600  502  606  98  20100
# 3  700  503  607  97  20120 
```

其次——这是对数据集整洁性的一个假设——用于`seq`创建空白列所在位置的向量。由此，如果我们的整洁假设是正确的，您可以使用简单的数学来确定每种货币的开始（向量值减 7）和结束索引（向量值减 1）。

```
myblankcols <- seq(1, ncol(temp), by=8) + 7
myblankcols
# [1]  8 16 24 
```

使用上面提到的简单数学，创建`list`每种货币的子集，并将名称添加到列表中。您可以通过仅将文件的第一行作为 csv 文件重新读取并删除所有`NA`值来获取名称。

```
tempL <- lapply(seq_along(myblankcols), 
                function(x) temp[(myblankcols[x] - 7):(myblankcols[x] - 1)])
NamesTempL <- read.csv("http://ideone.com/plain/t3cGcA", 
                       header = FALSE, nrows = 1)
names(tempL) <- NamesTempL[!is.na(NamesTempL)]
tempL
# $`Currency 1`
#         Date Contract Last Open High Low Volume
# 1 10/10/2012      Dec  100  101  105  99  20000
# 2 10/11/2012      Dec  101  102  106  98  20100
# 3 10/12/2012      Jan  102  103  107  97  20120
# 
# $`Currency 2`
#         Date Contract Last Open High Low Volume
# 1 10/10/2012      Dec   50   52   49  99  20530
# 2 10/11/2012      Dec   53   56   43  98  24300
# 3 10/12/2012      Jan   56   52   48  97  22320
# 
# $`Currency 3`
#         Date Contract Last Open High Low Volume
# 1 10/10/2012      Dec  500  501  605  99  20000
# 2 10/11/2012      Dec  600  502  606  98  20100
# 3 10/12/2012      Jan  700  503  607  97  20120 
```

我通常很想在这一点上停下来，因为我发现列表有很多用途。但是，将其转换为单个`data.frame`. 这也是确保您`check.names = FALSE`在第一步中使用的原因之一：如果所有列都具有相同的名称，那么将`rbind`它们放在一起是没有问题的。

```
do.call(rbind, tempL)
#                    Date Contract Last Open High Low Volume
# Currency 1.1 10/10/2012      Dec  100  101  105  99  20000
# Currency 1.2 10/11/2012      Dec  101  102  106  98  20100
# Currency 1.3 10/12/2012      Jan  102  103  107  97  20120
# Currency 2.1 10/10/2012      Dec   50   52   49  99  20530
# Currency 2.2 10/11/2012      Dec   53   56   43  98  24300
# Currency 2.3 10/12/2012      Jan   56   52   48  97  22320
# Currency 3.1 10/10/2012      Dec  500  501  605  99  20000
# Currency 3.2 10/11/2012      Dec  600  502  606  98  20100
# Currency 3.3 10/12/2012      Jan  700  503  607  97  20120 
```

我肯定会停在这里，但从这里开始，您可能希望将“日期”列转换为实际列，并可能将行名（“货币 1.1”、“货币 1.2”等）转换为你的`data.frame`.

# editor - 安装用于 Haxe 的 Flashdevelop 深色方案？

> ID：14532693
> 
> 赞同：0
> 
> 时间：2013-01-26T01:02:33.157
> 
> 标签：editor, flashdevelop, haxe

我为 AS3 下载了一堆漂亮的 FD 方案。似乎没有适合 FD 的现成 Haxe 方案。据我了解，可以在 FD 中为 Haxe 使用 As3 方案，但到目前为止我无法实现它，并且搜索没有带来任何可用的结果。

据我所知，我可以很好地安装 As3 颜色然后我重命名为 Haxe.xml 但这对我不起作用:(

如果 SO 用户帮助我解决这个问题，我将不胜感激。我正在使用 FD 4.2.4

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T15:14:50.480

我创建的 FlashDevelop 主题（多年来一直在调整）包括 Haxe 的深色：http: [//tronster.com/code/fd/FlashDevelop-TronsterColors_v4.zip](http://tronster.com/code/fd/FlashDevelop-TronsterColors_v4.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T09:07:10.083

当你去`FlashDevelop > Tools > Syntax coloring`你可以编辑颜色。这些是按编码语言分类的。

Haxe 和 AS3 之间存在差异，这使得无法复制/粘贴/重命名。但是，当您查看名称时，会有相似之处。只需将您在 AS3 版本中找到的内容复制/粘贴到 haxe 主题，它看起来就差不多了。

与原始创建者共享主题的 Haxe 版本，以使网络更加完整。

# c# - Entity Framework 5.0 多列关系

> ID：14532695
> 
> 赞同：0
> 
> 时间：2013-01-26T01:02:45.037
> 
> 标签：c#, asp.net-mvc, entity-framework-5

在我的数据库中，我有客户、登录名和票证。

*   工单在 CreatedByID 上 有客户**或登录**
*   客户没有登录名，反之亦然
*   **使用票证上的CreatedByType**列在客户或登录名之间指定

我无法让实体框架使用它，并且没有任何运气阅读它。您如何使用 Entity Framework 实现此功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T13:03:14.243

您的数据库模型无效，因为实体之间的关系不明确。您可以引入额外的列，也可以在数据库端实现继承。这意味着您可以让客户实体从登录名继承，然后您只需要一个主 ID

# android - ViewPager 内的 ListView

> ID：14532697
> 
> 赞同：1
> 
> 时间：2013-01-26T01:03:06.313
> 
> 标签：android, android-layout, android-listview, android-viewpager, android-pageradapter

所以我在 ViewPager 中有一个 ListView。

我有`ListView`一个布局`(add_site.xml)`和一个`EditText`将填充`ListView` `onClick`另一个布局的字段`(main.xml)`

我收到一个 NPE 错误，因为我试图将 ArrayAdapter 全局化，认为这是能够在`ViewPager`.

显然我的 android 开发技能不是那么好。我对此很陌生。

所以任何帮助表示赞赏！

这是我的代码。

这是 PagerAdapter 开始的地方

```
 private class MyPagerAdapter extends PagerAdapter {

    final ViewPager mPager = (ViewPager) findViewById(R.id.fieldspager);

    public int getCount() {
        return 3;
    }

    public Object instantiateItem(View collection, int position) {

        LayoutInflater inflater = (LayoutInflater) collection.getContext()
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        ListView lv = (ListView)findViewById(android.R.id.list);

        final ArrayList<String> siteList = new ArrayList<String>();
        final ArrayAdapter<String> aa;
        aa = new ArrayAdapter<String>(getBaseContext(), R.layout.list_row, siteList);
        lv.setAdapter(aa);

        int resId = 0;
        View view = null;
        switch (position) {
            case 0:
                resId = R.layout.field01;
                view = inflater.inflate(resId, null);
                ((ViewPager) collection).addView(view, 0);

                return view;

            case 1: //ListView lives in here.
                resId = R.layout.add_site; 
                view = inflater.inflate(resId, null);
                Button addSiteButton = (Button)view.findViewById(R.id.addSiteButton);
                ((ViewPager) collection).addView(view, 0);
                addSiteButton.setOnClickListener(new View.OnClickListener() {

                    @Override
                    public void onClick(View v) {
                      mPager.setCurrentItem(2, true);
                    }

                });

                //I originally had the ArrayAdapter code here, but thought it needed to be global so I moved it up.

                return view;

            case 2:
                resId = R.layout.main;
                view = inflater.inflate(resId, null);
                Button signInButton = (Button)view.findViewById(R.id.sign_in_button);

                //This is where the EditText lives
                final EditText editText = (EditText)view.findViewById(R.id.textViewId);
                ((ViewPager) collection).addView(view, 0);
                signInButton.setOnClickListener(new View.OnClickListener() {

                    @Override
                    public void onClick(View v) {
                        //This is where the button click happens
                        siteList.add(0, editText.getText().toString());
                        aa.notifyDataSetChanged();
                        editText.setText("");
                        mPager.setCurrentItem(1, true);
                    }

                });
                return view;
        }

        return view;
    } 
```

先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T02:33:44.343

在我看来，您的 NPE 的直接原因是这一行：

```
ListView lv = (ListView)findViewById(android.R.id.list); 
```

我猜你打算做一些更接近这个的事情：

```
ListView lv = (ListView) layoutInflater.inflate(R.layout.add_site, null); 
```

我不清楚你对代码的最终目标，所以我不认为我可以在那里提出建议，但我认为你会发现这个例子在未来会提供非常丰富的信息：

[Android ViewPager 和 ListViews](https://stackoverflow.com/questions/7376613/android-viewpager-and-listviews)

挂在那里。安卓用户界面很乱。继续提问。

# jquery - 带有选择外部表的 jQuery DataTables

> ID：14532698
> 
> 赞同：0
> 
> 时间：2013-01-26T01:03:12.420
> 
> 标签：jquery, datatables

有没有一种外部下拉菜单可以控制数据表页面中显示的行数？我们将设置 "sDom": l 以显示内置的 Select 下拉菜单。但是我怎样才能使用外部下拉菜单来完成同样的工作呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:12:39.153

您可以使用 $('table#tableID').html(allTableHTML); 在表格内写入所有行 并且使用 allTableHTML，您可以做任何您想做的事情。例如。

var allTableHTML + rowOne + rowTwo + rowThree;

例如，在行中你可以写

var rowOne='第 1 列第 2 列';

所以按正确的顺序：

var rowOne='第 1 列第 2 列'; var allTableHTML + rowOne + rowTwo + rowThree; $('table#tableID').html(allTableHTML);

# c# - 公共部分类表格

> ID：14532699
> 
> 赞同：0
> 
> 时间：2013-01-26T01:03:14.680
> 
> 标签：c#, winforms

如果我创建 Form1 的部分类，有没有办法通过智能感知访问表单设计器上的控件？

```
namespace PracticeUI1
{
    public partial class Form1 : Form
    {
        Button1.Text = "blah";
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T01:29:14.180

如果你已经定义

```
public partial class Form1 : Form 
```

下一个部分类是（甚至可能没有`public`修饰符）

```
public partial class Form1 
```

还要确保你在同一个命名空间

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T01:38:38.283

类型`this.`和 IntelliSense 现在有足够的上下文来知道您对表单类的成员感兴趣。并弹出完成窗口：

![在此处输入图像描述](../Images/b39b8f692102631ce0cf6ddea3c02749.png)

表单类有很多成员，您可以通过键入更多来帮助缩小选择范围。按向上/向下键选择，Tab 键使用建议。

请注意，按钮的默认名称以小写 b 开头，而不是 B。这正是 IntelliSense 可以帮助您避免的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T01:47:45.330

这将取决于你将在哪里初始化你的按钮，假设你在同一个类中声明并且你这样做

```
private System.Windows.Forms.Button button1; 
```

在 Class Form 中，您只能从 Class Form 的这一部分或从另一个文件中的另一个部分类表单访问它，但您无法从同一个命名空间访问它。我想你明白了这个逻辑。

顺便回答一下

```
this.button1 
```

实际上，是否包含`this.`或不包含并不重要

# vhdl - VHDL - 写入寄存器

> ID：14532705
> 
> 赞同：0
> 
> 时间：2013-01-26T01:04:06.903
> 
> 标签：vhdl

我想使用四个按钮作为输入，三个七段 LED 显示器作为输出。两个按钮应通过 16 个 RAM 位置上下移动；另外两个应该增加和减少当前显示的内存位置的内容。一个七段显示器应显示当前地址 (0–F)，另外两个应以十六进制 (00–FF) 显示该位置的内容。这是我尝试执行此操作的代码（我还没有实现显示）：

```
library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity raminfr is
    port (
        clk : in std_logic;
        we : in std_logic;
        do : out unsigned(7 downto 0)
    );
end raminfr;

architecture rtl of raminfr is

type ram_type is array (0 to 15) of unsigned(7 downto 0);
signal RAM : ram_type;
signal read_a : unsigned(3 downto 0);
signal a : unsigned(3 downto 0);
signal di : unsigned(7 downto 0);
signal clock : std_logic;
signal key : std_logic_vector(3 downto 0);
begin
  U1: entity work.lab1 port map (
    clock =>clock,
    key => key,
    register_counter => a,
    value_counter => di
  );
process (clk)
begin
    if rising_edge(clk) then
        if we = '1' then
            RAM(to_integer(a)) <= di;
        end if;
        read_a <= a;
    end if;
end process;
do <= RAM(to_integer(read_a));
end rtl;

library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity lab1 is
    port(
        clock : in std_logic;
        key : in std_logic_vector(3 downto 0); 
        value_counter   : buffer unsigned(7 downto 0) ;
        register_counter : buffer unsigned(3 downto 0) 
        );
end lab1;

architecture up_and_down of lab1 is
    signal value_in_ram : unsigned(7 downto 0);
    signal clk : std_logic;
    signal we : std_logic;
        begin
        U1: entity work.raminfr port map (
            do=>value_in_ram,
            clk=>clk,
            we=>we
        );
    process(clock, value_counter, register_counter)
        begin
            if rising_edge(clock) then
                if (key(3)='0' and key(2)='0' and key(1)='1' and key(0)='0') then
                    value_counter <= value_counter + "1";   
                elsif (key(3)='0' and key(2)='0' and key(1)='0' and key(0)='1') then  
                    value_counter <= value_counter - "1";   
                elsif (key(3)='1' and key(2)='0' and key(1)='0' and key(0)='0') then
                    register_counter<= register_counter + "1";
                    value_counter <= value_in_ram;
                elsif (key(3)='0' and key(2)='1' and key(1)='0' and key(0)='0') then
                    register_counter<= register_counter - "1";
                    value_counter <= value_in_ram;
                end if;
            end if;
    end process;
end architecture up_and_down; 
```

当我尝试编译它时，我会一遍又一遍地重复以下错误：

```
Error (12051): Project too complex: hierarchy path is too long
Error (12052): Entity "lab1" is instantiated by entity "raminfr"
Error (12052): Entity "raminfr" is instantiated by entity "lab1" 
```

这显然是由于我已经将每个实体的端口映射到另一个，但我不知道任何其他方式来完成我想要完成的事情。有人可以提出替代方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T10:36:29.110

这是一个猜测，因为不太清楚你想做什么。问题似乎是设计问题之一：您很清楚最终结果应该做什么，但不清楚如何将其分解为以最简单的方式交互以实现目标的组件。

我的猜测是基于“raminfr”中的活动代码存储和加载数据独立于其他已经潜入的东西的事实。

所以我建议将“raminfr”作为一个内存组件进行清理，而不需要任何其他东西。然后它可以嵌入到处理键的“lab1”组件中，并存储和显示来自正确寄存器的值。它也可以在您需要内存的任何其他地方重复使用。

那么让我们看看raminfr。

```
entity raminfr is
    port (
        clk : in std_logic;
        we : in std_logic;
        do : out unsigned(7 downto 0)
    );
end raminfr; 
```

它有一个时钟、一个写使能输入和一个数据输出。但奇怪的是，没有地址或数据输入！现在，内存是一种标准的“设计模式”，偏离它可能是不明智的，所以让我们添加它们......

```
entity raminfr is
    port (
        clk  : in std_logic;
        we   : in std_logic;
        addr : in unsigned(3 downto 0);
        di   : in  unsigned(7 downto 0);
        do   : out unsigned(7 downto 0)
    );
end raminfr; 
```

记忆模式的一些变体具有其他特征；读使能、输出使能、单独的读和写时钟等，但这个简单的在这里就可以了。

您还可以使用泛型自定义其大小，修改其数据和地址总线宽度以匹配。这使它更有用，并节省了相似但不同的模块的扩散......

让我们清理架构以匹配。

```
architecture rtl of raminfr is
   type ram_type is array (0 to 15) of unsigned(7 downto 0);
   signal RAM    : ram_type;
   signal read_a : unsigned(3 downto 0);
begin
process (clk)
...
end process;
do <= RAM(to_integer(read_a));
end rtl; 
```

现在我们可以在“lab1”模块中实例化它，连接它的新端口

```
 U1: entity work.raminfr port map (
        addr => register_counter,   -- was "a", typo
        di   => value_counter,
        do   => value_in_ram,
        clk  => clk,
        we   => we
    ); 
```

并对lab1 的其余部分进行任何支持性更改。

这不是唯一合理的分解：您还可以使“lab1”成为一个没有自己存储的简单组件，并带出其他必要的信号作为端口。然后，您将需要第三个“顶级”实体，其架构将 lab1 和 raminfr 互连。

# mono - mono-test-install 显示我的 System.Drawing 损坏了

> ID：14532708
> 
> 赞同：2
> 
> 时间：2013-01-26T01:04:30.113
> 
> 标签：mono, system.drawing

我从 mono 项目中获得了 Mono 3.0.3 的压缩包，并在 Ubuntu 12.10 发行版上编译了它。

configure、make 和 make install 命令都运行没有错误。我运行了 mono-test-install，它报告“你的系统有一个损坏的 System.Drawing 设置”。我不太确定如何解决这个问题或它为什么坏了。我有一个有效的 libgdiplus.so 文件并将配置选项指向它。

在解决这个问题之前，我似乎无法使用 System.Drawing。有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-04T23:17:57.070

mono-test-install 脚本测试 System.Drawing 设置的方式是编译代码

```
using System;
using System.Drawing;

class X { 
    static void Main ()
    {
        Bitmap b = new Bitmap (100, 100);
    }
} 
```

使用命令

```
mcs -pkg:dotnet <filename> 
```

然后运行生成的文件

```
mono <filename>.exe 
```

您可以手动执行此过程，以查看导致 mono 断定 System.Drawing 已损坏的实际错误消息，可能允许您解决问题。

# c# - 使用 DllImport 将非托管 dll 加载到托管应用程序中

> ID：14532712
> 
> 赞同：3
> 
> 时间：2013-01-26T01:04:41.807
> 
> 标签：c#, c++, dllimport, unmanaged, dllnotfoundexception

在我的项目中，我有一个非托管的本机 C++ dll 和一个 C# 应用程序。我正在尝试使用 DllImport 从非托管 dll 导入一个函数，但我不断收到 DllNotFoundException。

这是我调用 DLL 的代码。

```
using System.Runtime.InteropServices;
namespace TestApp
{
  public delegate void UpdateDelegate(string s);
  class Program
  {
    [DllImport("CGPUnmanagedLibrary.dll")]
    internal static extern int parse_raw_gsod_file( 
      [MarshalAs(UnmanagedType.LPStr)]                                               
      string filePath,
      int minTemp, 
      UpdateDelegate callBack);

    static void Main(string[] args)
    {
      UpdateDelegate myCallBack = new UpdateDelegate(Program.Report);
      string path = @"C:\Creative Solutions\Projects\Clyde's Garden Planner\Frost Data Database\GSOD Data\GSOD_RAW_DATA\1992\gsod_1992.txt";
      int result = parse_raw_gsod_file(path, 32, myCallBack);
      Console.Write("Parse completed with exit code: " + result.ToString());
      Console.ReadLine();
    } // end main function

    public static void Report(string msg)
    {
      Console.Write("Message is ");
      Console.WriteLine(msg);
    }

  } // End class
} // end namespace 
```

我尝试将 DLL 复制到应用程序输出目录，但仍然找不到。我也尝试添加 DLL 项目作为参考，但我得到一个弹出窗口，说它无法添加。如何正确地将未管理的 DLL 链接到托管应用程序？

**更新**- 这是完整的错误：

```
Unable to load DLL 'CGPUnmanagedLibrary': The specified module could not be found. (Exception from HRESULT: 0x8007007E) 
```

**更新 2** - 我确定 DLL 与尝试加载它的 .exe 位于同一目录中。这让我认为 DLL 中存在未加载的依赖项。我只在 DLL 中使用基本的 C++ 库（字符串、数学、iostream 等）。有什么想法无法加载，为什么？

**更新 3** - 使用 Dependency Walker 测试在依赖 Walker 中加载我的非托管 C++ DLL 未显示任何错误。我还尝试在依赖项步行器中打开我的可执行文件，它显示加载两个 DLL 时出错：GPSVC.DLL 和 IESHIMS.DLL - 没有任何意义，因为我只在我的代码中使用标准 c++ 库。我认为这可能与我有一个托管 C++/CLI DLL 试图加载非托管 DLL 的事实有关（我试图实现一些 C++/CLI 包装器）。无论如何，我已经开始了一个新的 VS 解决方案并继续前进。看我的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T03:05:36.940

问题很可能不是您尝试加载的 DLL，而是它的（链式）依赖项之一。在 DLL 上运行 depends.exe 或类似的实用程序，以查看是否可以找到所有依赖项。误导性消息“找不到指定的模块”已成为经典的烦恼（如果不是常见问题解答材料！）：它使您认为几乎所有时间都找不到您的 DLL，但它是它的依赖项之一。被发现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T01:36:16.117

要进行测试，*.dll 需要与*尝试加载它的 .exe 位于同一目录中。此时不要相信 Visual Studio 会为你做这件事。将文件物理复制到 C:** *****\Debug\x86\bin\ 或您正在运行的任何配置。如有疑问，请将其复制到所有 bin 文件夹中。找出路径后，您开始寻找自动化项目构建以正确复制文件的方法。如果不这样做，把它放在 system32 中——它肯定会在那里找到它。但是，如果在做了这些事情之后，你仍然找不到它。可能还缺少对您的非托管 dll 的依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T02:10:51.627

首先我要感谢大家的帮助。不幸的是，我从未解决过这个问题（请参阅我的主要问题中的编辑）。答案是启动一个全新的 Visual Studio 解决方案并创建两个新项目：C# app 和 C++ dll。我不再需要包装器，因为我现在只是编组两个主要功能。

再次感谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-25T20:39:55.967

用户 arayq2 的回答很有意义，我也很快能够解决我的问题。

在我的情况下，无法加载的 dll (DllNotFoundException) 取决于另一个 dll。这个 dll（不是我项目的一部分）实际上是用某些 .h 和 .lib 文件的较新版本编译的。这些 .h 和 .lib 文件的旧版本（具有相同的文件名）是编译无法加载的 dll 的项目的一部分。

在我用这些 .h 和 .lib 文件的较新版本更新我的 dll 项目并重新编译我的 dll 项目后，我的问题就解决了。

谢谢你 arayq2！

# rubygems - 构建另一个 gem 时如何使用私有 gem 服务器托管的 gem

> ID：14532717
> 
> 赞同：3
> 
> 时间：2013-01-26T01:05:56.277
> 
> 标签：rubygems, gemspecs

如果我构建了一个私有 gem（例如，在我的公司内部托管），那么我想在我正在构建的另一个 gem（不是应用程序！）中重用该 gem，我该怎么做？

我在哪里放置我的依赖项并告诉我的新 gem 如何找到旧的（已经构建的）私人托管的 gem？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T01:07:22.920

所以我花了一段时间才弄清楚，因为答案是，它在两个地方。做这个：

*   在您的 gem 的 Gemfile（是的，Gemfile，不是 .gemspec）中，为您的私有 gem 服务器添加源代码行。如果您还从 RubyGems 中提取，那么它看起来像这样：

> ```
> source 'http://rubygems.org'
> source 'http://myrubygems.mycompany.example.com:8808'  # Or wherever your gems are hosted internally (or externally)
> gemspec 
> ```

*   然后，在您的 mynewgem.gemspec 中输入以下内容：

> ```
> Gem::Specification.new do |gem|
>   # [...]
>   gem.add_dependency 'myoldgem'  # the gem hosted at myrubygems.mycompany.example.com:8808
> end 
> ```

这样做的原因可能很明显：您的 Gemfile 指定了 gem 的来源，而您的 .gemspec 指定了依赖项。

希望这可以节省几分钟。

# c++ - 下面的代码如何工作？

> ID：14532718
> 
> 赞同：2
> 
> 时间：2013-01-26T01:06:11.960
> 
> 标签：c++, visual-studio-2010, stream

一个众所周知的事实是 cout 在 VS2010 中没有缓冲（参见 Stephan Lavavej 的帖子[）](http://connect.microsoft.com/VisualStudio/feedback/details/642876/std-wcout-is-ten-times-slower-than-wprintf-performance-bug-in-c-library)。为什么在下面的代码中我可以使用 cout 的缓冲区构造 ostream hexout？

```
#include <iostream>
#include <fstream>

using namespace std;

int main()
{
    // Construct ostream hexout with cout's buffer and setup hexout to print hexadecimal numbers

    ostream hexout(cout.rdbuf());
    hexout.setf (ios::hex, ios::basefield);
    hexout.setf (ios::showbase);

    // Switch between decimal and hexadecimal output using the common buffer

    hexout << "hexout: " << 32 << " ";
    cout << "cout: " << 32 << " ";
    hexout << "hexout: " << -1 << " " ;
    cout << "cout: " << -1 << " ";
    hexout << endl;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:13:23.900

每个流都有一个与之关联的 basic_streambuf。“无缓冲”仅仅意味着 basic_streambuf 不维护内部缓冲区（一块内存）来缓冲输入/输出，而是直接从文件（或控制台等）读取/写入文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:17:00.960

缓冲（或缺乏缓冲）不会直接发生在`std::stream`. 它发生在`std::streambuf`包含在 a 中的那个中`std::stream`。流的作用是将内容转换为某种字符串表示形式，并将转换后的内容发送到流缓冲区。无论是一次发送一个字节还是以更大的块发送它是（我认为）实现定义的。

您的代码有效，因为它都在一个线程中。当一切都在一个线程中时，您使用共享公共流缓冲区的两个流这一事实不是问题。调用`hexout.operator<<`在调用`cout.operator<<`开始之前完成。分号是一个序列点。

创建两个线程，一个 using`hexout`和另一个`cout`，如果您不使用某种锁定机制保护写入，您可能会一团糟。

# javascript - 在水平滚动上为选定的 li 设置固定位置

> ID：14532722
> 
> 赞同：0
> 
> 时间：2013-01-26T01:06:47.420
> 
> 标签：javascript, jquery, scroll

我有一个水平滚动，其中“选定的” li 类根据用户滚动而变化。我想要做的是使选定的 li 在滚动一段时间后消失时处于固定位置。

我的代码：

```
<div id="scroller2">
<ul id="ulscroller">
<li value="01" class="selected">1<div class="li-image"><img src="img/icon-dark.png" style="float: left;"></div></li>
<li value="02">2<div class="li-image"><img src="img/icon-dark.png" style="float: left;"></div></li>
...

<li value="30">30<div class="li-image"><img src="img/icon-dark.png" style="float: left;"></div></li>

</ul>

</div>

var scroller2 = document.getElementById("scroller2"),
    lis = scroller2.getElementsByTagName("li"),
    divisionsWidth2 = lis[0].offsetWidth - 20,
    current = 0
    scroller2.onscroll = function(){
    var selected = Math.floor(scroller2.scrollLeft/divisionsWidth2);
    if (current!==selected) {
        lis[current].className="";
        lis[selected].className="selected";
        current = selected;

        $("#nono2").html(lis[current].value);
    }
}; 
```

请查看小提琴：http: [//jsfiddle.net/7uCS8/1/](http://jsfiddle.net/7uCS8/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:26:12.440

如果您想始终在屏幕上保持可见选择的内容，您可以更改`divisionsWidth2`用于计算选择哪个元素以使用 li 项的平均宽度而不是仅使用*第*一个：[http://jsfiddle .net/7uCS8/2/](http://jsfiddle.net/7uCS8/2/)

```
avewidth = 0;
$("li").each(function () {
   avewidth += $(this).get(0).offsetWidth; 
});
avewidth = parseInt(avewidth / $("li").length); 
```

`li`如果所有的s 都等宽，它看起来会更好；不知道这对你来说有多困难。

# node.js - 在序列化循环中运行示例代码时出错

> ID：14532725
> 
> 赞同：2
> 
> 时间：2013-01-26T01:07:12.187
> 
> 标签：node.js

我一直在修改 node，在尝试学习 child_process 模块时，我遇到了一个问题。我试图序列化许多对 'ps -eF | 的调用。grep ssh'，但它在我的系统上崩溃并出现以下错误。所以两个问题。首先，有没有更好的方法可以在没有图书馆的情况下做我正在尝试的事情？其次，为什么它不起作用:)

```
events.js:71
        throw arguments[1]; // Unhandled 'error' event
                       ^
Error: This socket is closed.
    at Socket._write (net.js:519:19)
    at Socket.write (net.js:511:15)
    at Socket.<anonymous> (/home/me/tmp/test.js:10:16)
    at Socket.EventEmitter.emit (events.js:96:17)
    at Pipe.onread (net.js:397:14) 
```

```
function callpsgrep(callback) {
  var spawn = require('child_process').spawn,
      ps    = spawn('ls', ['-la']),
      grep  = spawn('grep', ['bananas']);

  ps.stdout.on('data', function (data) {
    grep.stdin.write(data);
  });

  ps.stderr.on('data', function (data) {
    console.log('ps stderr: ' + data);
  });

  ps.on('exit', function (code) {
    if (code !== 0) {
      console.log('ps process exited with code ' + code);
    }
    grep.stdin.end();
  });

  grep.stdout.on('data', function (data) {
    console.log('' + data);
  });

  grep.stderr.on('data', function (data) {
    console.log('grep stderr: ' + data);
  });

  grep.on('exit', function (code) {
    if (code !== 0) {
      console.log('grep process exited with code ' + code);
    }
    callback();
  });
}

function series(i) {
  if (i < 1000) {
    callpsgrep( function() {
      return series(i+1);
    });
  }
}
series(0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:36:56.183

**在关闭**事件而不是**退出**事件上关闭 grep 的标准输入。

```
ps.on('exit', function (code) {
  if (code !== 0) {
    console.log('ps process exited with code ' + code);
  }
});

ps.on('close', function (code) {
  grep.stdin.end();
}); 
```

* * *

虽然没有很好的**[记录](http://nodejs.org/api/child_process.html#child_process_event_exit)**，但我在帮助文件中阅读了以下内容。

## **事件：“退出”**

请注意，子进程 stdio 流可能仍处于打开状态。

## **事件：'关闭'#**

当子进程的 stdio 流全部终止时会发出此事件。这与“退出”不同，因为多个进程可能共享相同的 stdio 流。

# php - Magento 基于规则的产品关系在产品级别保存后消失？

> ID：14532731
> 
> 赞同：1
> 
> 时间：2013-01-26T01:07:33.093
> 
> 标签：php, magento

我们正在运行 Magento 企业版，并注意到当特定产品保存在管理员中时，“基于规则的产品关系”会从产品页面中消失。我们已经建立了诸如“HDMI 电缆”之类的关系，它与具有“HDMI 输入：是”属性的任何东西相关联，但是当我们编辑电视并点击保存时，推荐的附件会从该电视产品页面消失。我们发现，当我们进入应该填充产品页面的 HDMI 电缆类别的“相关产品”规则并点击“保存规则”按钮时，电缆将重新出现在上述电视页面。我们拥有数千种此类规则的可能性非常好，并且必须通过每条规则并手动保存它们的想法有点不祥？是否有人对定期更新规则有任何想法？任何帮助是极大的赞赏！

# c# - 将带有 & 符号的参数传递给控制器 操作方法

> ID：14532732
> 
> 赞同：3
> 
> 时间：2013-01-26T01:07:34.387
> 
> 标签：c#, asp.net, asp.net-mvc, razor

我有一个显示供应商链接的视图，其中包含指向每个供应商详细信息页面的链接

```
@foreach (var vendor in Model.Vendors)
{
    <li>
        <a href="/Vendors/@(vendor.Name)">@vendor.Name</a>
    </li>
} 
```

一个特定的供应商被命名为*“ABC 销售和服务”*，因此到他们的详细信息页面的链接是`/Vendors/ABC Sales & Services`。当我导航到该网址时，我收到此错误：

> **从客户端 (&) 检测到潜在危险的 Request.Path 值。**

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T01:13:38.977

将此添加到`web.config`'s `httpRuntime`：

```
<httpRuntime requestPathInvalidChars="&lt;,&gt;,*,%,:,\,?" /> 
```

默认情况下，该列表包括`&amp;`，您只是将其删除

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:13:39.343

您应该真正使用供应商的 ID（希望在您的数据库中有一个主键 - 数字/guid），而不是名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T01:18:03.847

您应该对供应商名称进行 UrlEncode：

```
<a href="/Vendors/@Url.Encode(vendor.Name)">@vendor.Name</a> 
```

顺便说一句，这是在您使用`Url.Action`或`Html.Action`构造锚标记的方法时代表您完成的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T01:31:06.717

您可以使用

```
<a href="@Url.Action("/Vendors/" + @vendor.Name)">@vendor.Name</a> 
```

# ios6 - 选择“更多...”项目时出现双导航栏

> ID：14532734
> 
> 赞同：2
> 
> 时间：2013-01-26T01:07:41.483
> 
> 标签：ios6, uitabbarcontroller, uistoryboard

我在我的 iOS 6 应用程序中使用故事板。在根我有一个标签栏，然后我有许多视图控制器标签，足以在栏中获得“更多...”项目。每个选项卡视图都嵌入在导航控制器中，这是一个非常标准的设置，如下所示，除了选项卡多于两个，足以在栏中显示“更多...”项：

哎呀，作为一个新手，我不能发布图像。这是图片的链接[http://maybelost.com/wp-content/uploads/2011/10/sb22.jpg](http://maybelost.com/wp-content/uploads/2011/10/sb22.jpg)

问题是，如果您点击“更多...”，然后点击溢出列表中的一项，视图会滑入，但您会看到双导航栏。

顶部是“更多...”屏幕的栏，除了后退按钮显示“更多...”外，它是空白的。就在它下面是我从溢出屏幕中选择的项目的导航控制器，以及它的标题等。

该应用程序正常运行，但显然这很糟糕。我怎样才能防止这种情况？

# android - 返回时间列表中的“下一个”时间

> ID：14532737
> 
> 赞同：0
> 
> 时间：2013-01-26T01:08:02.010
> 
> 标签：android, list, datetime, time

我正在寻找一个参考示例，说明如何读取列表中的时间，并返回“下一个”发生的时间。

我正在开发一个计划应用程序，但目前我正在做一堆非常嵌套的`if`语句，看起来像这样：

```
if (Time.compare(bus1.getTime(), currentTime) > 0) {
                setTimeLabelLOY(bus1);
            } else {
                if (Time.compare(bus2.getTime(), currentTime) > 0) {
                    setTimeLabelLOY(bus2);
                } else {
                    if (Time.compare(bus3.getTime(), currentTime) > 0) {
                        setTimeLabelLOY(bus3);
                    } else {
                        if (Time.compare(bus4.getTime(), currentTime) > 0) {
                            setTimeLabelLOY(bus4);
                        } else {
                            if (Time.compare(bus5.getTime(), currentTime) > 0) {
                                setTimeLabelLOY(bus5);
                            } else {
                                if (Time.compare(bus6.getTime(), currentTime) > 0) {
                                    setTimeLabelLOY(bus6); 
```

显然，我的`Bus`课程包含`Time`我硬编码的元素。我宁愿简单地阅读时间列表并输出下一个时间。或者也许制作一个时间数组并根据当前时间对它们进行排序？

任何有关如何更好地做到这一点的建议或示例将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:13:03.957

如果您将所有总线存储在 List 中，您可以使用：

```
List<Bus> buses = new ArrayList<Bus>();
buses.add(bus1);
// etc

for(Bus bus : buses) {
    if(Time.compare(bus.getTime(), currentTime) > 0) {
        setTimeLabelLOY(bus);
        break;
    }
} 
```

您还可以将所有总线数据存储在 SQLite 数据库中，然后使用如下简单查询：

```
SELECT * FROM Buses WHERE time > currentTime LIMIT 1; 
```

# python - 正则表达式如何获取中间字符串

> ID：14532741
> 
> 赞同：0
> 
> 时间：2013-01-26T01:08:36.320
> 
> 标签：python, regex

我想搜索出现在某个字符串之间的字符串。例如，

```
\start

\problem{number}
\subproblem{number}

/* strings that I want to get */

\subproblem{number}

/* strings that I want to get */

\problem{number}
\subproblem{number}
       ...
       ...
\end 
```

更具体地说，我想获得问题编号和子问题编号以及答案之间的字符串。

我有点想出这样的表达方式

```
'(\\problem{(.*?)}\n)? \\subproblem{(.*?)} (.*?) (\\problem|\\subproblem|\\end)' 
```

但它似乎不像我预期的那样工作。这个表达有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:22:14.327

TeX 相当复杂，我不确定使用正则表达式解析它的感受。

也就是说，您的正则表达式有两个问题：

*   您正在使用一个空格字符，您应该只使用所有空格
*   您需要为最终组使用前瞻断言，这样它就不会被吃掉（因为下次您需要在正则表达式的开头匹配它）

试试这个：

```
>>> v
'\\start\n\n\\problem{number}\n\\subproblem{number}\n\n/* strings that I want to get */\n\n\\subproblem{number}\n\n/* strings that I want to get */\n\n\\problem{number}\n\\subproblem{number}\n       ...\n       ...\n\\end\n'
>>> re.findall(r'(?:\\problem{(.*?)})?\s*\\subproblem{(.*?)}\s*(.*?)\s*(?=\\problem{|\\subproblem{|\\end)', v, re.DOTALL)
[('number', 'number', '/* strings that I want to get */'), ('', 'number', '/* strings that I want to get */'), ('number', 'number', '...\n       ...')] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T01:28:32.690

这个：

```
(?:\\problem\{(.*?)\}\n)?\\subproblem\{(.*?)\}\n+(.*?)\n+(?=\\problem|\\subproblem|\\end) 
```

为我返回三个匹配项：

第一场比赛：

```
group 1: "number"
group 2: "number"
group 3: "/* strings that I want to get */" 
```

比赛2：

```
group 1: null
group 2: "number"
group 3: "/* strings that I want to get */" 
```

第 3 场比赛：

```
group 1: "number"
group 2: "number"
group 3: "       ...\n       ..." 
```

* * *

但是，我宁愿分两步解析它。

首先使用以下方法找到问题的编号（第 1 组）和内容（第 2 组）：

```
\\problem\{(.*?)\}\n(.+?)\\end 
```

然后使用以下方法在该内容中找到子问题的编号（第 1 组）和内容（第 2 组）：

```
\\subproblem\{(.*?)\}\n+(.*?)\n+(?=\\problem|\\subproblem|\\end) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T01:28:54.147

如果问题真的是“这个表达式有什么问题？”，答案如下：

*   您正在尝试将换行符与`.*?`. 你需要让它`(?s)`工作。
*   您在正则表达式的中间有明确的空格和换行符，在源文本中没有任何对应的字符。你需要让它`(?x)`工作。

这可能不是表达式的*全部*错误。但只需添加`(?sx)`，将其转换为原始字符串（因为我不相信自己可以正确混合 Python 引用和正则表达式引用），然后删除`\n`给我这个：

```
r'(?sx)(\\problem{(.*?)}? \\subproblem{(.*?)} (.*?)) (\\problem|\\subproblem|\\end)' 
```

这将返回 2 个匹配而不是 0，这可能是对您的正则表达式的最小更改。

但是，如果问题是“我该如何解析这个？”，而不是“我现有的尝试有什么问题？”，我认为 impl 的解决方案更有意义（而且我也同意使用正则表达式解析 TeX 的观点通常一个坏主意）——或者，更好的是，像 Regexident 那样分两步完成。

* * *

> 如果使用正则表达式来解析 TeX 不是一个好主意，那么你会建议用什么方法来解析 TeX？

首先，作为一般的经验法则，如果我不能自己编写正则表达式来解决问题，我不想用正则表达式来解决它，因为我很难弄清楚它从现在开始的几个月。有时我将其分解为子表达式，或者使用`(?x)`注释并加载它，但通常我会寻找另一种方式。

更重要的是，如果你有一个真正的解析器，它可以使用你的语言并给你一棵树（或任何合适的东西），你可以走动和搜索——例如`etree`XML——那么你就有了 90% 的解决方案。你在处理那种语言时会遇到的问题。一个又快又脏的正则表达式（尤其是一个你不能自己写的）只能让你解决下一个问题的 10%。而且通常情况下，如果我今天遇到问题，我会在接下来的几个月内遇到更多问题。

那么，在 Python 中什么是好的 TeX 解析器呢？老实说，我不知道。我知道`scipy`/`matplotlib`有一些东西可以做到这一点，所以我可能会先看看那里。除此之外，请查看 Google、PyPI，也许还有 tex.stackexchange.com。搜索中出现的第一件事是[`Texcaller`](http://www.profv.de/texcaller/)和[`plasTeX`](http://plastex.sourceforge.net/plastex/)。我不知道它们有多好，或者它们是否适合您的用例，但是浏览教程并找出答案应该不会花很长时间。

如果事实证明那里什么都没有，而归结为自己写一些东西，例如[`pyparsing`](http://pyparsing.wikispaces.com)与正则表达式，那么这是一个更艰难的选择。某些语言，很容易只定义您关心的子集，而将其余部分保留为巨大的未解释标记，在这种情况下，真正的解析器将与正则表达式一样简单，因此您不妨这样做。其他语言，你必须处理一半的语法才能做任何有用的事情，所以我什至不会尝试。在决定走哪条路之前，我必须花一点时间来考虑它并尝试两种方式。

# python - import zlib ImportError: 没有名为 zlib 的模块

> ID：14532742
> 
> 赞同：4
> 
> 时间：2013-01-26T01:09:05.490
> 
> 标签：python, python-2.7, virtualenv, zlib, pythonbrew

```
# pythonbrew venv create django1.5
Creating `django1.5` environment into /usr/local/pythonbrew/venvs/Python-2.7.3
Traceback (most recent call last):
File "/usr/local/pythonbrew/etc/virtualenv/virtualenv.py", line 19, in <module>
import zlib
ImportError: No module named zlib 
```

我应该怎么办？？我想导入zlib。

我已经安装了 zlib *

```
# rpm -qa |grep zlib
zlib-1.2.5-7.fc17.i686
zlib-devel-1.2.5-7.fc17.i686 
```

更新：

```
# uname -a
Linux localhost.localdomain 3.6.10-2.fc17.i686 #1 SMP Tue Dec 11 18:33:15 UTC 2012 i686 i686 i386 GNU/Linux
# cat /etc/issue
Fedora release 17 (Beefy Miracle)
Kernel \r on an \m (\l) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T06:05:19.260

检查 PYTHONPATH 变量。可能是django启动时这个变量设置不正确。从其他人手中 django1.5 使用不正确的路径来搜索库。第二个原因可能是 zlib 安装在非默认路径中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T01:53:30.887

这就是我所做的（我只需要zlib）。

首先运行这个：`pythonbrew uninstall x.x.x`

然后运行这个：（`sudo apt-get install zlib1g-dev libssl-dev python-dev`在这里添加包）

现在这个：`pythonbrew install x.x.x`

在另一个终端窗口/选项卡中使用此命令跟随尾部（它们提供跟随尾部的命令）。

如果您在尾部没有看到任何错误，那么您应该让 zlib（和其他包）成功地与 pythonbrew 一起使用。

您现在应该可以创建一个 venv。

# c++ - 在 main 之后立即导致堆栈溢出的代码

> ID：14532743
> 
> 赞同：0
> 
> 时间：2013-01-26T01:09:07.693
> 
> 标签：c++, hash, stack-overflow

所以我为类编写了一个驱动程序，它使用一个菜单来测试不同的散列技术。我拥有的是一个抽象类“BaseHash”，其中包含所有虚函数和 5 个以不同方式散列的不同子类。当我这样做时：

```
while (numChoice!=0){
        switch(numChoice){
        case 1: myList= &MyHashContainer(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 2: myList= &hash2(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 3: myList= &chainingHash(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 4: myList= &quadraticHash(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 5: myList= &DoubleHash(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;

        }
    } 
```

调用 main 时出现堆栈溢出错误。调试器甚至不让我在抛出错误之前迈出一步。

如果重要的话 myList 看起来像这样

```
BaseHash *myList; 
```

如果我注释掉以 while 开头的代码，它不会抛出此错误。我什至不知道从哪里开始为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:22:01.587

我想通了。我忘记了堆栈上只有有限的空间，我需要使用“new”关键字来确保所有这些都在堆上进行

```
while (numChoice!=0){
        switch(numChoice){
        case 1: myList= new MyHashContainer(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 2: myList= new hash2(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 3: myList= new chainingHash(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 4: myList= new quadraticHash(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;
        case 5: myList= new DoubleHash(myStudentList.getStudentList(),myStudentList.getStudentList().size(),p);break;

        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:22:56.420

您正在分配`myList`构造函数执行的临时结果的地址 - 该值是一个临时值，没有与之关联的地址，因此该操作会导致未定义的行为。将返回值存储在临时变量中并获取其地址将解决技术问题，但也可能存在逻辑问题 - 尝试获取返回值的地址很可能是一个逻辑错误。

# ios - MFMessageComposeViewController 不工作

> ID：14532747
> 
> 赞同：4
> 
> 时间：2013-01-26T01:10:07.667
> 
> 标签：ios, xcode, nsstring, viewcontroller, mfmessagecomposeview

我有一个简单的方法，它获取一个参数然后发送一条消息。它不工作。

代码：

```
- (void)sendSMS:(NSString *)text {
    MFMessageComposeViewController *viewController = [[MFMessageComposeViewController alloc] init];
    viewController.body = text;
    viewControllerM.mailComposeDelegate = self;
    [self presentViewController:viewController animated:YES completion:nil];
} 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T01:13:35.403

您需要设置委托：

```
MFMessageComposeViewController *controller = [[[MFMessageComposeViewController alloc] init] autorelease];
    if([MFMessageComposeViewController canSendText])
    {
        controller.body = @"YO";
        controller.recipients = [NSArray arrayWithObjects:@"5625555555", nil];
        controller.messageComposeDelegate = self;

        [self presentViewController:controller animated:YES completion:nil];
    } 
```

# c - 如何在c中执行任意管道并继续

> ID：14532749
> 
> 赞同：1
> 
> 时间：2013-01-26T01:10:14.307
> 
> 标签：c, exec, fork, pipe, gnu

我正在尝试分叉，然后在子进程中执行两个或多个管道命令。我的想法是使用 while 循环在一个进程中连续分叉并执行命令，同时在另一个进程中继续循环。这是我的代码：

```
void
execute_pipe_command(command_t *c)
{
    command_t command = *c;
    pid_t pid = fork();
    if(pid > 0) {
        int status;
        while(waitpid(pid, &status, 0) < 0)
            continue;
        if(!WIFEXITED(status))
            error(1, errno, "Child exit error");
        command->status = WEXITSTATUS(status);
        return;
    } else if (pid == 0) {
        while(command->type == PIPE_COMMAND)
        {
            int fd[2]; pipe(fd);
            pid = fork();
            if(pid > 0) {
                close(fd[0]);
                dup2(fd[1], STDOUT_FILENO);
                char **args = command->u.command[1]->u.word;
                execvp(args[0], args);
            } else if (pid == 0) {
                close(fd[1]);
                dup2(fd[0], STDIN_FILENO);
                command = command->u.command[0];
                continue;
            } else {
                error(1, errno, "forking error");
            }
        }
        char **args = command->u.word;
        execvp(args[0], args);
    } else {
        error(1, errno, "forking error");
    }
} 
```

Command 是一个保存它的类型的结构，如果它是一个管道命令，它保存左右子命令。否则，如果它是一个简单的命令，它包含一个组成命令的字符串数组。

当我使用管道命令调用此函数时，`ls | cat`它应该执行命令，但它的行为却很奇怪。前两个管道命令将运行，但不会将控制权交还给程序。相反，它会挂起。随后的命令将被忽略。所以如果我给出这个`ls | cat | wc`函数将打印 ls 并且在我给出一个 SIGINT 之前不会退出。

我对发生了什么感到非常困惑。如果有人能指出问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T20:51:01.937

`while (command->type == PIPE_COMMAND)`永远是真的！这是它挂起的方式。

# javascript - ajax 调用检测无响应

> ID：14532751
> 
> 赞同：0
> 
> 时间：2013-01-26T01:10:30.983
> 
> 标签：javascript, ajax

我想知道这种情况是否有非 jquery 解决方案：

没有回复 ajax 请求，因为服务器的 Internet 连接中断，客户端的 Internet 连接中断，或者服务器崩溃。xmlhttprequest 对象中是否有一些内置的方法/事件可以帮助解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:18:33.637

您可以设置超时属性：

```
var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
            done(request.responseText);
        }
    },
    done = function (response) { console.log(response) },
    fail = function () {};

    xhr.open("GET", "url", true);
    xhr.timeout = 4000;
    xhr.ontimeout = function () { xhr.abort(); fail(); }
    xhr.send(); 
```

或者只是使用`window.setTimeout`

```
var xhr = new XMLHttpRequest(),
    timeout;

    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
            done(request.responseText);
            clearTimeout(timeout);
        }
    };

    xhr.open("GET", "url", true);
    xhr.timeout = 4000;
    xhr.ontimeout = function () { xhr.abort(); fail(); }
    xhr.send();
    timeout = window.setTimeout(function () { xhr.abort() }, 4000); 
```

# asp.net - 检查值是否为 DBNull

> ID：14532752
> 
> 赞同：0
> 
> 时间：2013-01-26T01:11:17.953
> 
> 标签：asp.net, vb.net

我有以下功能：

```
Public Shared Function imageExists(ByVal path As Object) As Boolean
                If IsDBNull(path) = False Or Not path Is Nothing Then
                    Dim pathString As String = Convert.ToString(path)
                    If Exists(HttpContext.Current.Server.MapPath(path)) Then
                        Return True
                    Else
                        Return False
                    End If
                Else
                    Return False
                End If

            End Function 
```

由此图像控件的可见属性调用：

```
<asp:Image ID="img_SmallImage" runat="server" ImageUrl='<%# "~/Content/Images/Exclusive/" + Eval("trip_SmallImage") %>' Visible='<%# OnTheMain.Images.Validation.imageExists(Eval("trip_SmallImage"))%>' /> 
```

无论我为该`If IsDBNull`部分尝试什么，它要么忽略它并执行代码，要么返回错误，例如`Conversion from type 'DBNull' to type 'String' is not valid.`

我该如何纠正这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:16:05.197

你在第一个 if 检查中有一个逻辑错误。

`Not Nothing`总是评估为真。所以第一条语句基本上可以编译为：

```
If IsDBNull(path) Or True Then 
```

这将永远是真的。您的 if 语句应该如下所示：

```
If Not IsDBNull(path) And path Is Not Nothing Then 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:33:53.663

我不知道你为什么同时使用`IsDBNull`and `Nothing`，无论如何

使用[AndAlso](http://msdn.microsoft.com/en-us/library/cb8x3kfz%28v=vs.100%29.aspx)，如果 previous 为 false 则不会检查下一部分

首先检查路径以防止异常：

```
 If path IsNot Nothing AndAlso IsDBNull(path) = False Then
        'do what ever you want to do
    End If 
```

仅供参考， [OrElse](http://msdn.microsoft.com/en-us/library/ea1sssb2%28v=vs.100%29.aspx) 将为 执行相同的功能`Or`，对我而言，我默认使用此短路逻辑运算符，请在[此处阅读我的问题](https://stackoverflow.com/questions/13782516/why-andalso-is-not-a-replacement-to-and)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:50:25.707

利用

```
If Not String.IsNullOrEmpty(path) Then 
```

因为您需要处理空字符串。您应该传递一个字符串，而不是一个通用对象。另外，你不能这样做`Or Not Nothing`。你必须这样做`Not IsDBNull(path) And Not path Is Nothing`。

# java - 如何判断 Graphics.drawImage() 何时实际完成

> ID：14532757
> 
> 赞同：1
> 
> 时间：2013-01-26T01:11:57.463
> 
> 标签：java, image, awt, java-2d

这是我第一次在这里提出问题，我希望我能得到一个对我有帮助的答案或想法。

我正在绘制一个大图像并使用 drawImage() 将其缩小。然后，我立即使用 drawImage() 绘制另一个图像，我希望将其绘制在前一个图像之上（第二个）。问题是 drawImage 会立即返回，即使缩放和渲染第一张图像需要大约 50 毫秒。大多数情况下，第二张图片最终位于第一张图片下方，因为它是在处理第一张大图片时首先绘制的。基本上无论如何都要强制 drawImage() 阻塞直到它完成，或者以某种方式检查它何时完成？

我知道 ImageObserver 参数，它在从 Internet 或其他地方下载图像时工作正常，但是当使用已经加载的 BufferedImage 时，它​​永远不会在缩放和绘图之后触发 ImageUpdate()。基本上，由于第一个图像已经“加载”，它永远不会联系 ImageObserver，它只需要大约 50 毫秒的时间在它自己的线程中处理，从不通知它何时完成。

有谁知道如何强制它阻止或等到它完全完成缩放和 blitting 图像？显然，使用 Thread.sleep(xx) 是一种完全的黑客行为，由于计算机速度之间的差异，它是不可行的。所有这些渲染都发生在paint(Graphics g) 方法内的事件线程上。

谢谢！

编辑：以下是我目前必须让您了解该问题的代码：

```
public void paint(Graphics window)
{
    window.setColor(Color.WHITE);
    window.fillRect(0, 0, Settings.width * Settings.aaFactor, Settings.height * Settings.aaFactor);

    Graphics2D window2D = (Graphics2D) window;
    window2D.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BICUBIC);
    window2D.drawImage(this.image, 0, 0, Settings.width, Settings.height, null);

    try
    {
        Thread.sleep(50);
    }
    catch (InterruptedException e)
    {
        e.printStackTrace();
    }

    window2D.drawImage(this.image2, 0, 0, null);

    repaint();
} 
```

编辑2：为了更好地解释我正在谈论的问题，我制作了一些示例代码，可以更好地解释我想要解释的内容。运行它，你会看到它在有时第一张图像在底部的地方闪烁（就像它应该是的那样），但大多数时候它会在顶部（第二张），这是错误的。只需将文件路径更改为小图像和大图像。

```
public class Main extends Applet implements ImageObserver
{
    private BufferedImage imageA;
    private BufferedImage imageB;

    @Override
    public void init()
    {
        try
        {
            this.imageA = ImageIO.read(new File("C:\\LargeImage.jpg"));
            this.imageB = ImageIO.read(new File("C:\\SmallImage.jpg"));
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }
    }

    @Override
    public void update(Graphics g)
    {
        paint(g);
    }

    @Override
    public void paint(Graphics g)
    {
        Graphics2D w = (Graphics2D) g;
        w.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BICUBIC);
        w.drawImage(this.imageA, 0, 0, 50, 50, this);// This takes a while to do (scaling down and drawing)...
        w.drawImage(this.imageB, 10, 10, null);// While this is drawn quickly, before A is done.

        repaint();
    }

    @Override
    public boolean imageUpdate(Image img, int infoflags, int x, int y, int width, int height)
    {
        System.out.println("ImageObserver fired, done drawing image.  NEVER CALLED!");
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T03:56:38.507

不可能知道 Swing 何时将`Graphics`对象的内容真正渲染到屏幕上。`paint`所知道的是，直到方法返回之后才会发生（因为`Graphics`对象在完成之前还没有最终确定为渲染）。

你应该做的是让`Component`你正在绘画来决定什么时候需要更新，这就是它的设计方式......（`Component`实现`ImageObserver`）

下面的示例在调整框架大小时不断重新缩放主背景图像

![在此处输入图像描述](../Images/5b10b466aa4e6f51a691391df6450972.png)

```
public class TestPaint03 {

    public static void main(String[] args) {
        new TestPaint03();
    }

    public TestPaint03() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new PaintPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class PaintPane extends JPanel {

        private BufferedImage background;
        private BufferedImage foreground;
        private Image scaled;

        public PaintPane() {

            try {
                background = ImageIO.read(new File("/path/to/background/image));
                foreground = ImageIO.read(new File("path/to/foreground/image"));
            } catch (Exception e) {
            }

        }

        @Override
        public void invalidate() {
            scaled = null;
            super.invalidate();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            if (background != null) {

                if (scaled == null) {
                    int size = Math.min(getWidth(), getHeight());
                    scaled = background.getScaledInstance(-1, size, Image.SCALE_SMOOTH);
                }

                int x = (getWidth() - scaled.getWidth(this)) / 2;
                int y = (getHeight() - scaled.getHeight(this)) / 2;
                g.drawImage(scaled, x, y, this);

                x = (getWidth() - foreground.getWidth()) / 2;
                y = (getHeight() - foreground.getHeight()) / 2;
                g.drawImage(foreground, x, y, this);

            }
        }
    }
} 
```

虽然我相信你有你的理由，但我个人会避免`Applet`赞成，`JApplet`事实上，我个人会避免使用小程序或一起使用。我开始了我的职业生涯编码小程序，它们只是一种痛苦，尤其是当你试图做的只是测试一个想法时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:36:39.293

`drawImage`（传递 null 的地方）的最后一个参数是一个`ImageObserver`. 如果您提供自己的该接口实现（[请参阅 JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/awt/image/ImageObserver.html)），您将在实际绘制图像时收到通知。

# c# - 具有相同名称的多个元素，具有多个子元素

> ID：14532758
> 
> 赞同：4
> 
> 时间：2013-01-26T01:11:57.653
> 
> 标签：c#, xml, children

我遇到了一个问题，我需要基本上反序列化这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<api_data>
  <status>ok</status>
  <sessions>
    <id>2</id>
    <sessionID>6bfd1f1a7e87a8a6ed476234ad1d6e86</sessionID>
    <gameID>1</gameID>
    <maxPlayers>8</maxPlayers>
    <hostIP>12.0.0.1</hostIP>
    <hostPort>1993</hostPort>
    <inProgress>0</inProgress>
    <timestamp>1358894690</timestamp>
  </sessions>
  <sessions>
    <id>3</id>
    <sessionID>eeb4dc2df32f885c2b7d13f28a246830</sessionID>
    <gameID>1</gameID>
    <maxPlayers>8</maxPlayers>
    <hostIP>12.0.0.1</hostIP>
    <hostPort>1993</hostPort>
    <inProgress>0</inProgress>
    <timestamp>1358894732</timestamp>
  </sessions>
</api_data> 
```

我需要将其转换为可用数据，它也是动态的，所以可能不止 2 个会话元素，可能有 4、20 或 0，我现在的代码刚刚损坏，我想知道什么是让它工作的好方法？

目前我已经到了 XDocument 类的点，所有这些都已加载。我需要用这些数据返回一个多维数组。

编辑：

当前代码，完全损坏：

```
var xmlSessions = xmlDATA.Descendants("api_data").Elements("sessions").Select(x => x);

result = new string[xmlDATA.Descendants("api_data").Count(), 7]; 
```

编辑 2：更多信息

我认为多维数组的方式如下：

```
array[0,0] "ok" //Status
array[1,0 to 7] //First Session details go here
array[2,0 to 7] //Second session details go here, and so forth. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T01:46:28.457

您可以定义以下类表示：

```
public class api_data
{
    public string status { get; set; }

    [XmlElement]
    public session[] sessions { get; set; }
}

public class session
{
    public int id { get; set; }
    public string sessionID { get; set; }
    public int gameID { get; set; }
    public int maxPlayers { get; set; }
    public string hostIP { get; set; }
    public int hostPort { get; set; }
    public int inProgress { get; set; }
    public int timestamp { get; set; }
} 
```

关键是属性`[XmlElement]`上的标记`sessions`，它将指示`XmlSerializer`使用您提供的模式示例读取/写入 XML。要反序列化它，您可以`XmlSerializer`这样使用：

```
//this might change, not sure how you obtain your xml, 
//but let's assume you already have it available as a string
byte[] xmlBytes = System.Text.Encoding.UTF8.GetBytes(xmlData); 

var stream = new MemoryStream(xmlBytes);
XmlSerializer serializer = new XmlSerializer(typeof(api_data));
api_data apidata = (api_data)serializer.Deserialize(stream); 
```

不需要任何更多的 XML 装饰或设置来读取它（测试和工作）。

编辑：虽然您可能想考虑使用其他一些 XML 属性来转换为一些更好的命名约定，但我们也`List<Session>`可以引导而不是数组：

```
[XmlRoot("api_data")]
public class ApiData
{
    [XmlElement("status")]
    public string Status { get; set; }

    [XmlElement("sessions")]
    public List<Session> Sessions { get; set; }
}

public class Session
{
    [XmlElement("id")]
    public int ID { get; set; }

    [XmlElement("sessionID")]
    public string SessionID { get; set; }

    [XmlElement("gameID")]
    public int GameID { get; set; }

    [XmlElement("maxPlayers")]
    public int MaxPlayers { get; set; }

    [XmlElement("hostIP")]
    public string HostIP { get; set; }

    [XmlElement("hostPort")]
    public int HostPort { get; set; }

    [XmlElement("inProgress")]
    public int InProgress { get; set; }

    [XmlElement("timestamp")]
    public int TimeStamp { get; set; }
} 
```

编辑：刚刚注意到你需要把它变成一个多维数组（不知道为什么，但你指定这是遗留的）。好吧，此时，您有一个很好的对象模型，您可以从中进行数据传输。不知道你是怎么打字的，但我们`object`现在假设类型数组：

```
ApiData apiData = DeserializeMyApiData(); // from above
array[0][0] = apiData.Status;
for(int i = 1; i <= apiData.Sessions.Count; i++)
{
    var session = apiData.Sessions[i - 1];
    array[i] = new object[8];
    array[i][0] = session.ID;
    array[i][1] = session.SessionID;
    array[i][2] = session.GameID;
    array[i][3] = session.MaxPlayers;
    array[i][4] = session.HostIP;
    array[i][5] = session.HostPort;
    array[i][6] = session.InProgress;
    array[i][7] = session.TimeStamp;
} 
```

无论您有多少会话，这将通过并建立您的阵列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T14:12:57.207

如果您*真的*只想要一个多维数组，您可以使用一行（有点长）代码从该 XML 中获取它：

```
string[][] items = XDocument.Parse(xml).Root.Elements().Select(e => e.HasElements ? e.Elements().Select(ei => ei.Value).ToArray() : new string[]{ e.Value }).ToArray(); 
```

或者使同一条语句更具可读性：

```
string[][] items = 
    XDocument.Parse(xml).Root
             .Elements().Select(e => e.HasElements ? 
                 e.Elements().Select(ei => ei.Value).ToArray() : new string[]{ e.Value })
             .ToArray(); 
```

从那个源 XML 中，这将产生一个像这样的数组：

```
string[][]
{
   { "ok" },
   { "2", "6bfd1f1a7e87a8a6ed476234ad1d6e86", "1", "8", "12.0.0.1", "1993", "0", "1358894690" },
   { "3", "eeb4dc2df32f885c2b7d13f28a246830", "1", "8", "12.0.0.1", "1993", "0", "1358894732" }
} 
```

如果您想单独获取状态，并将其他值放在多维数组中，您可以这样做：

```
XDocument doc = XDocument.Parse(xml);
string status = doc.XPathSelectElement("/*/status").Value;
string[][] items = 
    doc.Root.Elements().Where(e => e.HasElements)
       .Select(e => e.Elements().Select(ei => ei.Value).ToArray()).ToArray(); 
```

这将产生与上面相同的结果，除了 status 将是一个单独的字符串，并且 items 中不会包含第一个单元素数组：

```
string[][]
{
   { "2", "6bfd1f1a7e87a8a6ed476234ad1d6e86", "1", "8", "12.0.0.1", "1993", "0", "1358894690" },
   { "3", "eeb4dc2df32f885c2b7d13f28a246830", "1", "8", "12.0.0.1", "1993", "0", "1358894732" }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:31:10.257

您可以将“会话”标签包装在“会话列表”标签中吗？

如果是这样，你可以使用这样的东西来加载它：

```
public class api_data {

    public class sessions {
        public string id { get; set; }
        public string sessionID { get; set; }
        // put all the other vars in here ...
    }

    public string status { get; set; }           
    public List<sessions> session_list { get; set; }

    public static api_data LoadFromXML(string xmlFile) {

        api_data localApiData;

        // serialize from file
        try {
            var xs = new XmlSerializer(typeof(api_data),
                     new XmlRootAttribute("api_data"));
            using (TextReader tr = new StreamReader(xmlFile)) {
                localApiData= xs.Deserialize(tr) as api_data;
            }
        }
        catch (Exception ex) {
            Log.LogError(string.Format(
               "Error reading api_data file {0}: {1}",
               xmlFile, ex.Message));
            return null;
        }

        return localApiData;
    }
} 
```

如果您无法更改 xml 文件的格式，您可能需要在它自己的步骤中加载状态，然后像 api-data 是列表变量一样加载会话，尽管状态存在的事实可能会给您一个错误。

# c# - 尝试将列表存储在数据网格中

> ID：14532764
> 
> 赞同：1
> 
> 时间：2013-01-26T01:13:07.653
> 
> 标签：c#

我正在尝试制作一个程序，该程序具有显示在每一行的数据网格、比萨饼的配料列表、比萨饼名称和比萨饼的价格。我可以让数据网格显示名称和价格，但我无法让它显示成分列表。数据网格的数据源是一个名为 Pizza 的类的绑定列表。

```
 class Pizza
{
    private List<Ingredients> ingredientList_;
    private string pizzaName_;
    private decimal retailPrice_;

    public Pizza(List<Ingredients> ingredientList, string pizzaName, decimal retailPrice)
    {
        ingredientList_ = ingredientList;
        pizzaName_ = pizzaName;
        retailPrice_ = retailPrice;
    } 
```

它具有基本的 get 和 set 属性。我也有一个成分类。

```
 class Ingredients
{
    private string name_;
    private int servingSize_;
    private int energyValue_;
    private decimal purchasePrice_;
    private bool isVegetarian_;

    public Ingredients(string name, int servingSize, int energyValue, decimal purchasePrice, bool isVegetarian)
    {
        name_ = name;
        servingSize_ = servingSize;
        energyValue_ = energyValue;
        purchasePrice_ = purchasePrice;
        isVegetarian_ = isVegetarian;
    } 
```

具有基本的获取和设置属性。

在我的表单代码中，我有：

```
 private BindingList<Pizza> pizzaList_;

    pizzaList_ = new BindingList<Pizza>();
        dataGridViewPizzaMenu.DataSource = pizzaList_; 
```

现在我的问题是，当我单击它时，我正在尝试使用组合框列来显示比萨饼中的成分。但我似乎无法为成分创建绑定列，只有比萨名称和比萨价格。我错过了什么还是我试图做的事情是不可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:30:15.470

您可以制作一个组合框并设置此事件，接下来，使用 Datagridview1.Row.Add 方法在 Datagridview 中插入一行。但在此之前，您应该有一个带有一些单元格的 DatagridviewRow，该行的自己的单元格是 DataGrifViewComboBoxCell。

祝你好运...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:33:23.240

在表单加载事件上

```
ingredientList_  = context.Ingredients.OrderBy(p => p.ingredientName).ToList();

FillCombo(); 
```

//创建一个方法来填充combo

```
private void FillCombo()
  {
    IngredientBindingSource.DataSource = ingredientList_;
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:33:23.533

为了将组合框放到第三个字段中，您必须将前两个创建为 datagridview 项：

```
 DataGridViewRow RowSample = new DataGridViewRow();
  DataGridViewComboBoxCell  pizzaItem = new DataGridViewComboBoxCell();
  pizzaItem.DataSource = pizzaList_;  
  pizzaItem.Value = pizzaList_[0];
  DataGridViewCell pizzaName = new DataGridViewTextBoxCell();
  pizzaName.Value = pizza.pizzaName; // creating the text cell
  DataGridViewCell pizzaPrice = new DataGridViewTextBoxCell();
  pizzaPrice.Value = pizza.pizzaPrice;; // creating the text cell
  RowSample.Cells.Add(pizzaName);
  RowSample.Cells.Add(pizzaPrice);
  RowSample.Cells.Add(pizzaItem); 
  SampleGridView.Rows.Add(RowSample); 
```

现在 RowSample 添加了 3 个字段的 datagridview，第三个是组合框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T01:42:46.780

你所做的一切看起来都是正确的。我认为的问题是在设计或运行时设置 DataGridView 的方式。

如果您前往这个答案，您可以看到您需要采取的步骤： [将数组的所有元素添加到 datagridview 行，除了一个](https://stackoverflow.com/questions/13733114/add-all-elements-of-array-to-datagridview-rows-except-one)

*   绑定第一个组合框列的技巧是 BindingSource。在设计时>右键单击DataGridView>选择编辑列>选择第一列>选择数据源>单击添加项目数据源>选择对象>然后勾选`Ingredients`类并单击完成。

*   记住将第一个组合框列设置`DataMember`为成分列表，您需要选择添加的成分数据绑定源控件（略低于表单设计的表面 - 在灰色区域中）

*   第二个和第三个为 PizzaName 和 RetailPrice 添加两个 TextBox 列并相应地设置在那里`DataPropertyName`。

* * *

```
 pizzaList_ = new BindingList<Pizza>();
 //Insert code to populate the List of Pizza's and Ingredients
 dataGridViewPizzaMenu.AutoGenerateColumns = false;
 dataGridViewPizzaMenu.DataSource = pizzaList_;
 ingredientsDataBindingSource.DataSource = pizzaList_.ingredientsList_; 
```

ps 我上面提到的链接中有一个可下载的示例。

# eclipse - Eclipse 在构建路径中检测到循环，maven 没有

> ID：14532772
> 
> 赞同：2
> 
> 时间：2013-01-26T01:14:30.103
> 
> 标签：eclipse, maven, m2eclipse

Eclipse 在构建时给了我以下错误：

```
A cycle was detected in the build path of project 'com.X'. The cycle consists of projects {com.Y, com.Y}
A cycle was detected in the build path of project 'com.Y'. The cycle consists of projects {com.X, com.Y} 
```

但是，maven 使用“mvn clean install”从命令行构建完全正常，并且手动检查 POM 表明 com.X 依赖于 com.Y，但 com.Y 不依赖于 com.X。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:21:52.363

eclipse 和 maven 使用不同的构建配置文件，一个（eclipse）包含循环依赖，另一个（maven）没有。

# qt4 - 如何绘制矩形，调整大小使其适合我的小部件

> ID：14532774
> 
> 赞同：-1
> 
> 时间：2013-01-26T01:14:47.897
> 
> 标签：qt4

我喜欢在窗口或标签或其他任何东西中绘制矩形，但我喜欢保持较小的尺寸，以便它适合我的主窗口。我想到了一个停靠窗口，从 500x300 的大小开始。例如，矩形的大小可以是 4100x130 或 2800x2070，但这几乎超出了我的屏幕。我想要的是调整窗口大小，矩形也应该调整大小，仍然适合窗口。我怎样才能做到这一点？使用 qt-4.8.4 并安装了 opengl。我在 22 年前为 DOS 编写了一个程序，现在它应该在 linux 下运行。所以qt对我来说是新的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T17:29:50.563

[删除示例]

我的例子是另一个问题。因为我解决了我的问题有点不同。我会更好地描述我上面的问题

我不知道每个人电脑的屏幕尺寸。因此，由用户决定他制作一个窗口的大小。假设窗口大小是 600x400，现在我想在里面画一些 4000x1300 的东西，所以它必须缩放以适应 600x400 的小窗口，没问题。但是当用户增加窗口的大小时，甚至可能会增加绘图的大小，但是据我现在的理解，缺少信息。当我有一条 3 点长的线并且我拉它使其变成 5 点长时，原来的线只有 3 点信息，所以必须从某个地方添加 2 点。是否可以将 4100x1300 的整个绘图存储在某个地方，然后从那里缩放到我的窗口中？那么当窗口大小增加时，是否会生成存储图像的新缩放副本？

# php - 如何在下拉菜单中创建“全部”选项

> ID：14532779
> 
> 赞同：0
> 
> 时间：2013-01-26T01:15:10.237
> 
> 标签：php

下面的下拉菜单显示选项，其中每个选项的值都是`StudentId`来自 th 数据库：

```
<select name="student" id="studentsDrop">
<?php
while ( $currentstudentstmt->fetch() ) {
$stu = $dbStudentId;
if(isset($_POST["student"]) && $stu == $_POST["student"]) 
    echo "<option selected='selected' value='$stu'>" . $dbStudentAlias . " - " . $dbStudentForename . " " . $dbStudentSurname . "</option>" . PHP_EOL;
else
    echo "<option value='$stu'>" . $dbStudentAlias . " - " . $dbStudentForename . " " . $dbStudentSurname . "</option>" . PHP_EOL;
}
?>
</select> 
```

但是我的问题是如何显示一个`All`选项，如果用户选择了这个选项，那么这个选项的值将适用于所有学生 ID。

生成学生值的代码在这里：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:19:05.050

自己把它放在那里：

```
echo "<option>All</option>";
while ( $currentstudentstmt->fetch() ) { 
```

您可以执行相同的`_POST['student']`检查以查看是否`All`也被选中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:19:07.177

在大多数情况下，您会使用特殊值（“ALL”或“”或类似的东西）来表示请求了所有 id

# css - 带有信息的圆形 div，悬停时显示所有信息

> ID：14532780
> 
> 赞同：0
> 
> 时间：2013-01-26T01:15:11.060
> 
> 标签：css, html, hover, geometry

我想让三个圆形 div 彼此相邻（这不是问题）。在圆圈的底部，它将显示我的信息文本的第一个单词。悬停时，信息文本会上升，因此您可以阅读整个文本：

![http://i.imgur.com/zIbG27h.png](../Images/f568b857ab05a107f6c885a64bb75a2a.png)

我最初尝试做的是创建一个 div`width: 170px`并`height: 170px`在我的 CSS 中设置一个圆圈作为背景，然后`class:hover`显示文本。

我在尝试这样做时意识到，我无法像上面发布的*普通*图片那样隐藏圆圈“后面”的一些文字。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:19:32.477

使一个`img`浮动在文本顶部（使用 CSS 绝对定位），使圆圈的内部透明。请参阅[此处](https://stackoverflow.com/a/1997397/1979005)了解更多信息。

# mysql - 从 Cassandra 中提取数据以加载到关系数据库中的机制

> ID：14532783
> 
> 赞同：2
> 
> 时间：2013-01-26T01:15:31.963
> 
> 标签：mysql, hadoop, cassandra, etl

我们使用 Cassandra 作为我们应用程序的主要数据存储，该应用程序收集大量数据并需要大量存储空间和非常快的写入吞吐量。

我们计划定期提取这些数据并加载到关系数据库（如 mySQL）中。存在哪些提取机制可以扩展到每天数亿条记录？昂贵的第三方 ETL 工具（如 Informatica）不适合我们。到目前为止，我的网络搜索只显示了带有 Pig 或 Hive 作为选项的 Hadoop。然而，作为这个领域的新手，我不确定它们的扩展能力如何，以及它们在运行时会给 Cassandra 集群本身带来多少负载？还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:40:29.803

您应该看一下`sqoop`，它与 Cassandra 集成，如此处[所示](http://www.datastax.com/docs/datastax_enterprise2.0/sqoop/sqoop_help)。

这也很容易扩展，你需要一个 Hadoop 集群才能`sqoop`工作，它的工作方式基本上是：

*   将您的数据集分割成不同的分区。
*   运行一个 Map/Reduce 作业，其中每个映射器将负责传输 1 个切片。

因此，您希望导出的数据集越大，映射器的数量就越多，这意味着如果您不断增加集群，吞吐量将不断增加。这完全取决于你有什么资源。

至于 Cassandra 集群上的负载，我不确定，因为我没有`sqoop`亲自使用过 Cassandra 连接器，但是如果您想提取数据，无论如何您都需要在集群上增加一些负载。例如，您可以每天在流量最低的某个时间执行一次，这样万一您的 Cassandra 可用性下降，影响就会最小。

我也在想，如果这与[您的其他问题有关](https://stackoverflow.com/q/14532230/1332690)，您可能需要考虑导出到 Hive 而不是 MySQL，在这种情况下`sqoop`也可以，因为它可以直接导出到 Hive。一旦它在 Hive 中，您就可以使用与`sqoop`运行分析作业相同的集群。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-03T03:38:13.910

除了支付 etl 工具外，没有办法从 cassandra 中提取数据。我尝试了不同的方法，例如复制命令或 cql 查询——所有方法都会超时，而不管 Cassandra.Yaml 中的超时参数是否更改。Cassandra 专家表示，如果没有“where”子句，您将无法查询数据。这对我来说是很大的限制。这可能是至少对我来说不使用 cassandra 的主要原因之一。

# c - getaddrinfo 删除最后一个字符

> ID：14532785
> 
> 赞同：0
> 
> 时间：2013-01-26T01:16:04.343
> 
> 标签：c, sockets, localhost, character, getaddrinfo

```
int print_socket_info(int sock_fd, struct sockaddr_in *sin, short protocol){
    char dbg[INET_ADDRSTRLEN];
    char *famstr;
inet_ntop(protocol, &(sin->sin_addr), dbg, INET_ADDRSTRLEN);
printf("============ SOCKET INFORMATION =============\n");
printf("!** socket: %d\n", sock_fd);
printf("!** info->ai_addr: sockaddr_in(\n");
famstr = fam2str(sin->sin_family);
printf("!**     sin_family:    %s\n", famstr);
printf("!**     sin_port:      %d\n", ntohs(sin->sin_port));
printf("!**     sin_addr:      in_addr( s_addr : '%s' )\n", dbg);
printf("!**)\n");
printf("=============================================\n");
return 1;
}

char *fam2str(int fam){
switch (fam){
    case AF_INET:
        return "AF_INET";
    case AF_INET6:
        return "AF_INET6";
    case AF_UNSPEC:
        return "AF_UNSPEC";
    default:
        return "(UNKNOWN)";
    }
    return "(UNKNOWN)";
} 
```

如果我像这样传入hint.ai_addr（忽略信息-> ...这是字符串的一部分）：

```
print_socket_info(sock, (struct sockaddr_in *)hint.ai_addr, protocol); 
```

...然后我打印出以下内容...

```
============ SOCKET INFORMATION =============
!** socket: 3
!** info->ai_addr: sockaddr_in(
!**     sin_family:    AF_INET6
!**     sin_port:      8081
!**     sin_addr:      in_addr( s_addr : '::1' )
!**)
============================================= 
```

...信息打印正确。接下来我调用函数：

```
res =  getaddrinfo(target_host, target_port, &hint, &info); 
```

到目前为止，我没有收到任何错误。现在，我遍历链表：

```
struct addrinfo *rp;
for (rp = info; rp != NULL; rp = rp->ai_next){
    printf("==> Another element.\n");
    print_socket_info(sock, (struct sockaddr_in *) rp->ai_addr, protocol);
} 
```

...我只打印出一个元素：

```
============ SOCKET INFORMATION =============
!** socket: 3
!** info->ai_addr: sockaddr_in(
!**     sin_family:    AF_INET6
!**     sin_port:      8081
!**     sin_addr:      in_addr( s_addr : '::' )
!**)
============================================= 
```

...当然，这对 bind() 造成了严重破坏。为什么地址被缩短了？

还有一些奇怪的事情：如果我传入 127.0.0.1 并使用 AF_INET4 ，那么该地址会在整个程序中保持不变（但我只得到一个结果并且绑定仍然失败）。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:05:19.843

你的`print_socket_info`功能是错误的。如果采用`struct sockaddr_in *`（IPv4 套接字地址结构），但它意味着同时支持 IPv4 和 IPv6。

您必须声明`print socket_info`采用泛型`struct sockaddr *`（任何类型的套接字地址）。为了更好地衡量：重命名`sin`参数以`sa`表明它是泛型类型，而不是`struct sockaddr_in`类型。然后，在函数内部，您检查`sin->sin_family`以找出实际的族是什么，并继续通过强制转换`sin`为 a`struct sockaddr_in *`或`struct sockaddr_in6`视情况而定。

您现有函数中发生的事情是，您只是将其视为`struct sockaddr_in *`整个函数，并具有以下结果（至少在 Linux 上）：

*   检查`sin_family`是可以的，因为对于所有类型的 sockaddr，无论是或什至对于 UNIX 域套接字或所有其他模糊地址系列的 sockaddr 结构，都可以保证该系列在结构中的偏移`struct sockaddr_in`量`struct sockaddr_in6`相同`struct sockaddr_un`。
*   检查时您很幸运能够逃脱它，`sin_port`因为`sin_port`in`struct sockaddr_in`恰好与 in 位于结构中的相同偏移`sin6_port`量`struct sockaddr_in6`。
*   如果不适`sin_addr`用于 IPv4，则在结构中`sin_addr`紧随其后`sin_port`，但对于 IPv6，在该位置（即`sin6_flowinfo`）可以找到其他字段。`sin6_addr`在别的地方。

另一个问题`print_socket_info`是您的字符串缓冲区只有足够的空间用于 IPv4 地址字符串，因为它声明的长度`INET_ADDRSTRLEN`对于 IPv6 来说太短了（对于 IPv6，您需要`INET6_ADDRSTRLEN`。而且该函数不需要带参数`protocol`。此信息已经嵌入到 sockaddr 中。

```
int print_socket_info(int sock_fd, struct sockaddr *sa){
    char dbg[INET6_ADDRSTRLEN]; /* the larger of the two sizes */
    char *famstr;
    unsigned short port;

   switch (sa->sa_family):
        case AF_INET4:    
            inet_ntop(AF_INET4, &(((struct sockaddr_in *)sa)->sin_addr), dbg, sizeof(dbg));
            port = ((struct sockaddr_in *)sa)->sin_port;
            break;
        case AF_INET6:
            inet_ntop(AF_INET6, &(((struct sockaddr_in6 *)sa)->sin6_addr), dbg, sizeof(dbg));
            port = ((struct sockaddr_in6 *)sa)->sin6_port;
            break;
        default:
            strcpy(dst, "UNKNOWN");
            port = 0;
    }
    printf("============ SOCKET INFORMATION =============\n");
    printf("!** socket: %d\n", sock_fd);
    printf("!** info->ai_addr: sockaddr_in(\n");
    famstr = fam2str(sa->sa_family);
    printf("!**     sa_family:    %s\n", famstr);
    printf("!**     sin[6]_port:  %d\n", ntohs(port));
    printf("!**     sin[6]_addr:  in_addr( s_addr : '%s' )\n", dbg);
    printf("!**)\n");
    printf("=============================================\n");
    return 1;
} 
```

# c++ - 模板类上的“未解析的外部符号”

> ID：14532790
> 
> 赞同：0
> 
> 时间：2013-01-26T01:17:06.910
> 
> 标签：c++, templates, linker-errors, external-dependencies

我已经为同样的问题工作了三天，对此我无能为力。请帮忙！！

这不是同名问题的重复。名称相似，但问题完全不同。

我被告知可能与外部依赖关系有关。

我正在发布我的所有代码，如果我需要发布更多信息，请询问！

`list_test.cpp`这做得更多，但这就是它搞砸的地方。

```
 #include <cctype>       // Provides toupper
 #include <iostream>     // Provides cout and cin
 #include <cstdlib>      // Provides EXIT_SUCCESS
 #include "list.h"  // With value_type defined as double
 #include "Node.h"
 #include "Iterator.h"
 using namespace std;
 using namespace list_1;

 int main( )
 {
     list<double> test;
 } 
```

`iterator.h`

```
 // Template CLASS PROVIDED: Iterator 

 #pragma once
 #include "Node.h"

 namespace list_1
 {
template<typename T>
class Iterator
{
    public:
    Iterator<T> (Node<T> *np);
    // precondition: is_item is true
    // post condition n points to the next item in the list
    void operator++();
    // precondition: 
    // postcondition: returns true if there is a valid item
    bool is_item();
    // precondition: is_item == true
    // postcondition returns data that n is pointing at
    T operator* ();

    private:
    Node<T>* n;

};

template<typename T>
Iterator<T>::Iterator (Node<T> *np)
{
    n = np;
}

template<typename T>
void Iterator<T>::operator++()
{
    assert(is_item( ) == true);

    n = n->next;
}

template<typename T>
bool Iterator<T>::is_item()
{
    return (n->data != NULL);
}

template<typename T>
T Iterator<T>::operator* ()
{
    assert(is_item( ) == true);

    return n->data;
}
 } 
```

`Node.h`

```
 #pragma once

 namespace list_1
 {
template <typename T>
struct Node
{
    T data;
    Node<T> *next;

    // Constructor
    // Postcondition: 
    Node<T> (T d);
};

template <typename T>
Node<T>::Node(T d)
{
    data = d;
    next = NULL;
}
 } 
```

`list.h`

```
 #include "Node.h"
 #include "Iterator.h"

 namespace list_1
 {
template <typename T>
class list
{
    public:
        // CONSTRUCTOR
        list();
        // postcondition: all nodes in the list are destroyed.
        ~list();
        // MODIFICATION MEMBER FUNCTIONS
        //postcondition: entry is added to the front of the list
        void insert_front(const T& entry);
        //postcondition: entry is added to the back of the list
        void add_back(const T& entry);
        // postcondition: all nodes with data == entry are removed from the list
        void remove_all(const T& entry);
        // postcondition: an iterator is created pointing to the head of the list
        Iterator<T> begin(void);
        // CONSTANT MEMBER FUNCTIONS
        // postcondition: the size of the list is returned
        int size( ) const;
    private:
        Node<T>* head;
};

template <typename T>
list<T>::list( )
{
    head = NULL;
}

template <typename T>
list<T>::~list()
{

}

template <typename T>
void list<T>::insert_front(const T& entry)
{
    // head = new node(entry, head);
}

template <typename T>
void list<T>::add_back(const T& entry)
{

}

template <typename T>
void list<T>::remove_all(const T& entry)
{

}

template <typename T>
Iterator<T> list<T>::begin(void)
{
    //Iterator<T> traverse( );
    //return traverse;
}

template <typename T>
int list<T>::size( ) const
{
    int size = 0;
    Node<T> *tempPoint = head;

    for (tempPoint = head; tempPoint != NULL; tempPoint = tempPoint->next)
    {
        size ++;
    }

    return size;
}
 } 
```

这是错误消息：

```
 1>------ Build started: Project: CS2420LinkedList, Configuration: Debug Win32 ------
 1>list_test.obj : error LNK2019: unresolved external symbol "public: __thiscall list_1::list<double>::~list<double>(void)" (??1?$list@N@list_1@@QAE@XZ) referenced in function _main
 1>list_test.obj : error LNK2019: unresolved external symbol "public: __thiscall list_1::list<double>::list<double>(void)" (??0?$list@N@list_1@@QAE@XZ) referenced in function _main
 1>C:\Users\KyleYas\Documents\Visual Studio 2010\Projects\CS2420LinkedList\Debug\CS2420LinkedList.exe : fatal error LNK1120: 2 unresolved externals
 ========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T02:20:54.770

我不一定会捍卫它的使用，但我不认为你的问题是`using`陈述。当你不这样做时，我看不出有任何理由发生碰撞`#include <list>`。那将是：
`error C2872: 'list' : ambiguous symbol...`.

根据消息中的内容，我将首先确保`list.h`它应该在哪里。

此外，您始终可以参考 VS 错误代码，例如您获得的[LNK2019 ，并针对您的问题检查示例。](http://msdn.microsoft.com/en-us/library/799kze2z%28v=vs.90%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T04:53:47.863

谢谢你的回答！我发现了问题。我在外部依赖项中有两个相同的 list.h 文件，所以我只是删除了它并编译了它。我不知道它是怎么发生的，我想我的程序设置不正确。

# wordpress - Wordpress - 管理菜单 - 子子页面？

> ID：14532791
> 
> 赞同：2
> 
> 时间：2013-01-26T01:17:21.047
> 
> 标签：wordpress, oop, menu, admin, children

我已经在后端的管理菜单中添加了自定义菜单，而且我几乎总是有子页面，但是是否可以有第三级页面或“子子菜单页面”？

代码片段：

```
add_action('admin_menu',array(new mmr_menu((isset($_GET['page']) ? $_GET['page'] : "mmr")),'mk_menu'));

class mmr_menu{
    public function mk_menu(){

        add_menu_page('MMR', 'MMR', 'administrator', PLUGIN_PREFIX.'mmr', array(&$this,'get_page'), PLUGIN_DIR.'inc/images/logo.gif');

        add_submenu_page(PLUGIN_PREFIX.'mmr', PLUGIN_PREFIX.'app_and_reg', 'Applications & Registrations', 'administrator', PLUGIN_PREFIX.'app_and_reg', array(&$this,"get_page"));

        // Doesn't work
        add_submenu_page(PLUGIN_PREFIX.'app_and_reg', PLUGIN_PREFIX.'payment_reports', 'Payments', 'administrator', PLUGIN_PREFIX.'payment_reports', array(&$this,"get_page"));
    }
} 
```

`PLUGIN_PREFIX`并且`PLUGIN_DIR`是定义，并且`mmr_menu->get_page()`是我认为没有必要包含的公共方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:37:49.790

通常插件作者为第三级页面创建标签。这些没有注册为单独的页面，但您可以添加查询参数来选择页面，并以这种方式链接到不同的选项卡。例子：

```
<?php
function payment_reports() {

    // first, lets print out the tabs ?>
    <ul class="tabs">
         <a href="[sub-page url]&tab=first">Tab 1</a>
         <a href="[sub-page url]&tab=second">Tab 2</a>
         <a href="[sub-page url]&tab=third">Tab 3</a>
    </ul><?php

    switch ($_GET['tab']) {
        case 'second':
            output_first_tab();
            break;
        case 'third':
            output_first_tab();
            break;
        default:
            output_first_tab();
    }

}

?> 
```

话虽如此，一些 wordpress 框架（链接 piklist）支持内置的 3 级选项卡

# javascript - 使用 JavaScript 触发 CSS3 动画

> ID：14532792
> 
> 赞同：-2
> 
> 时间：2013-01-26T01:17:59.693
> 
> 标签：javascript, css

您好，我正在尝试弄清楚如何使用 javascript 触发 css3 动画，由于某种原因，我的代码无法正常工作......`我的 jfiddle 可以在这里看到[http://jsfiddle.net/sean3200/RE6K6/](http://jsfiddle.net/sean3200/RE6K6/)

**CSS：**

```
<style>
#div1
{
position: relative;
height: 150px;
width: 150px;
margin: 50px;
padding:10px;
border: 1px solid black;
perspective:150;
-webkit-perspective:150; /* Safari and Chrome */
}

#div2
{
padding:50px;
position: absolute;
border: 1px solid black;
background-color: red;
transform: rotateX(45deg);
-webkit-transform: rotateX(45deg); /* Safari and Chrome */
}
</style> 
```

**JavaScript：**

```
<script type="text/javascript">
function myBtn() {
    var btn = document.getElementById('div1').style.webkitPerspective=500;

}
</script> 
```

**HTML 元素：**

```
<button onclick="myBtn()">Move Me</button>
<div id="div1">HELLO</div>
<div id="div2">HELLO</div>
<div id="div3">HELLO</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:37:36.220

您需要嵌套 div 才能使透视工作：

```
<div id="div1">HELLO</div>
<div id="div2">HELLO</div> 
```

需要是：

```
<div id="div1">
    <div id="div2">HELLO</div>
</div> 
```

另外，在 head 中运行你的 js 而不是 onload 让你的小提琴确认你的点击事件：

[http://jsfiddle.net/RE6K6/2/](http://jsfiddle.net/RE6K6/2/)

# java - 函数计算不正确？

> ID：14532793
> 
> 赞同：0
> 
> 时间：2013-01-26T01:18:01.800
> 
> 标签：java

创建三个对象后，它应该从用户那里获取半径和高度，计算体积，然后再次询问下一个圆柱体。当我运行此代码时，它会提示我输入半径和高度，但它不会计算体积。我究竟做错了什么？

```
import javax.swing.JOptionPane;
import java.io.*;

public class CylinderTest 
{
public static void main(String[] args) throws IOException
{
    String input;
    String input2;
    double radius[] = new double[3];
    double height[] = new double[3];
    Cylinder[] myCylinder = new Cylinder[3];

        for (int i = 0; i < myCylinder.length; i++)
        {

             input = JOptionPane.showInputDialog("Enter a radius");
                radius[ i ] = Double.parseDouble(input);
                input2 = JOptionPane.showInputDialog("Enter a height" +
                        "");

                height[i] = Double.parseDouble(input2);

                myCylinder[i].height = input2;
                myCylinder[i].radius = input;

                JOptionPane.showMessageDialog(null, " The volume of the cylinder is: " + myCylinder.getVolume());       
            }

    }

static class Cylinder
{
private double radius;
private double height;

public  Cylinder(double radius, double height)
     {      this.radius = radius;
            this.height = height;

}

public double getVolume()
{

    return radius * radius * height * Math.PI;

}
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:24:51.233

您正在`static`为 Cylinder 类中的变量和方法使用关键字。我不确定你为什么使用`static`关键字，但暗示整个程序`static`只有*一个实例（即它是一个全局变量或函数）。*要修复它，请删除 Cylinder 类的方法和成员变量中的静态一词。您可能还想查看[Math.PI](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Math.html)而不是使用 3.1416 作为 PI。

另外，我想我会提到，您不需要将音量存储在变量中。相反，您可以简单地返回它。当然，除非您出于某种原因想将其缓存在变量中，但是看到您每次调用时都在重新计算它`getVolume()`，因此无需将卷存储在变量中。

IE

```
public double getVolume() // notice: no static keyword in the method's prototype
{
    return (radius * radius) * height * Math.PI;
} 
```

**专业提示：**不要在代码中使用幻数，使用变量来存储幻数。作为常量（最终）变量或常规变量。

例如

```
 static final int MEANING_OF_LIFE = 42; // this is somewhere tucked in a class or method
                                        // static is used because the final keyword
                                        // is used and therefore isn't modified
                                        // Meaning that there is no real point to have
                                        // multiple MEANING_OF_LIFE variables, hence static

 // ...

 System.out.printf("The meaning of life is: %i", MEANING_OF_LIFE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:24:35.347

你忘了

```
 myCylinder[i].height = input2;
 myCylinder[i].radius = input; 
```

加，

```
 JOptionPane.showMessageDialog(null, " The volume of the cylinder is: " + myCylinder.getVolume()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:24:36.813

`static`从 getVolume()中删除。从字段体积、高度中去除静电。
要计算，您必须创建一个圆柱体对象，并获取体积：

```
Cylinder cyl = new Cylinder(radius, height);
double volume = cyl.getVolume(); 
```

# android - Android：在吐司中看不到我的数据

> ID：14532797
> 
> 赞同：0
> 
> 时间：2013-01-26T01:18:13.170
> 
> 标签：android, arraylist, android-arrayadapter, toast

为什么我在 Toast 中看不到我的数据？每次我运行该应用程序时，它都会崩溃。但是，如果我删除 Toast 它运行顺利。

到目前为止，这是我的代码，我已经删除了所有不相关的代码

```
GoogleMaps Class.

    public class GoogleMaps extends MapActivity implements LocationListener {

    public void addLocation() {
        AlertDialog.Builder alert = new AlertDialog.Builder(this);
        final EditText input = new EditText(this);
        alert.setTitle("What do you want to call the location?");
        alert.setView(input);
        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {

                value = input.getText().toString().trim();
                checklocationTitle();
            }
        });

        alert.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        dialog.cancel();
                    }
                });
        alert.show();
    }

    public void checklocationTitle() {
        if (value.length() > 3) {
            Toast.makeText(this, "Name of the locations is know " + value,
                    Toast.LENGTH_LONG).show();
            try {
                markedpinpoint = true;
                midllat = touchedPoint.getLatitudeE6() / 1E6;
                midlongi = touchedPoint.getLongitudeE6() / 1E6;
                Geocoder geocoder = new Geocoder(getBaseContext(),
                        Locale.getDefault());
                List<Address> adress = geocoder.getFromLocation(
                        touchedPoint.getLatitudeE6() / 1E6,
                        touchedPoint.getLongitudeE6() / 1E6, 1);
                if (adress.size() > 0) {
                    String display = "";
                    for (int i = 0; i < adress.get(0).getMaxAddressLineIndex(); i++) {
                        display += adress.get(0).getAddressLine(i) + "\n";
                        OverlayItem overlayitem = new OverlayItem(touchedPoint,
                                value, display);
                        custom = new Location_Service(d, GoogleMaps.this);
                        custom.insertLocation(overlayitem);
                        overlayList.add(custom);
                    }
                } else {
                    Toast.makeText(
                            this,
                            "There where a problem to locate the selected adresse",
                            Toast.LENGTH_LONG).show();
                }
            } catch (IOException e) {
            }
        } else {
            Toast.makeText(this,
                    "Please provide a least 3 cifre Title for your location.",
                    Toast.LENGTH_LONG).show();
            addLocation();
        }
    }

    public void buttonLocations(View view) {
        // stopLocationListner();
        // stopBackgroundService();
        Intent intent = new Intent(this, PinPoints.class);
        startActivity(intent);
        // Toast.makeText(this, "Gemte steder: " + custom.size(),
        // Toast.LENGTH_LONG).show();

    }
}

    public class Location_Service extends ItemizedOverlay<OverlayItem> {

        public ArrayList<OverlayItem> pinpoints = new ArrayList<OverlayItem>();

        public Location_Service(Drawable defaultMarker) {
            super(boundCenter(defaultMarker));
            // TODO Auto-generated constructor stub
        }

        public ArrayList<Locations> getData() {
            Locations hej = new Locations();
            ArrayList<Locations> tt = new ArrayList<Locations>();
            for (OverlayItem test : pinpoints) {
                hej.setAdress(test.getSnippet());
                hej.setMidlat(test.getPoint().getLatitudeE6());
                hej.setMidlong(test.getPoint().getLongitudeE6());
                hej.setTitle(test.getTitle());
                tt.add(hej);
            }
            return tt;
        }

        public Location_Service(Drawable m, Context context) {
            this(m);
        }

        @Override
        protected OverlayItem createItem(int i) {
            return pinpoints.get(i);
        }

        @Override
        public int size() {
            return pinpoints.size();
        }

        public void insertLocation(OverlayItem item) {
            pinpoints.add(item);
            this.populate();
        }

    }

public class Locations {
    int midlat;
    int midlong;
    String title;
    String adress;
    String distance;

    public Locations(String title, String adress, String distance) {
        super();
        this.title = title;
        this.adress = adress;
        this.distance = distance;
    }

    public Locations() {

    }

    public int getMidlat() {
        return midlat;
    }

    public String getDistance() {
        return distance;
    }

    public void setDistance(String distance) {
        this.distance = distance;
    }

    public void setMidlat(int i) {
        this.midlat = i;
    }

    public int getMidlong() {
        return midlong;
    }

    public void setMidlong(int midlong) {
        this.midlong = midlong;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getAdress() {
        return adress;
    }

    public void setAdress(String adress) {
        this.adress = adress;
    }

    @Override
    public String toString() {
        // TODO Auto-generated method stub
        return title + adress + distance;
    }

} 
```

问题出现在 Toast 中...

```
public class PinPoints extends Activity

{

    private ListView lv;
    private LocationsAdapter adapter;
    private Location_Service locationss;
    private ArrayList<Locations> fetch = new ArrayList<Locations>();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.locations);

        Toast.makeText(this,
                "Places: " + locationss.getData(),
                Toast.LENGTH_LONG).show();

        for (int i = 0; i < 5; i++) {

            Locations t = new Locations("Home", "Edvard", "2200m");

            fetch.add(t);
        }

        lv = (ListView) findViewById(R.id.listView1);

        adapter = new LocationsAdapter(PinPoints.this, R.id.listView1, fetch);
        lv.setAdapter(adapter);

    }
} 
```

我的日志文件：

```
{com.example.test/com.example.test.PinPoints}: java.lang.NullPointerException
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2100)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.os.Looper.loop(Looper.java:137)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.ActivityThread.main(ActivityThread.java:4898)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at java.lang.reflect.Method.invokeNative(Native Method)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at java.lang.reflect.Method.invoke(Method.java:511)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at dalvik.system.NativeStart.main(Native Method)
01-26 02:27:17.900: E/AndroidRuntime(19389): Caused by: java.lang.NullPointerException
01-26 02:27:17.900: E/AndroidRuntime(19389):    at com.example.test.PinPoints.onCreate(PinPoints.java:31)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.Activity.performCreate(Activity.java:5206)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
01-26 02:27:17.900: E/AndroidRuntime(19389):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2064)
01-26 02:27:17.900: E/AndroidRuntime(19389):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:21:15.873

Locationss 没有在 onCreate 中初始化，所以你得到一个空指针异常。您应该在使用它之前对其进行初始化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:45:39.800

可能，您遇到了[调用填充不当的](https://stackoverflow.com/questions/3755921/problem-with-crash-with-itemizedoverlay)问题。**只是在填充任何数据之前，您应该在 ItemizedOverlay 中调用 populate()**的另一个问题的答案的摘录

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:22:29.847

没有看到崩溃转储有点猜谜游戏。我认为`locationss`是`null`当您尝试让数据显示在吐司中时。所以当你打电话时，`locationss.getData()`你会得到一个 NullReferenceException。**

# sql - 如何优化此查询（或有更好的方法）？

> ID：14532802
> 
> 赞同：5
> 
> 时间：2013-01-26T01:18:39.817
> 
> 标签：sql, postgresql, postgresql-9.2

我最近[问了一个问题](https://stackoverflow.com/questions/14527314/querying-multiple-tables-with-complex-relationships)，有人为我提供了一个可行的解决方案，但我忘了提到我的表有数百万行（项目表约 1000 万行，其他表约 100 万行），也许他们认为我在工作使用我提供的示例中的小数据集。

这是SQL：

```
WITH a AS (
  SELECT item.id, string_agg(prefered_store.store::varchar, ',') wishlist_stores
  FROM item, list_wishlist, wishlist, prefered_store
  WHERE item.list=list_wishlist.list
    AND list_wishlist.wishlist=wishlist.id
    AND wishlist.prefered_stores=prefered_store.id
  GROUP BY item.id
), b AS (
  SELECT item.id, 
    string_agg(
      prefered_store.store::varchar || ',' || prefered_store.comment,
      ' ; ') item_stores_comments
    FROM item, prefered_store
    WHERE item.prefered_stores=prefered_store.id
    GROUP BY item.id
)
SELECT a.id,item_stores_comments,wishlist_stores 
FROM a,b
WHERE a.id=b.id 
```

虽然它完全符合我的需要，但速度非常慢。大约需要 10 分钟，仅限 1 行，10 行大约需要 15 分钟。我还在等着看一千行需要多长时间（已经差不多一个小时了）。现在我的台式机不是最快的：Pentium 4 with 1.5GB ram，但感觉还是不太对劲。

我已经索引了 WHERE 子句中的所有字段，并在需要的地方创建了主键。除此之外还有什么方法可以让这个查询运行得更快吗？

PostgreSQL 9.2

DDL：[https ://docs.google.com/file/d/0BwiyuwRCaqkCM09LVkJ4YlVNLWM/edit](https://docs.google.com/file/d/0BwiyuwRCaqkCM09LVkJ4YlVNLWM/edit)

仅包含相关表和字段的简单图表： ![在此处输入图像描述](../Images/b7f3f9e680231ec90ef540653d485cc9.png)

解释分析：

```
Merge Join  (cost=23342752.95..12971604557.95 rows=863210883998 width=68) (actual time=1182616.544..1251542.167 rows=13139337 loops=1)
  Merge Cond: (a.id = b.id)
  CTE a
    ->  GroupAggregate  (cost=8477658.65..8992463.86 rows=13139337 width=8) (actual time=252170.500..307061.559 rows=13139337 loops=1)
          ->  Sort  (cost=8477658.65..8547771.35 rows=28045080 width=8) (actual time=252170.391..282495.516 rows=14870222 loops=1)
                Sort Key: public.item.id
                Sort Method: external merge  Disk: 261528kB
                ->  Merge Join  (cost=3010452.34..3474579.76 rows=28045080 width=8) (actual time=138444.102..210768.838 rows=14870222 loops=1)
                      Merge Cond: (list_wishlist.list = public.item.list)
                      ->  Sort  (cost=689954.53..695268.01 rows=2125390 width=8) (actual time=30482.447..55193.049 rows=1286901 loops=1)
                            Sort Key: list_wishlist.list
                            Sort Method: external merge  Disk: 22624kB
                            ->  Hash Join  (cost=66643.55..408462.52 rows=2125390 width=8) (actual time=10417.244..26147.517 rows=1286901 loops=1)
                                  Hash Cond: (wishlist.prefered_stores = public.prefered_store.id)
                                  ->  Hash Join  (cost=38565.70..96225.43 rows=1226863 width=8) (actual time=8188.097..19815.024 rows=1226863 loops=1)
                                        Hash Cond: (list_wishlist.wishlist = wishlist.id)
                                        ->  Seq Scan on list_wishlist  (cost=0.00..22266.63 rows=1226863 width=8) (actual time=12.786..7467.442 rows=1226863 loops=1)
                                        ->  Hash  (cost=20352.20..20352.20 rows=1110120 width=8) (actual time=7314.531..7314.531 rows=1110087 loops=1)
                                              Buckets: 4096  Batches: 64  Memory Usage: 689kB
                                              ->  Seq Scan on wishlist  (cost=0.00..20352.20 rows=1110120 width=8) (actual time=7.621..6572.731 rows=1110087 loops=1)
                                  ->  Hash  (cost=14027.49..14027.49 rows=856349 width=8) (actual time=2159.339..2159.339 rows=856349 loops=1)
                                        Buckets: 4096  Batches: 64  Memory Usage: 536kB
                                        ->  Seq Scan on prefered_store  (cost=0.00..14027.49 rows=856349 width=8) (actual time=0.071..1602.971 rows=856349 loops=1)
                      ->  Materialize  (cost=2320484.45..2386181.13 rows=13139337 width=8) (actual time=107961.603..149020.809 rows=14870219 loops=1)
                            ->  Sort  (cost=2320484.45..2353332.79 rows=13139337 width=8) (actual time=107961.575..145971.848 rows=13139337 loops=1)
                                  Sort Key: public.item.list
                                  Sort Method: external merge  Disk: 231088kB
                                  ->  Seq Scan on item  (cost=0.00..228006.37 rows=13139337 width=8) (actual time=27.636..47661.750 rows=13139337 loops=1)
  CTE b
    ->  GroupAggregate  (cost=7166704.38..7843349.46 rows=13139337 width=12) (actual time=524258.000..794537.585 rows=13139337 loops=1)
          ->  Sort  (cost=7166704.38..7223638.09 rows=22773483 width=12) (actual time=524257.908..755765.703 rows=13858612 loops=1)
                Sort Key: public.item.id
                Sort Method: external merge  Disk: 297912kB
                ->  Merge Join  (cost=2448353.26..2826901.79 rows=22773483 width=12) (actual time=201205.036..425873.108 rows=13858612 loops=1)
                      Merge Cond: (public.prefered_store.id = public.item.prefered_stores)
                      ->  Sort  (cost=127685.43..129826.31 rows=856349 width=12) (actual time=4545.447..12507.054 rows=856346 loops=1)
                            Sort Key: public.prefered_store.id
                            Sort Method: external merge  Disk: 18408kB
                            ->  Seq Scan on prefered_store  (cost=0.00..14027.49 rows=856349 width=12) (actual time=0.060..2707.353 rows=856349 loops=1)
                      ->  Materialize  (cost=2320484.45..2386181.13 rows=13139337 width=8) (actual time=196659.554..406944.706 rows=13858611 loops=1)
                            ->  Sort  (cost=2320484.45..2353332.79 rows=13139337 width=8) (actual time=196659.535..396917.629 rows=13139337 loops=1)
                                  Sort Key: public.item.prefered_stores
                                  Sort Method: external merge  Disk: 231096kB
                                  ->  Seq Scan on item  (cost=0.00..228006.37 rows=13139337 width=8) (actual time=0.032..54885.583 rows=13139337 loops=1)
  ->  Sort  (cost=3253469.82..3286318.16 rows=13139337 width=36) (actual time=344329.838..353118.692 rows=13139337 loops=1)
        Sort Key: a.id
        Sort Method: external sort  Disk: 259792kB
        ->  CTE Scan on a  (cost=0.00..262786.74 rows=13139337 width=36) (actual time=252170.512..320132.738 rows=13139337 loops=1)
  ->  Materialize  (cost=3253469.82..3319166.50 rows=13139337 width=36) (actual time=838286.670..888495.578 rows=13139337 loops=1)
        ->  Sort  (cost=3253469.82..3286318.16 rows=13139337 width=36) (actual time=838286.652..886198.912 rows=13139337 loops=1)
              Sort Key: b.id
              Sort Method: external sort  Disk: 385320kB
              ->  CTE Scan on b  (cost=0.00..262786.74 rows=13139337 width=36) (actual time=524258.017..811717.462 rows=13139337 loops=1)
Total runtime: 1253101.865 ms 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T22:19:10.873

看，在 PostgreSQL中， [CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)充当了优化栅栏。因此，无论您将哪个谓词添加到查询的外部，PostgreSQL*都会* 执行`WITH()`子句的完整遍历。因此，要进行优化，您需要摆脱 CTE。

这并不容易，因为您`prefered_store`的表是非规范化的。

请尝试此查询（也在[SQL Fiddle](http://sqlfiddle.com/#!12/6c770/1)上）：

```
SELECT i.id item,
    (SELECT string_agg(store||','||comment, ';')
       FROM prefered_store WHERE id=i.prefered_stores) item_stores_comments,
    string_agg(ps.store::text, ',') whishlist_stores
  FROM item i
  JOIN list_wishlist lw ON lw.list=i.list
  JOIN wishlist w ON w.id=lw.wishlist
  JOIN prefered_store ps ON ps.id=w.prefered_stores
 GROUP BY i.id; 
```

但我会建议审查架构设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T02:12:04.810

在 SQL 中构建逗号分隔值的列*几乎*总是错误的方法。最好返回数据行，让应用程序代码处理显示格式。

通过消除 string_agg() 函数和 GROUP BY 子句进行测试。

```
with a as (
  select item.id, 
         prefered_store.store wishlist_stores
  from item
  inner join list_wishlist on item.list=list_wishlist.list
  inner join wishlist on list_wishlist.wishlist=wishlist.id
  inner join prefered_store on wishlist.prefered_stores=prefered_store.id
), b as (
  select item.id, 
         prefered_store.store,
         prefered_store.comment item_stores_comments
    from item
    inner join prefered_store on item.prefered_stores=prefered_store.id
)
select * from a
inner join b on a.id = b.id 
```

您发布的 SQL Fiddle 没有多大用处。它没有主键，没有二级索引，也没有足够的行来避免顺序扫描。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:34:25.970

因为你使用的是“with”？
为什么不使用“联合”？
如果没有“ForeignKey”空表，您可以使用“LEFT JOIN”，但这是一个快速比较。

如果您发布图表，我可以重做 SQL：D

# python - Python导入范围问题

> ID：14532804
> 
> 赞同：1
> 
> 时间：2013-01-26T01:18:47.663
> 
> 标签：python

我正在尝试为一些 python 构建脚本做一些脚本重用。我的“可重用”部分的缩写版本如下所示（_build.py）：

```
Sources = []
Sources += glob('*.c')
Sources += glob('../FreeRTOS/*.c')
...
def addSources(directory, *rest):
  for each in rest:
    Sources += ['../'+directory+'/'+each+'.c']

def addSharedSources(*args):
  addSources('Shared', *args) 
```

然后在自定义部分，我有类似（build.py）的东西：

```
#!/usr/bin/env python
from _build import *
...
#Additional source files from ../Shared, FreeRTOS and *.c are already in
addSharedSources('ccpwrite', 'discovery', 'radioToo', 'telemetry', 'utility') 
```

不幸的是，当我尝试运行 build.py 时，我得到一个如下所示的回溯：

```
Traceback (most recent call last):
File "./build.py", line 8, in <module>
 addSharedSources('ccpwrite', 'discovery', 'radioToo', 'telemetry', 'utility')
File "/Users/travisg/Projects/treetoo/Twig/_build.py", line 49, in addSharedSources
 addSources('Shared', *args)
File "/Users/travisg/Projects/treetoo/Twig/_build.py", line 46, in addSources
 Sources += ['../'+directory+'/'+each+'.c']
UnboundLocalError: local variable 'Sources' referenced before assignment 
```

因此，即使我进行了通配符导入，在调用导入函数时，它似乎并没有引用我从原始导入的“全局”变量。有没有办法让它工作？我玩弄了`global`，但这似乎并没有达到我想要的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:31:18.760

这与导入无关。如果你`_build.py`直接运行，你会遇到同样的问题。问题是该函数`addSources`正在修改全局`Sources`而不将其声明为全局。在函数中插入`global`声明`addSources`，一切都应该很好。

说明：这种代码很容易被误写。所以python允许你*读取*一个全局变量而不声明它是全局的，但不能修改它。

# c++ - 链接器错误 /usr/bin/ld: 找不到 -lbz2-gcc

> ID：14532806
> 
> 赞同：0
> 
> 时间：2013-01-26T01:18:58.183
> 
> 标签：c++, compilation, linker

我有一个未知的链接器错误。我不确定我需要安装什么。

/usr/bin/ld: 找不到 -lbz2-gcc

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:21:05.577

检查您的 Makefile 是否缺少空格。看起来您正在传递选项：

```
-lbz2-gcc 
```

到链接器，当您最有可能想要传递两个选项时：

```
-lbz2 -gcc 
```

分别地。

这可能是变量扩展出错的结果，请尝试跟踪链接器命令的来源，并向我们展示它尝试运行的完整链接器命令以及您的 Makefile（如果这没有帮助）。

# php - 更改图像颜色 PHP 或 CSS

> ID：14532810
> 
> 赞同：1
> 
> 时间：2013-01-26T01:19:20.150
> 
> 标签：php, css, image, imagemagick

我有一个非常奇怪的要求，我有一个图像（图像有轻微的渐变效果），其中中心部分需要显示颜色变化，用户得分颜色为高分 255,255,0，低分为 155,155,55

现在我想知道我应该用哪种方式来做，我用 HTML5 Canvas 尝试过，但它不适用于 IE，所以我放弃了这个选项

我不知道它是否可以用css完成

或者使用 PHP 的 GD 库

这是图片 [http://i47.tinypic.com/b88l13.png](http://i47.tinypic.com/b88l13.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:51:57.527

我使用[Processing.js](http://processingjs.org)库开发了几个项目，我爱上了它。[如果您愿意，可以尝试一下，您可以使用http://processingjs.org/reference/tint_/](http://processingjs.org/reference/tint_/)在几行中完成您所要求的操作 。

```
PImage b; 
b = loadImage("http://i47.tinypic.com/b88l13.png");

void setup(){
  size(200,200);
}

void draw(){  
   tint(255, 0, 0); 
   image(b, 0, 0);   
} 
```

您可能希望将彩色（金字塔）部分从背景中分离出来，并且只为该部分着色。

请注意，在演示中，我使用了该图像的 Base64 版本来避免跨域策略问题。演示：http: [//jsfiddle.net/CrUja/](http://jsfiddle.net/CrUja/)

[它适用于 IE9，我认为您可以使用http://code.google.com/p/explorercanvas/](http://code.google.com/p/explorercanvas/)使其在 IE8 中运行（或者也许 Processing.js 已经集成了这个）

# uiwebview - 从 UIWebView 中提取内容

> ID：14532815
> 
> 赞同：0
> 
> 时间：2013-01-26T01:20:45.797
> 
> 标签：uiwebview, uitextview, extract, article

我有一个 RSS 提要，可以从某些网站加载文章。我希望文章中的文本显示在 TextView 中。这不是文章中的广告，所以我只能得到文字。任何人都知道我该怎么做？

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T05:44:23.050

您不需要使用 a`UIWebView`从 URL 中读取。

为什么不直接打开到 URL 的连接并下载文本呢？您可以在将原始数据放入 TextView 之前对其进行解析/过滤/等处理。

有关如何执行此操作的示例，请参阅这些其他 SO 问题：

*   [从 URL 读取 XML 的简单方法 - iPhone](https://stackoverflow.com/questions/2797996/simple-method-to-read-xml-from-a-url-iphone)
*   [如何使用objective-c和xcode从网站读取文件](https://stackoverflow.com/questions/4531514/how-to-read-a-file-from-a-website-using-objective-c-xcode)

# android - 在非活动类上存储数据

> ID：14532818
> 
> 赞同：1
> 
> 时间：2013-01-26T01:21:09.383
> 
> 标签：android

我想确定这是否是不好的做法，因为我已经在某些地方实现了这一点。

我有两个活动，MainActivity 和 SecondActivity。

如果我想将字符串“Hello”从 Main 传输到 Second，我使用了一个名为 Transfer 的类。在这个类中，我有一个静态字符串，我设置为“Hello”，我从 SecondActivity 的 onResume 方法访问它。

android如何管理“Transfer”类？它是否与 MainActivity 绑定并随之销毁？还有其他我应该注意的行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:25:30.060

鉴于 String 字段是静态的，我会说它仅限于整个过程，而不是 MainActivity。

问题是，android 操作系统可能会释放您应用程序的资源来启动另一个进程。可能发生的情况是您的应用程序被后台处理，操作系统需要它的资源并释放内存，然后用户返回到 SecondActivity。该过程被重新创建，并且先前初始化的静态字段现在为空。

如果您需要在活动之间传递字符串，我会将它们捆绑到意图的附加内容中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:31:57.310

只要应用程序在内存中，静态成员就存在。

这种方法效果很好。在两个活动之间共享数据的另一种方法是利用[`putExtra`](http://developer.android.com/reference/android/content/Intent.html#putExtra%28java.lang.String,%20android.os.Bundle%29)将数据放入第二个活动并[`getExtras`](http://developer.android.com/reference/android/content/Intent.html#getExtras%28%29)获取数据。

# r - 添加文本注释时，为什么 ggplot2 会重复（未分面）我的数据？

> ID：14532819
> 
> 赞同：1
> 
> 时间：2013-01-26T01:21:15.400
> 
> 标签：r, ggplot2

好吧，这让我很难过。我有这个功能：

```
tf <- function(formula = NULL, data = NULL) {
res <- as.character(formula[[2]])
fac2 <- as.character(formula[[3]][3])
fac1 <- as.character(formula[[3]][2])

# Aesthetic & Data 1
p <- ggplot(aes_string(x = fac1, y = res, color = fac1), data = data) +
    facet_grid(paste(".~", fac2)) + geom_point() # OK if we only go this far

facCounts <- count(data, vars = c(fac2, fac1))
facCounts$label <- paste("n = ", facCounts$freq , sep = "")
facCounts$y <- min(data$res) - 0.1*diff(range(data$res))
facCounts <- facCounts[,-3]
names(facCounts) <- c("f2", "f1", "lab", "y") # data frame looks correct

# Aesthetic & Data 2
p <- p + geom_text(aes(x = f1, y = y, label = lab),
        color = "black", size = 4.0, data = facCounts) + facet_grid(".~f2")
p
} 
```

使用此数据运行并调用时：

```
set.seed(1234)
mydf <- data.frame(
    resp = rnorm(40),
    cat1 = sample(LETTERS[1:3], 40, replace = TRUE),
    cat2 = sample(letters[1:2], 40, replace = TRUE))

p <- tf(formula = resp~cat1*cat2, data = mydf); print(p) 
```

产生这张图片：

![在此处输入图像描述](../Images/0225d0b176c214a1dab9b8d331d082c2.png)

如果你仔细看，你会发现这两个方面的数据实际上是相同的。*对于应该*显示（并存储在 中）的数据，计数是正确的`facCounts`。如果调用 to`geom_text`被注释掉，那么情节是正确的。对呼叫的各种更改`geom_text`让我看到您在上面看到的内容，或者存在正确的数据但计数文本重叠。我找不到走出这个迷宫的路！尝试`+ annotate("text", ...)`也不起作用。需要进行哪些更改才能保持数据的多面性和正确的计数？谢谢。这是 ggplot 0.9.3 顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T02:05:06.613

现在我已经说服自己这会奏效：

```
tf <- function(formula = NULL, data = NULL) {
  res <- as.character(formula[[2]])
  fac2 <- as.character(formula[[3]][3])
  fac1 <- as.character(formula[[3]][2])

  # Aesthetic & Data 1
  p <- ggplot(aes_string(x = fac1, y = res, color = fac1), data = data) +
    facet_grid(paste(".~", fac2)) + geom_point() # OK if we only go this far

  facCounts <- count(data, vars = c(fac2, fac1))
  facCounts$label <- paste("n = ", facCounts$freq , sep = "")
  facCounts$y <- min(data$res) - 0.1*diff(range(data$res))
  facCounts <- facCounts[,-3]
  names(facCounts) <- c("cat2", "f1", "lab", "y") # data frame looks correct

  # Aesthetic & Data 2
  p <- p + geom_text(aes(x = f1, y = y, label = lab),
                     color = "black", size = 4.0, data = facCounts)
  p
} 
```

`facet_grid`您使用不同名称的构面变量第二次调用。删除第二个调用并重命名`f2`为 `cat2 似乎有效。

# html - 在css错误中居中div还是我做错了？

> ID：14532826
> 
> 赞同：0
> 
> 时间：2013-01-26T01:22:10.723
> 
> 标签：html, css, twitter-bootstrap

所以我已经阅读了所有的教程，我发现的所有教程都告诉我做同样的基本事情。但是，当我执行此代码时，我正在使用：

```
.center{
width: 50%;
margin: 0px auto;
} 
```

它需要我拥有的六个项目并将它们居中，但不会将 3 放在一条线上（我正在使用带有 6 个 span3 div 的引导程序，应该是 3 和 3）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:32:26.303

```
 .center{   
     position: relative; /*add this */
     float: /*left, right, both; use what you want*/
     width: 50%;
     margin: 0px auto;
 } 
```

到你的 .center 班级

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:34:24.003

在引导程序中，您需要遵循以下模式：

```
<div class="center">
    <div class="row">
         <div class="span3 offset2"></span>
         <div class="span3"></span>
         <div class="span3"></span>
    </div>
    <div class="row">
         <div class="span3 offset2"></span>
         <div class="span3"></span>
         <div class="span3"></span>
    </div>
</div> 
```

您是否要使 3 个跨度居中？

# ruby-on-rails - 您的 Gemfile 中存在错误，并且 Bundler 无法继续

> ID：14532828
> 
> 赞同：0
> 
> 时间：2013-01-26T01:22:22.023
> 
> 标签：ruby-on-rails, file, gem, bundle

因此，我正在关注 Michael Hartl 的 Rails 教程，并将我的 Gemfile 更改为如下所示：（仅在运行 Bundle install 后得到“您的 Gemfile 中有错误，并且 Bundler 无法继续。”）。有任何想法吗？谢谢

```
来源“https://rubygems.org”

宝石'导轨'，'3.2.8'

# 捆绑边缘 Rails：
# gem 'rails', :git => 'git://github.com/rails/rails.git'

#gem 'sqlite3'
组：开发做
宝石'sqlite3'，'1.3.5'

# 宝石仅用于资产，不是必需的
# 默认在生产环境中。
组：资产做
  gem 'sass-rails', '~> 3.2.4'
  宝石'咖啡轨'，'〜> 3.2.2'

  # 有关更多支持的运行时，请参阅 https://github.com/sstephenson/execjs#readme
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.2.3'
结尾

宝石'jquery-rails'，'2.0.0'

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:25:29.360

你错过了一个结束：

```
#gem 'sqlite3'
组：开发做
宝石'sqlite3'，'1.3.5'

```

# embedded - 使用 PIC18 作为 SPI 从设备的问题

> ID：14532829
> 
> 赞同：1
> 
> 时间：2013-01-26T01:22:27.263
> 
> 标签：embedded, pic

我一直在研究以 16 MHz 运行的 PIC18F45k20，并将其用作 SPI 从设备。我发现无论来自主机的 SPI 时钟速率 (SCK) 如何，我总是必须在 SPI 字节之间添加一个显着的延迟（~64 us）以避免 SPI 冲突或接收溢出。在没有延迟和非常慢的 SPI 时钟速率的情况下，95% 的 SPI 数据包将在没有冲突或溢出的情况下通过。

在线帖子让我认为这可能是该处理器和其他 PIC18 处理器的“功能”。

1.  其他人是否观察到了同样的奴隶“特征”？
2.  如果这是一个“特性”，它是否存在于所有 PIC18 处理器中？

我在没有中断的情况下测试了 PIC18：

```
if (SSPSTATbits.BF)
{
  DataIn = SSPBUF;
  SSPBUF = DataOut;
} 
```

还使用中断进行了测试，并看到了同样的挑战。

让我想知道它是否不能真正正确地检测到 SPI 时钟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T13:15:45.017

如果您有示波器检查以确保在 PIC 输出最后一个 SPI 数据字节之前没有释放片选。在释放片选线之前，您需要等待 SPI 忙位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-10T04:40:37.620

据我所知，PIC18 是一个 8 位微控制器，尽管您可以很容易地发现它的整数变量被映射到 16 位。但是 SPI 适用于 8 位数据。这意味着如果您的主控发送此微控制器超过 8 位，例如 16 位，则 SPI 模块会发生溢出，并且无法再响应主控时钟。所以在从机模式下，请确保来自主机的数据具有 8 位结构。但是如果 pic18 在 SPI 连接中是 Master，即使它的 slave 发送 16bit 数据，pic18 在第一个 8bit 之后保持时钟数据，并等待它的缓冲区读取并为下一个 8bit 清空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-23T18:21:19.697

我也遇到过这个问题，似乎应该考虑的是，受支持的 SPI 简单告诉 MCU 可以多快将*一个*字节接收到 SSPBUF。

从 SSPBUF 读取此字节并将其存储在缓冲区中将需要一些工作，例如递增指针等，这将需要一些时间。这就是减少多字节 SPI 的实际 SPI 带宽的原因。

# git - 安装 Aptana 3 后找不到 Git

> ID：14532834
> 
> 赞同：0
> 
> 时间：2013-01-26T01:22:53.710
> 
> 标签：git, aptana, aptana3

我一直在我的 Mac（Mountain Lion）上运行 git 就好了，但是在安装 Aptana Studio 3 之后，当我现在尝试从命令行运行它时，我得到“git：command not found”。所有文件都在 /usr/local/bin/git 下，我已经更新了 .profile 中的 PATH 以添加 /usr/local（/usr/local/bin 也在那里），但我仍然收到错误当我尝试从命令行运行 git 时。为什么要安装 Aptana 软管我的 git 安装，我怎样才能让它再次工作？我知道 Aptana 在内部依赖 git，但它不应该使用已经存在的东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:38:24.483

[http://www.hongkiat.com/blog/mountain-lion-git-fix/](http://www.hongkiat.com/blog/mountain-lion-git-fix/)

从 App Store 下载并安装 XCODE（免费）。然后在 XCODE 中安装命令行工具。

这将解决您的问题。

或者你可以试试这个：

1.  打开你的 ~/.bash_profile，如果你使用 textmate，它会是： $ sudo mate ~/.bash_profile 或者如果你使用 pico（内置在 OS X 中）你会输入 $ sudo pico ~/.bash_profile

2.  将此行添加到文件中：export PATH=$PATH:/usr/local/git/bin/

3.  保存并关闭文件并在终端上输入： $ source ~/.bash_profile

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:08:09.013

我实际上已经安装了 XCode，所以我只是从[http://git-scm.com/download/mac](http://git-scm.com/download/mac)重新下载了 git 安装程序，重新安装，它又可以工作了。

# delphi - 调试设计时包时启动 Delphi 时出错

> ID：14532835
> 
> 赞同：5
> 
> 时间：2013-01-26T01:22:54.343
> 
> 标签：delphi, debugging, package, delphi-2010

我在启动 Delphi 2010 的第二个实例以调试设计时包时遇到了问题。在 Project Options|Debugger 下，我使用“C:\Program Files\Embarcadero\RAD Studio\7.0\bin\bds.exe”作为主机应用程序，并带有以下参数：“-pDelphi -nocache”

运行包时收到以下错误消息：

![在此处输入图像描述](../Images/349597bf25b6ff19f0238cbfa261df7c.png)

如果我继续，我会得到以下信息：

![在此处输入图像描述](../Images/ed58da31b658481553db6a84324d4281.png)

然后，如果我继续，我会得到以下信息：

![在此处输入图像描述](../Images/54c17d9d97406871e545b21b14f31c1d.png)

我究竟做错了什么？这以前一直有效。（我已经修复并卸载/重新安装了 Delphi 2010。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-26T09:42:11.993

您安装了 DDevExtensions 的调试版本。此版本验证其 GetProcAddress 调用以在附加调试器时显示缺失的符号。DDevExtensions 尝试挂接到 bcbide140.bpl (C++Builder)，但找不到符号，因为 BPL 未加载 ( `bds -pDelphi`)。它应该跳过挂接，但由于调试构建和附加的调试器，它会运行到断言。

调试构建的原因在于 DDevExtensions 的构建脚本：`msbuild /p:Configuration=Release`而不是`msbuild /p:Config=Release`. （所以感谢“报告”这个，所以我可以修复构建脚本）。

# java - Maven：生成整个项目的WAR，以及特定包的JAR

> ID：14532838
> 
> 赞同：3
> 
> 时间：2013-01-26T01:23:09.780
> 
> 标签：java, maven

我使用模型-视图-控制器模式开发了一个 webapp。该`model`包代表应用程序的核心 API，可以独立使用。和包使用包`controller`来生成一个webapp。`view``model`

**问题：** 我希望能够只构建一个`model`包的 JAR，以及三个包的 WAR。而且我想将这三个包保存在同一个项目中。与独立 JAR 相比，webapp WAR 将包括补充库。我怎么能用 Maven 实现这一点？会有使用例如两个单独的 pom.xml 文件的解决方案吗？（因为据我所知，您不能`packaging`在 pom.xml 中选择两个选项）

（我见过[这个问题](https://stackoverflow.com/questions/12576767/how-to-create-a-jar-from-part-of-my-project-that-is-packaged-as-a-war)，但我真的希望我的三个包属于同一个项目，并且属于同一个目录。）

另外，我的项目使用了经典的 webapp 结构（这里简化了）：

```
my-app
-- pom.xml
-- src
----- main/
-------- java/
----------- model/
----------- view/
----------- controller/
-------- webapp/
---------- WEB-INF/
-------------classes/ 
```

我可以设法在经典目录中生成 JAR，在经典`target/`目录中生成 webapp`src/main/webapp/`吗？（并且，根据要求，包括不同的图书馆）

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:27:09.760

看看[Maven 程序集插件](http://maven.apache.org/plugins/maven-assembly-plugin/)。

有了它，您可以根据需要拥有尽可能多的不同*程序集描述符*，每一个都使用自己的*打包方案*、*文件集*和*依赖*项进行定制。

* * *

这是您的**pom.xml**的示例插件配置：

```
<build>
  <plugins>
     <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-assembly-plugin</artifactId>
        <version>2.4</version>
        <configuration>
            <descriptors>
               <descriptor>src/main/assembly/model.xml</descriptor>
            </descriptors>
        </configuration>
     </plugin>
  </plugins>
</build> 
```

**以及模型**jar ( `src/main/assembly/model.xml`)的示例程序集描述符

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">
  <id>model</id>
  <formats>
    <format>jar</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>
  <fileSets>
    <fileSet>
      <directory>${project.build.outputDirectory}/model</directory>
      <outputDirectory>/</outputDirectory>
      <includes>
        <include>**/*</include>
      </includes>
    </fileSet>
  </fileSets>
</assembly> 
```

运行将从您的项目**pom.xml**和目标包中的**my-app-model.jar**`mvn clean package assembly:single`生成标准**my-app.war文件。**

 ***** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T05:58:14.193

我认为您会更喜欢“war”作为项目的默认打包，更简单的方法是使用 maven-jar-plugin：

```
 <plugin>
           <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-jar-plugin</artifactId>
           <version>2.4</version>
           <executions>
               <execution>
                   <phase>package</phase>
                   <goals>
                       <goal>jar</goal>
                   </goals>
                   <configuration>
                       <classifier>weibo4j</classifier>
                       <includes>
                           <include>model/**</include>
                       </includes>
                   </configuration>
               </execution>
           </executions>
       </plugin> 
```****

# ruby - Ruby：对象/类数组

> ID：14532844
> 
> 赞同：14
> 
> 时间：2013-01-26T01:24:03.060
> 
> 标签：ruby, arrays, object

我不是红宝石专家，这给我带来了麻烦。但是我将如何在 ruby​​ 中创建一组对象/类？如何初始化/声明它？在此先感谢您的帮助。

这是我的课，我想创建一个数组：

```
class DVD
  attr_accessor :title, :category, :runTime, :year, :price

  def initialize()
    @title = title
    @category = category
    @runTime = runTime
    @year = year
    @price = price
  end
end 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-26T01:29:14.287

Ruby 是鸭子类型（动态类型），几乎所有东西都是对象，所以你可以将任何对象添加到数组中。例如：

```
[DVD.new, DVD.new] 
```

将创建一个包含 2 张 DVD 的阵列。

```
a = []
a << DVD.new 
```

会将 DVD 添加到阵列中。检查[Ruby API 以获取数组函数的完整列表](http://www.ruby-doc.org/core-1.9.3/Array.html)。

顺便说一句，如果您想保留 DVD 类中所有 DVD 实例的列表，您可以使用类变量来执行此操作，并在创建新 DVD 对象时将其添加到该数组中。

```
class DVD
  @@array = Array.new
  attr_accessor :title, :category, :runTime, :year, :price 

  def self.all_instances
    @@array
  end

  def initialize()
    @title = title
    @category = category
    @runTime = runTime
    @year = year
    @price = price
    @@array << self
  end
end 
```

现在如果你这样做

```
DVD.new 
```

您可以获得迄今为止创建的所有 DVD 的列表：

```
DVD.all_instances 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-11-10T14:40:48.577

`two_DVD = Array.new(2){DVD.new}`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-26T11:21:02.983

为了在 Ruby 中创建对象数组：

1.  创建数组并将其绑定到名称：

    ```
    array = [] 
    ```

2.  将您的对象添加到其中：

    ```
    array << DVD.new << DVD.new 
    ```

您可以随时将任何对象添加到数组中。

如果您希望访问`DVD`该类的每个实例，那么您可以依赖[`ObjectSpace`](http://www.ruby-doc.org/core-1.9.3/ObjectSpace.html)：

```
class << DVD
  def all
    ObjectSpace.each_object(self).entries
  end
end

dvds = DVD.all 
```

* * *

顺便说一句，实例变量没有被正确初始化。

以下方法调用：

```
attr_accessor :title, :category, :run_time, :year, :price 
```

自动创建`attribute`/`attribute=`实例方法来获取和设置实例变量的值。

定义的`initialize`方法：

```
def initialize
  @title = title
  @category = category
  @run_time = run_time
  @year = year
  @price = price
end 
```

设置实例变量，尽管没有参数。实际发生的是：

1.  读取器`attribute`方法称为
2.  它读取未设置的变量
3.  它返回`nil`
4.  `nil`成为变量的值

您要做的是将变量的值传递给`initialize`方法：

```
def initialize(title, category, run_time, year, price)
  # local variables shadow the reader methods

  @title = title
  @category = category
  @run_time = run_time
  @year = year
  @price = price
end

DVD.new 'Title', :action, 90, 2006, 19.99 
```

此外，如果唯一需要的属性是`DVD`'s 标题，那么您可以这样做：

```
def initialize(title, attributes = {})
  @title = title

  @category = attributes[:category]
  @run_time = attributes[:run_time]
  @year = attributes[:year]
  @price = attributes[:price]
end

DVD.new 'Second'
DVD.new 'Third', price: 29.99, year: 2011 
```

# c# - 可以使用接口在 Entity Framework Codefirst 中创建我的模型吗？

> ID：14532853
> 
> 赞同：4
> 
> 时间：2013-01-26T01:25:08.610
> 
> 标签：c#, entity-framework

我是 Entity Framework 的新手，我正在练习 CodeFirst。我的问题是我正在创建一个模型类，我希望该类继承自其他两个类。例如，员工有个人信息，如名字、中间名、姓氏等......它还有联系信息，如地址、电话、电子邮件等......学生也有这些属性. 我之所以将这些信息分为两个不同的类别是因为另一个实体也可以有联系信息但没有个人信息，例如公司，学校，医院，仓库等......

示例代码：

```
public class ContactInfo
{
    public string Address { get; set; }
    public string Email { get; set; }
    public string Phone { get; set; }
} 
```

```
public class PersonalInfo
{
    public string Firstname { get; set; }
    public string Middlename { get; set; }
    public string Lastname { get; set; }
} 
```

```
public class Employee : // This should be inheriting from PersonalInfo and ContactInfo
{
    public int EmployeeID { get; set; }
} 
```

```
public class Supplier : ContactInfo // Inheriting from ContactInfo and no PersonalInfo
{
    public int SupplierID { get; set; }
    public string Name { get; set; }
} 
```

我想要做的是创建接口 (IPersonalInfo,IContactInfo) 以由 Employee 继承，使其看起来像这样：

```
public class Employee : IPersonalInfo,IContactInfo
{
    public int EmployeeID { get; set; }
} 
```

这是一个好习惯吗？如果没有，我该如何应对这种情况？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-26T06:13:47.473

首先，听起来您混淆了继承和组合。继承的一个示例是拥有一个通用的 Person 基类，您可以从该基类继承 Employee 或 Student。组合的一个例子是一个 Employee 和一个 Supplier，每个都由一个公共 ContactInfo 对象组合，但没有公共基类。

设计实体时，实际上是在设计底层关系数据库的表结构。您可以对继承进行建模：公共基类可以由它自己的表和任何公共字段表示，并且任何专用类都可以在它们自己的表中，并具有链接到公共表的外键。这样做可能有意义，也可能没有意义 - 通过将事物分解为单独的表，您正在向查询添加另一个联接。这会降低性能。

组合也可以在关系数据库中表示，但只有当它是许多其他数据实体共享的公共组件时才真正有意义。ContactInfo 对于给定的人员/供应商几乎总是唯一的，因此将其分解为单独的表确实没有意义 - 您只是添加了一个额外的表连接，这再次会降低性能您的查询。

您应该考虑在设计中将继承/组合向上移动一层。实体（数据访问层）应该匹配关系数据库，但领域模型（即业务对象层）应该遵循面向对象的原则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T01:44:58.613

是的，您必须在模型中定义继承。之后，请确保您定义了一对多的关系。参考这里的链接，很好的教程。

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application)

# c - 分段错误错误

> ID：14532855
> 
> 赞同：0
> 
> 时间：2013-01-26T01:25:10.857
> 
> 标签：c

我的程序读取参数中指定的文件并打印出文件中的每个字符串及其频率。

该程序适用于此文件：[http](http://www.cse.yorku.ca/course/3221/dataset1.txt) ://www.cse.yorku.ca/course/3221/dataset1.txt 但不适用于此文件： [http](http://www.cse.yorku.ca/course/3221/dataset3.txt) ://www.cse.yorku.ca/course/3221/dataset2.txt .

它给出`Segmentation fault (core dumped)`了第二个文件的错误。

有什么问题？请帮忙！

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

typedef  struct {
    char  word[101];
    int   freq;
} WordArray;

int main(int argc, char *argv[])
{

    WordArray *array = malloc(sizeof(WordArray));
    FILE *file;

    int i = 0;
    file = fopen(argv[1], "r");
    char *str = (char*) malloc (108);

    while(fgets(str, 100, file) != NULL)
    {
        int pos = 0;
        char *word = malloc (100);

        while (sscanf(str, "%s%n", word, &pos ) == 1)
        {
            int j;
            for (j = 0; j < i; j++)
            {
                if (strcmp(array[j].word, word) == 0)
                {
                    array[j].freq = array[j].freq + 1;
                    break;
                }
            }
            if (j==i)
            {
                array = (WordArray *) realloc (array, sizeof(WordArray) * (i+1));
                strcpy(array[i].word, word);
                array[i].freq = 1;
                i++;
            }

            str += pos;

        }
    }

    fclose(file);

    int k;

    for (k=0; k<i; k++)
    {
        printf("%s %d\n", array[k].word, array[k].freq);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:49:15.970

几个问题：

您增加 str 作为第二个循环的一部分，不要重置它。我认为这意味着您的程序正在慢慢地遍历内存。

您无法释放单词-最好将其分配在循环之外和堆栈上，但这不会导致崩溃，除非您输入的内容很大并且内存不足。

您不需要为现代编译器转换 malloc 的结果（是的，它曾经是必需的）。

可能要检查 malloc 和 realloc 的结果是否安全。

我认为第一项是您的问题。

# android - 我的日食不正常

> ID：14532857
> 
> 赞同：0
> 
> 时间：2013-01-26T01:25:29.657
> 
> 标签：android, eclipse, ubuntu

File->new project，只出现两个选项，之前有很多选项选项，我也安装了android开发工具，没有出现关于那个的项。我卸载了eclipse并重新安装了eclipse，这个问题似乎没有改变。我的系统在 ubuntu 12.10 64bit 下

![在此处输入图像描述](../Images/562a03326328416ebaa529753073e2f7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:28:27.197

如果您使用 安装它`apt-get`，我建议您从[http://developer.android.com/sdk/index.html安装它](http://developer.android.com/sdk/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:41:23.670

可能您使用了中央程序。尝试直接从网站下载：http: [//developer.android.com/tools/sdk/eclipse-adt.html](http://developer.android.com/tools/sdk/eclipse-adt.html)

eclipse不需要安装，可以下载，在lixux的情况下，分配permição需要运行“sudo chmod -R + r eclipse”

# android - SQLiteDatabase 更新不起作用？

> ID：14532859
> 
> 赞同：6
> 
> 时间：2013-01-26T01:25:34.067
> 
> 标签：android, database, sqlite, listview

我试图让 db.update 用新值更新我的数据库的其中一行，但它似乎没有保存。我查看了我的语法，但似乎无法保存数据。插入功能正在工作但没有更新。任何帮助，将不胜感激。下面是我使用 DbHelper 对象的数据类。

```
 public class Data {
    static final String TAG = "Data";

    public static final String DB_NAME = "data.db";
    public static final String TABLE_NAME = "tasks";
    public static final String C_ID = "_id";
    public static final String C_TASK = "taskname";
    public static final String C_DUE_DATE = "due_date";
    public static final String C_PRIORITY = "priority";
    public static final int DB_VERSION = 1;

    Context context;
    DbHelper dbHelper;
    SQLiteDatabase db;

    public Data(Context context) {
        this.context = context;
        dbHelper = new DbHelper();
    }

    public void insert(ToDoItem task) {
        db = dbHelper.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(C_TASK, task.getTask());
        values.put(C_PRIORITY, task.getPriority());

        db.insert(TABLE_NAME, null, values);
    }
    public void update(int id, ToDoItem task) {
    ContentValues values = new ContentValues();
    values.put(C_ID, id);
    values.put(C_TASK, task.getTask());
    values.put(C_PRIORITY, task.getPriority());

    String[] whereArgs = {String.valueOf(id)};

    db.update(TABLE_NAME, values, C_ID +" =?", whereArgs);
    System.out.println(db.update(TABLE_NAME, values, C_ID +" =?", whereArgs));

    Log.d(TAG, "updating task " + db.toString() +" "+ id + " to priority " + task.getPriority());
}

    public void delete(int id){
        db.delete(TABLE_NAME, C_ID+"="+id, null);
    }

    public Cursor queueAll(){
        db = dbHelper.getWritableDatabase();

        String[] columns = new String[]{C_ID, C_TASK, C_DUE_DATE, C_PRIORITY};

        Cursor cursor = db.query(TABLE_NAME, columns,   
                null, null, null, null, null);
        return cursor;
     }

    class DbHelper extends SQLiteOpenHelper {

        public DbHelper() {
            super(context, DB_NAME, null, DB_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            String sql = String.format("create table %s" +
                        "(%s int primary key, %s text, %s text, %s int)", 
                        TABLE_NAME, C_ID, C_TASK, C_DUE_DATE, C_PRIORITY);

            Log.d(TAG, "onCreate with SQL:"+sql);

            db.execSQL(sql);    
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            db.execSQL("drop if exists " + TABLE_NAME);
            onCreate(db);
        }
    }

} 
```

这是我尝试在单击项目时更新优先级的 ToDoItem 对象类

```
 public class ToDoItem {
        private String task;
        private String dueDate;
        private int priority;

        public ToDoItem(String task) {
        this.task = task;
        this.priority = 1;
    }

    public ToDoItem(String task, String dueDate) {
        this.task = task;
        this.dueDate = dueDate;
        this.priority = 1;
    }

    public ToDoItem(String task, int priority) {
        this.task = task;
        if(priority <=3 && priority > 0) {
            this.priority = priority;
        } else 
            this.priority = 1;
    }

    public ToDoItem(String task, String dueDate, int priority) {
        this.task = task;
        this.dueDate = dueDate;
        if(priority <=3 && priority > 0) {
            this.priority = priority;
        } else 
            this.priority = 1; 
    }

    public String getTask() {
        return task;
    }

    public void setTask(String task) {
        this.task = task;
    }

    public String getDueDate() {
        return dueDate;
    }

    public void setDueDate(String dueDate) {
        this.dueDate = dueDate;
    }

    public int getPriority() {
        return priority;
    }

    public void setPriority(int priority) {
        if(priority <=3 && priority > 0) {
            this.priority = priority;
        } else 
            this.priority = 1;
    }
} 
```

最后是我的 onListItemClickListener，它使用 ToDoItems 的 ArrayList，更改优先级并从我的数据类调用更新方法。但是，我尝试更新的行的值保持不变。我使用 Log.d 检查是否传递了正确的值，并且它们是。由于某种原因，这些变化没有发生。任何帮助，将不胜感激。

```
 todoList.setOnItemClickListener(new AdapterView.OnItemClickListener() {

    @Override
          public void onItemClick(AdapterView<?> arg0, View arg1, final int arg2,
                long arg3) {

            if(soundEnabled) {
                playSound();
            }

            // Change the priority of the item inside the arrayList todoItems
            todoItems.get(arg2).setPriority(todoItems.get(arg2).getPriority() + 1);
            String name = todoItems.get(arg2).getTask();
            int priority = todoItems.get(arg2).getPriority();
            final ToDoItem task = new ToDoItem(name, priority);

            // Get the position of the task in the database
            int id = arg2 + 1;
            data.update(id, task);

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T02:03:59.187

你会打印 db.update(TABLE_NAME, values, C_ID +"="+id, null) 函数返回值吗？

如果返回值为 0，则 DB 中没有这样的“id”行记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T02:03:08.127

我看不到您如何创建表“任务”及其属性。但是，如果您更新所有属性，您可能会尝试使用 replace() 方法。尝试更换你的

```
public void update(int id, ToDoItem task) {
...
} 
```

和：

```
public void update(int id, ToDoItem task) {
    ContentValues values = new ContentValues();
    values.put(C_TASK, task.getTask());
    values.put(C_PRIORITY, task.getPriority());
    db.replace(TABLE_NAME, null, initialValues);
} 
```

还要确保**task.getTask()**返回“任务”表中存在的正确整数值。您使用 int 参数调用 update() 方法，但是您从不在更新方法中使用它。在您的更新方法中，您可能想要替换：

```
values.put(C_TASK, task.getTask()); 
```

和

```
values.put(C_TASK, id); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T17:16:02.933

我解决了这个问题，我在创建任务时没有读取 C_ID，因此我在创建数据库时将“整数主键”更改为“整数主键自动增量”，这意味着更新现在可以更新正确的行。感谢所有帮助我解决这个问题的人。

# facebook - Facebook phonegap 登录

> ID：14532861
> 
> 赞同：2
> 
> 时间：2013-01-26T01:26:12.447
> 
> 标签：facebook, cordova, login

我正在尝试使用 PhoneGap 登录 Facebook。它似乎运作良好。但在 iOS 6.0 上，登录失败并显示消息“无法完成操作。（com.facebook.sdk 错误 5）”。

如果我没有在我的 iPhone 设置中设置帐户，插件使用浏览器登录。没有问题。但是，如果我在设置中设置帐户，它会在消息中显示。如果我关闭应用程序并再次启动，它会成功登录。

该函数检查是否已经登录。

```
function getLoginStatus() {    
FB.getLoginStatus(function(session) {
    console.log('Got the user\'s session(facebook): ', session);

    if (session.status == 'connected') {
        FB.api('/me', {
            fields: 'id, name, email'
        },
        function(response) {
            if (response.error) { 
               console.log('get user name failed');
               login(); // login to Facebook.
            }
            else
            {                   
               console.log('FB name, ' + response.name);
               console.log('FB id, ' + response.id);
               console.log('FB email, ' + response.email);

               siteLogin(response); // login to my site.                   
            }
        });
    } else {
        console.log('get user name failed 2');

        login(); // login to Facebook
    }

});
} 
```

脸书登录功能

```
function login() {
FB.login(
         function(response) {

         if (response.session) {
             alert('logged in');
         } else {
             alert('not logged in');
         }
    },
    { scope: "email" }
);
} 
```

这是事件函数。

```
FB.Event.subscribe('auth.login',  function(response) {      
FB.api('/me',{ fields: 'id, name, email' }, function(response1) {        
       if (response1.name !== undefined)
       {   
            siteLogin(response1);    // login to my site.            
       }
       else
       {
            // I think here I get the message "The operation couldn't be completed.(com.facebook.sdk error 5)"
            alert('error.');
       }
});
}); 
```

# c# - 从 amazon s3 下载文件时出错

> ID：14532865
> 
> 赞同：6
> 
> 时间：2013-01-26T01:26:46.670
> 
> 标签：c#, .net, amazon-web-services, amazon-s3

我正在尝试从 amazon s3 下载文件。我为此使用.NET sdk。我写下了以下代码：

```
GetObjectRequest request = new GetObjectRequest()
    .WithKey("abc/xyz.jpg")
    .WithBucketName(appConfig);

using (GetObjectResponse response = s3Client.GetObject(request))
{
    int numBytesToRead = (int)response.ContentLength;
    if (numBytesToRead > 0)
    {
        int numBytesRead = 0;
        byte[] buffer = new byte32768;
        using (FileStream fstream = new FileStream(@"C:\abc\xyz.jpg", FileMode.Create))
        {
            using (Stream responseStream = response.ResponseStream)
            {
                do
                {
                    numBytesRead = responseStream.Read(buffer, 0, buffer.Length);
                    fstream.Write(buffer, 0, numBytesRead);
                }
                while (numBytesRead > 0);
            }
        }
    }
} 
```

使用此代码，我可以下载文件。但现在我想下载多个文件。为此，我首先列出 s3 上可用的所有文件，然后将其存储在 arraylist 中，然后为每个文件调用我的下载函数。

在使用 (GetObjectResponse response = s3Client.GetObject(request)) 后调用下载函数时运行列表文件方法后出现异常。

{“拒绝访问”}

```
Stack trace:
at Amazon.S3.AmazonS3Client.processRequestError(String actionName, HttpWebRequest request, WebException we, HttpWebResponse errorResponse, String requestAddr, WebHeaderCollection& respHdrs, Type t, Exception& cause)
at Amazon.S3.AmazonS3Client.handleHttpWebErrorResponse(S3Request userRequest, WebException we, HttpWebRequest request, HttpWebResponse httpResponse, Exception& cause, HttpStatusCode& statusCode)
at Amazon.S3.AmazonS3Client.getResponseCallback[T](IAsyncResult result)
at Amazon.S3.AmazonS3Client.endOperation[T](IAsyncResult result)
at Amazon.S3.AmazonS3Client.EndGetObject(IAsyncResult asyncResult)
at Amazon.S3.AmazonS3Client.GetObject(GetObjectRequest request)
at ScreenshotsUploader.ScreenshotsUploader.downloadFile(AmazonS3 s3Client, NameValueCollection appConfig) in c:\Users\xyz\Documents\Visual Studio 2012\Projects\ScreenshotsUploader\ScreenshotsUploader\ScreenshotsUploader.cs:line 220
at ScreenshotsUploader.ScreenshotsUploader.GetServiceOutput() in c:\Users\xyz\Documents\Visual Studio 2012\Projects\ScreenshotsUploader\ScreenshotsUploader\ScreenshotsUploader.cs:line 55 
```

状态码：

System.Net.HttpStatusCode.Forbidden

我需要做什么来解决这个问题？

我也尝试了不同的方法来下载文件并得到了同样的错误：

第二种方法：

```
string fileToDownload = @"xyzjpg";
string saveToo = @"C:\xyz.jpg";
TransferUtilityDownloadRequest request = new TransferUtilityDownloadRequest().WithBucketName(appConfig).WithKey(fileToDownload).WithFilePath(saveToo);
TransferUtility tu = new TransferUtility(s3Client);
tu.Download(request); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-29T11:27:10.427

```
public Stream DownloadS3Object(string awsBucketName, string keyName)
{

    using (var client = Amazon.AWSClientFactory.CreateAmazonS3Client())
    {
        Stream imageStream = new MemoryStream();
        GetObjectRequest request = new GetObjectRequest { BucketName = awsBucketName, Key = keyName };
        using (GetObjectResponse response = client.GetObject(request))
        {
            response.ResponseStream.CopyTo(imageStream);
        }
        imageStream.Position = 0;
        // Clean up temporary file.
        // System.IO.File.Delete(dest);
        return imageStream;
    }
} 
```

通过函数获取流路径中的值将其保存在文件夹中，使用下面的方法。

```
SaveStreamToFile(foldername + "/", MainStreamAwsPath); 
```

并且您可以应用简单的 c# 代码来下载该文件夹。

# yaml - 除非我使用流样式，否则为什么 YAML 别名不起作用？

> ID：14532869
> 
> 赞同：2
> 
> 时间：2013-01-26T01:27:27.903
> 
> 标签：yaml

如果你运行这个 YAML 1.1

```
- &first {'first': ['description', ['aliases'], ["Explanatory sentences ", "go here."]]}
- *first
- &second 'second':
    - 'description'
    - ['aliases']
    -
        - "Explanatory sentences "
        - "go here."
- *second 
```

通过[YAMLlint](http://www.yamllint.com)，你得到这个：

```
--- 
- 
  first: 
    - description
    - 
      - aliases
    - 
      - "Explanatory sentences "
      - "go here."
- 
  first: 
    - description
    - 
      - aliases
    - 
      - "Explanatory sentences "
      - "go here."
- 
  second: 
    - description
    - 
      - aliases
    - 
      - "Explanatory sentences "
      - "go here."
- second 
```

请注意，该`first`组重复两次，而该`second`组仅完整显示一次，仅显示重复块应位于的名称。`first`组和组的`second`数据完全相同——唯一的区别是布局。为什么别名不适用于`second`组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T15:40:43.303

我最好的猜测是 &anchor 具有非常高的优先级。我试过这个

```
- &first 'first': ['description', ['aliases'], ["Explanatory sentences ", "go here."]]
- *first 
```

而不是这样：

```
- &first {'first': ['description', ['aliases'], ["Explanatory sentences ", "go here."]]}
- *first 
```

突然间，它的行为方式与该`second`组相同。`'first'`因此，除非您在更大的节点中明确包含 ，否则锚点似乎`&first`只附加到`'first'`字符串而不附加任何其他内容。

# ios - 每个 UI 元素都应该有一个 IBOutlet 吗？

> ID：14532871
> 
> 赞同：2
> 
> 时间：2013-01-26T01:27:48.277
> 
> 标签：ios, objective-c, interface-builder

在 IB 中创建 UI 时，我经常使用具有操作但视图控制器没有理由访问此按钮的按钮。

按钮文本永远不会改变，按钮图像永远不会改变，它永远不会移动，等等......

因此，我没有给它一个 IBOutlet 属性，也没有将它连接到 VC 中的任何东西（当然除了动作之外）。

我读过关于 SO 的类似问题，其中的论点涉及内存管理问题。这个问题来自 2011 年初，在 ARC 之前。鉴于我所有的 IBOutlet 属性都很弱，内存是由它们的超级视图处理的，而不是由视图控制器处理的。因此，该问题中提到的问题现在没有实际意义。

现在有理由将它们连接起来吗？他们应该总是有联系吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:30:51.613

简短的回答：没有。

`IBOutlet`需要 s 来引用 UI 的元素。

如果您不需要访问这些元素，则不必将它们与`IBOutlet`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T02:16:23.493

答案是否定的。

但这里有一个有价值的提示，如果有人看到这个问题/答案并开始努力并删除所有未使用的 IBOutlets。

如果删除 UIElement 的 IBOutlet，请确保 IB 中的 UIElement 没有引用现在不存在的插座。否则，你会遇到一些奇怪的崩溃，这需要相当长的时间才能解决。

这是一个让我多次陷入困境的问题。我不确定这是否已在最新版本的 Xcode 中修复，但检查起来更安全。

# python - 创建 for 循环直到 list.length

> ID：14532875
> 
> 赞同：25
> 
> 时间：2013-01-26T01:28:17.563
> 
> 标签：python, list, for-loop

我现在正在阅读 for 循环，我很好奇是否可以像在 Java 中一样在 Python 中执行 for 循环。

是否有可能做类似的事情

```
for (int i = 1; i < list.length; i++) 
```

你能在这个 for 循环中再做一个 for 循环吗？

谢谢

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-26T01:31:31.010

在 Python 中，您可以迭代`list`自身：

```
for item in my_list:
   #do something with item 
```

或使用索引，您可以使用[`xrange()`](http://docs.python.org/2.7/library/functions.html#xrange)：

```
for i in xrange(1,len(my_list)):    #as indexes start at zero so you 
                                    #may have to use xrange(len(my_list))
    #do something here my_list[i] 
```

还有另一个名为 的内置函数[`enumerate()`](http://docs.python.org/2.7/library/functions.html#enumerate)，它返回项目和索引：

```
for index,item in enumerate(my_list):
    # do something here 
```

例子：

```
In [117]: my_lis=list('foobar')

In [118]: my_lis
Out[118]: ['f', 'o', 'o', 'b', 'a', 'r']

In [119]: for item in my_lis:
    print item
   .....:     
f
o
o
b
a
r

In [120]: for i in xrange(len(my_lis)):
    print my_lis[i]
   .....:     
f
o
o
b
a
r

In [122]: for index,item in enumerate(my_lis):
    print index,'-->',item
   .....:     
0 --> f
1 --> o
2 --> o
3 --> b
4 --> a
5 --> r 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-26T01:31:18.903

是的，您可以使用[`range` *^([docs])*](http://docs.python.org/2/library/functions.html#range)：

```
for i in range(1, len(l)):
    # i is an integer, you can access the list element with l[i] 
```

但是，如果您仍然要访问列表元素，直接迭代它们会更自然：

```
for element in l:
   # element refers to the element in the list, i.e. it is the same as l[i] 
```

如果要跳过第一个元素，可以[对列表进行切片*^([tutorial])*](http://docs.python.org/2/tutorial/introduction.html#lists)：

```
for element in l[1:]:
    # ... 
```

* * *

> 你能在这个for循环中再做一个for循环吗

你当然可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T01:51:19.897

答案取决于你需要一个循环来做什么。

当然你可以有一个类似于 Java 的循环：

```
for i in xrange(len(my_list)): 
```

但我从未真正使用过这样的循环，

因为通常你想迭代

```
for obj in my_list 
```

或者如果您还需要索引

```
for index, obj in enumerate(my_list) 
```

或者您想从列表中生成另一个集合

```
map(some_func, my_list)

[somefunc[x] for x in my_list] 
```

还有一些`itertools`模块涵盖了大多数与迭代相关的案例

也请看一下内置函数，如`any`, `max`, `min`, `all`,`enumerate`

我会说 - 不要尝试在 python 中编写类似 Java 的代码。总是有一种 Pythonic 的方式来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T01:30:41.523

你可以在这里了解 Python 循环： [http ://en.wikibooks.org/wiki/Python_Programming/Loops](http://en.wikibooks.org/wiki/Python_Programming/Loops)

您必须知道 Python 没有 { 和 } 用于循环的开始和结束，而是取决于您在第一行输入的制表符，我的意思是行缩进。

所以你可以用双制表符（缩进）做循环内循环

双循环的一个例子是这样的：

```
onetoten = range(1,11)
tentotwenty = range(10,21)
for count in onetoten:
    for count2 in tentotwenty
        print(count2) 
```

# svn - 来自命令行的颠覆（svn）：任何一个“反映所有更改”的命令？

> ID：14532880
> 
> 赞同：1
> 
> 时间：2013-01-26T01:28:58.237
> 
> 标签：svn, maven, maven-plugin

当你在一个项目中工作时，至少我自己，无论你是否使用 IDE（如 eclipse 或 netbeans），你都会更新源文件、创建目录、创建新文件、删除一些文件或重命名它们。（我不想花时间为每个文件发出 svn 命令，甚至更多，如果其中一些可能还不是最终的）。

在某个时刻，您认为您已经掌握了它：好吧，这就是我想要保留并保存到存储库中的内容。

是否有任何单一的 svn 命令可以说“按原样存储工作项目”？（这可能意味着大量的添加和删除（重命名 = 使用 svn remove+add 的本地副本）并递归到目录中）。

如果不是（我猜），有任何 shell 脚本来完成这项任务吗？（基于 svn 状态，递归地为每个子文件夹）。

**更新：**

是否有任何 Maven 插件可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T08:07:24.070

我认为这可以完成任务：

```
if [ $# != 1 ]
then
    echo  "usage: doSVNsnapshot.sh DIR"
    exit 0
fi

ROOT=$1

for i in `find ${ROOT} -type d \! -path "*.svn*" `
do

    echo
    echo "--------------------------"
    ( cd $i ; 
    echo $i
    echo "--------------------------"

    svn status | awk '  
            /^[!]/ { system("svn rm " $2) }
            /^[?]/ { system("svn add " $2) }
        '
    )
    echo

done 
```

# android - GLSurfaceView 如何与surfaceflinger 连接？

> ID：14532884
> 
> 赞同：0
> 
> 时间：2013-01-26T01:29:54.273
> 
> 标签：android, opengl-es, glsurfaceview

最近我对 GLSurfaceView 感到困惑。在java级别，它使用glsurfaceview以及它如何与surfaceflinger连接？

谢谢詹姆斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T05:32:25.803

使用 GLSurfaceView ，您将绘制从 A Surface 创建的 EGLSurface。SurfaceFlinger 内部的表面称为 SurfaceTexture 和 BufferQueue 。因此，SurfacFlinger 仍然拥有 GLSurfaceView 将要绘制的那块内存，因此可以合成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T13:12:38.180

看看[这里](https://stackoverflow.com/questions/4579573/android-graphics-internals)。简单来说：

*   表面抛掷器是合成器并处理绘图`Surface`实例。
*   A`GLSurfaceView`包含`Surface`可以使用 OpenGL ES 绘制的 a。

# gwt - GWT requestfactory：用户可以制作实体代理的setter方法吗？

> ID：14532903
> 
> 赞同：2
> 
> 时间：2013-01-26T01:31:54.907
> 
> 标签：gwt, requestfactory

我在我的应用程序中使用请求工厂，客户端代理包含用户可以修改的 getter 方法和一些 setter 方法，但是出于安全原因，一些 setter 方法没有公开，我想知道是否有可能，用户从客户端，是否能够制造 setter 方法来修改实体？

如果是这样，有人知道如何解决这种情况的安全风险吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T13:54:53.070

在 Web 开发中要记住一条重要的规则：

> **你永远不应该相信客户**

用户可以访问客户端上的数据并对其进行修改。它还可以生成一些任意`RequestFactory`有效负载并将其直接发送到后端，甚至无需使用您的应用程序。

因此唯一的解决方案是保护后端并确保允许当前登录的用户调用`setter`（即使用 AOP 等）

# hive - hiveQL if 语句在一行上重新组合

> ID：14532908
> 
> 赞同：3
> 
> 时间：2013-01-26T01:33:15.160
> 
> 标签：hive, hiveql

询问 ：

```
select IF(type='view', count(*), 0), IF(type='click', count(*), 0)
from ad_events
where year=2013 and month=01 and day=18 and (hour=01 or hour=02)
group by type 
```

结果 ：

```
 _c0       _c1
0      0         0
1      0         0
2      0       1368
3      0         0
4      0         0
5      0         0
6      0         0
7      0         0
8   277917       0
9      0         0 
```

无论如何只有这样的一行有结果吗？：

```
 _c0       _c1
0    277917     1368 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:28:48.450

好的，我只是在嵌套查询中做到了：

```
select SUM(c), SUM(v)
from (
select tracking_id, IF(type='view', count(*), 0) AS v, IF(type='click', count(*), 0) AS c
from ad_events
where year=2013 and month=01 and day=18
group by tracking_id, type
) t2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-06T08:35:54.587

请尝试以下

```
select
   type,
   count(type) TypeCount
from ad_events
where
   year=2013 and 
   month=01 and 
   day=18 and 
   (hour=01 or 
    hour=02)
group by type 
```

# opengl - GLEW 链接错误

> ID：14532917
> 
> 赞同：1
> 
> 时间：2013-01-26T01:34:31.457
> 
> 标签：opengl, glew, freeglut

我正在尝试做 openGLbook.com 教程。我收到这个常见错误：

```
 1>------ Build started: Project: OpenGL Startup, Configuration: Debug Win32 ------
1>Build started 1/25/2013 8:18:16 PM.
1>InitializeBuildStatus:
1>  Touching "Debug\OpenGL Startup.unsuccessfulbuild".
1>ClCompile:
1>  All outputs are up-to-date.
1>ManifestResourceCompile:
1>  All outputs are up-to-date.
1>main.obj : error LNK2019: unresolved external symbol __imp__glewGetErrorString@4 referenced in function _Initialize
1>main.obj : error LNK2019: unresolved external symbol __imp__glewInit@0 referenced in function _Initialize
1>J:\Coding Projects\OpenGL 3.3 Tutorial\OpenGL Startup\Debug\OpenGL Startup.exe : fatal error LNK1120: 2 unresolved externals
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:00.07
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我从 glew.sourceforge.net 下载了最新的 GLEW 64 位二进制文​​件，并将它们复制到 C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A 中的相应位置。我还下载了最新的 freeglut 文件并做了同样的事情。

我正在使用 VS 2010。以下是我更改的设置（基于其他线程和论坛）：

1) 属性 > VC++ 目录........添加了包含 glew.h 和 freeglut.h 的“include”文件夹

2）属性>链接器>输入>附加依赖.....添加glew32.lib，freeglut.lib，glew32mx.lib，glew32mxs.lib，glew32s.lib

我真的不明白为什么它仍然没有正确链接库。我还应该注意，我正在使用与 C 驱动器不同的驱动器工作。即使我将所有内容都链接到属性中的正确文件夹，这是否会产生影响？

编辑：忘记发布实际代码，这里是：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <GL/glew.h>
#include <GL/freeglut.h>
#define WINDOW_TITLE_PREFIX "Chapter 1"

int CurrentWidth = 800,
    CurrentHeight = 600,
    WindowHandle = 0;

    unsigned FrameCount = 0;

void Initialize(int, char*[]);
void InitWindow(int, char*[]);
void ResizeFunction(int, int);
void RenderFunction(void);
void TimerFunction(int);
void IdleFunction(void);

int main(int argc, char* argv[])
{
    Initialize(argc, argv);

    glutMainLoop();

    exit(EXIT_SUCCESS);
}

void Initialize(int argc, char* argv[])
{
    GLenum GlewInitResult;

    InitWindow(argc, argv);

    GlewInitResult = glewInit();

    if (GLEW_OK != GlewInitResult) {
        fprintf(
            stderr,
            "ERROR: %s\n",
            glewGetErrorString(GlewInitResult)
            );
    }

    fprintf(
        stdout,
        "INFO: OpenGL Version: %s\n",
        glGetString(GL_VERSION)
    );

    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
}

void InitWindow(int argc, char* argv[])
{
    glutInit(&argc, argv);

    glutInitContextVersion(4, 0);
    glutInitContextFlags(GLUT_FORWARD_COMPATIBLE);
    glutInitContextProfile(GLUT_CORE_PROFILE);

    glutSetOption(
        GLUT_ACTION_ON_WINDOW_CLOSE,
        GLUT_ACTION_GLUTMAINLOOP_RETURNS
    );

    glutInitWindowSize(CurrentWidth, CurrentHeight);

    glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);

    WindowHandle = glutCreateWindow(WINDOW_TITLE_PREFIX);

    if(WindowHandle < 1) {
        fprintf(
            stderr,
            "ERROR: Could not create a new rendering window.\n"
        );
        exit(EXIT_FAILURE);
    }

    glutReshapeFunc(ResizeFunction);
    glutDisplayFunc(RenderFunction);
    glutIdleFunc(IdleFunction);
    glutTimerFunc(0, TimerFunction, 0);
}

void ResizeFunction(int Width, int Height)
{
    CurrentWidth = Width;
    CurrentHeight = Height;
    glViewport(0, 0, CurrentWidth, CurrentHeight);
}

void RenderFunction(void)
{
    ++FrameCount;

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glutSwapBuffers();
    glutPostRedisplay();
}

void IdleFunction(void)
{
    glutPostRedisplay();
}

void TimerFunction(int Value)
{
    if (0 != Value) {
        char* TempString = (char*)
            malloc(512 + strlen(WINDOW_TITLE_PREFIX));

        sprintf(
            TempString,
            "%s: %d Frames Per Second @ %d x %d",
            WINDOW_TITLE_PREFIX,
            FrameCount * 4,
            CurrentWidth,
            CurrentHeight
        );

        glutSetWindowTitle(TempString);
        free(TempString);
    }

    FrameCount = 0;
    glutTimerFunc(250, TimerFunction, 1);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T03:00:02.173

对不起，如果你已经想通了。我也没有花时间阅读评论。但是，您正在链接到 glew32s.lib 这是静态库，但您的代码顶部没有#define GLEW_STATIC 与您的包含。

试试看。我很确定这是你的问题。我尝试在我的代码中注释掉该行并得到类似的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T15:09:36.033

嗯，MS 编译器可以给你链接错误的原因有很多。一是，不与您需要的库链接！有一个链接器选项 (/VERBOSE) 列出了它在尝试链接时正在搜索的所有链接库。打开它并确保它实际上正在搜索您拥有它们的 GLEW 库。

另一种可能性是您使用了错误的 GLEW 库。MS 故意更改编译器版本之间函数/方法名称的编码方式，因此您无法将 VC++ 2008 库链接到 VC++ 2010 编译的应用程序。同样，您不能将 64 位库链接到 32 位版本。您将收到像这样的“未解析的外部符号”错误。

您可以“解开”您在此处看到的“损坏”名称：_ *imp* _glewGetErrorString@4

并根据额外的下划线等判断它是 64 位还是 32 位库。

[http://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B_Name_Mangling](http://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B_Name_Mangling)

但这对初学者来说很难。

我的猜测是您没有与您认为的图书馆链接。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-09T10:29:21.577

我最近才遇到这个问题。我正在运行 Windows 8，使用 VS Express 2012 编译 GLEW 程序（我是这个 IDE 的新手，因为我已经使用 VC++ 6.0 这么久了）。通常这个问题是由于缺少 DLL 文件，我通过将 glew32.dll 从`<Glew_HOME>\bin\Release\Win32`（不是 x64 版本）复制到目录来解决它`C:\Windows\SysWOW64`。最好知道如何将 DLL 资源与 EXE 静态链接，这样我就不再需要依赖系统资源了。

# clojure - 从 nrepl.el 打印到 repl-y 或反之亦然

> ID：14532918
> 
> 赞同：4
> 
> 时间：2013-01-26T01:34:56.540
> 
> 标签：clojure

鉴于以下情况 -

*   从终端模拟器上的`lein repl`（[repl-y](https://github.com/trptcolin/reply/)）会话：

    `(def reply-out *out*)`

*   然后从 Emacs 上的[nrepl.el](https://github.com/kingtim/nrepl.el)会话：

    `(def nrepl-out *out*)`

两个变量将具有不同的值，因为它们将在不同的目标上运行。

但是现在，如果我在 Emacs 中执行：

```
(binding [*out* reply-out] (println :foo)) 
```

该值将根据需要/预期打印在 Emacs 上而不是终端仿真器上。反之亦然。

**如何将值从一个 repl 打印到另一个？**

**更新**：在 Llinux 机器上使用 Emacs 24，用 xterm 和 gnome-terminal 测试。也尝试使用`println`每个`PrintWriter`对象的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T17:33:39.833

这将打印到运行底层 Clojure 进程的 repl：

```
 (binding [*out* (clojure.java.io/writer System/out)]
     (println :bar)) 
```

虽然这不是一个灵活的解决方案，但我的问题的实际答案将非常受欢迎。

# ios - iOS：UIImageView 幻灯片

> ID：14532919
> 
> 赞同：2
> 
> 时间：2013-01-26T01:35:27.683
> 
> 标签：ios, objective-c, c

对于 iOS 应用程序，我希望 UIImageView 在幻灯片中包含多个图像。我还希望能够即时选择活动照片。是否有捷径可寻？（具体的代码会很好，但也可以提供一两个提示）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T16:52:38.087

为此，我制作了一个小型库，非常灵活，有很多选项：[https ://github.com/kirualex/KASlideShow](https://github.com/kirualex/KASlideShow)

一个简单的幻灯片声明如下所示：

```
_slideshow.delegate = self;
[_slideshow setDelay:1]; // Delay between transitions
[_slideshow setTransitionDuration:.5]; // Transition duration
[_slideshow setTransitionType:KASlideShowTransitionFade]; // Choose a transition type (fade or slide)
[_slideshow setImagesContentMode:UIViewContentModeScaleAspectFill]; // Choose a content mode for images to display
[_slideshow addImagesFromResources:@[@"test_1.jpeg",@"test_2.jpeg",@"test_3.jpeg"]]; // Add images from resources
[_slideshow addGesture:KASlideShowGestureTap]; // Gesture to go previous/next directly on the image 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:39:03.070

```
- (void)awakeFromNib {
    timer = [NSTimer scheduledTimerWithTimeInterval:5.0 target:self selector:@selector(updatePhoto) userInfo:nil repeats:YES];
    count = 0;
}
// this creates a loop every 0.5 secs.
// then set up your image changes.

-(void)updatePhoto{
    count = count + 1;
    [self updateImage];
}

-(void)updateImage{
    if (count == 1){
        mainImage.image = [UIImage imageNamed:@\"img2.jpg\"];
    }
    if (count == 2){
        mainImage.image = [UIImage imageNamed:@\"img4.jpg\"];
    }
    if (count == 3){
        mainImage.image = [UIImage imageNamed:@\"img3.jpg\"];
    }
    if (count == 4){
        mainImage.image = [UIImage imageNamed:@\"img3.jpg\"];
    }
    else{
        mainImage.image = [UIImage imageNamed:@\"img1.jpg\"];
    }

} 
```

# java - 读取最多一个 NUL 字符的字节数组

> ID：14532921
> 
> 赞同：0
> 
> 时间：2013-01-26T01:36:05.590
> 
> 标签：java, arrays, string

我正在通过 Java 中的 UDP 接收带有字节数组的数据包。我知道最大可能的字节大小，但我不知道当前收到的大小。

如果我从这个字节数组创建一个 String 实例，那么在有用的有效负载之后，该字符串将有很多 NUL 字符 (\u0000)。

当第一个 NUL 出现时，如何将此字节数组转换为字符串？（我不希望在我的有效载荷中有 NUL）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:45:32.190

您可以使用 StringTokenizer 获取字符串的第一部分，直到看到第一个 NULL。类似于：result = (new stringTokenizer(packet, null)).nextToken()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:49:23.323

`String`有一种[`split`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)方法可以根据正则表达式出现的位置将其分解为字符串数组。你可以做

```
 s = s.split("\u0000")[0]; 
```

将字符串拆分为 NUL 字符并获取第一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T02:04:02.147

不要`String`从整个事物中创造出来。扫描*字节数组*的零，然后调用

```
new String(byteArray, 0, correctLength, "encoding") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-05T13:26:15.280

我最近不得不解决这个问题，这是我的解决方案：

```
public String getString(byte[] sb) {
    // trim nulls from end
    int strLen = sb.length;
    for (; strLen > 0; strLen--)
        if (sb[strLen - 1] != '\u0000')
            break;

    return new String(sb, 0, strLen, "UTF8");
} 
```

# python - Django Haystack/ElasticSearch 索引过程中止

> ID：14532935
> 
> 赞同：4
> 
> 时间：2013-01-26T01:40:09.713
> 
> 标签：python, django, elasticsearch, django-haystack

我正在使用 django 1.4、Haystack 2 beta 和 ElasticSearch .20 运行设置。我的数据库是 postgresql 9.1，它有几百万条记录。当我尝试使用 haystack/elasticsearch 索引我的所有数据时，该过程超时并且我收到一条消息，上面写着“Killed”。到目前为止，我注意到以下几点：

1.  我确实获得了要编入索引的文档数量，所以我没有收到类似“0 个要索引的文档”之类的错误。
2.  索引一个小集合，例如 1000，工作得很好。
3.  我试过硬编码超时`haystack/backends/__init__.py`，这似乎没有效果。
4.  我尝试更改 elasticsearch.yml 中的选项也无济于事。

如果硬编码超时不起作用，那么我还能如何延长索引时间？是否有另一种方法可以直接在 ElasticSearch 中进行更改？或者也许是一些批处理方法？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T20:28:15.760

我敢肯定，问题在于生成要发送到 ElasticSearch 的文档，并且使用该[`batch-size`](http://django-haystack.readthedocs.org/en/latest/management_commands.html)选项将帮助您。

[ElasticSearch 后端](https://github.com/toastdriven/django-haystack/blob/1e087f63118aba8e212844cbd2d15caa46e71e62/haystack/backends/elasticsearch_backend.py#L134)中的`update`方法从每个提供的查询集中准备要索引的文档，然后为该查询集执行单个批量插入。

```
self.conn.bulk_index(self.index_name, 'modelresult', prepped_docs, id_field=ID) 
```

因此，看起来如果您有一个包含数百万条记录的表，`update_index`在该索引模型上运行将意味着您需要生成数百万个文档，然后对它们进行索引。我敢冒险这就是问题所在。使用该选项设置批处理限制`--batch-size`应该限制由批量大小的查询集切片生成的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T06:47:00.593

这个版本的 haystack 有问题。在文件 haystack/management/commands/update_index.py 的以下行中找到了导致问题的代码行：

```
pks_seen = set([smart_str(pk) for pk in qs.values_list('pk', flat=True)]) 
```

导致服务器内存不足。但是，对于索引，似乎不需要它。所以，我只是将其更改为：

```
pks_seen = set([]) 
```

现在它正在批量运行。谢谢大家回答！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T20:25:33.670

当您尝试索引所有这些记录时，您是否观察过您的进程正在消耗的内存？通常，当您看到“Killed”时，表示您的系统内存不足，[OOM 杀手](http://linux-mm.org/OOM_Killer)决定终止您的进程以释放系统资源。

# java - 为什么 libGDX image.getHeight() 返回零？

> ID：14532936
> 
> 赞同：2
> 
> 时间：2013-01-26T01:40:11.600
> 
> 标签：java, libgdx

所以我只是想导入一张图片并设置它的位置。我想获得该图像的高度和宽度以正确偏移它，但 getWidth 和 getHeight 方法在我的调试器中返回零。

关于为什么会发生这种情况的任何见解？

```
public void setSplashImage(String path)
{
    Image splashImage;
    splashImage = new Image(new Texture(new FileHandle(path)));
    this.screenStage.addActor(splashImage);
    this.imagePath = path;

    splashImage.setX((float)screenStage.getWidth()/2);
    splashImage.setY((float)screenStage.getHeight()/2);
    System.out.println("");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T07:46:04.140

好的解决了这个问题。

界面有点混乱。getImageHeight 出于某种原因返回零，但 getHeight 返回您期望的值。

我的大脑没有做出区分。

# ios - 将表格分组视图中的单元格连接到另一个视图？

> ID：14532941
> 
> 赞同：1
> 
> 时间：2013-01-26T01:40:33.400
> 
> 标签：ios, objective-c, xcode, uitableview

我正在努力创建一个表格分组视图，并且我完成了（令人惊讶的）。我希望能够连接表格中的任何给定单元格并将其连接到另一个独特的视图。我完全不知道如何做到这一点：/。这是我的代码：

表视图控制器.m

```
#import "TableViewController.h"

@interface TableViewController ()

@end

@implementation TableViewController

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    TableSectionArray = [NSArray arrayWithObjects:@"One", @"Two", @"Three", nil];
    return [TableSectionArray count];
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    NSString *SectionHeader = nil;

    if (section == 0) {
        SectionHeader = @"Section1";
    }
    if (section == 1) {
        SectionHeader = @"Section2";
    }
    if (section == 2) {
        SectionHeader = @"Section3";
    }
    return SectionHeader;

}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (section == 0) {
        TableContentArray = [NSArray arrayWithObjects:@"Name1", @"Name2", nil];
    }
    if (section == 1) {
        TableContentArray = [NSArray arrayWithObjects:@"Name1", @"Name2", nil];
    }
    if (section == 2) {
        TableContentArray = [NSArray arrayWithObjects:@"Name1", @"Name2", nil];
    }
    return [TableContentArray count];

}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    if(cell == nil)
    {
        cell = [UITableViewCell alloc];
    }
    cell.textLabel.text = [TableContentArray objectAtIndex:indexPath.row];
    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:48:39.560

这将根据您到达当前视图的方式而有所不同。基本上你需要整体抓取viewController的当前实例，然后抓取tableView的实例。

如果您继续使用您当前所在的视图，您将执行以下操作：

```
UIPreviousViewController *controller = [self presentingViewController];

UITableViewCell *cell = [controller.tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]]; 
```

- 将行和节号替换为您尝试抓取的任何一个。使用此方法，单元格将只能是只读的。

- 根据您的 viewController 设置，有很多不同的选项（即 tabBar viewControllers 、导航堆栈等）

# javascript - 如何解析 JSON 字符串，其中对象包装在另一个 json 数组中

> ID：14532944
> 
> 赞同：0
> 
> 时间：2013-01-26T01:41:37.003
> 
> 标签：javascript, jquery, json

> **可能重复：**
> [我有一个嵌套的数据结构/JSON，我怎样才能访问一个特定的值？](https://stackoverflow.com/questions/11922383/i-have-a-nested-data-structure-json-how-can-i-access-a-specific-value)

我有一个格式奇怪的 JSON 字符串，看起来像这样，我正在尝试访问属性，但不确定如何访问，因为它是对象中的一堆 json 数组。

变量数据的这个字符串化值

```
 console.debug(JSON.stringify(data)); 
```

看起来像这样

```
[
{
    "note": [
        {
            "type": "2",
            "cid": "36",
            "icon": "cbb4153684de41ca61c0acc7124613b3.png",
            "created_at": "1359163643"
        }
    ],
    "count": 1
}
] 
```

例如，如果我想要 count int 我试过

```
 var count = parseInt(data.count); 
```

但这只会导致 NaN

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T01:42:34.973

`data[0].count`

就像一个普通的数组。

# google-drive-api - 将身份验证令牌交换为访问令牌时出现 405 错误

> ID：14532947
> 
> 赞同：1
> 
> 时间：2013-01-26T01:42:16.553
> 
> 标签：google-drive-api, google-oauth

我已通过 Google Drive API 身份验证并收到了身份验证令牌

然后我按如下方式创建我的 URI

```
 AccessUri = new stringBuilder("https://api.dropbox.com/1/oauth/access_token")
   With AccessUri
                .AppendFormat("?code={0}", oAuth.UrlEncode(AccessToken)) 'Received in first part
                .AppendFormat("&client_id={0}", oAuth.UrlEncode(ConsumerKey)) 'Received from google API
                .AppendFormat("&client_secret={0}", oAuth.UrlEncode(ConsumerSecret)) 'Received from google API
                .AppendFormat("&grant_type={0}", oAuth.UrlEncode("authorization_code"))
                .AppendFormat("&redirect_uri={0}", oAuth.UrlEncode(RedirectURL)) 'using http:localhost/authorise.html
   End With
   dim uriAccess as uri = new uri(AccessUri.tostring) 
```

如果我将其粘贴到地址栏中，我会收到错误 405 Method Not Allowed。如果我在 VB.net 中将其作为请求发送，我会收到相同的错误

[我需要在https://code.google.com/apis/console/](https://code.google.com/apis/console/)中做任何事情吗

有任何想法吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T06:42:34.820

使用此端点将不会有任何运气：

```
https://api.dropbox.com/1/oauth/access_token 
```

获取 Google OAuth 令牌。您应该使用 Google 的 OAuth 2.0 服务，而不是 Dropbox 的。

# ios - 使用 Nav 和 Tab 在视图内绘制自定义视图

> ID：14532951
> 
> 赞同：0
> 
> 时间：2013-01-26T01:43:09.403
> 
> 标签：ios, uiview, uistoryboard

我按照 raywenderlich 教程创建 PDF。[http://www.raywenderlich.com/6818/how-to-create-a-pdf-with-quartz-2d-in-ios-5-tutorial-part-2](http://www.raywenderlich.com/6818/how-to-create-a-pdf-with-quartz-2d-in-ios-5-tutorial-part-2)。我需要顶部的 NavBar 和底部的 Tab。我在底部得到标签，但在顶部缺少导航栏。PDF 接管了底部标签栏顶部的所有内容。任何帮助是极大的赞赏。

```
- (void)viewDidLoad
{
     NSString* fileName = [self getPDFFileName];

     NSMutableDictionary *dataDict = [NSMutableDictionary new];
     NSNumber *tripId = (NSNumber *)[Helper getValueForKeyFromGlobalDictionary:TRIP_ID];
     [dataDict setValue:[self retrieveTimings:[tripId intValue]] forKey:NEWTRIP_MO];
     [dataDict setValue:[self retrieveStops:[tripId intValue]] forKey:TIME_MO];
     [dataDict setValue:[self getCompanyInfo:[tripId intValue]] forKey:COMPANY_MO];
     [dataDict setValue:[self getTripInfo:[tripId intValue]] forKey:TRIP_MO];
     [dataDict setValue:[self getDriverInfo:[tripId intValue]] forKey:DRIVERS_MO];
     [dataDict setValue:[self getLoadInfo:[tripId intValue]] forKey:LOAD_MO];
     [PDFRenderer drawPDF:fileName withData:dataDict];
     [self showPDFFile];
     [super viewDidLoad];

     NSLog(@"Testing");
 }

-(void)showPDFFile
{
    NSString* fileName = @"Invoice.PDF";

    NSArray *arrayPaths =
    NSSearchPathForDirectoriesInDomains(
                                    NSDocumentDirectory,
                                    NSUserDomainMask,
                                    YES);
     NSString *path = [arrayPaths objectAtIndex:0];
     NSString* pdfFileName = [path stringByAppendingPathComponent:fileName];

     UIWebView* webView = //[[UIWebView alloc] initWithFrame:view2.frame];
     [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];

     NSURL *url = [NSURL fileURLWithPath:pdfFileName];
     NSError *error = [[NSError alloc] init];
     NSLog(@"Is resource reachable: %d", [url          checkResourceIsReachableAndReturnError:&error]);
     NSURLRequest *request = [NSURLRequest requestWithURL:url];
     [webView setScalesPageToFit:YES];
     [webView loadRequest:request];

     [self.view addSubview:webView];
     //[self.view insertSubview:webView atIndex:3];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T05:11:59.213

您可以在`ViewDidLoad`.

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSString* pdfFileName = [self getPDFFileName];

 NSMutableDictionary *dataDict = [NSMutableDictionary new];
     NSNumber *tripId = (NSNumber *)[Helper getValueForKeyFromGlobalDictionary:TRIP_ID];
     [dataDict setValue:[self retrieveTimings:[tripId intValue]] forKey:NEWTRIP_MO];
     [dataDict setValue:[self retrieveStops:[tripId intValue]] forKey:TIME_MO];
     [dataDict setValue:[self getCompanyInfo:[tripId intValue]] forKey:COMPANY_MO];
     [dataDict setValue:[self getTripInfo:[tripId intValue]] forKey:TRIP_MO];
     [dataDict setValue:[self getDriverInfo:[tripId intValue]] forKey:DRIVERS_MO];
     [dataDict setValue:[self getLoadInfo:[tripId intValue]] forKey:LOAD_MO];
     [PDFRenderer drawPDF:pdfFileName withData:dataDict];

    UIWebView* webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 40, 320, 440)];

    NSURL *url = [NSURL fileURLWithPath:pdfFileName];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [webView setScalesPageToFit:YES];
    [webView loadRequest:request];

    [self.view addSubview:webView];

    self.navigationController.navigationBarHidden=NO;
    // Do any additional setup after loading the view from its nib.
} 
```

它为我工作。希望能帮助到你

# java - Java套接字文件传输线程失败但在我调试时工作

> ID：14532952
> 
> 赞同：0
> 
> 时间：2013-01-26T01:43:30.390
> 
> 标签：java, multithreading, debugging, sockets

我不知道为什么我的程序在调试时工作并且在正常执行中失败。

我已经设置了一个简单的服务器来通过套接字提供文件。当客户端连接时，一个线程开始执行此任务，但它失败了。我收到“套接字已关闭”错误。

这是家庭作业：在我弄清楚为什么会发生这种情况并且只是想朝着正确的方向轻推之前，我无法前进。

为了让它在调试中工作，我在它接受客户端连接的服务器类中设置了断点。

提前致谢。

```
public class File_Server {

    private static ServerSocket servsock;

    public static void main(String[] args) throws IOException 
    {
        // create socket
    try {
        servsock = new ServerSocket(4444);
    } catch (Exception e) {
        System.out.println("Port already in use.");
        System.exit(1);
    }

    while (true) {
        System.out.println("Waiting...");
        try (Socket sock = servsock.accept()) {
            System.out.println("Accepted connection : " + sock);

            Thread t = new Thread(new CLIENTConnection(sock));

            t.start();

        } catch (Exception e) {
            System.out.println("Cannot accept connection.");
            }
        }
    }
}

public class CLIENTConnection implements Runnable {

    private Socket client;

    CLIENTConnection(Socket client) {
        this.client = client;
    }

    @Override
    public void run() 
    {
        try {
            FileInputStream fis = null;         
            // sendfile
            File myFile = new File("studentData.txt");
            byte[] mybytearray = new byte[(int) myFile.length()];
            fis = new FileInputStream(myFile);
            BufferedInputStream bis = new BufferedInputStream(fis);
            bis.read(mybytearray, 0, mybytearray.length);
            OutputStream os = client.getOutputStream();
            System.out.println("Sending...");
            os.write(mybytearray, 0, mybytearray.length);
            os.flush();
            fis.close();
        } catch (IOException ex) {
            Logger.getLogger(CLIENTConnection.class.getName()).log(Level.SEVERE, null, ex);
        } 
    }
}

public class File_Client {

    private static long start = System.currentTimeMillis();
    private static int bytesRead;
    private static int current = 0;

    public static void main(String[] args) throws IOException 
    {
        int filesize = 60223861; // filesize temporary hardcoded

        try (Socket sock = new Socket("127.0.0.1", 4444)) {
            System.out.println("Connecting...");

            // receive file
            byte[] mybytearray = new byte[filesize];
            InputStream is = sock.getInputStream();
            FileOutputStream fos = new FileOutputStream("studentData-received.txt");
            try (BufferedOutputStream bos = new BufferedOutputStream(fos)) {
                bytesRead = is.read();//.read(mybytearray, 0, mybytearray.length);
                current = bytesRead;

                do {
                    bytesRead =
                            is.read(mybytearray, current, (mybytearray.length - current));
                    if (bytesRead >= 0) {
                        current += bytesRead;
                    }
                } while (bytesRead > -1);

                bos.write(mybytearray, 0, current);
                bos.flush();
                long end = System.currentTimeMillis();
                System.out.println("Time taken " + (end - start) + " milliseconds");
            }
        } catch (Exception e) {
            System.out.println("Cannot connect to server.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T04:12:03.540

您犯了忽略 read() 结果的常见错误。它返回实际读取的字节数，或在 EOS 处返回 -1。Java中复制流的方法如下：

```
while ((count = in.read(buffer)) >= 0)
{
  out.write(buffer, 0, count);
} 
```

其中'count'是一个int。

# java - 为 PhantomReference 应用程序创建可重复测试

> ID：14532957
> 
> 赞同：0
> 
> 时间：2013-01-26T01:44:10.440
> 
> 标签：java, garbage-collection

考虑一个使用 PhantomReferences 的库来避免终结器，同时确保一些 JNI 资源被释放。

一种体系结构涉及参考队列和在参考队列上执行清理的线程阻塞。

现在来了一个问题：如何对所有这些进行测试？

1.  设置系统
2.  创建感兴趣的对象
3.  让它变成垃圾
4.  系统.gc()
5.  不知何故等待线程醒来，闻咖啡，然后完成工作
6.  断言内部计数器被勾选以证明所有这些都发生了

`Thread.sleep()`对第5 项有效但令人不安。`Thread.yield()`根本不可靠。如果有的话，还有哪些其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T02:33:14.993

假设您正在使用小于 2GB 的堆运行，分配一个刚好小于可用堆大小的字节数组应该会在抛出预期的 OutOfMemoryError 之前立即触发一个完整的 gc：

`byte[] foo = new byte[(int) (Runtime.getRuntime().maxMemory()-1)];`

我不会使字节数组*大于*堆大小，因为在这种情况下，VM 可能会立即抛出 OutOfMemoryError，因为它知道它无论如何都无法提供那么多堆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T04:27:02.737

如果您可以对相关库进行更改，则将一个可选参数传递`BlockingQueue<Reference?>>`给清理代码，以便它可以发出完成信号。如果队列存在，则清理代码在执行清理后将对队列的引用入队。测试代码可以调用`BlockingQueue.poll(timeout)`——清理完成后立即接收引用，或者如果清理没有在您确定的某个合理的上限超时时间内完成，则超时。

# jquery - 当身体高度大于视口高度时隐藏和显示一个div

> ID：14532958
> 
> 赞同：1
> 
> 时间：2013-01-26T01:44:19.337
> 
> 标签：jquery, css

我一直在尝试根据屏幕高度隐藏和显示一个固定的 div。它适用于手机，只要出现滚动条，就会出现 div。这适用于小屏幕。

这是我正在使用的代码

```
$(document).ready(function () {
    if ($("body").height() > $(window).height()) {
        jquery("textdiv").fadeIn(200);
    } else {
        jquery("textdiv").hide(100);
    }
}); 
```

你可以看到我在这个[Jsfiddle](http://jsfiddle.net/NLjqK/)上完成了什么。

如果您还想从我这里得到什么，请告诉我。我确信我使用的代码有一些错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:47:06.280

你所拥有的似乎工作正常，你只是有一些文本错误：

[http://jsfiddle.net/NLjqK/1/](http://jsfiddle.net/NLjqK/1/)

`jquery`->`jQuery`

`textdiv`->`.textdiv`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T01:47:12.577

您正在使用的选择器正在寻找一个`textdiv`明显不存在的标记名。在选择器中为类添加点前缀

```
$(".textdiv").fadeIn(200); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T01:48:58.470

如果您正在寻找响应式设计，那么 css 可能是在 jquery 中做事的更好选择。您可以将媒体查询用作各种属性的“if/else”函数，在您的情况下使用屏幕宽度。请在[此处](http://css-tricks.com/css-media-queries/)阅读。这是一个例子：

```
@media all and (max-width: 699px) and (min-width: 520px), (min-width: 1151px) {
  .yourclass {
    display:none;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T16:56:46.660

如果其他人正在寻找类似的东西，我会进一步研究 Explosion Pills 的答案并添加额外的代码，使代码在调整窗口大小时运行，并且当有人向下滚动到页面底部时 div 消失。

查看下面的代码，然后查看 JS fiddle ......

```
$(window).bind('resize',function () {

    if ($("body").height() > $(window).height()) {
        jQuery(".textdiv").fadeIn(200);
    } else {
        jQuery(".textdiv").hide(100);
    }
});

$(window).scroll(function() {
                if ($("body").height() <= ($(window).height() + $(window).scrollTop())) {
                    $(".textdiv").css("display","none");
                }else {
                    $(".textdiv").css("display","block");
                }
            }); 
```

[http://jsfiddle.net/NWusD/](http://jsfiddle.net/NWusD/)

# ruby - 如何将值保存到 YAML 文件中？

> ID：14532959
> 
> 赞同：49
> 
> 时间：2013-01-26T01:44:43.833
> 
> 标签：ruby, ruby-on-rails-3, yaml

在我的persist.yml 文件中。我有以下键值对...

```
session = 0 
```

如何更新 YAML 文件，以便：

```
session = 2 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-01-26T02:28:07.573

使用 ruby​​-1.9.3（方法可能不适用于旧版本）。

我假设文件看起来像这样（相应地调整代码）：

```
---
content:
    session: 0 
```

并被称为 /tmp/test.yml

那么代码就是：

```
require 'yaml' # Built in, no gem required
d = YAML::load_file('/tmp/test.yml') #Load
d['content']['session'] = 2 #Modify
File.open('/tmp/test.yml', 'w') {|f| f.write d.to_yaml } #Store 
```

# restkit - RestKit - 关系映射

> ID：14532961
> 
> 赞同：1
> 
> 时间：2013-01-26T01:44:48.783
> 
> 标签：restkit

我不知道如何设置这种关系映射：

```
@interface Account : NSManagedObject

@property (strong, nonatomic) NSString *name;
@property (strong, nonatomic) NSNumber accountID;

@property (strong, nonatomic) NSSet *sessions;

@end 
```

.

```
@interface Session : NSManagedObject

@property (strong, nonatomic) NSString *name;
@property (strong, nonatomic) NSNumber sessionID;

@end 
```

JSON 我正在尝试映射...

```
{
    "userSessions": {
        "name" : "Mr. User",
        "identification": 54321,
        "sessions": [
            "418",
            "419",
            "431",
            "441",
            "457",
            "486",
            "504"
        ]
    }
} 
```

Sessions 和 Account 已经是从其他两个 API 调用（getSessions 和 getAccountInfo）正确映射的对象。我很难让两者之间的关系正常工作。数字数组表示`sessionID`s。

这是我目前尝试过的（它崩溃了）：

```
RKEntityMapping *sessionRelationship = [[RKEntityMapping alloc] initWithEntity:sessionEntity];
[sessionRelationship setIdentificationAttributes:@[ @"sessionID" ]];
[sessionRelationship addAttributeMappingFromKeyOfRepresentationToAttribute:@"sessionID"];

RKEntityMapping *accountMapping = [[RKEntityMapping alloc] initWithEntity:accountEntity];
[entityMapping setIdentificationAttributes:@[ @"accountID" ]];
[entityMapping addRelationshipMappingWithSourceKeyPath:@"sessions"
                                                   mapping:sessionRelationship];

NSIndexSet *statusCodes = RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful);
RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:entityMapping
                                                                                   pathPattern:nil
                                                                                       keyPath:@"userSessions"
                                                                                   statusCodes:statusCodes]; 
```

* * *

**编辑：**

按照 Blake 的建议，我使用了 nil 的 sourceKeyPath，但是我仍然遇到了崩溃。

我沿着兔子洞追踪它，坠机发生在

`RKValueForAttributeMappingInRepresentation(RKAttributeMapping *, NSDictionary *)`

...这是因为字典参数实际上是 JSON 数组中的 NSString。

```
(lldb) po attributeMapping
(RKAttributeMapping *) $26 = 0x076c6a00 <RKAttributeMapping: 0x76c6a00 (null) => rec>
(lldb) po representation
(NSDictionary *) $27 = 0x0e4a20c0 431
(lldb) po [representation class]
(id) $28 = 0x01f9b8e4 __NSCFString 
```

堆栈跟踪可以在这里看到： ![Stack Trace](../Images/7fc84bf1e3d7a0b2b0e079ed9d138c55.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T05:24:31.353

You have stumbled across an unhandled case within RestKit's mapping logic. There was a hand-off between layers of the mapping engine that assumed that the representation being passed was an `NSDictionary`, but the caller was not enforcing its part of the contract. I have taken your example JSON and mapping structure and used it to build a unit test in RestKit.

This issue is fixed on the development branch as of [https://github.com/RestKit/RestKit/commit/d761de0ea7cfb11851b714e49ff3126d65ab7b49](https://github.com/RestKit/RestKit/commit/d761de0ea7cfb11851b714e49ff3126d65ab7b49) and will be included in the rc1 version I am going to tag this weekend.

# concurrency - 异步函数

> ID：14532965
> 
> 赞同：1
> 
> 时间：2013-01-26T01:44:59.190
> 
> 标签：concurrency, groovy, gpars

[异步调用](http://www.gpars.org/1.0.0/guide/guide/dataParallelism.html#dataParallelism_asynchronousInvocation)和[可组合异步函数](http://www.gpars.org/1.0.0/guide/guide/dataParallelism.html#dataParallelism_composableAsynchronousFunctions)之间有区别吗？
在第一种情况下使用`async()`or `callAsync()`，在另一种情况下使用`asyncFun()`. 但主要区别在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T05:38:08.330

`asyncFun()`允许组合异步函数，而`async()`不允许。asyncFun()-enhanced 函数返回 Promises 及其所有的花里胡哨，而 async-enhanced 函数返回普通 old `java.util.concurrent.Future`。

`async()`是围绕 Java 的 ExecutorServices 的一个瘦包装器。`asyncFun()`目标更高，并改变了函数的整个签名，包括参数类型。

# ember.js - ember-data 中的 Sideloading 和 sideloadAs

> ID：14532968
> 
> 赞同：0
> 
> 时间：2013-01-26T01:45:47.170
> 
> 标签：ember.js, ember-data

所以，我试图在 ember-data 中侧载记录。我的模型是这样的：

```
App.Product = DS.Model.extend({
     name: DS.attr('string'),
     category_ids: DS.hasMany('App.Category')
});
App.Category = DS.Model.extend({
    title: DS.attr('string')
}); 
```

我正在按如下方式配置侧载功能：

```
App.store.adapter.serializer.configure(App.Category,
    { 
         sideloadAs: 'categories' 
    }); 
```

1.  只要我的字段名称是“category_ids”，它就可以工作。任何其他名称都行不通。有没有办法重命名它并让它继续工作？
2.  由于配置是在资源/模型中完成的，因此在加载产品时似乎没有任何方法可以旁加载类别的记录，而在加载“帖子”时也没有旁加载类别的方法。如果两者都使用相同的类别资源。那正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T03:27:43.727

您也许可以在`adapter`. 不过我不确定。您应该提供代码示例以更好地帮助您。

```
App.store = DS.Store.create({
    revision: 11,
    adapter: DS.RESTAdapter.create( {
        mappings: {
            categories: 'App.Category'
        },
    })
}); 
```

# arrays - 比较groovy中的字节数组

> ID：14532970
> 
> 赞同：0
> 
> 时间：2013-01-26T01:45:56.663
> 
> 标签：arrays, groovy

我在 Groovy 中声明字节数组：

```
def array1 = [-1,5,3] as byte []

def array2 = [-5,2,9] as byte [] 
```

如何根据数组的每个元素是否相同来比较两个数组以返回真/假。

我试过这个，`groovysh`但它一直出错：

```
groovy:000> def array1 = [-1,5,3] as byte[]
===> [B@18e501c
groovy:000> def array2 = [-5,2,9] as byte[]
===> [B@5e860ba9
groovy:000> array1.equals array2
ERROR groovy.lang.MissingPropertyException:
No such property: array1 for class: groovysh_evaluate
        at groovysh_evaluate.run (groovysh_evaluate:2)
        ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T02:11:27.410

这里有几个问题。

首先，您似乎正在使用 groovy shell，通过 'groovysh' 使用 groovysh，在声明变量时必须省略 'def' - 这是 shell 的一个怪癖。

您收到此错误是因为执行后`def array1 = [-1,5,3] as byte[]`，array1 未定义。

其次，equals() 方法在这种情况下不会像您期望的那样运行 - 您将需要使用 '==' 运算符来代替。

这是我得到的：

```
groovy:000> array1 = [-1,5,3] as byte[]
===> [B@1d429498
groovy:000> array2 = [-5,2,9] as byte[]
===> [B@ac1b161
groovy:000> array3 = [-1,5,3] as byte[]
===> [B@5ca3ce3f
groovy:000> array1.equals array2
===> false
groovy:000> array1.equals array3
===> false
groovy:000> array1 == array2
===> false
groovy:000> array1 == array3
===> true 
```

# javascript - jquery根据其他类更改类元素的值

> ID：14532975
> 
> 赞同：0
> 
> 时间：2013-01-26T01:46:47.927
> 
> 标签：javascript, jquery, ruby-on-rails, html-parsing

我有一个页面，其中包含许多相同类型的 div，如下所示。

```
<div class="post_right" data-icon = "arrow-r">
 <p>Posted at:</p>
 <div class="post_time"> 
  <%= post.created_at.strftime("%I:%M %P") %> 
 </div>
 <div class="post_timer"></div>
</div> 
```

我有一个 jquery 脚本，它将从“post_time”类中读取并通过向它添加一个值来更新 post_timer 类。

```
$("document").ready(function() {
    $(".post_timer").each(function(){
    var post_time = $(".post_time").html()
    $(this).html(post_time);
    });     
}); 
```

但是所有“post_timer”类的值都被第一个 post_time 值更新。无论如何，我都可以根据整个页面中相应的“post_time”类值来更新 post_timer 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:48:32.313

你需要得到`$(".post_time")`相同索引的；`.html`否则只会得到第一个（如您所见）。

```
var post_time = $(".post_time").eq($(this).index()).html(); 
```

[http://jsfiddle.net/kVNGN/](http://jsfiddle.net/kVNGN/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:49:03.823

只需将 DOM 遍历到适当的元素。由于在您的示例中，该`.post_time`元素似乎是该元素的前一个兄弟`.post_timer`，您可以使用[`.prev` *^([docs])*](http://api.jquery.com/prev/)：

```
$(".post_timer").html(function() {
    return $(this).prev().html();
    // or more structure independent: 
    // return $(this).siblings('.post_time').html();
}); 
```

jQuery 有更多的[遍历方法](http://api.jquery.com/category/traversing/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T02:05:33.677

```
$("document").ready(function() {
    $(".post_timer").each(function(){
    var post_time = $(this).prev(".post_time").html();
    $(this).html(post_time);
    });     
}); 
```

# java - 使用 Java 7 或 Java 6 生成随机 UUID 的性能

> ID：14532976
> 
> 赞同：18
> 
> 时间：2013-01-26T01:46:57.770
> 
> 标签：java, uuid

我有一个基于 Web 的 Java 应用程序，它为会话信息生成随机 UUID。我们的一位测试人员声称根据他自己的分析生成 UUID 最多需要 350 毫秒，但我还没有能够复制他的结果。他指向这篇文章[http://www.cowtowncoder.com/blog/archives/2010/10/entry_429.html](http://www.cowtowncoder.com/blog/archives/2010/10/entry_429.html)来帮助支持他的结果。我想看看是否有其他人在 Java 6 或 Java 7 应用程序中使用 Java 内置的 UUID 生成功能遇到了这个限制。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-02-04T00:50:40.877

这是 [](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_8) beta 127 中的测试运行。

请记住，这个测试是*不切实际*的，超出了我能想象的任何最坏的情况。我的目标是平息那些在没有事实支持他们批评的情况下使用[UUID的人。](https://en.wikipedia.org/wiki/Universally_unique_identifier)

设想：

*   一百万次调用的紧密循环[`java.util.UUID.randomUUID()`](http://download.java.net/jdk8/docs/api/java/util/UUID.html)
    *   仅此一项测试。（没有争议）
    *   一项有争用的测试，其中 2 个其他线程处于紧密循环中，进行*1000*万次调用。
*   Java 8 测试版 127
    *   java版本“1.8.0”
    *   Java(TM) SE 运行时环境（内部版本 1.8.0-b127）
    *   Java HotSpot(TM) 64 位服务器 VM（内部版本 25.0-b69，混合模式）
*   从 Netbeans 7.4 IDE 运行
*   在虚拟机中执行
    *   [Parallels 9](http://www.parallels.com/)虚拟机
    *   [山狮](https://en.wikipedia.org/wiki/OS_X_Mountain_Lion)
    *   3个虚拟核心
    *   4 场演出记忆
*   [Mac mini](https://en.wikipedia.org/wiki/Mac_Mini#Unibody_Mac_Mini)（2012 年末）
    *   [小牛队](https://en.wikipedia.org/wiki/OS_X_Mavericks)
    *   [Intel i7](https://en.wikipedia.org/wiki/Intel_i7#Core_i7_2)四核超线程（8 个明显核心）
    *   16 场演出记忆

# 无争

在一个线程中运行一个循环，因此不会争用同步的方法/类。

```
// Warm the random generator.
java.util.UUID uuid;
uuid = java.util.UUID.randomUUID();

long stop = 0;
long start = System.nanoTime();

int loops = 1000000;  // One million.
for ( int i = 0; i < loops; i++ ) {
    uuid = java.util.UUID.randomUUID();
}

stop = System.nanoTime();

long elapsed = ( stop - start );

System.out.println( "UUIDs: " + loops );
System.out.println( "Nanos: " + elapsed );
System.out.println( "Nanos per uuid: " + ( elapsed / loops ) + " ( micros per: " + ( elapsed / loops / 1000 ) + " )" ); 
```

## 结果

每个 UUID大约**2 微秒。**

# 有争议

与上面类似，但是在执行一百万次调用的循环时，我们有两个其他线程在运行，每个线程都进行*一*千万次调用。

```
// Warm the random generator.
java.util.UUID uuid;
uuid = java.util.UUID.randomUUID();

int pass = 10_000_000 ;  // Ten million.
MyThread t1 = new MyThread( pass );
MyThread t2 = new MyThread( pass );

t1.start();
t2.start();
t3.start();

long stop = 0;
long start = System.nanoTime();

int loops = 1_000_000 ;  // One million.
for ( int i = 0; i < loops; i++ ) {
    uuid = java.util.UUID.randomUUID();
}

stop = System.nanoTime();

long elapsed = ( stop - start );

System.out.println( "UUIDs: " + loops );
System.out.println( "Nanos: " + elapsed );
System.out.println( "Nanos per uuid: " + ( elapsed / loops ) + " ( micros per: " + ( elapsed / loops / 1000 ) + " )" ); 
```

以及定义每个线程的类……</p>

```
class MyThread extends Thread {

    private int loops;

    public MyThread( int loops ) {
        this.loops = loops;
    }

    @Override
    public void run() {
        java.util.UUID uuid;
        for ( int i = 0; i < this.loops; i++ ) {
            uuid = java.util.UUID.randomUUID();
        }

    }
} 
```

## 结果

每个 UUID大约**20 微秒。**

每个 UUID 的运行时间分别为 14、20、20、23 和 24 微秒（不按此顺序）。因此，在极端竞争下仅差 10 倍左右，在我所知道的任何实际使用中，20 微秒都是可以接受的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-26T02:54:23.840

UUID 的随机形式通常使用“密码强度”随机数的来源。

（如果没有，那么所谓的随机 UUID 将是可预测的，并且重新发布给定 UUID 的概率可能会增加到令人担忧的水平。正如另一个答案所暗示的那样，您可以为`UUID`构造函数提供一个快速（但较弱）的 PRNG。但那将是一个坏主意。）

典型的加密强度随机数生成器使用应用程序外部的熵源。它可能是一个硬件随机数生成器，但更常见的是，它是操作系统在正常操作中收集的累积“随机性”。问题是熵的来源有一个速率限制。如果您在一段时间内超过该速率，则可以耗尽源。接下来发生的事情取决于系统，但在某些系统上，读取熵的系统调用将停止......直到有更多可用。

我希望这就是您客户系统上正在发生的事情。（这在虚拟机上并不少见......）

一个 hacky 解决方法（对于 Linux 系统）是安装`rngd`守护程序并将其配置为使用良好的伪随机数生成器“充值”熵池。安全专家会指出：

*   这将影响您的 UUID 生成器的随机性，并且
*   熵池用于其他与安全相关的事物，因此从可疑来源对其进行充值会削弱系统上许多事物的安全性。

我不确定这种黑客在实践中的安全性。

这是关于慢速随机数生成主题的另一个问答：

*   [如何处理缓慢的 SecureRandom 生成器？](https://stackoverflow.com/questions/137212/how-to-solve-slow-java-securerandom)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-01-26T05:19:20.323

我测试了它

```
 for (;;) {
        long t0 = System.currentTimeMillis();
        for (int i = 0; i < 1000000; i++) {
            UUID.randomUUID();
        }
        System.out.println(System.currentTimeMillis() - t0);
    } 
```

在我的电脑上大约是 1100 毫秒，这很慢。UUID.randomUUID() 在内部使用 SecureRandom，为了使其更快，我们可以使用常规 java.util.Random

```
 Random r = new Random();
    for (;;) {
            ..
            new UUID(r.nextLong(), r.nextLong()); 
```

大约 80 毫秒

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-03-07T12:43:02.313

线程的数量对 UUID 的生成性能有巨大的影响。这可以通过查看`SecureRandom#nextBytes(byte[]`生成随机数的实现来解释`UUID.randomUUID()`：

```
synchronized public void nextBytes(byte[] bytes) {
    secureRandomSpi.engineNextBytes(bytes);
} 
```

`nextBytes`当被`synchronized`不同的线程访问时，这会导致显着的性能损失。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-07T18:38:23.697

## 使用版本 1 而不是 4

使用版本 1 类型的 UUID 怎么样？

[版本 1](https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_1_.28MAC_address.29)基于[MAC 地址](https://en.wikipedia.org/wiki/MAC_address)和当前时间（“空间和时间”）。与版本 4 相比，发生冲突的可能性要小得多。

[版本 4](https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29)完全基于使用加密强随机生成器从随机数生成。

Oracle JVM 不提供版本 1 生成器，显然是出于安全和隐私问题。JVM 不提供对主机 MAC 地址的访问。

## 壶库

至少有一个第三方库可以提供版本 1 UUID 以及其他版本：[JUG – Java UUID Generator](http://wiki.fasterxml.com/JugHome)。他们说 Java 6 中引入的特性让他们可以访问 MAC 地址。

## 测试结果：20 倍

阅读2010 年文章“[更多关于 Java UUID 生成器 (JUG)，关于性能的词”中关于](http://www.cowtowncoder.com/blog/archives/2010/10/entry_429.html)使用*Java UUID 生成器版本 3*的测试结果的讨论。Tatu Saloranta 在他的 MacBook 上测试了各种 UUID。

结果：MAC+Time 版本比随机版本快 20 倍。

> 基于时间的变体（以太网地址加上时间戳）要快得多——几乎是**基于随机的**默认变体的 20 倍——每秒生成约 500 万个 UUID。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-07T16:35:40.270

在 jdk 1.7.0_40 下运行的 junit 测试：

```
package org.corba.util;

import org.junit.Test;
import org.springframework.util.StopWatch;

import java.util.UUID;

/**
 * Test of performance of Java's UUID generation
 * @author Corba Da Geek
 * Date: 1/6/14
 * Time: 3:48 PM
 */
public class TestRandomUUID {
    private static final int ITERATIONS = 1000000;

    @Test
    public void testRandomUUID() throws Exception {
        // Set up data
        StopWatch stopWatch = new StopWatch();
        stopWatch.start();

        // Run test
        for (int i = 0; i < ITERATIONS; i++)
            UUID.randomUUID();

        // Check results
        stopWatch.stop();
        final long totalTimeMillis = stopWatch.getTotalTimeMillis();
        System.out.println("Number of milliseconds: " + totalTimeMillis + " for " + ITERATIONS + " iterations.");
        System.out.println(String.format("Average time per iteration: %.7f ms", (float)totalTimeMillis/ITERATIONS));
    }
} 
```

我的 i5 笔记本电脑上的结果是：

```
-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.corba.util.TestRandomUUID
Number of milliseconds: 677 for 1000000 iterations.
Average time per iteration: 0.0006770 ms
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.746 sec

Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 
```

**每次调用 0.0006770 毫秒**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-13T14:32:05.350

我和其他人做了同样的测试，**我的结果更像是 300 NANOseconds per UUID generation**。结果在 i7 四核 WIN7 64 PC 上。我尝试使用 jdk1.7.0_67 和 jdk1.8.0_40 64 位 JVM。

我有点困惑，我的结果与其他所有结果都如此不同......但是生成随机数的 1 毫秒似乎很多！

```
public static void main(String[] args) throws Exception {
    long start = System.nanoTime();
    int loops = 1000000; // One million.

    long foo = 0;

    for (int i = 0; i < loops; i++) {
        UUID uuid = java.util.UUID.randomUUID();

        //this is just to make sure there isn't some kind of optimization
        //that would prevent the actual generation
        foo += (uuid.getLeastSignificantBits()
                + uuid.getMostSignificantBits());
    }

    long stop = System.nanoTime();

    long elapsed = (stop - start);

    System.out.println(String.format("UUIDs              : %,d", loops));
    System.out.println(String.format("Total time (ns)    : %,d", elapsed));
    System.out.println(String.format("Time per UUID (ns) : %,d", (elapsed / loops)));

    System.out.println();
    System.out.println(foo);
} 
```

输出 ：

```
UUIDs              : 1 000 000
Total time (ns)    : 320 715 288
Time per UUID (ns) : 320

5372630452959404665 
```

# c++ - C++ - 将哈希表复制到另一个哈希表

> ID：14532979
> 
> 赞同：2
> 
> 时间：2013-01-26T01:47:06.537
> 
> 标签：c++, pointers, linked-list, hashtable

我试图通过将当前哈希表的元素复制到另一个哈希表来“重新调整”哈希表的大小，更改第一个哈希表的大小并将元素复制回来。顺便说一句，当从第一个复制到第二个时，使用第二个哈希表的大小重新计算元素的位置。

我的问题是第二个哈希表甚至没有打印第二个哈希表。

这是我的代码：

```
void intHashTable::rehash(int size){

new_table = true;

cout<< "REHASH "<< endl;
//table1 is the second/temporary hash-table
//with the size of the new hash-table
table1 = new Node*[size];
//counter is reset
number_of_elements = 0;
int temp;
//Runner is used to traverse table1
Node * runner2;

//set the nodes to null
for ( int i = 0; i < size; i++ ) {
    table1[i] = NULL;
}
//
for ( int i = 0; i < prev_size; i++ ) {
    Node * runner = table[i];
    while(runner != NULL){
        temp = runner->num;
        cout<<"temp: "<<runner->num<<"\n";
        //get new location
        int location = ((unsigned)temp) % size;
        cout<<"location: "<<location<<"\n";
        //store in new location
        runner2 = table1[location];
        runner2 = new Node(temp);
        cout<<runner2->num<<"\n";
        runner = runner->next;
        runner2 = runner2->next;
    }
}

//print out second/temporary hash-table
for(int i =0; i < size; i++){
    Node *runner  = table1[i];
    cout<< i << ". ";
    while(runner != NULL){
        cout<< runner->num << " ";
        runner = runner->next;
    }
    cout<<endl;
}
//re-sizing original table
table = new Node*[size];
cout<< "New size " <<size<<endl;

for ( int i = 0; i < size; i++ ) {
    table[i] = NULL;
}
//copying the second/temp back to the first/original
for ( int i = 0; i < size; i++ ) {
   Node * runner = table1[i];
    while(runner != NULL){
        temp = runner->num;
        Node * runner2 = table[i];
        runner2 = new Node(temp);
        cout<<runner2->num<<"\n";
        runner = runner->next;
        runner2 = runner2->next;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T02:15:42.613

快速浏览了一下。错误之一是：

runner2 = table1 [位置]；// runner2 变为 NULL
runner2 = new Node(temp); // runner2 现在包含指向节点的指针，但您的 table1[location] 仍然为 NULL。

你的链接列表逻辑也是错误的。您的节点未连接。您应该执行以下操作： runner->next = new Node(temp);

本质上，您需要在整个 while(runner != NULL) 逻辑上工作。

# sql-server - MERGE 不断尝试插入 null

> ID：14532982
> 
> 赞同：1
> 
> 时间：2013-01-26T01:47:38.470
> 
> 标签：sql-server, sql-server-2012-express

当我运行它时，我不断得到：

> *消息 515，级别 16，状态 2，第 8 行
> 无法将值 NULL 插入列“uNSID”，表“Flickr.dbo.User_Grps”；列不允许空值。更新失败。
> 该语句已终止。*

这是我的 SQL 语句：

```
MERGE 
INTO User_Grps as ug
USING [ExcImport-S2 (3)] as i
ON (    
    ug.uNSID = i.uNSID
    and ug.prime_ID = i.prime_ID
    and  i.uNSID is not null
    )
WHEN MATCHED and i.uNSID is not null THEN

    UPDATE SET ug.uNSID = i.uNSID
        ,   ug.gNSID = i.gNSID
        ,   ug.gAlias = isnull(i.gAlias,ug.gAlias) 
        ,   ug.Prime_ID = i.Prime_ID

 WHEN NOT MATCHED THEN  
        INSERT (uNSID
            ,   gNSID
            ,   gAlias
            ,   Prime_ID
                )
                VALUES (i.uNSID
            ,   i.gNSID
            ,   i.gAlias
            ,   i.Prime_ID
                );
GO 
```

我需要做些什么来阻止它吸入空记录？

另外，我将如何配置计数器以便最后我可以得到类似的东西`Updated x,xxx records & added xxx`？

编辑添加 --------------

@Kevin：这是我修改后的代码，因为我理解了您的回复。

当我按原样运行它时，我收到以下错误：

```
Msg 102, Level 15, State 1, Line 2  Incorrect syntax near '$ACTION'.
Msg 137, Level 15, State 1, Line 5  Must declare the scalar variable "@InsertCount".
Msg 1087, Level 15, State 2, Line 9 Must declare the table variable "@RowCounts". 
```

当我注释掉行之间的部分时`-- ############################################`
，我收到以下错误：
`Msg 2627, Level 14, State 1, Line 13 Violation of PRIMARY KEY constraint 'PK_User_Grps'. Cannot insert duplicate key in object 'dbo.User_Grps'. The duplicate key value is (GT10464608)`

```
SET NOCOUNT ON ;

DECLARE @RowCounts TABLE
        (
            MergeAction NVARCHAR(10)
        ) ;

DECLARE @InsertCount INT ,
                @UpdateCount INT;

Merge 
into User_Grps as ug
using [ExcImport-S2] as i
on (    
    ug.uNSID = i.uNSID
    and ug.prime_ID = i.prime_ID
    and  i.uNSID is not null
    )
WHEN MATCHED THEN

    UPDATE SET ug.gNSID = i.gNSID
        ,   ug.gAlias = isnull(i.gAlias,ug.gAlias) 
        ,   ug.last_ud = GETDATE ( )

 WHEN NOT MATCHED THEN  
    --      UPDATE SET @i += 1;
        INSERT (uNSID
            ,   gNSID
            ,   gAlias
            ,   Prime_ID
            ,   Last_UD
                )
                VALUES (i.uNSID
            ,   i.gNSID
            ,   i.gAlias
            ,   i.Prime_ID
            ,   GETDATE ( )
                );

    -- ############################################
 OUTPUT 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T02:39:48.600

从更新中删除您已经匹配的字段，无需这样做，因为它们已经相同。

您可以在之前添加这样的内容：

```
SET NOCOUNT ON ;

DECLARE @RowCounts TABLE
    (
      MergeAction NVARCHAR(10)
    ) ;

DECLARE @InsertCount INT ,
    @UpdateCount INT; 
```

然后在合并后立即执行此操作：

```
 OUTPUT
        $ACTION
        INTO @RowCounts ;

SELECT  @InsertCount = [INSERT] ,
        @UpdateCount = [UPDATE]
FROM    ( SELECT    MergeAction ,
                    1 AS ROWS
          FROM      @RowCounts
        ) P PIVOT
( COUNT(ROWS) FOR MergeAction IN ( [INSERT], [UPDATE] ) ) AS PVT ; 
```

这会给你你的行数。

编辑：

有关 OUTPUT 子句的更多信息的链接[http://sqlblog.com/blogs/adam_machanic/archive/2009/08/24/dr-output-or-how-i-learned-to-stop-worrying-and-love-the -merge.aspx](http://sqlblog.com/blogs/adam_machanic/archive/2009/08/24/dr-output-or-how-i-learned-to-stop-worrying-and-love-the-merge.aspx)

整个shebang：

```
SET NOCOUNT ON ;

DECLARE @RowCounts TABLE
        (
            MergeAction NVARCHAR(10)
        ) ;

DECLARE @InsertCount INT ,
                @UpdateCount INT;

Merge 
into User_Grps as ug
using [ExcImport-S2] as i
on (    
    ug.uNSID = i.uNSID
    and ug.prime_ID = i.prime_ID
    and  i.uNSID is not null
    )
WHEN MATCHED THEN

    UPDATE SET ug.gNSID = i.gNSID
        ,   ug.gAlias = isnull(i.gAlias,ug.gAlias) 
        ,   ug.last_ud = GETDATE ( )

 WHEN NOT MATCHED THEN  
    --      UPDATE SET @i += 1;
        INSERT (uNSID
            ,   gNSID
            ,   gAlias
            ,   Prime_ID
            ,   Last_UD
                )
                VALUES (i.uNSID
            ,   i.gNSID
            ,   i.gAlias
            ,   i.Prime_ID
            ,   GETDATE ( )
                )
            OUTPUT
            $ACTION
            INTO @RowCounts ;

    SELECT  @InsertCount = [INSERT] ,
            @UpdateCount = [UPDATE]
    FROM    ( SELECT    MergeAction ,
                        1 AS ROWS
              FROM      @RowCounts
            ) P PIVOT
    ( COUNT(ROWS) FOR MergeAction IN ( [INSERT], [UPDATE] ) ) AS PVT ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T02:25:38.770

从[Microsoft](http://technet.microsoft.com/en-us/library/bb522522%28v=sql.105%29.aspx)，您应该`and i.uNSID is not null`从您的`ON`条款中删除您的，并将其保留在您的`WHEN`条款中。这使我假设您需要将其添加到您的其他`WHEN`子句以解决错误：

```
WHEN NOT MATCHED and i.uNSID is not null THEN 
```

以下是 MS 的一些相关说明：

> 仅在 ON 子句中指定用于确定源表和目标表中的数据匹配条件的搜索条件。也就是说，仅指定目标表中与源表的对应列进行比较的列。
> 
> 在相应的 WHEN 子句中指定行过滤的搜索条件。例如，WHEN NOT MATCHED AND S.EmployeeName LIKE 'S%' THEN INSERT....
> 
> 在返回过滤行的源或目标上定义一个视图，并将该视图作为源表或目标表引用。如果在目标表上定义了视图，则针对它的任何操作都必须满足更新视图的条件。有关使用视图更新数据的更多信息，请参阅通过视图修改数据。

如果这不能解决问题，他们网站上的另一个建议是使用视图而不是表，并在那里添加您的 NULL 标准。

希望这可以帮助。

祝你好运。

# python - TypeError: cannot concatenate 'str' and 'int' objects 有人可以帮助新手编写代码吗？

> ID：14532984
> 
> 赞同：0
> 
> 时间：2013-01-26T01:47:43.410
> 
> 标签：python, python-2.7

任何帮助表示赞赏，还有任何大的缺陷或您在格式化或基本的方式中看到的东西，请指出。谢谢！

```
day = raw_input("How many days?")
locations = raw_input("Where to?")
days = str(day)
location = str(locations)
spendingMoney = 100

def hotel(days):
    return 140 * days

def destination(location):
    if location == "los angeles":
        return 300
    if location == "boston":
        return 400

def rental(days):
    if days < 2:
        return 40 * days
    if days >= 2 and days <= 6:
        return days * 30
     if days >= 7:
        return days * 25

def total_cost(days, location):
    return hotel(days) + destination(location) + rental(days)

print total_cost(days, location) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:53:31.683

首先要了解的是它`raw_input`返回一个字符串，因此之后无需将结果转换为字符串。

您想要的（我认为）是转换`day`为`int`，因此您需要更改顶部。

```
day = raw_input("How many days?")
location = raw_input("Where to?")
days = int(day)
spendingMoney = 100 
```

在您的原始代码中，`days`是一个字符串，因此您试图将一个字符串添加到整数（这引发了错误）。

将字符串乘以整数是完全有效的，因为它只是将原始字符串重复多次。

```
print 'foobar' * 5
# foobarfoobarfoobarfoobarfoobar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T01:55:16.140

问题是那`days`是一个字符串。

当你这样做时

```
return 140 * days 
```

它实际上将你的字符串乘以 140。所以如果`days`== "5" 你将有 "555555555555555555..." （140 个字符）

你想用整数运算，所以 `days = int(day)`改为

# jquery - 如何使用 jQuery 或 jqPlot 自定义 PrimeFaces 条形图属性

> ID：14532986
> 
> 赞同：0
> 
> 时间：2013-01-26T01:47:46.117
> 
> 标签：jquery, primefaces, jqplot, bar-chart

我正在使用[PrimeFaces](http://primefaces.org/) 3.2。如果我正在使用下面的[XHTML](http://en.wikipedia.org/wiki/XHTML)文件并希望将 barChart 图例位置自定义到外部网格并使用自定义消息在工具提示中进行修改，我如何编写仍然从 View1.chartModel bean 检索数据系列值的代码？

我正在寻找实际的代码和步骤...

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f ="http://java.sun.com/jsf/core"
    xmlns:h ="http://java.sun.com/jsf/html"
    xmlns:p ="http://primefaces.org/ui">

    <h:head>
        <h:outputStylesheet name="style.css" library="css"/>
        <meta http-equiv="refresh"
              content="#{session.maxInactiveInterval};url=timeout.xhtml" />
    </h:head>

    <h:body>
        <p:ajaxStatus onstart="statusDialog.show();"
                      onsuccess="statusDialog.hide();"/>
        <p:dialog modal="false"
                  widgetVar="statusDialog"
                  header="Status"
                  draggable="false"
                  closable="false">
            <p:graphicImage value="/images/ajaxloadingbar.gif" />
        </p:dialog>

        <h:form id="ViewRep"
                style="padding:10px;">
            <p:growl id="messages"
                     showDetail="true"/>
            <p:growl id="growl"
                     showDetail="true"/>

            <div style="position:absolute;left:310px;top:620;width:920;height:360px;">

            <p:panel  id="pnl1"
                      header"Trend"
                      style="width:920;height:360px;"
                      toggleable="true"
                      closable="true"
                      toggleSpeed="500"
                      closeSpeed="500"
                      widgetVar="panel1">
                <p:barChart id="BarChart1"
                            value="#{View1.chartModel}"
                            widgetVar="bar1"
                            legendPosition="n"
                            barPadding="5"
                            barMargin="10"
                            style="width:98%;height:300px;" />
                </p:panel>
            </div>
        </h:form>
    </h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T09:36:06.390

我更喜欢更新您的 PrimeFaces 版本，然后您应该使用扩展程序，但如果您不想更新，您可以在页面加载时运行 JavaScript 代码。使用**plot**对图表进行更改。

图例位置的示例：

*   首先，您应该在图表组件上设置**widgetVar="barChart" ：**

    ```
    <p:barChart id="basic" value="#{chartBean.categoryModel}" widgetVar="barChart"
                title="Basic Bar Chart" min="0" max="200" style="height:300px"/> 
    ```

*   然后在页面加载时编写此 JavaScript 代码。

    函数重绘图表（）{ barChart.plot.legend.location="se"; barChart.plot.redraw(); }

或在需要时调用**redrawChart() 。**

祝你好运！

# php - 在 htaccess 中禁用 php 函数

> ID：14532987
> 
> 赞同：3
> 
> 时间：2013-01-26T01:47:46.960
> 
> 标签：php, .htaccess, apache

我正在尝试创建一个流行网站的私人克隆，它提供了“在线编写 php 代码”作为个人练习的可能性。

*   我在文本区域写了一些代码
*   代码以某种方式在服务器端执行
*   返回输出

我希望输出与由 apache 实例提供的输出完全相同，并生成所有错误并警告我的代码。

有一个为网站网页提供服务的现有框架（前端控制器、orm 等），所以我不能在 PHP INI 中使用禁用功能。否则一切都将无法使用。

我尝试将输入保存在文件中，然后使用如下所示的 exec 运行它：

```
exec("php -c mycustomphpinifile input.php 2>&1 > output.txt"); 
```

但是输出的错误与apache的错误不同。

我尝试采用的最终解决方案是使用 httpd.conf 或 .htaccess 中的 php_value 或 php_admin_value 来禁用整个危险函数列表（如您所想）。

然而...

```
php_value disable_functions "my,functions,comma,separated" 
```

不适用于看起来如此大的列表。我必须禁用类似 2k 的功能：htaccess 中的 php_value 是否存在缓冲区大小问题？任何人都可以猜出这个问题的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T02:03:16.210

根据[PHP 文档](http://php.net/manual/en/ini.core.php#ini.disable-functions)，您不能`disable_functions`在文件中以外的任何地方使用该设置`php.ini`，所以我很惊讶这完全有效。

如果您需要对函数进行 per-vhost 或 per-directory 限制，我建议使用单独的[PHP-FPM](http://php-fpm.org/)实例，每个实例都可以有自己的`php.ini`. 它还提供额外的安全优势，例如每个守护程序实例的完整沙盒。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-26T01:57:52.300

这不能在`.htaccess`. 更多信息[在这里](https://stackoverflow.com/questions/7810975/disable-php-functions-via-htaccess)。

但它似乎可以通过这种方式完成。请参阅说明“在 public_html 中的 .htaccess 中添加以下内容：”的[部分](http://wiki.elxis.org/wiki/PHP_settings)：

```
php_flag short_open_tag Off
php_flag register_globals Off
php_flag display_errors Off
php_flag magic_quotes_gpc Off
php_value date.timezone "Europe/Athens"
php_value session.save_path "/absolute/path/to/writable/folder/one_level_up_of/public_html" 
```

请注意它在哪里指出：

> php_value disable_functions "系统、exec、passthru、shell_exec、suexec、dbmopen、popen、proc_open、disk_free_space、diskfreespace、set_time_limit、leak"

以及关于此的脚注：

> 这些设置只能通过默认的 php.ini 文件进行更改，如果没有根据需要进行配置并且您没有访问 php.ini 的权限，请联系您的托管服务提供商为您设置！

**编辑：** 另外，您是否有权访问实际的 Apache2 虚拟主机配置？如果是这样，那么您可能想研究如何使用`suhosin.executor.func.blacklist`；[看到这个页面](http://www.webhostingtalk.com/showthread.php?t=623944)。似乎这是在每个主机/域的基础上禁用 PHP 功能的更好方法。也许甚至 per `<Directory>`or `<Location>`?

```
<VirtualHost 127.0.0.1>
ServerAlias www.test.com
ServerAdmin webmaster@test.com
DocumentRoot /home/test/public_html

php_admin_value suhosin.executor.func.blacklist "passthru, show_source, shell_exec, system, pcntl_exec, popen, pclose, proc_open, proc_nice, proc_terminate, proc_get_status, proc_close, leak, apache_child_terminate, posix_kill, posix_mkfifo, posix_setpgid, posix_setsid, posix_setuid, escapeshellcmd, escapeshellarg"

</VirtualHost> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-28T13:06:40.493

您需要在文件或文件中使用`php_admin_value`而不是`php_value``vhost.conf``.htaccess`

```
<Directory /your/application/dir>
    AllowOverride None
    DirectoryIndex index.html index.htm index.php
    php_flag log_errors on
    php_flag display_errors off
    php_value error_reporting 3
    php_value memory_limit 128M
    php_admin_value upload_tmp_dir "/your/application/dir/imagecache"
    php_value max_execution_time 10
    php_admin_value disable_functions "exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source"
</Directory> 
```