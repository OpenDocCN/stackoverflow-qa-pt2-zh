# StackOverflow 问答 14095000-14095999

# php - CKEDITOR 链接问题

> ID：14095000
> 
> 赞同：0
> 
> 时间：2012-12-30T21:47:58.927
> 
> 标签：php

我在我的小型 CMS 中使用 CKEDITOR。

当我使用本地链接功能时，它工作正常。但是我一上网，并试图建立一个链接 mysql_real_escape_string(); 搞砸了，我得到如下链接：

```
<a href=\"\\\" target=\"\\&quot;_blank\\&quot;\">Se beautyPopup p&aring; gitHub</a> 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:03:04.950

您看到的问题是因为您正在使用`mysql_real_escape_string`转义 HTML 输出。那不是它的用途。这是为了逃避进入数据库的数据。

您正在寻找的是：[`htmlspecialchars()`](http://php.net/manual/en/function.htmlspecialchars.php). 也不要忘记传递编码。这方面的一个例子是：

```
echo htmlspecialchars($yourString, ENT_QUOTES, 'UTF-8'); 
```

另请注意，如果您正在编写新代码，`mysql_*`无论如何都不鼓励您在 PHP 中使用旧 API，因为它已被[弃用](https://wiki.php.net/rfc/mysql_deprecation)。

*更新*

根据您的评论，我看到您正在尝试保留一些标签，同时禁止其他标签。在这种情况下，我只能建议您查看[HTML Purifier](http://htmlpurifier.org/)。

# 3d - LWJGL 确定屏幕上 3D 对象的位置

> ID：14095001
> 
> 赞同：0
> 
> 时间：2012-12-30T21:48:11.247
> 
> 标签：3d, 2d, computational-geometry, trigonometry, lwjgl

快速提问（也许是这样）。是否可以有效地计算 3D 顶点的 (x,y) 位置？例如，我有一个大小为 1x1x1 的立方体，位于原点 (0,0,0)。当它在屏幕上时，立方体的 8 个顶点在屏幕上的坐标是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T09:57:41.073

是的。只需将您的 3d 向量与视图矩阵相乘，并在透视投影的情况下除以齐次坐标。有关数学细节，请参阅 Wikipedia on [3D projection 。](http://en.wikipedia.org/wiki/3D_projection)它还提供了矩阵的分解，因此如果您愿意，您不需要处理矩阵。

# ruby - 值或“默认”

> ID：14095004
> 
> 赞同：3
> 
> 时间：2012-12-30T21:48:26.490
> 
> 标签：ruby

> **可能重复：**
> [在 nil 的情况下分配一个替代值](https://stackoverflow.com/questions/1736408/assigning-a-substitute-value-in-case-of-nil)

在 Lua 中我使用

```
x = value or "default_if_value_is_nil" 
```

（作为 的快捷方式`if value ~= nil then x = value end`）

我可以在 Ruby 中做类似的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T21:49:56.200

```
x = value || "default_if_value_is_nil_or_false" 
```

请注意这里的“或错误”，尽管在 Lua 中也可能如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T21:51:45.403

你实际上可以在 ruby​​ 中做同样的事情

```
x = nil_value || "default" 
```

请注意，这也适用于任何其他“虚假”值

```
x = false_value || "default" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T23:56:31.873

```
x = value or "default_if_value_is_nil" 
```

是一个完全合法的 Ruby 语句，但请注意它`or`在运算符优先级中具有最低优先级之一。还要知道，在 Ruby 布尔运算中，除了 false 和 nil 之外，一切都是 true，因此即使 value 不是 nil 而是 false，这个 Ruby 语句也会回答默认值。

```
puts '>>> assignment = has a higher priority than or <<<'
value = 'y'
x = value or "default_if_value_is_nil"
print 'value=', value.inspect, ', x=', x.inspect, "\n"

value = false
x = value or "default_if_value_is_nil"
print 'value=', value.inspect, ', x=', x.inspect, "\n"

value = nil
x = value or "default_if_value_is_nil"
print 'value=', value.inspect, ', x=', x.inspect, "\n"

puts '>>> put parenthesis around or expression to have a higher priority than = <<<'
value = 'y'
x = (value or "default_if_value_is_nil")
print 'value=', value.inspect, ', x=', x.inspect, "\n"

value = false
x = (value or "default_if_value_is_nil")
print 'value=', value.inspect, ', x=', x.inspect, "\n"

value = nil
x = (value or "default_if_value_is_nil")
print 'value=', value.inspect, ', x=', x.inspect, "\n"

puts '>>> || has a higher priority than = <<<'
value = 'y'
x = value || "default_if_value_is_nil"
print 'value=', value.inspect, ', x=', x.inspect, "\n"

value = false
x = value || "default_if_value_is_nil"
print 'value=', value.inspect, ', x=', x.inspect, "\n"

value = nil
x = value || "default_if_value_is_nil"
print 'value=', value.inspect, ', x=', x.inspect, "\n" 
```

输出：

```
>>> assignment = has a higher priority than or <<<
value="y", x="y"
value=false, x=false
value=nil, x=nil
>>> put parenthesis around or expression to have a higher priority than = <<<
value="y", x="y"
value=false, x="default_if_value_is_nil"
value=nil, x="default_if_value_is_nil"
>>> || has a higher priority than = <<<
value="y", x="y"
value=false, x="default_if_value_is_nil"
value=nil, x="default_if_value_is_nil" 
```

# c# - 如何选择多个名称相似的 XML 子节点

> ID：14095005
> 
> 赞同：2
> 
> 时间：2012-12-30T21:48:29.453
> 
> 标签：c#, xml, asp.net-4.0

这是我的 XML 文件：

```
<hashtable>
  <entry>
    <string>krishna.com</string>
    <hashtable>
      <entry>
        <string>status</string>
        <string>available</string>
      </entry>
      <entry>
        <string>classkey</string>
        <string>domcno</string>
      </entry>
    </hashtable>
  </entry>
  <entry>
    <string>krishna.net</string>
    <hashtable>
      <entry>
        <string>status</string>
        <string>regthroughothers</string>
      </entry>
      <entry>
        <string>classkey</string>
        <string>dotnet</string>
      </entry>
    </hashtable>
  </entry>
</hashtable> 
```

我想通过 krishna.com（节点：哈希表/条目/字符串）查找状态可用（节点：哈希表/条目/哈希表/条目/字符串）。

在这里我的困难是有很多类似的节点名称，例如`string`& `entry`，所以我如何通过检查(string node) 和(string node)`status`来检查域 krishna.com 和 krishna.net 是否可用。`status``available`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:14:37.373

你可以试试这样的

```
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.LoadXml("Path to your .xml file");
XmlNodeList nodeList = xmlDoc.SelectNodes("//entry/string"); 
```

现在您可以编写自己的代码来获取 nodeList 中的信息；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:57:15.653

这是适合您的 XPath 解决方案。

```
using System;
using System.Xml.Linq;
using System.Xml.XPath;

static string GetStatus(XDocument doc, string nodeName)
{
    //The first xpath translates to: "Select the <hashtable> element that immediately
    // follows the <string> element with a value of nodeName."
    //The second xpath selects the <string> element that immediately follows another <string>
    // element with a value of 'status'. This selected element is a descendant of the
    // <hashtable> element that was selected first. 
    XElement status = doc.XPathSelectElement("//hashtable[preceding-sibling::string = '" + nodeName + "']")
                         .XPathSelectElement("descendant::string[preceding-sibling::string = 'status']");
    return status.Value;
} 
```

使用它相当不言自明：

```
XDocument doc = XDocument.Load("File_path_to_XML.xml");
string status = GetStatus(doc, "krishna.com");
// status == "available"
string status2 = GetStatus(doc, "krishna.net");
// status2 == "regthroughothers" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:15:55.323

您可以使用 LINQ to XML 搜索满足指定条件的节点。这是一个示例，用于选择在其子“哈希表”节点下方包含“状态”和“可用”子节点的第一级“条目”节点，如示例的结构中所示：

```
XDocument doc;
using (FileStream fs = new FileStream("XMLFile1.xml", FileMode.Open))
{
   doc = XDocument.Load(fs);
}
string[] elms = doc.Element("hashtable").Elements("entry").Where(elm => 
            elm.Element("hashtable").Element("entry").Elements("string").First().Value == "status" &&
            elm.Element("hashtable").Element("entry").Elements("string").Skip(1).First().Value == "available")
        .Select(elm => elm.Element("string").Value).ToArray(); 
```

如果您的文件结构可能与您提供的示例不同，则需要相应地修改查询

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T22:38:33.967

你可能需要类似的东西：

`//hashtable/entry/string[1][text() = 'krishna.com']"/../hastable/entry/string[1][text() = 'status']"/../string[2][text() = 'available']`

未经测试，但有几点需要注意：

*   `//`表示从任意节点开始
*   `A/B`表示元素 A 下的元素 B
*   `A/B[1]`表示元素 A 下的第一个元素 B
*   `A[text() = 'foo']`表示包含 foo 作为文本值的元素 A
*   `..`表示父节点

如果这不起作用，您总是可以首先找到`hashtable`for krishna.com，然后在`string`节点下的第一个位置找到包含值“status”的`entry`节点，然后确保该节点的唯一兄弟`string`节点是另一个`string`包含“可用的”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T01:00:36.827

这是我的想法：

```
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.Load("your_xml_file.xml");
XmlElement root = xmlDoc.DocumentElement;
string query = "child::entry/child::string[following-sibling::*/descendant::string[text()='available']]";
XmlNodeList nodes = root.SelectNodes(query);
foreach (XmlNode node in nodes)
{
    Console.WriteLine(node.InnerText);
}  
//Result
krishna.com 
```

它将显示“可用”的域名称。
在查询字符串中，“child::entry”将选择根的孩子，称为“entry”。（不是后代）。所以路径是“/hashtable/entry”。
接下来，对于每个“入口”节点，它将选择包含域名的“字符串”子节点。在这一步中，它使用一个表达式来仅选择“可用”的那些。现在路径变为“/hashtable/entry/string”。在表达式中，首先它将选择所有以下兄弟姐妹，并且在您的 xml 中，只有“哈希表”满足条件。最后，对下面所有的兄弟姐妹，我们检查它的后代，如果后代的名字是“string”并且它的内部文本是“available”，然后将选择当前域节点。
希望它有帮助。

# linux - 使用 awk 对齐文本文件中的列？

> ID：14095011
> 
> 赞同：25
> 
> 时间：2012-12-30T21:49:00.310
> 
> 标签：linux, bash, awk

`awk`将“输入”转换为“所需输出”会有用吗？

**输入**

```
testing speed of encryption
test 0 (64 bit key, 16 byte blocks): 2250265 operations in 1 seconds (36004240 bytes)
test 1 (128 bit key, 64 byte blocks): 879149 operations in 1 seconds (56265536 bytes)
test 2 (128 bit key, 256 byte blocks): 258978 operations in 1 seconds (66298368 bytes)
test 3 (128 bit key, 1024 byte blocks): 68218 operations in 1 seconds (69855232 bytes)
test 4 (128 bit key, 8192 byte blocks): 8614 operations in 1 seconds (70565888 bytes)
test 10 (256 bit key, 16 byte blocks): 1790881 operations in 1 seconds (3654096 bytes) 
```

**期望的输出**

```
testing speed of encryption
test  0  (64 bit key,   16 byte blocks): 2250265 operations in 1 seconds (36004240 bytes)
test  1 (128 bit key,   64 byte blocks):  879149 operations in 1 seconds (56265536 bytes)
test  2 (128 bit key,  256 byte blocks):  258978 operations in 1 seconds (66298368 bytes)
test  3 (128 bit key, 1024 byte blocks):   68218 operations in 1 seconds (69855232 bytes)
test  4 (128 bit key, 8192 byte blocks):    8614 operations in 1 seconds (70565888 bytes)
test 10 (256 bit key,   16 byte blocks): 1790881 operations in 1 seconds  (3654096 bytes) 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-30T22:01:28.653

使用右对齐的技巧`column`是使用`rev`：

```
$ head -1 file; tail -n+2 file | rev | column -t | rev
testing speed of encryption
test   0   (64  bit  key,    16  byte  blocks):  2250265  operations  in  1  seconds  (36004240  bytes)
test   1  (128  bit  key,    64  byte  blocks):   879149  operations  in  1  seconds  (56265536  bytes)
test   2  (128  bit  key,   256  byte  blocks):   258978  operations  in  1  seconds  (66298368  bytes)
test   3  (128  bit  key,  1024  byte  blocks):    68218  operations  in  1  seconds  (69855232  bytes)
test   4  (128  bit  key,  8192  byte  blocks):     8614  operations  in  1  seconds  (70565888  bytes)
test  10  (256  bit  key,    16  byte  blocks):  1790881  operations  in  1  seconds   (3654096  bytes) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-12-30T22:01:11.053

是的。查看 awk 的 printf() 函数的语法。缩写示例代码。. .

```
{
  printf("%s %2s ", $1, $2);
  printf("%4s %s %s ", $3, $4, $5);
  printf("%4s %s %s ", $6, $7, $8);
  printf("%7s\n", $9);
} 
```

输出。

```
test  0  (64 bit key,   16 byte blocks): 2250265
test  1 (128 bit key,   64 byte blocks):  879149
test  2 (128 bit key,  256 byte blocks):  258978
test  3 (128 bit key, 1024 byte blocks):   68218
test  4 (128 bit key, 8192 byte blocks):    8614
test 10 (256 bit key,   16 byte blocks): 1790881 
```

[GNU awk 的 printf() 文档](http://www.gnu.org/software/gawk/manual/html_node/Printf.html#Printf)。

有几种方法可以通过未修改的“标题”。这种方式假设它总是在文件的第一行。

```
NR==1 { print $0}
NR>1 {
  printf("%s %2s ", $1, $2);
  printf("%4s %s %s ", $3, $4, $5);
  printf("%4s %s %s ", $6, $7, $8);
  printf("%7s\n", $9);
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-31T07:37:25.037

```
awk '
FNR==1 { if (NR==FNR) print; next }
NR==FNR {
   for(i=1;i<=NF;i++)
      w[i] = (w[i] <= length($i) ? length($i) : w[i])
   next
}
{
   for(i=1;i<=NF;i++)
      printf "%*s",w[i]+(i>1?1:0),$i
   print ""
}
' file file 
```

# asp.net - 通过 WCF 访问数据集而不序列化整个事物？

> ID：14095014
> 
> 赞同：2
> 
> 时间：2012-12-30T21:49:05.823
> 
> 标签：asp.net, wcf, entity-framework

我是 WCF 的新手（和一般的 .NET），所以如果这是常识，我深表歉意。

我正在设计一个 WCF 解决方案（目前使用实体框架来访问数据库）。我想从数据库中获取一组（可能非常大）数据，并将其返回给客户端，但由于性能问题，我不想一次通过网络对整个数据集进行序列化。

我想操作以将某种对象返回给客户端，该对象代表结果数据，我想在客户端处理该数据，能够前后导航并通过根据需要接线。

我不想编写大量客户端代码来单独找出哪些行符合我的搜索条件，然后在我可以提供帮助的情况下单独调用以获取每条记录。我试图让客户尽可能简单。

理想情况下，我想编写类似于以下伪代码的客户端代码：

```
Reference1.Service1Client MyService = new Reference1.Service1Client("Service1");

DelayedDataSet<MyRecordType> MyResultSet = MyService.GetAllCustomers();

MyResultSet.First();

while (!MyResultSet.Eof)
{
    Console.Writeline(MyResultSet.CurrentRecord().CUSTFNAME + " " + MyResultSet.CurrentRecord().CUSTLNAME);
    Console.Writeline("Press Enter to see the next customer");
    Console.Readline();
    MyResultSet.Next();
} 
```

当然，DelayedDataSet 是我刚刚编造的，我希望 .NET 中存在类似的东西。

对 MyService.GetAllCustomers() 的调用将返回此 DelayedDataSet 对象，实际上并不包含实际记录。在调用 CurrentRecord() 之前，实际数据不会通过网络传输。Next() 和 Previous() 将简单地更新服务器端的游标以指向适当的记录。我不希望客户端对数据库或实体框架有任何直接可见性。

我猜我编写代码的方式可能不适用于 WCF，并且 CurrentRecord()、Next()、First() 等函数必须是单独的服务合同操作。我想我只是在寻找一种方法来做到这一点，而不必编写我自己的所有代码来缓存服务器上的结果，以某种方式持久化服务器端的数据集，在我的服务库中编写所有检索和导航代码等.我希望这大部分已经为我完成了。

看起来这将是一个非常普遍需要的功能。那么，这样的事情存在吗？

-乔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T21:52:28.870

不，这不是 WCF 的设计初衷。

在 WCF 中，非常基本的核心体系结构是您有一个客户端和一个服务器，只有 (XML-) 序列化数据在两者之间通过网络传输。

WCF**不是***远程过程调用*方法，也不是某种*远程对象*机制——客户端和服务器之间**没有**连接，除了符合两者之间定义的服务（和数据）协定的序列化消息。

WCF**并非**旨在处理大量数据 - 它旨在处理单个消息（`GetCustomerByID(42)`等等）。由于 WCF 从一开始就被设计为与其他平台（非 .NET，也像 Java、Ruby 等）**互操作**，因此您绝对**不**应该使用重量级的 .NET 特定类型`DataSet`——使用适当的对象。

此外，由于 WCF 最终将所有内容序列化为 XML 并通过线路发送，因此传递的所有数据都必须在 XML 模式中表达 - 不包括接口和/或泛型。

从我在您的帖子中阅读的内容来看，您正在寻找的更多是“进程内”数据访问层 - 而不是服务级别。因此，如果您想继续走这条路，您应该结合实体框架研究存储库和工作单元模式。

更多信息：

*   [MSDN：什么是 Windows Communication Foundation？](http://msdn.microsoft.com/en-us/library/ms731082.aspx)
*   [WCF Essentials — 开发人员入门](http://www.devx.com/codemag/Article/31674)
*   [该 Primer中非常基本的 WCF 架构的图片](http://assets.devx.com/articlefigs/16175.jpg)- 只有一条带有序列化消息的连接客户端和服务器的线路 - 仅此而已；但序列化**总会**发生

# .net - 是否在 VCS 中使用 NuGet packages.config？

> ID：14095016
> 
> 赞同：6
> 
> 时间：2012-12-30T21:49:17.400
> 
> 标签：.net, version-control, nuget

是否建议将 NuGet 签入`packages.config`我的 VCS（例如 Mercurial）？还是忽略该文件更好？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-30T21:55:38.513

**一定要检查这个。**

当其他人从 repo-source（aka Origin）克隆/分叉/复制您的存储库时，他们需要知道解决方案需要哪些包。

这是具有这些答案的魔术文件。

注意：拥有此文件并不意味着您在此人的本地计算机上拥有*实际*的nuget 包。那是一个不同的主题->对于每个解决方案，我个人总是将*Nuget Package Restore设置为打开。*

# java - SetFocusable 方法或聚焦组件 Java

> ID：14095018
> 
> 赞同：5
> 
> 时间：2012-12-30T21:49:41.753
> 
> 标签：java, swing, methods, jpanel, focusable

我遇到了这段代码：

```
public class Board extends JPanel implements ActionListener{

    public Board() {
        setFocusable(true); 
    }
} 
```

`setFocusable(true)`JPanel 对象究竟做了什么？一个组件被聚焦的概念是什么？

该方法基于Java API，位于JPanel 的超类Component 类中。方法描述声明“将此组件的可聚焦状态设置为指定值。此值覆盖组件的默认可聚焦性。” 这个描述对我来说听起来太技术性和高级术语了（他刚刚在夏天完成了一个 Java 课程）。有时，我认为这些方法描述并不是为所有具有不同 Java 知识水平的人编写的。有人可以用外行的方式解释方法描述吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T22:08:34.753

该`focusable`标志指示组件是否可以在请求时获得焦点。JPanel 组件默认是可聚焦的，所以当你将它设置为`true`.

不可聚焦的组件无法获得焦点。

**一个例子**

假设您已经实现了一个包含多个文本字段的对话框，并且您希望用户输入一些文本。当用户开始输入时，一个文本字段需要成为应用程序的焦点：它将是接收键盘输入的字段。

当您实现焦点遍历（用户从一个文本字段跳转到下一个文本字段的便捷方式，例如使用`tab`按钮）时，用户可以“跳转”到下一个文本字段。应用程序将尝试获得下一个字段的焦点，以准备接收文本。当下一个字段不可聚焦时，该请求将被拒绝并测试下一个字段。例如，您不希望标签获得焦点，因为您无法在其中输入文本。

`true`默认情况下，可聚焦标志在`Component`类中设置为。当你构造一个从类派生的对象`Component`时（例如，当你构造你的`JPanel`）时，`Component`类的构造函数被调用并将默认的可聚焦标志设置为`true`。

希望覆盖此默认值的派生类可以调用该方法`setFocusable`来更改该默认值，就像您在示例中所做的那样。

请注意，setFocusable 本身并不设置焦点，它只是提供了潜在地获得组件焦点的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T08:41:21.047

`setFocusable()`实际上是`Component`Swing 类中的一个方法。

```
public void setFocusable(boolean focusable) 
```

它使组件（在您的情况下`JPanel`为*extends* `Component`）具有集中注意力的能力。它实际上并没有设置要聚焦的组件，它只是指示组件是否可以聚焦，这由传递的布尔参数决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-24T12:43:15.143

您可以使用`setFocusable(boolean n)`，它主要用于在触觉/鼠标模式和键盘（光标）中激活或停用视图的焦点事件（选择接收输入的图形用户界面的组件）模式。

# python - 在 virtualenv 中找不到全局粘贴命令

> ID：14095023
> 
> 赞同：6
> 
> 时间：2012-12-30T21:50:19.233
> 
> 标签：python, setuptools, paster

我创建了一个自定义粘贴命令，如[http://pythonpaste.org/script/developer.html#what-do-commands-look-like](http://pythonpaste.org/script/developer.html#what-do-commands-look-like)中所述。在我的 setup.py 中，我定义了这样的入口点：

```
entry_points={
  'paste.global_paster_command' : [
    'xxx_new = xxxconf.main:NewXxx'
  ]
} 
```

我在一个激活的 virtualenv 中，并通过安装了我的包

```
python setup.py develop 
```

如果我`paster`在我的包文件夹中运行，我会看到我的自定义命令，我可以通过`paster xxx ...`. 但是如果我离开我的包文件夹`paster`不再显示我的命令。我检查了一下`which paster`，这是我的 virtualenv 的版本。我还启动了一个 python 解释器并导入`xxxconf`它，它工作正常。

我不知道为什么当我在我的包文件夹之外时无法识别我的全局命令！？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T14:31:53.363

你做错了什么，它应该工作。这是最小的工作示例，您可以使用 virtualenv 对其进行测试：

`blah/setup.py`：

```
from setuptools import setup, find_packages

setup(name='blah',
      version='0.1',
      packages=find_packages(exclude=['ez_setup', 'examples', 'tests']),
      include_package_data=True,
      zip_safe=False,
      entry_points={'paste.global_paster_command': [ "xxx_new = blah.xxx:NewXxx", ] },
      ) 
```

`blah/blah/xxx.py`：

```
from paste.script import command

class NewXxx(command.Command):
    usage = "PREFIX"
    summary = "some command"
    group_name = "my group" 
```

`blah/blah/__init__.py`： 空的。

现在测试：

```
$ pwd
/tmp
$ virtualenv paster
New python executable in paster/bin/python
Installing setuptools............done.
Installing pip...............done.
$ . paster/bin/activate
(paster)$ pip install PasteScript
Downloading/unpacking PasteScript
[... skipping long pip output here ...]
(paster)$ paster
[...]
Commands:
  create       Create the file layout for a Python distribution
  help         Display help
  make-config  Install a package and create a fresh config file/directory
  points       Show information about entry points
  post         Run a request for the described application
  request      Run a request for the described application
  serve        Serve the described application
  setup-app    Setup an application, given a config file

(paster)$ cd blah/
(paster)$ python setup.py develop
running develop
[... skipping setup.py output...]
(paster)$ paster
[...]
Commands:
  create       Create the file layout for a Python distribution
  help         Display help
  make-config  Install a package and create a fresh config file/directory
  points       Show information about entry points
  post         Run a request for the described application
  request      Run a request for the described application
  serve        Serve the described application
  setup-app    Setup an application, given a config file

my group:
  xxx_new      some command
(paster)$ cd ~
(paster)$ paster
[...]
Commands:
[...]
  setup-app    Setup an application, given a config file

my group:
  xxx_new      some command 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T04:33:48.483

您应该在活动的 virtualenv 中安装您的 paste_script。然后你可以在任何地方使用它。

# python - functools.wraps 不允许我用 Python 3 中的类包装函数

> ID：14095025
> 
> 赞同：7
> 
> 时间：2012-12-30T21:50:33.210
> 
> 标签：python, python-3.x, decorator, contextmanager, functools

我想为一些将文件作为第一个参数的函数编写一个装饰器。装饰器必须实现[上下文管理器协议](http://docs.python.org/reference/datamodel.html#with-statement-context-managers)（即将包装的函数变成上下文管理器），所以我想我需要用一个类来包装函数。

我对装饰器模式并没有真正的经验，并且以前从未实现过上下文管理器，但是我编写的内容适用于 Python 2.7，如果我注释掉该`wraps`行，它也适用于 Python 3.3。

```
from functools import wraps
def _file_reader(func):
    """A decorator implementing the context manager protocol for functions
    that read files."""
#   @wraps(func)
    class CManager:
        def __init__(self, source, *args, **kwargs):
            self.source = source
            self.args = args
            self.kwargs = kwargs
            self.close = kwargs.get('close', True)

        def __enter__(self):
            # _file_obj is a little helper that opens the file for reading
            self.fsource = _file_obj(self.source, 'r') 
            return func(self.fsource, *self.args, **self.kwargs)

        def __exit__(self, exc_type, exc_value, traceback):
            if self.close:
                self.fsource.close()
            return False
    return CManager 
```

取消注释该`wraps`行时出现的错误发生在内部`update_wrapper`：

```
/usr/lib/python3.3/functools.py in update_wrapper(wrapper, wrapped, assigned, updated)
     54             setattr(wrapper, attr, value)
     55     for attr in updated:
---> 56         getattr(wrapper, attr).update(getattr(wrapped, attr, {}))
     57     # Return the wrapper so this can be used as a decorator via partial()
     58     return wrapper

AttributeError: 'mappingproxy' object has no attribute 'update' 
```

我知道文档并没有说我什至可以用[`functools.wraps`](http://docs.python.org/3/library/functools.html#functools.wraps)这样的类来包装函数，但话又说回来，它只适用于 Python 2。有人可以解释一下这个回溯到底告诉我什么以及我应该做什么`wraps`在两个版本的Python上实现效果？

* * *

**编辑**：我错了。上面的代码**没有**做我想要的。我希望能够在*有*和*没有* `with`的情况下使用该函数，例如内置函数`open`。

上面的代码将修饰函数转换为上下文管理器。我希望能够做到：

```
reader = func('source.txt', arg)
for item in reader:
    pass 
```

也

```
with func('source.txt', arg) as reader:
    for item in reader:
        pass 
```

所以我的代码版本应该大概如下所示：

```
def _file_reader(func):
    """A decorator implementing the context manager protocol for functions
    that read files."""
    @wraps(func)
    class CManager:
        def __init__(self, source, *args, **kwargs):
            self.close = kwargs.get('close', True)
            self.fsource = _file_obj(source, 'r')
            self.reader = func(self.fsource, *args, **kwargs)

        def __enter__(self):
            return self.reader

        def __iter__(self):
            return self.reader

        def __next__(self):
            return next(self.reader)

        def __exit__(self, exc_type, exc_value, traceback):
            if self.close and not self.fsource.closed:
                self.fsource.close()
            return False
    return CManager 
```

随意评论我忽略的任何事情。

**注意**：JF Sebastian 的课程版本似乎可以工作：

我基本上`wraps`从课堂上删除了并改为`return CManager`：

```
@wraps(func)
def helper(*args, **kwargs):
    return CManager(*args, **kwargs)
return helper 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:00:01.373

[`functools.wraps()`](http://docs.python.org/3.3/library/functools.html#functools.wraps)用于包装函数：

```
import contextlib
import functools

def file_reader(func):
    @functools.wraps(func)
    @contextlib.contextmanager
    def wrapper(file, *args, **kwargs):
        close = kwargs.pop('close', True) # remove `close` argument if present
        f = open(file)
        try:
            yield func(f, *args, **kwargs)
        finally:
            if close:
               f.close()
    return wrapper 
```

### 例子

```
@file_reader
def f(file):
    print(repr(file.read(10)))
    return file

with f('prog.py') as file:
    print(repr(file.read(10))) 
```

如果您想使用基于类的上下文管理器，那么解决方法是：

```
def file_reader(func):
    @functools.wraps(func)
    def helper(*args, **kwds):
        return File(func, *args, **kwds)
    return helper 
```

为了使其行为相同，无论装饰函数是直接使用还是作为上下文管理器，您应该`self`返回`__enter__()`：

```
import sys

class File(object):

    def __init__(self, file, func, *args, **kwargs):
        self.close_file = kwargs.pop('close', True)
        # accept either filename or file-like object
        self.file = file if hasattr(file, 'read') else open(file)

        try:
            # func is responsible for self.file if it doesn't return it
            self.file = func(self.file, *args, **kwargs)
        except:  # clean up on any error
            self.__exit__(*sys.exc_info())
            raise

    # context manager support
    def __enter__(self):
        return self

    def __exit__(self, *args, **kwargs):
        if not self.close_file:
            return  # do nothing
        # clean up
        exit = getattr(self.file, '__exit__', None)
        if exit is not None:
            return exit(*args, **kwargs)
        else:
            exit = getattr(self.file, 'close', None)
            if exit is not None:
                exit()

    # iterator support
    def __iter__(self):
        return self

    def __next__(self):
        return next(self.file)

    next = __next__  # Python 2 support

    # delegate everything else to file object
    def __getattr__(self, attr):
        return getattr(self.file, attr) 
```

### [例子](http://ideone.com/RMhe4r)

```
file = f('prog.py')  # use as ordinary function
print(repr(file.read(20)))
file.seek(0)
for line in file:
    print(repr(line))
    break
file.close() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:43:19.240

虽然我不知道*你*看到的错误是什么，但看起来你可能注定要失败：

```
>>> import functools
>>> def foo():
...     pass
... 
>>> class bar:
...     pass
... 
>>> functools.wraps(foo)(bar)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib64/python3.2/functools.py", line 48, in update_wrapper
    setattr(wrapper, attr, value)
AttributeError: attribute '__doc__' of 'type' objects is not writable
>>> bar.__doc__
>>> bar.__doc__ = 'Yay'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: attribute '__doc__' of 'type' objects is not writable 
```

**编辑：** [JF Sebastian](https://stackoverflow.com/a/14095585/65696)有*解决方案*，但我将这一点作为说明为什么它必须是一个函数而不是一个类

# java - 从 Java 连接到 MySQL

> ID：14095028
> 
> 赞同：-1
> 
> 时间：2012-12-30T21:51:02.080
> 
> 标签：java, mysql, url, jdbc

我有一个网站，在那个网站上我也有一个 MySQL 数据库。我可以从 phpMyAdmin 在线处理我的数据库，它的名称为“dbPersons”；

但是我想从 Java 连接到该数据库。我已经下载了 JDBC，但由于我的连接字符串，我无法连接。我使用以下连接字符串

```
String mySQLCredecials = "jdbc:mysql:thin:" + user + "/" + pass + "@jdbc:mysql:www.websiteName.net:2222/dbPersons"; 
```

你知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T21:56:36.627

只需查看[MySQL JDBC 驱动程序文档](http://dev.mysql.com/doc/refman/5.6/en/connector-j-reference-configuration-properties.html)以获取正确的语法。

> ## 21.3.5.1。连接器/J 的驱动程序/数据源类名称、URL 语法和配置属性
> 
> ...
> 
> ### JDBC URL 格式
> 
> MySQL Connector/J 的 JDBC URL 格式如下，方括号 ([, ]) 中的项目是可选的：
> 
> ```
> jdbc:mysql://[host][,failoverhost...][:port]/[database] »
> [?propertyName1][=propertyValue1][&propertyName2][=propertyValue2]... 
> ```
> 
> 如果未指定主机名，则默认为 127.0.0.1。如果未指定端口，则默认为 3306，这是 MySQL 服务器的默认端口号。
> 
> ```
> jdbc:mysql://[host:port],[host:port].../[database] »
> [?propertyName1][=propertyValue1][&propertyName2][=propertyValue2]... 
> ```
> 
> 这是一个示例连接 URL：
> 
> ```
> jdbc:mysql://localhost:3306/sakila?profileSQL=true 
> ```

因此，您的显然是错误的。的存在`:thin`表明您错误地阅读了[Oracle JDBC 驱动程序文档](http://www.orafaq.com/wiki/JDBC#Thin_driver)而不是 MySQL 文档。使用以下 JDBC URL：

```
String url = "jdbc:mysql://www.websiteName.net:2222/dbPersons"; 
```

并获取如下连接：

```
Connection connection = DriverManager.getConnection(url, user, pass); 
```

简单地说，给定的`SQLException: No suitable driver`JDBC 连接 URL 不能被任何迄今为止加载的驱动程序识别。所以除了错误的连接 URL 之外，另一个可能的原因是根本没有加载支持该 URL 的 JDBC 驱动程序。

### 也可以看看：

*   [将 Java 连接到 MySQL 数据库](https://stackoverflow.com/questions/2839321/java-connectivity-with-mysql/2840358#2840358)
*   [SQLException: 找不到合适的驱动程序](https://stackoverflow.com/questions/5982675/sqlexception-no-suitable-driver-found/5983038#5983038)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T21:56:22.103

我认为您需要使用正确的 JDBC URL，您的不正确。

在这里阅读：http: [//dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html)

> **JDBC URL 格式**
> 
> MySQL Connector/J 的 JDBC URL 格式如下，方括号 ([, ]) 中的项目是可选的：
> 
> ```
> jdbc:mysql://[host][,failoverhost...][:port]/[database] »
> [?propertyName1][=propertyValue1][&propertyName2][=propertyValue2]... 
> ```

...

# cocos2d-x - Cocos2dx 定位 CCMenuItem 支持全屏切换

> ID：14095029
> 
> 赞同：0
> 
> 时间：2012-12-30T21:51:12.430
> 
> 标签：cocos2d-x

我在我的新项目中添加了几个菜单项，并通过将 EAGLView 设置为全屏添加了在 mac 中切换全屏模式的功能。

但是，当我切换到全屏并尝试单击菜单项时，单击区域不合适。

处理这个问题的最佳方法是什么？

谢谢

# android - 如何仅为 VPN 过滤 android logcat

> ID：14095032
> 
> 赞同：2
> 
> 时间：2012-12-30T21:51:37.353
> 
> 标签：android, adb, vpn, logcat

我已经成功获得了一个通用的 logcat；但是我的特殊问题是连接到 VPN（在任何 4+ android ROM 上）所以我想做一个仅与 VPN 相关的 logcat，看看发生了什么。

以这种方式尝试了“LegacyVpnRunner”：

```
adb logcat LegacyVpnRunner:E *:S -v long > name of problem.txt 
```

但最终的txt是这样的：

```
adb server is out of date.  killing...
* daemon started successfully *
--------- beginning of /dev/log/system

--------- beginning of /dev/log/main 
```

有什么问题？我是否为 VPN 服务使用了错误的别名？(LegacyVpnRunner) 如果是这样，在哪里找到任何 android 服务的相关别名的参考？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:17:13.377

不要将您的过滤器限制为仅捕获`Error`优先消息。至于使用正确的标签， `com.android.server.connectivity.Vpn.java`使用 2 个标签进行日志记录 - “Vpn”和“LegacyVpnRunner”。所以我建议尝试两者：

```
adb logcat -s Vpn:*
adb logcat -s LegacyVpnRunner:* 
```

# solr - Solr 3.6.2 和 Solr 4.0 之间有什么区别？

> ID：14095036
> 
> 赞同：1
> 
> 时间：2012-12-30T21:52:10.237
> 
> 标签：solr

除了新功能之外，Solr 3.6 和 Solr 4.0 之间是否有任何主要区别？在 Solr 4.0 中使用我现有的查询（在 Solr 3.6 中工作的查询）是否安全？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:09:04.757

> 除了新功能之外，Solr 3.6 和 Solr 4.0 之间是否有任何主要区别？

我觉得这个问题很奇怪，至少可以这么说。错误修复和新功能**是**发布的重点！

您可以在[此处查看](http://lucene.apache.org/solr/4_0_0/changes/Changes.html)Solr 版本的完整变更日志。不要忘记 Solr 和[Lucene](http://lucene.apache.org/)是同时发布的，因此您还需要在两个项目中寻找相关的变化。

> 在 Solr 4.0 中使用我现有的查询（在 Solr 3.6 中工作的查询）是否安全？

查询应该没问题，但索引 - 可能不是。[从另一个 SO 帖子](https://stackoverflow.com/questions/13009928/migrate-data-from-solr-3)中引用 javanna ：

> 索引格式已更改，但 Solr 将负责升级索引。一旦您使用旧索引启动 Solr，这将自动发生。但在那之后，以前的 Solr/lucene 版本就不能再读取索引了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T04:10:04.677

理想情况下，他们应该工作。
您可能可以查看[Changes.txt](http://svn.apache.org/repos/asf/lucene/dev/tags/lucene_solr_4_0_0_BETA/solr/CHANGES.txt)，它可以让您了解所有新功能、更改、错误修复、优化完成。
如果有任何问题，您可以随时参考更改以检查是否有任何相关更改。

# asp.net - 用于将数据发布到 ASP.Net 页面的 jQuery AJAX 调用（不是 Get 而是 POST）

> ID：14095041
> 
> 赞同：20
> 
> 时间：2012-12-30T21:52:53.833
> 
> 标签：asp.net, jquery, post

我对 ASP.Net 页面进行了以下 jQuery AJAX 调用。

```
 $.ajax({
                async: true,
                type: "POST",
                url: "DocSummaryDataAsync.aspx", //"DocSummary.aspx/GetSummaryByProgramCount",
                contentType: "application/json; charset=utf-8",
                data: kendo.stringify({ vendorId: supplierId, businessUnit: busUnit, productSegmentId: prodSegmentId, programId: progId, productManagerId: prodManagerId, companyIds: compIds, expired: exp.toString(), requestType: 'TotalCount' }),
                success: function (msg) {
                    // alert('in success of getcount');

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    // alert('in failure of getcount');

                }
            }); 
```

当我尝试从 Request 对象中检索发布的数据时，它没有显示出来。我的 aspx 页面代码如下。我将 Json 格式的每个发布数据发送到页面，但它没有显示在页面的代码隐藏中。**jQuery ajax 调用中是否有一些我缺少的额外设置？**

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.ContentType = "application/json";

        string requestType = Request.Params["requestType"];

        //populate variables from posted data
        string vendorId = Request.Params["vendorId"];
        string businessUnit = Request.Params["businessUnit"];
        string productSegmentId = Request.Params["productSegmentId"];
        string commitmentProgramId = Request.Params["programId"];
        string productManagerId = Request.Params["productManagerId"];
        string companyIds = Request.Params["companyIds"];
        string expired = Request.Params["expired"];
     } 
```

**更新1：** 斯蒂芬的答案是最好的方法，尤其是执行ProcessRequest的方法。但是，我确实找到了一个小技巧，它允许以通常的传统方式将数据发布到 ASP.Net，例如 Request["vendorId"] 等。要从任何 jQuery ajax 请求中发布此类数据，您只需要确保将以下 2 点应用于您的 jQuery ajax 调用：

1.  **内容类型应该被排除在你的 jQuery ajax 调用之外，**或者如果你想包含它，那么它**不应该设置为**"application/json; charset=utf-8" 而是 "application/x-www-form-urlencoded ; 字符集=UTF-8"。根据我的理解，内容类型是告诉 ASP.Net 页面正在发送的数据类型，而不是页面预期的数据类型。
2.  jQuery ajax 的数据部分**不应将数据名称括在引号中**。所以 data: {"venorId":"AD231","businessUnit":"123"} 应该替换为 data: {venorId:"AD231",businessUnit:"123"}。在此示例中，数据名称是 vendorId 和 businessUnit，可以使用通常的 ASP.Net 语法（如 Request["vendorId"] 和 Request["businessUnit"]）在 ASP.Net 代码隐藏中访问它们。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-30T22:19:36.867

选项 1.**保持服务器端代码相同**

首先删除*kendo.stringify*。然后删除 contentType 或将其更改为...

```
"application/x-www-form-urlencoded; charset=utf-8" 
```

...或将您的 $.ajax 调用更改为：

```
$.post('DocSummaryDataAsync.aspx', { vendorId: supplierId, businessUnit: busUnit, productSegmentId: prodSegmentId, programId: progId, productManagerId: prodManagerId, companyIds: compIds, expired: exp.toString(), requestType: 'TotalCount' }, function (data) { }); 
```

选项 2.**将 POST 更改为 GET**

像这样

```
$.ajax({
async: true,
type: "GET",
etc. 
```

这将通过 QueryString 传递您的数据。如果您删除*kendo.stringify*调用，您将访问所有值，如下所示：

```
string vendorId = Request.QueryString[0];
string businessUnit = Request.QueryString[1];
etc. 
```

选项 3.**使用您原来的 $.ajax 调用**

如果您使用原始 $.ajax，则适用以下内容：

Request.Params 获得“QueryString、Form、Cookie 和 ServerVariables 项的组合集合”。-[这个链接](http://msdn.microsoft.com/en-us/library/system.web.httprequest.params.aspx)

您没有与其中任何一个一起工作。相反，您需要访问 Request.InputStream。

您可以这样做：

在服务器端创建一个映射到请求的 JSON 对象的类，例如

```
public class MyClass
{
    // The type (int or string) should probably correspond to the JSON
    public int vendorId { get; set; }
    public string businessUnit { get; set; }
    public string productSegmentId { get; set; }
    public string programId { get; set; }
    public string productManagerId { get; set; }
    public string companyIds { get; set; }
    public string expired { get; set; }
    public string requestType { get; set; }
} 
```

将 Request.InputStream 转换为该类型，然后您就可以使用它了。

```
public void ProcessRequest()
{
    System.IO.Stream body = Request.InputStream;
    System.Text.Encoding encoding = Request.ContentEncoding;
    System.IO.StreamReader reader = new System.IO.StreamReader(body, encoding);
    string json = reader.ReadToEnd();
    JavaScriptSerializer serializer = new JavaScriptSerializer();
    MyClass myclass = (MyClass)serializer.Deserialize(json, typeof(MyClass));
    int vendorId = myclass.vendorId;
    string requestType = myclass.requestType;
    // etc...
}

protected void Page_Load(object sender, EventArgs e)
{
    ProcessRequest();
} 
```

# c - 简单 C 代码中的指针数组问题

> ID：14095043
> 
> 赞同：0
> 
> 时间：2012-12-30T21:53:09.680
> 
> 标签：c

当我把`name`它作为 char 指针时，我得到了一个严重的错误。当我把它作为一个数组时很好，但同样的情况是`*p3`没有问题的。为什么我只得到一个错误`name`？甚至初始化也不起作用。

```
#include <stdio.h>
#include <conio.h>
#include <string.h>
int main()
{
    int dex;
    const int k = 5;
    char *name;
    char *p3 = "happy world";
    char *list[k]={"kamy",
        "frank",
        "chris",
        "sara",
        "ricky"};

    scanf("%s",name);
    //or gets(name);
    printf("printed name is <%s>", name);
    getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:55:40.947

您需要为`name`首次使用分配内存`malloc`

```
name = malloc(20);
scanf("%19s", name); 
```

然后当你完成后，你应该释放分配的内存：

```
free(name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T21:55:44.597

`p3[]`自动分配内存，`*p3`不会。

要使用`*p3`您必须使用用户`malloc`功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T21:56:15.223

`scanf`能够从标准输入获取输入并将其放入 a`char*`但它不会为您分配内存。

尝试：

```
char name[64];
scanf("%s",name); 
```

注意`char *name`不会为字符初始化内存。您需要像 with 一样使用自动分配`char name[64]`或使用 动态分配它`char *name = calloc(64, sizeof(char))`。如果您选择后一种方法，您还必须在不再需要时释放内存`free(name)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T21:56:21.257

您声明`name`为指针，但您从不初始化它。这意味着当您尝试在`scanf`调用中写入时，您会写入看似随机的内存位置。这是未定义的行为，肯定会导致奇怪的事情发生。

您应该创建一个数组来保存字符串：

```
char name[32]; 
```

此外，为了不超出字符串的末尾，您可能应该将`scanf`调用更改为，以便它知道长度：

```
scanf("%31s", name); 
```

如果你得到一条线，你应该使用`fgets`：

```
fgets(name, sizeof(name), stdin); 
```

并且作为一个小提示：不要忘记检查从您调用的函数返回的值，它们可能会失败！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T21:56:54.210

`name`尚未初始化为指向任何东西，因此指向内存中的某个随机位置。使用它会调用未定义的行为。

要么将其声明为数组，要么分配一些内存。

您不应该传入`p3`其中`scanf()`任何一个，因为它已被分配为指向静态字符串。

并且永远不要使用`gets()`. 曾经。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-30T21:57:34.073

增加你的编译器警告，它会指出你的错误。`name`是一个未初始化的指针，所以它可能指向任何地方并试图写入它指向的位置会导致未定义的行为，如果你幸运的话，会出现段错误。

要么声明`name`为数组，要么初始化它`malloc`以分配一块内存。

您还应该与说明符一起使用over`fgets`以避免缓冲区溢出，或者至少传递一个宽度说明符，这样您就不会溢出缓冲区。请注意，如果您使用它，它还将存储在缓冲区中。`scanf``%s``scanf``fgets``'\n'`

IE。

```
char name1[30];
char *name2 = malloc(30 * sizeof(*name2));

fgets(name1, 30, stdin); // TODO - check return values
scanf("%29s", name2); // 30 - 1
//...
free(name2); 
```

# android-layout - 导入自定义视图时出现“java.lang.RuntimeException：无法启动活动 ComponentInfo”

> ID：14095044
> 
> 赞同：1
> 
> 时间：2012-12-30T21:53:22.223
> 
> 标签：android-layout, import, nullpointerexception, custom-view, pinchzoom

我正在尝试使用“教程如何利用 Xperia™ X10 应用程序中的捏合缩放功能 – 第 2 部分”中[的](http://developer.sonymobile.com/knowledge-base/tutorials/ui-graphics/how-to-take-advantage-of-the-pinch-to-zoom-feature-in-your-xperia-x10-apps-part-2/)自定义视图，我将与自定义视图相关的类复制到项目中。自定义视图出现在 xml 编辑器->图形布局->自定义和库视图中，当我将其拖放到布局中时，我得到：

```
 java.lang.NullPointerException 
```

logcat 显示了这一点：

```
FATAL EXCEPTION: main
12-31 01:00:19.819: E/AndroidRuntime(4554): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.yav.android/iv.GeneralImageview}: java.lang.NullPointerException 
```

问题是如何让eclipse看到这个自定义视图类？

# delphi - 在 Delphi 2009 中调试 COM+：dllhost.exe /ProcessID 不起作用

> ID：14095045
> 
> 赞同：1
> 
> 时间：2012-12-30T21:53:38.277
> 
> 标签：delphi, debugging, delphi-2009, com+

我正在 Windows 8 上的 Delphi 2009 中编写一个 COM+ 组件。（我将很快转向 XE3，但现在它是 D2009）。

在调试常规的简单表单应用程序时，我遇到了很多 IDE 冻结，主要是在在断点处停止并继续运行以下代码后关闭应用程序时，但除此之外 D2009 工作正常。

现在，我遇到的问题是我无法调试 COM+ 组件。此组件的新实例是从另一个表单应用程序创建的。如果我在项目的“运行”选项对话框中指定该表单应用程序，则一切正常，但不会在 COM+ 对象的断点处停止。然后我在网上找到了通过将 dllhost.exe 放入“运行”中并在参数中使用“/ProcessID：GUID”进行调试的方法。我仔细检查了所有内容，当我按下 F9 时，我看到的只是调试控制台中的“线程进入”然后“线程退出”。仍然没有在所有显示为超出运行范围的断点处停止。

请问我该怎么做？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:36:43.813

检查您的组件 COM+ 配置。要正确调试需要池大小 = 1（池和回收）和“交互式用户”中的组件标识

# regex - 使用批处理从匹配字符串的行中删除文本

> ID：14095048
> 
> 赞同：0
> 
> 时间：2012-12-30T21:53:58.593
> 
> 标签：regex, bash, shell, batch-file, cmd

我需要使用批处理器从包含特定字符串的行中删除文本：SED、AWK、Windows 批处理、Unix shell 或类似的东西。如果字符串为“green”，则以下输入

```
red
green 1
blue
green 2
yellow 
```

将产生输出

```
red
<EMPTY LINE>
blue
<EMPTY LINE>
yellow 
```

我还需要对不匹配字符串的行做同样的事情，产生输出

```
<EMPTY LINE>
green 1
<EMPTY LINE>
green 2
<EMPTY LINE> 
```

我需要从行中删除文本（清空行的内容），而不是删除它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:11:24.297

使用 sed 清空包含以下内容的行`green`：

```
sed '/green/s/.*//' input 
```

并使用 sed 清空其他行：

```
sed '/green/!s/.*//' input 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:52:48.067

Windows 命令行/批处理

使用[`find`](http://technet.microsoft.com/en-us/library/cc725655%28v=ws.10%29.aspx)或[`findstr`](http://technet.microsoft.com/en-us/library/cc732459%28v=ws.10%29.aspx)。

输出不匹配的行

```
find /V "green" file.txt 
```

输出匹配线

```
find "green" file.txt 
```

这些命令会将内容输出到控制台。根据需要将输出重定向到目标文件。例子：

```
find /V "green" file.txt > nonmatchingoutput.txt 
```

键入`find /?`或`findstr /?`寻求帮助和所有选项。

* * *

**更新**更新的问题。

这将只使用 Batch 完成您要求的操作

```
:: Hide Commands
@echo off

:: Erase Existing Files
>match.txt ( <nul set /p "=" )
>nomatch.txt ( <nul set /p "=" )

:: Loop through Source and Generate Output
for /f "tokens=1,* delims=]" %%K in ('type temp.txt ^| find /V /N ""') do (
    for /f "delims=" %%X in ('echo(%%L ^| find /V "green"') do (
        echo(%%X>>nomatch.txt
        echo.>>match.txt
    )
    for /f "delims=" %%X in ('echo(%%L ^| find "green"') do (
        echo(%%X>>match.txt
        echo.>>nomatch.txt
    )
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:02:33.303

使用 perl：

```
# Empty when finding green
perl -pe 's,.*,, if /green/' inputfile
# Empty when not finding green
perl -pe 's,.*,, unless /green/' inputfile 
```

这些命令会将内容输出到标准输出，因此将输出重定向到目标文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T05:34:29.927

下面列出了 Sed 解决方案：

**输入.txt**

```
red
green 1
blue
green 2
yellow 
```

**尝试这个**

**代码 1：**

```
$> grep -v green Input.txt  | sed G 
```

或者

```
$> sed '!s/^green//g' Input.txt

red

blue

yellow 
```

**代码 2：**

```
$> grep green Input.txt  | sed G 
```

或者

```
$> sed -n '/green/p' Input.txt

green 1

green 2 
```

# jquery - 从数组中删除不匹配的元素

> ID：14095050
> 
> 赞同：0
> 
> 时间：2012-12-30T21:54:20.443
> 
> 标签：jquery, arrays, loops, element, match

所以，我有两个数组，我想从 array2 中删除所有未作为数字包含在 array1 中的元素（下面的示例数组会更清楚）。

我想一个 for 循环和一个 if 语句可以解决问题，但我认为如果有人有建议，我认为有一个更优雅的解决方案？

```
var elemsToKeep = [1, 3, 5, 6, 8];

var arr[0] = 'foo1';
var arr[1] = 'foo2';    // remove
var arr[2] = 'foo3';
var arr[3] = 'foo4';    // remove
var arr[4] = 'foo5';
var arr[5] = 'foo6';
var arr[6] = 'foo7';    // remove
var arr[7] = 'foo8';
var arr[8] = 'foo9';    // remove
var arr[9] = 'foo10';   // remove 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T21:56:51.213

与其尝试删除您不需要的值，不如创建一个仅包含您需要的值的新数组。提示：它涉及一个循环和`Array.push`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T21:58:28.300

也许是一个[过滤器](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter) （我第一次使用一个，所以我刚刚弹出并制作了一个[jsfiddle.net](http://jsfiddle.net/mplungjan/sA3Ch/)）

**注意**已更新以删除任何非数字字符 - 这意味着 1foo2 将变为 12 - 如果这不是您想要的，请告诉我，然后可以应用不同的正则表达式

```
var elemsToKeep = [1, 3, 5, 6, 8];

var arr=[];
arr[0] = 'one1';
arr[1] = 'two2';   // remove
arr[2] = 'three3';
arr[3] = 'four4';  // remove
arr[4] = 'five5';
arr[5] = 'six6';
arr[6] = 'seven7'; // remove
arr[7] = 'eight8';
arr[8] = 'nine9';  // remove
arr[9] = 'ten0';   // remove

function keep(element, index, array) {
  var num = parseInt(element.replace(/[^\d]/g,''),10); // any char!
  return elemsToKeep.indexOf(num) !=-1;
}

var filtered = arr.filter(keep);
alert(filtered)​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T22:08:47.827

您可以使用下划线的 _reject 功能：

```
var filtered = _reject(arr2, function(element, index) {
   return elementsToKeep.indexOf(index +1) == -1;
}); 
```

# javascript - 函数属性和原型 - Javascript

> ID：14095060
> 
> 赞同：0
> 
> 时间：2012-12-30T21:55:19.777
> 
> 标签：javascript, function, properties, prototype

这是什么？

```
en4.activity.like(c) 
```

这是对象en4的属性“活动”的函数like（）吗？

我需要重新编写函数，但**格式相同**，我很困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T21:56:08.060

这将完成这项工作：

```
var en4 = {
    activity: {
        like: function(c) {

        }
    }
}; 
```

如果`en4`已经存在并且还有一个属性`activity`，你会这样做：

```
en4.activity.like = function(c) {
    ...
}; 
```

如果该属性也不存在：

```
en4.activity = {
    like: function(c) {

    }
}; 
```

由于您只有一个对象，因此很可能根本不需要涉及原型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T21:57:53.523

试试这个：

```
function nsp() {
    this.activity = {
        like: function(a) {}
    };
}

var en4 = new nsp();

en4.activity.like(c); 
```

# java - Java：大整数错误

> ID：14095065
> 
> 赞同：3
> 
> 时间：2012-12-30T21:55:46.157
> 
> 标签：java, numbers, integer

我正在尝试在 Java 中做以下数学方程式：

```
(44334*(220*220))+ (81744*220) + 39416) 
```

当我在 WolframAlpha（或 Google）中输入相同的方程时，我得到：

```
2163788696 
```

在java中我得到负数..

我一直在努力找出为什么会这样，但没有运气。我还尝试将答案保存在 BigInteger 中，但由于数字太大，我得到了负值。

我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T21:57:53.787

编辑：要处理整数环绕，请使用`long`：

```
System.out.println("Result: " +
    (44334L * 220 * 220 + 81744 * 220 + 39416));  // 2163788696 
```

加号运算符是左关联的（无论是用于字符串连接还是加法），所以如果整个算术表达式没有括起来，它会将子表达式的结果从左到右连接为单独的字符串。

左操作数确定 + 是用于字符串连接还是加法。在这种情况下，第一个操作数是一个字符串，所以右边的 ( `(44334*(220*220))`) 也被转换为一个字符串。第一个 + 运算符的结果是一个字符串，并用作另一个 + 字符串连接操作的左侧。下一个操作数 ( `(81744*220)`) 再次转换为字符串。

您可以在整个算术表达式周围加上括号以避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T21:58:48.597

问题是由于表达式是从左到右计算的。第一个值是字符串类型，所以 + 运算符然后变成字符串连接运算符而不是数学加法运算符。`(44334*(220*220))`然后对表达式`(81744*220)`求值并将其转换为导致错误结果的字符串。如果将整个表达式用括号括起来，则结果会正确计算并且您会看到正确的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T21:59:58.160

现在，您所做的相当于：

```
System.out.println(("result="+(44334*220*220)) + (81744*220 + 39416) );
// = "result=2145765600" + 18023096
// = "result=214576560018023096" 
```

括号很重要！这是您修复的代码：

```
System.out.println("result=" + (44334*220*220+ 81744*220 + 39416) );
// = "result=2163788696" 
```

**编辑：**

还要注意自动`int`铸造。使用`long`s 因为你的结果大于`MAX_INT`（但小于`MAX_LONG`which is `9223372036854775807`）。

```
(long)((long)44334*220*220 + (long)81744*220 + 39416) 
```

或者将后缀放在`L`您的数字之后（因此它们被视为`long`s）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T22:01:40.143

问题是`+`Java中的运算符重载。它可以表示字符串连接或数字加法。正在发生的事情是一些`+`操作被视为字符串连接而不是数字加法。

您需要在表达式周围添加一组括号，

```
System.out.println("result="+((44334*(220*220))+ (81744*220) + 39416)); 
```

或使用临时变量。

```
int res = (44334*(220*220))+ (81744*220) + 39416;
System.out.println("result="+res); 
```

* * *

Java用来判断其含义的“规则”`+`大致如下：

*   如果左**或**右操作数的类型是字符串，则`+`表示字符串连接。
*   如果左右操作数的类型都是原始数字类型或数字包装类型**，**则`+`表示数字加法。
*   否则这是一个编译错误。

* * *

这里的另一个问题`2163788696`是大于`int`最大值 - `2147483647`。所以要得到正确的答案（没有溢出），你需要告诉 Java 使用`long`算术；例如

```
System.out.println("result=" + ((44334L * (220 * 220)) + (81744 * 220) + 39416)); 
```

如果你不这样做，那么`result`将是一个负数......在这个例子中。

您也可以使用`BigInteger`，但它有点麻烦，`long`在这里也可以。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-30T22:09:31.837

对于`BigInteger`版本，试试这个，它会正常工作

```
BigInteger a = new BigInteger("44334").multiply(new BigInteger("220").multiply(new BigInteger("220")));
BigInteger b = new BigInteger("81744").multiply(new BigInteger("220"));
BigInteger c = new BigInteger("39416");
c = c.add(a).add(b);

System.out.println("resultVersA="+(44334*(220*220))+ (81744*220)  + 39416 );
System.out.println("resultVersB="+ c); 
```

结果将是：

```
resultVersA=21457656001798368039416

resultVersB=2163788696 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-30T22:16:16.397

只需在你写的每个数字后加上一个 L。

```
(44334L*(220L*220L))+ (81744L*220L) + 39416L 
```

# python - Python如何使其他python模块的函数可见

> ID：14095066
> 
> 赞同：0
> 
> 时间：2012-12-30T21:55:50.790
> 
> 标签：python, function

> **可能重复：**
> [在 Python 中导入](https://stackoverflow.com/questions/697281/importing-in-python)

我有几个函数，我想让它们作为库函数可见，以便能够从其他项目中调用它们。我想将它们放在与常见 python 库不同的目录中。我应该如何安排我的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:06:51.153

您可以在要导入函数的项目中使用它：

```
import sys
sys.path.append('c:\\myprojects\\MyProjDir\\')

from MyModule import MyClass 
```

请注意，具有名称的文件`__init__.py`必须放在`MyProjDir`. 否则 Python 不会扫描这个目录。的内容`__init__.py`可以留空。

**文件：**

1.  [修改 Python 的搜索路径](http://docs.python.org/2/install/index.html#modifying-python-s-search-path)
2.  [模块搜索路径](http://docs.python.org/2/tutorial/modules.html#the-module-search-path)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:05:28.270

首先，您必须制作一个包含您的代码的包。可以在此处找到快速介绍：http: [//guide.python-distribute.org/introduction.html](http://guide.python-distribute.org/introduction.html)有不同的选项可以管理与其他项目相关的包。我建议使用 setuptools 创建一个可分发的包。如果您想将您的开发与默认的 python 安装隔离开来，请查看[http://pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T21:59:45.923

您必须将此函数保存在我的某个文件中，并从其他文件或模块中使用导入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T22:08:22.287

在单独的文件中定义这些函数并使用 import 来引用它们。一个有用的链接（python 中的模块）：[http ://docs.python.org/3/tutorial/modules.html](http://docs.python.org/3/tutorial/modules.html)

# java - Java 控制台 readPassword() 返回无意义字符

> ID：14095067
> 
> 赞同：1
> 
> 时间：2012-12-30T21:55:54.787
> 
> 标签：java, io, passwords

我对 Java 的 Console 对象，尤其是`readPassword()`方法有一个可笑的困难。

我有当前代码读取密码两次，然后循环直到两个密码相同：

```
do {
    dbPasswordOne = userInput.readPassword("Enter a password for the bookstall: ");
    System.out.println(dbPasswordOne.toString());
    dbPasswordTwo = userInput.readPassword("Re-enter the password: ");
    System.out.println(dbPasswordTwo.toString());
} while (!Arrays.equals(dbPasswordOne, dbPasswordTwo)); 
```

在我看来，这应该可以正常工作（打印只是为了调试目的。但是，这是我在 Linux 终端中得到的输出：

```
Enter a password for the bookstall: 
[C@9e4acce
Re-enter the password: 
[C@40d0d75 
```

无论我输入什么，每次运行它总是相同的两个无意义的字符串。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T22:01:46.907

您正在`toString()`调用`char[]`. 自动装箱`char[]`并且您看到的字符串是它的参考名称。您必须将您的`char[]`转换为`String`.

尝试`System.out.println(new String(dbPasswordOne));`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T21:59:42.777

不要使用`dbPasswordTwo.toString()` `toString()`，因为这会打印出参考名称。只需删除`toString()`.

`PrintWriter`这是`System.out`有一个`println(char[])`方法，然后调用。这会打印出每个字符，并且不会`toString()`隐式调用该方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T22:05:42.970

这是一个完整的示例，改编自“Console.readPassword()”示例，我怀疑您可能正在使用：

```
/*
 * REFERENCE:
 * http://www.java2s.com/Tutorial/Java/0120__Development/Readpasswordfromconsole.htm
 *
 * SAMPLE OUTPUT:
 * Enter your login: abc
 * Enter your old password:
 * You entered: def...
 */
import java.io.Console;
import java.io.IOException;
import java.util.Arrays;

public class X {

  public static void main(String args[]) throws IOException {

    Console c = System.console();
    if (c == null) {
      System.err.println("No console.");
      System.exit(1);
    }

    String login = c.readLine("Enter your login: ");
    char[] oldPassword = c.readPassword("Enter your old password: ");

    String sPassword = new String(oldPassword);
    System.out.println ("You entered: " + sPassword + "...");
  }
} 
```

注意行`String sPassword = new String(oldPassword);`。这会将 char[] 数组转换为可打印的字符串。

'希望有帮助！

# javascript - 在对象列表中移动

> ID：14095071
> 
> 赞同：0
> 
> 时间：2012-12-30T21:56:15.880
> 
> 标签：javascript, jquery, html, jinja2

```
<div id="team-name">{{teams[0].name}}</div>
<button id="next">Next</button> 
```

当点击“下一个”按钮时，我希望团队名称成为列表中的下一个团队名称，即 0 变为 1？

我有一种感觉我需要 JS 来做这件事——但我不确定我将如何使用 JS 来做这件事。

此外，该列表是从服务器生成的。

**更新**

{{ }} 是模板系统的一部分——准确地说是 Jinja2。

团队列表通过 Jinja2 传递到网页中——因此网页可以访问整个团队列表——我希望这是有道理的。

```
class Team(db.Model):
    __tablename__ = 'Team'
    name = db.Column(db.String(21))
    matches_total = db.Column(db.Integer())
    matches_won = db.Column(db.Integer())
    matches_lost = db.Column(db.Integer()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:18:22.193

制作一个包含可用名称的列表，`team_names`并像这样更新您的模板：

```
<div id="team-name" data-index="0" data-entries="{{ team_names|tojson }}">{{teams[0].name}}</div>
<button id="next">Next</button> 
```

如果您使用的似乎是烧瓶，请将其传递给您的`render_template()`电话：

```
team_names=[t.name for t in Team.query] 
```

然后你可以使用下面的 jQuery 片段来做你想做的事：

```
$('#next').on('click', function(e) {
    e.preventDefault();
    var nameElem = $('#team-name');
    var entries = nameElem.data('entries');
    var index = (nameElem.data('index') + 1) % entries.length;
    nameElem.text(entries[index]).data('index', index);
}) 
```

**注意：此答案假设列表不是太大。**

# javascript - 在页面上的一张图像上淡入效果。

> ID：14095080
> 
> 赞同：0
> 
> 时间：2012-12-30T21:56:57.360
> 
> 标签：javascript, html, css

我的网页上有一张图片。图像不是背景，但它几乎覆盖了页面的 30%。并且图像对于网页（200KB）来说很大。因此，当图像完成加载时，它只会在看起来非常难看的页面上闪烁。所以我希望图像在网页上完全下载后淡入。由于图像的背景颜色和网页的背景颜色相同，它看起来像一个很好的动画。好像只有图像的内容正在淡入。有什么可能的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:09:16.097

由于您使用的是这么大的图像，我将假设它是 JPG。假设您不在移动设备上并且它正在闪烁，我还将假设它是基准 JPG。哇，这是很多假设:)

我建议使用渐进式 JPG，它会在加载粗略形式的内容的同时加载。它将逐步增强自身的层次，直到达到完整的质量。

您还可以将其包装在相同尺寸的 div 中，以防止您的内容四处乱跳。

如果你想让它淡入，你可以添加 display:none; 给您图像并在文档上使用 jquery 准备好使用 fadeIn 方法。

```
img {
    height:400px;
    width:400px;
    display:none;
}​

<img id="myimg" src="http://placehold.it/400x400" >​

$(document).ready(function() {
    $('#myimg').fadeIn('fast');
});​ 
```

# ios - ios的视频框架

> ID：14095083
> 
> 赞同：1
> 
> 时间：2012-12-30T21:57:24.350
> 
> 标签：ios, video, avfoundation

AVFoundation 是否有任何替代框架来播放视频文件？我对以下主题中描述的 AVFoundation 有疑问。

[https://stackoverflow.com/questions/14074753/mpmovieplayerviewcontroller-disappears-after-video-has-finished](https://stackoverflow.com/questions/14074753/mpmovieplayerviewcontroller-disappears-after-video-has-finished)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:05:34.833

iOS 框架中有两种不同的视频播放器：MPMoviePlayerController 和 AVPlayer。

如果 MPMoviePlayerController 不能满足您的要求，请尝试 AVPlayer。它的功能较少，但易于使用。

这是指南：http: [//developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html)

# ruby-on-rails - ajax提交后如何使输入字段为空？

> ID：14095084
> 
> 赞同：0
> 
> 时间：2012-12-30T21:57:25.727
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery

我在我的应用程序中实现**了一个聊天系统**。
提交新评论后，它会部分刷新评论列表。
因此，无需重新加载整个页面即可弹出新添加的评论。

它工作正常，但问题是，提交后它不会使输入字段为空（初始化）:(

如果提交成功，如何使其为空？
5 秒自动刷新将是另一个正在预防的问题。所以我也必须关心它。

如果可能，我想在用户尝试在 10 秒内提交评论时弹出“您不能发送垃圾邮件”的 Flash 警报。
假设我正在尝试从 Users#show 页面提交评论

**意见/用户/show.html.erb**

```
<%= javascript_tag do %>
    jQuery(document).ready(function () {
        refreshPartial();
        setInterval(refreshPartial, 5000)
    });

    function refreshPartial() {
      $.ajax({
        url: "<%= show_user_path(@user) %>/refresh_part",
        type: "GET",
        dataType: "script",
      });
    }
<% end %>
......
<span id="chat">
<%= render 'users/comment' %>
</span>
<%= render 'users/comment_input' %> 
```

**意见/用户/_comment.html.erb**

```
<table>
  <tr>
    <th>ID</th>
    <th>PIC</th>
    <th>Body</th>
    <th>Subject</th>
    <th>Posted by</th>
    <th>Delete</th>
  </tr>

<% @comments.each do |comment| %>
  <tr id="<%= dom_id(comment) %>">
    <td><%= comment.id %></td>
    <td>
            <% if comment.comment_icon? %>
                <ul class="thumbnails">
                <%= image_tag(comment.comment_icon.url(:thumb),:height => 100, :width => 100, :style => 'border:3px double #545565;' ) %>
                </ul>
            <% end %>

    </td>
    <td><%= comment.body %></td>
    <td><%= comment.subject %></td>
    <td><%= comment.user.user_profile.nickname if comment.user.user_profile %></td>
    <td>
    <%= button_to 'destroy', polymorphic_path([@user, comment]), :data => {:confirm => 'Are you sure?'}, :method => :delete, :disable_with => 'deleting...', :remote => true, :class => 'btn btn-danger' if current_user && current_user.id == comment.user_id %>
    </td>
    </tr>
<% end %>
</table>

<%= paginate @comments, :window => 4, :outer_window => 5, :left => 2, :right => 2 %> 
```

**views/users/_comment_input.html.erb** **<= 这是输入表单！！！！！！**

```
<%=form_for(([@user, @comment]), :remote => true) do |f| %>
    <div class="field">
      <%= f.label :body %><br />
      <%= f.text_field :body %>
    </div>
    <div class="field">
    <%= f.file_field :comment_icon %>
    </div>
  <div class="actions">
    <%= f.submit %>
  </div>

<% end %> 
```

**评论控制器.rb**

```
def create
  commentable = @community_topic||@community||@user
  @comments = commentable.comment_threads.order("updated_at DESC").page(params[:page]).per(5)
  @comment = Comment.build_from(commentable, current_user.try(:id), params[:comment][:body]) 
  @comment.comment_icon = params[:comment][:comment_icon] 

  if @user
    @following_users = @user.all_following(order: 'updated_at DESC') 
    @followed_users = @user.followers 
    @communities_user = @user.get_up_voted(Community).order("updated_at ASC").page(params[:page]).per(5)
  elsif @community      

  end

  last_comment = Comment.where(:user_id => current_user.id).order("updated_at").last

  if last_comment && (Time.now - last_comment.updated_at) <= 10.second  
    flash[:notice] = "You cannot spam!" 
    render :template => template_for(commentable)
  elsif @comment.save 
    #if  @community_topic.empty?
        @comments = commentable.comment_threads.order("updated_at DESC").page(params[:page]).per(5)
        @comment = commentable.comment_threads.build

        respond_to do |format|
            format.html { redirect_to [@community, commentable].uniq, :notice => "comment added!"  }
            format.js do
                if @community.present?
                  render 'communities/refresh_part' 
                elsif @community_topic.present?
                  render 'community_topics/refresh_part'
                elsif @user.present?
                  render 'users/refresh_part'
                end
            end
        end 
  else
    render :template => template_for(commentable)
  end
end 
```

**意见/用户/refresh_part.js.erb**

```
$('#chat').html("<%= j(render(:partial => 'users/comment')) %>") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:18:38.640

好吧，我假设这是您要清空的“正文”输入，所以基本上，只需向其中添加一个 id，如下所示：

```
<%= f.text_field :body, :id => "body_input" %> 
```

在您的**views/users/refresh_part.js.erb**中，您可以添加如下内容：

```
$('#body_input').val(''); 
```

这只有在提交成功时才有效，因为据我所知，只有在保存评论时才会呈现您的模板。

# asp.net-mvc-3 - 购物车应用策略

> ID：14095097
> 
> 赞同：1
> 
> 时间：2012-12-30T21:58:41.993
> 
> 标签：asp.net-mvc-3, sql-server-2008, shopping-cart

我正在为我的客户开发一个购物车应用程序，并试图找到一种策略来确保在购买过程中不会发生碰撞。

例如，如果库存中有五件商品，而两个客户恰好同时购买；库存应该剩下三件而不是四件。看来我必须在购买前知道当前库存是多少。此外，我需要一种方法来判断是否有人抓住了最后一件物品，即使他们还没有购买。

我应该使用什么策略/模式来确保满足这些条件？我正在使用 SQL Server 开发一个 .net mvc 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:44:59.680

啊并发。你有很多事情需要考虑：

1.  如果您存储库存并从中减去并在单独的更新中再次写入，则您的库存计数会出现问题
2.  如果您的更新是通过当前数量减少库存的单一交易，您可以使您的库存变为负数

您的更新必须：

1.  开始交易
2.  通过对其执行选择并读取库存来锁定有问题的行。处理手头不足的情况。
3.  如果有足够的库存更新第 3a 行，则在测试期间检查库存
4.  提交或回滚事务

有多种方法可以做到这一点，但上述方法在这里应该可以正常工作。您可以在代码中通过新的 transactionscope 对象或通过 begin transaction 在 proc 中的服务器端启动事务。

# ruby-on-rails - 什么是smalltalk的sinatra？

> ID：14095105
> 
> 赞同：5
> 
> 时间：2012-12-30T21:59:16.610
> 
> 标签：ruby-on-rails, smalltalk, seaside

我在网上看到了（Smalltalk + Seaside）VS（Ruby + Rails）的几个比较

但我想知道 Seaside 是否可以与 Rails 相媲美。什么是西纳特拉的等价物？

什么是 smalltalk 的 Web 微框架？

有吗？海边可以双向工作吗？可以比较伊利亚特吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T08:12:49.107

有几个可用的 Web 服务器和微型 Web 微框架可与 Sinatra 相媲美：[Zinc](http://zn.stfx.eu/zn/index.html)、[WebServer](http://www.squeaksource.com/KomHttpServer.html)、[Kom](http://www.squeaksource.com/KomHttpServer.html)和[Swazoo](http://www.swazoo.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T08:16:48.680

[Tim Felgentreff 的RatPack](https://github.com/timfel/ratpack)正是为 Smalltalk 提供 Sintara concpts。Tim 非常了解 Sinatra，并且对 RatPack 进行了一些类似的建模。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T21:44:19.703

Colin Putney 的 Altitude 是另一个轻量级 Web 框架：
[squeak-dev 邮件列表上的公告](http://forum.world.st/ANN-Altitude-td4640421.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T07:55:40.297

所有主要的 Smalltalk Web 框架（[Seaside](http://www.seaside.st)、[Aida](http://www.aidaweb.si)、[Iliad](http://www.iliadproject.org)和客户端[Amber](http://amber-lang.net)）都不包含持久性并且不使用模板，这些是与 Ruby on Rails 等框架的主要区别。为了进行比较（也许是为了回答您的问题），您可以查看[Aida、Seaside 和 Iliad 的比较](https://spreadsheets.google.com/ccc?key=0Atnb1W9vuq9ndGRTUFIzT3VON0lTQ3JxdlZYTUxhOFE&hl=en&authkey=CJva7-8L&pli=1#gid=0)。

# jquery - 如何使用 jquery 在文本输入中显示正确的数据

> ID：14095107
> 
> 赞同：0
> 
> 时间：2012-12-30T21:59:19.983
> 
> 标签：jquery, html, textinput

下面我有一个表单，其中包含一个包含学生当前课程详细信息的文本输入和一个包含课程列表的课程下拉菜单。

```
<form action='editstudent.php' method='post' id='studentForm'>
<p><strong>Students:</strong> <select name="student" id="studentsDrop">
<option value="">Please Select</option>
<option value='38'>u0495333 - Jack smith</option>
<option value='1'>u0867587 - Mayur Patel</option>
<option value='36'>u0867588 - paul smith</option>
</select> </p>   
<div id='targetdiv'></div> 
</form>

    <form id='editForm'>

        <p><strong>Current Student Details</strong></p>
        <table>
<tr>
<th></th>
<td><input type='hidden' id='currentStudentId' name='StudentIdcurrent' value='' /> </td>
</tr>

        <tr>
        <th>Course:</th>
        <td><input type='text' id='currentStudentCourse' name='StudentCoursecurrent' readonly='readonly' value=''/> </td>
        </tr>
        </table>

        <p><strong>New Student Details</strong></p>
        <table>
<tr>
<th></th>
<td><input type='hidden' id='newStudentId' name='StudentIdNew' value='' /> </td>
</tr>
        <tr>
        <th valign='top'>Course:</th>
        <td id='datacourse' valign='top'><select name="courses" id="newStudentCourse">
    <option value="">Please Select</option>
    <option value='1'>INFO101 - Bsc Information Communication Technology</option>
    <option value='2'>INFO102 - Bsc Computing</option>
    <option value='8'>INFO103 - Business and Finance</option>
    <option value='7'>INFO104 - English</option>
    <option value='9'>INFO107 - Mathematics and Stats</option>
    <option value='16'>INFO120 - Science</option>
    </select>
        <div id='studentCourseAlert'></div></td>
        </tr>
        </table>

        </form> 
```

现在使用下面的代码，它会在文本输入中显示课程编号和课程名称，并通过定位课程的 ID 从下拉菜单中的课程列表中选择学生的课程。

```
$(document).ready( function(){

    var studentinfo = [{"StudentId":1,"CourseId":19,"CourseNo":"BIO234","CourseName":"Biology"},
{"StudentId":38, "CourseId":1,"CourseNo":"INFO101","CourseName":"Bsc Information Communication Technology"},
{"StudentId":36, "CourseId":8,"CourseNo":"INFO103","CourseName":"Business and Finance"} ];

    $('#studentsDrop').change( function(){

    var studentId = $(this).val();

        if (studentId !== '') {
    for (var i = 0, l = studentinfo.length; i < l; i++)
    {
    if (studentinfo[i].StudentId == studentId) { 

    var currentcourse = $('#currentStudentCourse').val(studentinfo[i].CourseNo + " - " + studentinfo[i].CourseName);
    var newcourse = $('#newStudentCourse').val(studentinfo[i].CourseId);

    $('.courses').val(newcourse);

    break;       
    }
    }  
    }

    });

}); 
```

我遇到的问题如下。我想更新 txt 输入，以便它显示新的课程详细信息。但我似乎无法弄清楚的问题是，它不是在文本输入中显示课程编号和课程名称，而是在文本输入中显示更新的课程 ID。现在我知道它为什么这样做了，因为这`jQuery("#currentStudentCourse").val(newStudentCourse);`会将课程 ID 值显示到文本输入中。但我的问题是，如何使用课程 ID 来查找 ID 的课程编号和课程名称，以便在更新后在文本输入中显示课程编号和课程名称？

```
function submitform() {    

$.ajax({
type: "POST",
url: "updatestudent.php",
data: $('#editForm').serialize(),
success: function(html){

var newStudentCourse = jQuery("#newStudentCourse").val();

jQuery("#currentStudentCourse").val(newStudentCourse);

}
});        
} 
```

**更新：**

这是一个[应用程序](http://helios.hud.ac.uk/u0867587/Mobile_app/Text9.php)，您可以在其中选择一个学生，然后选择一门新课程并提交。您将在当前课程文本输入中看到它变为一个数字，即课程 ID。包含相同代码的 Jsfiddle 在这个 jsfiddle 中：http: [//jsfiddle.net/Dst4Q/6/](http://jsfiddle.net/Dst4Q/6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:39:41.970

你应该能够得到你想要的信息

```
$("#newStudentCourse option:selected").text() 
```

# javascript - JQuery CSS 彩色时钟

> ID：14095111
> 
> 赞同：0
> 
> 时间：2012-12-30T21:59:39.617
> 
> 标签：javascript, jquery, css

我正在使用以下 jQuery 组件：

[http://tutorialzine.com/2009/12/colorful-clock-jquery-css/](http://tutorialzine.com/2009/12/colorful-clock-jquery-css/)

并且需要将其设置为透明背景。我设置的背景透明的 CSS 如下：

```
.clock .bg, .clock .front{
        width:100px;
        height:200px;
        background-color:#252525;
        position:absolute;
        top:0;
    } 
```

但是，当我这样做时，时钟无法按需要运行，因为左侧圆圈的一部分仍然可见。

关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:09:30.460

无法使用此时钟设置透明背景。

动画依赖于 div 的不透明性，因此它们将遮挡用于创建移动表盘效果的部分图像。

从原始教程中看到这个解释，左上角的图像有一个注释“隐藏在左前 div 下” [http://cdn.tutorialzine.com/wp-content/uploads/2009/12/i22.png](http://cdn.tutorialzine.com/wp-content/uploads/2009/12/i22.png)

# android - Android 4.2.1 的 AES 加密问题

> ID：14095115
> 
> 赞同：0
> 
> 时间：2012-12-30T21:59:52.757
> 
> 标签：android, encryption

> **可能重复：**
> [Android 4.2 上的加密错误](https://stackoverflow.com/questions/13383006/encryption-error-on-android-4-2)

我正在使用该加密类使用 AES 加密我的字符串，但它在 Android 4.2.1 之后引发异常。SDK 17（Android 4.2.1）可以改变什么？这是我的类和 LogCat：

```
import java.security.SecureRandom;

import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.SecretKeySpec;

/**
 * Usage:
 * <pre>
 * String crypto = AESEncrypt.encrypt(masterpassword, cleartext)
 * ...
 * String cleartext = AESEncrypt.decrypt(masterpassword, crypto)
 * &lt;/pre&gt;
 * @author ferenc.hechler
 */
public class AESEncrypt {

    public static String encrypt(String seed, String cleartext) throws Exception {
        byte[] rawKey = getRawKey(seed.getBytes());
        byte[] result = encrypt(rawKey, cleartext.getBytes());
        return toHex(result);
    }

    public static String decrypt(String seed, String encrypted) throws Exception {
        byte[] rawKey = getRawKey(seed.getBytes());
        byte[] enc = toByte(encrypted);
        byte[] result = decrypt(rawKey, enc);
        return new String(result);
    }

    private static byte[] getRawKey(byte[] seed) throws Exception {
        KeyGenerator kgen = KeyGenerator.getInstance("AES");
        SecureRandom sr = SecureRandom.getInstance("SHA1PRNG");
        sr.setSeed(seed);
        kgen.init(128, sr); // 192 and 256 bits may not be available
        SecretKey skey = kgen.generateKey();
        byte[] raw = skey.getEncoded();
        return raw;
    }

    private static byte[] encrypt(byte[] raw, byte[] clear) throws Exception {
        SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
        Cipher cipher = Cipher.getInstance("AES");
        cipher.init(Cipher.ENCRYPT_MODE, skeySpec);
        byte[] encrypted = cipher.doFinal(clear);
        return encrypted;
    }

    private static byte[] decrypt(byte[] raw, byte[] encrypted) throws Exception {
        SecretKeySpec skeySpec = new SecretKeySpec(raw, "AES");
        Cipher cipher = Cipher.getInstance("AES");
        cipher.init(Cipher.DECRYPT_MODE, skeySpec);
        byte[] decrypted = cipher.doFinal(encrypted);
        return decrypted;
    }

    public static String toHex(String txt) {
        return toHex(txt.getBytes());
    }
    public static String fromHex(String hex) {
        return new String(toByte(hex));
    }

    public static byte[] toByte(String hexString) {
        int len = hexString.length()/2;
        byte[] result = new byte[len];
        for (int i = 0; i < len; i++)
            result[i] = Integer.valueOf(hexString.substring(2*i, 2*i+2), 16).byteValue();
        return result;
    }

    public static String toHex(byte[] buf) {
        if (buf == null)
            return "";
        StringBuffer result = new StringBuffer(2*buf.length);
        for (int i = 0; i < buf.length; i++) {
            appendHex(result, buf[i]);
        }
        return result.toString();
    }
    private final static String HEX = "0123456789ABCDEF";
    private static void appendHex(StringBuffer sb, byte b) {
        sb.append(HEX.charAt((b>>4)&0x0f)).append(HEX.charAt(b&0x0f));
    }

} 
```

这是 LogCat [http://sharetxt.com/?s=Ljao4rAM](http://sharetxt.com/?s=Ljao4rAM)

# c# - 偶尔 (OAuthException - #200) (#200) 用户必须已接受 TOS

> ID：14095119
> 
> 赞同：3
> 
> 时间：2012-12-30T22:00:16.700
> 
> 标签：c#, facebook-oauth

我相信我的应用程序编码正确（至少大部分情况下），因为它在大约 98% 的时间里都能正常工作。但是，大约 2% 的时间，我得到了一个有效的身份验证令牌，但是当我发布照片时，我收到以下错误“（OAuthException - #200）（#200）用户必须有接受服务条款”。我有重试逻辑，但它得到同样的错误三次（所以这不是一个奇怪的通信故障）。

我使用 URL facebook.com/dialog/oauth 来获取令牌，然后使用 C# Facebook 客户端（Post 方法）。

我看到与此错误一起发布的其他问题似乎涉及一致的失败，表明应用程序错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:04:53.890

是否有可能向一个人显示权限页面（在 Facebook 上）并拒绝它，因此用户随后被重定向回您的网站，但出现 Oauth 错误 - 您需要处理。

基本上，我想通过 Facebook 登录，但我不接受他们的条件（例如，您可能要求的东西太多）。因此我会拒绝登录，源网站（你）需要处理拒绝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T17:48:17.243

在最终与 Facebook 上的某个人交谈后，这似乎是他们方面的一个问题——考虑到处理他们的用户群所需的大量并行处理，提供的身份验证令牌可能到那时还没有复制到所有其他服务器我的应用程序（来自不同的位置）试图使用令牌。

Facebook 提供的建议是在重试过程中留出更多时间——虽然它通常在一分钟内处理，但有时可能需要长达 30 分钟才能复制到所有服务器。

# java - 如何将数据库中的值设置到文本字段中

> ID：14095122
> 
> 赞同：1
> 
> 时间：2012-12-30T22:00:38.143
> 
> 标签：java

```
 private void btgetinvActionPerformed(java.awt.event.ActionEvent evt) {
        //JOptionPane.showMessageDialog(null, "REMITTANCE ID IS VALID!");
        try {
            DBUtil util = new DBUtil();
            Connection con = util.getConnection();
            PreparedStatement stmt = con.prepareStatement("select bk_det.rm_id from bk_det WHERE dbo.bk_det.rm_id = ?");
            ResultSet rs;
            String rm = tf_rmid.getText().trim();
            stmt.setInt(1, Integer.parseInt(rm));
            rs = stmt.executeQuery();
            while (rs.next()) {
                int i = Integer.parseInt(rs.getString("box_no"));
                tfbrname.setText(rs.getString(i));
            }
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(null, ex.getMessage());

        }
    } 
```

我实际上是在尝试从名为 dbo.bk_det 的数据库表中搜索值。我从我的文本字段 tf_rmid 中获取 WHERE 的值。一切都顺利进行，没有错误，但是一旦我插入 rm_id 并单击按钮 btgetinv 它说 123 这是我的 rm_id 超出范围无法理解错误在哪里以及问题出在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:15:57.863

`rs.next()`如果它不再包含任何记录，则返回 false。因此，如果您想在未找到记录时执行某些操作，则必须检查记录数。

例如，

```
int recordCount = 0;
while (rs.next()) {
    recordCount++;
    int i = Integer.parseInt(rs.getString("box_no"));
    tfbrname.setText(rs.getString(i));
}
if(recordCount == 0) {
    // do something : report an error or log
} 
```

有关详细信息，请参阅[http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#next()](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#next%28%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:40:13.463

问题在于以下陈述：

```
int i = Integer.parseInt(rs.getString("box_no"));
tfbrname.setText(rs.getString(i)); 
```

第一条语句不会按照您想要的方式工作，因为在 select 子句中没有名为“box_no”的列。它会抛出异常。假设您将代码更改为在 select 子句中包含 box_no。然后，第二条语句将尝试检索第 n 列，其中该列的值为 box_no。我想你只是想要：

```
tfbrname.setText(rs.getString("box_no")); 
```

同样，仅当您的 SELECT 语句在字段列表中包含 box_no 时，上述内容才有效。

# apache - 与 Apache Web 服务器的串行端口通信

> ID：14095123
> 
> 赞同：1
> 
> 时间：2012-12-30T22:00:48.140
> 
> 标签：apache, serial-port

我正在尝试将基于 ASP.NET 的 Web 应用程序部署到 Apache/mod-mono 该应用程序仅供我个人使用，因为它根本不安全：我必须访问 Web 服务器的串行端口！当我在 Windows 上运行我的应用程序（使用 VS2010 中的服务器）时，一切都很好，我可以访问串行端口并通过它进行通信，但是当我在 Apache 服务器上尝试它时，事情变得很糟糕。我的 Web 应用程序行为正常，但是当我尝试访问串行端口时出现内部服务器错误。

我认为问题出在服务器没有访问串口的权限，但是我该如何克服这个问题呢？

# jquery - 传递 jQuery HTTP Get (Django)

> ID：14095124
> 
> 赞同：0
> 
> 时间：2012-12-30T22:00:48.613
> 
> 标签：jquery, django

我已经调试了很长时间，但找不到解决方案。我想要的是当有人点击一个按钮时，他们会发送一个由我的视图和某些 ID 生成的唯一密钥。

这样做之后，我想刷新页面上的 2 张图片并用新的更新自动生成的密钥。

当我遇到一个帖子时，我处理数据并返回

```
return HttpResponseRedirect('/') 
```

当我遇到 GET 时，我会处理数据、生成密钥并提供 2 个新图像。我带着

```
return render(request,.. 
```

这就是我打算使用模板更新 unique_id 的方式

```
<script>
$(document).ready(function() {  
  $('#button1').click(function(){
    $.post("/", { 
      unique_id : "{{ unique_id }}",
      id1 : {{ id1 }},
      id2 : {{ id2 }},
      csrfmiddlewaretoken: '{{ csrf_token }}'
    });
  }); 
```

但是，我注意到发生的是我按下按钮发送 POST 并且我收到一个没有错误的 GET 响应。但是，GET 响应不会更新页面，因此唯一 ID 不会更新，所以当我再次按下按钮发送下一个 POST 时，我会收到旧的唯一 ID。

这是因为我的 HTTP GET 没有从 jQuery 传递到实际的浏览器。我错过了一步吗？由于我确实有一个 HTTP GET，有没有办法让 jquery 只更新两个标签和唯一 ID？

# php - Codeigniter - 设置多个会话

> ID：14095130
> 
> 赞同：0
> 
> 时间：2012-12-30T22:01:18.147
> 
> 标签：php, codeigniter, session-variables

我正在尝试设置 2 个会话：

```
$this->session->set_userdata('name', 'value'); 
```

但是我只能设置一个。我有：

```
$this->session->set_userdata('logged_in', TRUE);
$this->session->set_userdata('user_id', $user['id']); 
```

第一个有效，但第二个从未设置。

有谁能够帮助我？

谢谢！

PS：我是葡萄牙人，我可能有一些语法错误。对此感到抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T09:25:07.203

> $this->session->set_userdata(array('logged_in' => TRUE, 'user_id'=> $user['id']));

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T09:36:23.163

在您的情况下，`$user`不是数组，而是对象：

```
$this->session->set_userdata('user_id', $user->id); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T09:16:23.093

如果`$user = $query->row_array()`：

```
$this->session->set_userdata('logged_in', TRUE);
$this->session->set_userdata('user_id', $user['id']); 
```

如果`$user = $query->row()`：

```
$this->session->set_userdata('logged_in', TRUE);
$this->session->set_userdata('user_id', $user->id); 
```

**http://ellislab.com/codeigniter/user-guide/database/results.html**

如果它仍然不起作用，试试这个：

```
 $this->db->where('email',$email);
    $this->db->where('password',$password);
    $query = $this->db->get('users');
    return $query->row(); 
```

* ***我的英语不好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T09:32:31.890

您没有正确使用该功能。

来自[CI 手册](http://ellislab.com/codeigniter/user-guide/database/results.html)

```
$this->session->set_userdata('logged_in', TRUE);
$this->session->set_userdata('user_id', $user->id); 
```

这就是您设置所有会话数据的方式。

请注意，这`$user`会产生一个对象而不是数组。所以你的访问是错误的。否则，您可以使用上述`row_array()`功能和访问权限

# php - 在数据库中存储会话 - 数据被覆盖

> ID：14095131
> 
> 赞同：1
> 
> 时间：2012-12-30T22:01:21.883
> 
> 标签：php, session

某处，某事导致将空会话写入我的数据库。

我最近实施了使用 Zend/Db 的更改，只是在此之后我遇到了问题。

这是我的阅读功能

```
public function read($sessionId)
{

    $sql = new Sql($this->database);
    $predicate = new Where();

    $query = $sql->select();
    $query->from('sessions');
    $query->columns(array('sessiondata'));
    $query->where($predicate->equalTo('sessionid', $sessionId));
    $query->where($predicate->greaterThan('expiry', new Expression("NOW()")));

    /**
     * @var $stmt \Zend\Db\Adapter\Driver\StatementInterface;
     */

    $stmt = $sql->prepareStatementForSqlObject($query);
    $result = $stmt->execute();

    if ($result instanceof ResultInterface && $result->isQueryResult() && $result->getAffectedRows() > 0) {
        $resultSet = new ResultSet;
        $resultSet->initialize($result);

        $data = $resultSet->toArray();
        return $data[0]['sessiondata'];
    } else {
        echo "read_fail";
        return false;
    }
} 
```

还有我的写功能

```
public function write($sessionId, $sessionData)
{

    $expiry = date("Y-m-d H:i:s", time() + CATALINA_MAX_SESSION_TIME - 1);

    $sql = new Sql($this->database);
    $query = $sql->select()
        ->from('sessions')
        ->columns(
            array(
                'sessionid'
            )
        )
        ->where(
            array(
                'sessionid' => $sessionId
            )
        );

    /**
     * @var $stmt \Zend\Db\Adapter\Driver\StatementInterface;
     */

    $stmt = $sql->prepareStatementForSqlObject($query);
    $result = $stmt->execute();

    $sql = new Sql($this->database);

    if ($result->count() > 0) {

        $query = $sql->update('sessions')
            ->set(array(
                        'expiry' => new Expression("NOW() + interval 1 hour"),
                        'touch' => new Expression("NOW()"),
                        'sessiondata' => $sessionData
                )
        )
            ->where(array('sessionid' => $sessionId));

    } else {

        $query = $sql->insert()
            ->into('sessions')
            ->columns(
                array(
                    'sessionid',
                    'expiry',
                    'sessiondata'
                )
            )
            ->values(
                array(
                    'sessionid' => $sessionId,
                    'expiry' => $expiry,
                    'sessiondata'=> $sessionData
                )
            );
    }

    $stmt = $sql->prepareStatementForSqlObject($query);
    $result = $stmt->execute();
} 
```

我在这里遗漏了什么导致空会话覆盖数据库中的活动会话吗？

谢谢

# javascript - 我的 else if 语句给出语法错误

> ID：14095134
> 
> 赞同：-2
> 
> 时间：2012-12-30T22:01:41.907
> 
> 标签：javascript

```
window.setInterval(function(){

var value = $("#pizzaNumber").val();

if (value=0) {

document.getElementById('type2').style.display = 'none';

document.getElementById('type3').style.display = 'none';

{

else if (value=2) {

document.getElementById('type2').style.display = 'block';

}

else if (value=3) {

document.getElementById('type2').style.display = 'block';

document.getElementById('type3').style.display = 'block';

}

else {

document.getElementById('type2').style.display = 'none';

document.getElementById('type3').style.display = 'none';

alert("Invaild Number Entered");

}

}, 2000); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:04:36.610

您的第一个 if 语句由 a`{`而不是 a关闭`}`。这就是导致您的语法错误的原因。但是，正如大卫所说，您应该使用`==`or进行比较，`===`而不是`=`. 单一`=`是分配，而不是比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:02:23.583

比较数字时使用`===`运算符。不是赋值运算符`=`。

```
 if ( a === b ) 
```

此外，您的第一个 if 语句缺少一个结束括号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:04:11.317

*用右*括号结束你的第一个 if 块：

```
if (foo) {

} 
```

另外，不要在条件中赋值：

```
if (value === 0) // not if (value = 0) 
```

# java - Java EntityManager 空指针

> ID：14095138
> 
> 赞同：-1
> 
> 时间：2012-12-30T22:01:52.453
> 
> 标签：java, eclipselink

我正在尝试检索一个简单的 JSON 列表，将此 JSON 数组转换为 Eclipselink 对象并将它们放入 postgres。尽管我不断从 EntityManager 获取空指针，但我已经迷失了方向。

我从测试网络服务调用我的控制器：

```
@WebServlet(name = "Test", urlPatterns = {"/Test"})
public class Test extends HttpServlet {

    /**
     * Processes requests for both HTTP
     * <code>GET</code> and
     * <code>POST</code> methods.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        try {
            // HERE I CALL CUSTOM METHODS
            AppController appConn = new AppController();
            appConn.updateAppList();
        } finally {            
            out.close();
        }
    } 
```

在控制器中，我试图保留这些转换后的对象：

```
public class AppController {
    @PersistenceUnit(unitName="UserPU")
    EntityManagerFactory emf;
    EntityManager em = emf.createEntityManager();

    public AppController() {

    }

    public void updateAppList() {
        try {
            URLController urlConn = new URLController(Config.allAppsURL);
            JsonElement jelement = new JsonParser().parse(urlConn.toString());
            JsonObject  jobject = jelement.getAsJsonObject();
            jobject = jobject.getAsJsonObject("applist");
            JsonArray jarray = jobject.getAsJsonArray("apps");

            ArrayList<SteamApp> apps = new ArrayList<App>(){};
            for(int i = 0; i < jarray.size(); i++) {
                JsonObject jsteamObject = jarray.get(i).getAsJsonObject();
                App app = new SteamApp(jsteamObject.get("appid").getAsLong(), jsteamObject.get("name").toString());
                apps.add(app);
                //System.out.println("App[" + app.getAppid() + ", " + app.getName() + "] \n\r");
            }

            em.persist(apps);
            em.flush();

        } catch (Exception ex) {
            Logger.getLogger(AppController.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
} 
```

我从 web 服务调用这个方法，只是为了测试它。我计划在后台使用单独的线程将其拉入。

但我做错了什么？这种持久性设置非常混乱？！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:16:49.020

主要问题是它`AppController`不是托管对象，因此不会在其中执行依赖注入。您要么需要将`AppController`servlet 作为托管 bean注入，要么`EntityManagerFactory`使用`javax.persistence.Persistence`实用程序类手动初始化。如果它是完全无状态的，您可以使用注释`AppController`将其作为 CDI 托管 bean 注入。`@Inject`

如果您确实注入 AppController 的另一个问题是，仅在构造对象`EntityManagerFactory`后才注入`AppController`，但在对象构造期间初始化字段。当创建一个新的 AppController 对象时，该`emf`字段被初始化为 null，因此尝试初始化该`em`字段将导致空指针异常。

EntityManagers 也不是线程安全的，所以如果你确实通过 CDI 注入它，你将需要`EntityManager`在方法中从工厂创建`updateAppList()`。这样做的缺点是事务管理和关闭实体管理器将是您自己的责任。

另一种方法是将 bean 转换`AppController`为 EJB 无状态会话 bean，然后将其注入 servlet。在这种情况下，您不需要注入 EntityManagerFactory，而是可以直接`EntityManager`使用`@PersistenceContext`注解注入。

# javascript - config.js 不适用于 CKEditor

> ID：14095139
> 
> 赞同：7
> 
> 时间：2012-12-30T22:02:21.540
> 
> 标签：javascript, ruby-on-rails, ckeditor

我`config.js`的 CKEditor 中有以下内容：

```
CKEDITOR.editorConfig = function( config )
{
    config.toolbar =
    [
        [ 'Source', '-', 'Bold', 'Italic' ]
    ];
    // config.toolbar_Basic =
    // [
    //     [ 'Source', '-', 'Bold', 'Italic' ]
    // ];
    // config.toolbar = 'Basic';
} 
```

编辑器仍然显示工具栏中的所有选项。

它还以正确的顺序加载 JS 文件：

```
<script src="/assets/ckeditor/init.js?body=1" type="text/javascript"></script>
<script src="/assets/ckeditor/ckeditor.js?body=1" type="text/javascript"></script>
<script src="/assets/ckeditor/config.js?body=1" type="text/javascript"></script> 
```

所以我不确定这里发生了什么。有什么想法吗？

同样重要的是要注意，我尝试了声明该`Basic`工具栏的替代方法（请参阅上面代码片段中注释掉的代码），但它也不起作用。

每次更改后，我都会重新启动服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T12:58:46.177

你如何加载你的ckeditor来代替textarea？也许工具栏在那里被覆盖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T08:52:19.207

您的`config.js`文件看起来不错（它的两个版本）。

可能有问题的是您加载 CKEditor 的方式。首先 - 你不需要加载 config.js - CKEditor 会这样做。第二，`init.js`文件里有什么？

您是否清除了浏览器中的缓存？在某些情况下，自动执行此操作可能非常困难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T10:16:12.383

在此处下载 CKEditor 3.2.1：http: [//ckeditor.com/download](http://ckeditor.com/download)

解压下载的 .tar.gz 文件。

将ckeditor文件夹的内容复制到/sites/all/modules/contrib/ckeditor/ckeditor

此时，您可能想要编辑可用的工具栏选项，删除任何不必要的项目。在大多数情况下，我更喜欢以下配置，因为它允许最大程度的花哨，同时最大限度地减少可能覆盖网站样式的标记类型

编辑/sites/all/modules/contrib/ckeditor/ckeditor.config.js

通过将以下配置添加到 ckeditor.config.js 来创建一个新工具栏：

**

```
config.toolbar_DrupalCustom = [
      ['Source'],
      ['Cut','Copy','Paste','PasteText','-','SpellChecker', 'Scayt'],
      ['Undo','Redo','Find','Replace','-','SelectAll','RemoveFormat'],
      ['Image','HorizontalRule','Smiley','SpecialChar'],
      ['Bold','Italic','Underline','Strike','-','Subscript','Superscript'],
      ['NumberedList','BulletedList','-','Blockquote'],
      ['Link','Unlink','Anchor','LinkToNode', 'LinkToMenu'],      
      ['Format','Font','FontSize'],
      ['TextColor','BGColor'],
      ['Maximize', 'ShowBlocks'],
      ['DrupalBreak', 'DrupalPageBreak']
     ]; 
```

** 您现在可以在 /admin/settings/ckeditor/edit/Advanced 的 CKEditor 外观部分中选择此选项

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-13T18:39:21.943

我也遇到了 CKEditor 和“缓存”问题。清除缓存，加载自定义配置文件...和时间戳...

[http://ckeditor.com/forums/CKEditor/Problem-with-config.js-not-updating](http://ckeditor.com/forums/CKEditor/Problem-with-config.js-not-updating)

没有任何效果。然后我在实例化编辑器时简单地将其添加为选项：

```
CKEDITOR.replace( 'controls_' + int_control_cnt + '_label_text' ,
            {
            toolbar: [
                ['Bold', 'Italic', 'Underline', '-', 'TextColor', '-', 'RemoveFormat'],
                ['Cut', 'Copy', 'Paste', '-', 'Undo', 'Redo']
            ]
            }); 
```

这成功了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-09T19:47:47.407

仅使用： `<script src="ckeditor/ckeditor.js"></script>`

并确保清除浏览器缓存！

# php - 在将 JSON 从 iOS 发送到 Web 服务器上的 PHP 脚本时上传文件

> ID：14095144
> 
> 赞同：-2
> 
> 时间：2012-12-30T22:02:54.170
> 
> 标签：php, objective-c, ios

我目前正在将我的 iOS 应用程序中的 JSON 数据发送到我的 Web 服务器上的 PHP 脚本。这是我在 iOS 中用来发送数据的代码：

```
NSData* jsonData = [NSJSONSerialization dataWithJSONObject:newDatasetInfo options:kNilOptions error:&error];

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL: [NSURL URLWithString:@"http://www.myserver.com/upload.php"]];
[request setHTTPMethod:@"POST"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
[request setHTTPBody:jsonData];

NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
[connection start]; 
```

在 PHP 方面：

```
$handle = fopen('php://input','r');
$jsonInput = fgets($handle);
// Decoding JSON into an Array
$decoded = json_decode($jsonInput,true); 
```

如何同时修改 iOS 代码和 PHP 代码，以便能够将文件从 iOS 应用程序上传到 PHP 代码，然后 PHP 代码用于在本地写入磁盘？该文件将是一个音频文件。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:55:50.917

我对Obj-C不太了解，但基本上你需要使用`multipart/form-data`容器，例如

```
Content-Type: multipart/form-data; boundary="xx"

--xx
Content-Type: audio/mpeg
Content-Length: 12345
Content-Disposition: attachment; name="file"; filename="music.mp3"

<contents of mp3>

--xx
Content-Disposition: form-data; name="data"
Content-Type: application/json
Content-Length: 123

<contents of json data>

--xx-- 
```

使用 PHP，您可以使用以下方式访问数据：

```
$_FILES['file'] // the uploaded file

$_POST['data'] // the json data 
```

# javascript - FB.ui 没有回调

> ID：14095146
> 
> 赞同：2
> 
> 时间：2012-12-30T22:03:05.220
> 
> 标签：javascript, facebook, facebook-javascript-sdk, fb.ui

我无法运行 Facebook UI 回调。我使用了来自 FB 开发网站的示例：

[https://developers.facebook.com/docs/reference/dialogs/feed/](https://developers.facebook.com/docs/reference/dialogs/feed/)

```
FB.init({appId: "YOUR_APP_ID", status: true, cookie: true});

function postToFeed() {

    // calling the API ...
    var obj = {
      method: 'feed',
      redirect_uri: 'YOUR URL HERE',
      link: 'https://developers.facebook.com/docs/reference/dialogs/',
      picture: 'http://fbrell.com/f8.jpg',
      name: 'Facebook Dialogs',
      caption: 'Reference Documentation',
      description: 'Using Dialogs to interact with users.'
    };

    function callback(response) {
      document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
    }

    FB.ui(obj, callback);
} 
```

当我在我的网站上运行它时，我没有收到回调 [https://www.ipassexam.com/page/fb-test](https://www.ipassexam.com/page/fb-test)

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:38:51.350

摆脱 redirect_uri 参数。这对我每次都有效：

```
FB.ui({
    method: 'feed',  
    link: "http://...",
    name: "Some Title",
    caption: "Some Caption",
    description: "Some Description",
    picture: "http://..."
}, function(response) {
    if (response && response.post_id) {
        alert('Post was published.');
    } else {
        alert('Post was not published.');
    }
}); 
```

还要确保控制台中没有错误。但无论如何我没有看到任何错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T18:52:04.560

花了 2 个小时解决问题，解决方案是，提及显示属性（在我的情况下是弹出窗口）。

```
function postToFeed() {

// calling the API ...
var obj = {
  method: 'feed',
  **display: 'popup',**
  link: 'https://developers.facebook.com/docs/reference/dialogs/',
  picture: 'http://fbrell.com/f8.jpg',
  name: 'Facebook Dialogs',
  caption: 'Reference Documentation',
  description: 'Using Dialogs to interact with users.'
};

function callback(response) {
  document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
}

FB.ui(obj, callback); 
```

}

提示：如果 display 被明确指定为 popup，redirect_uri 不是强制性的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-27T09:07:26.987

尝试使用“popup”设置显示属性，请求如下：

```
FB.ui({
    method: 'feed',  
    link: "http://...",
    name: "Some Title",
    caption: "Some Caption",
    description: "Some Description",
    display: "popup",
    picture: "http://..."
}, function(response) {
    if (response && response.post_id) {
        alert('Post was published.');
    } else {
        alert('Post was not published.');
    }
}); 
```

当我尝试使用 feed 方法发布时，我在 FB 画布页面中遇到了这个问题，我总是得到“未定义”的响应。我已经尝试了上述属性，现在它正在工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T02:03:55.560

尝试在之前添加这个`FB.init`

```
window.fbAsyncInit = function() { //put FB.init here }

 (function(d){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = '//connect.facebook.net/en_US/all.js';
   ref.parentNode.insertBefore(js, ref);
 }(document)); 
```

才会变成这样

```
window.fbAsyncInit = function() {
 FB.init({appId: "YOUR_APPID", status: true, cookie: true});
};

(function(d){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = '//connect.facebook.net/en_US/all.js';
   ref.parentNode.insertBefore(js, ref);
 }(document)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T22:05:48.340

也许您应该尝试使用匿名函数作为回调 -

```
FB.ui(obj, function(response) {
  document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-13T15:25:44.763

可能不是你的情况，但我几乎一周都在寻找类似行为的原因，最后我发现 FB.ui 试图创建 iframe 以显示在页面上，为此在 div 下创建了这个 iframe id=fb-root。不幸的是，这个 div 位于另一个 div 中，我自己将其设为不可见！所以 - 长话短说 - 检查你是否有 id=fb-root 的 div 以及这个 div 是否可见

# python - 在 Python 3 中删除/替换打印

> ID：14095150
> 
> 赞同：1
> 
> 时间：2012-12-30T22:04:24.190
> 
> 标签：python, printing

> **可能重复：控制台中的**
> [Python 进度条文](https://stackoverflow.com/questions/3160699/python-progress-bar)
> [本进度条](https://stackoverflow.com/questions/3173320/text-progress-bar-in-the-console)

所以我正在开发一个基本程序，我正在尝试做两件事：

1.  一个 Loading... 文本行，其中的点以这种方式增加：

    正在加载。

    加载中..

    正在加载...

    正在加载。

    加载中..

    正在加载...

2.  一行中增加的百分比：

    1% 完成...

    3% 完成...

    等等

所以，我的问题是如何删除/替换打印的文本？我希望这些事情发生在一条线上。对于第一个示例，如何仅用 1 替换 3 个点，或者仅删除末尾的 2（不转到下一行）？对于第二个示例，如何在保持在同一条线上的同时使百分比增加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:36:42.967

```
>>> for i in range(100):
...    time.sleep(1)
...    sys.stdout.write("\r%d%%" %i)    # or print >> sys.stdout, "\r%d%%" %i,
...    sys.stdout.flush()
... 
```

这将帮助您了解百分比。

# jquery - 您如何使链接文本表现得像普通文本一样？

> ID：14095153
> 
> 赞同：2
> 
> 时间：2012-12-30T22:04:50.040
> 
> 标签：jquery, css

我使用 css 和 jquery 对悬停使用模糊效果。当您将鼠标悬停在其中一段文本上时，css 的某些部分将使用 jquery 应用于兄弟姐妹。如果您查看[链接](http://tragicclothing.co.uk/del.html)，则“音乐”文本没有超链接，并且在悬停时按照我的意愿行事。但是其余的都是链接的，我希望它们在超链接时表现得像“音乐”。

**CSS：**

```
.blur {
text-decoration: none;
color: #339;
-webkit-transition: 400ms ease 100ms;
-moz-transition: 400ms ease 100ms;
transition: 400ms ease 100ms;

}  

.textshadow {
text-decoration: none;
color: rgba(0,0,0,0);
outline: 0 none;
-webkit-transition: 400ms ease 100ms;
-moz-transition: 400ms ease 100ms;
transition: 400ms ease 100ms; }  
.out {
text-shadow: 0 0 4px #339;}

a:link {
text-decoration: none;
}
a:visited {
text-decoration: none;
}
a:hover {
text-decoration: none;
}
a:active {
text-decoration: none;
opacity:none;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:16:14.697

```
$('.blur').hover(function() {
    $(this).siblings().children().addClass('out textshadow');
}, function() {
    $(this).siblings().children().removeClass('out textshadow');
}); 
```

[**小提琴**](http://jsfiddle.net/xK8nq/1/)- 所有文本都是超链接的。

* * *

或者您可以保留相同的 JS（不带`.children()`）并编辑 CSS 选择器：

`.blur`到`.blur a`
`.textshadow`_`.textshadow a`

[**小提琴**](http://jsfiddle.net/xK8nq/2/)

# sdk - 如何与 Windows Phone 8 中的应用共享多张照片？

> ID：14095156
> 
> 赞同：0
> 
> 时间：2012-12-30T22:04:58.707
> 
> 标签：sdk, windows-phone-8

我正在尝试为我的 Windows Phone 8 构建一个允许用户一次上传多个文件的应用程序。我知道目前无法使用 PhotoChooserTask 等。

但是，我希望可以通过照片中心中的“共享”方法。不幸的是，根据迄今为止的少量研究，如果选择了多个文件，我的应用程序不会显示在“共享”列表中。选择多个文件时唯一显示的应用程序似乎是*Microsoft*或内置的。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:32:01.130

确实，WP7/WP8 中的原生启动器和选择器不允许选择多个图像。与照片中心中的多个图像选择相关联的“共享”命令也确实不提供第 3 方可扩展性。

但是，为什么不自己动手呢？应用程序可以访问[MediaLibrary.SavedPictures](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.medialibrary.savedpictures.aspx)、[MediaLibrary.Pictures](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.medialibrary.pictures.aspx)和[MediaLibrary.RootPictureAlbum](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.medialibrary.rootpicturealbum.aspx)，它们是用户的大部分照片。

# python - 如何绘制点队列？

> ID：14095157
> 
> 赞同：1
> 
> 时间：2012-12-30T22:05:06.470
> 
> 标签：python, matplotlib, queue

我有以下代码。

```
import numpy as np
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
plt.ion()
plt.show()

mapping = defaultdict(partial(deque, maxlen=10)) 
```

我的映射结构包含一个带有 x、y、z 值的队列。我只想绘制队列中的点，以便随着队列的变化，情节也应该改变。我该怎么做？

**注意：**这是具有挑战性的，因为队列的大小是有限的，并且情节必须仅反映队列中的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T04:29:22.840

这样做的hacky方法是：

```
ln, = ax.plot(x,y,z)
# some code that updates the x,y,z values -> new_x,new_y,new_z
ln.remove
ln, = ax.plot(new_x,new_y,new_z)
plt.draw() 
```

它删除了旧数据的行并添加了新数据的行。

如果您愿意编写依赖于内部的代码`matplotlib`（这是一个坏主意，因为内部可能会在您的领导下发生变化），您也可以通过以下方式执行此操作：

```
ln._verts3d = new_x,new_y,new_z 
```

补丁在这里添加了一个功能来做到这一点：[https ://github.com/matplotlib/matplotlib/pull/1629](https://github.com/matplotlib/matplotlib/pull/1629)

[动画](http://matplotlib.org/api/animation_api.html)模块很好地封装了做动画所需的许多东西（包括一种将输出直接流式传输到 ffmpeg 的方法），并且有一个非常好的[教程](http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/)。

[`Line3D`文档](http://matplotlib.org/mpl_toolkits/mplot3d/api.html#mpl_toolkits.mplot3d.art3d.Line3D),[`Line2D`文档](http://matplotlib.org/api/artist_api.html#matplotlib.lines.Line2D)

# c# - WPF动态控件创建代码放在哪里

> ID：14095167
> 
> 赞同：1
> 
> 时间：2012-12-30T22:07:47.887
> 
> 标签：c#, wpf, button

我只是在自学WPF。我已经达到了动态添加控件的地步，并且在非常简单的事情上遇到了障碍。我的代码应该创建一个按钮（如下所示）：

```
Button button = new Button() { Height = 80, Width = 150, Content = "Test" };
parentControl.Add(button); 
```

我的问题是`parentControl`实际上叫什么？我正在使用标准的 Visual Studio 2012 WPF 模板，我的主窗口名为`MainWindow`. 除了模板中的内容之外，我在 Window 中没有任何对象

到目前为止，我已经看过：

*   [WPF 运行时控件创建](https://stackoverflow.com/questions/2491807/wpf-runtime-control-creation)
*   [WPF 中的动态控件创建](https://stackoverflow.com/questions/1147829/dynamic-control-creation-in-wpf)
*   [WPF MVVM 动态控件创建](https://stackoverflow.com/questions/13156445/wpf-mvvm-dynamic-control-creation)
*   [动态创建控件](https://stackoverflow.com/questions/433833/dynamic-creation-of-control)
*   [使用 MVVM 时，我应该将 WPF 特定代码放在哪里？](https://stackoverflow.com/questions/2654730/where-should-i-put-wpf-specific-code-when-using-mvvm)
*   [控件创建过程 WPF 的步骤](https://stackoverflow.com/questions/13859730/steps-of-control-creation-process-wpf)
*   [在（主要）无窗口 WPF 应用程序中放置代码的位置？](https://stackoverflow.com/questions/1029131/where-to-put-code-in-primarily-windowless-wpf-app)

我找到的最接近的：[WPF 运行时控件创建](https://stackoverflow.com/questions/2491807/wpf-runtime-control-creation)。

所有这些问题只是假设你知道这样一个基本的事情，但我不知道。请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T22:18:08.527

我想我理解你的问题。如果您的 XAML 代码如下所示：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
</Window> 
```

那么你的代码隐藏应该是这样的：

```
public MainWindow()
{
    InitializeComponent();
    Button button = new Button() { Height = 80, Width = 150, Content = "Test" };
    //In case you want to add other controls;
    //You should still really use XAML for this.
    var grid = new Grid();
    grid.Children.Add(button);
    Content = grid;
} 
```

但是，我强烈建议您尽可能多地使用 XAML。此外，我不会从构造函数中添加控件，但我会使用`Loaded`窗口的事件。您可以在构造函数的代码隐藏中或直接在 XAML 中向事件添加处理程序。如果您想在 XAML 中获得与上述相同的结果，您的代码将是：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Button Height="80" Width="180" Content="Test"/>
    </Grid>
</Window> 
```

# javascript - jQuery循环内嵌套函数的效率

> ID：14095168
> 
> 赞同：2
> 
> 时间：2012-12-30T22:08:03.350
> 
> 标签：javascript, jquery, loops

就计算机资源而言，什么会更有效。将事件处理程序放在这样的循环中：

```
$('ul li').each(function()
{
    $(this).mouseover(function()
    {
        // code to do something 
    }); 
```

或者在循环之外拥有函数并在循环内创建对它的调用，如下所示：

```
$('ul li').each(function()
{
    $(this).mouseover(function()
    {
        doStuff($(this)); 
    });

function doStuff(liElem)
{
    // code to do something 
} 
```

在我看来，第二个选项在计算机上会更容易，因为每次循环迭代时都不会重复执行某些操作的代码。事件处理程序的代码是每次循环都在计算机内存中创建，还是只创建一次？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:40:29.660

可以进行各种优化，但要针对您要求的方法进行优化，请在下面的代码中以内联注释的形式找到答案

第一种方法：

```
$('ul li').each(function()
{
    // Maybe you might like to declare some variables here
    $(this).mouseover(function()
    {
        // code to do something

        // Maybe you might like to use the variables declared in above function

        // Disadvantage over other approach
        // The code written here will need to store the context information of the outer function and global context

        // Advantage over other approach
        // You can directly access the variables declared in the above function
    });
} 
```

或者在循环之外拥有函数并在循环内创建对它的调用，如下所示：

第二种方法：

```
$('ul li').each(function()
{
    // Maybe you might like to declare some variables here
    $(this).mouseover(function()
    {
        doStuff($(this)); 
    });
});

function doStuff(liElem)
{
    // code to do something

    // Advantage over other approach
    // The code written here will need to store the context information only for the global context

    // Disadvantage over other approach
    // You cannot directly access the variables declared in the outer function as you can in the other approach,
    // you will need to pass them to the doStuff function to access here
} 
```

# android - Android 在一侧的 XML 中覆盖 9 补丁填充

> ID：14095170
> 
> 赞同：6
> 
> 时间：2012-12-30T22:08:06.750
> 
> 标签：android, padding, nine-patch

当使用 9-patch 图像作为背景时，填充似乎总是源自 9-patch 图像。即使您在 9 个补丁图像中不使用填充条，它也会使用可绘制对象。

> 如果不包括填充线，Android 使用左边和顶线来定义这个可绘制区域。

[http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)

但是，您可以使用 android:padding=0dp 或 =Xdp 在 XML 中覆盖它。不幸的是，使用 android:paddingLeft=Xdp 不起作用。所以你被统一的填充所困。我试过这样做：

```
 android:padding="2dp"
  android:paddingLeft="20dp" 
```

它对左侧的填充没有影响。将它们放在 styles.xml 中会产生类似的结果。

我见过的唯一解决此问题的方法是在代码中设置填充。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T23:13:33.853

if (android:padding present) 它覆盖所有其他填充值 else if (android:paddingXXX present) 它覆盖 bg drawable paddingXXX (XXX = Left|Right|Top|Bottom) else if (view has drawable bg) padding values from this drawable （在您的情况下为九个补丁）将被使用，否则将应用默认填充（通常为零）

所以不要使用 android:padding="2dp"。padding 属性覆盖所有内容。只需使用 paddingLeft = 20dp、paddingTop = 2dp、paddingRight = 2dp、paddingBottom = 2dp。

或者您可以设置 paddingLeft = 20dp 并且其他填充值将从 bg drawable 中获取。

# paypal - 没有 PayPal 帐户的电子邮件的 PayPal 错误

> ID：14095171
> 
> 赞同：4
> 
> 时间：2012-12-30T22:08:20.587
> 
> 标签：paypal

我正在建立一个网站，一个用户可以使用 PayPal 从另一个用户那里购买商品。我希望钱直接从一个到另一个，而我只处理 IPN 和接口。我设置了加密按钮以使用`cmd`=`_s-xclick`和加密数据：`cmd`= `_xclick`，`business`= 卖家的电子邮件和`email`= 买家的电子邮件。我在完成交易时遇到了一些问题。例如，`User A`有一个 PayPal 帐户，`User B`没有。两者都有对方用户购买的物品。`User A`单击（购买`User B`物品）的“使用 PayPal 付款”按钮会产生：

> “商家不是企业或高级 PayPal 帐户。此功能仅适用于企业或高级 PayPal 帐户持有人。”

`User B`单击（购买`User A`物品）的“使用 PayPal 付款”按钮会产生：

> 我们无法授权交易。请联系您的商家。

1.  我假设第一条消息是因为`User B`没有 PayPal 帐户，但我认为 PayPal 仍会接受付款并将其保存在临时帐户中，直到该用户注册。
2.  我还假设第二条消息也是因为买家（在这种情况下`User B`）没有 PayPal 帐户。但我认为 PayPal 只会让他们选择在那里创建一个或使用信用卡进行付款。

我是否遗漏了一些东西（例如，我需要传递一个不同的变量）？或者在允许他们购买/出售商品之前，我是否必须以某种方式确认用户拥有 PayPal 帐户。

PS：我很确定，但我必须确认，如果双方都有 PayPal 账户并且卖家是企业/高级账户，它就可以工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T01:17:54.957

这种方式不是一个很好的解决方案，因为您无法检查或保证双方都有 PayPal 帐户。我推荐使用自适应支付（链式支付）。这将允许您作为 PayPal 账户持有人运行每笔交易，并将资金发送到相应的卖家 PayPal 账户，或通过电子邮件通知他们，如果他们没有 PayPal 账户，他们有钱在等待，以便他们可以注册并领取这笔钱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-24T14:22:47.160

我们最近开始收到这个非常无益的错误消息，我们不得不联系[Paypal 商家技术支持](http://www.paypal.com/mts)。经过多次来回收到以下回复：

> 不幸的是，我们 PayPal 目前在加密按钮方面面临一些困难，我们的开发团队正在解决这个问题。同时，如果您不介意可以在您的帐户中创建辅助电子邮件，然后将其设置为主要电子邮件，然后再次重新生成该按钮并对其进行测试。目前，如果您需要使用加密按钮，这是他们提供的唯一解决方法，试一试，看看它是否有效，如果您需要其他任何东西，请告诉我，我很乐意为您提供帮助。对带来的麻烦表示抱歉。

试过了，它奏效了。这让我想诅咒某人，但它奏效了。

# javascript - Javascript 对象在自己的类文件中

> ID：14095177
> 
> 赞同：1
> 
> 时间：2012-12-30T22:08:50.750
> 
> 标签：javascript, oop, class

我正在使用 Java 后端构建一个完全基于 REST 服务的站点。我在 Java 和 PHP 方面都有中等经验，但对 JavaScript 的经验很少（除了一些基本的 Jquery 东西）。我的问题是所有 JavaScript 对象都必须在单个文件中定义，还是可以在自己的类文件中创建（如在 Java 或 PHP 中）？基本上，我想定义一堆对象（如用户、产品、购物车等），然后通过服务器上的 REST 服务实例化这些对象，但我不确定是否必须定义所有对象和实现将这些对象放在一个巨大的文件中，或者我是否可以将它们拆分为多个文件（就像我习惯于使用其他 OOP 语言一样）。

我知道您定义了一个对象，例如：

```
function Car(model, year)
{
    this.model = model;
    this.year = year;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:10:46.157

除了你给自己的限制之外，javascript 中没有任何限制。

通常将小型相关类分组到公共文件中，并在它们变得足够大时将它们隔离在专用文件中。

这只是可读性和可维护性的问题。

由于最小化浏览器发出的请求数量以获得更好的性能很重要，因此如果您创建了许多 JavaScript 文件，则应该连接并缩小它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:12:15.840

是的，您可以将代码拆分为多个文件，但您还必须加载所有这些文件。一行中的多个`<script src="..."></script>`元素理论上与将所有脚本以相同的顺序放在一个文件中相同。但是这会导致多个 HTTP 请求，每个请求都会减慢您的页面加载时间，因此许多人使用工具自动将多个文件合并为一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T22:16:35.857

您可以将类拆分为单独的文件，并在需要时包含它们。但是包含 javascript 文件的顺序非常重要。对于大型系统，您需要一个框架来管理它们。我推荐使用[Requirejs](http://requirejs.org/)

# processing - 在这个例子中，什么对象 rotate(theta) 旋转？

> ID：14095179
> 
> 赞同：0
> 
> 时间：2012-12-30T22:09:08.293
> 
> 标签：processing

[在这个例子](http://www.learningprocessing.com/examples/chapter-14/example-14-16/)中，我对旋转和平移的使用感到困惑，更具体地说，

```
// The earth rotates around the sun
  pushMatrix();
  rotate(theta);
  translate(50,0);
  fill(50,200,255);
  ellipse(0,0,10,10); 
```

`rotate(theta);`旋转什么？旋转和平移的关系是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:20:50.577

rotate 和 translate 作用于当前坐标系。

即绘制动作（rect()、ellipse() 等...）将在当前坐标系中应用。旋转和平移将移动坐标系。

在您提供的代码块之前，当前点被转换到窗口的中心以绘制太阳。

pushMatrix() 保存该位置，然后相对于太阳中心，“一切”（坐标系）由 theta 旋转，“一切”由 (50,0) 平移，有效地将“当前点”移动到正确的位置然后使用椭圆（0,0,10,10）绘制地球。

请注意，您可能会省略翻译步骤并使用 ellipse(50,0,10,10) 来获得相同的视觉结果，如果不是因为下一个代码块依赖于该翻译来正确获取月球位置.

[这是一个有趣的链接，它用“移动方格纸”来解释这一点](http://processing.org/learning/transform2d/)；

# c# - FacebookApiException 获取用户提要时的未知标识符（我/家）

> ID：14095182
> 
> 赞同：2
> 
> 时间：2012-12-30T22:09:17.797
> 
> 标签：c#, facebook-graph-api, facebook-c#-sdk

在我的 Facebook 应用程序中，我看到一些用户在获取他们的提要（使用`me/home?limit=1000&fields=from.fields(id,name),likes.fields(id),comments.fields(from.fields(id))`）时来自 Facebook SDK 的错误。

错误是：

```
Facebook.FacebookApiException：（异常 - #0）未知标识符，0_xxxxxxx
   在 Facebook.FacebookClient.ProcessResponse（HttpHelper httpHelper，字符串 responseString，类型 resultType，布尔 containsEtag，IList`1 batchEtags）
   在 Facebook.FacebookClient.Api(HttpMethod httpMethod, String path, Object parameters, Type resultType)
   在 Facebook.FacebookClient.Get（字符串路径，对象参数，类型 resultType）

```

`0_xxxxxxx`（每个用户在哪里不同）

我查看了 SDK 源代码，看不到会产生此错误的原因。

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:19:57.310

我能够通过 Graph API explorer 复制这个错误。这不是 C# SDK 的问题。

这似乎发生在具有特定受限隐私设置的帖子上。例如，其他人在您的信息流中发布的帖子。该帖子将受到所涉及用户的两种隐私设置的影响。

做出一些假设，导致问题的实际“标识符”似乎是

```
user-id_object-id 
```

`user_id`无法确定，因此该`0`帖子现在与未确定用户的隐私相关联。

~~很抱歉在没有实际提供解决方案的情况下继续这样下去......只是分享我的调查......~~

目前，解决方法是消除您对字段扩展的使用。一旦我把它拿出来，我就无法得到同样的错误。

```
me/home?fields=from,likes,comments&limit=1000 
```

这意味着您将不得不做一些额外的解析......但不要删除您的旧代码，只需将其注释掉，以便在整理字段扩展错误时做好准备。

# r - 将stata文件另存为R文件

> ID：14095188
> 
> 赞同：2
> 
> 时间：2012-12-30T22:09:39.683
> 
> 标签：r, save, stata

我正在尝试使用“保存命令”将 stata 文件保存为 R 文件，但反复出现错误：

```
>library(foreign)
# read stata file (there is a stata file "data.dta" in working directory)
>read.dta("data.dta")
  var1       var2     var3       var4       var5
1 -4.239497  0.2406101 3.786384 -1.3025404  0.3428481
2 -3.311914  1.9533381 3.200867 -2.4428566  0.9154460
3 -2.156078  1.6590545 4.317356 -3.1660178  1.6963958
4  2.648022 -1.4091060 3.227258 -0.9857693  1.4566656
>getwd()
"C:/Users/Vista/Documents" 
>save(data.dta, file = "data.rda")
Error in save(data.dta, file = "data.rda") : object 'data.dta' not found 
```

在这方面的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:13:31.993

您需要先将数据分配给 R 对象，否则读入的数据只会打印到您的控制台，但在您的工作区中不可用：

```
 data.dta <- read.dta("data.dta")
 save(data.dta, file = "data.rda") 
```

如果要检查工作区中可用的对象，可以键入`ls()`.

附带说明：您可能需要考虑`.Rds`通过以下格式保存对象

```
saveRDS(data.dta, file = "data.Rds") 
```

而不是以格式使用`save`和保存它。`.rda`当您通过`load("data.rda")`对象加载数据时，仍将具有（可能令人困惑的）名称 data.dta。当您保存它时，`.Rds`您可以在加载/阅读时重命名它，例如

```
anyname <- readRDS("data.Rds") 
```

# elisp - 向上走目录树

> ID：14095189
> 
> 赞同：20
> 
> 时间：2012-12-30T22:10:02.677
> 
> 标签：elisp

文件树如下：

```
- foo
  - lorem
    - ipsum <-
  - baz <-
- bar
- baz 
```

当前访问的文件是`ipsum`. 现在我想找到第一个 `baz`和它所在的目录。如何从 `ipsum`elisp 中爬上树？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-07T14:00:12.477

你想要`locate-dominating-file`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-31T02:08:36.533

```
(defun parent-directory (dir)
  (unless (equal "/" dir)
    (file-name-directory (directory-file-name dir))))

(defun find-file-in-heirarchy (current-dir fname)
  "Search for a file named FNAME upwards through the directory hierarchy, starting from CURRENT-DIR" 
  (let ((file (concat current-dir fname))
        (parent (parent-directory (expand-file-name current-dir))))
    (if (file-exists-p file)
        file
      (when parent
        (find-file-in-heirarchy parent fname))))) 
```

如果结果不是 nil，您可以使用 提取文件的目录`file-name-directory`，如下所示：

```
(let ((file (find-file-in-heirarchy (buffer-file-name) "baz")))
  (when file
    (file-name-directory file))) 
```

# jquery - Jquery 不能调用coldfusion cfc

> ID：14095193
> 
> 赞同：5
> 
> 时间：2012-12-30T22:10:40.123
> 
> 标签：jquery, coldfusion, cfc

我是 jquery 的新手，我正在尝试使用对话框调用和更新我的数据库的函数。我修改了现有模板以生成下面的代码，但无法让 jquery 函数调用函数 savefee。我的 javascript 控制台中没有错误。任何帮助表示赞赏。

`

```
<cfset getfees = new artservice().getfees()>

<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>

<script>
$(document).ready(function() {

    $(".artdiv").click(function() {
        var initialDiv = this;

        //based on which we click, get the current values
        var feeid = $(this).data("fee_id");
        var feetitle = $("h2", this).text();

        // set form values
        $("#fee_id").val(feeid);        
        $("#fee_title").val(feetitle);

        $("#editForm").dialog({
            buttons: {
                "Save": function() {
                    var thisDialog = $(this);
                        $.post("artservice.cfc", {
                        method: 'savefee',
                        fee_id: $("#fee_id").val(),
                        fee_title: $("#fee_title").val()
                        }, 
                    function() {
                        //update the initial div
                        $("h2", initialDiv).text($("#fee_title").val());
                        $(thisDialog).dialog("close");
                    });
                }
            }
        });
    });

});
</script>
<style>
.artdiv {
    padding: 5px;
    margin: 5px;
    background-color: #80ff80;
}
#editForm {
    display:none;   
}
</style>
</head>

<body>

<cfoutput query="getfees">

    <div class="artdiv" data-fee_id="#fee_id#">
        <h2>#fee_title#</h2>
    </div>

</cfoutput>

<div id="editForm" title="Edit Art">
    <input type="hidden" id="fee_id">
    <p>
    <b>Name:</b><br/>
    <input type="text" id="fee_title">
    </p>

</div>

</body>
</html> 
```

`

cfc 如下

`

```
<cffunction name="getfees" access="public">
    <cfquery datasource="dsn" name="getfees" maxrows="10">select fee_id, fee_title from table</cfquery>
    <cfreturn getfees>
</cffunction>

<cffunction name="savefee" access="public">
<cfargument name="fee_id" required="yes">
<cfargument name="fee_title" required="yes">
<cfquery datasource="dsn">update table set fee_title = '#arguments.fee_title#' where fee_id = #fee_id#</cfquery>
</cffunction> 
```

`

application.cfc 中的此函数出现错误“传递给 onCFCRequest 函数的 ARGS 参数不是字符串类型”

```
public void function onCFCRequest(required string cfcname, required string method, required string args) {

    return;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T23:02:49.143

您的函数必须设置为，`access="remote"`因为它们被浏览器直接调用到 CFC。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T06:56:59.933

由于“onCFCRequest”的函数定义不正确而导致的错误。此函数的第三个参数是结构类型，但您已将类型设为字符串。所以正确的定义应该是这样的。

```
public void function onCFCRequest(required string cfcname, required string method, required struct args) {

    return;
} 
```

此外，如果您在 Application.cfc 中声明此函数，那么您需要手动处理“onCFCRequest”中的函数调用。像您需要再次调用 onCFCRequest 中的请求函数。

# prolog - 在序言中计数 - 不可能做到

> ID：14095197
> 
> 赞同：0
> 
> 时间：2012-12-30T22:10:48.853
> 
> 标签：prolog

编辑：更简单：

我更改了代码以简化。谓词“nbarret”返回我想要的电台数量。

所以有我的新代码，但它不会改变任何东西：

```
nb_stations([],0).
nb_stations([S,Li,Dir,SS],X):-nbarret(Li,S,SS,Dir,Y),X is X1 + Y.
nb_stations([S,Li,Dir,SS|Tr],X):-
     nbarret(Li,S,SS,Dir,Y),nb_stations([SS|Tr],X is X1 + Y). 
```

在这种情况下，我有一个错误：

```
ERROR: is/2: Arguments are not sufficiently instantiated
Exception: (8) (_G2031 is _G2270+1)is _G2711+5 ? creep
Exception: (7) nb_stations([charles_de_gaulle_etoile, m6, nation, bir_hakeim], _G2031 is _G2270+1) ? creep
Exception: (6) nb_stations([la_defense, rerA, vincennes, charles_de_gaulle_etoile, m6, nation, bir_hakeim], _G2031) ? creep 
```

/---------------------------------------------------- ------------/

旧代码（已弃用，我保留理解）：

```
nb_stations([S,Li,Dir,SS|Tr],X):-num_stations(S,Li,Dir1,ND,_,_),Dir=Dir1,!,
num_stations(SS,Li,Dir1,NA,_,_),Dir=Dir1,!,
calculer(ND,NA,Y),X is X1 + Y,nb_stations([SS|Tr],X).

nb_stations([S,Li,Dir,SS|Tr],X):-num_stations(S,Li,_,_,Dir2,ND),!,
num_stations(SS,Li,_,_,Dir2,NA),!,
Dir=Dir2,!,calculer(ND,NA,Y),X is X1 + Y,nb_stations([SS|Tr],X).

calculer(ND,NA,X):-X is ND - NA. 
```

更多细节 ：

当您调用 nb_stations 时，您必须告知 List 中的路径，包括出发站、交通工具的线路、方向，然后是您将停止的车站。如果我们接下来还有更多，那就是信件。在此示例中：nb_stations([la_defense,rerA,vincennes,charles_de_gaulle_etoile,m6,nation,bir_hakeim],X)。

您从 la_defense 开始，乘坐“rerA”运输，然后乘坐“vincennes”作为方向。然后停在“charles_de_gaulle_etoile”，乘坐m6（地铁），方向是“nation”，到达“bir_hakeim”。所以我的代码计算了我在这次旅行中经过的车站数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:43:35.157

分配 X 时需要更改顺序。

```
nb_stations([S,Li,Dir,SS|Tr],X):-
    num_stations(S,Li,Dir1,ND,_,_),
    Dir=Dir1,!,
    num_stations(SS,Li,Dir1,NA,_,_),
    Dir=Dir1,!,
    calculer(ND,NA,Y),
    nb_stations([SS|Tr],X1),
    X is X1 + Y.   % Change here

nb_stations([S,Li,Dir,SS|Tr],X):-
    num_stations(S,Li,_,_,Dir2,ND),!,
    num_stations(SS,Li,_,_,Dir2,NA),!,
    Dir=Dir2,!,
    calculer(ND,NA,Y),
    nb_stations([SS|Tr],X1),
    X is X1 + Y. % Change here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:25:40.273

你到底想写什么？

```
nb_stations([S,Li,Dir,SS|Tr],X):-
     num_stations(S,Li,_,_,Dir2,ND),!,
     num_stations(SS,Li,_,_,Dir2,NA),!,
     Dir=Dir2,!,
     calculer(ND,NA,Y),
     nb_stations([SS|Tr],X is X1+Y). 
```

或许

```
nb_stations([S,Li,Dir,SS|Tr],X):-
     num_stations(S,Li,_,_,Dir2,ND),!,
     num_stations(SS,Li,_,_,Dir2,NA),!,
     Dir=Dir2,!,
     calculer(ND,NA,Y),

     X is X1 + Y,  <== here X1 is a free variable

     nb_stations([SS|Tr],X). 
```

# html - HTML5 Canvas 不保留绘制顺序

> ID：14095199
> 
> 赞同：3
> 
> 时间：2012-12-30T22:11:00.027
> 
> 标签：html, html5-canvas

我正在尝试在画布上绘制建筑物的粗略轮廓。我通过为每一侧创建一系列正方形，加上顶部的“屋顶”，然后基本上按照 Painter 的算法按顺序绘制它们来实现下面的效果。

左侧的屏幕截图显示了它的外观。这是分别绘制每个正方形。

为了提高性能，我希望尽可能少的 .stroke() 和 .fill() 调用，因此我将所有 moveTo() 和 lineTo() 调用排队，并一次性绘制它们。测试表明（至少对于线路而言）这带来了巨大的性能改进，我自己也验证了这一点。

不幸的是，正如你从右边的截图中看到的那样，当我在最后只画一次建筑物时，分层基本上被破坏了。它以看似随机的顺序绘制事物。

画布应该以这种方式工作吗？为什么它不按照我告诉它绘制的顺序绘制所有内容，就像第一个屏幕截图一样？有谁知道解决这种行为的好方法？

![模拟 3d 建筑物](../Images/d42da8a6ed3b848b55a4f052736fd0c8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:29:44.400

如果您将所有 moveTos 和 lineTos 等作为一大批发送，它将像渲染一个大形状一样绘制它们（您希望看到所有内部笔划）。

运行多个绘制操作会有轻微的性能损失，但通常不值得让您的代码更难理解和调试。

# android - Android 应用锁定相机

> ID：14095203
> 
> 赞同：5
> 
> 时间：2012-12-30T22:11:26.653
> 
> 标签：android, android-camera

是否可以获得当前将相机锁定在 Android 设备上的应用程序/进程的 android 应用程序（进程 ID 或包名称或其他）？使用它很容易查看它是否被锁定`Camera.open()`- 但我想找出拥有它的进程。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:22:32.173

CameraService 负责锁定相机设备。这不是 NDK 的一部分，因此无法通过您的应用程序访问。请参阅此[相关讨论](https://groups.google.com/d/msg/android-ndk/Z1j4OIG6uUw/eUTnW33ar2UJ)。

你可能不得不使用一些非标准的方式，比如获得 root 权限，然后直接与底层的 Android 系统交互。

# ruby - .each 循环中的 Ruby 性能

> ID：14095205
> 
> 赞同：2
> 
> 时间：2012-12-30T22:11:49.513
> 
> 标签：ruby, loops

考虑以下两个 ruby​​ 代码

## 示例 1

```
name = user.first_name
round_number = rounds.count
users.each do |u|
  puts "#{name} beat #{u.first_name} in round #{round_number}"
end 
```

## 示例 2

```
users.each do |u|
  puts "#{user.first_name} beat #{u.first_name} in #{rounds.count}"
end 
```

对于这两段代码想象

```
#user.rb
def first_name
  name.split.first
end 
```

因此，在算法的经典分析中，第一段代码会更有效，但是在大多数现代编译语言中，现代编译器会优化第二段代码以使其看起来像第一段，从而消除了在这种情况下优化代码的需要方式。

ruby 会在执行之前优化或缓存此代码的值吗？我的 ruby​​ 代码应该看起来像示例 1 还是示例 2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:18:52.910

示例 1 将运行得更快，因为`first_name()`它只调用一次，并且它的值存储在变量中。

在示例 2 中，Ruby 不会自动记住该值，因为该值可能在循环的迭代之间发生了变化`each()`。

因此，如果期望在不改变返回值的情况下多次使用计算成本高的方法，则应显式记住它们。

在做出这样的决定时，使用 Ruby 的[Benchmark Module](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/benchmark/rdoc/Benchmark.html)会很有用。`users`只有当 中有很多值，或者`first_name()`计算成本很高时，它才可能值得记忆。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:28:02.033

只有当编译器能够证明该方法没有副作用时，它才能执行此优化。这在 Ruby 中比大多数语言更困难，因为一切都是可变的，并且可以在运行时被覆盖。它是否发生取决于实现，但由于在 Ruby 中很难做到，所以大多数都不会。在发帖时，我实际上不知道有什么做的。

# java - Java Applet 使用 aws sdk 被拒绝访问

> ID：14095206
> 
> 赞同：1
> 
> 时间：2012-12-30T22:11:54.277
> 
> 标签：java, amazon-web-services, amazon-s3, japplet

我目前正在编写一个 Java 小程序（实际上是 JApplet），它使用 Java AWS SDK 从我的 S3 存储桶中下载一些文件。当我在 Eclipse 的 Applet Viewer 上运行 Applet 时，它运行良好，但是当我尝试在浏览器上运行它时遇到了问题。

我确实已经阅读了一些关于类似问题的 SO 问题，但是在遵循提供的答案之后，我仍然没有找到解决这个问题的方法。

起初我尝试导出一个包含所有依赖项的可运行 jar，至少用于测试。但是我在我测试的每个浏览器（Firefox、Chrome 和 IE）中都收到了这个错误消息：

```
access denied ("java.util.propertyPermission" "com.amazonaws.sdk.disableCertChecking" "read") 
```

经过一番搜索，我发现这可能是因为我的 jar 没有签名。所以我自己签名并再次尝试只是得到同样的错误。我什至决定使用单独的罐子，而不是将它们装入一个罐子并全部签名，但无济于事。

AwsCredentials.properties 文件是最新的，并且与 jar 位于同一目录中，但我认为这不是导致问题的原因。

我用来嵌入小程序的 HTML 代码：

```
<applet code="path.to.class.Packer" 
        archive="signed-packer.jar" 
        width="400px" height="200px">       
</applet> 
```

如果您想了解更多信息，请告诉我。我很感激在这个问题上的任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:40:20.783

是的。不允许在浏览器沙箱中运行的小程序读取任意 Java 系统属性。这是一个安全限制。只要 Java 接受签名证书，对 applet JAR 文件*进行签名就足够了。*（您是否已将自签名证书添加到 Java 安装的密钥库中？）

相关问题：[自签名小程序未获得完整权限](https://stackoverflow.com/questions/8882226/self-signed-applet-doesnt-get-a-full-permission)

# c# - 我可以在没有 Twilio API 的 URL 的情况下接收 SMS 状态吗？

> ID：14095215
> 
> 赞同：1
> 
> 时间：2012-12-30T22:13:26.827
> 
> 标签：c#, url, sms, twilio

这个问题与 Twilio 及其 API (C#) 有关。

我没有网站或网络应用程序，只需要在服务器（不是网络服务器）上发生某些事情时向我自己的私人手机发送短信通知。我已经成功地从 C# dll 向我的手机发送了短信。我想检查消息的状态。所有参考都暗示网站/Web 应用程序用例，并使用 URL 获取状态。

我如何在 C# 中做到这一点？这里有建议的例子[吗](https://stackoverflow.com/questions/9430003/how-to-get-notified-when-sms-status-changes-from-queued-to-sent)？没有 PHP 或其他网络服务器技术。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:45:41.250

我找到的解决方案非常简单。建议（在[此处](https://stackoverflow.com/questions/10554138/how-to-make-sure-a-sms-went-through-after-sending-it-with-twilio)提出）是保留消息 ID。我在 TwilioRestClient 上发现了 GetSMSMessage 方法。因此，在发送后一段时间查询消息状态将为您提供更新的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T19:05:39.483

顺便说一句，您需要注意的一件事是，如果您过早查询 API，您可能会得到“排队”或“正在发送”而不是“已发送”或“失败”的状态，所以要确保您的逻辑设置为处理[这些其他可能的响应](http://www.twilio.com/docs/api/rest/sms#sms-status-values)。

还要记住，如果您尝试通过 Twilio 电话号码每秒发送超过 1 条消息，[Twilio 会将多余的消息排队并以每个号码每秒 1 条消息的速率释放它们](http://www.twilio.com/help/faq/sms/how-quickly-can-i-send-sms-messages)。这会起作用，因为如果您在 1 秒内发送 10 条消息的突发事件，但是您在 5 秒后去检索消息的状态，一半的消息将被“发送”，一半将被“排队”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-09T21:59:49.670

如果您没有回调网址。只需调用方法

```
TwilioClient.Init(accountSid, authToken);

var message = MessageResource.Create(
            body: "Join Earth's mightiest heroes. Like Kevin Bacon.",
            from: new Twilio.Types.PhoneNumber(fromNumber),
            to: new Twilio.Types.PhoneNumber(toNumber)
        );

Console.WriteLine(message.Sid);

//Get the status from twilio
TwilioClient.Init(accountSid, authToken);

var verificationCheck = MessageResource.Fetch(message.Sid);

Console.WriteLine(verificationCheck.Status); 
```

其中 Sid 是您从 Twilio 返回的 id。

# python - 使用 pyInstaller 2.0 创建具有特定参数的 python 脚本的可执行文件

> ID：14095216
> 
> 赞同：3
> 
> 时间：2012-12-30T22:13:31.757
> 
> 标签：python, executable, command-line-arguments, pyinstaller

我已经成功使用 pyInstaller 2.0 从简单的 python 脚本创建可执行文件。我有一个 python 脚本，它运行不同的搜索并根据命令行参数产生不同的输出。有没有办法使用 pyInstaller 假设某些参数创建脚本的可执行文件？如，我想生成一个 exe 文件，该文件将运行并产生与从命令行运行它相同的输出，如下所示：

`python pacman.py --layout mediumMaze --pacman SearchAgent`

pyInstaller 2.0 可以吗？我无法在提供的手册中找到这个问题。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:27:01.013

这是一种迂回的方式，但您可以导入`pacman.py`一个单独的 python 文件，并以它执行命令行参数指定的事情的方式调用它。然后，使用 pyinstaller，您将编译单独的 python 文件。

如果无法以`pacman.py`这种方式使用，您可以尝试创建以下 Python 文件并让 pyinstaller 编译它。

```
import sys

sys.argv.extend(['--layout', 'mediumMaze', '--pacman', 'SearchAgent'])

import pacman
pacman.main() # if your file has a `main` function 
```

（在这两种情况下，pyinstaller 仍然会将这两个文件组合成一个 exe）

# screen-size - WP8 无法以原始分辨率显示图像

> ID：14095218
> 
> 赞同：1
> 
> 时间：2012-12-30T22:14:24.643
> 
> 标签：screen-size

无论定位方法如何，WP8 上的每个图像都被拉伸到其高度的两倍。

无法显示高质量图像，因为它们都被自动调整为超出可见显示端口的大小。

有没有办法禁用调整大小？

谢谢

如果您在 720p 设备或模拟器上运行应用程序，以下代码中的图像会调整大小。如何准确显示原始图像尺寸？

```
<Canvas >
       <Image Source="/Assets/AlignmentGrid_800x480.png"   Stretch="None" Canvas.Left="0" Canvas.Top="0"/>
</Canvas> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T10:22:35.223

设置 Image 元素的高度和宽度属性。

# sql - 如何将这 2 个 SELECT 组合成一个？

> ID：14095220
> 
> 赞同：0
> 
> 时间：2012-12-30T22:14:52.673
> 
> 标签：sql, sql-server, sql-server-2005

> **可能重复：**
> [如何组合这两个 SQL 语句？](https://stackoverflow.com/questions/14094327/how-to-combine-these-two-sql-statements)

我有 2 个 SQL 查询。他们根据变量等于`CMSUID`或`CASUID`表中的值来获得计数。否则，它们完全相同。我怎样才能将它们组合成一个查询，也许使用一个`CASE`语句。

```
select @cntCM_CNF = count(distinct(c.ID_Case))
from dbo.Cases c
join dbo.vew_CasePersonnelSystemIDs vcps on c.ID_Case = vcps.ID_Case
join hearings h on c.ID_Case = h.ID_Case
where vcps.CMSUID = @nSUID
    and h.HearingDate > getdate()
    and h.OnCalendar = 1 and h.Scheduled = 1
    and dbo.fn_HearingConfirmedNoHOs(h.ID_Hearing) < 2

select @cntCC_CNF = count(distinct(c.ID_Case))
from dbo.Cases c
join dbo.vew_CasePersonnelSystemIDs vcps on c.ID_Case = vcps.ID_Case
join hearings h on c.ID_Case = h.ID_Case
where vcps.CASUID = @nSUID
    and h.HearingDate > getdate()
    and h.OnCalendar = 1 and h.Scheduled = 1
    and dbo.fn_HearingConfirmedNoHOs(h.ID_Hearing) < 2 
```

我不知道如何组合它们，因为结果是不同项目的计数。不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:05:35.620

是吗...

```
select 
    @cntCM_CNF = count(distinct case when vcps.CMSUID = @nSUID then c.ID_Case else null end),
    @cntCC_CNF = count(distinct case when vcps.CASUID = @nSUID then c.ID_Case else null end)
from dbo.Cases c
join dbo.vew_CasePersonnelSystemIDs vcps on c.ID_Case = vcps.ID_Case
join hearings h on c.ID_Case = h.ID_Case
where 
    h.HearingDate > getdate()
    and h.OnCalendar = 1 and h.Scheduled = 1
    and dbo.fn_HearingConfirmedNoHOs(h.ID_Hearing) < 2 AND
    (vcps.CASUID = @nSUID OR vcps.CMSUID = @nSUID) --<<<<added for performance reasons 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:18:58.620

看看 UNION 是如何工作的。

本质上，您将在一列中选择一个计数，0，然后在另一列中选择 0。

你可能需要使用`UNION ALL`

```
select @cntCM_CNF = count(distinct(c.ID_Case)) AS Col1, 0 As Col2
from dbo.Cases c
join dbo.vew_CasePersonnelSystemIDs vcps on c.ID_Case = vcps.ID_Case
join hearings h on c.ID_Case = h.ID_Case
where vcps.CMSUID = @nSUID
    and h.HearingDate > getdate()
    and h.OnCalendar = 1 and h.Scheduled = 1
    and dbo.fn_HearingConfirmedNoHOs(h.ID_Hearing) < 2
UNION ALL
select 0 as Col1, @cntCC_CNF = count(distinct(c.ID_Case)) AS Col2
from dbo.Cases c
join dbo.vew_CasePersonnelSystemIDs vcps on c.ID_Case = vcps.ID_Case
join hearings h on c.ID_Case = h.ID_Case
where vcps.CASUID = @nSUID
    and h.HearingDate > getdate()
    and h.OnCalendar = 1 and h.Scheduled = 1
    and dbo.fn_HearingConfirmedNoHOs(h.ID_Hearing) < 2 
```

# jquery - tinybox 的 jQuery 问题

> ID：14095223
> 
> 赞同：2
> 
> 时间：2012-12-30T22:15:35.140
> 
> 标签：jquery

我正在使用 tinybox [http://www.scriptiny.com/2011/03/javascript-modal-windows/](http://www.scriptiny.com/2011/03/javascript-modal-windows/)作为弹出窗口。它看起来像这样：

```
TINY.box.show({
  iframe: "someDocument.html", boxid: "frameless", width: 300, height: 200,
  fixed: false, maskid: "bluemask", maskopacity: 40, closejs: function () {}}); 
```

我将它与 jQuery 一起使用，当我启动它时它工作正常。但问题是打开时我无法更改任何内容，我想添加一个事件。如图所示，我正在使用 iframe。有任何想法吗？

# symfony - 是否可以仅使用裸表单组件制作表单

> ID：14095227
> 
> 赞同：1
> 
> 时间：2012-12-30T22:16:11.977
> 
> 标签：symfony, symfony-forms

是否可以在不使用任何其他组件的情况下在 Symfony 2 中制作表单？只有表单组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:33:35.397

不，Symfony Form 组件有一些[强制性的依赖](https://packagist.org/packages/symfony/form)：

*   事件调度程序
*   语言环境
*   选项解析器

目前，可选的依赖项是：

*   验证器
*   Http基金会

演示如何在没有 Symfony2 框架的情况下使用 Form 组件的示例项目：[https ://github.com/bschussek/standalone-forms](https://github.com/bschussek/standalone-forms)

# java - Netbeans Java Swing 组件不可拖动

> ID：14095230
> 
> 赞同：0
> 
> 时间：2012-12-30T22:16:24.357
> 
> 标签：java, swing, netbeans-7

我正在尝试借助 Netbeans IDE 学习 Java Swing。按照[本](http://netbeans.org/kb/docs/java/quickstart-gui.html)教程，当我尝试将面板添加到 JFrame 时，我发现自己陷入了困境。面板或 Swing 容器中的任何其他组件不会添加到我的设计视图中。

我尝试拖动并右键单击该组件但没有成功。

当我右键单击面板组件时，我会看到各种菜单选项，包括“粘贴项目”，但它是灰色的并且处于非活动状态。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T22:40:50.533

只需单击调色板“Swing Containers”面板按钮。在 7.2 和 7.2.1 中，它是一个拨动开关。然后转到您的 JPanel，您将看到您的新 JPanel 与您的光标一起移动。将其移动到您想要的位置，然后再次单击。然后你可以调整它到你喜欢的尺寸...

Netbeans IDE 是一款出色的生产工具。但是，如果您处于学习阶段，最好避免使用功能强大的 GUI 编辑器，以便更好地理解这些概念。您可以使用简单的文本编辑器来做到这一点。

您会发现这些链接很有帮助：[Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/)、[Java2s 教程](http://www.java2s.com/Tutorial/Java/0240__Swing/Catalog0240__Swing.htm)和[Java 初学者教程](http://www.javabeginner.com/java-swing/java-swing-tutorial)。当然，您可以询问 Stackoverflow，如果您在某个时候遇到困难，或者想征求意见……

# php - 使用未序列化的 php 数组解析图像数组

> ID：14095231
> 
> 赞同：1
> 
> 时间：2012-12-30T22:16:28.630
> 
> 标签：php, arrays, serialization, multidimensional-array

对于某些人来说，这可能是一个简单的问题，但不幸的是对我来说不是。我正在从 MySql DB 中检索序列化数组。这很好用。它反序列化很好。然后，我正在检索我需要按未序列化数组的顺序显示的图像数组：

```
$order = unserialize( $row['displayOrder']); 
```

这将导致：

```
Array ( [0] => 2296543905 [1] => 2296540032 [2] => 2296540820 [3] => 2296541625 [4] => 2296541997 [5] => 2296542417 [6] => 2296542816 [7] => 2296543113 [8] => 2296545096 [9] => 2296544278 
```

我正在检索另一个图像 URL 数组，如下所示：

```
$images = $images['Images'];
foreach ( $images as $index => $image) {
echo '<li><img src="'.$image['TinyURL'].'" class="framed"></li>';
} 
```

结果是：

```
 "Images": [
  {
    "id": 2296543905,
    "TinyURL": "http://blah.com"
  }
]

"Images": [
  {
    "id": 2296543905,
    "TinyURL": "http://blah.com"
  }
] 
```

我的问题是......我将如何解析以使 imagesTinyURL 按未序列化数组的顺序显示？`order`即：按数组`id`中的数组顺序列出图像url `Images`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:22:10.843

这是一个小例子：

```
//Create an array where the keys are image ids
$imageArray=array();
foreach($images as $image)
    $imageArray[$image['id']]=$image;

//Output the images according to the order array (array of image ids)
foreach($order as $id){
    print_r($imageArray[$id]);
} 
```

# ruby-on-rails - 如何根据 Rails 中的字段名称自动生成占位符文本？

> ID：14095235
> 
> 赞同：0
> 
> 时间：2012-12-30T22:16:49.370
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个可重用的字段模板，称为 _field.html.haml，它看起来像（在 haml 中）：

```
= f.label field
= f.send(field_type, field, :class => field_type) 
```

这样做的好处是可以从父表单模板中调用它并提供可重用性。这让我可以根据字段类型动态呈现表单字段。调用模板如下所示：

```
= form_for(@model) do |f|
  = render :partial => 'field', :locals => { :field => :first_name, :field_type => :text_field }
  = render :partial => 'field', :locals => { :field => :last_name, :field_type => :text_field } 
```

如何将基于标签文本的占位符文本自动生成添加到此 _field.html.haml 模板？也许正确的问题是标签 hdlper 用于将字段名称转换为大写英文短语的代码是什么？

即代码看起来像：

```
= f.send(field_type, field, :class => field_type, :placeholder => #INSERT CODE HERE to get friendly placeholder text) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T11:24:52.553

该`label_tag`方法使用“String#humanize”使其看起来更好（http://api.rubyonrails.org/classes/String.html#method-i-humanize）。所以在你的例子中你可以这样做：

```
= f.send(field_type, field, :class => field_type, :placeholder => field.to_s.humanize) 
```

正如前面在评论中提到的，您应该看看可用的表单构建器。他们抽象出很多与制作漂亮表格相关的痛苦。一些链接是：

*   [https://github.com/plataformatec/simple_form](https://github.com/plataformatec/simple_form)
*   [https://github.com/justinfrench/formtastic](https://github.com/justinfrench/formtastic)

# ruby-on-rails - 使所有 Ruby 哈希 HashWithIndifferentAccess

> ID：14095238
> 
> 赞同：1
> 
> 时间：2012-12-30T22:17:35.953
> 
> 标签：ruby-on-rails, ruby

有没有办法使您在 Ruby On Rails 中处理的所有哈希都成为 HashWithIndiffergentAccess？有很多次我尝试使用符号而不是字符串来访问哈希，例如 Model.attributes。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:54:15.310

```
::Hash = HashWithIndifferentAccess 
```

不过，这是个非常糟糕的主意。

# c++ - 从插入符号获取行号

> ID：14095241
> 
> 赞同：0
> 
> 时间：2012-12-30T22:17:52.897
> 
> 标签：c++, windows-8, textbox, microsoft-metro, windows-runtime

我正在尝试从文本框中的插入符号位置获取行号，这就是我所拥有的：

```
int Editor::GetLineFromCaret(const std::wstring &text)
{
    unsigned int lineCount = 1;

    for(unsigned int i = 0; i <= m_editWindow->SelectionStart; ++i)
    {
        if(text[i] == '\n')
        {
            ++lineCount;
        }
    }

    return lineCount;
} 
```

但我遇到了一些奇怪的错误。例如，如果我在文本框中有 10 行文本并使用此功能，它不会给我正确的行号，除非插入符号在该行中大约有 10 个字符，并且某些行没有字符，所以它是不正确的。

这就是我在 Damir Arh 的帮助下解决问题的方法：

```
int Editor::GetLineFromCaret(const std::wstring &text)
{
    unsigned int lineCount = 1;
    unsigned int selectionStart = m_editWindow->SelectionStart;

    for(unsigned int i = 0; i <= selectionStart; ++i)
    {
        if(text[i] == '\n')
        {
            ++lineCount;
            ++selectionStart;
        }
    }

    return lineCount;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T07:14:02.097

您的计算不起作用，因为新行占用字符串 ( `\r\n`) 中的两个字符，但该`SelectionStart`值仅将新行计为单个字符。因此，在每一行之后，您都会减少 1 个字符，即您需要将一个字符进一步移动到该行中，然后才能检测到正确的行。

要修复计算，您需要考虑`\r`字符：

```
int Editor::GetLineFromCaret(const std::wstring &text)
{
    unsigned int lineCount = 1;
    unsigned int selectionStart = m_editWindow->SelectionStart;

    for(unsigned int i = 0; i <= m_editWindow->SelectionStart; ++i)
    {
        if(text[i] == '\n')
        {
            ++lineCount;
        }
        if(text[i] == '\r')
        {
            ++selectionStart;
        }
    }

    return lineCount;
} 
```

# c - 如何在C中使用指向结构的指针从结构中打印成员数据

> ID：14095242
> 
> 赞同：2
> 
> 时间：2012-12-30T22:18:02.503
> 
> 标签：c, pointers, struct

我有一个指向外部头文件中定义的 Map 类型结构的指针：

```
typedef struct {
    char *squares; //!< A pointer to a block of memory to hold the map.
    int   width;   //!< The width of the map pointed to by squares.
    int   height;  //!< The height of the map pointed to by squares.
} Map; 
```

指针初始化如下：

```
 struct Map *map_ptr;    
    map_ptr = create_map(*w_ptr, *h_ptr);
    // create_map returns Map*, w_ptr and h_ptr are pointers to height and width fields for a map/maze. 
```

如何打印存储在 create_map 中创建的 Map 结构中的宽度和高度值？create_map 保存在外部文件中，它传递回 main 的唯一变量是指向映射的指针。

编译时出现以下错误（“错误：取消引用指向不完整类型的指针”）

```
printf("Height = %d\n", map_ptr->height); 
```

据我所知，指针是有效的，因为下面的代码打印了一个内存地址：

```
printf("Pointer address for map = %p\n", map_ptr); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T22:30:09.603

只需从以下位置删除`struct`关键字：

```
struct Map *map_ptr; 
```

至：

```
Map *map_ptr; 
```

您已经声明了一个无名结构并将其类型定义为`Map`. 因此，当您声明时`struct Map *map_ptr;`，编译器认为这是*另一个*名为`Map`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:59:33.827

你绊倒了 C 中所谓的*命名空间*。有单独的命名空间

*   typedef 名称，正如您介绍的那样`typedef struct { ... } Map;`
*   struct 标签，正如您介绍的那样`struct Map *map_ptr;`
*   加上对象的其他命名空间，宏名称，......

相同的标识符可以在不同的命名空间中重用。我建议**永远不要为 structs 使用 typedef**。它只隐藏有用的信息，它所做的一切都是为了让你不时地写作`struct`。如果某物是结构或指向结构的指针，那么*我想知道它，以便知道是使用`->`还是`.`访问成员*。使用 typedefs 通过隐藏有用的信息来解决这个问题。

解决问题的一种方法是摆脱 typedef 并仅使用 struct 标签

```
struct Map {
    char *squares; //!< A pointer to a block of memory to hold the map.
    int   width;   //!< The width of the map pointed to by squares.
    int   height;  //!< The height of the map pointed to by squares.
};
struct Map *map_ptr = ...; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T03:18:43.430

答案一：</p>

```
struct Map *map_ptr; 
```

至

```
Map *map_ptr; 
```

答案2：</p>

```
typedef struct {
    char *squares; //!< A pointer to a block of memory to hold the map.
    int   width;   //!< The width of the map pointed to by squares.
    int   height;  //!< The height of the map pointed to by squares.
} Map; 
```

至

```
struct Map{
    char *squares; //!< A pointer to a block of memory to hold the map.
    int   width;   //!< The width of the map pointed to by squares.
    int   height;  //!< The height of the map pointed to by squares.
} ; 
```

原因：</p>

```
if typedef struct{...}  B； 
```

所以

```
B ＝＝ struct B{...} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T22:29:23.387

这是一个完整的示例，可能有助于澄清几点：

```
#include <stdio.h>
#include <malloc.h>
#include <string.h>

typedef struct {
    char *squares; //!< A pointer to a block of memory to hold the map.
    int   width;   //!< The width of the map pointed to by squares.
    int   height;  //!< The height of the map pointed to by squares.
} Map;

Map *
create_map ()
{
  printf ("Allocating %d bytes for map_ptr, and %d bytes for map data...\n",
    sizeof (Map), 100);
  Map *tmp = (Map *)malloc(sizeof (Map));
  tmp->squares = (char *)malloc (100);
  strcpy (tmp->squares, "Map data...");
  tmp->width = 50;
  tmp->height = 100;
  return tmp;
}

int 
main(int argc, char *argv[])
{
  Map *map_ptr = create_map();
  printf ("map_ptr->height= %d, width=%d, squares=%s\n",
    map_ptr->height, map_ptr->width, map_ptr->squares);
  free (map_ptr->squares);
  free (map_ptr);
  return 0;
} 
```

示例输出：

```
Allocating 12 bytes for map_ptr, and 100 bytes for map data...
map_ptr->height= 100, width=50, squares=Map data... 
```

另一种方法是使用“struct Map {...}”而不是 typedef：

例子：

```
struct Map {
    char *squares; //!< A pointer to a block of memory to hold the map.
    int   width;   //!< The width of the map pointed to by squares.
    int   height;  //!< The height of the map pointed to by squares.
} Map;

struct Map *
create_map ()
{
...
  struct Map *tmp = (struct Map *)malloc(sizeof (struct Map));
  ...
}
  ...
  struct Map *map_ptr = create_map();
  printf ("map_ptr->height= %d, width=%d, squares=%s\n",
    map_ptr->height, map_ptr->width, map_ptr->squares);
  free (map_ptr->squares);
  free (map_ptr); 
```

# javascript - 在不删除前一个视图的情况下加载新视图

> ID：14095245
> 
> 赞同：1
> 
> 时间：2012-12-30T22:18:10.717
> 
> 标签：javascript, angularjs

我`index.html`的有以下`div`

```
<div ng-view></div> 
```

我的应用声明如下：

```
angular.module('app', [])
    .config(['$routeProvider', function($routeProvider){
            $routeProvider
                .when('/listen', {
                    templateUrl : 'partials/listen.html',
                    controller : PlaylistCtrl
                })
                .when('/settings', {
                    templateUrl : 'partials/settings.html',
                    controller : SettingsCtrl
                })
                .otherwise({
                    redirectTo : '/listen'
                })
        }
    ])
; 
```

现在，当我在主页（即`/#/listen`）并单击指向 的链接时`/#/settings`，它会将页面的内容替换为来自 的内容`partials/settings.html`。我怎样才能修改它，以便内容不会被替换，而只是添加？我的目标是`settings`显示在模式对话框中，因此我不希望页面的先前内容被清除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:32:41.210

这对于 ng-view 是不可能的。您需要创建一个自己的指令并将其包含在您的 index.html 中：

```
<modal></modal> 
```

Angular-ui 有一个实现。也许你应该检查一下。

**编辑：**

过去我制作了自己的模态（在测试角度时）。我刚开始学习 Angular，所以它有**很大的改进空间**（现在阅读我会做不同的事情）。但是，它可以给你一个例子：

```
app.directive('modal', function($compile, $http) {
    return {
        restrict: 'E',
        replace: true,

        compile: function(elm, attrs) {
            var htmlText =
                '<div id="' + attrs.id + '" class="modal hide fade" aria-hidden="true">' +
                    '<div class="modal-header">' +
                        '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>' +
                        '<p>&nbsp;</p>' +
                    '</div>' +
                    '<div class="modal-body">' +
                        '<div>to be replaced</div>' +
                    '</div>' +
                    '<div class="modal-footer">' +
                        '<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>' +
                    '</div>' +
                '</div>';
            elm.replaceWith(htmlText);

            return function postLink(scope, elm, attrs) {
                var modal = $('#' + attrs.id);
                modal.css({
                    width: '60%',
                    left: '20%',
                    margin: 'auto auto auto auto',
                    top: '10%'
                });
                var modalBody = modal.children('.modal-body');

                modalBody.css({
                    maxHeight: '800px'
                });

                var replaceDiv = modalBody.children();
                $http.get(attrs.src).success(function(data) {
                    var childScope = scope.$new();
                    childScope.modalMode = true;
                    var element = $compile(data)(childScope);
                    angular.element(replaceDiv).replaceWith(element);
                });
            };
        }
    };
}); 
```

html:

```
<a class="btn" data-target="#myId" data-toggle="modal" data-backdrop="static">Open modal</a>

<modal id="myId" src="path/to/partial" ></modal> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T11:15:05.450

`ng-view`不会在这里帮助你。

相反，您应该`ng-include`与`ng-switch`or结合使用`ng-show`。

```
<div><ng-include src="listen.html"/></div>
<div ng-show="isOnSettingsUrl()"><ng-include src="settings.html"/></div> 
```

或类似的规定。

在父控制器中，您需要阅读`$routeParams`以便您可以实现`isOnSettingsUrl()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T07:16:59.107

`ng-view`使用来自 的内容直接更新自身`routeProvider`，不仅有用，而且还提高了性能，因为它卸载了您不会使用的控制器和观察者（您在不同的页面上）。
url 的更改也*应该*更改视图，而不是附加任何内容。如果我直接进入页面会发生什么？这绝对不是直观的。

预计会有一个`index.html`包含布局的页面，`ng-view`这将是更改页面。对于其他事情，您可以使用`ng-include`.

在您的情况下，我假设您想要显示部分页面，用户可以在其中更新他们的设置。
您不需要使用`routing`，您可以在部分中设置部分`play template`并在部分中使用`ng-show`。然后，您只需放置一个链接即可显示部分页面。

但是，如果您想要grooveshark之​​类的东西；那么您确实需要使用`ng-view`with routing to `settings`，然后您应该将播放模板（及其控制器）放在`ng-view`您希望它显示在每个页面中的外部。

# bash - Bash - If 条件内参数的不同值

> ID：14095246
> 
> 赞同：0
> 
> 时间：2012-12-30T22:18:14.760
> 
> 标签：bash, if-statement

来自文件 $2 的输入：1 -> 2

```
while read -a line; do

  if (( ${line[2]} > linesNumber )); then
  echo "Graph does not match known sites4"
    exit
  fi

done < "$2" 
```

出于某种原因，`if`条件内部的值`${line[2])`不是`2` ，但如果我在外部打印值`if`：

```
echo `${line[2]}`

2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:39:02.420

是什么`linesNumber`？即使你放`$linesNumber`，它是从哪里来的？

如果您正在跟踪行号，则需要设置它并增加它。这是我的示例程序和数据。它受到您的示例的*启发*，但并不完全符合您的要求。但是，它向您展示了如何设置跟踪行号的变量、如何增加它以及如何在`if`语句中使用它：

### foo.txt：

```
this 1
that 2
foo  4
barf 4
flux 5 
```

### 该程序：

```
lineNum=0
while read -a line
do
    ((lineNum++))
    if (( ${line[1]} > $lineNum ))
    then
        echo "Line Number Too High!"
    fi
    echo "Verb = ${line[0]}  Number = ${line[1]}"
done < foo.txt 
```

### 输出：

```
Verb = this  Number = 1
Verb = that  Number = 2
Line Number Too High!
Verb = foo  Number = 4
Verb = barf  Number = 4
Verb = flux  Number = 5 
```

# c# - 将 StringEscapeHandling.EscapeNonAscii 与 Json.NET 一起使用

> ID：14095247
> 
> 赞同：1
> 
> 时间：2012-12-30T22:18:19.767
> 
> 标签：c#, json, json.net, encode

最新版本的 Json.NET (4.5.11) 包含 StringEscapeHandling.EscapeNonAscii，它可以转义所有非 ASCII 字符。但是，我不知道在哪里将它作为参数传递。

如果我尝试：
`JsonConvert.SerializeObject(myObj, Formatting.Indented, new JsonSerializerSettings { StringEscapeHandling = StringEscapeHandling.EscapeNonAscii});`

然后我得到编译错误：
`'Newtonsoft.Json.JsonSerializerSettings' does not contain a definition for 'StringEscapeHandling'`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-08T14:36:08.773

在 Newtonsoft.Json 的更新版本上，这在`JsonConvert.SerializeObject()`. 传递一个`JsonSerializerSettings`实例 where [`StringEscapeHandling`](https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonSerializerSettings_StringEscapeHandling.htm)is `StringEscapeHandling.EscapeNonAscii`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:18:36.207

根据[文档](http://www.thinkbase.net/main/raw-attachment/blog/thinkbase-2012/11/24/Json.NET-Documentation-20121124-james.newtonking.com.7z)，此属性仅适用于 JsonWriter 及其继承者。

# jquery - javascript 可点击的行

> ID：14095250
> 
> 赞同：0
> 
> 时间：2012-12-30T22:18:37.270
> 
> 标签：jquery

我在使用 javascript 这个可点击的行时遇到了一些问题：

[http://www.fpmnky.com/test.php](http://www.fpmnky.com/test.php)

光标不会变为指针，如果您单击该行的文本区域，它不会转到代码中的链接 [google.com]

```
 <script type="text/javascript" src="other_lib.js"></script>
    <script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript">

        jQuery( function($) {
            $('tbody tr[data-href]').addClass('clickable').click( function() {
                window.location = $(this).attr('data-href');
            }).find('a').hover( function() {
                        $(this).parents('tr').unbind('click');
                    }, function() {
                        $(this).parents('tr').click( function() {
                            window.location = $(this).attr('data-href');
                        });
                    });
            $('tbody tr[data-href]').css( 'cursor', 'pointer' );

            $('tbody tr[data-href]').hover(function() {
                $(this).css('cursor','pointer');
            });
        });

    </script>

<body>

<table>
    <thead>
    <tr>
        <th>Col 1</th>
        <th>Col 2</th>
        <th>Col 3</th>
        <th>Col 4</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr data-href="http://google.com">
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td><a href="#">Edit</a> <a href="#">Delete</a></td>
    </tr>
    <tr class="even" data-href="http://google.com">
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td><a href="#">Edit</a> <a href="#">Delete</a></td>
    </tr>
    <tr data-href="http://google.com">
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td><a href="#">Edit</a> <a href="#">Delete</a></td>
    </tr>
    <tr class="even" data-href="http://google.com">
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td>text</td>
        <td><a href="#">Edit</a> <a href="#">Delete</a></td>
    </tr>
    </tbody>
</table>

</body>
</html> 
```

它似乎在 jsfiddle 上工作得很好：

[http://jsfiddle.net/UN7Pc/5/](http://jsfiddle.net/UN7Pc/5/)

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:37:07.100

http：你的问题在这里

```
<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script> 
```

位置错误，如果您修复它，您的代码将起作用

顺便说一句，如果你愿意，你可以通过谷歌链接到 jquery

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:05:52.953

除了实际问题之外，我注意到当用户将鼠标悬停在真实链接上时，您正在删除 td click 事件。您可以这样做的唯一原因是点击会冒泡到 tr。

因此，相反，绑定 td （tr 通常是不可点击的，它是 td 点击冒泡到它，你正在捕捉），如果它不是被点击的 td，则返回。

你的代码

```
$('tbody tr[data-href]').addClass('clickable').click( function() {
    window.location = $(this).attr('data-href');
}).find('a').hover( function() {
    $(this).parents('tr').unbind('click');
}, function() {
    $(this).parents('tr').click( function() {
        window.location = $(this).attr('data-href');
    });
}); 
```

更少的代码

```
$('tbody tr[data-href] td').addClass('clickable').on('click', function(e) {
    if (e.target!=this) return; 
    window.location = $(this).parent().data('href');
}); 
```

此外，除了在您的 JS 中添加 CSS，`cursor:pointer`只能在悬停时存在（因为指针在任何其他时间都不在元素上）

```
.clickable {
    cursor:pointer;
} 
```

# php - 使用 PDO 创建长插入 SQL 查询的最佳方法

> ID：14095257
> 
> 赞同：5
> 
> 时间：2012-12-30T22:19:21.373
> 
> 标签：php, mysql, sql, pdo

考虑到我正在构建一个表单并将数据发布到 PHP，一个典型的插入查询对我来说是这样的：

```
$sql = "INSERT INTO news
            (title, body) 
            VALUES (?, ?)";
$stmt = $db->prepare($sql);
$stmt->execute(array($_POST["title"], $_POST["body"]));
$stmt->closeCursor(); 
```

这对于一个小查询来说看起来不错，据我了解，这可以让我免受 SQL 注入之类的攻击。

但是如果我需要处理一个相当大的表格怎么办？就像是...

```
$sql = "INSERT INTO ficha_item
    (titulo, tipo_produto, quantidade_peso, unidade_de_venda, 
    unidades_por_caixa, caixas_piso, pisos_palete, tipo_de_palete, 
    unidades_palete, caixas_palete, uni_diametro, uni_largura, 
    uni_profundidade, uni_altura, uni_peso_bruto_unidade, caixa_largura, 
    caixa_profundidade, caixa_altura, altura_palete, volume_unidade, 
    peso_caixa, peso_palete) 
    VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)"; 
```

我认为计算所有这些问号变得乏味。有没有更清洁的方法来使用 PDO 做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T22:48:45.717

我会做这样的事情：

```
$fields = array(
    'titulo', 
    'tipo_produto', 
    'quantidade_peso', 
    'unidade_de_venda', 
    'unidades_por_caixa', 
    'caixas_piso', 
    'pisos_palete', 
    'tipo_de_palete', 
    'unidades_palete', 
    'caixas_palete', 
    'uni_diametro', 
    'uni_largura', 
    'uni_profundidade', 
    'uni_altura', 
    'uni_peso_bruto_unidade', 
    'caixa_largura', 
    'caixa_profundidade', 
    'caixa_altura', 
    'altura_palete', 
    'volume_unidade', 
    'peso_caixa', 
    'peso_palete'
);
$sql = 'INSERT INTO ficha_item ( %s ) VALUES ( %s )';
// make a list of field names: titulo, tipo_produto /*, etc. */
$fieldsClause = implode( ', ', $fields );
// make a list of named parameters: :titulo, :tipo_produto /*, etc. */
$valuesClause = implode( ', ', array_map( function( $value ) { return ':' . $value; }, $fields ) );
// or, with create_function
$valuesClause = implode( ', ', array_map( create_function( '$value', 'return ":" . $value;' ), $fields ) );
$sql = sprintf( $sql, $fieldsClause, $valuesClause );

// $sql is now something similar to (formatted for display):
// INSERT INTO ficha_item
//     ( titulo, tipo_produto /*, etc. */ )
// VALUES
//     ( :titulo, :tipo_produto /*, etc. */ )

$stmt = $db->prepare($sql);

// if the keys in $_POST match with $fields, you can now simply pass $_POST here
$stmt->execute( $_POST );
// or, as per Bill Karwin's sound suggestion, with the intersection of $_POST
$stmt->execute( array_intersect_key( $_POST, array_flip( $fields ) ) ) 
```

换句话说，使用命名参数，并根据`$fields`数组动态生成它们。尽管命名参数不是绝对必要的；它们*确实*有助于使事情变得更容易，因为例如传递给的元素的顺序`PDOStatement::execute()`现在不再重要了。

~~不过，这假设 中的元素数量及其键`$_POST`与 中的字段数量及其名称完全匹配`$sql`。~~

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:45:46.797

您可以动态创建 SQL：

```
$allowed_fields = array(
    'titulo', 
    'tipo_produto', 
    'quantidade_peso', 
    'unidade_de_venda', 
    'unidades_por_caixa', 
    'caixas_piso', 
    'pisos_palete', 
    'tipo_de_palete', 
    'unidades_palete', 
    'caixas_palete', 
    'uni_diametro', 
    'uni_largura', 
    'uni_profundidade', 
    'uni_altura', 
    'uni_peso_bruto_unidade', 
    'caixa_largura', 
    'caixa_profundidade', 
    'caixa_altura', 
    'altura_palete', 
    'volume_unidade', 
    'peso_caixa', 
    'peso_palete'
);

$columns = "";
$values = "";
$values_arr = array();
foreach ( $_POST as $key=>$value )
{
    if ( !in_array($key, $allowed_fields) ) continue;
    $columns .= "$key, ";
    $values .= "?, ";
    $values_arr[] = $value;
}
// now remove trailing ", " from $columns and $values
$columns = rtrim($columns, ", ");
$values = rtrim($values, ", ");
// finish them
$sql = "INSERT INTO ficha_item($columns) VALUES($values)";
$stmt = $db->prepare($sql);
$stmt->execute($values_arr);
$stmt->closeCursor(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T22:31:53.820

使用 bindParam 方法，这是执行您期望的最清晰（n|r）的方法。这比问号更容易理解。所以代码会更容易维护。

[来自官方 php 文档](http://php.net/manual/en/pdostatement.bindparam.php)的示例：

Example #1 使用命名占位符执行准备好的语句

```
<?php
/* Execute a prepared statement by         binding PHP variables */
$calories = 150;
$colour = 'red';
$sth = $dbh->prepare('SELECT name, colour, calories
FROM fruit
WHERE calories < :calories AND colour = :colour');
$sth->bindParam(':calories', $calories, PDO::PARAM_INT);
$sth->bindParam(':colour', $colour, PDO::PARAM_STR, 12);
$sth->execute();
?> 
```

希望这可以帮助。

# c# - 如何使用 JavaScript 解密 AesCryptoServiceProvider？

> ID：14095259
> 
> 赞同：2
> 
> 时间：2012-12-30T22:19:42.947
> 
> 标签：c#, javascript, .net, encryption, cryptojs

我正在使用[MSDN](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aescryptoserviceprovider%28v=vs.90%29.aspx)`EncryptStringToBytes_Aes`中的方法使用自定义密码加密一些数据，如下所示：

```
string original = "some data to encrypt";
byte[] encrypted;

using (AesManaged aes = new AesManaged())
{
    // Prepare new Key and IV.
    string passphrase = "somepassphrase";
    byte[] saltArray = Encoding.ASCII.GetBytes("somesalt"); 
    Rfc2898DeriveBytes rfcKey = new Rfc2898DeriveBytes(passphrase, saltArray);
    aes.Key = rfcKey.GetBytes(aes.KeySize / 8);
    aes.IV = rfcKey.GetBytes(aes.BlockSize / 8);

    // Encrypt the string to an array of bytes. 
    encrypted = EncryptStringToBytes_Aes(original, aes.Key, aes.IV);

    // Decrypt the bytes to a string. 
    string roundtrip = DecryptStringFromBytes_Aes(encrypted, aes.Key, aes.IV);

    return Convert.ToBase64String(encrypted);
} 
```

它有效（`DecryptStringFromBytes_Aes`返回原始字符串）。

`encrypted`我的问题是，如果我在客户端也有相同的密码，如何使用 JavaScript 解密？我尝试使用[CryptoJS 对其](http://code.google.com/p/crypto-js/)进行解密，但没有成功。数据在网络服务中被加密，我尝试将其作为字节数组、字符串传递给 JS，尝试使用各种编码对其进行编码，但无论我做什么，我都无法获得原始字符串。我在这里做错了什么，我该如何完成这项工作？它甚至可以这样吗？saltArray 编码甚至自定义密码的使用是否会导致我的问题？

例如，这是我的 JS 尝试之一（使用 base64 编码）：

```
var decoded = CryptoJS.enc.Base64.parse(encrypted);
var decrypted = CryptoJS.AES.decrypt(decoded, "somepassphrase"); 
```

*（编辑：我打算稍后实施随机盐，一旦我得到了其他所有东西，因为这样更容易跟踪发生了什么）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:28:13.473

尝试使用斯坦福 Javascript 加密库。链接：[http ://crypto.stanford.edu/sjcl/](http://crypto.stanford.edu/sjcl/)

# xcode - Xcode 4 工作区和方案的预操作

> ID：14095261
> 
> 赞同：1
> 
> 时间：2012-12-30T22:20:07.903
> 
> 标签：xcode, xcode4, build, workspace

我有一个非常简单的 Xcode 4 工作区：

*   一个简单的应用程序：`Foo.app`
*   图书馆 ：`Bar.a`

正如你可以想象的`Foo.app`那样`Bar.a`，这里没有什么奇怪的。当我构建`Foo.app`它时，它会自动构建`Bar.a`，这正是我想要的！但是... 因为总是有一个但是... 在`Bar.a`方案的构建阶段，我有一个预操作脚本。

如果我 build`Bar.a`会执行脚本，但是如果我 build `Foo.app`，Xcode 会自动构建`Bar.a`而不执行预操作脚本！！！

我如何告诉我的 Xcode 朋友执行该脚本，即使我在构建时也是如此`Foo.app`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:39:13.817

您可以尝试将 Bar.a 指定为手动依赖项。编辑您的方案并选择构建操作。取消选中“Find Implicit Dependencies”并将 Foo.a 目标添加到 Targets 列表中。将其拖到 Foo.app 上方，以便首先构建它。我认为这可能对您有所帮助-当依赖项“意外”起作用时，它对我有所帮助。

文档可能对此更清楚一些（因此请向 Apple 提交增强请求）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T15:24:17.187

在尝试了@joshua 的手动依赖声明之后，我发现唯一但不令人满意的解决方法是添加相同的脚本作为`Foo.app`.

# javascript - 在 Octopress 中包括 plusone 和 twitter 按钮

> ID：14095263
> 
> 赞同：0
> 
> 时间：2012-12-30T22:20:41.157
> 
> 标签：javascript, google-plus, jekyll, google-plus-one, octopress

我拥有一个使用 Octopress 生成的网页。它在主页上有一篇文章概述，其中包括最后十篇文章。每篇文章都有一个 +1 按钮。但是，如果我 +1 一篇文章，整个页面都会得到 +1。我不想那样，你可能会想。

我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T10:13:38.880

看起来您的模板正在使用 +1 按钮而没有设置此处记录的“href”参数：[https ://developers.google.com/+/web/+1button/#plusonetag-parameters](https://developers.google.com/+/web/+1button/#plusonetag-parameters)

使每个按钮指向相关文章的 URL。

# ios - Facebook iOS SDK 和向后兼容性

> ID：14095265
> 
> 赞同：2
> 
> 时间：2012-12-30T22:21:11.170
> 
> 标签：ios, ios6, backwards-compatibility, facebook-ios-sdk

我正试图解决这个问题并找出最好的方法：我想利用 iOS 6.0 在与 facebook 交互方面引入的所有新功能 - 这包括内置的社交框架允许快速的 facebook SSO 和本机帖子对话框。使用新的 Facebook iOS SDK v3.1.1 很容易做到这一点。

问题是我还希望我的应用程序可供任何非 iOS 6.0 采用者使用。这让我面临一个非常难看的情况，我需要创建一个精心制作的社交包装器，它必须以不同的方式编译（使用不同的 FB SDK）并运行单独的代码以支持早期的 iO​​S 版本。因为很多 Facebook SDK 已经包含了回退并处理了很多旧的、已弃用的对提要和对话 API 的调用，所以我认为在考虑到这一点的同时，必须有更好的方法来创建这样的社交包装器。

我想我在这里要求的是关于从这里开始的任何线索。如果有人曾经解决过这个问题（即使在早期版本的 SDK 中），我会很高兴知道。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T10:16:34.457

弱链接绝对是要走的路。

3.1.1 SDK 可以处理在 iOS 5 或 iOS 6 上运行，您需要做的就是在构建设置中弱链接相关框架，并将部署 traget 更改为 5.0（将基本 sdk 保留为 6.0）。

当然，您仍然需要处理原生 post 对话框不可用的情况（您可以使用 FBNativeDialogs 的 canPresentShareDialogWithSession: 方法）并改用 SDK 对话框。

# regex - 正则表达式和 sed 命令匹配相对路径文件名

> ID：14095269
> 
> 赞同：2
> 
> 时间：2012-12-30T22:22:03.367
> 
> 标签：regex, bash, sed, osx-mountain-lion

我正在努力创建一个 sed 正则表达式命令来更改这样的行：

```
In file included from dira/file_a.h:8, dire/file_e.h:9, and dirf/file_f.h:10,
             from dirb/file_b.h:6,
             from /existing/abs/path/dirb/file_b.cc:6:
dirc/file_c.h:88: error: 'eqn_count_t' does not name a type
dirc/file_c.h:95: error: 'wave_count_t' does not name a type
dirc/file_c.h:104: error: ISO C++ forbids declaration of 'WmHyperbolicEqnSet' with no type 
```

到这个**期望的输出**：

```
In file included from /abspaths/dira/file_a.h:8, /abspaths/dire/file_e.h:9, and /abspaths/dirf/file_f.h:10,
             from /abspaths/dirb/file_b.h:6,
             from /existing/abs/path/dirb/file_b.cc:6:
/abspaths/dirc/file_c.h:88: error: 'eqn_count_t' does not name a type
/abspaths/dirc/file_c.h:95: error: 'wave_count_t' does not name a type
/abspaths/dirc/file_c.h:104: error: ISO C++ forbids declaration of 'WmHyperbolicEqnSet' with no type 
```

所以，

*   仅匹配以 .h 结尾的相对路径+文件名
*   不匹配以正斜杠开头的行（因此已经是绝对路径）
*   匹配每行多次出现
*   很明显，我需要一个与**Mac OS X**的 BSD sed 命令配合使用的命令。

**我想要的 regex 和 sed 命令是什么？**

我正在尝试修改 gcc 输出，因为包含的带有错误/警告的头文件会生成错误流输出，其中引用了相对路径，而不是绝对路径。使用我的 XCode IDE 调用外部构建系统，.h 文件中发生的错误不是“可点击的”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:09:57.780

**上次编辑**

我终于成功地创建了这样一个命令，只有 1 个命令：

```
sed 's/^\(.* \)\{0,1\}\([^/ ][^ ]\{1,99\}\.h\)/\1\/abspath\/\2/;' testfile.txt 
```

并且为了支持多重匹配......即使在 Mac 上也是如此（来自@sudo_O 的一些简化想法）：

```
sed -E -e :a -e 's/^(.* )?([^/][^ ]+\.h)/\1\/abspath\/\2/' -e ta testfile.txt 
```

但是 Mac 的`sed`不支持`;`作为命令分隔符的实现。所以我们需要使用多个`-e`命令字段。

为了测试它们，我`textfile.txt`使用以下命令进行了修改：

```
sed -e '4s/^.*$/& &/' -i.bak testfile.txt 
```

（也可以在 Mac 上工作）

有两个部分，首先可以计算任何字符串，但以空格结尾...... 0 或 1 次。第二部分不能以空格或斜杠开头，可以包含任何内容，但不能包含空格，并且必须以 . 结尾`.h`。如果匹配，第一部分（包含前导空格，但如果为 0 次则可能为空）必须跟在, 后面`/abspath/`，而不是第二部分。

**年长者**

这不工作吗？

**为 Mac 修改的**编辑：****

 **```
sed 's/ \([^/ ][^ ]\{1,99\}\.h\)/ \/abspath\/\1/;' testfile.txt 
```

在 mac 和 Linux 上工作相同。我已经替换`+`为`{1,99}`.

对不起，我没有正确阅读这个问题。这对两者都有效：

```
sed 's/^\([^/ ][^ ]\{1,99\}\.h\)/\/abspath\/\1/;
     s/ \([^/ ][^ ]\{1,99\}\.h\)/ \/abspath\/\1/;' testfile.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:44:47.483

Mac 和 Linux 友好：

```
sed -E 's/^([^/][a-zA-Z/_]+\.h)/\/abspaths\/\1/;s/ ([^/][a-zA-Z/_]+\.h)/ \/abspaths\/\1/g' file 
```

匹配所需的输出：

```
In file included from /abspaths/dira/file_a.h:8, /abspaths/dire/file_e.h:9, and /abspaths/dirf/file_f.h:10,
             from /abspaths/dirb/file_b.h:6,
             from /existing/abs/path/dirb/file_b.cc:6:
/abspaths/dirc/file_c.h:88: error: 'eqn_count_t' does not name a type
/abspaths/dirc/file_c.h:95: error: 'wave_count_t' does not name a type
/abspaths/dirc/file_c.h:104: error: ISO C++ forbids declaration of 'WmHyperbolicEqnSet' with no type 
```

**解释：**

当替换不在行首时，需要两次替换来说明所需的额外空间：

```
s/^([^/][a-zA-Z/_]+\.h)/\/abspaths\/\1/;   # First substitution for start of line 
s/ ([^/][a-zA-Z/_]+\.h)/ \/abspaths\/\1/g  # Second for non-start of line

# Match (first substitution)
s/
^             - start of line
(             - capture group 
[^/]          - not a forward slash 
[a-zA-Z/_]+   - one or more letter, forward slash or underscore
\.h           - the extension (escaped) 
)             - end capture group 
# Replace with 
/
\/abspaths\/  - the literal string /abspaths (slashes escaped)
\1            - the captured group 
/;
# Match (second substitution)
s/
' '           - not start of line but a single space (used quotes here for space)
(             - capture group 
[^/]          - not a forward slash 
[a-zA-Z/_]+   - one or more letter, forward slash or underscore
\.h           - the extension (escaped) 
)             - end capture group 
# Replace with 
/
' '           - put the single space back
\/abspaths\/  - the literal string /abspaths (slashes escaped)
\1            - the captured group 
/g            - global flag 
```

* * *

或者仅通过进行一次替换（基于[**F.Hauri**](https://stackoverflow.com/questions/14095269/regex-and-sed-command-to-match-relative-path-filename/14095646#14095646)）答案，但每行仅适用于一场比赛：

```
sed -E 's/^(.* )?([^/][^ ]+\.h)/\1\/abspath\/\2/' file 
```

对于多个匹配`sed`支持[分支](http://www.thegeekstuff.com/2009/12/unix-sed-tutorial-6-examples-for-sed-branching-operation/#more-2903)：

```
sed -E ':a;s/^(.* )?([^/][^ ]+\.h)/\1\/abspath\/\2/;ta' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:28:34.230

试试这个：

```
sed "s|\([^\s]*\.h\)|/abspath/\1|" <testfile.txt 
```

并忽略绝对路径：

```
sed "s|^\([^/][^\s]*\.h\)|/abspath/\1|" <testfile.txt 
```**

# c++ - 如何翻译PDF文件？

> ID：14095270
> 
> 赞同：1
> 
> 时间：2012-12-30T22:22:03.403
> 
> 标签：c++, visual-c++

我有一个包含表格、图像等的 PDF 文件。我想将此 PDF 文件的文本翻译成另一种语言，并创建一个类似于第一个文件但包含翻译文本的 PDF 文件（它应该有图像、表格，......就像第一个文件一样）。

我怎样才能用 C++ 编写一个可以做到这一点的程序？

我有一个从 PDF 文件中提取文本并转换文本的程序，但我无法创建带有特殊位置的表格和图像的输出 PDF 文件。如何创建具有原始文件布局的 PDF 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:38:08.817

您的程序应该在内存结构（如对象树）中读取 PDF，然后翻译内存中的文本叶子，然后将内存结构转储回 PDF。为此，您需要一个允许您操作对象表示的 pdf 解析库。

我不是 C++ 开发人员，所以我不了解 C++ 库领域；但从谷歌上的快速搜索来看，[PoDoFo 似乎](http://podofo.sourceforge.net/about.html)可以完成这项工作。

# php - Twitter API 1.1 给出错误代码 32

> ID：14095272
> 
> 赞同：1
> 
> 时间：2012-12-30T22:22:23.543
> 
> 标签：php, oauth, twitter-oauth

所以。我正在尝试从列表提要中获取所有状态。更具体地说，这个[https://dev.twitter.com/docs/api/1.1/get/lists/statuses](https://dev.twitter.com/docs/api/1.1/get/lists/statuses)

据我所知，它使用的是 OAuth 1.0a。我的问题是，我收到错误代码 32。

我正在使用以下代码：

```
<?php function buildBaseString($baseURI, $method, $params) { 
    $r = array(); 
    ksort($params); 
    foreach($params as $key=>$value){
        $r[] = "$key=" . rawurlencode($value);
    } 
    return $method."&" . rawurlencode($baseURI) . '&' . rawurlencode(implode('&', $r)); 
}

function buildAuthorizationHeader($oauth) {
    $r = 'Authorization: OAuth ';
    $values = array(); 
    foreach($oauth as $key=>$value) 
        $values[] = "$key=\"" . rawurlencode($value) . "\"";
    $r .= implode(', ', $values); 
    return $r; 
}

$url = "https://api.twitter.com/1.1/lists/statuses.json?slug=danskere-i-udlandet&owner_screen_name=d_fodbold&count=20";
$oauth_access_token = "29194047-Dzwsoo1KiQg69dbabt3nS2ezjjNzlbZdlKpLWsOOG"; 
$oauth_access_token_secret = "secret"; 
$consumer_key = "iCV8UbKjmq9LAw1XIvTQ"; 
$consumer_secret = "secret";
$oauth = array( 'oauth_consumer_key' => $consumer_key,
                'oauth_nonce' => md5(microtime()), 
                'oauth_signature_method' => 'HMAC-SHA1', 
                'oauth_token' => $oauth_access_token, 
                'oauth_timestamp' => time(), 
                'oauth_version' => '1.0');

$base_info = buildBaseString($url, 'GET', $oauth); 

$composite_key = rawurlencode($consumer_secret) . '&' . rawurlencode($oauth_access_token_secret); 
$oauth_signature = base64_encode(hash_hmac('sha1', $base_info, $composite_key, true)); 
$oauth['oauth_signature'] = $oauth_signature;

// Make Requests 
$header = array(buildAuthorizationHeader($oauth)); 
$options = array(   CURLOPT_HTTPHEADER => $header, 
                //CURLOPT_POSTFIELDS => $postfields, 
                    CURLOPT_HEADER => false, 
                    CURLOPT_URL => $url, 
                    CURLOPT_RETURNTRANSFER => true, 
                    CURLOPT_SSL_VERIFYPEER => false);

$feed = curl_init(); 
curl_setopt_array($feed, $options); 
$json = curl_exec($feed); 
curl_close($feed);

$twitter_data = json_decode($json);
var_dump($twitter_data);
exit();?> 
```

我不知道那里有什么问题。

我希望你们中的一些人可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T10:20:47.447

我发现。基线的制作方式是不正确的。

查询字符串必须包含在其中，并按字母顺序排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:27:30.553

我觉得你的有问题`oauth_nonce`。我不认为这`md5(microtime())`是一个好的随机数生成器。尝试像 Twitter 开发人员文档中所说的[授权请求](https://dev.twitter.com/docs/auth/authorizing-request)那样做：

> oauth_nonce 参数是您的应用程序应为每个唯一请求生成的唯一令牌。Twitter 将使用该值来确定一个请求是否已被多次提交。此请求的值是通过 base64 编码 32 字节的随机数据并去除所有非单词字符生成的，但任何产生相对随机的字母数字字符串的方法在这里都应该没问题。

# ruby - 使用每种方法在 Ruby 中排序

> ID：14095273
> 
> 赞同：1
> 
> 时间：2012-12-30T22:22:31.577
> 
> 标签：ruby, sorting, each

我有以下代码：

```
def shuffle arr
  shuffled = []
  while arr.length > 0
    randNum = rand(arr.length)
    idx = 0
    unshuf = []
    arr.each do |item|
      if idx == randNum
        shuffled.push item
      else
        unshuf.push item
      end
      idx = idx + 1
    end
    arr = unshuf
  end
  return shuffled
end

puts(shuffle([ 11, 12, 13])) 
```

我试图在调用`unshuf`该方法时了解数组的状态。每次调用方法之前`shuffle`，数组都会被重置为空数组。在这样的实施下，下一轮条件下推入的数字是如何保留的？`unshuf``each``unshuf``if`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:24:15.147

代码是这样工作的：

*   创建一个空数组，将存储最终结果。

*   获取一个介于 0 和初始数组占用之间的随机数。

*   将 indexcounter 初始化为零。
*   创建一个未洗牌的空数组。
*   循环遍历初始数组
    *   将每个项目推到未洗牌的数组中，
    *   除了 indexcounter == 随机数的那个，它进入结果数组
    *   同时保留一个索引计数器。
*   将未洗牌的数组重命名为初始数组。
*   从第 2 步开始重复，直到初始数组为空。

不用说，这很笨拙。而且它是用一种非常非Ruby的方式编写的，保持手动索引并使用变量名，如`randNum`. 这也差不多：

```
def shuffle(arr)
  dup = arr.dup
  arr.size.times.map do # actually arr.map would work
    dup.slice!(rand(dup.size))
  end
end 
```

但正如其他人所提到的，`[1,2,3].shuffle`是标准的 Ruby。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:33:26.630

我不知道你从哪里得到上面的代码。Ruby Array#shuffle 方法调用#shuffle！本机方法`rb_ary_shuffle_bang`，其内容如下：

```
static VALUE
rb_ary_shuffle_bang(int argc, VALUE *argv, VALUE ary)
{
  VALUE *ptr, opts, *snap_ptr, randgen = rb_cRandom;
  long i, snap_len;

  if (OPTHASH_GIVEN_P(opts)) {
    randgen = rb_hash_lookup2(opts, sym_random, randgen);
  }
  if (argc > 0) {
    rb_raise(rb_eArgError, "wrong number of arguments (%d for 0)", argc);
  }
  rb_ary_modify(ary);
  i = RARRAY_LEN(ary);
  ptr = RARRAY_PTR(ary);
  snap_len = i;
  snap_ptr = ptr;
  while (i) {
    long j = RAND_UPTO(i);
    VALUE tmp;
    if (snap_len != RARRAY_LEN(ary) || snap_ptr != RARRAY_PTR(ary)) {
      rb_raise(rb_eRuntimeError, "modified during shuffle");
    }
    tmp = ptr[--i];
    ptr[i] = ptr[j];
    ptr[j] = tmp;
  }
  return ary;
} 
```

在这里，您可以看到正确的洗牌方法。忽略上面代码的上半部分，注意只是`while`循环，它从上到下遍历数组，总是从索引下面的部分`i`随机选择一个元素，并将其移动到当前位置`i`，继续 decremented `i`。它的复杂性是 O(n) in n = 数组的长度，因为它应该用于洗牌。

然而，您书中的代码的工作方式完全不同：它总是`rand( arr.length )`从数组中选择一个元素 ( )，然后*遍历*数组以查看何时遇到具有该索引的元素，复杂度为 O(n**2/2) . 您的代码还提供了使用`#push`方法的一个很好的示例，尽管`#<<`已经足够了，因为每次只推送一个元素。`idx`您的代码给出了在`each`循环内手动维护索引的坏例子。`#each_with_index`应该改用方法。当然，在演示之外，应该完全放弃内部循环，而应该使用类似于本机`#shuffle`方法的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T23:08:21.220

```
def shuffle arr
  shuffled = []

  while arr.length > 0
    randNum = rand(arr.length)

    idx = 0
    unshuf = []

    print '--- arr='; p arr # <--------
    arr.each do |item|
      if idx == randNum
        shuffled.push item
      else
        unshuf.push item
      end
      print 'shuffled='; print shuffled; print ', unshuf='; p unshuf # <--------
      idx = idx + 1
    end

    arr = unshuf
  end

  return shuffled
end

p shuffle([ 11, 12, 13, 14, 15]) 
```

执行 ：

```
$ ruby -w t.rb 
--- arr=[11, 12, 13, 14, 15]
shuffled=[], unshuf=[11]
shuffled=[], unshuf=[11, 12]
shuffled=[13], unshuf=[11, 12]
shuffled=[13], unshuf=[11, 12, 14]
shuffled=[13], unshuf=[11, 12, 14, 15]
--- arr=[11, 12, 14, 15]
shuffled=[13, 11], unshuf=[]
shuffled=[13, 11], unshuf=[12]
shuffled=[13, 11], unshuf=[12, 14]
shuffled=[13, 11], unshuf=[12, 14, 15]
--- arr=[12, 14, 15]
shuffled=[13, 11, 12], unshuf=[]
shuffled=[13, 11, 12], unshuf=[14]
shuffled=[13, 11, 12], unshuf=[14, 15]
--- arr=[14, 15]
shuffled=[13, 11, 12, 14], unshuf=[]
shuffled=[13, 11, 12, 14], unshuf=[15]
--- arr=[15]
shuffled=[13, 11, 12, 14, 15], unshuf=[]
[13, 11, 12, 14, 15] 
```

解释： 的内容`arr`在 shuffled 和 unshuf 之间随机分布。然后 unshuf 替换 arr ，如果 unshuf 中有什么东西，while 循环会随机重新分配一点点 shuffle，一点点 unshuf。依此类推，直到 unshuf 为空。所以 shuffled 逐渐填充从`arr`最初给方法的参数中随机获取的元素`shuffle`，但`arr`也通过只保留 unshuf 元素逐渐清空`arr = unshuf`。当然，在移入 arr 后，unshuf 必须重置为空数组才能接收新的分布，而 shuffled 必须保持增长。希望很清楚。

# android - OnClick按钮，以相同的形式创建一个图层。安卓

> ID：14095276
> 
> 赞同：0
> 
> 时间：2012-12-30T22:22:41.377
> 
> 标签：android, android-layout, android-intent

我对 Android 很陌生。

我想创建一个动态的 OnClick 按钮功能。

![在此处输入图像描述](../Images/69e7adf10107b36c95fe94bfbe33dd69.png)

OnClick上面的“+”，它应该创建一个其他层，如下所示。

![在此处输入图像描述](../Images/47922d19d7e074c9d8e75da11e456b65.png)

我的困惑，我的整个设计 UI 都在 layout.xml 中。

我们如何在“+”按钮的 OnClick 上在我们的 UI 中包含另一层。

任何输入都会有所帮助。

谢谢 ！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:31:23.097

您可以以编程方式执行此操作。XML 用于静态布局。

原谅我的伪安卓：

```
private LinearLayout root;

public void onCreate(Bundle b){

    LinearLayout root = new LinearLayout(this);

    root.addChild(createGlucoseReadingView());

    setContentView(root);

}

private View createGlucoseReadingView() {
   LinearLayout glucoseRoot = new LinearLayout(this);
   glucoseRoot.addChild(new TextView(this));
   return glucoseRoot;
}

public void onPlusClick(View button){
   root.addChild(createGlucoseReadingView());
} 
```

沿着这些思路，我显然忽略了格式化并将布局参数添加到视图中，但你明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T06:22:50.763

在您的 XML 中有一个在运行时`Vertical Linear Layout`添加和删除`EditTexts`，这里我向您展示了我在演示中使用的代码。处理和维护使用。

Onclick 您的加减按钮单击

```
 public void onClick(View view) {
        super.onClick(view);
        switch (view.getId()) {

        case R.id.btnadd:
            createTextview(counter);
            counter++;
            if (counter > 3) {
                btnAdd.setVisibility(View.GONE);
                btnRemove.setVisibility(View.VISIBLE);
            }
            break;
        case R.id.btnremove:
            removeView(counter);
            txtoption[counter - 1] = null;
            counter--;
            if (counter < 3) {
                btnAdd.setVisibility(View.VISIBLE);
                btnRemove.setVisibility(View.GONE);
            }

            break;
        }
    } 
```

创建和删除视图的函数

```
private void createTextview(int index) {
    txtoption[index] = new EditText(this);
    txtoption[index].setSingleLine(true);
    LinearLayout.LayoutParams param = new LinearLayout.LayoutParams(
            LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
    param.bottomMargin = 10;
    txtoption[index].setLayoutParams(param);
    txtoption[index].setBackgroundResource(R.drawable.textbox);
    txtoption[index].setTypeface(ttfDroidSherif);
    lnpolloptions.addView(txtoption[index]);

}

private void removeView(int index) {
    lnpolloptions.removeView(txtoption[index - 1]);
} 
```

您的垂直 LinearLayout 包含所有 edittext 子项

```
LinearLayout lnpolloptions = (LinearLayout) findViewById(R.id.lnpolloptions); 
```

要在运行时创建或删除的编辑文本数组

```
private EditText[] txtoption = new EditText[4]; 
```

Onclick 提交以从每个文本框中获取值

```
 int length = txtoption.length;
            for (int i = 0; i < length; i++) {
                if (txtoption[i] != null) {
                    Log.i("Value",""+txtoption[i].getText());
                }
            } 
```

# c++ - C++ 分段错误 OpenCV

> ID：14095281
> 
> 赞同：0
> 
> 时间：2012-12-30T22:23:21.320
> 
> 标签：c++, opencv, segmentation-fault

以下代码中的想法是让一堆“流浪者”对象缓慢地将图像“绘制”到画布上。问题是，这段代码似乎只适用于方形图像（在代码中，方形图像被标识为“隐藏”（因为它是由“画家”揭开的）并且它是从名为“UncoverTest”的文件中加载的.png")，而不是矩形的，这对我来说很神秘。尝试使用除正方形以外的任何东西时出现分段错误错误。据我所知，当我进入循环遍历 Agent 类型的向量（在行`for (vector<Agent>::iterator iter = agents.begin(); iter != agents.end();++iter)`）时，会出现分段错误错误。

```
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <iostream>
#include <vector>

using namespace std;
using namespace cv;

//#define WINDOW_SIZE 500
#define STEP_SIZE 10.0
#define NUM_AGENTS 100
/********************/
/* Agent class definition and class prototypes */
/********************/
class Agent {
public:
  Agent();
  int * GetLocation(void);
  void Move(void);
  void Draw(Mat image);
  int * GetSize(void);
private:
  double UnifRand(void);
  int * location;
  int * GetReveal(void);
  Mat hidden;
};
int * Agent::GetSize(void) {
  int * size = new int[2];
  size[0] = hidden.cols;
  size[1] = hidden.rows;
  return (size);
}
int * Agent::GetReveal(void) {
  int * BGR = new int[3];
  location = GetLocation();
  for (int i = 0; i < 3; i++) {
    BGR[i] = hidden.data[hidden.step[0]*location[0] + hidden.step[1]*location[1] + i];
  }
  return (BGR);
}
void Agent::Draw(Mat image) {
  int * location = GetLocation();
  int * color = GetReveal();
  for (int i = 0;i < 3;i++) {
    image.data[image.step[0]*location[0] + image.step[1]*location[1] + i] = color[i];
  }
}
void Agent::Move(void) {
  int dx = (int)(STEP_SIZE*UnifRand() - STEP_SIZE/2);
  int dy = (int)(STEP_SIZE*UnifRand() - STEP_SIZE/2);
  location[0] += (((location[0] + dx >= 0) & (location[0] + dx < hidden.cols)) ? dx : 0);
  location[1] += (((location[1] + dy >= 0) & (location[1] + dy < hidden.rows)) ? dy : 0);
}
Agent::Agent() {
  location = new int[2];
  hidden = imread("UncoverTest.png",1);
  location[0] = (int)(UnifRand()*hidden.cols);
  location[1] = (int)(UnifRand()*hidden.rows);
}
double Agent::UnifRand(void) {
  return (rand()/(double(RAND_MAX)));
}
int * Agent::GetLocation(void) {
  return (location);
}
/********************/
/* Function prototypes unrelated to the Agent class */
/********************/
void DrawAgents(void);
/********************/
/* Main function */
/********************/
int main(void) {
  DrawAgents();
  return (0);
}
void DrawAgents(void) {
  vector<Agent> agents;
  int * size = new int[2];
  Mat image;
  for (int i = 0; i < NUM_AGENTS; i++) {
    Agent * a = new Agent();
    agents.push_back(* a);
    if (i == 0) {
      size = (* a).GetSize();
    }
  }
  // cout << size[0] << " " << size[1] << endl;
  image = Mat::zeros(size[0],size[1],CV_8UC3);
  cvNamedWindow("Agent Example",CV_WINDOW_AUTOSIZE);
  cvMoveWindow("Agent Example",100,100);
  for (int stop = 1;stop != 27;stop = cvWaitKey(41)) {
    for (vector<Agent>::iterator iter = agents.begin(); iter != agents.end();++iter) {
      (* iter).Move();
      (* iter).Draw(image);
    } imshow("Agent Example",image);
  }
} 
```

谁能向我解释这个错误是如何出现在方形图像上的，以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:50:44.090

我不完全理解您的代码，但根据您的最后一条评论，“踩到画布”我想我可以看到您有几种情况，您可能会尝试在“隐藏”中访问超出范围的数据垫子和“图像”垫子。

恐怕我只能提供建议

```
void Agent::Draw(Mat image) {
  int * location = GetLocation();
  int * color = GetReveal();
  for (int i = 0;i < 3;i++) {
    image.data[image.step[0]*location[0] + image.step[1]*location[1] + i] = color[i];
  }
} 
```

在这里，您访问的 GetLocation 已在构建代理期间从一个随机数乘以隐藏垫的大小进行实例化。我担心在访问 image.data 矩阵时会出现“索引越界”类型错误。所以这可能是首先要检查的。

就像明智的一样

```
int * Agent::GetReveal(void) {
  int * BGR = new int[3];
  location = GetLocation();
  for (int i = 0; i < 3; i++) {
    BGR[i] = hidden.data[hidden.step[0]*location[0] + hidden.step[1]*location[1] + i];
  }
  return (BGR);
} 
```

您使用 getLocation() 将返回一个远大于隐藏图像大小的点。所以我很确定你在这里也会遇到错误。位置应该来自 hidden.cols() 和 hidden.rows()。

只看了一眼，但我肯定会对 getLocation() 返回的值进行一些检查，以及是否可以从 mat 矩阵中访问这样的值。

此外，虽然我不完全确定，因为我认为您以两种不同的方式使用位置，但如果位置是 Draw(image) 中某处的一个点，那么您需要调整以下内容：

```
location[0] += (((location[0] + dx >= 0) & (location[0] + dx < hidden.cols)) ? dx : 0);
location[1] += (((location[1] + dy >= 0) & (location[1] + dy < hidden.rows)) ? dy : 0); 
```

并考虑隐藏图像的宽度，例如

```
location[0] += (((location[0] + dx >= 0) & (location[0] + dx + hidden.cols < maxWidth)) ? dx : 0);
location[1] += (((location[1] + dy >= 0) & (location[1] + dy + hidden.rows < maxHeight)) ? dy : 0); 
```

其中 maxWidth 和 maxHeight 是图像的宽度。

希望这能让你走上正轨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-12T10:56:49.667

如果您在 Linux 环境中，则可以使用 valgrind 来准确找出发生分段错误的位置。只需在程序名称或执行程序的方式之前键入 valgrind。例如，如果您使用以下命令执行程序：

你好-打印

发出以下命令：

valgrind 你好 -print

# c++ - Win 32 或提升内存映射访问

> ID：14095286
> 
> 赞同：1
> 
> 时间：2012-12-30T22:24:02.177
> 
> 标签：c++, memory-mapped-files

我被告知内存映射文件是一种可能的方式来获得快速文件 i/o 以存储 2d 游戏瓷砖地图。游戏将频繁更新数据，我将知道要更新的行/列，因此我可以在数组中以这种方式直接访问。但是看一些例子我不明白这是如何工作的。

有没有人有一个创建，读取和写入结构的内存映射文件的小例子，其中结果将是一个一维数组，所以我可以为我的游戏访问它 map[row * MAX_ROW + col].tileID = X; 例如。Boost 或 Win 32 会很好 我没有偏好，但我发现网上的例子有点令人困惑，而且通常很难将它们转换为我想要的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:56:49.400

这里有一个看起来有点可以理解的例子：[提升内存映射文件的问题：它们进入磁盘而不是 RAM](https://stackoverflow.com/questions/1936266/problem-with-boost-memory-mapped-files-they-go-to-disk-instead-of-ram)

请注意为您提供 char* 的 .data() 成员，您可以将其强制转换为指向数组的指针，该数组包含您想要的任何内容，只要有足够的内存就可以了。

也就是说，我高度怀疑内存映射文件是错误的解决方案。为什么不直接使用普通的 C++（向量、类、ifstreams 等）加载关卡，随意修改它，如果你想将更改保存到磁盘，在完成后再次写出来？

# c# - 每次调用 async void 方法是否都会创建一个新线程？

> ID：14095288
> 
> 赞同：5
> 
> 时间：2012-12-30T22:24:03.913
> 
> 标签：c#, .net, async-await

我有以下情况：

```
async void DoStuff() {
    // ...
}

button1.Click += (s, p) => {
    DoStuff();
}; 
```

我不确定`async void`在第一次调用仍未完成时调用方法时会发生什么。该调用会在每次调用时创建一个新线程，还是该调用会破坏并覆盖先前创建的线程？另外，如果前一个假设是正确的，是否会共享局部方法变量？

编辑：

我误解了这`async await`件事，因为在 Windows 8 应用程序中，它的行为不同。如果您认为调用异步方法与创建新线程一样像我一样，请阅读[这篇澄清文章](http://blogs.infosupport.com/c-5-0-async-explained-as-simple-as-possible/)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T22:26:27.333

> 我不确定当我同时多次调用 async void 方法时会发生什么

您的意思是如果在第一个呼叫仍未完成（可能“暂停”）时发生另一个呼叫？它会工作得很好。没有“压倒一切”，也没有“破坏”。您将得到另一个状态机实例（这是编译器为您构建的）。

这两个状态机将具有完全独立的局部变量等。当然，一次实际上只能*运行*其中一个，除非您在异步方法中的某个地方避免捕获上下文。

不要忘记启动异步方法*不会*启动新线程。*您在*async 方法中启动的一些异步操作可能会启动新线程，但这是另一回事。生成的代码中的任何内容都不会创建新线程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T22:26:32.017

不。

异步方法与线程无关。
相反，异步方法将在调用者的线程上执行其代码，就像常规方法调用一样，直到第一个`await`.

每个之后的代码都`await`将在等待运行其回调的线程上运行。
这完全取决于你在做什么`await`。
通常，您将生成对象，这些对象默认在 UI 线程上运行它们的回调`await`。`Task`

# php - PHP输出不正确的日期

> ID：14095293
> 
> 赞同：0
> 
> 时间：2012-12-30T22:25:02.307
> 
> 标签：php, html, forms, date

我有这个代码：

```
$date = substr($item[8], 7, 9);
$date = str_replace('/', '-', $date); 
```

此时，$date 包含：

```
12-21-12  <---- December 21, 2012 
```

现在我正在尝试将日期输出为输入 type="date" 友好格式，如下所示：

```
<input type="date" name="date" value="<?php echo date('Y-m-d', strtotime($date)); ?>"> 
```

但它不会正确输出。

如果我将 type="date" 更改为 type="text" 我会看到以下输出：

```
1969-12-31 
```

显然有些东西不正常

```
date('m-d-Y', strtotime($date)); 
```

谁能帮我解决问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:27:16.597

日期必须是`Y-m-d`格式，而不是`m-d-Y`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:29:15.267

如果您使用的是 PHP 5.3+，我鼓励使用[`DateTime`](http://php.net/manual/en/class.datetime.php)该类。

在你的情况下：

```
$date = DateTime::createFromFormat('m-d-y', '12-21-12');
echo $date->format('Y-m-d'); // 2012-12-21 
```

如前所述`strtotime('12-21-12')`，因为日期格式在月份和年份方面不明确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:40:57.770

移除

```
$date = str_replace('/', '-', $date); 
```

解决问题。

# python - 无法在 Django 中使用 get 方法获取对象值

> ID：14095295
> 
> 赞同：0
> 
> 时间：2012-12-30T22:25:22.807
> 
> 标签：python, django

我想从模型中获取对象值。尝试 get() 方法后，我无法使其工作。我收到以下错误。我有一个向用户显示地点名称的页面，所以如果用户看到他喜欢的地点，他会继续填写表格。在表格中，我想自动从另一个地方获取地点的名称模型，我不希望用户填写地点的名称。以下是我的代码

```
 NameError at /welcome/

       global name 'name' is not defined 
```

楷模

```
 class Fin(models.Model):
      user=models.ForeignKey(User)
      name=models.CharField(max_length=100)

      def __unicode__(self):
          return self.user

 class Place(models.Model):
      user=models.ForeignKey(User)
      mall=models.ForeignKey(Fin)
      full_name=models.CharField(max_length=100)
      e_mail=models.EmailField(max_length=100)
      phone_no=models.CharField(max_length=100)
      pub_date=models.DateTimeField()

      def __unicode__(self):
          return self.full_name
      class Meta:
         ordering=['-pub_date']

  class PlaceForm(ModelForm):
       class Meta:
         model=Place
         fields=('full_name','e_mail','phone_no')
         exclude=('user','pub_date','mall') 
```

意见：

```
 def place_me(request):
       if request.method=="POST":
          form=PlaceForm(request.POST)
          if form.is_valid():
             data=form.cleaned_data
             newbooks=Place(
                 user=request.user,
                 pub_date=datetime.datetime.now(),
                 mall=Fin.objects.get(name),
                 full_name=data['full_name'],
                 e_mail=data['e_mail'],
                 phone_no=data['phone_no'])
             newbooks.save()
             return HttpResponse('Thanks for choosing themall, we will contact you as soon as possible. Go grab a beer :)')
         else:
            return HttpResponse('Some fields are not filled correctly')
     else:
        return render_to_response('buuk.html',{'PlaceForm':PlaceForm},context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:27:07.947

这一行`mall=Fin.objects.get(name)`您没有`name`在视图中的任何位置声明变量`place_me`，因此它是未定义的。

你传递参数的方式`.get`也是错误的，它必须是这样的：

```
mall=Fin.objects.get(name='any name')
# or you can do
mall=Fin.objects.get(user=request.user) 
```

# php - 展平索引数组

> ID：14095301
> 
> 赞同：0
> 
> 时间：2012-12-30T22:26:11.960
> 
> 标签：php, mysql, arrays, function, multidimensional-array

我正在尝试将 PHP 数组插入到 mysql 数据库中，但是遇到了这个特定数组的问题。我正在尝试创建一个需要

```
 array( 0 => array ( 'col1' => 'value', 'col2' => 'value', 'col3' => 'value', 'col4' => value', 'col5' => 'value', 'col6' => array ( 'string' => array ( 'col7' => 'value' , 'col8' => 'value'), ), ), 

    1 => array ( 'col1' => 'value', 'col2' => 'value', 'col3' => 'value', 'col4' => array ( ), 'col5' => 'value', 'col6' => array ( 'string' => array ( ), ),  ),

     2 => array ( 'col1' => 'value', 'col2' => 'value', 'col3' => 'value', 'col4' => array ( ), 'col5' => 'value', 'col6' => array ( 'string' => array ( ), ), ), ) 
```

并分隔每个编号的数组并将其格式化为：

```
array( 'col1' => 'value', 'col2' => 'value', 'col3' => 'value', 'col4' => 'value', 'col5' => 'value', ['col6' => 'value','col7' => 'value',] )

array( 'col1' => 'value', 'col2' => 'value', 'col3' => 'value', 'col4' => 'value', 'col5' => 'value', ['col6' => 'value','col7' => 'value',] )

array( 'col1' => 'value', 'col2' => 'value', 'col3' => 'value', 'col4' => 'value', 'col5' => 'value', ['col6' => 'value','col7' => 'value',] ) 
```

取决于有多少行。请记住以下条件：

```
+8 cols is just an example, the range can fluctuate greatly. 
+Cols containing a array must be non existent if it empty, like in [1] and [2], but not [0].
+Any column could contain a empty or full array. if it contains a full array, it needs to be flatten while retaining it's value.
+Some arrays might have greater then 2 nested arrays. (elements)  
+Not all of the arrays have nested arrays, they are already formatted correctly. These arrays can not be affected by the PHP function i'm trying to create. 
```

我很难过，我创建的每个功能都失败了。提前感谢大家。

*更新*我用`Var_export`这个函数来获取上面的数组。

```
 function flatten($array, $preserve_keys = false)
{
  if (!$preserve_keys) {
 $array = array_values($array);

  }
  $flattened_array = array();

  foreach ($array as $k => $v) {
   $flattened_array[$k] = $v;
    if (is_array($v)) {

      $flattened_array = array_merge($flattened_array, call_user_func(__FUNCTION__, $v, $preserve_keys));
    } elseif ($preserve_keys) {
      $flattened_array[$k] = $v;
    } else {
      $flattened_array[] = $v;
    }
  }
  return (array)$flattened_array;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:23:13.533

您需要的是所谓的递归函数（有关更多信息，请参阅此问题：[PHP 中的递归函数是什么？](https://stackoverflow.com/questions/2648968/what-is-a-recursive-function-in-php)）。

此外，数组中的每个“col”似乎都是一个字符串（而不是数字）。

您可能想尝试的是检查数组中的第一个（或任何一个）键是否是数字。

代码看起来像这样：

```
public function extractArray($myArray){

    $extractedArray = array(); // create a new array where all the flattened data will go
    $arrayKeys = array_keys($myArray); // grab all the keys from the array
    if (is_numeric($arrayKeys[0])): // if the first key is a number (it's nested)
        $extractedArray = $myArray[0]; // remove one level of the array by grabbing everything from the first element
        extractArray($extractedArray); // run our function again to check if we need to remove another layer
    else:

        $extractedArray = $myArray; // seems like there are no layers that need to be removed
    endif;
    return $extractedArray;
} 
```

**编辑：**

这是问题第二部分的可能解决方案（从可能的子数组中提取值）

以下是我们将要采取的步骤：

1) 遍历 $extractedArray 中的每个元素（来自第 1 部分）并查看它是否是子数组

2）如果它是一个数组，我们提取它的内容并将其放在一个临时变量中（现在是一个数组）

3）然后我们再次（递归地）调用自己，将新的临时变量传递给它（直到没有更多的子数组离开

4）一旦我们提取了所有值并将它们展平到一个数组中，我们就可以遍历该数组并将它们存储为字符串（或我们喜欢的任何其他内容）

**更新的代码** 这是代码：

```
public function flattenArrayValues($extractedArray){
     $extractedValues = array();
     foreach($extractedArray as $key => $eA):
          if(is_array($eA)): // check whether current element is an array
            reset($eA); // go to the first element of the array and grab it
            $first_key = key($eA); // ...
            $extractedValues[$key] = $eA[$first_key]; // this allows us to preserve the "cols" for each element
            flattenArrayValues($extractedValues); //call ourselves again to check whether there are any sub-arrays
          endif;
     endforeach;
     return $extractedValues; // seems like we extracted all the values and flattened them 
     // if we want we can loop through this new array and build a string out of it etc.
} 
```

希望这有帮助

# requirejs - RequireJS - shim 中“exports”属性的目的是什么

> ID：14095308
> 
> 赞同：50
> 
> 时间：2012-12-30T22:26:56.300
> 
> 标签：requirejs

下面 shim 中的“exports”属性的目的是什么？真的需要吗？

```
requirejs.config({
    shim: {
        'backbone': {
            deps: ['underscore', 'jquery'],
            exports: 'Backbone'
        }
    }
}); 
```

我问是因为这似乎是多余的 - 当模块包含在依赖项列表中时，我们将再次指定导出的名称作为函数参数：

```
define(['backbone'], function (Backbone) {
  return Backbone.Model.extend({});
}); 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-31T03:04:15.963

如果`shim`在您的示例中未使用，则`Backbone`作为参数传入的对象将未定义，因为 Backbone 不符合 AMD 标准，并且不会返回对象供 RequireJS 使用。

```
define(['backbone'], function (Backbone) {
  // No shim? Then Backbone here is undefined as it may
  // load out of order and you'll get an error when
  // trying to use Model
  return Backbone.Model.extend({});
}); 
```

为了提供一些上下文，我将使用 r.js 优化器吐出的代码，但我将在此示例中对其进行简化。它通过阅读优化器产生的内容帮助我理解了它的要点。

带垫片的 Backbone 有点像这样：

```
// Create self invoked function with the global 'this'
// passed in. Here it would be window
define("backbone", (function (global) {
    // When user requires the 'backbone' module
    // as a dependency, simply return them window.Backbone
    // so that properites can be accessed
    return function () {
        return global.Backbone;
    };
}(this))); 
```

关键是当你请求一个模块时，给 RequireJS 一些东西来返回给你，它会确保在这样做之前先加载它。在优化器的情况下，它将简单地预先嵌入库。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-03-21T05:40:05.177

如果您不使用*“export”* *Backbone*，那么您将无法在模块中获取到 Backbone(window.Backbone) 的语言环境引用，该引用在主干.js 中定义。

```
//without export Backbone
shim : {
  'bbn':{
        //exports:'Backbone',
        deps:['underscore']
    },
    'underscore': {
        exports: '_'
    }
};

require(['bbn'], function(localBackbone) {
  //localBackbone undefined.
  console.log('localBackbone:,' localBackbone);
}); 
```

RequireJs 解释如下：

```
//RequireJS will use the shim config to properly load 'backbone' and give a local
//reference to this module. The global Backbone will still exist on
//the page too.
define(['backbone'], function (Backbone) {
  return Backbone.Model.extend({});
}); 
```

RequireJS 将使用 shim 配置来获取全局 Backbone

```
function getGlobal(value) {
        if (!value) {
            return value;
        }
        var g = global;
        each(value.split('.'), function (part) {
            g = g[part];
        });
        return g;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-03T08:47:39.973

另请注意，您可能希望在“导出”中使用插件的实际导出。例如，

```
requirejs.config({
    shim: {
        'jquery.colorize': {
            deps: ['jquery'],
            exports: 'jQuery.fn.colorize'
        },
        'jquery.scroll': {
            deps: ['jquery'],
            exports: 'jQuery.fn.scroll'
        },
        'backbone.layoutmanager': {
            deps: ['backbone']
            exports: 'Backbone.LayoutManager'
        },
        "jqueryui": {
            deps: ["jquery"],
            //This is because jQueryUI plugin exports many things, we would just 
            //have reference to main jQuery object. RequireJS will make sure to
            //have loaded jqueryui script.
            exports: "jQuery"  
        },
        "jstree": {
            deps: ["jquery", "jqueryui", "jquery.hotkeys", "jquery.cookie"],
            exports: "jQuery.fn.jstree"
        },
        "jquery.hotkeys": {
            deps: ["jquery"],
            exports: "jQuery"  //This plugins don't export object in jQuery.fn
        },
        "jquery.cookie": {
            deps: ["jquery"],
            exports: "jQuery" //This plugins don't export object in jQuery.fn
        }
    }
}); 
```

更多：[https ://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0#wiki-shim](https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0#wiki-shim)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T22:51:38.697

Shim 导出是为了让 requirejs 知道如何处理非 AMD 模块。没有它，在模块启动时，define 块中的依赖项仍将被加载。它向 requirejs 发出信号，表明它已停止加载资源并且模块可以开始使用它。

至少，我是这么看的。

# javascript - 如何将文本传递给 javascript 变量/函数？

> ID：14095314
> 
> 赞同：0
> 
> 时间：2012-12-30T22:27:34.203
> 
> 标签：javascript, jquery

我想创建内联的“可推文引号”。例如：

1) 用户点击一行文本，用突出显示/不同颜色表示，表明它是可点击的。例如

```
<span class="tweetable_quote">this is an amazing quote</span> 
```

2) 使用 Twitter 意图 [1] 打开窗口，其中包含报价。例如

```
window.open("https://twitter.com/intent/tweet?text=this%20is%20an%20amazing%20quote") 
```

如何将文本（“这是一个惊人的报价”）作为要在 Twitter 意图 URL 中使用的 URL 编码变量传递？请注意，同一页面上可能有多个“可推文引用”。

在此先感谢您的帮助！

[1] [https://dev.twitter.com/docs/intents](https://dev.twitter.com/docs/intents)

**更新**

我尝试实施以下建议，在以下代码中添加以下代码：

```
<script type="text/javascript">
//  this will be the click handler for all elements with the "tweetable_quote" class.
$(".tweetable_quote").on('click',function(){
  // $(this) refers to the element that was clicked.
  var text = $(this).text();
  window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(text));
});
</script>

<span class="tweetable_quote">This is some quotable text.</span> 
```

页面加载时，控制台显示以下错误：

```
Uncaught TypeError: Object #<Object> has no method 'on'
(anonymous function) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:31:59.747

可以使用[jQuery](http://jquery.com)来做这样的事情。

```
$('.tweetable_quote').on('click', function() {
  window.open("https://twitter.com/intent/tweet?text=" + encodeURIComponent ($(this).text()));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:32:03.070

也许这就是您正在寻找的 -

```
//  this will be the click handler for all elements with the "tweetable_quote" class.
$(".tweetable_quote").on('click',function(){
  // $(this) refers to the element that was clicked.
  var text = $(this).text();
  window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(text));
}); 
```

我在[`encodeURIComponent()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)这里使用函数来正确编码文本 -

> **encodeURIComponent** - 通过用一个、两个、三个或四个表示字符的 UTF-8 编码的转义序列替换某些字符的每个实例来对统一资源标识符 (URI) 组件进行编码（对于由两个字符组成的字符，只有四个转义序列“代理”字符）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T20:17:19.490

试试这个：

```
<script src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
<script type="text/javascript">
  $(function() {
    var $quoteEl = $('.tweetable_quote');

    $quoteEl.on('click',function(){
      var text = $(this).text();
      window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(text));
    });
  });
</script> 
```

# excel - 通过 Midi 控制器控制 Excel

> ID：14095315
> 
> 赞同：24
> 
> 时间：2012-12-30T22:27:40.083
> 
> 标签：excel, vba, midi, winmm

我有其中之一[（来源：][[netdna-cdn.com](http://mustech.jpsystemsinc.netdna-cdn.com/wp-content/uploads/2008/12/kontrol.gif)][）][![纳米控制的](../Images/6ecdff11fdb3f693301a89ec3a8e6250.png)](https://i.stack.imgur.com/iYJxF.gif)

并想使用它上面的滑块来控制 Excel，就像 Excel 表单控件滚动条之一一样。

我已经设法为 VBA 修改[了这段代码](https://web.archive.org/web/20051206084845/http://www.vbfrance.com:80/code.aspx?ID=6512)，但它非常不稳定。谁能帮我稳定一下？我认为如果 MidiIn_Event 函数返回的速度不够快，它可能会崩溃，但我可能错了。

提前致谢。

```
Public Const CALLBACK_FUNCTION = &H30000
Public Declare Function midiInOpen Lib "winmm.dll" 
        (lphMidiIn As Long, 
        ByVal uDeviceID As Long, ByVal dwCallback As Any, 
        ByVal dwInstance As Long, ByVal dwFlags As Long) As Long
Public Declare Function midiInClose Lib "winmm.dll" 
        (ByVal hMidiIn As Long) As Long
Public Declare Function midiInStart Lib "winmm.dll" 
        (ByVal hMidiIn As Long) As Long
Public Declare Function midiInStop Lib "winmm.dll" 
        (ByVal hMidiIn As Long) As Long
Public Declare Function midiInReset Lib "winmm.dll" 
        (ByVal hMidiIn As Long) As Long
Private ri As Long

Public Sub StartMidiFunction()
    Dim lngInputIndex As Long
    lngInputIndex=0
    Call midiInOpen(ri, lngInputIndex, AddressOf MidiIn_Event, 
            0, CALLBACK_FUNCTION)
    Call midiInStart(ri)
End Function

Public Sub EndMidiRecieve()
    Call midiInReset(ri)
    Call midiInStop(ri)
    Call midiInClose(ri)
End Sub

Public Function MidiIn_Event(ByVal MidiInHandle As Long, 
        ByVal Message As Long, ByVal Instance As Long, 
        ByVal dw1 As Long, ByVal dw2 As Long) As Long

    'dw1 contains the midi code
    If dw1 > 255 Then 'Ignore time codes
        Call MsgBox(dw1)    'This part is unstable
    End If
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T23:33:40.043

问题可能是`MsgBox`：

*   由于 MIDI 事件使用回调，它们很可能从另一个线程运行。VBA 本质上是单线程的（参见例如[VBA 中的多线程](https://stackoverflow.com/questions/5721564/multi-threading-in-vba)），因此尝试从另一个线程显示模态对话框可能会导致问题（未定义的行为、崩溃、其他任何事情......）
*   MIDI 通常会触发大量的事件（滑块或旋钮的最微小的移动都会触发一个事件），因此移动某个明显的量可能会导致数百个事件。在每个事件中显示一个对话框（需要单击确定）可能是一个问题。

为了测试，请尝试替换`Call MsgBox(dw1)`为，`Debug.Print dw1`以便将值仅打印在立即窗口中，这应该更加稳定。如果您尝试执行一些简单的操作（例如，更新单元格中的值、滚动窗口），只要每次调用在下一个事件之前完成，您*就可以摆脱它。*`MidiIn_Event`

一个更复杂但更稳定的解决方案可能是将数据点推送到事件处理程序中的队列中，并在 VBA 中使用重复计时器，从队列中弹出项目并在 VBA 线程上执行一些操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:07:10.570

这太酷了：D

但是上面提到的消息框会杀死它，但是删除消息框可能不会有太大帮助。您也希望尽量减少 excel 的流量，因为 vba->excel 不会是瞬时的。

Soooo的解决方案是

在工作簿上启动宏

```
 Public lngMessage As String

    Private Sub Workbook_Open()
        alertTime = Now + TimeValue("00:00:01")
        Application.OnTime alertTime, "EventMacro"
    End Sub
    Sub EventMacro()
        ActiveSheet.Cells(1, 1).Value = lngMessage
        alertTime = Now + TimeValue("00:00:01")
    End Sub

    Public Function MidiIn_Event(ByVal MidiInHandle As Long, ByVal Message As Long, ByVal Instance As Long, ByVal dw1 As Long, ByVal dw2 As Long) As Long
        'dw1 contains the midi code
        If dw1 > 255 Then 'Ignore time codes
            lngMessage = dw1    'This part is now happy
        End If
    End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-29T08:51:32.013

您需要一个通用函数来处理 MidiIn_Event 一个给出的数据，在我下面的示例中，该函数是 runClock() 一个。

我这样做是为了能够使用状态栏来计算消息的键和时钟类型。

```
Option Explicit

Private Const CALLBACK_FUNCTION = &H30000

'MIDI Functions here: https://docs.microsoft.com/en-us/windows/win32/multimedia/midi-functions
#If Win64 Then
    Private Declare PtrSafe Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As LongPtr)
    Private Declare PtrSafe Function timeGetTime Lib "winmm.dll" () As Long
    'For MIDI device INPUT
    Private Declare PtrSafe Function midiInOpen Lib "winmm.dll" (lphMidiIn As LongPtr, ByVal uDeviceID As LongPtr, ByVal dwCallback As LongPtr, ByVal dwInstance As LongPtr, ByVal dwFlags As LongPtr) As Long
    Private Declare PtrSafe Function midiInClose Lib "winmm.dll" (ByVal hMidiIn As LongPtr) As Long
    Private Declare PtrSafe Function midiInStart Lib "winmm.dll" (ByVal hMidiIn As LongPtr) As Long
    Private Declare PtrSafe Function midiInStop Lib "winmm.dll" (ByVal hMidiIn As LongPtr) As Long
    Private Declare PtrSafe Function midiInReset Lib "winmm.dll" (ByVal hMidiIn As LongPtr) As Long
#Else
    Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
    Private Declare Function timeGetTime Lib "winmm.dll" () As Long
    'For MIDI device INPUT
    Private Declare Function midiInOpen Lib "winmm.dll" (lphMidiIn As Long, ByVal uDeviceID As Long, ByVal dwCallback As Long, ByVal dwInstance As Long, ByVal dwFlags As Long) As Long
    Private Declare Function midiInClose Lib "winmm.dll" (ByVal hMidiIn As Long) As Long
    Private Declare Function midiInStart Lib "winmm.dll" (ByVal hMidiIn As Long) As Long
    Private Declare Function midiInStop Lib "winmm.dll" (ByVal hMidiIn As Long) As Long
    Private Declare Function midiInReset Lib "winmm.dll" (ByVal hMidiIn As Long) As Long
#End If

#If Win64 Then
    Private mlngCurDevice      As Long
    Private mlngHmidi          As LongPtr
#Else
    Private mlngCurDevice      As Long
    Private mlngHmidi          As Long
#End If

Private ClockTicks             As Integer
Private Notes                  As Integer
Private Looper                 As Long
Private LongMessage            As Long
Private actualTime             As Long

Public Sub runClock()

    'When canceled become able to close opened Input devices (For ESC press)
    On Error GoTo handleCancel
    Application.EnableCancelKey = xlErrorHandler

    With Application
        .Calculation = xlCalculationManual
        .ScreenUpdating = False
        '.DisplayStatusBar = False
        '.EnableEvents = False
    End With

    mlngCurDevice = 8 'My Device is 8 but yours is 0
    Notes = 0
    Looper = 0

    'Open Input Device
    Call midiInOpen(mlngHmidi, mlngCurDevice, AddressOf MidiIn_Event, 0, CALLBACK_FUNCTION)

    'Ends only when Status is different from 0
    Do While Notes < 10
        'Reset Status count
        ClockTicks = 0

        'Begins lissinting the MIDI input
        Call midiInStart(mlngHmidi)

        'Loops until the right message is given <= 255 and > 0
        Do While ClockTicks < 1000 And Notes < 10
            'Sleep if needed
            Sleep 10
            Application.StatusBar = "Looper=" & Looper & " | Notes=" & Notes & " | ClockTicks=" & ClockTicks & " | Message=" & LongMessage
            Looper = Looper + 1
            'DoEvents enables ESC key
            If Abs(timeGetTime - actualTime) > 3000 Then
                DoEvents
                actualTime = timeGetTime
            End If
        Loop

        'Ends lisingting the MIDI input
        Call midiInReset(mlngHmidi)
        Call midiInStop(mlngHmidi)

    Loop

    'Closes Input device
    Do While midiInClose(mlngHmidi) <> 0
    Loop

    With Application
        .Calculation = xlCalculationAutomatic
        .ScreenUpdating = True
        .DisplayStatusBar = True
        .EnableEvents = True
    End With

    MsgBox "ENDED WITH SUCCESS", , "Message:"

    'Close all opened MIDI Inputs when canceled (ESC key pressed)
handleCancel:
        If Err.Number = 18 Then

            'Ends lisingting the MIDI input
            Call midiInReset(mlngHmidi)
            Call midiInStop(mlngHmidi)
            Do While midiInClose(mlngHmidi) <> 0
            Loop

            With Application
                .Calculation = xlCalculationAutomatic
                .ScreenUpdating = True
                .DisplayStatusBar = True
                .EnableEvents = True
            End With

            MsgBox "ENDED WITH SUCCESS", , "Message:"

        End If

End Sub

Private Function MidiIn_Event(ByVal mlngHmidi As Long, ByVal Message As Long, ByVal Instance As Long, ByVal dw1 As Long, ByVal dw2 As Long) As Long

    'The value 963 is the MIM_DATA concerning regular MIDI messages
    If Message = 963 Then
        LongMessage = Message
        If dw1 > 255 Then
            Notes = Notes + 1
        Else
            ClockTicks = ClockTicks + 1
        End If
    End If

End Function 
```

出于某种原因，在接收 MIDI 数据（如时钟同步）时按下 ESC 键时会出现问题，尽管其他一切正常，但 ESC 键多次使脚本崩溃。但是，如果您在输入 MIDI 消息期间不使用 ESC 键，则不会出现此问题。

不过，我想知道为什么在接收时钟信号时按 ESC 键会使脚本崩溃。

您只需要使全局变量适应您的需要。

希望我有所帮助。

# d3.js - TopoJSON 属性保存

> ID：14095316
> 
> 赞同：13
> 
> 时间：2012-12-30T22:27:53.297
> 
> 标签：d3.js

我正在使用 topojson 转换现有的 GeoJSON 数据集，但它没有保留属性。它遵循标准的 GeoJSON 格式，并将属性放置在与几何图形相同级别的“属性”对象中（下面的片段），但是当 topojson 成功完成时，我最终得到了一个可以使用和显示的有效 topojson 数据文件地图，但文件中的任何地方都没有属性。我没有指定属性，默认行为是在这种情况下保留所有属性，所以我很困惑。

```
{"type": "Feature", "geometry": {"type":"MultiLineString","coordinates":[[[12.06,37.97],[12.064,37.991]],[[12.064,37.991],[28.985,41.018]]]}, "properties": {"pair": 50129,"direction": 0,"month": 12,"priority": 0,"expense": 4.854,"duration": 20.423,"length": 2950.524}} 
```

编辑：我也没有足够的点数来注册 topojson 标记，所以在创建该标记之前，我会将其列为 D3。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-04T15:10:19.403

你在使用`-p`选项吗？

`topojson in.json -o out.json`- 删除所有属性

`topojson in.json -o out.json -p`- 保留所有属性

`topojson in.json -o out.json -p prop1,prop2`- 只保留 prop1 & prop2

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-05T16:13:22.980

正如@ow3n 所说，[geo2topo](https://github.com/topojson/topojson-server/blob/master/README.md#geo2topo)不再提供编辑原始属性的方法。因此@james246 很好的答案不再适用于最新的包。

但我终于明白了如何使用[ndjson-cli](https://github.com/mbostock/ndjson-cli/blob/master/README.md)来做到这一点。感谢 Mike Bostock 自己在[github 问题线程](https://github.com/topojson/topojson/issues/315)中的回答，这几乎是复制粘贴，所以网络犹豫看看原件。

首先安装新包：

```
npm i -g shapefile ndjson-cli topojson-client topojson-server topojson-simplify 
```

然后分三步：

*第 1 步*：将 Shapefile 转换为以换行符分隔的 GeoJSON 特征。

```
shp2json -n original.shp > myfile.ndjson 
```

*第 2 步*：重新定义 GeoJSON 属性，您也可以重命名它们。

```
ndjson-map 'd.properties = {prop1: d.properties.prop1, p2: d.properties.prop2}, d' \
  < myfile.ndjson \
  > myfile-filtered.ndjson 
```

*第 3 步*：将换行符分隔的 GeoJSON 转换为 TopoJSON。

```
geo2topo -n myfile-filtered.ndjson > myfile-topo.json 
```

**注意**：
如果您不再拥有原始文件，您可以使用[ndjson-split](https://github.com/mbostock/ndjson-cli#split)`.shp`将您的实际`.json`文件转换为以换行符分隔的 GeoJSON 功能：

```
 ndjson-split 'd.features' \
  < myfile.json \
  > myfile.ndjson 
```

然后按照*步骤 2*中的说明进行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-16T11:28:31.583

topojson 中的此功能现已移至[geo2topo](https://github.com/topojson/topojson-server/blob/master/README.md#geo2topo)，不再提供编辑原始属性的方法。

> 输入要素对象的任何属性和标识符都会传播到输出。如果要转换或过滤属性，请尝试 ndjson-cli，如命令行制图所示。

[我发现编写自己的脚本比使用](https://github.com/omundy/RemoveGeojsonProperties)[ndjson-cli](https://medium.com/@mbostock/command-line-cartography-part-2-c3a82c5c0f3#.8fjo5sdme)在命令行上编辑所有属性更容易。

```
/**
 *  Remove unwanted geojson feature properties
 */

var fs = require('fs');

var inputFile = 'input.geojson',
    outputFile = 'output.geojson',
    remove = ["properties","to","remove"];

function editFunct(feature){
    feature.TID = feature.properties.TID; // set the TID in the feature
    return feature;
}

removeGeojsonProps(inputFile,outputFile,remove,editFunct);

function removeGeojsonProps(inputFile,outputFile,remove,editFunct){

    // import geojson
    var geojson = JSON.parse(fs.readFileSync(inputFile, 'utf8'));

    // for each feature in geojson
    geojson.features.forEach(function(feature,i){

        // edit any properties
        feature = editFunct(feature);

        // remove any you don't want
        for (var key in feature.properties) {   

            // remove unwanted properties
            if ( remove.indexOf(key) !== -1 )
                delete feature.properties[key];
        }
    });

    // write file
    fs.writeFile(outputFile, JSON.stringify(geojson), function(err) {
        if(err) return console.log(err);
        console.log("The file was saved!");
    }); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-29T07:21:08.137

我也遇到了这个问题，但@james246 的回答对我不起作用。但是，我找到了一个同样简单的解决方案。

仅当您从同级文件文件夹中删除源 .shp 文件时，才会删除*属性数据。*`shp2geo`在应用命令之前，请确保 .shp 和 .dbf 文件位于同一文件夹中。（.dbf 文件包含*属性*数据。）

无需应用类似条件`-p`或其他任何条件；默认命令保留*属性*。

# sql - 根据重复值从三行更新 2 行

> ID：14095331
> 
> 赞同：1
> 
> 时间：2012-12-30T22:29:10.017
> 
> 标签：sql, tsql

如何更新`site_id`除最后一行之外的所有重复行。即，如果我有 3 个重复的站点 id（在这种情况下为 2 个），我如何更新前两个而使最后一个（第三个）保持不变？

```
temp_id site_id amount
1            2  200
2            2  200
3            2  200
4            3  200
5            3  200
6            4  200 
```

创建表#site（temp_id NUMERIC IDENTITY，site_id NUMERIC PRIMARY KEY）

```
INSERT INTO #site VALUES(2),(3),(4)

CREATE TABLE #temp (temp_id NUMERIC IDENTITY,
                      site_id NUMERIC FOREIGN KEY (site_id)       REFERENCES #site(site_id), 
                      amount  NUMERIC)

 INSERT INTO #temp VALUES(2,200),(2,200),(2,200),(3,200),(3,200),(4,200)

update #temp
set amount = 2
where site_id in (
select distinct table1.site_id
from #temp table1
inner join #temp table2 on table1.site_id = table2.site_id
and table1.temp_id <> table2.temp_id
)
and site_id <> (
select max(site_id)
from #temp
);

SELECT t.* FROM #temp t
JOIN #site            s ON s.site_id = t.site_id

DROP TABLE #temp
DROP TABLE #site 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:34:09.767

```
UPDATE temp_record
    SET …
    WHERE site_id = 2
        AND temp_id <> (SELECT MAX(temp_id)
                            FROM my_table
                            WHERE site_id = 2) 
```

如果您想更新所有这些行并且`temp_id`是 中的唯一键`temp_record`：

```
UPDATE temp_record
    SET …
    WHERE temp_id NOT IN (
        SELECT MAX(temp_id)
            FROM temp_record
            GROUP BY site_id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:24:51.270

我首选的方法是`row_number()`：

```
with toupdate as (
     select t.*,
            row_number() over (partition by site_id order by temp_id desc) as seqnum
     from t
)
update t
    set . . .
    where seqnum = 1 
```

我不填写详细信息。只是给你另一种方法。

# java - 有没有办法在 Android 中设置对加密数据的随机访问？

> ID：14095335
> 
> 赞同：2
> 
> 时间：2012-12-30T22:29:47.210
> 
> 标签：java, android, encryption, random-access

我目前正在尝试为存储在 Android 设备上的文件提供透明的加密/解密层。我需要随机访问这些文件中的每一个（搜索算法所必需的）。该层需要为程序的其余部分提供 RandomAccessFile 或 FileChannel。

我对加密的（非常）基本理解表明，某些密码模式（如 ECB、CTR、XEX 和 XTR）可以促进随机访问，但我宁愿在重新发明轮子之前使用其他人的工具。最好将加密留给专家。

一个理想的解决方案是我可以使用 Java 库访问的加密磁盘映像，但我还没有找到可以用于 Android 的任何东西。

有没有办法让我提供对加密文件的随机访问？这感觉就像很多人在他们的应用程序中想要的东西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:57:48.070

随机读取访问很容易：使用 CTR，但请确保您使用正确的密钥和随机数。随机写访问*可能*同样简单，尽管使用 CTR，如果您更改任何块，您会及时泄漏信息。因此，如果攻击者只是获得一个文件的单一视图，那么您就可以了，否则您会直接泄露有关纯文本的信息。

你有一个特定的使用场景。如果有任何库可以为您执行此操作，我还没有看到它们。此外，密钥管理通常也是特定于应用程序的。恐怕您将不得不处理威胁情景。

ECB 不应用于字符串或文件等相关信息。XEX（或 XTS）通常在 Java 加密库（例如 Oracle JCE 或 Bouncy）中不可用。

# php - 出于安全原因，Codeigniter escapeshellarg() 已被禁用

> ID：14095339
> 
> 赞同：2
> 
> 时间：2012-12-30T22:30:34.003
> 
> 标签：php, codeigniter

有没有办法重写codeigniter的Upload.php库，因为我一直面临

> 出于安全原因，escapeshellarg() 已被禁用

我已经在[这个线程](https://stackoverflow.com/questions/10384336/escapeshellarg-has-been-disabled-for-security-reasons)中尝试了将@放在escapeshellarg前面的解决方案，但仍然无法上传我的图像，那就是忽略警告。

我试图联系我的托管服务的管理员，但出于安全原因，他们无法启用它。

我能做些什么来欺骗这个，所以我可以上传图片吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T22:53:53.187

您可以自己制作`escapeshellarg`，这是一个非常简单的函数，它只转义给定字符串中的任何单引号，然后在其周围添加单引号。

```
function my_escapeshellarg($input)
{
  $input = str_replace('\'', '\\\'', $input);

  return '\''.$input.'\'';
} 
```

但是，如果您的提供商禁用了其他`Upload.php`需要的功能，那么您最终可能会不走运。

`.php`您可以通过创建一个包含调用的简单文件来查找哪些功能被禁用`phpinfo()`。（`disable_functions`在生成的输出中搜索）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-02T13:43:08.217

尝试在 system/libraries/Upload.php 文件中用@escapeshellarg 替换escapeshellarg。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:43:49.617

这与 CI 没有任何关系。该功能已在`php.ini`文件中禁用。禁用各种不安全的功能是很常见的（从服务器管理员的角度来看）。

如果您使用的是共享主机，那么您可能无能为力。尝试询问您的提供商。

如果您可以编辑`php.ini`然后打开它，找到该`disable_functions`字段，然后`escapeshellarg`从列表中删除。然后重新启动服务器。那应该启用该功能。

如果您仍然有问题，请询问您的提供商是否可以上传内容。我的意思是，如果您的提供商故意删除了所有上传功能，那么您将浪费时间寻找一种方法来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-03T09:07:59.193

**转到系统/库/Upload.php**

更换

> 带有@escapeshellarg 的escapeshellarg

```
if (DIRECTORY_SEPARATOR !== '\\') 
{ $cmd = 'file --brief --mime ' . @escapeshellarg ($file['tmp_name']) . ' 2>&1'; 
```

# xslt - 在 Xpath 表达式中伪造变量

> ID：14095340
> 
> 赞同：1
> 
> 时间：2012-12-30T22:30:34.627
> 
> 标签：xslt, xslt-1.0

在直接的 XSLT 1.0 中，不可能将字符串变量用作 XPath 表达式。

但是如果可能的表达式都很简单，比如“/book/chapter/verse”或“/year/make/model/style”——只有子轴，只有元素节点，没有谓词——是否有可能构建一个键该路径的关键字符串在哪里？就像是

```
<xsl:key name="elementByPath" match="*" use="path()" /> 
```

如果是这样，那么你可以

```
select=key(elementByPath, $var) 
```

其中 $var 可以是像“/book/chapter/verse”这样的字符串。

但是直接的 XSLT 1.0 没有 path() 函数。:(

很容易找到一条路径

```
 <xsl:for-each select="ancestor-or-self::*">
      <xsl:text>/</xsl:text>
      <xsl:value-of select="name()"/>
 </xsl:for-each> 
```

但这不能在@use 中使用。:(

当可能的表达式（尽管很多）很简单时，是否有另一种方法可以通过变量 XPath 表达式选择元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:26:48.277

或者如何**递归解析字符串 brute-force**：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
version="1.0">
<xsl:output omit-xml-declaration="yes" indent="yes"/>

<xsl:param name="pPath1" select="'books/book/title'"/>
<xsl:param name="pPath2" select="'books/book/description'"/>

<xsl:template match="/">
    <xsl:call-template name="elementsByPath">
        <xsl:with-param name="path" select="$pPath1" />
    </xsl:call-template>
    <xsl:text>==========&#xA;</xsl:text>
    <xsl:call-template name="elementsByPath">
        <xsl:with-param name="path" select="$pPath2" />
    </xsl:call-template>        
</xsl:template>

<xsl:template name="elementsByPath"> 
    <xsl:param name="path" />
    <xsl:choose>
        <xsl:when test="contains($path,'/')">
            <xsl:for-each select="*[name()=substring-before($path,'/')]"> 
                <xsl:call-template name="elementsByPath">
                    <xsl:with-param name="path" select="substring-after($path,'/')" />
                </xsl:call-template>
            </xsl:for-each>
        </xsl:when>
        <xsl:otherwise>
            <xsl:apply-templates select="*[name()=$path]" />
        </xsl:otherwise>
    </xsl:choose>
</xsl:template>

<xsl:template match="*">
    <xsl:copy-of select="." /><xsl:text>&#xA;</xsl:text>

</xsl:template>

</xsl:stylesheet> 
```

当将该转换应用于 Dimitre 的示例 XML 时，将**获得正确的结果**：

```
<title>Extending Flash MX 2004</title>
<title>Java Software Solutions</title>
==========
<description>
        Using javascript alongwith actionscript 3.0 and mxml.
    </description>
<description>
        Complete book full of case studies on business solutions and design concepts while building mission critical
        business applications.
    </description> 
```

我认为那会奏效。. .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:04:13.790

**可以做点什么**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:param name="pPath1" select="'/books/book/title'"/>
 <xsl:param name="pPath2" select="'/books/book/description'"/>

 <xsl:key name="kElemByPath" match="*"
  use="concat('/', name(ancestor-or-self::*[last()])
             ,'/', name(ancestor-or-self::*[last()-1])
             ,'/', name(ancestor-or-self::*[last()-2])
             )"/>

 <xsl:template match="/">
   <xsl:copy-of select="key('kElemByPath', $pPath1)"/>
==========&#xA;<xsl:text/>
   <xsl:copy-of select="key('kElemByPath', $pPath2)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<books>
    <book isbn="1590593049">
        <title>Extending Flash MX 2004</title>
        <description>
        Using javascript alongwith actionscript 3.0 and mxml.</description>
    </book>
    <book isbn="0132149184">
        <title>Java Software Solutions</title>
        <description>
            Complete book full of case studies on business solutions and design concepts while building mission critical
            business applications.
        </description>
    </book>
</books> 
```

**产生了想要的正确结果：**

```
<title>Extending Flash MX 2004</title>
<title>Java Software Solutions</title>
==========
<description>
        Using javascript alongwith actionscript 3.0 and mxml.</description>
<description>
            Complete book full of case studies on business solutions and design concepts while building mission critical
            business applications.
        </description> 
```

**如果您知道“路径”中的最大定位步骤数，则可以定义类似于此示例的键**。位置步数较少的表达式必须以必要数量的斜杠结尾。

# android - LinearLayout 的内容没有想要的宽度

> ID：14095342
> 
> 赞同：0
> 
> 时间：2012-12-30T22:30:37.470
> 
> 标签：android, xml, android-linearlayout, android-xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/hintergrund"
 >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/display"
    android:orientation="vertical"
     >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:maxLines="1"          
        />

    <Button 
        android:layout_width="fill_parent"
        android:text="bla"
        android:layout_height="wrap_content"
        />

    <TextView 
        android:id="@+id/ergebnis"
        android:layout_width="match_parent"
        android:layout_height="match_parent"

        />

</LinearLayout>

</LinearLayout> 
```

您好，我是 Android 开发新手，尤其是 XML。

我希望 EditText 和 Button 填充屏幕宽度，但是在模拟器上方运行代码时显示它们居中但仅填充了大约一半的屏幕宽度。我该如何改变它，我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:07:18.077

这应该有效：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:backgroun="@drawable/hintergrund"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/display"
        android:orientation="vertical" >

        <EditText
            android:id="@+id/editText1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:maxLines="1" />

        <Button
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="bla" />

        <TextView
            android:id="@+id/ergebnis"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" />
    </LinearLayout>

</LinearLayout> 
```

告诉我进展如何。

# c - libusb 数据输出

> ID：14095343
> 
> 赞同：0
> 
> 时间：2012-12-30T22:30:44.533
> 
> 标签：c, usb, libusb

我试图通过使用输出数据`libusb_interrupt_transfer`，函数返回`0`，但是，我看不到来自 Wireshark 的任何数据传输输出（在 USB 嗅探模式下），并且设备没有响应应该输出的数据。返回值是否`0`表示数据是从usb口发出来的？如果是这样，我是否`libusb_interrupt_transfer`在我的代码上使用了错误的函数？

这是我的代码（我在 ubuntu 12.10 - Linux ubuntu 3.5.0-21-generic #32-Ubuntu SMP Tue Dec 11 18:52:46 UTC 2012 i686 i686 i686 GNU/Linux 上运行代码）

```
#include <stdio.h> //printf, etc.
#include <sys/types.h>
#include <unistd.h>
#include <libusb.h> //libusb functions
#include <inttypes.h> //unit16t
#include <unistd.h> //sleep function
#include <stdlib.h> //exit()

const uint16_t VENDOR = 6069; /* = 0x17b5 */
const uint16_t PRODUCT = 32;  /* = 0x0020 */
const int CONFIGURATION_VALUE = 1;

int msgsend(unsigned char data[64]) {
    libusb_device **devs; //pointer to pointer of device, used to retrieve a list of devices
    libusb_context *ctx = NULL; //a libusb session

    int r; //for return values
    ssize_t cnt; //holding number of devices in list

    r = libusb_init(&ctx); //initialize a library session
    if (r < 0){
        exit(1);}
    libusb_set_debug(ctx, 3);//set verbosity level to 3

    cnt = libusb_get_device_list(ctx, &devs);
    if (cnt < 0)
        return (int) cnt;

    libusb_device_handle *handle;
    handle = libusb_open_device_with_vid_pid(ctx, VENDOR, PRODUCT);

    if (handle==NULL) {
        fprintf(stderr, "No logging system found.\n");
        libusb_free_device_list(devs, 1);
        libusb_exit(NULL);
        exit(1);
    }
    libusb_device *device = libusb_get_device(handle);

    struct libusb_config_descriptor *config = NULL;
    int err = libusb_get_config_descriptor_by_value(device, CONFIGURATION_VALUE, &config);

    if (err != LIBUSB_SUCCESS){
        printf("libusb_get_config_descriptor_by_value error\n");
        exit(1);
    }
    if(config->bNumInterfaces == 1){
        if(config->interface[0].num_altsetting ==1){
            if(config->interface[0].altsetting[0].bNumEndpoints == 2) {

                libusb_free_config_descriptor(config);

                err = libusb_kernel_driver_active(handle, 0);
                if (err >= LIBUSB_SUCCESS) {
                    if (err == 1) {
                        printf("Kernel driver is active, trying to detach\n");
                        err = libusb_detach_kernel_driver(handle, 0);
                        if (err != LIBUSB_SUCCESS) {
                                printf("Error detaching interface from kernel: libusb_error_string(err)\n");
                        }
                    }

                    err = libusb_set_configuration(handle, CONFIGURATION_VALUE);
                    if (err == LIBUSB_SUCCESS) {
                        err = libusb_claim_interface(handle, 0);
                        if (err == LIBUSB_SUCCESS) {
                            err = libusb_set_interface_alt_setting(handle, 0, 0);
                            if (err == LIBUSB_SUCCESS) {

                                unsigned char ENDPOINT_OUTPUT = 0x02;
                                unsigned char ENDPOINT_INPUT = 0x81;
                                int actual_length;
                                int return_value = 0;

                                return_value = libusb_interrupt_transfer(handle, ENDPOINT_OUTPUT, data, sizeof(data), &actual_length, 0);

                                if (return_value == 0){
                                        printf("msg was sent successfully! return_value=%d\n",return_value);
                                    }else {
                                        printf("return_value=%d, something went wrong",return_value);
                                        perror( "libusb_submit_transfer\n" );
                                    }

                                }
                            }else{
                                    printf("cannot claim the interface\n");
                                    exit(1);
                                }

                           }
                        }
                    }

                }
            }
    libusb_free_device_list(devs, 1); //free the list, unref the devices in it

    r = libusb_release_interface(handle, 0);
    libusb_close(handle); //close the device we opened
    libusb_exit(ctx);//needs to be called to end the

    return 0;
}

int main(){
     unsigned char data[64]={0x12, 0x01,0x00,0x03,0x00,0x00,0xFF,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

     unsigned char data2[64]={0x12, 0x02,0x00,0x03,0x00,0x00,0xFF,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

     unsigned int seqnum = 0x01;

     while(1){
         data[1] = seqnum;
         printf("max light is set\n");
         msgsend(data);
         if(seqnum == 0xff){
             seqnum = 0;
         }else{
             seqnum++;
         }
         sleep(2);

         data2[1] = seqnum;
         printf("min light is set\n");
         msgsend(data2);
         if(seqnum == 0xff){
             seqnum = 0;
         }else{
             seqnum++;
         }
         sleep(2);
     }

    return 0;
} 
```

# c# - C# - 将变量编译为名称/代码

> ID：14095344
> 
> 赞同：1
> 
> 时间：2012-12-30T22:30:48.020
> 
> 标签：c#, variables, compilation

由于我在上一个问题中无法很好地解释并且我没有得到一个可以让我满意的答案，所以我决定开一个新的。
直截了当，我基本上想要做的是编译一个变量（它持有的值）作为代码的一部分（特别是在我的情况下引用另一个变量）
假设我有：

```
int var_1, var_2, var_3 ... var_10;
for (int i = 1; i <= 10; i++)
{
    var_%i%=20; //if i is 1, then var_1's value will be set to 20, if i is 2, then var_2's value will be set to 20\. So basically this loop sets the value of var_1 .. var_10 to 20
} 
```

如果在任何情况下后者不清楚，我可以用更简单的方式解释。

```
int var_5;
int SomeOtherVar = 5;
var_%SomeOtherVar% = 10; // so var_5 (where 5 is the value of SomeOtherVar) is set to 10 
```

这是可行的，如果可行，方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T22:35:04.543

不，你不能那样做，你为什么不使用数组？

```
 int[]  array = new int[3];

    for (int i = 0; i < array.Length; ++i)
    {
        array[i] = 20;
    } 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:33:36.053

这是不可行的。请改用数组。类型是`int[]`，但我建议您阅读有关数组的教程以了解如何创建和使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:43:08.493

我想不出你需要这样做的情况。如果您希望针对连续的数字列表存储值，请使用数组。否则，您可以使用字典。例如，要在您的问题中存储 "var1" = 20, "var2" = 20 ，您可以这样做：

```
Dictionary<string, int> dict = new Dictionary<string, int>();

for (int i = 1; i <= 10; i++)
{
    dict.Add("var" + i.ToString(), 20);
} 
```

一些使用示例：

```
dict["var1"]              // 20
dict["var2"]              // 20
dict.ContainsKey("var3")  // true
dict.ContainsKey("var99") // false 
```

注意：我将字符串“var”与循环中的 int 连接只是为了演示您可以使用任意字符串作为键来存储/查找值。在这种情况下，这样做有点奇怪，您可能最好坚持使用普通数组，但我的示例显示了字典如何使用更复杂的键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T06:28:05.160

如果你想绕过静态类型检查并且你想创造一些编码恐惧，你可以使用[ExpandoObject](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx)结合`dynamic`关键字。不会让您在范围内设置变量，但从技术上讲，您可以声明自己的变量。请注意，在我的示例中，我将其转换为，`IDictionary<string, object>`因为我在运行时从字符串创建其成员的名称。以下方法所做的是创建 20 个成员并将它们的值从 0 分配到 19。

```
static dynamic SetVariables(IEnumerable<int> range)
{
    const string variableName = "var_";
    var expandoDictionary = new ExpandoObject() as IDictionary<string, object>;
    foreach (var i in range)
        expandoDictionary[variableName + i] = i;
    return expandoDictionary;
} 
```

然后，您可以通过以下方式轻松访问成员：

```
var container = SetVariables(Enumerable.Range(0, 20));
var value13 = container.var_13; 
```

请注意，我**不**`dynamic`推荐这种用法，我会尽可能远离。但是，为了解决问题，这可以看作是一种不安全但部分的解决方案。

# php - 数组值到字符串

> ID：14095345
> 
> 赞同：0
> 
> 时间：2012-12-30T22:31:00.540
> 
> 标签：php

我一直在搜索和搜索，找不到任何有效的方法，但这就是我想要做的。

这段代码：

```
try{
$timeout = 2;
$scraper = new udptscraper($timeout);
$ret = $scraper->scrape('udp://tracker.openbittorrent.com:80',array('0D7EA7F06E07F56780D733F18F46DDBB826DCB65'));
print_r($ret);
}catch(ScraperException $e){
echo('Error: ' . $e->getMessage() . "<br />\n");
echo('Connection error: ' . ($e->isConnectionError() ? 'yes' : 'no') . "<br />\n");
} 
```

输出这个：

```
Array ( [0D7EA7F06E07F56780D733F18F46DDBB826DCB65] => Array ( [seeders] => 148 [completed] => 10 [leechers] => 20 [infohash] => 0D7EA7F06E07F56780D733F18F46DDBB826DCB65 ) ) 
```

我希望播种机计入一个字符串，例如 $seeds。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:35:04.533

像这样的东西？

```
$seeds = $ret['0D7EA7F06E07F56780D733F18F46DDBB826DCB65']['seeders']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:35:24.297

您可以用户`strval()`将数字转换为字符串。

`$string = strval($number);`

或者您可以将其转换为字符串：

`$string = (string)$number;`

在您的上下文中，这将是：

`$string = strval($ret['0D7EA7F06E07F56780D733F18F46DDBB826DCB65']['seeders']);`

然而，这个奇怪的字符串也是数组的第一个索引，所以你也可以这样做：

`$string = strval($ret[0]['seeders']);`

或者如果您只想使用索引（“播种机”也是第二个数组的第一个索引）：

`$string = strval($ret[0][0]);`

如果您只想要数字，那么它也很容易：

`$num = $ret[0][0];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:49:28.057

目前尚不清楚您是否希望将数组值分配为单独的变量或只是将其转换为字符串。这是完成所有上述选项的好方法，通过将每个数组键分配为具有匹配数组值的单独变量：

```
$ret_vars = array_pop($ret);
foreach ($ret_vars as $variable_name=>$variable_value) :
    ${$variable_name} = (string)$variable_value;
endforeach; 
```

在您的原始示例中，这将最终填充`$seeders`,`$completed`和`$leechers`与其`$infohash`匹配的字符串值。当然，请确保在代码的其他地方不使用/不需要这些变量名称。如果是这种情况，只需在构造中添加某种唯一前缀`${}`，例如`${'ret_'.$variable_name}`

# javascript - Node.js 公共静态文件夹，用于为 js 提供 utf-8 字符集

> ID：14095347
> 
> 赞同：1
> 
> 时间：2012-12-30T22:31:15.157
> 
> 标签：javascript, jquery, node.js, utf-8, express

我正在使用 node.js 和 express 将静态 JavaScript 文件提供给单页应用程序。在 node.js 服务器代码中，我使用 express.static 来允许公共访问文件夹

```
app.use(express.static(__dirname + '/public/')); 
```

在客户端，我使用`$.getScript`获取存储在 public 文件夹中的 JavaScript 文件，例如：

```
$.getScript("js/init.js"); 
```

当我尝试获取一些带有重音字母或一些 UTF-8 特殊字符的 JavaScript 文件时，我得到了奇怪的字符，而不是我想要的。

当我定义公用文件夹时，有什么方法可以设置字符集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-10T23:48:51.047

[使用 node.js 提供静态文件的最简单方法是什么](https://stackoverflow.com/questions/14576644/whats-the-simplest-way-to-serve-static-files-using-node-js#14576675)？给了我在静态之前插入你自己的中间件的提示。

下面的代码查找`*.js`文件并将字符集设置为 utf-8。

```
app.use(function(req, res, next) {
  if (/.*\.js/.test(req.path)) {
    res.charset = "utf-8";
  }
  next();
});
app.use(express.static(__dirname + '/public/')); 
```

完成此操作后，查找以下响应标头。

```
Content-Type: application/javascript; charset=utf-8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:10:27.197

在您的 html 页面中，必须有与资源文件的编码相同的编码（或相反）

确保在 head 部分设置元标记：

```
<meta charset='utf-8'></meta> 
```

# php - 在数据库列表视图中使用 href 的 PHP 语法错误

> ID：14095363
> 
> 赞同：0
> 
> 时间：2012-12-30T22:32:39.993
> 
> 标签：php, mysql, syntax, href

我认为这很容易解决，因为看起来我的语法是这里的问题。我已经搜索了其他更简单的 stackoverflow 问题，但似乎无法解决这个问题。

我收到一个 `Parse error: syntax error, unexpected T_STRING, expecting ',' or ';' in C:\wamp\www\Active\Formula One\admin\list_products.php` 错误。

我正在对我的数据库中的项目进行简单的列表视图，并可以选择通过使用 ID 来编辑它们。尝试将`<a href>`标记添加到表中，但无法找出正确的语法来添加它。

我试图包含的链接是 `<td><a href=" ../admin/admin.master.php?page=blog/edit_post.php&id=' . $row['id'] . '">Edit</a> </td>`

表是这样显示的；

```
echo "<tr>
<td>" . $row['id'] . "</td>
<td>" . $row['prod_id'] . "</td>
<td>" . $row['prod_sub_id'] . "</td>
<td>" . $row['name'] . "</td>
<td>" . $row['description'] . "</td>
<td>" . $row['price'] . "</td>
<td>" . $row['sale'] . "</td>
<td>" . $row['picture'] . "</td>
<td><a href=" ../admin/admin.master.php?page=blog/edit_post.php&id=' . $row['id'] . '">Edit</a> </td>
</tr>"; 
```

感谢您的帮助，对不起，这是一个如此简单的问题，但我一直试图解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:35:20.820

您必须转义双引号

```
<td><a href=\" ../admin/admin.master.php?page=blog/edit_post.php&id=" . $row['id'] . "\">Edit</a> </td> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T22:46:29.337

它不会直接回答您的问题，但您确实应该避免打印 HTML 标签。PHP 替代控制结构专门用于解决此类问题。

因此，您应该将 HTML 标记与 PHP 分离。

```
<table>

<!-- This is just an example, you shouldn't use mysql_* functions anymore -->
<!-- Use PDO or MySQLi instead -->
<?php while($row = mysql_fetch_assoc($resourse)) :?>

<tr>
  <td><?php echo $row['id'] ?></td>
  <td><?php echo $row['prod_id']; ?></td>
  <td><?php echo $row['prod_sub_id'];?> </td>
  <td><?php echo $row['name']; ?></td>
  <td><?php echo $row['description']; ?></td>
  <td><?php echo $row['price']; ?></td>
  <td><?php echo $row['sale']; ?></td>
  <td><?php echo $row['picture'];?></td>
  <td><a href="<?php printf('../admin/admin.master.php?page=blog/edit_post.php&id=', $row['id']);?> ">Edit</a> </td>

</tr>

<?php endwhile; ?>

</table> 
```

结论：

1.  这将使代码清晰易读
2.  易于维护
3.  让您有信心不会出现这样的语法错误（通常）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T22:42:49.757

问题似乎是 php 没有意识到`<a href="`is 用于链接，而是将双引号翻译为字符串的结尾，结果它给你一个错误。

更改这行代码：

```
 "</td>
<td><a href=" ../admin/admin.master.php?page=blog/edit_post.php&id=' . $row['id'] . '">Edit</a> </td>
</tr>"; 
```

对此：

```
'</td> // this needs a single quote in the beginning (not a double quoute)
<td><a href=" ../admin/admin.master.php?page=blog/edit_post.php&id=' . $row['id'] . '">Edit</a> </td>
</tr>'; // this also needs a single quote 
```

如您所见，您以双引号开头，并以单引号结尾，这使 php 感到困惑。

如果您需要更多帮助，请告诉我们

# java - Java 错误：无法从对象数组中找到符号

> ID：14095366
> 
> 赞同：1
> 
> 时间：2012-12-30T22:33:00.463
> 
> 标签：java, arrays, object, constructor

我环顾四周，试图通过重新编译我的其他类等来解决这个问题，但似乎没有任何效果。

我有两个文件，在 SensorDataDisplay.java 我有以下代码：

```
private SensorSim[] sensors;

...

public void runSimulation(double numberOfSensors)  {
  sensors = new SensorSim[numOfSensors];
  int i = 0;

  for(i = 0; i<numOfSensors; i++) {
    sensors[i].SensorSim(sensorNom, sensorErr);
  }
} 
```

然后在同一个目录中，我将 SensorSim.java 编译成 SensorSim.class，构造函数如下。

```
public SensorSim(double n, double d) {
    if (probs == null)
      loadData();
    nominal = n; sd = d;
    rng = new Random();
    running = true;
} 
```

当我刚刚创建一个 sensorSim 时，这是可行的。我最近添加了 sensorSims 数组，这是我收到此错误的时候：

```
$ javac SensorDataDisplay.java

SensorDataDisplay.java:44: cannot find symbol
symbol  : method SensorSim(double,double)
location: class SensorSim
      sensors[i].SensorSim(sensorNom, sensorErr);
            ^
1 error 
```

环顾四周，我发现它可能与较旧的类文件有关，因此我删除并重新编译了其他文件（SensorSim.class）。我读到的另一个可能的原因是与范围有关，但对我来说看起来不错，但是我是 Java 新手。为什么可能会发生此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:36:09.207

`SensorSim(double, double)`您尝试运行在`SensorSim`实例 ( ) 上调用的方法，`sensors[i]`此时该实例甚至不存在。

如果您的意思是`SensorSim`在每个数组元素上创建一个实例，

```
sensors[i].SensorSim(sensorNom, sensorErr); 
```

应该变成：

```
sensors[i] = new SensorSim(sensorNom, sensorErr); 
```

更重要的是，您的`runSimulation()`方法将 a`double`作为参数并使用它来调整数组 ( `sensors = new SensorSim[numOfSensors];`) 的大小：这`double`将“向下转换”为 a `int`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:34:31.000

您正在尝试调用这样的*构造函数*：

```
sensors[i].SensorSim(sensorNom, sensorErr); 
```

这不是你的做法。我怀疑你想要：

```
sensors[i] = new SensorSim(sensorNom, sensorErr); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T22:35:13.887

代替

```
sensors[i].SensorSim(sensorNom, sensorErr); 
```

和

```
sensors[i] = new SensorSim(sensorNom, sensorErr); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T22:37:12.783

由于这行代码，您会收到错误消息：

```
sensors[i].SensorSim(sensorNom, sensorErr); 
```

这将起作用，而不是：

```
sensors[i] = new SensorSim(sensorNom, sensorErr); 
```

请记住，sensors[i] 就像拥有例如

```
SensorSim s; 
s = new SensorSim(sensorNom, sensorErr); 
```

# f# - 生命游戏的递归函数不会在异步中运行

> ID：14095369
> 
> 赞同：2
> 
> 时间：2012-12-30T22:33:19.963
> 
> 标签：f#

我正在尝试运行一个函数来更新用 f# 编写的生命游戏函数的网格，并且所有内容都必须是递归的，没有可变的。我想通过异步运行更新函数来向我的表单添加一个暂停按钮，但是当我这样做时，只有一个正方形被更新。但是，当我在没有异步的情况下单步执行程序时，所有方块都会更新。任何想法为什么？

```
let buttonGrid : Button list list = (Startup ar);;

//transform buttongrid to int grid
let rec bg2ig (bg:Button list list) = 
    let rec innerLoop (bl:Button list) =
        match bl with
        |[] -> []
        |x::xs -> if (x.Name = "0") then 0::(innerLoop xs) else 1::(innerLoop xs)
    match bg with
    |[] -> []
    |y::ys -> (innerLoop y)::(bg2ig ys)

let Update (bg:Button list list)=
    let ar = (bg2ig bg)
    let rec innerUpdate (bg:Button list list)= 
        let rec arrayLoop (bl:Button list) y = 
            match bl with
            |[] -> 0
            |x::xs -> 
                let X = (15-xs.Length)
                let n = (neighbors X y ar)
                if  (ar.[X].[y] = 0) then (if n=3 then buttonGrid.[X].[y].Name<-"1") else (if (n=2||n=3)=false then buttonGrid.[X].[y].Name<-"0")
                if buttonGrid.[15-xs.Length].[y].Name="0" 
                then buttonGrid.[15-xs.Length].[y].BackColor <- Color.White 
                else buttonGrid.[15-xs.Length].[y].BackColor <- Color.Black
                arrayLoop xs y
        match bg with
        |[] -> []
        |y::ys -> 
            ignore (arrayLoop y (15-ys.Length)) 
            innerUpdate ys
    innerUpdate bg

let Running = async {
    let rec SubRun (x:int) =
        ignore (Update buttonGrid)
        if x = 1 then
            SubRun 1
        else
            0
    ignore (SubRun 1)
    do! Async.Sleep(1000)
    }

let RunAll() = 
    Running
    |> Async.RunSynchronously
    |> ignore 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:51:47.767

如评论中所述，`Async.RunSynchronously`对于这种情况，这是一个错误的功能。它在后台线程上启动工作流（这是错误的，因为您想访问 GUI 元素），然后它阻塞调用线程，直到后台工作完成（这是错误的，因为您不想阻塞 GUI 线程）。

您需要使用`Async.StartImmediate`which 在*当前线程*（将是 GUI 线程）上启动工作而不会阻塞。当工作流的第一部分完成时（之前`Sleep`），GUI 线程可以自由地做其他工作。之后`Sleep`工作流程将再次在 GUI 线程上继续（这是自动完成的`StartImmediate`），因此您可以再次访问 GUI。

另外，`SubRun`执行实际循环的函数也需要是异步的 - 所以我希望循环的主要部分看起来像这样：

```
let Running = async {
    let rec SubRun (x:int) = 
        // Perform update and then sleep before recursive call
        ignore (Update buttonGrid)
        do! Async.Sleep(1000)
        if x = 1 then
            return! SubRun 1
        else
            return 0 }

    // Start the loop and asynchronously ignore the result
    SubRun 1 |> Async.Ignore

let RunAll() = 
    // Start the computation immediately on the current threada
    Running |> Async.StartImmediate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T18:01:19.137

Tomas Petricek 解决了我最初遇到的问题，但为了使事情正确，我最终以不同的方式解决了它。我认为我最初的问题可能源于错误地更新表格或根本没有更新表格，因此看起来非常错误。

我最终像这样编写了我的异步函数

```
let rec async1(syncContext, form : System.Windows.Forms.Form, cancellationSource:CancellationTokenSource, (limit:int)) =
    async {
        do! Async.SwitchToContext(syncContext)
        ignore (Update buttonGrid)

        do! Async.SwitchToThreadPool()

        do! Async.Sleep(300)
        if limit > 1 then
            ignore (Async.Start (async1(syncContext, form, cancellationSource, (limit-1)),cancellationSource.Token))
        else if limit = -1 then
            ignore (Async.Start (async1(syncContext, form, cancellationSource, limit),cancellationSource.Token))
    } 
```

然后我可以像这样用开始和停止按钮调用它

```
let b = new Button(Location=new Point(50,500), Text=("Run"), Width=100, Height=40)
let btnPause = new Button(Location=new Point(150, 500), Text="Stop", Width=100, Height=40, Enabled=false)
b.Click.Add(fun _ -> 
    let cancellationSource = new CancellationTokenSource()
    b.Enabled <- false
    btnPause.Enabled <- true
    btnSave.Enabled <- false
    btnLoad.Enabled <- false
    btnStep.Enabled <- false
    inputBox.Enabled <- false
    btnPause.Click.Add(fun _ -> 
        b.Enabled <- true
        btnPause.Enabled <- false
        btnSave.Enabled <- true
        btnLoad.Enabled <- true
        btnStep.Enabled <- true
        inputBox.Enabled <- true
        cancellationSource.Cancel())
    ignore (Async.Start (async1(syncContext, form, cancellationSource, (int inputBox.Text)),cancellationSource.Token))
    ignore (inputBox.Text <- "0")) 
```

我还添加了一个用于单步执行程序的步骤按钮和一个输入框，我可以在其中无休止地运行程序，直到调用取消令牌或让它运行 n 次然后停止

# vim - Sublime Text 2 中的高级“查找”

> ID：14095376
> 
> 赞同：1
> 
> 时间：2012-12-30T22:33:47.527
> 
> 标签：vim, sublimetext2

我喜欢[vim 的高级查找功能，](http://www.rayninfo.co.uk/vimtips.html)例如：

`/joe/s-2`它将光标设置为“匹配开始负 2”

有没有办法在 Sublime Text 2 中使用本机功能或现有插件来实现这一点？

我知道[Vintage Mode](http://www.sublimetext.com/docs/2/vintage.html)和[VintageEx](https://github.com/SublimeText/VintageEx)，后者为您提供命令行 vim，但如果`/joe/s-2`尝试返回“No Range Allowed”错误。

# actionscript-3 - Actionscript 3 - ESC 使应用程序退出全屏模式

> ID：14095377
> 
> 赞同：0
> 
> 时间：2012-12-30T22:33:48.120
> 
> 标签：actionscript-3, flash

那么，我该如何做到这一点，以便当我收到我的应用程序时`StageDisplayState.FULL_SCREEN`，它不会`StageDisplayState.NORMAL`在按 esc 时成功？就像我想制作一个电影内弹出菜单，它出现在 esc 上，其中包括退出和全屏等所有选项 - 设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T18:36:55.213

如果您正在制作基于 Web 的 swf，则无法阻止退出键退出全屏模式，因为与**无法**离开全屏电影相关的安全问题。但是，如果您正在制作 AIR 应用程序，那么可能会有一些我不确定的解决方法。

[更深入的解释](http://www.actionscript.org/forums/showthread.php3?t=226558)

# jquery - 在 Joomla 3.0 中使用 JFactory::getDocument 和 jQuery

> ID：14095378
> 
> 赞同：-4
> 
> 时间：2012-12-30T22:33:50.510
> 
> 标签：jquery, joomla

我有一些代码可以插入到我的 Joomla 3.0 页面中，可以正确调用 java。我正在尝试将 JFactory::getDocument 切换为我的 java 函数，因为它是 Joomla 原生的。

这是工作代码

```
<!DOCTYPE html>
 <html lang="en">
 <head>
   <meta charset="utf-8">
   <title>jQuery demo</title>
 </head>
 <body>
   <a href="http://jquery.com/">jQuery</a>
   <script src="media/jui/js/jquery.min.js"></script>
   <script>
     $(document).ready(function(){
       $("a").click(function(event){
         alert("As you can see, the link no longer took you to jquery.com");
         event.preventDefault();
       });
     });
   </script>
 </body>
 </html> 
```

这是我尝试过但不起作用的方法

```
<!DOCTYPE html>
 <html lang="en">
 <head>
   <meta charset="utf-8">
   <title>jQuery demo</title>
 </head>
 <body>
<?php
   JFactory::getDocument()->addScriptDeclaration('
(function($) {
     $(document).ready(function(){
       $("a").click(function(event){
         alert("As you can see, the link no longer took you to jquery.com");
         event.preventDefault();
       });
     });
 }) (jQuery);
');?>
 </body>
 </html> 
```

对此有任何帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:46:22.423

通常这会起作用

```
$document = &JFactory::getDocument();

$document->addScriptDeclaration('(function($) {
 $(document).ready(function(){
   $("a").click(function(event){
     alert("As you can see, the link no longer took you to jquery.com");
     event.preventDefault();
   });
 });
 }) (jQuery);
'); 
```

这将不起作用然后尝试将 JS 代码用于外部 Js 文件，然后包含使用以下代码。

```
$document->addScript("your script page full path"); 
```

希望对你有帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:45:46.793

尝试使用以下内容：

```
<?php
   $document = JFactory::getDocument();
    $js = '
       (function($) {
           $(document).ready(function(){
              $("a").click(function(event){
                 alert("As you can see, the link no longer took you to jquery.com");
                 event.preventDefault();
              });
           });
        })(jQuery);';
   $document->addScriptDeclaration($js);
?> 
```

希望这可以帮助

# css - CSS 960 填充页面

> ID：14095395
> 
> 赞同：1
> 
> 时间：2012-12-30T22:35:29.220
> 
> 标签：css, height, fill

我正在使用[http://960.gs/](http://960.gs/)并且我希望我的`container_12`班级填写页面。

编辑：只填充高度。

我试过：

```
.container_12{
    background-image:url(../images/background_2.png);
    background-position:center top;
    background-repeat:no-repeat;
    min-height:100%;
    height:auto;
} 
```

但什么也没发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:50:29.557

这仅仅是因为你想要一个大的背景图像吗？为什么不直接使用：

```
body {
  background-image:url(../images/background_2.png);
  background-position:center top;
  background-repeat:no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:52:27.747

这个`.container_12`类有一个固定的宽度（你猜对了，960px），所以它不会填满整个页面。您想设置其父元素的背景 - 这可以是`body`容器 div。

```
body {
    background-image:url(../images/background_2.png);
    background-position:center top;
    background-repeat:no-repeat;
} 
```

看看[这个演示页面](http://960.gs/demo.html)的风格-`.container_12`有粉红色/白色条形背景，它只占用 960 像素。占据整个页面的蓝色背景设置为`body`：

```
body {
  background: #123;
} 
```

* * *

要使`.container_12`页面占据整个高度，您需要将其**高度及其父元素的高度**设置为 100%；

```
html, body {
  height: 100%;
}
.container_12 {
  height: 100%;
  background-color:#ccc;
} 
```

为什么一定要指定父元素的高度？的高度`.container_12`是 100%，*是什么的*100% ？它是父元素。

# c - CUDA 是否需要考虑缓存抖动？

> ID：14095397
> 
> 赞同：2
> 
> 时间：2012-12-30T22:35:32.567
> 
> 标签：c, caching, memory, optimization, cuda

我不熟悉 GPU 内存缓存的工作原理，所以想知道与 CPU 相关的内存访问的时间和空间接近度的假设是否也适用于 GPU。也就是说，在 CUDA C 中编程，我是否需要考虑 C 的行优先数组存储格式以防止缓存抖动？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:48:20.413

是的，非常。

假设您正在为每个线程获取 4 个字节的整数。

## 方案一

每个线程都使用其线程 id 的索引获取一个整数。这意味着线程 0 正在获取 a[0]，线程 1 正在获取 a[1] 等等......与 GPU 一样，它将在 128 字节的缓存行中获取。巧合的是，warp 是 32 个线程，因此 32*4 = 128 个字节。这意味着对于一个扭曲，它将从内存中执行一个获取请求。

## 方案二

如果线程以总随机顺序获取索引之间的距离大于 128 字节。它必须发出 32 个 128 字节的内存请求。这意味着您将为每个 warp 填充 32 倍以上的内存的缓存，如果您的问题很大，您的缓存将比方案一多 32 次无效。

这意味着，如果您在场景一中请求通常驻留在缓存中的内存，那么在场景二中，它很可能必须通过来自全局内存的另一个内存请求来解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:52:40.453

不，是的。不，因为 GPU 不提供与 CPU 相同类型的“缓存”。

但是您还有许多其他限制，这使得底层 C 数组布局以及并发线程如何访问它对于性能非常重要。

您可以查看此页面以了解有关[CUDA 内存类型](http://www.cvg.ethz.ch/teaching/2011spring/gpgpu/cuda_memory.pdf)的基础知识，或[查看](http://supercomputingblog.com/cuda/cuda-memory-and-cache-architecture/)有关 Fermi GPU 缓存的更多详细信息。

# jquery - NetBeans 上的 Jquery 代码完成

> ID：14095399
> 
> 赞同：1
> 
> 时间：2012-12-30T22:35:34.097
> 
> 标签：jquery, netbeans, autocomplete

我试着到处寻找一种方法来让它工作，尽管即使在这里我也找不到一种工作方法来使 jquery 代码完成在 NetBeans 7.2.1 上工作。

如果有人能给我一个明确的方法来让它工作，我将不胜感激。

# graphics - 如何将 3d 形状数据投影到计算机图形中的 2d 屏幕上？

> ID：14095400
> 
> 赞同：0
> 
> 时间：2012-12-30T22:35:34.823
> 
> 标签：graphics, model, 3d, rendering, mesh

如果我错了，请纠正我，但我认为 3d 图形中的所有元素都是网格。

所以问题真的是，你如何获取网格数据并根据网格数据、相机位置、相机和网格的旋转等创建二维投影。

我意识到这相当复杂，只要知道它的技术术语是什么，我就会很满意，所以我可以搜索和研究它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:41:53.510

您可以在 Wikipedia 上阅读有关[3D 投影的信息。](http://en.wikipedia.org/wiki/3D_projection)

# c++ - 不允许成员函数重新声明

> ID：14095405
> 
> 赞同：3
> 
> 时间：2012-12-30T22:36:51.047
> 
> 标签：c++, compiler-errors

如果我在 mainwindow.cpp 中定义函数，则该函数可以工作，但是当我在 radiobuttons.cpp 中定义它并尝试从 mainwindow.cpp 调用它时，项目将无法编译。

**主窗口.h**

```
 #ifndef MAINWINDOW_H
    #define MAINWINDOW_H        
    #include <QMainWindow>

    namespace Ui {
    class MainWindow;
    }

    class MainWindow : public QMainWindow
    {
        Q_OBJECT

        public:
            explicit MainWindow(QWidget *parent = 0);

            void build_radios();  //this function

            ~MainWindow();

    };    
#endif // MAINWINDOW_H 
```

**单选按钮.cpp**

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

    void MainWindow::build_radios()
     {  

    //... some code

     } 
```

**主窗口.cpp**

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

void MainWindow::radio_buttons();   //error: C2761: 'void MainWindow::build_radios(void)' : member function redeclaration not allowed

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)

{

radio_buttons();

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T22:38:37.310

那不是定义，编译器将其视为类定义之外的成员函数的声明，这是非法的。只需删除该行。它本来就不应该在那里，它没有用。

事实上，为了保持一致性，将实际定义从 移动`radiobuttons.cpp`到`mainwindow.cpp`。为什么要`MainWindow`在不同的实现文件中声明一个成员？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T22:39:30.277

> 但是当我在 radiobuttons.cpp 中定义它时...

除了你没有**定义**而是重新**声明**它。（即使这也是多余的，因为您在该特定文件中包含了类的头文件。）错误消息几乎说明了问题所在：

> 不允许成员函数重新声明

当你声明`MainWindow`类时，你在`void build_radios();`里面有声明——它本身就足以声明方法。在 .cpp 文件中，仅实现它就足够了，即仅提供定义**-**您已经有一个声明，来自头文件中的类声明。

（实际上，您也有一个定义，但它在`radiobuttons.cpp`文件中 - 它应该在`mainwindow.cpp`. 将类的所有方法放入一个实现文件中，不要将它们分散在多个文件和类中......并且。 .. 和...）

# perl - 将哈希数组转换为 json

> ID：14095410
> 
> 赞同：4
> 
> 时间：2012-12-30T22:37:06.997
> 
> 标签：perl

我想转换我创建的哈希数组，如下所示：

```
while(...)
{
    ...
    push(@ranks, {id => $id, time => $time});
} 
```

到 JSON：

```
use JSON;
$j = new JSON;
print $j->encode_json({ranks => @ranks}); 
```

但它正在输出：

```
{"ranks":{"time":"3","id":"tiago"},
 "HASH(0x905bf70)":{"time":"10","id":"bla"}} 
```

如您所见，它无法写入哈希并且没有数组...

我想输出一个如下所示的 JSON 字符串：

```
 {"ranks":[{"time":"3","id":"tiago"},
           {"time":"40","id":"fhddhf"},
           {"time":"10","id":"bla"}]} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T23:04:16.743

所有这些都是一样的：

```
ranks => @ranks

'ranks', @ranks

'ranks', $ranks[0], $ranks[1], $ranks[2]

ranks => $ranks[0], $ranks[1] => $ranks[2] 
```

因此，当您打算使用一个元素创建散列时，您正在创建具有两个元素的散列。

您尝试使用数组作为哈希值，但哈希值只能是标量。然而，由于引用是标量，所以通常使用对数组的引用作为散列值，这是`encode_json`预期的。

```
print $j->encode_json( { ranks => @ranks } ); 
```

应该

```
print $j->encode_json( { ranks => \@ranks } ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T22:56:08.340

```
print $j->encode_json({ranks => @ranks}); 
```

应该：

```
print $j->encode_json({ranks => \@ranks}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T22:55:59.290

尝试将数组作为参考传递。

`to_json({ranks => \@ranks},{ascii => 1,pretty => 1});`

# scala - Embedded Jetty 9\. 创建一个 Scala servlet

> ID：14095411
> 
> 赞同：3
> 
> 时间：2012-12-30T22:37:09.633
> 
> 标签：scala, jetty, embedded-jetty

我正在寻找创建 Scala REST 服务的最快方法。理想情况下，我想从头开始构建，在使用框架之前学习交易技巧。

REST 服务应该提供从 MongoDB 数据库中提取的 JSON。网络似乎没有多大帮助，Martin Odersky 的关于 Scala 的书也没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:49:32.503

我不知道有什么教程或示例可以为您提供您想要的东西，但我对此并不感到惊讶。任何想要创建简单 REST 服务的人都会选择使用框架，而您不想这样做。通过选择从头开始自己构建一些东西，你选择了复杂性——正是框架存在的要消除的复杂性。

Java 也是如此——几乎没有人在 HttpServlet 之上创建原始 REST 服务，因为使用框架更有意义。

话虽如此，在 Scala 中创建“原始”REST 服务实际上与在 Java 中创建相同。所以找一个 Java/Maven 例子，做一些必要的工作，把它变成在 Scala 和 SBT 之上运行的东西。[这](http://www.eclipse.org/jetty/documentation/current/jetty-maven-helloworld.html#developing-standard-webapp-with-jetty-and-maven)将是一个很好的起点。

# excel - 检查特定行中单元格左侧的值

> ID：14095414
> 
> 赞同：1
> 
> 时间：2012-12-30T22:37:53.207
> 
> 标签：excel, worksheet-function

假设我们在第 1 行中有 2000 到 2010 年（A 到 K 列），在下面我们有许多行，其中包含其中一些年份的条目。对于包含数据的每一行，假设 L 列中有任意年份（2000 年到 2010 年之间）。有没有办法检查该行中任意年份的左侧是否有任何条目。

例如，假设第 5 行具有 2006、2007、2008、2009 和 2010 年的值。在 L 列中，假设任意年份是 2007 年。公式应检查第 5 行是否具有 2007 年之前的值。因为它确实有一个（它的值为 2006），它将返回 true。如果 L 行中的任意年份是 2005 年，那么它将返回 false（因为该行中只有 2006 年及以后的值）。

我尝试使用偏移量进行 Hlookup，但它似乎不起作用。

任何帮助都会很棒，如果您需要进一步说明，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:52:43.903

在复制下来的 M2 中试试这个公式

`=IF(COUNTA(A2:K2),INDEX(A$1:K$1,MATCH(1,INDEX((A2:K2<>"")+0,0),0))<L2)`

这应该适用于具有任何类型数据的任何版本的 Excel，具体取决于行中的特定数据类型（文本或数字）或 Excel 版本，可能有更短的公式可用

# actionscript-3 - 是什么导致 as3 代码生成 NaN 作为结果？

> ID：14095416
> 
> 赞同：0
> 
> 时间：2012-12-30T22:38:06.390
> 
> 标签：actionscript-3, nan

我有一些涉及我无法提前知道的任意角度线的碰撞检测。我已经设置了我的代码以将它们视为 y = mx + b 的形式，并且每当我创建一条水平线时，所有字段都会显示为 NaN。我的问题是：AS3 中的哪些操作会导致返回 NaN。我想到的是，一条完全垂直的线会有 Number.POSITIVE_INFINITY 的斜率，我想这可能会导致潜在的错误。它不应该在水平线上，但会发生逻辑问题。关键是，是什么导致在 AS3 中返回 NaN？

```
package {

    import flash.display.Sprite

    public class Line extends Sprite{

        var x1:Number, x2:Number, y1:Number, y2:Number;
        var m:Number, b:Number; //y = mx + b

    public function Line(x1C:Number, y1C:Number, x2C:Number, y2C:Number){
            x1 = x1C;
            x2 = x2C;
            y1 = y1C;
            y2 = y2C;
            if(x2 - x1 == 0)
                m = Number.POSITIVE_INFINITY;
            else if(y2 - y1 == 0)
                m = 0;
            else
                m = (y2 - y1) / (x2 - x1); //these calculations could be off....
            b = y1 - (m * x1);
            this.graphics.moveTo(x1, y1);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:46:17.433

如果您声明一个 Number 并且不分配值，它将是 NaN。

例如 ：

```
var speed:Number;
trace(speed); // NaN 
```

与默认为 0 的 int 不同；

```
var speed:int;
trace(speed); // 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:50:32.353

全局[isNan()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/package.html#isNaN%28%29)函数的文档给出了一些示例：

*   0 除以 0：`0/0`
*   负数的平方根：`Math.sqrt(-1)`
*   大于 1 或小于 0 的数的反正弦：`Math.asin(2)`
*   无法转换为 Number 的字符串`"5a"`：[解析时]

也`1 * someObject`或`1 + someUndefinedNumber`将评估为`NaN`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:05:37.260

*   您的代码可能会在`NaN`此处生成：

    ```
    b = y1 - (m * x1); 
    ```

如果`m`是无穷大，并且`x1`是`0`，那么乘以它应该得到 NaN，这不仅适用于 AS3。

*   我建议您永远不要使用斜截距形式的直线方程`y = Ax + B`，因为您无法以这种方式定义垂直线。始终使用一般形式：`Ax + By + C = 0`.

*   不要将浮点数与 == 进行比较，始终将浮点数与 epsilon 进行比较。[可能会有所帮助](https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/)。`x2`如果几乎等于，您的代码中可能会出现问题`x1`。

# php - imap_fetch 返回垃圾

> ID：14095423
> 
> 赞同：0
> 
> 时间：2012-12-30T22:39:07.230
> 
> 标签：php, email, imap

我对此感到非常困惑，我有一封从日志文件生成的电子邮件，它会发送一封电子邮件，其中包含正文中的日志文件内容。

我在一个测试 gmail 帐户上对 imap 的东西和 php 进行了一些测试，使用以下代码我可以毫无问题地看到数百封电子邮件的整个正文：

```
$mailbox = "xxx@gmail.com";
$mailboxPassword = "xxxx";

$mailbox = imap_open("{imap.gmail.com:993/imap/ssl}INBOX", $mailbox, $mailboxPassword);

$mail = imap_search($mailbox,'ALL');

if(empty($mail)) die('No unread emails found!');

foreach ($mail as $key => $val) 
{

// Retrieving message headers
$headers = imap_headerinfo($mailbox, $val);

// Retrieving subject
$subject = $headers->subject; 
```

ps我可以回显主题，一切都很好

```
 mb_internal_encoding("UTF-8");
 $subject = mb_decode_mimeheader(str_replace('_', ' ', $subject));

 $body_pre = imap_fetchbody($mailbox, $val, 1);
 $body = $body_pre ? imap_qprint(imap_fetchbody($mailbox, $val, 2)) : imap_qprint(imap_fetchbody($mailbox, $val, 1));

 if (empty($body))
    {
    $body = $body_pre;  
    } 
```

现在代码可能很乱，我基本上接管了别人的代码并让它为我工作，我添加了 if empty 一个，因为一些身体返回空，一旦我补充说它工作正常。我知道这是由于俄语/法语编码，所以虽然信息显示正常，但俄语/法语字符显示不正确，但至少不是空的

无论如何，基本上我所做的是获取原始电子邮件，将其转发到这个测试帐户，运行该代码，如果我回显 $body，我可以看到每个电子邮件正文。

现在问题发生了，当我收到完全相同的电子邮件时，来自 txt 文件的所有相同的电子邮件日志基本上作为电子邮件发送，但是当我在收件箱上运行相同的查询时，基本上只有区别，他们有 FW：在主题中很好这是正文输出的内容：

> SE0yIENyYXNoIExvZyBDb250ZW50cyBCZWxvdzo8YnIgLz48YnIgLz5Vc2VyIEVtYWlsOiBBbm9u LiAtIE5vdCBTdXBwbGllZDxhbm9uQGhvbGRlbW1hbmFnZXIuY29tPjxiciAvPkJ1aWxkIEluZm86 IDIuMC4wLjc2NjU8YnIgLz5Vc2VyIERlc2NyaXB0aW9uOiBOL0E8YnIgLz48YnIgLz5Mb2cgRmls ZSBDb250ZW50czogPGJyIC8 + PGJyIC8 + MDE6MTI6MTMuMTEwIFtNYWluOjEgLSBVbml0eUJvb3Rz dHJhcHBlci5SdW5dIDxiciAvPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX18gICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPg0KICAgICAgICAgICAgICAgICAgICAg ICAgICAgICggICApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPg0KICAgICAg ICAgICAgICAgICAgICAgICAgICAgICB8IHwgLi0uICAgIF9fXyAuLS4gLi0uICAgICAuLS0uICAg IDxiciAvPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IHwvICAgXCAgKCAgICkgICAn

并且 body_pre 回显为空

我也尝试改成这个并呼应所有这些，它们都显示为空白

```
$body_pre0 = imap_fetchbody($mailbox, $val);
    $body_pre = imap_fetchbody($mailbox, $val, 1);
    $body_pre1 = imap_fetchbody($mailbox, $val, 1.1);
    $body_pre2 = imap_fetchbody($mailbox, $val, 1.2);
    $body_pre3 = imap_fetchbody($mailbox, $val, 2);
    $body_pre4 = imap_fetchbody($mailbox, $val, 2.0);
    $body_pre5 = imap_fetchbody($mailbox, $val, 2.1);
    $body_pre6 = imap_fetchbody($mailbox, $val, 2.2);
    $body_pre7 = imap_fetchbody($mailbox, $val, 2.3);
    echo "Body 0: <br /><br /><br />" . $body_pre0 . "<br />";
    echo "Body 1: <br /><br /><br />" . $body_pre . "<br />";
    echo "Body 1.1: <br /><br /><br />" . $body_pre1 . "<br />";
    echo "Body 1.2: <br /><br /><br />" . $body_pre2 . "<br />";
    echo "Body 2: <br /><br /><br />" . $body_pre3 . "<br />";
    echo "Body 2.0: <br /><br /><br />" . $body_pre4 . "<br />";
    echo "Body 2.1: <br /><br /><br />" . $body_pre5 . "<br />";
    echo "Body 2.2: <br /><br /><br />" . $body_pre6 . "<br />";
    echo "Body 2.3: <br /><br /><br />" . $body_pre7 . "<br />"; 
```

我有点迷茫，希望得到一些指导，所以我不会在新年前失去理智:)

该电子邮件有一堆机密内容，如果有帮助，我可以将其添加到所有内容中, 大多数电子邮件都很大，因此编辑所有机密信息需要很长时间，但如果您要求，可以这样做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:51:27.297

这对我来说看起来不像垃圾......它看起来像base64编码的html......

```
In [4]: print base64.b64decode(corpus)
HM2 Crash Log Contents Below:<br /><br />User Email: Anon. - Not Supplied<anon@holdemmanager.com><br />Build Info: 2.0.0.7665<br />User Description: N/A<br /><br />Log File Contents: <br /><br />01:12:13.110 [Main:1 - UnityBootstrapper.Run] <br />
                             ___                                <br />
                            (   )                               <br />
                             | | .-.    ___ .-. .-.     .--.    <br />
                             | |/   \  (   )   ' 
```

# windows - Heroku toolbelt 无法在包含非拉丁字符的 Windows 7 用户上运行

> ID：14095428
> 
> 赞同：4
> 
> 时间：2012-12-30T22:40:00.283
> 
> 标签：windows, heroku, heroku-toolbelt

这是一个星期天的深夜，我决定搞砸 Facebook 应用程序。事实证明，它们现在为您提供了与 heroku 的轻松集成，当然，我决定尝试一下。我耐心地等待工具带下载，安装它，并且像往常一样，没有任何东西会为我运行而没有一点挣扎。

所以我尽我所能，用谷歌搜索了我遇到的问题，并意识到问题很可能是由于我的用户文件夹包含非拉丁字符这一事实引起的。为了确保这是问题所在，我创建了另一个用户帐户，在其上安装了 heroku toolbelt，它工作得很好。

关于如何在我不必使用测试帐户的情况下运行它有什么建议吗？

感谢您的时间！

**编辑**

忘了问是否可以更改heroku使用的文件夹？

**编辑**

仍然没有找到任何可以帮助我解决这个问题的东西，真的没有办法解决这个问题吗？

*我附上了错误的截图*

![我收到的错误](../Images/a9b614fef6c819a0b347e5bd6727a6ac.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-28T12:02:21.110

我在几乎相同的位置时偶然发现了这篇文章。这里有一个解决方案：

编辑`...\Heroku\lib\heroku\helpers.rb`如下`def home-directory`：

```
def home_directory
  running_on_windows? ? (ENV['HEROKU_HOME'] || ENV['USERPROFILE']).gsub("\\","/") : ENV['HOME']
end 
```

现在，如果您将`HEROKU_HOME`环境变量设置为任何值，Heroku 工具带将使用它作为主页。（FWIW：由于我在使用其他工具时也遇到过这个问题，所以我在`Users`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T19:57:57.827

我认为你应该做的是**`heroku login`**从**Git Bash**客户端而不是从默认的 Windows 命令行运行命令。我已经在 Windows 7 上使用 heroku-toolbelt 大约一年了，没有遇到任何此类问题。前段时间，我找到了一种在 Windows 命令行中启用拉丁字符的方法，在 CLIPS 中编写了一个程序，但我不太记得该命令现在是如何运行的，或者我做了什么配置。但是，如果您没有安装独立的 Git 客户端，您可以随时从以下网址获取它：http: [//git-scm.com](http://git-scm.com)。

# excel - 将 CSV 转换为 Excel Windows Phone 8

> ID：14095429
> 
> 赞同：3
> 
> 时间：2012-12-30T22:40:03.170
> 
> 标签：excel, winrt-xaml, windows-phone-8

使用 windows phone 8 我需要能够使用 C# 在 Excel 中打开一个 CSV 文件。他们是市场上现在称为 Excel Extensions 的应用程序，可以在本地转换 csv 文件。

我已经厌倦了使用开放式办公室 XML 转换 CSV 文件，但这不起作用。我想在本地做，所以没有网络服务。

有人知道如何在 Windows Phone 8 平台上将 CSV 文件转换为 Excel 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T00:21:19.127

**理论**

您有两个不同的选择：(1) 在 WP8 客户端上完成大部分工作 (2) 或在远程服务器上完成大部分工作。

对于**使用远程服务器的选项#2**：公开一个接收 CSV 文件的 WCF 服务，解析 CSV 以找到其逻辑 2D 表结构，使用[ClosedXML](http://closedxml.codeplex.com/)保存新的 XLSX 文件并将其返回给客户端。此选项最直接，但也需要网络连接和托管服务器。

对于**不使用远程服务器的选项#1**：读取 CSV 文件，将 CSV 数据复制到 XLSX 文件中，[将 XLSX 保存到 IsoStore 并使用该文件启动 excel](https://stackoverflow.com/questions/13702643/how-can-we-create-write-and-read-an-excel-file-for-windows-phone-8)。我过去写过关于这个主题的 [文章@How can we create, write and read an excel file for Windows Phone 8](https://stackoverflow.com/questions/13702643/how-can-we-create-write-and-read-an-excel-file-for-windows-phone-8)

您必须做**大量工作的一件事是用纯 WP7 C# 编写 XLSX 文件**。您要么必须将编写 XLSX 的[3rd 方](http://closedxml.codeplex.com/) [库转换为支持 WP7/WP8，要么将](https://nuget.org/packages/DocumentFormat.OpenXml)[简单的端到端 C# 代码示例](http://www.codeproject.com/Articles/208075/How-to-read-and-write-xlsx-Excel-2007-file-Part-I)转换为 WP7/WP8。两者都不简单。转换 ClosedXML 是可能的，但 DocumentFormat.OpenXml 对 WPF 的 WindowsCore 的依赖是一个问题。另一种选择是编写自己的 OpenXML C# 实现，就像 Chris Klug[在这里](http://chris.59north.com/post/OpenXML-2b-Silverlight-using-a-little-library.aspx)为 Silverlight 上的 Word OpenXML 所做的那样，后来被[移植到 WP7](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2011/01/13/105441.aspx)。关键是使用 OpenXML 规范来获得优势。

* * *

**实时代码示例**

例如，查看 Chris Klug 的[Silverlight Excel OpenXML](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2010/04/01/8360.aspx)文章，可以将他的*[Ag.OpenXML](http://agopenxml.codeplex.com/)*和*[OpenXML.Silverlight.Spreadsheet](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2010/04/01/8360.aspx)*代码移植到 WP8，然后简单地调用它们。我就是这么做的。以下是获取该实验源代码并开始使用的方法：

1) 下载并解压 [@http://JustinAngel.net/Storage/OpenXML.Silverlight.Spreadsheet.WP8.zip](http://JustinAngel.net/Storage/OpenXML.Silverlight.Spreadsheet.WP8.zip)

2) 添加对 csproj 或“OpenXML.Silverlight.Spreadsheet.WP8\Bin\Debug”中的 DLL OpenXML.Silverlight.Spreadsheet.WP8.dll 和 SharpZipLib.dll 的引用。

3) 添加以下代码片段，将 SpreedsheetDocument 文件保存到应用程序的 WP8 IsoStore 中，然后使用 WP8 app2app 文件关联在 Word 中启动它。

```
private async void SaveXlsxToIsoStoreAndLaunchInExcel(SpreadsheetDocument doc)
{
    using (var isoStore = IsolatedStorageFile.GetUserStoreForApplication())
    {
        if (isoStore.FileExists("myFile.xlsx"))
            isoStore.DeleteFile("myFile.xlsx");

        using (var s = isoStore.CreateFile("myFile.xlsx"))
        using (IStreamProvider storage = new ZipStreamProvider(s))
        {
            doc.Save(storage);
        }

        Launcher.LaunchFileAsync(
            await ApplicationData.Current.LocalFolder.GetFileAsync("myFile.xlsx"));
    }
} 
```

4) 使用 Chris 的示例文档调用上述代码片段：

```
private async void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    SpreadsheetDocument doc = new SpreadsheetDocument();
    doc.ApplicationName = "SilverSpreadsheet";
    doc.Creator = "Chris Klug";
    doc.Company = "Intergen";

    SharedStringDefinition str1 = doc.Workbook.SharedStrings.AddString("Column 1");
    SharedStringDefinition str2 = doc.Workbook.SharedStrings.AddString("Column 2");
    SharedStringDefinition str3 = doc.Workbook.SharedStrings.AddString("Column 3");

    doc.Workbook.Sheets[0].Sheet.Rows[0].Cells[0].SetValue(str1);
    doc.Workbook.Sheets[0].Sheet.Rows[0].Cells[1].SetValue(str2);
    doc.Workbook.Sheets[0].Sheet.Rows[0].Cells[2].SetValue(str3);

    doc.Workbook.Sheets[0].Sheet.Rows[1].Cells[0].SetValue("Value 1");
    doc.Workbook.Sheets[0].Sheet.Rows[1].Cells[1].SetValue(1);
    doc.Workbook.Sheets[0].Sheet.Rows[1].Cells[2].SetValue(1001);

    doc.Workbook.Sheets[0].Sheet.Rows[2].Cells[0].SetValue("Value 2");
    doc.Workbook.Sheets[0].Sheet.Rows[2].Cells[1].SetValue(2);
    doc.Workbook.Sheets[0].Sheet.Rows[2].Cells[2].SetValue(1002);

    doc.Workbook.Sheets[0].Sheet.Rows[3].Cells[0].SetValue("Value 3");
    doc.Workbook.Sheets[0].Sheet.Rows[3].Cells[1].SetValue(3);
    doc.Workbook.Sheets[0].Sheet.Rows[3].Cells[2].SetValue(1003);

    doc.Workbook.Sheets[0].Sheet.Rows[4].Cells[0].SetValue("Value 4");
    doc.Workbook.Sheets[0].Sheet.Rows[4].Cells[1].SetValue(4);
    doc.Workbook.Sheets[0].Sheet.Rows[4].Cells[2].SetValue(1004);

    TablePart table = doc.Workbook.Sheets[0].Sheet.AddTable("My Table", "My Table", doc.Workbook.Sheets[0].Sheet.Rows[0].Cells[0], doc.Workbook.Sheets[0].Sheet.Rows[4].Cells[2]);
    table.TableColumns[0].Name = str1.String;
    table.TableColumns[1].Name = str2.String;
    table.TableColumns[2].Name = str3.String;

    doc.Workbook.Sheets[0].Sheet.AddColumnSizeDefinition(0, 2, 20);

    doc.Workbook.Sheets[0].Sheet.Rows[5].Cells[1].SetValue("Sum:");
    doc.Workbook.Sheets[0].Sheet.Rows[5].Cells[2].Formula = "SUM(" + doc.Workbook.Sheets[0].Sheet.Rows[1].Cells[2].CellName + ":" + doc.Workbook.Sheets[0].Sheet.Rows[4].Cells[2].CellName + ")";

    SaveXlsxToIsoStoreAndLaunchInExcel(doc);
} 
```

5) 运行此代码片段时，我们可以看到以下警告弹出窗口，然后是 Excel 电子表格。随意改进我仓促的 Silverlight-->WP8 端口并删除该警告。

![Excel WP8 使用我们刚刚创建的文件打开](../Images/f0d4c00fcd4697500a380d7ebb1dd63c.png) ![WP8 Excel 上的损坏文件警告](../Images/a140d7fc3f4e51b39daabd993a4c1bf3.png)

# groovy - 如何获取依赖项并使其与 IntelliJ 项目一起使用？

> ID：14095430
> 
> 赞同：4
> 
> 时间：2012-12-30T22:40:09.537
> 
> 标签：groovy, intellij-idea, grape, groovyfx

我正在尝试在 IntelliJ 12 中启动 GroovyFX 项目。但是，我无法让 IntelliJ 编译和运行以下简单脚本（以尽可能简单的方式重现问题）：

```
@Grab(group='org.codehaus.groovyfx', module='groovyfx', version='0.3.1')
import groovyx.javafx.GroovyFX
println GroovyFX.class.name 
```

我使用 IntelliJ 对 Grape's Grab 的支持将 groovyfx 添加为我的模块的依赖项（该 jar 显示在“外部库”下，编辑器不会抱怨该类在那之后丢失了！）但是，当我运行脚本时，它抛出一个错误：

> Groovyc：无法解析类 groovyx.javafx.GroovyFX

我能够让这个脚本在 GroovyConsole 中正常工作，没有太多问题，并且符合预期......

我尝试抓取另一个随机选择的依赖项（原来是一个 Spring 库），它直接工作：

```
@Grab(group='org.springframework', module='spring', version='2.5.6')
import org.springframework.jdbc.core.JdbcTemplate
println JdbcTemplate.class.name 
```

我看不出为什么 Spring 库应该工作的充分理由，但 GroovyFX 库却不行！！！！

我什至仔细检查了 GroovyFx 库是否已实际下载，它应该在哪里（在 {user.home}/.groovy/grapes/{group}/{module}/jars/ 下）

什么会导致这个奇怪且非常令人沮丧的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T13:24:55.193

我使用 groovyConsole（来自[groovy-sdk-2.1.0](http://groovy.codehaus.org/Download)）和 IntelliJ IDEA 12.0.3 测试了您的问题。我得到的唯一例外是：

```
Caught: java.lang.NoClassDefFoundError: javafx/application/Application
java.lang.NoClassDefFoundError: javafx/application/Application
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
Caused by: java.lang.ClassNotFoundException: javafx.application.Application
    ... 1 more 
```

这是因为 JavaFX 运行时 (jfxrt.jar) 不在类路径中。这可以用

```
mvn com.zenjava:javafx-maven-plugin:1.3:fix-classpath 
```

上面的命令取自[JavaFX Maven Plugin Wiki](https://github.com/zonski/javafx-maven-plugin/wiki)。您只需执行一次。在那之后，groovyConsole 和 IntelliJ 都在工作。我不得不重新启动 groovyConsole，这对于 IntelliJ 来说不是必需的。

有趣的是，我在“外部库”下看不到 GroovyFx-jar。我正在使用没有任何插件的普通 IDEA 社区版。

GroovyFX 主页上的 Hello World 在 IDEA 中是开箱即用的，但在 groovyConsole 中却没有——我还收到“java.lang.ClassNotFoundException: groovyx.javafx.GroovyFX”。我设法让它使用以下代码运行，但这不是一个好的解决方案，因为它仅在第一次运行时有效，因此您必须重新启动 groovyConsole：

```
@GrabConfig(systemClassLoader=true, initContextClassLoader=true)
@Grab(group='org.codehaus.groovyfx', module='groovyfx', version='0.3.1')
import static groovyx.javafx.GroovyFX.start

start {
    stage(title: 'GroovyFX Hello World', visible: true) {
        scene(fill: BLACK, width: 500, height: 250) {
            hbox(padding: 60) {
                text(text: 'Groovy', font: '80pt sanserif') {
                    fill linearGradient(endX: 0, stops: [PALEGREEN, SEAGREEN])
                }
                text(text: 'FX', font: '80pt sanserif') {
                    fill linearGradient(endX: 0, stops: [CYAN, DODGERBLUE])
                    effect dropShadow(color: DODGERBLUE, radius: 25, spread: 0.25)
                }
            }
        }
    }
} 
```

我不确定，但我认为原因是[这里](http://jira.codehaus.org/browse/GROOVY-5871)的这个错误。应该在 Groovy 2.2 中修复，我们将看到。

# wordpress - 启动 WordPress Android 应用程序时出现 XML 错误

> ID：14095436
> 
> 赞同：0
> 
> 时间：2012-12-30T22:40:41.640
> 
> 标签：wordpress

```
org.xmlpull.v1.XmlPullParserException：意外类型（位置：END_DOCUMENT null@1:1 in java.io.InputStreamReader@xxxxxx）
```

我该如何解决？

# android - （Android && 蓝牙）无需用户交互就可以从服务中发现设备？

> ID：14095438
> 
> 赞同：0
> 
> 时间：2012-12-30T22:40:47.880
> 
> 标签：android, bluetooth, discoverability

我希望能够自动打开 android 设备上的可发现性，而不会提示用户使用安全对话框。

我正在开发两个应用程序，一个用于 Android 电视盒，一个用于我的智能手机。我希望能够使用我的智能手机控制 android 电视盒，但是我想做到这一点而不需要在电视盒上手动打开可发现性，因为这需要某种遥控器完全破坏应用程序的要点。

是否有另一种方法可以通过我可以使用的 API 实现可发现性 - 最好是通过服务。

谢谢，

内森。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-09-13T13:23:18.830

哇，4年过去了。作为对我年轻时自己的回答，我认为你试图做的事情是不可能的，正如你自己所说的那样，这是一个安全问题（你自己引用了一个“安全对话”）。

如果应用程序可以随时打开蓝牙，并且可以完全秘密地访问整个蓝牙硬件，那么该应用程序可能会恶意破坏 Android 操作系统的某些部分并删除或更糟；分发用户的个人信息。

相反，您将看到的是实现计算机外围设备制造商使用无线键盘和鼠标实现的系统，即将蓝牙连接提取到单独的硬件层（USB 加密狗）并通过 USB 实现人机接口设备，从而在打开过滤蓝牙连接以仅允许向设备发送 HID 输入信息。

对4年前的自己，

内森。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-09-04T03:51:30.747

有点晚了，但是您需要有意识地这样做，来自 Android 蓝牙的文档：

```
Intent discoverableIntent = new
Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
discoverableIntent.putExtra(BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION, 300);
startActivity(discoverableIntent); 
```

[http://developer.android.com/guide/topics/connectivity/bluetooth.html#EnablingDiscoverability](http://developer.android.com/guide/topics/connectivity/bluetooth.html#EnablingDiscoverability)

# php - 需要有关创建数字化票务入场系统的建议

> ID：14095442
> 
> 赞同：0
> 
> 时间：2012-12-30T22:41:18.860
> 
> 标签：php, sql, system, qr-code

所以我认识这个在东海岸经营俱乐部的人，他用腕带作为俱乐部的入场券。他想摆脱这些腕带，因为人们一直在制造假腕带。

所以我计划让每一个买票的顾客都收到一个带有二维码的电子邮件地址。售票员将客户姓名和电子邮件输入我正在开发的系统中，该系统将生成一个字母数字代码并在 SQL 数据库中使用该客户姓名（字符串）、id#（主键）、isVerified 创建一个新列（布尔）和字母数字代码。

字母数字代码将用于二维码，二维码将在俱乐部入口处进行验证。

有谁知道在线某处是否有与我正在尝试创建的系统非常相似的系统的教程或指南？谢谢一堆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:48:49.633

这是一个类似的stackoverflow问题（关于二维码）： [Dynamically generate a QR code with PHP](https://stackoverflow.com/questions/5943368/dynamically-generating-a-qr-code-with-php)

关于系统本身，您可能可以使用现有系统，并根据 order_id（或类似的东西）创建二维码

# android - android多选对话框中的自定义复选框

> ID：14095446
> 
> 赞同：1
> 
> 时间：2012-12-30T22:41:53.330
> 
> 标签：android

我正在构建一个显示多选对话框的小应用程序。我需要做的是更改复选框图像。我想用我的自定义位图替换绿色勾号。有没有一种简单的方法可以做到这一点？可以在不创建自定义适配器的情况下完成吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-07T13:16:17.953

您可以使用此代码向用户显示一个对话框：

```
btn2.setOnClickListener(new OnClickListener() 
    {
        @Override
        public void onClick(View v) 
        {
            Builder alert2 = new AlertDialog.Builder(MainActivity.this);
            alert2.setTitle("pick one of below");
            alert2.setSingleChoiceItems(items, 0, new DialogInterface.OnClickListener() 
            {
                @Override
                public void onClick(DialogInterface dialog, int which) 
                {
                    itemsCecked[which] = true;
                }
            });
            alert2.setPositiveButton("OK", new DialogInterface.OnClickListener() 
            {   
                @Override
                public void onClick(DialogInterface dialog, int which) 
                {
                    for(int i=0; i<items.length ; i++)
                    {
                        if(itemsCecked[i]==true)
                        {
                            txt.setText(items[i]);
                        }
                    }
                }
            }); 
```

在 oncreate() 方法中使用它。

# c++ - C ++对字符串中的字符进行反向排序

> ID：14095450
> 
> 赞同：2
> 
> 时间：2012-12-30T22:42:21.053
> 
> 标签：c++, string, sorting, stl

有大量的代码可以按字典顺序对字符串数组进行排序，但我找不到一个可以按字典顺序对 ONE 字符串中的字符进行排序的代码。到目前为止，我发现使用`std::sort()`in`<algorithm>`可能是最接近的候选者。

这是我尝试过的：

```
template <typename T>
class ReverseComparator{
     bool operator()(T l, T r){return !(l < r);}
};
//.....later
std::sort(str.begin(), str.end(), comparator); 
```

问题是：如何初始化我的比较器，以便它可以比较字符串中的字符？我试过`ReverseComparator<char> comparator`了，但编译器会抛出大量错误消息。 [gcc-4.5.1 显示这些错误](http://ideone.com/ulB623_)：

```
In file included from /usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/algorithm:63:0,
                 from prog.cpp:1:
prog.cpp: In function 'void std::__insertion_sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2192:4:   instantiated from 'void std::__final_insertion_sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5252:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2125:4: error: within this context
prog.cpp: In function 'void std::__heap_select(_RandomAccessIterator, _RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5100:7:   instantiated from 'void std::partial_sort(_RAIter, _RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2297:8:   instantiated from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Size = int, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5250:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:1914:2: error: within this context
prog.cpp: In function 'void std::__move_median_first(_Iterator, _Iterator, _Iterator, _Compare) [with _Iterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2260:7:   instantiated from '_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2302:62:   instantiated from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Size = int, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5250:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:108:7: error: within this context
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:110:4: error: within this context
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2260:7:   instantiated from '_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2302:62:   instantiated from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Size = int, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5250:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:112:9: error: within this context
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:115:12: error: within this context
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:117:12: error: within this context
prog.cpp: In function '_RandomAccessIterator std::__unguarded_partition(_RandomAccessIterator, _RandomAccessIterator, const _Tp&, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Tp = char, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2261:78:   instantiated from '_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2302:62:   instantiated from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Size = int, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5250:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2229:4: error: within this context
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2232:4: error: within this context
prog.cpp: In function 'void std::__unguarded_linear_insert(_RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2133:6:   instantiated from 'void std::__insertion_sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2192:4:   instantiated from 'void std::__final_insertion_sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5252:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2083:7: error: within this context
In file included from /usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:62:0,
                 from /usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/algorithm:63,
                 from prog.cpp:1:
prog.cpp: In function 'void std::__adjust_heap(_RandomAccessIterator, _Distance, _Distance, _Tp, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Distance = int, _Tp = char, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_heap.h:434:4:   instantiated from 'void std::make_heap(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:1912:7:   instantiated from 'void std::__heap_select(_RandomAccessIterator, _RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5100:7:   instantiated from 'void std::partial_sort(_RAIter, _RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2297:8:   instantiated from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Size = int, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5250:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_heap.h:303:4: error: within this context
prog.cpp: In function 'void std::__push_heap(_RandomAccessIterator, _Distance, _Distance, _Tp, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Distance = int, _Tp = char, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_heap.h:316:7:   instantiated from 'void std::__adjust_heap(_RandomAccessIterator, _Distance, _Distance, _Tp, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Distance = int, _Tp = char, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_heap.h:434:4:   instantiated from 'void std::make_heap(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:1912:7:   instantiated from 'void std::__heap_select(_RandomAccessIterator, _RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5100:7:   instantiated from 'void std::partial_sort(_RAIter, _RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2297:8:   instantiated from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Size = int, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5250:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_heap.h:180:7: error: within this context 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T22:51:23.653

`operator()`根据该问题的大多数其他答案，虽然解决编译器错误只需要公开，但您应该注意您的比较器不是有效的*严格*比较器。严格的比较器必须返回`false`被视为相等的元素。您还应该使用 const 引用而不是比较器的参数类型的值。

我想为您提供多个选项来解决您的问题（不是编译器错误，而是原始问题，以相反的词法顺序对字符串进行排序）。所有这些都返回`false`两个相等的元素。

第**一个选项**是您的解决方案，但我修复了严格性：

```
template <typename T>
class ReverseComparator{
public:
     bool operator()(const T& l, const T& r){return (r < l);}
};

std::sort(str.begin(), str.end(), ReverseComparator()); 
```

第二**个选项**使用 C++11 的*lambda function*，但本质上是相同的：

```
std::sort(str.begin(), str.end(), [](const T& l, const T& r){return (r < l);}); 
```

作为**第三种选择**，正如 Mooning Duck 首次提出的那样，您可以简单地`operator>`在您的类型上使用 std 仿函数`char`：

```
std::sort(str.begin(), str.end(), std::greater<char>()); 
```

**第四种选择**（最简单的一种）是在*反转*字符串上使用默认比较器，正如 Peter Wood 首次提出的那样（注意`r`！）：

```
std::sort(str.rbegin(), str.rend()); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T22:49:33.763

通常，只有第一个错误是相关的，所以我们有这个：

```
In file included from /usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/algorithm:63:0,
                 from prog.cpp:1:
prog.cpp: In function 'void std::__insertion_sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]':
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:2192:4:   instantiated from 'void std::__final_insertion_sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
/usr/lib/gcc/i686-pc-linux-gnu/4.5.1/../../../../include/c++/4.5.1/bits/stl_algo.h:5252:4:   instantiated from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >, _Compare = ReverseComparator<char>]'
prog.cpp:12:49:   instantiated from here
prog.cpp:6:11: error: 'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private 
```

其中大部分只是上下文，所以这里是关键部分：

```
'bool ReverseComparator<T>::operator()(T, T) [with T = char]' is private 
```

那么这很容易解决：

```
#include <algorithm>
#include <string>

template <typename T>
class ReverseComparator{
    public: //forgot this
     bool operator()(T l, T r){return !(l < r);}
};

int main() {
    std::string str = "HELLO";
    ReverseComparator<char> comparator;
    std::sort(str.begin(), str.end(), comparator);
} 
```

[这编译得很好](http://ideone.com/KWtasS)，但是，排序基于所谓的“严格弱排序”，而*不是*`!(l < r)`严格的弱排序。即，应该返回，但你的返回。幸运的是，以这种方式排序的想法已经在标准库中。（默认情况下没有比较器使用）*`comparitor(a,a)``false``true``std::greater``std::sort``std::less`*

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T22:52:06.927

使用`std::sort()`显然是正确的方法。默认比较器是`std::less<value_type>`传递的迭代器类型的位置`value_type`。`decltype(*it)`要更改默认值，您只需传递一个不同的比较器，例如`std::greater<char>`.

要使用您`ReverseComparator`的定义，您需要正确实例化它：

```
std::sort(s.begin(), s.end(), ReverseComparator<char>()); 
```

当然，要使其正常工作，您需要使其可`operator()()`公开访问。您可能还想让它成为`const`成员函数：

```
template <typename T>
class ReverseComparator {
public:
    bool operator()(T lhs, T rhs) const { return rhs < lhs; }
}; 
```

请注意，运算符中的表达式也发生了变化： using`!(lhs < rhs)`没有定义严格的弱顺序：`comparator(x, x)`会 yield`true`但需要 yield `false`。*

# jquery - jquery 可排序的内联块显示显示划痕

> ID：14095451
> 
> 赞同：4
> 
> 时间：2012-12-30T22:42:34.563
> 
> 标签：jquery, list, jquery-ui-sortable, css

我正在尝试使用 JQuery 使用已连接的可排序列表，但是，如果我在我的 li CSS 中使用 display:inline-block，则占位符和位置不正确。它通常更高，并且项目的大小也会调整，从而导致自动换行。

如果我将 display:inline-block 更改为 float:left here

```
ul.fieldlist li
{
        display:inline-block;
        list-style-type: none;
} 
```

然后拖放工作正常，但由于某些原因我无法拖回原始可排序。

我制作了一个 jsfiddle 来显示问题：

[http://jsfiddle.net/uArNx/5/](http://jsfiddle.net/uArNx/5/)

我的填充/边距可能有问题，但我无法弄清楚。

欢迎任何帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-04T16:58:22.200

修复是`vertical-align: top`. 据我所知，JqueryUI Sortables 不能`vertical-align: middle`很好地处理。

尝试将 vertical-align: top 添加到您的 jsfiddle 中——它可以解决对齐问题。

这里有一些注释，以及对 inline 块的初始修复，但我认为 valign 中间情况被遗漏了。 [http://bugs.jqueryui.com/ticket/6942](http://bugs.jqueryui.com/ticket/6942)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-12T15:28:57.040

这里的问题是由于尝试对每个大小由可变文本内容确定的内联块进行排序而引起的。

一种解决方法是

1.  `vertical-align: top`按照其他用户的建议设置
2.  **a)**固定每个 inline-block 容器的大小，或者b **)**在每个容器上设置`white-space: nowrap`以防止在拖动包含多个单词的容器时行高加倍。

    由于您的容器的大小由其中的文本决定，因此执行选项**a)**必须在 javascript 中，理想情况下是在拖动开始时（尽管如果列表不会改变，您可以在页面加载时执行一次）。类似于以下内容（您必须提供正确的 li 选择器和拖动事件名称...）：

    ```
    $('.li').on('dragStart', function (e) {
      var $this = $(this);
      $this.width( $this.width() );
      $this.height( $this.height() );
    }); 
    ```

3.  最后，您可能需要修复每个容器的 line-height 以避免内联图像或较大文本改变行高的情况（在这个 jsfiddle 示例中不是问题，但对于可能遇到该问题的任何其他人来说都提及它）。

# javascript - 谷歌浏览器扩展没有显示弹出窗口

> ID：14095458
> 
> 赞同：6
> 
> 时间：2012-12-30T22:43:13.297
> 
> 标签：javascript, json, google-chrome, google-chrome-extension

问题是，当我单击图标时，它根本不显示任何内容。

清单.json

```
{
  "manifest_version": 2,
  "name"            :  "My cool plugin",  // the name of the extension
  "version"         :  "1.0"              ,   // version number
  "description"     :  "My cool plugin", // description used in the Chrome Webstore
  "background": "background.html",
  "browser_action"  :  {
    "default_title": "My cool plugin",
      "default_icon"   :  "icon.png",      // specifies the default icon
      "popup"          :  "popup.html"   // the page to show when the icon is clicked
  },
  "permissions": [
    "tabs", 
    "http://*/",
    "https://*/*"
  ]
} 
```

popup.html 和 background.html

```
<div>
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</div> 
```

问题是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-30T22:49:17.803

这`"default_popup": "popup.html"`不是“弹出”

[https://developer.chrome.com/extensions/browserAction.html](https://developer.chrome.com/extensions/browserAction.html)

# javascript - Javascript：像这样准确拆分字符串：/kick @Username "reason" 但用户名可以有特殊字符

> ID：14095462
> 
> 赞同：1
> 
> 时间：2012-12-30T22:43:46.323
> 
> 标签：javascript, regex, string

这是我的困境...

我希望能够拆分如下所示的字符串：

```
/ban @User "because I told you so" 
```

但是，使用空格、@ 或引号作为字符串分隔符的问题是用户名可能包含大量特殊字符。而且，很可能，这些特殊字符可能会与处理命令发生冲突。

例如：

```
/ban @Person" "because why not" 
```

行不通，也不行

```
/ban @Person"name" "reason" 
```

当我可以用来分割字符串的任何字符都可以很容易地被目标用户的名字模拟来破坏命令时，我如何才能准确地处理这样的事情？这甚至可能吗？老实说，RegExp 对我来说有点难以理解或看，所以如果这是一个简单的正则表达式修复，我深表歉意:(

非常感谢一个解决方案，我现在有一个工作处理器：

```
 var yourRegex = /^@(.*?) "([^"]+)"$/; 
```

由于我已经可以删除 /ban（其他命令，如 /kick 等，因为它不只是这个命令）我只是将它从正则表达式中删除。我也将 @ 符号移出，因为我不需要它来定位用户。100% 有效：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:47:04.883

试试这个：

```
/^\/ban (@.*?) "([^"]+)"$/ 
```

这将为您提供第一个子模式中的用户名（带有前导`@`符号，如果要排除它，只需将其移到括号外），以及第二个子模式中的原因（不带引号，将它们移到括号内以包含它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:21:44.650

正如我在评论中提到的，我使用最小的解析器完成了类似的任务。这是 CoffeeScript 中的一个，它编译为 JavaScript：

```
parse = (input) ->
  index = 0
  peek = -> input.charAt index
  advance = -> ++index; peek()
  advanceRP = ->
    last = peek()
    advance()
    return last
  collect = (regex) -> (advanceRP() while peek().match regex).join ''
  skipWhiteSpace = -> collect /\s/
  literal = ->
    result = collect /[@\w]/
    skipWhiteSpace()
    return result
  string = ->
    if peek() == '"'
      advance()
      result = []
      loop
        result.push collect /[^"]/
        advance()  # skip past closing quote
        if peek() is '"'  # and therefore an escape (double quote)
          result.push '"'
        else if peek().match /\s?/
          break  # whitespace or end of input; end of string
        else
          # neither another quote nor whitespace;
          # they probably forgot to escape the quote.
          # be lenient, here.
          result.push '"'
      skipWhiteSpace()
      result.join ''
    else
      literal()

  return error: 'does not start with slash' if peek() isnt '/'
  advance()
  command = literal()
  return error: 'command unrecognized' if command isnt 'ban'
  person = string()
  if peek() == '"'
    reason = string()
    return error: 'junk after end of command' if index < input.length
  else
    reason = input.substring index

  command: 'ban'
  person: person
  reason: reason 
```

试试看：

```
coffee> parse '/ban @person reason'
{ command: 'ban', person: '@person', reason: 'reason' }
coffee> parse '/ban "@person with ""escaped"" quotes" and the reason doesn\'t need "quotes"'
{ command: 'ban'
, person: '@person with "escaped" quotes'
, reason: 'and the reason doesn\'t even need "quotes"'
} 
```

# python - 如何使 Datetimeindex 不是数据框中的索引

> ID：14095463
> 
> 赞同：1
> 
> 时间：2012-12-30T22:43:48.523
> 
> 标签：python, pandas

我想访问 Datetimeindex 类提供的特殊方法，例如月、日等。但是，如果不将其设为数据框的索引，我似乎无法将数据框中的系列设为 Datetimeindex。举个例子：

```
dates

Out[119]:
         Dates
0     1/1/2012
1     1/2/2012
2     1/3/2012
3     1/4/2012
4     1/5/2012
5     1/6/2012
6     1/7/2012
7     1/8/2012
8     1/9/2012
9    1/10/2012
10  12/31/2012

date_series = pd.DatetimeIndex(dates.Dates)
date_series.month
Out[115]: array([ 1,  1,  1,  1,  1,  1,  1,  1,  1,  1, 12])

dates.Dates = pd.DatetimeIndex(dates.Dates)
dates.Dates.month
AttributeError: 'Series' object has no attribute 'month' 
```

我还尝试使用 pd.to_datetime 将系列转换为时间戳，但它仍然不起作用。

我知道我可以解决这个问题，但似乎这个功能应该存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:13:23.153

现在我建议做`pd.DatetimeIndex(dates.Dates).month`. 我一直在争论是否要向 Series 添加一组特定于数据类型的属性，这些属性仅适用于时间戳，但还没有完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:09:45.207

更新：在 0.15 中，您将可以访问类似 datetime 方法的 dt 属性：

```
dates.Dates.dt.month 
```

* * *

旧帖子（使用 Wes 的解决方案而不是这个）：

这是一个（慢！）解决方法来使用它[`apply`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.apply.html)，不理想但它有效：

```
In [11]: from pandas.lib import Timestamp

In [12]: df.Dates.apply(lambda x: Timestamp(x).month)
Out[12]: 
0      1
1      1
2      1
3      1
4      1
5      1
6      1
7      1
8      1
9      1
10    12
Name: Dates 
```

*这似乎是一个错误（你不能这样做`apply(lambda x: x.month)`），也许值得在 github 上作为问题添加。*正如韦斯所说：[“欢迎来到地狱”](https://stackoverflow.com/a/13753918/1240268)。

# vb.net - VB.Net“COMException 未处理”错误

> ID：14095467
> 
> 赞同：0
> 
> 时间：2012-12-30T22:44:19.043
> 
> 标签：vb.net, comexception

我有一个用 .Net 2.0 编写的 VB.Net 程序我正在尝试编写一个将整个注册表项记录到日志文件中的代码。我已经让它与以下代码一起工作。 [http://pastebin.com/kmA63cUe](http://pastebin.com/kmA63cUe) 但是，每当我尝试添加一个额外的注册表项来记录

```
LogPrint4("<-----------------HKLM/WebCheck-------------------->")
    If reg.enumvalues(&H8000002, "Software\Microsoft\Windows\CurrentVersion\WebCheck", keys2, types) = 0 Then
        If IsArray(keys2) Then
            For p = 0 To UBound(keys2)
                reg.getstringvalue(&H8000002, "Software\Microsoft\Windows\CurrentVersion\WebCheck", keys2(p), value)
                LogPrint4(keys2(p) & "=" & value)
            Next
        End If
    End If 
```

它出现以下错误

> COMException 未处理 检查异常的 ErrorCode 属性以确定 COM 对象返回的 HRESULT。

我不确定为什么它仅限于 5 次检查。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:25:25.710

考虑使用内置注册表支持而不是 COM 库。至少，您会收到更清晰的错误消息。它在 .NET 2.0 中受支持。

[http://msdn.microsoft.com/en-us/library/microsoft.win32.registry(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry(v=vs.80).aspx)

祝你好运！

# mysql - mysql查询与或或的结果右连接或

> ID：14095470
> 
> 赞同：0
> 
> 时间：2012-12-30T22:44:33.147
> 
> 标签：mysql, join

我正在为一个新站点编写一个内部/私人消息/电子邮件系统，到目前为止它运行得非常好，但我只是遇到了一个障碍……垃圾文件夹。

我需要执行一个查询，其中包含字段 (a AND b) = 一个设置或 (x AND y) = 另一个设置的所有记录，然后在用户表上右连接该记录，以便我可以知道是谁发起了记录/消息.

这是我所拥有的：

```
SELECT * FROM mail AS M
RIGHT JOIN users AS U on U.userid = M.frm_userid or M.to_userid /* result of WHERE */
WHERE (frm_userid='$userid' AND frm_status=3) OR (to_userid='$userid' AND to_status=3) 
ORDER BY some_date_field DESC 
```

我被困在 U.userid 上的 RIGHT JOIN = 我不知道！我确信有一种方法可以做到这一点，但我只是不太了解 MYSQL 来完成这个！

有什么建议么？

谢谢，

皮特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:24:06.010

尝试这个

```
 SELECT 
         * 
    FROM 
         mail AS M
    RIGHT JOIN 
         users AS U on (U.userid = M.frm_userid or U.userid = M.to_userid)
    WHERE 
         (frm_userid='$userid' AND frm_status=3) OR (to_userid='$userid' AND to_status=3) 
    ORDER BY 
         some_date_field DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:51:02.590

将 TO 和 FROM 处理分成 UNION 的不同部分：

```
SELECT M.to_userid FROM mail AS M
JOIN users AS U on U.userid = M.frm_userid and M.frm_status=3
WHERE M.frm_userid = '$userid'
UNION
SELECT M.frm_userid FROM mail as M
JOIN users AS U on U.userid = M.to_userid and M.to_status=3
WHERE M.to_userid = '$userid'
ORDER BY some_date_field DESC 
```

# c# - 保存设置或数据 C#

> ID：14095471
> 
> 赞同：1
> 
> 时间：2012-12-30T22:44:33.427
> 
> 标签：c#, properties, settings, save

我是stackoverflow的新手，但我认为我应该试一试......

所以我想做的是将变量保存在其他程序可以访问的文件中......例如，我有一个设置应用程序来处理所有设置数据（例如数据库信息、字符串、数字，或布尔值）。我的想法是将它们保存到像属性文件或文本文件这样的文件中，另一个程序可以读取它们并修改该设置文件。谁能指出我正确的方向？

谢谢 waco001

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:50:05.913

如果您使用 C#，我建议您将所有设置放在一个单独的类中，然后使用 XmlSerialization 来保存它，这样您就可以使用最少的代码来使用功能，并且您可以以格式保存数据其他应用程序易于阅读。

有多个示例可用，例如： [http ://www.jonasjohn.de/snippets/csharp/xmlserializer-example.htm](http://www.jonasjohn.de/snippets/csharp/xmlserializer-example.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:12:38.940

创建一个设置类并对其进行序列化/反序列化，如果您将配置封装在不同的对象中，这还有使用属性网格管理它的额外好处，我通常使用我的配置文件执行此操作，这是一个小例子：

```
using System;
using System.Text;
using System.Xml;
using System.Xml.Serialization;
using System.Collections.Generic;
using System.Runtime.Serialization;

namespace Generate.Test
{
    /// <summary>
    /// The configuration class.
    /// </summary>
    [Serializable, XmlRoot("generate-configuration")]
    public class Configuration : ISerializable
    {
        #region Fields

        private string inputPath  = string.Empty;
        private string outputPath = string.Empty;
        private int    maxCount   = 0;

        #endregion

        #region Constructors

        /// <summary>
        /// Initializes a new instance of the <see cref="Configuration" /> class.
        /// </summary>
        public Configuration()
        {
        }

        #endregion

        #region Properties
        /// <summary>
        /// Gets or sets the output path.
        /// </summary>
        /// <value>
        /// The output path.
        /// </value>
        [XmlElement("output-path")]
        public string OutputPath
        {
            get { return this.outputPath; }
            set { this.outputPath = value; }
        }

        /// <summary>
        /// Gets or sets the input path.
        /// </summary>
        /// <value>
        /// The input path.
        /// </value>
        [XmlElement("input-path")]
        public string InputPath
        {
            get { return this.inputPath; }
            set { this.inputPath = value; }
        }

        /// <summary>
        /// Gets or sets the max count.
        /// </summary>
        /// <value>
        /// The max count.
        /// </value>
        [XmlElement("max-count")]
        public int MaxCount
        {
            get { return this.maxCount; }
            set { this.maxCount = value; }
        }
        #endregion

        #region ISerializable Members

        /// <summary>
        /// Gets the object data.
        /// </summary>
        /// <param name="info">The info.</param>
        /// <param name="context">The context.</param>
        /// <exception cref="System.ArgumentNullException">thrown when the info parameter is empty.</exception>
        public void GetObjectData(SerializationInfo info, StreamingContext context)
        {
            if (info == null)
                throw new System.ArgumentNullException("info");

            info.AddValue("output-path", this.OutputPath);
            info.AddValue("input-path", this.InputPath);
            info.AddValue("max-count", this.MaxCount);
        }

        #endregion
    }
} 
```

因此要反序列化（_configurationPath 是存储配置的 xml 的路径）：

```
 if (File.Exists(_configurationPath))
        {
            try
            {
                XmlSerializer serializer = new XmlSerializer(typeof(Configuration));
                Stream        stream     = new FileStream(_configurationPath, FileMode.Open, FileAccess.Read);
                Configuration config     = (Configuration)serializer.Deserialize(stream);

                _inputPath  = config.InputPath;
                _outputPath = config.OutputPath;
                _maxCount   = config.MaxCount;
            }
            catch (Exception exception)
            {
                Console.WriteLine("Error cargando el archivo de configuración '{0}':\n{1}", _configurationPath, exception);
            }
        } 
```

并序列化：

```
 Configuration configuration = new Configuration(); // Create the object

    // Set the values

    configuration.InputPath  = @".\input";
    configuration.OutputPath = @".\output";
    configuration.MaxCount   = 1000;

    // Serialize

    XmlSerializer serializer = new XmlSerializer(typeof(Configuration));
    Stream stream = new FileStream(_configurationPath, FileMode.Open, FileAccess.Write);
    serializer.Serialize(stream, configuration); 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T22:47:55.777

尝试使用 Visual Studio 项目中支持的 App.config。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T22:49:14.653

典型的方法是创建一个`XmlDocument`，用恰当命名的节点和属性填充它，然后通过`Save()`. 这样做的好处是，大多数其他环境都能够读取 XML 并对其进行解析。

另一种“通用语言”是 JSON，它可以很容易地通过大多数其他环境编写`JSON.NET`并被大多数其他环境“理解”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T22:51:00.373

如果您只想在应用程序之间共享数据，您应该研究 WCF。

或者，您可以使用现有的 .NET API for XML 创建和解析数据。然后使用系统IO将其存储到硬盘中。

# git - Git vs SVN：性能和存储

> ID：14095478
> 
> 赞同：1
> 
> 时间：2012-12-30T22:45:45.077
> 
> 标签：git, svn, version-control, backup

我想使用 Git 或 SVN (Subversion) 之一作为**备份系统**。对我来说唯一重要的是系统的存储和性能。我四处搜索，发现的大多数结果都在比较它们与源代码控制相关的功能，例如分支、本地存储库等。但是，正如我所提到的，我**不是**在寻找这些功能。

简而言之，我想知道：

*   哪个存储效率更高（占用空间更少）
*   哪个更可靠（如果 push/committing 时发生崩溃，哪个更好地处理错误）
*   哪个做事更快
*   哪一个可以更好地处理**大型**存储库（如果提交的修订太多，性能会更好）
*   ...

如果在比较中添加一些事实（实验），我将不胜感激。我正在寻找确凿的证据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-30T22:55:58.793

去吧`git`，没有竞争：

*   它更安全（所有提交都是唯一散列的），
*   它更紧凑（过去 5 年的*整个*Linux 内核历史在我的机器上占用不到 1 GB），
*   它快得多了，甚至都不好笑，
*   它很容易复制，因为它是分散的。

当然，使用 git 与 SVN 有很大不同。但是教程也很丰富。

[这](http://bokov.net/weblog/project-managment/comparing-svn-vs-git-in-performance-test/)是在几个选定场景中比较 git 和 svn 性能的链接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T22:51:13.120

### 用于[`rsync`](http://rsync.samba.org/)备份。

如果保留正在备份的文件的历史记录很重要，请使用[`rdiff-backup`](http://rdiff-backup.nongnu.org/)

Git 和 SVN 不是备份实用程序。

* * *

我知道您并不关心 SCM 工具的功能，**这应该表明您不需要一个**，但是（！），如果您使用像 Git 或 SVN 这样的 SCM 工具，您将必须处理实际的提交。

如果我唯一的目标是拥有一组文件的完整副本，我会认为这是一个巨大的痛苦。

* * *

就**速度**而言，如果您与备份目的地的连接速度很快，`rsync`并且`rdiff-backup`将是最快的。Git 会花时间处理文件（压缩文件、构建对象等）。

如果您的连接速度较慢，Git 可能会更好，因为您将传输文件的压缩版本。您只需提前处理时间

* * *

如果**安全**是一个问题，请知道您可以使用类似`ssh`的东西作为`rsync`. 当然，这对于 Git 也是可能的。如果使用得当，我会认为这两种工具同样安全。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T23:00:59.413

比较参见[GitSvnComparison](https://git.wiki.kernel.org/index.php/GitSvnComparison)。此外，您可以使用 Mercurial。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-08T11:54:15.410

> *   哪个存储效率更高（占用空间更少）

除非 repo 包含大量二进制项，否则具有相同内容的 Subversion 存储库和 Git 存储库的大小[将相等。](http://svnvsgit.com/#repository-size-myth)在这种情况下，Git 存储库可能比 SVN 存储库占用更多空间。

> *   哪个更可靠（如果 push/committing 时发生崩溃，哪个更好地处理错误）

我投票给 SVN 只是因为使用 Git 的客户端操作可能会破坏存储库或存储库[历史](http://svnvsgit.com/#git-history-is-not-safe)。Subversion 永远不会发生这种情况。推送提交时的崩溃永远不会导致两个系统出现任何问题。

> 哪个做事更快

Git 更快，因为存储库始终是本地的。但是，通过网络克隆 repo 仍然需要一些时间。

在 Subversion 中，您不需要克隆整个存储库；您只需要检查工作区，在大多数情况下，它比克隆 Git 存储库花费的时间更少。

> 哪一个可以更好地处理大型存储库（如果提交的修订太多，性能会更好）

Subversion 比 Git 更适合大型项目和 repos。看

*   [http://svnvsgit.com/#git-scalability-for-larger-project-myth](http://svnvsgit.com/#git-scalability-for-larger-project-myth)
*   [http://svnvsgit.com/#git-scalability-for-larger-teams-myth](http://svnvsgit.com/#git-scalability-for-larger-teams-myth)

# php - 从子类访问外部初始化的父类的属性

> ID：14095483
> 
> 赞同：0
> 
> 时间：2012-12-30T22:46:31.703
> 
> 标签：php, oop, inner-classes

父类是从子类外部构造的，因此不能从子类内部调用它的构造函数。在这种情况下，应该如何从孩子那里访问父母的属性。

例子：

```
class MyParent {
    protected $args;
    protected $child;

    public function MyParent($args=false){
        $this->args=$args;
        $this->child=new MyChild();
    }
    public function main(){
        $this->child->printArgs();
    }
}

class MyChild extends MyParent{
    public function MyChild(){}
    public function printArgs(){
        Echo "args: ".$this->args['key']." = ".$this->args['value']."\n";
    }
}

$parent=new MyParent(array('key'=>'value'));
$parent->main(); 
```

运行时返回空变量：

```
jgalley@jgalley-debian:~/code/otest$ php run.php 
args:  = 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:54:37.167

`__construct()`是构造函数。您正在使用古代 PHP4 时代的变体。

您实例化了两个完全不同的对象，因此该属性当然`$args`是完全独立的。

```
abstract class MyParent {
    protected $args;

    public function __construct($args=false){
        $this->args=$args;
    }
    public function main(){
        $this->printArgs();
    }
    abstract public function printArgs();
}

class MyChild extends MyParent{
    public function printArgs(){
        Echo "args: ".$this->args['key']." = ".$this->args['value']."\n";
    }
}

$$object=new MyChild(array('key'=>'value'));
$object->main(); 
```

这至少可行，但问题是，我不确切知道设计目标是什么。因为它似乎是一种 cli-Application，所以您应该查看现有的解决方案以了解如何解决它。

# android - 为什么我不能只计算屏幕尺寸并调整图像大小？

> ID：14095486
> 
> 赞同：0
> 
> 时间：2012-12-30T22:47:08.853
> 
> 标签：android, image-resizing, image-scaling

我发现很多人问如何调整图像以适应设备屏幕的问题和答案，我心想——如果我能获得设备分辨率，使用

```
 Display display = ((WindowManager)getSystemService(WINDOW_SERVICE)).getDefaultDisplay();
    int screenWidth = display.getWidth();
    int screenHeight = display.getHeight(); 
```

为什么我不能按屏幕的 1/5 来缩放/调整图像大小？这样我就可以做到让我们说 1/5 的空间 2/5 的图像和另外 1/5 的文本，它应该适合所有设备，我在这里错过了什么吗？

还有为什么我会在此代码中收到“已弃用”警告？

对不起我的英语并提前感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:50:08.677

在 Android 中，您的应用程序可能不会覆盖整个屏幕。即使您禁用标题栏/状态栏等，您仍然可以拥有特定于设备的 chrome（如 Android 3.0 中的屏幕按钮）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T01:29:22.937

> 为什么我不能按屏幕的 1/5 来缩放/调整图像大小？

你可以，如果你想让你的图像占据屏幕大小的一些相对量，那么这个和使用`LinearLayout`权重（正如其他人指出的那样）可能是你唯一的选择。请注意，您可能不想在主 UI 线程上进行任何图像缩放，并且您应该尝试尽可能高效地进行。查看一些良好做法[的指南](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)。

另请注意，屏幕宽度（尤其是屏幕高度）不一定是您的图像和/或 UI 可用的空间量。可能存在强制执行的边距/填充，或存在其他组件；例如动作栏。

> 还有为什么我会在此代码中收到“已弃用”警告？

请参阅文档以获取[`Display.getHeight()`](http://developer.android.com/reference/android/view/Display.html#getHeight%28%29)或[`Display.getWidth()`](http://developer.android.com/reference/android/view/Display.html#getWidth%28%29)：

> *此方法在 API 级别 13 中已弃用。请[`getSize(Point)`](http://developer.android.com/reference/android/view/Display.html#getSize%28android.graphics.Point%29)改用。*

基本上谷歌已经告诉开发者它可能会在未来的平台版本中停止支持上述方法。因此，您应该尽可能远离它们。大多数开发人员最终会编写自己的辅助方法，该方法在旧平台（本例中为 API 级别 13 之前）和`getSize(...)`新平台上使用已弃用的方法。您可以将[`Build.VERSION_CODES`](http://developer.android.com/reference/android/os/Build.VERSION_CODES.html)用于此目的。

# r - 在R中的谷歌地图上绘制多个点的坐标

> ID：14095495
> 
> 赞同：3
> 
> 时间：2012-12-30T22:48:28.677
> 
> 标签：r, google-maps, plot, ggplot2, ggmap

我想在存在点 id 的情况下在谷歌地图上绘制坐标：

数据样本：

```
 coordinates      id      
1   (7.1735, 45.8688)       2    
2  (7.17254, 45.8689)       3     
3  (7.17164, 45.8692)       4    
4  (7.18018, 45.8716)       5    
5  (7.17807, 45.8701)       6     
6  (7.17723, 45.8692)       7    
7  (7.17524, 45.8681)       8     
8  (7.18141, 45.8718)       9     
9   (7.1793, 45.8702)      10     
10 (7.17836, 45.8707)      11     
11 (7.17519, 45.8697)      12     
12 (7.17938, 45.8708)      13     
13 (7.17551, 45.8693)      14    
14 (7.17684, 45.8694)      15     
15 (7.18099, 45.8726)      17     
16 (7.18015, 45.8725)      18     
17 (7.18122, 45.8736)      19     
18 (7.17491, 45.8692)      20     
19 (7.15497, 45.8706)      25    
20  (7.1534, 45.8695)      28     
21 (7.15265, 45.8699)      29    
22   (7.15442, 45.87)      31    
23  (7.1561, 45.8698)      32     
24    (7.184, 45.896)  GSBi_1  
25     (7.36, 45.901) GSBi__1  
26    (7.268, 45.961) GSBj__1  
27    (7.276, 45.836)  GSBj_1 
28    (7.272, 45.899)     GSB  
29 (7.16667, 45.8667)   GSB_r 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-01T01:55:48.690

而不是从谷歌请求“瑞士”的地图，您应该通过指定经度/纬度和所需的缩放（可能还有比例）来请求特定位置的地图。这样您就不必使用`coord_map()`和模糊您的图像。

这是基础知识，您可以像在任何 ggplot 中一样使用颜色和大小：

```
library(ggplot2)
library(ggmap)

# copying text off screen
# since the OP did not use dput()
data<-read.table("clipboard")

# reformat
data=data[,-1]
names(data)=c("lon","lat","id")
data$lon <- as.numeric(gsub('[\\(\\)\\,]', '', data$lon))
data$lat <- as.numeric(gsub('[\\(\\)\\,]', '', data$lat))

head(data)
#       lon     lat id   
# 1 7.17350 45.8688  2  
# 2 7.17254 45.8689  3 
# 3 7.17164 45.8692  4 
# etc

# determine a reasonable center for map, 
# this could fail in some places (near poles, 180th meridian)
# also google appears to shift things slightly
 center = paste(min(data$lat)+(max(data$lat)-min(data$lat))/2,
                min(data$lon)+(max(data$lon)-min(data$lon))/2, sep=" ")

# get map image from google
map <- get_map(location = center, zoom = 11, maptype = "terrain", 
       source = "google")

# start a ggplot. it won't plot til we type p
p <- ggmap(map)

# add text labels, these will overlap
p <- p + geom_text(data=data,aes(x = lon, y = lat, 
         label = id),
         colour="white",size=4,hjust=0, vjust=0)+
    theme(legend.position = "none") 

# add points last so they are on top
p <- p + geom_point(data=data,aes(x=lon, y=lat),colour="white",size=2)

# display plot
p 
```

![在此处输入图像描述](../Images/6c2dd6399bb4a521d1f3a06874f02a88.png)

这自然在`?get_map`和中进行了描述`?get_googlemap`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T08:04:51.860

绘制点的问题之一是，如果您`zoom=10`在函数中使用，`get_map()`那么您的点在地图之外并且想要绘制，所以我`zoom=5`改用了。

```
 library(ggmap)
    map <- get_map(location = 'Switzerland', zoom = 5, 
        maptype = "terrain",  source = "google") 
```

对于地图的绘制，我使用了 function `ggmap()`。`geom_point()`可以用来加点。为此，您的样本数据被保存为带有和`df`列`x`的数据框。可以使用缩放更接近点。`y``id``coord_map()`

```
 p <- ggmap(map)
    p <- p +geom_point(data=df,aes(x=x,y=y))+
      coord_map(xlim=c(7,8),ylim=c(45.5,46))
    print(p) 
```

如果您需要为每个点添加标签，则将此线添加到地图`p`

```
annotate("text",x=df$x,y=df$y,label=df$id) 
```

![在此处输入图像描述](../Images/0a1abef7af45e348d0a5a74b66d27534.png)

# haskell - 使用元组列表

> ID：14095496
> 
> 赞同：2
> 
> 时间：2012-12-30T22:48:37.087
> 
> 标签：haskell, tuples

我一直在尝试解决这个问题，但我就是想不通。所以，我有一个包含元组的列表，例如：

```
[("Mary", 10), ("John", 45), ("Bradley", 30), ("Mary", 15), ("John", 10)] 
```

我想要得到的是一个包含元组的列表，如果名称相同，则应添加这些元组的数字，如果不是，则该元组也必须是最终列表的一部分，例如：

```
[("Mary",25), ("John", 55), ("Bradley", 30)] 
```

我不知道我是否真的很好地解释了自己，但我想你可能会通过这些例子理解。

我试过这个，但它不起作用：

```
test ((a,b):[]) = [(a,b)]
test ((a,b):(c,d):xs) | a == c = (a,b+d):test((a,b):xs)
                      | otherwise = (c,d):test((a,b):xs) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T23:09:33.967

用列表做这种事情总是很尴尬，因为它们的顺序性——它们并不适合像“查找匹配项”或“通过组合列表元素的特定组合来计算新列表”或其他事情这样的操作本质上是非连续的。

如果你退后一步，你真正想做的是，对于`String`列表中的每个不同，找到与其关联的所有数字并将它们相加。这听起来更适合键值样式数据结构，Haskell 中最标准的数据结构在[中找到`Data.Map`](http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map.html)，它为您提供任何值类型和任何有序键类型（即 的实例）的键值映射`Ord`。

因此，要从您的列表中构建一个`Map`，您可以使用 ... 中的`fromList`函数，`Data.Map`它方便地期望以键值元组列表的形式输入。所以你可以这样做...

```
import qualified Data.Map as M

nameMap = M.fromList [("Mary", 10), ("John", 45), ("Bradley", 30), ("Mary", 15), ("John", 10)] 
```

...但这不好，因为直接插入它们会覆盖数字而不是添加它们。您可以[使用`M.fromListWith`指定在插入重复键时如何组合值](http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#v%3afromListWith)- 在一般情况下，通常使用它来为每个键或类似事物构建值列表。

但在您的情况下，我们可以直接跳到所需的结果：

```
nameMap = M.fromListWith (+) [("Mary", 10), ("John", 45), ("Bradley", 30), ("Mary", 15), ("John", 10)] 
```

如果找到新名称，它将直接插入，否则它将在副本上添加值（数字）。如果您愿意，可以使用以下命令将其转回元组列表`M.toList`：

```
namesList = M.toList $ M.fromListWith (+) [("Mary", 10), ("John", 45), ("Bradley", 30), ("Mary", 15), ("John", 10)] 
```

这给了我们一个最终的结果`[("Bradley",30),("John",55),("Mary",25)]`。

但是，如果您想对名称/数字的集合做更多的事情，那么在完成之前将其保留为 a 可能更有意义`Map`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T00:25:23.230

这是使用列表的另一种方式：

```
import Data.List

answer :: [(String, Int)] -> [(String, Int)]
answer = map (foo . unzip) . groupBy (\x y -> fst x == fst y) . sort            
   where foo (names, vals) = (head names, sum vals) 
```

这是一个相当简单的方法。首先，点`(.)`表示函数组合，它允许我们将值从一个函数传递到下一个函数，即一个函数的输出成为下一个函数的输入，以此类推。我们首先应用`sort`它将自动将列表中的名称彼此相邻移动。接下来，我们使用`groupBy`将具有相似名称的每一对放入一个列表中。我们最终得到一个列表列表，每个列表都包含具有相似名称的对：

`[[("Bradley",30)], [("John",10),("John",45)], [("Mary",10),("Mary", 15)]]`

给定这样一个列表，您将如何处理每个子列表？也就是说，您将如何处理包含所有相同名称的列表？

显然，我们希望将它们缩小为一对，其中包含名称和值的总和。为了实现这一点，我选择了 function `(foo . unzip)`，但还有很多其他方法可以实现。 `unzip`获取对列表并创建一个对。该对包含 2 个列表，第一个包含所有名称，第二个包含所有值。这对然后通过`foo`函数组合的方式传递给，如前所述。 `foo`使用模式将其分开，然后应用于`head`名称，仅返回一个名称（它们都相同），并应用于`sum`值列表。`sum`是另一个标准的列表函数，它自然地对列表中的值求和。

但是，这`(foo . unzip)`仅适用于单个对列表，但我们有一个列表列表。这就是`map`进来的地方。 `map`将我们的`(foo . unzip)`函数应用于列表中的每个列表，或者更一般地，列表中的每个元素。我们最终得到一个列表，其中包含应用于`(foo . unzip)`每个子列表的结果。

我建议查看`Data.List`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T23:14:36.587

我认为您的潜在解决方案不起作用的原因是，如果它们以列表中的相同键顺序出现，它只会将元素组合在一起。因此，我将使用映射（如果您使用过其他语言，通常称为字典）来记住我们看到的键并保留总数。首先我们需要导入我们需要的函数。

```
import Data.Map hiding (foldl, foldl', foldr)
import Data.List (foldl') 
```

现在我们可以沿着列表折叠，并为每个键值对相应地更新我们的地图。

```
sumGroups :: (Ord k, Num n) => [(k, n)] -> Map k n
sumGroups list = foldl' (\m (k, n) -> alter (Just . maybe n (+ n)) k m) empty list 
```

因此， foldl' 使用函数遍历列表。它使用每个元素（此处为 (k, n) 对）和另一个参数累加器调用该函数。这是我们的地图，一开始是空的。对于每个元素，我们使用 Maybe n -> Maybe n 的函数来更改映射。这反映了地图可能在键 k 下可能没有任何内容的事实 - 所以我们处理这两种情况。如果没有前一个值，我们只返回 n，否则我们将 n 添加到前一个值。这给了我们一个最后的地图，其中应该包含组的总和。对结果调用 toList 函数应该会为您提供所需的列表。

在 ghci 中对此进行测试给出：

```
 $ ghci
GHCi, version 7.6.1: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
Prelude> import Data.Map hiding (foldl, foldl', foldr)
Prelude Data.Map> import Data.List (foldl')
Prelude Data.Map Data.List> let sumGroups list = foldl' (\m (k, n) -> alter (Just . maybe n (+ n)) k m) empty list
Loading package array-0.4.0.1 ... linking ... done.
Loading package deepseq-1.3.0.1 ... linking ... done.
Loading package containers-0.5.0.0 ... linking ... done.
Prelude Data.Map Data.List> toList $ sumGroups $ [("Mary", 10), ("John", 45), ("Bradley", 30), ("Mary", 15), ("John", 10)]
[("Bradley",30),("John",55),("Mary",25)]
Prelude Data.Map Data.List> 
```

作为奖励，这些组按排序顺序出现，因为内部 map 使用一种二叉树形式，因此按顺序遍历并输出排序（好吧，无论如何按键排序）列表相对简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T12:10:27.640

这是我的两分钱。仅使用 Haskell Prelude。

```
test tup = sumAll
  where
    collect ys [] = ys
    collect ys (x:xs) =
        if (fst x) `notElem` ys
        then collect (fst x : ys) xs
        else collect ys xs
    collectAllNames = collect [] tup

    sumOne [] n x = (x, n)
    sumOne (y:ys) n x =
        if fst y == x
        then sumOne ys (n + snd y) x
        else sumOne ys n x

    sumAll = map (sumOne tup 0) collectAllNames 
```

该方法多次遍历原始列表。Collect 构建一个仅包含名称的临时列表，跳过名称重复。sumOne 取一个名称，检查列表中匹配的名称，然后添加它们的数字。它返回名称和总和。

# ruby-on-rails - 我想在 Ruby on Rails 上使用 distinct 或 group 执行此 sql

> ID：14095506
> 
> 赞同：0
> 
> 时间：2012-12-30T22:50:00.083
> 
> 标签：ruby-on-rails, ruby

我想在 Ruby on Rails 上执行这个 sql（使用包含或连接），我有这个：

```
@info = Ranking.all(:joins => :user, :select => "ranking.idNick, ranking.nickname, user.data1, user.data2" ). 
```

`@info`当我在我的视图中使用它时，它可以工作但没有分组或不同。

```
select
  ranking.id, 
  ranking.nickname, 
  user.data1, 
  user.data2 
from  
  ranking 
  inner join user
where ranking.idNick = user.id 
```

# big-o - 谁能解释一下 Big O 与 Big Omega 与 Big Theta 的关系？

> ID：14095510
> 
> 赞同：54
> 
> 时间：2012-12-30T22:50:13.750
> 
> 标签：big-o, discrete-mathematics

> **可能重复：**
> [Big Theta Notation - big Theta 到底代表什么？](https://stackoverflow.com/questions/10376740/big-theta-notation-what-exactly-does-big-theta-represent)

我想我在理论上理解它，但我难以理解的是这三个的应用。

在学校里，我们总是用大 O 来表示算法的复杂度。例如，冒泡排序是 O(n^2)。

现在，在阅读了更多理论之后，我发现 Big Oh 并不是唯一的衡量标准，至少还有另外两个有趣的衡量标准。

但这是我的问题：

Big O 是上限，Big Omega 是下限，Big Theta 是两者的混合。但这在概念上意味着什么？我明白它在图表上的含义；我已经看到了一百万个这样的例子。但这对算法复杂性意味着什么？“上限”或“下限”如何与之混合？

我想我只是没有得到它的应用程序。我知道如果乘以某个常数 c，如果在某个值 n_0 f(x) 大于 g(x) 之后，f(x) 被认为是 O(g(x))。但这实际上意味着什么？为什么我们要将 f(x) 乘以某个值 c？见鬼，我认为大 O 符号的倍数并不重要。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-30T23:30:29.370

大 O 表示法及其亲属，大 Theta、大 Omega、小 o 和小 Omega 是表达函数在极限点的行为方式（例如，当接近无穷大时，也接近0等），而无需多说有关该功能的其他信息。它们通常用于描述算法的运行空间和时间，但也可以在有关渐近行为的其他数学领域中看到。

半直观的定义如下：

如果“从某个点开始”，g(x) 低于 c*f(x)，则函数 g(x) 被称为 O(f(x))，其中 c 是某个常数。

其他定义类似，Theta 要求 g(x) 介于 f(x) 的两个常数倍数之间，Omega 要求 g(x)>c*f(x)，而小版本要求这对所有此类都是正确的常数。

但是为什么说一个算法的运行时间为 O(n^2) 会很有趣呢？

这很有趣，主要是因为在理论计算机科学中，我们最感兴趣的是算法如何处理大输入。这是真的，因为在小输入上，算法运行时间可能会因实现、编译、硬件和其他在理论上分析算法时并不真正有趣的事情而有很大差异。

然而，增长率通常取决于算法的性质，要改进它，您需要对您要解决的问题有更深入的了解。例如，排序算法就是这种情况，您可以获得一个简单的算法（冒泡排序）以在 O(n^2) 中运行，但要将其改进为 O(n log n)，您需要一个真正的新想法，例如在合并排序或堆排序中介绍的。

另一方面，如果你有一个算法在 5n 秒内运行，而另一个在 1000n 秒内运行（例如，n=3 时长打哈欠和发射中断之间的差异），当你到达n=1000000000000，规模差异似乎不那么重要。但是，如果您有一个需要 O(log n) 的算法，则您必须等待 log(1000000000000)=12 秒，也许乘以某个常数，而不是将近 317,098 年，无论常数有多大是，是完全不同的尺度。

我希望这能让事情变得更清楚一些。祝你学业顺利！

# python - Python中的BeautifulSoup - 获取类型的第n个标签

> ID：14095511
> 
> 赞同：15
> 
> 时间：2012-12-30T22:50:23.250
> 
> 标签：python, beautifulsoup

我有一些 html 代码，其中包含许多`<table>`s。

我正在尝试获取第二个表中的信息。有没有办法在不使用的情况下做到这一点`soup.findAll('table')`？

当我使用`soup.findAll('table')`时，我得到一个错误：

```
ValueError: too many values to unpack 
```

有没有办法在某些代码中获取第 n 个标签，或者不需要通过所有表的其他方式？或者我应该看看我是否可以在表格中添加标题？（喜欢`<table title="things">`）

`<h4>title</h4>`如果有帮助，每个表格上方还有标题 ( )。

谢谢。

**编辑**

这是我问这个问题时的想法：

当有更多时，我将对象解压缩为两个值。我认为这只会给我列表中的前两件事，但当然，它一直给我上面提到的错误。我不知道返回值是一个列表，并认为它是一个特殊的对象或其他东西，我的代码是基于我朋友的。

我在想这个错误意味着页面上有太多的表格并且它不能处理所有的表格，所以我在寻求一种没有我正在使用的方法的方法来做到这一点。我可能应该停止假设事情。

现在我知道它返回一个列表，我可以在 for 循环中使用它或使用`soup.findAll('table')[someNumber]`. 我也了解了解包是什么以及如何使用它。感谢所有帮助过的人。

希望这可以解决问题，既然我知道我在做什么，我的问题比我问它时的意义要小，所以我想我只是在这里写下我的想法。

**编辑2：**

这个问题现在已经很老了，但我仍然看到我从来没有真正清楚自己在做什么。

如果它对任何人有帮助，我试图解开`findAll(...)`结果，其中的数量我不知道。

```
useless_table, table_i_want, another_useless_table = soup.findAll("table"); 
```

由于页面中并不总是有我猜到的表格数量，并且元组中的所有值都需要解包，所以我收到了`ValueError`：

```
ValueError: too many values to unpack 
```

因此，我一直在寻找方法来获取返回的元组中的第二个（或任何一个索引）表，而不会遇到有关使用了多少表的错误。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-30T22:58:31.783

要从 call 中获取第二个表，请将`soup.findAll('table')`其用作列表，只需对其进行索引：

```
secondtable = soup.findAll('table')[1] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-03T17:13:48.727

Martjin Pieter 的回答将使它确实有效。我有一些使用嵌套`table`标签的经验，当我只是简单地获取列表中的第二个表而不注意时，它破坏了我的代码。

当您尝试`find_all`获取第 n 个元素时，您可能会搞砸，您最好找到您想要的第一个元素，并确保第 n 个元素实际上是该元素的兄弟而不是子元素。

1.  您可以使用`find_next_sibling()`来保护您的代码
2.  您可以先找到父母，然后使用 find_all(recursive=False) 来保证您的搜索范围。

以防万一你需要它。我将在下面列出我的代码（使用 recursive=FALSE）。

```
import urllib2
from bs4 import BeautifulSoup

text = """
<html>
    <head>
    </head>
    <body>
        <table>
            <p>Table1</p>
            <table>
                <p>Extra Table</p>
            </table>
        </table>
        <table>
            <p>Table2</p>
        </table>
    </body>
</html>
"""

soup = BeautifulSoup(text)

tables = soup.find('body').find_all('table')
print len(tables)
print tables[1].text.strip()
#3
#Extra Table # which is not the table you want without warning

tables = soup.find('body').find_all('table', recursive=False)
print len(tables)
print tables[1].text.strip()
#2
#Table2 # your desired output 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-20T18:37:38.473

这是我的版本

```
# Import bs4
from bs4 import BeautifulSoup

# Read your HTML
#html_doc = your html

# Get BS4 object
soup = BeautifulSoup(html_doc, "lxml")

# Find next Sibling Table to H3 Header with text "THE GOOD STUFF"    
the_good_table = soup.find(name='h3', text='THE GOOD STUFF').find_next_sibling(name='table')

# Find Second tr in your table
your_tr = the_good_table.findAll(name='tr')[1]

# Find Text Value of First td in your tr
your_string = your_tr.td.text

print(your_string) 
```

输出：

```
'I WANT THIS STRING' 
```

# php - 可能重复： 参考 - 这个符号在 PHP 中是什么意思？ 问问题 问问题 2012-12-30T22:50:43.330 89 次 This question shows research effort; it is useful and clear -2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 可能重复： 参考 - 这个符号在 PHP 中是什么意思？ 我不知道以前是否有人问过这个问题，但是这里有： , 和 之间有 类似于 phptags 4 1 回答 1 This answer is useful 2 类似于 于 2012-12-30T22:52:45.477 回答 Related 1 view - SAS：查看到表 3 mysql - `Count Distinct` 和 `Group By` 产生奇怪的结果 3 java - 选择枚举类型时方法设计好？ 1 jquery - jQuery flot 插件，绘图和标签顺序 5 java - 使用对象或适当的数据类型 5 android - 在android上检查互联网连接的问题 1 json - Spring中的响应编码 1 python - python和redis，语法不清楚 1 c# - textbox_tapped 事件未在 Metro 应用程序中触发 1 linux - 如何在 IP 地址字符串的末尾附加一个冒号零，:0？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14095514
> 
> 赞同：-2
> 
> 时间：
> 
> 标签：php, tags

> **可能重复：**
> [参考 - 这个符号在 PHP 中是什么意思？](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)

我不知道以前是否有人问过这个问题，但是这里有： , 和 之间有`<?php`什么`<?=`区别`<?`？
我只是好奇，人们一直在告诉我使用`<?php`而不是`<?`，但我只是使用`<?`它，因为它对我有用而且速度更快。我没有看到任何差异（乡下人的口音，以获得额外的乐趣......）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:52:45.477

`<?php`和`<?`是等价的，除了通常首选使用它，`<?php`因为并非每个服务器配置都可能启用短打开 PHP 标记选项。

`<?=`是回显变量/表达式值的快捷方式，即

```
<?=$var ?> 
```

类似于

```
<?php echo $var; ?> 
```

# git - 团队成员向 git 添加了数百个兆

> ID：14095517
> 
> 赞同：8
> 
> 时间：2012-12-30T22:51:04.440
> 
> 标签：git, extra

> **可能重复：**
> [如何删除 github 上的提交？](https://stackoverflow.com/questions/448919/how-can-i-remove-a-commit-on-github)

所以我们项目的一个团队成员已经提交了 700 多兆的废话并将其推送到我们的 git 项目存储库中……她以为她只添加了 2 张图像，但不知何故最终将她桌面的全部内容复制到了 git 文件夹中，不知何故提交它。我不知道为什么她觉得两张照片上传花了 20 分钟并不奇怪...

无论如何，作为这个项目的负责人，我现在陷入了困境。据我所知，我有 2 个选择，我不喜欢任何一个

1.  我可以从 bitbucket 中删除存储库，然后使用我想要的文件重新启动它。这将删除所有以前的编辑，因为只有我想要的文件的当前版本可用

2.  我可以删除错误数据并推送更改。只有我们想要的文件将被进一步管理，但她在那里放置的所有额外的杂物将永远存在于 git 中，使我们的项目膨胀 100 倍。

有什么方法可以真正永久删除提交，就好像它从未发生过一样？除了更多的补救性 git 培训之外，管理这个问题的最佳方法是什么……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:56:54.880

我会做

```
$ git checkout master~1 -b newmaster
$ git branch -D master
$ git reflog expire --expire=now --all
$ git gc --prune=now
$ git checkout -b master
$ git branch -D newmaster 
```

gc 应该做垃圾收集。我认为您可以在服务器上执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:57:47.917

我不知道 bitbucket 是否允许，但你可以这样做：

```
git reset HEAD~
# Or the SHA of the version before the huge commit
git push --force 
```

# r - 在 R 中实例化对象 - 新结构与结构

> ID：14095526
> 
> 赞同：-1
> 
> 时间：2012-12-30T22:52:14.043
> 
> 标签：r, class, instantiation

我已经看到 R 中的类使用

```
x <- structure(1, class = "foo") 
```

来源：[https ://github.com/hadley/devtools/wiki/S3](https://github.com/hadley/devtools/wiki/S3)

并且

```
x <- new("foo", a = 1) 
```

哪个更合适，使用新的还是结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:26:56.900

应该知道，Hadley 在他的 S4 指南中也有一节，他说要使用 new 进行实例化

[https://github.com/hadley/devtools/wiki/S4](https://github.com/hadley/devtools/wiki/S4)

# python - Python 索引使用

> ID：14095528
> 
> 赞同：-3
> 
> 时间：2012-12-30T22:52:13.900
> 
> 标签：python, indexing

下面是一些代码： # 问题 9：Deep Reverse # 定义一个过程 deep_reverse，它将一个列表作为输入， # 并返回一个新列表，该列表是输入列表的深度反向。
# 这意味着它反转列表中的所有元素，如果其中任何一个元素是列表本身，则反转内部列表中的所有元素，一直向下。

```
# Note: The procedure must not change the input list.

# The procedure is_list below is from Homework 6\. It returns True if 
# p is a list and False if it is not.

def is_list(p):
    return isinstance(p, list)

#For example,
def deep_reverse(n):
    n.reverse()
    for entry in n:
        if is_list(entry):
            entry.reverse() 
            deep_reverseA(entry)        
    return n

def deep_reverseA(n):
    for entry in n:
        if is_list(entry):
            entry.reverse() 
            deep_reverseA(entry)          
    return n

p = [1, [2, 3, [4, [5, 6]]]]
print deep_reverse(p)
#>>> [[[[6, 5], 4], 3, 2], 1]
print p
#>>> [1, [2, 3, [4, [5, 6]]]]

q =  [1, [2,3], 4, [5,6]]
print deep_reverse(q)
#>>> [ [6,5], 4, [3, 2], 1]
print q
#>>> [1, [2,3], 4, [5,6]] 
```

我的问题是，一旦我运行代码，p 和 q 的值就会改变。我怎样才能让他们不改变。我知道在 python 中索引是连接的，所以如果 indexA = indexB 并且您更改 indexA 那么 indexB 将会更改。这就是我在解决这个问题时遇到的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:36:24.153

我现在就在这里告诉你答案，并附上解释。

在 python 中，变量只是**指向**存储对象的指针。因此，正如您在帖子中所说，如果您声明`foo = bar`then`foo`不仅等于`bar`，而且`foo` **是** `bar`。`bar = 2`除非您明确表示（例如您设置），否则这不会改变。因此，您需要一种方法来制作原始列表的**副本**。

python 中有一个叫做*list slicing*的东西，我相信你听说过。基本上，您可以从`indexA`to `indexB`with获取列表的一部分`my_list[indexA:indexB]`。

但您也可以将这些空格留空。`indexA`如果未指定，则默认为`0`，并且`indexB`默认为`-1`（列表的最后一个元素）。

所以`my_list[2:]`返回所有元素 from `my_list[2]`to `my_list[-1]`。同样，`my_list[:3]`返回`my_list[0]`。`my_list[3]`

因此，调用会`my_list[:]`返回 的**精确副本**，`my_list`而不是实际列表本身。这是你需要做的。

因此将其应用于您的代码：

```
def deep_reverse(n):
    ncopy = n[:]  #this is the part you need
    #rest of function, replace `n` with `ncopy`
    return ncopy 
```

此外，**不要**将此应用于`deep_reverseA`因为在该函数中您正在更改**复制列表中的****原始**列表。您不会更改您输入的列表。如果您确实将其应用于，则列表实际上不会更改（您将返回*副本*的反面，而不是原件）**`deep_reverse``deep_reverseA`**

# c# - 我应该使用哪个版本的 csc.exe？

> ID：14095540
> 
> 赞同：1
> 
> 时间：2012-12-30T22:54:20.910
> 
> 标签：c#, windows-8, csc

我正在按照教程在 C# 应用程序中使用 WSDL：

```
http://my.execpc.com/~gopalan/dotnet/webservices/webservice_csharp_client.html 
```

在第 2 步，它说执行以下操作：

```
C:\MyProjects\Cornucopia\WebService\Client>csc /t:library /r:System.Web.Services.dll /r:System.Xml.dll OIDServer.cs 
```

但是 csc.exe 不在我的路径中，所以我搜索了它并得到了结果：

![在此处输入图像描述](../Images/4ec532e2557cabe6ab756ef17ff41675.png)

我的电脑中有 20 个不同的 csc.exe。我应该使用哪一个？我正在运行 Windows 8 x64 EE。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:59:12.767

通常你想使用`C:\WINDOWS\Microsoft.NET\Framework\vx.x.xxxxx\`.

其中 xxxxxxx 是您所针对的框架版本。因此，如果我尝试使用 C# 4.0 编译器，我会使用“C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T22:57:19.883

只需按下`Start`然后开始输入“Developer”并选择**Developer Command Prompt for VS2012**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T23:16:25.830

正如 vcjones 所说，使用 .NET Framework 目录中具有您想要支持的最低 .NET Framework 版本的那个。

其他 csc.exe 只是 .NET Framework 的备份，存储在由 MSI 安装程序安装的 WinSxs 文件夹中。由于 .NET Framework 是操作系统的一部分，因此 WinSXS 文件夹中始终存在一个备份，以便在发生坏事时能够进行恢复。但由于 .NET Framework 确实使用了不同的位置

%Windir%\Microsoft.NET...

现在我们有两个 .NET Framework 文件所在的位置。您确实看到的其他版本是 .NET Framework 的不同补丁级别，它们出于“向后”兼容原因保留在 WinSxs 中，这对于 .NET Framework 部件但对于非托管 dll 没有意义。

# httpwebrequest - .NET HttpClient 在多次请求后挂起（除非 Fiddler 处于活动状态）

> ID：14095545
> 
> 赞同：9
> 
> 时间：2012-12-30T22:55:10.223
> 
> 标签：httpwebrequest, dotnet-httpclient

我`System.Net.Http.HttpClient`用于将来自控制台应用程序的一系列请求发布到 REST API，并将 JSON 响应反序列化为强类型对象。我的实现是这样的：

```
using (var client = new HttpClient())
{
    var content = new StringContent(data, Encoding.UTF8, "text/html");
    var response = client.PostAsync(url, content).Result;

    response.EnsureSuccessStatusCode();

    return response.Content.ReadAsAsync<MyClass>().Result;
} 
```

但是，我遇到了一个与[此问题中描述的问题非常相似的问题](https://stackoverflow.com/questions/1030218)，即当请求通过 Fiddler 路由时一切正常，但当 Fiddler 被禁用时，它在第 4 或第 5 个请求后挂起。

如果问题的原因是相同的，我认为我需要做更多的事情`HttpClient`来让它在每次请求后完全释放其资源，但我无法找到任何代码示例来说明如何做到这一点。

希望有人能指出我正确的方向。

非常感谢，

蒂姆

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T15:10:11.323

您没有处理该`HttpResponseMessage`对象。这可以将打开的流留给服务器，并且在单个服务器的一些流配额被填充后，将不再发送请求。

```
using (var client = new HttpClient())
{
    var content = new StringContent(data, Encoding.UTF8, "text/html");
    using(var response = client.PostAsync(url, content).Result)
    {    
        response.EnsureSuccessStatusCode();
        return response.Content.ReadAsAsync<MyClass>().Result;
    }
} 
```

# c++ - 如何迭代 std::list

> ID：14095548
> 
> 赞同：0
> 
> 时间：2012-12-30T22:55:42.800
> 
> 标签：c++, iterator, std

我有这个清单：

```
std::list<AbstractType*> myList; 
```

我如何迭代它，抓取每个对象并将它们的一些操作作为普通实例执行？

在 Java 中，它会是这样的：

```
foreach(AbstractType object in myList)
    object.method(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T22:58:25.787

C++ 代码几乎相同：

```
for (AbstractType* object: myList)
    object->method(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T23:06:08.790

如果您使用的是 C++11，请参阅 @Mankarse 或 @billz 的答案。

如果你使用的是 C++98，那么你应该像下面的例子那样做（或者通过一个等效的`while`循环：

```
#include <list>
#include <iostream>

int main()
{
    std::list<AbstractType*> l;
    // ...
    for (std::list<AbstractType*>::iterator i = l.begin(); i != l.end(); i++)
    {
        (*i)->DoSomething();
    }

    return 0;
} 
```

**编辑**

正如@Mankarse 在评论中指出的那样，在 C++98 中，您还可以使用 BOOST_FOREACH：

```
BOOST_FOREACH(AbstractType* pObject, l)
{
    pObject->DoSomething();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:57:53.313

使用 C++ STL 你有一个迭代器。在你定义它之后，你使用 begin() 和 end() 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T00:08:50.707

如果不使用 C++ 11，您可以创建一个自由函数`AbstractType`并使用以下命令调用它`std::for_each`：

```
void doSomething(AbstractType& object) {
    object.doSomething();
}

int main() {
    // ...
    std::for_each(objects.begin(), objects.end(),
                  doSomething);
    // ...
} 
```

# c# - 将 short 转换为枚举然后转换为字符串有什么意义？

> ID：14095552
> 
> 赞同：3
> 
> 时间：2012-12-30T22:56:12.740
> 
> 标签：c#, refactoring

我正在查看并试图了解[DnDns](http://dndns.codeplex.com/)项目，这是一个非常令人印象深刻的项目，但我遇到了一种方法，我不明白它背后的原因。

```
public static string GetServByPort(short port, ProtocolType proto)
{
    StringBuilder ans = new StringBuilder();

    switch (proto)
    {
        case ProtocolType.Tcp: 
        {
            TcpServices tcps;
            tcps = (TcpServices)port;
            ans.Append(tcps);
            ans.Append("(");
            ans.Append(port);
            ans.Append(")");
            break;
        }
        case ProtocolType.Udp:
        {
            UdpServices udps;
            udps = (UdpServices)port;
            ans.Append(udps);
            ans.Append("(");
            ans.Append(port);
            ans.Append(")");
            break;
        }
        default:
        {
            ans.Append("(");
            ans.Append(port);
            ans.Append(")");
            break;
        }
    }
    return ans.ToString();
} 
```

TcpServices 和 UdpServices 是枚举。这里是 TcpServices：

```
public enum TcpServices : short
{
    /// <summary>
    /// Domain Name Server Port
    /// </summary>
    Domain = 53
} 
```

这是 Udp 服务：

```
public enum UdpServices : short
{
    /// <summary>
    /// Domain Name Server Protocol Port
    /// </summary>
    Domain = 53
} 
```

假设端口号是 1。如果协议类型是 TCP 或 UDP，输出将是：

> 1(1)

如果协议类型是其他类型，则输出如下：

> (1)

因此，我想为我的项目重写这个方法（仍然完全归功于原始开发人员等）：

```
private static string GetServerByPort(short port, ProtocolType protocolType)
{
    if (protocolType == ProtocolType.Tcp || protocolType == ProtocolType.Udp)
    {
        return string.Format("{0}({0})", port);
    }

    return string.Format("({0})", port);
} 
```

我编写了以下简短的控制台应用程序进行测试：

```
using System;
using System.Net.Sockets;

namespace ConsoleApplication4
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(GetServByPort(1, ProtocolType.Tcp));
            Console.WriteLine(GetServByPort(2, ProtocolType.Udp));
            Console.WriteLine(GetServByPort(3, ProtocolType.SpxII));

            Console.ReadLine();
        }

        public static string GetServByPort(short port, ProtocolType proto)
        {
            switch (proto)
            {
                case ProtocolType.Tcp:
                    return string.Format("{0} ({1})", (TcpServices)port, port);
                case ProtocolType.Udp:
                    return string.Format("{0} ({1})", (UdpServices)port, port);
                default:
                    return string.Format("({0})", port);
            }
        }
    }

    public enum UdpServices : short
    {
        Domain = 53
    }

    public enum TcpServices : short
    {
        Domain = 53
    }
} 
```

这是我的输出：

![截屏](../Images/d49ec8c5c3a3f64f03fe1406775b96b1.png)

但是我不禁认为开发人员出于我没有看到的原因而使用了所有这些复杂性。

我的问题是我按照我计划的方式重构这个方法是否正确，或者我没有看到原始开发人员这样做的方式是否有充分的理由，如果我这样做会导致我的问题更简单的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T22:59:47.303

调用`ToString()`枚举将使用枚举值*名称*（如果有的话）。（当没有相应的命名值时，它将给出数字版本。）例如，在您的`TcpServices`情况下，如果值为 53，则结果将`Domain (53)` 在原始代码中 - 但`53 (53)`在您建议的替换代码中。

不过，在这里使用 a 没有意义`StringBuilder`。我将原始方法重写为：

```
public static string GetServByPort(short port, ProtocolType proto)
{
    switch (proto)
    {
        case ProtocolType.Tcp: 
            return string.Format("{0} ({1})", (TcpServices) port, port);
        case ProtocolType.Udp:
            return string.Format("{0} ({1})", (UdpServices) port, port);
        default:
            return string.Format("({0})", port);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T23:00:12.027

对于知名服务，您的输出将如下所示：

```
Domain (53)
HTTP (80)
HTTPS (445)
FTP (21) 
```

等等。虽然未知的会像你展示的那样：

```
1 (1)
2 (2) 
```

等等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T22:59:51.623

如果该值实际上是枚举成员之一，则该函数将返回类似“Domain(53)”而不是“53(53)”的内容。`StringBuilder`本质上调用`ToString`将返回值名称的所有内容和枚举值（如果存在）（否则为数字）。

如果你想重构其中的一些代码，你可以将通用的“（端口）”部分移到开关之外，完全删除默认情况，并去掉不需要的临时变量。IE：

```
public static string GetServByPort(short port, ProtocolType proto)
{
    StringBuilder ans = new StringBuilder();

    switch (proto)
    {
        case ProtocolType.Tcp: 
            ans.Append((TcpServices)port);
            break;
        case ProtocolType.Udp:
            ans.Append((UdpServices)port);
            break;
    }

    ans.Append("(").Append(port).Append(")");

    return ans.ToString();
} 
```

# jquery - getJSON 中的 jQuery 解析错误

> ID：14095558
> 
> 赞同：0
> 
> 时间：2012-12-30T22:57:25.597
> 
> 标签：jquery, getjson

在使用 ProductWiki API 搜索产品时，我遇到了 JSON 解析错误。如果我遗漏了什么或者返回的数据格式不正确，你能告诉我吗？

这是我正在使用的 JavaScript 代码

```
var searchUrl = "http://api.productwiki.com/connect/api.aspx?" +
            "&op=search" +
            "&key=" + API_KEY_PRODUCT_WIKI +
            "&q=" + nugget +
            "&format=json" +
            "&jsoncallback=?";

 $.getJSON(searchUrl, function (data) { alert("Got data"); }); 
```

在执行代码时，我从 productwiki 获取以下数据

```
{"__type":"ProductWiki.DataStructures.API.Schema.pw_api_results, ProductWiki.DataStructures, Version=1.0.4622.22636, Culture=neutral, PublicKeyToken=null","message":null,"num_results":2,"products":[{"__type":"ProductWiki.DataStructures.API.Schema.product, ProductWiki.DataStructures, Version=1.0.4622.22636, Culture=neutral, PublicKeyToken=null","url":"http://www.productwiki.com/microsoft-surface/","id":15113,"title":"Microsoft Surface","description":null,"proscore":"41","number_of_reviews":"13","category":"Computers","key_features":[],"images":[{"__type":"ProductWiki.DataStructures.API.Schema.image, ProductWiki.DataStructures, Version=1.0.4622.22636, Culture=neutral, PublicKeyToken=null","title":"Microsoft Surface","rawimage":"http://images.productwiki.com/upload/images/microsoft_surface.jpg","largeimage":"http://images.productwiki.com/upload/images/microsoft_surface-400-400.jpg","mediumimage":"http://images.productwiki.com/upload/images/microsoft_surface-100-100.jpg","smallimage":"http://images.productwiki.com/upload/images/microsoft_surface-60-60.jpg"}],"community_review":null,"reviews":null,"tags":null,"competitors":null,"related":null,"skus":null},{"__type":"ProductWiki.DataStructures.API.Schema.product, ProductWiki.DataStructures, Version=1.0.4622.22636, Culture=neutral, PublicKeyToken=null","url":"http://www.productwiki.com/menotek-flexible-bluetooth-waterproof-mini-keyboard/","id":59084,"title":"Menotek Flexible Bluetooth Waterproof Mini Keyboard","description":null,"proscore":"62","number_of_reviews":"1","category":"Keyboards","key_features":[],"images":[{"__type":"ProductWiki.DataStructures.API.Schema.image, ProductWiki.DataStructures, Version=1.0.4622.22636, Culture=neutral, PublicKeyToken=null","title":"Menotek Flexible Bluetooth Waterproof Mini Keyboard","rawimage":"http://images.productwiki.com/upload/images/menotek_flexible_bluetooth_waterproof_mini_keyboard.jpg","largeimage":"http://images.productwiki.com/upload/images/menotek_flexible_bluetooth_waterproof_mini_keyboard-400-400.jpg","mediumimage":"http://images.productwiki.com/upload/images/menotek_flexible_bluetooth_waterproof_mini_keyboard-100-100.jpg","smallimage":"http://images.productwiki.com/upload/images/menotek_flexible_bluetooth_waterproof_mini_keyboard-60-60.jpg"}],"community_review":null,"reviews":null,"tags":null,"competitors":null,"related":null,"skus":null}]} 
```

但它也会引发 jquery 错误

```
JavaScript critical error at line 1, column 10 in http://api.productwiki.com/connect/api.aspx?&op=search&key=***&q=microsoftsurface&format=json&jsoncallback=jQuery18308245886188083906_1356907329390&_=1356907329577

SCRIPT1004: Expected ';' 
```

[我尝试在JSON Formatter & validator 验证](http://jsonformatter.curiousconcept.com/)来自 productwiki 的响应，但没有发现任何问题。想知道我是否遗漏了什么，或者产品 wiki 中的数据格式不正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T02:33:26.620

我认为productwiki 不支持jsonp。我最终从服务器端访问了他们的 API

# zend-framework - ZendAMF 如何获取服务请求名称？

> ID：14095564
> 
> 赞同：0
> 
> 时间：2012-12-30T22:58:04.740
> 
> 标签：zend-framework, zend-amf

我正在使用 Zend 框架 - ZendAMF 库。我试图弄清楚如何获取被调用服务的名称。

例如，一个基本的 Zend AMF PHP 脚本可能看起来像这样（根据这些文档）：

```
$server = new Zend_Amf_Server();
$server->addDirectory(dirname(FILE) .'/../services/');
$response = $server->handle(); 
echo $response; 
```

当应用程序调用此脚本时，它会调用从服务目录加载的服务。

我正在尝试在此脚本中获取服务的名称。这可能吗？查看 zend 代码，看起来它们加载了原始 post 数据，然后解码该 amf 数据并请求。但是，我看不到如何访问请求信息以提取服务名称。

我希望有类似的东西`$server->getRequestServiceName()`，或者钻入一个对象并将其拉出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:20:51.803

你应该可以打电话：

```
$server->getRequest(); 
```

在适当的位置查看请求对象中的内容或：

```
$server->getResponse(); 
```

如果您需要确切了解您的应用程序的响应。

根据您需要的确切信息，这些对象之一应该有它。

# mysql - 从同一张表中的其他名字猜测性别

> ID：14095565
> 
> 赞同：0
> 
> 时间：2012-12-30T22:58:12.837
> 
> 标签：mysql

以下是我的 SQLFIDDLE，您将在其中看到名称为 ABC 且具有性别，并且名称相同但位置不同但没有任何性别的 DEF。我一直在尝试做的是`DEF`根据相似名称的性别填充 的性别`ABC`。请让我知道我该怎么做（在同一张表更新中）谢谢，

**[小提琴： http](http://sqlfiddle.com/#!2/e6b05/1) **://sqlfiddle.com/#!2/e6b05/1****

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:14:01.330

这应该可以解决问题

```
UPDATE addr AS a
JOIN addr AS b
  ON  b.Name = a.Name
  AND b.place = 'ABC'
  AND a.place = 'DEF'
SET a.gender = b.gender
WHERE a.gender = 'N/A' 
```

* * *

如果`place`没关系

```
UPDATE addr AS a
JOIN addr AS b
  ON  b.Name = a.Name
  AND b.gender <> 'N/A' 
SET a.gender = b.gender
WHERE a.gender = 'N/A' 
```**

# c# - 以编程方式引用按钮对象参数

> ID：14095572
> 
> 赞同：0
> 
> 时间：2012-12-30T22:58:36.163
> 
> 标签：c#, wpf

我正在为 GUI 编写授权框架。用户使用有效凭据登录，并显示用户有权访问的菜单选项（按钮）。

我计划根据分配给用户的权限显示或隐藏按钮可见性。

我正在努力思考以编程方式引用和切换按钮可见性的最佳方法。我有一个列表，其中详细说明了哪些菜单项应该可见或不可见，但我不知道如何针对表单上的按钮引用该列表。

我可以轻松地键入每个按钮对象的名称并针对列表进行测试并切换按钮的可见性，但这对我来说似乎不是很有效。

代码如下。我怎样才能最好地启用/禁用按钮项？

```
class Menu
{
    public int Id { get; set; }
    public string MenuItemFriendlyName { get; set; }
    public string ButtonName { get; set; }
    public bool Visable { get; set; }

    public List<Menu> CalculateMenuAccessForUser(User userDetails)
    {
        var menuItems = AllMenuItemsInSystem();

        foreach (var pt in userDetails.PermissionTable)
        {
            if(pt.Type != "Menu")
                break;

            if (menuItems.Exists(x => x.Id.Equals(pt.Id)))
            {
                var index = menuItems.FindIndex(y => y.Id.Equals(pt.Id));

                menuItems[index].Visable = true;
            }
        }

        return menuItems;
    }

    private List<Menu> AllMenuItemsInSystem()
    {
        var menu = new List<Menu>();

        using (var sqlconnection = new SqlConnection(Globals.AFWideSettings.SqlConnectionString))
        {
            sqlconnection.Open();
            using (
                var sqlcommand =
                    new SqlCommand("select name, permissionid from PermissionListTable where type = 'Menu'",
                                   sqlconnection))
            {
                var resultReader = sqlcommand.ExecuteReader();

                while (resultReader.Read())
                {
                    menu.Add(new Menu(){MenuItemFriendlyName = resultReader.GetString(0), Id = resultReader.GetInt32(1), Visable = false});
                }
            }
        }

        return menu;
    }
}

class Another{

    void BuildOutlookMenu()
    {
        var buildMenu = new Authentication.Menu();
        var menuBuilder = buildMenu.CalculateMenuAccessForUser(_userDetails);

        foreach (var menu in menuBuilder)
        {
            if (menu.Visable)
            {
                //Here I wish to enable or disable my menu buttons
                //BUTTON.Visibility = Visibility.Visible;
            }                
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:18:26.070

您将需要以某种方式将每个按钮与您的菜单相关联，我可能会使用该`Tag`属性为您的按钮分配一个索引，然后创建一个列表将您的按钮分配给它，然后遍历它以确定是否使其可见或不是。您需要将 Buttons 索引与菜单项上的属性相关联（我以 Tag 作为示例，使用名为 MenuButtons 的列表）。

```
foreach (var menu in menuBuilder)
{
    if (menu.Visible)
    {
        Button result =  menuButtons.Find(btn => { return (int)btn.Tag == (int)menu.Tag;});
        if(result != null){result.Visibility=Visibility.Visible;}
    }
} 
```

# ruby-on-rails-3 - 工厂女孩种子数据

> ID：14095574
> 
> 赞同：1
> 
> 时间：2012-12-30T22:59:05.380
> 
> 标签：ruby-on-rails-3, factory-bot

我有一个角色模型，在运行任何测试之前需要“学生”、“讲师”、“管理员”行。我可以为具有关联学生角色的用户创建（并通过测试），但这只会创建一个角色。但是，我的应用程序中的方法和范围失败了，因为他们可能期望找到一个“管理员”角色……那不存在。

如何在运行测试之前在 FactoryGirl 中创建多个角色？

我试过这个...

# 在 minitest_helper.rb

```
 class MiniTest::Spec  
   include FactoryGirl::Syntax::Methods
   before :each do
     DatabaseCleaner.clean
     Capybara.reset_sessions!
     Capybara.use_default_driver

     FactoryGirl.create(:role, name: "student")
     FactoryGirl.create(:role, name: "admin")
     FactoryGirl.create(:role, name: "instructor")
   end
  end 
```

角色按预期创建...

# 在工厂.rb

```
 factory :account do
      user # associated user factory

      trait :student do
       role_id { Role.find_by_name("student") }
      end
    end 
```

我希望这会在测试中调用以下命令时将正确的学生角色 ID 分配给帐户 role_id 字段...

# 在 user_test.rb

```
 it "says Welcome Back" do
     a = FactoryGirl.create :account, :student
     assert page.has_content?('Welcome Back'), "does not contain Welcome Back" 
   end 
```

我得到的错误是：

```
 undefined method `to_i' for #<Role:0x007fd5563cbdc8> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:22:07.527

改变了

```
 role_id { Role.find_by_name("student") } 
```

到

```
role_id { Role.find_by_name("student").id } 
```

这就是它所需要的...

# objective-c - NSSwap 返回一个有符号整数？

> ID：14095575
> 
> 赞同：0
> 
> 时间：2012-12-30T22:59:11.997
> 
> 标签：objective-c, ios, endianness

我正在尝试使用 NSSwap 交换 32 位无符号整数的字节

我原来的 NSInteger 是**13a81fbe**，我希望它变成：**be1fa813**

跑完之后

```
NSInteger swappedInteger = NSSwapInt(unencodedInteger); 
```

我得到一个新的整数，其字节值为：**be1fa813**。但是当我将它打印到控制台时，我得到 -1105221613

我的完整代码是这样的：

```
//get bytes within range
NSInteger unencodedInteger;
[mydata getBytes:&unencodedInteger range:myRange];

//swap the endianess of the bytes
NSInteger swappedInteger = NSSwapInt(unencodedInteger);

//debug logging
NSLog(@"Original: %x (%d)   Swapped: %x (%d)",unencodedInteger, unencodedInteger,swappedInteger, swappedInteger);

//add swapped integer to array
[banks addObject:[NSNumber numberWithInteger:swappedInteger]]; 
```

有谁明白为什么新的交换价值表现得好像它已经签署了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:11:48.720

二进制：

```
0xbe1fa813 = 0b10111110000111111010100000010011 
```

现在大概您正在使用的体系结构（iOS）将有符号整数视为它们以 2 补码表示。即，当值为负时设置最高有效位。所以这个数字，解释为一个有符号整数，是负数，因为它以`1`位开头。我刚刚在 OS X 上做了一个快速测试程序，并且确实`printf()`打印了一个很好的负整数和正整数，具体取决于我提供的转换说明符：

```
#include <stdio.h>

int main(void)
{
    printf("%x %u %d\n", 0xbe1fa813, (unsigned)0xbe1fa813, 0xbe1fa813);
    return 0;
} 
```

输出：

```
be1fa813 3189745683 -1105221613 
```

我会说这一切都是**意料之中的。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:16:50.283

`%d`in`printf`将整数解释为有符号。`%u`如果您想将其解释为无符号，请使用。

# php - 如何在 PHP 中将 MySQL 表转换为 JSON？

> ID：14095581
> 
> 赞同：0
> 
> 时间：2012-12-30T22:59:42.153
> 
> 标签：php, mysql, json

我有一个 MySQL 表，我想将其放入 JSON 格式，如下所示，但我正在努力如何做到这一点。这样做的目的是我有一个包含 3 个分类级别的产品目录，我需要为其创建一个下拉菜单。

有人可以帮忙吗？

**我想最终创建的菜单**

```
a         <- Level 1
- a1      <- Level 2
- - a11   <- Level 3
- - a12
- - a13
- a2
- - a21
- - a22
- - a23
- a3
- - a31
- - a32
- - a33
b
- b1
- - b11
- - b12
- - b13
- b2
- - b21
- - b22
- - b23
c
- c1
- c2
- c3
d
e 
```

**MySQL 表**

```
f   b   t
-------------------
a   a1  a11
a   a1  a12
a   a1  a13
a   a2  a21
a   a2  a22
a   a2  a23
a   a3  a31
a   a3  a32
a   a3  a33
b   b1  b11
b   b1  b12
b   b1  b13
b   b2  b21
b   b2  b22
b   b2  b23
c   c1
c   c2
c   c3
d
e 
```

**JSON 我想结束，所以我可以创建菜单**

```
{"menu":{"items":[{"value":"a","items":[{"value":"a1","items":["a11","a12","a13"]},{"value":"a2","items":["a21","a22","a23"]},{"value":"a3","items":["a31","a32","a33"]}]},{"value":"b","items":[{"value":"b1","items":["b11","b12","b13"]},{"value":"b2","items":["b21","b22","b23"]}]},{"value":"c","items":[{"value":"c1"},{"value":"c2"},{"value":"c3"}]},{"value":"d"},{"value":"e"}]}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:04:37.460

PHP 有一个漂亮的小函数，叫做[`json_encode()`](http://il1.php.net/manual/en/function.json-encode.php)

> **json_encode** — 返回值的 JSON 表示

您所要做的就是将您的数据提取到一个普通的 PHP 数组中，然后通过这个函数传递它。

```
$orig = array(
 'stack' => 'overflow'
);

$jsonString = json_encode($orig);
// {"stack":"overflow"} 
```

# batch-file - 当我回显变量 %input% 时，空格和 " 是非法输入

> ID：14095583
> 
> 赞同：1
> 
> 时间：2012-12-30T22:59:48.520
> 
> 标签：batch-file, cmd

我有一个奇怪的问题。下面的程序应该检查用户的输入并将其回显在屏幕上，除非输入是我在“if”语句中定义的某种“命令”，例如 /h 或 /r 或 /x。IF 语句会将字符串视为单个项目，而不是多个单独的字符串。因此，当我输入带有逗号（，）分号（;）等号（=）空格（）制表符（）引号（“）之类的分隔符时，它将搜索第二个项目，从而引发错误并退出。这就是我的问题。如果你不能理解我，请测试这个程序。我想在输入回显之前先检查那些“命令”。请赐教！：/谢谢。

```
@echo off

:again
set /p input= ^> 

if /i {%input%}=={/h} (
cls
echo /h
echo /r
echo /x
goto again
)

if /i {%input%}=={/r} (
cls
type blablafile.txt
goto again
)

if /i {%input%}=={/x} (
exit
)

echo %input%
goto again 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:54:19.323

尝试将所有花括号更改为双引号。这解决了您在一些简单情况下提到的分隔符问题，例如输入字符串中的空格。例如，

```
if /i {%input%}=={/h} 
```

可以改为

```
if /i "%input%"=="/h" 
```

请注意，这不处理其他一些情况，例如输入字符串中的双引号。有关此问题的解决方案，请参阅其他答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T00:55:08.810

IF 语句的一般形式为`IF Value1 CompareOperator Value2 COMMAND`

在实际执行 IF 之前，必须将该行解析为各种组件。有许多情况会导致语法无效。

一些明显的是特殊字符，如`&`, `|`, `<`, `>`: 这些必须像转义`^&`或引用一样`"&"`。

`<space>`像, `<tab>`, `;`, `,`, 和之类的标记分隔符不是那么明显的问题`=`。这些也必须转义或引用。以您的程序中的一行`<space>`作为用户输入为例。`%input% 展开后，行看起来

```
if /i { }=={/h} ( 
```

解析器在第一个未转义/未引用的标记分隔符处终止 Value1，因此它认为 Value1 是`{`并且它认为它`}`是 CompareOperator 的一部分。这会产生语法错误。

另一个问题是带有奇数引号的值，例如您的用户输入示例`"`.

```
if /i {"}=={/h} ( 
```

行情是一个状态机。启用引用后，解析器认为直到下一个引号之前的所有字符都是同一字符串的一部分。所以解析器认为 Value1 是`{"}=={/h} (`，并且命令不完整 - 另一个语法错误。

**部分解决方案**

你可以做类似的事情

```
if /i "%input%"=="/h" ... 
```

它将与`;`or `<space>`， or`=`等​​输入一起使用。

但是仍然有很多输入会失败。例如：`"`, `"&"`。

**完整的解决方案**

进行测试的唯一可靠方法是启用延迟扩展并`!input!`使用`%input%`. 这是因为解析器在延迟扩展发生*之前*检测到 IF 语句的各个组成部分。

```
if /i !input!==/h ( 
```

解析器将 Value1 标识为`!input!`，然后在执行之前，将该值扩展为用户输入。此时不再需要进行解析——IF 语句“知道”整个扩展值是要比较的值。

这是您的代码的完整工作版本，其中包含延迟扩展修复：

```
@echo off
setlocal enableDelayedExpansion

:again
set /p input= ^>

if /i !input!==/h (
cls
echo /h
echo /r
echo /x
goto again
)

if /i !input!==/r (
cls
echo type blablafile.txt
goto again
)

if /i !input!==/x (
exit /b
)

echo !input! 
```

# python - python用ElementTree读取复杂的xml

> ID：14095586
> 
> 赞同：0
> 
> 时间：2012-12-30T23:00:08.383
> 
> 标签：python, elementtree

我正在尝试使用 python 元素树解析这个 xml 文件：

```
<?xml version="1.0" encoding="Windows-1250"?>
<rsp:responsePack version="2.0" id="001" state="ok" note="" programVersion="9801.8 (19.5.2011)" xmlns:rsp="http://www.stormware.cz/schema/version_2/response.xsd" xmlns:rdc="http://www.stormware.cz/schema/version_2/documentresponse.xsd" xmlns:typ="http://www.stormware.cz/schema/version_2/type.xsd" xmlns:lst="http://www.stormware.cz/schema/version_2/list.xsd" xmlns:lStk="http://www.stormware.cz/schema/version_2/list_stock.xsd" xmlns:lAdb="http://www.stormware.cz/schema/version_2/list_addBook.xsd" xmlns:acu="http://www.stormware.cz/schema/version_2/accountingunit.xsd" xmlns:inv="http://www.stormware.cz/schema/version_2/invoice.xsd" xmlns:vch="http://www.stormware.cz/schema/version_2/voucher.xsd" xmlns:int="http://www.stormware.cz/schema/version_2/intDoc.xsd" xmlns:stk="http://www.stormware.cz/schema/version_2/stock.xsd" xmlns:ord="http://www.stormware.cz/schema/version_2/order.xsd" xmlns:ofr="http://www.stormware.cz/schema/version_2/offer.xsd" xmlns:enq="http://www.stormware.cz/schema/version_2/enquiry.xsd" xmlns:vyd="http://www.stormware.cz/schema/version_2/vydejka.xsd" xmlns:pri="http://www.stormware.cz/schema/version_2/prijemka.xsd" xmlns:bal="http://www.stormware.cz/schema/version_2/balance.xsd" xmlns:pre="http://www.stormware.cz/schema/version_2/prevodka.xsd" xmlns:vyr="http://www.stormware.cz/schema/version_2/vyroba.xsd" xmlns:pro="http://www.stormware.cz/schema/version_2/prodejka.xsd" xmlns:con="http://www.stormware.cz/schema/version_2/contract.xsd" xmlns:adb="http://www.stormware.cz/schema/version_2/addressbook.xsd" xmlns:prm="http://www.stormware.cz/schema/version_2/parameter.xsd" xmlns:lCon="http://www.stormware.cz/schema/version_2/list_contract.xsd" xmlns:ctg="http://www.stormware.cz/schema/version_2/category.xsd" xmlns:ipm="http://www.stormware.cz/schema/version_2/intParam.xsd">
<rsp:responsePackItem version="2.0" id="li1" state="ok">
    <lst:listInvoice version="2.0" dateTimeStamp="2011-05-27T10:47:23Z" dateValidFrom="2011-05-27" state="ok">
        <lst:invoice version="2.0">
            <inv:invoiceHeader>
                <inv:id>20</inv:id>
                <inv:invoiceType>issuedInvoice</inv:invoiceType>
                <inv:number>
                    <typ:id>26</typ:id>
                    <typ:ids>1101</typ:ids>
                    <typ:numberRequested>110100001</typ:numberRequested>
                </inv:number>
                <inv:symVar>110100001</inv:symVar>
                <inv:date>2011-01-30</inv:date>
                <inv:dateTax>2011-01-30</inv:dateTax>
                <inv:dateAccounting>2011-01-30</inv:dateAccounting>
                <inv:dateDue>2011-02-13</inv:dateDue>
                <inv:accounting>
                    <typ:id>17</typ:id>
                    <typ:ids>3Fv</typ:ids>
                </inv:accounting>
                <inv:classificationVAT>
                    <typ:id>251</typ:id>
                    <typ:ids>UD</typ:ids>
                    <typ:classificationVATType/>
                </inv:classificationVAT>
                <inv:text>Fakturujeme Vám zboží dle Vaší objednávky:  </inv:text>
                <inv:partnerIdentity>
                    <typ:id>15</typ:id>
                    <typ:address>
                        <typ:company>INTEAK spol. s r. o.</typ:company>
                        <typ:division>prodejna</typ:division>
                        <typ:name>David Jánský</typ:name>
                        <typ:city>Benešovice</typ:city>
                        <typ:street>Jiřího z Poděbrad 35</typ:street>
                        <typ:zip>463 48</typ:zip>
                        <typ:ico>85236972</typ:ico>
                        <typ:dic>CZ85236972</typ:dic>
                    </typ:address>
                    <typ:shipToAddress>
                        <typ:company/>
                        <typ:division/>
                        <typ:name/>
                        <typ:city/>
                        <typ:street/>
                    </typ:shipToAddress>
                </inv:partnerIdentity>
                <inv:myIdentity>
                    <typ:address>
                        <typ:company>Novák </typ:company>
                        <typ:surname>Novák</typ:surname>
                        <typ:name>Jan</typ:name>
                        <typ:city>Jihlava 1</typ:city>
                        <typ:street>Horní</typ:street>
                        <typ:number>15</typ:number>
                        <typ:zip>586 01</typ:zip>
                        <typ:ico>12345678</typ:ico>
                        <typ:dic>CZ12345678</typ:dic>
                        <typ:phone>569 876 542</typ:phone>
                        <typ:mobilPhone>602 852 369</typ:mobilPhone>
                        <typ:fax>564 563 216</typ:fax>
                        <typ:email>info@novak.cz</typ:email>
                        <typ:www>www.novak.cz</typ:www>
                    </typ:address>
                </inv:myIdentity>
                <inv:dateOrder>2011-01-22</inv:dateOrder>
                <inv:paymentType>
                    <typ:id>1</typ:id>
                    <typ:ids>příkazem</typ:ids>
                    <typ:paymentType>draft</typ:paymentType>
                </inv:paymentType>
                <inv:account>
                    <typ:id>2</typ:id>
                    <typ:ids>KB</typ:ids>
                </inv:account>
                <inv:symConst>0308</inv:symConst>
                <inv:centre>
                    <typ:id>1</typ:id>
                    <typ:ids>BRNO</typ:ids>
                </inv:centre>
                <inv:activity>
                    <typ:id>2</typ:id>
                    <typ:ids>NÁBYTEK</typ:ids>
                </inv:activity>
                <inv:liquidation>
                    <typ:date>2011-02-12</typ:date>
                    <typ:amountHome>356</typ:amountHome>
                </inv:liquidation>
            </inv:invoiceHeader>
            <inv:invoiceDetail>
                <inv:invoiceItem>
                    <inv:id>19</inv:id>
                    <inv:text>Židle Z220</inv:text>
                    <inv:quantity>2.0</inv:quantity>
                    <inv:unit>ks</inv:unit>
                    <inv:coefficient>1.0</inv:coefficient>
                    <inv:rateVAT>high</inv:rateVAT>
                    <inv:discountPercentage>0.0</inv:discountPercentage>
                    <inv:homeCurrency>
                        <typ:unitPrice>1968</typ:unitPrice>
                        <typ:price>3936</typ:price>
                        <typ:priceVAT>787.2</typ:priceVAT>
                        <typ:priceSum>4723.2</typ:priceSum>
                    </inv:homeCurrency>
                    <inv:code>Z220</inv:code>
                    <inv:guarantee>0</inv:guarantee>
                    <inv:guaranteeType>none</inv:guaranteeType>
                    <inv:stockItem>
                        <typ:store>
                            <typ:id>1</typ:id>
                            <typ:ids>ZBOŽÍ</typ:ids>
                        </typ:store>
                        <typ:stockItem>
                            <typ:id>27</typ:id>
                            <typ:ids>Z220</typ:ids>
                            <typ:PLU>650</typ:PLU>
                        </typ:stockItem>
                    </inv:stockItem>
                </inv:invoiceItem>
                <inv:invoiceItem>
                    <inv:id>20</inv:id>
                    <inv:text>Konferenční stolek chrom</inv:text>
                    <inv:quantity>1.0</inv:quantity>
                    <inv:unit>ks</inv:unit>
                    <inv:coefficient>1.0</inv:coefficient>
                    <inv:rateVAT>high</inv:rateVAT>
                    <inv:discountPercentage>0.0</inv:discountPercentage>
                    <inv:homeCurrency>
                        <typ:unitPrice>7680</typ:unitPrice>
                        <typ:price>7680</typ:price>
                        <typ:priceVAT>1536</typ:priceVAT>
                        <typ:priceSum>9216</typ:priceSum>
                    </inv:homeCurrency>
                    <inv:note>Rozměr: 120 x 60</inv:note>
                    <inv:code>Konf11</inv:code>
                    <inv:guarantee>0</inv:guarantee>
                    <inv:guaranteeType>none</inv:guaranteeType>
                    <inv:stockItem>
                        <typ:store>
                            <typ:id>1</typ:id>
                            <typ:ids>ZBOŽÍ</typ:ids>
                        </typ:store>
                        <typ:stockItem>
                            <typ:id>10</typ:id>
                            <typ:ids>Konf11</typ:ids>
                            <typ:PLU>625</typ:PLU>
                        </typ:stockItem>
                    </inv:stockItem>
                </inv:invoiceItem>
                <inv:invoiceItem>
                    <inv:id>21</inv:id>
                    <inv:text>Křeslo čalouněné 1320</inv:text>
                    <inv:quantity>4.0</inv:quantity>
                    <inv:unit>ks</inv:unit>
                    <inv:coefficient>1.0</inv:coefficient>
                    <inv:rateVAT>high</inv:rateVAT>
                    <inv:discountPercentage>0.0</inv:discountPercentage>
                    <inv:homeCurrency>
                        <typ:unitPrice>5988</typ:unitPrice>
                        <typ:price>23952</typ:price>
                        <typ:priceVAT>4790.4</typ:priceVAT>
                        <typ:priceSum>28742.4</typ:priceSum>
                    </inv:homeCurrency>
                    <inv:code>Kř1320</inv:code>
                    <inv:guarantee>0</inv:guarantee>
                    <inv:guaranteeType>none</inv:guaranteeType>
                    <inv:stockItem>
                        <typ:store>
                            <typ:id>1</typ:id>
                            <typ:ids>ZBOŽÍ</typ:ids>
                        </typ:store>
                        <typ:stockItem>
                            <typ:id>13</typ:id>
                            <typ:ids>Kř1320</typ:ids>
                            <typ:PLU>627</typ:PLU>
                        </typ:stockItem>
                    </inv:stockItem>
                </inv:invoiceItem>
            </inv:invoiceDetail>
            <inv:invoiceSummary>
                <inv:roundingDocument>up2one</inv:roundingDocument>
                <inv:roundingVAT>none</inv:roundingVAT>
                <inv:homeCurrency>
                    <typ:priceNone>0</typ:priceNone>
                    <typ:priceLow>0</typ:priceLow>
                    <typ:priceLowVAT>0</typ:priceLowVAT>
                    <typ:priceLowSum>0</typ:priceLowSum>
                    <typ:priceHigh>35568</typ:priceHigh>
                    <typ:priceHighVAT>7113.6</typ:priceHighVAT>
                    <typ:priceHighSum>42681.6</typ:priceHighSum>
                    <typ:round>
                        <typ:priceRound>0.4</typ:priceRound>
                    </typ:round>
                </inv:homeCurrency>
            </inv:invoiceSummary>
        </lst:invoice>
    </lst:listInvoice>
</rsp:responsePackItem>
</rsp:responsePack> 
```

请问，我怎样才能得到数据，如：（？）

inv:invoiceSummary - typ:priceHighSum

inv:partnerIdentity - typ:name, typ:ico

inv：myIdentity - 类型：公司

inv：清算 - 类型：日期

我试过这个但不能让它工作：

```
import xml.etree.ElementTree as ET
tree = ET.parse('temp_xml2.xml')
root = tree.getroot()

for listInvoice in root.findall('listInvoice'):
    invoiceHeader = listInvoice.find('invoiceHeader').text
    print invoiceHeader 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:07:34.717

尝试使用 jsoup。一个相关的例子是[解析 XML](http://pastebin.com/gqsFftC4)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T12:29:33.417

这有效：

```
for listInvoice in root.findall('.//{http://www.stormware.cz/schema/version_2/invoice.xsd}invoiceHeader'):
    invoiceHeader = listInvoice.find('.//{http://www.stormware.cz/schema/version_2/invoice.xsd}id').text
    print invoiceHeader 
```

# android - Android 到 PC USB 读/写

> ID：14095588
> 
> 赞同：7
> 
> 时间：2012-12-30T23:00:24.400
> 
> 标签：android, windows, usb

我在 PC 上有一个程序从 USB 接收字符串输入（旧程序）我有一个 Android (4.X) 平板电脑，它需要在 USB 上向 PC 上运行的程序提供字符串输入。当我在 Android 上使用示例代码时，以下代码给出了空的 hashmap。PC（在 32 位 XP 和 64 位 Windows 7 上试用）具有 Android 驱动程序。

```
 mManager = (UsbManager)getSystemService(Context.USB_SERVICE);
    HashMap<String, UsbDevice> devices =  mManager.getDeviceList(); 
```

任何通过 USB 与 PC 通信的真实工作代码示例都会有所帮助，请。还指出是否需要在 Android 上与 PC 对话的任何驱动程序等。

我已经尝试过附件模式和主机模式（以防万一）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T09:43:04.603

我不确定我是否完全遵循您在这里所做的事情，但如果我理解正确 - 它不会以这种方式工作。这`UsbManager.getDeviceList()`适用于带有 USB**主机**端口的 Android 设备，一些 USB**设备**连接到这些设备。但是，据我了解，您将充当**设备**的 Android 平板电脑连接到充当**主机**的 PC （我猜是这样，因为您写了有关驱动程序安装的文章）。

如果您想在 Android USB*设备*和某些 USB*主机*之间进行通信（例如，因为您的 Android 设备没有 USB 主机功能），您需要使用附件模式（我建议您从[这篇 Android 开发者博客文章](http://android-developers.blogspot.com/2011/05/bright-idea-android-open-accessories.html)开始）。但这种模式需要 USB 主机端的特殊支持（它必须使用[Android Open Accessory Protocol](https://source.android.com/devices/accessories/protocol)与设备通信）。请注意，这`getDeviceList()`在附件模式下没有意义 - 首先，连接的附件是 USB 主机，而不是 USB 设备，并且 USB 总线上只能有一个 USB 主机。

如果您想使用附件模式与 PC 通信，您可能想尝试此[AOAP 实现](http://android-developers.blogspot.com/2011/05/bright-idea-android-open-accessories.html)PC。如果您只需要与 Android 设备进行一些调试需求，您可能希望使用[ADB 端口转发](http://developer.android.com/tools/help/adb.html#forwardports)和 TCP 连接。

# php - 使用 preg_match 解析

> ID：14095592
> 
> 赞同：0
> 
> 时间：2012-12-30T23:00:51.917
> 
> 标签：php, if-statement, preg-match

我有以下代码：

```
 if(isset($_POST['login'])){

    $check = $_POST['theemail'];
    if (preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/", $check)){ 

    echo 'Email is valid ';
    }  

    }

        <form method="post" action="" autocomplete="off"> 

    <p align="right">Email <BR><input type="text" name="theemail" size="20" /></p>
    <p align="right"><input type="submit" name="register" value="Register" /></p>
    <p align="right"><a href="index.php">register</a></p>

   </form> 
```

此代码在用户提交表单时检查电子邮件是否采用有效格式（name@host.com），并且可以正常工作；我的问题是，当我尝试从 preg_match 获取某些内容以在提交表单时回显给用户时。

例如：用户提交了以下电子邮件：john@gmail.com

我希望用户会看到作为回报：echo' Hello john（而不是 john，它将是一个变量 $，或者会显示它的东西）。您的电子邮件的主机是：gmail.com（而不是 gmail，它将是一个变量 $ 或将显示它的东西）。

我试图在代码中的某些位置周围创建 div，以便稍后在回显中显示它们，但我没有成功。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T12:29:07.620

我会这样做：

```
<?php
if(isset($_POST['register'])){
$check = $_POST['theemail'];
if (preg_match("/^([_a-z0-9-]+(\.[_a-z0-9-]+)*)@([a-z0-9-]+(\.[a-z0-9-]+)*)(\.([a-z]{2,3}))$/", $check, $match)){ 
echo 'Hello ' . $match[1] . ' your email address domain is '. $match[3] . '.' . $match[6];
} else {
echo 'Error, you entered an invalid email address';
}
}
?>

<form method="post" action="" autocomplete="off"> 
<p align="right">Email <BR><input type="text" name="theemail" size="20" /></p>
<p align="right"><input type="submit" name="register" value="Register" /></p>
<p align="right"><a href="index.php">register</a></p>
</form> 
```

这将输出：

> 你好约翰你的电子邮件地址域是 doe.com

或者，如果电子邮件地址无效：

> 错误，您输入的电子邮件地址无效

在所有情况下，它都会再次显示表单。

# ios - 在 UIWebView 中实现 rdd.me api

> ID：14095595
> 
> 赞同：0
> 
> 时间：2012-12-30T23:01:48.177
> 
> 标签：ios, api, uiwebview, rss, readability

我正在开发一个将新闻文章从 RSS 加载到 UIWebView 的应用程序。但我希望用户获得更好的阅读体验，并希望实现 rdd.me api。我还没有找到任何好的指南来将此 api 实现到 ios 应用程序中，希望这里有人可以帮助我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:57:25.017

github 上的[这个项目是 rdd.me API 的 Objective-C 包装器。](https://github.com/Fahrni/RFRddMe)

它也有一些关于如何使用它的说明。

# iphone - 初始化时设置属性

> ID：14095597
> 
> 赞同：2
> 
> 时间：2012-12-30T23:01:59.970
> 
> 标签：iphone, ios, properties, uiviewcontroller

我正在创建一个视图控制器的实例，然后以模态方式将其呈现在另一个视图上：

```
[viewController receiveNumber1:number1 andNumber2:number2];
[viewController setModalTransitionStyle:UIModalTransitionStyleCrossDissolve];
[self presentModalViewController:viewController animated:YES]; 
```

我想做的是在初始化时在这个新的视图控制器中设置两个属性。

我可以通过调用自定义方法来做到这一点（这里有些是 int 变量）：

```
[viewController methodProperty1:something1 andProperty2:something2]; 
```

但是，我确实需要在初始化时正确设置这些属性，因为新视图的内容取决于这些数字。

有没有办法在初始化时将信息传递给新视图？就像是：

```
[[UIViewController alloc] initWithValue1:something1 andValue2:something2]; 
```

另外，我不明白为什么

```
CustomViewController *view = [[CustomViewController alloc] init];
view.property = newValue; / [view setProperty:newValue]; 
```

在此配置中不起作用，这意味着属性的值不会改变。我可以在新视图中调用方法并以这种方式设置其属性，但不能直接设置属性？

如果这些是蹩脚的问题，我很抱歉，但我是一个初学者。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:23:53.603

1.  `view.property = newValue`并且`[view setProperty:newValue]`是等价的术语。
2.  您可以为您的视图控制器实现一种或多种自定义初始化方法，没有什么可以停止这样做的。查看[官方文档](http://developer.apple.com/library/ios/#documentation/general/conceptual/CocoaEncyclopedia/Initialization/Initialization.html)以确保您遵守有关如何实现自定义初始化程序的一些规则。

您的代码片段：

```
-(id)initWithValue1:(NSInteger)value1 andValue2:(NSInteger)value2
{
    if (self = [super init])
    {
        _firstValue = value1;
        _secondValue = value2;
        return self;
    }
    else return nil; // or handle the error
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:22:32.490

在您的`CustomViewController.h`中，定义您要设置的两个属性和一个初始化方法，例如：

```
@property (nonatomic, assign) NSInteger firstValue;
@property (nonatomic, assign) NSInteger secondValue;

-(id)initWithFirstValue:(NSInteger)value1 andSecondValue:(NSInteger)value2; 
```

然后，在您的 中`CustomViewController.m`，实现您之前声明的方法：

```
-(id)initWithFirstValue:(NSInteger)value1 andSecondValue:(NSInteger)value2
{
    self = [super init];
    if (self)
    {
        // Supposing you haven't synthesized your property and you are using
        // latest Xcode build, instance variable are automatically created
        _firstValue = value1;
        _secondValue = value2;
    }
    return self;
} 
```

最后，您可以使用这行代码分配您的控制器：

```
CustomViewController *controller = [[CustomViewController alloc] initWithFirstValue:value1ToSet andSecondValue:value2ToSet]; 
```

**一些最终建议**
当您实现自定义初始化方法时，您应该正确选择`init`必须调用的方法`super`。
例如，`self = [super initWithFrame:CGRectZero];`如果我的控制器是 UIViewController 的子类，或者`self = [super initWithStyle:UITableViewStylePlain];`它是 UITableViewController 的子类，我更喜欢调用。
还有其他自定义 init 方法，但您可以找到有关自定义控制器超类的其他信息阅读文档。

# python - App Engine Django-Nonrel ReferenceProperty

> ID：14095598
> 
> 赞同：1
> 
> 时间：2012-12-30T23:02:02.060
> 
> 标签：python, django, google-app-engine, django-nonrel

我正在将 App Engine Python/Django 应用程序从（旧式）App Engine Helper 升级到（新式）Django-Nonrel。现在每个模型都继承自`django.db.models.Model`而不是 (old style) `appengine_django.models.BaseModel`。

我的数据库模型声明如下：

```
from django.db import models

class UserModelBackupTracker(models.Model):
...

class UserModel(models.Model):
    # The following line generates the error
    backup_tracker = db.ReferenceProperty(reference_class=UserModelBackupTracker) 
```

触发错误：

```
"reference_class must be Model or _SELF_REFERENCE" (in appengine.ext.db.\__init__.py -> ReferenceProperty.\__init__ ). 
```

此错误由检查来触发，以查看 的 reference_class “issubclass” `google.appengine.ext.db.Model`，但是该类的声明类型为`django.db.models.Model`，它*不是*的子类`ext.db.Model`。

所以，我的问题是：在使用 Django-Nonrel 时，我在声明 ReferenceProperty 方面做错了什么，我应该如何解决它。

亲切的问候亚历山大

# ember.js - Ember.js 项目目录结构

> ID：14095601
> 
> 赞同：15
> 
> 时间：2012-12-30T23:02:28.550
> 
> 标签：ember.js

是否有任何好的教程或 Ember.js 文档描述模型/视图/控制器、app.js 的目录结构以及在 index.html 根文件中引用这些文件的方式。

*   创建“Ember.Application.create”的文件？
*   包含顺序（models.js、apps.js、controllers.js）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T23:03:04.967

我有一个非常满意的布局

app.js - 这是主应用程序文件，包括设置和路由器

views.js - 包含应用程序中使用的视图，尽管我现在通常将其拆分为 homeView.js navigtaionView.js 等

dataModels.js - 这是我为应用程序保存所有数据模型对象的地方

dataSources.js - 我使用它从我进行的任何 api 调用中加载数据模型或数据模型数组

accountController.js - 控制器类，在附加的示例中我还有一个 emailMessagingController 和一个 smsMessagingController

你可以在这里找到我的示例项目

[https://github.com/bwship/neptunejs](https://github.com/bwship/neptunejs)

以及此处用于 ember 的咖啡脚本文件

[https://github.com/bwship/neptunejs/tree/master/public/coffeescripts](https://github.com/bwship/neptunejs/tree/master/public/coffeescripts)

最后是布局和索引的 jad 文件，显示了我如何在此处添加这些

[https://github.com/bwship/neptunejs/tree/master/views](https://github.com/bwship/neptunejs/tree/master/views)

我确实想最终开始使用 ember 数据样式，但是已经使用 dataSources 和 dataModels 文件推出了一些可靠的应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T09:11:42.920

[Dan Gebhardt](http://www.cerebris.com/blog/2012/01/24/beginning-ember-js-on-rails-part-1/)的本教程对我设置项目结构和弄清楚如何包含文件非常有帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T19:21:21.600

[ember-skeleton 项目](https://github.com/interline/ember-skeleton)有一个合理的rake 管道项目布局示例。他们这样做（[来自自述文件](https://github.com/interline/ember-skeleton#app-structure)）：

```
余烬骨架
├── Assetfile - 应用构建文件
├── Gemfile - rakep/rack 的包依赖
├── Gemfile.lock - 这里是龙：不要碰，总是包括
├── app - 应用特定代码
│ ├── css - 应用程序 CSS 或 SCSS (.scss)
│ ├── lib - 应用程序代码，*在构建期间模块化*
│ ├── modules - 模块代码，*已经模块化*
│ ├── plugins - 插件（例如 jquery.jsonrpc.js）
│ │ └── loader.js - JS 模块加载器
│ ├── static - 静态文件，从未接触过，在构建过程中被复制
│ ├── templates - Handlebars 模板，*在构建过程中模块化*
│ ├── 测试 - QUnit 应用测试
│ └── vendor - 供应商代码，*在构建期间模块化*
├── assets - 构建资产文件，在生产中缩小
│ ├── app.css - 构建应用程序 CSS/SCSS
│ ├── app.js - 构建的app JS
│ └── loader.js - 内置 JS 模块加载器
├── config.ru - 机架开发 Web 服务器配置
├── index.html - 应用入口点
├── 测试 - QUnit 测试文件
│ ├── index.html - 测试入口点
│ ├── qunit - 测试支持文件
│ └── run-tests.js - PhantomJS QUnit 测试运行器
└── tmp - rakep 使用的临时构建文件

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-05T16:57:37.507

似乎仍然没有明确的约定，但目前似乎有很多人在使用 Yeoman 和官方的 Ember 生成器[https://github.com/yeoman/generator-ember](https://github.com/yeoman/generator-ember)

虽然我很欣赏 Ember 教程的“开放”性质，但 Rails 的优点之一是文件放置的约定。当我们雇佣一个新的开发者时，我们不需要解释我们的目录结构......我希望 Ember 尽快制定一个官方标准。

# php - 致命错误：在第 7 行对非对象调用成员函数 prepare()。我无法弄清楚，为什么会出现此错误？

> ID：14095603
> 
> 赞同：1
> 
> 时间：2012-12-30T23:02:56.200
> 
> 标签：php, phpmyadmin, mysqli

连接成功 致命错误：在第 7 行对非对象调用成员函数 prepare()。为什么会出现此错误？这是论坛的开始。我准备用'if ($query = $db->prepare($sql))。

```
<?php
session_start();
$db = mysql_connect("localhost","root","","my_db") or die ("Could not connect to         database.");
echo 'Connected Successfully';

$sql = "SELECT forum_id, forum_name FROM forum_tbl";
if ($query = $db->prepare($sql)){
    $query->bind_result($f_id, $f_name);
    $query->execute();
    $query->store_result();
}else{
    echo $db->error;

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<title>Forum</title>
<meta/>
<style type="text/css">
</style>
</head>

<body>
<div class="container">
<div class="content">
    <table align="center" width="80%">
        <?php
        if($query->num_rows !==0):
        while($row = $query->fetch()):?>
        <tr>
        <td><a href="forum.php?id=<?php echo $f_id?>"><?php echo $f_name;?>    </a></td>
        </tr>
        <?php endwhile; endif;?>    
    </table>
</div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:06:30.523

您正在`mysql_connect`与 PDO 混淆。使用 PDO，您将获得一个用于查询的对象，但`mysql_connect`无论如何都不推荐使用它！

所以你正在调用一个不是对象的方法。假设您有这样的常量（否则只需用正确的值替换）将您的代码更改为

```
$db = new PDO(DB_TYPE.':host='.DB_HOST.';dbname='.DB_NAME, DB_USER, DB_PASS); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T23:07:55.370

改变：

```
$db = mysql_connect("localhost","root","","my_db") or die ("Could not connect to database."); 
```

至

```
try {
    $db = new PDO(mysql:dbname=my_db;host=127.0.0.1, "root","");
} catch (PDOException $e) {
    echo 'Connection failed: ' . $e->getMessage();
    exit();
} 
```

# c++ - 加载 24 位 TGA

> ID：14095604
> 
> 赞同：2
> 
> 时间：2012-12-30T23:03:09.703
> 
> 标签：c++, tga

我写了一个 TGA 加载器来加载 TGA 文件。它可以很好地加载和保存 32 位 TGA 文件，但是在加载和保存 24 位时，它就搞砸了。

来自 Photoshop 的 TGA 24 位文件示例：

![在此处输入图像描述](../Images/212a717e00956936cfe0fc1690d05e07.png)

我的输出：

![在此处输入图像描述](../Images/2d9f8e0105b714dd5f17f1609304a4e9.png)

知道有什么问题吗？我用与我的位图加载器相同的方式进行填充，它可以工作，但 TGA 没有.. :S 下面的代码可以编译和加载 TGA，以防万一有人想要测试它。

```
#include <iostream>
#include <vector>
#include <stdexcept>
#include <fstream>
#include <cstring>

typedef union RGB
{
    std::uint32_t Color;
    struct
    {
        std::uint8_t B, G, R, A;
    } RGBA;
} *PRGB;

class Tga
{
    private:
        std::vector<RGB> Pixels;
        bool ImageCompressed;
        std::uint32_t width, height, size, BitsPerPixel;

    public:
        Tga(const char* FilePath);
        void Save(const char* FilePath);
};

Tga::Tga(const char* FilePath)
{
    std::fstream hFile(FilePath, std::ios::in | std::ios::binary);
    if (!hFile.is_open()){throw std::invalid_argument("File Not Found.");}

    std::uint8_t Header[18] = {0};
    std::vector<std::uint8_t> ImageData;
    static std::uint8_t DeCompressed[12] = {0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};
    static std::uint8_t IsCompressed[12] = {0x0, 0x0, 0xA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};

    hFile.read(reinterpret_cast<char*>(&Header), sizeof(Header));

    if (!std::memcmp(DeCompressed, &Header, sizeof(DeCompressed)))
    {
        BitsPerPixel = Header[16];
        width  = Header[13] * 0xFF + Header[12];
        height = Header[15] * 0xFF + Header[14];
        size  = ((width * BitsPerPixel + 31) / 32) * 4 * height;

        if ((BitsPerPixel != 24) && (BitsPerPixel != 32))
        {
            hFile.close();
            throw std::invalid_argument("Invalid File Format. Required: 24 or 32 Bit Image.");
        }

        ImageData.resize(size);
        ImageCompressed = false;
        hFile.read(reinterpret_cast<char*>(ImageData.data()), size);
    }
    else if (!std::memcmp(IsCompressed, &Header, sizeof(IsCompressed)))
    {
        BitsPerPixel = Header[16];
        width  = Header[13] * 0xFF + Header[12];
        height = Header[15] * 0xFF + Header[14];
        size  = ((width * BitsPerPixel + 31) / 32) * 4 * height;

        if ((BitsPerPixel != 24) && (BitsPerPixel != 32))
        {
            hFile.close();
            throw std::invalid_argument("Invalid File Format. Required: 24 or 32 Bit Image.");
        }

        RGB Pixel = {0};
        int CurrentByte = 0;
        std::size_t CurrentPixel = 0;
        ImageCompressed = true;
        std::uint8_t ChunkHeader = {0};
        int BytesPerPixel = (BitsPerPixel / 8);
        ImageData.resize(width * height * sizeof(RGB));

        do
        {
            hFile.read(reinterpret_cast<char*>(&ChunkHeader), sizeof(ChunkHeader));

            if(ChunkHeader < 128)
            {
                ++ChunkHeader;
                for(int I = 0; I < ChunkHeader; ++I, ++CurrentPixel)
                {
                    hFile.read(reinterpret_cast<char*>(&Pixel), BytesPerPixel);

                    ImageData[CurrentByte++] = Pixel.RGBA.B;
                    ImageData[CurrentByte++] = Pixel.RGBA.G;
                    ImageData[CurrentByte++] = Pixel.RGBA.R;
                    if (BitsPerPixel > 24) ImageData[CurrentByte++] = Pixel.RGBA.A;
                }
            }
            else
            {
                ChunkHeader -= 127;
                hFile.read(reinterpret_cast<char*>(&Pixel), BytesPerPixel);

                for(int I = 0; I < ChunkHeader; ++I, ++CurrentPixel)
                {
                    ImageData[CurrentByte++] = Pixel.RGBA.B;
                    ImageData[CurrentByte++] = Pixel.RGBA.G;
                    ImageData[CurrentByte++] = Pixel.RGBA.R;
                    if (BitsPerPixel > 24) ImageData[CurrentByte++] = Pixel.RGBA.A;
                }
            }
        } while(CurrentPixel < (width * height));
    }
    else
    {
        hFile.close();
        throw std::invalid_argument("Invalid File Format. Required: 24 or 32 Bit TGA File.");
    }

    hFile.close();
    std::uint8_t* BuffPos = ImageData.data();
    Pixels.resize(width * height);

    //Flip the pixels and store them in my vector..

    for (std::size_t I = 0; I < height; ++I)
    {
        for (std::size_t J = 0; J < width; ++J)
        {
            Pixels[(height - 1 - I) * width + J].RGBA.B = *(BuffPos++);
            Pixels[(height - 1 - I) * width + J].RGBA.G = *(BuffPos++);
            Pixels[(height - 1 - I) * width + J].RGBA.R = *(BuffPos++);
            Pixels[(height - 1 - I) * width + J].RGBA.A = (BitsPerPixel > 24 ? *(BuffPos++) : 0xFF);
        }
        if(BitsPerPixel == 24)
            BuffPos += (-width * 3) & 3;
    }
}

void Tga::Save(const char* FilePath)
{
    std::fstream hFile(FilePath, std::ios::out | std::ios::binary);
    if (!hFile.is_open()) {throw std::invalid_argument("Cannot open file for writing.");}

    std::vector<std::uint8_t> ImageData(size);
    std::uint8_t* BuffPos = ImageData.data();

    //Flip it back to how it was when we loaded it.. 
    for (std::size_t I = 0; I < height; ++I)
    {
        for (std::size_t J = 0; J < width; ++J)
        {                                                                   //Flip The ScanLines/Rows back to normal.
            *(BuffPos++) = Pixels[(height - 1 - I) * width + J].RGBA.B;
            *(BuffPos++) = Pixels[(height - 1 - I) * width + J].RGBA.G;
            *(BuffPos++) = Pixels[(height - 1 - I) * width + J].RGBA.R;

            if (BitsPerPixel > 24)
                *(BuffPos++) = Pixels[(height - 1 - I) * width + J].RGBA.A;
        }
        if(BitsPerPixel == 24)
            BuffPos += (-width * 3) & 3;
    }

    static std::uint8_t DeCompressed[12] = {0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};
    static std::uint8_t IsCompressed[12] = {0x0, 0x0, 0xA, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};

    if (!ImageCompressed)
    {
        hFile.write(reinterpret_cast<char*>(&DeCompressed), sizeof(DeCompressed));
        hFile.put((width & 0xFF));
        hFile.put((width & 0xFF) / 0xFF);
        hFile.put((height & 0xFF));
        hFile.put(((height & 0xFF) / 0xFF));
        hFile.put(BitsPerPixel);
        hFile.put(0x0);
        hFile.write(reinterpret_cast<char*>(ImageData.data()), ImageData.size());
        hFile.close();
    }
    else
    {
        hFile.write(reinterpret_cast<char*>(&IsCompressed), sizeof(IsCompressed));
        hFile.put((width & 0xFF));
        hFile.put((width & 0xFF) / 0xFF);
        hFile.put((height & 0xFF));
        hFile.put(((height & 0xFF) / 0xFF));
        hFile.put(BitsPerPixel);
        hFile.put(0x0);
    }
    hFile.close();
}

int main()
{
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T23:14:25.590

您的代码肯定至少有几个问题：

```
width  = Header[13] * 0xFF + Header[12]; 
```

这不是读取两个字节值的正确方法...`0xFF`是 255 而不是 256：正确的方法是

```
width  = (Header[13] << 8) + Header[12]; 
```

您的代码在编写时在同一区域也存在不同的问题：

```
hFile.put((width & 0xFF));
hFile.put((width & 0xFF) / 0xFF); 
```

代码是错误的（请注意，例如，您只考虑 的低 8 位`width`）。一个正确的版本将改为

```
hFile.put(width & 0xFF);
hFile.put((width >> 8) & 0xFF); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:08:24.240

我认为您遇到的问题是您假设填充了 TGA 文件，但事实并非如此。

因此，您的缓冲区大小错误，并且您错误地对它们进行了索引。您对输入和输出进行对称操作意味着它几乎可以工作，但填充字节最终出现在图像中，这（因为它每行一个字节）导致图像出现对角条纹，交替通过颜色通道.

您读取的返回的字节数将少于您的预期，但您没有进行检查。

（虽然[6502](https://stackoverflow.com/users/320726/6502)关于您错误地处理 2 字节字段是完全正确的 - 但是这个特定图像的宽度/高度小于 255 像素，因此不会受到影响）。

# javascript - 如何将 jQuery 自动完成类别作为表单提交的一部分发送？

> ID：14095607
> 
> 赞同：0
> 
> 时间：2012-12-30T23:03:45.993
> 
> 标签：javascript, jquery, autocomplete

我有带有类别的 jquery 自动完成功能，当一个人用鼠标单击它时，它会发送到具有该值的 php 页面并返回一个页面。这工作得很好。

但是我希望类别与它一起发送。

这是初始部分..

```
 $( "#tipapp" ).catcomplete({
        delay: 0,
        source: data,
            select: function(event, ui) {
                $("input#tipapp").val(ui.item.label);
                $("#tipapp").submit();
            },
    }).data("catcomplete")._renderItem = function(ul, item) {
                return $("<li></li>").data("item.catcomplete", item).append("<a>" + item.label + "</a>").appendTo(ul);
    }; 
```

以及 php 的提要：

```
 $("#tipapp").submit(function() {
        $('#output').load('resultapp.php', {value: $(this).val()}); 
    }); 
```

从我读到的，我想我可以简单地在 php 行中添加如下内容：

```
$('#output').load('resultapp.php', {value: $(this).val(), cat: item.category}); 
```

但没有运气，我当时也改变了

```
select: function(event, ui, item) {
$("input#tipapp").cat(ui.item.category); 
```

当然，没有运气。有大量页面使用自动完成和表单等，但这是特定于类别的。

我在这里错过了一些简单的东西吗？我可以对项目进行查找以获取我正在调用的 php 文件中的类别，但如果它是一个简单的修复，那么它将保存一些代码和对数据库的额外调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:50:29.940

`ui.item.category`确实应该包含项目的类别值。问题是该`ui`对象可能在最终`submit()`处理程序的范围内未定义。

为了克服这个问题，您可以在调用处理程序之前将类别值存储在输入元素的数据中，如下所示：

```
select: function(event, ui) {
    $("input#tipapp").val(ui.item.label).data('category',ui.item.category);
    $("#tipapp").submit();
} 
```

然后在处理程序中，您可以从输入元素的数据中检索类别值，如下所示：

```
$("#tipapp").submit(function() {
    $('#output').load('resultapp.php', {value: $(this).val(), cat:$(this).data('category')}); 
}); 
```

# html - 如何使属性居中位置是绝对的？

> ID：14095610
> 
> 赞同：2
> 
> 时间：2012-12-30T23:04:15.993
> 
> 标签：html, css

我在这里有一个演示[应用程序](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable3.php)。请打开应用程序，然后单击“添加”问题按钮以附加表格行。您将看到 4 个表格列，其中三个列由图像文件输入、视频文件输入和音频文件输入组成。在其中一个输入中，请选择一个相关文件并上传它，您将看到一个加载栏。但问题是加载栏未显示在其表格单元格的中心。

我的问题是如何将每个文件输入的加载栏居中在其自己的表格单元格中？

以下是所有三个文件输入中用于加载栏的 css：

```
.imagef1_upload_process{
    position:absolute;
    visibility:hidden;
    text-align:center;
    margin-bottom:0px;
    padding-bottom:0px; 
    }

.videof1_upload_process{
    position:absolute;
    visibility:hidden;
    text-align:center;
    margin-bottom:0px;
    padding-bottom:0px; 
    }

.audiof1_upload_process{
    position:absolute;
    visibility:hidden;
    text-align:center;
    margin-bottom:0px;
    padding-bottom:0px; 
    } 
```

以下是每个加载栏的 html：

图片加载栏：

```
<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target_image' onsubmit='return imageClickHandler(this);' class='imageuploadform' > 
<p class='imagef1_upload_process'>Loading...<br/><img src='Images/loader.gif' /></p>
    </form> 
```

视频加载栏：

```
<form action='videoupload.php' method='post' enctype='multipart/form-data' target='upload_target_video' onsubmit='return videoClickHandler(this);' class='videouploadform' > 
<p class='videof1_upload_process'>Loading...<br/><img src='Images/loader.gif' /></p>
</form> 
```

音频加载栏：

```
<form action='audioupload.php' method='post' enctype='multipart/form-data' target='upload_target_audio' onsubmit='return audioClickHandler(this);' class='audiouploadform' > 
<p class='audiof1_upload_process'>Loading...<br/><img src='Images/loader.gif' /></p>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:37:06.733

您`position: absolute`正在将元素的宽度设置为 auto 并将其从正常定位中移除。我建议放弃定位并让它正常流动。这将使图像在字段中居中，但您会立即注意到开放的空白。我们已经放弃了定位并将元素放回流中，因此，其他元素尊重它的空间，因为您正在利用`visibility`. 翻转你的使用，`visibility: hidden`元素`display: none`将不再占用空间，直到显示值被切换。

# java - 编写阶乘方法

> ID：14095612
> 
> 赞同：0
> 
> 时间：2012-12-30T23:04:41.343
> 
> 标签：java

我正在我的教科书中研究下面的代码。它使用组合方法和阶乘方法来计算给定 n 和 k 的可能结果。我的问题是阶乘方法，特别是 for 循环中的内容。

我了解该程序的所有其他内容，但我不了解阶乘方法中 for 循环中的代码 i <=n。n 指的是程序的哪些其他部分？我只是不确定 i <= n 背后的基本原理或程序员如何提出这一点。

```
import acm.program.*;

public class combinations extends ConsoleProgram {
    public void run(){
        int n = readInt("Enter the number of objects in the set (n): ");
        int k = readInt("Enter the number to be chosen (k): ");
        println("C (" + n + ", " + k + ") = " + combinations (n, k) );

    }

    private int combinations (int n, int k){
        return factorial (n) / (factorial (k) * factorial (n-k));

    }

    private int factorial (int n){
        int result = 1; 

        for (int i = 1; i <= n; i++){
            result *= i;

        }
        return result;

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:06:56.080

`n`是方法的参数：因为方法被声明为`int factorial(int n)`，所以您调用它（例如）`factorial(5)`将局部变量`n`设置为`5`. （在形式上，`n`is*参数*和`5`is the *argument*，尽管通常人们不会费心区分这两个术语。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:15:53.090

所以，有点数学。通常，当处理数学表达式时，经常使用数学约定。 *n*通常是指该方法应参考的某个上限上限。

本质上，阶乘的函数定义是这样的。

```
factorial(n) = {  1 if n = 0, n*factorial(n-1) otherwise. 
```

循环*包括**n*的最终值，因此您可以获得函数的完整表达式（如果您没有，您的答案每次都会偏离*n倍。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T23:14:20.660

您需要 i <= n 因为当您计算 3 的阶乘时！例如，您将拥有 3 个！= 3 * 2 * 1 <=> 1 * 2 * 3

所以，你有你的 n，即 3，而 i 是 1，然后是 2，然后是 3 (n)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T23:13:03.140

如果你仔细观察，你会发现在循环 for i 中取一个从 1 到 n 的值，所以在 i=n 点 for 循环终止。以这种形式创建循环以确保阶乘（0）=1。但是，您可以以递归方式重新设计此函数。

# c# - 如何将JSON对象数组反序列化为c#结构

> ID：14095614
> 
> 赞同：9
> 
> 时间：2012-12-30T23:05:01.347
> 
> 标签：c#, asp.net, json, deserialization

我有一个通过序列化对象数组创建的 json 字符串：

```
[
    {
        "html": "foo"
    },
    {
        "html": "bar"
    }
] 
```

如何将其反序列化为一些可迭代的 C# 结构？我试过这段代码，但我收到`No parameterless constructor defined for type of 'System.String'.`错误：

```
string[] htmlArr = new JavaScriptSerializer().Deserialize<String[]>(html); 
```

我想要接收的是一个可迭代的结构来获取每个“html”对象。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T23:14:50.687

为每个 JSON 对象使用一个类。例子：

```
public class HtmlItem
{
   [DataMember(Name = "html")]
   public string Html { get; set; }
}

JavaScriptSerializer ser = new JavaScriptSerializer();          

// Serialize
string html = ser.Serialize(new List<HtmlItem> {
   new HtmlItem {  Html = "foo" },
   new HtmlItem {  Html = "bar" }
});

// Deserialize and print the html items.        
List<HtmlItem> htmlList = ser.Deserialize<List<HtmlItem>>(html);
htmlList.ForEach((item) => Console.WriteLine(item.Html)); // foo bar 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T23:13:19.237

您可以使用[Newtonsoft Json.NET](http://nuget.org/packages/newtonsoft.json)（可从 NuGet 获得）

```
string json = @"[{""html"": ""foo""},{""html"": ""bar""}]";
var items = JsonConvert.DeserializeObject<List<Item>>(json); 
```

在哪里

```
public class Item
{
    public string Html { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T23:15:14.697

文档站点现在显然无法正常工作......但我会尝试使用 JSON.NET ( [http://james.newtonking.com/projects/json/help/](http://james.newtonking.com/projects/json/help/) )

有几种方法可以做到这一点。您可以以一种非常动态的非严格类型的方式反序列化，或者您可以定义一个与 json 对象完全匹配的对象并反序列化为该对象。如果有多种格式的 JSON，您必须进行序列化，我建议您使用模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-28T09:43:53.237

nekman 的回答并不完全正确，属性应该是 JsonPropery 而不是 DataMember。（在这种情况下，您可以删除该属性，因为反序列化器不关心大写 H）

```
public class HtmlItem
{
   [JsonProperty("html")]
   public string Html { get; set; }
}

JavaScriptSerializer ser = new JavaScriptSerializer();          

// Serialize
string html = ser.Serialize(new List<HtmlItem> {
   new HtmlItem {  Html = "foo" },
   new HtmlItem {  Html = "bar" }
});

// Deserialize and print the html items.        
List<HtmlItem> htmlList = ser.Deserialize<List<HtmlItem>>(html);
htmlList.ForEach((item) => Console.WriteLine(item.Html)); // foo bar 
```

# python - Python - 我可以以编程方式从类实例中装饰类方法吗？

> ID：14095616
> 
> 赞同：19
> 
> 时间：2012-12-30T23:05:20.527
> 
> 标签：python, decorator, class-method

我有一个对象层次结构，其中几乎所有方法都是类方法。它如下所示：

```
class ParentObject(object):
    def __init__(self):
        pass

    @classmethod
    def smile_warmly(cls, the_method):
        def wrapper(kls, *args, **kwargs):
            print "-smile_warmly - "+kls.__name__
            the_method(*args, **kwargs)
        return wrapper

    @classmethod
    def greetings(cls):
        print "greetings"

class SonObject(ParentObject):
    @classmethod
    def hello_son(cls):
        print "hello son"

    @classmethod
    def goodbye(cls):
        print "goodbye son"

class DaughterObject(ParentObject):
    @classmethod
    def hello_daughter(cls):
        print "hello daughter"

    @classmethod
    def goodbye(cls):
        print "goodbye daughter"

if __name__ == '__main__':
    son = SonObject()
    son.greetings()
    son.hello_son()
    son.goodbye()
    daughter = DaughterObject()
    daughter.greetings()
    daughter.hello_daughter()
    daughter.goodbye() 
```

给定的代码输出以下内容：

```
greetings
hello son
goodbye son
greetings
hello daughter
goodbye daughter 
```

我希望代码输出以下内容：

```
-smile_warmly - SonObject
greetings
-smile_warmly - SonObject
hello son
-smile_warmly - SonObject
goodbye son
-smile_warmly - DaughterObject
greetings
-smile_warmly - DaughterObject
hello daughter
-smile_warmly - DaughterObject
goodbye daughter 
```

但我不想`@smile_warmly`在每个方法之前添加这一行（当我尝试在上面的代码中这样做时，我收到错误消息`TypeError: 'classmethod' object is not callable`）。相反，我希望每个方法的装饰在方法中以编程方式进行`__init__()`。

是否可以在 Python 中以编程方式装饰方法？

**编辑**：发现了一些似乎有效的东西——见下面我的回答。感谢布伦巴恩。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-30T23:21:08.630

装饰器所做的只是返回一个新函数。这个：

```
@deco
def foo():
    # blah 
```

与此相同：

```
def foo():
    # blah
foo = deco(foo) 
```

您可以随时做同样的事情，无需`@`语法，只需将函数替换为您喜欢的任何内容。因此，`__init__`在其他地方或任何地方，您都可以遍历所有方法，并为每个方法替换为`smilewarmly(meth)`.

但是，与其在 中执行此`__init__`操作，不如在创建类时执行此操作更有意义。您可以使用元类或更简单地使用类装饰器来做到这一点：

```
def smileDeco(func):
    def wrapped(*args, **kw):
        print ":-)"
        func(*args, **kw)
    return classmethod(wrapped)

def makeSmiley(cls):
    for attr, val in cls.__dict__.iteritems():
        if callable(val) and not attr.startswith("__"):
            setattr(cls, attr, smileDeco(val))
    return cls

@makeSmiley
class Foo(object):
    def sayStuff(self):
        print "Blah blah"

>>> Foo().sayStuff()
:-)
Blah blah 
```

在这个例子中，我将 classmethod 装饰放在了我的`smileDeco`装饰器中。你也可以把它放进去，`makeSmiley`以便`makeSmiley`返回`smileDeco(classmethod(val))`。（您想采用哪种方式取决于微笑装饰器与作为类方法的事物的联系程度。）这意味着您不必`@classmethod`在类内部使用。

此外，当然，在循环中，`makeSmiley`您可以包含您想要决定（例如，基于方法的名称）是否用微笑行为包装它的任何逻辑。

请注意，如果您真的想在类中手动使用，则必须更加小心`@classmethod`，因为通过类访问的类`__dict__`方法是不可调用的。所以你必须专门检查对象是否是一个类方法对象，而不是仅仅检查它是否是可调用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:18:08.700

此解决方案产生我想要的输出：

```
class ParentObject(object):
    def __init__(self):
        self._adjust_methods(self.__class__)

    def _adjust_methods(self, cls):
        for attr, val in cls.__dict__.iteritems():
            if callable(val) and not attr.startswith("_"):
                setattr(cls, attr, self._smile_warmly(val))
        bases = cls.__bases__
        for base in bases:
            self._adjust_methods(base)

    def _smile_warmly(self, the_method):
        def _wrapped(self, *args, **kwargs):
            print "-smile_warmly - " +self.__name__
            the_method(self, *args, **kwargs)
        cmethod_wrapped = classmethod(_wrapped)
        # cmethod_wrapped.adjusted = True
        return cmethod_wrapped

    def greetings(self):
        print "greetings"

class SonObject(ParentObject):
    def hello_son(self):
        print "hello son"

    def goodbye(self):
        print "goodbye son"

class DaughterObject(ParentObject):
    def hello_daughter(self):
        print "hello daughter"

    def goodbye(self):
        print "goodbye daughter"

if __name__ == '__main__':
    son = SonObject()
    son.greetings()
    son.hello_son()
    son.goodbye()
    daughter = DaughterObject()
    daughter.greetings()
    daughter.hello_daughter()
    daughter.goodbye() 
```

输出是：

```
-smile_warmly - SonObject
greetings
-smile_warmly - SonObject
hello son
-smile_warmly - SonObject
goodbye son
-smile_warmly - DaughterObject
greetings
-smile_warmly - DaughterObject
hello daughter
-smile_warmly - DaughterObject
goodbye daughter 
```

# django - TastyPie 和属性

> ID：14095625
> 
> 赞同：1
> 
> 时间：2012-12-30T23:06:53.457
> 
> 标签：django, django-models, tastypie

如果我有一个带有 django 字段和一些由 property() 函数调用的属性的 django 模型，tastepie 可以与这个虚拟字段交互吗？或者我必须在tastepie 的脱水、obj_create、obj_update 函数中包含逻辑？

模型：

```
class A (models.Model):
    x = models.CharField()
    def get_y(self):
        return self.x
    def set_y(self, value):
        self.y = value
    y = property(get_y, set_y) 
```

资源可以短至：

```
class AResource(ModelResource):
    class Meta:
        queryset = A.objects.all()
        fields = ['id','x','y'] 
```

或者应该只要：

```
class AResource(ModelResource):
    class Meta:
        queryset = A.objects.all()
        fields = ['id','x','y']

def dehydrate(self, bundle):
    bundle.data['y'] = bundle.obj.x
    return bundle

def obj_create(self, bundle, request=None, **kwargs):
    bundle.obj.y = bundle.data['y']
    bundle = super(AResource, self).obj_create(
        bundle,
        request,
    )

    return bundle

def obj_update(self, bundle, request=None, **kwargs):
    bundle = super(AResource, self).obj_update(
        bundle,
        request,
    )
    bundle.obj.y = bundle.data['y']
    return bundle 
```

如果它可以很短，那么如果我通过 tasypie 传递 x = 1, y = 2，那么 x 等于多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T23:25:01.290

如果您想要来自方法的资源上的字段，您可以包含以下内容：

```
method_field = fields.CharField(attribute='my_method') 
```

# ruby-on-rails - Rspec have_field 在 have_selector 返回成功时引发错误

> ID：14095628
> 
> 赞同：1
> 
> 时间：2012-12-30T23:07:05.297
> 
> 标签：ruby-on-rails, ruby, rspec

在下面的示例中，3 个 have_field 规范失败，而 2 个 have_selector 通过。

```
describe "without js support", js: false do
  subject { page }      

  it { should have_selector "form label[for='user_password']", text: "Password" }
  it { should have_selector "form input#user_password[name='user[password]'][type='password'][required]" }
  it { should have_field "user_password" }  # check by field id
  it { should have_field "user[password]" } # check by field name
  it { should have_field "Password" }       # check by field label
end 
```

在正在测试的模板中，我实际上有（浏览器中禁用了 js 支持）：

```
<label for="user_password" id="label_password">Password</label>
<input id="user_password" name="user[password]" required="required" type="password" /> 
```

have_selector 规范按预期通过，但 have_field 没有。为什么？

更有趣的是在我将示例更改为：

```
describe "with js support", js: true" do
... 
```

比所有 5 个规格都变成绿色。太棒了，但我不知道，我的 nojs 规格有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T21:50:54.200

好吧，我的实验表明，不是简单地测试 has_field

```
it { should have_field "user_password" } 
```

我必须明确设置字段类型

```
it { should have_field "user_password", :type => :password } 
```

然后测试通过。（小心！在类型设置中使用 :password，而不是 'password'）。

如果您必须检查密码是否有价值，可以照常进行

```
it { should have_field "user_password", :type => :password, :with => nil } 
```

# java - 试图显示整数的因子，但有困难

> ID：14095631
> 
> 赞同：2
> 
> 时间：2012-12-30T23:07:34.720
> 
> 标签：java, class, loops, parameters, constructor

我是编程新手，我不确定这个我哪里出错了。

这是我的主要方法：

```
import java.util.*;
public class DisplayFactors
{
    public static void main(String[] args)
    {
        Scanner scan = new Scanner(System.in);
        System.out.print("Enter a integer: ");
        String input1 = scan.nextLine();
        int input = Integer.parseInt(input1);

        FactorGenerator factor = new FactorGenerator(input);

        System.out.print(factor.getNextFactor());

        while (!factor.hasMoreFactors())
        {
            System.out.print(factor.getNextFactor());
        }
    }   
} 
```

这是我的课：

```
public class FactorGenerator {

    private int num;
    private int nextFactor;

    public FactorGenerator(int n)
    {
        num = nextFactor = n;
    }

    public int getNextFactor()
    {
        int i = nextFactor - 1 ;

        while ((num % i) != 0)
        {
            i--;
        }
        nextFactor = i;
        return i;
    }

    public boolean hasMoreFactors()
    {
        if (nextFactor == 1)
        {
            return false;
        }
        else
        {
            return true;
        }
    }
} 
```

目前，如果我输入 15 作为整数，我只会得到一个因子，即 5，但我需要它来显示所有因子：15、5、3 和 1。我哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:19:07.057

当你使用

```
while (!factor.hasMoreFactors())
            {
                System.out.print(factor.getNextFactor());
            } 
```

您说**虽然没有更多的因子，但将它们打印在屏幕上，但只要****因子存在于列表中**，您就需要打印它们。

 **所以在Java中你将拥有：

```
while (factor.hasMoreFactors())
                {
                    System.out.print(factor.getNextFactor());
                } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:13:29.470

```
while (!factor.hasMoreFactors())
{
    System.out.print(factor.getNextFactor());
} 
```

一定是

```
while (factor.hasMoreFactors())
{
    System.out.print(factor.getNextFactor());
} 
```**

# drop-down-menu - 使用 Webmatrix，下拉菜单将匹配的数据发布到文本框中

> ID：14095632
> 
> 赞同：0
> 
> 时间：2012-12-30T23:07:43.483
> 
> 标签：drop-down-menu, webmatrix

我有下拉菜单，我从中选择一项，然后通过使用 onblur 事件，我可以将匹配详细信息发布到输入文本框中。每当我从下拉菜单中选择时，匹配的详细信息应发布到输入文本框中。在我的示例中，我将选择一个特定的行业领域，相关问题应出现在 question1 和 question2 输入文本框中。示例如下：

```
 var db = Database.Open("me");
 var ind = Request["areagroup"];
 var sqlq = "SELECT id,indName,question1,question2 from Industry where id = @0";
 var data = db.Query(sqlq,ind);

 <select name="areagroup"  onblur="???? ">
    <option value="0">General</option>
    <option value="1">Services</option>
    <option value="2">Basic Materials</option>
 </select>

 <label>Question 1</label><input type="text" name="q1"  />
 <br/>
 <label>Question 2</label><input type="text" name="q2" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:58:49.953

我不确定你的目标。

当下拉菜单失去焦点时，下面的代码会填充输入字段：

```
@{
    var question1 = "";
    var question2 = "";

    if (IsPost)
    {
        if(Request["butt"] != "test"){
            var db = Database.Open("me");
            var ind = Request["areagroup"];
            var sqlq = "SELECT id,indName,question1,question2 from Industry where id = @0";
            var data = db.Query(sqlq,ind);
            question1 = data.question1;
            question2 = data.question2;
        } else {
            // If submit button is pressed
        }
    }
}

<form method="post">
    <select name="areagroup"  onblur="this.form.submit()">
        <option value="0">General</option>
        <option value="1">Services</option>
        <option value="2">Basic Materials</option>
    </select>
    <br/ >
    <label>Question 1</label><input type="text" name="q1" value="@question1"  />
    <br/>
    <label>Question 2</label><input type="text" name="q2" value="@question2" />
    <br/>
    <input type="submit" name="butt" value="test" />
</form> 
```

我在 IsPost 块内提供了一个提交按钮和一个 if 语句来测试表单是否由用户提交。

在我看来，更好的解决方案是使用`onchange`而不是`onblur`事件向下拉列表添加一个虚拟选项（类似于`<option value="-1">--- Please select ---</option>`）。

# html - 如果第一个不起作用，有没有办法使用后备图片 URL？

> ID：14095634
> 
> 赞同：3
> 
> 时间：2012-12-30T23:08:02.070
> 
> 标签：html, css, image

我正在考虑将我网站的图像移动到单独的主机（例如 imgur），以减少带宽使用。是否有任何技术可以用来保证即使主要主机关闭，图像仍会显示？我正在考虑使用 Javascript 可以做什么，您可以在其中检查第一个脚本标记是否已加载，如果它不起作用则动态插入另一个。

在我的特殊情况下，图像既显示为常规 HTML IMG 标记，也显示为背景图像，并带有 CSS 样式表中的 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:14:14.653

做到这一点的唯一方法[是使用 JavaScript](https://stackoverflow.com/questions/1977871/check-if-an-image-is-loaded-no-errors-in-javascript)。我真的不认为这是你需要担心的问题。

此外，您应该知道您不能将 Imgur 用作站点图像的镜像。这违反了他们的服务条款。

# python - Python：切片/括号表示法中的表达式中的空格

> ID：14095636
> 
> 赞同：0
> 
> 时间：2012-12-30T23:08:15.410
> 
> 标签：python, coding-style, pep8

> **可能重复：**
> [样式、格式化切片运算符](https://stackoverflow.com/questions/8092513/style-formatting-the-slice-operator)

[通过 PEP8](http://www.python.org/dev/peps/pep-0008/)查找，在括号/切片符号内的表达式中找不到任何有关空格的信息。例如：

```
my_list[i+n] 
```

或者

```
my_list[i + n] 
```

```
my_list[i:i+n] 
```

或者

```
my_list[i:i + n] 
```

毫无疑问，您对编码的重要方面有何偏好？

# python - 我的简单 python 脚本中的错误

> ID：14095641
> 
> 赞同：0
> 
> 时间：2012-12-30T23:09:11.697
> 
> 标签：python, input

我在python中制作了这个脚本：

```
a=raw_input("Enter your Name here:")
b=raw_input("Enter Your Country Name here:")
c=input("Enter Your Phone Number Here:") 
```

--->问题是当我输入一个像 123456 这样的数字时它不会出错，但是当我输入 123456789 或 0682020687 时它会出错。

有人可以解释为什么会发生这种情况以及如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T23:14:37.630

在 Python 2.x 中，以零开头的数字将其标记为八进制。如果您想要以 0 开头的电话号码，您也应该将电话号码作为字符串获取，请使用`raw_input`：

```
c = raw_input("Enter Your Phone Number Here:") 
```

出现此问题的原因是您不允许在八进制数中使用 8。所以 0682020687 会引发错误。123456789 应该不是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:17:51.197

我认为您的问题是使用`input`而不是`raw_input`最后一行。

正如文档所说，`input`将导致输入被评估，`eval`正如 Faruk Sahin 所说，这将导致数字被评估为八进制数，其中 0682020687 不是有效的八进制数。请参阅：[http ://docs.python.org/2/library/functions.html#input](http://docs.python.org/2/library/functions.html#input)

将最后一行更改为：

```
c = raw_input("Enter Your Phone Number Here:") 
```

它将输入作为字符串读取并将其存储在变量`c`. （就像你在前两行所做的一样）

获得该字符串后，您可以使用以下`int`函数将其转换为数字：

```
c = int(raw_input("Enter Your Phone Number Here:")) 
```

如果输入不是一个有效的整数，它会抛出一个你可以捕获的异常。请参阅：[http ://docs.python.org/2/library/functions.html#int](http://docs.python.org/2/library/functions.html#int)

您还应该注意，如果您切换到使用 python 3，您将需要替换所有与 python 2中相同的`raw_input`函数。请参阅：[http://docs.python.org/3.0/library/functions。 html#输入](http://docs.python.org/3.0/library/functions.html#input)`input``raw_input`

# plugins - 如何删除 WordPress 中默认的“插件激活”消息？

> ID：14095642
> 
> 赞同：0
> 
> 时间：2012-12-30T23:09:18.183
> 
> 标签：plugins, wordpress

我已经成功地找到了如何在我的插件被激活时显示自定义消息，但我没有显示默认消息。有没有办法做是？

```
function plugin_activate() {
  add_option('plugin_activated', true);
} register_activation_hook(__FILE__, 'plugin_activate');

function plugin_activated() {
  if(get_option('plugin_activated', false)) {
    delete_option('plugin_activated');
    add_action('admin_notices', create_function('', 'echo 
    \'<div class="updated fade"><p>My plugin is <strong>activated</strong>. <a href="options-general.php?my-plugin">Configure it →&lt;/a></div>\';'));
  }
} add_action('admin_init', 'plugin_activated'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T08:44:07.023

您可以添加如下内容：`echo '<style>div#message.updated{ display: none; }</style>';`

也可能有一个钩子，如果你想在周围搜索，如果它存在，你应该找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T12:46:38.970

我得出的结论是，这既不是必需的，也不是用户友好的，因为可以同时激活多个插件，并且将个性化消息添加为工具提示。

# php - “onload”和 XHTML 验证的问题

> ID：14095643
> 
> 赞同：0
> 
> 时间：2012-12-30T23:09:23.647
> 
> 标签：php, javascript, xhtml, onload, w3c-validation

我的名字是 Manuel，我是一名网页设计专业的学生，​​并且开始迈出网页设计的第一步。最近我试图验证

这个网站：

[http://accesosnormalizados.com](http://accesosnormalizados.com)

我使用了 W3C 验证器，起初我发现了大约 30 个错误，并且可以纠正所有错误，除了一个说：'没有属性

“负载”'。

显然不支持 XHTML onload 标签，我使用了一个名为 Vertical Menu 的 Joomla 扩展。这是一个免费的扩展，运行良好，但我发现它有一些错误，尤其是在验证网站时。

这是扩展的 PHP 代码：

```
 get( 'menutype', 'mainmenu' );
    $qry = "SELECT id, name,parent, link,type,browserNav FROM #__menu WHERE menutype = '".$menutype."' AND published = 1 ORDER BY ordering";
    $database->setQuery($qry);
    $rows = $database->loadObjectList();

    if(isset($GLOBALS['vertical_menu'])) $GLOBALS['vertical_menu']++;
    else $GLOBALS['vertical_menu'] = 0;

        function getMenuChildList($rows, $parentId) {
            $childRows = array();
            foreach ($rows as $row) {
                if ($row->parent == $parentId) {
                    $childRows[] = $row;
                }
            }
            return $childRows;
        }

        function drawVerticalMenu($rows, $showsubcats, $parentId = 0) {
            $categories = $showsubcats || !$parentId ? getMenuChildList($rows, $parentId) : array();
            if ($parentId) {
                if (!count($categories)) {
                    echo '';
                    return;
                } else echo '';
                echo '';
            } else echo '';
            echo '';
            foreach ($categories as $category) {
                $link = $category->link. (preg_match("/^http:\/\/|^https:\/\//",$category->link)? "" : '&Itemid='.$category->id);
                $blank = $category->browserNav? ' target="_blank" ' : ' ';
                echo 'id.'" class="menu">'.$category->name.' ';
                drawVerticalMenu($rows, $showsubcats, $category->id);
            }
            echo '';
            if ($parentId && count($categories)) echo '';
        }

    $document = &JFactory::getDocument();
    $document->addScript('https://ajax.googleapis.com/ajax/libs/dojo/1.5.0/dojo/dojo.xd.js');
    $document->addScript('modules/mod_vertical_menu/script/menu.js');
    $document->addStyleSheet('modules/mod_vertical_menu/style/menu.css');
    $document->addCustomTag('

    div#MenuContainer'.$GLOBALS['vertical_menu'].' table#VerticalMenu'.$GLOBALS['vertical_menu'].' {
        width: '.$params->get('categorymenu_width', 150).'px;
        opacity: '.$params->get('categorymenu_out', 0.8).';
        FILTER:  progid:DXImageTransform.Microsoft.Alpha(Opacity='.($params->get('categorymenu_out', 0.8)*100).');
    }

    ');
    echo '';
    drawVerticalMenu($rows, $params->get('show_subcats', 1));

    echo 'get('categorymenu_out', 0.8).',over : '.$params->get('categorymenu_over', 1).',duration : '.$params->get('categorymenu_fade', 300).',id : '.$GLOBALS['vertical_menu'].',width : '.$params->get('categorymenu_width', 150).'});" alt=""/>';
    echo '';

    ?> 
```

问题在最后：

```
 echo '';
    drawVerticalMenu($rows, $params->get('show_subcats', 1));

    echo 'get('categorymenu_out', 0.8).',over : '.$params->get('categorymenu_over', 1).',duration : '.$params->get('categorymenu_fade', 300).',id : '.$GLOBALS['vertical_menu'].',width : '.$params->get('categorymenu_width', 150).'});" alt=""/>';
    echo '';

    ?> 
```

我认为当用户将鼠标指针移到它上面时，扩展使用 onload 事件来显示子菜单。

我想要的是用其他事件处理程序或 XHTML 支持的其他标签替换 onload，这与 onload 类似。

我会很感激你的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:32:53.913

您可以删除 onload 属性，然后在页面中添加一些简单的 javaScript 以在页面完成加载时运行一些功能。

它看起来像这样：

```
<script>
    window.onload=function(){
       new WW.VerticalMenu({out : 1,over : 1,duration : 300,id : 0,width : 180}); // example of one of the functions being run
    };
</script> 
```

祝你学业顺利

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:34:59.267

看来来源是这样出来的

```
<img src="/modules/mod_vertical_menu/images/center.gif" style="display:none" onload="new WW.VerticalMenu({out : 1,over : 1,duration : 300,id : 0,width : 180});" alt=""/> 
```

因为这看起来像是实例化菜单的一种令人讨厌的方法，所以我会尝试通过删除有问题的 php echo 部分来完全放松该属性，而是添加 javascript 来加载，因为这是使用 dojo 也许这会有所帮助——对不起，我不使用 dojo [http://mail.dojotoolkit.org/pipermail/dojo-interest/2012-May/066106.html](http://mail.dojotoolkit.org/pipermail/dojo-interest/2012-May/066106.html)

所以 php 明智这将是

```
echo '<img src="modules/mod_vertical_menu/images/center.gif" style="display:none"  alt=""/>'; echo '</div>'; 

 echo "<script>" ."javascript or dojo script here ".</script>" 
```

如果可以的话，我什至建议删除图像并使用下面提倡的窗口加载

# javascript - Python 中的列表 => Javascript 翻译

> ID：14095653
> 
> 赞同：0
> 
> 时间：2012-12-30T23:12:02.903
> 
> 标签：javascript, python, python-2.7

```
for i in [name, matches_total, matches_won, matches_lost]:
    doSomething(i) 
```

我尝试为 JS 执行此操作，但没有成功。基本上，我希望它对每个变量做任何事情。我如何用 JS 做到这一点？

我的尝试：

```
for (i in [name, matches_total, matches_won, matches_lost]){
    doSomething(i);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:17:09.580

JavaScript 没有完全相同的`in`运算符。如果您在支持 的环境中`forEach`，则它的风格相对接近（除了您为循环定义了一个内部匿名函数，有点像 Python `lambda`：

```
[name, matches_total, matches_won, matches_lost].forEach(function(i) {
    doSomething(i);
}); 
```

在这种情况下（你在每个列表项上调用一个函数的情况）你可以用一种我觉得语法上很好的方式来简化它：

```
[name, matches_total, matches_won, matches_lost].forEach(doSomething); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:13:27.677

```
for (var i = 0; i < list.length; ++i) {
    doSomething(list[i]);
} 
```

有两种 for 循环，一种`for-in`是为对象设计的循环，另一种是三语句 for 循环`for (;;)`。`for-in`不建议在数组上使用，因为它也会遍历其原型链。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:24:07.180

```
var my_array = [name, matches_total, matches_won, matches_lost]

for (var i in my_array){
    doSomething(my_array[i]);
} 
```

# android - 长按时是否可以更改 NumberPicker 的增量？

> ID：14095656
> 
> 赞同：2
> 
> 时间：2012-12-30T23:12:36.723
> 
> 标签：android, android-widget, numberpicker

我有 3900 个号码范围，用户可以`NumberPicker`从中选择一个号码。现在，当长按选择器中的向上/向下箭头时，数字会缓慢增加/减少。我已经坐到了`setOnLongPressUpdateInterval()`0 毫秒，但在这么大的数字范围内它仍然缓慢增加。

**长按**向上/向下箭头时是否可以更改选择器中的增量，以便将数字增加 100，并在释放按钮时返回增量 1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T04:29:13.860

我采用了这种方法，因为困住长按的工作似乎令人担忧。

```
NumberPicker _picker;
long _tsLastChange;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.number_picker);

    _picker = (NumberPicker) findViewById(R.id.picker);
    _picker.setMinValue(1);
    _picker.setMaxValue(3900);
    _picker.setOnLongPressUpdateInterval(100);

    _picker.setOnValueChangedListener(new OnValueChangeListener() {

        @Override
        public void onValueChange(NumberPicker picker, int oldVal, int newVal) {
            Log.d("NumberPickerActivity", "value changed detected");
            long tsChange = System.currentTimeMillis();
            if (tsChange - _tsLastChange < 200)
            {
                if (newVal > oldVal)
                    _picker.setValue(newVal + 100);
                else 
                    _picker.setValue(newVal - 100);
            }
            _tsLastChange = tsChange;
        }
    });
} 
```

要使其在 IRL 中起作用，您可能希望 (a) 将“newVal”四舍五入到最接近的 100 或其他值，并且 (b) 比我更担心环绕案例。

令我有些惊讶的是，程序化`setValue`似乎不会导致`onValueChangedListener`.

`NumberPicker`我使用“Theme.Black”主题在 4.1 模拟器上对此进行了测试，以获得带有 +/- 按钮的“老式” 。

# ruby-on-rails - 一个提交标签，同一页面上的两个表单

> ID：14095657
> 
> 赞同：0
> 
> 时间：2012-12-30T23:12:37.070
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms

我正在寻找解决这个问题的最佳方法。我在同一页面上有两个搜索表单（它们每个都搜索不同的 api 以获取信息），我希望有一个提交按钮，然后根据哪个表单具有内容来调用相关的 api。所以我虽然可以像这样在每个表单上提交时指定控制器操作

```
<div class="container margin50">
 <div class="row">
  <div class="span6 offset3 cf formBackground">
  <h1>CoverArt Finder</h1>

  <h3>Search Movies</h3>
  <%= form_tag main_results_path, :method => "get" %>
  <%= text_field_tag 'search', nil, :placeholder => 'Enter Film Name Here.....' %>

  <h1>OR<h1>

  <h3>Search Albums</h3>
  <%= form_tag album_album_results_path, :method => "get" %>
  <%= text_field_tag 'search', nil, :placeholder => 'Enter Artist Name here.....' %>
  <%= submit_tag "search" %>

</div>
</div>
</div> 
```

显然这不起作用，因为我总是得到电影搜索参数的结果。我需要一个条件语句来识别填写的表格吗？我有点不确定这里。

需要任何其他信息请询问

任何帮助表示赞赏

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:20:59.070

如果您愿意做这个客户端（JavaScript / jQuery），它应该不会太麻烦。单击提交按钮时，您可以检查哪个表单具有值。一些简单的 sudo 代码：

```
on submitButton click:

if formA.someValue != null
  post / submit formA
else if formB.someValue != null
  post / submit formB 
```

# ajax - 在扩展 default_popup 中使用 aJax？

> ID：14095659
> 
> 赞同：0
> 
> 时间：2012-12-30T23:12:51.437
> 
> 标签：ajax, google-chrome, jquery, google-chrome-extension

我可以在我的 Google Chrome 扩展程序“default_popup”中以某种方式使用 aJax。

我尝试了以下...

清单.json：

```
{
  "name": "My extension",
  "manifest_version": 2,
  "version": "1.0",
  "permissions": [
    "tabs", "http://*/*"
  ],
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
  "content_scripts": [
    {
      "matches": ["http://*/*", "https://*/*"],
      "js": ["jquery-1.8.3.min.js", "content.js"],
      "run_at": "document_end"
    }
  ]
} 
```

popup.html：

```
<html>
<body>
<script>
$.ajax({
    type: "GET",
    url: "http://www.mysite.com/api.php"
}).done(function(response) {
    alert("work");
}).fail(function(response) {
    alert("doesn't work");
});
</script>
</body>
</html> 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:26:26.887

这是可能的，但您很可能必须使用[JSONP](https://stackoverflow.com/questions/2887209/what-are-the-differences-between-json-and-jsonp)。您可以使用已有的内容作为基础，因此不需要太多重构。

# mongodb - C# 中的 MongoDB 查询

> ID：14095661
> 
> 赞同：0
> 
> 时间：2012-12-30T23:13:03.277
> 
> 标签：mongodb

我想获取与特定子句匹配的某些文档，但不知道如何在关系数据库中实现 WHERE 效果。我有一个简单的数据库，其中包含单词及其翻译（具有 2 个字段的对象）并使用此代码

```
var words = database.GetCollection<Word>("Dictionary") 
```

得到他们。但这得到了整个集合。如果集合中有数千条记录怎么办？如何获得我想要的记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-06T21:21:33.223

这假设您有一个名为 Word 的类，它像您的集合一样建模。

```
MongoServer _server = new MongoClient(connectionString).GetServer();
MongoDatabase _database = _server.GetDatabase(database);
MongoCollection _collection = _database.GetCollection(collection);

var results = _collection.FindAs<Word>(Query.EQ("MyField","WordToFind")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-11T07:34:12.837

使用正则表达式匹配如下。'i' 表示不区分大小写。

```
var collections = mongoDatabase.GetCollection("Abcd");

var queryA = Query.And(
         Query.Matches("strName", new BsonRegularExpression("ABCD", "i")), 
         Query.Matches("strVal", new BsonRegularExpression("4121", "i")));

var queryB = Query.Or(
       Query.Matches("strName", new BsonRegularExpression("ABCD","i")),
       Query.Matches("strVal", new BsonRegularExpression("33156", "i")));

var getA = collections.Find(queryA);
var getB = collections.Find(queryB); 
```

对于在查询中使用“与”或“或”，如果您想搜索多个字段。

# java - 如何在 Java 中构建这种 GUI 效果？

> ID：14095667
> 
> 赞同：-2
> 
> 时间：2012-12-30T23:13:40.610
> 
> 标签：java, user-interface

我是 Java 新手，我想制作一个像 [http://www.oopixel.com/games/samegame/](http://www.oopixel.com/games/samegame/)这样的小游戏 ，我想制作像黄色框一样的效果![在此处输入图像描述](../Images/d7d5ef91caf70eee6ee541220a497830.png)

我的问题是应该从哪里开始，因为我不知道要查找它的名称请帮助我我已经花了几个小时，但我没有得到任何东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:22:01.180

你可以在 JOGL 中阅读，它是一个包装库，允许在 Java 编程语言中使用 OpenGL

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:31:12.723

好吧，如果您在黄色框中的蓝色背景上谈论“+15”，这 似乎是一个**工具提示。**

这是官方的 Oracle Java Swing 教程和工具提示示例： [http ://docs.oracle.com/javase/tutorial/uiswing/components/tooltip.html](http://docs.oracle.com/javase/tutorial/uiswing/components/tooltip.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T00:05:18.787

`JToggleButton`您可以使用in 的实例创建自己的游戏版本，`GridLayout`如下所示[。](https://sites.google.com/site/drjohnbmatthews/buttons)可以使用with a在[玻璃窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html#glasspane)上绘制黄色矩形。正如@informatik01 所建议的那样，它看起来很像一个[工具提示。](http://docs.oracle.com/javase/tutorial/uiswing/components/tooltip.html)参见这个简单的。`drawRect()``Stroke``4``+15`[`MVCGame`](https://stackoverflow.com/a/3072979/230513)

# c# - Silverlight 事件处理程序响应极慢

> ID：14095669
> 
> 赞同：0
> 
> 时间：2012-12-30T23:13:52.967
> 
> 标签：c#, silverlight, event-handling

我正在创建一个动态六角网格，8 列 10 个六角形，一个椭圆以随机六角形为中心。

我原本以为事件处理程序没有加载。现在看起来他们正在加载，但反应非常缓慢。当我在一两分钟后将鼠标悬停在生成的网格上时，十六进制开始随机填充并且工具提示开始显示（但直到该十六进制的事件处理程序响应）。最后一个十六进制响应鼠标悬停事件实际上需要几分钟时间。

```
 private void CreateHexGrid(int columns, int rows, double length)
    {
       //I create a jagged array of points, 
       //hexpoint[# of columns, # of rows, 6 points]
       //the base (0,0) hex is generated point by point 
       //mathematically based on the length of one side 
       //then each subsequent hex is mathematically
       //created based on the points of the previous hex.
       //Finally, I instantiate each Polygon hex and fill 
       //its points collection using the array.
              PointCollection points = new PointCollection();
              SolidColorBrush blackBrush = new SolidColorBrush(Colors.Black);
              SolidColorBrush clearBrush = new SolidColorBrush(Colors.Transparent);
              Polygon hex = new Polygon();
              hex.Stroke = blackBrush;
              hex.StrokeThickness = 1;
              hex.Name = "Hex" + column.ToString() + row.ToString();

              for (int point = 0; point < 6; point++)
               {
                  points.Add(HexPoint[column, row, point]);
               }

              hex.Points = points;
              ToolTipService.SetToolTip(hex, hex.Name);
              hex.MouseEnter += new MouseEventHandler(hex_MouseEnter);
              cnvsHexGrid.Children.Add(hex);
       //....
     } 
```

目前我有处理程序只是试图改变多边形/椭圆的填充颜色来测试。如果单击十六进制，我最终想生成一个交互式弹出窗口。

```
 void hex_MouseEnter(object sender, MouseEventArgs e)
    {
        var hex = sender as Polygon;
        SolidColorBrush blueFill = new SolidColorBrush(Colors.Blue);
        hex.Fill = blueFill;
    } 
```

我做错了什么导致如此缓慢，缓慢，缓慢的反应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T06:34:30.843

在 Load_Main 中添加一个处理程序似乎有助于解决这个问题。

# javascript - 对象中的 JavaScript setTimeout

> ID：14095681
> 
> 赞同：0
> 
> 时间：2012-12-30T23:14:54.280
> 
> 标签：javascript, settimeout

我试图给一个对象一个倒计时计时器，当倒计时结束时，它应该调用一个从数组中删除该对象的函数。

```
array = [];

var object = {
    'name' : 'user',
    'limit' : function() {
         setTimeout(destroyMe(this),10000);
    }
}

array.push(object);

var destroyMe = function(obj) {
    array.remove(obj);
} 
```

我知道这可能有问题，但超时功能根本不起作用，甚至不像这样：

```
var object = {
    'name' : 'user',
    'limit' : function() {
               setTimeout(console.log("dd"),3000);
            }
} 
```

也许有人可以告诉我我的 setTimeout 版本的问题。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T23:18:14.743

setTimeout 引用一个函数。您拥有的代码正在调用该函数。

这应该改为：

```
var object = 
{
    'name' : 'user',
    'limit' : function() 
    {
        setTimeout(function() { destroyMe(this); }, 10000);
    }
} 
```

（在这种情况下您可能会遇到问题`this`，试试吧！）

```
var object = 
{
    'name' : 'user',
    'limit' : function() 
    {
        setTimeout( function() { console.log("dd"); },3000);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:18:44.970

您需要将*函数*传递给`setTimeout`，而不是函数调用。

```
var object = {
    'name' : 'user',
    'limit' : function() {
         setTimeout(function() { 
             destroyMe(this)
         }, 10000);
    }
}; 
```

正如您已经知道的那样，`this`可能不会像您期望的那样做。替换`destroyMe(this)`为`console.log("dd")`应该会导致您期望的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:23:05.070

`setTimeout`要么接受回调（一个函数，而不是带参数的函数调用）或引号中的代码。但是，正如在[这个问题](https://stackoverflow.com/questions/6081560/is-there-ever-a-good-reason-to-pass-a-string-to-settimeout)中指出的那样，仅出于历史原因才允许传递字符串 - 在实践中没有任何好的理由这样做。

但是，为了完整起见，做你想做的一种方法是：

```
var object = {
    'name' : 'user',
    'limit' : function() {
               setTimeout('console.log("dd")', 3000);
            }
} 
```

# php - 在 php 中使用循环创建 css/html 元素的想法

> ID：14095683
> 
> 赞同：-1
> 
> 时间：2012-12-30T23:15:07.417
> 
> 标签：php, html, mysql, css, loops

我需要在网页中放置一大堆（数百个）图形元素。我想使用 html 和 css，但要使用 PHP 脚本（使用循环），这样我就不必手动操作了。我可以创建一个这样的表（例如，以逗号分隔），我可以导入到 Mysql：

```
Element,Width,Height,x-position,y-position,image
1,24,26 30,40,Photo1.jpg
2,46,34,50,78,Photo2.jpg 
```

一堆更多的数据点。

我需要生成的实际代码是（例如）：

```
#element1{
height: 26px;
width: 24px;
top: 40px;
right: 30px;
background-image: url(Photo1.jpg);
} 
```

当然会有一堆这些，从表中读取值。

我是编程新手。提前感谢您的所有建议和想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:28:33.230

页面显示会很慢。直接来自 CSV 并使用内联 css 而不是每个元素的一组规则

PHP

```
$csv=file_get_contents('thecsvfile.csv');
$images=explode("\n", $csv);
unset($csv); // don't want this in memory any more

foreach ($images as $image) {
    $bits=explode(',', $image);
    # 0:Element, 1:Width, 2:Height, 3:x-position, 4:y-position, 5:image
    echo '<img src="'. $bits[5] .'" style="position:absolute; width:' 
        . $bits[1] .'px; height:' . $bits[2] .'px; left:'
        . $bits[3] .'px; top: ' . $bits[4] .'px;" alt="' . $bits[0] .'" />';
} 
```

编辑为使用 img 标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:22:04.670

内联样式更容易，例如： `<div style="height:40px;width:60px;..."></div>`

最好按 id 为每个元素创建单独的 css 规则

# javascript - 选择元素的ajax联系表单错误

> ID：14095689
> 
> 赞同：0
> 
> 时间：2012-12-30T23:16:16.460
> 
> 标签：javascript, jquery, ajax

我通过输入字段和选择元素进行了 ajax 联系，但它没有给出应有的结果。

HTML 表单代码（名称作为输入，iphone 作为选择元素）

```
 <div id="contact_form">
    <form name="contact" method="post" action="">Name
        <input type="text" name="name" id="name" />Iphone
        <select name="iphone" id="iphone">
            <option value="Iphone 4" selected>Iphone 4</option>
            <option value="Iphone 4S">Iphone 4S</option>
            <option value="5">Iphone 5</option>
        </select>
        <input type="submit" name="submit" class="button" id="submit_btn" value="Send"
        />
    </form>
</div> 
```

JS代码

```
 $(function () {
       $('.error').hide();
       var dataString = 'name=' + name + '&iphone=' + iphone;
       $.ajax({
           type: "POST",
           url: "send.php",
           data: dataString,
           success: function () {
               $('#contact_form').html("<div id='message'></div>");
               $('#message').html("<h2>Contact Form Submitted!</h2>")
                   .append("<p>We will be in touch soon.</p>")
                   .hide()
           }
       });
       return false;
   }); 
```

PHP (send.php) 代码

```
<?PHP
$name = $_POST['name'];
$iphone = $_POST['iphone'];

$email="my@mail.com";
$from="anyone@mail.com";

$subject="Contact Email";
$headers = "Content-type: text/html; charset=windows-1256\r\n";
$headers .= "From: $from\r\n";

$mailtext="name : $name - Iphone : $iphone";

mail($email,$subject,$mailtext,$headers);
?> 
```

当我将 from 与任何人的名字一起使用时的结果

```
Name : anyone - Iphone : [object HTMLSelectElement] 
```

[object HTMLSelectElement]***这是错误*** 似乎选择元素不起作用并且没有传递其选定的值

所以有什么想法吗？~ 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T08:54:39.057

我稍微修改了您的代码，我所做的是在您的表单上附加了一个提交处理程序，阻止了默认操作，这是重要的部分。我序列化你的表单的内容。试试这个，告诉我这是怎么回事。我通常会像这样提交我的 ajaxified 表单。虽然我不确定这是否是一个好习惯，但你应该试试这个。

```
 $(function () {

        $('.error').hide();
        $('form[name=contact]').submit(function(e){
            e.preventDefault();
            var form_data = $(this).serialize();        
            $.ajax({
                type: "POST",
                url: "send.php",
                data: form_data,
                success: function () {
                    $('#contact_form').html("<div id='message'></div>");
                    $('#message').html("<h2>Contact Form Submitted!</h2>")
                        .append("<p>We will be in touch soon.</p>")
                        .hide()
                }
            });
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:43:09.383

确保您获得 iPhone 的价值，如下所示：

```
var iphone = $("#iphone").val(); 
```

`$.post`对于你正在做的事情会更优雅......

```
$.post("send.php", { name: name, iphone: iphone },
   function(data) {
     alert("Data Loaded: " + data);
   }); 
```

# gwt - 无法编译播放展示 html

> ID：14095696
> 
> 赞同：1
> 
> 时间：2012-12-30T23:17:00.570
> 
> 标签：gwt, maven, playn

我安装了 playN 但是我收到了这个错误：

[INFO] --- gwt-maven-plugin:2.4.0:compile (default) @ playn-showcase-html --- [ERROR] 错误：无法找到或加载主类 com.google.gwt.dev.Compiler

我检查了 m2 存储库，2.4 2.5 gwt 的 gwt jar 似乎在那里。

如果我尝试在项目中使用 GWT 2.5，那么我会得到这个

项目构建路径上的 GWT SDK 'C:\Users\user.m2\repository\com\google\gwt' 无效（不支持版本，必须为 2.0.0 或更高版本）
playn-showcase-html
Unknown Google Web 工具包问题

这有意义吗？如何解决？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T21:42:58.490

maven 存储库中的一些 gwt jar 似乎已损坏。我删除了它们，我再次运行 playN 示例，jar 下载正确，整个想法都有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T04:57:27.523

`C:\Users\user.m2`<——这很奇怪。看起来您的 Maven 存储库路径以某种方式被修改了。

检查您的环境变量`MAVEN_REPOSITORY`，看看它是否设置为`C:\Users\user`. 另外，找到你的 maven 安装目录，并在`conf`目录下查找 . `settings.xml`，看看你是否有`<localRepository>${env.MAVEN_REPOSITORY}/.m2/repository</localRepository>`.

# android - Android 中高效的位图内存使用

> ID：14095699
> 
> 赞同：0
> 
> 时间：2012-12-30T23:17:32.770
> 
> 标签：android, memory, bitmap, imageview, scaling

这是关于 Android 管理位图的方式的一般性问题。我想知道从内存的角度来看，为 ImageViews 提供正确大小的位图是否比 Android 必须缩放的大小不正确的位图更好。作为一个工作示例，如果我们假设 ImageView 1000 x 1000 并且我设置了一个 1024 x 1024 (FitCentre) 的位图，Android 将不得不缩放图像。那么它是否必须同时保留原始图像和缩放版本，或多或少地使内存使用量增加一倍？如果在替代方案中我向 1000 x 1000 ImageView 呈现 1000 x 1000 位图，是否只保留一张图像？只是一个问题，所以我知道处理位图的最有效方法，尤其是大图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:34:39.983

Android 将缩放您的图像，但这将在您的图像加载到内存后发生，并且不会阻止臭名昭著的**OutofMemoryError**异常的发生。

解决方案是在将图像加载到内存之前对其进行缩放，然后使用它。

Android 文档详细解释了如何缓解此问题，以及如何有效地显示位图：http: [//developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

# c++ - 处理低级字节操作时 reinterpret_cast 不好吗？

> ID：14095702
> 
> 赞同：9
> 
> 时间：2012-12-30T23:17:54.630
> 
> 标签：c++, casting, c++11, reinterpret-cast

我正在编写一个 websocket 服务器，我必须处理需要取消屏蔽的屏蔽数据。

掩码是 unsigned char[4]，数据也是 unsigned char* 缓冲区。

我不想逐字节异或，我更愿意一次异或 4 个字节。

```
uint32_t * const end = reinterpret_cast<uint32_t *>(data_+length);
for(uint32_t *i = reinterpret_cast<uint32_t *>(data_); i != end; ++i) {
    *i ^= mask_;
} 
```

在这种情况下使用 reinterpret_cast 有什么问题吗？

替代方案是以下代码，它不那么清晰且不那么快：

```
uint64_t j = 0;
uint8_t *end = data_+length;
for(uint8_t *i = data_; i != end; ++i,++j) {
    *i ^= mask_[j % 4];
} 
```

我对替代方案很感兴趣，包括依赖于 c++11 功能的替代方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T23:56:58.610

以下是发布的方法的一些潜在问题：

1.  在某些类型大于`char`需要正确对齐才能访问的系统对象上。的一个典型要求`uint32_t`是对象与可被四整除的地址对齐。
2.  如果`length / sizeof(uint32_t) != 0`循环可能永远不会终止。
3.  根据系统的字节序`mask`需要包含不同的值。如果`mask`是由`*reinterpret_cast<uint32_t>(char_mask)`一个合适的数组产生的，那么它不应该是一个数组。

如果这些问题都处理好了，`reinterpret_cast<...>(...)`就可以在你有的情况下使用。重新解释指针的含义是该操作存在并且有时需要它的原因之一。不过，我会创建一个合适的测试用例来验证它是否正常工作，以避免在将代码移植到不同平台时不得不寻找问题。

就个人而言，我会采用不同的方法，直到分析显示它太慢：

```
char* it(data);
if (4 < length) {
    for (char* end(data + length - 4); it < end; it += 4) {
        it[0] ^= mask_[0];
        it[1] ^= mask_[1];
        it[2] ^= mask_[2];
        it[3] ^= mask_[3];
    }
}
it != data + length && *it++ ^= mask_[0];
it != data + length && *it++ ^= mask_[1];
it != data + length && *it++ ^= mask_[2];
it != data + length && *it++ ^= mask_[3]; 
```

我肯定在软件中使用了许多类似的方法，这些方法意味着更快，并且没有发现它们是一个显着的性能问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:54:26.777

`reinterpret_cast`在这种情况下没有什么特别的错误。但是，保重。

现有的 32 位循环是不正确的，因为它不适合有效负载大小不是 32 位倍数的情况。我想有两种可能的解决方案：

*   在 for 循环检查中替换`!=`with `<`（人们使用 是有原因的`<`，而不是因为他们很笨......）并按字节执行尾随 1-3 个字节
*   安排缓冲区，使有效负载部分的缓冲区大小是 32 位的倍数，并对额外的字节进行异或。（大概代码在向调用者返回字节时会检查有效负载长度，所以这无关紧要。）

此外，根据代码的结构，您可能还必须处理某些 CPU 的未对齐数据访问。如果您在 32 位对齐的缓冲区中缓冲了整个帧、标头和所有内容，并且有效负载长度小于 126 字节或 >65,535 字节，则掩码键和有效负载都将未对齐。

不管它值多少钱，我的服务器使用类似于第一个循环的东西：

```
for(int i=0;i<n;++i)
    payload[i]^=key[i&3]; 
```

与 32 位选项不同，这基本上是不可能出错的。

# c# - 使用 xmlns 属性时 XML 阅读器找不到元素

> ID：14095705
> 
> 赞同：0
> 
> 时间：2012-12-30T23:18:29.380
> 
> 标签：c#, xml, linq

我正在使用 Visual Studio for Windows Phone，当 XML 数据的父级中有属性时，我的 XML 阅读器代码不起作用。

我的 C# 代码

```
namespace youtube_xml
{
  public partial class MainPage : PhoneApplicationPage
  {
    // Constructor
    public MainPage()
    {
        InitializeComponent();
        SupportedOrientations = SupportedPageOrientation.PortraitOrLandscape;
    }
    private void listBox1_Loaded(object sender, RoutedEventArgs e)
    {
        var element = XElement.Load("Authors.xml");
        var authors =
        from var in element.Descendants("feed")
        select new Authors
        {
            AuthorName = var.Attribute("scheme").Value,
        };

        listBoxAuthors.DataContext = authors;
    }
    public ImageSource GetImage(string path)
    {
        return new BitmapImage(new Uri(path, UriKind.Relative));
    } 
  }
} 
```

工作 XML 数据

```
<?xml version='1.0' encoding='UTF-8'?>
<feed>
  <category scheme='http://schemas.google.com/g/2005#kind'/>
</feed> 
```

不工作的数据（注意：根元素“feed”中的属性“xmlns”）

```
<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns='http://www.w3.org/2005/Atom' >
  <category scheme='http://schemas.google.com/g/2005#kind'/>
</feed> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:22:48.123

欢迎来到*XML 命名空间*的世界！问题不在于“有一个属性”这一事实——而是它导致它下面的所有东西都在一个命名空间中。你不能再说`.Attribute("scheme")`了，因为那只会在空的命名空间中寻找东西。命名空间是通过基于运算符重载的装置来使用的：

```
XNamespace atom = "http://www.w3.org/2005/Atom'";

// And now you can say:

.Descendants(atom + "feed")
.Attribute(atom + "scheme") 
```

等等。将字符串分配给 XNamespace 变量的能力归功于隐式转换运算符。这里`+`实际上构造了一个 XName （顺便说一下，它也有一个从字符串的隐式转换 - 这就是为什么`.Elements("feed")`即使参数类型不是字符串你也可以正常工作的原因）

实用提示：您可以将属性转换为某些类型，而不是使用`.Value`，例如`(string)foo.Attribute(atom + "scheme")`。它也适用于许多其他类型，例如`int`.

# java - FXML 设置 TableView 列大小调整策略

> ID：14095708
> 
> 赞同：8
> 
> 时间：2012-12-30T23:18:52.767
> 
> 标签：java, tableview, javafx-2, fxml

如何从 FXML 设置 TableView 的调整大小策略？我这样累了，但它不起作用：

```
<TableView layoutX="20.0" layoutY="20.0" prefWidth="674.0" prefHeight="668.0" fx:id="tableView" fx:constant="CONSTRAINED_RESIZE_POLICY">
    <columns>
        <TableColumn text="First Name" />
        <TableColumn text="Last Name" />
        <TableColumn text="Email Address" />
    </columns>    
</TableView> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-31T22:41:26.597

要使用 fxml 为 tableview 设置 columnresize 策略，您必须使用`<columnResizePolicy>`tag 。这将适用于 javafx 2.2 及更高版本..

```
<TableView>
  <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
</TableView> 
```

参考 ：

[使用 fxml 定义 TableView columnResizePolicy 属性](http://javafx-jira.kenai.com/browse/RT-19228?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#issue-tabs)

# payflowpro - Paypal api销售交易权限不足错误

> ID：14095710
> 
> 赞同：0
> 
> 时间：2012-12-30T23:18:57.103
> 
> 标签：payflowpro

我正在使用 Paypal Payflow api 并在尝试上线或测试时收到以下响应错误：

`RESULT=52&PNREF=xxxxxxxxxxx&RESPMSG=Insufficient permissions to perform transaction`

从搜索来看，似乎有很多人对此有疑问。我在任何可能帮助我解决问题的文档中也找不到错误代码 52。该线程解释了相同的未解决问题：[Paypal 论坛](https://www.x.com/developers/paypal/forums/payflow-gateway/insufficient-permissions-error-sale-transaction)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T21:58:56.730

显然，我的客户帐户注册了 Payments Advanced 而不是 Payments Pro。升级必须通过电话完成，在线表格会告诉您申请已经获得批准。

# excel - 将多个工作表合并为一个

> ID：14095712
> 
> 赞同：0
> 
> 时间：2012-12-30T23:19:13.093
> 
> 标签：excel, vba

我正在尝试将多个工作表合并到一个摘要表中。
每个 Worksheet 的名称为“Table #number”，例如`Table 1`等。每个工作表`Table 2`的布局都是相同的。数据范围是 columns `A1 : N13`。
此功能不起作用：`=SUM('Table 1':'Table 25'!$A$1:$N$13)`。
我如何使用`VBA`来合并这些数据？

![在此处输入图像描述](../Images/c1379b5bcae558925f30b2e0baa6bee5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-01-29T13:06:38.843

```
Sub MergeSheet()

'Declaring the Variables
Dim LastRow, ShtCnt As Integer
Dim ShtName As String
Dim NewSht As Worksheet

'Assinging a Sheet Name by UserInput
ShtName:
ShtName = InputBox("Enter the Sheet Name you want to create", "Merge Sheet", "Master Sheet")

'Count of Total Worksheet in the present workbook
ShtCnt = Sheets.Count

'Using For Loop check if the worksheet exists
For i = 1 To ShtCnt
If Sheets(i).Name = ShtName Then
MsgBox "Sheet already Exists", , "Merge Sheet"
GoTo ShtName
End If
Next i

'Create a New Sheet
Worksheets.Add.Name = ShtName

'Assigning NewSht as Current Sheet
Set NewSht = ActiveSheet

'Moving Worksheet to the beginning of this workbook
NewSht.Move before:=Worksheets(1)

'Copying all the data to the New Sheet Using For Loop
For i = 2 To ShtCnt + 1

'If i=2 Then copy all the data from the second sheet including header.
If i = 2 Then
Sheets(i).UsedRange.Copy NewSht.Cells(1, 1)
Else

'If i is grater than 2 then copy all the data excluding Header(1st Row).
Sheets(i).UsedRange.Offset(1, 0).Resize(Sheets(i).UsedRange.Rows.Count - 1, Sheets(i).UsedRange.Columns.Count).Copy NewSht.Cells(LastRow + 1, 1)
End If
LastRow = NewSht.Cells.SpecialCells(xlCellTypeLastCell).Row
Next i

'Displaying the Message after copying data successfully
MsgBox "Data has been copied to " & ShtName, , "Merge Sheet"

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T11:57:39.660

这是一个简化的例子：

```
Option Explicit

Sub amalgamateData()

'initialise result variable
Dim myResult As Double
myResult = 0

'loop through sheets to get the sum
Dim wks As Excel.Worksheet  'loop control variable
For Each wks In Excel.ThisWorkbook.Worksheets
    If Left(wks.Name, 5) = "Table" Then ' only the "Table" sheets
        With wks
            Dim rngTarget As Range
            myResult = myResult + Excel.Application.WorksheetFunction.Sum(.Range("A1:N13"))
        End With
    End If
Next

'add result to sheet "Result"
Excel.ThisWorkbook.Sheets("Result").Range("A1") = myResult

End Sub 
```

我的出发点是这个[**SO Post**：how-to-merge-data-from-multiple-sheets](https://stackoverflow.com/questions/10806480/how-to-merge-data-from-multiple-sheets)

正如 Siddharth saud - 有大量的参考资料供您参考，所以这里是为您[搜索...查看屏幕右上角框中的内容](https://stackoverflow.com/search?q=%5BExcel-VBA%5D+loop+through+worksheets+and+show+results+in+one+sheet)

# java - 在java中读取对象直到文件结束

> ID：14095713
> 
> 赞同：2
> 
> 时间：2012-12-30T23:19:22.233
> 
> 标签：java, serialization, objectinputstream, eofexception

我正在尝试编写一个程序，用户可以：1）将一个人添加到联系人（姓名，电话，电子邮件），2）从联系人中删除一个人，3）从联系人中读取所有内容。

我这样做的方式是要求用户做出选择并分别做任何事情。对于写作，我只是将一个对象写入文件。对于删除，我想我会询问用户“姓氏”，它将用作键（因为我使用的是 TreeMap）并将删除键处的值（对象）。

所以我在这里阅读有问题。我正在尝试像这样读取对象：

```
public void readContact()
{
  TreeMap<String, Contact> contactMap = new TreeMap<String, Contact>();
  try 
  {
    ObjectInputStream in = new ObjectInputStream(new BufferedInputStream(
                                                   new FileInputStream(file)));

    while( in.available() > 0 ) //This line does NOT read  
    {
      Contact c = (Contact)in.readObject();
      contactMap.put(c.getLastName(), c);           
    }

    for(Map.Entry contact : contactMap.entrySet() ) 
    {
      Contact con = contactMap.get( contact.getKey() );
      System.out.println( con.getLastName() + ", " + con.getFirstName() + ": " + con.getPhoneNumber() + "\t" + con.getEmail());
    }
  }
  catch(Exception e)
  {
    System.out.println("Exception caught");
  } 
} 
```

请不要建议做类似的事情，`while(true)`直到我得到`EOFException`因为：

1.  我相信这不是异常处理的目的
2.  在此之后我还有更多事情要做，所以我不能让程序终止'

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T03:57:52.070

> 在我得到 EOFException 之前，请不要建议做类似 while(true) 的事情

这正是我的建议。当您搜索答案时，根据这样的任意标准限制解决方案空间会适得其反。

> 因为：
> 
> 我相信这不是异常处理的目的

当您调用的 API 抛出异常时，就像这个一样，您别无选择，只能捕获它。无论您对“异常处理的用途”有何看法，您都受制于 API 的设计者*在*设计 API时*的想法*。

 *> 在此之后我还有更多事情要做，所以我不能让程序终止'

所以不要终止它。抓住`EOFException,`关闭输入，然后跳出循环。

我已经看到浪费在“异常处理的用途”上的昂贵的编程时间比我真正相信的要多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T02:55:41.997

我知道您正在寻找不使用异常处理的答案，但我相信在这种情况下使用`EOFException`来确定何时读取所有输入是正确的方法。

[EOFException](http://docs.oracle.com/javase/7/docs/api/java/io/EOFException.html)的 JavaDoc指出

> 此异常主要由数据输入流用来表示流结束。请注意，许多其他输入操作在流结束时返回一个特殊值，而不是引发异常。

因此，有些输入流使用其他方式发出文件结束信号，但`ObjectInputStream#readObject`用于`ObjectInputStream$BlockDataInputStream#peekByte`确定是否有更多数据要读取，并在到达流结束时`peekByte`抛出一个。`EOFException`

因此，可以将此异常用作已到达文件末尾的指示符。

为了在不中断程序流程的情况下处理异常，一些可能的异常应该在层次结构中向上传递。它们可以由`try - catch`调用`readContact()`.

`EOFException`可以简单地用作我们已完成读取对象的指示。

```
public TreeMap<String, Contact> readContact() throws FileNotFoundException,
            IOException, ClassNotFoundException {

    TreeMap<String, Contact> contactMap = new TreeMap<String, Contact>();

    // The following call can throw a FileNotFoundException or an IOException.
    // Since this is probably better dealt with in the calling function, 
    // readContact is made to throw these exceptions instead.
    ObjectInputStream in = new ObjectInputStream(new BufferedInputStream(
                new FileInputStream(file)));

    while (true) {
        try {
            // Read the next object from the stream. If there is none, the
            // EOFException will be thrown.
            // This call might also throw a ClassNotFoundException, which can be passed
            // up or handled here.
            Contact c = (Contact) in.readObject();
            contactMap.put(c.getLastName(), c);

            for (Map.Entry<String, Contact> contact : contactMap.entrySet()) {
                Contact con = contact.getValue();
                System.out.println(con.getLastName() + ", "
                          + con.getFirstName() + ": " + con.getPhoneNumber()
                          + "\t" + con.getEmail());
            }
        } catch (EOFException e) {
            // If there are no more objects to read, return what we have.
            return contactMap;
        } finally {
            // Close the stream.
            in.close();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T02:58:02.463

1.  'ObjectInputStream.available 返回 0' 是一个已知问题，请参阅[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4954570](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4954570)，由于我们无法使用它，我认为`EOFException`在您的情况下这是一种合理的方法。捕获`EOFExcepion`不会终止您的程序。
2.  您可以使用 将对象数量写入文件`ObjectOutputStream.writeInt`，然后您将使用 读取此数字`ObjectInputStream.readInt`并知道要读取多少对象
3.  您可以`null`用作 EOF 标记。
4.  您可以将对象保存为数组或 List 甚至 Map，然后使用 one 读取它们`readObject`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-31T03:19:48.160

为什么从文件中读取对象时这么麻烦，只需将哈希映射保存到文件中并从文件中读取一次，然后执行任何操作。

另外，我建议使用任何一种面向对象的数据库，如[Db4o](http://www.db4o.com/)来快速执行此操作，然后您就不必担心文件结束异常

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-31T03:04:54.170

**-** **不仅**`Exceptions`用于在调用方法时出现问题时发出警报，而且还用于各种其他用途。**`Threads``IO`**

 ****-**您可以使用`Exception`来表示**文件的结束**。

**-**使用`try-catch`组合与上述一起工作，以保持程序流畅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-06T04:12:05.003

**你发现了什么**

**即使文件中有未读字节，**您也发现`FileInputStream.available()`返回 0 ！为什么是这样？这可能会发生（由于以下几个原因导致不可靠：**`FileInputStream.available()`**

 **1.  根据此[文档](http://docs.oracle.com/javase/7/docs/api/java/io/FileInputStream.html#available%28%29)，`FileInputStream.available()` **近似于**可以在不阻塞的情况下读取的字节数
2.  硬盘驱动器本身可能会在读取中更改其操作（从旋转变为不旋转）
3.  您尝试访问的文件是远程系统上的文件或设备文件：[FileInputStream.available 可能会愚弄我吗？](https://stackoverflow.com/questions/2788869/may-the-fileinputstream-available-foolish-me)
4.  可能会`FileInputStream`被阻止

* * *

**一些替代方法**

作为依靠 EOFException 关闭文件的替代方法，您可以使用（非常小的！）二进制文件来跟踪文件中的对象数量。（从您的代码来看，您似乎只是将对象写入文件。）我使用它的方式只是为了

1.  存储数字本身将消耗的字节数
2.  使用该字节数，存储数字本身

比如第一次创建序列化文件，我可以做二进制文件存储`1 1`（指定序列化文件中的Objects个数占1个字节，这个个数为1）。这样，在 255 个 Objects 之后（记住，一个无符号字节最多只能存储 2 **8-1 == 255），如果我写另一个 Object（对象编号 256 到 256** 2-1 == 65535），二进制文件将有，作为内容，`2 1 0`它指定数字占用2个字节并且是1 * 256 **1 + 0 == 256。前提是序列化是可靠的（祝你好运：http: [//www.ibm.com/ developerworks/library/j-serialtest/index.html](http://www.ibm.com/developerworks/library/j-serialtest/index.html)），此方法可让您存储（和检测）多达 256个**255-1 字节（这几乎意味着这种方法可以无限期地工作）。

* * *

**代码本身**

如何实现这样的事情将是这样的：

```
ObjectOutputStream yourOutputStream = new ObjectOutputStream(new FileOutputStream(workingDirectory + File.separatorChar + yourFileName);  //The outputStream
File binaryFile = new File(workingDirectory + File.separatorChar + nameOfFile); //the binary file
int numOfObjects = 0, numOfBytes; //The number of Objects in the file
//reading the number of Objects from the file (if the file exists)
try
{
    FileInputStream byteReader = new FileInputStream(binaryFile);
    numOfBytes = byteReader.read();
    //Read the rest of the bytes (the number itself)
    for (int exponent = numOfBytes; exponent >= 0; exponent--)
    {
        numOfObjects += byteReader.read() * Math.pow(256,exponent);
    }
}
catch (IOException exception)
{
    //if an exception was thrown due to the file not existing
    if (exception.getClass() == FileNotFoundException.class)
    {
        //we simply create the file (as mentioned earlier in this answer)
         try 
         {
             FileOutputStream fileCreator = new FileOutputStream(binaryFile);
             //we write the integers '1','1' to the file 
             for (int x = 0; x < 2; x++) fileCreator.write(1);
             //attempt to close the file
             fileCreator.close();
         }
         catch (IOException innerException)
         {
              //here, we need to handle this; something went wrong
              innerException.printStackTrace();
              System.exit(-1);
         }
    }
    else
    {
         exception.printStackTrace();
         System.exit(-2);
    }
} 
```

现在，我们有了文件中对象的数量（我留给你弄清楚如何更新字节以指示在`yourOutputStream`调用时又写入了一个对象`writeObject(yourObject);`；我必须上班。）

编辑：`yourOutputStream`要么将所有数据写入其中，要么将`binaryFile`数据附加到其中。我刚刚发现这`RandomAccessFile`将是一种将数据插入文件中任何位置的方法。再一次，我把细节留给你。但是，您想这样做。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-11-17T10:22:56.397

您可以将最后一个对象写为 null。然后迭代直到你在阅读端得到一个空值。例如

```
while ((object = inputStream.readObject()) != null) {
  // ...
} 
```*****

# javascript - Javascript - 基于一个对象动态填充表单并填充另一个对象的值

> ID：14095716
> 
> 赞同：1
> 
> 时间：2012-12-30T23:19:40.613
> 
> 标签：javascript, jquery, json, forms, object

我有一个 JSON 对象，我将其用作所有可用字段的模板，这些字段可以添加到我的对象中用于存储值的元素中。

我有另一个保存值的对象。这个存储所有值的对象的 k,v 不是在我的应用程序中生成的。它交给我，我需要以基于我的 JSON 动态创建的表单填充该值，该 JSON 定义了给定元素的所有可用键。最好我向您展示我的演示应用程序。
演示： http: [//jsfiddle.net/bGxFC/15/](http://jsfiddle.net/bGxFC/15/)
1\. 单击“Button_2”标签 - 注意它如何使用 5 k,v 输入填充表单
2.现在单击“Button_1”标签 - 注意它是如何有 6 k 的， v 输入
3。这两个都是“类型”：“按钮”，但“按钮_2”的输入中缺少“转换”
4这是我的“ `var controls`”对象的来源。它定义了每种类型可以具有的所有可用选项。

我需要更改我的代码以使用“”中的值`objStr`并将它们放入由“控件”创建的表单中。一旦我将一个值添加到一个空输入（即“Button_2”中的“Transition”输入），它将被保存回“objStr”。

这是我的代码：

```
 var controls = {
    "Button":{"Type": "", "Transition": "","BackgroundImage": "","Position": "","Width": "","Height": ""},

    "Image":{"Type": "","BackgroundImage": "","Position": "","Width": "","Height": ""},

    "Label":{"Type": "","Position": "","Width": "","Height": "","Text": "","FontSize":"","Color": "", "FontType": ""}
};

objStr = {
        "View_1":
        {
            "Image_1":{
                "Type":"Image",
                "BackgroundImage":"Image.gif",
                "Position":[0,0],
                "Width":320,
                "Height":480
            },
            "Button_1":{
                "Type":"Button",
                "BackgroundImage":"Button.gif",
                "Transition":"View2",
                "Position":[49,80],
                "Width":216,
                "Height":71
            },
            "Button_2":{
                "Type":"Button",
                "BackgroundImage":"Button2.gif",
                "Position":[65,217],
                "Width":188,
                "Height":134},
            "Label_1":{
                "Type":"Label",
                "Position":[106,91],
                "Width":96,
                "Height":34,
                "Text":"Button",
                "FontSize":32,
                "Color":[0.12549,0.298039,0.364706,1]
            }
        }
    };

$(document).ready(function () {
    var $objectList = $('<div id="main" />').appendTo($('#main'));
    $.each(objStr.View_1, function(k, v) {
        $('<div/>').append(k).appendTo($objectList).on('click', function(){
            var $wrapper = $('#form .wrapper').empty();
            if(typeof v === 'string') {
                $('<div class="item" />').append('<span class="key">' + k + '</span>' + '<input value="' + v + '"/>').appendTo($wrapper);
            }
            else {//object
                $('<h3 class="formHeading" />').append(k).appendTo($wrapper);
                $.each(v, function(key, val) {
                    $('<div class="item" />').append('<span class="key">' + key + '</span>' + '<input value="' + val + '"/>').appendTo($wrapper);
                });
            }
            $("<button>Save</button>").appendTo($wrapper).on('click', function() {
                if(typeof v === 'string') {
                    v = $(this).closest(".wrapper").find("input").val();
                }
                else {//object
                    $(this).closest(".wrapper").find(".item").each(function(i, div) {
                        var $div = $(div),
                            key = $div.find(".key").text(),
                            val = $div.find("input").val();
                        v[key] = val;
                    });
                }
            });
        });
    });
}); 
```

# sql - 涉及具有多对多关系的表的 SQL 查询

> ID：14095718
> 
> 赞同：0
> 
> 时间：2012-12-30T23:19:54.480
> 
> 标签：sql, many-to-many

在我正在开发的应用程序中，需要保存用户输入的搜索条件，并定期（例如每天）运行，以便将结果发送给用户。此外，在每次运行中，都会更新标准记录以指示最新的执行时间以及自上次以来发现的新结果的数量。
搜索是针对名为 Things 的表执行的，该表与 Colors 和 Kinds 表具有多对多关系，分别使用 ThingColors 和 ThingKinds 关系表。每个事物必须与至少一种颜色和一种种类相关联，并且它必须具有名称和速率。

```
Things                  Colors          Kinds           ThingColors       ThingKinds
------                  ------          -----           -----------       ----------
ThingId: int            ColorId: int    KindId: int     ThingId: int      ThingId: int
ThingName: varchar      Name: varchar   Name: varchar   ColorId: int      KindId: int
Description: varchar
Rate: int
AddedOn: datetime 
```

已保存条件的表如下所示。Criteria 也与 Colors 和 Kinds 有多对多的关系。搜索条件（MinRate、MaxRate、Color 和 Kind）都不是强制性的，但至少必须指定一个。如果在搜索条件中指定了一种或多种颜色，则事物中必须至少有一种匹配的颜色，才能将其包含在结果中。相同类型的条件适用于 Kind。

```
Criteria                    CriteriaColors         CriteriaKinds
--------                    --------------         -------------
CriteriaId: int             CriteriaId: int        CriteriaId: int
UserId: int                 ColorId: int           KindId: int
CriteriaName: varchar
MinRate: int
MaxRate: int
NewResults: int
LatestRanOn: datetime 
```

我正在寻找一个有效的查询来生成结果（针对每个条件的匹配事物列表）。有没有办法在同一个查询中使用新找到的匹配项（在条件的LatestRanOn 之后有AddedOn 的事物）更新Criteria，并更新LatestRanOn？

目前我正在使用 SQL Server 2008。

# xml-parsing - 将 HaXml 文档转换为内容

> ID：14095721
> 
> 赞同：1
> 
> 时间：2012-12-30T23:20:02.407
> 
> 标签：xml-parsing, haskell

我正在寻找一个 HaXml 库函数来将 a 转换`Text.XML.HaXml.Types.Document`为`Text.XML.HaXml.Types.Content`.

在**Real World Haskell**一书中，提供了以下功能：

```
getContent :: Document -> Content
getContent (Document _ _ e _) = CElem e 
```

我认为这应该改为

```
getContent :: Document -> Content
getContent (Document _ _ e _) = CElem e undefined 
```

我很惊讶在 HaXml 包中找不到任何类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:29:10.410

我认为你想要的功能是[`docContent`](http://hackage.haskell.org/packages/archive/HaXml/1.23.3/doc/html/Text-XML-HaXml-Util.html#v%3adocContent)，

```
docContent :: i -> Document i -> Content i 
```

黑线鳕说

> 获取文档的主要元素，以便您可以`CFilters`直接申请。`i`通常是`(posInNewCxt filename Nothing)`

它的实施或多或少是预期的，

```
docContent i (Document _ _ e _) = CElem e i 
```

RWH 和 now 的代码不匹配是因为在编写 RWH 时，`HaXml`版本是 1.13.*，而类型`Document`和`Content`尚未参数化。

# ruby-on-rails - Ruby on Rails 无需预约即可查找记录

> ID：14095722
> 
> 赞同：0
> 
> 时间：2012-12-30T23:20:03.017
> 
> 标签：ruby-on-rails, database-design, activerecord

我正在制作酒店预订系统。我有用户、房间和预订的模型。我使用关联来链接如下：（注意，伪代码）

```
User has_many Reservations
User has_many Rooms, through Reservations

Room has_many Reservations
Room has_many Users, through Reservations

Reservation belongs_to Users
Reservation belongs_to Reservations 
```

一切正常，例如我可以列出用户的预订和房间。现在我需要列出所有当前未预订的房间。我尝试了以下似乎不起作用的方法：

```
reservations = Reservation.where('start > ? AND end < ?', Time.now, Time.now).select('room_id')

if reservations.empty?
  @rooms = Room.all
else
  @rooms = Room.where('id not in (?)',
            reservations)
end 
```

我想知道是否有一个 ActiveRecord 方法可以为我做到这一点？我尝试在房间上强制 LEFT JOIN 以获取结束日期 < 现在的所有房间，但这也不起作用。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:47:54.787

究竟是什么不起作用？我建议您创建一个`on`范围来过滤在给定日期处于活动状态的所有预订。然后，您可以使用`pluck`获取房间 ID 数组，然后自己获取房间。

代码可能看起来像（警告，从我的头顶写的，未经测试）：

```
class Reservation < ActiveRecord::Base
  scope :on, lambda {|day = Date.today| where('start > ? AND end < ?', day, day) }
end

class Room < ActiveRecord::Base
  def self.free_on(day = Date.today)
    reserved_room_ids = Reservation.on(day).pluck('DISTINCT room_id')
    where('id NOT IN (?)', reserved_room_ids)
  end

  def self.reserved_on(day = Date.today)
    reserved_room_ids = Reservation.on(day).pluck('DISTINCT room_id')
    where(:id => reserved_room_ids)
  end
end 
```

现在您可以使用`Room.free_on`或`Room.free_on(1.day.ago)`获取某一天的免费房间。我还添加了进入预订房间的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:46:08.627

有[`exists?`](http://guides.rubyonrails.org/active_record_querying.html#existence-of-objects)方法。它将允许您查看是否有任何与查询匹配的对象。

# java - javascript 点击页面上的 flash/swf 按钮

> ID：14095723
> 
> 赞同：1
> 
> 时间：2012-12-30T23:20:15.523
> 
> 标签：java, javascript, flash, firefox, imacros

我正在研究 iMacros 脚本（iMacros 是 FireFox 的插件，它支持 JS）。

我想编写一个 JavaScript 代码，它将单击 swf 按钮并打开它以从硬盘驱动器读取图像文件并将其上传到 Web 表单。

这是表单的 HTML 代码

```
<ul id="plupload-container_post-ad_image-select" class="image-container-droppable">
<li id="image-upload-trigger-container" style="visibility: visible;">
<a id="plupload-select_post-ad_image-select" class="secondary button" href="#">Add image</a>
<div id="p17fn085741qvovjsbhpcse1ff90_flash_container" class="plupload flash" style="position: absolute; top: 0px; background: none repeat scroll 0% 0% transparent; z-index: 99999; width: 90px; height: 27px; left: 0px; cursor: pointer;">
<object id="p17fn085741qvovjsbhpcse1ff90_flash" width="100%" height="100%" style="outline:0" data="/common/plupload/plupload.flash.swf" type="application/x-shockwave-flash">
<param value="/common/plupload/plupload.flash.swf" name="movie">
<param value="id=p17fn085741qvovjsbhpcse1ff90" name="flashvars">
<param value="transparent" name="wmode">
<param value="always" name="allowscriptaccess">
</object>
</div>
</li>
</ul> 
```

在 FireBug 中，我看到有一个功能可能会触发上传。

[http://prntscr.com/no5fl](http://prntscr.com/no5fl)

如果有必要，这里是函数代码。[http://pastebin.com/y48XzakJ](http://pastebin.com/y48XzakJ)

当我想在 iMacros 中执行 javascript 代码时，我会这样做。

```
URL GOTO=javascript:some_javascript_command_written_in_one_line_of_code 
```

这样做会将 URL GOTO= 之后的所有内容粘贴到导航栏中。

所以我需要一个对我有帮助的函数，并且我可以按照我刚才描述的方式在 iMacros 中执行它。这是可能的还是我需要解释更多？

# c# - 字符串文件路径不起作用c#

> ID：14095736
> 
> 赞同：2
> 
> 时间：2012-12-30T23:22:21.033
> 
> 标签：c#, string, path, .net

好的，我花了很多时间试图解决我读过的帖子所说的简单修复。

我想在我的文档中写入一个文件，这是我的代码。

```
 string st = @"C:\Users\<NAME>\Documents\Sample1.txt";

        System.IO.StreamWriter file = new System.IO.StreamWriter(st);
        file.WriteLine(Convert.ToString(Sample1[0]));
        file.Close(); 
```

用户名在哪里。我收到以下错误

**“在 mscorlib.ni.dll 中发生了‘System.IO.DirectoryNotFoundException’类型的第一次机会异常。在 mscorlib.ni.dll 中发生了‘System.IO.DirectoryNotFoundException’类型的异常，但未在用户代码中处理”**

我正在使用 Visual Studio Express 进行 Windows Phone 开发。

如果有人能指出我做错了什么，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:29:35.573

我假设您正在使用已发布的字符串。如果是这种情况，您应该改用[SpecialFolder](http://msdn.microsoft.com/en-gb/library/system.environment.specialfolder.aspx)枚举。

```
var st = string.format(@"{0}\Sample1.txt", 
             Environment.GetFolderPath(Environment.SpecialFolder.Personal)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:33:15.927

您应该利用[`Environment.SpecialFolder`](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)枚举并使用`Path.Combine(...)`来创建路径：

```
var path = Path.Combine(
    Environment.GetFolderPath(Environment.SpecialFolder.Personal),
    "Sample1.txt");

using (var sw = new StreamWriter(path))
{
    sw.WriteLine(Convert.ToString(Sample1[0]));
} 
```

* * *

此外，`StreamWriter`应该放在`using`声明中，因为它是一次性的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:34:55.010

要获取 MyDocuments，请使用：

```
 Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) 
```

这将返回主计算机上 MyDocuments 的路径。

您可以在 MSDN 上查看 SpecialFolders 列表：http: [//msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

编辑：我刚刚注意到您正在为 Windows Phone 开发。阅读 MSDN 上的其他 SpecialFolders。

# scripting - 切换 Windows 的监视器/电视显示模式

> ID：14095739
> 
> 赞同：0
> 
> 时间：2012-12-30T23:22:50.280
> 
> 标签：scripting, windows-8

我有 2 台戴尔显示器和一台电视。我经常用电视播放电影。我想创建一个脚本，以便我的辅助屏幕从我的辅助 DELL 显示器切换到电视，而不会影响我的主显示器。

我知道这可以通过多种方式实现，但我想创建一个脚本，以便它能够检测到当前活动屏幕，然后切换到另一个，这样我的妻子就可以双击它来切换他们俩。

有人可以通过让我知道我可以使用哪种脚本语言以及我需要使用哪些库/dll 来帮助我入门吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T05:01:58.037

对于任何好奇的人，我最终为此创建了一个 C# 控制台应用程序。这样我就可以使用 WinAPI 来确定我所处的显示模式并切换到我想要的显示模式。它不会根据每个人的需要进行设置，但它应该是一个很好的起点。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace DisplaySwitcher
{
    class Program
    {
        [System.Runtime.InteropServices.DllImport("user32.dll")]
        public static extern int GetSystemMetrics(int nIndex);

        public const int SM_CMONITORS = 80;

        static void Main(string[] args)
        {
            int iNumberOfDisplays = GetSystemMetrics(SM_CMONITORS);
            string displaySwitch = null;
            switch (iNumberOfDisplays)
            {
                case 1: // TV mode (only detects 1 display)
                    displaySwitch += "/external";
                    break;
                case 2: // Normal mode (extended display)
                    displaySwitch += "/clone";
                    break;
                default:
                    MessageBox.Show("Unknown display mode detected");
                    break;
            }

            executeCommand(displaySwitch);
        }

        private static void executeCommand(string displaySwitch)
        {
            System.Diagnostics.Process process = new System.Diagnostics.Process();
            System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
            startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
            startInfo.FileName = "DisplaySwitch.exe";
            startInfo.Arguments = displaySwitch;
            process.StartInfo = startInfo;
            process.Start();
        }

    }
} 
```

# java - 使用 rvm jruby install 在 Java 代码中嵌入 JRuby

> ID：14095744
> 
> 赞同：1
> 
> 时间：2012-12-30T23:23:39.483
> 
> 标签：java, rvm, jruby, jsr223

我正在尝试从 Java 应用程序中嵌入和评估 ruby​​ 代码。我需要能够使用随 rvm 安装的 jruby 环境，而不是将 jruby-complete.jar 放在我的类路径中。我可以执行基本的内核代码，但我遇到了需要标准库（fileutils、tmpdir 等）的问题。

我在下面创建了使用通过 RVM 安装的 JRuby 的测试文件，如果您有本地 rvm + jruby 安装（将 JRUBY_VERSION 更改为安装的版本），任何人都应该能够编译+运行它。我意识到我引用的 jruby.jar 与 jruby-complete.jar 不同，但我希望有一种方法可以在不下载外部 jar 的情况下加载标准库。

```
import java.io.File;
import java.lang.reflect.Method;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.logging.Logger;
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;

public class Test {
    private final static Logger LOG = Logger.getAnonymousLogger();
    private final static String JRUBY_VERSION = "jruby-1.6.7";

    public static void main(String[] args) throws Throwable {
        final String rvmPath = System.getenv("HOME") + "/.rvm/rubies/";
        addFileToClasspath(rvmPath + JRUBY_VERSION + "/lib/jruby.jar");

        final ScriptEngine rubyEngine = new ScriptEngineManager().getEngineByName("jruby");
        rubyEval(rubyEngine, "puts 'hello world!'"); // works
        rubyEval(rubyEngine, "require 'tempfile'");  // fails to load 'tmpdir'
        rubyEval(rubyEngine, "require 'fileutils'"); // fails to load 'fileutils'
    }

    private static void rubyEval(ScriptEngine rubyEngine, final String code) {
        try {
            rubyEngine.eval(code);
        } catch (final Throwable e) { LOG.throwing(Test.class.getName(), "rubyEval", e); };
    }

    public static void addFileToClasspath(final String path) throws Throwable {
        final File file = new File(path);
        final URLClassLoader sysloader = (URLClassLoader) ClassLoader.getSystemClassLoader();
        final Class<?> sysclass = URLClassLoader.class;
        final Method method = sysclass.getDeclaredMethod("addURL", new Class<?>[] {URL.class});
        method.setAccessible(true);
        method.invoke(sysloader, new Object[] {file.toURI().toURL()});
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:24:20.913

在 rvm 安装中，核心 ruby​​ 文件与`jruby.jar`（此处为 JRuby 1.7.2）一起安装：

```
sebastien@greystones:~$ cd .rvm/rubies/jruby-1.7.2/
sebastien@greystones:~/.rvm/rubies/jruby-1.7.2$ find . -name fileutils.rb
./lib/ruby/1.8/fileutils.rb
./lib/ruby/1.9/fileutils.rb
sebastien@greystones:~/.rvm/rubies/jruby-1.7.2$ find . -name tmpdir.rb
./lib/ruby/1.8/tmpdir.rb
./lib/ruby/1.9/tmpdir.rb 
```

因此，您需要将正确的 ruby​​ 文件夹（取决于 ruby​​ 版本）添加到类路径中，例如：

```
 final String rvmPath = System.getenv("HOME") + "/.rvm/rubies/";
    addFileToClasspath(rvmPath + JRUBY_VERSION + "/lib/jruby.jar");

    // Here, add folder to classpath.
    System.setProperty("org.jruby.embed.class.path", rvmPath + JRUBY_VERSION + "/lib/ruby/1.9"); 
```

# python - 在没有 for 循环的情况下打印此矩阵的最佳方法是什么

> ID：14095750
> 
> 赞同：-6
> 
> 时间：2012-12-30T23:24:31.953
> 
> 标签：python

我们有一个这样的矩阵：

```
[[a1,a2,a3],[a4,a5,a6],[a7,a8,a9]] 
```

在单独的行上打印该列表的最佳方法是什么？

我不想使用循环打印它：

```
for row in matrix:
    print row 
```

我想知道是否有内部程序可以做到这一点。

期望的输出：

```
[a1, a2, a3]
[a4, a5, a6]
[a7, a8, a9] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:22:39.593

极简主义的方法：

```
In [1]: l=[['a1','a2','a3'],['a4','a5','a6'],['a7','a8','a9']]

In [2]: from __future__ import print_function

In [3]: print(*l,sep='\n')
['a1', 'a2', 'a3']
['a4', 'a5', 'a6']
['a7', 'a8', 'a9'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:38:17.983

如您所问，不使用 for 循环的最简单方法是

```
print matrix[0], "\n", matrix[1], "\n", matrix[2] 
```

*我强烈建议你使用循环，因为它们很有用，虽然这个例子比较简单，想象一下像这样有数百行的情况，你会手动输入每一行吗？*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T23:44:08.117

不使用 for 循环会使代码混乱

```
i=0
while i <len(m):
    print m[i]
    i = i+1 
```

试试这个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T23:32:52.140

```
 print [m1 for m1 in m] 
```

产量：

```
[1, 2, 3]
[4, 5, 6]
[7, 8, 9] 
```

# android - 将变量值从 BaseExpandableListAdapter 类转移到新活动

> ID：14095751
> 
> 赞同：3
> 
> 时间：2012-12-30T23:24:35.463
> 
> 标签：android

我有以下代码用于扩展到 BaseExpandableListAdapter 的 ExtendableListAdapter 类。我正在尝试将字符串变量“FullTrainsURL”的值转移到一个新的活动中。正如您在代码中看到的，每个子列表项的 URL 值是不同的，并且使用 OnClick() 函数附加了特定代码。我试过了

```
Intent i = new Intent(AdapterForStations.this, TestMain.class);

Bundle b = new Bundle();

b.putString("url", fullTrainsURL);

i.putExtras(b);

startActivity(i);    //Gives error at this line... 
```

但是我想将变量传输到新活动的类扩展到“活动”以外的“BaseExpandableListAdapter”。我认为这是我不能使用 intent.putExtras(); 的原因。方法，我得到了错误。

您能否指导我如何使用 OnClick() 方法将“fullTrainsURL”变量传输到新活动。

:::::我的实际文件代码:::::

```
package com.multilayerexpandable.view;

import java.util.ArrayList;
import java.util.LinkedList;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.BaseExpandableListAdapter;
import android.widget.CheckedTextView;
import android.widget.ExpandableListView;
import android.widget.TextView;
import android.widget.Toast;

import com.javacodegeeks.android.xml.pull.R;
import com.javacodegeeks.android.xml.pull.XmlParsingStationsData;
import com.javacodegeeks.android.xml.pull.model.Station;

@SuppressWarnings("unchecked")
public class AdapterForStations extends BaseExpandableListAdapter {

private static final String baseUrlForTrains = "http://cloud.tfl.gov.uk/TrackerNet/PredictionDetailed/";

XmlParsingStationsData parsingStations = new XmlParsingStationsData();
MainStationsActivity stationActivity = new MainStationsActivity();
LinkedList<Station> stationsList = new LinkedList<Station>();

public ArrayList<String> groupItem, tempChild;
public ArrayList<Object> Childtem = new ArrayList<Object>();
public LayoutInflater minflater;
public Activity activity;
private final String TAG = getClass().getSimpleName();

public AdapterForStations(ArrayList<String> grList, ArrayList<Object> childItem) {
    groupItem = grList;
    this.Childtem = childItem;
}

public void setInflater(LayoutInflater mInflater, Activity act) {
    this.minflater = mInflater;
    activity = act;
}

@Override
public Object getChild(int groupPosition, int childPosition) {
    return null;
}

@Override
public long getChildId(int groupPosition, int childPosition) {
    return 0;
}

@Override
public View getChildView(final int groupPosition, final int childPosition,
    boolean isLastChild, View convertView, ViewGroup parent) {
    tempChild = (ArrayList<String>) Childtem.get(groupPosition);

    Log.d(TAG, "::::::::::::::::::::DATA:::::::::::::::::::\n" + "<<<<<<" + tempChild.get(childPosition) + ">>>>>>\n");

    TextView text = null;
    if (convertView == null) {
        convertView = minflater.inflate(R.layout.childrow, null);
    }
    text = (TextView) convertView.findViewById(R.id.textView1);
    text.setText(tempChild.get(childPosition));
    convertView.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {

            StringBuilder trainsUrl = new StringBuilder(baseUrlForTrains);
            String fullTrainsURL = "";

                if(groupItem.get(groupPosition).equals("BAKERLOO LINE")){
                String stationCode = tempChild.get(childPosition).substring(tempChild.get(childPosition).length()-4, tempChild.get(childPosition).length()-1);
                trainsUrl.append("B/").append(stationCode);
                fullTrainsURL = trainsUrl.toString();

                Intent i = new Intent(AdapterForStations.this, TestMain.class);
                Bundle b = new Bundle();
                b.putString("url", fullTrainsURL);
                i.putExtras(b);
                startActivity(i);

            } else if(groupItem.get(groupPosition).equals("CENTRAL LINE")){
                String stationCode = tempChild.get(childPosition).substring(tempChild.get(childPosition).length()-4, tempChild.get(childPosition).length()-1);
                trainsUrl.append("C/").append(stationCode);
                fullTrainsURL = trainsUrl.toString();

            } else if(groupItem.get(groupPosition).equals("CIRCLE LINE")){
                String stationCode = tempChild.get(childPosition).substring(tempChild.get(childPosition).length()-4, tempChild.get(childPosition).length()-1);
                trainsUrl.append("H/").append(stationCode);
                fullTrainsURL = trainsUrl.toString();

            }

            Toast.makeText(activity, fullTrainsURL,
                    Toast.LENGTH_SHORT).show();
            }

    });
    return convertView;
}

@Override
public int getChildrenCount(int groupPosition) {
    return ((ArrayList<String>) Childtem.get(groupPosition)).size();
}

@Override
public Object getGroup(int groupPosition) {
    return null;
}

@Override
public int getGroupCount() {
    return groupItem.size();
}

@Override
public void onGroupCollapsed(int groupPosition) {
    super.onGroupCollapsed(groupPosition);
}

@Override
public void onGroupExpanded(int groupPosition) {
    super.onGroupExpanded(groupPosition);
}

@Override
public long getGroupId(int groupPosition) {
    return 0;
}

@Override
public View getGroupView(int groupPosition, boolean isExpanded,
        View convertView, ViewGroup parent) {
    if (convertView == null) {
        convertView = minflater.inflate(R.layout.grouprow, null);
    }
    ((CheckedTextView) convertView).setText(groupItem.get(groupPosition));
    ((CheckedTextView) convertView).setChecked(isExpanded);
    return convertView;
}

@Override
public boolean hasStableIds() {
    return false;
}

@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    return false;
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:32:55.027

[`startActivity()`](http://developer.android.com/reference/android/content/Context.html#startActivity%28android.content.Intent%29)是 Context 类的成员，请尝试以下操作：

```
Context context = v.getContext();
Intent i = new Intent(context, TestMain.class);
i.putExtra("url", fullTrainsURL);
context.startActivity(i); 
```

此外，您不需要创建第二个 Bundle，只需将 String 直接添加到 Intent 的内置 Bundle 中即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:28:04.757

Errrr...适配器不是活动，它们旨在保存数据并为适配器视图（例如ListView）提供视图。他们使数据适应视图。您需要创建一个具有使用您的 AdapterForStations 的列表视图的活动，并改为启动它。

适配器的构造函数通常应该包含它需要的所有数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:59:22.383

正如其他答案所指出的：适配器仅用于以有效的方式将数据绑定到视图。因此，它并不真正意味着包含任何用于用户交互的代码。

幸运的是，您的适配器应该设置为`ExpandableListActivity`or`ExpandableListView`并且它们确实提供了轻松响应例如用户单击项目的方法。参考以下相关方法：

*   [`onChildClick(ExpandableListView parent, View v, int groupPosition, int childPosition, long id)`](http://developer.android.com/reference/android/app/ExpandableListActivity.html#onChildClick%28android.widget.ExpandableListView,%20android.view.View,%20int,%20int,%20long%29)
*   [`setOnChildClickListener(ExpandableListView.OnChildClickListener onChildClickListener)`](http://developer.android.com/reference/android/widget/ExpandableListView.html#setOnChildClickListener%28android.widget.ExpandableListView.OnChildClickListener%29)

（如果需要，您还可以收听“组”项目的点击）

使用上述方法之一，您可以复制粘贴`OnClickListener`适配器中当前的大部分内容。您可能只需要更改从哪里获取数据对象。

`Activity`由于您将在您的or中设置侦听器，该侦听器`Fragment`包含`ExpandableListView`（并且都包含 extend `Context`），因此您可以立即调用`startActivity(...)`。

# python - 使用掩码替换numpy中的字符串

> ID：14095752
> 
> 赞同：1
> 
> 时间：2012-12-30T23:25:05.343
> 
> 标签：python, numpy, mask

如果我有一个看起来像 ar 的数组，那么它是一个 numpy 数组？如何使用 numpy 掩码将所有“replaceme”替换为 2012。

```
ar = [['replaceme', 1,2], ['replaceme', 3,4],['replaceme', 5,6]]

ar = [[2012, 1,2], [2012, 3,4],[2012, 5,6]] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:31:10.207

这不是掩码的工作，而是[高级索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#advanced-indexing)：

```
>>> import numpy as np
>>> ar = np.array([['replaceme', 1,2], ['replaceme', 3,4],['replaceme', 5,6]], dtype=object)
>>> ar
array([[replaceme, 1, 2],
       [replaceme, 3, 4],
       [replaceme, 5, 6]], dtype=object)
>>> ar == "replaceme"
array([[ True, False, False],
       [ True, False, False],
       [ True, False, False]], dtype=bool) 
```

所以我们需要做的就是：

```
>>> ar[ar == "replaceme"] = 2012
>>> ar
array([[2012, 1, 2],
       [2012, 3, 4],
       [2012, 5, 6]], dtype=object) 
```

# c# - 如何让两个按钮彼此相邻

> ID：14095753
> 
> 赞同：0
> 
> 时间：2012-12-30T23:25:38.173
> 
> 标签：c#, css, asp.net-mvc, razor

这是我的看法：

```
 <fieldset>
    <legend></legend>
    <br/>
      @using (Html.BeginForm("PrePayment", "Payment", FormMethod.Post))
      {
        <div align="left"> 
          <input id="btn" type="submit" value="Make a Payment" />
        </div>
      }
     @using (Html.BeginForm("DisplayLedger", "Customer", FormMethod.Post))
      {
        <div align="right"> 
          <input id="btn" type="submit" value="Display Activity" />
        </div>
      }
  </fieldset> 
```

我试图让它们居中并在同一条线上彼此相邻。

这是正在发生的事情：

![纽扣](../Images/7193f1380cb9abb6278962b0c85d0326.png)

我是 css 新手，我已经尝试了几件事，但我似乎无法将它们放在同一条线上。

有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:34:55.223

这是一个简单的 CSS 问题。要对齐框，它们必须使用相同的浮点数，在本例中为“左”。我在这里创建了一个可视化示例：http: [//jsfiddle.net/ktCng/](http://jsfiddle.net/ktCng/)

```
<div class="wrap">
    <div class="box left"></div>
    <div class="box left"></div>
</div>

<div class="wrap">
    <div class="box left"></div>
    <div class="box right"></div>
</div>​

.wrap{
  width: 200px;
  height: 100px;
  float: left;
  display: block;    
  border: 1px solid #000;    
}

.box{
 width: 50px;
 height: 50px;
 display: block;
}

.left{
  float: left;
  background: green;
}

.right{
  float: right;
  background: red;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:50:38.253

*仅解决样式问题。并且只有在这方面真正做一件快速而讨厌的工作。*

```
<fieldset>
    <legend></legend>
    <br/>
    <div style="text-align:center">
        @using (Html.BeginForm("PrePayment", "Payment", FormMethod.Post, new { style = "display:inline" }))
        {
          <input id="btn" type="submit" value="Make a Payment" />
        }
        @using (Html.BeginForm("DisplayLedger", "Customer", FormMethod.Post, new { style = "display:inline" }))
        {
          <input id="btn" type="submit" value="Display Activity" />
        }
    </div>
</fieldset> 
```

# jquery - 当单独的 div 的类更改时更改跨度文本 - jQuery

> ID：14095758
> 
> 赞同：1
> 
> 时间：2012-12-30T23:26:52.667
> 
> 标签：jquery, html, addclass

提前感谢您查看我的问题。

我有一个带有背景图像的 div，当单击它时，我正在添加另一个更改此图像的类。

我还想更改单击此 div 时的跨度中的一些文本。

我在下面尝试过，但它阻止了该类的添加：

```
$('.rpLeftArm').click(function () {

            $('.rpLeftArm').addClass("rpLeftArmActive")
            $('#currentStep').html("Pick up the hand furthest away from you and place the back of their hand onto their opposite cheek. <span style="color: Red;">Keep your hand there to guide and support their head as you roll them.</span>");
        }); 
```

我尝试将跨度文本更改放入另一个触发的函数中，但我也做错了。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:35:28.443

在 SPAN 周围加上单引号`<span style='color:red;'>`

```
$('.rpLeftArm').click(function () {    
      $('.rpLeftArm').addClass("rpLeftArmActive");
      $('#currentStep').html("Pick up.... <span style='color: red;'>Keep your...</span>");
}); 
```

# c# - Winforms 应用程序中推荐的线程数？

> ID：14095760
> 
> 赞同：1
> 
> 时间：2012-12-30T23:27:36.597
> 
> 标签：c#, .net, winforms

我正在开发一个多线程 Winforms 应用程序，我想知道是否有基于客户端计算机资源的推荐最大线程数。谢谢你。

编辑 - 我们正在使用多线程来避免在加载大量数据以显示在图表中时阻塞 UI。我们同时显示多达 16 个图表 -16 个不同的线程同时加载获取此数据（大约 5 次调用数据库）（不过这将得到改进）。因此，我们关心是否应该限制同时工作的线程数。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:46:48.447

在系统或 .NET Framework 中没有限制。

但是你的目标是什么？通常，您使用线程是因为您希望程序在主线程（后台线程）的空闲时间工作。因此，在这种情况下，请使用 GUI 线程和后台工作线程。如果您想同时做很多事情，请使用线程，但要使用它们的优先级（http://msdn.microsoft.com/fr-fr/library/system.threading.thread.priority.aspx）

# jquery - 关于jquery垂直导航菜单的建议

> ID：14095761
> 
> 赞同：0
> 
> 时间：2012-12-30T23:27:52.223
> 
> 标签：jquery, html, css

我正在为我的网站制作一个垂直导航栏......不幸的是没有达到我想要的所以希望我能得到一些解决方案。

垂直菜单有类别列表...后跟每个类别的子类别使用以下jquery附加这里是代码。

```
<div id="nav_menu">
<div id="menu_box">
<ul id="menu_ul">
<li ><a href="#" id="1" >Category1</a></li>
<li ><a href="#" id="1" >Category1</a></li>
<li ><a href="#" id="1" >Category1</a></li>
etc....
</ul>
</div>

<div id="menu_slider">
<ul id="submenu_ul">
</div>
</div> 
```

这里每个类别的子菜单如下...

```
<li id="1" href="#">category1
  <ul>
  <li><a href="#">subcate1</a></li>
  <li><a href="#">subcate2</a></li> 
  <li><a href="#">subcate3</a></li>
   .
   .
   .
  etc    
  </ul>
</li> 
```

jquery 代码是......就像这样 //文档准备好的导航菜单

```
 $(".category").live('mouseover',function(event){
        $("#menu_slider").show();
        var D=$(this).html();
        var id=$(this).attr('id');

        var V=$("#hide"+id).html();
        $("#submenu_ul").html(V);
        $("#menu_slider h3").html(D);   
});
    //Document Click
    $(document).mouseup(function()
    {
     //$("#menu_slider").hide();

    });

    //Mouse click on sub menu
    $("#menu_slider").mouseup(function()
    {
    return false
    });

    //Mouse click on my account link
    $("#menu_box").mouseup(function()
    {
    return false
    }); 
```

它在这里工作正常，当我更改布局时......根据我的布局要求这样

```
<div class="container nav_menu">
<div class="sidebar menu_box">
<ul class="menu_ul">
</ul>
</div>
</div> 

<div id="menu_slider">
<ul id="submenu_ul">
</div>
</div> 
```

jquery 功能不起作用它没有将 html 内容附加到mennu_slider submenu_ul ...我将它们更改为 jquery 中的类选择器...一个问题

第二个是..我希望菜单是这样的，请查看图片并建议我如何实现这一点。这种菜单在所有购物网站上都可以看到，所以我正在努力让它发挥作用……请找到所附的图片！

请看附件。图 1 在主页上，默认情况下它应该显示所有类别，但在其他页面上应该关闭，并且应该在悬停效果上工作，如图所示。

image2 我到目前为止所取得的成就。

[我想要导航菜单](http://kubadesigns.in/img2.gif)

[我到现在为止所做的](http://kubadesigns.in/image3.jpg)

# google-apps-script - 是否有事件可以在 Google 表单/调查中捕获提交按钮的按下事件？

> ID：14095762
> 
> 赞同：0
> 
> 时间：2012-12-30T23:27:55.733
> 
> 标签：google-apps-script, google-spreadsheet-api

我有一个 Google 表单，其中包含一些字段，例如电子邮件地址、姓名等。我希望发生的事情是这样的：

1.  用户在填写完字段后按“提交”。
2.  我查看电子邮件地址字段中的内容以检查它是否存在于电子表格的列中。
3.  如果电子邮件地址不存在，我将其附加到该列以维护唯一（通过电子邮件）注册人列表。

认为这将意味着覆盖与提交相关的事件，添加我的逻辑以检查某些单元格，然后写入（最后一个单元格 + 1），但我似乎找不到该按钮事件的任何内容。相反，**我看到的所有提交事件问题/搜索结果都是关于从头开始制作新表单和提交按钮**。重申一下：我找不到有关*默认*Google 表单/调查的提交按钮的任何信息，并希望避免手动添加提交按钮，因为已经提供了默认按钮。

有没有办法检测默认的提交按钮按下默认的谷歌表单/调查？如果是这样，该事件的名称是什么，我可以覆盖它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T08:54:40.727

您可以使用 onSubmit 触发器[https://developers.google.com/apps-script/understanding_events](https://developers.google.com/apps-script/understanding_events)

# ruby-on-rails - 为 will_paginate 构建正确结构化的查询以返回 ActiveRecord 关系，而不是数组

> ID：14095767
> 
> 赞同：2
> 
> 时间：2012-12-30T23:28:42.017
> 
> 标签：ruby-on-rails, ruby-on-rails-3

这是我在 StackOverflow 上的第一个问题……请温柔一点。我刚刚开始学习 Ruby on Rails，而且我主要是通过我的第一个学习项目，但我似乎无法以一种可以与 will_paginate 一起工作的方式构建这个查询。

我有一个模型结构，其中包括用户、组和计算机。用户组与计算机组之间没有区别。组是一个组，通过两个 has_many 关系包括许多用户和/或计算机。一台计算机和/或用户可以在许多组中。这是我的模型：

```
class Group < ActiveRecord::Base
  attr_accessible :name
  has_many :user_memberships
  has_many :users, :through => :user_memberships
  has_many :computer_memberships
  has_many :computers, :through => :computer_memberships

  validates :name, presence: true, length: { maximum: 50 }, uniqueness: { case_sensitive: false }
end

class ComputerMembership < ActiveRecord::Base
  attr_accessible :computer_id, :group_id
  belongs_to :computer
  belongs_to :group
  validates_uniqueness_of :computer_id, :scope => :group_id
  validates_presence_of :computer
  validates_presence_of :group
end

class UserMembership < ActiveRecord::Base
  attr_accessible :group_id, :user_id
  belongs_to :user
  belongs_to :group
  validates_uniqueness_of :user_id, :scope => :group_id
  validates_presence_of :user
  validates_presence_of :group
end 
```

用户和组（为简洁起见，仅包括 has_many 部分）：

```
class User < ActiveRecord::Base

  ...

  has_many :user_memberships, dependent: :destroy
  has_many :groups, through: :user_memberships

  ...

end

class Computer < ActiveRecord::Base

  ...

  has_many :computer_memberships, dependent: :destroy
  has_many :groups, through: :computer_memberships

  ...

end 
```

我正在尝试构建一个查询以仅检索 current_user 也是其成员的组中的（不同的）计算机。我在我的控制器中尝试这样的事情：

```
 def computers_in_users_groups_or_all_if_admin
      unless admin?
        computerarray = Array.new
        current_user.group_ids.each do |id|
          computerarray = computerarray | Group.find(id).computer_ids
        end
        @computers = Computer.find(computerarray).paginate(page: params[:page], per_page: 30).order('sn')
      else
        flash.now[:notice] = "You are seeing all computers because you are an administrator."
        @computers = Computer.paginate(page: params[:page], per_page: 30).order('sn')
      end
    end 
```

它似乎正在工作，但它返回一个不能与 will_paginate 一起使用的数组，除非我明确包含数组支持。will_paginate/array 似乎也不支持 .order 方法。作为 Rails 和 ActiveRecord 的新手，我知道必须有更好的方法来执行此查询。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:41:53.827

首先，为什么不在分页前排序？

但是，使用 Rails 和 ActiveRecord 解决这个问题的更好、更惯用的方法是[命名范围](http://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments)，例如

```
# computer.rb
class Computer
scope :all_for_user, lambda { |user| user.admin? ? Computer.paginate(page: params[:page], per_page: 30) : user.groups.computers.paginate(page: params[:page], per_page: 30)
end

# computer_controller.rb
Computer.all_for_user(current_user) 
```

您需要确保已设置可靠的[关联代码](http://guides.rubyonrails.org/association_basics.html)。您可能会想要一个`User`to`has_and_belongs_to_many :groups`并且`has_many :computers, :through => :groups`这大大简化了查询和逻辑。

注意 上面的代码完全不在我的脑海中并且未经测试，但它应该为您指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T04:26:15.203

使用上面 jxp 的指导，虽然我没有制作范围，因为我只需要在一个地方，我回去重新审视我的模型。我刚刚添加

```
has_many :computers, through: :groups, :uniq => true 
```

到我的用户模型，然后能够调用：

```
@computers = current_user.computers.paginate(page: params[:page], per_page: 15).order('sn') 
```

现在工作正常。:D

# javascript - window.document.body.appendChild(child); 每个 iframe 的页面中都是多余的

> ID：14095769
> 
> 赞同：1
> 
> 时间：2012-12-30T23:28:57.870
> 
> 标签：javascript, google-chrome-extension

我是 Chrome 扩展程序开发人员，我的扩展程序有一个问题：当我创建一个元素时

```
child = document.createElement('div'); 
```

并将此元素添加到页面正文：

```
window.document.body.appendChild(child); 
```

对于包含多个 iFrame 的页面，此子项会出现在页面中的每个 iFrame 中。

如何强制此元素仅出现在主窗口中，而不是所有 iframe 中？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:02:24.583

您能否在**清单**中将“all_frames”值设置为 false并检查（意味着仅匹配顶部帧。）

```
"content_scripts": [
    {
      .....
      "all_frames":false
      .....
    }
  ], 
```

## 参考：

[内容脚本清单](https://developer.chrome.com/extensions/content_scripts.html#registration)

### 编辑1：

将您的内容脚本代码分成两部分，其中

```
"content_scripts": [
    {
      "matches": [".."],
      "all_frames":true,
      "js": ["myscript_iframes.js"]
    },
    {
      "matches": [".."],
      "all_frames":false,
      "js": ["myscript_noIframes.js"]
    }
  ], 
```

`myscript_iframes.js`具有从所有框架读取内容的`myscript_noIframes.js`代码，并具有将子级附加到主框架的代码。

# python - 打印调用之间的 Python 间距

> ID：14095770
> 
> 赞同：0
> 
> 时间：2012-12-30T23:29:01.913
> 
> 标签：python, python-3.x

我想让打印语句之间的间距相同。我认为间距是一样的，但是在第三行和第四行文本之间存在更大的差距。

这是我的代码

```
 import random
    import time

    def UserInfo():
        UserName = input ("Player 1 what is your name?\n")
        return UserName

    def Introduction(UserName):
        time.sleep(.5)
        print ("Hello " + UserName + ",\n")
        time.sleep(1)
        print ("You are an unfortunate soul\n")

    UserName = UserInfo()
    Introduction(UserName) 
```

我得到的结果是

```
 Player 1 what is your name?
    Patrick
    Hello Patrick,

    You are an unfortunate soul 
```

但我不想要第三行和第四行之间的差距

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T23:31:27.240

如果您不想要额外的换行符，请不要使用额外`\n`的 s。`print`默认添加换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:38:02.160

您不需要在该行中添加换行符

> 打印（“你好”+用户名+“，\n”）

因为 print 会自动添加一个新行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:47:38.500

print 将默认添加换行符。

如果你想完全自己控制换行，你可以在后面加一个“，”。这将让 python 停止自动添加换行符。

例如：

```
print ("Hello " + UserName + ",\n"), 
```

# prolog - 可逆树长关系

> ID：14095774
> 
> 赞同：5
> 
> 时间：2012-12-30T23:30:02.743
> 
> 标签：prolog, clpfd, failure-slice, successor-arithmetics

我正在尝试在“纯” Prolog 中编写可逆关系（不`is`，剪切或类似的东西。是的，这是家庭作业），我必须承认我不知道如何。我没有看到任何创建这样的东西的过程。

我们得到了“不纯”但可逆的算术关系（add、mult、equal、less...），我们必须使用它来创建这些关系。

现在，我正在尝试通过创建关系来了解如何创建可逆函数，`tree(List,Tree)`如果`List`是二叉树的叶子列表，则该关系为真`Tree`。

为了实现这样的事情，我试图创建当有叶子`tree_size(Tree,N)`时为真的关系。这是我天真的、不可逆的关系：`Tree``N`

```
tree_len(n(_,leaf,leaf),1).
tree_len(n(op,G,D),N) :-
    tree_len(G,TG),
    tree_len(D,TD),
    add(TG,TD,N). 
```

我可以做查询`tree_len(some tree, N)`，但不能，说，`tree_len(X,3)`所以它是不可逆的。到目前为止，我已经尝试了一些事情，但我必须承认我感到沮丧，因为我不知道在哪里寻找什么。实际上有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T02:18:43.723

## 不终止的原因

首先，让我们试着理解为什么你的定义是不可逆的。我将使用[故障切片](https://stackoverflow.com/questions/tagged/failure-slice)来更好地解释它。所以考虑查询`tree_len(X,1).`乍一看，一切都很完美，你甚至会得到一个很好的答案！

```
?- tree_len(T,1).
T = n(_G267, leaf, leaf) 
```

但永远不要要求另一个答案，因为它会循环：

```
?- tree_len(T,1).
T = n(_G267, leaf, leaf) ;
** LOOPS ** 
```

所以我们得到的答案有点让人分心。乍一看似乎一切正常，但只有在回溯时才遇到真正的问题。这是在 Prolog 中习惯的东西。显然，您使用 3 的查询得到了更好的选择。但那是运气。

一般来说，有一种简单的方法可以确保这一点。只需将额外的目标添加`false`到查询中。添加`false`意味着我们不再对任何答案感兴趣，因为它不再成功。这样一来，所有的干扰都被消除了，我们直接面对问题：

```
?- tree_len(T,1), false.
** LOOPS ** 
```

那么，这个循环是从哪里来的呢？

在纯粹的、单调的 Prolog 程序（例如这个）中，我们可以通过`false`在我们的程序中添加一些目标来定位不终止的原因。如果生成的程序（称为[failure-slice](https://stackoverflow.com/questions/tagged/failure-slice)）没有终止，那么原始程序也不会终止。这是我们查询的最小故障片：

```
?- tree_len(T,1), false。

tree_len(n(_,leaf,leaf),1) :-**假**。
tree_len(n(op,G,D),N) :-
    tree_len(G,TG), false ,
     tree_len(D,TD) ,
     N 是 TG+TD。

```

我们的程序所剩无几！正是这个微小的片段负责不终止。如果我们想解决这个问题，我们必须在那个微小的部分做点什么。其他一切都是徒劳的。

所以我们需要做的是以*某种方式*改变程序，使这个片段不再循环。

实际上，我们有两个选择，我们可以使用[后继算法](https://stackoverflow.com/questions/tagged/successor-arithmetics)或[约束，如 clpfd](https://stackoverflow.com/questions/tagged/clpfd)。前者在任何 Prolog 系统中都可用，后者仅在 SWI、YAP、SICStus、GNU、B 等某些系统中提供。

# 使用[后继算法](https://stackoverflow.com/questions/tagged/successor-arithmetics)

现在，3 由 表示`s(s(s(0)))`。

```
tree_lensx(T, s(N)) :-
   树_lendiff（T，N，0）。

tree_lendiff(n(_,leaf,leaf), N,N)。
tree_lendiff(n(op,G,D), s(N0),N) :-
   tree_lendiff(G, N0,N1),
   tree_lendiff(D, N1,N)。

```

我在这里使用了几种常见的编码技术。

## 差异

实际的关系`tree_lendiff/3`不是用一个参数而是用两个来表示一个自然数。实际数字是两者之间的差异。以这种方式，可以保持定义可逆。

## 避免左递归

另一种技术是避免左递归。实际描述的`tree_lendiff/3`长度是长度*减*一。还记得我们首先得到的故障片吗？同样的故障片也会出现在这里！然而，通过将长度“移动”一，递归规则的头部现在确保终止。

# 使用[`library(clpfd)`](https://stackoverflow.com/questions/tagged/clpfd)

最初，有限域上的约束是为了解决组合问题而开发的。但是您也可以使用它们来获得可逆算术。SWI 和 YAP 中的实现甚至可以编译成代码，其效率通常与传统的不可逆代码相当，`(is)/2`但仍然是可逆的。

```
:- use_module(library(clpfd)).

tree_fdlen(n(_,leaf,leaf),1).
tree_fdlen(n(op,G,D),N) :-
   N #= TG+TD,
   TG #>= 1,
   TD #>= 1,
   tree_fdlen(G,TG),
   tree_fdlen(D,TD). 
```

该程序更接近于您的原始定义。尽管如此，请注意这两个目标`TG #>= 1`并`TD #>= 1`添加了冗余信息以确保该程序的终止。

我们现在可以像这样枚举一定范围内的所有树：

```
?- Size in 0..4, tree_fdlen(T, Size).
Size = 1, T = n(_A,leaf,leaf) ;
Size = 2, T = n(op,n(_A,leaf,leaf),n(_B,leaf,leaf)) ;
Size = 3, T = n(op,n(_A,leaf,leaf),n(op,n(_B,leaf,leaf),n(_C,leaf,leaf))) ;
Size = 4, ... ;
Size = 4, ... ;
Size = 3, ... ;
Size = 4, ... ;
Size = 4, ... ;
Size = 4, ... ;
false. 
```

注意答案替换的确切顺序！它不仅仅是 1,2,3,4！相反，答案是按*某种*顺序找到的。哪一种都无所谓，只要我们只对寻找所有解决方案感兴趣！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:44:46.003

有趣的问题。

这就是我要做的。基本上，您的关系是不可逆的，因为 add/3 不是。我本质上所做的是，用与叶子数量相对应的大小列表来代替数字计数 - 这*是*可逆的（好吧，追加/ 3和长度/ 2是可逆的）。

这是你需要的吗？发布的代码可在 YAP 下运行。

PS：这可能不是最简洁的解决方案，但它来自我的脑海。如果您还有其他问题，我会尽力提供帮助。

```
:-  use_module(library(lists)).

do_tree_len(n(_,leaf,leaf), [X]).
do_tree_len(n(op,G,D), [X1,X2|T]) :-
    append(TG, TD, [X1,X2|T]),
    TG \= [X1,X2|T], % To prevent infinite loops, when TG or TD is []
    TD \= [X1,X2|T],
    do_tree_len(G, TG),
    do_tree_len(D, TD).

tree_len(Tree, N):-
    length(L, N),
    do_tree_len(Tree, L). 
```

# php - 区分 ISBN-10 和 ISBN-13 的正则表达式

> ID：14095778
> 
> 赞同：21
> 
> 时间：2012-12-30T23:30:35.750
> 
> 标签：php, regex, validation, isbn

我有一个 If-else 语句，它检查一个字符串以查看是否存在 ISBN-10 或 ISBN-13（图书 ID）。

我面临的问题是 ISBN-10 检查发生在 ISBN-13 检查之前，ISBN-10 检查将匹配 10 个或更多字符的任何内容，因此可能会将 ISBN-13 误认为 ISBN-10。

这是代码...

```
$str = "ISBN:9780113411436";

if(preg_match("/\d{9}(?:\d|X)/", $str, $matches)){
   echo "ISBN-10 FOUND\n";  
   //isbn returned will be 9780113411
   return 0;
}

else if(preg_match("/\d{12}(?:\d|X)/", $str, $matches)){
   echo "ISBN-13 FOUND\n";
   //isbn returned will be 9780113411436
   return 1;
} 
```

如何确保避免此问题？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-31T00:24:25.387

你真的只需要一个正则表达式。然后进行更有效的`strlen()`检查以查看哪个匹配。以下将匹配带有或不带有连字符的字符串中的 ISBN-10 和 ISBN-13 值，并且可以选择以字符串`ISBN:`或`ISBN:(space)`开头`ISBN(space)`。

## 查找 ISBN：

```
function findIsbn($str)
{
    $regex = '/\b(?:ISBN(?:: ?| ))?((?:97[89])?\d{9}[\dx])\b/i';

    if (preg_match($regex, str_replace('-', '', $str), $matches)) {
        return (10 === strlen($matches[1]))
            ? 1   // ISBN-10
            : 2;  // ISBN-13
    }
    return false; // No valid ISBN found
}

var_dump(findIsbn('ISBN:0-306-40615-2'));     // return 1
var_dump(findIsbn('0-306-40615-2'));          // return 1
var_dump(findIsbn('ISBN:0306406152'));        // return 1
var_dump(findIsbn('0306406152'));             // return 1
var_dump(findIsbn('ISBN:979-1-090-63607-1')); // return 2
var_dump(findIsbn('979-1-090-63607-1'));      // return 2
var_dump(findIsbn('ISBN:9791090636071'));     // return 2
var_dump(findIsbn('9791090636071'));          // return 2
var_dump(findIsbn('ISBN:97811'));             // return false 
```

这将搜索提供的字符串以查看它是否包含可能的 ISBN-10 值（返回`1`）或 ISBN-13 值（返回`2`）。如果没有，它将返回`false`。

参见上面的[**DEMO**](http://codepad.viper-7.com/0nw1dt)。

* * *

## 验证 ISBN：

为了*严格*验证 ISBN 的 Wikipedia[文章](https://en.wikipedia.org/wiki/International_Standard_Book_Number)有一些针对[ISBN-10](https://en.wikipedia.org/wiki/International_Standard_Book_Number#Alternative_calculation)和[ISBN-13](https://en.wikipedia.org/wiki/International_Standard_Book_Number#ISBN-13_check_digit_calculation)的 PHP 验证函数。以下是复制、整理和修改的示例，以用于上述函数的略微修改版本。

**将返回块更改为：**

```
 return (10 === strlen($matches[1]))
        ? isValidIsbn10($matches[1])  // ISBN-10
        : isValidIsbn13($matches[1]); // ISBN-13 
```

**验证 ISBN-10：**

```
function isValidIsbn10($isbn)
{
    $check = 0;

    for ($i = 0; $i < 10; $i++) {
        if ('x' === strtolower($isbn[$i])) {
            $check += 10 * (10 - $i);
        } elseif (is_numeric($isbn[$i])) {
            $check += (int)$isbn[$i] * (10 - $i);
        } else {
            return false;
        }
    }

    return (0 === ($check % 11)) ? 1 : false;
} 
```

**验证 ISBN-13：**

```
function isValidIsbn13($isbn)
{
    $check = 0;

    for ($i = 0; $i < 13; $i += 2) {
        $check += (int)$isbn[$i];
    }

    for ($i = 1; $i < 12; $i += 2) {
        $check += 3 * $isbn[$i];
    }

    return (0 === ($check % 10)) ? 2 : false;
} 
```

参见上面的[**DEMO**](http://codepad.viper-7.com/WQwvUF)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T23:32:24.847

使用`^`and`$`匹配字符串的开头和结尾。通过使用字符串分隔符，您测试 10 位或 13 位代码的顺序将无关紧要。

### 10 位数

```
/^ISBN:(\d{9}(?:\d|X))$/ 
```

* * *

### 13 位数

```
/^ISBN:(\d{12}(?:\d|X))$/ 
```

* * *

**注意：**根据[http://en.wikipedia.org/wiki/International_Standard_Book_Number](http://en.wikipedia.org/wiki/International_Standard_Book_Number)，似乎 ISBN 中也可以包含一个`-`。但根据`$str`您使用的情况，您似乎在检查 10 位或 13 位数字之前已经删除了连字符。

**附加说明：**因为 ISBN 的最后一位数字用作前面数字的一种校验和，所以仅正则表达式无法*验证*ISBN 是否有效。它只能检查 10 或 13 位格式。

* * *

```
$isbns = array(
  'ISBN:1234567890',       // 10-digit
  'ISBN:123456789X',       // 10-digit ending in X
  'ISBN:1234567890123',    // 13-digit
  'ISBN:123456789012X',    // 13-digit ending in X
  'ISBN:1234'              // invalid
);

function get_isbn($str) {
   if (preg_match('/^ISBN:(\d{9}(?:\d|X))$/', $str, $matches)) {
      echo "found 10-digit ISBN\n";
      return $matches[1];
   }
   elseif (preg_match('/^ISBN:(\d{12}(?:\d|X))$/', $str, $matches)) {
      echo "found 13-digit ISBN\n";
      return $matches[1];
   }
   else {
      echo "invalid ISBN\n";
      return null;
   }
}

foreach ($isbns as $str) {
   $isbn = get_isbn($str);
   echo $isbn."\n\n";
} 
```

输出

```
found 10-digit ISBN
1234567890

found 10-digit ISBN
123456789X

found 13-digit ISBN
1234567890123

found 13-digit ISBN
123456789012X

invalid ISBN 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T23:32:58.687

切换`if else`块的顺序，同时从您的 ISBN 中删除所有空格、冒号和连字符：

```
//Replace all the fluff that some companies add to ISBNs
$str = preg_replace('/(\s+|:|-)/', '', $str);

if(preg_match("/^ISBN\d{12}(?:\d|X)$/", $str, $matches)){
   echo "ISBN-13 FOUND\n";
   //isbn returned will be 9780113411436
   return 1;
}

else if(preg_match("/^ISBN\d{9}(?:\d|X)$/", $str, $matches)){
   echo "ISBN-10 FOUND\n";  
   //isbn returned will be 9780113411
   return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T23:32:59.427

将 ISBN-13 检查放在 ISBN-10 检查之前？这是假设您希望将它们作为任何字符串的一部分进行匹配，即（您的示例在开头有一个额外的“ISBN：”，因此匹配字符串中的任何位置似乎是某种要求）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-11T07:46:49.540

```
ISBN10_REGEX = /^(?:\d[\ |-]?){9}[\d|X]$/i
ISBN13_REGEX = /^(?:\d[\ |-]?){13}$/i 
```

# python - 将 USING ~<~ 附加到 ORDER BY

> ID：14095786
> 
> 赞同：0
> 
> 时间：2012-12-30T23:31:52.983
> 
> 标签：python, django

我正在尝试使用 PostgreSQL 作为后端数据库按字母顺序排列非英语作者列表。

这些是我的模型：

```
class Alphabet(models.Model):
    letter       = models.CharField(max_length=2)
    letter_spell = models.CharField(max_length=3)
    order        = models.SmallIntegerField()

    def __unicode__(self):
        return self.letter

    class Meta:
        ordering = ['order']

class Author(models.Model):
    slug              = models.CharField(max_length=75)
    name              = models.CharField(max_length=50)
    biography         = models.TextField(blank=True)
    ...
    alphabet          = models.ForeignKey(Alphabet)

    def __unicode__(self):
        return self.name

    class Meta:
        ordering = ['name'] 
```

不幸的是，这并没有正确订购它们。

所以我去了终端，输入：

```
SELECT * FROM authors ORDER BY name 
```

没有给出想要的结果。但是，这是有效的：

```
SELECT * FROM authors ORDER BY name USING ~<~ 
```

那么如何将它附加到我的 ORDER BY 子句中呢？

请注意，我的视图代码如下：

```
a = Alphabet.objects.all().prefetch_related('author_set') 
```

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T09:57:52.877

您可以编写自定义[`Manager`](https://docs.djangoproject.com/en/1.4/topics/db/managers/)或[覆盖](https://docs.djangoproject.com/en/1.4/topics/db/managers/#modifying-initial-manager-querysets)默认值。默认排序的原始代码`https://github.com/django/django/blob/master/django/db/models/sql/compiler.py`在`get_ordering()`函数中。我看不到任何在查询中轻松添加`USING`子句的方法。

顺便说一句，如果 Django 没有正确订购可能是一个错误。

# hive - 使用 Hue 将数据从本地计算机上传到 Hive DB

> ID：14095787
> 
> 赞同：0
> 
> 时间：2012-12-30T23:32:18.740
> 
> 标签：hive, hue, hiveql

使用 Hive 和 Hue 的相对新手。

有没有办法使用 Hue 将保存到我的笔记本电脑的文件上传到 Hive 中的数据库表？我一直在翻阅书籍并在网上搜索，但没有找到任何答案。

哈利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:59:58.627

这在 Hive/Beeswax 应用程序中很容易：单击 Beeswax 图标，然后单击“表”选项卡，然后从文件中创建一个新表（其中有一个上传选项）或选择具有兼容模式的现有表和点击“导入数据”。

# android - Noob 有多个 android 问题

> ID：14095790
> 
> 赞同：1
> 
> 时间：2012-12-30T23:32:29.613
> 
> 标签：android, arrays, string, button, onclicklistener

所以，我一生中从未接触过 Java 编程（做过一点 C 和 C++，什么都不记得了），但我正在努力解决问题。我正在尝试让 Android 应用程序在单击按钮时显示数组中的随机字符串。到目前为止，我一直在从这里和那里复制片段。但是我遇到了 OnClickListener 的问题。

```
package com.example.testrun01;

import java.util.Random;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.content.res.Resources;
import android.widget.TextView;
import android.widget.Button;
import android.view.View;
import android.view.View.OnClickListener;

public class MainActivity extends Activity implements OnClickListener {

    private String[] PhraseString;
    private static final Random rgenerator = new Random();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    TextView tv = (TextView) findViewById(R.id.textView1);
    Button btnClick = (Button) findViewById(R.id.btnClick);

    btnClick.setonclickListener(new onClickListner(){
        public void onclick()
{  
    PhraseString = getResources().getStringArray(R.array.Phrases); 
    String q = PhraseString[rgenerator.nextInt(PhraseString.length)];
    tv.setText(q);
}
        });     

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

}

} 
```

让我分解错误（总共 4 个）：
1) 方法 setonclickListener(new onClickListner(){}) 未定义类型 Button
2) onClickListener 无法解析为类型
3) 无法引用非最终变量tv 在以不同方法定义的内部类中
4) 语法错误

前两个在同一行，btnClick.setonclickListener(new onClickListner(){。
第三个在 tv.setText(q);
第四个在 });

我猜前三个的分辨率将解决第四个。如果有人愿意帮助那些不了解 Java 并且仍在尝试编写程序的人，请让我知道我哪里出错了，以及如何确保我将来不会出错。提前感谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:36:07.860

> 1) Button 类型的方法 setonclickListener(new onClickListner(){}) 未定义

是的。您正在寻找的方法称为`setOnClickListener`.

> 2) onClickListener 无法解析为类型

您要查找的类型是`OnClickListener`. 不仅你写了一个小写字母`o`，你也错过了一个`e`。

> 3) 不能在以不同方法定义的内部类中引用非最终变量 tv

这就是*Java*的工作方式。如果你想`tv`在你的匿名中访问 say`OnClickListener`然后声明`final TextView tv`.

> 4) 语法错误

`OnClickListener`应该调用for 的方法`onClick`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:40:21.277

尝试这个：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final TextView tv = (TextView) findViewById(R.id.textView1);
    Button btnClick = (Button) findViewById(R.id.btnClick);

    btnClick.setOnClickListener(new OnClickListner() {

        public void onClick(View v) {
            PhraseString = getResources().getStringArray(R.array.Phrases); 
            String q = PhraseString[rgenerator.nextInt(PhraseString.length)];
            tv.setText(q);
        }

    });
} 
```

记得检查大小写和遗漏的字母。

1.  方法`setOnClickListener`不是`setonclicklistener`。
2.  侦听器接口`OnClickListener`不是`onClickListener`.
3.  您需要将 TextView 定义为 final, `final TextView tv`，因为它是在一个令人讨厌的类中访问的。
4.  该方法`onCreate`没有正确的打开和关闭大括号。在关闭方法体`}`之后添加一个额外的。`});`

如果您使用的是 eclipse，您可以使用`CTRL`+ `Space`，这将为您提供一些自动完成选项，这有助于大小写和拼写。

# iphone - OpenGL ES 无法正常工作

> ID：14095796
> 
> 赞同：7
> 
> 时间：2012-12-30T23:33:13.337
> 
> 标签：iphone, objective-c, opengl-es

我有一个 GLKView，它几乎可以显示我想要的形状，但是有些东西仍然无法按预期工作。

```
 3_______________________2
      |\                     /|
      | \_ _ _ _ _ _ _ _ _ _/ |
      | /4                 5\ |
      |/_____________________\|
      0                       1 
```

*   **纹理映射**在正面工作，其他两个面没有真正工作，**缺少三角形**。

*   当我使用颜色时，面看起来像想要的那样，但是**背面并没有在点 4 和 5 形成的边缘处连接**（看我上面提供的图）。
    我想要（如果你从侧面看的话）三个面形成一个等边三角形。

我暂时注释掉了代码的纹理映射部分，以便您可以根据需要进行测试。

在这里，我设置了我的视图（注意我的视图的尺寸。坐标系统工作正常，无需摆弄低值。面孔看起来不错，但它们不一样，正如我在后面所说的加入）：

```
 EAGLContext * context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];
    OpenGLShape *view = [[OpenGLShape alloc] initWithFrame:CGRectMake(0, 200, 320, 80) context:context];
    view.delegate = view;
    [view setupGL];
    [self.view addSubview:view];

- (void)setupGL {

    [EAGLContext setCurrentContext:self.myContext];

    //glEnable(GL_CULL_FACE);

    self.effect = [[GLKBaseEffect alloc] init];

    BOOL useTexture = NO;

    // Create default framebuffer object.
    glGenFramebuffers(1, &defaultFrameBuffer);
    glBindFramebuffer(GL_FRAMEBUFFER, defaultFrameBuffer);

    if(useTexture){
        NSDictionary * options = [NSDictionary dictionaryWithObjectsAndKeys:
                              [NSNumber numberWithBool:YES],
                              GLKTextureLoaderOriginBottomLeft,
                              nil];

        NSError * error;
        NSString *path = [[NSBundle mainBundle] pathForResource:@"blogcell@2x" ofType:@"png"];
        GLKTextureInfo * info = [GLKTextureLoader textureWithContentsOfFile:path options:options error:&error];
        if (info == nil) {
            NSLog(@"Error loading file: %@", [error localizedDescription]);
        }
        self.effect.texture2d0.name = info.name;
        self.effect.texture2d0.enabled = true;

        glGenBuffers(1, &texArray);
        glBindBuffer(GL_ARRAY_BUFFER, texArray);
        glEnableVertexAttribArray(GLKVertexAttribTexCoord0);
        glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, 0,0);
        glBufferData(GL_ARRAY_BUFFER, sizeof(TexCoords), TexCoords, GL_STATIC_DRAW);

    }else{

        glGenBuffers(1, &colArray);
        glBindBuffer(GL_ARRAY_BUFFER, colArray);
        glEnableVertexAttribArray(GLKVertexAttribColor);
        glVertexAttribPointer(GLKVertexAttribColor, 4, GL_FLOAT, GL_FALSE, 0, 0);
        glBufferData(GL_ARRAY_BUFFER, sizeof(Color), Color, GL_STATIC_DRAW);
    }

    glGenRenderbuffers(1, &depthBuffer);
    glBindRenderbuffer(GL_RENDERBUFFER, depthBuffer);
    glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, 320.0f, 80.0f);
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthBuffer);

    glEnable(GL_DEPTH_TEST);

    glGenBuffers(1, &vertexArray);
    glBindBuffer(GL_ARRAY_BUFFER, vertexArray);
    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition,3,GL_FLOAT,GL_FALSE,0,0);
    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);

    self.effect.transform.projectionMatrix = GLKMatrix4MakePerspective(51.4f,4.0f, 0.1f, 10.75f);
   rotMatrix = GLKMatrix4Translate(self.effect.transform.modelviewMatrix,0, 0, -3);

}

- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {

    self.opaque = NO;
    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    [self.effect prepareToDraw];

    glDrawArrays(GL_TRIANGLES, 0, sizeof(Vertices));
} 
```

**红色 = 正面（由点 0123 组成）**

**蓝色 = 背面（顶部 - 由点 4523 组成）**

**绿色 = 背面（底部 - 由点 0154 组成）**

**白色 = 背景**

为了查看它们是否混合/剔除等，我还使面成为半透明（alpha = 0.5）。

![初始状态（无旋转）](../Images/b93a91ba5d608d709efb38cbe4480e8f.png)

![绕 x 轴轻微旋转](../Images/06b1e478a8c49d02204895020a8c458a.png)

![围绕 x 轴几乎完全旋转](../Images/82071418536d9dd6530a1559ac165b9e.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-02T16:24:37.847

在 OpenGL 中，相机始终位于 {0,0,0}，改变位置的是 3D 世界。

对于正交投影，投影矩阵由下式给出：

```
self.effect.transform.projectionMatrix = GLKMatrix4MakeOrtho(left, right, bottom, top, front, back); 
```

![在此处输入图像描述](../Images/62073d32a25f1df44a44e1e0d9be7362.png)

正交投影中的对象在靠近或远离相机时看起来大小相同。

透视投影中的物体在远离相机时看起来更小。

![在此处输入图像描述](../Images/e2670da34780577f60c6e6f662a82665.png)

对于透视投影，投影矩阵由下式给出：

```
self.effect.transform.projectionMatrix = GLKMatrix4 GLKMatrix4MakePerspective (fov, aspect, front, back);
); 
```

对于透视投影，视场 ( `fov`) 的工作原理与真实相机上的一样，对于较小的值，透视几乎不明显，对于较大的值，由于透视投影造成的失真很大。

角度以`fov`弧度为单位，可以调整直到场景看起来适合您的应用程序

`aspect`是水平和垂直查看区域之间的屏幕纵横比。

出于实际原因`fov`，它以度数指定，因此可以如下使用

```
GLKMatrix4MakePerspective(fov * M_PI / 180.0f,
                                          screenWidth / screenHeight,
                                          front, back); 
```

在透视投影中，近剪裁平面需要大于零，因此您需要向模型视图矩阵添加一个平移，将世界与相机分开一点。

此转换在模型视图矩阵中指定

```
self.effect.transform.modelviewMatrix = GLKMatrix4MakeTranslation(0, 0, -frontClippingPlane); 
```

**更新**

裁剪体积需要包括所有顶点以避免与前裁剪平面发生[z 冲突](http://en.wikipedia.org/wiki/Z-fighting)，在这种情况下，透视投影中的最终平移需要更远一些

```
self.effect.transform.modelviewMatrix = GLKMatrix4MakeTranslation(0, 0, -frontClippingPlane - 0.1f); 
```

要旋转模型并将其转换到最终位置，您需要将两个转换组合如下：

```
GLKMatrix4 rotation = GLKMatrix4MakeRotation(angle*M_PI/180, 1, 0, 0); // angle in degrees and x,y, and z coordinates for the rotation axis
GLKMatrix4 translation = GLKMatrix4MakeTranslation( 0, 0, -front - 0.1f);
self.effect.transform.modelviewMatrix = GLKMatrix4Multiply(rotation, translation); // the order matters 
```

下面是OpenGL的旋转轴和方向，是[右手的](http://www.evl.uic.edu/ralph/508S98/coordinates.html)

![在此处输入图像描述](../Images/75e1cda38d67db12aaebb1f0abac70a9.png)

这是最终效果

![在此处输入图像描述](../Images/8079e80f7bca0ecc2b9ecca8f4e18122.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T14:00:36.603

你的数据正确吗？我看不到 Vertices 数组是如何填充的。

*如果您的数据与您列出的一样，例如红色正面 0123*是按此顺序排列的，那么您的顶点上的缠绕可能是一个问题。

默认绕组通常是逆时针方向，并且您已将矩形描述为逆时针方向，需要正确分解为 GL_TRIANGLES：例如 0123 使 013 和 123。

但是，如果您的图表是正确的，那么当其他人朝外时，红色矩形将面向由 3 个矩形边*形成*的三棱柱。

要了解我的意思，将一张纸折叠成 2 个水平折叠，形成一个三棱柱，沿着连接处用胶带粘住，并对顶点编号。

如果您在进入“纹理模式”时只为正面定义了纹理，您可能会丢失该面。

# php - 如何通过 GET 正确使用变量？

> ID：14095800
> 
> 赞同：-2
> 
> 时间：2012-12-30T23:33:59.737
> 
> 标签：php

如何正确地将变量传递给路径？ **photos.php?fname=MARERINA**

```
<?php
foreach(glob('.$_GET["fname"]./*.*') as $filename){
     echo $filename;
 }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:36:02.230

首先，**不要让用户输入 a `glob()`，除非您希望此目录可能位于服务器上的任何位置，即您有安全问题**。

使用字符串连接...

```
$_GET["fname"] . '/*.*' 
```

...或带大括号的双引号。

```
"{$_GET[fname]}/*.*" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:39:06.360

你可以使用：

```
<?php
foreach(dirname(__file__).glob(".$_GET[fname]/*.*") as $filename){
     echo $filename;
 }
?> 
```

或者：

```
<?php
foreach(dirname(__file__).glob($_GET["fname"].'/*.*') as $filename){
     echo $filename;
 }
?> 
```

但请记住，请求文件“../”会显示父目录。因此，您可以检查文件名中的“..”并删除它们或打印错误...

# makefile - 删除 .gz 扩展名

> ID：14095801
> 
> 赞同：1
> 
> 时间：2012-12-30T23:34:37.993
> 
> 标签：makefile, gzip

我有一个 Jekyll 站点，可以将所有 HTML、CSS 和 Javascript 处理成`*.css.gz`、`*.js.gz`等文件。

问题是，我需要删除`gz`扩展名，以便可以将文件上传到 S3 并使用 GZip 提供服务。

在我的makefile中，我有这个：

```
find _site/ -iname '*.html' -exec gzip -n {} +
find _site/ -iname '*.js' -exec gzip -n {} +
find _site/ -iname '*.css' -exec gzip -n {} +
find _site -iname '*.gz' -exec rename 's/\.gz$//i' {} + 
```

最后一行失败：

```
find: rename: No such file or directory
make: *** [all] Error 1 
```

当我运行命令`find _site -iname '*.gz'`时，我看到所有 GZipped 文件都正确输出，并且据我所知它们都存在。

如何删除扩展，或修改上面的命令以防止错误？

*我的 Makefile 中的脚本来源：http: [//fusion.dominicwatson.co.uk/2011/09/adding-gzip-to-my-jeyll-setup.html](http://fusion.dominicwatson.co.uk/2011/09/adding-gzip-to-my-jeyll-setup.html)*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:45:14.010

做一个备份，然后试试这个：

```
for f in `find _site -iname '*.gz'`; do
  mv $f ${f%.gz} 
done 
```

这应该遍历所有文件（来自您的 find 命令），并使用`mv`. 从文件名中去除`${f%.gz}`.gz 后缀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:48:08.547

`find`can't execute `rename`，很可能是因为它没有安装在您的系统上。

您需要它的实现（例如，[`prename`](https://gist.github.com/883553)或者`apt-get install perl`如果您使用的是 Debian 衍生产品）才能使其工作。

# ruby - Ruby DevKit 安装有木马病毒

> ID：14095807
> 
> 赞同：-2
> 
> 时间：2012-12-30T23:35:17.207
> 
> 标签：ruby, trojan, devkit

我是 Ruby DevKit 的新手，最近公开使用这个包与 CloudFoundry 系统进行一些集成工作。不幸的是，在我安装完 Ruby Devkit 后，我​​的防病毒软件发现它包含木马病毒——这很悲惨。我真的需要 Ruby DevKit 团队来调查这个问题，因为对于任何毫无戒心的人来说，让他们的机器感染这种病毒并相应地遭受一些损害是很危险的。

1.  我如何获得我的 Ruby DevKit 安装包： [http](http://rubyinstaller.org/downloads/) ://rubyinstaller.org/downloads/ >> 开发工具包 >> DevKit-tdm-32-4.5.2-20111229-1559-sfx.exe

2.  安装后我的杀毒软件在这个包中发现了什么：[RubyDevKit] **/mingw/bin/gcc.exe** 检测到：HEUR:Trojan.Win32.Generic

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:22:26.043

我很确定你没事。但我会给你几个理由让你感觉更好。

**首先**：我将打包上传`gcc.exe`到 VirusTotal，[它返回了一份干净的健康](https://www.virustotal.com/file/a45fa8c9a01f700bf25ba7b452a40f03c9c3060d5601a650a5ba8c63deae415b/analysis/1356917920/)证明。

**第二**：`HEUR`标志意味着它来自[启发式](http://en.wikipedia.org/wiki/Heuristic)算法。将其发送到提供您的防病毒定义的公司，以便对其进行检查。一旦提供者这样做并更新了他们的定义，它就应该被修复。

**第三**：Devkit 带有日期戳。`20111229`表示这个版本的 Devkit 是在 2011 年*12 月 29 日*构建的。所以这个版本已经使用了一年多了，我还没有注意到其他类似的报道。

如果您想了解更多信息，我们非常欢迎您向[RubyInstaller Google Group](http://groups.google.com/group/rubyinstaller)发送电子邮件，因为那里可能有人可以为您提供更多帮助。

# php - PHP 数字格式为 12 个字符

> ID：14095808
> 
> 赞同：2
> 
> 时间：2012-12-30T23:35:26.620
> 
> 标签：php, math

我有以下数字：12.00 12.45

我希望那些转换为 000000001200 000000001245

最好的方法是什么？

共 12 个字符，最后 2 位为小数点后 2 位。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T23:36:54.573

“它只是工作” - 解决方案

```
echo str_pad((int) ($value * 100), '0', 12, \STR_PAD_LEFT); 
```

[http://php.net/str-pad](http://php.net/str-pad)

您可以查看[`sprintf()`](http://php.net/sprintf)更多技术解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:49:23.713

您可以使用 number_format 和 printf 删除任何小数并使用零填充。我将它包含在下面的函数中：

```
<?php
function twelvedigits($a){
    $a = number_format($a, 2, '', '');
    printf("%012s\n", $a);
}
$one = 12.45;
$two = 12.00;

echo '$one: ';
twelvedigits($one);
echo '$two: ';
twelvedigits($two);

?> 
```

请参阅此处的示例：http: [//ideone.com/I3UOmQ](http://ideone.com/I3UOmQ)

# c# - 在 if 语句 c# 中声明 var

> ID：14095815
> 
> 赞同：1
> 
> 时间：2012-12-30T23:36:26.760
> 
> 标签：c#, variables

我有这个 var，但我想根据语句更改它的内容，我无法让它工作，因为当我使用它时，VS 说它没有被声明，即使语句是真的......

```
if (DateTime.Today.Day > 28 && DateTime.Today.Day < 2)
{
    var days = GetDaysLikeMe(DateTime.Today).Take(50).Where(d => d.Date.Day > 28 && d.Date.Day < 2).Take(4);
}
else
{
    var days = GetDaysLikeMe(DateTime.Today).Take(50).Where(d => d.Date.Day < 28 && d.Date.Day > 2).Take(4);
} 
```

编辑：

我试图在框外声明变量......但也不能让它工作，我在 var days 上保留的函数是这个

```
 public IEnumerable<DateTime> GetDaysLikeMe(DateTime currentDate)
    {
        DateTime temp = currentDate;
        while (true)
        {
            temp = temp.AddDays(-7);
            yield return temp;
        }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T23:39:29.557

在 if 语句范围之外声明变量：

```
IEnumerable<DateTime> days;

if (DateTime.Today.Day > 28 && DateTime.Today.Day < 2)
{
    days = GetDaysLikeMe(calendario.Value.Date).Take(50).Where(d => d.Date.Day > 28 && d.Date.Day < 2).Take(4);
}
else
{
    days = GetDaysLikeMe(calendario.Value.Date).Take(50).Where(d => d.Date.Day < 28 && d.Date.Day > 2).Take(4);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:39:15.203

在 if 块之外声明变量（不分配值 - 但是在这种情况下您不能使用`var`，您必须指定类型），然后只在内部为其分配一个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T23:42:03.217

您的代码现在没有任何问题 - 您可以轻松地`var`在任何块内定义变量或显式指定类型，包括`if`.

可能发生的情况是您试图在它定义的块之外使用这个变量（即 after`if`语句），这是`days`未定义的地方。

修复：在 if 之外定义变量，但您需要在那里显式类型。如果您有 ReSharper，它允许在`var`/explicit 类型之间轻松更改。否则，您必须自己弄清楚类型（在您的情况下是 liklye `IEnumerable<DateTime>`）。

# html - Amazon S3 和 .htaccess

> ID：14095818
> 
> 赞同：15
> 
> 时间：2012-12-30T23:36:43.640
> 
> 标签：html, .htaccess, amazon-s3, iweb

我有一个托管在 Amazon S3 上的网站（Made in iWeb）。我正在努力`www.domain.com/Apps/Physics.html`变成`www.domain.com/Apps/Physics`.

我正在尝试使用 .htaccess 文件来完成此操作。该文件存储在存储桶的根目录中（index.html 文件所在的位置）。这就是问题所在：它不起作用。还是不能用`www.domain.com/Apps/Physics`。

我有一个托管在 S3 服务器上的 GoDaddy 域。这有帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T23:51:27.223

为什么不为 domain.com 添加 CNAME 记录“静态”（这个用于 S3）并在 Apache 服务器上托管 www 和这样的重写规则：

```
RewriteEngine On

RewriteRule ^somefolder/(.*)$ http://static.domain.com/$1 [P] 
```

或者

```
#This will save your time of creating the additional CNAME step    
RewriteEngine On

RewriteRule ^somefolder/(.*)$ http://yourbucket.s3.amazonaws.com/$1 [P] 
```

**编辑**：使用 mod 代理似乎是一个更好的选择。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T23:45:59.657

S3 是内容服务器，而**不是**Web 服务器。您可能想尝试使用 Apache 租用小型[Amazon EC2](http://aws.amazon.com/ec2/)实例来做您想做的事。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-11-24T09:54:48.683

Anno 2016 Amazon S3[支持重定向](http://docs.aws.amazon.com/AmazonS3/latest/dev/how-to-page-redirect.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-24T16:37:12.797

Amazon S3 仅提供静态内容。

要请求用户和密码，您需要使用像[s3auth](https://github.com/yegor256/s3auth)这样的“中间”应用程序。

您可以在您自己的服务器上安装或使用他们的在线解决[方案](http://www.s3auth.com)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-06T12:33:33.320

1.  将您的 S3 存储桶设置为静态主机
2.  创建 CloudFront 分配
3.  确保您的 Origin 是 S3 静态主机的地址，而不是 S3 存储桶 *重要
4.  在 Physics 文件夹中将页面作为 index.html 提供给您

# c# - 为什么 ReSharper 认为 MailMessage.From 不能为空？

> ID：14095820
> 
> 赞同：3
> 
> 时间：2012-12-30T23:37:11.533
> 
> 标签：c#, resharper, resharper-7.1

[注意：这类似于[将字符串与 null 比较 - 为什么 Resharper 认为这总是错误的？](https://stackoverflow.com/q/11529726/129164)，但从来源来看，似乎没有`[NotNull]`属性`MailMessage.From`。]

考虑这种方法：

```
public void Send(MailMessage mailMessage)
{
    if (mailMessage.From == null)
        mailMessage.From = new MailAddress(Settings.SmtpSettings.From);
    _smtpClient.Send(mailMessage);
} 
```

ReSharper 7.1.1 警告我`mailMessage.From`不能为空。我对此完全感到困惑。

`mailMessage.From`是`MailAddress`一个类（不是结构），所以我认为它肯定可以为空（尽管我承认它肯定不应该在发送消息时出现）。

这是一张显示我得到的 ReSharper 工具提示的图像：

![ReSharper 指示 mailMessage.From == null 始终为 false](../Images/eb9418c20754b41abcaf276c9e19866c.png)

任何解释为什么 ReSharper 7.1 认为`mailMessage.From`不能为空，或者这是一个错误？

**更新**

于是剧情变厚了……

我写了几个测试并得到了意想不到的结果。

此测试失败：

```
[Test]
public void FromPropertyOfMailMessageCannotBeNull()
{
    var message = new MailMessage();
    Assert.IsNotNull(message.From);
} 
```

这个通过了：

```
[Test]
public void FromPropertyOfMailMessageIsNullIfDefaultConstructorIsUsed()
{
    var message = new MailMessage();
    Assert.IsNull(message.From);
} 
```

因此，看起来 ReSharper 完全是错误的，`MailMessage.From`不能为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:44:55.153

根据[文档](http://www.jetbrains.com/resharper/webhelp/Code_Analysis__External_Annotations.html)，ReSharper 允许`NotNullAttribute`应用于外部 API（例如 .NET 框架本身。）

在`\Program Files (x86)\JetBrains\ReSharper\v7.1\Bin\ExternalAnnotations\.NETFramework\System.Net\4.0.0.0.Nullness.Gen.xml`

你有：

```
<member name="M:System.Net.PeerToPeer.Collaboration.PeerNearMe.AddToContactManager(System.String,System.String,System.Net.Mail.MailAddress)">
    <attribute ctor="M:JetBrains.Annotations.NotNullAttribute.#ctor" />
</member> 
```

如您所见，它正在向`NotNullAttribute`类中添加`MailAddress`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T09:49:51.127

这是 ReSharper 注释中的一个错误。在 .netFramework 4.0 中，此属性在其设置器中检查空值，但在 MailMessage 类的默认构造函数中不保证非空值。我为此记录了一个问题：http: [//youtrack.jetbrains.com/issue/RSRP-337152](http://youtrack.jetbrains.com/issue/RSRP-337152)

# html - 无法使用 colspan 在 Firefox 中按预期排列列

> ID：14095822
> 
> 赞同：0
> 
> 时间：2012-12-30T23:37:20.563
> 
> 标签：html

我正在尝试使用下面的代码构建一个 HTML 表（4.01 过渡）。它使用 Windows 中的 chrome 进行渲染，但在 Ubuntu 提供的 Firefox 17.0.1 中以意想不到的方式渲染。在 Ubuntu 上，第 2 行和第 3 行的第一列宽度相同。此外，第 3 行的第 2 列与第 2 行的最后 3 列的宽度相同。我能做些什么来兼容更多浏览器吗？

```
<table width="500">
    <tr>
        <td align="center" colspan="5" width="500">5 wide</td>
    </tr>
    <tr>
        <td align="center" colspan="2" width="200">2 wide</td>
        <td align="center" colspan="1" width="100">1 wide</td>
        <td align="center" colspan="1" width="100">1 wide</td>
        <td align="center" colspan="1" width="100">1 wide</td>
    </tr>
    <tr>
        <td align="center" colspan="1" width="100">1 wide</td>
        <td align="center" colspan="4" width="400">4 wide</td>
    </tr>
</table> 
```

* * *

## 开始编辑

我不确定这是不是最好的方法，但我在浏览器之间实现了`<colgroup>`和`<col>`元素的一致行为。

```
<table width="500">
    <colgroup>
        <col width="25" />
        <col width="75" />
        <col width="200" />
        <col width="100" />
        <col width="100" />
    </colgroup>
    <tr>
        <td align="center" colspan="5">5 wide</td>
    </tr>
    <tr>
        <td align="center" colspan="2">2 wide</td>
        <td align="center" colspan="1">1 wide</td>
        <td align="center" colspan="1">1 wide</td>
        <td align="center" colspan="1">1 wide</td>
    </tr>
    <tr>
        <td align="center" colspan="1">1 wide</td>
        <td align="center" colspan="4">4 wide</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T07:09:39.730

最简单的解决方案是添加标记

```
<col><col><col><col><col> 
```

在`<table>`标签和 CSS 规则之后

```
col { width: 100px } 
```

现在使用的表格标记违反了 HTML 表格模型，至少在 HTML5 草案中定义并由某些浏览器解释。如果您在 HTML5 模式下使用[W3C 标记验证器](http://validator.w3.org/)检查标记，您将收到（除了有关表示属性的消息之外）错误消息“由元素 td 建立的表列 5 没有以它开头的单元格。” 真正的问题是，而不是像您所说的那样，从第 2 列开始没有单元格。

添加一个`<tr><td><td><td><td><td></tr>`，将单元格宽度设置为 100 像素，说明问题所在。但是使用这样的虚拟行通常会干扰您的布局。所以最好用`col`元素来指定列结构。

# php - 在类中使用全局函数是不好的做法吗？

> ID：14095826
> 
> 赞同：4
> 
> 时间：2012-12-30T23:37:55.587
> 
> 标签：php, class, function, model-view-controller, global

关于在类中使用全局函数的问题，我正在研究 MVC 系统。

以下方法是类的一部分，它调用类中的方法，例如模型和视图我的问题是我在那里有一个名为 redirect() 的全局函数bootstrap 文件，因为所有控制器都可能需要访问它，这是一种不好的做法，还是我最好将其作为控制器类的方法，因为所有控制器都扩展了父控制器。

```
public function post($slug){

  if(!$slug){ redirect('blog'); }

  $data = $this->model->getPost($slug);
  $this->view->render('blog/single', $data);
} 
```

还是静态类更有意义？对于一个简单的重定向功能来说，这似乎有点过头了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T23:49:37.113

全局函数不一定是坏习惯。有两点需要注意：

**命名：**您应该确保函数的名称避免冲突并且与其相关的内容很明显。您的重定向功能，预计它会执行请求重定向。相反，如果您的方法与其他更具体的方法相关，则需要通过预先添加一些上下文信息来明确情况就是如此。

**状态：**全局函数应该是无状态的。这意味着该函数应始终为给定的输入提供相同的结果。如果它根据一天中的时间、某些变量的值等做不同的事情……那么通常这是不好的。这可能看起来像是一个明显的陷阱，但这个问题还有更微妙的版本。该规则的明显例外实际上是请求一天中的时间......

看起来你的代码遵循这两个规则，所以这样做是完全可以接受的。

**编辑**存在**可测试性**问题，因为您正在引用该类（或应该）需要的全局函数，您不能模拟它。例如，在您的重定向示例中，如果不触发重定向函数，您将无法正确测试该类，并且您不能使用该函数的模拟版本来检测是否会调用真正的重定向方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:43:01.220

使用全局函数是不好的做法，因为它会使你的类无法测试。您应该将所需的方法放在某个对象上，并将其作为依赖项传递给类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T01:34:48.160

正如您在评论中指出的那样，它是一个很小的单行方法，如果您使用 PHP 5.3，而不是全局，最好使用 lambda 函数并将其传递，而不是创建一个全新的类。

我会尝试设计代码，以便注入依赖项，并可能将引导程序暴露给控制器并在其中存储一个 lambda，然后在你想要的地方调用它。

有关 lambda 的使用，请参阅[http://fabien.potencier.org/article/17/on-php-5-3-lambda-functions-and-closures，DI](http://fabien.potencier.org/article/17/on-php-5-3-lambda-functions-and-closures)示例也有望提供一些见解。

# java - 将edittext和textview的值一起添加并在文本视图中显示总计

> ID：14095830
> 
> 赞同：0
> 
> 时间：2012-12-30T23:38:13.033
> 
> 标签：java, android

我正在创建一个简单的 android 应用程序，它具有 editText 字段和 textView 字段，这些字段中的值只是数字。

我创建了一个按钮，在选择时，我希望将编辑文本和文本视图的值添加在一起，然后我希望将 editText 更改为“0”的值，并在 textView 中显示总计.

例如，如果在按下按钮时 editText 的值为 10，而 textView 的值为 20，则 textView 中将显示总计 30，而 editText 的值显示为 0。

到目前为止，这是我的代码，当我在应用程序崩溃的那一刻按下按钮时，所以我不确定我的编码是否正确。我是java新手。任何帮助将不胜感激。

```
public class durood extends Activity{

TextView txtCount;
TextView totalCount;
EditText enteramount;
Button btnCount;
Button addtotal1;
Button addtotal2;
Button cleartotal;
static int count=0;
double x=0;
double y=0;
double z=0;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
// The activity is being created.
setContentView(R.layout.durood);

enteramount = (EditText)findViewById(R.id.enteramount);
totalCount = (TextView)findViewById(R.id.totalCount);
addtotal1=(Button)findViewById(R.id.addtototal1);
addtotal2=(Button)findViewById(R.id.addtototal2);

//add to total 1
addtotal1.setOnClickListener(new View.OnClickListener() {
public void onClick(View v) {

x=Double.parseDouble(enteramount.getText().toString());
y=Double.parseDouble(totalCount.getText().toString());
z=x+y;
totalCount.setText(Double.toString(z));
}

}); 
```

日志猫

```
12-30 23:52:11.098: W/Trace(615): Unexpected value from nativeGetEnabledTags: 0
12-30 23:52:11.129: E/ActivityThread(615): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d332e8 that was originally bound here
12-30 23:52:11.129: E/ActivityThread(615): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d332e8 that was originally bound here
12-30 23:52:11.129: E/ActivityThread(615):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-30 23:52:11.129: E/ActivityThread(615):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-30 23:52:11.129: E/ActivityThread(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-30 23:52:11.129: E/ActivityThread(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-30 23:52:11.129: E/ActivityThread(615):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.emailcommon.service.AccountServiceProxy.getDeviceId(AccountServiceProxy.java:116)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.exchange.ExchangeService.getDeviceId(ExchangeService.java:1249)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1856)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-30 23:52:11.129: E/ActivityThread(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-30 23:52:11.129: E/ActivityThread(615):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-30 23:52:11.129: E/ActivityThread(615):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-30 23:52:11.129: E/ActivityThread(615):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-30 23:52:11.129: E/ActivityThread(615):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-30 23:52:11.129: E/ActivityThread(615):  at java.lang.Thread.run(Thread.java:856)
12-30 23:52:11.238: E/StrictMode(615): null
12-30 23:52:11.238: E/StrictMode(615): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d332e8 that was originally bound here
12-30 23:52:11.238: E/StrictMode(615):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-30 23:52:11.238: E/StrictMode(615):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-30 23:52:11.238: E/StrictMode(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-30 23:52:11.238: E/StrictMode(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-30 23:52:11.238: E/StrictMode(615):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.emailcommon.service.AccountServiceProxy.getDeviceId(AccountServiceProxy.java:116)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.exchange.ExchangeService.getDeviceId(ExchangeService.java:1249)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1856)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-30 23:52:11.238: E/StrictMode(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-30 23:52:11.238: E/StrictMode(615):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-30 23:52:11.238: E/StrictMode(615):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-30 23:52:11.238: E/StrictMode(615):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-30 23:52:11.238: E/StrictMode(615):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-30 23:52:11.238: E/StrictMode(615):  at java.lang.Thread.run(Thread.java:856)
12-30 23:52:11.272: W/ActivityManager(290): Unbind failed: could not find connection for android.os.BinderProxy@40fb7e78
12-30 23:52:11.328: E/ActivityThread(615): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d32ef0 that was originally bound here
12-30 23:52:11.328: E/ActivityThread(615): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d32ef0 that was originally bound here
12-30 23:52:11.328: E/ActivityThread(615):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-30 23:52:11.328: E/ActivityThread(615):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-30 23:52:11.328: E/ActivityThread(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-30 23:52:11.328: E/ActivityThread(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-30 23:52:11.328: E/ActivityThread(615):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-30 23:52:11.328: E/ActivityThread(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-30 23:52:11.328: E/ActivityThread(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-30 23:52:11.328: E/ActivityThread(615):  at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
12-30 23:52:11.328: E/ActivityThread(615):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
12-30 23:52:11.328: E/ActivityThread(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-30 23:52:11.328: E/ActivityThread(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-30 23:52:11.328: E/ActivityThread(615):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-30 23:52:11.328: E/ActivityThread(615):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-30 23:52:11.328: E/ActivityThread(615):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-30 23:52:11.328: E/ActivityThread(615):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-30 23:52:11.328: E/ActivityThread(615):  at java.lang.Thread.run(Thread.java:856)
12-30 23:52:11.398: E/StrictMode(615): null
12-30 23:52:11.398: E/StrictMode(615): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d32ef0 that was originally bound here
12-30 23:52:11.398: E/StrictMode(615):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
12-30 23:52:11.398: E/StrictMode(615):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
12-30 23:52:11.398: E/StrictMode(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
12-30 23:52:11.398: E/StrictMode(615):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
12-30 23:52:11.398: E/StrictMode(615):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
12-30 23:52:11.398: E/StrictMode(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
12-30 23:52:11.398: E/StrictMode(615):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
12-30 23:52:11.398: E/StrictMode(615):  at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
12-30 23:52:11.398: E/StrictMode(615):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
12-30 23:52:11.398: E/StrictMode(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
12-30 23:52:11.398: E/StrictMode(615):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
12-30 23:52:11.398: E/StrictMode(615):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-30 23:52:11.398: E/StrictMode(615):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-30 23:52:11.398: E/StrictMode(615):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-30 23:52:11.398: E/StrictMode(615):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-30 23:52:11.398: E/StrictMode(615):  at java.lang.Thread.run(Thread.java:856)
12-30 23:52:11.448: W/ActivityManager(290): Unbind failed: could not find connection for android.os.BinderProxy@40f92598 
```

XML:

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_gravity="center"
android:orientation="vertical" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

 <Button
 android:id="@+id/dmute"
 style="?android:attr/buttonStyleSmall"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_marginLeft="3dp"
 android:minHeight="30dp"
 android:minWidth="48dp"
 android:text="Mute" />

 <Button
 android:id="@+id/dreset"
 style="?android:attr/buttonStyleSmall"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_marginLeft="198dp"
 android:minHeight="30dp"
 android:minWidth="48dp"
 android:text="Reset" />
</LinearLayout>

 <LinearLayout
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:orientation="horizontal"
 android:paddingTop="20dp" >

 <TextView
 android:id="@+id/dcount"
 android:layout_width="0dip"
 android:layout_height="wrap_content"
 android:layout_weight="90"
 android:gravity="center"
 android:singleLine="true"
 android:text="Numbers"
 android:textSize="25sp" />

 <Button
 android:id="@+id/addtototal1"
 style="?android:attr/buttonStyleSmall"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_weight="5"
 android:text="+ to Total" />

  </LinearLayout>

  <LinearLayout
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:orientation="horizontal"
  android:paddingTop="20dp" >

  <EditText
  android:id="@+id/enteramount"
  android:layout_width="0dip"
  android:layout_height="wrap_content"
  android:layout_gravity="center"
  android:layout_weight="90"
  android:gravity="center"
  android:hint="Enter Amount"
  android:inputType="number"
  android:singleLine="true"
  android:textSize="25sp" />

  <Button
  android:id="@+id/addtototal2"
  style="?android:attr/buttonStyleSmall"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:layout_weight="5"
  android:text="+ to Total" />

 </LinearLayout>

 <LinearLayout
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:orientation="horizontal"
 android:paddingTop="20dp" >

 <TextView
 android:id="@+id/totalCount"
 android:layout_width="0dip"
 android:layout_height="wrap_content"
 android:layout_gravity="center"
 android:layout_weight="80"
 android:gravity="center"
 android:singleLine="true"
 android:textSize="25sp" />

  <Button
  android:id="@+id/cleartotal"
  style="?android:attr/buttonStyleSmall"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:text="Clear" />

 </LinearLayout>

  <Button
  android:id="@+id/dclick"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:layout_gravity="center"
  android:layout_marginTop="30dp"
  android:height="120dp"
  android:width="250dp" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:45:25.557

在转换为 Double 之前以这种方式检查条件...

```
if(enteramount.getText().toString().length()>0)
{
   x=Double.parseDouble(enteramount.getText().toString());
}
if(totalCount.getText().toString().length()>0)
{
   y=Double.parseDouble(totalCount.getText().toString());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:02:06.643

您必须初始化您的按钮 addtotal1：

```
 addtotal1 = (Button)findViewById(R.id.yourButtonId); 
```

在您可以设置 onClickListener 之前。

## 编辑

您的 xml EditText 只有 inputType“数字”，因此用户不能输入一些十进制值。如果你想要这样，你不需要双变量。使用 int 而不是 double，因此您的结果不显示小数点：

```
 public class durood extends Activity{

         private TextView txtCount;
         private TextView totalCount;
         private EditText enteramount;
         private Button btnCount;
         private Button addtotal1;
         private Button addtotal2;
         private Button cleartotal;
         private static int count=0;
         private int x=0;
         private int y=0;
         private int z=0;

          @Override
           public void onCreate(Bundle savedInstanceState) {
           super.onCreate(savedInstanceState);
            // The activity is being created.
            setContentView(R.layout.durood);

            enteramount = (EditText)findViewById(R.id.enteramount);
            totalCount = (TextView)findViewById(R.id.totalCount);
            addtotal1=(Button)findViewById(R.id.addtototal1);
            addtotal2=(Button)findViewById(R.id.addtototal2);

            //add to total 1
            addtotal1.setOnClickListener(new View.OnClickListener() {
              public void onClick(View v) {

              x=Integer.parseInt(enteramount.getText().toString());
              y=Integer.parseInt(totalCount.getText().toString());
              z=x+y;
              totalCount.setText(Integer.toString(z));
              //to set value of enteramount to 0
              enteramount.setText("0"); //or enteramaount.setText("") if You want show nothing
            }

           }); 
```

# c# - 在 C# 中的 Active Directory 的 PrincipalSearcher QueryFilter 中排除空结果

> ID：14095832
> 
> 赞同：3
> 
> 时间：2012-12-30T23:38:42.673
> 
> 标签：c#, active-directory

尝试在 Active Directory 中搜索有关用户的非空描述（意味着他们有职位），如下面的第 4 行所示，但出现错误，我无法使用排除！

对另一种方法的建议？

```
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);
UserPrincipal qbeUser = new UserPrincipal(ctx);
PrincipalSearcher srch = new PrincipalSearcher(qbeUser);
var example = new UserPrincipal(ctx) { Description != null }; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T08:27:54.027

我会尝试这样的事情：

```
using (PrincipalContext ctx = new PrincipalContext(ContextType.Domain))
{
    UserPrincipal qbeUser = new UserPrincipal(ctx);
    qbeUser.Description = "*";   // something, anything - just not empty/NULL

    PrincipalSearcher srch = new PrincipalSearcher(qbeUser);
     ......
} 
```

那对你有用吗？基本上，只需在 the 上定义属性`qbeUser`并使用`*`通配符表示您希望用户在`Description`属性中具有某些内容 - 某些东西，任何东西 - 不是什么都没有。

# forms - 如何通过 Forms API 将节点内容提交到节点

> ID：14095833
> 
> 赞同：0
> 
> 时间：2012-12-30T23:38:44.283
> 
> 标签：forms, drupal

我正在尝试使用 drupal 6.26 将自定义内容类型 - 节点存储在 drupal 数据库中。我已经创建了模式表，但是当我执行表单的提交按钮时，出现以下错误：

> 用户警告：键“PRIMARY”查询的重复条目“0-0”：service_form_submit /* admin：service_form_submit */ INSERT INTO service (nid, vid,uid, fallbackservice_ids, category, biblebasic, blocked, reason_blocked, created, begin, stop ) VALUES (0, 0, 0, '', '', '', 0, '', 0, 0, 0 ) 在 /var/www/drupal/modules/service/service.module 第 261 行。

并且至少没有条目存储在数据库中，nid、vid、uid 或我输入的其他值似乎都不可用。

我如何通过 $node 是否正确？

```
function service_form(&$node) {
function service_form_submit($node) { 
```

这里是我如何使用 $node 的完整代码？

```
<?php
/**
* Implementation of hook_node_info().
*/
function service_node_info() {
  // We return an array since a module can define multiple node types.
  return array(
    'service' => array(
      'name' => t('Service'), // Required.
      'module' => 'service',  // Required. Prefix of the callback functions to look for: service_validate(), service_insert(), service_delete()
      'description' => t('Offer your service to the church.'), // Required.
      'has_title' => TRUE,
      'title_label' => t('Please enter your Service Name'),
      'has_body' => TRUE,
      'body_label' => t('Service Description'),
      'min_word_count' => 2,
      'locked' => TRUE
    )
    // todo here we add more node types later
  );
}

function service_form(&$node) {

// Get metadata for this node type
  // (we use it for labeling title and body fields).
  // We defined this in service_node_info().
  $type = node_get_types('type', $node);

  $form['general'] = array(
    '#type' => 'fieldset',
    '#title' => t('General Service Information')
  );
  // service name
  $form ['general']['title'] = array(
    '#type' => 'textfield',
    '#title' =>  check_plain($type->title_label), // 'Service Name',  //
    '#required' => TRUE,
    '#default_value' => $node->title,
    '#weight' => -5,
    '#maxlength' => 255,
  );
  // service description
  $form ['general']['body_filter']['body'] = array(
    '#type' => 'textarea',
    '#title' =>  check_plain($type->body_label),  // 'Service Description', //
    '#default_value' => $node->body,
    '#rows' => 6,
    '#required' => TRUE
  );
//  Filter options
// $form['body_filter']['filter'] = filter_form($node->format);

// todo replace with taxonomy  - ask forum
  $form ['general'] ['category'] = array(
    '#multiple' => '0',
    '#required' => '1',
    '#key_type_toggled' => '0',
    '#description' => t('Category of the service  '),
    '#default_value' => isset($node->category) ? $node->category : '',
    '#weight' => '3',
    '#type' => 'select',
    '#options' => array(
      '1' => t('Apostelservice'),
      '2' => t('Social Service'),
      '3' => t('Praying Service'),
   ),
  '#multiple_toggle' => '1',
  '#title' => t('Category'),
   );

     $form['availabilty'] = array(
    '#type' => 'fieldset',
    '#title' => t('Service Availabilty') ,
    '#collapsible' => TRUE,
    '#collapsed' => TRUE,
    );

   $form ['availabilty'] ['service_start'] = array(
   '#type' => 'date_popup',
   '#title' => t('Start service on'),
   '#size' => 20,
   '#maxlength' => 20,
   '#default_value' => isset($node->service_start) ? $node->service_start : '',
   );

   $form['availabilty']['service_stop'] = array(
   '#type' => 'date_popup',
   '#title' => t('Terminate Service at'),
   '#size' => 20,
   '#maxlength' => 20,
   '#default_value' => isset($node->service_stop) ? $node->service_stop : '',
   );

   // fallback service
   $form ['availabilty']['fallback_service'] = array(
  '#multiple' => '1',
  '#required' => '0',
  '#key_type_toggled' => '0',
  '#description' => t('Choose a fallback services to avoid bottlnecks'),
  '#default_value' => array(
   '0' => '1',
  ),
  '#type' => 'select',
  '#options' => array(
    '1' => t(' random / no fallback service'),
    '2' => t(' Fallback Service 2'),
    '3' => t(' Fallback Service 3'),
  ),
  '#multiple_toggle' => '1',
  '#title' => t('Fallback Services'),
  );

   $form ['availabilty']['blocked'] = array(
  '#default_value' => array(
  ),
  '#required' => '0',
  '#key_type_toggled' => '0',
  '#description' => t('The service can be disabled - blocked due to different reasons e.g. misuse, clarification needed'),
  '#weight' => '1',
  '#type' => 'checkboxes',
  '#options' => array(
    'one' => t('Block Service'),
   ),
  '#title' => t('Block Service'),
   );
   $form ['availabilty']['reason_blocked'] = array(
   '#required' => '0',
   '#input_format' => '1',
   '#description' => t('Please enter a reason why the Service is disabled, if this is the case.'),
   '#weight' => '2',
   '#type' => 'textarea',
   '#title' => t('Reason of blocked Service'),
   );

   $form['location'] = array(
   '#type' => 'fieldset',
   '#title' => t('Service location information')
   );

  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Register your service'),
  );

  return $form;
}
**
* Handle submission of the service form and saving
* of the data to the database.
*/
function service_form_submit($node) {

db_query("INSERT INTO {service} (nid, vid,uid,  fallbackservice_ids , category , biblebasic ,
blocked , reason_blocked , created , begin , stop) VALUES (%d, %d, %d, '%s', '%s', '%s',  %d, '%s', %d, %d, %d )",
$node->nid, $node->vid,$node->uid,  $node->fallbackservice_ids, $node->category,
  $node->biblebasic, $node->blocked, $node->reason_blocked,  $node->created, $node->begin, $node->stop);
  }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T16:07:07.273

您使用自定义模块执行此操作有什么特别的原因吗？为什么不直接创建一个新的内容类型？

如果你真的想用你自己的模块来做，你看过[示例模块](http://drupal.org/project/examples)吗？你真正想看的代码在[这里](http://drupalcode.org/project/examples.git/tree/refs/heads/6.x-1.x:/node_example)

# html - css @media mobile/desktop：确保桌面不显示移动 css

> ID：14095837
> 
> 赞同：0
> 
> 时间：2012-12-30T23:39:18.037
> 
> 标签：html, css, mobile, media

一直在通过 CSS 对网站进行移动重新设计。

让以下媒体查询为桌面或移动设备提供适当的 CSS

但是，当浏览器在 855 下调整大小时，桌面仍然会显示移动 css（虽然它似乎只是一些移动 css 文件）

你如何确保桌面永远不会加载移动 CSS？

谢谢

```
<link rel="stylesheet" type="text/css" href="css/layout.css" media="Screen and (min-device-width:855px),projection" />
<link rel="stylesheet" type="text/css" href="css/nav.css" media="Screen and (min-device-width:855px),projection" />
<link rel="stylesheet" type="text/css" href="css/type.css" media="Screen and (min-device-width:855px),projection" />

<link href="css/mobile.css" type="text/css" media="handheld, handheld and (max-device-width: 854px), only screen and (max-device-width: 854px), only screen and (max-width:854px)" rel="stylesheet" />
<link href="css/mobile-nav.css" type="text/css" media="handheld, handheld and (max-device-width: 854px), only screen and (max-device-width: 854px), only screen and (max-width:854px)" rel="stylesheet" />
<link href="css/mobile-type.css" type="text/css" media="handheld, handheld and (max-device-width: 854px), only screen and (max-device-width: 854px), only screen and (max-width:854px)" rel="stylesheet" /> 
```

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:01:48.627

在移动样式表媒体查询的末尾有以下规则：`only screen and (max-width:854px)`. 当浏览器的大小调整到 855 像素以下时，这将应用样式表。如果您只想将样式表应用于宽度为 854 像素或更小的*设备*，请`max-device-width`仅使用该属性。

# java - SharedPreferences——新应用的初始值来自哪里？

> ID：14095838
> 
> 赞同：0
> 
> 时间：2012-12-30T23:39:20.923
> 
> 标签：java, android

我一直在研究将首选项与我创建的应用程序一起使用。例如：

我的应用程序的一部分需要倒数计时器。此倒计时计时器的默认值应为 8:00（8 分钟或 480000 毫秒）。但是，我需要用户能够将其更改为他们想要的任何值。

在我的研究中，我发现了 Android 内置的 SharedPreferences 功能，但我有点困惑它是如何工作的。

我的想法是该应用程序将寻找共享的偏好，如果它们不存在，则使用默认值。它似乎不起作用。一旦我安装了新应用程序（目前没有共享首选项 XML 文件，所以我认为它只会加载默认值，但我收到空指针错误并且应用程序崩溃。

这是我的相关代码：

```
long
    msSavedMainClock = 0,
    msSavedShotClock = 0,
    msShotClockStart,
    msMainClockStart;

TextView 
    tvPeriodPrefix,
    tvPeriod;

// Create the SharedPreferences object
SharedPreferences prefs = getSharedPreferences("settings", MODE_PRIVATE);

// Create the Preference Editor object
SharedPreferences.Editor prefsEditor = prefs.edit();

@Override
protected void onCreate(Bundle savedInstanceState) {

    /*******  more code here  *******/

    // Load the values/defaults from the SharedPreferences
    tvPeriodPrefix.setText( prefs.getString("Period_Prefix", getResources().getString(R.string.period)) );
    msMainClockStart = prefs.getLong( "Default_Main_Clock", 480000);    // 8 minute default
    msShotClockStart = prefs.getLong( "Default_Shot_Clock", 24000);     // 24 second default

    // Initialize other variables
    tvPeriod.setText( tvPeriodPrefix + "1" );

    /******* rest of my code here *******/ 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:43:32.657

`getSharedPreferences()`需要一个有效的上下文，所以最早可以运行此代码的是`onCreate()`：

```
// Create the SharedPreferences object
SharedPreferences prefs;

// Create the Preference Editor object
SharedPreferences.Editor prefsEditor;

@Override
protected void onCreate(Bundle savedInstanceState) {
    ...
    prefs = getSharedPreferences("settings", MODE_PRIVATE);
    prefsEditor = prefs.edit(); 
```

* * *

我之前可能已经为你回答过这样的问题，所以一个好的经验法则是：只尝试在你的方法之外设置原始变量。`int`像, `long`, 甚至`String`是安全的变量。但是要警惕任何以大写字母开头的数据类型，（`String`是一个例外）。

# php - 除非用户单击按钮，否则 HTML 表单默认值为空白？

> ID：14095844
> 
> 赞同：2
> 
> 时间：2012-12-30T23:40:27.647
> 
> 标签：php, html, forms, copy, field

为简单起见，让我们采用以下形式：

```
<form>
Title: <?php echo $title; ?><input type="text" name="title" value="">
</form> 
```

$title 变量包含书名。在此示例中，输出将是：

```
Title: The Hobbit <empty form field> 
```

这个想法是，空字段将允许用户在单击提交或将书名复制到字段中时更改书名。

问题是，我不知道如何创建“复制到字段”按钮。

此外，此表单有多个标题字段，每个字段都有相关选项，非常理想，页面不会重新加载，否则用户将永远无法一次修改所有标题。

任何人都可以指出我正确的方向吗？理想情况下，我不会使用 javascript 并严格使用 php/html。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:58:49.700

为什么不默认在 value-attribute 中写标题？

```
<form>
Title: <input type="text" name="title" value="<?php echo $title; ?>">
</form> 
```

您可以使用 css 让输入元素看起来像一个普通的文本，但是在 :focus 上，它通过设置典型的边框“转移”到输入。

优点是：每个输入元素都有默认值，因此如果用户发送您的表单，则所有值都存在。

但是，请注意转义字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:47:32.540

```
 <?php $title="Some Title"; ?>

  <form method="post">

   Title: <?php echo $title; 

    <input type="hidden" name="title_name" value="<?php echo $title; ?>">

    <input type="text" name="title" value="<?php if (isset($_POST['title_name'])){echo $_POST['title_name'];}?>">

    <input type="submit" value="Change Value">

 </form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:04:06.243

```
<form method="post">
    Title: <?php echo $_POST['title']; ?><input type="text" name="title[]" value="<?php echo $_POST['title']; ?>">
    <input type="submit" value="Change Value">
</form> 
```

如果您有多个字段，则需要在标题行周围放置一个 for each 循环，并且底部只有一个提交按钮，并且名称字段需要是一个数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T00:07:43.230

```
<form>
    Title: <input type="text" name="title" value="<?= @$_POST['title'] ?>">
</form> 
```

# c# - 使用 TextWrapping 和 ScrollViewer 的大性能问题

> ID：14095845
> 
> 赞同：4
> 
> 时间：2012-12-30T23:40:31.127
> 
> 标签：c#, wpf, xaml, scrollviewer, word-wrap

我有以下 XAML：

```
<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
    <TextBlock HorizontalAlignment="Stretch" Margin="10" 
               VerticalAlignment="Stretch" TextWrapping="Wrap"/>
</ScrollViewer> 
```

当我调整`ScrollViewer`放置 Window 的大小时，我遇到了一个非常大的性能问题：窗口冻结了几秒钟！

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:20:31.427

如果可能且有意义，请尝试将目标框架更改为 4 或更高（在项目属性页面上）。它有时会有所帮助。CLR 4 的速度要快得多。

# oracle - Oracle DDL 上的 Liquibase 幂等性

> ID：14095846
> 
> 赞同：6
> 
> 时间：2012-12-30T23:41:02.703
> 
> 标签：oracle, liquibase, sql-update

我正在研究将 Liquibase 用于使用 Oracle 的新项目，我想知道如何确保我的变更集足够强大，可以在无需人工干预的情况下从任何类型的故障中恢复。理想情况下，我会使用 runInTransaction 属性，它允许 DDL 在失败时回滚，但 Oracle 会在 DDL 上自动提交。对于这种情况，文档建议：

*因此，通常最好每个 changeSet 只进行一次更改，除非您希望将一组非自动提交更改应用为事务，例如插入数据。*

每个 changeSet 有一个 DDL 会减少出现问题的机会，但不会消除它们。如果 DDL 成功，但对 DATABASECHANGELOG 的更新失败，从我的测试来看，Liquibase 似乎只是卡住了，需要手动干预。

有必要在每一步都使用前置条件来避免这个问题吗？这使得生成的变更集非常冗长。这是 Liquibase 示例表定义之一：

```
<changeSet author="jsmith" id="1">
    <createTable tableName="departments"
                 remarks="The departments of this company. Does not include geographical divisions.">
        <column name="id" type="number(4,0)">
            <constraints nullable="false" primaryKey="true"
                         primaryKeyName="DPT_PK"/>
        </column>
        <column name="dname" type="varchar2(14)"
                remarks="The official department name as registered on the internal website."/>
    </createTable>
    <addUniqueConstraint constraintName="departments_uk1"
                         columnNames="dname" tableName="departments"/>
    <createSequence sequenceName="departments_seq"/>
</changeSet> 
```

为了使它具有幂等性，我认为它必须更改为以下内容：

```
<changeSet author="jsmith" id="1">
    <preConditions onFail="MARK_RAN">
        <not>
            <tableExists tableName="departments" />
        </not>
    </preConditions>
    <createTable tableName="departments"
        remarks="The departments of this company. Does not include geographical divisions.">
        <column name="id" type="number(4,0)" / column>
            <column name="dname" type="varchar2(14)"
                remarks="The official department name as registered on the internal website." />
    </createTable>
</changeSet>

<changeSet author="jsmith" id="2">
    <preConditions onFail="MARK_RAN">
        <not>
            <primaryKeyExists primaryKeyName="pk_departments" />
        </not>
    </preConditions>
    <addPrimaryKey tableName="departments" columnNames="id"
        constraintName="pk_departments" />
</changeSet>

<changeSet author="jsmith" id="3">
    <preConditions onFail="MARK_RAN">
        <not>
            <uniqueConstraintExists constraintName="departments_uk1" />
        </not>
    </preConditions>
    <addUniqueConstraint constraintName="departments_uk1"
        columnNames="dname" tableName="departments" />
</changeSet>

<changeSet author="jsmith" id="4">
    <preConditions onFail="MARK_RAN">
        <not>
            <sequenceExists sequenceName="departments_seq" />
        </not>
    </preConditions>
    <createSequence sequenceName="departments_seq" />
</changeSet> 
```

有没有更简单的方法来实现这一点？我原以为 Liquibase 能够生成这些先决条件。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T19:46:00.427

不幸的是，在大多数 RDBMS 中，DDL 语句提交事务，而 Liquibase 仅通过回滚事务来对失败做出反应。所以首先我要做的是将每个 DDL 语句包装在一个单独的变更集中。

在哪些情况下更新数据库更改日志会失败？我很好奇，因为这应该非常强大。

无论如何，您可以通过为 Liquibase 编写一个小扩展来避免重复自己，该扩展会自动为您的所有变更集执行此操作。看一下[前提条件](https://liquibase.jira.com/wiki/display/CONTRIB/Precondition)扩展点。

# python - 用python计算类似的颜色

> ID：14095849
> 
> 赞同：6
> 
> 时间：2012-12-30T23:42:17.273
> 
> 标签：python, colors

如果我有 RGB 值：`255, 165, 0`，可以做些什么来计算 和 的类似颜色`218, 255, 0`，`255, 37, 0`但仍然适用于任何 RGB 颜色？

例如：

```
>>> to_analogous(0, 218, 255)
[(0, 255, 165),(0, 90, 255)] 
```

编辑：为简单起见，可以将类似的颜色视为这样，绿色是输入颜色，然后蓝绿色和黄绿色是输出：（[来源：][[tigercolor.com](http://www.tigercolor.com/Images/Analogous.gif)][）]
[![](../Images/64aeeddc4e3e6245f1b35f3176669d41.png)](https://i.stack.imgur.com/tvKpp.gif)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-02T03:27:53.247

从 RGB 转换为 HSL 并旋转 +/- 30 度可能确实是您想要的，但您不会得到显示的色轮。分别获得 12 和 128 种颜色，从纯红色（顶部）开始，您将获得以下结果：

![在此处输入图像描述](../Images/1e8c3b4128d2d1a31de46a0c37bc57d4.png) ![在此处输入图像描述](../Images/988b6a8103179525e674ebf50c9f6874.png)

这是产生类似颜色的示例代码：

```
import colorsys

DEG30 = 30/360.
def adjacent_colors((r, g, b), d=DEG30): # Assumption: r, g, b in [0, 255]
    r, g, b = map(lambda x: x/255., [r, g, b]) # Convert to [0, 1]
    h, l, s = colorsys.rgb_to_hls(r, g, b)     # RGB -> HLS
    h = [(h+d) % 1 for d in (-d, d)]           # Rotation by d
    adjacent = [map(lambda x: int(round(x*255)), colorsys.hls_to_rgb(hi, l, s))
            for hi in h] # H'LS -> new RGB
    return adjacent 
```

另一个色轮是通过考虑减色系统获得的。为此，为了简单起见，让我们考虑一下 RYB 色彩空间（它代表您可能在任何典型学校的艺术课上学到的色彩混合）。通过使用它，我们立即获得以下轮子：

![在此处输入图像描述](../Images/7cb5e1524afda2a4cf2967467330e3cd.png) ![在此处输入图像描述](../Images/077a100b9a982a515fb4903a96b6c883.png)

为了获得这些相似的颜色，我们考虑将 RGB 中的颜色直接表示 RYB 中的颜色，然后将 RYB 转换为 RGB。例如，假设您在 RGB 中有一个三元组 (255, 128, 0)。将该三元组称为 RYB 三元组并转换为 RGB 以获得 (255, 64, 0)。这种 RYB -> RGB 转换并不是唯一的，因为它可能有多个定义，我使用了 Gosset 和 Chen 的“Paint Inspired Color Compositing”中的一个。这是执行转换的代码：

```
def _cubic(t, a, b):
    weight = t * t * (3 - 2*t)
    return a + weight * (b - a)

def ryb_to_rgb(r, y, b): # Assumption: r, y, b in [0, 1]
    # red
    x0, x1 = _cubic(b, 1.0, 0.163), _cubic(b, 1.0, 0.0)
    x2, x3 = _cubic(b, 1.0, 0.5), _cubic(b, 1.0, 0.2)
    y0, y1 = _cubic(y, x0, x1), _cubic(y, x2, x3)
    red = _cubic(r, y0, y1)

    # green
    x0, x1 = _cubic(b, 1.0, 0.373), _cubic(b, 1.0, 0.66)
    x2, x3 = _cubic(b, 0., 0.), _cubic(b, 0.5, 0.094)
    y0, y1 = _cubic(y, x0, x1), _cubic(y, x2, x3)
    green = _cubic(r, y0, y1)

    # blue
    x0, x1 = _cubic(b, 1.0, 0.6), _cubic(b, 0.0, 0.2)
    x2, x3 = _cubic(b, 0.0, 0.5), _cubic(b, 0.0, 0.0)
    y0, y1 = _cubic(y, x0, x1), _cubic(y, x2, x3)
    blue = _cubic(r, y0, y1)

    return (red, green, blue) 
```

# php - 使用 Wordpress“按此”按钮自动将链接添加到自定义字段

> ID：14095850
> 
> 赞同：2
> 
> 时间：2012-12-30T23:42:23.917
> 
> 标签：php, wordpress, hyperlink

标题几乎解释了它，我有一个客户希望能够上网，单击 wordpress“按此”按钮并自动将页面链接添加到自定义字段。我知道这是可能的，因为当您单击“按此”按钮时，它会自动将您所在页面的链接作为 href 链接添加到帖子窗口中。

下一个最佳解决方案是找到一种方法来编辑编辑器的输出，以删除 wordpress 自动添加到编辑器的额外文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-18T13:30:14.490

其解决方案是在表单发布表单中添加或附加隐藏字段。在价值上，你必须回显 $_GET['u']。现在，在通过 ajax 提交时，您将看到您的隐藏字段与 URL 一起提交。

在这里，您可以挂钩“save_post”并更新该字段名称 $_POST['field-name'] 的自定义字段。

PS如果你想让我也粘贴脚本，请回复。

这是 prepend 的工作示例：

```
<?php function admin_footer_scripts(){?>
<script type="text/javascript" language="javascript">

jQuery(document).ready(function($){
    //$('#url-scan-submit').on('click', function(){
        $('#pressthis-form').prepend('<input type="hidden" name="link_url" value="<?php echo isset($_GET['u'])?$_GET['u']:''; ?>" />');
    //});
});</script><?php   
} 
add_action('admin_footer', 'admin_footer_scripts');
?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T04:52:41.910

我认为您的要求是可能的，但您可能需要重新设计小书签并使用自定义插件而不是标准的 press-this.php。（我还没有检查过，但也可能有 pressthis 钩子。）

我在使用 Gravity 表单方面也取得了巨大成功，因为它可以轻松创建帖子并且可以直接从 URL 参数填充自定义字段。对于您所描述的内容，自定义小书签加上重力形式将是一个非常有效的解决方案。

# android - 使用 getIdentifier() 的资源 ID 始终为 0

> ID：14095851
> 
> 赞同：1
> 
> 时间：2012-12-30T23:42:29.613
> 
> 标签：android

我有以下代码：

```
dataAdapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
        if (view.getId() == R.id.listitem_exercise_image) {
            String image_1 = cursor.getString(columnIndex);
            Log.d("MyApp", "image_1 = " + image_1);
            int resourceId = getResources().getIdentifier(image_1 , "drawable", getPackageName());
            Log.d("MyApp", "image_1 id = " + String.valueOf(resourceId));
            return true;
        }

        return false;
    }
}); 
```

现在，在日志中，它显示了我的`Log.d`：

```
12-30 23:34:04.995: D/MyApp(8354): image_1 = abdominal_4_point_drawing_in_1.png
12-30 23:34:05.015: D/MyApp(8354): image_1 id = 0
12-30 23:34:05.165: D/MyApp(8354): image_1 = alternate_hammer_curl_1.png
12-30 23:34:05.195: D/MyApp(8354): image_1 id = 0
12-30 23:34:05.325: D/MyApp(8354): image_1 = alternate_incline_dumbbell_curl_1.png
12-30 23:34:05.335: D/MyApp(8354): image_1 id = 0 
```

现在所有这些 .png 文件都存在于“drawable”文件夹中。他们肯定在那个文件夹里。我知道这一点，因为我是将它们放入该文件夹的人，而且我也只是仔细检查过。我还运行了 Project Clean。

那么为什么每个资源 ID 都为 0 呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T23:45:39.293

资源标识符不以 结尾`".png"`，扩展被剥离并完成了一些其他转换。现在，如果`image_1`在哪里`"abdominal_4_point_drawing_in_1"`并且有一个资源可以生成 a`R.drawable.abdominal_4_point_drawing_in_1`它会起作用。

# php - Symfony 1.4：无法设置会话变量

> ID：14095861
> 
> 赞同：2
> 
> 时间：2012-12-30T23:43:36.047
> 
> 标签：php, session, symfony-1.4, session-variables

我正在尝试设置一个可以跨所有操作/模板访问的 symfony 会话变量。一旦验证了用户凭据，用户通过身份验证，但在他被重定向到他的主页之前，就会完成此操作。

代码如下所示：

```
// Authentication verified 

$this->getUser()->setAuthenticated(true);
// note I am deliberately using a static value
$this->getUser()->setAttribute('userid',"4"); 
$this->redirect('flashcard/index'); 
```

当我尝试在我的一项操作中获取此属性时，如下所示：

`$this->getUser()->getAttribute('userid')`它返回空值，

我采取`var_dump`这样的：

```
var_dump($this->getUser()->getAttributeHolder()->getAll()); 
```

它返回一个空数组，这意味着有些事情不太正确。

提醒一下，我没有使用 sfDoctrineGuard 进行登录身份验证，尽管我认为设置会话变量与它没有任何关系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T03:55:09.300

不确定错误是什么，但这里有一些改进代码并尝试调试它的建议：

1 - 在你的用户类中添加自定义函数，这样你就可以调用 $this->getUser()->setMyVariable(4), $this->getUser()->getMyVariable(), $this->getUser() ->isMyVariableDefined()... 这样可以避免名称和命名空间上的任何拼写错误...

2 - 添加命名空间以防万一（避免通用名称冲突，例如用户 ID）...

像这样的东西：

```
public function setMyVariable($value = null)
{
  $this->setAttribute('user_id', $value, 'some_namespace');
} 
```

3 - 用户登录后，使用调试栏检查用户属性 - 无需编写代码。如果它在那里，请继续检查以找出它何时消失...

# asp.net-mvc - Count 属性根据其他总数初始化

> ID：14095862
> 
> 赞同：0
> 
> 时间：2012-12-30T23:43:37.490
> 
> 标签：asp.net-mvc

我想知道这是否有意义。

我有一个 DTO 模型：

```
public class CategoryListByKeywordsDetailDto : ILocalizable
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string NameEN { get; set; }
    public string NameES { get; set; }
    public string NameFR { get; set; }
    public string NamePT { get; set; }
    public int SearchCount { get; set; }
    public string ListController { get; set; }
    public string ListAction { get; set; }
} 
```

以及它的清单

```
public class CategoryListByBeywordsListDto
{
    public CategoryListByBeywordsListDto()
    {
        CategoryListByKeywordsDetails = new List<CategoryListByKeywordsDetailDto>();
    }

    public IList<CategoryListByKeywordsDetailDto> CategoryListByKeywordsDetails { get; set; }

    public int TotalSearchCount { get; set; }
} 
```

我可以根据'列表'实时计算`TotalSearchCount`属性吗？`CategoryListByKeywordsDetails``SearchCount`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:21:00.420

你应该能够做到这一点。您只需要实现 TotalSearchCount 的 get 方法。尝试这样的事情：

```
public class CategoryListByBeywordsListDto
{
    public CategoryListByBeywordsListDto()
    {
        CategoryListByKeywordsDetails = new List<CategoryListByKeywordsDetailDto>();
    }

    public IList<CategoryListByKeywordsDetailDto> CategoryListByKeywordsDetails { get; set; }

    public int TotalSearchCount 
    { 
        get
        {
            if(CategoryListByKeywordsDetails != null)
            {
                return CategoryListByKeywordsDetails.Sum(x => x.SearchCount);
            }

            return 0;
        }

        //leave out set.
    }
} 
```

如果您有多个客户端进程更新 Dto 上的 SearchCount，那么您将遇到更多麻烦。如果您需要在没有用户交互的情况下在客户端上进行更新（即刷新按钮），您需要实现一些东西来定期轮询您的数据库并将值推送到客户端。涉及更多，并不是真正可以在堆栈溢出问题中回答的问题。

# ios - UIWebView 组件的启动时间？

> ID：14095866
> 
> 赞同：3
> 
> 时间：2012-12-30T23:44:18.770
> 
> 标签：ios, performance, uiwebview, xamarin.ios, ios-simulator

对于 iOS 应用程序（用 C#/MonoTouch 编写），我使用 UIWebView 动态呈现一些内容。虽然这工作正常，但我遇到了一个烦人的问题：我第一次使用 UIWebView（自应用程序启动以来），显示任何内容都需要几秒钟。这可以克服吗？

我不“回收”实例化的 UIWebView，在每个屏幕上我使用一个 UIWebView，我创建一个新的 viewcontroller/UIWebView 组合。

我试图在我的 appdelegate 中实例化一个随机 UIWebView，但这不会产生任何效果（可能是因为它不可见）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T17:49:52.560

首先，您最好[启动](http://docs2.xamarin.com/ios/Videos/Details/Optimizing-CPU-Performance-in-Xamarin-apps-with-Instruments)Apple 的 Instruments 以准确找出时间流逝的地方。

我*怀疑*这至少部分来自于在您的应用程序进程中加载​​和初始化 Web 浏览器库。这将是**一次性**支付的价格，这听起来与您的描述相似。

*如果*情况确实如此，那么您可能能够在启动应用程序时*预加载*库，例如在单独的线程中（但注意不要调用任何线程敏感代码）。

这应该使第*一次*使用时间类似于*第二次*（以及更多）时间。由于该初始化将在单独的线程上完成，因此它不会对您的应用程序初始化产生太大影响（至少在多核设备上）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:08:57.983

你想玩弄这些方法：

```
-(void)webViewDidStartLoad:(UIWebView *)webView

-(void)webViewDidFinishLoad:(UIWebView *)webView 
```

在这些方法中添加条件，然后您可以让 ViewController 在网页加载时执行操作。

# git - git pull - 无法提交合并消息

> ID：14095867
> 
> 赞同：70
> 
> 时间：2012-12-30T23:44:18.393
> 
> 标签：git, git-merge, git-pull, commit-message

> **可能重复：**
> [github 在使用 pull 命令时锁定了 mac 终端](https://stackoverflow.com/questions/14046122/github-locks-up-mac-terminal-when-using-pull-command)

我正在通过 Mac 上的终端使用 git。我最近在尝试执行时遇到了一个烦人的问题`git pull`。执行后，`git pull`我收到以下错误消息：

```
Merge ssh://domain.com/repository.git
# Please enter a commit message to explain why this merge is necessary,
# especially if it merges an updated upstream into a topic branch.
#
# Lines starting with '#' will be ignored, and an empty message aborts:
# the commit. 
```

问题是我无法输入任何内容。我的终端似乎卡住了，我似乎无能为力。我对 git 相当陌生，所以这可能是我犯的一个简单错误。

[我在这里](https://stackoverflow.com/questions/11744081/why-is-git-prompting-me-for-a-post-pull-merge-commit-message)读到，对于某些人来说，此时文本编辑器会打开。这当然不是我的情况。它还在那里声明我可以使用 --no-edit 标志在没有消息的情况下进行合并，但即使这在我看来也不起作用。

我现在有点无能为力，卡住并且无法将任何更改推送到我的服务器。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-12-30T23:45:59.850

这是vim，是通用的unix编辑器

按：

```
:wq 
```

而已。（w=写q=退出）

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-12-30T23:46:55.820

当你看到这个时，一个编辑器已经打开了，因为你看到了这个；）我猜它打开`vi`了，或者这个的派生词。谷歌它找出如何使用它，但似乎你更喜欢改变编辑器

```
git config --global core.editor "emacs" 
```

我更喜欢`nano`:)

# android - 检测 Android 设备屏幕上的重量

> ID：14095868
> 
> 赞同：0
> 
> 时间：2012-12-30T23:44:43.387
> 
> 标签：android, api, scale

> **可能重复：**
> [获得按下按钮的压力](https://stackoverflow.com/questions/4220554/getting-the-pressure-with-which-a-button-gets-pressed)

我能找到的唯一一种压力函数可以测量海平面压力。我还没有找到任何可以做到这一点的 API。但我在市场上发现了几个应用程序，它们可以作为……非法物质的缩放器。尽管如此，我想知道如何实现这一目标。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:49:55.377

这仅在某些设备上是可能的，并且精度非常低。`MotionEvent`的[`getPressure()`](http://developer.android.com/reference/android/view/MotionEvent.html#getPressure())方法旨在确定这一点；但是，它仅取决于`1`目标设备的精度、校准和功能集（某些设备总是会说 ）：

> 压力的范围通常从 0（完全没有压力）到 1（正常压力），但是根据输入设备的校准，可能会产生高于 1 的值。
> 
>      --*[开发者文档](http://developer.android.com/reference/android/view/MotionEvent.html#getPressure(int))*

一些设备还注册了一个[工具类型](http://developer.android.com/reference/android/view/MotionEvent.html#getToolType(int))，这可能与您的预期有不同的压力。远非说“来自金属物体的 2 磅压力”。

还值得注意的是，这仅适用于触摸事件 ( `MotionEvent`) - 放置一些东西，例如一沓纸，它不会记录触摸事件，根本不会显示任何压力。

# url - 在 Blogger 中获取页面的 URL

> ID：14095871
> 
> 赞同：0
> 
> 时间：2012-12-30T23:45:15.477
> 
> 标签：url, blogger

我刚刚使用 Blogger 开始了一个博客，但我不知道如何获取我创建的页面的 URL？例如，假设我创建了一个名为“About”的页面。页面的 URL 是什么？我尝试了 mywebsite/about 但仍然没有链接到任何东西。我也在使用自定义模板，所以我没有使用 Pages 小部件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:01:57.723

尝试以下操作：

```
http://<your-url.com>/p/about.html 
```

更改您的地址。

例如，如果您的地址是：hello-world.com

[它会是： http](http://hello-world.com/p/about.html) ://hello-world.com/p/about.html

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T22:48:17.073

您必须从浏览器地址栏中获取它，因为它很容易用于 ex。 [http://hello-world.com/p/about_16.html](http://hello-world.com/p/about_16.html) 我仍然不知道是否有任何方法可以改变它。大多数tuts都说不是

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-01T15:10:42.480

我暂时添加了页面小部件，只是为了在那里添加我的新页面，然后才能通过博客直接访问我的页面。然后我能够检查网址。不理想，但对我有用。如果有人有更好的主意，我也很乐意学习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-27T23:34:11.433

访问 blogger.com：

*   选择您想要的博客
*   转到页面
*   单击要获取其 url 的页面（或将光标放在其名称上）
*   编辑|查看|共享...选项将被看到
*   点击查看
*   新窗口打开，在搜索中您会看到要复制并粘贴到您想要的链接
*   此外，我无法获得此方法的快捷方式，每次执行此任务时都必须遵循这些步骤

# c++ - SFINAE会员通行证

> ID：14095872
> 
> 赞同：3
> 
> 时间：2012-12-30T23:45:36.443
> 
> 标签：c++, templates, sfinae

我想知道是否可以创建一个作为 std::enable_if 和 SFINAE 成员检测器之间的组合的类。

```
class foo
{
public:
    int bar;
};

template <class T>
typename enable_if_has_bar<T>::type ReturnBar (const T& value)
{
    return value.bar;
} 
```

所以我试图这样做。

```
class foo
{
public:
    int bar;
};

template <class C, C>
class Check;

template <class T, class Enable = void>
class enable_if_has_bar
{};

template <class T>
class enable_if_has_bar<T, Check <decltype(&T::bar),&T::bar>>
{
public:
    typedef decltype(static_cast<T*>(0)->*static_cast<decltype(&T::bar)>(0)) type;
};

template <class T>
typename enable_if_has_bar<T>::type ReturnBar (const T& value)
{
    return value.bar;
}

int main ()
{
    foo foobar;
    foobar.bar = 42;

    cout << ReturnBar(foobar) << endl;
} 
```

( [http://ideone.com/WKTfmQ](http://ideone.com/WKTfmQ) )

它似乎不起作用，而且我对 SFINAE 的美术还不够精通。也许有人可以改进/修复它？因为我很茫然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:13:32.233

`enable_if`我通常更喜欢按照您的尝试创建自定义样式类型，因为我发现使用单个特征类型而不是`enable_if<some_trait<T>, another_trait<T>>`. 但是在这种情况下，您的代码中存在一些问题，使其无法正常工作。

`enable_if_has_bar`永远不会选择您的专业化，返回类型`ReturnBar`只是实例化主模板，`enable_if_has_bar<foo, void>`并且从不定义嵌套的`type`. 没有什么会导致特化被实例化，所以没有任何东西可以检查是否`T::bar`是一个有效的表达式。

你的`decltype(static_cast<T*>(0)->*static_cast<decltype(&T::bar)>(0))`表达将导致`int&`不是`int`你可能想要的。这是因为`decltype(foobar.*(&foo::bar))`is 等价于`decltype(foobar.bar)`and`foobar.bar`是一个左值，所以`decltype`is `int&`。`ReturnBar`如果返回该函数将无法编译，`int&`因为参数`value`是 const，因此您不能绑定`value.bar`到非 const `int&`。

这是一个工作版本：

```
template <class T>
  class has_bar
  {
    template<typename U, typename = decltype(&U::bar)>
      static std::true_type
      test(U*);

    static std::false_type
    test(...);

  public:
    static const int value = decltype(test((T*)nullptr))::value;
  };

template<typename T, bool = has_bar<T>::value>
  struct enable_if_has_bar
  { };

template<typename T>
  struct enable_if_has_bar<T, true>
  : std::decay<decltype(std::declval<T&>().*(&T::bar))>
  { }; 
```

这首先声明了帮助`has_bar`器来回答类型是否具有嵌套成员的问题。该助手使用 SFINAE 来获取`true`或`false`值。if`&T::bar`是一个有效的表达式，那么将使用第一个重载 of `test`，它返回`true_type`，因此`value`将设置为`true_type::value`ie `true`。否则，将选择后备过载并将其`value`设置为`false`。

然后`enable_if_has_bar`模板使用默认模板参数，该参数被推导出为 的值`has_bar<T>::value`。`has_bar<T>::value`为 false时使用主模板。当`has_bar<T>::value`为真时使用特化，在这种情况下我们知道表达式`&T::bar`是有效的并且可以在 decltype 表达式中使用它来获取类型。

`std::decay`用于将`int&`decltype 表达式的结果转换为 just `int`。继承自`decay`比使用它定义成员要短一些，即：

```
typedef typename std::decay<decltype(std::declval<T&>().*(&T::bar))>::type type; 
```

我在未计算的表达式中使用了标准实用程序`declval<T>()`，它比`static_cast<T*>(0)`.

使用的替代方法`decay`是另一种帮助类型`int`从类型中获取类型，`int T::*`例如

```
template<typename T>
  struct remove_class;
  { };

template<typename Member, typename Class>
  struct remove_class<Member Class::*>
  {
    typedef Member type;
  };

template<typename T>
  struct enable_if_has_bar<T, true>
  : remove_class<decltype(&T::bar)>
  { }; 
```

（这个名字`remove_class`不是很好，但基本上它需要一个指向数据成员的指针类型并给出成员的类型。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-11T11:22:39.420

虽然 Jonathan Wakely 的回答非常好，但让我提供一个稍微不同的模式：

```
//this goes in some header so you can use it everywhere
template<typename T>
struct TypeSink{
    using Type = void;
};
template<typename T>
using TypeSinkT = typename TypeSink<T>::Type;

//here is the use case
template<typename T, typename = void>
struct enable_if_has_bar{ };

template<typename T>
struct enable_if_has_bar<T, TypeSinkT<decltype(std::declval<T&>().*(&T::bar))>>
  : std::decay<decltype(std::declval<T&>().*(&T::bar))>
  { }; 
```

这是一个活生生的例子：http: [//ideone.com/un0ZgH](http://ideone.com/un0ZgH)

虽然这自然是一个品味问题，但我喜欢使用类型接收器模式，因为 SFINAE 测试的语法和我在元函数体中实际使用的语法完全相同并且彼此相邻。因此，它希望不易出错。

# objective-c - scrollViewDidScroll 从未调用过

> ID：14095874
> 
> 赞同：16
> 
> 时间：2012-12-30T23:45:40.813
> 
> 标签：objective-c, cocoa-touch, uiscrollview

我在视图中有一个滚动视图。我想使用函数 scrollViewDidScroll 来检查和更新箭头（左右）。

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {

    NSLog(@"Did scroll");
    [self updateButtons];
} 
```

当我向左或向右滚动时，似乎不会调用 scrollViewDidScroll 。我搜索了所有内容，但没有找到解决方案。

希望有人有解决方案。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-12-31T00:16:24.880

典型的错误是“不简单地设置视图的委托”。你可能忘记的是

```
theScrollView.delegate = self; 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-08-16T18:59:09.890

我也有这种“症状”，并且为此失去了大约 2 个小时的生命。我显然正确设置了委托……但我不知道如何在滚动视图上设置**contentSize属性。**-.-

如果您不设置该属性，那么滚动视图不会认为有任何内容可以滚动到，因此不会触发预期的滚动视图方法。

# java - Linux top 命令如何确定 Java 进程的状态？

> ID：14095877
> 
> 赞同：5
> 
> 时间：2012-12-30T23:45:52.590
> 
> 标签：java, linux, process, jvm, infinite-loop

[更新：在`top`我按下显示线程而不是进程的 shift+H 之后，它将 Java 线程显示为 R 并使用 100% CPU 时间，这是我在发布此问题之前所期望的。]

**既然一个Java进程有多个线程，每个线程可能处于不同的状态，那么Linux`top`命令是如何确定Java进程状态的呢？**

如果我运行以下代码，

```
public class Test{
  public static void main(String[] args){
     while (true){
       int n = (int)(Math.random() * 1000);
     }
  }
} 
```

然后，运行`top`显示进程状态为 S，它正在使用 100% 的 CPU 时间。

此外，正在运行的`strace`节目并且只显示：

`futex(0x7f6ba759c9d0, FUTEX_WAIT, 26060, NULL`

但是，运行`jstack`显示主线程是RUNNABLE：

```
"main" prio=10 tid=0x00007fd7ec007800 nid=0x669b runnable [0x00007fd7f5754000]
  java.lang.Thread.State: RUNNABLE
    at Test.main(Test.java:5) 
```

`jstack`还表明，只有两个线程处于 WAITING 状态：

```
"Finalizer" daemon prio=10 tid=0x00007fd7ec080000 nid=0x66a6 in Object.wait() [0x00007fd7f0252000]
    java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        - waiting on <0x00000007ad001310> (a java.lang.ref.ReferenceQueue$Lock)
        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:133)
        - locked <0x00000007ad001310> (a java.lang.ref.ReferenceQueue$Lock)
        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:149)
        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:177)

"Reference Handler" daemon prio=10 tid=0x00007fd7ec07e000 nid=0x66a5 in Object.wait() [0x00007fd7f0353000]
    java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        - waiting on <0x00000007ad0011e8> (a java.lang.ref.Reference$Lock)
        at java.lang.Object.wait(Object.java:502)
        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:133)
        - locked <0x00000007ad0011e8> (a java.lang.ref.Reference$Lock) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:47:50.577

JVM 有*许多*线程在运行以执行“内务处理”，例如垃圾收集等。这些线程大部分时间都处于睡眠状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:59:08.063

> 然后，运行 top 显示进程状态为 S，它正在使用 100% 的 CPU 时间。

我认为问题很可能与`top`确定流程状态的方式有关。在操作系统级别，具有运行/等待/睡眠状态的是各个线程。我的猜测是，该`top`命令用于确定进程的名义运行/等待/睡眠状态的启发式方法具有误导性。

（以及`jstack`......的输出和常识......支持这个理论。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:49:05.960

该线程正忙于使用 CPU，它没有休眠。

```
"main" prio=10 tid=0x00007fd7ec007800 nid=0x669b runnable [0x00007fd7f5754000]
  java.lang.Thread.State: RUNNABLE
    at Test.main(Test.java:5) 
```

这表明顶部的信息不正确。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T08:16:39.293

有很多关于“为什么你有多个线程，以及它们在 Java 中做什么”的解释，但关于什么的解释不多。该`top`命令本身相当简单，因为它只是通过收集信息所需的系统调用 - 例如`getrusage`用于获取 CPU 使用率。

通常，正如所解释的那样，`top`一次查看整个进程，所有线程。您可以按“H”，`top`它将显示单个线程而不是整个进程，然后您将能够看到所有 Java 线程 [如果您的屏幕足够高]，其中主要线程正在使用您的所有 CPU无限循环，其他线程主要是什么都不做。

# javascript - 简单的纯Javascript拖动控制器滑块

> ID：14095880
> 
> 赞同：11
> 
> 时间：2012-12-30T23:46:04.807
> 
> 标签：javascript, slider, onmousedown, onmousemove

嗨，世界各地的开发人员。

我想对一个简单的纯 Javascript *（30 行）*、JQuery 免费*（和其他库的）* **拖动控制滑块有所帮助。**

我已经搜索了几个月，发现了很多脚本，但我不喜欢 -Jquery，因为大多数脚本需要 4、5、6 个 javascript 包括.. 我更喜欢更小和基本的脚本.. 我喜欢像我想要的那样调整它们，我也可以从较小的脚本中精益求精。

我所需要的只是一个简单的滑块，可用于：重新缩放图像、滚动页面、更改图像亮度*（使用 PHP）*等。

我是 javascript 新手*（2 个月）*，这就是我现在能走多远.. 抱歉变量名不好......

* * *

```
 <script type="text/javascript">  
      _item = null;
      mouse_x = 0;
      drag_x = 0; 
      function move_init() {
        document.onmousemove = _move;
        document.onmouseup = _stop;
      }
      function _stop(){
         _item = null;
      }
      function _move(e){
        mouse_x = document.all ? window.event.clientX : e.pageX;
        if(_item != null){
             _item.style.left = (mouse_x - drag_x) + "px";
        }
      }
      function _move_item(drag)
      {
        _item = drag;
        drag_x = mouse_x - _item.offsetLeft;
      }
move_init();
drag.onmousedown=_move_item();   // Agh.. did'nt figure out how this works
</script>

<style type="text/css">
#drag{background:#797979;color:#fff;width:30px;height:15px;position:relative;}
#track{background:red; width:200px;}
</style>

<div id="track"><div id="drag" onmousedown="_move_item(this);" >x</div></div> 
```

我感谢你的帮助。

我在 2012 年 12 月 31 日写了这篇文章。新年快乐。请对彼此好。

谢谢你。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-03-31T13:22:14.217

此代码适用于现代浏览器。只需为此创建一些 polyfill，`addEventListener`这个自定义范围滑块就可以安全使用：

```
function rangeSlider(id, onDrag) {

    var range = document.getElementById(id),
        dragger = range.children[0],
        draggerWidth = 10, // width of your dragger
        down = false,
        rangeWidth, rangeLeft;

    dragger.style.width = draggerWidth + 'px';
    dragger.style.left = -draggerWidth + 'px';
    dragger.style.marginLeft = (draggerWidth / 2) + 'px';

    range.addEventListener("mousedown", function(e) {
        rangeWidth = this.offsetWidth;
        rangeLeft = this.offsetLeft;
        down = true;
        updateDragger(e);
        return false;
    });

    document.addEventListener("mousemove", function(e) {
        updateDragger(e);
    });

    document.addEventListener("mouseup", function() {
        down = false;
    });

    function updateDragger(e) {
        if (down && e.pageX >= rangeLeft && e.pageX <= (rangeLeft + rangeWidth)) {
            dragger.style.left = e.pageX - rangeLeft - draggerWidth + 'px';
            if (typeof onDrag == "function") onDrag(Math.round(((e.pageX - rangeLeft) / rangeWidth) * 100));
        }
    }

} 
```

## 示例用法

```
<style>
.range-slider {
  width:300px;
  height:20px;
  margin:0 auto 1em;
  position:relative;
  cursor:e-resize;
}
.range-slider:before {
  content:"";
  display:block;
  position:absolute;
  top:9px;
  left:0;
  width:100%;
  height:2px;
  background-color:black;
}
.range-slider span {
  display:block;
  height:inherit;
  position:relative;
  z-index:2;
  background-color:red;
  cursor:inherit;
}
</style>

<div class="range-slider" id="range-slider-1">
  <span></span>
</div>

<script>
rangeSlider('range-slider-1', function(value) {
    document.getElementById('test-area').innerHTML = value + '%';
});
</script> 
```

**演示：http:** [//jsbin.com/dulifezi/2/edit](http://jsbin.com/dulifezi/2/edit)

* * *

### 更新

我在这里为这个片段创建一个回购 → [https://github.com/taufik-nurrohman/range-slider](https://github.com/taufik-nurrohman/range-slider)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T21:25:49.477

看看 DragDealer.js： [https ://skidding.github.io/dragdealer/](https://skidding.github.io/dragdealer/)

这里有一个基于滑块值更改图像不透明度的示例。

希望这可以帮助！

# jquery - 为什么这个脚本调用服务器两次？

> ID：14095882
> 
> 赞同：0
> 
> 时间：2012-12-30T23:46:26.207
> 
> 标签：jquery, ajax, google-chrome-extension

我希望这是足够的代码来识别问题 - 我一直在努力解决这个问题。它是来自 Chrome 扩展的弹出部分的 Javascript。

```
$('#save').click(function() {
    var baseURL = 'http://example.com/endpoint?';
    baseURL += 'a=' + encodeURIComponent($('#a').val());
    baseURL += '&b=' + encodeURIComponent($('#b').val());
    baseURL += '&c=' + encodeURIComponent($('#c').val());
    baseURL += '&d=' + encodeURIComponent($('#d').val());
    if ($('input#private').is(':checked')) {
        baseURL += '&private=true';
    }
    $('#form').css('display', 'none');
    $('#loader').fadeIn(500, function() {
        $('#popup-load').load(baseURL, function() {
            window.close();
        });
    });
}); 
```

我已经检查过了，按钮 ( `#save`) 没有被点击两次（添加了`alert`调试代码），可能是服务器端有错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T11:50:36.773

我有一个类似的问题。我通过创建一个全局标志来解决它，并在第一次运行时使其无效。每次调用都会检查这一点。肮脏，但完成了工作。

```
<script type="text/javascript">
    var firstRun = true;

    $('#element').load(function() {
        if (firstRun) {
            firstRun = false;
            // Rest of your code
        }
    }
</script> 
```

# c#-4.0 - 使用 C# 在列表中搜索并编辑其值

> ID：14095886
> 
> 赞同：1
> 
> 时间：2012-12-30T23:46:53.727
> 
> 标签：c#-4.0

如何用 C# 在 List 中搜索并编辑它的值 find 是 5，用 9 改变它的值？

```
List<int> myList = new List<int>() { 8, 5, 6, 2, 3 }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:18:50.950

根据情况，你可以做这样的事情

```
myList = myList.Select(e => e.Equals(5) ? 9 : e).ToList<int>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:53:53.230

出于某种原因，我想不出比这更好的了：

```
List<int> myList = new List<int>{ 8, 5, 6, 2, 3 };
while (myList.IndexOf(5)!=-1)
{
    myList[myList.IndexOf(5)] = 9;
} 
```

您可以将其包装在 Extension 方法中并像这样使用它：

```
myList.Replace(5, 9);

public static class ListExt
{
    public static void Replace<T>(this List<T> list, T old, T @new)
    {
        for (int index = 0; index < list.Count; index++)
        {
            if(Equals(list[index], old))
                list[index] = @new;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T23:56:29.163

您可以只使用一个简单的 for 循环并检查当前元素的值是否等于 5，如果是，则将其设置为 9，如下所示：

```
for(int i=0; i<myList.Count(); i++)
{
    if(myList[i]==5)
    {
         myList[i]=9;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T00:08:05.287

```
Find the "5" element, and change it :
short d = 0;
while ((TheList[d] != 5) && ( d < TheList.Count()))
{
   d++;
}
if (d < TheList.Count())
TheList[d] = 9; 
```

# c++ - 进程 qmake.exe 以代码 2 退出 - 第一次使用 Qt 和 Qt Creator

> ID：14095889
> 
> 赞同：2
> 
> 时间：2012-12-30T23:47:00.043
> 
> 标签：c++, qt, qt-creator, qmake, spaces

下载了 Qt 和 Qt Creator。在 Qt Creator 中，我可以运行示例程序。创建新项目 - Qt 空项目。[添加了来自Qt 站点](http://qt-project.org/doc/qt-4.8/gettingstartedqt.html)的带有代码示例的新 cpp 文件- 第一个。当我按“运行”、“构建”或“重建”时，我得到了这个输出

```
01:41:24: Running steps for project First...
01:41:24: Starting: "C:\Qt\4.8.4\bin\qmake.exe" "C:\Documents and Settings\Олексій\Qt Projects\First\First.pro" -r -spec win32-msvc2008 "CONFIG+=declarative_debug"
Cannot find file: c:\Documents and Settings\Олексій\Qt Projects\First\First.pro.
01:41:24: The process "C:\Qt\4.8.4\bin\qmake.exe" exited with code 2.
Error while building/deploying project First (kit: Desktop)
When executing step 'qmake' 
```

但是有这样的文件，它包含

```
SOURCES +=  Main.cpp 
```

怎么了？我还没有谷歌解决方案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:27:32.623

NP 仇恨 ;)

对于以前版本的 Qt，我在项目路径中遇到了空格问题（请注意，它会将自身安装到“C:\Qt: 而不是“程序文件”）。尝试将项目从“文档和设置”移动到其他位置并将“Qt Projects”重命名为例如“Qt_Projects”。据我所知，文档中提到了避免项目路径中的空格。

我也会小心西里尔字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:41:42.227

可能您必须在 .pro 文件中添加类似 LIBS+=..

# sql - 简单的变量声明

> ID：14095890
> 
> 赞同：1
> 
> 时间：2012-12-30T23:47:14.147
> 
> 标签：sql, oracle, variables, plsql

我不明白为什么该变量声明命令不起作用。你可以帮帮我吗？

```
SET SERVEROUTPUT ON
ACCEPT rek_pers PROMPT 'Employee name: '
ACCEPT year_sal PROMPT 'Yearly salary: '

VARIABLE vENAME VARCHAR2,vSAL NUMBER

DECLARE
:vENAME := &rek_pers;
:vSAL := &year_sal;

BEGIN  
UPDATE Emp SET Emp.Sal = vSAL
Where Emp.Ename = vENAME;

COMMIT;
END;
/ 
```

我收到答案：绑定变量“vENAME”未声明

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:57:22.333

你有几个错误。

变量应该单独定义，而不是逗号。IE：

```
VARIABLE vENAME VARCHAR2
VARIABLE vSAL NUMBER 
```

其次，这是无效的语法：

```
:vENAME := &rek_pers;
:vSAL := &year_sal; 
```

它应该只是简单的（不需要`variable`定义）：

```
DECLARE
vSAL Emp.Sal%type := &year_sal;
vENAME Emp.Ename%type := '&rek_pers';
BEGIN  
UPDATE Emp SET Emp.Sal = vSAL
Where Emp.Ename = vENAME;

COMMIT;
END;
/ 
```

如果您确实想分配一个变量，正确的方法是：

```
VARIABLE vENAME VARCHAR2(200)
VARIABLE vSAL NUMBER
EXEC :vSAL := &year_sal;
EXEC :vENAME := '&rek_pers';
BEGIN  
UPDATE Emp SET Emp.Sal = :vSAL
Where Emp.Ename = :vENAME;
COMMIT;
END;
/ 
```

（ps不要忘记varchar2的长度）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:51:40.810

不要通过声明变量来使用冒号。尝试：

> 宣布
> 
> vENAME := &rek_pers;
> 
> vSAL := &year_sal;

# php - php - array_chunk 根据键值添加文本并输出到文件

> ID：14095899
> 
> 赞同：3
> 
> 时间：2012-12-30T23:48:36.330
> 
> 标签：php, arrays, forms, output

我对 php 比较陌生，需要一些帮助。

当用户可以提交文本时，我有一个 html 表单。此文本由 php 处理，如果有超过 20 个字符的行，则发生换行符。之后，所有文本都“爆炸”了，我得到了一个数组。到目前为止一切都很好。

```
function hexToStr($hex){
    $string='';
    for ($i=0; $i < strlen($hex)-1; $i+=2)
    {
        $string .= chr(hexdec($hex[$i].$hex[$i+1]));
    }
    return $string;}

    $format = $_POST['format'];
    $title= strtoupper($_POST['titre']);
    $txtcontent = $_POST['texte'];
    $txtcontent =  wordwrap($txtcontent,20,hexToStr('0D0A'),true);
    $txtcontent = explode("\n", $txtcontent);

print_r(array_chunk($txtcontent, 9, false));

$filecontent = implode(array_chunk($txtcontent, 9, false)); 

header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment;filename='.$_POST['titre'].'.'.$format.'');
header('Cache-Control: max-age=0');

//$fh = fopen($filename, 'wb');
$fh = fopen('php://output', 'wb');
fwrite($fh, $filecontent);
fclose($fh); 
```

我使用 array_chunk 将数组块中的数组 $txtcontent 与 9 个元素分开。

现在，我需要根据键值在每个新数组元素的开头和结尾添加一些常量文本。也许我需要做一个循环或类似的事情，我已经尝试了很多次但仍然不能。我需要帮助才能做到这一点。

示例：如果我在网络表单中提交此文本：

```
line1
line2
line3
line4
line5
line6
line7
line8
line9
line10
line11
line12 
```

我会有：

```
Array ( [0] => Array ( [0] => line1 [1] => line2 [2] => line3 [3] => line4 [4] => line5 [5] => line6 [6] => line7 [7] => line8 [8] => line9 ) [1] => Array ( [0] => line10 [1] => line11 [2] => line12 ) ) 
```

这是我需要帮助的地方：

处理后（添加常量文本后，根据键值），应该是这样的。但是我不知道我该怎么做。

```
Array ( [0] => Array ( 
[0] => \Text 1,1,"line1"
[1] => \Text 7,1,"line2"
[2] => \Text 13,1,"line3"
[3] => \Text 19,1,"line4"
[4] => \Text 25,1,"line5"
[5] => \Text 31,1,"line6"
[6] => \Text 37,1,"line7"
[7] => \Text 43,1,"line8"
[8] => \Text 49,1,"line9"
) [1] => Array ( 
[0] => \Text 1,1,"line10"
[1] => \Text 7,1,"line11"
[2] => \Text 13,1,"line12"
) ) 
```

最后，当我将它输出到文件时，我将拥有：

（我不知道如何输出array_chunk，我也需要帮助才能做到这一点。）

```
\Text 1,1,"line1"
\Text 7,1,"line2"
\Text 13,1,"line3"
\Text 19,1,"line4"
\Text 25,1,"line5"
\Text 31,1,"line6"
\Text 37,1,"line7"
\Text 43,1,"line8"
\Text 49,1,"line9"
\Text 1,1,"line10"
\Text 7,1,"line11"
\Text 13,1,"line12" 
```

**请注意**，数组中的元素编号可能更大或更小，这只是一个示例。

**另请注意**，具有相同键的数组（例如：第 1 行和第 10 行）将在末尾和开头具有相同的额外文本。

我认为这个问题很难，但我希望有人能帮助我。我已经在一周前试图解决它，但我仍然无法解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:24:37.633

我希望这会有所帮助，但是这个问题需要考虑很多：

您可以在使用 array_chunk 创建的多维数组上执行 foreach 循环，然后添加您要添加​​的文本，如下所示：

```
$chunkedarray = array_chunk($txtcontent, 9, false);
foreach($chunkedarray as $key => $array){
    foreach($array as $k => $v){
        $chunkedarray[$key][$k] = '\text '.($k*6+1).',1,'.$v;
    }
} 
```

[然后，您可以使用我从@alienwebguy 在此 stackoverflow 问题](https://stackoverflow.com/questions/6785355/convert-multidimensional-array-into-single-array#answer-6785366)上找到的函数来展平多维数组：

```
function array_flatten($array) { 
  if (!is_array($array)) { 
    return FALSE; 
  } 
  $result = array(); 
  foreach ($array as $key => $value) { 
    if (is_array($value)) { 
      $result = array_merge($result, array_flatten($value)); 
    } 
    else { 
      $result[$key] = $value; 
    } 
  } 
  return $result; 
} 
$flattenedarray = array_flatten($chunkedarray); 
```

然后，您可以使用另一个 for 循环输出展平的多维数组：

```
foreach($flattenedarray as $v){
  echo $v.'<br>';
} 
```

查看 IDEone.com 上的示例代码：http: [//ideone.com/vzPJOB](http://ideone.com/vzPJOB)

# directx-11 - 总是使用 D3D11_BIND_SHADER_RESOURCE 和 D3D11_BIND_RENDER_TARGET？

> ID：14095907
> 
> 赞同：1
> 
> 时间：2012-12-30T23:49:35.313
> 
> 标签：directx-11, directx-10

总是使用绑定标志 D3D11_BIND_SHADER_RESOURCE 和 D3D11_BIND_RENDER_TARGET 定义标准 directx 缓冲区是否存在性能副作用或任何其他副作用，但更专业的缓冲区（如索引、顶点、常量等）除外。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T00:05:15.007

是的

绑定标志将资源与着色器阶段或如何访问它相关联。该设备将无法针对其使用进行优化。

尝试与另一个标志组合时也可能导致问题，例如：D3D11_BIND_SHADER_RESOURCE 不能与 D3D11_MAP_WRITE_NO_OVERWRITE 一起使用

[http://msdn.microsoft.com/en-us/library/windows/desktop/ff476085(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476085(v=vs.85).aspx)

> 评论
> 
> 通常，绑定标志可以使用逻辑 OR 组合（常量缓冲区标志除外）；> 但是，您应该使用单个标志来允许设备优化资源使用。

# python - Python - 子类开放？

> ID：14095909
> 
> 赞同：2
> 
> 时间：2012-12-30T23:49:40.617
> 
> 标签：python, python-2.7, subclass

是否可以对 python 的内置 open 进行子类化？我间歇性地收到以下错误：

```
class Open(open):
    pass

x = mymodule.Open() 
```

TypeError：调用元类库时出错，无法创建“builtin_function_or_method”实例

这

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T23:52:27.190

`open`不是一个类，它是一个函数。但是，`file`对象是可以子类化的类型。

```
type(open)
# OUT: <type 'builtin_function_or_method'>
type(file)
# OUT: <type 'type'> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T23:50:58.113

`open`是一个函数，而不是一个类。您只能对类进行子类化。

# sql - 更新期间的 SQLite3 BusyException

> ID：14095910
> 
> 赞同：0
> 
> 时间：2012-12-30T23:49:42.977
> 
> 标签：sql, ruby-on-rails, ruby, ruby-on-rails-3, sqlite

我很难更新数据库中的信息。最初，当我尝试保存更改时，它给了我数据库被锁定的错误。

```
SQLite3::BusyException: cannot rollback transaction - SQL statements in progress: rollback transaction 
```

这是有问题的守护进程：

```
require 'daemons'
require File.expand_path(
File.join(File.dirname(__FILE__), '..', 'config', 'environment'))

Daemons.run_proc('clock.rb')do
  daemon_log = ActiveSupport::BufferedLogger.new(
     File.join(Rails.root, "log", "clock.log"))
  Rails.logger = ActiveRecord::Base.logger = daemon_log
  Rails.logger = ActiveRecord::Base.logger.info("running clock.rb")
  Rails.logger = ActiveRecord::Base.logger.info("Information Retrieved")
  UserStats = UgloungeSkills.find(:all)

  loop do

    Rails.logger = ActiveRecord::Base.logger.info("running main loop")
    UserStats.each do |row|
      powerLevel = row['taming'] + row['mining'] + row['woodcutting'] + row['repair'] + row['unarmed'] + row['herbalism'] + row['excavation'] + row['archery'] + row['swords'] + row['axes'] + row['acrobatics'] + row['fishing']
      userName = UgloungeUser.find(row['user_id'])['user']
      McMMO_id = row['user_id']

      if(User.exists?(name: userName))
        #Update it
        singleUser = User.find(McMMO_id)
        Rails.logger = ActiveRecord::Base.logger.info("Just updating information")
        Rails.logger = ActiveRecord::Base.logger.info("User: " + singleUser['name'])
        #Rails.logger = ActiveRecord::Base.logger.info("Values of power_level and McMMO_id: " + powerLevel)
        singleUser.name = "Poopyhead"
        singleUser.save
        #singleUser.update_attributes(power_level: powerLevel, mcmmo_id: McMMO_id)
        Rails.logger = ActiveRecord::Base.logger.info("Finished updating")

      else
        #Create a new user
        Rails.logger = ActiveRecord::Base.logger.info("Creating new user")

        User.create(name: userName, power_level: powerLevel, mcmmo_id: McMMO_id)
      end
    end
    sleep(120)
    Rails.logger = ActiveRecord::Base.logger.info("Sleeping")
  end
end 
```

我只是使用 sqlite 来存储一些信息，另一个数据库是 MySQL 数据库，它只是被读取。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:53:00.877

这听起来像是我最近在一个项目中遇到的问题。SQLite 在开发和 beta 测试中表现出色，但在生产环境的压力下，整个事情都崩溃了。我正在将项目转换为不同的架构（Resque），到目前为止性能更好，我计划下周部署新架构。至少，您应该转换为 MySQL 以避免这些错误。

# regex - 如何在使用前从变量中删除字符？

> ID：14095913
> 
> 赞同：-2
> 
> 时间：2012-12-30T23:50:04.977
> 
> 标签：regex, perl

`$a[1]`总是以 a 开头，`(`总是`$a[5]`以 a 结尾`)`。

有没有办法在不添加更多行的情况下摆脱那些？

```
while (my $line = <F>) {

    if ($line =~ m/test /) {
    my @a = split / /, $line;
        printf("%s %2s %4s %4s %.5s\n",$a[0], $a[1], $a[2], $a[5], $a[13]);
    } else {
        print $line;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T23:59:49.493

你可以使用[`substr`](http://perldoc.perl.org/functions/substr.html)

```
printf("%s %2s %4s %4s %.5s\n", $a[0], substr($a[1], 1), $a[2], substr($a[5], 0, -1), $a[13]); 
```

# google-app-engine - 从 Google 电子表格中获取 FontStyle 信息到 appengine

> ID：14095919
> 
> 赞同：1
> 
> 时间：2012-12-30T23:50:49.307
> 
> 标签：google-app-engine, google-sheets, google-spreadsheet-api

Google 电子表格包含 FontStyle 信息，例如粗体、红色等。我想从电子表格中读取 FontStyle。

GAS 是从谷歌电子表格中读取 FontStyle 信息的唯一方法吗？还有其他选择吗？

我正在使用带有 OAuth 的 appengine 和 Gdata/Spreadsheet API。这是从谷歌电子表格中读取单元格数据。

Gdata & Google Spreadsheets API 3.0：据我所知，我搜索了 Gdata & Google Spreadsheets API，这些只读取单元格数据。[这里](http://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=1263)有一个 GData 功能请求来读取 FontStyle 信息：

避免使用 Google Apps 脚本：我想避免使用 Google Apps 脚本。我知道 GAS 可以读取 FontStyle 信息。但是 GAS 对于非程序员来说设置起来很复杂/可怕，所以我想避免 GAS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T14:06:15.443

我认为解决此问题的最简单方法是改用[Google Drive API](https://developers.google.com/drive/)并[下载 HTML 格式的电子表格](https://developers.google.com/drive/manage-downloads#downloading_google_documents)。然后您可以解析 HTML 以确定单元格的字体和颜色。

# jquery - jquery代码：如果已经选择了多选中的单击选项

> ID：14095935
> 
> 赞同：-4
> 
> 时间：2012-12-30T23:53:22.060
> 
> 标签：jquery, multi-select

我正在寻找与此条件匹配的 jQuery 代码片段：

*如果我刚刚单击的多选选项已被选中，则...*

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:59:39.807

鉴于此 HTML：

```
​&lt;select multiple="multiple">
    <option>A</option>
    <option>B</option>
    <option>C</option>
    <option>D</option>
</select> 
```

你可以使用这个脚本：

```
​$("option").on("mousedown", function(){
    if($(this).prop("selected"))
        alert($(this).val() + " is already selected");
});​​​ 
```

​</p>

# c# - GraphicsPath 是否应该在使用后被处理掉

> ID：14095939
> 
> 赞同：2
> 
> 时间：2012-12-30T23:54:21.373
> 
> 标签：c#, winforms, memory, graphicspath

我正在制作一些实用程序类，它们可以将不同类型的符号放置在 CAD 图纸的立面上。我想确保如果我需要处理我这样做的 GraphicsPath 对象。

在 getCircle 函数内部的以下代码中，它显示我正在将 myPath“GraphicsPath”对象传递给 AddStringToPath 函数。

我不能为此使用 using(){} 范围，因为我将 myPath 图形对象作为引用传递。

这种设计可以使用还是我需要采用不同的方式来确保垃圾收集？

```
 GraphicsPath getCircle(Graphics dc, string text = "")
        {
            GraphicsPath myPath = new GraphicsPath();
            myPath.AddEllipse(symbolCircle);

            AddStringToPath(dc, ref myPath, text);

            return myPath;
        }
        void AddStringToPath(Graphics dc, ref GraphicsPath path, string text)
        {
            SizeF textSize = dc.MeasureString(text, elevFont);

            var centerX = (path.GetBounds().Width / 2) - (textSize.Width / 2);
            var centerY = (path.GetBounds().Height / 2) - (textSize.Height / 2);

            // Add the string to the path.
            path.AddString(text,
                elevFont.FontFamily,
                (int)elevFont.Style,
                elevFont.Size,
                new PointF(centerX + 2, centerY + 2),
                StringFormat.GenericDefault);
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:58:27.463

您不需要像`ref`这里那样通过路径。`ref`仅当您想更改`path`调用函数中的指向时才有用。摆脱`ref`并`using`像往常一样添加。

并阅读值类型和引用类型以及`ref`实际有用的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T00:11:11.497

创建路径的函数应稍后在 using 语句中使用

```
 using(var path = getCircle(dc, "Text"))
 {
      // do something with path
 } 
```

如果您调用该函数`CreateCircle`而不是`getCircle`

# jquery - 设置链接后jquery动画不起作用

> ID：14095941
> 
> 赞同：0
> 
> 时间：2012-12-30T23:54:29.377
> 
> 标签：jquery, animation, hyperlink

我在图像上的 JQUERY 上有一个悬停动画。另一个图像滑上来。当图像未链接到 url 时，它可以完美运行。当我在底部图像中添加标签时它可以，但是当我添加到图像移动时，动画不起作用。

这是我的jQuery代码：

```
<script type="text/javascript">
$(function() {
    $('.wrap').hover(function() {
        $(this).children('.front').stop().animate({ "top" : '-100px'}, 700);   
    }, function() {
        $(this).children('.front').stop().animate({ "top" : '0px'}, 400);       
    });
}); 
```

这是我的css和html代码

```
<style type="text/css">

#container {
height:100px;
text-align: center;
margin: auto;
}

.wrap {
width: 100px;
height: 100px;
position: relative;
overflow: hidden;
float: left;
padding: 0 1em;
}

img {
position: relative;
top: 0px; left: 0px;
}
img.front {
position: relative;
top: 100px; 
}
body
{ 
background-image:url('bgimage.png');
background-repeat:no-repeat;
background-attachment:fixed;
background-position:right bottom; 
}
</style>
</head>

   <body>
 <div id="container">
<div class="wrap">
   <a href="ascolta.php"> <img src="radio.png" alt="image" /></a>
      **<a href="ascolta.php">** <img src="radio_h.png" class="front" alt="image" /></a>
 </div>
   <div class="wrap">
    <img src="chat.png" alt="image" />
    <img src="chat_h.png" class="front" alt="image" />
 </div>
   <div class="wrap">
    <img src="programms.png" alt="image" />
    <img src="programms_h.png" class="front" alt="image" />
 </div>
    <div class="wrap">
    <img src="gallery.png" alt="image" />
    <img src="gallery_h.png" class="front" alt="image" />
 </div>
</div> 
```

在我添加星号标记的代码中，相关动画停止工作。

非常感谢你。最好的，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:58:08.230

您正在使用`.children`它仅在 DOM 中向下移动单层。改为使用`.find`。

改变这个：

```
$(this).children('.front').stop().animate({ "top" : '-100px'}, 700);
$(this).children('.front').stop().animate({ "top" : '0px'}, 400); 
```

到

```
$(this).find('.front').stop().animate({ "top" : '-100px'}, 700);
$(this).find('.front').stop().animate({ "top" : '0px'}, 400); 
```

# c# - 如何生成所需大小（例如 8096）长位哈希码 - c#

> ID：14095943
> 
> 赞同：-2
> 
> 时间：2012-12-30T23:54:48.100
> 
> 标签：c#, hash, bit, string-hashing

有很多散列方法，但我想用 8096 位长组成位散列。有可能实现这一目标吗？

例如，当我输入“House”时，我应该得到如下字符串：

```
"0101010001010101..." (8096 bits) 
```

我怎样才能做到这一点（使用 C# 4.0 可以）？

如果你想知道我为什么需要这样的东西，我需要它来比较签名文件和向量空间模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:04:04.007

对于快速非加密哈希，您可以检查[FNV 系列](https://datatracker.ietf.org/doc/html/draft-eastlake-fnv-04)。通过仔细和适当的变化，您应该能够构建一个相当快的 8096 位散列。

如果速度不是主要考虑因素，而是简单性和质量，那么您可以简单地使用 MD5 的变体来制作非加密哈希。

哈希(x) = MD5(0 || x) || MD5(1 || x) ... MD5(62 || x) || MD5(63 || x)<32>，其中“||” 是连接操作，仅使用最终散列的低 32 位，将为您提供 8096 位散列。

编辑

这是显示 MD5 概念的小代码示例：

```
using System;
using System.Security.Cryptography;
using System.Text;

namespace Hash8096
{
    class MainClass
    {
        public static byte [] H8096(byte [] x) {
            byte [] Result = new byte[8096 / 8];
            byte [] Xplus1 = new byte[x.Length + 1];
            x.CopyTo(Xplus1, 1);
            int ResultOffset = 0;
            int AmountLeft = Result.Length;
            for (int i=0; i<64; i++) {
                // do MD5(i || x)
                var md5 = MD5.Create();
                Xplus1[0] = (byte) i;
                var hash = md5.ComputeHash(Xplus1);
                int NumToCopy = Math.Min(hash.Length, AmountLeft);
                Array.Copy(hash, 0, Result, ResultOffset,NumToCopy);
                ResultOffset += NumToCopy;
                AmountLeft -= NumToCopy;
            }
            return Result;
        }

        public static void Main (string[] args)
        {
            byte [] x = Encoding.UTF8.GetBytes("Hello World!");
            byte [] MonsterHash = H8096(x);
            Console.WriteLine ("Monster hash in hex follows:");
            Console.WriteLine(BitConverter.ToString(MonsterHash));
        }
    }
} 
```

# java - 在android上解析xml文件时文件过早结束

> ID：14095946
> 
> 赞同：2
> 
> 时间：2012-12-30T23:55:18.160
> 
> 标签：java, android, xml, xml-parsing, xom

[我正在尝试从使用XOM](http://www.xom.nu/)作为 XML 库的 android 应用程序中读取 xml 文件。我正在尝试这个：

```
Builder parser = new Builder();
Document doc = parser.build(context.openFileInput(XML_FILE_LOCATION)); 
```

但是我`nu.xom.ParsingException: Premature end of file.`什至在文件为空的情况下。

我需要解析一个非常简单的`XML`文件，并且我已经准备好使用另一个库而不是 XOM，所以如果有更好的库，请告诉我。或者只是使用 XOM 解决问题。

如果有帮助，我正在使用[xerces](http://xerces.apache.org/)来获取解析器。

- - - 编辑 - - -

PS：这样做的目的不是解析空文件，该文件恰好在第一次运行时为空，显示此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:51:26.940

如果您将[这篇](http://marc.info/?l=xom-interest&m=122486269712461&w=2)文章读到最后，这似乎与`xerces`它是一个空文件这一事实有关，并且他们没有达成解决方案`xerces`。

所以我处理的问题如下：

```
Document doc = null;
try {
    Builder parser = new Builder();
    doc = parser.build(context.openFileInput(XML_FILE_LOCATION));
}catch (ParsingException ex) { //other catch blocks are required for other exceptions.
   //fails to open the file with a parsing error.
   //I create a new root element and a new document.
   //I fill them with xml data (else where in the code) and save them.
    Element root = new Element("root");
    doc = new Document(root);       
} 
```

然后我可以做任何我想做的事`doc`。并且您可以添加额外的检查以确保原因确实是一个空文件（例如检查文件大小，如 sam 对该问题的评论之一所示）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T09:46:04.770

空文件不是格式良好的 XML 文档。抛出 ParsingException 是正确的做法。

# php - 在变量中执行 if 语句

> ID：14095949
> 
> 赞同：-5
> 
> 时间：2012-12-30T23:55:58.227
> 
> 标签：php, wordpress, if-statement

我想要一个包含 if 语句的变量，在 WordPress 中执行此操作，但似乎无法使其正常工作。

这是我的代码：

```
<?php $priceperpost= {
   if ( $linecount > 15) 
{ 
   echo "109";
}
elseif ($linecount > 30) {
   echo "89";
}
elseif ($linecount > 100) {
   echo "Please Call";
}
else {
   echo "129";
}  
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T23:59:44.303

这是一个如何执行单行 if 语句的示例；你必须嵌套它们以获得你想要的效果。基本上在这段代码中，如果 x 等于 1，则 $value 被赋值为 2。否则它得到值 3。

```
$x = 1;
$value = ($x == 1 ? 2 : 3);
echo $value; 
```

输出：2

它相当于：

```
$x = 1;
if ($x == 1) {
    $value = 2;
} else {
    $value = 3;
}
echo $value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:06:13.537

假设您正在尝试分配该值而不是直接输出到屏幕上：

```
<?php
  $priceperpost = "129"; // default
  if ($linecount > 100) {
    $priceperpost = "Please call"; // highest price break value first
  } elseif ($linecount > 30) {
    $priceperpost = "89";
  } elseif ($linecount > 15) {
    $priceperpost = "109"; // lowest price break value last
  }
 ?> 
```

或者更紧凑和更灵活的东西 - 您可以将值存储在文件或数据库中并从该数据生成数组，而不必为新的价格突破值编写新的 elseif：

```
<?php
  $priceArray = array( // insert price break values in descending order
    100 => "Please call",
    30 => "89",
    15 => "109",
    0 => "129",
  );

  foreach ($priceArray as $breakValue => $price) {
    if ($linecount > $breakValue) {
      $priceperpost = $price;
      break; // found the price break, so we can exit the loop here
    }
  }
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T00:07:01.783

我会这样做，因为如前所述，在您提供的示例中，只有您的第一个`if`或您`else`将被击中：

```
switch (true) {
    case $linecount > 100:
        $priceperpost = "Please Call";
        break;

    case $linecount > 30:
        $priceperpost = 89;
        break;

    case $linecount > 15:
        $priceperpost = 109;
        break;  

    default:
        $priceperpost = 129;
        break;
} 
```

一般来说，当`elseif`s 越来越多时，它往往会变得有点难以阅读。在这些情况下，我通常更喜欢`switch`声明的可读性（但对此的看法似乎有所不同）。

演示：[http ://codepad.viper-7.com/UnztIT](http://codepad.viper-7.com/UnztIT)

# objective-c - 顶级 JSON 对象属性 Objective-c

> ID：14095952
> 
> 赞同：-1
> 
> 时间：2012-12-30T23:56:13.517
> 
> 标签：objective-c, ios, json

如何在 Objective-c 中访问高级 JSON 对象？这是 JSON

```
{
  user: "user",
  id: 39,
  image: "img.png",
  caption: "",
  lat: "37",
  lng: "-122",
  created_at: 1356910240
} 
```

...我需要做这样的事情 [JSON valueFor???:????]

我可以添加对象“标识符”并像 [JSON valueForKeyPath:@"identifier"] 一样访问它，但想知道是否还有其他方法？

```
identifier: {
  user: "user",
  id: 39,
  image: "img.png",
  caption: "",
  lat: "37",
  lng: "-122",
  created_at: 1356910240
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:47:33.023

通常，JSON 解析器将返回一个字典/散列/关联数组，无论所使用的语言用于键/值对。

在 ObjectiveC 中，这将是`NSDictionary`. 所以你的解析器应该这样做：

```
NSDictionary *data = [SomeJSONParser decodeJson:jsonString]; 
```

现在`"user"`要从中得到，我们会这样做：

```
[data objectForKey:@"user"]; 
```

但是你想要根节点？好吧，你*已经拥有了。*根节点是您的解析器吐出的字典。没有什么神奇的方法可以调用，根节点只是解析器的结果。

如果您的“自定义解析器”工作方式不同，我建议您更改它。让它做你想做的事完全取决于你的解析器的 API 和它返回的对象类型，这两件事你在你的问题中留下的东西都非常模糊。

# mysql - 这个 SELECT 语句有什么问题？

> ID：14095956
> 
> 赞同：0
> 
> 时间：2012-12-30T23:56:56.827
> 
> 标签：mysql, sql, join, foreign-keys, create-table

我收到此错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 '' JOIN `shirts_link` ON `shirts_link`.`shirt_id`=`shirts`.`id` JOIN `shirt_sizes' 在第 1 行附近使用正确的语法

我已经梳理了将近半个小时，无法弄清楚。有人可以向我指出吗？这是代码。

```
SELECT
`shirts`.`shirt_name`,
`shirts`.`men` AS `main_photo`,
GROUP_CONCAT ( `shirt_sizes`.`size_name` ) AS `sizes`
FROM
`shirts`
JOIN
`shirts_link` ON `shirts_link`.`shirt_id`=`shirts`.`id`
JOIN
`shirt_sizes` ON `shirt_sizes`.`id`=`shirts_link`.`size_id`
JOIN
`shirt_prices` ON `shirt_prices`.`id`=`shirts_link`.`price_id`
WHERE `men`!=''
GROUP BY
`shirt_prices`.`price_cat` 
```

如果问题比这个脚本更深，这里是我试图结合在一起的其他表。

衬衫桌

```
CREATE TABLE shirts (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY NOT NULL,
    shirt_name VARCHAR(20) NOT NULL,
    men VARCHAR(10) NULL,
    women VARCHAR(10) NULL,
    boys VARCHAR(10) NULL,
    girls VARCHAR(10) NULL,
    babies VARCHAR(10) NULL,
)ENGINE=INNODB;

INSERT INTO shirts(shirt_name,men,women,boys,girls,babies) VALUES
    ('Crewneck Tee','me_crn','wo_crn','bo_crn','gi_crn','ba_crn'),
    ('V-Neck Tee','me_vnc','wo_vnc','','',''),
    ('Scoop Neck Tee','','wo_sco','','',''),
    ('Raglan Tee','me_rag','wo_rag','bo_rag','gi_rag',''),
    ('Ringer Tee','me_rin','wo_rin','bo_rin','gi_rin',''),
    ('Cap Sleeve Tee','','wo_cap','','gi_cap',''),
    ('Tank Top','me_tan','wo_tan','bo_tan','gi_tan',''),
    ('Spaghetti Strap','','wo_spa','','',''),
    ('Hoodie','me_hod','wo_hod','bo_hod','gi_hod','ba_hod'),
    ('Onsie','','','','','ba_ons'); 
```

尺码表

```
CREATE TABLE shirt_sizes (
    id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
    size_name VARCHAR(10) NOT NULL
)ENGINE=INNODB;

INSERT INTO shirt_sizes(size_name) VALUES
    ('new born'),
    ('6 months'),
    ('12 months'),
    ('18 months'),
    ('2T'),
    ('3T'),
    ('4T'),
    ('5T'),
    ('x-small'),
    ('small'),
    ('medium'),
    ('large'),
    ('1x-large'),
    ('2x-large'),
    ('3x-large'),
    ('4x-large'),
    ('5x-large'); 
```

价格表

```
CREATE TABLE shirt_prices (
    id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
    price_cat VARCHAR(10) NOT NULL,
    price NUMERIC(6,2) NOT NULL
    )ENGINE=INNODB;

INSERT INTO shirt_prices(price_cat,price) VALUES
    ('crn_01','25.40'),('crn_02','26.30'),('crn_03','27.20'),('crn_04','28.10'),   
        ('crn_05','29.11'),

        ('vnc_01','26.21'),('vnc_02','27.11'),('vnc_03','28.01'),('vnc_04','29.02'),  
        ('vnc_05','30.80'),

        ('sco_01','28.10'),

        ('rag_01','29.22'),('rag_02','30.44'),('rag_03','31.70'),('rin_01','29.22'),
        ('rin_02','30.44'),('rin_03','31.70'),

        ('cap_01','29.04'),('cap_02','30.26'),

        ('tan_01','25.31'),('tan_02','26.21'),

        ('spa_01','26.30'),('spa_02','27.11'),

        ('hod_01','35.21'),('hod_02','36.11'),('hod_03','37.10'),('hod_04','38.11'); 
```

衬衫链接表

```
CREATE TABLE shirts_link (
        adult VARCHAR(1) NOT NULL,
        kids VARCHAR(1) NOT NULL,
        babies VARCHAR(1) NOT NULL,
        shirt_id INT UNSIGNED NOT NULL,
        size_id INT UNSIGNED NOT NULL,
        price_id INT UNSIGNED NOT NULL,
        PRIMARY KEY (shirt_id,size_id,price_id),
        FOREIGN KEY (`shirt_id`) REFERENCES `shirts`(`id`),
        FOREIGN KEY (`size_id`) REFERENCES shirt_sizes(`id`),
        FOREIGN KEY (`price_id`) REFERENCES shirt_prices(`id`)
    )ENGINE=INNODB;

    INSERT INTO shirts_link (adult, kids, babies, shirt_id, size_id, price_id) VALUES
    ('n','n','y','1','1','1'),('n','n','y','1','2','1'),('n','n','y','1','3','1'),('n','n','y','1','4','1'),
    ('n','n','y','1','5','1'),('n','n','y','1','6','1'),('n','n','y','1','7','1'),('n','n','y','1','8','1'),
    ('n','y','n','1','9','1'),('y','y','n','1','10','1'),('y','y','n','1','11','1'),('y','y','n','1','12','1'),
    ('y','y','n','1','13','1'),('y','n','n','1','14','2'),('y','n','n','1','15','3'),('y','n','n','1','16','4'),
    ('y','n','n','1','17','5'),

    ('y','n','n','2','10','6'),('y','n','n','2','11','6'),('y','n','n','2','12','6'),('y','n','n','2','13','6'),
    ('y','n','n','2','14','7'),('y','n','n','2','15','8'),('y','n','n','2','16','9'),('y','n','n','2','17','10'),

    ('y','n','n','3','10','11'),('y','n','n','3','11','11'),('y','n','n','3','12','11'),('y','n','n','3','13','11'),
    ('y','n','n','3','14','11'),

    ('y','y','n','4','10','12'),('y','y','n','4','11','12'),('y','y','n','4','12','12'),('y','y','n','4','13','12'),
    ('y','n','n','4','14','13'),('y','n','n','4','15','14'),

    ('y','y','n','5','10','15'),('y','y','n','5','11','15'),('y','y','n','5','12','15'),('y','y','n','5','13','15'),
    ('y','n','n','5','14','16'),('y','n','y','5','15','17'),

    ('y','y','n','6','10','18'),('y','y','n','6','11','18'),('y','y','n','6','12','18'),('y','y','n','6','13','18'),
    ('y','n','n','6','14','19'),

    ('y','y','n','7','10','20'),('y','y','n','7','11','20'),('y','y','n','7','12','20'),('y','y','n','7','13','20'),
    ('y','n','n','7','14','21'),

    ('y','n','n','8','10','22'),('y','n','n','8','11','22'),('y','n','n','8','12','22'),('y','n','n','8','13','22'),
    ('y','n','n','8','14','23'),

    ('n','n','y','9','5','24'),('n','n','y','9','6','24'),('n','n','y','9','7','24'),('n','n','y','9','8','24'),
    ('n','n','y','9','9','24'),('y','y','n','9','10','24'),('y','y','n','9','11','24'),('y','y','n','9','12','24'),
    ('y','y','n','9','13','24'),('y','y','n','9','14','25'),('y','n','n','9','15','26'),('y','n','n','9','16','27'),
    ('y','n','n','9','16','25'),

    ('n','n','y','10','1','1'),('n','n','y','10','2','1'),('n','n','y','10','3','1'),('n','n','y','10','4','1'); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T23:59:01.817

Where 子句属于整个 from 子句之后，意思是在所有连接之后。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T00:01:30.390

你把这个`WHERE`子句放在错误的地方：

```
WHERE `men`!='' 
```

`GROUP BY`将它移到您的子句前面。

**更新：** 这是您的查询的重新格式化版本：

```
SELECT   `shirts`.`shirt_name`
       , `shirts`.`men` AS `main_photo`
       , GROUP_CONCAT ( `shirt_sizes`.`size_name` ) AS `sizes`
FROM   `shirts`
JOIN   `shirts_link` 
ON     `shirts_link`.`shirt_id`=`shirts`.`id`
JOIN   `shirt_sizes` 
ON     `shirt_sizes`.`id`=`shirts_link`.`size_id`
JOIN   `shirt_prices`
ON     `shirt_prices`.`id`=`shirts_link`.`price_id'

WHERE  `men` != ''

GROUP BY `shirt_prices`.`price_cat` 
```

# c++ - 是否可以询问 OpenAL 设备它喜欢什么频率和格式？

> ID：14095962
> 
> 赞同：1
> 
> 时间：2012-12-30T23:57:59.790
> 
> 标签：c++, c, audio, openal

来自[OpenAL 程序员指南](http://connect.creativelabs.com/openal/Documentation/OpenAL_Programmers_Guide.pdf)：

```
void alBufferData(
    ALuint buffer,
    ALenum format,
    const ALvoid *data,
    ALsizei size,
    ALsizei freq 
```

);

是否可以在不需要重新采样缓冲区的情况下询问 OpenAL 设备它更喜欢使用什么频率和格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T07:08:51.870

Afaik 你只能得到频率，而不是格式。当您使用`alcCreateContext`指定混合缓冲区的属性创建函数时。如果您通过那里，`NULL`那么您可以稍后使用以下方法查询这些属性`alcGetIntegerv`：

1.  `ALC_ATTRIBUTES_SIZE`使用枚举的第一个查询属性计数
2.  `ALC_ALL_ATTRIBUTES`然后使用枚举分配足够大的缓冲区和查询属性
3.  缓冲区将包含成对的属性名称及其值：[attrib1, value1, attrib2, value2, ...]
4.  频率枚举名称是`ALC_FREQUENCY`- 遍历数组并搜索此枚举。

至于格式 - 对立体声或单声道声音使用带符号的缩写。这应该可以在所有平台上提供足够好的性能（即使是那些使用浮点数进行混合的平台，将 short 转换为 short 到 float 也是快速操作）。

# hibernate - Hibernate：在 TABLE_PER_CLASS 继承模式下获取多态属性

> ID：14095964
> 
> 赞同：2
> 
> 时间：2012-12-30T23:58:04.847
> 
> 标签：hibernate, jpa, jpql

如 Hibernate 文档中所述，`TABLE_PER_CLASS`在获取多态关系时表现非常糟糕

> ### [2.2.4.1。每班表](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/#d0e1191)
> 
> 这种策略有很多缺点（尤其是多态查询和关联），在 JPA 规范、Hibernate 参考文档、Hibernate in Action 和许多其他地方都有解释。Hibernate 解决了大多数使用 SQL UNION 查询实现此策略的问题。它通常用于继承层次结构的顶层：
> 
> ```
> @Entity
> @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
> public class Flight implements Serializable { ... } 
> ```
> 
> 此策略支持一对多关联**，前提是它们是双向的**。此策略不支持 IDENTITY 生成器策略：id 必须在多个表之间共享。因此，在使用此策略时，您不应使用 AUTO 或 IDENTITY。

但在这种情况下，我对继承策略没有其他选择，所以我正在寻找改进查询的方法。Comment 是我的具体类，它与抽象 Commentable 类具有 M:1 关系。

我希望*在 Comment*中存储一个鉴别器列，可以区分它所指的 Commentable 的具体类型，并在我的查询中使用 CASE：

```
@NamedQuery(name = "Comments.withItemTitle",
            query = "select c.commentBody, " +
                    "case " +
                    "when n.targetType = 'video' THEN (select v.title from Video v where v.id = c.target.id) " +
                    "when n.targetType = 'message' THEN (select m.title from Message m where m.id = n.target.id) " +
                    "when n.targetType = 'blog' THEN (select b.title from Blog b where b.id = n.target.id) " +
                    "end " +
                    "from Comment c") 
```

但是hibernate抛出一个关于嵌套选择的错误，说它不能确定它的类型。[这在 postgre 中似乎是合法的](http://shoaibmir.wordpress.com/2009/03/10/using-case-with-select/)——如果 Hibernate 以这种方式支持嵌套的 SELECT 表达式，它不会解决问题吗？

我的下一个想法是对`commentable.title`每条评论进行反规范化并存储相关信息，但出于显而易见的原因，我犹豫不决。出于这个问题的目的，我无法更改 Commentable 的继承结构。

有没有其他方法可以在不强制休眠到 UNION 每个表的情况下执行此查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T01:00:04.527

我认为问题在于 JPQL 没有 case 语句。您需要更改代码以使用 a`@NamedNativeQuery`并用 SQL 而不是 JPQL 重写您的查询。

# objective-c - 如何正确使用 makeObjectsPerformSelector：获取错误无法识别的选择器

> ID：14095966
> 
> 赞同：1
> 
> 时间：2012-12-30T23:58:24.127
> 
> 标签：objective-c, arrays, selector

让我先说我是 Objective C 的新手。

我收到错误 `atusMenuApp[24288:303] -[__NSCFConstantString createListItem]: unrecognized selector sent to instance 0x100002450`

这是我的代码：

```
selector = [NSMutableArray arrayWithObjects: @"nvda", @"aapl", @"goog", nil];
[selector makeObjectsPerformSelector:@selector(createListItem:) withObject:self];

- (void)createListItem:(NSString *)title {
//do some stuff
} 
```

现在我已经做了很多环顾四周，似乎这个问题的最大原因是增加或缺乏，`:`但我相信我正确地拥有它。也许我不太了解它的用法，`makeObjectsPerformSelector`因为在查阅了上面的文档后我发现：

`Sends to each object in the array the message identified by a given selector, starting with the first object and continuing through the array to the last object.`

任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:05:34.353

[仅当您~~阅读文档~~（或思考一下为什么以这种方式而不是那种方式命名方法的原因），或者甚至努力尝试理解错误消息时...]

的`makeObjectsPerformSelector:withObject:`方法按照`NSArray`它的建议做：它使***数组的对象***执行选择器，它可以有一个可选的参数。所以

```
[selector makeObjectsPerformSelector:@selector(createListItem:) withObject:self]; 
```

将`createListItem:`消息发送到数组中的***每个`NSString`对象***并作为其参数`selector`传入。***它不会在******传递对象时执行选择器。***即，你所拥有的相当于`self`***`self`***

```
for (NSString *obj in selector) {
    [obj createListItem:self];
} 
```

显然，您需要以下内容，而不是这个：

```
for (NSString *obj in selector) {
    [self createListItem:obj];
} 
```

你甚至不需要那种讨厌的方法。一个不错的快速枚举`for`循环会做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T00:05:25.950

首先，您制作一个 s 数组`NSString`。然后，您向他们发送所有消息`createListItem`。这一切都很好，花花公子，但`NSString`没有任何方法被调用`createListItem`；仅仅因为您定义了一个名为的实例方法`createListItem`并不意味着每个类的每个实例都可以使用它。只有实现文件中有定义的类才能处理消息。例如，我不能列出`Car`实例，然后`fly`在另一个名为`Helicopter`' 实现的类中定义方法，并期望能够调用`fly`; 的实例`Car`。只能`Helicopter`使用它。我建议你阅读一本关于 Objective-C 的好书，并进一步熟悉类、实例和实例方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T00:05:52.873

你误解了方法。

它将在每个对象上调用`createListItem:`带有参数的方法。`self``NSArray`

因此，结果调用将类似于：

```
[@"nvda" createListItem:self];
... 
```

显然，a 不存在该方法，`NSString`并且您的异常出现了。

如果您需要对`self`数组中的每个对象应用一个方法，只需循环遍历它。

# python - 如何调整 NLTK 句子标记器

> ID：14095971
> 
> 赞同：40
> 
> 时间：2012-12-30T23:59:00.560
> 
> 标签：python, nlp, nltk

我正在使用 NLTK 分析一些经典文本，并且遇到了逐句标记文本的麻烦。例如，这是我从*[Moby Dick](http://www.gutenberg.org/cache/epub/2701/pg2701.txt)*获得的片段：

```
import nltk
sent_tokenize = nltk.data.load('tokenizers/punkt/english.pickle')

'''
(Chapter 16)
A clam for supper? a cold clam; is THAT what you mean, Mrs. Hussey?" says I, "but
that's a rather cold and clammy reception in the winter time, ain't it, Mrs. Hussey?"
'''
sample = 'A clam for supper? a cold clam; is THAT what you mean, Mrs. Hussey?" says I, "but that\'s a rather cold and clammy reception in the winter time, ain\'t it, Mrs. Hussey?"'

print "\n-----\n".join(sent_tokenize.tokenize(sample))
'''
OUTPUT
"A clam for supper?
-----
a cold clam; is THAT what you mean, Mrs.
-----
Hussey?
-----
" says I, "but that\'s a rather cold and clammy reception in the winter time, ain\'t it, Mrs.
-----
Hussey?
-----
"
''' 
```

考虑到 Melville 的语法有点过时，我不希望这里完美，但 NLTK 应该能够处理终端双引号和像“Mrs.”这样的标题。但是，由于标记器是无监督训练算法的结果，我不知道如何修补它。

有人对更好的句子标记器有建议吗？我更喜欢我可以破解的简单启发式算法，而不必训练自己的解析器。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-12-31T15:08:35.377

您需要向标记器提供缩写列表，如下所示：

```
from nltk.tokenize.punkt import PunktSentenceTokenizer, PunktParameters
punkt_param = PunktParameters()
punkt_param.abbrev_types = set(['dr', 'vs', 'mr', 'mrs', 'prof', 'inc'])
sentence_splitter = PunktSentenceTokenizer(punkt_param)
text = "is THAT what you mean, Mrs. Hussey?"
sentences = sentence_splitter.tokenize(text) 
```

现在的句子是：

```
['is THAT what you mean, Mrs. Hussey?'] 
```

**更新：如果句子的最后一个单词附有撇号或引号（如Hussey?'**），这不起作用。因此，解决此问题的一种快速而简单的方法是将空格放在撇号和句子结尾符号 (.!?) 后面的引号之前：

```
text = text.replace('?"', '? "').replace('!"', '! "').replace('."', '. "') 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2014-08-19T04:52:51.587

您可以修改 NLTK 的预训练英语句子标记器，通过将它们添加到集合中来识别更多缩写词`_params.abbrev_types`。例如：

```
extra_abbreviations = ['dr', 'vs', 'mr', 'mrs', 'prof', 'inc', 'i.e']
sentence_tokenizer = nltk.data.load('tokenizers/punkt/english.pickle')
sentence_tokenizer._params.abbrev_types.update(extra_abbreviations) 
```

请注意，必须指定缩略语而不包括最后句点，但要包括任何内部句点，如上`'i.e'`所示。有关其他分词器参数的详细信息，请参阅[相关文档。](http://www.nltk.org/api/nltk.tokenize.html#nltk.tokenize.punkt.PunktParameters)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-31T12:55:50.057

您可以通过将参数设置为来告诉该`PunktSentenceTokenizer.tokenize`方法在句子的其余部分中包含“终端”双引号。有关示例，请参见下面的代码。`realign_boundaries``True`

我不知道一个干净的方法来防止文本`Mrs. Hussey`被分成两个句子。但是，这是一个 hack

*   破坏所有出现的`Mrs. Hussey`to `Mrs._Hussey`，
*   然后将文本拆分成句子`sent_tokenize.tokenize`，
*   然后对于每个句子，解开`Mrs._Hussey`回到`Mrs. Hussey`

我希望我知道一个更好的方法，但这可能会在紧要关头起作用。

* * *

```
import nltk
import re
import functools

mangle = functools.partial(re.sub, r'([MD]rs?[.]) ([A-Z])', r'\1_\2')
unmangle = functools.partial(re.sub, r'([MD]rs?[.])_([A-Z])', r'\1 \2')

sent_tokenize = nltk.data.load('tokenizers/punkt/english.pickle')

sample = '''"A clam for supper? a cold clam; is THAT what you mean, Mrs. Hussey?" says I, "but that\'s a rather cold and clammy reception in the winter time, ain\'t it, Mrs. Hussey?"'''    

sample = mangle(sample)
sentences = [unmangle(sent) for sent in sent_tokenize.tokenize(
    sample, realign_boundaries = True)]    

print u"\n-----\n".join(sentences) 
```

产量

```
"A clam for supper?
-----
a cold clam; is THAT what you mean, Mrs. Hussey?"
-----
says I, "but that's a rather cold and clammy reception in the winter time, ain't it, Mrs. Hussey?" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-04T23:10:36.860

所以我遇到了类似的问题，并在上​​面尝试了 vpekar 的解决方案。

也许我的是某种边缘情况，但我在应用替换后观察到相同的行为，但是，当我尝试用放在它们之前的引号替换标点符号时，我得到了我正在寻找的输出。据推测，缺乏对 MLA 的遵守不如将原始引用保留为一个句子重要。

为了更清楚：

```
text = text.replace('?"', '"?').replace('!"', '"!').replace('."', '".') 
```

如果 MLA 很重要，尽管您总是可以返回并在任何重要的地方扭转这些变化。

# actionscript-3 - AS3 中 mouseX 的返回类型

> ID：14095973
> 
> 赞同：0
> 
> 时间：2012-12-30T23:59:04.193
> 
> 标签：actionscript-3, flash

我试图找出 AS3 中 mouseX 函数的返回类型，但我找不到关于它的文档。有谁知道它返回的是数字还是整数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:16:57.490

这是一个数字

原因是它需要能够基于十进制。

# javascript - 在 Windows 8 中，我需要在哪里保存 Node.js 的 javascript 文件

> ID：14095975
> 
> 赞同：3
> 
> 时间：2012-12-30T23:59:20.730
> 
> 标签：javascript, node.js, windows-8

我刚刚下载了 node.js 并且第一次不得不使用他们的命令行。似乎地球上的每个教程都提供了相同的入门应用程序。它使用代码... var http = require('http');

```
http.createServer(function (request, response) {
    response.writeHead(200, {'Content-Type': 'text/plain'});
    response.end('Hello World\n');
}).listen(8124);

console.log('Server running at http://127.0.0.1:8124/'); 
```

并希望我将其保存到文件 example.js 中。然后可以通过键入来运行该文件...

```
node example.js 
```

但所有命令行给我的是

> ...

教程没有说我应该在哪里保存文件。到我的C盘？到与 node.js 相同的文件？任何地方？我已经尝试了所有三个，但它们似乎不起作用。如果有任何其他解决方案，或者只是我应该研究和询问的其他问题，我们也将不胜感激。但在这一点上，老实说，我不知道问题出在哪里，而且似乎很少有资源可以帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T00:01:35.733

当您`node example.js`从提示符运行时，假设它`example.js`位于当前工作目录中。

要更改当前工作目录，请使用更改目录 ( `cd`) 命令：

```
cd C:\Projects\MyProject
node example.js 
```

这相当于

```
node C:\Projects\MyProject\example.js 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-05T04:33:16.643

正确的！您可以将其保存在任何位置并通过 node.js 命令提示符上的 (cd) 命令更改到该目录，然后会显示消息：“服务器运行在：127.0.0.1:8124。所以将浏览器指向该地址，然后您查看您的文件。

# python - 查找近似重复查询

> ID：14095978
> 
> 赞同：0
> 
> 时间：2012-12-30T23:59:30.867
> 
> 标签：python, sql, algorithm, arcgis

我是一个完全的新手，因此无法通过查看过去的帖子找到解决方案。我有一个地理数据库（ESRI ArcMAP，大约 70k 条记录），其中包含从两个数据库合并的道路杀伤数据。

前任。

```
Date_, Route, MilePost, Database

10/1/2012, ML34, 113, Animal_Vehicle

10/2/2012, ML34, 113.4, Carcasses

10/2/2012, ML16, 86, Carcasses 
```

我正在尝试整理两个数据库之间的重复记录。具有相同`MilePost`、`Route`和的记录`Date_`已被删除。问题是：`Animal_Vehicle`可以在一周中的任何时间或一天记录碰撞，而`Carcasses`数据库中的记录仅在正常工作时间记录。因此，重复来自`Animal_Vehicle`前一天或周末下班后记录的尸体。`Carcasse`然后在第二天早上或星期一（或在假期周末的情况下为星期二）复制记录。另一个问题是`Animal_Vehicle MilePosts`倾向于四舍五入到最近的半英里，而`Carcasses MilePosts`更精确。

目标是构建一个查询或算法，返回在两个`Database`值之间配对的记录，以便当 时`Database=Carcasses`，查询返回带有 的记录`Database=Animal_Vehicle`，其中`MilePost`是记录的 +/- 0.4 `Carcasses`，而 是在记录的`Date_`最后四天内`Carcasses`. 它将返回示例数据的前两行。

非常感谢任何回应！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T00:17:09.877

这只是一个花哨的连接：

```
select *
from Carcasses c full outer join
     Animal_Vehicle av
     on c.date between av.date and av.date+3 and
        abs(c.Milepost - av.Milepost) < 0.5 and
        c.route = av.route 
```

该`on`条款具有基于您的描述的条件。这不太可能是一个非常快速的查询。而且，我假设您正在使用一个数据库，您可以在其中使用“+3”将日期添加到日期 - 这取决于数据库。

# excel - VBA (Excel) 中的 Side-Step Application.MsgBox

> ID：14095982
> 
> 赞同：1
> 
> 时间：2012-12-30T23:59:49.750
> 
> 标签：excel, excel-2010, vba

为了阻止“评论”回复的风暴，这是我的情况：

我有一个过程通常运行 1 次迭代 1 次迭代。用户手动点击一个调用宏的按钮，该宏在完成后会弹出一个消息框，报告宏运行的总时间长度。这对于诊断问题非常方便。此代码已锁定，我无法修改它。

我正在尝试大规模地做到这一点。因为主电子表格和工作簿中的代码被锁定，所以我在同一个 excel 实例中打开了一个单独的工作簿，其中包含一个操作锁定工作簿的宏。而不是一个一个一个，我有一组 300 个我正在尝试运行。现在我必须照看这个东西并点击空间以通过 MsgBox。有谁知道任何技巧来防止我不得不监控这件事？禁用弹出窗口或以某种方式使它们成为非模态。也许是让鼠标点击的技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:15:21.240

您知道解决问题的最佳方法是更正代码是正确的。在这种情况下，您可能会使弹出窗口可以切换。

然而，我为你写了这个，它可以作为一个潜在的解决方法。它利用 VBScript 来“排序”模拟多线程，以便您可以将密钥发送到 modal `Msgbox`。假设您可以通过代码执行您想要执行`SendDelayedKeys`的操作，只需在将导致`Msgbox`. 您可能需要`Delay`根据自己的情况进行修改，因为 100 毫秒可能还不够。要更改`Delay`，只需像这样调用：`SendDelayedKeys 500`500 毫秒。

```
Sub SendDelayedKeys(Optional Delay As Long = 100, Optional keys As String = """ """)
    Dim oFSO As Object
    Dim oFile As Object
    Dim sFile As String
    sFile = "C:\SendKeys.vbs" 'Make this a valid path to which you can write.
    'Check for the .vbs file.
    If Not Len(Dir$(sFile)) Then
        'Create the vbs file.
        Set oFSO = CreateObject("Scripting.FileSystemObject")
        Set oFile = oFSO.CreateTextFile(sFile)
        oFile.WriteLine "Set WshShell = WScript.CreateObject(""WScript.Shell"")"
        oFile.WriteLine "WScript.Sleep CLng(WScript.Arguments(0))"
        oFile.WriteLine "WshShell.SendKeys WScript.Arguments(1)"
        oFile.Close
    End If
    Shell "wscript C:\SendKeys.vbs " & Delay & " " & keys
End Sub
Sub ProofOfConcept()
    'Using default parameters which sends a space after 100 milliseconds
    SendDelayedKeys
    MsgBox "I disappear on my own!"
End Sub 
```

一句警告：任何使用`SendKeys`的解决方案都是脆弱的解决方案，应尽可能避免使用。但是，当您的选择有限并且您需要避免手动过程时，有时这是您唯一的选择。

由于 SiddhartRout 正确地指出这可以使用 API 调用来解决：这里有一个[C# 代码链接，它会每秒关闭你的 msgbox。](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/d3f89686-e4d0-4bb1-9052-31abef2a9d2a)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:35:23.010

这里的问题实际上并不是更多代码可以（或确实应该）解决的问题。

有很多事情需要考虑，任何解决方案都会比它最初试图解决的问题更复杂、更不可靠。但是让我们看看你的选择......

1.  `SendKeys`对于那种用途来说是不可靠的，如果对话说“*你想让我保存这本工作簿吗？* ”只是在做了一个临时的改变或者“*你想玩全球热核战争吗？* ”加上使用这样的批处理过程，您希望在等待时继续处理其他事情，即使它只是来这里投反对票。如果没有别的，你可能无法控制这段代码，那么当维护人员意识到 msgbox 是糟糕的 UX 并杀死它时会造成什么样的混乱？

2.  `FindWindow`API 调用可以让您检查窗口中的内容，以确保它说出了您所期望的内容，但随后您可能会要求一些快速而肮脏的 vbscript 进入竞争条件，直到出现正确的窗口。你能保证线程不会锁定吗？平台问题呢——如果有人想在他们闪亮的新表面上运行你的代码会发生什么？当您进行的 32 位 api 调用无法看到您的 64 位模态 Excel 对话窗口时会发生什么？不以相同方式呈现模态对话的新版 Office 会怎样？这些问题都不是不可克服的，但每个都增加了复杂性（也就是失败的机会。）

最好的解决方案是解决您从一开始就发现的实际问题，即原始代码引发了不必要的模态对话。有人需要解决这个问题 - 不一定是你，但如果你估计模态对话浪费了多少时间在生产力损失上，这应该会给你一个可靠的商业案例来解决它。

# c++ - C++中类的声明将接口与该接口的实现结合起来？

> ID：14095989
> 
> 赞同：2
> 
> 时间：2012-12-31T00:00:51.083
> 
> 标签：c++, class, interface

我有一个关于类声明的问题。

我在一篇论文中读到了以下几行： C++ 类声明将对象的外部接口与该接口的实现结合在一起。

那么，什么是 C++ 中的外部接口？C++中有接口的概念吗？如何理解这一点：C++ 类声明将对象的外部接口与该接口的实现结合在一起。?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T00:06:29.000

我认为它指的是API——即公共函数的签名——与实现相比——即私有函数和数据成员。

```
class T
{
   // Here are some private things.
   // You might say that these are part of
   //  the class's implementation.

   int x;
   int y;

   void foo();
   void bar();

public:
   // And here are some public things, that
   //  constitute the class's API or "interface",
   //  which is the mechanism by which you may
   //  interact with objects of this type.

   void baz();
   void boz();
}; 
```

请注意它们是如何出现在单个类定义中的，它们必须存在。“结合”。

但最终，您必须询问论文的作者，因为使用的术语级别取决于他们。可以想象，他们*可能*在谈论继承层次结构和抽象基类……尽管我找不到一种方法来合理化 C++ 类定义在任何真正意义上“组合”它们的断言。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T01:37:33.327

我认为论文的定义有点不准确。*声明*、*实现*、*定义*和*接口*这些术语应该严格使用。我将尝试解释一下。

首先，类*声明*不指定任何接口：它只是声明类存在。例如，这些是一些声明：

```
class my_class;
struct my_structure;
template<typename T> class X; 
```

另一方面，类*定义**声明*哪些是类的*成员*（函数和数据）。在不详细说明的情况下，您引用的论文所使用的术语*外部接口*大致意味着“可以通过属于*非*该类成员的函数的代码对该类的对象执行的操作的规范”。

这是一个类*定义*的例子：

```
class my_class
{
public:
    void foo();
    int bar(int x) const;
private:
    void do_something();
    int data;
}; 
```

您提到的论文中使用的术语*外部接口*几乎可以肯定是指*公共*接口，它是具有`public`可见性的类的所有成员的列表。类的所有成员变量和函数都可以具有以下三种可见性级别之一：`public`、`protected`或`private`。我在这里没有深入研究细节，但应该足以说`public`成员（数据或函数）是那些可以从本身*不是*类成员的函数访问的成员，而`private`成员只能从属于类的函数*访问*班的成员。这`protected`限定符与继承有关，我认为不需要涵盖它来回答您的问题。

现在上面类的*公共接口**声明*了函数 foo() 和 bar()，但还没有指定它们的*实现*，或者更正式的术语，它们的*定义*。通常，成员函数不一定在类*定义*中定义（您无法仅通过查看 的定义来判断它的作用，对吗？）。因此，除非您在声明后直接编写成员函数的*主体*，否则需要单独的*成员函数定义*来指定该函数的*实现*：`my_class`****`foo()``my_class`****

 ***```
void my_class::foo()
{
    std::cout << "hello, i'm foo" << std::endl;
}

int my_class::bar(int x)
{
    do_something();
    x * 2 + 1;
}

void my_class::do_something()
{
    std::cout << "doing something..." << std::endl;
} 
```

由于这些函数的可见性级别不同，来自类外部函数的客户端代码`my_class`可以调用函数`foo()`，`bar()`因为它们属于`public`接口，但不`do_something()`属于声明为的函数`private`。例如：

```
int main()
{
    my_class c;
    c.foo(); // OK!
    c.do_something(); // ERROR!
} 
```

某些功能可以从类外部访问而其他功能不能访问这一事实背后的基本原理是在名为“**信息隐藏**”的良好设计原则中找到的。通过仅向您的客户公开一组*服务*并隐藏这些服务的实际*实现*方式（例如，函数`bar()`调用`private`函数`do_something()`），您创建了一个抽象层，以保护客户端代码免受这些服务实现中可能的内部更改的影响。

所以最后，我相信“ *A C++ 类声明将对象的外部接口与该接口的实现相结合*”这句话的作者实际上想说的是，**从类的*定义*中你可以得到关于什么的提示是类向其客户端公开的服务（“外部接口”，即`public`函数）*，以及*在内部用于实现这些服务的函数和变量是什么（“实现”，即`private`函数和成员变量）**。

如果花了一点时间才最终给你解释那句话，我深表歉意，但我觉得有必要进行一些澄清。无论如何，这必然只是这个明确主题的简短摘要：我相信如果你在谷歌上搜索所有这些术语或者如果你购买一本关于 C++ 的好书，你可以找到更好的资源。

PS：另外请记住，*正式*的术语（和关键字！）`interface`在 C++ 中意味着非常具体的东西，这需要引入*纯虚函数*的概念。我认为这不是解释的情况，因为它可能与您引用的句子中“接口”一词的预期含义无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:06:33.853

您可以将类的公共成员视为外部接口。

例如，在 C++ 中没有`interface`像在 Java 中那样。只能定义一个基类，定义一些虚成员函数，必须由派生类实现。

类声明包括`public`,`protected`和/或`private`成员。protected 和 private 成员可以被视为“实现”细节，但不一定是该公共接口的实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T00:08:08.737

接口包含方法的声明，这可以在头文件中找到。此头文件与出现此方法代码的一些源文件相关联。例如，您可以看到如何在 Eclipse CDT 中添加一个类。***

# python - Python服务器的问题

> ID：14095990
> 
> 赞同：1
> 
> 时间：2012-12-31T00:00:53.540
> 
> 标签：python, sockets, keep-alive

我有一些测试客户端每次都遇到相同的问题。客户端可以连接，并且可以发送第一条消息，但之后服务器停止响应该客户端。我怀疑这个问题与 s.accept() 有关，但我不确定到底出了什么问题或如何解决它。

```
def startServer():
    host = ''
    port = 13572
    backlog = 5
    size = 1024

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind((host,port))
    s.listen(backlog)

    print "Close the command prompt to stop Gamelink"

    while 1:
        try:
            client, address = s.accept()
            data = client.recv(size)
            if data:
                processData(data)
                client.send("OK")
            else:
                print "Disconnecting from client at client's request"
                client.close()
        except socket.error, (value, message):
            if s:
                print "Disconnecting from client, socket issue"
                s.close()
            print "Error opening socket: " + message
            break
        except:
            print "Gamelink encountered a problem"
            break
        print "End of loop"
    client.close()
    s.close() 
```

该服务器旨在通过本地网络访问，并且它需要重量轻且响应速度非常快，因此如果其他实现（例如基于线程）会更好地满足这些要求，请告诉我。预期的应用程序将用作远程游戏键盘，因此需要低资源使用和高速。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:21:30.533

直接使用编写服务器`socket`会很困难。正如基思所说，您需要以某种方式多路复用连接，例如使用`select`或`poll`或线程或`fork`。您可能认为您只需要一个连接，但是当出现问题并且连接丢失时您会怎么做？如果您的服务器尚未意识到连接丢失，它是否能够响应来自客户端的重新连接尝试？

如果你的网络需求是基本的，你也许可以让其他东西为你处理所有的倾听、接受和分叉的东西。您没有指定平台，但此类程序的示例[在](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man5/launchd.plist.5.html#//apple_ref/doc/man/5/launchd.plist)Mac OS上启动，在 Linux 上启动[xinetd 。](http://www.xinetd.org/)这些工具的细节有所不同，但基本上你可以在一些配置文件中配置它们，以侦听某个端口上的连接。当他们得到它时，他们会负责建立连接，然后他们会`exec()`使用您的程序`stdin`并`stdout`针对套接字，因此您可以简单地使用您可能已经知道的所有基本 IO，例如`print`和`sys.stdin.read()`。

像 xinitd 和 launchd 这样的解决方案的问题在于，对于每个新连接，它们必须`fork()`和`exec()`程序的新实例。这些是相对繁重的操作，因此大量连接或高新连接率可能会达到服务器的限制。但更糟糕的是，由于每个连接都在一个单独的进程中，因此很难在它们之间共享数据。此外，您可能会发现在进程之间进行通信的大多数解决方案都涉及[阻塞 API](https://stackoverflow.com/questions/7407165/what-is-a-blocking-function)，现在您又回到了与`select`线程或类似线程进行多路复用的问题。

如果这不能满足您的需求，我认为您最好学习使用更高级别的网络框架，该框架将处理您走上`socket`. 我建议的一个这样的框架是[Twisted](http://twistedmatrix.com/)。除了处理连接处理的普通细节以及在它们之间多路复用 IO 的更复杂的任务之外，您还将拥有一个庞大的工具库，这将使您的协议的实现更加容易。

# html - 无法在特定大小的画布上绘图

> ID：14095991
> 
> 赞同：4
> 
> 时间：2012-12-31T00:01:13.627
> 
> 标签：html, google-chrome, canvas

出于某种原因，如果以下代码中的第二个画布的高度超过 526 像素，Chrome 中将不会对其进行任何绘制。只要 height < 527，它就可以正常工作，并且始终可以在 Firefox 中使用。有人知道我在做什么错吗？我对 HTML 很陌生，如果我错过了一些东西，很抱歉。

```
<!doctype html>
<html>
  <head>
 <script type="text/javascript">

function init()
{
    var canv = document.getElementById("myCanvas");
    var ctx = canv.getContext("2d");
    ctx.fillStyle = "red";
    ctx.fillRect(0, 0, canv.width, canv.height);
}

</script>
<style type="text/css">
canvas {border: 1px solid black; }
</style>
</head>
<body onload="init()">
<canvas id="mainFrame" width="700" height="700"></canvas>
<canvas id="myCanvas" width="125" height="527"></canvas> <!-- cannot exceed
526 ... WHY? -->
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T11:50:28.167

我在 win7 x64 上的 chrome v.24.0.1312 上尝试了这个，它按原样工作，尝试更新到最新版本的浏览器。

# iphone - iPhone Simulator 6.0 在沙盒模式下无法连接到游戏中心

> ID：14095993
> 
> 赞同：2
> 
> 时间：2012-12-31T00:01:26.393
> 
> 标签：iphone, ios, ios6, ios-simulator, game-center

我正在尝试实现一个针对 iOS 6 的游戏中心感知应用程序。为了提供有关环境的一些信息，我正在使用 XCode 版本为 4.5.2 的 mac os 10.7.5 并且 xcode 正在运行 iphone 和 ipad 模拟器版本 6.0。问题是我无法通过 ipad 或 iphone 模拟器以沙盒模式连接到游戏中心，但是在我的 iphone 中测试时，相同的代码可以正常工作。

我遵循了苹果开发者库中的游戏中心编程指南，我得到了这个 atm，它是从 appdelegate 中的 applicationDidFInishLaunching 调用的：

```
- (void)authenticateLocalUser:(UIViewController *)currentViewController
{

    if (!gameCenterAvailable) return;
    GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];

    localPlayer.authenticateHandler = ^(UIViewController *viewController, NSError *error){

        if (viewController != nil)
        {
            [currentViewController presentViewController:viewController animated:YES completion:nil];

        }
        else if (localPlayer.isAuthenticated)
        {
            NSLog(@"Player authenticated");
        }
        else
        {
            NSLog(@"Player not authenticated");
        }
        NSLog(@"Error: %@",error);
    };
} 
```

它输出：

```
Error: Error Domain=GKErrorDomain Code=2 "The requested operation has been cancelled."
UserInfo=0x8690510 {NSLocalizedDescription=The requested operation has been cancelled.}

GKSConnSettings: set server: {
        "gk-cdx" = "17.173.254.218:4398";
        "gk-commnat-cohort" = "17.173.254.220:16386";
        "gk-commnat-main0" = "17.173.254.219:16384";
        "gk-commnat-main1" = "17.173.254.219:16385";
    } 
```

虽然我的操作系统不是 10.8.2，但我已经尝试过修复主机文件，但它没有帮助。[https://devforums.apple.com/thread/168811?tstart=0](https://devforums.apple.com/thread/168811?tstart=0)

知道可能是什么原因吗？

编辑：好吧，事实证明以 GKSConnSettings 开头的输出部分没有表示任何问题，这是连接到游戏中心时的常规输出，正如我从互联网上阅读的内容所了解的那样。我在身份验证块内打印了实际的错误消息（GKErrorDomain = 2 ...）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T06:30:37.260

我的灵感来自：[https](https://stackoverflow.com/a/8115807/837244) ://stackoverflow.com/a/8115807/837244 ，并决定使用不同的代码登录游戏中心帐户。所以在 viewdidload 我通常调用：

```
[[GCHelper sharedInstance] authenticateLocalUser:self]; 
```

现在我将其注释掉，通过以下 URL 方案访问游戏中心，登录到我的帐户，然后注销。

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"gamecenter:"]]; 
```

最后通过注释掉 URL 代码并使用原始代码来恢复。现在它工作正常，我想问题是游戏中心帐户已经连接到模拟器中，并且它拒绝了每个登录请求。希望苹果能更清楚地显示错误消息，解决这样一个简单的问题需要一个月的时间，这可能对其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-22T06:55:14.730

我知道这个问题引用了特定的 Xcode 和 iOS 模拟版本，但是如果您的模拟器已经登录了一个帐户，并且您不介意丢失模拟器上的任何数据（可能性很小，但您永远不知道），您可以简单地重置其上的设置和数据。

转到：模拟器 -> 重置内容和设置...

...并在出现提示时确认操作。

这对于运行 iOS 9.x 模拟器的 Xcode7.x 来说当然是正确的，其他人可能能够验证它是否适用于早期版本（尤其是当我发现了一个相当古老的问题和答案时）。

## 动物451

死灵术：+1

# python - 在 python gae 中上传和显示图像？

> ID：14095997
> 
> 赞同：2
> 
> 时间：2012-12-31T00:01:35.147
> 
> 标签：python, google-app-engine, google-cloud-datastore

很难在 python gae 中上传和显示图像。

这就是我所做的。1.在app.yaml文件中，我添加了：

```
handlers:

- url: /favicon\.ico
  static_files: favicon.ico
  upload: favicon\.ico

- url: /(.*\.(gif|png|jpg))
  static_files: /\1
  upload: (.*\.(gif|png|jpg))

- url: .*
  script: main.app 
```

1.  然后放下：

在

```
def Character(db.Model):
   avatar = db.BlobProperty() 
```

在我的处理程序下：

```
if avatar:
  character_info.avatar = db.Blob(images.resize(avatar, 240,360))
   character_key = character_info.put() 
```

我可以在 gae 管理数据查看器中看到一个二进制输入，但不确定它是如何调用它的。然后，我将字符对象传递给 PageHandler 并调用 for 循环来获取每个头像。

```
{% for character in characters %}
#{{another html page is render here}}
{% endfor %} 
```

尝试了这些，但它们都不起作用。

```
<img src="/images?img_id={{character.key()}}"></img>
<img src="/images/header.jpg"></img>
<img src="/avatar?avatar_id={{character.key()}}"></img> 
```

所以我的问题是：

1.  您如何确定“/images”（这是文件夹？）或“img_id”是正确使用的语法？

2.  我没有看到任何图片上传到我的本地主机，对吗？

3.  直接从文件夹中调用图像`<img src="/images/header.jpg"></img>`不起作用......（在 php 中它是工作......）

在此先感谢，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:10:02.047

静态文件由基础架构提供，而不是由您的应用程序提供。在我看来，您的处理程序定义中有错误......它应该看起来更像（注意：上传：部分中没有前导 /）

```
- url: /(.*\.(gif$|png$|jpg$))
  static_files: /\1
  upload: (.*\.(gif$|png$|jpg$)) 
```

然后任何以 gif、png 或 jpg 结尾的 url 都将由应用程序引擎基础设施而不是您的应用程序处理程序作为服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T23:31:27.757

好吧，我发现我做错了什么是我没有添加图像处理程序。

所以

```
class ImageHandler(Handler):
    def get(self):
        character = db.get(self.request.get('img_id'))
        if character.avatar:
            self.response.headers['Content-Type'] = 'image/png'
            self.response.out.write(character.avatar)
        else:
            self.response.out.write("No image") 
```

这解决了我的问题。

# ruby-on-rails - Rails - 如果模板可用，使用 respond_to 的目的是什么？

> ID：14095998
> 
> 赞同：0
> 
> 时间：2012-12-31T00:01:44.133
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我见过一些人使用这样的代码

```
respond_to do |format|
  format.html
  format.js
end 
```

如果我们有 template.html 和 template.js，这样做的目的是什么。任何一个都可以在不指定respond_to的情况下呈现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:10:03.427

格式选项可以占用一个块，以便您可以进行一些自定义呈现，例如呈现文件或`:head`响应。看看[这里的一些例子](http://apidock.com/rails/ActionController/MimeResponds/InstanceMethods/respond_to)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:10:48.177

您的代码段没有做任何特别的事情，但格式选项允许您在必要时提供额外的自定义行为。

例如，如果您想将您的呈现`@products`为 JSON：

```
 respond_to do |format|
  format.html
  format.js { render :json => @products }
end 
```

这只是您可以对格式块执行的众多操作之一。有关更多信息，请参阅[Ruby on Rails 指南：布局和渲染](http://guides.rubyonrails.org/layouts_and_rendering.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:12:17.040

如果您没有为不同的格式指定不同的行为，则没有理由使用`respond_to`. 如果您有模板，它们将自动被导轨拾取。如果您需要每种格式的不同行为，该`respond_to`方法很有用：

```
respond_to do |format|
  format.html { render :edit }
  format.json { render :json => '{}' }
end 
```