# StackOverflow 问答 13292000-13292999

# sql-server - SQL Server Express 实体框架代码优先

> ID：13292002
> 
> 赞同：2
> 
> 时间：2012-11-08T15:24:01.020
> 
> 标签：sql-server, entity-framework, code-first, sql-server-2008-express

我尝试使用代码优先的方法来创建我的数据库我创建了我需要的每个类，然后在我的项目中添加了一个 Web 表单和一个网格视图。然后我尝试将网格视图的数据源设置为数据库。当我想选择一个新连接时，它实际上发现我的数据库自动命名为“TimeTrackerDbContext”，但是当我点击下一步时，我收到此错误：“无法为此连接检索数据库架构。建立时发生网络相关或特定于实例的错误到 sql server 的连接。找不到或无法访问服务器。验证实例名称是否正确以及 sql server 是否配置为允许远程连接。（提供程序：命名管道提供程序，错误：40 - 无法打开连接到 SQL Server) 在 DataObjectSupport(422,6)"

我在 web.config 中的连接字符串部分是： "name="TimeTrackerDbContext" connectionString="server=./SqlExpress;integrated security=SSPI; 数据库 =TimeTracker" providerName="System.Data.SqlClient"

我用的是win 8。你能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:03:10.813

如果此数据库，您确定您的活动目录用户名是 dbowner 吗？您需要有权在此数据库中创建对象

# c - 有没有可以使用 libc 中的函数 fma 的场景？

> ID：13292013
> 
> 赞同：5
> 
> 时间：2012-11-08T15:24:43.443
> 
> 标签：c, floating-point, posix, libc, fma

我看到[这个页面](http://sourceware.org/newlib/libm.html#fma)，发现有一个奇怪的*浮动乘法相加* 函数——`fma`和`fmaf`。它说结果是这样的：

```
 (x * y) + z             #fma(x,y,z) 
```

并且该值是*无限精度并四舍五入到结果格式*。

但是，AFAICT我以前从未见过这样的三元运算。所以我想知道这个函数的自定义用法是什么。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-08-14T18:44:22.957

fused-multiply-add 指令的重要方面是中间结果的（实际上）无限精度。这有助于提高性能，但不是因为两个操作被编码在一条指令中 - 它有助于提高性能，因为中间结果的几乎无限精度有时很重要，并且在这种级别的普通乘法和加法中恢复**非常**昂贵精度确实是程序员所追求的。

## 示例：`a * b`比较`1.0`

假设确定两个双精度数的乘积`a`与`b`非零常数（我们将使用`1.0`）的位置对算法至关重要。数字`a`和`b`都具有二进制数字的完整有效位。如果您计算`a*b`为 a `double`，结果可能是`1.0`，但这并不能告诉您实际的数学乘积是略低于 1.0 并向上舍入为 1.0，还是略高于 1.0 并向下舍入。如果没有 FMA，您的选择是：

1.  计算`a*b`为四精度数。四精度未在硬件中实现，但有软件仿真库。在四精度中，乘积的数学结果可以精确表示，然后您可以将其与 1.0 进行比较。

2.  `a*b`在向上舍入模式和向下舍入模式下以双精度计算。如果两个结果都是 1.0，则意味着`a*b`正好是 1.0。如果 RU(a * b) 大于 1.0，则表示数学乘积高于 1.0，如果 RD(a * b) 低于 1.0，则表示数学乘积低于 1.0。在大多数处理器上，这种方法意味着将舍入模式更改 3 次，并且每次更改都代价高昂（它涉及刷新 CPU 管道）。

使用 FMA 指令，可以计算`fma(a, b, -1.0)`结果并将其与 0.0 进行比较。由于浮点数在零附近更密集，并且由于中间乘积在计算中没有四舍五入，我们可以确定这意味着和`fma(a, b, -1.0) > 0`的数学乘积大于 1，依此类推。`a``b`

## 示例：Veltkamp/Dekker 乘法

[double-double](http://en.wikipedia.org/wiki/Quadruple-precision_floating-point_format#Double-double_arithmetic)格式是将数字有效地表示为两个双精度浮点数之和。它几乎与四精度一样精确，但利用了现有的双精度硬件。

考虑以下函数 ，`Mul12(a, b)`它接受两个双精度数`a`并将`b`它们的乘积计算为双双数。Veltkamp 和 Dekker 的算法仅使用双精度加法和乘法（[参考](https://carolomeetsbarolo.wordpress.com/2012/02/13/the-veltkamp-dekker-route-to-extended-precision/)）计算此函数。它需要 6 次乘法（一个是`Split()`算法主体中每个加四的一部分），以及大量的加法。

如果有 FMA 指令，`Mul12`可以实现为**两个**操作，一个乘法和一个 FMA。

```
high = a * b; /* double-precision approximation of the real product */
low = fma(a, b, -high); /* remainder of the real product */
/* now the real product of a and b is available as the sum of high and low */ 
```

## 更多示例

FMA 用于其精度的示例，不仅作为执行乘法和加法的指令，还包括平方根和除法的计算。这些运算必须根据 IEEE 754 标准正确舍入（到数学结果的最接近的浮点数）。当有硬件 FMA 指令可用时，这两个操作可以有效地实现。这方面通常被编译链隐藏，但 IA-64 指令集 (Itanium) 没有除法指令。相反，可以通过涉及 FMA 的一系列指令（通常由编译器生成）来获得正确舍入的除法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T15:27:29.427

它通常用作优化。大多数浮点单元都有一条`fma`指令，因此可以在一条指令中执行计算，而不是两条或更多条指令。因此，对于性能关键的浮点代码，它是一个有用的功能。

# jquery - Jqgrid 列标题和数据未对齐

> ID：13292024
> 
> 赞同：4
> 
> 时间：2012-11-08T15:25:23.410
> 
> 标签：jquery, jqgrid

我有一个动态的表，它是在 C# 后面的代码中生成的。我使用 tabletogrid 将此 html 表转换为 Jqgrid，我用来执行此操作的代码是

```
tableToGrid('#gvSearchDocuments',
                    { height: 'auto',
                        autowidth:true,
                        multiselect: true,
                        pager: 'pagersearch',
                        rowList: [20, 30, 50],
                        colNames: ['ID','Message Date', 'Fund', 'Partner', 'Menu', 'Sub Menu', 'Document Name', 'Document Description', 'Type'],
                        colModel: [
                            { name: 'ID', hidden: true},
                            { name: 'MessageDate',
                            align: 'right',
                            sorttype: 'date',
                            formatter: 'date',
                            formatoptions: { newformat: 'M-d-Y' }
                                    },
                                    { name: 'Fund', align: 'left'},
                                    { name: 'Partner', align: 'left' },
                                    { name: 'Menu', align: 'left'},
                                    { name: 'SubMenu', align: 'left'},
                                    { name: 'Documentname', align: 'left' },
                                    { name: 'DocumentDescription', align: 'left'},
                                    { name: 'Type', align: 'left' }

                                   ]
                    }); 
```

我遇到的问题是在生成 jqgrid 时，列标题和数据未正确对齐。我尝试使用 autoWidth、width 和 shrinkToFit 但没有运气。这就是我的网格在 IE、Firefox 和 Chrome 中的显示方式。

![在此处输入图像描述](../Images/b5e167fae0d4251db8403d1ba0e3163b.png)

我在这个上花了一天多的时间，它慢慢地杀死了我。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-02T13:28:20.633

我终于能够解决这个问题。

我在调用之前错误地隐藏了*纯*`tableToGrid`HTML 表格，`display: none;`然后在使用`display: block;`. 被`display: block;`数据单元继承，对它们产生负面影响。当调整标题大小时，它们的大小调整被阻止（一旦达到显示整个单元格内容所需的最小宽度，它们就会停止调整大小）。

请参阅此[jsFiddle](http://jsfiddle.net/Sg4EE/)以重现该问题。如果您注释掉脚本中的最后一行，问题就会消失。

顺便说一句，我知道这`tableToGrid`不是很好（在性能方面很糟糕），但在我的应用程序的特殊情况下，这是我可以使用的唯一方法，它不需要大量重写大量遗留代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T10:19:59.457

尝试将此属性应用于您的表..

```
table-layout: fixed; 
```

这对我有用。我希望这对你有帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-24T07:25:11.223

编辑CSS

```
.ui-jqgrid tr.jqgrow td{
         white-space: normal;
      } 
```

# ios - 在 MacOSX Lion 上使用 Jenkins 的 iOS 应用程序的错误签名代码

> ID：13292025
> 
> 赞同：1
> 
> 时间：2012-11-08T15:25:24.200
> 
> 标签：ios, jenkins, code-signing

当我尝试在 Jenkins 中构建我的 iOS XCode 项目时，出现以下错误：

> === CLEAN NATIVE TARGET MyTarget OF PROJECT MyProject WITH CONFIGURATION Debug === 检查依赖项 [BEROR] 代码签名错误：身份“iPhone 开发人员：我的姓名（xxxxxxxx）”与任何有效的、未过期的证书/私有不匹配钥匙串中的钥匙对

在阅读了一些文章（如[this](https://stackoverflow.com/questions/6827874/missing-certificates-and-keys-in-the-keychain-while-using-jenkins-hudson-as-cont)和[this](https://stackoverflow.com/questions/9245149/jenkins-on-os-x-xcodebuild-gives-code-sign-error?lq=1)）后，我确保 login.keychain 存在使用：

```
MacMini:Keychains jenkins$ security list-keychains
    "/Users/Shared/Jenkins/Home/Library/Keychains/login.keychain"
    "/Library/Keychains/System.keychain"
MacMini:Keychains jenkins$ 
```

并且*SessionCreate=true*存在于我的*/Library/LaunchDaemons/org.jenkins-ci.plist*

PS。我会强调在我的 mac mini 上运行的 XCode 成功构建项目的事实，但是如果我运行命令

```
/usr/bin/xcodebuild -target MyTarget -configuration Debug clean build 
```

...我仍然收到相同的错误消息。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:34:23.343

尝试使用选定的方案运行 xcodebuild 命令。

编辑：而不是

```
/usr/bin/xcodebuild -target MyTarget -configuration Debug clean build 
```

做这个

```
/usr/bin/xcodebuild -scheme MyAwesomeScheme clean build 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:55:03.187

为了解决这个问题，我必须检查 Jenkins 作业配置中的“解锁钥匙串”选项（提供密码）。

# jquery - 将图像调用到 javascript jQuery 中

> ID：13292027
> 
> 赞同：0
> 
> 时间：2012-11-08T15:25:33.580
> 
> 标签：jquery, slickquiz

我正在使用 SlickQuiz 运行测验，我正在修改 .js 文件，而不是通过文本显示问题，我想调用图像。这里是代码：

```
{
    "q": "This is the question area where I'd prefer to call an image?",
    "a": [
        {"option": "Answer 1",    "correct": false},
        {"option": "Answer 2",     "correct": true},
        {"option": "Answer 3",      "correct": false}// no comma here
    ],
    "correct": "<p><span>Well done!</span> The correct answer is Answer 2.</p>",
    "incorrect": "<p><span>Incorrect</span> The correct answer is Answer 2.</p>" // no comma here
} 
```

所以“q”行是我要调用图像的地方。有人有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T09:38:32.027

谢谢大家，最后为我指明了正确的方向。

只需要转义 img 标签中的引号；

```
"q": "<img src=\"../images/q1.png\" />", 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T00:54:16.983

是的，先生，这是一个非常简单的解决方法。只需尝试在下面添加此代码。它也对我有用。

`<img src=\"your.image.whatever\"/>`

# javascript - jQuery 正在刷新页面

> ID：13292029
> 
> 赞同：1
> 
> 时间：2012-11-08T15:25:34.827
> 
> 标签：javascript, jquery

我在使用 JQuery 时遇到问题：每当调用 JQuery 函数时，只要执行 if 块，页面就会刷新。

```
$(".remove").click(function() {
    removeOption($(this));
});

function removeOption(obj){
if (obj.parent().siblings().size() > 1){
    obj.parent().remove();
}
} 
```

如果执行 (obj.parent()...) 块，则页面刷新。它不仅限于功能：如果我将 if (obj.parent()... ) 更改为 if (true)，我也会遇到同样的问题。如果我将 removeOption(obj) 作为匿名函数放在第一个函数中，我也会遇到问题。这可能是 JQuery 中的错误，还是有人有任何见解？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T15:36:52.207

当您处理 jquery 上的链接点击时，您必须禁用默认行为。

通过单击链接，引发 jquery 事件，然后调用 removeOption($(this))；但是您必须停止默认行为，因此我们使用：

```
$(".remove").click(function() {
   removeOption($(this));
   return false;
}); 
```

在末尾。

另一种方法是调用 preventDefault ( [http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/) ) 方法，如下所示：

```
 $(".remove").click(function(e) {
   e.preventDefault();
   removeOption($(this));
 }); 
```

阿纳斯，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:26:08.683

```
$(".remove").click(function() {
    removeOption($(this));
    return false;
}); 
```

# video - 崇高的视频播放器源

> ID：13292032
> 
> 赞同：1
> 
> 时间：2012-11-08T15:25:44.683
> 
> 标签：video, ruby-on-rails-3.2, html5-video

我正在用 ruby​​ on rails 编程。

如果我在我的应用程序的静态页面上发布视频，它可以工作：

```
<video controls
  src="video001.mp4"
  width="580" height="360"
  poster="default.png"
  id="video">
</video> 
```

视频本身和海报（图片）都保存在“/public”目录中。

但是当我将视频标签的完全相同的代码行放入“users/show.html.erb”页面时，我遇到了一个问题。对我来说，浏览器似乎不知道从哪里获取视频和图片。没有显示错误消息，只是一个透明的 HTML5 播放器，我无法单击任何内容。有人可以告诉我如何解决这个问题。或者在渲染页面（例如“用户/节目”）上定义正确源（EVEN）的最佳方法是什么。我真的尝试了所有可能出现在我脑海中的路径。

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:19:45.853

任何对此进行评分的人，都应该更好地写出帖子有什么问题，这样可以改进。这里没有冒犯，但疯狂的大拇指向下不会帮助任何人。

# java - 具有一些完全相似方法的工厂设计模式

> ID：13292033
> 
> 赞同：0
> 
> 时间：2012-11-08T15:25:51.960
> 
> 标签：java, design-patterns, interface, factory

我在 Java 中使用工厂设计模式。
根据这种模式，每个类都以他们喜欢的方式实现一个接口及其所有方法。

现在，我的问题是，假设有些方法完全一样，有些方法不一样（应该单独实现）

在这种情况下，我可以使用工厂设计模式吗？
如果不是，我如何从将实例化延迟到子类的属性中受益？
如果是，我应该在哪里实现常用方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:29:58.270

> 我应该在哪里实现常用方法？

在实现您的接口的抽象类中。您实现常用方法并保留不常用的方法。

# php - preg_split 有两种模式（其中一种被引用）

> ID：13292035
> 
> 赞同：4
> 
> 时间：2012-11-08T15:25:59.583
> 
> 标签：php, regex, preg-split

我想在 PHP 中拆分一个包含带引号和不带引号的子字符串的字符串。
假设我有以下字符串：

```
"this is a string" cat dog "cow" 
```

拆分后的数组应如下所示：

```
array (  
[0] => "this is a string"  
[1] => "cat"  
[2] => "dog"  
[3] => "cow"  
) 
```

我在使用正则表达式时有点挣扎，我想知道是否甚至可以通过一个正则表达式/preg_split-Call 来实现...

我尝试的第一件事是：

```
[[:blank:]]*(?=(?:[^"]*"[^"]*")*[^"]*$)[[:blank:]]* 
```

但这仅正确拆分了 array[0] 和 array[3] - 其余部分根据每个字符进行拆分。

然后我找到了这个链接：
[PHP preg_split with two delimiters unless a delimiter is within quotes](https://stackoverflow.com/questions/11873240/php-preg-split-with-two-delimiters-unless-a-delimiter-is-within-quotes)

```
(?=(?:[^"]*"[^"]*")*[^"]*$) 
```

在我看来，这是一个很好的起点。但是，我的示例中的结果与第一个正则表达式相同。

我尝试将两者结合起来——首先是引用字符串，然后是第二个子正则表达式，它应该省略引用字符串（因此是 [^"]）：

```
(?=(?:[^"]*"[^"]*")*[^"]*$)|[[:blank:]]*([^"].*[^"])[[:blank:]]* 
```

因此有2个问题：

1.  甚至可以通过一个 regex/preg_split-Call 来实现我想要的吗？
2.  如果是，我将不胜感激有关如何正确组装正则表达式的提示

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T15:29:33.580

由于匹配不能重叠，您可以这样使用`preg_match_all`：

```
preg_match_all('/"[^"]*"|\S+/', $input, $matches); 
```

现在`$matches[0]`应该包含您要查找的内容。正则表达式将首先尝试匹配带引号的字符串，然后停止。如果不这样做，它只会收集尽可能多的非空白字符。由于从左到右尝试交替，因此引用的版本优先。

**编辑：**这不会摆脱引号。为此，您可以使用捕获组：

```
preg_match_all('/(?|"([^"]*)"|(\S+))/', $input, $matches); 
```

现在`$matches[1]`将包含您正在寻找的内容。在`(?|`那里，两个捕获组都以相同的索引结束。

**编辑 2：**既然您要求`preg_split`解决方案，那也是可能的。我们可以使用前瞻，它断言空格后面跟着偶数个引号（直到字符串的末尾）：

```
$result = preg_split('/\s+(?=(?:[^"]*"[^"]*")*$)/', $input); 
```

当然，这不会摆脱引号，但这可以在单独的步骤中轻松完成。

# c# - 设计一个抽象基类。使用什么类型，抽象的还是具体的？

> ID：13292037
> 
> 赞同：4
> 
> 时间：2012-11-08T15:26:08.413
> 
> 标签：c#, java

我只是在我叔叔的推荐下从 Java 跳到 C#。Java 几何库似乎比 C# 的绘图库更完整，所以我正在做一些简单的移植，并添加一些附加功能以开始进入 C#。

但是，我遇到了一个设计问题，无法辨别哪个是更好的选择。在抽象基类中有多个采用具体数据类型的方法，还是有更少的方法采用抽象基作为其参数？

```
public abstract bool isOverlapping(GeometricObject2D o) {} 
```

或者

```
public abstract bool isOverlapping(Rectangle2D rect) {}
public abstract bool isOverlapping(Circle2D circ) {}
etc... 
```

我脑海中的论点告诉我具体的论点可以防止逻辑错误，但是，我被教导要在使用合适的情况下始终使用抽象数据类型。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T15:27:49.793

如果要将操作放在基类中，请使用抽象类型。您不希望每次决定添加新子类时都必须修改基类。

另一种方法是使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)之类的东西，并让每个具体类依次分派给访问者。然后，一个交集访问者将包含有关如何计算每对对象类型的交集的所有知识。

以下是访问者模式如何用于此目的。（我将使用 Java 语法，因为我不是 C# 程序员）。首先，这里使用访问者模式比通常情况更复杂，因为您必须根据*两个*参数的类型修改操作。实际上，您需要三重调度。Clojure 等语言直接支持这一点，但在 Java（可能还有 C#）中，您需要通过使用两个访问者级别来模拟三重调度。它很丑，但最大的好处是它可以保持几何层次结构的清洁和可维护性，并将所有交集逻辑集中在一个编译单元中。

```
public interface IGeometry {
    void accept(IGeometryVisitor visitor);
}

public interface IGeometryVisitor {
    void visitCircle2D(Circle2D circle);
    void visitBox2D(Box2D box);
    // a method for each concrete type
}

public class Circle2D implements IGeometry {
    public void accept(IGeometryVisitor visitor) {
        visitor.visitCircle2D(this);
    }
}

public class Box2D implements IGeometry {
    public void accept(IGeometryVisitor visitor) {
        visitor.visitBox2D(this);
    }
}

public class IntersectionVisitor implements IGeometryVisitor {
    private boolean mResult;
    private IGeometry mGeometry2;

    public static boolean isOverlapping(IGeometry geometry1, IGeometry geometry2) {
        return new IntersectionVisitor(geometry1, geometry2).mResult;
    }

    private IntersectionVisitor(IGeometry geometry1, IGeometry geometry2) {
        mGeometry2 = geometry2;
        // now start the process
        mGeometry1.accept(this);
    }

    public void visitCircle2D(Circle2D circle) {
        mGeometry2.accept(new Circle2DIntersector(circle));
    }

    private class Circle2DIntersector implements IGeometryVisitor {
        private Circle2D mCircle;
        Circle2DIntersector(Circle2D circle) {
            mCircle = circle;
        }
        public void visitCircle2D(Circle2D circle) {
            mResult = isOverlapping(mCircle, circle);
        }
        public void visitBox2D(Box2D box) {
            mResult = isOverlapping(mCircle, box);
        }
    }

    private class Box2DIntersector implements IGeometryVisitor {
        private Box2D mBox;
        Box2DIntersector(Box2D box) {
            mBox = box;
        }
        public void visitCircle2D(Circle2D circle) {
            mResult = isOverlapping(circle, mBox);
        }
        public void visitBox2D(Box2D box) {
            mResult = isOverlapping(mBox, box);
        }
    }

    // static methods to compute overlap of concrete types
    // For N concrete types there will be N*(N+1)/2 methods
    public static boolean isOverlapping(Circle2D circle1, Circle2D circle2) {
        return /* intersection of 2 circles */;
    }

    public static boolean isOverlapping(Circle2D circle, Box2D box) {
        return . . .;
    }

    public static boolean isOverlapping(Box2D box1, Box2D box2) {
        return . . .;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T15:38:24.203

欢迎来到[*双发*](http://en.wikipedia.org/wiki/Double_dispatch)地！您看到的问题是具有虚拟调度的语言缺点的经典例证。理想情况下，您正在寻找一个关于多个对象的虚拟函数，因为确定两个形状是否重叠的算法取决于两个形状。

Your second code snippet (with multiple concrete classes) is a start toward one common solution to the double dispatch problem, known as the [*visitor pattern*](http://en.wikipedia.org/wiki/Visitor_pattern). It works better than a chain of `if`-`then`-`else`s, but it has a couple of shortcomings:

*   Every time you add a new shape, all shapes must be extended with a method to check the overlap with the newly added shape
*   It is not clear where to look for the definitive algorithm of, say, `Rectangle2D` overlapping `Circle2D` - in `Rectangle2D`'s `IsOverlapping(Circle2D)`, or in `Circle2D`'s `IsOverlapping(Rectangle2D)`

One common solution is to introduce type IDs, and make a 2D array of delegates that process overlaps of geometric shapes. This suffers from the first problem of the visitor, but fixes the second by centralizing the decision making.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T15:52:56.833

我会做什么：

```
public interface IGeometry
{
    bool IsOverlapping(IGeometry geometry);
}

public class Circle2D : IGeometry
{
    public bool IsOverlapping(IGeometry geometry)
    {
        dynamic dyn = geometry;
        return Overlapper.Overlap(this, dyn);
    }
}

public class Box2D : IGeometry
{
    public bool IsOverlapping(IGeometry geometry)
    {
        dynamic dyn = geometry;
        return Overlapper.Overlap(this, dyn);
    }
}

public static class Overlapper
{
    public static bool Overlap(Box2D box1, Box2D box2)
    {
        // logic goes here
    }

    public static bool Overlap(Box2D box1, Circle2D circle1)
    {
        // logic goes here
    }

    public static bool Overlap(Circle2D circle1, Box2D box1)
    {
        return Overlap(box1, circle1); // No need to rewrite it twice
    }

    public static bool Overlap(Circle2D circle1, Circle2D circle2)
    { 
        // logic goes here
    }
} 
```

天哪，我的回答是愚蠢的。在这种情况下，您无论如何都不需要调用另一个对象，您可以直接将这对发送到静态类。无论如何......我的猜测是没有一种非常简单的方法可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T15:32:32.303

我不认为你可以实现通用逻辑来确定两个形状是否重叠，所以我建议重载`isOverlapping`所有类型。

如果您确实使用抽象类型作为参数，那么您仍然需要检查有问题的具体类型并执行相关的数学运算。这里的问题是解决方案不太明确 - 您可以传入一个`GeometricObject2D`在`isOverlapping`. 然后呢？在这里抛出异常并不是很好，因为`isOverlapping(GeometricObject2D o)`从技术上讲，您的调用在定义上是受欢迎的。说“我们接受几乎所有GeometricObject2D 类型！”，这违背了 OOP 的观点。

# jquery - 如何在 jquery 中获取“一个数字”？

> ID：13292038
> 
> 赞同：0
> 
> 时间：2012-11-08T15:26:09.570
> 
> 标签：jquery

我正在使用此脚本滚动到评论链接：

```
jQuery(document).ready(function(){
    jQuery('.comments-link').click(scrollToComments);
    if (location.hash=='#comments') scrollToComments();
    if (location.hash=='#respond') scrollToComments();
}); 
```

我还想补充：

```
if (location.hash=="#comment-#A-NUMBER#") scrollToComments(); 
```

`#A-NUMBER#`零件可以是任何数字。

如何在 jquery 中获取“任意数字”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:33:13.707

```
if(/#comment-\d{1,}$/.exec(location.hash)){
scrollToComments();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:30:45.520

一个正则表达式`/\d{1,N}$/`，比如 N 是你想要的位数，与你的 id 连接？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:31:42.900

您可以将 location.hash 拆分为“-”并检查第二部分是否为数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T15:32:29.563

您可以使用 split 函数拆分每个 #，然后您可以查找索引 2 来获取 A 编号。

```
var hashes = String(location.hash).split("#")
var anumber = parseInt(hashes[2]) 
```

我认为这样的事情会奏效。

# c - 获取令牌信息

> ID：13292043
> 
> 赞同：0
> 
> 时间：2012-11-08T15:26:24.950
> 
> 标签：c, windows, security, winapi, token

我有以下用 C 编写的程序：

```
#include "stdafx.h"
#include <Windows.h>

void main()
{
    char buffer[1000];
    int size = sizeof(buffer);
    PDWORD required_size;

    printf("----Application Privileges----\n\n");
    printf("In this program, we are going to obtain information about the application privileges\n\n");

    HANDLE process = OpenProcess(SYNCHRONIZE, FALSE, GetCurrentProcessId()); //Opening the current process
    HANDLE token; //Creating a handle for the token
    OpenProcessToken(process, TOKEN_ADJUST_PRIVILEGES, &token); //Opening the process token

    GetTokenInformation(token, TokenPrivileges, buffer, size, required_size); //Obtaining the token information
    printf("The following information was obtained with regards to the token privileges: \n\n");
    printf("%s\n\n", buffer);

    printf("Press enter to exit the program");
    getchar();

} 
```

现在，我对令牌的使用比较陌生。当我尝试执行程序时，出现以下错误：

> 运行时检查失败 #3 - 变量 'required_size' 未经初始化就被使用。

请问我该如何解决这个问题？我想要做的是向用户显示有关当前进程的令牌权限的信息。

我不确切知道 GetTokenInformation 方法中的最后一个变量 (ReturnLength [out]) 的作用。我尝试阅读 msdn 文档，但不了解它的用途。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:30:33.323

该`required_size`参数是一个“out”参数，意味着它从函数返回信息给你（即一个额外的返回值）。您应该将现有`DWORD`变量的地址传递给它，并在那里填充数据，但您传递给它的是一个未初始化的指针，它试图写入该指针。

您的代码应如下所示：

```
DWORD required_size;
GetTokenInformation(..., &required_size);  // Pass address of required_size
// required_size now contains the required size of the data buffer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:31:15.443

再次查看我给您的[示例和详细说明。](https://stackoverflow.com/questions/13291292/program-using-tokens-and-privileges/13291358#13291358)您需要先找到缓冲区的长度。然后将缓冲区初始化为您获得的 TOKEN_PRIVILEGES 结构的大小。这是执行初始化的行：

```
BYTE* pBuffer = new BYTE[dwLen]; 
```

# android - Android 片段和活动

> ID：13292049
> 
> 赞同：2
> 
> 时间：2012-11-08T15:26:41.390
> 
> 标签：android, android-fragments, android-activity, fragment, android-fragmentactivity

参考下图：

[http://developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

有人可以解释一下为什么谷歌建议在手机上使用 2 个单独的活动，在平板电脑上使用一个活动吗？如果我在活动 A 中有代码来管理片段 B（用于平板电脑），为什么我应该在活动 B 中为手机重复相同的代码？

似乎对于电话，我仍然可以使用 1 个活动（仅活动 A）并替换片段，这可以减少冗余代码吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:33:10.933

本质上，原因是手机很小。真的很小。微小的，事实上。

以电子邮件应用程序的经典场景为例。该场景中的两个片段是消息列表（片段 A）和消息内容（片段 B）。在有空间的平板电脑上，您可以将它们组合成一个活动，同时在屏幕上舒适地显示。但是，在手机上，您需要仔细管理屏幕空间，因此您应该将它们分为选择消息阶段（活动 A 显示片段 A）和阅读消息阶段（活动 B 显示片段 B ）。

通过将它们开发为片段，类似于其他平台中的用户控件，您可以在平板电脑和手机上的相同代码库中使用相同的片段，从现有片段组成活动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:35:08.790

我明白你的意思。。

您可以使用片段容器并替换片段，为选择回调定义接口。谷歌就是这样做的，我猜对于那些来自活动世界的人来说可能更清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-08T18:39:36.493

Rejinderi 的解决方案应该有效。我认为无论是那个实现还是谷歌的例子都是一个合理的选择。这取决于您要达到的目标。

就个人而言，我更喜欢谷歌的例子，原因如下：

1.  单独的活动意味着您使用活动回栈。在某些（大多数？）情况下，片段返回堆栈很好，但默认转换不同。出于用户体验的原因，您可能更喜欢其中一个。
2.  如果您想捕获一个意图，可能不清楚为什么`ActivityA`要捕获**JobB**。
3.  以我的经验，`FragmentB`没有处理的逻辑`FragmentA`（有点）不同，将其分解为自己的活动有助于分离该逻辑，并使所有内容更具可读性。
4.  菜单选项也可能发生变化。我再次发现逻辑的分离更加清晰。

# sql - 为什么外键是识别关系中主键的一部分？

> ID：13292050
> 
> 赞同：16
> 
> 时间：2012-11-08T15:26:55.323
> 
> 标签：sql, database-design, foreign-keys, primary-key

我试图理解一个概念，而不是修复一段不起作用的代码。

我将举一个**表单**（父表）和**表单域**（子表）的一般示例。**从逻辑上讲**，这将是一种识别关系，因为没有表单就不能存在表单域。

![form 和 form_field 表](../Images/af38a001deb34c7413bf369687b123a9.png)

这会让我认为，为了将**逻辑**关系转换为**技术**关系，`NOT NULL`form_field 表中的 form_id 字段的简单就足够了。（见上面截图的左边部分。）

但是，当我使用 MySQL Workbench 添加标识关系时，form_id 不仅`NOT NULL`是主键，而且还是主键的一部分。（请参见上面屏幕截图的右侧部分。）当我添加一个非识别关系时，`NOT NULL`仍然如此逻辑地应用它实际上也是一个识别关系。

我想这让我有点困惑，以及直到现在我总是简单地使用 id 字段作为主键的事实。

所以我理解识别与非识别关系的**逻辑**概念，但我不了解**技术**部分。

[正如这个答案](https://stackoverflow.com/a/762994/1001110)所说，为什么它是“使外键成为孩子主键的一部分的“正确”方法？

这些复合主键有什么好处？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T18:22:55.900

> 从逻辑上讲，这将是一种识别关系，因为没有表单就不能存在表单域。

不，识别关系是关于识别，而不是存在。

任何 X >= 1 的 X:Y 关系保证左侧的存在，无论是否识别。在您的情况下，1:N 关系保证存在`form`任何给定的`form_field`. 你可以让它识别或不识别，它仍然可以保证相同。

评论：

*   `form_field.form_id`您将通过制作密钥的一部分来模拟识别关系。例如`form_field`PK 可能看起来像：`{form_id, label}`，顺便说一句，这对于数据的正确[集群](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)非常有益（InnoDB 表[始终是集群](http://www.ovaistariq.net/521/understanding-innodb-clustered-indexes/)的）。
*   只做一个 PK:`{id, form_id}`是不正确的，因为这个超级密钥不是候选密钥（即它不是最小的——我们可以`form_id`从中删除并仍然保留唯一性）。
*   您可以通过使`form_field.form_id`NULL-able 来模拟 0..1:N 关系（但是您将无法使其也能够识别 - 见下文）。

“识别关系”有两种定义：

*   **严格定义**：将父键迁移到子主键¹的关系。
*   **松散定义**：将父键迁移到子键的关系。

换句话说，松散的定义也允许迁移到备用键（而不仅仅是主键）。

不过，大多数工具²似乎都使用严格的定义，因此如果您将关系标记为标识，这将自动使迁移的属性成为子 PK 的一部分，并且任何 PK 属性都不能为 NULL。

* * *

*¹或者完全由迁移的属性组成，或者是迁移的属性和一些附加属性的组合。*

*² ERwin 和 Visio 可以。我还没有使用 MySQL Workbench 进行建模，但您的描述似乎表明它的行为相同。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T18:01:30.970

识别关系应该是主键包含外键属性的关系。这就是为什么当您将关系指定为标识发布的外键时，它会被视为主键的一部分。

*如果*在每种情况下都适用相同的键约束和可空性约束，则“识别”关系和非识别关系之间的区别纯粹是信息性的或图解的。该概念类似于指定“主”键并且是指定“主”键的结果。如果一个表有多个候选键，那么所有其他条件都相同，从逻辑角度来看，哪个键被指定为主键并不重要——表的形式、功能和（可能）业务含义是相同的。

但是，在您的示例中，两个表中的键不相同。在第一种情况下，ID 在 form_field 表中是唯一的，而在第二种情况下显然不是。我想这不是你想要的。

# asp.net - 使用 Outlook 互操作

> ID：13292055
> 
> 赞同：2
> 
> 时间：2012-11-08T15:27:05.450
> 
> 标签：asp.net, outlook, interop

我编写了一个使用 Outlook 互操作创建会议请求的 DLL。这一切都适用于我的机器。

问题是，当我在服务器（未安装 Outlook）上运行它时，它会因 COM 错误而失败。我已将 DLL 复制到`bin`目录中，但仍然没有乐趣。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:32:27.640

使用 Microsoft Exchange Web 服务，特别是*Microsoft Exchange Web 服务 (EWS) 托管 API 1.1*，请参阅[http://msdn.microsoft.com/en-us/library/exchange/dd877071(v=exchg.140).aspx](http://msdn.microsoft.com/en-us/library/exchange/dd877071(v=exchg.140).aspx)。

这为您提供了 Outlook 的几乎所有功能，*而*无需安装*Outlook*。此外，部署是一个（或两个）程序集。

# windows - 向 Windows 7 登录屏幕添加按钮

> ID：13292060
> 
> 赞同：1
> 
> 时间：2012-11-08T15:27:11.860
> 
> 标签：windows, active-directory, credential-providers

我想为 Windows 7 用户实现自我重置密码功能。当登录屏幕提示域用户时，应显示忘记密码按钮，该按钮将打开密码重置向导。那么问题是如何将命令按钮添加到标准 Windows 登录屏幕？

我知道这里提到的 Windows XP 中的 GINA： [Adding command button to Windows Logon screen](https://stackoverflow.com/questions/1186900/adding-command-button-to-windows-logon-screen)

但是这个话题已经有 3 年的历史了，随着 Vista / Windows 7 微软提出了“Microsoft Windows Credential Provider”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T04:54:17.153

Those button are called "Tiles", and they are implemented in a Credential Provider. Anything you read about a Gina will not work in Vista or later.

Those tiles a created by the LogonUI.exe process, itself launched by Winlogon.exe. LogonUI.exe runs with high priviledges. You don't want to run anything there. Besides, any wizard you run will run under the system account. Security issues aside, anything that resets the password of the *current* user will not work.

But let's assume that you have a solution that can reset a user's password. Like a web site (or a local application) that :

1.  Ask for the user's name
2.  Ask some security questions
3.  Connects to Active Directory to reset the password

Then here is a way to implement the functionality.

Create a user, a domain user if possible. Give it a name and a password easy to remember, like "reset" and "reset". Make shure that everybody knows the password.

[Change the shell of that user](https://superuser.com/q/352865/84632) to Internet Explorer, that you would be running in kiosk mode, pointing to your web application.

Now when someone wants to reset their password, here is what they will do :

1.  Use the standard Windows Credential Provider, like they do every day, but with the user "reset" and the password "reset".
2.  Instead of the normal Windows shell, they will be presented with your password reset web application.
3.  The user resets their password and they are instructed to log off using `CTRL``ATL``DEL`
4.  They can log in with their own username and brand new password.

This idea can be improved upon if you are ready to write some code:

*   Instead of Internet Explorer, write a simple web application that wraps the web browser control. if the application is closed, or any other funny business, logoff.
*   Hack one of the Credential Provider samples to supply the well know password reset username and password, making password reset merely a click away
*   Change that password reset credential provider's image to reflect the password reset functionnality.

# javascript - 现代化 Jquery 阴影

> ID：13292062
> 
> 赞同：0
> 
> 时间：2012-11-08T15:27:18.597
> 
> 标签：javascript, jquery, jquery-easyui

您好，我找到了一个很棒的网站，我想使用该效果，这是链接[http://dotmick.com/](http://dotmick.com/)

我需要那些跟随鼠标并停在元素上的线条的帮助，有人可以帮助我吗，我不知道在哪里看，是否有一些类似的 jquery 动画，我想我在这里找到了， [http://dotmick .com/cms/site/themes/dotfolio/js/script.js](http://dotmick.com/cms/site/themes/dotfolio/js/script.js)

但是还是很复杂，一点点类似的例子就好了

提前 Txanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:38:43.080

它不是一个简单的 jquery 动画。不幸的是，这个没有“简单”的答案。值得庆幸的是，他们没有混淆他们的代码。下面是它的漂亮印刷版：

```
var spinner;
var fx = true;
var canvas;
var context;
var RADIUS = 205;
var RADIUS_SCALE = 1;
var RADIUS_SCALE_MIN = 1;
var RADIUS_SCALE_MAX = 1;
var QUANTITY = 40;
var particles;
var mouseX = 50;
var mouseY = 50;
var timeout = 0;
var looping = 0;
var erasingTotal = 3000;
var erasingCounter = 0;
var stopped = true;
var overThumb = false;
var prevMouseX, prevMouseY;
var prevScroll = 0;
var page = "home";
$(document).ready(function() {
    jQuery.extend(jQuery.browser, {SafariMobile: navigator.userAgent.toLowerCase().match(/iP(hone|ad|od)/i)});
    jQuery.extend(jQuery.browser, {iPhone: navigator.userAgent.toLowerCase().match(/iPhone/i)});
    if ($.browser.SafariMobile) {
        toggleFx()
    }
    if ($.browser.SafariMobile) {
        $("html").attr("class", "iphone")
    }
    $("div#preloader").css("height", $(document).height());
    $.fn.spin = function(d) {
        this.each(function() {
            var e = $(this), f = e.data("spinner");
            if (f) {
                f.stop()
            }
            if (d !== false) {
                d = $.extend({color: e.css("color")}, d);
                f = new Spinner(d).spin(this);
                e.data("spinner", f)
            }
        });
        return this
    };
    var b = {lines: 10,length: 0,width: 20,radius: 0,color: "#353535",speed: 1.6,trail: 63,shadow: false};
    var c = document.getElementById("preloader");
    spinner = new Spinner(b).spin(c);
    $(spinner.el).css("left", window.innerWidth * 0.5);
    $(spinner.el).css("top", (window.innerHeight - $(window).scrollTop()) * 0.5);
    window.addEventListener("resize", a, false);
    function a() {
        if ($("div#preloader").css("display") != "none") {
            $(spinner.el).css("left", window.innerWidth * 0.5);
            $(spinner.el).css("top", (window.innerHeight - $(window).scrollTop()) * 0.5);
            return
        }
    }
});
$(window).load(function() {
    $("nav#nav #nav_projects").css("pointer-events", "none");
    $("nav#nav #nav_projects").css("cursor", "default");
    $("nav#nav #nav_projects").css("opacity", "0.2");
    $(".projectThumbnail").each(function() {
        var n = $(this);
        n.css({position: "absolute"}).wrap("<div class='img_wrapper' style='display: inline-block'>").clone().addClass("img_grayscale").css({position: "absolute","z-index": "998",opacity: "0"}).insertBefore(n).queue(function() {
            var o = $(this);
            o.parent().css({width: this.width,height: this.height});
            o.dequeue()
        });
        this.src = d(this.src)
    });
    $(".projectPreview").click(f);
    function l() {
        overThumb = false;
        $("#upLink").animate({opacity: 0}, 500, "easeOutQuint", function() {
            $("#upLink").css("display", "none")
        });
        $("section#screens ul").animate({opacity: 0}, 500, "easeOutQuint", function() {
            $("section#works").css("height", "auto");
            $("section#screens ul li").each(function() {
                $(this).css("display", "none")
            })
        });
        $("section#works ul").animate({opacity: 0}, 500, "easeOutQuint", function() {
            $("#backLink").css("display", "none");
            $(".projectPreview").each(function() {
                $(this).css("display", "block")
            });
            $(window).scrollTop(prevScroll);
            $("section#works").css("width", "75%");
            page = "home";
            e();
            overThumb = true;
            mouseX = prevMouseX;
            mouseY = prevMouseY;
            $("section#works ul").animate({opacity: 1}, 500, "easeOutQuint", function() {
            })
        })
    }
    function f() {
        var p = $(this);
        var o = $(this).attr("id");
        var n = $(this).attr("id").split("_")[1];
        prevMouseX = $(this).offset().left + $(this).width() * 0.5;
        prevMouseY = $(this).offset().top - $(window).scrollTop() + $(this).height() * 0.5;
        prevScroll = $(window).scrollTop();
        recordOutboundLink(this, "Projects", n);
        page = "project";
        $("section#works ul").animate({opacity: 0}, 500, "easeOutQuint", function() {
            $(".projectPreview").each(function() {
                $(this).css("display", "none")
            });
            $("#backLink").css("display", "block");
            $("section#works").css("left", "30px");
            $("section#works").css("width", "250px");
            overThumb = true;
            mouseX = $("#backImg").offset().left + $("#backImg").width() * 0.5;
            mouseY = $("#backImg").offset().top - $(window).scrollTop() + $("#backImg").height() * 0.5;
            $("section#works ul").animate({opacity: 1}, 500, "easeOutQuint", function() {
                overThumb = false;
                $("section#screens ul li").each(function() {
                    if ($(this).attr("id") != "project_" + n) {
                        $(this).css("display", "none")
                    } else {
                        $(this).css("display", "block")
                    }
                });
                $("section#works").css("height", $("section#screens").height());
                if ($(document).height() > $(window).height() + 400) {
                    $("#upLink").css("display", "block");
                    $("#upLink").animate({opacity: 1}, 500, "easeOutQuint")
                }
                $("section#screens ul").animate({opacity: 1}, 500, "easeOutQuint")
            })
        })
    }
    function g() {
        overThumb = false;
        a();
        $("nav#nav #nav_about").css("pointer-events", "none");
        $("nav#nav #nav_about").css("cursor", "default");
        $("nav#nav #nav_about").animate({opacity: 0.2}, 500, "easeOutQuint");
        $("nav#nav #nav_projects").css("pointer-events", "auto");
        $("nav#nav #nav_projects").css("cursor", "auto");
        $("nav#nav #nav_projects").animate({opacity: 1}, 500, "easeOutQuint");
        if (page == "project") {
            $("section#screens ul").animate({opacity: 0}, 500, "easeOutQuint", function() {
                $("section#screens ul").css("display", "none")
            });
            if ($("#upLink").css("display") == "block") {
                $("#upLink").animate({opacity: 0}, 500, "easeOutQuint", function() {
                    $("#upLink").css("display", "none")
                })
            }
        }
        $("section#works").animate({opacity: 0}, 500, "easeOutQuint", function() {
            $("section#works").css("display", "none");
            $("section#about").css("display", "block");
            $("section#about").animate({opacity: 1}, 500, "easeOutQuint")
        })
    }
    function b() {
        $("nav#nav #nav_about").css("pointer-events", "auto");
        $("nav#nav #nav_about").css("cursor", "auto");
        $("nav#nav #nav_about").animate({opacity: 1}, 500, "easeOutQuint");
        $("nav#nav #nav_projects").css("pointer-events", "none");
        $("nav#nav #nav_projects").css("cursor", "default");
        $("nav#nav #nav_projects").animate({opacity: 0.2}, 500, "easeOutQuint");
        $("section#about").animate({opacity: 0}, 500, "easeOutQuint", function() {
            $("section#about").css("display", "none");
            $("section#works").css("display", "block");
            $("section#works").animate({opacity: 1}, 500, "easeOutQuint", function() {
                if (page == "project") {
                    $("section#screens ul").css("display", "block");
                    $("section#screens ul").animate({opacity: 1}, 500, "easeOutQuint");
                    if ($("#upLink").css("display") == "none" && $(document).height() > $(window).height() + 400) {
                        $("#upLink").css("display", "block");
                        $("#upLink").animate({opacity: 1}, 500, "easeOutQuint")
                    }
                }
            })
        })
    }
    $(window).scroll(function() {
        overThumb = false;
        a()
    });
    $(".projectThumbnail").mouseover(function() {
        $(this).parent().find("img:first").stop().animate({opacity: 1}, 500);
        overThumb = true;
        mouseX = $(this).offset().left + $(this).width() * 0.5;
        mouseY = $(this).offset().top - $(window).scrollTop() + $(this).height() * 0.5
    });
    $(".projectThumbnail").mouseout(function() {
        $(this).stop().animate({opacity: 0}, 500);
        overThumb = false
    });
    $("#backImg").mouseover(function() {
        overThumb = true;
        mouseX = $(this).offset().left + $(this).width() * 0.5;
        mouseY = $(this).offset().top - $(window).scrollTop() + $(this).height() * 0.5
    });
    $("#backImg").mouseout(function() {
        overThumb = false
    });
    $("#upImg").mouseover(function() {
        overThumb = true;
        mouseX = $(this).offset().left + $(this).width() * 0.5;
        mouseY = $(this).offset().top - $(window).scrollTop() + $(this).height() * 0.5
    });
    $("#upImg").mouseout(function() {
        overThumb = false
    });
    $("#fxToggle").click(toggleFx);
    $("#backLink").click(l);
    $("#nav #nav_about a").attr("href", "#");
    $("#nav #nav_about a").click(g);
    $("#nav #nav_projects a").attr("href", "#");
    $("#nav #nav_projects a").click(b);
    function m() {
        if (jQuery.browser.mozilla && jQuery.browser.version.slice(0, 3) == "1.9") {
            $(".projectThumbnail").each(function(n) {
                $(this).css("background-image", "url(" + $(this).attr("src") + ")");
                $(this).attr("src", "");
                $(this).attr("alt", "")
            })
        }
        $("html").css("display", "block");
        canvas = document.getElementById("bkgd");
        if (canvas != undefined) {
            context = canvas.getContext("2d");
            e()
        }
    }
    spinner.stop();
    m();
    $("div#preloader").animate({opacity: 0}, 2400, "linear", function() {
        $("div#preloader").css("display", "none");
        $("html").css("overflow-y", "auto");
        if (canvas != undefined) {
            window.addEventListener("resize", e, false);
            h();
            document.addEventListener("mousemove", c, false)
        }
    });
    function e() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        if (page == "project") {
            return
        }
        var p = window.innerWidth * 0.75;
        var o = Math.floor(p / 220);
        var n = (o == 1) ? 200 : (o - 1) * 220 + 200;
        $("section#works").css("left", (window.innerWidth - n) * 0.5)
    }
    function c(n) {
        if (!fx) {
            return
        }
        stopped = false;
        if (looping <= 0 && overThumb) {
            looping = setInterval(j, 40)
        }
        if (!overThumb) {
            stopped = true
        }
        clearTimeout(timeout);
        timeout = setTimeout(function() {
            stopped = true
        }, 3000)
    }
    function h() {
        particles = [];
        var n = 20;
        for (var o = 0; o < QUANTITY; o++) {
            var p = {position: {x: mouseX,y: mouseY},shift: {x: mouseX,y: mouseY},size: 0.2,angle: 0,speed: 0.01 + Math.random() * 1,targetSize: 0.2,fillColor: "rgba(" + n + ", " + n + ", " + n + ", 1.0)",orbit: RADIUS * 0.5};
            particles.push(p)
        }
    }
    function a() {
        stopped = true;
        var n = 0;
        clearInterval(looping);
        looping = 0;
        context.globalCompositeOperation = "destination-out";
        context.fillStyle = "rgba(239,239,239,1.0)";
        context.fillRect(0, 0, context.canvas.width, context.canvas.height);
        n++
    }
    function j() {
        RADIUS_SCALE = Math.min(RADIUS_SCALE, RADIUS_SCALE_MAX);
        context.globalCompositeOperation = "destination-out";
        context.fillStyle = "rgba(235,235,235,0.17)";
        context.fillRect(0, 0, context.canvas.width, context.canvas.height);
        if (stopped == true) {
            context.globalCompositeOperation = "lighter";
            context.fillStyle = "rgba(239,239,239,0.1)";
            context.fillRect(0, 0, context.canvas.width, context.canvas.height);
            erasingCounter += 40;
            if (erasingCounter >= erasingTotal) {
                clearInterval(looping);
                looping = 0;
                erasingCounter = 0
            }
            return
        }
        for (i = 0, len = particles.length; i < len; i++) {
            var o = particles[i];
            var n = {x: o.position.x,y: o.position.y};
            o.angle += o.speed;
            o.shift.x += (mouseX - o.shift.x) * (o.speed);
            o.shift.y += (mouseY - o.shift.y) * (o.speed);
            o.position.x = o.shift.x + Math.cos(i + o.angle) * (o.orbit * RADIUS_SCALE);
            o.position.y = o.shift.y + Math.sin(i + o.angle) * (o.orbit * RADIUS_SCALE);
            o.position.x = Math.max(Math.min(o.position.x, canvas.width), 0);
            o.position.y = Math.max(Math.min(o.position.y, canvas.height), 0);
            o.size += (o.targetSize - o.size) * 0.05;
            context.globalCompositeOperation = "source-over";
            context.beginPath();
            context.fillStyle = o.fillColor;
            context.strokeStyle = o.fillColor;
            context.lineWidth = o.size;
            context.moveTo((0.5 + n.x) | 0, (0.5 + n.y) | 0);
            context.lineTo((0.5 + o.position.x) | 0, (0.5 + o.position.y) | 0);
            context.stroke();
            context.arc((0.5 + o.position.x) | 0, (0.5 + o.position.y) | 0, o.size / 2, 0, Math.PI * 2, true);
            context.fill()
        }
    }
    function d(n) {
        var p = document.createElement("canvas");
        var v = p.getContext("2d");
        var q = new Image();
        q.src = n;
        p.width = q.width;
        p.height = q.height;
        v.drawImage(q, 0, 0);
        var o = v.getImageData(0, 0, p.width, p.height);
        o = k(o, 100, -50);
        for (var t = 0; t < o.height; t++) {
            for (var u = 0; u < o.width; u++) {
                var r = (t * 4) * o.width + u * 4;
                var s = (o.data[r] + o.data[r + 1] + o.data[r + 2]) / 3;
                o.data[r] = s;
                o.data[r + 1] = s;
                o.data[r + 2] = s
            }
        }
        v.putImageData(o, 0, 0, 0, 0, o.width, o.height);
        return p.toDataURL()
    }
    function k(s, n, p) {
        var r = s.data;
        for (var o = 0; o < r.length; o += 4) {
            r[o] = q(r[o], 0.2, 0.25);
            r[o + 1] = q(r[o], 0.2, 0.25);
            r[o + 2] = q(r[o], 0.2, 0.25)
        }
        function q(u, v, t) {
            u = u / 255;
            if (v < 0) {
                u = u * (1 + v)
            } else {
                u = u + ((1 - u) * v)
            }
            u = (u - 0.5) * (Math.tan((t + 1) * Math.PI / 4)) + 0.5;
            return u * 255
        }
        return s
    }
});
function toggleFx() {
    fx = !fx;
    $("#bkgd").css("display", (!fx) ? "none" : "block");
    $("#fxToggle a").text((fx) ? "fx enabled" : "fx disabled")
}; 
```

这里要寻找的关键变量是`overThumb`它看起来决定是否应该显示动画。例如：

```
$("#backImg").mouseout(function() {
    overThumb = false
});
$("#upImg").mouseover(function() {
    overThumb = true;
    mouseX = $(this).offset().left + $(this).width() * 0.5;
    mouseY = $(this).offset().top - $(window).scrollTop() + $(this).height() * 0.5
});
$("#upImg").mouseout(function() {
    overThumb = false
}); 
```

您可以看到，当鼠标悬停在缩略图上时，它会将其设置为`true`，否则为`false`。此代码中有一个计时器，它查看此变量并决定如何为粒子设置动画。我希望这有帮助！

# javascript - 使用状态机来保持我的 UI 简单灵活？好主意？我如何在 Knockout JS 中做到这一点？

> ID：13292063
> 
> 赞同：3
> 
> 时间：2012-11-08T15:27:25.607
> 
> 标签：javascript, knockout.js, state, state-machine, sammy.js

我是 Knockout JS 的新手。我应该使用 sammy.js 来帮助我完成以下任务吗？

我正在构建一个 Knockout JS 应用程序（单页），当我从一个状态移动到另一个状态时，哪些子面板是可见的以及它们所做的改变。例如：

*   登录前，我有一个邀请用户登录的大面板。

*   登录后，我有一堆标签，一个主要的搜索区域和一个底部的广告。

*   如果用户进行搜索，那么我最终会处于看到选项卡、搜索区域和搜索结果区域的状态。

我想通过让状态机在用户点击时从一个状态移动到另一个状态来做到这一点，就像解析器从一个状态移动到另一个状态一样。

我想象委托给当前状态，一个悬挂在 ViewModel 上的对象（也许），这样我的 20 个左右不同的状态几乎就像 20 个非常简单的不同 UI，每个 UI 都相互独立，简单、干净且易于理解。

1 - 我将如何做到这一点，让 UI 将子 UI 委托给挂在 ViewModel 上的子对象？

2 – 有没有更好的方法来保持我的 UI 简单，即使它有很多状态，并且不同的状态在哪些元素（子面板）可见时通常看起来彼此非常不同？

3 – 有没有人有代码重复委托给子用户界面的例子？

我说得有道理吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-03T19:45:32.173

一个可能非常适合的框架是[machina.js](http://freshbrewedcode.com/jimcowart/2012/03/12/machina-js-finite-state-machines-in-javascript/) - 应该正是您正在寻找的。

这是来自 jQuery UK 的一个演示文稿 -[有状态的机器](http://code.dougneiner.com/presentations/machina/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T19:39:12.317

我正在使用一种方案，其中我只有两个独立的状态可观察对象 - 一个用于总应用程序状态，一个用于当前“页面”（选项卡，或任何“页面对您意味着”）。在咖啡脚本中，例如：

```
@currentState('logged-in')
@currentPage('page-foo')
@applicationState = ko.computed => "#{@currentState()}:#{@currentPage()}" 
```

然后在您的淘汰赛可见绑定中，您可以匹配特定状态或子状态：

```
<div data-bind='visible: applicationState() == "logged-in:page-foo"> 
```

或者您可以进行部分匹配：

```
<div data-bind='visible: applicationState().endsWith("page-foo")'> 
```

# c# - 当返回一个 AJAXed 的局部视图时，我该如何显示错误消息

> ID：13292065
> 
> 赞同：0
> 
> 时间：2012-11-08T15:27:34.623
> 
> 标签：c#, asp.net-mvc, jquery, asp.net-mvc-2, partial-views

我有一些运行 ajax 的 jquery，它运行一个返回部分视图的控制器操作。在某些情况下，我想显示几个错误消息之一（由控制器控制），而不是用结果替换 DOM 元素。

我如何实现这一目标？

目前我有这个：

```
$.ajax({
    type: "POST",
    cache: false,
    url: '<%= Url.Action("AddPostcodeToTerritory", "Territories") %>'
}).done(function(data) {
    $("#SelectedTerritoryPostcodeRows").html(data);
}); 
```

我有`SelectedTerritoryPostcodeRows`通常获取信息的元素，但我也希望控制器能够提供一些我想在其他地方显示的错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:30:42.590

您没有返回任何错误，因此您需要在响应中添加一些标识符，以便您的脚本知道该做什么。也许另一个名为 errMsg 的元素和一个新的 if..then 在这个脚本中处理它会对它进行排序。

```
 if (data.errMSG) {
     ..show error somewhere
    }
    else {
      $("#SelectedTerritoryPostcodeRows").html(data);
    } 
```

# asp.net - 返回字符串的缓存控制器

> ID：13292077
> 
> 赞同：1
> 
> 时间：2012-11-08T15:28:34.993
> 
> 标签：asp.net, asp.net-mvc

由于某种原因，这不起作用：

```
 [OutputCache(Duration = 600, VaryByParam = "id")]
    public string GetSomeValue(int id)
    {
        return _service.GetSomeValue(id).ToString();
    } 
```

我在一个返回视图的控制器中对此进行了测试，它确实有效。

知道为什么吗？或任何可能的解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:36:49.093

属性必须放在 Action 本身而不是这个方法上

```
 [OutputCache(Duration = 600, VaryByParam = "id")]
   Public ActionResult Get(int id) 
```

根据您的评论，听起来您正在寻找服务器缓存。我会推荐 memcached 或 Redis 之类的东西，但同样你可以使用 IIS 中内置的缓存。请注意，您必须知道您的缓存何时应该被爆裂，以及如果您在网络场中，您将如何处理分发。以最简单的形式，你可以试试这个

```
public string GetSomeValue(int id)
{
  var cachedItem = HttpRuntime.Cache.Get(id.ToString());
  if(cachedItem==null){
     value = _service.GetSomeValue(id).ToString();
     cachedItem = HttpRuntime.Cache.Add(id.ToString(), value);
  }
  return cachedItem;
} 
```

Add 的完整选项让您有机会设置滑动或绝对到期

```
public object Add(
         string key, 
         object value, 
         System.Web.Caching.CacheDependency dependencies, 
         System.DateTime absoluteExpiration, 
         System.TimeSpan slidingExpiration, 
         System.Web.Caching.CacheItemPriority priority,  
         System.Web.Caching.CacheItemRemovedCallback onRemoveCallback) 
```

例如，为依赖项传递 null ，但根据需要设置过期时间。

# c# - 通过变量引用属性名称

> ID：13292078
> 
> 赞同：7
> 
> 时间：2012-11-08T15:28:39.287
> 
> 标签：c#, reflection, system.reflection

有没有办法用变量引用属性名称？

场景：对象 A 具有公共整数属性 X 和 Z，所以...

```
public void setProperty(int index, int value)
{
    string property = "";

    if (index == 1)
    {
        // set the property X with 'value'
        property = "X";
    }
    else 
    {
        // set the property Z with 'value'
        property = "Z";
    }

    A.{property} = value;
} 
```

这是一个愚蠢的例子，所以请相信，我对此很有用。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-08T15:31:28.940

简单的：

```
a.GetType().GetProperty("X").SetValue(a, value); 
```

请注意，如果 type of没有名为“X”的属性，则`GetProperty("X")`返回。`null``a`

要在您提供的语法中设置属性，只需编写一个扩展方法：

```
public static class Extensions
{
    public static void SetProperty(this object obj, string propertyName, object value)
    {
        var propertyInfo = obj.GetType().GetProperty(propertyName);
        if (propertyInfo == null) return;
        propertyInfo.SetValue(obj, value);
    }
} 
```

并像这样使用它：

```
a.SetProperty(propertyName, value); 
```

**UPD**

请注意，这种基于反射的方法相对较慢。为了获得更好的性能，请使用动态代码生成或表达式树。有很好的库可以为你做这些复杂的事情。例如，[快速会员](https://github.com/mgravell/fast-member)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T15:30:39.047

我认为你的意思是反射：

```
PropertyInfo info = myObject.GetType().GetProperty("NameOfProperty");
info.SetValue(myObject, myValue); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-08T15:32:01.263

不是按照您的建议方式，但是是的，它是可行的。您可以使用一个`dynamic`对象（甚至只是一个带有属性索引器的对象），例如

```
string property = index == 1 ? "X" : "Z";
A[property] = value; 
```

或者通过使用反射：

```
string property = index == 1 ? "X" : "Z";
return A.GetType().GetProperty(property).SetValue(A, value); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T15:45:17.027

我很难理解您要实现的目标...如果您尝试分别确定属性和值，并且在不同的时间，您可以将设置属性的行为包装在委托中。

```
public void setProperty(int index, int value)
{
    Action<int> setValue;

    if (index == 1)
    {
        // set property X
        setValue = x => A.X = x;
    }
    else
    {
        // set property Z
        setValue = z => A.Z = z;
    }

    setValue(value);
} 
```

# iphone - 比较字符串不起作用 - 真的很奇怪

> ID：13292083
> 
> 赞同：1
> 
> 时间：2012-11-08T15:28:49.580
> 
> 标签：iphone, xcode, ios6

无论出于何种原因，我似乎无法弄清楚我无法让我的代码正确比较两个字符串的原因。我有一个对象数组（包含字符串的配置文件：组），如果它的组与字符串不匹配，我只想删除此配置文件对象。

这就是我所拥有的：

Profile 对象 .h 文件：

```
@property (nonatomic, copy) NSString *group; 
```

一个控制器文件，它正在查看数组并转储不正确的配置文件 - 它的 .h 文件：

```
@property (nonatomic, copy) NSString *buttonSelected; 
```

这个 *buttonSelected 在用户选择按钮时设置，代码只是检查发送者标签并分配适当的字符串，如下所示：

```
[controller setbuttonSelected:@"My Button Has Been Selected"]; 
```

当我尝试比较此 buttonSelected 和数组对象时出现问题 - 这是具有组属性的配置文件对象：

```
_profileArray = [xmlParser profiles];

for(int i=0; i<[_profileArray count]; i++){
  NSLog(@"Comparing button: %@ and group: %@", [self buttonSelected], [[_profileArray objectAtIndex:i] group]);

  if([[self buttonSelected] isEqualToString:[[_profileArray objectAtIndex:i] group]]) NSLog(@"Equal");
} 
```

_profileArray 有 3 个对象，其中只有两个对象的组实际上等于 buttonSelected。所以我应该只让系统输出 2“Equal”，但它从不输出“Equal”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:22:11.497

想通了。我正在从不同的数组中清除空格等，而不是我用来比较字符串的数组，因此比较永远不会像他们应该的那样出现。清洁阵列后，我使用的一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:37:14.700

为什么不先将代码分解成更容易调试的部分，然后逐步完成它。我会做这样的事情。

```
NSString *buttonSelectedToCompareAgainst = [self buttonSelected];
NSLog(@"button selected was: %@", buttonSelectedToCompareAgainst);

NSString *profileGroupString;
NSComparisonResult compareResult;
for(Profile *profile in _profileArray){
 NSLog(@"Checking profile: %@", profile);

 profileGroupString = [profile group];
 NSLog(@"Checking profile group: %@", profileGroupString);

 compareResult = [buttonSelectedToCompareAgainst caseInsensitiveCompare:profileGroupString];

 NSLog(@"compare result: %d", compareResult);
} 
```

# android - 获取 Android OS 中已注册的待处理 Intent 列表

> ID：13292085
> 
> 赞同：7
> 
> 时间：2012-11-08T15:28:55.883
> 
> 标签：android

我注册了我计划在给定时间执行的警报，根据计划列表的大小，它可以是许多警报。但是我有两个问题我还不清楚：

1) 我如何在操作系统中查询我注册的 Pending Intents？我需要这个进行测试。我想要的伪代码是这样的：

```
List<PendingIntent> intentsInOS = context.getAllPendingIntentsOfType(AppConstants.INTENT_ALARM_SCHEDULE)); 
```

2）查看我创建的未决意图，我提供了一个操作和额外的数据（计划 ID）。

```
private Intent getSchedeuleIntent(Integer id) {

    Intent intent = new Intent(AppConstants.INTENT_ALARM_SCHEDULE);
    intent.putExtra(AppConstants.INTENT_ALARM_SCHEDULE_EXTRA, id);

    return intent;
} 
```

但是我们也说intent有FLAG_CANCEL_CURRENT。它会以相同的操作取消所有待处理的意图，还是必须同时执行相同的操作和额外的数据？

```
PendingIntent pendingIntent = PendingIntent.getBroadcast(context.getApplicationContext(), 0, getSchedeuleIntent(schedule.id), PendingIntent.FLAG_CANCEL_CURRENT); 
```

我的代码

```
@Override
public void run() {

    List<ScheduledLocation> schedules = dbManager.getScheduledLocations();
    if(schedules == null || schedules.isEmpty()){
        return;
    }

    AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
    //alarmManager.

    // we need to get the number of milliseconds from current time till next hour:minute the next day.
    for(ScheduledLocation schedule : schedules){

        long triggerAtMillis = DateUtils.millisecondsBetweenNowAndNext(now, schedule.hour, schedule.minute, schedule.day);
        PendingIntent pendingIntent = PendingIntent.getBroadcast(context.getApplicationContext(), 0, getSchedeuleIntent(schedule.id), PendingIntent.FLAG_CANCEL_CURRENT);

        alarmManager.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, triggerAtMillis, MILLISECONDS_IN_WEEK, pendingIntent);
    }

    // List<PendingIntent> intentsInOS = context.getAllPendingIntentsOfType(AppConstants.INTENT_ALARM_SCHEDULE));

}

private Intent getSchedeuleIntent(Integer id) {

    Intent intent = new Intent(AppConstants.INTENT_ALARM_SCHEDULE);
    intent.putExtra(AppConstants.INTENT_ALARM_SCHEDULE_EXTRA, id);

    return intent;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T15:45:13.640

## 1 如何在操作系统中查询我注册的待处理意图？

我不确定你可以，但你可以检查一个特定`PendingIntent`的是否已注册：

```
private boolean checkIfPendingIntentIsRegistered() {
    Intent intent = new Intent(context, RingReceiver.class);
    // Build the exact same pending intent you want to check.
    // Everything has to match except extras.
    return (PendingIntent.getBroadcast(context, 0, intent, PendingIntent.FLAG_NO_CREATE) != null);
} 
```

## 2 它会取消所有具有相同操作的待处理意图，还是必须同时执行相同操作和额外数据？

它将取消所有`PendingIntent`被解析为相等的。

究竟是什么**意思**？

android的java文档说：

> 出于意图解析（过滤）的目的，确定两个意图是否相同。也就是说，如果它们的动作、数据、类型、类和类别相同。这不会*比较*意图中包含的任何额外数据。

您可以在此处阅读 7391 行：[https ://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/content/Intent.java](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/content/Intent.java)

总而言之，`PendingIntent`除了附加功能之外，所有构建完全相同的东西都将被取消。

# php - JQuery Ajax - reload Image onClick 适用于 chrome 但不适用于 firefox 或 IE

> ID：13292087
> 
> 赞同：0
> 
> 时间：2012-11-08T15:28:56.750
> 
> 标签：php, jquery, ajax, firefox, google-chrome

好的，这很吓人......我正在尝试重新加载在服务器端生成的验证码图像，我不想为此重新加载整个页面，因此我必须使用 AJAX。所以我要做的是首先在服务器端（使用 AJAX）触发一个 php 文件，它会更新所有需要的东西，这样我就可以拥有一个新的验证码图像。然后，当这完成后，我只需更新图像 src=""，以从该 php 文件加载新图像。这里的代码：

* * *

*   **文件 1**

HTML：

```
<tr id="rowWithCaptcha">
                    <td><p><img id="captchaImg" src="./?<?php echo session_name() ?>=<?php echo session_id() ?>"/></p></td>
</tr> 
```

jQuery 脚本：

```
$("#reloadImg").click(function(){
           $.ajax({
              url: 'getNewKCAPTCHA.php',
              cache: false,
              type: 'POST',  
              async: false,
              success: function(){
                 $("#captchaImg").attr("src","http://localhost/Captcha2/TestPages/TestPage3Q/getNewKCAPTCHA.php?");
              }
           });
        }); 
```

* * *

*   **文件二：**

PHP：kcaptcha.php 是所有验证码魔法发生的地方 :) 所以如果你只是在浏览器中打开这个 php 文件，你就会得到验证码图像本身。如果您重新加载页面，图像每次都会更改......

```
 <?php include('kcaptcha.php'); session_start(); $captcha = new KCAPTCHA(); $_SESSION['captcha_keystring'] = $captcha-getKeyString(); echo TRUE; ?> 
```

* * *

所以现在奇怪的是，整个事情（AJAX 调用和图片更新）在新的 chrome 浏览器上工作得很好，但是当我用 FFOX 或 IE 尝试它时，它只工作一次，任何进一步的点击都不会改变任何东西。 ....我认为它与 JQuery 部分有关，但我无法让它工作：///

每一个帮助表示赞赏！提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:34:15.877

这可能与 HTML5 支持有关。我不久前遇到了同样的问题，似乎FF和IE都不支持

```
$('whatever').click(function(){});
```

但如果你在 html-tag 中使用 onclick="function()" 调用它，它可以工作，但我不知道它是否工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:05:55.563

假如说

```
url: 'getNewKCAPTCHA.php', 
```

和

```
http://localhost/Captcha2/TestPages/TestPage3Q/getNewKCAPTCHA.php? 
```

实际上是同一个脚本，没有必要调用它们两次。

考虑这个简单的方法（这是我在实际项目中使用的工作方法）：

```
$("#reloadImg").click(function(){
    var d = new Date ();
    var captcha = "http://localhost/Captcha2/TestPages/TestPage3Q/getNewKCAPTCHA.php?r=" + d.getTime ();
    $("#captchaImg").attr ("src", captcha);
}); 
```

[http://jsfiddle.net/hGfgn/](http://jsfiddle.net/hGfgn/)

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:39:14.123

我不是编辑 src 属性的忠实粉丝。我通常会删除图像（或替换为加载图像），然后附加新图像（并删除加载图像）。下面的代码应该删除图像并附加一个新图像 - 我错过了所有缓冲图像替换的东西

```
 $("#reloadImg").click(function(){
               $.ajax({
                  url: 'getNewKCAPTCHA.php',
                  cache: false,
                  type: 'POST',  
                  async: false,
                  success: function(){
                     $("#captchaImg").remove();
                     $("#rowWithCaptcha td p").append('<img id="captchaImg" src="http://localhost/Captcha2/TestPages/TestPage3Q/getNewKCAPTCHA.php?" />');

                  }
               });
            }); 
```

希望能帮助到你

# sql - sql日期差异问题

> ID：13292090
> 
> 赞同：1
> 
> 时间：2012-11-08T15:29:03.713
> 
> 标签：sql, sql-server-2008, telerik, telerik-grid

我正在研究 Telerik gridview，我应该在某些条件下显示警告，其中 1 个是：

如果到期日大于今天的日期并且警告天数为 3，那么它将显示所有到期日大于今天的记录，但只有当它们在警告期内出现时才会显示。

所以如果今天的日期是 22-12-2012 并且到期日是 25-12-2012 并且警告天数是 3 那么它应该选择该记录

到目前为止我尝试了什么：

```
 DateTime dtTodayDate = DateTime.Today;
   string strTodayDate = dtTodayDate.ToString("yyyy/MM/dd 00:00:00");
    strFilter += @"OR ( [DueDate] >= #" + strTodayDate + @"# AND [Warn_Days] > 0 AND [DueDate] - [Warn_Days] =#" + strTodayDate + @"# )"; 
```

无法对 System.DateTime 和 System.Int32 执行“-”操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:34:33.347

您使用了错误的分隔符，`#`由 Access 使用。对于 SQL Server，只需将日期作为常规字符串传递：

```
strFilter += @"OR ( [DueDate] >= '" + strTodayDate + @"' AND [Warn_Days] > 0 AND [DueDate] - [Warn_Days] ='" + strTodayDate + @"' )"; 
```

但是，您应该改用参数化查询——很有可能您会在某个时候传递一个模棱两可的字符串，而不会得到您认为得到的日期值。

# ruby-on-rails - 登录后重定向错误

> ID：13292093
> 
> 赞同：0
> 
> 时间：2012-11-08T15:29:19.740
> 
> 标签：ruby-on-rails, devise, cucumber

我有这个控制器。

```
class SessionsController < Devise::SessionsController
  # GET /resource/sign_in
  def new
    self.resource = build_resource(nil, :unsafe => true)
    clean_up_passwords(resource)
    respond_with(resource, serialize_options(resource))
  end

  # POST /resource/sign_in
  def create
    self.resource = warden.authenticate!(auth_options)
    set_flash_message(:notice, :signed_in, :username => resource.username) if is_navigational_format?
    sign_in(resource_name, resource)
   respond_with resource, :location => after_sign_in_path_for(resource)
 end
end 
```

黄瓜的这个步骤定义：

```
Given /^a user "(.*?)" exists$/ do |user_name|
    @user = User.create!(:username => user_name , :password => "tamara")
end

When /^he logs in$/ do 
  visit("/users/sign_in")
  fill_in('Username', :with => "roelof")
  fill_in('Password', :with => "tamara")
  click_button('Sign in')
end

Then /^he should see "(.*?)"$/ do |message|
  page.should have_content(message)
end 
```

只有在成功登录后一切正常，我才重定向到主页而不是登录成功页面。所以我没有看到闪存消息。

罗洛夫

编辑 1：我检查了控制器和资源名称，资源似乎具有正确的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T16:51:36.850

after_sign_in_path_for 的标准 DeviseHelper 是 signed_in_root_path

```
 # The scope root url to be used when he's signed in. By default, it first
  # tries to find a resource_root_path, otherwise it uses the root_path. 
```

您可以检查您的路线和范围，甚至可以通过使用调试器行将 Devise signed_in_root_path 复制到您的 ApplicationController 中进行调试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T09:23:53.353

默认情况下，Devise 的内部`after_sign_in_path_for(resource)`方法首先尝试在会话中找到有效的 {resource}_return_to 键，然后回退到 {resource}_root_path，否则它使用您的根路径路由。

例如，`user_root_path`成功登录后设置将在用户范围内设置直接路径（可能是您想要的）：

```
# config/routes.rb
...
devise_for :users do
 get 'users', :to => 'users#show', :as => :user_root 
end 
```

甚至：

```
# config/routes.rb
...
match 'user_root' => 'users#show' 
```

通过覆盖来覆盖成功登录时的重定向的另一种方法`after_sign_in_path_for(resource)`：

```
# app/controllers/application_controller.rb
...
def after_sign_in_path_for(resource)
  # Put some path, like:
  current_user_path
end 
```

供您阅读的链接：

*   [如何：成功登录后重定向到特定页面](https://github.com/plataformatec/devise/wiki/How-To%3a-Redirect-to-a-specific-page-on-successful-sign-in-out)
*   [方法：设计::Controllers::Helpers#after_sign_in_path_for](http://rubydoc.info/github/plataformatec/devise/master/Devise/Controllers/Helpers%3aafter_sign_in_path_for)
*   [如何：在用户编辑其个人资料后自定义重定向](https://github.com/plataformatec/devise/wiki/How-To%3a-Customize-the-redirect-after-a-user-edits-their-profile)
*   [如何：在销毁会话（即退出）后更改重定向路径](https://github.com/plataformatec/devise/wiki/How-To%3a-Change-the-redirect-path-after-destroying-a-session-i.e.-signing-out)

# scheme - 从方案到 R5RS 的 add1 函数

> ID：13292094
> 
> 赞同：2
> 
> 时间：2012-11-08T15:29:19.613
> 
> 标签：scheme, racket, r5rs

我已经编写了一些代码，但它不起作用，因为`add1`我在 Scheme 中使用的函数不适用于 R5RS。`add1`R5RS可以替代什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T15:38:32.177

过程`add1`很简单，你可以自己实现：

```
(define (add1 x)
  (+ x 1)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T15:26:44.943

迟到的答案，但另一种选择是*（使用 lambdas）* ..

```
(define add1 
    (lambda (x)
        (+ x 1))) 
```

# directx - VMR9 分配器和 SwapEffect.Discard

> ID：13292096
> 
> 赞同：0
> 
> 时间：2012-11-08T15:29:25.803
> 
> 标签：directx, directshow.net

我正在使用 VMR9 分配器开发应用程序。

分配器允许我将 directshow 过滤器图形输出绘制到纹理。我注意到，如果我不在独占模式下使用*SwapEffect.Copy*，我的视频速率将低于 25（标称速率）。

我需要使用*SwapEffect.Discard*来激活多重采样。

是否有任何解决方法可以将 vmr9 分配器与*SwapEffect.Discard*一起使用？

# c++ - MSXML XSLT 解析器版本

> ID：13292097
> 
> 赞同：0
> 
> 时间：2012-11-08T15:29:29.140
> 
> 标签：c++, msxml, msxml6, msxml3

我有一个 C++ 应用程序，它使用 msxml6.dll 来读取 XML 文件并应用 XSLT。通过在我的一个 XSLT 文件中包含以下内容，我确定 MSXML v3.0 用于 XSLT：

```
<vendor><xsl:value-of select="system-property('xsl:vendor')"/></vendor>
<version><xsl:value-of select="system-property('ms:version')"/></version> 
```

我不明白为什么使用 MSXML v3.0 而不是 MSXML v6.0。应用程序需要更改哪些内容才能使用 MSXML v6.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T07:59:51.443

创建 msxml 对象时，明确指定版本。在 vba 中是这样的：

```
set xml = CreateObject("MSXML2.DomDocument.6.0") 
```

Microsoft 不鼓励在不指定版本的情况下使用 MSXML：[Why Version-Independent GUIDs and ProgIDs were Removed](http://msdn.microsoft.com/en-us/library/windows/desktop/ms761415%28v=vs.85%29.aspx)。

# payment-gateway - 验证新的 CIM 付款配置文件

> ID：13292099
> 
> 赞同：2
> 
> 时间：2012-11-08T15:29:30.547
> 
> 标签：payment-gateway, authorize.net, authorize.net-cim

我刚刚开始`liveMode`使用 C# CIM SDK 测试我的应用程序。

我的印象是，添加过期或 cvv 不正确的新信用卡会引发错误，`liveMode`因为它是无效的。

但是，我可以使用无效的卡号、到期时间和/或 cvv 组合创建新的信用卡。

我什至可以成功地`Authorize`只创建交易。在我尝试创建`AuthoirizeAndCapture`交易之前，我没有收到错误，因为它被拒绝了。

我不想创建新的付款资料，对其执行`AuthorizeAndCapture`操作，如果付款资料被拒绝，则删除该付款资料，或者如果每次创建新的付款资料时交易都通过，则该交易无效。

我究竟做错了什么？验证新 CIM 付款配置文件的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T18:12:36.230

`liveMode`将 0.00 美元（如果处理器尚不支持 0.00 美元交易，则为 0.01 美元）连同信用卡信息一起发送给将其作为正常交易运行的处理器。重要的是要知道无效的到期日期或 CVV 号码不一定会*导致*信用卡被拒绝。一些信用卡发卡机构将批准过期日期无效的交易，并且无效的 CVV 号码也不会导致拒绝。如果不正确，您只会收到结果通知，然后您必须决定是否要接受交易。我不确定 CIM 是否可行，因此无效的 CVV 编号在这里不是因素。

如果您真的想在创建 CIM 配置文件之前验证信用卡，您可以使用 AIM API 进行 0.00 美元的交易，然后检查 CVV 结果代码响应。

# node.js - 使用 node.js 移动文件

> ID：13292101
> 
> 赞同：2
> 
> 时间：2012-11-08T15:29:33.743
> 
> 标签：node.js

假设我有一个文件“ */tmp/sample.txt* ”，我想将它移动到不同卷中的“ */var/www/mysite/sample.txt ”。*

如何在 node.js 中移动文件？

我读到*fs.rename*仅在同一卷内有效，而*util.pump*已被弃用。

正确的方法是什么？我读到了stream.pipe，但我无法让它工作。一个简单的示例代码将非常有帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-08T15:46:01.457

使用[mv 模块](https://npmjs.org/package/mv)：

```
var mv = require('mv');

mv('source', 'dest', function(err) {
    // handle the error
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-11T13:53:44.050

如果在 Windows 上并且没有“mv”模块，我们可以这样做吗

```
var fs = require("fs"),
    source = fs.createReadStream("c:/sample.txt"),
    destination = fs.createWriteStream("d:/sample.txt");

source.pipe(destination, { end: false });
source.on("end", function(){
    fs.unlinkSync("C:/move.txt");
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T15:53:29.880

mv 模块，就像 jbowes 所说的那样，可能是正确的方法，但是您可以使用子进程 API 并使用内置的 OS 工具作为替代方案。如果你在 Linux 中使用“mv”命令。如果您在 Windows 中，请使用“移动”命令。

```
var exec = require('child_process').exec;
exec('mv /temp/sample.txt /var/www/mysite/sample.txt', 
  function(err, stdout, stderr) {
    // stdout is a string containing the output of the command.
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-13T14:09:29.337

如果 exec 不能正常工作，您也可以使用 spawn。

```
var spawn = require("child_process").spawn;
var child = spawn("mv", ["data.csv","./done/"]);
child.stdout.on("end", function () {                
    return next(null,"finished")
}); 
```

希望这可以帮助你。

# jsf - 使用 Beans 的页面中的导航和内容管理是否安全？

> ID：13292103
> 
> 赞同：1
> 
> 时间：2012-11-08T15:29:38.797
> 
> 标签：jsf, jakarta-ee, jsf-2, javabeans, facelets

实际上我是 JSF 和 Facelets 和企业应用程序的新手，尽管我在过去 4 个月一直在研究它，无论如何，我正在开发一个具有登录、用户管理员和文档管理员的网页（它有更多但没关系），我必须根据每个用户的权限来管理页面的访问和内容。阅读有关安全性的内容后，我发现了许多登录方法，但我使用 Stateful Beans 制作了自己的方法，以便在应用程序中维护用户数据以供以后使用，这样我就可以限制内容。问题是......这是根据用户限制管理内容的正确方法吗？如果没有，哪种方法是最好和最安全的？

这是我的 Stateful Bean（我没有包括 Getter 和 Setter）

```
 @ManagedBean
    @Stateful
    public class HandlerLogin implements Serializable{

    @EJB
    private LoginMethodsLocal loginMethods;

    private String loginNickname;
    private String loginPassword;
    private String userData[];
    //[0]=Nickname
    //[1]=Name
    //[2]=User Type

    private boolean loguedIn= false;

    public void check(){

    System.out.println(this.loginNombre);
    System.out.println(this.loginContrasena);

    this.userData= loginMethods.Login(this.loginNickname, this.loginPassword);
    //the method loginMethods.Login() queries in the database looking for
    //"this.loginNickname" and "this.loginPassword"

    if (this.userData!=null){

        this.loguedIn=true;

    }
    else{

        this.loguedIn= false;
        FacesContext.getCurrentInstance().addMessage("mensajesLogin", new FacesMessage("Error, User Does not Exist"));
    }
}

public void closeSession(){

    this.userData=null;
} 
} 
```

所以我管理内容和导航的逻辑是检查什么样的用户，并根据它确定访问和渲染的方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:45:19.357

`@Stateful`注释在 JSF中没有**任何**`@ManagedBean`作用。只有当类本身被注入`@EJB`到*另一个*托管 bean 或 EJB 中时，才会真正使用该注释，即便如此，将创建和使用所有属性设置为默认值的全新且完全不同的实例。所以`@Stateful`注释绝对不会像你认为的那样做。删除它，在这种情况下没有任何意义。

剩下的代码是否正确，取决于具体的功能需求。有许多同样好的和安全的方法（假设您*了解*您实际编写的代码）。问题更多：你想重新发明多少轮子？内置容器管理的身份验证为细粒度控制留下了很小的空间，但如果它对您来说足够了，那么只需使用它而不是自己自制身份验证。

浏览以下相关答案应该会给出一些好主意：

*   [使用 j_security_check 在 Java EE / JSF 中执行用户身份验证](https://stackoverflow.com/questions/2206911/best-way-for-user-authentication-on-javaee-6-using-jsf-2-0)
*   [JSF：如何在 JSF 中控制访问和权限？](https://stackoverflow.com/questions/12516349/jsf-how-control-access-and-rights-in-jsf)
*   [如何检查用户是否登录？](https://stackoverflow.com/questions/8374368/how-to-check-if-is-user-logged-in)
*   [如何正确使用 isUserInRole(role)](https://stackoverflow.com/questions/6524788/how-to-properly-use-isuserinrolerole)
*   [JSF 请求范围的 bean 不断在每个请求上重新创建新的有状态会话 bean？](https://stackoverflow.com/questions/8887140/jsf-request-scoped-bean-keeps-recreating-new-stateful-session-beans-on-every-req)

# python - 我有一个以不同扩展名结尾的字符串列表，我将如何告诉 Python 不打印 .zip 字符串

> ID：13292105
> 
> 赞同：1
> 
> 时间：2012-11-08T15:29:43.230
> 
> 标签：python, python-2.7

所以我有一个作为文件路径的字符串列表，我只想打印不以 .zip 结尾的路径。我不能使用 glob 或 os，因为这是一个列表，并且不是通过 os.chdir("/mydir") 找到的。这是我尝试过的，但它不起作用。

```
list = ['/user/adi/test.zip', '/user/adi/test.csv', /user/adi/testing.zip, /user/adi/testing.txt]
for lis in list:
    if lis not in ['.zip']:
        print lis 
```

无论如何让我这样做？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T15:31:44.320

你可以使用：

```
if not lis.endswith('.zip'):
   print lis 
```

[`os.path.splitext`](http://docs.python.org/2/library/os.path.html#os.path.splitext)也可能有用，具体取决于您在做什么。

* * *

正如评论中所指出的，如果您要过滤列表，您可以简单地使用上面的表达式作为列表理解的一部分：

```
list_without_zip = [ x for x in list_with_zip if not x.endswith('.zip') ] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T15:34:09.057

```
print filter(lambda x:not x.endswith(".zip") , my_list) 
```

或者如果你想让它看起来一样......

```
print "\n".join(filter(lambda x:not x.endswith(".zip") , my_list)) 
```

# wordpress - 使用 .htaccess 将 example.com/about.php 重定向到 example.com/about/

> ID：13292107
> 
> 赞同：-2
> 
> 时间：2012-11-08T15:29:48.800
> 
> 标签：wordpress, .htaccess, redirect

我最近将我的网站切换到了 Wordpress。我的旧文件是 www.example.com/about.php，现在是 www.example.com/about/。我需要将来自 .php 扩展名的传入链接重定向到我所有页面的 / 最好使用 .htaccess。

我有的：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [NC,L] 
```

我的 .htaccess 文件中有什么：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

我想我也不知道将它放在我的 .htaccess 文件中的什么位置。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:53:06.933

您拥有的代码**不会**重定向任何内容。它接受一个可能针对 php 文件的请求并在内部附加`.php`扩展名。浏览器上什么也没有发生，因为你没有告诉它做任何事情。这是一个两步过程。[有关简短说明](https://stackoverflow.com/a/11711948/851273)，请参阅此答案的顶部。

为了重定向，您需要匹配传入请求，而不是 URI（可能已被以前的规则或迭代重写）：

```
RewriteCond %{THE_REQUEST} ^(GET|HEAD|POST)\ /(.*)\.php($|\ )
RewriteCond %{REQUEST_URI} !wp-admin
RewriteRule ^ /%2/ [L,R=301] 
```

因此，当有人`http://www.example.com/about.php`在浏览器的 URL 地址栏中键入时，请求将如下所示：

```
GET /about.php HTTP/1.1 
```

并且**%2**反向引用`about`并将浏览器重定向到`http://www.example.com/about/`（注意尾部斜杠）并且地址栏发生更改。

然后发生的事情是浏览器*发出另一个请求*，但这次是为了`http://www.example.com/about/`服务器获取 URI `/about/`。现在您需要您的规则在内部将其重写回 php 文件。不幸的是，你的规则不处理斜杠，所以你需要这样的东西：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/(.*?)/?$
RewriteCond %{DOCUMENT_ROOT}/%1.php -f
RewriteRule ^ /%1.php [L] 
```

这些都将**在**您的 wordpress 规则之前进行。wordpress 规则将所有内容路由到`index.php`，这会破坏您尝试重写的任何 URI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:21:30.933

你做错了事。您实际上是将没有 php 结尾的 url 重写为以 .php 结尾的文件。

你需要做这样的事情：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*).php$ $1/ [NC] 
```

我还删除了检查您要重定向到的文件是否存在以及 [L] 标志，因为 wordpress 很可能也在进行自己的重写，这意味着您不希望这是处理的最后一条规则并且您将无法在文件系统上找到该文件。

# c# - 如何从 C# 启动 JVM

> ID：13292108
> 
> 赞同：1
> 
> 时间：2012-11-08T15:29:56.327
> 
> 标签：c#

我想从 C# 启动一个 java 应用程序，但不确定正确的方法。我可以从 bat 文件中做到这一点：

```
java -cp ".;other_classes_location" classname 
```

这如何变成 C#？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:32:30.617

您发布的是命令行（可能在命令外壳中执行）

你**不能**把它变成 C# 代码

我猜您正在寻找一种使用 C# 执行该命令的方法。在这种情况下，答案是下面的代码

```
System.Diagnostics.Process.Start("yourPath\java.exe", "Command Line Arguments"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:32:13.770

使用 Process.Start。[这里](http://www.dotnetperls.com/process-start)的例子。

# jquery - 视图中的 MVC 侦听器

> ID：13292110
> 
> 赞同：0
> 
> 时间：2012-11-08T15:29:58.597
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3

目前，我从视图发出 ajax 请求（每个间隔）以从控制器获取响应并相应地更新视图元素。有没有办法以其他方式翻转它？那就是让视图上的侦听器和控制器会触发一个事件来更新视图？任何例子都非常感谢。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:54:20.477

查看 XSockets.NET。

您可以轻松地将数据从控制器推送到您的视图。它使用 websockets 并支持 .NET 4。如果您需要，我可以为您提供示例，但在 git 上有一些 witten [enter link description here](https://github.com/codeplanner)

如果您需要更多示例，我明天可以在 git 上添加一个。

问候乌夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:56:06.333

当然，请参阅 SignalR [https://github.com/SignalR/SignalR](https://github.com/SignalR/SignalR) 这是一个非常酷的项目，它允许服务器端推送。

您还可以调查 WebSockets，SignalR 在 WS 之前没有使用它，但是我认为它被重写（如果还没有）以使用 WebSockets，因为它们现在是标准的。

# asp.net-mvc - 分层数据和 LINQ - 最佳实践

> ID：13292112
> 
> 赞同：1
> 
> 时间：2012-11-08T15:30:12.310
> 
> 标签：asp.net-mvc, linq, entity-framework, linq-to-sql

想象一下，当您有一个包含用户的表时，我们的用户具有层次结构。

```
[Key]
public virtual int UserId { get; set; }

public virtual UserProfile UserParent { get; set; }
public virtual int? UserParentId { get; set; }
public virtual String UserName { get; set; } 
```

将样本数据放在那里：

**用户 ID 用户父 ID 用户名**

*   1 | 空 | 老板
*   2 | 1 | 戴安娜经理
*   3 | 2 | 工人山姆
*   4 | 2 | 工人鲍勃
*   5 | 1 | 黄经理
*   6 | 5 | 卢工人

为每个用户分配一把铲子：P

```
[Key]
public virtual int ShovelId { get; set; }

public virtual string ShovelSerialNumber { get; set; }
public virtual int UserId { get; set; } 
```

将样本数据放在那里：

**ShovelId ShovelSerialNumbe UserId**

*   1 | 12345BK | 3
*   2 | 99999ZK | 4
*   3 | 88888KP | 6

这一切的目的是获取铲子的序列号，对用户表进行分层查询。老板会看到所有的铲子，但只有铲子管理下属员工。

关于如何在 LINQ 中实现这一点的任何想法和提示，考虑到可能有数千名员工和数千名铁锹，并且不知道凹陷层次结构的深度。

谢谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:37:07.813

第 1 步：使用您的 ORM（例如 linqToSql）加载记录。通过正确的设置，记录之间的所有关系都将自动存在。

Step2：使用普通代码遍历内存树：

```
 public static IEnumerable<T> WalkTreeBreadthFirst<T>(this IEnumerable<T> source, Func<T, IEnumerable<T>> childFunction)
    {
        // http://en.wikipedia.org/wiki/Breadth-first_search
        HashSet<T> seenIt = new HashSet<T>();
        Queue<T> toVisit = new Queue<T>();

        foreach (T item in source)
        {
            toVisit.Enqueue(item);
        }

        while (toVisit.Any())
        {
            T item = toVisit.Dequeue();
            if (!seenIt.Contains(item))
            {
                seenIt.Add(item);
                foreach (T child in childFunction(item))
                {
                    toVisit.Enqueue(child);
                }
                yield return item;
            }
        }
    }

    public static IEnumerable<T> WalkTreeDepthFirst<T>(this IEnumerable<T> source, Func<T, IEnumerable<T>> childFunction)
    {
        // http://en.wikipedia.org/wiki/Depth-first_search
        HashSet<T> seenIt = new HashSet<T>();
        Stack<T> toVisit = new Stack<T>();

        foreach (T item in source.Reverse())
        {
            toVisit.Push(item);
        }

        while (toVisit.Any())
        {
            T item = toVisit.Pop();
            if (!seenIt.Contains(item))
            {
                seenIt.Add(item);
                foreach (T child in childFunction(item).Reverse())
                {
                    toVisit.Push(child);
                }
                yield return item;
            }
        }
    } 
```

例如：

```
List<Person> bosses = tree.GetBossesByID(3, 4, 5);
List<Shovel> shovels = bosses
  .WalkTreeBreadthFirst(x => x.Subordinates)
  .Select(p => p.Shovel)
  .ToList(); 
```

# c# - 使用表达式树过滤

> ID：13292123
> 
> 赞同：0
> 
> 时间：2012-11-08T15:30:46.167
> 
> 标签：c#, entity-framework, linq-to-entities, expression-trees

我需要根据传递给函数的参数查询数据库和过滤器。我正在传递两个日期参数（用作日期范围）、一个名称和一个状态参数。所有参数都可以有“和”或“或”条件。基本上，我想根据填充的参数构建一个 linq 表达式，并将其传递给实体框架以返回结果集。

如何使用最少的“if”语句来做到这一点？如果您能善意地为您的示例代码提供解释，那就太棒了。我正在尝试学习表达式树，因此解释会有所帮助。

在这一点上，我没有太多代码。这就是我在这里发帖的原因。我可以列出方法签名。你到底在找什么？

```
public enum EmployeeStatus
{
    FullTime,
    PartTime,
    Contract
}

public IEnumerable<Employee> FilterEmployees(DateTime? startDate, 
    DateTime? endDate, string employeeName, EmployeeStatus employeeStatus)
{   } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T15:53:26.963

```
public IQueryable<Employee> FilterEmployees(IQueryable<Employee> query, DateTime? startDate, DateTime? endDate, string employeeName, EmployeeStatus employeeStatus)
{
    if (startDate != null)
        query = query.Where(x => x.StartDate >= startDate);

    // etc...

    return query;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T02:13:30.640

*所有参数都可以有“和”或“或”条件。*- 您可以考虑使用 PredicateBuilder。请参阅[http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)。为什么？因为这允许您编写单个查询，但仅在需要时添加 AND/OR 谓词。您可能需要也可能不需要此功能，但要注意这是一个很好的功能。在实际调用查询之前没有数据库开销 - 它提供了一种有条件地构建 IQueryable 的方法，您可能不想在某些条件下匹配字段。例如，前几天我在输入字符串少于 10 个字符的搜索中使用它来忽略产品代码字段 - 最小长度为 10。

这将允许您使用 if 条件添加 AND/OR 语句，如下所示：

```
public IQueryable<Employee> FilterEmployees(IQueryable<Employee> query, DateTime startDate, DateTime endDate, string employeeName, EmployeeStatus employeeStatus)
{
    var predicate = PredicateBuilder.True<Employee>();

    //All names starting with 'A'
    predicate = predicate.And(x => x.Name.StartsWith("A"));

    //Add a condition only if the employee is PartTime
    if (employeeStatus == EmployeeStatus.PartTime)
    {
        //Add condition for when they start
        predicate = predicate.And(x => x.StartDate >= startDate);
    }
    else
    {
        //Say we don't care about the start date for the other employee statuses,
        //but we want to add condition for when non-part-time employees are due to leave
        predicate = predicate.And(x => x.EndDate <= endDate);
        //or their name ends in 'z'
        predicate = predicate.Or(x => x.Name.EndsWith("z"));
    }

    IQueryable<Employee> employees = query.FindBy(predicate); //you should probably use a repository here to return your query

    return employees

} 
```

注意 - 这旨在作为伪代码进行演示并且可能有错误 - 请参阅上面的链接以获取正确的实现。

# c - 通过 TCP 在结构中发送未知长度字符串的聪明方法？（C，Linux）

> ID：13292125
> 
> 赞同：0
> 
> 时间：2012-11-08T15:30:47.483
> 
> 标签：c, networking, tcp, struct, char

我正在 Linux 上用 C 语言实现一个简单的服务器/客户端。可以说，作为客户端，我想询问服务器是否有特定文件。我希望能够将我的查询发送到结构内的服务器（我更熟悉此操作的问题，但它是家庭作业）。

我的问题是，在使用结构时，我无法为文件名预先分配内存。所以形式的结构：

```
struct{
int operation;
char *fileName;
long fileSize;
}; 
```

对我没有帮助，因为即使我为 fileName 分配内存，它也`sizeof(struct)`保持不变，`(sizeof(char*)+sizeof(fileSize))`所以我无法将它发送到服务器。

希望我在这里很清楚......我的问题是如何使用 struct 向服务器发送一个未知大小的字符串。（一种选择是提前发送 fileSize，然后发送该大小的 char*，但我不想这样做）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T18:19:01.883

不确定我是否理解您的问题。但这是一种仍然使用您的结构并在最后打包文件名的方法。这里重要的是您需要为结构分配足够的字节+结构之后隐藏的文件名数据。

```
#include <string.h>
#include <stdlib.h>
#include <stdio.h>

typedef struct
{
    // put any data you want here
    // ...
    size_t fileNameLength;
    char fileName[0]; // fake array, used to access extra bytes allocated after the struct
} FileInfo;

int main (int argc, char **argv)
{
    FileInfo *fi = NULL;

    // The fake array has size 0 !
    printf ("sizeof FileInfo is %d\n", sizeof (FileInfo));

    // let's suppose you've guessed your filename
    char filename[] = "homework.txt";
    size_t filename_length = strlen (filename); // this is the length with no NULL byte
    printf ("filename length (without NULL byte) is %d\n", filename_length);

    fi = malloc (sizeof(FileInfo) + filename_length);
    fi->fileNameLength = filename_length;
    memcpy (&fi->fileName, filename, filename_length);

    printf ("filename is %.*s\n", fi->fileNameLength, fi->fileName);

    // To send your struct + filename, just use the same address (fi),
    // but don't use as length sizeof (FileInfo), but this length:
    size_t struct_total_length = sizeof (FileInfo) + fi->fileNameLength;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:34:43.863

您可以将发送拆分为 3 个命令 - 操作 (int)、文件名长度 (int)、文件名 (0..n 字符)。

```
typedef struct Cmd{
    int operation;
    char *fileName;
    long fileSize; /* not required here but was in the question */
} Cmd;

Cmd cmd;
...
send(sockfd, &cmd.operation, sizeof(cmd.operation), 0);
size_t len = strlen(cmd.fileName);
send(sockfd, &len, sizeof(len), 0);
send(sockfd, fileName, len, 0); 
```

如果您的作业要求您使用单个发送命令，请为所有三个分配一个足够大的缓冲区，然后复制到其中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:55:06.277

您不想将结构从一台机器发送到另一台机器以及潜在的字节序问题，您还可能面临这样的问题：一台机器上的结构布局可能与不同平台上的结构布局不同.

你想要的是：

```
 Client side                                     Server side 
```

将 struct 转换为数据流 ---(1)----> 将数据流转换为 struct

然后，您只需为数据流的语法定义合同 (1) 定义文件名前面有它们的长度似乎是合理的，或者发送文件名 null 终止。

正如codewarrior所说，硬连线最大文件名很少是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T19:13:18.183

您需要“序列化”数据。编码长度，写入长度，编码字符串（这通常是无操作），写入字符串。

发件人：

```
uint32_t net_length = htonl(strlen(filename)+1);  // include trailing NUL
send(socket, &net_length, 4);
send(socket, filename, strlen(filename)); 
```

接收方（伪代码）：

```
char buffer[whatever]
until have at least 4 bytes in buffer {
  got = recv(socket, buffer+have, sizeof(buffer)-have);
  have += got
}
uint32_t length = ntohl(*(uint32_t*)buffer)
until have at least length+4 bytes in buffer {
  got = recv(socket, buffer+have, sizeof(buffer)-have);
  have += got
}
char* filename = &buffer[4] 
```

这使用了一个不理想的固定大小的接收缓冲区，但它说明了这个想法。你最好只阅读直到你有长度（4个字节），然后`malloc()`用来获得一个足够大的缓冲区来保存文件名并将其余部分直接读入其中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T15:38:33.853

我认为在您的情况下，没有比首先发送文件长度然后发送其名称更好的解决方案了。

您还可以使用 struct 如下（不预先发送大小）

```
#define LONG_ENOUGH_FOR_FILE_NAME 128 //this defined to what you need
struct{
  int operation;
  char fileName[LONG_ENOUGH_FOR_FILE_NAME];
  long fileSize;
}; 
```

但这是一个非常脆弱的解决方案。您的文件名可能长于

> LONG_ENOUGH_FOR_FILE_NAME

缓冲区大小，这将导致一些严重的问题。

# html - 我的 HTML5 代码不起作用

> ID：13292127
> 
> 赞同：0
> 
> 时间：2012-11-08T15:30:54.960
> 
> 标签：html, canvas

我用 JavaScript 编写了以下 HTML5 代码，这正是 HTML5 Canvas 的一个示例，但它在我的浏览器中不起作用。我在 Safari、Firefox 和 Opera 中尝试过。找了几次错误，改正了一些小错误，但还是不行。

请检查它，让我知道错误可能是什么。

```
<!doctype html>
<html lang="en">
<head>
    <title>test</title>
    <script src = "modernizr-1.6.min.js"></script>
    <script type="text/javascript">
        window.addEventListener("load", eventWindowLoaded, false);
        var Debugger = function() {};
        Debugger.log = function(message){
            try{
                console.log(message);
            } catch (exception){
                return;
            }
        }
        function eventWindowLoaded(){
            canvasApp();
        }
        function canvasSupport(){
            return Modernizr.canvas;
        }
        function canvasApp(){
            if (!convasSupport()){
                return;
            }
            var theCanvas = document.getElementById("canone");
            var context = theCanvas.getContext("2d")

            Debugger.log("Nooooooooooooooooo");

            function drawScreen(){

                //background
                context.fillStyle="#ffffaa";
                context.fillRect=(0,0,500,500);

                //text
                context.fillStyle="#000000";
                context.font="20px_sans";
                context.textBaseline="top";
                context.fillText("hello world", 250, 100);

                //image
                var image = new Image();
                image.src = "lund.jpg";
                image.onload = function(){
                    context.drawImage(image, 160, 130);
                }

                //box
                context.strokeStyle = "#000000";
                context.strokeRect(20, 50, 490, 290);
            }
        drawScreen();
        }
    </script>
</head>
<body>
<div style="position:absolut;top:50px;left:50px;">
    <canvas id="canone" width ="500" height ="300">
        your browser does not support html5
    </canvas>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:36:03.797

我没有对此进行测试，但我可以看到 1 个错误：

```
 if (!convasSupport()){
            return;
 } 
```

没有convasSupport函数，应该是canvasSupport()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:34:45.953

`Uncaught ReferenceError: convasSupport is not defined`

您需要在调试时打开开发人员窗口并查看存在的错误。

你有一个错字。它应该是 canvasSupport，而不是 convasSupport。

在您喜欢的浏览器中搜索调试 JavaScript。有很多内置工具可以帮助您立即发现此类错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T15:40:45.273

我*确实*测试了它，拼写错误`canvasSupport`确实是问题所在。

“我多次查找错误”到底是什么意思？您需要加载 JavaScript 错误控制台（Chrome 或 Firefox 上的 ctrl-shift-J）以查看那里打印的内容；未定义的函数（因为您输入了错误的名称）在那时很容易调试。

# java - 带有 servlet、jsp 和数据库的应用程序的结构

> ID：13292130
> 
> 赞同：0
> 
> 时间：2012-11-08T15:31:05.787
> 
> 标签：java, database, jsp, jakarta-ee, servlets

我刚刚开始学习 servlet 和 jsp 的工作原理，但恐怕我需要一些帮助。

我正在编写的应用程序主要将包含一个页面，该页面显示人员列表以及他们所学的课程。如果单击课程条目，将打开一个文本字段，可以在其中插入评估。列表示例：

*   组 1

    *   安妮
        *   现代舞
        *   html & css
    *   亨利
        *   山地骑行
        *   航行
*   组2

    *   凯特
        *   html & css
        *   准备寿司
    *   ...

在我的数据库中，还有针对人员的表格，以及针对课程、小组和评估的表格。

我现在的主要问题是当有人点击课程条目时找出课程、评估和人员的数据库 ID。

我想我必须在设置列表时将 id 存储在 jsp 中的某个位置，但是：在哪里？

-> 在 html 中喜欢`<li id="1"...>`? 在查看页面源代码时可以看到所有 id 是否存在安全问题？必须保护报告免受未经授权的更改。

-> Bean 更有意义吗？

-> 一些我还不知道的有趣结构？

是什么阻止我在对 servlet 的 GET 调用中使 id 可见？

将这些数据发送到处理我的数据库查询的 servlet 是一种优雅的方式？（我认为在 MVC 模式中将 servlet 作为 Controller 并将 jsps 作为 Views 是个好主意？！）

如您所见，我不太确定如何构建我的应用程序。你能帮我得到一个更好的概述吗？

非常感谢您！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:38:06.630

对于您关于在 JSP 上存储 Id 的问题，我认为这是一个坏主意。Bean 更好地做到这一点，您可以使用 jstl 轻松创建所需的列表以及使用 bean 创建的对象列表。它看起来像：

```
<ul>
<c:forEach var="grp"  items="${Group}">
            <li>
                 ${grp}

                 <ul>
                      <c:forEach var="pers"  items="${Person}">
                          <li>
                               ${pers}

                                ect...
                          </li>
                       </c:forEach>
                 </ul>
            </li>
        </c:forEach>
</ul> 
```

有很多方法可以做你想做的事。

MVC 模式是一个真正的好主意。您可以将 Spring MVC 之类的框架用于模型，将带有 Hibernate JPA 的视图用于数据访问对象层。这些框架管理所有实体的配置和集成，并且有很多很好的教程来学习它们。

您也可以使用 Ajax 来获取数据，但它不尊重面向对象的编程。

# asp.net - 在 Azure 模拟器或云中未调用 Application_End

> ID：13292134
> 
> 赞同：2
> 
> 时间：2012-11-08T15:31:19.687
> 
> 标签：asp.net, azure, azure-web-roles

删除部署或重新启动实际生产 Web 角色时，不会调用 ASP.NET Web 应用的 Application_End 方法。

卸载应用程序时，我需要执行清理操作（如删除动态服务总线订阅）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-15T15:13:21.080

我遇到了同样的问题，我设置了一个不太理想的解决方法 Inspired by [this thread](http://social.msdn.microsoft.com/Forums/windowsazure/en-US/691ce449-88e4-4512-ad50-a65ac2f36402/applicationend-is-not-called-in-the-emulator-or-in-the-cloud)。

在 WebRole OnStop 处理程序中，调用它以回收角色 VM 上的所有应用程序池：

```
var p = Process.Start("cmd.exe", Environment.ExpandEnvironmentVariables(@"/C %windir%\system32\inetsrv\appcmd list apppool /xml | %windir%\system32\inetsrv\appcmd.exe recycle apppool /in"));
p.WaitForExit(); 
```

（您需要通过`<Runtime executionContext="elevated" />`直接添加到 WebRole 节点下的 csdef 文件来确保您的 Web 角色以提升的权限运行）

注意：一定要通过角色重启和缩减操作来测试你的关闭代码；[我发现像数据库连接这样的东西在缩减期间可能不起作用](https://stackoverflow.com/a/17679915/251011)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T22:15:06.413

我不知道为什么 Application_End 没有在您的 Web 角色上被调用（或者看起来不像被调用），但您应该使用 Application_End 来清理您的实例。这可能意味着您的代码在多个场合运行（例如每次循环），而这不是必需的。

清理操作应该在 OnStop 方法中的 WebRole.cs 中进行。但请注意，[您的清理操作时间有限](http://msdn.microsoft.com/en-us/library/windowsazure/gg433030.aspx)。

# sql - Oracle 数据泵导入现有表

> ID：13292135
> 
> 赞同：0
> 
> 时间：2012-11-08T15:31:26.130
> 
> 标签：sql, oracle, datapump, impdp

我需要一种有效的方法将数据从一个数据库复制到另一个数据库。两者都基于 Oracle 11g。

1.  步骤：（重新）创建新表
2.  步骤：安装 pl sql 包
3.  步骤：使用 expdp 从数据库 1 中导出表 tab_old1 和 tab_old2
4.  步骤：使用 impdp 导入 tab_new1 和 tab_new2 数据库 2
5.  +x 步骤：使用已安装的 pl sql 程序

挑战：pl sql 过程已经使用了 tab_new1 和 tab_new2。因此，我在第 1 步和第 2 步中创建了两个表。在第 3 步和第 4 步中，我只导入和导出数据。但是 tab_new1 和 tab_new2 有额外的列 -> 导入失败。我试图创建没有新列的视图。

导入失败并显示以下错误消息：

```
ORA-31693: Table data object "Schema"."tab_old1" failed to load/unload and is being skipped due to error:
ORA-31603: object “tab_old1” of type TABLE not found in schema “Schema” 

ORA-31693: Table data object "Schema"."tab_old2" failed to load/unload and is being skipped due to error:
ORA-31603: object “tab_old2” of type TABLE not found in schema “Schema” 
```

这些视图称为 tab_old1 和 tab_old2，但它们当然不是 TABLE 类型。

有任何想法吗？

如何从包含附加列的现有表中的 tab_old1 导入数据？

我不想在第一步中导出/导入表，重命名它们，然后安装 pl sqls 程序。

你可以帮帮我吗？

**编辑：**

感谢您的回答。我尝试了您的示例两次，但 remap_table 函数对我不起作用。导入：发布 11.1.0.6.0 - 64 位生产。

**编辑2：** 是的。这似乎是我的oracle版本的问题。remap_table 函数被忽略。我可以写像 remap_table=not.existing/table 这样的废话，而 impdp 对此毫不在意。好吧，我没有时间解决这个问题。我必须努力工作。无论如何，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:44:02.030

好的，所以您使用 content=data_only 进行导入，并且您已将 tab_old1 重命名为 tab_new1 并添加了几列？

指定导入时放 remap_table=tab_old1:tab_new1

只要新列可以为空，这将起作用。

例如：

```
SQL> create table foo(id number);

Table created.

SQL> insert into foo select rownum from dual connect by level <= 5;

5 rows created.

SQL> commit;

Commit complete.

SQL> host expdp test/test tables=foo directory=data_pump_dir

Export: Release 11.2.0.2.0 - Production on Thu Nov 8 15:40:18 2012

Copyright (c) 1982, 2009, Oracle and/or its affiliates.  All rights reserved.

Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
Starting "TEST"."SYS_EXPORT_TABLE_01":  test/******** tables=foo directory=data_pump_dir 
Estimate in progress using BLOCKS method...
Processing object type TABLE_EXPORT/TABLE/TABLE_DATA
Total estimation using BLOCKS method: 64 KB
Processing object type TABLE_EXPORT/TABLE/TABLE
. . exported "TEST"."FOO"                                5.031 KB       5 rows
Master table "TEST"."SYS_EXPORT_TABLE_01" successfully loaded/unloaded
******************************************************************************
Dump file set for TEST.SYS_EXPORT_TABLE_01 is:
  /u01/app/oracle/admin/dtd64bit1/dpdump/expdat.dmp
Job "TEST"."SYS_EXPORT_TABLE_01" successfully completed at 15:40:30

SQL> delete from foo;

5 rows deleted.

SQL> alter table foo add (a varchar2(200));

Table altered.

SQL> alter table foo rename to foo2;

Table altered. 
```

和你原来的错误？

```
SQL> host impdp test/test tables=foo directory=data_pump_dir content=data_only

Import: Release 11.2.0.2.0 - Production on Thu Nov 8 15:42:17 2012

Copyright (c) 1982, 2009, Oracle and/or its affiliates.  All rights reserved.

Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
Master table "TEST"."SYS_IMPORT_TABLE_01" successfully loaded/unloaded
Starting "TEST"."SYS_IMPORT_TABLE_01":  test/******** tables=foo directory=data_pump_dir content=data_only 
Processing object type TABLE_EXPORT/TABLE/TABLE_DATA
ORA-39034: Table TABLE_DATA:"TEST"."FOO" does not exist.
ORA-39126: Worker unexpected fatal error in KUPW$WORKER.UPATE_TD_ROW_IMP [15] 
TABLE_DATA:"TEST"."FOO"
ORA-31603: object "FOO" of type TABLE not found in schema "TEST"

ORA-06512: at "SYS.DBMS_SYS_ERROR", line 105
ORA-06512: at "SYS.KUPW$WORKER", line 8641 
```

所以重新映射..

```
SQL> host impdp test/test tables=foo remap_table=foo:foo2 directory=data_pump_dir content=data_only

Import: Release 11.2.0.2.0 - Production on Thu Nov 8 15:42:33 2012

Copyright (c) 1982, 2009, Oracle and/or its affiliates.  All rights reserved.

Connected to: Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options
Master table "TEST"."SYS_IMPORT_TABLE_02" successfully loaded/unloaded
Starting "TEST"."SYS_IMPORT_TABLE_02":  test/******** tables=foo remap_table=foo:foo2 directory=data_pump_dir content=data_only 
Processing object type TABLE_EXPORT/TABLE/TABLE_DATA
. . imported "TEST"."FOO2"                               5.031 KB       5 rows
Job "TEST"."SYS_IMPORT_TABLE_02" successfully completed at 15:42:37

SQL> select * from foo2;

ID     A
---------- ----------
     1
     2
     3
     4
     5 
```

# sql - SQL: 查找所有课程，其中注册学生的集合是已注册某个课程 C 的学生的超集

> ID：13292136
> 
> 赞同：0
> 
> 时间：2012-11-08T15:31:26.290
> 
> 标签：sql, superset

我正在考虑学生数据库中的 sql 查询：student(sid,sname),course(cid,cname),enrol(sid,cid)

找出所有课程，其中注册学生的集合是已注册某个课程的学生的超集 C

这个查询将如何编写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:48:11.337

我在这里找到了类似的东西[Best DB (MySQL) structure: Articles which contains favorite tags](https://stackoverflow.com/questions/900337/best-db-mysql-structure-articles-which-contain-favored-tags)。但并不像您所期待的那样高效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:49:22.900

```
Select S.sid, s.sname
from student s 
join enrol e on e.sid = s.sid
join course c on c.cid = e.cid
where c.name = 'c1' 
```

# jquery - 使用 FancyBox 单击链接时更改弹出窗口的图像

> ID：13292141
> 
> 赞同：0
> 
> 时间：2012-11-08T15:31:46.487
> 
> 标签：jquery, jquery-ui, jquery-plugins, fancybox, fancybox-2

我有一个页面，其中包含几个链接 ( `<a>`)，页面中包含 ( ) 内的图像`<img>`。我希望在单击图像时出现两列弹出窗口，显示单击的图像。我的问题是，下面的代码只显示了第一张图片，点击第二张图片时它什么也没做。任何想法如何解决它？提前致谢！吉列尔莫。

**链接html**

```
 <table class="tableHouse">
        <tr align="center" >
            <td>
                <span class="thumbnailTitle">Table</span>
            </td>
            <td>
                <span class="thumbnailTitle">Chair</span>
            </td>
        </tr>
        <tr class="spaceUnder">
            <td>
                <div><a id="thumbnailTitleLink" href="#popup_wrapper" name="table"><img id="imgTable" alt="Table" src="images/house/table_thumb.png"/></a></div>
            </td>
            <td>
                <div><a id="thumbnailTitleLink" href="#popup_wrapper" name="chair"><img id="imgChair" alt="Chair" src="images/house/chair.png"/></a></div>
            </td>
        </tr>
    </table> 
```

然后，当单击超链接时，我想显示一个两列弹出窗口，左侧是项目符号，右侧是图像，如下所示：

```
<div id="popup_wrapper" class="popup_wrapper">
    <div class="popup_left_box">
        <div id="tablePopupText" class="popupText">
            <span class="popupTitle">Table</span>
            <ul>
                <li>Description 1</li>
                <li>Description 2</li>
                <li>Description 3</li>
            </ul>
        </div>
        <div id="chairPopupText" class="popupText">
            <span class="popupTitle">Chair</span>
            <ul>
                <li>Description 1</li>
                <li>Description 2</li>
                <li>Description 3</li>
            </ul>
    </div>
</div> 
```

**两列的 CSS**

```
div.popup_wrapper{
    width: 670px;
}

div.popup_left_box{
    float: left;
    padding: 10px;
    width: 310px;
}

div.popup_right_box{
    float: right;
    padding: 10px;
    width: 310px;
} 
```

**最后是让魔法发生的 js 脚本**

```
$(document).ready(function () {

    $(".popupText").each(function() {
        $(this).hide();
    });

$(".popupImage").hide();

$("#thumbnailTitleLink").each(function() {
    var name = $(this).attr("name");
    var srcImage = "";
    var altImage = "";

    var img = $(this).find("img"), 
    len = img.length; // check if they exist
    if( len > 0 ){
        // images found, get id
        altImage = img.first().attr("alt");
        srcImage = img.first().attr("src");
    }

    $(this).fancybox({
        hideOnContentClick : false,
        autoScale: false,
        transitionIn : "elastic",
        transitionOut: 'elastic',
        easingIn : 'easeOutCirc',
        overlayColor : "#1e72b1",
        overlayOpacity : .4,
        opacity: false,
        speedIn : 950,
        titleShow: false,
        scrolling: "no",
        orig: img,
        onComplete : function() {
            $(".popupText").each(function() {
                $(this).hide();
            });
            $(".popupImage").show();

            $('#popup_wrapper').show();

            $('#imgPopup').alt = altImage;
            $('#imgPopup').src = srcImage;
            $('#' + name + 'PopupText').show();
        },
        openEffect  : 'elastic',
        closeEffect : 'elastic',
        helpers : {
            title : {
                type : 'inside'
            }
        }
    });
} );

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T04:34:00.100

最后，有几个错误。首先，它不是 id="thumbnailTitleLink" 它是 class="thumbnailTitleLink"。

然后我做了一些改变，可以在我的回答中[看到](https://stackoverflow.com/questions/13225604/fancybox-as-popup-and-image-moving-effect)

# c# - 将 double 转换为 int，它是舍入还是仅去除数字？

> ID：13292148
> 
> 赞同：32
> 
> 时间：2012-11-08T15:32:01.310
> 
> 标签：c#, casting, int, double, rounding

用双打进行一些计算，然后需要将其转换为 int。所以我有一个简单的问题，当将双倍说 7.5 转换为 int 时，它将返回 7。

这是四舍五入的产物还是只是小数点后的任何内容？

如果它是四舍五入的乘积，它是否聪明，即 0.1 到 0.5 向下舍入，0.6 到 0.9 向上舍入？

干杯

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-08T15:33:40.807

它不四舍五入，它只返回小数点前的整数部分。

参考（感谢[Rawling](https://stackoverflow.com/users/215380/rawling)）[**显式数字转换表**](http://msdn.microsoft.com/en-us/library/yht2cx7b.aspx)：

> 当您将 double 或 float 值转换为整数类型时，该值会朝零舍入到最接近的整数值。

您可以通过编写简单的测试自己尝试这样的简单问题。以下测试（使用[NUnit](http://nunit.org/)）将通过，因此可以回答您的问题：

```
[Test]
public void Cast_float_to_int_will_not_round_but_truncate
{
    var x = 3.9f;
    Assert.That((int)x == 3); // <-- This will pass
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-08T15:42:03.687

不要被假设它向下舍入而被愚弄。它去掉小数点并纯粹返回双精度的整数部分。这对于负数很重要，因为从 2.75 向下取整会得到 2，但从 -2.75 向下取整会得到 -3。铸造不会向下取整，因此 (int)2.75 给出 2，但 (int)-2.75 给出 -2。

```
double positiveDouble = 2.75;
double negativeDouble = -2.75;

int positiveInteger = (int) positiveDouble;
int negativeInteger = (int) negativeDouble;

Console.WriteLine(positiveInteger + " = (int)" + positiveDouble);
Console.WriteLine(negativeInteger + " = (int)" + negativeDouble);

Console.ReadLine();

//Output: 2 = (int)2.75
//        -2 = (int)-2.75 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-08T15:37:35.933

简单地投射只是去除小数点后的所有内容。要向上或向下舍入，您可以使用[Math.Round() 方法](http://msdn.microsoft.com/en-us/library/ms131275.aspx)。这将向上或向下舍入，并提供一个关于如果中途该怎么做的参数。您还可以使用[Math.Floor()](http://msdn.microsoft.com/en-us/library/k7ycc7xh.aspx)或[Math.Ceiling()](http://msdn.microsoft.com/en-us/library/zx4t0t48.aspx)方法在强制转换之前隐式向上或向下舍入。这里有些例子：

```
double num1 = 3.5;
double num2 = 3.2;
double num3 = 3.9;

(int)num1 // returns 3;
(int)num2 // returns 3;
(int)num3 // returns 3 also;
(int)Math.Round(num1) // returns 4
(int)Math.Round(num2) // returns 3
(int)Math.Round(num3) // returns 4
(int)Math.Floor(num1) // returns 3
(int)Math.Floor(num2) // returns 3
(int)Math.Floor(num3) // returns 3
(int)Math.Ceiling(num1) // returns 4
(int)Math.Ceiling(num2) // returns 4;
(int)Math.Ceiling(num3) // returns 4; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-08T15:34:37.507

它需要整数部分

```
double d = 0.9;
System.Console.WriteLine((int)d); 
```

结果为 0

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-08T15:52:55.073

像这样的普通演员

```
int number;
double decimals = 7.8987;

number = (int)decimals; 
```

将返回 number = 7。那是因为它只是跳过了最不重要的数字。如果您希望它正确舍入，您可以像这样使用**Math.Round()**：

```
number = (int)Math.Round(number); 
```

这将返回数字 = 8。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-08T15:49:13.820

来自[C# 语言规范](http://msdn.microsoft.com/en-us/library/ms228593.aspx)：

> 在`unchecked`上下文中，转换总是成功的，并按如下方式进行。
> 
> • 如果操作数的值为 NaN 或无穷大，则转换结果是目标类型的未指定值。
> 
> • 否则，源操作数向零舍入到最接近的整数值。如果这个整数值在目标类型的范围内，那么这个值就是转换的结果。
> 
> • 否则，转换结果是目标类型的未指定值。

另请参阅[显式数字转换表 - MSDN 上的备注](http://msdn.microsoft.com/en-us/library/yht2cx7b.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-08T15:34:22.117

如果它返回 7 作为 7.5 的两倍，那么它不是四舍五入，因为四舍五入规则会规定任何 5 及以上的值都向上舍入，而不是向下舍入。

# asp.net-mvc - 带有“可更新”经典 asp 脚本的 Azure 网站

> ID：13292154
> 
> 赞同：0
> 
> 时间：2012-11-08T15:32:23.757
> 
> 标签：asp.net-mvc, azure, asp-classic

一位客户正在考虑将他们的经典 asp 网站重新开发为 MVC4 并托管在 Azure 上。问题是他们有大量的经典 asp 报告，他们希望继续使用。他们将希望或多或少地像现在一样继续添加和修改经典的 asp 脚本——通过 ftp。

我知道可以在 Azure 中启用经典 asp。我的问题是在多实例环境中，经典的 asp 开发人员（没有 .NET 或 Azure 知识）如何将新脚本上传到 Azure，而无需上传整个 Azure 应用程序。他可以上传到 blob 存储并且我可以将新脚本拉入本地存储吗？如果可能的话，这些脚本可以通过网络访问吗？

非常感谢，尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T08:50:38.757

这是相当容易实现的，但需要在您（MVC/Azure 开发人员）方面做一些额外的工作。首先是将所有经典 ASP 文件上传到 blob 容器中。有各种免费和付费工具可以帮助您。接下来，您可以让您的经典 ASP 开发人员编辑文件并上传到 blob 本身。

接下来是您身边的核心工作。您可以扩展[RoleEntryPoint 类](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx)并将您的实现添加为项目的一部分。在那个类中，你有一个[Run 方法](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx)，它永远不会退出，因此是`while(true)`循环。在那个无限循环中，您可以决定睡 1、5 或 10 分钟。接下来在每次迭代中，您可以检查 blob 中的 ASP 文件的新版本并下载（如果有）。您必须找到将文件下载到的适当位置，因为您的[RoleEntryPoint 实现将不在运行您网站的 IIS 进程中，而是在单独的 WaIISHost.exe 进程中](http://blogs.msdn.com/b/windowsazure/archive/2010/12/02/new-full-iis-capabilities-differences-from-hosted-web-core.aspx)。关于[如何确定站点根目录](https://stackoverflow.com/questions/2555668/how-to-programmatically-get-sites-list-and-virtual-dirs-in-iis-7)有[多种方法](https://stackoverflow.com/questions/4345508/how-can-i-get-the-webrole-site-root-path-from-roleentrypoint-onstart)。

我强烈建议这种方法，而不是带有 VM（IaaS）的方法。

# php - 从 XML Feed 获取总页数

> ID：13292158
> 
> 赞同：1
> 
> 时间：2012-11-08T15:32:28.670
> 
> 标签：php, xml

您好我有一个简单的 XML 提要，它以如下所示的格式返回数据

```
 <Computers>
  <results totalPages="18" currentPage="18" totalResults="88"/>
  <computer id="1" name="IBM">
  <computertype id="1" name="Windows"/>
  </computer>
  <computer id="94" name="Acer">
  <computertype id="1" name="windows"/>
  </computer>
  <computer id="1533" name="selfbuild">
  <computertype id="1" name="windows"/>
  </computer>
  </computers> 
```

显示结果我使用以下

```
foreach($xml->computer as $computer){
 echo $computer['name']; 
```

我想要做的是将总页数、当前页数和总结果的结果放入变量中，我遇到的问题是，当我尝试如下编写它们时，它没有返回结果。

```
 echo $results['totalPages']; 
```

我认为这是因为 foreach 是在结果部分之后开始的，但是如果我尝试将它们写如下，我又什么也得不到。

```
 foreach($xml->results as $results){
  echo $results['totalPages']; 
```

任何意见，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:49:52.987

您正在尝试访问节点的属性。

这样做，使用 SimpleXML：

```
$xml = <<<XML
  <Computers>
  <results totalPages="18" currentPage="18" totalResults="88"/>
  <computer id="1" name="IBM">
  <computertype id="1" name="Windows"/>
  </computer>
  <computer id="94" name="Acer">
  <computertype id="1" name="windows"/>
  </computer>
  <computer id="1533" name="selfbuild">
  <computertype id="1" name="windows"/>
  </computer>
  </Computers>
XML;

$xml = simplexml_load_string($xml);

foreach($xml->results->attributes() as $a => $b) {
    echo $a,'="',$b,"\"<br>";
} 
```

输出以下内容：

> totalPages="18"
> currentPage="18"
> totalResults="88"

或者直接访问每个属性：

```
echo $xml->results->attributes()->totalPages; 
```

# javascript - 检索多个重复的keyDown

> ID：13292161
> 
> 赞同：0
> 
> 时间：2012-11-08T15:32:30.163
> 
> 标签：javascript, keyboard, windows-8, onkeydown, createjs

我正在尝试为 2 名玩家做一个简单的乒乓球游戏。

第一个用 A 和 Q（azerty 键盘）控制他的打击垫。第二个用 P 和 M 控制他的打击板。

这是代码

```
function handleKeyDown(e) {
    switch (e.keyCode) {
        case KEYCODE_ESC:
            break;
        case KEYCODE_UP:
            p1Bitmap.y = p1Bitmap.y - 10;
            break;
        case KEYCODE_DOWN:
            p1Bitmap.y = p1Bitmap.y + 10;
            break;
        case KEYCODE_A:
            p1Bitmap.y = p1Bitmap.y - 10;
            break;
        case KEYCODE_Q:
            p1Bitmap.y = p1Bitmap.y + 10;
            break;
        case KEYCODE_P:
            p2Bitmap.y = p2Bitmap.y - 10;
            break;
        case KEYCODE_M:
            p2Bitmap.y = p2Bitmap.y + 10;
            break;
    }
} 
```

问题是当玩家 1 按下 A 而玩家 2 按下 M 时，第一个玩家的键被忽略。

有可能重复多个关键事件吗？（例如玩家 1 A 和玩家 2 MI 想要得到这个：AMAMAMAMAMAMAMAMAMAMAMetc 而不仅仅是 AMMMMMMMMMMMMMMM）

顺便说一句，我正在为 Windows 8 应用程序 (html/css/js) 和 CreateJS 执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:41:18.550

您可以继续移动，直到检测到相应的`keyup`事件。开始`keydown`前行，不要停止直到`keyup`。

另外，应该注意的`keydown`是不同于`keypress`. `keydown`只会触发一次，无论您按住键多久。 `keypress`另一方面，每次插入（或将要插入）字符时都会触发，因此只要您按住键，就会看到重复的事件。

# html - DOJO gui元素，使用用户的后端授权控制显示

> ID：13292164
> 
> 赞同：1
> 
> 时间：2012-11-08T15:32:34.083
> 
> 标签：html, rest, dojo, webpage

我有一个基于 dojo 的 gui，它从 web 服务中获取数据。

在 tomcat，我已经有一个现有的授权安全服务器，它为我提供了用户可以执行的某些列表功能。

如何根据我的服务器为登录用户提供的功能列表启用和禁用我的网页上可用的某些 dojo 小部件/菜单？

（到目前为止，我能想到的只是在加载所有小部件后才使用 javascript 方法来启用和禁用小部件，函数列表将通过 REST 调用在 gui 上传递。但我觉得这不是一个好方法做。）

谢谢

# mfc - 带有 ActiveX 控件的对话框的 CDialog::Create 失败

> ID：13292166
> 
> 赞同：5
> 
> 时间：2012-11-08T15:32:58.607
> 
> 标签：mfc, cdialog, com-server

我有一个模块可以创建一个包含 ActiveX 控件的无模式对话框。该模块是 MFC EXE 应用程序的一部分，对话框的创建工作正常。最近，我将模块移到 ATL/COM 服务器中，并将对话框资源从 EXE 复制到 COM 服务器中。尝试使用`CDialog::Create()`错误创建无模式对话框时。

我调试`CDialog::Create`并注意到它在`::CreateDialogIndirect()`返回`NULL`和`GetLastError`返回时失败`0`。我在对话框资源属性中将“No Fail Create”标志更改为 True，并获得了有关错误的更多详细信息。问题发生在宏`DoDataExchange()`内的对话框中。`DDX_Control`这将调用`CDataExchange::PrepareCtrl()`控件的资源 ID，如下所示：

```
HWND CDataExchange::PrepareCtrl(int nIDC)
{
   ASSERT(nIDC != 0);
   ASSERT(nIDC != -1); // not allowed
   HWND hWndCtrl;
   COleControlSite* pSite = NULL;
   m_pDlgWnd->GetDlgItem(nIDC, &hWndCtrl);
   if (hWndCtrl == NULL)
   {
      // Could be a windowless OCX
      pSite = m_pDlgWnd->GetOleControlSite(nIDC);
      if (pSite == NULL)
      {
         TRACE(traceAppMsg, 0, "Error: no data exchange control with ID 0x%04X.\n", nIDC);
         ASSERT(FALSE);
         AfxThrowNotSupportedException();
      }
   }
   m_idLastControl = nIDC;
   m_bEditLastControl = FALSE; // not an edit item by default

   return hWndCtrl;
} 
```

由于传递的资源 ID ，对该函数的调用`m_pDlgWnd->GetOleControlSite()`失败。顺便说一下，资源 ID 是控件的 ID。

关于为什么这在 EXE 中有效并在 COM 服务器中失败的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T17:55:19.390

我有完全相同的问题。就我而言，问题原来是我没有调用 AfxEnableControlContainer()。我在我的应用程序的 InitInstance 成员函数中添加了一个调用，它解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T00:39:22.027

前几天遇到了类似的问题。将控件从一个对话框资源复制到另一个。事实上，您不能像使用其他 MFC 控件那样将 ActiveX 控件从一个对话框复制到另一个对话框。对于 ActiveX 控件，rc 文件包含一个 DLGINIT 部分。例如，我有一个带有 IE WebBrowser 控件的表单：

```
IDD_ONLINE_REPORTVIEW_FORM DIALOGEX 0, 0, 320, 200
STYLE DS_SETFONT | DS_CONTROL | WS_CHILD
FONT 8, "MS Sans Serif", 0, 0, 0x0
BEGIN
    CONTROL         "",IDC_EXPLORER1,"{8856F961-340A-11D0-A96B-00C04FD705A2}",WS_TABSTOP,7,61,299,77
END 
```

在 rc 文件下面，有一个 DLGINIT 部分：

```
IDD_ONLINE_REPORTVIEW_FORM DLGINIT
BEGIN
    IDC_EXPLORER1, 0x376, 160, 0
0x0000, 0x0000, 0x004c, 0x0000, 0x2e68, 0x0000, 0x0ceb, 0x0000, 0x0000, 
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
0x0000, 0x0000, 0x004c, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 
0x0000, 0xd0e0, 0x0057, 0x3573, 0x11cf, 0x69ae, 0x0008, 0x2e2b, 0x6212, 
0x0008, 0x0000, 0x0000, 0x0000, 0x004c, 0x0000, 0x1401, 0x0002, 0x0000, 
0x0000, 0x00c0, 0x0000, 0x0000, 0x4600, 0x0080, 0x0000, 0x0000, 0x0000, 
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0000, 
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
    0
END 
```

打开 rc 文件的源并搜索您的控件 ID。搜索 DLGINIT 部分并将其复制到您的新对话框中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-03T08:43:22.233

这是另一种情况，可以得到相同的调试断言警告（错误：没有 ID dlgdata 的数据交换控制：第 40 行）：

例如，如果您通过虚函数 CDialogExExample::Create(CONTROL_ID, ..) 创建 CDialogExExample 的对话框实例，而 CONTROL_ID 与 CDialogExample 头文件中的 IDD_EXAMPLE(enum{ IDD = IDD_EXAMPLE};) 不一致......然后一个可以添加控制总是失败。

这是[来自 msdn 的鼓舞人心的链接](https://social.msdn.microsoft.com/Forums/en-US/e6daa194-e7f1-4f05-be59-93164d15e895/dialogex-inherited-error-error-no-data-exchange-control-with-id?forum=vcmfcatl)！

可能对某人有帮助:)

PS：这种情况可能与@Hank Chang的回答相同

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-25T07:41:30.270

就我而言，我在调用时输入了错误的对话框 ID

```
BOOL Create(UINT nID, CWnd * pWnd); 
```

所以失败了`DoDataExchange()`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-04T11:14:45.063

就我而言，我有一个 MFC 对话框，它通过 ActiveX 托管 .Net UI 控件。

调试后我发现，DoModal 失败并返回 -1，GetLastError 给出 0。

经过一天的调试，原来是.Net Assemblies 版本不匹配的问题。这会导致 OLE 控件实例化失败。

WinDBG 摘录：

> (21b0.71cc)：CLR 异常 - 代码 e0434352（第一次机会）OLE 控件 {EE3C4329-83A8-4DD8-A74C-680AC01AC593} 的 CoCreateInstance 失败。
> 
> > > > 结果代码：0x80131040

HRESULT 值 0x80131040 含义：

**找到的程序集的清单定义与程序集引用不匹配。**

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-01-16T12:50:03.703

在出现确切错误后我找到的解决方案是检查头文件中的类定义。假设班级是

然后在下面的代码中

```
class CNewDlg : public CMyBaseDlg
{
    DECLARE_DYNAMIC(CNewDlg)
public:
    CNewDlg(CWnd* pParent = NULL);   // standard constructor
    virtual ~CNewDlg();

    // Dialog Data
    enum { IDD = IDD_MYNEWDIALOGID }; 
```

检查线路：

```
enum { IDD = IDD_MYNEWDIALOGID }; 
```

确保您拥有正确的 ID。您收到的错误可能是由于从先前创建的控件/对话框的另一个头文件中复制和粘贴代码而没有更新此 ID。

这应该与 .rc 文件中对话框的定义相匹配。例如：

```
IDD_MYNEWDIALOGID DIALOGEX 0, 0, 445, 314 
```

# php - ZF：从一个控制器到另一个控制器的 http 请求挂起

> ID：13292171
> 
> 赞同：5
> 
> 时间：2012-11-08T15:33:11.197
> 
> 标签：php, http, zend-framework

我有这个问题，我想从我的一个控制器向与另一个控制器链接的 URL 执行 HTTP 请求。它们彼此完全独立。

当我的控制器包含以下代码时，我的应用程序将挂起，直到出现致命错误：超过 30 秒的最大执行时间...

```
 $opts = array(
        'http'=>array(
        'method'=>"GET",
        'header'=>"Accept-language: en\r\n" .
                  "Cookie: DEFAULTID=rookgqj7bdi4os6f4pt5vqkk74\r\n"
        )
    );
    $context = stream_context_create($opts);

    $contents = file_get_contents('http://10.10.3.6/__env/Module/post-types-list/json-export', false, $context);
    print "xxx=". $contents; 
```

AFAIK 这里没有循环。如果我从 ZF 外部进行操作，则可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:26:17.617

你不清楚这一点，但我猜你在两个控制器中都使用了一个会话。

会话使用锁来防止同时运行的其他脚本破坏数据。使用会话时，调用会`session_start()`在会话文件上建立锁定，然后读取数据。在脚本结束时，更改的会话数据被写回，并且锁被释放。

您无法重新使用与当前请求一起运行的同一会话来访问网络服务器，因为那样您将陷入死锁。

然而，有一个出路：`session_write_close()`将写入会话数据并释放锁定，但在此之后您的会话数据无法更改，除非您再次调用`session_start()`.

但要小心：它会起作用，但如果你使场景复杂化，如果你不密切注意哪个会话锁处于活动状态，它会让你陷入另一个死锁。通过执行其他代码而不创建新的 http 请求来解决这个问题会更好，因为代码将在当前请求的上下文中执行，并且会话锁无关紧要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T17:33:15.717

我没有ZF的经验。但对我来说，这是一个标题不匹配。你的网址

```
http://10.10.3.6/__env/Module/post-types-list/json-export 
```

是控制器/动作请求？并且响应是json格式的？

如果是这样，您可以使用 curl：

```
$ch = curl_init();

// set URL and other appropriate options
$options = array(
    CURLOPT_URL => 'http://www.example.com/',
    CURLOPT_HEADER => 'Accept: application/json', // this is the tricky bit
    ...
);

curl_setopt_array($ch, $options);

$data = json_decode(curl_exec($ch));

//you then can even debug what's wrong with.
$curl_info = (curl_getinfo($ch));
var_dump($curl_info);

// dont forget to close curl
curl_close($ch); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T05:56:57.970

您是否尝试过使用[Zend_Http_Client](http://framework.zend.com/manual/1.0/en/zend.http.client.html)。

```
$url = 'http://10.10.3.6/__env/Module/post-types-list/json-export';
$client = new Zend_Http_Client();
$client->setUri($url);
$client->setHeaders('Accept-language','en');
$client->setHeaders('Cookie','DEFAULTID=rookgqj7bdi4os6f4pt5vqkk74');
$client->setConfig(array('maxredirects' => 1));
$response = $client->request()->getBody(); 
```

# asp.net-mvc - ASP.NET MVC Razor - 上传文件，HttpPostedFileBase 始终为空

> ID：13292173
> 
> 赞同：2
> 
> 时间：2012-11-08T15:33:14.100
> 
> 标签：asp.net-mvc, jquery-mobile, razor, httppostedfilebase, enctype

嗯，这很奇怪。我正在做我在网上大量找到的所有事情，但仍然无法正常工作。我想上传一个文件，所以在我放的视图中：

```
@using (Html.BeginForm("Import", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
<input type="file" name="uploadFile" />
<input type="submit" value="Importa" />
} 
```

这是主页/导入：

```
[AcceptVerbs(HttpVerbs.Post)] // or [HttpPost], nothing changes
public ActionResult Import(HttpPostedFileBase uploadFile)
{
   Debug.WriteLine("Inside Import");
   if (uploadFile == null)
       Debug.WriteLine("null");
   // Verify that the user selected a file
   if (uploadFile != null && uploadFile.ContentLength > 0)
   {
      Debug.WriteLine("Valid File");
      ...
   }
} 
```

它总是打印*Inside Import* + *null*。所以我确定我调用了正确的控制器操作，但它总是收到一个空的 HttpPostedFileBase。

有没有人对此有建议或已经发现（并解决了）这类问题？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-08T16:28:49.130

发现了问题。您必须将 html 属性 "@data_ajax = "false" " 放在视图中，靠近 enctype 之一。因此，如果您使用的是 jQuery Mobile，请务必编写

```
@using (Html.BeginForm("Import", "Home", FormMethod.Post, new { enctype = "multipart/form-data", @data_ajax = "false" })) 
```

希望这会对某人有所帮助！

# ios - 指针在 obj-c 中返回为 nil

> ID：13292174
> 
> 赞同：0
> 
> 时间：2012-11-08T15:33:15.503
> 
> 标签：ios, objective-c, sparrow-framework

我正在初始化一个指向 SPSprite 对象（麻雀框架）的指针，就像这样......

```
SPSprite *mySprite = [[SPSprite alloc] init]; 
```

然后我将该指针保存在这样的 NSMutableDictionary 中......

```
[objectDynamic setObject:mySprite forKey:@"objectSprite"]; 
```

但是当我稍后尝试在代码中使用这个访问该对象时......

```
SPSprite *mySprite = [objectDynamic objectForKey:@"objectSprite"]; 
```

mySprite = 0x00000000 当我在调试器中查看它时，当我在 objectDynamic 上进行打印时，我得到了这个..

```
objectSprite = "<SPSprite: 0x162e7d40>"; 
```

这与分配/初始化时的情况相同，所以我对发生的事情有点困惑。

我正在使用ARC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:41:40.763

检查您的密钥是否相同（事实上，我会#define 它以避免拼写错误）。

# vb.net - 什么是二进制比较，它与文本比较有何不同

> ID：13292178
> 
> 赞同：2
> 
> 时间：2012-11-08T15:33:28.887
> 
> 标签：vb.net, vb6

如果我们比较“CAT”和“cat”之类的两个字符串并使用 vbBinaryCompare 模式，MSDN 说它会进行二进制比较，但什么是二进制比较？这是否意味着它以不区分大小写的方式进行？它与文本比较有何不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:38:06.660

`vbTextCompare`不区分大小写。“CAT”和“cat”被认为是相等的。

`vbBinaryCompare`是区分大小写的。“CAT”和“cat”被认为是不同的。

# wpf - 在 WPF 中使用矢量图像的最佳方法是什么？

> ID：13292179
> 
> 赞同：21
> 
> 时间：2012-11-08T15:33:30.947
> 
> 标签：wpf, xaml, vector

我正在寻找一种在 XAML 中处理矢量文件（EPS 或 SVG）的好方法。我找到了一个插件，可以将图像从 Illustrator 导出到 XAML ，如果我将文件的内容复制到我的窗口，它会很好地工作。

但是，是否可以将 xaml 输出用作资源或其他东西，并从给定的 XAML 窗口示例中导入/转换它？

* * *

我正在使用的工具：[Adobe Illustrator 到 Xaml](http://www.mikeswanson.com/XAMLExport/)。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T16:15:51.410

就个人而言，如果您正在谈论在多个地方使用它，而不必每次都重新使用/重新绘制您的 xaml 路径。然后我将它们放入 ContentControl 中，例如；

```
<!-- Plop this in your resource dictionary or your resource declaration -->
    <Style x:Key="TheAwesomeXAMLimage" TargetType="ContentControl">
            <!-- Add additional Setters Here -->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ContentControl">

                                <!-- Just Paste your XAML here -->

                </ControlTemplate>
            </Setter.Value>
        </Setter>                      
    </Style>

<!-- Now actually place it on your view -->
    <ContentControl Style="{StaticResource TheAwesomeXAMLimage}"/> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-06-15T20:52:19.887

使用[DrawingImage](https://msdn.microsoft.com/en-us/library/system.windows.media.drawingimage(v=vs.110).aspx)作为您的*容器*，该容器被设计为这样的包装器：

```
<MyWindow.Resources>
     <DrawingImage x:Key="diUndo">
         <DrawingImage.Drawing>
             <DrawingGroup>
                 <GeometryDrawing Brush="#FF22BAFD" Geometry="..."/>
             </DrawingGroup>
         </DrawingImage.Drawing>
     </DrawingImage> 
</MyWindow.Resources> 
```

然后像这样重用它：

```
<Image Source="{DynamicResource diUndo}" /> 
```

但它永远是那个颜色......

* * *

## 或指定颜色

使矢量成为样式，然后在目标处动态更改它（*它是矢量而不是静态图像对吗？*），然后在使用时指定填充颜色：

```
 <MyWindow.Resources>
        <Path x:Key="vRedo"
              Data="F1M14.4401,25.5039C15.5755,22.9375 17.1667,20.5703 19.2162,18.5239 23.5781,14.1587 29.3828,11.7539 35.5573,11.7539 41.7344,11.7539 47.5365,14.1587 51.8984,18.5239 56.263,22.8879 58.6667,28.6899 58.6667,34.8645 58.6667,41.0391 56.263,46.8411 51.8984,51.2056 51.2031,51.8997 50.2917,52.2461 49.3828,52.2461 48.474,52.2461 47.5599,51.8997 46.8646,51.2056 45.4818,49.8164 45.4818,47.5664 46.8698,46.177 49.8932,43.1563 51.5573,39.1392 51.5573,34.8645 51.5573,30.5911 49.8932,26.5728 46.8646,23.552 43.849,20.5273 39.8307,18.8645 35.5573,18.8645 31.2813,18.8645 27.2656,20.5273 24.2448,23.552 22.0052,25.7915 20.5182,28.5845 19.8932,31.6184L27.5573,40.1992 5.33334,40.1992 7.10938,17.2969 14.4401,25.5039z" />
        <Style x:Key="ModifiablePathStyle"
               TargetType="{x:Type Path}">
            <Setter Property="Stretch"
                    Value="Uniform" />
            <Setter Property="Data"
                    Value="{Binding Data, Source={StaticResource vRedo}}" />
        </Style>
 </MyWindow.Resources> 
```

这是它的用法：

```
<Path Style="{StaticResource ModifiablePathStyle}" Fill="Blue"/>
<Path Style="{StaticResource ModifiablePathStyle}" Fill="Red"/>
<Path Style="{StaticResource ModifiablePathStyle}" Fill="Green"/> 
```

这是所有三个的结果：

![在此处输入图像描述](../Images/8b1f0d63c14a57611ce818b4c6969a3c.png)

* * *

我发现可以在[Material Design Icons找到一个很好的矢量图标来源（](https://materialdesignicons.com/)*带有 Xaml 剪切/粘贴版本可供下载）*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T15:42:51.027

如果您不反对使用 3rd 方工具，请考虑查看[SharpVectors](http://sharpvectors.codeplex.com/)。它在 SVG 方面做得很好：解析、XAML 转换、显示等。

编辑：我可能不明白你的问题，你可能会更好地回答 Chris W. ;)

# css - 有没有更好的方法来做 CSS 渐变边框？

> ID：13292184
> 
> 赞同：3
> 
> 时间：2012-11-08T15:33:41.557
> 
> 标签：css, border, gradient

我找到了一些方法来做伪渐变边框。这是我的，它也兼容 IE8-9。

[http://www.jsfiddle.net/Zwhq8/](http://www.jsfiddle.net/Zwhq8/)

您认为在保持渐变灵活性和兼容 IE 的同时可以做得更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:39:23.703

嗨，你试过这个吗？最后一个例子做了（我认为）你想要的

[http://css-tricks.com/examples/GradientBorder/](http://css-tricks.com/examples/GradientBorder/)

# bash - 如果块总是转到 Bash 中的 else

> ID：13292185
> 
> 赞同：3
> 
> 时间：2012-11-08T15:33:43.177
> 
> 标签：bash

以下代码段`else`在它应该进入`elif`.

```
#The following line returns 3, 4 or 5 as the exit code.
$BASH_EXEC adbE.sh "adb $ARGUMENT install $f"
echo "the return code:$?."
if [ $? -eq 5 ]
then
    #do nothing, success
    continue
elif [ $? -eq 4 ]
then
    echo "WARNING"
else
    echo "ERROR"
    break
fi 
```

这部分：`echo "the return code:$?."`在屏幕上回显：`the return code:4.`

它不显示`WARNING`。它只显示`ERROR`然后中断`for`包含此代码的循环。

我究竟做错了什么？

* * *

以下是我尝试过的导致相同问题的条件比较的变化：

1.  `if [ $? -eq 5 ]`
2.  `if [ $? -eq "5" ]`
3.  `if [ $? == 5 ]`
4.  `if [ $? == "5" ]`
5.  `if [[ $? -eq 5 ]]`
6.  `if [[ $? -eq "5" ]]`
7.  `if [[ $? == "5" ]]`
8.  `if [[ $? == 5 ]]`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T15:38:34.467

原因是**最后执行的命令**`$?`的返回码。你在 之前运行一个命令，所以它是你正在测试的返回码，它总是 0。**`echo``if``echo`**

 **此外，在您的情况下，由于您正在重新测试`elif`语句中的返回值这一事实导致了另一个问题。初始测试（即`[ $? -eq 5 ]`）也会改变 的值`$?`，因此重新测试它会得到意想不到的结果。

要解决这种情况，请在执行 之前保存之前的返回代码`echo`，然后将保存的版本用于以后的所有测试：

```
ret=$?
echo "the return code:${ret}."
if [ ${ret} -eq 5 ]
then
        #do nothing, success
        continue
elif [ ${ret} -eq 4 ]
then
        echo "WARNING"
else
        echo "ERROR"
        break
fi 
```**

# java - android/java在项目中组织http web服务调用的结构/模式是什么？

> ID：13292186
> 
> 赞同：8
> 
> 时间：2012-11-08T15:33:48.233
> 
> 标签：java, android, design-patterns

现在每当我的项目在后端有一个网络服务时。我习惯于用这种结构/模式创建我的项目。

**项目**

*   HttpMethods 包
    *   HttpGetThread

    *   HttpPostThread

    *   HttpMultipartPostThread
*   接口包
    *   IPostResponse

我在这些 JAVA 文件中编写的代码是，

IPostResponse.java

```
public interface IPostResponse {
    public void getResponse(String response);
} 
```

HttpGetThread.java

```
public class HttpGetThread extends Thread {

    private String url;
    private final int HTTP_OK = 200;
    private IPostResponse ipostObj;

    public HttpGetThread(String url, IPostResponse ipostObj) {
        this.url = url;
        this.ipostObj = ipostObj;
    }

    public void run() {
        try {
            HttpClient httpClient = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(url);
            HttpResponse httpResponse = httpClient.execute(httpGet);
            int responseCode = httpResponse.getStatusLine().getStatusCode();
            if (responseCode == HTTP_OK) {
                InputStream inputStream = httpResponse.getEntity().getContent();
                int bufferCount = 0;
                StringBuffer buffer = new StringBuffer();
                while ((bufferCount = inputStream.read()) != -1) {
                    buffer.append((char) bufferCount);
                }
                ipostObj.getResponse(buffer.toString());
            }
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

通过扩展并拥有一个构造函数和一个 run 方法，在类`HttpPost`和类中的方式相同。`HttpMultipartPost``Thread`

然后，

我实现了一个活动的接口，并将该主要活动扩展到所有其他活动，并通过创建带有参数和调用的 Http 类的对象来获得响应和调用`obj.start();`

* * *

*我仍然认为：我缺乏很多东西或者这个结构很差。*

我需要知道，对于要在大多数活动中实现 Web 服务调用并具有代码可重用性的 Android 应用程序，**我应该遵循哪种模式/结构**？

我刚刚看到 Facebook 如何进行网络服务调用，例如登录/注销它有登录和注销侦听器。

*是否有任何博客/文章/答案有据可查？请问，任何用户都可以分享他/她的出色经验和解决方案吗？*

我更感兴趣的是“**我的类和接口应该是什么样子，应该有什么样的方法？** ”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T05:49:31.677

第一个也是大多数建议是你为什么不使用[无痛线程](http://android-developers.blogspot.in/2009/05/painless-threading.html)，即[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)

现在第二件事创建一个可重用的代码，如下所示，您可以创建尽可能多的带有请求参数的方法。

```
public class JSONUtil {

    private static JSONUtil inst;

    private JSONUtil() {

    }

    public static JSONUtil getInstance() {
        if (inst == null)
            inst = new JSONUtil();
        return inst;
    }

    /**
     * Request JSON based web service to get response
     * 
     * @param url
     *            - base URL
     * @param request
     *            - JSON request
     * @return response
     * @throws ClientProtocolException
     * @throws IOException
     * @throws IllegalStateException
     * @throws JSONException
     */
    public HttpResponse request(String url, JSONObject request)
            throws ClientProtocolException, IOException, IllegalStateException,
            JSONException {

        synchronized (inst) {

            DefaultHttpClient client = new DefaultHttpClient();
            HttpPost post = new HttpPost(url);
            post.setEntity(new StringEntity(request.toString(), "utf-8"));
            HttpResponse response = client.execute(post);
            return response;
        }
    }

    public HttpResponse request(String url)
            throws ClientProtocolException, IOException, IllegalStateException,
            JSONException {

        synchronized (inst) {

            DefaultHttpClient client = new DefaultHttpClient();             
            HttpPost post = new HttpPost(url);
            post.addHeader("Cache-Control", "no-cache");
            HttpResponse response = client.execute(post);
            return response;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-05T19:45:02.643

我知道这是一个老问题，但我仍然想回答它以分享我在自己的项目中所做的事情，我会喜欢社区对我的方法提出的建议。

**HttpClient**

如果你看一下 HttpClient（作为向端点发出请求的实体），它就是关于请求和响应的。这样想。Http 协议“发送请求”的行为需要方法、headers（可选）、body（可选）。同样，在返回请求时，我们会得到带有状态码、标头和正文的响应。因此，您可以简单地将 HttpClient 设置为：

```
public class HttpClient 
{
    ExecutorService executor = Executors.newFixedThreadPool(5);
     //method below is just prototype 
     public String execute(String method, String url, Map < String, String > headers ) 
     {
          try 
          {
           URL url = new URL("http://www.javatpoint.com/java-tutorial");
           HttpURLConnection huc = (HttpURLConnection) url.openConnection();
           //code to write headers, body if any
           huc.disconnect();
           //return data
          } 
          catch (Exception e) 
          {
           System.out.println(e);
          }
     }

       public String executeAsync(String method, String url, Map < String, String > headers, Callback callback ) 
     {//Callback is Interface having onResult()
         executor.execute(
             new Runnable()
             {
                 void run()
                 {
                    String json= execute(method,url,headers)
                    callback.onResult(json);
                 }
             }
          );
     }
} 
```

这样您就不需要为单独的请求创建一个类。相反，我们将只使用`HtttpClient`. 您必须在其他线程上调用 API（而不是在 Android 的主线程上）。

**API 结构**

假设您有名为 User 的资源，并且您的应用程序中需要 CRUD。您可以创建接口 UserRepository 和实现 UserRepositoryImpl

```
interface UserRepository
{
    void get(int userId, Callback callback);

    void add(String json,Callback callback);

    //other methods
}

class UserRepositoryImp
{
    void get(int userId, Callback callback)
    {
        HttpClient httpClient= new HttpClient();
        //create headers map
        httpClient.executeAsync("GET","/",authHeaders,callback);
    }

    void add(String json,Callback callback)
    {
         HttpClient httpClient= new HttpClient();
        //create headers map
        httpClient.executeAsync("POST","/",authHeaders,callback);
    }

    //other methods
} 
```

请注意，您应该在 Android 的 UI 线程上更新 UI。[上面的实现不用担心]

# asp.net-mvc - 在 MVC3 中如何使用 Linq 获取模型列表？

> ID：13292194
> 
> 赞同：0
> 
> 时间：2012-11-08T15:34:06.780
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq, linq-to-sql, linq-to-entities

在我的数据库上下文类中，我有：

```
Imports System.Data.Entity
Public Class MusicStoreEntities
    Inherits DbContext
    Public Property Albums As DbSet(Of Album)
    Public Property Descriptions As DbSet(Of Description)
End Class 
```

然后，我有专辑和描述的这两个模型

```
Public Class Album
    Public Property AlbumId As Integer
End Class

Public Class Description
    Public Property DescriptionId As Integer
    Public Property AlbumId As Integer
End Class 
```

从控制器的动作中，我可以使用 Linq 获得专辑的单个描述，如下所示：

```
Dim album_description As Description = db.Descriptions.Single(Function(g) g.AlbumId = id) 
```

但是，如何获取专辑的描述列表？

```
Dim album_descriptions As List(Of Description) = db.Descriptions.**???**(Function(g) g.AlbumId = id) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:38:04.297

```
 Dim album_descriptions As List(Of Description) = db.Descriptions.Where(Function(g) g.AlbumId = id).ToList() 
```

应该这样做

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:36:54.900

使用[此处](http://msdn.microsoft.com/en-us/library/bb338811.aspx)`.Where()`记录的方法。

```
db.Descriptions.Where(Function(g) g.AlbumId = id).ToList() 
```

# asp.net - 在 Windows 8 上的 Windows Azure SDK 1.8 模拟器上调试不起作用

> ID：13292204
> 
> 赞同：0
> 
> 时间：2012-11-08T15:34:35.300
> 
> 标签：asp.net, azure, azure-web-roles

每当我在 Visual Studio 中进行调试时，它会将网站部署到 IIS / Compute Emulator 并给出以下消息：

> 将调试器附加到角色实例“deployment18(521).TestApp.Azure.Website1.Web.UI_IN_0”的 URL“http://127.255.0.0:82/”的 IIS 工作进程时出错。无法在 Web 服务器上开始调试。无法启动 ASP.NET 调试。通过启动项目而不进行调试可以获得更多信息。

然后，当我查看调试器日志时，它说：

```
http://127.255.0.0:82/debugattach.aspx
----------------------------------------------------------------------
Status code=417 (Expectation Failed)
Protocol version=1.1
Cached=False
Content-Length=60
Cache-Control=private, no-transform
Content-Type=text/html
Date=Thu, 08 Nov 2012 14:52:08 GMT
----------------------------------------------------------------------
The page cannot be displayed because the expectation failed. 
```

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:42:09.647

使用失败请求跟踪后，我可以看到我的应用程序初始化 (Web-AppInit)（IIS 8.0 中的新初始化功能）配置导致调试失败。

所以消息是：如果你有 preloadEnabled 和 applicationInitialization 配置部分有点像这样，不要指望能够调试你的 web 应用程序：

```
 <applicationInitialization doAppInitAfterRestart="true" remapManagedRequestsTo="loading.html" skipManagedModules="true">
      <add initializationPage="/" />
    </applicationInitialization> 
```

我将把它放到 web.release.config 文件中，所以它只在生产中生效。

# svn - Subversion 网关重新编号修订？

> ID：13292209
> 
> 赞同：1
> 
> 时间：2012-11-08T15:34:42.660
> 
> 标签：svn

我的一个项目是在一个 subversion 存储库（我们称之为 svn://oldserver/）中，它将被合并到一个新的存储库中（比如说 svn://newserver/）。

本项目大量使用 svn:externals 链接一些库的源代码。所有外部都包含一个修订号，因此我目前可以查看旧版本的代码，包括库。

“oldserver”将被转储并导入“newserver”。然后外部将更改为指向新服务器，但这仅适用于 HEAD 修订版。旧版本的两个问题：

*   导入将移动所有修订，但不会移动 svn:externals 中的相应数字。
*   导入还将保留原始存储库名称（svn://oldserver/），而不是使用新的。

我想知道是否有类似 subversion 的网关服务器之类的东西，我可以在 svn://oldserver/ 名称下运行它，它会简单地从 svn://newserver 获取数据，但在重新编号修订号之后。有谁知道这样的事情？

*备选方案 1：在将“oldserver”导入“ [newserver ”之前，使用 svndumptool 等工具重新编号外部。](http://svn.borg.ch/svndumptool/)但是如果我犯了错误，我以后就无法纠正了。这就是我拒绝这个解决方案的原因。*

*备选方案2：让旧服务器运行，只需配置为只读即可。它只是在服务器硬盘上占据更多位置，但如果我找不到更好的解决方案，我可能会使用此解决方案。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:44:44.053

最安全的方法是运行某种脚本在旧存储库中为每个外部目标的特定版本创建标签，然后将实际的外部定义指向该标签的 HEAD 修订版，例如给定外部定义

```
-r1234 svn://oldserver/libraries/lib1 lib1 
```

做一个像这样的标签

```
svn cp -r 1234 svn://oldserver/libraries/lib1 svn://oldserver/libraries/tags/lib1-r1234 
```

并改变外部

```
svn://oldserver/libraries/tags/lib1-r1234 lib1 
```

然后这些标签将稳定并在转储和导入后指向新存储库中的相应修订，您可以将它们从批发切换`oldserver`为`newserver`.

# oracle - Oracle 10g 分页返回带有“rownum”和 NHibernate 的错误结果集

> ID：13292211
> 
> 赞同：1
> 
> 时间：2012-11-08T15:34:44.800
> 
> 标签：oracle, nhibernate, paging

目前，在使用 Oracle 10g 和 NHibernate 分页数据时，我在我们的应用程序中遇到了一些奇怪的行为。

我有一个有 20 行的表，我想在列表中显示每个站点 10 行，所以我的列表有 2 页。

使用 NHibernate 我正在为第一页`query.SetMaxResults(10).SetFirstResult(0)`和第二页设置`query.SetMaxResults(10).SetFirstResult(10)`。

将为第一页创建以下 SQL：

```
SELECT * FROM table WHERE rownum <= 10; 
```

将为第二页创建以下 SQL：

```
SELECT row_.*, rownum rownum_ 
FROM 
(
    SELECT * 
    FROM table
 ) row_ 
 WHERE rownum <= 20 WHERE rownum_ > 10; 
```

第一个查询正确返回前 10 行，而第二个查询仅返回 4 个新行和 6 个已经在“第 1 页”中的行。所以 6 行完全丢失。

所以，我想，到底是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-16T21:28:26.237

您可以创建自己的自定义 Oracle 方言来解决此问题，或者您可以等待补丁 NH-3814 被接受。最好等待 NHibernate 接受补丁，但如果你没有时间，你可以这样做。

[https://nhibernate.jira.com/browse/NH-3814](https://nhibernate.jira.com/browse/NH-3814)

此类将覆盖 Oracle8iDialect 中的一个方法，以允许 rownum_ 字段用于跳过和取值。我不得不使用反射来调用 ExtractColumnOrAliasNames，因为这是一个私有方法。

```
internal class Oracle10gDialectExtended : NHibernate.Dialect.Oracle10gDialect
{

    public Oracle10gDialectExtended()
    {
    }

    /// <summary>
    /// This is from patch NH-3814
    /// https://nhibernate.jira.com/browse/NH-3814
    /// https://nhibernate.jira.com/secure/attachment/24661/Oracle8iDialect.cs
    /// </summary>
    /// <param name="sql"></param>
    /// <param name="offset"></param>
    /// <param name="limit"></param>
    /// <returns></returns>
    public override NHibernate.SqlCommand.SqlString GetLimitString(NHibernate.SqlCommand.SqlString sql, NHibernate.SqlCommand.SqlString offset, NHibernate.SqlCommand.SqlString limit)
    {
        sql = sql.Trim();
        bool isForUpdate = false;
        if (sql.EndsWithCaseInsensitive(" for update"))
        {
            sql = sql.Substring(0, sql.Length - 11);
            isForUpdate = true;
        }

        string selectColumns = ExtractColumnOrAliasNames(sql);

        var pagingSelect = new SqlStringBuilder(sql.Count + 10);
        if (offset != null)
        {
            pagingSelect.Add("select " + selectColumns + " from ( select row_.*, rownum rownum_ from ( ");
        }
        else
        {
            pagingSelect.Add("select " + selectColumns + " from ( ");
        }

        pagingSelect.Add(sql);

        if (offset != null && limit != null)
        {
            pagingSelect.Add(" ) row_ ) where rownum_ <=").Add(limit).Add(" and rownum_ >").Add(offset);
        }
        else if (limit != null)
        {
            pagingSelect.Add(" ) where rownum <=").Add(limit);
        }
        else
        {
            // offset is specified, but limit is not.
            pagingSelect.Add(" ) row_ ) where rownum_ >").Add(offset);
        }

        if (isForUpdate)
        {
            pagingSelect.Add(" for update");
        }

        return pagingSelect.ToSqlString();
    }

    private string ExtractColumnOrAliasNames(SqlString select)
    {
        BindingFlags flags = BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Static | BindingFlags.Public;
        MethodInfo info = typeof(NHibernate.Dialect.Oracle8iDialect).GetMethod("ExtractColumnOrAliasNames", flags, null, new Type[] { typeof(SqlString) }, null);

        if (info == null)
        {
            throw new MissingMethodException("Method ExtractColumnOrAliasNames does not exist on class NHibernate.Dialect.Oracle8iDialect");
        }

        return info.Invoke(this, new object[] { select }) as string;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:18:22.783

NH 3.2 在 Oracle 上存在分页问题（类似的问题[在这里](https://stackoverflow.com/questions/10139766/nhibernate-3-2-and-paging-oracle)）。我遇到了同样的问题并一直使用 3.1 直到它被修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:39:30.450

也许我遗漏了一些东西，但我认为你想要这个作为你的第二个查询：

```
SELECT row_.*
FROM 
(
    SELECT *, rownum rn   --- place your rownum here
    FROM table
 ) row_ 
 WHERE rn > 10 
    and rn <=20 
```

这适用于内部查询，然后您在子句`rownum`中选择行号为 11-20 的记录。`WHERE`

请注意，您应该`ORDER BY`在两个查询中都包含一个子句，以确保返回时记录的顺序正确。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-08-04T21:33:25.950

我认为 Powerslave 粗暴地指了他的示例，该示例最初包括*order by*并且类似于：

```
SELECT * FROM 
    (SELECT row_.*, rownum rownum_ FROM 
        (
            SELECT * 
            FROM table
            ORDER BY some_column
        ) row_ 
        WHERE rownum <= 20) 
    WHERE rownum_ > 10; 
```

基本上发生的事情是 NHibernate 生成一个查询：

1.  排序结果
2.  将这些限制为前 20 个有序行
3.  忘记下单了...
4.  ...然后采用*无序*结果 11-20。

最终结果是您将看到每页的正确行数，但有些页面的行会出现在其他页面上，并且也会出现缺失的行。我已经针对 Oracle 手动运行了 NHibernate (4.0.3) 生成的查询，以验证所有这些都是真的。

[我已经在这里](https://nhibernate.jira.com/browse/NH-3814)向 NHibernate 提交了错误报告和补丁。希望我的补丁是洁净的，他们会在下一个版本中修复这个问题。

# html - 访客菜单未出现在 Joomla 中

> ID：13292213
> 
> 赞同：0
> 
> 时间：2012-11-08T15:34:48.293
> 
> 标签：html, joomla, content-management-system

按照[Joomla Docs中的示例](http://docs.joomla.org/Access_Control_List/2.5/Tutorial#Allowing_Guest-Only_Access_to_Menu_Items_and_Modules)中的示例，我为未登录到我正在处理的 Intranet 的人制作了一个仅限访客的菜单项，以便能够查看几页。但是，无论我更改或执行什么操作，注销时菜单项都不会出现在主页上，即使设置为“公共”也是如此。

**如果设置为分开**的任何查看组，它会在登录时出现在菜单上**“访客”**

 **绞尽脑汁想弄清楚这一点，但无法掌握它。是否有一个设置或我可以检查的东西会搞砸这一切？

我可以推测有什么东西阻止了**任何**了我的首页上显示由于访客项目在登录时按要求运行（即不出现），甚至公共项目在注销时也不会出现。无法指出可能导致这种情况的原因。

网站在这里：[http](http://avantgardeinternational.eu/) ://avantgardeinternational.eu/但这可能是有问题的，因为除了主页之外的所有内容都是私有的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:10:56.207

当然，在这个问题失去了几天之后，我在发布问题半小时后自己弄清楚了。

似乎我前段时间将主菜单的**模块**设置为“注册”用户组，当时我不想要首页上的任何菜单项，所以即使菜单是公开的，模块也没有加载到显示链接。将模块设置为公共访问解决了这个问题。**

# python - 使用 psycopg2 python 库并使用良好的转换类型工具构建 SQL 动态查询

> ID：13292218
> 
> 赞同：2
> 
> 时间：2012-11-08T15:35:00.540
> 
> 标签：python, postgresql, type-conversion, postgis, psycopg2

我在设计一个使用[此处描述的 psycopg2 库规范的好算法时遇到了一些问题](http://initd.org/psycopg/docs/usage.html#python-types-adaptation)

我想建立一个等于这个字符串的动态查询：

```
SELECT ST_GeomFromText('POLYGON((0.0 0.0,20.0 0.0,20.0 20.0,0.0 20.0,0.0 0.0))'); 
```

如您所见，我的 POLYGON 对象包含多个点，读取一个简单的 csv 文件 some.csv ，其中包含：

```
0.0;0.0
20.0;0.0
20.0;20.0
0.0;20.0
0.0;0.0 
```

所以我动态构建查询，csv中行/数据数的函数。

这是我生成要执行的 SQL 查询字符串的程序：

```
import psycopg2
import csv 

# list of points
lXy = []

DSN= "dbname='testS' user='postgres' password='postgres' host='localhost'"
conn = psycopg2.connect(DSN)

curs = conn.cursor()

def genPointText(curs,x,y):
    generatedPoint = "%s %s" % (x,y)
    return generatedPoint

#Lecture fichier csv
polygonFile = open('some.csv', 'rb')
readerCSV = csv.reader(polygonFile,delimiter = ';')

for coordinates in readerCSV:
    lXy.append(genPointText(curs,float(coordinates[0]),float(coordinates[1])))

# function of list concatenation by separator
def convert(myList,separator):
    return separator.join([str(i) for i in myList])

# construct simple query with psycopg
def genPolygonText(curs,l):
    # http://initd.org/psycopg/docs/usage.html#python-types-adaptation
    generatedPolygon = "POLYGON((%s))" % convert(l, ",")
    return generatedPolygon

def executeWKT(curs,geomObject,srid):
    try:
            # geometry ST_GeomFromText(text WKT, integer srid);
        finalWKT = "SELECT ST_GeomFromText('%s');" % (geomObject) 
        print finalWKT
        curs.execute(finalWKT)
    except psycopg2.ProgrammingError,err:
        print "ERROR = " , err

polygonQuery = genPolygonText(curs,lXy)
executeWKT(curs,polygonQuery,4326) 
```

如您所见，这是可行的，但是由于python对象和sql postgresql对象之间的转换问题，这种方式不正确。

在文档中，我只看到了为静态查询提供和转换数据的示例。您是否知道在查询的动态构建中创建具有正确类型的正确字符串的“优雅”方式？

更新 1：

正如你所看到的，当我在这个简单的例子中使用 psycopg 类型转换函数时，我有这样的错误：

```
query = "ST_GeomFromText('POLYGON(( 52.146542 19.050557, 52.148430 19.045527, 52.149525 19.045831, 52.147400 19.050780, 52.147400 19.050780, 52.146542 19.050557))',4326)"
name = "my_table"

try:
    curs.execute('INSERT INTO %s(name, url, id, point_geom, poly_geom) VALUES (%s);', (name,query))
except psycopg2.ProgrammingError,err:
    print "ERROR = " , err 
```

误差相等：

```
ERROR =  ERREUR:  erreur de syntaxe sur ou près de « E'my_table' »
LINE 1: INSERT INTO E'my_table'(name, poly_geom) VALUES (E'ST_GeomFr... 
```

更新 2：

感谢stackoverflow用户的最终代码！

```
#info lib : http://www.initd.org/psycopg/docs/
import psycopg2
# info lib : http://docs.python.org/2/library/csv.html
import csv 

# list of points
lXy = []

DSN= "dbname='testS' user='postgres' password='postgres' host='localhost'"

print "Opening connection using dns:", DSN
conn = psycopg2.connect(DSN)

curs = conn.cursor()

def genPointText(curs,x,y):
    generatedPoint = "%s %s" % (x,y)
    return generatedPoint

#Lecture fichier csv
polygonFile = open('some.csv', 'rb')
readerCSV = csv.reader(polygonFile,delimiter = ';')

for coordinates in readerCSV:
    lXy.append(genPointText(curs,float(coordinates[0]),float(coordinates[1])))

# function of list concatenation by separator
def convert(myList,separator):
    return separator.join([str(i) for i in myList])

# construct simple query with psycopg
def genPolygonText(l):
    # http://initd.org/psycopg/docs/usage.html#python-types-adaptation
    generatedPolygon = "POLYGON((%s))" % convert(l, ",")
    return generatedPolygon

def generateInsert(curs,tableName,name,geomObject):
    curs.execute('INSERT INTO binome1(name,geom) VALUES (%s, %s);' , (name,geomObject))

def create_db_binome(conn,name):

    curs = conn.cursor()

    SQL = (
        "CREATE TABLE %s"
        " ("
        " polyname character varying(15),"
        " geom geometry,"
        " id serial NOT NULL,"
        " CONSTRAINT id_key PRIMARY KEY (id)"
        " )" 
        " WITH ("
        " OIDS=FALSE"
        " );"
        " ALTER TABLE %s OWNER TO postgres;"
        ) %(name,name)
    try:
      #print SQL
      curs.execute(SQL)

    except psycopg2.ProgrammingError,err:
      conn.rollback()
      dropQuery = "ALTER TABLE %s DROP CONSTRAINT id_key; DROP TABLE %s;" % (name,name)
      curs.execute(dropQuery)
      curs.execute(SQL)

    conn.commit()

def insert_geometry(polyname,tablename,geometry):

    escaped_name = tablename.replace('""','""')

    try:
        test = 'INSERT INTO %s(polyname, geom) VALUES(%%s, ST_GeomFromText(%%s,%%s))' % (escaped_name)
        curs.execute(test, (tablename, geometry, 4326))
        conn.commit()
    except psycopg2.ProgrammingError,err:
        print "ERROR = " , err

################
# PROGRAM MAIN #
################

polygonQuery = genPolygonText(lXy)
srid = 4326
table = "binome1"

create_db_binome(conn,table)
insert_geometry("Berlin",table,polygonQuery)
insert_geometry("Paris",table,polygonQuery)

polygonFile.close()
conn.close() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T09:24:37.820

您正在尝试将表名作为参数传递。如果您刚刚查看 PostgreSQL 错误日志，您可能会立即看到这一点。

您尝试通过 psycopg2 作为参数传递的表名被转义，产生如下查询：

```
INSERT INTO E'my_table'(name, url, id, point_geom, poly_geom) VALUES (E'ST_GeomFromText(''POLYGON(( 52.146542 19.050557, 52.148430 19.045527, 52.149525 19.045831, 52.147400 19.050780, 52.147400 19.050780, 52.146542 19.050557))'',4326)');' 
```

这不是您想要的，也不会起作用；你不能像文字一样转义表名。您必须使用普通的 Python 字符串插值来构造动态 SQL，您只能将参数化语句占位符用于实际文字值。

```
params = ('POLYGON(( 52.146542 19.050557, 52.148430 19.045527, 52.149525 19.045831, 52.147400 19.050780, 52.147400 19.050780, 52.146542 19.050557))',4326)
escaped_name = name.replace('"",'""')
curs.execute('INSERT INTO "%s"(name, url, id, point_geom, poly_geom) VALUES (ST_GeomFromText(%%s,%%s));' % escaped_name, params) 
```

查看我如何直接插入名称以生成查询字符串：

```
INSERT INTO my_table(name, url, id, point_geom, poly_geom) VALUES (ST_GeomFromText(%s,%s)); 
```

（通过 % 替换`%%`转换为纯文本）。`%`然后我将该查询与定义 the`POLYGON`和另一个参数的字符串一起`ST_GeomFromText`用作查询参数。

我还没有测试过这个，但它应该给你正确的想法并帮助解释什么是错的。

**在进行这样的字符串插值时要格外小心**，这是[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)的简单途径。我在上面显示的代码中做了非常粗略的引用，但如果您的客户端库提供了一个正确的标识符引用函数，我想使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-07T04:23:09.000

正确的方法是使用包含对象的 psycopg2 2.7 的新[`sql`模块。](http://initd.org/psycopg/docs/sql.html#psycopg2.sql.Identifier)`Identifier`这允许您以安全的方式动态指定 SQL 标识符。

不幸的是，PyPi 上还没有 2.7（截至写作时为 2.6.2）。

在此之前，psycopg2 在“如何将字段/表名称传递给查询？”标题下对此进行了介绍。 [http://initd.org/psycopg/docs/faq.html#problems-with-type-conversions](http://initd.org/psycopg/docs/faq.html#problems-with-type-conversions)

您可以使用函数将 SQL 标识符与数据值一起传递给执行`AsIs`函数。

注意：这不提供**任何安全性**。和使用格式字符串一样好，不推荐。这样做的唯一真正优势是您鼓励未来的代码遵循执行 + 数据风格。以后也可以轻松搜索`AsIs`。

```
from psycopg2.extensions import AsIs
<snip>
with transaction() as cur:
    # WARNING: not secure
    cur.execute('SELECT * from %(table)s', {'table': AsIs('mytable')}) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-02-26T14:11:45.023

现在 2.7 在 PyPi 上，这是一个动态查询的例子。

在此示例中，我将假设多边形作为您的 csv 文件中的字典。键可以是上面提到的名称、url、id、point_geom、poly_geom，但只要表结构包含相同的键，它们就无关紧要。

可能有一种方法可以缩短它，但我希望这能阐明 sql 函数的使用，即`sql.SQL`,`sql.Identifier`和`sql.Placeholder`如何连接字符串列表`sql.SQL('..').join(list())`。

```
from psycopg2 import sql
table = 'my_table'
polygon = Polyogon.from_file()  # or something
column_list = list()
value_list = list()

# Convert the dictionary to lists
for column, value in polygon.items():
    column_list.append(sql.Identifier(column))  # Convert to identifiers
    value_list.append(value)

# Build the query, values will be inserted later
query = sql.SQL("INSERT INTO {} ({}) VALUES ({}) ON CONFLICT DO NOTHING").format(
                sql.Identifier(table),
                sql.SQL(', ').join(column_list),  # already sql.Identifier
                sql.SQL(', ').join([sql.Placeholder()] * len(value_list)))

# Execute the cursor
with postgres.cursor() as p_cursor:
    # execute requires tuples and not a list
    p_cursor.execute(insert_query, tuple(value_list)) 
```

参考：http: [//initd.org/psycopg/docs/sql.html](http://initd.org/psycopg/docs/sql.html)

# camera - 拍照并自动复制到 SD 卡

> ID：13292219
> 
> 赞同：1
> 
> 时间：2012-11-08T15:35:03.660
> 
> 标签：camera, photo, avr

有没有办法用bascom avr语言编写代码以JPG格式拍摄照片并自动将其复制到SD卡？相机型号为Tcm8230md。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-04T11:05:59.967

我从未使用过 BASCOM [sd-card 库](http://www.mcselec.com/index.php?option=com_content&task=view&id=291&Itemid=57%22sd-card%20library%22)，但有一个。[I2C 库](http://avrhelp.mcselec.com/index.html?using_the_i2c_protocol.htm%22I2C%20library%22)安静且易于处理。所以通信应该是可能的。但这也取决于您要以多快的速度拍摄照片。我曾经使用过一张 SD 卡，但使用了一个 C 库，我无法实现高读/写率。
此外，相机不支持 jpeg 输出。但它具有 RGB 输出，因此您可以生成[位图](https://en.wikipedia.org/wiki/BMP_file_format%22bmp%22)。

所以我认为这是可能的。

# sql - ETL SQL Server 2008 - 如何处理不匹配的记录？

> ID：13292222
> 
> 赞同：2
> 
> 时间：2012-11-08T15:35:09.963
> 
> 标签：sql, sql-server, sql-server-2005, etl

我对ETL相当陌生。我正在研究这个过程，它的作用是加载人们的生日。这是从事实表加载到另一个表中的。没有键可以连接它们，涉及的所有三个表。我将拆分名称字段并与拆分名称匹配。这会加载匹配的，但我的问题是我必须将不匹配的加载到不同的第三个表中。我该怎么做这个逻辑？

```
update FactTableEmp F
       set Bdate = S.Birthdate

from   FactTableEmp
       cross apply dbo.split(Name) as u
       join SourceTableEmp S on u.Fname = s.FirstName and u.LName = S.Lastname  

--Is using the one below going to work using the same way above?
u.Fnames != S.FirstName
u.Lname != S.Lastname 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:40:33.340

使用[MERGE](http://msdn.microsoft.com/en-us/library/bb510625.aspx)语句（参见示例*D. 将 MERGE 语句的结果插入另一个表*），您应该能够将 ETL 过程简单地放入单个语句中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T17:04:25.277

```
INSERT dbo.third_table
SELECT Bdate, Name
FROM (
      MERGE dbo.FactTableEmp AS target
      USING (
             SELECT x.Bdate,
                    x.Name,
                    u.FName,
                    u.LName, 
                    s.Birthdate,
                    s.FirstName,
                    s.LastName
             FROM dbo.FactTableEmp x CROSS APPLY dbo.split(x.Name) u
               FULL JOIN dbo.SourceTableEmp s ON u.FName = s.FirstName and u.LName = S.Lastname
      ) AS source
ON (target.Name = source.Name AND source.FName = source.FirstName AND source.LName = source.Lastname)
WHEN MATCHED 
  THEN UPDATE SET target.Bdate = source.Birthdate
WHEN NOT MATCHED BY SOURCE
  THEN UPDATE SET target.Name = target.Name
OUTPUT INSERTED.Bdate, INSERTED.Name) AS Changes(Bdate, Name)
WHERE Bdate IS NULL; 
```

# emacs - 如何在不重复任务的情况下使用 org-mode 来跟踪时间？

> ID：13292224
> 
> 赞同：8
> 
> 时间：2012-11-08T15:35:13.377
> 
> 标签：emacs, org-mode, time-tracking

我已经使用 org-mode 大约一年来进行任务和时间跟踪。我的主要目的是能够管理任务（待处理的、已完成的、何时完成）以及创建一个总结我时间的每周报告。

我一直在使用一种非常简单的方法。我有一个大纲层次结构，顶部是月份，然后是星期，然后每天我都会建立我的任务。我使用 thisweek 属性在月级别设置了时钟表报告，以便在每周结束时获得一份报告，可用于填写我的考勤卡。

它看起来像这样：

```
* November
#+BEGIN: clocktable :maxlevel 5 :block thisweek :scope tree1 :link t
#+END: clocktable    
** Nov 5 - 9
*** Nov 5
**** admin, email
     CLOCK: [2012-11-05 Mon 14:28]--[2012-11-05 Mon 16:23] =>  1:55
     CLOCK: [2012-11-05 Mon 13:31]--[2012-11-05 Mon 13:36] =>  0:05
     CLOCK: [2012-11-05 Mon 13:20]--[2012-11-05 Mon 13:22] =>  0:02
     CLOCK: [2012-11-05 Mon 09:11]--[2012-11-05 Mon 09:14] =>  0:03
     CLOCK: [2012-11-05 Mon 08:03]--[2012-11-05 Mon 08:08] =>  0:05
**** TODO Fix scrubber to work with any environment
**** DONE Remedy Training
     CLOCK: [2012-11-05 Mon 08:30]--[2012-11-05 Mon 09:11] =>  0:41
**** TODO Improve label creation parsing
**** DONE CM Deploy: 8177529
     CLOCK: [2012-11-05 Mon 08:08]--[2012-11-05 Mon 08:21] =>  0:13 
```

可以，但是如果任务跨越一天，我需要为第二天创建一个新任务，否则无法正确创建时间表（即使将任务 - 连同其记录的时间 - 移动到第二天） .

现在我开始考虑使用议程，因为它看起来更强大、更优雅，但我遇到了同样的问题——如果我有一个任务安排在一天，但我没有完成，所以我需要把它移到第二天？

这似乎是一种很常见的情况，但我在 SOF 或网络上没有找到任何相关信息。也许它是如此基本，我只是做错了什么？即使是我对 org-mode 日常实际使用的超级参考，以[纯文本组织你的生活](http://doc.norang.ca/org-mode.html)似乎也没有解决这个问题。

我正在尝试实现两件事：1）如果我没有完成任务，则不必在多天内重新输入任务，以及 2）获得准确的每周报告（每日级别），不会重复计算或算错时间。

任何人都可以提出建议吗？

# matlab - 矩阵变换

> ID：13292228
> 
> 赞同：3
> 
> 时间：2012-11-08T15:35:35.873
> 
> 标签：matlab, matrix

我正在做一个项目，我需要将结果矩阵转换为更简单的矩阵。更具体地说，对于矩阵中的每一列，我想找到行中的最大值并将其更改为 1，其余的值将更改为 0。我不知道如何搜索这个问题，所以我决定发布在这里。

例如，我有一个矩阵 X：

```
X = [2 8 4; 7 3 9;1 2 3];
X = 2 8 4
    7 3 9
    1 2 3 
```

我想将此矩阵转换为

```
X' = 0 1 0
     1 0 1
     0 0 0 
```

我只知道如何使用 for 循环从每一行返回最大值，但我不确定如何返回该值在矩阵中的位置并将其余部分转换为零。

这是我的想法

1.  先新建一个同维零矩阵
2.  查找行中的最大值
3.  找到最大值的位置
4.  将值 1 分配到相同位置的新矩阵中
5.  通过 for 循环重复 2 和 3

我是matlab新手，希望对你有所帮助。

这是我的程序的结果之一

```
 2.0680   17.7410    0.8992   -3.0221
 3.6093    7.3443    6.7442    0.9874
-0.9095   -3.3220   -1.4857   -0.0023
-1.1753  -16.7906    0.3672    3.7697
-1.6856   -6.0929   -2.8614    0.5054
 1.0794    3.8352    1.9894    0.1686
-0.4584   -0.3923   -1.2525   -0.4761 
```

我希望这个矩阵变换到

```
0 1 0 0
1 0 1 0
0 0 0 0
0 0 0 1
0 0 0 0
0 0 0 0
0 0 0 0 
```

所以我认为 max() 不起作用的原因是因为我在矩阵中有负值

不使用 max() 列 1 到 5 的其他示例

```
 0.3816   23.2243   19.6435   23.2243   -3.1993
 3.8674    8.0762    6.0563    8.0762    1.8475
-0.4442   -4.0758   -3.4244   -4.0758    0.2073
 0.7639  -22.3618  -19.1365  -22.3618    3.9892
-1.8128   -6.4602   -5.1011   -6.4602   -0.4536
 0.2954    3.5886    3.1529    3.5886   -0.1403
-0.3723    0.8057    0.6607    0.8057   -0.5173 
```

第 5 至 10 列

```
 1.4814   19.6435    3.3100   23.2243    1.4814
 7.0255    6.0563    6.5251    8.0762    7.0255
-1.1483   -3.4244   -1.1448   -4.0758   -1.1483
-0.7784  -19.1365   -2.3904  -22.3618   -0.7784
-3.8880   -5.1011   -3.7437   -6.4602   -3.8880
 1.0289    3.1529    0.7994    3.5886    1.0289
-0.3723    0.8057    0.6607    0.8057   -0.5173 
```

第 11 至 15 列

```
 21.3957   19.6435    1.4814    0.3816   -3.1993
 8.5765    6.0563    7.0255    3.8674    1.8475
-4.0793   -3.4244   -1.1483   -0.4442    0.2073
-20.7498  -19.1365   -0.7784    0.7639    3.9892
-6.6046   -5.1011   -3.8880   -1.8128   -0.4536
 3.8181    3.1529    1.0289    0.2954   -0.1403
 0.4994    0.6607   -0.5829   -0.3723   -0.5173 
```

第 16 至 20 列

```
 -1.7736    9.5635   20.0251    1.8072    0.3816
   1.6114    7.0884    9.9237    3.6313    3.8674
  -0.0058   -2.3835   -3.8685   -0.6572   -0.4442
   2.1941   -8.7540  -18.3726   -1.0312    0.7639
  -0.5815   -4.5430   -6.9138   -1.9407   -1.8128
   0.1232    2.4470    3.4483    0.5589    0.2954
  -0.3588   -0.2377    0.2884   -0.2138   -0.3723 
```

正确答案是使用 bsxfun(@eq, output, max(output))

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T15:42:44.480

您可以使用[**bsxfun**](http://www.mathworks.nl/help/matlab/ref/bsxfun.html)检查一个值是否等于其列的最大值。

```
X = bsxfun(@eq, X, max(X)) 
```

请参阅我上面链接的文档以获取更多说明和 bsxfun 工作原理的示例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T15:43:20.403

不完全确定你的意思，但确实

```
>> bsxfun(@eq, X, max(X,[],2))  % maximum per row
ans =
     0     1     0
     0     0     1
     0     0     1 
```

接近？如果您的意思是每*列*的最大值，那么只需使用

```
>> bsxfun(@eq, X, max(X)) % maximum per column
ans =
     0     1     0
     1     0     1
     0     0     0 
```

# javascript - Push 方法 JavaScript 的替代方案

> ID：13292230
> 
> 赞同：-1
> 
> 时间：2012-11-08T15:35:48.713
> 
> 标签：javascript, arrays, push

嘿，我目前正在使用一个函数来匹配具有模式的页面，然后返回所有匹配的索引，例如

(index1_match1(['Apple','banana','bananas','chicken','bana'],'bana')) 将返回 (1,2,4)

目前我已经声明了一个空数组并使用 push 函数将数据添加到数组中是否有任何其他方法可以做到这一点，因为我不允许使用 push 函数，因为我们还没有被教导过

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:37:01.517

```
myArray[myArray.length] = "newvalue"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:06:52.570

您可以考虑使用`filter`- 此后的代码基于过滤器术语“bana”提供初始数组的子集：

```
var mapped = ['Apple','banana','bananas','chicken','bana']
              .filter( function(el){
                          if (/bana/i.test(el)) {
                                this[this.length] = el;} 
                          return true;
                        },[]);
//=> mapped is now ["banana", "bananas", "bana"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:37:43.293

您可以在 1 行中创建一个数组

```
var arr = ['Apple','banana','bananas','chicken','bana'] 
```

您可以创建一个空数组并分配元素

```
var arr = new Array()
arr[0] = 'Apple';
arr[1] = 'banana'; 
```

你可以告诉你的老师，他们是个白痴，通过*阅读*和*理解*一种语言，而不是仅仅向他们重复他们教给你的东西，这显示了他们的智慧和主动性。免责声明：如果你走这条路，我不会为你拘留！

# java - 通常如何将 jdbc resultSet 映射到用户定义的类？

> ID：13292232
> 
> 赞同：1
> 
> 时间：2012-11-08T15:35:51.210
> 
> 标签：java, jdbc, 4gl

我有一些从 4gl 到 java 执行相同功能的问题。4gl 代码有一些简短的解释。首先，AFPOPF1 是表，IO_AFPOPF1 是存储AFPOPF1 内容的变量。使用 'FETCH SCUR_1 INTO IO_AFPOPF1.*' 语句执行 WK_QUERY 并将行结果存储到 IO_AFPOPF1.*。运行 'FETCH SCUR_1 INTO IO_AFPOPF1.*' 后，光标指向下一行。在 while 循环中执行第二个查询，即哪个语句包含 IO_AFPOPF1.POLYN1。

```
DEFINE IO_AFPOPF1 RECORD LIKE AFPOPF1.*
     .
     .
     .
WK_QUERY  = "SELECT * FROM AFPOPF1 WHERE PRTDAT='IO_FONLY.PRTDAT'
       " AND((FCERNO[2] = 'C' AND LENGTH(FCERNO) = 9)"
       " OR (FCERNO[3] = 'C' AND LENGTH(FCERNO) = 10))"
       " AND SOLIN1 LIKE '", BS_SOLIN1,"'"
       " ORDER BY POLYN1,FCERNO"     
     .
     .
     . 
PREPARE SSTM_1 FROM WK_QUERY 
DECLARE SCUR_1 SCROLL CURSOR 
FETCH SCUR_1 INTO IO_AFPOPF1.*

WHILE STATUS = 0
    SELECT DEPTWN INTO WK_DEPTWN FROM COMLIB:DEPTPF1 
    WHERE DEPTNO = IO_AFPOPF1.POLYN1
    .
    .
    .
    IF WK_DEPTWN != IO_FONLY.DEPTWN
       FETCH SCUR_1 INTO IO_AFPOPF1.*
       CONTINUE  WHILE
    ELSE
       LET SW_COUNT = SW_COUNT+1   
    END  IF
    .
    .
    .
    FETCH SCUR_1 INTO IO_AFPOPF1.*
END WHILE 
```

爪哇：

```
//the class mapping to Afpopf1 Table
public class TableAfpopf1 {
   private String fcerno;//var1
   private String polyn1;//var2
      .
      .
      .
   private Date chkdat;//var58  

   public void setXXX
      .
      .
      .
}

//database connection anf return resultSet  
public class DBConnection {
    private Connection connection;
    private Statement statement;
    private PreparedStatement preS;
    private ResultSet resultSet;
    private boolean hasRow;
    private boolean isReturn;   
    private String dbURL;
    private ArrayList<ArrayList<Object>> allResultList;
    private Object returnObj;

    public DBConnection() {
        this.connection = null;
        this.statement = null;
        this.preS = null;
        this.resultSet = null;
        this.hasRow = false;
        this.isReturn = false;
        this.dbURL = "";        
        this.allResultList =  new ArrayList<ArrayList<Object>>();
    }

public void connectDB(String query) {
    try {            
        statement = connection.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);

        if (query.contains("SELECT"))
            resultSet = statement.executeQuery(query);

        ResultSetMetaData metaData = resultSet.getMetaData();
        int numberOfColumns = metaData.getColumnCount();

        while (resultSet.next()) {
           hasRow = true;
           if (isReturn) {                 
               if (numberOfColumns == 1) {
                  resultSet.last();
                  int rowCount = resultSet.getRow();
                  resultSet.first();

                  if (rowCount == 1)                          
                      returnObj = resultSet.getObject(1);                                             
               }
               else {
                   ArrayList<Object> arrayResultSet = new ArrayList<Object>();
                   for (int i = 1; i <= numberOfColumns; i++) {
                       arrayResultSet.add(resultSet.getObject(i));                         
                   }                       
                   allResultList.add(arrayResultSet);                      
               }                 
           }
           else                    
               break;                  
          }          
    }
    catch (SQLException sqlEx) {
        while(sqlEx != null) {
            System.err.println("SQLException information");
            System.err.println("Error msg: " + sqlEx.getMessage());
            System.err.println("SQLSTATE: " + sqlEx.getSQLState());
            System.err.println("Error code: " + sqlEx.getErrorCode());
            sqlEx.printStackTrace();
            sqlEx = sqlEx.getNextException();
       }
    }        
    finally {
        try {
            resultSet.close();
            statement.close();            
        }
        catch (Exception e) {
            e.printStackTrace();
        }    
    }                      
}

public void preQueryConnectDB(String query,String expression) {
    try {               
        preS = connection.prepareStatement(query,ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);
        preS.setString(1, query);
        resultSet = preS.executeQuery();            
        ResultSetMetaData metaData = resultSet.getMetaData();
        int numberOfColumns = metaData.getColumnCount();            

        while (resultSet.next()) {              
            hasRow = true;
            if (isReturn) {                 
                if (numberOfColumns == 1) {
                    resultSet.last();
                    int rowCount = resultSet.getRow();
                    resultSet.first();

                    if (rowCount == 1)                          
                        returnObj = resultSet.getObject(1);                                             
                }
                else {
                    ArrayList<Object> arrayResultSet = new ArrayList<Object>();
                    for (int i = 1; i <= numberOfColumns; i++) {
                         arrayResultSet.add(resultSet.getObject(i));     
                    }                          
                    allResultList.add(arrayResultSet);                      
               }                  
            }
            else                 
                break;                
        }            
    }catch (SQLException sqlEx) {
        while(sqlEx != null) {
            System.err.println("SQLException information");
            System.err.println("Error msg: " + sqlEx.getMessage());
            System.err.println("SQLSTATE: " + sqlEx.getSQLState());
            System.err.println("Error code: " + sqlEx.getErrorCode());
            sqlEx.printStackTrace();
            sqlEx = sqlEx.getNextException();
        }
    }       
    finally {
       try {
           resultSet.close();
           preS.close();                
        }
        catch (Exception e) {
           e.printStackTrace();
        }   
    }                     
}

public void closeDBConnection() { 
    try {
        connection.close();             
    }
    catch (Exception e) {
        e.printStackTrace();
    }   
}

public void setIsReturnData(boolean isReturn) { this.isReturn = isReturn; }

public void setConnectionURL(String query) {
    String dbName = "";
    String newURL = "";
    int beginIndex = -1; //string from in index is positive
    int endIndex = -1;  //string : in index is positive
    beginIndex = query.indexOf("FROM");
    endIndex = query.indexOf(":");
    dbName = query.substring(beginIndex+4, endIndex).trim();
    newURL = "jdbc:informix-sqli://hwae5500:shme5500/"+dbName+":INFORMIXSERVER=shme5500;";

    if (!newURL.equals(dbURL)) {
        dbURL = newURL;
        try {
            if (connection != null)
               connection.close();
               Class.forName("com.informix.jdbc.IfxDriver");
               connection = DriverManager.getConnection(dbURL);
        }catch (SQLException e) {
            e.printStackTrace();
        }
        catch(ClassNotFoundException drvEx) {
            System.out.println("Driver fail");
            drvEx.printStackTrace();
        }       
    }        
}

public void recoverDefultValue() {
    this.statement = null;
    this.preS = null;
    this.resultSet = null;
    this.hasRow = false;
    this.isReturn = false;      
    this.returnObj = null;      
}

public boolean getHasRow() { return hasRow; }

public Object getReturnObj(){ return returnObj; }

//get all resultSet in Object type
public ArrayList<ArrayList<Object>> getAllResultList() { return allResultList; }
}

//the class receive query result and process data
pubblic class DataProcessing {
      .
      .
      .
    public void generateInformation() {
      .
      .
      .
        sqlQuery = "SELECT * FROM AFFIL:AFPOPF1 WHERE PRTDAT="+"'"+dateStr+"'"+
           "AND FCERNO[2]='C' AND LENGTH(FCERNO)=9 "+
       "AND SOLIN1 LIKE '"+bs_SOLIN1+"' ORDER BY POLYN1,FCERNO";

        db.recoverDefultValue();
        db.setIsReturnData(true);
        db.setConnectionURL(sqlQuery);
        db.connectDB(sqlQuery);
        if (db.getHasRow()) {
           setDataList(db.getAllResultList(),1);//Object type to Afpopf1 type
           sw_DATA = true;                  
        }
        .
        .
        .
        if (codeStr.charAt(0) == '0') {             
            sqlQuery = "SELECT DEPTWN FROM COMLIB:DEPTPF1 WHERE DEPTNO=?";
            db.recoverDefultValue();
            db.setIsReturnData(true);
            db.setConnectionURL(sqlQuery);          
            for (TableAfpopf1 tafp : Afpopf1List) {             
                db.preQueryConnectDB(sqlQuery,tafp.getPolyn1());
                wk_DEPTWN = setVarwk_DEPTWN((String)db.getReturnObj());
            }           
         }
            .
            .
            .           
    }

private void setDataList(ArrayList<ArrayList<Object>> allResultList,int choiceNum)                                                              
{
    int inputindex = 0;
    DateFormat sdf = new SimpleDateFormat("yyyy-mm-dd");        
    if (choiceNum == 1) {
        for (int i=0; i<allResultList.size(); i++) {                
            TableAfpopf1 afpItem = new TableAfpopf1();
            for (Object obj : allResultList.get(i)) {
                switch (inputindex+1) {
                case 1:
                    afpItem.setFcerno((String)obj);
                    break;
                case 2:
                    afpItem.setPolyn1((String)obj);
                    break;
                    .
                    .
                    .
                case 58:                            
                    try {
                        Date date = sdf.parse(obj.toString());
                        afpItem.setChkdat(date);                                
                    }
                    catch (Exception e) {
                       System.out.println("error appear");
                       e.printStackTrace();
                    }                                           
                    break;    
            }                   
            inputindex++;
        }
        Afpopf1List.add(afpItem);               
        }           
    }
    else if (choiceNum == 2) {

    }
} 
```

}

* * *

我认为 setDataList() 和 setDataList() 不是好方法。当我在java中实现一个程序时，setDataList()方法只映射到Afpopf1，我写了case来映射DB表的每个变量。它不是有效的代码而且很愚蠢。然后，如果 4gl 程序有一个新的表变量，我必须为该表编写另一个方法来接收数据。

我认为这不是一个好主意，所以我想知道如何改进java代码，或者告诉我在java中实现该功能的正确方法。我以前没有接触过Java EE。

如果解决方案是关于 Java EE，我希望答案是详细的或包含一些示例代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T15:38:23.317

您可能会失望，但实际上是这样完成的，例如使用 Spring JDBC 模板：每个 SQL 查询都手动编码映射到适当的 bean 对象。

如果您希望它自动完成，您应该考虑使用诸如 Hibernate 之类的 ORM 而不是原始 JDBC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:47:05.187

看到这个：

[http://www.codeproject.com/Tips/372152/Mapping-JDBC-ResultSet-to-Object-using-Annotations](http://www.codeproject.com/Tips/372152/Mapping-JDBC-ResultSet-to-Object-using-Annotations)

您需要为应用 ResultSetMapper 做 Enity 类

# python - python用类编写装饰器

> ID：13292234
> 
> 赞同：3
> 
> 时间：2012-11-08T15:35:59.127
> 
> 标签：python, decorator, mutable

这是我编写辅助装饰器模块的努力：

```
# -*- coding: utf8 -*-

import time
def timer(func):
    def timed(*args, **kwargs):
        init = time.clock()
        result = func(*args, **kwargs)
        print (time.clock()-init)*1000, 'ms'

        return result    
    return timed

class memo(object):
    def __init__(self, func):
        self.func = func
        self.memo = {}
        self.memohit = 0   

    def memoizedf(self, *args):
        key = tuple(args)
        print key
        lookup = self.memo.setdefault(key, None)
        if lookup:
            self.memohit += 1 
            return lookup

        result = self.func(*args)
        self.memo[key]=result
        return result

    def __call__(self, *args):
        return self.memoizedf(*args) 
```

所以，用法：

```
@timer
def foo():
    print 'foo'

'foo'
00023.1231203879 ms

@memo
def bar(fooobject):
    print fooobject 
```

问题来了：

```
>>bar({'foo':'bar'})

traceback : ...........
    lookup = self.memo.setdefault(key, None)
TypeError: unhashable type: 'dict' 
```

list、dict 或集合中其他可变的每个输入都会引发此类错误。我尝试对所有参数进行元组处理，但显然这没有帮助。我应该如何重写我的代码才能让我的装饰器与任何类型的输入一起工作（好吧，只是 dict、list、tuple、set、int、string... 可以）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:19:58.107

我建议在散列之前序列化可变参数，例如使用[pickle](http://docs.python.org/2/library/pickle.html)模块。函数参数中的任何 dict、list 或类似内容的内容都必须是可挑选的，否则`PicklingError`将引发 a。在您的定义中`memoizedf`，您可以使用以下代码：

```
key = pickle.dumps((args,kwargs))
lookup = self.memo.setdefault(key, None) 
```

许多对象是可腌制的，但不是可散列的，因此这应该扩展您可以显着处理的参数类。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T16:20:28.047

这可以解决问题：

```
key = str(tuple(args)) 
```

# linux - 在 Ubuntu 12.04 中通过终端发送电子邮件

> ID：13292235
> 
> 赞同：1
> 
> 时间：2012-11-08T15:36:02.770
> 
> 标签：linux, email, shell, terminal, ubuntu-12.04

我想通过指定发件人电子邮件地址以及收件人的电子邮件地址来编写一个用于发送电子邮件的自动 shell 脚本......我尝试使用 mailx 但没有用..请帮助！！！

# c++ - 连接两个 `const char` 字符串文字

> ID：13292237
> 
> 赞同：16
> 
> 时间：2012-11-08T15:36:11.667
> 
> 标签：c++, c++11, c-preprocessor, constexpr, string-literals

是否可以使用 a 连接两个字符串文字`constexpr`？或者换一种说法，可以消除代码中的宏，例如：

```
#define nl(str) str "\n"

int main()
{
  std::cout <<
      nl("usage: foo")
      nl("print a message")
      ;

  return 0;
} 
```

**更新**： using 没有任何问题`"\n"`，但是我想知道是否可以使用`constexpr`来替换那些类型的宏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-08T17:31:03.873

一点点`constexpr`，撒上一些 TMP 和指数的顶部给了我这个：

```
#include <array>

template<unsigned... Is> struct seq{};
template<unsigned N, unsigned... Is>
struct gen_seq : gen_seq<N-1, N-1, Is...>{};
template<unsigned... Is>
struct gen_seq<0, Is...> : seq<Is...>{};

template<unsigned N1, unsigned... I1, unsigned N2, unsigned... I2>
constexpr std::array<char const, N1+N2-1> concat(char const (&a1)[N1], char const (&a2)[N2], seq<I1...>, seq<I2...>){
  return {{ a1[I1]..., a2[I2]... }};
}

template<unsigned N1, unsigned N2>
constexpr std::array<char const, N1+N2-1> concat(char const (&a1)[N1], char const (&a2)[N2]){
  return concat(a1, a2, gen_seq<N1-1>{}, gen_seq<N2>{});
} 
```

[活生生的例子。](http://liveworkspace.org/code/3a783ab2f5991ae74ee18b1c0b9ac8e2)

我会再充实一些，但我必须开始并想在那之前把它放下。你应该能够从中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:26:08.153

*   您不能从函数返回（普通）数组。
*   您不能`const char[n]`在 constexpr (§7.1.5/3 dcl.constexpr) 中创建新的。
*   *地址常量表达式*必须引用静态存储持续时间的对象（§5.19/3 expr.const） - 这不允许使用具有 constexpr ctor 组装数组以进行连接的类型对象的一些技巧，而您的 constexpr fct 只是将其转换为 ptr .
*   传递给 constexpr 的参数不被视为编译时常量，因此您也可以在运行时使用 fct - 这不允许模板元编程的一些技巧。
*   您不能将字符串文字的单个字符作为模板参数传递给函数 - 这不允许其他一些模板元编程技巧。

所以（据我所知），你不能得到一个 constexpr 返回`char const*`一个新构造的字符串的 a 或 a `char const[n]`。请注意，这些限制中的大多数并不适用于`std::array`Xeo 所指出的。

*即使您可以返回 some `char const*`，返回值也不是文字，并且只有相邻的字符串文字被连接起来。这发生在翻译阶段 6（第 2.2 节）中，我仍将其称为预处理阶段。Consexpr 稍后评估（参考？）。（函数`f(x) f(y)`在哪里`f`是语法错误afaik）*

但是您可以从您的 constexpr fct 返回包含两个字符串并且可以插入/打印到`basic_ostream`.

* * *

编辑：这是示例。它有点长 oO 请注意，您可以简化它，以便在字符串末尾添加一个额外的“\n”。（这更像是我刚刚从记忆中写下来的通用方法。）

Edit2：实际上，您不能真正简化它。将数据成员创建`arr`为包含 '\n' 的“const char_type 数组”（而不是字符串文字数组）使用一些花哨的可变参数模板代码，这些代码实际上有点长（但它有效，请参阅 Xeo 的答案）。

注意：由于`ct_string_vector`（名称不好）存储指针，它应该只与静态存储持续时间的字符串（例如文字或全局变量）一起使用。优点是不必通过模板机制复制和扩展字符串。如果您使用 constexpr 来存储结果（如示例中`main`），如果传递的参数不是静态存储持续时间，您的编译器应该抱怨。

```
#include <cstddef>
#include <iostream>
#include <iterator>

template < typename T_Char, std::size_t t_len >
struct ct_string_vector
{
    using char_type = T_Char;
    using stringl_type = char_type const*;

private:
    stringl_type arr[t_len];

public:
    template < typename... TP >
    constexpr ct_string_vector(TP... pp)
        : arr{pp...}
    {}

    constexpr std::size_t length()
    {  return t_len;  }

    template < typename T_Traits >
    friend
    std::basic_ostream < char_type, T_Traits >&
    operator <<(std::basic_ostream < char_type, T_Traits >& o,
        ct_string_vector const& p)
    {
        std::copy( std::begin(p.arr), std::end(p.arr),
            std::ostream_iterator<stringl_type>(o) );
        return o;
    }
};

template < typename T_String >
using get_char_type =
    typename std::remove_const < 
    typename std::remove_pointer <
    typename std::remove_reference <
    typename std::remove_extent <
        T_String
    > :: type > :: type > :: type > :: type;

template < typename T_String, typename... TP >
constexpr
ct_string_vector < get_char_type<T_String>, 1+sizeof...(TP) >
make_ct_string_vector( T_String p, TP... pp )
{
    // can add an "\n" at the end of the {...}
    // but then have to change to 2+sizeof above
    return {p, pp...};
}

// better version of adding an '\n':
template < typename T_String, typename... TP >
constexpr auto
add_newline( T_String p, TP... pp )
-> decltype( make_ct_string_vector(p, pp..., "\n") )
{
    return make_ct_string_vector(p, pp..., "\n");
}

int main()
{
    // ??? (still confused about requirements of constant init, sry)
    static constexpr auto assembled = make_ct_string_vector("hello ", "world");
    enum{ dummy = assembled.length() }; // enforce compile-time evaluation
    std::cout << assembled << std::endl;
    std::cout << add_newline("first line") << "second line" << std::endl;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T19:25:50.377

1.  是的，完全可以创建编译时常量字符串，并使用 constexpr 函数甚至运算符来操作它们。然而，

2.  除了静态和线程持续时间对象之外，编译器不需要执行任何对象的常量初始化。特别是，临时对象（不是变量，并且具有小于自动存储持续时间的东西）不需要进行常量初始化，据我所知，没有编译器对数组这样做。参见 3.6.2/2-3，它定义了常量初始化，以及 6.7.4 中关于块级静态持续时间变量的更多措辞。这些都不适用于临时人员，其生命周期在 12.2/3 及以下版本中定义。

因此，您可以通过以下方式实现所需的编译时连接：

```
static const auto conc = <some clever constexpr thingy>;
std::cout << conc; 
```

但你不能让它工作：

```
std::cout <<  <some clever constexpr thingy>; 
```

**更新：**

但是你**可以**让它工作：

```
std::cout << *[]()-> const {
             static constexpr auto s = /* constexpr call */;
             return &s;}()
          << " some more text"; 
```

但是样板标点符号太丑陋了，不能使它成为一个有趣的小技巧。

* * *

（免责声明：IANALL，虽然有时我喜欢在互联网上玩一个。所以标准中可能有一些尘土飞扬的角落与上述内容相矛盾。）

（尽管有免责声明，并由@DyP 推动，我添加了更多的语言律师引用。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T15:52:05.090

乍一看，C++11 用户定义的字符串文字似乎是一种更简单的方法。（例如，如果您正在寻找一种在编译时全局启用和禁用换行注入的方法）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T16:25:31.797

不，因为`constexpr`您首先需要一个合法的函数，而函数不能粘贴字符串文字参数等。

如果您考虑常规函数中的等效表达式，它将分配内存并连接字符串 - 绝对不适合`constexpr`.

# java - Grails Oauth2 提供者 NullPointerException

> ID：13292240
> 
> 赞同：1
> 
> 时间：2012-11-08T15:36:26.667
> 
> 标签：java, grails, oauth, spring-security, oauth-2.0

我正在尝试在 Grails 中使用 Oauth2，但无法正常工作。尝试获取接入点时出现 NullPointerException。
所以更多细节：使用[Spring Security Oauth2 Provider](http://grails.org/plugin/spring-security-oauth2-provider)插件。我在 BootStrap.groovy 中注册了一个客户端（使用 BaseClientDetails），根据[教程](https://github.com/adaptivecomputing/grails-spring-security-oauth2-provider)，客户端可以使用以下 URL 使用 tokenEndpointUrl 设置（默认为 /oauth/token）中给出的 URL 登录：localhost:8080/app/ oauth/token?grant_type=client_credentials&client_id=clientId&client_secret=clientSecret 。

但是 grails.plugin.cache.web.filter.PageFragmentCachingFilter 抛出异常，在下面描述的方法中，由于某种奇怪的原因，controllerClass 为 null。

```
841  protected Object lookupController(Class<?> controllerClass) { <br>
842  return getBean(controllerClass.getName()); <br>
843  } 
```

并且控制器类为空，因为 grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter 试图从上下文（ getContext().getControllerClass() ）中获取控制器类，但返回了空。
全栈在这里[http://pastebin.com/euramNaS](http://pastebin.com/euramNaS)

当我通过常规登录流程时（不是直接使用 URL，而是通过登录表单）。我在同一个地方获取了 LoginController。在调试模式下，我将断点设置为“有问题的”行，并使用 LoginController 手动更改 controllerClass（添加 controllerClass = LoginController.class 来观看）它成功了，我收到了带有令牌的 JSON。

尝试制作空应用程序以清楚地重现问题并重现问题。所以可以找到测试项目[http://goo.gl/1gmtT](http://goo.gl/1gmtT)。
任何想法为什么直接访问 url 时无法初始化控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T11:43:01.107

卸载缓存插件就可以了。可以将缓存插件配置为忽略

```
/oauth 
```

网址

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T19:16:21.707

正如@cubic1271 所说，将缓存插件升级到 1.1.1 对我有用。

在 BuildConfig.groovy 中确保这一点

```
compile ':cache:1.1.1' 
```

您也可以在命令行中使用 grails list-plugins 检查它

```
$ grails list-plugins
Plug-ins you currently have installed are listed below:
-------------------------------------------------------------
cache               1.1.1            --  Cache Plugin 
```

# android - 我在 Android 模拟器中看不到“sdcard”文件夹

> ID：13292244
> 
> 赞同：0
> 
> 时间：2012-11-08T15:36:37.367
> 
> 标签：android, emulation, sd-card

我已经使用 Android 模拟器和 SD 卡没有问题，但是，我认为 Android 的最后更新发生了任何事情，因为之前，我可以在“文件资源管理器”中看到“sdcard”文件夹，但现在，我在“文件资源管理器”中看不到“sdcard”文件夹，也无法保存任何文件，具有相同的应用程序和配置。

在我的 Android 清单中

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
 <uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" /> 
```

我的 AVD 具有以下配置：

![AVD 配置](../Images/99eedc910d38af85dc1ed3a3201e0466.png)

这就是我在“文件资源管理器”中看到的内容。没有任何“sdcard”文件夹。

![文件管理器](../Images/761889ffa2f0cde5a0514c76f186cf50.png)

如果我使用带有命令的命令行工具午餐 avd：

```
emulator -avd em22 -sdcard C:\route-to-sdcard-image\sdcard.img 
```

我可以在 LogCat 窗口中看到下一个条目序列：

```
11-09 03:41:26.723: D/MediaScannerService(230): done scanning volume internal

11-09 03:41:26.743: D/MediaScannerService(230): start scanning volume external
11-09 03:41:26.833: V/MediaProvider(230): /mnt/sdcard volume ID: 167983881
11-09 03:41:27.523: I/Launcher.Model(154): not binding apps: no Launcher activity
11-09 03:41:27.833: D/dalvikvm(154): GC_EXPLICIT freed 4865 objects / 268728 bytes in 298ms
11-09 03:41:31.143: D/dalvikvm(154): GC_EXPLICIT freed 11622 objects / 580656 bytes in 226ms
11-09 03:41:31.253: V/MediaProvider(230): Attached volume: external
11-09 03:41:31.444: V/MediaScanner(230): pruneDeadThumbnailFiles... android.database.sqlite.SQLiteCursor@44ebd0b8
11-09 03:41:31.453: V/MediaScanner(230): /pruneDeadThumbnailFiles... android.database.sqlite.SQLiteCursor@44ebd0b8
11-09 03:41:31.497: D/MediaScanner(230):  prescan time: 155ms
11-09 03:41:31.497: D/MediaScanner(230):     scan time: 4ms
11-09 03:41:31.523: D/MediaScanner(230): postscan time: 67ms
11-09 03:41:31.523: D/MediaScanner(230):    total time: 226ms
11-09 03:41:31.553: D/MediaScannerService(230): done scanning volume external 
```

但是，在我的文件资源管理器中，我还看不到“sdcard”文件夹。如果我尝试写入 SD 卡，则会出现下一个错误：

```
11-09 03:43:32.613: E/Functions(303): writeFile: java.io.FileNotFoundException: /mnt/sdcard/DCIM/BasketMonitor/2012-11-09-03:43:32-hola- (No such file or directory) 
```

如果我尝试将任何文件推送到 SD 卡，我会收到下一个错误：

```
[2012-11-09 04:52:31 - ddms] transfer error: Read-only file system
[2012-11-09 04:52:31] Failed to push selection: Read-only file system 
```

我什么都不懂！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T04:24:55.777

看到这个 /mnt/sdcard 你会发现 sdcard 文件夹。

![在此处输入图像描述](../Images/7e11d307f5b72e699888cdc54dd05a28.png)

# excel - Excel 自动完成和自动填充键盘快捷键

> ID：13292245
> 
> 赞同：3
> 
> 时间：2012-11-08T15:36:38.400
> 
> 标签：excel, keyboard-shortcuts

是否有人具有同时执行**AutoFill**和**AutoComplete**的 Excel 键盘快捷键，作为鼠标的替代品，*即*：**选择**（1 2 3）**+双击**（右下角）：

```
+--- +-------+
|Rank|  A    |
+--- +-------+
| 1  | a     |
| 2  | b     |
| 3  | c     |
|    | d     |
|    | e     |
|    | f     |
|    | g     |
+--- +-------+ 
```

我知道一个键盘替代方案：**ALT+E+ENTER+I+S+F+ENTER**但这并不能完成整个工作（鼠标双击自动完成）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-11T06:24:18.787

`Alt`+ `E`+ `I`+`S`然后按 ENTER。默认情况下，选择线性选项，即数值！对于自动填充月份或日期，请选择自动填充选项，然后按 ENTER。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-29T06:51:20.883

使用 Ctlr+Down/Right 键选择要填充的单元格，然后按 Ctrl+D（向下填充）或 Ctrl+R（向右填充）。[在此处](https://softwareaccountant.com/excel-auto-fill/)阅读有关此自动填充技术的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T11:54:32.983

如果要复制的单元格包含公式，那么我的解决方案是激活此单元格，然后使用 Shift + Down Arrow 或 Ctrl + Shift + End 或 sg 选择我要将公式复制到的区域这个。所以所选区域的白色单元格将是我要复制的单元格。然后按 F2，然后 Ctrl + Enter 将进行复制。

如果你想用数字自动完成区域，首先选择区域，然后按 Alt，然后按字母到达自动完成，然后在里面自动完成系列（或者像这样的 sg，我的办公室是匈牙利语）。窗口中的默认设置应该是好的，所以只需要回车即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-24T08:25:10.357

选择+双击右下角，调用填充系列对话框中的默认值（菜单：主页->填充->系列+输入）。

您可以使用此快捷方式轻松调用上述内容，而无需任何鼠标交互：`Alt + H + F + I + S + Enter`

# .net - 有没有办法为脚本设置路径？

> ID：13292249
> 
> 赞同：0
> 
> 时间：2012-11-08T15:36:45.263
> 
> 标签：.net, ajax

我正在使用许多生成脚本的 ajax 实用程序。ModalPopupExtender 就是其中之一。

我已经为我的所有 css/js/images 等设置了一个静态子域，我只是在路径前添加。

我想做的是对 ajax 脚本做同样的事情——这可能吗？实际上，我想将脚本捆绑到我自己的 CDN 上。

![在此处输入图像描述](../Images/a0aa729a35e953013c015ca22d19a43c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:38:55.787

Here's some documentation:

[http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.scripts.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.scripts.aspx) (.Net 4.0 and above)
[http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.scriptpath(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.scriptpath%28v=vs.90%29.aspx) (.Net 3.5)

The script files are at:

(see comment, not enough rep...)

You should then be able to change the script path for each script resource and away you go.

# android - 如何将视图持有者实现到数组适配器中

> ID：13292250
> 
> 赞同：-1
> 
> 时间：2012-11-08T15:36:45.883
> 
> 标签：android, android-layout, android-listview

**更新 ** 嘿伙计们，我自己解决了我的问题，我使用了[https://github.com/koush/UrlImageViewHelper/blob/master/README.md](https://github.com/koush/UrlImageViewHelper/blob/master/README.md) 并通过 UrlImageViewHelper.setUrlDrawable(image,ei.img_url); 来自我的 Entryadapter 类，它运行良好。

我想在列表中显示带有 3 个文本和一个带有分隔符/部分的图像视图的 Listview。所以我按照本教程[http://bartinger.at/listview-with-sectionsseparators/](http://bartinger.at/listview-with-sectionsseparators/)？

比我面临加载图像（位图）的问题，所以我使用文件和 bitmapfactory 通过使用 AsyncTask 在列表视图上显示位图。

但问题是每次我向上或向下滚动时它都会加载。我想显示一次列表，所以我试图为我的列表实现视图持有者，但由于我是 android 和 Java 的新手，我不知道如何将它实现到我的代码。

谁能帮我？我附上了所有代码文件，因此此代码将有助于其他学生和像我这样的新生。

这是我的 Entryadaptor.java

```
public class EntryAdapter extends ArrayAdapter<Item> {
private Context context;
private ArrayList<Item> items;
private LayoutInflater vi;
Uri myurl;
ImageView image;
public EntryAdapter(Context context,ArrayList<Item> items) {
    super(context,0, items);
    this.context = context;
    this.items = items;
    vi = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    final Item i = items.get(position);
    if (i != null) {
        if(i.isSection()){
            SectionItem si = (SectionItem)i;
            v = vi.inflate(R.layout.list_item_section, null);
            v.setOnClickListener(null);
            v.setOnLongClickListener(null);
            v.setLongClickable(false);
            final TextView sectionView = (TextView) v.findViewById(R.id.list_item_section_text);
            sectionView.setText(si.getTitle());
        }else
          {
            EntryItem ei = (EntryItem)i;
            v = vi.inflate(R.layout.list_item_entry, null);
            final TextView title = (TextView)v.findViewById(R.id.list_item_entry_title);
            final TextView subtitle = (TextView)v.findViewById(R.id.list_item_entry_summary);
            image = (ImageView)v.findViewById(R.id.showlist_item_entry_drawable);
            if (title != null) 
                title.setText(ei.title);
            if(subtitle != null)
                subtitle.setText(ei.subtitle);
                 if(image !=null)
                 { 
                 try {
                      URL onLineURL = new URL(ei.img_url);
                       new MyNetworkTask(image).execute(onLineURL);
                      } catch (MalformedURLException e) {
                       e.printStackTrace();
                      }}}}
    return v;
    }
  private class MyNetworkTask extends AsyncTask<URL, Void, Bitmap>{
         ImageView tIV;
         public MyNetworkTask(ImageView iv){
          tIV = iv;
         }
      @Override
      protected Bitmap doInBackground(URL... urls) {
       Bitmap networkBitmap = null;
       URL networkUrl = urls[0]; //Load the first element
       try {
        networkBitmap = BitmapFactory.decodeStream(
          networkUrl.openConnection().getInputStream());
       } catch (IOException e) {
        e.printStackTrace();
       }
       return networkBitmap;
      }
      @Override
      protected void onPostExecute(Bitmap result) {
       tIV.setImageBitmap(result);
      }
        } 
```

}

这是片段代码

```
public class ShowsFragment extends SherlockListFragment { ArrayList<Item> items = new ArrayList<Item>();
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
     items.add(new SectionItem("Today"));
        items.add(new EntryItem("Item 1", "This is item 1.2","http://pierre.chachatelier.fr/programmation/images/mozodojo-original-image.jpg"));
        items.add(new EntryItem("Item 2", "This is item 1.3","http://upload.wikimedia.org/wikipedia/commons/8/85/Image-New_Delhi_Lotus.jpg"));
        items.add(new SectionItem("This Week"));
        items.add(new EntryItem("Item 4", "This is item 2.1","https://twimg0-a.akamaihd.net/profile_images/1080041262/VMIX_logo_zoom_bkbg1_normal.png")); EntryAdapter adapter = new EntryAdapter(getActivity(), items);
        setListAdapter(adapter);
    }
    public void onListItemClick(ListView l, View v, int position, long id) {
        if(!items.get(position).isSection()){
            EntryItem item = (EntryItem)items.get(position);
            Toast.makeText(getActivity(), "You clicked " + item.title , Toast.LENGTH_SHORT).show();
        }
        super.onListItemClick(l, v, position, id);
    }
} 
```

部分项目代码

```
public class SectionItem implements Item{
private final String title;
public SectionItem(String title) {
    this.title = title;
}
public String getTitle(){
    return title;
}
public boolean isSection() {
    return true;
} 
```

}

条目类代码

```
public class EntryItem implements Item{
public final String title;
public final String subtitle;
public final String img_url;
public EntryItem(String title, String subtitle,String Image_url) {
    this.title = title;
    this.subtitle = subtitle;
    this.img_url = Image_url;
}
public boolean isSection() {
    return false;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:42:18.473

我建议在某处缓存加载的位图，以便在上下滚动时避免服务器调用（例如使用地图）。此外，由于您正在异步加载位图，一旦您加载了数据，请确保视图仍然是设置图像的正确视图，因为视图在 Listview 中被回收（因此名称为“convertView”）。例如

```
 if (item.equals(imageView.getTag())) {
        // only set image if Tag is still valid
        imageView.setImageDrawable(drawable);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-13T04:03:04.863

为 KoljaTM 竖起大拇指。它解决了我的类似问题。我在gridview中使用线程来加速，我遇到了一些图片位置相互混合的问题。采用 KoljaTM 的方法后，没有出现任何扭曲。谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T10:07:40.490

嘿，伙计们，只需将此库放入您的项目中并传递图像视图对象和 url 并完成 [https://github.com/koush/UrlImageViewHelper/blob/master/README.md](https://github.com/koush/UrlImageViewHelper/blob/master/README.md)

# wpf - ListCollectionView，找到 AddNew() 将创建的类型？

> ID：13292255
> 
> 赞同：0
> 
> 时间：2012-11-08T15:36:56.697
> 
> 标签：wpf, generics, reflection, listcollectionview, typeinfo

我有一个自定义控件，它“可以”将 ListCollectionView 作为 ItemsSource 传递，我需要 Child-Type 的反射使用。

现在我可以从第一个元素中找到类型：

```
Type t = lcv.GetItemAt(0).GetType(); 
```

但是，当 Collection 为空时，这将不起作用。

它也可以通过调用`AddNew()`

```
Object o = lcv.AddNew()
Type t = o.GetType(); 
```

但我不想调用 AddNew 只是为了创建一个虚拟对象，因为这会导致错误作为站点效应。

但是，如果方法“AddNew()”知道要创建哪种类型的对象，则必须有一种方法可以找出实际的 Child-Type 而无需创建一个。

我用过 google、msdn 以及 Try & Error 却找不到方法。

一些想法？提前致谢 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:49:31.113

您可以使用[GetGenericArguments](http://msdn.microsoft.com/it-it/library/system.type.getgenericarguments.aspx)来查找集合中包含的类型

```
var type = lcv.SourceCollection.GetType().GetGenericArguments()[0] 
```

# ruby - 为什么method_defined？还给我假？

> ID：13292258
> 
> 赞同：1
> 
> 时间：2012-11-08T15:37:05.967
> 
> 标签：ruby

```
o = Object.new

class << o
  public :puts
end
o.puts "1\. #{o.class.method_defined? :puts}"              => false
o.puts "2\. #{o.class.method_defined? :public_methods}     => true 
```

方法定义？还给我假？即使我宣布看跌期权是公开的，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:56:50.387

```
o.class
=> Object

Object.method_defined? :puts
=> false

o.singleton_class
=> #<Class:#<Object:0x2b23858>>

o.singleton_class.method_defined? :puts
=> true 
```

我认为上面的代码显示了非常清楚的解释。如果你修改了对象本身，你应该使用`singleton_class`来访问而不是`class`因为原来的类不包含你添加的单例方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:50:00.527

[解释的文档`method_defined?`](http://www.ruby-doc.org/core-1.9.3/Module.html#method-i-method_defined-3F)：

> 如果命名方法由 mod（或其包含的模块，如果 mod 是一个类，它的祖先）定义，则返回 true

并且[该`public`方法](http://www.ruby-doc.org/core-1.9.3/Module.html#method-i-public)仅设置可访问性；它不会将方法定义移动到对象的上下文中。

# redirect - 一个应用程序的多个上下文根

> ID：13292259
> 
> 赞同：1
> 
> 时间：2012-11-08T15:37:09.627
> 
> 标签：redirect, jboss, forwarding, mdm

我们已重命名 Apple MDM 使用的上下文根，现在需要向后兼容已注册的设备。我们正在运行 JBoss

我的第一次尝试只是将第二个模块条目添加到 application.xml 具有新的上下文根但相同的战争文件。我没有工作，除非我用新名称复制了战争文件。我真的不喜欢这个解决方案，虽然它有效。

相反，我尝试将 Valve 添加到根应用程序，然后它将旧上下文根重定向到新上下文根。这也很有效，直到设备进行 POST，然后发布的二进制内容丢失。
这个解决方案的好处是我们可以建立一个新的上下文根，为处理 Android 和 Windows Phone 的 MDM 做好准备。

这可以通过前锋来完成，然后应该如何实施？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:09:21.737

在我们公司，我们用代理解决了这类问题，这样客户端就不会真正直接访问 JBoss 服务器，而是访问代理，然后重定向到 JBoss。我们使用带有 mod_proxy 的 Apache Web 服务器。

因此，使用 Apache 的 mod_proxy，您需要进行设置：

```
# for the newcontext
ProxyPass /newcontext http://jbosserver.com/newcontext
ProxyPassReverse /newcontext http://jbossserver.com/newcontex
# for the oldcontext
ProxyPass /oldcontext http://jbosserver.com/newcontext
ProxyPassReverse /oldcontext http://jbosserver.com/newcontext 
```

因此，如果代理的名称是 apacheserver.com，您可以通过以下方式访问服务： [http](http://apacheserver.com/newcontext) ://apacheserver.com/newcontext 或 [http://apacheserver.com/oldcontext](http://apacheserver.com/oldcontext)

这种架构的另一个优点是它为您提供了额外的安全性，因为客户端不直接访问网络服务器。当然，您不仅限于一种上下文，您可以在 apache 中创建任意数量的上下文。

我希望它会有所帮助。

# linux - LD_LIBRARY_PATH 似乎不起作用

> ID：13292261
> 
> 赞同：12
> 
> 时间：2012-11-08T15:37:11.447
> 
> 标签：linux, gcc, centos, gnu

我正在尝试编译一个测试文件：

```
gcc -o test  test.c -lg2c 
```

但我得到了错误：

```
/usr/bin/ld: cannot find -lg2c 
```

如果我使用：

```
gcc -o test  test.c -L/usr/lib/gcc/x86_64-redhat-linux/3.4.6 -lg2c 
```

然后它工作正常。

所以我添加了这样的路径：

```
LD_LIBRARY_PATH=/usr/lib/gcc/x86_64-redhat-linux/3.4.6:$LD_LIBRARY_PATH 
```

当我使用`$LD_LIBRARY_PATH`它时，它会在那里列出，但是：

```
gcc -o test  test.c -lg2c 
```

仍然不起作用，它给出了同样的错误，我不知道为什么。

我正在使用 CentOS (2.6.32-279.9.1.el6.x86_64)，任何帮助将不胜感激。

* * *

**编辑**：编译器版本：

```
rpm -qa | grep gcc

gcc-4.4.6-4.el6.x86_64
compat-gcc-34-g77-3.4.6-19.el6.x86_64
libgcc-4.4.6-4.el6.x86_64
compat-gcc-34-3.4.6-19.el6.x86_64
gcc-gfortran-4.4.6-4.el6.x86_64
libgcc-4.4.6-4.el6.i686
gcc-c++-4.4.6-4.el6.x86_64 
```

* * *

**编辑**：我尝试使用`LIBRARY_PATH`，现在我得到一个不同的错误：

```
gcc: spec failure: unrecognized spec option 'M' 
```

我不知道这意味着什么。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-08T15:43:34.690

尝试设置`LIBRARY_PATH`，而不是`LD_LIBRARY_PATH`.

从`gcc`手册页：

> 图书馆路径
> 
> LIBRARY_PATH 的值是一个以冒号分隔的目录列表，很像 PATH。当配置为本地编译器时，如果 GCC 使用 GCC_EXEC_PREFIX 无法找到它们，则 GCC 在搜索特殊链接器文件时会尝试指定的目录。在为 -l 选项搜索普通库时，使用 GCC 进行链接也使用这些目录（但使用 -L 指定的目录首先出现）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:01:50.287

确保`LD_LIBRARY_PATH`在修改后导出。否则 GCC 将无法看到修改后的版本。

```
LD_LIBRARY_PATH=/usr/lib/gcc/x86_64-redhat-linux/3.4.6:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH
gcc -o test test.c -lg2c 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-18T01:42:26.057

在您的主目录（不是根目录！）中创建一个新文件夹。`-lg2c`将与from关联的所有必需库复制`/usr/lib/gcc/x86_64-redhat-linux/3.4.6`到此文件夹。

将 bash 配置文件中的路径设置为这个新文件夹。

我也遇到了这个问题，并用这个解决方法解决它。也许我们（作为非 root 用户）没有必要的访问/权限`/usr/lib/gcc/x86_64-redhat-linux/3.4.6`

# c - fgets 的链表程序分段错误？

> ID：13292268
> 
> 赞同：0
> 
> 时间：2012-11-08T15:37:34.950
> 
> 标签：c, linked-list, segmentation-fault, fgets

它第一次工作正常。我可以添加一个项目，然后用显示功能显示。但是当我尝试添加第二个值时，只要我在 fgets 处点击“a”就会出现段错误。我已经在顶部注释掉了。

（除了 Add 之外，我还没有打扰其他功能。）

```
#include    <stdio.h>
#include    <stdlib.h>
#include    <string.h>
#include    <ctype.h>
#include    "sortedll.h"

int     main(void)
{

int             intVal;
LNode           *headPtr = NULL;
char            buf[BUFLEN];
int             result;

do  {
    // ask the user what they want to do
    DisplayMenu();
    printf("Please enter a selection: ");
    fgets(buf, BUFLEN, stdin);
    *buf = toupper(*buf);
    switch (*buf)
        {
        case   'A':
            // prompt the user for a value; if we get one, add it to the
            // list
            printf("Please enter an integer value to add: ");
            fgets(buf, BUFLEN, stdin);

            //=======================================================================
            printf("check"); //doesn't print this second time around. seg fault at fgets?
            //=======================================================================

            if (1 != sscanf(buf, "%d", &intVal))
                {
                puts("Error reading the integer value...");
                }
            else
                {
                printf("1");
                headPtr = AddItem(headPtr, intVal);
                }
            break;

        case   'R':
            // if the list is empty display a message; else, get a value
            // from the user and attempt to remove it from the list
            if (NULL == headPtr)
                {
                puts("The list is currently empty...");
                }
            else
                {
                printf("Please enter an integer value to remove: ");
                fgets(buf, BUFLEN, stdin);
                if (1 != sscanf(buf, "%d", &intVal))
                    {
                    puts("Error reading the integer value...");
                    }
                else
                    {
                    headPtr = RemoveItem(headPtr, intVal);
                    }
                }
            break;

        case   'D':
            // display the current contents of the list
            result = DisplayList(headPtr);
            printf("Currently there %s %d node%s in the list.\n"
                                , (result != 1) ? "are" : "is"
                                , result
                                , (result != 1) ? "s" : "");
            break;

        case   'Q':
            // release all allocated memory and set the head pointer to
            // NULL to indicate that it is empty
            result = ReleaseMemory(headPtr);
            printf("There %s %d node%s released."
                                , (result != 1) ? "were" : "was"
                                , result
                                , (result != 1) ? "s" : "");
            headPtr = NULL;
            break;

        default:
            puts("Unrecognized option; please try again.");
            break;
        }
    puts(" ");

    } while ('Q' != *buf);

puts("Thanks for playing!  Bye!!\n");
return  0;

}  // end of "main"

// ==== AddItem ===============================================================

LNode*  AddItem(LNode  *headPtr, int  newItem)
{
    LNode *node = malloc(sizeof(*node));
    node->value = newItem;

    if(headPtr == NULL)
        {
        node->next = NULL;
        return node;
        }

    LNode *leadPtr = headPtr;
    LNode *trailPtr = headPtr;

    while(leadPtr->value != newItem)
        {
        leadPtr = leadPtr->next;
        trailPtr = leadPtr;
        }    

    leadPtr = leadPtr->next;
    free(trailPtr->next);    
    trailPtr->next = node;
    node->next = leadPtr;

    return headPtr;

}  // end of "AddItem"

// ==== DisplayList ===========================================================

int     DisplayList(LNode  *nodePtr)
{
    auto    int         counter = 0;

    // if the list is empty, indicate as such and return zero
    if (NULL == nodePtr)
        {
        puts("The list is currently empty...");
        return (0);
        }

    while (NULL != nodePtr)
        {
        printf("%d\n", nodePtr->value);
        nodePtr = nodePtr->next;
        counter++;
        }

    return (counter);

}  // end of "DisplayList"

// ==== DisplayMenu ===========================================================

void    DisplayMenu(void)
{
    puts("A)dd a value");
    puts("R)emove a value");
    puts("D)isplay the list");
    puts("Q)uit");

}  // end of "DisplayMenu"

// ==== ReleaseMemory =========================================================

int     ReleaseMemory(LNode  *headPtr)
{

}  // end of "ReleaseMemory"

// ==== RemoveItem ============================================================

LNode*  RemoveItem(LNode  *headPtr, int  targetItem)
{

}  // end of "RemoveItem" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:54:04.400

当leadPtr 可能为NULL 时，您似乎正试图在此处访问leadPtr->value。

```
while(leadPtr->value != newItem)
    {
    leadPtr = leadPtr->next;
    trailPtr = leadPtr;
    } 
```

在尝试访问它的成员之前，您需要确保leadPtr != NULL。

我建议您重构代码片段所属的函数，它在内存访问方面看起来有点脆弱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:29:42.307

你真的应该检查你的 malloc 调用的返回值：

LNode *node = malloc(sizeof(*node));

节点->值=新项目；

如果堆空间用完了怎么办？

# jsf - 从外部文件系统或数据库获取 Facelets 模板/文件

> ID：13292272
> 
> 赞同：7
> 
> 时间：2012-11-08T15:37:46.417
> 
> 标签：jsf, jsf-2, resources, external, facelets

我能够成功地让它与我的应用程序中的模板一起使用：

```
<ui:decorate template="/WEB-INF/templates/mytemplate.xhtml"> 
```

我还可以将模板移动到`/META-INF/templates/mytemplate.xhtml`JAR[并](https://stackoverflow.com/questions/3531432/packaging-facelets-pages-in-a-jar)使其正常工作：

```
<ui:decorate template="/templates/mytemplate.xhtml"> 
```

我实际上想把这个文件放到文件系统（或数据库）上。我怎样才能做到这一点？我发现了很多与 相关的东西`com.sun.facelets.impl.DefaultResourceResolver`，但我认为这实际上与覆盖模板的服务无关。它没有尝试解析 URL，它只是尝试以某种方式在类路径上获取文件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-08T19:55:32.447

如果您已经在 J​​SF 2.2 上，您可以通过提供一个自定义来做到这一点，您可以在[`ResourceHandler`](http://docs.oracle.com/javaee/7/api/javax/faces/application/ResourceHandler.html)其中返回所需的视图资源[`createViewResource()`](http://docs.oracle.com/javaee/7/api/javax/faces/application/ResourceHandler.html#createViewResource-javax.faces.context.FacesContext-java.lang.String-)。

```
public class FaceletsResourceHandler extends ResourceHandlerWrapper {

    private ResourceHandler wrapped;

    public FaceletsResourceHandler(ResourceHandler wrapped) {
        this.wrapped = wrapped;
    }

    @Override
    public ViewResource createViewResource(FacesContext context, final String name) {
        ViewResource resource = super.createViewResource(context, name);

        if (resource == null) {
            resource = new ViewResource() {
                @Override
                public URL getURL() {
                    try {
                        return new File("/some/base/path", name).toURI().toURL();
                    } catch (MalformedURLException e) {
                        throw new FacesException(e);
                    }
                }
            };
        }

        return resource;
    }

    @Override
    public ResourceHandler getWrapped() {
        return wrapped;
    }

} 
```

注册`faces-config.xml`如下：

```
<application>
    <resource-handler>com.example.FaceletsResourceHandler</resource-handler>
</application> 
```

* * *

或者，如果您还没有使用 JSF 2.2，那么请[`ResourceResolver`](http://download.oracle.com/javaee/6/api/javax/faces/view/facelets/ResourceResolver.html)改用。

```
public class FaceletsResourceResolver extends ResourceResolver {

    private ResourceResolver parent;

    public FaceletsResourceResolver(ResourceResolver parent) {
        this.parent = parent;
    }

    @Override
    public URL resolveUrl(String path) {
        URL url = parent.resolveUrl(path); // Resolves from WAR.

        if (url == null) {
            try {
                url = new File("/some/base/path", path).toURI().toURL();
            } catch (MalformedURLException e) {
                throw new FacesException(e);
            }

        }

        return url;
    }

} 
```

注册`web.xml`如下：

```
<context-param>
    <param-name>javax.faces.FACELETS_RESOURCE_RESOLVER</param-name>
    <param-value>com.example.FaceletsResourceResolver</param-value>
</context-param> 
```

* * *

无论采用哪种方式，为了从数据库中提供资源，您可以将它们保存/缓存在（临时）磁盘文件系统上，以便您可以提供`URL`just via `File`，或者发明一个自定义协议，例如`db://`并提供一个自定义[`URLStreamHandlerFactory`](http://docs.oracle.com/javase/6/docs/api/java/net/URLStreamHandlerFactory.html)和[`URLStreamHandler`](http://docs.oracle.com/javase/6/docs/api/java/net/URLStreamHandler.html)实现从数据库执行流式传输的实际工作。您可以在此处找到启动示例[Registering and using a custom java.net.URL protocol](https://stackoverflow.com/questions/26363573/registering-and-using-a-custom-java-net-url-protocol)。

# python - 循环中的 if 语句，它有两个条件

> ID：13292279
> 
> 赞同：0
> 
> 时间：2012-11-08T15:38:05.370
> 
> 标签：python, python-2.7, if-statement

过去一天我一直在努力解决一个非常简单（但非常困难）的问题。我目前有一段代码，它使用 csv 阅读器逐行循环遍历 csv 文件。循环不是问题，因为我之前成功使用过相同的循环；这似乎是我的 if 语句的问题。

这是一个示例：

```
if  'INCORRECT_KEY_PRESSED' and 'rad_mod_KA_0043-lo-mod' in row:
            userAnswerColumn.append(row[20])
            userRtColumn.append(row[21]) 
```

`INCORRECT_KEY_PRESSED`如果该行包含短语and ，则该语句应该附加两个列表，其中包含来自行中特定位置的值`rad_mod_KA_0043-lo-mod`。我有几个这样的陈述，但一行从来没有超过一次这两个短语。像这样的短语`rad_mod_KA_0043-lo-mod`总是独一无二的，但`INCORRECT_KEY_PRESSED`会出现很多次。

似乎 if 语句只使用了我的一个条件，因为它向每个列表附加了多个数据。

我过去曾遇到过这个问题，并通过创建集合并执行以下操作来解决它：

```
if (all(x in row for x in ssSet) and row[14] == '7'):
            ssColumn7.append(row[20])
            ssRtColumn7.append(row[21]) 
```

然而，有这么多独特的术语，我不得不制作过多的集合。怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:39:51.650

该声明`'INCORRECT_KEY_PRESSED' and 'rad_mod_KA_0043-lo-mod' in row`被解释为：

```
('INCORRECT_KEY_PRESSED') and ('rad_mod_KA_0043-lo-mod' in row) 
```

第一部分始终为真（非空字符串为“真”，或在布尔表达式中被视为布尔真）。

你可能想要：

```
if 'INCORRECT_KEY_PRESSED' in row and 'rad_mod_KA_0043-lo-mod' in row: 
```

相反，或者您可以使用设置的交叉点：

```
if {'INCORRECT_KEY_PRESSED', 'rad_mod_KA_0043-lo-mod'}.intersection(row): 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:40:41.617

您的分组错误，python 的工作方式如下：

```
if  ('INCORRECT_KEY_PRESSED') and ('rad_mod_KA_0043-lo-mod' in row): 
```

所以你需要：

```
if  ('INCORRECT_KEY_PRESSED' in row) and ('rad_mod_KA_0043-lo-mod' in row): 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:41:58.143

```
if  'INCORRECT_KEY_PRESSED' and 'rad_mod_KA_0043-lo-mod' in row:
            userAnswerColumn.append(row[20])
            userRtColumn.append(row[21]) 
```

应改为：

```
if  ('INCORRECT_KEY_PRESSED'  in row) and ('rad_mod_KA_0043-lo-mod' in row):
            userAnswerColumn.append(row[20])
            userRtColumn.append(row[21]) 
```

因为否则python会理解

```
if ('INCORRECT_KEY_PRESSED') and 'rad_mod_KA_0043-lo-mod' in row: 
```

这可能总是正确的。

每次有多个条件要测试时，您可能需要考虑这一点。

# ios - iTunes 账户关联国家

> ID：13292287
> 
> 赞同：0
> 
> 时间：2012-11-08T15:38:33.150
> 
> 标签：ios, itunes-store

基本上我想做的是在iTunes商店中搜索书籍，并显示它们供用户选择。当用户点击一本书时，他会被重定向到这本书的 iTunes 页面。

问题是：我正在“我们”国家寻找书籍。当用户打开其中一本书时，如果他的 iTunes 帐户链接到美国以外的国家/地区，他将看不到该书的页面。如果他将他的 iTunes 帐户关联国家更改为美国，他可以看到这本书。

挑战是让他的国家进入应用程序，并在 iTunes 中搜索他所在国家/地区的书籍，然后打开 iTunes，考虑到所有请求都是针对同一个国家/地区提出的，这将起作用。

有人有想法吗？

PS 不能使用 NSLocale，因为它不会返回正确的国家。例如，您的 iTunes 帐户可以链接到法国，但您的语言环境可能返回 en_us

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:43:14.310

您可以使用他们的 IP 地址来确定他们所在的国家/地区。这显然不会 100% 起作用（代理、vpns 等），但它涵盖了大量情况。

互联网上有包含此信息的数据库和服务（免费和付费）。

编辑：

关键是优雅地后退。您在创建帐户时询问用户他们的位置。如果他们回答，您可以使用它，否则您稍后尝试检测。您可以检测并说“嘿，我们认为您在这里。对吗？” 事实上，由于标准 IP 块，IP 地理定位在国家一级运行良好。它只是在城市和州一级真正开始变得模糊。

# php - 使用代理服务器获取 PHP OAuth 类

> ID：13292293
> 
> 赞同：2
> 
> 时间：2012-11-08T15:38:45.543
> 
> 标签：php, oauth, proxy

我一直在寻找线程，并没有找到任何东西......

我在使用 PHP OAuth 类 fetch 方法时遇到问题。

目前正在这样做

```
$oauth->fetch($this->access_token_url, array('xoauth_oauth2_access_token' => $access_token), OAUTH_HTTP_METHOD_POST); 
```

问题是我们需要通过代理连接到服务器。并且 URL 参数只需要一个字符串。我正在查看[http://us2.php.net/manual/en/oauth.fetch.php](http://us2.php.net/manual/en/oauth.fetch.php)上的 OAUTH 文档，并尝试查看其他一些方法，但没有找到任何东西。有没有办法我可以先建立连接，甚至只是扩展类以使用代理？

对此的任何帮助都会令人惊叹，几天来一直在尝试解决这个问题。

谢谢，布罗迪

# gwt - 使用 Selenium IDE 通过 GWT/smartGWT 进行 GUI 测试

> ID：13292295
> 
> 赞同：1
> 
> 时间：2012-11-08T15:38:50.373
> 
> 标签：gwt, selenium, smartgwt

我是新来的，也是 Selenium 的新手。我正在尝试使用 Selenium 测试我们的 smartGWT-Projekt 的 GUI。我添加了 user-extension.js、goto_sel_ide.js 和 user-extension-ide.js，就像这里描述的那样：[https://docs.jboss.org/author/display/RHQ/Testing+SmartGWT+with+Selenium? _sscc=t](https://docs.jboss.org/author/display/RHQ/Testing+SmartGWT+with+Selenium?_sscc=t)

但我现在的问题是执行记录时出现错误：

*[错误] 意外异常：fileName -> chrome://selenium-ide/content/tools.js -> file:///C:/smartgwt-3.0/selenium/user-extensions.js?1352387440820, lineNumber -> 72*

这是第 72 行： var elem = autWindow.isc.AutoTest.getElement(scLocator);

是的，我在这里阅读了大多数关于使用 Selenium 的 smartGWT/GWT 的问题/答案。在谷歌中我没有发现任何关于这个错误的信息。

有人能给我指路吗？

项目必须在本地运行才能使用 Selenium 进行测试吗？

我用于此测试的版本：Firefox v15.0.1 SeleniumIDE 1.9.1 SmartGWT v3.0（我只使用本地 user-*.js 文件）

# javascript - 您可以在 jQuery 中加载时在另一个动态元素中添加动态元素吗？

> ID：13292303
> 
> 赞同：0
> 
> 时间：2012-11-08T15:39:16.070
> 
> 标签：javascript, jquery

我正在尝试在加载时初始化一个带有文本区域的 div。我仍在加载过程中用数据填充文本区域。一旦创建了所有元素，我就会出去查找元素并在加载过程中使用“appendTo”添加另一组动态元素。

这是第一组元素加载的地方......

```
 j$(function() {

                   for(var i = 0; i < Survey_result.length; i++){

                    j$('<div id="QDiv'+Survey_result[i].Id+'">'+
                          '<div id="'+Survey_result[i].Survey_Question__r.Question_Input_Type__c+'">'+
                             '<textarea cols="130" id="Q_'+Survey_result[i].Survey_Question__c+'"  readonly="true" name="p_Q">'+Survey_result[i].Survey_Question__r.Question__c+'</textarea>'+
                          '</div>'+   
                      '<div>').appendTo('#SurveyBuilder_div');
                      QelId='#Q'+i;
                   } 
```

这是我尝试添加子元素但它们没有加载的地方。是因为它没有看到父元素ID吗？

```
 if(QuestionType=='PickList'){

                               j$('<div id="ADiv'+QId+'">'+
                                  '<select id="selAnswer'+i+'" size="1">'+      
                                  '</select>'+
                                   '</div>').after(MainDiv);
                                   bp='#ADiv'+QId;

                                 j$(Answer_result).each(function(){

                                           j$(' <option value = "'+Answer_result[b].Id+'">'+Answer_result[b].Answer__c+'</option>').after(bp);
                                           b++;
                                 });                   

                        }else if(QuestionType=='Radio'){
                               j$('<div id="ADiv'+QId+'">'+
                                  '</div>').appendTo(MainDiv);

                                   bp='ADiv'+QId;

                                j$(Answer_result).each(function(){
                                       j$('<input type="radio" id="Radio_CtrlType'+b+'" value="'+Answer_result[b].Id+'" name="ctrlSel'+i+'"/>'+
                                          '<label for="Radio_CtrlType'+b+'">'+Answer_result[b].Answer__c+'</label>').appendTo(bp);
                                           b++;
                                 });
                         }else if(QuestionType=='Checkbox'){
                                j$('<div id="ADiv'+QId+'">'+
                                   '</div>').appendTo(MainDiv);
                                    bp='ADiv'+QId;

                                j$(Answer_result).each(function(){
                                      j$('<input type="checkbox" id="Checkbox_CtrlType'+b+'" value="'+Answer_result[b].Id+'" name="ctrlSel'+i+'"/>'+
                                         '<label for="Checkbox_CtrlType'+b+'">'+Answer_result[b].Answer__c+'</label>').appendTo(bp);
                                         b++;
                                }); 
                         }else if(QuestionType=='Textbox'){
                              j$('<div id="ADiv'+QId+'">'+
                                 '</div>').appendTo(MainDiv);
                               bp='ADiv'+QId;
                               j$(Answer_result).each(function(){
                                     j$('<input type="text" id="Textbox_CtrlType'+b+'" value="'+Answer_result[b].Id+'" name="ctrlSel'+i+'"/>').appendTo(bp); 
                                    b++;
                               });
                         } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:28:02.487

修改页面内容时，需要

1）确保页面已经加载（在 domready 之前不要做任何事情，你做得正确，并且

2）如果您仍然看不到您的内容，很可能您的目标元素选择器没有返回任何内容。要检查这一点，请执行`console.log($('#yourselector').length);`如果长度为 0，则在页面上找不到要添加的任何内容。

（顺便说一句，`console.log();` 登录到开发者控制台，例如现在所有主流浏览器中都可用）

# http - 使用自定义 json 内容类型是个好主意吗

> ID：13292313
> 
> 赞同：17
> 
> 时间：2012-11-08T15:39:51.540
> 
> 标签：http, http-headers

我正在设计一个 RESTful API，并试图进行描述并使文档更清晰，我想声明我的内容类型 http 标头，如下所示：

```
Content-Type: application/vnd.mycorp.mydatatype+json 
```

其中 mycorp 是我的公司唯一的标识符，而 mydatatype 对每种数据类型都是唯一的。一个例子是：

```
Content-Type: application/vnd.ford.car+json

{
"manufactured_year": 2000
, "color": "blue"
, "hp": 160
, "model" "Focus"
, "type": "sedan"
} 
```

需要此内容类型才能使 POST 有效，并将作为响应的一部分发送。在我看来，这似乎是一种很好的方式来定义有效载荷内应该包含的内容的规则。

我似乎找不到关于这是否是一个好主意或者它是否被 IETF 标准允许的好的资源。

所以，问题是：哪个更可行，application/vnd.mycorp.mydatatype+json 还是只是 application/json？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-11-23T16:00:08.417

**该问题与您的 REST API版本控制**密切相关。

内容类型用于定义内容的类型。如果您使用*标准*内容类型，例如

```
application/json 
```

您是在对客户端说消息是 JSON 格式的。这对于所有不对其 API 进行版本控制或仅支持最新版本的 Web 应用程序来说已经足够了。如果您要让客户端使用不同版本的 API，那么*标准*的内容类型是不够的。考虑以下场景：

以您的示例作为消息的版本 1

```
Content-Type: application/vnd.ford.carV1+json

{
"manufactured_year": 2000
, "color": "blue"
, "hp": 160
, "model" "Focus"
, "type": "sedan"
} 
```

在某些时候，您决定要使用十六进制代码表示颜色。因此，您创建类型的版本 2

```
Content-Type: application/vnd.ford.carV2+json

{
"manufactured_year": 2000
, "color": "0000FF"
, "hp": 160
, "model" "Focus"
, "type": "sedan"
} 
```

当客户要求汽车时，请指定正确的内容类型，其中包括版本。这告诉应用程序是否将颜色作为十六进制代码或名称发送。

在这里，您正在对资源的**表示**进行版本控制。支持资源表示版本控制的替代方法是将版本添加为自定义标头（同时保持内容类型标准）

```
Content-Type: application/json
Message-Version: 1.0 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-09T05:51:55.090

这是允许的，绝对的。这是否是一个好主意是另一回事。

我的经验法则是，它是一种主要的数据格式，对很多事情都很有用，需要自行识别，并且您需要在许多应用程序之间进行互操作，一定要给它一个媒体类型。

但是，如果它只是您的 API 中的一条消息，并且它只适用于一种资源（或一种资源“类型”），那么只需使用 application/json.

YMMV，当然。

# java - 了解日历时间，需要澄清

> ID：13292316
> 
> 赞同：1
> 
> 时间：2012-11-08T15:39:53.887
> 
> 标签：java, date, time, calendar

考虑以下代码段

```
 System.out.println(System.currentTimeMillis());

    Calendar calendarInstance = Calendar.getInstance();
    System.out.println(calendarInstance.getTimeInMillis());

    // Get current
    int year = calendarInstance.get(Calendar.YEAR);
    int month = 1 + calendarInstance.get(Calendar.MONTH);

    calendarInstance.set(year, month, 7 , 19, 00);

    System.out.println(calendarInstance.getTimeInMillis()); 
```

前两张照片“现在差不多”。第三个是**昨天**晚上7点。为什么第三个数字最大？

1.  1,352,389,069,723
2.  1,352,389,069,734
3.  1,354,669,249,734

如果我错了，请纠正我，但在

```
calendarInstance.set(year, month, 7 , 19, 00); 
```

我们正在处理`2012, 11, the 7th day, 7 pm`。

请问我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:02:39.370

迄今为止，您刚刚添加了 1 个月。所以是未来。

```
int month = 1 + calendarInstance.get(Calendar.MONTH); 
```

这可能会令人困惑，但我猜您添加 1 是因为月份是基于 Java 的 0-index。很遗憾。

# android - 擦除以位图为背景的画布上的线条

> ID：13292317
> 
> 赞同：1
> 
> 时间：2012-11-08T15:39:57.193
> 
> 标签：android, bitmap, line, android-canvas, erase

我正在开发一个 Android 应用程序，该应用程序具有使用用户可以使用手指绘制的新 Canvas(bitmap) 函数创建的 Canvas。我遇到的问题是我找不到允许用户用手指擦除线条的方法。我搜索了谷歌并查看了示例 FingerPaint 应用程序，但他们使用以下方式擦除线条：

```
setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR)); 
```

似乎仅适用于 Canvas 的纯色。我已经编写了代码来执行撤消/重做功能，但是能够只擦除部分行而不是撤消分配的更改会很好。如果有人有任何想法，我可以尝试，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:42:56.223

```
public void resetBitmapCanvasAndPath() {
    // TODO Auto-generated method stub
    mDrawingUtilities.mBitmap = Bitmap.createBitmap(Constants.SCREEN_WIDTH,Constants.SCREEN_HEIGHT ,
            Bitmap.Config.ARGB_8888);

        //Log.d("BITMAP","Restoring...");
        //mBitmap=BitmapFactory.decodeByteArray(bytes, 0, bytes.length); 

    mDrawingUtilities.mCanvas = new Canvas(mDrawingUtilities.mBitmap);

    mDrawingUtilities.mPath = new Path();
} 
```

重置位图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:28:47.953

有时就像将受影响像素的 Alpha 通道设置为透明一样简单。我忘记了它是 0 还是 255，因为它会根据平台而变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:50:47.407

这很棘手，但有一个解决方案:)。

在擦除模式下，您的位图填充颜色可能与背景颜色相同（例如白色）。用户可以用背景颜色绘制，所以就像删除一样。:) （DrawSomething 就是这样）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-19T09:36:48.380

这就是您可以使用 SetXfermode() 的方式：

```
 if (view.getId()== R.id.erase_btn){  erase_btn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                onDraw.setErase(true);
            }
        }

 public void setErase(boolean isErase){
    erase=isErase;
    if(erase) drawPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
    else drawPaint.setXfermode(null);
} 
```

这将帮助您在手指之后删除画布上的内容。

# c - pthread_cancel() 使我的程序崩溃

> ID：13292319
> 
> 赞同：0
> 
> 时间：2012-11-08T15:40:09.847
> 
> 标签：c, pthreads

我开发了一个程序，它在一开始就创建了一个线程。然后我想`pthread_cancel()`在线程运行时终止线程。

但是，如果我这样做，我会崩溃。这种崩溃并不总是重现。有时程序会避免崩溃。

`pthread_cancel()`如果取消的线程正在运行系统调用，我看到一些可能导致崩溃的地方。是真的吗？

**dmesg 显示以下错误**

```
myprogramd[1965]: segfault at c ip b76cdef3 sp bfcd5780 error 4 in libpthread-0.9.30.1.so[b76c6000+a000] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:51:42.577

我怀疑这是一个同步问题。我的意思是在取决于您要终止的线程的不同线程中，您可能正在访问可能无效并导致崩溃的东西。除非您有完整的代码要执行，否则我们无法指出崩溃。

**至少尝试在[gdb](http://www.gnu.org/software/gdb/)上运行您的代码并[获取 backtrace](http://publib.boulder.ibm.com/httpserv/ihsdiag/get_backtrace.html)**。看[这里](http://ubuntuforums.org/showthread.php?t=1015041)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:10:32.510

不要使用`pthread_cancel()`. 重构代码，使其收到关闭消息，而不影响共享内存并使事情变得不稳定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-11T18:23:16.353

崩溃与管理器线程有关。管理器线程在第一次启动时未正确终止，因此在第二次启动时创建新 pthread 时，旧线程管理器将导致崩溃。

有关详细信息，请参阅以下问题

[如何用C杀死管理线程？](https://stackoverflow.com/questions/13305422/how-to-kill-the-management-thread-with-c)

# c - M x S x T(M) 与 BLAS 的乘法

> ID：13292325
> 
> 赞同：3
> 
> 时间：2012-11-08T15:40:22.123
> 
> 标签：c, matrix-multiplication, blas

> **可能重复：**
> [计算矩阵乘积AXA'的有效方法？](https://stackoverflow.com/questions/11139933/efficient-way-of-computing-matrix-product-axa)

我有两个双精度矩阵：

*   `M`，它有大小`l ⨯ m`，没有特定的属性；
*   `S`，它有大小`m ⨯ m`并且是对称的。

我想计算：

```
R = M ⨯ S ⨯ t(M) 
```

`t(M)`的转置在哪里`M`。

查看 (C) BLAS 例程列表，我没有找到任何直接解决这种情况的内容。那么，什么是最有效的例程组合，可以让我计算`R`?

# mysql - 选择符合通用标准的行

> ID：13292327
> 
> 赞同：0
> 
> 时间：2012-11-08T15:40:25.703
> 
> 标签：mysql, sql

我似乎无法扭曲我的大脑，我相信这个问题很简单。

我有下表（Id 和 Value 共同构成键），该表将很大，包含数百万个条目。

**桌子**

```
ID      Value
ID_A    VAL_1
ID_A    VAL_2
ID_A    VAL_3
ID_B    VAL_1
ID_B    VAL_2
ID_C    VAL_3 
```

我想获取与任意选择匹配的所有 id，它可能是：

给我所有拥有的 IDS`(Value = 'val_1') AND (value = 'val_3')`

这应该`(ID_A)`作为唯一同时具有 val1 和 val3 的 id 返回。我如何以一种巧妙的方式实现这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:44:46.460

听起来你想要这个，这会给你所有同时拥有`VAL_1`和的id `VAL_3`：

```
select id
from yourtable
where value in ('VAL_1', 'VAL_3')   
group by id
having count(distinct value) > 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/2c5df/1)

根据您提供的数据，仅`ID_A`匹配，因为它是唯一一个同时具有`VAL_1`和`VAL_3`

或者您可以将其稍微更改为：

```
select id
from yourtable
where value in ('VAL_1', 'VAL_3')   
group by id
having count(distinct value) = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:43:03.870

您可以使用嵌套的选择语句：

```
SELECT ID FROM Table WHERE ID IN (SELECT ID FROM Table WHERE Value = 'VAL_1')
AND Value = 'VAL_3'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:54:24.423

这应该工作

```
SELECT id
FROM
(
    SELECT *
    FROM table
    WHERE value IN ('val_1', 'val_3')
) t
GROUP BY id
HAVING COUNT(*) = 2 
```

问候

# ssis - SQL 任务 - 设置包变量

> ID：13292330
> 
> 赞同：2
> 
> 时间：2012-11-08T15:40:37.840
> 
> 标签：ssis, sql-server-2008-r2

我已经在包级别声明了一个变量，并通过在包的控制流中 `compdate`删除一个变量来测试数据流。`Execute SQL Task`

在任务中，

SQL 语句：

```
select ? = (getdate() - 1) 
```

参数映射：

*   变量的名称：`User::compdate`
*   方向：`Output`
*   数据类型：`DATE`
*   参数名称：`0`
*   参数大小：`-1`.

为什么我收到错误：

```
[Execute SQL Task] Error: Executing the query "declare @compdate date
set @compdate = (getdate() ..." failed with the following error: "Syntax error or access violation". Possible failure reasons: Problems with the query, "ResultSet" property not set correctly, parameters not set correctly, or connection not established correctly. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:05:01.437

我不明白为什么需要执行 SQL 语句来获取前一天，因为这可以通过其他各种方式完成。

不过，要回答您的问题，由于您尝试存储**执行 SQL 任务**中的 SQL 查询结果，因此您必须更改您提供的 SQL 语句。

**您的新查询：**

`SELECT (GETDATE() - 1) AS DateVar`

您需要映射到变量的返回`DateVar`的**单个**参数在哪里。

您需要删除参数映射，因为它们不需要。打开**结果集**选项卡并添加新结果。将**结果名称**设置为`DateVar`并将变量名称设置为您的变量`User::compdate`

然后，您需要设置您的**执行 SQL 任务以在“****常规**”选项卡中返回单行结果集，映射到您的变量。为**ResultSet**选项选择**单行**。

 **[此处](http://www.simple-talk.com/sql/ssis/ssis-basics-using-the-execute-sql-task-to-generate-result-sets/)详细解释了使用结果集。向下滚动到“*使用单行结果集*”部分，它有一个很好的示例，您可以遵循。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T09:46:09.967

如果你想使用而不使用`result set`. 尝试以下步骤。

1.  在您各自的数据库中创建存储过程。以下代码是一个示例。

    ```
    CREATE proc GetYesterDay(@yesterday datetime output)
    as
    Select @yesterday=getdate()-1 
    ```

2.  创建 ADO.NET 连接以运行存储过程。其中，可以提及参数的输入输出方向。

3.  创建执行任务并将其配置为以下屏幕截图。 ![在此处输入图像描述](../Images/9c7c871d442be80f8cfe97425782a52b.png)
4.  单击参数映射并按照以下屏幕截图进行配置。 ![在此处输入图像描述](../Images/7ad3450c94d6729a22059ad465116a73.png)

现在 SSISCompletedDate 变量将填充相应的数据。

希望这可以帮助！**

# android - android 应用程序活动的空闲超时

> ID：13292331
> 
> 赞同：0
> 
> 时间：2012-11-08T15:40:38.690
> 
> 标签：android, android-asynctask, timeout

我正在为平板电脑编写 Android 应用程序 (ICS)。用户只需按一下按钮即可从活动 A 移动到活动 B 再到活动 C。我想在 10 秒后从活动 C 返回到活动 A。有没有办法在不锁定活动 C 的情况下数到 10？

我已经成功完成了 asyncTask，但是如果我在 onPostExecute() 中 startActivity(A)，感觉就像我违反了 asyncTask 不应与 UI 混淆的准则。我试过 get() 但这确实在等待 10 秒过去时锁定了 Activity C。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:51:33.687

假设您的活动中有任何`View`实例，您可以使用[View.postDelayed()](http://developer.android.com/reference/android/view/View.html#postDelayed%28java.lang.Runnable,%20long%29)以给定的延迟发布可运行文件。在这个可运行文件中，您可以调用[Activity.finish()](http://developer.android.com/reference/android/app/Activity.html#finish%28%29)。您还应该使用[View.removeCallbacks()](http://developer.android.com/reference/android/view/View.html#removeCallbacks%28java.lang.Runnable%29)删除您的回调`onDestroy()`，以避免在用户已经从您的活动导航回来之后调用您的回调。

`AsyncTask`仅用于计算一些时间只是一种矫枉过正（除非你想用它来`AsyncTask`实际做一些有用的后台工作）。`Looper`和类提供了在给定延迟后在 UI 线程上执行任何代码所需的`Handler`一切。上面提到的`View`方法只是暴露`Handler`功能的便捷方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:45:58.477

正如您所描述的，使用 AsyncTask 可以正常工作。来自 Android 文档：

> onPostExecute(Result)，在后台计算完成后在 UI 线程上调用。

由于它是在 UI 线程上调用的，所以应该没问题。

[文档](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:50:24.123

您可以为此使用警报管理器。将其设置为从活动 a 开始 10 秒发送一个广播，并为活动 ab 和 c 实现一个基本活动以接收广播，在接收到广播后，只需结束当前活动并使用新标志启动活动 a。如果当前实例是活动 a，则如果不是启动活动 a，则忽略。类似的东西。

至于空闲部分，您可以在每个操作、进入活动等时更新警报管理器。

这种实现的优点是您不必担心上下文泄漏、跨活动持续计时器等问题。并且可以利用已经存在的东西。您也可以考虑使用服务。

如果没有，您可以只使用共享首选项存储超时时间并检查或更新操作。一个更简单的实现。

祝你好运。

# html - 如何在 JLabel 中使 html 文本以 3 个点结尾

> ID：13292335
> 
> 赞同：1
> 
> 时间：2012-11-08T15:40:49.690
> 
> 标签：html, formatting, jlabel

默认情况下，JLabel 对简单文本进行这种格式化。

```
setText("Hello World!");
setMaximumSize(new Dimension(30, 20); 
```

这将显示如下：

```
Hello Wo... 
```

但如果我们使用 html 格式：

```
setText("<html><p color='#333333'>Hello World!</p></html>");
setMaximumSize(new Dimension(30, 20); 
```

它将显示如下：

```
Hello Worl 
```

剩下的文字就被剪掉了。

有什么方法可以使文本具有与第一个（文本...）案例相同的视图？

标签的宽度正在变化，html 格式更加复杂（因此无法使用 fontmetrics 并且选择简单文本会很复杂）。

提前致谢！

# cpanel - 每次有人登录受密码保护的目录时，我可以收到一封自动电子邮件吗？

> ID：13292336
> 
> 赞同：0
> 
> 时间：2012-11-08T15:40:56.117
> 
> 标签：cpanel, whm

我有一个带有 WHM 和 cpanel 的 VPS 服务器。我们有一些受密码保护的目录（在 cpanel 中定义）。我们希望每当用户登录其中一个时，我们都会收到一封即时电子邮件。可能的？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T14:22:20.433

好吧，您可以在 index.php 上使用 PHP 中的 mail() 函数。除此之外，不幸的是这是不可能的。

# c# - 如何合并 Lambda 委托

> ID：13292337
> 
> 赞同：5
> 
> 时间：2012-11-08T15:40:54.260
> 
> 标签：c#, delegates, lambda

我想做这个：

```
class Foo {

  static Func<string> sRunner;

  Func<string> _runner;

  public Foo(Func<string> runner){

    _runner = runner ?? sRunner ?? () => "Hey!";

  }
} 
```

我在 lambda 上得到一个“无效的表达式”术语。可以内联修复吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T15:42:26.037

```
_runner = runner ?? sRunner ?? (() => "Hey!"); 
```

# media-queries - 设备不读取 CSS 中的移动条件语句

> ID：13292338
> 
> 赞同：1
> 
> 时间：2012-11-08T15:40:56.630
> 
> 标签：media-queries, conditional-statements

我正在创建一个响应式布局，它适用于大多数格式，但宽度为 320 像素的智能手机除外。我在 CSS 和单独的样式表中都使用了媒体条件，但似乎都不起作用，就好像设备忽略了条件代码一样。

我的原始 CSS 看起来像这样（对于 480 像素及更高的设备）：

```
#logo
{
position:relative;
margin-top:30px;
margin-left:auto;
margin-right:auto;
text-align:center;
width:100%;
height: 117px;
background-image:url(../images/logorepeat.png);
background-position:0px 26px;
background-repeat:repeat-x;
z-index:50;
}

#landscape
{
position:relative;
margin-top:-27px;
margin-left:auto;
margin-right:auto;
padding-top:45px;
text-align:center;
width:100%;
height:120px;
background-image:url(../images/plated2.jpg);
background-repeat:repeat-x;
background-color:#efebe5;
z-index:40;
} 
```

因为我不需要 320px 的设备（例如 iPod Touch）中的重复背景，所以我在此设备的标注中删除了它（并将其上方的 div 向上移动）：

```
@media screen and (max-width: 320px)
{

#logo
{
position:relative;
margin-top:30px;
margin-left:auto;
margin-right:auto;
text-align:center;
width:100%;
height: 117px;
z-index:50;
}

#landscape
{
position:relative;
margin-top:-45px;
margin-left:auto;
margin-right:auto;
padding-top:45px;
text-align:center;
width:100%;
height:120px;
background-image:url(../images/plated2.jpg);
background-repeat:repeat-x;
background-color:#efebe5;
z-index:40;
}

} 
```

有什么建议么？

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:14:22.420

我已经回答了我自己的问题！我只是将我制作的 iphone 样式表作为默认表，并以从小到大的顺序链接到我的 HTML 头部的媒体查询样式表。:)

# internationalization - 没有办法处理国际化（i18n）？

> ID：13292344
> 
> 赞同：1
> 
> 时间：2012-11-08T15:41:34.573
> 
> 标签：internationalization, trigger.io

我想知道在使用 trigger.io (forge) 构建 HTML/Js 应用程序时是否有任何方法可以处理 i18n。

顺便说一句，也没有办法在设备上检测用户的语言环境，通过检查用户代理（或者在我的情况下 - 一个 FB 连接应用程序 - 要求 FB 获取用户的语言环境）来解决问题

对于任何严肃的应用程序来说，国际化都是必须的……我目前正在通过创建几个 JSON 文件（每个语言环境一个）来“破解”这个，并以适当的语言保存相同的密钥。

1: 有没有使用 forge Js API 检测/获取用户语言环境的计划？2：有没有计划在构建应用程序时处理自动化 i18n？

谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:27:22.943

您可以轻松编写一个[Trigger.io 插件](http://docs.trigger.io/en/v1.4/modules/native/index.html)来为您检测设备语言。以下是有关如何执行此操作的一些资源：

*   安卓：http: [//developer.android.com/reference/java/util/Locale.html](http://developer.android.com/reference/java/util/Locale.html)
*   iOS：[在 iOS 中获取当前设备语言？](https://stackoverflow.com/questions/3910244/getting-current-device-language-in-ios)

一旦你有了语言字符串，你就可以使用许多为你处理本地化的 js 插件之一，或者你自己做。拥有多个带有本地化字符串的 json 文件并按需加载其中一个对我来说听起来并不太难。

PS：当然，如果您打算拥有应用程序的移动浏览器版本，则不能依赖本机插件。在这种情况下，您必须使用不同的解决方案。查看[用于检测浏览器语言偏好的 JavaScript](https://stackoverflow.com/questions/1043339/javascript-for-detecting-browser-language-preference)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T12:35:19.913

有两件事要翻译：您的 JS/HTML 应用程序和本机元素。

**JS/HTML**

用于`window.navigator.language`获取语言环境。使用一些库，例如[https://github.com/wikimedia/jquery.i18n](https://github.com/wikimedia/jquery.i18n)

**本国的**

原生元素不经常显示，但确实包含一些关键的东西，例如权限对话框（“应用程序想要访问您的照片”）。

trigger.io 目前不支持翻译我所知道的这一部分，即它们都是英文的。

但据我了解，trigger.io 可以相当容易地添加对此的支持，只需在 config.json 中“切换”更多语言即可，因为 iOS 中已经内置了这些对话框的翻译，只需“将应用程序标记为支持该语言。

*同样，我不是 100% 确定原生部分，但我认为它是这样工作的。*

# ios - 打开图形地图布局

> ID：13292346
> 
> 赞同：0
> 
> 时间：2012-11-08T15:41:38.660
> 
> 标签：ios, xcode, facebook, geolocation, facebook-opengraph

我成功发布了一个使用“项目”附件布局打开图表的操作。但是，我还想发布一个带有“地图”附件布局的操作。我的 iOS 应用程序有一个坐标数组，它在地图上形成一条路线。我到处寻找，但找不到一个很好的教程来解释如何实现这一点。有人知道如何通过地图上的路线预览将操作发布到打开的图表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:46:57.157

创建 Open Graph 自定义对象时，需要将该对象的属性定义为 GeoPoint，然后设置“Is Array”，如下所示：

![https://developers.facebook.com/attachment/object_geopoint.png/](../Images/bfd6877030e6721fc764c0d4580c166c.png)

如果您包含此信息，则在发布操作时应该会自动创建一个地图样式的新闻源帖子。您还应该设置地图样式聚合。这里有更多[信息](https://developers.facebook.com/docs/opengraph/define-objects/#geopoint)。

通过查看示例，您可以看到如何创建这种复杂路线的示例，这是 Endomondo 锻炼中的一个示例：http: [//pastebin.com/VEW2GU0t](http://pastebin.com/VEW2GU0t)

# iphone - 使用新目标将 IPA 上传到 TestFlight 时出错

> ID：13292351
> 
> 赞同：13
> 
> 时间：2012-11-08T15:42:01.903
> 
> 标签：iphone, ios, cocoa-touch, testflight

我最近在我的项目中为我的应用程序的 Lite 版本创建了一个新目标。现在，当我将 .ipa 上传到 TestFlight 以便将其分发给我的设计师时，我得到：

> IPA 无效：embedded.mobileprovision 中的钥匙串访问组与您的二进制文件不匹配。

我似乎很清楚发生这种情况的原因是因为新目标。有谁知道我需要改变什么才能让它工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T05:39:33.747

我有同样的问题。这是由于目标的构建设置中有错误的发布代码签名身份引起的。您不需要权利文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-02T12:05:41.903

检查您是否使用正确的分发配置文件进行代码签名。

在 Xcode 项目下选择 > 构建设置 > 代码签名

代码签名身份： - 调试 > iPhone 开发人员 - 发布 > iPhone 分发

供应配置文件： - 请务必在此处选择分发配置文件！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T15:48:30.680

创建新捆绑包时，您可能没有更改权利和访问组。确保在权利文件中更改这些内容。看看[http://www.karlmonaghan.com/2012/08/09/invalid-ipa-the-keychain-access-group-in-the-embedded-mobileprovision-and-your-binary-dont-match/](http://www.karlmonaghan.com/2012/08/09/invalid-ipa-the-keychain-access-group-in-the-embedded-mobileprovision-and-your-binary-dont-match/)关于如何做到这一点。

应该看起来像这样

![在此处输入图像描述](../Images/8805773f5e98cfcd0cb4c5e9a6b7f228.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T00:41:55.877

### 如果您不使用权利文件...

仔细检查您使用的开发人员证书和配置文件是否是最新的（即使您对组织者有信心鼓舞人心的绿色勾号。）通过访问[Apple 配置门户](https://developer.apple.com/ios/manage/provisioningprofiles/index.action)刷新配置文件并编辑/修改配置文件，您重新用于签署应用程序。

取消单击并单击签名身份，以便您可以提交表单，并且将重新生成配置文件。

等一下（真的），回到 XCode 并从组织者中删除配置文件，然后刷新配置文件，它应该重新出现，作为重新生成的版本。

完成后，尝试归档/签署 ipa，然后上传到 TestFlight。

（使用 TestFlight 应用程序来加快这个过程。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T14:44:50.217

这对我有用：

1.  对我建立的所有代码签名身份使用自动（企业分发）配置文件选择。
2.  通过企业/临时分发工作流程时选择“刷新证书”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T14:50:42.447

我有这样的问题，我不确定你是否有同样的问题。

如果我安装的应用程序具有与我要安装的应用程序 ID 相同但目标不同的应用程序，则会产生问题。似乎应用程序在应用程序 ID 和目标方面是独一无二的。所以我不得不删除该应用程序以安装另一个具有相同应用程序 ID 但目标不同的应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-15T08:26:29.850

你在这里有很好的其他答案，但只是为了强调一些事情。

如果您为超过 1 个客户工作，并且您实际上使用了超过 1 个开发人员帐户，那么**自动选择存档上的代码签名身份向导**可能与您需要的不同，您可能需要在每次创建时选择它AdHoc 版本。

这是一张图片，向您展示您的错误可能在哪里（那是我的错误所在）：

![在此处输入图像描述](../Images/84eb7d67893f18b3cf21854f246d1265.png)

# asp.net - 运行 exe 文件以在 asp.net 中将单词转换为图像

> ID：13292353
> 
> 赞同：1
> 
> 时间：2012-11-08T15:42:06.380
> 
> 标签：asp.net, vb.net

我需要将word文件（将二进制文件保存在数据库中）转换为图像（JPEG）并下载到客户端。我创建了一个 Windows 应用程序并成功生成图像。将此应用程序配置为在 Web 应用程序上运行，并通过 VS2010 在我的计算机上真正工作。上传到专用服务器后不起作用。打开 Word 文档时出现异常并且消息为 此命令不可用，因为没有打开文档。为什么这个代码不是单词？

# java - HQL 删除多对多映射的关联

> ID：13292354
> 
> 赞同：4
> 
> 时间：2012-11-08T15:42:11.950
> 
> 标签：java, hibernate, jpa, primefaces, hql-delete

我有两个具有多对多关系的实体 CRImageType 和 CRVariable，如下所示：

**CRImageType 实体：**

```
@Entity
@Table(name = "imageviewer_crimagetype")
public class CRImageType implements Serializable   {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue
    @Column(name = "ImTypeId")
    private Long imTypeId;

    @Column(name = "ImTypeName")
    private String imTypeName;

    @Column(name = "ImTypeDescription")
    private String imTypeDescription;

    @ManyToMany(cascade = {CascadeType.ALL})
    @JoinTable(name="imageviewer_imtype_variable", 
    joinColumns={@JoinColumn(name="ImTypeId")}, 
    inverseJoinColumns={@JoinColumn(name="VarId")})
    private Set<CRVariable> crvariables = new HashSet<CRVariable>(); 
```

**CRV 变量实体：**

```
@Entity
@Table(name = "imageviewer_crvariable")
public class CRVariable implements Serializable   {

    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue
    @Column(name = "VarId")
    private Long varId;

    @Column(name = "VarName")
    private String varName;

    @Column(name = "VarDescription")
    private String varDescription;

    @ManyToMany(mappedBy="crvariables")
    private Set<CRImageType> crimagetypes = new HashSet<CRImageType>(); 
```

在我的数据库中，关系由两个表“imageviewer_crimagetype”和“imageviewer_crvariable”和第三个**“imageviewer_imtype_variable”**映射，用于它们的多对多关系。

我只想从表**"imageviewer_imtype_variable"**中删除关联记录。如何使用 HQL 查询来完成，因为我无法直接访问“imageviewer_imtype_variable 表。

我想要 SQL 查询的 HQL 等价物

```
delete from imageviewer_imtype_variable where ImTypeId='%%%' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:17:56.787

这是 JPA，而不是专门的 Hibernate。如果您在 API 的上下文中搜索，而不是在实现中搜索，那么您在此处有一个标准化的 API 会更容易找到答案。

做到这一点的方法（据我记得，我不经常使用多对多关系）是从彼此的集合映射字段中删除相关实体。因此，如果您有 EntityA 和 EntityB，则从 EntityB 中删除 EntityA，从 EntityA 中删除 EntityB。然后应该触发持久性提供程序以从连接表中删除记录。

本机查询应该只是 IMO 的最后手段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:53:50.993

*   您可以执行本机 SQL 查询：

[http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch18.html#querysql-creating](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch18.html#querysql-creating)

所以在你的情况下，类似：

```
session.createSQLQuery("DELETE FROM imageviewer_imtype_variable").executeUpdate(); 
```

*   您还可以在**`CrImageType`**实体中指定自定义本机 SQL DELETE 查询：

[http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch18.html#querysql-cud](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch18.html#querysql-cud)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-02T11:05:00.303

根据我的经验，处理 ManyToMany 关系是少数情况下摆脱 ORM 集成是我们头脑的最佳选择之一。特别是，当您使用双向导航时（即当关系和逆关系很有用时）。

@Gimby 在他的回答中是正确的，问题是复杂的交叉引用比做一个简单的本机查询要困难得多。

所以：

```
session.createSQLQuery("DELETE FROM imageviewer_imtype_variable").executeUpdate(); 
```

更容易，如果由于交叉引用而仍然无法正常工作，您甚至可以添加：

```
session.clear(); 
```

好的。这是另一个 ORM 集成侵权，但让你在两行中摆脱粪坑 ;-) 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:53:14.160

@Gimby 的答案是正确的，在多对多关系中，从彼此映射集合中删除相关实例会触发从关系映射表中删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-08T16:38:34.313

在实体类 CRVariable 中添加：

```
@PreRemove
private void removeCRVariableFromCRImageType() {
    for (CRImageType crImageType: CRImageType) {
        crImageType.getCrvariables ().remove(this);
    }
} 
```

此方法将覆盖 JPA 操作 PreRemove，以便从设置的 crvariables 中分离要删除的 CRVariable 对象（技术上是表 imageviewer_imtype_variable）

希望这对你有帮助！

# c# - 使用 SetupDiGetDevicePropertyW 获取 USB 信息

> ID：13292355
> 
> 赞同：2
> 
> 时间：2012-11-08T15:42:14.023
> 
> 标签：c#, winforms, winapi

我试图让 SetupDiGetDevicePropertyW 方法工作但没有成功。

P/Invoke 声明为：

```
// Device Property
[StructLayout(LayoutKind.Sequential)]
internal struct DEVPROPKEY
{
    public Guid fmtid;
    public UInt32 pid;
}
/// <summary>
/// Provides details about a single USB device.
/// </summary>
[StructLayout(LayoutKind.Sequential, Pack = 1)]
internal struct DeviceInterfaceData
{
    public int Size;
    public Guid InterfaceClassGuid;
    public int Flags;
    public UIntPtr Reserved;
}

[DllImport("setupapi.dll", SetLastError = true)]
internal static extern bool SetupDiGetDevicePropertyW(
        IntPtr deviceInfoSet,
        ref DeviceInterfaceData DeviceInfoData,
        ref DEVPROPKEY propertyKey,
        out UInt64 propertyType, // or Uint32 ?
        IntPtr propertyBuffer, // or byte[]
        uint propertyBufferSize,
        out uint requiredSize,
        UInt32 flags);

/// <summary>
/// Gets a new key for the bus reported device description.
/// </summary>
internal static DEVPROPKEY DEVPKEY_Device_BusReportedDeviceDesc
{
    get
    {
        DEVPROPKEY key = new DEVPROPKEY();
        key.pid = 4;
        key.fmtid = new Guid((uint)0x540b947e, (ushort)0x8b40, (ushort)0x45bc, 0xa8, 0xa2, 0x6a, 0x0b, 0x89, 0x4c, 0xbd, 0xa2);
        return key;
    }
} 
```

我打电话给：

```
uint propertyRegDataType = 0;
uint requiredSize = 0;
IntPtr buffer = Marshal.AllocHGlobal(1024);
if (UnsafeNativeMethods.SetupDiGetDevicePropertyW(infoSet, ref deviceInterfaceData, ref devicePropertyKey, out propertyType, buffer, 1024, out requiredSize, 0))
{
}
else
{
    int test = Marshal.GetLastWin32Error(); // returns 87 - invalid parameter
} 
```

infoSet 的值来自：

```
IntPtr infoSet = UnsafeNativeMethods.SetupDiGetClassDevs(ref hidGuid, null, IntPtr.Zero, DIGCF_DEVICEINTERFACE | DIGCF_PRESENT); 
```

deviceInterfaceData 的值包括接口的 GUID，它来自：

```
UnsafeNativeMethods.SetupDiEnumDeviceInterfaces(infoSet, 0, ref hidGuid, (uint)i, ref deviceInterfaceData); 
```

hidGuid 来自（其中 result 是一个 Guid 对象：

```
UnsafeNativeMethods.HidD_GetHidGuid(out result); 
```

我在这里做错了什么？

# c++ - 具有获取函数的模板类总是返回引用，

> ID：13292359
> 
> 赞同：1
> 
> 时间：2012-11-08T15:42:21.080
> 
> 标签：c++, templates, reference

怎么可能有一个模板类在这里称为

**带有模板参数**TBackBufferType** **、TFrontBufferType 的 FrontBackBuffer****

 **```
template< typename TBufferTypeFront, typename TBufferTypeBack = TBufferTypeFront>
class FrontBackBuffer{
  public:
  explicit FrontBackBuffer(
     TBufferTypeFront const & m_front,
     TBufferTypeBack  const & m_back):
     m_Front(m_front),
     m_Back(m_back)
  {
  };

  ~FrontBackBuffer()
  {};

  typename std::remove_reference<
    typename std::remove_pointer<TBufferTypeFront>::type
  >::type  & getFront(){return m_Front;}    // error: invalid initialization of reference of type 'A&' from expression of type 'A*'| (here T is A)

  typename std::remove_reference<
    typename std::remove_pointer<TBufferTypeBack>::type 
  >::type  & getBack(){return m_Back;}

  TBufferTypeFront m_Front;       ///< The front buffer
  TBufferTypeBack m_Back;         ///< The back buffer

}; 
```

我想实现以下目标：

*   为了在代码中保持一致，我希望无论缓冲区内的类型是什么，都有一个函数**getFront/Back**应该始终返回对缓冲区的引用（一个 const 或一个非常量，具体取决于type: eg const int = T 应该返回一个 const int & 引用！我想写这样的代码

    ```
    FrontBuffer<const int&, std::vector<int> > a;
    a.getFront() = 4 //COmpile error! OK!;
    a.getBack()[0] = 4;
    FrontBuffer< int*, GAGAType * > b;
    b.getBack() = GAGAType();
    b.getFront() = int(4);  // this is no ERROR, i would like to get the reference of the memory location pointet by int* .... 
    ```

我想要这个，因为如果我将缓冲区类型从引用更改为指针（我需要取消引用），我想避免更改语法

*   这样的 Buffer 类是否可以接受所有可能的类型（如 shared_ptr）asd

*   我想要的只是一些访问权限，它应该非常高效，没有副本等等

*   我真的不知道如何编写这个通用缓冲区？有人有任何线索吗？

谢谢！！！

**EDIT1**我还希望能够分配给取消引用的指针：

```
b.getFront() = int(4);  // this is no ERROR, i would like to get the reference of the memory location pointet by int* .... 
```

这就是我的特征问题所在！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T15:50:29.570

您需要专门化（[特征技术](http://www.boost.org/community/generic_programming.html#traits)）模板的一部分，如下所示：

```
template <typename T>
struct MyRefTypes {
    typedef const T & Con;
    typedef T& Ref;
    typedef const T& CRef;
    static Ref getRef(T& v) {
        return v;
    }
}; 
```

**更新**
请注意返回引用的特殊函数 - 如果您想对指针采取不同的行为，则需要它 - 为它返回引用。
**结束更新**

并对引用和常量引用进行专门化：

```
template <typename T>
    struct MyRefTypes {
        typedef const T & Con;
        typedef T& Ref;
        typedef const T& CRef;
        static Ref getRef(T& v) {
            return v;
        }
    };

//Specialization for Reference
    template <typename T>
    struct MyRefTypes<T&> {
        typedef T & Con;
        typedef T& Ref;
        typedef const T& CRef;
        static inline Ref getRef(T& v) {
            return v;
        }
    };

//Specialization for const Reference
    template <typename T>
    struct MyRefTypes<const T&> {
        typedef const T & Con;
        typedef const T& Ref;
        typedef const T& CRef;
        static inline Ref getRef(const T& v) {
            return v;
        }
    };

//Specialization for const
    template <typename T>
    struct MyRefTypes<const T> {
        typedef const T & Con;
        typedef const T& Ref;
        typedef const T& CRef;
        static inline Ref getRef(const T& v) {
            return v;
        }
    }; 
```

**更新**
和指针的这种“特殊”专业化 - 所以它们将作为参考：

```
//Specialization for pointers
    template <typename T>
    struct MyRefTypes<T*> {
        typedef T* Con;
        typedef T& Ref;
        typedef T* const CRef;  //! note this is a pointer....
        static inline Ref getRef(T* v) {
            return *v;
        }
    };

//Specialization for const pointers
    template <typename T>
    struct MyRefTypes<const T*> {
        typedef const T* Con;
        typedef const T& Ref;
        typedef const T* const CRef; //! note this is a pointer....
        static inline Ref getRef(const T* v) {
            return *v;
        }
    }; 
```

（（但是我不确定这种指针专业化是一个好的设计......））

**结束更新**

并在您的类模板中使用：

```
template< typename TBufferTypeFront, typename TBufferTypeBack = TBufferTypeFront>
class FrontBackBuffer{
  public:

   typedef typename MyRefTypes<TBufferTypeFront>::Ref TBufferTypeFrontRef;
   typedef typename MyRefTypes<TBufferTypeFront>::CRef TBufferTypeFrontCRef;
   typedef typename MyRefTypes<TBufferTypeFront>::Con TBufferTypeFrontCon;

   typedef typename MyRefTypes<TBufferTypeBack >::Ref TBufferTypeBackRef;
   typedef typename MyRefTypes<TBufferTypeBack >::CRef TBufferTypeBackCRef;
   typedef typename MyRefTypes<TBufferTypeBack >::Con TBufferTypeBackCon;

  explicit FrontBackBuffer(
     TBufferTypeFrontCon m_front,
     TBufferTypeBackCon m_back):
     m_Front(m_front),
     m_Back(m_back)
  {
  };

  ~FrontBackBuffer()
  {};
  // See here special functions from traits are used:
  TBufferTypeFrontRef getFront(){return MyRefTypes<TBufferTypeFront>::getRef(m_Front); }    
  TBufferTypeBackRef getBack(){return MyRefTypes<TBufferTypeBack>::getRef(m_Back); }

  TBufferTypeFront m_Front;       ///< The front buffer
  TBufferTypeBack m_Back;         ///< The back buffer

}; 
```

它按预期工作：http: [//ideone.com/e7xfoN](http://ideone.com/e7xfoN)**

# batch-file - 如果添加、删除或更新，将每行两个 csv 文件行与输出进行比较

> ID：13292360
> 
> 赞同：4
> 
> 时间：2012-11-08T15:42:21.233
> 
> 标签：batch-file

我有两个带有 5 个字段的 csv 文件，其中分隔符是逗号。我需要比较这些文件并获得一个输出文件，其中包含添加、更新或删除哪些行的信息。

我发现了几个使用 fc 或 comp 函数进行比较的批处理脚本，但只给出了文件之间的差异。我没有找到相关主题可以给出关于添加、更新或删除行的结果。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T04:46:13.880

这个话题很有趣！也许你和我一样，对 FC 命令的输出格式感到困惑和恼火，尽管它确实提供了所需的信息。下面的批处理程序获取 FC 命令的输出并重新排列它，以允许识别是否在原始文件的两行之间添加了新的信息块，或者是否从原始文件中删除了行块，或任何其他文件修改情况（更新）。最困难的部分是选择格式以令人愉快的方式显示信息，但我认为我的解决方案非常好！

```
@echo off
rem FCOMP.BAT: Format FC output in a pleasant way
rem Antonio Perez Ayala
if "%~2" neq "" goto start
echo Format FC output identifying added, deleted or updated sections
echo/
echo FCOMP filename1 filename2 [/switches /for /FC /command]
goto :EOF

:start
setlocal EnableDelayedExpansion
set while=if not
set do=goto endwhile
set endwhile=goto while
set "space= "
set "spaces39=                                       "
fc %3 %4 %5 %6 %7 %8 %9 %1 %2 > differences.txt
if %errorlevel% equ 1 call :FormatFC < differences.txt
del differences.txt
goto :EOF

:FormatFC
set /P line=
set /P line=
rem Process each set of differences
:while
%while% defined line %do%
   rem Load old and new sections of this set
   set line=
   set /P line=
   set old=0
   :while1
   %while% "!line:~0,5!" neq "*****" %do%1
      set /A old+=1
      set oldLine[%old%]=!line!%spaces39%
      set line=
      set /P line=
   %endwhile%1
   :endwhile1
   set line=
   set /P line=
   set new=0
   :while2
   %while% "!line:~0,5!" neq "*****" %do%2
      set /A new+=1
      set newLine[%new%]=!line!%space%
      set line=
      set /P line=
   %endwhile%2
   :endwhile2
   rem Identify the type of this set
   if %old% equ 2 (
      echo ======  NEW SECTION ADDED  ====================================================
      echo/
      echo(!oldLine[1]:~0,79!
      set /A new-=1
      for /L %%i in (2,1,!new!) do echo(        ^|!newLine[%%i]:~0,70!
      echo(!oldLine[2]:~0,79!
   ) else if %new% equ 2 (
      echo OLD SECTION DELETED  ==========================================================
      echo/
      echo(---------!newLine[1]:~0,70!
      set /A old-=1
      for /L %%i in (2,1,!old!) do echo -!oldLine[%%i]:~0,78!
      echo(---------!newLine[2]:~0,70!
   ) else ( rem both %old% and %new% gtr 2
      echo ==============================  SECTION UPDATED  ==============================
      echo/
      if %old% lss %new% (
         for /L %%i in (1,1,%old%) do echo(!oldLine[%%i]:~0,39!^|!newLine[%%i]:~0,39!
         set /A old+=1
         for /L %%i in (!old!,1,%new%) do echo(%spaces39%^|!newLine[%%i]:~0,39!
      ) else (
         for /L %%i in (1,1,%new%) do echo(!oldLine[%%i]:~0,39!^|!newLine[%%i]:~0,39!
         set /A new+=1
         for /L %%i in (!new!,1,%old%) do echo(!oldLine[%%i]:~0,39!
      )
   )
   rem Pass to next set of differences
   echo/
   set /P line=
   set line=
   set /P line=
%endwhile%
:endwhile
exit /B 
```

安东尼奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T20:44:43.030

*编辑：正如所指出的，这是一个 shell 脚本选项，希望它可以对其他人有所帮助*

这是一个选项，我没有检查过大文件的性能：

```
$ cat file1
1,'adam'
2,'chris'
6,'phil'
3,'charles'

$ cat file2
2,'christopher'
6,'phil'
3,'chuck'
8,'sue',2
4,'mary'
21,'matt' 
```

--我们假设 CSV 文件分隔符是逗号，每条记录的第一个字段是主键（唯一值）

```
$ comm -3 <(sort file1) <(sort file2) | sed -e 's/^[ \t]*//' | awk -F , '{if (a[$1]) {print "^"$1","} {a[$1] = $0}}' > data2.txt 
```

- 更新

```
$ cat data2.txt | grep -E -f - file2 
```

--删除

```
$ cat data2.txt | grep -v -E -f - <(comm -2 -3 <(sort file1) <(sort file2)) 
```

--插入

```
$ cat data2.txt | grep -v -E -f - <(comm -1 -3 <(sort file1) <(sort file2)) 
```

# vba - VBA 返回“运行时错误 91：对象变量或未设置块变量”

> ID：13292364
> 
> 赞同：0
> 
> 时间：2012-11-08T15:42:32.073
> 
> 标签：vba, excel

好的，所以我正在尝试在 VBA 中制作一个复杂的地理编码脚本。我编写了以下代码，由于某种原因它返回错误（“运行时错误 91：对象变量或未设置块变量”）。我使用的链接示例可以是：“https://maps.googleapis.com/maps/api/geocode/xml?address=1+Infinite+Loop,+Cupertino,+Santa+Clara,+California+95014&sensor =假”。

```
Sub readXML(link As String)
Dim odc As DOMDocument
Dim lat As IXMLDOMElement
Dim lng As IXMLDOMElement

Set odc = New MSXML2.DOMDocument
odc.async = False
odc.Load (link)

lat = odc.SelectSingleNode("GeocodeResponse/result/geometry[location_type='ROOFTOP']/location/lat").Text
lng = odc.SelectSingleNode("GeocodeResponse/result/geometry[location_type='ROOFTOP']/location/lng").Text

Debug.Print lat & "; " & lng
End Sub 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:06:40.687

`SelectSingleNode()`可能会回来`Nothing`。

`.Text`如果函数的结果可以是 ，则永远不要在函数上调用属性（如） `Nothing`。

做这样的事情来避免这个错误：

```
Dim location As IXMLDOMElement
Dim locationPath As String

locationPath = "GeocodeResponse/result/geometry[location_type='ROOFTOP']/location"
Set location = odc.SelectSingleNode(locationPath)

lat = GetTextValue(location, "./lat")
lng = GetTextValue(location, "./lng")

' ------------------------------------------------------------------------

Function GetTextValue(node As IXMLDOMElement, Optional xpath As String = "") As String
  Dim selectedNode As IXMLDOMElement

  If xpath <> "" And Not node Is Nothing Then
    Set selectedNode = node.SelectSingleNode(xpath)
  Else
    Set selectedNode = node
  End If

  If selectedNode Is Nothing Then
    GetTextValue = ""
  Else
    GetTextValue = Trim(selectedNode.Text)
  End If
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T19:33:31.840

当我尝试在不使用`set`. 尝试这个：

```
Set lat = odc.SelectSingleNode("GeocodeResponse/result/geometry[location_type='ROOFTOP']/location/lat").Text
Set lng = odc.SelectSingleNode("GeocodeResponse/result/geometry[location_type='ROOFTOP']/location/lng").Text 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:47:27.607

为什么 /location/lat 之前的空格和 lng 上的 .Text 而不是 lat？

# javascript - 无法让 jQuery 匹配高度

> ID：13292367
> 
> 赞同：0
> 
> 时间：2012-11-08T15:42:34.370
> 
> 标签：javascript, jquery, html, css

我无法使用以下代码使按钮的高度匹配。我已经导入了 jQuery。有任何想法吗？我敢肯定，我忽略了一些明显的事情。

```
<div class="row-fluid " id="imageUploadBtns">
   <div class="span2 offset2" id="imageUploadBtn"> 
      Some Text 
   </div>
   <div class="span2" id="imageUploadBtn">
      ...
   </div>
   <div class="span2" id="imageUploadBtn">
      ...
   </div>
   <div class="span2" id="imageUploadBtn">
      ...
   </div>
</div>

<script>
   boxes = $('#imageUploadBtn');
   maxHeight = Math.max.apply(
   Math, boxes.map(function() {
       return $(this).height();
   }).get());
   boxes.height(maxHeight);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:48:07.710

您不应该对多个属性使用相同的 ID。您可能只从 $('#imageUploadBtn') 获得一个元素，尝试使用 $('.span2') 代替

# iphone - 如何锚定相对于屏幕 iPhone 一侧的视图

> ID：13292369
> 
> 赞同：0
> 
> 时间：2012-11-08T15:42:38.837
> 
> 标签：iphone, ios, core-graphics, cgaffinetransform, autoresizingmask

我正在创建一个直接在代码中创建布局的 iOS 应用程序。我习惯使用 xib，但这不是这个项目的选择。我不知道如何定位固定在屏幕底部/侧面的元素。我正在寻找的解决方案会将其放置在纵向底部，但在旋转时会将其固定在右侧（非常类似于底部栏在相机应用程序中的工作方式）。它在纵向的屏幕底部正确，问题在于旋转

另外我正在为 iOS 5 构建，所以我需要一个不使用自动布局的解决方案。

这是到目前为止我在旋转到横向时所做的代码。这个想法是我旋转 90 度（正在工作），然后使用某种遮罩将其锚定到左侧。我在哪里错了？甚至可以锚定这样的对象吗？

```
myView.autoresizingMask = UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleLeftMargin;

CGAffineTransform rotate90 = CGAffineTransformMakeRotation(degreesToRadians(-90));

myView.transform = rotate90; 
```

![示例草图](../Images/66d9345bc28213f442a22f70a330771c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:09:50.860

您需要使用`NSLayoutConstraints`来执行此操作。

我对约束编码不太了解，所以请参考[NSLayoutConstraint](http://developer.apple.com/library/ios/#documentation/AppKit/Reference/NSLayoutConstraint_Class/NSLayoutConstraint/NSLayoutConstraint.html#//apple_ref/occ/cl/NSLayoutConstraint)以获得更多参考。

[关于 NSLayoutConstraints 的 WWDC 2012 会议视频](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html#//apple_ref/doc/uid/TP40010853-CH1-SW1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:38:59.840

不要与酒吧打交道，而要与酒吧内的景色打交道。

尝试这个 ：

1) 使用以下命令防止您的应用自动旋转：

```
//For iOS 5 and lower
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation {
    return NO;
}

//For iOS 6 and upper
- (BOOL)shouldAutorotate {
    return NO;
} 
```

2）旋转你的酒吧内的视图，而不是你的酒吧本身

希望它会帮助你。

# macos - excel vba中的macid文件类型是什么

> ID：13292376
> 
> 赞同：0
> 
> 时间：2012-11-08T15:43:03.277
> 
> 标签：macos, excel, vba, excel-2011

什么是所有可能的 MacID("filetype") 我需要专门用于 CSV 的 MacID，但令人惊讶的是，我在网上任何地方都找不到列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-26T10:04:02.833

只是为了这个线程。

是的，很少有地方可以找到 MacID 的详细信息，但要小心。

如果文件是在 PC 上创建的，则它的 MacID 设置可能不正确，或者根本没有正确设置。

我正在使用在两个平台上创建的 Excel 文件。如果文件是在 Mac 上制作的，XLSX ID 是正确的，但如果是在 PC 上制作的，则为空。

我发现最好的解决方案是忽略两个平台的两种形式的通配符，而是只加载所有文件并使用扩展名 .xlsx

希望这可以帮助某人

鲍勃·J。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T21:59:00.920

首轮：

```
mdls "FileName" 
```

在输出中找到 TypeCode：

```
kMDItemFSTypeCode = "TEXT" 
```

您可以使用：

```
Dir(Path,MacID("TEXT")) 
```

# google-app-engine - 用户帐户（Python 2.7 + Webapp2 + Google App Engine + Jinja + NDB + WTForms）

> ID：13292387
> 
> 赞同：2
> 
> 时间：2012-11-08T15:43:38.663
> 
> 标签：google-app-engine, python-2.7, jinja2, webapp2, wtforms

几周来，我一直在绞尽脑汁，试图让这个身份验证模块在使用 Jinja、NDB 和 WTForms 的 webapp2 框架下工作。我在网上到处都看过，已经到了我的崩溃点，需要向某人寻求帮助。我一直在关注这个教程（它非常彻底，但我认为遗漏了一些重要的细节，特别是对于像我这样的新手）：

[使用 Webapp2 + Google App Engine 的用户帐户](http://gosurob.com/post/20024043690/gaewebapp2accounts)

据我所知，我已经正确设置了所有内容，但我不断收到 404 - 找不到资源。我可能做错了什么？这是我的代码...

处理程序.py：

```
import webapp2

import sys
from google.appengine.ext import ndb
 sys.modules['ndb'] = ndb

import webapp2_extras.appengine.auth.models as auth_models

from google.appengine.api import users
from webapp2_extras import sessions, auth # we'll use auth later on
from webapp2_extras.auth import InvalidAuthIdError
from webapp2_extras.auth import InvalidPasswordError
from wtforms import Form, TextField, PasswordField, validators
from webapp2_extras.appengine.users import login_required

def jinja2_factory(app):
    j = jinja2.Jinja2(app)
    j.environment.filters.update({
    # Set filters. (http://tinyurl.com/jinja2-factory)
    # ...
})
    j.environment.globals.update({
        # Set global variables.
        'uri_for': webapp2.uri_for,
        # ...
    })
    return j

def login_required(handler):

    def check_login(self, *args, **kwargs):     
        if not self.user:
            return self.redirect_to('login')
        else:
            return handler(self, *args, **kwargs)
    return check_login    

class UserAwareHandler(webapp2.RequestHandler):

    def dispatch(self):        
        try:
            super(UserAwareHandler, self).dispatch()
        finally:
            # Save the session after each request        
            self.session_store.save_sessions(self.response)  

    @webapp2.cached_property
    def session_store(self):
        return sessions.get_store(request=self.request)

    @webapp2.cached_property
    def session(self):
        return self.session_store.get_session(backend="datastore")

    @webapp2.cached_property
    def auth(self):
        return auth.get_auth(request=self.request)

    @webapp2.cached_property
    def user(self):
        user = self.auth.get_user_by_session()
        return user

    @webapp2.cached_property
    def user_model(self):
        user_model, timestamp = self.auth.store.user_model.get_by_auth_token(
                self.user['user_id'], 
                self.user['token']) if self.user else (None, None)
        return user_model

    @webapp2.cached_property
    def jinja2(self):
        return jinja2.get_jinja2(factory=jinja2_factory, app=self.app)

    def render_response(self, _template, **context):
        ctx = {'user': self.user_model}
        ctx.update(context)
        rv = self.jinja2.render_template(_template, **ctx)
        self.response.write(rv)

class SignupForm(Form):
    email = TextField('Email', 
                [validators.Required(), 
                 validators.Email()])
    password = PasswordField('Password', 
                [validators.Required(), 
                 validators.EqualTo('confirm_password', 
                                message="Passwords must match.")])
    password_confirm = PasswordField('Confirm Password', 
                    [validators.Required()])

class SignupHandler(UserAwareHandler):
    #Serves up a signup form, creates new users
    def get(self):
        self.render_response("templates/signup.html", form=SignupForm())

    def post(self):
        form = SignupForm(self.request.POST)
        error = None
    if form.validate():
        success, info = self.auth.store.user_model.create_user(
            "auth:" + form.email.data,
            unique_properties=['email'],
            email= form.password.data,
            password_raw= form.password.data)

        if success:
            self.auth.get_user_by_password("auth:"+form.email.data, 
                                            form.password.data)
            return self.redirect_to("index")
        else:
            error = "That email is already in use." if 'email'\
                    in user else "Something has gone horrible wrong."

    self.render_response("templates/signup.html", form=form, error=error)

class LoginForm(Form):
    email = TextField('Email', 
                [validators.Required(), validators.Email()])
    password = PasswordField('Password', 
                [validators.Required()])

class LoginHandler(UserAwareHandler):
    def get(self):
        self.render_response("templates/index.html", form=LoginForm())

    def post(self):
        form = LoginForm(self.request.POST)
        error = None
        if form.validate():
            try:
                self.auth.get_user_by_password(
                        "auth:"+form.email.data, 
                        form.password.data)
                return self.redirect_to('secure')
            except (auth.InvalidAuthIdError, auth.InvalidPasswordError):                    
                error = "Invalid Email / Password"

        self.render_response("templates/login.html", form=form, error=error)

class LogoutHandler(UserAwareHandler):
    #Destroy the user session and return them to the login screen.
        @login_required
        def get(self):
        self.auth.unset_session()
        self.redirect_to('login')

class IndexHandler(UserAwareHandler):
    def get(self):

    ctx = {
      'title1': "ALAZA",
      'title2': "HOA",      
      'slogan': "A communication tool for the Alazan HOA.",
      'message1': """
      <p>The whole idea here is to show how to set up a simple static web site  
      on Google App Engine. I want to create an easy way to host your modest web  
      site on App Engine. My approach is dead simple. All I use is some boilerplate 
      code almost anyone can follow. You can have multiple pages and use template  
      variable features that are part of App Engine's WebApp Framework. Most modest 
      web sites don't do much more than this. Your certainly free to expand on what 
      you find here.</p>""",
      }

        self.render_response('templates/index.html', **ctx) 
```

主要.py：

```
import webapp2
import config
import routes

import sys
from google.appengine.ext import ndb
sys.modules['ndb'] = ndb

import webapp2_extras.appengine.auth.models as auth_models

class AwesomeUser(auth_models.User):
    email = ndb.StringProperty()

webapp2_config = {}

webapp2_config['webapp2_extras.sessions'] = {
    'secret_key': 'othello',}

webapp2_config['webapp2_extras.auth'] = {
    'user_model': AwesomeUser,}

app = webapp2.WSGIApplication(config=config.webapp2_config)
routes.add_routes(app) 
```

路线.py：

```
import handlers
import webapp2
from webapp2_extras.routes import RedirectRoute

# Using redirect route instead of simple routes since it supports strict_slash
# Simple route: http://webapp-improved.appspot.com/guide/routing.html#simple-routes
# RedirectRoute: http://webapp-improved.appspot.com/api/webapp2_extras/routes.html#webapp2_extras.routes.RedirectRoute

_routes = [
    RedirectRoute('templates/login.html', handlers.LoginHandler, name='login'),
    RedirectRoute('/templates/logout.html', handlers.LogoutHandler, name='logout'),
    RedirectRoute('/templates/index.html', handlers.IndexHandler, name='index'),
    RedirectRoute('/templates/signup.html', handlers.SignupHandler, name='signup'),]

def get_routes():
    return _routes

def add_routes(app):
    if app.debug:
        secure_scheme = 'http'
    for r in _routes:
        app.router.add(r) 
```

应用程序.yaml：

```
application: alazan-hoa
version: main
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /js
  static_dir: js
- url: /images
  static_dir: images
- url: /css
  static_dir: css
- url: /.*
  script: main.app

libraries:
- name: webapp2
  version: "2.5.1"
- name: jinja2
  version: "2.6"

builtins:
- appstats: on 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T16:23:03.333

在您的 routes.py 文件中，`RedirectRoute`您指定 html 文件，同时您应该指定映射到处理程序方法并在其中呈现 html 模板的路径。

例如，在您的 routes.py 文件中，您应该有如下内容：

```
_routes = [
    RedirectRoute('/login', handlers.LoginHandler, name='login'),
    RedirectRoute('/logout', handlers.LogoutHandler, name='logout'),
    RedirectRoute('/index', handlers.IndexHandler, name='index'),
    RedirectRoute('/signup', handlers.SignupHandler, name='signup')
] 
```

您可以查看[Google App Engine Boilerplate](https://github.com/coto/gae-boilerplate)，了解有关 Google App Engine 开发及其最佳实践的介绍。

希望这可以帮助！

# iphone - 将背景 button2 更改为 button1 iPhone

> ID：13292391
> 
> 赞同：1
> 
> 时间：2012-11-08T15:43:44.270
> 
> 标签：iphone, objective-c, xcode, cocoa, button

我是 Xcode 的初学者，我有一个问题。我有 2 个按钮：

```
- (IBAction) HIGH1: (id) sender
- (IBAction) HIGH2: (id) sender 
```

当用户单击`HIGH1`按钮时，我想更改按钮的背景（带图像）`HIGH2`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T21:47:46.277

您需要为按钮创建 IBOutlet 以更改它们。

控制并从 Interface Builder 中拖动按钮到 .h 文件以创建出口。像这样的东西：

```
@property (weak, nonatomic) IBOutlet UIButton *HIGH1;
@property (weak, nonatomic) IBOutlet UIButton *HIGH2;
//Dont forget to @synthesize 
```

然后在 IBAction 方法上调用：

```
- (IBAction) HIGH1: (id) sender
{
    self.HIGH2 setBackgroundImage:[UIImage imageNamed:@"myButtonImage"] forState:UIControlStateNormal];
} 
```

确保您有一个具有您在应用程序包中选择的名称的图像，并且按钮的 IBOutlet 已正确连接（IBOutlet 左侧大小的灰色圆圈必须在其中有一个黑色小圆圈）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:17:52.403

```
[HIGH1 addTarget:self
          action:@selector(buttonDidPushed)
forControlEvents:UIControlEventTouchUpInside]; 
```

然后，

```
-(void)buttonDidPushed
{
       HIGH2.backgroundColor = [UIColor blackColor];
       [self.view addSubview:HIGH2];
} 
```

我希望这段代码对你有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:45:55.287

从 HIGH2 访问您的 ivar 并在 HIGH1 上设置 setBackgroundImage:forState:

# node.js - 使用嵌套 ID 在 JSON 中查找对象

> ID：13292393
> 
> 赞同：0
> 
> 时间：2012-11-08T15:43:53.663
> 
> 标签：node.js, mongodb, node-mongodb-native, restify

我有一个像这样的 mongo 收藏

```
{"stores": [{"name": "foo",
             "songs": [ {"id": "", "name": "", "artist": "", "category": "", "tags": []} ],
             "songsSchedule": [
                               {
                                "song_id": "",
                                "date": ,
                                "user": "",
                                "help": ,
                                "partners": [{"user": ""}],
                                "likes":
                               }
                             ]
 }]} 
```

我想从songsSchedule song_id中获取歌曲名称和艺术家，我试过了，但它不起作用

```
var query = { _id: fn.generateID(req.params.store_id), songsSchedule: { $exists: true } };
var select = { songsSchedule:1 };
var array = [];

client("stores", function(err, collection) {
    if (err) 
       return res.json(fn.status("30"));

  collection.findOne(query, select, function(err, store) {
        if (err || !store) 
           return res.json(fn.status("31"));

    for (var i in store.songsSchedule) {
      var song = store.songsSchedule[i];
      array.push(song.song_id);
    }

    collection.find({ _id: fn.generateID(req.params.store_id), "songs._id": { $in: array } }, function(err, songs) {

      res.json(songs);
    });
    });
}); 
```

我真的不知道这是否是最好的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:12:24.893

我不完全清楚您所说的“从songsSchedule song_id 获取歌曲名称和艺术家”是什么意思，但看起来这个查询会很混乱。

如果是我，我会考虑将歌曲和 songSchedule 拆分到他们自己的集合中以便于查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:41:36.857

从您的文档示例中，“歌曲”字段包含不包含“_id”字段的文档。

```
 "songs": [ {"name": "", "artist": "", "category": "", "tags": []} ] 
```

但是，您的 find() 查询正在查询“songs._id”字段。

另外，我对 json() 方法不太熟悉，但它可以处理游标吗？

问候，

凯

# java - 如何存储单个浏览器选项卡/窗口的状态？

> ID：13292395
> 
> 赞同：4
> 
> 时间：2012-11-08T15:44:15.603
> 
> 标签：java, servlets

我正在开发一个单页 jQuery 和 Backbone.js 网络应用程序。后端是 JBoss 6 应用服务器。

到目前为止，我们有以下结构：

*   只有一个 servlet（前端控制器）。来自 JavaScript 客户端的每个请求都经过这里。
*   在 servlet 中——在某个 JS 客户端的第一个请求下——我查看了一个有状态会话 bean。对于该客户端的下一个请求，我将查找结果存储在 HTTP 会话容器中。所以每个 JS 客户端都只有一个有状态的会话 bean。此连接由会话 cookie 保存。

现在我有一个额外的要求：

当用户有两个浏览器选项卡（在一个浏览器中）时，他们应该在每个浏览器选项卡中都有两个独立的 Web 应用程序实例。因此，我对会话 cookie 有疑问，因为此会话 cookie 适用于所有浏览器选项卡。

我必须改变结构，以便：

*   servlet 必须为某个 JS 客户端的第一个请求生成一个新的会话 ID。此会话 ID 被传达给客户端。
*   对于后端的每个 POST，JS 客户端都必须发送此会话 ID。

我的问题是：

到目前为止，我将查找结果保存在 HTTP Session 对象中，而且我还没有考虑生成会话 ID。但是现在我必须将它存储在其他地方，在哪里？

有没有人有这种设置的经验，可以帮助我吗？

**更新：**
感谢 BalusC 提供这种非常有趣的方法。
当我很好理解你时，这意味着：

*一个*浏览器的标签页的所有单独的 JS 客户端共享一个 HTTP 会话对象。在这个 HTTP 会话对象中，每个选项卡都有自己的入口点。这听起来真的很好。所以我仍然可以使用整个 HTTP 会话基础架构，而不必重新发明轮子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T15:52:45.917

在您存储的初始 GET 请求上自动生成一个唯一值，并在每个后续回发中作为隐藏输入值传递。将此唯一值用作表示视图范围数据的会话属性的标识符。

在全新会话的第一个请求期间，请执行以下操作：

```
Map<String, ViewData> viewScope = new HashMap<String, ViewData>();
session.setAttribute("viewScope", viewScope); 
```

*（`ViewData`代表您希望在同一视图的回发中跟踪的特定于视图的数据）*

在每个 GET 请求期间，请执行以下操作：

```
String viewDataId = UUID.randomUUID().toString();
viewScope.put(viewDataId, new ViewData());
request.setAttribute("viewDataId", viewDataId); 
```

在生成 HTML 期间，请执行以下操作：

```
<input type="hidden" name="viewDataId" value="${viewDataId}" /> 
```

在每个 POST 请求期间，请执行以下操作：

```
ViewData viewData = viewScope.get(request.getParameter("viewDataId"));
// Get/set view-specific data in there. 
```

确保 jQuery 也传递了这个隐藏的输入（如果您已经正确使用`$(form).serialize()`或例如 AjaxForm 插件来 ajaxify 表单，这应该不是一个大问题）。

如果您熟悉 Java EE 的 MVC 框架[JSF](https://stackoverflow.com/tags/jsf/info)，那么了解其`@ViewScoped`注解的工作方式与上述大致相同可能会很有用。另请参阅 ao[如何选择正确的 bean 范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:58:18.607

您可以将会话跟踪与 URL 重写结合使用。看这里：

[会话在选项卡之间共享](https://stackoverflow.com/questions/6243201/session-shared-in-between-tabs)

# python - 导入 matplotlib.pyplot 时出错

> ID：13292396
> 
> 赞同：0
> 
> 时间：2012-11-08T15:44:22.823
> 
> 标签：python, macos, matplotlib, enthought

当我运行时`import matplotlib.pyplot as plt`，我收到以下错误消息：

```
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-1-6f467123fe04> in <module>()
----> 1 import matplotlib.pyplot

/Library/Python/2.7/site-packages/matplotlib/pyplot.py in <module>()
     21 from matplotlib.cbook import dedent, silent_list, is_string_like, is_numlike
     22 from matplotlib import docstring
---> 23 from matplotlib.figure import Figure, figaspect
     24 from matplotlib.backend_bases import FigureCanvasBase
     25 from matplotlib.image import imread as _imread

/Library/Python/2.7/site-packages/matplotlib/figure.py in <module>()
     16 import artist
     17 from artist import Artist, allow_rasterization
---> 18 from axes import Axes, SubplotBase, subplot_class_factory
     19 from cbook import flatten, allequal, Stack, iterable, is_string_like
     20 import _image

/Library/Python/2.7/site-packages/matplotlib/axes.py in <module>()
     12 import matplotlib.artist as martist
     13 from matplotlib.artist import allow_rasterization
---> 14 import matplotlib.axis as maxis
     15 import matplotlib.cbook as cbook
     16 import matplotlib.collections as mcoll

/Library/Python/2.7/site-packages/matplotlib/axis.py in <module>()
      8 from matplotlib.artist import allow_rasterization
      9 import matplotlib.cbook as cbook
---> 10 import matplotlib.font_manager as font_manager
     11 import matplotlib.lines as mlines
     12 import matplotlib.patches as mpatches

/Library/Python/2.7/site-packages/matplotlib/font_manager.py in <module>()
     50 import matplotlib
     51 from matplotlib import afm
---> 52 from matplotlib import ft2font
     53 from matplotlib import rcParams, get_configdir
     54 from matplotlib.cbook import is_string_like

ImportError: dlopen(/Library/Python/2.7/site-packages/matplotlib/ft2font.so, 2): Library not loaded: /opt/local/lib/libfreetype.6.dylib
  Referenced from: /Library/Python/2.7/site-packages/matplotlib/ft2font.so
  Reason: image not found 
```

我`/Library/Python/2.7/site-packages/setuptools.pth`的是这样的：`/Library/Frameworks/EPD64.framework/Versions/7.3/Python`。我`/Library/Python/2.7/site-packages/easy-install.pth`的如下：

```
import sys; sys.__plen = len(sys.path)
./pip-1.2.1-py2.7.egg
/Library/Frameworks/EPD64.framework/Versions/7.3/Python
./pudb-2012.3-py2.7.egg
./Pygments-1.5-py2.7.egg
./urwid-1.0.2-py2.7-macosx-10.8-intel.egg
import sys; new=sys.path[sys.__plen:]; del sys.path[sys.__plen:]; p=getattr(sys,'__egginsert',0); sys.path[p:p]=new; sys.__egginsert = p+len(new) 
```

我应该`matplotlib.pyplot`正确导入什么？我安装了自制软件，正在运行 Enthought Python 发行版，并且正在运行 OSX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:25:02.900

我修好了它！我所做的如下：我删除（在备份后）我系统的站点包文件夹（`/Library/Python/2.7/site-packages`）中的 matplotlib 文件夹。

# c - 叉子中的 malloc

> ID：13292397
> 
> 赞同：0
> 
> 时间：2012-11-08T15:44:23.490
> 
> 标签：c, fork

我正在开发一个应用程序，在该应用程序中我启动一个 fork 来执行一个子进程。

在子进程中，我想创建一个包含许多节点的链表，每个节点都应该创建，`malloc()`然后将链表复制到父进程。因为链表只在子节点中创建，在父节点中不存在。

怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:46:24.597

您必须使用一些进程间通信方法，如共享内存、管道、磁盘上的文件、套接字等。由于进程通常彼此隔离，因此您不能只传递指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:48:08.450

共享内存就是门票。看到这个[页面](http://en.wikipedia.org/wiki/Shared_memory)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:25:04.143

Ed 是对的，共享内存就是答案。在非 Windows 上，只需执行 man shmget 或这是一个很好的参考：[http ://www.cs.cf.ac.uk/Dave/C/node27.html](http://www.cs.cf.ac.uk/Dave/C/node27.html)

# regex - 如何使用正则表达式匹配特定路径下的文件而不是特定扩展名

> ID：13292398
> 
> 赞同：1
> 
> 时间：2012-11-08T15:44:31.070
> 
> 标签：regex, apache, nginx

例如，要匹配 path 下的所有文件（不是 jpg、png、gif）`common`，例如

匹配：

```
/common/foo.php
/common/foo.doc 
```

不匹配：

```
/common/foo.jpg
/common/foo.gif
/foo 
```

目前我正在使用：

```
\/common\/.*^(?:jpg|png|gif)$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:20:01.887

负面的回顾将接近您当前的尝试：

```
\/common\/.*(?<!\.jpg|\.png|\.gif)$ 
```

这匹配以“/common/”开头但不以“.jpg”、“.png”或“.gif”结尾的所有内容。

[演示](http://regexr.com?32obm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T19:41:32.703

```
location /common/ {
    # here configuration for not jpg, png, gif

    location ~ \.(?:png|gif|jpg)$ {
        # here configuration for jpg, png, gif
    }
} 
```

*   [nginx 如何处理请求](http://nginx.org/en/docs/http/request_processing.html)
*   [文档：位置](http://nginx.org/r/location)

# python - 如何提高gevent和tornado结合的性能？

> ID：13292407
> 
> 赞同：2
> 
> 时间：2012-11-08T15:44:56.950
> 
> 标签：python, wsgi, tornado, gevent

我正在尝试使用 gevent 作为 wsgi 服务器，并使用 tornado WSGIApplication 来处理请求。这是代码

```
#!/usr/bin/env python
# coding=utf-8

import gevent
from gevent import monkey
monkey.patch_all(thread=False)

from gevent.pywsgi import WSGIServer

from tornado.wsgi import WSGIApplication
import tornado.web
import tornado.wsgi

import requests

class MainHandler(tornado.web.RequestHandler):
    def get(self):
        requests.get('http://google.com')
        self.write('hello')

handlers = [
    (r'/', MainHandler)
]

if __name__ == '__main__':
    application = WSGIApplication(handlers)
    server = WSGIServer(('', 9010), application)
    server.serve_forever() 
```

我使用 apache benchmark 来测试性能。测试命令是

`ab -n 1000 -c 100 http://127.0.0.1:9010/`

这导致每秒 100req，太慢了。在上面的代码中，我只是向对方发送了一个http请求，我认为在这种情况下，gevent会在阻塞时切换到其他greenlet，它应该对性能影响不大，但是gevent的性能从每秒1600req下降到每秒100 req 每秒，我不知道为什么。

谁能解释一下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:36:09.980

嗨，您的问题是您没有生成实际的 greenlet，并且 tornado.web.ascynhronous 装饰器不支持 WSGI 服务器。

但是主要逻辑是有效的，我能够让它与 HTTP 服务器一起工作（我不知道你是否绑定到 WSGI 服务器，但我想不是，因为你也可以反向代理）。

我发现很多人想在 tornado 中使用 gevent，包括我（我们在 FriendCode 使用 tornado 和[gevent](http://friendco.de)），所以我写了这个：

```
# Gevent monkeypath
from gevent import monkey
monkey.patch_all()

# Gevent imports
import gevent

# Python immports
import functools

# Tornado imports
import tornado.ioloop
import tornado.web
import tornado.httpserver

# Request imports
import requests

# Asynchronous gevent decorator
def gasync(func):
    @tornado.web.asynchronous
    @functools.wraps(func)
    def f(self, *args, **kwargs):
        #self._auto_finish = False
        return gevent.spawn(func, self, *args, **kwargs)
    return f

# Constants
URL_TO_FETCH = 'http://google.co.uk/'

# Global
I = 0

class MainHandler(tornado.web.RequestHandler):
    @gasync
    def get(self):
        global I
        r = requests.get(URL_TO_FETCH)
        I += 1
        print('Got page %d (length=%d)' % (I, len(r.content)))
        self.write("Done")
        self.finish()

# Our URL Mappings
handlers = [
   (r"/", MainHandler),
]

def main():
    # Setup app and HTTP server
    application = tornado.web.Application(handlers)
    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(9998)

    # Start ioloop
    tornado.ioloop.IOLoop.instance().start()

if __name__ == "__main__":
    main() 
```

在这个示例中，有两个关键部分，你做对的猴子补丁部分，然后是我写的**gasync**装饰器，它所做的只是将一个方法设置为异步（按照 tornado 的术语，这意味着该方法必须调用 self .finish() 本身将响应发送给客户端，因为当请求是同步的时，tornado 会自动调用它，但这不是您想要的异步）。

我希望这会有所帮助，代码在这里运行良好，我已经使用以下方法对其进行了测试：

```
$ ab -n 100 -c 100 http://localhost:9998/ 
```

这使 ：

```
This is ApacheBench, Version 2.3 <$Revision: 655654 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient).....done

Server Software:        TornadoServer/2.3
Server Hostname:        localhost
Server Port:            9998

Document Path:          /
Document Length:        4 bytes

Concurrency Level:      100
Time taken for tests:   0.754 seconds
Complete requests:      100
Failed requests:        0
Write errors:           0
Total transferred:      15900 bytes
HTML transferred:       400 bytes
Requests per second:    132.67 [#/sec] (mean)
Time per request:       753.773 [ms] (mean)
Time per request:       7.538 [ms] (mean, across all concurrent requests)
Transfer rate:          20.60 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        2    4   0.8      4       5
Processing:   379  572 104.4    593     748
Waiting:      379  572 104.4    593     748
Total:        383  576 104.3    596     752

Percentage of the requests served within a certain time (ms)
  50%    596
  66%    640
  75%    672
  80%    679
  90%    707
  95%    722
  98%    735
  99%    752
 100%    752 (longest request) 
```

如您所见，总时间大致等于最长请求的时间，请记住，当 async 时：

```
total_time = max(all_individual_times) + n*some_overhead 
```

其中**n**是请求数，而**some_overhead**是恒定开销。

希望有帮助:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-21T13:36:10.017

我有同样的需求，但我正在使用期货和 gen.coroutine，所以我不得不稍微修改它以与我的代码兼容，如果其他人也需要它，我会把它放在这里：

```
#
# encoding: utf-8

from gevent import monkey
monkey.patch_all()

# Gevent imports
import gevent

# Python immports
import functools

# Tornado imports
import tornado.ioloop
import tornado.web
import tornado.gen
import tornado.httpserver

# Request imports
import requests
from tornado.concurrent import Future

# Asynchronous gevent decorator
def gfuture(func):
    @functools.wraps(func)
    def f(*args, **kwargs):
        loop = tornado.ioloop.IOLoop.current()
        future = Future()

        def call_method():
            try:
                result = func(*args, **kwargs)
                loop.add_callback(functools.partial(future.set_result, result))
            except Exception, e:
                loop.add_callback(functools.partial(future.set_exception, e))
        gevent.spawn(call_method)
        return future
    return f

# Constants
URL_TO_FETCH = 'http://google.com/'

# Global
I = 0

@gfuture
def gfetch(url, i):
    r = requests.get(url)
    return i

class MainHandler(tornado.web.RequestHandler):
    @tornado.web.asynchronous
    @tornado.gen.coroutine
    def get(self):
        global I
        I += 1
        n = I
        print "=> %s" % n
        n = yield gfetch(URL_TO_FETCH, n)
        print "<= %s" % n
        self.write("Done %s" % n)

# Our URL Mappings
handlers = [(r"/", MainHandler)]

def main():
    # Setup app and HTTP server
    application = tornado.web.Application(handlers)
    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(9998)

    # Start ioloop
    tornado.ioloop.IOLoop.instance().start()

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T21:08:51.307

尝试`requests`仅使用 gevent 示例应用程序测试包，以检查它是否真正异步。也许原因是 gevent 没有正确修补所需的所有内容`requests`

但我认为您的解决方案与 gevent 站点不是异步的：您正在尝试运行 2 个事件循环。我猜您提出的过程如下所示：

*   Tornado IOLoop 等待事件（用于 http 服务器）
*   处理 HTTP 请求
*   处理程序 run`get`方法，它运行 gevent 事件循环（gevent 在专用的 greenlet 中隐式启动事件循环）
*   gevent 的事件循环阻塞了*Tornado* greenlet（*gevent 的事件循环所在的 greenlet 的父级）*
*   请求的greenlet等待完成
*   request的greenlet完成，gevent的事件循环关闭，end Tornado IOLoop被释放。

还要看看 Tornado 和 greenlets 的一些成功组合：[tornalet](https://github.com/Gawen/tornalet)、[Motor](http://emptysquare.net/motor/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-06T18:37:26.330

Tornado (Twisted) 和 gevent 做同样的事情，为了获得最佳结果，您应该保持在相同的技术堆栈中，而不是将两者混为一谈。要么使用带有 gevent 的 WSGI Web 框架，比如瓶子或烧瓶，要么一起使用扭曲和龙卷风。

# report - 如何在报表中按表格显示方式分组？

> ID：13292409
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:04.257
> 
> 标签：report, axapta

我有一张表 CustInvoiceJour。我使用报表通过对报表查询中的一些字段（销售价格、销售单位）进行分组来打印一些信息。报表打印 sum(LineDisc)、sum(LineAmount) 值。

我想修改报告，按字段再添加一个组-但该字段是显示方法。Axapta 3.0 仅支持物理字段分组。

最快的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T07:52:08.923

*版本 1*：您可以使用 Map 类 (Types::Container, Types::Container) 手动对数据进行分组，并使用 MapItertor 将它们发送到报告。

*版本 2*：您可以将数据插入临时表并使用此表中的“select ... groupby”将数据发送到报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:52:15.687

抱歉，Axapta 3.0 不支持按显示方法分组，任何其他版本的 AX 也不支持。

AX 2012 支持将[计算域](http://msdn.microsoft.com/en-us/library/gg845841.aspx)添加到[视图](http://msdn.microsoft.com/EN-US/library/bb314551.aspx)中，这将在该版本中节省您的时间。

在所有其他版本中，您必须拥有一个真实字段，然后在插入或更新时计算该字段。对于`CustInvoiceJour`表格，您只需要更改`insert`方法，因为表格永远不会更新。

# php - 保存和加载页面的ajax状态

> ID：13292410
> 
> 赞同：0
> 
> 时间：2012-11-08T15:45:06.277
> 
> 标签：php, javascript, jquery, ajax

我正在研究 Wordpress 单页投资组合上的 ajax 加载功能。

其原理是，当您单击图库中的缩略图时，它会打开一个容器（#DrawerContainer）并将本文的ajax 内容提取到其中。在很多帮助下，我已经能够在单击缩略图时打开抽屉并加载帖子内容。

如果您想看到它工作，这是一个小提琴（ajax 不会加载，但它在本地工作）。[http://jsfiddle.net/RF6df/24/](http://jsfiddle.net/RF6df/24/)

**我现在正在处理的部分：**我需要我的网站是可抓取的，并且网址是可共享的。如果我给`http://mywebsite.com/#!project5`某人，我需要在他加载页面时打开 project5 内容。
我认为 hash-bang (#!) url 是完成这项工作的方法。使用下面的代码（在 jsfiddle 上评论），我可以更新 url 并添加点击缩略图的哈希值。

```
var pathname = $(this).find('a')[0].href.split('/'),
            l = pathname.length;
        pathname = pathname[l-1] || pathname[l-2];
        window.location.hash = "#!" + pathname; 
```

但是当我加载页面时，不会记住 ajax 状态。我认为这是因为我的 ajax 容器仅在单击事件时加载，但是当我在 php.ini 中添加持久性容器时没有任何变化。

有没有办法加载已经显示帖子内容的页面，或者在页面加载 hash-bang url 时打开#DrawerContainer？

请记住，我只是在学习 jquery 和 ajax。因此，如果您解释或评论一下您的工作，我将非常感激，我一定会同时学习... :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:48:27.387

在 onload 上，您应该检查 window.location.hash 并触发对特定链接/div 的点击。

```
$(document).ready(function() {
    var hash = window.location.hash;
    if ( hash.length > 0 ) {
        hash = hash.replace('#' , '' , hash );
        $('a[rel="'+hash+'"]').trigger('click');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:59:37.810

我在想要通过哈希更改触发的网站上使用了以下内容。

首先我绑定一个 hashchange 事件来获取哈希值

```
 $(window).bind('hashchange', function(o){

            url = window.location.hash.substring(1);

            o.preventDefault();

        if (!url) {
            return;
        }

 } 
```

然后我在需要时触发 hashchange - 在您的情况下，当页面加载时，即文档准备就绪。

```
jQuery(document).ready(function($) {
   $(window).trigger('hashchange');
}); 
```

然后，您可以在加载正确内容的函数中使用哈希值

# ruby-on-rails - 如何访问由 ruby on rails rvm install 生成的 sqlite3 表

> ID：13292413
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:13.387
> 
> 标签：ruby-on-rails, ruby, sqlite

我通过阅读“agile web development with rails”一书来学习 ruby​​ on rails。我使用 rvm 安装了 ruby​​ 和 rails。我使用的是默认的 sqlite3 数据库，生成模型和表非常棒。

我想手动浏览我的数据库，只是为了查看结构。

所以在命令行运行

```
sqlite3 
```

并在外壳中

```
.tables 
```

什么都没有出现...我的桌子在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:47:09.383

你想跑

```
rails dbconsole 
```

或者

```
rails db 
```

因为它将加载您的数据库等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T20:26:48.383

为了更清楚起见，“.tables”没有返回的原因是因为您没有加载数据库。以这种方式启动 sqlite3：

sqlite3 pathToDatabase/databaseFileName

# drupal - Drupal 7，只有登录的访问者才能下载

> ID：13292415
> 
> 赞同：2
> 
> 时间：2012-11-08T15:45:18.187
> 
> 标签：drupal, drupal-7, drupal-files

我有一个 Drupal 7 站点，该站点具有块中的可下载资源（PDF 文件），需要对所有访问者可见，但仅可供登录访问者下载。我怎样才能做到这一点？

任何建议都非常感谢。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T11:41:40.677

考虑使用`Private files`你的文件字段，让 Drupal 处理所有这些。

这是[在 Drupal 7 中处理文件的](http://drupal.org/documentation/modules/file)方法。这应该使您走上正确的轨道。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T06:10:13.337

```
 <?php
   global $user;
   if($user->uid != "") {
           $path = "/sites/default/files/example.pdf";
   } else {
           $path ="#";
   }
   ?>
   <p><a href="<?php echo $path ?>"><span style="font-size: small;"><span style="font-family: Arial;"><span style="color: rgb(255, 153, 0);">Example.pdf</span></span></span></a></p> 
```

希望这可以帮助

# c# - 无代理消息传递 C#

> ID：13292420
> 
> 赞同：3
> 
> 时间：2012-11-08T15:45:25.490
> 
> 标签：c#, c#-4.0, messaging, zeromq, pnrp

我在同一个公司网络上有许多 WPF 客户端。我希望这些客户端彼此共享消息。我不想运行单独的服务器进程，因此无代理解决方案似乎是最好的。我考虑过使用 PNRP，但这似乎需要在每个客户端上运行 PNRP 服务，我不确定我能否保证所有客户端都会或可能运行它。我还查看了 ZeroMq，它看起来很简单，而且非常轻量级，但是我需要知道 TCP/IP 风格通信的端点，并且每个客户端都不会知道其他客户端，而是他们需要以某种方式去发现彼此。

所以我想问题是有没有我认为不符合要求的选项？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T04:59:27.117

ZeroMQ pub-sub 模式简单快捷，直到您接触到数百个客户端；您可以切换到真正的多播协议（PGM），而无需修改您的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T15:56:13.167

也许您应该查看[NServiceBus](http://www.nservicebus.com/)。它是真正的服务总线，因此中间没有代理机器。它在 MSMQ 上运行，因此您的 Windows 服务器将立即支持它。它还支持事务消息传递。它还支持应该满足您的多播要求的发布/订阅模型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T20:00:58.617

如果您不介意使用商业产品：[OMG 的数据分发服务](http://en.wikipedia.org/wiki/Data_distribution_service)是一个标准，具有多种实现，可以满足您的需求。[其中至少有一个](http://www.rti.com/products/dds/index.html)支持 C#，并且不需要在你的机器上安装任何东西——只需要库。披露：我在这家公司工作。

> 所以本质上我想要一种多播的通信方式，但不必使用多播，因为这将需要我在公司网络中设置一系列地址并涉及基础设施等。

默认情况下，DDS 使用 UDP/IP over 多播进行发现和通信，但可以通过编程或配置文件指示仅使用 UDP over unicast 或 TCP。这不会影响应用程序逻辑，因此保留了概念多播性质。但是，如果您没有可用的 IP 多播，那么您将失去一些开箱即用的自动发现功能。在这种情况下，您需要提前知道可能参与通信的所有节点的 IP 地址或主机名。从那里，中间件将能够发现其中谁*实际*存在并相应地调整其通信。

我认为后者对于您选择的任何解决方案都是正确的。对于全自动发现，您将需要多播/广播，或在您的系统中运行一些已知的发现服务器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-28T11:05:41.667

我们基于 ZeroMQ（传输）、Cassandra（对等发现和持久性）和 Protobuf（序列化）编写了对等消息总线 Zebus。

它是开源和生产测试的[https://github.com/Abc-Arbitrage/Zebus](https://github.com/Abc-Arbitrage/Zebus)

Zebus 正在积极开发中，并在大量内部生产中使用。目前只有 .NET 语言绑定，但正如 OP 提到的，他只有 WCF 客户端，这应该可以满足他的需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-08T16:01:16.433

您是否考虑过 WCF 的点对点协议？有关详细信息，请参见此处：http: [//msdn.microsoft.com/en-us/library/cc297274.aspx](http://msdn.microsoft.com/en-us/library/cc297274.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-17T21:29:42.350

ZeroMQ 是一个不错的选择。为了解决发现问题，站一个服务器，每个客户端在启动和停止时都会检查。该服务器也可以作为发布者和订阅者运行 ZeroMQ。

客户端发布到服务器上的一个端口，该端口将订阅者绑定到该端口以获取签入和签出消息。服务器反过来将这些消息发布到客户端订阅的另一个端口（它也绑定）上。

# python - 如何通过列表创建类的实例

> ID：13292422
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:27.250
> 
> 标签：python

我正在开发一个 python 项目，其中已经创建了一堆类。我将要求用户输入要执行的类（即类的名称，其列表将显示给他）。

在他选择一个选项后，我想创建一个用户请求的类的实例并显示适当的输出。

剧情是这样的……

```
"""
My Class definitions go up here...
"""

classList = {'a':'AClass','b':'BClass','c':'CClass'}
for i in iter(classList):
   print i
x = raw_input('Enter class name: ') 'Get the user input and store it.'
"""
I'm stuck here.
Have to create an instance for the requested class.
i.e., have to create an instance to AClass if the user entered a (classList[a])
""" 
```

一个过程，我知道，但模糊的是使用 switch case 或 if-else 来检查该输入并为相应的类创建实例。但是，我是 python 新手，所以我想知道是否有任何其他方式可以以更优雅的方式实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:47:57.620

您可以存储类本身，而不是将类*名*存储在 中：`classList`

```
class AClass(object): pass
class BClass(object): pass
class CClass(object): pass

classList = {'a':AClass, 'b':BClass, 'c':CClass} 
```

这样，实例化其名称存储在其中的类`x`就像

```
obj = classList[x]() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:48:04.493

你有一个不错的开始，但你需要记住你可以通过课程。所以这会起作用：

```
class A(): pass

class B(): pass

map = {'a': A, 'b': B}

instance = map['a']() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:11:00.377

如果您仍想从字符串创建类实例，那么这里是我的 vanilla 函数：

```
def get_object_type(classname, modulename):
    __import__(modulename)
    return getattr(sys.modules[modulename], classname)

def get_object_instance(classname, modulename, param={}):
    return get_object_type(classname, modulename)(**param)

new_instance = get_object_instance("ClassA", "modulename") 
```

# c - C - 获取令牌信息时缓冲打印垃圾字符

> ID：13292424
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:45.097
> 
> 标签：c

我有以下用 C 编写的代码片段，它应该检索有关程序权限的令牌信息：

```
char buffer[1000]; //Declaring the buffer where the token information will be stored
int size = sizeof(buffer); //Storing the size of the buffer
DWORD required_size; //A variable storing return information from the GetTokenInformation() method

HANDLE process = OpenProcess(SYNCHRONIZE, FALSE, GetCurrentProcessId()); //Opening the current process
HANDLE token; //Creating a handle for the token
OpenProcessToken(process, TOKEN_ADJUST_PRIVILEGES, &token); //Opening the process token

GetTokenInformation(token, TokenPrivileges, buffer, size, &required_size); //Obtaining the token information
printf("The following information was obtained with regards to the token privileges: \n\n");
printf("%s\n\n", buffer); 
```

主要问题是当我尝试打印“缓冲区”的内容时，屏幕上只打印垃圾信息：s 请问我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:48:40.617

它正在打印垃圾，因为您没有的数据不是 C 字符串，它只是原始二进制数据。在 的情况下`TokenPrivileges`，数据实际上是一个[`TOKEN_PRIVILEGES`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379630%28v=vs.85%29.aspx)结构。

因此，您应该将字节缓冲区转换为指向`TOKEN_PRIVILEGES`结构的指针。请注意，它以一个*灵活的数组成员*结尾——该`Privileges`数组将包含可变数量的数组元素，这就是为什么您必须查询总大小并使用足够大的字节缓冲区而不是仅仅`TOKEN_PRIVILEGES`在堆栈上分配 a ' 不够大，无法容纳多个条目。

# php - 如果选择了下拉菜单中的值，则显示输入框

> ID：13292425
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:44.987
> 
> 标签：php, javascript, forms

我正在处理一个简单的 php 联系表单，并努力在下拉列表中选择“其他”选项以在选择时显示文本字段选项。表单包含在页面上`<?php require_once('includes/contact_form.php'); ?>`，页脚也是一个包含（页脚是我添加 JS 的位置）。

但这只是行不通...

## 这是表格：

```
<label>How did you hear about us?</label>
<select name="how" class="selectfield" id="how">
  <option value="">Please Select...</option>
  <option value="Advertisement">Advertisement</option>
  <option value="Care at Home Today">Care at Home Today</option>
  <option value="Email-Newsletter">Email/Newsletter</option>
  <option value="Facebook">Facebook</option>
  <option value="Family-Friend">Family or Friend</option>
  <option value="Magazine">Magazine Article</option>
  <option value="Twitter">Twitter</option>
  <option value="Website-Search Engine">Website/Search Engine</option>
  <option value="Other">Other</option>
</select>
<input type='text' id="other" class="hidden" />

<input name="contactus" type="submit" class="submit" id="contactus" value="Submit" />
</form> 
```

## 这是JS

```
$('#how').change(function(){
    var selected_item = $(this).val()
    if(selected_item == "other"){
        $('#other').val("").removeClass('hidden');
    }else{
        $('#other').val(selected_item).addClass('hidden');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:48:29.643

尝试：

```
$('#how').change(function(){
var selected_item = $(this).val()
if(selected_item == "Other"){ // 'Other' 
    $('#other').val('').show(); //show textbox if Other is selected
}else{
    $('#other').hide(); //Hide textbox if anything else is selected
}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:53:13.517

您的问题在于您的字符串比较，它应该是：

```
 if(selected_item == "Other"){ 
```

带大写`O`，经过**测试**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T15:53:50.327

不确定这是否是问题中的拼写错误，但您的下拉值是“其他”，并且在您的 js 中您正在测试“其他”。所以存在不匹配。可能是你的问题

这是您示例的一个工作小提琴，只是在您的 if 语句中将“其他”更改为“其他”。

[演示](http://jsfiddle.net/yUhtj/)

正如 coder1984 所建议的那样，只需在 if 语句中使用 jquery`.show()`和`.hide()`也可以。

```
if(selected_item == "Other"){
    $('#other').val("").show()
}else{
    $('#other').val(selected_item).hide()
} 
```

# c# - 使用 C# 的流发送 API

> ID：13292426
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:48.200
> 
> 标签：c#, api, streamreader

我似乎无法使用此代码`Streamsends API`。我一直在互联网上，发现与我正在尝试做的事情有关的信息很少。我正在尝试将文件上传到他们的服务器。任何人都可以看看这个，也许可以帮助我吗？

我不断从 Streamsends 服务器收到 500 错误，他们说这是在 Streamsend 应用程序本身中。有趣的是，如果我在注释掉的底部附近取线

( `//request.ContentType = "multipart/form-data";`)

并取消注释我收到一个 422 错误，表示数据无效。边界好像有问题。

我对 C# 相当陌生，这是我第一次使用 Streamsends API，因此将不胜感激。

```
m_Method = "POST"
m_Action = "uploads"
private string StreamSendResponse(string Path, string FileName)
    {
        string sReturn = String.Empty;
        string sLocation = String.Empty;

        string boundary = "---------------------------" + DateTime.Now.Ticks.ToString("x");
        byte[] boundarybytes = Encoding.ASCII.GetBytes(Environment.NewLine + "--" + boundary + Environment.NewLine);

        Uri addy = new Uri(m_URI + m_Action);

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(addy);
        request.ContentType = "multipart/form-data; boundary=" + boundary;           

        request.Method = m_Method;

        request.KeepAlive = true;
        request.Headers.Add("Authorization", "Basic " + Merv.base64Encode(m_ID + ":" + m_Key));

        Stream rs = request.GetRequestStream();

        string formdataTemplate = "Content-Disposition: form-data; name=\"{0}\"\r\n{1}";
        NameValueCollection nvc = new NameValueCollection();

        foreach (string key in nvc.Keys)
        {
            rs.Write(boundarybytes, 0, boundarybytes.Length);
            string formitem = string.Format(formdataTemplate, key, nvc[key]);
            byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
            rs.Write(formitembytes, 0, formitembytes.Length);
        }

        rs.Write(boundarybytes, 0, boundarybytes.Length);

        string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\n Content-Type: application/octet-stream\r\n";

        string header = string.Format(headerTemplate, "data", FileName);

        byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
        rs.Write(headerbytes, 0, headerbytes.Length);

        FileStream fileStream = new FileStream(Path + FileName, FileMode.Open, FileAccess.Read);
        byte[] buffer = new byte[4096];
        int bytesRead = 0;
        while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
        {
            rs.Write(buffer, 0, bytesRead);
        }
        fileStream.Close();

        byte[] trailer = System.Text.Encoding.ASCII.GetBytes(Environment.NewLine + "--" + boundary + "--" + Environment.NewLine);

        rs.Write(trailer, 0, trailer.Length);
        rs.Close();

        request.Accept = "application/xml";
        //request.ContentType = "multipart/form-data";

        try
        {
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            StreamReader srResponse = new StreamReader(response.GetResponseStream());
            sLocation = response.Headers["Location"];
            sReturn = srResponse.ReadToEnd().Trim();
        }
        catch (WebException exc)
        {

            StreamReader srResponse = new StreamReader(response.GetResponseStream());
            sReturn = srResponse.ReadToEnd().Trim();
            sLocation = exc.Message;
        }
        if (sReturn == String.Empty)
        {
            sReturn = sLocation;
        }

        return sReturn;
    } 
```

# ios - 智能卡 - 通用验证命令 6A 80

> ID：13292428
> 
> 赞同：3
> 
> 时间：2012-11-08T15:45:49.947
> 
> 标签：ios, cryptography, smartcard

我们试图与 iphone 上的 PIV 智能卡进行交互。我们已经加载了必要的库并可以发送命令。使用获取数据和获取响应命令的组合，我们能够从智能卡中检索所有相关证书。我们现在正在尝试发送通用身份验证命令来签署一些数据但接收 6A80 。我们正在链接这个命令。链的第一部分成功执行，返回码为 90 00，但第二个命令给出 6a80。

我们的卡片描述说

1.  带有 SHA-256 签名的 RSA PKCS #1 v 1.5
2.  RSA 2048 位密钥

我们使用 SHA1 256 对数据进行哈希处理，并使用 pkcs v 1.5 padding 对其进行填充。我们还使用 DER 编码对哈希进行了编码。但无论哪种方式（有或没有 der 编码）我们都会收到 6a80 错误。这是我们的代码，

```
// gets data signed from the smart card
-(void) signData:(unsigned char *)origdata:(int) origdatalen:(int) key_reference :(int)        key_size:(int) hash_reference
{
    bool debug=false;
    unsigned char * encodedandpadded;
unsigned char * digest;
NSMutableString* cplc = [[NSMutableString alloc]init];
int derHeaderLen=0;
int keyModulo=0;
int digestLen=0;
if (key_size==2048){
    keyModulo=256;
} else if (key_size==1024){
    keyModulo=128;
}
unsigned char * derHeader=nil;

switch (hash_reference){

    case SHA1:
        derHeaderLen=15;
        derHeader=(unsigned char *) calloc(derHeaderLen,sizeof(unsigned char));
        derHeader[0]=0x30;
        derHeader[1]=0x21;
        derHeader[2]=0x30;
        derHeader[3]=0x09;
        derHeader[4]=0x06;
        derHeader[5]=0x05;
        derHeader[6]=0x2b;
        derHeader[7]=0x0e;
        derHeader[8]=0x03;
        derHeader[9]=0x02;
        derHeader[10]=0x1a;
        derHeader[11]=0x05;
        derHeader[12]=0x00;
        derHeader[13]=0x04;
        derHeader[14]=0x14;
        digestLen=CC_SHA1_DIGEST_LENGTH;
        digest = (unsigned char*) calloc(digestLen,sizeof(unsigned char));
        CC_SHA1(origdata, origdatalen,digest);

        break;
    case SHA256:
        derHeaderLen=19;
        derHeader=(unsigned char *) calloc(derHeaderLen,sizeof(unsigned char));
        derHeader[0]=0x30;
        derHeader[1]=0x31;
        derHeader[2]=0x30;
        derHeader[3]=0x09;
        derHeader[4]=0x06;
        derHeader[5]=0x09;
        derHeader[6]=0x60;
        derHeader[7]=0x86;
        derHeader[8]=0x48;
        derHeader[9]=0x01;
        derHeader[10]=0x65;
        derHeader[11]=0x03;
        derHeader[12]=0x04;
        derHeader[13]=0x02;
        derHeader[14]=0x01;
        derHeader[15]=0x05;
        derHeader[16]=0x00;
        derHeader[17]=0x04;
        derHeader[18]=0x20;
        digestLen=CC_SHA256_DIGEST_LENGTH;
        digest = (unsigned char*) calloc(digestLen,sizeof(unsigned char));
        CC_SHA256(origdata, origdatalen,digest);

        break;
    case SHA512:
        derHeaderLen=19;
        derHeader=(unsigned char *) calloc(derHeaderLen,sizeof(unsigned char));
        derHeader[0]=0x30;
        derHeader[1]=0x51;
        derHeader[2]=0x30;
        derHeader[3]=0x09;
        derHeader[4]=0x06;
        derHeader[5]=0x09;
        derHeader[6]=0x60;
        derHeader[7]=0x86;
        derHeader[8]=0x48;
        derHeader[9]=0x01;
        derHeader[10]=0x65;
        derHeader[11]=0x03;
        derHeader[12]=0x04;
        derHeader[13]=0x02;
        derHeader[14]=0x03;
        derHeader[15]=0x05;
        derHeader[16]=0x00;
        derHeader[17]=0x04;
        derHeader[18]=0x40;

        break;
    default:

        break;

}

   // {0x00, 0x01, PS, 0x00, T},
   bool derEncoding=true;
int psLen;
int finalLen;
if (derEncoding){
    psLen=keyModulo-3-(derHeaderLen+digestLen);
    finalLen=3+psLen+derHeaderLen+digestLen;

} else {
   psLen=keyModulo-3-(digestLen);
   finalLen=3+psLen+digestLen;
}
    encodedandpadded =(unsigned char *) calloc(finalLen,sizeof(unsigned char));
    int count=0;
    encodedandpadded[count++]=0x00;
    encodedandpadded[count++]=0x01;
   for (int i=0;i<psLen;i++){
       encodedandpadded[count++]=0xFF;
   }
   encodedandpadded[count++]=0x00;
   if (derEncoding) {
    for (int i=0;i<derHeaderLen;i++){
        encodedandpadded[count++]=derHeader[i];
    }
}

for (int i=0;i<digestLen;i++){
    encodedandpadded[count++]=digest[i];
}

if (debug){
     [cplc appendString:[NSString stringWithFormat:@" psLen=%d derHeaderLen=%d digestlent=%d finalLen=%d count=%d",psLen,derHeaderLen,digestLen,finalLen,count]];
    for (int i=0;i<finalLen;i++){
         [cplc appendString:[NSString stringWithFormat:@" %02x ",encodedandpadded[i]]];
    }
    [self printData:cplc];
}

[self generalAuthenticate:encodedandpadded :256];

}   

- (void) generalAuthenticate:(unsigned char *) paddeddata:(int) paddeddatalen{

bool debug=true;

PBSmartcardStatus result;

// the first command in the chain , we will send first 128 bytes in this command
unsigned char dat[] = {0x10, 0x87, 0x07, 0x9C};
NSMutableData * prepCommand1 = [[NSMutableData alloc] initWithBytes:dat length:4];
unsigned char dat2[] = {0x86,0x7C,0x84};
[prepCommand1 appendBytes:dat2 length:3];
unsigned char dat3[] = {0x82,0x00,0x81,0x80};
[prepCommand1 appendBytes:dat3 length:4];

unsigned char * part1 =(unsigned char *) calloc((paddeddatalen/2),sizeof(unsigned char));
unsigned char * part2=(unsigned char *) calloc((paddeddatalen/2),sizeof(unsigned char));
int count=0;
for(int i=0;i<(paddeddatalen/2);i++){
    part1[i]=paddeddata[count++];
}

[prepCommand1 appendBytes:part1 length:(paddeddatalen/2)];
for(int i=0;i<(paddeddatalen/2);i++){
    part2[i]=paddeddata[count++];
}
//the second command in the chain, we will send rest of 128 bytes in this command
unsigned char dat4[]={0x00, 0x87, 0x07, 0x9C, 0x80};
NSMutableData * prepCommand2 = [[NSMutableData alloc] initWithBytes:dat4 length:5];

[prepCommand2 appendBytes:part2 length:(paddeddatalen/2)];

unsigned char dat5[]={0x00};
[prepCommand2 appendBytes:dat5 length:1];

//unsigned char get_cplc_command[] = {0x10, 0x87, 0x07, 0x9C,(macOut.length+4),0x82,0x00,0x81,macOut.length};

NSMutableString* cplc = [[NSMutableString alloc]init];

unsigned char received_data[255] = {0};
unsigned short received_data_length;

// on input received_data_length holds the size of the receive buffer.
received_data_length = sizeof(received_data);
unsigned char * prepCmd1=(unsigned char *)[prepCommand1 bytes];
int prepCmd1Len=[prepCommand1 length];
// send the command APDU and get the response from the card.
if (debug){
    [cplc appendString:[NSString stringWithFormat:@"Length %d %d",prepCmd1Len,(paddeddatalen/2), count]];
    [self printData:cplc];
    for (int i=0;i<prepCmd1Len;i++){
            [cplc appendString:[NSString stringWithFormat:@"%02x",prepCmd1[i]]];
    }
    [self printData:cplc];

}
result = [smartcard transmit:prepCmd1
           withCommandLength:prepCmd1Len

           andResponseBuffer:received_data
           andResponseLength:&received_data_length];

LOG(@"transmit = %d", result);

// check if the command was succefully sent to the card
//    if(result != PBSmartcardStatusSuccess)
//    {
//        goto done;
//    }
if (debug){
[cplc appendString:[NSString stringWithFormat:@"Response bytes from card for general authenticate command %02X %02X length %d\n",received_data[received_data_length-2],received_data[received_data_length-1],received_data_length]];
[self printData:cplc];
}

unsigned char received_data_2[300] = {0};
unsigned short received_data_length_2;

// on input received_data_length holds the size of the receive buffer.
received_data_length_2 = sizeof(received_data_2);
unsigned char * prepCmd2=(unsigned char *)[prepCommand2 bytes];
int prepCmd2Len=[prepCommand2 length];
// send the command APDU and get the response from the card.
if (debug){
    [cplc appendString:[NSString stringWithFormat:@"Length %d",prepCmd2Len]];
    [self printData:cplc];
    for (int i=0;i<prepCmd2Len;i++){
        [cplc appendString:[NSString stringWithFormat:@"%02x",prepCmd2[i]]];
    }
    [self printData:cplc];

}
result = [smartcard transmit:prepCmd2
           withCommandLength:prepCmd2Len

           andResponseBuffer:received_data_2
           andResponseLength:&received_data_length_2];

if (debug){
    [cplc appendString:[NSString stringWithFormat:@"Response bytes from card for general authenticate command %02X %02X length %d\n",received_data_2[received_data_length_2-2],received_data_2[received_data_length_2-1],received_data_length_2]];
    [self printData:cplc];
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:24:57.693

仅发送命令数据字段中的哈希值，而不是 PKCS#1 填充的哈希值。卡可能会在签名操作中进行填充。

# java - 测试 MySql 数据库中字符串的编码和正确性

> ID：13292429
> 
> 赞同：1
> 
> 时间：2012-11-08T15:45:50.793
> 
> 标签：java, mysql, database, utf-8, character-encoding

我正在使用适用于 Linux (x86_64) 的 mysql 数据库 Ver 14.14 Distrib 5.5.21。我使用 java 类中的准备好的语句将字符串保存到这个数据库中。

现在我想确保我保存的所有字符串都是 UTF-8 格式并且不包含损坏的（如数据库创建模式中定义的）字符。因为字符串已经损坏，因此包含问题标签而不是应该存在的字符。就我而言，显示的是“R��ckenschmerzen”而不是“Rückenschmerzen”。德语字符“ü”被破坏了。是否可以通过 JUnit 测试找到此类错误？

任何帮助，将不胜感激。先感谢您。贺拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:03:07.817

默认情况下，MySql 数据库配置为使用`latin1`字符集，但您可以在`my.ini`

```
# The default character set that will be used when a new schema or table is
# created and no character set is defined
#default-character-set=latin1

default-character-set=utf8 
```

默认情况下使用`utf8_general_ci`排序规则，但还有其他排序规则，总共支持“650 种语言”，请查看手册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:55:00.660

@Roman：非常感谢您提供的信息，Roman。但我想我问错了问题。正确的问题应该是： **如何检查字符串是否为有效的 UTF-8 格式（使用 java）？**

因为我认为如果您将数据库设置为 UTF-8，然后错误地对另一种编码的字符串进行写入操作，*它仍然会被保存（将替换代码 U+FFFD � 用于最终未知字符）*。

所以我的解决方案是检查数据库中的字符串是否包含`U+FFFD or �.`

或者另一种预防性解决方案是在我将字符串保存到数据库之前确保字符串中的字符都是 utf-8 格式，例如：

```
 String myString = "blablabla";
    String finalStringToBeInserted = new String(myString.getBytes(), "UTF-8");
    saveToDatabase(finalStringToBeInserted); 
```

问候，贺拉斯

# c++ - 处理 C 库对象时如何实现 std::move()

> ID：13292432
> 
> 赞同：2
> 
> 时间：2012-11-08T15:45:56.550
> 
> 标签：c++, c++11, move-semantics

假设我们有以下代码

```
class Image
{
public:
    Image(const std::string & path)
    {
        pBitmap_ = FreeImage_Load( imageFormat, pathname.c_str() );
    }
    ~Image()
    {
        FreeImage_Unload(pBitmap_);
    }
private:
    FIBITMAP * pBitmap_;

}; 
```

Image(Image && rhs) 将如何实现？移动 dtor 后仍然在 rhs 上调用，这不会产生预期的效果？我想像

```
Image::Image( Image && rhs )
{
    pBitmap_ = std::move(rhs.pBitmap_);
            rhs.pBitmap_ = nullptr;
} 
```

然后在 dtor 中检查 null 应该可以解决问题，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T15:58:57.650

解决方案是*不要自己做*，而是使用语言的库设施：

```
struct FiBitmapDeleter {
    void operator()(FIBITMAP *pBitmap) { FreeImage_Unload(pBitmap); }
};

class Image {
private:
    std::unique_ptr<FIBITMAP, FiBitmapDeleter> pBitmap_;
}; 
```

现在您不需要编写析构函数、移动构造函数或移动赋值运算符。此外，您的类会自动删除其复制构造函数和复制赋值运算符，因此您也无需担心这些，完成五法则。

另一种方法是 specialize `default_delete`，这意味着您不需要将删除器类型提供给`unique_ptr`：

```
namespace std {
    template<> struct default_delete<FIBITMAP> {
        void operator()(FIBITMAP *pBitmap) { FreeImage_Unload(pBitmap); }
    };
}
std::unique_ptr<FIBITMAP> pBitmap_; 
```

这具有全局影响，因此只有当您确信您的代码是程序中唯一可能执行此专业化的代码时，您才应该这样做。

# grails - 在gsp中将groovy列表输出为逗号分隔的字符串

> ID：13292439
> 
> 赞同：2
> 
> 时间：2012-11-08T15:46:11.253
> 
> 标签：grails, groovy, gsp

我的控制器中有以下内容：

```
render(view: "create", model: [dealInstance: dealInstance, storeName: params.storeName, location: params.location, openEmailClient: true, emailTo: users*.email]) 
```

在我的 create.gsp 中有以下内容：

```
$(document).ready(function () {

  <g:if test="${openEmailClient}">              
    <g:set var="subject" value="${g.message(code: 'deal.created.email.subject')}" scope="page" />
    <g:set var="body" value="${g.message(code: 'deal.created.email.body')}" scope="page" />
    window.location.href = "mailto:${emailTo}?subject=${subject}&body=${body}";
  </g:if>
}); 
```

这将打开默认电子邮件客户端并填充“收件人”字段。

如何将电子邮件列表转换为逗号分隔的字符串？（这是否正确？大多数电子邮件客户端会接受逗号作为电子邮件分隔符吗？）

即a@a.com,b@b.com...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-08T15:47:28.667

使用 Groovy[`join`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#join%28java.lang.String%29)方法

```
"mailto:${emailTo.join(',')}?.... 
```

# outlook - 在撰写 Outlook 电子邮件时，根据“收件人：”、“抄送：”和“密件抄送：”文本字段中的姓名或电子邮件地址提供反馈

> ID：13292442
> 
> 赞同：1
> 
> 时间：2012-11-08T15:46:23.450
> 
> 标签：outlook, outlook-addin, email-validation

在撰写 Outlook 消息时，我想向用户提供有关电子邮件是否发送到已批准域上的电子邮件地址的非侵入性反馈。

例如，如果用户正在发送一封电子邮件，其中“收件人：”、“抄送：”或“密件抄送：”文本字段包含不以“@AnEmailAddress.com”结尾的电子邮件地址，则应发出某种警告适当显示。

警告可以是显示红色或绿色的单个图标，或者每个姓名/电子邮件地址可以直接在“收件人：”等文本字段中格式化，以提供反馈。

我做了一些没有具体结果的挖掘。我不确定这是否可以使用 VBA 或 Outlook 表单中的脚本来完成。或者可能需要通过 .net 编写加载项？

任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T01:40:55.120

这是 .NET 加载项的理想选择。不知道你是否可以从 VBA 做到这一点。根据您需要支持的 Outlook 版本范围，您可能希望使用 VSTO 插件（不同版本的单独构建）或 NetOffice（几乎所有版本的构建）。两者都有优点和缺点，因此您需要更具体地做出选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:09:34.777

如果您已经使用例如 C# 编写了 Outlook 消息，那么也可以使用它来实现您想要的某种警报。

您的问题是 - VBA、脚本还是 .NET？

我的回答：这取决于你的技能和喜好

# php - 在 foreach 运行时获取行数

> ID：13292445
> 
> 赞同：0
> 
> 时间：2012-11-08T15:46:29.940
> 
> 标签：php, mysql, codeigniter

我正在使用 foreach 循环发送邮件，以在控制器的 codeigniter 方法中获取收件人信息，并且，如果发送了邮件，我将收件人表中的收件人状态更新为“已发送”。

在同一控制器的另一种方法中（使用相同的模型），我得到了未发送邮件的数量，但是如果我在发送邮件时尝试获取未发送邮件的数量，它会等到 foreach 循环完成。

在 foreach 循环中发送邮件时，如何连续获取未发送邮件的数量？

```
recipients table
    id int 11
    recipient_id int 11
    mail_id int 11
    sent tinyint 1
    failed tinyint 1

$recipients = $this->MMails->GetRecipients($mail_id);
foreach($recipients as $recipient) {
    //send message using swift
    if($message_sent) {
        $this->MMails->MarkAsSent($recipient_id);//this recipient table gets updated actually, but I can't read the new COUNT value until this loop finished
    }
} 
```

从模型：

```
 function GetNumOfQueued() {//Get number of queued mails
    $query = $this->db->query("SELECT COUNT(id) as num_of_queued
        FROM recipients 
        WHERE sent = 0");
    return $query->row()->num_of_queued;
}//GetNumOfQueued

 function MarkAsSent($recipient_id) {//Update mail recipient status to sent
    $this->db->set('sent', 1);
    $this->db->where('id', $recipient_id);
    $this->db->limit(1);
    $this->db->update('recipients');

}//MarkAsSent 
```

简而言之，PHP 在循环完成之前不会响应，并且当循环处于活动状态时，我无法打开应用程序中的任何其他页面。

我本地 php.ini 中的设置是 output_buffering = Off

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:48:09.697

我建议将未发送邮件的数量保留在数据库中并使用查询获取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:09:25.957

你不能只用一个计数器吗？

```
$recipients = $this->MMails->GetRecipients($mail_id);
$messages_to_send = count($recipients);
foreach($recipients as $recipient) {
    //send message using swift
    if($message_sent){
        $messages_to_send--; 
        $this->MMails->MarkAsSent($recipient_id);
    }
} 
```

* * *

输出缓冲应该可以解决问题：

[http://php.net/manual/en/book.outcontrol.php](http://php.net/manual/en/book.outcontrol.php)

它将在循环运行时允许其他执行。

以下是处理循环时在屏幕上输出 ob 的示例：

```
if (ob_get_level() == 0) ob_start();

for ($i = 0; $i<10; $i++){

        echo "<br> Line to show.$i";
        echo str_pad('',4096)."\n";    

        ob_flush();
        flush();
        sleep(2);
}

echo "Done.";
ob_end_flush(); 
```

-http://us1.php.net/manual/en/function.flush.php#54841

* * *

```
if (ob_get_level() == 0) ob_start();

$recipients = $this->MMails->GetRecipients($mail_id);
$messages_to_send = count($recipients);
foreach($recipients as $recipient) {
    //send message using swift
    if($message_sent){
        $messages_to_send--; 
        $this->MMails->MarkAsSent($recipient_id);
        echo "<br> Emails left to send: .$messages_to_send";
        echo str_pad('',4096)."\n";    
        ob_flush();
        flush();
    }
}
echo "All emails have been sent.";
ob_end_flush(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:48:58.963

PHP 类实例是根据请求创建的，因此如果您希望能够在它仍在运行时获取信息，您将需要将数据写入 MySQL 中的表或使用类似`Memcached`or的东西`APC`。

# 3d - 开始制作3d游戏

> ID：13292448
> 
> 赞同：1
> 
> 时间：2012-11-08T15:46:37.497
> 
> 标签：3d, game-engine

我想做一个 3d 游戏，不知道从哪里开始

我绝对不想制造自己的引擎，因为我觉得我在重新发明轮子，所以我查看了一些免费的引擎，但我不知道如何决定选择哪个

我想要一个非常巨大的世界，你可以在其中四处走动，有水和你在大自然中找到的一切，还有一些不错的物理和声音、音乐和特殊效果、粒子系统，一切：D

我可能想一次渲染一个巨大的区域，或者更好的是我想要它，这样你就可以看到无穷远的距离，也许你只能在远处渲染物体的粗糙形状之类的？

他们说 irrlicht 图形引擎具有出色的性能，这对我很重要

我不是很有经验但很聪明，我知道一点 c++ 和 opengl，哪个引擎最适合制作大型游戏？任何关于任何事情的建议都会很棒而且非常受欢迎！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:50:57.147

如果你不是一个非常有经验的程序员，我会从微软的 XNA 框架之类的东西开始，然后首先构建一个 2D 横向滚动条。每个人都想直接进入 3D，却没有意识到添加另一个维度会带来的复杂性。

您还可以查看 Unreal 的开发工具包 ( [http://www.unrealengine.com/en/udk/downloads/](http://www.unrealengine.com/en/udk/downloads/) )。这与当今许多游戏使用的虚幻引擎相同（减去一些许可功能），但您可以使用它创建一些令人印象深刻的东西。

# visual-studio-2012 - 在visual studio 2012挂起中单击鼠标右键

> ID：13292449
> 
> 赞同：4
> 
> 时间：2012-11-08T15:46:43.550
> 
> 标签：visual-studio-2012

在 Visual Studio 2012 中，我注意到当我对上下文菜单使用鼠标右键时，菜单出现之前需要 10 到 20 秒...这只是最近的一个问题。我尝试重置所有 VS 设置，卸载并重新安装 VS，修复 VS...除了擦除计算机并重新开始之外的所有操作...我还注意到我的一些快捷方式...即“转到声明“，现在已禁用，我无法使用它们...

非常感谢所有帮助。

# iis-7 - 升级到 MVC 4 后静态内容返回错误 500

> ID：13292450
> 
> 赞同：0
> 
> 时间：2012-11-08T15:46:44.480
> 
> 标签：iis-7, asp.net-mvc-4

我们一直在运行 .Net 4 MVC 3 应用程序而没有任何问题，并决定今天升级到 MVC 4。MVC 4 版本在我的计算机上本地运行时效果很好，但是当发布到服务器（运行 IIS 7）时，它会为所有 css 文件和 js 文件返回错误代码 500。

没有对应用程序进行其他更改。

MVC 4 未安装在服务器上（MVC 3 也未安装），因此我们使用 _bin_deployableAssemblies 文件夹部署必要的 dll。

有没有人可以解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:13:11.047

原来问题与静态文件的压缩有关。前段时间（当我们还在使用 MVC 3 时）我们在 web.config 中添加了 httpCompression (gzip) 和 urlCompression，但由于某种原因，我猜它直到今天才开始使用。

我再次尝试使用 MVC 3 发布应用程序并得到相同的错误导致我发现问题。

# c++ - 保存图片不压缩

> ID：13292452
> 
> 赞同：0
> 
> 时间：2012-11-08T15:46:47.610
> 
> 标签：c++, c, windows, winapi, unix

我知道 JPG、BMP、GIF 和其他格式压缩图像。但是我可以获取显示的快照并保存它而不以编程方式（例如使用 c/c++ 或其他东西）压缩（在二进制文件中）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T15:49:23.883

默认情况下不压缩 BMP 文件。见这里：[https ://en.wikipedia.org/wiki/BMP_file_format](https://en.wikipedia.org/wiki/BMP_file_format)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:14:10.210

[http://www.zlib.net](http://www.zlib.net)是 C 中无损压缩的最佳解决方案。它维护良好，可用于许多不同的软件，并与诸如 winzip 等外部存档器兼容。

C++ 提供了围绕它的包装器，例如 boost::iostreams::zlib 和 boost::iostreams::gzip。Zlib 使用 deflate 算法（RFC1951）；这里对算法有一个很好的解释：[http ://www.zlib.net/feldspar.html](http://www.zlib.net/feldspar.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:38:21.107

[PAM 格式](http://en.wikipedia.org/wiki/PAM_graphics_format)是未压缩的，非常易于理解。

# c# - C# DateTime ParseExact 异常

> ID：13292458
> 
> 赞同：1
> 
> 时间：2012-11-08T15:47:04.597
> 
> 标签：c#, exception, datetime, datetime-format

我遇到了 DateTime.ParseExact 方法的问题，该方法抛出异常，即我的***输入字符串格式不正确***。

代码如下：

```
class Program
    {
        static void Main(string[] args)
        {
            var rawDate = "Thu, 08 nov 2012 15:19:18 0";
            var _format = "ddd, dd MMM yyyy HH:mm:ss K";
            var date = DateTime.ParseExact(rawDate, _format, CultureInfo.InvariantCulture);
        }
    } 
```

我在 SO 上发现了一些类似的线程，具有确切的日期格式，没有人在那里报告任何问题。

我按照这个作为我的指南：

```
ddd = Three letter Day of week
MMM = Three letter month
dd = Two digit day of month 01-31  (use "d" for 1-31)
HH = Hours using 24-hour clock. 00-24  (use "H" for 0-24)
mm = Minutes. 00-59
ss = Seconds. 00-59
K = Time zone information
yyyy = 4-digit year 
```

什么可能导致异常？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T15:52:52.920

我认为您的“K”可能有点偏离。

这里的链接可能会给出解释：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#KSpecifier](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#KSpecifier)

您可以将此留空并删除 0 - K

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T15:53:13.250

您的输入字符串中的时区错误 - 它需要采用 +00:00 格式。

要测试您的日期时间格式字符串，请反向运行它们：

```
Console.WriteLine(DateTime.Now.ToString(_format)); 
```

这使

```
Thu, 08 Nov 2012 15:50:58 +00:00 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T15:51:03.373

时区信息在我看来是最有可能的嫌疑人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T15:53:13.577

试试这个：

```
var _format = "ddd, dd MMM yyyy HH:mm:ss 0"; 
```

但是，您将丢失时区信息。

# c# - 使用 C#/ADO.Net 实体复制大型数据库时内存不足

> ID：13292464
> 
> 赞同：1
> 
> 时间：2012-11-08T15:47:28.677
> 
> 标签：c#, ado.net, garbage-collection

另一个如何释放内存的问题：

我正在两个当前相同但很快就会不同步的数据库之间复制数据。我使用 Reflection 和 ADO.Net Entities 在 C# 中编写了一个框架应用程序，它执行以下操作：

对于源数据库中的每个表：

*   清除目标数据库中的对应表
*   对于源表中的每个对象
    *   对于源对象中的每个属性
        *   如果目标对象中存在同名属性，则使用反射将源属性复制到目标属性

在我找到包含用户上传文件的 900MB 大表之前，这非常有效。

将 blob（每个最多 7 MB）复制到我的机器并返回到目标数据库的过程会占用本地内存。但是，该内存没有被释放，一旦复制了大约 750 MB 的数据，该进程就会终止——当抛出 OutOfMemoryException 时，我的程序有 1500 MB 的分配空间，大概是到目前为止它复制的所有内容的两个副本。

我先尝试了一种天真的方法，做了一个简单的复制。它在每张桌子上都有效，直到我拿到大桌子为止。我曾尝试强制 a`GC.Collect()`对结果没有明显变化。我还尝试将实际副本放入一个单独的函数中，希望超出范围的引用有助于它获得 GC。我什`Thread.Sleep`至尝试让后台进程有更多时间运行。所有这些都没有效果。

这是目前存在的相关代码：

```
public static void CopyFrom<TSource, TDest>(this ObjectSet<TDest> Dest, ObjectSet<TSource> Source, bool SaveChanges, ObjectContext context)
    where TSource : class
    where TDest : class {

    int total = Source.Count();
    int count = 0;
    foreach (var src in Source) {
        count++;
        CopyObject(src, Dest);

        if (SaveChanges && context != null) {
            context.SaveChanges();
            GC.Collect();
            if (count % 100 == 0) {
                Thread.Sleep(2000);
            }
        }
    }
} 
```

我没有包含 CopyObject() 函数，它只是使用反射来评估 src 的属性并将它们放入要附加到 Dest 的新对象中的同名属性中。

SaveChanges 是传入的布尔变量，表示应该进行此额外处理，仅在大表上为 true，否则为 false。

所以，我的问题是：如何修改此代码以不让我内存不足？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T15:56:42.710

问题是您的数据库上下文在内部使用了大量缓存，并且它保留了您的大量信息并阻止垃圾收集器释放它（无论您是否调用`Collect`）。

这意味着您的上下文定义的范围太高。（根据您的编辑，您似乎正在跨表使用它。那……不好。）您没有显示它的定义位置，但无论它在哪里，它可能应该处于较低级别。请记住，由于连接池创建新上下文并不昂贵，并且根据您的用例，您不需要依赖大量缓存信息（因为您不会多次触摸项目）如此频繁地创建新的上下文不应该增加性能成本，即使它大大减少了你的内存占用。

# netlogo - 如何在 netlogo 中包含补丁年龄的影响？

> ID：13292466
> 
> 赞同：1
> 
> 时间：2012-11-08T15:47:34.283
> 
> 标签：netlogo

如何在下面的代码中完成以下操作：

> 补丁改变颜色以反映它们与“min-pycor”行的距离

例如，颜色从黄色变为红色，然后变为黑色（表示死亡）。

但这要考虑到黄色斑块的产生>红色>黑色。

```
turtles-own
[
 stem?     ;; true for stem cells, false for transitory cells
 age  ;; age of cell. changes color with age
 metastatic?  ;; false for progeny of stem cell 0, true for progeny of stem cell 1
]

globals
[
 cell-count
]

to setup
clear-all
set-default-shape turtles "square"
ask patches[
  if pycor = min-pycor [
    ifelse random 10 <= 2 
     [set pcolor white]
     [sprout 1 [set shape "square" set color blue] ] 
 ]
 ]
evaluate-params
reset-ticks
end

to go
ask patches with [pcolor = yellow]
[if count neighbors with [pcolor = black] > 0
 [ask one-of neighbors with [pcolor = black][set pcolor yellow]
   ]
]

ask patches with [pcolor = white] 
[if count neighbors with [pcolor = black] > 0
[ask one-of neighbors with [pcolor = black][set pcolor yellow]
  ]
]
tick
 end
 ;;transitional cells move and hatch more. Turtle proc.
  to move-transitional-cells
  if (not stem?)
 [
  set color ( red + 0.25 * age )
  fd 1
  if (age < 6)
  [
    hatch 1
    [  ;amplification
     rt random-float 360
     fd 1
    ]
  ]
   ]
  end

 to mitosis ;; turtle proc. - stem cells only
 if stem?
 [
  hatch 1
  [
  fd 1
  set color red
  set stem? false
  ifelse (who = 1)
    [ set age 16 ]
    [ set age 0 ]
   ]
   ]
  end

 to death   ;; turtle proc.
 if (not stem?) and (not metastatic?) and (age > 20)
  [ die ]
 if (not stem?) and metastatic? and (age > 4)
  [ die ]
 end

to evaluate-params
set cell-count count turtles  ;cell count
if (cell-count <= 0)
 [ stop ]
end

to kill-original-stem-cell
 ask turtle 0
 [ die ]
 end

to kill-moving-stem-cell
ask turtle 1
[ die ]
end

 to kill-transitory-cells
 ask turtles with [ age < 10 and not stem? ]
  [ die ]
 end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T14:12:51.413

您似乎有两个相互矛盾的要求，即基于代码中接近度的颜色变化，以及基于您询问的 PYCOR 的颜色变化。

暂时忽略代码，我们可以通过多种方式基于 PYCOR 设置颜色。例如，我们可以创建色带，我们可以创建颜色的抖动混合，或者我们可以创建颜色之间的“平滑”过渡。

第一个很容易。我们可以使用 IFELSE 结构。此示例创建偶数条带，但您可以更改“分割”变量以创建任意高度的条带。

```
let color1 red
let color2 yellow
let color3 black

let divide1 (min-pycor + world-height * 0.33)
let divide2 (min-pycor + world-height * 0.66)

ask patches
[ ifelse pycor < divide1 [ set pcolor color1 ][
  ifelse pycor < divide2 [ set pcolor color2 ][
                           set pcolor color3
  ]]
] 
```

我们也可以用数学的方式来做。此示例创建偶数带。

```
let colors [ red yellow black ]
let bands length colors 
let band-height floor ( world-height / bands + .5 )
;; pycor - min-pycor shifts the range from 0 to world-height
ask patches [ set pcolor item ( floor ( ( pycor - min-pycor ) / band-height ) ) colors ] 
```

我们可以通过在 pycor 中引入随机元素来创建抖动带。我们还必须添加一些测试以使随机数保持在范围内。

```
let colors [ red yellow black ]
let bands length colors 
let band-height floor (world-height / bands + .5)
let dither band-height * .5 ;; adjust this to change dithery-ness
ask patches
[ let py pycor - min-pycor + dither - random-float ( dither * 2 ) 
  ;; you might want to really study the above line to fully grok what's happening there
  if py < 0 [ set py 0 ]
  if py > world-height [ set py world-height ]
  set pcolor item ( floor ( py / band-height ) ) colors
] 
```

渐变（渐变）色带更难，因为 NetLogo 色彩空间不做色调的渐变，只有色调和阴影，所以真的没有办法从红色变成黄色。所以我们必须使用 RGB（三值列表）颜色，而不是 NetLogo（单值）颜色。这超出了我目前愿意输入的范围，所以你去吧——作为一个锻炼者。

# php - array_filter 检查条件？

> ID：13292468
> 
> 赞同：-1
> 
> 时间：2012-11-08T15:47:33.963
> 
> 标签：php, multidimensional-array, array-filter

我可以使用 array_filter 检查多维数组中的特定条件以替换 if() 语句吗？

希望它取代这样的东西：

```
if($item[0] == $key && $item[1] == "Test"){
    //do something here....
}else{
    //some other code here...
} 
```

当前数组：

```
Array
(
    [Zone] => Array
        (
            [Type] => s45
            [packageA1] => Array
                (
                    [level] => REMOVE FROM DB
                    [stage] => REMOVE FROM DB
                    [description] => description goes here
                    [image] => NULL
                )

        )
) 
```

我想先搜索一下 [Type] 是否存在。如果它不存在，那么我认为不适合使用 array_splice 将其插入现有数组中。如果它确实存在，则检查 [packageA1] 是否存在，如果 [packageA1] 不存在，那么我将再次使用 array_splice。如果 [packageA1] 确实存在，那么如果插入，我会跳过任何类型。

那有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:05:15.753

`array_filter`设计用于过滤数组，而不是基于数组内容替换布尔逻辑。

`array_filter`接受 2 个参数 -`input`和`callback`.

该`callback`函数应采用单个参数（数组中的一项）并返回`true`或`false`。该函数返回一个数组，其中`false`删除了所有返回的项目。

（如果没有`callback`指定函数，所有等于的项`false`都将从结果数组中删除。）

**编辑：**

根据您更新的文本，以下代码应该可以满足您的要求：

```
if (!$item['Zone']['Type']) {
    $item['Zone']['Type'] = $something;
}
if (!$item['Zone']['packageA1']) {
    !$item['Zone']['packageA1'] = $something;
} 
```

显然，您需要替换`$something`为您实际要添加的内容。

这段代码可以通过使用三元运算符来缩短。

如果您运行的是 PHP 5.3 或更高版本，您可以执行以下操作：

```
$item['Zone']['Type'] = $item['Zone']['Type'] ?: $something;
$item['Zone']['packageA1'] = $item['Zone']['packageA1'] ?: $something; 
```

在 5.3 之前，您不能错过三元运算的中间部分，并且必须使用以下完整格式：

```
$value = conditon ? if_true : if_false; 
```

（`?:`在我的示例中使用时，'condition' 和 'if_true' 采用相同的值。）

完整的三元运算符（对于 5.3 之前的 PHP）如下所示：

```
$item['Zone']['packageA1'] = $item['Zone']['packageA1'] ? $item['Zone']['packageA1'] : $something; 
```

# java - 设置/配置 EJB 计时器服务的数据源

> ID：13292473
> 
> 赞同：14
> 
> 时间：2012-11-08T15:47:54.160
> 
> 标签：java, jakarta-ee, glassfish, ejb-3.1

我正在尝试在我的应用程序中使用 EJB 3.1 中的计时器服务。

```
@Stateless
@LocalBean
public class StatelessTimerSessionBean {

    @Schedule(minute = "*", second = "0", dayOfMonth = "*", month = "*", year = "*", hour = "9-17", dayOfWeek = "Mon-Fri")
    public void myTimer() {
        System.out.println("Timer event: " + new Date());
    }
} 
```

> “.. 将 EJB Timer Service 的 Timer DataSource 设置设置为有效的 JDBC 资源..”

来自[EJB 定时器服务](http://docs.oracle.com/cd/E19316-01/820-4336/beahw/index.html)

我不知道如何正确配置计时器数据源？

我在部署时遇到的错误是：

```
SEVERE: Exception while invoking class org.glassfish.ejb.startup.EjbApplication start method
java.lang.RuntimeException: EJB Timer Service is not available 
```

运行：glassfish-3.1.2.2

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-08T17:56:05.420

## 1\. 示例数据库设置

1.  我使用 MySQL 作为我的数据库。

2.  `EJB__TIMER__TBL`从创建表`{GF_HOME}/glassfish/lib/install/databases/ejbtimer_{DB_ENGINE}.sql`

DB_EN​​GINE = 例如 MySQL：

```
CREATE TABLE EJB__TIMER__TBL (
    `CREATIONTIMERAW`      BIGINT        NOT NULL,
    `BLOB`                 BLOB,
    `TIMERID`              VARCHAR(255)  NOT NULL,
    `CONTAINERID`          BIGINT        NOT NULL,
    `OWNERID`              VARCHAR(255)  NULL,
    `STATE`                INTEGER       NOT NULL,
    `PKHASHCODE`           INTEGER       NOT NULL,
    `INTERVALDURATION`     BIGINT        NOT NULL,
    `INITIALEXPIRATIONRAW` BIGINT        NOT NULL,
    `LASTEXPIRATIONRAW`    BIGINT        NOT NULL,
    `SCHEDULE`             VARCHAR(255)  NULL,
    `APPLICATIONID`        BIGINT        NOT NULL,
    CONSTRAINT `PK_EJB__TIMER__TBL` PRIMARY KEY (`TIMERID`)
); 
```

## 2.服务器配置

[![GlassFish 管理控制台](../Images/b88bd20fd4d182c172e9d822898dbe12.png)](https://i.stack.imgur.com/opjB6.png)

1.  启动 GlassFish 服务器管理控制台：通常`http://localhost:4848`
2.  在您的左侧导航到**[Configurations] > [server-config] > [EJB Container]**
3.  然后点击上方的**TAB** **【EJB Timer Service】**
4.  然后填写**Timer Datasource** : 使用您的 JDBC 资源，例如。[mysql-pu]。（ [***注：****默认为`jdbc/__TimerPool`*](http://docs.oracle.com/cd/E19316-01/820-4336/beahw/index.html)）
5.  **重启**服务器

## 3\. 结果

```
...
INFO: [TimerBeanContainer] Created  TimerBeanContainer: TimerBean
INFO: EJB5181:Portable JNDI names for EJB TimerBean: [java:global/ejb-timer-service-app/TimerBean, java:global/ejb-timer-service-app/TimerBean!com.sun.ejb.containers.TimerLocal]
INFO: WEB0671: Loading application [ejb-timer-service-app] at [/ejb-timer-service-app]
INFO: EJB5109:EJB Timer Service started successfully for data source [mysql-pu]
INFO: Setting DBReadBeforeTimeout to false
INFO: ==> Restoring Timers ... 
INFO: There are no EJB Timers owned by this server
INFO: <== ... Timers Restored.
... 
```

## 4\. 还是坏了？TimerService 刚刚停止工作（它曾经工作）？

因此，在充满“保存部署”的一天之后，这发生在我身上。TimerService 突然不可用了。

```
Severe:   Exception while loading the app
Severe:   Undeployment failed for context /ejb-timer-service-app
Warning:   Cannot deploy or load EJBTimerService: org.glassfish.deployment.common.DeploymentException: Error in linking security policy for ejb-timer-service-app -- Inconsistent Module State 
```

**[解决方案在这里找到](https://stackoverflow.com/a/11770611/532772)**

## 5\. 有用的链接

*   [Oracle：将 EJB 计时器部署到集群](http://docs.oracle.com/cd/E18930_01/html/821-2418/beahw.html#gktqo)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-23T19:03:56.950

在 JBoss/WildFly 中，您可以按照以下说明进行操作：

[Mastertheboss.com：创建集群 EJB 3 计时器](http://www.mastertheboss.com/jboss-server/wildfly-8/creating-clustered-ejb-3-timers)
发布时间：2015 年 3 月 8 日

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-08T16:43:59.070

听起来 glassfish-3.1.2.2 不支持 EJB3，尝试使用 jboss 7。

[http://docs.oracle.com/cd/E26576_01/doc.312/e24939/release-notes.htm](http://docs.oracle.com/cd/E26576_01/doc.312/e24939/release-notes.htm)

# php - 在 PHP 中验证日期/时间输入

> ID：13292476
> 
> 赞同：3
> 
> 时间：2012-11-08T15:47:57.727
> 
> 标签：php, date, format, verify

PHP 编程新手。尝试验证日期/时间的输入格式。用户输入如下 2012 年 11 月 27 日下午 6 点“2012-nov-27|6pm”。

不确定从哪里开始。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:12:35.017

~~江南~~OOP 风格：

```
$input = '2012-nov-27|6pm';
$date  = \DateTime::createFromFormat('Y-M-j ga', str_replace('|', ' ', $input));
if ($date === false) {
    throw new \Exception('Invalid date!');
} 
```

**注意：**我在使用格式/日期字符串时遇到了问题`|`，因此`str_replace()`

**注意 2：**如果输入的日期格式`01-31`不是，请用第一个参数中的 a`1-31`替换。`j``d``createFromFormat()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:54:13.933

在[这里](http://php.net/manual/en/function.date-parse-from-format.php)查看 date_parse_from_format 文档和[这里](http://php.net/manual/en/function.date.php)查看一般日期格式。试试这个：

```
<?php
$date = "2012-nov-27|6pm";
print_r(date_parse_from_format("Y-M-d|ga", $date));
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:12:13.320

如果您只是想测试您的日期的有效性，以下将起作用。即使您只是想测试输入格式，我建议您也对数据进行健全性检查。

```
$thedate = "2012-nov-27|6pm";

$arryParts = explode("|", $thedate);

$arryDate = date_parse($arryParts[0]);
if(!checkdate($arryDate['month'], $arryDate['day'], $arryDate['year'])) {
   /* error handling */
}

/* valid date, continue processing */ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T15:53:46.697

如果您只想检查格式，请使用正则表达式：

```
$months = 'jan|feb|mar|apr|may|jun|jul|aug|sep|okt|nov|dec';
$pattern = '/([0-9]{4})-('.$months.')-([0-9]{2})\\|([0-9]?[0-9])(am|pm)/';
preg_match($pattern, $input, $matches);
var_dump($matches); 
```

如果您真的想检查特定日期/时间是否存在，事情会变得更加复杂。我可能错了，但我不认为可以使用 PHP 日期函数来完成，因为它们对输入错误非常宽容。也许有一个图书馆可以做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T15:52:59.600

您可以使用[检查日期](http://www.php.net/manual/en/function.checkdate.php)：

```
if(checkdate($month, $day, $year)){
    echo 'Valid date!';
} 
```

或者，您可以转换用户使用 strtotime() 输入的任何内容。如果 strtotime 无法确定日期是什么，则返回 bool false。

```
if(strtotime($dateEntered) !== false){
     echo 'Valid date!';
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-08T15:55:27.097

尝试：

```
$datetime = "2012-nov-27|6pm";
$unixtime = strtotime( $datetime );
if( is_numeric($unixtime) && $unixtime <= PHP_INT_MAX ) {
  //do something if true
 } else {
    echo "Invalid DateTime";
 } 
```

[演示](http://codepad.org/SWhDDiWH)

# ruby-on-rails - Ruby on Rails：序列化哈希非常慢

> ID：13292477
> 
> 赞同：4
> 
> 时间：2012-11-08T15:48:02.217
> 
> 标签：ruby-on-rails, ruby, serialization, hash

我有一个名为“Search”的简单模型，用于存储搜索。它捕获 URL 参数并将它们存储在属性 :search_criteria 中，该属性被序列化为哈希：

```
serialize :search_criteria, Hash 
```

这一切都很完美，但它的表现非常糟糕。仅对于 5 个对象，以下语句大约需要 0.2 秒。

```
start = Time.now
SavedSearch.all.map(&:search_criteria)
puts Time.now - start 
```

但是，如果我删除了 serialize 行（这样 search_criteria 返回一个字符串），语句只需要 0.002 秒。这是反序列化哈希的 2 个数量级的差异！

这里发生了什么事？

Rails.version = 3.2.8 Ruby 1.9.3p194（2012-04-20 修订版 35410）[x86_64-linux]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:29:56.943

Active Record 可能会产生大量开销，因此看起来有点矫枉过正。当它循环时，它会在 SavedSearch 中实例化每个对象，然后评估它需要创建的属性，然后它会执行映射。

如果您知道确切的结构，它似乎存储在“search_criteria”中，那么只需将其存储在 YAML 中的文本属性中。那应该快很多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T14:41:20.667

该问题是由 YAML 解析器引起的。反序列化 YAML*非常慢*。我通过将 search_criteria 哈希序列化为 JSON 而不是 YAML 解决了这个问题。它现在快了大约 100 倍。

有关其他阅读材料，请查看[http://iprog.com/posting/2009/10/ruby-on-rails-performance-series-intro-yaml](http://iprog.com/posting/2009/10/ruby-on-rails-performance-series-intro-yaml)

# windows - 如何在 .BAT 文件中复制文件名中包含特殊字符的文件？

> ID：13292483
> 
> 赞同：1
> 
> 时间：2012-11-08T15:48:15.997
> 
> 标签：windows, batch-file, cmd

我正在生成一个 .BAT 文件，其中只包含 COPY 命令来移动一些文件。

这是一个示例工作命令：

```
COPY "C:\TEST.PDF" "D:\TEST.PDF" 
```

这是一个不起作用的示例：

```
COPY "C:\édf.pdf" "D:\édf.pdf" 
```

我可以使用 Windows 批处理文件复制此文件吗？还是我必须用 PERL 之类的语言重写我的脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:02:49.210

我给出的例子确实有效。我注意到在我的 .BAT 文件中，由于 .BAT 文件的编码，这些特殊字符会丢失。

# asp.net-mvc - 子 Web 应用程序的会话超时

> ID：13292488
> 
> 赞同：2
> 
> 时间：2012-11-08T15:48:33.120
> 
> 标签：asp.net-mvc

我有一个旧的 asp.net web 表单网站，它使用表单身份验证。现在，我需要在网站中创建一个新的子 MVC 应用程序。我的新应用程序很可能是一个 SPA，这意味着大多数操作都是通过 Ajax 完成的。在会话超时之前一切正常，因为一旦超时，我的后台 Ajax 将返回表单登录页面的内容，而不是我的 json 数据。这是正确的会话行为，但是我如何知道 ajax 中的会话超时，然后将页面重定向到登录页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:59:28.067

您可以捕获 AJAX 调用的失败并查找 401 结果，这意味着请求未授权。

我假设您在这里使用 Web API 进行服务调用 - 如果您在普通 MVC 控制器上调用方法，则需要做一些工作以确保未经身份验证的请求返回 401 而不是将您重定向到登录页面。

# java - 将两个 HashMap 组合成第三个

> ID：13292489
> 
> 赞同：1
> 
> 时间：2012-11-08T15:48:35.290
> 
> 标签：java, hashmap

假设我在下面每个类都有一个对象，我将每个对象放在一个哈希图中，其中 IDnumber 是两个映射中的键。

```
class1 {
 int IDNumber = 123;  //same person as class2
 String name = John;
 String company = Intel;

 class2 { 
 int IDNumber = 123;  //same person as class1
 int income = 500;
 int workYears = 3;
 } 

HashMap<Integer, class1> one = new Hashmap<Integer, class1>();
HashMap<Integer, class2> two = new HashMap<Integer, class2>(); 
```

现在，我怎样才能将这两个 HashMap 混合成第三个 HashMap，以便我可以拥有键 IDnumber 以及值 name、company、income 和 workyears？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:53:09.753

你不能这样做。你有两个不同的类，java 不会自动神奇地将它们变成一个。

您可以创建一个新的第三类来合并信息：

```
public Class3 {

   public Class3(Class1 class1, Class2 class2){
       //pull the info you want from each into variables in this class
   }
} 
```

然后遍历您的地图以获取条目，为每个条目创建新的 Class3 实例并将它们放在一个新的`HashMap<Integer, Class3>`.

```
//gets the keys from the hashmap
Set<Integer> keys = one.keySet();
//merge the keys from the second hashmap
keys.addAll(two.keySet());
//new hashmap
Map<Integer, Class3> newMap = new HashMap<Integer, Class3>();
for (Integer key : keys){
     //create new instance and place it in the map
     newMap.put(key, new Class3(one.get(key), two.get(key));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:58:35.800

创建以`Combined`以下两种方式之一调用的第 3 类：

```
Combined {
    class1 info1;
    class2 info2;
} 
```

或更好：

```
Combined {
    int IDNumber = 123;
    String name = John;
    String company = Intel;
    int income = 500;
    int workYears = 3;
} 
```

*   创建第三个（空）HashMap
*   现在遍历您之前拥有的第一个 HashMap 中的所有元素
*   对于每个条目，在第二个 HashMap 中查找相同的键：
    *   如果找到，则将这两个条目中的信息组合起来，并将其作为实例的单个条目添加`Combined`到第三个 HashMap。然后从 HashMap 1 和 2 中删除这两个条目。
    *   如果未找到，则`Combined`无论如何都基于 HashMap 1 中的条目创建一个实例，并将来自 HashMap 2 的相应条目的不可用信息设置为 null。从 HashMap 一中删除条目。
*   现在第一个 HashMap 应该是空的。迭代 HashMap 2 以查找 HashMap 1 中没有对应 ID 的任何条目。如上所述将它们添加到第三个 HashMap 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T15:58:50.003

您不能在 java.util.Map 中使用相同的键存储多个值（即在您的情况下为 Class1 和 Class2）。你想要的是一个[Multimap](http://en.wikipedia.org/wiki/Multimap)。[Guava](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained)对此有一个实现。您正在寻找的是[ArrayListMultimap](http://guava-libraries.googlecode.com/svn/tags/release03/javadoc/com/google/common/collect/ArrayListMultimap.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:04:38.770

由于您的数据结构不是孤立的，您应该使用一些适配器/包装器

```
public class UserClassWrapper {

  private final UserClass1 class1;
  private final UserClass2 class2;

  UserWithDetail(UserClass1 class1, UserClass2 class2) {
    //Check preconditions as class1 and class2 must not be null and have equal id
    this.class1 = class1;
    this.class2 = class2;
  }

} 
```

然后在您的代码中，您可以声明一个地图：

```
private Map<Integer,UserClassWrapper> userClassWrappeMap = new HashMap<>(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T15:57:34.350

你需要创建一个新的类，它是它的混搭，`class1`并`class2`带有一个新`Map`的类。每次你把东西放进去`one`和“两个”，你都会做一个`mashup`包含这两个对象的新东西，然后把它放进`three`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-08T16:01:50.183

您可以使用 ArrayList 为一个键创建具有多个值的 HashMap

```
ArrayList<> list = new ArrayList();

/* populate your list here with two class having the same ID */

HashMap<Integer, List> three = new Hashmap();

/* Put list on the Hashmap */

/* Redo the operation with another ID */ 
```

但它不是很优化，如果你没有义务在最后有一个HashMap，直接使用一个multiHashMap：[http ://commons.apache.org/collections/apidocs/org/apache/commons/collections/MultiHashMap.html](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/MultiHashMap.html)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-08T16:08:45.203

你期待这样的安排吗

```
class class1 {
 int IDNumber = 123;  //same person as class2
 String name = "John";
 String company = "Intel";
 }

 class class2 { 

 int IDNumber = 123;  //same person as class1
 int income = 500;
 int workYears = 3;
 } 

 public class MyData{
public static void main(String arg[]){
    HashMap<Integer, class1> one = new HashMap<Integer, class1>();
    HashMap<Integer, class2> two = new HashMap<Integer, class2>();
    one.put(1, new class1());
    two.put(2, new class2());

    HashMap<Integer, Object> three = new HashMap<Integer, Object>();
    three.putAll(one);
    three.putAll(two);

    System.out.println(three);
}
 } 
```

# kendo-ui - Kendo UI Grid，可编辑模式不适用于本地数据

> ID：13292494
> 
> 赞同：4
> 
> 时间：2012-11-08T15:48:51.153
> 
> 标签：kendo-ui

我正在使用 Kendo UI Grid。这是我的代码：

```
<body>
<div id="myGrid"></div>

<script type="text/javascript">
$(function(){
    var rows =  [
    {name: "name001", id: "001", group: "G1"},
    {name: "name002", id: "002", group: "G1"},
    {name: "name003", id: "003", group: "G2"},
    {name: "name004", id: "004", group: "G2"},
    ];

    var myDataSource =
        new kendo.data.DataSource({
            data: rows,
            pageSize: 3,
        });

    myDataSource.read();
    $("#myGrid").kendoGrid({
        dataSource: myDataSource,
        columns: [
            {field:"name", title:"The Name"},
            {field:"id", title:"The Id"},
            {field:"group"},
            {command:["edit", "destroy"]}
            ],
        scrollable: false,
        pageable: true,
        sortable: true,
        groupable: true,
        filterable: true,
        editable: "inline"
    });

});
</Script>
</body> 
```

但编辑不起作用。在浏览器中打开这个网格会给我一个看起来与预期一样的网格，带有一个编辑和一个删除按钮。我可以使用删除按钮删除行。但是单击编辑会将行更改为编辑模式（在单元格中输入字段），但更改值并按下更新按钮不会执行任何操作。该行仍处于编辑模式，并且“更新”按钮不会按预期切换回“编辑”。你能告诉我缺少什么吗？我是否必须以某种方式配置我的数据源？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T20:43:18.543

是的，您错过了配置 Grid 的数据源以了解如何更新记录。我假设您只想在本地（在客户端）编辑记录-而不将它们发送到服务器。要真正关闭网格并应用更改，您可以使用网格的保存事件和刷新方法。

这是一个带有您案例的[jsbin 。](http://jsbin.com/edamuj/63/edit)

如果您想将这些更改保存到服务器，我建议您从[演示](http://demos.kendoui.com/web/grid/editing-inline.html)开始。

# actionscript-3 - Flex Number.toFixed 未给出预期结果

> ID：13292495
> 
> 赞同：1
> 
> 时间：2012-11-08T15:48:51.613
> 
> 标签：actionscript-3, apache-flex, flex4.5, numerical-methods, number-formatting

我有一个函数，它获取一个数值（作为对象）并返回该数字的格式良好的表示。因为我们可以得到非常小的数字，所以在这个过程中我们使用了 flex 的 Number 对象。这是代码的一部分：

```
var numericValue:Number = Number(value.toString());
var fixed:String = numericValue.toFixed(precision); 
```

这就是问题所在：在某些情况下，数值的形式是
`5.684341886080802e-14` 因为我们想在`0`使用上面的代码时表示这些数字。在这种特定情况下，精度为 0，我们得到一个奇怪的结果

```
Initial Values:
value = 5.684341886080802e-14
percision = 0

Operation on values:
var numericValue:Number = Number(value.toString());
var fixed:String = numericValue.toFixed(precision); 

Result:
fix = "1." 
```

为什么是这样？
（顺便说一句 - 在表示`X.XXXXXXe-YY`精度大于 0 的其他数字上，我们得到正确的结果 0）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:40:09.070

这是 Flash Player ( [FP-5141](http://bugs.adobe.com/jira/browse/FP-5141) ) 中的一个错误。它已经存在了一段时间。错误报告说它已修复，但它不是 Flash Player 11.5。

# asp.net-mvc - MVC3/4 路由和 URL 捕获

> ID：13292498
> 
> 赞同：0
> 
> 时间：2012-11-08T15:49:07.463
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing, url-routing

我正在开发一个 MVC 应用程序，并希望不同的客户（公司）在访问登录页面（及以后）时看到不同的 css 样式、徽标等。

我考虑过使用这样的 url 模式：

*   [http://www.myapp.com/CompanyA/](http://www.myapp.com/CompanyA/)
*   [http://www.myapp.com/CompanyB/](http://www.myapp.com/CompanyB/)

然后路由从那里继续：

*   [http://www.myapp.com/CompanyB/Article/1](http://www.myapp.com/CompanyB/Article/1)

然后我想我会询问 URL 以查看用户将进入哪个公司并加载相关的样式/徽标等。

我的问题是：我怎么能通过路由来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:55:10.560

您可以使用以下内容创建路线：

```
routes.MapRoute(
    name: "Default",
     url: "{company}/{controller}/{action}/{id}",
     defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

然后，您的操作方法将采用公司参数。

# android - 替换文件中的字符并将内容复制到临时文件并将临时文件重命名为原始文件

> ID：13292507
> 
> 赞同：0
> 
> 时间：2012-11-08T15:49:43.907
> 
> 标签：android

我想替换文件中的字符并将内容复制到临时文件并将临时文件重命名为原始文件。

```
path = "/mnt/sdcard/TESTfile/"
File _f = new File(path);
File[] _f1 = _f.listFiles();
String[] s1 = { "t1.txt", "t2.txt", "t3.txt" };
_fOut = new FileOutputStream(path + File.separator + s1[i]);

// Copy the bits from input stream to output stream
StringBuffer sb = null;
BufferedWriter out = null;
while ((line = reader.readLine()) != null) {
    line = line.replaceAll("a"," ").replaceAll("g"," ");
    sb = new StringBuffer();
    Log.i("Line>>>" + line, "<<<<<");
    sb.append(line);

    s = sb.toString();
    byte[] temp = s.getBytes();
    _fOut.write(temp);
}
fis.close();
_fOut.close();

//old file name with path
String path1 = path + File.separator + s1[i];

 //new file name with path
String rename1 = path + File.separator + _f1[i].getName();
File oldFile = new File(path1);
File renameFile = new File(rename1);

for(int j = 0; j < _f1.length;j++)
{

oldFile.renameTo(renameFile);
} 
```

这就是我试图做到的方式。我不确定如何重命名文件并删除原始文件。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:18:13.203

要重命名文件，您需要 2 个[File](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDQQFjAA&url=http%3A%2F%2Fdeveloper.android.com%2Freference%2Fjava%2Fio%2FFile.html&ei=wXKiUOGFGYe9iwKXvICQAw&usg=AFQjCNEtAK3ekRtPBSGiZ2TpNFWiCiEayQ&sig2=06wr0A5JRJThveCjEYyJ7w)对象。使用原始路径创建一个，使用新名称创建第二个。然后调用`original.renameTo(newFile)`。

删除文件更加容易。Android 上下文有一个名为[`deleteFile(name)`](http://developer.android.com/reference/android/content/Context.html#deleteFile%28java.lang.String%29). 调用它来删除文件。请记住，该方法仅从本地存储文件夹中删除文件，并且不接受路径分隔符。如果您想从其他位置删除文件，[`file.delete()`](http://developer.android.com/reference/java/io/File.html#delete%28%29)您也可以使用一种方法。

# jquery - 自定义 Mailchimp 注册表单不起作用

> ID：13292510
> 
> 赞同：1
> 
> 时间：2012-11-08T15:49:51.190
> 
> 标签：jquery, forms, mailchimp, fieldset

我正在使用 Twitter Bootstrap 和 jQuery validate 使我网站上的注册部分看起来不错。然后我希望它链接到 Mailchimp 列表。我已经构建了工作前端，并在此处查看了 Mailchimp[页面](http://kb.mailchimp.com/article/advanced-customization-of-mailchimps-sign-up-forms)，了解如何将两者链接起来，不幸的是我无法让它工作。

这是相当多的代码，包括额外的 validate.js 网站在[这里](http://www.shiftswap.me)

这是 Mail chimp 建议我需要编辑的代码。

```
<form action="http://shiftswap.us5.list-manage.com/subscribe/post" method="POST">
<input type="hidden" name="u" value="09ea39478ba4b316411db0a2f">
<input type="hidden" name="id" value="aff40c7e1a">
<div id="mergeTable" class="mergeTable">
<div class="mergeRow dojoDndItem mergeRow-text" id="mergeRow-1">
<label for="MERGE1">First Name</label>
<div class="field-group">
<input type="text" name="MERGE1" id="MERGE1" size="25" value="">
</div>
</div> 
```

以及来自网站的代码（- js 和其他元素） 你的名字 你的电子邮件 提交

我将非常感谢任何人能够提供的任何帮助。

先感谢您。

# asp.net - ASHX 发送带有模拟功能的 HttpWebRequest，它适用于同一服务器上的 URL，但不适用于远程 ArcGIS 服务器

> ID：13292513
> 
> 赞同：2
> 
> 时间：2012-11-08T15:49:54.693
> 
> 标签：asp.net, impersonation, ashx

这是一个复杂的问题，所以请耐心等待。

场景：使用 ASHX 代理将请求中继到 ArcGIS 服务器。尝试使用 ASP.NET 模拟，以便在向 ArcGIS 服务器发送请求时，代理使用登录的 ASP.NET 用户凭据。

问题：对 ArcGIS 服务器的代理请求被拒绝 401，即使我知道模拟帐户 (sean.ryan-B + sean.ryan) 确实具有访问权限。

有4台机器：

```
1\. machine hosting proxy page.  I am logged in as: sean.ryan-B
2\. a test machine. I am logged in as sean.ryan-B
3\. my laptop. I am logged in as sean.ryan
4\. the arcgis server.

All 4 machines are on the same domain.

web.config:
  <authentication mode="Windows"/>
   <identity impersonate="true" />  <!-- userName="EUROPE\sean.ryan-B" password="xxx" -->
  <authorization>
    <deny users="?"/>
  </authorization>

Test-1\. Opening a test page, in same web app as proxy, via the proxy:
http://myHost.com/sean/ProxyAsp.Net/ArcGisProxy.ashx?http://myHost.com/sean/ProxyAsp.Net
[ok on all boxes 1-3]

This looks OK - the impersonation seems look OK, 
since with impersonation OFF:    WindowsIdentity.GetCurrent().Name = the AppPool account
    with impersonation ON:    WindowsIdentity.GetCurrent().Name = EUROPE\sean.ryan or EUROPE\sean.ryan-B

Test-2\. opening an image that is hosted on the same IIS (but a different site), via the proxy:
http://myHost.com/sean/ProxyAsp.Net/ArcGisProxy.ashx?http://myHost.com:10400/sites/CaSPER/SiteAssets/CaSPER.jpg
[ok on boxes 1-3]

Test-3\. opening the ArcGIS map URL, via the proxy:
http://myHost.com/sean/ProxyAsp.Net/ArcGisProxy.ashx?http://mapserver1.com/ArcGIS/rest/services/Global/2D_BaseMap_SurfaceGeology/MapServer?f=json&callback=dojo.io.script.jsonp_dojoIoScript1._jsonpCallback
[fails on boxes 2,3 but succeeds on the proxy host (box 1)!]

code for the ASHX code-behind:

    public partial class ArcGisProxy : IHttpHandler, IReadOnlySessionState //ASHX     implements IReadOnlySessionState in order to be able to read from session
    {
        public void ProcessRequest(HttpContext context)
        {
            try
            {
                HttpResponse response = context.Response;

                // Get the URL requested by the client (take the entire querystring at once
                //  to handle the case of the URL itself containing querystring parameters)
                string uri = context.Request.Url.Query;
                uri = uri.Substring(1); //the Substring(1) is to skip the ?, in order to get the request URL.

                System.Net.HttpWebRequest req = (System.Net.HttpWebRequest)WebRequest.Create(uri);

                {
                    req.Credentials = CredentialCache.DefaultCredentials; //this works on local box, with -B account.  this is the account the web browser is running under (rather than the account logged into CaSPER with, as ASHX has separate server session).

                    req.ImpersonationLevel = TokenImpersonationLevel.Impersonation;
                }

                //to turn off caching: req.CachePolicy = new RequestCachePolicy(RequestCacheLevel.NoCacheNoStore);
                req.Method = context.Request.HttpMethod;
                req.ServicePoint.Expect100Continue = false;
                req.Referer = context.Request.Headers["referer"];

                // Set body of request for POST requests
                req.Method = "GET";

                // Send the request to the server
                System.Net.WebResponse serverResponse = null;
                try
                {
                    serverResponse = req.GetResponse();
                }
                catch (System.Net.WebException webExc)
                {
                    //logger.Log(GetMyUrl(), webExc, context.Request);

                    response.StatusCode = 500;
                    response.StatusDescription = webExc.Status.ToString();
                    response.Write(webExc.ToString());
                    response.Write(webExc.Response);
                    response.Write("Username = " + context.User.Identity.Name + " " + context.User.Identity.IsAuthenticated + " " + context.User.Identity.AuthenticationType);
                    response.End();
                    return;
                }

                // Set up the response to the client
                ....
                    ......

                response.End();
            }
            catch (Exception ex)
            {
                throw;
            }
        }

        public bool IsReusable
        {
            get
            {
                return false;
            }
        }
    } 
```

注意：以下更改意味着对地图服务器的代理请求确实成功：

a) 在 web.config 中设置身份，将用户名、密码显式设置为 sean.ryan-B 帐户：

-或者-

b) 将 App Pool 帐户设置为 sean.ryan-B 并在 web.config 文件中关闭模拟。

但是，这些更改对于生产来说是不可接受的。

问题似乎是： - ASP.NET 模拟对于托管在同一 IIS 上的测试页面 + 图像（测试 1 和 2）来说足够好，但对于地图服务器来说不够好。

据我所知，ArcGIS 地图服务器使用的是 Negotiate，然后是 Kerberos 身份验证。

使用 WireShark，我监测到一个成功的代理请求，发现：401 之后，代理使用 SPNEGO (Kerberos) 发送带有 AUTH 的 GET

有人对 ArcGIS 代理有类似的问题吗？

我的理论是，盒子 1 上的模拟“效果更好”，因为浏览器与代理在同一个盒子上运行。

是否可以限制 ArcGIS Server（或它正在使用的 IIS 站点）以防止接受模拟？

欢迎提出任何建议...... ps 很难通过这篇文章 - 必须将大部分内容格式化为代码，将其检测为源代码也是如此！

# asp.net - 动态设置用户控件属性

> ID：13292516
> 
> 赞同：0
> 
> 时间：2012-11-08T15:50:19.370
> 
> 标签：asp.net, vb.net, user-controls

我目前正在开发自定义角色/权限系统...

我已经拥有一个拥有所有权限的用户控件，我想将它重新用于我的自定义角色编辑器。

所以现在我有一个自定义角色的下拉列表和一个用于编辑名称的文本框。我想要做的是......每次在下拉列表中选择一个新值时，页面都会刷新并重新加载我的权限控件，并将 RoleID 和 RoleName 属性设置为 DDL.SelectedValue 和 textbox.Text 像这样...

```
<RSIPD:Permissions ID="Permissions" RoleID="[lstBaseRoles.SelectedValue]" RoleName="[txtCustomRoleName.Text]" runat="server" /> 
```

我知道我可能会以错误的方式解决这个问题，因为我比传统的 ASP.NET Webform 更熟悉 MVC3 并且仍在学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:54:21.903

这可以在后面的代码中完成：

```
Permissions.RoleID = lstBaseRoles.SelectedValue
Permissions.RoleName = txtCustomRoleName.Text 
```

`SelectedIndexChanged`在您的 DropDownList`TextChanged`事件和您的 TextBox 事件中需要调用此代码。

# c - 在 SDL 中设置 OGL 主要版本会导致错误

> ID：13292518
> 
> 赞同：0
> 
> 时间：2012-11-08T15:50:25.207
> 
> 标签：c, opengl, gcc, sdl, opengl-3

我目前正在尝试使用 C 来关闭 OpenGL。我有当前代码：

```
#include <stdio.h>
#include <stdlib.h>

#define null (void*)0

#define GL3_PROTOTYPES 1
#include <GL/gl3.h>

#include <SDL.h>
#define PROGRAM_NAME "Tutorial1"

void sdldie(const char *msg)
{
    printf("%s: %s\n", msg, SDL_GetError());
    SDL_Quit();
    exit(1);
}

void checkSDLError(int line)
{
    #ifndef NDEBUG
        const char *error = SDL_GetError();
        if(*error != '\0')
        {
            printf("SDL Error: %s\n", error);
            if(&line != null)
                printf(" + line: %i\n", line);
            SDL_ClearError();
        }
    #endif
}

int main(int argc, char *argv[])
{
    SDL_Window *mainwindow; //window handle
    SDL_GLContext maincontext; //opengl context handle

    if(SDL_Init(SDL_INIT_VIDEO) < 0)//initialize video subsystem
        sdldie("Unable to initialize SDL"); //DIE ON ERROR

    //request OGL 3.2 context (default to SDL core profile)
    SDL_GL_SetAttribute(SDL_GL_CONTEXT_MAJOR_VERSION, 3);
    SDL_GL_SetAttribute(SDL_GL_CONTEXT_MINOR_VERSION, 2);

    //turn on double buffering with a 24 bit Z buffer
    SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);
    SDL_GL_SetAttribute(SDL_GL_DEPTH_SIZE, 24);

    mainwindow = SDL_CreateWindow(PROGRAM_NAME, SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED,
    512, 512, SDL_WINDOW_OPENGL | SDL_WINDOW_SHOWN);
    if(!mainwindow)
        sdldie("Unable to create window");

    checkSDLError(__LINE__);

    //create an opengl context and attach it to the window
    maincontext = SDL_GL_CreateContext(mainwindow);
    checkSDLError(__LINE__);

    //VSync, turn it off later
    SDL_GL_SetSwapInterval(1);

    //clear buffer with red background
    glClearColor(1.0,0.0,0.0,1.0);
    glClear(GL_COLOR_BUFFER_BIT);
    //swap back buffer to the front
    SDL_GL_SwapWindow(mainwindow);
    //wait 2 secs
    SDL_Delay(2000);

    //repeat with green
    glClearColor(0.0,1.0,0.0,1.0);
    glClear(GL_COLOR_BUFFER_BIT);
    //swap back buffer to the front
    SDL_GL_SwapWindow(mainwindow);
    //wait 2 secs
    SDL_Delay(2000);

    //delete all dis shit
    SDL_GL_DeleteContext(maincontext);
    SDL_DestroyWindow(mainwindow);
    SDL_Quit();

    return 0;
} 
```

请注意我们选择 OGL 版本的那一行（在 main 中，在初始化视频之后）...当我按照此处的代码执行此操作时，我会遇到错误：

```
X Error of failed request:  GLXBadFBConfig
  Major opcode of failed request:  154 (GLX)
  Minor opcode of failed request:  34 ()
  Serial number of failed request:  166
  Current serial number in output stream:  165 
```

造成这种情况的行具体是：

```
SDL_GL_SetAttribute(SDL_GL_CONTEXT_MAJOR_VERSION, 3); 
```

当它被注释掉时，一切正常（但可能与另一个 OGL 版本 D:)

我正在使用最新版本的 FOSS Radeon 驱动程序（在 Arch 上）、SDL2.0 HG 版本、最新的稳定 GLX 和 gl3.h 已手动下载...在 arch linux 和 gcc 版本 4.7.2

知道为什么会发生这种情况（/如何摆脱它）吗？设置该属性是否必要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T11:49:38.993

SDL2 尚未发布，可能包含严重错误。在您的情况下，SDL_GL_CreateContext 中有一个错误。

2013 年 3 月 10 日提交了解决此问题的承诺：[SDL_GL_CreateContext() 导致致命的 X11 协议错误，而应该被捕获](http://lists.libsdl.org/pipermail/commits-libsdl.org/2013-March/006381.html)

我的成功创建了具有最新 SDL2 提交的 OpenGL 3.2 上下文。

# ios - 将一个字符串一起传递给一个 annotationView

> ID：13292519
> 
> 赞同：0
> 
> 时间：2012-11-08T15:50:25.737
> 
> 标签：ios, nsstring, mkannotation, mkannotationview

在我的地图中有很多 annotationView，每个都有自己的图像，annotationView 的数据取自数据库中的不同表。当我选择 un'annotationView 时，我想显示另一个 viewController，为此我需要传递表名，它是一个字符串。我如何能？我试过了，但我得到了这个错误：

```
 No know instance method for selector 'setNameTable:' 
```

这是 MapViewController.m 中的代码

```
 - (MKAnnotationView *)mapView:(MKMapView *)mapview viewForAnnotation:(id 
   <MKAnnotation>)annotation
  {
      //....

      if ([annotation isKindOfClass:[AnnotationCustom class]]){

       static NSString* AnnotationIdentifier = @"AnnotationIdentifier";

      MKPinAnnotationView *annotationView = (MKPinAnnotationView*) [mapView 
                   dequeueReusableAnnotationViewWithIdentifier:AnnotationIdentifier];

       annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation
                                                  reuseIdentifier:AnnotationIdentifier];  

      if ([self.name isEqualToString:@"MyTable"]){

            if(UI_USER_INTERFACE_IDIOM()== UIUserInterfaceIdiomPhone){
                annotationView.image = [UIImage imageNamed:@"iphone_myTable.png"];

               [annotationView.annotation setNameTable:[NSString 
                   stringWithFormat:self.name]]; //the error is here
               //nameTable is a property of AnnotationCustom class 

            }else{
                annotationView.image = [UIImage imageNamed:@"ipad_myTable.png"];

                [annotationView.annotation setNameTable:[NSString 
                   stringWithFormat:self.name]];//the error is here
                 //nameTable is a property of AnnotationCustom class 

            }

          //.......

       } 
```

在委托方法中，我必须传递字符串

```
 - (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view 
    calloutAccessoryControlTapped:(UIControl *)control{

      AnnotationCustom *customAnnotation = (AnnotationCustom *)view.annotation;
     [customAnnotation setNameTable:[NSString stringWithFormat:@"%@",self.name]];

     NSLog(@"The name table is  %@",customAnnotation.nameTable); 
     /*the name is wrong, the string self.name is relative to last table open and not the 
      table  selected */

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:03:18.750

尽管强制转换可以让您访问自定义属性和方法，但您通常不应在委托方法中对对象*设置*属性或调用方法。`annotation``viewForAnnotation`

由于您还尝试将属性设置为某个*类实例级别的*值 ( `self.name`)，因此也不能保证其值与`annotation`当前调用的委托方法同步。

您应该做的是在创建注释时和调用or之前**设置注释的属性**。`addAnnotation``addAnnotations`

稍后，在委托方法（例如`calloutAccessoryControlTapped`）中，您可以再次使用强制转换检索自定义属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T12:21:11.020

我设法解决了这个问题。我在委托方法中向 annotationView 添加了强制转换：

```
 - (MKAnnotationView *)mapView:(MKMapView *)mapview viewForAnnotation:(id 
  <MKAnnotation>)annotation
  {
          //....
        static NSString* AnnotationIdentifier = @"AnnotationIdentifier";

        MKPinAnnotationView *annotationView = (MKPinAnnotationView*) [mapView 
               dequeueReusableAnnotationViewWithIdentifier:AnnotationIdentifier];

       annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation
                                              reuseIdentifier:AnnotationIdentifier];

       //I add in this position the cast
      AnnotationCustom *customAnnotation = (AnnotationCustom *)annotationView.annotation;

      if ([self.name isEqualToString:@"myTable"]){

            if(UI_USER_INTERFACE_IDIOM()== UIUserInterfaceIdiomPhone){
                annotationView.image = [UIImage imageNamed:@"iphone_myTable.png"];
                customAnnotation.nameTable = self.name; //I assign this the property

           }else{
                annotationView.image = [UIImage imageNamed:@"ipad_myTable.png"];
                customAnnotation.nameTable = self.name; //I assign this the property

            }
      }
           //.......
   } 
```

在另一个委托方法中：

```
 - (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view 
        calloutAccessoryControlTapped:(UIControl *)control{

        AnnotationCustom *customAnnotation = (AnnotationCustom *)view.annotation;

        NSLog(@"The name Table is %@",customAnnotation.nameTable);      
        //the result is correct
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:54:56.443

annotationView 对象的 annotation 属性属于 MKAnnotation 类，它对“nameTable”属性一无所知。

尝试这个：

```
AnnotationCustom *annotationCustom= (AnnotationCustom *)annotation;
[annotationCustom setNameTable:[NSString stringWithFormat:self.name]; 
```

# gwt - GWT：如何知道我的列表框选择的索引是否已更改

> ID：13292523
> 
> 赞同：1
> 
> 时间：2012-11-08T15:50:43.717
> 
> 标签：gwt

我有一个列表框，它有两个值 value1 和 value 2 ..

现在我的列表框值以编程方式更改（我不手动更改值）

我想在我的列表框中每当值更改/索引更改时得到提示

```
 ListBox listBox = new LisBox(); 
```

如果我使用

```
 listBox.addClickHandler 
```

或者

```
 listBox.addChangeListener 
```

或 listBox.addChangeEvent

当我手动更改列表框选择的索引时，它们都只向我显示提示。但是当我的列表框 selectedIndex 以编程方式更改时，我将如何获得提示

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T07:33:29.317

我假设您正在使用

```
setSelectedIndex 
```

[javadoc](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/user/client/ui/ListBox.html#setSelectedIndex%28int%29)明确表示它不会发送事件。您可以覆盖 setSelectedIndex 并发送您自己的事件。可以在[这里](https://stackoverflow.com/questions/2951621/gwt-custom-events)找到这样做的一个很好的解释。

# javascript - 与 setInterval() 冲突的动画

> ID：13292534
> 
> 赞同：2
> 
> 时间：2012-11-08T15:51:21.737
> 
> 标签：javascript, jquery, jquery-animate, overlay, setinterval

我制作了一些脚本来在我的网站上进行倒计时，它会在所有截止日期课程上循环并更改时钟。

这是代码

```
self.setInterval(function(){
$('.deadline_container').each(function(){
    days = parseInt($(this).children('.deadline_days').html(),10);
    time = $(this).children('.deadline_time').html().split(':');
    hours = parseInt(time[0],10);
    minutes = parseInt(time[1],10);
    seconds = parseInt(time[2],10);
    if(seconds > 0){
        seconds -= 1;
    } else if(minutes > 0){
        minutes -= 1;
        seconds = 59;
    } else if(hours > 0){
        hours -= 1;
        minutes = 59;
        seconds = 59;
    } else if(days > 0){
        days -= 1;
        hours = 23;
        minutes = 59;
        seconds = 59;
    }
    sec = (seconds < 10) ? '0' + seconds : seconds;
    min = (minutes < 10) ? '0' + minutes : minutes;
    hh = (hours < 10) ? '0' + hours : hours;
    $(this).children('.deadline_days').html(days);
    $(this).children('.deadline_time').html([hh,min,sec].join(':'));
});
}, 1000); 
```

我也有一些代码可以在悬停时在 div 上显示覆盖

```
$('.someDivClass').live({
    mouseover: function() {
        $(this).children('.background').children('.overlay').stop().animate({opacity:"1"}, 300);
    },
    mouseout: function() {
         $(this).children('.background').children('.overlay').stop().animate({opacity:"0"}, 300);
    }
}); 
```

这两段代码效果很好，动画没有任何问题，问题是当间隔运行并且我将其中一个带有覆盖的 div 悬停时，覆盖动画会冻结，直到倒计时一秒钟。有时看起来好像没有动画，只是突然出现了覆盖。有时看起来不错，这完全取决于我悬停 div 的那一刻。我认为 setInterval 函数会停止动画队列，直到它停止执行自己的代码。

我认为 jquery 或类似的东西上没有线程。

所以问题是：

¿如何在不依赖时钟间隔的情况下使我的叠加动画平滑？

¿ 是否有更有效的方法来制作倒计时或叠加动画？

我正在使用 jquery 1.8.2 和 jQuery UI 1.9.0

**编辑**

我之前没有意识到，我也有一个不透明度的变化，像这样：

```
$('#top_bar, #top_bar_container').hover(
    function(event){
        $(this).stop().animate({backgroundColor:"rgba(0,0,0,0.5)"}, 300);
    },
    function(event){
        $(this).stop().animate({backgroundColor:"rgba(0,0,0,0.2)"}, 1000);
    }
); 
```

无论如何，该动画运行流畅！
所以它可能是实时功能（我在使用 AJAX 向页面添加内容时需要它）或背景动画的不透明动画（在 CPU 方面可能更昂贵）

任何帮助将不胜感激，谢谢。

**编辑**
这是我的 DOM

```
<div class="someDivClass">
    <div class="background">
        <div class="overlay">
            <div class="deadline">
                <div>Time Left</div>
                <div class="deadline_container">
                    <div class="deadline_days">14</div>
                    <div class="deadline_time">23:20:51</div>
                    <div style="clear:both;"></div>
                </div>
            </div>
        </div>
    </div>
</div> 
```

我的页面上有很多这样的容器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T16:32:39.197

我解决了这个问题。
实际上，这不是 jQuery animate 或 javascript setInterval() 问题，而是 Google Chrome 本身。

我试过这个：

正如[菲利普](https://stackoverflow.com/users/687901/philipp)所说，我将第一个代码更改为 setTimeout()

我将 .live() 更改为 $(document).on('mouseover', '.someDivClass', function(){...});

但是这些都没有解决问题，所以在这里和那里测试我优化了我网站上的图像，它已经解决了！

我认为会发生什么：
Chrome 在 LARGE 图像上渲染具有不透明背景的动画 div 时出现问题，因为当我将 .background 类图像变小时，动画滞后消失了。

我在 Firefox 15.0.1 上测试了我一开始的代码，完全没有滞后。

无论如何，感谢您的回答，我不再有动画问题了

# mysql - 通过关联查找所有无关联

> ID：13292535
> 
> 赞同：0
> 
> 时间：2012-11-08T15:51:26.897
> 
> 标签：mysql, ruby-on-rails, join, associations

```
class Campaign < ActiveRecord::Base
  has_many :posts
  has_many :users
end

class Post < ActiveRecord::Base
  has_and_belongs_to_many :users
  belongs_to :campaign
end

class User < ActiveRecord::Base
  has_and_belongs_to_many :posts, :join_table => "users_posts"
  belongs_to :campaign
end 
```

如果用户看到这篇文章，我会将他添加到 post.users。我需要找到第一个未观看的用户活动帖子。像这样：

```
current_user.campaign.posts.where('posts.users not include current_user') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:46:33.880

Yoshiji 先生，非常感谢！你还记得我`include`。在我尝试之前`join`它不适用于 nil 因为`INNER JOIN`，我用实例方法解决了我的问题：

```
 def unwatched_post
    campaign.posts.includes(:users).where('users.id != ? OR users.id IS NULL', self.id).first
  end 
```

# python - 将奇怪的日期格式转换为标准日期格式

> ID：13292538
> 
> 赞同：1
> 
> 时间：2012-11-08T15:51:36.313
> 
> 标签：python, mysql, date, format

在瑞典，我们有时会使用一种奇怪的日期格式，例如新年是 31/12。如果我将此格式作为字符串，可以是 1/1 和 31/12 之间的任何日期，如果我们假设是今年，我如何使用 Python 进入标准日期格式（格式为 2012-01 -01 和 2012-12-31）可以作为日期存储在 mySQL 数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:54:22.553

只需拆分这两个值，将它们映射到整数并更新一个`datetime.date()`实例：

```
import datetime
day, month = map(int, yourvalue.split('/'))
adate = datetime.date.today().replace(month=month, day=day) 
```

通过使用`datetime.date.today()`我们得到当前年份。

演示：

```
>>> import datetime
>>> somevalue = '31/12'
>>> day, month = map(int, somevalue.split('/'))
>>> datetime.date.today().replace(month=month, day=day)
datetime.date(2012, 12, 31)
>>> someothervalue = '1/1'
>>> day, month = map(int, someothervalue.split('/'))
>>> datetime.date.today().replace(month=month, day=day)
datetime.date(2012, 1, 1) 
```

或者，您可以使用该[`datetime.strptime()`方法](http://docs.python.org/2/library/datetime.html#datetime.datetime.strptime)来解析这些日期，但之后您必须手动更正年份（如果没有解析年份，它将使用 1900 作为默认值）：

```
adate = datetime.datetime.strptime(yourvalue, '%d/%m').date()
adate = adate.replace(year=datetime.date.today().year) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:12:51.337

这种格式没有什么奇怪的:)

您可以使用该`datetime`模块：

```
import datetime
d = datetime.datetime.strptime('31/12', '%d/%m').date().replace(year=2012)
print d

>> datetime.date(2012, 12, 31) 
```

# javascript - document.ready() 和其他已定义函数中的局部变量

> ID：13292542
> 
> 赞同：0
> 
> 时间：2012-11-08T15:51:44.477
> 
> 标签：javascript, jquery, scope

在 jQuery 中，您可以对各种页面和其他事件进行多次调用，如下所示：

```
$(document).ready(function() { 
```

并且您可以在此过程中添加多个“就绪”函数定义，而不仅限于一个。当然，这有助于将代码定义在靠近使用它的位置。

我的问题是，如果我在其中一个`document.ready`函数声明中声明了一个局部变量 using `var`，它是否可以在`document.ready`页面也使用的另一个函数声明中使用？

我不确定 jQuery 在这样的情况下是如何工作的；它是否以某种方式将各种函数的作用域编织在一起，或者当触发就绪事件时这些函数中的每一个都以独立的方式运行，每个函数都不知道其他函数的变量。（我猜是第二个。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T15:53:09.217

> 我的问题是，如果我在其中一个`document.ready`函数声明中声明了一个局部变量 using `var`，它是否可以在`document.ready`页面也使用的另一个函数声明中使用？

不，它们是您传入的函数的局部变量`document.ready`。

> 我不确定 jQuery 在这样的情况下是如何工作的；它是否以某种方式将各种函数的作用域编织在一起，或者当触发就绪事件时这些函数中的每一个都以独立的方式运行，每个函数都不知道其他函数的变量。（我猜是第二个。）

你是对的。:-) 事实上，jQuery*不能混合*函数的执行上下文，它们是由 JavaScript 引擎管理的。

但是，您可以通过将它们全部放在容器函数中来使它们都共享一个父执行上下文：

```
(function() {
    // Shared by all functions within this block
    var foo = 42;

    // ...

    $(document).ready(function() {
        if (foo === 42) {
            // ...
            --foo;
        }
    });

    // ...

    $(document).ready(function() {
        if (foo > 0) {
            // ...
            --foo;
        }
    });

})(); 
```

我不认为我会提倡拥有多个`ready`处理程序（或者甚至是一个，真的），除非你正在编写一个库。但这是一个不同的话题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T15:55:42.763

不，不会的。每个`$(document).ready`人都会定义自己的范围。如果您需要两者都可见的东西，您可以将其设为全局，或`$(document).ready`在另一个闭包中定义所有内容（例如，使用自调用函数）。

# android - 由于同一应用程序中的另一个活动与单独的应用程序/设备中断导致活动失去焦点

> ID：13292547
> 
> 赞同：0
> 
> 时间：2012-11-08T15:52:22.737
> 
> 标签：android, android-activity

仅当整个应用程序失去焦点（例如来电或主页键）时，我才需要记录事件。

从外部事件而不是同一应用程序中的另一个 Activity 中判断 Activity 已暂停或停止的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T18:47:39.910

当您的活动停止时，您可以在该方法中检查您的应用程序是否仍在顶部`onStop()`：

```
private boolean isAppOnTop(){
    ActivityManager am = (ActivityManager) getSystemService(Service.ACTIVITY_SERVICE); 
    List<ActivityManager.RunningTaskInfo> tasks; 
    tasks = am.getRunningTasks(1); 
    RunningTaskInfo running = tasks.get(0);
    if(running.topActivity.getPackageName().equals("your.package.name")){
        return true;
    }
    else{
        return false;
    }
} 
```

该方法首先查询所有正在运行的任务。通常，具有焦点的任务位于堆栈顶部。检查此任务是否属于您的包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T17:38:33.167

因此，如果您愿意设置 get_tasks 权限，丹尼斯的回答是完全有效的，我们探索了以下选项（主要基于在调用 onstop/onpause 时设置某种标志）：

*   开始新活动时。在 onStop 方法中，如果标志设置为 true，则中断是由应用程序中的新活动引起的。

*   有一个统计活动视图的全局变量。onStarts 的增量和 onStops 的减量。如果它为 0，那么我们没有可见的活动。

*   onStart 为活动设置一个活动标志为真。onStop 将标志设置为 false。（状态也可以保存到首选项）。当活动失去焦点时，我们可以检查所有标志。

因为该应用程序相对简单，我们选择了第一个选项。

# php - 具有相同值的 html 单选框

> ID：13292549
> 
> 赞同：0
> 
> 时间：2012-11-08T15:52:32.277
> 
> 标签：php, javascript, html, mysql

我有这样的事情：

```
form.innerHTML='<form name="reg" >
    Register:<br/>User Name: <input name="un"><br/>
    Password: <input name="pw" type="password"><br/>
    E-mail: <input type="email" name="email" ><br/> 
    Sex:<br/><input type="radio" id="sxf" name="sex" value="f"> <label for =  "sxf">Female</label><br/>
             <input type="radio" id="sxm" name="sex" value="m" checked = "checked" >
             <label for = "sxm">Male</label><br/>
             <input type="button" value="Register" onClick="accnew()"> 
</form>'; 
```

但是，当我将表单发送到 MYSQL 时，都返回了“f”，但是有不同的值，不是吗？当我用js提醒它时，它也给了我所有的“f”

编辑： accnew() js 方法：

```
if (window.XMLHttpRequest){
var xmlhttp=new XMLHttpRequest();
}
else{
var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function()
{
if (xmlhttp.readyState==4 && xmlhttp.status==200)
{..................
xmlhttp.open("GET","new_acc.php?un="+un+"&pw="+pw+"&email="+em+"&group1="+$('[name=sex]').val(),true);
xmlhttp.send(); 
```

只是一个xmlHTTPrequest。我尝试使用 jquery，但它也没有工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:14:30.177

通过使用 $('[name=sex]').val() jquery 返回第一个找到的对象并提供选择器；所以你仍然有'f'作为返回值

[您必须通过添加一个 ':checked' （参见http://api.jquery.com/checked-selector/](http://api.jquery.com/checked-selector/)）选择器来更改您的选择器：

```
 $('input:checked[name="sex"]').val() 
```

阿纳斯

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T16:10:13.543

输出代码的 XHTML 存在几个问题。（请注意，我假设您打算输出为 XHTML，因为您的中断标记被编码为`<br/>`。）

1.  您有不允许使用的空间。
2.  “电子邮件”的输入类型仅在 HTML5 中有效。对您来说可能不是问题，但请注意。

所以，尝试这样的事情......

```
form.innerHTML='<form name="reg" action="page.html" method="get">Register:<br/>User Name: <input name="un" /><br/>Password: <input name="pw" type="password" /><br/>E-mail: <input type="text" name="email" /><br/> Sex:<br/><input type="radio" id="sxf" name="sex" value="f" /><label for="sxf">Female</label><br/><input type="radio" id="sxm" name="sex" value="m" checked="checked" /><label for="sxm">Male</label><br/><input type="submit" value="Register" /> </form>'; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-08T16:33:49.577

正如 Shikyo 所建议的，您在标签的 HTML 中插入了一个标签，因此它应该会产生如下结果：

```
<form>
<form name="reg"  >Register: 
```

当然这不起作用，您应该获取包含表单的父标签，然后执行以下操作：

```
parent_of_form.innerHTML='
<form name="reg" method="POST" action="somewhere.php" onsubmit="return accnew()">
Register:<br/>
User Name: <input name="un"/><br/>
Password: <input name="pw" type="password"/><br/>
E-mail: <input type="email" name="email" /><br/> 
Sex:<br/>
<input type="radio" id="sxf" name="sex" value="f"/> Female<br/>
<input type="radio" id="sxm" name="sex" value="m" CHECKED/>Male<br/>
<input type="submit" value="Register"/> 
</form>'; 
```

我在这里更改了一些标签：

1- 我假设您想使用 accnew() 函数验证表单，所以我将“onsubmit”添加到表单并将注册按钮更改为提交按钮。这将确保您在提交表单之前使用 accnew() 函数返回“true”。

2-标签标签并不是真正需要的，所以我删除了它们，但如果你想保留它们也没关系。

3- checked="checked" 不起作用，您必须将 CHECKED 添加到输入标签的末尾。

# css - Internet Explorer 负边距未按预期工作

> ID：13292551
> 
> 赞同：4
> 
> 时间：2012-11-08T15:52:42.263
> 
> 标签：css, internet-explorer, margins, overlapping, margin

为我的教会创建网站的人说没有办法解决这个问题，我们不应该担心它。但我认为他错了，我正在尝试自己解决。我的编码背景是 C++ 和 Cobol，但不是真正的 CSS。我正在学习，所以这里的任何帮助都会很棒。

该站点使用 Joomla，位于：[http ://www.anointedesign.com/mtvernon/site2/](http://www.anointedesign.com/mtvernon/site2/)

它在 Firefox 和 Chrome 中看起来不错，但在 Internet Explorer 中，顶部标题框和幻灯片之间的顶部存在巨大差距。我相信这是处理负边距值的方式的 IE 问题，但我可能离这里很远，需要帮助。

整个顶部导航、徽标和印章应该非常靠近幻灯片，到左侧印章应该与幻灯片重叠约 15 像素的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:12:50.417

这个css代码将修复它：

```
#horiz-menu {
float: left;
width: 100%;
margin-bottom: -110px;
}

#header-bg > div.wrapper {
clear: both;
}

#showcase-section {
margin-top: 0;
} 
```

该问题是由水平菜单 div 内的浮动和清除引起的。IE 不喜欢带有那种 CSS 代码的 div。:)

# objective-c - 禁用在 JetBrains AppCode 中添加匹配的方括号

> ID：13292554
> 
> 赞同：7
> 
> 时间：2012-11-08T15:52:47.383
> 
> 标签：objective-c, ide, appcode

如何在键入右方括号“]”时禁用添加匹配的左方括号“[”字符？

我尝试了各种智能钥匙选项的组合，但没有一个能达到我想要的效果。当我键入左括号“[”时，我可以禁用自动添加右括号“]”，但反之则不行。

例子：

我有以下行：

```
if ([myObject respondsToSelector:@selector(outline)]) 
```

我的光标在 ')' 和 ']' 字符之间。当我输入 ']' 这就是我得到的：

```
if ([myObject respondsToSelector:[@selector(outline) ]]) 
```

我希望现有的 ']' 将被我键入的内容覆盖，或者至少不会添加新的 '['。

我正在使用 AppCode 1.6.2 和 IdeaVIM 插件。

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-08-01T21:50:14.853

在“文本编辑”选项卡下的 XCode 首选项中，有一个“在 Objective-C 方法调用选项中自动平衡括号”。取消选中该框。

# oracle11g - 在 oracle 查询中找不到特定值的记录类型

> ID：13292557
> 
> 赞同：0
> 
> 时间：2012-11-08T15:52:55.567
> 
> 标签：oracle11g

我有这个查询

```
Select distinct p_id, p_date,p_city 
  from p_master 
 where p_a_id in(1,2,5,8,2,1,10,02) 
```

我的`IN`子句包含 200 个值。我如何知道查询未返回哪些。子句中的每个值都`IN`可能有记录，在某些情况下它们没有。我想知道没有为任何选定`p_a_id`类型找到的所有记录。

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:51:00.837

这可以解决问题，但我相信有一种更简单的方法可以找到它:-)

```
with test1 as 
(select '1,2,5,8,2,1,10,02' str from dual)
select * from (
select trim(x.column_value.extract('e/text()')) cols 
   from test1 t, table (xmlsequence(xmltype('<e><e>' || replace(t.str,',','</e><e>')|| '</e></e>').extract('e/e'))) x) cols 
   left outer join 
 (Select count(*), p_a_id from p_master where p_a_id in (1,2,5,8,2,1,10,02) group by p_a_id) p
 on p.p_a_id = cols.cols
 where p_a_id is null
 ; 
```

# jquery - jQuery自动完成传递文本框值

> ID：13292565
> 
> 赞同：0
> 
> 时间：2012-11-08T15:53:12.820
> 
> 标签：jquery, autocomplete

尝试[对 jQuery 版本 1.1.5 使用 Ajax 自动完成功能，](http://www.devbridge.com/projects/autocomplete/jquery/)并且可以通过对值进行硬编码来使其工作，但这似乎并不是您需要自动完成功能的原因。

下面的作品，但我真的很想知道我是如何做到的，所以它只需要`q`文本框中的内容。我试过`jQuery("q").val()`了，但效果不佳。

```
 <input name="q" type="text" maxlength="30" id="q" class="searchtextbox" />
  var ac = jQuery("#q").autocomplete({
            serviceUrl: 'autocomplete.ashx',
            minChars: 2,
            maxHeight: 400,
            width: 300,
            zIndex: 9999,
            deferRequestBy: 0, 
            // callback function:
            onSelect: function (value, data) { alert('You selected: ' + value + ', ' + data)}
        });

        ac.enable();
        ac.setOptions({ params: { product_startsWith:'palm' } }); 
```

# c# - c#带分隔符的括号中单词的正则表达式

> ID：13292567
> 
> 赞同：0
> 
> 时间：2012-11-08T15:53:18.313
> 
> 标签：c#, regex

我需要解析文本并检查所有方括号之间是否为 a`-`并且前后`-`必须至少为一个字符。我尝试了以下代码，但它不起作用。匹配数太大。

```
Regex regex = new Regex(@"[\.*-.*]");
MatchCollection matches = regex.Matches(textBox.Text); 
```

示例文本：

```
Node
  (Entity [1-5]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:01:26.847

想我不妨提供一个答案......重申我的观点（有修改）：

1.  `*`匹配 0 次或多次出现。你可能想要+。
2.  方括号是特殊字符，需要转义。它们用于定义字符集。
3.  您可能希望从“任何字符”匹配中排除`[`和`]`

把这一切放在一起，以下应该会更好：

```
Regex regex = new Regex(@"\[[^-[\]]+-[^[\]]+\]"); 
```

虽然它有点乱，但关键是这`[^[\]]`意味着除了方括号之外的任何字符。`[^-[\]]`意味着但也不允许`-`。这是一种优化，不是必需的，但它只是减少了正则表达式引擎在计算匹配时必须做的工作。感谢 ridgerunner 指出这一优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T15:56:01.310

方括号在正则表达式中意味着一些特殊的东西，你需要将它们转义。此外，如果您想要**至少一个**字符，那么您需要使用`+`而不是`*`.

```
Regex regex = new Regex(@"\[.+-.+\]");
MatchCollection matches = regex.Matches(textBox.Text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:04:41.357

```
 string txt = "(Entity [1-5])";
 Regex reg = new Regex(@"\[.+\-.+\]"); 
```

如果是#：

```
 string txt = "(Entity [1-5])";
 Regex reg = new Regex(@"\[\d+\-\d+\]"); 
```

# php - 我如何才能找到所有内容，直到 PHP 中的其他内容并将其作为字符串返回？

> ID：13292568
> 
> 赞同：0
> 
> 时间：2012-11-08T15:53:20.767
> 
> 标签：php, url-rewriting, preg-replace, seo

我想从我的 URL 中返回这些唯一值

```
394_black
500_mono2 
```

网址：

```
/shop/swarovski/394_black_the-reagan-swarovski-maxi-dress
/shop/celeb/500_mono2_the-reagan-swarovski-maxi-dress 
```

我可以在 PHP 中执行此操作吗？

伪代码

```
$url    =       get url
$firstvar = after 3rd / and after second _ save text (500_mono2) from $url

$secondvar = using $firstvar return only first 3 numbers
//substr($firstvar, 0, 3);  (I think this will be it) 
```

# 更新了我上面的问题，更容易理解

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:03:10.367

```
<?php

    $url = '/shop/celeb/500_mono2_the-reagan-swarovski-maxi-dress';
    $urlparts = explode('/', $url);

    list($var1, $var2, $var3) = explode('_', end($urlparts));

    echo $var1 . '<br>' . $var2 . '<br>' . $var3;

?> 
```

# javascript - 创建自定义 d3 布局

> ID：13292573
> 
> 赞同：12
> 
> 时间：2012-11-08T15:53:36.727
> 
> 标签：javascript, layout, d3.js, treemap

我需要创建一个自定义 d3 布局，它有点接近树形图，但采用三角形样式。这是一个屏幕截图，您可以理解： ![在此处输入图像描述](../Images/d633aeef1faab36b504a1b509417eb91.png) [金字塔布局](http://imageshack.us/photo/my-images/407/captureuec.jpg/)

如您所见，它工作得非常整洁，符合我的需要。为了编写代码，我将代码基于树形图布局代码：

```
d3.layout.pyramid= function () {
    var hierarchy = d3.layout.hierarchy(), round = Math.round, size = [ 1, 1 ], padding = 0;

    function populate (nodes, currentHeight, currentHeightPadded, currentBase, currentSumedWeight) {
       ...
    }

    function populate_layers (layer, nodes,currentHeight,currentLength, currentSumedArea,currentSumedWeight) {
       ...
    }

    function pyramid(d) {
       var nodes = hierarchy(d), root = nodes[0];

       populate(root.children.slice(),0,0,0,0);
       return nodes;
    }  

    pyramid.padding = function(x) {
       if (!arguments.length) return padding;
       padding = x;
       return pyramid;
    };

    pyramid.size = function(x) {
       if (!arguments.length) return size;
       size = x;
       return pyramid;
    };

    return d3_layout_hierarchyRebind(pyramid, hierarchy);
}; 
```

我的问题是，要这样做，我必须直接编辑`d3.v2.js`文件，因为在我的情况下，无法从 outisde 访问某些私有函数`d3_layout_hierarchyRebind`。显然，我知道这根本不是最佳实践，但我无法将我的文件外部化到单独的脚本中，因为`d3_layout_hierarchyRebindis`从外部看不到。

我不知道这是否是 d3 或 javascript 相关的问题，但我想知道您是否可以帮我解决这个小问题。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T01:25:06.527

只需将 d3.layout.pyramid 函数复制并粘贴到一个新文件中，并根据需要重命名函数，这样它就不会与 d3 库冲突。可能所有内容都是私有的，因此只有最外层的函数需要重命名。您可能不必将其命名为“d3”。也就是说，这应该工作：

```
var myPyramidLayout = function () {
    ...
} 
```

# php - PHP $_POST 错误

> ID：13292576
> 
> 赞同：0
> 
> 时间：2012-11-08T15:53:43.483
> 
> 标签：php, forms, post, undefined

我收到 $_POST['str'] 的以下错误：

> 注意：未定义索引：第 12 行 C:\Program Files\EasyPHP-5.3.8.0\www\strrev.php 中的 str

我花了太多时间来找到答案，但没有运气！请看一下代码，让我知道它有什么问题？

```
<html>
<head>
<title></title>
</head>
<body>
  <?php 
    if (trim($_POST['str'])) {
      $str = $_POST['str'];
  $len = strlen($str);
      for($i=($len-1); $i>=0;$i--) {
      echo $str[$i];
      } 
} else {
  ?>
<form method="post" action="">
    <input type="text" name="str" />
    <input type="button" name="submit" value="Reverse" />
    </form>
    <?php
  }
  ?>
</body>
</html> 
```

它在错误旁边显示文本字段和反转按钮。而且当我按下按钮时，什么也不会发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T15:55:41.870

更改`if (trim($_POST['str']))`为`if (!empty($_POST['str']))`

您的`if`语句试图修剪不存在的数组索引，因此出现错误。您必须先检查您的索引是否存在。

如果有人想知道 - 我使用, 暗示（或至少，我从中推断）包含空字符串的正确集合是不可接受的，`empty`而不是`isset`作为 OP 。但是，这不会解决包含一堆空格的情况。`trim``$_POST['str']``$_POST['str']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:14:32.643

$str 不一定是数组。为了循环它，它需要是一个数组。它只是从 $_POST['str'] 复制该值，所以当您发布帖子时

确保它是一个数组

```
if (is_array($str)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T15:58:00.637

您没有检查 POST 是否实际发生：

```
<html>
...
<?php
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
   if ($_POST yada yada yada) {
       ...
   }
}
?>

<form action="" method="POST">
...
</form>

...

</html> 
```

# vb.net - 理解一段代码

> ID：13292581
> 
> 赞同：4
> 
> 时间：2012-11-08T15:53:54.660
> 
> 标签：vb.net, vb6

我做 C#，没有使用 VB 的经验，也没有安装任何 VB。我一直在查看下面的代码以了解它是如何工作的，有人可以看看吗？

`Cat`因此，如果我用and调用此方法`cat`并且不传递可选参数，它是否返回 true 并表示`Cat`and`cat`相等？

```
Public Function AreStringsEqual(ByRef sString1 As String, ByRef sString2 As String, Optional ByVal eCompareMethod As VbCompareMethod = vbBinaryCompare) As Boolean

  If LenB(sString1) = LenB(sString2) Then
    If LenB(sString1) = 0 Then
      AreStringsEqual = True
    ElseIf eCompareMethod = vbBinaryCompare Then
      AreStringsEqual = (InStrB(1, sString1, sString2, eCompareMethod) <> 0)
    Else
      AreStringsEqual = (StrComp(sString1, sString2, eCompareMethod) = 0)
    End If
  End If
End Function 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T15:56:02.307

这是一些奇怪的代码。无论如何，第三个参数的默认值是`vbBinaryCompare`这意味着`"Cat"`并且`"cat"`将比较*不相等*。要让它们比较相等，您需要通过`vbTextCompare`.

现在这就是代码奇怪的原因：它完全是多余的。你可以直接打电话`StrComp`。

# objective-c - NSPredicate 与 FUNCTION 不工作

> ID：13292582
> 
> 赞同：2
> 
> 时间：2012-11-08T15:53:57.253
> 
> 标签：objective-c, ios, core-data, nspredicate, cllocation

我的谓词不断使我的应用程序崩溃，并显示消息 Unsupported function expression `FUNCTION(SELF, "filterDistanceWithLatitude:" , latitude, longitude`）。有谁知道如何解决这一问题？

```
- (void)setUpFetchedResultsController
{
    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"NextTime"]; //Retrieve data for the place entity
    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)]]; //How to sort it
    self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:self.context sectionNameKeyPath:nil cacheName:nil]; //Puts the data in a NSFetchedResultsController which is oddly located in CoreDataTableViewController //Puts the data in a NSFetchedResultsController which is oddly located in CoreDataTableViewController
    self.filtered = self.fetchedResultsController.fetchedObjects;
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"FUNCTION(self, 'filterByDistanceWithLatitude:', latitude, longtitude) > 20"];
    self.filtered = [self.filtered filteredArrayUsingPredicate:predicate];
}

- (double)filterByDistanceWithLatitude:(NSNumber *)latitude andLongitude:(NSNumber *)longitude
{
    CLLocationDegrees latitudeCoor = [latitude doubleValue]; //Puts the latitude into a NextTime object.
    CLLocationDegrees longitudeCoor = [longitude doubleValue]; //Puts the longtitude into a NextTime object.

    CLLocation *loc1 = [[CLLocation alloc] initWithLatitude:latitudeCoor longitude:longitudeCoor];
    CLLocation *loc2 = [[CLLocation alloc] initWithLatitude:self.currentLocation.latitude longitude:self.currentLocation.longitude];

    NSNumber *distance = [[NSNumber alloc] initWithDouble:[loc1 distanceFromLocation:loc2]];

    return [distance doubleValue];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:05:43.747

（基于 SQL 的）Core Data 存储的获取请求不能使用基于 Objective-C 的谓词或排序描述符。您只能过滤存储在数据库中的属性。

以下是“核心数据编程指南”中的相关文档：

*   [获取托管对象](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdFetching.html#//apple_ref/doc/uid/TP40002484-SW3)：

> 您不能使用基于瞬态属性的谓词进行获取（尽管您可以使用瞬态属性自己在内存中进行过滤）。...总而言之，如果您直接执行 fetch，则通常不应将基于 Objective-C 的谓词或排序描述符添加到 fetch 请求中。相反，您应该将这些应用于获取的结果。

*   [获取谓词和排序描述符](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdPersistentStores.html#//apple_ref/doc/uid/TP40002875-SW11)：

> 获取和存储类型之间存在一些交互。...另一方面，SQL 存储将谓词和排序描述符编译为 SQL，并在数据库本身中评估结果。这样做主要是为了性能，但这意味着评估发生在非 Cocoa 环境中，因此依赖 Cocoa 的排序描述符（或谓词）无法工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:04:32.780

'filterDistanceWithLatitude:' 可能应该是 'filterByDistanceWithLatitude:'

# iphone - 重置 ABAddressBookGetAuthorizationStatus

> ID：13292584
> 
> 赞同：1
> 
> 时间：2012-11-08T15:54:06.173
> 
> 标签：iphone, objective-c, xcode, ios6

我目前正在开发一个可以访问用户通讯录的应用程序。第一次在我的设备上尝试该应用程序时，我得到了 ABAddressBookGetAuthorizationStatus 警报显示和工作。我的问题是，现在我想调试如果用户拒绝授权会发生什么，但是，即使我从 Xcode 管理器中删除了该应用程序，每次我再次安装该应用程序进行调试时，手机都会记住我已经授权了应用程序来访问我的联系人。为了让事情更清楚，我想知道如何重置此授权，以便我可以再次显示警报并响应拒绝事件......非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:04:31.863

将其重置为 iphone/ipad (或 mac) 的设置应用程序

# java - setShape() 会清除 JFrame 的背景吗？

> ID：13292588
> 
> 赞同：2
> 
> 时间：2012-11-08T15:54:19.780
> 
> 标签：java, swing, transparency

我想用java编写一个程序...我想将窗口的形状（一个JFrame）设置为一组PNG图像（具有透明背景）。（实际上，我想让窗口不断改变它的形状，它看起来像一个动画！）而且，我从文件中读取图像，将它们保存到一个数组中，然后，我使用类 GeneralPath 来获取我的动画区域字符（在 png 图像中），将其保存到 areaArray。

一切都完成后，我开始画线。效果很好...但有时窗口会闪烁（啊...我的意思是发生了闪烁，但是我在闪烁时看到的背景颜色是透明的，我可以看到我的桌面壁纸！）。

我不想再看到闪烁/闪烁，有人可以帮我吗？谢谢！

PS：对不起我的英语不好！

```
 public class JCustomFrame extends JFrame implements Runnable
  {
      private final int max_frame=18;   //Here is the max numbers of my png images
      private BufferedImage[] BufImageArray;    //The array to save all the png images
      private BufferedImage nowImage;   //Save the image to be drawn in this turn
      private int counter;          //Indicate which png image to be drawn
      private Area[] areaArray;     //Save the shapes of the animated character in each png image
      public void run()// a thread function to paint the frame continual
      {
          while(true){
              if(counter==max_frame)counter=0;
              nowImage=BufImageArray[counter];  
              setShape(areaArray[counter]);
              repaint();
              try{
                  Thread.sleep(100);
              }catch(InterruptedException e){
                  System.out.println("Thread.sleep error!");
              }
              counter++;
          }
      }

      public JCustomFrame()
      {
          super();  
          setUndecorated(true);
          setBackground(new Color(0,0,0,0));    
          counter= 0;
          //...some codes here
          new Thread(this).start();
      }

      public void paint(Graphics graphic)
      {
          graphic.drawImage(nowImage,0,0,this);
      }
  } 
```

* * *

这是运行程序的示例代码：

```
import javax.swing.*;

  public class MainFrame
  {
      public static void main(String[] args)
      {
          JCustomFrame myFrame = new JCustomFrame();
          myFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
          myFrame.setSize(300,400);
          myFrame.setVisible(true);
          return ;
      }
  } 
```

* * *

我修改了上面的 2 行，“png 文件名”和“max_frame”以应用新的图像文件。我发现如果我将相同的程序放在 Windows 而不是我的 OpenSuse 上，它运行得很好（没有闪烁），在这里我上传了我的所有源包（包括图像文件）。 [这是我的代码。](https://docs.google.com/open?id=0B3VDjcWZZkDqVl9leVAyQkd5d1k)

再次感谢。

==================================================== =================================

感谢安德鲁汤普森的建议。

这次尝试把与问题无关的代码删掉，贴个gif来展示一下情况。上面的代码不可运行，但链接中的源代码运行良好。PS 闪烁/闪烁发生在随机帧中，与 gif 显示的并不完全相同。（因为我只能以固定顺序在我的 gif 图像中添加一个透明面板）

谢谢！！

![情况图片](../Images/8f528b5b638100480039439ac39d0faa.png)

# visual-studio-2012 - 哪个版本的 Visual Studio 2012 具有探查器？专业/高级/终极？

> ID：13292594
> 
> 赞同：17
> 
> 时间：2012-11-08T15:54:32.450
> 
> 标签：visual-studio-2012, version, profiler

Microsoft 网站有冲突的信息：

[http://msdn.microsoft.com/en-us/library/ms182372.aspx](http://msdn.microsoft.com/en-us/library/ms182372.aspx)

> ... 使用 Visual Studio Premium 和 Visual Studio Ultimate 的分析工具分析性能问题 ...

[http://msdn.microsoft.com/en-us/library/dd264994.aspx](http://msdn.microsoft.com/en-us/library/dd264994.aspx)

> 要求
> 
> *   Visual Studio Ultimate、Visual Studio 高级版、Visual Studio 专业版

[http://www.microsoft.com/visualstudio/eng/products/compare](http://www.microsoft.com/visualstudio/eng/products/compare)

> *   专业：使用广泛的应用程序调试和分析工具检查和优化您的代码
> *   Ultimate：从生产系统收集和分析运行时诊断数据
> *   Ultimate：执行无限的 Web 性能和负载测试

我认为我说 2010 Professional 没有分析器是正确的，您需要 Premium 或 Ultimate 版。这在 2012 年有变化吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T22:20:45.653

VS 2012 Pro 包括分析器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-26T05:28:23.023

这些 Visual Studio 2012 版本支持 Profiling Visual Studio Ultimate、Visual Studio Premium、Visual Studio Professional

# windows-8 - Windows Phone 8 - 设备管理

> ID：13292595
> 
> 赞同：3
> 
> 时间：2012-11-08T15:54:33.243
> 
> 标签：windows-8, windows-phone, windows-phone-8

我是 Windows Phone 开发的新手。有人可以帮我解决以下有关 Windows Phone 8 的问题。

1.  公司中心：我假设这将是一个自定义应用程序，可用作其他公司应用程序的商店/目录（以及其他公司信息）。这必须由公司自己开发，或者由公司的供应商开发。如果我错了，请纠正我。

2.  通过转到设置 -> 公司应用程序来调用公司中心。再次，请纠正我。

3.  在一些视频中，我看到人们通过单击“添加帐户”按钮（设置 -> 公司应用程序）登录“公司应用程序”。这个账户是什么？它只要求输入电子邮件地址和密码。

4.  MDM（移动设备管理）是如何在 WP8 设备中实现的？它是否像 Apple 的 APNS 一样使用 WNS（Windows 通知服务）？是否有可用于在 WP8 中实现 MDM 的文档？

5.  如果这是使用 WNS 处理的，那么可以在远程 Windows Phone 8 设备上执行哪些操作？是否有可用的命令列表？

6.  看到几个使用 Exchange ActiveSync 的示例。一些产品公司有自己的管理门户来设置 ActiveSync 配置。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T10:23:22.113

1.  你是对的
2.  你是对的
3.  AFAIK 根据用户提供的电子邮件地址自动检测公司帐户。公司必须从赛门铁克获得证书才能使用公司应用程序。另请查看[MSDN 的应用程序注册令牌](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj735576%28v=vs.105%29.aspx)
4.  MDM API 的文档目前（2012 年 11 月 9 日）尚未公开。
5.  您可以查看来自 MobileIron 或 AirWatch 的新闻稿 - 了解他们的承诺 - 涵盖 API 的可能性

更新：谷歌 2WP8_Enterprise_Device_Management_Protocol.pdf”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:39:48.010

设置->公司应用程序是您添加公司中心的位置，但一旦添加它，它将在应用程序列表中显示为应用程序，并且可以固定到开始屏幕。

它基本上是一个可用于显示信息和安装其他应用程序的应用程序

贵公司的用户需要对自己进行身份验证才能获取贵公司的应用程序。我不确定那里的细节

# c# - 将 C# 转换为 VB 委托

> ID：13292600
> 
> 赞同：1
> 
> 时间：2012-11-08T15:54:59.343
> 
> 标签：c#, vb.net

我正在尝试将一些 C# 代码转换为 VB .Net，并且遇到了一些 delgate 转换的问题。

备份库.cs

```
Public Class Backup
{
public event EventHandler<BackupPEventArgs> Backup;

...
if (BackupProgress != null) BackupProgress(this, new BackupProgressEventArgs(percent_complete))
...
}

public class BackupEventArgs : EventArgs
    {
        private float percentage;

        public BackupProgressEventArgs(float percentage)
        {
            this.percentage = percentage;
        }

        public float Percentage
        {
            get { return percentage; }
        }
    } 
```

单元测试.cs

```
public void BackupTest()
{
Backup bu = new Backup()
        bu.BackupProgress += delegate(object sender, Backup.BackupEventArgs e)

        {
            Debug.WriteLine("Percentage: " + e.Percentage.ToString());
        };
} 
```

它正在转换 sb.Backup += delegate(object sender, SQLBackup.BackupProgressEventArgs e) 并将其连接到我遇到问题的另一个类中的事件。

在 VB 中：

备份库.vb

```
Public Class Backup

Public Event Backup As EventHandler(Of BackupEventArgs)

...
RaiseEvent Backup(Me, New BackupEventArgs(percent_complete))
...
End Class

Public Class BackupEventArgs
            Inherits EventArgs 
```

单元测试.vb

```
Public Class BackupTest

Dim bu As New Backup()

bu.BackupProgress = Sub(sender As Object, e As BackupEventArgs)
                         Debug.WriteLine(e.Percentage.ToString())
                         End Sub

End Class 
```

当然

```
bu.BackupProgress = Sub(sender As Object, e As BackupEventArgs)
                             Debug.WriteLine(e.Percentage.ToString())
                             End Sub 
```

是我从 C# 转换为 .Net 时遇到的问题所在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T15:59:29.697

您可以在这里尝试 AddHandler

 ~~~~```
AddHandler bu.BackupProgress, AddressOf Sub(sender As Object, e As BackupEventArgs)
                         Debug.WriteLine(e.Percentage.ToString())
                         End Sub 
```~~  ~~为了让争论进来，这将无法在 VB.Net 中以这种方式保持匿名。您需要使用固定地址抽象出您的方法。

```
Protected Sub BackupProgressDelegate(sender as Object, e as BackupEventArgs)
    Debug.WriteLine(e.Percentage.ToString())
End Sub

...

AddHandler bu.BackupProgress, AddressOf BackupProgressDelegate 
```~~~~

# ruby - Mongoid 中的多对多

> ID：13292602
> 
> 赞同：0
> 
> 时间：2012-11-08T15:55:15.297
> 
> 标签：ruby, mongodb, gem, sinatra, mongoid

是的，我知道如何建立多对多关系，但没有别的。我进行了谷歌搜索并阅读了官方 mongoid 文档，但我对如何使用它一无所知。工作是指插入、更新、删除、查找、计数……

例如，假设我有 2 个模型（来自文档）：

```
class Band
  include Mongoid::Document
  has_and_belongs_to_many :tags
end

class Tag
  include Mongoid::Document
  field :name, type: String
  has_and_belongs_to_many :bands
end 
```

我应该怎么做才能完成我上面提到的所有操作？

PS 我使用 Sinatra 和 mongoid 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:59:34.403

# 插入

在您的示例模型之后的文档表中（加上我的评论）。

```
# Create a tag for a band
band.tags.create(name: "electro") 
```

# 发现

也来自同一张桌子。

```
# Find a tag that belongs to that band, whose name is "electro"
tag = band.tags.where(name: "electro") 
```

# 更新

[来自关于persistence](http://mongoid.org/en/mongoid/docs/persistence.html)的文档，针对 band/tags 示例进行了修改。

```
# using variable tag from previous line.
tag.update_attributes(name: "dubstep") 
```

# 数数

来自关于[querying](http://mongoid.org/en/mongoid/docs/querying.html)的文档，其中还包含对此处其他项目有用的信息（也已修改）。

```
band.tags.length 
```

# 删除

这也来自持久性文档。

```
# we will delete the tag from earlier
tag.delete 
```

## 最后

工作 Mongoid 所需的所有信息都在[docs](http://mongoid.org/en/mongoid/)中，实际上非常详尽和有用。肯定有很多，但你可以在几个小时内完成它。

# jquery - 使用 jQuery 将复选框值放入隐藏输入中

> ID：13292607
> 
> 赞同：2
> 
> 时间：2012-11-08T15:55:32.437
> 
> 标签：jquery, forms

我想用选定复选框的值填充隐藏输入，这些值之间有一个空格。我已经尝试了以下理论上应该可行的方法，但它不是......</p>

JS：

```
$(document).ready(function () {

      var vals = $(':checkbox:checked').map(function(){
         return $(this).val();
      }).get().join(',');

      // save the values to a hidden field
      $('#tags').val(vals);

}); 
```

HTML

```
 <form>

  <input type="checkbox" value="test1" id="test1"><label>Test</label>
  <input type="checkbox" value="test2" id="test2"><label>Test2</label>
  <input type="checkbox" value="test3" id="test3"><label>Test3</label>

  <input type="text" value="" id="tags">

</form> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T15:58:02.990

`:checkbox`已弃用

代替

```
$(':checkbox:checked') 
```

采用

```
$('input[type="checkbox"]:checked') 
```

也没有`checkboxes are checked`什么时候`document is Ready`..先设置它们然后尝试...

**HTML**

```
 <input type="checkbox" value="test1" id="test1" checked><label>Test</label>
  <input type="checkbox" value="test2" id="test2" checked><label>Test2</label>
  <input type="checkbox" value="test3" id="test3"><label>Test3</label>
  <input type="text" value="" id="tags"> 
```

**Javascript**

```
function Populate(){
    vals = $('input[type="checkbox"]:checked').map(function() {
        return this.value;
    }).get().join(',');
    console.log(vals);
    $('#tags').val(vals);
}

$('input[type="checkbox"]').on('change', function() {
    Populate()
}).change(); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/YANTh/1/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T15:58:51.967

您只需要更改选择器并将脚本附加到某个事件。例如：

```
$('input[type=checkbox]').change(function() {

    var vals = $('input[type=checkbox]:checked').map(function() {
        return $(this).val();
    }).get().join(',');

    $('#tags').val(vals);

});​ 
```

请参阅此[演示](http://jsfiddle.net/DfsUm/1/)。

# java - BufferedReader.readline() 挂起

> ID：13292608
> 
> 赞同：2
> 
> 时间：2012-11-08T15:55:34.823
> 
> 标签：java, linux, bufferedreader

我正在尝试`/usr/bin/perl -e 'for(my $i=0;$i<1000;$i++){print 1x1000;print STDERR 2x1000;}'`使用我的程序运行（在终端中工作）。

```
ProcessBuilder pb = new ProcessBuilder(go); //go is the command
process = pb.start();
BufferedReader incommandbuf = new BufferedReader(new InputStreamReader(process.getInputStream()),1024*1000);
BufferedReader errcommandbuf = new BufferedReader(new InputStreamReader(process.getErrorStream()),1024*1000);
stdString = "";

while ((line = incommandbuf.readLine()) != null)
{
    stdString += line + "\n";
}
String errorstrtemp = "";
while ((line = errcommandbuf.readLine()) != null)
{
    errorstrtemp += line + "\n";
} 
```

如果我尝试运行它，它会挂起`while ((line = incommandbuf.readLine()) != null)`。如果我将命令更改为`/usr/bin/perl -e 'for(my $i=0;$i<64;$i++){print 1x1000;print STDERR 2x1000;}'`. 如果它上升到 65 或更高，它就不起作用。起初我以为我只需要更改 BufferedReaders 的大小，但它没有帮助。关于是什么原因的任何线索？如果需要，我将提供任何其他信息。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T15:59:52.850

您一次阅读一个流。当另一个流填满缓冲区时，您的 Process 将停止等待您读取它。解决方案是读取不同线程中的流或使用[ProcessBuilder.redirectErrorStream](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html#redirectErrorStream%28boolean%29)

# mapreduce - 您如何在 Couchbase 中按值对 _View_ 的结果进行排序？

> ID：13292609
> 
> 赞同：4
> 
> 时间：2012-11-08T15:55:39.313
> 
> 标签：mapreduce, couchdb, couchbase, nosql-aggregation

因此，据我在 Couchbase 中的理解，人们可以通过使用对键进行排序*

```
descending=true 
```

但在我的情况下，我想按值排序。考虑 json 格式的 Twitter 数据，我的问题是**最受欢迎的用户提到了什么？**

每条推文的结构如下：

```
{
    "text": "",
    "entities" : {
        "hashtags" : [ ... ],
        "user_mentions" : [ ...],
        "urls" : [ ... ]
} 
```

因此，在我重用 Map 函数之前使用过 MongoDB，并对其稍作修改以在 Couchbase 中使用，如下所示：

```
function (doc, meta) {
  if (!doc.entities) { return; }

  doc.entities.user_mentions.forEach(
    function(mention) {
      if (mention.screen_name !== undefined) {
        emit(mention.screen_name, null);
      }
    }
  )
} 
```

然后我使用reduce函数`_count`来计算所有出现的`screen_name`次数。现在我的问题是**如何按计数值而不是键排序？**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T12:03:39.707

简短的回答是您不能按值对您查看的结果进行排序。您只能按键排序。

一些解决方法将是：

*   在将数据插入 Couchbase 之前分析数据，并为您感兴趣的值创建一个计数器（在您的案例中提及）

*   如果视图的大小对于客户端排序是可接受的，请使用您必须根据应用程序大小排序的视图。

下面的 JS 代码调用一个视图，对结果进行排序，并打印出 10 个最热门的主题（主题标签）：

```
var http =  require('http');

var options = {
    host: '127.0.0.1',
    port: 8092,
    path: '/social/_design/dev_tags/_view/tags?full_set=true&connection_timeout=60000&group=true',
    method: 'GET'
}

http.request(
    options, 
    function(res) {
        var buf = new Buffer(0);
        res.on('data', function(data) {
            buf += data;
        });
        res.on('end', function() {
            var tweets = JSON.parse(buf);
            var rows = tweets.rows;
            rows.sort( function (a,b){ return b.value - a.value } 
            );

            for ( var i = 0;  i < 10; i++ ) {
                console.log( rows[i] );
            }
        });
    }
    ).end(); 
```

同时，我正在寻找其他选择来实现这一目标

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-17T20:48:42.287

我通过使用复合键解决了这个问题。

```
function (doc, meta) {
  emit([doc.constraint,doc.yoursortvalue]);
} 
```

网址元素：

```
&startkey=["jim",5]&endkey=["jim",10]&descending=true 
```

# c++ - 如何改进对 if/else 局部变量的处理？

> ID：13292614
> 
> 赞同：3
> 
> 时间：2012-11-08T15:55:44.743
> 
> 标签：c++

我通常有要检测某些条件的代码，如果存在，则处理该条件。

条件测试提取某些对处理问题的一半很重要的信息。

然而，if/else 结构不允许在 if 结构本身中声明 local-to-the-if​​ 变量 (1)。因此，对于可以提取信息的所有各种条件，我必须在整个 if/else 链的开头放置变量声明。

例如：

```
 else if ((EndsWithToken("d") || EndsWithToken("dsh")) &&
             (p1 = find(m_input_line, '[')) &&
             (p2 = find(m_input_line, ']')) &&
              p2 > p1)
    {
                // process what we found inside of the [ ] brackets using p1 and p2...
            } 
```

此片段是 if/else 长链的一部分，其他片段不需要 p1 和 p2 - 但它们可能需要从输入流中提取的整数值，或双精度值，或两个点，或其他。 ...

关键是，我不知道将 const TCHAR * p1 和 p2 本地引入上述范围，这是唯一使用它的地方，仍然允许整体结构保持不变。

是否有一些 C++ 语言功能或可能允许这样做的模式？

* * *

(1) 正如一些人指出的那样，可以声明一个基本类型的变量，如果它是第一个变量，并且只针对非零进行测试。这太有限了，不能作为这个问题的一般解决方案有很大用处（尽管偶尔会出现有用的地方 - 但确实很少见）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:00:30.650

一种解决方案是让每个案例成为一个不同的函数，无论它是否成功都会返回。

这为您提供了一个自然的、本地化的变量范围，并且希望（假设）一个合理的编译器可以内联它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:08:14.603

允许在`if`and`while`语句中定义局部变量；但是，每个语句只能声明一个，并且只能测试非零值：

```
...
else if (TCHAR *p1 = find(m_input_line, '['))
{
    if (TCHAR *p2 = find(m_input_line, ']'))
    {
        ...
    }
} 
```

在这种情况下，您也可以在/语句`TCHAR *p1, *p2;`链之前声明，我不会看到任何问题。`if``else`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:04:12.440

这不是真的。`if`如果你在那里初始化它，你可以将一个变量声明到它的范围内。

```
if ( int i = 0 )
{
    i = 1;
}
else
{
    i = 2;
} 
```

这是一个愚蠢的例子，但它是合法的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:04:22.780

与 unwind 的回答类似：对 if/then/else 的主体使用内联函数怎么样？

但是，我想在这两种情况下，您可能都需要传递相当多的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T16:09:17.743

提取成一个函数。

```
bool validate(const string& line){
   auto startIndex = line.find('[');      
   auto endIndex = line.find(startIndex,']');
   return startIndex != -1 && endIndex != -1 && endIndex > startIndex;
}

//....
else if( EndsWith({"d","dsh"}) && validate(m_input_line) ){ ...} 
```

我注意到前缀“m_”所以我猜这是某个类的一部分。因此，根据需要制作私有辅助函数，以使代码更清晰、更易于理解。

# jquery - 让浏览器缓存嵌入 iframe css 和 js 文件

> ID：13292617
> 
> 赞同：0
> 
> 时间：2012-11-08T15:55:51.753
> 
> 标签：jquery, html, caching, iframe

说我有文件`main.html`。在其中我有一个`iframe`which references `sub.html`。还有一个按钮`main.html`，点击后会重新加载`sub.html`。 `sub.html`使用 jQuery/HTML5，因此引用了很多 js 和 css 文件。

有没有办法让浏览器在初始加载时缓存这些 js 和 css 文件，而不是在单击刷新按钮时重新加载它们`iframe`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:43:59.937

原来我没有发送正确的标头来指示浏览器缓存 css/js 文件。

# php - 从头开始处理会话

> ID：13292619
> 
> 赞同：2
> 
> 时间：2012-11-08T15:55:54.687
> 
> 标签：php, session

我想从头开始创建一个会话处理程序。我不想使用`session_set_save_handler`. 我在任何地方都找不到任何东西，我只是不知道从哪里开始。有人能指出我正确的方向或解释最好的方法吗？

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:21:30.107

尝试构建自己的会话机制时，需要注意的事项很少。

您可以做的第一件事是编写一个 PHP 会话包装器。将包装 PHP 会话功能的类。因此，当您想使用 Sessions 时，您可以实例化您的会话类并使用会话做您想做的事情。你可以这样做：

```
class Session
    {
        /**
         * Starts new or resumes existing session
         * 
         * @access  public
         * @return  bool
         */

        public function start()
        {
            if(session_start()) {
                return true;
            }
            return false;
        }

        /**
         * End existing session, destroy, unset and delete session cookie
         * 
         * @access  public
         * @return  void
         */

        public function end()
        {
            if($this->status != true) {
                $this->start();
            }

            session_destroy();
            session_unset();
            setcookie(session_name(), null, 0, "/");
        }

        /**
         * Set new session item
         * 
         * @access  public
         * @param   mixed
         * @param   mixed
         * @return  mixed
         */

        public function set($key, $value)
        {           
            return $_SESSION[$key] = $value;
        }

        /**
         * Checks if session key is already set
         * 
         * @access  public
         * @param   mixed  - session key
         * @return  bool 
         */

        public function has($key)
        {
            if(isset($_SESSION[$key])) {
                return true;
            }

            return false;
        }   

        /**
         * Get session item
         * 
         * @access  public
         * @param   mixed
         * @return  mixed
         */

        public function get($key)
        {
            if(!isset($_SESSION[$key])) {
                return false;
            }

            return $_SESSION[$key];         
        }
    } 
```

然后你可以像这样使用这个会话类：

```
$session = new Session();
$session->start();
$session->set('id', 5);
echo $session->get('id); 
```

我喜欢这个，因为我可以像对象一样使用 PHP 会话，而不必使用 PHP 函数。但请注意，您无论如何都在使用 PHP 函数，只是在使用此类时看不到它。这样做可以帮助您深入了解 PHP 会话的工作原理。

如果您决定硬着头皮编写自己的会话机制，则需要注意的事项很少。您需要决定的第一件事是将会话信息存储在哪里？您可以将它们保存在数据库、文件系统、cookie 等中... 默认情况下，PHP 将会话保存在文件系统中。编写自己的会话机制的最简单方法是将会话保存到 cookie 中。如果您使用 Codeigniter 会话，Codeigniter 默认会执行此操作。

您将编写自己的对象，该对象将为您提供读取、写入、编辑、删除...会话数组的方法。该数组必须在保存到 cookie 之前进行序列化。一旦会话保存在 cookie 中，您可以使用您编写的方法将它们取出、编辑或删除它们等。这样做时，请注意安全性，因为用户可以查看他们的 cookie。您将不得不加密会话值。

然后，如果您决定将会话保存到数据库中，您可以使用您拥有的相同方法，但这次将会话保存到数据库中而不是 cookie 中。

最好的方法是编写会话接口，每个会话类都会实现。这样你就可以使用你的 Session 类，而不关心会话存储在哪里。

如果您现在不明白我在说什么，那么只需构建您自己的会话包装器，这可以帮助您了解有关会话的更多信息。并为您提供了使用 OOP 处理会话的好方法。一旦你有了它，你就可以使用那个 API 来编写你的 Session 接口，并在每个 Session 类中实现那个接口，并编写你自己的逻辑，你将如何以及在哪里保存会话数据。

还有一件事，PHP Sessions 机制没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:08:47.540

调用会话时我会做什么

//开始会话并设置变量

session_start();

$_SESSION['登录']='是';

$_SESSION['someinfo']=$var;

//调用时

session_start();

$var= $_SESSION['someinfo'];

我希望这有帮助

-克里斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:25:07.560

[如果您使用加密 cookie](https://github.com/Xeoncross/micromvc/blob/master/Class/Core/Cookie.php) ，则不需要使用 PHP 的会话处理。基本上，标准会话将数据存储在服务器上（内存缓存、文件或数据库），并且数据的 ID/密钥被放置在给用户代理的 cookie 中。

加密的 cookie 只是将数据存储在用户代理上的 cookie 中，并完全放弃 ID/密钥。这减少了服务器负载，因为存储被卸载给了用户。

如果数据不够重要而无法加密，您也可以仅对[cookie 内容进行 HMAC 签名，](https://github.com/jeremeamia/tweetmvc-core/blob/master/extensions/cookie.php)以防止人们即使看到原始内容也无法更改它。

您可能想试试我的使用加密 cookie的简单[PHP Kit库。](https://github.com/Xeoncross/kit/blob/0.1.0/Kit/Kit.php#L510)

```
$_SESSION = \Kit\Cookie::get('session');
...do stuff...
\Kit\Cookie::set('session', $_SESSION); 
```

只需确保在向用户发送任何输出之前保存 cookie，因为所有标头都需要先发送。

# c# - PostSharp 属性构造函数只被击中一次

> ID：13292620
> 
> 赞同：0
> 
> 时间：2012-11-08T15:55:58.140
> 
> 标签：c#, attributes, postsharp

我有几种方法使用我在 PostSharp 的帮助下构建的属性。该属性有 3 个构造函数重载，每个重载在调用 OnEntry() 之前执行逻辑。第一次使用我的属性命中方法时，它工作正常。之后，构造函数没有在我的属性中被击中，只有 OnEntry() 正在触发。

每次调用具有该属性的方法时，我都需要调用构造函数。有谁知道这个的解决方案？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:07:16.420

您可以看到另一个主题，它显示了何时运行构造函数：[自定义属性的构造函数何时运行？](https://stackoverflow.com/questions/1168535/when-is-a-custom-attributes-constructor-run)

Postsharp 在编译之后、执行之前访问那里的属性（这称为后期编译）。调试器可以正常工作，所以你真的可以在构造函数处设置一个断点并查看调用堆栈以观察这个构造函数被调用的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:02:55.063

属性构造函数不会在运行时执行。PostSharp 属性也不例外。

我相信你必须重新设计你的方法。我什至对您声称您的构造函数被击中一次感到惊讶。我只是检查它，并且在运行时根本没有命中属性构造函数。

# windows-phone-7 - 如果不支持 pubcenter 可以选择哪些广告

> ID：13292624
> 
> 赞同：2
> 
> 时间：2012-11-08T15:56:04.640
> 
> 标签：windows-phone-7, xna, admob, nokia, ads

我开发了一个xna游戏。不支持我国的 Pubcenter。我找到了一些解决方案：

*   AdRotator ：将一些主要的广告网络与 AdDuplex 相结合，但要选择哪些广告网络？什么概率等等？

*   诺基亚广告交换：市场上出现了一些新事物，我没有发现 ecpm 可能是什么？

那么对我来说最好的选择是什么？

当然，有趣的是这些广告网络如何通过 ecpm 与 pubcenter 进行比较，填充率可以预期我能得到什么。

# c# - 尝试隐藏表单时无法访问已处置的对象

> ID：13292627
> 
> 赞同：1
> 
> 时间：2012-11-08T15:56:10.650
> 
> 标签：c#, winforms, multithreading

我有一个基于 MDI 的图表应用程序。每个子窗体都是一个包含图表的窗体。每个图表都有自己的数据队列和专用的工作线程。

在工作线程 DoWork 方法中，我有一个由布尔“IsChartActive”控制的 while 循环，它将在图表上绘制数据。为了绘制数据，我在 chartForm 本身上调用 Invoke 并将一个委托传递给应该更新图表的方法。

当用户关闭图表表单时，我并没有真正关闭它，而是停止图表更新并希望隐藏图表，直到用户想要再次查看它。

为此，我处理 FormClosing 事件，设置 Cancel = true，设置“IsChartActive = false”并调用 ChartForm.Hide()。

但是在此之后，我在 DoWork 方法中得到了“无法访问已处理的对象”异常（我假设这是因为当我设置“IsChartActive = false”时后台线程已经在调用语句中，所以它会看到变化在下一次迭代中），在图表上调用调用时。

为什么我会得到这个异常，即使图表实际上并没有被处理而只是隐藏了？

```
public void StopChartUpdates()
        {
            IsActive = false;
            updateChartThread.CancelAsync();
        }

private void updateChartThread_DoWork(object sender, DoWorkEventArgs e)
        {
            while (IsActive && !updateChartThread.CancellationPending)
            {
                try
                {
                    ChartView.Invoke(new Action(InvokeOnUiThread));

                }
                catch (ObjectDisposedException ex)
                {
                              //getting this error when calling invoke on ChartView
                    Trace.WriteLine("Exception: " + ex.Message);
                }
                Thread.Sleep(UpdateFrequency);
            }
        }

private void InvokeOnUiThread()
        {
            try
            {
                       //update the chart
            }
            catch (Exception ex)
            {
                Trace.WriteLine("Exception: " + ex.Message);
            }
        }

private void ChartView_FormClosing(object sender, System.Windows.Forms.FormClosingEventArgs e)
        {
            StopChartUpdates();
            if (e.CloseReason == CloseReason.UserClosing)
            {
                ChartView.Hide();
                e.Cancel = true;
            }
        } 
```

# winforms - 将事件分派到正确的线程中

> ID：13292628
> 
> 赞同：0
> 
> 时间：2012-11-08T15:56:11.420
> 
> 标签：winforms, c++-cli, event-dispatch-thread

我为使用回调通知事件的库开发了一个包装器。此回调是使用 UI 线程之外的另一个线程调用的，因此包装器使用以下脚本将事件处理程序调用到 WinForm 应用程序的正确线程中。

```
void AoComm::Utiles::Managed::DispatchEvent( Delegate^ ev, Object^ sender, Object^ args )
{
ComponentModel::ISynchronizeInvoke^ si;
array<Delegate^>^ handlers;

if(ev != nullptr)
{
    handlers= ev->GetInvocationList();

    for(int i = 0; i < handlers->Length; ++i)
    {
        // target implements ISynchronizeInvoke?
        si = dynamic_cast<ComponentModel::ISynchronizeInvoke^>(handlers[i]->Target);
        try{
            if(si != nullptr && si->InvokeRequired)
            {
                IAsyncResult^ res = si->BeginInvoke(handlers[i], gcnew array<Object^>{sender, args});
                si->EndInvoke(res);

            }else{
                Delegate^ del = handlers[i];
                del->Method->Invoke( del->Target, gcnew array<Object^>{sender, args} );
            }
        }catch(System::Reflection::TargetException^ e){
            Exception^ innerException;
            if (e->InnerException != nullptr)
            {
                innerException = e->InnerException;

            }else{
                innerException = e;
            }
            Threading::ThreadStart^ savestack = (Threading::ThreadStart^) Delegate::CreateDelegate(Threading::ThreadStart::typeid, innerException, "InternalPreserveStackTrace", false, false);
            if(savestack != nullptr) savestack();
            throw innerException;// -- now we can re-throw without trashing the stack
        }
    }
    }
} 
```

这段代码工作得很好，但我已经阅读了 WPF 的 Dispatcher 类，它的作用与我的代码相同（当然还有更多）。那么，是否有与 WinForms 的 Dispatcher 类等效的东西（类、机制……）？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T19:01:37.560

对，这不是正确的做法。Winforms 和 WPF 有不同的同步提供程序，它们将它们安装在 System::Threading::SynchronizationContext::Current 中。

要使用它，请在构造函数中复制 Current 值。当您准备好触发事件时，检查它是否为*nullptr*。如果是这样，那么您的对象是在工作线程中构造的，您应该直接触发您的事件。如果不是，则使用 Post() 方法在 UI 线程上运行辅助方法。让*该*辅助方法触发事件。

# php - 如何使用带有 silex ServiceProvider 的自定义类

> ID：13292630
> 
> 赞同：4
> 
> 时间：2012-11-08T15:56:25.350
> 
> 标签：php, class, symfony, templating, silex

我觉得我已经彻底搜索了整个互联网，但似乎无法弄清楚这一点。我正在使用 Silex（最新版本），似乎无法弄清楚如何使用 Silex 的 ServiceProvider 系统返回一个类的实例以供使用。

我确实知道如何创建一个基本的服务提供者。

我不知道该怎么做是如何让这个服务提供者使用自定义类。我已经尝试了所有我能想到或在网络上找到的东西。部分问题是Silex关于这方面的文档不是很广泛，并且大多数关于此类问题的问题都是在对它的完成方式进行相当大的改变之前提出/回答的（或者看起来如此）所以答案不是最新的。

所以，简单说一下：我想使用 Silex 的 $app['myclass'] 类型系统来访问我的类，这样我就可以做类似 $app['myclass']->myMethod() 的事情。

我被挂断的地方是这个，虽然我可以创建一个服务提供者，但我不知道如何让服务提供者识别这个类。我已经尝试使用 composer auto-load pso-0 设置整个命名空间，并尝试使用 MyClass/MyClass 类型的东西。

哈哈，基本上，因为文档太少，可能有任何部分我做错了。

**有人会编写当前的分步过程来将自定义库/类连接到 $app 变量吗？我认为这不仅对我有帮助，对其他人也有帮助。**谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:10:00.307

在我看来，您在加载类时遇到问题。这是过去由`autoload`silex 中的服务处理的。然而，该服务已被删除，有利于作曲家的自动加载。

你在正确的轨道上指定了自动加载`composer.json`。如果您不熟悉作曲家，请阅读[介绍](http://getcomposer.org/doc/00-intro.md)。有关自动加载如何工作的详细信息，请参阅[基本用法一章的自动加载部分](http://getcomposer.org/doc/01-basic-usage.md#autoloading)。

我会在这里给你一个简短的版本。确保您的文件名符合 PSR-0 命名标准。将此添加到您的`composer.json`：

```
{
    "autoload": {
        "psr-0": {"Acme": "src/"}
    }
} 
```

您需要替换`Acme`为您的命名空间和`src`类的基本目录。例如，该类`Acme\Foo\Bar`将位于`src/Acme/Foo/Bar.php`.

然后运行`php composer.phar update`以重新转储自动加载文件，您应该能够访问您的类。

# sql - 当特定行不存在时要处理的数据库查询

> ID：13292631
> 
> 赞同：0
> 
> 时间：2012-11-08T15:56:36.073
> 
> 标签：sql, sql-server, database

抱歉标题不好，很难用一句话来解释我遇到了什么问题。所以我有一个篮球统计数据库。我要做的是将一支球队的统计数据组合成一排，然后将这支球队与之对抗的所有统计数据组合成另一排。如果数据库中有对手的统计数据，我现在所拥有的工作，但可能没有对手的统计数据而只有球队的统计数据。很难解释为什么，所以请继续。

所以假设我有 3 行是这样的：

```
COMP_ID | TEAM_ID | OFF_REB | DEF_REB
  1     |  100   |   5     |    4
  2     |  100   |   1     |    1
  3     |  100   |   3     |    7 
```

基本上，有3场比赛，我只有100队的数据。我想连续获得第 100 队的所有 OFF 和 DEF 篮板，然后在另一排中获得所有对手的 OFF 和 DEF 篮板。如果没有对手的统计数据，只有 0 就可以了。

仅供参考 - 我现在做的是分组，将团队 100 的统计数据打包在一起，并将对手的统计数据打包在一起。对于对手统计数据的 TEAM_ID，我将它们分组为 -999 值，因此我知道它们是对手值。

这是我现在的查询：

```
SELECT CASE WHEN TEAM_ID <> 100 THEN -999 ELSE 100 END AS TEAM_ID, SUM(OFF_REB+DEF_REB) REBS
FROM V_STATS_COMP
WHERE COMP_ID IN (SELECT COMP_ID FROM COMPETITIONS WHERE HOME_ID = 100 OR VIS_ID = 100)
GROUP BY CASE WHEN TEAM_ID <> 100 THEN -999 ELSE 100 END
ORDER BY TEAM_ID 
```

使用这个查询，我只得到 1 行，那是团队 100。即使没有可用的统计数据，我如何调整它以获得 -999 行？

编辑以显示所需的结果：

```
TEAM_ID | REBS
  100   |  21
 -999   |  0 
```

当然，如果有对手的统计数据，我想看看他们的 REBS 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:27:50.787

下面的查询将确保您有 -999，通过将联合添加到您的结果集与 0，即使您已经有 -999，它也不会影响您的结果总和：

```
 SELECT
         TEAM_ID
        ,SUM(REBS) REBS
    FROM
        (
            SELECT 
                  CASE WHEN TEAM_ID <> 100 THEN -999 ELSE 100 END AS TEAM_ID
                , ISNULL(OFF_REB,0)+ISNULL(DEF_REB,0) REBS
            FROM 
                V_STATS_COMP
            WHERE 
                COMP_ID IN (SELECT COMP_ID FROM COMPETITIONS WHERE HOME_ID = 100 OR VIS_ID = 100)
            UNION
            SELECT -999 TEAM_ID, 0 REBS
        ) as vwStats
    GROUP BY 
        vwStats.TEAM_ID
    ORDER BY 
        vwStats.TEAM_ID DESC 
```

# sql-server-2008 - 处理后从选择中删除行

> ID：13292632
> 
> 赞同：0
> 
> 时间：2012-11-08T15:56:39.703
> 
> 标签：sql-server-2008

我必须要一张这样的桌子

```
Year Month
2012  8
2012  7
2012  4
2012  3
2011  7
2011  3
2011  1
2010  10
2010  9
2010  8 
```

这张表显示了哪个月份和年份是remaning，现在假设我已经完成了 2012 年，第 7 个月。现在我想要像这样的列表

```
Year Month
    2012  8
    2012  4
    2012  3
    2011  7
    2011  3
    2011  1
    2010  10
    2010  9
    2010  8 
```

我正在使用以下查询，但这并没有给我正确的记录

```
SELECT YEAR, MONTH from tablex
WHERE Year NOT IN (SELECT DISTINCT YEAR from OTHER_TABLE INNER JOIN Some_Other_Table)
AND  MONTH NOT IN (SELECT DISTINCT MONTH FROM OTHER_TABLE INNER JOIN Some_Other_Table) 
```

当 OTHER_TABLE 为空时，我得到了当前计数，但是当其他表有 2012 年和第 7 个月时，我没有得到任何结果。

**PS：tablex 和 OTHER_TABLE 和 Som_Other_Table 没有可用的连接列**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:00:02.800

你只需要使用[`NOT EXISTS`](http://msdn.microsoft.com/en-us/library/ms188336.aspx)：

```
SELECT YEAR, MONTH 
from tablex t1 
WHERE NOT EXISTS
(
    SELECT 1 FROM OTHER_TABLE t2
    WHERE t2.Year = t1.Year AND t2.Month = t2.Month 
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:00:17.140

此答案假设您有一行`{Year = 2012, Month = 7}`来`OTHER_TABLE`指定完成的月份。

这不起作用，因为您要分别检查年份和月份。因此，您没有从结果中删除行 (2012, 7)，而是删除了 Year = 2012 的所有行和 Month = 7 的所有行。试试这个反连接：

```
SELECT x.YEAR, x.MONTH
FROM tablex x
LEFT OUTER JOIN OTHER_TABLE y ON x.YEAR = y.YEAR AND x.MONTH = y.MONTH
WHERE y.YEAR IS NULL 
```

# javascript - 通过 overclocked/mc 在 nodejs 中嵌套 memcache 连接

> ID：13292640
> 
> 赞同：0
> 
> 时间：2012-11-08T15:56:56.253
> 
> 标签：javascript, node.js, memcached

我有一个 memcached 状态，我想在其中保存一些东西。当一个节点连接到我的应用程序的拓扑时，我希望它能够将自己添加到该类型的连接节点列表中。我正在尝试通过嵌套查询来做到这一点：

```
mc_cli.connect(function() {
mc_cli.get( key, function(err, response) {
    if(err.type == 'NOT_FOUND'){
        //save myself
        mc_cli.connect(function() {
            mc_cli.add( GLOBAL_KEY, uid, { flags: 0, exptime: 0}, function(err, status) {
                if (!err) { 
                    console.log(status);
                }
                else {
                    console.log(err);
                }
            });
        });
    }
[...] 
```

此代码属于`else`以下错误：

```
{ type: 'CONNECTION_ERROR',
  description: 'Lost connection to server.' } 
```

基本上代码所做的是，由于没有人设置连接的 ID 数组，因此执行代码的第一个节点是负责执行此操作的节点。我没有显示以下代码，它只是获取 ID 列表并添加自己的。错误发生在显示的代码段中。现在，在库中打印此错误的代码如下：

```
try {
    this.sock.write(command + crlf);
    if (value) {
      this.sock.write(value);
      this.sock.write(crlf);
    }
    this.queue.enqueue({ handler: handler, callback: callback });
}
catch (x) {
    callback({ type: 'CONNECTION_ERROR', description: 'Lost connection to server.' }, null);
} 
```

这不是很有帮助，因为我不明白是什么原因造成的。我想知道我在做什么是错的。我正在使用一些我习惯于使用 mongoDB 的嵌套东西，但我不确定我是否可以对 memcached 做同样的事情，尤其是这个库。有没有人有关于如何解决这个问题的想法？谢谢。

编辑：我忘了添加我正在使用的库的链接：[超频/mc](https://github.com/overclocked/mc)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T11:19:09.690

尝试解决这个问题一段时间后，我意识到嵌套连接是可能的，错误不是由它引起的。我发现我正在将结构不正确的数据传递给该`.add()`方法。它接受的不是像 a`Number`或 a这样简单的东西`String`，而是`Buffer`s。所以我必须像这样转换我想保存的每一个数据：

```
new Buffer(data) 
```

使用默认编码（我相信它是`utf8`）。我希望这能将某人从地狱中拯救出来。我的问题的主要问题是我收到的错误根本没有意义。

# visual-studio-2008 - 如何为应用编写配置文件并且用户权限没有问题？

> ID：13292642
> 
> 赞同：0
> 
> 时间：2012-11-08T15:57:00.763
> 
> 标签：visual-studio-2008, c#-3.0

我正在开发一个连接到 MS Access 数据库的应用程序。数据库的路径存储在一个字符串中，用户可以随时更改，因为数据库可以放在硬盘中的任何位置。应用程序必须将数据库的路径保存在配置文件中。我怎样才能读写这个配置文件并且用户权限没有问题？我必须将配置文件保存在与我的应用程序相同的程序文件夹或用户特定文件夹中吗？如果我使用 ini 文件或 xml 文件怎么办？

这是我的应用程序的逻辑：

```
 myOpenFileDialog.Filter = "MS Access Database|*.mdb";

    if (myOpenFileDialog.ShowDialog() == DialogResult.OK)
    {
        string pathBD = myOpenFileDialog.FileName;           

        if (File.Exists(pathBD))
        {
            // save pathBD to a configuration file
            // next time when the app loads 
            // it will read the configuration file 
            // and look for the database in the given path
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:59:02.670

使用[设置](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)类。您可以将此保存为用户设置，然后每个用户都可以拥有自己的路径，或者您将其设置为应用程序设置，所有用户都将使用它。

# json - Coldfusion 8 JSON - 将返回字符串转换为查询对象

> ID：13292644
> 
> 赞同：0
> 
> 时间：2012-11-08T15:57:13.340
> 
> 标签：json, coldfusion, coldfusion-8

我在使用 JSON 函数与其他系统交互时相对较新，也许我只是在一个基本问题上放屁。

我访问一个以 JSON 字符串形式返回查询的 API 函数。返回格式为“普通”。运行查询以选择学校列表并创建一个结构数组作为返回字符串。

```
"[{\"city\":\"Adrian\",\"state\":\"MI\",\"school\":\"Adrian College\"},{\"city\":\"Albion\",\"state\":\"MI\",\"school\":\"Albion College\"},.........etc. 
```

所以现在我需要将其转换为查询对象并使用它，但现在我发现自己在 google/test/re-google/re-test 循环中四处走动。关于如何将其转换为以学校/城市/州为列的查询的任何指示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:05:22.827

首先使用[**deserializeJson**](http://cfdocs.org/deserializeJson)将字符串转换为可用的东西。

然后，在第一个数组元素上使用[**StructKeyList**](http://cfdocs.org/StructKeyList)来获取在[QueryNew](http://cfdocs.org/QueryNew)中使用的列。

然后执行**两个循环**- 一个通过执行[QueryAddRow的数组，其中包含一个通过执行](http://cfdocs.org/QueryAddRow)[**QuerySetCell**](http://cfdocs.org/QuerySetCell)设置值的列的内部循环。

沿着这条线：

```
<cfset Data = deserializeJson(JsonString) />

<cfif NOT ArrayLen(Data)>
    <cfthrow message="No data" />
</cfif>

<cfset Q = QueryNew( StructKeyList(Data[1]) ) />

<cfloop index="i" array=#Data#>
    <cfset Row = QueryAddRow(Q) />
    <cfloop index="ColName" collection=#Data[i]# >
        <cfset QuerySetCell( Q , ColName , Data[i][ColName] , Row ) />
    </cfloop>
</cfloop>

<cfdump var=#Q# /> 
```

[理想情况下将它放在一个函数中（这意味着适当的 var 作用域）。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:02:50.913

听起来您需要使用该`DeserializeJSON()`方法。更多信息[在这里](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_c-d_43.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:52:48.673

解决了！有第二个 CFC 代理所有 API 请求并验证 API 凭据。从该代理 CFC 扩展的所有 API CFC 并且代理 CFC 缺少 returnformat="plain"。

一旦我们让他们将其放置到位，数据就会按预期返回。感谢大家的建议。

# ruby-on-rails - 为什么 Rails 认为我的数据库是 MongoDB，而它是 SQLite3？

> ID：13292646
> 
> 赞同：1
> 
> 时间：2012-11-08T15:57:30.543
> 
> 标签：ruby-on-rails, mongodb, sqlite

我的 database.yml 文件说

```
adapter: sqlite3
database: db/development.sqlite3
pool: 5
timeout: 5000 
```

当我运行 rails server 时，我得到：

```
ActiveRecord::ConnectionNotEstablished 
```

我用 grep 搜索我的项目，没有 mondodb 写在任何地方。我使用 Cucumber 作为 BDD。当我运行 rake 时，我得到：

```
Please install the mongodb adapter: `gem install activerecord-mongodb-adapter` (cannot load such file -- active_record/connection_adapters/mongodb_adapter) 
```

任何想法？

# xdebug - 为什么 XDebug 远程调试在提交后会丢失我的路径映射（Eclipse）？

> ID：13292647
> 
> 赞同：1
> 
> 时间：2012-11-08T15:57:33.320
> 
> 标签：xdebug, eclipse-pdt

我正在使用 XDebug 远程调试 Eclipse 中的应用程序。我可能没有正确配置 Eclipse。当我开始调试时，一切正常。但是，只要我提交表单，调试器就会继续工作，但 Eclipse 似乎无法将服务器端文件映射到我的本地文件。

这是我在提交之前看到的堆栈跟踪：

```
wwwc.example.com [PHP Web Application]  
  PHP Application   
    Remote Launch (suspended)   
      www.example.com/htdocs/toto.inc.php.toto_inc : lineno 12() www.example.com/htdocs/toto.inc.php at line 12 
      www.example.com/htdocs/toto.inc.php.include : lineno 23() www.example.com/htdocs/toto.inc.php at line 23  
      www.example.com/htdocs/simple.inc.php.include_once : lineno 325() www.example.com/htdocs/simple.inc.php at line 325   
      www.example.com/htdocs/index.php.{main} : lineno 106() www.example.com/htdocs/index.php at line 106 
```

提交后

```
wwc.example.com [PHP Web Application]   
  PHP Application   
    Remote Launch (stepping)    
      /stuff/share/websites/wwwc.example.com/process.php.{main} : lineno 8() /stuff/share/websites/wwwc.example.com/process.php at line 8 
```

请注意，提交后的路径（/struff/share/website/wwwc.example.com）是服务器端，而之前的路径（www.example.com/htdocs）在我的计算机上。文件和行号是正确的。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:27:01.833

服务器上的磁盘安装在 NTFS 文件系统上。

操作 URL 上存在大小写错误（未发现，因为 NTFS 不区分大小写）。

Eclipse 的映射策略区分大小写，这意味着它不会将本地文件映射到远程文件。

修复案例错误解决了映射问题。

# android - 加载时应用程序分配大内存

> ID：13292650
> 
> 赞同：2
> 
> 时间：2012-11-08T15:57:42.463
> 
> 标签：android, memory-management, memory-leaks, android-memory

在我的 android 应用程序中，当应用程序启动时，我在日志中发现了这条消息。

```
Grow heap (frag case) to 13.781MB for 3271696-byte allocation 
```

这会在调用后不久发生`setContentView()`，甚至在应用程序的其他部分执行之前发生。

为什么设置内容视图会占用这么多内存？

我不确定这意味着什么。有人可以解释一下吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:27:08.003

没有简单的答案。内容视图有多大？您曾经使用过 Eclipse MAT 吗？另外，屏幕有多大？是否有加载大图像的 ImageView？这大约是 *1000x1000 图像的大小。

*   注：之前算错了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:34:27.270

setContentView(int res) 填充布局并添加您拥有的所有顶级视图。

可能是图像，以及其他复杂的视图会如此多地加载您的记忆。考虑在可绘制文件夹中调整图像大小。

# java - isSubstring 递归方法

> ID：13292651
> 
> 赞同：1
> 
> 时间：2012-11-08T15:57:43.517
> 
> 标签：java, methods, recursion, substring

下面是调用递归方法的代码：

```
if (isSubstring(str1, str2))
    System.out.println ("\"" + str1 + "\" is a substring of " +
                        "\"" + str2 + "\"");
else
    System.out.println ("\"" + str1 + "\" is not a substring of " + 
                       "\"" + str2 + "\""); 
```

这是我到目前为止完成的方法，它几乎可以工作：

```
public static boolean isSubstring(String str, String target)
{   
    if (target.length() == 0)
        return false;

    if (str.equals(target))
        return true;

    else     
        return (isSubstring(str, target.substring(0,target.length()-1)));            
} 
```

因此，如果 str1 作为“zzz”传递而 str2 作为“zzzabcdef”传递，那么它会返回 true。但是，如果 str2 是“abczzzxx”或“abczzz”，它不会返回 true。有没有人有任何建议或想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T15:59:29.917

是的 - 基本上你的递归方法总是只是去掉最后一个字符，然后递归，直到它得到一个空字符串或值*等于*第一个字符串。

这意味着它可以找到第一个字符串的唯一*可能*位置是目标字符串的开头，这意味着它实际上是一个`startsWith`方法。

一种效率极低但我认为应该有效的选择是尝试将一个角色从前面拿走*，然后*尝试从最后（独立地）拿走一个角色：

```
return isSubstring(str, target.substring(0, target.length() - 1))
    || isSubstring(str, target.substring(1)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:10:44.043

尝试

```
public static boolean isSubstring(String str, String target) {
            System.out.println("target :" + target);
            if (str.equals(target))
                return true;
            else if (str.length() > target.length())
                return false;
            else
                return (isSubstring(str, target.substring(1, target.length())))
                        || (isSubstring(str,
                                target.substring(0, target.length() - 1)));
        } 
```

这应该递归地尝试来自目标的所有子字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:17:41.263

目前，您只能从字符串末尾删除字符。您的函数可以正确调用`startsWith(...)`

对于子字符串匹配，我会尝试以下算法：

在没有匹配的情况下从主字符串中删除字符。当它们匹配时开始使用两个字符串，直到您匹配子字符串的所有连续字符，或者直到您找到一个不匹配的字符，这将允许您更早停止。

像这样的东西：

```
boolean isSubString(String s1, String s, boolean match) {
   if (s1 == "") return true; 
   if (s == "") return false;
   if ((s1.charAt(0) != s.charAt(0)) && match) return false; //failfast
   if (s1.charAt(0) == s.charAt(0)) return isSubString(s1.substring(1), s.substring(1), true);
   return isSubString(s1.substring(1), s.substring(1), match);
}

boolean isSubString(String s1, String s) {
    return isSubString(s1, s,false);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-29T21:19:55.243

我遇到了一个挑战，只能用 charAt()、length() 和 substring() 编写这种函数，这是我写的，我认为它工作正常......

```
public static void main(String[] args)
{
    System.out.println(isSubstring("pgram", "program")); // Expected: false
    System.out.println(isSubstring("string", "substring")); // Expected: true
    System.out.println(isSubstring("zzz", "zzzabcdef")); // Expected: true
    System.out.println(isSubstring("zzz", "abczzzxx")); // Expected: true
    System.out.println(isSubstring("zzz", "abczzz")); // Expected: true
    System.out.println(isSubstring("hell", "hello")); // Expected: true
    System.out.println(isSubstring("ada", "Madam")); // Expected: true
}

public static boolean isSubstring(String str, String target)
{
    if (str.length() == 0)
        return true;

    if (target.length() == 0)
        return false;

    if (str.charAt(0) == target.charAt(0)) // "zzz", "zzzabcdef"
    {
        if (str.length() == target.length()) // "zzz", "zzz"
            return isSubstring(str.substring(1), target.substring(1));

        else if (target.length() > str.length()) // "zzz", "zzzabcdef"
        {
            boolean r1 = isSubstring(str, target.substring(0, str.length())); // "zzz", "zzzabcdef"
            boolean r2 = isSubstring(str, target.substring(1)); // Or maybe "string", "substring"

            return r1 || r2;
        }
    }

    return isSubstring(str, target.substring(1));
} 
```

# sql - 更改 Oracle 表名

> ID：13292652
> 
> 赞同：6
> 
> 时间：2012-11-08T15:57:47.417
> 
> 标签：sql, oracle11g, alter-table, table-rename

我正在尝试在 oracle 中更改表名。我首先运行这个脚本来声明表

```
CREATE TABLE CUSTOMER
(
  C_ID NUMBER(6,0),
  C_LAST VARCHAR2(25),
  C_FIRST varchar2(25),
  C_MI char(1),
  C_DOB DATE,
  C_ADDRESS varchar2(100),
  C_CITY varchar2(35),
  C_STATE char(2),
  C_ZIP varchar2(10),
  C_DPHONE varchar2(12),
  C_EPHONE varchar2(12),
  C_USERID varchar2(20),
  C_PASSWORD VARCHAR2(30),
  CONSTRAINT CUSTOMER_PK PRIMARY KEY(C_ID)
);

CREATE TABLE ORDER_SOURCE
(
  OS_ID NUMBER(6),
  OS_DESC varchar2(255),
  CONSTRAINT ORDER_SOURCE_PK PRIMARY KEY(OS_ID)
);

CREATE TABLE ORDERS
(
  O_ID NUMBER(6),
  O_DATE DATE,
  O_METHPMT varchar2(25),
  C_ID NUMBER(6),
  OS_ID NUMBER(6),
  CONSTRAINT ORDERS_PK PRIMARY KEY(O_ID),
  CONSTRAINT ORDERS_CUSTOMER_FK FOREIGN KEY(C_ID) REFERENCES CUSTOMER(C_ID),
  CONSTRAINT ORDERS_ORDER_SOURCE_FK FOREIGN KEY(OS_ID) REFERENCES ORDER_SOURCE(OS_ID)
); 
```

它运行正确，然后我尝试运行

```
alter table ORDERS
rename to ORDER; 
```

我收到此错误：

> 从命令的第 1 行开始出错：alter table ORDERS rename to ORDER 错误报告：SQL 错误：ORA-00903：无效的表名 00903。00000 -“无效的表名” *原因：
> *操作：

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-07-24T15:24:22.207

语法“ `RENAME TABLE tab_old TO tab_new`”不正确。
正确的语法：“ `RENAME tab_old TO tab_new`”。
语句中不应出现“TABLE”一词。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T16:04:34.257

order 是 oracle 中的保留字，因此您不能将其用作表名。您可以尝试使用双引号（“order”）转义，但这不是一个好习惯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:00:55.170

```
RENAME TABLE table-Name TO new-Table-Name 
```

如果存在引用表的视图或外键，尝试重命名它会产生错误。此外，如果表上有任何检查约束或触发器，尝试重命名它也会产生错误。

在您的情况下，“ORDER”表名已保留，因此请尝试更改名称

# sql - 获取有关集合元素类型的信息

> ID：13292658
> 
> 赞同：4
> 
> 时间：2012-11-08T15:58:08.013
> 
> 标签：sql, oracle, collections, user-defined-types

我有两种用户类型：

```
create type TEST_TYPE_WITH_CHAR as table of varchar2(100 char);
create type TEST_TYPE_WITH_BYTE as table of varchar2(100 byte); 
```

如何确定什么类型包含char，以及哪个字节？

View`SYS.USER_COLL_TYPES`不提供此类信息。[sqlfiddle](http://sqlfiddle.com/#!4/c92b2/2/0)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:39:22.607

看一看`all_coll_types`。`Char_used`列，它告诉您`varchar2`元素的长度是以字节还是字符指定的仅存在于那里：

```
SQL> create type t_coll_type is table of varchar2(10 byte);
  2  /

Type created

SQL> 
SQL> select type_name
  2       , elem_type_name
  3       , char_used
  4    from all_coll_types
  5  where type_name = 'T_COLL_TYPE'
  6  ;

TYPE_NAME                      ELEM_TYPE_NAME                 CHAR_USED
------------------------------ ------------------------------ ---------
T_COLL_TYPE                    VARCHAR2                       B

SQL> create type t_coll_type2 is table of varchar2(10 char);
  2  /

Type created

SQL> 
SQL> select type_name
  2       , elem_type_name
  3       , char_used
  4    from all_coll_types
  5  where type_name = 'T_COLL_TYPE2'
  6  ;

TYPE_NAME                      ELEM_TYPE_NAME                 CHAR_USED
------------------------------ ------------------------------ ---------
T_COLL_TYPE2                   VARCHAR2                       C 
```

# .htaccess - .htacess 使用参数将两个域重定向到一个域

> ID：13292662
> 
> 赞同：3
> 
> 时间：2012-11-08T15:58:14.250
> 
> 标签：.htaccess, mod-rewrite, redirect

我目前有两个域名指向同一个应用程序。一个是法语网址（A），另一个是英语网址（B）。

我们现在想使用第三个域名 (C)，这将是主域名。

所以，我需要在我的 .htaccess 重定向

`A.fr/my/great/url`至`C.com/my/great/url?locale=fr`

和

`B.com/my/great/url`至`C.com/my/great/url?locale=en`

如何在我的 .htaccess 中这样做？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:05:19.923

在文档根目录的 htaccess 中添加：

```
RewriteEngine On

# redirect from A.fr
RewriteCond %{HTTP_HOST} A\.fr$ [NC]
RewriteRule ^(.*)$ http://C.com/$1?locale=fr [L,R=301,QSA]

# redirect from B.com
RewriteCond %{HTTP_HOST} B\.com$ [NC]
RewriteRule ^(.*)$ http://C.com/$1?locale=en [L,R=301,QSA] 
```

规则必须*在*任何现有规则之前，尤其是那些进行路由的规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T14:00:47.253

好的，感谢@Jon Lin，正确答案是：

```
RewriteEngine On

# redirect from A.fr
RewriteCond %{HTTP_HOST} A.fr$ [NC]
RewriteRule ^(.*)$ C.com/$1?locale=fr [L,R=301,QSA]

# redirect from B.com
RewriteCond %{HTTP_HOST} B.com$ [NC]
RewriteRule ^(.*)$ C.com/$1?locale=en [L,R=301,QSA] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:24:21.150

您可以使用简单的 index.html 文件宽度 Meta Refresh Tag

# rally - 集会：如何从 testcaseresult 获取测试用例的“描述”属性

> ID：13292665
> 
> 赞同：0
> 
> 时间：2012-11-08T15:58:27.357
> 
> 标签：rally, testcase

我正在查询一个测试用例结果，我想打印测试用例的“名称”和“描述”属性，这个测试用例结果属于。所以我使用以下代码进行查询。

```
var queryObject = {
                        type : 'TestCaseResult',
                        key : 'tcresults',
                        fetch: 'Build,Name,TestSet,Verdict,TestCase,Date'
                    }; 
```

从这个查询中，我可以得到 TestCase.Name ，但不能得到 TestCase.Description。我是否必须对测试用例进行单独查询才能访问“描述”，还是我在这里遗漏了什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T17:01:51.807

您是否也尝试“获取”描述？

获取：'构建，名称，测试集，判决，测试用例，日期，描述'

# mysql - 如何在不丢失前导零格式的情况下增加 MAX 值

> ID：13292669
> 
> 赞同：2
> 
> 时间：2012-11-08T15:58:37.477
> 
> 标签：mysql

如何在 MySQL 查询中增加计算值（例如 MAX 值）而不会丢失零填充格式。我的格式是 00000（varchar 5）。我现在的最大值是 00004。如果我增加它，我想要 00005。

当我使用这个查询时：

```
 SELECT max( `num_dossier` ) +1 AS max
        FROM amep_dossier 
```

我得到的结果是 5 而不是 00005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:18:51.560

[我在这里](http://bugs.mysql.com/bug.php?id=45875)发现了一个 MySQL 错误报告，解释说使用 MAX() 函数不会从查询结果的列中删除 zerofill 标志，但它无法显示零。使用 LPAD() 工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:07:27.753

用零填充计算的数字。

```
 SELECT LPAD( MAX(num_dossier) + 1, 5, '0') AS MAX
   FROM amep_dossier 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:01:36.490

如果您将其更改为 smallint(5)，您可以将其设置为`ZEROFILL`并且它会正确地自动递增。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:02:10.073

我相信你会想要使用 ZEROFILL，[http](http://hashmysql.org/wiki/Zerofill) ://hashmysql.org/wiki/Zerofill，如果你使用 phpmyadmin，将你的字段设置为 INT 并将其属性为 (UNASSIGNED ZEROFILL)。

```
CREATE TABLE amep_dossier (
   num_dossier INT(5) ZEROFILL,
   ); 
```

# android - 提取字符串

> ID：13292672
> 
> 赞同：-2
> 
> 时间：2012-11-08T15:58:49.217
> 
> 标签：android, string, substring

我想知道我是否有以下字符串：

12_123_4_5678_ans123

我知道如果你知道开始和结束索引，你可以使用：

```
String substr=mysourcestring.subString(startIndex,endIndex); 
```

如果您想从特定索引获取子字符串直到结束，您可以使用：

```
String substr=mysourcestring.subString(startIndex); 
```

如果您想从特定字符获取子字符串直到结束，您可以使用：

```
String substr=mysourcestring.subString(mysourcestring.indexOf("yourCharacter")); 
```

如果上面实际上是 4 个选项（每个选项可以有不同的长度），提取 12、123、4、5678 和 answer=123，如何为上面写？

公共区间是“_”，答案前面必须有“ans”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:02:14.773

您可以改用 String 类拆分方法。如果您总是想在“_”上拆分。这将使用您选择的分隔符将您的字符串拆分为字符串实例数组。

```
String mystring = "test_12_woop_11";
String results[] = mystring.split("_"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:06:57.920

正如@JustDanyul 和我之前所说`String.split("_");`的那样可以解决问题。现在要解析我们的答案，只需执行以下操作：

```
String[] data = "12_2345_3465_312_ans12".split("_");
String answer = null;
for (String s : data) {
    if (s.startsWith("ans")) {
        answer = s
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:10:50.793

首先，看起来您正在使用 String 作为数组。这通常是一种反模式，应该避免。我不确定这个字符串是从哪里来的，但是问问你自己是否不能进行设置，以便像这样而不是在字符串中传递这些信息。

```
String []  values = new String {
   "12",
   "123",
   "4",
   "5678",
   "ans123"
}; //here the 'ans' would always be the last index, obviously tailor your array to be whats 
   // mosts convienent for you. 
```

我在一个巨大的肢体上猜测主题是选择和多项选择问题的答案？在这种情况下，您可能需要一组可能的答案和一个指向哪个答案的索引存储...

```
 String []  values = new String {
   "12",
   "123",
   "4",
   "5678"
};
int correctAnsIndex = 1;
int userAnsIndex = 2;
String correctAns = values[ansIndex];
booelan isCorrect = (userAnsIndex == correctAnsIndex);
ect, ect, ect... 
```

如果你不能改变这一点，一个 hacky 的解决方案就是 split 命令。 `"12_123_4_5678_ans123".split("_");`将像这样返回数组 {"12","123","4","5678","ans123"};

得到答案看起来像这样......

```
String [] values = "12_123_4_5678_ans123".split("_"); 
String answer = null; 
for(String s : values  ) {
    if( s.startsWith("ans")){
        answer = s; 
    }
 } 
```

# vb.net - AjaxControlToolkit Modalpopup OkControlID -vs- asp:Button OnClick 事件

> ID：13292680
> 
> 赞同：0
> 
> 时间：2012-11-08T15:59:04.043
> 
> 标签：vb.net, ajaxcontroltoolkit

我有一个 AjaxControlToolkit ModalPopupExtender 允许选择要压缩和下载的文件。填充模式弹出窗口的 asp:Panel 中的 asp:Button 具有引用 sub 后面的代码的 OnClick 属性。这可以按预期工作，直到将 OkControlID 属性添加到 asp:ModalPopupExtender 以促进关闭弹出窗口...然后忽略 OnClick... 有谁知道我如何在弹出窗口中拥有相同的 asp:Button，调用代码隐藏子并关闭弹出窗口？

```
asp:Panel ID="DownLoadForm" runat="server" CssClass="download-form">
    <div class="download-header">Files Available For Download</div>
    <ul>
        <li><asp:CheckBox ID="CheckBox1" runat="server" checked="true" enabled="false"/> File 1</li>
        <li><asp:CheckBox ID="CheckBox2" runat="server" /> File 2</li>
        <li><asp:CheckBox ID="CheckBox3" runat="server" /> File 3</li>
        <li><asp:CheckBox ID="CheckBox4" runat="server" /> File 4</li>
        <li>&nbsp;</li>
        <li>
            <asp:Button ID="btnZipAndDownload" runat="server" Text="Zip And Download" OnClick="Download"/>
            <asp:Button ID="btnCancelDownload" runat="server" Text="Cancel" />
        </li>
    </ul>

</asp:Panel>
<asp:ModalPopupExtender ID="ModalPopupDownload" runat="server"
    PopupControlID="DownLoadForm"
    TargetControlID="btnDownloadFiles"
    CancelControlID="btnCancelDownload"
    OkControlID="btnZipAndDownload" >
</asp:ModalPopupExtender> 
```

后面代码中的子是“下载”

```
Protected Sub Download(ByVal sender As Object, ByVal e As System.EventArgs)
    Try
        Dim FileName As String = "~/Mock_Files.zip"
        Response.AddHeader("Content-disposition", "attachment; filename=Mock_Borrower_Files.zip")
        Response.ContentType = "application/zip"
        Response.WriteFile(FileName, False)

    Catch ex As Exception
        Foo
        Foo too
    End Try

    Response.End()

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T19:49:44.343

您可以使用 OnClientClick 属性并通过`__doPostBack`函数调用强制回发：

```
<asp:Button ID="btnZipAndDownload" runat="server" Text="Zip And Download" OnClick="Download"
    OnClientClick="__doPostBack(this.name, '')" /> 
```

# css - 不包含文本的 CSS 容器

> ID：13292681
> 
> 赞同：0
> 
> 时间：2012-11-08T15:59:15.657
> 
> 标签：css, css-float

我确定这将是一些错误，我只是一直在查看，但是我有一些 div，都向左浮动，我已经清除了它们，它们只是不包含内容。

这里设置了[http://jsbin.com/atinap/32/edit](http://jsbin.com/atinap/32/edit)

所以这就是我所拥有的：

```
<div class="blue">
        <img id="committee_img" class="header_img"     src="http://www.brighamandwomens.org/Patients_Visitors/pcs/RehabilitationServices/icons/comitt  
ee_members_icons.png" />
  <p id="committee_txt" class="TXT_med_blue header_text">Research Committee Members</p>
  <br class="unfloat">

<div id="members_wrapper">
  <div id="members_1">

      <p class="TXT_sm_grey"> Mary O’Brien, OTR/L, CHT<br>
       Ken Shannon, PT, DPT, OCS<br>
       Rebecca G. Stephenson, PT, DPT, MS, WCS<br>
       PJ Su, MS, CCC-SLP<br>
       Reg B. Wilcox III, PT, DPT, MS, OCS
    </p>

  </div>

  <div id="members_2">

  </div>
  <div id="members_3">

  </div>
  <br style="clear:both;">
</div>
</div> 
```

这是CSS：

```
#publications_img {
padding-top:10px;
margin-left:325px;
}  
#publications_txt {
padding-top:10px;
padding-left:302px;
}  

#committee_img {
padding-top:10px;
margin-left:318px;
}  
#committee_txt {
padding-top:10px;
padding-left:234px;
}  

#members_wrapper {
border:1px solid red;
}
#members_1 {
width:226px;
height:2px;
border:1px solid red;
float:left;
}
#members_2 {
width:226px;
height:2px;
border:1px solid blue;
float:left;
}
#members_3 {
width:226px;
height:2px;
border:1px solid yellow;
float:left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:06:55.973

你为你的 div 分配了 2px 的高度，所以内容当然会溢出。你的目标到底是什么？

# ios - iOS 从服务器接收 udp 响应

> ID：13292682
> 
> 赞同：1
> 
> 时间：2012-11-08T15:59:20.510
> 
> 标签：ios, iphone, objective-c, udp

我成功地使用以下代码将 UDP 消息发送到服务器：

```
GCDAsyncUdpSocket *udpSocket; 
    udpSocket = [[GCDAsyncUdpSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_main_queue()];
NSData *data = [@"initialize" dataUsingEncoding:NSUTF8StringEncoding];
[udpSocket sendData:data toHost:@"127.0.0.1" port:5000 withTimeout:-1 tag:1]; 
```

当服务器收到此消息时，它会回复一系列响应。我怎样才能捕捉和处理这些？我希望我的应用程序在它发送传出消息的同一端口上监听服务器响应 2 分钟，然后在无限循环中重复初始化消息：

```
message -> listen -> message -> listen ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T11:21:47.267

我能够自己弄清楚 - 毕竟并不难:-)

要开始在后台收听，我只是使用了这个：

```
NSError *error = nil;

    if (![udpSocket bindToPort:0 error:&error])
    {
        NSLog(@"Error binding: %@", [error description]);
        return;
    }
    if (![udpSocket beginReceiving:&error])
    {
        NSLog(@"Error receiving: %@", [error description]);
        return;
    } 
```

为了重复发送初始化，我使用了一个计时器 initlilzieServer 包含上面的代码）：

```
timer = [NSTimer scheduledTimerWithTimeInterval:150
                                         target:self
                                         selector:@selector(initializeServer)
                                         userInfo:nil
                                         repeats:YES]; 
```

然后我在这个类中处理响应：

```
- (void)udpSocket:(GCDAsyncUdpSocket *)sock didReceiveData:(NSData *)data fromAddress:(NSData *)address withFilterContext:(id)filterContext
{
NSString *msg = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];
    if (msg)
    {
        NSLog(@"%@",msg);

    }
    else
    {
        NSString *host = nil;
        uint16_t port = 0;
        [GCDAsyncUdpSocket getHost:&host port:&port fromAddress:address];

        NSLog(@"Unknown Message: %@:%hu", host, port);
    }
} 
```

# c# - WinRT 中的自定义控件和 TemplateBinding

> ID：13292687
> 
> 赞同：1
> 
> 时间：2012-11-08T15:59:36.617
> 
> 标签：c#, custom-controls, windows-runtime, winrt-xaml

我正在尝试创建一个显示圆圈的简单自定义控件。此控件具有 Radius 属性，但不幸的是它不适用于控件。这是一个模板：

```
<Style TargetType="local:SizedCircle">
    <Setter Property="VerticalAlignment" Value="Center"/>
    <Setter Property="HorizontalAlignment" Value="Center" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="local:SizedCircle">
                <Border
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                    <Ellipse Width="{TemplateBinding Radius}" Height="{TemplateBinding Radius}">
                        <Ellipse.Fill>
                            <SolidColorBrush Color="Red"/>
                        </Ellipse.Fill>
                    </Ellipse>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

和

```
 namespace CustomControls
{
    public sealed class SizedCircle : Control
    {
        public SizedCircle()
        {
            this.DefaultStyleKey = typeof(SizedCircle);
        }

        public string Radius
        {
            get { return (string)GetValue(RadiusProperty); }
            set { SetValue(RadiusProperty, value); }
        }

        // Using a DependencyProperty as the backing store for Radius.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty RadiusProperty =
            DependencyProperty.Register("Radius", typeof(string), typeof(SizedCircle), new PropertyMetadata(null));
}
} 
```

然后我尝试使用这个控件：

```
 <local:SizedCircle Radius="50" /> 
```

但我在屏幕上什么也看不到。不应用此半径属性。我在做什么错？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T18:24:52.870

尝试将属性类型更改为双精度而不是字符串。

# wix - WiX 多个实例 - 卸载最后一个实例时删除自定义资源

> ID：13292688
> 
> 赞同：2
> 
> 时间：2012-11-08T15:59:36.890
> 
> 标签：wix, certificate, multiple-instances

我正在使用 WiX 为我的产品创建多实例 MSI。

该`MultiInstance="yes"`属性解决了在多实例环境中管理所有支持的资源（如文件、注册表值、Windows 服务等）的问题。

但是，我不知道如何使用非内置类型的资源（如证书）来解决同样的问题。在每个实例上创建单独的证书没有问题安装并在每个实例上删除它卸载...

但是，如果我需要共享证书怎么办？这意味着第一个安装的实例将创建它，最后一个删除的实例将删除它（相当于带有 的组件`MultiInstance="no"`）

我正在使用此处描述的方法为我的 MSI 实现多个实例：

```
http://ysdevlog.blogspot.co.il/2011/08/revisited-multiple-instance.html 
```

简而言之，每个实例都在预定义的注册表位置“注册”自身，因此我可以知道当前安装的实例：

```
<Component Id="RegistryComponent" Guid="{GUIDGOES-HERE-45e5-ABFD-07E5CC4D7BC9}" MultiInstance="yes">
      <RegistryKey Id="MainRegKey" Action="createAndRemoveOnUninstall" Root="HKLM" Key="SOFTWARE\MultiInstanceTest\[ProductCode]">
         <RegistryValue Id="MainRegValue" Name="InstanceId" Value="[INSTANCEID]" Type="string" />
         <RegistryValue Id="InstallPathValue" Name="Location" Value="[ProductNameFolder]" Type="string" />
         <RegistryValue Id="ProductCodeValue" Name="ProductCode" Value="[ProductCode]" Type="string" />
         <RegistryValue Id="ProductNameValue" Name="ProductName" Value="[ProductName]" Type="string" />
         <RegistryValue Id="ProductVersionValue" Name="ProductVersion" Value="[ProductVersion]" Type="string" />
      </RegistryKey>
   </Component> 
```

这有助于我使用一个小型外部程序管理实例的安装和删除，该程序基本上读取此注册表位置并发出`msiexec`命令。

我需要能够确定它是否是最后一个实例才能删除任何自定义共享资源（例如证书）。使用`RegistrySearch`没有帮助，因为它在注册表项被删除之前运行 - 所以它总是会发现键/值仍然完好无损。

如何确定当前卸载是否正在删除最后一个实例？

# mysql - SQL 查询以查找唯一计数

> ID：13292691
> 
> 赞同：0
> 
> 时间：2012-11-08T15:59:52.647
> 
> 标签：mysql, sql, database

这里有一点背景。我有一个这样的数据库：

```
 uristem       username
  +------------+  +-------+
  | /uristem/1 |  | user1 |
  | /uristem/2 |  | user2 |
  | /uristem/3 |  | user3 |
  | /uristem/3 |  | user4 |
  | /uristem/1 |  | user1 |
  | /uristem/7 |  | user5 |
  | /uristem/5 |  | user3 |
  | /uristem/5 |  | user1 |
  | /uristem/3 |  | user1 |
  +------------+  +-------+ 
```

我需要计算命中的（**唯一**）用户数`/uristem/3`。我可以在查询中使用哪些运算符来执行此操作？

非常感谢您的帮助，

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:02:39.443

```
SELECT COUNT(DISTINCT username)
FROM yourTableName
WHERE uristem = '/uristem/3' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:02:42.870

我想这是一张有 2 列的表。

```
Select Count(Distinct username)
From Table
Where uristem = '/uristem/3' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:03:21.080

以下查询将返回命中的唯一 unser 数`/uristem/3`：

```
SELECT COUNT(DISTINCT `username`) AS nb
FROM `your_table`
WHERE `uristem`='/uristem/3' 
```

# session - Orbeon、OpenSSO 和会话到期

> ID：13292698
> 
> 赞同：0
> 
> 时间：2012-11-08T16:00:13.270
> 
> 标签：session, orbeon, opensso

我们在单独部署（跨上下文）中使用 Orbeon 3.9，应用程序安全性使用 OpenSSO，服务器是 glassfish。

注意：Orbeon 提交（反向请求）由另一个 web 应用程序处理，contex 只能从 localhost 访问，而不能在 OpenSSO 下访问。

会话超时到期后（在浏览器中打开表单足够长的时间超时）是 Orbeon 在第一次“单击”后立即卡在“正在加载...”循环中。

正如萤火虫所说：

1) Orbeon ajax POST 请求 /application-context/orbeon/xforms-server

2) OpenSSO 使用 302 Moved Temporarily 停止此请求

3) ajax 是 GET-requesting /opensso/cdcservlet?...

4）返回200，可能是登录页面内容

5) 响应被忽略，转到 1)

不休。

我试过这个：[http ://wiki.orbeon.com/forms/how-to/other/redirect-users-error](http://wiki.orbeon.com/forms/how-to/other/redirect-users-error)

但没有帮助，因为没有显示对话框。

我们需要将浏览器重定向到该登录页面。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:26:27.130

代码的编写方式，如果您希望 Orbeon Forms 客户端代码将来自服务器的答案识别为错误，则服务器还需要在 HTTP 响应的正文中包含一个如下所示的文档：

```
<error>
    <title>...</title>
    <body>...</body>
</error> 
```

如果这样的文档不存在，那么客户端代码将在延迟后重试请求，同时显示“正在加载...”。因此，在您的情况下，如果请求是从 Ajax 请求重定向的，您需要找到一种方法来让登录页面回答该文档。

现在，我还认为 Orbeon Forms 应该在这方面进行改进，并且应该将 Ajax 请求的 302 响应视为错误，默认情况下或允许您配置此行为。出于这个原因，我打开了[问题 #560](https://github.com/orbeon/orbeon-forms/issues/560)。

# c# - 为什么 C# 编译器不能告诉这个函数总是返回或抛出？

> ID：13292703
> 
> 赞同：1
> 
> 时间：2012-11-08T16:00:28.230
> 
> 标签：c#, exception, for-loop, code-analysis

我有以下（简化）方法：

```
public bool DoWorkWithRetry()
{
    for (int remainingTries = Constants.MaxRetries; remainingTries >= 0; remainingTries--)
    {
        try
        {
            return DoWork();
        }
        catch (Exception ex)
        {
            if (remainingTries == 0)
            {
                throw new WorkException(
                        String.Format("Failed after {0} retries.", Constants.MaxRetries),
                        ex);
            }
            // fall through to retry
        }
    }
} 
```

对我来说似乎很清楚这个方法要么*返回*要么*抛出*。但是，C# 编译器向我抱怨`not all code paths return a value`.

*   这是 C# 编译器代码分析的限制吗？
*   或者是否有某种情况我没有看到`for`循环可以在没有抛出或返回的情况下完成？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T16:02:17.090

编译器只是遵循语言规范。

该语言不会*尝试*执行“如果你从一个整数开始并重复减一，你最终会在某个时候达到零”的分析。这甚至假设这`Constants.MaxRetries`是一个编译时常量。

基本上，语言规范有*可达性规则 - 如果**其中任何*`for`一个为真，则语句的终点是可达的（C# 4 规范的第 8.8.3 节）：

 **   该`for`语句包含`break`退出该`for`语句的可达语句
*   该`for`语句是可访问的，并且存在一个*for 条件*并且没有常量值`true`

后一点就是这里的情况，所以`for`语句的结尾是可以到达的。不允许到达非 void 方法的结尾，因此会出现错误。（C# 规范的第 8.1 节。）

另一种方法是使语言*变得*更加复杂。我完全同意这个不编译。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T16:01:42.493

编译器不知道 for 循环将始终至少执行一次。它认为它是一个有效的选项，它根本不会运行，在这种情况下它不会`throw`或`return`.

虽然通过对您的程序进行足够复杂的分析，理论上可以证明它总是返回或抛出，但这种分析非常复杂且性能密集。C# 编译器团队不想冒出错的风险，也不想考虑显着增加编译时间以添加这种复杂的分析。他们选择使用更简单的“可访问”与“不可访问”代码的定义，这更容易和更快地实现。

至于实际的修复，只需`throw`在方法的最后添加一个，并可能在注释中说明实际上不可能命中它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-08T16:01:53.600

> 为什么 C# 编译器不能告诉这个函数总是返回或抛出？

编译器不会尝试模拟您的程序如何工作以查看可以执行哪些分支。它只是查看所有可能的分支。在您的情况下，如果由于某种原因`remainingTries >= 0`评估为假，那么它会在您的方法结束时掉落，而不会返回布尔值或抛出。

您可以通过删除`for`循环中的检查来修复它：

```
public bool DoWorkWithRetry()
{
    for (int remainingTries = Constants.MaxRetries;; remainingTries--)
    {
        // etc...
    }
} 
```

无论如何，该检查没有任何用处。

你也可以重写你的方法来完全避免这个问题：

```
for (int remainingTries = Constants.MaxRetries; remainingTries >= 0; remainingTries--)
{
    try
    {
        return DoWork();
    }
    catch (Exception ex)
    {
        // fall through to retry
    }
}

throw new WorkException(
        String.Format("Failed after {0} retries.", Constants.MaxRetries),
        ex); 
```

也请不要捕捉和吞下所有异常。捕获您知道的特定异常。捕获所有可能的异常是一个坏主意。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-08T16:03:58.587

如果您将其重构为等效代码，编译器是否仍然会抱怨？

```
public bool DoWorkWithRetry()
{
    Exception e;
    for (int remainingTries = Constants.MaxRetries; remainingTries >= 0; remainingTries--)
    {
        try
        {
            return DoWork();
        }
        catch (Exception ex)
        {
            e = ex;
        }
    }
    throw new WorkException(
         String.Format("Failed after {0} retries.", Constants.MaxRetries), e);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T16:02:04.903

要想知道 for 循环中的内容是否被执行过，就必须太聪明了。要让它知道，它必须测试 for 循环实际上是否正在执行，因为`MaxRitries >= 0`.*

# ios - 如何在 iOS 中获取卫星数量？

> ID：13292712
> 
> 赞同：7
> 
> 时间：2012-11-08T16:00:59.523
> 
> 标签：ios, core-location

我不知道如何获取设备使用 CoreLocation 获得的卫星数量。在我的 Android 应用程序中，我有这样的信息，我想在我的 iOS 应用程序中使用它。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T13:44:25.830

安迪是对的。我唯一要补充的是，如果verticalAccuracy > 0，您可以假设至少有4颗卫星。如果horizo​​ntalAccuracy在0-60m范围内，您可能有5颗或更多。如果水平精度为 60-300m 且垂直精度 < 0，您可能只有 3 颗卫星。最后，如果水平精度 > 300m 且垂直 < 0，您可能只有 < 3 颗卫星。这些大致是各种精度级别所需的。我认为 CL 不会在 WiFi 或仅限 Cell 的位置上报告 < 500m 的精度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T16:23:07.330

使用任何公开可用的 iOS API 都无法做到这一点。

例如，查看`CLLocation`类[文档](https://developer.apple.com/library/mac/#documentation/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html)以获取您可以查询的属性列表，`horizontalAccuracy`并且`verticalAccuracy`可能对您有所帮助。

# mysql - 语句之间的 SQL 查询

> ID：13292715
> 
> 赞同：1
> 
> 时间：2012-11-08T16:01:09.680
> 
> 标签：mysql, sql

我在我的 PHP 管理员中使用 mySQL 时遇到问题，并且在查询我的数据库时遇到问题这是查询语句：

```
SELECT Record_ID, Datalog_ID, TIME, AVG( Value ) 
FROM  `Datalog_Values` 
WHERE Datalog_ID =  '241'
AND TIME
BETWEEN  '2012-06-01'
AND  '2012-06-30'
GROUP BY HOUR( TIME ) 
```

我得到的结果只是第一天的结果，而不是期间的结果。即月份。

我的说法有什么问题？？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:19:58.577

您的查询因使用 MySQL 的一个（错误）功能（称为隐藏列）而受到影响。该查询正在为 Record_id、Datalog_id 和 Time 选择任意值，因为`group by`子句中没有提到这些值。

如果我推测预期的查询是：

```
SELECT Record_ID, Datalog_ID, hour(TIME), AVG( Value ) 
FROM  `Datalog_Values` 
WHERE Datalog_ID =  '241' AND TIME BETWEEN  '2012-06-01' AND '2012-06-30'
GROUP BY Record_id, Datalog_id, hour(TimE ) 
```

然后这开始有意义，假设查询的目标是为每个 Record_Id 和给定 DataLog_id 的一天中的小时生成结果。您想要一天中的每个小时还是每个月的每个小时的结果？

如果您提供示例数据并解释您想要的输出，那么您的问题可以得到更好的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:07:37.870

您需要使用相同的数据类型进行比较。因此，如果您的字段是日期/时间 YYYY-MM-DD HH:MM:SS 那么您需要`BETWEEN`使用相同的格式。尝试将 00:00:00 放在两个日期的末尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:09:09.863

如果您的时间列具有您在 where 条件（'YYYY-MM-DD'）中给出的格式，那么按小时（时间）分组没有意义。尝试进行 GROUP BY TIME 或 GROUP BY MONTH (TIME)

否则你的 where 条件错误，你需要在每个条件的末尾添加 hh:mm:ss 。

如果您想要每小时平均值，请确保您的时间列的数据类型是日期/时间，这意味着它的格式是 ('yyyy/MM/dd hh:mm:ss')

如果您有这种格式，那么我认为这个 SO 问题 - 答案会帮助您： [SQL Server Group by Count of DateTime Per Hour？](https://stackoverflow.com/questions/7001718/sql-server-group-by-count-of-datetime-per-hour)

当然它适用于 SQL Sever，但你会明白这个概念。您可以在那里查看如何按每天的时间分组。因为如果您只是按小时（时间）分组，您将获得整个月的特定时间的分组，而不是每天单独分组。

# kinect - 如何使用 Kinect 识别圆形/三角形手势？

> ID：13292721
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:01:26.643
> 
> 标签：kinect, openni

我一直在阅读有关使用 Kinect 进行手势识别的文章，其中大部分内容是识别挥手或滑动或手部跟踪。但是我想识别简单的几何图形，如圆形、三角形、正方形等。

我用什么逻辑呢？

我是一个初学者，还在学习，还有很多东西要学。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:44:28.113

Microsoft Kinect for Windows SDK 的两个资源可能有用：

[http://www.exceptontuesdays.com/gestures-with-microsoft-kinect-for-windows-sdk-v1-5/](http://www.exceptontuesdays.com/gestures-with-microsoft-kinect-for-windows-sdk-v1-5/)

提供可重用的库并链接回 MSDN 博客中描述如何构建手势的文章。

[http://kinecttoolbox.codeplex.com/](http://kinecttoolbox.codeplex.com/)

是另一个可重用的库，提供手势识别和一些帮助构建新工具的工具。

如前所述，这两个都适用于官方的 Windows SDK，但这些概念可以适应 OpenNI（根据您选择的标签，您似乎对它感兴趣）。我建议从第一个链接阅读 MSDN 博客文章——它详细描述了（而不是特定于 SDK）如何从跟踪关节构造手势。

简短的版本是您观察某个关节与其他关节的相对位置。然后，您注意它通过不同的关节，或到达相同/不同关节的另一个相对位置。您重复此操作，直到您要捕获的手势结束。

例如，要捕捉一个大正方形的手势，您*可以*跟踪以下兴趣点：

1.  右手是否在肩膀上方（y 轴）和右肩右侧（x 轴）？
2.  右手是否在肩膀和臀部之间（y 轴）和右肩的右侧（x 轴）？
3.  右手是否在肩膀和臀部之间（y 轴）和臀部中心的左侧（x 轴）？
4.  右手是否在肩膀上方（y 轴）和臀部中心的左侧（x 轴）？
5.  右手是否在肩膀上方（y 轴）和右肩右侧（x 轴）？

如果你沿着这条路走，你可以想象在你面前画一个大正方形。跟踪这一切有点棘手，但并不可怕。再一次 - 上面的两个链接都提供了可以适应 OpenNI 结构的解决方案。

# c# - 将选项添加到 T-SQL 查询语法时遇到问题

> ID：13292722
> 
> 赞同：1
> 
> 时间：2012-11-08T16:01:28.647
> 
> 标签：c#, tsql

出于某种原因，我只是无法获得正确的语法来添加 OPTION

```
 Database db = DatabaseFactory.CreateDatabase(Config.DbConnectionString);

    using (DbCommand cmd = db.GetSqlStringCommand(string.Format(@"  SELECT  t.customerID,
                                                                            t.Photo
                                                                    FROM SomeTable t
                                                                    WHERE t.PhotoID = (SELECT MAX(PhotoID) FROM SomeTable WHERE customerID = @{0} OPTION (OPTIMIZE FOR UNKNOWN)
                                                                    GROUP BY CustomerID ) ", "customerID")))
    {
        try
        {
            db.AddInParameter(cmd, "@customerID", DbType.String, customerID); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:27:28.220

您在子查询之后、分组依据之前放置了提示。

它应该看起来像这样：

```
SELECT t.customerID,
       t.Photo
FROM SomeTable t
WHERE t.PhotoID = (
                     SELECT MAX(PhotoID) 
                     FROM SomeTable 
                     WHERE customerID = @{0}
                  )
GROUP BY CustomerID
OPTION (OPTIMIZE FOR UNKNOWN) 
```

您的困惑可能是由于提示与参数值有关，因此您认为必须将其放在参数之后。但`OPTION` *总是*引入[**查询**提示](http://msdn.microsoft.com/en-us/library/ms190322.aspx "选项子句 (Transact-SQL)")。也许，牢记这一点将帮助您记住正确的语法，即`OPTION`应该始终放在整个查询的末尾。

# performance - 在 Google Drive SDK 上使用 gzip 来提高性能

> ID：13292724
> 
> 赞同：2
> 
> 时间：2012-11-08T16:01:33.923
> 
> 标签：performance, gzip, google-drive-api

我正在 Google App Engine 上用 Java 编写一个 Google Drive 客户端。与 Google Drive 的通信正常，现在我想提高性能。谷歌文档指定使用 gzip；

[https://developers.google.com/drive/performance](https://developers.google.com/drive/performance)

如何在我的 Drive (com.google.api.services.drive.Drive) 服务中设置这两个 HTTP 标头（Accept-Encoding: gzip 和 User-Agent: my program (gzip)）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T20:19:33.607

客户端库层应该为你做这件事，所以你不需要做任何额外的事情。这些性能提示适用于自己编写客户端库的人。

# google-chrome - 使用 typekit 加载网页时加载会冻结计算机

> ID：13292731
> 
> 赞同：3
> 
> 时间：2012-11-08T16:01:43.323
> 
> 标签：google-chrome, browser, typekit

我正在使用 MVC 网页，

但是当我第一次在浏览器中使用 typekit 加载页面时，计算机会冻结 10 秒左右。该页面加载了一个大字体，这可能会导致冻结。

我不确定这是什么原因，但我认为这可能是由 typekit 引起的。我排除了对 typekit 的所有引用并重新启动计算机，我没有遇到冻结问题。我已经这样做了 3 次。但是当我放回参考资料时，计算机在第一次加载页面时再次冻结。

有没有人知道可能是什么原因造成的？这与typekit有关吗？我该如何解决这个问题？

我使用的是 Windows 7，并且已经使用 Chrome 22.0.1229.94 m 进行了测试。

我还在 FireFox 和 Internet Explorer 下测试过该应用程序，但没有遇到问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T18:53:49.027

您可以尝试加载 typekit 的异步方法而不是同步方法。此外，请检查以确保您只加载您需要的实际字体，而不是全部。

[http://help.typekit.com/customer/portal/articles/6852](http://help.typekit.com/customer/portal/articles/6852) [http://help.typekit.com/customer/portal/articles/649336-embed-code](http://help.typekit.com/customer/portal/articles/649336-embed-code)

# linux - 通过 WinXP 上的 MTP - 数码相机而不是便携式设备

> ID：13292737
> 
> 赞同：0
> 
> 时间：2012-11-08T16:01:59.740
> 
> 标签：linux, windows-7, windows-xp, mtp

我在TI814X 评估板上使用 Meego 的 MTP 代码（ [Buteo MTP = daemon + functionfs）。](http://meego.gitorious.org/meego-middleware/buteo-mtp "Meego 的 Buteo MTP")连接到 Win7 时，它被检测为**便携式设备**，我可以打开资源管理器。但在 WinXP 上，它被检测为**数码相机**，因此我可以打开扫描和图像编辑器，而资源管理器图标是相机。

准备工作：我已将设备类型设置为 0x03（“便携式设备”）。我给了我的设备一个唯一的名称，并在每次尝试从注册表中所有出现的该名称之前删除（否则我的更改不会出现在 Windows 上）。

我已经将“USB View”的输出与我的三星 Galaxy 手机进行了比较，我发现唯一的区别是 bDeviceProtocol，它被手机设置为“1”（违反[PTP 的规范](http://www.usb.org/developers/devclass_docs/usb_still_img10.pdf "点对点规范")）。将此值应用于我的硬件没有任何区别。

打开硬件管理器时，我可以列出`Compatible IDs`. 在这些 ID 中，三星手机列出

```
USB\MS_COMP_MTP
USB\Class_06&SubClass_01&Prot_01
USB\Class_06&SubClass_01
USB\Class_06 
```

虽然我的设备缺少第一个条目：

```
USB\Class_06&SubClass_01&Prot_01
USB\Class_06&SubClass_01
USB\Class_06 
```

手机的服务也`WUDRFd`仅限于我的设备`usbscan`。

**问题：**由什么`MS_COMP_MTP`触发？它是我的 USB-/MTP 配置的一个选项，还是由 vencor/产品 ID 触发的？如何让我的设备使用 of`WUDRFd`而不是`usbscan`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T08:57:56.157

有一种称为“ [Microsoft OS Descriptor](http://msdn.microsoft.com/en-us/library/windows/hardware/gg463179.aspx) ”的数据结构。这可以由设备传输到 Windows 并导致此“MS_COMP_MTP”标志。

当前的 Windows 版本确实检测到没有此描述符的 MTP，但 Windows XP[仍然需要它](http://www.digipedia.pl/usenet/thread/19505/14786/#post14156)。

感谢 Peter 提供的[信息](http://www.spinics.net/lists/linux-usb/msg74233.html)。

# javascript - 为什么 localStorage 不保留在 Chrome 中？

> ID：13292744
> 
> 赞同：19
> 
> 时间：2012-11-08T16:02:30.927
> 
> 标签：javascript, google-chrome, local-storage

我正在尝试通过以下代码学习如何使用 localStorage js 对象。

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
function saveStuff() {
    sessionStorage.setItem('sessionKey', 'sessionValue');
    localStorage.setItem('localKey', 'localValue');
}
</script>
</head>
<body>
<button type="button" onclick="saveStuff()">Save</button>
</body>
</html> 
```

我知道这并不总是适用于 file:/// 所以我正在使用 mongoose 来提供它。当我单击保存按钮时，Chrome 的 JavaScript 控制台中的结果对我来说是正确的。但是，当我按下刷新时，本地存储和会话存储都会被清除，而我期望本地存储值会持续存在。这发生在`http://127.0.0.1/`和上`http://localhost/`。

有谁知道为什么会发生这种情况？在设置，内容设置中，我选择了“允许设置本地数据（推荐）”并取消选中“阻止第三方 cookie 和站点数据”。我的代码中是否缺少某些内容？

（Chrome 版本 23.0.1271.64 m）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-08T16:24:10.510

行。感谢必须在这个上去 pimvdb，但这是解决方案。

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
function saveStuff() {
    sessionStorage.setItem('sessionKey', 'sessionValue');
    localStorage.setItem('localKey', 'localValue');
}
localStorage.getItem('localKey');
sessionStorage.getItem('sessionKey');
</script>
</head>
<body>
<button type="button" onclick="saveStuff()">Save</button>
</body>
</html> 
```

摘要似乎是您必须尝试读取密钥才能持久保存它。

结论：WTF。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-05-31T14:59:09.153

`<!-- Necro post I know, but maybe it helps someone else -->`

我不明白为什么我`localStorage`在开发工具中看不到某些东西，但在控制台中输入`localStorage`. 好吧，如果您在打开开发工具的情况下存储某些内容，您将不会看到`Application -> Local Storage`为您的主机列出的任何内容。当我关闭/重新打开开发工具时，我可以看到我的数据。

因此，总而言之，关闭/重新打开开发工具。

# azure - Azure 云服务：两个 Web 角色共享同一个端口

> ID：13292745
> 
> 赞同：6
> 
> 时间：2012-11-08T16:02:34.060
> 
> 标签：azure, azure-web-roles

我想要一个包含两个 Web 应用程序的 Azure 云服务。两个应用程序应具有**相同的入站端口号**(80)，并且仅在主机标头上有所不同。

是否可以将这些应用程序配置为**不同的 Web 角色**？正如我所见，不可能将相同的端口指定为不同角色的端点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T16:14:59.680

不，这是不可能的。您有 2 个选项：

*   将所有内容部署到**单个**Web 角色。[这允许您在同一端口上使用主机标头。](http://www.wadewegner.com/2011/02/running-multiple-websites-in-a-windows-azure-web-role/)如果您认为性能可能是一个问题，只需添加更多实例。

*   如果由于某种原因您不能在一个 Web 角色中托管两个 Web 应用程序，请考虑使用多个云服务：

    *   myapp1.cloudapp.net -> 带有主机头：customers.myapp.com
        *   具有输入端点 Http 端口 80 的 WebRoleA
    *   myapp2.cloudapp.net -> 带有主机头：admin.myapp.com
        *   带有输入端点 Http 端口 80 的 WebRoleB

# objective-c - 将 mac osx 应用程序转换为 ios 应用程序的最简单方法

> ID：13292749
> 
> 赞同：2
> 
> 时间：2012-11-08T16:02:38.257
> 
> 标签：objective-c, ios, xcode, macos

我有一个 mac osx 应用程序，正在尝试将其转换为 ios 应用程序，但这样做遇到了很多麻烦。我希望那里的人可能知道我可以使用的转换器，如果不存在这样的东西，那么最简单的方法是什么。如果这有什么不同，我目前正在使用最新版本的 xcode 来执行此操作。任何帮助，将不胜感激。

感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:08:25.777

这没有灵丹妙药。它必须手工完成。

您可能可以重用一些“模型”代码，因为 Mac 和 iOS 都使用 MVC 模式，但“视图”代码基本上必须从头开始编写。

# c# - MSIE 9：将底部的黄色下载栏替换为正常弹出窗口

> ID：13292751
> 
> 赞同：0
> 
> 时间：2012-11-08T16:02:44.637
> 
> 标签：c#, internet-explorer-9, watin

MSIE、注册表或某些插件/附加组件中是否有一些设置可以让我摆脱在我尝试下载某些内容时弹出在窗口底部的黄色下载栏（打开替代品，保存，取消并另存为），而是使用 MSIE-8 样式的弹出对话框？

这个黄色条使使用 Watin 测试站点变得困难。实际上，由于这个黄色条，我目前根本无法测试下载。在 MSIE 8 中，它按预期工作，因为有正常的弹出对话框窗口。

解决办法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:33:54.820

这很容易： http: [//windows.microsoft.com/en-US/windows-vista/Internet-Explorer-Information-bar-frequently-asked-questions](http://windows.microsoft.com/en-US/windows-vista/Internet-Explorer-Information-bar-frequently-asked-questions)

检查**我可以关闭信息栏**选项卡吗

# sourceforge - 从 Sourceforge 下载目录 tarball

> ID：13292752
> 
> 赞同：3
> 
> 时间：2012-11-08T16:02:45.943
> 
> 标签：sourceforge

我想从 Sourceforge 下载一些文件。

具体来说，我想从[http://sourceforge.net/projects/boost/files/boost-binaries/1.51.0/](http://sourceforge.net/projects/boost/files/boost-binaries/1.51.0/)或更好的下载所有文件，下载与某个正则表达式匹配的所有文件。

你能帮助我吗？

# linux - 在 bash 中读取文件的前三行

> ID：13292756
> 
> 赞同：8
> 
> 时间：2012-11-08T16:02:58.130
> 
> 标签：linux, bash, shell

我有以下 shell 脚本来读取文件的前三行并将它们打印到屏幕上 - 它无法正常工作，因为它打印出第 2、3、4 行而不是第 1、2、3 行 - 我在做什么错误的 ？

```
exec 6< rhyme.txt

while read file <&6 ;
do
        read line1 <&6
        read line2 <&6
        read line3 <&6

        echo $line1 
        echo $line2 
        echo $line3 
done

exec 6<&- 
```

感谢您的回答 - 我知道 head 命令，但想使用读取和文件描述符来显示前三行

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T16:27:19.063

您还可以结合 head 和 while 命令：

```
head -3 rhyme.txt | 
while read a; do
  echo $a; 
done 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-08T16:05:20.123

它读取第一行

```
while read file <&6 ; 
```

它读取第 2、第 3 和第 4 行

```
read line1 <&6
read line2 <&6
read line3 <&6 
```

如果您想阅读前三行，请考虑

> $ head -3 押韵.txt

反而。

**更新**：

如果您想`read`单独使用，请省略`while`循环并执行以下操作：

```
exec 6< rhyme.txt

read line1 <&6
read line2 <&6
read line3 <&6

echo $line1 
echo $line2 
echo $line3 

exec 6<&- 
```

或使用循环：

```
exec 6< rhyme.txt

for f in `seq 3`; do
    read line <&6
    echo $line 
done

exec 6<&- 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-08T16:05:17.383

`read`循环中 有一个`while`，它吃掉了第一行。

您可以使用更简单`head -3`的方法来执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-15T10:02:15.233

我得到了类似的任务，以获取样本 10 条记录并用于`cat`此`head`目的。以下是帮助我的一个班轮`cat FILE.csv| head -11` 在这里，我使用了“11”以便将标题与数据一起包含在内。

# html - 如何将电子邮件副本发送到 php 联系表单中的发件人地址

> ID：13292757
> 
> 赞同：0
> 
> 时间：2012-11-08T16:03:00.830
> 
> 标签：html, http, sendmail, php

我的网站上有一个联系表。我需要用户向我的电子邮件发送消息，它确实这样做了。我还有一个复选框，选中后，用户将收到电子邮件文本框中指示的电子邮件的消息。我的代码仅将其发送到我的电子邮件，但在选中复选框时它不会发送副本。

***联系方式.html***

```
<input type="checkbox" name="sendcopy" value="Yes" checked/>Copy this message to your mail 
```

***发送邮件.php：***

```
$messagebody="Name: ".$name."".PHP_EOL;
$messagebody.="email: ".$email."".PHP_EOL;
$messagebody.="website: ".$website."".PHP_EOL;
$messagebody.="message: ".nl2br($message)."".PHP_EOL;

mail($to,$subject,$messagebody,$headers)or die("The message failed to send");  

if(isset($_POST["sendcopy"]) && $_POST["sendcopy"]=="checked"){
mail($email,$subject,$messagebody,$headers)or die("The message failed to send a copy") 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:42:43.610

在您尝试匹配的片段`if(isset($_POST["sendcopy"]) && $_POST["sendcopy"]=="checked"){`值中是错误的。`$_POST["sendcopy"]`相反，您可以使用只是`if(isset($_POST["sendcopy"]){`检查该复选框是否被选中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:05:11.870

```
if(isset($_POST["sendcopy"]) && $_POST["sendcopy"]=="checked"){
                                                    ^^^^^^^^^ 
```

错误的。它应该是`"Yes"`，因为`value`在形式中定义：

```
if(isset($_POST["sendcopy"]) && $_POST["sendcopy"]=="Yes"){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:10:02.360

```
if (isset($_POST['sendcopy'])) 
```

# symfony - Doctrine2 JOIN 标准

> ID：13292762
> 
> 赞同：1
> 
> 时间：2012-11-08T16:03:11.957
> 
> 标签：symfony, doctrine-orm

我将 SF2.1 与 Doctrine2 一起使用

我有一个这样的模型：

> 文章 1.* ArticleCategory *.1 类别

在我的类别实体中，我想获取与 $this、orderBy article.created 以及 article.published 为 true 相关的所有文章，

我可以 ：

```
$articles = array();
foreach($this->getArticleCategory() as $art_cat){
    $article = $art_cat->getArticle();
    if($article->isPublished()) $articles[] = $article;
} 
```

但它不会处理orderBy，而且它似乎太重了......

Doctrine Collection 中的 Criteria 更合适，但我不知道如何处理关系表，

而且我不想在存储库中执行此操作，因为它涉及特定类别，

对我有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T19:11:22.033

如果文章有：

```
/**
* @ORM\ManyToMany(targetEntity="Category", inversedBy="articles")
*/
private $categories; 
```

和类别有：

```
/**
* @ORM\ManyToMany(targetEntity="Article", mappedBy="categories")
*/
private $articles; 
```

（假设有一个 article_category 连接表，根据 Doctrine 标准）

然后：

```
$articles = $em->getRepository('AcmeBundle:Article')
        ->createQueryBuilder('a')
        ->join('a.categories', 'c')
        ->andWhere('c.id=:category_id')
        ->setParameter('category_id', $categoryId)
        ->andWhere('a.published=TRUE')
        ->orderBy('a.created')
        ->getQuery()->getResult(); 
```

将带来由 $categoryId 标识的类别的已发布文章，按创建日期排序。

# wordpress - 如何将表格重新排列添加到 WordPress 后端？

> ID：13292764
> 
> 赞同：2
> 
> 时间：2012-11-08T16:03:20.380
> 
> 标签：wordpress, themes

我正在尝试制作一个 wordpress 主题，该主题具有可以在表格中添加/删除/重新排列行的功能。理想情况下，我希望它是一个拖放动作。输出需要简单地是一个包含多个标题行的表格，然后是内容行。这是一个演员的网站，所以它是一个简历页面。所以电影>学分剧院>学分

这是最终产品的样子：

![在此处输入图像描述](../Images/84bc48afadfaeb622131e6f1f7d0bcdb.png)

几乎我只是想让用户尽可能轻松地更改他/她的简历。现在我在 tinyMCE 中使用 add-row-below" 按钮，但这可能会让非技术人员感到困惑。

理想情况下，我可以将其添加到 wordpress 内的某个页面，但将它放在主题的设置选项卡中也可以。任何想法，想法，答案都将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T02:33:29.840

对于最终用户，我建议使用自定义字段插件解决方案，如[其他答案](https://stackoverflow.com/a/13400461/1287812) ^([（使用[自定义内容类型管理器](http://wordpress.org/extend/plugins/custom-content-type-manager/)或[高级自定义字段](http://wordpress.org/extend/plugins/advanced-custom-fields/)）])。

以编程方式，可重复字段是要走的路。

这个帮助库可能很有趣，[管理页面类](http://en.bainternet.info/2012/my-options-panel)：

> 与插件和主题一起工作
> 轻松品牌化（通过钩子）。
> 导入导出功能。
> 可用字段有：
> [...]
> 可排序的拖放
> 中继器字段，可以一直设置为可排序
> 的 OOP 代码（这意味着易于扩展和修改）。

[具有可排序可重复字段](https://gist.github.com/2057532) 的元框的 Gist 示例^([[--fork](https://gist.github.com/brasofilo/44f7dbf4b8b0d1eaf25c)]) [![具有可排序可重复字段的元框](../Images/bc15d5ef6d281fd8b4a31eb88a042c93.png)](https://i.stack.imgur.com/g4M9o.png)

还有一个完整的例子在这里：同时[添加自定义图像字段和其他字段](https://stackoverflow.com/a/14452453/1287812)。

# c# - 使用 DataTable.select 时启用区分大小写

> ID：13292771
> 
> 赞同：4
> 
> 时间：2012-11-08T16:03:41.263
> 
> 标签：c#, datatable, dataset, case-sensitive

我的数据库只包括

> 卡车

但是我下面的选择语句返回带有“卡车”的行

```
MyWebControl.Myfunction().Select("TransportationMode = '" + TRUCK + "'"); 
```

我怎样才能使这个选择语句区分大小写？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T16:06:44.883

设置[`DataTable.CaseSensitive`](http://msdn.microsoft.com/en-us/library/system.data.datatable.casesensitive.aspx)为`True`。

假设`Myfunction()`返回一个 DataTable：

```
string TRUCK = "trUck";
var dt = MyWebControl.Myfunction();
dt.CaseSensitive = True;
dt.Select("TransportationMode = '" + TRUCK + "'"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T16:07:36.030

如果您至少在 .NET 3.5 上，则可以使用`linq`比`DataTable.Select`语法更强大和可读性更强的版本。

```
string mode = "Truck";
var rows = table.AsEnumerable()
                .Where(r = > r.Field<string>("TransportationMode") == mode); 
```

默认情况下区分大小写。

# forms - Magento 后端，捕获不同元素上的 onclick 事件

> ID：13292772
> 
> 赞同：0
> 
> 时间：2012-11-08T16:03:42.267
> 
> 标签：forms, magento, onclick, backend, magento-1.7

我有一个具有各种形式的工作后端模块来管理几个不同的表。在其中一个表单上，我有一个单选按钮组（`radios`Magento 上的元素）。这是此广播组的代码片段：

```
//radio group
$fieldset->addField('radio_group', 'radios', array(
        'label'     => Mage::helper('banners')->__('Select campaign type'),
        'name'      => 'title',
        'onclick'   => '',
        'onchange'  => '',
        'value'     => '1',
        'values'    => array(
                        array('value'=>'1','label'=>'Imagen'),
                        array('value'=>'2','label'=>'HTML'),
                        array('value'=>'3','label'=>'Producto'),
                        ),
        'disabled'  => false,
        'readonly'  => false,
        'tabindex'  => 3
)); 
```

我无法找到如何管理`onclik`这些`onchange`事件。我需要在哪里添加代码？要执行的操作很简单，我将根据选定的单选按钮启用/禁用同一页面上的其他控件。

任何建议，示例代码，教程？我做了很多*谷歌搜索*但没有运气，我找到了很多样本​​，但都提到了如何设置新的管理表单，我已经做过几次了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:49:22.023

```
$fieldset->addField('use_color_filter', 'select', array(
            'label'     => Mage::helper('gtfilter')->__('Usar filtro de cores'),
            'class'     => 'required-entry',
            'required'  => true,
            'name'      => 'use_color_filter',
            'onclick' => "javascript: alert('a');",
            'onchange' => "",
            'value'  => Mage::registry("use_color_filter"),
            'values' => array("0" => "Não", "1" => "Sim"),
            'after_element_html' => '<small style="color : red; font-weight : bold;" >Requer que o módulo de cores esteja instalado! Lembrando que o atributo de cores deve estar habilitado para buscas avan�adas! </small>',
            'tabindex' => 1
    )); 
```

我已经尝试过了，对我来说效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T17:12:31.110

解决此问题的一种方法是将更新 layout.xml 添加到您的模块（或 local.xml）

您可以使用两种不同的方法将 js 包含在 layout.xml 中，唯一不同的是您需要将 js 文件放在哪里

Javascript 位置：/js/your_js_file.js

```
<adminhtml_xxx_yyy>
    <reference name="head">
        <action method="addJs"><script>your_js_file.js</script></action>
    </reference>
</adminhtml_xxx_yyy> 
```

或者

Javascript 位置：/skin/adminhtml/default/default/your_js_file.js

```
<adminhtml_xxx_yyy>
    <reference name="head">
        <action method="addItem"><type>skin_js</type><name>your_js_file.js</name></action>
    </reference>
</adminhtml_xxx_yyy> 
```

为每个单选按钮添加一个 css 类名

```
$fieldset->addField('radio_group', 'radios', array(
   ......
   'class'     => 'campaign_type',
   ....
)); 
```

在 your_js_file.js ( [http://fiddle.jshell.net/hX2u3/](http://fiddle.jshell.net/hX2u3/) )

```
$$('.campaign_type').each(function(curInput) {
   Event.observe(curInput, 'click', function() {
        alert('some click logic goes here');
    });
   Event.observe(curInput, 'change', function() {
        alert('some change logic goes here');
    });
});​ 
```

# delphi - 使用 MemoryStream.CopyFrom 时访问冲突

> ID：13292775
> 
> 赞同：0
> 
> 时间：2012-11-08T16:03:50.903
> 
> 标签：delphi, stream, access-violation

好吧，这会很长！

我为我正在研究的 LAN 模拟协议制定了一个用于管理丢弃的 UDP 数据包的重传方案。

### 数据包存储

```
TDataBuffer = record

  PacketID : WORD;
  Packet   : TMemoryStream;

end;
PDataBuffer = ^TDataBuffer; 
```

### 相关 DataModule 类成员

```
fRxDataPacketList  : TThreadList20;
fTxDataPacketList  : TThreadList20;

procedure CreateDataBuffer
          (PacketID : WORD; Packet : TMemoryStream;
           var DataBuffer : PDataBuffer);

procedure DestroyDataBuffer
          (var DataBuffer : PDataBuffer);

procedure AddPacketToPacketList
          (PacketID : WORD; Packet : TMemoryStream;
           RecievedPacket : Boolean);

function  GetPacketFromTxDataPacketList
          (PacketID : WORD; var Packet : TMemoryStream): Boolean; 
```

TThreadList20：它是我自己的线程友好、加密和压缩支持的 TList 包装类。

还有另一个处理 Rx 端的过程与我的问题无关，所以我跳过它。

### 创建

```
procedure TDataModuleClient.CreateDataBuffer
          (PacketID : WORD; Packet : TMemoryStream; 
           var DataBuffer : PDataBuffer);

begin

  New (DataBuffer);
  DataBuffer.PacketID := PacketID;
  DataBuffer.Packet   := TMemoryStream.Create;

  if Assigned (Packet) then 
  begin

    DataBuffer.Packet.CopyFrom (Packet,Packet.Size); // NO AV HERE
    DataBuffer.Packet.Position := 0;

  end;

end; 
```

### 破坏

```
procedure TDataModuleClient.DestroyDataBuffer
          (var DataBuffer : PDataBuffer);
begin

  DataBuffer.Packet.Free;
  Dispose (DataBuffer);

end; 
```

### 添加到列表

```
procedure TDataModuleClient.AddPacketToDataPacketList
          (PacketID : WORD; Packet : TMemoryStream; RecievedPacket : Boolean);
var
  DataBuffer : PDataBuffer;

begin

  CreateDataBuffer (PacketID,Packet,DataBuffer);

  if RecievedPacket then
    fRxDataPacketList.Add (TObject (DataBuffer))

  else
  begin

    fTxDataPacketList.Lock;

    try

      fTxDataPacketList.Add (TObject (DataBuffer));

      if fRxDataPacketList.Count = 21 then
      begin

        DataBuffer := PDataBuffer (fTxDataPacketList [0]);

        DestroyDataBuffer (DataBuffer);
        fTxDataPacketList.Delete (0);

      end;

    finally fTxDataPacketList.Unlock;
    end;

  end;

end; 
```

### 从列表中提取

```
function  TDataModuleClient.GetPacketFromTxDataPacketList
          (PacketID : WORD; var Packet : TMemoryStream): Boolean;
var
  DataBuffer : PDataBuffer;
  I          : Integer;

begin

  Result := False;
  fTxDataPacketList.Lock;

  try

    for I := fTxDataPacketList.Count - 1 downto 0 do
    begin

      DataBuffer := PDataBuffer (fTxDataPacketList [I]);

      if DataBuffer.PacketID < PacketID then
      begin

        DestroyDataBuffer (DataBuffer);
        fTxDataPacketList.Delete (I);

      end
      else if DataBuffer.PacketID = PacketID then
      begin

        Result := True;

        Packet := TMemoryStream.Create;

        Packet.CopyFrom
        (DataBuffer.Packet,DataBuffer.Packet.Size); // AV HERE
        Packet.Position := 0;

        DestroyDataBuffer (DataBuffer);
        fTxDataPacketList.Delete (I);

        break;

      end;

    end;

  finally fTxDataPacketList.Unlock;
  end;

end; 
```

数据包：输出变量。

请帮帮我，我知道由于代码量很大，推断出一些东西看起来是一项艰巨的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T18:56:35.160

基于这个有限的代码，我做了一些猜测：

1)在您`Packet`调用. 这将解释 AV。`GetPacketFromTxDataPacketList()``CopyFrom()`

2）由于`Packet`参数被声明为 a `var`，这向我表明它是一个`GetPacketFromTxDataPacketList()`应该创建和返回的输出参数，而不是让调用者创建`TMemoryStream`并传递它`GetPacketFromTxDataPacketList()`以填充数据。这也适用于＃1，因为`GetPacketFromTxDataPacketList()`不是创建新`TMemoryStream`对象，而是假设对象已经事先创建。

# c++ - 与标准库名称冲突

> ID：13292786
> 
> 赞同：1
> 
> 时间：2012-11-08T16:04:22.023
> 
> 标签：c++

我的项目使用第三方模块，其中一个头文件定义了“errc”

```
typedef int             errc; 
```

我想在项目中使用 STL，但是当我添加 stl 头文件时，我得到 errc 的名称冲突，因为它在标准库中的类名。

```
error C2872: 'errc' : ambiguous symbol 
```

我真的不想更改第三方模块，有什么办法可以解决这个问题并使用项目中的标准库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T23:46:47.167

不要在文件中使用

```
using namespace std; 
```

但是你仍然可以将它包含在函数中，比如

```
void f()
{
  using namespace std;

  cout<<endl;
} 
```

# tsql - T-SQL 如何仅更新底部/最后一行？

> ID：13292789
> 
> 赞同：10
> 
> 时间：2012-11-08T16:04:22.027
> 
> 标签：tsql, sql-update, record

我想更新表格中的底部/最后一行。我已尝试实现[此](https://stackoverflow.com/questions/1198364/how-can-i-update-top-100-records-in-sql-server)解决方案，但似乎没有正确的语法：

```
UPDATE TOP(1) @ResultTable
SET PeriodLastDate=DATEADD(DAY,-1,PeriodLastDate)
ORDER BY PeriodID DESC 
```

或者

```
UPDATE TOP(1) @ResultTable
SET PeriodLastDate=DATEADD(DAY,-1,PeriodLastDate)
FROM @ResultTable
ORDER BY PeriodID DESC 
```

我现在工作的是：

```
UPDATE @ResultTable
SET PeriodLastDate=DATEADD(DAY,-1,PeriodLastDate)
WHERE PeriodID=(SELECT COUNT(PeriodID) FROM @ResultTable)-1 
```

但这并不总是有效，因为在我的函数中，一些记录被删除了，而且我的 PeriodID 并不总是以 1 递增。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-08T16:07:08.667

```
;WITH CTE AS 
( 
SELECT TOP 1 * 
FROM @ResultTable
ORDER BY PeriodID DESC
) 
UPDATE CTE SET PeriodLastDate=DATEADD(DAY,-1,PeriodLastDate) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-08T16:08:28.390

您的问题中没有足够的上下文来给出无懈可击的答案。根据您的工作解决方案，如何不查找最大 PeriodID 的计数？只要后续 PeriodID 的值更大，它就应该可以获取“最后一个”记录。

```
UPDATE @ResultTable
SET PeriodLastDate=DATEADD(DAY,-1,PeriodLastDate)
WHERE PeriodID=(SELECT MAX(PeriodID) FROM @ResultTable) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:09:28.017

如果您在每一行中都有一个唯一列（可能是 PeriodID？），您可以执行以下操作：

```
UPDATE @ResultTable
SET PeriodLastDate=DATEADD(DAY,-1,PeriodLastDate)
where <unique column> = (select top 1 <unique column> 
  from @ResultTable
  order by PeriodID desc
  ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-14T22:08:41.257

关于什么 ：

```
UPDATE ResultTable SET PeriodLastDate='NewValue' WHERE ID= (SELECT MAX(ID) FROM ResultTable) 
```

# linux - 将端口 80 上的所有传出流量重定向到同一服务器上的不同 IP

> ID：13292790
> 
> 赞同：2
> 
> 时间：2012-11-08T16:04:25.293
> 
> 标签：linux, routing, ip, iptables

我在同一台服务器上有多个 IP 地址，我想将端口 80 上的所有传出流量重定向到同一台服务器上的不同 IP，只是不使用始终主 IP。

目前我正在使用这个：

```
/sbin/iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to-source IP; 
```

它运行良好，但它会重定向所有内容，当我通过 SSH 备份进行备份时，它失败了。

系统：CentOS 5.8 64位

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T20:08:48.327

这有效：

```
iptables -t nat -A POSTROUTING -p tcp --dport 80 -o eth0 -j SNAT --to-source IP 
```

# android - 未发现身份验证挑战相关讨论可在 Internet 上找到

> ID：13292796
> 
> 赞同：5
> 
> 时间：2012-11-08T16:04:40.160
> 
> 标签：android, twitter4j, nexus-7

我有一些使用 Twitter4J 连接 Twitter API 的典型代码。他们在 android 1.x 和 2.x 中运行良好。3.x 4.x 但在带有 Nexus 7 设备的 Android 4.1.1 和 4.1.2 中失败了！资源：

```
private void retrieveRequestToken() {   
    mSpinner.show();  
    new Thread() {  
        @Override  
        public void run() {  
          try {  
            mRequestToken = mTwitter.getOAuthRequestToken(Twitter.CALLBACK_URI);
            mUrl = mRequestToken.getAuthorizationURL();
            mWebView.loadUrl(mUrl);
          } catch (TwitterException e) {
            mListener.onError(new DialogError(e.getMessage(), -1, Twitter.OAUTH_REQUEST_TOKEN));   
        }
    }  
    }.start();  
} 
```

例外：未发现身份验证挑战相关讨论可在 Internet 上找到

当我尝试使用 OAuthToken 时，问题就出现了->`mTwitter.getOAuthRequestToken(Twitter.CALLBACK_URI);`

有人可以帮忙调查这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T11:10:50.767

我发现问题只是在设备上正确设置了小时和日期！！！！转到电话设置，然后单击“日期和时间”并选择“自动”（请确保您的设备时区和时间、日期均正确）如果您的时间、日期和时区不正确，则您无法连接 twitter .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T15:53:00.880

我的日期和时间设置正确，但我刚刚重新启动手机并开始工作

# html - 单元格表格中的翻转图像覆盖先前的单元格图像 - 表格中的重复图像

> ID：13292799
> 
> 赞同：0
> 
> 时间：2012-11-08T16:04:51.747
> 
> 标签：html, css, html-table, cells, repeat

我正在尝试在每个表格单元格中制作带有超链接的翻转图像，但由于某种原因，我制作的每个后续单元格都覆盖了它*之前*的单元格.:。每个单元格成为一个重复的图像。代码在我第一次编写时运行良好；这完全出乎意料。这是两个相邻单元格的图像代码 - 由于某种原因对我来说发生了什么，第二个单元格也一直显示为第一个单元格图像。

```
<table style="width: 655px; height: 630px; border: 2px dotted black;">
<tbody>
<tr align="center">    
<td style="border: 2px dotted black; width: 220px; height: 210px;"> <style type="text/css">
.rollover a {display: block;
  width: 210px;
  height: 155px;
  background-image: url( IMG1a );}
.rollover a:hover{display: block;
  width:210px;
  height: 155px;
  background-image: url( IMG1b );}
</style><div class="rollover"> <a href="link1"></a></div></td>

<td style="border: 2px dotted black; width: 220px; height: 210px;"> <style type="text/css">
.rollover a {display: block;
  width: 210px;
  height: 155px;
  background-image: url( IMG1a );}
.rollover a:hover{display: block;
  width:210px;
  height: 155px;
  background-image: url( IMG1b );}
</style><div class="rollover"> <a href="link1"></a></div></td></tr></tbody></table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:13:38.293

如果没有更大的 HTML 块，我假设您在页面中逐字记录了它。`<style>`元素不限于页面的一部分。因此，如果页面中有这两个样式元素，最后一个语句将覆盖第一个语句并影响两个 div。

要解决此问题，您必须提供每个`div`或`a`特定的选择器，例如`id`：

```
<style type="text/css">
#first-div.rollover a {display: block;
  width: 210px;
  height: 155px;
  background-image: url( IMG1a );}
#first-div.rollover a:hover{
  background-image: url( IMG1b );}

#second-div.rollover a {display: block;
  width: 185px;
  height: 131px;
  background-image: url( IMG2a );}
#second-div.rollover a:hover{
  background-image: url( IMGb );}
</style>

<div class="rollover" id="first-div">
  <a href="link1"></a>
</div>
<div class="rollover" id="second-div">
  <a href="link2"></a>
</div> 
```

和往常一样，将您的标签包含`<style>`在您的`<head>`标签中，甚至更好地包含在单独的文件中！

# python - 使用 Python 解析 XML 文件并在每个列表元素中获取字母“u”

> ID：13292800
> 
> 赞同：1
> 
> 时间：2012-11-08T16:04:57.657
> 
> 标签：python, xml, regex, list, parsing

我有一个包含如下元素的 XML 文件：

```
<RMS>[14.470156174, 14.470156174, 14.485567944, 14.496014765]</RMS> 
```

我想得到一个包含所有元素的列表

所以我用以下代码尝试了一些正则表达式：

```
 string = dom.getElementsByTagName('RMS')[0].toxml()
      string2 = re.findall("[\-]*[0-9]*\.[0-9]*", string) 
```

现在，当我想打印列表时，它看起来像这样：

```
 [u'14.470156174', u'14.470156174', u'14.485567944', u'14.496014765'] 
```

“你”是怎么回事？
有什么想法可以解决这个问题吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:09:01.673

以 a 开头的字符串`u`是[unicode 字符串文字](http://docs.python.org/2/reference/lexical_analysis.html#strings)。由于 XML 包含 unicode 数据，XML 解析器以正确的类型返回您的数据，即 python[`unicode()`类型](http://docs.python.org/2/library/functions.html#unicode)。

你不需要删除它们，你没有问题。您可能想在[Python Unicode HOWTO](http://docs.python.org/2/howto/unicode.html)中阅读有关 Unicode 和 Python 的内容，但这里没有问题。

由于这些是数字，因此您可以将 unicode 值直接转换为浮点实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:10:08.537

这里不需要使用正则表达式。实际上，您的正则表达式可能不适用于某些浮点数，例如`1.4e1`.

由于您使用的是 minidom，您可以这样做：

```
import xml.dom.minidom as minidom
import ast

content = "<RMS>[14.470156174, 14.470156174, 14.485567944, 14.496014765]</RMS> "
dom = minidom.parseString(content)
text = dom.getElementsByTagName('RMS')[0].childNodes[0].wholeText 
```

如果你

```
print(text) 
```

你得到

```
[14.470156174, 14.470156174, 14.485567944, 14.496014765] 
```

但如果你

```
print(repr(text)) 
```

你得到

```
u'[14.470156174, 14.470156174, 14.485567944, 14.496014765]' 
```

`u`表示这是`text`一个`unicode`对象，而不是一个`str`对象。同样，您的代码会生成一个`unicode`对象列表。打印列表时，Python 会打印列表`repr`中每个元素的 。这就是为什么你看到

```
[u'14.470156174', u'14.470156174', u'14.485567944', u'14.496014765'] 
```

现在重新阅读您的问题后，我看到您想要`text`. 由于它们是数字，我假设您想要一个浮点数列表。在这种情况下，您可以使用`ast.literal_eval`：

```
values = ast.literal_eval(text)
print(values) 
```

产量

```
[14.470156174, 14.470156174, 14.485567944, 14.496014765] 
```

`values`浮点数列表在哪里。

# ruby-on-rails - 红宝石包括？使用 YAML 数组

> ID：13292801
> 
> 赞同：2
> 
> 时间：2012-11-08T16:05:00.173
> 
> 标签：ruby-on-rails, ruby, arrays, yaml, conditional-statements

我有一个带有以下数组的配置 YAML 文件：

```
EMAILS: ['email1@example.com', 'email2@example.com', 'email3@example.com'] 
```

然后我想在这个 YAML 数组中搜索一个特定的字符串，比如“email1@example.com”。

我使用以下红宝石代码：

```
if CONFIG[:EMAILS].include?("email1@example.com")
  return true
else
  return false
end 
```

但是，这总是返回 false。

我可以`PUTS`阵列`CONFIG[:EMAIL]`罚款。

谁能建议我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:12:03.583

您使用的是符号，而 YAML 哈希使用字符串作为键。这应该有效：

```
if CONFIG['EMAILS'].include?("email1@example.com")
  return true
else
  return false
end 
```

顺便说一句，这相当于简单地

```
return CONFIG['EMAILS'].include?("email1@example.com") 
```

# c++ - 类模板中定义的友元函数定义的范围是什么/在哪里？

> ID：13292813
> 
> 赞同：3
> 
> 时间：2012-11-08T16:05:22.077
> 
> 标签：c++

> **可能重复：**
> [内联友元函数的范围是什么？](https://stackoverflow.com/questions/8207633/whats-the-scope-of-inline-friend-functions)

考虑简单的程序：

```
template<typename T> struct foo{
friend void bar(){}
};

int main(){
foo<int>(); foo<float>();
} 
```

上面的代码违反了 ODR 规则，我想知道为什么？，还有功能范围在哪里`bar`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:13:28.743

`friend`函数不是成员函数；您只需在类中声明友谊，但该函数始终是自由函数。如果您在类模板类中定义它，您最终将定义它的次数与您拥有的模板实例一样多。

我将尝试用代码解释这一点。出于我们的目的，您的代码等效于：

```
template<typename T> struct foo{
};

template<> struct foo<int>{
  friend void bar();
};

void bar() {};

template<> struct foo<double>{
  friend void bar();
};

void bar() {};

int main(){
  foo<int>(); foo<float>();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:17:35.193

因为您的代码定义了`void bar()`两次免费函数，或者更确切地说，您的模板为每个实例化生成一个名为 的新函数`void bar()`，该函数每次都具有完全相同的签名，因此您有多个具有相同签名的函数，这是一种违规行为的 ODR。

手头的技术称为“朋友名称注入”，因为您将名称注入周围的名称空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:09:01.540

你已经**定义**了`bar`你的`struct`. 这导致`bar`func 的双重定义，每个模板实例化一次。`Friend`应该只是某个实体的声明。实体本身（在您的情况下为 func ）应在其他地方定义。用声明替换您的`bar`定义并在另一个地方定义您的。`friend void bar();``bar`

# ios6 - 为什么我的 MPMediaItem NowPlayingItem 返回 null？

> ID：13292816
> 
> 赞同：1
> 
> 时间：2012-11-08T16:05:30.153
> 
> 标签：ios6, mpmediaitem

我在我的应用程序中加入了 iPod 播放器。我可以创建一个队列，然后播放歌曲。我无法获得当前歌曲的属性值。我已经注册了通知，并且日志显示通知已被触发。

```
MPMediaItem *currentItem = self.musicPlayer.nowPlayingItem;
NSLog(@"currentItem = %@", currentItem); 
```

日志输出显示：currentItem = (null)

我正在运行 Xcode 4.5.2 iOS 6.0。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:52:39.763

对于可能遇到相同问题的其他任何人，问题是我在运行我的应用程序后同步了我的音乐。您需要观察库的变化：

```
MPMediaLibraryDidChangeNotification

[[MPMediaLibrary defaultLibrary] beginGeneratingLibraryChangeNotifications]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T12:51:59.910

你在你的代码中写过`NSLog(@"currentItem = %@", currentItem);`，但也许你还没有完全理解 MPMediaItem 是什么。

MPMediaItem 不是 NSString，这就是你在这里得到 null 的原因。MPMediaItem 有很多属性，包括歌曲名称、专辑名称和艺术家姓名。要访问 MPMediaItem 的属性（例如标题），请使用 valueForProperty: 方法。

```
NSLog(@"currentItem = %@", [currentItem valueForProperty:MPMediaItemPropertyTitle]) 
```

像这样的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T06:26:46.277

我也有不小心把应用播放器混在一起的问题

```
[MPMusicPlayerController applicationMusicPlayer] 
```

和 iPod 播放器

```
[MPMusicPlayerController iPodMusicPlayer] 
```

我正在使用 iPodMusicPlayer 播放音乐，并试图调整应用程序MusicPlayer 的音量。

所以请注意不要无意中混合它们;-)

# c# - 并行 Linq 查询无法执行

> ID：13292817
> 
> 赞同：0
> 
> 时间：2012-11-08T16:05:32.100
> 
> 标签：c#, linq, plinq

您好，我刚刚开始尝试了解 Parallel Linq，但我的第一次尝试没有成功。我正在使用 EF 4.0 和我创建的用于查询数据的存储库模式类。我不认为存储库模式是问题，但我可能弄错了。

我拥有的数据库没有按照我想要的方式设置，但是我继承了系统。我遇到问题的代码如下：

```
 var gId = Sql.ToGuid(Request["ID"]);

            var lOrdersGridList = new OrdersGridList(); //Class that only contains properties

            var lOrdersForContact = new BaseRepository<ORDER>()
                .Find(i => i.ORDERS_CONTACTS.Where(b => b.CONTACT_ID == gId).Count() > 0).AsParallel()
                .Select(i =>
                    new OrdersGridList
                        {
                            ORDER_ID = i.ID,
                            ORDER_NUM = i.ORDER_NUM,
                            SHIPPING_ACCOUNT_ID = i.ORDERS_ACCOUNTS.Where(b =>  b.ORDER_ID == i.ID && b.ACCOUNT_ROLE == "Ship To").First().ACCOUNT_ID,
                            SHIPPING_ACCOUNT_NAME = i.ORDERS_ACCOUNTS.Where(b => b.ORDER_ID == i.ID && b.ACCOUNT_ROLE == "Ship To").First().ACCOUNT.NAME,
                            SHIPPING_CONTACT_ID = i.ORDERS_CONTACTS.Where(b => b.ORDER_ID == i.ID && b.CONTACT_ROLE == "Ship To").First().CONTACT_ID,
                            SHIPPING_CONTACT_NAME = i.ORDERS_CONTACTS.Where(b => b.ORDER_ID == i.ID && b.CONTACT_ROLE == "Ship To")
                                                                .Select(b => new { SHIPPING_CONTACT_NAME = (b.CONTACT.FIRST_NAME + ' ' + b.CONTACT.LAST_NAME) }).First().SHIPPING_CONTACT_NAME,
                            NAME = i.NAME

                        }).DefaultIfEmpty(lOrdersGridList).ToList<OrdersGridList>();

            grdMain.DataSource = lOrdersForContact.ToDataTable().DefaultView; //ToDataTable extension function converts the List Object to a datatable. 
```

如果我在没有 AsParallel 的情况下运行代码，则代码执行没有问题，但是一旦添加 AsParallel，我会收到以下错误：

![错误信息](../Images/07539928bf9e26eec899e12cd247980b.png)

另外，以防万一您想看到这是我为 Select Above 声明为新的类：

```
public class OrdersGridList : EntityObject
{
    public string ORDER_NUM { get; set; }

    public Guid ORDER_ID { get; set; }

    public Guid SHIPPING_ACCOUNT_ID { get; set; }

    public string SHIPPING_ACCOUNT_NAME { get; set; }

    public Guid SHIPPING_CONTACT_ID { get; set; }

    public string SHIPPING_CONTACT_NAME { get; set; }

    public string NAME { get; set; }
} 
```

如果我删除了用于在选择中检索数据的所有关系，我不会收到任何错误：

```
 var lOrdersForContact = new BaseRepository<ORDER>()
                .Find(i => i.ORDERS_CONTACTS.Where(b => b.CONTACT_ID == gId).Count() > 0).AsParallel()
                .Select(i =>
                    new OrdersGridList
                        {
                            ORDER_ID = i.ID,
                            ORDER_NUM = i.ORDER_NUM,
                            //SHIPPING_ACCOUNT_ID = i.ORDERS_ACCOUNTS.Where(b =>  b.ORDER_ID == i.ID && b.ACCOUNT_ROLE == "Ship To").First().ACCOUNT_ID,
                            //SHIPPING_ACCOUNT_NAME = i.ORDERS_ACCOUNTS.Where(b => b.ORDER_ID == i.ID && b.ACCOUNT_ROLE == "Ship To").First().ACCOUNT.NAME,
                            //SHIPPING_CONTACT_ID = i.ORDERS_CONTACTS.Where(b => b.ORDER_ID == i.ID && b.CONTACT_ROLE == "Ship To").First().CONTACT_ID,
                            //SHIPPING_CONTACT_NAME = i.ORDERS_CONTACTS.Where(b => b.ORDER_ID == i.ID && b.CONTACT_ROLE == "Ship To")
                            //                                    .Select(b => new { SHIPPING_CONTACT_NAME = (b.CONTACT.FIRST_NAME + ' ' + b.CONTACT.LAST_NAME) }).First().SHIPPING_CONTACT_NAME,
                            NAME = i.NAME

                        }).DefaultIfEmpty(lOrdersGridList).ToList<OrdersGridList>(); 
```

如果需要，我将非常乐意提供更多信息。您可以提供有关使用 Plinq 的任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:00:57.720

在我看来，该类使用and参数`BaseRepository`创建了某种 LINQ to Entities 查询。`Find``Select`

Using`AsParellel`用于 LINQ to Objects，您的代码在其中实际*评估*您传递的表达式。其他 LINQ 方言，包括 LINQ to Entities，将其*翻译*成不同的查询语言，如 SQL。SQL 服务器可以自己进行合理的并行化。

# ruby-on-rails - 方法为真的即时变量

> ID：13292818
> 
> 赞同：0
> 
> 时间：2012-11-08T16:05:34.993
> 
> 标签：ruby-on-rails, where

在我的控制器中，我有一个带有`where`方法的即时变量，它是搜索控制器中过滤器的一部分。

```
@items = @items.where([ 'borrowable = ?', true]) if params[:top_filter] == 'borrow' 
```

这`borrowable = ?, true`一点是完全错误的。我想要的是通过使用被调用的方法来过滤`@items`可**借用**的。`Item's model``borrowable?`

我该怎么做呢？

中的方法`Item model`如下。

```
 def borrowable?(current_user, user, item, controller)
      false
      if user.invited?(current_user, user)
        item.pieces.each do |piece|
          if piece.available?(current_user, piece)
            true
          end
        end
        if controller == "pages"
          true
        end
      end
    end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:10:11.960

如果它依赖于模型级代码，那么您将无法将其放在 where 子句中。where 子句试图获取项目列表，但在每个项目上您都想调用一个方法，但在获取项目之前您没有该方法。您可能会在数据库上使用存储过程，但仅在 Rails 代码中您可以这样做：

```
@items = @items.keep_if { |item| item.borrowable? } if params[:top_filter] == 'borrow' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:10:23.927

你不能！ActiveRecord 对数据库进行查询，然后使用返回的数据构建对象。所以在返回数据之前，不存在 ruby​​ 对象，并且不能使用他们的方法。

如果您能够使用“计算”​​（在 SQL 意义上）表示相同的信息，那么您可以通过

```
@items.where("some sql condition/calculation")... 
```

# asp.net-mvc - 重新附加修改后的实体时让实体框架级联删除

> ID：13292825
> 
> 赞同：0
> 
> 时间：2012-11-08T16:06:07.343
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first

我正在使用带有 EF 代码优先方法的 MVC4 开发一个网站。

我在删除具有一对多关系的实体中的孩子时遇到了一些问题。

**编辑以清除：**在我的编辑视图中，我在父级的子集合中添加/删除/更新现有子项，添加/删除是使用 javascript 完成的。当我在控制器方法的发布请求中收到更新的父级时，我想同步/更新数据库中的父级和子级实体。父对象在视图中更新时处于分离状态。因此，当我再次附加父级时，我希望它执行在分离状态期间已完成的所有更新。

设置实体关系，以便从父集合中删除子实体时，子实体也会从子表中删除（级联删除排序？），这在处于附加状态时有效。

但是，在附加父级并保存更改时，仅在数据库中添加/修改添加/更新的子级。但是从父集合中删除的子项不会在数据库中删除（我希望它们是）。

这个怎么解决？？

实体是：

```
class Parent
{
    public virtual ICollection<Child> Children { get; set; }
}
class Child
{
    public string Text { get; set; }
} 
```

**这有效，将从数据库中删除子项**：

```
void RemoveChildFromCollection()
{
    // get the first parent and remove the first child in collection
    var context = new DatabaseContext();
    var parent = context.Parents.First();
    parent.Children.Remove(parent.Children.First());
    context.SaveChanges();
} 
```

ControllerMethod：**这和上面一样不起作用，移除的孩子不会从孩子的表中移除**

```
public ActionResult Edit(Parent parent)
{
    var context = new DatabaseContext();
    context.Entry(parent).State = System.Data.EntityState.Modified;
    context.SaveChanges();
    return View();
} 
```

模型构建器设置为在从父集合中删除子表时从子表中删除子实体

```
// Use Identifying relation. Define complex key for ChildObject containing both Id and 

ParentObjectId
modelBuilder.Entity<Child>()
    .HasKey(c => new {c.ChildID, c.ParentID});

// Because defining such key will remove default convention for auto incremented Id you must redefine it manually

modelBuilder.Entity<Child>()
    .Property(c => c.ChildID)
    .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);

// Set cascade delete

modelBuilder.Entity<Parent>()
    .HasMany(p => p.Children)
    .WithRequired()
    .HasForeignKey(c => c.ParentID)
    .WillCascadeOnDelete(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:35:09.530

级联删除仅删除子实体，当父实体也被删除时，正如您所指出的，而不是在您切断关系时。

您可以`SaveChanges()`在 Context 中覆盖您的以清理孤立`Child`实体，如下所示：

```
public override int SaveChanges()
{
    Children
        .Local
        .Where(c => c.Parent == null)
        .ToList()
        .ForEach(child => Children.Remove(child));

    return base.SaveChanges();
} 
```

此[博客文章](http://blog.oneunicorn.com/2012/06/02/deleting-orphans-with-entity-framework/)包含有关处理孤立实体的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:36:10.073

当您在视图中进行修改时，您的实体（父级和子级）处于分离状态。因此，EF 无法跟踪这些更改。当您将对象图附加到上下文时 - 通过将父对象的状态设置为`Modified`- EF 将此附加对象图作为当前状态，并且不知道在视图中的分离阶段发生的子对象的删除。

要解决此问题，您必须从数据库加载当前对象图 - 包括子对象的父对象，将其与视图中的对象图进行比较，并将更改合并到加载的图中。然后保存更改。可能有几种可能的变化：

*   父级的标量属性可能已更改
*   孩子的标量属性可以改变
*   一个新的孩子可能已添加到`Children`集合中
*   一个孩子可能已从`Children`集合中移除

您当前的代码 - 将父母的状态设置为`Modified`- 只会正确处理第一种情况，但不能正确处理其他三种情况。

要处理所有四种情况，您需要遵循上述过程。[此处](https://stackoverflow.com/a/13237269/270591)显示了如何执行此操作的示例（请参阅该答案中的**编辑**部分）。

您的 Edit post 操作中的代码将如下所示：

```
public ActionResult Edit(Parent parent)
{
    using (var context = new DatabaseContext())
    {
        var parentInDb = context.Parents
            .Include(p => p.Children)
            .Single(p => p.ParentId == parent.ParentId);

        context.Entry(parentInDb).CurrentValues.SetValues(parent);

        foreach (var childInDb in parentInDb.Children.ToList())
            if (!parent.Children.Any(c => 
                    c.ChildId == childInDb.ChildId &&
                    c.ParentId == childInDb.ParentId)) // or == parent.ParentId
                context.Children.Remove(childInDb);
                // here
                // parentInDb.Children.Remove(childInDb);
                // should work too because you have an identifying relationship

        foreach (var child in parent.Children)
        {
            var childInDb = parentInDb.Children.SingleOrDefault(c =>
                c.ChildId == child.ChildId &&
                c.ParentId == child.ParentId); // or == parent.ParentId
            if (childInDb != null)
                context.Entry(childInDb).CurrentValues.SetValues(child);
            else
                parentInDb.Children.Add(child);
        }
        context.SaveChanges();

        return View();
    }
} 
```

# jquery - jQuery Parallax - 移动文本

> ID：13292830
> 
> 赞同：1
> 
> 时间：2012-11-08T16:06:13.620
> 
> 标签：jquery, parallax

刚刚进入整个“视差滚动”现象，并有更多的一般用例和实现问题。

在[http://www.ianlunn.co.uk/plugins/jquery-parallax/](http://www.ianlunn.co.uk/plugins/jquery-parallax/)和[http://www.zensorium.com/tinke/](http://www.zensorium.com/tinke/)等网站上，似乎具有“视差”效果的元素是背景图像。这是视差滚动的工作方式（或者更清楚地说，它的唯一工作方式）？

在[我正在开发的网站上](http://yhmags.com/katz-brand/)，我试图对每个网站`section-header`（带有红线的大文本）应用相同类型的效果，以从其下方的内容开始（第一列有 2 列，赞助商区域位于第二）然后滚动，出现在内容上方。我在想视差滚动将是我想要以流畅的方式显示内容的方式。我还研究了[滚动视差](http://jonraasch.com/blog/scrolling-parallax-jquery-plugin)，认为这可能是要走的路，但我更喜欢我要去的方向，因为我不确定我是否正确地接近这个。任何想法将不胜感激。谢谢！

# c# - 在 C# 中保存 XML 文件而不使用 XCData

> ID：13292831
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:06:21.260
> 
> 标签：c#, xml, xcdatamodel

我在 C# 上有一个这样的字符串：

```
string sxml="<id>xpto</id>" 
```

我想使用 Xlinq 保存一个 xml 文件：

```
XElement cursosXML = new XElement("MenuItem", new XCData(sxml));
cursosXML.save("C:\\xpto.xml") 
```

当我阅读我的 xml 文件时，会出现：

```
<MenuItem><![CDATA[<id>xpto</id>]]></MenuItem> 
```

但我不想`<![CDATA[`

我怎样才能得到这个结果？

```
<MenuItem>&lt;xpto&gt;3&lt;</MenuItem> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:17:05.163

这是您应该如何将字符串添加到元素的方法

```
 XElement sxml = XElement.Parse("<id>xpto</id>");
        XElement cursosXML = new XElement("MenuItem", sxml);
        cursosXML.Save("C:\\xpto.xml"); 
```

**以下是您遇到的麻烦的解释。仅供参考**

`<id>xpto</id>`是一个 XML 元素，但是您将它添加到当前元素中，就好像它是一个文字字符串一样。当你这样做时，计算机不会认为你正在向你的主元素添加一个新的子元素，所以它会转义它（稍后解释）

我发布的代码调用`XElement.Parse(string)`，它将获取您的序列化 xml 字符串，并尝试从中生成一个有效值`XElement`。

发生的事情是这`&lt;`是一个**转义序列**，`<`并且`&gt;`是一个转义序列`>`。

`<`您的 XML 解析器转义的原因`>`是因为这些字符具有特殊含义，并且将它们包含在您的 XML 中会改变 XML 的性质。

这有点类似于换行符的转义序列`\n`如何，以及换行符`\\`的转义序列如何`\`

# sql - 如何构建正确的 LINQ 查询（生成 OR 而不是 AND）

> ID：13292834
> 
> 赞同：2
> 
> 时间：2012-11-08T16:06:23.757
> 
> 标签：sql, linq

我需要一些帮助来构建正确的查询。我有一个员工表。我需要获取所有员工的列表，该 EENO（员工 ID）包含来自提供的部分员工 ID 数组的字符串。

当我使用此代码时

```
// IEnumerable<string> employeeIds is a collection of partial Employee IDs
IQueryable<Employee> query = Employees;
foreach (string id in employeeIds)
{
    query = query.Where(e => e.EENO.Contains(id));
}
return query; 
```

我会得到类似的东西：

```
SELECT * 
FROM Employees 
WHERE EENO LIKE '%1111111%' 
  AND EENO LIKE '%2222222%' 
  AND EENO LIKE '%3333333%' 
  AND EENO LIKE '%4444444%' 
```

这没有任何意义。 **我在生成的 SQL 中需要“OR”而不是“AND”。**

谢谢！

**更新**

当我需要包含这些员工时，我使用 PredicateBuilder 编写的这段代码**可以完美运行。**

```
var predicate = PredicateBuilder.False<Employee>();
foreach (string id in employeeIds)
{
    var temp = id;
    predicate = predicate.Or(e => e.EENO.Contains(temp));
}
var query = Employees.Where(predicate); 
```

现在，我需要编写一个相反的代码，以排除这些员工，这是**但它不起作用**：生成的 SQL 完全奇怪。

```
var predicate = PredicateBuilder.False<Employee>();
foreach (string id in employeeIds)
{
    var temp = id;
    predicate = predicate.And(e => !e.EENO.Contains(temp)); // changed to "And" and "!"
}
var query = Employees.Where(predicate);
return query; 
```

它应该生成像这样的 SQL Where 子句：

```
WHERE EENO NOT LIKE '%11111%'
       AND NOT LIKE '%22222%'
       AND NOT LIKE '%33333%' 
```

**但它没有发生**

生成的 SQL 是这样的：http: [//i.imgur.com/9MDP7.png](http://i.imgur.com/9MDP7.png)

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:09:00.247

而不是`foreach`，只需构建 IQueryable 一次：

```
query = query.Where(e => employeeIds.Contains(e.EENO)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:09:41.547

我会看看[http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)。这是构建 Or 查询的好方法，由编写 LinqPad 的人编写。上面的链接也有使用示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T17:20:06.650

我相信你可以使用`Any()`：

```
var query = Employees.Where(emp => employeeIds.Any(id => id.Contains(emp.EENO))); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T17:26:04.520

如果您不想使用谓词构建器，那么唯一的其他选择是在中间查询中将每个集合联合起来：

```
// IEnumerable<string> employeeIds is a collection of partial Employee IDs
IQueryable<Employee> query = Enumerable.Empty<Employee>().AsQueryable();
foreach (string id in employeeIds)
{
    string tempID = id;
    query = query.Union(Employees.Where(e => e.EENO.Contains(tempID));
}
return query; 
```

还要记住，闭包规则会破坏您的谓词，并且最终只会根据您的最后一个条件进行过滤。这就是为什么我在循环中有`tempID`变量。`foreach`

编辑：所以这是您遇到的所有问题的纲要：

**生成 OR，而不是 ANDS**

完成，使用 PredicateBuilder。

**仅应用最后一个谓词**

通过在内部循环中分配一个临时变量来解决（由于关闭规则）

**排除谓词不起作用**

您需要从正确的基本情况开始。当您使用`OR`s 时，您需要确保首先从`false`大小写开始，这样您只包含至少一个谓词匹配的记录（否则不返回任何内容）。这样做的原因是为了评估的目的，基本情况应该被忽略。换句话说`false || predicate1 || predicate2 || ...`，真的只是`predicate1 || predicate2 || ...`因为你在你的谓词列表中寻找至少一个真（你只需要一个基础来构建）。反之亦然`AND`。您开始时`true`为了评估目的而“忽略”它，但您仍然需要一个基本案例。换句话说：`true && predicate1 && ...`与 相同`predicate1 && ...`。希望能解决你的最后一个问题。

# android - Android DDMS 控制台视图的目的：我应该期望它显示堆栈跟踪吗？

> ID：13292835
> 
> 赞同：1
> 
> 时间：2012-11-08T16:06:32.020
> 
> 标签：android

我了解 DDMS 允许调试器连接到模拟器/安卓设备。但是 Eclipse 中显示的 DDMS 控制台视图的目的到底是什么？

它显示了 adb 连接失败的状态，

但我应该期待崩溃程序的堆栈跟踪吗？我只在 logcat 中看到堆栈跟踪/崩溃，但在 ddms 控制台中看不到。

有任何想法吗 ？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:25:22.647

控制台视图是 Eclipse 的一部分，而不是 DDMS 的一部分，请参阅[此处](http://developer.android.com/tools/debugging/ddms.html)，而控制台视图有其自己的功能，请参阅[此处](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/views/console/ref-console_view.htm)希望它会在您的应用程序崩溃时有所帮助，您可以在 logcat 视图中识别错误，它会显示详细的运行时错误（如果有）...这个答案是基于我从你的问题中理解的，如果它不相关请在下面评论我将删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:20:29.077

它不会出现太多，但通常会在 adb 运行时弹出。我认为，就像 Android 一样，它显示了标准输出会说什么（命令行版本将转储的文本）。我从未在该控制台视图中看到堆栈跟踪。

有几次我遇到了像 adb 这样的问题，我必须在命令行上运行像“adb kill-server”这样的命令，而 DDMS 会吓坏并尝试重新连接，通常是 11 次尝试。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-08T16:28:33.563

在 DDMS 视图中，您可以直接连接到模拟器。例如，您可以调用模拟器，向模拟器发送短信以及地理位置。DDMS 中的控制台选项卡除了显示 USB 和设备之间的通信之外没有其他用途。您不应期望在“控制台”选项卡中看到日志信息。

# html - Windows 8 点击事件处理程序仅适用于一次 WinJS

> ID：13292840
> 
> 赞同：0
> 
> 时间：2012-11-08T16:06:40.530
> 
> 标签：html, windows-8, winjs

我正在用 JavaScript 和 HTML5 编写一个 Windows 8 应用程序。我希望在单击按钮时显示一个对话框。

我在`default.js`文件中指定了事件处理程序，如下所示：

```
// For an introduction to the Blank template, see the following documentation:
// http://go.microsoft.com/fwlink/?LinkId=232509
(function () {
    "use strict";

    var app = WinJS.Application;
    var activation = Windows.ApplicationModel.Activation;
    WinJS.strictProcessing();

    app.onactivated = function (args) {
        if (args.detail.kind === activation.ActivationKind.launch) {
            if (args.detail.previousExecutionState !== activation.ApplicationExecutionState.terminated) {
                // TODO: This application has been newly launched. Initialize
                // your application here.

            } else {
                // TODO: This application has been reactivated from suspension.
                // Restore application state here.
            }
            args.setPromise(WinJS.UI.processAll().done(function () {

                // Get the login button on the home page
                var login_button = document.getElementById("login_submit");

                // Set an event handler on the login button
                login_button.addEventListener("click", UserActionLogin, false);

            }));
        }
    };

    app.oncheckpoint = function (args) {
        // TODO: This application is about to be suspended. Save any state
        // that needs to persist across suspensions here. You might use the
        // WinJS.Application.sessionState object, which is automatically
        // saved and restored across suspension. If you need to complete an
        // asynchronous operation before your application is suspended, call
        // args.setPromise().
    };

    function UserActionLogin(mouseEvent) {

        var message_dialog = new Windows.UI.Popups.MessageDialog("Sorry, we were unable to log you in!" + mouseEvent.y.toString()).showAsync();
    }

    app.start();
})(); 
```

我的 HTML 标记如下：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>HelloWorld</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0.RC/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0.RC/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0.RC/js/ui.js"></script>

    <!-- HelloWorld references -->
    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/default.js"></script>

    <script type="text/javascript">

    </script>
</head>
<body>
<div id="wrapper">
    <div class="login_box">
        <form method="post">
            <input type="text" name="login_username" />
            <input type="password" name="login_password" />
            <input type="submit" id="login_submit" name="login_submit" />
        </form>
    </div>
</div>
</body>
</html> 
```

当我`login_submit`在应用程序加载时单击按钮时，它会很好地显示对话框。

但是当我第二次单击它时它不起作用，就像它忘记了事件处理程序一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:00:28.293

问题在于其中有元素，您在应用程序中不需要该元素，因为您不希望提交按钮重新发布/重新加载包含表单内容的页面。您正在有效地重新加载页面，但在这种情况下未调用激活的处理程序（页面作为帖子而不是请求加载），因此您丢失了事件处理程序。

如果您删除该元素，那么它就可以正常工作。我还被告知，如果你使用 type="button" 而不是 type="submit" 那么它应该可以工作。但是在应用程序中，您通常会从控件中收集数据并将其保存在其他变量中，使用 WInJS 导航和页面控制机制导航到应用程序中的另一个“页面”，这使您无需更改脚本即可使用 default.html语境。

另外，我注意到您仍然指的是 WinJS 的 RC 版本。由于Win8现已正式发布，请务必针对已发布的系统版本并使用最新的工具进行开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T18:21:12.883

问题是您对`form`元素的使用，这会导致您在单击按钮时重新加载 HTML - 这会替换您为其设置事件处理程序的元素，这意味着后续单击不会调用您的处理程序函数。

移除表单元素，您将获得您期望的行为，如下所示：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>App7</title>

    <link href="//Microsoft.WinJS.1.0.RC/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0.RC/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0.RC/js/ui.js"></script>

    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/default.js"></script>
</head>
<body>
    <div id="wrapper">
    <div class="login_box">
        <input type="text" name="login_username" />
        <input type="password" name="login_password" />
        <input type="submit" id="login_submit" name="login_submit" />
    </div>
</div>
</body>
</html> 
```

如果您`form`出于某种原因确实需要该元素（可能是因为您正在使用需要它的 JS 库），那么您可以通过停止在事件处理函数中提交的表单来防止该问题，如下所示：

```
function UserActionLogin(mouseEvent) {
    var message_dialog = new Windows.UI.Popups.MessageDialog("Sorry, we were unable to log you in!" + mouseEvent.y.toString()).showAsync();
    mouseEvent.preventDefault();
} 
```

对 preventDefault 的调用会停止发布表单，但允许您将表单元素保留在文档中。

# c# - WPF 数据网格响应能力 - 20x50 单元格

> ID：13292841
> 
> 赞同：1
> 
> 时间：2012-11-08T16:06:42.223
> 
> 标签：c#, wpf, datagrid

我们正在努力解决 wpf 中数据网格的缓慢问题。不管我们使用的是哪个集合——List、BindingList、ObservableCollection、自定义ObservableCollection，在响应集合更新（Clear、Add）并在屏幕上渲染时仍然很慢。

我们找到的最快解决方案不是更新集合，而是更新集合中的现有对象，DataGrid 绑定到。在这种情况下，网格响应非常快，就像旧的 winforms 网格一样。

我们在网格中创建了 65535 行，这对于我们所有的网格来说已经足够了。在更新网格时，我们更新所需的顶部行数，并为其余部分设置可见性 = 隐藏。正如我所说，它的工作速度非常快。但是有两个问题我们无法解决：

1.  滚动条，因为我们不折叠行（它很慢） - 它总是设置为 65535 行。有没有办法将滚动或网格大小限制为实际可见行数？

另外，我注意到，将新行添加到集合中，如果它们不需要立即呈现（它们将超出可见区域）也非常快，因此我们可以将最小设置限制为 50 行（最大可见行），然后根据需要添加/删除新行。但这并不能解决滚动问题。

欢迎任何其他解决方案。预见到启用虚拟化的建议 - 是的，我们正在使用虚拟化（对于默认启用的行和列）。

更新：我们正在尝试显示 20 列 x 50 行数据。如果我们用 Clear() 然后 Add() 修改源集合，渲染时间大约是 1 秒，这对我们来说根本无法接受，因为 UI 会冻结一秒。我试图将数据网格的大小调整为 0 高度，然后在后台线程中逐步设置大小，它会解冻 UI，但忽略是丑陋的，我还没有管理如何将数据网格设置回以填充父控件。似乎在代码中设置了高度之后，就没有回头路了。与最初的帖子一样，我们发现它的替代解决方案不是修改集合。只需将网格限制为 65535 行，不要添加或删除新项目。它的运行速度非常快，但现在我们在同步滚动和排序方面遇到了问题。
我发现数据网格在 WPF 中是非常令人沮丧的控制。性能低于任何合理限制。我们正在努力实现的是响应能力。加载数据时，它不应阻塞 UI 超过几毫秒。

XAML：没什么特别的

```
<DataGrid x:Name="TheGrid" 
                          DockPanel.Dock="Top"
                          ItemsSource="{Binding Collection}"  
                          EnableColumnVirtualization="True"
                          EnableRowVirtualization="True"              
                          AutoGenerateColumns="False"
                          ColumnWidth="70"
                          RowHeight="20"

                          >

                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="Header 1" >

                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <TextBox Text="{Binding Field1, Mode=TwoWay}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>

                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Field1}" /></DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>

                        </DataGridTemplateColumn > 
```

.....等等20列

此外，数据网格不在 StackPanel 内（这使得它非常慢）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:04:42.840

最后，我们找到了如何将滚动限制在任意数量的行上，而不是太多。我们创建了自己的绑定列表，它实现了 ICollection，在 ScrollView 中用于获取行数。我们将 ICollection.Count 更改为返回可见行的计数，这是我们在调用 Measure 之前设置的，然后我们将其设置回实际计数。它运行良好，它解决了我们所有的滚动问题。所以，我们有一个网格，它绑定到具有静态行数的列表，我们将 visibility=Visible 设置为我们想要显示的前 n 行，其余的具有可见性 Hidden（不折叠，因为折叠非常慢） ，并且我们将滚动限制为可见行。列表中的对象，可以从不同的线程更新，我们不需要调用 Dispatcher，因为 WPF 自己做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:16:43.390

我找到了可能对您有用的页面。

第一个是关于缓存数据网格中的值：http: [//msdn.microsoft.com/en-us/library/system.windows.uielement.cachemode (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.windows.uielement.cachemode(v=vs.100).aspx)

第二个关于为数据网格实现虚拟模式：http: [//msdn.microsoft.com/en-us/library/15a31akc.aspx](http://msdn.microsoft.com/en-us/library/15a31akc.aspx)

希望对你有帮助

更新：您使用的是滚动视图吗？因为如果你是，它将加载所有行而不是仅可见。试试看这个问题的答案：[How to lazy-evaluate a wpf:DataGrid, retrieving data only as needed](https://stackoverflow.com/questions/10422592/how-to-lazy-evaluate-a-wpfdatagrid-retrieving-data-only-as-needed)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-11T08:38:59.933

我知道这可能不是正确的解决方案，因为它仍然需要相同的时间。但是使其成为多线程将解决冻结问题。然后，您可以让它在后台将数据填充到网格中，并在运行时将它们一一添加，或者在完成后将它们全部添加。

# php - 对位系统的限制

> ID：13292843
> 
> 赞同：0
> 
> 时间：2012-11-08T16:06:46.583
> 
> 标签：php, bit-manipulation

我刚刚学习了一些关于 Bits 如何工作的在线教程。虽然我有几个问题。我已经搜索了互联网，但没有找到我要找的东西。我可能一直在寻找一些不正确的关键词。

假设我希望使用按位构建选项或权限系统（我认为这是正确的术语）。我有以下犹豫：

1）使用＆等时是否可能会发生碰撞？

2）如果有冲突的机会，我在设计我的权限时应该采取什么样的步骤？如果我有相当大的权限集（例如超过 500 个），权限编号会改变吗？

希望我能正确地回答我的问题，如果没有，请告诉我，我会尝试改写。

编辑:: 类似的问题在这里我相信已经回答

[使用按位运算符对不同模块的用户角色权限](https://stackoverflow.com/questions/2925245/user-role-permissions-for-different-modules-using-bitwise-operators?rq=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:10:54.633

1.  什么样的碰撞？
2.  对于 500 种不同的权限，您必须存储 500 位。不存在可以直接处理 500+ 位值的计算机。对于位系统，您基本上只能使用底层 cpu 可以提供的内容，例如 8、16、32、64 位大小的值。除此之外的任何东西都必须分成多个不同的内存块。

例如

```
permission_flags && (1 << 475) 
```

在现有的每个平台上都会失败，因为一旦你移过第 63 位，你就超过了 cpu 可以直接支持的东西。

# android - 如何限制EditText只获取文本而不获取android中的数字

> ID：13292847
> 
> 赞同：1
> 
> 时间：2012-11-08T16:06:52.060
> 
> 标签：android, android-edittext

我想限制 EditText 只获取文本，而不是任何数字。我试过这个：

1-- 在 XML 中：

```
 <EditText android:id="@+id/editText1" android:layout_width="fill_parent"
        android:layout_height="wrap_content" android:hint="@string/search_prompt"
        android:inputType="text"/> 
```

这对我不起作用。

2--在Java代码中得到参考[Text Only Input EditText android](https://stackoverflow.com/questions/4265377/text-only-input-edittext-android)

```
myEditText.setInputType(InputType.TYPE_TEXT_VARIATION_NORMAL); 
```

但这也不起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-07-09T09:29:39.717

you can do that in xml using

```
 <EditText
    android:digits="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ" /> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-08T16:12:59.090

您可以使用[InputFilter](http://developer.android.com/reference/android/text/InputFilter.html)来限制 EditText 只获取文本而不获取数字：

```
InputFilter filtertxt = new InputFilter() { 
    public CharSequence filter(CharSequence source, int start, int end, 
Spanned dest, int dstart, int dend) { 
            for (int i = start; i < end; i++) { 
                    if (!Character.isLetter(source.charAt(i))) { 
                            return ""; 
                    } 
            } 
            return null; 
     } 
}; 

editxt.setFilters(new InputFilter[]{filtertxt}); 
```

**编辑：** 您可以在 InputFilter 中创建一个您希望 Edittext 接受的字符数组，或者您也可以使用正则表达式验证

```
 InputFilter[] Textfilters = new InputFilter[1];
        Textfilters[0] = new InputFilter(){
        public CharSequence filter(CharSequence source, int start, int end, Spanned dest, int dstart, int dend) {
            if (end > start) {

                char[] acceptedChars = new char[]{'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z','.'};

                for (int index = start; index < end; index++) {
                    if (!new String(acceptedChars).contains(String.valueOf(source.charAt(index)))) {
                    return "";
                      }
                    }
                 }
                    return null;
            }

        };
editxt.setFilters(Textfilters); 
```

# iphone - 如何从私有 API 为类 UIWebDocumentView 创建一个类别？

> ID：13292850
> 
> 赞同：0
> 
> 时间：2012-11-08T16:06:55.447
> 
> 标签：iphone, objective-c, ios, ipad, categories

如何从私有 API 为类 UIWebDocumentView 创建一个类别？

```
#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

@interface UIWebDocumentView (myCanPerformAction)

- (BOOL)myCanPerformAction:(SEL)action withSender:(id)sender;

@end 
```

错误：

> 找不到“UIWebDocumentView”的接口声明

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:30:10.377

在 ios 上......在 NSObject 上定义它

在 osx 上...可以使用反射在运行时添加方法

# sass - CSS Compass 自定义精灵名称

> ID：13292852
> 
> 赞同：0
> 
> 时间：2012-11-08T16:07:04.843
> 
> 标签：sass, sprite, compass-sass

现在如果我们使用指南针生成精灵图像

```
@import "imgs/*.png";
@include all-imgs-sprites; 
```

我们像这样在 .css 类中设置门禁

```
.imgs-<imagename> 
```

是否可以删除“imgs”部分？我只需要`.<imagename>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T03:31:54.317

在这种情况下，不要使用魔法`all`。它不是那么方便，但工作正常。只是自定义类中`@import`的精灵和`@include`单个图像：

```
@import "imgs/*.png";

.circle {
    @include imgs-sprite('circle');
}

.square {
    @include imgs-sprite('square');
} 
```

通过 DRYing 让您的生活更简单：

```
@each $file in circle, square {
    .#{$file} {
        @include imgs-sprite($file);
    }
} 
```

# c++ - 根据参数在基类中创建派生类

> ID：13292856
> 
> 赞同：4
> 
> 时间：2012-11-08T16:07:24.583
> 
> 标签：c++, design-patterns, derived-class, object-construction

[我的问题与Need a design pattern to remove enums and switch statement in object creation 中](https://stackoverflow.com/questions/3897221/need-a-design-pattern-to-remove-enums-and-switch-statement-in-object-creation)的问题或多或少相同但是我认为抽象工厂模式在这里并不适合。

我目前正在计划重构/重新实现一些现有的 DAL/ORM 混合库。在现有代码的某处，有如下代码：

```
class Base
{
  static Base * create(struct Databasevalues dbValues)
  {
    switch(dbValues.ObjectType)
    {
    case typeA:
      return new DerivedA(dbValues);
      break;
    case typeB:
      return new DerivedB(dbValues);
      break;
    }
  }
}

class DerivedA : public Base
{
  // ...
}

class DerivedB : public Base
{
  // ...
} 
```

因此，负责数据库通信的库会使用有关数据库实体的所有信息填充一个结构，然后调用上述 create() 方法在 ORM 中实际创建相应的对象。但我不喜欢基类知道其所有派生类的想法，我也不喜欢 switch 语句。我也想避免仅仅为了创建这些对象而创建另一个类。您如何看待目前的做法？您将如何实现此功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:22:26.143

这已经在这里讨论了数百万次。如果你不想创建一个单独的工厂类，你可以这样做。

```
class Base
{

public:
    template <class T>
    static void Register  (TObjectType type)
    {
       _creators[type] = &creator<T>;
    }

    static Base* Create (TObjectType type)
    {
        std::map <TObjectType, Creator>::iterator C = _creators.find (type);
        if (C != _creators.end())
          return C->second ();

        return 0;        
    }

private:
    template <class T>
    static Base* creator ()
    {
        return new T;
    }

private:
    typedef Base* (::*Creator) ();
    static std::map <TObjectType, Creator> _creators;
};

int main ()
{
   Base::Register <Derived1> (typeA);
   Base::Register <Derived2> (typeB);

   Base* a = Base::Create (typeA);
   Base* b = Base::Create (typeB);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T16:17:09.223

假设您将开关替换为映射，例如`map<ObjectType, function<Base* (DatabaseValues&)>>`.

现在，工厂（可能存在也可能不存在于基类中）不需要了解所有子类。

但是，必须以某种方式填充地图。这意味着要么填充它（因此您*对所有子类问题的了解*刚刚从一个地方推到另一个地方），或者您需要子类使用静态初始化来在映射中注册它们的工厂函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:40:14.030

无论您做什么，都需要 switch-case 或其他一些只会隐藏类似逻辑的构造。

但是，您可以并且应该做的是从您的 Base 中删除 create 方法 - 您完全正确，它不应该知道它是派生的。此逻辑属于另一个实体，例如工厂或控制器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T16:55:31.000

只是不要使用枚举。它们不是面向对象的构造，这就是为什么JAVA一开始没有它们的原因（不幸的是压力太大而无法添加它们）。

考虑而不是这样的枚举：

```
enum Types {
  typeA,
  typeB
}; 
```

这个结构不需要开关（我认为另一个非 OO 结构）和映射：

**类型.h**

```
class Base;
class BaseFactory {
public:
   virtual Base* create() = 0;
};     
class Types {
public:
  // possible values 
  static Types typeA;
  static Types typeB;
  // just for comparison - if you do not need - do not write...
  friend bool operator == (const Types & l, const Types & r) 
  { return l.unique_id == r.unique_id; }
  // and make any other properties in this enum equivalent - don't add them somewhere else 
  Base* create() { return baseFactory->create(); }

private:
   Types(BaseFactory* baseFactory, unsigned unique_id);
   BaseFactory* baseFactory;
   unsigned unique_id; // don't ever write public getter for this member variable!!!
}; 
```

**类型.cpp**

```
#include "Types.h"
#include "Base.h"
#include "TypeA.h"
#include "TypeB.h"

namespace {
  TypeAFactory typeAFactory;
  TypeBFactory typeAFactory;
   unsigned unique_id = 0;
}
Types Types::typeA(&typeAFactory, unique_id++);
Types Types::typeA(&typeBFactory, unique_id++); 
```

所以你的例子（如果你真的需要这个功能）：

```
class Base
{
  static Base * create(struct Databasevalues dbValues)
  {
    return dbValues.ObjectType.create();
  }
}; 
```

缺少的部分应该很容易实现。

# java - 选择 JComboBox 后立即更新 JComboBox

> ID：13292859
> 
> 赞同：0
> 
> 时间：2012-11-08T16:07:29.050
> 
> 标签：java, jcombobox

我有一个 JComboBox。我希望它能够工作，以便如果选择某个项目（“其他”），立即在同一个组合框中显示更多项目（类似于子菜单，但在组合框内）。我有一个魔鬼的时间让这个工作。

有人对如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:11:01.810

编辑：误解了你的问题！

我假设您正在单击 JComboBox 中的一个项目？而不是简单地添加此代码

```
comboOther.addActionListener (new ActionListener () {
        public void actionPerformed(ActionEvent e) {
            comboOther.addItem("new item 1");
            comboOther.addItem("new item 2");
            comboOther.addItem("new item 3");
            // more
        }
}); 
```

# openstack - 如何从 Openstack 中的图像中了解操作系统类型？

> ID：13292867
> 
> 赞同：0
> 
> 时间：2012-11-08T16:07:48.457
> 
> 标签：openstack

如果 Openstack 实例中有图片上传。我如何从 API 调用中知道图像的操作系统。我目前没有看到任何属性来告诉操作系统类型。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T22:56:21.630

对于现有系统，没有任何保证的方法可以做到这一点。也就是说，Glance（为您存储和检索图像的 openstack 服务）确实允许您在给定图像中放入任意元数据，因此您可以以任何您喜欢的方式“标记”它。

查看 glance api（记录在[http://docs.openstack.org/developer/glance/glanceapi.html](http://docs.openstack.org/developer/glance/glanceapi.html)）以了解已经存在的内容以及如何添加和读取自己的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:32:31.647

我们计划这样做。我们已经指定了元数据 ex。“os-xxx”作为 Glance 服务器上每个图像的一部分，我们从元数据中收集详细信息以收集有关已配置服务器的信息。

请让我知道是否有任何其他方式可以了解配置服务器的详细信息（操作系统类型、操作系统版本、硬件架构类型等）。

# .net - 正则表达式否定字符串

> ID：13292875
> 
> 赞同：0
> 
> 时间：2012-11-08T16:08:14.447
> 
> 标签：.net, regex, regex-negation

我怎样才能得到这个正则表达式结果的否定？

```
8000[0-9]{12}|4000[0-9]{12}|2000[0-9]{11} 
```

我只想修改正则表达式以获得否定的结果。

此示例的示例：

```
200045646587982  
8000046678465132  
8000078526654112  
4000846464256741  
4000875465123111  
8318548479844423  
8020489065458054 
```

如果我执行当前的正则表达式，我会得到结果：

```
200045646587982  
8000046678465132  
8000078526654112  
4000846464256741  
4000875465123111 
```

我希望正则表达式返回相反的结果：

```
8318548479844423  
8020489065458054 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T12:46:50.880

这取决于您可以使用哪些工具。

我会接受我的输入并使用“正”正则表达式用空字符串替换匹配的行，然后摆脱它们。

例如，如果您的输入是一个文件并且您在 Unix 环境中工作：

猫输入.txt | sed s/my-positive-regexp//g

将用空字符串替换匹配的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:25:09.463

在这里查看我的答案：[https ://stackoverflow.com/a/12139118/1548853](https://stackoverflow.com/a/12139118/1548853)

尽管答案并不完全针对您，但同样的原则也适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:09:18.363

我认为这比反转/否定模式更简单。

```
 if (!Regex.IsMatch("input", "pattern")) 
    {
    } 
```

# powershell - 从 Windows 7 开始菜单中清除最近使用的程序

> ID：13292876
> 
> 赞同：1
> 
> 时间：2012-11-08T16:08:14.757
> 
> 标签：powershell, windows-7, mru

有谁知道使用**powershell**在 Windows 7 上清除 MRU 开始菜单程序的方法？我看到了一种使用注册表编辑的方法，但我希望尽可能避免这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T18:39:48.403

如果要清除最近的程序列表（按下开始按钮时出现的程序列表），您可以选择以下选项：

1) 使用以下**Powershell**脚本并重新启动资源管理器（信用在[这里](http://www.bleepingcomputer.com/forums/topic356210.html)）：

```
del HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist 
```

2）因为您还说禁用最近的程序列表对您有用，所以这里有[两种方法](http://www.sevenforums.com/tutorials/32666-recent-programs-enable-disable.html)：

*   使用 REG 文件下载（见上面的链接）。
*   通过`Local Group Policy Editor`（我会推荐这个）。

这只是另一篇有用的文章，涵盖了相关主题并详细解释了它的工作原理：

[在 Windows 7 的开始菜单中清除最近使用的程序](http://www.trishtech.com/win7/clear_recently_used_programs_in_start_menu_in_windows_7.php)。

# mysql - Mysql 计数 1 乘 1

> ID：13292878
> 
> 赞同：1
> 
> 时间：2012-11-08T16:08:17.877
> 
> 标签：mysql

$sql=sprintf("SELECT * FROM `stitch`);

这是我的阵列。

```
 [stitch] => Array
                    (
                        [0] => Array
                            (
                                [id] => 7, 
                                 [name] => Sew buttonhole to front fly
                            )
                        [1] => Array
                            (
                                [id] => 8,
                                [name] => Sleeve hem    
                            )
                     )                
                ) 
```

我需要这个结果

```
 [stitch] => Array
                    (
                        [0] => Array
                            (
                                [id] => 7,
                                [name] => Sew buttonhole to front fly  
                                [number_stitch] => 1
                     )
                        [1] => Array
                            (
                                [id] => 8,
                                [name] => Sleeve hem 
                                [number_stitch] => 2                             
                            )
                     )                
                ) 
```

我怎么做这些 [number_stitch] ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:15:24.373

尝试

```
select s.*, @rowcount:=@rowcount+1 ‘number_stitch’ from stitch s, (SELECT @rowcount:=0) r order by id; 
```

# excel - XSLT 输出 BOM 字符在 Excel 中可见

> ID：13292879
> 
> 赞同：4
> 
> 时间：2012-11-08T16:08:19.680
> 
> 标签：excel, xslt, byte-order-mark

我的 Java EE Web 应用程序使用 XSLT 转换来生成 CSV 报告。如果我将“UTF-16”指定为 XSLT 上的编码（这似乎是处理 XML 中重音字符的唯一方法），那么我会在 CSV 输出的开头得到一个字节顺序标记字符

。理解，这是正确的行为。问题是，如果在 Excel 中打开 CSV（显示为：þÿ），则此 BOM 字符可见，但如果我在适当的文本编辑器中打开它则不可见；）

如何隐藏或省略此字符，使其不可见什么时候在 Excel 中打开文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T22:42:38.777

您忘记指定正在使用的 XSLT 版本。

如果您使用的是 XSLT 2.0，则可以使用[xsl:output](http://www.w3.org/TR/xslt20/#element-output)元素抑制 BOM。例如...

```
<xsl:output method="xml" byte-order-mark="no" encoding="UTF-16" indent="yes" omit-xml-declaration="yes" /> 
```

## 如果您使用的是 XSLT 1.0，该怎么办？

这里有两个选项：

1.  升级到 XSLT 2.0
2.  将您的 Excel 升级到 2007（请参阅[此处](https://stackoverflow.com/questions/155097/microsoft-excel-mangles-diacritics-in-csv-files)了解原因）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-04T00:34:11.973

如果您正在编写 CSV 文件，则该方法可能不应该是 Sean B. Durkin 建议的“xml”。

我建议使用此配置来制作可以在 Excel 中正确打开的 CSV

```
<xsl:output method="text" byte-order-mark="yes" encoding="UTF-16LE" indent="no"/> 
```

**使用 XSLT 生成 CSV 时的其他提示：**

即使 CSV 表示“逗号分隔值”，您也可以使用 TAB 字符

我发现我分开的数据通常没有制表符，但偶尔会有逗号。

并且`<xsl:text>&#xa;</xsl:text>`是一种添加换行符的方法。

您可能想要转义您使用的值中出现的换行符，如下所示：

```
<xsl:value-of select="replace($foo,'\n','\\n')"/> 
```

当然，您会很快注意到，如果您在 Excel 中打开文件，它会变为**只读**，当您尝试在文件仍处于打开状态时再次生成文件时，这会很麻烦。与大多数文本编辑器不同，它们只是告诉您文件已更改，并提供重新加载它。

-

我意识到这个问题已经过时并得到了回答，但我希望这对未来的人有所帮助。

# android - Android SeekBar 数学

> ID：13292883
> 
> 赞同：0
> 
> 时间：2012-11-08T16:08:31.497
> 
> 标签：android, math

我有一个搜索栏，想取`progress`(0 - 100) 并将其转换为 -100 到 +100。我不太擅长想出这样的公式，所以我希望我能对一个公式有一些想法来做到这一点。

如果可以设置默认的最小值和最大值，我不想这样做，因为搜索栏的最小值和最大值可能会改变，所以做数学是 IMO 更好的主意。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:10:08.607

您需要先将宽度从 100 重新缩放到 200，然后将基础设置为 -100。所以你的函数就像 f(x) = x*2 - 100

# javascript - 如何从javascript返回值在android中设置变量

> ID：13292885
> 
> 赞同：0
> 
> 时间：2012-11-08T16:08:32.307
> 
> 标签：javascript, android, cordova, return

我有返回值的 JS

```
function sendDisplay()
{
 var dis = alert(reader.dom.find('controls_contents_container').style.display);
 return dis;
} 
```

在android中我尝试设置返回值，这样我就可以在android中做一个if else语句

```
public class MainActivity extends DroidGap {

   @Override
    public void onCreate(Bundle savedInstanceState) {
        CookieManager.setAcceptFileSchemeCookies(true);
        super.onCreate(savedInstanceState);
        super.setIntegerProperty("splashscreen", R.drawable.cover);
        super.loadUrl("file:///android_asset/www/index.html",1500);   

    }

    @Override
    public void onBackPressed() {
        super.loadUrl("javascript:alert(sendDisplay())"); 

    }

} 
```

当我在 loadUrl 方法中发出警报时，它会显示来自 JS 的值。但我不知道如何将该值设置为 android 变量。

TQ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:48:03.177

查看 Google 的[Binding Javascript Code to Android Code](http://developer.android.com/guide/webapps/webview.html#BindingJavaScript)指南部分。我还将在这里发布一个简短的摘要：

您首先需要设置一个 Java 类：

```
public class JavaScriptInterface {
    Context mContext;

    /** Instantiate the interface and set the context */
    JavaScriptInterface(Context c) {
        mContext = c;
    }

    /** Show a toast from the web page */
    public void showToast(String toast) {
        Toast.makeText(mContext, toast, Toast.LENGTH_SHORT).show();
    }
} 
```

然后，您需要将该类的实例添加到您的 WebView 作为 javascript 接口：

```
WebView webView = (WebView) findViewById(R.id.webview);
webView.addJavascriptInterface(new JavaScriptInterface(this), "Android"); 
```

最后，您可以使用 javascript 中的“Android.showToast(whatever)”调用它，或者您可以从 Java 代码中调用该 javascript：

```
loadUrl("javascript:Android.showToast(whatever)"); 
```

在显示 Toast 消息的情况下，这有点多余。但希望你能明白。

# javascript - 如何从 jQuery Mobile 的服务器返回脚本

> ID：13292889
> 
> 赞同：1
> 
> 时间：2012-11-08T16:08:44.873
> 
> 标签：javascript, jquery-mobile

我们有一个 jQuery 移动网站（ASP.NET MVC，但这对于这个问题并不重要）。jQuery mobile 附加到链接和表单，并自动将所有内容转换为 AJAX 请求。

使用经典的 jQuery调用，可以使用内容类型从服务器`.ajax()`返回普通的 Javascript - jQuery 执行自动内容类型检测并正确处理响应。这也适用于 AJAX 表单提交 - 如果响应是脚本，则执行它，如果响应是 HTML，则可以替换表单内容。`alert('Data has been saved.');``application/x-javascript`

不幸的是，jQuery mobile 似乎总是希望在服务器响应中包含 HTML。如果服务器响应是一个`application/x-javascript`内容类型的脚本，它只是用 text 替换整个页面`undefined`。如果我们为 jQuery mobile 禁用 AJAX 并附加经典的 jQuery AJAX 表单，那么它仍然会显示错误，尽管脚本是在向用户显示这些错误之后执行的。

**是否可以从服务器返回纯 Javascript 代码作为对 jQuery 移动请求的响应？**

# c# - 如何解决“Windows Azure”转换 ASP.NET 3.5 到 4.0 的这个错误？

> ID：13292891
> 
> 赞同：0
> 
> 时间：2012-11-08T16:08:47.947
> 
> 标签：c#, asp.net, azure, azure-storage

将 Windows Azure(ASP.NET) 项目 .NET 3.5 转换为 4.0 时发现错误。

出现错误：在使用 FromConfigurationSetting 之前需要调用 SetConfigurationSettingPublisher

源文件： `storageAccount = CloudStorageAccount.FromConfigurationSetting("DataConnectionString");`

谢谢纳希德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:17:36.617

在您的 WebRole.cs 和 Global.asax / 开头添加以下行`Application_Start`

```
CloudStorageAccount.SetConfigurationSettingPublisher((name, setter) => setter(RoleEnvironment.GetConfigurationSettingValue(name))); 
```

# ios - 更新到 xcode 4.5 后的 Monotouch 绑定问题

> ID：13292910
> 
> 赞同：1
> 
> 时间：2012-11-08T16:09:41.627
> 
> 标签：ios, binding, xamarin.ios

我之前通过遵循本文中详述的步骤，设法在 MonoTouch 中使用 Nuance SpeechKit 获得了一个测试[程序](https://stackoverflow.com/questions/9372880/has-anyone-created-a-monotouch-binding-for-the-nuance-dragon-mobile-speech-sdk-f)。

从那以后，我将所有内容都更新到了最新最好的版本（IOS 6.0、xcode 4.5 等）。

我第一次按照之前遇到的有关 ARMv6 支持问题的所有相同步骤进行操作。我相信我正确地更改了项目的架构设置以删除 ARMv6 引用。我能够按照绑定步骤（来自上面的帖子）并且一切似乎都可以正常工作。

我看到的问题是在 MonoTouch 项目中。将引用的 DLL 替换为新创建的 DLL 后，我发现缺少引用错误。

似乎新创建的 DLL 并未公开 SpeechKit 框架。（旧的原始 DLL 很好地显示了 SpeechKit 框架。）

（我绝对是初学者，如果我破坏以下内容，请原谅我......）

我创建此绑定所遵循的原始步骤（链接到上面）让我在 xcode 项目中创建了一个包装文件。此包装器中的代码引用 SpeechKit 框架。示例中有一条注释表明此代码实际上并未使用，但链接需要。（以下评论）

```
// the SpeechKitWrapper isn't actually used - rather, it is a way to exercise all the API's that 
// the binding library needs from the SpeechKit framework, so that those can be linked into the generated .a file. 
```

对我来说，问题似乎是我遵循的步骤不再这样做。我不知道是否有项目设置或某些改变导致了这种情况。或者可能是完全不相关的东西。

有没有人知道我可能出了什么问题？

# php - 使用库发布图像不返回任何内容

> ID：13292912
> 
> 赞同：0
> 
> 时间：2012-11-08T16:09:51.107
> 
> 标签：php, curl, twitter

我正在使用 matt harris 的 twitter 库[https://github.com/themattharris/tmhOAuth](https://github.com/themattharris/tmhOAuth)并遵循图像上传示例。

尝试发布没有返回 $tmhOAuth->response['response'] 的图像时，我得到一个零返回。

**我尝试过的步骤**

1.  按原样运行示例 - 失败
2.  运行验证 ssl- 工作正常
3.  在没有图像的情况下运行状态更新 - 它按预期正确发布
4.  将 url 从 1 交换到 1.1-没有任何变化，库仍然返回零

它运行得很快，这意味着它甚至没有尝试发布图像。

关于为什么这不起作用或我需要在服务器上配置的任何想法

下面是我从示例中复制的代码以尝试使用。

```
<?php
// testing hmac works- correctly
echo hash_hmac('ripemd160', 'The quick brown fox jumped over the lazy dog.', 'secret');

$tmhOAuth = array( 'consumer_key' => 'removed',
                   'consumer_secret' => 'removed',
                   'user_token' => 'removed', 
                   'user_secret' => 'removed');

// array(
//   'consumer_key'    => 'YOUR_CONSUMER_KEY',
//   'consumer_secret' => 'YOUR_CONSUMER_SECRET',
//   'user_token'      => 'A_USER_TOKEN',
//   'user_secret'     => 'A_USER_SECRET',
// )

require 'tmhOAuth.php';
require 'tmhUtilities.php';
$tmhOAuth = new tmhOAuth($tmhOAuth);

// we're using a hardcoded image path here. You can easily replace this with
// an uploaded image - see images.php in the examples folder for how to do this
// 'image = "@{$_FILES['image']['tmp_name']};type={$_FILES['image']['type']};filename={$_FILES['image']['name']}",

// this is the jpeg file to upload. It should be in the same directory as this file.
$image = 'image.png';

$code = $tmhOAuth->request(
  'POST',
  'https://upload.twitter.com/1.1/statuses/update_with_media.json',
  array(
    'media[]'  => "@{$image};type=image/jpeg;filename={$image}",
    'status'   => 'Picture time',
  ),
  true, // use auth
  true  // multipart
);

if ($code == 200) {
  tmhUtilities::pr(json_decode($tmhOAuth->response['response']));
} else {
  tmhUtilities::pr($tmhOAuth->response['response']);
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T18:09:56.453

请求中的 post url [https://upload.twitter.com](https://upload.twitter.com)应该是[http://api.twitter.com](http://api.twitter.com)

# git - 如何在 git 中有意分离 HEAD？

> ID：13292918
> 
> 赞同：55
> 
> 时间：2012-11-08T16:10:05.057
> 
> 标签：git, git-checkout

如果我这样做`git checkout HEAD^`，我会得到这个：

```
$ git checkout HEAD^
Note: checking out 'HEAD^'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b new_branch_name

HEAD is now at...
$ 
```

资深 git 用户可能对此非常熟悉。但如果我这样做`git checkout HEAD`，什么也不会发生：

```
$ git checkout HEAD
$ 
```

我想为当前分支头部的提交创建“分离的 HEAD”状态。我怎么做？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-10-21T13:26:43.330

从 git 1.7.5（2011 年 4 月）开始，您可以使用该`git checkout --detach`命令。
（[从 Git 2.23（2019 年第三季度）开始](https://stackoverflow.com/a/57066202/6309)，您将使用`git switch --detach`）

请参阅[提交 326696](https://github.com/git/git/commit/32669671c7746888aa1e3832907deb7fc8405061)

## `checkout`: 介绍“ ”`--detach`的同义词`git checkout foo^{commit}`

> 例如，在进行临时合并以测试两个主题是否可以很好地协同工作时，可能会使用它。

* * *

[提交 8ced1aa](https://github.com/git/git/commit/8ced1aa08f9e1798b2b3fec41a0598ef79b477fe)（git 1.7.11.3，2012 年 7 月）不允许`--detach`在未出生的分支上，所以这不会在 null 上失败`HEAD`：

```
git checkout --orphan foo
git checkout --detach
git symbolic-ref HEAD 
```

* * *

只有即将发布的 git 1.8.4.2 或 1.8.5（2013 年第四季度）阐明了语法。请参阅[提交 26776c9](https://github.com/git/git/commit/26776c9737a6b5b0e7aab142aef6ba856d8b46ca)：

> 将这种情况分成两种句法形式，模仿说明部分显示这种用法的方式。
> 还要更新解释语法的文本以将要分离的提交命名`HEAD`为澄清。

```
'git checkout' [--detach] <commit>:: 
```

> 准备在 之上工作`<commit>`，通过分离`HEAD`它（[参见“DETACHED HEAD”部分](http://git-scm.com/docs/git-checkout#_detached_head)），更新索引和树将是提交中记录的状态加上本地修改。
> 
> 1.  当`<commit>`参数是分支名称时，该`--detach`选项可用于`HEAD`在分支的尖端分离（`git checkout <branch>`将在不分离的情况下检查该分支`HEAD`）。
>     
>     
> 2.  **在当前分支的顶端省略`<branch>`分离`HEAD`**。

最后一点正是您想要为当前分支做的事情：

```
git checkout --detach 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-08T16:15:26.607

此命令从任何给定的分支名称（在本例中为 master）创建一个分离的头状态：

```
git checkout master^0 
```

检查提交哈希也会自动创建一个分离的头部状态，不需要`^0`：

```
git checkout 823112f444cb4aa70032feea6e8e5eb79d0e1ed0 
```

当然还有更短的哈希值：

```
git checkout 823112f 
```

# performance - drupal 衡量作者的出版效率 drupal 7

> ID：13292919
> 
> 赞同：0
> 
> 时间：2012-11-08T16:10:06.313
> 
> 标签：performance, drupal, publishing

我做了一个drupal 7站点。

我正在寻找一种测量作者（博客作者、文章作者）效率的解决方案。我想看看某个用户（作者）每月创建多少个节点以及这些节点包含多少个字母。

你能建议我一个模块或其他东西吗？

谢谢， 塔马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T13:43:03.167

这是我的解决方案：

```
<?php
/**
 * Implements hook_menu().
 */
function authors_efficiency_menu() {
  $items = array();
  $items['admin/config/authors_efficiency'] = array(
    'title' => 'Own Settings',
    'description' => 'Parent item',
    'position' => 'left',
    'weight' => -100,
    'page callback' => 'system_admin_menu_block_page',
    'page arguments' => array(),
    'access arguments' => array('access administration pages'),
    'file' => 'system.admin.inc',
    'file path' => drupal_get_path('module', 'system'),
  );
  // Need at least one child item before your section will appear.
  $items['admin/config/authors_efficiency/efficiency'] = array(
    'title' => 'Authors efficiency',
    'description' => 'Authors efficiency',
    'page callback' => 'authors_efficiency_page_callback',
    'page arguments' => array(),
    'access arguments' => array('access administration pages'),
    'type' => MENU_NORMAL_ITEM,
  );

  return $items;
}

function authors_efficiency_page_callback($para=array()){
    $output= '';

    // define number of results per page
    $num_per_page = 50;

    $header = array('User','Month','Count','Length sum','Avarage length');

    // define sql to fetch results
    $query= db_select('node','n');
    $query->condition('n.status', '1');
    $query->condition('n.created', (time()-(120*24*60*60)), '>');
    $query->join('field_data_body', 'b', 'n.nid = b.entity_id');
    $query->join('users', 'u', 'n.uid = u.uid');
    $query->condition('b.entity_type', 'node');
    $query->addExpression('CONCAT(YEAR(FROM_UNIXTIME(n.created)),\'-\',LPAD(MONTH(FROM_UNIXTIME(n.created)), 2, \'0\'))', 'node_month');
    $query->addExpression('SUM(CHAR_LENGTH(b.body_value))', 'node_char_length');
    $query->addExpression('COUNT(*)', 'node_count');
    $query->fields('n', array('uid'));
    $query->fields('u', array('name'));
    $query->groupBy('CONCAT(n.uid, \'@\', node_month)');
    $query->orderBy('node_month', 'DESC');
    $query->orderBy('u.name', 'ASC');

    $count_query= db_select('node','n');
    $count_query->condition('n.status', '1');
    $count_query->condition('n.created', (time()-(120*24*60*60)), '>');
    $count_query->addExpression('COUNT(*)', 'node_count');
    $count_query->fields('n', array('uid'));
    $count_query->groupBy('CONCAT(n.uid, \'@\', CONCAT(YEAR(FROM_UNIXTIME(n.created)),\'-\',LPAD(MONTH(FROM_UNIXTIME(n.created)), 2, \'0\')))');

    $count_query = $count_query->countQuery();
    $maxCount = $count_query->execute()->fetchField();;  

    $page = pager_default_initialize($maxCount, $num_per_page);
    $offset = $num_per_page * $page;

    $query->range($offset, $num_per_page);
    $result= $query->execute()->fetchAll();

    $rows = array();
    foreach($result as $record){
        $row = array(
                    $record->name,
                    $record->node_month,
                    $record->node_count,
                    $record->node_char_length,
                    round($record->node_char_length/$record->node_count),
               );
        $rows[] = $row;
    }

    // Depending on the context there may be a better choice than this
    $output.=  theme('table', array('header' => $header, 'rows' => $rows));
    $output.=  theme('pager');

    return($output);
}
?> 
```

# java - 如何在java中的不同位置创建文件的副本？

> ID：13292924
> 
> 赞同：0
> 
> 时间：2012-11-08T16:10:12.033
> 
> 标签：java, file

> **可能重复：**
> [在 Java 中复制文件的标准简洁方法？](https://stackoverflow.com/questions/106770/standard-concise-way-to-copy-a-file-in-java)

我在 location 的文件夹中有一组 .png 文件`C:\Desktop\input\Acsady\dZI_3.png`。现在我希望将图像复制到不同的位置`C:\Desktop\input\final\Acsady\5_dZI_3.png`。我该怎么做呢？我目前有以下代码，但没有给我预期的结果。

```
String newName = outdir + File.separator + "final" + File.separator + nfname;
File newfname = new File(outdir + File.separator + "final" + File.separator + nfname);
String source = outdir + File.separator + lkupfname;
String target = outdir + File.separator + "final" + File.separator + nfname;

System.out.println("Copying file: "+source +" to "+target);

boolean status = filename.renameTo(newfname);
System.out.println("status : "+status); 
```

我每次都将状态设为 false，这意味着 renameTo 函数不成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:16:11.033

看看`Files.copy`您是否使用 Java 1.7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:20:28.273

这是从 java 文档中提取的。可能有助于您找到根本原因。

重命名此抽象路径名表示的文件。此方法的行为的许多方面本质上是平台相关的：重命名操作可能无法将文件从一个文件系统移动到另一个文件系统，它可能不是原子的，并且如果具有目标抽象路径名的文件可能不会成功已经存在。应始终检查返回值以确保重命名操作成功。

# spring - 在 POM 中将 Spring 版本更改为 3.1.3.RELEASE 现在我在 Eclipse 中遇到 JSP 错误

> ID：13292927
> 
> 赞同：0
> 
> 时间：2012-11-08T16:10:21.197
> 
> 标签：spring, maven, spring-mvc, spring-webflow

我在 POM 中将 Spring 版本更改为 3.1.3.RELEASE 现在我在 Eclipse 中遇到 JSP 错误。如果我在 tomcat 中运行该项目，它工作得很好，但在 Eclipse 中，它将以下行标记为错误。

```
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %> 
```

这是错误。看起来我现在在所有有表单的 JSP 页面上都得到了它。

```
Description Resource    Path    Location    Type
Can not find the tag library descriptor for "http://www.springframework.org/tags/form"  enrollment1.jsp /Enroll/src/main/webapp/WEB-INF/flows/start line 6  JSP Problem 
```

下面是我的 POM.XML

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.uftwf.enrollment</groupId>
  <artifactId>Enroll</artifactId>
  <packaging>war</packaging>
  <version>0.0.1-SNAPSHOT</version>
  <name>Enroll Webapp</name>
  <url>http://maven.apache.org</url>

<developers>
        <developer>
            <id>jsmith</id>
            <name>Johnathan Smith</name>
            <email>johnatham.smith@uftwf.org</email>
            <roles>
                <role>Architect</role>
            </roles>
            <organization>uftwf.org</organization>
            <timezone>-5</timezone>
        </developer>
    </developers>

    <properties> 
        <java-version>1.5</java-version>
        <springframework-version>3.1.3.RELEASE</springframework-version>
        <springwebflow-version>2.3.1.RELEASE</springwebflow-version>
        <springsecurity-version>3.1.3.RELEASE</springsecurity-version>
        <org.slf4j-version>1.6.6</org.slf4j-version>
        <hibernate.version>4.1.1.Final</hibernate.version>
    </properties>

    <dependencies>
        <!-- Spring -->

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${springframework-version}</version>
            <!-- will come with all needed Spring dependencies such as spring-core 
                and spring-beans -->
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>${springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${springframework-version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-faces</artifactId>
            <version>${springwebflow-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-ldap</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-cas</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-cas-client</artifactId>
            <version>3.0.7.RELEASE</version>
            <exclusions>
                <exclusion>
                    <artifactId>cas-client-core</artifactId>
                    <groupId>org.jasig.cas</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>

        <dependency>
            <groupId>javax.mail</groupId>
            <artifactId>mail</artifactId>
            <version>1.4.5</version>
        </dependency>

        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.21</version>
        </dependency>

        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>
        <dependency>
            <groupId>net.sf.jt400</groupId>
            <artifactId>jt400-full</artifactId>
            <version>4.7.0</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpcore</artifactId>
            <version>4.2.1</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2.1</version>
            <exclusions>
                <exclusion>
                    <artifactId>commons-logging</artifactId>
                    <groupId>commons-logging</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>1.6.2</version>
        </dependency>

        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <!-- Logging -->

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-ext</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>

        </dependency>
        <!-- JSF-303 Dependency Injection -->
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <!-- Sun Mojarra JSF 2 runtime -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.7</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.7</version>
        </dependency>

        <!-- JSR 303 validation -->
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
        </dependency>

        <!-- ********************************************************************** 
            ** HIBERNATE DEPENDENCIES ** ********************************************************************** -->

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>

        <!-- Test -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.7</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <repositories>
        <!-- For testing against latest Spring snapshots -->
        <repository>
            <id>org.springframework.maven.snapshot</id>
            <name>Spring Maven Snapshot Repository</name>
            <url>http://maven.springframework.org/snapshot</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
        <!-- For developing against latest Spring milestones -->
        <repository>
            <id>org.springframework.maven.milestone</id>
            <name>Spring Maven Milestone Repository</name>
            <url>http://maven.springframework.org/milestone</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Hibernate Validator -->
        <repository>
            <id>org.jboss.repository.releases</id>
            <name>JBoss Maven Release Repository</name>
            <url>https://repository.jboss.org/nexus/content/repositories/releases</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Sun Mojarra JSF 2 implementation -->
        <repository>
            <id>maven2-repository.dev.java.net</id>
            <name>Java.net Repository for Maven</name>
            <url>http://download.java.net/maven/2/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For PrimeFaces JSF component library -->

    </repositories>

  <build>
    <finalName>Enroll</finalName>
  </build>
</project> 
```

# r - Opencpu App-开发流程及部署

> ID：13292928
> 
> 赞同：2
> 
> 时间：2012-11-08T16:10:22.187
> 
> 标签：r, apache2, opencpu

我发现了一个 R 包`opencpu-demo`，它作为应用程序安装在服务器上。但是，尚不清楚用户需要在`/install`目录中显式创建哪些文件以及如何将其与 R 函数联系起来。它是否需要嵌入 R 的 JavaScript，反之亦然。任何帮助或指向教程的指针将不胜感激。

# ajax - qq ajax 文件上传器 - 使用 onSubmit 提交值

> ID：13292931
> 
> 赞同：1
> 
> 时间：2012-11-08T16:10:29.830
> 
> 标签：ajax, variables, submit, uploader, fine-uploader

有人知道如何使用 qq AJAX 文件上传器提交元素值以及提交的上传 AJAX 文件吗？（http://valums.com/ajax-upload/）。

选项仅支持静态绑定，但我需要在提交文件之前收集值。

例如，我有一个复选框 id=ofield-delete-previous-pdf 并且我想提交它是否被选中。qq javascript加载后可以取消/选中复选框。

以下代码对我不起作用：

```
'onSubmit'=>'function(file, ext){
    var delete=$("#ofield-delete-previous-pdf").is(":checked") ? 1 : 0;
    qq.FileUploaderBasic.prototype.setParams({ **<-- not working**
        "paramDeletePrevious":delete
    });
}' 
```

如何将变量“删除”附加到 qq 对象？

先感谢您。卢博斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T16:54:29.823

根据[文档](https://github.com/valums/file-uploader#instance-methods)，以下应该有效：

```
onSubmit : function(id, fileName){
    var delete=$("#check-delete-previous").is(":checked");
    this.setParams({ 
        "deletePrevious" : delete,
        "otherValue" : $("#some-element").val(),
    });
}, 
```

实际上，以下仅对我有用：

```
onSubmit : function(id, fileName){
    var delete=$("#check-delete-previous").is(":checked");
    this.params.deletePrevious = delete;
}, 
```

编辑：更新到最新版本后，第一个示例工作正常。

# php - 如何使用 LIKE 使 MySQL 查询更高效

> ID：13292934
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:10:45.697
> 
> 标签：php, mysql

我有一个脚本，我试图匹配我以 ajax $.post 请求的形式检索到的[可删除数据](http://jsfiddle.net/Kxtvg/249/)，该请求包含名字、姓氏、描述和等级，并将其与数据库中相同数据的数据相匹配。在这样做时，我想找到用户并在我的查询中获取它们。我在使用高效查询`LIKE`时遇到问题，并且不确定要添加哪些其他组件才能正确执行此操作

```
if (isset($_POST['data'])){
    $data = $_POST['data'];
    $query = mysql_query("SELECT * FROM `tempusers`
        WHERE `firstname` LIKE '%" . $data . "%'
            OR `lastname` LIKE '%" . $data . "%'
            OR `description` LIKE '%" . $data . "%'
            OR `grade` LIKE '%" . $data . "%'");

    if (! $query){
        echo'Database error: ' . mysql_error();
    }

    while ($row=mysql_fetch_assoc($query)) {
        $description = $row['description'];
        echo $description;
    }

    exit;
} 
```

问题是我没有返回任何结果而是得到错误

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法`and`mysql_fetch_assoc() 期望参数 1 是资源，给定的布尔值。

我欢迎任何我可以实施的技巧，并将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:23:53.917

查询的语法是有效的，这意味着您在输入数据的某处有一个单引号，导致查询因语法错误而失败。

为了解决这个问题，您可以`$data`通过[`mysql_real_escape_string()`](http://php.net/manual/en/function.mysql-real-escape-string.php)which 将转义任何引号，最重要的是防止 SQL 注入。

比转义更好的是使用带有[PDO](http://uk1.php.net/manual/en/book.pdo.php)或[MySQLi](http://uk1.php.net/manual/en/book.mysqli.php)的参数化查询。

至于优化，您可以尝试[REGEXP](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)而不是多个 LIKE。[这里的例子](https://stackoverflow.com/questions/1127088/mysql-like-in)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:24:47.513

您已请求帮助优化一个不起作用的 MySQL 查询。

首先，您需要使查询正常工作。执行此操作的通常过程是将查询键入 MySQL 客户端（如 phpmyadmin）并查看会发生什么。您可能还会发现使用 echo 输出构造的查询将帮助您查看 SQL 语法错误。

二、查询形式

```
 column LIKE '%matchstring%' 
```

根本无法优化。匹配字符串上的前导 % 意味着 MySQL 服务器必须搜索您提到的列的每一行才能找到匹配项。索引对此没有帮助。如果可以这样查询

```
 column LIKE 'matchstring%' 
```

您可以使用索引来优化这些搜索。

第三，您`OR`在查询中使用。MySQL 优化器并不真正喜欢 OR，它会为每个表重新扫描。

您可以将此表放入 MyISAM 访问方法（如果还没有的话）并使用 FULLTEXT 匹配。试试这个：

```
 WHERE MATCH (firstname, lastname, description, grade) 
        AGAINST ('matchstring' IN BOOLEAN MODE) 
```

这将执行您想要的搜索。您可以使用全文索引对其进行优化。

最后，正如 Marc B 所指出的，您*必须*修复您的 SQL 注入问题。小学，更不用说中学，到处都是喜欢使用评分系统的人。要找出危害，请在搜索引擎中查找“little Johnny Droptables”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:34:54.973

放置`die;`之后`echo'Database error: ' . mysql_error();`并运行您的代码以检查数据库错误是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:27:51.857

您没有清理用户输入，这会导致您的 SQL 中出现杂散的引号字符（如您的错误消息所证明的那样）。简单的修复可以是（在将字符串放入查询之前转义字符串）：

```
if (isset($_POST['data'])){

    // sanitize user input
    $data = mysql_real_escape_string($_POST['data']);

    $query = mysql_query("SELECT * FROM `tempusers`
        WHERE `firstname` LIKE '%" . $data . "%'
            OR `lastname` LIKE '%" . $data . "%'
            OR `description` LIKE '%" . $data . "%'
            OR `grade` LIKE '%" . $data . "%'");

    if (! $query){
        echo'Database error: ' . mysql_error();
    }

    while ($row=mysql_fetch_assoc($query)) {
        $description = $row['description'];
        echo $description;
    }

    exit;
} 
```

请阅读[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

关于提高效率：索引不适用于您查询的字段`LIKE`。

此外，不鼓励您使用该`mysql_`功能，因为它们已被弃用。改为使用`mysqli`。

# database - 如何根据其内容自动调整/缩放 DBGrid 的（或其他类似的）列宽？

> ID：13292937
> 
> 赞同：10
> 
> 时间：2012-11-08T16:10:54.393
> 
> 标签：database, delphi, delphi-2006, tdbgrid

我正在尝试使用 a 制作一个框架，该框架`DBGrid`将服务于 10 多个表，其中一半字段作为默认值，其他字段为每个表独有。

由于列的空间是有限的，我不想手动配置每个表的每一列，因为它的工作质量很差，我想知道一种方法可以通过其中一行的最大内容来计算每列的宽度列，由自己的组件或数据集测量。

有人知道路吗？世界上是否有一些具有这种能力的定制组件？ **我需要一个根据网格所有可见列中的可见数据来实现大小增加和减少的解决方案。** 到目前为止，我的解决方案在所选单元格的绘制方面存在问题，女巫跳出所选数据集行。

![在此处输入图像描述](../Images/8b18873ec94dcfb541a27aab536c51dc.png)

* * *

注意：请不要关闭我的问题。这与网格宽度或表单宽度无关。它是关于所有列的宽度来最小化水平滚动条，但不一定隐藏它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-08T18:08:43.120

您要做的是使用网格的画布来测量每一列的内容并相应地设置列的宽度。您可以遍历数据集或使用 OnColumnDraw-Event 动态调整宽度。

这是一个示例（我必须使用 5 个像素的偏移量）

```
procedure TForm7.DBGridDrawColumnCell(Sender: TObject; const Rect: TRect;
  DataCol: Integer; Column: TColumn; State: TGridDrawState);
Var
  w : Integer;

begin
  w := 5+DBGrid.Canvas.TextExtent(Column.Field.DisplayText).cx;
  if w>column.Width then Column.Width := w;
end;

procedure TForm7.FormActivate(Sender: TObject);
Var
  i : Integer;

begin
  // Initialize width
  for I := 0 to DBGrid.Columns.Count - 1 do
    DBGrid.Columns[i].Width := 5 + DBGrid.Canvas.TextWidth(DBGrid.Columns[i].title.caption)
end; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-08T16:40:08.150

**编辑：**

我的第一个代码是关于使用这个新代码来适应网格内的列，AutoSizeColumns 读取记录以计算每列的宽度，直到 MaxRows 或 Dataset.Eof：

```
class function TDBGridHelper.AutoSizeColumns(DBGrid: TDBGrid; const MaxRows: Integer = 25): Integer;

var
  DataSet: TDataSet;
  Bookmark: TBookmark;
  Count, I: Integer;
  ColumnsWidth: array of Integer;
begin
  SetLength(ColumnsWidth, DBGrid.Columns.Count);
  for I := 0 to DBGrid.Columns.Count - 1 do
    if DBGrid.Columns[I].Visible then
      ColumnsWidth[I] := DBGrid.Canvas.TextWidth(DBGrid.Columns[I].Title.Caption + '   ')
    else
      ColumnsWidth[I] := 0;
  if DBGrid.DataSource <> nil then
    DataSet := DBGrid.DataSource.DataSet
  else
    DataSet := nil;
  if (DataSet <> nil) and DataSet.Active then
  begin
    Bookmark := DataSet.GetBookmark;
    DataSet.DisableControls;
    try
      Count := 0;
      DataSet.First;
      while not DataSet.Eof and (Count < MaxRows) do
      begin
        for I := 0 to DBGrid.Columns.Count - 1 do
          if DBGrid.Columns[I].Visible then
            ColumnsWidth[I] := Max(ColumnsWidth[I], DBGrid.Canvas.TextWidth(
              DBGrid.Columns[I].Field.Text));
        Inc(Count);
        DataSet.Next;
      end;
    finally
      DataSet.GotoBookmark(Bookmark);
      DataSet.FreeBookmark(Bookmark);
      DataSet.EnableControls;
    end;
  end;
  Count := 0;
  for I := 0 to DBGrid.Columns.Count - 1 do
    if DBGrid.Columns[I].Visible then
    begin
      DBGrid.Columns[I].Width := ColumnsWidth[I];
      Inc(Count, ColumnsWidth[I]);
    end;
  Result := Count - DBGrid.ClientWidth;
end; 
```

我在 DataSet.AfterOpen 事件中调用它：

```
TGridHelper.AutoSizeColumns(MyDBGrid); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-01T06:48:43.200

为什么要用这么复杂的代码？:D 就用这个。它也有 5 px 的偏移量。

```
procedure TForm1.FormActivate(Sender: TObject);

var

  i:integer;

begin

  for i :=0 to DbGrid1.Columns.Count - 1 do
   DbGrid1.Columns[i].width :=5+dbgrid1.Canvas.TextWidth(DbGrid1.Columns[i].Title.Caption);

end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-14T15:18:10.147

对于要自动调整大小的每一列，设置属性`SizePriority=1`，对于固定列 set `SizePriority=0`，在您的情况下，只有最后一列会自动调整大小。

然后设置属性`grid.AutoFillColumns=true`，应该这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-18T17:36:40.037

对于 TRUEDBGRID .net，您可以这样做：

```
 Private Sub AutoSizeGrid(Grid As C1.Win.C1TrueDBGrid.C1TrueDBGrid)
        For Each Sp As C1.Win.C1TrueDBGrid.Split In Grid.Splits
            For Each Cl As C1.Win.C1TrueDBGrid.C1DisplayColumn In Sp.DisplayColumns
                Cl.AutoSize()
            Next
        Next
End Sub 
```

对于 vb60 中的 TrueDbGrid ActiveX（此代码不包括拆分）：

```
Public Function APEXGridAutoFix(Grid As TrueOleDBGrid80.TDBGrid)
Dim Col As TrueOleDBGrid80.Column
For Each Col In Grid.Columns
    Col.AutoSize
Next
End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-19T22:16:24.557

该解决方案使所有列根据其内容进行扩展或缩小，而不关心是否必须有滚动条，并修复选定单元格绘制故障和记录指针故障。

```
type
  TColumnAutoAdjust = record {Save the information responsible for setting column widths in the grid}
    Field: String;           {Field name whose information is being stored}
    Registered: Boolean;     {Indicates whether the size of this column already registered}
    Updated: Boolean;        {Indicates the actual size of the column was updated}
    LastWidth: Integer;      {Width indicates the final text of a record of a row column}
    CurrWidth: Integer;      {Indicates the current size and column width}
    Reverter: Integer;       {Indicates the greatest width recorded but that is less than the current}
    Scrolls: Integer;        {Indicates the amount of scrolls present after one width adjustment}
    RecNo: Integer;          {Indicates which was the record in the table which increased the width of colune}
  end;

var { inside the forms private }
  gdCols: array of TColumnAutoAdjust; { vetor de ajuste de largura de cada coluna na grade de resultado }
  RegisteredCols: Integer; { quantas colunas já foram registradas no controle de ajuste }
  gdVisibleRows: Integer; { quantas linhas de cadastros estão visíveis da grade de resultado }
  gdVisibleCols: Integer; { quantas colunas de cadastros estão visíveis da grade de resultado }

{ before showing the grid }  
    RegisteredCols := ResultGrid.Columns.Count;
    SetLength(gdCols, RegisteredCols); { determina o tamanho da vetor de controle de colunas }
    { libera a lista }
    ResultGrid.Align := alClient;
    for i := 0 to RegisteredCols -1 do { inicializando a largura das colunas no tamanho do título de cada }
    begin
      gdCols[i].Field := ResultGrid.Columns[i].FieldName;
      ResultGrid.Columns[i].Width := ResultGrid.Canvas.TextExtent(ResultGrid.Columns[i].Title.Caption).cx;
      ResultGrid.Columns[i].Alignment := taLeftJustify;
      ResultGrid.Columns[i].Title.Alignment := taLeftJustify;
    end;
    BrowserQuery.Open;
    ResultGrid.Show;
    for i := 0 to gdVisibleRows do
    begin
      BrowserQuery.Next;
      ResultGrid.Refresh;
    end;
    for i := 0 to gdVisibleRows do
    begin
      BrowserQuery.Prior;
      ResultGrid.Refresh;
    end;
    BrowserQuery.First;
    ResultGrid.SetFocus;
  end

{ after dataset scroll}      
procedure TRecordsBrowserFrameBase.BrowserQueryAfterScroll(DataSet: TDataSet);
var
  i, TitleWidth: Integer;
  mayAdjustAgain: Boolean; {  }
begin
{ ajusta as colunas da grade de resultado a cada movimento da tabela de resultado }
  mayAdjustAgain := False;
  for i := 0 to RegisteredCols -1 do
  begin
    if not gdCols[i].Updated then
    begin
      ResultGrid.Columns[i].Width := gdCols[i].CurrWidth;
      gdCols[i].Scrolls := 0;
      gdCols[i].Updated := True;
    end
    else
    begin
      Inc(gdCols[i].Scrolls);
      if (DataSet.RecNo > gdCols[i].RecNo + gdVisibleRows) or (DataSet.RecNo < gdCols[i].RecNo - gdVisibleRows) then
      begin
        TitleWidth := MaxColSpacing + ResultGrid.Canvas.TextExtent(ResultGrid.Columns[i].Title.Caption).cx;
        gdCols[i].LastWidth := gdCols[i].CurrWidth;
        gdCols[i].CurrWidth := IFX(gdCols[i].Reverter > TitleWidth, gdCols[i].Reverter, TitleWidth);
        gdCols[i].Reverter := IFX(gdCols[i].Reverter > TitleWidth, TitleWidth, 0);
        gdCols[i].Updated := False;
        mayAdjustAgain := True;
      end;
    end;
  end;
  if mayAdjustAgain then
  begin
    ResultGrid.Refresh;
    BrowserQueryAfterScroll(DataSet);
  end;
end;

{ on draw column cell }

procedure TRecordsBrowserFrameBase.GridColumnWidthAdjust(Sender: TObject; const Rect: TRect; DataCol: Integer; Column: TColumn; State: TGridDrawState);
var
  ColWidth, TextWidth, TitleWidth: Integer;
begin
{ ajusta a capitalização do texto das células }
  (Sender as TJvDBGrid).Canvas.Pen.Color := clWhite;
  (Sender as TJvDBGrid).Canvas.Rectangle(Rect);
  (Sender as TJvDBGrid).Canvas.TextOut(Rect.Left+2, Rect.Top+2, NameCase(Column.Field.DisplayText));
{ ajusta as colunas de uma grade de acordo com o conteúdo das células }
  gdVisibleRows := (Sender as TJvDBGrid).VisibleRowCount;
  gdVisibleCols := (Sender as TJvDBGrid).VisibleColCount;
  TitleWidth := MaxColSpacing + (Sender as TJvDBGrid).Canvas.TextExtent(Column.Title.Caption).cx;
  TextWidth := MaxColSpacing + (Sender as TJvDBGrid).Canvas.TextExtent(NameCase(Column.Field.DisplayText)).cx;
  ColWidth := Column.Width;
  {$WARNINGS OFF}
  if (TextWidth > gdCols[DataCol].Reverter) and (TextWidth < ColWidth) then gdCols[DataCol].Reverter := TextWidth;
  if (TextWidth > ColWidth) then { texto da célula é mais largo que a coluna }
  begin
    gdCols[DataCol].Registered := True;
    gdCols[DataCol].LastWidth := ColWidth;
    gdCols[DataCol].CurrWidth := TextWidth;
    gdCols[DataCol].Updated := False;
    gdCols[DataCol].RecNo := BrowserQuery.RecNo;
    gdCols[DataCol].Reverter := TitleWidth;
    Exit;
  end;
  if (ColWidth < TitleWidth) then { texto da célula é menor que o título da coluna }
  begin
    gdCols[DataCol].Registered := True;
    gdCols[DataCol].LastWidth := ColWidth;
    gdCols[DataCol].CurrWidth := TitleWidth;
    gdCols[DataCol].Updated := False;
    gdCols[DataCol].Reverter := TitleWidth;
    Exit;
  end;
{$WARNINGS ON}
end; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-02-22T17:42:37.340

使用程序`DbGrid1.AutoAdjustColumns`，就是这样。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-05-17T02:28:45.050

你好使用这个程序。

```
Procedure AutoSizeColDBGrid(DBGrid:TDBGrid);
var i, ColWidth, ColTextWidth:integer;
begin
 if DBGrid.DataSource.DataSet.Active then
   begin
     DBGrid.DataSource.DataSet.DisableControls;
     for i:= 0 to DBGrid.Columns.Count-1 do
       begin
         ColWidth:=DBGrid.Canvas.TextWidth(DBGrid.Columns[i].Field.DisplayLabel);
         DBGrid.DataSource.DataSet.First;
       while not DBGrid.DataSource.DataSet.EOF do
        begin
       ColTextWidth:=DBGrid.Canvas.TextWidth(DBGrid.Columns[i].Field.DisplayText);
          if (ColTextWidth > ColWidth) then
            begin
              ColWidth := ColTextWidth;
            end;
          DBGrid.DataSource.DataSet.Next;
       end;{while}
       DBGrid.Columns[i].Width:=ColWidth+10;
     end;{for}
DBGrid.DataSource.DataSet.EnableControls;
DBGrid.DataSource.DataSet.First;
end;
end; 
```

# c# - 检查是否存在然后插入到 SortedList 的快速方法

> ID：13292945
> 
> 赞同：9
> 
> 时间：2012-11-08T16:11:14.237
> 
> 标签：c#, performance, sortedlist

每当我想插入 a`SortedList`时，我都会检查该项目是否存在，然后插入。这是两次执行相同的搜索吗？一次查看项目是否存在，然后再次查找插入项目的位置？有没有办法优化它以加快速度，或者这只是这样做的方法，不需要更改？

```
if( sortedList.ContainsKey( foo ) == false ){
    sortedList.Add( foo, 0 );
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T16:13:43.787

您可以将项目添加到 HashSet 和列表中，在哈希集中搜索是查看是否必须将值添加到列表的最快方法。

```
if( hashSet.Contains( foo ) == false ){
    sortedList.Add( foo, 0 );  
    hashSet.Add(foo);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:22:16.887

您可以使用索引器。索引器在内部以最佳方式执行此操作，首先使用二进制搜索查找与键对应的索引，然后使用此索引替换现有项目。否则，通过考虑已计算的索引来添加新项目。

```
list["foo"] = value; 
```

无论密钥是否已经存在，都不会引发异常。

* * *

**更新**：

如果新值与旧值相同，则替换旧值与什么都不做具有相同的效果。

请记住，已完成二进制搜索。这意味着在 1000 个项目中找到一个项目大约需要 10 个步骤！`log2(1000) ~= 10`. 因此，进行额外的搜索不会对速度产生重大影响。在 1,000,000 个项目中搜索只会将该值加倍（约 20 步）。

但是通过索引器设置值在任何情况下都只会进行一次搜索。我使用 Reflector 查看了代码并可以确认这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-12T19:40:14.730

如果这不能回答您的问题，我很抱歉，但我不得不说，有时 .NET 中的默认集合结构在功能上受到不合理的限制。`Add`如果方法返回一个指示成功/失败的布尔值，这可能已经被处理了`HashSet<T>.Add`。所以一切都在一步完成。事实上，整个 of`ICollection<T>.Add`应该是一个布尔值，因此在实现方面它是强制的，就像`Collection<T>`在 Java 中一样。

您可以使用[Servy](https://stackoverflow.com/questions/13292945/c-sharp-fast-way-to-check-and-then-insert-into-a-sortedlist#comment18125094_13292945)`SortedDictionary<K, V>`指出的结构，也可以使用和在[同行的答案](https://stackoverflow.com/a/13292980/661933)中的组合以获得*更好的性能*，但他们都没有真正坚持*只做一次*哲学。我尝试了几个开源项目，看看在这方面是否有更好的实现，但找不到。`HashSet<K>``SortedList<K, V>`

 **您的选择：

1.  在绝大多数情况下，进行两次查找是可以的，不会造成太大的伤害。坚持一个。没有内置解决方案。

2.  编写自己的`SortedList<K, V>`类。这一点都不难。

3.  如果你很绝望，你可以使用反射。该`Insert`方法是 SortedList 类中的私有成员。[一个例子。](https://stackoverflow.com/questions/13414564/how-to-override-sortedlist-add-method-for-sorting-by-value). 请不要这样做。这是一个非常非常糟糕的选择。为了完整起见，在此提及。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:19:07.143

`ContainsKey`进行二进制搜索，即 O(log n)，因此除非您列出大量，否则我不会太担心。而且，据推测，在插入时，它会进行另一次二进制搜索以找到要插入的位置。

避免这种情况的一种选择（搜索两次）是使用 List 的[BinarySearch](http://msdn.microsoft.com/en-us/library/w4e7fxsh.aspx)方法。如果未找到该项目，这将返回一个负值，并且该负值是应插入该项目的位置的按位补充。所以你可以寻找一个项目，如果它不在列表中，你就知道它应该插入到哪里来保持列表的排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-26T05:40:33.323

`SortedList<Key,Value>`是一种您可能根本不应该使用的慢速数据结构。您可能已经考虑过使用`SortedDictionary<Key,Value>`，但发现它不方便，因为这些项目没有索引（您不能编写`sortedDictionary[0]`），并且您可以为但不编写[查找最近的键](https://stackoverflow.com/questions/1690929/what-net-dictionary-supports-a-find-nearest-key-operation)操作。`SortedList``SortedDictionary`

但是如果你愿意切换到第三方库，你可以通过改变不同的数据结构来获得更好的性能。

`SortedList<Key,Value>`Loyc Core 库包含一种数据类型，它的工作方式与列表大时相同，但速度显着加快。它被称为[`BDictionary<Key,Value>`](http://core.loyc.net/collections/alists-part2.html)。

现在，回答您最初的问题：是的，您编写代码的方式是执行两次搜索和一次插入（插入是最慢的部分）。如果切换到`BDictionary`，则有一种方法[`bdictionary.AddIfNotPresent(key, value)`](http://loyc.net/doc/code/classLoyc_1_1Collections_1_1BDictionary_3_01K_00_01V_01_4.html#ac3ab38d44d37bd1d446fb9632181e829)可以将这两个操作组合成一个操作。如果添加了指定的项目，则返回 true，如果已存在，则返回 false。**

# arrays - 使用 gfortran 编译器读取 fortran 中的数组

> ID：13292946
> 
> 赞同：1
> 
> 时间：2012-11-08T16:11:15.690
> 
> 标签：arrays, gfortran

我想用这一行读取 Fortran 代码中的数据数组： read(irdcld, 9101,end=9000) ctest,lay, frac, (datbinsa(ibin), & ibin= 1, nbins), (datbinsb(ibin ), ibin= 1, nbins)

我正在用 gfortran 编译。不幸的是，出现了这个错误信息：read(irdcld, 9101,end=9000) ctest, lay, frac, (datbinsa(ibin), & 1 Error: Expected variable in READ statement at (1)

如果我只输入： read(irdcld, 9101,end=9000) ctest, lay, frac, datbinsa(ibin) 我可以阅读这些行但我想阅读整个数组！使用 ggfortran 作为编译器时如何读取数组？谢谢您的帮助！！

# javascript - Node.js 模块插件

> ID：13292947
> 
> 赞同：1
> 
> 时间：2012-11-08T16:11:26.630
> 
> 标签：javascript, node.js

我希望找出编写 Node.js 模块的最佳实践，特别是代码分离要遵循的 javascript 模式类型。

我一直在使用的一种风格是：

```
var Something;

Something = (function() {

    function Something() {
    }

    Something.prototype.some = function() {

    }

    return Something;

})();

module.exports = Something; 
```

另一种风格是：

```
module.exports = {
 item: "one",
 some: function() {

 },
 another: function() {

 }
} 
```

在 node.js 中，是否有任何理由不建议使用第二种方法？还是有另一种更受欢迎的格式，有什么优势？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:16:40.487

您在使用“this”关键字时遇到问题。您必须使用它而不是“某物”。所以Something.some() 你可以运行...但是如果你想在底部运行它，你就必须运行this.run()。this 的范围在其他功能中会发生变化，并且可能会变得混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:19:51.930

有几种变体，包括将属性直接分配给`exports`，将新的对象文字分配给`module.exports`和其他一些。在大多数情况下，它们只是完成完全相同的事情的语法糖或语法替代品。我个人的偏好是尽可能多地保留我的代码不受污染的纯 JS，并将 CommonJS 习语分开。所以我这样做：

```
function myFunction() {

}

var MY_STRING = "Forty-two";

module.exports = {
    myFunction: myFunction,
    MY_STRING: MY_STRING
}; 
```

它有点样板，容易出现维护错误，但我更喜欢它而不是替代品，因为我真的不喜欢将 CommonJS 模块级别的名称（模块、导出）散布在我的代码中。CoffeeScript 使最后一部分变得更容易，因为您可以这样做：

```
module.exports = {
    myFunction
    MY_STRING
} 
```

# ios - 如何用在另一个选项卡上创建的对象填充表视图？

> ID：13292948
> 
> 赞同：0
> 
> 时间：2012-11-08T16:11:27.453
> 
> 标签：ios, xcode, tableview, tabbar

我是 xcode 的新手，现在我已经为此苦苦挣扎了 5 天，我的脑袋几乎要炸飞了，因为我知道这一定很简单！

我有一个带有 2 个标签的基于标签栏的 iPhone 应用程序。在第一个上，我想创建新项目并将它们存储在我已经创建的“存储库”NSObject 类中的 NSMutableArray 中。

这个 Repository 类具有 add、remove、update 和 fetchAll Items 等方法。最后一个是返回存储在 NSMUtable 数组中的所有项目的方法。

还有一个 NSObject "Item" 类表示什么是 Item。

在第二个选项卡上，我有一个表格视图控制器，我想用第一个选项卡上创建的项目填充它，这些项目已存储在“存储库”类中。

我的问题是：

*   我必须在进程的某个地方分配初始化我的存储库，以便我可以调用“存储库”类方法。问题是，如果我在第一个选项卡控制器上分配初始化存储库，每次加载第一个选项卡时，它都会再次分配初始化存储库，并且那里的项目刚刚消失。第二个选项卡也是如此。

那么我应该在哪里分配初始化我的存储库，以便我可以在第一个选项卡视图中调用“add”方法并在第二个选项卡视图（即表视图）中调用“delete”和“fetchAll”方法并保证我正在处理相同的存储库数据？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:26:48.230

> 我必须在进程的某个地方分配初始化我的存储库，以便我可以调用“存储库”类方法。问题是，如果我在第一个选项卡控制器上分配初始化存储库，每次加载第一个选项卡时，它都会再次分配初始化存储库，并且那里的项目刚刚消失。第二个选项卡也是如此。

看来您可能需要一个单身人士。

单例是一个唯一的全局对象，您可以从应用程序的任何位置访问它。在第一次访问时，它也会被创建。在任何后续访问中，将返回现有对象。

看看[这篇文章以获得一个很好的教程](http://www.galloway.me.uk/tutorials/singleton-classes/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:30:44.050

听起来您可以在应用程序委托中为您的“存储库”类提供一个属性，并在应用程序完成启动后立即将其初始化。然后，您将能够从代码的任何部分访问它。

或者，您可以继承 UITabBarViewController 并在控制器的 viewDidLoad 方法中初始化“存储库”对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:37:13.990

似乎您在传递数据方面遇到了问题。正如@sergio 建议的那样，您可以使用单例。`Utility`此外，为所有全局方法使用一个类也是一个好主意。因此，您可以在另一个选项卡中更新您的变量，当您在它们之间切换时，值将被反映。

# sftp - 使用 JSCH 从 FTP 服务器下载多个文件

> ID：13292953
> 
> 赞同：1
> 
> 时间：2012-11-08T16:11:51.230
> 
> 标签：sftp, jsch

我想使用 JSCH 从 FTP 服务器下载所有文件。

下面是代码片段，

```
 List<File> fileList = null;
        Vector<ChannelSftp.LsEntry> list = sftpChannel.ls(remoteFolder);
        for (ChannelSftp.LsEntry file : list) {

            if( getLog().isDebugEnabled() ){
                getLog().debug("Retrieved Files  from the folder  is"+file);
            }

            if (!(new File(file.getFilename())).isFile()) {
                continue;
            }
       fileList.add(new File(remoteFolder,file.getFilename())) ;
       return fileList; 
```

该方法将返回列表，用于另一种使用 sftpChannel.get(src,dest) 从远程服务器下载文件的方法；

请让我知道代码是否正常。我没有环境可以测试，所以无法确认。但是我为 FTPClient 编写的代码有些相似，并且可以正常工作。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T10:48:26.647

您可以使用 SftpATTRS 获取文件信息。您可以声明一个包装类来存储文件信息。一个例子如下所示。

```
 private class SFTPFile
{
    private SftpATTRS sftpAttributes;

    public SFTPFile(LsEntry lsEntry)
    {
        this.sftpAttributes = lsEntry.getAttrs();
    }

    public boolean isFile()
    {
        return (!sftpAttributes.isDir() && !sftpAttributes.isLink());
    }
} 
```

现在你可以使用这个类来测试 LsEntry 是否是一个文件

```
 private List<SFTPFile> getFiles(String path)
{
    List<SFTPFile> files = null;
    try
    {
        List<?> lsEntries = sftpChannel.ls(path);
        if (lsEntries != null)
        {
            files = new ArrayList<SFTPFile>();
            for (int i = 0; i < lsEntries.size(); i++)
            {
                Object next = lsEntries.get(i);
                if (!(next instanceof LsEntry))
                {
                    // throw exception
                }
                SFTPFile sftpFile = new SFTPFile((LsEntry) next);
                if (sftpFile.isFile())
                {
                    files.add(sftpFile);
                }
            }
        }
    }
    catch (SftpException sftpException)
    {
        //
    }
    return files;
} 
```

现在您可以使用 sftpChannel.get(src,dest) ；下载文件。

# c# - 通讯群发电子邮件

> ID：13292959
> 
> 赞同：-2
> 
> 时间：2012-11-08T16:12:17.313
> 
> 标签：c#, asp.net

我的时事通讯有点问题...

让我解释一下：我有一个包含我的电子邮件的 sql 表，没有其他内容，还有一个 sql 表，我在发送邮件后存储邮件，不知何故邮件不会发送，但它会保存邮件。

这一切都设置在一个formview中。

```
protected void btnSendNewsLetter_Click(object sender, EventArgs e)
    {
        TextBox subject = (TextBox)fvNewsletter.Row.FindControl("txtSubject");
        TextBox body = (TextBox)fvNewsletter.Row.FindControl("txtBody");

        string connection = WebConfigurationManager.ConnectionStrings["GreenCollaborationConnectionString"].ConnectionString;

        SqlConnection con = new SqlConnection(connection);

        con.Open();

        SqlCommand comm = new SqlCommand("Select Email from MailingList", con);
        SqlDataAdapter da1 = new SqlDataAdapter(comm);
        GreenDataSet ds1 = new GreenDataSet();
        da1.Fill(ds1);
        if(ds1.Tables[0].Rows.Count > 0)
        {
            for (int i = 0; i <= ds1.Tables[0].Rows.Count - 1; i++)
            {
                string email = ds1.Tables[0].Rows[i].ItemArray[0].ToString();
                System.Net.Mail.MailMessage mail = new System.Net.Mail.MailMessage();
                mail.From = new MailAddress("noreply@GreenCollaboration.com", "GreenCollaboration");
                mail.To.Add(email);
                mail.Subject = subject.Text;
                mail.SubjectEncoding = System.Text.Encoding.UTF8;
                mail.BodyEncoding = System.Text.Encoding.UTF8;
                mail.IsBodyHtml = true;
                mail.Body = body.Text;
            }
        }
    } 
```

我希望some1可以帮助我:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:22:22.077

尝试以下操作：

```
protected void btnSendNewsLetter_Click(object sender, EventArgs e)
{
    //snip

    //Create the smtp client to send the mails with.
    SmtpClient client = new SmtpClient(server);
    // Add credentials if the SMTP server requires them.
    client.Credentials = CredentialCache.DefaultNetworkCredentials;

    if(ds1.Tables[0].Rows.Count > 0)
    {
        for (int i = 0; i <= ds1.Tables[0].Rows.Count - 1; i++)
        {
            string email = ds1.Tables[0].Rows[i].ItemArray[0].ToString();
            System.Net.Mail.MailMessage mail = new System.Net.Mail.MailMessage();
            //snip
            try 
            {
                client.Send(message);
            }
            catch (Exception ex) 
            {
                Console.WriteLine(ex.ToString());             
            }
        }
    }
} 
```

[Msdn MailMessage 类](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.aspx#exampleToggle)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:26:03.463

您生成了消息，但从未真正发送过它们。有几种不同的发送机制，例如 SMTP 或 Exchange

所以如果你打算使用 SMTP

```
//Somewhere on top
var server="EMAIL.CORP.COMPANY" //or "10.10.10.10"
var smtpClient= new SmtpClient(server);
smtpClient.Credentials = CredentialCache.DefaultNetworkCredentials; //AD credentials

//In the end of your for loop
try {
    smtpClient.Send(mail);
catch (Exception ex) {
    //Handle the exception    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:21:21.330

呃...似乎您只是缺少以下内容：

```
SmtpClient client = new SmtpClient();
client.Send(message); 
```

把它放在下面的行：

```
mail.Body = body.Text; 
```

并将以下详细信息放入您的 web.config

```
<system.net>
  <mailSettings>
    <smtp from="test@foo.com">
      <network host="smtpserver1" port="25" userName="username" password="secret" defaultCredentials="true" />
    </smtp>
  </mailSettings>
</system.net> 
```

编辑：这解决了不发送电子邮件的直接问题。

但是，正如在其他地方所指出的那样，要批量发送电子邮件，您应该做一个更健壮的实现，例如查看[此链接以获取大量电子邮件发件人示例](http://www.emailarchitect.net/webapp/smtpcom/developers/netpool.asp)

# html - 使用 CSS3 选择除最后一行之外的所有行

> ID：13292961
> 
> 赞同：1
> 
> 时间：2012-11-08T16:12:30.697
> 
> 标签：html, css, css-selectors

我正在尝试选择某个类的行中的所有元素，但该类的最后一行除外。我一直在试图找出正确的语法来做到这一点，但我就是想不通。

这是我认为可以完成这项工作的 CSS：

```
tr.ListRow:not(:last-of-type) td {
    padding: 14px;
    border-bottom-color: #768ca5;
    border-bottom-width: 1px;
    border-bottom-style: solid;
} 
```

这是 HTML，因此您可以了解我要做什么。

```
<tbody>
    <tr class="Row ListRow">..........</tr> <!-- CSS applied to <td> tags within -->
    <tr class="Graph">..........</tr> 
    <tr class="AltRow ListRow">........</tr> <!-- CSS applied to <td> tags within -->
    <tr class="Graph">..........</tr> 
    <tr class="Row ListRow">..........</tr> <!-- CSS applied to <td> tags within -->
    <tr class="Graph">..........</tr> 
    .
    .
    .
    .
    <tr class="AltRow ListRow">........</tr> <!-- CSS NOT applied to this last row of class ListRow -->
    <tr class="Graph">..........</tr> 
</tbody> 
```

**编辑：我最终选择了一条 javascript 路线，我在下面回答了该路线。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:57:55.607

当前无法使用 CSS 选择给定类的最后出现的元素，或类的除最后一个元素之外的所有元素。`:last-of-type`在这里不起作用，因为它表示“最后一个`tr`元素”，而不是“与此复合选择器匹配的最后一个元素”，并且您的 last`tr.ListRow`不是 last `tr`。

同级组合器的性质使得[对某个类的](https://stackoverflow.com/questions/2717480/css-selector-for-first-element-with-class/8539107#8539107)[*第一个*](https://stackoverflow.com/questions/2717480/css-selector-for-first-element-with-class/8539107#8539107)[元素使用覆盖规则](https://stackoverflow.com/questions/2717480/css-selector-for-first-element-with-class/8539107#8539107)*成为可能。*但是，这对于最后*一个是不可行的。*

 *您将不得不在 last `tr.ListRow`， like`Last`和 select添加一个特殊的类`tr.ListRow:not(.Last)`，或者找到一种不同的方法来解决这个问题。

另请参阅：[是否可以使用当前浏览器使用伪类来检测某个类的第一个和最后一个？](https://stackoverflow.com/questions/10230416/is-it-possible-using-current-browsers-to-use-pseudo-classes-to-detect-first-and/10230466#10230466)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:03:53.907

由于其他人指出使用单个选择器无法做到这一点，因此我选择使用 jQuery 来完成此任务。

```
function RemoveLastRowBotBorder() {
    var rows = $(".ListRow");
    $(rows[rows.length - 1]).removeClass("ListRow");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:01:02.443

您可以通过以下方式执行此操作

css

```
.link td {
    background-color:#066;
}
tr.link:last-child td{
    background-color: lime;
} 
```

html

```
<table width="200" border="1"><tbody>
  <tr>
    <td align="center" valign="middle">1</td>
  </tr>
  <tr class="link">
    <td align="center" valign="middle">2 with Link Class</td>
  </tr>
  <tr>
    <td align="center" valign="middle">3</td>
  </tr>
  <tr class="link">
    <td align="center" valign="middle">4 with Link Class</td>
  </tr>
  <tr>
    <td align="center" valign="middle">5</td>
  </tr>
  <tr class="link">
    <td align="center" valign="middle">6 with Link Class</td>
  </tr>
</tbody></table> 
```

检查[jsFiddle 文件](http://jsfiddle.net/fU7uP/)*

# java - Java中容器内的容器

> ID：13292964
> 
> 赞同：3
> 
> 时间：2012-11-08T16:12:42.397
> 
> 标签：java, swing, user-interface, containers

我有一个 Java 程序，`BorderLayout`到目前为止运行良好。我想`JTextArea`在按下运行按钮后在其下方添加一个以显示输出。

有人可以告诉我一个完成我想做的最好方法的例子吗？我应该先定义一个`GridLayout`2X1 的`BorderLayout`顶部然后再定义一个`JTextArea`底部吗？

我愿意接受建议...

这是我到目前为止所拥有的图像： ![在此处输入图像描述](../Images/396cc7175e1f8bbf1e925aaa64422fa9.png)

在此下方——我想要一个文本区域，一旦我单击运行按钮，它将捕获输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:47:29.920

如果我明白了，当你点击运行按钮时，你想在整个东西下面添加一个 TextArea。

我建议使用 2 个面板。将您已有的所有内容放在一个面板中（该面板将具有borderLayout），然后在其下方放置另一个面板，当您点击“运行”按钮时，您可以在其中以编程方式添加JtextArea。

**编辑**
类似的东西：

```
Window
|
|--- Panel  (borderLayout)
|      | --- (things you already have)
|
|--- Panel 2
     | ---- (JTextArea, added later by code) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:48:39.180

使用`border layout`.
将您现有的 GUI 添加到 a并将`panel`其添加到`center`of`frame`和您`TextArea`的`south`.`border layout`

代码片段：

```
frame.setLayout(new BorderLayout());
frame.add(BorderLayout.CENTER, panel);  //panel== your existing GUI
frame.add(BorderLayout.SOUTH, textArea);  //new TextArea 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T17:01:53.203

正如我在评论中所说......这样的事情怎么样：

```
import java.awt.Color;
import java.awt.Dimension;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class Ironmantis extends JFrame{
    JTextArea textArea = new JTextArea();
    JPanel upperPanel = new JPanel();
    JSplitPane splitPane = new JSplitPane(JSplitPane.VERTICAL_SPLIT,upperPanel,new JScrollPane(textArea));

    public Ironmantis(){
        textArea.setEditable(false);
        textArea.append("Operating system: "+System.getProperty("os.name")+"\n");
        textArea.append("Operating System version: " +System.getProperty("os.version")+"\n");
        textArea.append("Operating system architecture: "+ System.getProperty("os.arch")+"\n");
        textArea.append("Java version: "+ System.getProperty("java.version")+"\n");
        textArea.append("Java vendor: "+ System.getProperty("java.vendor")+"\n");
        textArea.append("Java vendor URL: "+ System.getProperty("java.vendor.url")+"\n");
        upperPanel.setPreferredSize(new Dimension(800,400));
        upperPanel.setBackground(Color.CYAN);
        splitPane.setPreferredSize(new Dimension(800,600));
        add(splitPane);
    }

    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (UnsupportedLookAndFeelException e) {
            e.printStackTrace();
        }

        SwingUtilities.invokeLater(new Runnable(){
            public void run(){
                Ironmantis i = new Ironmantis();
                i.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                i.pack();
                i.setVisible(true);
            }
        });

    }

} 
```

![在此处输入图像描述](../Images/9c3f6ca50518b4f043c288468c644572.png)

通过添加 your `JPanel`and `JTextArea`on `JSplitPane`，您`JTextArea`将扮演某种控制台的角色，如果我理解正确，这就是您的问题的目标。

# java - 通过 Java 以编程方式收缩 HPGL 文件

> ID：13292967
> 
> 赞同：0
> 
> 时间：2012-11-08T16:12:50.107
> 
> 标签：java, file, vector-graphics, file-manipulation

我需要以编程方式（即没有人工交互）在 Java 中加载 HPGL 文件（来自第三方软件）并创建一个具有不同比例的新 HPGL 文件（X 比率和 Y 比率，作为参数传递给程序）

假设我有一个方形文件“One.hpgl”（X=1mt Y=1mt）。从外面我收到 xratio = 90% yratio=110%。我需要编写 Java 代码来生成输出“ModifiedOne.hpgl”，它是一个矩形（X=90cm Y=1.10mt）。

在Java中可行吗？如果是这样，对于此类工作，建议使用哪个 HPGL 库？我是 HPGL 的新手，所以如果可能的话，应该每个文件执行一次“缩小/放大”还是“逐段”？我问是因为我应该缩小的 HPGL 文件不是简单的正方形，而是更复杂的图纸，因此逐行“缩小”将非常困难。

感谢你给与我的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:52:54.700

Java 中似乎没有现成的 HPGL 解析器。

看看这里：[https](https://github.com/sigram/pcl-parser) ://github.com/sigram/pcl-parser （有限的HPGL，但已经在Java中）

也在这里：[http](http://hpgs.berlios.de/) ://hpgs.berlios.de/ （更完整的 HPGL 支持，但在 C 中）

HPGL 参考也可用，因此您可以从头开始创建解析器。

# python - 拆分列表和添加值

> ID：13292970
> 
> 赞同：0
> 
> 时间：2012-11-08T16:13:05.517
> 
> 标签：python

我有以下列表

```
lst = ['Adam,widgets,5769', 'joe,balls,7186', 'greg,tops,1819.999',] 
```

我需要能够获取列表，然后将 Adams 数除以 100，然后将新数字放回列表中，然后将其添加到 gregs 总数中。我从拆分列表开始，我不想要某人为了纠正代码，我只需要一种方法来分离列表的每个部分，以便我可以将其视为单独的部分。

```
for i in sod_hng_hhl_lst:
    g=i.split(",") 
```

这给

```
['Adam','widgets','5769'] 
```

ETC

什么是划分数字然后将其添加到列表中的另一个组的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:17:29.640

以这种方式使用元组解包，如果您知道总是有 3 个项目：

```
name,type,number = i.split(',')
# now name="Adam", type="widgets", number="5769" 
```

在您的示例中：

```
for triplet in sod_hng_hhl_lst:
    name,type,numberString = triplet.split(",")
    # because this is a string and we want a number:
    num_as_integer = int(numberString)
    # do something with num_as_integer
    new_number = num_as_integer * 2
    newtriplet = ','.join([name, type, new_number]) 
```

但是，我强烈建议使用值元组而不是拆分的字符串：

```
sod_hng_hhl_lst = [ ('Adam', 'widgets', 5769),
                    #... etc
                  ] 
```

这样数字保持为数字，您不必一直连接和拆分字符串。

```
for idx,triplet in enumerate(sod_hng_hhl_lst):
    name,type,number = triplet
    new_number = number * 2
    # change just the number in the triplet
    sod_hng_hhl_lst[idx][2] = new_number 
```

如果人们总是有唯一的名字，那么正如 mgilson 建议的那样，您可以使用字典：

```
dct = {"Adam": ('widgets', 5769),
       #....
      } 
```

迭代：

```
for person,details in dct.items():
    thing, number = details
    new_num = number * 2
    dct[person][1] = new_num 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:18:08.717

```
In [1]: lst = ['Adam,widgets,5769', 'joe,balls,7186', 'greg,tops,1819.999']

In [2]: lst = [s.split(',') for s in lst]

In [4]: for l in lst:
    l[-1] = float(l[-1])
   ...:     

In [5]: for l in lst:
   ...:     if l[0] == "Adam":
   ...:         l[-1] /= 100
   ...:         

In [6]: lst
Out[6]: 
[['Adam', 'widgets', 57.69],
 ['joe', 'balls', 7186.0],
 ['greg', 'tops', 1819.999]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:19:59.133

在我看来，字典将是一个*更好*的数据结构。

```
splitter = (x.split(',') for x in original_list)
d = { k:[v1,float(v2)] for k,v1,v2 in splitter } 
```

现在您可以通过此人的姓名访问数据：

```
assert d['Adam'][1] == 5769 
```

换句话说，`d['Adam']`会给您列表`['widget',5769]`，您可以从那里更改号码，将其添加到其他人的号码等。

# cakephp - 没有分页的可排序列标题？

> ID：13292974
> 
> 赞同：1
> 
> 时间：2012-11-08T16:13:27.590
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

我希望能够在不需要分页的情况下显示所有记录，但仍然希望通过使用类似`$this->Paginator->sort()`.

目前我正在设置`'limit' => 100`，因为我知道我一次不会有超过 50 条记录，这工作得很好，但是我想知道是否基本上有一种方法可以在没有分页的情况下以其他方式完成可排序的列例如`'limit' => unlimited`或其他可以完成此任务的 CakePHP 组件。

这是控制器：

```
class GroupsController extends AppController {

    public function view($slug = null) {

        $group = $this->Group->findBySlug($slug);

        $this->paginate = array(
            'Person' => array(
                'conditions' => array('Person.group_id' => $group["Group"]['id']),
                'limit' => 100,
                'recursive' => 0
            )
        );

        $people = $this->paginate('Person');

        $this->set('people', $people);

    }
} 
```

这是视图：

```
<table>
    <tr>
        <th><?php echo $this->Paginator->sort('Person.id','Id'); ?></th>         
        <th><?php echo $this->Paginator->sort('first_name', 'First Name'); ?></th>         
        <th><?php echo $this->Paginator->sort('last_name', 'Last Name'); ?></th>         
    </tr>
    <!-- Here is where we loop through the people -->
    <?php foreach ($people as $person): ?>
    <tr>
        <td><?php echo $person['Person']['id']; ?></td>
        <td><?php echo $person['Person']['first_name']; ?></td>
        <td><?php echo $person['Person']['last_name']; ?></td>
    </tr>
    <?php endforeach; ?>
    <?php unset($player); ?>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:53:54.470

它是处理列排序的分页组件。如果您不想使用分页器（为什么不呢？），您将不得不编写自己的代码来执行此操作。

您可以对代码进行的一项小调整是：

```
'limit' => $this->Group->find('count') 
```

这将确保您始终有足够的限制来显示完整的表格。

# svn - 将主干、分支和标签目录添加到已建立的 svn 后，我仍然无法创建标签

> ID：13292977
> 
> 赞同：1
> 
> 时间：2012-11-08T16:13:32.617
> 
> 标签：svn, tortoisesvn, branch

与[这个问题](https://stackoverflow.com/questions/6657337/how-to-add-tags-trunk-branches-to-established-svn-repo)类似，当需要分支和标记时，我将我的主干“上移了一层”。

我的布局是：

```
 /
   /src
   /inc
   /doc 
```

现在是

/ /主干 /src /inc /doc /tags

/分支机构

但是，我似乎无法在移动之前从修订版创建标签或分支。当我命令分支时，TortoiseSVN 给出了这个错误：“禁止访问'/usvn/svn/MyAppName/!svn/bc/1187'”。但是，我有读写权限，我的路径的情况也可以。

是否有没有 export-from-trunk-and-reimport-to-tags 的方法来避免此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:44:39.877

看看[这个答案](https://stackoverflow.com/a/6470530/282194) 跳出我的一种可能性（我个人经历过）是您可能正确设置了路径，但 URL 的服务器部分可能有不同的大小写。

# bash - Bash 脚本，阅读结束脚本？

> ID：13292982
> 
> 赞同：0
> 
> 时间：2012-11-08T16:13:50.103
> 
> 标签：bash, shell, sh

```
#!/bin/sh
echo "one"
read host
echo "two"
read ip
echo "three"
read oid
read oid
echo $oid $host >> logger.txt 
```

它永远不会呼应“二”

无论我是否以任何不同的方式手动传递参数（这是为了接收 SNMP 陷阱，并且参数来了）。

编辑：这有权限等，我通过手动启动它来测试它，“一个”被回显。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T16:17:04.997

`read`等待来自 STDIN 的输入。

如果您不手动插入任何输入（在交互式终端中），或者您不提供来自 STDIN 的任何输入，如下所示：

```
echo -e "my_host\n192.168.1.100\nfoo\nbar" | ./myscript 
```

它会挂起等待输入

在示例`\n`中是换行符。

如果要访问参数，请不要使用`read`，而是使用 $1...$n 变量。

```
./myscript my_host 192.168.1.100 foo 
```

你需要这个：

```
#!/bin/sh
host=$1
ip=$2
oid=$3
echo $oid $host >> logger.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:20:54.470

read 实际上等待用户输入。 `read host`将等待用户输入任何数据，直到他按下返回键，用户输入的任何数据都将存储在主机中。

# css - 展示：盒子；我有一个问题

> ID：13292983
> 
> 赞同：0
> 
> 时间：2012-11-08T16:13:56.293
> 
> 标签：css

我`display: box;`有财产问题。（我知道它已被弃用，但 flexbox 目前几乎不能在任何浏览器中使用）。

当我重新调整浏览器的大小并且窗口宽度变得小于 4 个`<li>`项目的宽度时，它们不会相互层叠。如果我删除`display:box;`它应该正常工作的东西，但它没有居中。

有什么可以做的吗？还是盒子属性有问题？

直播：http: [//jsfiddle.net/ALGNq/2/](http://jsfiddle.net/ALGNq/2/)

编辑：我注意到这只是 Firefox。然而，在 Chrome 中，当浏览器太小时，框会“粘”在左侧。

# atlassian-fisheye - 仅在 Atlassians Fisheye 工具中获取差异

> ID：13292984
> 
> 赞同：0
> 
> 时间：2012-11-08T16:13:57.093
> 
> 标签：atlassian-fisheye, code-search

有时在使用 Atlassian 的 Fisheye 搜索代码时，我只能在 Diffs 选项卡下获得结果。这是否意味着用于引用我搜索的代码但由于它没有显示在内容下而不再引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:39:38.710

没错——“内容”只搜索 HEAD 修订版。

# c - 将文本从终端复制到内存

> ID：13292987
> 
> 赞同：0
> 
> 时间：2012-11-08T16:14:00.443
> 
> 标签：c, linux, console, terminal

我知道它看起来很丑，但是，假设一个简单的程序，如：

```
int main(void)
{
   int line=0, column=1;
   char c;
   system("clear");
   printf("0123\n4567\n");

   getprintedchar(column, line, &c);
   printf("%c", c);
   return 0;
} 
```

那将打印 number `1`。

我们如何使用 LINUX 终端编写这样的功能。我知道我们可以使用`ncurses`，但这会阻止很多选项`printf`等等。

我想知道我们是否可以使用`struct termios`或其他一些超级笨拙的黑客！

对于那些来自 borland/windows 的人来说，它类似于`conio.h`function的简化版本`gettext()`。

我们可以读取某个内存区域吗？也许有些`assembly`是直接从某个区域获取角色的`Video RAM`？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:23:02.207

> 我知道我们可以使用 ncurses，但这会阻止 printf 等允许的很多选项。

您始终可以使用`snprintf`格式化字符串，然后以任何您想要的方式输出它。(N)curses 是一个很好的终端处理库。

> 我们可以读取某个内存区域吗？

特别是，这是不可能的。您无法访问终端的内存，因为它是一个单独的进程并且不会共享。

# iphone - 使用 Theos 添加 CoreMotion 框架

> ID：13292991
> 
> 赞同：1
> 
> 时间：2012-11-08T16:14:22.347
> 
> 标签：iphone, core-motion, theos

我正在尝试使用 CoreMotion 框架并在我越狱的 iphone4 上使用 theos 进行编译。我在[将 Twitter.framework 添加到 iPhone 上的 Theos 中](https://stackoverflow.com/questions/10894475/add-twitter-framework-to-theos-on-iphone)注意到需要修改 makefile 以包含必要的框架（我已经这样做了）。我得到的错误是：

RootViewController.h:1:23：错误：CoreMotion/CoreMotion.h：没有这样的文件或目录

这来自以下行： `#import <CoreMotion/CoreMotion.h>`

这是我的makefile的样子：

```
include theos/makefiles/common.mk

APPLICATION_NAME = SensorTest
SensorTest_FILES = main.m SensorTestApplication.mm RootViewController.mm
SensorTest_FRAMEWORKS = UIKit CoreGraphics CoreMotion 

include $(THEOS_MAKE_PATH)/application.mk 
```

有什么建议么？

谢谢，-迈克

# java - 带有 zxing 的 Apache FOP 1.1 QRCodes

> ID：13292995
> 
> 赞同：3
> 
> 时间：2012-11-08T16:14:34.750
> 
> 标签：java, qr-code, zxing, apache-fop, barcode4j

好的，我在使用barcode4j-2.1 和zxing-0.1.2 在FOP 1.1 中生成二维码时遇到问题。`<prefer-renderer>true</prefer-renderer>`通过添加到 fop 配置文件，我目前有一个正常工作的 FOP 1.0 实现。

无论是否设置了首选渲染器，barcode4j 条形码都可以正常工作，在barcode4j-2.1 中已修复。

我有所有必要的依赖：

*   fop-zxing-0.1.2-jar-with-dependencies.jar
*   条形码4j-fop-ext-complete.jar
*   saxon9he.jar - 用于 xslt 2.0 ...

这是条形码片段：

```
<fo:block>
  <fo:instream-foreign-object>
    <qr:qr-code xmlns:qr="http://hobbut.ru/fop/qr-code/"
                   width="5cm"
         message="TEST DATA"
              correction="m"
            encoding="UTF-8">
    </qr:qr-code>
  </fo:instream-foreign-object>
</fo:block> 
```

尝试转换 prefer-renderer 似乎没有效果时，我收到错误消息：

```
SEVERE: Image not available. URI: (instream-object). Reason: org.apache.xmlgraphics.image.loader.ImageException: The file format is not supported. No ImagePreloader found for null (No context info available)
org.apache.xmlgraphics.image.loader.ImageException: The file format is not supported. No ImagePreloader found for null
    at org.apache.xmlgraphics.image.loader.ImageManager.preloadImage(ImageManager.java:180)
    at org.apache.fop.render.intermediate.AbstractIFPainter.drawImageUsingDocument(AbstractIFPainter.java:296)
    at org.apache.fop.render.pdf.PDFPainter.drawImage(PDFPainter.java:203)
    at org.apache.fop.render.intermediate.IFRenderer.renderForeignObject(IFRenderer.java:1290)
    at org.apache.fop.render.AbstractRenderer.renderInlineViewport(AbstractRenderer.java:820)
    at org.apache.fop.render.AbstractPathOrientedRenderer.renderInlineViewport(AbstractPathOrientedRenderer.java:785)
    at org.apache.fop.render.intermediate.IFRenderer.renderInlineViewport(IFRenderer.java:866)
    at org.apache.fop.render.AbstractRenderer.renderInlineArea(AbstractRenderer.java:678)
    at org.apache.fop.render.intermediate.IFRenderer.renderInlineArea(IFRenderer.java:913)
    at org.apache.fop.render.AbstractRenderer.renderLineArea(AbstractRenderer.java:643)
    at org.apache.fop.render.AbstractRenderer.renderBlocks(AbstractRenderer.java:561)
    at org.apache.fop.render.AbstractRenderer.renderBlock(AbstractRenderer.java:598)
    at org.apache.fop.render.intermediate.IFRenderer.renderBlock(IFRenderer.java:980)
    at org.apache.fop.render.AbstractRenderer.renderBlocks(AbstractRenderer.java:546)
    at org.apache.fop.render.AbstractRenderer.renderFlow(AbstractRenderer.java:451)
    at org.apache.fop.render.AbstractPathOrientedRenderer.renderFlow(AbstractPathOrientedRenderer.java:738)
    at org.apache.fop.render.AbstractRenderer.renderMainReference(AbstractRenderer.java:428)
    at org.apache.fop.render.AbstractRenderer.renderBodyRegion(AbstractRenderer.java:352)
    at org.apache.fop.render.AbstractRenderer.renderRegionViewport(AbstractRenderer.java:299)
    at org.apache.fop.render.intermediate.IFRenderer.renderRegionViewport(IFRenderer.java:748)
    at org.apache.fop.render.AbstractRenderer.renderPageAreas(AbstractRenderer.java:273)
    at org.apache.fop.render.AbstractRenderer.renderPage(AbstractRenderer.java:238)
    at org.apache.fop.render.intermediate.IFRenderer.renderPage(IFRenderer.java:597)
    at org.apache.fop.area.RenderPagesModel.renderPage(RenderPagesModel.java:193)
    at org.apache.fop.area.RenderPagesModel.checkPreparedPages(RenderPagesModel.java:174)
    at org.apache.fop.area.RenderPagesModel.addPage(RenderPagesModel.java:146)
    at org.apache.fop.layoutmgr.AbstractPageSequenceLayoutManager.finishPage(AbstractPageSequenceLayoutManager.java:312)
    at org.apache.fop.layoutmgr.PageSequenceLayoutManager.finishPage(PageSequenceLayoutManager.java:191)
    at org.apache.fop.layoutmgr.PageSequenceLayoutManager.activateLayout(PageSequenceLayoutManager.java:115)
    at org.apache.fop.area.AreaTreeHandler.endPageSequence(AreaTreeHandler.java:267)
    at org.apache.fop.fo.pagination.PageSequence.endOfNode(PageSequence.java:128)
    at org.apache.fop.fo.FOTreeBuilder$MainFOHandler.endElement(FOTreeBuilder.java:347)
    at org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:181)
    at net.sf.saxon.event.ContentHandlerProxy.endElement(ContentHandlerProxy.java:395)
    at net.sf.saxon.event.NamespaceReducer.endElement(NamespaceReducer.java:208)
    at net.sf.saxon.event.ComplexContentOutputter.endElement(ComplexContentOutputter.java:459)
    at net.sf.saxon.expr.instruct.ElementCreator.processLeavingTail(ElementCreator.java:304)
    at net.sf.saxon.expr.instruct.ElementCreator.processLeavingTail(ElementCreator.java:254)
    at net.sf.saxon.expr.instruct.Block.processLeavingTail(Block.java:615)
    at net.sf.saxon.expr.instruct.Instruction.process(Instruction.java:131)
    at net.sf.saxon.expr.instruct.ElementCreator.processLeavingTail(ElementCreator.java:301)
    at net.sf.saxon.expr.instruct.ElementCreator.processLeavingTail(ElementCreator.java:254)
    at net.sf.saxon.expr.instruct.Template.applyLeavingTail(Template.java:212)
    at net.sf.saxon.trans.Mode.applyTemplates(Mode.java:1034)
    at net.sf.saxon.Controller.transformDocument(Controller.java:1959)
    at net.sf.saxon.Controller.transform(Controller.java:1805)
    at cwc.fop.util.templates.FOPConvert.translate(FOPConvert.java:116)
    at cwc.fop.util.conversion.XML2PDF.translate(XML2PDF.java:151)
    at cwc.fop.util.conversion.XML2PDF.translate(XML2PDF.java:114)
    at cwc.fop.util.conversion.XML2PDF.translate(XML2PDF.java:65)
    at cwc.fop.server.work.WorkerRunnable.run(WorkerRunnable.java:144)
    at cwc.util.threading.WorkQueue$PoolWorker.run(WorkQueue.java:59) 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T07:07:26.917

您正在使用 xmlns:qr="http://hobbut.ru/fop/qr-code/" 这与 Barcode4J 无关。似乎您计划使用除 Barcode4J 之外的其他 FOP 插件，但您最终将 Barcode4J 放置在类路径中，而不是正确的插件。顺便说一句，Barcode4J 在其 CVS 存储库的 HEAD 分支中集成了 ZXing 用于 QR 码生产。

# cocoa - 使用 CGWindowListCopyWindowInfo 是否可以计算出鼠标指针在哪个窗口上方？

> ID：13292997
> 
> 赞同：1
> 
> 时间：2012-11-08T16:14:48.913
> 
> 标签：cocoa, core-graphics, nswindow, nsevent

使用 CGWindowListCopyWindowInfo 是否可以确定鼠标指针是否在列出的任何窗口上？

我遇到的问题是 CGWindowListCopyWindowInfo 提供的窗口边界是基于左上角的。但是像...

```
NSPoint mouseLoc = [NSEvent mouseLocation]; 
```

是基于左下角的原点。