# StackOverflow 问答 14199000-14199999

# windows-phone-7 - 在 Windows phone 7.1 中拖放图像

> ID：14199003
> 
> 赞同：1
> 
> 时间：2013-01-07T15:34:25.707
> 
> 标签：windows-phone-7, windows-phone-7.1

我想在 Windows phone 7.1 中创建一个应用程序，其中包含图像的 Scrollviewer 出现在水平行中，如果我们将图像拖动到其他图像的位置，则位置应该在图像之间改变，这样图像就不会相互碰撞。如何我可以在 WP7 中制作它吗？

# c - 避免 CUDA 字符串搜索中的分支分歧

> ID：14199006
> 
> 赞同：2
> 
> 时间：2013-01-07T15:34:41.453
> 
> 标签：c, search, cuda, gpu

我想知道如何避免在使用 CUDA 进行字符串搜索时出现分支分歧，以及是否有一个好的方法来做到这一点。

目前，我尝试将 Knuth Morris Pratt 应用于 GPU，但我相信存在很多分歧，因为每个线程都在寻找 N 个字母，并且每次都比较这些字母是否对应于我正在搜索的单词的第一个字母。

```
int tid = blockDim.x * blockIdx.x + threadIdx.x;
int startId = tid * 64;
int x = 0;
for(int i = 0; i < 64; i++){
    if(array[startId + i] == 'C'){
        x++;
    }
} 
```

如果我使用这个虚拟代码来查找字母“C”，但我也可以再次查看以搜索更多字母。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-30T16:52:55.537

您可以尝试将比较结果直接添加到值中，如下所示：

x+= (array[startId + i] == 'C');

但我相信这可能仍然存在分支。我的解决方案是将一个块中的数组值存储到共享内存中，然后为块中的每个线程分配一个所需的字符，并将结果放入它们自己的共享内存空间中，然后减少。

```
__shared__ char l_array[BLOCK_SIZE];
__shared__ char l_results[BLOCK_SIZE];

int bid = blockDim.x * blockIdx.x;
int lid = threadIdx.x;
int tid = bid + lid;
int x=0;

char desired_char = get_character(lid);

l_array[lid] = -1;

//Store global values in shared memory
if(tid < array_size){
    l_array[lid] = array[tid];       
}

__syncthreads();

//Check local memory for desired character
for(int i = 0; i < BLOCK_SIZE; i++)
   x+=(l_array[i] == desired_char);

//Store results into shared memory
l_results[lid] = x;

__syncthreads();
//Then reduce (poorly)
if(lid==0){
    for(int i = 0; i < BLOCK_SIZE; i++)
        x+= l_results[i];
} 
```

虽然我不知道算法本身，但我只是猜测，但这里的一些东西可能会帮助你弄清楚这一点。

# jquery - 使用 jQuery 向隐藏的输入字段添加值

> ID：14199013
> 
> 赞同：0
> 
> 时间：2013-01-07T15:35:05.900
> 
> 标签：jquery, html, forms

我正在动态添加输入字段，并且我想将输入字段的这些值的变体添加到隐藏的输入数组中，但我正在努力这样做。我在 html 页面中有一个隐藏的输入：

```
 <input type="hidden" name="center_ids[]" value=""/> 
```

我用来添加我想要的值的 jQuery 是从我的 AJAX 方法返回的值：

```
 $(".autocomp_centers").autocomplete({ 
        serviceUrl:'/suggest_centers',
            maxHeight:400,
            width:252,
            minChars:2,
            onSelect: function(value, data){ $("input[name='center_ids']").push(data) }
    }); 
```

但这不会添加到隐藏的输入字段。有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:38:44.953

小心你输入的名字。您的输入被命名`center_ids[]`而不是`center_ids`.

```
$(".autocomp_centers").autocomplete({ 
    serviceUrl:'/suggest_centers',
        maxHeight:400,
        width:252,
        minChars:2,
        onSelect: function(value, data){
            $("input[name='center_ids[]']").val(data);
        }
}); 
```

希望这能解决您的问题。

# php - 防止为启用了 javascript 的用户加载图像

> ID：14199015
> 
> 赞同：0
> 
> 时间：2013-01-07T15:35:09.187
> 
> 标签：php, javascript, jquery, ajax

我在这里让自己陷入了某种鸡蛋的境地。我有一个要加载很多图像的页面，我编写了滚动脚本的加载程序，就像 Facebook 或 Google 图片一样，所以当用户到达页面底部时，会加载下一组图像。

因为服务器端图像加载有点重，可能会减慢网站速度，我只是将所有图像加载并存储在缓存文件中，将其加载到页面中，然后使用 javascript，我删除所有图像，只保留前几个和然后逐渐加载其余部分。

现在我遇到的第一个问题是浏览器会继续加载图像，即使它们已被使用 javascript 删除。为了解决这个问题，我向我不想加载的图像添加了一个 css 类，并将它们设置为不显示，然后我使用 javascript 将其删除。

但我仍然不希望该页面成为非 JavaScript 用户和爬虫能够看到整个页面。并且无法找到一种方法来删除这个“不显示”没有 javascript。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:40:49.093

为什么不简单地使用 ajax 来加载下一批呢？这样它就会被加载到段中，负载被分散，你不需要做困难的标记......

我自己在这种情况下使用的 jquery 示例。我有一个 php 文件，它根据在我的 mysql 中翻译的“页码”决定需要渲染的内容`select ..... limit $pagenumber,15`

```
 <script type="text/javascript">
    alreadyloading = false;
    nextpage = 1;

    $(window).scroll(function() 
        {
        if ($('body').height() <= ($(window).height() + $(window).scrollTop())) 
            {
            if (alreadyloading == false) 
                {
                var url = document.location.href + "/ajaxload/" + (nextpage * 15);
                alreadyloading = true;
                $.ajax(url).done(function(data) 
                    {
                    obj = document.getElementById('images');
                    obj.innerHTML += data;
                    alreadyloading = false;
                    nextpage++;
                    });
                }
            }
        });
    </script> 
```

# sql - 了解 PARTITION BY 是否有更好的方法来获得相同的答案？

> ID：14199016
> 
> 赞同：0
> 
> 时间：2013-01-07T15:35:09.250
> 
> 标签：sql, oracle

我正在重建的查询中有以下片段：

```
LEFT JOIN (SELECT ACCOUNT_ID, LETTER_TYPE, LETTER_DATE, LETTER_ID
           FROM (SELECT T1.ACCOUNT_ID, T2.LETTER_TYPE, T1.LETTER_DATE, T1.LETTER_ID,
                 DENSE_RANK() OVER (PARTITION BY T1.ACCOUNT_ID, T2.LETTER_TYPE
                                    ORDER BY T1.LETTER_DATE DESC) AS RANK1
                 FROM tableOne T1
                 INNER JOIN tableTwo T2 ON T1.LETTER_ID = T2.LETTERID)
           WHERE RANK1 = 1) 
```

我还没有真正处理过`DENSE_RANK()`或`PARTITION BY`之前没有处理过，但根据我的研究，这个案例将转化为“按 ACCOUND_ID 和 LETTER_DATE 降序排列这组记录）然后外部 SELECT 只抓取 RANK = 1 的记录。所以它基本上是在尝试查找为每个帐户发送的最新 LETTER_ID。

我的问题是：**A.**那是准确的翻译吗？和**B.**有没有办法重写/重组这个查询，这样它就不必像这样嵌套？

我在**B.**中的意思是它首先返回所有 LETTER_ID，然后过滤为`WHERE RANK1 = 1`. 退回所有这些记录只是在之后立即丢弃它们似乎有点浪费

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:43:36.143

您可以将查询重写为如下所示：

```
LEFT JOIN (select t1.account_id, t2.letter_type, MAX(t1.letter_date) as MaxDate
           from tableOne t1 join tableTwo t2 on T1.LETTER_ID = T2.LETTERID
          ) maxt left outer join
          (select T1.ACCOUNT_ID, T2.LETTER_TYPE, T1.LETTER_DATE, T1.LETTER_ID
           from tableOne t1 join tableTwo t2 on T1.LETTER_ID = T2.LETTERID
          ) t
          on t.account_id = tmax.account_id and t.letter_type = tmax.letter_type and
             t.letter_date = tmax.maxdate 
```

但是，我建议您窗口/分析函数是对 SQL 的*非常*强大的补充，因此您应该学习如何使用它们。

不过，在这种情况下有一个问题。如果最近的 letter_date 上有多个字母，那么您的查询（以及这个也是）将返回所有字母。也许您的意图是只返回其中一个。在这种情况下，您可以使用`row_number()`而不是`dense_rank()`.

# java - replaceAll 的问题（我想删除所有出现的 [*]）

> ID：14199018
> 
> 赞同：1
> 
> 时间：2013-01-07T15:35:10.950
> 
> 标签：java, regex, replace

我有一段文字，其中包含 [1]、[2]、[3] 等字词...

> 例如：收藏永久[1] 收藏品和临时[2] 当代艺术和摄影展览。[6]

我想删除这些单词，所以字符串必须是这样的：

> 例如：收藏当代艺术和摄影的永久收藏品和临时展览。

我尝试使用：`s = s.replaceAll("[.*]", "");`但它只是从文本中删除点（。）。

实现它的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T15:36:31.200

这是因为`[`和`]`是正则表达式标记。这应该有效：

```
s = s.replaceAll("\\[\\d+\\]",""); 
```

（假设您总是在 内有数字`[]`）。

如果它可以是任何字符：

```
s = s.replaceAll("\\[.*?\\]",""); 
```

（感谢@PeterLawrey）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T15:36:33.363

利用：

```
s.replaceAll("\\[[^]]+\\]", "") 
```

`[`并且`]`在正则表达式中是特殊的并且是字符类的分隔符，您需要将它们转义。你原来的正则表达式是一个寻找点或星的字符类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T15:44:02.890

第 1 步：获得更好（更安全）的模式。您当前的字符串可能会删除您的大部分字符串，即使您确实让它按书面形式工作。目标尽可能具体。这个应该做（只匹配它们之间有数字的括号）。

```
[\d+] 
```

第 2 步：转义特殊的正则表达式字符。`[]`在正则表达式语法（字符类）中具有特殊含义，因此它们需要转义。

```
\[\d+\] 
```

第 3 步：转义字符串文字。`\`在字符串文字（转义字符）中具有特殊含义，因此它们也需要转义。

```
"\\[\\d+\\]" 
```

现在我们应该有一些运行良好的代码。

```
s = s.replaceAll("\\[\\d+\\]", ""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T15:50:12.830

尝试：

```
public class StringTest {

    public static void main(String args[]){
        String str = "houses both permanent[1] collections and temporary[2] exhibitions of contemporary art and photography.[6]";
        String patten = str.replaceAll("\\[[0-9]*]", "");

        System.out.println(patten);
    }
} 
```

输出：

收藏了当代艺术和摄影的永久收藏品和临时展览。

# wpf - TargetUpdated 事件上的动画 DataGrid 单元格背景

> ID：14199022
> 
> 赞同：2
> 
> 时间：2013-01-07T15:35:23.010
> 
> 标签：wpf, binding, datagrid

我一直在寻找解决方案，但没有找到任何可行的方法。

问题很简单：

*   DataGrid（只读）绑定到对象集合（实现 INotifyPropertyChanged）
*   当数据对象的某些属性发生变化时，单元格背景应该动画（例如，从红色到透明）

我尝试使用带有 EventTrigger (TargetUpdated) 的样式来启动 Storyboard，但它有副作用，当 DataGrid 首次填充时以及滚动或重新排序时，所有单元格的背景都是动画的。

我知道几乎没有其他类似的问题，但我没有看到有效的解决方案。
有没有人能够做到这一点？我非常希望没有任何代码隐藏，但如果有必要，我会忍受它......

编辑：
我注意到我想要实现
的目标有些混乱：假设一个单元格（它是数据对象的基础属性）的值“A”。在某些时候它变为“B”（例如从服务器更新）。此时背景应该“闪烁”（例如，从红色到透明的 1 秒动画）。在所有其他时间，背景应该是透明的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T09:55:51.560

我终于在 MS 论坛上指出了正确的方向，解决方案是使用注册 OnTargetUpdated 处理程序并启动故事板的附加行为。我之前尝试过这种方法，但显然只有在单元格的 IsLoaded 属性为真时才必须启动情节提要。这消除了我上面提到的副作用。

这是[论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/81bb60bc-ade3-4f5e-b39f-e0a5451ffee8)的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T15:47:49.537

添加一个转换器是这样的：

```
namespace System.Converters
{
//Converter for cell animation 
  public  class flashConverter : IValueConverter
  {
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        string cellvalue = value.ToString();
        return cellvalue = ("place the condition here");
    }
    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return false;
    }
} 
```

在你的 MainWindow.xaml.cs 添加命名空间

```
 xmlns:loc="clr-namespace:YourProjectName.Converters" 
```

在您的资源中添加以下内容：

```
 <DataGrid.Resources>
          <loc:flashConverter x:Key="SomeConverter"></loc:flashConverter>
         </DataGrid.Resources> 
```

在您的 DatagridTextColumn 添加以下内容：

```
 <DataGridTextColumn Header="yourDatagridHeader"  IsReadOnly="True" Binding="{Binding Path=yourDatagridHeader}">
             <DataGridTextColumn.ElementStyle>
        <!--Style to implement the datagrid cell animation for yourDatagridcell-->
            <Style TargetType="{x:Type TextBlock}">
             <Style.Triggers>
             <DataTrigger Binding="{Binding yourDatagridHeader}" Value="Give your condition here">
            <!-#E6F85050 is the hexadecimal value for RED-->
             <Setter Property="Background" Value="#E6F85050"/>
             </DataTrigger>
             <DataTrigger Binding="{Binding yourDatagridHeader}" Value="Give your condition here">
             <Setter Property="Background" Value="give the hexadecimal value for transparent here "/>
              </DataTrigger>
           </Style.Triggers>
            </Style>
        </DataGridTextColumn.ElementStyle>
      </DataGridTextColumn> 
```

希望这可以帮助 ！

# javascript - 如何在来自 JSON 的 AJAX foreach 返回调用中引入延迟和淡入淡出

> ID：14199023
> 
> 赞同：2
> 
> 时间：2013-01-07T15:35:25.333
> 
> 标签：javascript, jquery, ajax

我将如何在每个项目和每个项目之间有一个延迟的情况下迭代以下 foreach ？

我不确定 .append() 是最好的函数，因为我想要实现的是为 json 中的每个人加载一个带有类 #fan 的模板化 div，如下所示：

```
[{"first_name":"adf","location":"agd","image_path":""},{"first_name":"test","location":"test","image_path":""},{"first_name":"chris","location":"london","image_path":""}] 
```

到目前为止，这是我的 ajax 调用代码。

```
function get_fans(){

$.ajax('http://localhost/facebook_app/selectFans/', {
    type : 'get',
    dataType: 'json',
    success : function (data) {
        $.each(data, function(index) {
           $('section#fans').append('<div class="fan">' + data[index].first_name + ', ' + data[index].location +'</div>');
        }); 
    },
    error: function () {
        $('section#fans').text('Could not load fans.');
    }
});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:39:34.183

这应该工作：

```
$.each(data, function(index) {
     setTimeout(function(){
           var d = $('<div class="fan">' + data[index].first_name + ', ' + data[index].location +'</div>');
           $('section#fans').append(d);
           d.hide();
           d.fadeIn();
     }, 1000*(index +1));
}); 
```

# python - Django没有分配任何主键

> ID：14199036
> 
> 赞同：0
> 
> 时间：2013-01-07T15:36:04.880
> 
> 标签：python, django

保存我的表时，Django 似乎没有分配任何主键？我错过了什么？

```
class Campaign(models.Model):
    campaignid = models.CharField(max_length=255, primary_key=True, db_column='campaignID')
    name = models.CharField(max_length=105)
    active = HibernateBooleanField(default=False)
    created = models.DateTimeField()
    modified = models.DateTimeField(null=True, blank=True)
    companyid = models.ForeignKey(Company, null=True, db_column='companyID', blank=True)

    class Meta:
        db_table = u'campaign'

    def __unicode__(self):
        return self.name 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:58:17.413

好的，因为我的模型是使用 guid 从现有表生成的，所以我必须将其保留为 CharField 添加这似乎可行：

```
def save(self, *args, **kwargs):
        if not self.campaignid:
            self.campaignid = hashlib.sha1(str(random.random())).hexdigest()
        super(Campaign, self).save(*args, **kwargs) 
```

# c++ - 为什么变量的值是输出0？

> ID：14199040
> 
> 赞同：-3
> 
> 时间：2013-01-07T15:36:16.503
> 
> 标签：c++, types, int, long-integer

> **可能重复：**
> [使用 printf 函数](https://stackoverflow.com/questions/7783159/using-printf-function)

```
#include<iostream>
using namespace std;
int main()
{
    long long a=20;
    long long b=21;
    printf("%d %d",a,b);
} 
```

输出：20 0

谁能解释一下这种行为？[编辑] 我知道 %d 不是打印 long long 的正确方法但是发布这个问题的主要目的是我想知道 long long 的行为，以便它为 b 打印 0 而为 a 打印正确的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:38:29.077

学究式地说，您的代码调用了未定义的行为，因为您提供了不正确的格式说明符。您应该使用`%lld`而不是`%d`.

当它是未定义的行为时，您无法真正推理出它为什么会这样。您可能会对此输入进行推理，但是对于另一组输入可能会失败。因为它是未定义的。或者您可以查看文档，它*可能会*说明一些内容，但*不需要*说明为什么要打印`0`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T15:45:45.097

在你的机器上看起来`long long`是 64 位类型，而`int`32 位类型。您还必须使用 little-endian 机器。

因为`printf`它是一个可变参数函数，所以它可以知道您传递给它的类型的唯一方法是通过您如何标记格式字符串中的参数。根据您的格式字符串，您正在发送两个 64 位参数，但仅使用两个 32 位参数。这意味着第一个打印是 64-bit 的低 32 位“下半部分”，`20`第二个打印是 32 位“上半部分”（当然是`0`）。你通过的`21`完全被忽略了。

# bash - bash：从文本文件中搜索相似的词

> ID：14199041
> 
> 赞同：1
> 
> 时间：2013-01-07T15:36:24.960
> 
> 标签：bash, awk, grep

我有一个`abc.txt`包含一些值的示例文本文件：

```
Harry Potter - A:JK:1:1:1
Harry Potter - B:JK:1:1:1
Hairy Potter - C:Harry:1:1:1 
```

是值之间的`:`分隔符。目前，我正在尝试`grep`相似的值并与第一列进行比较并打印出这些行。

```
grep -i "harry" BookDB.txt | awk -F ':' '{print $0}' 
```

它产生：

```
Harry Potter - A:JK:1:1:1
Harry Potter - B:JK:1:1:1
Hairy Potter - C:Harry:1:1:1 
```

但是，我想要达到的结果是：

```
Harry Potter - A:JK:1:1:1
Harry Potter - B:JK:1:1:1 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:57:06.407

所做`awk -F ':' '{print $0}'`的只是打印每一行，在您的示例中它什么也不做。

如果你想这样做，`awk`它将是：

```
$ awk -F: '$1~/Harry/' file
Harry Potter - A:JK:1:1:1
Harry Potter - B:JK:1:1:1

# Case insensitive 
$ awk -F: 'tolower($1)~/harry/' file
Harry Potter - A:JK:1:1:1
Harry Potter - B:JK:1:1:1 
```

这仅在第一个字段`$1`匹配`/Harry/`时打印该行，不区分大小写的版本将第一个字段转换为所有小写字符并检查`/harry/`。

如果您知道情况总是如此，您可以锚定`harry`到行首吗？`^`

```
$ grep -i "^harry" file
Harry Potter - A:JK:1:1:1
Harry Potter - B:JK:1:1:1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T15:43:07.723

所以你希望它只在第一次出现“：”分隔符之前在行的第一部分进行grep？

假设您确定文件中没有“％”：1）您将“：”的第一次（也是第一次）出现替换为未使用的字符（％或其他），并在此之前显示您可以使用字符串的行%

```
sed -e 's/:/%/' < BookDB.txt | grep -i '^[^%]*harry[^%]*%' 
```

或者如果所有行都包含“ - ”：将其简化为：

```
sed -e 's/:/%/' < BookDB.txt | grep -i '^[^%]*harry' 
```

并添加到这个

```
| sed -e 's/%/:/' # to restore the original line 
```

在上面，您可以将“:”替换为例如“-”（多字符分隔符），它仍然可以使用。

如果您真的需要在第一次出现单个字符之前找到一些东西，您可以进一步简化（但它不太灵活）：

```
grep -i '^[^:]*harry[^:]*:' 
```

或者

```
grep -i '^[^:]*harry' 
```

（仅当所有行的格式与您需要匹配的行的格式相似时才应该使用第二个）

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-07T15:41:51.140

如果您只是`Harry`在第一个参数中查找，则下面的命令可以解决问题

`grep -i "harry " BookDB.txt | awk -F ':' '{print $0}'`

但是，如果您需要完整的书名，则必须编写一个 bash 脚本，该脚本将提取书名并将其与您的输入进行比较。

# xslt - XSLT 计数包含小于另一个日期的日期的元素

> ID：14199042
> 
> 赞同：1
> 
> 时间：2013-01-07T15:36:25.207
> 
> 标签：xslt

我正在尝试从一个 xml 文件生成一个 .csv，该文件包含“OtherEmployees”的计数，其出生日期早于某个日期（例如 1970 年 1 月 1 日），但我不确定语法。

请注意，日期当前为 dd/mm/yyyy 格式。

这是 xml 的一个示例 -

```
<Companies>
<Company>
    <CompanyReference>00000060</CompanyReference>
    <Contact>
        <PersonID>63</PersonID>
        <Title>Mrs</Title>
        <Forename>EXAMPLE</Forename>
        <Middlename/>
        <Surname>NAME</Surname>
        <DOB>27/05/1928</DOB>
    </Contact>
    <OtherEmployees>
        <OtherEmployee>
            <PersonID>28870</PersonID>
            <Title>Miss</Title>
            <Forename>EXAMPLE</Forename>
            <Middlename/>
            <Surname>NAME2</Surname>
            <DOB>03/05/1953</DOB>
        </OtherEmployee>
        <OtherEmployee>
            <PersonID>28871</PersonID>
            <Title>Miss</Title>
            <Forename>EXAMPLE</Forename>
            <Middlename/>
            <Surname>NAME3</Surname>
            <DOB>11/07/1961</DOB>
        </OtherEmployee>
    </OtherEmployees>
</Company> 
```

我能够通过以下方式获得出生日期的 OtherEmployees 的计数 -

```
<xsl:value-of select="count(OtherEmployees/OtherEmployee[DOB])"/> 
```

但是，我现在需要将 DOB 与另一个日期进行比较 - 比如说 01/01/1970，并且如果他们的出生日期早于 1970 年 1 月 1 日，则仅返回计数中的 OtherEmployee。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:50:48.457

使用 XSLT 2.0，您可以使用 xs:date 数据类型，例如

```
<xsl:value-of select="count(OtherEmployees/OtherEmployee[DOB and xs:date(concat(substring(DOB, 7), '-', substring(DOB, 4, 2), '-', substring(DOB, 1, 2))) lt xs:date('1970-01-01')])"/> 
```

使用 XSLT 1.0，您可以轻松地将数据格式转换`dd/mm/yyyy`为数字`yyyymmdd`并进行比较：

```
<xsl:value-of select="count(OtherEmployees/OtherEmployee[DOB and number(concat(substring(DOB, 7), substring(DOB, 4, 2), substring(DOB, 1, 2))) &lt; 19700101])"/> 
```

# node.js - 出现错误时，Mongoose 仍会保存文档

> ID：14199044
> 
> 赞同：0
> 
> 时间：2013-01-07T15:36:29.347
> 
> 标签：node.js, mongodb, mongoose

我在保存文档时定义了一个预保存方法，如下所示：

```
Org.pre("save",function(next, done) {
  var Currency = require('./currency');

  var cur = this.get('currency');
  console.log("checking currency: " + cur);

  Currency
    .findOne({name: cur})
    .select('-_id name')
    .exec(function (err, currency) {
      if (err) done(err);
      if (!currency) done(new Error("The currency you selected ('" + currency + "') is not supported.  Please select one from /currencies"));
      next();
    });
}); 
```

此方法检查货币集合以查看是否支持货币字段输入。在测试我的 API 时，我得到了返回的相应错误（消息中出现 500 错误：您选择的货币...），但该文档仍保存在 MongoDB 中。我希望在发送错误时不应保存文档。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:04:41.857

您仍在调用`next();`错误情况，因此请尝试将该部分重写为：

```
Currency
  .findOne({name: cur})
  .select('-_id name')
  .exec(function (err, currency) {
    if (err) return done(err);
    if (!currency) return done(new Error("The currency you selected ('" + currency + "') is not supported.  Please select one from /currencies"));
    next();
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:04:22.763

似乎通过不将 next() 放在括号中，流程继续。为了使它起作用，我按如下方式更改了 exec 函数：

```
 if (err) {
    done(err);
  } else if (!currency) {
    done(new Error("The currency you selected ('" + currency + "') is not supported.  Please select one from /currencies"));
  } else {
    next();
  } 
```

问题解决了。

# c# - 使用 Sort 的 CollectionViewSource 获取已排序的项目

> ID：14199049
> 
> 赞同：3
> 
> 时间：2013-01-07T15:36:33.757
> 
> 标签：c#, wpf, collectionviewsource

我有一个带有自定义排序`datagrid`的源`CollectionViewSource`，我需要获取已排序的项目集合，如数据网格中所示。我可以获得排序的描述和排序源集合，但我需要这个集合很多次。

有什么方法可以获取启用索引的排序集合（`item[index])`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:53:53.553

CollectionViewSource 的[View](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.view.aspx)属性返回一个排序的 ICollectionView。由于这是一个 IEnumerable，您可以使用 Linq 从中创建一个 List，可以通过索引访问：

```
// using System.Linq;

var list = collectionView.View.Cast<object>().ToList();
var firstItem = list[0]; 
```

# android - ProgressDialog 在长时间计算时无法正常工作

> ID：14199050
> 
> 赞同：1
> 
> 时间：2013-01-07T15:36:34.943
> 
> 标签：android, android-asynctask, progressdialog

我已经尝试了很多方法来让这个 ProgressDialog 正常工作，但我仍然没有 100% 得到它。我基本上已经走到了两个独立的死胡同，同样接近最终目标。

首先，我尝试创建一个额外的`Thread`并使用`runOnUiThread`. 这会导致对话框`showing`和`dismissing`我想要的正确时间，但微调器不旋转。它静止不动，从不调整。

```
readButton = (Button) findViewById( R.id.readButton );
    readButton.setOnClickListener( new OnClickListener() {
        public void onClick(View arg0) {

            final ProgressDialog pd = new ProgressDialog( Waves.this );  
            pd.setProgressStyle(ProgressDialog.STYLE_SPINNER);
            pd.setMessage("Reading...");
            pd.setCancelable(false);            
            pd.show( );

            Thread export = new Thread() {  
                 public void run() {
                        if( myService.getState() != 3 ) {
                            runOnUiThread( new Runnable() {
                                public void run() {
                                    Log.i( "myService", "12222" ); 
                                    myService.setHandler( mHandler );
                                    myService.connect( MainMenu.previousDevice, true );
                                }
                            });
                        } else {
                            runOnUiThread(new Runnable() {
                                public void run() {
                                    readWaves();
                                }
                            });
                        }
                 mHandler.obtainMessage(MainMenu.READ_FINISHED ).sendToTarget();
                 pd.dismiss();
                 }
            };
            export.start();
            }
    }); 
```

我尝试做的下一件事是使用`AsyncTask`. 从我在互联网上找到的所有内容来看，这看起来像是要走的路。微调器开始旋转，我的代码开始工作，但在很短的时间后，我的应用程序离开当前活动并完全重新启动。如下所示，`LogCat`但它没有显示任何错误。

```
 readButton = (Button) findViewById( R.id.readButton );
    readButton.setOnClickListener( new OnClickListener() {
        public void onClick(View arg0) {
            new readPage().execute( null, null, null );
            }
    });

 public class readPage extends AsyncTask<Void, Void, Void> {

        private ProgressDialog pdia;

        @Override
        protected void onPreExecute(){
            super.onPreExecute();
                pdia = new ProgressDialog( Waves.this);
                pdia.setMessage("Reading...");
                pdia.setCancelable( false );
                pdia.show();
            }

        @Override
        protected void onPostExecute(Void unused) {
            pdia.dismiss();
        }
        @Override
        protected Void doInBackground(Void... arg0) {
            // TODO Auto-generated method stub
            Log.i( "ASYNC", "2" );
            if( myService.getState() != 3 ) {
                myService.setHandler( mHandler );
                myService.connect( MainMenu.previousDevice, true );
            } else {
                readWaves();
            }
            return null;
        }
} 
```

这里是`LogCat`. 显示的第一行是`LogCat`我的代码中的最后一件事。我没有检查这一行发生了什么，因为它总是有效，只是没有`AsyncTask`实现。最后一行有一个`Main Menu ++ ON CREATE ++`条目，即我的应用程序重新启动时。

```
01-07 18:23:27.738: W/NATIVE CODE(28111): After SetBaud
01-07 18:23:29.777: I/dalvikvm(28111): threadid=4: reacting to signal 3
01-07 18:23:30.781: W/dalvikvm(28111): threadid=4: spin on suspend #1 threadid=9 (pcf=0)
01-07 18:23:30.781: D/dalvikvm(28111): Temporarily moving tid 28128 to fg (was 0)
01-07 18:23:30.781: D/dalvikvm(28111): Temporarily raised priority on tid 28128 (10 -> 0)
01-07 18:23:31.527: W/dalvikvm(28111): threadid=4: spin on suspend #2 threadid=9 (pcf=3)
01-07 18:23:31.531: I/dalvikvm(28111): "Signal Catcher" daemon prio=5 tid=4 RUNNABLE
01-07 18:23:31.531: I/dalvikvm(28111):   | group="system" sCount=0 dsCount=0 obj=0x4050f730 self=0x117d60
01-07 18:23:31.531: I/dalvikvm(28111):   | sysTid=28114 nice=0 sched=0/0 cgrp=default handle=582800
01-07 18:23:31.531: I/dalvikvm(28111):   at dalvik.system.NativeStart.run(Native Method)
01-07 18:23:31.531: I/dalvikvm(28111): "AsyncTask #1" prio=5 tid=9 RUNNABLE
01-07 18:23:31.531: I/dalvikvm(28111):   | group="main" sCount=1 dsCount=0 obj=0x40559388 self=0x2e1a10
01-07 18:23:31.531: I/dalvikvm(28111):   | sysTid=28128 nice=0 sched=0/0 cgrp=default handle=3243272
01-07 18:23:31.925: I/dalvikvm(28111):   at my.eti.commander.RelayAPIModel$NativeCalls.GetWavesJava(Native Method)
01-07 18:23:31.933: I/dalvikvm(28111):   at my.eti.commander.Waves.readWaves(Waves.java:365)
01-07 18:23:31.937: I/dalvikvm(28111):   at my.eti.commander.Waves.access$0(Waves.java:350)
01-07 18:23:31.941: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:323)
01-07 18:23:31.945: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:1)
01-07 18:23:31.949: I/dalvikvm(28111):   at android.os.AsyncTask$2.call(AsyncTask.java:185)
01-07 18:23:31.957: I/dalvikvm(28111):   at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
01-07 18:23:31.960: I/dalvikvm(28111):   at java.util.concurrent.FutureTask.run(FutureTask.java:138)
01-07 18:23:31.964: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
01-07 18:23:31.968: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
01-07 18:23:31.972: I/dalvikvm(28111):   at java.lang.Thread.run(Thread.java:1019)
01-07 18:23:32.734: W/dalvikvm(28111): threadid=4: spin on suspend #3 threadid=9 (pcf=3)
01-07 18:23:32.734: I/dalvikvm(28111): "Signal Catcher" daemon prio=5 tid=4 RUNNABLE
01-07 18:23:32.734: I/dalvikvm(28111):   | group="system" sCount=0 dsCount=0 obj=0x4050f730 self=0x117d60
01-07 18:23:32.734: I/dalvikvm(28111):   | sysTid=28114 nice=0 sched=0/0 cgrp=default handle=582800
01-07 18:23:32.734: I/dalvikvm(28111):   at dalvik.system.NativeStart.run(Native Method)
01-07 18:23:32.734: I/dalvikvm(28111): "AsyncTask #1" prio=5 tid=9 RUNNABLE
01-07 18:23:32.734: I/dalvikvm(28111):   | group="main" sCount=1 dsCount=0 obj=0x40559388 self=0x2e1a10
01-07 18:23:32.734: I/dalvikvm(28111):   | sysTid=28128 nice=0 sched=0/0 cgrp=default handle=3243272
01-07 18:23:32.859: I/dalvikvm(28111):   at my.eti.commander.RelayAPIModel$NativeCalls.GetWavesJava(Native Method)
01-07 18:23:32.859: I/dalvikvm(28111):   at my.eti.commander.Waves.readWaves(Waves.java:365)
01-07 18:23:32.859: I/dalvikvm(28111):   at my.eti.commander.Waves.access$0(Waves.java:350)
01-07 18:23:32.859: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:323)
01-07 18:23:32.859: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:1)
01-07 18:23:32.859: I/dalvikvm(28111):   at android.os.AsyncTask$2.call(AsyncTask.java:185)
01-07 18:23:32.859: I/dalvikvm(28111):   at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
01-07 18:23:32.859: I/dalvikvm(28111):   at java.util.concurrent.FutureTask.run(FutureTask.java:138)
01-07 18:23:32.859: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
01-07 18:23:32.859: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
01-07 18:23:32.863: I/dalvikvm(28111):   at java.lang.Thread.run(Thread.java:1019)
01-07 18:23:33.613: W/dalvikvm(28111): threadid=4: spin on suspend #4 threadid=9 (pcf=3)
01-07 18:23:33.613: I/dalvikvm(28111): "Signal Catcher" daemon prio=5 tid=4 RUNNABLE
01-07 18:23:33.613: I/dalvikvm(28111):   | group="system" sCount=0 dsCount=0 obj=0x4050f730 self=0x117d60
01-07 18:23:33.613: I/dalvikvm(28111):   | sysTid=28114 nice=0 sched=0/0 cgrp=default handle=582800
01-07 18:23:33.613: I/dalvikvm(28111):   at dalvik.system.NativeStart.run(Native Method)
01-07 18:23:33.613: I/dalvikvm(28111): "AsyncTask #1" prio=5 tid=9 RUNNABLE
01-07 18:23:33.617: I/dalvikvm(28111):   | group="main" sCount=1 dsCount=0 obj=0x40559388 self=0x2e1a10
01-07 18:23:33.617: I/dalvikvm(28111):   | sysTid=28128 nice=0 sched=0/0 cgrp=default handle=3243272
01-07 18:23:33.617: I/dalvikvm(28111):   at my.eti.commander.RelayAPIModel$NativeCalls.GetWavesJava(Native Method)
01-07 18:23:33.617: I/dalvikvm(28111):   at my.eti.commander.Waves.readWaves(Waves.java:365)
01-07 18:23:33.617: I/dalvikvm(28111):   at my.eti.commander.Waves.access$0(Waves.java:350)
01-07 18:23:33.617: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:323)
01-07 18:23:33.617: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:1)
01-07 18:23:33.617: I/dalvikvm(28111):   at android.os.AsyncTask$2.call(AsyncTask.java:185)
01-07 18:23:33.617: I/dalvikvm(28111):   at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
01-07 18:23:33.617: I/dalvikvm(28111):   at java.util.concurrent.FutureTask.run(FutureTask.java:138)
01-07 18:23:33.617: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
01-07 18:23:33.617: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
01-07 18:23:33.617: I/dalvikvm(28111):   at java.lang.Thread.run(Thread.java:1019)
01-07 18:23:34.367: W/dalvikvm(28111): threadid=4: spin on suspend #5 threadid=9 (pcf=3)
01-07 18:23:34.367: I/dalvikvm(28111): "Signal Catcher" daemon prio=5 tid=4 RUNNABLE
01-07 18:23:34.367: I/dalvikvm(28111):   | group="system" sCount=0 dsCount=0 obj=0x4050f730 self=0x117d60
01-07 18:23:34.367: I/dalvikvm(28111):   | sysTid=28114 nice=0 sched=0/0 cgrp=default handle=582800
01-07 18:23:34.371: I/dalvikvm(28111):   at dalvik.system.NativeStart.run(Native Method)
01-07 18:23:34.371: I/dalvikvm(28111): "AsyncTask #1" prio=5 tid=9 RUNNABLE
01-07 18:23:34.371: I/dalvikvm(28111):   | group="main" sCount=1 dsCount=0 obj=0x40559388 self=0x2e1a10
01-07 18:23:34.371: I/dalvikvm(28111):   | sysTid=28128 nice=0 sched=0/0 cgrp=default handle=3243272
01-07 18:23:34.371: I/dalvikvm(28111):   at my.eti.commander.RelayAPIModel$NativeCalls.GetWavesJava(Native Method)
01-07 18:23:34.371: I/dalvikvm(28111):   at my.eti.commander.Waves.readWaves(Waves.java:365)
01-07 18:23:34.371: I/dalvikvm(28111):   at my.eti.commander.Waves.access$0(Waves.java:350)
01-07 18:23:34.371: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:323)
01-07 18:23:34.371: I/dalvikvm(28111):   at my.eti.commander.Waves$readPage.doInBackground(Waves.java:1)
01-07 18:23:34.371: I/dalvikvm(28111):   at android.os.AsyncTask$2.call(AsyncTask.java:185)
01-07 18:23:34.371: I/dalvikvm(28111):   at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
01-07 18:23:34.371: I/dalvikvm(28111):   at java.util.concurrent.FutureTask.run(FutureTask.java:138)
01-07 18:23:34.371: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
01-07 18:23:34.371: I/dalvikvm(28111):   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
01-07 18:23:34.371: I/dalvikvm(28111):   at java.lang.Thread.run(Thread.java:1019)
01-07 18:23:35.253: E/MainMenu(28151): +++ ON CREATE +++ 
```

**编辑：**

我还想补充一下，我尝试过使用`.hide()`而不是`.dismiss()`，但我认为这不是问题所在。`ProgressDialog`每次使用它时，我都会创建一个新实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:18:48.127

使用 AsyncTask 在后台运行您的长期计算过程。您可以在 上显示您的进度对话框`OnPreExecute()`。计算完成后，此异步方法将调用`onPostExecute()`您可以取消进度对话框的位置。你计算编码进去`doInBackground()`。

```
public class LongCaluclation extends AsyncTask<Void, Void, Void>
{  
@Override
protected void onPreExecute()
{  
    super.onPreExecute();
    dialog.setMessage("Calculation in progress please wait...");
    dialog.setCancelable(false);
    dialog.show();

} 
@Override 
protected void onProgressUpdate(Void... values) {
    super.onProgressUpdate(values);
    // Things to be done while execution of long running operation is in progress. For example updating ProgessDialog
 }

@Override 
protected void onPostExecute(Void result)

{ 
      //Post Execute
       dialog.cancel();
}
@Override
protected Void doInBackground(Void... params) {

  // Your operation..Dont Edit Any Views here

    return null;
}
} 
```

# sockets - 如何通过 UDP 通告 TCP 主机？

> ID：14199053
> 
> 赞同：0
> 
> 时间：2013-01-07T15:36:38.780
> 
> 标签：sockets, networking, tcp, udp

我有一个应用程序（本质上是一个游戏），它通过 UDP 将游戏状态数据广播到专用 LAN 上的许多连接的客户端。

UDP 适用于广播游戏状态。不必配置客户端对于此应用程序很重要。客户端只是读取 UDP 数据报流并在它进行时建立状态。

但现在我需要客户端从服务器可靠地下载几块大数据有效负载。TCP 比 UDP 要好得多。

但是我们仍然不必为每个客户端配置主机信息。最好在广播 UDP 流中嵌入服务广告，然后让每个客户端看到广告并连接到 TCP 主机，而无需在端点上进行额外配置。

是否有通过 UDP 广告 TCP 服务的标准方法或更好的示例代码。最好在 C++ 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:16:34.827

客户端需要知道 TCP 服务器的 IP 和端口，仅此而已。如果您可以将该信息嵌入到您的协议中，它将起作用。

实际上，UDP 客户端可能已经知道 IP，因为 UDP 数据包有一个发送方 IP。也许这个事实可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:53:44.663

这里的一个选项（可能不仅仅是游戏，而是一些“企业”服务）是[**`SRV`**](http://en.wikipedia.org/wiki/SRV_record)在本地 DNS 中设置记录。

# asp.net-mvc-3 - MVC3 通过 TFS 构建代理部署到 bin 而不是 MVC4

> ID：14199054
> 
> 赞同：1
> 
> 时间：2013-01-07T15:36:40.703
> 
> 标签：asp.net-mvc-3, tfs, asp.net-mvc-4, tfsbuild

本地构建工作正常。一个构建服务器工作正常（不使用 TFS 构建）。

问题是 TFS 构建打包了 MVC3 二进制文件，而不是所需的 MVC4。

`SERVER 1`：我们的 TFS 服务器只安装了 MVC4（尽管我不相信这是必需的）。

`SERVER 2`：我们的 TFS 构建控制器只安装了 MVC4。（构建代理在同一台服务器上）。

注意：之前都`SERVER 1`安装`2`过 MVC3。

我排队一个新的构建，转到`SERVER 2`（构建控制器服务器），我看到代理正在工作（TFS 管理控制台）并创建了它的工作目录。

然而，工作目录最终包含 MVC3 二进制文件！然后将其放置在托管服务器上的放置位置，然后使用 MVC3 错误地部署它。

来自“SERVER 2”命令行的 MSBuild 还将 MVC3 二进制文件添加到 bin 文件夹中。GAC 包含 MVC4 二进制文件。(C:\Windows\Microsoft.NET\assembly\GAC_MSIL\System.Web.Mvc\v4.0_4.0.0.0__31bf3856ad364e35)

该项目的web.config正确引用了MVC4，System.Web.Mvc( `v4.0.0.0`)设置为复制本地。我已经广泛检查了 MVC3 引用。我没有理由怀疑代码，因为它适用于我们的旧版构建服务器（安装了 MVC4）。

当然，这一切都可以在我的机器上运行，发布在 bin 文件夹中包含正确的 MVC.dll。

它可能从哪里获得 MVC3？我会错过什么？

**短期修复：在托管服务器上安装 MVC4。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T12:34:55.213

最后解决了这个问题，在包含的程序文件中有一个 Reference Assemblies 文件夹`system.web.mvc.dll`（版本 3）。我删除了它，一切正常！

简单地说：“.NET 4.0 版对框架引用程序集的完成方式进行了重大改变。”

这个问题的答案提供了有关此文件夹是什么以及为什么存在的更多详细信息：[Reference Assemblies folder and different assembly with the same version](https://stackoverflow.com/questions/9701135/reference-assemblies-folder-and-different-assemblies-with-the-same-version)。

# javascript - 当我加载我的 html 页面时，为什么我的外部 JavaScript 文件不起作用？

> ID：14199055
> 
> 赞同：1
> 
> 时间：2013-01-07T15:36:41.277
> 
> 标签：javascript, html, node.js

我分离了我的 html 和 JavaScript 代码。我将我的 JavaScript 代码放入一个单独的文件中，并使用“脚本”标签在我的 html 文件中引用它。我的 JavaScript 代码中有两个函数，一个用于创建自动填充，这意味着如果我开始在文本框中输入文本，该函数会为我提供一个可能的名称，我可能想在文本框下面写这个名称，另一个创建一个时钟给出当前时间。这里分别是我的 JavaScript 和 html 文件。你能告诉我问题是什么吗？

```
function Complete(obj, evt) {
    var names = new Array("albert","alessandro","chris");
    names.sort();

    if ((!obj) || (!evt) || (names.length == 0)) {
        return;
    }
    if (obj.value.length == 0) {
        return;
    }

    var elm = (obj.setSelectionRange) ? evt.which : evt.keyCode;

    if ((elm < 32) || (elm >= 33 && elm <= 46) || (elm >= 112 && elm <= 123)) {
        return;
    }

    var txt = obj.value.replace(/;/gi, ",");
    elm = txt.split(",");
    txt = elm.pop();
    txt = txt.replace(/^\s*/, "");

    if (txt.length == 0) {
        return;
    }

    if (obj.createTextRange) {
        var rng = document.selection.createRange();
        if (rng.parentElement() == obj) {
            elm = rng.text;
            var ini = obj.value.lastIndexOf(elm);
        }
    } else if (obj.setSelectionRange) {
        var ini = obj.selectionStart;
    }

    for (var i = 0; i < names.length; i++) {
        elm = names[i].toString();
        if (elm.toLowerCase().indexOf(txt.toLowerCase()) == 0) {
            obj.value += elm.substring(txt.length, elm.length);
            break;
        }
    }

    if (obj.createTextRange) {
        rng = obj.createTextRange();
        rng.moveStart("character", ini);
        rng.moveEnd("character", obj.value.length);
        rng.select();
    } else if (obj.setSelectionRange) {
        obj.setSelectionRange(ini, obj.value.length);
    }
}

function tick() {
    var hours, minutes, seconds, ap;
    var intHours, intMinutes, intSeconds;
    var today;

    today = new Date();

    intHours = today.getHours();
    intMinutes = today.getMinutes();
    intSeconds = today.getSeconds();

    switch(intHours){
        case 0: 
            intHours = 12;
            hours = intHours+":";
            ap = "A.M.";
            break;
        case 12:
            hours = intHours+":";
            ap = "P.M.";
            break;
        case 24:
            intHours = 12;
            hours = intHours + ":";
            ap = "A.M.";
            break;
        default: 
            if (intHours > 12) {
                intHours = intHours - 12;
                hours = intHours + ":";
                ap = "P.M.";
                break;
            }
        if(intHours < 12) {
            hours = intHours + ":";
            ap = "A.M.";
        }
    }

    if (intMinutes < 10) {
        minutes = "0"+intMinutes+":";
    } else {
        minutes = intMinutes+":";
    }
    if (intSeconds < 10) {
        seconds = "0"+intSeconds+" ";
    } else {
        seconds = intSeconds+" ";
    } 

    timeString = hours+minutes+seconds+ap;
    Clock.innerHTML = timeString;
    window.setTimeout("tick();", 100);
}
window.onload = tick; 
```

```
<HTML>
    <HEAD>
    <H1 STYLE="text-align:center;" STYLE="font-family:verdana;">FDM Markets</H1>
    <H2 STYLE="text-align:center;">Trading Platofrm</H2></br>

    <STYLE type="text/css">
        #p1 span {
            width: 65px;
            display: block;
            float: left;
        }
    </STYLE>

    <BODY>
        <SCRIPT type="text/javascript" src="jscodeloginpage.js"></SCRIPT>
        <p1>Login</p1></br>
        </br>
        <FORM name="anyForm">
            Username: <input type="text" name="anyName" size="15" onKeyUp="Complete(this, event)"></br>
            Password: <input type="text" size="15" name="password_box">
        </FORM>

        <div id=Clock style=font-size: 12">&nbsp;</div>
    </BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T07:47:13.350

好的，我将您的代码放入**[jsbin](http://jsbin.com/ehiyik/3/edit)**中。大多数问题都是在它的代码调试器/错误控制台的帮助下发现的。

您有一些超出范围的变量，这意味着：

```
if(x){
    var a = 1;
}
if(y){
    doSomethingWith(a);
    /* 
     * JavaScript can't access `a` here, since it was declared in the scope of the
     * previous `if`. That instance of `a` only exists within that first `if`.
     */
} 
```

您的's部分放错地方`break`了，还有其他一些小问题。`switch/case``default`

请参阅我链接到的**[jsbin](http://jsbin.com/ehiyik/3/edit)****以获取工作示例**。我还对您的 HTML 进行了一些修改。这一行：

```
<div id=Clock style=font-size: 12">&nbsp;</div> 
```

少了几个`"`：

```
<div id="Clock" style="font-size: 12">&nbsp;</div> 
```

此外，`</br>`这不是一个有效的标签，您可能正在寻找`<br />`

这是您编辑的 JS：

```
function Complete(obj, evt) {
    var names = new Array("albert","alessandro","chris");
    names.sort();

    var elm = (obj.setSelectionRange) ? evt.which : evt.keyCode;

    if (!obj ||
        !evt ||
        names.length === 0 ||
        obj.value.length === 0 ||
        elm < 32 ||
        (elm >= 33 && elm <= 46) ||
        (elm >= 112 && elm <= 123)) {
        return;
    }

    var txt = obj.value.replace(/;/gi, ",");
    elm = txt.split(",");
    txt = elm.pop();
    txt = txt.replace(/^\s*/, "");

    if (txt.length === 0) {
        return;
    }

    var ini, rng;
    if (obj.createTextRange) {
        rng = document.selection.createRange();
        if (rng.parentElement() == obj) {
            elm = rng.text;
            ini = obj.value.lastIndexOf(elm);
        }
    } else if (obj.setSelectionRange) {
        ini = obj.selectionStart;
    }

    for (var i = 0; i < names.length; i++) {
        elm = names[i].toString();
        if (elm.toLowerCase().indexOf(txt.toLowerCase()) === 0) {
            obj.value += elm.substring(txt.length, elm.length);
            break;
        }
    }

    if (obj.createTextRange) {
        rng = obj.createTextRange();
        rng.moveStart("character", ini);
        rng.moveEnd("character", obj.value.length);
        rng.select();
    } else if (obj.setSelectionRange) {
        obj.setSelectionRange(ini, obj.value.length);
    }
}

function tick() {
    var hours, minutes, seconds, ap;
    var intHours, intMinutes, intSeconds;
    var today;

    today = new Date();

    intHours = today.getHours();
    intMinutes = today.getMinutes();
    intSeconds = today.getSeconds();

    switch(intHours){
        case 0: 
            intHours = 12;
            hours = intHours+":";
            ap = "A.M.";
            break;
        case 12:
            hours = intHours+":";
            ap = "P.M.";
            break;
        case 24:
            intHours = 12;
            hours = intHours + ":";
            ap = "A.M.";
            break;
        default: 
            if (intHours > 12) {
                intHours = intHours - 12;
                hours = intHours + ":";
                ap = "P.M.";
            }
            if(intHours < 12) {
                hours = intHours + ":";
                ap = "A.M.";
            }
            break;
    }

    if (intMinutes < 10) {
        minutes = "0"+intMinutes+":";
    } else {
        minutes = intMinutes+":";
    }
    if (intSeconds < 10) {
        seconds = "0"+intSeconds+" ";
    } else {
        seconds = intSeconds+" ";
    } 

    timeString = hours+minutes+seconds+ap;
    Clock.innerHTML = timeString;
    window.setTimeout(tick, 100);
}
window.onload = tick; 
```

# jquery - jQuery改变和点击事件计时

> ID：14199056
> 
> 赞同：1
> 
> 时间：2013-01-07T15:36:45.573
> 
> 标签：jquery, events, timing

我的 jQuery 更改和单击事件似乎有时间问题。在我的站点中，我使用 Ajax 帖子而不是警报，但使用警报更容易重现它。我有一个使用 jQuery 版本 1.7.1 的简​​单 HTML 页面。

场景是编辑文本框，然后直接单击按钮。change 事件总是被触发，但如果它包含一个警报，则永远不会调用 click 事件。如果我作弊并在警报周围设置超时（您可能需要对那里的值进行一些调整），则通常会调用 click 事件。

/ **** EDIT **** / 如果您在更改事件中的某处设置断点并等待几秒钟，则单击事件也将无法触发。

```
<script type="text/javascript">
$(document).ready(function ()
{
    $("input[type=text]").change(function () {
        //alert('changed');

        $("#text").text('changed');

        setTimeout(function () {
            $("#text").text('changed timeout');
            alert('changed');
        }, 100);

    });

    $("input[type=submit]").click(function () {
        alert('clicked');
        $("#text").text('clicked');
    });
});
  </script>
  <div id="main">
    <div class="container">
        <input type="text" />
        <input type="submit" value="click me" />
        <div id="text" >bla</div>
    </div>
  </div> 
```

我的具有保存行为的 Ajax 调用如下：

```
$.ajax({
        type: 'POST',
        url: postUrl,
        data: form.serialize(),
        beforeSend: function () {
            // display overlay for work in progress
        },
        success: function (result) {
            updateTableSuccess();
        },
        complete: function () {
            // hide overlay for work in progress
        },
        error: function (jqXHR) {
            if (jqXHR.responseText.length > 0) {
                showErrorMessage(jqXHR.responseText);
            }
        }
    }); 
```

覆盖只是将 2 个 div 附加到 body 标签。

/ **** 编辑 **** / 似乎覆盖是真正的问题，并导致与警报相同的行为并停止触发点击事件。

```
showWorkInProgress = function (message, elementId)
{
    if ($("#overlay").length == 0)
    {
        $("<div id='overlay' class='ui-widget-overlay'></div>").appendTo("body");
    }

    if ($("#workInProgress").length == 0)
    {
        $("<div id='workInProgress'></div>").appendTo("body");
    }

    $("#workInProgress").html(message);
    if (elementId != null)
    {
        $("#workInProgress").center(elementId);
    }
    else
    {
        $("#workInProgress").center();
    }
    $("#overlay").show();
    $("#workInProgress").show();
}; 
```

谁能解释为什么 jQuery 会这样，以及我如何在没有 setTimeout hack 的情况下做得更好？

感谢您的帮助 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:20:50.387

如果其他人有同样的问题，只是一个简短的回答：问题确实是覆盖整个页面的覆盖，这会导致与警报相同的行为。

我对此的解释是，更改事件被触发，阻止 UI 并且 click 事件不能再被触发，因为[https://stackoverflow.com/users/1861269/john-gerdsen](https://stackoverflow.com/users/1861269/john-gerdsen)所建议的那样。

我为这个问题找到的唯一解决方案是使覆盖层更小，并仅阻止真正需要阻止的部分。超时也有效，但并非在所有情况下都有效，因为每台机器都有不同的性能。

这可能会帮助任何尝试解决覆盖问题的人： [HTML“覆盖”，它允许点击落入其后面的元素](https://stackoverflow.com/questions/1401658/html-overlay-which-allows-clicks-to-fall-through-to-elements-behind-it)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:49:15.743

`AJAX`Nischo，将您的代码插入`change`函数时，我无法复制阻塞。如果您希望在提交`AJAX`时阻止 if 执行，`click`请查看此处。

[jQuery - 如何在事件触发后暂时禁用 onclick 事件侦听器？](https://stackoverflow.com/questions/1921855/jquery-how-can-i-temporarily-disable-the-onclick-event-listener-after-the-even)

祝你好运。

* * *

在您的解释之后，我确实看到了您所指的内容，因为该`change`事件需要失去焦点才能触发您的`click`功能，因为失去焦点是您的点击导致的阻塞而被覆盖。

您可以使用`timeOut`您所说的，也可以重构为`keydown`您`text`输入的方法。见下文：

```
$(document).ready(function () 
{
   $("input[type=submit]").click(function () {
      $("#text").text('clicked');
   });

   $("input[type=text]").keydown(function () {
      alert('changed');
      $("#text").text('changed');
   });
}); 
```

**小提琴：http:** [//jsfiddle.net/9WXBe/2/](http://jsfiddle.net/9WXBe/2/)

* * *

尼绍，

在获取您的代码并将其放入 jsFiddle 后，我看不到更改事件被触发的任何问题。即使`alert`在代码中有一个。

`$("input[type=text]").change()`在文本框失去焦点之前不会触发，其他元素（例如`select`, ）`radio`将在进行选择或更改后立即执行此操作。

这是小提琴：http: [//jsfiddle.net/w9Thc/1/](http://jsfiddle.net/w9Thc/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T23:16:01.853

问题似乎只发生在 Firefox 上。其他浏览器似乎没有问题。我通过重写不使用文本字段更改事件来解决我的问题。不幸的是，我有另一段代码无法做到这一点。更改事件似乎确实阻止了 UI，因为我在“单击”按钮上没有发现任何类型的触发事件。

# c# - 创建具有从数组中读取的属性的 ExpandoObjects 列表

> ID：14199058
> 
> 赞同：11
> 
> 时间：2013-01-07T15:36:47.733
> 
> 标签：c#, .net, dynamic, expandoobject

我正在尝试创建对象的动态列表，因为我不知道我的对象将具有哪些属性，直到我从文件中读取它们。

所以假设我在一个数组中有我的对象的属性（例如FirstName、LastName、Email）。

我想使用上述属性创建名为 Recipient 的动态对象。然后我想创建一个列表并将其中一些对象添加到该列表中。

到目前为止，我已经完成了以下操作，但我不确定这是否是将属性分配给动态对象的正确方法（“字段”是数组的名称）：

```
var persons = new List<dynamic>();
dynamic Recipient = new ExpandoObject() as IDictionary<string, Object>;
foreach (string property in fields)
{
   Recipient.property = string.Empty;
} 
```

如何创建具有上述属性的收件人对象，然后将这些收件人添加到人员列表中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-07T15:54:31.897

`ExpandoObject`实现`IDictionary<string, object>`接口，其中键/值将映射到成员名称/值。如果数组中有属性*名称*，则`fields`只需将它们用作字典键：

```
IDictionary<string, object> recipient = new ExpandoObject();
foreach (string property in fields)
{
   recipient[property] = string.Empty;
} 
```

# jquery - Spring Security登录成功后如何回调AJAX成功函数？

> ID：14199062
> 
> 赞同：7
> 
> 时间：2013-01-07T15:36:53.490
> 
> 标签：jquery, ajax, spring, closures

我有发出 AJAX 调用的客户端。这些调用引用受服务器端 Spring Security 保护的 URL。如果用户的会话超时，我会在灯箱中弹出一个登录表单。用户成功登录后，我希望客户端重新执行 AJAX 调用。

下面是进行 AJAX 调用的客户端代码示例：

```
function handleSearchClick(evt) {
    var setupOptions = { 
        success: loadSearch,
        type: "POST",
        dataType: "json",            
        url:   "../search.ajax",
        error: handleError, // how can I pass callback info i.e. I want to be able to execute $("#searchForm").ajaxSubmit(setupOptions); from handleError? 
        timeout: 50000
    };                
    $("#searchForm").ajaxSubmit(setupOptions);
} 
```

当认证失败时，服务器返回 401 导致客户端调用 handleError。是否可以将回调函数传递给handleError？我希望回调重新执行

```
$("#searchForm").ajaxSubmit(setupOptions); 
```

我已经看到了此问题的解决方案，其中服务器在会话超时的 AJAX 调用上返回成功响应。然后，成功函数在响应中查找某些内容以了解会话超时。客户端然后在那里存储一个回调函数。我更喜欢在错误函数中处理这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T03:00:27.540

执行的请求

```
$("#searchForm").ajaxSubmit(setupOptions); 
```

可以通过调用在handleError函数中重新执行

```
$.ajax(this); 
```

无需传入回调函数重新执行：

```
$("#searchForm").ajaxSubmit(setupOptions); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:19:51.163

[关闭](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)救援：

```
function handleSearchClick(evt) {
    var setupOptions = {
        success: loadSearch,
        type: "POST",
        dataType: "json",
        url: "../search.ajax",
        timeout: 50000
    };
    setupOptions.error = handleError(setupOptions);
    $("#searchForm").ajaxSubmit(setupOptions);
}

function handleError(setupOptions) {
    return function () {
        // handle error

        // then re-submit
        $("#searchForm").ajaxSubmit(setupOptions);
    };
} 
```

请注意，这会创建一个引用循环（setupOptions 具有对 handleError 返回的错误函数的引用，错误函数具有对 setupOptions 的引用），但这应该很容易被任何体面的浏览器进行垃圾收集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T21:15:06.997

我在这里提到过：[如何在不刷新页面的情况下发送表单？](https://stackoverflow.com/questions/8819049/how-to-sent-a-form-without-refreshing-the-page/8819077#8819077)

这是对错误处理程序进行回调的方式。

```
$.ajax({
    url: siteUrl + 'fetch/search',
    type: "POST",
    data: formData,
    success: function(data) {
      .....
    },
    error:function(x,e){
        if(x.status==0){
            alert('You are offline!!\n Please Check Your Network.');
        }else if(x.status==404){
            alert('Requested URL not found.');
        }else if(x.status==500){
            alert('Internel Server Error.');
        }else if(e=='parsererror'){
            alert('Error.\nParsing JSON Request failed.');
        }else if(e=='timeout'){
            alert('Request Time out.');
        }else {
            alert('Unknow Error.\n'+x.responseText);
        }
    }
}); 
```

但是您可以执行以下操作

```
function handleSearchClick(evt) {
    var setupOptions = { 
        success: loadSearch,
        type: "POST",
        dataType: "json",            
        url:   "../search.ajax",
        error: handleError(x,e), // this should do it
        timeout: 50000
    };                
    $("#searchForm").ajaxSubmit(setupOptions);
} 
```

# spring - JMS DAO 的 PersistenceExceptionTranslationPostProcessor

> ID：14199065
> 
> 赞同：0
> 
> 时间：2013-01-07T15:37:05.863
> 
> 标签：spring, exception-handling, jms, data-access-layer, spring-jms

我遇到了 Spring 的`PersistenceExceptionTranslationPostProcessor`，这似乎很完美，因为它抽象了在带有注释的 DAO 中抛出的异常`@Repository`。

现在我有一个使用 JMS (ActiveMQ) 而不是数据库作为后端的应用程序。我想使用类似`PersistenceExceptionTranslationPostProcessor`将`JMSException`s 翻译成 Spring 的东西`DataAccessException`。

在我去重新发明轮子之前，我在网上搜索了这样的东西，但没有找到。也许我使用了错误的搜索键，所以作为第二次尝试，有没有人知道这样的东西存在，或者我必须发明这个轮子？

* * *

**更新：**

看来我必须创造一个`PersistenceExceptionTranslator`自己。我做了以下事情：

`PersistenceExceptionTranslator`在我的抽象 JMS DAO 上实现：

```
public abstract class AbstractJmsDao implements PersistenceExceptionTranslator
{
    public void throwException()
    {
        try
        {
            throw new JMSException("test");
        }
        catch (JMSException ex)
        {
            throw JmsUtils.convertJmsAccessException(ex);
        }
    }

    @Override
    public DataAccessException translateExceptionIfPossible(RuntimeException ex)
    {
        // translate exceptions here.
    }
} 
```

添加`PersistenceExceptionTranslationPostProcessor`到我的 XML 配置中：

```
<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor" /> 
```

用以下内容注释了我的 DAO 实现`@Repository`：

```
@Repository
public class CustomerJmsDao extends AbstractJmsDao implements CustomerDao
{
    public void test()
    {
        throwException();
    }
} 
```

但是，当 a`RuntimeException`被抛出时，`translateExceptionIfPossible()`永远不会被命中（用断点检查）。我显然在这里遗漏了一些东西，但是我不知道是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:54:56.823

虽然它不会转换为 DataAccessException 层次结构中的异常，但会`JmsUtils.convertJmsAccessException()`转换为 Spring 等价物......

```
/**
 * Convert the specified checked {@link javax.jms.JMSException JMSException} to a
 * Spring runtime {@link org.springframework.jms.JmsException JmsException} equivalent.
 * @param ex the original checked JMSException to convert
 * @return the Spring runtime JmsException wrapping the given exception
 */ 
```

# sql - 在特定时间插入明天日期

> ID：14199067
> 
> 赞同：1
> 
> 时间：2013-01-07T15:37:17.107
> 
> 标签：sql, sql-server-2008, sql-server-2005

我正在尝试将明天 10:00:00 的日期插入 SQL Server 2005/2008。

我目前有

```
DATEADD(dd, 1, GETDATE()) 
```

这让我明天的日期很好，但是我尝试了多种方法来连接/设置时间`10:00:00`。

例子：

```
Current Time: 2013-01-07 15:37:05
Required Insert Date: 2013-01-08 10:00:00 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T15:39:21.563

您可以使用`DATEADD`和的组合`DATEDIFF`。

```
SELECT DATEADD(hh,10, DATEDIFF(dd,0, DATEADD(dd, 1, GetDate()))) 
```

`DATEDIFF(dd,0...)`截断日期的时间部分，因此“四舍五入”到午夜并`DATEADD(hh,10...)`增加 10 小时。

[**演示**](http://www.sqlfiddle.com/#!6/d41d8/1881/0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:39:12.610

试试这个：

`DATEADD(hh,34,DATEDIFF(dd,0,GETDATE()))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T15:43:04.070

`DATEADD`比其他答案少一个：

```
SELECT DATEADD(day,DATEDIFF(day,'20010101',GETDATE()),'2001-01-02T10:00:00') 
```

这会将自 2001 年 1 月 1 日以来的（整数）天数添加到 2001 年 1 月 2 日上午 10 点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:25:28.210

这将在 Oracle 中工作 - 第二天上午 10 点返回：

```
Select to_char((trunc(Sysdate)+1)+10/24, 'yyyy-mm-dd hh24:ss:mi') insert_date
 From dual
 /

 SQL> 2013-01-08 10:00:00 
```

# asp.net - 同步来自 IIS 的调用时出现 Microsoft 错误？

> ID：14199072
> 
> 赞同：0
> 
> 时间：2013-01-07T15:37:28.627
> 
> 标签：asp.net, iis, synchronization, visual-studio-debugging, microsoft-sync-framework

我收到以下错误

> `***`由于以下错误，检索具有 CLSID {046C184F-2188-4C99-A95A-9C0DCDC19050} 的组件的 COM 类工厂失败：80040154 未注册类（HRESULT 异常：0x80040154 (REGDB_E_CLASSNOTREG)）。`***`

在执行以下语句时使用 Microsoft 同步服务。

仅当我从 http;//localhost/S71/default.aspx 等 IIS 运行时才会收到错误消息。但如果我从 Visual Studio 中按 F5 运行，它工作正常。

仅当我仅从 IIS 运行并且在 .Synchronize() 方法上出现错误时，所有其他代码（例如“配置过程”）才能正常工作。

```
// Execute the synchronization process
            SyncOperationStatistics syncStats = syncOrchestrator.Synchronize(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T02:39:34.590

您安装了哪个 Sync Fx？x86 还是 x64？如果是 x86，请通过设置“启用 32 位应用程序”检查您的应用程序池是否也配置为 32 位应用程序

# java - 图像在垂直滚动窗格视口中消失

> ID：14199075
> 
> 赞同：1
> 
> 时间：2013-01-07T15:37:33.513
> 
> 标签：java, image, swing, scrollpane

公爵.png ->![公爵.png](../Images/5b52b29c6ff8733e7905e916bf0771f1.png)

arrowToLeft.gif ->![arrowToKeft](../Images/b04bc4437cef999c8adfb1ebbefd65a6.png)

arrowToRight.gif ->![在此处输入图像描述](../Images/d1ca8b2590aee9cee8c6819f2d3fd136.png)

我需要一个 UI，我想在 Swing 中描绘网络设备的图形表示。为此，我只是加载多个图像并将它们一一重叠以显示设备的当前状态。我必须支持缩放这个视图。缩放代码如下所示。

```
public class LayeredPaneTest{
        private JLayeredPane layeredPane;
        private JScrollPane scrollPane;
        private static double MIN_ZOOM_VALUE = 0.60; // 1.0;
        private static double MAX_ZOOM_VALUE = 2.0;
        private static final int LAYER1 = 0;
        private static final int LAYER2 = 1;
        private static final int LAYER3 = 3;
        private double scaleFactor = 1.0;
        private JInternalFrame internalFrame =
            new JInternalFrame("LayeredPaneTest",false, false, false, false);

        public LayeredPaneTest(){
             loadView();
        }

        public JInternalFrame getView(){
             return internalFrame;
        }

        private void loadView(){
            ((javax.swing.plaf.basic.BasicInternalFrameUI)internalFrame.getUI())
               .setNorthPane(null);
            internalFrame.setBorder(null);      
            internalFrame.getContentPane().add(buildCenterPane());      
            internalFrame.setSize(new Dimension(200, 200));
            internalFrame.setLocation(0, 0);
            internalFrame.setResizable(false);
            internalFrame.setVisible(true);
        }

        private JPanel buildCenterPane(){
            JPanel panel = new JPanel();
            panel.setLayout(new BorderLayout());
            layeredPane = new JLayeredPane();
            Position shelfPosition = new Position(0,0,200,200);
            setLayeredPaneSize(shelfPosition);
            JLabel label = getImageLabel(getImage("duke.png"),
                new  Position(0,0,100,100));        
            layeredPane.add(label, Integer.valueOf(LAYER1));        
            label = getImageLabel(getImage("arrowToLeft.gif"),
                new Position(100,100,50,50));       
            layeredPane.add(label, Integer.valueOf(LAYER2));
            label = getImageLabel(getImage("arrowToRight.gif"),
                new Position(50,50,50,50));     
            layeredPane.add(label, Integer.valueOf(LAYER3));        
            scrollPane = new JScrollPane(layeredPane);      
            panel.add(scrollPane, BorderLayout.CENTER);
            panel.add(getSliderPane(), BorderLayout.SOUTH);     
            return panel;
        }

        private Image getImage(String key){
    InputStream is = this.getClass().getResourceAsStream(key);
    try {
        return ImageIO.read(is);
    } catch (IOException e) {
        e.printStackTrace();
    }
    return null;
        }

        private void setLayeredPaneSize(Position shelfPosition){
            int width = (int)(shelfPosition.getWidth() * scaleFactor + 10);
            int height = (int)(shelfPosition.getHeight() * scaleFactor + 10);
            layeredPane.setPreferredSize(new Dimension(width,height));
        }

        public void zoom(double factor){
            if (factor < MIN_ZOOM_VALUE)
                factor = MIN_ZOOM_VALUE;
            else if (factor > MAX_ZOOM_VALUE)
                factor = MAX_ZOOM_VALUE;
            scaleFactor = factor;
            Position shelfPosition = new Position(0,0,200,200);
            setLayeredPaneSize(shelfPosition);        
            scrollPane.getViewport().repaint();
            scrollPane.repaint();        
            scrollPane.getViewport().revalidate();
            scrollPane.revalidate();
        }

        private JLabel getImageLabel(Image image, Position position) {
            position = position.moveInRatio(scaleFactor);
            ImageLabel label = new ImageLabel(new ImageIcon(image), position);
            label.setOpaque(false);
            label.setBounds(position.getLeft(),  
                position.getTop(),position.getWidth(),position.getHeight());
            return label;
        }

        private JPanel getSliderPane(){
            JPanel outer = new JPanel();
            outer.setLayout(new FlowLayout());      
            JPanel panel = new JPanel();
            panel.setLayout(new BorderLayout());
            final JSlider slider = new JSlider((int) (MIN_ZOOM_VALUE * 100),
                (int) (MAX_ZOOM_VALUE * 100), 100);
            slider.setMajorTickSpacing(1);
            slider.setMinorTickSpacing(1);
            double sliderValue = scaleFactor * 100.0;
            slider.setValue((int) sliderValue);
            slider.addChangeListener(new ChangeListener() {         
        @Override
        public void stateChanged(ChangeEvent e) {
            scaleFactor = slider.getValue() / 100.0;
            zoom(scaleFactor);

        }
    });
            panel.add(slider, BorderLayout.CENTER);        
            outer.add(panel);
            return outer;
        }

        public static void main(String...strings){
           JFrame frame = new JFrame("FrameDemo");
           frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
           frame.getContentPane().add(new LayeredPaneTest().getView(), 
               BorderLayout.CENTER);
           frame.pack();
           frame.setVisible(true);
        }

        static class Position{
           private final int left,top,width,height;

           Position(int x1, int y1, int x2, int y2){
               this.left = x1;
               this.top = y1;
               this.width = x2;
               this.height = y2;
               }

               public int getLeft() {
           return left;
       }

       public int getTop() {
           return top;
       }

       public int getWidth() {
           return width;
       }

       public int getHeight() {
           return height;
       }    
        }

        private class ImageLabel extends JLabel{
            private static final long serialVersionUID = 6152144095443433296L;
            private ImageIcon image;
            private Position position;

            public ImageLabel(ImageIcon image, Position position){
            super(image);
            this.image = image;
            this.position = position;
            }

            public void paintComponent(Graphics g) {
            int newX = (int)(position.getLeft() * scaleFactor);
            int newY = (int)(position.getTop() * scaleFactor);          
            Graphics2D g2 = (Graphics2D)g;
            int newW = (int)(position.getWidth() * scaleFactor);
            int newH = (int)(position.getHeight() * scaleFactor);
            setBounds(newX, newY, newW, newH);
            g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
                    RenderingHints.VALUE_ANTIALIAS_ON);
            g2.drawImage(image.getImage(), 0, 0, newW, newH, null);
            }
        }

} 
```

但这里的问题是，当我放大一次并缩小时，一些图像会消失。知道为什么它会这样吗？

以下是重现该错误的步骤；一个。将滑块拖动到最大值，b。见证图像被扩展到最大并引入滚动条，c。现在图像的几个部分被隐藏了，d。现在将滑块拖动到最小。e. 图像的隐藏部分消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T20:25:33.933

您不会通过调用重写方法的实现来尊重*绘制链，如下所示：*`super.XXX``paintComponent`

```
@Override
protected void paintComponent(Graphics grphcs) {
    super.paintComponent(grphcs);

    //do the rest of the painting here
} 
```

正如[文档](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#paintComponent%28java.awt.Graphics%29)明确指出的那样：

> 如果你不调用 super 的实现，你必须尊重 opaque 属性，也就是说，如果这个组件是不透明的，你必须用不透明的颜色完全填充背景。如果您不尊重 opaque 属性，您可能会看到视觉伪影。

还要注意`@Override`注释以确保我覆盖了正确的方法，并且默认情况下`paintComponent`保持`protected`这种方式，因为您不想将此方法*公开*给他们应该使用的其他类`repaint()`

# fedora - KCacheGrind 没有在 Fedora 17 上打开任何东西

> ID：14199083
> 
> 赞同：1
> 
> 时间：2013-01-07T15:37:51.303
> 
> 标签：fedora, kcachegrind

所以，我已经尝试了我现在能做的所有事情，但并没有真正做到这一点，所以我正在向 SO 上的人寻求帮助。

系统详情：

Fedora 17 x86_64

Intel® Pentium(R) 双 CPU E2160 @ 1.80GHz × 2

1.9 GiB 内存

KCacheGrind 0.7.1

KDE 平台版本 4.9.4

过程详细信息：我从服务器或名为 Xdebug Helper 的 Chrome Ext 获取了 XDEBUG 日志。我直接从图标或我创建的 Shell 脚本运行它。

```
#!/bin/bash
export $(dbus-launch)
kcachegrind 
```

我收到错误“未加载配置文件数据”

有任何想法吗？

抱歉：错误读取“（未选择功能）”

对不起。我是 Linux 和 KCacheGrind 的 n00b。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:20:29.680

我用根。固定的。添加 10 个或更多字符。

# c - POSIX 线程的自定义属性

> ID：14199091
> 
> 赞同：0
> 
> 时间：2013-01-07T15:38:10.390
> 
> 标签：c, pthreads

是否可以向 POSIX 线程添加自定义属性（即名称、互斥块级别等）？这个想法是操纵附加到线程上下文的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:39:57.977

一开始我想到了[线程本地存储](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/apis/rzah4mst.htm)（TLS）。但是也许您想从线程外部执行此操作……如果是这样，TLS 将不起作用，因为它仅对在线程内部运行的代码有效。

但是，由于您对所有线程都有一个唯一标识符（[threadid](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/apis/rzah4mst.htm)），您应该能够使用任何字典类型的数据结构，并将其作为键。

# c# - 使用javascript在网页上自动登录和解析

> ID：14199095
> 
> 赞同：1
> 
> 时间：2013-01-07T15:38:23.340
> 
> 标签：c#, java, php, ruby, automated-tests

我需要登录并解析，然后将数据插入某个网页。我知道 php、ruby、java、c#。在 ruby​​ 中，我知道 mechanize - 它正在模拟 webbrowser，而无需启动它。对我有好处，但它不适用于带有 js 的页面。

我也尝试使用 watir - 但它只是基于桌面的应用程序，因为它运行 ibrowser。

是否有任何其他的 js 解决方案，但没有在 php、ruby、java、c# 上启动浏览器将其放在服务器上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:48:05.817

对于 .NET：[C# (.NET) 的无头浏览器？](https://stackoverflow.com/questions/10161413/headless-browser-for-c-sharp-net)

节点 js（服务器端 javascript）[http://zombie.labnotes.org/存在一个有趣的无头浏览器实现](http://zombie.labnotes.org/)

只需搜索<[编程语言]，无头浏览器>

# javadoc - javadoc：@value 引用其他类中的字段

> ID：14199099
> 
> 赞同：6
> 
> 时间：2013-01-07T15:38:31.413
> 
> 标签：javadoc

```
/**  {@value Constants#KEY_MEAN} blah
     * {@value Constants#KEY_STDDEV}
     * @return A JSONObject with keys for mean and standardDeviation 
     */ 
```

当我在 Constants.java 之外但在同一个包中使用这个 javadoc 时，eclipse 只会输出纯文本，而在生成 Javadoc 时，什么都不会显示。这是可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-06T18:57:01.413

最好从显而易见的开始。引用的字段是`static`和不是`private`，对吗？例如，

`public static final KEY_MEAN = 1337;`

我今天一直在努力找出自己类似的 javadoc 问题并将您的代码粘贴到我自己的代码中，但是更改为我的类和字段名称，它按预期工作，“50000 blahaa 50000 Returns: A JSONObject with keys for mean and standardDeviation 。” 这使我想到了将验证您的字段声明`class Constants`作为合理的首要措施的问题。

# java - Signature_invalidbase_string

> ID：14199108
> 
> 赞同：0
> 
> 时间：2013-01-07T15:38:53.190
> 
> 标签：java, google-app-engine, oauth, google-api, 2-legged

嗨，我正在制作一个 Google 应用程序，我在其中向 Google API 发送请求。我正在尝试实现 2legged OAuth1.0 以获取请求令牌（我正在关注此[链接](https://developers.google.com/accounts/docs/OAuth_ref)）

在此链接中，我正在向 /accounts/oauth/GetRequesttoken 发送 POST 请求。下面是我用于发送 post 请求的 servlet 代码。评论很好，请阅读：

```
 package org.ritesh;
    //import classes
    import java.io.BufferedInputStream;
    import java.io.BufferedReader;
    import java.io.IOException;
    import java.io.InputStream;
    import java.io.InputStreamReader;
    import java.io.OutputStreamWriter;
    import java.net.HttpURLConnection;
    import java.net.URL;
    import java.net.URLEncoder;

    import javax.servlet.http.*;

    import com.google.gdata.client.authn.oauth.GoogleOAuthParameters;

    @SuppressWarnings("serial")
    public class HelloWorldServlet extends HttpServlet {
method for handling get request    
    public void doGet(HttpServletRequest req, HttpServletResponse resp)
                throws IOException {

            resp.setContentType("text/plain");
            resp.getWriter().println("Hello, world");

//setting oauth_version parameter to 1.0      

        String datastring=URLEncoder.encode("oauth_version", "UTF-8")+"="+URLEncoder.encode("1.0", "UTF-8");

 //setting oauth_nonce a unique value so assigned a time stamp     

      datastring+="&"+URLEncoder.encode("oauth_nonce", "UTF-8")+"="+URLEncoder.encode(System.currentTimeMillis()+"","UTF-8");
        //setting parameter oauth_timestamp to current time in setting

      datastring+="&"+URLEncoder.encode("oauth_timestamp", "UTF-8")+"="+URLEncoder.encode(System.currentTimeMillis()/1000+"","UTF-8");

//its my domain name i am hosting my app on domain iriteshmehandiratta.appspot.com

        datastring+="&"+URLEncoder.encode("oauth_consumer_key","UTF-8")+"="+URLEncoder.encode("iriteshmehandiratta.appspot.com","UTF-8");
  //my .pem file contain RSA fingerprints so i include RSA-SHA1 for //oauth_signature_method    

        datastring+="&"+URLEncoder.encode("oauth_signature_method","UTF-8")+"="+URLEncoder.encode("RSA-SHA1", "UTF-8"); 
  //consumer_secret that i got when i successfully registered my app  on google Manage domain link

        datastring+="&"+URLEncoder.encode("oauth_signature", "UTF-8")+"="+URLEncoder.encode("eOcmMdWaO2O14JyK1TbYPS09", "UTF-8");
    //setting oauth_callback parameter

    datastring+="&"+URLEncoder.encode("oauth_callback","UTF-8")+"="+URLEncoder.encode("https://www.iriteshmehandiratta.appspot.com/authsub","UTF-8");

    datastring+="&"+URLEncoder.encode("scope","UTF-8")+"="+URLEncoder.encode("http://www.google.com/calendar/feeds","UTF-8");

    URL url=new URL("https://www.google.com/accounts/OAuthGetRequestToken?"+datastring); 

            HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();

            urlConnection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

            urlConnection.setRequestProperty("Authorization", "OAuth");

            urlConnection.setRequestMethod("POST");

            urlConnection.setDoOutput(true);

            BufferedReader in = new BufferedReader(new InputStreamReader(urlConnection.getInputStream()));

              resp.getWriter().println( urlConnection.getResponseCode());

               String xx="";

               String xx1="";

               while((xx1=in.readLine()) != null)

               {
                   xx+=xx1;

               }
               resp.getWriter().println(xx);

        }
    } 
```

当我运行它时，我期望响应应该如下所示！

```
oauth_token=ab3cd9j4ks73hf7g&oauth_token_secret=ZXhhbXBsZS5jb20&oauth_callback_confirmed=true 
```

但我得到的回应是：

```
signature_invalidbase_string:POST&https%3A%2F%2Fwww.google.com%2Faccounts%2FOAuthGetRequestToken&oauth_callback%3Dhttps%253A%252F%252Fwww.iriteshmehandiratta.appspot.com%252Fauthsub%26oauth_consumer_key%3Diriteshmehandiratta.appspot.com%26oauth_nonce%3D1357576190878%26oauth_signature_method%3DRSA-SHA1%26oauth_timestamp%3D1357576190%26oauth_version%3D1.0%26scope%3Dhttp%253A%252F%252Fwww.google.com%252Fcalendar%252Ffeeds 
```

如果我错了，请指出如何纠正这个问题：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:58:09.580

我建议您尝试使用该[`google-oauth-java-client`](http://code.google.com/p/google-oauth-java-client/)库。它经过测试可以在 AppEngine 上运行。

# ruby-on-rails - 只有带有 rails simple_form 的时间选择器

> ID：14199110
> 
> 赞同：0
> 
> 时间：2013-01-07T15:38:58.023
> 
> 标签：ruby-on-rails, simple-form

我已经用 simple_form 实现了 jquery 数据时间选择器。已为具有时间格式的日期实现了 gem 'jquery-rails'。

有什么办法，我只能得到时间派克？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-29T16:33:27.910

您可以使用另一个 jquery 插件[TimePicki](https://github.com/senthilraj/TimePicki)或[jquery-timepicker](http://jonthornton.github.io/jquery-timepicker/)

[![在此处输入图像描述](../Images/d735fe02fe1f656dedbd090e74a5b109.png)](https://i.stack.imgur.com/LG2Wf.png)

# javascript - imacros 将变量设置为另一个变量值

> ID：14199113
> 
> 赞同：0
> 
> 时间：2013-01-07T15:39:01.783
> 
> 标签：javascript, imacros

我正在运行一个简单的 imacro 来使用 123reg 的前端自动添加子域 dns 记录。但是，我需要使用的命名约定导致了一些问题。

我有两个域我在 domain1.com 上映射 xxx1 - xxx128 在 domain2.com 上 xxx129 - xxx254

这是我用来映射 domain1.com 地址的代码

```
TAB T=1
SET !LOOP 1
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:advanced_DNS ATTR=NAME:hostname CONTENT=mx{{!LOOP}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:advanced_DNS ATTR=NAME:data_A CONTENT=x.x.x.{{!LOOP}}
TAG POS=1 TYPE=A ATTR=ID:save_dns_entries
WAIT SECONDS=2 
```

理想情况下，我一直在尝试添加一个变量 !VAR0 并做一些简单的数学运算，即。

```
!VAR0 !LOOP
ADD !VAR0 -128
TAB T=1
SET !LOOP 1
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:advanced_DNS ATTR=NAME:hostname CONTENT=mx{{!VAR0}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:advanced_DNS ATTR=NAME:data_A CONTENT=x.x.x.{{!LOOP}}
TAG POS=1 TYPE=A ATTR=ID:save_dns_entries
WAIT SECONDS=2 
```

这种格式只是将“！LOOP”添加到！VAR0 ...有没有办法在imacros中将一个变量值设置为另一个变量的值？我知道它的数学功能非常有限......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:04:48.300

我通过更好的思考找到了解决问题的方法！用 {{}} 包围变量或循环（!VAR0 或 !LOOP），即 {{!LOOP}} 将给出该变量的值。

要设置变量的值，然后对其执行数学运算：

```
!VAR0 {{!LOOP}} 
!VAR0 - 128 
```

以下是我上面示例的解决方案，在 123reg.com 的高级 DNS 条目下，将允许非常快速和自动添加格式为 mx0.domain.com 的子域，其中“0”是数字范围，xxx 是IP 地址的前 3 点；如果您将 IP 范围映射到服务器 DNS 上的子域，则很有用。

```
TAB T=1
SET !LOOP 129
SET !VAR0 {{!LOOP}}
ADD !VAR0 -128
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:advanced_DNS ATTR=NAME:hostname CONTENT=mx{{!VAR0}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:advanced_DNS ATTR=NAME:data_A CONTENT=x.x.x.{{!LOOP}}
TAG POS=1 TYPE=A ATTR=ID:save_dns_entries
WAIT SECONDS=2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T01:28:49.103

或者您可以使用 iMacros 脚本接口。以及命令 iimSet 和 iimPlay。

# php - 我如何解析这个数组

> ID：14199114
> 
> 赞同：0
> 
> 时间：2013-01-07T15:39:01.507
> 
> 标签：php

可以说这是我检索到的对象`$myObj`

```
Array
(
    [0] => xl_oio_0_1_Mytitle Object
                (
                        [_unknown:protected] => 
                        [header_:protected] => Header Object
                                (
                                        [_unknown:protected] => 
                                        [myId_:protected] => my_title
                                        [userId_:protected] => 
                                        [createTime_:protected] => 
                                )

                        [id_:protected] => ID Object
                                (
                                        [_unknown:protected] => 
                                        [id_:protected] => ingy3spdzE1uiMtCYRSlmwtX
                                )

                        [dataType_:protected] => 2
                        [picSize_:protected] => 8669
                        [userId_:protected] => ID Object
                                (
                                        [_unknown:protected] => 
                                        [id_:protected] => ingy3spdzE1uiMtCYRSlmwtX
                                )

                        [fName_:protected] => Joe
                        [lName_:protected] => Smith
                        [cDate_:protected] => RxyascTe89Xe4
                )
    [1] => etc... 
```

我正在尝试解析名称和日期，我尝试了以下操作，但没有成功。

```
$i=0;
while( $i < 20 ){

    // Notice: Trying to get property of non-object
    //$firstName    = $myObj->xl_oio_0_1_Mytitle->fName_;

    // Fatal error: Cannot use object of type
    //$firstName    = $myObj[$i]['fName_'];

    // Parse error: syntax error, unexpected T_OBJECT_OPERATOR
    $firstName  = $myObj->xl_oio_0_1_Mytitle(object->fName_);
    echo $firstName . '<br />';
    $i++;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T15:40:51.237

答案很简单：除非对象为它们提供 getter 方法，否则您无法访问任何这些值。

尝试`$myObj[$i]->getFName()`- 这是最有可能获得该`fName`属性的名称。

如果您不喜欢反复试验，请查看对象的代码或使用反射来获取对象具有的方法列表：

```
$ref = new ReflectionObject($myObj[0]);
print_r($ref->getMethods()); 
```

# c# - 为什么在接口列表的泛型类型内使用私有嵌套类型不是“不一致的可访问性”？

> ID：14199117
> 
> 赞同：18
> 
> 时间：2013-01-07T15:39:07.540
> 
> 标签：c#, generics, encapsulation, access-modifiers

如果标题不完全不言自明，这是让我感到困惑的代码：

```
public interface IFoo<T>
{
}

public class MyClass : IFoo<MyClass.NestedInMyClass>
{
  private class NestedInMyClass
  {
  }
} 
```

我很惊讶这个编译没有错误。感觉就像我在暴露一种`private`类型。**这不应该是非法的吗？**

也许你的答案只是*“没有规则反对，那为什么不可以呢？”* `MyClass.NestedInMyClass`也许即使在“范围”内也同样令人惊讶。如果我删除`MyClass.`资格，它将无法编译。

（如果我更改`IFoo<>`为泛型*类*，然后它应该成为的基类`MyClass`，这*是*非法的，因为基类型必须至少与类型本身一样可访问。）

我用 Visual Studio 2010 的 C# 4 编译器尝试了这个。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T15:50:44.040

没有外部代码可以*将*对象转换为该接口，因此这不是可访问性问题。

`public`甚至允许类实现`private`或`internal`接口 - 同样，外部代码实际上不会发生强制*转换*。

回复：关于依赖的实现的讨论`T`- 如果你使用显式接口实现，你将被允许 - 因为在这种情况下接口的方法实际上是私有的。例如：

```
public interface IFoo<T>
{
  void DoStuff(T value);
}

public class MyClass : IFoo<MyClass.NestedInMyClass>
{
  void IFoo<MyClass.NestedInMyClass>.DoStuff(MyClass.NestedInMyClass value)
  {
  }
  private class NestedInMyClass
  {
  }
} 
```

工作（因为接口实现方法不被类本身公开）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:27:38.670

类实现接口的事实意味着可以创建接口类型的存储位置的代码可以在该存储位置存储对该类型的引用，并且可以使用该存储位置上的接口成员。它没有提供任何新的编码能力，否则将无法创建该类型的存储位置。

让一个公共类`Foo`实现一个私有或内部类型的接口，`IBar`使得可以访问的代码可以`IBar`将`Foo`引用转换为`IBar`. `Foo`无法访问的代码可以访问的事实`IBar`绝不意味着它也不会被具有此类访问权限的代码使用。`Foo`实际上，定义的程序集或类想要使用`Foo`外部世界不可用的特性是很正常的。它实现的事实`IBar`只是这样一个功能。

# c++ - 常量向量 还是常量字符串[]？

> ID：14199126
> 
> 赞同：2
> 
> 时间：2013-01-07T15:39:46.560
> 
> 标签：c++, arrays, vector

在我的课堂上，我需要存储一`const static`组字符串。由于现在用 C++ 编写的代码（部分）基于原始 C 算法，因此数据存储为`const char* presets[150]`（有 150 个字符串）。因为我现在基本上是在 C++ 中重写/重新打包它，所以`char*`变成`string`. 我的问题是：我应该将数组更改为`vector`吗？

在这种情况下什么更好，`const static vector<string> presets`或者`const static string presets[150]`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:41:51.983

当然不是后者。

如果大小不需要更改，请使用

```
std::array<std::string, 150> 
```

这样，您将能够以与`std::vector`.

编辑：关于`string`初始化可能出现的问题：您可以将数组创建为 C 样式数组，然后将数据复制到`array`. 由于您将复制（大约）600 字节的连续块，因此这不是非常昂贵的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:13:47.997

实际上是`char const* const presets[] = { ... };`用字符串文字初始化的吗？换句话说，当您说 时 `char const* presents[150]`，这是因为有人忘记了第二个`const`，还是因为您稍后实际上修改了指针。是因为有人实际计算了初始化程序，并将数字放在大括号中，并且每次添加或删除初始化程序时都会更新此数字，还是因为您提供的初始化程序较少，并且依赖于正在初始化的尾随值一个空指针？在不确切知道您要做什么的情况下，很难给出好的建议。

在我遇到的最常见的情况下，您真正​​想要的是一切都是 const，并且数组的大小与初始化器的数量完全对应，最好的解决方案可能是保持原样。要自动调整数组大小，您需要使用 C 样式数组，或（然后仅使用 C++11）`std::vector`； `std::array`要求您明确给出元素的数量。并且要获得真正的静态初始化（因此 *永远不会*有任何初始化顺序问题的风险），您需要一个 C 样式数组或`std::array`，在两种情况下 `char const*`（而不是`std::string`，这需要动态初始化）。

请注意，使用`char const*`而不是`std::string`确实意味着每次访问它时（通常），您将构造一个新的`std::string`. 根据实现，这*可能会*引入一些额外的运行时开销。通常，这不是问题，但也可能需要考虑；必须权衡一个事实，即如果您使用来自其他静态对象的构造函数的对象，则使用`std::string` 将导致必须解决的初始化顺序问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:20:03.770

这取决于。如果您使用 std::string 的数组或向量，则必须在运行时处理对象的初始化。如果您使用原始数组，则所有内容都会在编译时初始化。另一方面，当您需要诸如恒定时间 size() 之类的附加功能时，使用“真实”对象可能会很有用。

# php - 将当前年份和月份与在 sql 查询中输入 y/m 的数据库进行比较

> ID：14199130
> 
> 赞同：0
> 
> 时间：2013-01-07T15:39:52.347
> 
> 标签：php, mysql, date, select

无法编写完整的函数来将当前月份和年份与我的数据库 m/y 进行比较。数据库中的日期来自 now() 函数。我想根据这个比较来总结成本。就像是：

```
$currentDate = date("Y-m");
$query = mysql_query ("SELECT SUM(cost) FROM memberorders WHERE 
         memberNumber=$memNum AND 
        (SELECT DATE_FORMAT(orderDate, '%Y-%m'))=$currentDate"); 
```

但这行不通。然后我需要一个函数的帮助来总结它。

```
$test1 = mysql_fetch_array($query);
$total = $test1[0]; 
```

这对遍历数据库并总结有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:47:04.287

不要那样做，如果要使用索引，请不要将任何函数（如`DATE_FORMAT()`函数）应用于列（如列）。`OrderDate`如果您可以在应用程序 (PHP) 代码中创建固定的月份开始，请尝试以下操作：

```
SELECT SUM(cost) 
FROM memberorders 
WHERE memberNumber = $memNum 
  AND orderDate >= '2013-01-01'      -- first day of this month
  AND orderDate < '2013-02-01' ;     -- first day of next month 
```

或者如果您更喜欢在 MySQL 中处理它：

```
SELECT SUM(cost) 
FROM memberorders 
WHERE memberNumber = $memNum 
  AND orderDate >= LAST_DAY(NOW()) + INTERVAL 1 DAY - INTERVAL 1 MONTH 
  AND orderDate < LAST_DAY(NOW()) + INTERVAL 1 DAY ; 
```

# opencv - 密码本背景减法 - 一切都爆炸成白色

> ID：14199139
> 
> 赞同：0
> 
> 时间：2013-01-07T15:40:00.863
> 
> 标签：opencv, background-subtraction

我是使用码本方法定义的 OpenCV 背景减法模型的新手。

[我在这里](http://read.pudn.com/downloads194/sourcecode/windows/911138/bgfg_codebook.cpp__.htm)运行示例代码并查看它是如何工作的，这似乎是一个非常好的方法。我试图分割出一个杯子。工作正常，直到杯子靠近相机，此时前景密码本图像和密码本连接组件图像的整个输出都变成完全白色。

为什么会这样？

瓦吉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T16:22:50.717

您可以尝试关闭相机的自动曝光/亮度控制吗？它可能会导致场景中的光照变化，因此被注册为 fg。

# wpf - 重新定义数据模板样式

> ID：14199141
> 
> 赞同：0
> 
> 时间：2013-01-07T15:40:16.917
> 
> 标签：wpf, styles, datatemplate

假设我在应用程序级别为 TextBlock 定义了一个样式，并且我还在应用程序级别为使用一些 TextBlocks 的“DataClass”定义了一个 DataTemplate。现在，在应用程序的某些子部分中，我想重新定义 TextBlock 的外观，我可以重新定义 TextBlock 的样式。

这里的问题是：如果在应用程序的这个子部分应用了DataTemplate，那么里面的所有TextBlocks仍然会使用应用程序级别的TextBlock样式（而不是我重新定义的版本）。有谁知道如何重新定义 DataTemplate 的样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:07:36.660

样式`<Application.Resources>`适用于整个应用程序，并不总是遵循默认样式查找规则。

通常，如果您不想要这种行为，请`<Window.Resources>`改为使用样式，这样它们将仅适用于窗口内的对象，并且将使用正常的样式查找规则。

默认情况下，样式不会跨控件/模板边界应用，但继承自 的对象的样式*除外*`Control`，后者是大多数默认 WPF 控件，例如`Label`或`TextBox`。

因此，您可以设置`Control`对象中任何对象的样式，`.Resources`使其应用​​于所有子对象：

```
<UserControl.Resources>
    <Style TargetType="{x:Type Label}">
        <Setter Property="Foreground" Value="Red" />
    </Style>
</UserControl.Resources> 
```

但是`TextBlock`继承自`FrameworkElement`and not `Control`，因此 a 的样式`TextBlock`不会跨模板边界应用。

如果您确实想将您的样式保留在 中`Application.Resources`，那么您必须在创建 之前，在视觉树的下方覆盖该样式中的属性`TextBlock`，例如

```
<UserControl x:Class="MyNamespace.MyDataTypeView"... >
    <UserControl.Resources>
        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="Black" />
        </Style>
    </UserControl.Resources>

    <TextBlock Text="Test" />
</UserControl> 
```

但是，此样式不会应用于 中的另一个控件内的对象`UserControl`，例如`ComboBoxItems`a 内的文本`ComboBox`

在子控件中使用的A`TextBlock`将应用`TextBlock`from 的样式`Application.Resources`，但不会应用 from，`<UserControl.Resources>`因为在中定义的 TextBlock 样式`Application.Resources`将跨越控件/模板边界，而在任何其他中定义的 TextBlock 样式`X.Resources`则不会。

在这些特定情况下，您可能需要追踪`x:Static`用于设置`TextBlock.Text`颜色的画笔键并覆盖您的`ComboBox.Resources`.

（我在这里可能有错误的[SystemColors](http://blogs.msdn.com/b/wpf/archive/2010/11/30/systemcolors-reference.aspx)键）

```
<ComboBox.Resources>
    <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrushKey}" Color="Black" />
</ComboBox.Resources> 
```

# jpa - 以类型安全的方式更新/删除 - 通过使用 CriteriaQuery 之类的东西？

> ID：14199147
> 
> 赞同：0
> 
> 时间：2013-01-07T15:40:56.380
> 
> 标签：jpa, orm, eclipselink

是否有可能对实体进行更新/删除类型的安全操作，例如使用 CriteriaQuery 进行查询？

我在这里的具体情况是，当我想在一段时间后使用 EclipseLink 删除一些实体集时，我想避免本地查询。我正在使用日期比较和使用本机 SQL 接近。你认为这对我的情况来说是最好的用例吗？我个人认为 ORM 提供者应该制作 SQL 并避免使用原生 SQL。

提前感谢您的建议，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:25:14.237

Criteria API 尚不支持批量操作，但您可以使用常规 JPQL 更新和删除查询。提供者会将它们翻译成 SQL。在大多数情况下，不需要自己编写原生 SQL。

例如 - 提高员工工资然后解雇他：

```
UPDATE Employee e
SET e.salary = 99999
WHERE e.salary = 88888

DELETE FROM Employee e
WHERE e.salary = 99999 
```

# types - 无法在 Verilog 中使用整数

> ID：14199150
> 
> 赞同：2
> 
> 时间：2013-01-07T15:41:13.343
> 
> 标签：types, integer, verilog

我一直在试图弄清楚为什么在使用时会出现“无效的模块实例化”：

```
integer counter = 0; 
counter = 1; // <-- getting the error here 
```

尝试使用 reg[7:0] 而不是整数时，我遇到了同样的错误。

有人知道为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T15:58:27.273

没有上下文的赋值是毫无用处的，没有任何意义，因此是错误的。分配将在具有敏感性列表的块内有效，或作为连续分配的一部分，或在模拟块（如“初始”）内有效。

# silverlight - Silverlight 工具包和多系列图表绑定

> ID：14199151
> 
> 赞同：0
> 
> 时间：2013-01-07T15:41:16.540
> 
> 标签：silverlight, graph, charts, toolkit

我正在努力弄清楚为什么我对多个系列柱形图的绑定不起作用。从我能够通过网络上的示例看到的内容来看，我看不出我所做的逻辑有任何问题，但也许我错过了一些东西。据我所知，它是受支持的。

这是我的图表控件：

```
<toolkit:Chart x:Name="myChart" Margin="10">
            <toolkit:ColumnSeries 
            Title="Orion"
            IndependentValueBinding="{Binding Date}"
            DependentValueBinding="{Binding Orion}"
            AnimationSequence="FirstToLast">
            </toolkit:ColumnSeries>

            <toolkit:ColumnSeries                 
            Title="Access Card"
            IndependentValueBinding="{Binding Date}"
            DependentValueBinding="{Binding AccessCard}"
            AnimationSequence="FirstToLast">
            </toolkit:ColumnSeries>

            <toolkit:ColumnSeries                 
            Title="Time Keeper"
            IndependentValueBinding="{Binding Date}"
            DependentValueBinding="{Binding TimeKeeper}"
            AnimationSequence="FirstToLast">
            </toolkit:ColumnSeries>

        </toolkit:Chart> 
```

这是我正在尝试实现的一些测试代码：

```
private void OrionWebService_ChartComilerCompleted(object sender, ChartCompilerCompletedEventArgs e)
  {
     List<ChartClass> mytest = new List<ChartClass>();
     mytest.Add(new ChartClass
                   {
                      Date = Convert.ToDateTime("01/01/2013 12:00:00 PM"),
                      Orion = 3.0,
                      AccessCard = 4.0,
                      TimeKeeper = 6.0
                   });

     mytest.Add(new ChartClass
                   {
                      Date = Convert.ToDateTime("01/02/2013 12:00:00 PM"),
                      Orion = 6.0,
                      AccessCard = 4.0,
                      TimeKeeper = 8.0
                   });

     ((ColumnSeries)myChart.Series[0]).ItemsSource = mytest;
     BusyIndicator.IsBusy = false;
  } 
```

图表类

```
 public class ChartClass
   {
      public DateTime Date { get; set; }
      public double Orion { get; set; }
      public double AccessCard { get; set; }
      public double TimeKeeper { get; set; }
   } 
```

现在我只是通过一些测试数据，最终虽然我试图在日期范围内的每一天实现一个具有 3 个垂直列的图表。类似于下图：

![我希望我的图表看起来像什么](../Images/11426c3dcdfeba235aa559e7993548e1.png)

出于某种原因，尽管当控件加载时，除了一个 Labeled Orion 之外，它没有填充任何列的任何数据。如果我从 xaml 中删除 Orion 系列并仅定义 TimeKeeper 和 AccessCard，则 TimeKeeper 系列可以工作但不显示 AccessCard 数据。它似乎只绑定到第一个定义的系列，而忽略了图表中所有其他系列的绑定。silverlight 工具包是否不支持我正在尝试做的事情？

谁能帮助我？或者至少为我指出一个例子的方向。我似乎找不到我所做的任何错误。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:15:18.353

抱歉，我发现问题是在 Code behind 中引起的，因为我只定义了 series[0] 的项目源，而不是其他项目源。使用以下代码解决了问题：

```
((ColumnSeries)myChart.Series[0]).ItemsSource = mytest;
((ColumnSeries)myChart.Series[1]).ItemsSource = mytest;
((ColumnSeries)myChart.Series[2]).ItemsSource = mytest; 
```

不漂亮，但我的图表现在工作正常

# php - 测试通过，无法在浏览器中运行

> ID：14199153
> 
> 赞同：1
> 
> 时间：2013-01-07T15:41:27.260
> 
> 标签：php, arrays, unit-testing, mongodb, array-difference

我正在使用 mongo 数据库和 PHP 将文件元信息与文件目录进行比较，以查看丢失的位置。然后，我们返回一个文件和数据库的关联数组，以查看丢失的内容和丢失的位置。

**注意：**你不需要知道 mongo 来帮助我。

例如，如果我从目录中删除一个文件，但数据库中有一个条目，我的数组将如下所示：

```
array(2) {
  'File System' =>
  array(1) {
    [0] =>
    string(28) "50e72bce045aca4c04000004.txt"
  }
  'Database' =>
  array(0) {
  }
} 
```

此检查的代码如下：

```
public function compareDatabaseToDirectory(){
    // Fetch all file meta information
    $files = $this->_model->fetchAll(array());

    // Create a file based on id and extension.
    foreach($files as $id=>$model){
       $dataBaseEntries[] = $id . $model->fileExtension;
    }

    // Get all files in our directory
    $directoryFiles = preg_grep('/^([^.])/', scandir($this->getDestination()));

    // Get the differneces of files
    $differences = array_diff($dataBaseEntries, $directoryFiles);

    // Check if missing from database OR missing from file system
    $missingFromDataBase = array_diff($differences, $dataBaseEntries);
    $missingFromFileSystem = array_diff($differences, $directoryFiles);

    // Create an associative array
    $filesMissing = array(
          'File System' => $missingFromFileSystem,
          'Database' => $missingFromDataBase
   );

   // Return results.
   return $filesMissing;
} 
```

这里所做的一切都是使用 mongo id 并将其附加到文件扩展名以创建所述文件。

我们将文件数组与文件目录中的文件数组进行比较并返回差异。

在我的测试中，我们所做的只是：

```
public function testComapreDatabaseToFileSystemMissingFile(){
    $this->resetNoSqlDatabase();

    unlink(APPLICATION_PATH . '/data/uploadedFiles/testing/50e72bce045aca4c04000004.txt');
    $result = $this->_file->compareDatabaseToDirectory();

    $expectedArray = array(
        'File System' => array(
            '50e72bce045aca4c04000004.txt'  
        ),
        'Database' => array(),                      
    );

    $this->assertEquals($result, $expectedArray);

} 
```

这将返回您在上面看到的数组。但是，如果我在浏览器中复制相同的概念，我上面看到的数组在不应该是空的时候是空的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:27:09.300

这是一个文件夹权限问题。我们在将文件夹设置为 0777 之前创建了文件夹。

# c - 使用 fscanf 读取 C 中的多个值

> ID：14199155
> 
> 赞同：0
> 
> 时间：2013-01-07T15:41:39.097
> 
> 标签：c, scanf

从以下格式的文本文件：

```
Name Surname ID Address
Name Surname ID Address
Name Surname ID Address 
```

我需要提取每一个并将其放入一个变量中。

我尝试了以下两种方法：

```
while(fscanf(fp, "%s,%s,%d,%s\n", name2,surname2,&id2,address2) != EOF){
    printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        &name2, &surname2, &id2, &address2);
} 
```

这给了我错误的结果，它每行只读取一个单词，所以结果是这样的：

```
姓名：姓名 姓氏：@，身份证号：2272012 地址：？”
姓名：姓 姓：@，身份证：2272012 地址：？”
姓名：ID 姓氏：@，a ID：2272012 地址：？”
姓名：地址姓氏：@，ID：2272012 地址：？”

```

我使用的另一种方法是：

```
while(fscanf(fp, "%s,%s,%d,%s\n", name2,surname2,&id2,address2) == 4){
    printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        &name2, &surname2, &id2, &address2);
} 
```

什么也没读，什么也没发生。

我正在读取的文件是 .dat，它用于分配，因此只能使用 .dat。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:04:10.213

您声明您的文本文件采用以下格式：

```
string<space>string<space>numeric<space>string<newline> 
```

如果这是准确的，您的格式字符串必须完全匹配：

```
strings
 |  |  numeric
 |  |  |  +-----string
 |  |  |  | +---newline
 V  V  V  V V
"%s %s %d %s\n"
   ^  ^  ^
   |  |  |
   spaces 
```

这假设每个`string`字段都是一个 ASCII 值块，没有空格/制表符等。您的代码缺少变量的定义方式，大概是这样的：

```
char name2[100] = {0};
char surname2[100] = {0};
int id2 = 0;
char address2[100] = {0}; 
```

在这种情况下，您不需要在字符串`&`中将这些名称放在前面。`fscanf`所以给定一个输入文件：

> 首先是1234
> someone@something.com 秒，但 22352 goo@gle.com
> 三是哈哈 9999 nice@lly.com

以及上面的变量声明，如下代码：

```
FILE * fp;
fp = fopen("test.txt", "r");
while(fscanf(fp, "%s %s %d %s\n", name2, surname2, &id2, address2) == 4) 
    printf("name: %s %s, id: %d, address %s\n", name2, surname2, id2, address2);

fclose(fp); 
```

正确读取/显示值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T15:45:23.487

*   格式字符串中不应该有逗号，除非数据中有逗号，但您没有显示。
*   如果任何字段包含空格，这将不起作用，因为`%s`将停止。
*   您需要显示更多输入 .dat 文件。
*   使用 阅读整行通常会更好`fgets()`，*然后再*担心解析它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T15:46:03.003

首先，`&`从变量中删除`printf`

```
printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        name2, surname2, id2, address2); 
```

如果输入 txt 文件中字段之间的分隔符是逗号`,`

```
Name,Surname , ID ,Address
Name ,Surname,ID,Address
Name,Surname,ID,Address 
```

然后在`fscanf`

```
while(fscanf(fp, " %[^, ] , %[^, ] , %d , %[^\n]", name2,surname2,&id2,address2) != EOF){
    printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        name2, surname2, id2, address2);
} 
```

如果输入 txt 文件中字段之间的分隔符是空格

```
Name Surname ID Address
Name Surname ID Address
Name Surname ID Address 
```

然后在`fscanf`

```
while(fscanf(fp, " %s %s %d %[^\n]", name2,surname2,&id2,address2) != EOF){
    printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        name2, surname2, id2, address2);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T15:46:24.143

```
while(fscanf(fp, "%s,%s,%d,%s\n", name2,surname2,&id2,address2) != EOF){
    printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        &name2, &surname2, &id2, &address2);
} 
```

我认为这是错误所在：

它应该是：

```
while(fscanf(fp, "%s,%s,%d,%s\n", name2,surname2,&id2,address2) != EOF){
    printf("Name: %s, Surname: %s, ID: %d, Address: %s\n",
        name2, surname2, id2, address2);
} 
```

# mpmovieplayercontroller - MPMoviePlayer 加载视频但从未 进入 readyToPlay 状态

> ID：14199159
> 
> 赞同：0
> 
> 时间：2013-01-07T15:41:51.500
> 
> 标签：mpmovieplayercontroller, 3gp

我一直在尝试使用 MPMoviePlayerController 播放视频大约一周，但收效甚微！我终于把它带到了加载视频的阶段（或者至少我认为它可以告诉我视频持续时间）。

但是，我的视频永远无法播放，因此我只看到了一个黑色方块。

我的代码如下：

```
 - (void)loadMovieWithURL:(NSURL *)movieURL
{
    NSLog( @"Video URL = '%@'", [movieURL path]);
    NSData *data = [NSData dataWithContentsOfURL:movieURL];
    [[NSNotificationCenter defaultCenter] addObserver:self  selector:@selector(moviePlayerPlaybackStateDidChange:)  name:MPMoviePlayerPlaybackStateDidChangeNotification  object:nil];

    MPMoviePlayerController *mp = [[MPMoviePlayerController alloc] init];
    self.moviePlayer = mp;
    [self.moviePlayer.view setFrame:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
    [self addSubview:self.moviePlayer.view];
    [self.moviePlayer setContentURL:movieURL];
    self.moviePlayer.movieSourceType = MPMovieSourceTypeFile;

    [self.moviePlayer setFullscreen:NO];
    [self.moviePlayer setScalingMode:MPMovieScalingModeFill];
    [self.moviePlayer setControlStyle:MPMovieControlStyleNone];

    //[self.moviePlayer setShouldAutoplay:YES];

    [self.moviePlayer prepareToPlay];
    [self.moviePlayer play];

} 
```

我将很多值打印到 NSLog 只是为了检查它们，所以我想我也应该在下面提供它们，以便更好地了解我所看到的内容：

```
2013-01-07 15:33:39.858 WildMap_iOS[9887:16703] Video URL = '/Users/elliott/Library/Application Support/iPhone Simulator/6.0/Applications/A233395A-3E8F-4E35-BF42-09D9B743EA33/test.3gp'
    2013-01-07 15:33:40.100 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Disabling autoplay for pause
    2013-01-07 15:33:40.101 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Disabling autoplay
    2013-01-07 15:33:40.176 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Enabling autoplay
    2013-01-07 15:33:40.179 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Likely to keep up or full buffer: 0
    2013-01-07 15:33:40.180 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
    2013-01-07 15:33:40.181 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Likely to keep up or full buffer: 0
    2013-01-07 15:33:40.182 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
    2013-01-07 15:33:40.259 WildMap_iOS[9887:16703] [MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
    2013-01-07 15:33:40.401 WildMap_iOS[9887:16703] [MPAVController] Autoplay: Enabling autoplay
    2013-01-07 15:33:41.344 WildMap_iOS[9887:16703] Is ready to display 0
    2013-01-07 15:33:41.344 WildMap_iOS[9887:16703] Duration: 45.267000 
```

我确实设置了一个通知来检查 MPMoviePlayerLoadStateDidChangeNotification 但它永远不会改变。有没有人遇到过类似的问题，或者知道我的代码有什么问题？如果您需要更多信息，请随时询问。

编辑 1（测试 danh 的代码）

使用以下内容时：

```
 NSLog( @"Video URL = '%@'", [movieURL path]);
self.moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:movieURL];
self.moviePlayer.view.frame = self.bounds;
[self addSubview:self.moviePlayer.view];
[self.moviePlayer prepareToPlay];

//NSData *data = [NSData dataWithContentsOfURL:movieURL];
[[NSNotificationCenter defaultCenter] addObserver:self  selector:@selector(moviePlayerPlaybackStateDidChange:)  name:MPMoviePlayerPlaybackStateDidChangeNotification  object:nil];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlayerLoadStateChanged:)
                                             name:MPMoviePlayerLoadStateDidChangeNotification object:nil]; 
```

我的日志是：

```
2013-01-08 12:08:16.105 WildMap_iOS[705:16703] [MPAVController] Autoplay: Disabling autoplay for pause
2013-01-08 12:08:16.105 WildMap_iOS[705:16703] [MPAVController] Autoplay: Disabling autoplay
2013-01-08 12:08:16.138 WildMap_iOS[705:16703] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2013-01-08 12:08:16.144 WildMap_iOS[705:16703] [MPAVController] Autoplay: Enabling autoplay
2013-01-08 12:08:16.153 WildMap_iOS[705:16703] [MPAVController] Autoplay: Likely to keep up or full buffer: 0
2013-01-08 12:08:16.153 WildMap_iOS[705:16703] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
2013-01-08 12:08:16.157 WildMap_iOS[705:16703] [MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
2013-01-08 12:08:16.177 WildMap_iOS[705:16703] [MPAVController] Autoplay: Enabling autoplay
2013-01-08 12:08:17.244 WildMap_iOS[705:16703] Is ready to display 0
2013-01-08 12:08:17.244 WildMap_iOS[705:16703] Duration: 45.267000 
```

所以它似乎与从不调用moviePlayerLoadStateChanged的原始代码相同。但是，我仍然对 MPMoviePlayerController 无法加载视频时如何获取视频的持续时间感到困惑？这可能是编解码器问题吗？有什么方法可以检查视频下载后是否可以正常播放？

编辑2：

好的，这看起来像是一个可能的编解码器问题。我现在用 2 个类似的 URL 进行了尝试，1 mov / 1 3gp，mov 一个会播放声音但没有视频，而 3gp 会在视频屏幕上短暂显示“正在加载”，但当它消失时永远不会变为加载状态。任何人都可以建议一种使其正常工作的方法，或其他支持更多类型的电影播放器​​吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:50:04.363

尝试用以下代码替换所有设置代码：

```
// get the url as moveURL
self.moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:movieURL];
self.moviePlayer.view.frame = self.view.bounds;
[self.view addSubview:self.moviePlayer.view];
[self.moviePlayer prepareToPlay];

// notice what notification we subscribe to...
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlayerLoadStateChanged:)
                                             name:MPMoviePlayerLoadStateDidChangeNotification object:nil]; 
```

在 moviePlayerLoadStateChanged: 中记录状态更改。如果这不起作用，则可能是 url 的问题。

# javascript - 谷歌地图制作的游戏：标记循环、标记图像变换和交叉表

> ID：14199161
> 
> 赞同：1
> 
> 时间：2013-01-07T15:41:51.190
> 
> 标签：javascript, google-maps-api-3, google-maps-markers

我正在努力在google maps api v3中获得一个小游戏，一个简单的“Drag'n'drop”标记（浪费）放入正确的容器（所以另一个标记）。

这是我到目前为止所做的[http://www.nadersafwan.site90.net/minijeu.html](http://www.nadersafwan.site90.net/minijeu.html)

这是我的成就：我设法将所有地图参数用于创建点、8 个固定点和 1 个可拖动点，为我的可拖动标记设置随机位置，我设置了超时和点，...

我现在想要的是创建一种循环，它清除旧标记（具有已定义的属性）并显示另一个标记（具有他自己的图像和名称）：每次这些变量在两者（移动和固定标记）和一定距离。

所以我需要： 1 - 一个函数，它表示距离为 XY px 并且标记的类型是否相同，然后创建一个循环，清除旧的标记属性并提供具有新属性的新标记

2 - 设计随机类型的废物并将相关属性（图像和名称）提供给可拖动标记的功能

我有什么： 1 - 标记之间的距离（欧几里得距离）：

```
google.maps.event.addListener(marker, 'dragend', function() {  
    for (var i = 0; i < point_tab.length; i++) {
        if (i in point_tab) {
            var d = point_tab[i];
            var dlat = d.coords.lat();
            var dlng = d.coords.lng();
            var dist = Math.sqrt( Math.pow(lat - dlat, 2) + Math.pow(lng - dlng, 2) );
            console.log(dist);
            for (i in types_dechets) {marker.setIcon(point_tab[i].image)}
                if (dist < 0.01) {
            alert("youpie");
                clearOverlays();
                marker.setMap(map);
            }
        }
}
if (dechetterie_trouvee == false) {
    alert("pollueur");
    }  
} 
```

我在这里需要的只是在'point_tab'数组中添加一个变量对抗，在dragableMarker的值和已经定义为“point_tab [n] .nom”变量的fixMarkers之间。在这里，我使用“clearoverlays()”函数来清除标记，但是“marker.setMap(map)”只给了我一次不同的图像，我希望每次我的标记被清除时它都会改变

2 - 对于随机废物类型选择，我尝试了这个：

```
for (n in point_tab) {
var random_type_dechet = function() {
    var randomIndex = Math.floor(Math.random() * point_tab[n].length);
return point_tab[randomIndex].image;
}
} 
```

我不太了解这一点，但是它可能会随机改变“point_tab”数组中的浪费类型，可能是用前面的脚本实现以获得不同的可拖动标记？

# javascript - kinetic.js 循环中的多次点击事件，但只注册最后一个

> ID：14199165
> 
> 赞同：0
> 
> 时间：2013-01-07T15:42:13.433
> 
> 标签：javascript, html, audio, canvas, kineticjs

我有这个代码：

```
var load_image = function( src ){
    var img = new Image();
    img.src = src;
    return img;
};

var stage = new Kinetic.Stage({container: 'main', width: 640, height: 480});
var layer = new Kinetic.Layer();

var setup = {
    kick : {
        sound: 'kick',
        image_config : {
            image : load_image( '/images/bass.png' ),
            x : 250,
            y : 50
        }
    },
    snare : {
        sound: 'snare',
        image_config : {
            image : load_image( '/images/snare.png' ),
            x : 220,
            y : 220
        }
    },
    hats : {
        sound: 'hats',
        image_config : {
            image : load_image( '/images/hi-hat.png' ),
            x : 140,
            y : 150
        }
    }
};

var img;

for ( name in setup )
{
    img = new Kinetic.Image( setup[name].image_config );

    img.on('click', function()
    {
        soundManager.play( setup[name].sound );
    });

    img.createImageHitRegion(function()
    {
        layer.drawHit();
    },true);

    layer.add(img);
}

stage.add(layer); 
```

这就是问题所在。对于设置对象中的每个属性，我想为其添加一个单击事件。（如上所示）

```
img.on('click', function()
{
    soundManager.play( setup[name].sound );
}); 
```

所以当kick 被踢时，它触发kick 声音，当snare 被点击它触发snare 声音等等......每个setup 属性中的sound 属性描述了应该播放的声音。

问题是，所有点击事件都会触发“帽子”声音。我发现这是因为“帽子”属性是设置对象中的最后一个。

我究竟做错了什么？是因为回调吗？

如果您访问[此处，](http://id.a3mediauk.com/v2/)您将看到一个示例。

另外，在这个例子中，如果你双击，它只会触发一次声音，当它应该触发两次时！那是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:55:09.153

我认为是这样的：将 var 从 for 循环外部移动到 for 循环内部。因为`var img`使它成为您在每次循环运行时重新定义的单个变量，所以它只保留了最后一个设置。

相反，您需要添加一些本地范围，以便函数不会在每次循环运行时重新写入变量。尝试在循环内创建一个局部变量，如下所示

```
for ( name in setup )
{
    var newImg = new Kinetic.Image( setup[name].image_config );

    newImg.on('click', function()    
    {
        soundManager.play( setup[name].sound );
    });

    newImg.createImageHitRegion(function()
    {
        layer.drawHit();
    },true);

    layer.add(newImg);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T08:31:42.867

我找到了解决方案。我没有在点击回调事件中引用，而是`setup[name].sound`将图像名称属性设置为名称，然后使用传递给函数的鼠标事件获取名称，如下所示：

变量 img;

```
for ( name in setup )
{
    img = new Kinetic.Image( setup[name].image_config );

    img.attrs.name = name;

    img.on('click', function(i)
    {
        soundManager.play( i.shape.attrs.name );
    });

    img.createImageHitRegion(function()
    {
       layer.drawHit();
    },true);

    layer.add(img);
} 
```

# objective-c - CoreData 值意外更改

> ID：14199167
> 
> 赞同：0
> 
> 时间：2013-01-07T15:42:18.210
> 
> 标签：objective-c, core-data

当我不打算改变核心数据值时，我遇到了问题。我有一个关于如何修复它的想法，但每次我这样做时，我都会得到无法识别的选择器。我的想法是更改`valueArray = attribute.values;`为`valueArray = [NSArray arrayWithArray:attribute.values];`任何帮助将不胜感激。

编辑：我正在尝试创建attribute.values 的总和。我有技能节点，每个节点都有属性，有时这些属性值是不同的。我试图总结所有类似的价值观。

```
 Build *selectedBuild = [buildListController selectedObjects][0];
    NSMutableDictionary *attributeAggregator = nil;
    attributeAggregator = [NSMutableDictionary dictionary];
    NSLog(@"Before: %@", attributeAggregator);
    NSMutableDictionary *numValues = [NSMutableDictionary dictionary];
    NSArray *valueArray = nil;

    for (SkillNode *active in selectedBuild.activeNodes) {
        for (Attribute *attribute in active.attributes) {
            NSString *attrName = attribute.name;
            NSLog(@"%@ %@", attribute.name, attribute.values);
            NSMutableArray *obj = [attributeAggregator objectForKey:attribute.name];
            if (obj) {
                for (int ndx = 0; ndx < [obj count]; ndx++) {
                    obj[ndx] = [NSNumber numberWithFloat:([obj[ndx] integerValue] + [attribute.values[ndx] integerValue])];
                }
                [attributeAggregator setValue:obj forKey:attrName];
            } else {
                valueArray = attribute.values;
                [attributeAggregator setValue:valueArray forKey:attrName];
                [numValues setValue:attribute.numValues forKey:attrName];
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:45:49.613

与其在将 attribute.values 添加到字典之前将其放入 NSArray 中，不如简单地将 attributes.values 添加到字典中？

这就是我所说的：

```
...
valueArray = attribute.values;
[attributeAggregator setValue:valueArray forKey:attrName];
... 
```

将其更改为：

```
...
[attributeAggregator setValue:attribute.values forKey:attrName];
... 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T00:22:07.493

我通过制作 attribute.values 的 mutableCopy 并将其存储在字典中来解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T01:09:08.287

这段代码很吓人。

```
if (obj) {
    for (int ndx = 0; ndx < [obj count]; ndx++) {
        obj[ndx] = [NSNumber numberWithFloat:([obj[ndx] integerValue] + [attribute.values[ndx] integerValue])];
    }
[attributeAggregator setValue:obj forKey:attrName]; 
```

您正在迭代`obj`并同时对其进行变异，这很危险且令人不快。这就是为什么当你这样做时，循环的快速枚举甚至不编译。

检查使用[KVC 集合运算符](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/CollectionOperators.html#//apple_ref/doc/uid/20002176-BAJEAIEE)来得到你的总和，我不清楚你的数据结构是什么来告诉你如何，但是看看文档，特别是`@sum`

**回复：评论**

好的，我绝对不清楚你到底在做什么。收款操作员不会在这里为您提供帮助。但是，当你迭代它时，我仍然不会改变数组。我可能只是将这两个数组添加到一个新数组中，然后在完成后将结果数组设置在您想要的位置。使用第三个结果数组对两个数组求和的示例...

```
NSArray *foo = @[@1, @2, @3];
NSArray *bar = @[@4, @5, @6];

NSMutableArray *result = [NSMutableArray arrayWithCapacity:[foo count]];

[foo enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
   result[idx] = [NSNumber numberWithInt:[obj integerValue] + [bar[idx] integerValue]];
}];

// result == @[@5, @7, @9] 
```

# python - 合并熊猫中的数据框时的组合爆炸

> ID：14199168
> 
> 赞同：8
> 
> 时间：2013-01-07T15:42:28.707
> 
> 标签：python, numpy, scipy, pandas

我正在尝试在熊猫中合并一系列数据框。我有一个 dfs`dfs`列表，以及它们相应标签的列表，`labels`我想将所有 dfs 合并到 1 个 df 中，以便 df 中的公共标签从`labels`列表中的标签中获取后缀。IE：

```
def mymerge(dfs, labels):
  labels_dict = dict([(d, l) for d, l in zip(dfs, labels)])
  merged_df = reduce(lambda x, y:
                     pandas.merge(x, y, 
                                  suffixes=[labels_dict[x], labels_dict[y]]),
                     dfs)
  return merged_df 
```

当我尝试这个时，我得到了错误：

```
pandas.tools.merge.MergeError: Combinatorial explosion! (boom) 
```

我正在尝试进行一系列合并，每次合并时最多增长 N 列，其中 N 是列表中“下一个”df 中的列数。最终的 DF 应该有与所有 df 列加在一起一样多的列，因此它会累加增长而不是组合。

我正在寻找的行为是：在指定的列名上加入 dfs（例如由 指定`on=`）或 dfs 被索引的列名。联合不常见的列名（如在外部连接中）。如果一列出现在多个 dfs 中，可选择覆盖它。更多地查看文档，听起来`update`可能是最好的方法。虽然当我尝试时`join='outer'`它会引发一个异常，表明它没有实现。

**编辑**：

这是我对此的实现尝试，它不处理后缀，但说明了我正在寻找的合并类型：

```
def my_merge(dfs_list, on):
    """ list of dfs, columns to merge on. """
    my_df = dfs_list[0]
    for right_df in dfs_list[1:]:
        # Only put the columns from the right df
        # that are not in the existing combined df (i.e. new)
        # or which are part of the columns to join on
        new_noncommon_cols = [c for c in right_df \
                              if (c not in my_df.columns) or \
                                 (c in on)]
        my_df = pandas.merge(my_df,
                             right_df[new_noncommon_cols],
                             left_index=True,
                             right_index=True,
                             how="outer",
                             on=on)
    return my_df 
```

这假设合并发生在每个 dfs 的索引上。新列以外部连接样式添加，但常见的列（而不是索引的一部分）通过`on=`关键字在连接中使用。

例子：

```
df1 = pandas.DataFrame([{"employee": "bob",
                         "gender": "male",
                         "bob_id1": "a"},
                        {"employee": "john",
                         "gender": "male",
                         "john_id1": "x"}])
df1 = df1.set_index("employee")
df2 = pandas.DataFrame([{"employee": "mary",
                         "gender": "female",
                         "mary_id1": "c"},
                        {"employee": "bob",
                         "gender": "male",
                         "bob_id2": "b"}])
df2 = df2.set_index("employee")
df3 = pandas.DataFrame([{"employee": "mary",
                         "gender": "female",
                         "mary_id2": "d"}])
df3 = df3.set_index("employee")
merged = my_merge([df1, df2, df3], on=["gender"])
print "MERGED: "
print merged 
```

对此的扭曲将是您根据一组常见列的标签任意标记每个 df 的后缀，但这并不重要。上述合并操作是否可以在 pandas 中更优雅地完成，或者已经作为内置函数存在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T17:40:00.213

您的方法的输出：

```
In [29]: merged
Out[29]: 
         bob_id1  gender john_id1 bob_id2 mary_id1 mary_id2
employee                                                   
bob            a    male      NaN       b      NaN      NaN
john         NaN    male        x     NaN      NaN      NaN
mary         NaN  female      NaN     NaN        c        d 
```

内置 pandas 的解决方案[`df.combine_first`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html?highlight=combine_first#pandas.DataFrame.combine_first)：

```
In [28]: reduce(lambda x,y: x.combine_first(y), [df1, df2, df3])
Out[28]: 
         bob_id1 bob_id2  gender john_id1 mary_id1 mary_id2
employee                                                   
bob            a       b    male      NaN      NaN      NaN
john         NaN     NaN    male        x      NaN      NaN
mary         NaN     NaN  female      NaN        c        d 
```

要为每一帧的列添加后缀，我建议在调用`combine_first`.

另一方面，您可能想要查看类似 的操作`pd.concat([df1, df2, df3], keys=['d1', 'd2', 'd3'], axis=1)`，它会生成一个带有 MultiIndex 列的数据框。在这种情况下，可能要考虑将性别作为索引的一部分，或者忍受它的重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T21:19:52.977

从源代码：

```
max_groups = 1L
for x in group_sizes:
    max_groups *= long(x)

if max_groups > 2**63:  # pragma: no cover
    raise Exception('Combinatorial explosion! (boom)') 
```

而且，在[同一个文件中](https://code.google.com/p/pythonxy/source/browse/src/python/pandas/PLATLIB/pandas/tools/merge.py?repo=xy-27&r=f2b689fd6745c956cf9801c6cf6598707d158846)

```
# max groups = largest possible number of distinct groups
left_key, right_key, max_groups = self._get_group_keys() 
```

这条线`max_groups *= long(x)`表明它不是附加的，因此很关键。

# javascript - Eclipse 大纲中缺少 jsDoc 的 JavaScript 闭包函数

> ID：14199170
> 
> 赞同：3
> 
> 时间：2013-01-07T15:42:34.150
> 
> 标签：javascript, eclipse, jsdt

我在使用 JSDT 1.4.1 在 Eclipse 4.2 中概述 JavaScript 文件时遇到了一个奇怪的问题。我有一个这样定义的闭包：

```
var myClosure = (function() {
    var calcGridLocation,
        detectCollision;

    /**
     * Calculate the grid cell coordinates from the offset of an element and the editorgrid offset
     *
     * @param {jQuery object} obj jQuery object of the object whose location will be calculated
     * @param {String} [subgrid=""] Specify the currently active subgrid
     * @returns {Object} Coordinate object with x, y and obj properties, obj hols a jQuery object of the target cell, null for locations outside the editorgrid
     * @memberOf myClosure
     */
    calcGridLocation = function(obj, subgrid) {
        var gridOffset,     // Offset (relative to document) of the editorgrid
            objOffset,      // Offset (relative to document) of the provided object
            rv = {};        // Return value object

        if(subgrid === null || subgrid === undefined) {
            subgrid = "";
            // Get the grid's offset
            gridOffset = $("#editorgrid").offset();
        }
        else {
            // Get the grid's offset
            gridOffset = $("#" + subgrid).offset();

            subgrid += "_";
        }

        // Get the object's offset
        objOffset = obj.offset();

        // Calculate the grid coordinates of the object
        if(objOffset === undefined || gridOffset === undefined) {
            debugger;
        }
        rv.x = Math.floor((objOffset.left - gridOffset.left) / cellSize);
        rv.y = Math.floor((objOffset.top - gridOffset.top) / cellSize);

        // Check if the location is a valid grid location
        if(rv.x >= 0 && rv.x < tblCellCount && rv.y >= 0 && rv.y < tblRowCount) {
            if(obj.hasClass("gridCell")) {
                rv.obj = obj;
            }
            else {
                // Get the grid cell object and return the return value object
                rv.obj = $("#" + subgrid + "c_" + rv.y + "_" + rv.x);
            }

            return rv;
        }
        else {
            // Return null, no valid grid location
            return null;
        }
    }; //calcGridLocation = function()

    /**
     * Detect a collision of an object with other dragboxes
     *
     * @param {jQuery object} obj Object to check for collisions
     * @returns {Object} Object with collision, obstacle, shift.x and shift.y attributes
     * @memberOf myClosure
     */
    detectCollision = function(obj) {
        // Some code here
    }; //detectCollision = function()
})(); 
```

经过一番研究，我发现我需要 jsDoc 注释才能使函数显示在 Eclipse 中。第一个功能出现，但第二个没有。它只是没有列出。

真正奇怪的是：如果我完全删除第一个函数的内容，第二个函数就会正常显示。我的语法中是否有一些错误会导致这种行为？当我在浏览器（谷歌浏览器）中测试我的项目并通过 jsLint 验证时，完整的脚本工作正常（除了一些我不接受 jsLint 编写代码的方式）。

## 附加信息

Eclipse 没有展示这个闭包的几个功能，上面只是一个最小的例子。“丢失”的功能似乎很随机，有时会丢失一个，有时会连续丢失几个。在大纲中显示的缺失函数之间还有一些函数，如下所示：显示，显示，丢失，显示，丢失，丢失，......
我仔细检查了每个函数都有`@memberOf`jsDoc 注释，这应该使它在大纲。
缺少的功能不会被编辑器识别为功能块，因此我无法折叠它们（显示的功能可以折叠）。从函数中删除内容会`calcGridLocation`启用函数的代码折叠`detectCollision`。

# c# - 管理这种依赖关系的另一种方法

> ID：14199174
> 
> 赞同：3
> 
> 时间：2013-01-07T15:42:41.593
> 
> 标签：c#, dependency-injection, ninject

我有一个小类，每次需要它时都会创建一个数据处理器对象的新实例。我对所有事情都使用了注入，但我无法弄清楚如何在`IDataProcessingService`不注入`kernel`.

有一个更好的方法吗。我知道我可以制作一个静态网关而不是注入，但我认为在不同的皮肤中这是同样的问题。

```
public class DataProcessingManager
{
    private readonly Dictionary<IDataProcessingRequest, IDataProcessingService> _activeProcessingServices;

    private readonly IKernel _kernel;

    public DataProcessingManager(IKernel kernel)
    {
        _kernel = kernel;
        _activeProcessingServices = new Dictionary<IDataProcessingRequest, IDataProcessingService>(new DataProcessingRequestComparer());
    }

    public void ProcessFor(IDataProcessingRequest dataProcessingRequest)
    {
        if (!_activeProcessingServices.ContainsKey(dataProcessingRequest))
        {
            var _processingService = _kernel.Get<IDataProcessingService>();
            _activeProcessingServices.Add(dataProcessingRequest, _processingService);

            _processingService.ProcessingFinished += 
                (sender, args) => _activeProcessingServices.Remove(dataProcessingRequest);

            _processingService.Process(dataProcessingRequest);
        }
    }
} 
```

编辑 2：

我不得不更改接受的答案，因为最初建议的实现不是创建我需要的新实例。我知道我可以通过引用内核来使用原始答案，但这也不是我想要的。最后，`.ToFactory()`新答案中的约定是更好的方法。

我将联系扩展的作者并要求他更新代码示例，因为`Foo..Bar`示例难以阅读。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:32:17.340

如果每次都想要一个新实例，可以使用[Ninject Factory Extension](https://github.com/ninject/ninject.extensions.factory/wiki)来不依赖 IKernel。

使用此扩展，您可以创建工厂接口来创建 IDataProcessingService 的实例，但您不需要实现该接口。这个扩展可以为你实现它（它会在后台调用 IKernel）。

出厂界面...

```
public interface IDataProcessingServiceFactory
{
    IDataProcessingService Create();
} 
```

绑定语句（在运行时自动生成工厂实现）...

```
kernel.Bind<IDataProcessingServiceFactory>().ToFactory(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:50:51.497

如果您不想“依赖” `IKernel`，您可以创建第二个接口来提供服务：

```
interface IDataProcessingServiceProvider
{
    IDataProcessingService GetService();
} 
```

然后，您可以让您的内核实现该接口并将其存根以进行测试，而无需实现整个 IKernel 接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:08:57.310

普遍的[共识](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)是，让应用程序逻辑依赖于容器或容器抽象是不好的。但是，让基础设施组件依赖于容器[是可以](http://blog.ploeh.dk/2011/08/25/ServiceLocatorRolesVsMechanics.aspx)的。

但是，请尽量避免将应用程序逻辑与基础架构逻辑混在一起。诀窍通常是以一种可以是纯应用程序或纯基础设施的方式提取类。

# wikipedia-api - MediaWiki API 查询多个标题的图像

> ID：14199176
> 
> 赞同：3
> 
> 时间：2013-01-07T15:42:42.073
> 
> 标签：wikipedia-api, mediawiki-api

当我要求 MediaWiki API 为每个标题提供图像时，它只返回第一个指定标题的图像。例如，查询：

> [http://en.wikipedia.org/w/api.php?format=jsonfm&action=query&titles=Id%20Software|Doom%203|Wolfenstein%203D|Quake%20II|John%20D.%20Carmack|John%20Romero|Doom %20(video%20game)|Quake%20(video%20game)|Commander%20Keen|Rage%20(video%20game)&prop=info|images](http://en.wikipedia.org/w/api.php?format=jsonfm&action=query&titles=Id%20Software|Doom%203|Wolfenstein%203D|Quake%20II|John%20D.%20Carmack|John%20Romero|Doom%20(video%20game)|Quake%20(video%20game)|Commander%20Keen|Rage%20(video%20game)&prop=info|images)

返回每个页面的信息，但仅返回第一页的图像。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:36:49.177

因为它只是结果的第一页，请注意`query-continue`底部的 。要获得第二页，您需要使用`query-continue`添加的内容重复您的查询（例如，类似的内容`&imcontinue=15526|Doom_ingame_1.png`）。

但更好的解决方案是通过添加`&imlimit=max`. 在这种情况下，这意味着所有结果都适合一页，但情况并非总是如此。

如果您使用某种库（取决于您使用的语言）可能会更好，它可以自动为您处理分页。

# c# - 将 json 数组中的单个项目发布到 .net 对象

> ID：14199177
> 
> 赞同：1
> 
> 时间：2013-01-07T15:42:55.133
> 
> 标签：c#, .net, json

我在 .net 中有一个对象，主要用于接收一些 json。它通常工作得很好，但是当数字数组中有单个项目时，json 库会将其转换为单个数字，而不是具有单个项目的数组。.net 将其作为错误抛出，因为它是单个 int32 而不是 int32 数组我尝试转换为 json.net 但这并不奇怪同样的错误

据我所知，没有办法在我的对象中有替代定义，有吗？

下面是我的对象的定义

```
public class EnquiryModel
{
    public string Name;
    public string Email;
    public string Phone;
    public string JobCode;
    public string Message;
    public int ReferralSource;
    public Dictionary<string, int> PickList;
    public int[] Studios;
    public int[] Services;
    public string[] BookingEnquiries;
} 
```

这是我用来填充它的代码

```
using Newtonsoft.Json;
EnquiryModel enq = JsonConvert.DeserializeObject<EnquiryModel>(json); 
```

以前我用过

```
using System.Web.Script.Serialization;
JavaScriptSerializer j = new JavaScriptSerializer();
EnquiryModel enq = j.Deserialize<EnquiryModel>(json); 
```

它们都产生相同的错误

不知道避免这个问题的最佳方法是什么

当它在客户端上序列化时，具有单个项目的数组被转换为单个数字，不知道为什么会这样:)？

已解决已更新

标记为以下解决方案的答案非常有效 - 谢谢:)

我必须做一些我认为值得分享的微小改变

首先我发现它是作为 Int64 传递的，所以我的检查是针对两种类型的 or

我也有一些使用这个对象的代码，因为公共变量不再是一个数组而是一个对象，所以我必须在用法中添加一个强制转换：

```
foreach (int studio in enq.Studios) 
```

不得不改为

```
foreach (int studio in (Int32[])enq.Studios) 
```

这是对象的完整来源，如果有某种方法可以概括重复的代码以使其更易于阅读，那就太好了，但这很可能是镀金的 :)

```
public class EnquiryModel
{
    public string Name;
    public string Email;
    public string Phone;
    public string JobCode;
    public string Message;
    public int ReferralSource;
    public Dictionary<string, int> PickList;
    //allow the arrays of 1 to many values to be submitted as a single value
    // instead of a single item in an array
    private string[] bookingEnquiries;
    public object BookingEnquiries
    {
        get { return bookingEnquiries; }
        set
        {
            if (value.GetType() == typeof(string))
            {
                bookingEnquiries = new string[] { (string)value };
            }
            else if (value.GetType() == typeof(string[]))
            {
                bookingEnquiries = (string[])value;
            }
        }
    }
    private int[] studios;
    public object Studios
    {
        get { return studios; }
        set
        {
            if (value.GetType() == typeof(Int32) || value.GetType() == typeof(Int64))
            {
                studios = new Int32[] { (Int32)value };
            }
            else if (value.GetType() == typeof(Int32[]))
            {
                studios = (Int32[])value;
            }
        }
    }
    private int[] services;
    public object Services
    {
        get { return services; }
        set
        {
            if (value.GetType() == typeof(Int32) || value.GetType() == typeof(Int64))
            {
                services = new Int32[] { (Int32)value };
            }
            else if (value.GetType() == typeof(Int32[]))
            {
                services = (Int32[])value;
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:52:37.563

我会让变量 p[rivate 并通过 getter 和 setter 公开它们。在 setter 中，您可以评估传入的属性并进行适当的设置。

```
 private Int32[] numbers;

    public object Numbers
    {
        get { return numbers; }
        set
        {
            if (value.GetType() == typeof(Int32))
            {
                numbers = new Int32[] { (Int32)value };
            }
            else if (value.GetType() == typeof(Int32[]))
            {
                numbers = (Int32[])value;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:59:12.833

我觉得您将需要编写自己的包装器，该包装器将检查是否存在单个类型的项目`T`，它将其转换为`new T[]{item}`. 您可以使用 JSON.NET 的 JObject 类。

```
JObject o = JObject.Parse(response); 
```

并评估`o`您正在寻找的特定属性。

# php - PHP LFTP数据镜像输出

> ID：14199182
> 
> 赞同：0
> 
> 时间：2013-01-07T15:28:16.690
> 
> 标签：php, file-structure, bash, ftp

我正在使用 Linux 本地计算机，需要定期备份/镜像一些非常大的文件结构。我只能访问 SFTP。

我追求简单的一键式解决方案。我最初尝试在 BASH 中编写这个小脚本，但我以前从未使用过它，并且对语法不熟悉，所以我求助于 PHP。（我知道 PHP 不是为这种工作而设计的，但我的时间很紧，没有时间进入 BASH atm）

```
<?php
//init
parse_str(implode('&', array_slice($argv, 1)), $_GET);
$error = array();

$lPrefix         = '/home/hozza/Sites/';
$archiveLocation = '/home/hozza/Backups/';

$lDir = isset($_GET['l']) ? $_GET['l'] : $error[] = 'Local Directory Required';
$rDir = isset($_GET['r']) ? $_GET['r'] : $error[] = 'Remote Directory Required';
$bookmark = isset($_GET['b']) ? $_GET['b'] : $error[] = 'lftp Bookmark Required';

//Check for args
if(count($error) == 0) {
    $archiveName = end(explode('/', $lDir)) . '_' . date('Y-m-d_H-i');

    //Validate local dir
    if(is_dir($lPrefix . $lDir)) {

        //preserve Sublime Text 2 config SFTP files
        $ST2_SFTP_conf = false;
        if(file_exists($lPrefix . $lDir . '/sftp-config.json')) {
            $ST2_SFTP_conf = file_get_contents($lPrefix . $lDir . '/sftp-config.json');
            unlink($lPrefix . $lDir . '/sftp-config.json');
        }

        //Start mirror
        $lftOutput = explode("\n", shell_exec('lftp -e "mirror -e -p --parallel=10 --log=' . $archiveLocation . 'logs/' . $archiveName . '.txt ' . $rDir . '/ ' . $lPrefix . $lDir . '/; exit top" ' . $bookmark));

        //Tar regardless of lftp error or success
        $tarOutput = shell_exec('cd ' . $lPrefix . ' && tar -czf ' . $archiveLocation . $archiveName . '.tar.gz ' . $lDir);

        //Output completion or errors
        shell_exec('notify-send -i gnome-network-properties -t 0 "Mirror & Archive Complete" "' . $archiveName . '\n\n' . implode('\n', $lftOutput) . $tarOutput . '"');

        //put back ST2 SFTP conf
        if($ST2_SFTP_conf != false) file_put_contents($lPrefix . $lDir . '/sftp-config.json', $ST2_SFTP_conf);

        exit;
    }
    else shell_exec('notify-send -i error -t 0 "Mirror & Archive Error" "' . date('Y-m-d') . ' ' . date('H-i') . '\n' . $lDir . ' \n Does not exist! D:"');
}
else shell_exec('notify-send -i error -t 0 "Mirror & Archive Error" "' . date('Y-m-d') . ' ' . date('H-i') . '\n' . implode('\n', $error) . '"');
?> 
```

它可以通过这样的快捷方式在许多站点上运行......

```
terminator -T "Mirror & Archive" -e "php ~/Programs/mirror.php l=local-dir_path r=./ b=lftp-bookmark-name" 
```

如果 LFTP 书签中没有密码（不应该以纯文本形式存储），终端会提示输入密码，在脚本运行后，会给出一个很好的通知，其中包含有关文件/文件夹/速度等的一些信息。

但是，当脚本在终端中运行时，只有“输入密码”位输出到终端，我希望终端中显示所有输出（通常会显示当前正在使用的文件/文件夹等）

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T18:14:57.723

IIRC 您看到密码提示输出到终端的原因是它正在使用`stderr`. 您可以尝试重定向`stdout`到`stderr`您的命令，这应该向您显示“实时”进度。将其添加到命令的末尾`shell_exec()`：`1>&2`

IE：

```
shell_exec('lftp -e "mirror -e -p --parallel=10 --log=' . $archiveLocation . 'logs/' . $archiveName . '.txt ' . $rDir . '/ ' . $lPrefix . $lDir . '/; exit top" ' . $bookmark . ' 1>&2') 
```

但是，这将阻止您`shell_exec`出于日志记录目的而返回任何内容。我的建议是：

```
$log_stem = '/tmp/' . time() . '_';  // ie: /tmp/1357581737_
$lfOutfile = $log_stem . 'lftp.log';
$tarOutfile = $log_stem . 'tar.log';

shell_exec('lftp -blah | tee ' . $lfOutfile ' 1>&2' );
shell_exec('tar -blah | tee ' . $tarOutfile ' 1>&2' );

$lfOut = file_get_contents($lfOutfile);
$tarOut = file_get_contetns(tarOutfile);

// remove tmp files
unlink($lfOutfile);
unlink($tarOutfile); 
```

这将在将输出重定向到 stderr 之前将输出的副本捕获到文件中，以便您可以实时观看。

但是，如果您想通过 cron 运行它，我建议*不要*将任何非错误的内容写入 stderr，否则 cron 将在每次运行时发送警告电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T22:23:16.360

我认为最后一个答案很接近：

要么：

```
shell_exec('lftp -blah |& tee ' . $lfOutfile );
shell_exec('tar -blah |& tee ' . $tarOutfile ); 
```

或者如果这仍然不起作用，试试这个：

```
shell_exec('lftp -blah 2>&1 | tee ' . $lfOutfile );
shell_exec('tar -blah 2>&1 | tee ' . $tarOutfile ); 
```

# extjs - Sencha Cmd 3.0.0.250：将 sencha 编译输出文件名“all-classes.js”替换为自定义文件名

> ID：14199184
> 
> 赞同：1
> 
> 时间：2013-01-07T15:43:49.020
> 
> 标签：extjs, compiler-construction, command

该`sencha compile page`命令连接 HTML 页面所需的任何 javascript 文件，然后将结果写入名为“all-classes.js”的单个文件。我想用自定义文件名替换这个文件名：

```
sencha compile 
page -name=page1 -in Page1.php -out build/Page1.php and
page -name=page2 -in Page2.php -out build/Page2.php and
restore page1 and
concat -yui build/Page1.js and
restore page2 and
concat -yui build/Page2.js 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T08:51:52.057

我找到了一个简单的解决方案作为[`sencha compile page`](http://docs.sencha.com/ext-js/4-1/#!/guide/command_reference-section-18)名为`--classes-file`( `-cla`) 的命令提供的选项：

```
sencha compile 
page -name=page1 -cla Page1.js -in Page1.php -out build/Page1.php and
page -name=page2 -cla Page2.js -in Page2.php -out build/Page2.php and
restore page1 and
concat -yui build/Page1.js and
restore page2 and
concat -yui build/Page2.js 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T21:01:51.840

干杯，我正在寻找相同的答案。我只有一个提示，还不是最佳实践。

在 .sencha/app/build-impl.xml 文件中，存在以下目标：

```
<!-- compile the page -->
<x-sencha-command>
    compile
        ${build.options}
        page
            -name=page
            -in=index.html
            -out=${build.dir}/index.html
        and
        restore
            page
        and
        ${build.operations}
        and
        concat
            ${build.compression}
            -out=${build.dir}/all-classes.js
</x-sencha-command> 
```

如您所见，此处定义了“all-classes.js”。

我已经尝试过这里的改变，它......工作了一半。1) 它确实使用新名称创建了 min.js 文件。2）它没有用正确的路径更新 index.html（你必须这样做）

但是，这可能不是最佳实践——据我所知——在 build-impl.xml 中维护修改可能不好，因为这可能会导致从 sencha 升级的角度来看变得复杂。

也许有一个 sencha.cfg 设置？那肯定很好。

谢谢你的问题。+1。我希望其他人回应。祝一切顺利！

# javascript - 在 JSTL 中转义引号

> ID：14199186
> 
> 赞同：1
> 
> 时间：2013-01-07T15:43:56.270
> 
> 标签：javascript, html, jsp, jstl

我有一个名为的变量`param`，它具有值`I told \"I will come\"`，在 JSP 中我将其分配给输入标签的值

```
<input type="text" value="${param}"/> 
```

正在发生的事情是，正在获得的价值是`I told \`，即仅在第一个“之前获得价值，但我用 \ 转义这个”，但仍然得到这个。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T15:52:06.673

试试这个：

```
<input type="text" value="${fn:escapeXml(param)}"/> 
```

当您需要的转义实际上是 XML/HTML 转义时，这将起作用。但是，如果您将 JSTL/EL 表达式放到 JavaScript 代码中，那可能不是您想要的。在这种情况下，您需要一个 JSON 编码函数，我认为其中有几个可用的函数（至少来自 Google）。（我有自己的，所以我无法提供直接信息。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:38:30.723

如果您想坚持使用 JSTL 的核心库，这也可以解决问题：

```
<c:out value="${param}" /> 
```

# git - 我可以在 Git 中合并 2 个相似但未跟踪的存储库吗？

> ID：14199191
> 
> 赞同：1
> 
> 时间：2013-01-07T15:44:01.547
> 
> 标签：git, merge, branching-and-merging

我有一个主线存储库，我想将我的新功能合并到其中。这些功能是在此 repo 的副本上开发的。创建这个 repo 的方式是简单地执行 git init 并在其中删除所有内容的副本（即：没有来自主线的历史记录，第一次提交只是所有内容的直接副本）。我知道我可以将功能存储库作为一个新分支带入主线存储库，但是......我似乎只是`both added`因为任何文件都发生了变化而发生冲突。另外，我不确定我的历史记录是否会从功能存储库中转移到主线存储库中？它会被视为一个单一的大型提交吗？尽管我以前犯了错误，有没有办法以犹太洁食的方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:57:42.873

自从您开始处理“新功能”存储库以来，听起来您已经对“主线”存储库进行了提交。如果是这种情况，您将需要**从启动新 repo 的提交而**不是当前提交在主线 repo 中创建一个分支。

```
---o---o---o  mainline
    \
     o---o---o  new features 
```

就像是

```
cd mainline
git checkout -b new-features <origin commit for new features>
git remote add new-features ../new-features 
```

从那里你应该能够`git rebase`/ `git merge`/`git cherry-pick`到你的喜好。还要继续前进，不要做你所做的。如果要“分支”，请使用`git branch`.

# linux - 破折号从标准输入重定向到标准输出

> ID：14199193
> 
> 赞同：1
> 
> 时间：2013-01-07T15:44:03.967
> 
> 标签：linux, bash, shell

这个问题的关键值与使用破折号“-”来重定向标准输入流有关。

我在下一个代码中有基本的测试脚本：

```
#!/bin/bash
# This causes the shell to await user input.
file -
# Need to emulate user input here... 
```

在这种情况下，哪一个 shell 命令可以模拟用户输入？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:05:45.657

根据定义，管道`cmd1 | cmd2`将 的标准输出文件描述符连接`cmd1`为 的标准输入文件描述符`cmd2`。

```
echo foo | file - 
```

这个特殊的例子几乎没有用；该`file`命令在管道内的那种临时数据上运行没有多大意义。一个更有用的示例运行`file`在一个文件上。如果您绝对希望文件成为标准输入，则可以通过简单的输入重定向来做到这一点。

```
file - </path/to/example/file 
```

或者你可能正在寻找这个：

```
file $(locate example/file) 
```

其中`locate`是一个命令示例，该命令打印您可能想要的文件的完整路径作为`file`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:11:05.647

您可能想要一个[此处的文档](http://www.gnu.org/software/bash/manual/bash.html#Here-Documents)：

```
#!/bin/bash
# This causes the shell to await user input.
file - <<'EOF'
This is what the user
might have typed
if it wasn't in a here document.
${BASH:=head} $(ls | wc -l)
EOF 
```

此处文档继续到仅包含标记词的行。在示例中，标记词是 EOF；你可以选择任何你喜欢的名字（`!`经常使用）。标记词周围的引号意味着不会对here文档进行shell扩展，因此最后一行不会被shell扩展。如果（如 ）中缺少引号，`<<EOF`则会发生 shell 扩展。这在您需要时很有用。

# python - 如何使用 assertRaises 在 Python 中测试实例方法？

> ID：14199197
> 
> 赞同：5
> 
> 时间：2013-01-07T15:44:09.753
> 
> 标签：python, unit-testing, assertraises

我了解如何`assertRaises`在函数或 lambda 上使用，但我想在实例方法上使用它。

因此，例如，如果我有一个`calculator`执行无限精度算术的类，我可能会编写测试：

```
def setUp(self):
    self.calculator = calculator.calculator()

def test_add(self):
    self.assertRaises(TypeError, self.calculator.add, ['hello', 4]) 
```

因为`self.calculator.add`是可调用的并且`['hello', 4]`是我想传递的参数，但是，当我运行测试时，我收到以下致命错误：

```
TypeError: add() missing 1 required positional argument: 'num2' 
```

我相信它会抛出这个错误，因为当`self.assertRaises`调用时`self.calculator.add`，`self`并没有像调用实例方法时那样作为第一个参数传递。我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T15:52:11.870

正如其他答案所说，您必须单独传递值，但是您可能会发现更容易阅读的替代方法是使用以下`with`语句：

```
def test_add(self):
    with self.assertRaises(TypeError):
        self.calculator.add('hello', 4) 
```

当您使用这种方式时，您只需在块`assertRaises`内正常编写代码。`with`这意味着它是一种更自然的编码方式，而且您不仅限于测试单个函数调用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T15:45:51.330

我认为这`self`是提供的，但`assertRaises`希望您单独列出参数。尝试：

```
self.assertRaises(TypeError, self.calculator.add, 'hello', 4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T15:45:41.710

您必须以这种方式传递值：

```
self.assertRaises(TypeError, self.calculator.add, arg1, arg2, arg3) 
```

# c# - DLL 中没有可以放在工具箱上的组件

> ID：14199202
> 
> 赞同：11
> 
> 时间：2013-01-07T15:44:38.273
> 
> 标签：c#, visual-studio-2012, dll, custom-controls, toolbox

我有一个`DatePicker`要添加到工具箱的自定义控件。该文件的名称是`BasicFrame.WebControls.BasicDatePicker.dll`，我通过在工具箱中右键单击>选择项目，然后在.NET Framework组件下浏览到该文件后选择该文件。

但是，我收到此错误消息：

> 工具箱中没有可以放置的组件

为什么我会收到此消息，我该如何解决？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-12-19T15:31:33.973

**在某些情况下，您可以通过拖放**来解决此问题：

*   打开 Windows 资源管理器并导航到 DLL
*   将 DLL 拖放到工具箱中的 Visual Studio 上，正是您希望组件出现的位置

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-07T15:57:11.967

您是否检查了自定义类的可见性？

如果您尚未将它们声明为公共，它们将默认为内部，因此不会暴露给 Visual Studio 以供使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-11T05:49:39.887

有时拖放也不起作用。在这种情况下，您可以

*   打开 Windows 资源管理器并导航到 DLL
*   复制 dll 文件并将其直接粘贴到您希望放置控件的工具箱选项卡上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-18T13:07:30.890

Visual Studio 2019 - 无法让 VS2019 识别简单的用户控件。我发现这是由于控件中没有无参数构造函数引起的。一旦我确保有一个没有参数的 ctor，控制就被识别出来了。我发现我能够使用构造函数链接/重载。希望这将有助于其他有此问题的人。

# c++ - 当 .exe 程序使用此 .dll 文件时，我如何知道在 .dll 文件中调用了哪些函数？

> ID：14199204
> 
> 赞同：2
> 
> 时间：2013-01-07T15:44:46.230
> 
> 标签：c++, dll, dllimport

我有一个与调用 dll 文件中的函数有关的问题。如果我理解得很好，在 dll 文件中我们可以定义许多不同的函数，这些函数可以由 .exe 文件调用。例如，可以从`a.dll`文件中调用的函数包括以下函数：

```
void fun1(int k);
int  fun2(float value);
float fun3(double sig); 
```

例如，对于一个特定的程序，`a.exe`它可能只调用`fun1`函数，`a.dll`而不使用其他函数。那么我的问题是，我怎么知道运行.exe程序时调用了哪些函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T15:49:41.953

您可以检查可执行文件的符号表以获取导入的符号。对于 windows（`.exe`文件），您可以[按照此处所述使用](http://msdn.microsoft.com/en-us/library/d7k09ee7.aspx)[`DUMPBIN`实用程序`/IMPORTS`](http://msdn.microsoft.com/en-us/library/d7k09ee7.aspx)。

**更新**：如评论中所述，可执行文件可以加载 DLL 并以在编译时不创建符号的方式动态访问它们。例如，通过在使用[LoadLibrary](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)加载 DLL 后调用[GetProcAddress](http://msdn.microsoft.com/en-us/library/64tkc9y5%28v=vs.80%29.aspx)。在这种情况下，将不存在符号并且不会列出它，但可能会或可能不会调用该函数。`DUMPBIN`

如果您或多或少地知道 exe 是如何工作的，并且它似乎没有动态地做事（例如从插件 DLL 加载代码），那么假设没有动态加载发生可能是安全的。此外，如果 exe 的符号表显示来自给定 DLL 的*某些*函数，则 exe 不太可能动态访问来自同一 DLL 的函数。

此外，函数出现在符号表中这一事实并不能*保证*它会被 exe 调用，但在任何正常的静态情况下，它很有可能会被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:50:51.763

您可以使用[Dependency Walker](http://www.dependencywalker.com/)

“Dependency Walker 是一个免费实用程序，它可以扫描任何 32 位或 64 位 Windows 模块（exe、dll、ocx、sys 等）并构建所有依赖模块的层次树形图。对于找到的每个模块，它都会列出所有该模块导出的函数，以及其中哪些函数实际上被其他模块调用。另一个视图显示所需文件的最小集，以及每个文件的详细信息，包括文件的完整路径、基地址、版本号、机器类型、调试信息等。”

# spring - Spring web mvc，常用clean url参数

> ID：14199207
> 
> 赞同：2
> 
> 时间：2013-01-07T15:44:55.207
> 
> 标签：spring, spring-mvc

我试图在我的 MVC 应用程序中构建一个干净的 URL 映射，我发现了很多常见的 URL，例如：

/SITE/{city}-{language}/user/{userId}

```
@RequestMapping(value = "/{city}-{language}/user/{userId}", 
         method = RequestMethod.GET)
public String user(@PathVariable String city, 
                   @PathVariable String language, 
                   @PathVariable String userId, 
                   Model model) {} 
```

/SITE/{city}-{language}/comment/{userId}-{commentId}

```
@RequestMapping(value = "/{city}-{language}/comment/{userId}-{commentId}",
         method = RequestMethod.GET)
public String comment(@PathVariable String city,
                      @PathVariable String language, 
                      @PathVariable String userId,
                      @PathVariable String commentId, 
                      Model model) {} 
```

有没有办法自动将城市和语言自动绑定到模型而不是过滤器的@PathVariable，我认为它可以减少@RequestMapping 函数参数的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T19:36:22.383

我做了一个满足我需要的工作，我创建了一个映射公共参数的抽象基类。

```
public abstract class AbstractController {

    @ModelAttribute("currentCity")
    public CityEntity getCurrentCity(@PathVariable CityEntity city) {
        //CityEntity via a converter class
        return city;
    }

    @ModelAttribute("language")
    public String getLanguage(@PathVariable String language) {
        return language;
    }
} 
```

现在两个通用属性将在模型对象中可用

```
@RequestMapping(value = "/{city}-{language}")
public class UserController extends AbstractController {

      @RequestMapping(value = "/user/{userId}", method = RequestMethod.GET)
      public String user(@PathVariable String userId, 
               Model model) {...}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T18:44:00.223

您只需要为每种类型实现接口[转换器：](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/core/convert/converter/Converter.html)

例如

```
public class StringToCityConverter<String, City> {
    ...
    public City convert (String cityName) {
        return this.cityDao.loadByCityName(cityName);
    }
} 
```

你需要注册它们。一种方法是使用格式化程序注册器。

一些注册商注册格式化程序

```
public class MyRegistrar implements FormatterRegistrar {
    ...
    @Override
    public void registerFormatters(final FormatterRegistry registry) {
        registry.addConverter(new StringToCityConverter(cityDto));
    }
} 
```

这注册了注册商

```
<!-- Installs application converters and formatters -->
<bean id="applicationConversionService"
    class="org.springframework.format.support.FormattingConversionServiceFactoryBean">
    <property name="formatterRegistrars">
        <set>
            <bean
                class="MyRegistrar" autowire="byType" />                               
        </set>
    </property>
</bean> 
```

然后你可以这样写你的控制器：

```
@RequestMapping(value = "/{city}-{language}/comment/{userId}-{commentId}",
     method = RequestMethod.GET)
public String comment(@PathVariable City city, ... Model model) {} 
```

# ruby-on-rails - rake db:migrate 给我 rake aborted 错误

> ID：14199210
> 
> 赞同：0
> 
> 时间：2013-01-07T15:44:57.227
> 
> 标签：ruby-on-rails

我正在关注 Lynda ruby​​ on rails 教程。我被要求输入“rake db:migrate”。然而，这是我收到的错误。

```
lexi87$ rake db:migrate
rake aborted!
/Users/lexi87/Sites/simple_cms/db/migrate/20130107145627_create_users.rb:14: syntax error, unexpected $end, expecting keyword_end
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:251:in `require'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:251:in `block in require'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:251:in `require'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:537:in `load_migration'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:533:in `migration'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:528:in `migrate'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:720:in `block (2 levels) in migrate'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:777:in `call'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:777:in `ddl_transaction'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:719:in `block in migrate'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:700:in `each'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:700:in `migrate'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:570:in `up'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/migration.rb:551:in `migrate'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/railties/databases.rake:179:in `block (2 levels) in <top (required)>'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/bin/ruby_noexec_wrapper:14:in `eval'
/Users/lexi87/.rvm/gems/ruby-1.9.2-p320/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => db:migrate
(See full trace by running task with --trace) 
```

我在我应该在的目录中，即“sites/simple_cms”。我已经安装了 rake 并且还运行了“gem install bundle”和“bundle install”。我在目录中完成了此操作，然后在“站点目录”甚至主目录中完成了此操作。没有什么不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T01:52:39.853

抱歉，我发现了问题所在。我在创建用户文件的底部缺少第二个“结束”。

在整个教程中，我一直注意到有一些我必须添加的行，但它们并没有告诉你。现在我可以继续我的旅程了，谢谢大家的建议！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:11:27.497

```
/Users/lexi87/Sites/simple_cms/db/migrate/20130107145627_create_users.rb:14: syntax error, unexpected $end, expecting keyword_end 
```

从上面的代码行“语法错误，意外 $end，期待关键字_end”，我认为您在迁移文件中添加了一个额外的结尾。只需检查您是否有多余的结尾，或者您错过了在迁移文件中结束

# ruby-on-rails - 致命：不是 git 存储库（或任何父目录）：每个 rails 命令上都有 .git，但 git 命令工作正常

> ID：14199212
> 
> 赞同：13
> 
> 时间：2013-01-07T15:45:14.583
> 
> 标签：ruby-on-rails, git, repository

我的 git 和我的 rails 项目有问题。

我已经建立了一个 github 存储库并成功推送了四个提交。我正在尝试的每个 git 命令都按预期工作（`git status, git add, git commit, git push`等等）。但是每次我尝试执行 rails 命令（例如`bundle show, bundle install, rails s, rails generate, rake test`等）时，我都会在控制台中收到以下消息：

```
fatal: Not a git repository (or any of the parent directories): .git
fatal: Not a git repository (or any of the parent directories): .git
fatal: Not a git repository (or any of the parent directories): .git 
```

每次消息出现在三行上。有时在六行。该`.git`文件夹在我的项目中，我在正确的文件夹中。所有 rails 命令都按预期工作。但是这个恼人的消息伴随着每个 rails 命令。我将存储库克隆到另一个文件夹并创建了另一个存储库并将代码推送到该新存储库。错误也在我的新文件夹中。

我重新初始化了我现有的 Git 存储库，`git init`但这并没有改变。

当我设置一个新的 Rails 项目并将其推送到新的存储库等时，没有错误。我的项目可能有什么问题？任何想法，为什么会发生这种情况以及如何解决这个问题？

我正在与和`ruby 1.9.3`合作。`rails 3.2.1``git 1.7.9`

感谢@manojlds，我可以进一步隔离问题。这是 therubyracer 宝石。我不知道到底是什么问题，但因为我在 Windows 上，所以我使用了这个特殊的 therubyracer gem：[https](https://github.com/hiranpeiris/therubyracer_for_windows) ://github.com/hiranpeiris/therubyracer_for_windows 。所以我会问这个特殊 gem 的开发者，并向他展示 bundler bug。也许他会知道这是他的宝石还是捆绑器的问题。捆绑器有一个更新的预发布。但我无法在 Windows 上安装预发行版。所以我必须等待，因此我现在必须忍受这些烦人的消息。或者有没有办法禁用这些消息？

这是我的 github 问题：[https ://github.com/hiranpeiris/therubyracer_for_windows/issues/1](https://github.com/hiranpeiris/therubyracer_for_windows/issues/1)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-11T22:50:19.070

试试跑`git init`进去

`RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/therubyracer-0.11.0beta1-x86-mingw32`.

它将在那里初始化一个新的空 git repo。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T15:55:22.110

Bundler 有一个错误，可能与此相关：[https ://github.com/carlhuda/bundler/issues/2039](https://github.com/carlhuda/bundler/issues/2039)

绝对不是 git 或您的 git repo 的问题。尝试更新捆绑器。（不确定修复是否处于稳定版本）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T10:03:32.127

运行该命令时，请确保您位于正确的目录中：

```
git tag 
```

我在从 git 安装 node.js 时遇到了同样的问题，发现下载后我必须在子目录中才能显示标签版本。

例如，我运行以下命令来获取 node.js：

```
git clone https://github.com/joyent/node.git 
```

...但随后必须 在命令工作`cd node`之前位于节点子目录中。`git tag`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-27T13:08:27.220

rubytheracer gem 有很多问题。

切换到 node 或 execjs 以避免它们。

更多内容：[Rails - 找不到 JavaScript 运行时？](https://stackoverflow.com/questions/7092107/rails-could-not-find-a-javascript-runtime)

# database - 使用 JPA 时避免数据库中的陈旧数据？

> ID：14199215
> 
> 赞同：5
> 
> 时间：2013-01-07T15:45:16.103
> 
> 标签：database, spring, caching, jpa, eclipselink

我面临的问题类似于[Invalidating JPA EntityManager session](https://stackoverflow.com/questions/2400430/invalidating-jpa-entitymanager-session)中描述的问题：

**问题：获取过时的数据**

我们正在 SQL 数据库上运行 JPQL 查询，该数据库也由不同的应用程序同时更改。我们使用的是在 Tomcat 下运行的 JSF+Spring+EclipseLink。

执行 JPQL 查询的类是一个单例 Spring bean，并使用注入的`EntityManager`：

```
@Component
public class DataRepository{
    @PersistenceContext
    private EntityManager entityManager;
    public List<MyDTO> getStuff(long id) {
        String jpqlQuery ="SELECT new MyDTO([...])";
        TypedQuery<MyDTO> query = entityManager.createQuery(jpqlQuery,MyDTO.class);
        return query.getResultList();
    }
[...] 
```

*（代码释义）。*

问题是这段代码看不到直接在数据库上执行的更改。这些更改仅在 Tomcat 实例重新启动时才可见。

**我们尝试过的**

我们假设此行为是由与 关联的一级缓存引起的`EntityManager`，如链接问题中所述。我们找到了两个解决方案：

*   在调用`entityManager.clear()`之前调用`createQuery`（在链接的问题中建议）
*   注入一个`EntityManagerFactor`（使用），然后为每个查询`@PersistenceUnit`创建并关闭一个新的`EntityManager`

两种解决方案都能满足我们的需求——我们获得了新数据。

问题：

*   这两种解决方案是否正确？哪一个更好？
*   特别是，我们可以安全地调用`entityManager.clear()`注入的 EntityManager，或者这会以某种方式影响也使用注入的 EntityManager 的其他代码（在相同或不同的类中）？
*   有不同的更好的方法吗？我们可以以某种方式声明我们想要刷新缓存，或者我们想要一个新的缓存`EntityManager`吗？

我认为这一定是一个相当普遍的问题（每当多个应用程序共享一个数据库时就会发生这种情况），所以我认为必须有一个简单的解决方案......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T15:33:36.723

看起来我们已经解决了这个问题。

其实有两个问题：

1.  在调试问题时，在某些情况下，我们没有为每个查询使用新的 EntityManager。当使用和重用同一个 EntityManager 时，实体一旦被检索到显然*永远不会*`EntityManager.refresh()`被刷新（除非使用 显式刷新）。这显然是因为一旦加载了实体，它就会存储在 EntityManager 的持久化上下文（也称为一级缓存）中。这样做是必要的，因为 JPA 规范要求对同一实体的后续查询返回相同的对象实例。所以换句话说：只要您使用相同的 EntityManager，除非您显式刷新，否则您将获得陈旧的数据。

2.  当我们*确实*为每个查询使用一个新的 EntityManager 时，事情通常会奏效。[但是，我们在 EclipseLink](https://bugs.eclipse.org/bugs/show_bug.cgi?id=398067)中遇到了一个错误，其中针对某些 JPQL 查询（涉及构造函数表达式和 JOIN FETCH）返回了陈旧的数据。

**简洁版本**

如果您想始终从程序外部修改的数据库中获取新数据，那么

*   为每个需要新数据的查询使用新的 EntityManager
*   禁用二级缓存（`<shared-cache-mode>NONE</shared-cache-mode>`在 persistence.xml 中）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T19:36:30.610

1.  创建 new`EntityManager`是正确的，另一个不是（见下文）。

2.  [`EntityManager#clear()`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#clear%28%29)除了单线程系统外，调用在所有系统中都是非常危险的。

    > ...导致所有托管实体分离...

    因此，如果一个线程与附加的实体一起工作，而“你的”线程清除了实体管理器，则会产生严重的副作用。

3.  嗯，很难说。如果在您的应用程序之外修改的实体数量很少，我将直接使用数据源和 a`JdbcTemplate`进行相应的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T14:45:58.820

要禁用 EclipseLink 中的共享缓存，请参阅，

[http://wiki.eclipse.org/EclipseLink/FAQ/How_to_disable_the_shared_cache%3F](http://wiki.eclipse.org/EclipseLink/FAQ/How_to_disable_the_shared_cache%3F)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-11T11:43:21.527

这会变魔术 `entityManager.getEntityManagerFactory().getCache().evict(MyDTO.class);`

# javascript - HTML & Javascript - 如何模拟禁用的输入（隐藏插入符号）？

> ID：14199218
> 
> 赞同：0
> 
> 时间：2013-01-07T15:45:23.473
> 
> 标签：javascript, html, emulation, disabled-input

我需要的是一个禁用的输入，它会触发事件。但由于 Firefox 不支持，我想以某种方式模拟它。

这基本上意味着，不允许编辑和隐藏插入符号。我不在乎外表。

我已经看到使用了这个 CSS：`user-select: none;` 但这不是我想要的 - 1）用户仍然可以编辑 2）我希望它是可选择的。

我不想要用 a 覆盖真正禁用的输入并捕获它的事件的方法 - 它的便携性不好。

相关：[禁用输入上的事件](https://stackoverflow.com/questions/3100319/event-on-a-disabled-input)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:48:19.557

您基本上可以取消输入上的每个 keydown 事件。但是，这仍然会显示 carret：

```
<input type="text" id="disabled_input" /> 
```

jQuery：

```
$('disabled_input').keydown(function (event) {
    event.preventDefault();
    event.stopPropagation();
    // or simply return false;
}); 
```

Javascript：

```
document.getElementById('disabled_input').onkeydown = function (event) {
    event.preventDefault();
    event.stopPropagation();
    // or simply return false;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:48:32.720

为什么不将它包装在另一个元素中并将事件处理程序放在该元素上？

例如

```
<div class="disabledwrapper">
    <input type="text" disabled="disabled" name="test" value="test" />
</div> 
```

# jquery - 麻烦保护表单提交

> ID：14199219
> 
> 赞同：0
> 
> 时间：2013-01-07T15:45:30.820
> 
> 标签：jquery, forms

我有一个 HTML 表，其中的行表示数据库记录。最后一列的单元格有一个带有提交按钮的表单，用于删除数据库记录。表单具有唯一的 ID，但其中的字段只有名称，并且每个表单的名称都相同。

我有一个简单的用户确认，但我想确保表单不只是由于 Javascript 未运行（错误或其他原因）而提交。所以我想我会将其中一个隐藏字段的值留空并在提交时填写（处理脚本需要的字段但无论选择哪条记录都是相同的值，所以很容易分配）。这是我尝试过的：

```
$(document).ready(function() {
  $("form[id^='deltrans']").submit(function(e) {
    if (confirm("Are you sure you want to delete this transaction?")) {
      $(this).find("[name='uri']").val("my value...");
    } else {
      e.preventDefault();
    }
  });
}); 
```

但是使用 $(this).find() 似乎不起作用 - Firebug 说 $(this).find("[name='uri']").val() 是未定义的。如果出现 JS 问题，您能否看到我的错误或有更好、更简单的建议来防止意外提交表单？

编辑：根据评论中的请求，这里是相关的 HTML：

```
<form method="post" id="deltrans<? echo $row->TransID; ?>" action="processor.php">
  <td class="button-in-table">
    <input type="hidden" name="tid" value="<? echo $row->TransID; ?>">
    <input type="hidden" name="uri" value="">
    <input type="submit" name="deltrans" value="Del">
  </td>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:03:00.907

如果`uri`输入在表单内，您不能使用：

`$(this).children('[name^=uri]').val("my value...");`

全文：

```
$(document).ready(function() {
  $("form[id^='deltrans']").submit(function(e) {
   if (confirm("Are you sure you want to delete this transaction?")) {
      $(this).children('[name^=uri]').val("my value...");
   } else {
      e.preventDefault();
   }
  });
}); 
```

# python - 如何使用 Python 处理下载弹出窗口并保存文件？

> ID：14199220
> 
> 赞同：1
> 
> 时间：2013-01-07T15:45:32.860
> 
> 标签：python, beautifulsoup

我有一个包含可下载文件的链接，现在当我将该链接放到浏览器上时，会`ENTER`弹出一个窗口来下载。现在使用 Python 我们可以将该文件保存在本地机器中吗？

说可下载的链接：

```
https://xyz.test.com/aems/file/filegetrevision.do?fileEntityId=8120070&cs=LU31NT9us5P9Pvkb1BrtdwaCrEraskiCJcY6E2ucP5s.xyz 
```

**代码**

它用于准备链接：但最后我找不到解决方法：

```
for a in soup.find_all('a', {"style": "display:inline; position:relative;"}, href=True):
    href = a['href'].strip()
    href = "https://xyz.test.com/" + href
print(href) 
```

[下载窗口](http://i.stack.imgur.com/5nIcZ.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:28:07.190

如果您的目的不是测试*下载弹出窗口*本身，而是测试文件的存在/内容，您可以使用 urllib 下载它：

```
import urllib
urllib.urlretrieve(href, filename) 
```

您需要添加必要的异常处理（以确保 URL 确实指向某些东西）和文件处理一旦下载以验证其内容。

# regex - shell 脚本上的 Grep 和 regex 不同的行为将无法正常工作

> ID：14199221
> 
> 赞同：0
> 
> 时间：2013-01-07T15:45:39.740
> 
> 标签：regex, grep, sh

我目前正在编写一个 shell 脚本，我必须检查字符串 B 中是否包含字符串 A。

所以我立即写了出来（以“key”为例）

```
if [ `echo "$KEY" | grep "\$"` ] 
```

但是由于某种原因，在我的 shell 脚本中，输出

```
echo "$KEY" | grep "\$" 
```

返回“价值”

在 zshrc 上测试相同的命令后，我得到了不同的结果（没有预期的结果）

有谁知道它可能来自哪里？

编辑：在重新编写脚本后，我将 "" 引号更改为 '' 并得到了正确的结果

```
echo "$KEY" | grep '\$' 
```

但是我的测试仍然通过写出来

```
[ if `echo "$KEY" | grep '\$'` ] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:21:18.130

更惯用和直接的方法是使用 shell 的`case`语句。语法有点怪异，还有一些元字符需要处理，但不是像 with 那样的完整正则表达式集`grep`。

```
case '$key' in
  *\$* ) echo contained ;;
  * ) echo not ;;
esac 
```

# unit-testing - 使用 Fake/Stub 存储库创建单元测试有什么意义

> ID：14199229
> 
> 赞同：5
> 
> 时间：2013-01-07T15:45:52.110
> 
> 标签：unit-testing, tdd, repository

我在这里看过一个类似的问题，我想我知道人们的答案在哪里，但我需要确认是否应该为我的解决方案创建带有 Stubbed 存储库的纯单元测试。

如果我有以下单元测试（使用 Microsoft 的 Fake Assemblies 和 MSTest 创建）：

```
 [TestMethod]
 public void creating_user_returns_a_valid_id()
 {
     var userId = new Random().Next(1, 1000);

     var userRepository = new StubIDataEntityRepository<User>
     {
         CreateT0 = x =>
             {
                 return userId;
             }
     };

     var user = new User();

     var result = userRepository.CreateT0(user);

     Assert.AreEqual(result, userId);
 } 
```

现在，我一直在学习单元测试，我明白纯单元测试不能跨越任何边界或职责，因此是存根。我知道，如果我想测试在我的数据库中创建用户确实会变成有效的用户 ID，我需要创建一个集成测试。那么，究竟，我在这里测试什么呢？我知道人们说应用程序逻辑，这一切都非常有效，但我肯定正在创建一个创建 id 的测试，告诉假存储库从其 Create 方法返回该 Id，然后确认从 Create 方法返回的 Id 是相同的值. 感觉就像我为以下内容做了很多工作：

x = 1, y = 1, assert.areequal(x,y)!!

答案真的是关于培训开发人员通过 TDD 设计他们的代码吗？如果你们中的任何一位 TDD 专家可以启发我，将不胜感激！

亲切的问候

本

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T15:53:43.840

*您没有在这里测试任何有用的东西。*

每个单元测试都有一个所谓的被测**系统**(SUT)。这就是您要测试的课程。
要测试 SUT，您不能模拟它，因为您将测试模拟，而不是 SUT。这有点毫无意义。

在您的情况下，您似乎想要测试存储库，但您也在模拟存储库，使测试毫无意义。

您想在 SUT 是另一个使用该存储库的类的测试中使用模拟存储*库*。

测试存储库很可能是集成测试的任务。无法使用单元测试来测试直接访问数据库的存储库方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T15:53:07.770

通过“模拟”或“存根”您的数据访问，您可以确保您的单元测试**仅**评估代码的性能。使用模拟，您可以*准确地*知道调用时将返回什么数据，以及它应该采用什么格式。您可能不是唯一一个写入数据库或数据文件的人，因此您的测试结果可能会发生微妙的变化，让您摸不着头脑。

在流程工业中，这个概念被称为**隔离测试**，它可以更好地了解（恕我直言）在单元测试中试图实现的目标。当你刚刚开始一个项目时，你所说的“做大量工作”是有效的，但项目复杂性是一种熵：它只会随着你运行的时间越长而变得更糟。尽早进入良好的实践可能会为您节省一些进一步的调试噩梦。

希望有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T06:30:48.340

这个问题做得非常好。我的回答是，如果你的鼻子闻到可疑的东西，那可能是。

如果您的应用程序与数据库接口，您应该将数据库访问权限委派给角色（通常称为 XXXRepository），其中 XXX 是被持久化的资源类型（例如客户）。

*   现在，如果您想测试 XXXRepository 的实现，您应该编写集成测试（即验证应用程序的其余部分是否与 DB 子系统集成的测试）。换句话说，是否正在满足合同（XXXRepository）的条款。因此称为“合同测试”。
*   如果您在“应用程序的其余部分”部分测试代码，则出于隔离和速度的原因，您应该编写单元测试并模拟 XXXRepository 角色。

简而言之，如果您的 SUT 负责写入文件 - 您的测试应该调用 SUT 方法并验证文件是否相应更改。还有什么……我们只是为以后的惊喜做准备。

# php - Doctrine2 - 保存自定义连接关系表

> ID：14199231
> 
> 赞同：0
> 
> 时间：2013-01-07T15:45:55.750
> 
> 标签：php, doctrine-orm, database-relations

基本上，我有两个表（文章和标签），我想用一些额外的属性建立多对多（一篇文章可以有很多标签，一个标签可以分配给很多文章）关系。我可以在 Doctrine2 中通过将其分解为两个单独的关系（一对多、多对一）和一个带有我的额外属性的关系表 ArticleTag 来编写它。

我的问题是我不知道我是否可以让 Doctrine2 也为我创建连接表实体。我的意思是当我打电话时：

```
$article = /* create new article, etc... */
$tag = /* create new tag, etc... */
$article->addTag($tag);

$em->persist($article);
$em->flush(); 
```

它**确实**在数据库中创建了文章和标签实体，但它**不**创建文章标签实体（换句话说，它不创建文章和标签之间的连接）。我可以自己创建它，但我宁愿依靠 Doctrine2。
当然，当我使用由 Doctrine2 生成的标准连接表时，它可以正常工作，但我需要那些额外的属性。

有谁知道或者我真的必须手动完成吗？

编辑：源代码

```
/**
 * @ORM\Entity
 */
class Article {
    /**
     * @ORM\Id
     * @ORM\GeneratedValue
     * @ORM\Column(type="integer")
     */
    protected $id;

    /**
     * @ORM\OneToMany(targetEntity="Tag", mappedBy="article", cascade={"persist"})
     * @ORM\JoinTable(name="ArticleTag", joinColumns={@ORM\JoinColumn(name="article_id", referencedColumnName="id")})
     * )
     */
    protected $tags;

    ...
} 
```

* * *

```
/**
 * @ORM\Entity
 */
class ArticleTag {

    /**
     * @ORM\Id
     * @ORM\GeneratedValue
     * @ORM\Column(type="integer")
     */
    protected $id;

    /**
     * @ORM\ManyToOne(targetEntity="Article")
     */
     private $article;

    /**
     * @ORM\ManyToOne(targetEntity="Tag")
     * @ORM\JoinColumn(name="tag_id", referencedColumnName="id")
     */
     private $tag;

    /**
     * @ORM\Column(type="float")
     */
    protected $priority = 0.5;

} 
```

* * *

```
/**
 * @ORM\Entity
 */
class Tag {

    /**
     * @ORM\Id
     * @ORM\GeneratedValue
     * @ORM\Column(type="integer")
     */
    protected $id;

    /**
     * @ORM\Column(type="string", length=32)
     */
    protected $name;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:18:05.420

本质上没有办法自动执行此操作，但您可以将类`addTag`上的方法更改为`Article`如下所示：

```
public function addTag(Tag $tag, $priority)
{
    $articleTag = new ArticleTag();
    $articleTag->setTag($tag);
    $articleTag->setArticle($this);
    $articleTag->setPriority($priority);
    $this->addArticleTag($articleTag);
    return $this;
} 
```

这样，您可以保持代码集中并隐藏`ArticleTag`条目的创建。为了进一步解释，以下是此逻辑背后的原因：

Doctrine 眼中的一个类代表一个实体源，该类的每个实例都代表一个实体。在简单的多对多表中，多对多表不是实体。`ArticleTag`实际上，它只是两个实体之间的关系，这就是为什么 Doctrine 允许您绕过此逻辑并且如果实体只有外键则不需要实体。

但是，一旦您向该表添加其他元数据，它就不再是关系表。我已经与许多看法不同的人讨论过这个问题，但事实并非如此。是的，它定义实体 1 和实体 2 是相关的，但附加列定义了关联所需的附加元数据。因此，它本身就是一个实体，必须如此反映。

我已经为此苦苦挣扎了很长一段时间，直到我最终添加了上面显示的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:08:03.357

我的实体可以在没有任何加入实体的情况下使用其标签（我的架构中的主题）加入文章，您是否出于任何特定原因需要加入实体？

用法

```
$article->getSubjects()->add($subject); 
```

实体

```
/**
 * @ORM\Entity(repositoryClass="\Fam\Article")
 * @ORM\Table(name="Article")
 */
class Article{

    /*StartProtected*/

        protected $links = array();

        public function __construct()
        {
            $this->subjects = new \Doctrine\Common\Collections\ArrayCollection();
        }

        /**
         * @ORM\ManyToMany(targetEntity="Subject")
         * @ORM\JoinTable(name="Article_to_Subject",
         *      joinColumns={@ORM\JoinColumn(name="articleId", referencedColumnName="articleId")},
         *      inverseJoinColumns={@ORM\JoinColumn(name="subjectId", referencedColumnName="subjectId")}
         *      )
         */
        protected $subjects;

        /**
         *
         * @return \Doctrine\Common\Collections\ArrayCollection 
         */
        public function getSubjects()
        {
            return $this->subjects;
        }        

        public function removeSubjects(){ $this->subjects = new \Doctrine\Common\Collections\ArrayCollection(); return $this;  } 
```

# php - 如何创建安全脚本 PHP + jquery

> ID：14199234
> 
> 赞同：0
> 
> 时间：2013-01-07T15:45:54.920
> 
> 标签：php, jquery, security

在我的 phpwebsite 中，当用户需要创建新帖子（例如）时，我将 jquery/post 发送到一个 phpscript 以执行此操作。但这不安全，我的意思是，每个人都可以使用相同的用户 ID 向该脚本发送一个假的 jquery/post，而无需登录。

这样做有什么安全的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:49:14.247

不要在 POST 中包含用户 ID。

相反，只需使用服务器上当前登录用户的 ID。

这假设您有一种安全的方式来跟踪登录会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T15:47:56.900

您可以提交当前用户的 userId。然后在 PHP 脚本中检查会话并评估发送的 userId 是否与登录用户的用户 id 相同。

# button - tkinter：删除一个按钮——保留空间

> ID：14199235
> 
> 赞同：0
> 
> 时间：2013-01-07T15:45:57.307
> 
> 标签：button, tkinter, width

看看这个代码示例：

```
from tkinter import *
root = Tk()

def createbuttons ():
    texts = ["Do this", "Do that", "Hide"]
    global btns
    btns = []
    for btn in texts:
        b = Button(root, text= btn, width=20)
        b.pack(side=LEFT, padx=15)
        btns.append(b)
    btns[2].config(command=hide)

def hide ():
    btns[0].pack_configure(padx=(15,105))
    btns[1].destroy()
    btns[2].pack_configure(padx=(105,15))

createbuttons()
root.mainloop() 
```

一切对我来说都很好，但这似乎是解决问题的新手。由于按钮宽度是像素和字符宽度的混合，我不知道需要添加多少像素，但在尝试了 10 次之后，它看起来不错，有 210 个像素（105 + 105）。

我的问题是：有没有更好的方法来做到这一点？或者至少是一种知道按钮占用多少像素的方法？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T19:09:03.047

一种选择是不删除您的按钮，而是在其上绘制一些东西。`hide`身体可能变成

```
f = Frame(root)
f.place(in_=btns[1], relwidth=1, relheight=1) 
```

这是另一个说明如何使用的答案`lower`和`lift` [https://stackoverflow.com/a/5928294](https://stackoverflow.com/a/5928294) 另一种选择是*绘制*框架代替按钮。

* * *

*在 Bryan Oakley 评论后编辑，最初的建议是：*

```
f = Frame(root)
geometry = btns[1].winfo_geometry()
size,x,y = geometry.split("+")
width, height = size.split("x")
f.place(x=x, y=y, width=width, height=height) 
```

# java - HoloEverywhere 覆盖 ActionBarSherlock 的 Theme.Sherlock

> ID：14199239
> 
> 赞同：0
> 
> 时间：2013-01-07T15:46:11.523
> 
> 标签：java, android, actionbarsherlock

这种错误就像一个黑魔法：

我正在尝试移植[https://github.com/SimonVT/android-timepicker](https://github.com/SimonVT/android-timepicker)以完成 Holo 样式（默认情况下，它只有 ICS timepicker 小部件，对话框仍然是 pre-Honeycomb）。

我使用 timepicker 的特殊属性扩展了 Theme.Sherlock，然后将其应用于整个应用程序。对话框看起来和默认的一样（上面提到过）。之后，我刚刚将 HoloEverywhere 库添加到项目中......黑色魔法出现了！Timepicker 小部件以某种方式丢失了一些视图，例如蓝线并更改了对话框中的位置。我仍然想知道这个故障的原因。

注意：在我的项目（代码）以及 TimePicker lib 中，我对 HoloEverywhere 一无所知

注意：我还更改了 timepicker 中的一些属性，因为它们与 HoloEverywhere 的属性冲突（因为“...属性已被声明”错误）

代码：

```
public class DialogSample extends SherlockFragmentActivity implements OnTimeSetListener {

    private TextView mTimeDisplay;

    private int mHour;
    private int mMinute;

    static final int TIME_DIALOG_ID = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_dialog);

        final Calendar c = Calendar.getInstance();
        mHour = c.get(Calendar.HOUR_OF_DAY);
        mMinute = c.get(Calendar.MINUTE);

        mTimeDisplay = (TextView) findViewById(R.id.timeDisplay);

        findViewById(R.id.btnDialog).setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                DialogFragment newFragment = new TimePickerFragment();
                newFragment.show(getSupportFragmentManager(), "timePicker");    
            }
        });

        updateDisplay();
    }

    // updates the time we display in the TextView
    private void updateDisplay() {
        mTimeDisplay.setText(
                new StringBuilder()
                        .append(pad(mHour)).append(":")
                        .append(pad(mMinute)));
    }

    private static String pad(int c) {
        if (c >= 10) {
            return String.valueOf(c);
        } else {
            return "0" + String.valueOf(c);
        }
    }

    static public class TimePickerFragment extends SherlockDialogFragment {

        @Override
        public TimePickerDialog onCreateDialog(Bundle savedInstanceState) {
            // Use the current date as the default date in the picker
            final Calendar c = Calendar.getInstance();
            int hour = c.get(Calendar.HOUR_OF_DAY);
            int minute = c.get(Calendar.MINUTE);

            return new TimePickerDialog(getSherlockActivity(), (DialogSample)getSherlockActivity(), hour, minute, true);
        }

        public TimePickerFragment() {

        }

    }

    @Override
    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
         mHour = hourOfDay;
         mMinute = minute;
         updateDisplay();

    }
} 
```

[https://github.com/SimonVT/android-timepicker](https://github.com/SimonVT/android-timepicker)

[https://github.com/SimonVT/android-numberpicker](https://github.com/SimonVT/android-numberpicker)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:57:05.740

如果我理解正确，您需要全息样式时间选择器和数字选择器。您可以 在不需要 SimonVT 的任何地方使用[holoe组件](https://github.com/ChristopheVersieux/HoloEverywhere)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T15:48:04.583

解决方案很棘手：我将 HoloEverywhere 添加到

1) NumberPicker 库 2) TimePicker 库 3) TimePicker 对话框库 4) 我的项目

但我仍然对此不满意，因为解决方案与问题一样不清楚

# android - 如何在android中删除edittextfield的边框

> ID：14199240
> 
> 赞同：7
> 
> 时间：2013-01-07T15:46:13.890
> 
> 标签：android, android-layout

如何在 android.xml 中删除 Edittext 字段的边框。实际上它看起来像这样

[http://pbrd.co/V34sN7](http://pbrd.co/V34sN7)

使用此布局代码

```
 <EditText
        android:id="@+id/login_error"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text=""
        android:background="@android:drawable/editbox_background_normal"
        android:visibility="invisible" 
        android:textColor="#FF0000"
        android:layout_gravity="right"
        /> 
```

尽管我定义了它，但文本的对齐方式也不在右侧。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-03-25T07:24:18.127

简单地说，您可以在`xml`文件中使用以下内容来使`EditText`背景清晰：

```
android:background="@null" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-17T06:58:33.223

程序化方法：

```
setBackgroundDrawable(null); 
```

或者，由于 setBackgroundDrawable() 在 API 16 中已被弃用：

```
if (Build.VERSION.SDK_INT >= 16)
    setBackground(null);
else
    setBackgroundDrawable(null); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-07T15:54:07.207

您可以`EditText`使用以下 xml 布局自定义您的

将以下代码另存为`yourWishName.xml`

```
<?xml version="1.0" encoding="UTF-8"?>
<selector
xmlns:android="http://schemas.android.com/apk/res/android">

//You can change the color of the edit text here which removes the border line as well
 <item android:state_focused="true" >
    <shape android:shape="rectangle">
        <gradient
            android:startColor="#FFFFFF"
            android:endColor="#FFFFFF"
            android:angle="270" />
        <stroke
            android:width="3dp"
            android:color="#F8B334" />
        <corners
            android:radius="12dp" /> 
    </shape>
</item>  
<item>
    <shape android:shape="rectangle">
        <gradient
            android:startColor="#FFFFFF"
            android:endColor="#FFFFFF"
            android:angle="270" />
        <stroke
            android:width="0dp"
            android:color="#000000" />
        <corners
            android:radius="12dp" /> 
    </shape>
</item>
</selector> 
```

在 EditText 中调用 xml`android:background="@drawable/yourWishName"`

右对齐使用`android:gravity="right"`

希望这可以帮助

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-07T15:53:02.223

您必须创建一个没有边框的自定义可绘制九个补丁文件。[在这里你可以找到一个教程](http://radleymarx.com/blog/simple-guide-to-9-patch/)而`android:layout_gravity="right"`不是意味着文本向右对齐。它将布局向右对齐。你必须使用`android:gravity="right"`.

# c# - 该项目当前包含对多个版本的引用

> ID：14199241
> 
> 赞同：12
> 
> 时间：2013-01-07T15:46:17.090
> 
> 标签：c#, visual-studio, visual-studio-2012, dependency-management, projects-and-solutions

我们最近升级到 VS2012 和 .NET 4.5。自从切换到 2012 年以来，我在调试时经常遇到这些错误：

> 编译器错误消息：BC32206：该项目当前包含对多个 NPGUtilities 版本的引用、对版本 2012.4.4751.24389 的直接引用和对版本 2012.4.4751.24391 的间接引用（通过“AdminWeb.targetweights.sgModels”）。将直接引用更改为使用 NPGUtilities 的 2012.4.4751.24391（或更高版本）版本。
> 
> BC32206：该项目当前包含对多个版本的 EnterpriseData 的引用，对版本 2012.4.4751.25227 的直接引用和对版本 2012.4.4751.25243 的间接引用（通过“SponsorWeb.selectplan.AdministratorXDataset1”）。将直接引用更改为使用 EnterpriseData 的版本 2012.4.4751.25243（或更高版本）。

这两个都是项目参考。我已经尝试删除和阅读它们，但仍然没有运气。任何人都可以就如何解决此问题提供任何建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-06-18T00:44:11.567

我能够通过删除文件`bin`夹中的所有文件然后重建项目来解决此问题。对我来说，问题是清理项目只是删除文件`bin\Debug`夹中的 DLL，而旧的 DLL 仍保留在`bin\Release`文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-20T16:13:29.790

首先是解决方法：我禁用了程序集版本自动增量！

注意到这个问题只出现在 Vs2013 中，有一个解决方案的副本完美运行 vs2010。vs2013 Build,rebuild,clean 解决方案，手动删除 ./bin 或 ./obj 或 %TEMP% 没有解决问题。我还在 Vs2013 中从头开始编写了一个新的解决方案，以避免来自 vs2010 的尸体：这个新解决方案只编译了两次：第三次错误再次出现，没有任何方法......机器中的某些东西很脏。

现在解释...

我在具有以下大纲的 86 项目的解决方案中遇到了同样的问题：“60.dll”是错​​误的 dll：

```
- 99.exe 
-- 80.dll
---- 70.dll
------- 60.dll
-- 81.dll
-- 82.dll
---- 60.dll 
```

所以发生BC32206错误是有原因的。

```
The project '99.exe' currently contains references to more than one version of '60.dll, 
a direct reference to version 4.11.5618.23545 and an indirect reference (through '82.dll') to version 4.11.5618.23549\. 
Change the direct reference to use version 4.11.5618.23549 (or higher) of '60.dll' 
```

请注意，版本仅在从 23545 到 23549 的修订中有所不同（因此只有“4”单位）：在某些重建中，此差异为“1”单位；记住这个数字是（自午夜/2 秒以来的秒数），我意识到出于某种原因，“60.dll”被编译了两次......无事可做：我没有找到任何不同的“60.dll”副本对应于较高值请求“23549”的日期时间。因此，确实存在 Vs2013 中的某些问题。

所以最后一次机会：我禁用了自动增量并将程序集版本固定到 XY0.0：这对于我的目的来说已经足够了，因为“60.dll”是综合版本的一部分，不应该单独部署（我仍然使用浏览正确文件的文件版本）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-11T16:29:41.673

我们有一个类似的问题，清洁没有解决。结果发现项目中意外包含了一个 bin 文件夹，因此引用的 dll 被签入到版本控制中。撤消包含并从 repo 中删除 dll 就可以了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-13T22:54:05.567

我发现问题是因为我无意中设置了错误的启动文件夹。例如，我的 PROJECT_A 依赖于 PROJECT_B，而 PROJECT_A 应该是启动项目。但是，我没有意识到 PROJECT_B 现在是启动文件夹。

PROJECT_A 使用对 PROJECT_B dll 的旧引用进行编译，然后 PROJECT_B 随后创建新版本并将该新版本复制到 bin 文件夹。

更正启动文件夹为我纠正了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-11T10:55:42.487

我有同样的“明显”问题，花了我一整天的时间试图解决。我已经彻底检查了我的项目依赖项，并且都指向相同版本的有问题的 dll。我什至对我的本地文件夹进行了核对，并将所有内容从 Subversion 中取出 - 还是一样。我运行了 Process Explorer 并搜索了 dll，却发现 .NET Reflector 正在引用旧的 dll。几天前，我在不同的 Visual Studio 解决方案中调试旧版本之前使用了 .NET Reflector，而 .NET Relector 在其文件夹之一中引用了旧的 dll。这可能会节省一些时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T15:51:39.897

如错误消息所示，您的库存在版本冲突。检查引用的版本以确保它们匹配，或者更好的是，确保您在主项目和子项目中使用对同一文件的引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-08T13:20:40.717

我有一个使用 JSON.net v10 和现代版 ASP Identity 的项目。JSON.net 使用的是旧版本的 http.formatting dll - 通过 Nuget 升级到最新版本为我解决了这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-02T14:59:24.353

我在远程调试时遇到了这个错误。被调试机器上引用的 dll 版本在功能上相同，但版本号与编译时引用的版本号不同。修复是替换正在调试的机器上的版本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-30T19:02:01.793

我的故事可能更像是一个边缘案例，但值得注意。

我正在开发一个允许开发 3rd 方插件的平台，使用他们提供的各种 SDK。

第 3 方插件被编译为 DLL 并上传到平台，并使用巫毒教和随机的家禽牺牲来加载它们（阅读：不确定它们是如何动态加载的）。

简单地说，我的问题是主程序和我的第 3 方 DLL 都引用了“fred.dll”。但我引用的是“fred.dll”的 1.1 版，而不是程序已加载的“fred.dll”的 1.0 版。在我的第 3 方组件中引用 1.0 版“fred.dll”解决了我的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-22T13:12:50.683

正如其他人所提到的，此错误可能是由于项目的 AssemblyInfo.file 中的自动增量功能引起的。

我们最初有 AssemblyVersion 之类的

```
<Assembly: AssemblyVersion("4.6.1")> 
```

我改成

```
<Assembly: AssemblyVersion("4.6.1.*")> 
```

那是错误。我开始有这个问题。我以为我只需要删除 .* 但它仍然不起作用，因为没有 .* 的程序集的版本号低于自动生成的版本号。

因此，为了修复，我在 web.config 文件的命名空间部分中引用了程序集。我删除了它并运行了项目，但出现了一些运行时错误。然后我添加了命名空间项，错误就消失了。

如果您的程序集位于 web/app.config 的命名空间部分，请试一试。

编辑：我的一位同事在做了这个技巧后仍然有这个问题。**更好的解决方案是简单地清除临时 ASP .NET 文件夹**。（C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET 文件）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-07T18:30:05.240

我通过编辑 .DTSX 文件并将“Microsoft SQL Server\100\SDK\Assemblies”的**所有实例**替换为“Microsoft SQL Server\120\SDK\Assemblies”，为我的 SSIS 包中的所有脚本任务解决了这个问题。

我做了“替换”，然后在 VS 2013 中刷新，所有错误都消失了。

请注意，这些引用已经引用了版本 12，但“HintPath”仍然引用了“\100\”路径。我假设这是问题的根源。

以下是 .DTSX 文件前后的 XML 片段：

前：

```
<ItemGroup>
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=12.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>..\..\..\..\..\..\..\..\Program Files (x86)\Microsoft SQL Server\100\SDK\Assemblies\Microsoft.SQLServer.ManagedDTS.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=12.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup> 
```

后：

```
 <ItemGroup>
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=12.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>..\..\..\..\..\..\..\..\Program Files (x86)\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SQLServer.ManagedDTS.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=12.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-12-02T18:41:03.287

我能够通过在“违规”项目的 AssemblyInfo.cs 文件中将 [assembly: AssemblyVersion("1.0.*")] 更改为 [assembly: AssemblyVersion("1.0.5814.0")] 来清除报告的冲突。

根据以下观察，这似乎是一个 IDE 问题：

*   每次启动 Visual Studio 都会报告不同的版本；
*   例如，在修订版 1.0.5814.18599 和 1.0.5814.18600 之间。
*   而所有 bin 文件夹中的实际修订版本为 ...17929。

显然，VS 在启动时会检测并“缓存”冲突。清洁或重建没有帮助。

此外，似乎只有 C# 类库会带来这种行为。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-10-05T04:48:59.900

我只是进入“NuGet”并卸载了与冲突库相关的所有包。然后我再次小心地重新安装，确保每个项目都具有相同的（最新）版本号。我正在使用“cEfSharp”模块，但错误地混合安装了版本 57 和 51。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-05T10:07:56.970

我的问题与 Microsoft.SqlServer.SMO dll 集有关。我的决心再次与其他人完全不同。请注意，它适用于 Visual Studio 2017，v15.8.6。据我所知，这个问题有多种原因，我的解决方案不是清洁或装配自动编号。

在工作区 1 中构建的所有内容，但在工作区 2 中，由于以下原因，我遇到了上述问题： Microsoft.SqlServer.SMO 命名空间有大约 10 个左右的 dll 都设置为特定版本。正确找到了 8 个 dll，直接引用和版本特定。但是 2 有一个提示路径，但不是特定于版本的，也没有在提示路径中找到。因此，它将这两个默认设置为在较新版本的 GAC 中找到的。一旦我将丢失的两个 dll 复制到提示路径中，并将它们设置为特定于版本，一切正常。

为了确保，我确实手动编辑了项目文件以将每个引用设置为所需的旧版本，并且还在 app.config 中将程序集绑定重定向添加到旧版本以进行良好的测量。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2017-07-17T07:14:07.087

就我而言，清理和构建工作正常

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2015-01-14T18:39:28.110

尝试删除所有 bin/debug/* 东西

# ruby - 如何在 Ruby 中使用大括号扩展？

> ID：14199242
> 
> 赞同：3
> 
> 时间：2013-01-07T15:46:20.857
> 
> 标签：ruby

假设我想要以下规格：

```
it { should allow_value("git://host.xz/path/to/repo.git/").for(:url) }
it { should allow_value("git://user@host.xz/path/to/repo.git/").for(:url) }
it { should allow_value("git://host.xz:123/path/to/repo.git/").for(:url) }
it { should allow_value("git://user@host.xz:123/path/to/repo.git/").for(:url) }
... 
```

如果我可以这样写会更容易，更紧凑：

```
"git://{user@,}host.xz{:123,}/path/to/repo.git".expand.each do |p|
  it { should allow_value(p).for(:url) }
end 
```

甚至更好：

```
"{git,ssh,http,https,rsync}://[user@]host.xz[:123]/path/to/repo.git[/]".expand.each do |p|
  it { should allow_value(p).for(:url) }
end 
```

有哪些方法可以在 Ruby 中实现这一点？

**编辑** 我尝试的第一件事是[basscomp](https://rubygems.org/gems/bracecomp)，但我无法让它在 1.9.3 中工作。

```
[1] pry(main)> require 'bracecomp'
[2] pry(main)> 'server-{a,b}-{07..10}'.expand
TypeError: scan() yielded Symbol (must be Array[2])
from bracecomp.y:66:in `scan' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:06:11.683

怎么样

```
%w[git ssh http https rsync].product(['user@', nil], [':123', nil]).each do |protocol, user, port|
  it { should allow_value("#{protocol}://#{user}host.xz#{port}/path/to/repo.git").for(:url) }
end 
```

不依赖外部库，每个 Ruby 开发人员都可以理解。

尽管这确实需要规范助手或自定义匹配器，但我认为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T16:35:27.900

[大括号comp-0.1.2](http://rubygems.org/gems/bracecomp)可用于执行大括号扩展。下面是取自 gem 主页的示例：

```
require 'bracecomp'
p 'server-{a,b}-{07..10}'.expand
#=> ["server-a-07", "server-a-08", "server-a-09", "server-a-10", "server-b-07", "server-b-08", "server-b-09", "server-b-10"]
p 'zone-{a..c}'.expand
#=> ["zone-a", "zone-b", "zone-c"] 
```

# .htaccess - 仅当 index.php 文件不存在时，如何将 url 重写为其他文件

> ID：14199248
> 
> 赞同：0
> 
> 时间：2013-01-07T15:46:42.940
> 
> 标签：.htaccess

我有几个域的以下文件结构：

```
/index.php [optional. for some domains no index.php file]
/content.php [always present] 
```

`example.com`如果用户请求类似or的 URL `example.com/`，我想检查`index.php`服务器上是否存在并将他发送到`index.php`. 但如果`index.php`服务器上不存在我应该将他发送到`content.php`. 此外，如果请求的 URL 类似于`example.com/test`or `example.com/test/test2`，请将他发送到`content.php`.

我在 中写过类似的东西`.htaccess`，但它不检查是否`index.php`存在。

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^([^.]+)/([^.]+)?$ content.php?category=$1&slug=$2 [L]
RewriteRule ^([^.]+)?$ content.php?category=$1 [L]
#RewriteRule ^*$ content.php [L] 
```

我应该如何修改上面的代码来检查是否存在`index.php`？还有任何优化该代码的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T19:43:31.220

您不能将 content.php 添加到[DirectoryIndex](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)指令吗？例如

```
<IfModule mod_dir.c>
DirectoryIndex index.php content.php
</IfModule> 
```

我认为不可能检查文件是否存在于重写规则中。

# javascript - jquery 一个表从另一个表继承高度

> ID：14199249
> 
> 赞同：0
> 
> 时间：2013-01-07T15:46:44.343
> 
> 标签：javascript, jquery, html, css

我有两张桌子，数量相同。它们都是动态加载的，我无法合并它们。例如，它们的外观如下：[LINK](http://jsfiddle.net/4pdCq/2/)

第一个表的内容是从数据库加载的，有时用户可以在 td 中输入 3 或 4 行文本（这就是为什么我不能声明 table/tr/td 高度的原因）。第二个表的内容总是相同的（总会有一行文本）

是否有可能（使用 javascript/jquery），表 2 以某种方式从表 1 继承表行高度（如果用户输入更长的文本）并完美对齐这里：[链接](http://jsfiddle.net/4pdCq/3/)？

我正在尝试这样做，但我完全不知道如何检查元素的高度而不先在 css 中声明它：

```
var tableH = $("#table1 tr").height();
$("#table2 tr").css("min-height", tableH); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:04:45.423

这非常接近

```
var itemNum = 0;

$("#table1 tr").each(function() {
  $("#table2 tr:nth-child(" + (itemNum+1) + ")").height( $(this).height() );
  itemNum++;
}); 
```

**编辑**

为 itemNum 添加了 +1。`nth-child`是从 1 开始的。似乎在你的小提琴上工作

**编辑 2**

根据第三方的建议，这可以简化为

```
$("#table1 tr").each(function(itemNum) {
  $("#table2 tr:nth-child(" + (itemNum+1) + ")").height( $(this).height() );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:09:17.040

从语义上讲，合并表是有意义的。这是一些可以做到这一点的快速代码：

```
jQuery(function($) {
  var table2Rows = $("#table2 tr");
  $("#table1 tr").each(function(i) {
    table2Rows.eq(i).contents().appendTo(this);
  });
}); 
```

**[演示](http://jsfiddle.net/thirdender/4pdCq/9/)**

如果您使用 jQuery 或服务器端代码生成表，那么（如果可能）而不是稍后（使用此代码）进行合并是有意义的。

另外，我注意到第二个表格中的一些单元格是空的……我更新了代码以使第一个表格中的单元格伸展（增加`colspan`）以填充该空白区域：[请参阅更新的 jsFiddle](http://jsfiddle.net/thirdender/4pdCq/10/)。

此外，我认为从语义上讲，将每天的活动作为单独的 TBODY 会更有意义：[请参阅更多更新的 jsFiddle](http://jsfiddle.net/thirdender/4pdCq/12/) :-p

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:02:50.383

像这样的东西怎么样：

```
$('#table2 td').each(function () {
  $(this).height($($('#table1 td')[$(this).index()]).height());
}); 
```

（未经测试）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:07:09.607

我很好奇您为什么要使用 TR 执行此操作并尝试获取行高。

根据您用于获取数据的技术，将有一些组合数据的好方法。它是以 JSON 形式出现的吗？

也许您可以将其构建为流动行，并在添加记录时使用跨度使它们保持对齐。

此外，它还会在您添加数据时防止它失去对齐。

[http://jsfiddle.net/4pdCq/7/](http://jsfiddle.net/4pdCq/7/)

我导入了 bootstrap.css 来完成这项工作。

```
<div class="row-fluid rowBorder">
  <div class="span4">Subject</div>
  <div class="span2">Hour</div>
  <div class="span4">Users</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span10">Monday</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span4">English English English english english english</div>
  <div class="span2">3pm</div>
  <div class="span4">User1</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span4">Espanol</div>
  <div class="span2">4pm</div>
  <div class="span4">User2</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span10">Tuesday</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span4">Italian</div>
  <div class="span2">1pm</div>
  <div class="span4">User3</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span4">French</div>
  <div class="span2">2pm</div>
  <div class="span4">User4</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span10">Wednesday</div>
</div>
<div class="row-fluid rowBorder">
  <div class="span4">Japanese</div>
  <div class="span2">10pm</div>
  <div class="span4">User5</div>
</div> 
```

# c - c上的位解析程序

> ID：14199250
> 
> 赞同：1
> 
> 时间：2013-01-07T15:46:54.293
> 
> 标签：c

我正在尝试确定可用于解析字节的特定位的逻辑，我想检查它是否已设置，如果已设置，则仅转到特定的代码行。我应该能够对二进制值执行 AND 或 OR 操作，但是如果位的位置是第三位或其他位置然后 MSB 和 LSB，我将无法在代码中使用真或假条件，而是我将不得不使用 AND 或 OR 操作来比较值。

例如，如果 AND 操作是 00100000，那么我必须将它与 00100000 进行比较并执行条件语句。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T15:51:46.853

如果要测试字节的第 N位（对于正常的 8 位字节，N = 0..7），可以使用^：

```
if (byte & (1 << N))
    ...Nth bit is set... 
```

测试条件只是检查表达式是 0（假）还是非零（真）。您可以通过以下方式明确说明：

```
if ((byte & (1 << N)) != 0)
    ...Nth bit is set... 
```

您可以使用以下命令设置第 N^位：

```
byte |= 1 << N; 
```

您可以使用以下命令重置（归零）第 N^位：

```
byte &= ~(1 << N); 
```

您可以使用以下方法翻转或切换第 N^位：

```
byte ^= (1 << N); 
```

尽管我`byte`自始至终都使用了这个名称，但只要您的移位在正确的范围内，您就可以使用任何整数类型的任何位来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T15:56:30.643

它是这样工作的：

首先要注意的是值0在C测试中为假，任何其他值都被认为是真。

然后，要测试是否设置了某个位，请使用以下测试（我几年前制作的一组宏之一）

`#define IS_SET(number, position) (number & (1 << position))`

那么你可以像这样使用它：

`if(IS_SET(15,2)){ }`. 但是请注意，位计数从最右边的位开始向左移动，从最右边的位开始计数`0`。

以下是宏的实际工作方式（注意，这适用于所有整数类型，8 位、16 位、32 位等）按位表示的数字`15`在`0x0F = 0000 0000 0000 0000 0000 00000 1111 1111`32 位机器上。

左移`1`2 次，成功`0000 0000 0000 0000 0000 0000 0000 0100`

对这两个数字进行 AND 运算得到：

```
0000 0000 0000 0000 0000 0000 1111 1111
0000 0000 0000 0000 0000 0000 0000 0100 &
------------------------------------------
0000 0000 0000 0000 0000 0000 0000 0100 (which is not 0, hence true)
------------------------------------------ 
```

这样，您可以测试要设置或清除的位序列中的任何位置。

# spss - SPSS 获取工作目录

> ID：14199254
> 
> 赞同：4
> 
> 时间：2013-01-07T15:47:08.380
> 
> 标签：spss

我正在使用 SPSS 19 并且想获取当前工作目录以使用 INSERT 命令来调用其他语法文件。有人知道怎么做吗？似乎有一个 Python 命令（SpssClient.GetCurrentDirectory()），但它返回一个乱码错误代码（我喜欢这堆叫做 SPSS 的废话......）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T15:10:24.363

您可以像这样使用可编程 API，而不是使用脚本 API。

```
begin program.  
import spss, spssaux  
workingdir = spssaux.getShow("DIRECTORY")  
spss.Submit("""FILE HANDLE cwd /NAME="%s".""" % workingdir)  
end program. 
```

这定义了一个名为`cwd`.

另请注意，它`INSERT`有一个`CD`关键字，可将后端工作目录更改为`FILE`.

HTH，乔恩·派克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T10:19:44.887

After some googling I found a working method:

```
BEGIN PROGRAM.
import spss
import SpssClient
CONST_FHandleName = 'CurrentDir'

#SpssClient.StartClient() /stop nötig, sonst gibt es Probleme mit dem zugriff auf SPSS
try:
    SpssClient.StartClient()
    syntaxpath =SpssClient.GetDesignatedSyntaxDoc()
                currentdir = os.path.dirname(syntaxpath.GetDocumentPath())
    FHandle="File handle " + CONST_FHandleName + " /name='" + currentdir + "'"
finally:
    SpssClient.StopClient()
print "The FHandle Dir is now: " + currentdir 
print "The FHandle Dir is now: " + FHandle

spss.Submit(FHandle)
END PROGRAM. 
```

This program will get the directory of the current Syntax-File and set the directory as a file handle. Of course, this is not the real working directory, but a approximation that works for me.

Caution:

spss.getworkingdirectory returns apparently the first startup folder - NOT the folder of the active dataset (great if you startet SPSS first and then loaded the dataset - it will still point to its home directory, where it cannot write. SPSS 19 behaviour...)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-30T18:53:24.930

我已经能够让 SPSS 18 将它启动的目录设置为默认目录。选择编辑 > 选项 > 文件位置。在数据文件和其他文件框中输入单个句点。每当您通过单击数据或语法文件启动 SPSS 时，它将默认为当前目录，即启动它的目录。适用于 SPSS18、ymmv 和其他版本。

顺便说一句，同样的技巧适用于 Excel，但我还没有找到任何其他适用的应用程序。在我看来，这是程序应该工作的方式，而不是强迫你进入一些你不想要的目录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-28T20:40:21.203

在 SPSS V23 中尝试

```
CWD.
SHOW DIRECTORY. 
```

如果无法识别命令 CWD，请下载/安装 CWD（“当前工作目录”）扩展。选择实用程序 > 扩展包 > 下载并安装扩展包，然后搜索 CWD。

# algorithm - 增加一组数字，使 XOR 和为 0

> ID：14199255
> 
> 赞同：3
> 
> 时间：2013-01-07T15:47:10.930
> 
> 标签：algorithm, optimization, bit-manipulation, dynamic-programming, xor

我需要一些帮助来解决我已简化为以下问题的问题。我有 N 个 30 位数，因此它们的组合 XOR 是非零的。我需要为 N 个数字中的每一个添加一个非负（0 或更多）值，使得新数字的组合 XOR 变为 0，在总相加值（而不是相加数）最小化的约束下.

例如，如果我将数字 (01010) [2]、 (01011) [2]和 (01100) [2]作为三个数字 (N = 3)。然后，它们的组合 XOR 是 (01101) [2]。我们可以添加一些数字，如下所示：

*   (01010) [2] + (00001) [2] = (01011) [2] : (+1)
*   (01011) [2] + (10000) [2] = (11011) [2] : (+16)
*   (01100) [2] + (00100) [2] = (10000) [2] : (+4)

现在，新数字的总异或为 0，总加法为 21（=+1+16+4）。这个总附加值必须**最小化**（可能有一个更好的分布来减少这个总数，但这只是一个*例子*）。

这些数字每个都是 30 位，所以这些数字可能很大，并且 N <= 15。如果有人能展示一些有效的方法来解决这个问题，我将不胜感激。我怀疑 DP 解决方案是可能的，但我无法制定任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-11T04:05:12.970

好问题：）

我想出了一种在 O(n * 2^n * 31 * n) 中运行的方法，对于 n = 15，对于一个测试用例来说它有点慢（228556800）。以下是详细信息：

我在这里使用了 dp 方法（memoization），我们将状态定义为（int mask, int pos）：

*   面具

    0 <= mask < 2^n - 1，如果 2^i & mask > 0，表示之前已经添加了数字 i，所有低位 (<=pos) 都可以视为零。

*   位置

    当前校验位位置，从高到低开始

我们从最高位到最低位开始，每次检查当前位设置的给定数字的计数时，我们将其表示为 one_cnt，如果

*   one_cnt 是偶数

    当前 pos 的 xor 为零，我们只是移动到 (mask, pos - 1)

*   one_cnt 是奇数

    **如果 one_cnt 等于 n（全奇数），这里我们认为是一个坏状态并且什么也不做**。否则，我们迭代在 pos 处包含零的数字并尝试在此处放置一个。

请注意，当 one_cnt 为全奇数时，我们将其视为不良状态，因为我们不想增加到 (pos + 1) 可能会影响之前的状态（违反 dp 原则）。

但是会有这样的情况： arr = [1, 1, 1] 并且解决方案存在。所以在这里我们尝试做一些额外的计算：

我们从最高位 pos 开始，检查当前位是否包含**甚至一位**，如果是，我们迭代数字以将 1 设置为当前 pos 中为零的数字，然后我们开始记忆并更新我们的结果。

例如，如果 arr = [1, 1, 1]，我们可以检查 [2, 1, 1], [1,2,1], [1,1,2]

希望我已经解释得很好。

如果我想出更快的方法，我会更新解决方案:)

这是代码：

```
#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <string>
#include <cstring>
#include <cmath>
#include <algorithm>
#include <vector>
#include <set>
#include <map>
#include <ctime>
#include <cassert>

using namespace std;

#define fs first
#define sc second
#define pb push_back
#define mp make_pair
#define range(i, n) for (long long i=0; i<(n); ++i)
#define forit(it,v) for(typeof((v).begin()) it = v.begin() ; it != (v).end() ; ++it)
#define eprintf(...) fprintf(stderr, __VA_ARGS__),fflush(stderr)
#define sz(a) ((int)(a).size())
#define all(a) (a).begin(),a.end()
#define two(i) (1LL<<(i))

typedef long long ll;
typedef vector<int> VI;
typedef pair<int, int> PII;

int n;
vector<ll>  arr;
ll ans;
map<PII, ll> M;

void update(ll & ret, ll tmp) {
    if (tmp == -1) return;
    if (ret == -1) ret = tmp;
    ret = min(ret, tmp);
}

/*
 * memoization(mask, pos)
 * Args:
 * mask: if 2^i in mask it means arr[i] has been added a high bit before, and all lower bit(<=pos) can be considerd zero.
 * pos: current check bit position, start from high to low
 * Return:
 *  return -1 if not valid ans exists else return minimum addition sum 
 */
int memoization(int mask, int pos) {

    if (pos < 0) {
        return 0;
    }

    PII state = mp(mask, pos);
    if (M.find(state) != M.end()) {
        return M[state];
    }

    ll &ret = M[state];
    ret = -1;

    int one_cnt = 0;
    for (int i = 0; i < n; i++) {
        if ( !(mask & two(i)) && 
                (two(pos) & arr[i])) {
            one_cnt ++;
        }
    }

    if (one_cnt % 2 == 0) { // even, xor on this pos equals zero
        ret = memoization(mask, pos - 1);
    } else {
        if (one_cnt == n)  { //full odd  bad state, do nothing
            //pass
        } else { //not full odd, choose one empty bit  to place 1  
            for (int i = 0; i < n; i++) {
                if ((mask & two(i))  //if number i has been added before, then it contain zero at pos 
                        || !(two(pos) & arr[i])  // or if number i has zero at pos and hasn't been added before
                        ) {
                    ll candi = memoization(mask | two(i), pos - 1);
                    ll added = mask & two(i) ? two(pos)  // number i has been added before, so we need extra two(pos) sum
                        //number i hasn't been added before, we need calc the new sum 
                        //here we only consider bits in [0 .. pos]
                        : two(pos) - arr[i] % two(pos + 1); 
                    if (candi >= 0)  // legal result
                        update(ret,  candi + added);
                }
            }
        }
    }

    return ret;
}

int main() {
#ifndef ONLINE_JUDGE
    freopen("g.in", "r", stdin);
#endif
    while (cin >> n) {
        arr.clear();
        for (int i = 0; i < n; i++) {
            ll val;
            cin >> val;
            arr.push_back(val);
        }

        ll max_val = arr[0];
        for (int i = 1; i < n; i++) max_val = max(max_val, arr[i]);

        int max_pos = 0;
        while (max_val) max_pos ++, max_val >>= 1;
        max_pos ++;

        //no adjust
        M.clear();
        ans = memoization(0, 31);

        bool even_bit = true;
        for (int i = max_pos; i >= 0; i--) {
            int one_cnt = 0;

            for (int j = 0; j < n; j++) one_cnt += (two(i) & arr[j]) > 0;
            even_bit &= one_cnt % 2 == 0;

            if (even_bit) {
                for (int j = 0; j < n; j++) {
                    //arr[j] at pos i is empty, try add to 1
                    if (!(two(i) & arr[j])) {
                        ll backup = arr[j];
                        arr[j] = two(i);

                        //since previous pos all contain even one bits, we just start from current pos i
                        M.clear();
                        ll candi = memoization(0, i);
                        ll added = two(i) - backup % two(i);
                        if (candi >= 0) 
                            update(ans, candi + added);

                        arr[j] = backup;
                    }
                }
            }
        }
        cout << ans << endl;
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T19:21:16.717

算法：

查找 k，即给定数字（在您的示例中为 4）的异或和的最高有效位的位置。确定是否所有给定的数字都设置了给定的位（如您的示例中所示）。

如果他们这样做，那么您必须增加两个给定数字，以便它们的最高有效位将位于位置 k+1。要确定女巫，您应该强制所有数字对并增加其中一个直到它变为 2^(k+1) 和另一个直到 xor-sum 等于 0。然后选择最佳对。

如果他们不这样做，那么你只需要增加一个给定的数字，它的第 k 位为 0。要确定女巫，你应该暴力破解所有这些数字并增加它们直到 xor-sum 等于 0 .然后选择最好的一个。

要确定其中一个数字应增加多少以使所有数字的异或和变为 0，请计算所有其他数字的异或和并从中减去必须增加的数字。

# iphone - 按下时如何获取 UIButton 的标题

> ID：14199256
> 
> 赞同：12
> 
> 时间：2013-01-07T15:47:12.377
> 
> 标签：iphone, objective-c, ios, uibutton

我试图找出在以下代码中按下 UIButton 的 UIButton 标题是什么。

在 viewDidLoad 上，按钮标题使用以下命令输出到控制台：

```
 NSLog(@"The button title is %@ ", btn.titleLabel.text); 
```

我想在按下按钮时获得这个标题。

谢谢你的帮助

:)

```
// Create buttons for the sliding category menu.
        NSMutableArray* buttonArray = [NSMutableArray array];
        NSArray * myImages = [NSArray arrayWithObjects:@"category-cafe-unsel.png", @"category-food-unsel.png", @"category-clothing-unsel.png", @"category-health-unsel.png", @"category-tech-unsel_phone.png" , @"category-tech2-unsel.png", @"catefory-theatre-unsel.png", @"category-travel-unsel.png", nil];

        // only create the amount of buttons based on the image array count
        for(int i = 0;i < [myImages count]; i++)
        {
            // Custom UIButton

            btn = [UIButton buttonWithType:UIButtonTypeCustom];

            [btn setFrame:CGRectMake(0.0f, 20.0f, 52.0f, 52.0f)];
            [btn setTitle:[NSString stringWithFormat:@"Button %d", i] forState:UIControlStateNormal];
            [btn setImage:[UIImage imageNamed:[myImages objectAtIndex:i]] forState:UIControlStateNormal];

            NSLog(@"The button title is %@ ", btn.titleLabel.text);

            [btn addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];
            [buttonArray addObject:btn];

            NSLog(@"Button tag is: %d",btn.tag);

        } 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-07T15:52:15.717

在你的行动中：

```
- (void) buttonPressed:(UIButton*) sender {
    NSLog(@"The button title is %@",sender.titleLabel.text);
} 
```

**编辑**：或如评论 Iulian：，`sender.currentTitle`但可能是`nil`，请参阅 Michael 的评论。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-07T15:50:45.133

你应该在某个地方有这个功能......

```
- (void)buttonPressed:(id)sender 
```

把这个放在里面...

```
- (void)buttonPressed:(id)sender
{
    UIButton *someButton = (UIButton*)sender;

    NSLog(@"The button title is %@ ", [someButton titleForState:UIControlStateNormal]);

    //You should also be able to use...
    //NSLog(@"The button title is %@ ", someButton.titleLabel.text);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-30T07:17:36.887

```
NSString * strButtonTitle = [btnButton titleForState:state]; 
```

其中状态：

```
UIControlStateNormal,
UIControlStateHighlighted,
UIControlStateDisabled,
UIControlStateSelected,
UIControlStateFocused,
UIControlStateApplication,
UIControlStateReserved 
```

为您的要求

```
NSString * strButtonTitle = [btnButton titleForState:UIControlStateSelected]; 
```

这是在程序中的任何给定时间获取按钮不同状态标题的方法......但基于**Zaphod**的问题答案是好的。

# mysql - 如何提高大型 InnoDB 表的 LOAD DATA 性能？

> ID：14199264
> 
> 赞同：1
> 
> 时间：2013-01-07T15:47:52.303
> 
> 标签：mysql, performance, innodb, load-data-infile

我有这个超过 700 万行的表，我`LOAD DATA LOCAL INFILE`一次将 50 万行的更多数据放入其中。前几次很快，但这个添加时间越来越长，可能是由于索引开销：

```
CREATE TABLE `orthograph_ests` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `digest` char(32) NOT NULL,
  `taxid` int(10) unsigned NOT NULL,
  `date` int(10) unsigned DEFAULT NULL,
  `header` varchar(255) NOT NULL,
  `sequence` mediumblob,
  PRIMARY KEY (`id`),
  UNIQUE KEY `digest` (`digest`),
  KEY `taxid` (`taxid`),
  KEY `header` (`header`)
) ENGINE=InnoDB AUTO_INCREMENT=12134266 DEFAULT CHARSET=latin1 
```

我正在开发一个将在预先存在的数据库上运行的应用程序。我很可能无法控制服务器变量，除非我强制更改它们（我不希望这样做），所以我担心[这些](https://stackoverflow.com/questions/5020998/how-to-speed-up-a-data-loading-into-innodb-load-data-infile)建议的用处有限。

我已经读过最小化此表上的键会有所帮助。但是，我需要这些键用于以后的查询。我猜如果我放弃并重新创建它们也需要很长时间，但我还没有测试过。我也读过，特别是`UNIQUE`约束使插入速度变慢。该`digest`列将采用*必须*唯一的 SHA256 摘要，我无法确保没有冲突（我知道，这不太可能，但可能）。

[正如这里](http://derwiki.tumblr.com/post/24490758395/loading-half-a-billion-rows-into-mysql)所建议的那样，分区会有所帮助吗？我可以改进索引，例如通过限制`digest`列上的键长度吗？我应该更改为在交易期间支持的 MyISAM`DISABLE KEYS`吗？我还能做些什么来提高`LOAD DATA`性能？

**编辑：**

大插入后，这张表只用于`SELECT`s，不再写入。这种大型加载主要是一次完成的操作，但是在完成之前需要上传大约 1,000 个数据集（每 0.5M 行）。

我将使用摘要来查找行，这就是我索引该列的原因。如果发生冲突，则不应上传该单独的行。

将`sequence`blob 放入外部文件系统可能不是一个可行的选择，因为我不能轻易地将文件系统更改强加给用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:55:28.087

这确实是您正在加载的大量数据，您应该预计它会花费数十个小时，尤其是在通用共享服务器硬件上。几乎没有什么魔力（除非你在谷歌或其他什么公司工作）可以让这份工作变得不那么痛苦。所以要有勇气。

这是一个参考表。这意味着您应该立即切换到 MyISAM 并为这张桌子留在那里。您不需要 InnoDB 的事务完整性功能，但您确实需要 MyISAM 在加载期间禁用索引并在之后重新启用它。重新启用索引将需要很长时间，因此请为此做好准备。

您应该考虑使用比 SHA-256 更短的哈希值。SHA-1（160 位）很好。信不信由你，MD-5（128 位）也可以使用。MD-5 已被破解，因此不适合安全内容认证。但它仍然是一个有用的哈希。从您的角度来看，较短的散列是更好的散列。

如果您可以禁用索引 MyISAM 样式，那么您的摘要键是否唯一可能并不重要。但是您可能会考虑允许它是非唯一的以节省时间。

如果不了解您的数据和服务器硬件的更多信息，就很难提出有关分区的建议。但考虑到这是一个参考数据库，似乎只需要咬紧牙关几个星期再加载它可能是明智之举。

如果您有足够的服务器磁盘空间，您可以考虑将每个半兆块加载到自己的表中，然后将其插入到大表中。这可能被证明是一种很好的方式来处理您可能需要在某天重新加载整个内容的可能性。

在共享服务器硬件上，使用比半兆行更小的块可能是有意义的。

您可能会考虑制作一个单独的 id / 摘要表。然后，您可以在没有摘要的情况下加载数据并快速完成。然后，您可以自己编写一个存储过程或客户端，以每批几千行的形式创建摘要，直到它们完成为止。这仅在被消化的内容在您的数据集中时才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T16:30:31.567

数据加载缓慢主要有两个原因：

1.  插入数据本身的写入性能。
2.  读取现有数据以加载现有数据以便在添加新数据时修改现有页面的性能。

可以通过主要降低持久性和减少日志记录来解决写入性能问题。这就是您会发现的许多建议，例如以下设置：`innodb_flush_log_at_trx_commit=0`、`innodb_doublewrite=0`、`innodb_support_xa=0`。减少写入的数据*量*也很有帮助，例如通过设置`log-bin=0`. 但是，期望您的客户在现有生产系统中更改这些与耐用性相关的设置也是不可接受的。更改它们更适合在专用系统上一次性批量加载，而不是定期向现有系统添加数据。

批量加载`INSERT`（多行）或通过在单个事务中写入更多数据`LOAD DATA INFILE`来降低写入*吞吐量要求，从而减少事务日志的同步次数。*降低写入吞吐量或提高写入性能只能在一定程度上有所帮助。

在加载之前对数据进行排序通常也很有帮助`PRIMARY KEY`，以便在将数据插入索引结构时减少不必要的页面拆分量。然而，当有多个辅助键时，这是有限的用途，因为排序`PRIMARY KEY`必然意味着数据不是按至少一个辅助键排序的。

读取性能问题可能更有趣，并且通常是将新数据加载到现有表中的实际性能问题，尤其是在存在辅助键的情况下。最好的可能是所有现有数据都适合内存（`innodb_buffer_pool_size`足够大），以便在加载期间不需要将数据分页进出缓存。鉴于您只谈论几百万行，这可能是可行的。

# xcode - 使用 UIButton 的动画

> ID：14199266
> 
> 赞同：0
> 
> 时间：2013-01-07T15:47:58.803
> 
> 标签：xcode, animation, uibutton

如何在按住 uibutton 的同时移动 uiimageview？旧代码就像您必须按 2 或 3 次才能再次移动，而长按不起作用，因为它在内部进行了修饰。

```
-(IBAction) MoveRightButton : (id) sender {

[self animateRight];
[self rightTimer];

}

-(IBAction) stopRight {

[image stopAnimating];
[rightTimer invalidate];
}

-(void) animateRight {
with animateRight images and start animating.
}

-(void) goRight {
[UIView animateWithDuration : 0.5 animation : ^{
image.frame = CGRectMake (image.frame.origin.x + 10, image.frame.origin.y,image.frame.size.width, image.frame.size.height);
}];
[self stopRight];
}

-(void) rightTimer {
rightTimer = [some NSTimer with selector of (goright)]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:27:42.400

Create two IBAction methods for your UIButton using sent events;

**Touch Down** - The associated method will be called when the button is *first pressed*.

**Touch Up Inside** - The associated method will be called when the button is *released*.

So in the "Touch Down" method, begin the animation as you have it, and in the "Touch Up Inside" method - stop it using something like:

```
#import <QuartzCore/QuartzCore.h>

[myView.layer removeAllAnimations]; 
```

* * *

EDIT:

**(1)** View your **.xib**, and create a UIButton.

**(2)** Hold *"alt"* down and click your **.h** file. This'll bring up that file in the assistant editor - but will enable you to still work on the xib.

**(3)** Hold down *"ctrl"*, and then click-drag from the UIButton to the **.h** file (below @interface).

**(4)** In the resulting pop-up, select "*Action*" in the *connection* field and name your method. The *event* field contains many options, of which you're interested in **Touch Down** and **Touch Up Inside**. Choose one, and click connect.

**(5)** Repeat for the event you didn't do in **(4)** (but obviously change the name). Those methods will have automatically been created in your **.m** file so go there and edit them as you please!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:50:29.790

尝试映射此操作

```
UIControlEventTouchDownRepeat instead of UIControlEventTouchUpInside 
```

方法

> -（IBAction）MoveRightButton：（id）发件人

# android - ListView 最后一项之后的分隔符（分隔符）

> ID：14199274
> 
> 赞同：53
> 
> 时间：2013-01-07T15:48:10.583
> 
> 标签：android, android-listview

当我创建一个只有一个 ListView 的简单布局时，最后一项之后**没有显示分隔符**，看起来有点难看。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true" />
</RelativeLayout> 
```

![在此处输入图像描述](../Images/a4cbefe2d32cfd67b6505c21af24fc92.png)

但是，我发现如果我在列表视图下方添加另一个视图并设置列表视图的属性，则会在最后一项之后**显示分隔符。**`android:layout_above`

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/bottom"
        android:layout_alignParentTop="true" />

    <TextView
        android:id="@+id/bottom"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:background="@android:color/holo_blue_dark"
        android:text="Bottom" />
</RelativeLayout> 
```

![在此处输入图像描述](../Images/9c6ecd5a1103fa5a85c993b9ef863ab6.png)

**为什么列表视图会这样？如何在仅包含列表视图的布局中的最后一项之后获取分隔符？**

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2014-01-08T17:13:42.367

答案很简单：你应该`android:layout_height="wrap_content"`在`android:layout_height="match_parent"`你的`ListView`.

您可能会猜到为什么会发生这种情况。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-07T16:06:42.183

你试过这个吗？

```
android:footerDividersEnabled="true" 
```

如果不试试这个

```
<View
android:background="#00ff00"
android:layout_width="fill_parent"
android:layout_height="3dp"
android:layout_alignParentLeft="true"
android:layout_alignParentRight="true"
android:layout_below="@+id/YOUR_LIST_ID" /> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-05-14T01:01:27.813

将空视图添加到顶部（和/或底部）以在顶部（或底部）创建分隔线

```
myList.addHeaderView(new View(context));
myList.addFooterView(new View(context)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T17:59:18.520

我有一个可以解决这个问题的hack。`layout_height`由于仅当列表视图后面有另一个视图时才显示最后一个分隔符，因此可以通过将其设置为使第二个视图不可见`0dp`。

它仍然是一个hack，但它使最后一个分隔线看起来与另一个一致，所以最好尝试手动创建一条水平线并尝试猜测正确的颜色和尺寸。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/invisible"
        android:layout_alignParentTop="true" />

    <View
        android:id="@+id/invisible"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_alignParentBottom="true" />    
</RelativeLayout> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-30T18:44:04.780

我做了类似于@Natix 描述的事情，但是我没有弄乱列表的包含布局，而是通过 ListView.addFooterView() 将空视图作为页脚添加到列表中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T16:07:29.120

如果您这样编码，当您的列表视图显示时，它似乎有些不同。但即使你也可以遵循这一点。

**首先定义一个名为`Line`**

```
<style name="Line">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">2px</item>
    <item name="android:background">@color/white</item>
</style> 
```

// 在上述样式中，您可以根据需要更改线条的高度。

无论你想在哪里使用上面的行，你都可以在你的 xml 文件中这样声明它。

```
<LinearLayout
android:orientation = "vertical"
.......................
............................>
 <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
         />

<View
        style="@style/Line"/>

</LinearLayout> 
```

上面的代码在您的列表视图下创建了一行。当您想在项目的各个地方使用上面的代码时，上面的代码最有用。或者如果只想要一个地方，你可以这样做。

```
 <LinearLayout
    android:orientation = "vertical"
    .......................
    ............................>
     <ListView
            android:id="@android:id/list"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
             />
<View
    android:layout_width="fill_parent"
        android:layout_height="1px"
        android:background="#20b2aa" />

</LinearLayout> 
```

希望这可以帮助。顺便说一句，原因很模糊，即使我确实搜索过这个，我也按照上面解释的方式进行了操作。

# arduino - Reading data over serial Arduino and XBee

> ID：14199279
> 
> 赞同：6
> 
> 时间：2013-01-07T15:48:21.043
> 
> 标签：arduino

I am having the following:

Two [Arduinos](http://en.wikipedia.org/wiki/Arduino) and two [XBees](http://en.wikipedia.org/wiki/XBee). I want to send data from the one to another. The XBees communicate, because I have the proposes test (connect one XBee with the Arduino and the other to the PC, write from the one, and watch the other in the other terminal).

Now I want to send data from the one to another:

These are my two scripts:

For sending (which is tested in the former test that sends all the letters):

```
#include <SoftwareSerial.h>

SoftwareSerial xbee(2, 3); // RX, TX
char c = 'A';
int  pingPong = 1;

void setup()
{
    Serial.begin(9600);

    Serial.println( "Arduino started sending bytes via XBee" );

    //Set the data rate for the SoftwareSerial port
    xbee.begin(9600);
}

void loop() {
    // Send character via XBee to other XBee connected to Mac
    // via USB cable.
    xbee.write( c );

    //--- Display the character just sent on console. ---
    Serial.println( c );

    //--- Get the next letter in the alphabet, and reset to ---
    //--- 'A' once we have reached 'Z'.
    c = c + 1;
    if ( c>'Z' )
         c = 'A';

    //--- Switch LED on Arduino board for every character sent---
    if ( pingPong == 0 )
        digitalWrite(13, LOW);
    else
        digitalWrite(13, HIGH);
    pingPong = 1 - pingPong;
    delay( 1000 );
} 
```

The problem is when I connected an Arduino to receive data from the other XBee.

Here is my code:

```
#include <SoftwareSerial.h>

SoftwareSerial xbee(2, 3); // RX, TX

void setup()
{
    Serial.begin(9600);

    Serial.println( "Arduino started receiving bytes via XBee" );

    // Set the data rate for the SoftwareSerial port.
    xbee.begin(9600);
}

void loop()  {
    int temp = xbee.read();

    Serial.print("Character received:");
    Serial.println(temp);
    delay(1000);
} 
```

Output is always:

```
Character received: -1. 
```

If I change the `temp` from `int` to `byte` I see `Character received: (a non-[ASCII][3] symbol)`.

I am using XBee series 1.

They are configured through X-CTU, based on the one tutorial found on ladyada.net.

Then I connected the XBee to an Arduino (TX to pin 3, RX to 2, Vcc and GND respectively) and the other XBee to the PC through an [FTDI](http://en.wikipedia.org/wiki/FTDI) cable. I was able to send characters from the Arduino and see them in the serial monitor of the X-CTU. Does this mean that they are configured correctly?

Then I wanted to connect an Arduino to my receiver. You can see the code above. I am always getting no available data.

Returned -1 means that there is no data in the serial.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T17:58:28.757

Changing `int` to `byte` is really changing int to `char`. The non-[ASCII](http://en.wikipedia.org/wiki/ASCII) symbols are a result of trying to render the character (`0b11111111`). Negative one (`-1`) in decimal is all ones in binary because `int`'s are signed by default. Check out [Bin/Dec/Hex Converter](http://www.binaryhexconverter.com/) to verify.

All of that is to say that `xbee.read()` returns a `byte`/`char`. I was not able to find anything in [the documentation](http://arduino.cc/en/Reference/SoftwareSerialRead), but I would assume that the `-1` is due to an error (based on the hardware `Serial` [documentation](http://arduino.cc/en/Serial/Read)). This is because there is nothing to read.

## You could try the following:

*   Ensure the RX/TX lines are correct. Trust me, it happens.
*   Check to see if the XBee has data available prior to reading. (You'll get a lot less lines printed since it will wait until a byte is ready to be read.)

```
if (xbee.available()) {
    byte temp= xbee.read();
    Serial.print(temp);
} 
```

*   Use the built in (hardware). SoftwareSerial should work, but in my experience, hardware serial is much more reliable.

    *   Depending on your model(s) of Arduino, you may have to ([Disable Auto Reset on Serial Connection](http://playground.arduino.cc/Main/DisablingAutoResetOnSerialConnection)). This appears to be only needed if you're trying to send data through the FTDI chip from somewhere other than the IDE's *Serial Monitor* (generally speaking).
*   This thread *[Arduino to Arduino XBee Serial Communication](http://arduino.cc/forum/index.php?topic=24061.0)* has a very similar setup that appears to be working. Simplify your effort as much as possible and then slowly add functionality.
*   Directly connect the XBee RX & TX lines to a USB-to-FTDI connector, such as [this cable](https://www.sparkfun.com/products/9718) or this [breakout board](https://www.sparkfun.com/products/9716).

Until you have a working proof of concept, you should make it as simple as possible. Once it is working then add features one at a time. This seems like what you're doing already, but this could probably be simplified further (cut the Arduinos out of the equation by using FTDI only, use hardware serial, etc.).

It sounds like a pretty cool project. Good luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-25T14:26:00.317

```
void loop()  {
    unsigned char temp; = 
    if (Serial.available() > 0){
       temp = xbee.read();
       Serial.print("Character received:");
       Serial.println(temp,HEX);
} 
```

try this code.
I converted your int temp to unsigned char to handle MSB. It works for me. But I used Xbee series 2 and hardware serial. Anyway, data handling is maters.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-18T02:00:40.170

i know its kinda late, but maybe there still someone who in need for this solution at the moment.

```
if (xbee.available()) {
    byte temp= xbee.read();
    Serial.print(temp);
} 
```

for this code here at the reciving part, i change `serial.print(tempt)` to `serial.write(tempt)`. the reasons is its kinda display ASCII code when i use `serial.print(variablesname)`, but when i use `serial.write(variablesname)` it display as it suppose to. can try it out if any of you still stuck at this prob.

# ms-access - 2层SQL语句

> ID：14199283
> 
> 赞同：-3
> 
> 时间：2013-01-07T15:48:41.367
> 
> 标签：ms-access, vba

我对 SQL 很陌生，所以请稍等片刻......我希望从一个名为任务分配的表中选择电子邮件，其中任务 ID=（另一个表中的所有任务 ID，其值可能是某列中的 X称为项目 ID。我希望只选择唯一的电子邮件。我可以知道这是否可以在单个 sql 语句中实现吗？非常感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:54:31.330

您可以使用查询设计窗口逐步构建一条 sql 语句。例如，您可以构建以下内容：

```
 SELECT DISTINCT TaskID From SomeTable WHERE ColX="X" 
```

您可以通过右键单击、选择属性并选择唯一值来获取 DISTINCT 关键字。

您还可以构建：

```
 SELECT Email From ATable As A
 INNER JOIN SomeTable As B
 ON a.TaskID = b.TaskID 
```

现在替代：

```
 SELECT Email From ATable As A
 INNER JOIN (SELECT DISTINCT TaskID From SomeTable WHERE ColX="X") As B
 ON a.TaskID = b.TaskID 
```

# ruby-on-rails - 在 en.yml 文件中更改属性名称不起作用

> ID：14199285
> 
> 赞同：3
> 
> 时间：2013-01-07T15:48:48.527
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我在 ruby​​ on rails 项目中更改了 en.yml 文件中的属性名称。按钮工作正常。但是字段属性没有改变。

这是我的模型，

```
class Enr::AffordableWarmth < ActiveRecord::Base
  self.table_name = "AffordableWarmth"
  self.primary_key = 'Record_No'

  validates_presence_of :No_Bedrooms, :No_Bedspaces, :Max_Annual_Energy_Cost
  validates :No_Bedrooms, uniqueness: { scope: :No_Bedspaces, 
    message: "already exists!" }
  validates_numericality_of :No_Bedrooms, :No_Bedspaces, :Max_Annual_Energy_Cost
end 
```

## en-GB.yml 文件

```
en-GB:
  helpers:
    submit:
      enr_rds_dea:
        create: 'Create new user'
        update: 'Update'

      enr_affordable_warmth:
        create: 'Create'
        update: 'Update'

  activerecord:
      models:
        AffordableWarmth:
      attributes:
        AffordableWarmth:
          No_Bedrooms: "Number of Bedrooms" 
```

尽管如此，在 rails 控制台和表单中，它显示“No Bedrooms could not be blank”。一些代码在活动记录中不起作用。在一些代码工作正常之前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:10:32.573

看着`lib/active_model/errors.rb`，我认为关键应该是 'enr/affordable_warmth' 而不是 AffordableWarmth，但您可能需要以某种方式指定“Enr”命名空间。

如果它不起作用，请使用 找到已安装的 gem 源`bundle show activemodel`，然后进行一些调试`lib/active_model/errors.rb`以准确找出它期望的 i18n 键。

*更新：*

以下是如何调试它：

我搜索 I18n，它执行翻译，所以我找到了`generate_message`生成整个错误消息的方法，它将翻译后的属性名称作为参数（见`:attribute`键），这将我引导到方法`human_attribute_name`，我发现在`lib/active_model/translation.rb`.

我添加以下行：

`puts "human_attribute_name(#{attribute.inspect}, #{options.inspect}): defaults: #{defaults.inspect}"`

就在`I18n.translate`, 之前并启动我的控制台。

对于`Foo::User`我得到的模型：

`human_attribute_name("account_type", {}): defaults: [:"activerecord.attributes.foo/user.account_type", :"attributes.account_type", "Account type"]`

所以这应该适合你：

```
 activerecord:
      attributes:
        "enr/affordable_warmth":
          no_bedrooms: "Number of Bedrooms" 
```

# git - 在不丢失更改的情况下合并上游的正确方法是什么？

> ID：14199286
> 
> 赞同：5
> 
> 时间：2013-01-07T15:48:55.293
> 
> 标签：git, github

我有点苦恼。

几个月前，我开始在 repo 的一个分支上进行开发。我做了一些改变。我正准备将我的代码作为拉取请求推送回主服务器，但我意识到在此期间有很多变化......

因此，[按照 Github 上](https://help.github.com/articles/fork-a-repo)“拉入上游更改”下的说明，我尝试了：

```
$ git remote add upstream ...  # savon/httpi
$ git fetch upstream
$ git merge upstream/master
$ git push origin/master       # coldnebo/httpi 
```

但是，现在我的叉子很乱。我仍然是 git 的新手，所以我不会试图猜测术语是什么，而是简单地告诉你我得到了什么以及我的期望：

*   想要这个：（显示 7 个更改的文件，添加 112 个，删除 5 个。） [https://github.com/savonrb/httpi/pull/59/files](https://github.com/savonrb/httpi/pull/59/files)

这是我想要的差异。有什么方法可以重新设置/还原并执行此操作而不会丢失我的更改？

*   得到了这个：（324 次提交几乎涵盖了整个项目加上 4 个新分支......哎呀！！） [https://github.com/coldnebo/httpi/commits/master](https://github.com/coldnebo/httpi/commits/master)

真是一团糟。

也许`git pull`会更好？

它的变化并不多，所以如果它无法恢复，我总是可以手动区分并重新制作它，但我正在寻找“正确的方法”来做这件事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T16:17:30.770

您应该始终为您创建的每个拉取请求创建新分支。在将其推送到 github 以创建请求之前，您应该将分支重新设置为最新的上游分支。

Github 说你用这个，如果没有太多变化`git merge`我更喜欢使用，这将防止*合并提交*。`git rebase upstream/master`

 ** * *

有时变基无法继续，因为您更改的内容已在上游分支中更改。例如，假设您有一个`text.txt`类似的文件：

```
Lorem ipsum 
```

您创建了一个 PR 来更新它，`Lorem ipsum!`并且上游分支已经将它更改为`Hello World`如果您执行 rebase，以在创建请求之前使您的代码保持最新，您会遇到合并冲突。该文件使用*冲突标记*进行更新，您可以选择要使用的版本，甚至可以编辑它，在我们的示例中，我们得到了这个`text.txt`：

```
<<<<<<< YOUR_PR_BRANCH
Lorem Ipsum
=======
Hello World
>>>>>>> THE_UPSTREAM_BRANCH 
```

在此之后，添加更新的文件`git add`并执行`git rebase --continue`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-10T16:47:41.527

好的，如果您的回购是 fubar，那么这里是恢复的步骤：

```
$ git remote update     # make sure origin and upstream are up to date
$ git checkout master
$ git branch my_changes   # just to make sure my stuff isn't lost
$ git reset --hard upstream/master
$ git status
# On branch master
# Your branch is behind 'origin/master' by 8 commits, and can be fast-forwarded.
# 
```

忽略那个快进废话，它对你没有帮助，只需重置主人。

```
$ git push origin +master   # now, fork matches upstream/master 
```

现在，如何恢复以前的工作，使其可审查？

```
$ git diff --no-ext-diff --no-prefix master..my_changes > patchfile
$ patch -p0 < patchfile   # apply the patchfile to master
$ git diff     # to verify patch visually.
$ rm patchfile   # clean up
$ rake spec      # verify that it really works.
$ git add .
$ git status     # double triple verify
$ git commit .
$ git push origin master 
```

那糟透了。我尝试做rebase，但它一直说“没有变化”并且没有要求我检查任何东西？我很确定我不明白这里发生了什么，这就是为什么我发布了我的斗争，以便有人可以解释我如何避免这种混乱并更优雅地从 A 到 B ，因为它已被完整记录。我愿意将此归咎于 git 缺乏经验，但我认为拉动更改应该是 git 中非常普遍的事情——我一定遗漏了一些东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:32:25.680

`git pull --rebase`为我工作并保持历史整洁。*

# vb.net - 在 vb.net 中使用树视图

> ID：14199289
> 
> 赞同：1
> 
> 时间：2013-01-07T15:49:04.713
> 
> 标签：vb.net

我在表单中添加了一个树视图。我想捕获复选框的值，无论是否选中。

另外我正在尝试获取节点数。树中有四个节点，

```
Dim nodes As TreeNodeCollection = TreeView1.Nodes
    MsgBox(nodes.Count) 
```

给出 1。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T17:21:33.513

...这可能不是最好的方法，但它有效...

该函数如下所示：

```
Function GetAllCheckedNodes(ByVal tv As TreeView, Optional ByRef tn As TreeNode = Nothing) As List(Of TreeNode)
    Dim RetVal As New List(Of TreeNode)

    If tn Is Nothing Then
        For Each nd In tv.Nodes
            RetVal.AddRange(GetAllCheckedNodes(tv, nd))
        Next
    Else

        If tn.Checked Then RetVal.Add(tn)

        For Each nd In tn.Nodes
            RetVal.AddRange(GetAllCheckedNodes(tv, nd))
        Next
    End If

    Return RetVal
End Function 
```

你使用它的代码看起来像：

```
 Dim MyList As List(Of TreeNode) = GetAllCheckedNodes(tvAccounts) 
```

或者

```
 Dim MyList As List(Of TreeNode) = GetAllCheckedNodes(tvAccounts, nd) 
```

树视图中的特定节点在哪里`nd`，您希望在其中获取所有已检查的子节点。

希望这会有所帮助并且有意义。

# vb.net - 如何将长字符串打印到以#分隔的表中

> ID：14199290
> 
> 赞同：0
> 
> 时间：2013-01-07T15:49:05.447
> 
> 标签：vb.net

我在每个单词的末尾有一长串三个单词#都存储在一个文本文件中如何打印它直到文件中的#：Jorj# bush#123456#美国总统#我想要类似的东西：

```
Dim details() As String = IO.File.ReadAllLines(filename)
Dim query = From line In details
            Let fullname = line.Split("#"C)(0)
            Let family_name = line.Split("#"c)(1)
            Let phone_number = line.Split("#"c)(2)
            Let comment = line.Split("#"c)(3)   
            Select fullname, family_name, phone_number, comment 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:25:04.050

这应该按预期工作。但是你可以让它更有效率：

```
Dim query = From line In details
            Let parts = line.Split("#"c)
            Let fullname = parts(0)
            Let family_name = parts(1)
            Let phone_number = parts(2)
            Let comment = parts(3)
            Select fullname, family_name, phone_number, comment 
```

否则，您将每行拆分 4 次。

# android - 二维棋盘识别

> ID：14199291
> 
> 赞同：-1
> 
> 时间：2013-01-07T15:49:07.227
> 
> 标签：android, opencv, chess

我正在尝试开发一个读取二维国际象棋图像并识别位置的Android应用程序（行编号为 1 到 8 ，列 a 到 h ）然后：

1.  棋子占据了哪个方格？
2.  它是什么作品（国王或王后或骑士等）
3.  单件颜色（黑色或白色）

需要一些使用openCV或任何想法的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:53:56.367

Opencv 2 Computer Vision Application Programming Cookbook 一书中有关于相机校准的部分。他们在那里使用棋盘。也许它可以帮助你，解决你的问题。

[http://www.bol.com/nl/p/opencv-2-computer-vision-application-programming-cookbook/1001004011498107/](http://www.bol.com/nl/p/opencv-2-computer-vision-application-programming-cookbook/1001004011498107/)

# android - 从 Spotify 获取当前正在播放的歌曲

> ID：14199293
> 
> 赞同：2
> 
> 时间：2013-01-07T15:49:11.490
> 
> 标签：android

尝试制作一个获取当前播放歌曲并输出的应用程序。为股票音乐播放器尝试了 IntentFilter，效果很好。但这在 Spotify 上不起作用，所以我的问题是是否有任何方法可以从 Spotify 应用程序中获取歌曲信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-09-07T20:43:04.810

我认为他们有一个 SDK：

[https://developer.spotify.com/documentation/android/guides/android-media-notifications/](https://developer.spotify.com/documentation/android/guides/android-media-notifications/)

不确定它是否仍在维护以及是否有效。也不确定是否可以获得专辑封面。

# c - 给定范围内的素数

> ID：14199294
> 
> 赞同：-3
> 
> 时间：2013-01-07T15:49:12.703
> 
> 标签：c, algorithm

我必须找到两个数 m 和 n 之间的所有质数。（1 <= m <= n <= 1000000000 和 nm <= 100000）。我正在使用 Eratosthenes 筛但得到错误的答案。谁能帮我我的代码有什么问题。

```
#include<stdio.h>
#include<math.h>

int S[100002];
void sieve(long long int m, long long int n)
{
 long long int x=sqrt(n);
long long  int i,j;
long long int a;

 for(i=0;i<=n-m+2;i++)
 S[i]=0;

 if(m%2==0)
     i=m; 

 else {
   i=m+1;

      }

 for (;i<=n;i+=2){
       S[i-m]=1;

            }

 for (i=3;i<=x;i+=2){

     if(i>=m && S[i-m]) continue;

    if(i*i>=m)j=i*i;
     else {
     a = (m-i*i)%(2*i);
      if(a==0)j=m;
       else 
      j=m+ (2*i -a);
    }
     for (;j<=n;j+=2*i){

            S[j-m]=1;
              }
   }

 if (m==1)i=1; else i=0;
 for (;i<=n-m;i++)

     if (!S[i]){

       printf("%lld\n",i+m);
       }

}

  int main(){
  int t;
  long long int m,n;
  scanf("%d\n",&t);
  while(t--){
      scanf("%lld %lld",&m,&n);

      sieve(m,n);
      printf("\n");
         }

    return(0);                         

   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:37:50.497

```
if(m%2==0)
    i=m; 
else {
    i=m+1;
}
for (;i<=n;i+=2){
    S[i-m]=1;
} 
```

现在，如果 会发生什么`m <= 2`？2 是否会被视为素数？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T20:18:21.730

您应该在 main 中使用循环并调用主要函数。出于性能考虑，我建议您避免使用 sqrt 函数，因为它需要大量 CPU 时钟。

```
bool isPrime(int number){

    if(number < 2) return false;
    if(number == 2) return true;
    if(number % 2 == 0) return false;
    for(int i=3; (i*i)<=number; i+=2){
        if(number % i == 0 ) return false;
    }
    return true;

} 
```

***更改数字范围的数据类型（long、long long 等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-13T19:56:05.080

这是查找范围之间的素数的最有效（**筛法**）方法。这里 1 不像传统方式那样被视为素数。

```
#include<stdio.h>
#include<string.h>

#define max 10000000

using namespace std;

int main()
{
    unsigned long long int  i, j, k, m, n;
    unsigned long long int* a = new unsigned long long int[max];

    scanf("%ul %ul",&m,&n);
   for(i = 1;i<=n;i++)
     a[i]=i;
   a[1] = 0;
   for(i=2;(i*i)<=n;i++)
    if(a[i]!=0)
      for(k=2*i;k<=n;k=k+i)
        if(a[k]!=0)
          a[k]=0;

    for(i =m;i<=n;i++)
        if(a[i]!=0) 
          printf("%ul ",a[i]);

    memset(a, 0, sizeof(a));
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-30T06:01:14.127

```
#include<stdio.h>
#include<stdlib.h>
void prime(int ); 

int main(){
int x,  end;
    printf("Enter end of the range:\n");
    scanf("%d", &end);

    for(x = 2;x <= end;x++){
        prime(x);
    }   
    return 0;
}

void prime(int x){
    int j, count = 1;
    for(j=2;j <= x;j++){
        if(x % j == 0){
            count += 1;
            //printf("count = %d,x = %d", count, x);
        }
    }
    if(count == 2){
        printf("\n%d\n", x);
    }
} 
```

# jquery - 当我使用 on() 函数时，Jquery 会阻止我的网站

> ID：14199299
> 
> 赞同：0
> 
> 时间：2013-01-07T15:49:24.793
> 
> 标签：jquery

这是代码：

```
jQuery(document).ready(function(){
    jQuery('.post_box').on('click', function(e) { 
        jQuery(this).find(".read_more").trigger("click");
    });  
}); 
```

当我单击 div`post_box`时，它会触发一个位于 sub div 中的链接（弹出灰色框），该链接现在`post_box`具有类`read_more,`，但当我关闭链接时出现问题`greybox`，然后再次单击 div`post_box`它不起作用，我必须刷新页面才能单击它。

如果我`on()`改为使用该功能，则在第一次单击时它将触发链接并被阻止，我认为它触发的链接不止一个，因为子 div 这是 HTML 代码

```
<div class="post_box" >
    <div class="post_box_top">
        <div class="post_box_center">
            <div class="post_box_content">

                <div class="post_date">

                </div>
                <div class="post_content">

              <?php   echo   $content_post = get_post(get_the_ID());?>

                </div>
                <div class="post_footer">
                    <a href="<?php the_permalink();?>" title="<?php the_title(); ?>" class="read_more"  rel="gb_pageset[search_sites]"  data-greybox-type="iframe">Read more</a>
               // this the link i should trigger when someone click on the <div class="post_box">   
               </div>
            </div>
        </div>
    </div>
</div>` 
```

[http://ec2-107-22-235-75.compute-1.amazonaws.com/](http://ec2-107-22-235-75.compute-1.amazonaws.com/)请看这里，这个网站有功能`one()`，以防我`on()`在你点击 div 时改变它阻止[http://haiders .imcserver.ro/telugu](http://haiders.imcserver.ro/telugu)您可以在`on()`这里查看第二种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:57:47.973

编辑：

这是一个事件传播的问题：当触发链接的点击事件时，该事件也会在父 .post_box 上触发，从而导致循环。请参阅[jQuery 文档](http://api.jquery.com/event.stopPropagation/)。

以下应该可以解决问题：

```
jQuery('.read_more').on('click', function(e) {
    e.stopPropagation();
}); 
```

* * *

您是否仅尝试使用[click()](http://api.jquery.com/click/)？

```
jQuery(document).ready(function(){
    jQuery('.post_box').click(function() { 
         jQuery(this).find(".read_more").trigger("click");
    });  
}); 
```

# java - 可扩展的 Java 数据库

> ID：14199302
> 
> 赞同：0
> 
> 时间：2013-01-07T15:49:38.690
> 
> 标签：java, database, open-source

我正在寻找一个开源的、基于 Java 的数据库...

*   可以轻松扩展，例如通过实现各种形式的树（R-tree 等）、各种索引技术（BitMatrix 等）、新的操作和字段
*   在读取数据方面做得很好（快速），例如读取时间序列
*   有据可查

我已经看过（在其他线程中建议的）Apache Derby 和 BerkleyDB；目前我支持 BerkleyDB，因为它似乎比 Derby 更快。您是否有任何进一步的偏好或任何支持或反对数据库的论点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:55:13.073

我从未尝试过扩展它，但[H2 数据库](http://www.h2database.com/html/main.html)似乎是目前最灵活、最有活力的项目之一。

它在很多地方都使用了接口，这使得您可以轻松地放入自己的实现中，例如[自定义表](http://www.h2database.com/html/features.html#pluggable_tables)。

# android - Android：使用 CustomAdapter 填充 ListView

> ID：14199303
> 
> 赞同：1
> 
> 时间：2013-01-07T15:49:39.377
> 
> 标签：android

我想`ListView`使用扩展的 CustomAdapter创建`BaseAdapter`。我有`CustomAdapter(Context context, List<Map<String, String>> dataList)`。

如何从方法`Map`中获取数据并设置我的视图`getView()`？在我尝试使用之前，`SimpleAdapter`但我需要设置存储在 SD 上的位图，以及我存储在地图中的图像的路径。感谢您的每一次帮助。

这是我的 CustomAdapter 的来源：

```
public class CustomAdapter extends BaseAdapter {

private Context context;
private String pricePrecision = null;
private List<Map<String, String>> data;

public CustomAdapter(Context context, List<Map<String, String>> data) {
    super();
    this.context = context;
    this.data = data;
}

@Override
public int getCount() {
    return (data == null) ? 0 : data.size();
}

@Override
public Object getItem(int position) {
    return data.get(position);
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    ViewHolder viewHolder = null;
    LayoutInflater inflater = ((LayoutInflater) context
            .getSystemService(Context.LOCATION_SERVICE));
    if (convertView == null) {
        convertView = inflater.inflate(R.layout.order_list_item, null);

        viewHolder = new ViewHolder();
        viewHolder.itemThumbnail = ((ImageView) convertView
                .findViewById(R.id.ivItemThumb));
        viewHolder.itemName = ((TextView) convertView
                .findViewById(R.id.tvItemName));
        viewHolder.itemPrice = ((TextView) convertView
                .findViewById(R.id.tvItemPrice));
        convertView.setTag(viewHolder);

    } else {
        viewHolder = ((ViewHolder) convertView.getTag());
    }
    return null;
}

private class ViewHolder {
    private ImageView itemThumbnail;
    private TextView itemName;
    private TextView itemPrice;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:09:34.587

将您的 getView 方法更改为：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    ViewHolder viewHolder = null;
    LayoutInflater inflater = ((LayoutInflater) context
            .getSystemService(Context.LOCATION_SERVICE));
    if (convertView == null) {
        convertView = inflater.inflate(R.layout.order_list_item, null);

        viewHolder = new ViewHolder();
        viewHolder.itemThumbnail = ((ImageView) convertView
                .findViewById(R.id.ivItemThumb));
        viewHolder.itemName = ((TextView) convertView
                .findViewById(R.id.tvItemName));
        viewHolder.itemPrice = ((TextView) convertView
                .findViewById(R.id.tvItemPrice));
        convertView.setTag(viewHolder);

    } else {
        viewHolder = ((ViewHolder) convertView.getTag());
    }
     viewHolder.itemThumbnail.setImageBitmap(data.get(position).get("thumbnail"));
     viewHolder.itemName.setText(data.get(position).get("name"));
     viewHolder.itemPrice.setText(""+data.get(position).get("price")); 
    return viewHolder;
}

private class ViewHolder {
    private ImageView itemThumbnail;
    private TextView itemName;
    private TextView itemPrice;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:15:17.703

(ρяσѕρєя K) 的代码的一点补充。您可能希望在缩略图上设置监听器。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    ViewHolder viewHolder = null;
    LayoutInflater inflater = ((LayoutInflater) context
            .getSystemService(Context.LOCATION_SERVICE));
    if (convertView == null) {
        convertView = inflater.inflate(R.layout.order_list_item, null);

        viewHolder = new ViewHolder();
        viewHolder.itemThumbnail = ((ImageView) convertView
                .findViewById(R.id.ivItemThumb));
        viewHolder.itemName = ((TextView) convertView
                .findViewById(R.id.tvItemName));
        viewHolder.itemPrice = ((TextView) convertView
                .findViewById(R.id.tvItemPrice));

        viewHolder.itemThumbnail.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

            }
        });

        convertView.setTag(viewHolder);

    } else {
        viewHolder = ((ViewHolder) convertView.getTag());
    }
    viewHolder.itemThumbnail.setImageBitmap(data.get(position).get(
            "thumbnail"));
    viewHolder.itemName.setText(data.get(position).get("name"));
    viewHolder.itemPrice.setText("" + data.get(position).get("price"));
    return viewHolder;
}

private class ViewHolder {
    private ImageView itemThumbnail;
    private TextView itemName;
    private TextView itemPrice;
} 
```

# concurrency - 在 F# 中将代理与任务相结合

> ID：14199304
> 
> 赞同：0
> 
> 时间：2013-01-07T15:49:40.060
> 
> 标签：concurrency, f#

我在 F# 中有以下代码，认为它足够并发以利用我机器的 4 个内核。然而，cpu 的使用仅限于一个核心。

```
 member x.Solve problemDef =
        use flag = new ManualResetEventSlim(false)
        let foundSoFar = MSet<'T>()
        let workPile = MailboxProcessor<seq<'T>>.Start(fun inbox ->
            let remaining = ref 0
            let rec loop() = async {
                let! data = inbox.Receive()
                let data = data |> Seq.filter (not << foundSoFar.Contains) |> Array.ofSeq
                foundSoFar.UnionWith data
                let jobs = ref -1
                for chunk in data |> Seq.distinct |> Seq.chunked 5000 do
                    Async.Start <| async {
                        Seq.collect problemDef.generators chunk
                        |> Array.ofSeq
                        |> inbox.Post
                    }
                    incr jobs
                remaining := !remaining + !jobs
                if (!remaining = 0 && !jobs = -1) then
                    flag.Set() |> ignore
                else 
                    return! loop()
            }
            loop()
        )
        workPile.Post problemDef.initData
        flag.Wait() |> ignore
        foundSoFar :> seq<_> 
```

我将 MailboxProcessor 用作工作堆，从中获取大量元素，通过 HashSet 过滤它们，并使用其结果插入工作堆的新元素创建任务。重复此过程，直到没有新元素产生。这段代码的目的是在工作堆中异步插入块，从而使用任务。我的问题是没有并行性。

编辑：感谢@jon-harrop，我解决了由于 seq 的惰性导致的并发问题，并按照建议重新编写了代码。有没有办法摆脱 ManualResetEvent 而不使用区分联合作为代理的消息类型（以支持询问消息）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:18:25.490

如果没有一个完整的例子，我发现很难理解你的代码做了什么（可能是因为它结合了很多不同的并发编程原语，这使得它有点难以理解）。

无论如何，主体`MailboxProcessor`只执行一次（如果你想使用普通代理获得并发，你需要启动多个代理）。在代理的主体中，您启动一​​个`problemDef.generators`为每个`chunk`.

这意味着`problemDef.generators`应该并行运行。然而，调用`foundSoFar.Contains`and `foundSoFar.UnionWith`as的代码`Seq.distinct`总是按顺序运行。

因此，如果`problemDef.generators`是一个简单而高效的函数，跟踪`foundSoFar`（按顺序完成）的开销可能比并行化得到的要大。

我不熟悉`MSet<'T>`，但如果它是（或者如果你用它替换）一个线程安全的可变集，那么你应该能够在`Task.StartNew`（与其他联合并行）中运行一些联合。

PS：如我所说，不运行代码很难分辨，所以我的想法可能完全错误！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T08:47:05.700

`ManualResetEventSlim` 您正在混合使用非常糟糕的高级并发原语（任务和代理） 。可以`PostAndReply`改用吗？

您`Seq`用于在生成的任务中执行“工作”，该任务是惰性的，因此在回发之前它实际上不会做任何事情。你可以用类似的东西在任务内部强制评估`Array.ofSeq`吗？

您使用的`Task`方式异常。切换到`Async.Start`.

如果没有完整的解决方案，我无法验证我的任何猜测......

> think 足够并发以利用 4 个内核

您对多核并行性的心智模型可能完全偏离了标准。

# javascript - 是否有提供对浏览器“真实”javascript 控制台的访问的 js 控制台模拟器？

> ID：14199305
> 
> 赞同：1
> 
> 时间：2013-01-07T15:49:40.067
> 
> 标签：javascript, jquery, terminal, terminal-emulator

有谁知道任何控制台模拟器（最好是用 javascript 或 jquery 制作），它可以让我直接访问浏览器的 javascript 控制台，例如可以在 chrome 的开发人员工具中找到？我一直在使用[jq-console](https://github.com/replit/jq-console)，但它只模拟一个终端，到目前为止非常有用。但是它只*模拟*一个终端，不提供对浏览器 js 控制台的访问。我需要这个，以便用户无需打开开发人员工具或类似的东西就可以对控制台进行基于 Web 的前端访问，这样他们就可以访问浏览器 js 控制台中可用的变量和对象。我曾想过将数据加载到 jq-console 实例的内存中，但是我认为这将是一个繁琐的过程，如果没有将信息直接输入到 jq-console 实例中，我真的不知道该怎么做. 任何帮助或指导将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T17:06:33.153

> 直接访问浏览器的 javascript 控制台

不，不手动打开控制台就不行，而且除了记录消息之外，你不能做更多的事情。任何模拟器都不会使用本机控制台。

> CodeAcademy.com 上基于 Web 的前端控制台

你看过他们的源代码吗？你也可以自己写这样一个。或者看看 EloquentJavaScript 的[控制台脚本](http://eloquentjavascript.net/js/ejs.js)（使用 Mochi 和 Codemirror）。

> 浏览器控制台

……不模仿它是不可能的。但是，您可以为此使用[FirebugLite](http://getfirebug.com/firebuglite)，它承诺与原生 Firebug 相同的外观和感觉。此外，Opera 的[Dragonfly](http://www.opera.com/dragonfly/)是用 JS 编写的，它是[作为开源发布的，](http://www.opera.com/dragonfly/documentation/development/)因此您可以调整（部分）它。

# java - 2.2.8-SNAPSHOT版本的cxf-codegen-plugin有什么特别之处？

> ID：14199307
> 
> 赞同：3
> 
> 时间：2013-01-07T15:49:59.907
> 
> 标签：java, spring, jax-ws, cxf

我继承了一个基于 CXF 的项目，具有以下（相关）*原始*依赖项（在 中`pom.xml`）：

```
<dependency>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-frontend-jaxws</artifactId>
        <version>2.2.7</version>
</dependency>
<dependency>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-transports-http</artifactId>
        <version>2.2.7</version>
</dependency>
<dependency>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-ws-security</artifactId>
        <version>2.2.7</version>
</dependency> 
```

和

```
<plugin>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-codegen-plugin</artifactId>
        <version>2.2.8-SNAPSHOT</version> 
```

通过“原始”，我的意思是这是我收到的源代码快照，它在**几年前**用于构建良好，这些年来一直处于休眠状态，现在，需要对代码进行一些修改，它将*不再按原样构建*。

尝试“按原样”构建它的主要问题是，找不到它的版本**......**`2.2.8-SNAPSHOT` Maven找不到它并且构建失败。`cxf-codegen-plugin`

 **因此，我将上面的内容替换为（请注意，唯一的区别是 2.2.8 与 2.2.8-SNAPSHOT）

```
<plugin>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-codegen-plugin</artifactId>
    <version>2.2.8</version> 
```

现在构建成功超过了这一点，但在未找到 2 个符号时失败：

1.  `Password.set_value(String value)`- 从包`org.oasis_open.docs.wss._2004._01.oasis_200401_wss_wssecurity_secext_1_0`。
2.  `SQLService.setENDPOINT(String sei)`来自基于`javax.xml.ws.Service`.

`Password`这两个类的源文件`SQLService`都是由 Apache CXF 2.2.8 动态生成的，由该项目的原作者设计。

因此，我迅速检查了这些文件的新生成版本并发现：

1.  `Password.set_value(String value)`好像被替换了`Password.setValue(String value)`。
2.  `SQLService.setENDPOINT(String sei)`已完全消除，而是要求在构造函数中传递 sei：`SQLService(URL wsdlLocation, QName serviceName)`

所以我修改了调用这些方法的源代码以适应这两个看似微小的变化，现在项目构建成功！

**但是......**它在运行时失败，但有以下例外：

```
WARNING: Interceptor for {http://rservice.rorg.net/sql}SQLService#{http://rservice.rorg.net/sql}Get has thrown exception, unwinding now
org.apache.cxf.interceptor.Fault: Could not send Message.
    at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:64)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:243)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:487)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:313)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:265)
    at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:73)
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:124)
    at $Proxy38.get(Unknown Source)
        ...
Caused by: java.net.ConnectException: ConnectException invoking http://localhost:8080/rservice/services/SQLServiceSoap: Connection refused
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:67)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:522)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:2058)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:2043)
    at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:66)
    at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:639)
    at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
    ... 14 more
Caused by: java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:413)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:274)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:261)
    at java.net.Socket.connect(Socket.java:556)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:175)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:403)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:521)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:246)
    at sun.net.www.http.HttpClient.New(HttpClient.java:320)
    at sun.net.www.http.HttpClient.New(HttpClient.java:337)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:996)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:948)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:873)
    at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1040)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleHeadersTrustCaching(HTTPConduit.java:1955)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.onFirstWrite(HTTPConduit.java:1907)
    at org.apache.cxf.io.AbstractWrappedOutputStream.write(AbstractWrappedOutputStream.java:42)
    at org.apache.cxf.io.AbstractThresholdOutputStream.write(AbstractThresholdOutputStream.java:69)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1974)
    ... 17 more

04-Jan-2013 12:07:17 ERROR [SQLModule] Error running SQL module: Could not send Message.
javax.xml.ws.WebServiceException: Could not send Message.
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:135)
    at $Proxy38.get(Unknown Source)
    at net.rorg.rservice.client.base.sql.SQLClientBase.get(SQLClientBase.java:306)
    at net.rorg.rservice.client.module.sql.SQLModule.getBatch(SQLModule.java:149)
    at net.rorg.rservice.client.module.sql.SQLModule.getAndProcessSQL(SQLModule.java:110)
    at net.rorg.rservice.client.module.sql.SQLModule.run(SQLModule.java:280)
    at net.rorg.rservice.client.RClient.exec(RClient.java:398)
    at net.rorg.rservice.client.RClient.run(RClient.java:173)
    at net.rorg.rservice.client.RClient.main(RClient.java:166)
Caused by: 
java.net.ConnectException: ConnectException invoking http://localhost:8080/rservice/services/SQLServiceSoap: Connection refused
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:67)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:522)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.mapException(HTTPConduit.java:2058)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:2043)
    at org.apache.cxf.transport.AbstractConduit.close(AbstractConduit.java:66)
    at org.apache.cxf.transport.http.HTTPConduit.close(HTTPConduit.java:639)
    at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
    at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:243)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:487)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:313)
    at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:265)
    at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:73)
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:124)
    ... 8 more
Caused by: 
java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:413)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:274)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:261)
    at java.net.Socket.connect(Socket.java:556)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:175)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:403)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:521)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:246)
    at sun.net.www.http.HttpClient.New(HttpClient.java:320)
    at sun.net.www.http.HttpClient.New(HttpClient.java:337)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:996)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:948)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:873)
    at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1040)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.handleHeadersTrustCaching(HTTPConduit.java:1955)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.onFirstWrite(HTTPConduit.java:1907)
    at org.apache.cxf.io.AbstractWrappedOutputStream.write(AbstractWrappedOutputStream.java:42)
    at org.apache.cxf.io.AbstractThresholdOutputStream.write(AbstractThresholdOutputStream.java:69)
    at org.apache.cxf.transport.http.HTTPConduit$WrappedOutputStream.close(HTTPConduit.java:1974)
    ... 17 more 
```

**注意：**即使我在 WSDL 中对实际 (www) 服务器 URL 进行硬编码（即用 替换`http://localhost:8080`）`https://test.rserver.com`，我也会收到显示为目的地的*ConnectException*错误。`http://localhost:8080`显然，没有执行某些 CXF 替换或解析。这可能是问题出在哪里的线索吗？CXF 的哪个组件负责从`http://localhost:8080`URL 到真实 URL 的神奇转换？

堆栈跟踪提示的位置是否正确（即**JaxWsClientProxy**或**frontend.ClientProxy**或...）？

```
at org.apache.cxf.interceptor.MessageSenderInterceptor$MessageSenderEndingInterceptor.handleMessage(MessageSenderInterceptor.java:62)
at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:243)
at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:484)
at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:310)
at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:262)
at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:73)
at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:124) 
```

如果是这样，为什么会发生这种情况，我该如何解决？

现在...如果我是 CXF 和/或 JAX-WS 专家，我可能会找出堆栈跟踪中误导性的“连接被拒绝”提示的根本原因。

但在这一点上，我几乎迷失了，因为我非常确定 SEI 在那里，身份验证用户名/密码是正确的：较旧的二进制文件（带有依赖项的 JAR）在这个服务上运行得很好。

因此，我正在寻找可能已经看到这种类型的*“连接被拒绝”*堆栈跟踪并且知道它可能由[典型原因](https://stackoverflow.com/a/5260319/1864054)**之外**的其他原因触发的专家的线索或见解。例如，一旦2.2.8-SNAPSHOT 被 2.2.8 替换，就会引入某种类型的不匹配？`cxf-codegen-plugin`

或有关如何解决此问题的其他提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:04:55.220

我认为您的更改`SQLService`可能是问题所在

> SQLService.setENDPOINT(String sei) 已完全消除，而是要求在构造函数中传递 sei： SQLService(URL wsdlLocation, QName serviceName)

您是否在构造函数调用中添加了新 URL？以前是什么`sei`？如果您输入了 URL，则可能是其连接失败。您应该能够使用无参数构造函数。

如果您想在运行时设置 URL（我猜这就是`setENDPOINT`调用所做的），您需要操作`BindingProvider`. 请参阅此线程[http://cxf.547215.n5.nabble.com/How-to-change-the-service-URL-at-runtime-td3242927.html](http://cxf.547215.n5.nabble.com/How-to-change-the-service-URL-at-runtime-td3242927.html)**

# sass - SASS 项目中的从右到左 (RTL) 支持

> ID：14199323
> 
> 赞同：7
> 
> 时间：2013-01-07T15:50:58.977
> 
> 标签：sass, compass-sass, right-to-left

我想知道是否可以制作一个将多个参数作为应转换为 rtl 的属性来处理的 mixin。我想做类似的事情

```
.css-selector {
    width: 300px;
    height: 200px;
    @include rtl {
         padding: 10px 5px 3px 4px;
         margin: 3px 8px 2px 5px;
    }
} 
```

使用混合：

```
$rtl = false !default;

 @mixin rtl() {
    @if $rtl {
        dir: rtl;
        @each $property in @content {
            //check property if it's padding or margin or something 
              else rtl-related... if hit use rtl mixin
            }
    }
    @else { @content; }

} 
```

我想我应该解析@content，但它不起作用（“...h $property in”之后的无效CSS：预期表达式（例如1px，粗体）是“@content {)。

现在我用 2 个变量处理 rtl：

```
 $dir: left !default;
 $opdir: right !default; 
```

当它是 rtl 时我会改变。我在我的 sass 文件中使用它

```
margin-#{$dir}: 15px; 
```

但我认为这个解决方案不够灵活。而且我也不想在每个 css 属性中包含一个单独的 mixin。

有人有更好的想法或解决方案吗？欢迎任何反馈

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-11T10:28:07.560

方法不同，但[bi-app-sass](http://anasnakawa.github.com/bi-app-sass/)会解决 rtl 问题，它会为您生成 2 个不同的样式表

创建必要的文件（在上面的链接中解释）后，您所要做的就是为左/右属性（浮动、边框、边距、填充、文本对齐...）调用预定义的 mixin

```
 .foo {
   @include float(left);
   @include border-left(1px solid white);
   @include text-align(right);
 } 
```

这个项目还有一个端口用于较少的语言

*   [无双应用](http://anasnakawa.github.com/bi-app-less/)

* * *

**更新**

在[bi-app-sass](http://anasnakawa.github.com/bi-app-sass/)中有`rtl`&`ltr`条件混合可用于处理特殊情况，请参见以下示例

```
.something {
    @include ltr {
        // anything here will appear in the ltr stylesheet only
        background-image: url( 'app-ltr.jpg' );
    }
    @include rtl {
        // for rtl sheet only
        background-image: url( 'app-rtl.jpg' );
        margin-top: -2px;
    }
} 
```

请注意，此功能不支持`bi-app-less`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-07T18:05:25.047

以下 SCSS 导入添加了一些有用的变量、函数和 mixin。

[在 GitHub 上查看](https://github.com/tysonmatanich/directional-scss)

[阅读更多](http://www.matanich.com/2013/09/06/rtl-css-with-sass/)

```
// Override default value for $dir in directional.scss
$dir: rtl;

// Import helpers from directional.scss
@import "directional";

// Use the helpers to make CSS for LTR or RTL
body {
    text-align: $left;
    padding-#{$right}: 1em;
    margin: dir-values(0 2em 0 1em) if-ltr(!important);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-09T19:31:33.583

我建议使用一个可以轻松处理这两种情况的 mixin。嵌套选择器：

_mixin.sass：

```
$isRLT: true;

@mixin rtl {
  @if $isRLT {
    @if & {
      & {
        @content;
      }
    }
    @else {
      @content;
    }
  }
} 
```

_main.sass：

```
.test {
  float: left;
  padding: 5px 5px 0px;

  @include rtl {
    padding: 5px 0px 0px 5px;
  }
} 
```

核心.scss

```
// include all your libraries
@import '_mixin';
@import '_main'; 
```

这将生成没有 rtl 的文件。

欲了解更多信息检查=> [https://github.com/davidecantoni/sass-rtl-mixin](https://github.com/davidecantoni/sass-rtl-mixin)

# python - 如何在python中正确使用递归和副作用

> ID：14199326
> 
> 赞同：0
> 
> 时间：2013-01-07T15:50:59.687
> 
> 标签：python, recursion, side-effects

在树形结构中，我试图找到一个分支的所有叶子。这是我写的：

```
def leafs_of_branch(node,heads=[]):
    if len(node.children()) == 0:
        heads.append(str(node))
    else:    
        for des in node.children():
           leafs_of_branch(des)
    return heads

leafs_of_branch(node) 
```

我不知道为什么，但对我来说感觉不对。它有效，但我想知道是否有更好的方法来使用递归而不创建`heads`参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:00:57.150

这

```
def leafs_of_branch(node,heads=[]): 
```

总是一个坏主意。会更好

```
def leafs_of_branch(node,heads=None):
    heads = heads or [] 
```

否则，您总是对 leafs_of_branch 使用相同的列表。在您的特定情况下，它可能没问题，但迟早您会遇到问题。

我建议：

```
def leafs_of_branch(node):
    leafs = []
    for des in node.children():
        leafs.extend(leafs_of_branch(des))
    if len(leafs)==0:
        leafs.append(str(node))
    return leafs

leafs_of_branch(node) 
```

我没有做 a `if len(node.children()==0`，而是在下降到所有（可能为零）孩子之后检查 len(leafs) 。因此我只调用一次 node.children() 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:00:19.107

我相信这应该有效：

```
def leafs_of_branch(node):
    if len(node.children()) == 0:
       return [str(node)]
    else:
       x = []
       for des in node.children():
           x += leafs_of_branch(des)  #x.extend(leafs_of_branch(des)) would work too :-)
       return x 
```

它不是很漂亮，可能会更简洁一些，但我试图尽可能地保持原始代码的形式，以使发生的事情一目了然。

如果您多次调用它，您的原始版本实际上将不起作用，因为当您附加到`heads`列表时，该列表实际上会在两次调用之间保存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:05:11.710

只要递归进行，您就做对了IMO；您在递归调用中缺少 head 参数。无论如何它工作的原因是其他人所说的，默认参数是全局的并且在调用之间重用。

如果你想避免递归 altogheter，在这种情况下你可以使用 Queue 或 Stack 和循环：

```
def leafs_of_branch(node):
    traverse = [node]
    leafs = []

    while traverse:
        node = traverse.pop()
        children = node.children()

        if children:
            traverse.extend(children)
        else:
            leafs.append(str(node))

    return leafs 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:01:15.140

首先，避免使用可变对象（列表、字典等）作为默认值，因为默认值是全局的并且在函数调用之间重用：

```
def bad_func(val, dest=[]):
    dest.append(val)
    print dest

>>> bad_func(1)
[1]
>>> bad_func(2)
[1, 2]  # surprise! 
```

因此，随后的调用将使某些事情完全出乎意料。

至于递归问题，我会这样重写：

```
from itertools import chain

def leafs_of_branch(node):
    children = node.children()
    if not children:  # better than len(children) == 0
        return (node, )

    all_leafs = (leafs_of_branch(child) for child in children)
    return chain(*all_leafs) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T16:14:24.707

您也可以通过这种方式递归地定义一个迭代器。

```
def leafs_of_branch(node):
    if len(node.children()) == 0:
        yield str(node)
    else:    
        for des in node.children():
            for leaf in leafs_of_branch(des):
                yield leaf

leafs = list(leafs_of_branch(node)) 
```

# c++ - 在随机访问文件问题中创建新记录

> ID：14199327
> 
> 赞同：1
> 
> 时间：2013-01-07T15:51:08.867
> 
> 标签：c++, fstream

我想使用随机访问文件管理为学校创建一个仓库程序。我用许多私有变量构建了一个名为 product(prodotto) 的类，我必须创建一个新记录。

该函数使用 seekg 指针检查产品是否已经存在并读取文件。如果没有，您可以在该空间中写入文件。关键是产品代码（codice）。

问题是每次我运行该功能时，以前的记录都会被删除。

在这个版本之前，我使用了一名将军`fstream`来完成这项工作，但情况更糟。file.dat 始终为空。

我用tellg和tellp检查了指针，它们没问题。阅读部分似乎还可以。我认为问题在于写作陈述。

这是功能：

```
void aggiungiProd()
{
    int code;
    string name,section, description;
    int quantity;
    double price;

    cout<<"\n(insert 0 to come back)"<<endl;

    //exit condiction

    cout<<"Insert product code:";

cin>>code;

if( cin.good()==0)
{ code=0;
    cout<<"invalid code. Please reinsert:"<<endl;
cin>>code;
} //also this part is not working but is less important

if(codice==0) return;//exit condition

ifstream readFile("prod.dat",ios::in);
if(!readFile){
        cerr<<"Error during the reading";
 exit(1);
    }
int var;
var=code-1;

//use a pointer to indicate the location to read
readFile.seekg(var * (sizeof(Prodotto)),ios::beg );

//reading the product record
Prodotto prodotto;
readFile.read(reinterpret_cast< char*> (&prodotto),sizeof(Prodotto));

readFile.close();
if(prodotto.getCod()==0)
{

//THIS PART IS ONLY ABOUT VARIABLES TO SET--> SKIP

cout<<"Inserisci il nome del prodotto (max 30 caratteri): ";
cin.ignore();
getline(cin,name);

if(name=="0") return;//condizione uscita

cout<<"Inserisci quantità da aggiungere: ";
cin>>quantita;

if(quantita==0) return;

cout<<"Inserisci il prezzo del prodotto: " ;
cin>>prezzo;

if(prezzo==0) return;

cout<<"Inserisci sezione di appartenenza del prodotto(max 15 caratteri): " ;
cin.ignore();
getline(cin,sezione);

if(sezione=="0") return;

cout<<"Aggiungi una descrizione del prodotto (max 500 caratteri):";
cin.ignore();
getline(cin,descrizione);

if(descrizione=="0") return;

//END OF THE VARIABLES INSERTION

//NOW PUT THE VARIABLES IN THE PRODUCT prodotto

    prodotto.setCod(codice);
    prodotto.setNome(nome);
    prodotto.setQta(quantita);
    prodotto.setPrz(prezzo);
    prodotto.setSez(sezione);
    prodotto.setDes(descrizione);

//open the file as output
ofstream inOutProd("prod.dat", ios::out );
if(!inOutProd){
        cerr<<"Error in the file creation";
 exit(1);
    }

//pointer for the location of the new record
inOutProd.seekp(var * (sizeof(Prodotto)));

//write the record prodotto
inOutProd.write(reinterpret_cast<const char*>(&prodotto),sizeof(Prodotto));

//i believe the problem is in the statement over this line. I tried also to add ios::app
// in the ofstream line but it only append the new record at the end of file.

cout<<"the following product has been saved successfully\n"<<endl;
outputLine(cout,prodotto);
inOutProd.close();

}
else
{
    cerr<<"The product"<<codice<<"is already in our database"<<endl;

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:15:57.280

在写入新记录之前，您需要检查 seekp 调用的返回值。如果文件的长度不足以包含记录 N，则 seekp 将返回错误代码，您必须将数据附加到文件中，以使其足够长以包含记录 N。

# jquery - 在悬停时停止动画自定义新闻列表代码

> ID：14199330
> 
> 赞同：1
> 
> 时间：2013-01-07T15:51:18.090
> 
> 标签：jquery, jquery-animate

我正在做这个自定义新闻自动收报机（不能为此插入一个新插件:-(）并且大部分工作已经完成，我唯一需要在 mouseHover 上停止自动收报机并在 mouseOut 上恢复动画..

[http://jsfiddle.net/Sullan/EMcMz/4/](http://jsfiddle.net/Sullan/EMcMz/4/)

这是我正在使用的功能

```
function tick(){
$('#bigWinners li:first').animate({'left':-150}, 200, function () { $(this).appendTo($('#bigWinners')).css('left', 0); });
}
setInterval(function(){ tick () }, 4000); 
```

谁能帮我解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:02:00.757

您可以在 mouseenter 时使用 clearInterval() 并在 mouseout 时重新启动计时器

```
var timer = setInterval(tick, 1000);

$('#bigWinners').on({ //<-- change depending on which elements you want these to trigger on
  mouseenter: function(){
    clearInterval(timer);
  },
  mouseleave: function(){
    timer = setInterval(tick, 1000);
  }
}); 
```

[小提琴](http://jsfiddle.net/wirey00/zQHUY/ "示例小提琴")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:01:27.400

这就是你所需要的：

[http://jsbin.com/ifokak/4/edit](http://jsbin.com/ifokak/4/edit)

```
var intv;    
function tick(){     
  intv = setInterval(function(){
    $('#bigWinners li:first').animate({left:-150}, 200, function() {
        $(this).appendTo('#bigWinners').css('left', 0);
    });
  },2000);     
}   
tick(); // initial kick

$('.mini-carousel').on('mouseenter mouseleave', function( e ){
  var mEnt = e.type=='mouseenter' ? clearInterval(intv) : tick() ;
}); 
```

顺便说一句，使用`.appendTo('#bigWinners')`而不是`.appendTo( $('#bigWinners') )`

# android - 在 MQTT Android 连接中实现 SSL

> ID：14199334
> 
> 赞同：1
> 
> 时间：2013-01-07T15:51:20.377
> 
> 标签：android, ssl, mqtt, android-keystore

我有一个关于在Android环境中使用*MQTT协议的问题。*我们正在开发一个 Android 应用程序并使用**com.ibm.micro.client.mqttv3_7.5.0.0.jar** MQTT 客户端库向 Android 设备发送推送通知。我的问题是关于 SSL 连接。在桌面应用程序中，我们将 .keystore 文件复制到适当的位置并引用如下；

```
public Properties getSSLSettings() {
    final Properties properties = new Properties();
    properties.setProperty("com.ibm.ssl.keyStore",
        "C:/BKSKeystore/mqttclientkeystore.keystore");
    properties.setProperty("com.ibm.ssl.keyStoreType", "BKS");
    properties.setProperty("com.ibm.ssl.keyStorePassword", "passphrase");
    properties.setProperty("com.ibm.ssl.trustStore",
        "C:/BKSKeystore/mqttclienttrust.keystore");
    properties.setProperty("com.ibm.ssl.trustStoreType", "BKS");
    properties.setProperty("com.ibm.ssl.trustStorePassword", "passphrase ");

    return properties;
} 
```

上面的代码可以完美地获取 SSL 设置。我们也在 Android 中实现了此代码，但很明显，在设备中保存 .keystore 文件根本不安全。我的问题是，是否有任何其他替代方法可以实现 SSL 连接，而无需在设备的内部或外部存储中存储 .keystore 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:14:23.937

在更高版本的 android 中，您可以使用[KeyChain](http://developer.android.com/reference/android/security/KeyChain.html)访问设备的密钥库 以提供对私钥的访问。对于使用设备的信任库的信任库工作正常，android 默认使用它进行 SSL 连接。IBM 还拥有一个[消息传递社区](https://www.ibm.com/developerworks/mydeveloperworks/blogs/c565c720-fe84-4f63-873f-607d87787327/entry/test1?lang=en)，其中包含有关在移动设备上使用其库的信息。

# jsf - OSGI 和 JSF 如何协同工作？

> ID：14199338
> 
> 赞同：6
> 
> 时间：2013-01-07T15:51:45.230
> 
> 标签：jsf, osgi, bundle, bndtools, wab

我是 OSGI 的新手，在尝试创建 WAB 时遇到了很多问题。我在 Eclipse 中使用 BndTools 来帮助我使用 OSGi。我现在的问题是如何将 JSF 与 OSGi 集成。我想制作一个主要的 Web 服务器，并添加带有 jsf 页面运行时的捆绑包。我怎样才能做到这一点？有什么需求？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T08:38:44.617

由于其类加载机制，JSF 相当复杂。如果您使用[Pax-Web](http://team.ops4j.org/wiki/display/paxweb/Pax+Web)，则可以使用 JSF，尽管它需要一些特殊处理。有关更多详细信息，请与[OPS4j 社区](https://groups.google.com/forum/?fromgroups=#!forum/ops4j)联系。另一个提示，因为您似乎尝试构建自己的“网络容器”，我不建议您尝试使用现有的，让生活更轻松:)

# perl - Access-Control-Allow-Origin Perl 不允许来源

> ID：14199341
> 
> 赞同：0
> 
> 时间：2013-01-07T15:51:56.923
> 
> 标签：perl, cors

我正在向远程 perl 服务器发出请求。但问题是

```
XMLHttpRequest cannot load http://otherdomain.com/getPub.pl?content=hello. Origin http://localhost is not allowed by Access-Control-Allow-Origin. 
```

我已经在 perl 脚本中启用 access_control_allow_origin 为“*”，代码如下：

```
#!/usr/bin/perl

use strict;
use CGI qw(:standard);
use warnings;

my $cgi = new CGI;

print $cgi -> header(
-type => 'text/plain',
-access_control_allow_origin => '*',
  );
my $content = $cgi -> param('content');
open(CON,">content.txt") || die "can't open $!";
print CON $content;
close(CON); 
```

和js请求如下：

```
function sendData(){
    var url = "http://otherdomain.com/getPub.pl?content=hello";
    var xhr = createCORSRequest("GET", url);
    if(!xhr){
        throw new Error ('CORS not supported');
        }
    xhr.send();

}
function createCORSRequest(method, url){
     var xhr = new XMLHttpRequest();
     if("withCredentials" in xhr){
       xhr.open(method,url,true);
     }else if(typeof XDomainRequest != "undefined"){
        xhr = new XDomainRequest();
        xhr.open(method, url);
    }else{
            xhr = null;
    }
return xhr;
} 
```

响应标头为：

```
Allow:GET,HEAD,POST,OPTIONS,TRACE
Connection:Keep-Alive
Content-Length:0
Content-Type:text/plain; charset=UTF-8
Date:Mon, 07 Jan 2013 16:55:44 GMT
Keep-Alive:timeout=15, max=99
Server:Apache/2.2.3 (CentOS) 
```

有什么事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T05:57:52.507

它终于在 PHP 中工作了，尽管我仍然没有看到区别。总结为：

1.使用perl时：

```
my $cgi = new CGI;
print $cgi -> header(
-type => 'text/plain',
-access_control_allow_origin => '*',
-access_control_allow_headers => 'content-type,X-Requested-With',
-access_control_allow_methods => 'GET,POST,OPTIONS',
-access_control_allow_credentials => 'true',
); 
```

HTTP标头为：

请求头：

```
Request Method:OPTIONS
Status Code:200 OK
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Access-Control-Request-Headers:origin, x-requested-with, content-type
Access-Control-Request-Method:POST
Connection:keep-alive
Host:example.org
Origin:http://localhost
Referer:http://localhost/testCORS.html
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko)         Chrome/23.0.1271.97 Safari/537.11 
```

响应头：

```
Allow:GET,HEAD,POST,OPTIONS,TRACE
Connection:Keep-Alive
Content-Length:0
Content-Type:text/plain; charset=UTF-8
Date:Tue, 08 Jan 2013 05:52:26 GMT
Keep-Alive:timeout=15, max=100
Server:Apache/2.2.3 (CentOS) 
```

2\. 但是在 PHP 中，它可以工作！！！：我没有看到差异！

代码为：

```
<?php
 header("Access-Control-Allow-Origin: *");
 header("Access-Control-Allow-Methods: GET,POST,OPTIONS");
 header("Access-Control-Allow-Headers: X-Requested-With,");
 #header("Access-Control-Allow-Credentials: true");
 ?> 
```

响应头：

```
Access-Control-Allow-Headers:X-Requested-With
Access-Control-Allow-Methods:GET,POST,OPTIONS
Access-Control-Allow-Origin:*
Connection:Keep-Alive
Content-Length:0
Content-Type:text/html; charset=UTF-8
Date:Tue, 08 Jan 2013 05:52:10 GMT
Keep-Alive:timeout=15, max=100
Server:Apache/2.2.3 (CentOS)
X-Powered-By:PHP/5.3.3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T15:59:05.080

您需要确保您的服务器使用正确的 Access-Control-Allow-Origin 标头响应对该 URL 的 OPTIONS 请求。浏览器将通过首先发出 OPTIONS 请求来“预检”您的请求。如果失败，它根本不会尝试您的请求。

# css - IE7和标题中的嵌套跨度

> ID：14199342
> 
> 赞同：0
> 
> 时间：2013-01-07T15:51:59.287
> 
> 标签：css, header, internet-explorer-7, html

不知道为什么我无法弄清楚这一点，我相信这很简单......

我的标题使用以下代码进行了剪辑-

```
h2.boxtitle2 { width:100%; text-align:left; border-bottom: 1px solid #FFCC00; line-height:0.1em; margin:10px 0 10px; }

h2.boxtitle2 span { background:#fff; padding:0 10px; font-family: Arial, Helvetica, sans-serif; font-size:18px !important; margin: 0 10px; padding: 0 5px; font-weight:normal; text-transform:uppercase; color:#666666 !important;}

<h2 class="boxtitle2"><span>Key Dates</span></h2> 
```

在除 IE7 之外的所有浏览器中看起来都很棒......任何人都知道我可以在那里修复它 - 这是一个内部网站，大约 40% 的用户使用 IE7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:02:16.200

尝试删除行高 0.1em。有了这个 line-height，行上的标题就没有足够的空间了。尝试其他方式... png 可能是...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:22:13.397

`Position:relative`并且`z-index:2`跨度元素似乎在我的 IE7 中工作，但可能不是最好的解决方案：

[http://jsfiddle.net/zrxqB/13/](http://jsfiddle.net/zrxqB/13/)

# java - 解析 TCP 数据包

> ID：14199351
> 
> 赞同：2
> 
> 时间：2013-01-07T15:52:14.177
> 
> 标签：java, parsing, tcp, packet

我在解析来自套接字的 TCP 数据包时遇到了一些麻烦......

在我的协议中，我的消息是这样的：

> 'A''B''C''D''E'............0x2300

'A''B''C''D''E' --> 开始消息模式

0x2300 --> 两个字节的结束信息

但是由于[Nagle 的算法](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)，有时我的消息会像这样连接起来：

'A''B''C''D''E'............0x2300'A''B''C''D''E'............0x2300 'A''B''C''D''E'............0x2300

我已经尝试过，`setNoDelay()`但问题仍然存在。

我有一个字节[]中的消息。

如何拆分我的消息以单独解析？

PS：现在我能够收到第一条消息，但其他消息都丢失了......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:01:41.090

只需遍历您收到的数据并检查结束标记。找到后将开始索引设置为下一个包并继续搜索。像这样的东西：

```
int packageStart = 0;
for(int i = 0; i < data.length - 1; i++) {
  if(data[i] == 0x23 && data[i + 1] == 0x00) {
      // Found end of package
      i++;
      processPackage(data, packageStart, i);
      packageStart = i;
  }
  // At this point: from packageStart till data.length are unprocessed bytes... 
```

如前所述，可能会有一些剩余数据（如果`data`没有以结束标记结束）。您可能希望保留它，以便将其添加到下一批接收到的数据中。从而防止由于切碎的 TCP/IP 包造成的数据丢失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:16:42.833

您必须将其视为解析连续的字节流。您的代码需要识别消息的开始和结束。

由于数据包的发送方式，您可能有完整的消息、多条消息、部分消息等。您的代码需要识别消息何时开始并继续阅读，直到找到消息的结尾或在某些情况下，当您读取的字节数超过最大消息大小并且需要重新同步时。

我已经看到一些通信管理器断开并重新建立连接（重新开始），而另一些则丢弃数据，直到他们能够恢复同步。然后，您将获得是否需要保证交付和重传的乐趣。

最好的协议是简单的。创建一个消息头，其中包含一个 SOH 字节、一个两字节消息长度（或任何适当的）、一个 2 字节消息类型和 1 字节消息子类型。您还可以使用任意数量的字节结束消息。看一个 ASCII 图表，有许多十六进制字节 00-1F 自终端时代以来就非常标准。

在这里重新发明轮子没有意义。使它更容易，因为您知道该消息应该多长时间，而不是在数据中寻找模式。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-07T16:03:44.470

听起来您需要将其视为字节流并缓冲数据包，直到您看到 EOF 代码 0x2300。

# python - 为 SQLite3 和 Python 中的模式搜索形成经过净化的查询字符串

> ID：14199354
> 
> 赞同：2
> 
> 时间：2013-01-07T15:52:15.713
> 
> 标签：python, sql, sqlite

我试图在 Python 中形成一个经过清理的查询字符串以在 SQLite3 中使用。它需要采取最终形式：

```
SELECT * FROM Players WHERE PlayerName LIKE '%bob%' 
```

...所以我可以运行模式搜索。

理想情况下，我想要一个 ? 在查询中，这样我就可以在运行查询时插入搜索字符串并防止发生*Bobby Tables*类型事件（我不必担心这个问题）：

```
search_string = "bob"

query = "SELECT * FROM Players WHERE PlayerName LIKE '%?%'"

cur.execute(query, (search_string)) 
```

运行它给了我：

> sqlite3.ProgrammingError：提供的绑定数量不正确。当前语句使用 0，并且提供了 3。

所以我很确定问题出在单引号、百分比和问号的使用上，但我相当卡住了——我无法形成查询，以便 python 看到它需要绑定。

解决此问题的最佳方法是什么，或者是否有更好的做法可以在 SQL 中为模式搜索形成经过清理的查询？

更新：最后一行是：

```
cur.execute(query, [('%' + search_string + '%')]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T15:55:01.810

```
query = "SELECT * FROM Players WHERE PlayerName LIKE '%' + ? + '%'" 
```

您只需要分隔变量（？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:32:55.563

在参数分配期间使用单独的占位符`?`after`LIKE`和 wrap `search_string`with ：`%`

```
...
search_string = 'bob'
query = 'SELECT * FROM Players WHERE PlayerName LIKE ?'
cur.execute(query, ('%' + search_string + '%')) 
```

# ruby-on-rails - Rails 3.2.x 关联和 attr_accessible

> ID：14199361
> 
> 赞同：4
> 
> 时间：2013-01-07T15:52:32.693
> 
> 标签：ruby-on-rails, rails-activerecord

试图找到关于活动记录关联是否应该在 attr_accessible 属性列表中的明确答案。

我见过

```
class Foo

  attr_accessible :name
  attr_accessible :bars

  belongs_to :bar
end 
```

也见过

```
 attr_accessible :bars_id 
```

想知道能够做到的正确方法 Foo.new(name: 'name' bar: barvar)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:35:20.800

通常，明确的答案是：“这取决于™”

**只有您要批量分配的属性才能访问。**

因此，如果您想或需要这样做……</p>

```
Foo.new(name: 'name', bar: barvar) 
```

......那么你只需*要使*可`bar`访问性。

最后`assign_attributes`调用它`send("#{attribute_name}=", attribute_value)`在检查属性的可访问性后执行一个简单的操作。

**一些编码风格方面：**

`param`处理哈希时通常会发生批量分配。至少这就是安全问题潜伏的地方。那里你很少有一个`Bar`对象，但更常见的是一个`bar_id`.

但是，如果您使用模型实例，大多数人更喜欢使用关联方法（如@Andrew Nesbitt 所写），因为这通常具有一些优势（自动保存、自动更新关联对应项、更简洁的代码……）

所以有理由有一个或另一个或两者兼而有之。

我的个人意见：不应该在这个话题上浪费太多时间，因为 Rails 4.0 将有[一个更好](http://weblog.rubyonrails.org/2012/3/21/strong-parameters/)的参数清理解决方案。（如果你也想在 Rails 3 中看到[strong_parameters的话）](https://github.com/rails/strong_parameters)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:10:38.403

您可以避免需要通过使用关联构建器来访问 bar_id：

```
# singular (has_one)
foo = bar.build_foo(name: 'name')

# plural (has_many)
foo = bar.foos.build(name: 'name') 
```

唯一需要使关联可访问的情况是使用accepts_nested_attributes。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:33:55.497

虽然您可以避免在您的示例中使`bars_id`（不应该`bar_id`吗？）可访问，但问题是您的应用程序的某些部分是否仍需要访问它。使用 active_admin，我必须使`whatever_id`可访问的东西与关系一起工作。

# php - 使用 PHP 从 URL 解析 JSON

> ID：14199363
> 
> 赞同：3
> 
> 时间：2013-01-07T15:52:50.933
> 
> 标签：php, json

谷歌搜索后，在代码上实现代码，我仍然无法显示任何内容。没有什么。不是一回事。

我有一个吐出 JSON 的 URL：

```
 {"videos":[{"video":{"name":"Sanyo Zio","youtube":"FxxLDr--R5A","post_date":"2010-10-08 01:00:00",... 
```

这是我用来访问该页面的代码：

```
 $url = file_get_contents("http://[website]/json/test.json");

 $arr = json_decode($url,true); 
```

现在这是我尝试从页面访问任何数据的简短列表：

1：

```
 print_r($arr); 
```

2：

```
 foreach($arr['videos']['video'] as $item) {
   echo "Name: ". $item[0] ."<br>"; 
 } 
```

3：

```
 $obj = $arr[0];
 echo $obj; 
```

4：

```
 foreach($arr as $a){
   echo "Name: ".$a['videos']['video']['name']."<br />";
 } 
```

显然我错过了一些东西，但我只是无法弄清楚我做错了什么！我的编码不正确吗？下面是我开始对 JSON 进行编码的方式：

```
 $arr = array('videos' => array());
 foreach($vid as $items){
  $arr['videos'][] = array('video' => array(
    'name' => $items['videoName'], 'youtube' => $items['youtubeID'], 'post_date' => $items['productionTimestamp'], 'description' => $items['videoDesc'], 'link' => $single_linker_values['deeplink'], 'image' => $image));
 }
 echo json_encode($arr); 
```

有什么想法/建议吗？

* * *

更新 - 显然服务器已被锁定，但在内部我没有注意到 :) 显然网页确实如此！谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:56:24.760

[来自 PHP 手册](http://php.net/manual/en/function.json-decode.php)

> 如果无法解码 json 或编码的数据比递归限制深，则返回 NULL

由于您没有指定递归限制，因此您的 JSON 可能无效或没有从您的 URL 中检索到任何内容。

尝试三件事：

*   判断是否有 json_decode 错误

    `print_r(json_last_error()); // call after json_decode`

*   检查是否正在返回数据

    `print_r($url);`

*   查看数据是否会解码为对象

    `$obj = json_decode($url);`

    `print_r($obj);`

# mysql - 数据库设计 (MySQL) - 独立和连锁店

> ID：14199366
> 
> 赞同：0
> 
> 时间：2013-01-07T15:53:10.560
> 
> 标签：mysql, database, database-design, relational-database

我有一个处理不同商店实体创建的应用程序。

流程：
1\. 用户注册到网站
2\. 用户创建店铺（具有各种属性）

到目前为止，我对数据库表的了解是：

```
[USER]  
user_id

[USER_TO_SHOP]  
user_id  
shop_id

[SHOP]  
shop_id 
```

上述设计涵盖了 1 个用户在其帐户下拥有许多商店实体的需求。
我现在想要实现的是拥有独立的商店实体，但也拥有属于商店组的商店实体

连锁店示例：
麦当劳地址 X 芝加哥
麦当劳地址 X 纽约
麦当劳地址 X 波士顿

我应该如何进行我的数据库设计以支持连锁商店但也支持独立商店？非常感谢最佳实践！

*我所说的独立是指不属于连锁店的商店实体

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:58:24.103

在我的脑海中，我有一个位置表并将商店重命名为公司，因此单个公司进入该表但可以有多个位置。然后用户与公司位置相关联。

有很多方法可以实现您想要的，因此，答案将是主观的，因为我们并没有真正了解整个情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T15:57:59.683

好吧，对于链，你可以有这样的东西，就像你对用户一样：

```
[CHAIN]
chain_id

[CHAIN_TO_SHOP]
chain_id
shop_id 
```

但不确定您所说的独立商店是什么意思 - 如果您的意思是不属于用户或连锁店的商店，可能是这样的：

```
[STANDALONE_SHOP]
shop_id 
```

但我会质疑这样一张桌子的必要性，因为如果没有进入`CHAIN_TO_SHOP`或`USER_TO_SHOP`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:00:55.747

根据您的说法，一家商店可以属于0到1个连锁店？如果是这样，我只需添加一个额外的表并将外键添加到 shop 表：

```
[CHAIN]
chain_id
chain_name

[SHOP]
shop_id
chain_id 
```

# python - 如何在 Python 中验证散列（sha1）密码？

> ID：14199369
> 
> 赞同：1
> 
> 时间：2013-01-07T15:53:36.347
> 
> 标签：python, authentication

我正在尝试从 Galaxy 框架中检索密码并进行身份验证。我成功检索了哈希（sha1）格式的密码。如何使用用户输入的密码进行身份验证？我的第一个猜测是将 hashed(sha1) 转换为普通字符串并进行身份验证。那可能吗？如果是，如何将其转换为字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:58:26.320

*...我的第一个猜测是将 hashed(sha1) 转换为普通字符串 ...*

这就是[密码散列函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)试图阻止的（除其他外）——这个属性被称为[原像电阻](https://crypto.stackexchange.com/questions/1173/what-is-pre-image-resistance-and-how-can-the-lack-thereof-be-exploited)。

基本步骤将是相反的：

*   接受用户输入
*   计算用户输入的哈希值
*   将散列的用户输入与存储的凭据/散列进行比较

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:01:48.227

你不能。从哈希码中获取纯文本是**非常困难**的，这正是我们发明哈希的原因。尝试相反：将纯文本转换为哈希，然后进行比较。

如何转换：

```
import hashlib
s = "plain"
h = hashlib.sha1(s).hexdigest() 
```

# php - 如何在 PHP 中将 printf 添加到成功的查询返回

> ID：14199374
> 
> 赞同：0
> 
> 时间：2013-01-07T15:53:52.007
> 
> 标签：php, mysql, sql, phpmyadmin

我有这个代码：

```
$query = mysql_query("CALL dodaj_osobe ('$pesel','$imie','$nazwisko','$telefon','$adres','$nr_konta','$zarobek')"); 
print "DONE"; 
```

但它在查询不成功时也有效。

如何将其更改为“如果此查询成功完成则`printf`此文本，否则`printf`没有”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:56:23.620

```
$result = mysql_query('your SQL query');
if (!$result) {
    print('error: ' . mysql_error()); // an error occured
}
else
{
    print('Done');
} 
```

尝试使用 mysqli，因为不推荐使用 mysql_query： [mysqli 手册](http://php.net/manual/en/mysqli.query.php)

一个简单的 mysqli 示例：

```
<?php
// New Connection
$db = new mysqli('localhost','user','pass','database');
$result = $db->query("your SQL query");
if($result)
{
     // Cycle through results
    while ($row = $result->fetch_object())
    {
        $group_arr[] = $row;
    }
     // Free result set
     $result->close();
     $db->next_result();
}
else 
{
    echo($db->error); // an error occured, print the error
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:00:52.597

好吧，对于初学者来说，停止使用旧的 deprecated `mysql_*`.

我不会向你展示如何做你想做的事，`mysql_*`因为我不想。在 PDO 中，您将执行以下操作：

```
$db = new PDO( 'mysql:host=dbHost;dbName=yourDBName;' , 'user' , 'pass' );

try
{
   $st = $db->prepare("CALL dodaj_osobe (pesel:,imie:,nazwisko:,telefon:,adres:,nr_konta:,zarobek:)");
   $st->bindValue( 'pesel:' , $pesel , PDO::PARAM_dataType );
   $st->bindValue( 'imie:' , $imie , PDO::PARAM_dataType );
   $st->bindValue( 'nazwisko:' , $nazwisko , PDO::PARAM_dataType );
   $st->bindValue( 'telefon:' , $telefon , PDO::PARAM_dataType );
   $st->bindValue( 'adres:' , $adres , PDO::PARAM_dataType );
   $st->bindValue( 'nr_konta:' , $nr_konta , PDO::PARAM_dataType );
   $st->bindValue( 'zarobek:' , $zarobek , PDO::PARAM_dataType );
   $st->execute();
}
catch( PDOException $qEx )
{
   //the query wasn't successful..
   //deal with it
} 
```

将 all 替换`PDO::PARAM_dataType`为命名占位符的 var 的任何数据类型。因此，例如，如果`$pesel`是一个字符串，则替换`$st->bindValue( 'pesel:' , $pesel , PDO::PARAM_dataType );`为`$st->bindValue( 'pesel:' , $pesel , PDO::PARAM_STR );`. 注意 PARAM_STR?..

如果 OOP 方法让您感到困惑，请使用 MySQLi，因为它支持过程方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:16:06.063

根据 PHP maual: `mysql_query() returns a resource on success`，或`FALSE`出错。

所以，如果你想要这个函数的确切结果，可以这样写；

```
$result = mysql_query("SELECT * FROM table");
if (false !== $result) {
    // it's ok!
} else {
    // error!
} 
```

此外，`mysql_*`自 PHP 5.5.0 起，函数已被弃用。查看更多详细信息：http: [//php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

# java - 摆动切换按钮

> ID：14199376
> 
> 赞同：-1
> 
> 时间：2013-01-07T15:53:55.967
> 
> 标签：java, swing

我有一个关于切换按钮的基本问题：以下代码确实会产生所需的结果，但是，布尔值似乎应该相反。代码在编程上是否正确？

```
public class ToggleButton extends javax.swing.JFrame {

    public ToggleButton() {
        initComponents();
    }

    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        one = new javax.swing.JRadioButton();
        all = new javax.swing.JRadioButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        one.setText("one channel");
        one.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                oneActionPerformed(evt);
            }
        });

        all.setText("all channel");
        all.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                allActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(33, 33, 33)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(all)
                    .addComponent(one))
                .addContainerGap(122, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addComponent(one)
                .addGap(18, 18, 18)
                .addComponent(all)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    private void allActionPerformed(java.awt.event.ActionEvent evt) {                                    
         if("all".equals(evt.getActionCommand())){
                all.setSelected(false);
                one.setSelected(true);
            }else {
                one.setSelected(false);
                all.setSelected(true);
            }              
    }                                   

    private void oneActionPerformed(java.awt.event.ActionEvent evt) {                                    

         if("one".equals(evt.getActionCommand())){
                one.setSelected(false);
                all.setSelected(true); 
            }else{
             all.setSelected(false);
             one.setSelected(true);
         }
    }                                   

    public static void main(String args[]) {

        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /*
         * If Nimbus (introduced in Java SE 6) is not available, stay with the
         * default look and feel. For details see
         * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ToggleButton.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ToggleButton.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ToggleButton.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ToggleButton.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ToggleButton().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JRadioButton all;
    private javax.swing.JRadioButton one;
    // End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:53:12.307

`if("all".equals(evt.getActionCommand()))`你的测试`if("one".equals(evt.getActionCommand()))`总是`false`因为你从来没有`actionCommand`在你`JRadioBuitton`的 's 上设置任何东西。现在，我真的不明白为什么你在 UI 已经这样做的时候尝试设置单选按钮的值。您不必重新修改按钮的状态。

What you may lack is a [`ButtonGroup`](http://docs.oracle.com/javase/7/docs/api/javax/swing/ButtonGroup.html)(and add both `JRadioButton`'s to that group) so that when one JRadioButton is selected the other gets automatically deselected.

# sql - 当数据库时间片大于想要的时间片时如何查询时间序列数据？

> ID：14199378
> 
> 赞同：2
> 
> 时间：2013-01-07T15:54:00.117
> 
> 标签：sql, postgresql, time-series

当 db 时间片大于想要的时间片时，如何从数据中查询时间片。最终结果将用于绘制堆积条形图。

示例数据：

```
START_TS (int)| END_TS (int) | DATA (int) | GROUP
-----------------------------------
0       | 179      | 2000  | G1
180     | 499      | 1000  | G2
500     | 699      | 1000  | G1
845 ... 
```

需要使用时间片作为 100 个“单位”的输出。输出中不需要 End_ts，但有助于理解计算。

```
START_TS |  END_TS  | DATA (equation = amount in that time slice) | GROUP
-------------------------------------------------------
0       |    99   | (2000 / 180) * 100 =  1111 | G1
100     |   199   | (2000 / 180) *  80 =   889 | G1
100     |   199   | (1000 / 320) *  20 =    63 | G2
200     |   299   | (1000 / 320) * 100 =   313 | G2 
300     |   399   | (1000 / 320) * 100 =   313 | G2
400     |   499   | (1000 / 320) * 100 =   313 | G2 
```

从中获得时间序列是这样的。

```
SELECT (startts/100)*100, ...
FROM TABLE
    FULL JOIN
        ( SELECT startts from generate_series(0,700,100) startts ) s1
    USING (startts)
GROUP BY  startts/100 
```

所以它会是这样的（没有分组）

```
 STARTTS | ENDTS | DATA | GROUP
   0     | 179      | 2000   | G1
   100   |      
   180   | 499      | 1000   | G2
   200   |
   300   |
   400   | 
   500   | 699      | 1000   | G1
   600   |
   700 
```

但是如何将 DATA 拆分为两个或多个生成的行（时间片行），以便在时间片中计算。

* * *

** 这基本上有效，但在大数据集上没有真正的功能。行如 1-100M 行。

这是执行此操作的查询+更多聚合不重叠时间片的值

```
SELECT (start_ts/100)*100 as start_ts, sum(part) as data, cgroup
FROM (
SELECT *, ( data * (overlap_end-overlap_start + 1 ) / ( end_ts - tts + 1 ) ) as part
FROM 
    (
    SELECT (case when s1.start_ts > t.start_ts then s1.start_ts else t.start_ts end) as overlap_start,
        (case when s1.start_ts+100 < t.end_ts then s1.start_ts+100-1 else t.end_ts end) as overlap_end,
        t.start_ts as tts, s1.start_ts as start_ts, t.end_ts, cgroup, data
    FROM (SELECT start_ts from generate_series(0,800,100) start_ts ) s1 
        LEFT OUTER JOIN test t on t.start_ts < s1.start_ts+100 and t.end_ts >= s1.start_ts
    ) t
) t2
GROUP BY start_ts/100, cgroup 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:59:11.843

您需要将不同的时隙分成由序列定义的箱。以下查询通过修改连接条件并计算两者之间的重叠来完成此操作：

```
SELECT (startts/100)*100, ...
from (select (case when s1.starts > t.start_ts then s1.starts else t.start_t2 end) as overlap_start,
             (case when s1.starts+100 < t.end_ts then s1.starts+100-1 else t.end_ts end) as overlap_end,
             ts.*
      FROM (SELECT startts from generate_series(0,700,100) startts ) s1 left outer join
           TABLE t
           on t.startts < s1.starts+100 and
              t.end_ts >= s1.starts
     ) t 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T13:38:30.103

[SQL 小提琴](http://www.sqlfiddle.com/#!12/d8107/2)。为了清楚起见，它显示了每个步骤的所有计算列。

```
with data_avg as (
    select start_ts, end_ts, "data" * 1.0 / ((end_ts + 1) - start_ts) data_avg
    from test
), gs as (
    select start_ts, start_ts + 99 end_ts
    from generate_series(
        (select min(start_ts) from test),
        (select max(end_ts) from test),
        100
    ) gs(start_ts)
)
select 
    t_start, t_end,
    gs_start, gs_end,
    cgroup,
    s."start", s."end",
    da.start_ts da_start, da.end_ts da_end
    ,round((s."end" - s."start" + 1) * da.data_avg) "data"
from (
    select
        t.start_ts t_start, t.end_ts t_end,
        gs.start_ts gs_start, gs.end_ts gs_end,
        cgroup,
        greatest(t.start_ts, gs.start_ts) "start", least(t.end_ts, gs.end_ts) "end"
    from
        test t
        inner join
        gs on
            gs.start_ts between t.start_ts and t.end_ts
            or
            gs.end_ts between t.start_ts and t.end_ts
    ) s
    inner join
    data_avg da on
        da.start_ts between t_start and t_end
        and
        da.end_ts between t_start and t_end
order by s."start" 
```

结果：

```
 t_start | t_end | gs_start | gs_end | cgroup | start | end | da_start | da_end | data 
---------+-------+----------+--------+--------+-------+-----+----------+--------+------
       0 |   179 |        0 |     99 | G1     |     0 |  99 |        0 |    179 | 1111
       0 |   179 |      100 |    199 | G1     |   100 | 179 |        0 |    179 |  889
     180 |   499 |      100 |    199 | G2     |   180 | 199 |      180 |    499 |   63
     180 |   499 |      200 |    299 | G2     |   200 | 299 |      180 |    499 |  313
     180 |   499 |      300 |    399 | G2     |   300 | 399 |      180 |    499 |  313
     180 |   499 |      400 |    499 | G2     |   400 | 499 |      180 |    499 |  313
     500 |   699 |      500 |    599 | G1     |   500 | 599 |      500 |    699 |  500
     500 |   699 |      600 |    699 | G1     |   600 | 699 |      500 |    699 |  500 
```

# c# - 在 ASP .NET MVC 中的控制器之间共享数据的最佳方法是什么？

> ID：14199379
> 
> 赞同：3
> 
> 时间：2013-01-07T15:54:02.333
> 
> 标签：c#, asp.net-mvc

我有两个控制器：

```
public class AController : Controller
{
      public ActionResult AControllerAction()
      {
          if (// BControllerAction reported an error somehow )
          {
                ModelState.AddModelError("error-key", "error-value");
          }
          ...
      }
}

public class BController : Controller
{
      public ActionResult BControllerAction()
      {
          try{Something();}
          catch(SomethingExceprion)
          {
              // here I need to add error info data,
              // pass it to AController and redirect to
              // AControllerAction where this error will be added 
              // to model state
          }
      }
} 
```

我想我可以做类似的事情：

```
public ActionResult BControllerAction()
{
     try{Something();}
     catch(SomethingException)
     {
         var controller = new AController();
         controller.ModelState.AddModelError("error-key", "error-value");
         controller.AControllerAction();
     }
} 
```

但我建议这将是打破架构的方法，我不想那样做。除了传递模型对象之外，还有一些更简单、更安全的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:12:58.737

根据您需要将异常的哪些细节传递回控制器 A，我会按照以下方式做一些事情

```
public ActionResult BControllerAction()
{
     try{Something();}
     catch(SomethingException ex)
     {
         return RedirectToAction("AControllerAction", "AController", new { errorMessage = ex.Message() })
     }
} 
```

然后将被调用方法的签名更改为

```
public ActionResult AControllerAction(string errorMessage)
      {
          if (!String.IsNullOrEmpty(errorMessage))
          {
                //do something with the message
          }
          ...
      } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:19:32.153

您可以将重定向返回到 AControllerAction。您可以使用 TempData 字典（类似于 ViewData）在此类调用中共享数据（以这种方式存储的数据将持续到同一会话中的下一个请求，如[本博文中](http://www.gregshackles.com/2010/07/asp-net-mvc-do-you-know-where-your-tempdata-is/)所述）。

例子：

```
public class AController : Controller
{
      public ActionResult AControllerAction()
      {
          if (TempData["BError"] != null)
          {
                ModelState.AddModelError("error-key", "error-value");
          }
          ...
      }
}

public class BController : Controller
{
      public ActionResult BControllerAction()
      {
          try{Something();}
          catch(SomethingExceprion)
          {
              TempData["BError"] = true;
              return RedircetToAction("AControllerAction", "AController");
          }
      }
} 
```

# objective-c - pyobjc 中的 userSpaceScaleFactor

> ID：14199381
> 
> 赞同：1
> 
> 时间：2013-01-07T15:54:06.093
> 
> 标签：objective-c, pyobjc

我一直在玩 pyobjc 并且似乎收到了这个警告，因为我相信下面的代码。

警告：

> NSWindow 类中的方法 userSpaceScaleFactor 在 10.7 及更高版本中已弃用。它不应该在新的应用程序中使用。使用 convertRectToBacking: 代替。

代码：

```
def findFile_(self, parent):
    panel = NSOpenPanel.openPanel()
    panel.setCanChooseDirectories_(YES)
    panel.setAllowsMultipleSelection_(NO)
    panel.setTitle_("Please Choose a File")
    panel.setPrompt_("Choose")
    panel.runModal() 
```

我不是在打电话，这是一个 pyobjc 问题吗？你如何解决这个问题？

感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T15:30:35.193

PyObjC 不会在没有明确要求的情况下调用“userSpaceScaleFactor”。

您提到的 openradar 链接表明该消息是由 NSOpenPanel 中的错误引起的（或者更确切地说，NSOpenPanel 尚未更新为完全视网膜支持）。

# javascript - html5 视频在 ipad 中不起作用

> ID：14199383
> 
> 赞同：0
> 
> 时间：2013-01-07T15:54:09.893
> 
> 标签：javascript, jquery, html, ipad, html5-video

这是我的自定义 HTML5 视频播放器：[我的测试链接](http://iseofirm.net/service/sve186/test_html5/)

```
<video id="vp2_html5_rightSidePlaylist_UB" width="688" height="387" preload="auto">  
          <div id="playlist" class="hideElement">
            <ul>
                <li class="xtitle">Lorem Ipsum Dolor</li>
                <li class="xdesc">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque hendrerit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nam a sem tortor, eu gravida massa. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Praesent feugiat tellus sit amet nisl varius quis blandit mi pretium. Cras non neque diam. Vestibulum elit nunc, tristique quis vulputate eu, lobortis eu neque. Donec mollis consequat arcu.</li>
                <li class="xthumb">videos/thumbs/t_a1.jpg</li>
                <li class="xpreview">videos/previews/prev_a1.jpg</li>
                <li class="xsources_mp4">http://video-js.zencoder.com/oceans-clip.mp4</li>
                <li class="xsources_ogv">videos/big_buck_bunny_trailer.ogv</li>
                <li class="xsources_webm">videos/big_buck_bunny_trailer.webm</li>
            </ul>

            <ul>
                <li class="xtitle">Fusce Suscipit Risus</li>
                <li class="xdesc">Phasellus vitae velit eu turpis consequat hendrerit. Curabitur vitae sapien libero, amet ornare lectus. Vestibulum lobortis quam eu dui luctus molestie. Sed dictum urna at erat congue ultricies ac ut dui. Etiam orci purus, cursus et aliquet et, iaculis sed enim. Sed felis felis, tristique eu suscipit venenatis, accumsan a augue. Donec non enim neque, nec pretium leo. Cras dapibus, lectus in facilisis cursus, dolor justo dictum ligula, quis cursus elit est in felis. Donec tristique magna at tellus gravida luctus.</li>
                <li class="xthumb">videos/thumbs/t_b1.jpg</li>
                <li class="xpreview">videos/previews/prev_b1.jpg</li>
                <li class="xsources_mp4">videos/sintel_trailer.mp4</li>
                <li class="xsources_ogv">videos/sintel_trailer.ogv</li>
                <li class="xsources_webm">videos/sintel_trailer.webm</li>
            </ul>

            <ul>
                <li class="xtitle">Class Aptent Taciti</li>
                <li class="xdesc">Maecenas interdum interdum enim id laoreet. Curabitur semper fermentum leo pretium eleifend.</li>
                <li class="xthumb">videos/thumbs/t_a2.jpg</li>
                <li class="xpreview">videos/previews/prev_a2.jpg</li>
                <li class="xsources_mp4">videos/big_buck_bunny_trailer.mp4</li>
                <li class="xsources_ogv">videos/big_buck_bunny_trailer.ogv</li>
                <li class="xsources_webm">videos/big_buck_bunny_trailer.webm</li>
                <li class="xsources_mp4v">videos/big_buck_bunny_trailer.mp4v</li>
            </ul>

            <ul>
                <li class="xtitle">Maecenas Lacus Ante</li>
                <li class="xdesc">Donec hendrerit magna sit amet eros lobortis non egestas diam scelerisque. Praesent molestie aliquet ipsum.</li>
                <li class="xthumb">videos/thumbs/t_b2.jpg</li>
                <li class="xpreview">videos/previews/prev_b2.jpg</li>
                <li class="xsources_mp4">videos/sintel_trailer.mp4</li>
                <li class="xsources_ogv">videos/sintel_trailer.ogv</li>
                <li class="xsources_webm">videos/sintel_trailer.webm</li>
                <li class="xsources_mp4v">videos/sintel_trailer.mp4v</li> 
            </ul>

            <ul>
                <li class="xtitle">Lorem Ipsum Dolor</li>
                <li class="xdesc">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque hendrerit</li>
                <li class="xthumb">videos/thumbs/t_a3.jpg</li>
                <li class="xpreview">videos/previews/prev_a3.jpg</li>
                <li class="xsources_mp4">videos/big_buck_bunny_trailer.mp4</li>
                <li class="xsources_ogv">videos/big_buck_bunny_trailer.ogv</li>
                <li class="xsources_webm">videos/big_buck_bunny_trailer.webm</li>
                <li class="xsources_mp4v">videos/big_buck_bunny_trailer.mp4v</li>
            </ul>

            <ul>
                <li class="xtitle">Fusce Suscipit Risus</li>
                <li class="xdesc">Phasellus vitae velit eu turpis consequat hendrerit. Curabitur vitae sapien libero, amet ornare lectus. Vestibulum lobortis quam eu dui luctus molestie. Sed dictum urna at erat congue ultricies ac ut dui. Etiam orci purus, cursus et aliquet et, iaculis sed enim. Sed felis felis, tristique eu suscipit venenatis, accumsan a augue. Donec non enim neque, nec pretium leo. Cras dapibus, lectus in facilisis cursus, dolor justo dictum ligula, quis cursus elit est in felis. Donec tristique magna at tellus gravida luctus.</li>
                <li class="xthumb">videos/thumbs/t_b3.jpg</li>
                <li class="xpreview">videos/previews/prev_b3.jpg</li>
                <li class="xsources_mp4">videos/sintel_trailer.mp4</li>
                <li class="xsources_ogv">videos/sintel_trailer.ogv</li>
                <li class="xsources_webm">videos/sintel_trailer.webm</li>
            </ul>

            <ul>
                <li class="xtitle">Class Aptent Taciti</li>
                <li class="xdesc">Maecenas interdum interdum enim id laoreet. Curabitur semper fermentum leo pretium eleifend.</li>
                <li class="xthumb">videos/thumbs/t_a4.jpg</li>
                <li class="xpreview">videos/previews/prev_a4.jpg</li>
                <li class="xsources_mp4">videos/big_buck_bunny_trailer.mp4</li>
                <li class="xsources_ogv">videos/big_buck_bunny_trailer.ogv</li>
                <li class="xsources_webm">videos/big_buck_bunny_trailer.webm</li>
                <li class="xsources_mp4v">videos/big_buck_bunny_trailer.mp4v</li>
            </ul>

            <ul>
                <li class="xtitle">Maecenas Lacus Ante</li>
                <li class="xdesc">Donec hendrerit magna sit amet eros lobortis non egestas diam scelerisque. Praesent molestie aliquet ipsum.</li>
                <li class="xthumb">videos/thumbs/t_b4.jpg</li>
                <li class="xpreview">videos/previews/prev_b4.jpg</li>
                <li class="xsources_mp4">videos/sintel_trailer.mp4</li>
                <li class="xsources_ogv">videos/sintel_trailer.ogv</li>
                <li class="xsources_webm">videos/sintel_trailer.webm</li>
                <li class="xsources_mp4v">videos/sintel_trailer.mp4v</li> 
            </ul>

          </div>

        </video> 
```

它在主要的桌面浏览器和 android 中也可以正常工作。但不能在 ipad 上工作。我尝试了一些工作正常的警报检查。从那我无法预测可能是什么问题。

jQuery插件链接在[这里](http://iseofirm.net/service/sve186/test_html5/js/vp2_html5_rightSidePlaylist.js)

```
(function($) {
$.fn.vp2_html5_rightSidePlaylist_Video = function(options) {
    //fullscreen vars
        var bodyOrigMargin;
        var bodyOrigOverflow;
        //video
        var videoIsFullScreen=false;
    var videoOrigWidth;
        var videoOrigHeight;
        var videoOrigPosition;
        var videoOrigLeft;
        var videoOrigTop;
        //border
        var videoBorderOrigPosition;
        //video container
    --- 
```

请帮我解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:00:28.223

您的 HTML5 视频**也无法在 Safari 桌面**上运行。

我相信您没有提供*H.264*版本的视频，这是 Safari 支持的*唯一*格式。

# php - 将所有 php 文件和错误文档重定向到 index.php，样式表、图像、java 脚本、ajax 请求除外

> ID：14199384
> 
> 赞同：-2
> 
> 时间：2013-01-07T15:54:16.247
> 
> 标签：php, .htaccess, mod-rewrite

好吧，这个问题很常见，我也搜索并尝试了很多答案，但我没有得到可以解决我的问题的正确格式。

我想要的是。

1.  重定向所有错误文档（即任何未找到的文件或目录请求都应重定向到根文件，在我的情况下 - index.php）

2.  将所有页面请求重定向到根文件（index.php）作为参数，即如果有人输入类似的 url

**domain.com/directory_request/file_request**

那么它应该被视为

**domain.com/index.php?directory=directory_request&file=file_request**

并要求像

**domain.com/directory_request1/directory_request2/file_request**

那么它应该被视为

**domain.com/index.php?directory=directory_request1-directory_request2&file=file_request**

1.  所有图像、css、javascript、文件不应重定向到根文件。还有一件事我希望所有不存在的 css、图像等也应该重定向到根文件。

简而言之，所有请求的 url 都应重定向到根文件 index.php，其参数与前面第 2 点中描述的请求相同，但所有现有图像 javascript 、 css 请求除外。

我希望我能澄清我的观点。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:59:17.007

通常，在这种情况下，最好将所有请求定向到您的前端控制器并解析该`$_SERVER['REQUEST_URI']`文件的内部。这使您可以将所有规则和解析保存在一个地方（与在 .htaccess 中解析 URL 和在前端控制器中路由请求相反）。

像这样的简单规则可能是（在您的 .htaccess 文件或 httpd.conf 中）：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php [QSA,L] 
```

`RewriteCond`告诉 Apache 仅在请求的`RewriteRule`文件名不是实际文件时才运行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:00:41.363

最好使用`RewriteCond`'s 检查请求的目录/文件是否存在。

```
RewriteCond %{REQUEST_URI} !-d
RewriteCond %{REQUEST_URI} !-f 
```

然后你可以在你的每条规则前面使用这些。要完全按照您的意愿获得它，您可以使用任意数量的规则，如下所示：

```
RewriteRule ^(.*)/(.*)$ index.php?directory=$1&file=$2 
```

# c# - 加入两个列表 带有 foreach 循环

> ID：14199386
> 
> 赞同：3
> 
> 时间：2013-01-07T15:54:20.897
> 
> 标签：c#, foreach

我正在尝试稍微远离 LINQ，它已被证明总体上非常有用，但有时也很难阅读。

我曾经使用 LINQ 来执行连接（完全外连接），但为了简单起见，我更喜欢使用 for/foreach 循环。我刚刚将一个 LINQ 语句（不是 PLINQ）转换为嵌套的 foreach 循环，性能受到了严重打击。过去需要几秒钟的时间现在大约需要一分钟，请参见下面的代码。

```
foreach (var p in PortfolioELT)
{
    double meanloss;
    double expvalue;
    double stddevc;
    double stddevi;
    bool matched = false;

    foreach (var a in AccountELT)
    {
        if (a.eventid == p.eventid)
        { DO SOME MATH HERE <----- 
```

关于任何一个的任何想法

1.  为什么这比 LINQ Join 慢
2.  我怎样才能加快速度？

该程序相当明显地做了它需要做的事情，但是太慢了。

编辑：旧代码已满

```
public static ConcurrentList<Event> CreateNewELTSUB(IList<Event> AccountELT, IList<Event> PortfolioELT)
    {
        if (AccountELT == null)
        {
            return (ConcurrentList<Event>)PortfolioELT;
        }
        else
        {
            //Subtract the Account ELT from the Portfolio ELT
            var newELT = from p in PortfolioELT
                         join a in AccountELT
                         on p.eventid equals a.eventid into g
                         from e in g.DefaultIfEmpty()
                         select new
                         {
                             EventID = p.eventid,
                             Rate = p.rate,
                             meanloss = p.meanloss - (e == null ? 0d : e.meanloss),
                             expValue = p.expValue - (e == null ? 0d : e.expValue),
                             stddevc = Math.Sqrt(Math.Pow(p.stddevc, 2) - (e == null ? 0d : Math.Pow(e.stddevc, 2))),
                             stddevi = Math.Sqrt(Math.Pow(p.stddevi, 2) - (e == null ? 0d : Math.Pow(e.stddevi, 2)))
                         };

            ConcurrentList<Event> list = new ConcurrentList<Event>();
            foreach (var x in newELT)
            {
                list.Add(new Event(x.meanloss, x.EventID, x.expValue, x.Rate, x.stddevc, x.stddevi));
            }
            return list;
        }
    } 
```

新代码已满：

```
 public static ConcurrentList<Event> CreateNewELTSUB(IList<Event> AccountELT, IList<Event> PortfolioELT)
    {
        if (AccountELT == null)
        {
            return (ConcurrentList<Event>)PortfolioELT;
        }
        else
        {
            //Subtract the Account ELT from the Portfolio ELT
            ConcurrentList<Event> newlist = new ConcurrentList<Event>();

            //Outer Join on Portfolio ELT
            foreach (var p in PortfolioELT)
            {
                double meanloss;
                double expvalue;
                double stddevc;
                double stddevi;
                bool matched = false;

                foreach (var a in AccountELT)
                {
                    if (a.eventid == p.eventid)
                    {
                        matched = true;
                        meanloss = p.meanloss - a.meanloss;
                        expvalue = p.expValue - a.expValue;
                        stddevc = Math.Sqrt((Math.Pow(p.stddevc, 2)) - (Math.Pow(a.stddevc, 2)));
                        stddevi = Math.Sqrt((Math.Pow(p.stddevi, 2)) - (Math.Pow(a.stddevi, 2)));
                        newlist.Add(new Event(meanloss, p.eventid, expvalue, p.rate, stddevc, stddevi));
                    }
                    else if (a.eventid != p.eventid)    //Outer Join on Account
                    {
                        newlist.Add(a);
                    }
                }
                if (!matched)
                {
                    newlist.Add(p);
                }
            }
            return newlist;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T16:01:37.863

> 为什么这比 LINQ Join 慢

我故意跳过回答这个问题

> 我怎样才能加快速度？

您正在`AccountELT`为每个`PortfolioELT`. 您应该循环一个，并将另一个转换为字典，以便更轻松地查找特定记录。就像是：

```
var accountELTIdx = AccountELT.ToDictionary(k => k.eventid); 
```

然后

```
foreach (var p in PortfolioELT)
{
    double meanloss;
    double expvalue;
    double stddevc;
    double stddevi;
    bool matched = false;

    if(accountELTIdx.ContainsKey(p.eventid)
    {
        var acct = accountELTIdx[p.eventid];
        // some maths
    }
    .... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:01:06.383

您每次迭代都在创建局部变量，这些变量可能会或可能不会被使用。

```
 double meanloss;
            double expvalue;
            double stddevc;
            double stddevi;
            bool matched = false; 
```

您正在对匹配的事件 id 进行线性搜索，如果只有 1 个列表按“eventid”排序，您可以使用二进制搜索而不是完全线性搜索的浪费精力。

```
 foreach (var a in AccountELT)
            {
                if (a.eventid == p.eventid) 
```

# android - 在 OpenGL 中使用带有多个数组的单个 ByteBuffer

> ID：14199388
> 
> 赞同：0
> 
> 时间：2013-01-07T15:54:27.803
> 
> 标签：android, opengl-es, bytebuffer

在我的应用程序中，我必须使用 OpenGL 绘制多个元素，有些是三角形，有些是线条。每当我要绘制新形状时，我都会将我的顶点放入多个`float[]`，并将我的索引放入多个。`short[]`我还必须为每个新数组创建一个新的`FloatBuffer`,以使其工作。我怎样才能更有效地绘制多个元素？我正在考虑将所有顶点放入一个单一的并为每个元素创建一个新的以删除多余的数组，但是是否可以使用一个，并将所有数组放入一个单一的，例如：`ShortBuffer``ByteBuffer`

`float[]``short[]``FloatBuffer``ShortBuffer``ByteBuffer`

```
float[] vertices = { -3, -3, -3, 2, 3, 0, 2, -1, 0, 0, 5, 2, 3, 1 };
short[] indItemA = { 0, 1, 2, 0, 2, 3 };
short[] indItemB = { 4, 5, 6 };

FloatBuffer fBuff;
ShortBuffer sBuff;

ByteBuffer bBuff = ByteBuffer.allocateDirect(vertices.length * 4);
fbBuff.order(ByteOrder.nativeOrder());

fBuff = bBuff.asFloatBuffer();
fBuff.put(vertices);
fBuff.position(0);

sBuff = bBuff.asShortBuffer();
sBuff.put(indItemA);
sBuff.position(0);

sBuff.put(indItemB);
sBuff.position(0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T02:22:55.783

glBufferData 将数据从缓冲区发送到显卡的内存。在调用之后，您可以使用 ByteBuffer 做任何您想做的事情，它不会影响已经发送的数据。

因此，如果您的目标是减少您创建的 ByteBuffer 的数量，您可以只创建一个用于所有内容的大型 ByteBuffer。只需重置缓冲区的指针，写入数据，发送到显卡并重复。

```
// Do this once
ByteBuffer bBuff = ByteBuffer.allocateDirect( someBigNumber );
bBuff.order(ByteOrder.nativeOrder());
FloatBuffer fBuff = bBuff.asFloatBuffer();
ShortBuffer sBuff = bBuff.asFloatBuffer();

// Do this for each shape
fBuff.position(0);
fBuff.put(vertices);
fBuff.position(0);

glBindBuffer( GL_ARRAY_BUFFER, vertexbuffer );
glBufferData( GL_ARRAY_BUFFER, vertices.length * 4, fBuff, GL_STATIC_DRAW );

sBuff.position( 0 );
sBuff.put( indices );
sBuff.position( 0 );

glBindBuffer( GL_ARRAY_BUFFER, indexbuffer );
glBufferData( GL_ARRAY_BUFFER, indices.length * 2, sBuff, GL_STATIC_DRAW ); 
```

如果您的顶点和索引数据是静态的，您可以将每个形状的顶点数据放入一个缓冲区对象中，并将所有索引数据放入另一个缓冲区对象中，然后使用 glVertexPointer 和 glIndexPointer 的偏移参数来指定数据在缓冲区对象中的开始位置。

It sounds like you generate custom shapes at runtime though, so you could just re-use the ByteBuffer and store each shape in a separate buffer object like the sample above.

# c++ - DirectX 9 在 TRIANGLEFAN 中隐藏第一个三角形

> ID：14199395
> 
> 赞同：1
> 
> 时间：2013-01-07T15:55:03.763
> 
> 标签：c++, directx

我的问题是：**如何使用 绘制正确的金字塔（三角四边形金字塔）** `D3DPT_TRIANGLEFAN`？

我用作积分：

```
CUSTOMVERTEX vertices[] =
{
    {  0.0f, 3.0f, 0.0f, 0x00ff0000, },           //The top Vertex
    {  1.0f, 0.0f, -1.0f, 0xff00ff00, },          //(A) vertex
    {  1.0f, 0.0f, 1.0f,  0xff0000ff, },          //(B) vertex
    {  -1.0f, 0.0f, 1.0f, 0xffffff00, },          //(C) vertex
    {  -1.0f, 0.0f, -1.0f, 0xffff00ff, },         //(D) vertex
    {  1.0f, 0.0f, -1.0f, 0xff00ff00, },          //(A) vertex
}; 
```

其中 a`CUSTOMVERTEX`是：

```
struct CUSTOMVERTEX 
{
    float x, y, z;
    DWORD color;
}; 
```

我称之为：

```
g_pD3DDevice->DrawPrimitive(D3DPT_TRIANGLEFAN, 0, 5); 
```

金字塔绘制正确，但屏幕上绘制了一个额外的三角形，一个由顶部和第一个顶点组成（一个直角三角形，金字塔底部的 PI / 2 角，另一个点 <<1.0 f, 0.0f, -1.0f>>（第一个点 (A)）。

所以我想要隐藏那个三角形，我尝试让设备从 1 绘制到 5，但这只给了我基础（ (A)-(B)-(C)-(D) 平面），我也试过了制作剔除 D3DCULL_CW，当我将金字塔旋转一半时，我可以看到额外的三角形，而它的一半被另一个平面隐藏了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:05:29.923

最后一个参数`[IDirect3DDevice9::DrawPrimitive()](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174371%28v=vs.85%29.aspx)`是原始计数，在您的情况下应该是 4？

如果要包括基础，则必须将金字塔渲染为三角形列表，而不是完整的金字塔不能用扇形表示。

# haskell - 如何强制 GHC 内联 FFI 调用？

> ID：14199402
> 
> 赞同：6
> 
> 时间：2013-01-07T15:55:27.563
> 
> 标签：haskell, ghc, ffi

我做了小 C 模块来提高性能，但是 GHC 没有内联外部函数，并且调用成本消除了加速。例如`test.h`：

```
int inc (int x); 
```

`test.c`：

```
#include "test.h"
int inc(int x) {return x + 1;} 
```

`Test.hc`：

```
{-# LANGUAGE ForeignFunctionInterface #-}
module Test (inc) where
import Foreign
import Foreign.C
foreign import ccall unsafe "test.h inc" c_inc :: CInt -> CInt
inc = fromIntegral . c_inc . fromIntegral
{-# INLINE c_inc #-}
{-# INLINE inc #-} 
```

`Main.hs`：

```
import System.Environment
import Test
main = do {args <- getArgs; putStrLn . show . inc . read . head $ args } 
```

制造：

```
$ gcc -O2 -c test.c
$ ghc -O3 test.o Test.hs
$ ghc --make -O3 test.o Main
$ objdump -d Main > Main.as 
```

最后，在`Main.as`我有`callq <inc>`说明而不是可取`inc`的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T17:21:22.220

GHC 不会通过其 asm 后端或 LLVM 后端内联 C 代码。通常，如果您调用的东西确实花费很多，您只会出于性能原因调用 C。增加一个 int 不是这样的事情，因为我们已经有了 primops 。

现在，如果您通过 C 调用，您可能会让 GCC 内联（检查生成的程序集）。

但是，现在您可以做一些事情来最小化通话成本：

```
foreign import ccall unsafe "test.h inc" c_inc :: CInt -> CInt

inc = fromIntegral . c_inc . fromIntegral 
```

为`inc`. 您在这里为转换为 Integer 付出了宝贵的周期。

像您一样将调用标记为“不安全”，以便在调用之前不会为运行时添加书签。

测量 FFI 调用开销 - 它应该以纳秒为单位。但是，如果您觉得它仍然太贵，您可以[编写一个新的 primop 并直接跳转到它。](http://breaks.for.alienz.org/blog/2012/05/23/ffi-vs-primops)但你最好先有你的[标准](http://hackage.haskell.org/package/criterion)数字。

# php - MySQL转储的动态匿名化

> ID：14199404
> 
> 赞同：5
> 
> 时间：2013-01-07T15:55:40.877
> 
> 标签：php, mysqldump, anonymize

我正在使用 mysqldump 创建供开发人员使用的实时应用程序的数据库转储。

此数据包含客户数据。我想匿名化这些数据，即删除客户姓名/信用卡数据。

一个选项是：

*   创建数据库副本（创建转储和导入转储）
*   触发对数据进行匿名化的 SQL 查询
*   转储新数据库

但这有很多开销。更好的解决方案是在转储创建期间进行匿名化。

我想我最终会解析所有`mysqlsqldump`输出？有没有更智能的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:04:12.270

如果要随机化数据，为什么要从表中进行选择？

做一个`mysqldump`可以安全转储数据的表（配置表等），以及一个`mysqldump`只包含结构的敏感表。

然后，在您的应用程序中，您可以根据随机创建的数据为敏感表构造 INSERT 语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-11-23T20:06:06.597

你可以试试 Myanon：[https ://myanon.io](https://myanon.io)

在转储期间匿名化是即时完成的：

```
mysqldump | myanon -f db.conf | gzip > anon.sql.gz 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-06T11:05:48.667

几天前我不得不开发类似的东西。我不能这样做`INTO OUTFILE`，因为数据库是 AWS RDS。我最终采用了这种方法：

从某个表中以表格文本形式转储数据：

```
mysql -B -e 'SELECT `address`.`id`, "address1" , "address2", "address3", "town", "00000000000" as `contact_number`, "example@example.com" as `email` FROM `address`' some_db > addresses.txt 
```

然后导入它：

```
mysql --local-infile=1 -e "LOAD DATA LOCAL INFILE 'addresses.txt' INTO TABLE \`address\` FIELDS TERMINATED BY '\t' ENCLOSED BY '\"' IGNORE 1 LINES" some_db 
```

执行此操作只`mysql`需要命令。

由于导出非常快（大约 30.000 行需要几秒钟），导入过程有点慢，但仍然很好。我不得不在途中加入几张桌子，并且有一些外键，所以如果你不需要它肯定会更快。此外，如果您在导入时禁用外键检查，它也会加快速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T16:09:21.397

您还可以使用[SELECT](http://dev.mysql.com/doc/refman/5.1/en/select.html)查询中的 SELECT ... INTO OUTFILE 语法来使用列过滤器进行转储。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-07T15:59:20.127

您可以选择每个表（而不是选择 *）并指定您想要拥有的列并省略或空白那些您不想拥有的列，然后为每个查询使用 phpmyadmin 的导出选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T16:48:57.063

我发现了类似的问题，但看起来你想要的没有简单的解决方案。您必须自己编写自定义导出。

*   [MySQL 通过查询转储](https://stackoverflow.com/questions/935556/mysql-dump-by-query)
*   [MySQL：从 SQL 查询中转储数据库](https://stackoverflow.com/questions/2024683/mysql-dump-a-database-from-a-sql-query)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-07T16:46:10.357

phpMyAdmin 为基于 SQL 查询的 SQL 格式提供导出选项。从 PHPmyadmin（可能已经过良好测试）中提取此代码并在此应用程序中使用它可能是一个选项。

代码参考[phpMyAdmin导出插件-exportData方法](https://github.com/phpmyadmin/phpmyadmin/blob/1bd394aed4cd8533339ddda6f7f25d49e5ede969/libraries/plugins/export/ExportSql.class.php#L1525)。

# javascript - JQuery 解析 JSON

> ID：14199408
> 
> 赞同：0
> 
> 时间：2013-01-07T15:55:48.880
> 
> 标签：javascript, jquery

我对 JQuery 相当陌生。下面的代码有效，我可以在 Firebug 中看到正确的 JSON 响应。但我找不到如何在代码中获取和解析它的方法。警报窗口仅显示“[object Object]”，但不显示任何 json 文本。

```
<script>

$.ajaxSetup({ cache: false });

var _token;

function make_token_auth(user, token) {
  var tok = user + ':' + token;
  return "Token " + tok;
}

$.ajax
  ({
    type: "GET",
    url: "url",
    dataType: 'json',    
    beforeSend: function (xhr){ 
        xhr.setRequestHeader('Auth', make_token_auth('userid', 'token')); 
    },
    success: function (data){
        alert(data); 
    }
});

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T15:58:02.497

你精确的事实

```
dataType: 'json', 
```

告诉 jQuery 解析收到的答案并将其作为 javascript 对象提供给您的成功回调。

因此，您在这里所拥有的一切都很好，并且警告的内容是正确的（这是一个对象，因此 [alert](https://developer.mozilla.org/en-US/docs/DOM/window.alert)只是打印 的结果`data.toString()`）。

用于`console.log`查看它到底是什么：

```
success: function (data){
    console.log(data); 
} 
```

并在 Chrome 中打开[开发人员工具](https://developers.google.com/chrome-developer-tools/docs/console)或[在 Firebug 中打开控制台](http://getfirebug.com/logging)以浏览对象的属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T15:59:53.823

不要`alert()`用于调试——它通常是无用的（在这种情况下），并且在与异步代码（即任何 Ajax）一起使用时也会出现严重问题，因为它会中断程序流。

您最好使用浏览器的`console.log()`或`console.dir()`功能，并查看控制台中显示的对象。它功能更多，并且不会中断程序的流程。

所以而不是`alert(myjsonvar)`使用`console.log(myjsonvar)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T15:58:10.870

该`alert`函数希望您传入一个字符串或数字。

尝试做这样的事情：

```
for(x in data) {
    alert(x + ': ' + data[x]);
} 
```

**更新以响应评论：**您可以在开发或生产中使用 alert 来查看服务器端代码返回的对象中的字符串和数字值。

但是，仔细阅读您的问题，看起来您真正想看到的是实际的 JSON 文本。查看上面@dystroy 的答案，我认为如果您`dataType: 'json'`从 $.ajax 调用中删除，jQuery 会将响应视为纯文本，而不是自动将其转换为对象。在这种情况下，您可以通过将文本传递给`alert`函数来查看文本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T16:00:33.147

您可以使用获取 json 字符串`JSON.stringify`

```
var jsonstr = JSON.stringify(data);
alert(jsonstr); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T16:40:09.493

尝试使用

```
data = JSON.parse(data) 
```

然后对数据做任何你想做的事情。

来源：[JSON.parse()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse) (MDN)

# objective-c - 在 OSX 上模拟 UILabel 行为

> ID：14199413
> 
> 赞同：6
> 
> 时间：2013-01-07T15:56:08.673
> 
> 标签：objective-c, ios, cocoa, uilabel, core-text

我想模拟 OSX 应用程序中的多行 UILabel 行为。绘制多行标签，您可以指定行数，换行系统效果很好！

这是我想要实现的一个例子。

这是我想用 UILabel 显示的字符串

```
Lorem Ipsum is simply dummy text of the printing and typesetting industry. 
```

我可以选择一个带有尾部截断的**3 行标签：**

```
 Lorem Ipsum is simply 
 dummy text of the 
 printing and typeset... 
```

或者使用带有尾部截断的 2 行标签，我得到：

```
 Lorem Ipsum is simply 
 dummy text of the pri... 
```

我想我需要一个低级 API 来以这种方式绘制字符串。

目前我找到了 3 种不同的方法来绘制文本，我想了解哪种方法最适合完成这项任务。

* * *

**可可文本**

NSTextView 和 NSTextField: 好像级别太高了...无法重现这个效果（NSTextView 不让我选择行数，换行好像把多行的 NSTextView 变成了单行线 NSTextView）。

***编辑*** 我想从字符串中获取框架，然后从框架中获取线并仅使用所需的线重建框架。你怎么看？

* * *

**核心文本**

我可以很好地控制使用框架的文本绘制，但是......我找不到一种方法来定义要显示的行数以及如何截断字符串。

* * *

**NSLayoutManager**

这似乎也是一个很好的解决方案，但我不知道如何重现 UILabel 多行效果。

你有什么建议可以帮助我完成这个棘手的任务吗？

# java - 异步流上的多个操作

> ID：14199415
> 
> 赞同：2
> 
> 时间：2013-01-07T15:56:10.020
> 
> 标签：java, asynchronous, stream, inputstream

我正在接收一个要保存到光盘的文件，它具有最高优先级。但我想用其他两个操作“拆分”/“共享”这个流。

到目前为止，我的方法是拥有一个 MainStream，它可以创建从 MainStream 中的缓冲区读取的子流。

如果这是一种合适的方法，我需要某种方法来确定子流在流中的位置。我怎样才能做到这一点？
还是解决我的主要问题的更好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:38:36.003

如果 I/O 不是你的瓶颈，你可以使用多线程写文件。

下面的代码只是一个例子：

```
/**
 * @author lichengwu
 * @version 1.0
 * @created 2013-01-08 12:11 AM
 */
public class MultiWrite {

private static final int SIZE = 1024 * 1024 * 1024;

ExecutorService exec = Executors.newFixedThreadPool(5);

public void start() {
    final File source = new File("");
    long size = source.length();
    final File store = new File("");

    for (long position = 0; position < size; position = position + SIZE) {
        exec.execute(new WriteTask(source, store, position));
    }

}

public class WriteTask implements Runnable {

    private final File store;

    private final File source;

    private final long position;

    public WriteTask(File source, File store, long position) {
        this.store = store;
        this.position = position;
        this.source = source;
    }

    public void run() {
        try {

            RandomAccessFile in = new RandomAccessFile(source, "r");

            // lock part of store
            RandomAccessFile out = new RandomAccessFile(store, "rw");
            FileChannel channel = out.getChannel();
            FileLock lock;
            while (true) {
                try {
                    lock = channel.tryLock(position, SIZE, false);
                    break;
                } catch (Exception e) {
                    // deal with
                }

            }

            out.seek(position);
            in.seek(position);
            byte[] data = new byte[SIZE];
            in.read(data);
            out.write(data);
            // release
            lock.release();
            channel.close();
            out.close();
            in.close();
        } catch (IOException e) {
            // deal with
        }
    }
}
} 
```

# javascript - 正则表达式验证 AS 编号

> ID：14199418
> 
> 赞同：1
> 
> 时间：2013-01-07T15:56:16.300
> 
> 标签：javascript, regex, jakarta-ee

我需要一个正则表达式来验证一个 Web 表单字段，该字段应包含一个`asdot`符号中的 AS 编号，如[RFC 5396](https://www.rfc-editor.org/rfc/rfc5396#page-2)中所述：

> 阿斯多特
> 
> ```
>  refers to a syntax scheme of representing AS number values less
>   than 65536 using asplain notation and representing AS number
>   values equal to or greater than 65536 using asdot+ notation.
>   Using asdot notation, an AS number of value 65526 would be
>   represented as the string "65526" and an AS number of value 65546
>   would be represented as the string "1.10". 
> ```

我想将[Javascript RegExp 对象](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)和 Java EE [javax.validation.constraints.Pattern](http://docs.oracle.com/javaee/6/api/index.html?javax/validation/constraints/Pattern.html)与正则表达式一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T10:29:52.490

这是一个 Javascript 正则表达式，应该可以满足您的要求：

```
/^([1-5]\d{4}|[1-9]\d{0,3}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])(\.([1-5]\d{4}|[1-9]\d{0,3}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5]|0))?$/ 
```

假设：不允许以
数字开头。 点后有零的数字是允许的，因为我认为例如表示为. 点后的数字中不允许有前导零，例如无效。 4 字节 AS 编号的最大值是，即asdot 表示法。`0.`
`65536``1.0``1.00009`
`4294967295``65536*65535 + 65535``65535.65535`

作为 Javascript RegExp 对象：

```
var asdot = new RegExp("^([1-5]\\d{4}|[1-9]\\d{0,3}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])(\\.([1-5]\\d{4}|[1-9]\\d{0,3}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5]|0))?$");

console.log( asdot.test('65535.65535') )   // true 
```

作为 Java 模式：

```
Pattern asdot = Pattern.compile("^([1-5]\\d{4}|[1-9]\\d{0,3}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])(\\.([1-5]\\d{4}|[1-9]\\d{0,3}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5]|0))?$");

System.out.println( asdot.matcher("65535.65535").matches() );    // true 
```

# algorithm - 查找范围内最接近的数字

> ID：14199419
> 
> 赞同：13
> 
> 时间：2013-01-07T15:56:18.757
> 
> 标签：algorithm, complexity-theory

我想到了一个问题，如下：

我们有一个大小为 n 的整数数组 A，我们有测试用例 t，在每个测试用例中，我们都有一个数字 m 和一个范围 [s,e]，即给定 s 和 e，我们必须找到最接近的该数组范围内的 m 数（A[s]-A[e]）。

您可以假设数组索引是从 1 到 n。

例如：

```
 A = {5, 12, 9, 18, 19}
  m = 13
  s = 4 and e = 5 
```

所以答案应该是18。

约束：

```
n<=10^5
t<=n 
```

我能想到的只是每个测试用例的 O(n) 解决方案，我认为存在更好的解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T16:33:21.143

这是一个粗略的草图：从数据中创建一个[段树。](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor#Segment_Trees)在每个节点上，除了左右索引等常规数据外，您还存储在以该节点为根的子树中找到的数字，按排序顺序存储。当您以自下而上的顺序构建分段树时，您可以实现这一点。在叶子正上方的节点中，您按排序顺序存储两个叶子值。在中间节点中，您将数字保留在左孩子和右孩子中，您可以使用标准合并将它们合并在一起。树中有 O(n) 个节点，保存这些数据应该花费总体 O(nlog(n))。

一旦你有了这棵树，对于每个查询，沿着路径走，直到你到达给定范围（[s，e]）中的适当节点。如教程所示，一个或多个不同的节点将组合形成给定的范围。由于树深度为 O(log(n))，即每次查询到达这些节点的时间。每个查询应该是 O(log(n))。对于完全位于范围内的所有节点，使用二进制搜索在存储在这些节点中的排序数组中找到最接近的数字。同样，O(log(n))。在所有这些中找到最接近的，这就是答案。因此，您可以在 O(log(n)) 时间内回答每个查询。

我链接到的教程包含其他数据结构，例如稀疏表，它们更容易实现，并且应该为每个查询提供 O(sqrt(n))。但我并没有考虑太多。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-07T16:19:49.253

我相当确定不存在更快的解决方案。您的问题的一个轻微变化是：

*没有数组 A，但每个测试用例都包含要搜索的未排序数字数组。（从 s 到 e 的 A 的数组切片）。*

在这种情况下，显然没有比对每个测试用例进行线性搜索更好的方法了。

现在，您的原始问题比上述变化更具体吗？唯一添加的信息是所有切片都来自同一个数组。我认为这个额外的约束不能用于算法加速。

编辑：我的立场得到纠正。段树数据结构应该可以工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-07T16:34:24.773

对数组进行排序并进行二进制搜索。复杂度：o(nlogn + logn *t)

# ios - 使用 Cocoa 生成图像

> ID：14199420
> 
> 赞同：0
> 
> 时间：2013-01-07T15:56:22.373
> 
> 标签：ios, css, facebook, image, cocoa-touch

我的 iOS 应用程序需要能够生成要发布到 Facebook 和 Twitter 的图像。图像将代表用户添加的数据。该图像不是将显示在屏幕上的任何视图的直接表示。没有必要在创建的图像中包含任何其他图像资源 - 在大多数情况下，我需要格式化样式和布局一些文本，并且可能添加一些边框、线条等 - 但我希望以后能够添加它如果它很简单。

什么方法最适合这样的事情？我应该构建一个`UIView`并将其以某种方式输出到文件吗？有 HTML/CSS 解决方案吗？还是其他方法？

如果您可以推荐为发布到 Facebook/Twitter 优化的文件格式和属性，则可获得奖励积分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:04:10.183

用于`UIGraphicsBeginImageContextWithOptions()`创建新的图像上下文。

然后，使用 Core Graphics 在其中绘制任何你喜欢的东西。您可以使用 Core Graphics 或 Core Text 绘制文本 - 前者更容易，但后者为您提供更多定制机会。

然后，通过使用从上下文中获取 UIImage `UIGraphicsGetImageFromCurrentImageContext()`。

然后，您可以使用`UIImagePNGRepresentation()`.

# utf-8 - 将 HTML 表作为 UTF8 导入 OO Calc 而不转换为实体

> ID：14199428
> 
> 赞同：7
> 
> 时间：2013-01-07T15:56:39.333
> 
> 标签：utf-8, html-entities, html-table, openoffice-calc, libreoffice

如果在 OpenOffice 或 LibreOffice 中打开 HTML 表时，如果它包含 UTF8 扩展字符（如 ÅÄÖåäö），我会遇到问题。

当将表格打开到 M$ Excel 中时，它按预期工作，但我不能让 OO 做同样的事情。

通过将所有扩展字符转换为其等效的 HTML 实体 Å 等它可以工作，但直接获得正确的字符会很好。

有谁知道我该怎么做？

我在一个名为 excelsample.xls 的文件中包含以下内容，如果我用 OO Calc 打开它，它看起来不太好。

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="content-type" content="application/vnd.ms-excel" charset="UTF-8">
    <meta charset="UTF-8">
</head>
<body>
    <table>
        <tr>
            <td>Prawn sandwich</td><td>Räksmörgås</td>
        </tr>
    </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-07T16:18:23.493

您的元标记格式错误，OO 可能无法识别 html5 字符集标记。

所以修复它：

```
<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"> 
```

# javascript - 如何使用 javascript/jquery 使文本框接受十进制值

> ID：14199430
> 
> 赞同：0
> 
> 时间：2013-01-07T15:56:49.613
> 
> 标签：javascript, jquery

我使用 javascript 和 html 制作了一个小应用程序。

但最近我的脚本遇到了问题。

**问题：**输入文本框不允许我输入（.）点/句点，即十进制值。示例：如果我输入一个十进制值，那么它会自动从我的输入文本框中删除。

这可能是什么原因。

我正在尝试从过去 3 小时解决这个问题。但找不到确切的问题。请检查我的代码并帮助我解决这个问题。

相关代码：

```
<table border="0">
    <form name="form_A" onsubmit="return false">
        <tr>
            <td>
                <select name="unit_menu" class="Items" onchange="CalculateUnit(this.form, document.form_B)">
                    <option>
                    ------- Select a Property -------
                                                                    <option>
                    <option>
                    <option>
                    <option>
                    <option>
                </select>

            </td>
            <td>
                <input type="text" id="info" name="unit_input" placeholder="Type to convert" class="textbox" onfocus="CalculateUnit(this.form, document.form_B)" onkeyup="CalculateUnit(this.form, document.form_B)"></td>

        </tr>
    </form>
    <form name="form_B" onsubmit="return false">
        <tr>

            <td>
                <select name="unit_menu" class="Items" onchange="valuefocus()">
                    <option>
                    ------- Select a Property -------
                    <option>
                    <option>
                    <option>
                    <option>
                    <option>
                </select></td>
            <td>
                <input type="text" name="unit_input" size="20" maxlength="20" placeholder="Type to convert" class="textbox" onfocus="CalculateUnit(this.form, document.form_A)" onkeyup="CalculateUnit(this.form, document.form_A)"></td>
            <td></td>
        </tr>
    </form>
</table> 
```

Javascript

```
 function CalculateUnit(sourceForm, targetForm){
            // A simple wrapper function to validate input before making the conversion
            var sourceValue = sourceForm.unit_input.value;

            // First check if the user has given numbers or anything that can be made to
            // one...
            sourceValue = parseFloat(sourceValue);
            if ( !isNaN(sourceValue) || sourceValue == 0){
                // If we can make a valid floating-point number, put it in the
                // text box and convert!
                sourceForm.unit_input.value = sourceValue;
                ConvertFromTo(sourceForm, targetForm);
            } else {
                 //wrong input
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:01:54.293

您的问题是您的转换功能是在 keyup 上触发的，因此如果用户键入`3.`它会被转换`3`并放回该字段。

`parseFloat(3.) = 3`

有几种方法可以解决这个问题。

最简单的方法是不计算值，`keyup`但当用户点击`enter`或字段失去焦点时（`blur`）。

其他选项是在解析之前检查字段的字符串值是否以 a 结尾，`.`并保持不变，只要它不是有效数字。

例子：

```
function CalculateUnit(sourceForm, targetForm){

    // A simple wrapper function to validate input before making the conversion
    var sourceValue = sourceForm.unit_input.value;

    // First check if the user has given numbers or anything that can be made to
    // one...
    if (!/\.$/.test(sourceValue)) {
        sourceValue = parseFloat(sourceValue);
        if ( !isNaN(sourceValue) || sourceValue == 0){
            // If we can make a valid floating-point number, put it in the
            // text box and convert!
            sourceForm.unit_input.value = sourceValue;
            ConvertFromTo(sourceForm, targetForm);
        } else {
             //wrong input
        }
    } else {
        // sourceValue ends with a '.'
    }
} 
```

# database - 标准化之前

> ID：14199435
> 
> 赞同：0
> 
> 时间：2013-01-07T15:57:15.383
> 
> 标签：database, normalization

目前我在学习标准化时遇到了麻烦。虽然我知道 1NF - 3NF 背后的基本概念，但我仍然不了解标准化之前需要遵循的步骤。

根据我的理解，一个人必须先收集`base entities`，他们的`attributes`，`relation among the entities`然后`start normalization`。但我不明白，我是应该一次规范化所有属性还是规范化彼此具有某种关系的实体的属性。

考虑一个商店的例子。

```
store(name, address, contact)
customer(sn, name, address)
item(id, name, price)
transaction(id, date, customer_sn, item_id, quantity, total_price) 
```

根据我的理解，我要么尝试一次规范化所有属性，要么只规范化`customer`,`item`和的属性`transaction`。

我知道我错过了一些东西，我只是无法弄清楚。

任何帮助表示赞赏。感谢您宝贵的时间。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-10T11:15:20.390

> 根据我的理解，必须首先收集基本实体、它们的属性、实体之间的关系，然后开始规范化。

不，你不必那样做。事实上，在开始规范化之前，即使不是不可能，也很难*识别一些基本实体。*

在逻辑层面，您首先收集所有需要的属性，然后将它们放在一个大关系中。您几乎可以在每本关于数据库系统的教科书中找到这方面的较小示例。

收集所有必需的属性后，确定它们之间的依赖关系。

对于商店，您可能会收集这些属性。

*   A、店铺名称
*   B. 存储物理地址
*   C. 项目 sku
*   D. 物品名称
*   E. 商品价格
*   F. 交易时间戳
*   G. 交易类型（如“Purchase”、“Return”、“Store Credit”等）
*   H. 事务寄存器（哪台机器执行了事务）
*   一、交易出纳（哪位员工进行了交易）
*   J. 交易项目 sku
*   K. 交易项目价格
*   l.交易项目数量
*   M. 交易项目扩展价格
*   N. 交易项目销售税
*   O. 交易总额
*   P. 交易支付方式（现金、支票、信用卡）
*   Q. 交易支付金额

之后，您可能会确定这些功能依赖关系是否适用。

*   A->B
*   B->A
*   C->D
*   C->E
*   FH->GI
*   FH->O
*   J->K
*   FHJ->L
*   KL->M
*   KL->N
*   M->N

这是您开始规范化的地方。每次分解一个关系以将其提升到更高的范式时，都会添加另一个关系。每次添加另一个关系时，您也会对其应用所有规范化*原则*。该过程是递归的。

好的 CASE 工具可以根据依赖关系列表生成所有可能的 5NF 分解。

其他设计决策也很重要，但可能与规范化*无关。*

例如，一个设计项目可能决定每人只存储一个电话号码。另一个项目可能决定为每个人存储多个电话号码。这种决定很重要，但与标准化无关。也就是说，每个人存储一个电话号码不违反任何正常形式，每个人存储*多个*电话号码也没有。

# python - 覆盖方法而不陷入无限递归

> ID：14199436
> 
> 赞同：1
> 
> 时间：2013-01-07T15:57:17.063
> 
> 标签：python, methods, overriding

我想`dict`在 Python 中重写该类的一个方法，一个简单的方法：`update`. 假设我想创建一个`MyDict`与标准相同的类，`dict`除了它可以用`dict`必须包含至少 10 个元素的 s 进行更新。

所以我会继续：

```
def update(self, newdict):
    if len(newdict) <= 10: raise Exception
    self.update(newdict) 
```

但是在对 的内部调用中`update`，显然 Python 调用的是被覆盖的函数而不是原来的函数。除了简单地更改函数名称之外，有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:00:22.177

您需要调用`update`超类，将子类的实例作为`self`.

```
def update(self, newdict):
    if len(newdict) <= 10: raise Exception
    dict.update(self, newdict) 
```

您还可以使用[`super()`](http://docs.python.org/2/library/functions.html#super)在运行时确定超类：

```
def update(self, newdict):
    if len(newdict) <= 10: raise Exception
    super(MyDict, self).update(newdict) 
```

在 Python 3 中，您可以省略以下参数`super()`：

```
def update(self, newdict):
    if len(newdict) <= 10: raise Exception
    super().update(newdict) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:01:28.057

你是从*dict*类继承的吗？使用*超级*功能

```
super(MyDict, self).update 
```

应该做的伎俩

# free - GlibC Double 释放或损坏 (fclose)

> ID：14199441
> 
> 赞同：0
> 
> 时间：2013-01-07T15:57:40.457
> 
> 标签：free, glibc, corruption, fclose

我的 C 程序在运行时出错。我发现了一些关于“双重免费或腐败”错误的东西，但没有任何相关性。

这是我的代码：

```
void compute_crc32(const char* filename, unsigned long * destination)
{
  FILE* tmp_chunk = fopen(filename, "rb");
  printf("\n\t\t\tCalculating CRC...");
  fflush(stdout);
  Crc32_ComputeFile(tmp_chunk, destination);
  printf("\t[0x%08lX]", *destination);
  fflush(stdout);
  fclose(tmp_chunk);
  printf("\t[ OK ]");
  fflush(stdout);
} 
```

看来

```
fclose(tmp_chunk); 
```

引发此 glibc 错误：

```
*** glibc detected *** ./crc32: double free or corruption (out): 0x09ed86f0 ***

======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x75ee2)[0xb763cee2]
/lib/i386-linux-gnu/libc.so.6(fclose+0x154)[0xb762c424]
./crc32[0x80498be]
./crc32[0x8049816]
./crc32[0x804919c]
./crc32[0x8049cc2]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb75e04d3]
./crc32[0x8048961] 
```

在控制台输出中，显示最后一个 CRC，但不显示最后一个“[OK]”...

我从来没有遇到过这种类型的错误，我在谷歌上搜索了几个小时，但在我的情况下没有什么真正有趣的......请帮助:)

* * *

现在我有另一个错误：

```
*** glibc detected *** ./xsplit: free(): invalid next size (normal): 0x095a66f0 ***
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x75ee2)[0xb7647ee2]
/lib/i386-linux-gnu/libc.so.6(fclose+0x154)[0xb7637424]
./xsplit[0x80497f7]
./xsplit[0x804919c]
./xsplit[0x8049cd6]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb75eb4d3]
./xsplit[0x8048961] 
```

这到底是什么 ？我迷路了... ：（

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T04:28:23.123

> `*** glibc detected *** ./crc32: double free or corruption`

Glibc 告诉你你已经损坏了堆。

*在 Linux 上查找此类损坏*的工具是*[Valgrind](http://valgrind.org)和[AddressSanitizer](http://code.google.com/p/address-sanitizer/wiki/AddressSanitizer)。*

 *很有可能，其中任何一个都会立即告诉您您的问题是什么。*

# android - Ondraw调用之间的Android持久性

> ID：14199450
> 
> 赞同：0
> 
> 时间：2013-01-07T15:58:21.963
> 
> 标签：android, canvas, ondraw

在我的 android 应用程序中，我正在绘制一个包含大量数据的图表，我需要绘制数据，然后在其顶部绘制更多数据。与其存储所有数据并在每个 ondraw 调用中重绘，还有什么方法可以在对 ondraw 的调用之间保持持久性，似乎 ondraw 总是希望重新绘制数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:04:14.777

只需在 a 上绘制所有数据`Bitmap`，然后在其中绘制此位图`onDraw()`

# c# - 如何将大数组绑定到小名称？

> ID：14199457
> 
> 赞同：1
> 
> 时间：2013-01-07T15:58:30.170
> 
> 标签：c#, asp.net-mvc

我有课：

`EmployeeListViewModel`与财产`List<Int32> EmployeeIDs`。

我需要通过获取请求进行转移。

我不想看到像`EmployeeIDs[]=1&EmployeeIDs[]=2`...这样的请求

我想指定一个具有此参数短名称的标签

例子：

```
empl[]=1&empl[]=2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:09:18.723

您可以使用属性装饰控制器操作参数[`[Bind]`](http://msdn.microsoft.com/en-us/library/system.web.mvc.bindattribute%28v=vs.108%29.aspx)并指定前缀：

```
public ActionResult Index([Bind(Prefix = "empl[]")] int[] employeeIDs)
{
    ...
} 
```

现在将正确绑定以下请求：

```
empl[]=1&empl[]=2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:26:44.120

听起来您正在使用模型绑定并希望自定义绑定发生的方式。不幸的是，在一个`Model`类上，我不知道如何使用属性来完成此任务，但您可以使用自定义活页夹来完成您想要的。

您需要实现`IModelBinder`接口，然后`[ModelBinder]`在控制器的操作方法上使用属性。

更多详细信息：http: [//dotnetslackers.com/articles/aspnet/Understanding-ASP-NET-MVC-Model-Binding.aspx](http://dotnetslackers.com/articles/aspnet/Understanding-ASP-NET-MVC-Model-Binding.aspx)

# eclipse - Eclipse 为已弃用的方法抛出错误

> ID：14199459
> 
> 赞同：0
> 
> 时间：2013-01-07T15:58:41.600
> 
> 标签：eclipse

我正在尝试在 Eclipse 中安装一个项目，但它会抛出有关不推荐使用的方法的错误。

椭圆首选项是这样的：

```
java, compiler, errors/warnings, deprecated and restricted API, 

Deprecated API                                            Warning
    Signal use of deprecated API inside deprecated code  (unchecked)
    Signal overriding or implementing deprecated method  (unchecked)
Forbidden reference (access rules)                           Error
Discouraged reference (access rules)                     Warning 
```

这些设置是否正确？还是有什么需要在 pom 中更新的？

# c# - 重构此代码以提高性能

> ID：14199460
> 
> 赞同：2
> 
> 时间：2013-01-07T15:58:50.657
> 
> 标签：c#, performance, refactoring

像这样的东西：

**组装（一）：**

```
private void MoveItems(someCollection)
{
   // more code....

   foreach( item x in someCollection)
   {
      int x = getXFoo();
      assemblyB.UpdateOrderView(x)
   }

   //more code....
} 
```

**组装（B）：**

```
private void UpdateOrderView(x)
{
    // more code....

    int y = this.ListCount();

    //......

    FinishDisplay(y)
} 
```

我们调用了`MoveItems()`一个集合和 for-each 循环。因此，如果集合中有 600 个项目，我们也会调用`FinishDisplay()`方法 600 次。但这就是我需要重构的地方。我不需要`FinishDisplay()`每次都为集合中的每个项目调用。如果我能在最后调用一次就足够了。

所以我正在寻找一种方法来重构这段代码，以便`FinishDiplay()`只调用一次。我可以控制源代码，所以如果我需要公开一些方法或创建一些方法的重载，我也可以这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:04:07.543

假设由于某种原因调用`FinishDisplay`必须留在内部，您可以这样做：`UpdateOrderView`

```
private void UpdateOrderView(Whatever x, bool doDisplay)
{
    // more code....

    int y = this.ListCount();

    //......

    if (doDisplay) FinishDisplay(y);
} 
```

`foreach`如果不是，为什么不将它与它自己的方法分开并在评论中提到的类似之后调用它一次？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T16:05:15.650

您可能想`FinishDisplay` `public`在消费者中制作和调用它，而不是`UpdateOrderView`. 如果您需要更通用或显式的接口，您可以实现类似 Windows 窗体[`Control.SuspendLayout`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.suspendlayout.aspx)和`Control.ResumeLayout`方法的模式：

```
private bool autoFinish = true;

public void SuspendAutoFinish() { this.autoFinish = false; }
public void ResumeAutoFinish() { this.autoFinish = true; FinishDisplay(); }

private void UpdateOrderView() {
  // ...
  if(this.autoFinish) FinishDisplay();
}

// consumer
try {
  myImpl.SuspendAutoFinish();
  myImpl.MoveItems(myCollection);
}
finally {
  myImpl.ResumeAutoFinish();
} 
```

# bash - “Git Bash here”不保留会话之间的 bash 历史记录

> ID：14199462
> 
> 赞同：13
> 
> 时间：2013-01-07T15:59:07.560
> 
> 标签：bash, shell, windows-7, git-bash, msysgit

我在 Windows 7 上运行 Git-1.8.0-preview20121022 并且安装是使用“仅 Git Bash”（对 Windows cmd 的干扰最小）。

当我从开始菜单快捷方式打开 Git Bash 时，历史记录一切正常。

但是，当`Git Bash here`上下文菜单（`git-cheetah`shell 扩展之一或更简单的注册表）是启动会话的内容时，来自该会话的命令不会保存到`.bash_history`.

怎么能弄清楚为什么会这样？或者更好的是，有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-07T16:02:14.733

您应该可以通过将此行添加到您的`~/.bash_profile`

```
PROMPT_COMMAND='history -a' 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-03-17T12:50:51.107

如此处所述：[https ://stackoverflow.com/a/60718848/6680510](https://stackoverflow.com/a/60718848/6680510)

> 创建以下文件
> 
> ```
> ~/.bash_profile
> ~/.bashrc 
> ```
> 
> 并将以下行放入它们中
> 
> `PROMPT_COMMAND='history -a'`
> 
> 要从控制台（git bash）本身执行此操作，请使用以下命令
> 
> ```
> echo "PROMPT_COMMAND='history -a'" >> ~/.bash_profile
> echo "PROMPT_COMMAND='history -a'" >> ~/.bashrc 
> ```
> 
> **什么`history -a`意思**
> 
> 从`history --help`命令
> 
> > -a 将此会话中的历史行追加到历史文件中
> 
> **是什么`PROMPT_COMMAND`？**
> 
> > Bash 提供了一个名为 PROMPT_COMMAND 的环境变量。在 Bash 显示提示之前，此变量的内容作为常规 Bash 命令执行。
> 
> **`.bash_profile`和之间的区别`.bashrc`**
> 
> `.bash_profile`对登录 shell`.bashrc`执行，而对交互式非登录 shell 执行。
> 
> 当您通过控制台登录（输入用户名和密码）时，无论是坐在机器上，还是通过 ssh 远程登录：在初始命令提示符之前执行 .bash_profile 以配置您的 shell。
> 
> 但是，如果您已经登录到您的机器并打开了一个新的终端窗口 (xterm)，那么 .bashrc 会在窗口命令提示符之前执行。当您通过在终端中键入 /bin/bash 来启动新的 bash 实例时，也会运行 .bashrc。
> 
> 在 OS X 上，终端默认每次都会运行一个登录 shell，因此这与大多数其他系统略有不同，但您可以在首选项中进行配置。
> 
> 参考
> 
> [https://www.tldp.org/HOWTO/Bash-Prompt-HOWTO/x264.html](https://www.tldp.org/HOWTO/Bash-Prompt-HOWTO/x264.html) [https://apple.stackexchange.com/questions/51036/what-is-the-difference-between-bash-profile-and -bashrc](https://apple.stackexchange.com/questions/51036/what-is-the-difference-between-bash-profile-and-bashrc)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-02T03:11:31.850

推杆

```
PROMPT_COMMAND='history -a ~/.bash_history' 
```

进入 .bash_profile 为我做了。

# javascript - 在jQuery中单击时如何SlideUp div

> ID：14199465
> 
> 赞同：0
> 
> 时间：2013-01-07T15:59:13.863
> 
> 标签：javascript, jquery, toggle, slideup

我在这里有以下简单的演示：[https](https://tinker.io/8e585/1) ://tinker.io/8e585/1 。*我在下面附上了代码。*

最初，'Test 1' & 'Test 2' 的内容都是关闭的。

但是，单击时，它们会打开。我想要它，如果*当*一个打开然后单击它关闭。因此，**如果打开并单击 = 关闭。**这可能吗？

非常感谢您的帮助:-)

..

**HTML**

```
<div class="grid_4">    
    <h2 style="margin-bottom:4px"><a href="javascript:slideonlyone('newboxes6');" style="color:#455560!important;">Test 1</a></h2>
    <div class="newboxes2" id="newboxes6">
        <p>bla 1</p>
    </div>
</div>

<div class="grid_4">    
    <h2 style="margin-bottom:4px"><a href="javascript:slideonlyone('newboxes7');" style="color:#455560!important;">Test 2</a></h2>
    <div class="newboxes2" id="newboxes7">
        <p>bla 2</p>
    </div>
</div> 
```

**CSS**

```
.newboxes2 {display:none} 
```

**jQuery**

```
function slideonlyone(thechosenone) {
     $('.newboxes2').each(function(index) {
          if ($(this).attr("id") == thechosenone) {
                jQuery(this).parent('.grid_4').children().find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_onstate.png');
               $(this).slideDown(200);
          }
          else {
                jQuery(this).parent('.grid_4').children().find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_offstate.png');
               $(this).slideUp(600);
          }
     });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:18:08.120

一切都应该比你想象的容易得多。你应该删除你的内联 javascript 事件处理程序。并使用 jquery-toggle-mechanism：

那么您的 javascript 代码可能会变得如此短：

```
$('.grid_4').bind('click', function () {
  $(this).find('.newboxes2').slideToggle(200);
}); 
```

请参阅更新的修补程序以获取示例：[https ://tinker.io/8e585/4](https://tinker.io/8e585/4)

如果您希望您的 slideDown 比您的 slideUp (600) 更快 (200)，您可以查找当前显示属性：

```
var duration, $newboxes2;
$('.grid_4').bind('click', function () {
  $newboxes2 = $(this).find('.newboxes2');
  duration = $newboxes2.css('display') === 'none' ? 200 : 600;
  $(this).find('.newboxes2').slideToggle(duration);
}); 
```

修补匠在这里工作：[https ://tinker.io/8e585/5](https://tinker.io/8e585/5)

与您的图像交换代码。这段代码甚至可以短 1 到 2 行（if-else），但我还是这样写的，以便您更容易阅读：

```
var duration, $newboxes2, imgSrc, imgBase = '/wp-content/themes/boilerplate/images/';

$('.grid_4').bind('click', function () {
  $newboxes2 = $(this).find('.newboxes2');
  if ($newboxes2.css('display') === 'none') {
    duration = 200;
    imgSrc = imgBase + 'image_corner_btn_onstate.png';
  } else {
    duration = 600;
    imgSrc = imgBase + 'image_corner_btn_offstate.png';
  }
  $(this).find('img.small').attr('src', imgSrc);
  $(this).find('.newboxes2').slideToggle(duration);
}); 
```

见修补匠：[https ://tinker.io/8e585/13](https://tinker.io/8e585/13)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:10:35.640

你可以简单地使用一个类来做到这一点：

[https://tinker.io/8e585/12](https://tinker.io/8e585/12)

```
function slideonlyone(thechosenone) {
     $('.newboxes2').each(function(index) {
          if (this.id == thechosenone) {
                if($(this).is('.active') )
                   $(this).removeClass('active').slideUp(600);
              else 
              $(this).addClass('active').slideDown(200);
          }
          else              
               $(this).removeClass('active').slideUp(600);

         if($(this).is('.active') )
             jQuery(this).parent('.grid_4').children().find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_onstate.png');
         else
             jQuery(this).parent('.grid_4').children().find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_offstate.png');
     });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T17:10:54.590

听起来您想要一个手风琴： http: [//jqueryui.com/accordion/](http://jqueryui.com/accordion/)或者，您可以使用下面的 Javascript（删除 HTML 中的内联 Javascript，只使用“#”）：

```
(function($) {
$(function() {
  var links =  $('.grid_4 h2:first-child a');
  links.addClass('closed');
  links.click(function() {    
   var $this = $(this);

   links.each(function() {
     var curLink = $(this);
     if(curLink !== $this) {
       curLink.parents('.grid_4').find('.newboxes2').slideUp(600, function({curLink.addClass('closed');});
       curLink.parents('.grid_4').find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_offstate.png');
        }
  });

    if($this.hasClass('closed')) {
        $this.parents('.grid_4').find('.newboxes2').slideDown(200, function() {$this.removeClass('closed');});
        $this.parents('.grid_4').find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_onstate.png');
    } else {
        $this.parents('.grid_4').find('.newboxes2').slideUp(600, function() {$this.addClass('closed');});
        $this.parents('.grid_4').find('img.small').attr('src', '/wp-content/themes/boilerplate/images/image_corner_btn_offstate.png');
    }

});
});
})(jQuery); 
```

# java - JBoss Application Server：从另一台机器访问已部署的 Web 应用程序

> ID：14199474
> 
> 赞同：3
> 
> 时间：2013-01-07T15:59:29.363
> 
> 标签：java, networking, jboss, java-ee-6, jboss7.x

我已将 Web 应用程序部署到`Jboss`独立应用程序服务器版本 7.1.1。

但由于某种原因，我无法从同一网络中的另一台机器访问该应用程序。服务器在端口 18080 上运行。

我已经在同一台机器上运行的tomcat服务器上部署了相同的应用程序，我可以在其他机器上远程访问它。tomcat的端口号：8080

为了验证端口号是否有问题，我只是在tomcat 18080和`Jboss`8080之间交换了端口号，我可以从tomcat访问应用程序但`Jboss`无法访问。因此端口号没有问题。

我查看了一些`Jboss`服务器`standalone.xml`文件并尝试将`socketBinding`元素的接口属性更改为公共，仍然没有用。

```
socket-binding name="http" interface="public" port="18080"
```

谁能告诉我需要做哪些更改才能远程访问部署在 Jboss 上的这些 Web 应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T19:25:41.183

或者，您也可以使用带有 -b 修饰符的 JBoss 启动脚本定义公共接口 IP 绑定。例如：

要绑定到特定 IP：

```
./standalone.sh -b xxx.xxx.xxx.xxx 
```

要绑定到所有 IP：

```
./standalone.sh -b 0.0.0.0 
```

默认行为仅绑定到 localhost (127.0.0.1)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-14T07:09:39.867

在您的standalone.xml 中进行以下更改。

```
<interfaces>
    <interface name="management">
        <inet-address value="${jboss.bind.address.management:127.0.0.1}"/>
    </interface>
    <interface name="public">
        <any-ipv4-address/>
    </interface>
    <interface name="unsecure">
        <inet-address value="${jboss.bind.address.unsecure:127.0.0.1}"/>
    </interface>
</interfaces> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:07:24.167

我得到了问题的解决方案，我确实忽略了standalone.xml，所以匆忙发布了一个问题。无论如何，这对其他人来说真的很有帮助。

要使 jboss 服务器资源远程可用，首先我们需要将**interface**属性添加到**soket-binding**元素，如下所示：

```
<socket-binding name="http" interface="public" port="18080"/>
<socket-binding name="https" interface="public" port="18443"/> 
```

第 2 步：使用 inet-address 修改接口以具有正确的 IP 地址。XXX.XXX.XXX.XXX 如下代码片段所示

```
<interfaces>
        <interface name="management">
            <inet-address value="${jboss.bind.address.management:xxx.xxx.xxx.xxx}"/>
        </interface>
        <interface name="public">
            <inet-address value="${jboss.bind.address:xxx.xxx.xxx.xxx}"/>
        </interface>
        <interface name="unsecure">
            <inet-address value="${jboss.bind.address.unsecure:xxx.xxx.xxx.xxx}"/>
        </interface>
    </interfaces> 
```

# .net - ASP.NET MVC 2 列表 模型验证

> ID：14199475
> 
> 赞同：1
> 
> 时间：2013-01-07T15:59:30.560
> 
> 标签：.net, validation, asp.net-mvc-2, data-annotations, asp.net-mvc-validation

我正在开发 MVC 2 应用程序，但遇到了问题。我的代码如下所示：

```
public ActionResult Users()
        {
            try
            {
                var model = new List<User>
                                {
                                    new User
                                        {
                                            Name = "Test",
                                            UserID = 1,
                                            Salary = 1000m
                                        }
                                };
                return View(model);
            }
            catch (Exception ex)
            {
                //Log exception
                return View("ErrorPage");
            }
        }

        [HttpPost]
        public ActionResult Users(IEnumerable<User> users)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    return RedirectToAction("Index");
                }

                return View(users);
            }
            catch (Exception ex)
            {
                //Log exception
                return View("ErrorPage");
            }
        } 
```

和类用户

```
public class User
    {
        [Required]
        public string Name{ get; set; }

        [Required]
        public int UserID{ get; set; }

        [Required]
        public decimal Salary{ get; set; }
    } 
```

我想创建自定义属性（DataAnnototation）来验证 IEnumerable 用户在发布表单时的工资总和是否小于 10000？我可以在这里做吗，因为我的模型是列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:01:55.530

数据注释不能跨集合操作。

相反，您需要在操作中手动验证。

然后您可以调用`ModelState.AddModelError()`.

# oracle - 从双重返回单个字符中选择“字符串”

> ID：14199476
> 
> 赞同：0
> 
> 时间：2013-01-07T15:59:34.857
> 
> 标签：oracle, hibernate, groovy

我有一个非常简单的 Groovy 类，我只是想通过 Hibernate 3.3.2 GA 使用本机 SQL 查询从 Oracle 11g 数据库中选择一个字符串。它看起来很简单，但我无法理解我得到的结果。这是代码：

```
package serialize

import org.hibernate.cfg.Configuration
import org.hibernate.transform.ToListResultTransformer

class SerializeDatabaseObjects {

    static main(args) {

        def sessionFactory = initHibernate()

        def session = sessionFactory.openSession()

        def tx
        def result

        try {
            tx = session.beginTransaction()

             result = session
                .createSQLQuery("""Select 'Hello World!' from dual""")
                .setResultTransformer(ToListResultTransformer.INSTANCE) 
                .list()

            tx.commit()
        }
        catch (Exception e) {
            if (tx!=null){ 
                tx.rollback() 
            }
            throw e
        }
        finally {
            session.close()
        }

        println result

        sessionFactory.close()
    }

    static initHibernate(){
        return new Configuration().configure().setProperty("hibernate.show_sql", "true").buildSessionFactory()
    }
} 
```

输出：

```
Hibernate: Select 'Hello World!' from dual
[[H]] 
```

ToListResultTransformer 是我最近一次尝试让整个`'Hello World!'`字符串被打印但不应该需要 IMO。但无论我尝试什么，“H”总是结果。

如何获取要返回的整个“Hello World”字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:59:34.857

当我输入这个问题时，我想出了答案。似乎 Hibernate 将结果解释为字符而不是字符串，因此只返回“H”。

我发现解决此问题的方法是在 select 语句中添加列别名，然后使用[addScalar(String columnAlias, Type type)](http://docs.jboss.org/hibernate/orm/3.3/api/org/hibernate/SQLQuery.html#addScalar%28java.lang.String,%20org.hibernate.type.Type%29)指定结果应解释为字符串。

同样，我使用了 ResultTransformer( [AliasToEntityMapResultTransformer](http://docs.jboss.org/hibernate/orm/3.3/api/org/hibernate/transform/AliasToEntityMapResultTransformer.html) )，因此我的结果将包含列名及其内容，但这不是绝对必要的。

如果有人想详细说明 Hibernate 将结果映射为字符而不是字符串的原因，或者建议另一种（更简单）的方式将结果强制为字符串，请发表评论或发布答案。

这是产生预期结果的代码：

```
package serialize

import org.hibernate.cfg.Configuration
import org.hibernate.transform.AliasToEntityMapResultTransformer
import org.hibernate.type.StringType

class SerializeDatabaseObjects {

    static main(args) {

        def sessionFactory = initHibernate()

        def session = sessionFactory.openSession()

        def tx
        def result

        try {
            tx = session.beginTransaction()

             result = session
                .createSQLQuery("""Select 'Hello World!' as hello from dual""")
                .addScalar("hello", new StringType())
                .setResultTransformer(AliasToEntityMapResultTransformer.INSTANCE)
                .list()

            tx.commit()
        }
        catch (Exception e) {
            if (tx!=null){ 
                tx.rollback() 
            }
            throw e
        }
        finally {
            session.close()
        }

        println result

        sessionFactory.close()
    }

    static initHibernate(){
        return new Configuration().configure().setProperty("hibernate.show_sql", "true").buildSessionFactory()
    }
} 
```

和输出：

```
Hibernate: Select 'Hello World!' as hello from dual
[[hello:Hello World!]] 
```

# selenium - Selenium Webdriver - 验证条形图部分（条形）的工具提示中的值

> ID：14199479
> 
> 赞同：2
> 
> 时间：2013-01-07T15:59:46.530
> 
> 标签：selenium, webdriver, selenium-webdriver

我需要从条形图中验证边距（总和）元素的值，如下所示。那么如何从条形图中伊莱克斯供应商（条 1）的边距（总和）工具提示中提取值 31732？

[![条形图工具提示](../Images/24b5d19d67be226186ea558276ace441.png)](https://i.stack.imgur.com/CIgIW.png)

下面还给出了包含此值的 div 的 html。

我将不胜感激任何帮助指出我正确的方向。

提前致谢。

```
<div id="highcharts-60" class="highcharts-container" style="position: relative; overflow: hidden; width: 727px; height: 378px; text-align: left; font-family: "Lucida Grande","Lucida Sans Unicode",Verdana,Arial,Helvetica,sans-serif; font-size: 12px; left: 0px; top: -0.600006px;">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="727" height="378">
<defs>
<rect rx="5" ry="5" fill="#FFFFFF" x="0" y="0" width="727" height="378" stroke-width="0" stroke="#4572A7">
<text class="highcharts-title" x="364" y="25" style="font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif;font-size:10px;color:#3E576F;fill:#3E576F;" text-anchor="middle" zIndex="1">
<g class="highcharts-grid" zIndex="1">
<g class="highcharts-grid" zIndex="1">
<path d="M 106.5 40 L 106.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 147.5 40 L 147.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 187.5 40 L 187.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 228.5 40 L 228.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 269.5 40 L 269.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 310.5 40 L 310.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 350.5 40 L 350.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 391.5 40 L 391.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 432.5 40 L 432.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 473.5 40 L 473.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 513.5 40 L 513.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 554.5 40 L 554.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 595.5 40 L 595.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 636.5 40 L 636.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 676.5 40 L 676.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
<path d="M 717.5 40 L 717.5 291" fill="none" stroke="#C0C0C0" stroke-width="1">
</g>
<g class="highcharts-series-group" zIndex="3">
<g class="highcharts-series" width="611" height="251" transform="translate(717,291) rotate(90) scale(-1,1)" clip-path="url(https://staging.datarpm.com/analytics/4fbf89e5e4b0a97336652433#highcharts-61)" visibility="visible">
<rect rx="0" ry="0" fill="none" x="220.5" y="352.5" width="18" height="258" stroke-width="5" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.05" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="220.5" y="352.5" width="18" height="258" stroke-width="3" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.1" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="220.5" y="352.5" width="18" height="258" stroke-width="1" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.15000000000000002" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="#4572A7" x="220.5" y="352.5" width="18" height="258" stroke-width="1" stroke="#FFFFFF" r="0" fill-opacity="1">
<rect rx="0" ry="0" fill="none" x="178.5" y="319.5" width="18" height="291" stroke-width="5" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.05" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="178.5" y="319.5" width="18" height="291" stroke-width="3" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.1" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="178.5" y="319.5" width="18" height="291" stroke-width="1" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.15000000000000002" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="#4572A7" x="178.5" y="319.5" width="18" height="291" stroke-width="1" stroke="#FFFFFF" r="0" fill-opacity="1">
<rect rx="0" ry="0" fill="none" x="136.5" y="293.5" width="18" height="317" stroke-width="5" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.05" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="136.5" y="293.5" width="18" height="317" stroke-width="3" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.1" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="136.5" y="293.5" width="18" height="317" stroke-width="1" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.15000000000000002" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="#4572A7" x="136.5" y="293.5" width="18" height="317" stroke-width="1" stroke="#FFFFFF" r="0" fill-opacity="1">
<rect rx="0" ry="0" fill="none" x="94.5" y="62.5" width="18" height="548" stroke-width="5" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.05" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="94.5" y="62.5" width="18" height="548" stroke-width="3" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.1" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="94.5" y="62.5" width="18" height="548" stroke-width="1" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.15000000000000002" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="#4572A7" x="94.5" y="62.5" width="18" height="548" stroke-width="1" stroke="#FFFFFF" r="0">
<rect rx="0" ry="0" fill="none" x="52.5" y="257.5" width="18" height="353" stroke-width="5" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.05" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="52.5" y="257.5" width="18" height="353" stroke-width="3" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.1" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="52.5" y="257.5" width="18" height="353" stroke-width="1" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.15000000000000002" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="#4572A7" x="52.5" y="257.5" width="18" height="353" stroke-width="1" stroke="#FFFFFF" r="0">
<rect rx="0" ry="0" fill="none" x="10.5" y="247.5" width="18" height="363" stroke-width="5" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.05" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="10.5" y="247.5" width="18" height="363" stroke-width="3" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.1" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="none" x="10.5" y="247.5" width="18" height="363" stroke-width="1" stroke="rgb(0, 0, 0)" r="0" isShadow="true" stroke-opacity="0.15000000000000002" transform="translate(-1,-1)">
<rect rx="0" ry="0" fill="#4572A7" x="10.5" y="247.5" width="18" height="363" stroke-width="1" stroke="#FFFFFF" r="0">
</g>
</g>
<g class="highcharts-legend" zIndex="7" transform="translate(298,337)">
<rect rx="5" ry="5" fill="none" x="0.5" y="0.5" width="130" height="25" stroke-width="1" stroke="#909090" visibility="visible">
<text x="30" y="18" style="font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif;font-size:12px;cursor:pointer;color:#3E576F;fill:#3E576F;" zIndex="2">
<tspan x="30"> margin (sum)</tspan>
</text>
<rect rx="2" ry="2" fill="#4572A7" x="9.5" y="7.5" width="16" height="12" stroke-width="1" zIndex="3" stroke="#FFFFFF" r="0">
</g>
<g class="highcharts-axis" zIndex="7">
<text x="26" y="165.5" style="font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#6D869F;font-weight:bold;fill:#6D869F;" zIndex="7" transform="rotate(270 26 165)" text-anchor="middle">
<g class="highcharts-axis" zIndex="7">
<text x="411.5" y="323" style="font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#6D869F;font-weight:bold;fill:#6D869F;" zIndex="7" text-anchor="middle">
<tspan x="411.5"> margin (sum)</tspan>
</text>
<path d="M 106.5 40 L 106.5 291" fill="none" stroke="#C0D0E0" stroke-width="1" zIndex="7">
<g class="highcharts-tooltip" zIndex="8" visibility="hidden" transform="translate(202.5577832333554,26.04093567342961)">
<rect rx="5" ry="5" fill="none" x="7" y="7" width="131" height="38" stroke-width="5" fill-opacity="0.85" isShadow="true" stroke="rgb(0, 0, 0)" stroke-opacity="0.05" transform="translate(1,1)">
<rect rx="5" ry="5" fill="none" x="7" y="7" width="131" height="38" stroke-width="3" fill-opacity="0.85" isShadow="true" stroke="rgb(0, 0, 0)" stroke-opacity="0.1" transform="translate(1,1)">
<rect rx="5" ry="5" fill="none" x="7" y="7" width="131" height="38" stroke-width="1" fill-opacity="0.85" isShadow="true" stroke="rgb(0, 0, 0)" stroke-opacity="0.15000000000000002" transform="translate(1,1)">
<rect rx="5" ry="5" fill="rgb(255,255,255)" x="7" y="7" width="131" height="38" stroke-width="2" fill-opacity="0.85" stroke="#4572A7">
<text x="12" y="24" style="font-family:"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#333333;padding:0;white-space:nowrap;fill:#333333;" zIndex="1">
<tspan style="text-decoration: underline; font-weight: bold;" x="12">Electrolux</tspan>
<tspan style="font-weight:bold" dy="13" x="12"> margin (sum)</tspan>
<tspan dx="3"> : 31732</tspan>
</text>
</g>
<g class="highcharts-tracker" zIndex="9" transform="translate(717,291) rotate(90) scale(-1,1)" width="611" height="251">
<rect rx="3" ry="3" fill="url(https://staging.datarpm.com/analytics/4fbf89e5e4b0a97336652433#highcharts-62)" x="0.5" y="0.5" width="23" height="19" stroke-width="1" transform="translate(693,348)" zIndex="19" stroke="#B0B0B0">
<rect rx="3" ry="3" fill="url(https://staging.datarpm.com/analytics/4fbf89e5e4b0a97336652433#highcharts-63)" x="0.5" y="0.5" width="23" height="19" stroke-width="1" transform="translate(693,328)" zIndex="19" stroke="#B0B0B0">
<path d="M 6 17 L 18 17 18 14 6 14 Z M 12 14 L 9 9 11 9 11 5 13 5 13 9 15 9 Z" fill="#A8BF77" transform="translate(693,348)" stroke="#A0A0A0" stroke-width="1" zIndex="20">
<path d="M 6 14 L 18 14 18 9 6 9 Z M 9 9 L 9 5 15 5 15 9 Z M 9 14 L 7.5 17 16.5 17 15 14 Z" fill="#B5C9DF" transform="translate(693,328)" stroke="#A0A0A0" stroke-width="1" zIndex="20">
<rect rx="0" ry="0" fill="rgb(255,255,255)" x="693" y="348" width="24" height="20" stroke-width="0" fill-opacity="0.001" title="Export to raster or vector image" zIndex="21" style="cursor:pointer;">
<rect rx="0" ry="0" fill="rgb(255,255,255)" x="693" y="328" width="24" height="20" stroke-width="0" fill-opacity="0.001" title="Print the chart" zIndex="21" style="cursor:pointer;">
</svg>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:08:37.720

我认为，这不是在测试`highcharts`自己，而只是将正确的数据传递给它。因为测试数据是否正确可视化将是`highcharts`'s 的责任。

如果在 JavaScript 中图表已被分配给变量（例如`var chart = new Highcharts.Chart({ ... })`），那么您可以尝试通过调用[highcharts 系列数据 api来获取数据](http://api.highcharts.com/highcharts#Series.data)

```
int[] data = js.executeScript("return chart.series.data;"); 
```

如果这不起作用，那么您可以随时从 html 中提取数据，如下所示：

```
//get the element that contains the data
WebElement currentValueElement = driver.findElement(By.xpath('//*[@class="highcharts-tooltip"]//text/tspan[last()]'));

//get the value from that element
int currentvalue = Integer.parseInt(currentValueElement.split(":")[1].trim()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T16:08:18.973

据我所知，工具提示可能是一个动态的 Javascript 弹出窗口，就像您在一些下拉菜单中看到的那样，例如 Google 搜索提示。您是唯一可以访问完整源代码（HTML 标头）的人，因此只有您可以为我们解决这个问题。在这种情况下，如果你很绝望，你可以使用物理鼠标单击（使用 Webdriver Action 类）结合轻微的延迟和一些击键来选择和复制（使用 ctrl-c ），然后使用 java.awt 访问剪贴板.Toolkit 获取值然后处理它。这只是我的想法。

可能有比我上面建议的更好的方法来做到这一点。或者，DOM 很可能可以访问该工具提示的值（您可以在其中使用 cssSelector 来获取）但无法使用 Firebug 访问您的页面（使用 Firefinder 插件），这很难说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T18:26:59.233

您是否尝试使用此 xpath 并从中获取文本？

```
"//tspan[@dx='3']" 
```

# javascript - 只有一个类名附加到锚标记的 href 末尾？

> ID：14199483
> 
> 赞同：0
> 
> 时间：2013-01-07T15:59:58.783
> 
> 标签：javascript, jquery, class, anchor

```
var myClass;

jQuery(".option-set a").click(function() {
myClass = jQuery(this).attr("class");

jQuery("a.perma").each(function() {
    var _href = jQuery(this).attr("href"); 
    jQuery(this).attr("href", _href + "#filter=." + myClass);
});
}); 
```

我使用此代码将过滤器的类名附加到每个缩略图的永久链接的[末尾](http://427design.com/newsite/our-work/)

我现在遇到的问题是，每次点击时，类都会被分配到永久链接的末尾，所以如果我点击打印然后点击网页，那么摄影永久链接的 url 将显示为：/#filter=.print#filter= .web#filter=.photography 仍然有效，但是如果为了整洁只显示最后一个，那就太好了。

此外，一旦单击缩略图并加载下一页，我需要缩略图来维护所选过滤器的当前永久链接。任何想法，将不胜感激。我似乎无法弄清楚这一点。我真的很感激帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:06:42.683

只调用一次，而不是每次点击...

```
jQuery(document).ready(function() {
    myClass = jQuery('.option-set a').attr("class");

    jQuery("a.perma").each(function() {
        var _href = jQuery(this).attr("href"); 
        jQuery(this).attr("href", _href + "#filter=." + myClass);
    });

    jQuery(".option-set a").click(function() {...});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:06:16.240

此修改应检查当前类过滤器是否不存在。

```
jQuery("a.perma").each(function() {
  var _href = jQuery(this).attr("href"),
      newHref = _href.indexOf(myClass) === -1 ? _href + "#filter=." + myClass : _href;
    jQuery(this).attr("href", newHref);
  });
}); 
```

并且要在下一页加载时维护过滤后的缩略图 url，您需要使用服务器并解析它传递的参数，或者使用[Web 存储](http://www.html5rocks.com/en/features/storage)来保存当前过滤后的路径并在文档加载时相应地设置缩略图 href。

# python - Python - 在 for in 语句中使用字符串？

> ID：14199484
> 
> 赞同：1
> 
> 时间：2013-01-07T16:00:02.797
> 
> 标签：python, string, for-loop, expression

所以我知道这是一种解决方法，并且可能有更好的方法来做到这一点，但这是交易。我已经简化了从哪里收集这些信息的代码，并且只是给出了可靠的值。

```
curSel = nuke.selectedNodes()
knobToChange = "label"
codeIn = "[value in]"

kcPrefix = "x"
kcStart = "['"
kcEnd = "']"

changerString = kcPrefix+kcStart+knobToChange+kcEnd

for x in curSel:
    changerString.setValue(codeIn) 
```

但我得到了我想我会的错误 - 这是一个字符串没有属性“setValue”

这是因为如果我只输入 x['label'] 而不是 changerString，它就可以工作，但即使 changer string 说的完全相同，它也会被读取为字符串而不是代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:06:10.377

看起来您正在寻找一些东西来根据您当前的命名空间将字符串评估为 python 对象。一种方法是使用`globals`字典：

```
globals()['x']['label'].setValue(...) 
```

换句话说，和`globals()['x']['label']`是一样的`x['label']`。

或者为您的情况明确说明：

```
globals()[kcPrefix][knobToChange].setValue(codeIn) 
```

* * *

其他人可能会建议`eval`：

```
eval('x["label"]').setValue(...)  #insecure and inefficient 
```

但`globals`在这里绝对是一个更好的主意。

* * *

最后，通常当你想做这样的事情时，你最好首先使用字典或其他类型的数据结构来让你的数据更有条理

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:23:34.220

Righto，有两件事你正在犯规。首先，在您尝试对字符串执行 setValue() 调用的原始代码中，您是对的，因为它不起作用。理想情况下使用两个调用之一（`x.knob('name_of_the_knob')`或`x['name_of_the_knob']`，与您的项目/设施/个人风格一致）来获取和设置旋钮对象的值。

从评论中，您的代码看起来像这样（我的评论是为其他不太熟悉 Nuke 的人添加的）：

```
# select all the nodes
curSel = nuke.selectedNodes() 

# nuke.thisNode() returns the script's context 
# i.e. the node from which the script was invoked
knobToChange = nuke.thisNode()['knobname'].getValue() 
codeIn = nuke.thisNode()['codeinput'].getValue() 

for x in curSel: 
    x.knob(knobToChange).setValue(codeIn) 
```

使用此示例 UI 和两个字段中的值，如图所示，按钮触发脚本...

![带有相关按钮的示例 UI](../Images/dd65be55481b2e682c91293188955ed2.png)

...此代码将在您执行它时给您一条错误消息'Nothing is named "foo"'，因为`.getValue()`调用实际上是返回给您旋钮的*评估结果*- 这是它尝试执行时的错误消息TCL [value foo]，并发现没有任何名为 foo 的对象。

理想情况下，您应该做的是调用**`.toScript()`**返回原始文本的方法。

```
# select all the nodes
curSel = nuke.selectedNodes() 

# nuke.thisNode() returns the script's context 
# i.e. the node from which the script was invoked
knobToChange = nuke.thisNode()['knobname'].toScript() 
codeIn = nuke.thisNode()['codeinput'].toScript() 

for x in curSel: 
    x.knob(knobToChange).setValue(codeIn) 
```

您可以通过根据原始代码构建一个字符串、添加方括号等来回避这个问题，但是是的，这是一个痛苦，一个维护噩梦，并开始沿着构建对象的路线走下去来自字符串（@mgilson 解释了如何在 a `globals()`or`eval()`方法中进行操作）

* * *

对于那些没有享受过使用 Nuke 的乐趣的人，这里有一个小屏幕截图，可能（或可能不......）提供更多背景信息：

![来自 Nuke 的示例屏幕，显示节点图和属性对话框](../Images/670ff1ef03a74c0da743f1159c14d569.png)

# c - 如何在 C 中没有换行符的情况下刺激 EOF

> ID：14199485
> 
> 赞同：1
> 
> 时间：2013-01-07T16:00:05.770
> 
> 标签：c, eof

假设我有以下 C 代码：

```
int getLine (char line[])
{
    int c, i=0;
    while( (c=getchar()) != EOF )
           line[i++]=c;
    line[i++] = c;
    return i;
}

>> Enter: 007
>> ^Z
>> Output: 
```

如果我们仔细观察我上面给出输出的方式，我是`Enter`在刺激 EOF 之前按下的。这意味着，字符串的长度是 4 而不是 3（不包括 EOF）。

当我做我的练习时，我真的面临着额外的 \n 一些麻烦。

如何在没有换行符的情况下刺激 EOF？有可能吗？

```
>> Enter: 007^Z
>> ^Z
>> Output: length=6 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:14:42.630

将我的评论转换为答案：

> 在哪个平台上？在 Unix 和衍生产品上，您会键入两次 EOF '字符'——但通常`control-D`不是`control-Z`. 这也可能适用于 Windows；我不知道，但值得一试。

（回复评论确认平台是 Windows。）

> 在 Unix 上，`control-D`使该行上的数据对程序可用。第一个`control-D`给它你已经输入的内容；第二个给它零字节读取，这是EOF的指示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:03:01.177

然后避免在循环中存储换行符。并不是说您被迫存储所有字符而不管其价值如何。:)

此外，您没有正确终止字符串。这个：

```
line[i++] = c; 
```

应该：

```
line[i] = '\0'; 
```

当然，它对缓冲区溢出很敏感。

一般来说，你最好使用`fgets()`.

**编辑**：我可能错过了重点，但似乎整个焦点`EOF`都在......被误导了，如果你只想读一行。行通常不以 结尾`EOF`，而是以`\n`. 因此，该函数可能应该只存储字符，直到遇到或*。* `EOF``\n`

# jsf-2 - 带有 Ajax 的 HtmlInputText（在支持 bean 中创建 inputtext）

> ID：14199486
> 
> 赞同：0
> 
> 时间：2013-01-07T16:00:08.943
> 
> 标签：jsf-2

由于非常动态的需求，需要在支持 bean 中创建一个表。我已经成功地做到了。

**这就是我尝试将 Ajax 添加到我的 inputText 的方式：**

```
HtmlInputText inputText = new HtmlInputText();
// add value and other ValueExpressions
AjaxBehavior ajaxBehavior = new AjaxBehavior();
ajaxBehavior.addAjaxBehaviorListener( new AjaxBehaviorListenerImpl());
inputText.addClientBehavior("focus", ajaxBehavior);
column.getChildren().add(inputText); 
```

**我的监听器实现：**

```
public class AjaxBehaviorListenerImpl implements AjaxBehaviorListener {
    public void processAjaxBehavior(AjaxBehaviorEvent event) throws AbortProcessingException {

        System.out.println("It works");
    }
} 
```

我遇到的问题是没有触发 ajax 事件。古老的“什么都没有发生”。我尝试使用“onfocus”代替，结果相同，还尝试了其他事件，如模糊。

当我调试源时，它看起来不包括在内：

```
<HtmlInputText disabled="false" id="j_id1" immediate="false" inView="true" localValueSet="false" maxlength="-2147483648" readonly="false" rendered="true" required="false" size="-2147483648" transient="false" valid="true" value=""/> 
```

也尝试了这个的要点，但它是一样的。

[http://www.wobblycogs.co.uk/index.php/computing/jee/71-programatically-adding-ajax-actions-to-uicomponents](http://www.wobblycogs.co.uk/index.php/computing/jee/71-programatically-adding-ajax-actions-to-uicomponents)

使用 JSF-2、Tomcat 7、Servlet 3.0 Mojarra 2.1.9

感谢帮助

干杯

# c# - 在 gridview 中仅显示 10 条记录

> ID：14199490
> 
> 赞同：0
> 
> 时间：2013-01-07T16:00:24.170
> 
> 标签：c#, jquery, asp.net, linq, gridview

我正在使用 ASP.net，并且我有一个从 Linq 获取数据的 gridview。我只需要显示 10 条记录（前 10 条记录）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:02:32.697

您可以使用 take 方法：

```
(from q in context.Results
select q).Take(10) 
```

您还可以跳过以跳过一些以前的记录：

```
(from q in context.Results
select q).Skip(10).Take(10) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:02:42.313

您可以使用[**Enumerable.Take**](http://msdn.microsoft.com/en-us/library/bb503062.aspx)[`PageSize`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.pagesize.aspx)从一组gridview 页面的查询中获取前十条记录。您也不会设置`AllowPaging`为 true 以影响 PageSize。

使用 linQ

```
context.YourTable.Take(10); 
```

设置gridview的大小

```
gridView1.PageSize = 10; 
```

# javascript - BootstrapX 弹出框和关闭按钮

> ID：14199499
> 
> 赞同：0
> 
> 时间：2013-01-07T16:00:47.510
> 
> 标签：javascript, jquery, twitter-bootstrap, popover

我正在使用基于 Twitter Bootstrap v2.1.1 的模板开发 Joomla 2.5 站点。

我还在使用 BootstrapX - clickover，这是一个 Bootstrap 扩展，允许通过单击元素而不是悬停或聚焦来打开和关闭弹出框：[https](https://github.com/lecar-red/bootstrapx-clickover) ://github.com/lecar-red/bootstrapx-clickover 。

在弹出窗口中，我使用简单的 AJAX 货币转换器调用 HTML 文件。

这是使用货币转换器触发弹出窗口的 HTML：

```
<a class="pretvornik withajaxpopover" href="#" rel="clickover" title="Pretvornik valut" data-load="http://www.cheaperandmore.com/files/static_converter.html">Click here</a> 
```

这是 HTML 文件的内容 (http://www.cheaperandmore.com/files/static_converter.html)：

```
<p>V okence vpišite znesek v britanskih funtih, ki ga želite preračunati v eure.</p>
<div id="currencyBox">
    <div class="currencyInner">
        <div class="data">
            <input type="text" name="znesek" id="znesek" value="1" /><span id="gbpsign">&pound;</span>
        </div>
        <div class="data">
            <select name="fromCurrency" id="fromCurrency">
                <option selected="" value="GBP">GBP</option>
            </select>
        </div>
        <div class="data">
            <select name="toCurrency" id="toCurrency">
                <option value="EUR">EUR</option>
            </select>
        </div>
    </div>

    <div style="currencyInner" id="calcresults"></div>

    <div class="clr">&nbsp;</div>

    <div class="data">
        <input class="btn btn-primary" type="button" name="convert" id="convert" value="Pretvori &raquo;" />
        <button class="btn" class="clickover" data-toggle='button' data-dismiss="clickover">Zapri</button>
    </div>
</div> 
```

这是javascript：

```
<script type="text/javascript">
//Add close button to bootstrap popovers
$('[rel="clickover"]').clickover();

//Load data
$('.withajaxpopover').bind('click',function(){
    var el=$(this);
    $.get(el.attr('data-load'),function(d){
        el.unbind('click').popover({content: d}).popover('show');
    });
});
</script> 
```

现在，当我单击触发弹出框的链接时，会出现两个弹出框。

一个弹出框包含来自 static_converter.html 的内容，但它缺少点击类“弹出框淡入”。隐藏在第一个后面的其他弹出框具有正确的类“弹出框点击淡入”，但除了取自 a.pretvornik.withajaxpower 标题标签的标题外，它没有其他内容。

因此，当我在第一个弹出窗口中单击关闭按钮时，它实际上关闭了第二个弹出窗口（因为它具有 clickover 类）。我不知道我在做什么错。

您可以在此处查看：http: [//www.cheaperandmore.com](http://www.cheaperandmore.com)（单击页面左上角第一个半圆中的“£ » €”）。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T19:56:53.027

`.clickover()`该插件似乎继承自 Twitter Bootstrap popover 插件：这意味着如果您调用`.popover()`（或者相反），则不需要调用。

你应该试试

```
<script type="text/javascript">

//Load data and bind clickover
$('.withajaxpopover').on('click.ajaxload',function(){
    var el=$(this);
    $.get(el.attr('data-load'),function(d){
        el.off('click.ajaxload').clickover({content: d}).clickover('show');
    });
});
</script> 
```

我冒昧地更改`bind`and `unbind`to `on`and`off`因为它是[自 1.7 以来的首选](http://api.jquery.com/bind/)。

我还添加了一个[事件名称](http://api.jquery.com/on/#event-names) `click.ajaxload`以避免冲突，但您应该考虑一下，[`.one()`](http://api.jquery.com/one/)因为它会为您解除绑定。

* * *

如果您的 clickover 没有 ajax 加载部分，您应该制作两个单独的选择器并在每个上以不同的方式启用 clickover 插件。

例如，您可以删除元素`rel="clickover"`上的属性`.withajaxpopover`，并保留`$('[rel="clickover"]').clickover();`上面的代码。

# c# - 在 DataGridView 之间拖放

> ID：14199510
> 
> 赞同：2
> 
> 时间：2013-01-07T16:01:06.163
> 
> 标签：c#, winforms, datagridview, drag-and-drop

我复制了一些代码并对其进行了修改以适合我的应用程序。我将继续调整和清理代码，直到我满意为止。但是我遇到了一个小错误。我有两个 datagridviews 并希望将 datagridrows 从一个移动到另一个。但是，当`drag&drop`所有事件都触发时，`dataGridView_Routes_DragDrop()`将执行 log 命令，因为`e.Data.GetData`. 我做错了什么？我错过了什么吗？我试图查看几个指南，但没有具体涉及这个问题。

如何让数据网格将拖动的数据网格传递给另一个数据网格？

```
 /* Drag & Drop */
    private Rectangle dragBoxFromMouseDown;
    private int rowIndexFromMouseDown;
    private void dataGridView_Trips_MouseMove(object sender, MouseEventArgs e)
    {
        if ((e.Button & MouseButtons.Left) == MouseButtons.Left)
        {
            // If the mouse moves outside the rectangle, start the drag.
            if (dragBoxFromMouseDown != Rectangle.Empty && !dragBoxFromMouseDown.Contains(e.X, e.Y))
            {
                // Proceed with the drag and drop, passing in the list item.                    
                DragDropEffects dropEffect = dataGridView_Trips.DoDragDrop(dataGridView_Trips.Rows[rowIndexFromMouseDown], DragDropEffects.Copy);
            }
        }
    }

    private void dataGridView_Trips_MouseDown(object sender, MouseEventArgs e)
    {
        // Get the index of the item the mouse is below.
        rowIndexFromMouseDown = dataGridView_Trips.HitTest(e.X, e.Y).RowIndex;
        if (rowIndexFromMouseDown != -1)
        {
            // Remember the point where the mouse down occurred. 
            // The DragSize indicates the size that the mouse can move 
            // before a drag event should be started.                
            Size dragSize = SystemInformation.DragSize;

            // Create a rectangle using the DragSize, with the mouse position being
            // at the center of the rectangle.
            dragBoxFromMouseDown = new Rectangle(new Point(e.X - (dragSize.Width / 2), e.Y - (dragSize.Height / 2)), dragSize);
        }
        else
            // Reset the rectangle if the mouse is not over an item in the ListBox.
            dragBoxFromMouseDown = Rectangle.Empty;
    }

    private void dataGridView_Routes_DragOver(object sender, DragEventArgs e)
    {
        e.Effect = DragDropEffects.Copy;
    }

    private void dataGridView_Routes_DragDrop(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent(typeof(DataRowView)))
        {
            // The mouse locations are relative to the screen, so they must be 
            // converted to client coordinates.
            Point clientPoint = dataGridView_Routes.PointToClient(new Point(e.X, e.Y));

            // If the drag operation was a copy then add the row to the other control.
            if (e.Effect == DragDropEffects.Copy)
            {
                DataGridViewRow rowToMove = e.Data(typeof(DataGridViewRow)) as DataGridViewRow;
                dataGridView_Routes.Rows.Add(rowToMove);
            }
        }
        else
        {
            log("Geen data! #01", "Fout");
        }
    }
    /* End Drag & Drop */ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T11:43:13.773

我不知道。但是以下功能已经过调整，可以按预期工作。不太清楚以前的代码是如何破坏的。

编辑： typeof 是用 DataViewRow 而不是 DataGridViewRow 编写的。失败。

```
private void dataGridView_Routes_DragDrop(object sender, DragEventArgs e)
    {
        try
        {
            if (e.Data.GetDataPresent(typeof(DataGridViewRow)))
            {

                // The mouse locations are relative to the screen, so they must be 
                // converted to client coordinates.
                Point clientPoint = dataGridView_Routes.PointToClient(new Point(e.X, e.Y));

                // If the drag operation was a copy then add the row to the other control.
                if (e.Effect == DragDropEffects.Copy)
                {
                    DataGridViewRow Row = (DataGridViewRow)e.Data.GetData(typeof(DataGridViewRow));
                    dataGridView_Routes.Rows.Add(Row.Cells[0].Value, Row.Cells[1].Value, Row.Cells[2].Value);
                }
            }
            else
            {
                log("Geen data! #01", "Fout");
            }
        }
        catch (Exception msg)
        {
            log(msg.Message,"Fout");
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-20T20:53:31.733

此解决方案适用于将 datagridViews 绑定到 customObjects 的人。它就像一个具有多项选择的魅力。建议被接受。

假设您要从 datagridview1 拖动到 datagridview2

```
//datagridview1 is bound to this BindingList 
BindingList<myObject> object_bound_list1;

//datagridview2 is bound to this BindingList 
BindingList<myObject> object_bound_list2;

List<myObject> selected_Object_list = new List<myObject>();
List<int> selected_pos_list = new List<int>();

private void dataGridView1_MouseMove(object sender, MouseEventArgs e)
{
    if ((e.Button & MouseButtons.Left) == MouseButtons.Left)
    {
        // Proceed with the drag and drop, passing in the list item.                   
        DragDropEffects dropEffect = dataGridView1.DoDragDrop(
        selected_Object_list,
        DragDropEffects.Move);
    }
}

private void dataGridView1_MouseDown(object sender, MouseEventArgs e)
{
    // Get the index of the item the mouse is below.
    int rowIndexFromMouseDown = dataGridView1.HitTest(e.X, e.Y).RowIndex;

    //if shift key is not pressed
    if (Control.ModifierKeys != Keys.Shift && Control.ModifierKeys != Keys.Control)
    {
        //if row under the mouse is not selected
        if (!selected_pos_list.Contains(rowIndexFromMouseDown) && rowIndexFromMouseDown > 0)
        {
        //if there only one row selected
            if (dataGridView1.SelectedRows.Count == 1)
            {
                //select the row below the mouse
                dataGridView.ClearSelection();
                dataGridView1.Rows[rowIndexFromMouseDown].Selected = true;
            }
        }
    }

    //clear the selection lists
    selected_Object_list.Clear();
    selected_pos_list.Clear();

    //add the selected objects
    foreach (DataGridViewRow row in dataGridView1.SelectedRows)
    {
        selected_Object_list.Add(object_bound_list1[row.Index]);
        selected_pos_list.Add(row.Index);
    }
}

private void dataGridView2_DragOver(object sender, DragEventArgs e)
{
    e.Effect = DragDropEffects.Move;
}

private void dataGridView2_DragDrop(object sender, DragEventArgs e)
{
    if (e.Effect == DragDropEffects.Move)
    {
        foreach (var item in selected_Object_list)
        {
            object_bound_list2.Add(item);
        }
    }
} 
```

# sql - Sqlite Timestamp 各种比较

> ID：14199511
> 
> 赞同：1
> 
> 时间：2013-01-07T16:01:14.190
> 
> 标签：sql, sqlite, timestamp

如何`TIMESTAMP`按日期或时间比较列？

我尝试检索`TIMESTAMP`列差异的记录，并且`NOW`是一周或 2 小时或更短 30 分钟。

```
SELECT FROM Tcase WHERE (date_time-datetime('now'))<7day
SELECT FROM Tcase WHERE (date_time-datetime('now'))<1hour 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:02:52.177

例子

```
SELECT * FROM Tcase
WHERE datetime(date_time,'-7 day', '+5 hour', '+10 minute') >= date('now') 
```

## 编辑

```
SELECT * FROM Tcase
date('now') > datetime(date_time,'+7 day')
OR date('now') < datetime(date_time,'-7 day') 
```

## 请参阅[SQLite 日期函数](http://www.sqlite.org/lang_datefunc.html)

## [SQLFiddle 示例](http://sqlfiddle.com/#!7/ba5d7/1)

# javascript - 谷歌图表调用 onmouseover 事件

> ID：14199514
> 
> 赞同：2
> 
> 时间：2013-01-07T16:01:18.440
> 
> 标签：javascript, jquery, google-visualization

我整天都在研究这个问题，但没有成功。我有一个显示一些数据的谷歌图表，工作得很好。

我一直在研究更详细的图表，包括大约十几个图表图例项目。我想在图表下方显示我的图例，所以我将它的位置设置为底部。

但是图表生成的“丑陋”分页对我的经理并没有真正的吸引力。

所以我隐藏了它并重新渲染了图表下方的图例项，没有使用一些自定义 javascripting 进行分页（实际上我从这里看到了代码[http://jsfiddle.net/asgallant/6Y8jF/2/](http://jsfiddle.net/asgallant/6Y8jF/2/)）

```
var legend = document.getElementById('legend');
    var lis = [];

    var total = 0;
    for (var i = 0; i < data.length; i++) {
        var legendValue = data[i];

        if(legendValue.indexOf("PROVIDER") == -1){

            // create the legend entry
            lis[i] = document.createElement('li');
            lis[i].id = 'legend_' + legendValue;
            lis[i].className = 'legendary';
            lis[i].innerHTML = '<div class="legendMarker" style="background-color:' + colors[i] + ';">' + legendValue + '</div>';

            // append to the legend list
            legend.appendChild(lis[i]);
        }
    } 
```

所以几乎与实际图形图例具有相同的功能，但缺少一件事。当原始谷歌图表图例悬停时，图表上的项目会突出显示，如下例所示：

[http://code.google.com/apis/ajax/playground/?type=visualization#chart_wrapper](http://code.google.com/apis/ajax/playground/?type=visualization#chart_wrapper)

如果您将鼠标悬停在德国或美国，图表上的条将被选中或突出显示。

如何从我的列表项中触发相同的行为？

我试过了 ：

```
function eventFire(el, etype){
    if (el.fireEvent) {
      el.fireEvent('on' + etype);
    } else {
      var evObj = document.createEvent('Events');
      evObj.initEvent(etype, true, false);
      el.dispatchEvent(evObj);
    }
 }

$(document).on("hover", ".legendary", function(){
        eventFire(document.getElementById('graphico'),'select');
        eventFire(document.getElementById('graphico'),'onmouseover');
        $("#graphico").trigger("onmouseover");
        $("#graphico").trigger("select");
        console.log("fired hover event");
    }); 
```

我在萤火虫中收到“触发悬停事件”消息，但我的图表中没有任何反应。

我将 onmouseover 侦听器添加到图表（此函数被触发）：

```
google.visualization.events.addListener(ga_chart, 'onmouseover', function(e) {
        console.log("listening bruv");
      }); 
```

但我不确定如何选择图表的特定部分。

我正在尝试调用任何导致在主图上突出显示的事件：

[https://developers.google.com/chart/interactive/docs/gallery/piechart#Events](https://developers.google.com/chart/interactive/docs/gallery/piechart#Events)

任何想法或意见将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:29:55.443

向 li 元素添加一个属性，您可以在其中识别相关行：

```
// 创建图例条目
lis[i] = document.createElement('li');
lis[i].setAttribute('data-row',i);

```

绘制图表后，调用它：

```
 $('#legend li').hover(function(){
      chart.setSelection([{row:$(this).data('row'),column:null}]);
    },function(){
      chart.setSelection(null);
    }); 
```

演示：http: [**//jsfiddle.net/doktormolle/2JWQY/**](http://jsfiddle.net/doktormolle/2JWQY/)

# objective-c - （Objective-C / Cocoa）铸造超类保持不变

> ID：14199520
> 
> 赞同：0
> 
> 时间：2013-01-07T16:01:38.873
> 
> 标签：objective-c, cocoa, casting, delegates, subclass

我正在研究 NSURLConnection 的一个子类。我添加了一些属性和功能。我实现了 NSURLConnectionDelegate 及其方法。

现在我需要将 NSURLConnection （及其属性）传递给我的子类委托。我为此实现了一个委托协议。

这是一个代码示例：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    if([_delegate respondsToSelector:_didReceiveDataSelector]) {
        [_delegate performSelector:_didReceiveDataSelector withObject:connection];
    } 
```

现在我还需要返回我的子类属性。我试图简单地转换实例：

```
mySubClass *obj = (mySubClass *)connection;
obj.userInfo = self.userInfo; 
```

但事实证明 ( `NSLog(@"%@", NSStringFromClass([obj class]));`) 转换返回一个对象，该对象的类仍然是 NSURLConnection。

现在我想知道如何合并超类实例的所有属性值和我的子类属性。

感谢帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:10:19.040

强制转换不会改变对象的类。铸造只是告诉编译器“这个对象实际上是一个whatever”。这是因为编译器误解了什么是类。

鉴于强制转换似乎对您不起作用，那么这意味着您没有被传递自定义子类的实例。因此，您应该首先查看创建连接的代码。我希望看到类似的东西：

```
mySubClass *conn = [[mySubClass alloc] initWithRequest:req delegate:self]; 
```

你的代码是这样的吗？如果不是（即，如果您创建一个`NSURLConnection`而不是 a `mySubClass`），则切换到创建一个`mySubClass`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:51:44.010

我解决了这个问题。

现在我正在这样做：

```
- (id)initWithRequest:(NSURLRequest *)request delegate:(id)delegate {
    self = [super initWithRequest:request delegate:self];
    if(self) {
        _delegate = delegate;
    }
} 
```

这样我就可以在我的子类上接收委托方法，扩展方法中的信息并将自定义选择器结束到委托。

在 viewControllers 我可以做这样的事情：

```
mySubClass *con = [[mySubClass alloc] initWithRequest:req delegate:self];
[con setDidReceiveResponseSelector:@selector(connection:didGetResponse)];
[con start]; 
```

所以我可以在同一个 viewController 中有十个 URLRequests，对于同一个动作有不同的委托方法。

# button - BitmapButtonField 监听器

> ID：14199522
> 
> 赞同：0
> 
> 时间：2013-01-07T16:01:42.187
> 
> 标签：button, bitmap

在应用程序中，我用图像实现了 BitmapButtonField。单击 BitmapButton 我必须集成 Facebook 应用程序。我搜索了 bitmapButtonField 的点击事件，但没有任何效果。

```
Facebook = new BitmapButtonField(
            Bitmap.getBitmapResource("facebook.png"));
    Facebook.setMargin(0, 10, 0, 10);
    horizontal_field.add(Facebook);
    Facebook.setChangeListener(this); 
```

如果我在触摸监听电话上测试这个。它正在工作。如果我们有没有触摸的设备，它就无法工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T00:14:02.840

您必须传递样式属性**ButtonField.CONSUME_CLICK**。因此，您可以使按钮可点击。您可以使用 BitmapButtonField 类的这个构造函数

```
BitmapButtonField( Bitmap normalState, Bitmap focusState, long style ) 
```

例如：

```
Facebook = new BitmapButtonField(Bitmap.getBitmapResource("facebook.png"),Bitmap.getBitmapResource("facebookFocusState.png"), ButtonField.CONSUME_CLICK); 
```

这对我有用。在 trackPad 黑莓手机上

# qt - Qt中quint64的最大数值是多少？

> ID：14199523
> 
> 赞同：6
> 
> 时间：2013-01-07T16:01:42.503
> 
> 标签：qt

> **可能重复：**
> [Qt 类型的限制在哪里？](https://stackoverflow.com/questions/4788693/where-are-the-limits-for-qt-types)

我需要最大数量的 quint64 例如我们有一个用于 ulong ULONG_MAX 的宏

quint64 是否有任何相等的宏？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-07T16:17:25.693

您可以在官方文档中找到答案：

`quint64`是 typedef `unsigned long long int`（`unsigned __int64`在 Windows 上）。这种类型保证在 Qt 支持的所有平台上都是 64 位的。

因此，`quint64`无符号整数是 64 位类型。我们可以通过这种方式找到它的最大值：`2^64-1 = 18446744073709551615`.

正如[这里](https://stackoverflow.com/questions/4788693/where-are-the-limits-for-qt-types)所说的，你可以通过包含得到相同的结果`#include <limits>`，并输出结果

```
std::numeric_limits<quint64>::max(); 
```

# javascript - Mongoose：查找、修改、保存

> ID：14199529
> 
> 赞同：48
> 
> 时间：2013-01-07T16:01:59.087
> 
> 标签：javascript, node.js, mongoose

我有一个猫鼬`User`模型：

```
var User = mongoose.model('Users',
    mongoose.Schema({
        username: 'string',
        password: 'string',
        rights: 'string'
    })
); 
```

我想找到`User`模型的一个实例，修改它的属性，然后保存更改。这是我尝试过的（这是错误的！）：

```
User.find({username: oldUsername}, function (err, user) {
    user.username = newUser.username;
    user.password = newUser.password;
    user.rights = newUser.rights;

    user.save(function (err) {
        if(err) {
            console.error('ERROR!');
        }
    });
}); 
```

查找、修改和保存`User`模型实例的语法是什么？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2013-01-07T16:11:21.003

回调的`user`参数是一个带有`find`. 在查询单个实例时使用`findOne`而不是。`find`

```
User.findOne({username: oldUsername}, function (err, user) {
    user.username = newUser.username;
    user.password = newUser.password;
    user.rights = newUser.rights;

    user.save(function (err) {
        if(err) {
            console.error('ERROR!');
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-01-07T16:12:34.087

为什么不使用[Model.update](http://mongoosejs.com/docs/api.html#model_Model-update)？毕竟你没有使用找到的用户来更新它的属性：

```
User.update({username: oldUsername}, {
    username: newUser.username, 
    password: newUser.password, 
    rights: newUser.rights
}, function(err, numberAffected, rawResponse) {
   //handle it
}) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-06-20T04:52:33.180

[findOne](https://mongoosejs.com/docs/api.html#model_Model.findOne)，修改字段并保存

```
User.findOne({username: oldUsername})
  .then(user => {
    user.username = newUser.username;
    user.password = newUser.password;
    user.rights = newUser.rights;

    user.markModified('username');
    user.markModified('password');
    user.markModified('rights');

    user.save(err => console.log(err));
}); 
```

或[findOneAndUpdate](http://mongoosejs.com/docs/api.html#model_Model.findOneAndUpdate)

```
User.findOneAndUpdate({username: oldUsername}, {$set: { username: newUser.username, user: newUser.password, user:newUser.rights;}}, {new: true}, (err, doc) => {
    if (err) {
        console.log("Something wrong when updating data!");
    }
    console.log(doc);
}); 
```

另见[updateOne](https://mongoosejs.com/docs/api.html#document_Document-updateOne)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-07-22T01:33:57.100

我想补充一些非常重要的东西。我经常使用 JohnnyHK 方法，但我注意到有时更改不会持续到数据库中。当我使用它时[`.markModified`](http://mongoosejs.com/docs/schematypes.html#usage-notes)，它起作用了。

```
User.findOne({username: oldUsername}, function (err, user) {
   user.username = newUser.username;
   user.password = newUser.password;
   user.rights = newUser.rights;

   user.markModified(username)
   user.markModified(password)
   user.markModified(rights)
    user.save(function (err) {
    if(err) {
        console.error('ERROR!');
    }
});
}); 
```

> 在保存之前用 doc.markModified('pathToYourDate') 告诉猫鼬有关更改。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-05-08T08:41:25.240

如果您想使用`find`，就像我想在客户端进行的任何验证一样。

`find`返回一个 ARRAY 对象

`findOne`只返回一个对象

添加`user = user[0]`使保存方法对我有用。

这是你放的地方。

```
User.find({username: oldUsername}, function (err, user) {
    user = user[0];
    user.username = newUser.username;
    user.password = newUser.password;
    user.rights = newUser.rights;

    user.save(function (err) {
        if(err) {
            console.error('ERROR!');
        }
    });
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-25T14:38:47.500

您还可以使用 updateOne 和 $set 以及 async/await 将其编写得更简洁一些。

```
const updateUser = async (newUser) => {
  try {
    await User.updateOne({ username: oldUsername }, {
      $set: {
        username: newUser.username,
        password: newUser.password,
        rights: newUser.rights
      }
    })
  } catch (err) {
    console.log(err)
  }
} 
```

由于您不需要生成的文档，您可以只使用 updateOne 而不是 findOneAndUpdate。

这里有一个关于差异的很好的讨论：[MongoDB 3.2 - Use cases for updateOne over findOneAndUpdate](https://stackoverflow.com/questions/36209434/mongodb-3-2-use-cases-for-updateone-over-findoneandupdate)

# .net - 如何在多个项目中重用相同的 XAML UI 主题（样式、ControlTemplates 等）

> ID：14199533
> 
> 赞同：1
> 
> 时间：2013-01-07T16:02:04.247
> 
> 标签：.net, wpf, visual-studio-2010, theming

我开始研究“Visual Studio 做事方式”，并创建了一个 WPF 沙箱项目。

我确信我的公司希望为多个项目重用相同的 UI 主题。

所以我创建了这个应用程序项目，并希望创建另一个项目来包含 UI 主题和样式文件。例如，我将其命名为“CompanywideThemingProject”。

Visual Studio 为我提供了很多项目模板，例如“WPF 应用程序”、“类库”、“控制台应用程序”等。我想做的就是创建一些 XAML 字典，可能还有一些带有一些用于颜色操作的辅助函数的 .cs 文件，但我怀疑这可以被视为“WPF 应用程序”。类库描述似乎也不适用，因为我不想创建 .dll 文件（或者至少我认为我不想）。

目标是拥有一个集中的、版本化的 Visual Studio 项目，我可以将其“导入”到针对不同应用程序的多个 Visual Studio 解决方案中，这样我就可以确保所有应用程序的视觉样式是一致的。

知道我应该如何构建 VS 项目/解决方案吗？

谢谢阅读！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:14:42.183

我通常会创建一个类库，其中包含我需要的一切：

*   自定义控件
*   资源字典
*   图片等各种资源
*   自定义 .cs 文件（例如自定义转换器）

请注意，出于某种原因，Visual Studio 2010 不会建议您`ResourceDictionary`在类库中添加一个。

老实说，我绝对不知道为什么它不会要求我添加它，但我最终使用了一种解决方法：要么：

*   手动创建 .xaml 文件，然后将其引用到 Visual Studio
*   创建一个 WPF 用户控件，然后删除 .xaml.cs 文件并将 xaml 用作`ResourceDictionary`

这就是我的全部，它非常适合拥有一个包含通用控件/UI 材料的集中式项目

# android - 在surfaceView中使用onTouchEvent暂停后重新启动应用程序

> ID：14199539
> 
> 赞同：0
> 
> 时间：2013-01-07T16:02:28.400
> 
> 标签：android, surfaceview

嗨，我是 Android 编程新手，我一直在看一个关于 Android 游戏编程的[youtube 教程](https://www.youtube.com/playlist?list=PLB1F9A9707CDD9EE9)，问题是这个特定的课程是在期中留下的，所以游戏还没有完成，所以我尝试添加一些自己的东西。就在我的新旅程刚开始时，我一直在解决一个自己无法解决的问题，所以如果有人可以帮助我，我会在这里尝试。

问题是游戏的视觉部分，我有一个*surfaceView*和一个事件*onTouchEvent*。当我暂停游戏（活动中的*onPause*方法）时出现问题，它碰巧*surfaceHolder*被破坏（来自方法*surfaceDestroyed*）但是为了不遇到麻烦，我必须停止更新游戏的线程（ *GameLoopThread ）。*当游戏取消暂停时，它会调用*onResume* 方法并创建一个新的*surfaceFolder*并初始化*GameLoopeThread*线程。

我遇到的问题是，在调用方法*onResume()*并重新初始化所有内容后，surfaceView 中的事件*onTouchEvent*停止工作，所以点击它不起作用，过了一会儿我收到一条消息，说应用程序没有响应我可以在等待（没有任何反应）或强制关闭应用程序之间做出选择。

我将surfaceView 中的代码留给你（有些东西现在已经不需要了，有些东西已经注释了以供试用）。

```
package net.balanze.tutorialjuego;
import java.util.ArrayList;
import java.util.List;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Typeface;
import android.media.AudioManager;
import android.media.SoundPool;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceHolder.Callback;
import android.view.SurfaceView;
/*
* See audio with ToneGenerator, MediaPlayer y SoundPool.
*/
public class GameView extends SurfaceView {

private SurfaceHolder holder; 
private GameLoopThread gameLoopThread; 
private List<Sprite> sprites=new ArrayList<Sprite>(); 
private long lastClick; 
private Bitmap bmpBlood; 
private List<TempSprite> temps = new ArrayList<TempSprite>(); 
private int puntos=0;
private Paint paint;
/*
 * iniciamos sndPool con un maximo de 16 flujos simultanios
 * el audio sera del flujo musical, (el ultimo parametro no
 * funciona asi que pongo 0 que es el conversor por defecto).
 */
private SoundPool sndPool = new SoundPool(16, AudioManager.STREAM_MUSIC, 0);
private int sonidoMalo;
/*private int x=0; 
private int xSpeed=1;*/

public GameView(Context context) {
    super(context);
    gameLoopThread = new GameLoopThread(this);
    holder = getHolder();
    holder.addCallback(new Callback() {

        @Override
        public void surfaceDestroyed(SurfaceHolder holder) {
            gameLoopThread.setRunning(false);
            boolean intento=true;
            while(intento){
                try {
                    gameLoopThread.join();
                } catch (InterruptedException e) {
                    // e.printStackTrace();
                    System.out.println("ERROR --> Problema al destruir la view.");
                }
                intento=false;
            }
            //gameLoopThread=null;
        }

        @Override
        public void surfaceCreated(SurfaceHolder holder) {
             createSprites();
            /*
             * La asignacion de los Sprites se hace aqui ya que 
             * para calcular las posiciones en las que empieza cada
             * sprite necesitamos conocer el alto y el ancho de la 
             * pantalla y si no se acabo de crear la view no conocemos
             * sus dimensiones. 
             */
             gameLoopThread=(!gameLoopThread.isAlive())?new GameLoopThread(devolverVista()):gameLoopThread;
            if(!gameLoopThread.isRunning()){
                gameLoopThread.setRunning(true);
                gameLoopThread.start();
            }
        }

        @Override
        public void surfaceChanged(SurfaceHolder holder, int format, int width,
                int height) {
            // TODO Auto-generated method stub

        }
    });
    bmpBlood = BitmapFactory.decodeResource(getResources(), R.drawable.blood1);
    sonidoMalo=sndPool.load(context, R.raw.baddeath, 1);
    paint=new Paint();
    paint.setARGB(255, 255, 0, 0);
    paint.setTextSize(30);
    paint.setTypeface(Typeface.SANS_SERIF);
}
/**
 * <p><b>private void createSprites()</b></p>
 * <p>Añade a al array list sprites todos los sprites que veremos
 * en pantalla.</p>
 */
private void createSprites(){
    // establecemos el grafico que queremos pintar.
    sprites.add(createSprite(R.drawable.bad1, false));
    sprites.add(createSprite(R.drawable.bad2, false));
    sprites.add(createSprite(R.drawable.bad3, false));
    sprites.add(createSprite(R.drawable.bad4, false));
    sprites.add(createSprite(R.drawable.bad5, false));
    sprites.add(createSprite(R.drawable.bad6, false));
    sprites.add(createSprite(R.drawable.good1, true));
    sprites.add(createSprite(R.drawable.good2, true));
    sprites.add(createSprite(R.drawable.good3, true));
    sprites.add(createSprite(R.drawable.good4, true));
    sprites.add(createSprite(R.drawable.good5, true));
    sprites.add(createSprite(R.drawable.good6, true));
}
/**
 * <p><b>private Sprite createSprite(int Resource)</b></p>
 * <p>Devuelve un sprite con la imagen que se le pasa como recurso.</p>
 * @param Resource Recurso de imagen que queremos pintar en el Sprite.
 * @return Sprite creador con imagen pasada.
 */
private Sprite createSprite(int Resource, boolean esBueno){
    Bitmap bmp = BitmapFactory.decodeResource(getResources(), Resource);
    return new Sprite(this, bmp, esBueno);
}

@Override
protected void onDraw(Canvas canvas){
    canvas.drawColor(Color.BLACK);
    canvas.drawText("Puntuacion: "+puntos, 0, 30, paint);
    for(int i=temps.size()-1; i>=0; i--) temps.get(i).onDraw(canvas);
    for(Sprite sprite:sprites){
        sprite.onDraw(canvas);
    }
}

@Override
public boolean onTouchEvent(MotionEvent event){
     if(System.currentTimeMillis()-lastClick>300){
        lastClick=System.currentTimeMillis();
        synchronized (getHolder()) {
            float x = event.getX();
            float y = event.getY();
            for(int i=sprites.size()-1; i>=0; i--){
                Sprite sprite=sprites.get(i);
                if(sprite.isColision(x, y)){
                    if(!sprite.esBueno()) sndPool.play(sonidoMalo, 1.0f, 1.0f, 5, 0, 1.0f);
                    puntos+=sprite.puntuar();
                    sprites.remove(sprite);
                    temps.add(new TempSprite(temps, this, x, y, bmpBlood));
                    break;
                }
            }
        }
    }
    //return true;
    return super.onTouchEvent(event);
}
/**
 * <p><b>public boolean quedanMalos()</b><P>
 * <p>Devuelve verdadero si quedan sprites de enemigos y falso en caso contrario.</p>
 * @return true si quedan enemigos, false si solo quedan sprites buenos.
 */
public boolean quedanMalos(){
    boolean soloBuenos=true;
    for(int i=0; i<sprites.size() && soloBuenos; i++)     soloBuenos=sprites.get(i).esBueno();
    return !soloBuenos;        
}
/**
 * <p><b>public void pause()</b></p>
 * <p>Pausa el juego, porque pausa el gameLoop.</p>
 */
public void pause(){
    gameLoopThread.setRunning(false);
    boolean intento=true;
    //synchronized (gameLoopThread) {
        while(intento){
            try{
                gameLoopThread.join();
            }catch (InterruptedException e) {
                //e.printStackTrace();
                System.out.println("ERROR --> No se pudo para el gameLoop.");
            }
            intento=false;
        }
    //}
    gameLoopThread=null;
}
public void resume(){
    if(holder.isCreating()){
        gameLoopThread=(!gameLoopThread.isAlive())?new GameLoopThread(this):gameLoopThread;
        if(!gameLoopThread.isRunning()){
            gameLoopThread.setRunning(true);
            gameLoopThread.start();
        }
    }
}
private GameView devolverVista(){
    return this;
} 
```

}

非常感谢您的帮助。如果您需要更多代码或其他内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T20:55:10.340

好的，我不知道你是否还需要帮助，但这里是；

首先，做一些调试来检查当你返回时你是否正在获取值，或者你的 onTouch 是否被那里的断点触发（尽管阅读你的帖子我猜你已经这样做了）。

还要尝试查看表面视图周围的视图/视图组是否有任何接触（给布局/视图一个 id 和一个 ontouchlistener 和断点）。

我在线程运行的surfaceview中所做的是覆盖surfaceview-view的ontouch：

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    return thread.doTouchEvent(event);
} 
```

在我的线程中我处理触摸事件：

```
boolean doTouchEvent(MotionEvent event) {
        synchronized (mSurfaceHolder) 
        {
               (detect ondown etc, do something and return true/false)
            }
       } 
```

这似乎在 onResume 之后可以正确处理事情。不过，请务必正确处理您的线程（oncreate、ondestroy 等）。

顺便说一句，为了处理输入泛滥，我有这个：

```
@Override
public boolean dispatchTouchEvent(MotionEvent event) {

    /*touchTime = System.currentTimeMillis();       
    if (oldTouchAction == -1)
    {
        lastTouchTime = touchTime;
        oldTouchAction = (event.getAction() & MotionEvent.ACTION_MASK);

        super.dispatchTouchEvent(event);

        try {
            Thread.sleep(32);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
       return true;
    }
    else
    {           
        if (oldTouchAction == (event.getAction() & MotionEvent.ACTION_MASK))
        {
            if ((touchTime - lastTouchTime) > 35)
            {
                lastTouchTime = touchTime;

                super.dispatchTouchEvent(event);

                return true;
            }
            lastTouchTime = touchTime;
        }
        else
        {
            lastTouchTime = touchTime;
            super.dispatchTouchEvent(event);

           return true;
        }
    }       
    lastTouchTime = touchTime;*/
    if (touchBool)
    {
        super.dispatchTouchEvent(event);
        try {
            Thread.sleep(32);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
    return true;
} 
```

这可以防止活动因过多的触摸事件而减慢（touchBool 只是我用来防止事件在游戏赢/输时触发两次；当游戏赢/输并且事件由触摸屏幕 touchBool 设置为 false。我在 surfaceview 中还有一个方法将其设置为 true/false，它在周围活动的 onresume/onpause 中触发）。

无论如何，我希望这会有所帮助，祝你好运！

# gitolite - 如何在不使用 gitolite-admin 的情况下向 gitolite 服务器添加 ssh 密钥？

> ID：14199550
> 
> 赞同：6
> 
> 时间：2013-01-07T16:02:58.660
> 
> 标签：gitolite, ssh-keys

我想从新工作站向我的 gitolite 服务器添加一个 ssh 密钥。我无法通过 gitosis-admin 进行操作，因为我无法克隆它，而且我无法访问我以前的笔记本电脑，其中包含我安装 gitolite 的 ssh 密钥。

如何在不克隆 gitosis-admin 的情况下将新密钥添加到 gitosis-admin/keydir？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T16:22:16.380

[“不要惊慌”页面](http://sitaramc.github.com/gitolite/emergencies.html)可以提供帮助（对于[gitolite V3](http://sitaramc.github.com/gitolite/master-toc.html)，而不是[旧的过时 gitosis](https://stackoverflow.com/questions/10888300/gitosis-vs-gitolite/10888358#10888358)）：

### 丢失管理员密钥/访问权限

> 如果您丢失了 gitolite 管理员密钥或访问权限，请执行以下操作。我们假设您的用户名是“ `alice`”。
> 
> *   为自己创建一个新的密钥对，并将公钥复制到服务器作为“ `alice.pub`”。
> *   登录到服务器，然后运行`gitolite setup -pk alice.pub`​​.
> 
> 就是这样; 新`alice.pub`文件将替换之前存储库中存在的任何内容。

这将允许您使用`gitolite-admin`repo 的克隆添加密钥，就像您应该的那样。

这不会“重置”您的 gitolite.conf 文件或 gitolite-admin 存储库中的任何内容：它将完成该`~/.ssh/authorized_keys`文件。
它当然对您现有的存储库没有影响。

话虽如此，如果 gitolite 命令看起来风险太大，您可以尝试第二种方法：

* * *

### 绕过gitolite

> 您可能由于 conf 文件错误而失去访问权限，在这种情况下，上述技巧将无济于事。您想要的是对 repo 进行更改（或者可能只是倒带）并推动它。以下是如何做到这一点：
> 
> *   登录到服务器。
> *   使用完整路径克隆管理存储库：git clone $HOME/repositories/gitolite-admin.git temp。
> *   进行任何您想要的更改——添加/替换密钥、'git revert' 或 'git reset --hard' 到较旧的提交等。任何你需要解决问题的东西，真的。
> *   运行 gitolite push（或可能 gitolite push -f）。请注意，这是“gitolite push”，而不是“git push”。
> 
> 注意：执行此操作时 gitolite 不会进行访问检查！

# java - 未找到 RhinoScriptEngineFactory

> ID：14199565
> 
> 赞同：1
> 
> 时间：2013-01-07T16:04:01.007
> 
> 标签：java, rhino, scriptengine

我无法使用主类和 ant 1.8.4 使用 Oracle JVM 的 JDK7U10 或 JDK6U32 运行“hello world”rhino 程序。我收到此错误：

```
ScriptEngineManager providers.next(): javax.script.ScriptEngineFactory: Provider com.sun.script.javascript.RhinoScriptEngineFactory not found
...
[java] Caused by: java.lang.NullPointerException
[java]     at com.Test.main(Test.java:14) 
```

我的代码是从文档中复制的，engine.eval 发生错误：

```
package com;

import javax.script.*;

public class Test {

    public static void main(String[] args) throws Exception {

        // create a script engine manager
        ScriptEngineManager factory = new ScriptEngineManager();
        // create a JavaScript engine
        ScriptEngine engine = factory.getEngineByName("JavaScript");
        // evaluate JavaScript code from String
        engine.eval("print('Hello, World')");

    }
} 
```

我的 lib 目录中有 rhino 提供的 js.jar 以及我可能需要的 ant 必需包 bsf.jar。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-06-04T12:31:42.260

我知道这篇文章很旧，但您可以尝试使用以下方法初始化 ScriptEngineManager：

```
ScriptEngineManager manager = new ScriptEngineManager(null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T15:26:38.277

您可以使用这种形式的代码来发现 JRE 可见的引擎：

```
for (ScriptEngineFactory sef : new ScriptEngineManager().getEngineFactories()) {
  System.out.println(sef);
  System.out.append("  Engine: ")
      .append(sef.getEngineName())
      .append(" ")
      .println(sef.getEngineVersion());
  System.out.append("  Language: ")
      .append(sef.getLanguageName())
      .append(" ")
      .println(sef.getLanguageVersion());
  System.out.append("  Names: ")
      .println(sef.getNames());
} 
```

我不认为 Rhino 对 JRE 的`javax.script`API 是自动可见的（Oracle 的 JDK 中附带的版本除外。）

# c# - XNA C# 拉绳奇怪的盒子

> ID：14199567
> 
> 赞同：1
> 
> 时间：2013-01-07T16:04:05.713
> 
> 标签：c#, fonts, xna, drawstring, spritebatch

图片： http: [//i.imgur.com/dJseH.png](http://i.imgur.com/dJseH.png)
我已经和 XNA 合作了一段时间，这是第一次出现这种情况黑色
文本应该是“兽人”，紫色是“1 / 100”就像经验一样
但是这似乎不起作用，似乎文字和背景色是相同的。

这是拉绳代码：

```
spritebatch.DrawString(basicFont, Player.Name, new Vector2(
                camera.Pos.X - 250, camera.Pos.Y + 85), Color.Black);
spritebatch.DrawString(basicFont, Player.curEXP.ToString() +
                " / " + Player.maxEXP, new Vector2(camera.Pos.X - 185,
                   camera.Pos.Y + 220), Color.Purple); 
```

基本字体：

```
<FontName>Kootenay</FontName>
<Size>12</Size>
<Spacing>0</Spacing>
<UseKerning>true</UseKerning>
<Style>Regular</Style> 
```

我想这可能是因为 HUD 图像有点透明，所以我在背景上画了一些具有相同效果的字符串。
我制作了一种新字体，同样的事情发生了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T07:58:48.817

有效。谢谢喜凯丸。

我不得不将 SpriteBlendMode 更改为 AlphaBlend。

```
spritebatch.Begin(SpriteBlendMode.AlphaBlend, SpriteSortMode.Deferred,
                   SaveStateMode.None, camera.viewMatrix); 
```

# javascript - 检测 iOS Checkboxes 插件的复选框状态

> ID：14199580
> 
> 赞同：0
> 
> 时间：2013-01-07T16:04:34.353
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用这个插件来赋予复选框和 iOS 外观：http: [//ios-checkboxes.awardwinningfjords.com/](http://ios-checkboxes.awardwinningfjords.com/)

显然，当我使用 Chrome 或 Firefox DOM 检查器时，它不会触及隐藏的复选框输入值。尽管在提交检测到定义状态的表单后它可以正常工作，但它始终保持不变。（我不知道它是怎么做到的......）

目前我正在使用一些输入选择，并根据值（是或否）显示另一个元素：

**html:**

```
<select name="announcement" id="announcement">
    <option value="0">No</option> 
    <option value="1">Yes</option>
</select> 
```

**jQuery更改检测：**

```
$('#announcement').change(function(){
    if($(this).val() == 0 ){
        $('#listOfCompanies').show();
    }else{
        $('#listOfCompanies').hide();
    }
}); 
```

现在，我将第一个转换`select`为这样的复选框：

```
<input type="checkbox" name="announcement" value="1" id="announcement"> 
```

当我使用 iOS 插件时，有什么方法可以检测到复选框的值吗？

`$('#announcement').change(function(){`不起作用，因为 DOM 元素中的复选框值不再更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:19:37.867

如果您查看下载附带的 jquery-demo html，它显示了如何绑定 onchange 事件处理程序的示例。

```
$('#announcement').iphoneStyle({
    onChange: function(elem, value) { 
      // not sure what comes up as the arguments passed in.. but to find out you can do console.log(arguments)
      $('#listOfCompanies').toggle(!value);
    }
}); 
```

编辑：

尝试同时传递您的选中/未选中标签选项

```
$('#announcement').iphoneStyle({
    checkedLabel: 'your checked label',
    uncheckedLabel: 'your unchecked label',
    onChange: function(elem, value) { 
      // not sure what comes up as the arguments passed in.. but to find out you can do console.log(arguments)
      $('#listOfCompanies').toggle(!value);
    }
}); 
```

# java - 在java中旋转一个3d向量

> ID：14199581
> 
> 赞同：1
> 
> 时间：2013-01-07T16:04:38.410
> 
> 标签：java, android, math, vector, geometry

我从传感器管理器获得了设备的磁性 XYZ 值。

但是，这些是设备视角的 XYZ 值。

![设备的观点](../Images/44ace96b093f4444aa5f98c28d6a5183.png)

问题是，我希望那些坐标（磁值的 3d 向量）向北旋转。当我转动并握住设备时，我想看到**相同的 XYZ值。**

使用时

```
SensorManager.getRotationMatrix(R, I, accel, m);
SensorManager.getOrientation(R, v); 
```

我在向量 v[] 中得到设备方向的 XYZ。

现在我需要做什么来旋转原始矢量以适应北方？

这是我正在寻找的最终结果：

![如所见，对于设备的任何方向，我都得到相同的 xyz 值](../Images/82fcc58fac5643959e1cff9a190cc323.png)

如所见，对于设备的任何方向，我都得到相同的 xyz 值

编辑：

我试过添加这个：

```
Location l=null;
GeomagneticField field = new GeomagneticField((float) l.getLatitude(),(float) l.getLongitude(),(float) l.getAltitude(),l.getTime()); 
```

并且我从 field.getX() 获得的数据无效（可能是因为我使用了空位置...？）。知道在哪里可以找到示例代码来帮助我吗？

谢谢， 哎呀

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:07:39.480

代替

```
SensorManager.getOrientation(R, v); 
```

这将为您提供设备的方向，使用

```
GeomagneticField::getX();
GeomagneticField::getY();
GeomagneticField::getZ(); 
```

这些将为您提供磁场的分量，而与设备的方向无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T13:03:01.957

好的！我终于能够转动矢量了。

我使用了迈克的建议并尝试了旋转矩阵的东西..

关键是将当前旋转矩阵从 SensorManager 中取出，并将其与您的 xyz 磁值矢量相乘（取决于设备方向）。

![在此处输入图像描述](../Images/af35311ba51045ec0ee8b241e1e138d2.png)

A 是旋转矩阵，xyz 是我的磁值向量。

这就是你用代码编写它的方式

```
SensorManager.getRotationMatrix(R, I, accel, m);
m[0]=Math.round(m[0]);//X
m[1]=Math.round(m[1]);//Y
m[2]=Math.round(m[2]);//Z
v[0]=Math.round((m[0]*R[0] )+(m[1]*R[1])+(m[2]*R[2]));
v[1]=Math.round((m[0]*R[3] )+(m[1]*R[4])+(m[2]*R[5]));
v[2]=Math.round((m[0]*R[6] )+(m[1]*R[7])+(m[2]*R[8])); 
```

其中“m”是从传感器接收到的磁值：

```
public void onSensorChanged(SensorEvent event) {
    switch(event.sensor.getType()) {
        case Sensor.TYPE_MAGNETIC_FIELD:
             System.arraycopy(event.values, 0, m, 0, 3);
             break;
    }
} 
```

# python - tkinter.entry 和 NameErrors。

> ID：14199584
> 
> 赞同：0
> 
> 时间：2013-01-07T16:04:45.580
> 
> 标签：python

我目前正在为回文检测器编写 GUI，但遇到了一些问题。我可以启动程序，并且 GUI 似乎很好。除了基本的按钮之外，所有按钮都可以使用：Testa Palindrom（翻译为测试回文）。

每当我单击该按钮时，我都会收到 NameError: global name 'palindromentry' is not defined。

您将在下面找到整个代码，但首先快速解释一下它的作用。

def ordnaText 降低文本并修复它以进行检查。def testap 使用 for 循环测试它是否是回文。def visaResultat 显示结果（这可以在 label1.config 中看到）。

我的问题是：为什么我会收到这个错误？我这辈子都想不通。

```
import tkinter
import tkinter.messagebox
def main():

    gui()
    tkinter.mainloop()

def gui():
    main_window = tkinter.Tk()
    top_frame = tkinter.Frame()
    mid_frame = tkinter.Frame()
    bottom_frame = tkinter.Frame()

    main_window.title("Palindromdetektor")
    main_window.geometry("400x400")

    label1 = tkinter.Label(top_frame, text = "Skriv in ett palindrom nedan för att testa det!",
                                bg = "green", width = 60, height = 6)
    button1 = tkinter.Button(mid_frame, text = "Testa palindrom", height = 3, width = 22,
                                bg = "Purple", command = mainaction) 

    button2 = tkinter.Button(bottom_frame, text= "Instruktioner", height = 3, width = 22,
                                bg = "Purple", command = messagebox) 

    button3 = tkinter.Button(bottom_frame, text ="Spara palindrom", height = 3, width = 22,
                                bg = "Purple") #command = sparapalindrom) 

    button4 = tkinter.Button(bottom_frame, text ="Avsluta programmet", height = 3, width = 22,
                                bg = "Purple", command=main_window.destroy)

    palindromentry = tkinter.Entry(mid_frame, width = 67)
    palindromentry.pack()

    top_frame.pack()
    mid_frame.pack()
    bottom_frame.pack()

    label1.pack()
    button1.pack()
    button2.pack()
    button3.pack()
    button4.pack()

def ordnaText(text):
        nytext = ("") 
        fixadText = text.lower() 
        for i in fixadText: 
            if i.isalnum(): 
                nytext = (nytext + i) 
        return nytext 

def testap(nytext):
        palindrom  = True 
        for i in range (0, len(nytext)):
            if (nytext[i]) != (nytext[len(nytext)-i-1]): 
                palindrom = False 
        return palindrom

def visaResultat(palindrom):
    if palindrom:
            label1.config(text="Ja, detta är ett palindrom!", bg="green")
    else:
            label1.config(text="Nej, detta är inte ett palindrom!", bg="red")

def messagebox():
        tkinter.messagebox.showinfo("Hjälp", "Detta är ett program som testar vare sig en text är ett palindrom eller inte.\n \
Skriv in din text i rutan och tryck på Testa Palindrom-knappen så får du se ditt resultat högst upp.\n \
Om du vill avsluta programmet klickar du på knappen som heter Avsluta programmet.\n \
Detta program är kodat av Olof Unge som nås via mail: olofunge@hotmail.com.\n \
Tack för att du använder detta program!")

#def sparapalindrom():
 #   try:
  #      if palindrom:
   #         myfile = open("palindrom.txt", "a")
    #        myfile.write(text\n)
     #       myfile.close()
      #  else:
       #     label1.config(text="Du kan bara spara godkända palindrom.")
    # except IOError:
     #   label1.config(text="Kunde inte hitta / skapa filen.")

def mainaction():
    global text
    text = palindromentry.get()
    ordnaText(text)
    testap(ordnaText(text))
    visaResultat(testap(ordnaText(text)))

main() 
```

如果您能坚持主题而不发表任何评论，我将非常感激，因为其他一切都很好。非常感谢！

此致。

这是在 Python 3.0 中编码的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:17:58.533

`palindromentry`在`gui`函数中定义。因此，它的范围仅限于该单一功能。当您单击按钮时，该函数被调用，但它对函数的范围`mainaction`一无所知。`gui`

这里有几个选项（按我的喜好排序）：

1.  使所有这些东西成为一个类，以便您可以在函数调用之间共享状态
2.  将定义移动`mainaction`到`gui`函数中（它需要在执行操作的按钮之前定义......）。
3.  声明回文`global`如`gui`

# unit-testing - 在 gmock/gtest 中包装常见的模拟函数

> ID：14199589
> 
> 赞同：0
> 
> 时间：2013-01-07T16:04:58.597
> 
> 标签：unit-testing, googletest, gmock

在我的 gtest 框架中，我模拟了一些函数并编写了一些测试用例。而且我看到我在许多测试用例中一遍又一遍地使用相同的模拟函数和 EXPECT_CALL。所以，我只是想知道我是否可以将这些常见的模拟 EXPECT_CALL 放在一个地方并简单地调用它们，这样行数就会变得更少，并且测试用例看起来更简单。

我尝试将它们放在一个函数中并尝试调用该函数，但它给了我很多编译问题。任何人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-28T22:22:37.520

`EXPECT`调用需要在测试用例或测试夹具内。您可以使用测试夹具获得您想要的结果。

```
class MyTest : public ::testing::test
{
    MyTest // can use ctor
    {
        EXPECT_CALL(mock, ...);
    }

    SetupA()  // or can use a member function
    {
        EXPECT_CALL(mock, ...);
        EXPECT_CALL(mock, ...);

    }

    MockObject mock;
};

TEST_F(MyTest, TestOne)
{
    EXPECT_CALL(mock, ...);
    // do something - two expectations are set
}

TEST_F(MyTest, TestTwo)
{
    SetupA();
    // do something - three expectations are set
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T10:02:13.140

[从相对于 GTest](http://code.google.com/p/googlemock/wiki/ForDummies#Using_Mocks_in_Tests)的Google Mock 文档中，无法将 EXPECT_CALL 宏委托给函数。

更确切地说，

> 重要提示：Google Mock 要求在调用模拟函数之前设置期望值，否则行为未定义。特别是，您不能将 EXPECT_CALL() 和对模拟函数的调用交错。

# haskell - 撤消数据库中的记录

> ID：14199590
> 
> 赞同：1
> 
> 时间：2013-01-07T16:05:03.223
> 
> 标签：haskell, functional-programming

我正在创建一个需要存储用户在数据库中运行的所有函数和参数的系统。没有记录被删除，但我需要能够重新创建最小的函数序列和参数集以进行确定性重新生成。

用户交互非常少，他们不是编程 - 输入交互在 C++ 中处理，通过 FFI 作为数据传递到列表中并回调以处理当前数据缓冲区。该函数触发一系列关于如何连接数据库中数据集的处理图以及它们被输入到的函数的决策。该图是非循环的。该图最初是运行的，并且值是为用户可视化的。图的后面部分将被重新组合以生成新的图。

这些图的 Haskell 内部结构是通过分析数据库中的数据和组合之间的简单随机选择创建的。我希望能够只存储随机生成器的种子、它适用的模块和参数 id。

我认为这可能最好将 EDSL 的功能存储在数据库中，其中仅存储高级交互，但具有完全确定性。

我对存储值不感兴趣，而是对动作的函数图感兴趣。

每个表指的是不同的功能。每条记录都有一个日期和一个任务 ID，以将特定操作的所有功能组合在一起。参数引用表 ID 和记录 ID。如果组合函数在内部执行诸如生成随机数之类的操作，则应自动存储该数字的种子。

我正在使用没有 GHCI 和 Persistent SQlite 的 GHC 阶段 1。

我还是 Haskell 的新手，我正在寻找适合以功能方式解决此问题的方法和软件包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T18:37:19.677

如果您想对源级函数执行此操作，例如：

```
myFoo x y = x + y 
```

除非您想在编译器中四处乱窜，否则您几乎不走运。但是，您可以使用一些合适的注释定义自己的支持此功能的函数概念。让我们将此概念称为 a `UserAction a`，其中`a`是操作的返回类型。为了在 中组合计算`UserAction`，它应该是`Monad`. 不用想太多，我的第一印象是使用这堆 monad 转换器：

```
type UserAction = WriterT [LogEntry] (ReaderT FuncIdentifier IO) 
```

该`WriterT [LogEntry]`组件表示 a`UserAction`运行时会生成一个 s [1] 序列`LogEntry`，其中包含您要写入数据库的信息；就像是：

```
data LogEntry = Call FuncIdentifier FuncIdentifier 
```

现在可以推迟存储随机种子、任务标识符等——可以通过将信息添加到`LogEntry`.

该`ReaderT FuncIdentifier`组件说 a`UserAction`取决于 a `FuncIdentifier`; 即，调用它的函数的标识符。

`FuncIdentifier`可以通过简单的东西来实现

```
type FuncIdentifier = String 
```

或者，如果您愿意，可以使用具有更多结构的东西。

该`IO`组件表示`UserAction`s 可以对文件、控制台、生成线程等进行任意输入和输出。如果您的操作不需要它，请不要使用它（`Identity`改为使用）。但是由于您提到生成随机数，我认为您并没有考虑纯粹的计算[2]。

然后，您将使用以下函数注释要记录日志的每个操作：

```
userAction :: FuncIdentifier -> UserAction a -> UserAction a 
```

这将像这样使用：

```
randRange :: (Integer, Integer) -> UserAction Integer
randRange (low,hi) = userAction "randRange" $ do
    -- implementation 
```

`userAction`将记录通话并设置其被叫者记录他们的通话；例如：

```
userAction func action = do
    caller <- ask
    -- record the current call
    tell [Call caller func]
    -- Call the body of this action, passing the current identifier as its caller.
    local (const func) action 
```

从顶层运行所需的操作，完成后，收集所有`LogEntry`s 并将它们写入数据库。

如果您需要在代码执行时实时编写调用，则需要一个不同的`UserAction`monad；但您仍然可以呈现相同的界面。

这种方法使用了一些中间的 Haskell 概念，例如 monad 转换器。我建议在 IRC 上`irc.freenode.net` `#haskell`寻求有关填写此实施草图细节的指导。他们是一群善良的人，很乐意帮助您学习:-)。

[1] 在实践中，您不想使用`[LogEntry]`而是`DList LogEntry`为了性能。但是更改很容易，我建议您继续使用，`[LogEntry]`直到您对 Haskell 更加熟悉，然后切换到`DList`.

[2] 随机数生成可以纯粹完成，但它需要进一步的大脑重新布线，这个草图已经有很多了，所以我建议把它当作一个`IO`效果来开始。

# r - foreach %dopar% 使用带有 PSock 集群的顺序工作程序设置？

> ID：14199593
> 
> 赞同：9
> 
> 时间：2013-01-07T16:05:05.423
> 
> 标签：r

**问题**

我注意到 foreach/%dopar% 在并行执行任务之前执行*顺序*，而不是集群的并行*设置*。如果每个工作人员都需要一个数据集，并且需要 N 秒将数据集传输给工作人员，那么 foreach/%dopar% 会花费`#workers * N seconds`设置*时间*。这对于大量工作人员或大量 N（要传输的大型数据集）来说可能很重要。

我的问题是这是设计使然，还是我在 foreach 或集群生成中缺少某些参数/设置？

**设置**

*   R 2.15.2
*   截至今天（2013 年 1 月 7 日）的最新版本的 foreach/parallel/doParallel
*   视窗 7 x64

**例子**

```
library( foreach )
library( parallel )
library( doParallel )

# lots of data
data = eval( rnorm( 100000000 ) )

# make cluster/register - creates 6 nodes fairly quickly
cluster = makePSOCKcluster( 6 , outfile = "" )
registerDoParallel( cluster  )

# fire up Task Manager.  Observer that each node recieves data sequentially.
# When last node gets data, then all nodes process at the same time
results = foreach( i = 1 : 500 )  %dopar%
{
    print( data[ i ] )
    return( data[ i ] )
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T03:57:51.573

感谢Revolution Computing 的Rich 提供的帮助......

`clusterCall`使用 for 循环向每个工作人员发送数据。因为 R 不是多线程的，所以 for 循环必须是顺序的。

有一些解决方案（这需要有人对其进行编码）。R 可以调用 C/C++ 来线程化 worker 设置。或者工作人员可以从磁盘上的文件中提取数据。或者工作人员可以在同一个套接字上侦听，而主服务器可以只向套接字写入一次并将数据广播给所有工作人员。

# javascript - 使用正则表达式为每一行添加部分标题

> ID：14199600
> 
> 赞同：2
> 
> 时间：2013-01-07T16:05:39.263
> 
> 标签：javascript, regex, perl, vim

我有以下格式的文本文件

```
[Section1]
property1 = value1
property2 = value2

[Section2]
property1 = value1
property2 = value2 
```

一个例子

```
[Section foo]
foo = 1
bar = "whatever" 
```

有什么方法可以像这样使用正则表达式将部分标题添加到每一行

```
Section1: property1 = value1
Section1: property2 = value2

Section2: property1 = value1
Section2: property2 = value2 
```

**更新**

我没有包括编程语言或工具，所以这里有一个可能性列表

1.  JavaScript
2.  Perl
3.  虚拟机

接受任何其他建议，包括非正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:13:10.447

是的，你可以这么做。首先，您必须捕获以下正则表达式

```
\[(Section\d+)\]\n(.+?\n)|(?:.*?\n)\[Section\d+\] 
```

它应该捕获您的部分标签，以及您想要应用它的所有行。之后，应该是简单的搅拌连接

**正则解释**

```
()     : a capturing group  
(?:..) : non-capturing group  
\d+    : 1 or more digits  
.+?\n  : 1 or more characters and newline(the '?' means it's non-greedy)  
.*?\n  : 0 or more characters and newline 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T10:40:38.650

这是一个 Vim 解决方案 - 只需打开文件并运行以下命令：

```
:g/^\[.*\]$/ s/^\[// | s/\]$/:/ | d | ,/\n$/ normal PJ 
```

这将选择部分标题行，将每一行转换为所需的形式，以便为该部分中的其他行添加前缀，删除标题行，并将其插入到该部分中所有其他行的开头。

详细地：

*   `:g//`选择文件中与模式匹配的行并将以下命令应用于每一行。在这种情况下，模式匹配 begin`[`和 end的行`]`。
*   第一个`:s///`删除开头`[`，第二个将关闭更改`]`为 a `:`。没有必要添加尾随空格，因为加入行（见下文）会做到这一点。
*   `|`s 分隔多个命令，允许在`:`初始`:g//`.
*   删除该`:d`行。这也将其存储在可以粘贴的寄存器中。这意味着“当前”行现在是该部分中的第一个属性行。
*   前缀需要添加到该部分的所有行中。`,`定义一个范围。
*   范围的开始是当前行。这是默认设置，因此在`,`.
*   范围中的最后一行是空行（或文件末尾）之前的行。这需要检查被考虑为范围结束的行之后的行。这样`\n`做，匹配行尾的换行符并将模式通过它，到下一行（如果有的话）。如果该点是与 匹配的行尾`$`，则后面必须有一个空行（因为紧跟在 之后还有另一个行尾`\n`）或者我们在文件的末尾。
*   所以`,/\n$/`定义了需要前缀的行的范围。
*   `:put!`将在当前行上方插入最近删除的行，使刚刚插入的行成为当前行，然后`:join`将该行与下一行连接，在它们之间插入一个空格。我们希望对范围内的每一行都这样做。
*   但`:put`不占用范围，只是一条线。通常，将命令应用于范围内的每一行都会使用`:g//`. 但是这里我们已经在一个`:g//`命令中，它们不能嵌套。
*   幸运的是`:normal`，将指定的正常模式击键应用于范围内的每一行。`P`在普通普通模式下按与命令`:put!`相同，与`J`相同`:join`。
*   所以`,/\n$/ normal PJ`说，对于从当前行到空行（或文件末尾）之前的每一行，将最近删除的前缀粘贴在其上方，然后将现有行连接到前缀的末尾。
*   `:normal`后面不能跟另一个命令，因为任何命令`|`都会被解释为正常模式的击键而不是命令分隔符。因此，通常`:normal`在命令序列中使用需要将其包装在`:exe`. 但在这种情况下，这`:normal`是我们最不想做的事情，所以它可以保留在命令的末尾。
*   一旦上面的内容转换了第一部分，Vim 就会移动到它匹配的第二部分标题`:g//`并再次执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:59:22.947

这可以通过单线来完成：

```
perl -F"\n" -00 -anwE '$h = shift @F; 
                       $h =~ s/^\[|\]$//g; 
                       say "$h: $_" for @F; 
                       say $/;' paragraph.txt 
```

使用这段代码，我们使用段落模式从文件中读取行块，在换行符上自动拆分每个块，然后取出块的第一行，清理它并将其用作生成的 print ( `say`) 中的标题。

*   `-00`将输入记录分隔符设置为空字符串以启用段落模式，即阅读直到下一个双换行符。
*   `-a`将每行输入自动拆分为`@F`
*   `-F`switch 允许我们将换行符设置为自动拆分的分隔符
*   `-E`喜欢`-e`但启用功能，例如`say`

代码在脚本形式中如下所示：

```
use warnings;
use strict;

$/ = "";                      # paragraph mode, read until "\n\n"
use feature 'say';            # enable 'say'
while (<>) {                 
    my @F = split /\n/;       
    my $h = shift @F;         
    $h =~ s/^\[|\]$//g;       # clean up lines
    say "$h: $_" for @F;      
    say $/;                   # print paragraph ending 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:47:30.887

此正则表达式捕获 group 中的值：

```
\[(?<Section>.*?)\]\r\n(?<p1>property\d)\s=\s(?<v1>value\d)\r\n(?<p2>property\d)\s=\s(?<v2>value\d) 
```

这个用于替换前面的捕获：

```
${Section} : ${p1} = ${v1} 
${Section} : ${p2} = ${v2} 
```

Expresso 工具中的结果是：

> 第 1 节：属性 1 = 值 1第 1
> 节：属性 2 = 值 2
> 
> 第 2节：属性 1 = 值 1
> 第 2 节：属性 2 = 值 2

必须对其进行优化以使其通用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T16:49:33.090

试试这个 Perl 单行代码：

```
perl -n -wE 'if (/^\[(\w+)\]$/) { $section = $1; } else { s/^(?=\S)/$section: /; print; }' yourfile.txt 
```

`-n`make一次处理文件的`perl`每一行。如果该行看起来像一个节标题，那么它将存储节名称以供将来使用。否则，它将先前存储的部分名称附加到以可打印字符开头的任何行，然后打印该行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T17:54:40.270

这是从命令行运行的另一个选项`perl <scriptName> <dataFile>`：

```
use warnings;
use strict;

my $section;
while (<>) {
    if (/^\[(Section[^\]]*)\]$/) {
        $section = $1;
        next;
    }
    print /\S/ ? "$section: $_" : $_;
} 
```

# javascript - UIWebView 全局 javascript 变量不起作用

> ID：14199605
> 
> 赞同：1
> 
> 时间：2013-01-07T16:05:57.460
> 
> 标签：javascript, ios, uiwebview

我在我的 iOS 项目中嵌入了一些 html 和 js 文件，以查找搜索文本的下一个和上一个出现，在浏览器中同样有效，在 iOS 中无效，我从下面的链接中获得了相同的代码。调试后我发现我的变量在函数调用之间没有保存值。

```
var currSelected = 0;

function jump(howHigh){

    prevSelected = currSelected;
    currSelected = currSelected + howHigh;
    alert("currSelected" + currSelected); //currSelected is always 1 
 } 
```

[http://jsfiddle.net/TAxdp/](http://jsfiddle.net/TAxdp/)

请参考上面的 url 以了解我在 UIWebView 中尝试完成的工作。

请建议 UIWebView 中的 iOS 工作。

谢谢 djrecker

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T03:42:59.667

您可以这样做以使变体全局化：

1）在js文件中

```
function test(){
    alert(i++);
} 
```

2）在.m文件中

```
//call before function 'do'
- (void)makeVariantGlobal {  
    [self.webView stringByEvaluatingJavaScriptFromString:@"var i=0"];
}

//i++ works!
- (void)do {
    [self.webView stringByEvaluatingJavaScriptFromString:@"test()"];
} 
```

# node.js - 如何压制 Node JS 的控制台日志以获取请求？

> ID：14199606
> 
> 赞同：0
> 
> 时间：2013-01-07T16:06:02.997
> 
> 标签：node.js

我不想在测试时看到服务器收到的每个请求的日志（这使得读取结果变得更加困难）。有没有一种简单的方法来启动 Node 让它不会那样做？

我指的是看起来像这样的线条，只是为了非常清楚：

```
127.0.0.1 - - [Mon, 07 Jan 2013 15:59:52 GMT] "GET / HTTP/1.1" 200 1039 "-" "Mozilla/5.0 Chrome/10.0.613.0 Safari/534.15 Zombie.js/1.4.1" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:23:25.280

NodeJS 不会自动执行此操作。

假设您正在使用`express`，则需要删除`logger`中间件。删除这一行：

```
app.use(express.logger()); 
```

# oracle - Oracle 错误：不是有效的函数或过程名称

> ID：14199612
> 
> 赞同：0
> 
> 时间：2013-01-07T16:06:19.623
> 
> 标签：oracle, function

我在尝试在 Oracle 11.2.0.1.0 中启动和运行某些功能时遇到了一些重大问题

下面的这个函数并不完整——但此时我只是想让它编译/执行/调用没有任何问题。

这是我所拥有的：

```
CREATE OR REPLACE FUNCTION "MYTABLE"."TMP_TEST" return number
is 
f_qtr (4,0);

begin

UPDATE "MYTABLE".FOO  SET BAR = 555
where FOOBAR = 3;
f_qtr: =1;
return (f_qtr); 
```

然后我登录到 SQL Plus 并执行以下操作

```
call MYTABLE.TMP_TEST; 
```

我得到了以下信息

```
ERROR at line 1:
ORA-06576: not a valid function or procedure name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:17:11.193

您想使用如下变量：

```
var a number
exec :a := TMP_TEST
print a 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:21:29.640

你也可以这样做：-

```
select TMP_TEST from dual; 
```

或者如果要将输出保存在变量中，也可以使用 SELECT ... INTO ....

# ios - FileExistAtPath 在模拟器上工作，但不在设备上

> ID：14199613
> 
> 赞同：0
> 
> 时间：2013-01-07T16:06:21.770
> 
> 标签：ios, objective-c, cocoa-touch, plist, nsfilemanager

在我的游戏中，我将玩家的统计数据保存在我存储在 Documents 目录中的 plist 中。我有一个应该保存的每个统计信息的空字典，命名为“Default_Stats.plist”，这样如果这是第一次加载应用程序，它会将其复制到适当的目录中，以便可以随意加载和覆盖。问题是，每次加载我的应用程序时，它都无法识别“Stats.plist”并用默认统计数据覆盖它，重置玩家所做的每个统计数据......而且很奇怪，它完美地工作在模拟器，但不在设备上。这是我的代码：

在这种方法中，我**阅读**了统计数据：

```
- (void) readStatsFromFile{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *statsPath = [[paths objectAtIndex:0] stringByAppendingPathComponent:@"Stats.plist"];

    //Check if the file has already been created
    if (![[NSFileManager defaultManager] fileExistsAtPath:statsPath]){
        [self createStatsList];
    }else{
        stats = [[NSMutableDictionary dictionaryWithContentsOfFile:statsPath]retain];
    }
} 
```

这是我的**创建**方法：

```
- (void) createStatsList{
    NSString *statsPath = [[NSBundle mainBundle] bundlePath];
    statsPath = [statsPath stringByAppendingPathComponent:@"Default_Stats.plist"];

    stats = [[NSMutableDictionary dictionaryWithContentsOfFile:statsPath] retain];

    [self writeStatsToFile];
} 
```

还有我的**写作**方法：

```
- (void) writeStatsToFile{
    BOOL ok;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *statsPath = [[paths objectAtIndex:0] stringByAppendingPathComponent:@"Stats.plist"];
    ok = [stats writeToFile:statsPath atomically:YES];

    if (!ok) {
        NSLog(@"Couldn't write to file");
    }else
        NSLog(@"Stats written succesfully!");
} 
```

请帮忙，我真的不明白这是怎么回事！我希望我已经把自己说得够清楚了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:38:51.603

也许你的mac中存在重复，这使得exists=true在模拟器上，而不是在设备上。

最简单的检查方法是 NSLog 遇到的路径。请参阅[这些工具](http://www.apple.com/support/iphone/enterprise/)- 它们允许为在您的设备上运行的发布版本捕获控制台日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:08:12.930

使用文件路径而不是绝对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-18T09:39:25.230

我会做很多事情，就像一个会话中的所有内容一样：

1.  获取*Document*`URL`文件夹中的文件；
**   如果文件还没有，则将文件从*bundle*复制到*Documents*文件夹；*

 ** * *

那应该是方法，我已经定义了一些宏来避免在代码中输入错误的文件名：

```
- (NSURL *)statsFileURL {
#define NSStringFromFileNameWithExtension(filename, extension) [(filename) stringByAppendingPathExtension:(extension)]
#define kExtension @"plist"
#define kDefaultStatsFileName @"Default_Stats"
#define kCustomStatsFileName @"Stats"

    NSURL *_returnURL = nil;

    NSFileManager *_fileManager = [NSFileManager defaultManager];
    NSURL *_documentDirectory = [[_fileManager URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
    NSURL *_myFileURLInDocumentFolder = [_documentDirectory URLByAppendingPathComponent:NSStringFromFileNameWithExtension(kDefaultStatsFileName, kExtension)];
    if ([_fileManager fileExistsAtPath:[_myFileURLInDocumentFolder path]]) {
        _returnURL = _myFileURLInDocumentFolder;
    } else {
        NSURL *_myFileURLInBundle = [[NSBundle mainBundle] URLForResource:kDefaultStatsFileName withExtension:kExtension];
        if ([_fileManager fileExistsAtPath:[_myFileURLInBundle path]]) {
            NSError *_error = nil;
            if ([_fileManager copyItemAtURL:_myFileURLInBundle toURL:_myFileURLInDocumentFolder error:&_error]) {
                if (_error == nil) {
                    _returnURL = _myFileURLInDocumentFolder;
                } else {
                    // some error during copying
                }
            } else {
                // some error during copying
            }
        } else {
            // the file does not esixts at all, not even in the bundle
        }
    }

    return _returnURL;
} 
```

`URL`总是指向*Documents*文件夹内，因此您将具有对该文件的读/写访问权限 - 或者如果`nil`发生某些错误。

拥有 之后`URL`，您可以毫无问题地恢复到文件，并且在运行时的其他某个时间点，您可以随时覆盖该文件以方便您使用。

* * *

*注意：您可能需要扩展此代码以进行更详细的错误处理，我只在您需要担心潜在错误的地方添加注释。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-18T09:28:30.313

很可能您的文档目录不存在 - 在模拟器上，您与 Mac 上的每个人共享一个文档目录；在设备上，每个人都有自己的目录。使用文件管理器方法

```
createDirectoryAtURL:url withIntermediateDirectories:YES 
```

在您尝试在那里写入之前确保该目录存在。（我倾向于使用 URL 方法而不是文件路径方法）。

PS。我建议使用*一种*方法来返回您想要的路径或 url。不要一次又一次地重复你的代码是一个好习惯。*

# java - 如何将可配置的 xml 数据类型和数据移动到 oracle 数据库

> ID：14199616
> 
> 赞同：0
> 
> 时间：2013-01-07T16:06:33.463
> 
> 标签：java, xml, database, oracle, database-design

我正在处理一个遗留的 web 应用程序，每次 UI 发生变化时，它通过使用 castor 编组/解组 xml 文件来对各种数据类型进行 CRUD。数据类型是可配置的，因此通过修改 xml 配置文件，您可以添加具有自定义属性的新自定义数据类型。添加的每个新的自定义数据类型都会产生一个额外的 xml 文件。例如配置文件片段`

```
<group name="x">
    <my_attribute name="a1">
        <field name="id">
            <display_name>ID</display_name>
            <type>String</type>
            <nullable>false</nullable>
            <default_value/>
            <minimum_boundary/>
            <maximum_boundary/>
            <editable>false</editable>
        </field>
        <field name="name">
            <display_name>Name</display_name>
            <type>String</type>
            <nullable>false</nullable>
        </field> 
```

...ETC。

例如数据文件片段

`

```
<display-name>a1</display-name>
<values xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" timestamp="1357573081953" xsi:type="java:com.xxx">
    <id>blab1</id>
    <name>blab1name</name>
</values> 
```

`

其中一些数据需要由第二个应用程序读取，因此将 xml 文件的子集放入一个 zip 文件并存储在 oracle db 中的 blob 中。它们随后被第二个应用程序解压缩到文件并读取。现在应用程序已经发展到变得更加复杂，存在对第一个应用程序中数据的并发修改的担忧，并且客户端只想在 oracle db 中管理这些数据（使用可定制的类型）而不使用文件系统。做这个的最好方式是什么？哪些技术是好的候选者？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:15:54.137

第一个想法是使用二进制存储（从 11g 开始）将所有 xml 存储为 oracle xmltype，并且每次只需读取/写入整个 xml 块，利用 oracle 的优化......每个属性名称都将是主要的一部分关键... 这确实需要指定数据大小和 NFR 以确定理想的解决方案，但在此阶段需要考虑所有选项。

# jquery - 工具提示关闭时触发回调

> ID：14199617
> 
> 赞同：2
> 
> 时间：2013-01-07T16:06:40.580
> 
> 标签：jquery, twitter-bootstrap, tooltip

我正在使用 twiiter-bootstrap 的[工具提示](http://twitter.github.com/bootstrap/javascript.html#tooltips)，我想触发一个 ajax 请求，或者在工具提示关闭时说一个警报框。jQuery代码是：

```
$(document).ready(function(){
        $('#explore').tooltip({
                content : "hi there",
                placement : 'bottom',
    });
}); 
```

我还尝试了其他插件，例如 jquery 的[工具提示](http://jqueryui.com/tooltip/#default)和 craigworks 的[qtip](http://craigsworks.com/projects/qtip2/)，但我无法找到在工具提示关闭时触发回调的方法。

即使工具提示不能支持这一点，我可以使用引导程序的弹出窗口或其他一些解决方法吗？

**我想要实现的是：** 我有一个带有按钮的 div。如果用户单击该按钮，按钮旁边会出现一个小对话框，询问其他信息。用户可以 (1) 忽略它并单击屏幕上的任何其他位置以关闭对话框 (2) 通过单击“关闭”按钮关闭对话框 (3) 提交问题的答案以关闭对话框

在所有 3 种情况下，我希望将 div 替换为另一个 ajax 获取的内容。如果工具提示有回调，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:12:29.570

似乎没有本地方法可以通过 执行此操作`.tooltip`，但您可以选择触发工具提示显示的内容，以便您可以将自己的事件绑定到相反的事件。默认（您正在使用的）是`'hover'`：

```
$("#explore").tooltip().on('mouseout', function () { alert('left tooltip'); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T05:51:52.723

我能够使用 Craig 的[qtip](http://craigsworks.com/projects/qtip2/)使用`events`插件的属性来解决这个问题：

```
$(document).ready(function(){
    $('.overlay-seen-it').qtip({
        overwrite: false,
        content: {
        text: "Hi there"
        },
        show: {
        event: 'click',
        solo: true
        },
        hide:{
        event: 'unfocus'
        },
        events:{
            hide: function(event, api){
            var movie=api.elements.target.closest('.movie');
                movie.fadeOut(500, function(){
                    $.get('reco_product_stream.jsp?type=replace', function(data) {
                        var $a = $(data).find('a'); 
                        movie.children('a').replaceWith($a);
                        movie.fadeIn(500);
                    });             
                });                     
            }
        }
    });
}); 
```

`events:hide`当 qtip 关闭时，属性中列出的任何函数都会触发。克雷格[在这里](http://craigsworks.com/projects/forums/thread-solved-firing-event-from-qtip)解决。

# iphone - 将全局字典添加到 AppDelegate 与单例类

> ID：14199632
> 
> 赞同：2
> 
> 时间：2013-01-07T16:07:32.540
> 
> 标签：iphone, ios

我看到建议在单例类而不是 AppDelegate 中定义全局数据（即 NSArray 或 NSDictionary）。

为什么是这样？

谢谢，弗兰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:11:54.433

AppDelegate 特定于您正在处理的项目。如果您决定启动您正在开发的应用程序的新版本，或者（更有可能）将其从 iOS 等移植到 Mac...

AppDelegate 将保持原样。

通过将这样的全局信息放入单例中，您可以创建一个独立于运行它的应用程序的类。

此外，您最好不要在 AppDelegate 中保留 App 特定的东西（如 applicationWillEnterBackground），并且不想用其他东西堵塞它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:27:38.550

如果您打算为代码创建单元测试，则应避免使用全局单例，因为它们会使您的代码更难测试。同样，根据我的经验，具有暴露的`NSArray`或`NSDictionary`用于此类值的代码很容易很快出现错误。

我发现一个有用的设计模式是实际创建一个配置或全局值对象，其中包含您想要的所有属性。通常，此类包装`NSArray`or `NSDictionary`，您可以从 plist 文件中加载它。该对象可以在 AppDelegate 中实例化，然后在您实例化视图控制器和其他对象时传递。这更易于测试，因为您可以轻松地在测试中模拟配置对象。

从 plist 文件加载此类配置对象时的外观示例：

界面：

```
@interface ConfigManager : NSObject {

}
@property (readonly) NSString* masterUser;
@property (readonly) UIImage* masterUserImage;

@end 
```

然后在.m

```
@interface ConfigManager ()
@property (strong) NSDictionary* configDict;

@end

@implementation ConfigManager

-(id)init {

    self = [super init];

    if ( self ) {
        NSString *pathStr = [[NSBundle mainBundle] pathForResource:@"AppConfig" ofType:@"plist"];
        NSData *plistData = [NSData dataWithContentsOfFile:pathStr];
        NSString *error = nil;
        NSPropertyListFormat format;

        self.configDict = (NSDictionary*)[NSPropertyListSerialization propertyListFromData:plistData mutabilityOption:NSPropertyListImmutable format:&format errorDescription:&error];

        if(nil == self.configDict || nil != error ) {
            NSLog(@"%@",error);

            return nil;
        }   

    }

    return self;
}

-(NSString*)masterUser {
    return [self.configDict objectForKey:@"masterUser"];
}

-(UIImage*)masterUserImage {
    NSString* imageName = [self.configDict objectForKey:@"masterUserImage"];

    return [UIImage imageNamed:imageName];
} 
```

当然，更改对象的属性以满足您的需要。这种方法的好处是，您可以在处理应用程序的全局配置所需的通用代码（例如加载图像）时实现。这有助于防止由于在整个代码库中一遍又一遍地复制相同的代码而导致的一类常见错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:41:58.370

我不认为 Singeltons 是一个好的解决方案，我更喜欢将应用程序全局变量更好地保存在一个诚实的全局可访问类上，比如 AppDelegate。

18 年前，单例构造被认为是一种设计模式，但后来 Erich Gamma 意识到，将这种模式添加到他的“设计模式 - 可重用面向对象软件的元素”一书中是一个坏主意。

今天在像 java 这样的现代语言中，Singeltons 是邪恶的，因为一旦它们被初始化就无法删除它们，从而严重干扰了单元测试。所以至少在java中使用单例时它更有可能有一个糟糕的设计。老实说，如果你有一个全局对象，那么就这样处理它，不要将它隐藏在伪全局元素后面。

然而，Objective-C 没有虚拟机，因此单例可能不会影响单元测试，（我对此不确定）。
如果它们不影响单元测试，Singleton 有时使用起来很方便，例如 [NSFileManager defaultManager]。
但我不会将 NSArray 或 Dictionary 存储到单例中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:11:39.873

这样您就不会弄乱 AppDelegate。大多数 AppDelegate 就像全球数据的厨房水槽。一切都被扔在那里。使用单例（或者如果 ARC 则只是一个常规类）将您的真实全局数据与基本 AppDelegate 函数分开。

# silverlight - 如何知道域上下文 SubmitChanges 的更新顺序？

> ID：14199634
> 
> 赞同：1
> 
> 时间：2013-01-07T16:07:39.367
> 
> 标签：silverlight, entity-framework, wcf-ria-services, silverlight-5.0, entity-framework-5

假设我有 3 个从 EF 生成的实体，例如 tab1、tab2 和 tab3。在 SL 应用程序中，我调用 SubmitChanges 将数据保存到 DB，所有更改将由 WCF 和 EF 自动处理。

问题是：如何知道数据库中更新操作的顺序？

我需要知道这一点，因为我在这些表上有触发器并且需要知道更新的顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:08:15.897

您可以做的一件事是覆盖您的 DomainService 中的 PeristChangeSet() 并手动控制保存的顺序。在您的常规更新/插入语句中什么都不做。这是一些用于保存文档示例的伪代码来解释我的答案：

```
[Insert]
public void InsertDocument(MyDocument objDocument) { }

[Update]
public void UpdateDocument(MyDocument objDocument) { }

protected override bool PersistChangeSet()
{
    try {
        // have to save document first to get its id....
        MyDocument objDocumentBeingSaved = null;
        foreach (ChangeSetEntry CSE in ChangeSet.ChangeSetEntries.Where(i => i.Entity is MyDocument)) {
            var changedEntity = (MyDocument)CSE.Entity;
            objDocumentBeingSaved = documentRepository.SaveDocument(changedEntity);
            break; // only one doc
        }

        if (objDocumentBeingSaved == null)
            throw new NullReferenceException("CreateDocumentDomainService.PersistChangeSet(): Error saving document information. Document is null in entity set.");

        // save document assignments after saving document object
        foreach (ChangeSetEntry CSE in ChangeSet.ChangeSetEntries.Where(i => i.Entity is DocumentAssignment)) {
            var changedEntity = (DocumentAssignment)CSE.Entity;
            changedEntity.DocumentId = objDocumentBeingSaved.Id;
            changedEntity.Id = documentRepository.SaveDocumentAssignment(objDocumentBeingSaved, changedEntity);
        }

        // save line items after saving document assignments
        foreach (ChangeSetEntry CSE in ChangeSet.ChangeSetEntries.Where(i => i.Entity is LineItem)) {
            var changedEntity = (LineItem)CSE.Entity;
            changedEntity.DocumentId = objDocumentBeingSaved.Id;
            changedEntity.Id = documentRepository.SaveLineItem(objDocumentBeingSaved, changedEntity);
        }
        documentRepository.GenerateDocumentNumber(objDocumentBeingSaved.Id);
    }
    catch {
        // ....
        throw;
    }
    return false;
} 
```

# javascript - JavaScript 设置四位

> ID：14199635
> 
> 赞同：2
> 
> 时间：2013-01-07T16:07:45.160
> 
> 标签：javascript, node.js, bit-manipulation, bitwise-operators, bit

我得到以下位模式：

```
1000 0001 (129) 
```

我现在想设置最后四位（1 - 10, 0x1 - 0xA）：

```
1000 0010 
```

或者

```
1000 1000 
```

我实际上不知道如何做到这一点。我可以读出前四位：

```
var buff = new Buffer(1);

buff[0] = 129;

var isFirstBitSet = (buff[0] & 128) == 128;
var isSecondBitSet = (buff[0] & 64) == 40;
var isThirdBitSet = (buff[0] & 32) === 32;
var isFourthBitSet = (buff[0] & 16) === 16;

var buff[0] = 0xA;

if (isFirstBitSet) {
    buff[0] = buff[0] & 128;
} 
```

然后映射到一个新的，但我认为这是自我解释，这是废话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T16:10:09.013

您可以设置整数的低四位，方法是先将整数与整数进行与运算`0xfffffff0`，然后将其与四位值进行或运算。

```
function setLowFour(n, lowFour) {
  return (n & 0xfffffff0) | (lowFour & 0xf);
} 
```

请注意，JavaScript 并没有真正的整数类型。按位运算强制值是整数，但它们实际上仍然存储为浮点数。

*编辑*——我认为它实际上也可以工作 :-)`setLowFour(1025, 12)`返回 1036。单元测试怎么样？

# c# - 动态透视未知数据

> ID：14199636
> 
> 赞同：1
> 
> 时间：2013-01-07T16:07:56.320
> 
> 标签：c#, sql-server, linq, asp.net-mvc-4, lambda

尝试在 C#/MVC4 中使用 LINQ 或 LAMBDA 对**动态**数据进行透视，并且几乎得出结论，这很难做到。

这基本上是我想要做的： ![枢](../Images/5497d72ccc72cefc55c774fa8603928c.png)

我已经能够使用此示例使其与已知列名一起使用：http: [//geekswithblogs.net/malisacube/archive/2009/04/21/using-lambda-or-linq-for-pivot-tables.aspx](http://geekswithblogs.net/malisancube/archive/2009/04/21/using-lambda-or-linq-for-pivot-tables.aspx)

但我找不到任何使用动态列执行此操作的示例。

通过动态列，我的意思是可能有一个具有不同名称和字段类型的新行，该行之前在任何时候都没有出现在表中，也需要变成一列......任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:28:41.993

我不知道`LINQ`所以我会给你一个可以在 SQL Server 存储过程中使用的版本。这种类型的数据转换称为`PIVOT`. 由于您使用的是 SQL Server 2008+，因此您可以使用该功能。

如果您知道要转换的值，则可以对这些值进行硬编码：

```
SELECT nodeid, rowid,[FirstName], [LastName], [Title]
FROM
(
    SELECT nodeid, rowid, name, value
    FROM yourTable
) x
PIVOT
(
   max(value)
   for name in ([FirstName], [LastName], [Title])
)p 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/aff45/1)

然后如果你有未知数量的值，你可以实现动态SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(name) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT nodeid, rowid,' + @cols + ' from 
             (
                SELECT nodeid, rowid, name, value
                FROM yourTable
            ) x
            pivot 
            (
                max(value)
                for name in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/9cf07/1)

两者都返回结果：

```
| NODEID | ROWID | FIRSTNAME | LASTNAME |  TITLE |
--------------------------------------------------
|      1 |     1 |    Alfred |   Beagle | (null) |
|      1 |     2 |    Freddy |   (null) | (null) |
|      1 |     3 |    (null) |     Grey |   Sir. | 
```

# c# - 尝试执行 FetchXml 查询时出现“通用 SQL 错误”

> ID：14199638
> 
> 赞同：1
> 
> 时间：2013-01-07T16:08:05.267
> 
> 标签：c#, .net, sql-server-2008, dynamics-crm-2011

我有一个使用 XRM SDK 查询 CRM 的网站。在大多数情况下，我使用的是查询表达式，但我在一页上进行汇总计数，因此，我使用的是 Fetch XML 查询。我已经在本地开发人员机器上调试了网站，指向 Dev CRM 服务器没有任何问题。但是，如果我更新我的配置并指向我们的 QA CRM，我会收到一个通用的 SQL 错误。我使用诊断工具打开了跟踪，这是我在尝试执行 fetch XML 生成的 SQL 时看到的错误：

```
An error occurred in the Microsoft .NET Framework while trying to load assembly id 65536\. The server may be running out of resources, or the assembly may not be trusted with PERMISSION_SET = EXTERNAL_ACCESS or UNSAFE. Run the query again, or check documentation to see how to solve the assembly trust issues. For more information about this error: 
System.IO.FileLoadException: Could not load file or assembly 'microsoft.crm.sqlclr.helper, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. An error relating to security occurred. (Exception from HRESULT: 0x8013150A)
System.IO.FileLoadException: 
   at System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection)
   at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
   at System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
   at System.Reflection.Assembly.Load(String assemblyString)

   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader()
   at Microsoft.Crm.CrmDbConnection.InternalExecuteWithRetry[TResult](Func`1 ExecuteMethod, IDbCommand command)
   at Microsoft.Crm.CrmDbConnection.InternalExecuteReader(IDbCommand command, Boolean capturePerfTrace)
   at Microsoft.Crm.CrmDbConnection.ExecuteReader(IDbCommand command, Boolean impersonate, Boolean capturePerfTrace)
   at Microsoft.Crm.BusinessEntities.BusinessProcessObject.ExecuteQuery(CrmDbConnection dbConnection, IDbCommand command, ISqlExecutionContext context, Nullable`1 commandTimeout) 
```

我做了一些研究，我能找到的最好的东西是[这篇知识库文章](http://support.microsoft.com/kb/918040)。但它适用于 SQL Server 2005，而 CRM 是 SQL Server 2008。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T08:22:53.470

看起来这是 QA 数据库的权限问题。请参阅[http://social.msdn.microsoft.com/Forums/en/sqlnetfx/thread/2465ac11-735c-4362-8da4-1ed672b0e261](http://social.msdn.microsoft.com/Forums/en/sqlnetfx/thread/2465ac11-735c-4362-8da4-1ed672b0e261)和[http://crmpt.blogspot.de/2011/12/charts-aggregated-by -date-problem.html](http://crmpt.blogspot.de/2011/12/charts-aggregated-by-date-problem.html)供参考

从您的组织数据库的以下设置开始

```
ALTER DATABASE FOOBAR_MSCRM SET trustworthy ON 
```

请参阅[http://technet.microsoft.com/en-us/library/ms187861.aspx](http://technet.microsoft.com/en-us/library/ms187861.aspx)

# javascript - 根据变量状态执行脚本

> ID：14199640
> 
> 赞同：0
> 
> 时间：2013-01-07T16:08:06.763
> 
> 标签：javascript, jquery, ajax, intervals, youtube-javascript-api

我正在创建一个视频播放器，它依赖于通过 ajax 加载 vimeo 和 youtube 播放列表 api。加载后，对于 youtube，我需要遍历播放列表中的所有视频并调用每个视频的数据 api 以获取其修改日期。一旦加载了所有 vimeo 视频并加载了所有 youtube 视频并有了它们的创建日期，我需要使用 jquery 对它们进行排序。

我正在寻找检测这些过程何时完成的最佳方法，问题是在完成 vimeo 功能和 youtube 功能之前我无法真正开始排序。我能想到的最好的办法是运行一个 setInterval 函数来检查两个布尔标志的状态 - 例如：

```
var youtubeReady = false, vimeoReady = false;
var videoStatusInterval = setInterval("checkVideoStatus",1000);

function checkVideoStatus(){
  if (youtubeReady === true && vimeoReady === true){
    sortVideos();
  }
} 
```

问题是这只会定期运行（示例中的每一秒） - 一旦满足两个条件，似乎应该有一种方法可以立即执行此操作。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:16:49.440

我不熟悉 Youtube 的 API 和 Vimeo，但也许他们有一个“准备好”、“完成”或“加载”事件，你可以听两个，然后，在你设置的处理程序中，你设置两个标志，这样，如果两者都是真的，那么你执行，像这样：

```
 //Let's createa a couple of custome events to simulate the real ones, comming from Youtube and Vimeo.
var youtube = document.createEvent('Event'),
    vimeo  = document.createEvent('Event');

youtube.initEvent('youtubeReady');
vimeo.initEvent('vimeoReady');

/*
* This function will be use to run YOUR code, ONCE BOTH events are triggered.
* As said, functions are objects so, as any object in JS, you can add fields at any time you want.
* Check this page in Mozilla's Developer Network for more detail:  http://goo.gl/Pdvpk */
function sourcesReady(){
  if(sourcesReady.youtube && sourcesReady.vimeo){
        alert('Both sources ready!');
  }
  else if(sourcesReady.youtube){ 
    alert('Only Youtube ready!');
  }
  else if(sourcesReady.vimeo){ 
    alert('Only Vimeo ready!');
  }
}

//Let's set a couple of event handlers for the 'ready' events, these handlers will set the flags that we need.
document.addEventListener('youtubeReady', function youtubeReadyHandler(){
  sourcesReady.youtube = true; //We set/create the field in the function, that is, the function ITSELF has the field, not the 'this'.
  sourcesReady(); //We call it to evaluate the condition.
}, true);

document.addEventListener('vimeoReady', function vimeoReadyHandler(){
  sourcesReady.vimeo = true; //same as before.
  sourcesReady(); //We call it to evaluate the condition.
}, true);

document.dispatchEvent(youtube);
document.dispatchEvent(vimeo); 
```

希望这个建议有所帮助。=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:20:08.377

即使这些操作是异步完成的，您仍然可以创建全局变量。

`var youTubeScanDone = false, vimeoScanDone = false;`

然后将这些变量设置`true`为完成时。创建一个函数`function sortVideoList() { ... }`，并在每次扫描结束时调用这样的一行

`if (youTubeScanDone && viemoScanDone) sortVideoList();`

只需确保在调用此行之前将布尔值设置为 true（取决于您所在的扫描功能。

# sql - SQL SELECT 语句 - IN 子句中的多个 ID

> ID：14199647
> 
> 赞同：2
> 
> 时间：2013-01-07T16:08:50.323
> 
> 标签：sql, sql-injection, in-clause

> **可能重复：**
> [参数化 SQL IN 子句？](https://stackoverflow.com/questions/337704/parameterizing-an-sql-in-clause)

我时不时地在一个允许用户选择多个项目然后对它们执行批量操作的系统上工作。通常，我求助于在运行时构建 SQL，如下所示：

```
string inClause = String.Join(", ", selectedIds);
string command = "SELECT * FROM Customer WHERE CustomerId IN ({0})";
command = String.Format(command, inClause); 
```

当然，由于 SQL 注入，这种代码风格是不安全的。我可以通过放入参数占位符并创建参数来解决这个问题。

不过，我想知道是否还有另一种我没有考虑过的方法。我当然不想为每个 ID 执行一次命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:10:12.100

有两种很好的方法：

1.  使用命令占位符构建字符串（如您所说）
2.  加入 TVP 的价值观

将 ID 刻录到 SQL 中并不好，因为它会阻止计划缓存并打开注入的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T01:21:48.420

您可以构建一个 XML 字符串，然后将其传递给存储过程。执行它看起来像：

```
EXECUTE getLocationTypes '<IDList><ID>1</ID><ID>3</ID></IDList>' 
```

存储的过程看起来像：

```
create proc [dbo].[getLocationTypes](@locationIds XML)
as  
begin  
set nocount on  

SELECT locationId, typeId
FROM xrefLocationTypes 
WHERE locationId 
IN (SELECT Item.value('.', 'int' )
FROM @locationIDs.nodes('IDList/ID') AS x(Item))
ORDER BY 1, 2

end 
```

注意参数的数据类型是 XML。这比您所做的要复杂一些，猜想您可以在一个 SQL 字符串中完成所有操作。

# cakephp - 查询以加入相关模型表中的最新条目（CakePHP）

> ID：14199656
> 
> 赞同：1
> 
> 时间：2013-01-07T16:09:26.123
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

我有两张桌子：

**订单**

```
id  |  timestamp
--------------------------
1   |  2013-05-01 12:56:33 
```

**order_prices**

此表存储订单价格的快照。下订单时，第一个条目以原始价格进行。之后，可以通过管理系统更改价格，因此当价格更改时，会记录一个新价格。

```
id  |  order_id  |  price   |  timestamp
--------------------------------------------------
1   |  1         |  400.00  |  2013-05-01 12:56:33
1   |  1         |  450.00  |  2013-06-01 18:07:35
1   |  1         |  300.00  |  2013-07-01 17:42:16 
```

**楷模**

```
class Order extends AppModel {

    public $hasMany = array('OrderPrice');
}

class OrderPrice extends AppModel {

    public $belongsTo = array('Order');
} 
```

所以我的问题是如何在获取“当前”价格（即订单的 order_prices 表中的最新条目）或原始价格或任何历史时间点的价格的同时对订单进行查找?

我想以最轻松的方式重复使用。我不知道这是否可以使用虚拟字段来完成，但这将是理想的，因为这样我就可以在需要时提取当前订单价格。

**到目前为止，我的解决方案是使用可包含的行为：**

```
$this->Order->find('first', array(
    'contain' => array(
        'OrderPrice' => array(
            'order' => 'OrderPrice.timestamp DESC',
            'limit' => 1
        )

)); 
```

但是，这意味着我必须每次都添加它，这并不理想，因为我会得到很多订单价格。我真的可以用一种方法将尽可能多的内容放入模型中，这样我就不必重复了。

我尝试为 OrderPrice 模型添加默认订单属性，但它似乎不适用于可包含，并且您无法添加默认`limit`属性。

```
class OrderPrice extends AppModel {

    // Doesn't work from containable
    public $order = 'ObeOrderPrice.timestamp DESC'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T17:19:29.140

我认为这与您的操作方式无关，而与您放置代码的位置有关。（在我看来，像你一样使用 Containable 是理想的）

> “然而，这意味着我必须每次都添加它，这并不理想，因为我会得到很多订单价格。我真的可以用一种方法将尽可能多的这个放入模型中，所以我不必重复。”

这让我觉得你把你`find()`放在控制器中的多个地方......到你的观点，你的模型中应该有可以随时从任何控制器访问的方法......像这样：

```
//OrdersController
public function view($id) {
    $order = $this->Order->getOrder($id);
    $this->set(compact('order'));
}

//Order model
public function getOrder($id) {
    return $this->Order->find('first', array(
        'contain' => array(
            'OrderPrice' => array(
                'order' => 'OrderPrice.timestamp DESC',
                'limit' => 1
            )
    ));
} 
```

这将使您不必重复`contain()`多次。您还可以扩展该方法以允许为限制、订单、日期范围...等传递不同的参数 - 但您仍然可以在模型中的单个位置使用该方法。

旁注：我经常有两种方法 - 在这种情况下`getOrder()`-`getOrders()`第一种是获取单个订单的非常简单的方法，第二种是允许我以多种不同方式、方向、限制、连接来拉订单的所有参数。 ..etc 等等。我不确定这是否理想，但它很适合我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T11:10:06.510

好的，我有我认为最好的解决方案，除非有人有任何其他想法。

我将 OrderPrice 的可包含选项存储为模型中的变量，这样当我想将当前/原始价格加入 Order 时，我不必重写它们。我可以从任何模型中使用它们。

然后我有一些自定义查找类型，允许我使用我想要的任何参数对订单执行正常查询，同时自动加入自定义/原始价格。

**应用程序/模型/OrderPrice.php**

```
/**
 * Containable array options for finding current price
 *
 * @var array
 */
public $containCurrent = array(
    'fields' => 'OrderPrice.price',
    'order' => 'OrderPrice.timestamp DESC',
    'limit' => 1
);

/**
 * Containable array options for finding the original price
 *
 * @var array
 */
public $containOriginal = array(
    'fields' => 'OrderPrice.price',
    'order' => 'OrderPrice.timestamp',
    'limit' => 1
); 
```

**应用程序/模型/Order.php**

```
/**
 * Custom find type which automatically joins the current order price
 *
 * @param  string $state
 * @param  array $query
 * @param  array $results
 * @return array
 * @link http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#creating-custom-find-types
 */
protected function _findJoinCurrentPrice($state, $query, $results = array()) {
    if ($state == 'before') {
        $query['contain']['OrderPrice'] = $this->OrderPrice->containCurrent;
        return $query;
    } else {
        $results = $this->_refinePriceFindResults($query, $results);
    }
    return $results;
}

/**
 * Custom find type which automatically joins the original order price
 *
 * @param  string $state
 * @param  array $query
 * @param  array $results
 * @return array
 * @link http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#creating-custom-find-types
 */
protected function _findJoinOriginalPrice($state, $query, $results = array()) {
    if ($state == 'before') {
        $query['contain']['OrderPrice'] = $this->OrderPrice->containOriginal;
        return $query;
    } else {
        $results = $this->_refinePriceFindResults($query, $results);
    }
    return $results;
}

/**
 * Refine the results of a custom price find
 *
 * If the find returns only one order and/or one price, the data for both
 * models will be returned as element [0] of an otherwise empty array.
 * This method modifies the results array by removing the redundant wrapper
 * array, so that the model data is structured like a normal find('first').
 *
 * @param  array $query The query array from the custom find method
 * @param  array $results The results array from the custom find method
 * @return array The modified results
 */
protected function _refinePriceFindResults($query, $results) {
    if (empty($results)) {
        return false;
    }
    if (isset($query['conditions']['id']) || isset($query['conditions']['Order.id'])) {
        $results = array_shift($results);
    }
    if (isset($results['OrderPrice']['0'])) {
        if (count($results['OrderPrice']) == 1) {
            $results['OrderPrice'] = array_shift($results['OrderPrice']);
        }
    }   
    return $results;
} 
```

**控制器**

```
// I can perform a normal find, using any number of complex parameters.

$this->Order->find('joinCurrentPrice', array(
    'fields' => array('Order.type_id'),
    'conditions' => array('Order.id' => $id),
    'contain' => array(
        'Customer' => array(
            'fields' => array('Customer.first_name', 'Customer.last_name')
        )
    )
));

// And the result is the same as the normal find, but the price model is
// automatically joined without any extra work.

array(
    'Order' => array(
        'type_id' => 2,
        'id' => '843654'
    ),
    'Customer' => array(
        'id' => 7348,
        'first_name' => 'Joe',
        'last_name' => 'Bloggs'
    ),
    'OrderPrice' => array(
        'price' => '549.00',
        'order_id' => '843654'
    )
) 
```

我只需要弄清楚如何对历史价格做同样的事情，这样我就可以加入订单历史中任何时间的价格，而不仅仅是第一个或最后一个。

# iphone - 仅将 UIImage 移动到另一个 UIImage 内

> ID：14199657
> 
> 赞同：3
> 
> 时间：2013-01-07T16:09:28.333
> 
> 标签：iphone, ios, uiimageview, uiimage, uitouch

我有一个`UIImage`显示在`UIImageView`. 我还有另一张图片位于`UIImageView`第一张图片上方。我希望能够仅在第一张图像的边界内拖动第二张图像。为了使我的目标更清晰，请看这张图片： [![](../Images/ef6e15e3528bb9cfcbdcc5e890d13b7c.png)](https://i.stack.imgur.com/WV9K7.png) 。

绿色的大头针应该是可拖动的，但不能将大头针拖到蓝色的地方（地图外）。目前引脚是可拖动的，但我不知道如何检查引脚是否在地图之外。

编辑：我在我的 UIImageView 子类中使用此方法作为可拖动引脚：

```
- (UIColor *)colorAtPosition:(CGPoint)position {

CGRect sourceRect = CGRectMake(position.x, position.y, 1.f, 1.f);
CGImageRef imageRef = CGImageCreateWithImageInRect([[MapViewController sharedMapViewController]getImage].CGImage, sourceRect);

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
unsigned char *buffer = malloc(4);
CGBitmapInfo bitmapInfo = kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big;
CGContextRef context = CGBitmapContextCreate(buffer, 1, 1, 8, 4, colorSpace, bitmapInfo);
CGColorSpaceRelease(colorSpace);
CGContextDrawImage(context, CGRectMake(0.f, 0.f, 1.f, 1.f), imageRef);
CGImageRelease(imageRef);
CGContextRelease(context);

CGFloat r = buffer[0] / 255.f;
CGFloat g = buffer[1] / 255.f;
CGFloat b = buffer[2] / 255.f;
CGFloat a = buffer[3] / 255.f;

free(buffer);

return [UIColor colorWithRed:r green:g blue:b alpha:a];
} 
```

MapViewController 是地图的 UIIImageView 所在的 Viewcontroller。所以我让这个类成为一个单例来获取地图图像。但是我再次得到的颜色值是完全有线的。我也更新了照片，因为我的用户界面略有不同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:16:47.840

只需检查拖动所在的点并使用[此](https://stackoverflow.com/questions/448125/how-to-get-pixel-data-from-a-uiimage-cocoa-touch-or-cgimage-core-graphics)方法确定该点的**颜色。**

根据您的设置，您可以执行此操作，例如在`touchesMoved:`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T09:47:39.340

您是否尝试过在自定义 UIViewController 中实现 UIResponder 的触摸方法，然后按如下方式引用 2 个 UIView？

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch* t = [touches anyObject];
    if (t.tapCount == 1 &&  [yourPinView pointInside:pt withEvent:nil])
    {
        CGPoint pt = [t locationInView:yourMapView];
        if ([self getColorOfPt:pt] != <blue>)
        {
            state = MOVING;
        }
    }
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    if (MOVING == state)
    {
        UITouch* t = [touches anyObject];

        // Move the pin only if the current point color is not blue.
        if ([self getColorOfPt:pt] != <blue>)
        {
            CGRect r = yourPinView.frame;
            r.origin.x = <new point based on diff>
            r.origin.y = <new point based on diff>
            yourPinView.frame = r;
        }
    }
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch* t = [touches anyObject];
    if (t.tapCount == 1 && MOVING == state)
    {
        state == NOT_MOVING;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-07T16:15:40.170

您可以尝试一种在以下位置选择颜色的方法`CGPoint`：`UIImage`iPhone [Objective C: How to get a pixel's color of touch point on an UIImageView?](https://stackoverflow.com/questions/1285621/iphone-objective-c-how-to-get-a-pixels-color-of-the-touched-point-on-an-uiimag) 并检测它是否是“蓝色”。
如果它是蓝色，不要（重新）定位销

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T13:09:58.093

您可以使用此问题的答案来获取像素颜色。

[获取 UIImage 的像素颜色](https://stackoverflow.com/questions/3284185/get-pixel-color-of-uiimage)

[如何获取iphone上图像上像素的RGB值](https://stackoverflow.com/questions/144250/how-to-get-the-rgb-values-for-a-pixel-on-an-image-on-the-iphone)

我还发现了一个漂亮的教程：[我的像素是什么颜色？iPhone上基于图像的颜色选择器](http://www.markj.net/iphone-uiimage-pixel-color/)

然后检测它是否是**Blue Color**。如果它是**蓝色**，那么正如**@basvk**所说，不要（重新）定位销。希望你能从中有所收获。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-10T18:38:01.900

我只是给你一个想法..

我希望地图是 SVG 文件，或者如果它的 jpeg 可以使用 Adob​​e Illustrator 轻松转换为 SVG。或者还有许多其他选择可以做到这一点。

[在这里](http://rdsquared.wordpress.com/2012/01/10/svg-to-coregraphics-conversion/)您可以找到如何将 svg 转换为路径..

[在这里](http://jeffmenter.wordpress.com/2011/04/17/method-for-interpreting-illustrator-art-assets-as-cocoa-cgpathref/)您可以找到如何将 EPS（插画家路径）转换为 CGPath

然后您可以检查触摸点是否位于路径内

```
if([CGPathContainsPoint:myPoint]){

}
else{

} 
```

# java - JComponent：如何设置最大宽度？

> ID：14199663
> 
> 赞同：3
> 
> 时间：2013-01-07T16:09:51.920
> 
> 标签：java, swing, size, jcomponent

我需要将`JComponent`' 的宽度设置为`300`或更少，但高度应该是可变的（取决于 的内容`JComponent`）。

首先，我尝试使用

```
myComponent.setMaximumSize(300, 9999); 
```

但是我发现这种方法完全没有效果，组件仍然会根据其内容进行扩展（至少我看不到任何效果）。

然后我尝试使用

```
myComponent.setPreferredSize(300, (int)myComponent.getPreferredSize().getHeight()); 
```

然后，宽度变为 300 且不小于 300。这并不完美，但可以接受。但是，现在，当组件的内容改变时，大小不会改变！这是不可接受的。

我试图找到只影响首选宽度的方法，并将高度保留为“默认”，但我没有找到那种方法。

我试图将高度设置为 0 或 -1：没有效果。

如何做到这一点？

* * *

UPD：请看图片： http: [//goo.gl/3Hp59](http://goo.gl/3Hp59) 这就是我已经实现的，但是我使用了`setPreferredSize()`，这很糟糕，正如我已经意识到的那样，谢谢。

请帮我找出正确的方法：

目前我使用`GridBagLayout`. 我需要使右列的宽度<= 300。（左一个，比如说，<= 200）如何使用 来实现`GridBagLayout`，或者我应该使用什么布局？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:13:51.247

*   来自[标准 LayoutManagers](http://docs.oracle.com/javase/tutorial/uiswing/layout/index.html)：使用`BoxLayout`

*   [BoxLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)接受`Mix,` `Max`和`PreferredSize`

*   [不设置`Mix,` `Max`and`PreferredSize`](https://stackoverflow.com/questions/7229226/should-i-avoid-the-use-of-setpreferredmaximumminimumsize-methods-in-java-swi)，每个 JComponent（不包括空的`JPanel`( `Grapics/2D`) 和 a`JTable`中的 a `JScrollPane`）都可以自行正确返回`XxxSize`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T18:33:12.977

使用[GroupLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/group.html)。它有一些最好的尺寸控制。GroupLayout 可能看起来有点吓人，但提供的示例非常好。如果您想允许用户调整屏幕大小，则特别有用。

# javascript - 向流图 d3.js 添加动态工具提示

> ID：14199666
> 
> 赞同：1
> 
> 时间：2013-01-07T16:10:15.460
> 
> 标签：javascript, d3.js, tooltip, stream-graph

我目前正在处理流图，我想向每一层添加工具提示，类似于[http://archive.stamen.com/mtvmovies-streamgraph/chart.html](http://archive.stamen.com/mtvmovies-streamgraph/chart.html)

![在此处输入图像描述](../Images/c7078debc82b5ed284a707d86723b872.png)

我现在拥有的工具提示根本不起作用。我得到的只是工具提示框中显示的“NaN”。

有什么建议么？？我的代码如下。

提前致谢。

```
 var customPalette = [
       "#ff7f0e",  "#2ca02c", "#00FFFF", "#d62728", "#9467bd",
      "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"
    ];

    var format = d3.time.format("%y");

    //creating margins around the graph
    var margin = {top: 20, right: 30, bottom: 30, left: 200},
        width = 1200 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    //OUTPUT RANGE
    var x = d3.time.scale()
        .range([0, width]);

    //OUTPUT RANGE
    var y = d3.scale.linear()
        .range([height, 0]);

    //assining custom colors to layers
    var colours = d3.scale.ordinal().range(customPalette);

    var xAxis = d3.svg.axis()
        .scale(x)
        .orient("top")
        .ticks(d3.time.years);

    var yAxis = d3.svg.axis()
        .scale(y)
        .orient("left");

    //ctreate stack layout
    var stack = d3.layout.stack()
        .offset("wiggle")
        .order("reverse")
        .values(function(d) { return d.values; })
        .x(function(d) { return d.date; })
        .y(function(d) { return d.amount; });

    //creates array of datya elements for stacked bar graph
    var nest = d3.nest()
        .key(function(d) { return d.age; });

    //create area
    var area = d3.svg.area()
        //adds curviture
        .interpolate("monotone")
        .x(function(d) { return x(d.date); })
        .y0(function(d) { return y(d.y0); })
        .y1(function(d) { return y(d.y0 + d.y); });

    var svg = d3.select("body").append("svg")
        //defines length of x-axis
        .attr("width", width + margin.left + margin.right)
        //defines height of y-axis
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    d3.csv("data6.csv", function(data) {
      data.forEach(function(d) {
        // Convert strings to numbers
        d.date = format.parse(d.date);
        d.amount = +d.amount;
      });

      //returns an array of objects with a key feild (0-20yrs....)
      //and a value array which contains associated records
      var layers = stack(nest.entries(data));

      //.extent() returns min and max values of argument
      x.domain(d3.extent(data, function(d) { return d.date; }));
      //
      y.domain([0, d3.max(data, function(d) { return d.y0 + d.y; })]);

      svg.selectAll(".layer")
          .data(layers)
        .enter().append("path")
          .attr("class", "layer")
          .attr("d", function(d) { return area(d.values); })
          .style("fill", function(d, i) { return colours(i); });

      //CURRENT TOOLTIP CODE
      var toolTip = svg.selectAll("path")
                       .append("svg:title")
                   .text(function(d) { return (d.date) + (d.amount) });;

    svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + 0 + ")")
          .call(xAxis);

    svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:36:17.863

您是希望连接 and 的值`d.date`，`d.close`还是对添加这些值并返回结果感兴趣？

如果是后者：我敢打赌 和 的类型`d.date`不是`d.close`您所期望的。如果您还没有的话，我建议您放入一些调试代码来检查这些变量的类型。例子：

```
//CURRENT TOOLTIP CODE
var toolTip = svg.selectAll("path")
   .append("svg:title")
   .text(function(d) { 
     console.log('d.date type:' + typeof d.date + 'd.close type:' + typeof d.close);
     return (d.date) + (d.close);
   }
); 
```

此外，您的代码片段中该语句的末尾还有一个额外的分号。

如果是前者：一个或两个都是类型，当您使用运算符而不是连接它们`number`时，Javascript 会尝试添加它们。`+`要返回字符串：

```
.text(function(d) {
  return d.date.toString() + ' ' + d.close.toString();
}); 
```

# c# - WPF 自定义控件“样式模型”

> ID：14199668
> 
> 赞同：1
> 
> 时间：2013-01-07T16:10:21.583
> 
> 标签：c#, wpf, styles, ivalueconverter

我在 wpf 中有自定义控件，可以根据一个属性更改他的外观：

...

```
<Grid>
   <Rectangle Fill="[Something]" />
</Grid> 
```

在代码中，我有属性 AlarmLevel，当 AlarmLevel 大于 5 时，我希望填充为红色，否则为蓝色。我怎样才能做到这一点。（我不希望填充属性被暴露）

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:33:07.523

由于您将填充值基于不等式，因此您可以通过多种方式执行此操作。

推荐的方法可能是在绑定上使用转换器将其转换为布尔值。然后使用数据触发器根据值是真还是假来设置填充值，如下所示：

```
<Rectangle>
  <Rectangle.Style>
    <Style TargetType="Rectangle">
      <Style.Triggers>
        <DataTrigger Binding="{Binding AlarmLevel, Converter={StaticResource AlarmLevelConverter}}" Value="True">
          <Setter Property="Fill">
            <Setter.Value>
              <SolidColorBrush Color="Red" />
            </Setter.Value>
          </Setter>
        </DataTrigger>
        <DataTrigger Binding="{Binding AlarmLevel, Converter={StaticResource AlarmLevelConverter}}" Value="False">
          <Setter Property="Fill">
            <Setter.Value>
              <SolidColorBrush Color="Black" />
            </Setter.Value>
          </Setter>
        </DataTrigger>
      </Style.Triggers>
    </Style>
  </Rectangle.Style>
</Rectangle> 
```

您的转换器可能看起来像（也许有更多的异常处理）：

```
 public class AlarmLevelConverter: IValueConverter {

    public object Convert(object value, System.Type targetType, object parameter, System.Globalization.CultureInfo culture) {
      return ((int)(value) > 5);
    }

    public object ConvertBack(object value, System.Type targetType, object parameter, System.Globalization.CultureInfo culture) {
      throw new NotSupportedException();
    }
  } 
```

不要忘记您需要添加对转换器类的引用作为用户控件上的资源：

如果您想放弃转换器方法，您还可以在数据上下文中创建一个“帮助”布尔属性，称为“IsAlarming”。它看起来像：

```
public bool IsAlarming {
  get { return AlarmLevel > 5; }
} 
```

然后，您将数据触发器绑定到 IsAlarming 而不是 AlarmLevel。 **但不建议**这样做，因为它不是纯 MVVM。

# android - 以良好的质量和内存效率从资源中缩小位图

> ID：14199671
> 
> 赞同：3
> 
> 时间：2013-01-07T16:10:29.257
> 
> 标签：android, resources, bitmap, scale

我想缩小 500x500px 资源以始终适应由屏幕宽度确定的特定大小。

目前我使用来自 Android 开发者网站的代码（[有效地加载大型位图](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)），但质量不如我在 a 中使用 500x500px 资源`ImageView`（作为 xml 中的源）并且只是缩放`ImageView`而不是位图。

但它很慢，我也想扩展`Bitmap`，以提高内存效率和速度。

编辑：我想缩放的drawable在`drawable`我的应用程序的文件夹中。

Edit2：我目前的方法。

![在此处输入图像描述](../Images/bde670da2420d1f786ce906d5a374fbd.png)

左图是来自[Loading Large Bitmaps Efficiently](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)的方法，无需任何修改。中心图像是使用@Salman Zaidi 提供的方法完成的，稍作修改：`o.inPreferredConfig = Config.ARGB_8888;`和`o2.inPreferredConfig = Config.ARGB_8888;`

正确的图像是一个图像视图，其中图像源在 xml 中定义，并且我想通过缩放位图达到的质量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T16:22:13.053

```
private Bitmap decodeImage(File f) {
    Bitmap b = null;
    try {
        BitmapFactory.Options o = new BitmapFactory.Options();
        o.inJustDecodeBounds = true;

        FileInputStream fis = new FileInputStream(f);
        BitmapFactory.decodeStream(fis, null, o);
        fis.close();

        float sc = 0.0f;
        int scale = 1;
        //if image height is greater than width
        if (o.outHeight > o.outWidth) {
            sc = o.outHeight / 400;
            scale = Math.round(sc);
        } 
        //if image width is greater than height
        else {
            sc = o.outWidth / 400;
            scale = Math.round(sc);
        }

        // Decode with inSampleSize
        BitmapFactory.Options o2 = new BitmapFactory.Options();
        o2.inSampleSize = scale;
        fis = new FileInputStream(f);
        b = BitmapFactory.decodeStream(fis, null, o2);
        fis.close();
    } catch (IOException e) {
    }
    return b;
} 
```

这里的“400”是新的宽度（如果图像是纵向模式）或新的高度（如果图像是横向模式）。您可以设置自己选择的值.. 缩放位图不会占用太多内存空间..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-03T16:11:28.253

伙计们，**inSampleSize**参数是为内存优化而设计的，同时从资源或内存中加载位图。所以对于你的问题，你应该使用这个：

```
Bitmap bmp = BitmapFactory.decode...;
bmp = bmp.createScaledBitmap(bmp, 400, 400, false); 
```

**inSampleSizelets**让您可以使用离散的步骤来缩放位图。比例为 2,4，依此类推。因此，当您使用带有选项的解码时，**inSampleSize=2**您从内存中加载 250x250 位图，然后将其拉伸到 400x400

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:47:39.013

检查此培训：

[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

它展示了如何有效地调整位图大小

# debugging - 在 GDC 和 DMD 之间进行选择

> ID：14199676
> 
> 赞同：11
> 
> 时间：2013-01-07T16:10:44.000
> 
> 标签：debugging, version, d, dmd, gdc

我是 D 编程新手。选择 DMD（2.061）或 GDC（4.6、4.7 或 4.8，快照）的优缺点是什么。我应该选择哪个 GDC 版本？我已经成功构建了 GCC-4.8 和 GDC-4.8 的最新快照，它编译了一个 hello world 程序。

以下是我目前对职业选手的看法：

*   **GDC**：更多平台，运行时性能
*   **DMD**：编译性能，更多测试？

通过 GDB 的调试支持怎么样 - GDC 和 DMD 之间有什么不同？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-07T20:11:03.553

使用**DMD**，因为它是参考实现并且使用最广泛。它也是*最新*的，因为新功能和修复主要在**DMD**中发布（但**GDC**和**LDC是在****DMD**之后不久发布的）。

作为新手，您应该首先考虑**DMD ，直到找到您需要但在****DMD**中找不到的细节，然后您可以考虑使用**GDC**或**LDC**。或者立即使用它们，因为所有编译器都从**DMD**共享一个共同的前端，因此切换它们不应该有那么大的问题（除了可能在所有编译器中都不相同的错误）。

目前所有 3 个编译器都支持 Windows 和 Posix 平台上的 32 位和 64 位（alpha/beta？）。

[**GDC**](http://www.prowiki.org/wiki4d/wiki.cgi?GdcHacking#WhyGDC)和[**LDC**](http://wiki.dlang.org/LDC#Project_status)采取了一些试验性举措来支持 ARM 平台。

****与DMD**相比，**GDC**和**LDC**可能具有更长的编译时间，DMD使编辑/编译/运行周期成为*一种乐趣*，而GDC**和**LDC**通常**编译*更快的**代码*，这使得它们更适合*发布版本*（当然应用程序测试应该是在发布编译器上完成）**

# java - JavaMail - HELO 名称无效

> ID：14199677
> 
> 赞同：0
> 
> 时间：2013-01-07T16:10:52.350
> 
> 标签：java, email, smtp, jakarta-mail

我曾经运行一个服务器应用程序，它每 2 小时发送一封电子邮件，但有时我会收到以下错误：

```
Não foi possível enviar a mensagem.
Mensagem: com.sun.mail.smtp.SMTPSendFailedException: 550 Access denied - Invalid HELO name (See RFC2821 4.1.1.1)

Jan 07, 2013 1:00:32 PM job_hidrojato.comunicacao.email.Email run
SEVERE: null
com.sun.mail.smtp.SMTPSendFailedException: 550 Access denied - Invalid HELO name (See RFC2821 4.1.1.1)

at com.sun.mail.smtp.SMTPTransport.issueSendCommand(SMTPTransport.java:1388)
at com.sun.mail.smtp.SMTPTransport.mailFrom(SMTPTransport.java:959)
at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:583)
at javax.mail.Transport.send0(Transport.java:169)
at javax.mail.Transport.send(Transport.java:98)
at job_hidrojato.comunicacao.email.Email.run(Email.java:186)
at java.lang.Thread.run(Thread.java:722) 
```

我已经尝试使用下面的代码明确定义 mail.smtp.localhost，其中“HADES”是我的服务器的主机名，但它不起作用。

```
props.put("mail.smtp.localhost", "HADES"); 
```

此更改后生成的错误日志是相同的，因此我认为问题不在于主机名参数。我已经阅读了下面的链接，但同样没有用，所以我没有其他方法可以解决这个问题，任何帮助都将不胜感激:)

[JavaMail 中的 HELO 名称无效](https://stackoverflow.com/questions/4934373/invalid-helo-name-in-javamail)

[550 访问被拒绝 - HELO 名称无效](https://stackoverflow.com/questions/8542616/550-access-denied-invalid-helo-name)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:39:20.777

如果您查看[RFC2811](http://www.ietf.org/rfc/rfc2821.txt)第 4.1.1.1 节，它会说（强调我的）：

> 这些命令用于向 SMTP 服务器识别 SMTP 客户端。参数字段包含 SMTP 客户端的**完全限定域名** （如果可用）。在 SMTP 客户端系统没有有意义的域名的情况下（例如，当它的地址被动态分配并且没有可用的反向映射记录时），客户端**应该发送一个地址文字**（参见第 4.1.3 节），可选地跟随通过有助于识别客户端系统的信息。

该名称`HADES`不是完全限定的域名（即主机名+域，例如`www.example.com`，FQDN 的某些定义还需要一个点结尾（即`www.example.com.`，但我不确定 SMTP 是否需要）。如果您没有 FQDN ，您应该使用地址文字（请参阅第 4.1.3 节地址文字），它基本上是 IP 地址。

还要确保您的 SMTP 服务器没有主动限制对未知或未经身份验证的主机的访问。

# javascript - jQuery UI 可排序：移动克隆但保持原始

> ID：14199681
> 
> 赞同：9
> 
> 时间：2013-01-07T16:11:05.313
> 
> 标签：javascript, jquery, jquery-ui

现在我有一列元素，我把它拖到了我拖动的位置，它会克隆，但是当我放下时，它也会删除原始元素。

```
$( ".column" ).sortable({
        helper: 'clone',
        connectWith: ".column",
        connectWith: ".grid",
        start: function(e, ui){
            ui.placeholder.height(ui.item.height());
             $(".column" ).find('.portlet:hidden').show()
             console.log('started')
        },
        stop: function(event, ui) {
            $(ui.helper).clone(true).removeClass('box ui-draggable ui-draggable-dragging').addClass('box-clone').appendTo('body');
        }
    }); 
```

如何将原件保留在其所在的位置（无需将其重新附加到列中）并使克隆移动到所需的位置？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-07T16:35:22.837

在停止事件处理程序中使用`$(this).sortable('cancel')`以将项目恢复到其原始列表/位置。[http://api.jqueryui.com/sortable/#method-cancel](http://api.jqueryui.com/sortable/#method-cancel)

```
$( ".column" ).sortable({
        helper: 'clone',
        connectWith: ".column",
        connectWith: ".grid",
        start: function(e, ui){
            ui.placeholder.height(ui.item.height());
             $(".column" ).find('.portlet:hidden').show()
             console.log('started')
        },
        stop: function(event, ui) {
            $(ui.helper).clone(true).removeClass('box ui-draggable ui-draggable-dragging').addClass('box-clone').appendTo('body');
            $(this).sortable('cancel');
        }
    }); 
```

**更新：**

要将元素附加到项目放置位置的第二个列表，请执行*以下*操作：

```
stop: function(event, ui) {
            var toListID = ui.item.parent().attr('id');   
            var idx = $('#' + toListID).children().index($(ui.item[0]));
            if(idx== -1)return;
            var elm = $(ui.item[0]).clone(true).removeClass('box ui-draggable ui-draggable-dragging').addClass('box-clone');
            $('#' + toListID).children(':eq('+idx+')').after(elm);
            $(this).sortable('cancel');
        } 
```

请参阅[小提琴](http://jsfiddle.net/adamb/tZSN7/12/)以获取完整演示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-09T19:07:58.393

如果有人使用新版本，只需使用：

```
revert: true 
```

更多细节在这里：[jQuery Sortable - 保留在原始列表中](https://stackoverflow.com/questions/3669039/jquery-sortable-keep-it-in-original-list/7209451)

# c#-4.0 - C#从其他方法读取动态创建的文本框的文本

> ID：14199682
> 
> 赞同：2
> 
> 时间：2013-01-07T16:11:06.673
> 
> 标签：c#-4.0

如果我像这样动态创建一个文本框：

```
private void Form1_Load(object sender, EventArgs e)
{
   TextBox tb=new TextBox();
   ...
   this.Controls.Add(tb);
} 
```

如果我的表单上有一个按钮，并且我想从按钮单击事件处理程序中读取文本框的文本

```
private void button1_Click(object sender, EventArgs e)
{
 if(**tb.text**=="something") do something;
} 
```

问题是我在按钮处理程序中找不到文本框控件。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:14:09.173

您必须在方法之外声明 texbox，它必须是全局的。然后你可以到达文本框对象

```
TextBox tb;
private void Form1_Load(object sender, EventArgs e)
{
  tb=new TextBox();
  ...
  this.Controls.Add(tb);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:14:34.190

声明`TextBox`为您的`Form`班级私人成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:25:36.907

```
private TextBox tb = new TextBox();
private void Form1_Load(object sender, EventArgs e)
{
  this.Controls.Add(tb);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:19:24.197

假设这是一个 Windows 窗体，您可以遍历`Controls`像 a 这样的可枚举对象的集合。`TabControl`这是我正在从事的一个项目中的一些内容，适用于`TextBox`：

```
foreach (TabPage t in tcTabs.TabPages)
{
    foreach (Control c in t.Controls)
    {
        MessageBox.Show(c.Name);  // Just shows the control's name.

        if (c is TextBox)    // Is this a textbox?
        {
            if (c.Name == "txtOne")  // Does it have a particular name?
            {
                TextBox tb = (TextBox) c;  // Cast the Control as a TextBox

                tb.Text = "test";  // Then you can access the TextBox control's properties
            }
        }
    }
} 
```

# javascript - 带有 Ogg 比特流的 MediaSource API

> ID：14199683
> 
> 赞同：1
> 
> 时间：2013-01-07T16:11:09.037
> 
> 标签：javascript, html, audio, streaming

是否可以使用 MediaSource API 接收 Ogg vorbis 比特流的有效标题和页面并在音频元素中流式传输时播放轨道？一个例子将非常感激=）

注意：我研究了 WebAudio API，但它似乎只能解码完整的 ogg 文件，而不是逐步解码 ogg 页面。

编辑：我什至想知道当前是否可以在 Chrome 中将 MediaSource API 与音频元素一起使用。规范是这么说的，但它似乎只适用于 Chrome 中的视频元素。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T01:23:08.423

Chrome 的 MediaSource 实现不支持 Ogg，目前没有计划添加支持。我们将重点放在规范中提到的 WebM 和 ISO-BMFF 字节流上。

MediaSource API 应该使用音频元素。如果您使用纯音频内容，则必须确保传递给 addSourceBuffer() 的 mimetype 仅包含音频编解码器，不包含其他内容。例如，如果您有一个纯音频 WebM 文件，那么 'audio/webm;codecs="vorbis"' 应该可以工作，但 'video/webm;codecs="vorbis,vp8"' 会失败，因为该文件不包含 VP8数据。

如果您使用 Dev Channel Chrome 构建（Chrome 25+），您可以通过在另一个选项卡中打开 chrome:media-internals 然后重新加载尝试使用 MediaSource API 的选项卡来查看与 MediaSource 相关的错误。

# c++ - 如何处理 3rd 方库代码中的 exit() 调用？

> ID：14199689
> 
> 赞同：12
> 
> 时间：2013-01-07T16:11:41.533
> 
> 标签：c++, legacy-code

我正在开发一个 C++ 应用程序，它使用另一个团队用 C 语言编写的库。库的编写者喜欢`exit()`在发生错误时调用，这会立即结束程序，而无需调用 C++ 应用程序中堆栈上的对象的析构函数。应用程序设置了一些在进程结束后不会被操作系统自动回收的系统资源（共享内存区域、进程间互斥体等），所以这是一个问题。

我有完整的应用程序和库的源代码，但是库非常完善并且没有单元测试，所以改变它会很重要。有没有办法“挂钩”调用，`exit()`以便我可以为我的应用程序实现正常关闭？

我正在考虑的一种可能性是创建一个大类，*即*应用程序——这意味着所有清理都将发生在其析构函数或其中一个成员的析构函数中——然后在堆中分配这些大对象之一`main()`，设置一个全局指向它的指针，并使用`atexit()`来注册一个处理程序，该处理程序只是通过全局指针删除对象。这可能行得通吗？

有没有已知的好方法来解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-07T16:14:34.120

在最坏的情况下，您始终可以编写自己的实现`exit`并链接它，而不是系统自己的实现。您可以在那里处理错误，也可以选择给[`_exit(2)`](http://linux.die.net/man/2/_exit)自己打电话。

由于您拥有库源代码，因此更容易 - 只需`-Dexit=myExit`在构建时添加一个标志，然后提供`myExit`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T16:16:39.347

[使用atexit](http://linux.die.net/man/3/atexit)安装退出处理程序并实现所需的行为

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T16:27:19.763

如果您想让 C 库在 C++ 中更有用，您也许可以在单独的进程中运行它。然后确保（使用退出处理程序或其他方式）当它退出时，您的主应用程序进程会注意到并抛出异常以展开它自己的堆栈。也许在某些情况下，它可以以非致命的方式处理错误。

当然，将库使用转移到另一个进程可能并不容易或特别有效。您需要做一些工作来包装接口，并通过您选择的 IPC 机制复制输入和输出。

但是，作为从主进程使用库的一种解决方法，我认为您描述的那个应该可以工作。风险在于您无法识别和隔离需要清理的所有内容，或者假设堆栈将正常展开，将来有人会修改您的应用程序（或您使用的其他组件）。

您*可以*修改库源以调用运行时或编译时可配置函数，而不是调用`exit()`. 然后编译带有异常处理的库并在 C++ 中实现该函数以引发异常。这样做的问题是库本身可能会在错误时泄漏资源，因此您必须*仅*使用该异常来展开堆栈（并且可能会进行一些错误报告）。即使就您的应用而言，错误可能不是致命的，也不要抓住它并继续。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T16:52:23.830

如果 call`exit`和 not `assert`or `abort`，有几点可以再次控制：

*   调用 时`exit`，具有静态生命周期的对象的析构函数（本质上是：全局变量和用 声明的对象`static`）仍会执行。这意味着您可以设置（少数）全局“资源管理器”对象并在其析构函数中释放资源。
*   正如您已经发现的那样，您可以使用`atexit`. 这不限于一个。您可以注册更多。

如果一切都失败了，因为你有库的源代码，你可以玩一些宏技巧来有效地用`exit`你自己的函数替换调用，例如，抛出异常。

# php - mysqliprepared statement（SQL注入预防）

> ID：14199690
> 
> 赞同：3
> 
> 时间：2013-01-07T16:11:42.653
> 
> 标签：php, mysql, sql, code-injection

在停止使用已弃用的 mysql_* 函数后，我切换到 mysqli。但是后来，我注意到未准备好的语句对于 SQL 注入是不安全的。然后，我再次更改了我的代码。

我所拥有的是以下函数，它检查数据库中是否存在变量**$ID**并打印该行的**标题**值：

```
function showPostTitle($ID, $mysqli) {
    $result = $mysqli -> query("SELECT ID, title FROM blog where ID = $ID");
    $row = $result -> fetch_array(MYSQLI_BOTH);
    echo $row['title'];
} 
```

我把它改成这样：

```
function showPostTitle($ID, $mysqli) {
    $stmt = $mysqli -> prepare("SELECT ID, title FROM blog WHERE ID = ?");
    $stmt -> bind_param("i", $ID);
    $stmt -> execute();
    $stmt -> bind_result($ID, $title);
    $stmt -> fetch();
    print_r($title);
    $stmt -> free_result();
} 
```

我的问题是：这是实现准备好的语句的正确方法吗？另外，我现在可以免受 SQL 注入的影响吗？非常感谢谁会回答这个问题:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:45:35.400

[你的 mysqli 逻辑看起来不错，这里的PHP 手册](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)中有一些示例，以防你没有看到它们。

为什么不消费时选择ID？此外，当我假设在这种情况下会发生（ID 是表中的唯一索引）时，它只会在完整结果集中返回一行时，您实际上并不需要绑定结果，而是使用[get_result](http://php.net/manual/en/mysqli-stmt.get-result.php)。

使用 mysqli prepare 将防止所有常见的注入攻击，但不能防止尚未进入驱动程序的 0-day 风格的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:16:43.830

看看这个帖子：

[PDO 准备好的语句是否足以防止 SQL 注入？](https://stackoverflow.com/questions/134099/are-pdo-prepared-statements-sufficient-to-prevent-sql-injection)

它使用 PDO 而不是 MySQLi，它通过创建准备好的语句来解决相同的问题。

很抱歉没有回答您的问题，只是想提供一个资源供您考虑。

# php - 在 Heredoc 标签之间连接内容

> ID：14199691
> 
> 赞同：0
> 
> 时间：2013-01-07T16:11:45.837
> 
> 标签：php, html, tcpdf, heredoc

我正在将一些格式化的 html 文本转换为 PDF 文件，在此过程中，我必须在文档中放置一个表格。为了将表格正确放入PDF，我必须使用heredoc标签而不是常规引用（通过一些实验得出这个结论）。我想知道的是我是否可以从 POST 调用中获取一些内容并将其放在 heredoc 标记之间：

```
$table = $_POST['table'];
$html = <<<EOD . '$table' . EOD; 
```

或者，类似的东西。我还没有遇到解决方案，并且想知道这是否可能。我曾尝试将表变量直接传递给方法，但这是徒劳的。但是，如果与heredoc 标签一起传递，它确实有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:19:06.780

您想为此目的使用[封装的 Heredoc 。](http://php.net/manual/en/language.types.string.php)该页面上的示例#5。它允许您将 heredoc 放在引号中并使用花括号来利用您的变量。

**PHP 示例**

```
$hey = 'Test 1 2 3';

$html = <<<"TEST"
Test me: {$hey}
TEST;

echo $html; 
```

**退货**

```
Test me: Test 1 2 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:20:50.220

是的，就像 PHP 文档说的：

```
$name = 'Davis';

echo <<<EOT
My name is "$name". I am printing some $_POST['table'].
Now, I am printing some {$foo->bar[1]} too!
This should print a capital 'A': \x41
EOT; 
```

您必须确保您的文本**位于**起始行和结束行之间。

# c# - C# 中的 Utils.CopyArray？

> ID：14199696
> 
> 赞同：2
> 
> 时间：2013-01-07T16:11:59.987
> 
> 标签：c#, vb.net

[`Utils.CopyArray`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compilerservices.utils.copyarray.aspx)是 Visual Basic.net 中的一种方法，但它在 C# 中的复制是什么？我尝试查看 msdn，但没有任何线索。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T16:13:28.687

[`Array.Copy`](http://msdn.microsoft.com/en-us/library/system.array.copy.aspx)就是你要找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:14:52.997

您可以从 C# 轻松引用`Microsoft.VisualBasic`命名空间，包括`Utils`类。但是这种特殊方法主要是为了在将旧的 VB 代码转发到 .Net 时的兼容性。新代码，无论是 VB 还是 C#，都应该使用[Array.Copy()](http://msdn.microsoft.com/en-us/library/system.array.copy.aspx)代替。

# php - IE9 呈现与其他浏览器不同的标记 (HTML) - 这不是 CSS 问题

> ID：14199701
> 
> 赞同：1
> 
> 时间：2013-01-07T16:12:31.187
> 
> 标签：php, magento, internet-explorer-9, html-lists

编辑 - 经过一些故障排除后，这个问题似乎与我安装的插件有关。禁用插件解决了这个问题。

我对 IE9 有一个奇怪的问题，它会渲染 < ol > 元素的错误标记。它将其包含的一些 <li> 元素放在 DOM 树的不同部分，以便

```
<div id="Containter">
  <div id="left">
   <ol>
     <li>item1</li>
     <li>item2</li>
     <li>item3</li>
     <li>item4</li>
   </ol>
  </div><!-- end left -->
 </div><!-- end container --> 
```

变成

```
<div id="Containter">
  <li>item1</li>
  <li>item2</li>
  <div id="left">
   <ol>
     <li>item3</li>
     <li>item4</li>
   </ol>
  </div><!-- end left -->
 </div><!-- end container --> 
```

这怎么可能！？

标记是由 Magento 端的一些非常复杂的 Javacript PHP 生成的，所以这有点混淆了这个问题。可能与这些问题有关，[有没有办法通过 IE9 中的有序列表和更新面板来解决这个问题？](https://stackoverflow.com/questions/8430530/is-there-a-way-to-work-around-this-issue-with-ordered-lists-and-update-panels-in)或者这个问题[IE9 中的动态 HTML 渲染问题，](https://stackoverflow.com/questions/11346385/dynamic-html-rendering-issue-in-ie9-only)虽然我不明白怎么做。

然而，这并不能解释发生了什么。将浏览器切换到 IE7 模式可以更正标记，因此强制执行此操作可能是一种解决方法。

尽管如此，我还是想了解这里到底发生了什么，以及是否有其他方法可以解决它。附上截图。![在此处输入图像描述](../Images/27a5dd8f6b22a22a4a6a1e9ce16a6892.png)

任何见解都感激不尽。

.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:08:54.037

In my experience, if you write invalid markup, for example, an `a` tag within another `a` tag, or something like that, IE will either duplicate some tags or alter the HTML.

You should go through and make sure you aren't writing anything silly in there, its probably your problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T18:13:02.207

记得正确排除故障。首先我禁用了我的主题。没有骰子。然后我系统地禁用了与我主题的这一部分相关的插件，直到问题消失。

重新启用自定义主题。站点现在可以正确呈现。

故事的道德启示。不要太看重你的问题，你最初的预感可能不是通往幸福的正确道路。

# django - 当使用带有 django-selectable 的自动完成功能时，this.menu.deactivate 不是一个函数

> ID：14199705
> 
> 赞同：0
> 
> 时间：2013-01-07T16:12:41.340
> 
> 标签：django, jquery-ui

我曾经在模型`django-selectable`上搜索并拥有这个：`Company``name``lookup`

```
class FruitLookup(ModelLookup):
    model = Company
    search_fields = ('name__icontains', )

    def get_item_label(self, item):
        return u"%s,%s" % (item.name, item.logo.url)

from selectable.registry import registry    
registry.register(FruitLookup) 
```

在`views.py`：

```
companyForm=FruitForm()
return render_to_response('PersonHub/addCompanyPosition.html',{'companyForm':companyForm},context_instance=RequestContext(request)) 
```

在模板中：

```
<form id="frmCompanyPositionAdd"  action="" method="POST" style='padding-left:10px;padding-right:10px' >
{{companyForm}}
</form> 
```

在模板标题中：

```
function formatLabel(label, item) {
    var data = label.split(',');
    $('.ui-autocomplete').css({ 'float': 'right','text-align':'right'});
    return "<span><span>"+data[0]+"</span>&nbsp;<span><img class='size32' src='"+data[1]+"' /></span></span>";
}
$('#id_autocomplete').djselectable('option', 'formatLabel', formatLabel); 
```

我将所选公司的 ID 保存在 id= 的隐藏输入中`id_chosen_company`：

```
$( "#id_autocomplete" ).on( "autocompleteselect", function( event, ui ) {jQuery('#id_chosen_company').val(ui.item.id);} ); 
```

但是当我`company name`使用 id= 输入输入时，`id_autocomplete`我在 firefox 中收到此错误：

```
this.menu.deactivate is not a function

this.menu.deactivate(); 
```

并在 chrome 中得到这个错误：

```
Uncaught TypeError: Object [object Object] has no method 'deactivate' 
```

虽然返回了 json 格式的结果列表，但是没有显示结果列表，我得到了提到的错误！！ **注意：**错误发生在`jquery.dj.selectable.js`.

# c++ - CMake：在静态库中包含库依赖项

> ID：14199708
> 
> 赞同：43
> 
> 时间：2013-01-07T16:12:59.360
> 
> 标签：c++, cmake

我正在 CMake 中构建一个**静态**库，它依赖于许多其他静态库。我希望它们都包含在输出 .lib/.a 文件中，这样我就可以将一个大的 lib 文件发送给客户。在 Visual Studio 2010 中，有一个选项*"Link Library Dependencies"*正是这样做的。

但我在 CMake 中找不到如何做到这一点。您可以通过 CMake 设置此标志，还是以其他方式获得相同的结果？我已经尝试过 target_link_libraries(...) 和 add_dependencies(...)，但 CMake 似乎只是忽略了静态库的这一行。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-07T17:13:08.223

好的，所以我有一个解决方案。首先，重要的是要认识到静态库不会将其他静态库链接到代码中。必须创建一个组合库，在 Linux 上可以使用`ar`. 有关更多信息，请参阅*[将静态库链接到其他静态库](https://stackoverflow.com/questions/2157629/linking-static-libraries-to-other-static-libraries)*。

考虑两个源文件：

### 测试1.c：

```
 int hi()
 {
   return 0;
 } 
```

### 测试2.c：

```
int bye()
{
  return 1;
} 
```

该`CMakeLists.txt`文件是创建两个库，然后创建一个组合库，如下所示：

```
project(test)

    add_library(lib1 STATIC test1.c)
    add_library(lib2 STATIC test2.c)

    add_custom_target(combined ALL
      COMMAND ${CMAKE_AR} rc libcombined.a $<TARGET_FILE:lib1> $<TARGET_FILE:lib2>) 
```

在这种情况下，命令的选项与`ar`平台相关，尽管`CMAKE_AR`变量与平台无关。我会四处寻找是否有更通用的方法来做到这一点，但这种方法适用于使用`ar`.

* * *

基于*[如何设置 CMAKE_AR 的选项？](https://stackoverflow.com/questions/5659225/how-do-i-set-the-options-for-cmake-ar)*，看起来更好的方法是：

```
add_custom_target(combined ALL
   COMMAND ${CMAKE_CXX_ARCHIVE_CREATE} libcombined.a $<TARGET_FILE:lib1> $<TARGET_FILE:lib2>) 
```

这应该与平台无关，因为这是 CMake 用于在内部创建档案的命令结构。当然，您要传递给存档命令的唯一选项是`rc`这些选项硬连线到 CMake 中以用于该`ar`命令。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-10-01T13:35:29.097

我想通过提供我的`CMakeLists.txt`文件来增强其他解决方案，该文件在构建依赖项方面也确实有效。

**滥用 CMake 的解决方案**

```
cmake_minimum_required(VERSION 2.8)

add_library(lib1 test1.cpp)
add_library(lib2 test2.cpp)
include_directories(${CMAKE_CURRENT_DIR})
add_executable(mainexec main.cpp)
target_link_libraries(mainexec combinedLib)  # Important to place before add_custom_target

set(LIBNAME "combinedLib.lib")

add_custom_command(
    OUTPUT ${LIBNAME}
    COMMAND lib.exe /OUT:${LIBNAME} $<TARGET_FILE:lib1> $<TARGET_FILE:lib2>
    DEPENDS lib1 lib2
    COMMENT "Combining libs..."
)

add_custom_target(combinedLib
    DEPENDS ${LIBNAME}
) 
```

请注意，到目前为止，此解决方案适用于 Visual Studio，但我想它可以兼容多平台。我可以想象以下版本可能适用于基于 Unix 的平台：

```
set(LIBNAME "libCombinedLib.a")

add_custom_command(
    OUTPUT ${LIBNAME}
    COMMAND ar -rcT ${LIBNAME} $<TARGET_FILE:lib1> $<TARGET_FILE:lib2>
    DEPENDS lib1 lib2
    COMMENT "Combining libs..."
) 
```

请注意，这些解决方案会以某种方式滥用 CMake，因为如果您在声明`target_link_libraries`之后进行调用，它会抱怨 UTILITY 类型的目标（而不是 STATIC 或 SHARED） 。`add_custom_target`

**CMake 目标声明兼容的解决方案**

为了使其符合 CMake，您可以将 `target_link_libraries' 调用替换为

```
target_link_libraries(mainexec ${LIBNAME})
add_dependencies(mainexec combinedLib) 
```

就我而言，它并不完全令人满意，因为尽管它希望所有依赖项都由调用处理，但它`mainexec`必须知道。`combinedLib``target_link_libraries`

**耦合较少的替代解决方案**

进一步研究导入的目标，我最终找到了解决我最后一个问题的解决方案：

```
cmake_minimum_required(VERSION 2.8)

add_library(lib1 test1.cpp)
add_library(lib2 test2.cpp)
include_directories(${CMAKE_CURRENT_DIR})
add_executable(mainexec main.cpp)

set(LIBNAME "combinedLib.lib")

add_custom_command(
    OUTPUT ${LIBNAME}
    COMMAND lib.exe /OUT:${LIBNAME} $<TARGET_FILE:lib1> $<TARGET_FILE:lib2>
    DEPENDS lib1 lib2
    COMMENT "Combining libs..."
)

add_custom_target(combinedLibGenerator
    DEPENDS ${LIBNAME}
)

add_library(combinedLib STATIC IMPORTED)
set_property(TARGET combinedLib PROPERTY IMPORTED_LOCATION ${LIBNAME})
add_dependencies(combinedLib combinedLibGenerator)

target_link_libraries(mainexec combinedLib) 
```

如果您打算模块化整个 add `GLOBAL`after`STATIC IMPORTED`以使导入的目标全局可见。

**便携式 CMake 解决方案**

在当前的 CMake 版本中，CMake 完全支持传递依赖和接口库。然后一个接口库可以“链接”到其他库，而这个接口库又可以“链接”到其他库。为什么要引号？虽然这很好用，但这实际上并没有创建一个物理的组合库，而是为“子库”集创建了一种别名。这仍然是我们最终需要的解决方案，这就是我想在这里添加它的原因。

```
add_library(combinedLib INTERFACE)
target_link_libraries(combinedLib INTERFACE lib1 lib2)

target_link_libraries(mainexec combinedLib) 
```

就是这样！

# sql - 如果 stmt 使用 NoRows 或 Int？sql

> ID：14199714
> 
> 赞同：-1
> 
> 时间：2013-01-07T16:13:31.217
> 
> 标签：sql, sql-server, sql-server-2008

我对解决这个问题的最佳方法一无所知。当前查询很好。问题是如果没有返回行，我希望 if 语句为真。我也不想写两次查询，所以我如何以 if 语句为真并运行的方式编写它？

```
IF (select AnInt from ATable where Cond) = expectedInt
begin ... end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T16:19:12.987

如果 a`NULL` `AnInt`不可能，那么您可以使不匹配时的空子选择结果等于`expectedInt`

```
IF isnull((select AnInt from ATable where Cond), expectedInt) = expectedInt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:16:43.570

像这样？

```
DECLARE @Test INT

SELECT @Test = AnInt
FROM ATable
WHERE Cond

IF @Test IS NULL OR @Test = expectedInt
BEGIN
...
END 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T16:18:39.563

```
IF Coalesce((select TOP 1 AnInt from ATable where Cond),expectedInt) = expectedInt
begin
end 
```

# jquery - AngularJS - Jquery 滑块加载

> ID：14199716
> 
> 赞同：2
> 
> 时间：2013-01-07T16:13:39.860
> 
> 标签：jquery, slider, angularjs

我正在尝试在 angularjs 的部分中使用 jquery 插件。

**指示：**

```
app.directive('slideit',function() {
    return function(scope, elm, attrs) {
        elm.bxSlider({
          adaptiveHeight: true,
          mode: 'fade'
        });
    };
}); 
```

**HTML：**

```
<div id="sliderwrapper" >
    <ul class="slider" slideit>
        <li ng-repeat="image in dealer.images"><img ng-src="{{image}}" alt="" /></li> 
    </ul>
</div> 
```

输出显示 bxSlider() 在指令上成功运行。但是列表和/或标签没有被触及。仅使用普通的 AngularJS 代码，但不使用 jQuery 插件。

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T17:34:56.387

我认为问题在于时机。"slideit" 指令在你的列表被渲染之前被调用，然后它被 ngRepeat 再次完全重绘，bxSlider 甚至不怀疑这种情况正在发生。

只是为了验证这个假设（不要在生产中使用它，因为它非常难看，如果你的模型发生变化甚至可能不起作用）尝试：

```
app.directive('slideit',function() {
    return function(scope, elm, attrs) {
        setTimeout(function() {
            elm.bxSlider({
              adaptiveHeight: true,
              mode: 'fade'
            });
        }, 100);
    };
}); 
```

这里有一个更大的问题：您正在尝试使用 Angular 和 JQuery “编译” HTML，它们不一定兼容。为避免冲突，我建议在指令中手动渲染列表，然后在动态构造的 DOM 上调用 bxSlider。它不漂亮，但它应该更稳定。前任：

```
<ul slideit="dealer.images"></ul> 
```

指示：

```
app.directive('slideit',function() {
    return function(scope, elm, attrs) {
        scope.$watch(attrs.slideit, function(images) {
            var html = '';
            for (var i = 0; i < images.length; i++) {
                 html += '<li><img ng-src="' + images[i] + '" alt="" /></li>';
            }
            elm[0].innerHTML = html;
            elm.bxSlider({
              adaptiveHeight: true,
              mode: 'fade'
            });
        });
    };
}); 
```

（我没有测试过，这只是一个想法）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T17:27:40.160

这行得通。它有一个`ng-repeat`inside 指令。元素的`bxSlider`开始`ready()`。

```
app.directive('slideit',function() {
    return {
       restrict: 'A',
       replace: true,
       scope: {
         slideit: '=' 
       },
       template: '<ul class="bxslider">' +
                   '<li ng-repeat="slide in slides">' +
                     '<img ng-src="{{slide.src}}" alt="" />' +
                   '</li>' +
                  '</ul>',
       link: function(scope, elm, attrs) {
          elm.ready(function() {
            scope.$apply(function() {
                scope.slides = scope.slideit;
            });                    
            elm.bxSlider({
              adaptiveHeight: true,
              mode: 'fade'});   
            });
       }
    }; 
}); 
```

**HTML：**

```
<div slideit="images"></div> 
```

**编辑：**这是一个[plnkr](http://plnkr.co/edit/cNQp3L)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T17:16:47.653

想通了：
添加以下指令：

```
app.directive("mySlider", function() {
    return {
        restrict: 'E',
        replace: true,
        scope: true,
        template: '<ul class="slider"><li check-last ng-repeat="image in dealer.images"><img ng-src="{{image}}" alt="" /></li></ul>'
    };
});
app.directive('checkLast', function () {
        return function (scope, element, attrs) {
            //console.log(scope.$position);
            if (scope.$last=== true) {
                element.ready(function () {
                    $('.slider').bxSlider({
                      mode: 'fade',
                      pager: false
                    });    
                })
            }
        }
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-10T05:43:44.767

只需维护文件js文件的依赖即可！

```
 <script src="/yii-application/frontend/web/js/libraries/angular/angular.min.js"></script>
 <script src="/yii-application/frontend/web/js/libraries/angular/angular-ui.js"></script>
 <script src="/yii-application/frontend/web/js/recordata/country.js"></script>
 <script src="/yii-application/frontend/web/js/libraries/jquery/jquery-1.11.3.min.js"></script>
  <script src="/yii-application/frontend/web/js/libraries/flex/jquery.bxslider.min.js"></script>
  <script src="/yii-application/frontend/web/assets/e3dc96ac/js/bootstrap.min.js"></script>
  <script src="/yii-application/frontend/web/js/libraries/jquery-ui/jquery-ui.min.js"></script>
  <script src="/yii-application/frontend/web/js/searchResult.js"></script>
  <script src="/yii-application/frontend/web/js/Flight.js"></script> 
```

像下面！！！！

# c# - BindingFailure 在 Web 服务调用期间检测到错误

> ID：14199717
> 
> 赞同：1
> 
> 时间：2013-01-07T16:13:45.467
> 
> 标签：c#, .net, winforms, asmx, runtime-error

我收到以下错误：

> 显示名称为“MyWinFormsAssembly”的程序集未能在 ID 为 1 的 AppDomain 的“LoadFrom”绑定上下文中加载。失败的原因是：System.IO.FileNotFoundException：无法加载文件或程序集“MyWinFormsAssembly.Services.XmlSerializers” , Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 或其依赖项之一。该系统找不到指定的文件。

我知道我可以跳过这个错误，我知道我之前在进行 XML 序列化时收到过这个错误；但这发生在 Web 服务调用上。

该 Web 服务调用继续失败，并出现另一个错误：

> 无法加载文件或程序集“MyWinFormsAssembly.Services.XmlSerializers，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。

实际上，我得到了两组这样的错误，它们背靠背调用 Web 服务；然后程序失败了，它只是停止、崩溃、死机，再也没有了。

奇怪的是，如果我开始一个新项目，我可以调用相同的 Web 服务，使用相同的 Web 服务参考代码；它工作得很好，在一个新的 WinForms、WPF、WebForms、控制台和 MVC 项目中，分别测试了一个。

但是当我将核心 dll 和程序集添加回其中时；我最终得到这个错误。我**第一次尝试调用这个**行代码上调用它，但仍然得到错误。我已经注释掉了所有其他配置数据，将其卸载到另一个程序集，它在我的主项目之外再次正常工作，并尝试再次运行它，第一行代码，没有配置数据，所有内容都被注释掉了，它仍然失败。

我得到的唯一半导数，我不太明白，也不知道如何检查它，是我可能有命名冲突吗？

我已经将 Web 服务放在它自己的 XML 命名空间中，并将其重命名为与 Windows 窗体程序集不同的名称（因为有人将它命名为相同的名称）。

我还将 Windows 窗体程序集重命名为完全不同的名称，并将我的大部分类卸载到单独的“核心”程序集。我将 Web 服务代码本身、其配置以及所有内容卸载到“服务”程序集（它找不到 XmlSerializers 的程序集），但它仍然无法正常工作。

我为此绞尽脑汁将近一个星期，现在我们在生产版本上落后了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:34:50.520

`sgen.exe`为 Web 服务和服务包装器生成一个 Serializers.dll ，**每个**引用的程序集似乎都可以修复它。

但这并不能解释为什么我首先遇到问题的根源，或者您将如何调试它；或者为什么我需要生成一个序列化程序 dll？那里一定有更好的答案。

# python - 状态变化时记录差异 - Pandas

> ID：14199718
> 
> 赞同：1
> 
> 时间：2013-01-07T16:13:45.837
> 
> 标签：python, pandas

我有带有 ID、时间戳和状态的客户记录。

```
ID, TS, STATUS
1 10 GOOD
1 20 GOOD
1 25 BAD
1 30 BAD
1 50 BAD
1 600 GOOD
2 40 GOOD
.. ... 
```

我正在尝试计算每个客户在连续 BAD 状态中花费的时间（让我们想象上面的顺序是正确的）。因此，对于客户 id=1，30-25,50-30,600-50 总共花费了 575 秒处于 BAD 状态。

在 Pandas 中这样做的方法是什么？如果我在 TS 上计算 .diff() ，那会给我带来差异，但我如何才能将 1) 与客户 2) 某些状态“阻止”该客户？

样本数据：

```
df = pandas.DataFrame({'ID':[1,1,1,1,1,1,2],
                       'TS':[10,20,25,30,50,600,40],
                       'Status':['G','G','B','B','B','G','G']
                       },
                      columns=['ID','TS','Status']) 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T02:38:44.820

这是一个单独聚合每个连续的不良状态块的解决方案（您问题的第 2 部分？）。

```
In [5]: df = pandas.DataFrame({'ID':[1,1,1,1,1,1,1,1,2,2,2],
                               'TS':[10,20,25,30,50,600,650,670,40,50,60],
                               'Status':['G','G','B','B','B','G','B','B','G','B','B']
                               },
                               columns=['ID','TS','Status'])

In [6]: grp = df.groupby('ID')

In [7]: def status_change(df):
   ...:         return (df.Status.shift(1) != df.Status).astype(int)
   ...: 

In [8]: df['BlockId'] = grp.apply(lambda df: status_change(df).cumsum())

In [9]: df['Duration'] = grp.TS.diff().shift(-1)

In [10]: df
Out[10]: 
    ID   TS Status  BlockId  Duration
0    1   10      G        1        10
1    1   20      G        1         5
2    1   25      B        2         5
3    1   30      B        2        20
4    1   50      B        2       550
5    1  600      G        3        50
6    1  650      B        4        20
7    1  670      B        4       NaN
8    2   40      G        1        10
9    2   50      B        2        10
10   2   60      B        2       NaN

In [11]: df[df.Status == 'B'].groupby(['ID', 'BlockId']).Duration.sum()
Out[11]: 
ID  BlockId
1   2          575
    4           20
2   2           10
Name: Duration 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:47:06.680

```
In [1]: df = DataFrame({'ID':[1,1,1,1,1,2,2],'TS':[10,20,25,30,50,10,40],'Stat
us':['G','G','B','B','B','B','B']}, columns=['ID','TS','Status'])

In [2]: f = lambda x: x.diff().sum()

In [3]: df['diff'] = df[df.Status=='B'].groupby('ID')['TS'].transform(f)

In [4]: df
Out[4]:
   ID  TS Status  diff
0   1  10      G   NaN
1   1  20      G   NaN
2   1  25      B    25
3   1  30      B    25
4   1  50      B    25
5   2  10      B    30
6   2  40      B    30 
```

说明：`dataframe`仅对具有所需状态的那些记录进行子集。 `Groupby`ID 并将 lambda 函数`diff().sum()`应用于每个组。使用`transform`而不是`apply`因为`transform`返回一个索引系列，您可以使用它来分配给新列 'diff'。

编辑：对扩大问题范围的新回应。

```
In [1]: df
Out[1]:
   ID   TS Status
0   1   10      G
1   1   20      G
2   1   25      B
3   1   30      B
4   1   50      B
5   1  600      G
6   2   40      G

In [2]: df['shift'] = -df['TS'].diff(-1)

In [3]: df['diff'] = df[df.Status=='B'].groupby('ID')['shift'].transform('sum')
In [4]: df
Out[4]:
   ID   TS Status  shift  diff
0   1   10      G     10   NaN
1   1   20      G      5   NaN
2   1   25      B      5   575
3   1   30      B     20   575
4   1   50      B    550   575
5   1  600      G   -560   NaN
6   2   40      G    NaN   NaN 
```

# treeview - 使用 HierarchicalDataSource 将两个参数传递给子级树视图

> ID：14199719
> 
> 赞同：1
> 
> 时间：2013-01-07T16:13:45.840
> 
> 标签：treeview, kendo-ui

如何将 2 个参数发送到子级树视图。

样本：

```
var data2 = {
  transport: {
    read: {
      url: function(options) {
        console.log(options);
        return kendo.format("/url2/", [options.param1, options.param2]);
      },
      dataType: "jsonp"
    }
  },
  schema: {
    model: {
      id: "param4",
      fields: {
        param4: {type: "number"},
        param5: {type: "string"},
      },
      hasChildren: "param4",
    }
  }
};
var data1 = new kendo.data.HierarchicalDataSource({
  transport: {
    read: {
      url: "/url/",
      dataType: "jsonp"
    }
  },
  schema: {
    model: {
      id: "param1",
      fields: {
        param1: {type: "number"},
        param2: {type: "number"},
        param3: {type: "string"},
      },
      hasChildren: "param1",
      children: data2
    }
  }
});

$("#treeview").kendoTreeView({
  dataSource: data1,
  dataTextField: ["param3", "param5"]
}); 
```

当我`console.log(options);`只使用传递的参数调试代码时`param1`。我怎么能得到`param2`？

[KendoUi Demos](http://demos.kendoui.com/web/treeview/remote-data.html)没有示例或文档，有没有简单的方法或者我必须为此记录所有选择路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T21:40:49.873

您将获得可用于从数据源获取对象的项目的 ID。

```
var item = data1.get(options.param1); 
```

这是一个例子......

[http://jsbin.com/alibem/1/edit](http://jsbin.com/alibem/1/edit)

# openerp - OpenERP 7 的高级设置在哪里？

> ID：14199721
> 
> 赞同：1
> 
> 时间：2013-01-07T16:13:49.563
> 
> 标签：openerp

在 v6.1 中，您可以直接在该`Settings`区域的 UI 上进行高级配置。

在 v7 中，我可以在哪里自定义用户组、电子邮件模板、自动操作、计划操作……？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T17:50:01.693

Found it!

*   activate the `Technical Features` check box in the user's `Access Rights` tab.

![enter image description here](../Images/30730593a0748cd09a3a8eacde6186f2.png)

# php - 对同一用户使用 MySQL 最后插入 id

> ID：14199725
> 
> 赞同：0
> 
> 时间：2013-01-07T16:14:11.573
> 
> 标签：php, mysql, insert, race-condition

我在我的代码中使用 mysql_insert_id 来获得自动增量。

我已经阅读过，看起来对于不同的用户连接没有竞争条件，但是同一个用户呢？当使用相同的用户名/用户连接到数据库但仍来自不同的连接会话时，我是否可能会遇到竞争条件问题？

我的应用程序是 PHP。当用户提交 Web 请求时，我的 PHP 会执行代码，并且对于那个特定的请求/连接会话，我会在该请求的长度内保持与 MySQL 的持久 SQL 连接。这会给我带来任何比赛条件问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:15:38.373

没有任何实际目的，如果您在执行插入后立即执行 last_id 请求，那么实际上没有足够的时间让另一个插入破坏它。理论上可能

根据[PHP 手册](http://php.net/manual/en/function.mysql-insert-id.php)

> 笔记：
> 
> 因为 mysql_insert_id() 作用于最后执行的查询，所以一定要在生成值的查询之后立即调用 mysql_insert_id()。

万一您想仔细检查，您可以使用此功能来确认您之前的查询

[mysql_info](http://php.net/manual/en/function.mysql-info.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:20:44.363

使用持久连接并不意味着每个请求都将使用相同的连接。这意味着每个 apache 线程都有自己的连接，该连接在该线程上执行的所有请求之间共享。

请求将连续运行（一个接一个），这意味着同时运行的两个线程不会使用相同的持久连接。

因此，您的`last_insert_id`值将是安全的，但请确保在使用它之前检查插入的结果，因为它将*返回*最后一次成功插入的 last_insert_id，即使它不是最后一次执行的插入。

# python - pywebkitgtk：无头 + 完整的 DOM 交互可能吗？

> ID：14199727
> 
> 赞同：1
> 
> 时间：2013-01-07T16:14:16.330
> 
> 标签：python, webkit, gtk

我目前正在使用[Python Webkit DOM 绑定](http://www.gnu.org/software/pythonwebkit/)以编程方式与网站交互，这对我有用。

唯一的问题是它坚持要打开一个 GTK 窗口来显示页面。有人想出办法阻止它打开窗户吗？即以**无头**方式使用它？

我正在像这样初始化视图：

```
 wv = pywebkitgtk.WebView(1024, 768, url=url) 
```

它隐式打开 GTK 窗口，然后我有一个 onload 事件处理程序来操作 DOM。

我首先想到子类化 WebView，但这是不可能的，因为它是一个编译类。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-07T19:36:17.587

我是负责 pythonwebkit 的开发人员，并且我在跨多个平台的这些领域拥有丰富的专业知识。实际上，您真的非常想要一个完全“无头”的 WebKit 端口。在 pythonwebkit 中，这实际上不应该太难做，因为只有三个“入口点”函数（一个用于窗口，一个用于文档，一个用于 XMLHTTPRequest）。

真的，有人应该做一个适当的“完全无头”的 WebKit 端口。在 WebKit 的源代码树中已经有一个非常接近的示例程序，也许这会让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T19:47:50.013

您可以尝试使用 Xvfb。我喜欢使用命令行并手动设置我的显示，但如果你不喜欢你可以使用这个：[http ://cgoldberg.github.io/xvfbwrapper/](http://cgoldberg.github.io/xvfbwrapper/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T19:55:20.877

我一直在使用 PyQT。PyQTWebView 在 Webkit 上运行并且效果很好。查看[Ghost.py](http://jeanphix.me/Ghost.py/)以开始使用，或直接使用 PyQT 的 API。完全无头运行，并支持相当新的 Webkit 构建。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T19:40:47.473

你能得到 GTK 窗口的句柄然后调用`window.hide()`吗？否则，您可能只需要使用完整的 Webkit 库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T10:43:22.407

创建一个窗口并在那里添加webview，并且从不显示窗口..

我有 webviews 运行而不显示它们，如果我需要显示它们可以调用 show_all。

```
web_view = pywebkitgtk.WebView()
window = gtk.Window(gtk.WINDOW_TOPLEVEL)
sw = gtk.ScrolledWindow(hadjustment=None, vadjustment=None)
sw.set_policy(gtk.POLICY_NEVER, gtk.POLICY_NEVER)
sw.add(web_view)
window.add(sw)

#window.show_all() 
```

# macos - 区分魔术鼠标/触控板滚动事件

> ID：14199728
> 
> 赞同：2
> 
> 时间：2013-01-07T16:14:18.853
> 
> 标签：macos, iokit, cgeventtap

在 Event Tap 中，我需要区分来自魔术鼠标的滚动事件和来自触控板的滚动事件。

有没有人可以解决这个问题？有没有办法从 CGEvent 中获取生成设备的产品 ID？IOkit 可以在这里帮助我吗？

# android - 将使用 .so 文件的 JAR 导入新的 android 项目

> ID：14199729
> 
> 赞同：0
> 
> 时间：2013-01-07T16:14:20.077
> 
> 标签：android, jar

我正在尝试使用打包在 JAR 文件中的库来构建应用程序。

当我调用其中一个函数时，出现此错误：

异常 Ljava/lang/UnsatisfiedLinkError; 初始化**library.class时抛出**

我检查了库的源代码，我认为它在加载一些 .so 文件（ System.loadLibrary("usb-1.0") 时会崩溃；这些文件确实存在于 libs/armeabi 下的 JAR 项目中（libusb-1.0.所以）

我猜 .so 文件没有与 JAR 一起打包，那么如何在我的项目中找到它们？

（试图将它们复制到 libs/armeabi 但抛出相同的异常......）

我没有收到任何链接/构建错误....

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:59:44.053

普通的 JAR 文件无法分发依赖于 Android NDK 编译库的内容。但是，Android 库项目*也*可以分发 NDK 编译的库。

> 但真正的问题是我的应用程序也将成为一个库，我不知道在它使用其他库时是否可以将其设为库

假设“使其成为库”==“使其成为 Android 库项目”，这很好，只要尝试使用您的库项目的项目也可以访问其他库项目。

# jquery - 为什么此图像交换不起作用

> ID：14199738
> 
> 赞同：0
> 
> 时间：2013-01-07T16:14:36.163
> 
> 标签：jquery, html

所以我对 Jquery 和 Javascript 完全陌生，我一直在寻找一种在悬停时交换两个不同图像的方法。到目前为止没有任何反应......所以我的问题是为什么这个 Jquery 函数在悬停时不交换图像。

```
 jQuery(function(){
     $(".nav-button").hover(
          function(){this.src = this.src.replace("http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png","http://i1256.photobucket.com/albums/ii488/terafanb/guildwars2/26.png");},
          function(){this.src = this.src.replace("http://i1256.photobucket.com/albums/ii488/terafanb/guildwars2/26.png","http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png");
     });
}); 
```

这里是它操作的 html。

```
<ul id="nav">
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
              <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="31" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="32" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="32" alt="" /></li>
               <li class="nav-button"><img src="http://i1065.photobucket.com/albums/u381/dice027/nyan-cat.png" width="225" height="30" alt="" /></li>
         </ul> 
```

完全披露我在这里得到了该功能的设计[http://www.designchemical.com/blog/index.php/jquery/quick-and-easy-jquery-image-swap/](http://www.designchemical.com/blog/index.php/jquery/quick-and-easy-jquery-image-swap/)

这就是我测试功能的地方 [http://codepen.io/Austin-Davis/pen/IpDLu](http://codepen.io/Austin-Davis/pen/IpDLu)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T16:16:04.727

因为您匹配的元素`".nav-button"`不是图像。所以`this`没有财产`src`。

用这个 ：

```
 $(".nav-button img").hover( 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:20:06.320

您`this`指的是`$(".nav-button")`，而不是`$(".nav-button img")`。一个更好的改变方法`src`是使用`.attr()`方法。

# android - 更改视图的背景颜色？

> ID：14199742
> 
> 赞同：1
> 
> 时间：2013-01-07T16:14:43.893
> 
> 标签：android, view, background, android-linearlayout

我想创建一个子类`linear layout`，它的背景颜色必须改变黑色或白色。我写了这段代码：

```
public class MyLayout extends LinearLayout implements Runnable {

    int color = 0xFFFFFFFF;

    public MyLayout(Context context) {
        super(context);
        Thread t = new Thread(this);
        t.start();
    }

    @Override
    public void run() {
        while (true) {
            try {
                Thread.sleep(1000);
                if(color == 0xFF000000){
                    color = 0xFFFFFFFF;
                }else{
                    color = 0xFF000000;
                }
                this.setBackgroundColor(color);
                postInvalidate();
                System.out.println("Color >> " + color);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }

    }

} 
```

然后我将它设置为我的 Activity 的 ContentView：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(new MyLayout(this));
    } 
```

在模拟器中运行应用程序后，`run`方法的`MyLayout`执行没有任何异常，但背景颜色总是黑色。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:30:25.473

嗨试试这个它的工作。

```
public class MyLayout extends LinearLayout implements Runnable {

    int color = 0xFFFFFFFF;

    public MyLayout(Context context) {
        super(context);
        myView = this;
        Thread t = new Thread(this);
        t.start();
    }

    private View myView;

    @Override
    public void run() {

        try {
            while (true) {
                Thread.sleep(1000);

                runOnUiThread(new Runnable() {

                    @Override
                    public void run() {
                        // TODO Auto-generated method stub
                        if (color == 0xFF000000) {
                            color = 0xFFFFFFFF;
                        } else {
                            color = 0xFF000000;
                        }
                        myView.setBackgroundColor(color);
                        postInvalidate();
                        System.out.println("Color >> " + color);
                    }
                });
            }
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

} 
```

每当您想通过其他线程对用户界面进行任何更改时，请在 runOnUiThread 中运行您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:26:19.107

在您尝试过 postInvalidate() 的地方尝试 invalidate()

其他提示：您正在创建一个新的 LinearLayout，**但未指定布局大小。** 我建议您在使用 setContentView 之前使用 setLayoutParams()：

```
MyLayout layout = new MyLayout(this);
layout.setLayoutParams(new LayoutParams(...));
this.setContentView(layout); 
```

此时，您正在创建一个大小为 0 的新布局（高度和宽度）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T18:42:54.460

在跟进@Hisham Muneer 时，我将我的活动实例发送给我的班级并且它有效。`runOnUiThread`是类中的一个方法`Activity`。这是最终代码：

```
public class MyLayout extends LinearLayout implements Runnable {

    int color = 0xFFFFFFFF;
    Activity context;

    public MyLayout(Activity context) {
        super(context);
        this.context = context;
        myView = this;
        Thread t = new Thread(this);
        t.start();
    }

    private View myView;

    @Override
    public void run() {

        try {
            while (true) {
                Thread.sleep(1000);

                context.runOnUiThread(new Runnable() {

                    @Override
                    public void run() {
                        // TODO Auto-generated method stub
                        if (color == 0xFF000000) {
                            color = 0xFFFFFFFF;
                        } else {
                            color = 0xFF000000;
                        }
                        myView.setBackgroundColor(color);
                        postInvalidate();
                        System.out.println("Color >> " + color);
                    }
                });
            }
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T17:17:47.217

您不能在线程中使用 Asynctask 更改它

[https://developer.android.com/reference/android/os/AsyncTask.html](https://developer.android.com/reference/android/os/AsyncTask.html)

```
 protected void onPostExecute(Long result) {
         //HERE YOU CAN CHANGE THE COLOR
      } 
```

# python - 无法使用 Youtube 数据 API 删除视频

> ID：14199745
> 
> 赞同：6
> 
> 时间：2013-01-07T16:14:57.847
> 
> 标签：python, video, youtube, youtube-api

无法使用 Youtube Data API 删除视频。我正在使用 Python 客户端库。

所有这些似乎都直接来自文档，所以我真的很困惑为什么它不起作用。这是我的功能：

```
def delete_youtube_video_by_id(video_id):
    yt_service = gdata.youtube.service.YouTubeService()
    yt_service.email = YOUTUBE_EMAIL
    yt_service.password = YOUTUBE_SECRET_PASSWORD
    yt_service.source = YOUTUBE_SOURCE
    yt_service.developer_key = YOUTUBE_SECRET_DEVELOPER_KEY
    yt_service.client_id = YOUTUBE_CLIENT_ID
    yt_service.ProgrammaticLogin()
    video_entry = yt_service.GetYouTubeVideoEntry(video_id=video_id)
    response = yt_service.DeleteVideoEntry(video_entry)
    return response 
```

从文档中，如果视频被成功删除，这应该返回 True。但是，它返回 None：

```
>>> response = delete_youtube_video_by_id('my_youtube_video_id')
>>> type(response)
<type 'NoneType'>
>>> 
```

并且视频没有被删除。我知道凭据很好，因为它们与我最初用来上传视频的凭据相同，而且我知道 id 很好，因为我是直接从 youtube 中的频道获得的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T17:03:02.103

我很确定这是因为需要从您的上传供稿中获取视频条目，而不是一般的视频供稿。否则条目不可编辑。

这将转化为

`video_entry = yt_service.GetYouTubeVideoEntry('https://gdata.youtube.com/feeds/api/users/default/uploads/VIDEO_ID')`

Python GData 客户端库仍然使用 Data API 的 v1，该版本已被弃用很长时间，并且客户端库总体上没有得到很好的维护。

我建议切换到[v3](https://developers.google.com/youtube/v3/)和相应的[新客户端库](https://developers.google.com/api-client-library/python/)，因为这绝对是未来的环境。我们现在有[一些 Python 示例可用](https://developers.google.com/youtube/v3/code_samples/python)，虽然没有专门用于删除视频的示例，但它应该看起来像

`youtube.videos().delete(id=VIDEO_ID).execute()`

（假设`youtube`是一个经过适当授权的 YouTube 客户端界面，遵循该页面上的现有示例）。

# html - 如何为我网站上的页面创建 Facebook 点赞计数器？

> ID：14199747
> 
> 赞同：2
> 
> 时间：2013-01-07T16:15:08.827
> 
> 标签：html, facebook, coldfusion

我想为我网站上的特定页面创建一个类似 Facebook 的计数器。

例如，我的网站上可能有这些页面，其中每个页面都有不同的文章：

```
www.mysite.com/article1.cfm

www.mysite.com/article2.cfm

www.mysite.com/article3.cfm 
```

我希望这些页面中的每一个都有自己的 Facebook“点赞”计数器元素，单击该元素时将跟踪该单个页面的点赞数。我试图查看 Facebook 对所有这些的解释，但我是 Facebook 开发的新手。我必须使用的主要服务器端语言是 ColdFusion——当然，如果有 JavaScript/jQuery 解决方案或其他方法来完成这个，我是开放的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:21:27.040

这是您将 facebook like 添加到页面的方式：

```
<html xmlns:fb="http://ogp.me/ns/fb#">
    <head>
    </head>
    <body>
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=YOUR_APP_ID";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>

        <div class="fb-like" data-href="http://www.yourwebsite.com" data-send="false" data-layout="box_count" data-width="450" data-show-faces="false"></div>
    </body>
</html> 
```

在哪里：

*   YOUR_APP_ID：必须是您可以通过拥有 facebook 开发者帐户创建的应用程序 ID。你可以去[这里创建一个](http://developers.facebook.com/)
*   [http://www.yourwebsite.com](http://www.yourwebsite.com)：是您网站的 URL。因为 facebook 喜欢实际发布到您的时间线，这将是它的链接

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:22:24.290

您需要的所有信息都在这里。非常简单的表单来创建和自定义您的喜欢按钮。

[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

*   您需要为每一页浏览一次。然后单击“获取代码”并将 FB 为您提供的内容复制并粘贴到您的相关网页中。

# c# - 克服 HTMLAgility 包中的歧义 (Windows Phone 7)

> ID：14199748
> 
> 赞同：1
> 
> 时间：2013-01-07T16:15:11.573
> 
> 标签：c#, windows-phone-7, html-agility-pack

我正在尝试 `/html/body/center/table/tbody/tr[5]/td[3]/font/font/span` 使用以下 xpath 获取特定节点的 InnerText
`doc.DocumentNode.SelectSingleNode("/html/body/center/table/tbody/tr[5]/td[3]/font/font/span").InnerText`

但相反，它使用以下 xpath 向我返回 InnerText `/html/body/center/form/table/tbody/tr[5]/td[3]/font/font/span`

我有什么错误吗？我必须更具体地使用 Xpath 吗？如果是这样，请通过指定如何更具体来帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T20:47:17.050

您在处理标签以修复错误编写的 HTML 时遇到了已知行为。[HTML Agility Pack 网站上有一个跟踪此](http://htmlagilitypack.codeplex.com/workitem/23074)问题的错误，幸运的是，有一个解决方法。

```
 HtmlDocument doc = new HtmlDocument();
        // v== Add this line before loading a document
        HtmlNode.ElementsFlags.Remove("form"); 
        doc.Load("doc.html"); 
```

# c++ - 跨平台文件结构处理

> ID：14199751
> 
> 赞同：2
> 
> 时间：2013-01-07T16:15:21.230
> 
> 标签：c++, file-io, cross-platform, cross-compiling

每当我需要定义文件结构时，我都会使用特定于编译器的命令（如`#pragma pack(1)`）来确保我可以安全地读取和写入此文件并且无需担心填充问题。

但是，还有其他方法可以达到相同的目标吗？我不需要反序列化复杂对象，只需 POD 类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:37:14.090

定义一个总是很好地映射到类型的内存表示的跨平台二进制格式是不可能的。

定义跨平台文件格式的两个选项是：

1.  使用文本
2.  根据您最喜欢的跨平台序列化库可以提供的内容定义二进制格式，并使用该库在其内部和外部表示之间转换文件内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:30:32.417

[Boost Serialization Library](http://www.boost.org/doc/libs/1_52_0/libs/serialization/doc/index.html)可能是一种选择，如果您希望快速解决它并且不费吹灰之力。

# mysql - MySQL表中时间戳之间的差异

> ID：14199752
> 
> 赞同：0
> 
> 时间：2013-01-07T16:15:22.383
> 
> 标签：mysql, intervals, timestamp

我有一个关于时间戳间隔计算的问题：

假设我有一个带有 ID 和时间戳的表：

```
Table tab1

tab1.id    deviceid    timestamp
-------    --------    ----------
1            15         2013-01-01 14:57:54
2            15         2013-01-01 14:58:09
3            23         2013-01-01 14:58:10
4            15         2013-01-01 14:58:30 
```

我想要做的是检查条目之间的间隔是在特定值之内还是之外。假设 15 秒是值：

1和2之间的间隔可以，2和3之间的间隔不行。

任何提示如何在不使用临时表和存储过程等的情况下解决这个问题？

预先感谢和亲切的问候

索利克

编辑：更新了表格。条目之间有来自其他设备的时间戳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:22:35.987

你可以从这个开始。这将与自身连接表格并计算 +1`id`以计算以秒为单位的差异。

```
SELECT a.id, 
   TIME_TO_SEC(TIMEDIFF(b.timestamp, a.timestamp)) AS time_diff
FROM tab1 a
LEFT JOIN tab1 b ON b.id = a.id + 1
WHERE b.id IS NOT NULL 
```

**结果**

```
| 身份证 | TIME_DIFF |
------------------
| 1 | 15 |
| 2 | 21 |
```

## [SQL小提琴](http://sqlfiddle.com/#!2/d75fd/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T07:40:21.777

解决方案：

njk 给了我正确的提示，但最后有必要使用存储过程和临时表：

这里很重要：临时表不能在查询中多次使用，因此我需要复制临时表：

```
BEGIN

DROP TEMPORARY TABLE IF EXISTS tmptable1;
DROP TEMPORARY TABLE IF EXISTS tmptable2;

CREATE TEMPORARY TABLE tmptable1 (tmpid INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY)
SELECT * FROM tbl_source WHERE tbl_source.Id = did;

CREATE TEMPORARY TABLE tmptable2 AS (SELECT * FROM tmptable1);

SELECT a.tmpid, a.timestamp, TIME_TO_SEC(TIMEDIFF(b.timestamp, a.timestamp)) AS time_diff
FROM tmptable1 a LEFT JOIN tmptable2 b
ON b.tmpid = a.tmpid +1
WHERE b.tmpid IS NOT NULL;

DROP TEMPORARY TABLE IF EXISTS tmptable1;
DROP TEMPORARY TABLE IF EXISTS tmptable2;

END 
```

# oracle - Oracle - PLS-00103：触发器 - 文件结束错误

> ID：14199758
> 
> 赞同：0
> 
> 时间：2013-01-07T16:15:38.033
> 
> 标签：oracle, plsql

我创建了上述触发器，但它给了我错误：PLS-00103：在期待以下之一时遇到符号“文件结尾”：符号“;” 被替换为“文件结尾”以继续

触发代码：

```
CREATE OR REPLACE TRIGGER
subView_insert_tr INSTEAD OF INSERT ON VSubscriber
DECLARE
 lendings           Lending_tab ;
 i                  INTEGER ;
 copy_book_var      Copy_list_T;
 copy_book_vartemp  REF Copy_list_T ;

BEGIN
  lendings := :NEW.Lending_List;
  INSERT INTO Subscriber (num_s, name) VALUES (:NEW.num_s, :NEW.name) ;
  FOR i IN 1..lendings.COUNT LOOP
   copy_book_vartemp := lendings(i).Copy_Book_REF;
   SELECT DEREF(copy_book_vartemp) INTO copy_book_var FROM DUAL ;

INSERT INTO LENDING (num_s, num_c) VALUES (
     :NEW.num_s, copy_book_var.num_c,
     lendings(i).d_L) ;
 END LOOP ;

END ;
/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:47:12.503

我认为问题出在这个插件上

```
INSERT INTO LENDING (num_s, num_c) VALUES (
     :NEW.num_s, copy_book_var.num_c,lendings(i).d_L) ; 
```

修改它，并尝试使用这个

```
CREATE OR REPLACE TRIGGER
subView_insert_tr INSTEAD OF INSERT ON VSubscriber
DECLARE
 lendings           Lending_tab ;
 i                  INTEGER ;
 copy_book_var      Copy_list_T;
 copy_book_vartemp  REF Copy_list_T ;

BEGIN
  lendings := :NEW.Lending_List;
  INSERT INTO Subscriber (num_s, name) VALUES (:NEW.num_s, :NEW.name) ;
  FOR i IN 1..lendings.COUNT LOOP
   copy_book_vartemp := lendings(i).Copy_Book_REF;
   SELECT DEREF(copy_book_vartemp) INTO copy_book_var FROM DUAL ;

INSERT INTO LENDING (num_s, num_c) VALUES (
     :NEW.num_s, copy_book_var.num_c);
  --   lendings(i).d_L) ;
 END LOOP ;

END ;
/ 
```

# java - 用变量名登录Java？

> ID：14199760
> 
> 赞同：5
> 
> 时间：2013-01-07T16:15:40.320
> 
> 标签：java, debugging, logging

在以前的工作中，我在 C++ 中工作，公司内部库有一个日志记录宏，我可以在其中简单地编写 LOG( *somevariable* )，它会输出到标准输出：

“*变量名*：*变量值*”

有谁知道在Java中是否有办法做到这一点？

我从没想过看他们的代码，所以我不知道它是如何完成的。不过真的很有用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:17:25.360

如果您使用 Eclipse，您可以使用“Watch Expression”-View 不仅可以查看变量，还可以查看方法调用。看到[这个](http://help.eclipse.org/juno/topic/org.eclipse.jdt.doc.user/reference/views/expressions/ref-addwatch.htm)。

如果您只想打印变量的值，可以使用 Eclipse 模板。转到`Windows->Preferences`并查找条目`Java->Editor->Templates`。添加一个新模板并将其命名为例如“printvar”。将以下内容添加到模板正文中：

```
System.out.println("${variable} = "+ ${variable}); 
```

在编码期间键入`printvar`然后按下`CTRL+Space`将生成输入的代码，并将`${variable}`其用作变量名称的占位符。您只需要输入一次变量名，这样可以节省时间和输入。

*顺便说一句：*您可以在 C++ 中创建允许像 LOG(variable_name) 这样的语法糖的宏的原因是因为 C++ 有一个预处理器：Java 没有。Java 预处理器有一些实现，但我认为对于像打印变量名后跟其值这样简单的问题，使用一个会花费太多精力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:21:18.990

如果您`soutv + TAB`在 Intellij 和 Netbeans 上键入，它会为您提供您可能想要打印的变量列表。

![在此处输入图像描述](../Images/b0422711a2f2f6c17e7541543340c863.png)

我复制了这个并将其更改为使用记录器而不是`logv + TAB`

![在此处输入图像描述](../Images/e53a01a4ee1e61bc3609f739b8f3bb9b.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:25:52.617

典型的技术是使用 log4j，或 logback，或其他东西。也许是由 slf4j 介导的。这通常需要每个类有一个静态变量，这反过来会导致日志消息告诉您它们来自哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:38:25.127

您在 java 中没有 MACRO，但是您可以在某个类上使用静态方法执行类似的操作。没有变量名，但确实具有类类型。

```
class DebugUtil
{
  public void static LOG(Object obj)
  {
    LOG(System.out, obj.getClass().getName(), obj);
  }

  public void static LOG(String name, Object obj)
  {
    LOG(System.out, name, obj);
  }

  public void static LOG(PrintStream ps, String name, Object obj)
  {
    ps.println(name + ":" + obj);
  }
} 
```

然后用于使用

```
String foo = "bar";
Debug.Util.LOG(foo);
Debug.Util.LOG("foo", foo); 
```

# apache - htaccess 子域到主域

> ID：14199762
> 
> 赞同：0
> 
> 时间：2013-01-07T16:15:45.437
> 
> 标签：apache, redirect, subdomain

我们正在尝试为我们的网站创建 .htaccess 重定向，这是我们想要做的：

我们的域名： http: [//freewebsites.com](http://freewebsites.com)

我们希望将所有访问[http://freewebsites.com/username](http://freewebsites.com/username)的用户重定向到[http://username.freewebsites.com/](http://username.freewebsites.com/)

这应该适用于任何访问该网站的人。所以，我们不需要索引文件什么的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T14:33:23.170

最好的方法是使用带有 GET 变量的 PHP

创建一个名为 index.php 的页面并将此代码放入其中

```
<?php
// check to see if Variable 'Username' is sent to it
if(isset($_GET["Username"])){
// if sent set User var
$user = $_GET["Username"];
//Send user to domain
header("Location: http://$user.freewebsites.com");

}else{
// if not send back to main domain
header("Location: http://freewebsites.com");
}
?> 
```

如果您将用户发送到 URL，则使用它

```
http://freewebsites.com/index.php?Username=TestUser 
```

将发送至

```
http://TestUser.freewebsites.com 
```

# javascript - Javascript函数变量范围传递地理定位

> ID：14199768
> 
> 赞同：1
> 
> 时间：2013-01-07T16:16:17.957
> 
> 标签：javascript, variables, geolocation, scope

我只是想从 HTML5 的 geolocation.getCurrentPosition 函数中获取变量。但是，让我的变量在函数之外定义时遇到了很多困难。

该函数使用以下代码工作：

```
<script>
var latitude;
var longitude;
var accuracy;
var altitude;
var altitudeAccuracy;
var heading;
var speed;

if (navigator.geolocation){
  navigator.geolocation.getCurrentPosition(  
    function (position) {
      latitude = position.coords.latitude;
      longitude = position.coords.longitude;
      alert(longitude)
      accuracy = position.coords.accuracy;
      altitudeAccuracy = position.coords.altitudeAccuracy;
      heading = position.coords.heading;
      speed = position.coords.speed;
    }
  );
}

// alert(latitude); 
```

在这里，我看到`alert(longitude)`返回一个数值。但是，当我注释掉该行并取消注释时`alert(latitude)`，我会收到“未定义”警报。

任何帮助将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:17:31.310

因为`getCurrentPosition`是异步调用。

您需要等待回调触发，然后才能访问它检索的值。

```
function nextStep(){
    alert(latitude);
}

navigator.geolocation.getCurrentPosition(  
    function (position) {
      latitude = position.coords.latitude;
      longitude = position.coords.longitude;
      alert(longitude)
      accuracy = position.coords.accuracy;
      altitudeAccuracy = position.coords.altitudeAccuracy;
      heading = position.coords.heading;
      speed = position.coords.speed;
      nextStep();
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:25:54.583

getCurrentPosition 是一个异步调用

在 javascript 中，并发使用“运行到完成”模型。这意味着当前函数中的所有代码都将在它移动到下一个执行上下文之前完成。在您的原始代码中，代码将按以下顺序执行：

*   变量定义
*   getCurrentPosition 已初始化
*   警报（纬度）
*   脚本完成

然后它将进入下一个执行上下文并运行您的回调函数，此时将设置变量并运行另一个警报。如果要确保首先设置变量，则需要在回调中运行警报

# text - iOS6 单元格文本背景颜色

> ID：14199778
> 
> 赞同：0
> 
> 时间：2013-01-07T16:16:45.130
> 
> 标签：text, ios6, tableview, cell, background-color

在我的 tableView 单元格中，我的文本上有一个背景色，我不知道如何删除它。有人可以帮我吗？

![在此处输入图像描述](../Images/29d30750d927ba58705407112e328a59.png)

我试过了

```
cell.backgroundColor = [UIColor clearColor];
cell.opaque = NO; 
```

但不工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:22:53.600

你有没有尝试过：

```
cell.textLabel.backgroundColor = [UIColor clearColor];
cell.textLabel.opaque = NO; 
```

和：

```
cell.detailTextLabel.backgroundColor = [UIColor clearColor];
cell.detailTextLabel.opaque = NO; 
```

# ruby - 将 CSV 文件转换为哈希数组

> ID：14199784
> 
> 赞同：60
> 
> 时间：2013-01-07T16:17:06.770
> 
> 标签：ruby, csv, multidimensional-array

我有一个 csv 文件，一些曲棍球数据，例如：

```
09.09.2008,1,HC Vitkovice Steel,BK Mlada Boleslav,1:0 (PP)
09.09.2008,1,HC Lasselsberger Plzen,RI OKNA ZLIN,6:2
09.09.2008,1,HC Litvinov,HC Sparta Praha,3:5 
```

我想将它们保存在哈希数组中。我没有任何标题，我想为每个值添加键`"time" => "09.09.2008"`，依此类推。每一行都应该通过类似的方式来访问`arr[i]`，每个值都可以通过 example来访问`arr[i]["time"]`。我更喜欢`CSV`class 而不是`FasterCSV`or `split`。你能指出方法或重定向到解决类似问题的某个线程吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2014-03-28T19:36:58.260

# 刚过`headers: true`

```
CSV.foreach(data_file, headers: true) do |row|
  puts row.inspect # hash
end 
```

从那里，您可以随心所欲地操纵哈希。

（用 Ruby 2.0 测试过，但我认为这已经工作了很长一段时间。）

## 编辑

您说您没有任何标题 - 您可以在阅读文件内容后在文件内容的开头添加标题行吗？

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-01-07T16:26:34.743

您可以使用[Ruby CSV 解析器](http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html)对其进行解析，然后`Hash[ keys.zip(values) ]`将其用作哈希。

例子：

```
test = '''
09.09.2008,1,HC Vitkovice Steel,BK Mlada Boleslav,1:0 (PP)
09.09.2008,1,HC Lasselsberger Plzen,RI OKNA ZLIN,6:2
09.09.2008,1,HC Litvinov,HC Sparta Praha,3:5
'''.strip

keys = ['time', etc... ]
CSV.parse(test).map {|a| Hash[ keys.zip(a) ] } 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-12-30T19:23:41.593

这是 Josh Nichols 的一篇[精彩的文章](http://technicalpickles.com/posts/parsing-csv-with-ruby)，它解释了如何做你所要求的。

总而言之，这里是他的代码：

```
csv = CSV.new(body, :headers => true, :header_converters => :symbol, :converters => [:all, :blank_to_nil])
csv.to_a.map {|row| row.to_hash }
=> [{:year=>1997, :make=>"Ford", :model=>"E350", :description=>"ac, abs, moon", :price=>3000.0}, {:year=>1999, :make=>"Chevy", :model=>"Venture \"Extended Edition\"", :description=>nil, :price=>4900.0}, {:year=>1999, :make=>"Chevy", :model=>"Venture \"Extended Edition, Very Large\"", :description=>nil, :price=>5000.0}, {:year=>1996, :make=>"Jeep", :model=>"Grand Cherokee", :description=>"MUST SELL!\nair, moon roof, loaded", :price=>4799.0}] 
```

因此，您可以将 CSV 文件的正文保存到一个名为`body`.

```
body = "09.09.2008,1,HC Vitkovice Steel,BK Mlada Boleslav,1:0 (PP)
09.09.2008,1,HC Lasselsberger Plzen,RI OKNA ZLIN,6:2
09.09.2008,1,HC Litvinov,HC Sparta Praha,3:5" 
```

然后运行他上面列出的代码就可以了。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2018-02-26T10:08:37.637

更短的解决方案

解析字符串：

```
CSV.parse(content, headers: :first_row).map(&:to_h) 
```

解析文件：

```
CSV.open(filename, headers: :first_row).map(&:to_h) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-11-18T15:48:56.510

[Nathan Long](https://stackoverflow.com/users/4376/nathan-long%20%22Nathan%20Long%22%20's%20answer)的回答略有不同

```
data_file = './sheet.csv'
data = []
CSV.foreach(data_file, headers: true) do |row|
  data << row.to_hash
end 
```

现在`data`是一组哈希值供您竞标！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-24T15:39:04.330

CSV 模块的`headers`选项接受要用作标题的字符串数组，当它们不作为 CSV 内容的第一行出现时。

```
CSV.parse(content, headers: %w(time number team_1 team_2 score)) 
```

这将使用给定的标头作为键生成可枚举的散列。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-25T22:45:46.303

您也可以尝试以下宝石

```
require 'csv_hasher'
arr_of_hashes = CSVHasher.hashify('/path/to/csv/file') 
```

返回的哈希的键将是 csv 文件的标头值。

如果您想传递自己的密钥，那么

```
keys = [:key1, :key2, ... ]
arr_of_hashers = CSVHasher.hashify('/path/to/csv/file', { keys: keys }) 
```

# php - magento customer.create，只允许一家商店？

> ID：14199785
> 
> 赞同：0
> 
> 时间：2013-01-07T16:17:10.857
> 
> 标签：php, api, magento, soap

我正在开发一个肥皂插件来将我的 CRM 连接到 Magento。当我研究 customer.create soap api 调用时，我发现我需要定义一个网站和一个商店 ID。 [http://www.magentocommerce.com/api/soap/customer/customer.create.html](http://www.magentocommerce.com/api/soap/customer/customer.create.html)

1.  用户是否仅限于该商店？
2.  还是可以将同一用户“重新使用”到另一家商店？

例如：

*   **用户仅限于一家商店**

用户：john doe 注册：Hellofa-footwear.com 获取用户 ID：403

同一用户使用相同的凭据（电子邮件地址等）在另一个站点上注册：Yoking-matters.com 获取用户 ID：404

*   **用户被重复使用**

用户：john doe 注册：Hellofa-footwear.com 获取用户 ID：403

同一用户使用相同的凭据（电子邮件地址等）在另一个站点上注册：Yoking-matters.com 用户 ID 403 已更新，该客户还购买了开玩笑的东西

因为我在 magento 文档中的任何地方都找不到这个......我想知道这里是否有人知道 magento 的内部工作原理。

问题：

1.  magento soap api正在使用哪种场景？
2.  如果场景 1\. 是否需要为每个单独的后续网站一遍又一遍地添加用户？
3.  如果场景 1\. 用户是否获得了多个 storeview 的权限/重用，或者是否还需要为其访问的每个 storeview 添加它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T17:17:00.120

如果您登录 Magento 管理面板并转到系统/配置/客户配置/帐户共享选项，您将在此处看到“共享客户帐户”选项。您可以选择两个选项：

1.  全球 - 意味着如果客户在此 Magento 安装的其中一个网站上创建了一个帐户，那么他将能够在不同的网站上使用相同的电子邮件/密码登录
2.  每个网站 - 意味着必须为每个网站单独创建客户

Magento 使用 SOAP 调用中的`store_id`参数来：

1.  选择正确的电子邮件翻译
2.  检查此商店是否配置为发送客户注册确认电子邮件
3.  要保存此值，以便您可以在网站某处的自定义逻辑中使用它

您可以省略此参数（或传递空字符串）。在这种情况下`store_id`，将自动填充网站默认商店的 ID。

# c# - Watin HTML 源代码未更新

> ID：14199787
> 
> 赞同：0
> 
> 时间：2013-01-07T16:17:13.600
> 
> 标签：c#, watin

我正在尝试使用 Watin 来自动化 soundclouds API，因为我需要将一系列用户 ID 转换为用户名。

我在 IE 中很好地显示了 json 结果，并且浏览器完全按计划循环。

我可以获得 html.tostring() 并将其写入文件，对于第一个用户来说 100% 没问题。但是，当循环继续时， html.tostring() 似乎没有更新，只是复制了第一个用户数据。（请记住，实际的浏览器正在遍历用户）

```
IE ie = new IE();

while (counter <= counterMax)
{

    ie.GoTo("http://api.soundcloud.com/users/" + counter + ".json?client_id=YOUR_CLIENT_ID");

    Console.WriteLine(ie.Html.ToString());               
    System.IO.StreamWriter file = new System.IO.StreamWriter("c:\\path\\" + counter + ".txt");          
    file.WriteLine(ie.Html.ToString());
    file.Close();

    counter++;

}

ie.Close(); 
```

我无法弄清楚，如果我在循环的每次迭代中使用代码关闭并重新打开浏览器，它就会按计划工作，但这对于我需要使用的数据量来说将花费太长时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:20:36.570

尝试这个：

```
System.IO.StreamWriter file = new System.IO.StreamWriter("c:\\path\\" + counter + ".txt", true); 
```

您需要启用追加，以便流可以在每次迭代循环时写入文件。

# html - 如何使用图像作为提交按钮？

> ID：14199788
> 
> 赞同：50
> 
> 时间：2013-01-07T16:17:16.333
> 
> 标签：html, form-submit, submit-button

有人可以帮助更改它以合并一个名为`BUTTON1.JPG`而不是标准`submit`按钮的图像吗？

```
<form id='formName' name='formName' onsubmit='redirect();return false;'>
    <div class="style7">
        <input type='text' id='userInput' name='userInput' value=''>
        <input type='submit' name='submit' value='Submit'>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-01-07T16:22:45.097

使用`image`类型输入：

```
<input type="image" src="/Button1.jpg" border="0" alt="Submit" /> 
```

* * *

完整的 HTML：

```
<form id='formName' name='formName' onsubmit='redirect();return false;'>
  <div class="style7">
    <input type='text' id='userInput' name='userInput' value=''>
    <input type="image" name="submit" src="https://jekyllcodex.org/uploads/grumpycat.jpg" border="0" alt="Submit" style="width: 50px;" />
  </div>
</form> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-10-06T14:39:49.090

为什么不：

```
<button type="submit">
  <img src="mybutton.jpg" />
</button> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-07T16:18:43.843

使用 CSS ：

```
input[type=submit] {

background:url("BUTTON1.jpg");

} 
```

对于 HTML：

```
<input type="submit" value="Login" style="background:url("BUTTON1.jpg");"> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-27T16:49:03.403

只需删除边框并在 css 中添加背景图像

例子：

```
$("#form").on('submit', function() {
   alert($("#submit-icon").val());
});
```

```
#submit-icon {
  background-image: url("https://pixabay.com/static/uploads/photo/2016/10/18/21/22/california-1751455__340.jpg"); /* Change url to wanted image */
  background-size: cover;
  border: none;
  width: 32px;
  height: 32px;
  cursor: pointer;
  color: transparent;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form id="form">
  <input type="submit" id="submit-icon" value="test">
</form>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-07T16:23:19.613

```
<form id='formName' name='formName' onsubmit='redirect();return false;'>
        <div class="style7">
    <input type='text' id='userInput' name='userInput' value=''>
    <img src="BUTTON1.JPG" onclick="document.forms['formName'].submit();">
</div>
</form> 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2014-10-10T03:59:16.690

HTML：

```
<button type="submit" name="submit" class="button">
  <img src="images/free.png" />
</button> 
```

CSS：

```
.button {  } 
```

# iphone - UIScrollView 中的延迟触摸释放

> ID：14199790
> 
> 赞同：0
> 
> 时间：2013-01-07T16:17:24.407
> 
> 标签：iphone, uiscrollview

我有`UIViewController`一个`UIScrollView`在里面。在模拟器中运行时，我拖动它`UIScrollView`并且它开始正确移动，但是当我释放拖动时，有一个小的延迟（大约半秒）然后视图继续移动以完成动量。

此延迟仅在视图中发生触摸释放时发生。因此，如果我在模拟器外拖动并释放，则没有延迟。

这是创建的代码`UIScrollView`：

```
scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
scrollView.pagingEnabled = YES;
scrollView.showsHorizontalScrollIndicator = NO;
//scrollView.delaysContentTouches = NO;
//scrollView.userInteractionEnabled = YES;
scrollView.delegate = self;
[self.view addSubview:scrollView];

// Add some sub views here
// ...

// 2 pages
scrollView.contentSize = CGSizeMake(self.view.frame.size.width*2, self.view.frame.size.height); 
```

*   我没有覆盖应用程序中的任何触摸事件。
*   我还没有实现任何 UIScrollViewDelegate 方法。
*   启用和禁用分页没有区别。
*   我没有在物理设备上运行它，只是在模拟器中。

有什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-19T15:22:06.557

回答我自己的问题以防其他人想知道。

这是在 MacBook 上使用触摸板的副作用。在进行三指拖动时，操作系统会在释放后添加延迟，以便您将手指抬起并快速放回以继续拖动。使用鼠标时不会发生这种情况。

代码或模拟器没有问题。

傻我:)

# c++ - 需要 C++ 中非常通用的 argmax 函数

> ID：14199798
> 
> 赞同：6
> 
> 时间：2013-01-07T16:17:43.307
> 
> 标签：c++, templates, generics, functional-programming

我是一个被宠坏的 Python 程序员，他习惯于计算a相对于一些的[argmax](https://en.wikipedia.org/wiki/Argmax)`collection``function`

```
max(collection, key=function) 
```

例如：

```
l = [1,43,10,17]
a = max(l, key=lambda x: -1 * abs(42 - x)) 
```

`a`然后包含 43，最接近 42 的数字。

是否可以编写一个 C++ 函数，它采用任何“可迭代”和任何函数并返回 argmax，如上？我想这将涉及模板参数、`auto`关键字和[基于范围的迭代](http://www.cprogramming.com/c++11/c++11-ranged-for-loop.html)，但我无法将它们拼凑在一起。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T16:27:18.630

这是一个两步过程。定义一个`key`应该*映射*到元素的函数，即在找到最大值的操作*之前应用。*将事物包装在 lambda 表达式中，*定义*用于查找最大值的比较。

```
auto key = [](int x){
    return -abs(42 - x);
};

std::max_element(l.begin(), l.end(), [key](int a, int b){
    return key(a) < key(b);
}); 
```

在这里，我们必须捕获`key`在第二个 lambda 函数之外定义的内容。（我们也可以在里面定义它）。你也可以把它放在一个单独的 lambda 函数中。当 42 应该从 lambda 外部参数化时，将其捕获为变量：

```
int x = 42;
std::max_element(l.begin(), l.end(), [x](int a, int b){
    return -abs(x - a) < -abs(x - b);
}); 
```

请注意，它`std::max_element`返回一个迭代器。要访问值/对它的引用，请在其前面加上`*`：

```
int x = 42;
auto nearest = std::min_element(l.begin(), l.end(), [x](int a, int b){
    return abs(x - a) < abs(x - b);
});
std::cout << "Nearest to " << x << ": " << *nearest << std::endl; 
```

您可以很好地将其包装在一个通用`find_nearest`函数中：

```
template<typename Iter>
Iter find_nearest(Iter begin, Iter end,
                  const typename std::iterator_traits<Iter>::value_type & value)
{
    typedef typename std::iterator_traits<Iter>::value_type T;
    return std::min_element(begin, end, [&value](const T& a, const T& b){
        return abs(value - a) < abs(value - b);
    });
}

auto a = find_nearest(l.begin(), l.end(), 42);
std::cout << *a << std::endl; 
```

**现场演示** `find_nearest`：http: [//ideone.com/g7dMYI](http://ideone.com/g7dMYI)

* * *

与您问题中的函数类似的高阶函数`argmax`可能如下所示：

```
template<typename Iter, typename Function>
Iter argmax(Iter begin, Iter end, Function f)
{
    typedef typename std::iterator_traits<Iter>::value_type T;
    return std::min_element(begin, end, [&f](const T& a, const T& b){
        return f(a) < f(b);
    });
} 
```

您可以使用以下代码调用它，完全符合您问题中的 lambda 函数：

```
auto a = argmax(l.begin(), l.end(), [](int x) { return -1 * abs(42 - x); });
std::cout << *a << std::endl; 
```

**现场演示** `argmax`：http: [//ideone.com/HxLMap](http://ideone.com/HxLMap)

* * *

现在唯一剩下的区别是这个`argmax`函数使用了一个*基于迭代器的*接口，它对应于 C++ 标准算法 ( [`<algorithm>`](http://www.cplusplus.com/reference/algorithm/)) 的设计。使您自己的编码风格适应您正在使用的工具总是一个好主意。

如果你想要一个直接返回值*的基于容器的*接口，[Nawaz 提供了一个很好的解决方案](https://stackoverflow.com/a/14200316/592323)，它需要 decltype-feature 来正确指定返回类型。我决定以这种方式保留我的版本，以便人们可以看到两种替代界面设计。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T16:48:27.817

由于@leemes 解决方案太多。一切都是正确的，除了在您的示例中没有尝试*模仿*Python 版本，这是我模仿的尝试：

方便的通用 argmax 函数，就像 Python 版本一样：

```
template<typename Container, typename Fn>
auto max(Container const & c, Fn && key) -> decltype(*std::begin(c))
{  
    if ( std::begin(c) == std::end(c) ) 
       throw std::invalid_argument("empty container is not allowed.");

    typedef decltype(*std::begin(c)) V;
    auto cmp = [&](V a, V b){ return key(a) < key(b); };
    return *std::max_element(std::begin(c), std::end(c), cmp);
} 
```

并将其用作：

```
std::vector<int> l = {1,43,10,17};
auto a = max(l, [](int x) { return -1 * std::abs(42-x); };

int l[] = {1,43,10,17}; //works with array also!
auto a = max(l, [](int x) { return -1 * std::abs(42-x); }; 
```

**注意：**与其他解决方案不同，这`max()`将返回元素本身，而不是元素的迭代器！

另请注意，此解决方案也适用于用户定义的容器：

```
namespace test
{
     template<size_t N>
     struct intcollection
     {
         int _data[N];
         int const * begin() const { return _data; }
         int const * end() const { return _data + N; }
     };
}

test::intcollection<4> c{{1,43,10,17}};
auto r = max(c, [](int x) { return -1 * std::abs(42-x); }); 
```

[查看现场演示](http://stacked-crooked.com/view?id=8c5b827574be4247f3eb28e944462812)。

# .net - CUDA 5 和 CUDA 4.2 并行

> ID：14199803
> 
> 赞同：0
> 
> 时间：2013-01-07T16:18:00.117
> 
> 标签：.net, cuda, gpgpu

这似乎是一个愚蠢的问题，但我想知道我是否可以同时安装版本 CUDA 5 和 CUDA 4.2？

我即将安装 CUDA 5，但我仍然想使用我一直使用 CUDA 4.2 和 Visual Studio 2010 的旧项目。我需要考虑什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T19:53:03.257

我同时安装了 CUDA 4.1 和 CUDA 5.0，我同时使用 Visual Studio 2010，我认为在 CUDA 4.2 的情况下也应该没有问题。转到 Project -> Build Customization 并选择适当版本的 CUDA 来重建您的项目。

# java - EasyMock - 模拟从接口继承的抽象方法

> ID：14199804
> 
> 赞同：1
> 
> 时间：2013-01-07T16:18:00.920
> 
> 标签：java, unit-testing, easymock

我在使用 EasyMock (3.1) 类模拟时遇到了一些困难。这应该适用于模拟部分类实现，我认为这应该是理想的单元测试抽象基类，同时模拟缺失的方法。这是模式 - 一个立即可识别的经典......

```
public interface Interface {
    public void intfMethod();
}

public abstract class AbstractBase implements Interface {
    public void otherMethod() {
        // do some stuff we need to test...
        intfMethod();
    }
} 
```

现在测试：

```
public class TestAbstractBase {
    AbstractBase testInstance;

    @Before
    public void setUp() {
        testInstance =
            createMockBuilder(AbstractBase.class).addMockedMethod("intfMethod").createMock();
    }
    @Test
    public void testOtherMethod() {
        testInstance.intfMethod();  // expect this to be invoked on the mock...
        replay(testInstance);
        testInstance.otherMethod();
        verify(testInstance);
    }
} 
```

EasyMock 似乎不喜欢这个。它抛出：

```
java.lang.IllegalArgumentException: Method not found (or private): intfMethod
    at org.easymock.internal.MockBuilder.addMockedMethod(MockBuilder.java:78)
    at TestAbstractBase.setUp(TestAbstractBase.java:19) 
```

有任何想法吗？我发现了一个[相关的问题](https://stackoverflow.com/questions/6412988/how-do-i-mock-a-method-inherited-from-an-abstract-class-with-easymock)，但它并没有真正做到它的标题......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T18:44:19.443

非常感谢@nhaldimann；我[在 doc 中忽略了这个无害的声明](http://www.easymock.org/EasyMock2_5_2_ClassExtension_Documentation.html#Partial_mocking)，即“默认情况下可以方便地模拟抽象方法”。因此，上述所有需要是删除显式模拟接口方法的尝试，如：

```
testInstance = createMockBuilder(AbstractBase.class).createMock(); 
```

在研究这一点时，我遇到了另外两种解决方法——尽管上述方法显然更可取：

1.  使用更强大的`addMockedMethod(Method)`API，如下所示：

    ```
    public void setUp() throws Exception {
        Method m = AbstractBase.class.getMethod("intfMethod");
        testInstance = createMockBuilder(AbstractBase.class).addMockedMethod(m).createMock();
    } 
    ```

2.  显式暴露`intfMethod`方法`AbstractBase`

这两个解决方法表明我最初的问题是 EasyMock 方面的一个错误。但是由于不需要在第一个实例中模拟该方法，我们会说这是“用户（我的）错误”。

# javascript - 打开新窗口时可以删除父窗口吗？

> ID：14199816
> 
> 赞同：0
> 
> 时间：2013-01-07T16:18:30.203
> 
> 标签：javascript, internet-explorer, infragistics

当鼠标悬停在我们的主应用程序的窗口上时，我遇到了一个问题。

我正在使用以下行在 javascript 函数中打开新窗口：

```
window.open(URL, 'Requests', 'location=no,toolbar=no,status=yes,scrollbars=yes,resizable=yes'); 
```

我注意到，如果我通过资源管理器打开一个新的 IE 窗口，将鼠标悬停在我们的主应用程序窗口上不会重新激活自身。即使在这种情况下，主窗口也确实使自己位于由上面的 window.open 命令创建的弹出窗口的“顶部”。

问题是这样的：**在javascript中打开“子”窗口时，有什么方法可以将子窗口与父窗口分离？**

更多信息：我使用 Infragistics WebDataMenu 并将 ActivateOnHover 设置为 true，因此用户无需单击主菜单项即可查看子菜单选项。不幸的是，该设置会使整个菜单栏变得敏感，因此在其中滑动鼠标会激活菜单（遗憾的是，当弹出窗口处于活动状态时会激活窗口）。这是我要修复的根本行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T01:31:04.237

该方法将创建一个弹出窗口，该窗口实际上仅通过调用的返回值和弹出窗口上的属性`window.open();`通过 JavaScript 共享关系。`window.opener`

您想要的是在您处理“子”弹出窗口时锁定与“父”页面交互的模式窗口的行为。

您可以尝试通过强制关注弹出窗口并阻止任何模糊来与 JavaScript（和您的用户）对抗，但这会在用户想要阅读电子邮件等时让他们发疯（例如，不推荐）

您也可以使用不那么标准的 showModalDialog(); 方法，但支持远未完全跨浏览器，如果您尝试使用它会出现一大堆新问题（在 IE 中没有右键单击，在 IE 中出现缩放问题，并且没有孙子弹出窗口等等）（再次不推荐）

您可以做的是制作一个类似于许多在线照片查看器的“覆盖”弹出窗口，您首先覆盖一个遮罩（通常是半透明的），该遮罩阻止鼠标/焦点在下面的整个页面内容上，然后用您的“弹出内容”覆盖它。只要确保您提供了一个关闭选项，该选项可以在覆盖关闭/完成时移除遮罩。

请注意，如果您需要支持 IE6，您还需要一个 iframe shim（如果需要，请使用 Google）

许多 UI 框架都会为您提供一个像这样的“对话框”。（例如 jQueryUI）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T16:05:49.643

最终，我放弃了这项工作。我发现我必须做的是从 WebDataMenu 中关闭 ActivateOnHover，它没有回答这个问题，并且需要用户单击菜单以使其下拉，但它成为了一种解决方法。

# angularjs - Angularjs从模型中自动选择下拉菜单

> ID：14199817
> 
> 赞同：0
> 
> 时间：2013-01-07T16:18:36.633
> 
> 标签：angularjs

我正在尝试显示从数据存储加载的一些数据，但它没有反映 UI 上的更改。我创建了一个示例来展示我想要实现的目标的一般概念。

[http://plnkr.co/edit/MBHo88](http://plnkr.co/edit/MBHo88)

这是 angularjs 示例的链接，它们在单击时显示，然后下拉菜单被清除。如果将表达式替换为列表下拉列表中的一种颜色，则选择正确。这种类型的选择是否仅适用于用户事件？

[http://docs.angularjs.org/api/ng.directive:select](http://docs.angularjs.org/api/ng.directive:select)

帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:44:45.927

实际上问题在于 ngSelect 使用简单的比较运算符 ('==') 比较对象，因此具有相同字段和值的两个对象被视为不同的对象。

因此，您最好使用字符串和数字作为值（ngSelect 指令表达式中的“选择”参数）。

这是[您的 plunker 的一种解决方案](http://plnkr.co/edit/Ghu06l?p=preview)。

另外在 GitHub 上有一些关于这个主题的讨论： [https](https://github.com/angular/angular.js/issues/1302) ://github.com/angular/angular.js/issues/1302 https://github.com/angular/angular.js/issues/1032

此外，正如我所指出的，还有一些关于为 ngSelect 添加自定义比较器/散列以便能够更轻松地在对象上使用 ngSelect 的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:53:39.843

控制器初始化中的一个错误。您必须引用 中的对象`palette`，因为这些对象是在视图中观看的：

```
$scope.selectedColors.push({col: $scope.palette[2]});
$scope.selectedColors.push({col: $scope.palette[1]}); 
```

与您的相同`result`：

```
$scope.result = { color: $scope.obj.codes[2] }; 
```

那你需要看`result`. 在下面的示例中，选择 1 接收来自初始选择的值，第二个接收调色板中的以下值。我不知道这是否是您想要的，但您可以轻松更改它：

```
$scope.$watch('result', function(value) {
   if(value) {
      var index = value.color.code -1;
      $scope.selectedColors[0] = {col: $scope.palette[index] };
      $scope.selectedColors[1] = {col: $scope.palette[Math.max(index-1, 0)] };
   }
}, true); 
```

请参阅[plunkr](http://plnkr.co/lIAQys)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T15:46:20.193

好的，我想我想通了，但感谢@ValentynShybanov 和@asgoth。

根据 angularjs 示例，ngModel 使用下拉列表中使用的数组中的对象之一进行初始化。所以有一个数组：

```
$scope.locations = [{ state: 'FL', city: 'Tampa'}, {state: 'FL', city: 'Sarasota'} ....]; 
```

下拉列表定义为：

```
<select ng-options="l.state group by l.city for l in locations" ng-model="city" required></select> 
```

然后 $scope.city 被初始化为：

```
$scope.city = $scope.locations[0]; 
```

到目前为止一切顺利，对吧？！！！.. 但我有多个位置，因此有多个下拉菜单。用户也可以添加/删除更多。就像动态创建表一样。而且，我需要从数据存储中加载数据。

虽然我正在构建并分配一个类似的值（例如：来自数据存储的值 --> State = FL，City = Tampa；因此 --> { state : 'FL', city : 'Tampa' }），但 angularjs 不是能够匹配的值。我尝试了不同的方法，比如只分配 { city : 'Tampa' } or 'Tampa' or and or and or ...

所以我所做的......我知道这有点讨厌，但到目前为止工作......是编写一个查找函数来从 $scope.locations 返回值。因此我有：

```
$scope.lookupLocation = function(state, city){
   for(var k = 0; k < $scope.locations.length; k++){
      if($scope.locations[k].state == state && $scope.locations[k].city == city)
         return $scope.locations[k];
   }
   return $scope.locations[0]; //-- default value if none matched
} 
```

因此，当我从数据存储区加载数据（json 格式的数据）时，我会调用 lookupLocation 函数，例如：

```
$scope.city = $scope.lookupLocation(results[indexFromSomeLoop].location.state, results[indexFromSomeLoop].location.city); 
```

这会在加载数据时预先选择我的值。这对我有用。

谢谢

# spring-security - 修改 Pentaho 的 UserDetailsS ervice

> ID：14199821
> 
> 赞同：0
> 
> 时间：2013-01-07T16:18:42.917
> 
> 标签：spring-security

我需要在 loadUserByUsername 方法中接收两个字符串参数。我不想使用弹簧安全身份验证，因为我自己的实现也需要密码（它是一个集成系统）。

是否可以在同一个类中创建另一个具有相同名称 loadUserByUsername(String username, String password) 的方法，然后调用该方法而不是另一个方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T18:45:20.520

我不明白这个要求，但`UserDetailsService.loadUserByUsername(String)`很好。在调用此方法时，用户已经通过身份验证，因此不再需要密码。因此，如果您此时需要密码，则很有可能您做错了什么。

如果您想实现自己的基于用户名和密码的身份验证机制，您需要提供自己的`AuthenticationProvider`.

```
<security:authentication-manager alias="authenticationManager">
  <security:authentication-provider ref="yourProvider" />
</security:authentication-manager>

<bean id="yourProvider" class="package.yourProviderClass">
  <!-- I suppose you need this, too -->
  <property name="userDetailsService" ref="yourUserDetailsService" />
</bean> 
```

查看现有实现并找到最能满足您需求的实现。

![在此处输入图像描述](../Images/f1ac4aee1b7661b71c6e579b1e69ca39.png)

# objective-c - Xcode - AVAudioPlayer 将输出重定向到输入 AVAudioRecorder

> ID：14199824
> 
> 赞同：1
> 
> 时间：2013-01-07T16:18:47.867
> 
> 标签：objective-c, xcode, avaudioplayer, avaudiorecorder, avassetexportsession

我有一个应用程序，允许用户在演奏和弦模式轨道上录制吉他独奏。问题是，和弦模式轨道是一个 12 秒的音频文件，设置为在 AVPlayer 中循环。除此之外，用户最多可以录制 2 分钟。但这意味着当我使用 AVAssetExportSession 将 AVAsset 中的 2 个音轨组合成一个 .caf 文件时，我将只有 12 秒的音频文件和一个“n”分钟的吉他独奏文件。

记住用户可以选择使用耳机或扬声器，我是否可以通过将其 AVPlayer 输出重定向到麦克风来捕获播放和弦模式音轨（如果播放和弦模式通过耳机，麦克风将不会t捡起来）？

我可以强制用户在录音期间使用扬声器，然后麦克风会拾取扬声器的输出（包含和弦模式文件），但这不允许我控制每个轨道的混音电平。

任何关于我应该如何进行的意见或建议将不胜感激。提前谢谢大家！

# mysql - 获取 MySQL 中多对多关系的最后一项

> ID：14199826
> 
> 赞同：4
> 
> 时间：2013-01-07T16:18:56.497
> 
> 标签：mysql, select, join, limit

我有 3 个表`categories`：`items`和`items_categories`。这是一个多对多的关系。该表的结构如下：

```
CREATE TABLE `categories` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `slug` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00'
)

CREATE TABLE `items_categories` (
  `item_id` int(10) unsigned NOT NULL,
  `category_id` int(10) unsigned NOT NULL
) 

CREATE TABLE `items` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `slug` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `thumb` varchar(255) COLLATE utf8_unicode_ci NOT NULL
) 
```

我有索引，但我删除了，因为这个例子不需要。

我需要一个查询，它返回所有类别，并与每个类别的**最后一项**连接，并且不重复。由于项目可以有许多类别，假设项目#300（最新）在最终结果中具有类别#1 和#2，类别#1 和#2 将与不同的项目连接。

现在我有这个查询，但它并没有做我真正想要的：

```
SELECT category_id, c.name, c.slug, item_id, i.name, i.thumb
FROM   items_categories AS ic
INNER JOIN categories AS c ON c.id = ic.category_id
INNER JOIN (SELECT * FROM   items ORDER  BY id DESC) AS i ON i.id = ic.item_id
GROUP  BY c.id
ORDER  BY c.id ASC 
```

它返回我重复的结果，它返回第一项而不是最后一项。

虚拟数据： http: [//pastebin.com/D75tr4Ry](http://pastebin.com/D75tr4Ry)

我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T18:21:46.553

您只是忘记在子查询中添加**限制**。使用限制后，您可以获得最后一项的所有类别。

尝试这个 ：

```
SELECT category_id, c.name, c.slug, item_id, i.name, i.thumb 
FROM items_categories AS ic 
INNER JOIN categories AS c ON ic.category_id = c.id 
INNER JOIN (SELECT * FROM items ORDER BY id DESC LIMIT 1) AS i ON ic.item_id = i.id
GROUP BY c.id 
ORDER BY c.id ASC 
```

# xaml - ListBox 不显示完整的项目

> ID：14199828
> 
> 赞同：0
> 
> 时间：2013-01-07T16:19:04.033
> 
> 标签：xaml, listview, listbox

我在列表框中有扩展器。如果我现在将 ListView 放入最后一个 Expander，则 ListView 的大小正好可以显示所有项目。到目前为止，这就是我想要的。但现在不可能将 ListBox 向下滚动到 ListView 的末尾。

为了允许用户将 ListBox 向下滚动到最后一项的末尾，即 ListView 的末尾，我需要做什么？

这是我的简化代码：

```
<Window x:Class="ExpanderTest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <ListBox HorizontalContentAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled">

        <Expander Header="text">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                <Label Grid.Column="0">some text</Label>
                <Label Grid.Column="1">some text</Label>
            </Grid>
        </Expander>

        <Expander Header="Buttons">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Button Grid.Row="0">Button1</Button>
                <StackPanel Grid.Row="1" Orientation="Horizontal">
                    <Button>Button2</Button>
                    <Button>Button3</Button>
                    <Button>Button4</Button>
                    <Button>Button5</Button>
                </StackPanel>
            </Grid>
        </Expander>

        <Expander Header="Much Information" IsExpanded="True">
            <ListView>
                <ListView.View>
                    <GridView>
                        <GridView.Columns>
                            <GridViewColumn Header="Variable" Width="160" />
                        </GridView.Columns>
                    </GridView>
                </ListView.View>
                <ListViewItem>Line 0</ListViewItem>
                <ListViewItem>Line 1</ListViewItem>
                <ListViewItem>Line 2</ListViewItem>
                <ListViewItem>Line 3</ListViewItem>
                <ListViewItem>Line 4</ListViewItem>
                <ListViewItem>Line 5</ListViewItem>
                <ListViewItem>Line 6</ListViewItem>
                <ListViewItem>Line 7</ListViewItem>
                <ListViewItem>Line 8</ListViewItem>
                <ListViewItem>Line 9</ListViewItem>
                <ListViewItem>Line 10</ListViewItem>
                <ListViewItem>Line 11</ListViewItem>
                <ListViewItem>Line 12</ListViewItem>
                <ListViewItem>Line 13</ListViewItem>
                <ListViewItem>Line 14</ListViewItem>
                <ListViewItem>Line 15</ListViewItem>
                <ListViewItem>Line 16</ListViewItem>
                <ListViewItem>Line 17</ListViewItem>
                <ListViewItem>Line 18</ListViewItem>
                <ListViewItem>Line 19</ListViewItem>
                <ListViewItem>Line 20</ListViewItem>
                <ListViewItem>Line 21</ListViewItem>
                <ListViewItem>Line 22</ListViewItem>
                <ListViewItem>Line 23</ListViewItem>
                <ListViewItem>Line 24</ListViewItem>
                <ListViewItem>Line 25</ListViewItem>
                <ListViewItem>Line 26</ListViewItem>
                <ListViewItem>Line 27</ListViewItem>
                <ListViewItem>Line 28</ListViewItem>
                <ListViewItem>Line 29</ListViewItem>
                <ListViewItem>Line 30</ListViewItem>
                <ListViewItem>Line 31</ListViewItem>
                <ListViewItem>Line 32</ListViewItem>
                <ListViewItem>Line 33</ListViewItem>
                <ListViewItem>Line 34</ListViewItem>
                <ListViewItem>Line 35</ListViewItem>
                <ListViewItem>Line 36</ListViewItem>
                <ListViewItem>Line 37</ListViewItem>
                <ListViewItem>Line 38</ListViewItem>
                <ListViewItem>Line 39</ListViewItem>
            </ListView>
        </Expander>
    </ListBox>
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T20:10:21.633

一种解决方案是将扩展器放入 ScrollViewer 内的 StackPanel 中，而不是使用 ListBox。

如果您需要保留外部 ListBox，您可以禁用其上的 ScrollViewer，并将该 ListBox 包装在 ScrollViewer 中。

```
<Grid>
    <ScrollViewer>
        <StackPanel>

            <Expander Header="text">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="100"/>
                    </Grid.ColumnDefinitions>
                    <Label Grid.Column="0">some text</Label>
                    <Label Grid.Column="1">some text</Label>
                </Grid>
            </Expander>

            <Expander Header="Buttons">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Button Grid.Row="0">Button1</Button>
                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <Button>Button2</Button>
                        <Button>Button3</Button>
                        <Button>Button4</Button>
                        <Button>Button5</Button>
                    </StackPanel>
                </Grid>
            </Expander>

            <Expander Header="Much Information" IsExpanded="True">
                <ListView>
                    <ListView.View>
                        <GridView>
                            <GridView.Columns>
                                <GridViewColumn Header="Variable" Width="160" />
                            </GridView.Columns>
                        </GridView>
                    </ListView.View>
                    <ListViewItem>Line 0</ListViewItem>
                    <ListViewItem>Line 1</ListViewItem>
                    <ListViewItem>Line 2</ListViewItem>
                    <ListViewItem>Line 3</ListViewItem>
                    <ListViewItem>Line 4</ListViewItem>
                    <ListViewItem>Line 5</ListViewItem>
                    <ListViewItem>Line 6</ListViewItem>
                    <ListViewItem>Line 7</ListViewItem>
                    <ListViewItem>Line 8</ListViewItem>
                    <ListViewItem>Line 9</ListViewItem>
                    <ListViewItem>Line 10</ListViewItem>
                    <ListViewItem>Line 11</ListViewItem>
                    <ListViewItem>Line 12</ListViewItem>
                    <ListViewItem>Line 13</ListViewItem>
                    <ListViewItem>Line 14</ListViewItem>
                    <ListViewItem>Line 15</ListViewItem>
                    <ListViewItem>Line 16</ListViewItem>
                    <ListViewItem>Line 17</ListViewItem>
                    <ListViewItem>Line 18</ListViewItem>
                    <ListViewItem>Line 19</ListViewItem>
                    <ListViewItem>Line 20</ListViewItem>
                    <ListViewItem>Line 21</ListViewItem>
                    <ListViewItem>Line 22</ListViewItem>
                    <ListViewItem>Line 23</ListViewItem>
                    <ListViewItem>Line 24</ListViewItem>
                    <ListViewItem>Line 25</ListViewItem>
                    <ListViewItem>Line 26</ListViewItem>
                    <ListViewItem>Line 27</ListViewItem>
                    <ListViewItem>Line 28</ListViewItem>
                    <ListViewItem>Line 29</ListViewItem>
                    <ListViewItem>Line 30</ListViewItem>
                    <ListViewItem>Line 31</ListViewItem>
                    <ListViewItem>Line 32</ListViewItem>
                    <ListViewItem>Line 33</ListViewItem>
                    <ListViewItem>Line 34</ListViewItem>
                    <ListViewItem>Line 35</ListViewItem>
                    <ListViewItem>Line 36</ListViewItem>
                    <ListViewItem>Line 37</ListViewItem>
                    <ListViewItem>Line 38</ListViewItem>
                    <ListViewItem>Line 39</ListViewItem>
                </ListView>
            </Expander>
        </StackPanel>
    </ScrollViewer>
</Grid> 
```

# gwt - GWT 视图导航基本示例

> ID：14199832
> 
> 赞同：0
> 
> 时间：2013-01-07T16:19:15.233
> 
> 标签：gwt, user-interface

我有一个带有`Back`/`Forward`按钮的导航面板（功能不重要，只是想了解一下在 GWT 页面内外交换面板）

**导航按钮面板**

```
public class NavigationButtonsPanel extends HTMLPanel
        {
            private Button btnA = new Button("Go back");
            private Button btnB = new Button("Go forward");

            public NavigationButtonsPanel( )
            {
                super("Navigation Panel");
                add(btnA);
                add(btnB);
            }

            public void setBackHandler( ClickHandler handler )
            {
                btnA.addClickHandler(handler);
            }

            public void setForwardHandler( ClickHandler handler )
            {
                btnB.addClickHandler(handler);
            }
        } 
```

然后我有 3 个基本面板，AB 和 C 使用它。我从 ABC 到 BA 的导航工作正常。我现在模拟用户在转到面板 B 之前更改某些内容。在这种情况下，面板 B 中的标签。我的最终应用程序显然会比这更复杂，但这是否是应用程序工作方式的典型特征。您通过用户在同一面板或不同面板中的交互来修改面板中的某些字段，加载新面板，更多交互，在不同面板中加载等？我只希望用户使用定义非常明确的导航路径，因此某个面板只有一条路径。

**面板A**

```
public class PanelA extends HTMLPanel
{
    private static PanelA panel;            
    private PanelA()
    {
        super("Panel A");
        final RootPanel rootPanel = RootPanel.get();

        NavigationButtonsPanel btnPanel = new NavigationButtonsPanel();
        btnPanel.setForwardHandler(new ClickHandler() {
            public void onClick(ClickEvent event) 
            {
                rootPanel.clear();
                PanelB.setMessageFromPreviousPage("Message set in Panel AAAAA");
                rootPanel.add( PanelB.getInstance() );
            }
        });

        add( btnPanel );
    }

    public static PanelA getInstance()
    {
        if (panel == null)
        {
            panel = new PanelA();
        }
        return panel;
    }
} 
```

**面板B**

```
 public class PanelB extends HTMLPanel
{
    private static PanelB panel; 
    private static String messageFromPreviousPage;

    private PanelB()
    {
        super("Panel B");
        final RootPanel rootPanel = RootPanel.get();

        Label messageLabel = new Label(messageFromPreviousPage);

        NavigationButtonsPanel btnPanel = new NavigationButtonsPanel();
        btnPanel.setBackHandler(new ClickHandler() {
            public void onClick(ClickEvent event) 
            {
                rootPanel.clear();
                rootPanel.add( PanelA.getInstance() );
            }
        });

        btnPanel.setForwardHandler(new ClickHandler() {
            public void onClick(ClickEvent event) 
            {
                rootPanel.clear();
                rootPanel.add( PanelC.getInstance() );
            }
        });

        add( btnPanel );
        add(messageLabel);
    }

    public static PanelB getInstance()
    {
        if (panel == null)
        {
            panel = new PanelB();
        }
        return panel;
    }

    public static void setMessageFromPreviousPage(
            String message)
    {
        messageFromPreviousPage = message;

}
    } 
```

**面板C**

```
public class PanelC extends HTMLPanel
        {
            private static PanelC panel;            
            private PanelC()
            {
                super("Panel C");
                final RootPanel rootPanel = RootPanel.get();

                NavigationButtonsPanel btnPanel = new NavigationButtonsPanel();
                btnPanel.setBackHandler(new ClickHandler() {
                    public void onClick(ClickEvent event) 
                    {
                        rootPanel.clear();
                        PanelB.setMessageFromPreviousPage("Message set in Panel CCCCCC");
                        rootPanel.add( PanelB.getInstance() );
                    }
                });

                add( btnPanel );
            }

            public static PanelC getInstance()
            {
                if (panel == null)
                {
                    panel = new PanelC();
                }
                return panel;
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:04:49.027

```
Any idea why Panel B does not update its UI? 
```

因为当第一次`PanelB`使用创建实例时`PanelB.getInstance()`，然后 `messageLabel`创建并且它也设置了值。当您在更改消息后从 PanelC 调用第二次相同的方法时，当时，它使用相同的实例`PanelB`而不是新对象。并且根据您的编码，您正在更改`messageFromPreviousPage`变量的值而不是标签文本。所以你在 UI 上没有发现任何变化。

如果要更改标签文本，则将其声明`messageLabel`为全局变量 static 并更改标签。IE

```
 private static Label messageLabel;
 private PanelB() 
{
//your code
}
 public static PanelB getInstance()
{
    if (panel == null)
    {
        panel = new PanelB();
    }
    else
    {
        messageLabel.setText(messageFromPreviousPage); //Require to set Text Again
    }
    return panel;
} 
```

# coldfusion - CF9 cfscript，在参数中传递动态数组

> ID：14199836
> 
> 赞同：3
> 
> 时间：2013-01-07T16:19:30.317
> 
> 标签：coldfusion, coldfusion-9, fw1

今年我带着一个大问题开始。当我做

```
myName = "Henry";
myCustomFunction( [ myName, "Thierry" ] ); 
```

它会引发类似的错误`myName is undefined`。为什么？

我可以通过这样做来解决这个问题

```
myName = "Henry";
aMyArrayArgument = [ myName, "Thierry" ];
myCustomFunction( aMyArrayArgument ); 
```

但是，我仍然想知道为什么 Coldfusion 不允许传入`[ myName, "Thierry" ]`参数？

如果有帮助，我会使用框架一 (FW/1)。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:40:53.680

如果我这样做：

```
 <cffunction name="xx" returntype="void">
     <cfargument name="x" type="array">
     <cfdump var="#arguments.x#">
 </cffunction>

 <cfset myname = "dan">
 <cfset xx([myname, 'bracuk']) > 
```

代码运行没有错误，我看到了转储。您的代码肯定还有其他问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T17:19:37.437

如果您的实际代码看起来更像这样：

```
if (something)
{
    myName = "Henry";
    myCustomFunction( argname=[ myName, "Thierry" ] );
} 
```

然后是因为 CF 中的字面结构和数组表示法写得非常糟糕和错误。

如果您可以确认它中断的情况，请[向 Adob​​e 提出问题](https://bugbase.adobe.com)（已经有几个与此相关的问题；您可能会或不想检查重复项）。

# c# - 从 ASP.NET Web API 层使用的方法中抛出或不抛出异常

> ID：14199837
> 
> 赞同：6
> 
> 时间：2013-01-07T16:19:31.127
> 
> 标签：c#, asp.net, .net, exception-handling, asp.net-web-api

假设我正在构建一个 ASP.NET Web API 应用程序，它具有以下结构：

![在此处输入图像描述](../Images/fec6e27c3cbd640e84fb28d2d0e54bc5.png)

从图中可以看出，ASP.NET Web API 核心将与域服务层（例如，`MembershipService`具有、 等方法的类）对话，而我的服务类将与一个或多个存储库对话以处理操作。`GetUsers``CreateUser`

很明显，服务操作（例如`MembershipService.CreateUser`方法）会由于多种原因（未满足的条件、存储库抛出的异常等）而失败，这就是我有疑问的地方。

您是否认为服务类应该处理异常并返回某种结果对象，例如以下对象：

```
public class OperationResult {

    public OperationResult(bool isSuccess) : this(isSuccess) {
        IsSuccess = isSuccess;
    }

    public OperationResult(bool isSuccess, Exception exception) : this(isSuccess) {
        Exception = exception;
    }

    public bool IsSuccess { get; private set; }
    public Exception IsSuccess { get; private set; }
}

public class OperationResult<TEntity> : OperationResult {

    public OperationResult(bool isSuccess) 
        : base(isSuccess) { }

    public OperationResult(bool isSuccess, Exception exception) 
        : base(isSuccess, exception) { }

    public TEntity Entity { get; set; }
} 
```

还是您认为服务方法不应该像那样抽象异常，而应该直接或间接抛出异常（创建一个新的有意义的异常类型特定于操作并将抛出的异常作为其内部异常）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T19:51:47.407

当您处于进程中时，请使用异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T17:55:06.007

我认为避免异常没有任何意义。例外是有充分理由的，主要是为了使用！试着看大局：你正试图用老式的错误检查方式来改变异常机制。这样一来，您将失去异常的所有优点（例如将错误处理和常规代码、CallStack 等分离），而一无所获。

在这种情况下，我通常会在服务层捕获异常并将其重新包装为自定义异常（在 InnerException 字段中引用原始异常）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:37:14.980

从 Microsoft 的书中获取一页，Membership API 的实现抛出异常而不是处理它们并返回结果对象，所以只要您不控制客户端和 API，我认为这是最佳实践。

在您同时控制客户端和 API 的情况下，我个人偏好返回结果对象或错误消息。这样做的原因是我想记录捕获有关实际异常来源的详细信息，但我不希望所有可能出错的东西都出现异常，例如密码不正确。

在这种情况下，向用户发送一个简单的错误消息就绰绰有余了。根据实际经验，每次发生验证错误时将异常记录到事件日志或日志文件是操作人员的主要负担，他们试图确定是否发生实际故障或是否只是用户的错字.

# c# - 列表中的任何值 - 在 LINQ 中

> ID：14199839
> 
> 赞同：0
> 
> 时间：2013-01-07T16:19:32.450
> 
> 标签：c#, linq

我需要提取请求类型是我在列表中的任何值的所有值。

```
from v in ctx.vEmailSents
where  v.RequestType_ID == reqTypeID
group v by v.SentToLab_ID into g
select g.OrderByDescending(x => x.DateSent).FirstOrDefault() into lastV
  select new
  {
    ClaimID = lastV.Claim_ID,
  }; 
```

`reqTypeID`是类型`List<int>`。

如何在 Linq 中使用它来获取该列表中的所有记录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:20:59.797

你可以这样做：

```
where requestTypes.Contains(v.RequestType_ID) 
```

`requestTypes`将是您谈到的清单。

# google-maps-api-3 - 在 Google 地图上为中途停留/航点添加持续时间

> ID：14199849
> 
> 赞同：4
> 
> 时间：2013-01-07T16:20:17.547
> 
> 标签：google-maps-api-3

是否有可能或是否有任何计划允许中途停留的航点添加一个持续时间，然后再添加到整个旅行持续时间？

例如：

1.  从 A 开始
2.  经B作为中途停留，等待60分钟
3.  结束于 C

A 到 B 或 B 到 C 应报告为比原始行程时间长 60 分钟。

# c# - 从 ac# winforms 应用程序将输出写入控制台

> ID：14199850
> 
> 赞同：7
> 
> 时间：2013-01-07T16:20:26.257
> 
> 标签：c#, windows, winforms, console

> **可能重复：**
> [如何在表单应用程序中显示控制台输出/窗口？](https://stackoverflow.com/questions/4362111/how-do-i-show-console-output-window-in-a-forms-application)

ac# winforms 程序有没有办法写入控制台窗口？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-07T16:20:26.257

这里基本上会发生两件事。

1.  控制台输出

winforms 程序可以将自身附加到创建它的控制台窗口（或附加到不同的控制台窗口，或者如果需要，甚至附加到新的控制台窗口）。一旦附加到控制台窗口 Console.WriteLine() 等按预期工作。这种方法的一个问题是程序立即将控制权返回给控制台窗口，然后继续对其进行写入，因此用户也可以在控制台窗口中键入。我认为您可以使用 start 和 /wait 参数来处理这个问题。

[链接开始命令语法](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/start.mspx)

2.  重定向控制台输出

这是当有人通过管道将您的程序的输出输出到其他地方时，例如。

你的应用程序 > 文件.txt

在这种情况下，附加到控制台窗口会有效地忽略管道。要完成这项工作，您可以调用 Console.OpenStandardOutput() 来获取输出应通过管道传输到的流的句柄。这仅在输出是管道的情况下才有效，因此如果您想处理这两种情况，您需要打开标准输出并将其写入并附加到控制台窗口。这确实意味着输出被发送到控制台窗口**和**管道，但它是我能找到的最佳解决方案。在我用来执行此操作的代码下方。

```
// This always writes to the parent console window and also to a redirected stdout if there is one.
// It would be better to do the relevant thing (eg write to the redirected file if there is one, otherwise
// write to the console) but it doesn't seem possible.
public class GUIConsoleWriter : IConsoleWriter
{
    [System.Runtime.InteropServices.DllImport("kernel32.dll")]
    private static extern bool AttachConsole(int dwProcessId);

    private const int ATTACH_PARENT_PROCESS = -1;

    StreamWriter _stdOutWriter;

    // this must be called early in the program
    public GUIConsoleWriter()
    {
        // this needs to happen before attachconsole.
        // If the output is not redirected we still get a valid stream but it doesn't appear to write anywhere
        // I guess it probably does write somewhere, but nowhere I can find out about
        var stdout = Console.OpenStandardOutput();
        _stdOutWriter = new StreamWriter(stdout);
        _stdOutWriter.AutoFlush = true;

        AttachConsole(ATTACH_PARENT_PROCESS);
    }

    public void WriteLine(string line)
    {
        _stdOutWriter.WriteLine(line);
        Console.WriteLine(line);
    }
} 
```

# c# - 与 point 相比，pointf 是否四舍五入？

> ID：14199856
> 
> 赞同：4
> 
> 时间：2013-01-07T16:20:55.043
> 
> 标签：c#, comparison, point

我需要将 PointF 与 Point 进行比较，如下所示：

```
PointF myPointF = new PointF(1.1,1.1);
Point myPoint = new Point(1,1);
bool Equal = (myPointF == myPoint); 
```

但我想知道以下哪项是正确的，或者比较实际发生的方式是否不同：

1.  myPoint 先转换为 PointF
2.  myPointF 先四舍五入到一个点
3.  完全不同和不可预测的东西

可以编写一个测试，但我想在文档中看到保证的答案。

此外，[存在从 Point 到 PointF 的隐式转换，](http://msdn.microsoft.com/en-us/library/system.drawing.point.op_implicit%28v=vs.100%29.aspx)而不是相反的转换，所以我*认为*这足以说明 Point 正在转换为 PointF，但同样，我不确定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T16:37:13.717

使用 LinqPad，很容易查看 IL 以了解发生了什么。基本上，`Point`转换为`PointF`，然后`==`调用相等方法`PointF`。

例如，使用以下代码：

```
System.Drawing.PointF myPointF = new System.Drawing.PointF(1.1f ,1.1f);
System.Drawing.Point myPoint = new System.Drawing.Point(1,1);
bool equal = (myPointF == myPoint);
Console.WriteLine(equal); 
```

产生以下 IL：

```
IL_0001:  ldloca.s    00 // myPointF
IL_0003:  ldc.r4      CD CC 8C 3F 
IL_0008:  ldc.r4      CD CC 8C 3F 
IL_000D:  call        System.Drawing.PointF..ctor
IL_0012:  nop         
IL_0013:  ldloca.s    01 // myPoint
IL_0015:  ldc.i4.1    
IL_0016:  ldc.i4.1    
IL_0017:  call        System.Drawing.Point..ctor
IL_001C:  nop         
IL_001D:  ldloc.0     // myPointF
IL_001E:  ldloc.1     // myPoint
IL_001F:  call        System.Drawing.Point.op_Implicit   //<- convert Point to PointF
IL_0024:  call        System.Drawing.PointF.op_Equality  //<- PointF equality
IL_0029:  stloc.2     // equal
IL_002A:  ldloc.2     // equal
IL_002B:  call        System.Console.WriteLine 
```

如果你使用 ILSpy，你可以找到 和 的`Point.op_Implicit`内容`PointF.op_Equality`。

```
// System.Drawing.Point
public static implicit operator PointF(Point p)
{
    return new PointF((float)p.X, (float)p.Y);
}

// System.Drawing.PointF
public static bool operator ==(PointF left, PointF right)
{
    return left.X == right.X && left.Y == right.Y;
} 
```

这表明当转换为 a时，这些`int`值被转换为`float`值，然后将原始实例和转换后的实例的值进行比较。`Point``PointF``float``PointF``PointF`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T16:33:05.850

让我们看看 ildasm.exe 显示了什么：

```
IL_001f:  call       valuetype [System.Drawing]System.Drawing.PointF [System.Drawing]System.Drawing.Point::op_Implicit(valuetype  [System.Drawing]System.Drawing.Point)
IL_0024:  call       bool [System.Drawing]System.Drawing.PointF::op_Equality(valuetype [System.Drawing]System.Drawing.PointF,valuetype [System.Drawing]System.Drawing.PointF) 
```

所以，是的。Point 被视为 PointF 进行比较。

# javascript - 从弹出窗口调用 ajax 加载

> ID：14199859
> 
> 赞同：1
> 
> 时间：2013-01-07T16:21:12.063
> 
> 标签：javascript, jquery

我正在尝试使用 ajax 将 html 动态加载到弹出窗口中：

`$('body').load( new_url, function (responseText, textStatus, XMLHttpRequest ) { ... } );`

它工作正常，但它不会将 html 加载到子窗口中，而是将其加载到打开的窗口中。如果我有对子窗口“win”的引用，我该怎么做这样的事情：

`win.$( 'body' ).load...`

目前，这给出了一个错误说法`win.$ is not a function`。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:25:20.087

试试这个::

```
$("body", win.document).load(URL, function() {
    // do your stuff
}); 
```

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:31:49.453

你应该像这样使用它：

```
$('body', win.document).load... 
```

# ruby-on-rails - 在 Rails 中运行测试时是否使用了默认服务器（例如 Webrick）？

> ID：14199863
> 
> 赞同：1
> 
> 时间：2013-01-07T16:21:18.940
> 
> 标签：ruby-on-rails, testing, webserver

在为 Rails 应用程序运行功能和集成测试时，在执行测试期间使用哪个 Rails 服务器？是否使用了默认的 Rails 服务器？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:54:02.760

Rails 的内置功能和集成测试使用模拟的 Web 请求运行，因此没有 Web 服务器为请求提供服务。（参见动作包中的 lib/action_controller/test_case.rb）

一些 Rails 测试框架（尤其是 Capybara）在运行时使用真实的机架服务器（Capybara 默认使用 Thin）

# objective-c - 性能稍差的 TableView

> ID：14199864
> 
> 赞同：1
> 
> 时间：2013-01-07T16:21:19.813
> 
> 标签：objective-c, uitableview

我将尝试用 2 种不同的单元格实现 TableView，第一个是更高的单元格，里面有一个全角图像，所有其他单元格在左侧都有一个小拇指图像。

我的问题是 TableView 的性能。如果我滚动一个可能有 20 个项目的列表，它会有点抽搐。我已经为性能添加了一些东西，我希望代码不会那么糟糕：

1.  “不需要缓存图像来提高性能”是这样吗？
2.  我是否以正确的方式重用单元格。
3.  这是使用两种不同细胞的正常方式吗？

这是重要的部分：

```
 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (indexPath.section == 0 && indexPath.row == 0) {
        return 160;
    }
    return 60;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    NSString *cellName = [[NSString alloc] init];

    // [...]

    if(indexPath.section == 0 && indexPath.row == 0){
        cellName = @"FirstMainCell";
        CellTemplateFirstNews *cell = [tableView dequeueReusableCellWithIdentifier:cellName];
        if(cell == nil){
            cell = [[[NSBundle mainBundle] loadNibNamed:@"CellTemplateFirstNewsView" owner:nil options:nil] objectAtIndex:0];
        }

        NSURL *urlRowImage = [NSURL URLWithString:[[NSString alloc]initWithFormat:@"http://webserver.de/inhalte/news/title/%@", detailDataNews.title_picture]];
        NSData *dataRowImage = [NSData dataWithContentsOfURL:urlRowImage];
        UIImageView *firstNewsImageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, 160)];
        firstNewsImageView.backgroundColor = [UIColor clearColor];
        firstNewsImageView.opaque = NO;
        firstNewsImageView.image = [UIImage imageWithData:dataRowImage];
        cell.backgroundView = firstNewsImageView;

        // [...]

        return cell;
    }else{
        cellName = @"MainCell";
        CellTemplateNews *cell = [tableView dequeueReusableCellWithIdentifier:cellName];
        if(cell == nil){
            cell = [[[NSBundle mainBundle] loadNibNamed:@"CellTemplateNewsView" owner:nil options:nil] objectAtIndex:0];
        }

        NSURL *urlRowImage = [NSURL URLWithString:[[NSString alloc]initWithFormat:@"http://webserver.de/inhalte/news/cover/%@", detailDataNews.cover_picture]];
        NSData *dataRowImage = [NSData dataWithContentsOfURL:urlRowImage];
        UIImage *rowImage = [UIImage imageWithData:dataRowImage];
        cell.thumbImage.image = rowImage;

        // [...]

        return cell;
    }
}r 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:22:52.583

不要分配初始化任何对象`cellForRowAtIndexPath`您可能正在泄漏大量内存。请记住，每次出现单元格时都会调用此方法，即使是以前显示过的单元格也是如此。

此外，您对字符串变量的分配是多余的。这样做就足够了。

```
BOOL firstCell = (indexPath.row==0 && indexPath.section==0);
NSString *cellIdentifier = firstCell ? @"FirstMainCell" : @"MainCell"; 
UITableViewCell *genericCell = [tableView 
                         dequeueReusableCellWithIdentifier:cellIdentifier];

if (firstCell) {
   cell = (CellTemplateFirstNews*) genericCell;
   // configure...
} 

else {
   cell = (CellTemplateNews*) genericCell;
   // configure...
}

return cell; 
```

延迟的另一个可能原因是对 Web 服务的同步调用。每次单元格变得可见时，您都在执行此操作。您需要延迟加载图像并在必要时更新 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:39:08.790

一种可能性是您忘记`CellIdentifier`在 Xib 中输入。实际上，reuseIdentifier 方法需要您的单元格具有相同的标识符，但您在创建单元格时从未设置它。Xib 中的那些单元格必须输入其标识符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T20:51:06.490

我认为主要问题是每个单元发生的同步网络请求，无论它是否被重用。罪魁祸首是`dataWithContentsOfURL:`。

Check out this [apple sample code](http://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html), or google the phrase "ios lazy table images". [In this SO answer](https://stackoverflow.com/questions/12655360/images-downloaded-asynchronously-only-appear-in-uitableview-after-tap-or-scroll/12656334#12656334), I provide a fairly simple to implement method that takes care of the loading an image asynch, then finding and updating the correct table view row upon completion.

# asp.net - 臃肿的会话结构：

> ID：14199869
> 
> 赞同：0
> 
> 时间：2013-01-07T16:21:36.283
> 
> 标签：asp.net, webforms

我了解结构和类类型之间的基本区别。但是，在 ASP.NET WebForms 应用程序中……在 ASP.NET WebForms 应用程序的 Session 中保存相对较大的数据结构的理想容器类型是什么？它应该是结构还是类？例如...

```
Public Structure SessionData     

 Public ShipVias As List(Of XXXXX999.sycdefil_sql_VW)
 Public ShipTos As List(Of XXXXX999.ABC_Web_ShipTo_VW)
 Public Dests As List(Of XXXXX999.ABC_Web_CofA_VW)
 Public Owners As List(Of XXXXX999.ABC_Web_CofA_VW)

 Public Carts As List(Of XXXXX999.ABC_Web_Cart_VW)
 Public Carriers As List(Of XXXXX999.ABC_Carrier_Accounts_VW)

 Public Countries As List(Of XXXXX999.usp_get_CountryListResult)
 Public States As List(Of XXXXX999.usp_get_StatesListResult)

 Public POItems As List(Of XXXXX999.usp_get_cart_infoResult)

 Public SearchResults As List(Of SearchResult)
 Public Addresses As List(Of AddressResult)

 Public CartItems As List(Of itemsdetail)

 Public POs As List(Of POResult)

 Public SomeCollection As Collection
 Public CmpCode As String
 Public CmpStatus As String
 Public CmpSIPCust As String
 Public CurrentSession As String
 Public AllowAccess As Boolean

 Public QuickAddItems As List(Of QuickAddItem)

End Structure 
```

正如您可能知道的那样，XXXXX999 包含一个 LINQTOSQL DataContext dbml，其中包含存储过程、函数、视图和表。

编辑点：我刚刚意识到我可以使一个结构（C＃）可以为空......在vb.net Nullable（Of SessionData）......还有问号这样的伎俩...... Dim sd As SessionData？我应该将其保留为结构还是将其转换为类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:41:08.373

将其转换为一个类。基于此[MSDN 链接](http://msdn.microsoft.com/en-us/library/ms229017.aspx)，仅应在以下情况下使用结构：

> **如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。**
> 
> **除非类型具有以下所有特征，否则不要定义结构：**
> 
> 1.  它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
> 2.  它的实例大小小于 16 字节。
> 3.  它是不可变的。
> 4.  它不必经常装箱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T17:38:52.597

如果您正在处理不同的值，我会使用一个包含每种列表类型的字典的字典

# google-chrome - Chrome stable 和 Chrome Canary 使用不同的颜色配置文件（Mac OSX）

> ID：14199872
> 
> 赞同：3
> 
> 时间：2013-01-07T16:21:40.817
> 
> 标签：google-chrome, colors, monitors, color-profile

下面是相同十六进制代码的屏幕截图。右边是 Canary，左边是 Chrome 的稳定版本。Canary 使用了错误的颜色配置文件（我认为），明亮的版本是“错误的”版本。有谁知道我如何找出问题所在以及如何解决？

我知道颜色在不同的显示器上看起来总是不同的，但奇怪的是它发生在我的笔记本电脑屏幕上，有两种不同的浏览器。此外，有些事情可能会触发稳定版本使用错误的颜色配置文件。例如：

*   嵌入 iframe
*   -webkit-backface-visibility：隐藏；

我发现这两个导致 Chrome stable 改变颜色（我认为这是因为它使用不同的颜色配置文件）。结果是在页面加载时看到我所有颜色的快速变化。我已经通过背面可见性对其进行了测试，检查了元素并勾选了 css 属性的开/关，我肯定会看到颜色的变化。

这是区别：

![在此处输入图像描述](../Images/c9fc81f0fad4701c34d51b3172143ae7.png)

我使用的是 MacBook Pro OSX 10.8.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-12T07:43:06.667

今天遇到这个问题

1.  去`chrome://flags/`
2.  搜索“颜色”并将`Force color profile`标志切换为不同的。就我而言 - sRGB

# iphone - 单元测试应用程序委托 applicationWillResignActive

> ID：14199873
> 
> 赞同：0
> 
> 时间：2013-01-07T16:21:41.327
> 
> 标签：iphone, objective-c, unit-testing

有没有人找到对 App Delegate 消息 applicationWillResignActive 进行单元测试的方法。我基本上需要启动模拟器，然后切换到跳板，然后检查一个变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:26:03.367

您是否尝试过使用 Instruments 和 UI 自动化对其进行测试？（例如：[http](http://alexvollmer.com/posts/2010/07/03/working-with-uiautomation/) ://alexvollmer.com/posts/2010/07/03/working-with-uiautomation/ ）

# css - 仅 Internet Explorer 7 中的 CSS 字体支持

> ID：14199874
> 
> 赞同：0
> 
> 时间：2013-01-07T16:21:50.017
> 
> 标签：css, internet-explorer-7, font-face

我已经从[http://www.fontsquirrel.com/fonts/Chantelli-Antiqua](http://www.fontsquirrel.com/fonts/Chantelli-Antiqua)下载了这个免费的字体工具包 ，我可以在任何常见的浏览器（包括旧的 IE6）中正确地看到它，但在 IE7 中。我刚刚下载了该工具包并在我安装的任何浏览器中打开了演示文件，但 IE7 看起来有些问题。是 IE 问题还是 CSS 问题？谢谢！

CSS 代码：

```
@font-face {
font-family: 'ChantelliAntiquaRegular';
src: url('Chantelli_Antiqua-webfont.eot');
src: url('Chantelli_Antiqua-webfont.eot?#iefix') format('embedded-opentype'),
     url('Chantelli_Antiqua-webfont.woff') format('woff'),
     url('Chantelli_Antiqua-webfont.ttf') format('truetype'),
     url('Chantelli_Antiqua-webfont.svg#ChantelliAntiquaRegular') format('svg');
font-weight: normal;
font-style: normal; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:28:21.373

尝试替换`format('embedded-opentype')`为`format('eot')`- 应该会有所帮助。

# java - Spring AOP切入点表达式/包含父类的方法

> ID：14199877
> 
> 赞同：4
> 
> 时间：2013-01-07T16:22:02.437
> 
> 标签：java, spring, aop

我在我的 Spring 配置文件中使用如下表达式：

```
<aop:pointcut expression="within(my.app.dao.impl.*)" id="commonDaoOperation"/>
or
<aop:pointcut expression=" execution(public * my.app.dao.impl.*.*(..))" id="commonDaoOperation"/> 
```

我试图匹配的类（在这种情况下是 DAO）扩展了另一个包中的公共类。

上面的切入点表达式是否也应该与我的类的父类的方法匹配？

或者我是否需要在表达式中明确添加父类以匹配其方法：

```
|| within(my.app.dao.common.MyParentClass) 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:02:18.440

经过更多调查，我可以确认**必须将父类添加**到切入点表达式中（除非父类在子类中被覆盖）：

`<aop:pointcut expression="within(my.app.dao.impl.*) || within(my.app.dao.common.MyParentClass)" id="commonDaoOperation"/>`

# mysql - 选择前 3 个月

> ID：14199878
> 
> 赞同：0
> 
> 时间：2013-01-07T16:22:06.313
> 
> 标签：mysql, datediff, period

我正在寻找前 3 个月的门票。通过计算前 3 个月。我看到了这篇文章： [https ://stackoverflow.com/questions/7268896/calculate-3-month-period-using-mysql](https://stackoverflow.com/questions/7268896/calculate-3-month-period-using-mysql)

但这似乎不起作用。这是我的查询

```
select `created`, datediff( now(), `created`) as period , now()
from tag
having period%90=0; 
```

但这是返回日期，例如

```
created             period  now()  
2009-10-25 12:42:15 1170    2013-01-07 10:15:37 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:25:52.660

% 是模数运算符，因此将周期除以 90 并且是测试的余数......即。0,90,180,270,... 都将返回 0。

我想你需要

`period < 90`

过去 90 天内的所有条目。如果您只想要 30 天，那么 period = 90 就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:26:00.377

您可以使用`DATE_SUB()`获取以前的日期。在您的情况下，您需要使用`DATE_SUB(NOW(), INTERVAL 3 MONTH)`.

`SELECT FROM tag WHERE DATE_SUB(NOW(), INTERVAL 3 MONTH) < created`

* * *

**编辑：**`DATE_SUB()`按以下要求添加了替代方案

或者，您可以使用以下方法（可能有一种我目前无法想到的更简洁的方法）：

`STR_TO_DATE(CONCAT(DAY(NOW()), '-', MONTH(NOW()) + IF(MONTH(NOW()) > 3, -3, +9), '-', YEAR(NOW()) + IF(MONTH(NOW()) > 3, 0, -1)), '%e-%m-%Y')`

# google-chrome - 删除适用于 Google Chrome 的 Superfish 购物助手

> ID：14199879
> 
> 赞同：11
> 
> 时间：2013-01-07T16:22:07.923
> 
> 标签：google-chrome, spyware

今天我注意到我的 Google 搜索结果中出现了加载 AJAX 的“购物助手”：

![图片](../Images/111253ee211ed9c2ff9d135d89a085b1.png)

据我所知，这不是谷歌的事情，看起来我的 Chrome 浏览器中有一些间谍软件。有人知道怎么去掉吗？（未在扩展中列出）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-01T04:24:41.987

就我而言，它是`Translate selection 1.2`插件。

尝试将[控制台](http://img.iamntz.com/jing/2013-09-01-07@07h25_59.png)（f12 或 ctrl+shift+i）打开到一个简单的页面（不是 chrome 商店或起始页面）并开始一个一个地禁用扩展，然后刷新页面。

这就是它仍然打开时的[样子。](http://img.iamntz.com/jing/2013-09-01-07@07h27_48.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T05:57:37.493

这是一个间谍软件，带有 chrome 中的 Flash Video Downloader 扩展。卸载应该摆脱这个的 Flash Video 下载器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-02T10:14:47.730

我在`Translate Selection 1.3 extension`. Chrome 网上应用店似乎对这个问题充满了抱怨：[https](https://chrome.google.com/webstore/detail/translate-selection/goanabmlmgfinmjohhepcpffcnkeobjm/reviews) ://chrome.google.com/webstore/detail/translate-selection/goanabmlmgfinmjohhepcpffcnkeobjm/reviews 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-31T05:02:33.857

如果您安装了 Superfish WindowShopper 扩展，请执行以下步骤：

1.  单击浏览器工具栏上的 Chrome 菜单，选择工具，然后单击扩展。

2.  在扩展选项卡中，删除（通过单击回收站）Superfish WindowShopper 扩展。

3.  BetterChrome 扩展也包含这个。在 BetterChrome 选项中取消选中“启用 SuperFish 建议”。

# android-ndk - cygwin 出错：ffmpeg 用 ndk 编译

> ID：14199888
> 
> 赞同：1
> 
> 时间：2013-01-07T16:22:38.873
> 
> 标签：android-ndk, compiler-errors, ffmpeg

最近我正在用 ndk 为 android 编译 ffmpeg，我在这篇文章中这样做（http://vec.io/posts/how-to-build-ffmpeg-with-android-ndk）。configure是对的，但是当我开始制作时，它会出错。配置外壳：

```
export TMPDIR=D:/temp/android
export NDK=/cygdrive/D/DevelopKit/android-ndk-r8d
export PATH=/cygdrive/C/cygwin/tmp/ffmpeg/bin:$PATH
export CC=arm-linux-androideabi-gcc
export LD=arm-linux-androideabi-ld
export AR=arm-linux-androideabi-ar
export C_INCLUDE_PATH=/cygdrive/C/cygwin/tmp/ffmpeg/sysroot/usr/include
export LIBRARY_PATH=/cygdrive/C/cygwin/tmp/ffmpeg/sysroot/usr/lib
CFLAGS="-O3 -Wall -mthumb -pipe -fpic -fasm \
  -finline-limit=300 -ffast-math \
  -fstrict-aliasing -Werror=strict-aliasing \
  -fmodulo-sched -fmodulo-sched-allow-regmoves \
  -Wno-psabi -Wa,--noexecstack \
  -D__ARM_ARCH_5__ -D__ARM_ARCH_5E__ \
  -D__ARM_ARCH_5T__ -D__ARM_ARCH_5TE__ \
  -DANDROID -DNDEBUG"

EXTRA_CFLAGS="-march=armv7-a -mfpu=neon -mfloat-abi=softfp -mvectorize-with-neon-quad"
EXTRA_LDFLAGS="-Wl,--fix-cortex-a8"

FFMPEG_FLAGS="--prefix=/tmp/ffmpeg/build \
  --target-os=linux \
  --arch=arm \
  --enable-cross-compile \
  --cross-prefix=arm-linux-androideabi- \
  --enable-shared \
  --disable-symver \
  --disable-doc \
  --disable-ffplay \
  --disable-ffmpeg \
  --disable-ffprobe \
  --disable-ffserver \
  --disable-avdevice \
  --disable-avfilter \
  --disable-encoders  \
  --disable-muxers \
  --disable-filters \
  --disable-devices \
  --disable-everything \
  --enable-protocols  \
  --enable-parsers \
  --enable-demuxers \
  --disable-demuxer=sbg \
  --enable-decoders \
  --enable-bsfs \
  --enable-network \
  --enable-swscale  \
  --enable-asm \
  --enable-version3"

./configure $FFMPEG_FLAGS --extra-cflags="$CFLAGS $EXTRA_CFLAGS" --extra-ldflags="$EXTRA_LDFLAGS" 
```

配置结果（config.mak 的一部分）：

```
ifndef FFMPEG_CONFIG_MAK
FFMPEG_CONFIG_MAK=1
FFMPEG_CONFIGURATION=--prefix=/tmp/ffmpeg/build --target-os=linux --arch=arm --enable-cross-compile --cross-prefix=arm-linux-androideabi- --enable-shared --disable-symver --disable-doc --disable-ffplay --disable-ffmpeg --disable-ffprobe --disable-ffserver --disable-avdevice --disable-avfilter --disable-encoders --disable-muxers --disable-filters --disable-devices --disable-everything --enable-protocols --enable-parsers --enable-demuxers --disable-demuxer=sbg --enable-decoders --enable-bsfs --enable-network --enable-swscale --enable-asm --enable-version3 --extra-cflags='-O3 -Wall -mthumb -pipe -fpic -fasm   -finline-limit=300 -ffast-math   -fstrict-aliasing -Werror=strict-aliasing   -fmodulo-sched -fmodulo-sched-allow-regmoves   -Wno-psabi -Wa,--noexecstack   -D__ARM_ARCH_5__ -D__ARM_ARCH_5E__   -D__ARM_ARCH_5T__ -D__ARM_ARCH_5TE__   -DANDROID -DNDEBUG -march=armv7-a -mfpu=neon -mfloat-abi=softfp -mvectorize-with-neon-quad' --extra-ldflags='-Wl,--fix-cortex-a8'
prefix=/tmp/ffmpeg/build
LIBDIR=$(DESTDIR)${prefix}/lib
SHLIBDIR=$(DESTDIR)${prefix}/lib
INCDIR=$(DESTDIR)${prefix}/include
BINDIR=$(DESTDIR)${prefix}/bin
DATADIR=$(DESTDIR)${prefix}/share/ffmpeg
MANDIR=$(DESTDIR)${prefix}/share/man
SRC_PATH=.
ifndef MAIN_MAKEFILE
SRC_PATH:=$(SRC_PATH:.%=..%)
endif
CC_IDENT=gcc 4.6
 (GCC)
ARCH=arm
CC=arm-linux-androideabi-gcc
CXX=arm-linux-androideabi-g++
AS=arm-linux-androideabi-gcc
LD=arm-linux-androideabi-gcc
DEPCC=arm-linux-androideabi-gcc
DEPCCFLAGS= $(CPPFLAGS)
DEPAS=arm-linux-androideabi-gcc
DEPASFLAGS= $(CPPFLAGS)
YASM=yasm
DEPYASM=yasm
AR=arm-linux-androideabi-ar
ARFLAGS=rc
AR_O=$@ 
```

但是当我成功的时候

```
CC  libavformat/4xm.o
In file included from ./libavutil/bswap.h:35:0,
                 from ./libavutil/intreadwrite.h:25,
                 from libavformat/4xm.c:30:
./config.h:8:18: warning: missing terminating " character [enabled by default]
In file included from ./libavutil/bswap.h:35:0,
                 from ./libavutil/intreadwrite.h:25,
                 from libavformat/4xm.c:30:
./config.h:9:7: warning: missing terminating " character [enabled by default]
./config.h:9:2: error: missing terminating " character
In file included from ./libavutil/intreadwrite.h:25:0,
                 from libavformat/4xm.c:30:
./libavutil/bswap.h:58:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'static'
common.mak:48: recipe for target `libavformat/4xm.o' failed
make: *** [libavformat/4xm.o] Error 1 
```

这是字符错误，我猜它是 windows 字符（我使用的是 cygwin），我尝试了 dos2unix 但它没有用。请帮助我并感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T13:05:10.220

编辑 ./config.h 并删除换行符

```
#define CC_IDENT "gcc 4.6 (GCC)" 
```

# javascript - 在谷歌地图标记图之间添加延迟

> ID：14199889
> 
> 赞同：0
> 
> 时间：2013-01-07T16:22:41.263
> 
> 标签：javascript, google-maps

我需要在标记的每个图之间添加 1 秒的延迟。我想出了以下代码，但无法使其工作。任何想法 ？

```
var latlng = new google.maps.LatLng(43,2.34);
var myOptions = {
  zoom: 7,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
};
var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

for ( var i=0, len=json.length; i<len; i++ ){
  obj = json[i];

  // Get lat / long and put them on the map
  var lat = obj.latitude;
  var long = obj.longitude;

  display_marker(map, lat, long);
}

display_marker = function(map, lat, long){
  setTimeout(function(){}, 1000);
  var marker = new google.maps.Marker({
    map: map,
    position: new google.maps.LatLng(lat,long),
    title: "Latitude: " +  lat + "\nLongitude: " + long,
  });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:50:39.650

这里有两件事出了问题。

第一个是，您将 setTimeout 与空函数一起使用。您的代码需要在该函数内：

```
display_marker = function(map, lat, long){
  setTimeout(function() {
    var marker = new google.maps.Marker({
      map: map,
      position: new google.maps.LatLng(lat,long),
      title: "Latitude: " +  lat + "\nLongitude: " + long,
    });
  }, 1000);
} 
```

第二个是，你的循环一个接一个地触发 display_marker，所以如果你解决了问题 1，那么你所有的标记将在 ~1000ms 后生成

解决此问题的一种简单方法是，如果您的 increment-var 将当前值传递给您的显示标记，并将其乘以您的 setTimeout：

```
var obj, lat, long;
for ( var i=0, len=json.length; i<len; i++ ){
  obj = json[i];

  // Get lat / long and put them on the map
  lat = obj.latitude;
  long = obj.longitude;

  display_marker(map, lat, long, i);
}

display_marker = function(map, lat, long, increment){
  setTimeout(function() {
    var marker = new google.maps.Marker({
      map: map,
      position: new google.maps.LatLng(lat,long),
      title: "Latitude: " +  lat + "\nLongitude: " + long,
    });
  }, increment * 1000);
} 
```

提示：看看我对变量声明做了什么。您正在重新声明循环中的变量

提示2：我的代码未经测试，但它应该给你正确的想法如何解决你的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:54:30.820

看起来您可能希望`setTimeout`在继续运行`display_marker`. `setTimeout`通过将进程添加到应该在指定时间附近执行的执行堆栈来工作，尽管它不是非常精确。

看起来您想要做的是在迭代值时将引用传递给`display_marker`a 。`setTimeout`

```
setTimeout(function() {
  display_marker(map, lat, long);
}, 1000); 
```

John Resig 写了一篇很棒的关于 JavaScript 计时器的博客文章，我发现它非常有用：[http](http://ejohn.org/blog/how-javascript-timers-work/) ://ejohn.org/blog/how-javascript-timers-work/ 。有关通过参数传递的信息`setTimeout`，请参阅此 SO 答案：[https](https://stackoverflow.com/a/1190656/609206) ://stackoverflow.com/a/1190656/609206 。

# php - 从动态加载的页面获取 PHP POST

> ID：14199890
> 
> 赞同：0
> 
> 时间：2013-01-07T16:22:40.913
> 
> 标签：php, ajax, forms, post

我有一个使用 ajax 动态更新的页面，我有一个动态加载的表单，当单击提交按钮时，它会动态加载另一个页面。执行此操作时如何访问我的 POST 变量？我试过`$_POST['variable']`没有运气。

[ajaxloader.js](http://www.tri-peoria.org/js/ajaxloader.js)

注册-form.php

```
<?php
session_start();
if( isset($_SESSION['ERRMSG_ARR']) && is_array($_SESSION['ERRMSG_ARR']) && count($_SESSION['ERRMSG_ARR']) >0 ) {
    echo '<ul class="err">';
    foreach($_SESSION['ERRMSG_ARR'] as $msg) {
        echo '<li>',$msg,'</li>'; 
    }
    echo '</ul>';
    unset($_SESSION['ERRMSG_ARR']);
}
?>
<form id="loginForm" name="loginForm" method="post" action="javascript:ajaxpage('account/register-exec.php', 'content');">
  <table width="300" border="0" align="center" cellpadding="2" cellspacing="0">
<tr>
  <th>First Name </th>
  <td><input name="firstName" type="text" class="textfield" id="firstName" /></td>
</tr>
<tr>
  <th>Last Name </th>
  <td><input name="lastName" type="text" class="textfield" id="lastName" /></td>
</tr>
<tr>
  <th>Username</th>
  <td><input name="username" type="text" class="textfield" id="username" /></td>
</tr>
<tr>
  <th>Password</th>
  <td><input name="password" type="password" class="textfield" id="password" /></td>
</tr>
<tr>
  <th>Confirm Password </th>
  <td><input name="cpassword" type="password" class="textfield" id="cpassword" /></td>
</tr>
<tr>
  <td>&nbsp;</td>
  <td><input type="submit" name="Submit" value="Register" /></td>
</tr>
</table>
</form> 
```

注册-exec.php

```
<?php
//Start session
session_start();

//Include database connection details
require_once('config.php');

//Array to store validation errors
$errmsg_arr = array();

//Validation error flag
$errflag = false;

//Connect to mysql server
$link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
if(!$link) {
    die('Failed to connect to server: ' . mysql_error());
}

//Select database
$db = mysql_select_db(DB_DATABASE);
if(!$db) {
    die("Unable to select database");
}

//Function to sanitize values received from the form. Prevents SQL injection
function clean($str) {
    $str = @trim($str);
    if(get_magic_quotes_gpc()) {
        $str = stripslashes($str);
    }
    return mysql_real_escape_string($str);
}

//Sanitize the POST values
$firstName = clean($_POST['firstName']);
$lastName = clean($_POST['lastName']);
$username = clean($_POST['username']);
$password = clean($_POST['password']);
$cpassword = clean($_POST['cpassword']);

//Input Validations
if($firstName == '') {
    $errmsg_arr[] = 'First name missing';
    $errflag = true;
}
if($lastName == '') {
    $errmsg_arr[] = 'Last name missing';
    $errflag = true;
}
if($username == '') {
    $errmsg_arr[] = 'Username missing';
    $errflag = true;
}
if($password == '') {
    $errmsg_arr[] = 'Password missing';
    $errflag = true;
}
if($cpassword == '') {
    $errmsg_arr[] = 'Confirm password missing';
    $errflag = true;
}
if( strcmp($password, $cpassword) != 0 ) {
    $errmsg_arr[] = 'Passwords do not match';
    $errflag = true;
}

//Check for duplicate username
if($username != '') {
    $qry = "SELECT * FROM member WHERE username='$username'";
    $result = mysql_query($qry);
    if($result) {
        if(mysql_num_rows($result) > 0) {
            $errmsg_arr[] = 'Username already in use';
            $errflag = true;
        }
        @mysql_free_result($result);
    }
    else {
        die("Query failed");
    }
}

//If there are input validations, redirect back to the registration form
if($errflag) {
    $_SESSION['ERRMSG_ARR'] = $errmsg_arr;
    session_write_close();
    header("location: register-form.php");
    exit();
}

//Create INSERT query
$qry = "INSERT INTO member(firstName, lastName, username, password) VALUES('$firstName','$lastName','$username','".md5($_POST['password'])."')";
$result = @mysql_query($qry);

//Check whether the query was successful or not
if($result) {
    header("location: register-success.php");
    exit();
}else {
    die("Query failed");
}
?> 
```

您可以通过点击 tri-peoria.org 上的“加入”按钮并点击第二个链接来查看我的完整表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:27:29.410

您的 Javascript 正在发送**GET**请求，根据您的声明，您正在检查 $_POST

```
page_request.open('GET', url, true) 
```

所以更新那些匹配然后再试一次

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:37:20.993

您的 javascript 没有发送任何数据并且使用的是`GET`请求，而不是`POST`. 您需要将表单中的数据提取到要发送的变量中。将下面的参数名称和 elementID 替换为您的表单元素 ID。

```
formData = buildData();

page_request.open('POST', url, true);
page_request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
page_request.send(formData);

function buildData() {
  //build a variable to store the form data, use encodeURI to encode any chars that require encoding
  var postFormVars = "addressLine1=" + encodeURI( document.getElementById("addressLine1").value ) +
  "&addressLine2=" + encodeURI( document.getElementById("addressLine2").value ) +
  "&addressLine3=" + encodeURI( document.getElementById("addressLine3").value ) +
  "&town=" + encodeURI( document.getElementById("town").value ) +
  "&postcode=" + encodeURI( document.getElementById("postcode").value );

  return postFormVars;

} 
```

# devexpress - Devexpress XtraReport 自定义 XrTable、XrTableRow、XrTableCell

> ID：14199899
> 
> 赞同：1
> 
> 时间：2013-01-07T16:23:26.320
> 
> 标签：devexpress, xtrareport

我想创建具有一些附加属性的自定义 XrTable（例如：包含 MyXrTableRows/MyXrTableCells 的 MyXrTable）控件。

有什么办法可以实现这个吗？我认为这应该是一种解决方法，因为 DevExpress 对此没有官方支持。

我发现了有关此问题的以下主题：

[http://www.devexpress.com/Support/Center/p/S133680.aspx](http://www.devexpress.com/Support/Center/p/S133680.aspx) [http://www.devexpress.com/Support/Center/p/Q314421.aspx](http://www.devexpress.com/Support/Center/p/Q314421.aspx)

注意：基于 XrLabel 或 XrPanel 创建自定义控件没有问题，但 XrTable 是更复杂的控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T10:08:07.530

我相信获得任何 DevExpress 控件的保证帮助的最佳方式是直接联系[DevExpress 支持](http://www.devexpress.com/Support/Center)。

PS 请注意，在评估期间（30 天），完全支持是免费的。

# jquery - 使用加减按钮更新 div 的值

> ID：14199902
> 
> 赞同：0
> 
> 时间：2013-01-07T16:23:30.593
> 
> 标签：jquery

我有这个功能：

```
 $("#inc<?php echo"$key"; ?>").click(function(){

    prod_id = "<?php echo"$key"; ?>";
    $.ajax({
    type: "POST",
    url: "updateproduct2cart.php",
    data: "itemid="+prod_id+"&act=update&qty=up"
    });

    var currentValue = $("#inc<?php echo"$key"; ?>").closest('#SCprodsB').next('#SCprodsF').find('#totalCommande').html();
    currentValue = parseFloat(currentValue);

    $(":text[name='qty<?php echo"$key"; ?>']").val(Number($(":text[name='qty<?php echo"$key"; ?>']").val()) + 1);

    var totalItems = parseFloat($("#qty<?php echo"$key"; ?>").val());
    var priceItem = parseFloat(<?php echo"$priceProduct"; ?>).toFixed(2);
    var totalValueUp = parseFloat(priceItem * totalItems).toFixed(2);
    $("#subtotal<?php echo"$key"; ?>").html("&#128; "+ totalValueUp);

    /* PART BELOW IS NOT WORKING PROPERLY*/

    var numItems = parseFloat($(":text[name='qty<?php echo"$key"; ?>']").val());
    var totalPriceItems = parseFloat(priceItem * numItems).toFixed(2);
    var newValue = parseFloat(currentValue + totalPriceItems).toFixed(2);
    $("#inc<?php echo"$key"; ?>").closest('#SCprodsB').next('#SCprodsF').find('#totalCommande').html(newValue);

    }); 
```

这是 HTML 部分：

```
<table id="SCproduits" summary="commande">
    <caption></caption>
    <thead>
        <tr>
            <th scope="col">--</th>
            <th scope="col">--</th>
            <th scope="col">--</th>
            <th scope="col">--</th>
            <th scope="col">--</th>
            <th scope="col">--</th>
            <th scope="col">--</th>
            <th scope="col">--</th>
        </tr>
    </thead>
    <tbody id="SCprodsB">
        <tr id="prodItemi3" name="prodItemi3">
            <tr id="prodItemi4" name="prodItemi4">
                <th id="prodItemi4" scope="row">xxxxxxxxx</th>
                <td>xxx</td>
                <td>
                    <td>
                        <button id="deci4" class="SCbutton">-</button>
                        <input id="qtyi4" class="SCinput3" type="text" size="2" value="1"
                        name="qtyi4">
                        <button id="inci4" class="SCbutton">+</button>
                    </td>
                    <td>
                        <td>
                            <td>
                                <td>
            </tr>
    </tbody>
    <tfoot id="SCprodsF">
        <tr>
            <th scope="row"></th>
            <td colspan="7">€ <span id="totalCommande">xxx</span>

            </td>
        </tr>
    </tfoot>
</table> 
```

使用 (inci4 按钮) 时，我无法使用正确的总值更新 (span id="totalCommande")。任何的想法 ？我走错路了吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:34:40.263

你的问题可能在这里：

```
var totalPriceItems = parseFloat(priceItem * numItems).toFixed(2);
var newValue = parseFloat(currentValue + totalPriceItems).toFixed(2); 
```

通过使用`.toFixed`，您将数字转换回字符串。然后，当您将`currentValue`（数字）添加到`totalPriceItems`（字符串）时，您最终会进行字符串连接而不是加法。

因此，如果`currentValue = 1`和`totalPriceItems = "2"`，您将`"12"`在回答时得到 (a string) 而不是`3`.

# javascript - ExtJS 从现有商店创建记录

> ID：14199904
> 
> 赞同：3
> 
> 时间：2013-01-07T16:23:35.737
> 
> 标签：javascript, extjs

我创建了一个这样的 ext 商店：

```
var store = new Ext.data.JsonStore({
       root: 'vars',
       fields: [{ name: 'rec_id', mapping: 'rec' }, { name: 'identity', mapping: 'id'}]
}); 
```

`loadData();`当我通过一些 json向商店添加数据时，这可以正常工作，如下所示：

```
{ vars : {rec: '1', id:'John'} } 
```

我的问题是，如果我`add();`用来将此记录放入商店，我必须首先将其创建为`Ext.data.Record`对象。

我按照此处指出的那样执行此操作：[https](https://stackoverflow.com/a/7828701/1749630) ://stackoverflow.com/a/7828701/1749630并且可以正常工作。

我遇到的问题是记录是使用它们的映射参数而不是我设置的参数输入的。即，“rec_id”变成“rec”，“identity”变成“id”。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T20:10:48.280

您需要手动进行映射，如下所示：

```
var myNewRecord = new store.recordType({
    rec_id: vars.rec,
    identity: vars.id
});

store.add(myNewRecord); 
```

# php - MySQL wait_timeout 和 Wordpress

> ID：14199908
> 
> 赞同：3
> 
> 时间：2013-01-07T16:23:45.367
> 
> 标签：php, mysql, sql, wordpress

我正在排除一系列重复出现的错误：`WordPress database error MySQL server has gone away for query ...`

我想我在[这里](http://thesocialmediaguide.com/2010/07/31/solution-for-wordpress-database-error-mysql-server-has-gone-away-for-query/)找到了一个解决方案，但它已经有几年历史了，我想更好地了解 MySQL wait_timeout 以及它与 Wordpress 的关系，然后再开始使用核心文件或重新配置我的服务器。（我在虚拟专用服务器上，所以我可以选择更改服务器上的 wait_timeout。）

我通过`SHOW VARIABLES;`从 phpMyAdmin 运行检查，wait_timeout 当前设置为 35。这对我来说似乎很低，但我不完全理解它的作用。我正在考虑将其更改为600。

我的主要问题是这是否是一件负责任的事情。但我认为更广泛的问题可以分成更小的部分： 1\. 我可以选择用 PHP（Wordpress）覆盖这个设置吗？2\. 中大型 Wordpress 网站的最佳设置是什么？3\. 是否有任何 Wordpress 配置选项或过滤器可以用来更改设置而无需修改核心文件？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:52:02.010

wait_timeout 是 mysql 在基本上关闭它之前保持非交互式连接打开的时间。

因此，将其增加到 600 秒可以解决您的问题，但是，如果您将其设置为 600 秒，并且有很多人同时在您的网站上运行缓慢的页面，您可能会达到 mysql 开始拒绝连接然后apache 将开始排队请求，直到它随后拒绝请求并且您的服务器开始潜水。

我的建议是尝试找出单个请求花费超过 35 秒的原因，因为老实说，从博客到我的单个页面上的加载时间似乎相当长。

# python - ssh - 区分阻塞和非阻塞模式

> ID：14199909
> 
> 赞同：1
> 
> 时间：2013-01-07T16:23:50.213
> 
> 标签：python, ssh

这听起来像是一个愚蠢的问题，因为每个使用任何 SSH 库的开发人员都应该问自己这个问题（？）。但我真的找不到阻塞或非阻塞之间的区别......

我的意思是好的...一个阻塞直到它收到答案，另一个发送查询并立即返回，然后您自己检查回复缓冲区...我得到了那部分。

但是为什么要使用一个而不是另一个呢？我找不到答案……是关于表演的吗？如果有区别，为什么？

提前感谢您对此问题的任何回答。

--- 编辑：忘记下面的“奖励问题”，我终于编写了非阻塞模式并遇到了同样的问题，它一定是 libssh2 中的东西。所以我还是没有得到非阻塞模式的附加价值……——

> 额外的问题：
> 我不确定这种差异能否解释我正在经历的事情？
> 我有一个 python 脚本，它连接到许多主机以运行多个命令。
> 它在非阻塞模式下使用 paramiko 库。Paramiko 是纯 python，与许多主机建立 ssh 连接真的很慢......
> 我正在为 pylibssh2 更改它，它是 C 库 libssh2 的 python 绑定。由于我没有得到差异，我开始以阻塞模式编写代码。
> 
> 结果：
> - libss2 比 paramiko 快得多（在 4s 而不是 1m30s 内并行连接到 230 个主机）
> - 对于连续运行命令，libssh2 也更快。
> - 当我从多个并行线程通过 ssh 运行命令时，在阻塞模式下使用 libssh2 的代码变得比在非阻塞模式下的 paramiko 慢。
> - 我还注意到与以前的版本相比，CPU 消耗非常低。我猜这部分与 C 与 python 有关，但似乎除了 SSH API 之外，我的脚本本身执行的操作更少。在阻塞模式下通过 SSH 发送命令时线程是否相互阻塞？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T12:37:42.237

原因是如果你想一次做两件事，比如从其他网络连接读取，以及你的 SSH 会话，你有两个选择：

*   使用阻塞 API，并使用两个线程或进程，这样你就可以同时使用它们

*   使用非阻塞 API，所以同一个线程可以同时做这两个

后一种方法称为[异步 I/O](http://en.wikipedia.org/wiki/Asynchronous_I/O)。参见例如广泛使用它的[twisted 。](http://twistedmatrix.com/)

# c# - 从 asp.net 前端添加 sql 记录的最佳实践？

> ID：14199911
> 
> 赞同：2
> 
> 时间：2013-01-07T16:23:52.863
> 
> 标签：c#, asp.net, .net, sql

我有一个网站，它接受用户输入，对其进行处理，然后将记录添加到 sql 表中。

这个周末我遇到了一个问题，SQL 服务器运行起来，给用户留下了很长的处理时间，最后有一个超时响应。最重要的是，处理过的数据丢失了。

最终，我想知道是否有可能以某种方式将这些处理过的数据保存在某个地方，直到 SQL 再次工作，然后添加记录？

我想这可能是通过网络服务来完成的？或者可以在asp.net代码后面完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:42:07.203

不久前，当我们有一个传真服务器负责处理传入的传真并将它们存储在数据库中时，我们处理过这种情况，但是数据库不太可靠。

在这种情况下，如果我们无法访问 SQL Server，我们会将数据序列化到磁盘上的队列中，并在应用程序中设置一个标志，指示 SQL Server 处于脱机状态。设置此标志时，任何后续提交都将存储在磁盘队列中。

然后，我们会定期检查 SQL Server 以查看它是否已备份，如果已备份，我们将处理队列中的每个文件，然后关闭脱机标志。

在 ASP.Net 中，一旦 SQL Server 脱机，您可以启动一个线程来监视 SQL Server，并在它重新联机时执行此处理。

但是，在您描述的情况下，听起来好像有人启动了事务但没有完成它，或者正在发生维护操作（DBCC、备份）。

如果这种情况经常发生，您可能需要设置一个比预期的正常持续时间稍长的 CommandTimeout（比如双倍），如果操作没有在该时间范围内完成，要么告诉用户有问题，要么继续进入缓存模式。

# forms - 在另一个表单上更新组合框

> ID：14199913
> 
> 赞同：0
> 
> 时间：2013-01-07T16:24:01.820
> 
> 标签：forms, ms-access, combobox

我正在寻找一些建议来帮助使用组合框访问数据库表单。使用 Access 2010。它正在控制我们的 PDA 资产我有一个表格 - 带有选项卡控制的 PDA 详细信息。

沿着选项卡，我有 PDA 详细信息和联系方式。

PDA 详细信息从查询中获取信息 - PDA 详细信息 (Q) 和联系人详细信息从 - 联系人 (Q) 获取信息

这两个查询都与联系人姓名列有关。

有没有办法在选择 PDA 联系人时 - 在联系人详细信息选项卡上显示他们的联系信息？像更新或代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:49:13.960

设置子窗体控件的链接子字段和主字段。

链接主字段应设置为列表框控件或组合框控件的名称，绑定列设置为包含相关 ID 的列，链接子字段应设置为联系人 ID。

# c - DLL 注入器不工作（64 位编译器）

> ID：14199917
> 
> 赞同：0
> 
> 时间：2013-01-07T16:24:13.860
> 
> 标签：c, windows, winapi, dll-injection

我还在做我的同一个项目（如果你想知道我为什么问这么多问题。）无论如何我从编译器切换，从 mingw32 (mingw.org) 到 MinGW-w64 (mingw-w64.sourceforge.net/)

虽然项目编译良好，没有任何错误，但注入器不起作用，没有给出任何错误或其他东西。这是来源：

```
int Inject(DWORD pID) 
{ 
    HANDLE hProcess;
    if (!(hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pID)))
        return 0;

    char* szDllName = "subclass64.dll";

    LPVOID LoadLibraryAddress;
    if ((LoadLibraryAddress = (LPVOID)GetProcAddress(GetModuleHandle("kernel32.dll"), "LoadLibraryA")) == NULL)
    {
        char buf[32];
        sprintf(buf, "%d", GetLastError());
        MessageBox(0, buf, "", 0);

        CloseHandle(hProcess);
        return 0;
    }

    LPVOID lpStringAddress;
    if ((lpStringAddress = (LPVOID)VirtualAllocEx(hProcess, NULL, strlen(szDllName), MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE)) == NULL)
    {
        char buf[32];
        sprintf(buf, "%d", GetLastError());
        MessageBox(0, buf, "", 0);

        CloseHandle(hProcess);
        return 0;
    }

    if (WriteProcessMemory(hProcess, lpStringAddress, szDllName, strlen(szDllName), NULL) == 0)
    {
        char buf[32];
        sprintf(buf, "%d", GetLastError());
        MessageBox(0, buf, "", 0);

        CloseHandle(hProcess);
        return 0;
    }

    HANDLE hThread;
    if ((hThread = CreateRemoteThread(hProcess, NULL, 0, (LPTHREAD_START_ROUTINE)LoadLibraryAddress, lpStringAddress, 0, NULL)) == NULL)
    {
        char buf[32];
        sprintf(buf, "%d", GetLastError());
        MessageBox(0, buf, "", 0);

        CloseHandle(hProcess);
        return 0;
    }

    CloseHandle(hProcess); 
    return 1; 
} 
```

我也进行了调试，但没有得到任何奇怪的值：

```
(gdb) p hProcess
$1 = (HANDLE) 0xec
(gdb) p LoadLibraryAddress
$2 = (LPVOID) 0x7f9de0528ac <LoadLibraryA>
(gdb) p lpStringAddress
$3 = (LPVOID) 0x8a4d10000
(gdb) p hThread
$4 = (HANDLE) 0xf0
(gdb) p GetLastError()
$5 = 0 
```

DLL 没有任何问题，因为它可以与另一个 DLL 注入器（来自互联网）一起正常工作

**编辑**：它适用于虚拟/测试应用程序，但它不适用于例如记事本（它适用于使用第三方注入器。）

希望有人可以帮助我，问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:41:46.620

一个问题是目标进程中的 DLL 名称不是以 null 结尾的，因为只有`strlen(szDllName)`字节被分配和写入。将字符串处理逻辑更改为分配和写入`strlen(szDllName) + 1`以确保字符串为空终止。

请注意，要注入的 DLL`subclass64.dll`必须与目标进程位于同一目录中，或者其`PATH`环境变量必须包含 DLL 所在的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T13:23:30.553

我从编译器切换到 Visual Studio，在那里它一开始不起作用，但后来它起作用了。答案不是调试。因此，您导航到应用程序的路径，然后手动启动程序。

# iphone - UIDatePicker UISectionRowData 巨大的内存分配

> ID：14199922
> 
> 赞同：3
> 
> 时间：2013-01-07T16:24:53.557
> 
> 标签：iphone, ios, xcode, uidatepicker

我设置了多个视图控制器，每个视图中都有一个 UIDatePicker。我开始使用泄漏工具进行测试，日期选择器没有泄漏。接下来我开始使用分配工具进行测试，这就是我发现所有问题的地方。每个日期选择器都在 viewDidLoad 中初始化，我将 datepicker 模式设置如下：

```
datePicker.datePickerMode = UIDatePickerModeDate; 
```

每次显示包含日期选择器的视图控制器时，都会分配多个“Malloc 392 KB”，最终导致应用程序崩溃。当深入挖掘分配工具时，它指出负责的调用者是 [UISectionRowData:RefreshWithSection....]。我不知道如何解决这个问题并解决它。任何帮助都会很棒。附件是分配工具的一些屏幕截图。

![在此处输入图像描述](../Images/0d135954ee80245b5018bc84519bfed8.png) ![在此处输入图像描述](../Images/91a44b438887e0c7dfe60723561667ef.png) ![在此处输入图像描述](../Images/5f6384db32e7c220be0d7488ede5bdc4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:33:53.043

我认为这条线

```
datePicker.datePickerMode = UIDatePickerModeDate; 
```

可能具有误导性，它可能是导致泄漏的下一行

```
date.inputView = datePicker; 
```

我的猜测是 date 有一个合成的 inputView 变量，它保留了对象。鉴于您正在执行 alloc 和 init 并且在此行上没有自动释放...

```
datePicker = [[UIDatePicker alloc]init] 
```

我希望这是泄漏，但很难说，因为您稍后可能会调用 release 但如果不是，这将是我的猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-14T10:59:43.287

尝试`UIDatePicker`通过编码制作你的。并在需要时初始化它，不要初始化它`viewDidLoad`或`viewWillAppear`说你有一个按钮，当它被点击时你初始化`UIDatePicker`。

当用户完成选择日期时，将其从 superview 和`datePicker=nil;`. 这样，您可以节省内存，只要 UIDatePicker 可见，它就会被使用。

# signalr - 与 SignalR 同步调用客户端方法

> ID：14199923
> 
> 赞同：5
> 
> 时间：2013-01-07T16:24:53.760
> 
> 标签：signalr

Web 服务器如何使用 SignalR 同步调用客户端上的方法？这里的关键部分是服务器在继续之前应该等待客户端将数据发送回服务器吗？

基本上，我希望将客户端方法调用视为 WCF 服务请求。调用客户端，等待数据返回。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T20:15:28.243

SignalR 不提供同步调用客户端方法的方法。

要实现与同步调用相同的功能，您可以将某种调用 ID 作为参数传递给客户端方法。然后，当客户端方法完成时，客户端可以使用其调用 ID 调用像 ClientMethodCompleted 这样的服务器端方法。基本上，您将实现自己的 ACK。

如果你走这条路，你将不得不在服务器上跟踪客户端调用以及它们各自的 ID。然后，您可以在服务器上的 ClientMethodCompleted 方法中执行同步调用后执行的任何逻辑。

如果您只在一个客户端上调用该方法，这应该相当简单。如果您在多个客户端上调用该方法，则必须跟踪您在哪些客户端上调用您的方法，以便确保所有客户端在运行后续代码之前都已确认调用。

如果您完全担心 DOS 攻击，我还将确保您定期清理存储未确认客户端调用的数据结构，因为这将是一个明显的攻击向量，可能允许恶意客户端破坏内存消耗。

# mysql - 错误号 1045：尝试连接到 MySql 时

> ID：14199931
> 
> 赞同：1
> 
> 时间：2013-01-07T16:25:20.400
> 
> 标签：mysql, windows, sqlyog

我*[为 Windows 安装了 SQLYog Community edition](http://code.google.com/p/sqlyog/downloads/list)* *，这是一个用于MySql*的 GUI 工具。我之前用 XAMPP 安装了 MySql。现在，当我尝试连接时，我看到一个错误*（如所指出的）*：

![在此处输入图像描述](../Images/2bbfc0ccf2234aaf04aeafc75c9ffb10.png)

可能是什么原因，我得到这个？如何连接到 MySql 并开始使用这个 GUI 工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T11:52:45.597

消息说`access denied for suhail @localhost`。这些可能是问题：

*   用户`suhail`在 locahost 中不存在。
*   指定的密码错误。
*   MySql 服务器未启动。如果它启动了端口号不是`3306`。

这些是一些故障排除技术。

还请关注对您问题的评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T00:56:43.153

我有完全相同的错误消息，但是，它是通过在我的机器上使用管理员密码来解决的。我得到的消息如下：

连接信息

> 连接成功！
> MySQL 版本：5.1.54-community

然后我点击确定继续。看看这是否适合你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:31:57.737

错误 1045 是常见的身份验证错误

应该允许用户从远程主机连接。
它应该被定义为 'suhail'@'%' 而不是 'suhail'@'localhost')

[http://webyog.com/faq/content/23/18/en/error-no-1045-connection-denied.html](http://webyog.com/faq/content/23/18/en/error-no-1045-connection-denied.html)

```
* User is not allowed to connect from the actual host. Note that MySQL by default only allows connection from 'localhost'. To specify from where a user may connect SQL wildcards (% and _) can be used. Simply 'someuser@%' means that user 'someuser' may connect from everywhere. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-03T18:04:55.750

我也遇到了同样的问题，但是通过给.. username as-root 解决了。所以。尝试通过提供用户名：root。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-21T05:32:35.830

转到 mysql Workbench >> 用户和权限 >>

在用户帐户选项卡中选择用户，然后在右侧打开架构权限选项卡>>您必须提供所需的权限。

如果不工作，

在 windows 防火墙中打开一个 3306 端口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-04T09:05:36.943

检查端口是否已被使用。3306 端口用于 Mysql 服务器。所以检查它是否正在使用。如果它被使用，那么我们可以终止该进程并再次尝试连接到同一端口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-17T10:15:29.490

请尝试将 127.0.0.1 而不是 localhost 放在 mysqlhost 地址中

我的工作

# node.js - 为什么通过nodejs错误得到simsimi

> ID：14199933
> 
> 赞同：1
> 
> 时间：2013-01-07T16:24:59.850
> 
> 标签：node.js

```
 var request = require('request');
    var cookie = null;

    var say = function(msg, cb) {
       request({
          'url': 'http://www.simsimi.com/func/req?msg=' + encodeURIComponent(msg) + '&lc=zh',
          'method': 'get',
          'headers': {
          'Cookie': cookie,
              'Referer': 'http://www.simsimi.com/talk.htm'
          }
       }, function(error, response, body) {
          console.log(error);
          console.log(response);
          console.log(body);
       });
    }

request({
   'url': 'http://www.simsimi.com/talk.htm',
   'method': 'get'
}, function(error, response, body) {
    cookie = response.headers['set-cookie'];
    cookie = (cookie + "").split(";").shift();
    console.log(cookie);
    say("hello");
} 
```

我想通过 nodejs 获取 simsimi 但总是返回错误 { [Error: Parse Error] bytesParsed: 229, code: 'HPE_INVALID_HEADER_TOKEN' } 谁能解决；谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:54:23.413

原始响应标头通过`curl --referer "http://www.simsimi.com/talk.htm" --cookie "JSESSIONID=A9E30C91FAEFFDD558ED295077F1CBFB" -i --raw http://www.simsimi.com/func/req\?msg\=hello\&lc\=zh`

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Content-Language: en
Content-Type: text/html;charset=UTF-8
Date: Mon, 07 Jan 2013 22:52:07 GMT
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Pragma: no-cache
Server: Apache-Coyote/1.1
Set-Cookie: JSESSIONID=0A6EF5185D0AFF3BAA3E25425B047687; Path=/; HttpOnly
text/html: utf-8
Content-Length: 57
Connection: keep-alive 
```

你有**`text/html: utf-8`**而不是`Content-Type: text/html;charset=UTF-8`. 此外，您提供的不是 html，而是 json，这意味着您的内容类型应该是`application/json`.

# ubuntu - 无法使用桌面链接在 Ubuntu 12 中启动 IntelliJ IDEA12

> ID：14199937
> 
> 赞同：5
> 
> 时间：2013-01-07T16:25:46.190
> 
> 标签：ubuntu, intellij-idea

我创建了一个桌面链接以在 Unbutu 12 中启动 IDEA 12。当我尝试使用此链接启动应用程序时，我收到一条错误消息：“无法启动 Intellij IDEA。未找到 JDK。请验证 IDEA_JDK， JDK_HOME 或 JAVA_HOME 环境变量指向有效的 JDK 安装”。

我可以从终端导航到安装目录并调用 ./idea.sh 启动 IDEA 我的配置：Ubuntu 12.10 Intellij IDEA 12.0.1 Sun JDK 1.6.0_38 IDEA_JDK、JDK_HOME 和 JAVA_HOME 定义在 /etc/bash.bashrc JDK_HOME= /opt/jdk1.6.0_38 export JDK_HOME IDEA_JDK=/opt/jdk1.6.0_38 export IDEA_JDK
JAVA_HOME=/opt/jdk1.6.0_38 export JAVA_HOME PATH=$PATH:$JAVA_HOME/bin export PATH

它们在运行时正确显示： echo $JDK_HOME -> /opt/jdk1.6.0_38 echo $IDEA_JDK -> /opt/jdk1.6.0_38

在 IDEA 中，此 JDK 被识别为同一指定路径下的有效 JDK。

桌面链接是使用原始idea.sh 文件上的“建立链接”命令创建的，并复制到桌面。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T11:14:55.847

集成 IDEA 的推荐方法是调用 Configure | 从欢迎屏幕创建桌面条目（或通过工具 | 从主菜单创建桌面条目）。会话重新启动后，您应该能够从 Dash 菜单启动 IDEA，并将其固定到 Unity 启动器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T02:43:17.407

要使 IDEA_JDK 环境变量对从桌面而不是 shell 启动的进程可见，您需要在 /etc/environment 而不是 .bashrc 文件中定义它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T17:12:34.953

问题的根本原因是IDEA_JDK和JDK_HOME环境变量的位置。它们必须放在 **/etc/profile**中。

在 etc/profile 中定义环境变量后，有几种方法可以创建桌面链接：

1.  如上所述，罗曼舍甫琴科

> 集成 IDEA 的推荐方法是调用 Configure | 从欢迎屏幕创建桌面条目（或通过工具|从主菜单创建桌面条目）

1.  在 ides.sh 上调用“建立链接”并将“链接到 idea.sh”移动到桌面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-27T23:06:05.657

要使 Intellij IDEA 12.1 与 Ubuntu 12.04+ 一起工作：

1> 创建一个名为：`~/.local/share/applications/jetbrains-idea.desktop`

2> 将此内容添加到文件中：

```
[Desktop Entry]
Version=1.0
Type=Application
Name=IntelliJ IDEA
Icon=<YOUR-IDEA-FOLDER>/bin/idea.png
Exec="<YOUR-IDEA-FOLDER>/bin/idea.sh" %f
Comment=Develop with pleasure!
Categories=Development;IDE;
Terminal=false
StartupNotify=true
StartupWMClass=jetbrains-idea 
```

3> 重启系统

现在，您将拥有在您的 Ubuntu 上完全运行的最佳 IDE。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-14T22:35:36.747

只需在系统中安装 java，即使您设置了`$JAVA_HOME`.

```
sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java8-installer 
```

its will solve NO JDK found the issue. It solved my irritating desktop launcher issue.

# windows - 故障转储收集和性能影响

> ID：14199946
> 
> 赞同：3
> 
> 时间：2013-01-07T16:25:59.977
> 
> 标签：windows, performance, debugging, memory-dump

目前，我正在寻找一种解决方案，可以让我在生产环境中监视 .NET Windows 服务应用程序并收集内存转储。我想根据一些特定的阈值，随意和应用程序崩溃来收集它们。我知道实现这一目标的各种方法，例如：

1.  调试诊断
2.  过程转储
3.  通过 WER
4.  广告加
5.  WinDbg 等

一些方法有助于在崩溃期间进行收集，例如选项 #3，而其他方法可以根据性能计数器触发，例如 #1 和 #2。任何非侵入式调试器都可以帮助我完成收集，但我不确定附加一个调试器**会对性能产生什么影响**。例如，如果我使用带有 -e 开关的 Procdump 来收集未处理异常的内存转储，那么受监视应用程序的开销是多少？请记住，我指的是生产环境。

如果您能指出一个来源或方法来解释附加非侵入式调试器对内存转储收集的性能影响，我将不胜感激。理想情况下，这将是一个**量化的衡量标准**，尽管它超出了我的预期。

PS：我不是指内存转储写入磁盘所需的时间，应用程序完全冻结。那是另一回事。

# jquery - JQuery 和 Ajax：无法读取未定义的属性“长度”

> ID：14199949
> 
> 赞同：5
> 
> 时间：2013-01-07T16:26:05.317
> 
> 标签：jquery, ajax

我试图通过使用 URL 和 AJAX 中的变量来显示 JSON 来从网站获取特定请求。似乎一切正常，但出现错误“TypeError：无法读取未定义的属性'长度'”。调试器指向 JQuery 文件和我的脚本中的行 ($.ajax.success)。

```
function getQueryVariable(variable) {
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split("=");
    if (pair[0] == variable) {
      return pair[1];
    }
  }
  alert('Query Variable ' + variable + ' not found');
}

$(document).ready(function () {

  var output = $('#news');
  var postid = getQueryVariable('id');

  $.ajax({
    url: 'http://www.domain.pro/api/get_post/?post_id=' + postid + '&post_type=news',
    async: false,
    callback: 'callback',
    crossDomain: true,
    contentType: 'application/json; charset=utf-8',
    type: 'POST',
    dataType: 'jsonp',
    timeout: 5000,
    success: function (data, status) {
       $.each(data.posts, function (i, item) {
        var news = '<div>' + item.title + '</div><div>' + item.content + '</div><hr/>';

        output.append(news);

      });
    },
    error: function () {
      output.text('There was an error loading the data.');
    }
  });
}) 
```

你能帮我解决这个问题吗？真的很感谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T16:39:01.647

您应该在对其执行操作之前验证您的数据：

**更新**

```
 $.ajax({
            url: 'http://www.domain.pro/api/get_post/?post_id=' + postid + '&post_type=news',
            async: false,
            callback: 'callback',
            crossDomain: true,
            contentType: 'application/json; charset=utf-8',
            type: 'POST',
            dataType: 'jsonp',
            timeout: 5000,
            success: function (data, status) {
               if(data != undefined && data.post != undefined){
                 $('#news').append('<div>' + data.post.title + '</div><div>' + data.post.content + '</div><hr/>');
                }
            },
            error: function () {
              output.html('<h1 class="error">There was an error loading the data.</h2>');
            }
          }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T16:43:50.267

如果您的数据为空，您在 data.post 上应用 $.each 可能是未定义的。$.each 期望数组或集合，这就是您收到长度错误的原因。由于您的数据为空，因此 data.post 将未定义。你可以在申请 $.each 之前检查一下

```
if(typeof data == "object" && data.post)
    //Your code here. 
```

this check should be applied whenever you expect some data from ajax.

# c# - 为什么爬虫不进入下一页？

> ID：14199955
> 
> 赞同：-1
> 
> 时间：2013-01-07T16:26:27.603
> 
> 标签：c#, xpath, web-crawler

我已经制作了这个爬虫，我想知道为什么我转到下一页的代码不起作用。代码来了。

```
 var pessoaFinder = new ABCTelefonosPessoasLinkFinder();
        var pessoaContent = new ABCTelefonosPessoasContentFinder();
        var Urls = DadoPo.ListarUrls();

        foreach (var url in Urls)
        {
            var tempPessoas = new List<string>();
            tempPessoas.AddRange(pessoaFinder.Find(url));

            foreach (var linkPessoa in tempPessoas)
            {
                var infoPessoa = new List<DadoTo>();
                infoPessoa.AddRange(pessoaContent.Find(url + linkPessoa));

                foreach (var pessoa in infoPessoa)
                {
                    if (DadoPo.VerificaLink(url + linkPessoa))
                    {
                        continue;
                    }
                   DadoPo.Salvar(pessoa);
                }
            }
        }
    } 
```

这会调用调用函数的函数来查找链接，然后转到下一页。这是查找人员信息并转到下一页的功能（我认为错误所在的位置）。

```
 public string[] Find(string url)
    {
        var webGet = new HtmlWeb();
        var document = webGet.Load(url);
        var nodes = document.DocumentNode.SelectNodes("//div[@id='mainContent']/div/a");

        if (nodes == null)
        {
            return new string[0];
        }

        foreach (var node in nodes)
        {
            var href = node.GetAttributeValue("href", "");
            cidades.Add(href);
        }

        var elUrlProximaPagina = document.DocumentNode.SelectSingleNode("//div[@id='mainContent']/div[@class='paginado']/div/*[contains(@class,'previous')]");

        if (elUrlProximaPagina == null)
        {
            return cidades.ToArray();
        }

        var urlProximaPagina = elUrlProximaPagina.GetAttributeValue("href", "");

        if (!String.IsNullOrEmpty(urlProximaPagina))
        {
            return Find(urlProximaPagina);
        }
        return cidades.ToArray();
    }
} 
```

请尽快答复。非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T18:22:30.240

一个可能的问题是，写入`SelectSingleNode("//blah")`将导致每次都从根节点搜索文档，并且无论您从哪个节点开始搜索，它总是会返回第一个匹配结果。这会导致您继续选择一个节点并重新抓取它。您应该使用`.//`语法来指定您正在从当前节点搜索：`SelectSingleNode(".//blah")`.

所以你的 XPATH 应该是：

```
document.DocumentNode.SelectSingleNode(".//div[@id='mainContent']/div[@class='paginado']/div/*[contains(@class,'previous')]"); 
```

您还必须**修复代码中的所有其他 XPATH 选择器，**以便从当前节点而不是根节点进行选择。

# html - CSS下划线

> ID：14199956
> 
> 赞同：2
> 
> 时间：2013-01-07T16:26:30.603
> 
> 标签：html, css, underline

要在 CSS 中为文本添加下划线，我们可以这样做：

```
h3 {text-decoration:underline;} 
```

但是，这只强调了 h3 标记中包含的文本。如果希望下划线穿过页面怎么办？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-07T16:28:17.363

然后你不会有下划线，你会在元素上有一个边框。

```
border-bottom: 1px red solid; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T16:29:15.380

您可以尝试使用边框：

```
h3 { border-bottom: 1px solid } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T16:34:07.867

假设您的元素直接位于 body 标签下，您可以使用：

```
h3 {
    width: 100%;
    border-bottom: 1px solid red;
} 
```

这条线将跨越整个页面，或者它所在的任何元素......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T16:33:08.493

也许试试水平规则（hr）标签？这也可以根据您的喜好进行风格化。

* * *

# java - 使用 Javascript 将 doc/docx 批量转换为 pdf

> ID：14199958
> 
> 赞同：0
> 
> 时间：2013-01-07T16:26:27.913
> 
> 标签：java, javascript, docx, doc

我正在开发一个以编程方式将 .doc 和 .docx 文件转换为 pdf 的 Java 程序。我已经测试了几种将 .doc 和 .docx 文件转换为 pdf 的不同方法，例如使用几个开源 Java 库，遗憾的是这些库经常会弄乱文档中的布局。

我偶然发现了一个使用底层 Microsoft Word 实例打开文件并将其保存为 PDF 的 javascript 脚本（位于：[https ://superuser.com/questions/17612/batch-convert-word-documents-to -pdfs-free/28303#28303](https://superuser.com/questions/17612/batch-convert-word-documents-to-pdfs-free/28303#28303) ):

```
var fso = new ActiveXObject("Scripting.FileSystemObject");
var docPath = WScript.Arguments(0);
var pdfPath = WScript.Arguments(1);
docPath = fso.GetAbsolutePathName(docPath);
var objWord = null;
try{
    WScript.Echo("Saving '" + docPath + "' as '" + pdfPath + "'...");
    objWord = new ActiveXObject("Word.Application");
    objWord.Visible = false;
    var objDoc = objWord.Documents.Open(docPath);
    var wdFormatPdf = 17;
    objDoc.SaveAs(pdfPath, wdFormatPdf);
    objDoc.Close();
    WScript.Echo("The CV was succesfully converted.");
} catch(err){
    WScript.Echo("An error occured: " + err.message);
}finally{
    if (objWord != null){
        objWord.Quit();
    }
} 
```

这个 javascript 脚本是从我的 Java 程序中为每个文档同步调用的。

在小范围内，这似乎很有效，但是在处理数千个文件时，我遇到了几个问题：

*   有时一个 Word 进程会在“另存为”提示下挂起，如果发生这种情况，则需要用户干预才能继续。在任何用户交互之前，该过程都会阻塞。
*   有时 Word 进程会挂在“书签”提示符下。在任何用户干预以通过提示之前，该过程也被阻止。

我正在寻找最好/最干净的方法，通过给它们一个截止日期或其他东西来更好地控制这些 Word 进程。就像给他们 5 秒钟打开 Word 文档并将其保存为 PDF 一样，5 秒钟后如果仍然处于活动状态，该进程将被终止。

我过去处理过类似的事情，解决方案包括“杀死单词进程批处理脚本”来杀死程序结束后卡住的任何 WORD 进程。不是很干净，但它完成了它的工作。

任何经验或想法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-01-22T21:56:31.007

您可以使用[https://www.npmjs.com/package/@nativedocuments/docx-wasm](https://www.npmjs.com/package/@nativedocuments/docx-wasm)无服务器（例如 AWS Lambda）并行执行转换。Lambda 负责并发处理。docx-wasm 是独立的（即无需运行 Microsoft Word）。免费增值模式。

**编辑 2019 年 4 月**

[https://github.com/NativeDocuments/docx-to-pdf-on-AWS-Lambda](https://github.com/NativeDocuments/docx-to-pdf-on-AWS-Lambda)是一个在 Lambda 上使用它的示例项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T07:30:41.300

我设法解决了与进程卡在 Microsoft Word 中的提示符相关的问题。在我的最终解决方案中，我更改了我的 Java 代码，使其在单独的线程中启动 Javascript 脚本。然后我的主线程会休眠几秒钟，然后检查另一个线程。

另一个线程保留对它用来运行 Javascript 脚本的 Process 实例的引用。然后，主线程将检查该进程的 exitValue，如果脚本卡在 Microsoft Word 提示符处，则会抛出 IllegalThreadStateException。然后，我将通过终止进程并清理 Microsoft Word 留下的任何临时文件来处理异常。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-09-26T13:04:44.017

[微软支持](http://support2.microsoft.com/default.aspx?scid=kb;en-us;257757)说不要在无人看管的情况下使用办公室，也不要在服务器端使用。

如果您需要简单的转换，LibreOffice 有一个命令行选项 -convert-to。

# ajax - Primefaces 和 ajax onsuccess 事件

> ID：14199964
> 
> 赞同：0
> 
> 时间：2013-01-07T16:26:41.383
> 
> 标签：ajax, primefaces

我将 ajax`remoteCommand`组件与 Primefaces 一起使用，并且该组件`inputHidden`使用布尔值更新字段。

`onsuccess`我在事件上调用 JS 函数，`remoteCommand`但似乎我的函数在 DOM 更新之前被调用，因为当我测试`inputHidden`值时，这不是正确的值，但如果我设置间隔以测试 3 秒后，我有正确的值......

代码 ：

```
<p:remoteCommand process="..." onsuccess="hideOrShowNotification();" /> 
```

第一个JS测试：

```
function hideOrShowNotification(){
   alert($('#tabView\\:register_form\\:hiddenNotification').val()); 
} 
```

第二次JS测试：

```
function hideOrShowNotification(){
  setInterval(function(){alert($('#tabView\\:register_form\\:hiddenNotification').val());}, 3000);  
} 
```

在第一种情况下，我收到`false`了价值，在第二种情况下，我收到了`true`价值。期望值为`true`。

所以当我的 JS 函数被调用时，我的 DOM 没有完全加载。

完全加载 DOM 后如何调用 JS 函数？我相信`onsuccess`事件会这样做，但显然不会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T16:35:18.167

好吧……这就是`oncomplete`事件。我之前测试过它，但也许我忘记清除浏览器缓存以重新加载新的 JS 文件。

**编辑：** [链接到 primefaces 标签文档](http://www.primefaces.org/docs/vdl/3.4/primefaces-p/ajax.html)

# android - 创建联系人组并仅保存在应用程序中

> ID：14199970
> 
> 赞同：0
> 
> 时间：2013-01-07T16:27:01.837
> 
> 标签：android

在我的项目中创建联系人组并将联系人添加到特定组，这些联系人组在主要联系人中不可见，假设用户删除联系人或组，那么它不应该影响主要联系人。任何人请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:29:09.483

您可以为它使用`SQLite`数据库，并且您可以仅为您的应用程序存储这些联系人。可以在[此处](http://www.vogella.com/articles/AndroidSQLite/article.html)找到如何使用`SQLite`数据库的教程。

# wcf - 如何正确等待 WCF 异步

> ID：14199972
> 
> 赞同：0
> 
> 时间：2013-01-07T16:27:16.330
> 
> 标签：wcf, mvvm, asynchronous, wait, async-await

这是我在董事会上的第一个问题。我正在使用 WCF 和 MVVM 模式编写我的第一个企业级 Silverlight (5) 应用程序。我的问题是我不明白如何让模型类调用 WCF 服务，并且（这是问题所在）在将结果返回给调用视图模型之前**等待结果。**

我查看了 msdn 以了解 async 和 await 关键字的用法，但我不确定需要将哪种方法标记为“async”。在我看来，服务的自动生成的 Reference.cs 文件可能需要修改，但我有疑问。更重要的是，我什至不确定我是否需要使用 async 和 await，因为我认为通过使用 WCF 应该可以正常工作。

无论如何，这是我拥有的模型类。我希望在 WCF 调用完成后执行 return 语句，但事实并非如此：

```
public class CRMModel
{
    ObservableCollection<CarrierInfo> carrierInfoCollection = new ObservableCollection<CarrierInfo>();

    public ObservableCollection<CarrierInfo> GetCarrierInformation()
    {
        var client = new CarrierRateService.CarrierRateServiceClient();
        client.GetCarrierInformationCompleted += (s, e) =>
        {
            var info = e.Result;
            carrierInfoCollection = info;
            System.Diagnostics.Debug.WriteLine("Just got the result set: " + carrierInfoCollection.Count);

        };

        client.GetCarrierInformationAsync();

        System.Diagnostics.Debug.WriteLine("About to return with: " + carrierInfoCollection.Count);
        return carrierInfoCollection;
    }
} 
```

正如您可能猜到的那样，结果是：

即将返回：0

刚得到结果集：3

非常感谢你的帮助！弗朗西斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T17:34:36.763

欢迎来到 SO！

首先，要启用Silverlight 5 `async`，`await`您需要安装[Microsoft.Bcl.Async 包](https://nuget.org/packages/Microsoft.Bcl.Async)（目前处于 Beta 版）。

接下来，您需要解决 WCF 代理生成器没有生成`await`兼容的异步方法这一事实。解决此问题的最简单方法是选中 Visual Studio 2012 添加服务引用对话框中的相应框。不过，我不能 100% 确定这是否适用于 Silverlight，所以如果不适用，您可以[使用`TaskCompletionSource`创建自己的`async`-compatible wrapper](http://msdn.microsoft.com/en-us/library/hh873178.aspx#EAP)。

这是完整的示例代码：

```
public static Task<ObservableCollection<CarrierInfo>> GetCarrierInformationTaskAsync(this CarrierRateService.CarrierRateServiceClient @this)
{
    var tcs = new TaskCompletionSource<ObservableCollection<CarrierInfo>>();

    @this.GetCarrierInformationCompleted += (s,e) =>
    {
        if (e.Error != null) tcs.TrySetException(e.Error);
        else if (e.Cancelled) tcs.TrySetCanceled();
        else tcs.TrySetResult(e.Result);
    };
    @this.GetCarrierInformationAsync(url);
    return tcs.Task;
} 
```

您现在可以使用以下代码等待它：

```
public ObservableCollection<CarrierInfo> GetCarrierInformation()
{
    var client = new CarrierRateService.CarrierRateServiceClient();
    carrierInfoCollection = await client.GetCarrierInformationTaskAsync();
    System.Diagnostics.Debug.WriteLine("Just got the result set: " + carrierInfoCollection.Count);

    System.Diagnostics.Debug.WriteLine("About to return with: " + carrierInfoCollection.Count);
    return carrierInfoCollection;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:58:40.150

感谢您的建议，Stpehen 和 Toni。我一直在苦苦挣扎，直到我使用了[本文](http://www.codeproject.com/Articles/154736/Data-and-Command-Bindings-for-Silverlight-MVVM-App)中概述的方法，即 VM 将回调方法传递给模型，模型仅使用此方法调用 WCF 服务。

当我最初在模型中的匿名函数中指定逻辑时，我遇到了异步的计时问题。

我来自大型机背景，所以 .NET 中这种简单的东西对我来说仍然很新颖。:)

# c++ - 从数组中向量化提取特定的短裤图案，并插入到新数组中

> ID：14199976
> 
> 赞同：4
> 
> 时间：2013-01-07T16:27:32.387
> 
> 标签：c++, algorithm, visual-c++, vectorization, sse2

我有一个短裤数组，我想在其中获取一半的值并将它们放入一个大小为一半的新数组中。我想以这种模式获取特定值，其中每个块是 128 位（8 个短裤）。这是我将使用的唯一模式，它不需要是“任何通用模式”！

![](../Images/7633d4fcce57b27d976ad931c9bc8673.png)

白色的值被丢弃。我的数组大小将始终是 2 的幂。这是它的模糊概念，未矢量化：

```
unsigned short size = 1 << 8;
unsigned short* data = new unsigned short[size];

...

unsigned short* newdata = new unsigned short[size >>= 1];

unsigned int* uintdata = (unsigned int*) data;
unsigned int* uintnewdata = (unsigned int*) newdata;

for (unsigned short uintsize = size >> 1, i = 0; i < uintsize; ++i)
{
 uintnewdata[i] = (uintdata[i * 2] & 0xFFFF0000) | (uintdata[(i * 2) + 1] & 0x0000FFFF);
} 
```

我从这样的事情开始：

```
static const __m128i startmask128 = _mm_setr_epi32(0xFFFF0000, 0x00000000, 0xFFFF0000, 0x00000000);
static const __m128i endmask128 = _mm_setr_epi32(0x00000000, 0x0000FFFF, 0x00000000, 0x0000FFFF);

__m128i* data128 = (__m128i*) data;
__m128i* newdata128 = (__m128i*) newdata; 
```

我可以使用掩码迭代执行`_mm_and_si128`以获取我正在寻找的值，与 结合`_mm_or_si128`并将结果放入`newdata128[i]`. 但是，我不知道如何将事物“压缩”在一起并删除白色值。看来如果我能做到这一点，我就根本不需要面具了。

![](../Images/62354d23e1077520ba9d1c9a9cbe7447.png)

怎么可能呢？

无论如何，最终我也想做与此操作相反的操作，并创建一个两倍大小的新数组并在其中展开当前值。

![](../Images/59460d47a9c9da2d06a4017e5fe537ac.png)

我还将在白色块中插入新值，我必须用原始数据中的每对短裤迭代地计算这些值。这种计算不能向量化，但结果值的插入应该是向量化的。如何将当前值“展开”到新数组中，插入计算值的最佳方法是什么？我是否应该为每个 128 位迭代计算它们并将它们放入自己的临时块（64 位？128 位？），然后做一些事情来批量插入？还是应该将它们直接放置到我的目标`__m128i`中，因为它的成本似乎应该等同于放入临时设备？如果是这样，如何在不弄乱我的其他价值观的情况下做到这一点？

我宁愿为此最多使用 SSE2 操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T19:20:35.700

这是您可以尝试的大纲：

*   使用带有零的寄存器的交错指令 ( `_mm_unpackhi/lo_epi16`) 来“展开”您的 16 位值。现在您将拥有两个看起来像`B_R_B_R_`.
*   右移创建`_B_R_B_R`
*   并且 R 不在第一个版本中`B___B___`
*   并且 B 不在第二个版本中`___R___R`
*   或一起`B__RB__R`

在另一个方向上，在使用 shift/and/or 设置后最后使用 _mm_packs_epi32。

每个方向应该是 10 个 SSE 指令（不包括常量设置、零和 AND 掩码以及加载/存储）。

# rapidminer - 如何将 SentiWordNet 连接到 RapidMiner？

> ID：14199980
> 
> 赞同：0
> 
> 时间：2013-01-07T16:27:37.410
> 
> 标签：rapidminer

SentiWordNet 是一个文本文件。在 RapidMiner 中，“OpenWordNet Dictionary”只能用于访问 exe 文件。如何从 SentiWordNet 中提取情绪分数以进行进一步处理？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T05:00:01.950

当然可以.. 使用一点代码，您可以从文本文件中获取 sentiwordnet 分数。但问题是每个同一个词可能有几个不同的含义。在处理这个问题时，您可以简单地取平均分或进行词义消歧

# java - 如何增加 JXBusyLabel 的大小？

> ID：14199984
> 
> 赞同：1
> 
> 时间：2013-01-07T16:28:03.167
> 
> 标签：java, swingx

我有以下代码：

```
 JXBusyLabel label = new JXBusyLabel();      
  label.setBusy(true);
  label.setSize(100, 100);
  frame.add(label); 
```

我需要一个圆形的加载指示器，这个代码很好。但是我需要增加圆圈的大小，因为现在它的大小非常小。但是`setSize`方法不允许我做我想做的事。请告诉我，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:37:45.720

从[swingx javadoc](https://pirlwww.lpl.arizona.edu/resources/guide/software/SwingX/org/jdesktop/swingx/JXBusyLabel.html)中，您可以`Dimension`像这样将对象传递给 JXBusyLabel：

`JXBusyLabel label = new JXBusyLabel(new Dimension(100,84));`

# ios - 访问单个字符串参数（UIAlertView otherButtonTitles）

> ID：14199987
> 
> 赞同：0
> 
> 时间：2013-01-07T16:28:18.393
> 
> 标签：ios, nsstring, uialertview

我正在为应用程序编写自己的自定义警报视图。客户对警报类型消息有自己的外观/感觉。我读过子类`UIAlertView`化并不是一个好主意，所以我只是想使我正在使用的当前消息视图更加动态，以便我可以更多地重用它。

好的，我的问题。我正在窃取初始化`UIAlertView`以初始化我自己的自定义警报。

```
- (id)initWithTitle:(NSString *)title message:(NSString *)message delegate:(id)delegate cancelButtonTitle:(NSString *)cancelButtonTitle otherButtonTitles:(NSString *)otherButtonTitles, ... NS_REQUIRES_NIL_TERMINATION; 
```

`UIAlertView`这是从 Apple 的初始化程序中取出的。我的也一样，所以为什么不直接使用他们的 init。

我希望能够为 传递多个字符串`otherButtonTitles`，就像`UIAlertView`. 我的问题是，如何访问传入的字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:36:10.123

我可能会将`otherButtonTitles`参数设为 NSArray 而不是 NSString。从那里您可以根据数组的计数动态生成其他按钮，并将所述按钮的标题设置为存储在数组当前索引中的 NSString。

**编辑：**我认为我在 UIAlertView.m 中找到了一些有希望的东西（不确定它是否真的来自 Apple），但它也将 otherButtonTitles 作为字符串。它使用 a`va_list`来存储 otherButtonTitles，然后将对象添加到包含所有按钮的可变数组中，包括索引 0 处的取消按钮（如果适用）。

[https://github.com/BigZaphod/Chameleon/blob/master/UIKit/Classes/UIAlertView.m](https://github.com/BigZaphod/Chameleon/blob/master/UIKit/Classes/UIAlertView.m)

这是一段摘录：

```
 if (otherButtonTitles) {
        [self addButtonWithTitle:otherButtonTitles];

        id buttonTitle = nil;
        va_list argumentList;
        va_start(argumentList, otherButtonTitles);

        while ((buttonTitle=(__bridge NSString *)va_arg(argumentList, void *))) {
            [self addButtonWithTitle:buttonTitle];
        }

        va_end(argumentList);
    } 
```

# python - 不想在我的 python 代码中使用单引号

> ID：14199994
> 
> 赞同：0
> 
> 时间：2013-01-07T16:29:02.027
> 
> 标签：python, python-2.7, python-2.x

我正在使用 Python 2.7 ......我面临的问题是当我使用这段代码时

```
print "How old are you?",   
age = raw_input()  
print "How tall are you?",  
height = raw_input()  
print "How much do you weigh?",  
weight = raw_input()  

print "So, you're %r old, %r tall and %r heavy." % (
    age, height, weight) 
```

输出是 -

```
How old are you? 35  
How tall are you? 6'2"  
How much do you weigh? 180lbs  
So, you're '35' old, '6\'2"' tall and '180lbs' heavy. 
```

但我不希望输出的第 4 行中出现 35、180 lbs ang 6 2" 左右的单引号。怎么办

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T16:30:25.723

不要使用`%r`. 改变：

```
print "So, you're %r old, %r tall and %r heavy." % ( age, height, weight) 
```

到：

```
print "So, you're %s old, %s tall and %s heavy." % ( age, height, weight) 
```

`repr()`和之间的区别在于`str()`它`repr()`是字面的，并用字符串打印出引号。

这是解释器中的一个示例：

```
>>> 打印 '%r' % '嗨'
'你好'
>>> 打印 '%s' % '嗨'
你好
>>>

```