# StackOverflow 问答 13864000-13864999

# objective-c - 通过 TCP 写入流但没有响应

> ID：13864000
> 
> 赞同：1
> 
> 时间：2012-12-13T16:18:39.083
> 
> 标签：objective-c, tcp, stream, obd-ii

我想通过 OBD WiFi 适配器读取汽车的车辆识别号 (VIN)。ping 适配器是可能的，它得到了一个固定的 IP 地址和端口。

现在我想在 Stream 上发送 VIN 请求，但没有任何反应。

我的 .h 文件

```
@interface Communicator : NSObject <NSStreamDelegate> {
@public

NSString *host;
int port;
}

- (void)setup;
- (void)open;
- (void)close;
- (void)stream:(NSStream *)stream handleEvent:(NSStreamEvent)event;
- (void)readIn:(NSString *)s;
- (void)writeOut:(NSString *)s;

@end 
```

我的 .m 文件

```
#import "Communicator.h"

CFReadStreamRef readStream;
CFWriteStreamRef writeStream;
NSInputStream *inputStream;
NSOutputStream *outputStream;

@implementation Communicator

- (void)setup {
NSURL *url = [NSURL URLWithString:host];

NSLog(@"Setting up connection to %@ : %i", [url absoluteString], port);

CFStreamCreatePairWithSocketToHost(kCFAllocatorDefault, (__bridge CFStringRef)[url host], port, &readStream, &writeStream);

if(!CFWriteStreamOpen(writeStream)) {
    NSLog(@"Error, writeStream not open");
    return;
}
[self open];

NSLog(@"Status of outputStream: %i", [outputStream streamStatus]);
return;
}

- (void)open {
NSLog(@"Opening streams.");

inputStream = (__bridge NSInputStream *)readStream;
outputStream = (__bridge NSOutputStream *)writeStream;

[inputStream setDelegate:self];
[outputStream setDelegate:self];

[inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

[inputStream open];
[outputStream open];

if ([inputStream hasBytesAvailable])
{
    NSLog(@"We can recieve something from the InputStream");
}
if ([outputStream hasSpaceAvailable])
{
    NSLog(@"We can send something trough the OutputStream");
}

}

- (void)close {
NSLog(@"Closing streams.");
...
}

- (void)stream:(NSStream *)stream handleEvent:(NSStreamEvent)event {
NSLog(@"Stream triggered.");

NSLog(@"event: %u", event);

switch(event) {
    case NSStreamEventHasSpaceAvailable: {
        if(stream == outputStream) {
            NSLog(@"outputStream is ready.");
        }
        break;
    }
    case NSStreamEventHasBytesAvailable: {
        if(stream == inputStream) {
            NSLog(@"inputStream is ready.");

            uint8_t buf[1024];
            unsigned int len = 0;

            len = [inputStream read:buf maxLength:1024];

            if(len > 0) {
                NSMutableData* data=[[NSMutableData alloc] initWithLength:0];

                [data appendBytes: (const void *)buf length:len];

                NSString *s = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];

                [self readIn:s];

            }
        }
        break;
    }
    default: {
        NSLog(@"Stream is sending an Event: %i", event);

        break;
    }
}
}

- (void)readIn:(NSString *)s {
NSLog(@"Reading in the following:");
NSLog(@"%@", s);
}

- (void)writeOut:(NSString *)s {
uint8_t *buf = (uint8_t *)[s UTF8String];
[outputStream write:buf maxLength:strlen((char *)buf)];
NSLog(@"Status of outputStream: %i", [outputStream streamStatus]);

NSError *theError = [outputStream streamError];
NSLog(@"Error: %@", theError);

NSLog(@"Writing out the following:");
NSLog(@"%@", s);
}

@end 
```

我的主要

```
@autoreleasepool {

Communicator *c = [[Communicator alloc] init];

c->host = @"https://169.254.1.10";
//c->host = @"http://169.254.1.10";
//c->host = @"169.254.1.10";
c->port = 23;

[c setup];
[c open];

[c writeOut:@"0902"];

do {
} while (1);

         }
return 0;
} 
```

控制台这样说：

```
2012-12-13 16:22:41.319 obdlink[1940:f803] Setting up connection to https://169.254.1.10 : 23
2012-12-13 16:22:55.409 obdlink[1940:f803] Opening streams.
2012-12-13 16:23:16.504 obdlink[1940:f803] Status of outputStream: 1
2012-12-13 16:23:20.878 obdlink[1940:f803] Opening streams.
2012-12-13 16:23:33.858 obdlink[1940:f803] Status of outputStream: 2
2012-12-13 16:23:46.092 obdlink[1940:f803] Error: (null)
2012-12-13 16:23:59.011 obdlink[1940:f803] Writing out the following:
2012-12-13 16:24:01.104 obdlink[1940:f803] 0902 
```

“0902”是应该向我返回带有 VIN 的 5x5 多帧响应的命令。

我真的尝试了我能想象或在万维网上找到的一切。我卡住了，不知道进一步，我希望这里的任何人都可以帮助我。

# git - 将目录从一个 Git 存储库迁移到另一个具有所有历史记录的目录

> ID：13864002
> 
> 赞同：2
> 
> 时间：2012-12-13T16:18:47.160
> 
> 标签：git

我有一些文件存在于 Repo 1 的目录中。假设它是一个视频播放功能。与此功能相关的所有文件均未在此目录中创建。有时开发人员会意识到这种共性并将所有文件移动到一个公共位置。

现在我们有一个核心库，我们希望所有这些文件都存在于其中，以便其他项目可以重用它们。我已成功使用以下命令将文件放入另一个存储库，但在将文件从 Repo 1 移动到公共目录之前，它缺少文件的历史记录。

我如何才能做到这一点，以使文件的整个历史记录都包含在核心库中，而不管它在 Repo 1 中被 git mv'd 多少次？

```
cp -R  repo-where-feature-exists/ video-filtered-repo
cd video-filtered-branch
git remote rm origin 
git filter-branch --subdirectory-filter src/main/resources/static/video-poc/js/video/ -- --all 
rm -rf src/
mkdir -p component-library/src/main/resources/components/video
git mv -k * component-library/src/main/resources/components/video/
git commit -m "Moving files from where they were in the original location into the core location"

Now go to core…
cd /software/dp/core
git remote add video-feature /software/dp/video-filtered-repo/
git pull video-feature integration 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T10:43:53.013

请参阅[有关“将子路径拆分为新存储库”的这些 GitHub 帮助说明](https://help.github.com/articles/splitting-a-subpath-out-into-a-new-repository)。

# c# - Javascript 依赖于 ajax 结果

> ID：13864005
> 
> 赞同：0
> 
> 时间：2012-12-13T16:19:02.737
> 
> 标签：c#, javascript, ajax

我在页面上有一个日历的约会表。该表是所有尚未批准的任命。

管理员需要在安排会议之前批准会议，因此表格中有一个“批准”链接。单击“Approve”会调用一个 ajax 方法，该方法会将约会的“approved”字段设置为 true。然后 js 删除该行并重建表，这样不需要全页刷新就可以看到约会不再在表中。

我的问题是ajax方法只有在当时还没有预约的情况下才会批准预约。如果存在冲突，则约会应保持未经批准（x.approved = false）。

这很好用，但是 ajax 方法只是将 RedirectToAction 返回到带有表的页面，并且 javascript 继续删除该行。页面刷新后，该行返回，因为约会仍未获批准。

有没有办法返回一个 RedirectToAction 并返回一个布尔值？是否可以更改 javascript 变量（即 wasApproved），以便行删除 javascript 仅在（wasApproved == true）时运行？我认为现在不是使用ajax 的success 功能的合适时机，因为ajax 方法应该总是成功运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:32:46.400

尝试这样的事情：

在您的控制器上，提供 Json 结果。

```
[HttpPost]
public ActionResult Aprove(int id) 
{
    /* process database changes*/
    return Json(new { success = true}, JsonRequestBehavior.AllowGet);
} 
```

在客户端只需使用 jquery 访问并将此结果作为 json 对象读取。您可以根据需要删除该行或将重定向更改为其他 url。就像是：

```
$(document).ready(function() {  
    $("a.aprove").click(function() {
        var id = /* provide an id to pass as a parameter.. could be on the 'rel' property of a tag. */
        $.ajax({
          type: 'POST',
          url: "Controller/Aprove",
          data: { id : id },
          success: function (data) {
                if (data.success) 
                {
                                    // remove the tr row...
                    $(this).closest("tr").remove(); 
                                    // or reload the page with 
                                    // document.location.reload(true);
                }           
          },
          dataType: 'json'
        });         
    });
); 
```

# delphi - 使用 TLS 的 Indy 9 SMTP 发送导致崩溃

> ID：13864006
> 
> 赞同：2
> 
> 时间：2012-12-13T16:19:05.607
> 
> 标签：delphi, smtp, indy, ssl, indy-9

我有一个通过 gmail 发送电子邮件的奇怪问题。我正在使用 Delphi 7 和 Indy 9 在 VirtualBox (4.2) 上运行 Windows 7 Professionel 32 位

由于 Indy 9 不支持开箱即用的 TLS，我必须自己发送 STARTTLS 命令。

这适用于小型测试邮件。带有附件的普通邮件会导致 VirtualBox 完全崩溃。没有 Windows 蓝屏。

我已经找到了一种解决方法，但它似乎很脏。如果我从 Delphi 源添加 IdSSLOpenSSL.pas 并添加 Sleep(5); 到它工作的发送功能

```
function TIdSSLIOHandlerSocket.Send(var ABuf; ALen: integer): integer;
begin
  // 13.12.2012 fix timing
  Sleep(5);

  if fPassThrough then begin
    result := inherited Send(ABuf, ALen);
  end
  else begin
    result := SendEnc(ABuf, ALen);
  end;
end; 
```

**有没有更好的方法来解决这个问题？**

如果您需要代码来设置 IOHandler

```
sslIOHandler                   := TIdSSLIOHandlerSocket.Create(nil);
sslIOHandler.SSLOptions.Method := sslvTLSv1;
sslIOHandler.PassThrough       := True;
IdSSLOpenSSLHeaders.Load;
smtpClient.Username            := tbUsername.Text;
smtpClient.Password            := tbPassword.Text;
smtpClient.AuthenticationType  := atLogin;
smtpClient.IOHandler           := sslIOHandler;
smtpClient.Connect(C_TIMEOUT);
smtpClient.SendCmd('STARTTLS');
sslIOHandler.PassThrough := False;
smtpClient.Authenticate(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T13:54:08.450

由于似乎没有人对此有解决方案并且无法选择升级到 Indy 10（涉及的项目太多），我找到了一个不同的库来处理 tls 的 smtp ...

现在我使用了 Synapse，它不会干扰 Indy 9，并且符合我的预期。

[http://synapse.ararat.cz/doku.php/public:howto:smtpsend](http://synapse.ararat.cz/doku.php/public:howto:smtpsend)

希望这可以帮助其他有同样问题的人。

# vb.net - 从 VB.Net 应用程序更新/编辑记录到 Access 数据库的问题

> ID：13864007
> 
> 赞同：1
> 
> 时间：2012-12-13T16:19:13.003
> 
> 标签：vb.net, ms-access, sql-update, insert-update

嗨，我在将更正从我的 VB.Net 应用程序更新到 Access 数据库时遇到问题。我收到以下错误：

“更新语句中的语法错误”或“条件表达式中的数据不匹配错误”

下面是代码：

Public Function save1stsemester() '此代码将第一学期记录更新到数据库

```
 Dim ds As New DataSet
    Dim dbSource As String
    Dim conn As New OleDb.OleDbConnection
    Dim dbcursor As Integer = 0
    Dim da As New OleDb.OleDbDataAdapter
    Dim cmdUpdate As New OleDb.OleDbCommand

    Dim msg1 As String
    Dim style As MsgBoxStyle
    Dim result As MsgBoxResult
    Dim title, remarks As String

    Dim totalgrade As Integer = CInt(txtTotalMK.Text)
    Dim totalload As Integer = CInt(txtTotalLoad.Text)

    Dim gpadecimal As Decimal
    gpadecimal = CDec(lblGPA1.Text)

    title = "Success"
    style = MsgBoxStyle.Information

    Call allremarks() ' this function gathers all the remarks to a single variable.
    remarks = allremarks()

    Dim failflag As Boolean
    If checkflag100() = True Then 'True means all courses were passed then turn on Flag
        failflag = True
    Else
        failflag = False
    End If

    If conn.State = ConnectionState.Open Then
        GoTo cont
    Else
        If conn.State = ConnectionState.Closed Then
            dbProvider = "PROVIDER=Microsoft.Jet.OLEDB.4.0;"
            dbSource = "Data Source =C:\CGPA\e-CGPA Stat\e-CGPA Stat\bin\Debug\Scoredata.mdb;Persist Security Info=False"
            conn.ConnectionString = dbProvider & dbSource
            conn.Open()

            da.SelectCommand = New OleDb.OleDbCommand("SELECT * FROM 100Level1stSemester WHERE MatNO like '%" + cmbMATNO.Text + "%'")
            da.SelectCommand.Connection = conn

            Dim mycomand As New OleDb.OleDbCommandBuilder(da)

            da.Fill(ds, "100Level1stSemester")

cont:       If cmbCourseLevel.SelectedItem = "100 Level" Then
                '  Try
                cmdUpdate.CommandText = "UPDATE 100Level1stSemester " & _
                "SET MatNo = '" & cmbMATNO.Text & "'" & _
                ", FName = '" & cmbStatFName.Text & "'" & _
                ", MName = '" & cmbStatInitial.Text & "'" & _
                ", SName = '" & cmbStatSname.Text & "'" & _
                ", STA110 = '" & txtGR1.Text & "'" & _
                ", MTH110 = '" & txtGR2.Text & "'" & _
                ", MTH112 = '" & txtGR3.Text & "'" & _
                ", ACC111 = '" & txtGR4.Text & "'" & _
                ", GST111 = '" & txtGR5.Text & "'" & _
                ", GST112 = '" & txtGR6.Text & "'" & _
                ", GST123 = '" & txtGR7.Text & "'" & _
                ", [STA110-SCORE] = '" & txtSC1.Text & "'" & _
                ", [MTH110-SCORE] = '" & txtSC2.Text & "'" & _
                ", [MTH112-SCORE] = '" & txtSC3.Text & "'" & _
                ", [ACC111-SCORE] = '" & txtSC4.Text & "'" & _
                ", [GST111-SCORE] = '" & txtSC5.Text & "'" & _
                ", [GST112-SCORE] = '" & txtSC6.Text & "'" & _
                ", [GST123-SCORE] = '" & txtSC7.Text & "'" & _
                ", [Tot-Grade-Point] = '" & totalgrade & "'" & _
                ", [Tot-Credit-Load] = '" & totalload & "'" & _
                ", [1stSemesterGPA] = '" & gpadecimal & "'" & _
                ", Remarks = '" & remarks & "'" & _
                ", Flag = '" & failflag & "'" & _
                " WHERE MatNo = '" & cmbMATNO.Text & "'"

                cmdUpdate.CommandType = Data.CommandType.Text
                cmdUpdate.Connection = conn
                cmdUpdate.ExecuteNonQuery()
                cmdUpdate.Dispose()

                conn.Close()

                msg1 = "100 Level 1st semester exam score and grades updated successfully."

                result = MsgBox(msg1, style, title)
                cmdVerifySem1.Enabled = False
                Grp1stSEM.Enabled = True

                'Catch
                MessageBox.Show("An error occured while updating the student's 100 Level scores! Duplicate entry was detected in the database. Ensure that the student's scores has not been entered before and try again.")
                'End Try
            End If
        End If
    End If
End Function 
```

我被建议使用参数化查询，我不知道如何使用。

任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:39:54.017

`Data Mismatch`当您尝试将数字列设置为非数字值或尝试在具有不同数据类型的列上连接 2 个表时，通常会出现错误。您在此处更新而不是加入，因此请检查您构建的 SQL 语句并确保将有效值放入每一列。鉴于参考`Criteria`特别看的价值`cmbMATNO.Text`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:39:55.143

由于您是如何编写的，因此很难阅读您用于更新的命令文本。这是使用参数化查询的一个很好的理由，但并不是最好的理由。这是使用参数化查询的示例：

```
 Dim cmdText As String = "INSERT INTO Customer(Name, EmailAddress) VALUES (?,?)"
    Dim cmd As OleDbCommand = New OleDbCommand(cmdText, con)
    cmd.CommandType = CommandType.Text
    cmd.Parameters.Add("@p1", OleDbType.VarChar).Value = txtUserName.Text
    cmd.Parameters.Add("@p2", OleDbType.VarChar).Value = txtEmail.Text 
```

基本上，您使用 ? 在字符串中表示您将用变量/文本框值替换的值。然后为每个命令添加一个参数，按照它们在命令字符串中出现的顺序。这使得阅读命令字符串和验证正确的语法变得更加容易。它还可以保护您的数据库免受注入。

# bash - 如何在 Tcl 或 Expect 命令中包含双引号以用于带有空格的密码或文件名？

> ID：13864010
> 
> 赞同：3
> 
> 时间：2012-12-13T16:19:19.413
> 
> 标签：bash, tcl, whitespace, scp, double-quotes

我有两个脚本要在本地计算机 shell 中运行第一个脚本是 BASH shell，它在自身内部调用期望脚本 bash shell 如下

## BASH SHELL 脚本 SaveOnRemote.sh

```
#!/bin/bash
REMOTE_IP_ADDR="192.168.100.67"
REMOTE_PASS="some_pass_with_whitespaces"     
#The following line space is defined {\ }
PC_EXEC_FILE="/home/workspace/prog/Modified\ code/test/test_file"

#The following line space is included in the variable
TARGET_EXEC_FILE="/sd/1/test/test file target dir/target_file"

#Calling the expect script
scp_ToTarget.exp  $REMOTE_PASS $REMOTE_IP_ADDR $PC_EXEC_FILE $TARGET_EXEC_FILE 
```

## BASH 脚本 SaveOnRemote.sh 结束

还有一个我们有**scp_ToTarget.exp** Tcl 或 Expect 脚本，它在 bash shell 中被调用

## Tcl 期望 SCRIPT scp_ToTarget.exp

```
#!/usr/bin/expect -f
set remote_password [lrange $argv 0 0]     
set remote_ipaddr [lrange $argv 1 1]   
set src [lrange $argv 2 2]    
set dst [lrange $argv 3 3]     
set timeout 3    
log_user 1

eval spawn scp $src root@$remote_ipaddr:$dst    
match_max 100000

#Look for passwod prompt
set timeout 5

expect {    
  "*?assword:*" {    
  send $remote_password\r\n    
  }    
}

## End of Tcl Expect SCRIPT scp_ToTarget.exp 
```

### 此脚本不起作用，我收到未知目录/文件错误

事实上，我无法避免文件名、密码甚至目录中的空格，我必须让脚本正常工作。

据我所知，如果我发送命令

```
scp "/tmp/try me.txt" root@192.168.100.67:"/sd/no tries/" 
```

它有效，我对空白没有问题。但是一旦我在 Tcl 中并添加双引号

> "$src" 或 \"$src\" 或 "'$src'"

他们都没有完全按照我想要的方式制作语法，Tcl 将双引号更改为大括号等我陷入了这个问题，我不知道如何在**bash** 、**Expect 或 Tcl中解决这个问题**

任何用于在 Bash/Tcl 中处理不同字符串变量的好的参考或网络链接都值得赞赏谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:56:08.247

You **need** to use quotes in the shell script when you're passing the parameters:

This is bad:

```
scp_ToTarget.exp  $REMOTE_PASS $REMOTE_IP_ADDR $PC_EXEC_FILE $TARGET_EXEC_FILE 
```

This is good:

```
scp_ToTarget.exp "$REMOTE_PASS" "$REMOTE_IP_ADDR" "$PC_EXEC_FILE" "$TARGET_EXEC_FILE" 
```

Because you did not quote the variables, the shell exands them into multiple words and the Expect script receives **more** than 4 parameters

Once you quote the variables in the shell script, Expect will receive them as you have planned.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T13:02:43.193

谢谢，我已经实现如下

```
REMOTE_PASS="some_pass_with_whitespaces"
REMOTE_PASS="\"$REMOTE_PASS\""
# I have no clue if the passwords with whitespace or \ works fine for password

#The following line space is defined {\ }
PC_EXEC_FILE="/home/workspace/prog/Modified\ code/test/test_file"
eval PC_EXEC_FILE=$PC_EXEC_FILE
PC_EXEC_FILE="\"$PC_EXEC_FILE\""

#The following line space is included in the variable
TARGET_EXEC_FILE="/sd/1/test/test file target dir/target_file"
eval TARGET_EXEC_FILE=$TARGET_EXEC_FILE
TARGET_EXEC_FILE="\"$TARGET_EXEC_FILE\""

# The script is supposed to handle strings with {spc} and {\spc} used for
# directories but the filenames can not contain spaces 

#Calling the expect script
eval scp_ToTarget.exp  $REMOTE_PASS $REMOTE_IP_ADDR $PC_EXEC_FILE $TARGET_EXEC_FILE 
```

在期望文件中，我在期望{之后添加了一行

```
 "*?assword:*" {    
  send $remote_password\r\n  
  interact 
  } 
```

它解决了目录中有空格但文件名没有空格的问题！

# 我仍然对如何解决文件名中的空格感到困惑:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-04T14:57:43.483

使用这样的字符串是否可以解决问题：

```
REMOTE_PASS="\\\"$REMOTE_PASS\\\"" 
```

我认为您似乎要求的是“双重逃避”。

（我知道这是一个老问题，但我发现它用谷歌搜索，其他人也可能......他们可能会很高兴找到至少最终解决了我的问题的东西。）

# javascript - 将 Javascript 变量转换为 Coldfusion 变量

> ID：13864014
> 
> 赞同：1
> 
> 时间：2012-12-13T16:19:23.170
> 
> 标签：javascript, xml, coldfusion

嗨，我有以下代码。我想弄清楚如何获取 test_xml= xmlEditor.getXmlAsString(); 从此脚本中插入一个冷融合变量。

我试过了。

```
 <cfset myXML = qQuery[test_xml]> 
```

这不返回任何内容。这是下面的原始脚本。谁能告诉我我错过了什么。

```
 //get output xml from edited
$('#xml_output').click(function() {

        try {
            test_xml= xmlEditor.getXmlAsString();
            //file_xml= xmlEditor.W
            //test_xml1= encodeURI(test_xml).replace(/%5B/g, '[').replace(/%5D/g, ']');

            //GLR.messenger.show({msg:"Generating file...", mode:"loading"});
            //GLR.messenger.inform({msg:"File saved Successfully.", mode:"success"});
            $('.final_area').val(test_xml);
            $('.final_xml').css('display','block');

        } catch(e) {
            GLR.messenger.show({msg:"Something went wrong, Please try again later....",mode:"error"});
        }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:46:00.913

如果您试图从 javascript 中将变量返回到coldfusion，则需要研究 AJAX 之类的东西。

您可以使用类似的方法将变量发送到 cfm 页面：

```
$.post("variable.cfm" + jsvariable,function(data,status){
   alert("Data: " + data + "\nStatus: " + status);
}); 
```

这会将`jsvariable`变量发送回冷融合页面，您可以在其中返回您想要的内容，返回的内容将在`data`变量中。

# android - 当我使用“android:layout_margin”时，Android 应用程序崩溃

> ID：13864016
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:19:32.477
> 
> 标签：android, android-layout

这是我的 XML。

[http://pastebin.com/vaw7xY7t](http://pastebin.com/vaw7xY7t)

如果我删除第 18 行，它会起作用。

```
 android:layout_margin="0dp" 
```

但是如果我添加

```
 android:layout_margin="0dp" 
```

程序在启动时崩溃并给出一条消息“不幸的是......已停止工作”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:26:31.850

您没有指定的 layout_height 。将此参数添加到 wrap_content。也许 ？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T17:23:05.043

崩溃的真正原因是因为我使用字符串资源来存储维度。如果您在字符串中存储维度“10dp”，请改用“dimen”：不要像@string/blah 那样引用它，而是使用@dimen/blah。

看看这个答案：

[android eclipse在布局中使用字符串资源来获取文本大小](https://stackoverflow.com/questions/10146057/android-eclipse-using-string-resource-for-text-size-in-layouts)

# sql - SQLAlchemy 别名混淆

> ID：13864017
> 
> 赞同：5
> 
> 时间：2012-12-13T16:19:33.747
> 
> 标签：sql, sqlalchemy, alias, self-join

我对 SQLAlchemy 和别名有疑问。我正在尝试对一个名为 Task 的表进行自联接，但 SQLAlchemy 将我的别名表与非别名表混淆了。

我的查询要复杂得多，但这是一个简化版本：

```
baseTask = aliased(model.Task)

query = model.session.query(model.Task.name)\
       .select_from(baseTask)\
       .join((model.Task, model.Task.taskid==baseTask.taskid))

The resulting query looks like this:    
SELECT task_1.name 
FROM task AS task_1 INNER JOIN task ON task_1.taskid = task_1.taskid 
```

正如您所看到的，它在选择和连接条件中都将未别名表与别名 task_1 混淆了。

通过在两个表上使用别名，它可以工作：

```
baseTask = aliased(model.Task)
task = aliased(model.Task)

query = model.session.query(task.name)\
        .select_from(baseTask)\
        .join((task, task.taskid==baseTask.taskid))

This gives the desired result:
SELECT task_1.name 
FROM task AS task_2 INNER JOIN task AS task_1 ON task_1.taskid = task_2.taskid 
```

当我在两个表上使用别名时，它不会混淆它们，并且结果查询正是我想要的。问题是由于各种原因我不能在我加入的表上使用别名，这是由于动态生成查询的应用程序设计。

我正在使用 SQLAlchemy 0.6.8，我尝试升级到 0.7.9，但我仍然遇到这个问题。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T23:18:08.370

不幸的是，select_from() 现在所做的两件特定事情之间有一些功能重叠，其中一件是你可以说`query(Task).select_from(<some SELECT statement>)`，它会根据 重新定位“任务”，`<some SELECT statement>`另一件是你可以说它首先从哪里加入。

[添加了http://www.sqlalchemy.org/trac/ticket/2635](http://www.sqlalchemy.org/trac/ticket/2635)，也许在 0.8 中我们可以让它在这种特定情况下做出更好的决策。

**更新**：感谢您对此的报告，我过去在自己的工作中也遇到过，但没能深入了解，这很简单。如果您现在想使用 0.8 提示，您的用例应该可以工作。

这是修复的一些背景：[http ://docs.sqlalchemy.org/en/latest/changelog/changelog_08.html#change-8d958f76ee47f715536​​5772401087d1f](http://docs.sqlalchemy.org/en/latest/changelog/changelog_08.html#change-8d958f76ee47f7155365772401087d1f)

**潜在的 0.6.8 解决方法**：

```
query = session.query(Task.name)

query._from_obj += (baseTask._AliasedClass__alias, )

query = query.join((Task, Task.taskid == baseTask.taskid)) 
```

# java - 对日期/时间对象进行排序（最新的优先）

> ID：13864018
> 
> 赞同：3
> 
> 时间：2012-12-13T16:19:34.240
> 
> 标签：java, datetime

我正在尝试使用下面的代码按日期/时间（最新的优先）订购日期对象。顺序不正确。我认为该`compareTo`方法需要以不同的方式实现以实现所需的排序？

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class DateSorter {

    public static void main(String args[]){

        List<DateObject> list = new ArrayList<DateObject>();

        DateObject d1 = new DateObject("2012-12-05" , "11:21:19");
        list.add(d1);

        d1 = new DateObject("2012-12-05" , "11:20:19");
        list.add(d1);

        d1 = new DateObject("2012-12-05" , "11:20:19");
        list.add(d1);

        d1 = new DateObject("2012-12-04" , "10:20:19");
        list.add(d1);

        d1 = new DateObject("2010-12-07" , "13:20:19");
        list.add(d1);

        d1 = new DateObject("2012-12-05" , "11:20:19");
        list.add(d1);

        Collections.sort(list);

        for(DateObject d : list){
            System.out.println(d);
        }
    }

}

import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class DateObject implements Comparable<Object> {

    private String date;
    private String time;

    public DateObject(String date, String time) {
        this.date = date;
        this.time = time;
    }

    public int compareTo(Object o) {

        DateFormat formatter;
        Date date1 = null;
        Date date2 = null;
        formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        try {
            date1 = (Date) formatter.parse(this.date + " " + this.time);
            date2 = (Date) formatter.parse(this.date + " " + this.time);
        } catch (ParseException e) {
            e.printStackTrace();
        }
        catch(NullPointerException npe){
            System.out.println("Exception thrown "+npe.getMessage()+" date1 is "+date1+" date2 is "+date2);
        }

         return date1.compareTo(date2);

    }

    @Override
    public String toString(){       
        return this.date+" "+this.time;
    }

} 
```

这是显示的输出：

```
2012-12-05 11:21:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-04 10:20:19
2010-12-07 13:20:19
2012-12-05 11:20:19 
```

这个输出应该是：

```
2010-12-07 13:20:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-05 11:21:19
2012-12-04 10:20:19 
```

更新：当我将 compareTo 方法修改为：

```
public int compareTo(Object o) {

    DateFormat formatter;
    Date date1 = null;
    Date date2 = null;  
    DateObject other = (DateObject) o;

    formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    try {
        date1 = (Date) formatter.parse(this.date + " " + this.time);
        date2 = (Date) formatter.parse(other.date + " " + other.time);
    } catch (ParseException e) {
        e.printStackTrace();
    }
    catch(NullPointerException npe){
        System.out.println("Exception thrown "+npe.getMessage()+" date1 is "+date1+" date2 is "+date2);
    }

     return date1.compareTo(date2);

} 
```

输出是：

```
2010-12-07 13:20:19
2012-12-04 10:20:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-05 11:21:19 
```

这仍然不正确，因为 2012-12-05 应该出现在 2012-12-04 之前

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:22:37.627

您正在解析相同的日期两次：

```
date1 = (Date) formatter.parse(this.date + " " + this.time);
date2 = (Date) formatter.parse(this.date + " " + this.time); 
```

应该是：

```
date1 = (Date) formatter.parse(this.date + " " + this.time);
DateObject other = (DateObject) o;
date2 = (Date) formatter.parse(other.date + " " + other.time); 
```

在尝试强制转换和使用它之前，您可能应该测试 o 是 DateObject 而不是 null 。

**编辑**

刚刚尝试使用您更新的代码`return date2.compareTo(date1);`，我得到：

```
2012-12-05 11:21:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-05 11:20:19
2012-12-04 10:20:19
2010-12-07 13:20:19 
```

这是按降序排列的（请注意，最后一个日期是 2010 年）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:23:33.233

您正在将日期与自身进行比较，而不是传入的对象

```
 date1 = (Date) formatter.parse(this.date + " " + this.time);
 date2 = (Date) formatter.parse(this.date + " " + this.time); 
```

用在哪里`o`？

顺便说一句，它给了你什么`DateObject`？它看起来像一个`Date`物体。请注意，它`java.util.Date`包含日期*和*时间信息，令人困惑。如果您使用标准日期对象，则不必编写比较器。更好的是，您可以研究[Joda-Time](http://joda-time.sourceforge.net/)，它具有更好、更直观和线程安全的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:24:43.093

我认为错误是：

```
 date2 = (Date) formatter.parse(this.date + " " + this.time); 
```

应该

```
 date2 = (Date) formatter.parse(((DateObject)o).date + " " + ((DateObject)o).time); 
```

你也可以这样做来摆脱演员表：

```
public class DateObject implements Comparable<DateObject> {
...
public int compareTo(DateObject o) {
    date2 = (Date) formatter.parse(o.date + " " + (o.time); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:28:58.590

你应该这样做：

```
DateObject other = (DateObject) o;

date1 = (Date) formatter.parse(this.date + " " + this.time);
date2 = (Date) formatter.parse(other.date + " " + other.time);

date2.compareTo(date1); 
```

注意最后一行。你说你希望最新的成为第一个。在这种情况下，您应该将 date2 与 date1 进行比较，反之亦然，因为 date1.compareTo(date2) 将按升序排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T16:29:43.880

DateObject 应该实现 Comparable。在您的 compareTo 方法中， date2 需要从传递给该方法的对象派生。

# sql - 从另一个表中搜索带有附加数据集的行中的重复项

> ID：13864020
> 
> 赞同：3
> 
> 时间：2012-12-13T16:19:52.320
> 
> 标签：sql, tsql, duplicate-removal

我需要从表中删除重复记录。语法：T-SQL (MS SQL Server)

它有两个困难：

1.  有些字段包含不应影响行比较的数据
2.  有一个附加表与第一个具有“一对多”关系的表链接

例子：

```
Table A                 Table B
--------------          --------------
AId - int       <-\     BId - int
A1 - int           \->  AId - int
A2 - varchar            B6 - varchar
A3 - varchar            B7 - varchar
A4 - varchar            B8 - varchar
A5 - int                B9 - int 
```

因此，表 A 中的任何记录都包含字段 AId、A1、A2、A3、A4 和 A5，以及“子记录”列表：表 B 中 B.AId 与 A.AId 匹配的记录列表。例如，它可以是采购交易列表，其中表 A 包含交易的属性，例如日期/时间或客户 ID，而表 B 可以表示商品及其价格和金额的列表。

一旦一些记录被复制。它们有不同的 AId、不同的 BId、不同的 A4、A5、B8 和 B9。所有其他字段应匹配以使两条记录重复。

因此，如果满足以下条件，则 A 中的两条记录 X 和 Y 被认为是重复的：

*   X.A1 == Y.A1
*   X.A2 == Y.A2
*   表 B 中 AId == X.AId 的所有记录与 B 中 AID == Y.AId 的所有记录完全匹配，但不包括（忽略）B8 和 B9 字段

我至少需要获取此类重复记录的 AID，最多删除这些重复记录但只留下一份记录副本（不管是哪一份）。

请告诉我是否需要以下说明。先感谢您。

*更新：* SQL 小提琴：[http ://sqlfiddle.com/#!3/898c8/1](http://sqlfiddle.com/#!3/898c8/1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:50:55.227

```
Select a1, Count(CompareField) From (Select a.a1 as a1, a.a1 + a.a2 +  a.a3 + b.b6 + b.b7 as compareField from A inner join b on a.AID = b.AID) z Group by z.comparefield 
```

这将为您提供所有重复项的列表，然后您可以使用外部查询删除记录 Delete From a Where AID in (prevquery)

可能不需要说明，但请确保在运行删除查询之前备份数据库。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T09:50:35.127

诀窍是将表 B 中的多行连接到单个字符串。

对于 SQL 服务器，您可以滥用 XML 功能（如果值中有特殊字符可能会出现问题 - 其他有内置函数，如 Sybase 中的 LIST()，它返回一个逗号分隔的列表）：

```
SELECT AID, A1, A2, A3, (
  SELECT B6, B7
  FROM B
  WHERE AID=A.AID
  ORDER BY B6, B7
  FOR XML RAW
) XML
FROM A 
```

[http://sqlfiddle.com/#!3/898c8/29/0](http://sqlfiddle.com/#!3/898c8/29/0)

现在你有一个平面表，很容易找到和删除重复项（留给读者练习）......

# java - Eclipse 导入项目不正确

> ID：13864023
> 
> 赞同：0
> 
> 时间：2012-12-13T16:20:00.893
> 
> 标签：java, android, eclipse, git

我正在尝试导入一个最初是 Git 存储库的项目。我运行`git clone`命令将代码下拉到工作区。现在，当我右键单击-> 导入现有的 android 项目并导入项目时，eclipse 导入它而不显示任何错误。然而，当它导入它时，所有的类都被移动到一个类目录（而不是 src），并且 src 中没有包。当我进入类目录并选择一个类时，它会打开类文件编辑器并读取“找不到源”。

**一些额外的细节**： classes 目录是编译的 java 字节码。但是，如果我手动导航到我的工作区并使用文本编辑器打开 .java 文件，源代码就直接在那里。事实上，classes 目录并不存在，一切都在工作空间中正常组织。但是它的**eclipse**在导入时编译和创建类目录。

我已经搜索过，但找不到任何类似的东西，尽管我觉得以前有人会遇到过这种情况。

如何正确导入项目？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:29:08.590

不要使用导入现有的 android 项目，而是使用 import 'existing projects into workspace' 选项。换句话说，使用不说“android”的一般导入。

# java - 我想听听 JtextField 的变化

> ID：13864037
> 
> 赞同：0
> 
> 时间：2012-12-13T16:21:07.607
> 
> 标签：java, swing, jtextfield

我真的不想听 DocumentListener。它对我来说产生了太多的事件。只有当焦点从这个特定的 JtextField 移开时，我才有兴趣听。添加 ActionListener 将仅在按下返回键时生成事件。当用户使用制表键或鼠标移开时，我想得到它。这可能吗？谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:31:06.547

使用焦点监听器。当用户移动到其他一些领域时，focusLost 将为您提供帮助。

```
 JTextField jf = new JTextField();
        jf.addFocusListener(new FocusListener() {

            @Override
            public void focusLost(FocusEvent arg0) {
                // here you can have your code when user moves out
            }

            @Override
            public void focusGained(FocusEvent arg0) {
                // TODO Auto-generated method stub

            }
        } ); 
```

# sql - 表的语言翻译

> ID：13864040
> 
> 赞同：5
> 
> 时间：2012-12-13T16:21:09.153
> 
> 标签：sql, sql-server, sql-server-2008

我知道大多数人使用下面的方法并为需要翻译的特定表创建一个翻译表，但这可能相当于一大堆表。

```
CREATE TABLE Product
(
     Product_id
    ,ProductTrans_id -- FK
)

CREATE TABLE ProductTranslation
(
     ProductTrans_id
    ,Product_id
    ,Name
    ,Descr
    ,lang_code
) 
```

下面的方法可行吗？假设您有很多表需要翻译超过 1 列。您可以执行以下操作并将所有翻译保存在 1 个表中吗？我想随着时间的推移，这张桌子的大小会大大增加。

```
 CREATE TABLE translation_entry (
          translation_id        int,
          language_id           int,
          table_name            nvarchar(200),
          table_column_name     nvarchar(200),
          table_row_id          bigint,
          translated_text       ntext
        )

    CREATE TABLE translation_language (
          id int,
          language_code CHAR(2)
        ) 
```

所以使用第二种方法你会得到这样的文本

```
select 
     product.name 
    ,translation_entry.translated_text
from product
inner join  translation_entry on product.product_id = translation_entry.table_row_id 
and translation_entry.table_name = 'Product' and translation_entry.table_column_name = 'Name'
and language_id = 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T23:03:45.213

我不确定您为什么担心表的数量：拥有更少的表并不意味着您的数据库更小、更高效或设计更好。特别是如果减少表的数量会增加查询的复杂性，我会非常小心地这样做。

无论如何，我会为每个“基本”表选择一个翻译表。主要原因是您的第二个解决方案不灵活：如果主键不是单个整数，那么实现和使用将变得极其困难。查询翻译也更复杂，并且根据表和数据的大小，可能难以有效地对其进行索引。

目前尚不清楚为什么您`TranslationID`的`Products`桌子上有一个；通常这种关系是相反的：

```
create table dbo.Products (
    ProductCode char(10) not null primary key,
    ProductName nvarchar(50) not null,
    ProductDescription nvarchar(100) not null,
    -- other columns
)

create table dbo.ProductsTranslations (
    ProductCode char(10) not null,
    LanguageCode char(2) not null,
    ProductName nvarchar(50) not null,
    ProductDescription nvarchar(100) not null,
    -- other translations
    constraint FK1 foreign key (ProductCode)
        references dbo.Products (ProductCode),
    constraint FK2 foreign key (LanguageCode)
        references dbo.Languages (LanguageCode),
    constraint PK primary key (ProductCode, LanguageCode)
) 
```

根据您的工具集和部署过程，您可能希望直接从基本表生成翻译表，作为数据库构建的一部分。您可以使用视图来提供一个方便的、“完全翻译”的基表版本。

一个有趣的问题是，其中的列使用什么语言`Products`以及在不需要翻译时是否可以直接使用它们。我的建议是所有生产代码都应该传递一个语言参数并仅从`ProductsTranslations`表中获取文本，即使是英语（或任何您的内部公司语言）。这样您就可以确保在同一个表中找到所有“官方”名称，并且基表上的列是为了数据模型的清晰和完整性以及开发人员的方便和（可能）在临时内部使用报告等。

# css - 内联文本输入扩展包含段落

> ID：13864043
> 
> 赞同：0
> 
> 时间：2012-12-13T16:21:17.460
> 
> 标签：css

我在一段文本中使用内联文本输入。字体大小和行高设置正确，但与其他内联元素的行为（例如跨度）不同，段落会扩展以适应文本输入的高度。

问题是我有两行并排放置，需要垂直对齐，一条包含文本输入，另一条没有。因为段落结果是不同的高度，所以准确定位它们是一个问题，因为间距是在段落的边缘而不是内部内联元素上完成的。我可以计算出差异并相应地对齐，但这似乎肯定会跨浏览器失败。

根本原因似乎是因为我将段落的行高设置为 0.99em，从而使段落的高度小于其中的元素。不幸的是，这是一个要求。我在 Chrome 中看到了这个问题。我还没有在其他地方测试过。

看看这个小提琴，看看我的意思：

[http://jsfiddle.net/MBePU/7/](http://jsfiddle.net/MBePU/7/)

跨度具有绿色背景，段落具有红色背景，包含 div 具有灰色背景。您可以看到第二段获得了额外的间距（在这种情况下为 7px）

此处包含 SO 的代码：HTML：

```
<div><p><span>Hello</span></p></div>
<div><p><span>Hello</span> <input type="text" value="input"></p></div> 
```

CSS：

```
body {
    font-size:62.5%;
    font-family:Georgia;
}
div {
    padding:7px 0;
    margin-bottom:20px;
    background:#999;
}
p {
    background:#f00;
    font-size:8.8em;
    line-height:0.99;
}
span {
    background:#0f0;
}
input {
    font-family:Georgia;
    font-size:1em;
    border:0;
    background:#fff;
    margin:0;
    padding:0;
    width:215px;
} 
```

# ruby-on-rails - 让 ActiveRecord 从它已经缓存的内容中查询

> ID：13864045
> 
> 赞同：0
> 
> 时间：2012-12-13T16:21:29.753
> 
> 标签：ruby-on-rails, caching, activerecord

我经常遇到这种情况。

```
post_comments = post.comments
#grabs maybe 3 records out of thousands in the table
do_something_with post_comments

#...later in the same request...

subset_of_comments = post_comments.where(:awesome=>true)
#hits the database again :-(
do_something_else subset_of_comments 
```

我意识到数据库非常擅长查找记录，但我不知道返回完整表并查看数千条记录比搜索已为 1 缓存的此帖子所附的一小部分记录更好或者两个我需要。

如果我想提高这个过程的效率，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:27:34.207

是的。首次加载 AR:Relation 后，所有记录都已缓存。但是，如果您传递另一个请求`.where()`或其他请求，它会再次拉取查询。如果你想在缓存的记录中搜索，不要发送`.where`，只用**数组方法**操作。

```
# second 'request':
subset_of_comments = post_comments.map {|comment| comment if comment.awesome == true}.compact 
```

数组方法： `.find`- 对于第一个匹配的记录。`.map`或`.collect`- 用于收集

您的评论对象必须有“很棒”的公共读者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:44:55.993

您可以使用选择方法：

```
subset_of_comments = post_comments.where(:awesome=>true)
# becomes
subset_of_comments = post_comments.select{ |pc| pc.awesome == true } 
```

[文档数组（Ruby 1.9.3），`#select`方法](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-select)

# php - 如何在没有令牌的情况下执行此操作

> ID：13864055
> 
> 赞同：0
> 
> 时间：2012-12-13T16:22:00.483
> 
> 标签：php, facebook, json, facebook-graph-api

**没有身份验证令牌的 Facebook 提要**

```
$pageID = "ID of Page"
    $url = "https://graph.facebook.com/". $pageID ."/feed";
    $json = file_get_contents($url);
    $jsonData = json_decode($json);

    foreach($jsonData->data as $val) {
        if($val->from->id == $pageID) { //find the first matching post/status by a fan page admin
            $message = $val->message;
            echo $message;
            break; //stop looping on most recent status posted by page admin
        }
    } 
```

当我在谷歌上搜索时，我发现了这个代码。但是我按照他们在帖子中指出的那样做了，但现在它不起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:11:01.290

这是不可能的。看一下这个。

这个请求：[https ://graph.facebook.com/cocacola/feed](https://graph.facebook.com/cocacola/feed)

返回此响应：

```
{
   "error": {
      "message": "An access token is required to request this resource.",
      "type": "OAuthException",
      "code": 104
   }
} 
```

Facebook 可能会请求一个 access_token，以便他们可以对该调用进行速率限制。它不需要是用户`access_token`，至少是应用访问级别`access_token`。在此处阅读差异：[https ://developers.facebook.com/docs/concepts/login/access-tokens-and-types/](https://developers.facebook.com/docs/concepts/login/access-tokens-and-types/)

# javascript - 使用正则表达式确保“&”后有空格？

> ID：13864056
> 
> 赞同：0
> 
> 时间：2012-12-13T16:22:01.433
> 
> 标签：javascript, jquery, regex

我试图想出最好的方法来检测用户是否在文本字段中输入了一个“&”，并确保它后面有一个空格。

例如，如果用户输入：

```
 Apples & Oranges 
```

一切正常。但是，如果他们输入：

```
 Apples &Oranges 
```

他们收到警报。或者如果他们有：

```
 Apples&Oranges 
```

一样。

确保用户输入“&”后有空格的最佳方法是什么？

这是我到目前为止的代码：

```
 function entityKiller() {
var good = true;

 $('input[type=text]:visible').each( function() {
        if(/----Regex Here-----/.test($(this).val())) {
            good = false;
            return;
        }
});

return good; 
```

}

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:24:07.000

您可以尝试查找`&`后跟非空格字符。如果然后反转 的输出`test`：

```
if(!(/&\S/.test($(this).val()))) {
    ...
} 
```

如果你的模式以 结尾`&`怎么办？在这种情况下， 之后没有空格`&`。但是，我上面的例子会认为它是有效的。如果不应该，那么您需要找到一个`&`后面没有空格的（而不是后面跟着非空格的）：

```
if(!(/&(?!\s)/.test($(this).val()))) {
    ...
} 
```

丑，丑，多重否定。

**编辑：**

正如 Anton 指出的那样，这假设您希望在`&`. 如果您真的只想要空格字符，则模式变为：

```
/&[^ ]/ 
```

和

```
/&(?![ ])/ 
```

**编辑2：**

顺便说一句，如果您真的想避免使用否定逻辑，则必须检查`&`字符串中的 each 后面是否有一个空格。就是这个模式：

```
/^[^&]*(?:&[ ][^&]*)$/ 
```

锚点在哪里，`^`并`$`确保整个字符串与模式匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:25:21.007

试试这个正则表达式 & 后面不是空格

```
/&[^\s]/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:25:39.597

如果没有 an`&`或有*an `&`，则后面跟着 [space]* return `"success"`。

```
if( $(this).val().match(/(&\s)?/g) ) { /* ok */ } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:27:22.443

我认为最好的方法是检查是否有没有空格的＆符号，并在提交数据时自动添加。在我看来，向用户发出这样的警告有点麻烦。

无论哪种方式，使用此 RegEx 来匹配与符号后面或前面不是空格的字符的实例：

```
/(&[^ ]+)|([^ ]+&)/ 
```

您可以处理代码以从此处添加空间。

注意：我没有使用**\s**，因为它也匹配空格、制表符和换行符，并且在您的问题中，您只要求空格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T16:33:40.703

```
[a-zA-Z]*\\s&\\s[A-Za-z]*
    |      |        |
  anytext  |        |
           |        anytext
          Space 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T16:35:10.227

这个怎么样：

```
/&[^\w]/ 
```

它将允许 & 后跟任何空白字符。如果您需要，将 \w 替换为空格。在这里测试它：http: [//jsfiddle.net/X7c6T/](http://jsfiddle.net/X7c6T/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-13T16:51:05.413

你可以试试这个：http: **[//jsfiddle.net/L2yr2/](http://jsfiddle.net/L2yr2/)**

```
$('input[type="text"]').keydown(function() {
    var regex = /[^a-z*]+&+[ ]+[a-z*]/;
    if (regex.test($('input[type="text"]').val())) {
       $('span').text('good match');
    } else {
       $('span').text('not matched');
    }
}); 
```

# actionscript-3 - 如何在富可编辑文本输入中显示非常大的文本

> ID：13864064
> 
> 赞同：0
> 
> 时间：2012-12-13T16:22:34.163
> 
> 标签：actionscript-3, apache-flex, flex4, flex3

我无法在 flex 4 的富可编辑文本输入控件中显示大文本。下面是代码

```
 <?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" width="500" height="600">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <s:Scroller height="100%" width="100%">
    <s:Group height="100%" width="100%">

    <s:RichEditableText editable="false" text="75491302459 75491301083 75491311425 75491301095 75491300318 79004500202 09689827513 09689890273 09736156223 09689835913 09689829263 08539378773 04339607323 79004500205 08539244963 79004500204 79004500207 79004500208 09736155880 79405180133 09736337123 09736016920 79004500209 09736339363 09736337723 09736334300 04339674653 09736155680 09736156270 09736155783 09736062540 04339605870 09736339360 09736156600 09736320543 01223612441 01223612032 08539122223 02761654083 08539132283 01256957003 01476412543 02761685241 08539119513 79404362053 04598602070 04598602079 08539210793 04339600637 04339602221 04598624138 04598624108 04598624100 04598624103 04598624148 04598222222 04598624144 04339600671 04339606169 04339606520 04339607951 04339608142 04339609623 04339609671 04339605471 79004500222 79404367333 79404340363 08539144793 79004500223 08539173713 09736154463 04339607628 04339608284 04339608285 04339610096 08539210693 79004500225 79004500226 79404356453 79404356533 79404355483 04339601032 04339607682 04339607683 04339608575 04339608576 08539218513 04339602270 79404340103 79404343103 08539172473 09736871858 79404354513 79404368423 08539226243 04339612223 08539233013 79004500227 04598602518 04598602521 04598602529 04339605125 04339601788 75491300237 08539126143 75491300697 79404362103 04598624132 09689849593 08539342153 79404346873 02454303425 02454304708 02454305759 04339602945 04339609596 04339609744 04339682593 08539212503 09689836553 09736332510 09736334813 09736340723 09736874773 66706860263 66706899713 66706899753 66706899773 66706899793 67814901483 67814906653 67814931073 79404346383 04339602129 08539210823 04339601058 04339609621 04339608145 04339602148 04339651223 02454305755 79404346433 04339687030 09689848303 79004500206 04339603765 04339607051 04339609443 04339690313 04339694473 04339677923 04339662020 04339683343 04339691973 04339694393 04339660498 04339660237 04598602017 76218881272 75491300157 05393925653 08539141913 02761688731 09736886333 08539275723 07464559143 07464543283 07464559263 09736344573 02761688213 04598602085 04598602257 08539001784 08539178453 08539161083 01871374742 02761651223 08539246563 04598624116 04598608964 02761685244 09736153783 02761669653 01256969580 09736081363 04598624216 02761688430 09736874443 09736874673 09736879053 09736879583 09736879593 02761651373 70440002523 70440003123 70440003183 70440003203 70440003743 70440002703 70440002843 70440002903 04339609673 02848511541 09689601373 08539153723 08539159233 08539153003 09736879293 09736879783 08539153863 02761662283 09736014543 01476412143 09736344073 04598625701 04598625703 04598625702 09736015393 09736018233 09689812283 08539178043 09736877883 09736084593 02761687393 04339608607 04339608606 08539397443 08539348743 08539236633 09736341463 01256971599 02454302852 04339602152 09736156733 09736871623 02635921643 02635921633 09736016433 08539172013 09736330473 04598625704 04598625705 09736332433 09736875333 09736875343 01476412593 01476411933 09689897613 08539313393 09736156513 04598624163 70772955023 70772910116 09736340763 09736343493 02761661373 79404343093 79404343523 79404343493 08539309223 04598624212 01256959324 02454302939 09689847603 08539373073 00968983591 08539389473 09736014673 08539214153 09689849583 09736053823 09736053743 09736019493 08539212513 01256969983 01476414243 09736330553 02635913923 08539166893 09736331313 09736332443 08536518693 08536518843 09736877523 09736874453 09736845473 02454312130 09736341813 01476418793 01476423753 01476418783 01476413783 01476414793 01476418033 01476423743 01256944643 01476417453 01476417463 01476411983 01476419313 01476421503 01476417593 01476421563 01476423803 01476423903 01476420623 01476414863 01476412553 01476421683 08539238793 01476414873 01476419343 02761673033 02761677463 01256959335 09736045203 04339603415 02761661563 09736860163 09736860153 09736025143 09736879543 09736879553 97368601536 97368601635 03150401180 09736088581 09736041933 09736337223 01223273873 08539184363 09736065243 08539232493 02761665453 02761675863 09689897623 04598624210 02761677263 08536518453 01256957763 01256957563 09736061903 02761674093 09736880243 04339606814 08539186183 02761690110 09689812893 04598602530 00853003170 09736342303 70440005653 02635917243 04339621670 04598624211 09689867403 09736341263 01476423853 76218812720 01223614244 02454301469 02454304705 02454310674 02454312129 02454313000 02454312995 02454316035 02454316143 02454317638 02454320012 02454320022 02454320031 02454322206 02761690372 03242900577 08539151833 08539160543 08539164023 08539185343 08539189563 08539234823 08539275803 08539283853 08539284133 08539389413 09736050583 09736053820 09736055313 09736804013 09736837413 09736838743 09736860150 09736860180 09736860183 09736874430 09736874670 09736875633 09736877363 09736877393 09736877403 09736877413 09736877533 09736879103 09736879143 09736879243 09736879283 09736879673 09736879753 09736880173 09736880973 09736880983 09736880993 09736881883 09736881893 09736886233 09736886303 09736886483 09736886493 09736886503 09736886643 09736886653 09736886683 09736886353 09736887333 09736887553 09736889023 09736889443 09736889683 09736889883 09736889913 66706890213 67814908723 67814916803 79404354033 79404356253 79404363183 79404368293 79404368323 79405484213 79405485063 84188705022 84188705026 84188705028 84188705092 84188705116 84188705159 84188705191 09689824183 09736325833 09689817443 02454313318 08539220823 08539232993 08539233113 08539240503 08539313503 08539389533 09689610353 09689800763 09736053262 01223612988 01256959762 01223616239 79404310097 79404340353 79404362343 08539397433 08539276663 09736877383 08536518683 01256945863 04339608435 01223613350 01223613787 01256970355 01476414533 02454316125 02454319863 07464495983 07464540473 07464540493 07464543703 08536518673 08539224403 08539240963 08539247453 08539339853 08539365193 08539374243 79404345903 01223613093 01256959332 01476418433 02454312312 02454317538 03139811805 07464512293 07464553263 08536518623 08536519043 08539139253 08539149803 08539189553 08539224253 08539245933 08539284513 09689619963 09736837183 09736877443 09736877583 09736877893 70440007225 79404348833 08539232393 08539278783 09736877733 79404365033 09736871843 02635919933 04339603892 09689816083 02454311602 79404354153 79404363173 04339608077 79404357233 79404369273 79404354023 79404354853 04339605696 09736155883 02761681033 79404347153 79404347543 04339682653 79404345773 04339682433 04339621703 04339621693 08539129923 75491301083 75491311425 75491301095 75491300318 79004500202 09689827513 09689890273 09736156223 09689835913 09689829263 08539378773 04339607323 79004500205 08539244963 79004500204 79004500207 79004500208 09736155880 79405180133 09736337123 09736016920 79004500209 09736339363 09736337723 09736334300 04339674653 09736155680 09736156270 09736155783 09736062540 04339605870 09736339360 09736156600 09736320543 01223612441 01223612032 08539122223 02761654083 08539132283 01256957003 01476412543 02761685241 08539119513 79404362053 04598602070 04598602079 08539210793 04339600637 04339602221 04598624138 04598624108 04598624100 04598624103 04598624148 04598222222 04598624144 04339600671 04339606169 04339606520 04339607951 04339608142 04339609623 04339609671 04339605471 79004500222 79404367333 79404340363 08539144793 79004500223 08539173713 09736154463 04339607628 04339608284 04339608285 04339610096 08539210693 79004500225 79004500226 79404356453 79404356533 79404355483 04339601032 04339607682 04339607683 04339608575 04339608576 08539218513 04339602270 79404340103 79404343103 08539172473 09736871858 79404354513 79404368423 08539226243 04339612223 08539233013 79004500227 04598602518 04598602521 04598602529 04339605125 04339601788 75491300237 08539126143 75491300697 79404362103 04598624132 09689849593 08539342153 79404346873 02454303425 02454304708 02454305759 04339602945 04339609596 04339609744 04339682593 08539212503 09689836553 09736332510 09736334813 09736340723 09736874773 66706860263 66706899713 66706899753 66706899773 66706899793 67814901483 67814906653 67814931073 79404346383 04339602129 08539210823 04339601058 04339609621 04339608145 04339602148 04339651223 02454305755 79404346433 04339687030 09689848303 79004500206 04339603765 04339607051 04339609443 04339690313 04339694473 04339677923 04339662020 04339683343 04339691973 04339694393 04339660498 04339660237 04598602017 76218881272 75491300157 05393925653 08539141913 02761688731 09736886333 08539275723 07464559143 07464543283 07464559263 09736344573 02761688213 04598602085 04598602257 08539001784 08539178453 08539161083 01871374742 02761651223 08539246563 04598624116 04598608964 02761685244 09736153783 02761669653 01256969580 09736081363 04598624216 02761688430 09736874443 09736874673 09736879053 09736879583 09736879593 02761651373 70440002523 70440003123 70440003183 70440003203 70440003743 70440002703 70440002843 70440002903 04339609673 02848511541 09689601373 08539153723 08539159233 08539153003 09736879293 09736879783 08539153863 02761662283 09736014543 01476412143 09736344073 04598625701 04598625703 04598625702 09736015393 09736018233 09689812283 08539178043 09736877883 09736084593 02761687393 04339608607 04339608606 08539397443 08539348743 08539236633 09736341463 01256971599 02454302852 04339602152 09736156733 09736871623 02635921643 02635921633 09736016433 08539172013 09736330473 04598625704 04598625705 09736332433 09736875333 09736875343 01476412593 01476411933 09689897613 08539313393 09736156513 04598624163 70772955023 70772910116 09736340763 09736343493 02761661373 79404343093 79404343523 79404343493 08539309223 04598624212 01256959324 02454302939 09689847603 08539373073 00968983591 08539389473 09736014673 08539214153 09689849583 09736053823 09736053743 09736019493 08539212513 01256969983 01476414243 09736330553 02635913923 08539166893 09736331313 09736332443 08536518693 08536518843 09736877523 09736874453 09736845473 02454312130 09736341813 01476418793 01476423753 01476418783 01476413783 01476414793 01476418033 01476423743 01256944643 01476417453 01476417463 01476411983 01476419313 01476421503 01476417593 01476421563 01476423803 01476423903 01476420623 01476414863 01476412553 01476421683 08539238793 01476414873 01476419343 02761673033 02761677463 01256959335 09736045203 04339603415 02761661563 09736860163 09736860153 09736025143 09736879543 09736879553 97368601536 97368601635 03150401180 09736088581 09736041933 09736337223 01223273873 08539184363 09736065243 08539232493 02761665453 02761675863 09689897623 04598624210 02761677263 08536518453 01256957763 01256957563 09736061903 02761674093 09736880243 04339606814 08539186183 02761690110 09689812893 04598602530 00853003170 09736342303 70440005653 02635917243 04339621670 04598624211 09689867403 09736341263 01476423853 76218812720 01223614244 02454301469 02454304705 02454310674 02454312129 02454313000 02454312995 02454316035 02454316143 02454317638 02454320012 02454320022 02454320031 02454322206 02761690372 03242900577 08539151833 08539160543 08539164023 08539185343 08539189563 08539234823 08539275803 08539283853 08539284133 08539389413 09736050583 09736053820 09736055313 09736804013 09736837413 09736838743 09736860150 09736860180 09736860183 09736874430 09736874670 09736875633 09736877363 09736877393 09736877403 09736877413 09736877533 09736879103 09736879143 09736879243 09736879283 09736879673 09736879753 09736880173 09736880973 09736880983 09736880993 09736881883 09736881893 09736886233 09736886303 09736886483 09736886493 09736886503 09736886643 09736886653 09736886683 09736886353 09736887333 09736887553 09736889023 09736889443 09736889683 09736889883 09736889913 66706890213 67814908723 67814916803 79404354033 79404356253 79404363183 79404368293 79404368323 79405484213 79405485063 84188705022 84188705026 84188705028 84188705092 84188705116 84188705159 84188705191 09689824183 09736325833 09689817443 02454313318 08539220823 08539232993 08539233113 08539240503 08539313503 08539389533 09689610353 09689800763 09736053262 01223612988 01256959762 01223616239 79404310097 79404340353 79404362343 08539397433 08539276663 09736877383 08536518683 01256945863 04339608435 01223613350 01223613787 01256970355 01476414533 02454316125 02454319863 07464495983 07464540473 07464540493 07464543703 08536518673 08539224403 08539240963 08539247453 08539339853 08539365193 08539374243 79404345903 01223613093 01256959332 01476418433 02454312312 02454317538 03139811805 07464512293 07464553263 08536518623 08536519043 08539139253 08539149803 08539189553 08539224253 08539245933 08539284513 09689619963 09736837183 09736877443 09736877583 09736877893 70440007225 79404348833 08539232393 08539278783 09736877733 79404365033 09736871843 02635919933 04339603892 09689816083 02454311602 79404354153 79404363173 04339608077 79404357233 79404369273 79404354023 79404354853 04339605696 09736155883 02761681033 79404347153 79404347543 04339682653 79404345773 04339682433 04339621703 04339621693 08539129923 75491301083 75491311425 75491301095 75491300318 79004500202 09689827513 09689890273 09736156223 09689835913 09689829263 08539378773 04339607323 79004500205 08539244963 79004500204 79004500207 79004500208 09736155880 79405180133 09736337123 09736016920 79004500209 09736339363 09736337723 09736334300 04339674653 09736155680 09736156270 09736155783 09736062540 04339605870 09736339360 09736156600 09736320543 01223612441 01223612032 08539122223 02761654083 08539132283 01256957003 01476412543 02761685241 08539119513 79404362053 04598602070 04598602079 08539210793 04339600637 04339602221 04598624138 04598624108 04598624100 04598624103 04598624148 04598222222 04598624144 04339600671 04339606169 04339606520 04339607951 04339608142 04339609623 04339609671 04339605471 79004500222 79404367333 79404340363 08539144793 79004500223 08539173713 09736154463 04339607628 04339608284 04339608285 04339610096 08539210693 79004500225 79004500226 79404356453 79404356533 79404355483 04339601032 04339607682 04339607683 04339608575 04339608576 08539218513 04339602270 79404340103 79404343103 08539172473 09736871858 79404354513 79404368423 08539226243 04339612223 08539233013 79004500227 04598602518 04598602521 04598602529 04339605125 04339601788 75491300237 08539126143 75491300697 79404362103 04598624132 09689849593 08539342153 79404346873 02454303425 02454304708 02454305759 04339602945 04339609596 04339609744 04339682593 08539212503 09689836553 09736332510 09736334813 09736340723 09736874773 66706860263 66706899713 66706899753 66706899773 66706899793 67814901483 67814906653 67814931073 79404346383 04339602129 08539210823 04339601058 04339609621 04339608145 04339602148 04339651223 02454305755 79404346433 04339687030 09689848303 79004500206 04339603765 04339607051 04339609443 04339690313 04339694473 04339677923 04339662020 04339683343 04339691973 04339694393 04339660498 04339660237 04598602017 76218881272 75491300157 05393925653 08539141913 02761688731 09736886333 08539275723 07464559143 07464543283 07464559263 09736344573 02761688213 04598602085 04598602257 08539001784 08539178453 08539161083 01871374742 02761651223 08539246563 04598624116 04598608964 02761685244 09736153783 02761669653 01256969580 09736081363 04598624216 02761688430 09736874443 09736874673 09736879053 09736879583 09736879593 02761651373 70440002523 70440003123 70440003183 70440003203 70440003743 70440002703 70440002843 70440002903 04339609673 02848511541 09689601373 08539153723 08539159233 08539153003 09736879293 09736879783 08539153863 02761662283 09736014543 01476412143 09736344073 04598625701 04598625703 04598625702 09736015393 09736018233 09689812283 08539178043 09736877883 09736084593 02761687393 04339608607 04339608606 08539397443 08539348743 08539236633 09736341463 01256971599 02454302852 04339602152 09736156733 09736871623 02635921643 02635921633 09736016433 08539172013 09736330473 04598625704 04598625705 09736332433 09736875333 09736875343 01476412593 01476411933 09689897613 08539313393 09736156513 04598624163 70772955023 70772910116 09736340763 09736343493 02761661373 79404343093 79404343523 79404343493 08539309223 04598624212 01256959324 02454302939 09689847603 08539373073 00968983591 08539389473 09736014673 08539214153 09689849583 09736053823 09736053743 09736019493 08539212513 01256969983 01476414243 09736330553 02635913923 08539166893 09736331313 09736332443 08536518693 08536518843 09736877523 09736874453 09736845473 02454312130 09736341813 01476418793 01476423753 01476418783 01476413783 01476414793 01476418033 01476423743 01256944643 01476417453 01476417463 01476411983 01476419313 01476421503 01476417593 01476421563 01476423803 01476423903 01476420623 01476414863 01476412553 01476421683 08539238793 01476414873 01476419343 02761673033 02761677463 01256959335 09736045203 04339603415 02761661563 09736860163 09736860153 09736025143 09736879543 09736879553 97368601536 97368601635 03150401180 09736088581 09736041933 09736337223 01223273873 08539184363 09736065243 08539232493 02761665453 02761675863 09689897623 04598624210 02761677263 08536518453 01256957763 01256957563 09736061903 02761674093 09736880243 04339606814 08539186183 02761690110 09689812893 04598602530 00853003170 09736342303 70440005653 02635917243 04339621670 04598624211 09689867403 09736341263 01476423853 76218812720 01223614244 02454301469 02454304705 02454310674 02454312129 02454313000 02454312995 02454316035 02454316143 02454317638 02454320012 02454320022 02454320031 02454322206 02761690372 03242900577 08539151833 08539160543 08539164023 08539185343 08539189563 08539234823 08539275803 08539283853 08539284133 08539389413 09736050583 09736053820 09736055313 09736804013 09736837413 09736838743 09736860150 09736860180 09736860183 09736874430 09736874670 09736875633 09736877363 09736877393 09736877403 09736877413 09736877533 09736879103 09736879143 09736879243 09736879283 09736879673 09736879753 09736880173 09736880973 09736880983 09736880993 09736881883 09736881893 09736886233 09736886303 09736886483 09736886493 09736886503 09736886643 09736886653 09736886683 09736886353 09736887333 09736887553 09736889023 09736889443 09736889683 09736889883 09736889913 66706890213 67814908723 67814916803 79404354033 79404356253 79404363183 79404368293 79404368323 79405484213 79405485063 84188705022 84188705026 84188705028 84188705092 84188705116 84188705159 84188705191 09689824183 09736325833 09689817443 02454313318 08539220823 08539232993 08539233113 08539240503 08539313503 08539389533 09689610353 09689800763 09736053262 01223612988 01256959762 01223616239 79404310097 79404340353 79404362343 08539397433 08539276663 09736877383 08536518683 01256945863 04339608435 01223613350 01223613787 01256970355 01476414533 02454316125 02454319863 07464495983 07464540473 07464540493 07464543703 08536518673 08539224403 08539240963 08539247453 08539339853 08539365193 08539374243 79404345903 01223613093 01256959332 01476418433 02454312312 02454317538 03139811805 07464512293 07464553263 08536518623 08536519043 08539139253 08539149803 08539189553 08539224253 08539245933 08539284513 09689619963 09736837183 09736877443 09736877583 09736877893 70440007225 79404348833 08539232393 08539278783 09736877733 79404365033 09736871843 02635919933 04339603892 09689816083 02454311602 79404354153 79404363173 04339608077 79404357233 79404369273 79404354023 79404354853 04339605696 09736155883 02761681033 79404347153 79404347543 04339682653 79404345773 04339682433 04339621703 04339621693 08539129923 75491301083 75491311425 75491301095 75491300318 79004500202 09689827513 09689890273 09736156223 09689835913 09689829263 08539378773 04339607323 79004500205 08539244963 79004500204 79004500207 79004500208 09736155880 79405180133 09736337123 09736016920 79004500209 09736339363 09736337723 09736334300 04339674653 09736155680 09736156270 09736155783 09736062540 04339605870 09736339360 09736156600 09736320543 01223612441 01223612032 08539122223 02761654083 08539132283 01256957003 01476412543 02761685241 08539119513 79404362053 04598602070 04598602079 08539210793 04339600637 04339602221 04598624138 04598624108 04598624100 04598624103 04598624148 04598222222 04598624144 04339600671 04339606169 04339606520 04339607951 04339608142 04339609623 04339609671 04339605471 79004500222 79404367333 79404340363 08539144793 79004500223 08539173713 09736154463 04339607628 04339608284 04339608285 04339610096 08539210693 79004500225 79004500226 79404356453 79404356533 79404355483 04339601032 04339607682 04339607683 04339608575 04339608576 08539218513 04339602270 79404340103 79404343103 08539172473 09736871858 79404354513 79404368423 08539226243 04339612223 08539233013 79004500227 04598602518 04598602521 04598602529 04339605125 04339601788 75491300237 08539126143 75491300697 79404362103 04598624132 09689849593 08539342153 79404346873 02454303425 02454304708 02454305759 04339602945 04339609596 04339609744 04339682593 08539212503 09689836553 09736332510 09736334813 09736340723 09736874773 66706860263 66706899713 66706899753 66706899773 66706899793 67814901483 67814906653 67814931073 79404346383 04339602129 08539210823 04339601058 04339609621 04339608145 04339602148 04339651223 02454305755 79404346433 04339687030 09689848303 79004500206 04339603765 04339607051 04339609443 04339690313 04339694473 04339677923 04339662020 04339683343 04339691973 04339694393 04339660498 04339660237 04598602017 76218881272 75491300157 05393925653 08539141913 02761688731 09736886333 08539275723 07464559143 07464543283 07464559263 09736344573 02761688213 04598602085 04598602257 08539001784 08539178453 08539161083 01871374742 02761651223 08539246563 04598624116 04598608964 02761685244 09736153783 02761669653 01256969580 09736081363 04598624216 02761688430 09736874443 09736874673 09736879053 09736879583 09736879593 02761651373 70440002523 70440003123 70440003183 70440003203 70440003743 70440002703 70440002843 70440002903 04339609673 02848511541 09689601373 08539153723 08539159233 08539153003 09736879293 09736879783 08539153863 02761662283 09736014543 01476412143 09736344073 04598625701 04598625703 04598625702 09736015393 09736018233 09689812283 08539178043 09736877883 09736084593 02761687393 04339608607 04339608606 08539397443 08539348743 08539236633 09736341463 01256971599 02454302852 04339602152 09736156733 09736871623 02635921643 02635921633 09736016433 08539172013 09736330473 04598625704 04598625705 09736332433 09736875333 09736875343 01476412593 01476411933 09689897613 08539313393 09736156513 04598624163 70772955023 70772910116 09736340763 09736343493 02761661373 79404343093 79404343523 79404343493 08539309223 04598624212 01256959324 02454302939 09689847603 08539373073 00968983591 08539389473 09736014673 08539214153 09689849583 09736053823 09736053743 09736019493 08539212513 01256969983 01476414243 09736330553 02635913923 08539166893 09736331313 09736332443 08536518693 08536518843 09736877523 09736874453 09736845473 02454312130 09736341813 01476418793 01476423753 01476418783 01476413783 01476414793 01476418033 01476423743 01256944643 01476417453 01476417463 01476411983 01476419313 01476421503 01476417593 01476421563 01476423803 01476423903 01476420623 01476414863 01476412553 01476421683 08539238793 01476414873 01476419343 02761673033 02761677463 01256959335 09736045203 04339603415 02761661563 09736860163 09736860153 09736025143 09736879543 09736879553 97368601536 97368601635 03150401180 09736088581 09736041933 09736337223 01223273873 08539184363 09736065243 08539232493 02761665453 02761675863 09689897623 04598624210 02761677263 08536518453 01256957763 01256957563 09736061903 02761674093 09736880243 04339606814 08539186183 02761690110 09689812893 04598602530 00853003170 09736342303 70440005653 02635917243 04339621670 04598624211 09689867403 09736341263 01476423853 76218812720 01223614244 02454301469 02454304705 02454310674 02454312129 02454313000 02454312995 02454316035 02454316143 02454317638 02454320012 02454320022 02454320031 02454322206 02761690372 03242900577 08539151833 08539160543 08539164023 08539185343 08539189563 08539234823 08539275803 08539283853 08539284133 08539389413 09736050583 09736053820 09736055313 09736804013 09736837413 09736838743 09736860150 09736860180 09736860183 09736874430 09736874670 09736875633 09736877363 09736877393 09736877403 09736877413 09736877533 09736879103 09736879143 09736879243 09736879283 09736879673 09736879753 09736880173 09736880973 09736880983 09736880993 09736881883 09736881893 09736886233 09736886303 09736886483 09736886493 09736886503 09736886643 09736886653 09736886683 09736886353 09736887333 09736887553 09736889023 09736889443 09736889683 09736889883 09736889913 66706890213 67814908723 67814916803 79404354033 79404356253 79404363183 79404368293 79404368323 79405484213 79405485063 84188705022 84188705026 84188705028 84188705092 84188705116 84188705159 84188705191 09689824183 09736325833 09689817443 02454313318 08539220823 08539232993 08539233113 08539240503 08539313503 08539389533 09689610353 09689800763 09736053262 01223612988 01256959762 01223616239 79404310097 79404340353 79404362343 08539397433 08539276663 09736877383 08536518683 01256945863 04339608435 01223613350 01223613787 01256970355 01476414533 02454316125 02454319863 07464495983 07464540473" top="50" bottom="50"/>
    </s:Group>
    </s:Scroller>

</s:Application> 
```

谁能告诉我如何在富可编辑文本输入控件中显示大文本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T22:47:00.223

If I understand your question, the problem is that it doesn't wrap. You can add height, width and multiline properties to force it to wrap.

```
<?xml version="1.0"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark">
    <s:Scroller height="100%" width="100%"  >
        <s:Group height="100%" width="100%">
            <s:RichEditableText height="100%" width="100%"  multiline="true" editable="false" text="..." top="50" bottom="50"/>
        </s:Group>
    </s:Scroller>
</s:Application> 
```

# search-engine - Google 自定义搜索仅返回“无结果”

> ID：13864066
> 
> 赞同：1
> 
> 时间：2012-12-13T16:22:39.587
> 
> 标签：search-engine, google-custom-search

我正在使用 Google 的链接自定义搜索引擎。下面是我的代码。但我无法得到任何结果。我正在尝试搜索网站 www.penmai.com。请找到 [http://niranjan.99k.org/wa/cref_cse.xml](http://niranjan.99k.org/wa/cref_cse.xml)

```
<html>
    <head>
        <form id="cref" action="http://www.google.com/cse">
          <input type="hidden" name="cref" value="http://niranjan.99k.org/wa/cref_cse.xml" />
          <input type="text" name="q" size="40" />
          <input type="submit" name="sa" value="Search" />
        </form>

    </head>
    <body>
        <script type="text/javascript" src="http://www.google.com/cse/brand?form=cref"></script>
<!-- Google CSE Search Box Ends -->
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T06:02:29.380

问题在于您尝试从中获取数据的位置.. cse 仅适用于托管网页，不适用于 .xml 等文件

# android - 使用存储在 MySQL 数据库中的值在 android 应用程序中显示 Google Map

> ID：13864069
> 
> 赞同：0
> 
> 时间：2012-12-13T16:22:51.893
> 
> 标签：android, mysql, google-maps

我有一个 android 代码，它将使用 NETWORK PROVIDER 查找纬度和经度值，并使用静态 IP 将其（纬度和经度值）存储在 SERVER 以及 MYSQL 数据库中。这工作正常..

我现在需要编写一个客户端应用程序，它从 MYSQL 数据库中检索纬度和经度值，并将其显示在 android 的谷歌地图中。怎么做。在过去的 4 天里，我对此感到震惊。请帮我找到解决方案

以下是我的代码

```
public class MainActivity extends Activity {

Location location;
protected LocationManager locationManager;
private LocationListener ll ;
private TextView tv ;
EditText msgTextField;
int delay = 1000;
int period=10000;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {

    boolean gpsEnabled = true;
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
   // AlarmManager manager=(AlarmManager)getSystemService(Context.ALARM_SERVICE);
    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE); 
    tv= new TextView (this);
    try {
    gpsEnabled =locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);
  //  Toast.makeText(MainActivity.this,"ggg ",Toast.LENGTH_LONG).show();
    }
    catch (Exception e)
    {

    }
    locationManager. requestLocationUpdates( LocationManager.NETWORK_PROVIDER, 20000, 5, new MyLocationListener()); 
    Log.d("gps","Gps supports altitude"+ locationManager.getProvider(LocationManager.NETWORK_PROVIDER).supportsAltitude());
    List<String> providers=locationManager.getAllProviders();
    for(String provider : providers)
    {
       Toast.makeText(MainActivity.this,provider,Toast.LENGTH_LONG).show();
    }
    for(int w=0;w <providers.size();w++)
    {
    Log.d("Location Test ","provider "+w +":"+providers.get(w));

    }
    providers =locationManager.getProviders(true);

    final Button send = (Button) this.findViewById(R.id.sendButton);

    send.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            showCurrentLocation();

        }
    });

   Button send1 = (Button) this.findViewById(R.id.sendButton1);

    send1.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            Intent viewIntent =new Intent(MainActivity.this,Mapview.class);
            startActivity(viewIntent);

        }
    });

  Button start=(Button) this.findViewById(R.id.startSercice1);

start.setOnClickListener(new View.OnClickListener() {

    public void onClick(View arg0) {
        startService(new Intent(MainActivity.this,SimpleService.class));    

    }
});
  Button stop=(Button) this.findViewById(R.id.stopService1);
  stop.setOnClickListener(new View.OnClickListener() {

public void onClick(View v) {
    stopService(new Intent(MainActivity.this,SimpleService.class));

}
 });
 } 

protected void showCurrentLocation() 
    { 

    Location location = locationManager.getLastKnownLocation( LocationManager.NETWORK_PROVIDER);

    if (location != null) 
    {

   // double dd = location.getAltitude();
    String message = String.format( "Current Location \n Longitude: %1$s \n Latitude: %2$s  ",location.getLongitude(), location.getLatitude() );
    Toast.makeText(MainActivity.this, message,Toast.LENGTH_LONG).show();
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://xx.xx.xx.xx/YourPhpScript1.php");
    try {
       List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
       nameValuePairs.add(new BasicNameValuePair("id", "12345"));
       nameValuePairs.add(new BasicNameValuePair("message", message));
       httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
       httpclient.execute(httppost);

     }
 catch (ClientProtocolException e)
    {

    } 
 catch (IOException e)
   {

   }

    }

    }

    private class MyLocationListener implements LocationListener 
    {

    public void onLocationChanged(final Location location)
    { 

        final String message = String.format( "New Location \n Longitude: %1$s \n Latitude: %2$s  ",location.getLongitude(), location.getLatitude());
        Toast.makeText(MainActivity.this, message, Toast.LENGTH_LONG).show();

         HttpClient httpclient = new DefaultHttpClient();
         HttpPost httppost = new HttpPost("http://xx.xx.xx.xx/YourPhpScript1.php");
        double LONGITUDE = location.getLongitude();
        double LATITUDE = location.getLatitude();
        TextView myAddress = (TextView)findViewById(R.id.myaddress);

        try
        {
          Geocoder geocoder = new Geocoder(MainActivity.this, Locale.ENGLISH);
          List<Address> addresses = geocoder.getFromLocation(LATITUDE, LONGITUDE, 1);

          if(addresses != null) {
           Address returnedAddress = addresses.get(0);
           StringBuilder strReturnedAddress = new StringBuilder("Address:\n");
           for(int i=0; i<returnedAddress.getMaxAddressLineIndex(); i++) {
            strReturnedAddress.append(returnedAddress.getAddressLine(i)).append("\n");
            String add = strReturnedAddress.toString();
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
           nameValuePairs.add(new BasicNameValuePair("id", "12345"));
           nameValuePairs.add(new BasicNameValuePair("message", add));
           httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
           httpclient.execute(httppost);
           }
          myAddress.setText(strReturnedAddress.toString());
          }

          else
          {
           myAddress.setText("No Address returned!");
          }

        }
     catch (IOException e) 
     {
          // TODO Auto-generated catch block
          e.printStackTrace();
          myAddress.setText("Canont get Address!");
     }

  //  double ddd =location.getAltitude();

//   pendingIntent =PendingIntent.getService(MainActivity.this,1,intent,1);
        final String message1 = String.format( "New Location \n Longitude: %1$s \n Latitude: %2$s  ",location.getLongitude(), location.getLatitude());
        Toast.makeText(MainActivity.this, message1, Toast.LENGTH_LONG).show();

    new Timer().schedule(new TimerTask()
    {

    public void run()
    { 

    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://xx.xx.xx.xx/YourPhpScript1.php");
 try { 

       List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
       nameValuePairs.add(new BasicNameValuePair("id", "12345"));
       nameValuePairs.add(new BasicNameValuePair("message", message));
       httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

  //manager.set(AlarmManager.RTC_WAKEUP, System.currentTimeMillis()+200000, pendingIntent);
       httpclient.execute(httppost);

     }

 catch (ClientProtocolException e)
    {

    } 
 catch (IOException e)
   {

   }

  }
  },60000);

  }

    public void onStatusChanged(String s, int i, Bundle b) 
    { 
    Toast.makeText( MainActivity.this, "Provider status changed",Toast.LENGTH_LONG).show(); 
    } 
    public void onProviderDisabled(String s)
    { 
    Toast.makeText( MainActivity.this,"Provider disabled by the user. GPS turned off",Toast.LENGTH_LONG).show();

    }

    public void onProviderEnabled(String s)
    { 
    Toast.makeText( MainActivity.this,"Provider enabled by the user",Toast.LENGTH_LONG).show();
    }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:25:44.703

您必须使用 AsyncTask 从数据库中获取纬度和经度，之后，您可以使用 webView 显示地图和标记。

[https://developers.google.com/maps/articles/android_v3](https://developers.google.com/maps/articles/android_v3)

# java - 只允许 SQLException 时如何抛出 EOFException？

> ID：13864070
> 
> 赞同：1
> 
> 时间：2012-12-13T16:22:52.283
> 
> 标签：java, exception, eofexception

java.sql.Statement.execute 是否有可能抛出 java.io.EOFException？

在[http://docs.oracle.com/javase/7/docs/api/java/sql/Statement.html#execute%28java.lang.String,%20int%29](http://docs.oracle.com/javase/7/docs/api/java/sql/Statement.html#execute%28java.lang.String,%20int%29)据说它可能只抛出 java.sql .SQL 异常。但是，我记录了此异常消息：

```
** 开始嵌套异常 **

java.io.EOFException

堆栈跟踪：

java.io.EOFException
        在 com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1394)
        在 com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:1538)
        在 com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:1929)
        在 com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1167)
        在 com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1278)
        在 com.mysql.jdbc.MysqlIO.sqlQuery(MysqlIO.java:1224)
        在 com.mysql.jdbc.Connection.execSQL(Connection.java:2244)
        在 com.mysql.jdbc.Connection.execSQL(Connection.java:2192)
        在 com.mysql.jdbc.Statement.execute(Statement.java:906)
        在 com.mysql.jdbc.Statement.execute(Statement.java:947)
        在 sun.reflect.GeneratedMethodAccessor8.invoke（未知来源）
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.logicalcobwebs.proxool.ProxyStatement.invoke(ProxyStatement.java:100)
        在 org.logicalcobwebs.proxool.ProxyStatement.intercept(ProxyStatement.java:57)
        在 $java.sql.Statement$$EnhancerByCGLIB$$4e952ca0.execute()
        在 handler.do_insert(handler.java:734)
```

在“handler.java”的第 733 行有“执行”调用，在第 734 行有对 getGeneratedKeys 的调用（也可能只抛出 SQLException）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:25:58.317

看着“BEGIN NESTED EXCEPTION”让我觉得 EOFException 嵌套在 SQLException 中——可能是这种情况吗？

该方法只能抛出一个 SQLException，但 SQLException 异常可以包装另一个 Exception（或 Error）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:28:51.223

寻找的话`** BEGIN NESTED EXCEPTION **`。此异常不是由 引发的`execute()`，它是一个嵌套异常。这意味着在创建`SQLException`. 像这样的东西：

```
try {

    ...

} catch (EOFException e) {
    throw new SQLException(e);
} 
```

# java - 如何以编程方式删除 Log4j Appender？

> ID：13864072
> 
> 赞同：2
> 
> 时间：2012-12-13T16:22:56.463
> 
> 标签：java, logging, jboss, log4j

每个服务都有一个`log4j appender`，还有一种方法来执行加载这些附加程序。附加程序正在按预期进行处理。

在重新加载相同的附加程序之前是否有必要卸载任何/所有附加程序？如果是这样，我该如何卸载这些附加程序，`BasicConfigurator.unConfigure`？

我的示例 Appender 加载器（注意：`UserName`并`serviceName`通过 a 加载`servlet filter`）：

```
protected void configLogger(String serviceName, Integer serviceCode) {
    MyConfig config = (MyConfig) getServletContext().getAttribute(CONFIG);
    String path = "/" + System.getProperty("jboss.server.home.dir")
            + "/log/services/" + serviceName + ".log";

    PatternLayout pl = new PatternLayout(
            "%-5p   |   %d{yyyyMMdd HH:mm:ss,SSS}   |   %X{userName}    |   %X{serviceCode} |   %L  |   %m  |   %n");

    DailyRollingFileAppender fileAppender = null;
    org.apache.log4j.Level level = org.apache.log4j.Level.INFO;

    if (config.isTesting()){
        level = org.apache.log4j.Level.DEBUG;
    }

    try {
        fileAppender = new DailyRollingFileAppender(pl, path, "//.yyyyMMdd");
        fileAppender.addFilter(new MyLoggerFilter(serviceName, level));
        fileAppender.setAppend(true);

        BasicConfigurator.configure(fileAppender);

    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

我的 log4j 类过滤器：

```
 public class MyLoggerFilter extends Filter {
        String serviceCode = "";
    Level level;

    public FielcoLoggerFilter(String serviceCode, Level level) {
        super();
        this.serviceCode = serviceCode;
        this.level = level;
    }

    @Override
    public int decide(LoggingEvent loggingEvent) {
        org.apache.log4j.Level level = loggingEvent.getLevel();
        if (level.isGreaterOrEqual(this.level)
                && serviceCode.equals(loggingEvent.getMDC("serviceCode"))) {
            // System.out.println("decide" +
            // loggingEvent.getMDC("serviceCode"));
            return 1;
        }
        return -1;
    }

} 
```

# ruby-on-rails - 将数字添加到正则表达式？

> ID：13864074
> 
> 赞同：1
> 
> 时间：2012-12-13T16:23:04.160
> 
> 标签：ruby-on-rails, ruby, regex, ruby-on-rails-3, mongoid

我们有一个带有谷歌登录/注册的 Facebook 应用程序。一些帐户不提供用户名，因此应用程序必须在将对象保存到数据库之前创建一个。

我们目前是这样解决问题的：

```
user.username = "#{user.email[/^[^@]*/]}_#{user.id.to_s}" 
```

问题是，我们使用`mongodb/mongoid`like`database/odm`并生成了一个太长的用户名，比如：

```
hyperrjas_50ad43d11d41c86b27000066 
```

在这种情况下，我们添加了`user.id`after `hyperrjas`。

`id`如果用户名已经被占用，我们想添加一个唯一编号而不是唯一编号，例如：

```
hyperrjas
hyperrjas1
hyperrjas2
hyperrjas3
... 
```

我们该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:44:24.220

我之前回答了一个类似的问题。这就是我想出的：

[https://stackoverflow.com/a/13794784/367611](https://stackoverflow.com/a/13794784/367611)

**每条评论更新**

您可以通过执行以下操作来制作方法：

```
def prevent_collision(user)
  name = "#{user.email[/^[^@]*/]}"
  users = User.where(:username => /^#{name}/).to_a #Return an array and after use length method with users.length. Without .to_a is not working because is returned a mongoid criteria.
  count = users.length

  if count > 0
    count = rand(1000)
    loop do
      break "#{name}#{count}" unless users.any? { |u| u.name == "#{name}#{count}" }
      count += rand(10)
    end
  else
    name
  end
end 
```

返回值将是最初生成的名称或附加了计数的名称。然后你可以这样做，例如：

```
@user.username = prevent_collision(@user)
@user.save 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:00:58.550

也许这是一个有用的想法：

```
username = "hyperrjas001"
try_name = username.dup
10.times do
  raise "username maximum reached: #{username}." if try_name.end_with('999')
  try_name = try_name.next
  puts try_name
end

# Output:
#hyperrjas002
#hyperrjas003
#hyperrjas004
#hyperrjas005
#hyperrjas006
#hyperrjas007
#hyperrjas008
#hyperrjas009
#hyperrjas010
#hyperrjas011 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:39:48.603

像这样的东西可能适合递增：

```
username.sub(/^(.*\D)(\d*)$/) { "%s%d" % [ $1, $2.to_i + 1 ] } 
```

举个例子：

```
username = 'hyperrjas'
username2 = username.sub(/^(.*\D)(\d*)$/) { "%s%d" % [ $1, $2.to_i + 1 ] }
# => "hyperrjas1"
username3 = username2.sub(/^(.*\D)(\d*)$/) { "%s%d" % [ $1, $2.to_i + 1 ] }
# => "hyperrjas2" 
```

这可以根据需要重复，直到您获得唯一的名称。请注意，它会破坏名称，例如`lucky99`to `lucky100`，但不是`lucky991`。

# java - Wicket 6 IColumn 名称如何可以是字符串以外的类型？

> ID：13864075
> 
> 赞同：2
> 
> 时间：2012-12-13T16:23:05.827
> 
> 标签：java, wicket

接口 IColumn 包含一个方法 getSortProperty()，它返回任何类型 S 的值。名称如何可以是字符串以外的类型？

```
 /**
     * Returns the name of the property that this header sorts. If null is returned the header will
     * be unsortable.
     * 
     * @return the sort property
     */

S getSortProperty(); 
```

[http://ci.apache.org/projects/wicket/apidocs/6.0.x/org/apache/wicket/extensions/markup/html/repeater/data/table/IColumn.html](http://ci.apache.org/projects/wicket/apidocs/6.0.x/org/apache/wicket/extensions/markup/html/repeater/data/table/IColumn.html)

在 wicket 旧版本 6 中：

```
PropertyColumn<SomeClass> column = new PropertyColumn(Model.of("Header"), "sortProperty", "propertyExpression"); 
```

检票口 6：说明：

```
PropertyColumn(IModel<String> displayModel, S sortProperty, String propertyExpression); 
```

例子：

```
PropertyColumn<SomeClass, Long> column = new PropertyColumn(Model.of("Header"), ?, "propertyExpression"); 
```

在地上写什么“？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:35:36.093

[http://wicket.apache.org/apidocs/1.5/org/apache/wicket/extensions/markup/html/repeater/data/table/IColumn.html](http://wicket.apache.org/apidocs/1.5/org/apache/wicket/extensions/markup/html/repeater/data/table/IColumn.html)上的 javadoc说

```
getSortProperty

java.lang.String getSortProperty()

    Returns the name of the property that this header sorts. If null is returned the header will be unsortable.

    Returns:
        a string representing the sort property 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T21:25:42.877

在您使用 a 的示例中，`PropertyColumn<SomeClass, Long>`您必须使用一个`Long`值作为第二个参数，因为这是排序属性的类型。

如果您的排序属性是字符串，只需使用`PropertyColumn<SomeClass, String>`您的属性并将其传递给构造函数。

# php - Handlebars.js 的 PHP 实现

> ID：13864076
> 
> 赞同：15
> 
> 时间：2012-12-13T16:23:07.620
> 
> 标签：php, handlebars.js

我知道 Mustache.js 有一个运行良好的 PHP 实现。但是，我想深入了解帮助程序，所以我决定使用 Handlebars。

现在，我偶然发现了这个项目[https://github.com/XaminProject/handlebars.php](https://github.com/XaminProject/handlebars.php)，它似乎可以在服务器端编译 Handlebar 模板。但是，在 google 上可以找到的文档很少。是否有人已经在使用它并且可以动手实施它？

# c# - 在 Visual Studio 中调试时如何强制异常？

> ID：13864077
> 
> 赞同：59
> 
> 时间：2012-12-13T16:23:07.630
> 
> 标签：c#, .net, visual-studio

我在调试模式下运行我的应用程序，我想手动抛出一个异常（即不是从代码中）。有没有办法做到这一点？

当然，`throw new Exception("My forced exception");`在命令或立即窗口中运行是行不通的。

编辑：我希望围绕我正在调试的代码的 try-catch 语句捕获异常。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-12-13T16:23:07.630

一种可能的方法是换行并手动将代码路径中的可为空变量更改为`null`恰好在对其进行操作之前。这将导致 a`NullReferenceException`被抛出。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-13T16:30:47.423

您可以添加类似于以下的方法：

```
public static void ThrowAnException(string message)
{
    throw new ApplicationException(message);
} 
```

然后，使用**立即**窗口，您可以调用`ThrowAnException("Whoops")`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-21T15:53:06.800

如果您在单元测试的上下文中运行，并且您希望引发异常的点位于注入的接口或类的后面，则可以创建一个引发异常的模拟对象。

这样做的好处是，一旦您对复制错误感到高兴，您就可以为您的回归套件构建一个新的单元测试。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-13T16:25:15.223

在断点处尝试使用即时窗口。

# google-maps - 仅通过 GET 参数围绕某个位置创建一个圆圈

> ID：13864086
> 
> 赞同：3
> 
> 时间：2012-12-13T16:23:16.387
> 
> 标签：google-maps, url

我需要生成一个指向谷歌地图的链接，其中包含一个位置和一个围绕它的圆圈。我发现了几个与生成 URL 相关的问题/答案（例如[这个](https://stackoverflow.com/questions/2660201/what-parameters-should-i-use-in-a-google-maps-url-to-go-to-a-lat-lon)）。到目前为止，我能够显示位置、使用缩放因子等（请参见下面的链接）。

```
https://maps.google.com/maps?q=39.211374,-82.978277+%28You+Were+Here%29&z=14&ll=39.211374,-82.978277 
```

[（可点击）](https://maps.google.com/maps?q=39.211374,-82.978277%20%28You%20Were%20Here%29&z=14&ll=39.211374,-82.978277)

但是是否可以在指定位置周围添加一个具有一定半径的圆？（我知道它与 javascript 一起使用，但这不是一个选项）。

在相关说明中：是否有所有可用 GET 参数的描述？许多答案链接到[http://mapki.com/wiki/Google_Map_Parameters](http://mapki.com/wiki/Google_Map_Parameters)，不再可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:15:05.223

经过几个小时的研究，我想我可以说不可能像 JavaScript API 那样在一个位置周围画一个圆圈。但是，可以在一个位置周围绘制一个多边形，并且由于（几乎）可以将圆建模为多边形，因此这是解决该问题的一种可能方法。[此处](http://jomacinc.com/map-radius/)描述了 PHP 中的一种可能实现

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-19T19:28:31.900

我不确定是不是这样：

```
circle = new google.maps.Circle({

map: map,
radius: XXX,
position: xxxx,
visible: boolean
})

marker = new google.maps.Marker(markerOptions); 
// binds radius(circle) to marker
circle.bindTo('center', marker, 'position'); 
```

# ios6 - CATransform3DMakeTranslation 参数

> ID：13864087
> 
> 赞同：3
> 
> 时间：2012-12-13T16:23:17.870
> 
> 标签：ios6, core-animation

我正在开发一个 ios 应用程序并使用 Core Animation。

谁能解释一下 CATransform3DMakeTranslation、CGFloat tx、CGFloat ty 和 CGFloat tz 的参数？

我猜 tx 和 ty 代表对象的 x 和 y 坐标，但 'tz' 是什么？

在此先感谢，丹。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:43:36.067

该`tz`参数控制平移的深度，变换将导致图层“进出”屏幕的量。通常这不会改变太多，它只会导致图层出现在其他图层的顶部或下方。然而，使用核心动画完全可以使用透视进行完整的 3D 渲染。查看此博客以获取示例：

[http://watchingapple.com/2008/04/core-animation-3d-perspective/](http://watchingapple.com/2008/04/core-animation-3d-perspective/)

# jquery - 如何获取组中的每个第 n 个元素（以#n 开头）？- 更新

> ID：13864088
> 
> 赞同：0
> 
> 时间：2012-12-13T16:23:18.540
> 
> 标签：jquery, jquery-selectors

**更改为粗体**

* * *

我需要在一组 div 上运行一些 jquery。我**更新了以下 html 代码**：

```
 <div class="tile_set" id="tile-set" style="width: 984px;">
    <div id="tile_id_437" class="product_tile">
        <div class="tile tile_front" style="display: block;">
            <h1>Buffalo Burnin' Hot</h1>
        </div>
        <div class="tile tile_back" style="display: none;">                          
            <h1 class="title">Buffalo Burnin' Hot</h1>
            <p class="description">Extreme heat for the daring Buffalo eater.</p>
        </div>
    </div>
    <div id="tile_id_438" class="product_tile">
        <div class="tile tile_front" style="display: block;">
            <h1>Buffalo Medium</h1>
        </div>
        <div class="tile tile_back" style="display: none;">                          
            <h1 class="title">Buffalo Medium</h1>
            <p class="description">Medium heat</p>
        </div>
    </div>
    <div id="tile_id_439" class="product_tile">
        <div class="tile tile_front" style="display: block;">
            <h1>Buffalo Mild</h1>
        </div>
        <div class="tile tile_back" style="display: none;">                          
            <h1 class="title">Buffalo Mild</h1>
            <p class="description">No heat</p>
        </div>
    </div>
    <div id="tile_id_440" class="product_tile">
        <div class="tile tile_front" style="display: block;">
            <h1>Honey BBQ</h1>
        </div>
        <div class="tile tile_back" style="display: none;">                          
            <h1 class="title">Honey BBQ</h1>
            <p class="description">Sweet BBQ</p>
        </div>
    </div>

</div> 
```

**我需要在每个第 n 个 product_tile div 的子 tile_back div 上运行我的代码**，从 n 开始。（n 的值可以改变。）例如，有一次我需要在每四个元素上运行代码，从第四个（或第三个，如果你使用基数 0）开始。所以在这个例子中，代码将运行在 Tile 4 和 Tile 8 上，但不是 Tile 1。另外一次，我需要在每三个项目上运行相同的代码，所以 Tile 4 和 Tile 8，但又不是 Tile 1。

我试过使用

```
$("#tile_set .product_tile:nth-child(4n)"); 
```

但这让我得到了瓷砖 2、4、6 和 8。在这种情况下，我只想要 4 和 8。

我需要的是一种传入 n 值并让它返回匹配的图块的方法（如果我传入 3，则返回 3/6/9；如果传入 4，则返回 4/8。）

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:13:07.230

要访问`tile_back`div，您可以使用：

```
$(".tile_back", ".product_tile:nth-child(4n)") 
```

例如，要打印出`<p>`每个元素中的文本，您可以执行以下操作：

```
$(".tile_back > p", ".product_tile:nth-child(4n)").text(); 
```

# c - 带函数指针的状态机：如何设置函数指针？

> ID：13864089
> 
> 赞同：0
> 
> 时间：2012-12-13T16:23:19.723
> 
> 标签：c, function-pointers, state-machine

[本题](https://stackoverflow.com/questions/13839512/interview-function-pointers-vs-switch-case)询问一个有 100 个状态且每个状态有 100 个事件的有限状态机，然后对使用`if-else`、`switch`语句或函数指针来实现状态机进行简要比较。

我的问题是：如果使用函数指针，如何正确设置函数指针？使用`if-else`or`switch`语句（在这种情况下，函数指针会更像是一种混合解决方案）？还是有另一种常见的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:30:30.403

我希望每个状态都由一个函数表示，并且所有状态都可以“了解”彼此。

因此，设置可以是直接的：

```
void set_state(void (*state)(void))
{
  the_current_state = state;
}

void state_idle(void)
{
  printf("oh, hai, boring to be in the idle state, let's switch\n");
  set_state(state_busy);
} 
```

这假定当前状态由全局函数指针 ( `the_current_state`) 建模。

您当然也可以让每个状态*返回*新状态，或者可能`NULL`意味着“不要切换”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:43:23.473

```
struct state_fn {
   void (*handler)(void);
};

static int state;
static struct state_fn[MAX_STATE] = {
   { .handler = handler_state_0, },
   { .handler = handler_state_1, },
   { .handler = handler_state_2, },
}; 
```

然后调用 state_fn[state]->handler();

您可以选择从结构中添加参数。像这样：

```
struct state_fn {
    void (*handler)(void *data);
    void *data;
} 
```

然后调用 state_fn[state]->handler(state_fn[state]->data);

```
{ .handler = handler_state_0, .data = "blabla" }, 
```

如果一个函数处理程序可以服务于多个状态，这很方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:43:46.420

您可以执行以下操作：

```
typedef int (*current_state) (void);
typedef int (*nextnew_state) (void);
struct FuncPointerState
{
  current_state curr_state;
  nextnew_state next_state;
}; 

/*init_state is the initial function state*/
struct FuncPointerState FpState = {init_state, NULL};     
int iRet = 0;

while(1)
{

   iRet = FpState.curr_state();
   if(iRet<= 0 )
   {
      return iRet;
   }
   if(NULL==FpState.next_state)
   {
     /* State Machine finished it's job */
      break;
   }
   FpState.curr_state = FpState.next_state;

} 
```

每个状态函数都应该填充 next_state 指针。此外，您可以修改函数指针以获取输入参数。

# jquery - jQuery UI 日期选择器。

> ID：13864090
> 
> 赞同：0
> 
> 时间：2012-12-13T16:23:22.193
> 
> 标签：jquery, jquery-ui

我正在使用 jQuery UI 日期选择器。如何在单击事件上向元素添加类。

下面是我的代码。我究竟做错了什么？

```
$(function(){

   $('#calendar').datepicker();
   $('#calendar').children('td').click(function(){
         $(this).addClass('selected');
   });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:11:33.613

无论如何，这是一个快速的解决方案，可以帮助您入门：

```
var selectedDay = new Date().getDate();

$(function() {
    $("#calendar").datepicker({
        onSelect: function(dateText, inst) {
            // Save the selected day on select (if you show other months dates, you should save the selected month also.)
            selectedDay = inst.selectedDay;
        },
        // This is run for every day visible in the datepicker.
        beforeShowDay: function (date) {
            if (date.getDate() == selectedDay) {
                return [true, "selected", ""]; // Here you set your css class
            } else {
                return [true, ""]
            }
        }
    });
});​ 
```

该`beforeShowDay`函数将负责设置 css 类并将其从其他日子中删除。

当然，您可以扩展它以使用多个选定的日期，这只是为了显示您可以从哪里开始。

# javascript - ++ 运算符如果放在操作数之后返回原始值 - 如何？

> ID：13864091
> 
> 赞同：0
> 
> 时间：2012-12-13T16:23:25.377
> 
> 标签：javascript, operators, variable-assignment, execution, order-of-execution

据我所知，`x++`本质上是一种更简洁的说法`x = x + 1`。到目前为止，很清楚。在前端 Javascript 中，我偶尔会看到`++x`——我似乎记得从[jsPerf](http://www.jsperf.com)测试中我再也找不到（谷歌如何`++`有效地？）这在某种特定版本的 IE 中以某种方式具有小的性能优势，并让它就这样。

但是，我最近遇到了一些关于执行顺序（JS 代码）的奇怪怪癖：

```
var x = 1;
console.log(x++); // 1 (?!)
console.log(x);   // 2 
```

…然而

```
var x = 1;
console.log(++x); // 2 (what I would've expected)
console.log(x);   // 2 
```

我无法理解这一点。*当操作和赋值*在括号内时，我们如何返回未修改的变量，因此所有权利都应该在`console.log`调用之前执行，更不用说执行和返回了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:25:59.447

这是两个不同的东西

```
x++ 
```

是一个**后增量**。它在更改之前返回`x`，然后更改它：

```
tmp = x;
x = x+1;
return tmp; 
```

然而

```
++x 
```

是一个**预增量**。它首先更改`x`并随后返回新值：

```
x = x+1;
return x; 
```

第二个也稍微快一些，因为您的编译器/解释器不需要创建临时变量并复制数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:25:52.120

`x++`获取值，然后递增它。

`++x`增加值，然后获取它。

这是我使用的每种语言中支持这些运算符的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:25:44.680

使用 ++ AFTER 变量在该行代码之后增加值。

同样，使用 ++ BEFORE 变量会在该代码行中使用它之前增加值。

酷吧？

```
var x = 1;
x++;
console.log(x++); // 2 (?!)
console.log(x);   // 3
console.log(++x); // 4
console.log(x++); // 4
console.log(x);   // 5 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T16:25:58.667

您正在谈论*前*增量运算符和*后* [增量运算符](http://en.wikipedia.org/wiki/Increment_and_decrement_operators)之间的区别。在前一种情况下，操作本质上是`(x = x + 1; yield x)`，而在第二种情况下，它是`(yield x; x = x + 1)`。

# git - 如何将子模块与 git 管理的点文件一起使用？

> ID：13864093
> 
> 赞同：4
> 
> 时间：2012-12-13T16:23:35.780
> 
> 标签：git, git-submodules, dotfiles

我使用 git 存储库来管理我的 dotfiles，而且我很难让子模块正常工作（我的大部分 .vim 都有很多外部插件）

我有一个别名 cgit 要做（不确定它是否相关）别名 cgit='GIT_DIR=/home/myuser/.config-git GIT_WORK_TREE=/home/myuser/。混蛋'"

因此，我可以使用 cgit pull 拉取存储库，但我无法获取子模块来签出/更新：

```
$ cgit submodule status
-9895285042a2fd5691b2f6582aa979e4d1bdffea .vim/bundle/ack
-e9267044261481fbb6717b482c2f3811eb61b409 .vim/bundle/command-t
<snip>
$ cgit submodule init
$ cgit submodule update
fatal: working tree '/home/myuser/.' already exists.
Clone of 'https://github.com/mileszs/ack.vim.git' into submodule path '.vim/bundle/ack' failed
$ 
```

我已经尝试删除该特定目录并再次尝试，但它只是炸弹。我的 .gitmodules 没有 /home/myuser/。而且我的 .config-git/config 也没有对我的主目录的任何引用，所以我很茫然。如果有帮助，我的 git 版本是 1.7.4.1

谢谢！

**更新**

似乎第一件事是一个奇怪的错误，其中 git submodule 不接受环境变量（尽管其他 git 命令是），但它需要传递命令行 arg。现在，克隆工作了，它只是抱怨（我手动修复了 ack 配置）

```
Cloning into '.vim/bundle/command-t'...
remote: Counting objects: 2659, done.
remote: Compressing objects: 100% (1089/1089), done.
remote: Total 2659 (delta 1453), reused 2524 (delta 1325)
Receiving objects: 100% (2659/2659), 447.42 KiB, done.
Resolving deltas: 100% (1453/1453), done.
fatal: Could not chdir to '../../../../../../../nfs_mounts/home/myuser/.vim/bundle/command-t': No such file or directory 
```

如果我查看 ~/.config-git/modules/.vim/ack/config，我会看到：

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
    worktree = ../../../../../../../nfs_mounts/home/myuser/.vim/bundle/command-t
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = https://github.com/wincent/Command-T.git
[branch "master"]
    remote = origin
    merge = refs/heads/master 
```

但是如果我'ls'那个工作树，它似乎就在那里。如果我删除所有 ../ ，然后再次尝试 git 它似乎可以工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:34:23.820

我想这是因为你已经`GIT_DIR`设置了。看起来子模块克隆正在尝试将`.git`子模块的目录放入其中，`~/.git`但您的主 git 目录已经存在。

像这样设置 GIT_DIR 的目的是什么？

# iphone - 如何为应用程序排除第 4 代 iPod touch

> ID：13864096
> 
> 赞同：4
> 
> 时间：2012-12-13T16:23:39.010
> 
> 标签：iphone, ios, ipod-touch

我想为以下设备发布应用程序

*   iPad 2 或更高版本
*   iPhone 4 或更高版本
*   iPod 5（或更高版本）

问题是我找不到可以排除第 4 代 iPod touch 的东西，但它没有足够的 RAM 来运行应用程序，所以每次都会崩溃。有没有人有这个问题的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:48:56.417

您只能根据此处列出的功能排除设备：

[http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html)

我不知道有任何功能会消除 iPod touch 第 4 代，我相信您唯一的选择是进一步优化。

# jquery - 切换 div 状态不适用于自我点击

> ID：13864097
> 
> 赞同：0
> 
> 时间：2012-12-13T16:23:39.860
> 
> 标签：jquery

我想要什么：在点击时在显示/隐藏关联的 div 之间切换 div。这将包括如果我单击一个链接然后重新单击相同的链接，它应该切换状态。

我正在使用什么

```
function toggleVisibility(newSection) {
    $(".section").not("#" + newSection).hide();
    $("#" + newSection).show();
} 
```

```
<div id="navigation">
    <ul id="navbar">
        <li><a id="home" class="active" href="#"><span></span>Home</a></li>
        <li><a id="depot" onclick="toggleVisibility('depots_panel');" href="#"><span></span>Depot</a></li>
        <li><a id="reports" onclick="toggleVisibility('reports_panel');"><span></span>Reports</a></li>
        <li><a id="admin"><span></span>Admin</a></li>   
        <li><a id="logout" href="#" onclick="logOut();"><span ></span>Log Out</a></li>
    </ul> 
```

目前，当我在链接之间单击时，div 将在彼此之间切换，但我尝试过的任何操作似乎都不会在链接自单击时进行切换。这可能很简单，我只是看不到它。非常感激任何的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:51:05.350

您可以使用[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)方法

```
function toggleVisibility(newSection) {
    $("#" + newSection).toggle();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:29:40.400

### 相反，你可以这样做吗？

```
function toggleVisibility(newSection) {
    $(".section").hide();
    $(".section#" + newSection).show();
} 
```

### 或类似的东西：

```
function toggleVisibility(newSection) {
    $(".section").hide(0, function() {
        $(".section#" + newSection).show();
    });
} 
```

# entity-framework - 实体类型 不是当前上下文模型的一部分

> ID：13864102
> 
> 赞同：8
> 
> 时间：2012-12-13T16:23:47.417
> 
> 标签：entity-framework, entity-framework-4.1, entity, ef-model-first

这是模型优先的方法。我已经对此进行了广泛的研究，但没有提出答案。我已经尝试了以下链接中的所有建议：

这似乎是同样的问题，但没有解决 [实体类型 <classname> 不是当前上下文模型的一部分](https://stackoverflow.com/questions/4983108/the-entity-type-classname-is-not-part-of-the-model-for-the-current-context)

这些是我已经研究过的链接，所以请不要回答为 ---- [EF 4.1 Code First 错误的重复 - 实体类型 SomeType 不是当前上下文](https://stackoverflow.com/questions/5634392/ef-4-1-code-first-error-the-entity-type-sometype-is-not-part-of-the-model-for) [的模型的一部分实体类型不是模型的一部分, 英法 5](https://stackoverflow.com/questions/12560966/the-entity-type-is-not-part-of-the-model-ef-5)

这是 EDMX（为简洁起见）：

```
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="2.0" xmlns:edmx="http://schemas.microsoft.com/ado/2008/10/edmx">
<!-- EF Runtime content -->
<edmx:Runtime>
<!-- SSDL content -->
<edmx:StorageModels>
<Schema Namespace="Insight_Model.Store" Alias="Self" Provider="System.Data.SqlClient"    ProviderManifestToken="2008" xmlns:store="http://schemas.microsoft.com/ado/2007/12/edm/EntityStoreSchemaGenerator" xmlns="http://schemas.microsoft.com/ado/2009/02/edm/ssdl">
    <EntityContainer Name="Insight_ModelStoreContainer">
      <EntitySet Name="vwCompanyHeader" EntityType="Insight_Model.Store.vwCompanyHeader" store:Type="Views" store:Schema="dbo" store:Name="vwCompanyHeader">
        <DefiningQuery>SELECT 
  [vwCompanyHeader].[ID] AS [ID], 
  [vwCompanyHeader].[Name] AS [Name], 
  [vwCompanyHeader].[Active] AS [Active], 
  [vwCompanyHeader].[Creator] AS [Creator], 
  [vwCompanyHeader].[Created] AS [Created], 
  [vwCompanyHeader].[Modifier] AS [Modifier], 
  [vwCompanyHeader].[Modified] AS [Modified]
  FROM [dbo].[vwCompanyHeader] AS [vwCompanyHeader]</DefiningQuery>
      </EntitySet>
      <EntitySet Name="vwWorkOrderHeader" EntityType="Insight_Model.Store.vwWorkOrderHeader" store:Type="Views" store:Schema="dbo" store:Name="vwWorkOrderHeader">
        <DefiningQuery>SELECT 
  [vwWorkOrderHeader].[ID] AS [ID], 
  [vwWorkOrderHeader].[Active] AS [Active], 
  [vwWorkOrderHeader].[Name] AS [Name], 
  [vwWorkOrderHeader].[Creator] AS [Creator], 
  [vwWorkOrderHeader].[Created] AS [Created], 
  [vwWorkOrderHeader].[Modifier] AS [Modifier], 
  [vwWorkOrderHeader].[Modified] AS [Modified], 
  [vwWorkOrderHeader].[Leader] AS [Leader], 
  [vwWorkOrderHeader].[LeadTakenDate] AS [LeadTakenDate], 
  [vwWorkOrderHeader].[ProjectID] AS [ProjectID], 
  [vwWorkOrderHeader].[ProjectName] AS [ProjectName], 
  [vwWorkOrderHeader].[WorkOrderStatus] AS [WorkOrderStatus], 
  [vwWorkOrderHeader].[WorkOrderSubStatus] AS [WorkOrderSubStatus], 
  [vwWorkOrderHeader].[WorkOrderType] AS [WorkOrderType], 
  [vwWorkOrderHeader].[WorkOrderSubType] AS [WorkOrderSubType], 
  [vwWorkOrderHeader].[WorkOrderPriority] AS [WorkOrderPriority], 
  [vwWorkOrderHeader].[RefNumber] AS [RefNumber], 
  [vwWorkOrderHeader].[Request] AS [Request]
  FROM [dbo].[vwWorkOrderHeader] AS [vwWorkOrderHeader]</DefiningQuery>
      </EntitySet>
    </EntityContainer>
    <EntityType Name="vwCompanyHeader">
      <Key>
        <PropertyRef Name="ID" />
      </Key>
      <Property Name="ID" Type="int" Nullable="false" />
      <Property Name="Name" Type="varchar" Nullable="false" MaxLength="50" />
      <Property Name="Active" Type="bit" Nullable="false" />
      <Property Name="Creator" Type="varchar" Nullable="false" MaxLength="51" />
      <Property Name="Created" Type="date" Nullable="false" />
      <Property Name="Modifier" Type="varchar" Nullable="false" MaxLength="51" />
      <Property Name="Modified" Type="date" Nullable="false" />
    </EntityType>
    <EntityType Name="vwWorkOrderHeader">
      <Key>
        <PropertyRef Name="ID" />
      </Key>
      <Property Name="ID" Type="int" Nullable="false" />
      <Property Name="Active" Type="bit" Nullable="false" />
      <Property Name="Name" Type="varchar" Nullable="false" MaxLength="15" />
      <Property Name="Creator" Type="varchar" Nullable="false" MaxLength="51" />
      <Property Name="Created" Type="date" Nullable="false" />
      <Property Name="Modifier" Type="varchar" Nullable="false" MaxLength="51" />
      <Property Name="Modified" Type="date" Nullable="false" />
      <Property Name="Leader" Type="varchar" Nullable="false" MaxLength="51" />
      <Property Name="LeadTakenDate" Type="date" Nullable="false" />
      <Property Name="ProjectID" Type="int" Nullable="false" />
      <Property Name="ProjectName" Type="varchar" Nullable="false" MaxLength="15" />
      <Property Name="WorkOrderStatus" Type="varchar" Nullable="false" MaxLength="35" />
      <Property Name="WorkOrderSubStatus" Type="varchar" Nullable="false" MaxLength="35" />
      <Property Name="WorkOrderType" Type="varchar" Nullable="false" MaxLength="35" />
      <Property Name="WorkOrderSubType" Type="varchar" Nullable="false" MaxLength="35" />
      <Property Name="WorkOrderPriority" Type="varchar" Nullable="false" MaxLength="35" />
      <Property Name="RefNumber" Type="varchar" Nullable="false" MaxLength="25" />
      <Property Name="Request" Type="varchar" Nullable="false" MaxLength="1500" />
    </EntityType>
  </Schema></edmx:StorageModels>
<!-- CSDL content -->
<edmx:ConceptualModels>
  <Schema Namespace="Insight_Model" Alias="Self" xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns="http://schemas.microsoft.com/ado/2008/09/edm">
    <EntityContainer Name="Insight_Entities" annotation:LazyLoadingEnabled="false">
      <EntitySet Name="CompanyHeaders" EntityType="Insight_Model.CompanyHeader" />
      <EntitySet Name="WorkOrderHeaders" EntityType="Insight_Model.WorkOrderHeader" />
    </EntityContainer>
    <EntityType Name="CompanyHeader">
      <Key>
        <PropertyRef Name="ID" />
      </Key>
      <Property Type="String" Name="Name" MaxLength="50" FixedLength="false" Unicode="false" Nullable="false" />
      <Property Type="Boolean" Name="Active" Nullable="false" />
      <Property Type="String" Name="Creator" Nullable="false" MaxLength="51" FixedLength="false" Unicode="false" />
      <Property Type="DateTime" Name="Created" Nullable="false" />
      <Property Type="String" Name="Modifier" Nullable="false" MaxLength="51" FixedLength="false" Unicode="false" />
      <Property Type="DateTime" Name="Modified" Nullable="false" />
      <Property Type="Int32" Name="ID" Nullable="false" />
    </EntityType>
    <EntityType Name="WorkOrderHeader">
      <Key>
        <PropertyRef Name="ID" />
      </Key>
      <Property Type="Int32" Name="ID" Nullable="false" />
      <Property Type="Boolean" Name="Active" Nullable="false" />
      <Property Type="String" Name="Name" Nullable="false" MaxLength="15" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="Creator" Nullable="false" MaxLength="51" FixedLength="false" Unicode="false" />
      <Property Type="DateTime" Name="Created" Nullable="false" />
      <Property Type="String" Name="Modifier" Nullable="false" MaxLength="51" FixedLength="false" Unicode="false" />
      <Property Type="DateTime" Name="Modified" Nullable="false" />
      <Property Type="String" Name="Leader" Nullable="false" MaxLength="51" FixedLength="false" Unicode="false" />
      <Property Type="DateTime" Name="LeadTakenDate" Nullable="false" />
      <Property Type="Int32" Name="ProjectID" Nullable="false" />
      <Property Type="String" Name="ProjectName" Nullable="false" MaxLength="15" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="WorkOrderStatus" Nullable="false" MaxLength="35" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="WorkOrderSubStatus" Nullable="false" MaxLength="35" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="WorkOrderType" Nullable="false" MaxLength="35" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="WorkOrderSubType" Nullable="false" MaxLength="35" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="WorkOrderPriority" Nullable="false" MaxLength="35" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="RefNumber" MaxLength="25" Nullable="false" FixedLength="false" Unicode="false" />
      <Property Type="String" Name="Request" Nullable="false" MaxLength="1500" FixedLength="false" Unicode="false" />
    </EntityType>
    </Schema>
</edmx:ConceptualModels>
<!-- C-S mapping content -->
<edmx:Mappings>
  <Mapping Space="C-S" xmlns="http://schemas.microsoft.com/ado/2008/09/mapping/cs">
    <EntityContainerMapping StorageEntityContainer="Insight_ModelStoreContainer" CdmEntityContainer="Insight_Entities">
      <EntitySetMapping Name="CompanyHeaders">
        <EntityTypeMapping TypeName="Insight_Model.CompanyHeader">
          <MappingFragment StoreEntitySet="vwCompanyHeader">
            <ScalarProperty Name="ID" ColumnName="ID" />
            <ScalarProperty Name="Modified" ColumnName="Modified" />
            <ScalarProperty Name="Modifier" ColumnName="Modifier" />
            <ScalarProperty Name="Created" ColumnName="Created" />
            <ScalarProperty Name="Creator" ColumnName="Creator" />
            <ScalarProperty Name="Active" ColumnName="Active" />
            <ScalarProperty Name="Name" ColumnName="Name" />
          </MappingFragment>
        </EntityTypeMapping>
      </EntitySetMapping>
      <EntitySetMapping Name="WorkOrderHeaders">
        <EntityTypeMapping TypeName="Insight_Model.WorkOrderHeader">
          <MappingFragment StoreEntitySet="vwWorkOrderHeader">
            <ScalarProperty Name="Request" ColumnName="Request" />
            <ScalarProperty Name="RefNumber" ColumnName="RefNumber" />
            <ScalarProperty Name="WorkOrderPriority" ColumnName="WorkOrderPriority" />
            <ScalarProperty Name="WorkOrderSubType" ColumnName="WorkOrderSubType" />
            <ScalarProperty Name="WorkOrderType" ColumnName="WorkOrderType" />
            <ScalarProperty Name="WorkOrderSubStatus" ColumnName="WorkOrderSubStatus" />
            <ScalarProperty Name="WorkOrderStatus" ColumnName="WorkOrderStatus" />
            <ScalarProperty Name="ProjectName" ColumnName="ProjectName" />
            <ScalarProperty Name="ProjectID" ColumnName="ProjectID" />
            <ScalarProperty Name="LeadTakenDate" ColumnName="LeadTakenDate" />
            <ScalarProperty Name="Leader" ColumnName="Leader" />
            <ScalarProperty Name="Modified" ColumnName="Modified" />
            <ScalarProperty Name="Modifier" ColumnName="Modifier" />
            <ScalarProperty Name="Created" ColumnName="Created" />
            <ScalarProperty Name="Creator" ColumnName="Creator" />
            <ScalarProperty Name="Name" ColumnName="Name" />
            <ScalarProperty Name="Active" ColumnName="Active" />
            <ScalarProperty Name="ID" ColumnName="ID" />
          </MappingFragment>
        </EntityTypeMapping>
      </EntitySetMapping>
      </EntityContainerMapping>
  </Mapping>
</edmx:Mappings> 
```

存储库代码：

```
Imports System.Linq.Expressions
Imports System.Data.Entity.Infrastructure
Imports System.Data.Entity

Public Class Repository(Of T As {Class, IEntity})
Implements IRepository(Of T)

#Region "Attributes"
Private objectContext As IDatabaseContext
Protected objectSet As IDbSet(Of T)
#End Region

Public Sub New(objContext As IDatabaseContext)
    objectContext = objContext
    objectSet = objectContext.Set(Of T)()
End Sub
Public Function FindAll() As IQueryable(Of T) Implements IRepository(Of T).FindAll
    Return objectSet
End Function

Public Function FindWhere(predicate As Expressions.Expression(Of System.Func(Of T, Boolean))) As System.Linq.IQueryable(Of T) Implements Interfaces.IRepository(Of T).FindWhere
    Return objectSet.Where(predicate)
End Function

Public Function FindById(id As Integer) As T Implements IRepository(Of T).FindById
    Return objectSet.Single(Function(o) o.ID = id)
End Function

Public Sub Add(newEntity As T) Implements IRepository(Of T).Add
    objectSet.Add(newEntity)
End Sub

Public Sub Remove(entity As T) Implements IRepository(Of T).Remove
    objectSet.Remove(entity)
End Sub

Public Function Count(Optional predicate As Expression(Of Func(Of T, Boolean)) = Nothing) As Integer Implements IRepository(Of T).Count
    Return If((predicate Is Nothing), objectSet.Count, objectSet.Where(predicate).Count)
End Function

Public Function Exist(Optional predicate As Expression(Of Func(Of T, Boolean)) = Nothing) As Boolean Implements IRepository(Of T).Exist
    Return If((predicate Is Nothing), objectSet.Any, objectSet.Where(predicate).Any)
End Function
End Class 
```

数据库上下文代码：

```
Imports System.Data.Entity
Imports Insight.DataLayer.Interfaces
Imports System.Data.Objects
Imports System.Configuration

Public Class DatabaseContext
Inherits DbContext
Implements IDatabaseContext

Const defaultConnectStringName = "Insight_Entities"

Public Sub New()
     Me.New(ConfigurationManager.ConnectionStrings(defaultConnectStringName).ConnectionString)
End Sub
Public Sub New(connectionString As String)
    MyBase.New(connectionString)
    MyBase.Configuration.LazyLoadingEnabled = False
    MyBase.Configuration.ProxyCreationEnabled = False
End Sub
Public Overloads Sub SaveChanges() Implements Interfaces.IDatabaseContext.SaveChanges
    MyBase.SaveChanges()
End Sub

Public Overloads Function [Set](Of T As Class)() As System.Data.Entity.IDbSet(Of T) Implements Interfaces.IDatabaseContext.Set
    Return MyBase.Set(Of T)()
End Function
End Class 
```

还有2个类文件：

工单标头：

```
Imports System.ComponentModel.DataAnnotations
Imports System.Collections.ObjectModel
Imports System.Runtime.Serialization
Imports System.Data.Services.Common

Partial Public Class WorkOrderHeader
Inherits DataTransferObjectHeaderBase

Public Sub New()

End Sub
Public Sub New(iID As Integer, sName As String, bActive As Boolean, sCreator As String, dtCreated As DateTime, sModifier As String, dtModified As DateTime, sLeader As String, dtLeadTaken As Date, iProjectID As Integer, sProjectName As String, sWorkOrderStatus As String, sWorkOrderSubStatus As String, sWorkOrderType As String, sWorkOrderSubType As String, sWorkOrderPriority As String, sRequest As String)
    Me.New(iID, sName, bActive, sCreator, dtCreated, sModifier, dtModified, sLeader, dtLeadTaken, iProjectID, sProjectName, sWorkOrderStatus, sWorkOrderSubStatus, sWorkOrderType, sWorkOrderSubType, sWorkOrderPriority, "", sRequest)
End Sub
Public Sub New(iID As Integer, sName As String, bActive As Boolean, sCreator As String, dtCreated As DateTime, sModifier As String, dtModified As DateTime, sLeader As String, dtLeadTaken As Date, iProjectID As Integer, sProjectName As String, sWorkOrderStatus As String, sWorkOrderSubStatus As String, sWorkOrderType As String, sWorkOrderSubType As String, sWorkOrderPriority As String, sRefNumber As String, sRequest As String)
    ID = iID
    Name = sName
    Active = bActive
    Creator = sCreator
    Created = dtCreated
    Modifier = sModifier
    Modified = dtModified
    Leader = sLeader
    LeadTaken = dtLeadTaken
    ProjectID = iProjectID
    ProjectName = sProjectName
    WorkOrderStatus = sWorkOrderStatus
    WorkOrderSubStatus = sWorkOrderSubStatus
    WorkOrderType = sWorkOrderType
    WorkOrderSubType = sWorkOrderSubType
    WorkOrderPriority = sWorkOrderPriority
    RefNumber = sRefNumber
    Request = sRequest
End Sub

<DataMember()> _
Public Property Leader() As String
    Get
        Return _leader
    End Get
    Set(value As String)
        _leader = value
    End Set
End Property
Private _leader As String

<DataMember()> _
Public Property LeadTaken() As Date
    Get
        Return _leadTaken
    End Get
    Set(value As Date)
        _leadTaken = value
    End Set
End Property
Private _leadTaken As Date

<DataMember()> _
Public Property ProjectID() As Int32
    Get
        Return _projectID
    End Get
    Set(value As Int32)
        If (_projectID <> value) Then
            _projectID = value
        End If
    End Set
End Property
Private _projectID As Int32

<DataMember()> _
Public Property ProjectName() As String
    Get
        Return _projectName
    End Get
    Set(value As String)
        If (_projectName <> value) Then
            _projectName = value
        End If
    End Set
End Property
Private _projectName As String

<DataMember()> _
Public Property WorkOrderStatus() As String
    Get
        Return _workOrderStatus
    End Get
    Set(value As String)
        _workOrderStatus = value
    End Set
End Property
Private _workOrderStatus As String

<DataMember()> _
Public Property WorkOrderSubStatus() As String
    Get
        Return _workOrderSubStatus
    End Get
    Set(value As String)
        _workOrderSubStatus = value
    End Set
End Property
Private _workOrderSubStatus As String

<DataMember()> _
Public Property WorkOrderType() As String
    Get
        Return _workOrderType
    End Get
    Set(value As String)
        _workOrderType = value
    End Set
End Property
Private _workOrderType As String

<DataMember()> _
Public Property WorkOrderSubType() As String
    Get
        Return _workOrderSubType
    End Get
    Set(value As String)
        _workOrderSubType = value
    End Set
End Property
Private _workOrderSubType As String

<DataMember()> _
Public Property WorkOrderPriority() As String
    Get
        Return _workOrderPriority
    End Get
    Set(value As String)
        _workOrderPriority = value
    End Set
End Property
Private _workOrderPriority As String

<DataMember()> _
Public Property RefNumber() As String
    Get
        Return _refNumber
    End Get
    Set(value As String)
        _refNumber = value
    End Set
End Property
Private _refNumber As String

<DataMember()> _
Public Property Request() As String
    Get
        Return _request
    End Get
    Set(value As String)
        _request = value
    End Set
End Property
Private _request As String

End Class
#End Region 
```

公司标题：

```
Imports System.ComponentModel.DataAnnotations
Imports System.Collections.ObjectModel
Imports System.Runtime.Serialization
Imports System.Data.Services.Common

<DataServiceKey("ID")> _
<MetadataTypeAttribute(GetType(CompanyHeader.CompanyHeaderMetadata))> _
Partial Public Class CompanyHeader
Inherits DataTransferObjectHeaderBase

Friend NotInheritable Class CompanyHeaderMetadata

    'Metadata classes are not meant to be instantiated.
    Private Sub New()
        MyBase.New()
    End Sub

    <DataMember()> _
    Public Property Active As Boolean

    <DataMember()> _
    Public Property ID As Integer

    <DataMember()> _
    Public Property Created As DateTime

    <DataMember()> _
    Public Property Creator As String

    <DataMember()> _
    Public Property Modified As DateTime

    <DataMember()> _
    Public Property Modifier As String

    <DataMember()> _
    Public Property Name As String
End Class

Public Sub New()

End Sub
Public Sub New(iID As Integer, sName As String, bActive As Boolean, sCreator As String, dtCreated As DateTime, sModifier As String, dtModified As DateTime)
    ID = iID
    Name = sName
    Active = bActive
    Creator = sCreator
    Created = dtCreated
    Modifier = sModifier
    Modified = dtModified
End Sub
End Class 
```

单元测试代码：

```
<TestMethod()> _
Public Sub WorkOrderServiceTests_TestConnectivityThruService5()
    Dim woService As New DatabaseContext
    Dim woHeaders = New Repository(Of WorkOrderHeader)(woService)
    Dim woTests = New Repository(Of WorkOrderTest)(woService)
    Dim coHeaders = New Repository(Of CompanyHeader)(woService)
    Assert.IsTrue(woHeaders.Count <> 0)
End Sub 
```

我试图解决这个问题的事情：

1) 检查数据库 - 两个查询都正确返回数据。从 vwWorkOrderHeader 中选择 * 从 vwCompanyHeader 中选择 *

2) 从 EDMX 中删除 WorkOrderHeader 然后从数据库中重新创建它。

3) MOQed 了 DBContext 以确保它不是服务查询在做一些有趣的事情。这正确地返回了对象，因此这意味着它是上下文级别或更低级别的东西。

4) 逐步完成这两个测试，以确保它们使用相同的构建上下文的方法 - Thy do。

4) 逐步完成这两个测试，以确保它们使用相同的方法来构建存储库 - 你这样做。

5）唯一的区别是在DatabaseContext的以下功能期间：

```
Public Overloads Function [Set](Of T As Class)() As System.Data.Entity.IDbSet(Of T) Implements Interfaces.IDatabaseContext.Set
    Return MyBase.Set(Of T)()
End Function 
```

WorkOrderHeader 代码在 MyBase.Set(Of T)() 的手表中具有以下内容

```
{System.Data.Entity.DbSet(Of Insight.Model.WorkOrderHeader)} System.Data.Entity.DbSet(Of Insight.Model.WorkOrderHeader) 
```

CompanyHeader 代码在 MyBase.Set(Of T)() 的手表中具有以下内容

```
{SELECT   [Extent1].[Name] AS [Name],   [Extent1].[Active] AS [Active],   [Extent1].[Creator] AS [Creator],   [Extent1].[Created] AS [Created],   [Extent1].[Modifier] AS [Modifier],   [Extent1].[Modified] AS [Modified],   [Extent1].[ID] AS [ID]  FROM (SELECT        [vwCompanyHeader].[ID] AS [ID],        [vwCompanyHeader].[Name] AS [Name],        [vwCompanyHeader].[Active] AS [Active],        [vwCompanyHeader].[Creator] AS [Creator],        [vwCompanyHeader].[Created] AS [Created],        [vwCompanyHeader].[Modifier] AS [Modifier],        [vwCompanyHeader].[Modified] AS [Modified]       FROM [dbo].[vwCompanyHeader] AS [vwCompanyHeader]) AS [Extent1]}   System.Data.Entity.DbSet(Of Insight.Model.CompanyHeader) 
```

我对此完全不知所措，并且正在进入解决同一问题的第三天。我希望对这个问题有一些新的看法可能会看到我犯的错误，或者指出我没有想到的测试问题的方向。

更新：

我删除了服务代码以确保它在 DBContext 中。我已将服务从等式中分离出来，以便仅使用存储库并且它们都使用相同的 DatabaseContext，因此它与连接字符串无关。我验证了模型浏览器中 Insight_Model/EntityContainer:Insight_Entities/Entity Sets/WorkOrderHeaders 下存在，并且 Insight_Model/Entity Types/WorkOrderHeader 下存在。似乎 DatabaseContext 甚至没有尝试查询实体集的概念模型。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-14T13:12:58.583

3 (4) 天后（取决于您如何看待天数，我将天数划分为我睡觉的时间，而不一定是太阳下山/升起的时间），我找到了答案。在上面的 EDMX 文件中，我有一个名为 LeadTakenDate 的列，在 WorkOrderHeader 类中，我使用了字段名称 LeadTaken。这对我来说是一个愚蠢的错误。

这对你有什么好处？这是我解决问题的方法：

首先，我通过 MOQing 部分将问题精确地隔离到一个区域，以查看问题在兔子洞的深处有多远。一旦我发现问题出在 DatabaseContext 中，我就编写了一个测试用例，该用例创建了一个工作用例和一个非工作用例。这隔离了问题，让我能够测试理论以更快地解决它。在尝试使用 EF 5.x 持久性无知 poco 生成器之前，我尝试了一千种不同的方法。我在 WorkOrderHeader 类中注释掉了我的所有代码并将生成的代码复制进去。重新运行我的测试并且它们工作了，所以我开始取消注释我的属性并注释掉生成的代码，然后重新运行我的测试，直到我找到适当的属性。

错误消息非常神秘，很难排除故障。

# css - CSS 特殊性规则

> ID：13864108
> 
> 赞同：0
> 
> 时间：2012-12-13T16:23:58.213
> 
> 标签：css, twitter-bootstrap, css-specificity

我正在使用 twitter bootstrap (TB)，似乎他们的 CSS 规则在他们不应该的时候优先。我创建了这个小提琴来显示问题：

[http://jsfiddle.net/whoiskb/Za2TB/](http://jsfiddle.net/whoiskb/Za2TB/)

HTML

```
<div class="teaser">
     <h1 class="teaserText">Text text text <label>Label</label> Text <label>Activities</label></h1>
</div> 
```

CSS（加上 twitter bootstrap 的外部链接）

```
div.teaser h1.teaserText {
     font-size: 100px;
     font-weight: 100;
     color: black;
     line-height: 90px;
     font-family: "Trebuchet MS", "Arial Black", "Impact", "Arial";
     text-transform: uppercase;
}

div.teaser h1.teaserText label {
     color: #FCCE00;
}​ 
```

根据我对特异性规则的了解，为 TB 中的标签定义的规则应该只得到 1 的值，因为 html 选择器的值是 1。我的类应该有 23 的值，因为我有 3 个 html 选择器和 2 个类选择器每个应该得到 10 的值。正如您在小提琴中看到的那样，尽管 TB css 定义中的标签选择器优先。

有人可以解释我在这里缺少什么吗？

顺便说一句，我知道我可以使用 !important 标签来解决这个问题，我只是想更好地理解 CSS 特异性规则。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:34:18.470

特异性规则仅适用于不同的规则针对**相同的元素（至于标签的颜色），而不是针对不同的元素（即使该元素的某些样式将被继承）。

您将一个样式规则应用于标签，即正确应用的颜色。所有其他样式都应用于另一个元素，因此直接针对标签的 TB 样式当然是首选。

某些样式是继承的（例如示例中的 font-size 和 line-height），但是一旦有直接针对您的元素的规则，它们就会被覆盖。TB 使用以下规则覆盖您的字体大小和行高：

```
label, input, button, select, textarea {
  font-size: 14px;
  font-weight: normal;
  line-height: 20px;
} 
```

您可以通过声明以下内容轻松解决此问题：

```
div.teaser h1.teaserText label {
     color: #FCCE00;
     font-size:inherit;
     line-height:inherit;
     /* and so on */
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:32:10.173

我不太清楚你认为问题是什么，但猜测一下：

CSS 特性决定了当给定元素*的一个 CSS 属性有两个或多个规则时会发生什么。*

所以，给定这个 HTML：

```
<label class="myLabel">Hello!</label> 
```

这个CSS：

```
label {
    color: red;
    font-size: 24px;
}

.myLabel {
    color: blue;
} 
```

标签将是蓝色的，因为`.myLabel`它是一个比 . 更具体的选择器`label`。

但是，标签也将具有 24 像素的字体大小，因为该`.myLabel`块不包含设置`font-size`属性的规则。

# parsing - 使用 bash 逐行读取文件，提取一些数据。如何？

> ID：13864114
> 
> 赞同：0
> 
> 时间：2012-12-13T16:24:05.513
> 
> 标签：parsing, shell, text-extraction

我想根据特定标签读取文件并从中提取信息。例如 ：

```
SCRIPT_NAME:mySimpleShell.sh

This is a simple shell. I would like to have this as
Description. I also want to create a txt file our of this.

SCRIPT_NAME:myComplexShell.sh

This is a complex shell. I would like to have this as
Description. I also want to create a txt file our of this. 
```

因此，当我将此文件传递给我的 shell 脚本时，我的 shell 将逐行读取它，当它到达 SCRIPT_NAME 时，它会提取它并将其保存在 $FILE_NAME 中，然后开始使用 $FILE_NAME 将描述写入磁盘上的文件.txt 名称。它会一直这样做，直到它到达文件的末尾。如果有 3 个 SCRIPT_NAME 标签，那么它会创建 3 个描述文件。

感谢您提前帮助我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:28:04.197

```
#!/bin/sh

awk '/^SCRIPT_NAME:/ { split( $0, a, ":" ); name=a[2]; next }
    name { print > name ".txt" }' ${1?No input file specified} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:32:02.137

使用`while`循环读取行。使用正则表达式检查一行是否有`SCRIPT_NAME`，如果有，提取文件名。如下所示：

```
#! /bin/bash
while IFS= read -r line
do
    if [[ $line =~ SCRIPT_NAME:(.*$) ]]
    then
        FILENAME="${BASH_REMATCH[1]}"
        echo "Writing to $FILENAME.txt"
    else
        echo "$line" >> "$FILENAME.txt"
    fi
done < inputFile 
```

# android - 自定义列表片段

> ID：13864116
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:24:16.027
> 
> 标签：android, android-fragments, android-listfragment

我如何做一个自定义列表片段，比如这个[自定义列表视图](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)，但是对于列表片段..

这是一样的吗？因为在 listfragment 我们在 xml 中声明..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:26:43.013

您可以像任何其他类一样扩展 ListFragment。然后，您可以在 xml 中引用您自己的自定义类：

```
<my.package.location.MyListFragment .../> 
```

# android - Android videoview控件不显示视频，只播放音频

> ID：13864118
> 
> 赞同：1
> 
> 时间：2012-12-13T16:24:25.903
> 
> 标签：android, android-videoview

我正在尝试从 android 中的 url 播放视频，为此我在片段类中使用 videoview 控件，但是在播放时没有视频输出，只有音频输出，视频为 .mp4 格式。我已经通过以下方式完成了 -

```
 VideoView vv;
  vv=(VideoView)view.findViewById(R.id.videoView1);
  String src="video path";
  Uri uri=Uri.parse(src);   
  getActivity().getWindow().setFormat(PixelFormat.TRANSLUCENT);     
  MediaController mc=new MediaController(getActivity());
  mc.setMediaPlayer(vv);
  vv.setMediaController(mc);
  vv.setVideoURI(uri);
  vv.requestFocus();
  vv.start(); 
```

这是我的 xml 代码

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:background="#303040" >

    <RelativeLayout
        android:layout_width="230dp"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/headLine"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="100dp"
            android:layout_marginTop="5dp"
            android:textColor="#AFDEFE"
            android:textSize="14sp"
            android:textStyle="italic"
            android:typeface="serif" />

        <com.facebook.widget.ProfilePictureView
            android:id="@+id/fbPic"
            android:layout_width="72dp"
            android:layout_height="72dp"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:layout_marginTop="5dp"
            android:layout_marginLeft="20dp" >
        </com.facebook.widget.ProfilePictureView>
    </RelativeLayout>

    <com.facebook.widget.LoginButton
            android:id="@+id/loginButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="30dp" />

    <Button
        android:id="@+id/settingsButton"
        android:layout_width="111dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_marginTop="32dp"
        android:text="Play" />

    <VideoView
        android:id="@+id/videoView1"
        android:layout_width="200dp"
        android:layout_height="140dp"
        android:layout_marginLeft="60dp"
        android:layout_marginTop="10dp"
        android:keepScreenOn="true" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-09T09:38:04.320

只添加一行

```
vv.setZOrderOnTop(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:35:58.263

在这里尝试我的代码，我建议您使用以下代码，其中我正在成功运行我的应用程序

代码如下：

XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#f0f0f0" >

    <Button
        android:id="@+id/btnVideoGallery"
        android:layout_width="75dp"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="15dp"
        android:text="@string/gallery" />

    <Button
        android:id="@+id/btnCancel"
        android:layout_width="120dp"
        android:layout_height="wrap_content"
        android:layout_below="@+id/btnVideoGallery"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="22dp"
        android:text="@string/cancel" />

    <TextView
        android:id="@+id/lblDisplayImage"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/btnCancel"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp"
        android:text="@string/below_this_text_video_will_be_displayed"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="#000000"
        android:textSize="13dp" />

    <VideoView
        android:id="@+id/vvDisplayVideo"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/lblDisplayImage"
        android:layout_marginTop="15dp" />

</RelativeLayout> 
```

Java 文件：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.MediaController;
import android.widget.VideoView;

public class VideoActivity extends Activity {

    private Button btnVideoGallery,btnCancel;
    private VideoView vvDisplayVideo;
    /** The Constant PICK_VIDEO. */
    private static final int PICK_VIDEO=1;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_video_options);

        btnVideoGallery=(Button)findViewById(R.id.btnVideoGallery);
        vvDisplayVideo=(VideoView)findViewById(R.id.vvDisplayVideo);
        btnCancel=(Button)findViewById(R.id.btnCancel);
        vvDisplayVideo.setVisibility(View.GONE);

        btnVideoGallery.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                Intent video=new Intent();
                video.setAction(Intent.ACTION_PICK);
                video.setType("video/*");
                startActivityForResult(video, PICK_VIDEO);

            }
        });

        btnCancel.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                Intent goStartUp=new Intent(VideoActivity.this, StartUpActivity.class);
                goStartUp.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(goStartUp);
                finish();
            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        if (resultCode==Activity.RESULT_OK && requestCode == PICK_VIDEO) {

            vvDisplayVideo.setVisibility(View.VISIBLE);
            vvDisplayVideo.setVideoURI(data.getData());
            vvDisplayVideo.setFocusable(true);
            MediaController mc=new MediaController(this);
            vvDisplayVideo.setMediaController(mc);
            Log.i("True", "Executed");
        }
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        // TODO Auto-generated method stub

        Intent goStartUp=new Intent(VideoActivity.this, StartUpActivity.class);
        goStartUp.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(goStartUp);
        finish();
        return super.onKeyDown(keyCode, event);
    }
} 
```

您还可以根据您的使用修改清单文件：

```
<manifest ...>
    <uses-sdk .../>
    <uses-permission android:name="android.permission.CAMERA" />
        <uses-permission android:name="android.permission.RECORD_VIDEO" />
        <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
        <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

        <uses-feature
            android:name="android.hardware.camera"
            android:required="false" />

    <application ...>
    </application>

</manifest> 
```

# java - 事件侦听器在一个类中不起作用，但在另一个类中起作用

> ID：13864121
> 
> 赞同：0
> 
> 时间：2012-12-13T16:24:31.130
> 
> 标签：java, swing, events, awt, keyboard-events

我有这个类，当我像这样添加到这个类时，我创建了一个`KeyboardEvent`扩展类，然后按下它（现在）执行的键，但没有打印出来，它没有做任何事情（没有错误） .`KeyAdapter``addKeyListener``System.out.println("Here");`

```
public class Ship extends GameObject{ // GameObject Extends JPanel
    public Ship(Sprite sprite, ImageObserver o){
        super(sprite, o);
        this.addKeyListener(new KeyboardEvent());
    }
} 
```

但是当我这样做时，它会起作用，也就是打印出“这里”：

```
public class Game extends JFrame{
    public void start(int width, int height){
        this.addKeyListener(new KeyboardEvent());
    }
} 
```

在其他一些课程中，我运行这个：

```
package test;

import JGame.Game.Game;
import JGame.Room.Room;
import javax.swing.JFrame;
import test.Rooms.Room1;

public class Main extends JFrame{
    public static void main(String[] args){
        Game game = new Game("Test Game");
        game.start(800, 600);

        Room room1 = new Room1(); // This class initiates Ship() it extends Room Which extends JPanel
        game.setRoom(room1);
    }
} 
```

# numpy - 使用 numpy 数组迭代多维数组（图像） - python

> ID：13864124
> 
> 赞同：3
> 
> 时间：2012-12-13T16:24:35.840
> 
> 标签：numpy, python-2.7

嗨！我有两个图像（相同的维度）作为 numpy 数组 imgA - imgB 我想迭代每一行和每一列并得到类似的东西：

```
for i in range(0, h-1):
  for j in range(0, w-1):
    final[i][j]= imgA[i,j] - imgB[i-k[i],j] 
```

其中 h 和 w 是图像的高度和宽度，k 是尺寸为 [h*w] 的数组。

我已经看到了这个主题： [迭代一个 numpy 数组](https://stackoverflow.com/questions/6967463/iterating-over-a-numpy-array) ，但它不适用于图像，我得到错误：解包的值太多有没有办法用 numpy 和 python 2.7 做到这一点？

谢谢

编辑我试图更好地解释自己。我在 LAB 颜色空间中有 2 张图像。这些图像是 (288,384,3)。现在我想做 deltaE 所以我可以这样做（吐出 2 个数组）：

```
 imgLabL=np.dsplit(imgL,3)
 imgLabR=np.dsplit(imgR,3)
 imgLl=imgLabL[0]
 imgLa=imgLabL[1]
 imgLb=imgLabL[2]
 imgRl=imgLabR[0]
 imgRa=imgLabR[1]
 imgRb=imgLabR[2]
delta=np.sqrt(((imgLl-imgRl)**2) + ((imgLa - imgRa)**2) + ((imgLb - imgRb)**2)   ) 
```

直到现在一切都很好。但现在我有了这个大小为 k 的数组（288,384）。所以现在我需要一个新的增量但具有不同的 x 轴，就像 imgRl(0,0) 中的像素我想在 imgLl(0+k,0) 中添加像素

你有更多我的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:44:36.217

我很确定，无论您尝试做什么，都可以进行矢量化并在其中没有任何循环的情况下运行。但是您的代码编写方式，它不起作用也就不足为奇了......

如果`k`是一个形状数组`(h, w)`，那么`k[i]`就是一个形状数组`(w,)`。当你这样做时`i-k[i]`，numpy 会发挥它的广播魔法，你会得到一个 shape 数组`(w,)`。`imgB`因此，您正在使用形状数组`(w,)`和单个整数进行索引。因为索引中的一个项目是一个数组，所以[花哨的索引](http://www.scipy.org/Tentative_NumPy_Tutorial#head-0dffc419afa7d77d51062d40d2d84143db8216c2)开始了。所以假设`imgB`也有 shape `(h, w, 1)`，返回值`imgB[i-k[i], j]`将不是一个 shape 数组`(1,)`，而是一个 shape 数组`(w, 1)`。当你尝试从 中减去它时`imgA[i, j]`，它是一个 shape 数组`(1,)`，广播魔法再次起作用，所以你得到一个 shape 数组`(w, 1)`。

我们不知道是什么`final`。但是，如果它是一个 shape 数组`(h, w, 1)`，as`imgA`和`imgB`，那么`final[i][j]`就是一个 shape 数组`(1,)`，而您正试图为其分配一个 shape 数组`(w, 1)`，但它不适合。因此出现`operand requires a reduction,but reduction is not enabled`错误消息。

**编辑**

您真的不需要拆分数组来计算 DeltaE ...

```
def deltaE(a, b) :
    return np.sqrt(((a - b)**2).sum(axis=-1))

delta = deltaE(imgLabL, imgLabR) 
```

我仍然不明白你想在第二种情况下做什么......如果你想比较沿 x 轴位移的两个图像，我建议使用[`np.roll`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.roll.html)：

```
deltaE(imgLabL, np.roll(imgLabR, k, axis=0)) 
```

将在的像素和的像素`(r, c)`之间具有 deltaE 的位置。那是你要的吗？`(r, c)``imgLabL``(r - k, c)``imgLAbR`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:07:19.003

我通常使用`numpy.nditer`，其文档在[此处](http://docs.scipy.org/doc/numpy/reference/generated/numpy.nditer.html)并有很多示例。简要地：

```
import numpy as np
a = np.ones([4,4])

it = np.nditer(a)
for elem in a:
    #do stuff 
```

你也可以使用c风格的迭代，即

```
while not it.finished:
    #do stuff
    it.iternext() 
```

如果您需要访问数组的索引。在您的情况下，我会将您的两个图像压缩在一起以创建一个形状数组，`[2,h,w]`然后对其进行迭代，用计算结果填充一个空数组。

# ipython - 没有名为 ipapi 的模块

> ID：13864126
> 
> 赞同：3
> 
> 时间：2012-12-13T16:24:39.023
> 
> 标签：ipython, ipython-notebook

根据[http://wiki.ipython.org/index.php?title=Cookbook/Custom_completers的建议，我试图在 IPython 笔记本中为我的一些函数添加一些自定义完成器](http://wiki.ipython.org/index.php?title=Cookbook/Custom_completers)

当代码尝试从 IPython 加载 ipapi 时，它会收到“ImportError: No module named ipapi”

有任何想法吗？我看到了一些关于早期版本的错误报告，应该在我正在使用的 0.13.1 中修复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:35:15.787

似乎 ipapi 移入了 Ipython.core

调用 import Ipython.core.ipapi 没有问题。

# jquery - ajax提交后，滚动到表单顶部

> ID：13864129
> 
> 赞同：5
> 
> 时间：2012-12-13T16:24:43.803
> 
> 标签：jquery, ajax, jquery-animate

> **可能重复：**
> [Ajax 内容加载后滚动到顶部](https://stackoverflow.com/questions/9777563/scroll-to-top-after-ajax-content-load)

我有一个 ajax 表单，提交时会显示错误或成功消息，理想情况下，我想将浏览器滚动到表单顶部，以便用户可以看到这些消息，但是当我实现它时，它似乎无法正常工作而且我不知道如何修复它：-/它要么滚动不够高，要么刷新？:(我很茫然，如果你能指导我，那就太好了:)

```
$('#submit').bind('click', function(){
   $('body, html').animate({scrollTop:$('form').offset().top}, 'slow', 'easeInCubic');
   $.ajax({               
      url:$(this).attr('action'),
      type:'POST',              
      data:$('form').serialize(),
      dataType:'json',
      success:function(respond) {
         if(respond.result == 'false') {
            var error_msg = '<h3>Please correct the following errors:</h3><ul>'+respond.errors+'</ul>';
            $('.error_msg').html(error_msg);            
         } else {
            var success_msg = '<h3>Success!</h3>';  
            $('.error_msg').empty();    
            $('.success_msg').html(success_msg);
            $('form').find("input[type=text], textarea").val("");                           
            setTimeout(function() {
               $('.success_msg').slideUp();                             
            }, 5000);
         }      
      }
   });                      
   return false;    
}); 
```

HTML：

```
<form method="post" action="form.php">
   <div class="error_msg"></div>
   <div class="success_msg"></div>
   <label for="name">Name?</label>
   <input type="text" value="" name="name" />
   <label for="email">Email?</label>
   <input type="text" value="" name="email" />
   <input id="submit" type="submit" value="Submit" name="submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T17:54:34.950

Actually i would do it in two ways:

FIRST:

```
 $(function(){
            function submitForm(){
                $.ajax({
                    url:"a.php",
                    type:"post",
                    success:function(data){
                        alert(data);
                    },
                    complete:function(){
                        $('body, html').animate({scrollTop:$('form').offset().top}, 'slow');
                    }
                });
            }
            $('#submit').click(function(){
                submitForm();
            });
        }); 
```

Here i have created a function submitForm() and click of the input type button i am submitting it.

or a better way with a submit button:

SECOND: (I LIKE THIS WAY)

```
$(function(){
   $('form').submit(function(e){
     e.preventDefault();
       $.ajax({
         url:"a.php",
         type:"post",
         success:function(data){
            alert(data);
         },
         complete:function(){
           $('body, html').animate({scrollTop:$('form').offset().top}, 'slow');
        }
     });
  });
}); 
```

# php - 从 PHP 执行 Shell 脚本。Apache 日志语法错误：“）”意外

> ID：13864132
> 
> 赞同：0
> 
> 时间：2012-12-13T16:24:47.230
> 
> 标签：php, linux, bash, shell, syntax-error

我找不到错误，脚本从控制台运行良好，我认为这是 PHP 的事情，但什么都做不了。

也许权限的东西？执行事情？我真的不太了解，希望有人能帮助我。谢谢！

BASH 脚本（简单地将作业发送给打印机，但我把它放在里面以防万一）：

```
#!/bin/bash
PBOX_DIR_TMP="/tmp"
DESDE=$1
HASTA=$2
FORMULARIO=$3
COLA=$4
FECHA=$(date +%F)
SPOOL="/spool.$$.txt"
ARCHIVOSALIDA="${PBOX_DIR_TMP}"/salida.$$.txt
RETURNCODE=0
echo "$DESDE"
echo "$HASTA"
echo "@PBSSFORM ${FORMULARIO}" > "${SPOOL}"
for ((i = ${DESDE};i <= ${HASTA};i++))
do
  if [ $i > ${DESDE} ]
  then
    echo -e "\f${FECHA}" >> "${SPOOL}"
    echo "${i}" >> "${SPOOL}"
  else
    echo "${FECHA}" >> "${SPOOL}"
    echo "${i}" >> "${SPOOL}"
  fi
done
cat "${SPOOL}" | pboxsvc ${PBOX_DIR_BIN}/pboxlib.bin AplicarHostForm > "${ARCHIVOSALIDA}"
lp -d "${COLA}" "${ARCHIVOSALIDA}"
RETURNCODE=$?
rm "${ARCHIVOSALIDA}"
rm "${SPOOL}"
if [ ${RETURNCODE} -eq 0 ]
  then
    exit 1
  else
    exit 0
fi 
```

PHP 调用：

```
$cmd = "/printb/imprimirFormPlano.bin 1 2 FILE.PS Cola1"; 
```

阿帕奇日志：

```
/printb/imprimirFormPlano.bin 1: Syntax error: ")" unexpected
sh: 2: not found. 
```

如果我像这样从 shell 调用它，这些脚本就可以工作：`./printb/imprimirFormPlano.bin 1 2 FILE.PS Cola1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:27:29.730

看起来您的 apache 的默认 shell 是`sh`而不是`bash`. 尝试将您的命令更改为

```
$cmd = '/bin/bash /printb/imprimirFormPlano.bin 1 2 FILE.PS Cola1'; 
```

# c# - 正确调整自定义绘制控件的大小

> ID：13864139
> 
> 赞同：0
> 
> 时间：2012-12-13T16:25:03.717
> 
> 标签：c#, winforms, visual-studio, gdi+

我正在尝试制作一个自定义控件，该控件可以正确地绘制自身以填充其当前大小。我假设我应该使用[ClientRectangle](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.clientrectangle.aspx)属性来调整大小，但客户矩形的右侧和底部似乎被剪裁了。

填充绘制事件处理程序

```
Rectangle smaller = new Rectangle(5, 5, ClientRectangle.Width - 10, ClientRectangle.Height - 10);
e.Graphics.DrawRectangle(System.Drawing.Pens.Black, smaller);  
e.Graphics.DrawRectangle(System.Drawing.Pens.Red, ClientRectangle); 
```

产生这个：

![ClientRecangle 被剪裁](../Images/86b93e35d439d586dad47bb5b4919748.png)

我应该使用什么来获取控件的可绘制区域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T16:16:58.427

您可以使用：

```
ControlPaint.DrawBorder(g, this.ClientRectangle, _
                        Color.Red, ButtonBorderStyle.Solid); 
```

哪里`Graphics g = e.Graphics;`。

或者像你一样绘制它，但从宽度和高度中减去 1（1 因为宽度和高度包含在内，但绘制矩形需要不包括最后一个像素的大小 - 在内部它计算`x + w/y + h`然后在最后一个像素之后的*下一个*像素的位置结束，因此我们需要减去一个来获得*最后一个*像素的位置）。

```
rectangle r = this.ClientRectangle;
r.Width -= 1;
r.Height -= 1;

g.DrawRectangle(System.Drawing.Pens.Red, r); 
```

当然，这来自`OnPaint`事件处理程序。

# javascript - 无法根据谷歌电子表格中的日期过滤主表中其他电子表格粘贴的数据

> ID：13864148
> 
> 赞同：0
> 
> 时间：2012-12-13T16:25:27.930
> 
> 标签：javascript, google-apps-script, google-sheets

首先感谢您为本站所做的努力。作为个人和初学者，我从我所犯的错误中吸取了教训。感谢所有做出贡献并提供支持的人。谢谢你。

这是一个编写的小程序，它无法正常工作（没有输出），我已经尝试了很多方法但徒劳无功。请帮我找到解决方案。该程序的目的是从 4 张表格中过滤数据并粘贴到当前表格（主表格）中。此过滤器基于日期值。

日期条件取自 (b2 & d2) 日期列中的主表。这将根据客户表中包含日期的第 18 列进行过滤。

```
function myFunction3() {

var source = ['0AjkkHlm3kCphdGhSWnlxWmFsakZ2aFhMSHl6SlF3M1E',
                '0AjkkHlm3kCphdHY2aXpjTVJEMlFRYVBST0ZPYzNwRFE',
                '0AjkkHlm3kCphdEc5ZHFpeHVlc241SlFKWGJDeXFKLXc',
                '0AjkkHlm3kCphdG9WVjVRRnQ3RlFlcllhd1JGallXVmc'];

var ss = SpreadsheetApp.getActiveSpreadsheet();
// get start date from sheet
var sDate = ss.getSheetByName('123').getRange("B2").getValue();
// get end date from sheet
var eDate = ss.getSheetByName('123').getRange("D2").getValue();
// days between
var Dura = ss.getSheetByName('123').getRange("E1").getValue(); 

  var codes = new Array();

  for (var k = 0; k < Dura; k++){ 
      var d = new Date(sDate);
      d.setDate(d.getDate()+ k);
      codes[k] = d;
  }

  var numCodes = codes.length;
  var copied = [];
  for (var k = 0; k < numCodes; k++) {
    copied[k] = [];
  }

//get data from external sheets for comparision
  for (var i = 0; i < source.length; i++) {
    var tempCopy = SpreadsheetApp.openById(source[i]).getSheetByName('Footfall-Format').getDataRange().getValues();
    // comparision starts
    for (var j = 0; j < tempCopy.length; j++) {
      var codeIndex = codes.indexOf(tempCopy[j][5]);
      if (codeIndex > -1) copied[codeIndex].push(tempCopy[j]);
    }
  }
  var sheets = SpreadsheetApp.getActive().getSheets();
  for (var m = 0; m < numCodes; m++) {
    if (copied[m][0] != undefined) {
      var gensheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('123');
      gensheet.getRange(5, 1, 1500, 18).clear({contentsOnly:true});
      gensheet.getRange(5, 1, copied[m].length, copied[m][0].length).setValues(copied[m]);
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T17:09:35.667

基本问题是您正在比较对象是否相等 - 在这种情况下，您正在比较`Date`对象。即使其中两个对象表示的日期相同，对象比较也会出现错误，除非您实际上引用的是同一个*对象*。[您可以在使用 JavaScript 比较两个日期](https://stackoverflow.com/questions/492994/compare-dates-with-javascript)中了解更多信息。

这是您的脚本的一个简单更改，使用`toDateString()`，这将确保您的`codes[]`数组包含可以与 中的值进行比较的字符串值`tempCopy[j][5]`。

```
function myFunction3() {

var source = ['0AjkkHlm3kCphdGhSWnlxWmFsakZ2aFhMSHl6SlF3M1E',
                '0AjkkHlm3kCphdHY2aXpjTVJEMlFRYVBST0ZPYzNwRFE',
                '0AjkkHlm3kCphdEc5ZHFpeHVlc241SlFKWGJDeXFKLXc',
                '0AjkkHlm3kCphdG9WVjVRRnQ3RlFlcllhd1JGallXVmc'];

var ss = SpreadsheetApp.getActiveSpreadsheet();
// get start date from sheet
var sDate = ss.getSheetByName('123').getRange("B2").getValue();
// get end date from sheet
var eDate = ss.getSheetByName('123').getRange("D2").getValue();
// days between
var Dura = ss.getSheetByName('123').getRange("E1").getValue(); 

  var codes = new Array();

  for (var k = 0; k < Dura; k++){ 
      var d = new Date(sDate);
      d.setDate(d.getDate()+ k);
      codes[k] = d.toDateString(); //***** Make array of Strings, not Dates
  }

  var numCodes = codes.length;
  var copied = [];
  for (var k = 0; k < numCodes; k++) {
    copied[k] = [];
  }

//get data from external sheets for comparision
  for (var i = 0; i < source.length; i++) {
    var tempCopy = SpreadsheetApp.openById(source[i]).getSheetByName('Footfall-Format').getDataRange().getValues();
    // comparision starts
    for (var j = 4; j < tempCopy.length; j++) {  // start at 4 to skip headers
      if (typeof tempCopy[j][5] != "object") break;   // skips strings, but could improve
      // Search for String match of date from input record
      var codeIndex = codes.indexOf(tempCopy[j][5].toDateString());
      if (codeIndex > -1) copied[codeIndex].push(tempCopy[j]);
    }
  }
  // This part has bugs... each day overwrites the previous
  var sheets = SpreadsheetApp.getActive().getSheets();
  for (var m = 0; m < numCodes; m++) {
    if (copied[m][0] != undefined) {
      var gensheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('123');
      gensheet.getRange(5, 1, 1500, 18).clear({contentsOnly:true});
      gensheet.getRange(5, 1, copied[m].length, copied[m][0].length).setValues(copied[m]);
    }
  }
} 
```

正如@Serge 指出的那样，此代码中还有其他问题。

*   `d.getDate()+ k`不处理月末，所以你需要自己做。
*   `setValues()`需要调试处理输出的脚本的最后一部分。实际上，每天都会覆盖`copied[]`数组中前一天的值。我不确定你试图满足什么要求，所以我不理会它，但它需要注意。

# python - xrld python获取单元格的行列标签

> ID：13864149
> 
> 赞同：0
> 
> 时间：2012-12-13T16:25:28.760
> 
> 标签：python, excel, label, xlrd

```
thebook = open_workbook(file_to_import)
thesheet = thebook.sheet_by_index(0)
print "show that there is value in the sheet: %s" % thesheet.cell(1,1).value
print "there is nothing in thesheet.col_label_ranges:"
print thesheet.col_label_ranges

for crange in thesheet.col_label_ranges:
    rlo, rhi, clo, chi = crange
    for rx in xrange(rlo, rhi):
        for cx in xrange(clo, chi):
            print "Column label at (rowx=%d, colx=%d) is %r" \
                (rx, cx, thesheet.cell_value(rx, cx)) 
```

我正在尝试获取特定单元格的行和列标签，并且我找到了循环遍历我在上面使用的 col_label_ranges 的代码。但是，当我运行此代码时，我得到的结果是：

```
show that there is value in the sheet: Katherine
there is nothing in thesheet.col_label_ranges:
[] 
```

请告诉我出了什么问题，我应该怎么做才能读取单元格的行和列标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:30:07.860

所以`.col_label_ranges`是空的 - 你真的有任何标签名称吗？一切都意味着你没有。

请注意 xlrd 提及的文档：

> 包含列标签的单元格的地址范围列表。这些是通过插入 > 名称 > 标签 > 列在 Excel 中设置的。

# eclipse - 如何将服务器添加到 RallyDev Eclipse 插件

> ID：13864154
> 
> 赞同：1
> 
> 时间：2012-12-13T16:25:44.877
> 
> 标签：eclipse, plugins, rally

我正在使用 RallyDev eclipse 插件。如何将服务器添加到“添加任务存储库服务器”下拉列表？我们在自己的服务器上运行 Rally，但我无法添加服务器。

我正在使用 Eclipse Juno 和 Rally 插件 3.4 版。

![添加任务存储库屏幕截图](../Images/bf0a33169bb209b3d5eb614319d7294a.png)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:25:44.877

1.  导航到您的 Eclipse 安装目录。
2.  进入“插件”目录并找到 Rally 插件的目录。对我来说，目录被命名为`com.rallydev.mylyn.ui_1.5.11.201207192017`
3.  在您选择的编辑器中打开 plugin.xml 文件。并添加以下内容：

    ```
    <plugin>
         ...
         <extension point="org.eclipse.mylyn.tasks.core.templates">
          ...
             <repository
                label="[However you want to label your server]"
                repositoryKind="rally"
                urlRepository="https://uri/to/your/server/">
             </repository>
          ...
       </extension>
    </plugin> 
    ```

4.  保存文件。如果 Eclipse 已经在运行，则关闭它。请注意，我说的是“关闭”而不是“重启”。
5.  在命令提示符/终端导航到您的 Eclipse 安装目录。
6.  使用 arg -clean 从命令行启动 eclipse。例如：C:\eclipse\eclipse.exe -clean

在您下次尝试添加 Rally Task Repo 时，您将在服务器下拉列表中看到您的标签。您可能需要根据安装的 ALM 调整您的“urlRepository”。您将知道您需要调整 URL，因为“验证设置”将失败。只需确保在任何 plugin.xml 修改后使用 -clean 参数从命令行重新启动即可。

![plugin.xml 修改后截图](../Images/f326edcd632b0157f7e761a33153a6ff.png)

# redirect - 如何拦截错误请求并重定向到自定义页面？

> ID：13864162
> 
> 赞同：1
> 
> 时间：2012-12-13T16:26:00.397
> 
> 标签：redirect, error-handling, liferay, liferay-6

这是我想做的用例之一：

1.  用户单击博客链接或直接将博客链接粘贴到 URL
2.  博客 portlet 位于社区（站点）的私有页面上。
3.  由于用户不是社区（站点）的成员，他将被带到错误页面。
4.  显示的是 404 页面或 No-access 错误页面。
5.  **我的要求开始：**现在而不是显示上述页面或上述页面的自定义版本。
6.  我想拦截 404 请求或其他此类请求。
7.  并根据用户的一些参数和初始请求参数重定向到一个门户页面（不是静态错误页面）。
8.  在这种情况下，我希望用户被重定向到同一社区（站点）的任何公共页面，并要求他加入或请求该社区（站点）的成员资格。

所以简而言之，我想要一种方法来拦截产生错误的请求，然后重定向到我想要的任何地方。

这在liferay中可用吗？如果没有，我可以了解如何实现这一目标吗？

**环境：** Liferay 6.1 GA2

感谢您宝贵的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:22:05.503

添加一个`JSP`页面来管理 404 错误，如[Liferay 的论坛帖子中](http://www.liferay.com/community/forums/-/message_boards/message/11279934)所述。

在那里，`JSP`您可以根据可以从 JSP 内部访问的任何参数（用户、社区等）放置自定义逻辑，例如，使用`themeDisplay`对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T08:00:40.623

另一种方法（以及我将 404 错误重定向到社区中特定页面的方法）是使用 Hook 覆盖 404.jsp。然后将您的自定义逻辑添加到覆盖的 JSP。

我假设可以为禁止访问做类似的事情。

# c++ - 初学者：循环单链表的第一个程序，

> ID：13864164
> 
> 赞同：0
> 
> 时间：2012-12-13T16:26:01.240
> 
> 标签：c++, linked-list, doubly-linked-list

它只返回一个地址，没有任何调试器错误，尽管我的 DEV C++ 和 Code::Blocks 编译器都显示发送不发送 Windows 错误，但它们只初始化类对象，我已经包含了代码，谁能告诉我为什么会发生

```
#include <iostream>
#include <conio.h>
using namespace std;
struct Node
{
    int data;
    Node *nextptr;
};

class CLLIST{

private:

     Node*firstptr;
     Node*lastptr;

public:
     CLLIST(){

     cout << "Constructor Called !";
      firstptr=lastptr=NULL;
}

void insert_at_back(int val){

         if(firstptr==NULL) //it means start of C.LIST
         {
             Node*temptr = new Node; //means firstptr = temptr
             firstptr->data=val;
             firstptr=temptr;
             firstptr->nextptr=firstptr;
         } else{

             Node*temp1 = new Node;
             Node*temp2 = new Node;

             temp1 = firstptr;
             while(temp1->nextptr!=firstptr) //traversing
             {
                 temp2 = temp1->nextptr;
                 temp2->data = val; //inserted at back
                 temp2->nextptr=firstptr; //circle completed
             }
         }
}

void printit(){

           // functiont o print all the circular link lists data
           Node*temp3ptr= new Node;
           temp3ptr = firstptr;

           while(temp3ptr->nextptr!=firstptr)//traversing
           {
              cout << temp3ptr->data;
              cout << endl;
           }
}
};

  int main()
  {
    CLLIST obj1;

    obj1.insert_at_back(10);
    obj1.insert_at_back(20);
    obj1.insert_at_back(30);

    obj1.printit();

    cout << "Done !";

    getch();
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:30:36.393

您当前代码的一些问题（可能还有更多，但您应该首先专注于解决这些问题）

* * *

**问题 1**：

```
 if(firstptr==NULL) //it means start of C.LIST
         {
             Node*temptr = new Node; //means firstptr = temptr
             firstptr->data=val;
             firstptr=temptr;
             firstptr->nextptr=firstptr;
         } else{ 
```

^ 与`firstptr->data=val;`您一起取消引用`firstptr`，即使它仍然是`NULL`. 交换它和下一行，这样它就变成了：

```
 if(firstptr==NULL) //it means start of C.LIST
         {
             Node*temptr = new Node; //means firstptr = temptr
             firstptr=temptr;
             firstptr->data=val;
             firstptr->nextptr=firstptr;
         } else{ 
```

或者更好`firstptr = new Node;`的做法是：直接跳过`temptr`

* * *

**问题 2**：

```
 Node*temp1 = new Node;
     Node*temp2 = new Node;

     temp1 = firstptr;
     while(temp1->nextptr!=firstptr) //traversing
     {
         temp2 = temp1->nextptr;
         temp2->data = val; //inserted at back
         temp2->nextptr=firstptr; //circle completed
     } 
```

^ 这是内存泄漏；`new`在堆上为它们分配内存，当您将临时节点分配给指向`firstptr`. 只需声明`temp1`，`temp2`而是：

```
 Node*temp1;
     Node*temp2; 
```

* * *

**问题 3**：

```
 while(temp1->nextptr!=firstptr) 
```

^ 这个while循环永远不会运行，因为：

*   你从`firstptr`null开始
*   然后添加一个节点，并`firstptr->next`指向`firstptr`.
*   然后，当您尝试添加第二个节点时，它会执行分配的工作`temp1 = firstptr;`，但不会运行 while 循环，因为`firstptr->next == firstptr`

* * *

**问题 4**：

正如@aleguna 指出的那样：

```
 Node*temp3ptr= new Node;
       temp3ptr = firstptr; 
```

^ 这是另一个内存泄漏，原因与问题 2 中所述相同。只需声明`temp3ptr`：

```
 Node*temp3ptr; 
```

* * *

**问题 5**：

```
 while(temp3ptr->nextptr!=firstptr)//traversing
       {
          cout << temp3ptr->data;
          cout << endl;
       } 
```

^ 在这里，您需要一种实际迭代循环链表的方法，现在它只是重复打印第一个节点（好吧，从技术上讲，您的代码的其他部分还不允许您将第二个节点添加到链表中，要么)

就像是：

```
 while(temp3ptr->nextptr!=firstptr)//traversing
       {
          cout << temp3ptr->data;
          cout << endl;
          // Can technically do it without the if-check since this
          // is circular, but better to code defensively.
          if (temp3ptr->next != NULL) {
              temp3ptr = temp3ptr->next;
          }
       } 
```

# javascript - 如何从 Json 结果中获取值

> ID：13864165
> 
> 赞同：0
> 
> 时间：2012-12-13T16:26:09.227
> 
> 标签：javascript, ajax, json, extjs4

这是我从控制器得到的 json 结果

```
{"data":"Sunday"} 
```

数据可以说一周中的任何一天（周日，周一等......）

成功后我想在 ajax 调用中执行此操作

```
success: function(Response){
        var myresponse = Response.data;
        alert(myresponse);
} 
```

但是，它给了我不确定的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:34:55.617

如果您确定从服务器获得 JSON 响应，则可以使用[Ext.JSON](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.JSON)类来解码 JSON。

您可以使用该`decode()`方法将字符串转换为对象。然后您应该能够轻松访问它。

例子：

```
var jsonObject = Ext.JSON.decode(Response.responseText);
var myData = jsonObjet.data; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:39:33.120

如果您使用 jQuery 加载此字符串，您可以使用[$.getJSON](http://api.jquery.com/jQuery.getJSON/)自动解析字符串并将对象作为返回值传递给“成功”函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:30:09.637

尝试使用

```
console.log(Response); 
```

检查响应的内容

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:31:16.253

它可能将您的响应视为字符串。我会做这样的事情：

```
success: function(Response){
        alert(typeof Response);
        var myresponse = Response.data;
        alert(myresponse);
} 
```

如果它告诉您 Response 是字符串，您需要确保您的框架知道您正在返回 JSON。例如，对于 jquery，它可能是 $.getJSON()。

# python - 如何在 Python 中创建映射（关联子数组）的列表（数组）

> ID：13864169
> 
> 赞同：1
> 
> 时间：2012-12-13T16:26:28.573
> 
> 标签：python, list, dictionary, python-2.7, mapping

我是 Python 的一个 n00b 并且正在尝试将我从 shell 和 PHP 脚本中获得的一点点知识带到 Python 中。我真的试图掌握创建和操作其中的值的概念（同时保持代码以可理解的形式）。

我无法使用 LISTS 和 MAPPINGS ( dict() ) 的 Python 实现。我正在编写一个脚本，该脚本需要在基本数组（Python 列表）中使用关联数组（python 映射）。该列表可以使用典型的 INT 索引。

谢谢！

这是我目前拥有的：

```
'''  Marrying old-school array concepts
[in Python verbiage] a list (arr1) of mappings (arr2)
[per my old-school training] a 2D array with 
        arr1 using an INT index
        arr2 using an associative index
'''
arr1 = []
arr1[0] = dict([    ('ticker'," "),
                        ('t_date'," "),
                        ('t_open'," "),
                        ('t_high'," "),
                        ('t_low'," "),
                        ('t_close'," "),
                        ('t_volume'," ")
                        ] )
arr1[1] = dict([    ('ticker'," "),
                        ('t_date'," "),
                        ('t_open'," "),
                        ('t_high'," "),
                        ('t_low'," "),
                        ('t_close'," "),
                        ('t_volume'," ")
                        ] )

arr1[0]['t_volume'] = 11250000
arr1[1]['t_volume'] = 11260000

print "\nAssociative array inside of an INT indexed array:"
print arr1[0]['t_volume'], arr1[1]['t_volume'] 
```

在 PHP 中，我有以下示例工作：

```
'''
arr_desired[0] = array( 'ticker'        => 'ibm'
                            't_date'        => '1/1/2008'
                            't_open'        => 123.20
                            't_high'        => 123.20
                            't_low'     => 123.20
                            't_close'   => 123.20
                            't_volume'  => 11250000
                        );
arr_desired[1] = array( 'ticker'        => 'ibm'
                            't_date'        => '1/2/2008'
                            't_open'        => 124.20
                            't_high'        => 124.20
                            't_low'     => 124.20
                            't_close'   => 124.20
                            't_volume'  => 11260000
                        );

print arr_desired[0]['t_volume'],arr_desired[1]['t_volume'] # should print>>> 11250000 11260000
''' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:31:18.607

您的 list 和 dict 文字定义可以大大简化：

```
keys = ['ticker', 't_date', 't_open', 't_high', 't_low', 't_close', 't_volume']
arr1 = [
    dict.fromkeys(keys, ' '),
    dict.fromkeys(keys, ' ')
] 
```

我正在使用该[`dict.fromkeys()`](http://docs.python.org/2/library/stdtypes.html#dict.fromkeys)方法用一系列键初始化字典，所有键都具有给定的默认值（一个空格字符串）。

在 Python 中定义空列表时，不能简单地寻址不存在的元素。或者，使用该`.append()`方法将*新*元素添加到列表中：

```
arr1.append({'key': 'value', 'otherkey': 'othervalue'}) 
```

上面的示例使用`{k: v}`dict 文字表示法。

我怀疑你会从首先阅读（优秀的）[Python 教程](http://docs.python.org/2/tutorial/)中受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:35:09.150

以下是我学到的，对于那些与我有相似编程背景的人：

```
arr0 = dict( [ ('one',1), ('two',2), ('three',3) ] )
for k,v in arr0.iteritems() : 
    print k,v           #prints the associative array key with the value

keys = ['ticker','t_open','t_high','t_low','t_close','t_volume']
arr1 = [
            dict.fromkeys(keys,' '),
            dict.fromkeys(keys,' ')
        ]

arr1[0]['t_volume'] = 11250000
arr1[1]['t_volume'] = 11260000
arr1.append( {'ticker' : 'ibm', 't_date' : '1/2/2008', 't_volume' : 11270000} )
arr1.insert(3, {'ticker' : 'ibm', 't_date' : '1/3/2008', 't_volume' : 11280000} )

print "\nAssociative array inside of an INT indexed array:"
print arr1[0]['t_volume'], arr1[1]['t_volume']
print "\n ",arr1[2]
print arr1[2]['t_volume'], arr1[3]['t_volume'] 
```

注意元素（值）添加逻辑。

# authentication - Symfony 根据请求延长身份验证超时

> ID：13864173
> 
> 赞同：0
> 
> 时间：2012-12-13T16:26:46.680
> 
> 标签：authentication, symfony, security

我的想法是 Symfony2 将扩展`ExpireAt`在经过身份验证的会话期间发出的每个页面请求。因此，如果超时为 100 秒并且您发出了页面请求，则新的`ExpireAt`将是`time() + 100`. 这种“使用或丢失”身份验证功能类似于您在银行网站上获得的功能。

默认功能似乎是当会话超时设置为`100`时`config.yml`，用户只有 100 秒的时间来做他们可以做的事情。

我认为这不会很难实施，但应该在哪里完成？我的第一个猜测是`isEqualTo`方法。一旦您可以确定用户是真实的，您就可以重新启动他们的`expireAt`. 还是需要修改cookie？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:58:00.443

答案在于 的`refreshUser`方法`UserProvider`和 的`isEqualTo`方法`UserClass`。

该`isEqualTo`方法告诉用户提供者是否要`refreshUser(UserInstance user)`.

*   **Step1** : `isEqualTo() returns false;`(随着你的理解的增长，这个逻辑也可以。但本质上，这会触发`refreshUser()`.

在所有基本用户提供程序示例中，`refreshUser`&`loadUserByUsername`是相同的。做我所说的，`refreshUser()`需要有点不同。

*   **Step2**：修改`refreshUser(UserInterface $user)`。传递给这个方法的是原始的 userClass。所以 refreshUser 负责同步`expiresAt`or`credentialsExpireAt`

我在我的使用此逻辑`refreshUser()`来延长到期日期或将其设置为原始到期日期（已过期）：

```
 if( time() > $user->getCredentialsExpireAt() ){
        $refreshedUser->setCredentialsExpireAt( $user->getCredentialsExpireAt() );
    } 
```

# multithreading - 在非 JavaFX 应用程序线程上创建新工具提示

> ID：13864182
> 
> 赞同：2
> 
> 时间：2012-12-13T16:27:08.033
> 
> 标签：multithreading, tooltip, javafx

有没有办法在不是“JavaFX 应用程序线程”的线程中创建 javafx.scene.control.Tooltip？

由于性能原因，我在一个线程中准备了一些视觉元素并将它们保存在内存中。当我需要它们时，我会使用 Application Thread 来展示它们。但是 new Tooltip() 似乎只需要应用程序线程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:00:19.230

> 有没有办法在不是“JavaFX 应用程序线程”的线程中创建 javafx.scene.control.Tooltip？

对于 JavaFX 2.2 - 否。

请参阅此 JavaFX 问题跟踪器 ticket：[无法设置 FXApplicationThread 的 Tab （和其他控件）的工具提示](http://javafx-jira.kenai.com/browse/RT-25127)。

票证中有一个建议的解决方法，用于在[Platform.runLater](http://docs.oracle.com/javafx/2/api/javafx/application/Platform.html#runLater%28java.lang.Runnable%29)调用中创建[工具提示。](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Tooltip.html)

```
package fxthread_25127_wrongthread;

import javafx.application.Application;
import javafx.application.Platform;
import javafx.scene.control.Tooltip;
import javafx.stage.Stage;
/**
 *
 * @author mickf
 */
public class Main extends Application {
    Tooltip tooltip;

    public static void main(String[] args) {
        Application.launch(args);
    }
    @Override public void init() throws Exception {
        Platform.runLater(new Runnable() {
            @Override public void run() {
                tooltip = new Tooltip("Top tip : use runLater()");
            }
        });
        /*
         * this will cause an ISE
         */
        //tooltip = new Tooltip("flip");
    }
    @Override public void start(Stage s) {
        System.exit(0);
    }
} 
```

关于 Platform.runLater 如何从它的 javadoc 工作的描述：

> 在未来某个未指定的时间在 JavaFX 应用程序线程上运行指定的 Runnable。此方法可以从任何线程调用，它将 Runnable 发布到事件队列，然后立即返回给调用者。Runnables 按照它们发布的顺序执行。传递给 runLater 方法的 runnable 将在传递给后续调用 runLater 的任何 Runnable 之前执行。

# .net - 等待（）子引起哔哔声

> ID：13864183
> 
> 赞同：0
> 
> 时间：2012-12-13T16:27:10.227
> 
> 标签：.net, vb.net

执行等待计时器时，我的潜艇发出哔哔声。哔声发生在 doevents 上，并且似乎只在第一次调用 sub 时发生（所以在第一次等待时）。这听起来像一个消息框弹出哔哔声。有没有人有任何想法？

```
Private Sub wait(ByVal interval As Integer)

    Dim stopW As New Stopwatch
    stopW.Start()
    Do While stopW.ElapsedMilliseconds < interval
        ' Allows your UI to remain responsive and apparently is causing beeping
        My.Application.DoEvents() ' I get a beep when this line is executed
    Loop
    stopW.Stop()
End Sub 
```

# c# - 在 wcf 中将大量数据 [object-Serialized] 从客户端发送到服务器

> ID：13864187
> 
> 赞同：0
> 
> 时间：2012-12-13T16:27:22.397
> 
> 标签：c#, wcf

当序列化字符串从 wcf 客户端发送到 wcf 服务时，发生以下异常：通信异常：

> 接收对 的 HTTP 响应时出错`http://localhost:#####/SeriveName.svc`。这可能是由于服务端点绑定未使用 HTTP 协议。这也可能是由于服务器中止了 HTTP 请求上下文（可能是由于服务关闭）。有关更多详细信息，请参阅服务器日志。

注意：依次序列化的对象包含被序列化的属性 [Heirarchical serialization]

# html - 使网页上的每个 Unicode 字符具有相同的宽度

> ID：13864194
> 
> 赞同：1
> 
> 时间：2012-12-13T16:27:41.507
> 
> 标签：html, unicode, fonts

我需要以下两个 Unicode 字符才能在网页中具有相同的宽度：▼ (▼) 和 ▶ (▶)

`font-family: monospace;` 没有帮助，他们仍然得到不同的宽度（Windows 8，Firefox 17）：

![显示等宽问题的屏幕截图](../Images/815c0ce5226de25aa7949817a85772e8.png)

有没有办法让页面上的每个（不仅是普通字母）字符都具有相同的宽度？

示例源代码：

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>7
  <body>
    <h1 style="font-family: monospace;">
      &#9660;test 
      <br>
      &#9654;test
    </h1>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:32:30.947

将这两个字符放在另一个标签（如`<span>`）中，并使用 CSS 给它一个固定的宽度。像这样（[工作示例](http://jsfiddle.net/jhogervorst/FaUMJ/)）：

```
<span style="display: inline-block; width: 30px;">&#9660;</span>test 
<br>
<span style="display: inline-block; width: 30px;">&#9654;</span>test 
```

* * *

或者选择一种我认为会更体面的纯 CSS 方法（[工作示例](http://jsfiddle.net/jhogervorst/Eyc4X/)）：

```
<span class="opened">test</span>
<br>
<span class="closed">test</span> 
```

和CSS代码：

```
.opened::before {
    display: inline-block;
    content: "▼";
    width: 30px;
}

.closed::before {
    display: inline-block;
    content: "▶";
    width: 30px;
} 
```

# sinatra - 如何：DataMapper 中的单表继承？

> ID：13864199
> 
> 赞同：0
> 
> 时间：2012-12-13T16:27:54.520
> 
> 标签：sinatra, single-table-inheritance, sti, ruby-datamapper, sqlite3-ruby

我正在学习**Sinatra** (1.3.2) 并选择使用**DataMapper** (1.2.0) 作为 ORM 和内存中的**SQLite** (1.3.6) DB 来启动。和
两个模型共享大多数属性，因此我考虑在 DataMapper 中为 STI（**单表继承）声明一个模型。**阅读[文档，多亏了](http://datamapper.org/docs/misc.html)[Types::Discriminator](http://rubydoc.info/github/datamapper/dm-core/master/DataMapper/Property/Discriminator)，这似乎是小菜一碟。`Books``Downloads`

 **我将所有常见的抽象为`DownloadableResource`：

```
class DownloadableResource
  include DataMapper::Resource

  property :id,           Serial
  property :created_at,   DateTime
  property :modified_at,  DateTime
  property :active,       Boolean,  default: true

  property :position,     Integer

  property :title,        String,   required: true
  property :url,          URI,      required: true
  property :description,  Text,     required: true

  property :type,         Discriminator
end 
```

按照[示例](http://datamapper.org/docs/misc.html)，我认为它就像指定需要扩展的内容一样简单：

```
class Book < DownloadableResource
  property :cover_url,    URI
  property :authors,      String,   required: true, length: 255
end 
```

和

```
class Download < DownloadableResource
  property :icon_url,     URI
end 
```

但这给了我以下错误：

> DataObjects::SyntaxError:**重复列名: id** (code: 1, sql state: , query: ALTER TABLE " **downloadable_resources** " ADD COLUMN "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, uri: sqlite3::memory:?scheme=sqlite&user= &password=&host=&port=&query=&fragment=&adapter=sqlite3&path=:memory:)

在删除 id 时产生另一个（明显的）错误：

> DataMapper::IncompleteModelError: DownloadableResource 必须有一个有效的键

我通过添加`include DataMapper::Resource`两个`Book`and来解决这个问题`Download`，然后`Book`需要一个有效的密钥，现在看起来像这样：

```
class Book < DownloadableResource
  include DataMapper::Resource

  property :id,           Serial

  property :cover_url,    URI
  property :authors,      String,   required: true, length: 255
end 
```

也一样`Download`，但现在的问题是：

> DataObjects::SyntaxError：**重复列名：id**（代码：1，sql state：，查询：ALTER TABLE " **books** " ADD COLUMN "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT，uri: sqlite3::memory:?scheme=sqlite&user= &password=&host=&port=&query=&fragment=&adapter=sqlite3&path=:memory:)

开始觉得我在绕圈子，在 DataMapper 中实现单表继承的正确方法是什么？

* * *

PS：我看过

*   [DataMapper - 单表继承](https://stackoverflow.com/q/8858451/341929)和
*   [Ruby Datamapper 表继承与关联](https://stackoverflow.com/q/1829161/341929)

但我仍然有这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:33:36.313

我会推荐这种方法：

```
module DownloadableResource

  def self.included base
    base.class_eval do
      include DataMapper::Resource

      property :created_at,   DateTime
      property :modified_at,  DateTime
      property :active,       base::Boolean,  default: true

      property :position,     Integer

      property :title,        String,   required: true
      property :url,          base::URI,      required: true
      property :description,  base::Text,     required: true

      property :type,         base::Discriminator
    end
  end
end

class Book
  include DownloadableResource
  property :id, Serial
  # other properties
end

class Download
  include DownloadableResource
  property :id, Serial
  # other properties
end 
```**

# javascript - JS：如何创建可选的可链接方法

> ID：13864202
> 
> 赞同：1
> 
> 时间：2012-12-13T16:28:13.817
> 
> 标签：javascript, method-chaining

JS新手问题在这里：

假设我有一些简单的字符串操作方法，比如这些愚蠢的例子：

```
var prepend = function(str) {
  return 'foo ' + str
};

var exclaim = function(str) {
  return str + '!'
} 
```

现在，我可以像这样使用这些：

```
var string = prepend('bar'); // 'foo bar'
string = exclaim(string); // 'foo bar!' 
```

但是，我认为如果我还可以（*可选*）使这些方法可链接起来，那就太好了，所以我也可以执行以下操作：

```
var string = "foo"
string.prepend().exclaim() 
```

...我仍然会得到`"foo bar!"`我的结果。

如果我也可以将可选参数传递到这个链中，那就更好了，比如：

```
var exclaim = function(string,char="!") {
  return string + char
}; 
```

所以，我的问题是：

1.  如此基本，但我是否正确描述了这一点？可以这样链接的方法叫什么？而且，您将链中前一个方法的返回称为什么，这个下一个方法将操作的东西？

2.  如何将变量设置为链中前一个方法的返回，或者作为参数提供？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:30:14.847

如果要链接它们，则必须将这些方法添加到字符串原型中：

```
String.prototype.prepend = function() {
  return 'foo ' + this
};

String.prototype.exclaim = function() {
  return this + '!'
}

var s = "".prepend().exclaim();
console.log(s); 
```

[演示](http://jsfiddle.net/B76F3/)

* * *

WRT 可选参数，您可以利用在 JavaScript 中，您可以在不为某些参数传递值的情况下调用方法。那些未传递的参数将显示`undefined`在函数中。由于`null`隐式转换为`undefined`，因此通常通过检查这些参数是否为 null 来处理

```
var exclaim = function(str, ch) {
  if (ch == null){
      ch = '!';
  }
  return string + ch
}; 
```

你也会经常看到这样的东西：

```
var exclaim = function(str, ch) {
  ch = ch || '!';
  return string + ch
}; 
```

这很相似，但会覆盖6 个“虚假”值中的**任何**`null`一个： 、`undefined`、`NaN`、`0`和`false`（`''`空字符串）。因此，如果您这样做，并尝试为 ch 传递一个空字符串，它将被覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:32:50.130

你可以这样做：

```
 var string = exclaim(prepend('bar')); 
```

或者您可以扩展 String 对象，以便可以使用 .prepend() 和 .exclaim() 语法：

```
 String.prototype.prepend = function() {
       return 'foo ' + this
  };

  String.prototype.exclaim = function() {
      return this + '!'
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:30:04.770

要使用可链接的方法，您应该返回包含该方法的对象的实例。在大多数情况下，您会返回*`this`*.

例如看这个`MyString`类

```
function MyString(s){
   this.str = s;
}
MyString.prototype.lower=function(){
   this.str = this.str.toLowerCase();
   return this;
}
MyString.prototype.upper=function(){
   this.str = this.str.toUpperCase();
   return this;
}
MyString.prototype.last=function(x){
   return this.str.substr(-x);
}
MyString.prototype.first=function(x){
   return this.str.substr(0,x);
}

MyString.prototype.get=function(){
   return this.str;
}

var ms = new MyString("Hello");
var s  = ms.lower().first(2); // s = 'he'; 
```

# objective-c - 不能对实例变量使用方法

> ID：13864204
> 
> 赞同：0
> 
> 时间：2012-12-13T16:28:18.967
> 
> 标签：objective-c, foundation

为什么 testVariableValues 没有方法 dictionaryWithObjectsAndKeys？

```
@property (nonatomic, strong) NSDictionary *testVariableValues; 
```

我正在尝试使用这样的方法：

```
[self.testVariableValues dictionaryWithObjectsAndKeys:......] 
```

唯一可用的方法是`[self.testVariableValues dictionaryWithValuesForKeys...`

我是 Objective C 的新手，对这个问题没有太多的想法。与实例方法有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:30:47.740

您正在混淆类方法和实例方法。

你需要打电话

```
 self.testVariableValues = [NSDictionary dictionaryWithObjectsAndKeys:obj1, @"key1"..., nil]. 
```

希望有帮助。

# c# - 在不配置 IIS 的情况下在其他 PC 中测试 Silverlight 应用程序

> ID：13864207
> 
> 赞同：0
> 
> 时间：2012-12-13T16:28:31.040
> 
> 标签：c#, silverlight, web-deployment

新手来了 我创建了一个 Silverlight 应用程序，它通过 WCF RIA 服务检索数据。现在我想在另一台电脑上测试它，所以我做了一个发布。该文件夹包含 bin、ClientBin（带有 xap）、.html、.config 等。

然后我将文件夹复制到另一个 PCe 并打开 *.html 文件

我的 silverlight 应用程序没有运行。我真的需要为另一台机器配置 IIS 并在那里部署二进制文件以查看我的 silverlight 应用程序的运行情况吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:38:02.013

如果您只想观看 Silverlight UI（不使用 WCF），当然可以使用应用程序打开 *.html 页面。但是如果您的应用程序需要 WCF 服务，则应该运行该服务。如果您的机器在域组中并且您为其中之一安装了 IIS，您可以在 Visual Studio 中的项目属性中配置使用本地 IIS 安装的开发人员 Web 服务器，然后您应该更新服务引用，然后您可以浏览 silverlight 应用程序。从域网络中的任何计算机内。

# java - 使用 CharAt() 检查多个字符

> ID：13864209
> 
> 赞同：1
> 
> 时间：2012-12-13T16:28:35.580
> 
> 标签：java

我正在努力使用 charAt 方法。我想知道的是，当您使用 charAt 时，您是否可以在参数中使用多个数字，以便您在一种方法中查看多个字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:51:11.123

不，没有普通的 JavaScript 方法。但是，您总是可以编写一个原型化 String 对象的方法：

```
String.prototype.charsAt = function(indexes) {
    var returned = [ ];
    for(var i = 0; i < indexes.length; i++)
    {
        returned.push(this.charAt(indexes[i]));        
    }
    return returned;
} 
```

然后，您可以使用以下方法调用它：

```
var text = 'mystring';
alert(text.charsAt([0, 1])); 
```

您可以在此处查看工作演示 > [http://jsfiddle.net/MDNRS/](http://jsfiddle.net/MDNRS/)。正如其他人所说，这真的完全是微不足道的，因为你应该使用`substr()`或其他方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:46:59.553

从[javadoc](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)：

> 字符
> 
> public char charAt(int index)
> 
> 返回指定索引处的 char 值。索引范围从 0 到 length() - 序列的第一个 char 值在索引 0 处，下一个在索引 1 处，依此类推，与数组索引一样。

如果您需要其他东西，您可以使用它`toCharArray()`来访问底层证券`char[]`并做您需要的事情

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-25T04:55:52.120

看起来您对方法[charat(int index)](http://javatutorialhq.com/java/lang/string-class-tutorial/charat-method-example/)的理解有点偏离。调用此方法只是为了获取指定索引处的单个字符。

如果您正在寻找搜索特定字符序列，您可能需要查看 String 类的[contains(CharSequence cs)](http://javatutorialhq.com/java/lang/string-class-tutorial/contains-method-example/)方法。

参考：

[Java API](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)

# php - “未声明 HTML 文档的字符编码”问题

> ID：13864211
> 
> 赞同：5
> 
> 时间：2012-12-13T16:28:41.883
> 
> 标签：php, html, character-encoding, meta-tags

我制作了一个用户可以填写的表格，它会检查用户是否正确插入了电子邮件。

*   如果它返回 false：用户将看到一条错误消息。
*   如果它返回 true：它将向用户显示一条确认消息，但它也会`INSERT`将数据存入数据库。

因此，当我尝试在 PHP 文件中添加表单时出现问题，以便我可以发出警报或在同一页面上向用户提供错误消息。我开始收到此错误：

> 未声明 HTML 文档的字符编码。如果文档包含 US-ASCII 范围之外的字符，则文档将在某些浏览器配置中呈现乱码。页面的字符编码必须在文档或传输协议中声明。

所以我试图通过恢复到旧版本来恢复它，我不得不剪切和粘贴几段代码，但没有太复杂。出于某种奇怪的原因，我仍然收到此错误。自然地，我在 Stackoverflow 上查看了关于这个问题的类似主题，但没有一个答案让我更进一步。例如`meta`在页面标题中添加信息，我还创建了一个这样的 PHP 标题：`header('Content-type: text/html; charset=utf-8');`之后我阅读了一些关于这个错误的文章，但没有一个帮助我解决这个问题。

这是我的代码示例。正是这个页面我得到了错误：

```
 <?php    
include_once('credentials.php');
mysql_connect($host, $user, $pass) or die(mysql_error());
mysql_select_db($db) or die(mysql_error());
include_once('functions.php');

 $apples = sanitize($_POST['Apple']);
 $oranges = sanitize($_POST['Orange']);
 $melons = sanitize($_POST['Melon']);
 $pears = sanitize($_POST['Pear']);
 $strawberries = sanitize($_POST['Strawberry']);
 $grapes = sanitize($_POST['Grape']);               
    if($_POST['Grape'] == 'Yes')
    { $grapes = 1; }
    else
    { $grapes = 0; } 
$blueberries = sanitize($_POST['Blueberry']);

if (checkStrawberries($strawberries) == true) {    
    mysql_query("   INSERT INTO tablename (Name, Weight, Color, Ripeness, Age, Origin, Destination) 
            VALUES ('$apples', '$oranges', '$melons', '$Pears', '$strawberries', '$grapes', '$blueberries') ");

    or die(mysql_error()); 

    echo '<!DOCTYPE html>   
            <html>
                <head>
                    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
                </head>
                <title>Page</title>
                <body>
                    True
                    <a href="../index.php">home</a>
                </body>
            </html>';
} else {
    echo '<!DOCTYPE html>   
            <html>
                <head>
                    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
                </head>
                <title>Pagina</title>
                <body>
                    False
                    <a href="../index.php">home</a>
                </body>
            </html>';
}
?> 
```

我不得不重命名变量和类，因为它们与我工作的公司关系密切。

**编辑**：此错误是由使用 Firebug 的 Firefox 中的控制台日志产生的。

**编辑 2**：更改了 var 和函数名称以避免混淆并说明此应用程序中的数据交换。

**编辑 3**：我试图弄清楚我的代码中究竟是什么产生了这个错误，因为我使用 Dobromir Velev 下面提供给我的测试用例测试了编码部分，并且效果很好。我决定注释掉 IF ELSE 语句并且我没有收到错误。所以这似乎破坏了页面。

**我现在删除了回声，因为它没有为这个特殊的挑战增加任何价值。**

```
if (checkStrawberries($strawberries) == true) {    
    mysql_query("INSERT INTO tablename (Name, Weight, Color, Ripeness, Age, Origin, Destination) 
    VALUES ('$apples', '$oranges', '$melons', '$Pears', '$strawberries', '$grapes', '$blueberries') ");
    or die(mysql_error());
} else {
    echo 'FALSE';
} 
```

函数 checkStrawberries 是这样的：

```
function checkEmail($email) {
if (!preg_match("/^( [a-zA-Z0-9] )+( [a-zA-Z0-9\._-] )*@( [a-zA-Z0-9_-] )+( [a-zA-Z0-9\._-] +)+$/" , $email)) {
return false;
}
return true;
} 
```

清理功能是这样的：

```
function sanitize($dirty){
$clean = htmlspecialchars($dirty);
$cleaner = mysql_real_escape_string($clean);
return $cleaner;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:57:05.743

我会先尝试一个包含 HTTP 标头和元标记的文件。

```
<?php
header("Content-Type: text/html; charset=utf-8");
?>

<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
</head>
<body>
text
</body>
</html> 
```

如果这不会触发错误，则可能是您的代码中的某些内容。例如，`<?php`标签前的空格会阻止 PHP 设置 HTTP 标头。此外，如果包含文件 file1.php 或 file2.php 返回任何内容，则可能会导致浏览器错误地检测到编码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T13:07:14.217

经过对PHP聊天的一些讨论，问题似乎来自额外的分号

从 ：

```
mysql_query(); or die(); 
```

到 ：

```
mysql_query() or die(); 
```

# java - 如何在 iText pdf 中旋转 JFreeChart

> ID：13864220
> 
> 赞同：0
> 
> 时间：2012-12-13T16:28:56.203
> 
> 标签：java, pdf, awt, itext, jfreechart

我创建了一个 servlet 来处理将 JSP 中显示的 JFreeChart 保存到 PDF 文件。到目前为止我使用的代码是：

```
import java.awt.Graphics2D;
import java.awt.geom.Rectangle2D;
import java.io.IOException;
import java.io.OutputStream;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.jfree.chart.JFreeChart;
import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Rectangle;
import com.lowagie.text.pdf.DefaultFontMapper;
import com.lowagie.text.pdf.PdfContentByte;
import com.lowagie.text.pdf.PdfTemplate;
import com.lowagie.text.pdf.PdfWriter;

public class ChartPrintServlet extends HttpServlet {

    private static final long serialVersionUID = -2445101551756014281L;

    protected void doPost ( HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException
    {
        JFreeChart jFreeChart = (JFreeChart) request.getSession().getAttribute("jFreeChart");
        String url = "";
        int height = 1024;
        int width = 1152;

        if (jFreeChart == null) 
        {
            url = "/do/error";
            RequestDispatcher dispatcher = getServletContext().getRequestDispatcher(url);
            dispatcher.forward(request, response);
        }
        else
        {

            AbsencesGanttChartPostProcessor postProc = new AbsencesGanttChartPostProcessor();
            postProc.processChart(jFreeChart, null);
            response.setContentType("application/pdf");
            response.setHeader("Content-Disposition", "attachment; filename=\"absences.pdf\"");
            OutputStream out = response.getOutputStream();

            try
            {   
                Rectangle pagesize = new Rectangle(width, height);
                Document document = new Document(pagesize.rotate(), 30, 30, 30, 30);
                PdfWriter writer = PdfWriter.getInstance(document, out);
                document.open();
                PdfContentByte cb = writer.getDirectContent();
                PdfTemplate tp = cb.createTemplate(height, width);
                Graphics2D g2 = tp.createGraphics(height, width, new DefaultFontMapper());

                Rectangle2D r2D = new Rectangle2D.Double(0, 0, height, width);
                jFreeChart.draw(g2, r2D);
                g2.dispose();
                cb.addTemplate(tp, 0, 0);
                document.close();
            }
            catch (DocumentException de) 
            {
                System.err.println(de.getMessage());
            }
            finally
            {
                out.close();
            }
        }
    }

    protected void doGet ( HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException
    {
        doPost(request, response);
    }
} 
```

我已经在各处交换了高度和宽度，以使 PDF 看起来不错，但我真正想要的是能够像在横向模式下一样创建 PDF。

如果我尝试

```
Graphics2D g2 = tp.createGraphics(height, width, new DefaultFontMapper());
g2.rotate(90) 
```

然后 PDF 只打印一个白色的空白页。

创建 PDF 时，使用 itext / Java awt API 旋转整个文档（包括下面的 JFreeChart）的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:52:29.853

首先：您在代码中提到我的名字。我希望您改用 itextpdf。见[http://lowagie.com/itext2](http://lowagie.com/itext2)

现在回答你的问题。有一种简单的方法可以实现您想要的，也有一种更困难的方法。

在此方法中您只使用三个参数：`cb.addTemplate(tp, 0, 0);`这意味着您只希望 iText 进行翻译（上零，右零）。如果你还想要一个旋转，你需要使用有七个参数的方法，其中六个定义了变换矩阵。这是简单的代数；我在“iText in Action”一书中对此进行了解释，但我认识的大多数开发人员都不喜欢做数学，他们说这是一种困难的方法。

最简单的方法是将 tp 包装在 Image 对象中，然后旋转图像：

```
Image img = Image.getInstance(tp);
img.setRotationDegrees(90); 
```

还有`setRotation()`一种将弧度作为参数的方法。

补充笔记：

1.  不要担心 Image 类会光栅化您的内容。`PdfTemplate`包裹在一个对象`Image`中会产生一个Form XObject，它不会变成一个Image XObject。
2.  小心不要将图像旋转到“页面之外”。您可能需要考虑枢轴点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:45:07.063

您围绕左上角逆时针旋转图形，这样做会将所有内容移出绘图区域。这就是为什么你只得到空白页的原因。您还需要应用平移将图形移回绘画区域。将 y 向下平移图像的宽度：

```
 g.rotate(Math.PI / 2);
        g.translate(0, width); 
```

此外，[Graphics2D.rotate](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics2D.html#rotate%28double%29)需要弧度，而不是度数。

之后，如果您为它传递转换后的 Graphics2D，JFreeChart 应该绘制转换后的图表。

# c# - 将xy从autocad转换为纬度经度？

> ID：13864224
> 
> 赞同：1
> 
> 时间：2012-12-13T16:29:18.557
> 
> 标签：c#, type-conversion, converter, autocad

我在 autocad 中有一个文件，其中包含 24,000 个对象点，其中包括 autocad 中的 x、y 坐标...所以我将所有点导出到 txt 文件，因为我想在我的网站数据库中拥有所有这些点（我正在使用谷歌地图查看地图上的所有点）但是，问题是 x,y 点不是谷歌地图需要的正确格式......某个点的例子：

> 181447.163751433,643530.564881084

，但我需要它与纬度和经度......也许有人知道是否有一个公式可以将这个 xy poiny 更改为经度和纬度，我会用 c# 或有其他方法来做到这一点？

我没有得到任何答案，我希望有人知道......谢谢......乔丹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:08:00.583

尝试使用 Map3D 或 Civil3D。

1.  创建点 - 导入选项 - 点文件
2.  分配坐标系
3.  导出到 Google 地球或 Shp 或 SDF 或您希望的任何格式。

让我知道你怎么去。

# javascript - 如果用户等待超过 3 秒，则如何捕获用户输入文本框值，没有任何内容输入并使用 JScript 将其存储在 db 中

> ID：13864225
> 
> 赞同：0
> 
> 时间：2012-12-13T16:29:22.413
> 
> 标签：javascript

我正在开发一个应用程序，如果他停止输入超过 3 秒，我需要从文本框中捕获用户输入。意味着我们需要使用javascript捕获该文本并将其存储在mysql db中......请帮我解决这个问题？

```
 Thank you..... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:41:57.197

将事件附加到输入（例如 keyup、keydown、keypress）。在那里，您将设置一个带有回调的 setTimeout。当然，超时 ID 将存储在 var 中（例如 window.type_timeout）。setTimeout 回调将在这 3 秒不活动的情况下执行您想要的操作。

你可以从这里开始。例如（使用 jQuery）：

```
$('input').on('keyup',function(){
    if( window.type_timeout ) clearTimeout( window.type_timeout );
    window.type_timeout = setTimeout( do_stuff , 3000 , this /* extra data */ );
});

function do_stuff( input ){ /* do your stuff */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:03:19.840

使用设置超时。[W3 学校对JavaScript 计时](http://www.w3schools.com/js/js_timing.asp)有很好的参考

```
<script>
    inputSaveTimeout = null;
    function DoSomething() {
        window.clearTimeout(inputSaveTimeout);
        alert('I just did something');
    }
    function Updated(e) {
        window.clearTimeout(inputSaveTimeout);
        inputSaveTimeout = setTimeout(Save, 3000, e.value);
    }
    function Save(data) {
        alert('Saved: ' + data);
    }
</script>
<input type="text" onkeydown="Updated(this);" /><input type="button" value="Do Something" onclick="DoSomething(); return false;" /> 
```

# c# - GroupBox中TextBoxes的foreach循环以相反的顺序迭代？

> ID：13864226
> 
> 赞同：2
> 
> 时间：2012-12-13T16:29:23.970
> 
> 标签：c#, winforms, foreach

我创建了四个`TextBox`es （按此顺序：`textBox1`, `textBox2`,...）并将它们一个放在另一个下方的`GroupBox`. 然后我添加了 Click 事件：

```
private void button1_Click(object sender, EventArgs e)
{
    foreach (TextBox tb in groupBox1.Controls.OfType<TextBox>())
    {
        if (string.IsNullOrWhiteSpace(tb.Text))
        {
            Console.WriteLine(tb.Name);
        }
    }
} 
```

当我运行程序并单击`Button`（当所有`TextBox`es 为空时），这是我得到的输出：

> 文本框4
> 
> 文本框3
> 
> 文本框2
> 
> 文本框1

显然，`foreach`循环以相反的顺序迭代`GroupBox`控件。我希望它从`textBox1`to 开始，`textBox4`因为这是它们被创建并放入 groupbox 的顺序。

为什么`foreach`循环是反向的？只是好奇...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:32:41.470

控件按同一父容器中控件的 Z 顺序放置（从最顶部到最底部）。你想如何订购它们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-17T07:06:37.443

试试这个

```
foreach (TextBox txt in Controls.OfType<GroupBox>().SelectMany(g=>g.Controls.OfType<TextBox>()).ToList().Reverse<TextBox>())
        {
            //Write your logic here
        } 
```

# sql-server-2008 - SQL Server 组合结果集

> ID：13864230
> 
> 赞同：3
> 
> 时间：2012-12-13T16:29:37.340
> 
> 标签：sql-server-2008, multiple-resultsets

我正在尝试将两个不同查询的结果集组合成一个结果集。这是否可能*不*使用存储过程，也许使用 WITH 关键字？

举个例子：

```
SELECT * FROM student WHERE graduation_year = 2013 -- returns 140 rows
SELECT * FROM student WHERE graduation_year = 2014 -- returns 130 rows 
```

请忽略此处建议 OR 的明显解决方案，因为我忽略了复杂的动态约束，只是为了说明我的观点。

我想分别从每个查询中获取结果**并将**它们组合成一个结果集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:34:42.190

您可以`UNION ALL`在两个查询之间使用 a：

```
SELECT *, '2013' Source
FROM student 
WHERE graduation_year = 2013 
UNION ALL
SELECT *, '2014' Source
FROM student 
WHERE graduation_year = 2014 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c98e3/1)

如果您需要识别该行来自哪个数据集，我添加了一个名为 source 的字段，如果不需要，可以将其排除。

如果你想在临时表中使用它，你可以使用这样的：

```
select *
into #temp
from
(
  SELECT *, '2013' Source
  FROM student 
  WHERE graduation_year = 2013 
  UNION ALL
  SELECT *, '2014' Source
  FROM student 
  WHERE graduation_year = 2014 
) src

select * from #temp 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c98e3/2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:35:39.560

您可以使用`UNION ALL`

```
SELECT *
FROM student 
WHERE graduation_year = 2013 
UNION ALL
SELECT *
FROM student 
WHERE graduation_year = 2014 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:33:08.630

```
SELECT * FROM student WHERE graduation_year = 2013 -- returns 140 rows
Union All -- Retrieves all results from both recordsets including both duplicates
SELECT * FROM student WHERE graduation_year = 2014 -- returns 130 rows

SELECT * FROM student WHERE graduation_year = 2013 -- returns 140 rows
Union -- Retrieves all results from both recordsets discarding duplicates
SELECT * FROM student WHERE graduation_year = 2014 -- returns 130 rows 
```

# c# - 动态调整纹理大小

> ID：13864231
> 
> 赞同：1
> 
> 时间：2012-12-13T16:29:40.027
> 
> 标签：c#, dynamic, xna, texture2d, rendertarget

我正在使用 RenderTarget2D 将我的地图绘制到屏幕上，然后再将其渲染到屏幕上，因为它很少更改并且地图本身由很多非常小的图块组成。因此，我不是每帧都将所有图块绘制到缓冲区，而是将它们绘制到 RenderTarget2D，然后将其绘制到缓冲区。

我的问题是关于 RenderTarget2D “纹理”。如果玩家要调整窗口的大小，我希望至少可以玩一点，那么在尺寸方面修改 RenderTarget2D 对象的正确方法是什么？

目前我只是在调整窗口大小时重新创建对象，这可能很好，但我想我应该要求安全，我不会错过更简单的东西。

```
texMap = new RenderTarget2D(GraphicsDevice, GraphicsDevice.Viewport.Width, GraphicsDevice.Viewport.Height); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:35:24.243

创建渲染目标后，无法调整其大小。调用`Dispose()`现有的渲染目标（如果存在），然后创建一个新目标。

# ios6 - 从 ios UITABLEVIEW 打印特定值

> ID：13864236
> 
> 赞同：0
> 
> 时间：2012-12-13T16:29:46.097
> 
> 标签：ios6

```
SOffer[26229:c07] current Product: (
    {
        id = 20;
        image = "img2.png";
        name = "offer 2";
    }
) 
```

我有通过 NSLog 打印时产生上述结果的产品，我需要单独打印这些。以下代码生成此

```
    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cell"];
        如果（细胞 == 零）{
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"cell"];
        }
        NSString *currentProductName;
        currentProductName = [productKeys objectAtIndex:indexPath.row];

        currentProduct = [products objectForKey:[productKeys objectAtIndex:indexPath.row]];
        NSLog(@"当前产品：%@",currentProduct);
        //currentProductName = [currentProduct objectForKey:@"image"];
        //当前产品 = [当前产品];

        [[单元格文本标签] setText:currentProductName];

    返回单元格；
    }

```

currentProduct 被声明为 NSArray 但是当我尝试使用 objectForKey 打印时，它说 No visible interface for NSArray 声明了选择器 ObjectForKey

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:40:24.357

`objectForKey`，我相信`NSDictionary`只适用于。

`NSArray`没有键值对。除非`currentProduct`保存 JSON 文件，否则您必须首先取出第一个 Product 的 Array 对象并将其分配给 a `NSDictionary`，然后您可以在其中使用`objectForKey`来获取图像值。

像这样的东西：

```
// Get the first product object from the NSArray. Assuming you dropped your entire Product values into a NSArray
NSMutableDictionary *prodDict = [currentProduct objectAtIndex:indexPath.section];
NSString *prodID = [prodDict objectForKey:@"id"];
NSString *prodName = [prodDict objectForKey:@"name"];
... 
```

# .net - 文件系统数据源

> ID：13864241
> 
> 赞同：0
> 
> 时间：2012-12-13T16:30:09.287
> 
> 标签：.net, winforms, filesystems

我想使用一个自定义 TreeView 控件，该控件使用数据源来创建树结构。我想创建一种文件夹浏览器。我没有重新创建具有文件夹名称、路径、图标、ecc 的数据源，而是在寻找可以为我执行此操作的对象！那么有没有一种简单的方法来获取代表文件系统的数据源？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:15:39.447

你可以看看这里，这是一个示例项目：

它比仅添加数据源要复杂一些

[http://www.codeproject.com/Articles/301943/TreeView-Explorer-using-VB-NET-2008](http://www.codeproject.com/Articles/301943/TreeView-Explorer-using-VB-NET-2008)

# c++ - 服务重启后socket未释放

> ID：13864247
> 
> 赞同：1
> 
> 时间：2012-12-13T16:30:39.293
> 
> 标签：c++, linux, sockets, service, restart

有： A：持有打开套接字的程序 B：作为服务运行的看门狗脚本：

```
while true
do
        if [ -z "`pidofproc $1`" ]; then
                $1;
            chrt -f -p 40 `pidofproc $1`
                sleep 8
        fi;
        sleep 2
done 
```

服务开始时 - 服务停止时看门狗启动
- 看门狗和程序被杀死（killall）。

现在程序想要升级自己，所以它调用`system( "upgrade.sh" );`

升级.sh：

```
/sbin/service watchdog stop

.... install upgrade  .....

exec /sbin/service watchdog start & 
```

升级成功执行，但是当程序启动时 - 无法打开套接字（已在使用中） - 出现此错误 - 程序退出（由看门狗重新启动）。

lsof -i 在端口上显示三个程序：

```
watchdog

program

sleep 
```

程序和睡眠 pids 总是改变（即退出/重启行为）

看门狗 pid 持久。

我试图`system(...)`用

`if(!fork()) exec(...)`，但同样的问题仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:36:00.250

根据关闭后重新启动的速度，套接字将徘徊。默认情况下，Linux 会在套接字释放后（在进程终止时或进程终止时）将其标记为正在使用一段时间，`close()`以确保传入的连接尝试或由于网络延迟而延迟的数据不会结束在错误的应用程序。

这必须在应用程序内部修复。需要设置`SO_REUSEADDR`sockopt。根据 socket(7) 的联机帮助页：

> 表示用于验证 bind(2) 调用中提供的地址的规则应该允许重用本地地址。对于 AF_INET 套接字，这意味着一个套接字可以绑定，除非有一个活动的侦听套接字绑定到该地址。当侦听套接字使用特定端口绑定到 INADDR_ANY 时，就不可能为任何本地地址绑定到该端口。参数是一个整数布尔标志。

这必须`setsockopt`在创建套接字后使用。

# javascript - 在弹出窗口中调用不同的 div

> ID：13864248
> 
> 赞同：0
> 
> 时间：2012-12-13T16:30:43.850
> 
> 标签：javascript, html, video, popup, gallery

我正在使用 3 个图片库。当您单击图像时，会出现一个弹出窗口，其中包含一个 iframe。目前，单击时的 3 个不同图像都在弹出窗口中显示相同的视频。我想知道如何为不同的图像调用不同的视频。另外，是否可以自动启动视频，这样您就不必在弹出窗口出现时按播放？谢谢大家，我的代码如下。

```
 <script>
 $(document).ready(function() {
    $('a.login-window').click(function() {

            //Getting the variable's value from a link 
    var loginBox = $(this).attr('href');

    //Fade in the Popup
    $(loginBox).fadeIn(300);

    //Set the center alignment padding + border see css style
    var popMargTop = ($(loginBox).height() + 24) / 2; 
    var popMargLeft = ($(loginBox).width() + 24) / 2; 

    $(loginBox).css({ 
        'margin-top' : -popMargTop,
        'margin-left' : -popMargLeft
    });

    // Add the mask to body
    $('body').append('<div id="mask"></div>');
    $('#mask').fadeIn(300);

    return false;
});

    // When clicking on the button close or the mask layer the popup closed
    $('a.close, #mask').live('click', function() { 
     $('#mask , .login-popup').fadeOut(300 , function() {
      $('#mask').remove();  
  }); 
 return false;
 });
});
</script>

      <div id="videos">
        <div id="header_start">
        <a class="login-window" href="#login-box"><img src="/images/video_holder1.jpg" style="padding-right: 20px; width: 316px; height: 186px;" /></a></div>
            <div class="login-popup" id="login-box">
                <iframe width="560" height="315" src="foo.com" frameborder="0" allowfullscreen></iframe>
                <a class="close" href="#"><img alt="Close" class="btn_close" src="close_pop.png" title="Close Window" /></a>
                </div></div>
      <div id="videos1">
        <div id="header_start">
        <a class="login-window" href="#login-box"><img src="/images/video_holder2.jpg" style="padding-right: 20px; width: 316px; height: 186px;" /></a></div>
            <div class="login-popup" id="login-box">
            <iframe width="560" height="315" src="foo.com" frameborder="0" allowfullscreen></iframe>
            <a class="close" href="#"><img alt="Close" class="btn_close" src="close_pop.png" title="Close Window" /></a>
            </div></div>
       <div id="videos2">     
         <div id="header_start">
         <a class="login-window" href="#login-box"><img src="/images/video_holder3.jpg" style="padding-right: 20px; width: 316px; height: 186px;" /></a></div>
            <div class="login-popup" id="login-box">
            <iframe width="560" height="315" src="foo.com" frameborder="0" allowfullscreen></iframe>
            <a class="close" href="#"><img alt="Close" class="btn_close" src="close_pop.png" title="Close Window" /></a>
            </div></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:49:58.043

我创建了一个**[FIDDLE](http://jsfiddle.net/Dim13i/tnGRZ/4/)**

您的 jQuery 代码中有一些错误，我已经进行了一些更改。当您单击图像时，您可以`.login-popup`像这样访问正确的图像：

```
var $loginBox = $(this).parent().next('.login-popup'); 
```

尝试获得“启发”并进行所需的修改以获得您想要的。

记住，代码中的 ID 应该是唯一的，这一点也很重要。如果您想为多个元素提供相同的属性和样式，请使用类。

# macos - 如何分析mac os崩溃报告？

> ID：13864251
> 
> 赞同：2
> 
> 时间：2012-12-13T16:30:46.783
> 
> 标签：macos, osx-mountain-lion

我正在使用 mac os 山狮 (10.8.2) 。使用 eclipse 时我的机器经常重启。重新启动后弹出一个显示`send report`。如何使用崩溃报告解决问题？.

```
Interval Since Last Panic Report:  46171 sec
Panics Since Last Report:          5
Anonymous UUID:                    2797EFBF-B052-1A79-D68C-97060E7AC0F4

Thu Dec 13 16:24:32 2012
panic(cpu 4 caller 0xffffff800fcb7e75): Kernel trap at 0xffffff7f9275a439, type 14=page fault, registers:
CR0: 0x0000000080010033, CR2: 0x0000000000000800, CR3: 0x0000000023b0b018, CR4: 0x00000000001606e0
RAX: 0x0000000000000000, RBX: 0xffffff8101a2d000, RCX: 0xffffff8101a2d7e8, RDX: 0x0000000000000200
RSP: 0xffffff8101ac3d00, RBP: 0xffffff8101ac3d60, RSI: 0x000000008003f000, RDI: 0xffffff8101a2d000
R8:  0xffffff8101ac3c20, R9:  0x0000000000001000, R10: 0xffffff8036a965b0, R11: 0xffffff8036a96580
R12: 0xffffff8101a2d000, R13: 0x000000008003f000, R14: 0xffffff8101a2d000, R15: 0xffffff8101a2d7e8
RFL: 0x0000000000010246, RIP: 0xffffff7f9275a439, CS:  0x0000000000000008, SS:  0x0000000000000010
Fault CR2: 0x0000000000000800, Error code: 0x0000000000000000, Fault CPU: 0x4

Backtrace (CPU 4), Frame : Return Address
0xffffff8101ac39a0 : 0xffffff800fc1d626 
0xffffff8101ac3a10 : 0xffffff800fcb7e75 
0xffffff8101ac3be0 : 0xffffff800fccd3bd 
0xffffff8101ac3c00 : 0xffffff7f9275a439 
0xffffff8101ac3d60 : 0xffffff7f9275a7f8 
0xffffff8101ac3e10 : 0xffffff7f92755428 
0xffffff8101ac3e50 : 0xffffff800ff505a0 
0xffffff8101ac3ea0 : 0xffffff800ff9a0ae 
0xffffff8101ac3f00 : 0xffffff800ffa0595 
0xffffff8101ac3f60 : 0xffffff800ffe0313 
0xffffff8101ac3fb0 : 0xffffff800fccd8ed 
      Kernel Extensions in backtrace:
         com.kaspersky.kext.kimul.42(42.0)[658C1759-7925-7346-A10D-B468C1BD7A1D]@0xffffff7f92753000->0xffffff7f9275cfff

BSD process name corresponding to current thread: kav

Mac OS version:
12C3012

Kernel version:
Darwin Kernel Version 12.2.1: Thu Oct 18 16:32:48 PDT 2012; root:xnu-2050.20.9~2/RELEASE_X86_64
Kernel UUID: 0AFA55FD-872F-3BBE-8630-214EB586A16D
Kernel slide:     0x000000000fa00000
Kernel text base: 0xffffff800fc00000
System model name: MacBookPro9,1 (Mac-4B7AC7E43945597E)

System uptime in nanoseconds: 52214192380474
last loaded kext at 35527368584903: com.apple.driver.AppleUSBCDC    4.1.22 (addr 0xffffff7f9275d000, size 16384)
last unloaded kext at 35660574175525: com.apple.driver.AppleUSBCDC  4.1.22 (addr 0xffffff7f9275d000, size 12288)
loaded kexts:
com.kaspersky.kext.kimul.42 42
com.kaspersky.kext.klif 2.2.1d19
com.apple.filesystems.smbfs 1.8
com.apple.driver.AppleHWSensor  1.9.5d0
com.apple.driver.AudioAUUC  1.60
com.apple.driver.AGPM   100.12.81
com.apple.driver.AppleMikeyHIDDriver    122
com.apple.driver.X86PlatformShim    1.0.0
com.apple.driver.AppleHDA   2.3.5fc10
com.apple.filesystems.autofs    3.0
com.apple.iokit.IOUserEthernet  1.0.0d1
com.apple.driver.AppleMikeyDriver   2.3.5fc10
com.apple.iokit.IOBluetoothSerialManager    4.1.2f9
com.apple.Dont_Steal_Mac_OS_X   7.0.0
com.apple.driver.AppleSMCLMU    2.0.3d0
com.apple.iokit.BroadcomBluetoothHCIControllerUSBTransport  4.1.2f9
com.apple.driver.AppleMuxControl    3.2.13
com.apple.driver.ApplePolicyControl 3.2.13
com.apple.driver.SMCMotionSensor    3.0.3d1
com.apple.driver.AppleIntelHD4000Graphics   8.0.6
com.apple.GeForce   8.0.6
com.apple.driver.AppleSMCPDRC   1.0.0
com.apple.driver.AppleUpstreamUserClient    3.5.10
com.apple.driver.AppleMCCSControl   1.1.11
com.apple.driver.AppleLPC   1.6.0
com.apple.driver.AppleIntelFramebufferCapri 8.0.6
com.apple.driver.AppleUSBTCButtons  237.1
com.apple.driver.AppleUSBTCKeyboard 237.1
com.apple.driver.AppleIRController  320.15
com.apple.AppleFSCompression.AppleFSCompressionTypeDataless 1.0.0d1
com.apple.AppleFSCompression.AppleFSCompressionTypeZlib 1.0.0d1
com.apple.BootCache 34
com.apple.iokit.SCSITaskUserClient  3.5.5
com.apple.driver.XsanFilter 404
com.apple.iokit.IOAHCIBlockStorage  2.3.1
com.apple.driver.AppleUSBHub    5.5.0
com.apple.driver.AppleSDXC  1.4.0
com.apple.iokit.AppleBCM5701Ethernet    3.5.0b9
com.apple.driver.AirPort.Brcm4331   612.20.14
com.apple.driver.AppleFWOHCI    4.9.6
com.apple.driver.AppleAHCIPort  2.5.1
com.apple.driver.AppleUSBEHCI   5.5.0
com.apple.driver.AppleUSBXHCI   1.5.1
com.apple.driver.AppleEFINVRAM  1.7
com.apple.driver.AppleSmartBatteryManager   161.0.0
com.apple.driver.AppleRTC   1.5
com.apple.driver.AppleACPIButtons   1.7
com.apple.driver.AppleHPET  1.8
com.apple.driver.AppleSMBIOS    1.9
com.apple.driver.AppleACPIEC    1.7
com.apple.driver.AppleAPIC  1.6
com.apple.driver.AppleIntelCPUPowerManagementClient 196.0.0
com.apple.nke.applicationfirewall   4.0.39
com.apple.security.quarantine   2
com.apple.driver.AppleIntelCPUPowerManagement   196.0.0
com.apple.driver.DspFuncLib 2.3.5fc10
com.apple.iokit.IOAudioFamily   1.8.9fc11
com.apple.kext.OSvKernDSPLib    1.6
com.apple.kext.triggers 1.0
com.apple.iokit.IOSurface   86.0.3
com.apple.iokit.IOSerialFamily  10.0.6
com.apple.iokit.IOBluetoothFamily   4.1.2f9
com.apple.iokit.AppleBluetoothHCIControllerUSBTransport 4.1.2f9
com.apple.driver.AppleSMBusPCI  1.0.11d0
com.apple.driver.X86PlatformPlugin  1.0.0
com.apple.driver.AppleBacklightExpert   1.0.4
com.apple.driver.AppleGraphicsControl   3.2.13
com.apple.nvidia.nvGK100hal 8.0.6
com.apple.driver.AppleSMC   3.1.4d2
com.apple.driver.AppleHDAController 2.3.5fc10
com.apple.iokit.IOHDAFamily 2.3.5fc10
com.apple.driver.AppleSMBusController   1.0.11d0
com.apple.NVDAResman    8.0.6
com.apple.iokit.IONDRVSupport   2.3.6
com.apple.driver.IOPlatformPluginFamily 5.3.0d47
com.apple.iokit.IOGraphicsFamily    2.3.6
com.apple.iokit.IOFireWireIP    2.2.5
com.apple.driver.AppleUSBMultitouch 237.3
com.apple.iokit.IOUSBHIDDriver  5.2.5
com.apple.driver.AppleThunderboltDPInAdapter    1.8.9
com.apple.driver.AppleThunderboltDPAdapterFamily    1.8.9
com.apple.driver.AppleThunderboltPCIDownAdapter 1.2.6
com.apple.driver.AppleUSBMergeNub   5.5.0
com.apple.driver.AppleUSBComposite  5.2.5
com.apple.iokit.IOSCSIMultimediaCommandsDevice  3.5.5
com.apple.iokit.IOBDStorageFamily   1.7
com.apple.iokit.IODVDStorageFamily  1.7.1
com.apple.iokit.IOCDStorageFamily   1.7.1
com.apple.iokit.IOAHCISerialATAPI   2.5.1
com.apple.iokit.IOSCSIArchitectureModelFamily   3.5.5
com.apple.driver.AppleThunderboltNHI    1.6.3
com.apple.iokit.IOThunderboltFamily 2.1.8
com.apple.iokit.IOEthernetAVBController 1.0.2b1
com.apple.iokit.IO80211Family   510.4
com.apple.iokit.IONetworkingFamily  3.0
com.apple.iokit.IOUSBUserClient 5.5.0
com.apple.iokit.IOFireWireFamily    4.5.5
com.apple.iokit.IOAHCIFamily    2.3.1
com.apple.iokit.IOUSBFamily 5.5.0
com.apple.driver.AppleEFIRuntime    1.7
com.apple.iokit.IOHIDFamily 1.8.1
com.apple.iokit.IOSMBusFamily   1.1
com.apple.security.sandbox  220
com.apple.kext.AppleMatch   1.0.0d1
com.apple.security.TMSafetyNet  7
com.apple.driver.DiskImages 344
com.apple.iokit.IOStorageFamily 1.8
com.apple.driver.AppleKeyStore  28.21
com.apple.driver.AppleACPIPlatform  1.7
com.apple.iokit.IOPCIFamily 2.7.3
com.apple.iokit.IOACPIFamily    1.4
com.apple.kec.corecrypto    1.0
Model: MacBookPro9,1, BootROM MBP91.00D3.B08, 4 processors, Intel Core i7, 2.3 GHz, 8 GB, SMC 2.1f173
Graphics: Intel HD Graphics 4000, Intel HD Graphics 4000, Built-In, 384 MB
Graphics: NVIDIA GeForce GT 650M, NVIDIA GeForce GT 650M, PCIe, 512 MB
Memory Module: BANK 0/DIMM0, 4 GB, DDR3, 1600 MHz, 0x80AD, 0x484D54333531533643465238432D50422020
Memory Module: BANK 1/DIMM0, 4 GB, DDR3, 1600 MHz, 0x80AD, 0x484D54333531533643465238432D50422020
AirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0xF5), Broadcom BCM43xx 1.0 (5.106.98.100.14)
Bluetooth: Version 4.1.2f9 11046, 2 service, 18 devices, 1 incoming serial ports
Network Service: Ethernet, Ethernet, en0
Serial ATA Device: APPLE HDD HTS547550A9E384, 500.11 GB
Serial ATA Device: MATSHITADVD-R   UJ-8A8
USB Device: hub_device, 0x8087  (Intel Corporation), 0x0024, 0x1d100000 / 2
USB Device: hub_device, 0x0424  (SMSC), 0x2513, 0x1d180000 / 3
USB Device: IR Receiver, apple_vendor_id, 0x8242, 0x1d182000 / 6
USB Device: BRCM20702 Hub, 0x0a5c  (Broadcom Corp.), 0x4500, 0x1d181000 / 5
USB Device: Bluetooth USB Host Controller, apple_vendor_id, 0x821d, 0x1d181300 / 7
USB Device: Apple Internal Keyboard / Trackpad, apple_vendor_id, 0x0252, 0x1d183000 / 4
USB Device: hub_device, 0x8087  (Intel Corporation), 0x0024, 0x1a100000 / 2
USB Device: FaceTime HD Camera (Built-in), apple_vendor_id, 0x8509, 0x1a110000 / 3
USB Device: USB Optical Mouse, 0x0461  (Primax Electronics), 0x4d81, 0x14200000 / 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:11:08.253

```
 Kernel Extensions in backtrace:
     com.kaspersky.kext.kimul 
```

这可能是有问题的 kext，您可能想要删除它

```
BSD process name corresponding to current thread: kav 
```

这代表“卡巴斯基反病毒软件”；你可能应该卸载它

其余的东西，比如寄存器内容和东西，只有当你知道它们的十六进制内容是什么意思时才有用（我不……抱歉）

# android-layout - 在xml中定义带有静态元素的列表视图？

> ID：13864260
> 
> 赞同：40
> 
> 时间：2012-12-13T16:31:09.653
> 
> 标签：android-layout

我想创建将静态菜单显示为列表中的一组行的片段。

我喜欢在表格视图中使用静态单元格的 iOS 方法。我怎样才能在android中实现这一点（所以不需要代码来定义元素，只需xml）

是否有任何常规方法可以在 xml 中定义静态元素

（伪代码）

```
list_view.xml

<List view>
  - use element my_row with onclick=row1_clicked and title="row 1"
  - use element my_row with onclick=row2_clicked and title="row 2"
  - use element my_row with onclick=row3_clicked and title="row 3"
  - use element my_row with onclick=row4_clicked and title="row 4"
</List view>

my_row.xml

<My Row>
  - text field (title should go here)
  - on click (on click should go here)
</My Row> 
```

所以基本上我想在列表中“包含”行并在 xml 级别上执行（没有代码）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-17T14:42:17.180

不幸的是，禁止通过 xml 定义列表视图。相反，需要弄乱适配器。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-05-27T06:24:27.987

使用字符串数组可以取得一些进展，例如，

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:orientation="vertical" >
  <ListView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:entries="@array/sports_array"/>
</LinearLayout> 
```

加上

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
  <string-array name="sports_array">
    <item>Shuttle Badminton</item>
    <item>Tennis</item>
    <item>FootBall</item>
  </string-array>
</resources> 
```

来源：[http ://theopentutorials.com/tutorials/android/listview/android-creating-and-populating-listview-items-in-xml/](http://theopentutorials.com/tutorials/android/listview/android-creating-and-populating-listview-items-in-xml/)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-07-08T17:13:49.253

您可以使用嵌套在 ScrollView 中的垂直 LinearLayout 来获取您要查找的内容。将您的“listview”项目放在 LinearLayout 中，并将它们设置为看起来像 listview 的元素。

如果您绝对必须使用 ListView（例如，您正在使用 ListFragment），您将不得不使用 ListAdapter 子类或滚动您自己的子类。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-07-16T14:20:03.383

其实有办法！使用**包含**标签重用布局

只需定义要重用的布局。

```
<LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:orientation="horizontal">
 <ImageView
        android:id="@+id/profileImage"
        android:layout_width="128dp"
        android:layout_height="128dp"
        android:src="@drawable/lena" />
 <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/profileOnline"/>
 </LinearLayout> 
```

然后根据需要多次将其包含在您的 ViewGroup 中

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal">

    <include layout="@layout/titlebar"/>

    <TextView android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:text="@string/hello"
              android:padding="10dp" />

    ...

</LinearLayout> 
```

您还可以通过在标签中指定它们来覆盖包含布局的根视图的所有布局参数（任何 android:layout_* 属性）。例如：

```
<include android:id="@+id/news_title"
         android:layout_width="match_parent"
         android:layout_height="match_parent"
         layout="@layout/title"/> 
```

更多信息请访问[http://developer.android.com/training/improving-layouts/reusing-layouts.html](http://developer.android.com/training/improving-layouts/reusing-layouts.html)

# python - 可以在没有心跳的情况下运行idlex（我想最小化窗口数量）

> ID：13864261
> 
> 赞同：2
> 
> 时间：2012-12-13T16:31:10.370
> 
> 标签：python, windows, python-idle

当我从命令提示符（Windows）启动idlex时，我会丢失对新进程的提示，直到我关闭idlex。

```
F:\>c:\Python27\Scripts\idlex.py
[IPKernelApp] To connect another client to this kernel, use:
[IPKernelApp] --existing c:\users\myname\appdata\local\temp\tmpch1j8w.json
heartbeat: 1.0 
```

我只想看到空闲 gui 而不是这个心跳信息。这可能吗 ？最初我认为使用“-n”运行会起作用，但结果不是我想的那样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:15:21.420

您可以通过使用`pythonw`而不是启动程序来恢复控制台`python`。解释器`pythonw`不使用标准输入和输出文件句柄，因此不需要为这些句柄打开控制台窗口。

让脚本始终使用的最佳方法`pythonw`是将其扩展名从 重命名`.py`为`.pyw`. 如果您从资源管理器窗口或快捷方式而不是直接从控制台启动它，这也应该有效。

# servicestack - 使用 ServiceStack 公共覆盖对象 OnGet 时访问查询字符串值

> ID：13864262
> 
> 赞同：1
> 
> 时间：2012-12-13T16:31:14.957
> 
> 标签：servicestack

我正在设置我的第一个 ServiceStack 站点，但在从我的 URL 访问查询字符串值时遇到了一些问题

```
 public override object OnGet(MyModel.Product request)
        {
            if (request.ItemID != null)
            {
                return Repo.MyRepo.GetProduct(request.ManufacturerID, request.ItemID);
            }

            return Repo.MyRepo.GetProducts(request.ManufacturerID, request.Page, request.PageSize, request.tStamp);
        } 
```

参数 Page、PageSize 和 tStamp 不是我的对象的属性，但我需要它们来调用我用来获取数据的 SP。我怎样才能访问这些？好像我在这里错过了一些非常简单的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:34:51.717

考虑将[ServiceStack 的新 API](https://github.com/ServiceStack/ServiceStack/wiki/New-Api)用于未来的服务。当您继承一个`Service`类时，您可以通过以下方式访问 QueryString：

```
public object Get(MyModel.Product request)
{
    var value = base.Request.QueryString["key"];
} 
```

# transactions - 选定操作的 IMPLICIT_TRANSACTIONS

> ID：13864267
> 
> 赞同：0
> 
> 时间：2012-12-13T16:31:29.767
> 
> 标签：transactions, sql-server-2012, ansi

我喜欢`IMPLICIT_TRANSACTIONS`(via `Options > Query Execution > ANSI > SET IMPLICIT_TRANSACTIONS`) for `update`,`insert`等，但我不想要它`select`

（*见这个[MDSN](http://msdn.microsoft.com/en-us/library/ms187807.aspx)*）

这在 SQL Server 2012 中可行吗？

[这是这篇文章](https://stackoverflow.com/questions/13295376/how-to-set-begin-transaction-automatically-in-ssms-sql-server-management-studio)的后续问题

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:33:28.763

不，不幸的是，要么全有，要么全无，除非连接已经处于打开的事务中，否则将为该文章中列出的所有语句启动一个新事务。

# c# - 如何计算多个多对多表关系中不同项目的数量？

> ID：13864272
> 
> 赞同：-2
> 
> 时间：2012-12-13T16:31:45.473
> 
> 标签：c#, linq, linq-to-sql

所以我有3个主表（数据不重要）：

*   顾客
*   团体
*   员工

还有几个“多对多”表加入其他 3 个表：

*   集团客户
*   集团员工

本质上，一个客户可以属于很多组，而一个员工可以属于很多组。

所以现在假设我已经查询了一个特定的客户。所以我有类似的东西：

```
Customer customer1 = GetCustomer1(); 
```

现在我想计算客户所在的任何组中的不同员工的数量......

```
int count = customer1.GroupCustomers.SomeLinqMagicGoesHere 
```

那么，我需要的 Linq 魔法是什么？

**重要**：关系是使用 linq-to-sql 生成的

* * *

一些所需的输入/输出，如果它有助于解释我的需求：

```
Customer
--------
C1
C2

GroupCustomer
--------
C1 | G1
C1 | G2
C2 | G1

Group
--------
G1
G2

GroupEmployee
--------
E1 | G1
E1 | G2
E2 | G2

Employee
--------
E1
E2 
```

所以我想要的 C1 的计数应该是 2。 C2 的计数应该是 1。

希望这没有使问题更加混乱！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:43:13.220

也许：

```
int count = costumer.GroupCustomers
    .SelectMany(gc => gc.Group.GroupEmployees)
    .Select(ge => ge.EmployeeID)
    .Distinct()
    .Count(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:37:03.870

如果您的映射是正确的，您应该能够获得客户所在组中不同员工的数量，如下所示：

```
customer1.Groups.SelectMany(x => x.Employees).Distinct().Count() 
```

# ruby-on-rails-3 - RSpec、Spork 和 Postgres 错误：准备好的语句“a1”已经存在

> ID：13864286
> 
> 赞同：2
> 
> 时间：2012-12-13T16:32:31.047
> 
> 标签：ruby-on-rails-3, postgresql, rspec2

在我们的 PostgreSQL 支持的 Rails 项目中，当使用 spork 运行 rspec 时，有时我们会收到以下错误：

```
ActiveRecord::StatementInvalid:
   PG::Error: ERROR:  prepared statement "a1" already exists 
```

最初，它每天只发生几次，但最近，它开始每 3-4 次测试运行发生一次，这让我们的开发工作变得缓慢。

有没有办法在我们`spec_helper.rb`文件的某个地方重置/删除 PostgreSQL 中准备好的语句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:32:31.047

在搜索[PostgreSQL 文档](http://www.postgresql.org/docs/9.1/static/sql-deallocate.html)并在 PostgreSQL 中的不同位置对其进行了大量的试验和错误测试后`spec_helper.rb`，我终于发现我可以添加以下内容来删除所有现有的准备好的语句，并且我还没有看到错误：

```
RSpec.configure do |config|
  # ... other code

  config.after(:suite) do
    ActiveRecord::Base.connection.execute("DEALLOCATE ALL")
  end

  # ... other code
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:24:21.083

如果你正在做类似的事情，你可以得到这个：

```
 class ActiveRecord::Base
    mattr_accessor :shared_connection
    @@shared_connection = nil
    def self.connection
      @@shared_connection || retrieve_connection
    end
  end
  ActiveRecord::Base.shared_connection = ActiveRecord::Base.connection 
```

（[这里](https://gist.github.com/470808)推荐）。

如果你有那个或类似的，请尝试删除它。

# excel - 跟踪 Excel 单元格更改

> ID：13864291
> 
> 赞同：0
> 
> 时间：2012-12-13T16:32:46.173
> 
> 标签：excel, excel-2003, vba

我想知道是否有人可以帮助我。

我正在使用下面的代码来跟踪 Excel 单元格的更改，并在“G”列中插入“No”的文本值并在“A”列中插入单元格更改的日期

```
Option Explicit
    Public preValue As Variant
    Private Sub Worksheet_Change(ByVal Target As Range)

        Dim Cell As Range
        If Target.Cells.Count > 1 Then Exit Sub
            On Error Resume Next
            If Not Intersect(Target, Range("B5:H10")) Is Nothing Then
            If Target.Value <> preValue And Target <> "" Then
            Application.EnableEvents = False
            Range("A" & Target.Row).Value = Date
            Range("G" & Target.Row).Value = "No"
            Application.EnableEvents = True
            Target.ClearComments
            Target.AddComment.Text Text:="Previous Value was " & preValue & Chr(10) & "Revised " & Format(Date, "dd-mm-yyyy") & Chr(10) & "By " & Environ("UserName")
            Target.Interior.ColorIndex = 35
        End If
    End If
    On Error GoTo 0
    End Sub

    Private Sub Worksheet_SelectionChange(ByVal Target As Range)

        If Target.Count > 1 Then Exit Sub
        If Target = "" Then
            preValue = "a blank"
        Else: preValue = Target.Value
        End If
        preValue = Target.Value
    End Sub 
```

我想做的就是进一步扩展它。因此，如果“G”列中的值从“否”变为“是”，我希望从“B:G”列中同一行的单元格中删除所有单元格阴影，但我不确定如何去做这个。

我只是想知道是否有人可以看看这个，并就我如何改变它提供一些指导。

非常感谢和亲切的问候

**后期编辑工作解决方案**

```
Option Explicit
Public preValue As Variant
Private Sub Worksheet_Change(ByVal Target As Range)

    Dim cell As Range
    Dim Rng As Range
    If Target.Cells.Count > 1 Then Exit Sub
    On Error Resume Next
    If Not Intersect(Target, Range("B5:W500")) Is Nothing Then
        If Target.Value <> preValue And Target.Value <> "" Then
            Application.EnableEvents = False
            Range("A" & Target.Row).Value = Date
            Range("AX" & Target.Row).Value = "No"
            Application.EnableEvents = True
            'Target.ClearComments
            'Target.AddComment.Text Text:="Previous Value was " & preValue & Chr(10) & "Revised " & Format(Date, "dd-mm-yyyy") & Chr(10) & "By " & Environ("UserName")
            Target.Interior.ColorIndex = 35
        End If
    End If
    On Error GoTo 0
            If Target.Column = 50 Then
                If Target.Value = "Yes" Then
                Set Rng = Application.Union(Cells(ActiveCell.Row, "B").Resize(, 22), Cells(ActiveCell.Row, "W"))
                Rng.Interior.ColorIndex = xlNone
                End If
                End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-22T05:34:46.420

所有，在通过互联网拖网搜索之后，我现在已经开始工作了。我在下面包含了我的解决方案。

```
Option Explicit
Public preValue As Variant
Private Sub Worksheet_Change(ByVal Target As Range)

    Dim cell As Range
    Dim Rng As Range
    If Target.Cells.Count > 1 Then Exit Sub
    On Error Resume Next
    If Not Intersect(Target, Range("B5:W500")) Is Nothing Then
        If Target.Value <> preValue And Target.Value <> "" Then
            Application.EnableEvents = False
            Range("A" & Target.Row).Value = Date
            Range("AX" & Target.Row).Value = "No"
            Application.EnableEvents = True
            'Target.ClearComments
            'Target.AddComment.Text Text:="Previous Value was " & preValue & Chr(10) & "Revised " & Format(Date, "dd-mm-yyyy") & Chr(10) & "By " & Environ("UserName")
            Target.Interior.ColorIndex = 35
        End If
    End If
    On Error GoTo 0
            If Target.Column = 50 Then
                If Target.Value = "Yes" Then
                Set Rng = Application.Union(Cells(ActiveCell.Row, "B").Resize(, 22), Cells(ActiveCell.Row, "W"))
                Rng.Interior.ColorIndex = xlNone
                End If
                End If
End Sub 
```

# javascript - 如何使用户可以更改 Google Fusion Tables 中图层的颜色？

> ID：13864296
> 
> 赞同：0
> 
> 时间：2012-12-13T16:33:05.380
> 
> 标签：javascript, google-fusion-tables

我的网站使用 Fusion Tables。问题是，他们使用不适合色盲的红色和绿色。

我想添加一个选项，用户可以将他们看到的配色方案更改为其他颜色（例如蓝橙色）。

这可以使用 Google Fusion Tables Javascript API 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:00:57.917

您是否拥有其中包含数据的 FusionTables？您现在可以使用 UI 创建多种样式。

有关更多详细信息，请参阅我对[这个问题](https://stackoverflow.com/questions/13812749/fusiontableslayer-polygon-with-styleid-click-event-not-firing)的回答。

另一种选择是在 javascript 中[动态设置它们的样式](https://developers.google.com/maps/documentation/javascript/layers#fusion_table_styles)，不知道这是否适用于您的 FusionTables。

# ruby-on-rails - 使用 Rubber 将 Rails 应用程序部署到 EC2：503 服务不可用

> ID：13864306
> 
> 赞同：0
> 
> 时间：2012-12-13T16:34:21.723
> 
> 标签：ruby-on-rails, ruby-on-rails-3, deployment, amazon-ec2, passenger

因此，过去几周我一直在开发我的第一个（真正的）rails 应用程序，昨天我尝试使用 Rubber gem 将它部署到 Amazon EC2。在我部署我的实际项目之前，我对自己说：让我们在一个全新且简单的项目上尝试一下橡胶，看看它是否有效。在执行了这个 [railscast][1] 中的步骤之后，一切都与这个简单的项目一起工作了。所以我尝试部署我的真实项目，执行与以前相同的步骤。Rubber 执行了所有 Capistrano 脚本，一切似乎都很顺利。但是当我尝试访问该网站时，我收到了这个错误：503 Service Unavailable

我使用了橡胶模板“complete_passenger_postgresql”。我部署成功的简单项目和真实项目的橡胶设置基本一致。区别在于应用程序的实际内容。

查看日志文件后，我遇到了这些错误：

阿帕奇错误日志：

```
 [Thu Dec 13 14:24:02 2012] [notice] Apache/2.2.22 (Ubuntu) configured -- resuming normal operations
[Thu Dec 13 14:24:10 2012] [notice] Graceful restart requested, doing restart
[Thu Dec 13 14:24:10 2012] [notice] Apache/2.2.22 (Ubuntu) proxy_html/3.0.1 configured -- resuming normal operations
[Thu Dec 13 14:24:10 2012] [notice] caught SIGTERM, shutting down
[Thu Dec 13 14:24:12 2012] [warn] mod_wsgi: Compiled for Python/2.7.2+.
[Thu Dec 13 14:24:12 2012] [warn] mod_wsgi: Runtime using Python/2.7.3.
[Thu Dec 13 14:24:12 2012] [notice] Apache/2.2.22 (Ubuntu) proxy_html/3.0.1 mod_wsgi/3.3 Python/2.7.3 configured -- resuming normal operations
[Thu Dec 13 14:24:51 2012] [notice] caught SIGTERM, shutting down
[Thu Dec 13 14:26:26 2012] [warn] mod_wsgi: Compiled for Python/2.7.2+.
[Thu Dec 13 14:26:26 2012] [warn] mod_wsgi: Runtime using Python/2.7.3.
[Thu Dec 13 14:26:26 2012] [notice] Apache/2.2.22 (Ubuntu) proxy_html/3.0.1 mod_wsgi/3.3 Python/2.7.3 configured -- resuming normal operations
[Thu Dec 13 14:50:55 2012] [notice] caught SIGTERM, shutting down
[Thu Dec 13 14:51:50 2012] [warn] mod_wsgi: Compiled for Python/2.7.2+.
[Thu Dec 13 14:51:50 2012] [warn] mod_wsgi: Runtime using Python/2.7.3.
[Thu Dec 13 14:51:51 2012] [notice] Apache/2.2.22 (Ubuntu) proxy_html/3.0.1 mod_wsgi/3.3 Python/2.7.3 configured -- resuming normal operations
[Thu Dec 13 14:54:49 2012] [notice] caught SIGTERM, shutting down
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] Init: Name-based SSL virtual hosts only work for clients with TLS server name indication support (RFC 4366)
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] RSA server certificate CommonName (CN) `production.test.com' does NOT match server name!?
[Thu Dec 13 14:57:48 2012] [warn] Init: Name-based SSL virtual hosts only work for clients with TLS server name indication support (RFC 4366)
[Thu Dec 13 14:57:48 2012] [warn] mod_wsgi: Compiled for Python/2.7.2+.
[Thu Dec 13 14:57:48 2012] [warn] mod_wsgi: Runtime using Python/2.7.3.
[Thu Dec 13 14:57:48 2012] [notice] Apache/2.2.22 (Ubuntu) proxy_html/3.0.1 mod_ssl/2.2.22 OpenSSL/1.0.1 mod_wsgi/3.3 Python/2.7.3 Phusion_Passenger/3.0.17 configured -- resuming normal operations
[Thu Dec 13 14:57:53 2012] [crit] [client XX.XXX.XXX.XX] (13)Permission denied: /mnt/test_core-production/releases/20121213133228/.htaccess pcfg_openfile: unable to check htaccess file, ensure it is readable
[Thu Dec 13 14:57:55 2012] [crit] [client XX.XXX.XXX.XX] (13)Permission denied: /mnt/test_core-production/releases/20121213133228/.htaccess pcfg_openfile: unable to check htaccess file, ensure it is readable
[Thu Dec 13 14:57:57 2012] [crit] [client XX.XXX.XXX.XX] (13)Permission denied: /mnt/test_core-production/releases/20121213133228/.htaccess pcfg_openfile: unable to check htaccess file, ensure it is readable
Last Line repeats like a 1000 times. 
```

Cron-SH-Bundle 日志：

```
rubber:cron running ["bundle", "exec", "rake", "subscriptions:send"] at 2012-12-13 20:15:06 +0100
rake aborted!
uninitialized constant ActiveRecord
/mnt/test_core-production/shared/bundle/ruby/1.9.1/gems/ancestry-1.3.0/lib/ancestry/has_ancestry.rb:1:in `<top (required)>'
/mnt/test_core-production/shared/bundle/ruby/1.9.1/gems/ancestry-1.3.0/lib/ancestry.rb:4:in `require'
/mnt/test_core-production/shared/bundle/ruby/1.9.1/gems/ancestry-1.3.0/lib/ancestry.rb:4:in `<top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
/usr/local/rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
/usr/local/graylog2-web-interface-0.9.6p1/config/application.rb:16:in `<top (required)>'
/usr/local/graylog2-web-interface-0.9.6p1/Rakefile:4:in `require'
/usr/local/graylog2-web-interface-0.9.6p1/Rakefile:4:in `<top (required)>'
(See full trace by running task with --trace) 
```

Rails 生产日志

```
Connecting to database specified by database.yml
Compiled jquery.js  (2ms)  (pid 23834)
Compiled jquery-ui.js  (7ms)  (pid 23834)
...
Connecting to database specified by database.yml
Migrating to CreateUsers (20120903114829)
...
Connecting to database specified by database.yml
Connecting to database specified by database.yml
PG::Error: connection not open // <-- I think this happens while seeding data
: UPDATE "delayed_jobs" SET locked_by = null, locked_at = null WHERE (locked_by = 'delayed_job host:production.test.com pid:24702') 
```

难道是宝石“祖先”可能会导致这个问题？那么“权限被拒绝”错误呢？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:42:09.597

我设法通过以下方式解决了上述问题：

首先，我通过应用为 rails 项目的目录和文件赋予了适当的权限

```
sudo chmod -R 777 ProjectDirectory 
```

这解决了 Apache 权限错误。出现这个问题的原因是我在另一台windows和linux机器上创建了项目，并试图将它部署在mac上。简单的测试项目之所以有效，是因为我在部署它的同一台机器上创建了它。

接下来，我将以下代码行添加到我的 see.rb 文件中，以消除“未初始化的常量 ActiveRecord”错误：

```
require 'active_record' 
```

在这些调整之后，我再次使用橡胶部署了所有东西并且它正在工作:-)

# class - 输入新的 Haskell 类时有些混淆

> ID：13864314
> 
> 赞同：0
> 
> 时间：2012-12-13T16:34:44.017
> 
> 标签：class, haskell, types, graph

我正在编写一个图形库来了解更多关于在 Haskell 中构建稍微大一点的东西的信息，但我遇到了一个问题。

基本上，我试图将`Edge`s 定义为一组两个点，一个`from`点和一个`to`点。但是，我有多种类型的边缘（加权/非加权），我不希望它们能够混入`graph`s。

所以，我的想法是创建几个新类，`Weighted`并且`Edgy`，为了能够实现我正在努力实现的多态行为的数量。两种类型`Edge`都是`Edgy`，但只有加权`Edge`类型是`Weighted`。

这个`Weighted`类很简单，因为它只需要修改整个对象。这是它的样子：

```
class Weighted a where
  modifyWeight :: (Unbounded Int -> Unbounded Int) -> a -> a 
```

`Unbounded`我拼凑在一起以支持无限大和小数字的 Num 类型在哪里。不过，这很简单，因为我只需要返回一个`a`.

我坚持的是让`Edgy`类返回类类型的类型（???不确定如何放置这个，内部类型，也许？）。为了使这一点更清楚，这就是我正在使用的东西，可能更有意义：

```
class Edgy a where
  to :: a -> Vertex a
  from :: a -> Vertex a 
```

`Vertex`包装类在哪里——`Edge`我在这里尝试做的声明：

```
data Edge a = Edge (Vertex a) (Vertex a) deriving (Show, Eq)

data WEdge a = WEdge (Vertex a) (Vertex a) (Unbounded Int) deriving (Show, Eq) 
```

所以，我真正想做的是说“好吧，如果你是`Edgy`班级的成员，你应该能够返回 a`Vertex`类型的`Edge`”。

但是，GHC 不喜欢这样，因为`a`in 的类型`Edgy`最终是`Edge a`而不是`a`，而且我不确定如何让它“下降”到类中以将该类型拉出以返回它。

如果有任何不清楚的地方，请发表评论。

任何帮助是极大的赞赏; 我难住了！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:59:56.880

您可能想要使用类型构造函数类而不是类型类

```
class Edgy e where
    to :: e a -> Vertex a
    from :: e a -> Vertex a

instance Edgy Edge where ... 
```

# java - 包含撇号字符 U+2019 的字符串在传递给 PreparedStatement 对象时转换为更多字符

> ID：13864318
> 
> 赞同：0
> 
> 时间：2012-12-13T16:34:57.143
> 
> 标签：java, jdbc

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:46:25.730

If you want to check the length of your String before inserting it in DB, you have to convert it to the charset used by your DB. It can be done with

```
 new String(string, charset); 
```

for instance

```
 System.out.println("‘".length()); 
 // displays 1
 System.out.println(new String("‘".getBytes(), "UTF-16").length()); 
 // displays 2
 System.out.println(new String("‘".getBytes(), "ISO-8859-1").length()); 
 // displays 3 
```

see http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#String%28byte[],%20java.lang.String%29

# javascript - 在 IE 中使用 javascript 设置 activetabindex

> ID：13864319
> 
> 赞同：0
> 
> 时间：2012-12-13T16:35:05.890
> 
> 标签：javascript, ajax, internet-explorer-8, tabpanel, preventdefault

IE是我存在的祸根。基本上，如果用户尝试跳过选项卡，我想从选项卡中的按钮运行验证，以防止他们不填写数据并可能破坏我的数据库查询。

```
 $("[id$='tab_TabContainer1_TabPanel2']").click(function (e) {
        var container = $find('TabContainer1');
        if (event.preventDefault) {
            event.preventDefault(); //works for anything with preventDefault (e.g., not called from html onclick, etc.)
        }
        else {
            event.returnValue = false;      //supposed to be IE specific - on global event 'event'
        }

        $("[id$='Button1']").click();   //perform the button1 click event (which calls custom validation)

        if (Page_IsValid) {
            container.set_activeTabIndex(1); //go ahead to next tab
        }
        else {
            container.set_activeTabIndex(0);    //stay here on current tab
        }
        return false;
    }); 
```

应该就是这么简单，上面的方法在firefox/google chrome中有效，但在IE8中无效。IE8 只是在验证后转到下一个选项卡，不管任何事情。即使我返回 false；立即，它只是转到下一个选项卡。蜜獾不在乎，蜜獾只是转到下一个标签。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:59:08.070

您的问题在于使用“事件”而不是您实际调用事件的 e 。如下所示将事件更改为 e，它应该可以正常工作！=]

```
$("[id$='tab_TabContainer1_TabPanel2']").click(function(e) {
    var container = $find('TabContainer1');

    e.preventDefault(); //works for anything with preventDefault (e.g., not called from html onclick, etc.)

    $("[id$='Button1']").click();   //perform the button1 click event (which calls custom validation)

... 
```

# .net - 拖动选择时 ListView CheckBoxes 的不稳定行为

> ID：13864323
> 
> 赞同：1
> 
> 时间：2012-12-13T16:35:16.070
> 
> 标签：.net, winforms

我有一个启用了 es`ListView`的表单。`Checkbox`这是一个简单的示例程序：

```
[STAThread]
static void Main ()
{
    var form = new Form();
    var listView = new ListView() {
        Dock = DockStyle.Fill, CheckBoxes = true, View = View.List };
    listView.Items.Add("a");
    listView.Items.Add("b");
    listView.Items.Add("c");
    form.Controls.Add(listView);
    Application.Run(form);
} 
```

如果您运行此程序，请尝试**拖动选择**两个或三个`ListView`项目。这工作正常。但现在再试一次，“意外”在`CheckBox`.

结果是`CheckBox`鼠标光标下方本身不受影响，但所有其他选定项目都会根据该项目的状态被选中/取消选中`CheckBox`。最终用户发现这种行为不稳定，我同意。

是否有一种简单的方法可以`CheckBox`在拖动选择`ListView`项目时抑制这种意外更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T04:38:35.433

你可以试试[Better ListView Express](http://www.componentowl.com/better-listview-express) - 它是免费的，用托管代码重写，控制相当成熟。

此处修复了常规 .NET ListView 的复选框行为和其他故障。例如，复选框是完全动画的（热和按下状态），你甚至可以有单选按钮......

该控件甚至可以在商业上使用。还有一个[完整版](http://www.componentowl.com/better-listview)也支持三态复选框。

每个视图都支持复选框，不仅是详细信息。

![在此处输入图像描述](../Images/0047b75c1a62f1c01c7e494fdd66e8a4.png)

# javascript - 用于 Rails 的 Wicked_PDF 中更好的分页符

> ID：13864324
> 
> 赞同：0
> 
> 时间：2012-12-13T16:35:28.873
> 
> 标签：javascript, css, ruby-on-rails, wicked-pdf

我能够使用[此处](https://stackoverflow.com/questions/5806943/rails-wickedpdf-page-breaks)描述的技术在我想要的某些点处获得分页符。但是，我有如下两列布局：

```
 <div class='book-main-image'><img src="<%= page[:image] %>" /></div>

    <div class='book-headline-holder'>
      <h1><%= page[:title] %></h1>
    </div>

    <div class='book-sidebar book-main-section'>
      <div class='book-sidebar-section'>
        <h4>Location</h4>
        <div class='sidebar-text'><%= page[:location] %></div>

        <h4>Client</h4>
        <div class='sidebar-text'><%= page[:client] %></div>
      </div>
    </div>

    <div class='book-main-content book-main-section'>
      <div class='book-body'><%= page[:body].html_safe %></div>
    </div> 
```

样式如下：

```
 .book-main-section    { display: inline-block; vertical-align: top; }
  .book-sidebar         { width: 20%; margin-left: 3%; margin-top: 10px; }
  .book-main-content    { width: 70%; margin-left: 2%; } 
```

这在大多数情况下都很好，但是如果`book-body`div + 的高度`book-main-image`和`book-headline-holder`长于一页，则两个`book-main-section`div 都会转移到下一页，在一个页面上留下一个图像和标题，并且有很大的差距，其余的内容在下一页。

我尝试开始引入一些 javascript（在页面中使用指向 jQuery 的外部链接）以根据它们的高度将页面内容分解为单独的 div，但我永远无法执行 Javascript（似乎完全忽略它） . 有没有其他方法可以避免这种情况，或者让 javascript 工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:56:29.587

我发现修复它的方法是移除持有`page[:body].html_safe`. 该数据包含段落标签，因此我改为设置它们的样式并删除`<div class='book-body'>`and `<div class='book-main-content book-main-section'>`，并将段落设置为如下所示：

```
p { float:right; width: 70%; margin-left: 2%; margin-right: 35px; } 
```

# javascript - 监听元素“足够接近”的事件

> ID：13864325
> 
> 赞同：0
> 
> 时间：2012-12-13T16:35:35.473
> 
> 标签：javascript, css, events

我正在寻找一种技术、示例或库，用于在元素周围提供缓冲区以获取单击和悬停事件。

具体来说，这是针对我想要更大的点击目标的细分隔符。

任何想法都会很棒。唯一的要求是它不能影响页面其余部分或其他附近点击区域（最低优先级事件处理程序）的样式。

* * *

***更新这是我所在的位置：***

**HTML：**

```
 <div class="box">
      Hi there
      <div class="buffer"></div>
  </div>
  <span class="test">Hi there, I should still be clickable</span>​ 
```

**CSS：**

```
.box {
  position: relative;
  background: #ccc;
  height: 100px;
  line-height: 100px;
  width: 100px;
  text-align: center;
}

.box > .buffer {
  position: absolute;
  top: -10px;
  left: -10px;
  background: transparent;
  border: 1px solid;
  height: 120px;
  width: 120px;
} 
```

**JS：**

```
var box = document.querySelector('.box');
box.onclick = function(e) {
  alert('clicked on buffer')
}

var span = document.querySelector('.test');
span.onclick = function(e) {
  alert('clicked on span')
}​ 
```

JSfiddle：http: [//jsfiddle.net/ScSEe/](http://jsfiddle.net/ScSEe/)

唯一剩下的问题是缓冲区会压制附近的点击区域。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:53:27.923

我找到了一个优雅的解决方案，但它只适用于非`static`定位元素：

```
<div id="target" style="position:relative/* for example */; z-index:0;">
    <!-- just place this div into the target element: -->
    <div style="
      z-index:-1; /* placed directly behind parent element */
      position:absolute; /* needed for the below to work */
      top:-10px; left:-10px; bottom:-10px; right:-10px; /* around the parent */
     " />
     …
</div> 
```

在那个不可见区域中的点击将被委托给父元素，即使它们发生在它之外。定位代码使“缓冲区”总是比布局父级（最近的非静态祖先`z-index`）大一点，无论大小或位置（也包括动画等）。

[jsfiddle.net 上的演示](http://jsfiddle.net/ndC8b/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:37:08.623

如何将不可见`div`元素置于比其他元素更高的 z-index 以捕获这些事件？

```
<div id="click_region" style="z-index:1000; visibility:hidden;"></div>

$("div#click_region").click(function(){/*do yo thang*/}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:41:02.000

您可以将元素放置在透明 div 内，并将一些填充设置为分隔区域，然后只需将单击回调附加到父级即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T17:21:03.450

使用 CSS ::before 和/或 ::after 伪元素怎么样？

# php - 我的网站上的 Facebook 评论

> ID：13864332
> 
> 赞同：0
> 
> 时间：2012-12-13T16:35:54.120
> 
> 标签：php, mysql, facebook, comments

我已将 Facebook 社交插件添加到我的网站，它允许用户使用他们的 Facebook 个人资料发表评论。但是，我在一个页面上有超过 1 个项目，并希望用户发表单独的评论，因为目前，当用户对 1 个项目发表评论时，它会将该评论添加到每个项目。这可能是因为使用 while 循环将每个项目调用到站点上，该循环回显并打印存储在我的数据库中的每个项目。有谁知道是否有办法解决这个问题？如果有帮助，facebook 为用户提供的代码如下：

```
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=109566779171141";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

和

```
<div class='fb-comments' data-href='My URL' data-width='470' data-num-posts='10'></div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:42:30.623

这样做的唯一方法是为每个评论框分配一个唯一的 URL，即使它们在同一页面上，您也可以使用以下内容：

```
http://www.example.com/#comments1
http://www.example.com/#comments2
http://www.example.com/#comments3
... 
```

# view - 使用视图处理 SQL Server 标准版分区情况中的 ID

> ID：13864336
> 
> 赞同：2
> 
> 时间：2012-12-13T16:35:59.190
> 
> 标签：view, database-partitioning, clustered-index, fragmentation

# 短背景

大家好。我目前面临的情况是，我需要在 SQL Server 标准版的一个非常大的表上提高性能。该表是事务繁重的，预计会获得更多的事务。

# 解决方案第 1 部分

我决定使用类似于 Barry King 在这里提出的策略将表分成几个部分。所以我有一堆看起来像下面这样的表格。

```
CREATE TABLE [NewTable001](
    [DayId] [int] NOT NULL,
    [OriginalTableId] [bigint] NOT NULL,
    [CustomerId] [int] NULL
 CONSTRAINT [PK_OriginalTableID001] PRIMARY KEY CLUSTERED 
(
    [OriginalTableID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF,             ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [NewTable001]  WITH CHECK ADD  CONSTRAINT [CK_Day_001] CHECK  ([DayId]=(1))
GO

ALTER TABLE [NewTable001] CHECK CONSTRAINT [CK_Day_001]
GO 
```

我也有相应的视图来处理所有基础表。现在的问题，正如 Barry King 在他的博客文章中所说，是视图中唯一 ID 的处理。由于视图无法处理 ID，因此它们需要存储在表中并且无法利用身份功能。

# 解决方案第 2 部分

通过像这样创建一个单独的表：

```
create table PartitionIDHelper
(
ID bigint identity(10000001,1), --Hihger (with margin) than the higest value in current    table
Value int --Something that is quick to write
); 
```

然后在我的程序中使用此代码：

```
declare @ID bigint;
insert into PartitionIDHelper
select 1; --Just a value so that I can get the unique ID from the table
select @ID = @@IDENTITY; --My shiny new id value to use when writing to the view</pre> 
```

# 潜在问题

此解决方案的潜在问题是我可能以错误的顺序将值写入 [OriginalTableID]。

假设进程 A 先于进程 B 启动。进程 A 还在进程 B 之前从 PartitionIDHelper 表中获取 ID。然而，进程 B 更快，并且在进程 B 之前写入，导致在进程 A 之前写入我的聚集索引。

然后，进程 A 不会写入索引中的“最佳”位置，因为它是无序的。

# 潜在的解决方案

那么如何最好地解决这个问题呢？我可以想到两种策略。

1.  接受我的聚集索引会稍微出问题
2.  将每个表中的本地标识列用于聚集索引。

潜在的解决方案 2 在我看来是一条糟糕的道路，因为除了存储顺序之外，我永远不会将该列用于其他任何事情，因为它永远不会被排序、在 where 子句中使用甚至被选中。

在阅读了 Michelle Ufford 的这篇博文（大部分内容）之后，我倾向于坚持使用略微分散的聚集索引。下面的引用对我提出了一个难题，因为数据主要由单例查询访问，但它是一个插入速度很重要的 OLTP 系统。

> 我并不是建议您只在标识整数列上创建聚集索引。碎片化虽然通常是不可取的，但主要影响范围扫描查询；单例查询不会有太大影响。即使是范围扫描查询也可以从常规碎片整理工作中受益。然而，集群键的不断增加的属性是需要考虑的，并且在插入速度很重要的 OLTP 系统中尤其重要。

任何和所有的意见和建议将不胜感激！

/塔赫

# build - 使 CONFIG_DEBUG_SECTION_MISMATCH=y 似乎挂起

> ID：13864343
> 
> 赞同：0
> 
> 时间：2012-12-13T16:36:45.720
> 
> 标签：build, kernel, messages

使用 Linaro 4.7 工具链在 Ubuntu 上为 Android 手机构建 3.4.x 内核。

到目前为止，从另一台设备上移植调速器取得了很好的成功。

最新的使用更正的代码构建，但最后我得到了`make CONFIG_DEBUG_SECTION_MISMATCH=y`消息。

我跑了`make CONFIG_DEBUG_SECTION_MISMATCH=y`，所以我可以试着看看出了什么问题，但它到达`arch/arm/vfp/entry.o`并只是坐在那里。

我已经等了一段时间以获得进一步的输出，但由于我从来没有进行过不匹配调试，所以我不知道正常行为。

我应该继续等待吗？还是杀死它并尝试其他方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:50:56.410

好的，清理干净并重新运行它。通过了。

# c++ - 使用 sge 集群在 Matlab 下运行 C++ 代码？

> ID：13864347
> 
> 赞同：3
> 
> 时间：2012-12-13T16:37:03.553
> 
> 标签：c++, matlab, cluster-computing, sungridengine

我有一个运行 c++ 函数的 matlab 代码，它在我的计算机或我尝试运行它的任何其他桌面上运行良好。（为了在其他桌面上运行它，我复制了 matlab/c++ 函数和 mex 文件）

最近我尝试在 sge 集群上运行代码，但出现错误消息

“'double'类型的输入参数的未定义函数'img'”

“img”是matlab调用的c++函数。

有没有人遇到同样的问题？有谁知道如何解决它？

10x 埃拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:13:35.803

似乎您在笔记本电脑/台式机和 SGE 上有不同的操作系统。对于不同的架构，您需要重新`mex`编写您的 c++ 代码。

`mex`在您的 sge 上配置

```
>> mex -setup 
```

我强烈建议使用`gcc`. 现在您可以使用`mex`您的 C++ 代码了。请注意，mex 文件的文件扩展名在 windows/sge 以及 32 位和 64 位系统上是**不同的。**

如果你没有正确的 mex 文件扩展名（可以使用`mexext`命令检查）Matlab 找不到要运行的函数，你会得到一个与你得到的内容相似的错误。

光明节快乐。

# ajax - 重写 URL 和 AJAX

> ID：13864349
> 
> 赞同：0
> 
> 时间：2012-12-13T16:37:06.837
> 
> 标签：ajax, url, url-rewriting

我想知道是否可以使用重写的 url 制作工作 ajax。例如，我有一个名为从 javascript 接收 post 方法调用的 php 文件：“ajaxfile.php”，并且已被重写为“/rewritten-url/”。

这是javascript：

```
$(document).ready(function(){
    $("#button").click(function(){
         $.post("/rewritten-url/", {parameter: "75"}, function(result){
            $("#canvas").html(result);
         });
     });
 }); 
```

有一种方法可以保持对“/rewritten-url/”的调用，还是让我保持对“ajaxfile.php”的调用？我尝试了一个小例子，它适用于“ajaxfile.php”，但不适用于“/rewritten-url/”。

如果你问我“我为什么要这样做？” 这只是好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:43:01.077

是的，您可以，ajax 请求与普通浏览器请求相同，它们通过 http 传输，因此您可以重写、重定向等。

如果您使用的是 apache，则可以使用[mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)来执行此操作，就像使用普通 php 文件一样。

# c++ - 从桌面应用程序使用 Windows 8 Toast 通知

> ID：13864353
> 
> 赞同：5
> 
> 时间：2012-12-13T16:37:12.103
> 
> 标签：c++, winapi, windows-8, notifications, toast

我开发了一个桌面应用程序，它是一个用于 Windows 的简单 .exe。

它在 Windows 8 上运行良好。

我现在尝试使用“toast 通知”向用户显示一些警报。

因此，我使用 Microsoft 示例进行了培训，可在此处获得：[http ://code.msdn.microsoft.com/windowsdesktop/sending-toast-notifications-71e230a2/](http://code.msdn.microsoft.com/windowsdesktop/sending-toast-notifications-71e230a2/)

它工作正常，但我必须为我的应用程序创建一个快捷方式才能使用 toast 通知。

我试图删除快捷方式创建，但它不起作用。我理解，因为对于桌面应用程序，快捷方式是 toast 通知的先决条件，您可以在 Microsoft 网站上阅读：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh802768.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh802768.aspx)

我的问题很简单。如果用户决定删除快捷方式（这是他的个人资料文件夹中的 .lnk），如果没有此快捷方式，我的 toast 通知如何工作？

如果没有创建快捷方式，我不想每次在运行时都创建快捷方式，因为用户决定删除它，并且每次都创建它是不正确的。

那么，有什么方法可以在没有快捷方式的情况下使用桌面应用程序中的 toast 通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:09:30.557

您引用的[文档](http://msdn.microsoft.com/en-us/library/windows/apps/hh802768.aspx)似乎很清楚：

> 必须将带有 System.AppUserModel.ID 的应用程序快捷方式安装到“开始”屏幕。但是请注意，它不需要固定到“开始”屏幕。有关更多信息，请参阅如何通过 AppUserModelID 启用桌面 toast 通知。

请注意，“固定”和“已安装”之间存在区别，如果您可以在不固定的情况下安装（不确定是否可以），那么用户找到并删除它的可能性就会降低。

也就是说，永远不能保证捷径会在那里。也许您的应用程序在启动时（或任何时候）可以检测到快捷方式已消失并“温和地”通知用户他们的应用程序体验将不是最佳的，然后提供恢复快捷方式（您将以编程方式执行）。

请记住，用户始终可以按应用程序或系统范围内的应用程序关闭通知，因此删除快捷方式只是最终用户可能看不到您的通知的方式之一。

# java - Spring：更简单的 FormHttpMessageConverter

> ID：13864356
> 
> 赞同：1
> 
> 时间：2012-12-13T16:37:35.407
> 
> 标签：java, spring

我正在使用 Spring 的 RestTemplate 发送/接收 http 请求。我正在使用 Spring HttpEntity 创建 http 请求。我使用 HttpConverters 来序列化 http 请求中的应用程序对象，反之亦然。根据[Spring docs](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/remoting.html#rest-resttemplate)，有 4 个默认转换器：

*   ByteArrayHttpMessageConverter,
*   StringHttpMessageConverter,
*   FormHttpMessageConverter,
*   SourceHttpMessage 转换器。

我`FormHttpMessageConverter`用来序列化字符串中的几个属性值对，以便可以使用`RestTemplate`. 但是，`FormHttpMessageConverter`要求 http 请求参数值为 a `MultiValueMap`，因此，我需要为每个属性值对执行此操作：

```
final HttpHeaders headers = new HttpHeaders();
headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);
final MultiValueMap<String, String> postParams = new LinkedMultiValueMap<String, String>();

String attrib1[] = new String[]{"value1"};
postParams.put("attrib1", Arrays.asList(attrib1)); 
```

我想使用一个更简单的方法`HttpMessageConverter`，它可以为每个参数接受一个简单的地图。就像是：

```
final HashMap<String, String> postParams = new HashMap<String, String>();
postParams.put("exclusiveOnly", "value1"); 
```

我知道前一种形式更通用，但我认为后者对*很多*应用程序都很有用，所以我想知道为什么它不是`HttpConverter`Spring 中的默认值。无论如何，你能给我提示或点链接如何创建一个自定义`HttpConverter`来实现我想要的吗？

# javascript - 使用 javascript 获取电话区域设置

> ID：13864359
> 
> 赞同：0
> 
> 时间：2012-12-13T16:37:45.557
> 
> 标签：javascript, android, ios, locale

有谁知道使用javascript获取android和ios手机区域设置的方法？

我发现了这个：[http](http://docs.phonegap.com/en/2.2.0/cordova_globalization_globalization.md.html#Globalization) ://docs.phonegap.com/en/2.2.0/cordova_globalization_globalization.md.html#Globalization看起来会做到这一点，但我正在寻找一个不使用任何库的原因。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:42:06.110

试试这个：

```
 var language = window.navigator.userLanguage || window.navigator.language;
 alert(language); 
```

# objective-c - 无法使用保管箱 API 将文件（使用 ALAsset 库）上传到保管箱

> ID：13864360
> 
> 赞同：4
> 
> 时间：2012-12-13T16:37:54.617
> 
> 标签：objective-c, ios, dropbox, alassetslibrary

在我的 iOS 应用程序中，我正在尝试使用 Dropbox 提供的“uploadFile”调用。我正在使用 ALAssetsLibrary 选择以编程方式获得的特定照片/视频作为资产。我需要将该特定资产上传到保管箱。

```
//ALAsset *asset is the asset i intend to upload
[self.restClient uploadFile:[asset.defaultRepresentation filename] toPath:@"/" withParentRev:nil fromPath:[asset.defaultRepresentation.url absoluteString]]; 
```

Dropbox 似乎不喜欢资产承载的路径，看起来像这样：“assets-library://asset/asset.PNG?...”

我已经为应用程序启用了定位服务，并且我也能够列出所有资产。

上传调用在日志中引发错误“[警告] DropboxSDK：文件不存在 (assets-library://asset/asset.PNG?id=5DC234C1-B27E-45E2-BE61-46E9A266C818&ext=PNG)”。

调用 uploadFileFailedWithError 函数时出现错误 - ("Error Domain=dropbox.com Code=1001 "操作无法完成。(dropbox.com 错误 1001。")

我发送uploadFile调用的方式有什么问题吗，尤其是“从”路径？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T18:00:08.520

你只得到一个参考，而不是一个有效的文件 url，这对`AssetsLibrary`. 但是，您可以很容易地获取资产数据并将其保存到自己的磁盘中：

```
- (void)writeAsset:(ALAsset *)asset toPath:(NSString *)path
{
    ALAssetRepresentation *representation = asset.defaultRepresentation;
    long long size = representation.size;
    NSMutableData *rawData = [[NSMutableData alloc] initWithCapacity:size];
    void *buffer = [rawData mutableBytes];
    [representation getBytes:buffer fromOffset:0 length:size error:nil];
    NSData *assetData = [[NSData alloc] initWithBytes:buffer length:size];
    [assetData writeToFile:path atomically:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-23T03:10:47.307

@hwaxxer 的解决方案非常适合小型资产。如果您想存储任何大小的资产并避免内存消耗问题，请查看以下答案：

[SO：从 ALAsset url iOS 获取视频 NSData](https://stackoverflow.com/a/17694463/923642)

# java - 在 birt 上重复数据

> ID：13864362
> 
> 赞同：0
> 
> 时间：2012-12-13T16:37:59.520
> 
> 标签：java, birt

我正在开发一个 birt 报告，我需要根据我在查询中检索到的数字从我的数据集中打印数据。例如：查询只返回一行，其中一列是我需要重复从查询中检索到的数据的次数。它可以是 1 到 99999 之间的任何数字。

我怎样才能做到这一点？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T19:41:35.113

您可以做的一件事是创建一个脚本数据集并将原始数据集中的数据传递到一个数组中。在脚本集中，您将访问告诉您重复多少次的字段，并使用您想要重复的数据在数据集中创建那么多行。现在，您可以简单地在报告中使用脚本化的数据集。

要从原始数据集中传递数据，您可以使用 beforeFactory 中的数据引擎 API 来运行查询并填充数组，或者您可以简单地将隐藏文本框绑定到原始数​​据集并将其放在报告的顶部确保原始数据集首先运行并将您的数组填充到原始数据集的 onFetch 中。无论哪种方式都应该有效。

希望这可以帮助。

# git - 从远程分支创建了一个分支以进行快速修复，但 git status 显示了我在以前的工作分支中修改过的文件

> ID：13864364
> 
> 赞同：1
> 
> 时间：2012-12-13T16:38:03.903
> 
> 标签：git

我正在开发一个功能（在我的本地 master 分支上）， git status 显示我有 3 个未提交的修改文件。没关系。然后我注意到现场网站上的一个错误。我想放弃我目前的工作，并为这个错误创建一个快速修复。

我从远程仓库的 master 创建了一个分支： git checkout -b quickfix origin/master

但是 git status 显示我有 3 个修改过的文件。这是为什么？我没有对任何文件进行更新，只从远程创建了分支。

我只想从 remote/master 获得一个干净的分支，我可以开始使用 quickfix。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:36:56.060

您应该`stash`进行更改，以便将它们存储在“浮动”提交中，然后您可以在修复错误后将它们应用回来：

```
$ git stash save "Working on ... - going to bugfix"
$ git status --short # should show only untracked files
$ git checkout bugfix
# work work work
$ git add file1
$ git commit
$ git push # probably a merge and that
$ git checkout master
$ git stash pop # applies the last stash's changes to working copy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:37:44.163

Git 不会因为你切换了一个分支而删除文件——这很好，你不想丢失它们。这就是我要做的（从分支开始：

```
git add --all
git stash
git checkout quickfix
# do all the work you need to fix the problem and commit 
git checkout master
git stash pop # apply stashed work and remove it 
```

Git stash 会保存您所做的更改，您可以在修复其他内容后重新应用它们（您可以将隐藏的工作应用到不同的分支，如果需要，可以多次应用）。

# asp.net - “无法打开登录请求的数据库 [db]。” 服务器重新启动时。重新保存 web.config 后工作正常

> ID：13864366
> 
> 赞同：2
> 
> 时间：2012-12-13T16:38:10.420
> 
> 标签：asp.net, sql-server, iis, windows-server-2008

因此，每次出现此问题时，我只需打开该站点的 web.config 并保存即可。这会立即解决此问题，直到下一次服务器重新启动。这很好用，但我不想每次都这样做。我看到了几篇关于此引用权限的帖子，但这似乎不是我的问题（由于我每次都可以解决它）。

任何人碰巧对为什么此操作可能会修复它或有关可能导致此问题的任何想法有一些见解？

注意：该站点使用 SQL 身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T19:45:15.190

当您重新保存 web.config 时，您的站点会重新启动，因此您也可以通过在 IIS 管理器中重新启动您的网站来解决它。这个问题肯定是因为您的 w3svc 服务在您的 sql server 服务之前启动。将您的 w3svc 服务设置为延迟启动，您应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-19T19:13:05.610

当您使用延迟设置 web 服务启动类型并将登录名更改为管理员而不是本地时，问题得到解决。

# d3.js - D3.js SVG 阴影用于快速过渡

> ID：13864369
> 
> 赞同：4
> 
> 时间：2012-12-13T16:38:24.617
> 
> 标签：d3.js, css, transitions, dropshadow

为快速过渡制作阴影的最佳方法是什么？我已经尝试使用带有以下代码的过滤器，但它似乎使我的过渡更加不稳定（我有大约 20 个左右移动的矩形）：

```
var shadow = vis.append("defs").append("filter")
    .attr("id","dropshadow")
    .attr("height","130%");

shadow.append("feGaussianBlur")
    .attr("in","SourceAlpha")
    .attr("stdDeviation","3");

shadow.append("feOffset")
    .attr("dx","2")
    .attr("dy","2")
    .attr("result","offsetblur"); 
```

现代浏览器是否有任何跨浏览器的 CSS 阴影？（ie9+,chrome,firefox...不在乎支持别人）

有什么方法可以加快这种阴影的过渡速度吗？

有没有替代方法？我应该在它后面再画一个矩形吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-26T07:03:31.440

如果您正在寻找 CSS 阴影，那么您正在寻找的属性是`box-shadow`. 它受 IE9 及更高版本的支持，并具有四个属性：

*   阴影的水平偏移
*   垂直偏移
*   阴影必须模糊的值
*   然后它的传播

如果您希望以某种方式为阴影本身设置动画，它也会响应过渡变化。

[您可以在此处](http://www.w3schools.com/cssref/css3_pr_box-shadow.asp)更深入地查看 W3 链接。

# c# - 使用动态数据在 gridview 上显示 qtip/toolip

> ID：13864374
> 
> 赞同：0
> 
> 时间：2012-12-13T16:38:51.467
> 
> 标签：c#, asp.net, gridview, tooltip, qtip

我正在尝试使用数据库中的数据显示 qtip 或任何其他方式在 asp.net gridview 上显示工具提示。

我有 qtip 使用标题页面上的按钮，并且不确定如何将每个单元格悬停在 gridview 上（这是我的按钮代码）。

```
$('input[title]').qtip({
                content: {
                },
                position: {
                    corner: {
                        target: 'bottomRight',
                        tooltip: 'topLeft'
                    }
                },
                style: {
                    name: 'cream',
                    padding: '7px 13px',
                    width: {
                        max: 210,
                        min: 0
                    },
                    tip: true,
                    'color': '#666666'
                }
            }); 
```

也不确定如何从 qtip 中的代码后面调用函数并将我的行 ID 传递给它。

网格是具有数据绑定列的普通网格，如下所示：

```
<asp:GridView ID="gvmygrid" runat="server" AllowPaging="false" AllowSorting="true"
                            AutoGenerateColumns="false" GridLines="None">
                            <Columns>
                                <asp:BoundField DataField="firstColumn" HeaderText="Col1" ReadOnly="true" />
                                <asp:BoundField DataField="Type" HeaderText="Type" ReadOnly="true" />
 </Columns>
 </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:28:29.387

1) 为需要显示工具提示的网格视图列创建一个模板项，并为其提供一个 ID，以便可以从 javascript 中引用它。

2）我不知道你打算如何从数据库中获取数据，所以我实现了一个简单的 jQuery Web 服务调用，它通过用户悬停的单元格的 id 并从 WS 返回测试数据称呼

**ASPX：**

```
<head runat="server">
    <script src="Scripts/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="http://jquery.bassistance.de/tooltip/jquery.tooltip.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("table[id*=gvCustomers] span[id*=nationality]").tooltip({
                delay: 0,
                offset: [-65, -110],
                position: 'center top',
                bodyHandler: function () {
                    var id = $(this).closest("tr").find("span[id*=nationality]").text();
                    $.ajax({
                        type: "POST",
                        dataType: "text",
                        url: "CustomerService.asmx/GetNationality",
                        data: { nationalityId: id },
                        success: function (msg) {
                            $("#tool").html(msg);
                        },
                        error: function (err) {
                            alert("Web service call failed");
                        }
                    });
                   return $("<span id='tool' style='width:200px;background-color:black;color:white;' />");
                }
            });
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
        <asp:GridView ID="gvCustomers" runat="server" AutoGenerateColumns="False" DataSourceID="customersDS">
            <Columns>
            <asp:BoundField DataField="Name" HeaderText="Customer Name" />
                <asp:TemplateField>
                    <ItemTemplate>
                        <asp:Label runat="server" ID="nationality" Text='<%# Bind("NationalityId") %>' />
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView>
        <asp:SqlDataSource ID="customersDS" runat="server" ConnectionString="<%$ ConnectionStrings:connection %>"
            SelectCommand="SELECT [NationalityId], [Name] FROM [Customers]"></asp:SqlDataSource>
    </form>
</body> 
```

**ASMX：**

```
public class CustomerService : System.Web.Services.WebService
{
    [WebMethod]
    public string GetNationality(int nationalityId)
    {
        return nationalityId == 1 ? "Nationality1" : "Nationality2";
    }
} 
```

以下文章也可能有所帮助：

[jQuery 工具提示和 Ajax 工具提示数据源和 gridview](http://www.codeproject.com/Tips/265445/jQuery-tooltip-with-ajax-tooltip-datasource-with-g)

[在 GridView 中使用 JQuery 工具提示插件](http://www.junnark.com/blog/detail/10)

# usb - HID 报告描述符解析器：如何找到“点击”位位置

> ID：13864375
> 
> 赞同：1
> 
> 时间：2012-12-13T16:38:50.787
> 
> 标签：usb, mouse, hid

我需要获取有关从不同鼠标单击和释放的 Wheell 的信息。我在嵌入式设备上工作，可以访问原始形式的所有数据 - 字节流。

AFAIK 所有传输的字节都在 HID 报告描述符鼠标中进行了描述。我有 HID 报告描述符和来自 2 个不同鼠标的传输帧，但我不确定如何理解它们：

HID 罗技：

```
Interface 0 HID Report Descriptor Mouse
Item Tag (Value) Raw Data 
Usage Page (Generic Desktop) 05 01  
Usage (Mouse) 09 02  
Collection (Application) A1 01  
    Usage (Pointer) 09 01  
    Collection (Physical) A1 00  
        Usage Page (Button) 05 09  
        Usage Minimum (Button 1) 19 01  
        Usage Maximum (Button 3) 29 03  
        Logical Minimum (0) 15 00  
        Logical Maximum (1) 25 01  
        Report Size (1) 75 01  
        Report Count (3) 95 03  
        Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit) 81 02  
        Report Size (5) 75 05  
        Report Count (1) 95 01  
        Input (Cnst,Ary,Abs) 81 01  
        Usage Page (Generic Desktop) 05 01  
        Usage (X) 09 30  
        Usage (Y) 09 31  
        Usage (Wheel) 09 38  
        Logical Minimum (-127) 15 81  
        Logical Maximum (127) 25 7F  
        Report Size (8) 75 08  
        Report Count (3) 95 03  
        Input (Data,Var,Rel,NWrp,Lin,Pref,NNul,Bit) 81 06  
    End Collection C0  
End Collection C0 
```

Logitech 帧 4 字节，首先用于按钮：

```
00 00 00 00 : Button OFF (on release), X=0, Y=0, Whell=0
01 00 00 00 : Button 1 ON, X=0, Y=0, Whell=0
02 00 00 00 : Button 2 ON, X=0, Y=0, Whell=0 
```

隐藏雅科斯：

```
Interface 0 HID Report Descriptor Mouse
Item Tag (Value) Raw Data 
Usage Page (Generic Desktop) 05 01  
Usage (Mouse) 09 02  
Collection (Application) A1 01  
    Report ID (1) 85 01  
    Usage (Pointer) 09 01  
    Collection (Physical) A1 00  
        Usage Page (Button) 05 09  
        Usage Minimum (Button 1) 19 01  
        Usage Maximum (Button 3) 29 03  
        Logical Minimum (0) 15 00  
        Logical Maximum (1) 25 01  
        Report Count (3) 95 03  
        Report Size (1) 75 01  
        Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit) 81 02  
        Report Count (1) 95 01  
        Report Size (5) 75 05  
        Input (Cnst,Var,Abs,NWrp,Lin,Pref,NNul,Bit) 81 03  
        Usage Page (Generic Desktop) 05 01  
        Logical Minimum (-2047) 16 01 F8  
        Logical Maximum (2047) 26 FF 07  
        Report Size (12) 75 0C  
        Report Count (2) 95 02  
    Usage (X) 09 30  
    Usage (Y) 09 31  
    Input (Data,Var,Rel,NWrp,Lin,Pref,NNul,Bit) 81 06  
    Logical Minimum (-127) 15 81  
    Logical Maximum (127) 25 7F  
    Report Size (8) 75 08  
    Report Count (1) 95 01  
    Usage (Wheel) 09 38  
    Input (Data,Var,Rel,NWrp,Lin,Pref,NNul,Bit) 81 06  
    End Collection C0  
    Usage Page (Consumer Devices) 05 0C  
    Usage (AC Pan) 0A 38 02  
    Report Count (1) 95 01  
    Input (Data,Var,Rel,NWrp,Lin,Pref,NNul,Bit) 81 06  
End Collection C0  
Usage Page 06 F3 F1  
Usage 0A F3 F1  
Collection (Application) A1 01  
    Report ID (2) 85 02  
    Usage 09 00  
    Report Count (1) 95 01  
    Report Size (8) 75 08  
    Logical Minimum (0) 15 00  
    Logical Maximum (255) 26 FF 00  
    Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit) 81 02  
End Collection C0 
```

YACOSS 帧 7 字节，按钮秒：

```
01 00 00 00 00 00 00 Button 1 OFF (released), X=0, Y=0, Wheel=0, AC Pan=0 
01 01 00 00 00 00 00 Button 1 ON , X=0, Y=0, Wheel=0, AC Pan=0 
01 02 00 00 00 00 00 Button 2 ON , X=0, Y=0, Wheel=0, AC Pan=0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T20:01:26.967

报告描述符格式在 HID 的设备类定义中进行了说明。鼠标也包含在 HID 使用表文档中。所有这些都可以在 usb.org 的 HID 页面上找到 -> [http://www.usb.org/developers/docs/hidpage/](http://www.usb.org/developers/docs/hidpage/)

我在这里写了关于嵌入式 HID 的博客，包括报告描述符 -> [http://www.circuitsathome.com/category/mcu/arduino/usb-shield/hid](http://www.circuitsathome.com/category/mcu/arduino/usb-shield/hid)

此外，如果您只需要鼠标的某些功能，例如 X、Y、滚轮和 3 个按钮，您可以将其初始化为启动设备。然后，任何鼠标都将具有相同的报告结构（请参阅启动鼠标），您可以将其硬编码到您的应用程序中。

# android - sqlite 字段值在存储在双字段中时四舍五入

> ID：13864380
> 
> 赞同：0
> 
> 时间：2012-12-13T16:39:07.840
> 
> 标签：android, sqlite, android-sqlite

我已将位置存储在我的 sqlite 数据库中。

```
CREATE TABLE city
    (
        latitude NUMERIC,
        longitude NUMERIC
    ) 
```

以下是价值：-

```
latitude = 41.0776605;//value in db - NUMERIC stored as DB - also tried with TEXT
longitude = -74.170086;//value in db - NUMERIC stored as DB - also tried with TEXT 
```

**更新-当我执行以下查询时，我检查了该值并得知它给了我存储在数据库中的相同值，但是当我尝试将其存储在双变量中时，它以某种方式舍入了它的值，这就是为什么我在变量中得到不正确的值。有什么解决办法吗？**

```
final String query = "SELECT * FROM city";    
cursor = myDataBase.rawQuery(query, null);
        if (null != cursor) {
            while (cursor.moveToNext()) {
                Log.i(TAG, "Latitude == " + cursor.getDouble(cursor.getColumnIndex("latitude")));
                Log.i(TAG, "Longitude == " + cursor.getDouble(cursor.getColumnIndex("longitude")));
            }
        } 
```

结果：-在将其存储到字符串或双变量时，值发生了变化，它给了我以下值。

```
Latitude = 40.4127
Longitude = -74.25252 
```

我不想四舍五入这个值。有什么办法可以解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T22:37:18.403

SQLites 将浮点值作为 64 位值写入和读取，其格式与 Java 的`double`. 从来没有任何四舍五入。

您的问题是将值转换为字符串。使用类似[`DecimalFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)或的助手[`Formatter`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html)来指定您想要的位数。

# php - http_post_fields() 无法解析主机名

> ID：13864381
> 
> 赞同：1
> 
> 时间：2012-12-13T16:39:08.553
> 
> 标签：php, http, curl, pecl

我的 PHP 脚本使用 http_post_fields() 向另一台服务器发出 post 请求。以下是代码示例：

```
$g = http_post_fields("http://mysite.com", $some_array); 
```

尽管脚本偶尔会起作用，但我经常会收到此错误：

```
 http_post_fields() [function.http-post-fields]: couldn't resolve host name; name lookup timed out 
```

我现在在函数中尝试了各种http地址，都导致这个错误。有谁知道我的麻烦的根源是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:50:36.053

如果您有 ssh 访问权限，请在 shell 上尝试此命令`ping mysite.com`，看看是否有任何响应

可以有防火墙/代理服务器配置来防止从服务器发送 POST 请求

试试这个并检查域解析为 IP。

```
<?php
$ip = gethostbyname('www.example.com');

echo $ip;
?> 
```

带有 HTTPRequest 的示例，它将回显状态代码

```
<?php
$r = new HttpRequest('http://www.example.com/', HttpRequest::METH_POST);
$r->addPostFields(array('param1' => 'value'));

try {
   $http_req->send();
} catch (HttpException $ex) {

}

$response_code = $http_req->getResponseCode();
 echo $response_code;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T15:55:30.717

Thanks for all the input Kasun. In the end, I got tired of this PECL library (where http_post_fields is defined) and I used cURL instead. The goal I'm reaching for here, is to request a security ticket from 1 server to another. Of course, the whole module works smoothly, now that I'm using cURL. Thanks again.

# nhibernate - Fluent NHibernate 一对一没有 cascade all-delete-orphan

> ID：13864384
> 
> 赞同：4
> 
> 时间：2012-12-13T16:39:21.190
> 
> 标签：nhibernate, cascade, fluent, one-to-one

我正在将现有的 *.hbm.xml 文件更新为流利的 ClassMaps，并且偶然发现了我们的映射文件中的错误，并且我不知道我正确映射它的默认行为。

映射文件有：

```
<one-to-one name="LineItemAssembly" 
            class="LineItemAssembly" 
            cascade="all-delete-orphan" /> 
```

使用 Fluent 时，我希望它映射到：

```
HasOne<LineItemAssembly>(x => x.LineItemAssembly)
                        .Cascade.AllDeleteOrphan(); 
```

但是，AllDeleteOrphan() 不是 Cascade 的选项（并且正确如此）。我知道这是因为它不是一个选项，而是因为它是映射文件中的错误。使用 Fluent 的等效映射是什么，以便我的 fluent 映射具有与 .hbm.xml 文件完全相同的功能？我认为将 Cascade 排除在 Fluent 映射之外将是默认行为，但我不确定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-05-17T13:37:17.150

NHibernate 4.1 现在支持这一点 - 现在正确支持一对一关系级联“all-delete-orphan”（问题[NH-1262](https://nhibernate.jira.com/browse/NH-1262)已在 4.1 中修复）。我对此进行了测试并且可以确认它正在工作——一旦你将孩子的一对一属性设置为 null，它就会为孩子发出 sql delete 命令。

不幸的是，fluent nhibernate 不支持它，因为它最后一次更新是在 2015 年。但是，您可以从源代码（[https://github.com/jagregory/fluent-nhibernate](https://github.com/jagregory/fluent-nhibernate) ）自己构建 fluent nhibernate ，[如何构建 Fluent NHibernate ？](https://stackoverflow.com/questions/343203/how-to-build-fluent-nhibernate) _

然后您所要做的就是将方法`AllDeleteOrphan`从`CollectionCascadeExpression`一个类移动到`CascadeExpression`另一个类并构建它（您也可以使用 Visual Studio 2010+ 打开 FluentNHibernate.sln 来构建它，但您必须至少运行一次“rake”命令）。

[![在此处输入图像描述](../Images/c16268119c4f5bb61f7d18241b6904c7.png)](https://i.stack.imgur.com/LS3tS.png)

自定义构建（由我）FluentNHibernate.dll 版本 2.0.3.1，支持 HasOne AllDeleteOrphan 可以从 [这里下载](https://www.dropbox.com/s/tmcym0tgmyfba0s/FluentNHibernate_2.0.3.1_with_hasone_alldeleteorphan_support.zip?dl=0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:16:09.620

您不能在 1:1 关系中拥有孤儿，根据定义，两条记录都必须存在。删除将始终以 1:1 级联。我不知道为什么 XML 地图允许这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T20:06:04.980

最后，我只需要找出问题所在并修复它，而不管默认的流利行为如何。[在http://brunoreis.com/tech/fluent-nhibernate-hasone-how-implement-one-to-one-relationship/](http://brunoreis.com/tech/fluent-nhibernate-hasone-how-implement-one-to-one-relationship/)的帮助下，我能够解决这个问题。

我需要添加 .Cascade.All()。但是，我真正需要的是在 LineItemAssembly 类的映射中脱离 HasOne 关系的 .ForeignKey()。

# java - 带有 GUI 的 Javax.swing.timer (Eclipse)

> ID：13864385
> 
> 赞同：3
> 
> 时间：2012-12-13T16:39:21.410
> 
> 标签：java, user-interface

我想做一个代码，从面板的左侧移动到面板的右侧......我意识到你可以简单地让一个图像出现在代码块中，然后在下一个块中代码让图像被一个完全相同的正方形重叠，只是与背景颜色相同...为此，我需要一个类似代码的计时器，使其显示图像，然后 1 秒后它重叠并然后新图像出现在它旁边

意识到 sleep.thread 不适用于 gui 我正在求助于 Javax.Swing.Timer

我现在只想让它旁边出现一个框

但是我没有这方面的经验，需要一些帮助才能让它与我的代码一起使用 - 安德鲁

```
 {

          g.setColor(Color.GREEN);
          g.fillRect(50, 100, 100, 100); //first box on a red background

                      //Timer goes here

                      g.setColor(Color.RED);
          g.fillRect(50, 100, 100, 100);//overlapps the first box
                      g.setColor(Color.GREEN);
          g.fillRect(50, 110, 100, 100);//sets a new box right beside it

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:06:46.647

创建一个`javax.swing.Timer`实际上非常简单。您不必自己担心线程，因为调度会在后台线程中自动发生，但您实现的侦听器的代码是在 GUI 线程中执行的。因此，您可以使用侦听器主体中所需的任何摆动组件。

```
int interval = 1000; // repeating every 1000 ms
new Timer(interval, new ActionListener() {
    @Override
    public void actionPerformed(ActionEvent e) {
        // do whatever painting that you want
    }
}).start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:33:45.867

你初始化它：

```
Timer <timernamegoeshere> = new Timer(<delayinmilis>,<actionlistener>); 
```

因此，您在计时器中输入的每一毫秒都会构造一个动作。

这意味着您可以简单地将更新代码放入 中，`actionPerformed`并有一个变量增加您移动正方形的像素数量和一个布尔值，从 切换`true`到`false`，`true`它绘制它，并将`false`它设置为背景的颜色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T17:57:20.793

我建议你使用 ExecutorService

[http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)

例如，您可以做类似的事情

```
private static ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(2);
scheduledThreadPool.scheduleAtFixedRate(new DrawingTask(), 1000, 1000 TimeUnit.MILLISECONDS); 
```

您的绘图任务可能如下所示：

```
public class DrawingTask extends TimerTask {

@Override
public void run() {
// previous co ordinates. This should be static
// sleep for a second
// re draw the old one
// draw the new one
}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T17:43:16.727

我不确定这是否是*最好*的方法，但您可以轻松地重新定义一个正方形以拥有一个位置。反过来，您可以让计时器更新方形实例的位置，然后调用 repaint()。这意味着paint方法只是在新位置绘制背景和同一个正方形，而不是每次都创建一个新正方形。

然后，您的绘画方法可能具有以下内容：

```
g.drawRect(referenceToSquare.getLocation().getX(), referenceToSquare.getLocation().getY(), 100, 100) 
```

您使用以下命令初始化计时器：

```
 Timer timer = new Timer(delayInMillis);
   timer.add(new ActionListener()); 
```

然后在同一个班级有一个...

```
 actionPerformed(ActionEvent e) {
       if(e.getSource() == timer) {
           referenceToSquare.getLocation().getX()++;
       }
       frame.repaint();
     } 
```

[http://docs.oracle.com/javase/6/docs/api/java/awt/event/ActionListener.html](http://docs.oracle.com/javase/6/docs/api/java/awt/event/ActionListener.html)

# java - GZIPInputStream 格式问题

> ID：13864386
> 
> 赞同：0
> 
> 时间：2012-12-13T16:39:26.660
> 
> 标签：java, gzipinputstream

我在阅读 GZipped BlueCoat 日志文件时遇到问题。该文件的前六行是一个标题，这些行可以完美读取，但没有以下内容。

我已经尝试手动解压缩日志，然后尝试使用稍微修改的代码读取文件，并且效果很好。我怀疑这是 ASCII 与 UTF8 与 UTF16 的问题，但我无法深入了解这一点，特别是因为它似乎改变了中间文件。

我目前的代码是：

```
InputStream fileStream;
InputStream gzipStream;
Reader decoder;
BufferedReader thisBr;

try {
    fileStream  = new FileInputStream(currentFile);
    gzipStream  = new GZIPInputStream(fileStream);
    decoder     = new InputStreamReader(gzipStream, "UTF-8");
    thisBr      = new BufferedReader(decoder);                    

    String logLine = thisBr.readLine();
    while (logLine != null)
    {
        logWriter.write(logLine + "\n");
        logLine = thisBr.readLine();
    }
    logWriter.flush();
    gzipStream.close();
} catch (IOException e) {
    System.out.println("Exception has been thrown:" + e);
} 
```

# vim - 如何自动更改 Vim 中的当前路径？

> ID：13864389
> 
> 赞同：7
> 
> 时间：2012-12-13T16:39:30.093
> 
> 标签：vim, macvim

当我在终端输入类似

```
mvim ./path/to/my/project 
```

Vim 打开这个项目目录，在我的 NERDTree 中我可以看到文件，但是当我尝试运行一些 CLI 命令时，比如

```
:!touch some/file/in/my/project 
```

它发生，我当前的路径是我的用户主目录

所以如果我想在我的项目目录中创建文件，我必须输入完整路径

```
:!touch ./path/to/my/project/some/file/in/my/project/name 
```

vim启动后是否可以以某种方式自动更改目录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T23:01:00.613

对于您的特定用例，您可以尝试在 VimEnter 事件上连接一些东西。例如，试着把它放在你的 vimrc 中：

```
autocmd VimEnter * cd %:p:h 
```

然后，当你调用 Vim 时，`$ mvim path/to/my/project/some/file`Vim 会自动`:cd`进入目录`file`所在的目录。

为此，您必须在自动命令中添加一些逻辑，例如

```
autocmd VimEnter * exe 'cd '.(isdirectory(expand('%:p')) ? '%:p' : '%:p:h') 
```

您可以自己改进这一点！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T20:30:05.963

我在我的 vimrc 中使用它：

```
" Use %% on the command line to expand to the path of the current file
cabbr <expr> %% expand('%:p:h') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-14T08:32:30.090

如何最好地解决这个问题取决于您的确切用例。我偏爱`:set autochdir`，但是如果您希望将工作目录设置为项目根目录，我会使用*本地 vimrc*插件之一（我使用[localrc.vim - 启用每个目录的配置文件](http://www.vim.org/scripts/script.php?script_id=3393)），在每个目录中创建一个本地`.vimrc`文件您的项目根源与

```
:cd expand('<sfile>:p:h') 
```

在里面。然后，无论您打开项目层次结构中的哪个文件，工作目录都将始终设置为项目根目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-07T09:24:30.383

in_vimrc

```
au BufEnter * silent! lcd %:p:h 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-19T10:41:19.903

试试下面的命令

```
:cd %:p:h 
```

[https://vim.fandom.com/wiki/Set_working_directory_to_the_current_file](https://vim.fandom.com/wiki/Set_working_directory_to_the_current_file)

# actionscript-3 - AS3_Manual 和 Auto 按钮事件处理程序故障排除

> ID：13864393
> 
> 赞同：1
> 
> 时间：2012-12-13T16:39:43.267
> 
> 标签：actionscript-3

我有一个项目，它有 30-40 帧，每帧都有影片剪辑。把每一帧想象成一张幻灯片。舞台底部有控制这些幻灯片功能的按钮（例如播放、暂停、下一个、上一个、加速、减速和刷新）。但是，让我头疼的两个按钮是手动模式和自动模式按钮。他们的名字正是他们的声音，手动应该在每个 mc 在每一帧播放后停止。自动应该按顺序播放每一帧。我现在设置它的方式是每个 mc 触发一个“完成”和“停止”的 EventDispatch。根据最后单击的按钮，舞台将侦听事件并暂停 4 秒 (setInterval) 并转到NextFrame，或者在该帧上停止，直到用户单击下一步。我试过一个开关盒，

我是新手，所以要温柔。如果有帮助，我会上传 flv。非常非常非常感谢。

```
//Manual button actions
function manual_onClick(event:MouseEvent)
{
    manual_btn.visible = false;
    auto_btn.visible = true;
    gotoAndStop(currentFrame);
    stage.removeEventListener("finished", mcFinished);
    stage.addEventListener("stopped",stopmc,false,0);

    function stopmc(e:Event):void
    {
        trace("mc stop");
        stage.removeEventListener("stopped",stopmc);
    }
}

//Auto button actions
function auto_onClick(event:MouseEvent)
{
    gotoAndStop(currentFrame + 1);
    manual_btn.visible = true;
    auto_btn.visible = false;
    stage.addEventListener("finished", mcFinished2,false,1);

    function mcFinished2(e:Event):void
    {
        var ID2 = setInterval(goNextFrame2,3000);
        trace("mc complete");
        function goNextFrame2()
        {
            gotoAndStop( currentFrame + 1 );
            clearInterval( ID2 );
            stage.removeEventListener("finished", mcFinished2);
        }
    }
} 
```

以及来自每个 mc 的 dispatchEvent

```
stop();

dispatchEvent(new Event("finished", true));
dispatchEvent(new Event("stopped", true)); 
```

再次感谢！斯科特

这是开关盒尝试...

```
function onBtnClicked(evt:MouseEvent):void
{
    var theBtn:DisplayObject = evt.currentTarget as DisplayObject;
    var lastBtn:DisplayObject;

    if (lastBtn)
    {
        lastBtn.addEventListener(MouseEvent.CLICK, onBtnClicked);
    }

    lastBtn = theBtn;

    switch (theBtn)
    {
        case auto_btn :
            //button one actions;
            gotoAndStop(currentFrame + 1);
            manual_btn.visible = true;
            auto_btn.visible = false;
            trace("auto button clicked");

            stage.addEventListener("finished", mcFinished);
            function mcFinished(e:Event):void
            {
                var ID = new setInterval(goNextFrame,3000);
                trace("mc complete");
                function goNextFrame()
                {
                    gotoAndStop( currentFrame + 1 );
                    clearInterval( ID );
                    stage.removeEventListener("finished", mcFinished);
                    stage.addEventListener("finished", mcFinished);
                }
            }

            break;
        case manual_btn :

            manual_btn.visible = false;
            auto_btn.visible = true;
            trace("manual button clicked");

            stage.removeEventListener("finished", mcFinished);
            stage.addEventListener("stopped",stopmc,false,1);

            function stopmc(e:Event):void
            {
                trace("mc stop");
                stage.addEventListener("stopped",stopmc);
                stage.removeEventListener("stopped",stopmc);
            }

            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:06:07.537

这里有一些建议。

首先，您不需要在每个剪辑的末尾有两个单独的事件（“完成/停止”），因为它们提供完全相同的功能。我建议只做一个事件并使用内置事件，如`Event.COMPLETE`. 所以你的个人剪辑的最后一帧看起来像这样：

```
stop();
dispatchEvent(new Event(Event.COMPLETE, true)); 
```

在您的各个剪辑的第一帧上，我会添加以下内容：

```
//use these two listeners so that the clip is only listening when it's being displayed on the timeline.
this.addEventListener(Event.ADDED_TO_STAGE,init,false,0,true);
this.addEventListener(Event.REMOVED_FROM_STAGE,unload,false,0,true);

function init(e:Event){
    stage.addEventListener("Play",playMe,false,0,true);
    stage.addEventListener("Pause",pauseMe,false,0,true);
}

function unload(e:Event){
    stage.removeEventListener("Play",playMe,false);
    stage.removeEventListener("Pause",pauseMe,false);
}

function playMe(e:Event){
    play();
}

function pauseMe(e:Event){
    stop();
} 
```

这是我将如何执行其余代码的方法：

```
stop();  //stop the main timeline

manual_btn.addEventListener(MouseEvent.CLICK, onBtnClicked);
auto_btn.addEventListener(MouseEvent.CLICK, onBtnClicked);

var nextTimer:Timer = new Timer(4000,1); //a timer to wait 4 seconds before auto next.
nextTimer.addEventListener(TimerEvent.TIMER, nextSlide); //what the timer should do when it's done

var isAuto:Boolean = true;  //a variable that holds the state of automatically continuing to the next slide. set it's default to either true or false

this.addEventListener(Event.COMPLETE,slideComplete); //listens for any slide complete event

//this function will get run whenever one of your slides is complete.
function slideComplete(e:Event = null):void {
    if(isAuto){
       nextTimer.reset();
       nextTimer.start(); //start the timer
    }
}

function onBtnClicked(evt:MouseEvent):void {
    manual_btn.visible = (evt.currentTarget == manual_btn);
    auto_btn.visible = (evt.currentTarget == auto_btn);

    isAuto = auto_btn.visible;
}

function nextSlide(e:Event = null):void {  //default e to null so you can call this function directly nextSlide(); - have your next button click call this function too
    nextTimer.reset(); //stop/reset the timer 
    nextFrame(); //tell the main timeline to go to the next frame
}

function prevSlide(e:Event = null):void {
    nextTimer.reset(); //reset the timer in case it's running
    prevFrame();
}

function pause(e:Event = null):void {
    nextTimer.reset():
    stage.dispatchEvent(new Event("Pause")); //have your individual clips listen for this event and stop
}

function playSlide(e:Event = null):void {
    nextTimer.reset();
    stage.dispatchEvent(new Event("Play")); //have your individual clips listen for this event and play;
} 
```

您希望在所有按钮单击时重置计时器的原因是，当自动下一个等待触发时，您在 4 秒窗口中点击了上一个或下一个。示例：自动下一张打开，幻灯片完成后 1 秒，您点击上一张按钮 - 它移至上一张幻灯片，3 秒后计时器将触发并移至下一帧。

# cordova - 使用 jQuery Mobile 和 Phonegap 播放视频

> ID：13864394
> 
> 赞同：5
> 
> 时间：2012-12-13T16:39:43.443
> 
> 标签：cordova, jquery-mobile, html5-video

我对移动应用程序还很陌生，所以我尝试使用 Phonegap 和 jQuery Mobile 构建一个简单的视频播放器。问题是，jQuery mobile 似乎出于某种原因阻止了视频播放。

为了排除故障，我将它直接剥离回以下 HTML，但得到相同的结果，即视频应该在的黑色矩形，但没有视频播放或控件。

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css" />
<script type="text/javascript" src="cordova-2.2.0.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/jquery.mobile-1.2.0.js"></script>
    <title></title>
</head>
<body>
    <div>
        <video controls autoplay>
            <source src="video/video1.mp4" type="video/mp4" >
        </video>
    </div>
</body>
</html> 
```

如果我删除指向 jquery.mobile-1.2.0.js 的链接，视频会显示并播放，否则，只会显示黑色矩形。

我根本不知道 jQuery mobile，但是在 js 中搜索视频元素的引用并没有显示出来，所以我不知道是什么阻止了它。

该代码在 Chrome 和 Firefox 中运行良好。Xcode 中没有控制台消息。我也尝试连接到[http://debug.phonegap.com/](http://debug.phonegap.com/)但这也没有给出错误消息。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-22T12:43:12.520

发生这种情况是因为 ios 阻止了内联媒体播放。对于 ios 您应该在 config.xml 中添加以下内容

```
 <preference name="AllowInlineMediaPlayback" value="true"/> 
```

让你的代码工作。您可能需要将 webkit-playsinline 添加到您的视频标签中以查看更多信息，请查看[Config.xml cordova doc](http://cordova.apache.org/docs/en/latest/config_ref/index.html)

您可能需要设置其他属性，例如

```
MediaPlaybackRequiresUserAction(boolean) or MediaPlaybackRequiresUserAction(boolean) 
```

[在Config.xml cordova doc](http://cordova.apache.org/docs/en/latest/config_ref/index.html)中获取有关它们的完整详细信息

# jquery - 如何在不在 JQuery 中创建新的 html 元素的情况下附加列表项？

> ID：13864400
> 
> 赞同：1
> 
> 时间：2012-12-13T16:40:02.413
> 
> 标签：jquery, html, ajax, append

我有一个包含多个列表元素的无序列表。现在通过 Jquery 我想从我的数据库中加载更多项目，然后将它们附加到我的列表中。我的代码：

```
$("#somediv").append($("<div>").load("ajax.php?action=getresults", function()
{
    $('#busy').delay(1500).fadeOut(700);
})); 
```

这里的问题是我不想将新的 html 添加到我的无序列表中，因为我的列表项将由我的 ajax 请求“创建”。所以我的 ajax 请求将例如返回`<li>some value</li>`，然后这应该附加到`ul`. 所以实际上我想做类似的事情

```
$("#somediv").append($("").load("ajax.php?action=getresults", function()
{
    $('#busy').delay(1500).fadeOut(700);
})); 
```

在 JQuery 中不创建新的 html 元素（在本例中为 div 元素）的情况下追加内容的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:46:47.403

如果我正确理解了您的问题，您需要使用`ajax()`而不是`load()`让您更好地控制接收到的数据会发生什么。试试这个：

```
$.ajax({
    url: "ajax.php?action=getresults",
    dataType: "html", 
    success: function(html) {
        $("#somediv").append(html);
        $('#busy').delay(1500).fadeOut(700);
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:47:13.360

我认为更清洁的方式：

```
$.get("ajax.php?action=getresults", function(html){
     $("#somediv").append(html);
     $('#busy').delay(1500).fadeOut(700);
});​​​ 
```

# amazon-web-services - EC2实例被回收时如何得到通知？

> ID：13864403
> 
> 赞同：0
> 
> 时间：2012-12-13T16:40:05.620
> 
> 标签：amazon-web-services, amazon-ec2

由于各种原因、硬件问题、维护等，亚马逊有时会回收（关闭并重新创建）EC2 实例。当这种情况发生时，您如何得到通知？我已经尝试了几个状态检查警报，但它们似乎没有被触发。而且这种情况很难重现，因为由亚马逊决定何时回收。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T00:53:38.803

您可以创建单个实例（min=1，max=1）的自动缩放组，然后订阅它的自动缩放事件。这是我为此目的使用的 Bash 脚本的一部分（假设您已安装 AWS 命令​​行工具）。

```
# Create SNS topic and email subscription to receive notifications
SNS=$(sns-create-topic AWS-MyApp)
sns-subscribe $SNS --protocol email --endpoint me@example.com

# Create launch configuration
as-create-launch-config app-as-cfg_sm --image-id ami-05dd5c6c --instance-type m1.small --group app-sg --key myapp-prod-key

# Make an autoscaling group of one instance with the launch config
as-create-auto-scaling-group app-as-grp --launch-configuration app-as-cfg_sm --min-size 1 --max-size 1 --default-cooldown 120 --grace-period 300 --tag "k=Name, v=MyApp-Autoscale, p=true"

# Subscribe to all the autoscaling events so I know what's going on.
as-put-notification-configuration --topic-arn $SNS --auto-scaling-group 'app-as-grp' --notification-types autoscaling:EC2_INSTANCE_LAUNCH, autoscaling:EC2_INSTANCE_TERMINATE, autoscaling:EC2_INSTANCE_TERMINATE_ERROR, autoscaling:EC2_INSTANCE_LAUNCH_ERROR 
```

# java - Java：输入流/输出流的默认值？

> ID：13864404
> 
> 赞同：0
> 
> 时间：2012-12-13T16:40:06.677
> 
> 标签：java, android, inputstream, outputstream

我正在尝试使用 android 中的库连接到终端仿真器，这将连接到串行设备并应该向我显示发送/接收的数据。要附加到终端会话，我需要向 setTermIn(InputStream) 提供输入流，向 setTermOut(OutputStream) 提供输出流。

但是，当我如下声明流时，它们默认为 null 不是吗？

```
private OutputStream bos;
private InputStream bis;

...

//inside onCreate() method
session.setTermIn(bis);
session.setTermOut(bos);
/* Attach the TermSession to the EmulatorView. */
mEmulatorView.attachSession(session) 
```

因此，当我尝试将流附加到会话时，出现错误：

```
FATAL EXCEPTION: TermSession input reader
java.lang.NullPointerException at jackpal.androidterm.emulatorview.TermSession$2.run(TermSession.java:137) 
```

它指向库中的这段代码：

```
public void run()
{
    try
    {
        while (true)
        {
            int read = mTermIn.read(mBuffer);
            if (read == -1)
            {
                // EOF -- process exited
                return;
            }
            mByteQueue.write(mBuffer, 0, read);
            mMsgHandler.sendMessage(mMsgHandler.obtainMessage(NEW_INPUT));
        }
    }
    catch (IOException e)
    {
    }
    catch (InterruptedException e)
    {
    }
} 
```

这是因为我还没有开始发送和接收数据，所以我还没有将数据分配给流。我该怎么做，设置一些虚假数据以分配给流？我试过了，它仍然抱怨。也许我做错了。

要发送和接收数据，我有以下方法，尽管我不应该在每次调用它们时都设置流。

覆盖通过串行发送数据以设置流的方法，只要我按回车键就会运行：

```
public void sendData(byte[] data)
{
    bos = new ByteArrayOutputStream(data.length);
} 
```

每当接收到数据时运行：

```
public void onDataReceived(int id, byte[] data) 
{
    bis = new ByteArrayInputStream(data);
} 
```

如何正确初始化这些？我真的应该在每次发送和接收数据时都设置流吗，这有关系吗？还是我应该做一些检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:44:45.827

您必须在使用它们之前`bis`进行初始化`bos`

你可以把它放在使用这两行之前

```
session.setTermIn(bis);
session.setTermOut(bos); 
```

# mysql - 我可以在 Kettle Pentaho 中从 MySQL 执行 LOAD DATA INFILE 吗？

> ID：13864409
> 
> 赞同：1
> 
> 时间：2012-12-13T16:40:46.343
> 
> 标签：mysql, kettle

我正在为 ETL 一个大文本文件构建一个 Kettle 转换，转换没问题，但是加载的过程很慢，我知道 Kettle 有一个名为 MySQL Bulk Loader 的函数，但只适用于 Linux，我正在研究窗户环境。

我想在转换后使用来自 MySQL 的 LOAD DATA INFILE，我尝试使用 Execute Sql Script，但启动“You have an error in your SQL syntax”错误，直接在 MySQL 中脚本执行得很好。

有人知道我是否可以在 Kettle 中使用 LOAD DATA INFILE 或者对从 Kettle 加载 MySQL 中的大文本文件有更好的想法

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T08:54:08.537

您可以使用kettle作业将文件传递到MySQL服务器（或运行mysql客户端的其他MySQL机器上）并从系统调用脚本执行加载文件：

> mysql -u 用户 -ppassword test_db < import_data.sql

# javascript - Mac OS X Chrome 上的灰色/漫反射文本

> ID：13864410
> 
> 赞同：0
> 
> 时间：2012-12-13T16:40:53.750
> 
> 标签：javascript, jquery, html, css

[这是网站](http://ldlocal.web44.net/contacto.html)。

我有一个奇怪的“文本显示”错误，它只发生**在 Mac OSX 的 Chrome 上**。我已经在 5 台 iMac 和 Macbook 上尝试过，但都以不好的方式显示文本。我知道在 Windows Chrome 中它看起来不错...

我有一个足够高的子菜单，可以超过我放在页面上的 API Google Map。问题是如果子菜单在地图上，文本（**具有白色 css 属性**！）变为**灰色漫反射样式**。

这是CSS：

```
#contact_map{
    width: 537px;
    height: 340px;
    float: left;
}

#map_canvas{
    width:100%; 
    height:100%;
}

#header #header_box ul#mainnav ul.submenu.big .submenu_big_box li a {
      text-transform: none;
      font-size: 12px;
      color: white;
} 
```

这就是问题所在：

![在此处输入图像描述](../Images/44eb8893d1a0fd615a2b02468165ec5b.png)

它应该看起来如何（只是白色字体）：

![在此处输入图像描述](../Images/a3598c5357c7194cf8d1a301775ada58.png)

如果您`float:left`从`#contact_map`. 地图下降，文本显示为白色。

我已经尝试过所有其他浏览器，它似乎只发生在 Mac OSX 的 Chrome 上，关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:46:41.130

我在带有 Chrome 的 MBP 上看起来很奇怪。我认为这就是你想要的：

```
-webkit-text-stroke: 0.35px 
```

资料来源：[加强 WebKit 中的枯燥文本](http://css-tricks.com/beefing-up-dull-text-in-webkit/)

有了它，它看起来像这样：

![在此处输入图像描述](../Images/7edef3a9fa2b7395f3c0f4351ab9bcab.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:44:46.790

我在带有 Chrome 的 OS X 10.7 上，它对我来说看起来是白色的。这些是我计算出来的样式：

```
color: white;
cursor: auto;
display: inline;
float: none;
font-family: avenirnext_lt_pro_ultlightRg;
font-size: 12px;
height: auto;
line-height: 15px;
list-style-image: none;
list-style-position: outside;
list-style-type: none;
overflow-y: visible;
padding-bottom: 0px;
padding-left: 0px;
padding-right: 0px;
padding-top: 0px;
text-align: left;
text-decoration: none;
text-transform: none;
width: auto; 
```

也许您可以在 chrome 中检查您计算出的样式以确保它们正常？

# excel - PowerShell | OLEDB | 电子表格 | 无法从第三方应用程序创建的 XLSX 读取数据

> ID：13864412
> 
> 赞同：3
> 
> 时间：2012-12-13T16:40:54.907
> 
> 标签：excel, powershell, oledb

**更新 (2012.12.13) - 添加示例代码、输入格式、输出示例

我已经为此奋斗了几天，现在，我已经没有想法了。我已经针对多个 XLSX 文件成功地测试了一个脚本（并且可以稍后上传）。我有连接字符串功能，解析我需要的数据等......

问题是当我尝试处理我的输入文件（从第三方报告应用程序生成）时，不会从工作表中读取数据。

如果我在 Excel 中打开并保存输入文件（没有格式更改、没有数据输入/删除、根本没有修改），那么输入文件将处理和解析所有数据。

我尝试在连接字符串中使用多个“扩展属性”设置，但无济于事，包括 HDR=Yes/No 和 IMEX=1。

以前有人见过这样的吗？

* * *

```
#inputFile_original.xlsx will not parse the data from the worksheet
#inputFile_original_reSaved.xlsx parses the data without any issues

$fileName  = "inputFile_original.xlsx"
#$fileName = "inputFile_original_reSaved.xlsx"
$filePath  = ".\OLEDB\test\"

#Build the connection string
$ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source="
$ConnectionString += (Join-Path -Path $filePath -ChildPath $fileName)
$ConnectionString += ";OLE DB Services=-4;Extended Properties="
$ConnectionString += '"Excel 12.0 Xml;HDR=YES;IMEX=1";'

$conn   = New-Object System.Data.OleDb.OleDbConnection($ConnectionString)
$conn.Open()

$tables = $conn.GetOleDbSchemaTable([System.Data.OleDb.OleDbSchemaGuid]::tables,$null)

$cmd    = New-Object System.Data.OleDb.OleDbCommand("Select * FROM [$($tables.rows[0].TABLE_NAME)]",$conn)

$da     = New-Object System.Data.OleDb.OleDbDataAdapter($cmd)
$ds     = New-Object System.Data.DataSet
$da.Fill($ds)

#Output the data to the console
$ds.tables 
```

* * *

此外，输入文件的格式不是很容易使用的布局。同样，由于是从第三方应用程序生成的。

有空行，标题行不是从第 1 行开始。

```
      ABCDEF
   -------------------------------------------------- ----------------------
01 | 报告标题
02 |
03 | ColHeader1 ColHeader2 ColHeader3 ColHeader4 ColHeader5 ColHeader6
04 | 数据 数据 数据 数据 数据 数据
05 | 数据 数据 数据 数据 数据 数据
06 | 数据 数据 数据 数据 数据 数据
07 | 数据 数据 数据 数据 数据 数据
08 | 数据 数据 数据 数据 数据 数据
09 |
10 | 总计：5

```

我收到的输出如下所示。
（一）原始文件

```
报告标题：
F2：
F3：
F4：
F5：
F6：

报告标题：ColHeader1
F2：
F3：
F4：
F5：
F6：

```

(B) 重新保存文件

```
报告标题：
F2：
F3：
F4：
F5：
F6：

报告标题：ColHeader1
F2 : ColHeader2
F3 : ColHeader3
F4 : ColHeader4
F5 : ColHeader5
F6 : ColHeader6

报告标题：数据
F2：数据
F3：数据
F4：数据
F5：数据
F6：数据

报告标题：数据
F2：数据
F3：数据
F4：数据
F5：数据
F6：数据

报告标题：数据
F2：数据
F3：数据
F4：数据
F5：数据
F6：数据

报告标题：数据
F2：数据
F3：数据
F4：数据
F5：数据
F6：数据

报告标题：数据
F2：数据
F3：数据
F4：数据
F5：数据
F6：数据

报告标题：
F2：
F3：
F4：
F5：
F6：

报告标题：总计：5
F2：
F3：
F4：
F5：
F6：

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:41:33.013

与其使用 OLEDB 打开 Excel 文件，不如从 Powershell 在 Excel 中打开它们……这是一个快速示例，仅打印工作表的大小。我从中学到的唯一问题是您每次都必须完全退出 Excel 并清除它的任何残余（最后是 GC 的东西。）

```
foreach($File in $excelFiles)
{
   $excel = New-Object -comobject Excel.Application
   $excel.visible = $false
   $workbook = $excel.Workbooks.Open($File)

   write-host "There are $($workbook.Sheets.count) sheets in $File"
   For($i = 1 ; $i -le $workbook.Sheets.count ; $i++)
   {
     $worksheet = $workbook.sheets.item($i)
     $rowMax = ($worksheet.usedRange.rows).count
     $columnMax = ($worksheet.usedRange.columns).count
     write-host "Sheet $($i) ($($worksheet.Name)) has dimensions $($rowMax) x $($columnMax)"

   $worksheet = $rowMax = $columnMax = $null
   } #end for
$workbook.close($false)
$workbook = $null
$excel.quit()
$excel = $null
[gc]::collect()
[gc]::WaitForPendingFinalizers()

} #end foreach 
```

# prolog - 如何在prolog.中将十进制数转换为二进制数？

> ID：13864414
> 
> 赞同：1
> 
> 时间：2012-12-13T16:41:00.370
> 
> 标签：prolog

```
dec_bin(1,1).
dec_bin(N,B):-N>1,X is N mod 2,Y is N//2,dec_bin(Y,B1),B=B1+X. 
```

这给了我输出：

```
?- dec_bin(12,K).
K = 1+1+0+0. 
```

但我只想要没有“+”符号的 1100。请有人帮助我..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:22:13.510

我想你在看的是什么`atom_concat/3`。另请注意，您的程序在输入编号 0 上失败。

```
dec_bin(0,'0').
dec_bin(1,'1').
dec_bin(N,B):-N>1,X is N mod 2,Y is N//2,dec_bin(Y,B1),atom_concat(B1, X, B). 
```

?- dec_bin(12,K)。K = '1100'

# javascript - 彩盒发送到错误的网址？

> ID：13864415
> 
> 赞同：0
> 
> 时间：2012-12-13T16:41:01.477
> 
> 标签：javascript, jquery, ajax, colorbox

我在一页中有多个颜色框。

这些颜色框的链接是用 javascript 生成的。

现在，每次生成打开颜色框的新链接时，任何与颜色框关联的点击链接都将转到该新链接的 url。

这就是我声明颜色框的方式：

```
$('.ajax').colorbox(); 
```

链接中的 href 是正确的，但仍会发送到最后生成的链接的 href。

提前致谢。

编辑：这是我添加一些链接的代码：

```
$('.albums').live('click', function(e){
    e.preventDefault();
    e.stopPropagation();
    parent_id           = $(this).parents().eq(2)[0].id;
    parent_header       = $('#' + parent_id + ' header')[0].innerHTML;
    parent_section      = $('#' + parent_id + ' section')[0].innerHTML;
    parent_footer       = $('#' + parent_id + ' footer')[0].innerHTML;
    fragment            = $(this).attr('href').split('/')[$(this).attr('href').split('/').length - 1];
    parent              = $(this).parents().eq(2)[0].id;
    if(fragment.indexOf('_-_') !== -1)
        page = fragment.replace('_-_', '/');
    else
        page = fragment;
    old_data[parent_id] = {'header': parent_header, 'footer': parent_footer, 'section': parent_section, 'link': parent + '/' + page};
    $.post('files/get_page', { page: old_data[parent_id]['link'] }, function(data){
        ret     = JSON.parse(data);
        a       = $('<a>').addClass('reset_link').attr('href', '#').append('Back To Albums');
        a.click(function(e){
            e.preventDefault();
            e.stopPropagation();
            this_parent_id      = $(this).parents().eq(1)[0].id;
            $('#' + this_parent_id + ' header').html(old_data[this_parent_id]['header']);
            $('#' + this_parent_id + ' section').html(old_data[this_parent_id]['section']);
            $('#' + this_parent_id + ' footer').html(old_data[this_parent_id]['footer']);
        })
        $('#' + parent).children().eq(0).html(a);
        $('#' + parent).children().eq(0).append(ret.header);
        $('#' + parent).children().eq(1).html('');
        for(i in ret.body.images){
            href            = ret.body.href + ret.body.images[i].image_name;
            image_id        = ret.body.images[i].image_id;
            delete_div_id   = 'delete_image_' + image_id;
            body            = $('<div>').addClass('albums_div');
            delete_div      = $('<div>').addClass('delete').append('&#10006; Supprimer').attr('id', image_id);
            a               = $('<a>').addClass('lightbox').attr('href', href);
            a.attr('onclick', 'return false;');
            a.append('&#9673; ' + ret.body.images[i].image_name);
            delete_div.click(function(){
                id          = delete_div_id;
                id_array    = id.split('_');
                $.post('files/delete', { id: image_id, del: id_array[1] }, function(data){
                    $(body).remove();
                });
            });
            body.append(a);
            body.append(delete_div);
            $('#' + parent).children().eq(1).append(body);
            $('.lightbox').colorbox({rel: 'group1'});
        }

        footer  = $('<a>').addClass(ret.footer['attr'].class).attr('id', ret.footer['attr'].id).attr('href', ret.footer['href']);
        footer.append(ret.footer['text']);
        footer.click(function(e){
            e.preventDefault();
            $.colorbox({href: ret.footer['href']});
        });
        $('#' + parent).children().eq(2).html(footer);
    });
}); 
```

注意：代码使用正确的 href 生成正确的链接，但它本身的颜色框中的问题。我知道这一点，因为我这样做了：

我为带有颜色框的链接分配了一个实时点击事件，如下所示：

```
$(".upload_file").live('click', function(){
    console.log($(this)[0].href);
}); 
```

并且打印到控制台的 href 是正确的，但是在颜色框中显示的页面是错误的。

编辑 2 添加 HTML：

**javascript更改代码之前的页面：**

```
<section id="reference">
    <header class="inner_header"><h3>R&#201;F&#201;RENCE PAGE SECTION</h3></header>
    <section>
        <h4>Choose an album :</h4>
        <div class="albums_div">
            <a href="res_yass" onClick="return false;" class="albums">&#9733; R&#233;sidence YASSINE</a>
            <div class="delete" id="delete_album_1">&#10006; Supprimer</div>
        </div>
        <div class="albums_div">
            <a href="res_nesr" onClick="return false;" class="albums">&#9733; R&#233;sidence NESRINE</a>
            <div class="delete" id="delete_album_2">&#10006; Supprimer</div>
        </div>
        <div class="albums_div">
            <a href="azerty" onClick="return false;" class="albums">&#9733; Azerty</a>
            <div class="delete" id="delete_album_8">&#10006; Supprimer</div>
        </div>
    </section>
    <footer class="inner_footer"><a href="files/add/reference" class="add_album ajax" id="reference">Add an album</a></footer>
</section> 
```

**javascript更改代码后的页面：**

```
<section id="reference">
    <header class="inner_header"><a class="reset_link" href="#">Back To Albums</a><h4>Azerty</h4></header>
    <section>
        <div class="albums_div">
            <a class="lightbox cboxElement" href="f352702127.jpg" onclick="return false;">◉ f352702127.jpg</a>
            <div class="delete" id="128">✖ Supprimer</div>
        </div>
        <div class="albums_div">
            <a class="lightbox cboxElement" href="f65564287.jpg" onclick="return false;">◉ f65564287.jpg</a>
            <div class="delete" id="129">✖ Supprimer</div>
        </div>
        <div class="albums_div">
            <a class="lightbox cboxElement" href="f184021055.jpg" onclick="return false;">◉ f184021055.jpg</a>
            <div class="delete" id="130">✖ Supprimer</div>
        </div>
    </section>
    <footer class="inner_footer"><a class="upload_file ajax" id="azerty" href="uploader/get_form/reference/azerty">Upload une image</a></footer>
</section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T15:09:17.300

解决了，问题不在于颜色框，我只是从这里更改代码：

```
$('.albums').live('click', function(e){
    e.preventDefault();
    e.stopPropagation();
    parent_id           = $(this).parents().eq(2)[0].id;
    parent_header       = $('#' + parent_id + ' header')[0].innerHTML;
    parent_section      = $('#' + parent_id + ' section')[0].innerHTML;
    parent_footer       = $('#' + parent_id + ' footer')[0].innerHTML;
    fragment            = $(this).attr('href').split('/')[$(this).attr('href').split('/').length - 1];
    parent              = $(this).parents().eq(2)[0].id;
    if(fragment.indexOf('_-_') !== -1)
        page = fragment.replace('_-_', '/');
    else
        page = fragment;
    old_data[parent_id] = {'header': parent_header, 'footer': parent_footer, 'section': parent_section, 'link': parent + '/' + page};
    $.post('files/get_page', { page: old_data[parent_id]['link'] }, function(data){
        ret     = JSON.parse(data);
        a       = $('<a>').addClass('reset_link').attr('href', '#').append('Back To Albums');
        a.click(function(e){
            e.preventDefault();
            e.stopPropagation();
            this_parent_id      = $(this).parents().eq(1)[0].id;
            $('#' + this_parent_id + ' header').html(old_data[this_parent_id]['header']);
            $('#' + this_parent_id + ' section').html(old_data[this_parent_id]['section']);
            $('#' + this_parent_id + ' footer').html(old_data[this_parent_id]['footer']);
        })
        $('#' + parent).children().eq(0).html(a);
        $('#' + parent).children().eq(0).append(ret.header);
        $('#' + parent).children().eq(1).html('');
        for(i in ret.body.images){
            href            = ret.body.href + ret.body.images[i].image_name;
            image_id        = ret.body.images[i].image_id;
            delete_div_id   = 'delete_image_' + image_id;
            body            = $('<div>').addClass('albums_div');
            delete_div      = $('<div>').addClass('delete').append('&#10006; Supprimer').attr('id', image_id);
            a               = $('<a>').addClass('lightbox').attr('href', href);
            a.attr('onclick', 'return false;');
            a.append('&#9673; ' + ret.body.images[i].image_name);
            delete_div.click(function(){
                id          = delete_div_id;
                id_array    = id.split('_');
                $.post('files/delete', { id: image_id, del: id_array[1] }, function(data){
                    $(body).remove();
                });
            });
            body.append(a);
            body.append(delete_div);
            $('#' + parent).children().eq(1).append(body);
            $('.lightbox').colorbox({rel: 'group1'});
        }

        footer  = $('<a>').addClass(ret.footer['attr'].class).attr('id', ret.footer['attr'].id).attr('href', ret.footer['href']);
        footer.append(ret.footer['text']);
        footer.click(function(e){
            e.preventDefault();
            e.stopPropagation();
            $.colorbox({href: ret.footer['href']});
        });
        $('#' + parent).children().eq(2).html(footer);
    });
}); 
```

对此：

```
$('.albums').live('click', function(e){
    e.preventDefault();
    e.stopPropagation();
    parent_id            = $(this).parents().eq(2)[0].id;
    parent_header        = $('#' + parent_id + ' header')[0].innerHTML;
    parent_section       = $('#' + parent_id + ' section')[0].innerHTML;
    parent_footer        = $('#' + parent_id + ' footer')[0].innerHTML;
    fragment             = $(this).attr('href').split('/')[$(this).attr('href').split('/').length - 1];
    parent               = $(this).parents().eq(2)[0].id;
    if(fragment.indexOf('_-_') !== -1)
        page = fragment.replace('_-_', '/');
    else
        page = fragment;
    old_data[parent_id]   = {'header': parent_header, 'footer': parent_footer, 'section': parent_section, 'link': parent + '/' + page};
    $.post('files/get_page', { page: old_data[parent_id]['link'] }, function(data){
        ret = JSON.parse(data);
        swap_content(ret);
    });
});
function swap_content(ret){
    a      = $('<a>').addClass('reset_link').attr('href', '#').append('Back To Albums');
    a.click(function(e){
        e.preventDefault();
        e.stopPropagation();
        this_parent_id = $(this).parents().eq(1)[0].id;
        $('#' + this_parent_id + ' header').html(old_data[this_parent_id]['header']);
        $('#' + this_parent_id + ' section').html(old_data[this_parent_id]['section']);
        $('#' + this_parent_id + ' footer').html(old_data[this_parent_id]['footer']);
    })
    $('#' + parent).children().eq(0).html(a);
    $('#' + parent).children().eq(0).append(ret.header);
    $('#' + parent).children().eq(1).html('');
    for(i in ret.body.images){
        href            = ret.body.href + ret.body.images[i].image_name;
        image_id        = ret.body.images[i].image_id;
        delete_div_id   = 'delete_image_' + image_id;
        body            = $('<div>').addClass('albums_div');
        delete_div      = $('<div>').addClass('delete').append('&#10006; Supprimer').attr('id', image_id);
        a               = $('<a>').addClass('lightbox').attr('href', href);
        a.attr('onclick', 'return false;');
        a.append('&#9673; ' + ret.body.images[i].image_name);
        delete_div.click(function(){
            id          = delete_div_id;
            id_array    = id.split('_');
            $.post('files/delete', { id: image_id, del: id_array[1] }, function(data){
                $(body).remove();
            });
        });
        body.append(a);
        body.append(delete_div);
        $('#' + parent).children().eq(1).append(body);
        $('.lightbox').colorbox({rel: 'group1'});
    }

    footer = $('<a>').addClass(ret.footer['attr'].class).attr('id', ret.footer['attr'].id).attr('href', ret.footer['href']);
    footer.append(ret.footer['text']);
    footer.click(function(e){
        e.preventDefault();
        e.stopPropagation();
        $.colorbox({href: ret.footer['href']});
    });
    $('#' + parent).children().eq(2).html(footer);
} 
```

**说明：** 我创建元素的第一个代码发生在全局范围内，因此每次执行代码时都会覆盖变量，并且我在这里将颜色框分配给 click 函数：

```
footer.click(function(e){
    e.preventDefault();
    e.stopPropagation();
    $.colorbox({href: ret.footer['href']});
}); 
```

所以每次页脚变量被重写时，点击被重新分配给新的页脚，这就是为什么 colorbox 将数据发送到错误的 url 所以我所要做的就是使这些变量成为函数的本地变量，在这种情况下是 swap_content() 函数现在每个页脚都是唯一的，因此颜色框会将数据发送到正确的 url。感谢那些试图回答的人。希望这对任何人都有帮助。

# git - 在裸存储库中预览文件

> ID：13864421
> 
> 赞同：0
> 
> 时间：2012-12-13T16:41:20.477
> 
> 标签：git

在工作中，我们正在尝试切换到 Git，但遇到了一些问题（让我从一开始就说明我是唯一一个对 Git 有一些基本经验的工作人员，另一位同事过去曾使用过 Subversion，但是而已）。

我们设想如下：

*   我们有一个稳定项目所在的主目录，我们的项目经理可以查看站点并在需要时进行调试。这个主目录（我们称之为 MAIN）也是所有开发人员的原始存储库。
*   所有从事该项目的开发人员在我们克隆 MAIN 的服务器上都有一个子目录，处理我们的更改并再次推送到 MAIN。我们也从那里拉取彼此的变化。

我们今天尝试这样做，但很快注意到不建议推送到非裸存储库 master -> master。当我读到原因时，这对我来说很有意义。如果你想自己做主 -> 主推送（到非裸仓库），我找到了一些解决方案，但它们都需要在源上执行各种命令（重置或从不同的分支合并）。然后，据我所知，解决方案是：将 MAIN 转换为裸存储库。但是，这意味着我们的 PM 不再能够查看该项目，因为没有工作目录。

解决这个问题的最佳方法是什么？我们是否设置了一个自动导出裸 MAIN 存储库的钩子，以便我们可以查看文件？

额外的事情：随着时间的推移，MAIN 将成为它自己的克隆：我们有一个用于每个项目的默认模板，我认为从默认模板克隆 MAIN 然后在其上添加东西是一个好习惯。这被认为是不好的做法吗？推回默认模板不是必需的，但是我们可能想要修复错误。我们是否应该启动裸 MAIN 存储库并将默认模板复制/粘贴到其中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:59:35.757

推荐的设置是让 MAIN 成为一个裸存储库，正如您所预见的那样，然后您可以使用[Git Web](https://git.wiki.kernel.org/index.php/Gitweb)之类的东西，一个问题跟踪器连接器（我知道[Redmine](http://www.redmine.org/projects/redmine/wiki/HowTo_configure_Redmine_for_advanced_git_integration)可以连接到 git），或者一个本地克隆 + 普通 git / [tig](http://jonas.nitro.dk/tig/) / 任何用于浏览它的 git GUI。

或者可能是本地[gitorius](http://gitorious.org/)安装，或托管在[Github](http://github.com/)上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:53:55.840

对于你的 PM，他只是在他自己的 PC 上克隆了 repo。这是最好的，使用裸存储库主要用于在远程存储存储库。如果他在没有技术知识的情况下并非只关心命令行（尽管他似乎从您的描述中可以看出），他可以使用简单的 GUI 来管理东西。

关于您的额外问题，在这种情况下，我只需在每个项目中复制/粘贴我的基本模板。这更有意义，因为我不希望我的项目中的样板历史（保持简单和整洁）。

# objective-c - 重用视图控制器

> ID：13864422
> 
> 赞同：1
> 
> 时间：2012-12-13T16:41:25.763
> 
> 标签：objective-c, ios, uiviewcontroller

我不清楚如何重用视图控制器。如果您创建了一个视图控制器子类来执行某些操作（实际上并不重要，它只执行您在视图中需要的操作），它可以与不同的视图一起使用还是应该再次子类化？

换句话说，如果我在应用程序的不同部分的视图中需要完全相同的功能，我可以使用原始视图控制器并从新视图中添加插座吗？或者我应该子类化自定义控制器并为视图提供“自己的”视图控制器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:46:57.417

您可以为视图控制器创建两个 xib。

如果你有文件...

```
MyViewController.m
MyViewController.h 
```

然后你可以添加xibs ...

```
MyViewControllerXib1
MyViewControllerXib2 
```

只需将“文件的所有者”设为 MyViewController。

然后，当您需要第一个 XIB 的 UI 布局时，您可以调用...

```
MyViewController *controller = [[MyViewController alloc] initWithNibName:@"MyViewControllerXib1" bundle:[NSBundle mainBundle]]; 
```

当您需要第二个 UI 时，您可以调用...

```
MyViewController *controller = [[MyViewController alloc] initWithNibName:@"MyViewControllerXib2" bundle:[NSBundle mainBundle]]; 
```

您获得的对象将是相同的，但布局 UI 的笔尖会发生变化。

**另一种方法**

只是在这里大声思考。

你也可以创建一个没有 nib 的 ViewController。

然后创建两个子类，每个子类都有一个笔尖。现在您有了代码重用和单独的布局，但您还可以对“主”控制器的每个子类进行精细的控制调整。

然后，您可以从此主视图控制器创建任意数量的子类。

**使用故事板**

只需将一个新的 ViewController 对象拖到情节提要上。将类更改为视图控制器类并设置 UI 并将控件拖动到代码等...然后您将拥有两个看起来不同但共享相同功能代码的屏幕。

这和我一开始说的一样，但是用故事板代替。

# java - 在将输出发送到 JAX-RS Web 服务客户端之前打印 MOXy 生成的 XML

> ID：13864425
> 
> 赞同：1
> 
> 时间：2012-12-13T16:41:39.600
> 
> 标签：java, eclipselink, jax-rs, moxy

如何在服务器端使用 MOXy 生成的 XML 打印 XML，然后再将 XML 发送到 RESTful Web Service 客户端。

```
 @GET
   @Path("/sma")
   @Produces({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
   public Representation getRepresentation() throws Exception 
   {
        Representation rep= new Representation ();
        rep.setFirstName("first name");
        rep.setLastName("last name");
        return rep;

   } 
```

在上面想要打印表示对象 XML 之前将其发送到 Web 服务客户端。

# c# - Windows Phone 8：监控混合 C#/C++ 中的内存使用情况

> ID：13864426
> 
> 赞同：7
> 
> 时间：2012-12-13T16:41:43.740
> 
> 标签：c#, c++, memory-management, code-analysis, windows-phone-8

我想监视使用 Windows Phone 运行时组件的 Windows Phone 8 上混合 C#/C++ 应用程序的内存使用情况。问题是在 Visual Studio (ALT+F1) 中打开分析工具包时，我只有“执行”选项 (http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202934%28v=与 105%29.aspx)。对于“纯”C# 项目，内存选项也可用。

是否有其他或多或少简单的方法来监控内存使用情况？

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T00:41:09.133

您是否考虑过构建自己的 C# 内存监控 UI？它不会像 Visual Studio 的内存分析器那样花哨或详细，但在 WP7.5 引入内存分析功能之前大约一年，它已成为常态。

我之前在诺基亚的 Wiki 上[的 Windows Phone 应用程序内存分析技术](http://www.developer.nokia.com/Community/Wiki/Techniques_for_memory_analysis_of_Windows_Phone_apps#Add_on-screen_coding4fun_.3CMemoryCounter_.2F.3E)下写过有关此主题的文章。具体来说，您关心的部分是[Add on-screen coding4fun MemoryCounter](http://www.developer.nokia.com/Community/Wiki/Techniques_for_memory_analysis_of_Windows_Phone_apps#Add_on-screen_coding4fun_.3CMemoryCounter_.2F.3E)和[Create your own memory profiler](http://www.developer.nokia.com/Community/Wiki/Techniques_for_memory_analysis_of_Windows_Phone_apps#Create_your_own_memory_profiler)。

# powershell - 如何在 v2 模式下运行 PowerShell v3 控制台

> ID：13864429
> 
> 赞同：3
> 
> 时间：2012-12-13T16:42:04.413
> 
> 标签：powershell, powershell-2.0, powershell-3.0

在最近的 Windows Server 2008 R2 更新中，他们也在推动 Windows PowerShell V3.0。但是，到目前为止，我们的脚本都是在 V2 中构建和测试的。如何在 V2 模式下运行 PowerShell V3 控制台。？

注意：我在启动 PowerShell.exe 时尝试了“-Version 2”。但它不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T17:25:06.473

以什么方式`powershell.exe -version 2`不起作用？这是安装 v3 时运行 v2 的方式。

顺便说一句，确保已安装 PowerShell 2.0 引擎。检查 Windows 功能：

![Windows 功能 - PowerShell 2.0](../Images/3322f939aff5a7e63b277d686cbb2526.png)

# c# - ARC + cyclic references collector vs leading edge GC (say .NET 4.5 GC)

> ID：13864432
> 
> 赞同：5
> 
> 时间：2012-12-13T16:42:09.523
> 
> 标签：c#, objective-c, garbage-collection, automatic-ref-counting

There are a plenty of questions on SO regarding `objective c` `ARC` mechanism. Many people asking if `ARC` is going to replace `GC` or not, etc. There are even discussions whether it's reasonable to move to `ARC` from `GC` for Mac apps(if that does not require much work handling complex references in some data types, etc).

The obvious disadvantage of `ARC` is complete lack of any mechanism for cleaning cyclic references (edit: cyclic ***strong*** references). Here's a very good and simple explanation on memory leaks with `ARC` [What kind of leaks does automatic reference counting in Objective-C not prevent or minimize?](https://stackoverflow.com/questions/6260256/what-kind-of-leaks-does-automatic-reference-counting-in-objective-c-not-prevent/6388601#6388601)

And interesting overview of advantages of apple's `ARC` over their `GC`. [http://lists.apple.com/archives/objc-language/2011/Jun/msg00013.html](http://lists.apple.com/archives/objc-language/2011/Jun/msg00013.html)

I have a good understanding on how `GC` works and what kind of problems it has, but moving from `C#/.NET` world to `objective c / Cocoa` and reading stuff about `ARC` I still cannot get one simple thing - ***why there is no background mechanism to clean cyclic references in `ARC` application***.

It does not require threads suspending, does it? So is relatively cheap to have. Is it a problem to implement one? An *light version of GC* which scans stack, registers, builds graph, finds cyclic references and frees memory without suspending application threads, sounds cool, no?

Does it require serious computation or other resources? It's hard for me to imagine how to find cyclic references without building all the object graph, but assuming this process is background and continuous it *should* be ok even in that way?

.NET 4.5 GC ([http://blogs.msdn.com/b/dotnet/archive/2012/07/20/the-net-framework-4-5-includes-new-garbage-collector-enhancements-for-client-and-server-apps.aspx](http://blogs.msdn.com/b/dotnet/archive/2012/07/20/the-net-framework-4-5-includes-new-garbage-collector-enhancements-for-client-and-server-apps.aspx)) has serious improvements in performance, but having cyclic references collector in ARC system will make second a winner? What are the next steps of `ARC` system evolution? If it's possible and will sometime happen `ARC` will have cyclic references collector, can it then fully replace `GC`, or next gen `GC`s (with even better performance) are going to eliminate `ARC` systems?

**UPD:** Please do not post about `weak` references, I know how to deal with cyclic references in ARC, and that's obvious, the question is about possibility to add cyclic references collector to existing ARC mechanism, as it would be as powerful and generic as modern GC are

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T18:44:05.143

Cycle detection in a C based world requires one of two things:

*   all assignments of objects everywhere always go through a write barrier (and, potentially, a read barrier, depending on the features of the collector)

*   the scanner must "stop the world" to hold memory in a consistent state when scanning for cycles

The former is a unified memory model and incurs massive overhead compared to straight C (but can be made more efficient than pure manual retain/release). In practice, you typically would "escape" objects from the barrier'd world into un-barrier'd locations using some kind of manual reference count (which is pretty much identical to the bridging mechanisms in the ARC compiler; CFBridgingRetain(), etc...)

The latter is much easier on the developer, but makes performance completely unpredictable as you can never know when, or for how long, any given thread is going to stop. Without barriers, you can't really stop only one thread at a time.

Both of these add significant overhead compared to the relative "at the metal" nature of a C based environment. In a VM based environment, the cost is largely addressed by a combination of the virtualization of the object graph connectivity combined with execution path following JIT compilation that achieves optimizations well beyond what is possible in a pre-compiled environment like C (precompiled, static executables... not the precompiler itself).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:35:18.023

Your question should have been: What is the mechanism to resolve cyclic reference issues in ARC?

And to that, the answer is: Weak pointers.

# phpstorm - 如何配置 PhpStorm 以突出显示 .html5 文件中的 HTML 和 PHP 语法？

> ID：13864437
> 
> 赞同：8
> 
> 时间：2012-12-13T16:42:39.253
> 
> 标签：phpstorm

我必须在工作中使用这个 IDE。我还必须处理使用 html5 扩展名的 Contao 模板。

我刚刚让 PhpStorm 将这些文件识别为 HTML，大获全胜，但如果它也能知道里面有什么，那就太好了。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-13T17:51:53.550

将`*.html5`模式分配给PHP**文件**`Settings/Preferences | Editor | File Types`

# php - PHP 可以在没有 ICMP 且没有外部程序的情况下 ping 远程系统吗？

> ID：13864438
> 
> 赞同：5
> 
> 时间：2012-12-13T16:42:46.300
> 
> 标签：php, ping

我想检查另一台机器是否通常使用 PHP 响应。

大多数方法是ping目标机器上运行的一些服务，但我想检查机器是否在线。

我发现[http://birk-jensen.dk/2010/09/php-ping/](http://birk-jensen.dk/2010/09/php-ping/)应该发送一个 ICMP Ping 包。问题是，以某种方式需要`root`执行`socket_create(AF_INET, SOCK_RAW, 1)`. 解决方法 via`posix_seteuid(0)`也不起作用，因为这也需要提升的权限。

任何可以让我运行`ping` 程序的功能在我的场景中也不可用。

那么如何使用php检查服务器是否在线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:05:56.860

为此，您可能想尝试一下，这极不可能提供有意义的数据，但值得深思。

如果您打开一个 tcp 套接字到一个随机端口，而不是超时，它会立即关闭。然后机器“启动”，但这并不意味着更多。它可能处于内核恐慌状态。

超时并不意味着机器停机。只是它没有拒绝 tcp 握手，而是放弃了它。

您将无法获得任何有意义的计时数据，但是如果有问题的机器是打开还是关闭，您会给出更多有根据的猜测。

```
<?php
$sock = socket_create(AF_INET,SOCK_STREAM,SOL_TCP);
socket_connect ( $sock , string $address,22 ) === true) {
switch(socket_last_error($sock)) {
    case 110:
    case 112:
    case 113:
       echo 'Machine may be down';
       break;
    case 111:
       echo 'Machine may be up';
       break;
    case 115:
       echo 'Machine is up';
       break;
    default:
       echo 'Machine in unknown state.';
       break;
} 
```

您已经声明不能使用 ping 命令，因此 Net_Ping 将无法工作，因为它只是操作系统中 ping 命令的一个奇特接口

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:42:09.997

您始终可以使用 Net_Ping 从 php [http://pear.php.net/package/Net_Ping/redirected ping](http://pear.php.net/package/Net_Ping/redirected)

# android - Android：使用硬件加速绘画

> ID：13864442
> 
> 赞同：3
> 
> 时间：2012-12-13T16:43:02.410
> 
> 标签：android

我正在实现一个带有擦除选项的绘画应用程序。我正在使用 PorterDuff.Mode.Clear 执行此操作，但在擦除时我有两种不同的行为，具体取决于 hardwareAccelerated 标志。

绘画时截图：[https ://dl.dropbox.com/u/194622/Screenshot_2012-12-13-16-36-33.png](https://dl.dropbox.com/u/194622/Screenshot_2012-12-13-16-36-33.png)

最终结果是一样的，但是这个“黑色痕迹”只发生在硬件加速开启的擦除过程中。

除了禁用硬件加速之外还有什么建议吗？

**编辑**：

添加一些代码：

```
@Override
protected void onSizeChanged(int w, int h, int oldw, int oldh) {
  super.onSizeChanged(w, h, oldw, oldh);
  mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
  mCanvas = new Canvas(mBitmap);
}

@Override
protected void onDraw(Canvas canvas) {
  canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);
  canvas.drawPath(mPath, mPaint);
} 
```

# java - 注入 (@Inject) 字段是否安全发布？

> ID：13864443
> 
> 赞同：9
> 
> 时间：2012-12-13T16:43:03.533
> 
> 标签：java, thread-safety, cdi, weld

当我在类中使用字段注入时，如下所示：

```
@Inject
private MyClass myField; 
```

[我可以对“安全发布](https://stackoverflow.com/questions/801993/java-multi-threading-safe-publication)”做任何假设吗”状态或者换一种说法，假设 MyClass 本身是线程安全的，在使用这个字段时我应该注意什么并发风险？

我的直觉通常是尽可能创建所有字段 final ，但这不适用于字段注入。当然，我可以使用构造函数注入，但是我通常最终不得不创建一个额外的“假”无参数构造函数来进行代理。问题不大，但使用字段注入更方便。另一种选择可能是将字段标记为易失性（甚至使用锁定...），但这真的有必要吗？

JSR-299 规范似乎没有回答这个问题。我在 Weld 等实现上使用 CDI。

*   我注入的对象*将*被多个线程使用（例如，@ApplicationScoped）。我要这个。
*   我知道如果 MyClass 是不可变的，安全发布就不是问题。但我不一定只注入不可变对象。
*   MyClass 本身被假定为线程安全的；这*不是*我关心的问题。由于 Java 内存模型的规则，严格来说，关注的是不安全的发布，例如线程看到 MyClass 的半构造实例的可能性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-28T13:39:24.823

也许这种情况下的线程安全性被故意从规范中遗漏了，这意味着线程安全性没有得到保证。

让我们想一想：如果一个线程写入的字段被其他线程读取，除非存在某种形式的发生前关系，否则其他线程可能会读取陈旧数据。Guice 最终使用反射来设置 myField 的值，或者它可以使用自动生成的设置器。没有发生之前的关系，因此反射写入发生在字段读取之前或方法调用发生在字段读取之前（除非使用了锁、易失性或其他形成发生之前关系的方法）。

因此，我会说看到空值的可能性（可能相当低）。

编辑：根据[http://bit.ly/1m4AUIz](http://bit.ly/1m4AUIz)在构造函数结束后写入最终字段（通过反射）与在构造函数中初始化字段具有相同的语义。因此，将 Guice 注入的字段设置为最终字段，将它们设置为 null 并且它应该可以正常工作。这确实是一个非常黑暗的 JVM 角落 :-) 此外，根据[http://bit.ly/1m4AwJU](http://bit.ly/1m4AwJU) Guice 在一个线程中执行注入，这使得它是线程安全的......在性能方面对我来说似乎很奇怪，但显然它以这种方式工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-03T04:30:12.597

我相信您可以根据 java 内存模型的第 9.1.1 节： [http](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr133.pdf) ://www.cs.umd.edu/~pugh/java/memoryModel/jsr133.pdf 9.1.1 最终字段的构造后修改.. . **final 字段的冻结发生**在设置了 final 字段的构造函数的末尾，以及通过反射其他特殊机制**每次修改 final 字段之后。**...

一些相关的 Guice 讨论是： [http ://markmail.org/message/fxs5k32dihpoy5ry#query:bob%20lee%20constructor%20injection+page:1+mid:fxs5k32dihpoy5ry+state:results](http://markmail.org/message/fxs5k32dihpoy5ry#query:bob%20lee%20constructor%20injection+page:1+mid:fxs5k32dihpoy5ry+state:results)

.. 和[http://www.theserverside.com/discussions/thread.tss?thread_id=52252#284713](http://www.theserverside.com/discussions/thread.tss?thread_id=52252#284713)

不过，如果 DI 框架做出这样的明确声明，那就太好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:19:52.773

使用注入实例时的任何并发风险取决于该实例的有效范围。

如果`MyClass`在默认`@Dependent`范围内，则每个注入点都将获得自己的实例。你在线程安全方面采取的预防措施与你打电话给`new MyClass()`自己的一样。如果您从多个线程访问该实例，则需要确保它`MyClass`是线程安全的或围绕它提供一些同步。

如果`MyClass`在更广泛的范围内，例如`@SessionScoped`or `@ApplicaionScoped`，那么同一个实例（或它的代理）可以被注入到同一上下文中的多个注入点。例如，如果您有来自同一个会话的并行浏览器请求访问`MyClass`并且`MyClass`被注释`@SessionScoped`，您可能有多个线程并行访问同一个实例。CDI 不会为您提供任何同步，因此您必须确保它`MyClass`是线程安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T08:08:39.870

我总是使用构造函数注入。那么您的字段可能是最终的，并且它们的线程安全性毫无疑问。

# sql - 查询两个字符串之间的常用词

> ID：13864446
> 
> 赞同：1
> 
> 时间：2012-12-13T16:43:04.580
> 
> 标签：sql, sql-server, sql-server-2012

我需要一个 SQL 查询来仅在两个句子之间获取常用词。例如：

句子1：这个网站很有帮助

句子 2：我需要一个有用的网站

结果应该是：网站有帮助

另外，如果我需要将句子 1 与表字段记录进行比较，以获取包含句子 1 最常用词的记录，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:54:56.710

您的问题标题说 MSQL，所以我将您的问题视为 Sql Server 问题。

1.  拆分功能

根据 SQL Server 版本/服务器配置，您将需要一个拆分函数，该函数可以在选择的分隔符上拆分字符串。这是一个这样的功能。

```
CREATE FUNCTION [dbo].[fnSplit](@data NVARCHAR(MAX), @delimiter NVARCHAR(5))
RETURNS @t TABLE (rowNum int IDENTITY(1,1), data NVARCHAR(max), descriptor varchar(255) NULL)
AS
BEGIN

    DECLARE @textXML XML;
    SELECT    @textXML = CAST('<d>' + REPLACE(@data, @delimiter, '</d><d>') + '</d>' AS XML);

    INSERT INTO @t(data)
    SELECT  RTRIM(LTRIM(T.split.value('.', 'nvarchar(max)'))) AS data
    FROM    @textXML.nodes('/d') T(split)

    RETURN
END 
```

1.  使用 split 函数查询常用词（有很多方法可以做到这一点，这里有一个）。 `SELECT sentence1.data FROM dbo.fnSplit('This site is very helpful',' ') sentence1 INNER JOIN dbo.fnSplit('I need a helpful site',' ') sentence2 ON sentence1.data = sentence2.data`

# python - 从 Twisted 上传到 GCS

> ID：13864448
> 
> 赞同：1
> 
> 时间：2012-12-13T16:43:22.503
> 
> 标签：python, twisted, google-cloud-storage

我需要从一个扭曲的应用程序将文件放入 Google 的云存储中。

我一直在使用亚马逊，`txAWS`但现在我正在使用 GCS 我不确定是否存在任何可以让我这样做的东西？

是否可以`txAWS`与 GCS 一起使用？这听起来像是一个奇怪的问题，但是可以将`boto`'s`S3Connection`与 GCS 一起使用，所以也许有一种方法可以对`txAWS`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:51:25.363

我建议将[Twisted Web 客户端](http://twistedmatrix.com/documents/current/web/howto/client.html)与[GCS JSON API](https://developers.google.com/storage/docs/json_api/)一起使用。以下是列出存储桶内容的示例：

```
import json
from twisted.internet import reactor
from twisted.internet.defer import Deferred
from twisted.internet.protocol import Protocol
from twisted.web.client import Agent
from twisted.web.error import Error
from twisted.web.http_headers import Headers

GCS_BASE_URL = 'https://www.googleapis.com/storage/v1beta1'
GCS_API_KEY = '<your-api-key>'
GCS_BUCKET = '<your-bucket>'

class ResponseAccumulate(Protocol):
    def __init__(self, finished):
        self.finished = finished
        self.fullbuffer = ''

    def dataReceived(self, bytes):
        print 'Received %d bytes.' % len(bytes)
        self.fullbuffer += bytes

    def connectionLost(self, reason):
        if isinstance(reason, Error):
            print 'Finished receiving body:', reason.getErrorMessage()
        else:
            parsed = json.loads(self.fullbuffer)
            print 'Bucket contents:'
            for item in parsed['items']:
              print ' ', item['id']
        self.finished.callback(None)

agent = Agent(reactor)

d = agent.request(
    'GET',
    '%s/b/%s/o?key=%s' % (GCS_BASE_URL, GCS_BUCKET, GCS_API_KEY),
    Headers({'User-Agent': ['Twisted Web Client Example']}),
    None)

def cbResponse(response):
    print 'Response received', response.code
    finished = Deferred()
    response.deliverBody(ResponseAccumulate(finished))
    return finished
d.addCallback(cbResponse)

def cbShutdown(ignored):
    reactor.stop()
d.addBoth(cbShutdown)

reactor.run() 
```

# c++ - 想要“覆盖”案例时重叠模板部分专业化：如何避免错误？

> ID：13864451
> 
> 赞同：0
> 
> 时间：2012-12-13T16:43:32.200
> 
> 标签：c++, templates, compiler-errors

我正在处理一个非常简单的模板结构，它的枚举值由它的 2 个模板参数是否相同类型来设置。

```
template<typename T, typename U> struct is_same { enum { value = 0 }; };
template<typename T> struct is_same<T, T> { enum { value = 1 }; }; 
```

这是一个库（Eigen）的一部分，所以我不能改变这个设计而不破坏它。当 时`value == 0`，静态断言中止编译。

所以我有一个特殊的数字模板类`SpecialCase`，它可以用自己的不同专业进行操作。所以我设置了一个这样的覆盖：

```
template<typename T> struct SpecialCase { ... };

template<typename LT, typename RT> struct is_same<SpecialCase<LT>, SpecialCase<RT>> { enum { value = 1 }; }; 
```

但是，这会引发错误：

```
more than one partial specialization matches the template argument list 
```

现在，我明白为什么了。情况就是`LT == RT`, 踩到 的脚趾`is_same<T, T>`。我不知道如何保持我的`SpecialCase`覆盖并摆脱错误。有什么技巧可以解决这个问题吗？

编辑：为了澄清，我需要所有`LT != RT`被认为相同的情况（值为1）。不只是`LT == RT`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:58:09.210

您可以为 SpecialCase 添加一个特殊情况，其中参数相同：

```
template < typename T >
struct is_same < SpecialCase < T >, SpecialCase < T > >
{ enum { value = 1 }; }; 
```

这比每个模棱两可的候选人都更具体。

编辑：这是完整的代码：

```
#include <iostream>
template<typename T, typename U> struct is_same {
    enum { value = 0 };
};
template<typename T> struct is_same<T, T> {
    enum { value = 1 };
};

template<typename T> struct SpecialCase {  };

template < typename T >
struct is_same < SpecialCase < T >, SpecialCase < T > >
{
  enum { value = 1 };
};

template<typename LT, typename RT> struct is_same<SpecialCase<LT>, SpecialCase<RT> > {
    enum { value = 1 };
};

int main ( int, char** )
{
std::cout 
<< is_same < SpecialCase < int >, SpecialCase < int > >::value
<< is_same < SpecialCase < int >, SpecialCase < double > >::value
<< is_same < SpecialCase < int >,  double >::value
<< is_same < double, SpecialCase < int > >::value
<< is_same < double, double >::value
<< is_same < double, int >::value
<< std::endl;
return 0;
} 
```

# python - 两个不同的提交按钮 html/cgi 表单

> ID：13864457
> 
> 赞同：0
> 
> 时间：2012-12-13T16:44:03.007
> 
> 标签：python, html, cgi

我试图有两个不同的提交按钮。如果按下一个提交按钮，则它转到一个 cgi 脚本，如果按下另一个，则转到另一个。现在下面是我的代码，但它没有按我的意愿工作。无论按下哪个脚本，它们都只会转到相同的脚本。

```
#!/usr/bin/env python
import cgi
import cgitb
cgitb.enable()

form = cgi.FieldStorage()
keyword = form.getvalue('keyword')
keyset = set(x.strip() for x in open('keywords.txt', 'r'))

print 'Content-type: text/html\r\n\r'
print '<html>'
print "Set = ", keyset
print '<h1>If your keyword is in the set, use this submission button to retrieve recent tweets</h1>'
print '<form action="results.cgi" method="post">'
print 'Keyword: <input type="text" name="keyword">  <br />'
print '<input type="submit" value="Submit" name="Submit1" />'
print '</html>'

print 'Content-type: text/html\r\n\r'
print '<html>'
print '<h1>If your desired keyword is not in the set, use this submission button to add it</h1>'
print '<form action="inlist.cgi" method="post">'
print 'Keyword: <input type="text" name="keyword">  <br />'
print '<input type="submit" value="Submit" name="Submit2" />'
print '</html>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:47:19.583

一种解决方案是将表单发布到中间脚本，该脚本根据单击的提交按钮决定运行哪个脚本。

因此，如果`Submit1`提供了 for 的值，则运行脚本 A。如果`Submit2`提供了 for 的值，则运行脚本 B。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-28T09:15:26.150

使用调度脚本。这也允许快速导入。例子：

```
...
print '<form action="dispatch.cgi" method="post">'
print '<input type="submit" value="Submit" name="Submit1" />'
print '<input type="submit" value="Submit" name="Submit2" />'
... 
```

* * *

```
#!/usr/bin/env python
# dispatch.py (or dispatch.cgi)
import cgi
import cgitb
cgitb.enable()

form = cgi.FieldStorage()
if form.getvalue('Submit1'):
    import results  # result.py: imports are precompiled (.pyc) and decent
    result.handle_cgi(form)  #OR: execfile('results.cgi')
else:
    import inlist
    inlist.handle_cgi(form)  #OR: execfile('inlist.cgi') 
```

* * *

```
# results.py (or results.cgi)
import cgi

def handle_cgi(form):
    keyword = form.getvalue('keyword')
    print 'Content-type: text/html'
    print
    print '<HTML>'
    print "Keyword = ", keyword
    #...

if __name__ == '__main__':
    handle_cgi(globals().get('form') or  # don't build / read a POST FS twice
               cgi.FieldStorage()) 
```

* * *

```
# inlist.py ... 
```

# php - 需要帮助将调查响应从 HTML 表单传递到 MySQL 表

> ID：13864458
> 
> 赞同：1
> 
> 时间：2012-12-13T16:44:06.770
> 
> 标签：php, html, mysql, forms, http-post

我在这里有点难过...

我有一个网页显示存储在数据库表中的调查问题列表，我正在尝试收集每个问题的评分回复（非常不同意 -> 非常同意）并将值传递回另一个表在我的数据库中。

这是表单代码的片段：

```
<form action="submitAnswers.php" name="subAns" method="post">
        <fieldset>
            <legend>Survey Questions</legend>
            <input type="hidden" name="survey_id" value="<?php echo ($survey_id); ?>">
            <table width=90% border=0 cellpadding='2' cellspacing='2'?>

            <tr bgcolor=#D0D0D0>

                <th>Question</th>
                <th>Strongly Disagree</th>
                <th>Somewhat Disagree</th>
                <th>Neither Disagree nor Agree</th>
                <th>Somewhat Agree</th>
                <th>Strongly Agree</th>
            </tr>
            <tr>    
            <?php
                while ($row  =  mysql_fetch_array($res, MYSQL_ASSOC)) 
                {
                    echo "<td bgcolor='#E8E8E8'><font size='-1'>$row[quest_order]) $row[quest_text]</font></td>";

                    for ($i = 0; $i < 5; $i++) 
                    {
                    //echo "<input type='hidden' name='qID' value='$quest_id'>";

                    echo "<td bgcolor='#E8E8E8'><input type='radio' name='$row[quest_id]' value='$i'></td>";
                    }           

                    echo "</tr>";
                }
            ?>      

            <br>            
            </table><br>
            <input type="submit" name="submitAnswers" value="Submit Survey"></fieldset>
    </form> 
```

这是“submitAnswers.php”文件中的 PHP：

```
$survey_id=$_POST['survey_id'];

    $sql = "INSERT INTO survey_responses (survey_id) 
            VALUES ('$survey_id')";

    $res = send_sql($sql, $link, $db);  

    foreach($_POST['quest_id'] as $id=>$value)
    {   

        $sql = "INSERT INTO survey_answers (response_id, quest_id, response_value) 
            VALUES (LAST_INSERT_ID(), $id, '$value')";

        $res = send_sql($sql, $link, $db) or die("Cannot add survey");

    } 
```

我在“survey_responses”表中的插入语句工作得很好，但我不知道如何更正用于获取每个问题的响应分数的单选按钮。这些值是通过 POST 传递的（我通过查看`print_r($_POST);`返回的 来确认这一点，例如：

> 数组 ( [survey_id] => 4 [6] => 0 [5] => 1 [4] => 2 [3] => 3 [2] => 4 [1] => 3 [submitAnswers] => 提交民意调查 ）

但显然我要解决这个问题，因为我无法成功迭代并为每个问题插入问题 id# 和响应值。我敢肯定这相对简单，但我对编程还是很陌生，并且已经研究了几个小时，几乎没有运气。

只是希望有人可以帮助我解决这个问题，并希望在此过程中更好地解释，或指出一个很好的资源，涵盖如何处理动态大小的表单，这些表单正在检索数据库记录并将各种数量的信息传递回数据库。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:58:45.993

利用

```
$sql = "INSERT INTO survey_answers (response_id, quest_id, response_value) 
        VALUES ('".LAST_INSERT_ID()."', '".$id."', '."$value."')"; 
```

反而

```
$sql = "INSERT INTO survey_answers (response_id, quest_id, response_value) 
        VALUES (LAST_INSERT_ID(), $id, '$value')"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:37:45.247

好的，我想我已经解决了这个问题，尽管可能有更好的解决方案。在我的表单中，我将单选按钮更改为如下所示：

```
echo "<td bgcolor='#E8E8E8'><input type='radio' name='quest".$row[quest_id]."' value='$i'></td>"; 
```

唯一的变化是将“quest”作为前缀添加到 name 属性中的 ID#。在我的 PHP 文件中：

```
foreach ($_POST as $name=>$value)
{
    if (strpos($name, "quest") !== FALSE)
    {
    $qID = substr($name, 5);
    $sql = "INSERT INTO survey_answers (response_id, quest_id, response_value) 
        VALUES (LAST_INSERT_ID(), '$qID', '$value')";

    $res = send_sql($sql, $link, $db) or die("Cannot add survey");
    }
} 
```

我正在检查那些带有 'quest' 前缀的帖子值，然后通过`substr`.

如果有更好的方法，我会全神贯注...

# iphone - 如何赋予 CGPoint 线独特的颜色 Xcode

> ID：13864459
> 
> 赞同：3
> 
> 时间：2012-12-13T16:44:08.980
> 
> 标签：iphone, objective-c, xcode, cgpoint

一个非常简单的 XCode iPhone 应用程序。空白屏幕，画线，每条线都有一个通过随机数生成的唯一颜色。我有代码给我随机颜色，但我无法让线条单独保留颜色。每次绘制屏幕时，我的数组中所有行的颜色都会发生变化。

这是为每一行设置颜色的代码：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{    
    for (UITouch *t in touches) {
    // Is this a double-tap?
        if ([t tapCount] > 1) {
            [self clearAll];
            return;
    }

    CGFloat hue = ( arc4random() % 256 / 256.0 );  //  0.0 to 1.0
    CGFloat saturation = ( arc4random() % 128 / 256.0 ) + 0.5;  //  0.5 to 1.0, away from white
    CGFloat brightness = ( arc4random() % 128 / 256.0 ) + 0.5;  //  0.5 to 1.0, away from black

    Colour=[UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:1];        

    // Use the touch object (packed in an NSValue) as the key
    NSValue *key = [NSValue valueWithPointer:t];

    // Create a line for the value
    CGPoint loc = [t locationInView:self];
    Line *newLine = [[Line alloc] init]; 
    [newLine setBegin:loc];
    [newLine setEnd:loc];
    [newLine setCOLOUR:Colour];

    // Put pair in dictionary
    [linesInProcess setObject:newLine forKey:key];
    [newLine release];
}
} 
```

这是我用来画线的代码。

```
- (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetLineWidth(context, 10.0);
    CGContextSetLineCap(context, kCGLineCapRound);

    for (Line *line in completeLines) {
        [Colour set];
        CGContextMoveToPoint(context, [line begin].x, [line begin].y);
        CGContextAddLineToPoint(context, [line end].x, [line end].y);
        CGContextStrokePath(context);
    }

    // Draw lines in process in red
    [[UIColor redColor] set];
    for (NSValue *v in linesInProcess) {
        Line *line = [linesInProcess objectForKey:v];
        CGContextMoveToPoint(context, [line begin].x, [line begin].y);
        CGContextAddLineToPoint(context, [line end].x, [line end].y);
        CGContextStrokePath(context);
    }
} 
```

重申一下：我试图为界面上绘制的每条线赋予独特的颜色。所述颜色由随机数 gen 给出。

感谢帮助，人们。:D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:06:45.560

在您`drawRect`的循环中，`linesInProcess`您没有设置颜色。您需要使用线对象中的颜色信息并在每次循环迭代中重置颜色：

```
CGContextSetStrokeColorWithColor(context, line.COLOUR.CGColor); 
```

或者，或者，

```
[line.COLOUR set]; 
```

这同样适用于您的`completeLines`循环。

PS：您可以为您的类的属性使用通常的驼峰式变量名称来帮自己一个忙。

# java - 使用未初始化的最终字段 - 带/不带“this”。限定词

> ID：13864464
> 
> 赞同：54
> 
> 时间：2012-12-13T16:44:29.503
> 
> 标签：java

有人可以向我解释为什么以下两个示例中的第一个可以编译，而第二个没有？请注意，唯一的区别是第一个用 '.this' 明确限定了对 x 的引用，而第二个没有。在这两种情况下，最终字段 x 显然都在初始化之前尝试使用。

我原以为这两个样本会被完全平等地对待，导致两者都出现编译错误。

1)

```
public class Foo {
    private final int x;
    private Foo() {
        int y = 2 * this.x;
        x = 5;
    }
} 
```

2)

```
public class Foo {
    private final int x;
    private Foo() {
        int y = 2 * x;
        x = 5;
    }
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-13T19:29:33.437

经过大量的规范阅读和思考，我得出结论：

在 Java 5 或 Java 6 编译器中，这是正确的行为。[*第 16 章“ Java 语言规范的*](http://docs.oracle.com/javase/specs/jls/se5.0/html/defAssign.html)[明确分配，第三版](http://docs.oracle.com/javase/specs/jls/se5.0/html/defAssign.html)*说：*

 *> 当发生对其值的任何访问时，每个局部变量[（§14.4）](http://docs.oracle.com/javase/specs/jls/se5.0/html/statements.html#5920)和每个空白`final` [（§4.12.4）](http://docs.oracle.com/javase/specs/jls/se5.0/html/typesValues.html#10931)字段[（§8.3.1.2）](http://docs.oracle.com/javase/specs/jls/se5.0/html/classes.html#35962)都必须具有*明确分配的值。*对其值的访问由出现在表达式中任何位置**的变量的简单名称**组成，除了作为简单赋值运算符的左侧操作数`=`。

（强调我的）。所以在表达式`2 * this.x`中，该`this.x`部分*不*被认为是“访问 [ `x`'s] 值”（因此不受明确赋值规则的约束），因为`this.x`它不是实例变量的简单名称`x`。（请注意，在上面引用的文本之后的段落中，发生明确分配时的规则*确实*允许类似的内容`this.x = 3`，并认为`x`此后被明确分配；这只是不计入访问的规则`this.x`。）请注意，该值在这种情况下，根据[§17.5.2](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html#17.5.2)`this.x`将为零。

在 Java 7 编译器中，这是一个编译器错误，但可以理解。[Java 7 SE 版](http://docs.oracle.com/javase/specs/jls/se7/html/jls-16.html)[*Java 语言规范*](http://docs.oracle.com/javase/specs/jls/se7/html/jls-16.html)[的第 16 章“明确赋值”](http://docs.oracle.com/javase/specs/jls/se7/html/jls-16.html)*说：*

 *> 每个局部变量 ( [§14.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.4) ) 和每个空白`final`字段 ( [§4.12.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.4) , [§8.3.1.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.1.2) )在发生对其值的任何访问时都必须具有*明确分配的值。*
> 
> 对其值的访问包括变量的简单名称**（或者，对于字段，由 限定的字段的简单名称`this`）**出现在表达式中的任何位置，除了作为简单赋值运算符的左侧操作数`=`（第[15.26 节）。 1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.26.1) )。

（强调我的）。所以在表达式`2 * this.x`中，该`this.x`部分*应该*被认为是“访问 [ `x`'s] 值”，并且*应该*给出编译错误。

但是你没有问第一个*是否**应该*编译，你问它*为什么*编译（在某些编译器中）*。*这必然是推测性的，但我会做出两个猜测：

1.  大多数 Java 7 编译器都是通过修改 Java 6 编译器编写的。一些编译器编写者可能没有注意到这种变化。此外，许多 Java-7 编译器和 IDE 仍然支持 Java 6，并且一些编译器编写者可能没有动力专门拒绝他们在 Java-6 模式中接受的 Java-7 模式中的某些内容。
2.  新的 Java 7 行为奇怪地不一致。like`(false ? null : this).x`仍然是允许的，就此而言， even`(this).x`仍然是允许的；只有特定的标记序列`this`加上`.`受此更改影响的字段名称。诚然，这样的不一致已经存在于赋值语句的左侧（我们可以写`this.x = 3`，但不能写`(this).x = 3`），但这更容易理解：它被接受`this.x = 3`为其他被禁止的构造的特殊允许情况`obj.x = 3`。允许这样做是有道理的。但我认为拒绝`2 * this.x`作为其他允许的结构的特殊禁止情况是没有意义的`2 * obj.x`，假设（1）这个特殊的禁止情况很容易通过添加括号来解决，（2）这种特殊的禁止情况在以前的语言版本中是允许的，并且（3）我们仍然需要`final`字段具有它们的特殊规则默认值（例如`0`对于 an `int`）直到它们被初始化，这既是因为像这样的情况`(this).x`，也是因为像`this.foo()`where `foo()`is a method that accesses这样的情况`x`。因此，一些编译器编写者可能没有动力做出这种不一致的更改。

其中任何一个都会令人惊讶——我假设编译器编写者对规范的每一次更改都有详细的信息，并且根据我的经验，Java 编译器通常非常擅长完全遵守规范（不像某些语言，每个编译器都有自己的自己的方言）——但是，好吧，发生了*一些*事情，以上是我唯一的两个猜测。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:53:14.043

当您`this`在构造函数中使用时，**编译器将其视为** **object (default initialized)**`x`的成员属性。由于is ，它默认初始化为. 这使编译器感到高兴，并且在运行时也可以正常工作。`this` **`x``int``0`**

 **当您不使用`this`时，编译器会`x`直接在词法分析中使用声明，因此它会抱怨它的初始化（**编译时现象**）。

所以它的定义`this`，使得编译器在编译`x`中的词法分析时，将其作为对象的成员变量而不是直接属性进行分析，从而导致不同的编译行为。

> 当用作主要表达式时，关键字 this 表示一个值，该值是对调用实例方法的对象（第 15.12 节）或正在构造的对象的引用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-13T16:52:38.657

我认为编译器估计编写 this.x 意味着存在“this”，因此调用了构造函数（并且已初始化最终变量）。但是在尝试运行它时你应该得到一个 RuntimeException

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-13T16:56:55.067

我假设您指的是 Eclipse 中的行为。（如评论所述，使用 javac 编译可以工作）。

我认为这是一个 Eclipse 问题。它有自己的编译器和自己的一套规则。其中之一是您可能无法访问未初始化的字段，尽管 Java 编译器会为您初始化变量。****

# c++ - 将 Web 应用程序作为资源嵌入到 C++ Qt 可执行文件中

> ID：13864465
> 
> 赞同：1
> 
> 时间：2012-12-13T16:44:33.817
> 
> 标签：c++, html, qt, web-applications, qwebview

我想在`QWebView`.

我的“网络应用程序”由一些带有 CSS、Javascript 和图片的 HTML5 页面组成。它是完全自主的。它不需要服务器。

我对 Qt 编程很陌生。有没有办法将这些文件嵌入到 Qt 项目中并在`QWebView`程序启动时加载它们？

我已经设法从远程 HTTP 服务器加载这些页面，但我的应用程序必须是独立的。

**编辑**

感谢您的解决方案 Yodabox。页面显示得很好。我将 baseUrl 设置为`"qrc:///web/"`而不是`":/web/"`. 但我仍然有一个问题。

我对嵌入式 XML 文件执行异步请求以加载 HTML 选择中的值。JavascriptConsole 给出消息：`XHR finished loading: "qrc:///web/xml/values.xml"` **但未填充选择**。你有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T02:05:47.427

所有你需要的是 [QWebView::setHtml](http://qt-project.org/doc/qt-4.8/qwebview.html#setHtml)

```
void QWebView::setHtml ( const QString & html, const QUrl & baseUrl = QUrl() ) 
```

您应该将 baseUrl 设置为 ":/web/" 并将 html 设置为 HTML 文件内容，请阅读 Qt DOC 了解详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:53:52.300

如果这些页面在应用程序的执行过程中不应该改变，我认为你可以将它封装在一个*资源文件*中......（我不知道它是好是坏......只是它满足你的需要）

您可以在此处阅读有关资源系统的信息：[资源系统](http://doc.qt.digia.com/qt/resources.html)

# php - 正则表达式替换php中的链接

> ID：13864466
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:44:34.157
> 
> 标签：php, regex, expression

我不擅长正则表达式，我需要一些帮助。

我在下面有一个链接：

> [http://www.mydomain.com/1/1/5/1/some-name-123-115194_7_9.jpg](http://www.mydomain.com/1/1/5/1/some-name-123-115194_7_9.jpg)

使用 php 得到的正则表达式应该是什么，如下所示：

> [http://www.mydomain.com/1/1/5/1/115194_7_9.jpg](http://www.mydomain.com/1/1/5/1/115194_7_9.jpg)

这是我到目前为止所尝试的：

```
preg_match_all('/(\d+)(\w+)/', $str,$matches); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:52:44.013

使用`preg_replace`：

```
$url = "http://www.mydomain.com/1/1/5/1/some-name-123-115194_7_9.jpg";

echo preg_replace('#(.+/).+-(.+)#','$1$2',$url)

>>> http://www.mydomain.com/1/1/5/1/115194_7_9.jpg 
```

解释：

```
(.+/)   # Match everything upto the last / and capture
.+-     # Match upto the last -
(.+)    # Match and capture everything else 
        # Replace with 
$1$2    # The first and second capture groups 
```

# c# - C# 如何在数组中定义花哨的对象（文本框、按钮等）

> ID：13864468
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:44:42.243
> 
> 标签：c#, arrays, button, textbox, label

我知道如何定义一个由 int[i]、byte[i] 等组成的数组。喜欢它，因为我可以使用 for 循环来运行它们。现在我正在考虑对文本框、按钮、标签等花哨的对象做同样的事情......我想知道这是否可能。

如果是，那怎么办？对象的名称将如何？像 mytextbox[1]、mylabel[2] 这样的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T16:46:16.393

这是完全正确的。

```
TextBox[] myTextBoxes = new TextBox[10]; 
```

或者，您可以创建一个类型数组`Control`并将其与任何类型的控件一起使用：

```
Control[] myControls = new Control[10];
myControls[0] = new TextBox();
myControls[1] = new DropDownList(); 
```

为了将这些添加到您的表单中，您必须将每个`Controls`动态添加到表单的属性中。

```
foreach(Control control in myControls)
{
    Controls.Add(control);
} 
```

您还必须在后面的代码中设置每个控件的属性，例如`Id`、等，`Text`以及`Height`、和. 这就是您将每个控件放置在表单上所需位置的方式。`Width``Top``Left`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:50:29.843

您可以创建一个可以包含所有这些元素的通用列表，但请记住，如果您不知道这些元素是什么类型，那么之后您将无法访问它们的属性。

所以，如果你做一个标签数组（或列表，所以你不定义大小）：

```
List<Label> labelList = new List<Label>(); 
```

那么没关系，因为您可以使用 for/foreach 遍历它们以及您需要做的任何事情。

如果您想构建一个非同质的项目列表，同时放入标签、文本框和其他项目，请记住，在实际使用该对象之前，您必须付出额外的努力来确定 list[i] 是什么.

# android - Android - 如何循环缩放/放大图像的一部分？

> ID：13864480
> 
> 赞同：22
> 
> 时间：2012-12-13T16:45:19.853
> 
> 标签：android, android-canvas, android-imageview, touch-event, zooming

我试图让用户触摸图像，然后基本上会显示一个圆形放大镜，这将允许用户更好地选择图像上的某个区域。当用户释放触摸时，放大的部分将消失。这用于几个照片编辑应用程序，我正在尝试实现我自己的版本。我下面的代码确实放大了图像视图的圆形部分，但一旦我松开手指，就不会删除或清除缩放。我目前使用将位图设置为画布`canvas = new Canvas(bitMap);`，然后使用`takenPhoto.setImageBitmap(bitMap);` 我不确定我是否以正确的方式进行操作。onTouch 代码如下：

```
zoomPos = new PointF(0,0);
        takenPhoto.setOnTouchListener(new OnTouchListener() {

            @Override
            public boolean onTouch(View v, MotionEvent event) {
                 int action = event.getAction(); 
                    switch (action) { 
                        case MotionEvent.ACTION_DOWN: 
                            zoomPos.x = event.getX();
                            zoomPos.y = event.getY();
                            matrix.reset();
                            matrix.postScale(2f, 2f, zoomPos.x, zoomPos.y);
                            shader.setLocalMatrix(matrix);
                            canvas.drawCircle(zoomPos.x, zoomPos.y, 20, shaderPaint);
                            takenPhoto.invalidate();
                            break; 
                        case MotionEvent.ACTION_MOVE: 
                            zoomPos.x = event.getX();
                            zoomPos.y = event.getY();
                            matrix.reset();
                            matrix.postScale(2f, 2f, zoomPos.x, zoomPos.y);
                            canvas.drawCircle(zoomPos.x, zoomPos.y, 20, shaderPaint);
                            takenPhoto.invalidate();
                            break; 
                        case MotionEvent.ACTION_UP:   
                            //clear zoom here?

                            break; 
                        case MotionEvent.ACTION_CANCEL: 
                            break; 
                        default: 
                            break; 
            }
                    return true; 
            } 
            }); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-20T18:51:12.223

调整您的代码，我能够使以下方法起作用。

在 onTouch 函数中，设置一个全局点来确定用户触摸的位置，并设置一个布尔值来指示缩放当前是否处于活动状态：

```
@Override
public boolean onTouch(View view, MotionEvent event) {

    int action = event.getAction(); 

    zoomPos.x = event.getX();
    zoomPos.y = event.getY();

    switch (action) { 
    case MotionEvent.ACTION_DOWN:
    case MotionEvent.ACTION_MOVE:
        zooming = true;
        this.invalidate();
        break; 
    case MotionEvent.ACTION_UP:   
    case MotionEvent.ACTION_CANCEL:
        zooming = false;
        this.invalidate();
        break; 

    default: 
        break; 
    }

    return true; 
} 
```

然后，在 onDraw 方法中，您使用您的代码来绘制放大的部分：

```
@Override
protected void onDraw(Canvas canvas) {

    super.onDraw(canvas);

    if (zooming) {
        matrix.reset();
        matrix.postScale(2f, 2f, zoomPos.x, zoomPos.y);
        mPaint.getShader().setLocalMatrix(matrix);

        canvas.drawCircle(zoomPos.x, zoomPos.y, 100, mPaint);
    }
} 
```

[请注意，对于着色器，我使用了此处](https://stackoverflow.com/questions/11442934/magnifying-part-of-the-canvas-when-touched)描述的位图着色器，它是通过以下方式创建的：

```
mBitmap = BitmapFactory.decodeResource(getResources(), R.drawable.image);
mShader = new BitmapShader(mBitmap, TileMode.CLAMP, TileMode.CLAMP);

mPaint = new Paint();
mPaint.setShader(mShader); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T11:01:12.413

恢复对图像所做的任何更改的最佳方法是从源文件重新加载图像。或者，在转换开始之前，在`MotionEvent.ACTION_UP`加载原始矩阵期间保留原始矩阵变量的副本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-19T08:59:24.660

有人要求固定放大镜位置，我试验了一下，想出了解决办法：

```
// bitmapWidth is the width of bitmap used for BitmapShader
// bitmapHeight is the height of bitmap used for BitmapShader
// canvasWidth is the width of canvas where the zoom touch events are tracked (usually has the same image as shader but can be different size)
// canvasHeight is the height of canvas where the zoom touch events are tracked
// touchPoint is the point on the canvas which area should be shown in zoom circle
// fixedZoomPoint is the center of the zoom circle (different from touch point)
// ZOOM_SCALE is the zooming ratio (e.g.: 2f)
// ZOOM_RADIUS is the radius of the zoom circle

override fun onDraw(canvas: Canvas) {
    super.onDraw(canvas)
    if (zooming) {
        val widthRatio = bitmapWidth / canvasWidth // This can be omitted if 1.0
        val heightRatio = bitmapHeight / canvasHeight // This can be omitted if 1.0
        matrix.reset()
        matrix.postScale(ZOOM_SCALE, ZOOM_SCALE, touchPoint.x * widthRatio, touchPoint.y * heightRatio)
        matrix.postTranslate(fixedZoomPoint.x - touchPoint.x * widthRatio, fixedZoomPoint.y - touchPoint.y * heightRatio)
        paint.getShader().setLocalMatrix(matrix)
        drawCircle(fixedZoomPoint.x, fixedZoomPoint.y, ZOOM_RADIUS, paint)
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-17T05:19:49.160

您可以通过使用自定义图像视图来实现它，在您的包中创建一个类 CodesforMagnifierImageView.java。[您可以在CodesforMagnifier.java](http://codesfor.in/image-magnifier-android/)中查看各个类的代码，只需在布局文件中使用以下代码代替 imageview

```
<com.yourpackage.CodesforMagnifierImageView
     android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:src="@drawable/your image" /> 
```

# python - IDLE退出代码后的电子邮件重新启动

> ID：13864486
> 
> 赞同：1
> 
> 时间：2012-12-13T16:45:37.873
> 
> 标签：python, email, restart, python-idle

我试图通过在线搜索找到一些帮助，但找不到任何东西，所以我在这里发帖并希望。我有一堆代码，其中包含 3 个“for”循环和第三个“for”循环内的 try/except 语句。我从 IDLE 运行该模块，它运行了大约 16 个小时，然后退出并在 IDLE 命令屏幕上打印 =====Restart====。它随机执行此操作，因此我无法复制它，但我已经手动完成并能够处理它退出时没有问题的数据。有谁知道发生这种情况时自己有 python 电子邮件的方法？我尝试将主代码放在定义中并使用 try: definition except: send email

但这也不起作用。我的代码的电子邮件部分工作正常。很抱歉，我没有在此处包含代码。我已经和我的老板谈过了，但由于它正在处理敏感数据，我不允许这样做。您可以提供的任何指导将不胜感激。

谢谢

# multithreading - CUDA 帮助实现具有 320*240 图像处理的内核函数

> ID：13864488
> 
> 赞同：0
> 
> 时间：2012-12-13T16:45:45.653
> 
> 标签：multithreading, visual-c++, mfc, cuda, kernel

我对 cuda 很陌生，正在尝试通过此代码读取 cuda 中的帧，但我遇到了一个推翻错误并得到黑色输出..这是我的代码..

```
BYTE *imageBuf = 0;
BYTE *maBuf = 0;
BYTE *fgBuf = 0;
BYTE *tempBuf = 0;

cudaMalloc((void **)&maBuf , m_imgWidth*m_imgHeight);
cudaMalloc((void **)&fgBuf , m_imgWidth*m_imgHeight);
cudaMalloc((void **)&imageBuf , m_imgWidth*m_imgHeight);
cudaMalloc((void **)&tempBuf , m_imgWidth*m_imgHeight);
cudaMalloc((void **)&m_pixel_ptr , m_imgWidth*m_imgHeight);

cudaMemcpy(m_pixel_ptr , m_pixelParam , m_imgWidth*m_imgHeight , cudaMemcpyHostToDevice);
cudaMemcpy(imageBuf , inImgBuf , m_imgWidth*m_imgHeight , cudaMemcpyHostToDevice);
cudaMemcpy(fgBuf , foregroundBUf , m_imgWidth*m_imgHeight , cudaMemcpyHostToDevice);
cudaMemcpy(maBuf , maskBuf , m_imgWidth*m_imgHeight , cudaMemcpyHostToDevice);
cudaMemcpy(tempBuf , foregroundBUf , m_imgWidth*m_imgHeight , cudaMemcpyHostToDevice);

kernel<<<16,20>>>(imageBuf, maBuf, fgBuf , 320 , 240 , m_pixel_ptr , tempBuf , 0);

cudaMemcpy (maskBuf, maBuf , m_imgWidth*m_imgHeight , cudaMemcpyDeviceToHost);
cudaMemcpy (foregroundBUf, fgBuf , m_imgWidth*m_imgHeight , cudaMemcpyDeviceToHost);
cudaMemcpy (inImgBuf, imageBuf , m_imgWidth*m_imgHeight , cudaMemcpyDeviceToHost);
cudaMemcpy (m_pixelParam , m_pixel_ptr , m_imgWidth*m_imgHeight , cudaMemcpyDeviceToHost);

cudaFree(m_pixel_ptr);
cudaFree(imageBuf);
cudaFree(maBuf);
cudaFree(tempBuf);
cudaFree(fgBuf); 
```

这就是我调用内核函数的方式，这是我的内核函数

```
 __global__ void kernel(BYTE *inImgBuf, BYTE *maskBuf,  BYTE *foregroundBUf , int width , int height , PixelPara *m_pixelParam , BYTE *tmpBuffer , int j)
{

int m_IniWeight = 0.005;
int m_IniStd = 400.0;
int m_Threshold = 0.7;
int fgTh;

int thresholdRank;

for(int i = 0; i < width; i++)
{
        int tid = ((threadIdx.x + blockIdx.x * blockDim.x)*width + i);
        if (m_pixelParam[tid].m_validModels == 0) 
        {
            m_pixelParam[j*width+i].m_weight[0] = m_IniWeight;
            m_pixelParam[j*width+i].m_stdVar[0] = m_IniStd;
            m_pixelParam[j*width+i].m_priRank[0] = 0;
            m_pixelParam[j*width+i].m_mean[0] = (double)inImgBuf[j*width+i];
            m_pixelParam[j*width+i].m_validModels++;

        }
        else
        {
            thresholdRank = 0;
            fgTh = 0.0;             
            while (true)
            {
                fgTh += m_pixelParam[j*width+i].m_weight[m_pixelParam[j*width+i].m_priRank[thresholdRank]];                 

                if ((fgTh > m_Threshold) || (thresholdRank >= m_pixelParam[j*width+i].m_validModels - 1)) 
                    break;      

                thresholdRank++;
            }

                gmmImplementation (inImgBuf, maskBuf, foregroundBUf ,width , height , m_pixelParam , (j*width+i) ,tmpBuffer ,thresholdRank );

            foregroundBUf = tmpBuffer;

        }

}

} 
```

任何人都可以在这里帮助我如何在 cuda 中处理 320 * 240 帧我正在尝试在 cuda 上实现 GMM 但失败了..任何帮助或指导..谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:05:44.820

问题似乎是您正在分配 m_pixel_ptr 的大小`m_imgWidth*m_imgHeight`，而它看起来应该是`m_imgWidth*m_imgHeight * sizeof(PixelPara)`. 这可以解释为什么你会遇到缓冲区溢出。您可能正在尝试读取和写入超出数组末尾的方式。当然，您对 m_pixel_ptr 的 cudaMemcpy 调用也需要长度`m_imgWidth*m_imgHeight * sizeof(PixelParam)`，以便将整个缓冲区复制到设备和从设备复制。

另外， imageBuf 应该包含双精度字节还是仅包含单个字节？现在，您的代码只需从每个像素读取一个字节，`inImgBuf`然后将其转换为双精度，然后再将其存储到`m_pixelParam[j*width+i].m_mean[0]`. 如果它应该读取双精度，则需要分配和复制具有大小的 imageBuf，`m_imgWidth*m_imgHeight * sizeof(double)`并且需要在内核参数列表中声明`inImgBuf`为 a而不是 a 。`double *``BYTE *`

# c++ - 简单的 C++ 字符数组加密函数 - 段错误

> ID：13864489
> 
> 赞同：0
> 
> 时间：2012-12-13T16:45:56.373
> 
> 标签：c++, pointers, encryption, arrays

与往常一样，指针有问题。我正在尝试为 char 数组创建一个非常简单的“加密/解密”函数。是的，我知道我可以使用字符串，但我想提高我对指针的了解，并利用简单的字节来完成一项简单的任务。所以，我创建了一个这样的简单结构：

```
struct text {
    char* value;
    int size;
} 
```

我创建了这个简单的函数：

```
text encrypt(text decrypted) {
    char key = 'X';
    for (int i=0; i<decrypted.size; i++) {
        decrypted.value[i] = decrypted.value[i] ^ (key + i) % 255);
    }
    return decrypted;
} 
```

在这一点上，我认为一个有经验的 C++ 程序员应该已经发现了这个问题。无论如何，我这样称呼这个函数：

```
...
text mytext;
mytext.value = new char[5];
mytext.value = "Hello";
mytext.size = 5;

mytext = encrypt(mytext);
... 
```

像往常一样，我收到“分段错误（核心转储）”错误。这是 Linux，当然还有 g++。我又做了什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:47:45.777

```
mytext.value = new char[5];
mytext.value = "Hello"; 
```

在第二行，你扔掉（句柄）分配的内存，泄漏它，并让`mytext.value`指向一个字符串文字。修改字符串文字是未定义的行为，并且通常会崩溃，因为字符串文字通常存储在只读内存段中。

如果您坚持使用 a `char*`，则应`strncpy`将字符串放入分配的内存中（但请注意，那时它不会以 0 结尾，您最好分配 a`new char[6]`并复制 0 终止符）。

或者让`decrypt`创建一个`text`它返回的新的：

```
text encrypt(text decrypted) {
    char key = 'X';
    text encrypted;
    encrypted.size = decrypted.size;
    encrypted.value = new char[encrypted.size];
    for (int i=0; i<decrypted.size; i++) {
        encrypted.value[i] = decrypted.value[i] ^ (key + i) % 255;
    }
    // What about 0-terminators?
    return encrypted;
} 
```

但是，当您使用 C++ 时，`std::string`这里将是一个更好的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:47:55.183

您正在修改字符串文字：

```
mytext.value = "Hello"; 
```

在此之后，您不能再合法地改变`mytext.value`指向的内容，您只能重新分配指针。

修复：**使用`std::string`**

# jquery - jquery ui 可拖动限制，因此无法拉过另一个 div

> ID：13864492
> 
> 赞同：0
> 
> 时间：2012-12-13T16:46:03.813
> 
> 标签：jquery, user-interface

如果 div 已经存在或只是一个限制，我可以限制可拖动功能跳下吗？有什么方法吗？

```
$(document).ready(function(){
$(".a").draggable();
 }); 
```

[这是代码](http://jsfiddle.net/5EChH/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:03:40.793

查看[jQuery UI Draggable Collision](http://sourceforge.net/projects/jquidragcollide/)。它是一个为您的可拖动元素提供碰撞事件的插件。你应该能够解决你所有的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:54:33.363

也许您打算使用可排序的？以下是如何使用它们的示例：

HTML：

```
<ul>
   <li>
      <div class="a" style="width: 200px;height: 200px;background: red;"></div>
   </li>
   <li>
      <div class="a" style="width: 200px;height: 200px;background: green;">
      </div>
   </li>
   <li>
      <div class="a" style="width: 200px;height: 200px;background: blue;">
      </div>
   </li>
</ul> 
```

JS：

```
$(document).ready(function(){
    $("ul").sortable();
}); 
```

演示：http: [//jsfiddle.net/5EChH/1/](http://jsfiddle.net/5EChH/1/)

# c#-4.0 - 使用 LINQ/扩展方法重复字符串

> ID：13864493
> 
> 赞同：5
> 
> 时间：2012-12-13T16:46:08.610
> 
> 标签：c#-4.0

只是我正在调查的好奇心。

问题：简单地重复（相乘，有人会说）一个字符串/字符**n**次。
我知道有**Enumerable.Repeat**来实现这个目标，但我试图在没有它的情况下做到这一点。 **在这种情况下， LINQ**似乎毫无用处，因为在这样的**查询**中

```
from X in "s" select X 
```

**字符串**" s" 正在被探索，所以 X 是一个**char**。**扩展方法**也是如此，因为例如“s”。**聚合**(blablabla) 将再次仅对字符 's' 起作用，而不是字符串本身。为了重复字符串，需要一些“外部”的东西，所以我认为**lambdas**和**delegates**，但是如果不声明一个变量来分配委托/lambda 表达式，就无法做到这一点。
所以像定义一个函数并内联调用它：

```
( (a)=>{return " "+a;} )("a"); 
```

或者

```
delegate(string a){return " "+a}(" "); 
```

会给出一个“没有名称”的错误（因此**没有递归**，AFAIK，即使通过将可能的 lambda/delegate 作为**参数**传递），最后甚至不能由 C# 创建，因为它的局限性。
可能是我从错误的角度看待这件事。有任何想法吗？
这只是一个实验，我不关心表演，不关心内存使用......只是它是一条线并且有点自主。也许有人可以用 Copy/CopyTo 做某事，或者将其投射到其他集合中，我不知道。**反射**也被接受。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T16:50:02.087

要重复一个字符 n 次，你不会使用`Enumerable.Repeat`，而只是使用[这个字符串构造函数](http://msdn.microsoft.com/en-us/library/xsa4321w.aspx)：

```
string str = new string('X', 10); 
```

要重复一个字符串，我不知道有什么比使用`string.Join`and`Enumerable.Repeat`

```
string foo = "Foo";
string str = string.Join("", Enumerable.Repeat(foo, 10)); 
```

编辑：`string.Concat`如果不需要分隔符，您可以改用：

```
string str = string.Concat( Enumerable.Repeat(foo, 10) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:59:43.447

如果你想重复一个字符串，而不是一个字符，一个简单的方法是使用[`StringBuilder.Insert`method](http://msdn.microsoft.com/en-us/library/62eb5xsf.aspx)，它需要一个插入索引和一个要使用的重复次数的计数：

```
var sb = new StringBuilder();
sb.Insert(0, "hi!", 5);
Console.WriteLine(sb.ToString()); 
```

否则，要重复单个字符，请使用我在[此处类似问题](https://stackoverflow.com/a/3754700/59111)的评论中提到的字符串构造函数。例如：

```
string result = new String('-', 5); // ----- 
```

为了完整起见，值得注意的是，它`StringBuilder`提供了一个可以重复字符的[重载`Append`方法](http://msdn.microsoft.com/en-us/library/yxyxbz2e.aspx)，但对于字符串没有这种重载（这是该`Insert`方法的用处）。`StringBuilder`如果这就是我感兴趣的全部，我更喜欢字符串构造函数。但是，如果我已经在使用 a ，那么使用该方法从某些链接中受益`StringBuilder`可能是有意义的。`Append`这是一个人为的示例来演示：

```
var sb = new StringBuilder("This item is ");
sb.Insert(sb.Length, "very ", 2) // insert at the end to append
  .Append('*', 3)
  .Append("special")
  .Append('*', 3);
Console.WriteLine(sb.ToString()); // This item is very very ***special*** 
```

# jquery - MVC JQuery - 异步加载后失去样式

> ID：13864494
> 
> 赞同：0
> 
> 时间：2012-12-13T16:46:08.747
> 
> 标签：jquery

我的表格上有一个网格，上面有以下 jquery 的颜色；

```
$("#tblePagedList tr:even").addClass("row1");
$("#tblePagedList tr:odd").addClass("row2"); 
```

这很好用，除非当我通过使用 Ajax 对服务器的异步调用进行搜索并刷新我的网格时，这种特殊的样式消失了。

使用以下 jquery 重新加载表单；

```
 var ajaxFormSubmit = function () {
        var $form = $(this);

        var options = {
            url: $form.attr("action"),
            type: $form.attr("method"),
            data: $form.serialize()
        };

        $.ajax(options).done(function (data) {
            var $target = $($form.attr("data-scd-target"));
            var $newHtml = $(data);
            $target.replaceWith($newHtml);
            $newHtml.effect("highlight");
        });

        return false;
    }; 
```

一种尝试的解决方案是在上面的 done 函数中复制并粘贴 2 条样式行，但这没有任何区别。

我的表格看起来像；

```
@using SCD.Helpers
@model IPagedList<SCD.ViewModels.SubcontractorLineViewModel>

@{
    ViewBag.Title = "List Subcontractors";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<fieldset>
<legend>Subcontractors</legend>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

    <form method="get" action="@Url.Action("ListSubcontractors")" 
          data-scd-ajax="true" data-scd-target="#subcontractorList">
        <table class="searchTable">
            <tr>
                <td>Company: <input type="text" name="searchCompany" /></td>
                <td>Address: <input type="text" name="searchAddress" /></td>
                <td>Town/City: <input type="text" name="searchCity" /></td>
            </tr>
            <tr>
                <td>County: <input type="text" name="searchCounty" /></td>
                <td>Trade: <input type="text" name="searchTrade" /></td>
                <td>Other Trade: <input type="text" name="searchOtherTrade" /></td>
            </tr>
            <tr>
                <td colspan="2">@this.TempData["SearchMessage"].ToSafeString()</td>
                <td><input type="submit" value="Search" /> </td>
            </tr>
        </table>
    </form>
@Html.Partial("_Subcontractors")

</fieldset> 
```

我的 PartialView 看起来像

```
@model IPagedList<SCD.ViewModels.SubcontractorLineViewModel>
<div id="subcontractorList">
    <div class="pagedList" data-scd-target="#subcontractorList">
        @Html.PagedListPager(Model, page => Url.Action("ListSubcontractors", new { page }),
        PagedListRenderOptions.DefaultPlusFirstAndLast)
    </div>
    <table id="tblePagedList">
        <thead>
            <tr>
                <th>
                    Company
                </th>
                <th>
                    Address
                </th>
                <th style="width:100px;">
                    Telephone
                </th>
                <th style="width:100px;">
                    Contact
                </th>
                <th style="width:100px;">
                    Trade
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody id="tblePagedListBody"></tbody>
        @foreach (var item in Model) {
            <tr>
                <td>
                    @item.Company
                </td>
                <td>
                    @item.AddressLine
                </td>
                <td>
                    @item.Telephone
                </td>
                <td>
                    @item.Contact
                </td>
                <td>
                    @item.TradeName
                </td>
                <td>
                    @Html.ActionLink("Details", "DetailsSubcontractor", new { id = item.CompanyId })
                </td>
            </tr>
        }

    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:06:55.983

问题是从 AJAX 调用返回的 HTML 没有样式。解决方案是用返回的 html 替换网格后，只需重新设置网格的样式即可。

```
 $.ajax(options).done(function (data) {
        var $target = $($form.attr("data-scd-target"));
        var $newHtml = $(data);
        $target.replaceWith($newHtml);
        $newHtml.effect("highlight");

        $("#tblePagedList tr:even").addClass("row1");
        $("#tblePagedList tr:odd").addClass("row2");
    }); 
```

# ruby-on-rails - 使用 formtastic 的多个提交操作

> ID：13864499
> 
> 赞同：1
> 
> 时间：2012-12-13T16:46:21.473
> 
> 标签：ruby-on-rails, formtastic

我正在尝试设置一个带有多个提交操作的表单，以及 Railscast #38。在 Formtastic 中相当于什么？

```
<%= submit_tag 'Create' %>
<%= submit_tag 'Preview', :name => 'preview_button' %> 
```

[这篇文章](https://stackoverflow.com/questions/6324279/how-can-i-have-multiple-commit-buttons-for-a-form-in-formtastic-in-rails-3)给了我希望，但它看起来`commit_button`在 2.1.0 中已被弃用，我似乎无法弄清楚新的语法。

这是我的代码，它的价值。我希望每个提交按钮都转到同一个控制器，在那里我将以不同的方式处理它们：

```
# Use prepaid credits to checkout
<%= f.action :submit, :as => :button, :label => "Order Critique (1 credit will be spent)", :button_html => { :class => "btn btn-primary", :disable_with => 'Processing...' } %>
# Use credit card to checkout
<%= f.action :submit, :as => :button, :label => "Order Critique ($10)", :button_html => { :class => "btn btn-primary", :disable_with => 'Processing...' } %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:05:09.413

**TL;DR：**如果您使用 javascript 提交表单，它不会在提交参数中保留提交按钮的名称。

我的问题最终成为 Railscasts Episode #288 中使用的代码。当您提交表单时，在 Stripe 令牌签出后，此 CoffeeScript 函数会被触发：

```
handleStripeResponse: (status, response) ->
  if status == 200
    $("#stripe_card_token").val(response.id)
    $("#my_form_id")[0].submit()
  else
    # other stuff 
```

由于 javascript 正在使用 进行表单提交`$("#my_form_id")[0].submit()`，因此 name 参数将不会在提交参数中进行传递。

我的解决方案是为被点击的按钮添加一个“点击”属性......

```
$('form_input[type=submit]').click ->
  $('input[type=submit]', $(this).parents('form')).removeAttr('clicked')
  $(this).attr('clicked', 'true') 
```

..然后抓住点击按钮的 id 属性，用它填充一个隐藏字段：

```
submitter = $("input[type=submit].clicked=true").attr("id") 
```

我不是特别喜欢这个解决方案。感觉自己的js懂的太多了，不喜欢依赖js做这种事情。当然欢迎任何批评或更好的解决方案:)

# jquery - 谁能告诉我为什么这个动画不起作用？

> ID：13864500
> 
> 赞同：1
> 
> 时间：2012-12-13T16:46:24.143
> 
> 标签：jquery

我无法`display: block`继续工作`span`。

```
$(".wishlistbtn, .compareboxbtn").hover(
    function() { $(this).children(".helppopup").show(); },
    function() { $(this).children(".helppopup").hide(); }
); 
```

带标记：

```
<ul>
    <li class="wishlistbtn"><a href="#">Wishlist <span class="helppopup">Add to my Wishlist<img src="images/helppopup-arrow.png" alt=""></span></a></li>
    <li class="compareboxbtn"><a href="#">Compare <span class="helppopup">Add to compare box<img src="images/helppopup-arrow.png" alt=""></span></a></li>
    <li class="getquotebtn"><a href="#">Get Quote</a></li>
</ul> 
```

它根本行不通，但同样的技术在其他地方也行得通。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:49:38.113

使用`find`代替`children`，因为该`.hellpopup`元素不是直接子元素：

```
$(".wishlistbtn, .compareboxbtn").hover(
    function() { $(this).find(".helppopup").show(); },
    function() { $(this).find(".helppopup").hide(); }
); 
```

[（丑）示范](http://jsfiddle.net/8vLqq/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:49:45.510

```
$(".wishlistbtn, .compareboxbtn").hover(
// the .helpopup's are grandchildrean, not children of 'this'
    function() { $(this).find(".helppopup").show(); },
    function() { $(this).find(".helppopup").hide(); }
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:51:46.150

确保您在 $(document).ready(); 中运行该函数；在dom加载之后。

# c# - CancellationToken 取消注册操作

> ID：13864503
> 
> 赞同：38
> 
> 时间：2012-12-13T16:46:32.987
> 
> 标签：c#, task, async-await, async-ctp, cancellation-token

我有一个用于各种任务的令牌，我需要更好地管理它们的取消，以便收到我可以使用的取消通知：

```
token.Register(RegisterMethod); 
```

如何删除此“订阅”？有没有办法“取消注册”？

我想过用 TaskCompletionSource 做一个解决方法。但我不知道它是否会运作良好。解决这种方法的最佳方法是什么？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-12-13T19:01:13.323

[`CancellationToken.Register`](http://msdn.microsoft.com/en-us/library/dd321790.aspx)返回一个[`CancellationTokenRegistration`](http://msdn.microsoft.com/en-us/library/system.threading.cancellationtokenregistration.aspx)实例。如果您调用[`Dispose`](http://msdn.microsoft.com/en-us/library/system.threading.cancellationtokenregistration.dispose.aspx)该实例，您的注册将被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-29T16:03:31.583

您可以安全地处置整个 CancellationTokenSource。无需担心取消注册回调。

代码： [https ://github.com/microsoft/referencesource/blob/master/mscorlib/system/threading/CancellationTokenSource.cs#L552](https://github.com/microsoft/referencesource/blob/master/mscorlib/system/threading/CancellationTokenSource.cs#L552)

CancellationTokenSource 的 Dispose() 方法将对您通过 Token.Register(callBack) 添加到令牌中的每个注册回调调用 dispose。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2016-03-23T15:48:52.120

没有办法真正撤消注册。虽然 dispose 方法将删除回调，但令牌仍然包含有注册的信息：

```
var cancellationTokenSource = new CancellationTokenSource();

basicTask = Task.Factory.StartNew(() => {
 for (;;) {
  var z = DateTime.Today.ToString();
 }
}, cancellationTokenSource.Token);

var basicTask2 = Task.Factory.StartNew(() => {
 for (;;) {
  var z = DateTime.Today.ToString();
 }
}, cancellationTokenSource.Token);

//var usingThisCodeWillResultInADeadlock = cancellationTokenSource.Token.Register(() => { });
//usingThisCodeWillResultInADeadlock.Dispose();
cancellationTokenSource.Cancel();
basicTask.Wait(); 
```

禁用评论将导致死锁。

# node.js - :Sequelize 如何设置返回数据的顺序

> ID：13864508
> 
> 赞同：6
> 
> 时间：2012-12-13T16:46:50.380
> 
> 标签：node.js, syntax-error, sequelize.js

我已经设置了带有限制和偏移量的 findAll 查询的返回数据顺序，我使用的是文档中的示例代码：`order: 'group DESC'`但它抛出一个错误说：

```
Error: SQLITE_ERROR: near "group": syntax error 
```

这是完整的功能。

```
A_Model.findAll({
     offset:req.query.page * req.query.rows - req.query.rows,
     limit :req.query.rows // TODO: Of course, I put the trailing comma here ;)
     // TODO: order: 'group DESC'
    })
.success(function (docs) {
    response_from_server.records = count;
    response_from_server.page = req.query.page;
    response_from_server.total = Math.ceil(count / req.query.rows);
    response_from_server.rows = [];

    for (item in docs) {
        response_from_server.rows.push({
            id  :docs[item].id,
            cell:[
                docs[item].group,
                docs[item].description,
                docs[item].path,
                docs[item].value
            ]
        });
    }

    // Return the gathered data.
    res.json(response_from_server);
})
.error(function (error) {       
    logger.log('error', error);
}); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-13T19:47:27.747

您提供给 findAll 方法的“订单”字符串在 Sequelize 中未解析，仅转义以防止 SQL 注入。“组”是保留关键字~~最多~~ *一些*SQL 方言，因此查询无法运行。

要使其正常工作，只需将“组”列放入 `'s，如下所示：

```
A_Model.findAll({
 offset:req.query.page * req.query.rows - req.query.rows,
 limit :req.query.rows,
 order: '`group` DESC'
}) 
```

# c++ - 从 DLL 导出 STL 类 - 为什么返回类型没有警告？

> ID：13864510
> 
> 赞同：21
> 
> 时间：2012-12-13T16:46:56.190
> 
> 标签：c++, visual-studio-2010, dll, stl, instantiation

我的问题与导出带有 STL 的 C++ 类有关。例如：

```
class __declspec(dllexport) Hello
{
    std::string   name;

public:
    std::string&  getName();
    void          setName(const std::string& name);
} 
```

各种文章似乎都表明这是**非常糟糕的**，这是可以理解的。一切都必须使用相同的编译器设置和 CRT 版本进行编译。否则一切都会崩溃和燃烧。

## 问题：

我不明白为什么只有数据成员似乎有问题。使用下面的代码，我得到：“ *C4251：需要有 dll 接口才能被类的客户端使用*”；这显然是通过导出实例化的 std::string 来解决的：

```
struct __declspec(dllexport) SomeClass
{
    // Removes the warning?
    // http://www.unknownroad.com/rtfm/VisualStudio/warningC4251.html
    //   template class __declspec(dllexport) std::string;

    std::string name;  // Compiler balks at this
} 
```

固定版本是：

```
// Export the instantiations of allocator and basic_string
template class __declspec(dllexport) std::allocator<char>;
template class __declspec(dllexport) std::basic_string<char, std::char_traits<char>, std::allocator<char> >;

struct __declspec(dllexport) SomeClass
{
    std::string name;  // No more balking!
} 
```

（当您尝试使用 DLL 时，这将给 LNK2005“basic_string 已定义”，这意味着您不必在客户端上的 CRT 中链接 - 所以它最终使用 DLL 中的实例化）。

返回类型和参数在 STL 中似乎没有问题，并且不接受从编译器获得的数据成员的相同处理。

```
// No exporting required?
struct __declspec(dllexport) SomeOtherClass
{
    std::string  doSomething1();                       // No problemo
    void         doSomething2(const std::string& s);   // No problemo
} 
```

## 附加信息（上面有问题）

同时：

```
class A {
    std::string foo() { return std::string(); }
    // std::string& foo(); gives the same result!
    // std::string* foo(); also gives the same result!
}

class B {
    std::string a;
} 
```

似乎都没有导出 std::basic_string 或 std::allocator。相反，它们只导出类的成员/函数。

但是，问题中提到的*固定版本同时导出了 basic_string 和分配器。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T19:15:44.417

> 各种文章似乎表明这是**非常糟糕的**

是的，可以。你的项目设置会让你陷入他们警告的那种麻烦。按值公开 C++ 对象要求 DLL 的客户端使用相同的 CRT，以便客户端应用程序可以安全地销毁在 DLL 中创建的对象。反之亦然。这要求这些模块使用相同的堆。

并且您的项目设置*阻止*了这种情况的发生，这是编译器警告的要点。您必须指定 CRT 的共享版本，以便所有模块加载 CRT 的唯一实现。

使用项目 + 属性、C/C++、代码生成、运行时库设置修复该问题。你现在在 /MT 有它，它必须是 /MD。为所有模块和所有配置更改此设置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T18:20:56.777

这归结为某些事物的构建方式。

当编译器看到

```
__declspec(dllimport)    std::string f();
// ...

{
  std::string tmp = f();
} 
```

它必须弄清楚要调用什么，以及从哪里获取它。所以在这种情况下：

```
std::string tmp; => sizeof( std::string ), new (__stack_addr) std::string;
tmp = f();       => call f(), operator=( std::string ) 
```

但是因为它看到了 std::string 的完整实现，所以它可以只使用相应模板的新实例。所以它可以只实例化 std::string 的模板函数并调用它，然后将函数合并到链接器阶段，在链接器阶段，链接器试图找出它可以折叠成一个的函数。唯一未知的函数是编译器必须从 dll 本身导入的 f()。（它对他来说是外部标记的）。

成员对编译器来说是一个更大的问题。它必须知道要导出的相应函数（构造函数、复制构造函数、赋值运算符、析构函数调用），并且当您将类标记为“dllexport”时，它必须导出/导入其中的每一个。您可以通过仅将必要的函数声明为 dllexport (ctor/dtor) 并禁止例如复制来显式地仅导出类的某些部分。这样，您不必导出所有内容。

关于 std::string 的一个注意事项是，它的大小/内容在编译器版本之间发生了变化，因此您永远无法在编译器版本之间安全地复制 std::string。（例如，在 VC6 中，一个字符串是 3 个指针大，目前它是 16 字节 + 大小 + 分配器大小，我认为在 VS2012 中已经优化了）。你永远不应该在你的界面中使用 std::string 对象。您可以创建一个 dll 导出的字符串实现，该实现在调用者站点上使用非导出的内联函数将其转换为 std::string。

# c# - EF4 在保存更改之前看不到上下文的更改

> ID：13864513
> 
> 赞同：2
> 
> 时间：2012-12-13T16:47:10.817
> 
> 标签：c#, entity-framework, c#-4.0, orm

您好我在 EF4 上下文中使用工作单元模式。

上下文正在通过几个方法传递，所有方法都在它上面工作，然后在完成后我调用保存更改。

当我稍后对对象的状态进行检查时，它是旧值而不是新值。但是，如果我此时调用保存更改，我希望在上下文中看到的状态将保存到数据库中。

本质上调用堆栈将是

```
Context ctx;

UpdateItems(ctx);
CheckItemsValid(ctx);
DoSomehtingElse(ctx); //Saving changes here. 
```

现在`CheckItemsValid`失败了，因为它看不到在 中所做的更改`UpdateItems`，但它是相同的上下文。

如果我将整个事情包装在 TransactionScope 中并在调用检查项目之前调用 SaveChanges，那么一切正常，但这似乎有点像大锤来破解坚果。

在更新项目方法中更新项目后，我尝试了以下操作。

```
ApplyCurrentValues();
Refresh(ClientWins);
AcceptAllChanges(); 
```

以前有没有人看到过这个问题，还是我必须处理整个事情并在流程中调用保存更改？

```
 using (EntitiesContext ctx = EntityFactory.GetEntitiesContext())
        {

            Repairs.RepairManager repman = new Repairs.RepairManager();

            repman.SetAllRepairsOfTypeToComplete(vehicle.VehicleId, RepairTypes.BodyShop, vehicle.SiteVisitId.Value, technicianId, ctx);

            SchemeManager sm = new SchemeManager();
            result = sm.ProcessVehicle(AutoMapper.Mapper.Map<EFVehicle, AbstractVehicle>(ctx.EFVehicles.Single(p => p.VehicleID == vehicle.VehicleId), new Vehicle()), ref intrules, userId, ctx, false);

            if (result == true)
            {
                ctx.SaveChanges();         
            } 
```

是流程车辆调用检查 SetAllRepairsOfTypeToComplete 是否成功的基础

将所有修复设置为完成只需将上下文 ctx.EFRepairs 上的修复列表中的某个位从 true 更新为 false。

```
 var cancelledrepairs = ((EntitiesContext)Context).EFRepairs.Where(p => p.VehicleID == vehicle.VehicleId && p.VehicleSiteVisitID == vehicle.SiteVisitId
            && p.RepairTypeID == (int)RepairTypes.BodyShop && p.RepairStatusID == (int)RepairStatusEnum.Cancelled).Count();

        var completedMechrepairs = ((EntitiesContext)Context).EFRepairs.Where(p => p.VehicleID == vehicle.VehicleId && p.VehicleSiteVisitID == vehicle.SiteVisitId
            && p.RepairTypeID == (int)RepairTypes.BodyShop && p.RepairStatusID == (int)RepairStatusEnum.Completed).Count();

        var CurrentMechanicalRepairs = ((EntitiesContext)Context).EFRepairs.Where(p=> p.VehicleID == vehicle.VehicleId && p.VehicleSiteVisitID == vehicle.SiteVisitId
            && p.RepairTypeID == (int)RepairTypes.BodyShop).Count();

        if ((completedMechrepairs + cancelledrepairs) == CurrentMechanicalRepairs)
            return true;
        else
        {
            failureMessage = "Not all mechanical repairs for this vehicle are complete";
            return false;
        } 
```

CompleteMechrepairsCount 始终为 0，即使它们在同一上下文中的 SetAllRepairsOfTypeToComplete 中进行了更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:56:44.437

This should work in principle. I even created a local test that mimics this behavior and it worked for me. I think that the most likely causes are: (any/all)

1) Your SetAllRepairsOfTypeToComplete method isn't updating the object(s) you think it is.

-or-

2) Your query to get the completedMechrepairs count isn't picking up the correct object(s).

Try doing some debugging where your EFRepair object has a unique ID that you can use to see if it gets updated. Then get a List back from your completedMechrepairs check and see if that EFRepair object with that ID is in the list.

# javascript - 如何使用 JQuery 将 GridView 呈现为手风琴菜单

> ID：13864519
> 
> 赞同：0
> 
> 时间：2012-12-13T16:47:34.467
> 
> 标签：javascript, css, accordion, jquery-ui-accordion

我正在尝试将一个简单的 gridView 呈现为 jQuery 手风琴菜单。 [在这个链接](http://www.aspdotnetcodes.com/Accordion_Data_Binding_GridView_Example.aspx)中，我找到了我需要的东西，但它都是用`asp.net`. 我需要在 jQuery 中找到一些想法。

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:22:31.253

[Slickgrid](https://github.com/mleibman/SlickGrid/wiki)是可编辑表格的绝佳解决方案，它可以根据您的要求使用 jQuery。[这是 Slickgrid 引用的一系列示例的链接](https://github.com/mleibman/SlickGrid/wiki/Examples)

# php - 使用全局变量打开 PDO 连接

> ID：13864521
> 
> 赞同：0
> 
> 时间：2012-12-13T16:47:47.137
> 
> 标签：php, pdo

我只是在这条线上有一个问题：

```
global $bdd; //declared in my bootstrap

$connexion = new PDO("mysql:host=$bdd->resources->db->host;dbname=$bdd->resources->db->dbname",$bdd->resources->db->username, $bdd->resources->db->password); 
```

我有这个错误：

> 可捕获的致命错误： Zend_Config 类的对象无法转换为字符串

变量包含的内容很好，我只是使用 var_dump 看了一下

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:50:30.747

您将变量视为字符串，从字符串中跳出以使用变量，即：

```
global $bdd; //declared in my bootstrap

$connexion = new PDO("mysql:host=".$bdd->resources->db->host.";dbname=".$bdd->resources->db->dbname,$bdd->resources->db->username, $bdd->resources->db->password); 
```

# ios - 如何从 Google Maps SDK（iOS 版）下载单个地图图块？

> ID：13864522
> 
> 赞同：0
> 
> 时间：2012-12-13T16:47:48.087
> 
> 标签：ios, google-maps, location-based

我一直在检查适用于 iOS 的新 Google Maps SDK，它允许您绕过 Apple Maps 在应用程序中使用地图相关功能！

[https://developers.google.com/maps/documentation/ios/intro](https://developers.google.com/maps/documentation/ios/intro)

SDK似乎很容易使用，但我想知道：

1.  如果可以使用 SDK（是否有 API）下载单个地图图块？
2.  如果是这样，怎么做？

我查看了他们的开发者门户网站上给出的文档，上面写着以下内容：

[https://developers.google.com/maps/documentation/ios/map](https://developers.google.com/maps/documentation/ios/map)

> 使用 Map 对象时的关键类是 GMSMapView 类。GMSMapView 自动处理以下操作：
> 
> 1.  连接到 Google 地图服务。
>     
>     
> 2.  下载地图图块。
>     
>     
> 3.  在设备屏幕上显示图块。
>     
>     
> 4.  显示各种控件，例如平移和缩放。
>     
>     
> 5.  通过移动地图和放大或缩小来响应平移和缩放手势。
>     
>     
> 6.  通过倾斜地图的视角来响应两个手指手势。

似乎图块的下载是自动发生的，还是有允许手动访问图块的 API？

如果没有，任何解决方法也会有所帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T11:27:07.047

文档和头文件未指明下载单个地图图块的任何方式。

即使您能找到解决方法，您也不会被允许使用它。[请参阅服务](https://developers.google.com/maps/terms)条款中的第 10.1.1 (a) 条：

> *除非通过服务，否则无法访问 Maps API。*您不得通过服务中提供的技术或方式以外的任何技术或方式或通过 Google 可能指定的其他明确授权方式访问或使用 Maps API 或任何内容。例如，您不得通过 Maps API 以外的接口或渠道（包括未记录的 Google 接口）访问地图图块或图像。

# jodatime - jsr310 或 joda-time 中的“13 号上周五”

> ID：13864526
> 
> 赞同：1
> 
> 时间：2012-12-13T16:47:58.603
> 
> 标签：jodatime, jsr310

我正在尝试解决[jsr310](https://github.com/ThreeTen/threeten)中的“last Friday the 13th”表达式，但如果您可以在 Joda Time 或其他一些库中解决，那也可以。我做到了这一点：

```
val builder = new DateTimeBuilder()
  .addFieldValue(ChronoField.DAY_OF_MONTH, 13)
  .addFieldValue(ChronoField.DAY_OF_WEEK, DayOfWeek.FRIDAY.getValue) 
```

这似乎指定了“13 号星期五”好吧。但是我如何从这个到“13 号上周五”呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-06T17:43:02.587

这里是每月迭代解决方案（记住两个这样的日期之间不能超过 14 个月），这可能比每日迭代解决方案更好。我在纯 Java 的 JSR-310 的基础上编写它 - 未经测试，因此无法保证（而且我不知道编写 Scala，所以你必须根据你的需要调整它）：

```
public static final TemporalAdjuster LAST_FRIDAY_13 = (Temporal temporal) -> {
  LocalDate test = LocalDate.from(temporal);

  // move to last 13th of month before temporal
  if (test.getDayOfMonth() <= 13) {
    test = test.minus(1, ChronoUnit.MONTHS);
  }

  test = test.withDayOfMonth(13);

  // iterate monthly backwards until it is a friday
  while (test.getDayOfWeek() != DayOfWeek.FRIDAY) {
    test = test.minus(1, ChronoUnit.MONTHS);
  }

  return test;
} 
```

请注意，调节器存储为静态常量（规范负责人 Stephen Colebourne 也推荐使用此值）。然后你可以这样去使用这个调节器：

```
System.out.println(LocalDate.of(2012, 12, 12).with(LAST_FRIDAY_13));
// Output: 2012-07-13 
```

顺便说一句，您也在其他库中要求提供解决方案。好吧，如果您可以等待几周（3-4），那么我将使用我的[新时间库](https://github.com/MenoData/time4j)提供一个非常相似的解决方案，它只需要 Java 6+。您当然也可以将显示的代码翻译成 JodaTime（应该或多或少直接）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T10:26:16.690

我能想出的唯一解决方案是向后走，手动检查这一天是否满足约束条件。这是一个通用的类，用于通过时间向后走以找到`DateTime`满足某些约束的类：

```
class PreviousAdjuster(constraints: (DateTimeField, Int)*) extends WithAdjuster {
  val unit = constraints.map(_._1.getBaseUnit).minBy(_.getDuration)
  def doWithAdjustment(dateTime: DateTime): DateTime = {
    var curr = dateTime
    while (constraints.exists{case (field, value) => curr.get(field) != value}) {
      curr = curr.minus(1, unit)
    }
    curr
  }
} 
```

`with`然后我可以在 a 的方法中使用该调节器`DateTime`：

```
val lastFridayThe13th = LocalDate.of(2012, 12, 12).`with`(new PreviousAdjuster(
    ChronoField.DAY_OF_MONTH -> 13,
    ChronoField.DAY_OF_WEEK -> DayOfWeek.FRIDAY.getValue))

println(lastFridayThe13th) // prints 2012-07-13 
```

感觉应该有一种更有效的方法来做到这一点，因为限制意味着我们不必每天都走过，但我不知道如何实现......

# windows-8 - Windows 应用商店 (Windows 8) 应用程序以设备为目标

> ID：13864528
> 
> 赞同：0
> 
> 时间：2012-12-13T16:48:13.377
> 
> 标签：windows-8, visual-studio-2012, windows-store-apps

我对 Windows 应用商店/Windows 8 应用程序开发感到困惑。在 Visual Studio 2012 中创建 Windows 应用商店应用程序并使用 Windows 应用商店发布它时，该应用程序将在哪些设备上可用？

一个应用程序会在所有移动设备、平板电脑和台式机上都可用吗？还是需要像在 iPhone/iPad 场景中那样单独创建版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:01:08.780

对于大多数应用程序，该应用程序将在任何运行 Windows 8 的设备上可用。实际的硬件外形无关紧要。

现在，如果您利用特定 CPU 架构（例如 ARM 与 x86/x64）独有的 API，那么您将需要分别针对每个架构。一个典型的例子是，如果您在应用程序中使用 SQLLite。SQLLite 二进制文件在每个平台上都不同，因此您需要对应用程序进行单独的构建，每个构建都针对适当的体系结构。因此，例如，可以构建仅在 x86/x64 而不是 ARM 上运行的应用程序。同样，形式因素并不重要。

更新：第一次错过，但 WP8 是一个单独的平台。您可以使用 Win8 和 WP8 之间的可移植类库之类的东西共享代码，但它们是单独的商店、单独的项目、单独的构建。

# python - 为什么使用列表作为字符串格式化参数，即使没有 %s 标识符，也会返回原始字符串？

> ID：13864532
> 
> 赞同：12
> 
> 时间：2012-12-13T16:48:22.033
> 
> 标签：python, string-formatting

```
>>> 'string with no string formatting markers' % ['string']
'string with no string formatting markers'
>>> 'string with no string formatting markers' % ('string',)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: not all arguments converted during string formatting 
```

我希望这两种情况都会引发 a `TypeError`，但事实并非如此。为什么不？

关于这个主题的[Python 文档](http://docs.python.org/2/library/stdtypes.html#string-formatting)讨论了字符串、元组和字典，但没有提到列表。我对这种行为有点困惑。我已经能够在 Python 2.7 和 3.2 中复制它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T16:58:01.950

仔细阅读，文档指出：

> 如果格式需要单个参数，则值可能是单个非`tuple` 对象。否则，值必须是`tuple`与格式字符串指定的项目数完全相同的 a，或者是单个映射对象（例如，字典）。

现在，在这种情况下，`format`不需要单个参数，因此文档告诉我们应该使用 a`tuple`或映射作为参数；其他情况属于“未定义的行为”（正在发生的事情：行为在所有情况下都不一致）。

这可能应该被认为是这个问题的最终答案：如果字符串没有任何格式说明符，则使用 a `list`（或任何不同于`tuple`或映射的类型）应该简单地被认为是一个错误，它本身会导致未定义的行为。

因此，您应该**始终**使用`tuple`or`dict`作为参数，否则您必须手动检查格式说明符或处理奇怪的行为。

在您的情况下，您可能可以使用`(['string'], )`代替来解决问题`['string']`。

* * *

为什么结果行为似乎如此随机的可能“解释”：

似乎/的原始实现中有一个错误[检查](http://bugs.python.org/issue6396#msg90009)，而不是在[这一](http://hg.python.org/cpython/file/a9341ce35abc/Objects/stringobject.c#l4257)行上使用：`PyString_Format``PyUnicode_Format``PyMappingCheck`

```
if (PyMapping_Check(args) && !PyTuple_Check(args) &&
     !PyObject_TypeCheck(args, &PyBaseString_Type))
    dict = args; 
```

它使用了这个代码：

```
if (Py_TYPE(args)->tp_as_mapping && !PyTuple_Check(args) &&
    !PyObject_TypeCheck(args, &PyBaseString_Type))
    dict = args; 
```

这是不等价的。例如`set`没有`tp_as_mapping`设置（至少在我几周前下载的 Python2.7.3 源代码中），而`list`确实设置了它。

这可能是为什么`list`（可能还有其他对象）不提高`TypeError`while `set`,`int`和许多其他对象的原因。

正如我之前在同一个答案中所说，我确实得到`TypeError`了`list`s：

```
$ python2
Python 2.7.3 (default, Sep 26 2012, 21:53:58) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 'some string' % []
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: not all arguments converted during string formatting 
```

This probably shows that the above issue is not the only one here.

Looking at the source code I agree that, *in theory*, the number of arguments is not checked if the argument is not a tuple, but this would imply `'some string' % 5 -> 'some string'` and not a `TypeError`, so there must be something fishy in that code.

# iphone - SQLite 数据库未更新

> ID：13864534
> 
> 赞同：0
> 
> 时间：2012-12-13T16:48:29.833
> 
> 标签：iphone, objective-c, ios, sqlite

我有一个包含学生实体的数据库：

```
create table student ( name varchar(20) not null,
                       surname varchar(20) not null,
                       studentId integer primary key ); 
```

在我的应用程序委托中，当应用程序启动时，我从数据库中加载所有元组并将它们显示到表视图中。
当应用程序委托接收 applicationWillResignActive 事件时，它将所有元组保存到数据库中。它只保存已添加的元组，不可能编辑元组，所以没关系。
当应用程序委托接收到 applicationWillEnterForeground 事件时，它会从数据库中读取元组。

**问题：**这只适用于应用程序的单次启动。假设我通过 Xcode 启动应用程序，然后输入我添加一个元素并在后台输入。之后我重新激活应用程序，它进入前台并加载成功的所有元组。
但是在应用程序的下一次启动（从 lldb 停止它并再次启动它）时，元组与第一次启动之前相同。

我为学生实体创建了一个包装类，名为 Student，具有以下属性：

```
@property (nonatomic, copy, readwrite) NSString* name;
@property (nonatomic, copy , readwrite) NSString* surname;
@property (nonatomic, strong, readwrite) NSNumber* studentId;
@property (nonatomic, readwrite, getter= isNew) BOOL new; 
```

我检查这些字段不为零，并且不违反实体完整性。
我使用的唯一有意义的方法是：

```
- (NSString*) sqlInsertionString; 
```

它创建插入元组所需的字符串。测试并工作。

这就是我更新数据库的方式：

```
- (void) updateStudents : (NSMutableArray*) students
{
    sqlite3* database;
    sqlite3_stmt* statement;
    BOOL needsFinalize=NO;
    if(!databasePath)
    {
        NSBundle* bundle=[NSBundle mainBundle];
        databasePath= [bundle pathForResource: @"test" ofType: @"db"];
    }
    if(sqlite3_open([databasePath UTF8String], &database)!=SQLITE_OK)
    {
        NSString* problem= [NSString stringWithFormat: @"%s",sqlite3_errmsg(database)];
        @throw [NSException exceptionWithName: @"Failed to open the database" reason: problem userInfo: nil];
    }
    for(Student * s in students)
    {
        if(s.isNew)
        {
            NSString* sqlString= [s sqlInsertionString];
            if(sqlite3_prepare_v2(database, [sqlString UTF8String], -1, &statement, NULL)!= SQLITE_OK)
            {
                @throw [NSException exceptionWithName: @"Problem performing the query" reason: @"Unknown" userInfo: nil];
            }
            if(sqlite3_step(statement)!=SQLITE_DONE)
            {
                @throw [NSException exceptionWithName: @"Problem performing the query" reason: @"Unknown" userInfo:nil];
            }
            sqlite3_reset(statement);
            needsFinalize=YES;
        }
    }
    if(needsFinalize && sqlite3_finalize(statement)!=SQLITE_OK)
    {
        @throw [NSException exceptionWithName: @"Failed to close the statement resource" reason: @"Unknown" userInfo:nil];
    }
    if(sqlite3_close(database)!= SQLITE_OK)
    {
        @throw [NSException exceptionWithName: @"Failed to close the database" reason: @"Unknown" userInfo: nil];
    }
} 
```

但它并没有真正更新，只是在应用程序内部它似乎已更新，但文件始终保持不变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:53:00.223

问题是您正在从捆绑包中打开数据库。您不能对此进行（持久）修改。标准的解决方案是检查`Documents`文件夹中的数据库，如果有，使用它，如果没有，从 bundle 复制到`Documents`然后从`Documents`.

请参阅[无法在 iOS 中连接 SQLite 数据库](https://stackoverflow.com/questions/11664043/unable-to-connect-sqlite-database-in-ios/11674730#11674730)

# iphone - 在 AppDelegate 中使用自定义委托

> ID：13864539
> 
> 赞同：0
> 
> 时间：2012-12-13T16:48:53.447
> 
> 标签：iphone, ios, delegates, appdelegate

我正在尝试在 App Delegate 中添加自定义委托，并且我正在这样做：

```
AppDelegate.h

@protocol AppDelegateDelegate <NSObject>

- (void)finishSync:(BOOL)success;

@end

@interface AppDelegate : UIResponder <UIApplicationDelegate> {

@property (nonatomic, weak) id <AppDelegateDelegate> delegate;

@end 
```

然后我尝试在 UITabViewController 中连接的其他视图中使用这个委托，我这样做是这样的：

```
FirstView.h

#import "AppDelegate.h"

@interface FirstView : UIViewController <AppDelegateDelegate>

@end

FirstView.m

@implementation FirstView

...

- (void)viewDidLoad {
  AppDelegate *appController = (AppDelegate *)[[UIApplication sharedApplication] delegate];
  appController.customDelegate = self;

} 
```

FirstView 工作完美，但例如，如果我切换到具有相同代码来实现委托的 SecondViewController，则委托在 FirstView 中也不再工作......我错了什么？

**编辑：**

我已经尝试了 rdelmar 的答案，但是没有用，现在我可以更好地解释我的情况，我在 UITabBarController 中有 4 个视图，这个视图在应用程序委托的 didfinishloading 方法中加载，然后应用程序在第一个视图中打开，这是视图 ViewDidAppear 的日志，就像您在回答中所做的那样：

```
<FirstView: 0xae10280> 
```

然后我切换到第二个视图，这是代表的 viewdidappear nslog：

```
<SecondView: 0x9f79b10> 
```

然后我切换到thirdView，这是nslog：

```
<ThirdView: 0xba86200> 
```

最后是FourthView：

```
<FourtView: 0xba875b0> 
```

所以似乎所有代表都在所有视图中工作，然后我尝试切换到第一个视图，这是日志：

```
(null) 
```

我切换第三个视图：

```
(null) 
```

第二：

```
(null) 
```

第四个：

```
(null) 
```

没有工作了，所以我停止了应用程序并再次运行它，并从 firstView 开始：

```
<FirstView: 0xad28730> 
```

切换到第二个视图：

```
<SecondView: 0x9f682e0> 
```

在 firstView 中返回：

```
(null) 
```

切换到第二个视图：

```
(null) 
```

切换到第三个视图：

```
<ThirdView: 0xab297e0> 
```

切换到第四视图：

```
<FourthView: 0xab28430> 
```

然后再来看第三个视图：

```
(null) 
```

所以你可以看到问题是第一次工作，然后当返回视图时委托为空，知道吗？

**编辑2：**

我还注意到，如果我在 NavigationController 之间切换视图，则委托永远不会（null），而是像我一样在 UITabBarController 中切换视图，我的代码给出 null ......所以我认为这是 UITabBarController 视图的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:52:35.507

一个对象一次只能有一个委托。尝试在 FirstView 的 viewWillDisappear 方法中将委托设置为 nil，看看是否有帮助。

这对我有用。我将代理的设置移动到第一个控制器中的 viewWillAppear 中，因此如果我从第二个控制器返回它，它将重置。我的控制器在导航控制器中，我使用推送和弹出来来回移动。两个控制器都有相同的代码（日志除外）：

```
#import "ViewController.h"
#import "AppDelegate.h"

@interface ViewController ()
@property (strong,nonatomic) AppDelegate *appController;
@end

@implementation ViewController //This is the first controller

-(void)viewDidAppear:(BOOL)animated {
    self.appController = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    self.appController.customDelegate = self;
    [super viewDidAppear:animated];
    NSLog(@"First says: %@",self.appController.customDelegate);
}

-(void)viewWillDisappear:(BOOL)animated {
    NSLog(@"First viewWillDisappear");
    [super viewWillDisappear:animated];
    self.appController.customDelegate = nil;
}

- (void)finishSync:(BOOL)success {

} 
```

# f# - :?> 在 f# 中是什么意思？

> ID：13864541
> 
> 赞同：1
> 
> 时间：2012-12-13T16:48:55.850
> 
> 标签：f#, piping

鉴于这一行：

```
let win = XamlReader.Parse(xaml) :?> Window 
```

在`:?>`做什么？

我尝试查找三元但没有注意到`:?`，它似乎是用于类型测试？我也知道`>`是管道，但 Window 没有任何构造函数参数。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T16:52:19.117

它是与管道无关的动态转换运算符。我引用[MSDN](http://msdn.microsoft.com/en-us/library/dd233220.aspx)关于向下转换的部分：

> `:?>`操作员执行**动态转换**，这意味着转换的成功是在运行时确定的。`:?>` 在编译时不检查使用运算符的强制转换；但在运行时，会尝试强制转换为指定的类型。如果对象与目标类型兼容，则转换成功。如果对象与目标类型不兼容，则运行时会引发 *InvalidCastException*。

# html - 我什么时候应该使用 Cache-Control: no-cache？

> ID：13864542
> 
> 赞同：2
> 
> 时间：2012-12-13T16:49:02.423
> 
> 标签：html, caching, webpage

W3.org[协议](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.1)说

> 默认情况下，如果请求方法、请求头字段和响应状态的要求表明它是可缓存的，则响应是可缓存的

当他们说“响应”时，这是否意味着一切都在缓存？所以当我使用 Cache-Control: no-cache 会阻止页面缓存吗？这对未来有什么不良影响吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:01:18.943

通常，当旧的（甚至几秒钟的旧！）页面可能过时时，您会希望阻止缓存。您期望页面内容相关的时间越长，缓存效果就越好（并且阻碍的越少）。相反，信息的保质期越短，缓存实际上就越有可能阻碍人们获取最新的内容。

当然，禁止缓存的代价是你没有得到缓存的*好处*。对页面的每次点击都会向您的服务器生成一个请求，即使您只是一直在提供同一个页面。这可能意味着服务器负载的显着增加，而大型站点（或 rinky-dink Web 服务器）会发现这是不可取的。因此，为了回答“缓存还是不缓存？”这个问题，您需要平衡您的带宽和服务器功能（以及您可能最大化它们的意愿）与您拥有绝对最新位的要求。如果你没有这样的要求，那么`no-cache`可能是矫枉过正。

至于*未来*的影响？唯一真正的问题是，在所有缓存副本到期之前，缓存仍在某种程度上进行。一旦发生这种情况，就没有真正的问题。您不会被阻止稍后重新启用缓存。事实上，如果您确实重新启用它，代理会很快看到更改，并在下次有人请求时再次开始缓存页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:51:59.087

> 当他们说“响应”时，这是否意味着一切都在缓存？

请参阅 Paul D. Waite 的评论。

> 所以当我使用 Cache-Control: no-cache 会阻止页面缓存吗？

不，不会的。

来自[Mark Notingham 的缓存教程](http://www.mnot.net/cache_docs/#CACHE-CONTROL)

> *   no-cache — 强制缓存每次在释放缓存副本之前向源服务器提交请求以进行验证。这对于确保尊重身份验证（与 public 结合）或保持严格的新鲜度而不牺牲缓存的所有好处很有用。

如果您根本不想缓存资源，请使用“no-store”。（同上）

> *   no-store — 指示缓存在任何情况下都不要保留表示的副本。

# jquery - 对话框关闭事件未触发

> ID：13864543
> 
> 赞同：0
> 
> 时间：2012-12-13T16:49:10.717
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

这不像我期望的那样工作：

```
$("#generalContactWindow").dialog({
    autoOpen: false,
    draggable: true,
    width: 600, height: 'auto',
    closeOnEscape: true,
    modal: true,
    resizable: false,
    close: function(event, ui) {
        _gaq.push(['_trackEvent', 'DetailsGeneralForm', 'HideForm', document.location.href]); 
        console.log('_trackEvent DetailsGeneralForm HideForm called');
    }
}); 
```

`_gaq.push(['_trackEvent', 'DetailsGeneralForm', 'HideForm', document.location.href]);`如果我单击关闭按钮或按退出键，则该部分将永远不会发生。

关闭链接如下所示：

```
<a class="ui-dialog-titlebar-close" href="#" unselectable="on" style="-moz-user-select: none;"><span unselectable="on" style="-moz-user-select: none;">X</span></a> 
```

我认为这是标准。

这一切的原因是我需要跟踪对话框的打开和关闭。我可以很好地追踪开场，但不是结束。我应该怎么办？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:56:44.387

您需要为关闭按钮设置点击事件

[jsfiddle 示例](http://jsfiddle.net/Cy2B6/)

使用 jQuery[`.on()`](http://api.jquery.com/on/)委托，这将使您的关闭按钮调用 jquery UI 对话框`close`事件

```
$("#generalContactWindow").on('click', '.ui-dialog-titlebar-close', function() {
    $("#generalContactWindow").dialog('close');
});​ 
```

# javascript - 将 image.src 设置为自身会导致 onLoad 触发吗？

> ID：13864545
> 
> 赞同：4
> 
> 时间：2012-12-13T16:49:17.893
> 
> 标签：javascript, dom, javascript-events

我似乎无法找到一个明确的答案来解决这个问题......

假设我有一个对页面上图像的 JavaScript 引用，并且我将一个`load`事件处理程序绑定到该元素。例如，像这样：

* * *

**HTML**

```
<img id="myImage" src="http://example.com/image.jpg" /> 
```

**JavaScript**

```
var $myImage = $('#myImage');
$myImage.load(function() {
    alert('Image loaded!')
}); 
```

* * *

现在，如果我这样做：

```
var imageElem = $myImage[0];
imageElem.src = imageElem.src; // Re-assign the image source path 
```

...*即使图像已经从服务器加载，*`load`事件处理程序也会触发吗？在 Firefox 中似乎可以，但是依赖这种行为是否安全？

 *（我问的原因是我在 jQuery 插件中看到它用于检查所有图像何时加载。如果图像在`load`事件处理程序绑定之前加载，那么它不会触发，除非它使用重新触发上面的方法。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:54:51.523

设置 img.src 应该触发加载，但有一些警告。根据 jQuery 自己[关于 .load 事件的文档](http://api.jquery.com/load-event/)，

> 与图像一起使用时加载事件的注意事项
> 
> 开发人员尝试使用 .load() 快捷方式解决的一个常见挑战是在图像（或图像集合）完全加载时执行一个函数。应该注意几个已知的警告。这些都是：
> 
> *   它不能始终如一地工作，也不能可靠地跨浏览器
> *   如果图像 src 设置为与以前相同的 src，它不会在 WebKit 中正确触发
> *   它没有正确地冒泡 DOM 树
> *   可以停止对已经存在于浏览器缓存中的图像进行触发

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:58:22.393

在 Chrome 检查器中检查了这一点：

```
> img = document.createElement('img')
    <img>​
> img.addEventListener('load', function(e) {console.log('loaded');});
    undefined
> img.src = 'http://placekitten.com/200/300';
    "http://placekitten.com/200/300"
    loaded
> img.src = 'http://placekitten.com/200/300';
    "http://placekitten.com/200/300"
> img.src = 'http://placekitten.com/200/30';
    "http://placekitten.com/200/30"
    loaded 
> img.src = 'http://placekitten.com/200/300';
    "http://placekitten.com/200/300"
    loaded
> img.src = 'http://placekitten.com/200/300';
    "http://placekitten.com/200/300" 
```

因此，要回答有关 Chrome 的问题 - 不，除非您先将 src 设置为其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T06:27:24.903

我也遇到了这个问题，找到了一个简单的解决方案。

您可以通过替换源属性多次触发加载的事件。即使该值等于现有源。您只需添加一个不同的参数，该参数会被服务器忽略。

看看这个例子：

```
var source = "http://example.com/image.jpg";
var imageElement = document.createElement('img');
imageElement.src = source + "?ignorethis=" + new Date().getTime(); // loaded
imageElement.src = source + "?ignorethis=" + new Date().getTime(); // loaded again 
```

我知道，它有点脏，但可以跨浏览器工作。*

# css - 更改 jquery 移动滑块旋转按钮的颜色

> ID：13864547
> 
> 赞同：2
> 
> 时间：2012-12-13T16:49:23.500
> 
> 标签：css, jquery-mobile, input, slider

我正在使用 jquery 移动滑块按钮

```
<input type="range" name="slider" id="slider-0" value="25" min="0" max="100" step="5" /> 
```

滑块会自动生成文本输入，并且在 Chrome 中，它还会在文本输入中放置一个旋转按钮。有人知道如何更改此旋转按钮的颜色吗？

![旋转按钮](../Images/956bbf157496dda57afed29b08b19ed3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:51:34.587

您可以使用不同的[主题](http://jquerymobile.com/demos/1.2.0/docs/api/themes.html)或使用[主题滚轮](http://jquerymobile.com/themeroller/)

![在此处输入图像描述](../Images/993b764729812dbbcdc87471aa55aa0a.png)

[从这里](https://stackoverflow.com/questions/8912660/hiding-the-slider-input-box-in-jquery/8914108#8914108)复制：如果您只想摆脱向上/向下箭头，可以将输入包装在具有指定宽度/高度的元素中，并且`overflow : hidden`：

```
$(".ui-slider-input").wrap($('<div />').css({
    position : 'relative',
    display  : 'inline-block',
    height   : '36px',
    width    : '45px',
    overflow : 'hidden'
})); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:32:22.823

好吧，除非它们是 HTML 元素，否则您不能更改滚动条/旋转按钮的颜色。IE 是一个例外，它允许这样做，但它又不是网络标准，在其他任何地方都不受支持。作为一种解决方法，您可以隐藏浏览器创建的旋转按钮，并将其替换为您自己的自定义旋转按钮，该按钮由 DIV 标记组成，并带有适当的事件处理程序。

# javascript - 用于强制浏览器显示滚动条的 CSS

> ID：13864549
> 
> 赞同：11
> 
> 时间：2012-12-13T16:49:27.993
> 
> 标签：javascript, html, css

我编写了一个 Web 应用程序，发现当我调整页面大小时，浏览器不会在窗口缩小时显示它自己的滚动条。这可以防止用户访问内容。我已将我的正文宽度设置为 500px 并将导航栏设置为`white-space:nowrap`. 如何让浏览器识别屏幕右侧有内容？

只是为了澄清我想要浏览器的滚动条而不是任何控件上的滚动条。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-13T17:01:09.267

您可以使用以下选项之一，具体取决于您是要添加水平滚动条、垂直滚动条还是同时添加两个滚动条：

```
body    {overflow-x:scroll;}
body    {overflow-y:scroll;}
body    {overflow:scroll;} 
```

但是，我认为如果您在一个部分中显示内容然后执行

```
#id-of_your_div {overflow:scroll;} 
```

这样您将滚动添加到 div 而不是强制浏览器显示滚动条，那么您的页面将提供更好的用户体验，因为这样的滚动条更易于用户访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T16:50:15.293

您可以将主体/元素的高度或宽度设置为 100.1%，具体取决于您希望滚动的方向和元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T17:01:02.500

不要使用宽度，而是使用为此目的而设计的代码。无论是否需要，以下 CSS 都会强制显示滚动条。

对于两个滚动条...

```
body {
    overflow: scroll;
} 
```

或仅用于水平滚动条...

```
body {
    overflow-x: scroll;
} 
```

# ruby - 排序和筛选从 Azure 返回的数据

> ID：13864551
> 
> 赞同：0
> 
> 时间：2012-12-13T16:49:31.350
> 
> 标签：ruby, ruby-on-rails-3, azure-storage

我是 RoR 的新手，并试图设置一个列出 Windows Azure 帐户上所有容器/文件的应用程序。使用[waz-storage](https://github.com/johnnyhalife/waz-storage) gem，我可以找到容器和其中的 blob，但我遇到的问题是尝试通过其中一个元数据属性对返回的容器列表进行排序，并根据它们进行过滤用户电子邮件。

使用`container.list`我得到每个容器的列表，如下所示：

```
[#<WAZ::Blobs::Container:0x60295f8 @name="12345">, #<WAZ::Blobs::Container:0x60295b0 @name="23456">, #<WAZ::Blobs::Container:0x6029580 @name="34567">] 
```

每个容器都有自己的元数据，我可以通过调用`@container.metadata`：

```
{:transfer_encoding=>"chunked", :last_modified=>"Thu, 13 Dec 2012 06:01:23 GMT", :etag=>"\"0x8CFA70E6A590AD9\"", :server=>"Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0", :x_ms_request_id=>"a2cbc9ba-9e59-4c27-8a50-c54b405cbb1b", :x_ms_version=>"2011-08-18", :x_ms_meta_customername=>"Sample Name", :x_ms_meta_useremail=>"user@example.com", :date=>"Thu, 13 Dec 2012 16:29:16 GMT"} 
```

在视图中，我想列出每个容器并使用`:x_ms_meta_customername`属性链接到它。我已经在视图中达到了这一点：

```
<% @containerlist.each do |container| %>
    <li><%= link_to container.metadata[:x_ms_meta_customername], root_url(:container => container.name) %></li>
<% end %> 
```

视图中的链接按照上面列表中的值的顺序创建，`container.name`即“12345”、“23456”和“34567”。相反，我希望列表按`:x_ms_meta_customername`.

我尝试了一些不同的方法来对列表进行排序，但最终要么不对其进行排序，要么在将字符串转换为整数时出错。我可能会把这一切都错了。

我想做的另一件事是根据`:x_ms_meta_useremail`属性过滤列表。几乎所有用户都会始终显示整个列表，但有些用户只能访问元数据中包含其电子邮件的容器。

我做了一些搜索，似乎找不到任何有帮助的东西。我有点走到了死胡同。

我想知道的另一件事是，我应该在视图中完成所有这些工作吗？或者将此逻辑移至模型或控制器？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:58:37.387

您可以使用`sort`对记录进行排序。

```
@containerlist.sort {|a, b| a.metadata[:x_ms_meta_useremail] <=> b.metadata[:x_ms_meta_useremail]} 
```

或者更简单：

```
@containerlist.sort_by {|c| c.metadata[:x_ms_meta_useremail]} 
```

要过滤，您可以使用`reject!`.

```
@containerlist.reject! {|c| c.metadata[:x_ms_meta_useremail] != @user.email} 
```

作为一般的经验法则，您应该尝试将逻辑排除在您的视图之外。你还想让你的控制器尽可能的瘦。如果我这样做，我将创建一个可以从控制器调用的服务类。

# python - 如何从 python 的列表中提取某些值？

> ID：13864552
> 
> 赞同：1
> 
> 时间：2012-12-13T16:49:31.710
> 
> 标签：python, list, loops

```
def get_monthly_averages(original_list):

    #print(original_list)
    daily_averages_list = [ ]
    for i in range (0, len(original_list)):  
        month_list = i[0][0:7]
        volume_str = i[5]
        #print(volume_str)
        adj_close_str = i[6]
        #print(adj_close_str)
        daily_averages_tuple = (month_list,volume_str,adj_close_str)
        daily_averages_list.append(daily_averages_tuple.split(','))
    return daily_averages_list 
```

我有一个类似的清单

```
[
 ['2004-08-30', '105.28', '105.49', '102.01', '102.01', '2601000', '102.01'], 
 ['2004-08-27', '108.10', '108.62', '105.69', '106.15', '3109000', '106.15'], 
 ['2004-08-26', '104.95', '107.95', '104.66', '107.91', '3551000', '107.91'], 
 ['2004-08-25', '104.96', '108.00', '103.88', '106.00', '4598900', '106.00'], 
 ['2004-08-24', '111.24', '111.60', '103.57', '104.87', '7631300', '104.87'], 
 ['2004-08-23', '110.75', '113.48', '109.05', '109.40', '9137200', '109.40'], 
 ['2004-08-20', '101.01', '109.08', '100.50', '108.31', '11428600', '108.31'], 
 ['2004-08-19', '100.00', '104.06', '95.96', '100.34', '22351900', '100.34']
] 
```

我试图从“长”列表中的每个列表中提取某些多个值。我需要使用入门 python 技术。例如，到目前为止，我们还没有在课堂上学习 lambda。必须使用入门技巧。

截至目前，使用的行`i[][]`给了我一个类型错误，说'int'不可下标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:52:28.293

你的变量`i`是一个整数。您应该索引`original_list`而不是`i`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:53:30.020

我想你想要

```
month_list = original_list[i][0][0:7]
volume_str = original_list[i][5]
#print(volume_str)
adj_close_str = original_list[i][6] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:55:12.723

不要使用范围来遍历列表。做这个：

```
for datestr, n1, n2, n3, someval, otherval in original_list:
    #do your stuff here 
```

这将遍历 中的每个列表`original_list`，并将每个此类列表的 6 个元素分配给给定的变量。

# c# - 获取队列中的活动线程数和线程

> ID：13864553
> 
> 赞同：0
> 
> 时间：2012-12-13T16:49:36.450
> 
> 标签：c#, multithreading, parallel-processing, threadpool

这是我的应用程序 ImageDT 的快速伪数据表

```
Parallel.ForEach(ImageDT.AsEnumerable(), row =>
{
    if (a1 != a2)
    {
        ThreadPool.QueueUserWorkItem(Foo1, row["foo"])
    }
    else 
    {
        ThreadPool.QueueUserWorkItem(Foo2, row["foo"])
    }
} 
```

我需要知道有多少线程处于活动状态以及有多少线程排队等待并行和线程池。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:40:31.677

跟踪几个共享整数，“Queued”和“Active”。当您对 WorkItem 进行排队时，增加 Queued。当你的回调方法启动时，让它递减 Queued 并递增 Active。当回调退出时，递减 Active。

# aloha-editor - Aloha 编辑器设置 Base url

> ID：13864554
> 
> 赞同：0
> 
> 时间：2012-12-13T16:49:36.830
> 
> 标签：aloha-editor

我想将 aloha.js 文件移出 lib 文件夹。由于这会破坏路径配置，因此我想更改 Aloha.settings 中的 baseUrl：

```
(function (window, undefined) {
    if (window.Aloha === undefined || window.Aloha === null) {
        window.Aloha = {};
    }
    window.Aloha.settings = {
        baseUrl: '/src/lib/',
        plugins: {
            load: ['common/ui', ' common/format', 'common/image', 'extra/ribbon', 'custom/color', 'custom/imageUpload']
        }
    };
})(window); 
```

baseUrl 设置为 /src/lib/，这是 aloha.js 文件最初所在的位置，因此所有路径都应从中计算。

但是现在我收到以下错误：

```
0x800a01b6 - JavaScript runtime error: Object doesn't support property or method 'extendObjects' 
```

并且没有加载任何文件。有任何想法吗？

问候，斯特凡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T15:33:08.100

编辑：Aloha 向上转义一个目录。所以当你这样做时

```
baseUrl: '/src/lib/', 
```

对于插件，它是：

```
'/src/lib/../', 
```

也许这会有所帮助；）

* * *

我认为显示此错误是因为 aloha 正在运行。w jQuery 实例可能存在问题，您是否加载了 1.7.2 以外的其他 jquery？

# node.js - 在 MongoDB 中正确存储 Node.js IM App 对话

> ID：13864560
> 
> 赞同：0
> 
> 时间：2012-12-13T16:49:47.807
> 
> 标签：node.js, mongodb, express, socket.io, chat

我正在开发（又一个）Node、js + Express + Socket.IO Facebook/like Instant Messaging 应用程序。

服务器端基本上是完整的，但我一直在寻找一种存储和检索对话的正确方法，我想我可以试试 MongoDB。

我以前从未使用过 noSQL 数据库，所以我想就如何处理，主要是如何以正确的方式编写一些建议。

我正在考虑创建包含用户聊天和带有时间戳的聊天线的条目，这很简单。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:22:14.190

尽管这并不能完全解决您要构建的应用程序，但 10gen（针对支持 mongodb 的公司）发布了一段演示视频，介绍了如何创建 IRC 聊天服务器。这是一个非常长且非常广泛的演示文稿，应该涵盖与您构建应用程序相关的大部分材料。在我看来，这绝对是您入门的最佳资源。

[http://www.10gen.com/presentations/mongonyc-2012-building-mongodb-power-chat-server](http://www.10gen.com/presentations/mongonyc-2012-building-mongodb-power-chat-server)

希望这可以帮助！

# ruby - Dalli 是否只缓存字符串？（memcache 的新手）

> ID：13864561
> 
> 赞同：0
> 
> 时间：2012-12-13T16:49:51.420
> 
> 标签：ruby, memcached, dalli

如果是这种情况，那么最好将内容存储为 JSON 吗？

我查看了文档，但没有明确承认。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:37:59.093

Dalli 用于`Marshal.dump`序列化值，您可以存储任何可以转储的东西（例如，procs 不能在大多数 ruby​​ 实现上转储。

就我个人而言，我更喜欢只存储数组、哈希、字符串、数字及其组合。

存储任意对象可能效率低下（例如，活动记录对象在其实例变量中具有其属性的多个副本）。

另一个潜在的问题是，如果您存储了一个类的实例，然后又重命名了该类——您将不再能够从缓存中检索该值，因为缓存的数据中仍然有旧的类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:01:15.107

memcache 可以缓存所有可序列化的内容，即使是 Dalli 也可以。

# c++ - 堆栈最终会溢出吗？

> ID：13864567
> 
> 赞同：1
> 
> 时间：2012-12-13T16:50:16.630
> 
> 标签：c++, memory, dynamic, stack-overflow

我已经为此解决方案进行了很多搜索，但完全没有运气。

这是我的程序的基础知识。我的主要功能中有一个循环。循环需要计算大量数据，当我给我的一个变量一个大于 20 的值时，它最终会堆栈溢出。

我知道，无论何时您在函数中“返回”，它都会释放整个堆栈。事情是这样的，我需要这个循环永远运行，直到人们关闭应用程序。

这甚至可能吗？在堆栈溢出发生之前，所有函数都需要很短的生命周期吗？如果我使用动态内存，我仍然无法摆脱它在运行时积累的其他堆栈数据。

基本上，我怎样才能永远运行一个函数而不会导致堆栈溢出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:59:21.487

堆栈的大小是有限的。在某些 Windows 系统上，它是 1 MB。您可以[以编程方式更改堆栈大小](https://stackoverflow.com/questions/743545/how-to-allow-more-memory-and-avoid-stack-overflow-on-lots-of-recursion)，但通常这是一个坏主意。

每个线程都有不同的堆栈。堆栈变量总是在作用域结束时被释放。例如

```
void MyFunction
{ // begin of scope 1
    std::string mouse("feep"); 
    for (int i = 0; i < 10000000; i++)
    { // begin of scope 2
        int x = 1;  // x is on the stack
        std::string cow("moo"); // cow is on stack
      // end of scope 2, cow is destroyed then the stack is freed for cow and x before the next iteration of the loop begins
    } 
    return; // end of scope 1, mouse is destroyed ant the stack is freed for mouse
} 
```

在任何时候，上述代码最多只有`mouse`, `i`, `x`, 和`cow`在堆栈上。如果你使用[递归](http://www.danzig.us/cpp/recursion.html)，你可能会得到一个非常深的堆栈，它会溢出。例如

```
void StackOverflowIncoming()
{ // begin of scope
    int aVariableOnTheStack = 0;
    StackOverflowIncoming();
    // end of scope
} 
```

上面的函数永远打开新的作用域并且永远不会离开作用域，所以在某些时候它会溢出。

另一种溢出堆栈的方法是`alloca`，它直接分配堆栈（然后在分配它的范围关闭时立即释放它。`alloca`如果最大堆栈大小为 1 MB，则只需在堆栈上分配 10 MB。那可以也可以通过在堆栈上分配一个巨大的结构来实现。

```
void InstantStackOverflow()
{
    char buffer[1<<24];
} 
```

有关堆栈上分配过多的更详细示例，请参阅此[问题](https://stackoverflow.com/questions/6219878/stack-overflow-c?rq=1)。

溢出堆栈的最后也是最有创意的方法是破坏程序状态，使程序变得非常混乱并且无法清理堆栈。通常，您通过使用导致未定义行为的语言特性来做到这一点，如下所示：

```
void TryToCorruptTheStack()
{ // begin of scope
    char buffer[1];
    for (int i = -20; i < 20; i++)
        buffer[i] = 5;
    // end of scope
} 
```

有关堆栈损坏的更详细示例，请参阅此[问题](https://stackoverflow.com/questions/3037636/very-strange-stack-overflow-in-c-program?rq=1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:59:19.017

运行函数不会填满堆栈。但是，如果您使用递归函数调用，是的，最终堆栈会溢出。回到你的问题 - 你说你正在主函数中运行一个导致堆栈溢出的循环，然后你说调用函数导致堆栈溢出。除非您在其中创建新对象，否则循环不会导致堆栈溢出！同样，在 C/C++ 中，主函数不能被称为递归。你不是很清楚的朋友。

如果您可以分享一些示例代码，那就太好了。

PS：这很有趣，我们正在谈论stackoverflow上的stackoverflow：P

# visual-studio-2010 - 如何在 Visual Studio 2010 中打开不是团队项目的现有项目

> ID：13864571
> 
> 赞同：0
> 
> 时间：2012-12-13T16:50:21.700
> 
> 标签：visual-studio-2010, tfs

我在机器上安装了一个 Visual Studio 2010 实例。它连接到 Team Foundation Server。我想打开一个不在 Team Foundation Server 上的网站项目，但是我只能打开团队项目或文件。该网站是一个文件夹。

有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:45:32.650

您是否为 Visual Basic 设置了 Visual Studio 默认设置？

[VS2010 - 文件新菜单缺少“新项目”](https://stackoverflow.com/questions/3087034/vs2010-file-new-menu-is-missing-new-project)

# java - 如何让 IzPack 将程序添加到程序和功能

> ID：13864577
> 
> 赞同：4
> 
> 时间：2012-12-13T16:50:35.543
> 
> 标签：java, windows, installation, izpack

我正在使用 IzPack 5.0 beta 11 来打包我的 Java 应用程序。

如何在 Windows 上使用 IzPack 安装程序以作为已安装程序出现在程序和功能中？

**编辑** 我找到了一些关于使用 Izpack 5 [http://docs.codehaus.org/display/IZPACK/registry](http://docs.codehaus.org/display/IZPACK/registry)将东西放入注册表的信息，但我仍然很难理解我所做的文档是模糊的。我只是希望我的程序显示在程序和功能中，并且可以从那里卸载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:13:10.310

所以我找到了这个页面[http://docs.codehaus.org/pages/viewpage.action?pageId=142803064](http://docs.codehaus.org/pages/viewpage.action?pageId=142803064)，Izpack 5 beta 11 的文档有点过时了，但最终我找到了让它在 32 上工作所需的一切-bit installtion 将以下内容添加到我的 install.xml

```
<natives>
   <native type="3rdparty" name="COIOSHelper.dll" stage="both">
   </native>
</natives>

<listeners>
    <listener classname="RegistryInstallerListener" stage="install"/>
    <listener classname="RegistryUninstallerListener" stage="uninstall"/>
</listeners> 
```

对于 64 位：

```
<natives>
   <native type="3rdparty" name="COIOSHelper_x64.dll" stage="both">
   </native>
</natives>

<listeners>
    <listener classname="RegistryInstallerListener" stage="install"/>
    <listener classname="RegistryUninstallerListener" stage="uninstall"/>
</listeners> 
```

具有以下优点：

*   安装后我没有被问到它是否正确安装。
*   它列在程序和功能中
*   它可以从程序和功能中卸载

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T02:53:07.640

替代方案：安装应用程序。使用[Java Web 开始](https://stackoverflow.com/tags/java-web-start/info)。JWS 不仅可以为 Java 应用程序安装桌面图标和开始菜单项。在任何支持它们的平台上（IE“不仅仅是 Windows”），但也将它们放在“程序和功能”对话框中，如下面的“Star Zoom Animation”所示。

![Java 应用程序。 图标和输入](../Images/6bdd2492643aed64033aea6f27480ff8.png)

# batch-file - 执行搜索和文件复制的脚本

> ID：13864579
> 
> 赞同：1
> 
> 时间：2012-12-13T16:50:37.760
> 
> 标签：batch-file, vbscript

我是一个脚本新手。我想知道是否有人会帮助我创建脚本。我正在寻找的脚本是执行查找和移动过程的批处理文件。该查找将在 dicom 文件上搜索文本字符串（例如患者 ID）。此外，查找还需要在子文件夹中进行搜索。此外，要查找的文件扩展名是 .dcm 或 .raw。一旦查找完成并找到包含文本字符串的文件。我想要脚本然后将它找到的文件复制到桌面。对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:07:54.177

```
setlocal enabledelayedexpansion
for /r C:\folder %%a in (*.dcm *.raw) do (
find "yourstring" "%%a"
if !errorlevel!==0 copy "%%a" "%homepath%\Desktop" /y
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:40:33.773

这应该为你做。查看`command /?`命令行中每种命令类型的所有可用选项。

```
echo /?
for /?
find /?
xcopy /?
findstr /?
... 
```

**方法一：（推荐）**

```
:: No delayed expansion needed.
:: Hide command output.
@echo off
:: Set the active directory; where to start the search.
cd "C:\Root"
:: Loop recusively listing only dcm and raw files.
for /r %%A in (*.dcm *.raw) do call :FindMoveTo "patient id" "%%~dpnA" "%UserProfile%\Desktop"
:: Pause the script to review the results.
pause
goto End

:FindMoveTo <Term> <File> <Target>
:: Look for the search term inside the current file. /i means case insensitive.
find /c /i "%~1" "%~2" > nul
:: Copy the file since it contains the search term to the Target directory.
if %ErrorLevel% EQU 0 xcopy "%~2" "%~3\" /c /i /y
goto :eof

:End 
```

**方法 2：（由于[FINDSTR`/s`错误](https://stackoverflow.com/questions/8844868/what-are-the-undocumented-features-and-limitations-of-the-windows-findstr-comman)，不推荐）**

```
@echo off
for /f "usebackq delims=" %%A in (`findstr /s /i /m /c:"patient id" *.dcm`) do xcopy "%%~dpnA" "%UserProfile%\Desktop\" /c /i /y
for /f "usebackq delims=" %%A in (`findstr /s /i /m /c:"patient id" *.raw`) do xcopy "%%~dpnA" "%UserProfile%\Desktop\" /c /i /y
pause 
```

# jquery - 来自外部主题的 Wordpress AJAX 调用 [对于 jQuery 移动/Phonegap 应用程序]

> ID：13864580
> 
> 赞同：0
> 
> 时间：2012-12-13T16:50:43.313
> 
> 标签：jquery, wordpress, cordova, jquery-mobile

我只是第一次使用 jQM 和 Phonegap。对于初学者，我想从 Wordpress 站点加载一些帖子（自定义帖子类型 - 团队成员）并将它们显示在列表中。然后在点击列表项时，我希望它转换到显示整个帖子的视图。

我什至不必在模拟器上部署它，因为它甚至无法在浏览器中运行。

我以为我能够像在 Wordpress 主题中运行它一样调用 jQuery 的 AJAX 函数，但它不起作用......

这是我到目前为止所做的：

*   设置phonegap + jQuery mobile 组合
*   设置 wp admin-ajax 文件的路径
*   创建函数并在我的函数文件中添加 ajax 操作
*   调用 AJAX 函数

    function getTeamMembers() { console.log('获取成员'); $.ajax({ url: ajaxUrl, type: 'POST', data: 'action=get_team_members', 成功: function( response ) { console.log( 'get em' ); console.log( response ); } }) ; }

functions.php 中的函数只是回显一个简单的字符串并退出。

响应在 Firebug 控制台中显示为红色，代码为 200 OK，并且响应为空。'got em' 字符串根本没有出现，所以我假设请求不成功。Chrome 甚至不会运行它，因为 AJAX 调用是对另一台服务器的。

所以基本上我要问的是..有没有办法以某种方式使用相同的ajax调用并使用主题外部的functions.php文件从Wordpress页面检索数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:20:44.767

知道了 ！

就像添加一样简单

```
header('Access-Control-Allow-Origin: *'); 
```

到由 AJAX 调用的函数的开头。

美丽的。

# haskell - Windows 7 上的 Haskell Yesod：启动开发服务器时出现“yesod devel”问题

> ID：13864581
> 
> 赞同：3
> 
> 时间：2012-12-13T16:50:54.077
> 
> 标签：haskell, yesod

我对 Haskell 很陌生，目前正在使用 Windows 7 操作系统。

我正在尝试使用 Haskell 框架 Yesod 开发 Web 服务。当我执行`yesod devel`命令启动开发服务器时，出现以下错误：

```
C:\Users\Sticky\workspace\Yesod\testYesod>yesod devel 
Yesod devel server. Press ENTER to quit
Resolving dependencies...
Configuring testYesod-0.0.0...
cabal: At least the following dependencies are missing:
data-default -any,
hamlet ==1.1.*,
hjsmin ==0.1.*,
http-conduit >=1.5 && <1.7,
monad-control ==0.3.*,
persistent ==1.0.*,
persistent-sqlite ==1.0.*,
shakespeare-css ==1.0.*,
shakespeare-js ==1.0.*,
shakespeare-text ==1.0.*,
wai-extra ==1.3.*,
warp ==1.3.*,
yaml ==0.8.*,
yesod ==1.1.*,
yesod-auth ==1.1.*,
yesod-core >=1.1.2 && <1.2,
yesod-default ==1.1.*,
yesod-form ==1.1.*,
yesod-static ==1.1.*,
yesod-test ==0.3.*
Rebuilding application...
Forcing recompile for .\Model.hs because of config/models
Forcing recompile for .\Foundation.hs because of config/routes
Forcing recompile for .\Foundation.hs because of messages/en.msg
Forcing recompile for .\Foundation.hs because of templates/default-layout-wrappe
r.hamlet
Forcing recompile for .\Foundation.hs because of templates/default-layout.hamlet

Forcing recompile for .\Handler\Home.hs because of templates/homepage.hamlet
cabal: Run the 'configure' command fBuild failure, pausing...
irst. 
```

我试过跑步`cabal configure`，这似乎执行得很好，尽管我觉得由于我的经验不足而遗漏了一些东西，任何方向都将不胜感激。我还没有找到任何相关的问题，但这很可能是因为我不知道我需要知道什么:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:53:53.623

看起来您的项目的依赖项没有安装。在您的项目目录中运行以下命令：

```
# alex at least, possibly also happy, are required by hjsmin
cabal install happy alex 
# Make sure alex is on your path, then
cabal install --only-dependencies 
```

# io - Java 虚拟机如何处理 I/O 操作？

> ID：13864587
> 
> 赞同：5
> 
> 时间：2012-12-13T16:51:05.980
> 
> 标签：io, jvm, java

我正在查看[Java 字节码指令](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings "Java 字节码指令列表 - 维基百科，免费的百科全书")列表，发现没有任何 I/O 指令。这让我很感兴趣。`System.out.println`JVM不支持 I/O 指令时如何执行方法？

如果它使用某种形式的内存映射 I/O，那么它如何与操作系统通信以读取文件描述符等？JVM 是否实现了自己的抽象层来处理 I/O 操作？Java I/O 包（java.io 和 java.nio）是用 C/C++ 实现的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T16:53:10.790

如果您查看库源代码，您会发现所有与低级 API（OS 等）的接口都是使用本机代码完成的。

例如，采取`FileOutputStream`：

```
/**
 * Opens a file, with the specified name, for writing.
 * @param name name of file to be opened
 */
private native void open(String name) throws FileNotFoundException;

/**
 * Writes the specified byte to this file output stream. Implements
 * the <code>write</code> method of <code>OutputStream</code>.
 *
 * @param      b   the byte to be written.
 * @exception  IOException  if an I/O error occurs.
 */
public native void write(int b) throws IOException;

/**
 * Writes a sub array as a sequence of bytes.
 * @param b the data to be written
 * @param off the start offset in the data
 * @param len the number of bytes that are written
 * @exception IOException If an I/O error has occurred.
 */
private native void writeBytes(byte b[], int off, int len) throws IOException; 
```

然后是相应的 C 文件（通常是特定于操作系统的）。

# android - 在 Android 上下载和解析 JSON

> ID：13864588
> 
> 赞同：0
> 
> 时间：2012-12-13T16:51:09.703
> 
> 标签：android, json

我只是想问一下使用HTTP get将其转换为android代码的正确方法是什么。

基本上我需要登录网站并进行一些特定的搜索...

这是我遇到问题的实际代码：

```
curl -H "Content-type: application/json" --basic --user "username:passowrd" -X GET -G \
--data-urlencode "status=triggered" \
--data-urlencode "assigned_to_user="\
"https://yourdomain.pagerduty.com/api/v1/incidents" 
```

我不确定我是否可以使用 put..

例子：

```
object.put("--data-urlencode", status=triggered) 
```

还有用户名和密码我不确定我是否也可以做这样的事情

```
object.put("username", "romel");
object.put("password", "passwd"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-12T16:52:49.837

如果您遇到 HTTP 基本身份验证问题，请尝试使用此代码设置您的用户名和密码...

```
HttpURLConnection con;
String basicAuthUsername = "username";
String basicAuthPassword = "passowrd"; //do you have a typo here??
try {
    URL url = new URL(urlString);  
    con = (HttpURLConnection)url.openConnection();

    if (basicAuthUsername != null && basicAuthPassword != null) {
        String userAndPass = new StringBuilder(basicAuthUsername).append(":").append(basicAuthPassword).toString();
        con.setRequestProperty("Authorization", "Basic " + Base64.encodeToString(userAndPass.getBytes(), Base64.NO_WRAP));
    }

    //con.setRequestMethod("POST");
    con.setRequestMethod("GET");

    con.setUseCaches(false);

    int responseCode = con.getResponseCode();

    //etc...
}
finally {
        //close con, etc.
} 
```

...另外，也许你输错了密码？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:58:35.187

您的问题不是太详细，所以我完全确定您在寻找什么 - 它是身份验证问题还是一般的 JSON？

在 Android 中处理 JSON 在一些地方得到了很好的介绍，包括[Vogella 的教程](http://www.vogella.com/articles/AndroidJSON/article.html)。

编写 JSON 非常简单，如 Vogella 的示例所示：

```
public void writeJSON() { 

 JSONObject object = new JSONObject();
 try {
    object.put("name", "Jack Hack");
    object.put("score", new Integer(200));
    object.put("current", new Double(152.32));
    object.put("nickname", "Hacker");
  } catch (JSONException e) {
    e.printStackTrace();
  }
  System.out.println(object);
} 
```

内容类型之类的标头也很容易添加到您的 HTTPGet 对象上，例如：

```
HttpGet httpGet = new HttpGet(API_URL);
        httpGet.setHeader("Accept", "application/json");
        httpGet.setHeader("Content-type", "application/json"); 
```

这些只是片段，使用上面链接的教程可以获得更好、更全面的解释。希望这可以帮助。

# php - 从表名中获取实体类名

> ID：13864590
> 
> 赞同：6
> 
> 时间：2012-12-13T16:51:13.627
> 
> 标签：php, doctrine, doctrine-orm

我想做从实体获取表名的相反操作：

**我想从表名中获取实体名称**，即映射到该表的实体的名称。

db 列也是如此：如何获取映射到它的实体的字段名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T08:49:51.537

这是我能够做的，虽然它不是最佳的，因为它会遍历所有注册的实体类名称：

```
/**
 * @param \Doctrine\ORM\EntityManager $em Entity manager
 * @param string $table Table name
 * @return string Entity class name, null if not found
 */
protected function getClassNameFromTableName($em, $table)
{
    // Go through all the classes
    $classNames = $em->getConfiguration()->getMetadataDriverImpl()->getAllClassNames();
    foreach ($classNames as $className) {
        $classMetaData = $em->getClassMetadata($className);
        if ($table == $classMetaData->getTableName()) {
            return $classMetaData->getName();
        }
    }
    return null;
}

/**
 * @param \Doctrine\ORM\EntityManager $em Entity manager
 * @param string $className
 * @param string $column
 * @return string Field name, null if not found
 */
protected function getFieldNameFromColumnName($em, $className, $column)
{
    $classMetaData = $em->getClassMetadata($className);
    if ($classMetaData) {
        return $classMetaData->getFieldForColumn($column);
    }
    return null;
} 
```

# ruby-on-rails - Compass：为什么我需要进行双重导入才能正常工作？

> ID：13864591
> 
> 赞同：1
> 
> 时间：2012-12-13T16:51:21.543
> 
> 标签：ruby-on-rails, compass-sass

使用 Rails 3.2，指南针导轨。

我有以下文件：

**屏幕.css.scss**

```
@import "compass"; 
```

**应用程序.css.scss**

```
/*
 *= require_self
 *= require_tree .
*/

@import "screen";

.content {
  background-color: #eee;
  padding: 20px;
  margin: 0 -20px; 
  @include border-radius(6px, 6px);
  @include box-shadow(0,0,0,.15);
} 
```

**application.html.erb**（布局，只是相关行）：

```
<%= stylesheet_link_tag "application", :media => "all" %> 
```

这适用于我的应用程序布局。

接下来，对于我要设置样式（主页）的特定页面，我有**home.css.scss**：

```
@import url(http://fonts.googleapis.com/css?family=Oleo+Script+Swash+Caps:700);

@import "compass/css3/text-shadow"; <<-- This is the line I don't understand

.welcome {
  text-align: center;
  h1 {
    font-family: 'Oleo Script Swash Caps', cursive;
    font-weight: 700;
    font-size: 110pt;
    line-height: 130px;
    @include single-text-shadow;
  }
 } 
```

一旦我 drop `@import "compass/css3/text-shadow";`，我的代码就会中断`Undefined mixin 'single-text-shadow'.`如果我将 text-shadow 导入行移动到 application.css.css 中，也会发生同样的事情。

我的问题是**为什么？**我已经通过 screen.css.scss 将整个指南针框架包含在 application.css.css 中。肯定会加载该文件，因为我看到它可以正常工作。那么为什么我需要像这样进行双重包含呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T03:01:31.417

除非`home.css.scss`正在 importing `application.css.scss`，否则这对于预期的行为是有意义的。您只需要在每个编译的文档中导入一次它，它将可用于该文档中包含的任何部分（并且在您的代码中导入之后）。

通常将 Compass 一次导入到`_base.scss`局部（以及您希望可用的任何其他插件）中，然后将该局部导入到您需要基本设置的任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:55:38.790

我不知道我是否正确理解了您的问题，但这里没有双重导入。

指南针是一个模块化框架。你不会被迫使用它的所有部分。相反，您可以只包含您想要的部分。为简单起见，您还可以要求以下子部分：

```
# application.sass
@import "compass"
@import "compass/css3/"
@import "compass/utilities/" 
```

# algorithm - 初始化二维矩阵的时间复杂度是多少？

> ID：13864597
> 
> 赞同：2
> 
> 时间：2012-12-13T16:51:54.590
> 
> 标签：algorithm, matrix, complexity-theory, time-complexity, multidimensional-array

我想将矩阵初始化为所有 0 值。复杂度是 O(1) 还是 O(n)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T00:04:39.293

事实上，如果初始化复杂度是一个问题，并且进一步的矩阵访问是有序的，你可以：

1.  有一个额外的数据结构来跟踪什么矩阵元素（行或列甚至单元格）被初始化；
2.  仅在您访问它们时才延迟初始化元素。

这种方法在矩阵初始化中可能不会比在进一步处理中更复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:54:27.793

这取决于它的含义`N`

*   如果`N`是方阵的行数和列数，则复杂度为`O(N^2)`
*   如果`N`是矩阵中元素的总数（即`N = R*C`是`R`行`C`数， 是列数），那么复杂度是`O(N)`。

# mongodb - MongoDB 的复制集

> ID：13864598
> 
> 赞同：0
> 
> 时间：2012-12-13T16:51:55.960
> 
> 标签：mongodb, azure

我正在尝试按照说明为使用 Azure 的 MongoDB 数据库设置复制集。原始说明位于[http://www.mongodb.org/display/DOCS/MongoDB+on+Azure+VM+-+Linux+Tutorial](http://www.mongodb.org/display/DOCS/MongoDB+on+Azure+VM+-+Linux+Tutorial)。我将脚本解释器与“mongo --host bsicentos.cloudapp.net --port 27018”连接（有些指令没有告诉我）。最后一步指示我输入：

```
 > conf = {
      id = “mongors”,
       members : [
           \{id:0, host:”mongodbrs.cloudapp.net:27018\},
           \{id:0, host:”mongodbrs.cloudapp.net:27019\},
           \{id:0, host:”mongodbrs.cloudapp.net:27020\}]}
  >rs.initiate(conf) 
```

如果我没有完全按照指定的方式键入它并且我稍微修改它以适合我的主机（缺少右引号，而不是转义，并且 id 编号全为零）我最终得到一个接受的命令：

```
mongors:PRIMARY> conf = {
... _id:"mongors",
... members:[
... {_id:0,host:"bsicentos.cloudapp.net:27018"},
... {_id:1,host:"bsicentos.cloudapp.net:27019"},
... {_id:2,host:"bsicentos.cloudapp.net:27020"}]}
{
        "_id" : "mongors",
        "members" : [
                {
                        "_id" : 0,
                        "host" : "bsicentos.cloudapp.net:27018"
                },
                {
                        "_id" : 1,
                        "host" : "bsicentos.cloudapp.net:27019"
                },
                {
                        "_id" : 2,
                        "host" : "bsicentos.cloudapp.net:27020"
                }
        ]
} 
```

但我得到了错误：

```
mongors:PRIMARY> rs.initiate(conf)
{
        "info" : "try querying local.system.replset to see current configuration",
        "errmsg" : "already initialized",
        "ok" : 0
} 
```

想法？

# jaxb - 使用工厂方法检索一个值时从 JAXB 创建 xml

> ID：13864600
> 
> 赞同：2
> 
> 时间：2012-12-13T16:52:11.187
> 
> 标签：jaxb

我有一个 UUID 类，我从静态工厂方法中获取 uuid，例如 UUIDGenerator.getInstance().getUuid();

我有另一个将这些 UUid 作为列表的类。

```
 class Artifact
    {
      Uuid uuid;
      setUuid(Uuid uuid)
      { 
        this.uuid = uuid;
      }

      Uuid getUuid()
      {
        return this.uuid;
       }
    }

Class ArtifactData
{
  private  List<Artifact> artifacts;
   //setter for list
  // getter for list

} 
```

我希望将 xml 创建为

```
<ArtifactData>
<AssociatedArtifactList>
<ArtifactUuid>#some value<ArtifactUuid>
</AssociatedArtifactList>
</ArtifactData> 
```

如何使用 Jaxb 注释创建此 xml。它抱怨说 Uuid 没有公共构造函数，因为它是由工厂方法构造的。

编辑：无法修改 Uuid 和 Uuid 生成器。它们在一个 JAR 中。这是我迄今为止尝试过的

```
public class Artifact
{
    @XmlJavaTypeAdapter(ArtifactUuidAdapter.class)
    private Uuid uuid;

    public Uuid getUuid()
    {
        return uuid;
    }

    public void setUuid(Uuid uuid)
    {
        this.uuid = uuid;
    }

}

@XmlRootElement
public class ArtifactData
{
    private List<Artifact> associatedArtifactList;
    public List<Artifact> getArtifacts()
    {
        return associatedArtifactList;
    }

    @XmlElementWrapper(name="associatedArtifactList")
    @XmlElement(name = "artifactUuid")
    public void setArtifacts(List<Artifact> artifacts)
    {
        this.associatedArtifactList = artifacts;
    }
}

public class ArtifactUuidAdapter extends XmlAdapter<Uuid, String>
{
    @Override
    public Uuid marshal(String uuid) throws Exception
    {
        return Uuid.getInstance(uuid);
    }

    @Override
    public String unmarshal(Uuid uuid) throws Exception
    {
        return uuid.getData();
    }
} 
```

我仍然收到一个错误，称为 no arg default constructor is missing。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:53:59.287

`@XmlType`注解允许您配置工厂类和方法。您的问题中描述的工厂类并不完全符合 API 要求，但您可以轻松地为其创建适配器。

**UUIDGeneratorAdapter**

下面的类将使您的工厂类适应 JAXB (JSR-222) 实现可以利用的东西。

```
public class UUIDGeneratorAdapter {

    public static Uuid getUuid() {
        return UUIDGenerator.getInstance().getUuid();
    }

} 
```

**用户界面**

下面是一个如何通过`@XmlType`注解配置工厂类的示例。

```
import javax.xml.bind.annotation.XmlType;

@XmlType(factoryClass=UUIDGeneratorWrapper.class, factoryMethod="getUuid")
public class Uuid {

    // ...

} 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/06/jaxb-and-factory-methods.html](http://blog.bdoughan.com/2011/06/jaxb-and-factory-methods.html)

# vb.net - 使用没有命名空间规范或导入的类型

> ID：13864603
> 
> 赞同：0
> 
> 时间：2012-12-13T16:52:20.700
> 
> 标签：vb.net, visual-studio-2010

我知道这不是很干净，但我现在看到它是可能的。我没有导入 System.Web.UI.WebControls。我所拥有的只是对 System.Web 的引用。类型是这样使用的：

```
 Private plhZoneContexte As PlaceHolder 
```

PlaceHolder 在 System.Web.UI.WebControls 下，所以如果没有导入，我应该像这样添加前缀：

```
 Private plhZoneContexte As System.Web.UI.WebControls.PlaceHolder 
```

问题是我不能在这种情况下使用导入或前缀。我不允许做这种修改。这是应用程序以前的工作方式，也是新版本应该工作的方式。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:01:09.803

您可以在项目属性中导入命名空间。这将消除添加导入或前缀的必要性。

![VB.NET 项目的项目属性](../Images/81bae8e73c3a8f9f04adab4dcc7e7df2.png)

# c++ - SetWindowsHookEx 没有调用我的回调？

> ID：13864604
> 
> 赞同：1
> 
> 时间：2012-12-13T16:52:27.383
> 
> 标签：c++, winapi, hook, keyboard-hook

好吧，我尝试了不同的解决方案来解决我的问题，但它不起作用。

我调用 SetWindowsHookExA ，然后当我按下一个键时，没有显示消息框。该怎么办？

这是我的代码（这是一个由程序加载的另一个 DLL 加载的 DLL）：

```
#include <Windows.h>

HINSTANCE gl_hThisInstance = NULL;
HHOOK hHook = NULL;

LRESULT CALLBACK KeyHit(int code,WPARAM wParam,LPARAM lParam);

BOOL APIENTRY DllMain( HANDLE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved)
{
    switch (ul_reason_for_call)
    {
        case DLL_PROCESS_ATTACH:
         gl_hThisInstance = (HINSTANCE)hModule;
         hHook = SetWindowsHookExA(
            WH_KEYBOARD,
            KeyHit,
            //(HWND)gl_hThisInstance//not working
            0,//not working
            //(DWORD)gl_hThisInstance//not working
            //GetCurrentThreadId()//even not working with this
            0//not working
            );
        break;
    }
    return TRUE;
}

LRESULT CALLBACK KeyHit(int code,WPARAM wParam,LPARAM lParam)
{
    MessageBox(0,"PRESSED","PRESSED",0);
    return CallNextHookEx(hHook,code,wParam,lParam);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-15T14:45:20.903

我之前遇到过挂钩问题。不是真正的问题，但我这样做的方式不应该。首先，您应该有 2 个从 DLL 导出的函数，`SetHook`并且`RemoveHook`. 该`SetHook`函数`SetWindowsHookEx()`将从那里调用。如果您尝试`SetWindowsHookEx()`在线程或`DLLMain`DLL 中调用 from，该函数不会返回错误，但永远不会调用回调函数。有时我需要弄清楚。

此处发布的是我要捕获的工作代码`WH_GETMESSAGE`，您可以从此处参考。

这是我从 DLL 导出的 SetHook() 函数。

```
bool __declspec(dllexport) __stdcall SetHook(DWORD myWnd)
{
    mySavedHook = SetWindowsHookEx(WH_GETMESSAGE,
        GetMsgProc,
        infoContainer.DllHModule,
        myWnd);

    int errorID = GetLastError();
    if (errorID != 0)
    {
        MessageBoxA(NULL, "Failed to implement hook", "Failed", 0);
        MessageBoxA(NULL, to_string(errorID).c_str(), "Error ID", 0);
        return false;
    }
    else
    {
        return true;
    }
} 
```

`infoContainer.DllHModule`: DLL 的实例，它是`DllMain()`. `myWnd:`是我的线程 ID（不是进程 ID）- 从`GetWindowThreadProcessId(window_handle, NULL)`. 要实现全局挂钩，请使用 0 作为`myWnd`.

这是我的回调函数。

```
LRESULT CALLBACK GetMsgProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode >= 0)
    {
        LPMSG msg = (LPMSG)lParam;
        if (msg->message == WM_CALLFUNCTION)
        {
            MessageBoxA(NULL, "Receive WM_CALLFUNTION", "Good news", 0);
        }

    }
    //Doesn't matter, just call this function and return it.
    return CallNextHookEx(_hook, nCode, wParam, lParam);
} 
```

回调函数必须有`CALLBACK`关键字才能工作。

从外部应用程序中，`SetHook()`从 DLL 调用 并使用线程 ID 作为其参数。

# python - 在python中获取MAC地址并附加到字符串

> ID：13864608
> 
> 赞同：4
> 
> 时间：2012-12-13T16:52:37.990
> 
> 标签：python, python-2.7

如何以以下形式在python中获取我的mac地址：\x##\x##\x##\x##\x##\x##？
我正在尝试构建一个以太网标头并自动生成源硬件地址。

我正在使用`uuid.getnode()`将 mac 地址作为 48 位整数获取。如何转换它以便可以将其附加到已经采用该格式的字符串？
IE：`eth_header = "\xff\xff\xff\xff\xff\xff" + magicconvert(uuid.getnode())`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:23:22.577

用户[nneonneo](https://stackoverflow.com/questions/12404622/python-get-normal-hex-format-for-mac-adress)在 9 月 13 日回答了这个问题。归功于他：

```
 '-'.join('%02X' % ((uuid.getnode() >> 8*i) & 0xff) for i in reversed(xrange(6))) 
```

编辑它以提供您想要的格式的字符串。

我还想借此机会说明“uuid.getnode()”很可能会返回一个随机值，或者它可能会获取系统上任何随机网络接口的 MAC 地址。据我所知，真的没有办法知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:14:27.987

我敢肯定有很多方法，这个怎么样：

```
import uuid
hdr="\xff"*6
mac=uuid.getnode()
txt="%012X"%mac
as_b=[int("".join(x),16) for x in map(None,*(txt[::2],txt[1::2]))]
as_s="".join(chr(b) for b in as_b)
out=hdr+as_s 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:26:36.710

```
from itertools import izip
import uuid

token = "\\x"
mac_address = "%012x" % uuid.getnode()
iter_mac_address = iter(mac_address)
"%s%s" % (token, token.join(a+b for a, b in izip(iter_mac_address, iter_mac_address))) 
```

# nhibernate - NHibernate 一对一外键 ON DELETE CASCADE

> ID：13864610
> 
> 赞同：2
> 
> 时间：2012-12-13T16:52:40.690
> 
> 标签：nhibernate, fluent-nhibernate

我需要使用流畅的 NHibernate 实现 Project 和 ProjecSettings 之间的一对一关联：

```
public class ProjectMap : ClassMap<Project>
{
   public ProjectMap()
   {
      Id(x => x.Id)
        .UniqueKey(MapUtils.Col<Project>(x => x.Id))
        .GeneratedBy.HiLo("NHHiLoIdentity", "NextHiValue", "1000",
           string.Format("[EntityName] = '[{0}]'", MapUtils.Table<Project>()))
        .Not.Nullable();

      HasOne(x => x.ProjectSettings)
        .PropertyRef(x => x.Project);
    }
}

public class ProjectSettingsMap : ClassMap<ProjectSettings>
{

    public ProjectSettingsMap()
    {

      Id(x => x.Id)
        .UniqueKey(MapUtils.Col<ProjectSettings>(x => x.Id))
        .GeneratedBy.HiLo("NHHiLoIdentity", "NextHiValue", "1000",
          string.Format("[EntityName] = '[{0}]'", MapUtils.Table<ProjectSettings>()));

      References(x => x.Project)
        .Column(MapUtils.Ref<ProjectSettings, Project>(p => p.Project, p => p.Id))
        .Unique()
        .Not.Nullable();
    }
} 
```

这将导致以下用于项目设置的 sql：

```
CREATE TABLE ProjectSettings (
  Id                       bigint PRIMARY KEY NOT NULL,
  Project_Project_Id       bigint NOT NULL UNIQUE,
  /* Foreign keys */
  FOREIGN KEY (Project_Project_Id)
    REFERENCES Project()
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
); 
```

我想要实现的是为 FOREIGN KEY (Project_Project_Id) 设置 ON DELETE CASCADE，这样当通过 sql 查询删除项目时，它的设置也会被删除。我怎样才能做到这一点？

**编辑**：我知道 Cascade.Delete() 选项，但这不是我需要的。有什么方法可以拦截 FK 语句的生成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:57:59.530

Fluent-NHibernate 似乎无法做到这一点。

你可以这样做 ：

```
HasOne(x => x.ProjectSettings).PropertyRef(x => x.Project).Cascade.Delete(); 
```

这将按预期工作，但 DDL 不会改变，FNH 将以编程方式处理级联，而不是使用 DB 引擎。

# php - 使用 php 和 mysql 的在线测验（单选按钮）

> ID：13864617
> 
> 赞同：-3
> 
> 时间：2012-12-13T16:52:55.603
> 
> 标签：php, mysql

请帮忙，我正在开发一个在线测验应用程序。所有的问题和答案都将从数据库中选择。我遇到的问题是从单选按钮中获取值，无论是否选中。下面是从数据库生成问题和答案的代码。

```
if (!isset($_POST['submit'])) {
    echo "<form method=post action='#'>";
    echo "<table border=0>";
    while ($row = mysql_fetch_array($display)) {
        $id = $row["id"];
        $question = $row["question"];
        $opt1 = $row["ans1"];
        $opt2 = $row["ans2"];
        $opt3 = $row["ans3"];
        $opt4 = $row["ans4"];
        $opt5 = $row["ans5"];
        $answer = $row["ans"];
        echo "<tr><td colspan=3><br><b>$question</b></td></tr>";
        echo "<tr><td>$opt1 <input type=radio name=q$id value=\"$opt1\"></td><td>$opt2     <input type=radio name=q$id value=\"$opt2\"></td><td>$opt3 <input type=radio name=q$id value=\"$opt3\"></td><td>$opt4 <input type=radio name=q$id value=\"$opt4\"></td><td>$opt5 <input type=radio name=q$id value=\"$opt5\">q$id</td></tr>";
    }
    echo "</table>";
    echo "<input type='submit' value='See how you did' name='submit'>";
    echo "</form>";
} 
```

单选按钮的名称是

```
<input type='radio' name='q$id' value='$opt4' /> 
```

如何获取选中的单选按钮的值？还是我的 PHP 代码错了？如果选中单选按钮，我需要输出选择的内容。

```
if(isset($_POST['submit']))
{
    $value = $_POST[''];//the value of the radio button, i don't know what to put here
    $n = count($value);
   for($i=0; $i < $n; $i++)
   {
     echo $value[$i];
   } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:23:22.573

尝试：

```
if(isset($_POST['submit']))
{
    $value = $_POST;//the value of the radio button, i don't know what to put here
    $n = count($value);
   for($i=0; $i < $n; $i++)
   {
     echo $value[$i];
   } 
} 
```

$_POST[''] 错误。您只需要使用 $_POST。

你也可以在这里使用 foreach：

```
if(isset($_POST['submit']))
{
    $values = $_POST;//the value of the radio button, i don't know what to put here

   foreach($values as $value)
   {
     echo $value;
   } 
} 
```

$_POST 只是一个包含您提交的表单的数组。如果您有一个名称文本字段，您将使用：

```
echo $_POST['name']; 
```

回应它。

尝试

```
var_dump("<PRE>", $_POST); 
```

您将确切地看到您的表单是如何组织的。链接到[文档](http://www.w3schools.com/php/php_post.asp)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T22:34:14.830

感谢您的答复。我能够拿出这段代码并且它可以工作，但我不知道我解决它的结构或方式是否合适或足够好。

```
 <?php
 if (!isset($_POST['submit'])) {
 echo "<form method=post action='#'>";
 echo "<table border=0>";
 while ($row = mysql_fetch_array($display)) {
    $id = $row["id"];
    $question = $row["question"];
    $opt1 = $row["ans1"];
    $opt2 = $row["ans2"];
    $opt3 = $row["ans3"];
    $opt4 = $row["ans4"];
    $opt5 = $row["ans5"];
    $answer = $row["ans"];
    echo "<tr><td colspan=3><br><b>$question</b></td></tr>";
    echo "<tr><td><input type=radio name=$id value=\"$id $opt1\">$opt1 </td><td><input type=radio name=$id value=\"$id $opt2\">$opt2 </td><td><input type=radio name=$id value=\"$id $opt3\">$opt3 </td><td><input type=radio name=$id value=\"$id $opt4\">$opt4 </td><td><input type=radio name=$id value=\"$id $opt5\">$opt5 <br>";
}
echo "</table>";
echo "<input type='submit' value='See how you did' name='submit'>";
echo "</form>";
}
?> 
```

我所做的是将问题的 id 包含在单选按钮的值中

```
<input type=radio name=$id value=\"$id $opt1\"> 
```

我按照建议使用 $_POST 收集单选按钮的值，然后将值分解为两个数组，因此第一个数组将包含问题 id，第二个数组将包含单选按钮的实际值（答案）。

```
<?php
elseif (isset($_POST['submit']))
{
 var_dump("<PRE>", $_POST);
 $sd = $_POST;
    foreach($sd as $sd)
    {
        $tok = explode(" ", $sd, 2);
        $w = mysql_query("select * from `questions` WHERE `id` = '$tok[0]'")or die(mysql_error());
        if(mysql_num_rows($w) == 1)
        {
            $sf = mysql_fetch_object($w);
            echo $tok[1].".......".$sf->ans."<br>";
        }
    }
}
?> 
```

它工作得很好，但它会产生有效的结果吗？

# spring - 使用 Spring MVC 将非 www URL 重定向到 www URL

> ID：13864619
> 
> 赞同：2
> 
> 时间：2012-12-13T16:53:00.830
> 
> 标签：spring, redirect, spring-mvc, tuckey-urlrewrite-filter

我想将所有非 www 请求重定向到我的域（例如[http://domainname.com](http://domainname.com)到[http://www.domainname.com](http://www.domainname.com)）。

我知道我可以使用[Tuckey UrlRewriteFilter](http://www.tuckey.org/urlrewrite/)但我想知道在 Spring MVC 中是否有内置的方法？

请指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T09:52:50.263

基于 Spring MVC 的应用程序只能访问应用程序根目录，并且可以处理根目录之后的 URL，例如 /myapp、/myapp/dashboard 等

要在请求中更新域名，您必须使用 Servlet API（过滤器）进行配置，或者使用您提到的 Tuckey UrlRewriteFilter。

我会建议你做这个服务器级别。如果您使用 Apache 作为您的主要 http 服务器，则可以使用 .htaccess 规则完成重定向：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^viralpatel\.net$
RewriteRule (.*) http://www.viralpatel.net/$1 [R=301,L] 
```

上述规则将viralpatel.net 重定向到www.viralpatel.net

参考：[.htaccess 提示/技巧](http://viralpatel.net/blogs/21-very-useful-htaccess-tips-tricks/)

# android-ndk - CROSS_COMPILE 错误：arm-android-eabi-gcc：找不到命令

> ID：13864620
> 
> 赞同：1
> 
> 时间：2012-12-13T16:53:03.450
> 
> 标签：android-ndk, makefile, cross-compiling, ubuntu-11.04

当我尝试这个命令时 $ make ARCH=arm CROSS_COMPILE=/home/prebuilt/linux-x86/toolchain/arm-eabi-4.4.0/bin/arm-android-eabi-uImage

它向我显示此错误消息

制作：/home/prebuilt/linux-x86/toolchain/arm-eabi-4.4.0/bin/arm-android-eabi-gcc：找不到命令

当显示 bin 目录中的文件时发现 arm-android-eabi-gcc -> not found but arm-eabi-gcc -> found

我该如何解决这个问题，谢谢

# php - Php 和装饰器模式中的路由

> ID：13864624
> 
> 赞同：2
> 
> 时间：2012-12-13T16:53:12.140
> 
> 标签：php, design-patterns, url-routing, decorator

我不知道我是否正确使用了“路由”一词，但情况如下：

我创建了一个`.htaccess`文件来“处理”（如果我的术语是正确的，不知道）我的应用程序的 url，如下所示：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f

RewriteRule ^(.+)$ index.php?url=$1 [QSA,L] 
```

现在我有这个：

```
http://appname/controller/method/parameter
http://appname/$url[0]/$url[1]/$url[2] 
```

我所做的是：

1.  设置默认控制器，以防在 url 中未指定
2.  设置一个控制器包装器

我是这样做的

```
$target = new $url[0]()
$controller = new Controller($target) 
```

那个问题是我不能使用我在控制器的构造函数中传递的对象中的方法：

我是这样解决的：

```
class Controller {
  protected $target;
  protected $view;

  public function __construct($target, $view) {
    $this->target = $target;
    $this->view = $view;
  }

  public function __call($method, $arguments) {
    if (method_exists($this->target, $method)) {
        return call_user_func_array(array($this->target, $method), $arguments);
    }
  }
} 
```

这工作正常，问题出现在我进行路由的索引中，这里是

```
if(isset($url[2])){
    if(method_exists($controller, $url[1])){
         $controller->$url[1]($url[2])
    }
} else {
    if(method_exists($controller, $url[1])){
         $controller->$url[1]()
    }
} 
```

在哪里`$controller = new Controller($target)`

问题是方法不存在，虽然我可以直接使用它而不检查方法是否存在，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:58:36.183

`method_exists`正如您已经发现的那样，当它被魔术`__call`方法处理时，您无法使用。但是，您可以向 Controller 添加一个额外的公共方法来解决此问题：

```
class Controller {
  protected $target;
  protected $view;

  public function __construct($target, $view) {
    $this->target = $target;
    $this->view = $view;
  }

  public function hasMethod($method) {
    return is_callable(array($this->target, $method));
  }

  public function __call($method, $arguments) {
    if (!is_callable(array($this->target, $method))) {
        throw new \BadMethodCallException("Method `$method` is not callable");
    }

    return call_user_func_array(array($this->target, $method), $arguments);
  }
} 
```

所以...

```
if(isset($url[2])){
    if($controller->hasMethod($url[1])){
         $controller->$url[1]($url[2])
    }
} else {
    if($controller->hasMethod($url[1])){
         $controller->$url[1]()
    }
} 
```

**编辑**：更改`method_exists`为`is_callable`确保只有公共方法返回 true。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:01:40.983

使用`is_callable()`代替，`method_exists()`它将返回正确的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T23:04:27.297

简短的回答：你做错了。现在长一点...

这里的主要问题是您试图在控制器中硬塞路由机制。现代 MVC 模式中的控制器负责从用户输入中获取信息，并将其应用于模型层和/或当前视图以更改其状态。

它**不**应该负责从原始输入数据中提取信息。这应该通过某种形式的路由机制来完成，该机制在您的代码实际*命中*MVC 三元组之前使用。最好在应用程序的引导/启动阶段。

基本上你会做类似的事情：

```
$uri = isset( $_GET['url'] ) ? $_GET['url'] : '/';
$request = new Request;
$request->setUrl( $url );

$router = new Router;
$router->route( $request );

$class = $request->getParameter('controller');
$method = $request->getParameter('action');

if ( !class_exists( $class ))
{
    $class  = 'ErrorController';
    $method = 'missingController';
}

if ( !is_callable( [$class, $method] ))
{
    $class  = 'ErrorController';
    $method = 'missingAction';
}

$controller = new $class( /* inject some dependencies */ );
$controller->{$method}( $request ); 
```

> [这当然是简化且有些笨拙的示例。**不要在生产代码中复制粘贴。**]

# android - 重置ui：如何？

> ID：13864630
> 
> 赞同：0
> 
> 时间：2012-12-13T16:53:33.913
> 
> 标签：android, android-layout, android-ui

我有一个带有许多元素（收音机、EditText 等）的 UI 的活动。当我更改 EditText 中的文本时，我希望该 UI 回到其起始状态。

我试图杀死并重新启动活动，但效果不佳。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:55:54.357

我会尝试`setContentView`使用新视图或最初用于呈现活动的 xml 文件再次调用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:55:56.873

您可以向 EditText 视图添加一个侦听器，当文本是您想要的文本时，您可以通过编程方式清空任何 TextView、EditText，将任何单选按钮或单选组重置为其默认值。无需重新启动活动。只需编写一个“手动”重置视图的辅助方法。虽然我还没有尝试过，但使用`setContentView()`也可以工作，您可能必须使用侦听器等再次设置您的完整视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:59:44.240

从 editText 获得所需的值后，您可以使用

```
editText.setText(""); 
```

您也可以类似地以编程方式控制 UI 的其他部分。

为什么不将所有重置的东西放在一个函数中，并在需要时简单地调用它：

```
public void resetUI()
{

//reset UI programatically

} 
```

# c# - 除了程序集和类型元数据之外，ILDASM 在哪里显示 .JPG、.XML、.txt 文件

> ID：13864631
> 
> 赞同：1
> 
> 时间：2012-12-13T16:53:36.267
> 
> 标签：c#, metadata, ildasm

谁能指导我除了程序集和类型元数据之外，ILDASM 在哪里显示 .JPG、.XML、.txt 文件（添加到项目中）

# windows-8 - 在 WinRT 中访问 Windows 下载文件夹

> ID：13864639
> 
> 赞同：1
> 
> 时间：2012-12-13T16:53:59.807
> 
> 标签：windows-8, windows-runtime, filesystems

根据[这篇](http://lunarfrog.com/blog/2012/05/21/winrt-folders-access/)文章，我们只有对下载文件夹的写入权限——这似乎得到了我发现的支持。在 WinRT 中有没有办法解决这个问题？我希望能够遍历下载文件夹中的文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-15T06:13:26.893

[这](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.downloadsfolder.aspx)是有关该主题的官方文档：

> 所有应用程序都可以在“下载”文件夹中创建文件和文件夹，并且可以访问它们创建的文件。但应用无法访问“下载”文件夹中不是他们创建的文件。
> 
> 当您的应用在“下载”文件夹中创建文件时，其他应用无法干扰或访问您的文件，除非用户明确授予其他应用访问权限。用户可以通过从文件选择器中选择文件来授予另一个应用程序访问您的文件的权限。您的应用还可以使用文件选择器来访问“下载”文件夹中不是它创建的文件。

所以，不：没有用户干预，没有办法枚举或迭代文件夹中的所有文件。但是，如果您让用户选择带有以下内容的文件夹，您可以这样做`FolderPicker`：

```
var picker = new FolderPicker();
picker.FileTypeFilter.Add("*");
var folder = await picker.PickSingleFolderAsync();
foreach (var file in await folder.GetFilesAsync())
{
    // do something with each file
} 
```

获得参考后，`StorageFolder`您甚至可以将其存储起来，`MostRecentlyUsedList`以便将来可以访问它，而无需用户再次选择它：

```
var token = StorageApplicationPermissions.MostRecentlyUsedList.Add(folder); 
```

您只需要存储返回的令牌即可再次访问它：

```
var folder = await StorageApplicationPermissions.MostRecentlyUsedList.GetFolderAsync(token); 
```

# android - 使用opencv在android上操作位图

> ID：13864641
> 
> 赞同：1
> 
> 时间：2012-12-13T16:54:06.220
> 
> 标签：android, opencv, bitmap, out-of-memory

我在 android 上使用 OpenCV 来操作位图，当我想使用原始而不是缩放图像（例如 1500 x 2048 分辨率）进行操作时出现内存不足错误。当我缩放图像时，一切正常，但我需要对原始图像进行操作，因为图像质量对我来说非常重要。当我想使用该代码将 Mat 转换为位图时会发生这种情况：

```
private Bitmap convertMatToBitmap(Mat image) {
    Bitmap bitmap = null;

    try {
        bitmap = Bitmap.createBitmap(image.width(), image.height(), Config.ARGB_8888);

        org.opencv.android.Utils.matToBitmap(image, bitmap);
    } catch (OutOfMemoryError e) {
        Log.e(TAG, "Out of memory exception in convertMatToBitmap: " + e.getMessage());
    } catch(Exception e) {
        Log.e(TAG, "convertMatToBitmap throws an exception: " + e.getMessage());
    }

    return bitmap;
} 
```

有人知道我该怎么做吗？

# delphi - 使用delphi 2010将文本文件读取为字节（逐字节）

> ID：13864643
> 
> 赞同：0
> 
> 时间：2012-12-13T16:54:14.520
> 
> 标签：delphi, delphi-2010

我想逐字节读取 UTF-8 文本文件并获取文件中每个字节的 ascii 值表示。这可以做到吗？如果是这样，最好的方法是什么？

然后我的目标是用一个字节替换我找到的 2 个字节组合（这些是我准备好的设置条件）

例如，如果我发现 197 后跟 158（十进制表示），我将用单个字节 17 替换它

我不想使用标准的 delphi IO 操作

```
AssignFile
ReSet
ReWrite(OutFile);
ReadLn
WriteLn
CloseFile 
```

有没有更好的方法？这可以使用`TStream`(Reader & Writer) 来完成吗？

这是我正在使用的示例测试。我知道从第 84 列开始有一个字符（350）（两个字节）。在十六进制编辑器中查看时，该字符由 197 + 158 组成 - 所以我试图使用我的 delphi 代码找到 198，但似乎无法找到它

```
FS1:= TFileStream.Create(ParamStr1, fmOpenRead);
try
 FS1.Seek(0, soBeginning);
 FS1.Position:= FS1.Position + 84;
 FS1.Read(B, SizeOf(B));
 if ord(B) = 197 then showMessage('True') else ShowMessage('False');
finally
 FS1.Free;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:01:28.023

您可以使用 TFileStream 将所有数据从文件读取到，例如，字节数组，然后检查 utf8 序列。另请注意，utf8 序列可以包含超过 2 个字节。

而且，在 Delphi 中有一个函数 Utf8ToUnicode，它将 utf8 数据转换为可用的 unicode 字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T17:17:04.813

我的理解是您想将文本文件从 UTF-8 转换为 ASCII。这很简单：

```
StringList.LoadFromFile(UTF8FileName, TEncoding.UTF8);
StringList.SaveToFile(ASCIIFileName, TEncoding.ASCII); 
```

运行时库带有各种功能，可以在不同的文本编码之间进行转换。您肯定不想尝试自己复制此功能吗？

我相信您意识到这种转换可能会丢失数据。序数大于 127 的字符不能用 ASCII 表示。事实上，在 UTF-8 中需要超过 1 个八位字节的每个代码点都不能用 ASCII 表示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T01:04:29.643

5 小时后，您在另一个主题中问了同样的问题，答案 od 更好地解决了您的具体问题：

[使用delphi 2010替换UTF-8文件中的unicode字符](https://stackoverflow.com/questions/13868914/)

# c# - Rhino mocks assertwascalled with indexer 和 args

> ID：13864644
> 
> 赞同：1
> 
> 时间：2012-12-13T16:54:18.170
> 
> 标签：c#, unit-testing, rhino-mocks, rhino-mocks-3.5

我试图断言以下被调用

```
cacheManager.Site[typeName] = items.Where(x => !requestContext.DefaultSites.Contains(x.SiteId)).ToList(); 
```

我无法计算出带有 args 的索引器的语法，我有这个

```
manager.Site.AssertWasCalled(x => x[TypeName] = Arg<IList<FcCacheObject>>.Matches(y => y.Count.Equals(1))); 
```

但它要求索引器也使用 args，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:08:57.887

这很简单:)

我假设您的索引器参数类型是`string`. 然后在断言而不是

```
x[TypeName] 
```

采用

```
x[Arg<string>.Is.Equal(TypeName)] 
```

结果你的断言应该看起来：

```
manager.Site.AssertWasCalled(x => x[Arg<string>.Is.Equal(TypeName)] = Arg<IList<FcCacheObject>>.Matches(y => y.Count.Equals(1))); 
```

# scala - 标准用户帐户下的 IntelliJ IDEA 12.0 Scala 工作表错误，但在管理员下工作

> ID：13864650
> 
> 赞同：1
> 
> 时间：2012-12-13T16:54:32.717
> 
> 标签：scala, intellij-idea, worksheet

当我尝试在 Windows 7 (32) 的标准用户下使用最新的 Scala 插件（2012 年 12 月 5 日版本）评估 IntelliJ IDEA 12.0 中的 Scala 工作表时，它说：

```
Cannot start process, the working directory 
C:\Program Files\JetBrains\IntelliJ IDEA 12.0\bin does not exist 
```

该目录确实存在。

在管理员帐户下的同一台机器上评估 Scala 工作表按预期工作。

我做错了什么（除了使用 Windows）？我能做些什么来解决这个问题（除了从管理员帐户使用它）？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-13T14:19:48.027

似乎 IntelliJ IDEA 正在使用安装目录作为 Scala 工作表的默认工作目录。*您可以在运行配置*设置中更改此设置：转到**运行** *>* **编辑配置...**在这里展开**默认值**并选择**工作表**。在右侧窗格中，您将看到一个名为**Working directory**的空文本字段：

![Scala 工作表默认工作目录](../Images/25a92d2374041f4606636ea224e76416.png)

输入现有目录或使用右侧的按钮选择一个。您在此处指定的目录将用于您创建的所有工作表。*如果您在相应的工作表运行配置中而不是在默认*部分中输入目录，您也可以指定每个运行配置的工作目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T13:51:36.560

我对 Scala 插件也有同样的问题，但是如果您使用编辑配置将工作目录设置为当前工作目录（基本上不是空的），问题就解决了

如果您不使用外部构建模式，也会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T10:45:45.693

请关注问题[http://youtrack.jetbrains.com/issue/SCL-5049](http://youtrack.jetbrains.com/issue/SCL-5049)以获取修复时的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T01:16:34.333

显然更改目录的权限。不要在管理员下运行任何单个非守护程序任务。如果类似的问题继续重复 - 考虑从弃用的操作系统切换到更稳定的操作系统，以减轻您的开发工作。

# matlab - 正则表达式在字符串中查找匹配条件

> ID：13864656
> 
> 赞同：0
> 
> 时间：2012-12-13T16:55:02.780
> 
> 标签：matlab

您好在使用正则表达式进行条件匹配方面需要帮助。

ex.my 文件有以下内容 {hello.program='function'`; bye.program='脚本'; }

我正在尝试使用正则表达式来匹配其中的字符串`.program='function'`：

```
pattern = '[.program]+\=(function)' 
```

也试过`pattern='[^\n]*(.hello=function)[^\n]*';`

```
pattern_match = regexp(myfilename,pattern , 'match') 
```

但这会返回我 pattern_match={} 而我希望结果是 hello.program='function'`;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:01:03.790

如果`'function'`带有字符串标记，则需要将它们包含在匹配中。此外，您需要转义点（否则，它被认为是“任何字符”）。`[.program]+`查找方括号中包含的一个或多个字母 - 但您可以直接查找`program`。此外，您不需要转义 -`=`符号（这可能是搞砸比赛的原因）。

```
cst = {'hello.program=''function''';'bye.program=''script'''; };
pat = 'hello\.program=''function''';
out = regexp(cst,pat,'match');
out{1}{1} %# first string from list, first match
   hello.program='function' 
```

* * *

**编辑**

回应评论

> 我的文件包含
> 
> m2 = S.参数；
> m2.Value = matlabstandard;
> m2.Volatility = '可调';
> m2.Configurability = '无';
> m2.ReferenceInterfaceFile ='';
> m2.DataType = '自动';
> 
> 我的目标是找到所有匹配的行， .DataType='auto'

这是使用正则表达式查找匹配行的方法

```
%# read the file with textscan into a variable txt
fid = fopen('myFile.m');
txt = textscan(fid,'%s');
fclose(fid);
txt = txt{1};

%# find the match. Allow spaces and equal signs between DataType and 'auto'
match = regexp(txt,'\.DataType[ =]+''auto''','match')

%# match is not empty only if a match was found. Identify the non-empty match
matchedLine = find(~cellfun(@isempty,match)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:11:54.530

试试这个，因为它完全匹配 .program='function' ：

```
 (\.)program='function' 
```

我认为这不起作用：

```
 '[.program]+\=(function)' 
```

因为 [] 的工作方式。这是一个解释我为什么这么说的链接：[http ://www.regular-expressions.info/charclass.html](http://www.regular-expressions.info/charclass.html)

# java - 如何修改私有访问对象？

> ID：13864658
> 
> 赞同：1
> 
> 时间：2012-12-13T16:55:09.010
> 
> 标签：java, swing, jframe

我制作了一个框架并向其中添加了一个桌面窗格（dp_1）。然后我创建了一个单独的内部 jframe 表单 (Inj) 并将此代码分配给框架表单 (main) 中的按钮。

```
Inj inj = new Inj();
dp_1.add(inj);
inj.setVisible(true); 
```

它工作正常。然后我创建了另一个内部 jframe 表单（Inj_1）。我想通过 Inj 中的按钮将其设置为可见。我确实尝试了相同的代码，但出现了错误。

错误是；

```
error: dp_1 has private access in NewJFrame 
```

* **() 包含变量名。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:56:45.407

您应该在拥有该变量的类中提供一个公共方法，并让它修改自己的状态。

如果必须，您也可以使用反射，但我不推荐它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:59:27.177

您必须尝试`dp_1`在定义它的类之外使用。

所以解决方案是通过将访问级别修改为默认、受保护或公共来提高其可见性

或者创建一个`dp_1`从它返回对象的公共方法，然后访问它。

# c# - 线程 IIS 不会启动 C#

> ID：13864662
> 
> 赞同：2
> 
> 时间：2012-12-13T16:55:25.097
> 
> 标签：c#, multithreading, iis, request, threadpool

在我进入这个问题之前，我想说的是，我已经阅读了 IIS 7、7、7.5 的线程建模，所以我知道线程是如何处理的。

当请求进来时，我的应用程序启动一个线程。

我们可以将线程假设为 cron 作业。

1.  GET 请求进来，让我们说 /Handle
2.  在 /Handle 的范围内，我从该操作开始一个线程，线程 A
3.  我不会长时间轮询 GET 请求，因此它会立即返回给用户。所以处理 GET 的线程返回到 POOL
4.  然后我等到线程 A 完成做任何其他事情。
5.  所以据我所知，没有线程正在运行。处理 GET 和 THREAD A 的线程都已退出。

我多次提出相同的要求。我总是等待两个线程退出。过了一会儿`Thread.Start()1 功能块。

问题：我知道线程正在返回并且我没有泄漏任何幽灵线程。为什么 IIS 不允许我在 4-5 个请求后启动新线程。?

为用户应用程序创建应用程序线程的正确方法是什么。如果我说`Thread t= new Thread()`，这是否会从处理GETS 或CLR 的池中分配一个线程？我正在使用 IIS7。

我知道我退出了每个线程，我在 THREAD A 上调用了一个 JOIN，它永远不会阻塞，此时我并不担心可伸缩性，所以我总是让一个用户按顺序访问服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:52:25.837

因此，要回答您的问题**“为用户应用程序创建应用程序线程的正确方法是什么？”** （即 ASP.NET 应用程序） - 您有很多选择：

*   在 ASP.NET 线程上运行，没有任何线程 - ASP.NET 仍将处理多个请求
*   对长时间运行的操作使用异步调用（请参阅[异步操作）](http://www.codeguru.com/csharp/.net/net_asp/working-with-asynchronous-operations-in-asp.net-4.5-web-forms.htm)
*   使用[CLR 线程池](http://msdn.microsoft.com/en-us/library/3dasc8as%28v=vs.100%29.aspx)
*   向其他服务器发送消息（例如使用 WCF 服务），因此长时间运行的处理发生在 Web 服务器之外。

您提到阅读 ASP.NET 中的线程，但在[“MSDN：在 ASP.NET 应用程序中执行异步工作或任务”中，对 ASP.NET](http://blogs.msdn.com/b/tmarq/archive/2010/04/14/performing-asynchronous-work-or-tasks-in-asp-net-applications.aspx)中的线程如何工作进行了相对简短的描述。帖子最后有一个问题： **“Q4：我应该创建自己的线程（新线程）吗？”** 该问题的答案是**“A4）请不要（创建新线程）。或者换一种说法，不！！！（...）”。**

并回答您的问题：“**为什么 IIS 不允许我在 4-5 个请求后启动新线程”？** 这真是一个奇怪的行为，也许 IIS 知道你做错了；）

# c# - C#中的正则表达式问题

> ID：13864666
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:55:51.493
> 
> 标签：c#, regex

我的文件是

```
> A B C D unuse data  <begin> Addd as ss 1 My name is 2323 33 text 
> </end> 34344 no need 
```

我的代码是

```
StringBuilder mSb = new StringBuilder();
           StreamReader sr = new StreamReader(@"E:\check.txt");
           String line;

           while (sr.ReadLine() != null)
           {

               mSb.AppendLine(sr.ReadLine());

           }
string matc = new Regex(@"(<begin>)(\n?.*)*</end>)?").Match(mSb.ToString()).ToString(); 
```

在这里它读取所有文件，但我只想直到我删除？从头到尾，我的程序崩溃了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:02:10.907

我猜你正在寻找类似的东西

```
var text = File.ReadAllText(@"E:\check.txt");
var match = Regex.Match(text, @"(?s)<begin>.*?</end>").Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:09:23.537

最终代码应如下所示：

```
var text = System.IO.ReadAllText(@"E:\check.txt");
var match = Regex.Match(text, @"<begin>(.*?)</end>", RegexOptions.SingleLine);
string matc = match.Success ? match.Groups[1].value : null; 
```

希望这对您的追求有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:12:38.953

在尝试使用它之前检查匹配的值。也使用 File.ReadAllText 而不是处理流。

```
//var data = File.ReadAllText(@"C:\MyFile.txt")

string data = @"> A B C D unuse data  <begin> Addd as ss 1 My name is 2323 33 text
> </end> 34344 no need";

var mtch = Regex.Match(data, @"((<begin>)(.+?)(</end>))", RegexOptions.Multiline | RegexOptions.Singleline );

if (mtch.Success)
   Console.WriteLine (mtch.Groups[0].Value);
else
   Console.WriteLine ("Failure to match");

/* Outputs

<begin> Addd as ss 1 My name is 2323 33 text
> </end>

*/ 
```

# ruby - Ruby + Cucumber：如何在代码中执行 cucumber？

> ID：13864670
> 
> 赞同：10
> 
> 时间：2012-12-13T16:55:57.387
> 
> 标签：ruby, dynamic, cucumber

我想从 Ruby 代码中执行 Cucumber 功能。

通常，`cucumber`与 gem 一起安装的二进制文件在命令行上执行，并指定一个或多个特性。

但是，我想定义创建动态功能执行流程的逻辑。换句话说，程序可以计算出应该执行哪些功能。

是否可以使用 Ruby 代码中的指定功能文件而不是命令行来实例化 Cucumber？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-13T17:18:02.637

我从邮件列表和一些 API 阅读中发现了如何。

```
features="path/to/first.feature path/to/second.feature"
runtime = Cucumber::Runtime.new 
runtime.load_programming_language('rb') 
Cucumber::Cli::Main.new([features]).execute!(runtime) 
```

如果您希望`features/`执行 gem 目录中的所有功能，请改为传递一个空数组`Main.new`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-04T19:43:50.557

要转换此示例命令，并指定功能和选项：

```
cucumber features/first.feature features/second.feature -d -f Cucumber::Formatter::Custom 
```

到 Ruby 代码中，它归结为传递 Cucumber 一个`args`数组：

```
require 'cucumber'

# Method 1 - hardcoded features
args = %w(features/first.feature features/second.feature -d -f Cucumber::Formatter::Custom)

# Method 2 - dynamic features
features = 'features/first.feature features/second.feature'
args = features.split.concat %w(-d -f Cucumber::Formatter::Custom)

# Run cucumber
begin
  Cucumber::Cli::Main.new(args).execute!
rescue SystemExit
  puts "Cucumber calls @kernel.exit(), killing your script unless you rescue"
end 
```

使用 Ruby 2.0.0p598 和 Cucumber 1.3.17 测试

# iphone - 为 UIimage 添加边框

> ID：13864672
> 
> 赞同：2
> 
> 时间：2012-12-13T16:56:12.013
> 
> 标签：iphone, ios, xcode, uiimageview, uiimage

我有几个关于向 UIimage 添加边框的问题：

1）有没有为uiimageview的图像添加动态边框？我试图通过使用来添加边框，`[layer setBorderColor:[UIColor whiteColor].CGColor];`但边框只显示在 uiimageview 的框架（正方形或矩形）周围。我所有的图像都有粗黑色轮廓和自定义形状（例如 hellokitty），我想在轮廓周围添加边框。这样可以吗？？？

（我也尝试在图像周围添加阴影，但是结果太模糊了，无论如何要使它们变得坚固？？我认为这是解决我问题的另一种方法）

2）另外，如果我可以绘制自定义形状边框以贴在图像周围，是否可以在边框内填充颜色？？因为我的一些图像没有填充颜色，有什么想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:05:17.470

如果您的图像是透明的，形状随机（即图像的轮廓是 hello kitty 的形状），那么我会通过...

首先，这里忽略 UIImageView。可能更容易创建自定义 UIView 子类。

在您视图的drawRect中...

```
- (void)drawRect:(CGRect)rect
{
    // calculate the rect of the image (aspect ratio etc...) so that it fits in the rect.
    // see this link https://stackoverflow.com/questions/7645454/resize-uiimage-by-keeping-aspect-ratio-and-width

    // change the colour of the image to black (or the border colour you want).
    // see this link http://coffeeshopped.com/2010/09/iphone-how-to-dynamically-color-a-uiimage

    // draw the black image in the rect you calculated

    // make a new rect that is smaller by in x and y than the one for the black image.
    // You can change it by different amounts to change the border size

    // draw the colour image in the new rect
} 
```

每个步骤都需要相当多的代码，所以我只放了链接和建议，但如果我试图做你正在做的事情，我会这样做。

链接 1 -[通过保持纵横比和宽度调整 UIImage 的大小](https://stackoverflow.com/questions/7645454/resize-uiimage-by-keeping-aspect-ratio-and-width)

链接 2 - [http://coffeeshopped.com/2010/09/iphone-how-to-dynamically-color-a-uiimage](http://coffeeshopped.com/2010/09/iphone-how-to-dynamically-color-a-uiimage)

# c# - 如何使用 3 优化实体框架查询包括

> ID：13864675
> 
> 赞同：2
> 
> 时间：2012-12-13T16:56:22.473
> 
> 标签：c#, entity-framework

我在 .Net 4 上使用 EF 5

我有以下模型：

```
public class Order
{

    [Key]
    public int Id { get; set; }
    public string OrderId { get; set; }

    public Address BillingAddress { get; set; }
    public Address DeliveryAddress { get; set; }
    public ICollection<OrderLine> OrderLines { get; set; }
}

public class OrderLine
{
    [Key]
    public int Id { get; set; }

    public string Description { get; set; }
    public decimal UnitPrice { get; set; }
    public int Quantity { get; set; }
    public string SKU { get; set; }
    public decimal ShippingCost { get; set; }
    public decimal Tax { get; set; }
}

public class Address
{
    [Key]
    public int Id { get; set; }
    public string Addressee { get; set; }
    public string AddressLine1 { get; set; }
    public string AddressLine2 { get; set; }
    public string AddressLine3 { get; set; }
    public string Town { get; set; }
    public string County { get; set; }
    public string Country { get; set; }
    public string Postcode { get; set; }
} 
```

和型号配置：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Order>().HasMany(x => x.OrderLines).WithRequired().WillCascadeOnDelete();
    modelBuilder.Entity<Order>().HasOptional(x => x.BillingAddress).WithOptionalDependent().WillCascadeOnDelete();
    modelBuilder.Entity<Order>().HasOptional(x => x.DeliveryAddress).WithOptionalDependent().WillCascadeOnDelete();

    base.OnModelCreating(modelBuilder);
} 
```

当我运行以下查询时，我得到带有**19 个连接**的 sql，这对于简单的关系来说似乎过多

```
context.Orders
       .Where(x => x.OrderId == orderId)
       .Include(x => x.OrderLines)
       .Include(x => x.BillingAddress)
       .Include(x => x.DeliveryAddress)
       .FirstOrDefault(); 
```

难道我做错了什么？格式化 linq 查询以优化生成的 SQL 是否有不同的格式？

编辑：

这是实际查询：[https ://gist.github.com/4278014](https://gist.github.com/4278014)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:47:36.500

我认为问题出`WithOptionalDependent`在帐单和送货地址上。这会在地址和订单之间创建 1:1 的关系，即使表是为 1:many 关系设置的。

如果您更改配置以`WithMany`改用：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Order>().HasMany(x => x.OrderLines).WithRequired().WillCascadeOnDelete();
    modelBuilder.Entity<Order>().HasOptional(x => x.BillingAddress).WithMany().WillCascadeOnDelete();
    modelBuilder.Entity<Order>().HasOptional(x => x.DeliveryAddress).WithMany().WillCascadeOnDelete();

    base.OnModelCreating(modelBuilder);
} 
```

查询要简单得多，基本上等同于：

```
...
FROM [Orders]
LEFT OUTER JOIN [Addresses] As B ON [Orders].[BillingAddress_Id] = B.[Id]
LEFT OUTER JOIN [Addresses] As D ON [Orders].[DeliveryAddress_Id] = D.[Id]
LEFT OUTER JOIN [OrderLines] ON [Orders].[Id] = [OrderLines].[Order_Id] 
```

# c# - 查询缓存或

> ID：13864676
> 
> 赞同：0
> 
> 时间：2012-12-13T16:56:24.327
> 
> 标签：c#, mysql, entity-framework, caching

我正在使用 MYSql 数据库和实体框架作为它的 ORM。我有两个表：表 A 和表 B。表 A 有一个字段，它是表 B 中某个字段的外键。这个键的约束是：更新：限制，删除：限制所以情况：

*   当我尝试从表 B 中删除记录时，一切正常
*   当我尝试从表 B 中删除一条记录并且该记录被表 A 中的另一条记录引用时，它什么也不做，并且应该是 ofc。
*   当我尝试从被引用的表 B 中删除一条记录时，它什么也不做，但如果我在此之后尝试从表 A 中删除一条从表 B 中引用该记录的记录，那么这两条记录似乎都被删除了。但只应删除表 A 中的记录。

所以我假设有某种缓存可以缓存不成功的查询并在可能的情况下尝试执行它。

如果我的话很模糊，我会尝试发布一些图片=）

啊，问题是：任何人都可以清除这种情况吗？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T09:11:21.783

解决了这个问题。没有缓存或类似的东西 =) 我试图删除的只是实体对象被标记为 EntityState.Deleted 并且尽管抛出了异常，但状态没有回滚。

# asp.net - 在一个动作后得到一个 int 递减

> ID：13864680
> 
> 赞同：0
> 
> 时间：2012-12-13T16:56:31.697
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, int

所以在我的个人表中......我有 Id、Name 和 HolidaysRemaining。

它用于假期预订应用程序，当用户从日历中选择日期并单击按钮时，atm 选择的每个日期都将存储在数据库中，我试图将剩余的假期减去 1，因为每个假期都已预订，但是它似乎没有好转。

```
//listHolidays in correct format dd/mm/yy
    [HttpPost]
    public ActionResult listHolidays(Holiday holiday, Person person , int? PersonId, string HolidayDate, string endDate, string AlreadyExists)
    {
        db.People.Attach(person);
        //int holidaysRemaining = 20;
        //person.HolidaysRemaining = holidaysRemaining;    

        DateTime startDates = Convert.ToDateTime(HolidayDate);
        DateTime endDates = Convert.ToDateTime(endDate);

    try{

        while (startDates <= endDates)
        {
            if (startDates.DayOfWeek != DayOfWeek.Saturday && startDates.DayOfWeek != DayOfWeek.Sunday)
            {                 
                //if user selects Holiday that already exists, wont add it to Db
                //gets string, and uses the previously converted to dateTime 'startDate'
                //id so only applies to person creating holidays
                ViewBag.CantDuplicateHolidays = String.IsNullOrEmpty(AlreadyExists) ? "date" : "";
                var dates = from d in db.Holidays
                where d.HolidayDate == startDates && d.PersonId == PersonId
                select d;

                // <= 0..so if holiday does not already exist
                if (dates.Count() <= 0)
                {
                  //  holidaysRemaining--;
                    person.HolidaysRemaining = person.HolidaysRemaining - 1;

                    Holiday holiday1 = new Holiday();
                    holiday1.PersonId = PersonId.Value;
                    holiday1.HolidayDate = startDates;

                    db.Holidays.AddObject(holiday1);

                    db.SaveChanges();
                    //say start date is 10\. AddDays(1) will make it 11 then return it to startDates in 'startDates' = startdates,
                    //but doesnt chage the value of startdates = 'startdates'
                }

            }
        }

        startDates = startDates.AddDays(1);
    }

    finally
    {
        db.People.Detach();
    }

    return RedirectToAction("Index");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:59:42.777

我认为你的问题在这里：

```
if (dates.Count() <= 0)
    {
    //  holidaysRemaining--;
    person.HolidaysRemaining--; 
```

尝试将其更改为：

```
if (dates.Count() <= 0)
    {
    //  holidaysRemaining--;
    person.HolidaysRemaining = person.HolidaysRemaining - 1; 
```

**编辑**

此外，您从未真正使用人员更新数据库？

```
db.People.Attach(person); 
```

前`db.SaveChanges();`

**再次编辑**

尝试这个：

[HttpPost] public ActionResult listHolidays(Holiday holiday, Person person, int? PersonId, string HolidayDate, string endDate, string AlreadyExists) {
//int holidayRemaining = 20; //person.HolidaysRemaining = holidayRemaining;

```
 DateTime startDates = Convert.ToDateTime(HolidayDate);
        DateTime endDates = Convert.ToDateTime(endDate);

        while (startDates <= endDates)
        {
            if (startDates.DayOfWeek != DayOfWeek.Saturday && startDates.DayOfWeek != DayOfWeek.Sunday)
            {                 
                    //if user selects Holiday that already exists, wont add it to Db
                    //gets string, and uses the previously converted to dateTime 'startDate'
                    //id so only applies to person creating holidays
                    ViewBag.CantDuplicateHolidays = String.IsNullOrEmpty(AlreadyExists) ? "date" : "";
                    var dates = from d in db.Holidays
                    where d.HolidayDate == startDates && d.PersonId == PersonId
                    select d;

                    // <= 0..so if holiday does not already exist
                    if (dates.Count() <= 0)
                    {
                      //  holidaysRemaining--;
                        person.HolidaysRemaining = person.HolidaysRemaining - 1;

                        Holiday holiday1 = new Holiday();
                        holiday1.PersonId = PersonId.Value;
                        holiday1.HolidayDate = startDates;

                        db.Holidays.AddObject(holiday1);
            db.People.Attach(person);

                        db.SaveChanges();
                        //say start date is 10\. AddDays(1) will make it 11 then return it to startDates in 'startDates' = startdates,
                        //but doesnt chage the value of startdates = 'startdates'
                    }

            }

            startDates = startDates.AddDays(1);
        }

        return RedirectToAction("Index");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T20:36:55.567

可能这是最简单的解决方案。

代替：

```
person.HolidaysRemaining = person.HolidaysRemaining - 1; 
```

和：

```
var dbPerson = from p in db.People where p.Id == PersonId select p;
dbPerson[0].HolidaysRemaining--; 
```

或者，我们正在讨论附加 person 对象，因为您拥有它：

```
 db.People.Attach(person)
    try {
        // ... loop and everything else here
    } finally {
        db.People.Detach(person);
    }
} // end of method 
```

但这有点脆弱，只有`Person`在`db.People`.

注意：两者`person`和`PersonId`都被传递到`listHolidays()`.

# c# - lambda 相当于 sql update with joins

> ID：13864681
> 
> 赞同：0
> 
> 时间：2012-12-13T16:56:37.403
> 
> 标签：c#, sql, lambda

我有两组数据。

与此 sql update 语句等效的 lambda 语法是什么？

```
UPDATE Customers1
SET Customers1.Email = Customers2.Email
JOIN Customers2 ON Customers1.ID = Customers2.ID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:59:42.653

Lambda 只是一种编写匿名方法的方式：`x => { body }`. 我假设您实际上是指 LINQ。

没有等价物，因为`Q`LINQ 中的 in 代表*query*。LINQ 查询数据，它不会改变它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:31:41.730

正如 DanielHilgarth 所说，仅仅使用 lambda 甚至 LINQ 是不够的。

我假设你需要类似的东西：

```
foreach(var customer1 in customers1) {
    var customer2 = customers2.FirstOrDefault(c2 => customer1.ID.Equals(c2.ID));
    if (customer2 != null) customer1.Email = customers2.Email;
} 
```

因此，lambda 是整个实现的一部分。

# jquery - jQuery 插件的样板

> ID：13864683
> 
> 赞同：1
> 
> 时间：2012-12-13T16:56:45.820
> 
> 标签：jquery

我想知道你们对这个样板的看法？

```
;(function( $, window, document, undefined ) {
    // plugin's name
    $.fn.plugin = function(method, options) {
        // defaults
        var defaults = {
            property: "value"
        };
        // overwrites default options
        var settings = $.extend( {}, defaults, method, options );
        // methods object
        var methods = {
            // method's namespace 
            methodA: function() {
                // code goes here
            }
        };
        // return a valid method
        if ( methods[method] ) {
            return methods[method].apply( this );
        } else if ( typeof method === "object" ) {
            return methods.fade.apply( this );
        } else {
            console.error( "Method %d does not exist in jQuery.transition", method );
        }       
    };  
})( jQuery, window, document ); 
```

它似乎工作得很好，但我不太确定它的性能和良好的实践，虽然它类似于 jquery 官方创作

# grails-plugin - 推荐的安装 grails 插件的方法

> ID：13864684
> 
> 赞同：0
> 
> 时间：2012-12-13T16:56:53.270
> 
> 标签：grails-plugin, grails-2.0

在 2.1.0 项目中包含 grails 插件的推荐方法是什么？

1：添加到application.properties？

```
app.grails.version=2.1.0
app.name=testapp-local
app.version=0.1
plugins.build-test-data=2.0.3
plugins.fixtures=1.1
plugins.hibernate=2.1.0
plugins.pretty-time=0.3
plugins.mail=1.0
plugins.quartz=0.4.2
plugins.spring-security-core=1.2.7.3
plugins.tomcat=2.1.0 
```

2：在buildConfig.groovy中指定？

```
plugins {
        runtime ":hibernate:$grailsVersion"
        runtime ":jquery:1.7.2"
        runtime ":resources:1.1.6"

        // Uncomment these (or add new ones) to enable additional resources capabilities
        //runtime ":zipped-resources:1.0"
        //runtime ":cached-resources:1.0"
        //runtime ":yui-minify-resources:0.1.4"

        build ":tomcat:$grailsVersion"

        runtime ":database-migration:1.1"

        compile ':cache:1.0.0'
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:03:03.820

我总是把它放在 buildConfig.groovy 因为这允许

1.  定义依赖的范围
2.  排除不需要的依赖，可以省去很多麻烦

顺便说一句：在这里找到了一个有趣的线程，它实际上处理了完全相同的问题：

[http://grails.1312388.n4.nabble.com/Plugins-application-properties-vs-BuildConfig-groovy-td4313370.html](http://grails.1312388.n4.nabble.com/Plugins-application-properties-vs-BuildConfig-groovy-td4313370.html)

高温高压

# gzip - gzip 压缩 MBtiles 时平均会减少多少尺寸？

> ID：13864691
> 
> 赞同：1
> 
> 时间：2012-12-13T16:57:15.467
> 
> 标签：gzip, mapbox

作为检查一些先决条件的一部分（在本地存储上使用 MBtiles 支持离线地图的 IOS 应用程序[）](http://mapbox.com/developers/mbtiles/)，我想知道在将 MBtiles 传输到 IOS 设备时对它们进行 gzip 压缩是否有用。

换句话说，gzip 压缩 MBtile 时大小是否有用？（或者是 MBtile 格式，已经以某种方式打包，因此限制了 gzip 或其他打包程序的使用）。

如果是这样，我可以期望减少多少尺寸？（百分比球场）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T12:06:32.427

-rw-r--r-- 1 randycarver wheel 105484288 Apr 9 11:05 gc_40_16.mbtiles -rw-r--r-- 1 randycarver wheel 101777468 Apr 21 06:03 gc_40_16.mbtiles.gz

I'm seeing around 4% size reduction.

# java - Java 是否支持默认参数值？

> ID：13864692
> 
> 赞同：11
> 
> 时间：2012-12-13T16:57:16.860
> 
> 标签：java, methods, parameters, overloading, default-value

> **可能重复：** [Java 是否支持默认参数值？](https://stackoverflow.com/questions/997482/does-java-support-default-parameter-values)

假设我想在 C++ 中设置默认参数值，那么我们可以如下表示。

```
void functionName(char *param1, int param2=2); 
```

但是如果我想用 Java 做这个，那有可能吗。目前我正在做如下

```
public functionName(String param1)
{
    this(param1, 2);
}

public functionName(String param1, int param2)
{
..........
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-13T16:59:01.043

这是不可能的`Java`，但我们可以使用[Builder Pattern](http://en.wikipedia.org/wiki/Builder_pattern)，这就是 [Stack Overflow 的答案](https://stackoverflow.com/questions/222214/managing-constructors-with-many-parameters-in-java-1-4/222295#222295)。

如答案参考中所述，构建器模式允许您编写代码，例如

```
Student s1 = new StudentBuilder().name("Eli").buildStudent();
Student s2 = new StudentBuilder()
                 .name("Spicoli")
                 .age(16)
                 .motto("Aloha, Mr Hand")
                 .buildStudent(); 
```

其中一些字段可以有默认值或者是可选的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T16:58:10.843

不可以。Java 不支持此功能。

[Java 是否支持默认参数值？](https://stackoverflow.com/questions/997482/does-java-support-default-parameter-values)

# sql - 将 dbnull 转换为字符串。在数据库中记录 dbnull.value 而不是 Nothing

> ID：13864696
> 
> 赞同：1
> 
> 时间：2012-12-13T16:57:40.423
> 
> 标签：sql, vb.net, string, dbnull

我在 vb.net 中有一个使用参数查询的 insertRecord 函数。如果没有给出错误日期，我需要将 dbnull.value 插入 db 而不是 ""(Nothing)。

```
Dim strErrorDate2 As DateTime = Request.Form("dateOfErrorDatePicker2").ToString

.Add(New SqlParameter("@ErrorDate2", If(strErrorDate2 <> Nothing, strErrorDate2.Date, DBNull.Value))) 
```

我不断收到 dbnull 到字符串的转换错误。最初它有自己的 if/else 块，我在其中初始化了变量，但我不知道如何正确转换它。我尝试了内联 if，但我仍然需要进行转换或尝试其他方法。

有任何想法吗？问题是，当我将空字符串或 DateTime 插入数据库时​​，它会记录为可能的最小日期，例如 1900 年 1 月 1 日。

编辑：“不能推断出一个常见的类型，假设是‘对象’。” 这就是我目前遇到的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:28:03.293

这是因为 strErrorDate2.Date 是 DateTime 而 System.DbNull.Value 是一个对象。直接将 strErrorDate2 转换为 IF() 中的对象或执行类似的操作

```
Dim oErrorDate2 as Object = System.DbNull.Value

If strErrorDate2 <> Nothing Then oErrorDate = strErrorDate2

.Add(New SqlParameter("@ErrorDate2",oErrorDate2)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:46:35.690

这几乎肯定会发生，因为您的 SQL Server 端有什么。很可能您正在调用一个存储过程，该存储过程将 Null 替换为最小日期，或者（更有可能）您插入的表具有分配最小日期的触发器或默认列值当它为空时。

* * *

澄清一下：首先，您不必担心将 Nothing 转换为 DBNulls，ADO.net 应该为您做这件事。

其次，如果您发送 SQL Server Nothing/Null 并存储其他内容，那是因为它（表或存储过程）正在用默认值替换 NULL。这很可能是因为数据设计不希望 NULL 出现在您尝试将它们插入到的列中。

# jquery - jQuery Datepicker - 在选择框中显示完整的月份名称

> ID：13864700
> 
> 赞同：7
> 
> 时间：2012-12-13T16:58:06.850
> 
> 标签：jquery, jquery-ui, datepicker, jquery-ui-datepicker

jQuery datepicker 有一个用于更改月份的选择框，但它没有显示完整的月份名称（但在其他月份显示），这真的让我很烦恼。

**截图：http:** [//i.imgur.com/Pdkq0.png](https://i.imgur.com/Pdkq0.png)

有没有办法在不修改源代码的情况下自定义日期选择器以显示完整的月份名称？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-10-17T05:08:49.750

也许有点晚了，但我现在遇到了同样的问题，而且很容易解决。在调用 datepicker 函数之前，获取月份名称数组，将它们放入一个新变量中并通过调用该变量来更改短名称：

```
var fullmonth_array = $.datepicker.regional['nl'].monthNames; // change 'nl' to your own language of course
$('input[name="date-of-birth"]').datepicker(
{
   changeYear               : true,
   changeMonth              : true,
   yearRange                : "-85:-18",
   maxDate                  : "-18Y",
   minDate                  : "-85Y",
   monthNamesShort          : fullmonth_array
   // other stuff
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-25T14:55:02.080

更好的解决方案是`monthNames`从您的语言环境对象中使用。

```
// jQuery UI datepicker
$("#datepicker").datepicker({
    monthNamesShort: $.datepicker.regional["en"].monthNames
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T17:49:17.107

没有找到比更新 UI 日期选择器更好的方法，但这给了你这个想法：

[演示](http://jsfiddle.net/JgyDj/)

```
var months = ["January", "February", "March", "April", "May", "June",
                  "July", "August", "September", "October", "November", "December"];
var uDatepicker = $.datepicker._updateDatepicker;
$.datepicker._updateDatepicker = function() {
    var ret = uDatepicker.apply(this, arguments);
    var $sel = this.dpDiv.find('select');
    $sel.find('option').each(function(i) {
        $(this).text(months[i]);
    });
    return ret;
};

$(function() {
    $("#id").datepicker({
        changeMonth: true,
        dateFormat: 'MM yy'
    });
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-30T22:46:15.183

您可以扩展日期选择器并“覆盖”有问题的函数，传入长名称。

```
$.extend($.datepicker, {
    __base__generateMonthYearHeader: $.datepicker._generateMonthYearHeader,

    _generateMonthYearHeader: function (inst,
                                        drawMonth,
                                        drawYear,
                                        minDate,
                                        maxDate,
                                        secondary,
                                        monthNames,
                                        monthNamesShort) {
        return $.datepicker.__base__generateMonthYearHeader(
            inst,
            drawMonth,
            drawYear,
            minDate,
            maxDate,
            secondary,
            monthNames,
            monthNames)
    }
}); 
```

这样做的好处是在下拉列表中显示全名，但当输入元素设置为所选日期时，允许在设置/选项中指定格式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-08T07:30:05.213

//jquery UI 日期选择器

这里MM显示月份的全名

```
$("#datepicker").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd MM yy',
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-11T17:18:06.493

您可以将属性“ `monthNamesShort`”定义为：

```
 $(".selector").datepicker({
   monthNamesShort: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
 }); 
```

# textmate - 在 TextMate 的函数弹出窗口中显示 Docbook 章节标题

> ID：13864706
> 
> 赞同：0
> 
> 时间：2012-12-13T16:58:11.333
> 
> 标签：textmate, textmatebundles, textmate2

我正在为 DocBook 5 XML 制作一个捆绑包，其中经常包含以下内容：

```
<section>
  <title>This is my awesome Java Class called <classname>FunBunny</classname></title>
  <para>FunBunny is your friend.</para>
</section> 
```

我希望部分的标题出现在窗口底部的功能弹出窗口中。我使用以下捆绑项目部分工作。

语言语法：

```
{   patterns = (
    {   name = 'meta.tag.xml.docbook5.title';
        match = '<title>(.*?)</title>';
        /* patterns = ( { include = 'text.xml'; } ); */
    },
    {   include = 'text.xml'; },
);
} 
```

具有范围选择器的设置/首选项项目`meta.tag.xml.docbook5.title`：

```
{   showInSymbolList = 1;
symbolTransformation = 's/^\s*<title\s?.*?>\s*(.*)\s*<\/title>/$1/';
} 
```

这样做的最终效果是文档中的*所有*标题元素都匹配并出现在函数弹出窗口中，不包括`<title></title>`基于`symbolTransformation`.

我会对这么多功能感到满意，因为其他有趣的东西（如数字）往往有正式的标题，但有一个问题。

标签的内容`title`不会根据`text.xml`语言语法的其余部分进行解析和识别。上述语言语法中被注释掉的`patterns`部分并没有解决这个问题的预期效果——它把所有东西都放在了`meta.tag.xml.docbook5.title`范围内。

有没有办法在这里得到我想要的？也就是说，元素的内容`title`，可选地仅用于`section`标题，在函数弹出窗口中*并被*解析器识别为正常的 XML 内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T08:46:18.287

在 TextMate 语法中，如果您想“在匹配中匹配”，则需要使用开始/结束类型规则而不是匹配类型规则。（您实际上也可以使用匹配，但是您需要使用当前未记录的行为，仅适用于 TextMate 2）

```
{   patterns = (
    {   name = 'meta.tag.xml.docbook5.title';
        begin = '<title>';
        end = '</title>';
        patterns = ( { include = 'text.xml'; } ); 
    },
    {   include = 'text.xml'; },
);
} 
```

这具有允许`<title>...</title>`跨越多行的额外好处。

# sql - MS 访问选择特定数据单元格

> ID：13864708
> 
> 赞同：0
> 
> 时间：2012-12-13T16:58:14.080
> 
> 标签：sql, ms-access, vba

我有一个名为“name”的字段，我想遍历该字段并以一种形式获取每一行值，以便将其保存到 VBA 变量中。我在指定列和行并将其保存到 VBA 变量时遇到问题。谁能帮我这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:39:35.577

数据绑定表单具有`Recordset`. 它还有一个`RecordsetClone`，它是 的只读副本`Recordset`。

使用 VBA，您可以遍历 的行`RecordsetClone`并读取当前行中任何字段的值。大多数情况下，我们通过字段名称而不是字段的序号位置来指示我们要读取的字段，但您可以使用任何一种方式。

```
Dim rs As DAO.Recordset
Set rs = Me.RecordsetClone
rs.MoveFirst
Do While Not rs.EOF
    Debug.Print rs!id ' value of field named id '
    Debug.Print rs(0) ' value of first field in recordset '
    rs.MoveNext
Loop
Set rs = Nothing 
```

# javascript - textarea 模仿效果不佳。任何替代品？

> ID：13864711
> 
> 赞同：12
> 
> 时间：2012-12-13T16:58:30.090
> 
> 标签：javascript, html, css

我有这个 html 和 css：http: [//jsfiddle.net/b7rDL/6/](http://jsfiddle.net/b7rDL/6/)

HTML：

```
<div class="text-block" contenteditable="true" spellcheck="false">Some Text</div> 
```

CSS：

```
.text-block {
    resize: none;
    font-size:40px;
    border: none;
    line-height: 1;
    -moz-appearance: textfield-multiline;
    -webkit-appearance: textarea;
    min-width: 30px;
    overflow: visible;
    white-space: nowrap;
    display: inline-block;
} 
```

此代码允许我编写没有宽度限制或高度限制的文本。它不显示滚动条，并随文本增长。这些基本上是我需要的功能。

1.  如何将其转换为具有相同作用的常规文本区域？我希望这适用于未实现“contenteditable”的浏览器。因此，我想用 textarea 或其他基本元素替换 div。我该怎么做？（我不介意使用 JavaScript）。
2.  如何禁用拼写检查器？`spellcheck=false`不起作用。在示例中，当我专注于文本框时，我得到了那条错误的红线。我正在使用火狐。
3.  当我专注时如何摆脱边界？- 解决了

**我不介意使用 JavaScript 来解决这些问题。**

这些问题的任何答案都会对我有所帮助。

谢谢

更新：
@Oylex 帮了我 3

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:20:58.170

## #1

工作小提琴在这里：http: [//jsfiddle.net/d9H9w/11/](http://jsfiddle.net/d9H9w/11/)（在 IE8、Chrome 和 Firefox 中测试）

您需要在用户在文本框中键入时设置宽度和高度属性。

### 高度

这很简单：

1.  获取textarea的内容
2.  匹配换行符
3.  将高度设置为 em 中换行符的总数（第一行加一个，摆动空间加 1.5）。

在 em 中设置高度使这个字体大小不可知，因此它可以与多种字体大小一起使用。

```
function getNewlines(){
    // get the value(text) of the textarea
    var content = textEl.value;

    //use regex to find all the newline characters
    var newLines = content.match(/\n/g);

    // use the count of newlines(+1 for the first line + 1 for a buffer)
    // to set the height of the textarea.
    textEl.style.height = ((newLines && newLines.length || 0)+2.5)+'em';
}; 
```

### 宽度

这也相当容易，只需一个陷阱。

1.  获取textarea的内容
2.  拆分换行符以获得由 textarea 行组成的数组
3.  排序以获得最长的行
4.  将宽度设置为 em 中最长字符串的长度，*乘以大约 .6(我的代码中的 emRatio)*，再加上 2 个 em 作为缓冲区空间。

最后一部分是踢球者。'em' 测量值应该是一个正方形，表示单个字符占用的宽度和高度。这没有考虑字距调整，因此字符的高度通常是准确的，但宽度取决于它周围的字符。因此，通过猜测和检查，我发现 0.6 em 大约是字距调整后字符的平均宽度。.6 非常接近，所以我在宽度上添加 2 em 以获得一点缓冲空间。

```
var emRatio = .6;
function longestLine(){
    // get the value(text) of the textarea
    var content = textEl.value;

    // split on newline's. this creates an array, where each item in
    // the array is the text of one line
    var a = content.split('\n');

    // use a sorting function to order the items in the array:
    // longest string to shortest string
    a.sort(function(a,b){return b.length - a.length});

    // use the longest string * the emRatio to set the width
    // Due to kerning, the letters aren't ever really 1em x 1em
    // So I'm multiplying by an approximate ratio here (guess and check)
    textEl.style.width = (a[0].length * emRatio + 2)+ 'em';
}; 
```

### 此实现存在的问题

*   为了支持在长按按键期间调整大小，还必须包含一个 onkeydown 处理程序（这对于不包括长按键的所有情况都不是最佳的）

考虑到所有因素，我认为这符合您的需求。

**编辑**

我没有将 emRatio 设为 .7，而是将其更改为 .6，并在宽度上添加了 2 em 的缓冲区。这解决了@Naor 在他的评论中提到的两个问题。

我更新了小提琴链接和**宽度**部分以反映更改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T00:50:50.020

**编辑 0**

**请求 #1 更新**

工作解决方案：http: [//jsfiddle.net/7aeU2/](http://jsfiddle.net/7aeU2/)

jQuery

```
$(function() {
    //  changes mouse cursor when highlighting loawer right of box
    $("textarea").mousemove(function(e) {
        var myPos = $(this).offset();
        myPos.bottom = $(this).offset().top + $(this).outerHeight();
        myPos.right = $(this).offset().left + $(this).outerWidth();

        if (myPos.bottom > e.pageY && e.pageY > myPos.bottom - 16 && myPos.right > e.pageX && e.pageX > myPos.right - 16) {
            $(this).css({ cursor: "nw-resize" });
        }
        else {
            $(this).css({ cursor: "" });
        }
    })
    //  the following simple make the textbox "Auto-Expand" as it is typed in
    .keyup(function(e) {
        //  the following will help the text expand as typing takes place
        while($(this).outerHeight() < this.scrollHeight + parseFloat($(this).css("borderTopWidth")) + parseFloat($(this).css("borderBottomWidth"))) {
            $(this).height($(this).height()+1);
        };
    });
});​ 
```

**请求 #2 更新**

此外，这里很好地解释了为什么您不能完全禁用拼写检查。

> 这不属于 CSS 领域（这是可选的展示建议）。它不是关于呈现数据的风格特征，而是关于交互式处理数据。
> 
> 在支持“拼写检查”（可能涉及语法和样式检查）的浏览器上`spellcheck`，可在 JavaScript 中设置的 HTML 属性或相应的 IDL (DOM) 属性是有效的。
> 
> 在实践中，这些浏览器倾向于默认仅对 textareas 启用“拼写检查”，并且由于 textareas 通常包含人类语言文本，因此将其关闭听起来没什么用。在任何情况下，它都是用户可控的（用户可以将其关闭或选择语言）。

通过[https://stackoverflow.com/a/9209791/1085891](https://stackoverflow.com/a/9209791/1085891)

* * *

**请求 #1**

1.  **简单的解决方案**非常简单。

    工作示例：http: [//jsfiddle.net/b7rDL/12/](http://jsfiddle.net/b7rDL/12/)

    jQuery

    ```
    $("#Solution0").keyup(function(e) {   
        while($(this).outerHeight() < this.scrollHeight) {
            $(this).width($(this).width()+50);
        };
    }); 
    ```

    HTML

    ```
    <textarea id="Solution0" rows="1" style="height: 1.2em;"></textarea> 
    ```

2.  **如果您想要扩展宽度而不是高度，则需要一些更新的更**高级的解决方案。**不过，还是很不错的。**

     ***   [http://jsfiddle.net/edelman/HrnHb/](http://jsfiddle.net/edelman/HrnHb/)
    *   [https://github.com/ultimatedelman/autogrow](https://github.com/ultimatedelman/autogrow)** 
***   **其他解决方案**- 我知道这些都扩大了高度。如果您需要以下解决方案之一的宽度实施，请告诉我。

    *   [http://bgrins.github.com/ExpandingTextareas/](http://bgrins.github.com/ExpandingTextareas/)
    *   [http://blogs.sitepointstatic.com/examples/tech/textarea-expander/index.html](http://blogs.sitepointstatic.com/examples/tech/textarea-expander/index.html)
    *   [http://code.google.com/p/xautoresize-jquery/downloads/list](http://code.google.com/p/xautoresize-jquery/downloads/list)
    *   [http://www.impressivewebs.com/textarea-auto-resize/](http://www.impressivewebs.com/textarea-auto-resize/)
    *   [http://www.technoreply.com/autogrow-textarea-plugin-3-0/](http://www.technoreply.com/autogrow-textarea-plugin-3-0/)**

 ****请求 #2**

`spellcheck="true"`应该按照 Mozilla 文档中的描述工作[：控制 HTML 表单中的拼写检查](https://developer.mozilla.org/en-US/docs/HTML/Controlling_spell_checking_in_HTML_forms)。它适用于我在 Firefox 13.0.1 中运行的第一个简单示例。你运行的是什么版本？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T17:09:00.550

对于#3，您正在寻找的 css 选项是：`outline: none;`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-20T07:16:36.970

**请求 #2**

工作[演示](http://jsfiddle.net/b7rDL/19/)

```
<body spellcheck="false">
<div class="text-block" contenteditable="true">    
Some Text SpellCheck</div> 
```

嗨 Naor，这个东西的唯一问题是它会禁用标签中所有元素的***拼写检查。***`<body>`如果你没关系，那么你可以随它去。

你的问题真的很有趣，很有挑战性，真的很喜欢。我希望这可以帮助你..!!

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-22T20:18:27.737

`textarea`我在确定' 内容的范围时遇到了麻烦，因此通过这种方法`textarea`，我将 这处理宽度和高度。`p``float: left;``textarea``p`

我已经在 Mac 10.8.1 FF 18.0、Safari 6.0、Chrome 25.0.1362.0 canary、iOS Safari 6.0.1 和 iOS Simulator 5.1 (272.21) 上进行了测试。我手边没有 PC 或 IE。

[http://jsfiddle.net/b7rDL/34/](http://jsfiddle.net/b7rDL/34/)

HTML

```
<textarea id="tx" class="text-block" spellcheck="false"></textarea>
<p id="dupe" class="text-block"></p> 
```

CSS

```
.text-block {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    resize: none;
    font-size:14px;
    border: none;
    line-height: 1;
    min-width: 30px;
    overflow: hidden;
    white-space: pre;
    display: block;
    outline: none;
    width: 30px;
    height: auto;
    border: 1px solid #ddd;
    background-color: #f7f7f7;
}

#dupe {
    float: left;
    display: none;
    width: auto;
    height: auto;
} 
```

[我添加了背景和边框，所以我可以看到发生了什么。]

JavaScript

```
// no `var` so they are global and easier to work
// with in the inspector when using jsFiddle

$tx = $('#tx');
$dupe = $('#dupe');
lineH = Number($tx.css('line-height').replace('px',''));

update();

$tx.on('keydown', function() {
    setTimeout(update, 0);
});
$tx.on('propertychange input keyup change', update);

function update() {
    $dupe.text($tx.val());
    $tx.css({
        width: $dupe.width() + 7,
        height: $dupe.height() + lineH
    });
}

// not sure if this is needed, leaving it because
// I don't have many browsers to test on
 $tx.on('scroll', function() {
     tx.scrollLeft = 0;
     tx.scrollTop = 0;
 }); 
```

我在右侧和底部添加了额外的空间，因为它似乎以这种方式表现得更加一致。此外，在 HTML 中，`wrap="off"`对于我正在使用的 Firefox 版本，这是必需的。

[我从这篇博文](http://whattheheadsaid.com/2010/09/effectively-detecting-user-input-in-javascript)中得到了一些很好的建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-23T14:37:55.303

当我过去做了一些非常接近的事情时，对我来说最有效的方法是`div`使用与 textarea 完全相同的样式创建隐藏的流。而不是根据来自 textarea 的信息设置超时以更新其 html 源。这听起来有点吓人，但是，经过一些测试和玩耍，没有什么比这更好的了，这已经被建议了，所以只是我的变体。

[http://jsfiddle.net/f2gAD/16/](http://jsfiddle.net/f2gAD/16/)

和基于 jQuery 的脚本：

```
var textarea = $('textarea'),
    textBlock = $('div.text-block'),
    interval, value, freq = 10,
    doTextAreaAdjust = function(){
       textarea.css({
          height: textBlock.outerHeight(),
          width: textBlock.outerWidth()
       });
    };
doTextAreaAdjust();
textarea
.focus(function(){
    interval = window.setInterval(
        function() {
          value = textarea.val().replace(/(\r\n|\n|\r)/gm, '[rnnr]');
          value = value.replace(/</gm, '||'); // break html tags
          value = value.replace(/\[rnnr\]/gm, '<br>');
          value = value + '|'; // or <span>|</span> for better pixel perfect
          textBlock.html(value);
          doTextAreaAdjust();
        }, freq
    );console.log(interval);
})
.blur(function(){
    window.clearInterval(interval);
});
​ 
```

出于性能方面的考虑，它作为焦点/模糊的自启动/停止超时，尽管这里还需要一些解决方法。在 Chrome 中进行测试时注意到，如果您通过单击另一个选项卡进行模糊处理，则间隔不会正确停止。所以可能将自调用函数替换为`setTimeout`会更好。

它在 IE 7-8 中或多或少地工作正常，假设主要目标但仍然不时发生一些文本跳转，而对于其他人来说没关系，但猜测您将使用现代浏览器的可编辑功能。建议使用现代化器进行检测。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-12-17T10:58:21.777

在这里工作 [http://jsfiddle.net/H2GSx/](http://jsfiddle.net/H2GSx/)

此处代码：HTML：

```
<div style="overflow: scroll; width: 200px; height: 100px;">
    <div class="text-block" contenteditable="true" spellcheck="false">Some Text</div>
</div>​ 
```

CSS：

```
.text-block {
    resize: none;
    font-size:40px;
    border: none;
    line-height: 1;
    -moz-appearance: textfield-multiline;
    -webkit-appearance: textarea;
    min-width: 30px;
    overflow: visible;
    white-space: nowrap;
    display: inline-block;
}
​ 
```**

# tabs - 带有“下一步按钮”的 zurb-foundation 选项卡

> ID：13864718
> 
> 赞同：1
> 
> 时间：2012-12-13T16:58:53.093
> 
> 标签：tabs, zurb-foundation

我正在处理一个 3 步表单，并且需要能够将“下一步”按钮移动到下一个选项卡（同时相应地更改顶部的主选项卡）。关于如何为此设置 javascript 的任何想法？没有这方面的文档，我已经能够更改内容，但不能同时更改主选项卡。

[http://foundation.zurb.com/docs/tabs.php](http://foundation.zurb.com/docs/tabs.php)

例子：

```
<dl class="tabs">
  <dd class="active"><a href="#simple1">Step 1</a></dd>
  <dd><a href="#simple2">Step 2</a></dd>
  <dd><a href="#simple3">Step 3</a></dd>
</dl>
<ul class="tabs-content">
  <li class="active" id="simple1Tab">
    <p>Step 1</p>
    <a class="button" href="#simple2">Next Step »</a>
  </li>
  <li id="simple2Tab">
    <p>Step 2</p>
    <a class="button" href="#simple3">Next Step »</a>
  </li>
  <li id="simple3Tab">
    <p>Step 3</p>
  </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T22:07:28.057

可能有更好的方法来做到这一点......但我只是使用以下作为解决方法......

```
$('#formnextbutton').click(function () {  $("#tabbutton").click() }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-15T13:13:42.297

也许不会好多少，但它更有活力。

```
$(".tabs .active + dd > a").click() 
```

# jquery - 如何使单选按钮看起来像切换按钮

> ID：13864719
> 
> 赞同：0
> 
> 时间：2012-12-13T16:58:53.543
> 
> 标签：jquery, html, css, radio-button, togglebutton

我正在尝试像切换按钮一样设置单选按钮的样式。我想跨浏览器做，所以我猜 jquery 是唯一的选择（CSS3 属性：checked 对我来说不是一个选项）

我知道有很多已发布的解决方案，但我不能直接使用其中任何一个，因为我无法更改任何 HTML 代码（它是由 Drupal 创建的）。

我尝试为我的 HTML 调整不同的解决方案（例如[https://stackoverflow.com/a/9376041](https://stackoverflow.com/a/9376041)和[CSS change active select for radio](https://stackoverflow.com/q/13135942)），但我不知道 javascript，我无法让它们工作。

我的 HTML 是：

```
<div id="edit-status" class="form-radios">
<div class="form-item form-type-radio form-item-status">
<input type="radio" id="edit-status-0" name="status" value="0" class="form-radio"/>
<label class="option" for="edit-status-0">Bloqueado</label>
</div>
<div class="form-item form-type-radio form-item-status">
<input type="radio" id="edit-status-1" name="status" value="1" checked="checked" class="form-radio"/>
<label class="option" for="edit-status-1">Activo</label>
</div>
</div> 
```

如果有人能给我 Jquery 代码，我将不胜感激（我知道 CSS，所以这部分不是问题）。

编辑：**我需要 Jquery 为所选单选按钮的标签提供一个类，**以便将其样式设置为与未选择单选按钮的标签不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:42:43.827

这是你想要的吗？

[http://jsfiddle.net/aS69U/7/](http://jsfiddle.net/aS69U/7/)

```
.form-radios {
    display: block;
    float: left;
    -moz-border-radius: 6px;
    -webkit-border-radius: 6px;
    border-radius: 6px;
    font-weight: bold;
    text-transform: uppercase;
    background: #eee;
    border: 1px solid #aaa;
    padding: 2px;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
    margin-left: 20px;
}

.form-radios input[type=radio] {
    display: none;
}

.form-radios label     {
    display: block;
    float: left;
    padding: 3px 6px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    color: #aaa;
    cursor: pointer;
}

.form-radios label:hover {
    text-shadow: 0 0 2px #fff;
    color: #888;
}

.form-radios label.checked {
    background: #8fc800;
    color: #eee;
    text-shadow: 0 -1px 1px rgba(0,0,0,0.5);
    background: -webkit-linear-gradient(top, #8fc800, #438c00);
    background: -moz-linear-gradient(top, #8fc800, #438c00);
    background: -ms-linear-gradient(top, #8fc800, #438c00);
    cursor: default;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:34:56.730

大多数表单控件由操作系统呈现，而不是浏览器。样式`radio`、、输入和选择`checkbox`的能力非常有限。如果不求助于基于 Javascript 的解决方案，确实没有可靠的跨浏览器方法来做你想做的事。单靠 CSS 不能做你想做的事。`file``options`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:42:51.977

JS：

```
$('label.option').click(function(){
    $('.form-item input[type=radio]').attr('checked',null);
    $('label.option').removeClass("checked");
    $(this).prev().attr('checked',"checked");
    $(this).addClass("checked");
}) 
```

CSS：

```
.form-item.form-type-radio.form-item-status{
   display:inline-block;        
}

.form-type-radio input[type=radio]
{
    display: none;
}

 .checked{
  background:#F00;
 } 
```

简而言之。

[http://jsfiddle.net/camus/pLfvS/](http://jsfiddle.net/camus/pLfvS/)

# garbage-collection - solaris10/weblogic10 内存和 -d64 提升

> ID：13864721
> 
> 赞同：1
> 
> 时间：2012-12-13T16:59:01.247
> 
> 标签：garbage-collection, jvm, permgen, solaris-10

放入`-d64`Liferay 5.2、weblogic 10 over Solaris 环境有什么影响？在该设置中选择`Xms=Xmx=8GB`和有什么影响。`PermGen=1g`

[亲身体验：我偶尔会看到一些 Null 异常，但应用程序已启动并且我没有看到问题数据，或视觉上。这是一个测试环境，而不是任何生产环境。]

感谢您的任何评论

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:24:13.383

这些选项会影响性能，因此不会对您的应用程序产生任何功能影响。

`-d64`解释：[-d64 开关对 Sun JVM 常驻内存使用有什么影响（如果有的话）？](https://stackoverflow.com/questions/1443677/what-impact-if-any-does-the-d64-swtich-have-on-sun-jvm-resident-memory-usage)

`Xms=Xmx=8GB, PermGen=1g`：这些是堆大小设置，这些会影响 GC 算法的运行时间。

# css - 通用选择器 CSS

> ID：13864727
> 
> 赞同：0
> 
> 时间：2012-12-13T16:59:13.213
> 
> 标签：css

在 CSS 通用选择器中设置许多元素的某些属性是一个好习惯吗？我的意思是，例如：

```
* {margin: 0; padding: 0;} 
```

也许默认值是合乎逻辑的，我们不应该在一行中全部更改它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:03:36.060

通用选择器适用于故障排除。如果绝对难倒导致溢出问题的元素，我会这样做`* {border:1px solid pink}`。完成故障排除后，请务必删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T21:10:57.030

通用选择器的这个问题是您将删除某些元素上的一些潜在有用的浏览器默认值，只是为了稍后必须显式添加它们。

换句话说，用户将不得不下载一个 CSS 样式来将填充或边距放回一个已经完全可以接受的填充或边距而无需任何下载的元素。

如果您希望使元素在所有浏览器中呈现相同，我建议您查看[normalize.css](http://necolas.github.com/normalize.css/)，它试图尽可能多地保留浏览器默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T18:00:01.950

通用选择器确实会导致性能问题，因此请尽量避免它。

# asp.net - 从输出流打开文件

> ID：13864733
> 
> 赞同：0
> 
> 时间：2012-12-13T16:59:26.503
> 
> 标签：asp.net, vb.net, excel, response, filestream

我正在尝试保存我的图表图像，以便可以将其放入使用 epplus 创建的 excel 文件中

```
Response.ContentType = "image/bmp"
    Response.AppendHeader("Content-Disposition", "attachment;filename=chart.bmp")
    Chart1.SaveImage(Response.OutputStream)

    Dim imgchart As Bitmap
    imgchart = New Bitmap("chart.bmp")

Using package As New ExcelPackage(newFile)
        ' add a new worksheet to the empty workbook
        Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets.Add("LIMS")
        'Add the headers
        worksheet.Cells(1, 1).Value = "Analyzer Time"
        worksheet.Cells(1, 2).Value = "Analyzer Data"
        worksheet.Cells(1, 3).Value = "Lab Date"
        worksheet.Cells(1, 4).Value = "Lab Data"
        Dim row
        row = 2
        For i = 0 To count1 - 1
            worksheet.Cells(row, 1).Value = col1(i)
            worksheet.Cells(row, 2).Value = col2(i)
            row = row + 1
        Next
        row = 2
        For i = 0 To labcount - 1
            worksheet.Cells(row, 3).Value = col3(i)
            worksheet.Cells(row, 4).Value = col4(i)
            row = row + 1
        Next

        worksheet.Drawings.AddPicture("chart", imgchart)
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        Response.AppendHeader("Content-Disposition", "attachment;filename=chart.xlsx")
        package.SaveAs(Response.OutputStream)

        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        Response.AppendHeader("Content-Disposition", "attachment;filename=chart.xlsx")
        Response.WriteFile("chart.xlsx")
        Response.End()
    End Using 
```

我需要在此代码中修复什么？我是文件流和响应的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:29:08.593

乍一看，我认为您犯了几个错误。首先，您似乎正在尝试通过响应发送图像和 excel。我不相信您可以将多个文件发送给客户端，但无论如何您都不需要发送图像，因为您只是将其插入到 excel 文件中。此外，您尝试从不存在的服务器文件“chart.bmp”加载位图的图像。其次，您正在使用`Response.WriteFile`将磁盘文件写入响应的功能。我猜这不是您想要做的，因为您已经将文件写入响应中`Package.SaveAs`。试试下面的代码，

```
 'Save the chart to a memory stream instead of a file 
    Dim BitMapMS As New MemoryStream
    Chart1.SaveImage(BitMapMS)
    'Load bitmap from memory stream
    Dim imgchart As Bitmap
    imgchart = New Bitmap(BitMapMS)

Using package As New ExcelPackage(newFile)
        ' add a new worksheet to the empty workbook
        Dim worksheet As ExcelWorksheet = package.Workbook.Worksheets.Add("LIMS")
        'Add the headers
        worksheet.Cells(1, 1).Value = "Analyzer Time"
        worksheet.Cells(1, 2).Value = "Analyzer Data"
        worksheet.Cells(1, 3).Value = "Lab Date"
        worksheet.Cells(1, 4).Value = "Lab Data"
        Dim row
        row = 2
        For i = 0 To count1 - 1
            worksheet.Cells(row, 1).Value = col1(i)
            worksheet.Cells(row, 2).Value = col2(i)
            row = row + 1
        Next
        row = 2
        For i = 0 To labcount - 1
            worksheet.Cells(row, 3).Value = col3(i)
            worksheet.Cells(row, 4).Value = col4(i)
            row = row + 1
        Next

        worksheet.Drawings.AddPicture("chart", imgchart)

        'Clear the response
        Response.Clear()
        Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"            
        Response.AppendHeader("Content-Disposition", "attachment;filename=chart.xlsx")
        'This call looks like it will write the data to the stream.
        package.SaveAs(Response.OutputStream)

        Response.End()
    End Using 
```

我无法测试上面的代码，所以试一试，让我们知道它是怎么回事。

# python - 从 Python 2.7 升级到 3.3 后代码不再有效

> ID：13864735
> 
> 赞同：0
> 
> 时间：2012-12-13T16:59:37.307
> 
> 标签：python

我开始使用 Python 3.3 而不是 2.7，我用来重新启动或关闭程序的一些代码行存在问题。

```
def restart_program(): 
    python = sys.executable
    os.execl(python, python, * sys.argv)

if __name__ == "__main__":
    answer = input("Restart or close program    ")
    if answer.strip() in "Restart restart".split():
        restart_program() 
```

当我使用它时，我收到以下错误：

```
Fatal Python error: PyEval_RestoreThread: NULL tstate
Current thread 0x00002030:
File "C:\Python33\lib\os.py", line 531 in execl
File "C:\Users\user\desktop\filename", line 66 in restart_program 
```

第 66 行是

```
os.execl(python, python, * sys.argv) 
```

我不知道如何解决这个问题，我真的希望有人有解决方案。

如果我像下面的代码那样写一些非常简单的东西，那么它就没有问题了。

```
import math
import os
import sys

a = input ("enter a")
a = float (a)
b = 12

x = a+b
print (x)

def restart_program(): 
    python = sys.executable
    os.execl(python, python, * sys.argv)

if __name__ == "__main__":
    answer = input("Restart or close the program    ")
    if answer.strip() in ["Restart", "restart"]:
        restart_program() 
```

我想我也可以在这里添加我的整个代码。

[http://pastebin.com/fM8s0iiw](http://pastebin.com/fM8s0iiw)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:51:43.660

尝试注释掉`Popen`电话，看看事情是否清理干净。不过，这确实不是打开文件的好方法，因为它只能在 Windows 上运行，并且只有在您为 png 文件设置了文件关联的情况下。

我敢打赌，Python 3 对于离开孤立流处理程序或其他东西的宽容度不如 2，因此吹走父进程会导致子进程窒息。如果注释掉您的问题，请尝试跟踪您创建的所有孩子并在调用`Popen`之前明确杀死它们。`execl`

# .net - 在 Windows 服务中托管的 WCF 双工会话中处理服务关闭

> ID：13864736
> 
> 赞同：2
> 
> 时间：2012-12-13T16:59:39.140
> 
> 标签：.net, wpf, vb.net, wcf

我有一个托管 WCF 服务的 Windows 服务，该服务向多个客户端广播信息。我想从客户端优雅地处理服务关闭，即检测到服务已经消失或想要关闭，弹出一条消息并关闭应用程序。目前，如果我在关闭行关闭服务，我会得到以下信息。

“ServiceHost 关闭操作在 00:00:09.9910000 之后超时。这可能是因为客户端未能在所需时间内关闭会话通道。”

问题：如何检测关闭请求并关闭客户端？

在客户端上关闭服务后，我得到“发生套接字异常，现有连接被远程主机强行关闭”

这是关闭代码。

```
If Not (_LivePricingHost Is Nothing) Then
    _LivePricingHost.Close()
    _LivePricingHost = Nothing
End If 
```

这是我用来设置双工会话的类，我删除了样板处理代码和我向客户端提出的事件。

```
Imports System.ServiceModel

Public Class NotificationCallback
    ' Implements LivePricingService.IMessageCallback
    Implements IDisposable

    Private _ns As LivePricingService.MessageClient

    Public Sub New()
        Dim context = New InstanceContext(Me)

        _ns = New LivePricingService.MessageClient(context)
        _ns.SubscribeForBroadcast()
        '    _ns.AddMessage("PING")
    End Sub

 #End Region 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T20:00:44.163

解决方案是在回调接口中添加一个“取消订阅”方法。然后客户端可以取消订阅。因此，当服务停止时，它会要求客户端断开连接。

```
 Protected Overrides Sub OnStop()
        pollTimer.Stop()
        _LivePricingWCFService.UnsubscribeAll()
        If Not (_LivePricingHost Is Nothing) Then
            _LivePricingHost.Close()
            _LivePricingHost = Nothing
        End If
    End Sub 
```

在 WCF 服务上

```
 Public Sub UnsubscribeAll()
        Try
            RemoveClosedSubscribers()

            For Each callback As IMessageCallback In _subscribers
                If DirectCast(callback, ICommunicationObject).State = CommunicationState.Opened Then
                    callback.ShutDown() 'request that the client disconnect
                    _subscribers.Remove(callback)
                End If
            Next
        Catch ex As Exception
            Logging.Logger.LogMessage(ex:=)
        End Try
    End Sub 
```

并在客户端

```
Public Sub ShutDown() Implements LivePricingService.IMessageCallback.ShutDown
    _ns.Close()
    Globals.LastException = New Exception("The Live Pricing Serice has shut down.")

End Sub 
```

# acl - 使用 Google Cloud Storage 中文件夹的 ACL 时出现问题

> ID：13864737
> 
> 赞同：1
> 
> 时间：2012-12-13T16:59:39.507
> 
> 标签：acl, google-cloud-storage, gsutil

我在 Google Cloud Storage 的文件夹中创建了一个对象，其中包含以下 OptionsBuilder 对象：

```
GSFileOptionsBuilder optionsBuilder = new GSFileOptionsBuilder()
  .setBucket("bucket")
  .setKey("folder/obj.csv")
  .setMimeType("text/csv"); 
```

制作下一个结构：

存储桶 >> 文件夹 >> obj.csv

当我运行 gsutil 命令以获取“bucket”和“obj.csv”的 ACL 时工作正常，但是当我为“文件夹”执行它时会引发此异常：GSResponseError: status=404, code=NoSuchKey, reason=Not Found。

我运行的确切命令是：gsutil getacl gs://bucket/folder/ > acl.txt

如何获取和设置文件夹的权限？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T17:55:40.703

您只能检索对象或存储桶的 ACL。GCS 中没有“文件夹”之类的东西，因此您无法设置或获取文件夹的 ACL。我建议您仔细阅读开发人员指南的[概念和术语](https://developers.google.com/storage/docs/developer-guide#concepts)部分。特别是关于对象名称的部分：

> 对象名称
> 
> 对象名称只是 Google Cloud Storage 的元数据。对象名称可以包含长度小于 1024 字节的 Unicode 字符（UTF-8 编码）的任意组合。包含在文件名中的常见字符是斜杠 (/)。通过在对象名称中使用斜线，您可以使对象看起来好像存储在分层结构中。例如，您可以将一个对象命名为 /europe/france/paris.jpg 并将另一个对象命名为 /europe/france/cannes.jpg。当您列出这些对象时，它们似乎位于基于位置的分层目录结构中；但是，Google Cloud Storage 将对象视为没有任何层次关系的独立对象。

# wordpress - WooCommerce 仅显示登录客户的支付网关

> ID：13864738
> 
> 赞同：1
> 
> 时间：2012-12-13T16:59:41.260
> 
> 标签：wordpress, payment-gateway, woocommerce

我正在使用 Wordpress 和 WooCommerce 建立一个电子商务网站。我们正在使用 wordpress 会员帐户来跟踪客户信息，我们需要一种方法让登录的会员*只能*选择“赊账”购买他们的购物车，这意味着下订单不需要付款。基本上我所做的是劫持“检查”选项（因为我们在其他任何地方都不需要它）并将其重命名为“信用”，因为它允许我们需要的功能。

但是，我需要一种方法让“信用”（检查）选项仅在用户登录时显示。如果用户未登录，有什么方法可以“取消挂钩”这个选项？这似乎很容易做到，但我找不到任何关于它的东西。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-12T10:07:41.253

由于 WooCommerce 的变化（至少从 WooCommerce 2.1.7 开始，可能之前），这个问题的原始答案（来自 BWDesign）不再有效。现在可以解决问题（在 2.1.7 和 2.1.8 上测试），将其添加到例如您的 functions.php 文件中：

```
add_filter( "woocommerce_available_payment_gateways", "rp_filter_gateways", 9999 );

function rp_filter_gateways($args) {
 if(!is_user_logged_in() && isset($args['cheque'])) {
  unset($args['cheque']);
 }
 return $args;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:45:09.820

我刚刚找到了解决方案。在`class-wc-cheque.php`文件中，检查或“支票”（疯狂的英国人）选项使用 `add_filter('woocommerce_payment_gateways', 'add_cheque_gateway' );`. 所以解决方案只是将此代码添加到我的`functions.php`文件中：

```
 if(!is_user_logged_in()){
     remove_filter('woocommerce_payment_gateways', 'add_cheque_gateway' );
 } 
```

希望这可以帮助！

# intellij-idea - 如何在 IntelliJ 中指定单独的 workspace.xml 文件

> ID：13864745
> 
> 赞同：1
> 
> 时间：2012-12-13T16:59:45.287
> 
> 标签：intellij-idea, centos

我在 CentOS 上的 IntelliJ 中打开同一个项目的两个实例。我按照[这里找到的建议](https://stackoverflow.com/questions/5889413/start-two-instances-of-intellij-ide)

效果很好，但是现在我有两个 IntelliJ 实例共享同一个 workspace.xml 文件，这意味着他们都一直认为该文件正在从它们下面发生变化（确实如此）。有没有办法在启动 IntelliJ 时指定 workspace.xml 文件的位置？这样我就可以为每个实例创建一个单独的 workspace.xml。

# php - wordpress/php 重定向停止工作

> ID：13864746
> 
> 赞同：0
> 
> 时间：2012-12-13T16:59:50.177
> 
> 标签：php, wordpress, header

现在在这个问题上挣扎了一段时间。在电子商务插件上，用户购买后，分析代码被插入，然后用户被重定向。问题是结帐卡在白页上，我在页面源代码中只能看到分析代码。我假设在重定向发生之后，它会引发一个标头已发送错误。这是页面的视图源：

```
<script type='text/javascript'>

    var _gaq = _gaq || [];

    _gaq.push(['_setAccount', 'UA-XXXXX-X']);

    _gaq.push(['_setDomainName', 'domain.com']);

    _gaq.push(['_trackPageview']);

        _gaq.push(['_addTrans',
        '61',                                     // order ID - required
        'outdoor-om™', // affiliation or store name
        '9.95',   // total - required
        '0.00',              // tax
        '0.00',         // shipping
        'St Petersburg',                  // city
        'Missouri',                 // state or province
        'US'                // country
    ]);

_gaq.push(['_addItem','61','','XYT','Fresh','9.95','1']);

_gaq.push(['_trackTrans']);

(function() {

        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;

        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

      })();

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:17:56.210

该页面上似乎没有任何内容试图进行重定向。您应该得到一个白页（因为没有 HTML 输出）。

如果你想使用 PHP`header()`函数重定向，你不能向客户端发送任何输出。

您可能应该将您的谷歌分析代码放在上一页或下一页，而不是这个间歇性页面。

或者，您可以在此页面上放置一个 javascript 重定向，但对我来说，这里的整个工作流程似乎有点奇怪。Typcailyl 只需在他们的结账成功页面上对 Google 分析进行交易记录调用。

# java - 在我们的工作环境中使用 GIT 的最佳方式是什么？

> ID：13864753
> 
> 赞同：0
> 
> 时间：2012-12-13T17:00:20.843
> 
> 标签：java, eclipse, git, version-control, egit

我们目前不使用任何类型的版本控制软件。我们最近开始使用 Eclipse，我们的源代码保存在网络驱动器上。创建了一个 Eclipse 项目，每个人都已将项目导入到他们机器上的 Eclipse 中。由于我们的设置方式，我们总是整天陷入清理/构建循环，这会损害生产力。

我们想开始使用某种 VCS（很可能是 GIT）。我正在设想一个集中的工作流程，每个开发人员在他/她的机器上都有一个本地代码副本。我们宁愿将 GitHub Enterprise 用于共享存储库，而不是将代码托管在 GitHub 上。

我不太确定从哪里开始正确设置此设置。我一直在看视频和阅读教程，但似乎没有一个直接适用于我们想做的事情。GIT 是否适合用于我们想要的设置类型？此外，清理/构建如何与 Eclipse 以及本地副本与共享存储库一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:05:56.727

首先，观看[此视频](https://www.youtube.com/watch?v=ZDR433b0HJY)。

其次，如果你使用 Eclipse，你会想要使用`EGit`. 非常详细的教程[在这里](http://wiki.eclipse.org/EGit/User_Guide)。

第三，不要投身于 GIT。在某些时候考虑 SVN（在 GIT 上记录之后）。也许中央版本控制系统会比分布式版本控制系统做得更好。

**编辑：**

[哦，顺便说一句……这里](https://stackoverflow.com/questions/871/why-is-git-better-than-subversion)有一个关于这个话题的冗长而著名的问答。祝你好运。

**第二次编辑：**

至于`SVN`，[在这里你有一个简单的](http://www.cs.wustl.edu/~roger/132/HelpDocs/Subversive/subversive.htm)**Subversive**教程，[在这里](http://www.eclipse.org/subversive/documentation/)你可以找到完整的 Subversive 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T20:47:58.217

我会[在共享驱动器上创建一个 git 存储库](http://www.gitguys.com/topics/creating-a-shared-repository-users-sharing-the-repository/)，你根本不需要像 github 这样的服务器。设置完成后，开发人员可以从共享驱动器克隆到他们的本地计算机，并在完成后将更改推送回来。

每个开发人员最终都会得到一份代码的本地副本，他们在其中拥有自己的构建环境，并且不再以彼此的方式存在。

从一个仅包含一些文件的示例项目开始并尝试使用它，因为您需要获得一些版本控制系统的经验。还要学习 git 命令行工具（对于 windows 使用[msysgit](http://msysgit.github.com/)），因为互联网上的大多数示例都是为这些工具编写的。有关 git 的更多信息，请务必阅读免费的 git 书籍： http: [//git-scm.com/book](http://git-scm.com/book)

另请参阅[有关](https://stackoverflow.com/questions/5200181/how-to-git-clone-a-repo-in-windows-from-other-pc-within-the-lan)在 Windows 共享上使用 git 的问题：[How to git clone a repo in windows from other pc on the LAN?](https://stackoverflow.com/questions/5200181/how-to-git-clone-a-repo-in-windows-from-other-pc-within-the-lan)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T19:44:26.313

你现在有你的需要，但你的需要会改变。省去以后从 SVN 迁移到 Git 并从 Git 开始的麻烦。以下是使用 Git 而不是 Subversion 的原因：

1.  速度 - Git 更快
2.  磁盘空间 - Git 历史*很小*。大多数时候它占用了 SVN 历史空间的 1/10。
3.  无服务器 - DVCS 不允许管理员，您可以完全跳过集中式服务器。您的中央存储库可以只是网络共享上的文件。
4.  完整性 - 数据损坏非常容易检测和纠正。
5.  快照历史记录 - 为每个版本制作整个项目的快照。没有与版本混合和匹配的路径。
6.  开源依赖项——您可能想要使用的大多数项目都在 Github 上。您可以轻松地添加一个子模块和该依赖项的版本。
7.  力量：
    *   git bisect - 快速找到引入错误的地方
    *   rerere - 如果再次出现冲突，请重用您解决冲突的方式
    *   支持任何工作流程
    *   适当的 3 路合并 - 这将在未来省去很多麻烦
    *   变基 - 你可以保持你的历史线性，即使在有人合并之后

我的最后一点非常重要。您现在才刚刚开始使用源代码管理。从最佳选择开始。您正处于对自己的需求了解最少的地步。你认为你现在不需要的东西，你以后会需要 - 保证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T17:08:05.550

GIT 无疑是首选方式，并且与 Eclipse IDE 完美集成。但是您也可以使用 Subversion，因为您想要的只是用户机器上的本地代码副本（称为 subversion 分支）。我说首选方式是因为 GIT 太灵活了：离线提交、代码体的完整副本与分支等......列表太长了。

正如你提到的，你也可以使用 github。大致来说，步骤如下：

1.  只需注册即可
2.  创建一个存储库。
3.  获取存储库的链接并将其指向 Eclipse 中的新 git 存储库
4.  推送您的代码。提交它。

您将在 github 中拥有您的代码文件。如果您在 Eclipse 中安装了 Git，这将起作用。我相信 Eclipse Juno 已经安装了 EGit（Git 插件）

为了解决构建问题，您可以使用设置一些持续集成工具，例如 Jenkins。这也可以设置为 Eclipse 插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T17:03:30.210

[用于 Eclipse 的 EGIT](http://www.eclipse.org/egit/)是将 git 集成到 Eclipse 项目环境中的好方法。

另外，如果你在windows上，你可以下载[Github for Windows](http://windows.github.com/)，真的很简单，用起来很有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T19:55:42.833

正如一些人已经指出的那样，有问题

> 使用 GIT 的最佳方式？

在您的情况下（零 SCM 经验）**，最佳和公平公正的答案**将是

## 根本不要使用 Git！

与“为什么 Git 比 Subversion 更好？”相反。您还可以阅读的主题（快速回忆的一些子集）

*   [GIT - 版本控制新手应该注意哪些问题？](https://softwareengineering.stackexchange.com/questions/114249/git-what-gotchas-should-newcomers-to-version-control-be-aware-of)
*   [SVN 在哪些方面比 git 做得更好？](https://softwareengineering.stackexchange.com/questions/111633/what-does-svn-do-better-than-git)
*   [学习和理解 Git 的先决条件是什么？](https://stackoverflow.com/questions/9715410/what-are-pre-requisites-for-learning-understanding-git)

[并检查git 标签](https://stackoverflow.com/questions/tagged/git)下的其他主题，并带有*多个 Git 男孩的感叹*。

虽然 Subversion 是相当不错的选择（无论如何都有一些边角：即使您*认为*开发是线性的，您也可能陷入“合并地狱”：某些分支可能而且*必须*发生，进入具有著名的“树冲突”错误的“重构噩梦” ...）您可以考虑“可用作 Subversion 并且比 Git 更强大”的替代方案（即使您只使用所需的小部分或整体功能）： - Mercurial “具有人脸的 DVCS，**由软件工程师为软件工程师制作**，不适合时髦的人”。

*   [MercurialEclipse](https://bitbucket.org/mercurialeclipse/main/)是 Eclipse 请求的答案（在[Aragost 推荐](http://aragost.com/mercurial/eclipse/)Mercurial 用户信任中）
*   [TortoiseHG](http://tortoisehg.bitbucket.io/)是*用户友好的*跨平台 GUI，可满足 Eclipse 之外的所有 Mercurial 需求
*   Mercurial 服务器比同等的 Git 服务器需要更少的麻烦（尤其是“在 Windows 下”）
*   Mercurial**真正的专家**很容易找到（而 Git-boys 是更有趣的青少年俱乐部）

# javascript - Intranet 站点的 IE9 兼容模式具有错误的用户代理字符串

> ID：13864754
> 
> 赞同：5
> 
> 时间：2012-12-13T17:00:30.207
> 
> 标签：javascript, jquery, internet-explorer, view, compatibility

我在一个大项目中工作，我们必须确定用户是否在 IE 中使用兼容性视图。
我正在使用这段代码来做到这一点。

```
var agentStr = navigator.userAgent;
var mode = null;
if (agentStr.indexOf("Trident/5.0") > -1) {
    if (agentStr.indexOf("MSIE 7.0") > -1)
        mode = "IE9CV";
    else
        mode = "IE9";
} else if (agentStr.indexOf("Trident/4.0") > -1) {
    if (agentStr.indexOf("MSIE 7.0") > -1)
        mode = "IE8CV";
    else
        mode = "IE8";
} else
    mode = "IE7"; 
```

它工作得很好，问题是：
1 - 在 INTRANET 环境中，在客户端的浏览器中选中了“在兼容性视图中显示 Intranet 站点”选项，对此我无能为力
![兼容性视图](../Images/a99e7545e0e55dce59d4676d007e9e22.png)

2 - 脚本检测兼容性视图不会有问题，但我不知道为什么，如果页面在 IE 9**兼容性视图上加载，我收到的用户代理是下面这个**

```
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0) 
```

与加载**IE9**的页面**相同**

 **```
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0) 
```

虽然我会收到

```
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0) 
```

对于 IE9 兼容性视图。
当我强制 IE9 兼容性视图（如预期的那样）时，我得到了最后一个结果，但是当它自行加载时，我得到的用户代理与 IE9 标准发送给我的用户代理相同。所以我想不出一种方法来确定用户是否具有 IE9 标准视图或兼容性视图。

我不知道我是否说清楚了，但它看起来像一个很大的 IE 错误。
我应该如何进行？有没有人也遇到过这个问题？

这是模拟情况的屏幕： ![兼容性视图](../Images/fd52ee246bcf09bb398b370bbb0ef04e.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-13T17:08:36.497

兼容模式几乎无处不在！:)

但是，尽量不要检测浏览器代理，因为它很容易被愚弄并且通常不可靠，而是尝试“特征检测”。

您可以使用一些库来执行此操作

*   [现代化](http://modernizr.com/)
*   [哈斯](http://davidwalsh.name/hasjs)

编辑：如果您的要求是阻止用户访问启用了兼容性视图的站点，您可以使用`<META> tag / HTTP header.`禁用该模式。浏览此处获取更多信息。

[http://blogs.msdn.com/b/ie/archive/2008/08/27/introducing-compatibility-view.aspx](http://blogs.msdn.com/b/ie/archive/2008/08/27/introducing-compatibility-view.aspx)

[http://blogs.msdn.com/b/ie/archive/2008/06/10/introducing-ie-emulateie7.aspx](http://blogs.msdn.com/b/ie/archive/2008/06/10/introducing-ie-emulateie7.aspx)**

# iphone - 自定义 iOS 键盘的外观

> ID：13864757
> 
> 赞同：5
> 
> 时间：2012-12-13T17:00:39.613
> 
> 标签：iphone, ios, ios6

我该怎么办？我想保留键盘的所有功能（拼写检查、能够更改语言等），但我想自定义按钮和背景的外观和感觉。

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:05:40.853

您可能得到的最接近的方法是按照[此处的教程进行操作](http://iphonedevsdk.com/forum/iphone-sdk-tutorials/7350-adding-subviews-custimize-keyboard.html)

请注意，这是一项相当复杂的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:10:22.403

对于简单的功能，您始终可以使用文本字段属性。

![在此处输入图像描述](../Images/4b32ef0fba415edbebaaf3a8320b4b29.png)

对于自定义的东西检查[这个问题](https://stackoverflow.com/questions/4643167/iphone-objc-how-to-create-a-custom-keyboard)

和

[这个链接](http://blog.carbonfive.com/2012/03/12/customizing-the-ios-keyboard/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T10:00:44.017

我认为这可以帮助您了解键盘的外观和背景

[https://github.com/caydenliew/CLKeypad](https://github.com/caydenliew/CLKeypad)

# jquery - 由 JS 生成时内联 SVG 不呈现

> ID：13864758
> 
> 赞同：0
> 
> 时间：2012-12-13T17:00:42.297
> 
> 标签：jquery, mobile, svg, inline, render

我想在 jQuery 移动页面中实现一些可视化统计信息。如果我嵌入以下代码段，它将向我显示与从单独的 *.svg 文件中嵌入它相同的结果。

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="115" width="100%">
<rect x="0%" y="0" fill="#8cc63f" width="19.2%" height="100" />
    <text x="10%" y="115" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">A</text>
    <text x="10%" y="15" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">100</text>

<rect x="20.2%" y="50" fill="#8cc63f" width="19.2%" height="50" />
    <text x="30.2%" y="115" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">B</text>
    <text x="30.2%" y="65" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">50</text>

<rect x="40.4%" y="90" fill="#8cc63f" width="19.2%" height="10" />
    <text x="50.4%" y="115" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">C</text>
    <text x="50.4%" y="85" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">10</text>

<rect x="60.6%" y="78" fill="#8cc63f" width="19.2%" height="22" />
    <text x="70.6%" y="115" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">D</text>
    <text x="70.6%" y="73" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">22</text>

<rect x="80.8%" y="40" fill="#8cc63f" width="19.2%" height="60" />
    <text x="90.8%" y="115" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">E</text>
    <text x="90.8%" y="55" font-family="helvetica, sans-serif" font-size="10" style="text-anchor:middle;">60</text> 
```

现在因为每个站点的这些统计数据显然会发生变化，所以我使用 JavaScript 生成类似于上面的代码。HTML-Source-Code 看起来相同，但 SVG 不会显示。相反，它看起来像这样：

```
A 100 B 50 C 10 D 22 E60 
```

所以真的只是一行文字

我的 js (backbone_js) 看起来像这样：

```
/* Rendert den Publikumsjoker */
_.extend(KM.Views, {
"StatsPubJoker" : Backbone.View.extend({
    tagName : 'svg:svg',
    attributes:{
        'type':'image/svg+xml',
        'xmlns':"http://www.w3.org/2000/svg",
        //'xmlns:svg':"http://www.w3.org/2000/svg",
        'xmlns:xlink':"http://www.w3.org/1999/xlink",
        'version':'1.1',
        // 'baseProfile':'tiny',
        height:'115',
        width:'100%'
    },
    initialize : function() {
        _.bindAll(this, 'render');
        _.bindAll(this, 'renderSingleBar');

        // Fragenmodel hintelegen
        this.model    = this.options.model;

        // Anzahl an Antwortmöglichkeiten
        var countAnswerOptions = _.keys(this.model.get('stats').pubJoker.prozDistribution).length;

        // Optionen zum  Plotten hinterlegen
        this.plotOptions = {

                // Summe aller gemachten Kreuze hinterlegen (=n)
                n : this.model.get('stats').pubJoker.sumup,

                // Anzahl unterschiedlicher Antwortmöglichkeiten zwischenspeichern
                N : countAnswerOptions,

                // Breiten festlegen (in Prozent)
                barWidth : (99 / countAnswerOptions), // + '%',
                spacerWidth : 1 / (countAnswerOptions-1), // + '%',
                textOffset: 99 / countAnswerOptions * 2
        };

        console.log(this.plotOptions);

        // counter für Balken
        this.barCounter = 0;

        // Das Template laden 
        this.template = _.template($('#stats-pubjoker-singleitem').html());
    },
    render : function() { 

        if(this.plotOptions.n == undefined || this.plotOptions.n == 0 || this.plotOptions.n == 0) return this;

        console.log(this.model.get('stats').pubJoker.prozDistribution);
        _.each(this.model.get('stats').pubJoker.prozDistribution, this.renderSingleBar);

        return this;
    },
    renderSingleBar: function(singleitem,letterkey){

        var singleBarOptions            = {};

        singleBarOptions.xposBar        = (this.plotOptions.barWidth + this.plotOptions.spacerWidth) * this.barCounter;
        singleBarOptions.xposText       =  this.plotOptions.textOffset + singleBarOptions.xposBar;
        singleBarOptions.yposLetter     = 115;
        singleBarOptions.yposBar        = parseFloat(singleitem);
        singleBarOptions.letter         = letterkey;
        singleBarOptions.value          = singleitem;
        singleBarOptions.yposTextNumber = singleBarOptions.yposBar < 25 ? singleBarOptions.yposBar + -15 : singleBarOptions.yposBar +5;
        console.log(singleBarOptions);

        this.$el.append(this.template(_.extend(singleBarOptions, this.plotOptions)));

        this.barCounter++;

        return false;
    }
}) 
```

});

我错过了什么吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:15:36.127

如果您将其保存为`.svg`确保包含标题。

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" 
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> 
```

或者您可以保存为 html 文件：

```
<html>
<body>
.....
</body>
</html> 
```

# c++ - 对 C++ 基类的模糊函数调用

> ID：13864760
> 
> 赞同：16
> 
> 时间：2012-12-13T17:00:46.683
> 
> 标签：c++, c++11

我正在尝试创建一个可变参数模板类，它为类型列表中的每个类提供一个方法。下面显示了一个示例，它`print`为类型列表中的每个类创建一个方法：

```
#include <iostream>
#include <string>

// Helper class providing a function call
template <typename T>
class PrintHelper
{
public:
    void print(const T& t) { std::cout << t << std::endl; }
};

// Provides a print method for each type listed
template <typename... Ts>
class Printer : public PrintHelper<Ts>...
{};

int main()
{
    Printer<int, std::string> p;
    p.print(std::string("Hello World")); // Ambiguous Call
} 
```

注释行导致 GCC 4.6.3 在注释行上出现错误。解决歧义的正确方法是什么，或者我应该寻找不同的设计？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T17:34:42.827

为了解决歧义，可以这样做

```
template <typename... Ts>
struct Printer : PrintHelper<Ts>...
{
    template <typename U>
    void print (const U& t)
    {
        PrintHelper<U>::print (t);
    }
}; 
```

（见[一个例子](http://liveworkspace.org/code/1a4YN8%241)）

但这并不像人们希望的那样强大。特别是，您不能打印可转换为类型列表中的一种类型的对象。

然而，通过一些模板元编程，可以发送到正确的打印机。为此，您必须选择一种可转换的类型`Ts...`，`U`然后调用 right `PrintHelper`，即。

```
PrintHelper<typename find_convertible<U, Ts...>::type>::print (t); 
```

其中`find_convertible<U, Ts...>`定义为

```
template <typename U, typename... Ts>
struct find_convertible
{};

template <typename U, typename V, typename... Ts>
struct find_convertible<U, V, Ts...> :
    std::conditional<
        std::is_convertible<U, V>::value, 
        std::common_type<V>, // Aka identity
        find_convertible<U, Ts...>
    >::type
{}; 
```

（见[例子](http://liveworkspace.org/code/1a4YN8%2412)）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-13T21:10:22.257

我不喜欢回答我自己的问题，但我从这里的评论中创建了以下解决方案。它将所有`print`函数纳入范围，并允许对所有函数进行 C++ 重载解析。

```
#include <iostream>
#include <string>

// Helper class providing a function call
template <typename T>
class PrintHelper
{
public:
    void print(const T& t) { std::cout << t << std::endl; }
};

// Provides a print method for each type listed
template <typename... Ts>
class Printer
{};

template<typename T>
class Printer<T> : public PrintHelper<T>
{
public:
    using PrintHelper<T>::print;
};

template<typename T, typename... Ts>
class Printer<T, Ts...>: public PrintHelper<T>, public Printer<Ts...>
{
public:
    using PrintHelper<T>::print;
    using Printer<Ts...>::print;
};

int main()
{
    Printer<int, std::string> p;
    p.print("Hello World"); // Not an ambiguous Call
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T17:47:23.437

以下代码可以解决歧义问题：

```
#include <iostream>
#include <string>

// Helper class providing a function call
template <typename T>
class PrintHelper
{
  protected:
    void print_impl(const T& t) { std::cout << t << std::endl; }
};

// Provides a print method for each type listed
template <typename... Ts>
class Printer : public PrintHelper<Ts>...
{
  public:
    template <typename U>
    void print(const U& u) { 
      PrintHelper<U>::print_impl(u); 
    };
};

int main()
{
    Printer<int, std::string> p;
    p.print(std::string("Hello World")); // Ambiguous Call
} 
```

这不是很好，因为 U 类型（根据调用推断）恰好是可变参数类型列表中的类型之一。你也许可以花点心思来解决这个问题。使用一点模板魔法和 Sfinae，您可能可以相当轻松地解决这个问题（但肯定没有那么整洁）。

歧义问题与模板或可变参数模板的使用无关，当然，它是成员查找规则（标准的第 10.2/2 节）的直接应用，即通常所说的“成员隐藏规则” ”。如果你采用这个更简单的非模板版本，你会遇到同样的歧义问题，但有一个非常简单的解决方案：

```
struct IntPrinter {
  void print(const int& i) { std::cout << i << std::endl; };
};

struct StringPrinter {
  void print(const std::string& s) { std::cout << s << std::endl; };
};

struct IntStringPrinter : IntPrinter, StringPrinter {
  using IntPrinter::print;       // These using-statements will solve the problem
  using StringPrinter::print;    // by importing all 'print' functions to the same 
                                 // overload resolution level.
}; 
```

所以，这里的问题实际上是在编译器甚至尝试应用正常的重载解析规则之前就出现了歧义，因为它首先尝试找出要遵循继承的哪个分支来查找成员函数，然后，它将仅在一个继承级别解决重载。使用可变参数模板时的问题是，似乎没有任何方法可以解压缩一组“使用”语句来将所有打印函数导入到相同的继承级别。如果有人知道解压此类使用语句的方法，我会全神贯注。您可能不得不回退到预可变模板解决方案（例如具有 10 个参数的通用模板，并专门针对所有 10 个版本）。

# java - 如何将double转换为相同的值而不带小数点

> ID：13864762
> 
> 赞同：0
> 
> 时间：2012-12-13T17:00:54.757
> 
> 标签：java

我想从double中删除小数点？

例如：234.567 将变为 234567。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T17:02:44.977

您可以使用`String.valueOf`方法，然后`.`用空白字符（`""`）替换。

```
String s = String.valueOf(234.567).replace(".",""); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:04:53.430

使用简单的方法。将其转换为 int。:P

> x =（浮点数）5.12；int a = (int) x; System.out.println(a);

# django - 在 Django 中，在单独的信号中生成动作是什么意思？

> ID：13864763
> 
> 赞同：0
> 
> 时间：2012-12-13T17:00:56.073
> 
> 标签：django, notifications, signals

在 Django 中，在单独的信号中生成动作是什么意思？

例如，此文档是否在此处：[https ://github.com/brantyoung/django-notifications](https://github.com/brantyoung/django-notifications)

它指出：生成通知可能最好在单独的信号中完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:13:13.587

Django 有一个`signalling system`允许您轻松附加将在某个事件发生时触发的函数（信号处理程序）。有许多默认事件，例如保存或删除模型对象时，但您也可以创建自己的事件，以便以后附加代码：

[https://docs.djangoproject.com/en/dev/topics/signals/](https://docs.djangoproject.com/en/dev/topics/signals/)

> Django 包含一个“信号调度器”，当框架中的其他地方发生动作时，它可以帮助解耦的应用程序得到通知。简而言之，信号允许某些发送者通知一组接收者某些动作已经发生。当许多代码段可能对相同的事件感兴趣时，它们特别有用。

需要注意的非常重要的一点`signals`是，很容易认为这些操作是在请求/响应循环之外异步触发的，但事实并非如此。它们只是一种向事件添加操作的直观方式（即，当 X 被保存时，执行 Y）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:27:30.387

在您提到的文档中，该示例使用了两个信号。第一个是`notifications.notify`，另一个是`django.db.models.signals.post_save`。

为了使用通知应用程序，基本上你只需要第一个信号。例如，您可以在代码中的任何位置编写：

```
notify.send(request.user, verb='reached level 10') 
```

但是，作者建议您应该在处理另一个信号*之后（或何时）发出通知信号。*因此下面的例子：

```
def my_handler(sender, instance, created, **kwargs):
    #other routines here
    notify.send(instance, verb='was saved')

post_save.connect(my_handler, sender=MyModel) 
```

也就是说，您将通知信号作为 post_save 信号处理程序的一部分发送。

# c# - PHP相当于C#的多维数组声明

> ID：13864772
> 
> 赞同：1
> 
> 时间：2012-12-13T17:01:12.667
> 
> 标签：c#, php, arrays

在 C# 中，您可以这样做：

```
poules = new int[aantal, aantal, 2]; 
```

我在 PHP 中找不到这样做的方法。我能找到的只是一个二维数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:07:44.627

您提供的示例是创建一个 3D 数组，并通过一种方法获取它（这有点慢，因为使用了一种方法）。PHP 使用锯齿状数组。

PHP 中的数组是使用该`array`函数创建的。为了匹配您的示例：（对于固定数组长度）

```
$myArr = new SplFixedArray($aantal);
for ($i = 0; $i < $aantal; $i++) {
    $myArr[$i] = new SplFixedArray($aantal);
    for ($j = 0; $j < $aantal; $j++) {
        $myArr[$i][$j] = new SplFixedArray(2);
    }
} 
```

`SplFixedArray`用于定义一个固定大小的数组。

*如评论中所述，您很少会看到上述 PHP 代码。*

您可以像这样访问数组单元格：

```
$val = $myArr[$x][$y][$z]; 
```

这是一个参考：[SplFixedArray](http://il1.php.net/SplFixedArray)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:07:55.623

我不是 C# 人，所以对此持保留态度。不过，在仔细阅读[文档](http://msdn.microsoft.com/en-us/library/aa288453%28v=vs.71%29.aspx)之后，`new int[aantal, aantal, 2]`似乎是声明多维`int`数组的语法，在这种情况下是一个 3 维数组。

PHP 没有多维数组。它只有数组，你可以有数组的数组。我猜这在 C# 中被称为“锯齿状数组”。PHP 数组也没有类型，没有等价于`int[]`.

您可以一次简单地声明/访问多个维度：

```
$arr = array();
$arr[1][2][3] = 'foo'; 
```

PHP 将根据需要创建中间数组。虽然数组是锯齿状的，但`$arr[0][2][3]`在执行上述代码后就没有了。

如果您需要预先分配所有维度，则必须递归循环。不过，这在 PHP 中并不经常发生，您应该调整您的实践以使用锯齿状数组来完成任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:02:55.963

这将是一个 php 数组：

```
$poules = array('aantal', 'anntal', '2'); 
```

万一`aantal`是一个变量，不带引号也一样：

```
$poules = array($aantal, $anntal, '2'); 
```

在 PHP 中，您不需要指定变量类型。尽管您可以使用它来验证或过滤输入。

您可以在官方文档中阅读更多关于 PHP 数组的信息：http:
[//uk3.php.net/manual/en/language.types.array.php](http://uk3.php.net/manual/en/language.types.array.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T17:04:06.407

```
$poules = array('aantal', 'aantal', 2); 
```

还是 aanta1 数组？因为在 php 中你可以这样做：

```
$myArray = array("some data", array("more data", "in a other array"), array("key1" => "even with keys")); 
```

# c# - c#中的字符串问题

> ID：13864779
> 
> 赞同：-3
> 
> 时间：2012-12-13T17:01:30.393
> 
> 标签：c#, string

我在 C# 中遇到了字符串问题。我有以下字符串：

*这里 Fonts 是包含谷歌字体名称的字符串数组：*

> 字符串字体链接 =`"<link rel='stylesheet' id='fontrequest' href='http://fonts.googleapis.com/css?family='" + Fonts + "type='text/css' media='all'>";`

此字符串在浏览器中呈现错误：

> `<link rel="stylesheet" id="fontrequest" href="http://fonts.googleapis.com/css?family=" times+new+roman|offside|dangrek|days+onetype="text/css" media="all">`

问题在于 href 属性值。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:04:35.643

您的连接错误，格式不正确。为了清楚起见，请使用字符串格式，如下所示：

```
string link_format = "<link rel='stylesheet' id='fontrequest' href='http://fonts.googleapis.com/css?family={0}' type='text/css' media='all'>";

string link = String.Format(link_format,Fonts); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:07:09.640

使用 HttpUtility.UrlEncode

```
string fontsLink = "<link rel='stylesheet' id='fontrequest' href='http://fonts.googleapis.com/css?" + HttpUtility.UrlEncode("family='" + Fonts + "') + "' type='text/css' media='all'>"; 
```

# php - 视觉网站优化器和代码点火器

> ID：13864780
> 
> 赞同：0
> 
> 时间：2012-12-13T17:01:33.890
> 
> 标签：php, codeigniter

我们正在尝试将可视化网站优化器集成到我们使用 Code Igniter 的网站中。

问题是当我们进入 VWO 控制面板查看统计数据和预览时，似乎没有任何效果。在预览面板中，所有这些都显示为代码点火器错误页面，显示“您提交的 URI 包含不允许的字符”。

我已经研究了一些解决方案，并尝试更改系统/配置中的正则表达式以允许更多字符、所有字符等，但我仍然遇到问题。

尝试集成 VWO 和 Code Igniter 的任何已知问题或问题？这绝对似乎是一个 url 问题，但我无法确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:28:48.440

问题是由于网站不接受“？”之后的查询参数的原因。需要生成预览。要解决此问题，请使用直接预览链接并替换“？” 使用“#”，然后预览将正常加载。

# xslt - xsl：变量 xsl：复制选择

> ID：13864784
> 
> 赞同：5
> 
> 时间：2012-12-13T17:01:53.370
> 
> 标签：xslt

我有以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<XmlTest>
    <Pictures attr="Pic1">Picture 1</Pictures>
    <Pictures attr="Pic2">Picture 2</Pictures>
    <Pictures attr="Pic3">Picture 3</Pictures>
</XmlTest> 
```

虽然这个 XSL 做了预期的事情（输出第一张图片的 attr）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/XmlTest">
        <xsl:variable name="FirstPicture" select="Pictures[1]">
        </xsl:variable>
        <xsl:value-of select="$FirstPicture/@attr"/>
    </xsl:template>
</xsl:stylesheet> 
```

似乎不可能在使用 xsl:copy-of 的变量声明中做同样的事情：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >
    <xsl:template match="/XmlTest">
        <xsl:variable name="FirstPicture">
            <xsl:copy-of select="Pictures[1]"/>
        </xsl:variable>
        <xsl:value-of select="$FirstPicture/@attr"/>
    </xsl:template>
</xsl:stylesheet> 
```

好奇：如果我在第二个示例中只选择“$FirstPicture”而不是“$FirstPicture/@attr”，它会按预期输出图片1的文本节点......

在你们都建议我重写代码之前：这只是一个简化的测试，我的真正目的是使用命名模板将一个节点选择到变量 FirstPicture 中，并将其重用于进一步的选择。

我希望有人可以帮助我理解这种行为，或者可以建议我一种正确的方法来选择一个具有易于重用的代码的节点（在我的实际应用程序中，哪个节点是第一个节点的决定很复杂）。谢谢。

**编辑（感谢 Martin Honnen）：** 这是我的工作解决方案示例（它另外使用单独的模板来选择请求的图片节点），使用 MS XSLT 处理器：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt"
    version="1.0">
    <xsl:template match="/XmlTest">
        <xsl:variable name="FirstPictureResultTreeFragment">
            <xsl:call-template name="SelectFirstPicture">
                <xsl:with-param name="Pictures" select="Pictures" />
            </xsl:call-template>
        </xsl:variable>
        <xsl:variable name="FirstPicture" select="msxsl:node-set($FirstPictureResultTreeFragment)/*"/>
        <xsl:value-of select="$FirstPicture/@attr"/>
        <!-- further operations on the $FirstPicture node -->
    </xsl:template>

    <xsl:template name="SelectFirstPicture">
        <xsl:param name="Pictures"/>
        <xsl:copy-of select="$Pictures[1]"/>
    </xsl:template>
</xsl:stylesheet> 
```

不好，在 XSLT 1.0 中不能直接从模板输出节点，但使用额外的变量至少不是不可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:23:30.380

如果你愿意，那么使用 XSLT 1.0 处理器

```
 <xsl:variable name="FirstPicture">
        <xsl:copy-of select="Pictures[1]"/>
    </xsl:variable> 
```

该变量是一个结果树片段，在纯 XSLT 1.0 中您所能做的就是用`copy-of`（或`value-of`）输出它。如果要应用 XPath，首先需要将结果树片段转换为节点集，大多数 XSLT 1.0 处理器都支持扩展功能，因此请尝试

```
 <xsl:variable name="FirstPictureRtf">
        <xsl:copy-of select="Pictures[1]"/>
    </xsl:variable>
    <xsl:variable name="FirstPicture" select="exsl:node-set(FirstPictureRtf)/Pictures/@attr"> 
```

您`xmlns:exsl="http://exslt.org/common"`在样式表中定义的位置。

请注意，您需要检查您的 XSLT 1.0 处理器是否支持 EXSLT 扩展功能或另一个名称空间中的类似功能（例如各种 MSXML 版本）。

# jquery - 滚动过去锚div时向锚链接添加类 - jquery

> ID：13864785
> 
> 赞同：1
> 
> 时间：2012-12-13T17:01:56.463
> 
> 标签：jquery, scroll

我有一个页面，该页面具有链接到页面适当部分的锚点。我想知道是否有人对我如何在单击链接时以及当窗口/页面使用 jQuery 滚动到适当的 div 时如何切换锚链接的类有任何建议？

例如，有 3 个锚链接链接到 3 个部分：

```
<ul>
  <li><a href="#section1">Section 1</li>
  <li><a href="#section2">Section 2</li>
  <li><a href="#section3">Section 3</li>
</ul> 
```

然后是3个部分：

```
<div id="section1"></div>
<div id="section2"></div>
<div id="section3"></div> 
```

我想要完成的是当页面滚动到其中一个 div 或单击锚点时，锚链接的类将切换。因此，如果单击 #section 1 锚点或页面滚动到 #section1 div，则会将一个类添加到 section1 锚链接。如果是第 2 节，则 #section2 链接将接收类，而第 1 节链接将删除该类，依此类推。

我想我可能需要一种方法来跟踪每个部分 div 的位置，然后在适当的链接上切换类，但我不太确定从哪里开始。

提前感谢您的任何帮助或建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:22:27.880

我建议找到每个部分的总高度。我假设每个部分之间也没有中断。然后使用 jQuery 来确定窗口位置。当窗口位置达到某个值时，进行类切换。希望这只能通过滚动来完成，因此当您单击链接时，它将滚动并且前面描述的函数可以运行并为您更改类。

这是一些伪代码

```
$(document).ready(function(){
    var section1Height = $('#section1').height();
    var section2Height = $('#section2').height();
    var section3Height = $('#section3').height();

    $(window).scroll(function() {
        var winTop = $(window).scrollTop();
        if(winTop >= section1Height && winTop <= section2Height){
            $('#section1').addClass("newClass").not().removeClass("newClass");
        } else if(winTop >= section2Height && winTop <= section3Height){
            $('#section2').addClass("newClass").not().removeClass("newClass");
        } else if(winTop >= section3Height){
            $('#section3').addClass("newClass").not().removeClass("newClass");
        }
    });
}); 
```

同样，这只是一个简单的例子。有了你的更多细节，我可以给出更详细的答案。

# javascript - 访问属性“toString”的权限被拒绝

> ID：13864786
> 
> 赞同：9
> 
> 时间：2012-12-13T17:02:02.300
> 
> 标签：javascript

我正在尝试找到一种获取构造函数名称的通用方法。我的目标是为 KnockoutJS 创建一个约定而不是配置框架

我的想法是遍历窗口中的所有对象，当我找到我正在寻找的构造函数时，我可以使用索引来获取构造函数的名称

到目前为止的代码

```
(function() {
    constructors = {};
    window.findConstructorName = function(instance) {
        var constructor = instance.constructor;
        var name = constructors[constructor];
        if(name !== undefined) {
            return name;
        }

        var traversed = [];
        var nestedFind = function(root) {       
            if(typeof root == "function" || traversed[root]) {
                return       
            }

            traversed[root] = true;
            for(var index in root) {               
                if(root[index] == constructor) {
                    return index;
                }

                var found = nestedFind(root[index]);  
                if(found !== undefined) {
                    return found;
                }
            }
        }

        name = nestedFind(window);
        constructors[constructor] = name;
        return name;
    }
})();

var MyApp = {};
MyApp.Foo = function() {
};

var instance = new MyApp.Foo();
console.log(findConstructorName(instance)); 
```

问题是我得到了一个`Permission denied to access property 'toString'`异常，我什至不能尝试 catch 所以看看是哪个对象导致了问题

小提琴[http://jsfiddle.net/4ZwaV/](http://jsfiddle.net/4ZwaV/)

**这个小提琴的最终版本** [http://jsfiddle.net/2Uvd5/8/](http://jsfiddle.net/2Uvd5/8/)

**在此处查看我的公约配置插件的雏形** [https://github.com/AndersMalmgren/Knockout.BindingConventions](https://github.com/AndersMalmgren/Knockout.BindingConventions)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T17:38:19.507

*   编辑2：

`[JSFiddle](http://jsfiddle.net/hSFJy/9)`

这解决了所有问题，除了一件事：`var MyApp = {};` **不**将其添加到`window-object`. 将其更改为`window.MyApp = {};`使其完全正常工作（即使在 IFrame 中）。

* * *

*   编辑1：

`[JSFiddle](http://jsfiddle.net/hSFJy/1/)`

通过设置键名添加到数组中需要键名是字符串，以便 Javascript 自动调用。`toString()`在您建议的键名上，这对于某些对象将失败。而是使用 .push() 将任何类型的元素添加到数组中，然后`.indexOf()`检查它是否已经存在。

请注意，jsFiddle 仍然会因为放置在`iframe`. [在新选项卡中](http://fiddle.jshell.net/hSFJy/1/show/)打开它可以解决这个问题。

* * *

*我之前的回答*（当我试图在你的 jsFiddle 中验证它时证明是无效的）：

您需要检查构造函数是否是一个精确的对象。如果它在它上面调用 .toString() 将导致一个安全异常，我发现它有点难以调试。这是我用来在我使用的 var-dumper 中获取对象类型的函数。

```
function GetTypeOfObject(obj) {
    if (obj.constructor === window.Object)
        return '[object]';
    else
        return obj.constructor.toString();
} 
```

# java - Spring重载构造函数注入

> ID：13864787
> 
> 赞同：4
> 
> 时间：2012-12-13T17:02:03.157
> 
> 标签：java, spring, constructor-injection

这是代码：

```
public class Triangle {

private String color;
private int height;

public Triangle(String color,int height){
    this.color = color;
    this.height = height;
}

public Triangle(int height ,String color){
    this.color = color;
    this.height = height;
}

public void draw() {
    System.out.println("Triangle is drawn , +
            "color:"+color+" ,height:"+height);
}

} 
```

Spring 配置文件是：

```
 <bean id="triangle" class="org.tester.Triangle">
    <constructor-arg value="20" />
    <constructor-arg value="10" />
</bean> 
```

是否有任何特定规则来确定 Spring 将调用哪个构造函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:11:52.070

在这里，第一个参数将匹配每个方法的第一个参数，然后参数将被匹配。

我会建议下面的解决方案来帮助消除歧义

如果你想调用你的第一个构造函数，请使用

```
<bean id="triangle" class="org.tester.Triangle">
<constructor-arg type="int"  value="20" />
<constructor-arg type="java.lang.String"  value="10" />
</bean> 
```

如果你想调用你的第二个构造函数，请使用

```
<bean id="triangle" class="org.tester.Triangle">
    <constructor-arg type="java.lang.String"value="20" />
    <constructor-arg   type="int"  value="10" />
</bean> 
```

这样就解决了歧义

**编辑 ：-**

[请在此处](http://www.theserverside.com/tutorial/Solving-the-Constructor-Ambiguity-Problem-with-Spring-3-Annotations)阅读有关此问题的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:10:08.497

我不相信。请注意，您可以键入参数，例如：

```
<bean id="triangle" class="org.tester.Triangle">
    <constructor-arg type="int" value="20" />
    <constructor-arg value="10" />
</bean> 
```

这将消除这种情况下的混乱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T23:04:45.840

基于 Spring 3.1.0 的测试，将使用第二个构造函数。我不知道为什么，文档没有给出任何明确的答案。

[Bitbucket 代码](https://stackoverflow.com/questions/13864787/spring-overloaded-constructor-injection)为了测试，运行 Main 类，它将输出 String FIRST 或 SECOND，这取决于将使用哪个构造函数来创建 Triangle 对象。

# wcf - svcutil.exe 的目录参数中的空间

> ID：13864789
> 
> 赞同：2
> 
> 时间：2012-12-13T17:02:08.453
> 
> 标签：wcf, cmd, svcutil.exe

我正在尝试使用 svcutil 下载 WCF 服务的元数据，但我遇到了 /directory:<> 参数的问题。我要保存到的目录中有一个空格：

> C:\服务参考\记录

所以当我执行 /t:metadata 我收到以下错误：

> 错误：找不到目录“C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\References\Logging”。验证该目录是否存在以及您是否具有读取它的适当权限。

在我看来，“服务参考”中的空间导致了这个问题。根据我对命令外壳（非常少）的理解，空格充当可执行文件的分隔符。所以我试着用胡萝卜逃离空间

> 服务^ 参考

并用双引号括住路径

> “C:\服务参考\记录”

但这些似乎都不起作用，因为 /directory: 参数无法将它们识别为值中的有效字符。我还没有找到关于这个和 svcutil 的任何方向，所以我现在很茫然。

我可以将文件下载到临时文件夹然后移动它们，但我不希望采用这种方法。

我将不胜感激任何可以尝试解决此问题的方向。提前致谢。

**-- 编辑 --** 这是我试图运行的完整命令。如果您自己尝试，则必须添加您自己的 WCF 引用，因为此引用位于内部 IP 地址上

> svcutil /t:metadata [http://dev.taskservices.noelnet.com/LoggingService/LoggingService.svc](http://dev.taskservices.noelnet.com/LoggingService/LoggingService.svc) /d:C:\Service References\Logging\

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:36:03.013

根据文档`svcutil`

> /directory: - 创建文件的目录（默认：当前目录）（缩写：/d）

由于默认是使用当前目录，让我们更改命令的当前目录。

```
pushd "C:\Service References\Logging\"
svcutil /t:metadata http://dev.taskservices.noelnet.com/LoggingService/LoggingService.svc
popd 
```

如果您不需要恢复到原始目录，您可以使用`cd "C:\Service References\Logging\"`.

请注意，为了使其正常工作，必须使用其整个路径调用 svcutil，或者将其路径列在 PATH 环境变量中。这就是我使用其整个路径调用的意思：

```
cd "C:\Service References\Logging\"
"C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\svcutil.exe" /t:metadata http://dev.taskservices.noelnet.com/LoggingService/LoggingService.svc 
```

# c# - WPF工具栏在调整大小时消失

> ID：13864791
> 
> 赞同：3
> 
> 时间：2012-12-13T17:02:19.750
> 
> 标签：c#, wpf, toolbar

在我的主窗口上，我有一个带有许多按钮的工具栏。一旦通过拖动父窗口来调整其大小，以使整个工具栏及其所有按钮不再适合窗口的宽度，整个工具栏就会消失。

有没有一种方法可以让你在调整它的大小时，当你到达工具栏的宽度时，窗口的内部控件停止调整大小并保持显示，只是切断窗口调整大小的位置？

代码是

```
<Grid >
<Grid.RowDefinitions>
    <RowDefinition Height="Auto" />
    <RowDefinition Height="Auto" />
    <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
</Grid.RowDefinitions>
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="*" />
</Grid.ColumnDefinitions>
    <ToolBar Grid.Row="1" Height="50" Name="tbMainToolbar" VerticalAlignment="Top" MinWidth="900" >
    <ToolBar.Background>
        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
            <GradientStop Color="White" Offset="0.0" />
            <GradientStop Color="#DCEBFF" Offset="0.25" />
            <GradientStop Color="#99CCFF" Offset="0.75" />
            <GradientStop Color="#99CCFF" Offset="1.0" />
            </LinearGradientBrush>
    </ToolBar.Background>
    <DockPanel LastChildFill="True">
        <Button Name="btnApproved" DockPanel.Dock="Left" Click="btnToolbar_Click" CommandParameter="APPROVED"
                Style="{StaticResource ToolbarButtonDisplay}" HelperClasses:ButtonProperties.Image="..\..\Resources\Images\APPROVEU.GIF" Content="Approve">
        </Button>
        ... and so forth for about 20 buttons 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T18:02:24.627

您的工具栏中有一个`DockPanel`，其中包含所有按钮。

这意味着工具栏将停靠面板（及其所有按钮）视为一个单独的“项目”。当它不适合时，它会在工具栏的溢出区域中隐藏很多。

如果你完全摆脱了`DockPanel`，只是把按钮直接放在工具栏下，当窗口调整大小时，按钮会一个一个地消失（它们会出现在“溢出区域”中）

如果您不希望它们进入溢出区域，您可以`ToolBar.OverflowMode="Never"`在每个按钮上使用附加属性。正如您在问题中描述的那样，这将导致工具栏从窗口边缘消失。

您也可以首先在停靠面板上使用此附加属性：

```
<DockPanel LastChildFill="True" ToolBar.OverflowMode="Never"> 
```

# prolog - 我如何计算原子 Prolog？

> ID：13864793
> 
> 赞同：-1
> 
> 时间：2012-12-13T17:02:34.133
> 
> 标签：prolog, logic

我怎么解决这个问题？？

输入：count_atoms(T,Count)

输出 count_atoms(a(b,c(d,e),f),Count)。计数 = 4 ;

我真的不知道......请你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:37:00.637

通过 SWI-Prolog 和递归使用库（[聚合）：](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.1%27,swi%28%27/doc/Manual/aggregate.html%27%29%29)

```
count_atoms(T, Count) :-
       atom(T)
    -> Count = 1
    ;  compound(T)
    -> aggregate_all(sum(C), (arg(_, T, A), count_atoms(A, C)), Count)
    ;  Count = 0
    . 
```

测试：

```
?- count_atoms(a(b,c(1,e),f),Count).
Count = 3. 
```

但我担心这不是您分配的解决方案。对于更基本的东西，您可以使用[=..分解任何](http://www.swi-prolog.org/pldoc/doc_for?object=%28=..%29/2)[复合](http://www.swi-prolog.org/pldoc/doc_for?object=compound/1)术语并在参数列表上递归。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T16:03:04.843

也许基于堆栈的方法可以提供帮助。您可以编写至少四个辅助谓词，如下所示：

```
% Increases accumulator if T is atomic + call to count_atoms/6
count_atoms(T, Stack, StackSize, Accumulator, Count) :- ...

% Gets the arity of T if T is compound + call to count_atoms/6
count_atoms(T, Stack, StackSize, Accumulator, Count) :- ...

% Gets Nth subterm of T and puts it on the stack + call to count_atoms/6
count_atoms(T, N, Stack, StackSize, Accumulator, Count) :- ...

% Pops element from stack + call to count_atoms/5
count_atoms(T, _, Stack, StackSize, Accumulator, Count) :- ... 
```

但是您仍然需要一个 count_atoms/2 谓词和一个来停止算法并产生结果。

# html - 等到 HTML5 视频加载

> ID：13864795
> 
> 赞同：49
> 
> 时间：2012-12-13T17:02:44.320
> 
> 标签：html, html5-video

我有一个视频标签，当我让用户从数据库中的多个视频中进行选择时，我会动态更改其来源。问题是当我更改 src 属性时，即使我告诉它，视频也不会加载。

这是我的代码：

```
$("#video").attr('src', 'my_video_'+value+'.ogg');
$("#video").load();
while($("#video").readyState !== 4) {
        console.log("Video is not ready");
}; 
```

代码仍然处于无限循环中。

有什么帮助吗？

**编辑**：

致伊恩·德夫林：

```
//add an listener on loaded metadata
v.addEventListener('loadeddata', function() {
    console.log("Loaded the video's data!");
    console.log("Video Source: "+ $('#video').attr('src'));
    console.log("Video Duration: "+ $('#video').duration);
}, false); 
```

好的，这是我现在拥有的代码。源打印得很好，但我仍然无法获得持续时间：/

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-12-14T08:42:58.463

您实际上并不需要 jQuery，因为有一个[媒体 API](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#media-elements)可以为您提供所需的一切。

```
var video = document.getElementById('myVideo');
video.src = 'my_video_' + value + '.ogg';
video.load(); 
```

媒体 API 还包含一个[`load()`](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#dom-media-load)方法：“使元素重置并开始从头开始选择和加载新的媒体资源。”

（Ogg 不是最好的格式，因为它仅受有限数量的浏览器支持。我建议使用 WebM 和 MP4 来覆盖所有主要浏览器 - 您可以使用该[`canPlayType()`](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#dom-navigator-canplaytype)功能来决定播放哪一个）。

然后，您可以等待[`loadedmetadata`](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#event-media-loadedmetadata)或[`loadeddata`](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#event-media-loadeddata)（取决于您想要的）事件触发：

```
video.addEventListener('loadeddata', function() {
   // Video is loaded and can be played
}, false); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-10-02T05:06:37.630

作为对您问题的最后一部分的回应，仍然没有答案......当您编写 时`$('#video').duration`，您要求的`duration`是不存在的 jQuery 集合对象的属性。本机 DOM 视频元素确实具有持续时间。你可以通过几种方式得到它。

这是一个：

```
// get the native element directly
document.getElementById('video').duration 
```

这是另一个：

```
// get it out of the jQuery object
$('#video').get(0).duration 
```

还有一个：

```
// use the event object
v.bind('loadeddata', function(e) {
  console.log(e.target.duration);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-26T08:20:30.023

您可以在 video 标签的属性中使用 preload="none"，这样只有当用户点击播放按钮时才会显示视频。

```
<video preload="none">
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-03T08:14:00.063

加载时调用函数：

```
<video onload="doWhatYouNeedTo()" src="demo.mp4" id="video"> 
```

获取视频时长

```
var video = document.getElementById("video");
var duration = video.duration; 
```

# android - SQLite 数据库的 Android 导出

> ID：13864800
> 
> 赞同：-2
> 
> 时间：2012-12-13T17:02:54.017
> 
> 标签：android, database, sqlite, permissions

我正在尝试从我的应用程序中导出 SQLite 数据库，以便我可以为我的应用程序执行导出/导入功能。

我正在使用[此处](https://stackoverflow.com/questions/13644963/android-sqlite-database-exporting?rq=1)和[此处](https://stackoverflow.com/questions/6540906/android-simple-export-import-of-sqlite-database/6542214#6542214)的示例尝试将**SQLite 数据库 (/data/data/com.example.worldcountriesbooks/databases/group.db)**从 Android 设备 (Samsung Galaxy Note)、Android 4.0.3 中导出但我不断收到此错误

```
12-14 00:56:33.722: I/Failed(14850): java.io.FileNotFoundException: /data/data/com.example.worldcountriesbooks/databases/group.db: open failed: ENOENT (No such file or directory) 
```

我也尝试将`WRITE_EXTERNAL_STORAGE`&添加`WRITE_MEDIA_STORAGE`到清单文件中，但它不起作用。我可以浏览到我的 Android 设备上的实际文件，因为它已植根，但我无法用我的应用程序读取它。知道为什么吗？

示例代码：

```
 try {
        File sd = Environment.getExternalStorageDirectory();
        File data = Environment.getDataDirectory();

        if (sd.canWrite()) {
            String currentDBPath = "//data//com.example.worldcountriesbooks/databases//group.db";
            String backupDBPath = "//mnt//sdcard//database.db";
            File currentDB = new File(data, currentDBPath);
            File backupDB = new File(sd, backupDBPath);

            FileChannel src = new FileInputStream(currentDB).getChannel();
            FileChannel dst = new FileOutputStream(backupDB).getChannel();
            dst.transferFrom(src, 0, src.size());
            src.close();
            dst.close();
            Toast.makeText(getBaseContext(), backupDB.toString(),
                    Toast.LENGTH_LONG).show();

        }
    } catch (Exception e) {

        Toast.makeText(getBaseContext(), e.toString(), Toast.LENGTH_LONG)
                .show();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:06:08.087

如果文件在内存中，您的应用程序只能从内存中的特殊文件夹中读取。该文件夹的路径由以下方式返回：

```
getFilesDir().getAbsolutePath() 
```

在您的情况下，它将类似于：

```
String path= this.getFilesDir().getAbsolutePath() + File.separator + "databases" + File.separator + "group.db"; 
```

你可以阅读它`openFileInput()`。

更多信息：

[http://developer.android.com/guide/topics/data/data-storage.html#filesInternal](http://developer.android.com/guide/topics/data/data-storage.html#filesInternal)

# windows - 在新的打印服务器上保留旧的默认打印机名称

> ID：13864804
> 
> 赞同：1
> 
> 时间：2012-12-13T17:03:01.740
> 
> 标签：windows, powershell, scripting, migration, printers

我的任务是在从旧的 2003 R2 打印服务器迁移到新的 2008 R2 打印服务器期间更新所有客户端打印机设置。所有客户端都是带有 Powershell 2.0 的 Win7，我创建了一个脚本来添加新打印机并删除客户端上的旧打印机。

但是，它会弄乱客户端上的默认打印机设置，如果将默认打印机更改为随机打印机或根本没有设置默认打印机，这似乎是随机的。

我正在考虑使用方法 Get-WmiObject -Class Win32_Printer -Filter "Default = $true" 并且有效，我可以看到正确的（和旧的）默认打印机。

但是，如果我尝试将新的默认打印机设置为相同的名称，它会失败（或者更准确地说，它只是随机发生的事情）。

也许我把函数 $printer.SetDefaultPrinter() 放在了错误的地方？

代码：

```
 Param (
    $newPrintServer = "Server2",
    $PrinterLog = "\\LogSVR\PrintMigration$\PrintMigration.csv"
)
<#
    #Header for CSV log file:
    "COMPUTERNAME,USERNAME,PRINTERNAME,RETURNCODE-ERRORMESSAGE,DATETIME,STATUS" | 
        Out-File -FilePath $PrinterLog -Encoding ASCII
#>
Try {
    Write-Verbose ("{0}: Checking for printers mapped to old print server" -f $Env:USERNAME)
    $printers = @(Get-WmiObject -Class Win32_Printer -Filter "SystemName='\\\\Server1'" -ErrorAction Stop)
    $DefPrinter = Get-WmiObject -Class Win32_Printer -Filter "Default = $true"

    If ($printers.count -gt 0) {        
        ForEach ($printer in $printers) {
            Write-Verbose ("{0}: Replacing with new print server name: {1}" -f $Printer.Name,$newPrintServer)
            $newPrinter = $printer.Name -replace "Server1",$newPrintServer  
            $returnValue = ([wmiclass]"Win32_Printer").AddPrinterConnection($newPrinter).ReturnValue                
            If ($returnValue -eq 0) {
                "{0},{1},{2},{3},{4},{5}" -f $Env:COMPUTERNAME,
                                             $env:USERNAME,
                                             $newPrinter,
                                             $returnValue,
                                             (Get-Date),
                                             "Added Printer" | Out-File -FilePath $PrinterLog -Append -Encoding ASCII            
                Write-Verbose ("{0}: Removing" -f $printer.name)
                $printer.Delete()
                "{0},{1},{2},{3},{4},{5}" -f $Env:COMPUTERNAME,
                                             $env:USERNAME,
                                             $printer.Name,
                                             $returnValue,
                                             (Get-Date),
                                             "Removed Printer" | Out-File -FilePath $PrinterLog -Append -Encoding ASCII
                         $DefPrinter.SetDefaultPrinter()            

} Else {
                Write-Verbose ("{0} returned error code: {1}" -f $newPrinter,$returnValue) -Verbose
                "{0},{1},{2},{3},{4},{5}" -f $Env:COMPUTERNAME,
                                             $env:USERNAME,
                                             $newPrinter,
                                             $returnValue,
                                             (Get-Date),
                                             "Error Adding Printer" | Out-File -FilePath $PrinterLog -Append -Encoding ASCII
            }
        }
    }
} Catch {
    "{0},{1},{2},{3},{4},{5}" -f $Env:COMPUTERNAME,
                                 $env:USERNAME,
                                 "WMIERROR",
                                 $_.Exception.Message,
                                 (Get-Date),
                                 "Error Querying Printers" | Out-File -FilePath $PrinterLog -Append -Encoding ASCII
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T23:20:20.083

我可能会误解，但默认打印机（defprinter）也位于 server1 上，对吧？所以你创建了一个到打印机 x 的链接 defprinter。然后删除所有打印机（包括打印机 x）并尝试再次将 defprinter（不再存在）设为默认打印机。这不起作用，随机打印机将获得默认属性。

第一，您应该在循环开始之前存储 defprinter 的唯一打印机名称（$printer.name）。然后当循环完成时：您搜索新创建的打印机 wmi 对象，它代表以前的默认打印机（使用您在循环前保存的打印机名称）并将其设为默认值..

# regex - Mongoimport 严格的 JSON {$date:XXX} 作为 ISODate

> ID：13864806
> 
> 赞同：0
> 
> 时间：2012-12-13T17:03:05.827
> 
> 标签：regex, mongodb, sed

我有几个 GB 从 RDBMS 导出为 JSON。所有日期都采用严格的 JSON 格式，即`{$date:1354810746067}`.

Mongoimport 似乎没有将其转换为所需的 ISODate。只有当它被格式化为`Date(1354810746067)`.

是否可以调整 mongoimport 以接受 {$date:..} 作为 ISODate？

`sed`或者我应该通过一些脚本传递我的导入，也许？

样本输入就像

```
{cleared:true,category:"general auditing",transactionId:null,details:{new_terminal_mode:"test value-24",company_old_id:2534,new_terminal_state:"test value-28",reduction_type:"test value-3",transition_times:[{$date:1355408317000},{$date:1355407983000},{$date:1355413490000},{$date:1355411339000},{$date:1355414485000},{$date:1355414378000},{$date:1355408061000},{$date:1355408064000}]},_id:"69",dateTime:{$date:1354813457327},severity:20,eventType:"log_event_count_threshold_reached",systemId:693972591865925,carParkId:0} 
```

我试过了

```
cat file | sed -e s/{$date:\([0-9]*\)}/Date\(\1\)/g | mongoimport -c test 
```

但是我的正则表达式技能在那里失败了:-(。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:33:23.943

我现在不使用 mongoimport，所以我在这里帮不了你。

但是对于 sed，请尝试在 sed 中使用一些引号：

```
sed -e 's/{$date:\([0-9]*\)}/Date\(\1\)/g' file 
```

PS：你的正则表达式很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T11:54:26.377

尝试使用引号，另一个不是有效的 JSON：{"$date":1354810746067}

# .net - .net 调试打印输出中的“未加载符号”是什么意思

> ID：13864812
> 
> 赞同：1
> 
> 时间：2012-12-13T17:03:27.553
> 
> 标签：.net, windows

我正在尝试调试在 Visual Studio 中运行但在服务器环境中崩溃的 exe。当它崩溃时，服务器让我有机会在 Visual Studio 中“调试”它——它会打印出一个打印输出，其中有一长串写着“未加载符号”的行。这是什么意思？它试图加载的“符号”是什么？

这是崩溃打印输出的前两行：

> “AutoMatcher.exe”：已加载“PathToMyExe\MyExecutables.exe”，符号文件中没有本机符号。-“AutoMatcher.exe”：已加载“C:\Windows\System32\ntdll.dll”，未加载任何符号。
> 
> 更多这样的......结束'没有加载符号'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:05:52.953

在这种情况下，“符号”是指存储在`[AssemblyName].PDB`文件中的函数取消引用索引。调试符号用于在发生异常时生成详细的堆栈跟踪。出于性能和安全原因，无需调试文件/符号即可部署生产发布代码。

开发 .NET 应用程序时，托管代码的调试符号是在调试模式下生成时生成的。但是，默认情况下不安装操作系统级功能的符号。如果您正在进行操作系统级别的调用并希望能够调试操作系统，则可以在[MSDN](http://msdn.microsoft.com/en-us/windows/hardware/gg463028.aspx)上找到 Windows 调试器符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:06:52.337

这意味着调试器不知道该 DLL 中的任何函数名称（“符号”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:08:41.243

Visual Studio 符号文件是具有 .pdb 扩展名的文件，由链接器在生成可执行文件（DLL 或 .EXE 或其他类型）时生成。

拥有匹配的 .pdb 文件对于调试至关重要，因为这些文件除了包含其他信息流之外，还包含汇编代码和源代码行之间的关联。

您可以在此处找到有关 .pdb 文件的更多信息[http://support.microsoft.com/kb/121366](http://support.microsoft.com/kb/121366)

要调试服务器端方案，您需要将构建中的 .pdb 文件复制到服务器上。

# awk - AWK - 如何有选择地修改 txt 文件

> ID：13864820
> 
> 赞同：3
> 
> 时间：2012-12-13T17:04:08.513
> 
> 标签：awk

我想打印每条记录的特定第二个字段（匹配正则表达式）

```
awk '$2 ~ /regex1/' 
```

但是，只有在 regex2 和 regex3 之间的特定记录

```
awk '/regex2/,/regex3/' 
```

其他不在 regex2 和 regex3 之间的记录应正常打印（所有字段）

任何想法，如何把它放在一起？

输入和输出的快速示例：

输入

```
parrot   milana  3 ukraine
dog      husky   1 poland
cat      husky   5 france
elephant malamut 5 belgium
bird     husky   5 turkey 
```

输出：（给我看

```
parrot   milana  3 ukraine
dog      husky   1 poland
         husky            
elephant malamut 5 belgium    
bird     husky   5 turkey 
```

1.  显示整个输入但是：
2.  在 /dog/ 和 /elephant/ 之间（显示这些记录不变）只显示第二个字段，它匹配正则表达式 /husky/

我希望这是有用的...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T17:57:23.307

这个：

```
awk '/regex2/,/regex3/' 
```

是简写

```
awk '/regex2/{f=1} f; /regex3/{f=0}' 
```

恕我直言不应该使用速记版本，因为当您尝试使用其他标准构建它时，它的简洁不值得它引入的困难，例如不打印起始线和/或不打印结束线和/或引入其他 RE像你现在所做的那样在范围内匹配。

鉴于此，您将从以下脚本开始：

```
awk '/dog/{f=1} f; /elephant/{f=0}' 
```

并且您只想打印找到“husky”的行，因此这是简单而明显的调整：

```
awk '/dog/{f=1} f && /husky/; /elephant/{f=0}' 
```

编辑：响应更改的要求，并使用制表符分隔的文件：

```
$ cat file
parrot  milana  3       ukraine
dog     husky   1       poland
cat     husky   5       france
elephant        malamut 5       belgium
bird    husky   5       turkey

$ awk '
BEGIN{ FS=OFS="\t" }
/elephant/ {f=0}
{
   if (f) {
      if ($2 == "husky") {
         print "", $2
      }
   }
   else {
      print
   }
}
/dog/      {f=1}
' file
parrot  milana  3       ukraine
dog     husky   1       poland
        husky
elephant        malamut 5       belgium
bird    husky   5       turkey 
```

你可以写得更简洁：

```
$ awk '
BEGIN{ FS=OFS="\t" }
/elephant/ {f=0}
f && /husky/ { print "", $2 }
!f
/dog/      {f=1}
' file
parrot  milana  3       ukraine
dog     husky   1       poland
        husky
elephant        malamut 5       belgium
bird    husky   5       turkey 
```

但我认为 if-else 语法对于 awk 的新手来说是最清晰和最容易修改的。如果您想要不同的输出格式，请在手册中查找“printf”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:08:06.840

文件：

```
$ cat input

parrot   milana  3 ukraine
dog      husky   1 poland
cat      husky   5 france
elephant malamut 5 belgium
bird     husky   5 turkey 
```

命令：

```
$ awk '/dog/{m=1} $2 ~ /husky/ && m{print $2} !m{print} /elephant/{m=0}' input

parrot   milana  3 ukraine
husky
husky
bird     husky   5 turkey 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:09:44.750

您的问题有些含糊不清，但应该这样做：

```
awk '/regex2/ {inside=1}
     /regex3/ {inside=0}
     $2 ~ /regex1/ && inside {print $2}
     !inside {print}' input_file 
```

# svn - 撤消 SVN 从 depo 中删除

> ID：13864822
> 
> 赞同：1
> 
> 时间：2012-12-13T17:04:19.197
> 
> 标签：svn

> **可能重复：**
> [在颠覆中取消删除文件的简单方法是什么？](https://stackoverflow.com/questions/497670/whats-a-simple-way-to-undelete-a-file-in-subversion)

我想将一个名为**prj1**的新项目导入到 depo 中。在**prj1**里面有**sub1** , **sub2** , ...

```
cd prj1    
svn import prj1 http://someurl.com/project/branches/ 
```

但这是错误的路径，我应该在上述行的末尾添加**prj1**，所以我打算删除 prj1 中的子项目，我打算这样做：

```
svn remove http://someurl.com/project/branches/sub1 
```

但我错误地做了：

```
svn remove http://someurl.com/project/branches 
```

结果**分支**消失了。在**分支**内部，与**prj1**平行，还有一些其他项目我没有本地副本（尚未检查出来）。我想知道是否有任何方法可以撤消意外 svn 删除**分支**并将其带回仓库。

**编辑：**

正如 Lekensteyn、Lazy Badger 和[https://stackoverflow.com/a/3128696/1383356](https://stackoverflow.com/a/3128696/1383356)所建议的那样，我通过查看最新版本 (102) 解决了这个问题，并使用回滚到版本 100（在导入之前） svn 合并。以下是详细信息：

```
svn co http://someurl.com/project
cd project
svn merge -r 102:100 http://someurl.com/project
svn commit -m "Rolling back to the old days of r100 :)" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:06:43.953

您的导入和删除是存储库中的单独修订（检查*它*`svn log`）

撤消 SVN 中的任何提交是反向合并的工作：您必须知道提交的修订 ID 删除、签出受影响的路径（`http://someurl.com/project/`-是的，可能是**巨大的签**出，但这是您的麻烦），反向合并错误修订并提交撤消修订进入回购

另一种方法是`http://someurl.com/project/branches/`在最新版本中签出，当它存在时（使用 PEG 语法），分支它，更新到 HEAD，合并分支（真正恢复树），在 WC 中检查结果，提交

# c# - 将字符串添加到项目数组

> ID：13864826
> 
> 赞同：-1
> 
> 时间：2012-12-13T17:04:43.287
> 
> 标签：c#

我有一个项目数组：

```
dtProducts.Rows[i].ItemArray; 
```

我正在尝试将单个字符串值附加到该数组的开头，然后将整个数组添加到另一个 DataTable。

我尝试在项目数组上使用 .ToList() ，然后添加字符串值，但它给了我一个错误：

**无法将类型“void”隐式转换为“System.Collections.Generic.List”**

```
var items = dtProducts.Rows[i].ItemArray.ToList();
items = items.Add("myString"); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:14:08.890

正如杰森所说， List<>.Add 是一个 void 方法，你应该删除assingment：

```
items.Add("myString"); 
```

如果您希望新项目位于列表的开头，请使用 Insert：

```
items.Insert(0, "myString"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:09:56.487

C# List.Add() 函数在原地添加一个项目，它没有返回值，所以替换：

```
items = items.Add("myString"); 
```

简单地

```
items.Add("myString"); 
```

应该解决你的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:14:20.883

`ItemArray`不是一个`DataRow[]`。它是 DataRow 字段的数组。

我假设您想将一个字段的所有字段复制`DataTable`到另一个字段`DataTable`并用`string`.

```
string[] stringToInsert = new[]{"myString"};
foreach(DataRow row1 in table1.Rows)
{
    DataRow newRow = table2.Rows.Add();
    newRow.ItemArray = stringToInsert.Concat(row1.ItemArray).ToArray();
} 
```

（假设第二个表有 table1.Column.Count + 1 列）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T17:15:34.833

要在列表的索引 0 处添加一个项目，您需要创建一个新列表，添加您的对象，然后遍历原始列表，随时添加其中的对象，例如

```
List<object> newList = new List<object>();
newList.add("myString");
foreach (object item in items)
{
    newList.add(item);
} 
```

add 方法将对象添加到列表的尾部（索引 n + 1）。

# html - 将 Html 渲染为图像

> ID：13864827
> 
> 赞同：1
> 
> 时间：2012-12-13T17:04:44.177
> 
> 标签：html, image, yii, mpdf

我有一个页面，其中包含一个名为预览的表单和按钮。我需要一种方法来生成预览，将生成的 HTML 转换为图像。

单击预览按钮会启动对控制器操作的 ajax 调用（我使用的是 Yii 框架），因此我从表单中收集了所有数据并生成了包含填充数据的预览。

我需要将生成的 HTML 转换为图像；通过这种方式，我可以重新调整到我需要的尺寸。

我尝试动态生成 .pdf，然后从 pdf 生成图像，并使用 mpdf 扩展名和 imagick。但是 imagick 要求 pdf 是现有文件，而我更喜欢使用 mpdf 生成 .pdf 字符串（我无法为每次单击预览按钮生成和删除 pdf）。

什么是从 html 或“动态”生成的 pdf 字符串生成图像的好方法？

这是我使用的代码，但它从imagick返回错误，说图像没有尺寸：

```
 $html2pdf = Yii::app()->ePdf->mpdf('','A4');        
    $html2pdf->WriteHTML($this->render('preview', array("data" => $data, "imageProvider" => $arrayImage),true));        
    $content_PDF = $html2pdf->Output('', EYiiPdf::OUTPUT_TO_STRING);        
    $im = new Imagick();         
    $im->readImageBlob( $content_pdf );         
    //$im->setIteratorIndex(0);
    $im->setResolution( 800, 600 );
    $im->setImageFormat( "jpeg" );
    header( "Content-Type: image/jpeg" );        
    echo $im->getImage(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:35:58.377

您需要重新考虑采用 HTML 并生成它的图像文件的要求。

> 我需要将生成的 HTML 转换为图像；通过这种方式，我可以重新调整到我需要的尺寸。

您可以使用适当的 CSS 轻松调整表单中的维度和所有元素的大小。这是我要走的路线。

生成图像似乎有点矫枉过正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T21:52:44.303

为了使用 Imagick，您需要设置图片的 SIZE，而不仅仅是解决方案：您可以先尝试这样的事情，看看会发生什么？

> ```
> $thumb = new imagick("/path/".$filename);
> $thumb->setImageFormat( "png" );
> $thumb->thumbnailImage( 128, 128); 
> ```

# c++ - 线性采样高斯模糊质量问题

> ID：13864831
> 
> 赞同：1
> 
> 时间：2012-12-13T17:04:55.707
> 
> 标签：c++, glsl, shader, blur, pointer-aliasing

我最近根据这篇文章实现了一个线性采样高斯模糊：

[线性采样高斯模糊](http://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/)

它通常表现得很好，但似乎文本上有轻微的锯齿和更薄的像素集合。我很困惑是什么原因造成的，这是我的着色器或权重计算的问题，还是使用这种方法的继承缺陷？

我想补充一点，当我定期对每个像素进行采样而不是使用双线性过滤时，我不会遇到这个问题。

非常感谢任何见解。这是我如何计算权重的代码示例：

```
int support = int(sigma * 3.0f);

float total = 0.0f;

weights.push_back(exp(-(0*0)/(2*sigma*sigma))/(sqrt(2*constants::pi)*sigma));
total += weights.back();

offsets.push_back(0);

for (int i = 1; i <= support; i++)
{
  float w1 = exp(-(i*i)/(2*sigma*sigma))/(sqrt(2*constants::pi)*sigma);
  float w2 = exp(-((i+1)*(i+1))/(2*sigma*sigma))/(sqrt(2*constants::pi)*sigma);

  weights.push_back(w1 + w2);
  total += 2.0f * weights[i];

  offsets.push_back((i * w1 + (i + 1) * w2) / weights[i]);
}

for (int i = 0; i < support; i++)
{
  weights[i] /= total;
} 
```

这是片段着色器（这个着色器还有另一个垂直版本）：

```
 void main()
 {
  vec3 acc = texture2D(tex_object, v_tex_coord.st).rgb*weights[0];
  for (int i = 1; i < NUM_SAMPLES; i++)
  {
    acc += texture2D(tex_object, (v_tex_coord.st+(vec2(offsets[i], 0.0)/tex_size))).rgb*weights[i];
    acc += texture2D(tex_object, (v_tex_coord.st-(vec2(offsets[i], 0.0)/tex_size))).rgb*weights[i];
  }
  gl_FragColor = vec4(acc, 1.0); 
```

这是描述该问题的屏幕截图：

![线性样本高斯模糊问题](../Images/cca094ab4b8cd4e53448a2c98a94bec5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:17:49.120

对我来说，这看起来像是一个正确的高斯模糊。文本中断的程度取决于您的`sigma`. 你在使用什么价值？

此外，我会检查您正在使用的投影的缩放矩阵。

如果您想模糊但不影响文本和细像素线，您可能会想到

*   将结果与温和高通滤波器的输出合成
*   使用较小的`sigma`
*   更改内核的形状，使其*不是*高斯的：而不是`exp(-i*i/s*s)`，您可以尝试使用具有更高超峰度的函数。您可以尝试使用线性向上/向下函数，或者使用此页面上列出的函数之一：[http](http://en.wikipedia.org/wiki/Kurtosis) ://en.wikipedia.org/wiki/Kurtosis 。它们都会导致具有不同程度破坏精细细节的模糊。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T16:15:34.823

这是双线性过滤的固有问题。这是不可避免的。

# sql - 如何使用复合键加载表

> ID：13864832
> 
> 赞同：0
> 
> 时间：2012-12-13T17:05:11.660
> 
> 标签：sql, oracle, oracle11g

我正在尝试使用 SQL 加载下表。在我的 Ldirectory 表中，我将`SY`和`LIDENTIFIER`作为主键的组合，我正在尝试运行此查询

```
insert into S_User.LDIRECTORY (SY,LIDENTIFIER,ONAME,TELNUMBER) 
select  2013,D.CODE, D.NAME, D_YEAR.PHONE_NUMBER       
from    WHS.D   WHS.D_YEAR   
where   WHS.D.D_KEY=WHS.D_YEAR.D_KEY 
```

我收到的错误是：

```
SQL Error ORA-00001 unique constraint violated

Cause:    An UPDATE or INSERT statement attempted to insert a duplicate key.
           For Trusted Oracle configured in DBMS MAC mode, you may see
           this message if a duplicate entry exists at a different level.
Action:   Either remove the unique restriction or do not insert the key. 
```

我该如何解决这个问题？我认为在插入过程中它将 SY 列视为主键本身，但我对该列只有一个相同的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:49:57.583

错误消息应指出违反的唯一约束的名称。假设所讨论的约束是主键而不是在表上定义的其他一些唯一约束，并假设主键约束是定义在 和 的组合上的复合约束`SY`，`LIDENTIFIER`正如您所指出的，这意味着您的查询正在返回重复的行。

您正在运行的查询返回 2013 的硬编码值`SY`。因此，如果结果中有任何两行相同，您会期望违反约束`D.CODE`。您确定您希望`D.CODE`在整个结果集中是独一无二的吗？根据对象的名称很难猜测（不知道`D`可能代表什么，不知道为什么`D_YEAR`会有一`PHONE_NUMBER`列等），但我倾向于猜测其中的一行`D`可能映射到多行，`D_YEAR`在这种情况下会有结果中的多行具有相同的`D.CODE`值，因此违反了约束。

如果您确信查询不应返回具有相同`D.CODE`值的任何两行，则可以使用 DML 错误日志记录将违反约束的行写入错误表，以便分析问题。

# javascript - 跨域帧通信

> ID：13864836
> 
> 赞同：1
> 
> 时间：2012-12-13T17:05:29.437
> 
> 标签：javascript, html, cross-domain

我们有 2 个 Web 应用程序，它们在 2 个不同的框架（A 和 B）中显示信息。A 中的 javascript 读取 B 的隐藏字段并根据隐藏字段的值采取一些行动。A还负责加载B的第一页，B可以有​​多个页面，A的命令可以在B的任何页面中，B的页面是根据B的当前状态动态构建的A 和 B 来自同一个域。但在某些情况下（应用程序的性能和架构），我们需要让 A 和 B 来自 2 个不同的域，在这种情况下，跨域限制不允许 A 读取 B 隐藏字段。我尝试使用 Access-Control-Allow-Origin 但它在浏览器中已加载的 2 个框架之间不起作用。

有人有解决问题的想法吗

坦率

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T07:41:22.440

在同一窗口中有来自不同域的多个 iframe 的情况下 - 您应该使用[postMessage API](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)，它可以在 iframe 之间发送消息（无论来源如何）。但是，您必须更改两个 iframe 中的代码才能使 postMessage 正常工作。

基本上，不是 A 读取 B 的字段，而是 A 会向 B 发送一条消息，告诉它它想要读取它的字段，然后 B 会向 A 发送另一条消息，其中包含这些字段中的数据。

您还可以尝试使用一些基于 postmessage 的更高级的库，例如[jsChannel](https://github.com/mozilla/jschannel)和[pmrpc](https://github.com/izuzak/pmrpc)，它们使您能够以更自然的方式（远程过程调用）在 iframe 之间进行通信，而不是发送消息。

# winforms - WinForms：如何获取对已加载表单的引用

> ID：13864837
> 
> 赞同：0
> 
> 时间：2012-12-13T17:05:40.980
> 
> 标签：winforms, wcf, reflection

我有一个 Windows 窗体应用程序，它在加载时启动一个线程。该线程启动一个公开 WCF 服务的 ServiceHost。

这里是启动线程的代码：

```
Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim th As New Thread(AddressOf (New Ecoute).Ecouter)
    th.Start()
End Sub 
```

这里是创建服务主机的代码

```
Sub Ecouter()
    host = New ServiceHost(GetType(ServiceEmulateur3270))

    host.AddServiceEndpoint(GetType(IEmulateur3270), New NetNamedPipeBinding(), "net.pipe://localhost")

    host.Open()
End Sub 
```

当我收到 WCF 调用时，在服务的被调用方法中，我想更新应用程序主窗体中的控件。我怎样才能得到这个表格的参考？

我找到了这个[Winforms，通过表单名称获取表单实例，](https://stackoverflow.com/questions/12091818/winforms-get-form-instance-by-form-name)但这显示了如何创建表单的新实例，但我想获取当前加载的表单。

或者，线程是否可以将表单的引用传递给 WCF 服务类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:14:58.607

例如，您应该使用[ParameterizedThreadStart](http://msdn.microsoft.com/en-us/library/1h2f2459.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2)构造函数并传递 Form 实例，如下所示：

```
Dim th As New Thread(AddressOf (New Ecoute).Ecouter)
th.Start(this)

Sub Ecouter(ByVal data As Object)
' you can safely cast data as a Form
End Sub 
```

# jquery - jQuery submit() 在 FF/Chrome 中工作（如预期的那样），但在 IE/Opera 中不工作，有什么想法吗？

> ID：13864838
> 
> 赞同：1
> 
> 时间：2012-12-13T17:05:42.330
> 
> 标签：jquery, html, forms, dom, submit

我正在使用一些 javascript 来检查表单字段与可能匹配的数组。取决于匹配用户是否显示确认窗口，并且取决于结果表单是否提交或用户返回到页面。此过程在 Firefox 和 Chrome 中按预期工作，但在 IE 和 Opera 中仍会触发替代提交。谁能建议我如何解决这个问题？

为简单起见，脚本已删除大部分数据。

```
$(function(){
    var check = ["All", "array", "values"];
    $('#Next').click(function(){
        $(this).addClass('hit');
        $('#Cancel').attr('disabled', 'disabled');
    });
    $('#Form').bind('submit', function(){
        if($(this).find('.hit').attr('id')=='Next'){
            $('#Next').removeClass('hit');
            var match = $('input[name="WHAT"]', $('#idBothAddressesTable')).val().trim();
            if(match.length==0){
                var postCode = $('input[name="WHAT2"]', $('#idBothAddressesTable')).val().trim();
            }
            var matched = $.inArray(match, check);
            if(matched != -1){
                var ask = confirm("This is the case, proceed or cancel");
                if(ask==true){
                        $.post('dowhat.php',{flag: 1}, function()){
                        $('#Form').unbind('submit').submit();
                    });
                }
                else{
                    ('#Cancel').removeAttr('disabled');
                    return false;
                }
            }
        }
    });
}); 
```

表单实际上有两个提交值。除此之外非常基本，为简单起见再次修剪了大部分。

```
<form action="nextpage.php" method="post" id="Form">
    <input type="text" name="WHAT" />
    <input type="text" name="WHAT2" />
    <input type="submit" name="CANCEL" value="Cancel" id="Cancel" />
    <input type="submit" name="NEXT" value="Next" id="Next" />
</form> 
```

在 Firefox 和 chrome 中，当有人遇到 ask==true 标准时，这似乎可以工作。$.post 继续并提交表单，就像单击“NEXT”提交一样。

然而，在 IE 和 Opera 中，会出现 $.post，但提交表单时就像点击了“取消”一样。

谁能给我解释一下，我似乎找不到解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:32:32.943

**我不建议`submit`在一个表单上使用两个按钮**。 [根据规范](http://www.w3.org/TR/html401/interact/forms.html#h-17.2.1)，它是有效的 HTML，但 IMO 是一种不好的做法。

无论您按下哪个按钮，您都在执行一个`submit`事件，而不会阻止预期的默认行为。

`bind`此外，使用jQuery ，您正在`submit`使用`form`, 但`submit`默认情况下已经绑定到表单。您可以尝试以下方法，但我仍然强烈建议您重构代码以摆脱第二个`submit`按钮并用其他东西替换它。

[试`preventDefault()`](http://api.jquery.com/event.preventDefault/)...

```
$('#Form').bind('submit', function(e){ // don't forget the "e"
        e.preventDefault(); // first line

        // rest of your code follows under preventDefault

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:17:01.560

您有一个带有**两个提交按钮**的表单，并且您正在告诉要提交的表单。

结果是不确定的：每个浏览器都以自己的方式处理它！所以，我建议你**调用你需要调用的提交按钮的点击事件**，而不是告诉表单提交。

# iphone - 防止 CollectionView 填充父级

> ID：13864842
> 
> 赞同：0
> 
> 时间：2012-12-13T17:05:53.653
> 
> 标签：iphone, ios

我的收藏视图填满了整个视图。我怎样才能让它保持它在故事板设计器中的大小？见图片。

![在此处输入图像描述](../Images/2c10a7340b2c217d8bc5b6e930b46dbf.png)

# yii - Yii FullcalendarGraphWidget 如何提供 $model->search(); FullCalendar 的结果？

> ID：13864845
> 
> 赞同：1
> 
> 时间：2012-12-13T17:06:00.597
> 
> 标签：yii, fullcalendar, yii-extensions

而不是 CGridView 我使用 fullCalendar 扩展在日历中显示我的数据作为事件。除此之外，我还有过滤器选项。

在 CGridView 中我们可以编写`'dataProvider'=>$model->search(),`来获取搜索数据。同样，我如何向 fullCandar 扩展提供相同的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T17:40:39.487

我通过如下方式获取控制器中的数据并将其转换为 fullcalendar 期望的形状的数组来做到这一点：

```
public function actionCalendar() 
{
    $data=CalendarEntry::model()->findAll();

    $model = array();
    foreach ($data as $item) {
        array_push($model, array(
            'id' => $item->id,
            'title' => $item->datetext,
            'start' => $item->datedate,
            'url' => CController::createUrl('calendar/view', array ('id' => $item->id)),
        ));
    };
    $this->render('calendar',array('model'=>$model));
} 
```

然后在我的日历视图中，我只是设置模型：

```
$this->widget('application.extensions.fullcalendar.FullcalendarGraphWidget',
    array(
        'data'=> $model,        

        'htmlOptions'=>array(
               'style'=>'width:800px;margin: 0 auto;'
        ),
    )
); 
```

# jquery - jQuery 库中的立即函数调用

> ID：13864849
> 
> 赞同：0
> 
> 时间：2012-12-13T17:06:07.787
> 
> 标签：jquery

> **可能重复：**
> [此 JavaScript/JQuery 语法如何工作：(function(window, undefined) {})(window)？](https://stackoverflow.com/questions/2716069/how-does-this-javascript-jquery-syntax-work-function-window-undefined)

我试图分解 jQuery 的一些部分，以更好地了解幕后发生的事情。在大多数情况下，我对它的很多方法都很清楚，但是第一行代码看起来像这样：

```
(function( window, undefined ) { 
```

图书馆就这样结束了

```
})( window ); 
```

我知道这是立即函数调用，但是这对 jQuery 库有什么作用？我不确定我在看什么。

另外，这对我们还有什么用处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:11:13.607

它将当前窗口对象传递给 jQuery，因此它具有对窗口的引用作为本地对象。

它也没有传入第二个参数，因此未定义将真正是“未定义”。这样做的原因是它可以分配一个未定义的值，所以通过期望一个值作为第二个参数，但没有得到一个，jQuery 向自己保证它确实有未定义的。

# javascript - 无法通过ajax读取json文件

> ID：13864851
> 
> 赞同：-1
> 
> 时间：2012-12-13T17:06:36.287
> 
> 标签：javascript, jquery

在我的代码中，我有：

```
 $.ajax({
       url: 'http://chapters.zmgc.net',
       dataType: 'jsonp',
      success: function(d){   // "Type","Name","Link","Contact","Location","Icon"
        Tabzilla.zgContacts = d;
        var countries = [];
        d.rows.forEach(function(row){
          if (row[0] == 'Country') countries.push(
            {link:row[2], contact:row[3], country: row[4]}
          );     
        }); 
```

但我收到一个错误，Uncaught SyntaxError: Unexpected token ：

```
{
 "kind": "fusiontables#sqlresponse",
.... 
```

如果我用实际文件替换 url 并删除 dataType，一切都按预期工作！

我已经在[http://jsonlint.com/验证了](http://jsonlint.com/)[http://chapters.zmgc.net](http://chapters.zmgc.net)的输出，没关系。

查看从[http://chapters.zmgc.net](http://chapters.zmgc.net)返回的响应标头，它是：

```
Connection:keep-alive
Content-Type:application/json
Date:Thu, 13 Dec 2012 17:02:27 GMT
Transfer-Encoding:chunked 
```

这是代码[https://github.com/tomarcafe/Z-Tabzilla/blob/gh-pages/z-tabzilla.js#L282](https://github.com/tomarcafe/Z-Tabzilla/blob/gh-pages/z-tabzilla.js#L282)我想用读取远程数据替换本地文件？

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:13:43.897

您不应该将 type 设置为`jsonp`，即带有填充的 JSON，因为它假定响应包含在函数调用中。

`callback({payload: values});`

并将试图被处决。

而是使用 type: json，或者简单地使用 .json`$.getJSON`正确传递 JSON 有效负载`$.parseJSON`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:10:06.533

这是因为您要求 JSONP（带填充的 JSON）并获得不带填充的 JSON。JSONP 是由函数调用填充的 JSON，使其工作的唯一方法是在服务器上添加对 JSONP 的支持。

如果您无权访问，`chapters.zmgc.net`则必须联系他们并要求他们添加对 JSONP 的支持。

如果您确实有权访问，您可以添加`?callback=parseThis`到您的 url，然后在服务器端读取该变量并相应地填充您的 JSON：

```
parseThis(/* put your json in here */); 
```

但是，如果您没有定义自己的回调，jQuery 会自动添加一个您可以使用的回调。它们看起来像这样：`jQuery18200710562220774591_1355419375476`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:18:37.790

由于 Ajax 使用 jsonp（带填充的 json），但您的 url 似乎与 jsonp 不兼容，因此您必须避免使用它。

来自 jQuery：

> “jsonp”：使用 JSONP 加载到 JSON 块中。添加一个额外的“？callback =？” 到 URL 的末尾以指定回调。通过将查询字符串参数“_=[TIMESTAMP]”附加到 URL 来禁用缓存，除非缓存选项设置为 true。

更多：http: [//bob.ippoli.to/archives/2005/12/05/remote-json-jsonp/](http://bob.ippoli.to/archives/2005/12/05/remote-json-jsonp/)

# php - 如何创建一个适用于 php() 循环结果的 jquery 按钮并在单击时显示消息表单？

> ID：13864857
> 
> 赞同：0
> 
> 时间：2012-12-13T17:07:00.030
> 
> 标签：php, mysql, html

我正在尝试创建一个按钮来显示隐藏的消息表单并在使用 jquery 单击提交按钮后隐藏表单。此按钮与嵌入在 while() 循环中的 php for() 循环的结果一起使用，该循环从我的数据库中选择和排列信息，因此 while() 循环的每个结果都有其下方的消息按钮。现在，我的问题是，在设置了所有循环和 jquery 代码之后，一切正常，除了消息按钮在单击时适用于所有结果，这不是我想要的。我需要按钮单独工作，这样当单击循环结果下的按钮时，只有一个表单会在循环结果下向下滑动，如果在另一个结果下单击另一个消息按钮，则任何打开的表单都会关闭，新的表单会打开. 总之，我需要按钮为每个循环结果独立工作。这是我使用的代码，但没有给我想要的结果。请帮助...

```
<?php
session_start();
include("databaselogin.inc");
mysql_select_db($database,$cxn);
$query="SELECT * from table1";
$result=mysql_query($query,$cxn) or die ("Couldn't execute query.". mysql_error());
$section=$_POST['section'];
?>
.
.
.
.
.
<script type="text/javascript" src="../jquery-1.3.2-vsdoc2.js"></script>
<script type="text/javascript"> 
$(document).ready(function(){
$("div#show1").hide();
$("button#show2").click(function(){
  $("div#show1").toggle(500);
    });
    $("a#show3").click(function(){
  $("div#show1").hide(500);
    });
});
</script>

<?php
while ($row=mysql_fetch_array($result))
{
$query1="SELECT * from table2 WHERE Email='$row[Email]'";
$result1=mysql_query($query1,$cxn) or die ("Couldn't execute query.". mysql_error());
$row1=mysql_fetch_array($result1);
for ($i=1; $i<=3; $i++)
    {
       if ($row['section1'."$i"]=="$section")
       {
        echo '<table height="130" width="220" border="1" style="border:thin"><tr height="104"><td width="60" valign="top" align="center">';
        echo '<center>';
        echo '<div style="line-height:80%">';
        echo '<img border="1" src="';
        echo $row['image'."$i"];
        echo '"width="80" alt="Your Name" height="78">';
        echo '</center>';
        echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">';
        echo $row['section2'."$i"];
        echo '</font>';
        echo '</div>';
        echo '</td><td width="184" align="center" valign="top"><table cellpadding="0" cellspacing="0"><tr><td bgcolor="#9900CC" width="174"><center><b><font face="Comic Sans MS, Colonna MT, Juice ITC" size="3" color="#ffffff">DESCRIPTION</font></b></center></td></tr><tr><td align="left" valign="top">';
        echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">';
        echo $row['section3'."$i"];
        echo '</font>';
        echo '</td></tr></table><tr height="50" bgcolor="#9900CC"><td colspan="2" bgcolor="#ffffff">';
        echo '<div style="line-height:80%">';
        echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">';
        echo $row1['port1'];
        echo '</font>';
        echo '<br />';
        echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC"><span style="white-space:pre">';
        echo $row1['port2'];
        echo '                                PRICE: ';
        echo $row['section4'."$i"];
        echo '</span>';
        echo '<br /><span style="white-space:pre">';
        echo $row1['port3'];
        echo '                                                 ';
        echo $row['section5'."$i"];
        echo '</span></font>';
        echo '</div>';
        echo '</td></tr>';
        echo '<tr height="10" bgcolor="#9900CC"><td colspan="2" bgcolor="#FDF4FD" style="border:none; line-height:30%" valign="top">';
        echo '<span style="white-space:pre"><button id="show2" style="border:none"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC">message</font></button>';
        echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC"> | </font>';
        echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC">comment</font></span>';
        echo '</td></tr></table>';
?>
          <!-- START DIV that contains the Private Message form -->
          <div id="show1">
          <table>
<form method="post" action="">
<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">Send a Message to <strong><?php echo $row1['port1']; ?></strong></font>
<tr><td align="right" width="80"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">First Name:</font></td><td width="200"><input name="sender" type="text" maxlength="30" style="width:100%" /></td></tr>
<tr><td align="right" width="80"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">Subject:</font></td><td width="200"><input name="pmSubject" id="pmSubject" type="text" maxlength="64" style="width:100%" /></td></tr>
<tr><td align="right" width="80" valign="top"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">Message:</font></td><td width="200"><textarea name="pmTextArea" id="pmTextArea" rows="5" style="width:100%"></textarea></td></tr>
  <input name="pm_rec_name" id="pm_rec_name" type="hidden" value="<?php echo port4; ?>" />
  <span id="PMStatus" style="color:#F00;"></span>
  <br /><tr><td colspan="2"><span style="white-space:pre"><input name="pmSubmit" type="submit" value="Send" /><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC"> or <a href="#" id="show3">Close</a></font></span>
<span id="pmFormProcessGif" style="display:none;"><img src="../loading.gif" width="28" height="10" alt="Loading" /></span></td></tr></form>
</table>
          </div>
          <!-- END DIV that contains the Private Message form -->
<?php
echo '<br />';  
       }
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:27:11.927

好的，我没有对此进行测试，但我所做的是将 javascript 放入循环中并每次重命名它以及除法、按钮和链接。如果您为它们设置样式，则需要添加一个类并重新设置它们的样式。

```
 <?php
    session_start();
    include("databaselogin.inc");
    mysql_select_db($database,$cxn);
    $query="SELECT * from table1";
    $result=mysql_query($query,$cxn) or die ("Couldn't execute query.". mysql_error());
    $section=$_POST['section'];
    ?>
    <script type="text/javascript" src="../jquery-1.3.2-vsdoc2.js"></script>
    <?php
    while ($row=mysql_fetch_array($result))
    {

    $query1="SELECT * from table2 WHERE Email='$row[Email]'";
    $result1=mysql_query($query1,$cxn) or die ("Couldn't execute query.". mysql_error());
    $row1=mysql_fetch_array($result1);
    for ($i=1; $i<=3; $i++)
        {
$show1 = rand(1, 1000);
    $show2 = rand(1001, 2000);
    $show3 = rand(2001, 3000);
    ?>
    <script type="text/javascript"> 
    $(document).ready(function(){
    $("div#<?PHP echo $show1; ?>").hide();
    $("button#<?PHP echo $show2; ?>").click(function(){
      $("div#<?PHP echo $show1; ?>").toggle(500);
        });
        $("a#<?PHP echo $show3; ?>").click(function(){
      $("div#<?PHP echo $show1; ?>").hide(500);
        });
    });
    </script>
    <?PHP
           if ($row['section1'."$i"]=="$section")
           {
            echo '<table height="130" width="220" border="1" style="border:thin"><tr height="104"><td width="60" valign="top" align="center">';
            echo '<center>';
            echo '<div style="line-height:80%">';
            echo '<img border="1" src="';
            echo $row['image'."$i"];
            echo '"width="80" alt="Your Name" height="78">';
            echo '</center>';
            echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">';
            echo $row['section2'."$i"];
            echo '</font>';
            echo '</div>';
            echo '</td><td width="184" align="center" valign="top"><table cellpadding="0" cellspacing="0"><tr><td bgcolor="#9900CC" width="174"><center><b><font face="Comic Sans MS, Colonna MT, Juice ITC" size="3" color="#ffffff">DESCRIPTION</font></b></center></td></tr><tr><td align="left" valign="top">';
            echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">';
            echo $row['section3'."$i"];
            echo '</font>';
            echo '</td></tr></table><tr height="50" bgcolor="#9900CC"><td colspan="2" bgcolor="#ffffff">';
            echo '<div style="line-height:80%">';
            echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">';
            echo $row1['port1'];
            echo '</font>';
            echo '<br />';
            echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC"><span style="white-space:pre">';
            echo $row1['port2'];
            echo '                                PRICE: ';
            echo $row['section4'."$i"];
            echo '</span>';
            echo '<br /><span style="white-space:pre">';
            echo $row1['port3'];
            echo '                                                 ';
            echo $row['section5'."$i"];
            echo '</span></font>';
            echo '</div>';
            echo '</td></tr>';
            echo '<tr height="10" bgcolor="#9900CC"><td colspan="2" bgcolor="#FDF4FD" style="border:none; line-height:30%" valign="top">';
            echo '<span style="white-space:pre"><button id="'.$show2.'" style="border:none"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC">message</font></button>';
            echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC"> | </font>';
            echo '<font face="Comic Sans MS, Colonna MT, Juice ITC" size="1" color="#9900CC">comment</font></span>';
            echo '</td></tr></table>';
    ?>
              <!-- START DIV that contains the Private Message form -->
              <div id="<?PHP echo $show1; ?>">
              <table>
    <form method="post" action="">
    <font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">Send a Message to <strong><?php echo $row1['port1']; ?></strong></font>
    <tr><td align="right" width="80"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">First Name:</font></td><td width="200"><input name="sender" type="text" maxlength="30" style="width:100%" /></td></tr>
    <tr><td align="right" width="80"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">Subject:</font></td><td width="200"><input name="pmSubject" id="pmSubject" type="text" maxlength="64" style="width:100%" /></td></tr>
    <tr><td align="right" width="80" valign="top"><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC">Message:</font></td><td width="200"><textarea name="pmTextArea" id="pmTextArea" rows="5" style="width:100%"></textarea></td></tr>
      <input name="pm_rec_name" id="pm_rec_name" type="hidden" value="<?php echo port4; ?>" />
      <span id="PMStatus" style="color:#F00;"></span>
      <br /><tr><td colspan="2"><span style="white-space:pre"><input name="pmSubmit" type="submit" value="Send" /><font face="Comic Sans MS, Colonna MT, Juice ITC" size="2" color="#9900CC"> or <a href="#" id="<?PHP echo $show3; ?>">Close</a></font></span>
    <span id="pmFormProcessGif" style="display:none;"><img src="../loading.gif" width="28" height="10" alt="Loading" /></span></td></tr></form>
    </table>
              </div>

              <!-- END DIV that contains the Private Message form -->

    <?php
    echo '<br />';  
           }
        }
    }
    ?> 
```

# ios - 如何让我的自定义手势识别器类实例同时工作？

> ID：13864858
> 
> 赞同：0
> 
> 时间：2012-12-13T17:07:05.200
> 
> 标签：ios, objective-c, cocoa-touch, delegates, uigesturerecognizer

您可以从此 libk 下载代码示例： [https ://github.com/mriddi/ExempleCustomGestureRecognizer.git](https://github.com/mriddi/ExempleCustomGestureRecognizer.git)

我像这样创建我的自定义手势识别器类：

```
@protocol MyGestureRecognizerDelegate <UIGestureRecognizerDelegate>
@optional
-(void) willDo;
@end

@interface MyGestureRecognizer: UIGestureRecognizer
{
    …
}
@property (nonatomic, assign) id <MyGestureRecognizerDelegate> delegate;
…
@end

@implementation MyGestureRecognizer
@synthesize delegate;
…
-(void) call{
    [delegate willDo];
}
…
@end 
```

我的 ViewController 采用`MyGestureRecognizerDelegate`协议。在`ViewController`我创建我的类的实例：

```
MyGestureRecognizer * grFerst;
MyGestureRecognizer * grSecond;
grFerst.delegate=self;
grLeft.delegate=self;
[self.view addGestureRecognizer: grFerst];
[self.view addGestureRecognizer: grSecond]; 
```

我想让两个手势识别器实例同时工作。我尝试添加到我的`ViewController`方法中

[shouldRecognizeSimultaneouslyWithGestureRecognizer](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIGestureRecognizerDelegate_Protocol/Reference/Reference.html)

但是这个方法从不调用，我用`NSLog`函数检查了它。

请帮我解决这个问题（允许同时使用两个手势识别器）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:31:30.057

也许你应该分配手势

```
MyGestureRecognizer * gesture = [[MyGestureRecognizer alloc] initWithTarget:self action:nil];
gesture.delegate = self;
[self.view addGestureRecognizer:gesture]; 
```

或者您可以使用控制轮作为目标并在那里进行所有角度计算。然后你委托回 mainViewController。

# objective-c - 通过方法objective-C保留数组数据

> ID：13864859
> 
> 赞同：0
> 
> 时间：2012-12-13T17:07:07.953
> 
> 标签：objective-c, arrays, retain

我希望我不会重复现有问题，但我在使用 OpenGL ES 在 Objective-C 中保留数据数组时遇到了一些问题。这是交易：

我有这个类具有以下属性：

```
@property GLfloat* data; 
```

这个类有一个方法，结束于：

```
-(void)loadObj {
     (...)
     GLfloat glData[n];
     (...) //populate glData array
     self.data = glData;
     NSLog(@"%i", self.data[1]) 
 } 
```

回到我的主目录，我创建了一个该类的实例并继续调用 loadObj 函数。

```
loader = [[ObjLoader alloc] init];
[loader loadObj];
data = loader.data;
NSLog(@"%i", data[1]) 
```

不幸的是，它的数据数组由于某种原因丢失了它的信息

在第一次打印时，值都在那里，它们的预期方式。但是，在第二个方面，几乎没有保留任何数据。

有什么办法可以防止这种情况发生吗？我想指出，使用 NSMutable 数组是不可能的，因为我需要数据类型为 GLfloat

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:11:27.077

由于 a`GLfloat`是与 Objective-C 无关的 C 类型定义，因此您无法通过使用任何 Objective-C 特性来保留它。

您的示例中的问题是这`GLfloat glData[n]`是一个自动分配到堆栈上的数组。当您声明它的函数返回给调用者时，指向的数据不再有效。

你应该怎么做它自己管理内存：

```
-(void)loadObj {
     (...)
     GLfloat *glData = calloc(n, sizeof(GLfloat));
     (...) //populate glData array
     self.data = glData;
 } 
```

通过这种方式，您在堆中分配数组，并且在函数退出时它不会变得无效。请注意，此内存不是由 Objective-C 管理的，因此您有责任在需要时释放它，例如

```
-(void)dealloc {
  free(self.data);
  [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:10:39.313

问题是它 `GLfloat glData[n];`是在堆栈上分配的，即，一旦您离开该方法，它就会被释放。您需要使用堆分配内存：

```
-(void)loadObj {
     (...)
     GLfloat *glData = (GLfloat*)malloc(n*sizeof(GLfloat)); //don't forget to free it
     (...) //populate glData array
     self.data = glData;
     NSLog(@"%i", self.data[1]) 
 } 
```

# php - 用于 s3 的 Web 文件管理器，在 PhP 中具有 DB 文件夹结构

> ID：13864864
> 
> 赞同：2
> 
> 时间：2012-12-13T17:07:17.510
> 
> 标签：php, amazon-s3

我正在寻找满足应用程序需求的解决方案。我需要一个与 Amazon S3 存储桶配合使用的基于 Web 的文件管理器/浏览器。我发现的大多数潜在解决方案的问题是它们以某种方式依赖 s3 来维护目录层次结构。这很糟糕，因为这意味着在遍历文件夹（并列出其内容）时会产生额外的延迟。

我想要的是一个 php 应用程序/类，它在数据库中维护目录结构（和文件名），以便快速列出/遍历文件和目录，并且仅在实际下载或上传文件时才访问 s3。

有谁知道这样的事情？我希望有些东西已经存在，而不是花时间从头开始构建。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:11:14.247

我绝对推荐使用[Gaufrette](https://github.com/KnpLabs/Gaufrette)。

它抽象了文件系统，因此您只需切换适配器即可在本地存储、FTP、SFTP、S3 等之间切换

# sql - 简单的sql字符串修正

> ID：13864873
> 
> 赞同：-1
> 
> 时间：2012-12-13T17:07:35.640
> 
> 标签：sql, sqlite

我的 sqlite3 数据库中有 2 个表。有人可以帮助我使用下面的 sql 命令：

`tbltrans`：

```
transid |  transdate | discountpercentage | Bank
12345     10/09/2011     5                  20.00 
```

`tbltrans2`：

```
transid   |   itemnr   |price | btwpercentage | qty
12345         205        10.11        12        5
12345         302        15.00        6         7
12345         501        20.00        21        3 
```

我的第一个问题是：

1.  我想获得一个查询表，其中包含每个 transid 的总销售额和计算出的现金，例如：

    ```
    Select
        Sum(tbltrans2.qty * tbltrans2.price) as TotalAmount,
        (Totalamount - tbltrans.Bank) as Cash
    where 
        tbltrans.transid = tbltrans2.transid 
        and transdate = '10/09/12' 
    ```

    有人可以更正这个 SQL 语句吗？

**-- 下面这个问题已经解决了 --**

那么，任何人都可以更正我的 sql 代码以使用此表布局：

```
select 
    sum(price * qty - (price * qty) * (tbltrans.discountpercentage / 100)  
from 
    tbltrans2 
where 
    btwpercentage = 6) as total6 ,
  sum(price * qty - (price*qty)*(tbltrans.discountpercentage /100) from tbltrans2 where btwpercentage =12) as total12,
sum(price * qty - (price*qty)*(tbltrans.discountpercentage /100) from tbltrans2 where btwpercentage =21) as total21
 where transdate = date('10/09/2011') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:18:01.600

您应该能够加入表格并使用以下内容：

```
select 
  sum(case when t2.btwpercentage =6 then
        t2.price * t2.qty - (t2.price * t2.qty* t1.discountpercentage /100) end) Total6,
  sum(case when t2.btwpercentage =12 then
        t2.price * t2.qty - (t2.price * t2.qty* t1.discountpercentage /100) end) Total12,
  sum(case when t2.btwpercentage =21 then
        t2.price * t2.qty - (t2.price * t2.qty* t1.discountpercentage /100) end) Total21
from tbltrans t1
left join tbltrans2 t2
  on t1.transid = t2.transid
where transdate = date('10/09/2011') 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!7/1c0f5/1)

根据您的评论，您还可以使用：

```
select count(t1.transid) Total,
  sum(case when t2.btwpercentage =6 then
        t2.price * t2.qty - (t2.price * t2.qty* t1.discountpercentage /100) end) Total6,
  sum(case when t2.btwpercentage =12 then
        t2.price * t2.qty - (t2.price * t2.qty* t1.discountpercentage /100) end) Total12,
  sum(case when t2.btwpercentage =21 then
        t2.price * t2.qty - (t2.price * t2.qty* t1.discountpercentage /100) end) Total21
from tbltrans t1
left join tbltrans2 t2
  on t1.transid = t2.transid
where transdate = date('10/09/2011') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:40:59.657

如果您希望您的查询基本上按照书面形式工作，那么您需要添加一个`from`子句：

```
Select 
sum(price * qty - (price*qty)*(tbltrans.discountpercentage /100) from tbltrans2 where btwpercentage =6) as total6 ,
 sum(price * qty - (price*qty)*(tbltrans.discountpercentage /100) from tbltrans2 where btwpercentage =12) as total12,
sum(price * qty - (price*qty)*(tbltrans.discountpercentage /100) from tbltrans2 where btwpercentage =21) as total21
from tbltrans
 where transdate = date('10/09/2011') 
```

然而，bluefeet 提供了一个更简洁的版本，尽管我会将选择逻辑编写为：

```
sum(case when t2."btwpercentage" =6
         then  t2."price"*t2."qty" * (1 - t1."discountpercentage" /100.0)
     end) Total6, 
```

# firebug-lite - Firebug lite 在 IE/Chrome 中不工作

> ID：13864874
> 
> 赞同：1
> 
> 时间：2012-12-13T17:07:41.363
> 
> 标签：firebug-lite

我正在尝试将 firebug lite 安装到 IE 和 Chrome 上。文档声明只需在文档中添加 javascript 位置，一切都应该很好。这可行，但包含然后萤火虫的 iframe 被隐藏，具有可见性：隐藏属性。我无法找到任何地方来实际激活萤火虫，通常你会认为你可以右键单击并“检查”，但该选项不存在。chrome 扩展和小书签可以工作，但我主要关心的是试图通过 Internet Explorer 进行萤火虫攻击。

有人遇到过或解决过这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-04T19:45:30.753

是的，我在使用稳定频道时遇到了同样的问题。我切换到调试通道，它工作得很好，打开了。所以使用这个：

```
<script type="text/javascript" src="https://getfirebug.com/firebug-lite-debug.js"></script> 
```

此外，我发现在页面底部放置一个 300 像素高的快速 div 为 Firebug Lite 腾出空间很有用，如下所示：

```
<div style="display:block; height:300px; background:blue;"></div> 
```

只是不要忘记使用 FBL 脚本标签将其删除！

# java - 我正在使用一个程序来分析我的 Java 代码，但我不明白错误或如何修复它

> ID：13864878
> 
> 赞同：0
> 
> 时间：2012-12-13T17:07:54.460
> 
> 标签：java, encoding

我正在使用马里兰大学的 FindBug 程序，它给了我这个错误。

我已经在许多平台上测试了我的代码并且它可以工作，那么为什么这个代码是不好的做法，我可以做些什么来改进它？

![代码截图](../Images/7db37c0929a021b184b3ebd4beba7fa2.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:10:17.253

它告诉您未指定编码（如何将字符串转换为字节）。

如果您在土耳其编写一个文本文件，然后在乌兹别克斯坦加载它，那么您可能会得到不同的结果。相反（例如）您可以通过使用指定的编码自己将字符串转换为字节来直接指定编码（参见[String.getBytes](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#getBytes%28java.nio.charset.Charset%29)的示例）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:16:07.983

您需要指定字符集

您可以使用[OutputStreamWriter](http://docs.oracle.com/javase/6/docs/api/java/io/OutputStreamWriter.html)

```
fileWriter = new OutputStreamWriter(new FileOutputStream(file),charset); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:14:43.030

请参阅[FileWriter](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File%29)文档：“此类的构造函数假定默认字符编码和默认字节缓冲区大小是可接受的。要自己指定这些值，请在 FileOutputStream 上构造一个 OutputStreamWriter。”

依赖默认字符编码可能被认为是不好的做法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T17:14:50.550

使用[`FileOutputStream`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileOutputStream.html), 而不是`FileWriter`. 可以使用 包装[`OutputStreamWriter`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/OutputStreamWriter.html#OutputStreamWriter)，它[允许您在构造函数中传递编码](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/OutputStreamWriter.html#OutputStreamWriter)。

否则，正如 Jeff 所说，数据将无法正确加载。

### [例子](http://cafeconleche.org/books/xmljava/chapters/ch03s03.html)

```
OutputStream fout = new FileOutputStream("test.txt");  
OutputStream bout = new BufferedOutputStream(fout);  
OutputStreamWriter out = new OutputStreamWriter(bout, "UTF-8"); 
```

# php - 使用空输出触发错误

> ID：13864879
> 
> 赞同：1
> 
> 时间：2012-12-13T17:08:03.303
> 
> 标签：php, mysql, sql, syntax, triggers

这是我的触发器：

```
create trigger wyplacamy before insert on `skladki_wyplaty`
for each row
BEGIN
  SELECT p.wysokosc_skladki, p.ilosc_miesiecy INTO @wysokosc_skladki, @ilosc_miesiecy
    FROM skladki_aktualne p
    WHERE p.pesel = NEW.pesel AND p.id_ubezpieczenia = NEW.id_ubezpieczenia;

  SET NEW.wyoskosc_wyplaty = @wysokosc_skladki / @ilosc_miesiecy *75;
END
$$ 
```

这可行，但“wyoskosc_wyplaty”的 iutpput 为 NULL，甚至 wysokosc_skladki = 8000 和 ilosc_miesiecy = 8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:15:04.827

您需要在使用它们之前声明变量。

```
delimiter $$
create trigger wyplacamy before insert on `skladki_wyplaty`
for each row
BEGIN

  DECLARE var_wysokosc_skladki INT;
  DECLARE var_ilosc_miesiecy INT; 

  SELECT p.wysokosc_skladki, p.ilosc_miesiecy INTO var_wysokosc_skladki, var_ilosc_miesiecy
  FROM skladki_aktualne p
  WHERE p.pesel = NEW.pesel 
  AND p.id_ubezpieczenia = NEW.id_ubezpieczenia;

  SET NEW.wyoskosc_wyplaty = var_wysokosc_skladki / var_ilosc_miesiecy * 75;

END
$$ 
```

# plugins - 用于组织标签的插件

> ID：13864881
> 
> 赞同：0
> 
> 时间：2012-12-13T17:08:05.267
> 
> 标签：plugins, tags, alignment, dreamweaver, notepad++

任何人都知道任何程序（例如dreamweaver，记事本++）的任何插件，它组织标签并对齐它们？

例如：

前：

```
<body>
<div>
         <ul>
                 <li> </ li>
                                 <li> </ li>
         <li> </ li>
</ ul>
                 </ div>
         </ body> 
```

然后：

```
<body>
         <div>
                 <ul>
                         <li> </ li>
                         <li> </ li>
                         <li> </ li>
                 </ ul>
         </ div>
</ body> 
```

多谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T11:26:43.603

一种解决方案是使用 Notepad++ 插件 TextFX HTMLTidy。

不幸的是，在最近的 Notepad++ 版本中，由于某种原因，该插件没有正确设置，但请在此处查看 Noah 的解决方案：[Notepad++ HTML Tidy](https://stackoverflow.com/questions/809636/notepad-html-tidy)以获取有关如何启动和运行它的说明：

# android - Android：在 Intents 中使用 Extras 时出现 NullPointerException

> ID：13864882
> 
> 赞同：0
> 
> 时间：2012-12-13T17:08:05.283
> 
> 标签：android, android-intent, extras

当我尝试从意图中获取额外内容时，请得到 NullPoiterException。当我打电话时，错误就被抛出了

```
int posizione2 =Integer.parseInt((getIntent().getExtras().getString(Intent.EXTRA_TEXT))); 
```

非常感谢任何帮助！

```
private void aggiungiImm(View arg1, int arg2) {
    Intent i=newintent(Intent.ACTION_PICK,ContactsContract.Contacts.CONTENT_URI);
    i.putExtra(Intent.EXTRA_TEXT, Integer.toString(arg2));
    startActivityForResult(i, PICK_REQUEST);    
}    

@Override
protected void onActivityResult(int requestCode, int resultCode,Intent data) {
    Uri contactData=null;
    if (requestCode==PICK_REQUEST) {
    if (resultCode==RESULT_OK) {
    contactData=data.getData();                     
    int posizione2 =Integer.parseInt((getIntent().getExtras().getString(Intent.EXTRA_TEXT))); 
```

编辑：到目前为止没有解决方案。难道问题与这是一个隐式意图有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:11:46.917

尝试使用`data.getStringExtra(Intent.EXTRA_TEXT)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T17:52:14.240

代替

```
int posizione2 =Integer.parseInt((getIntent().getExtras().getString(Intent.EXTRA_TEXT))); 
```

试试看：

```
Bundle extras = getIntent().getExtras();
if (extras==null) {
  Log.e( "", "No extras provided" );
  return;
}

String myText = extras.getString(Intent.EXTRA_TEXT);
if (myText==null) {
  Log.e( "", "No text provided" );
  return;
}

int posizione2 = Integer.parseInt(myText); 
```

应该可以帮助您查看导致异常的原因...

顺便说一句，您返回的文本（如果该文本是来自其他活动的结果）将在传递给函数的 Intent 中可用。所以你应该这样做：

```
if (data.getString(Intent.EXTRA_TEXT)==null) {
  Log.e( "", "No text provided" );
  return;
}

int posizione2 = Integer.parseInt(data.getString(Intent.EXTRA_TEXT)); 
```

该`getIntent()`方法将为您提供启动调用活动的意图。没有持有被调用活动结果的意图。

如果您收到`No text provided`消息，则意味着您没有在计算它的活动中正确返回结果。

# java - 没有主清单属性，在 C:\apache\db-derby-10.9.1.0-bin\lib\derbytools.jar

> ID：13864885
> 
> 赞同：1
> 
> 时间：2012-12-13T17:08:12.973
> 
> 标签：java

在我创建的系统变量中

1.  `DERBY_HOME=C:\apache\db-derby-10.9.1.0-bin`
2.  `JAVA_HOME=C:\Program Files\Java\jdk1.7.0_09`
3.  并将路径的值添加为`=%JAVA_HOME%\bin;%JAVA_HOME%\lib;%DERBY_HOME%\bin;%DERBY_HOME%\lib;%Apache Ant%\bin;%SystemRoot%\...`

但是当我尝试从 E:\dbstore 下的 cmd 执行以下命令时。

```
java -jar %DERBY_HOME%/lib/derbytools.jar ij 
```

我收到以下错误

```
no main manifest attrinute, in C:\apache\db-derby-10.9.1.0-bin\lib\derbytools.jar. 
```

# javascript - javascript等待返回函数到onclick

> ID：13864893
> 
> 赞同：1
> 
> 时间：2012-12-13T17:08:45.580
> 
> 标签：javascript, callback, wait, dhtmlx

我们有这段代码（使用 DHTMLX 和 DHTMLXMESSAGE）：

```
myCheckBox.attachEvent('onEditCell', function(stage,rId,cInd,nValue,oValue){
        dhtmlx.confirm({
            type:"confirm",
            text: "Are you sure?",
            callback: function(result){
                if(result) {
                    return true;
                } 
                return false;
            }
        });
}); 
```

OnEditCell 事件应返回“true”或“false”以验证操作。

现在我的代码总是检查我的复选框，然后显示确认弹出窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:22:31.007

你不能让 JavaScript 阻塞异步函数。

让您的事件处理程序始终返回 false。

然后在回调中触发其功能，而不是尝试返回 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:25:28.867

您不能将任何内容返回给 attachEvent 回调。根据您的确认复选框的结果，执行相关代码

```
> callback: function(result){
>                 if(result) {
>                    //don't returnfrom here
                      // execute your code here only.
>                 } 
> 
```

希望这可以帮助。

# linq - Linq 选择不同的

> ID：13864894
> 
> 赞同：1
> 
> 时间：2012-12-13T17:08:53.723
> 
> 标签：linq, select, distinct

我有一个通用的旅程列表，其中包含 VehicleId 的属性，我想从旅程列表中获取不同车辆 ID 的列表

我尝试过使用以下内容：

```
Journeys.Select(j => new { j.FleetVehicleId }).Distinct(); 
```

但我遇到了一个错误

```
Expression cannot contain lambda expressions 
```

有谁知道我在这里做错了什么或如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:10:27.593

怎么样：

```
Journeys.Select(j => j.FleetVehicleId ).Distinct(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T13:53:14.657

我认为您正在尝试将代码调试到快速监视窗口中，因此您会收到该错误。

您不能将 lambda 表达式调试到快速监视窗口中。调用 lambda 表达式后尝试调试代码。例如：

```
var testing = Journeys.Select(j => j.FleetVehicleId).Distinct();
// debug testing value here, after lambda expression runs 
```

代码似乎没问题。

# android - 使用对话框而不是 ICS 上的选项菜单

> ID：13864896
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:04.090
> 
> 标签：android, menu, custom-component, optionmenu

我想在我的应用程序中使用对话框作为选项菜单，问题是我知道没有按钮的智能手机只有在活动实现了操作菜单时才显示菜单按钮。如何在不丢失 ICS 上的菜单按钮的情况下显示对话框而不是菜单？

非常感谢！来自西班牙的问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:20:48.553

[你可以在这里](http://techblog.rokoder.com/android-missing-menu-button/)找到你的答案。简而言之，您只需降低目标 sdk 版本，然后菜单按钮将出现在所有 ICS 设备上。然后您只需使用它来检测点击：

```
@Override
public boolean onKeyDown(int keycode, KeyEvent event ) {
    if(keycode == KeyEvent.KEYCODE_MENU){
        //do you thing here
        return true;
    }
    return super.onKeyDown(keycode,event); 
} 
```

# sharepoint - 将 Excel 2007 中的文本写入 Sharepoint 站点上的 .txt 文件会导致运行时错误“76”找不到路径

> ID：13864897
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:03.827
> 
> 标签：sharepoint, excel, vba

我在 Excel 2007 项目中有这个 VBA 子程序。它在 Sharepoint 站点中的 .txt 文件中记录用户名、报告名称、日期和版本。我的一些用户遇到了`Run-Time error'76' Path not found`问题。

这是我的代码：

```
Sub logReport(ReportName As String)

    Call AppendTxt("//myaviall/teamsites/AviallReportingSolutions/Airplane_Usage_Log/Airplane_ACT.txt", UNameWindows & ";" & ReportName & ";" & Now & ";" & VersionNum)

    Dim oFS, TS, FileObj

    'Get text stream
    'Set oFS = CreateObject("Scripting.FileSystemObject")
    'Set FileObj = oFS.GetFile("//myaviall/teamsites/AviallReportingSolutions/Airplane_Usage_Log/Airplane_ACT.txt")
    'Set TS = FileObj.OpenAsTextStream(8, -2) 'ForWriting, TristateUseDefault)

    ' Write to file

    'TS.WriteLine UNameWindows & ";" & ReportName & ";" & Now & ";" & VersionNum
    'TS.Close

    'Set TS = Nothing
    'Set FileObj = Nothing
    'Set oFS = Nothing

End Sub

Function AppendTxt(sFile As String, sText As String)
On Error GoTo Err_Handler
    Dim FileNumber As Integer

    FileNumber = FreeFile                   ' Get unused file number
    Open sFile For Append As #FileNumber    ' Connect to the file
    Print #FileNumber, sText                ' Append our string
    Close #FileNumber                       ' Close the file

Exit_Err_Handler:
    Exit Function

Err_Handler:
    MsgBox "The following error has occured" & vbCrLf & vbCrLf & _
           "Error Number: " & Err.Number & vbCrLf & _
           "Error Source: AppendTxt" & vbCrLf & _
           "Error Description: " & Err.Description, vbCritical, "An Error has Occured!"
    GoTo Exit_Err_Handler
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:27:47.400

正如斯科特指出的那样，如果只有一个用户遇到问题，我会首先查看它。

我运行一个非常相似的过程，它根据此处的代码从 Outlook 向 csv 文件写入一行 [http://www.devhut.net/2011/06/06/vba-append-text-to-a-text-file /](http://www.devhut.net/2011/06/06/vba-append-text-to-a-text-file/)

这可能不是您的答案，但如果访问正常，那么尝试另一种方法也无妨。

**更新**

我还将它包含在我的代码中以测试文件是否存在

```
exists = Dir$(sFile) <> fileName 
```

其中 fileName = "Airplane_ACT.txt" 但我可能会尝试使用 msgBox 来查看它返回的内容。

还可以尝试将您的字符串更改为 Airplane_ACT_test.txt 并运行代码，这应该会创建一个新的 txt 文件，如果是这种情况，那么问题可能与您的初始 txt 文件有关。

最后一件事：尝试使用不同的路径，例如：到用户的桌面。

# extjs - extjs 3.4 数据未从弹出网格显示到主网格

> ID：13864898
> 
> 赞同：1
> 
> 时间：2012-12-13T17:09:08.070
> 
> 标签：extjs

我有一个网格，我想在其中过滤一些结果。为了过滤结果，打开一个弹出窗口，用户可以选择搜索条件并过滤结果。执行 php 文件并将结果返回到弹出窗口，但它没有显示在主网格中。这是我的代码。此代码显示网格并在用户选择单选按钮进行过滤时显示结果：

```
var checkModel = new xg.CheckboxSelectionModel();

var orderGridPanel = {
    id: 'orderGridPanel',
    xtype: 'editorgrid',
    title: 'Orders',
    height:350,
    clicksToEdit: 2,
    frame: true,
    viewConfig: {
        forceFit:true
    },
    cm: new xg.ColumnModel({
            defaults: {
                width: 120,
                sortable: true
            },
    columns: [
        {header:"nr",dataIndex:'nr',hidden:true}
        ,checkModel
        ,{header:"Order Id",dataIndex:'order'}
        ,{header:"Order Date",dataIndex:'date', renderer:Ext.util.Format.dateRenderer('m/d/Y')}
        ,{id:'created_by',header:"Order By",dataIndex:'created',align:'left'}
        ,{id:'order_type',header:"Order Source",dataIndex:'order',align:'left'}
        ,{header:"Order Type", dataIndex:'category'}
        ,{header:"Sub Category",dataIndex:'sub_cate_nm'}
        ,{header:"Item",dataIndex:'item'}
        ,{header:"Properties",dataIndex:'order'}
        ,{header:"Status",dataIndex:'order'}
        ,{header:"Action",renderer: renderViewResults}

    ]
     }),
    sm: checkModel,
    store: new Ext.data.Store({
        root: 'results',
        method: 'POST',
        autoSave: false,
        batch: true,
        proxy: new Ext.data.HttpProxy({
        api: {
            read:  'results.php?task=LISTING',
            create: 'results.php?task=CREATE',
            update:'results.php?task=UPDATE',
            destroy: 'results.php?task=DELETE'
        }
        }),
        writer: new Ext.data.JsonWriter({
            encode: true,
            writeAllFields: true,
            batch: true
        }),
        reader: new Ext.data.JsonReader({
            totalProperty: 'total',
            successProperty: 'success',
            idProperty: 'nr',
            root: 'results',
            fields: ['nr','order','date', 'created', 'type', 'category', 'sub_category_nm', 'item', 'properties', 'status']
        }),
        baseParams: ahist_order_params
    }),    
    bbar:[
    '-',{
        text: 'Add',
        iconCls: 'icon-add',
        handler: function(){
            editMoreData(0);
        }
    },
    '-', {
        text: 'Search',
        iconCls: 'icon-search',
        handler: function(){
            displaySearchFilter(origid);
        }
    },

    '-',{
        text: 'Sign Orders',
        iconCls: 'icon-warning',
        handler: function(){
            displaySearchFilter();
        }
    },
    '-',{
        text: 'Cancel',
        iconCls: 'icon-delete',
        handler: function(){
            displaySearchFilter();
        }
    },

    '-', {
        text: 'Refresh',
        iconCls: 'icon-table_refresh',
        handler: function(){
            Ext.getCmp('orderGridPanel').stopEditing(false);
            var rs = orderGridPanel.store.getModifiedRecords();
            if (rs.length > 0) {
                var status = window.confirm("Some data modified on grid, do you want to save grid data before loading latest data ?");
                if (status){                  
                  orderGridPanel.store.save();
                }
            }
             orderGridPanel.store.load();
        }
    },
    '-', {
        text: 'Print',
        iconCls: 'icon-print',
        handler: function(){
            statusStr = getHistGridSelection();

        }
    }
    ,'->'
    ,'Display:','-',
    {
        xtype: 'radio',
        name: 'search_filter',
        id:'search_filter_1',
        inputValue: 1,
        boxLabel: 'Open Orders',
        handler: onChangeLoadFilter ,
        checked : true 
    },'-',{
        xtype: 'radio',
        name: 'search_filter',
        id:'search_filter_2',
        inputValue: 2,
        boxLabel: 'All Orders',
        handler: onChangeLoadFilter
    },'-',{
        xtype: 'radio',
        name: 'search_filter',
        id:'search_filter_3',
        inputValue: 3,
        boxLabel: 'Orders 5 days back',
        handler: onChangeLoadFilter
    }
    ,'-',{
        xtype: 'radio',
        name: 'search_filter',
        id:'search_filter_4',
        inputValue: 4,
        boxLabel: 'Cancelled Orders',
        handler: onChangeLoadFilter
    }

]
}; 
```

现在，当我单击搜索按钮时，此代码将执行：

```
function displaySearchFilter(id){    

    var formPanel = new Ext.FormPanel({
        frame: true,
        labelWidth:150,
        bodyStyle: 'padding:5px 5px 0',
        items: [{
            xtype: 'fieldset',
            defaultType: 'textfield',
            items: [
            {
          xtype       : 'container',
          border      : false,
          layout      : 'column',
          anchor      : '100%',
          style       : 'margin-top:8px;margin-bottom:8px;',
          defaultType : 'field',items :[
            {
                xtype: 'label',
                style: 'float: left; margin-left:3px;margin-top:3px;',
                text: 'From'

            },
            {
                fieldLabel: 'From Date',
                xtype: 'datefield',
                id: 'from_date',
                style: "float: left; margin-left:3px;",
                width:70
            },
            {
                xtype: 'label',
                style: 'float: left; margin-left:5px;margin-top:3px;',
                text: 'To'

          },
            {
                fieldLabel: 'To Date',
                xtype: 'datefield',
                id: 'to_date',
                style: 'float: left; margin-left:5px;',
                width:70

            },
            {
                xtype: 'label',
                style: 'float: left; margin-left:5px;margin-top:3px;',
                text: 'Patient'

          },
            {
                fieldLabel: 'Patient ID',
                id:'patient',    
                xtype: 'textfield',
                style: 'float: left; margin-left:5px;',
                value: btpacs.data.Origid,
                mode:'local'

            },

            {
                xtype:'label',
                style:'float:left;margin-left:5px;margin-top:3px;',
                text:'Display'
            },

            {
                xtype:'combo',
                id:'search_filter',
                store:btpacs.data.searchFilter,
                typeAhead: true,
                mode: 'local',
                triggerAction: 'all',
                selectOnFocus: true,
                lastQuery: '',        
                emptyText:'Select an option...',
                width : 120
            }
            ]},
            {
                xtype: 'combo',
                fieldLabel: 'Order Type',
                name: 'category',
                id:'cat',
                store: btpacs.data.CpoeCategory,
                hiddenName: 'category',
                triggerAction: 'all',
                emptyText:'Select an option...',
                width : 300,
                mode: 'local',
                lastQuery: '',
                listeners : {
                select : function (f, e){
                    //params: { cat_id: Ext.getCmp('cat').getValue()}
                    //subCategoryStore.load();
                    var category_id = Ext.getCmp('cat').getValue();
                    subCategoryStore.reload({
                                params: { cat_id: category_id}
                            });
                }
            }
            },
            {
                xtype: 'multiselect',
                fieldLabel: 'Sub Category',
                name: 'sub_category',
                id:'sub_cat',
                displayField: 'sub_cat_name',
                valueField: 'sub_cat_id',
                store: subCategoryStore,
                hiddenName: 'sub_category',
                emptyText:'Select Order Type First...',
                triggerAction: 'all',
                width : 300,
                mode: 'local',
                listeners : {
                click : function (f, e){

                    var sub_cat_id = Ext.getCmp('sub_cat').getValue();
                    itemStore.reload({
                                params: { sub_cat_ids: sub_cat_id}
                            });
                }
            }
            },
            {
                xtype: 'multiselect',
                fieldLabel: 'Items',
                name: 'items',
                displayField: 'item_name',
                valueField: 'item_id',
                store:itemStore,
                hiddenName: 'items',
                triggerAction: 'all',
                width : 300,
                mode: 'local'
            },
            {                
                xtype : "multiselect",
                fieldLabel : "Doctor List",
                id: 'placed_doctor_name',
                displayField: 'name',
                valueField: 'name',
                typeAhead: true,
                mode: 'local',
                triggerAction: 'all',
                selectOnFocus: true,
                lastQuery: '',                    
                store:doctorStore,
                width : 300
            }]
        }],
        buttons: [{
            text: 'Search',handler: function() {
            formPanel.getForm().submit({
                method: 'POST',
                url: 'ajax/results.php?task=SEARCH', // when this file is executed the result is return properly as I want
                root: 'results',
                params : {'origid': origid},
                    success: function(f, a) {
                  // after the result is successfully returned I cannot display it here.I am not sure what I am missing.Here I want to assign all the result to orderGridPanel 
                    win.close(); 
                    },
                    failure: function(f, a) { 
                        alert("Request failed");
                        f.markInvalid(a.result.errors);

                    }  
                });
            }
        },
        {
            text: 'Cancel',
            handler: function () {
                win.close();
            }
        }]
    });

    win = new Ext.Window({
        layout: 'fit',
        width: 650,
        height: 520,
        defaults: {
            autoScroll: true
        },
        closeAction: 'close',
        title: 'Search Orders',
        plain: true,
        items: [formPanel]
    });

    win.show();

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:52:03.780

如果您希望网格显示数据，则需要将数据加载到网格的存储中。

# java - Log4j - DailyRollingFileAppender - 滚动文件是否在一段时间后被删除？

> ID：13864899
> 
> 赞同：5
> 
> 时间：2012-12-13T17:09:09.057
> 
> 标签：java, logging, log4j

[这个答案](https://stackoverflow.com/a/3683668/251589)意味着日志会保留 7 天。这是可配置的吗？

这个[Java Ranch Post](http://www.coderanch.com/t/61905/open-source/log-DailyRollingFileAppender-Deleting-day-files)意味着文件永远不会被删除。

该站点还同意永远不会删除日志文件：

> 如果您尝试将 Apache Log4J DailyRollingFileAppender 用于每日日志文件，您可能需要指定应保留的最大文件数。就像滚动 RollingFileAppender 支持 maxBackupIndex 一样。但是，如果您使用 DailyRollingFileAppender，当前版本的 Log4j (Apache log4j 1.2.16) 不提供删除旧日志文件的任何机制。我尝试在 DailyRollingFileAppender 的原始版本中进行小修改以添加 maxBackupIndex 属性。因此，可以清理未来使用可能不需要的旧日志文件。

[来源](http://www.codeproject.com/Articles/81462/DailyRollingFileAppender-with-maxBackupIndex)

我找不到权威的答案，我不想等 7 天，看看我的日志是否被删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:19:38.770

请参阅这篇关于 Log4J 删除[的帖子。](https://stackoverflow.com/questions/1050256/how-can-i-get-log4j-to-delete-old-rotating-log-files)简而言之，dailyRollingFileAppender 似乎不能。但也许您可能想看看切换到[Logback](http://logback.qos.ch/index.html)。它是由同一个人编写的，可以满足您的需求。

我使用以下附加程序来维护 30 天的 HTML 日志：

```
<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>Logs\logFile.html</file>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <!-- daily rollover -->
      <fileNamePattern>logFile.%d{yyyy-MM-dd}.html</fileNamePattern>

      <!-- keep 30 days' worth of history -->
      <maxHistory>30</maxHistory>
    </rollingPolicy>

    <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
    <charset>UTF-8</charset>
        <layout class="ch.qos.logback.classic.html.HTMLLayout">
            <pattern>%d{HH:mm:ss.SSS}%thread%level%logger%line%msg</pattern>
        </layout>           
    </encoder>
</appender> 
```

手册中的[相关部分](http://logback.qos.ch/manual/appenders.html)说明了以下内容`maxHistory`：

> 可选的 maxHistory 属性控制要保留的存档文件的最大数量，删除旧文件。例如，如果您指定每月翻转，并将 maxHistory 设置为 6，则将保留 6 个月的存档文件，而 6 个月之前的文件将被删除。请注意，由于旧的归档日志文件已被删除，因此为归档日志文件而创建的任何文件夹都将被适当地删除。

[Logback](http://logback.qos.ch/translator/)也有一个 Log4J 属性翻译器可用于帮助转换。以及[他们手册中](http://logback.qos.ch/manual/migrationFromLog4j.html)专门用于从 Log4J 切换的一章。

# javascript - image.onload 之后变量值不可用？

> ID：13864900
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:10.930
> 
> 标签：javascript, canvas, html5-canvas

`image.onload`我正在使用 Canvas 在使用&`context.drawImage`组合加载/绘制的图像上执行几件事。我正在使用一个返回值的简单函数来计算缩放图像的边界大小。我需要这些值以供稍后在我的代码中使用，但无论我做什么，我都无法将这些值分配给变量。在为 Canvas 分配计算尺寸后，我也无法访问 Canvas 的 styleheight/stylewidth 属性。

这是我的代码的伪充足

```
$(document).ready(function(){
    //Canvas access, context reference etc here.
    //Since I'm assigning styles to the canvas on the fly, the canvas has no ht/wdt yet

    var dimes = '';
    var image = new Image();
    image.onload = function(){
        //Apply original image height/width as canvas height/width 'attributes'
        //(so that I can save the original sized image)
        //Check if the image is larger than the parent container
        //Calculate bounds if not
        //Apply calculated dimensions as 'style' height/width to the canvas, so that the image fits
        dimes = scaleImage(...);

        //Works!
        console.log(dimes);

        //Rest all code
    }

    image.src = '...';

    //Blank!!!
    console.log(dimes);

    //These all blank as well!!!
    jQuery('#mycanvas').height() / width() / css('height') / css('width');
    document.getElementById(canvas).style.height / .style.width / height / width;
}); 
```

我需要访问“重置”类型的函数的计算尺寸，该函数将我的画布与绘制的图像重置为计算的大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:31:34.377

您的`img.onload`函数只能在 JavaScript 执行线程停止忙碌后运行，即在您的`ready`函数完成后。因此，您的`console.log(dimes)`调用在您的`onload`函数之前运行。

将需要使用的任何代码放入函数`dimes`内部。`onload`否则，需要使用的代码`dimes`可能会在`onload`处理程序触发之前运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T17:42:45.360

正如@apsillers 所指出的，`console.log(dimes)`在您简单地定义`image.onload()`事件处理程序之后执行代码。

如果您想在`dimes`外部访问`image.onload()`，您需要确保在图像加载*后*执行它...例如作为对按钮单击的响应。

把它放在`var dimes = "";`前面`$(document).ready()`使它成为一个全局变量。

然后，如果您需要`dimes`在事件处理程序中访问，它已经为您准备好了：

```
$(document).ready(function() {
    var image = new Image();
    var dimes = "";

    image.onload = function() {
       dimes = scaleImage(...);
    };

    $(button).click(function() {
        if (dimes === "") {
           // image is not yet loaded
        } else {
            console.log(dimes);
        }
    });
}); 
```

当然，`dimes`现在只能在第一个`$(document).ready()`事件处理程序中访问。如果添加另一个（当然可以在 jQuery 中完成），则需要使用`$.fn.data()`jQuery 对象方法来存储`dimes`：

```
$(document).ready(function() {
    var image;
    $(document).data("dimes", "");   // initializes it

    image.onload = function() {
        $(document).data("dimes", scaleImage(...));
    };
});
// some other code

$(document).ready(function() {
    $("#myButton").click(function() {
        var dimes = $(document).data("dimes");
        if (dimes === "") {
            // image not yet loaded
        } else {
            console.log(dimes);
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:33:15.427

[http://jsfiddle.net/KxTny/1/](http://jsfiddle.net/KxTny/1/)

```
$(document).ready(function(){

    var dimes = 0;
    var width = 20;
    var height = 30;

    pass(dimes, width, height);

});​

function pass(dimes, width, height) { 
         alert(dimes);
         alert(height);
         alert(width);
    } 
```

# jquery-validate - 如何在 jquery 表单验证中检查一个列表菜单的值是否大于零？

> ID：13864901
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:11.947
> 
> 标签：jquery-validate

我有更多选择菜单，命名为 menu1、menu2、menu3 等...

它们的值都在 0 到 10 之间。默认情况下，它们都为 0。

如何使用 jquery 验证插件检查至少一个菜单的值大于零？因为每个都有不同的名称（我可以给出相同的类，但我看不出这对验证插件有什么帮助，因为我可以针对表单名称而不是类来验证规则）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:34:09.467

一种解决方案是创建自定义规则。

我已经调整[了这个答案](https://stackoverflow.com/a/10454368/678338)并添加了一个名为**mulitselect**的自定义规则。如果没有一个值 > 0，这会在第一个下拉列表中添加一个错误 [。检查 jsfiddle 上的演示。](http://jsfiddle.net/yWN4e/)

**note1**这目前适用于表单中的每个选择列表，更改选择器以将其限制为按类或其他方式的某些选择列表。

**note2**我在提交无效表单后添加了 onclick 功能，因为在选项中添加它会导致验证有点过于“急切”。

js如下

```
$(function () {
    $.validator.addMethod("multiselect", function (value, element) {
        var countValid = $('select').filter(function () {
            return $(this).val() > 0;
        }).length;
        if (countValid === 0 && $('select:first')[0] === element) {
            return false;
        }
        else {
            return true;
        }
    }, "please select at least one of the menus");

    $('select').addClass("multiselect");
    $('form').bind("invalid-form", function () {
        $('form').validate().settings.onclick = function () { $("form").valid() };
    }).validate({
        debug: true
    });

}); 
```

# php - Zend 获取数据库记录为假

> ID：13864903
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:26.407
> 
> 标签：php, sql, database, zend-framework

我有一个链接[http://mywebsite.com/referral/dafa60b2b96c366e165be58649755742](http://mywebsite.com/referral/dafa60b2b96c366e165be58649755742)

带参数dafa60b2b96c366e165be58649755742

试图获取该参数以连接到数据库以获取该用户信息，但最终没有得到任何对象：注意：尝试获取非对象的属性......

这是我的代码：

应用程序.ini：

> resources.router.routes.referralSelectProduct.route = "/referral/:url" resources.router.routes.referralSelectProduct.defaults.controller = 索引资源.router.routes.referralSelectProduct.defaults.action = 推荐-选择-产品资源.路由器.routes.referralSelectProduct.reqs.url = "[0-9a-zA-Z]+"

控制器：

```
public function referralSelectProductAction()
{
    $referral_url = $this->getRequest()->getParam('url');
    $user = $this->_helper->model('Users')->fetchRowByFields(array('url' => $referral_url));

    setcookie('referral_url', $referral_url, time() + 3600*24*30, '/');
} 
```

模型：

```
 class Application_Model_DbTable_Users extends Sayka_Db_Table_Abstract{
protected $_rowClass = 'Application_Model_DbTable_Row_User';protected $_name = 'users';} 
```

看法：

```
<div id="content_bottom" class="content"><br/>
<h1>Select the product to refer your friend <span class="colorset_orange"><?php echo $this->user()->first_name; ?></span>.</h1>
<div><a class="refer_submit" href="?email=<?php echo $this->user()->email ?>&first_name=<?php echo $this->user()->first_name; ?>&last_name=<?php echo $this->user()->last_name; ?>" id="btn_free_download">Free Download</a></div>
<div><a class="refer_submit" href="#" id="btn_buy_now">Buy Now</a></div> 
```

我的观点最终在数据库中没有得到该用户的对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:18:01.583

如果我没记错的话（对于zend framework 1.*）：

```
// Controller
...
$this->view->user = $this->_helper->model('Users')->fetchRowByFields(array('url' => $referral_url));

// View
echo $this->user->email; 
```

确保这会`$this->_helper->model('Users')->fetchRowByFields(array('url' => $referral_url))`返回您期望的结果。`var_dump`它在控制器中

# solr - 如何在 Solr 中设置价格范围方面？

> ID：13864906
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:36.680
> 
> 标签：solr, facet

我有一个用户提到价格的情况，想象一个转售网站。如何设置考虑价格字段的实际值并相应设置范围的方面？

价格有：350、500、700、1300、1850等。

范围是：0-400、400-800、800-1200、1200-1600、1600-2000。

注意：价格范围不能固定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:50:07.347

查看[Solr wiki 中](http://wiki.apache.org/solr/SimpleFacetParameters#rangefaceting)的“Facet by Range”参数。

在您的情况下，它们可能是：

```
facet.range=price
facet.range.start=0
facet.range.end=2000
facet.range.gap=400 
```

那`facet.range.end`可能是不必要的。

如果您有一些价格高于 2000，也许是 10000，您可以有一个“其他”参数来计算`facet.range`.

```
facet.range.other=after 
```

这将返回 2000 以上的所有内容的计数。

# jquery - 使用 jQuery 在元素内部而不是之后插入值

> ID：13864907
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:38.763
> 
> 标签：jquery, jquery-selectors

我正在使用 jQuery 来计算链接文档的文件大小，使用下面的代码片段。代码在 a 元素之后插入了 span 元素中包装的信息。我想将它插入到 a 元素的值中。这可能吗？

谢谢！

js（来源：http: [//jshidell.com/2010/09/20/show-document-file-size-using-jquery/](http://jshidell.com/2010/09/20/show-document-file-size-using-jquery/)）

```
<script>
  function hdrDetails(i, elm, cl) {
    cl = cl/1024;  //divide content-length by 1024 (KB)
    var sz = cl>1024?"MB":"KB";  //if cl is still big, set to MB
    cl = cl>1024?cl/1024:cl;  //if cl is still big, divide again
    var len = $(elm).eq(i).text().length;  //check the link's text length
    if(len > 0) {
      //add a file size
      $(elm).eq(i).after("<span> ("+cl.toFixed(2)+" "+sz+")</span>");
    }
  }
  $(function() {
    var elm="a[href$='.pdf'],"+ //only the file types we want
    "a[href$='.doc'],"+
    "a[href$='.ppt'],"+
    "a[href$='.xls'],"+
    "a[href$='.docx'],"+ //don't forget 2007 versions
    "a[href$='.pptx'],"+
    "a[href$='.mht'],"+
    "a[href$='.xlsx']";
    $(elm).each(function(i, e) {
      if (e.hostname && e.hostname == location.hostname) {
        $.ajax({
          type: "HEAD",
          url: $(this).attr("href"),
          complete: function(xhr, textStatus) {
          var cl=xhr.getResponseHeader("content-length");
          if(textStatus=="success") {
            var cl=xhr.getResponseHeader("content-length");
            hdrDetails(i, elm, cl); //call the calculation fn
          }else{
            $(elm).eq(i).after("<span> (file not found)</span>");
          }
        }
      });
    }
  });
});
</script> 
```

起始 HTML：

```
<a href="ms0778.01.01.pdf" target="_blank" title="Anti-Defamation League of B’nai B’rith. 1966,1975.">[Digital Archival Object]</a> 
```

在现有的js之后：

```
<a href="ms0778.01.01.pdf" target="_blank" title="Anti-Defamation League of B’nai B’rith. 1966,1975.">[Digital Archival Object]</a><span> (1.49 MB)</span> 
```

期望的影响：

```
<a href="ms0778.01.01.pdf" target="_blank" title="Anti-Defamation League of B’nai B’rith. 1966,1975.">[Digital Archival Object <span>(1.49 MB)</span>]</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:14:02.977

您可以使用它在链接的最后一个字符之前插入文本：

```
var $e = $(elm).eq(i);
var t = $e.text();
$e.html(t.slice(0, -1)+"<span> ("+cl.toFixed(2)+" "+sz+")</span>"+t.slice(-1)); 
```

# visual-studio-2010 - 如何在 Silverlight 5 应用程序中呈现 HTML？

> ID：13864908
> 
> 赞同：0
> 
> 时间：2012-12-13T17:09:39.913
> 
> 标签：visual-studio-2010, webbrowser-control, silverlight-5.0, html-rendering

我目前正在开发一个将 HTML 格式的电子邮件呈现给 Silverlight 5 应用程序的项目。该应用程序旨在通过网络浏览器查看，而不是“浏览器外”应用程序。最初使用 WebBrowser 控件，但我遇到了问题。一条消息指出 IE 需要提升权限等。在阅读了如何通过签署 .xap 文件并安装证书来正确实现 WebBrowser 控件之后，当我在本地运行它时它似乎可以工作，但是当我发布到服务器（Windows Server 2008）时，它似乎不起作用。

我试图实现一个我发现的替代方案-> [http://blogs.msdn.com/b/delay/archive/2007/09/10/bringing-a-bit-of-html-to-silverlight-htmltextblock-makes- rich-text-display-easy.aspx](http://blogs.msdn.com/b/delay/archive/2007/09/10/bringing-a-bit-of-html-to-silverlight-htmltextblock-makes-rich-text-display-easy.aspx)，但这似乎不起作用，因为我试图呈现的 HTML 在该示例中不支持许多标签。

我还查看了 Frame 控件[http://msdn.microsoft.com/en-us/library/system.windows.controls.frame(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.frame(v=vs.95).aspx)但不确定这是否能解决我的问题任何一个。

因此，如果有人可以指导我正确的方向，或者我如何让 WebBrowser 控件在推送到服务器时工作，或者可能是另一种选择，那将不胜感激。

# ruby-on-rails - 仅购物车数量可在 ruby on rails 中编辑

> ID：13864916
> 
> 赞同：0
> 
> 时间：2012-12-13T17:10:01.353
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个购物车，在我的展示购物车页面中，我试图让用户灵活地更新数量，我希望只有一个数量字段是可编辑的。这是我的代码

```
class Cart < ActiveRecord::Base
  # attr_accessible :title, :body
  has_many :line_items, dependent: :destroy

class LineItem < ActiveRecord::Base
  belongs_to :product 
  belongs_to :cart
  #before_save :quantity
  attr_accessible :cart_id, :product_id, :quantity

class Product < ActiveRecord::Base
  has_many :photos, :dependent => :destroy
  has_many :line_items
  accepts_nested_attributes_for :photos, :line_items 
```

**在我看来**

```
<p id="notice"><%= notice %></p>

<table>
<tr>
    <th> ID </th>
    <th>Name </th>
    <th>Unit Price </th>
    <th> Quantity </th>
    <th>  Price </th>
    <th></th>
</tr>

  <%= render :partial => 'line_item' %>

 </table>
<span> Total </span><%= number_to_currency(Cart.get_total(session[:cart_id])) %> 
```

**局部视图**

```
 <%  @lineitem.each do |item| %>
   <tr>
<td><%= item.id %>
    <td><%= item.product.name %></td>
   <td><%= number_to_currency(item.product.price) %></td>
     <td><%= item.quantity %></td>(Make this editable with update button)
    <td><%= number_to_currency(LineItem.get_price(item.id,item.product.price)) 
      %></td>
      <td><%= link_to 'Remove', item , confirm: 'Are you sure?', method: :delete  %></td>
        </tr>

         <% end %>
      <%= link_to 'Edit', edit_line_item_path %>

      **Thanks for the reply,**                                              

      <%  @line_item.each do |item| %>
     <tr>
<td><%= item.id %>
    <td><%= item.product.name %></td>
    <td><%= number_to_currency(item.product.price) %></td>
    <td><%= form_for(@line_item) do |f| %>

    <div class="field">
    <%= f.label :quantity %><br />
    <%= f.number_field  :quantity %>
    </div>
    <% end %>
 </td>
   <td><%=      number_to_currency(LineItem.get_price(item.id,item.product.price)) 
   %></td>
    <td><%= link_to 'Remove', item , confirm: 'Are you sure?', method: :delete  %></td>
    </tr>

       <% end %> 
```

我如何使 item.quantity 可编辑，因为所有其他都是只读的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:57:11.660

这条线

```
attr_accessible :cart_id, :product_id, :quantity 
```

保护您的所有属性免于大规模分配，除了`cart_id`,`product_id`和`quantity`. 这意味着除非您单独设置其他属性，否则它们将不可编辑。如果要允许其他属性可编辑，则必须将它们添加到该行。

@nathanvda 和 @simonmorley 是对的。您需要确保您提出问题并花时间让可能帮助您的其他人理解它。

# c# - ViewState对象列表c#

> ID：13864917
> 
> 赞同：1
> 
> 时间：2012-12-13T17:10:03.757
> 
> 标签：c#, asp.net

你好，我在加载页面时收到此错误消息，

在程序集“App_Code.e9hyffkh, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null”中键入“messageBox”未标记为可序列化。

我是 asp.net 的新手，我可以找到我要穿的东西！

这是我的代码：

```
public partial class home : System.Web.UI.Page
{
public string val = "";
public string data = "";

protected void Page_Load(object sender, EventArgs e)
{
    val = "";
    if (!IsPostBack)
    {
        ViewState["Messages"] = new List<messageBox>();
    }

}
protected void ListBox1_SelectedIndexChanged(object sender, EventArgs e)
{

}
protected void Button1_Click(object sender, EventArgs e)
{

    var messages = (List<messageBox>)ViewState["Messages"];

    if (text1.Text == "")
    {
        val = "נא הכנס שם";
    }
    else
    {
        messages.Add(text1.Text);
        val = "נוסף בהצלחה";
    }

    ListBox1.DataSource = messages;
    ListBox1.DataBind();
    ViewState["Messages"] = messages;
    data = messages.Count.ToString();

    text1.Text = "";

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:15:58.497

在您的班级`[Serializable]`顶部添加属性。`messageBox`

供参考：[SerializableAttribute 类](http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T17:19:56.977

将 [Serializable] 属性添加到您的课程中，不确定您的课程是什么样的，但请参见下面的示例

```
[Serializable]
public class messageBox
{
   //other code / Fields related to the class goes below
} 
```

# computer-vision - 虹膜检测或红眼检测

> ID：13864923
> 
> 赞同：0
> 
> 时间：2012-12-13T17:10:23.803
> 
> 标签：computer-vision

我正在尝试找到一种检测眼睛的 CV 算法，但我的问题要求眼睛检测非常准确，我最好将其称为虹膜检测。（不是认可！）。我想知道是否有一种有效的方法和快速的方法（实时响应）。在 Iris 移动时定位它。

任何帮助，在线示例教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T14:44:31.560

我推荐 ICB 2012 中的以下文章“一种用于低约束虹膜边界定位的新方法”。其中一个步骤是瞳孔以及边缘和瞳孔边界检测。

亲切的问候，

# java - Java - 从匿名类内部访问循环计数器

> ID：13864930
> 
> 赞同：4
> 
> 时间：2012-12-13T17:10:41.570
> 
> 标签：java

我有一个将 menuItems 添加到菜单的 for 循环。添加每个菜单项后，我想为其添加一个动作侦听器，因此当在菜单中单击时，它将从数组中加载相应的索引项。问题是java不允许我从匿名动作监听器类调用arraylist.get(i)，因为它说我必须是最终的。我不能使 i 最终，因为它在每次迭代中递增。有人可以帮忙吗？干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T17:11:37.687

为什么不提取元素作为`final`匿名类之外的引用？

```
for (int i = 0: i < list.size(); i++) {
   final elem = list.get(i);
   // now use it...
} 
```

请注意，出于另一个原因，这更安全。在您的原始解决方案中，您将返回列表并且这可能会发生变化，这样您的匿名类可以在每个回调中提取不同的对象。在这个变体中，它给出了`final`对实际实例的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:14:25.193

您可以将 ActionListener 实现为公共类，并在其构造函数中传递所需的菜单项。

# java - 通过 TCP 套接字将对象从 java 服务器发送到 android 客户端

> ID：13864931
> 
> 赞同：2
> 
> 时间：2012-12-13T17:10:45.960
> 
> 标签：java, android, sockets, serialization, tcp

我打算使用 objectOutputStream 但听说这是不可靠的，因为不同的 java 版本可能会以不同的方式反序列化对象。关于“可怕的跨架构实践......”

那么我还能如何在这些设备之间发送对象和数组，接收端可以将正确的对象或数组数据拼凑在一起呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:09:14.910

编辑：只需阅读您在做什么。您可能不需要 Web 服务器。很多人推荐一个，因为 Web 服务器有大量的支持。您当然使用 TCP 或 UDP 在服务器和客户端之间进行通信。如果你想要数据交换，你需要有一些协议，这里的大多数人都会熟悉 XML 或 JSON

如果您需要灵感，请尝试查看一些协议，例如 FTP，甚至是 Bittorrent

网络服务器案例：

我为大学家庭作业编写了一个 Java Web 服务器。如果您对 TCP/IP 有很好的了解，那么 Web 服务器实际上非常简单。代码散布在网上，虽然有点难以理解到底发生了什么，但一旦你这样做了，这还不错

您绝对应该查看 HTTP 的 RFC，即使这些内容往往是用法律术语表述的。除此之外，在服务器上，您基本上是逐行读取字符串，并且您应该能够弄清楚在服务器上要做什么（例如 GET /somefile.html HTTP/1.0）。只需在这些行上执行 System.out.println 并从那里开始。客户端代码也是如此。您还可以使用 telnet 查看 Web 服务器的功能

为了测试，我实际上建议只尝试普通的网络浏览器，如 Firefox、Chrome、IE、Safari，甚至 curl 脚本。这是一个简单的测试，可以查看您的服务器是否正常运行

就数据交换而言，建议使用 XML 或 JSON，主要是如果您学会如何处理它，您的简历将获得 100 个经验点。但是，要开始使用，您可以从发送和接收诸如“Wazzzaaap”之类的文本开始。Web 浏览器还可以获取 XML 和 JSON 数据。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T17:23:48.100

通过'java server'，你使用什么样的协议？

一种选择是 RPC，它在 java.rmi 中定义

如果你使用http，最简单的选择是在tomcat/jetty中实现一个小servlet并使用restful服务

数据格式可以是xml、json、bin等

# asp.net - 来自 ASP:DropDownList 的数据不会更新到数据库

> ID：13864933
> 
> 赞同：0
> 
> 时间：2012-12-13T17:10:48.153
> 
> 标签：asp.net, vb.net, html-select

我们正在尝试使用来自 ASP:DropDownList 的值从 ASP.Net DetailsView 将数据更新到数据库，但是当用户单击“更新”按钮时没有任何反应。只有取消按钮可以工作。

DropDownList 将显示加载到其中的数据库中的数据，但我们无法进行更新。

我假设我在标记编码中遗漏了一些东西。

这是 DropDownList 的标记：

```
<asp:TemplateField HeaderText="Class:" SortExpression="ClassID">

    <EditItemTemplate>
        <asp:DropDownList 
            ID="DropDownListClass" 
            Runat="server"
            DataSourceID="SqlDataSourceClasses"
            DataTextField = "ClassName"
            DataValueField="ID"
            AutoPostBack="True" 
            AppendDataBoundItems="true">
        </asp:DropDownList>

        <asp:RequiredFieldValidator ID="RequiredFieldValidatorEditDropDownListClass" runat="server" 
            ControlToValidate="DropDownListClass" 
            ErrorMessage="Please select a class." Font-Bold="True" Font-Italic="True" ForeColor="Red" 
            SetFocusOnError="True" Display="Dynamic">
        </asp:RequiredFieldValidator>
    </EditItemTemplate>

    <ItemTemplate>
        <asp:Literal ID="LiteralClass" runat="server" 
            Text='<%# FormatAsMixedCase(Eval("ClassName").ToString())%>' />
    </ItemTemplate>

    <ItemStyle ForeColor="Blue" />
</asp:TemplateField> 
```

这是 DataSource 的标记，它是一个简单的查找表：

```
<asp:SqlDataSource 
    ID="SqlDataSourceClasses" 
    runat="server" 

    ConnectionString="<%$ ConnectionStrings:Islamic Knowledge Academy Staff System %>" 

    SelectCommand="SELECT [ID], [ClassName], [Grade] FROM [Classes]">
</asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:49:04.043

埃马德乌登，

我认为您的提交按钮需要一个单击处理程序，以便当客户端回发到服务器时 - 它知道更新数据库。类似于以下内容：

```
Sub btnUpdate_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnUpdate.Click

    Dim cnAD As New System.Data.SqlClient.SqlConnection = yourdatasource.getConnection("SqlDataSourceClasses", cnAD)
    Dim cmd As New SqlCommand
    cmd.Connection = cnAd
    cmd.CommandType.Text
    cmd.CommandText = "update yourtable set yourval=@val where yourparams"
    cmd.Paramaters.AddWithValue("@val", DropDownListClass.SelectedValue)
    cmd.ExecuteNonQuery()

End Sub 
```

你甚至可以添加一个 try-catch 来更好地了解你的代码哪里出错了。请注意，我所写的内容不会按原样工作，但它旨在为您指明正确的方向。

# .net - 设计带有接口和抽象的类

> ID：13864934
> 
> 赞同：1
> 
> 时间：2012-12-13T17:10:53.757
> 
> 标签：.net, c#-4.0, c#-3.0

嗨，伙计们，我是 c# 的新手，我从微软那里找到了以下答案，建议使用接口和抽象。

如果您预期创建组件的多个版本，请创建一个抽象类。抽象类提供了一种简单易行的方式来对组件进行版本控制。通过更新基类，所有继承类都会随着更改而自动更新。另一方面，接口一旦创建就不能更改。如果需要新版本的接口，则必须创建一个全新的接口。

你是什​​么意思创建组件的多个版本。你能详细说明更多提供的例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T17:24:36.637

拥有共享某种行为和/或属性的类似类是您使用基类的时候。典型的例子之一是形状。你可以这样：

基础抽象类 - FourSidedShape

*   具有将所有四个边相加的 GetPerimeter 方法。
*   有一个 GetArea 方法，即抽象的（必须由派生类定义）

派生类 - 矩形

*   自动免费获取GetPerimeter方法
*   必须实现 GetArea 方法，使用长度 x 宽度

派生类 - 平行四边形

*   自动免费获取GetPerimeter方法
*   必须实现 GetArea 方法，使用 base x height

您的派生类还可以添加他们想要的不属于基类的任何独特行为。

注意：抽象类是不能直接实例化的。您必须使用派生类之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T17:25:36.777

这确实应该是两个问题，但我会同时回答它们。

**第二个第一**：可空类型的用法是：

```
decimal? priceFromDb = datarow.Field<decimal?>("price"); 
```

在这种情况下，您声明的类型将包含十进制值，但可能为 null，因为在这种情况下，它来自数据库，并且基础字段可能为 null。声明可空类型的正确方法是`?`在类型名称的末尾使用 。然后，当您想使用有问题的值时，您可以执行以下操作：

```
if (priceFromDb.HasValue)
{
    Console.WriteLine("The price is {0}.", priceFromDb.Value);
} 
```

**第一个问题**：在 C# 中使用接口来确保类或结构实现您需要的某些关键功能。它们通常只包含少数方法，通常不超过一两个，其想法是，一旦您创建了一个已发布的接口，它就不会改变。另一方面，抽象类使您能够强制类实现您需要的方法，并为它们提供通用功能，如果您将来对抽象类进行更改，例如，添加更多通用特征，继承类自动获取特征。使用抽象类并不是发布重大更改的许可，它只是一种将通用特性组合到类中的更简洁功能的方法。

如果您查看 .Net 框架，您会发现大多数接口（[IEquatable](http://msdn.microsoft.com/en-us/library/ms131187.aspx)、[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable%28v=vs.110%29.aspx)、[IComparable](http://msdn.microsoft.com/en-us/library/System.IComparable.aspx)）通常用于对对象强制执行行为，而不是对其整个结构。

例如，考虑一个抽象类车辆：

```
abstract class Vehicle
{
    public int NumWheels { get; set; }
    public string Name { get; set; }
    public abstract void Drive();
    public override string ToString()
    {
        return "I am a vehicle!";
    }
} 
```

您可以创建一个继承自 Vehicle 的汽车对象，并且需要实现`Drive()`，但将免费获得这两个属性。如果需要，您的继承类 car 也可以重载，或者保持原样：`NumWheels``Name``ToString()`

```
public class Car : Vehicle
{
    public override void Drive()
    {
        // your implementation here
    }

    public override string ToString()
    {
        return "I am a car!";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-18T16:16:42.400

可能“抽象类和接口之间的区别”是 .Net 世界中最常见的问题。我将解释理论上的差异，然后是代码片段。

根据我的理论，抽象类和接口之间基本上有5个区别，如下所示：-

1.  一个类可以实现任意数量的接口，但一个子类最多只能使用一个抽象类。

2.  抽象类可以有非抽象方法（具体方法），而在接口的情况下，所有方法都必须是抽象的。

3.  抽象类可以声明或使用任何变量，而接口不允许这样做。因此以下代码将无法编译：-

接口测试接口

{

```
int x = 4;  // Filed Declaration in Interface 

void getMethod(); 

string getName(); 
```

}

抽象类 TestAbstractClass

{

```
int i = 4; 
int k = 3; 
public abstract void getClassName(); 
```

}

它将生成编译时错误：-

错误 1 ​​接口不能包含字段。

所以我们需要省略字段声明才能正确编译代码。

接口测试接口

{

```
void getMethod();
string getName(); 
```

}

抽象类 TestAbstractClass

{

```
int i = 4; 
int k = 3; 
public abstract void getClassName(); 
```

}

上面的代码可以正确编译，因为接口中没有字段声明。

4.抽象类可以有构造函数声明，而接口不能有。

所以以下代码将无法编译：-

接口测试接口 {

```
// Constructor Declaration 
public TestInterface() 
{ 
void getMethod(); 
string getName(); 
} 
```

}

抽象类 TestAbstractClass

{

```
public TestAbstractClass() 
{ 
int i = 4; 
int k = 3; 
public abstract void getClassName(); 
} 
```

}

上面的代码将生成一个编译时错误：-

错误 1 ​​接口不能包含构造函数

所以我们需要从接口中省略构造函数声明才能编译我们的代码。

以下代码完美编译：-

接口测试接口 {

```
void getMethod(); 
string getName(); 
```

}

抽象类 TestAbstractClass {

```
public TestAbstractClass() 
{ 
int i = 4; 
int k = 3; 
public abstract void getClassName(); 

} 
```

}

5.一个抽象类允许对其所有成员声明具有所有访问修饰符，而在接口中我们不能声明任何访问修饰符（包括公共），因为接口的所有成员都是隐式公共的。

注意：这里我说的是接口成员的访问说明符，而不是接口。

以下代码将更好地解释它：-

将提供访问说明符设置为 Public 是完全合法的（记住只允许 public）

公共接口测试接口

{

```
void getMethod(); 
string getName(); 
```

}

上面的代码编译完美。

不允许为接口的成员提供任何访问说明符。

接口测试接口

{

```
public void getMethod(); 
public string getName(); 
```

}

上面的代码将生成一个编译时错误：-

错误 1 ​​修饰符“public”对此项无效。

但是声明接口的最好方法是避免接口上的访问说明符以及接口的成员。

接口测试

{

```
void getMethod(); 
string getName(); 
```

}

# autohotkey - Autohotkey - 重复热键

> ID：13864936
> 
> 赞同：2
> 
> 时间：2012-12-13T17:10:56.970
> 
> 标签：autohotkey

> **可能重复：**
> [当它在自动热键中用作热键时如何发送一封信](https://stackoverflow.com/questions/10427010/how-to-send-a-letter-as-itself-when-it-is-used-as-hotkey-in-autohotkey)

当我尝试运行脚本时：

```
v::Send tv 
```

它开始重复输入 t。

在玩自动热键时，我可能做错了什么，现在它不再说

> 第 1 行出错。
> 
> 行文本：; v::Send tv 错误：热键无效。
> 
> 程序将退出。

（我后来使用它发表了评论`;`，在此之前问题仍然存在。）

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:57:15.583

热键在发送`v`. 尝试使用`$`：

```
$v::Send tv 
```

我不确定是什么导致它说“无效的热键”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T09:04:54.693

或者，您可以使用：

```
:?*:v::tv ; * = no need to press enter, ? = will execute vene if letters have been typed before. 
```

为了避免无法在其他任何地方使用字母 v 的问题，我通常使用 v\ 这个组合，因为它既简单又独特：

```
:?*:v\::tv 
```

如果你想将 v 键的行为限制在一个应用程序中，我会使用 AutoHotKey 间谍来获取应用程序特定的 ID 或名称，并将热键放在 #ifwinactive 中。您需要将 SetTitleMatchMode, 2 放在脚本的顶部。这为#ifwinactive 等函数设置了字符串数学行为。在此示例中，v\ 仅适用于 Google Chrome。

```
SetTitleMatchMode, 2

#ifWinActive, Chrome ; limits the use of the following hotkey(s) to Chrome only.
    :?*:v\::tv
#ifWinActive 
```

# python - 将视图链接到链接 Django

> ID：13864937
> 
> 赞同：1
> 
> 时间：2012-12-13T17:10:59.973
> 
> 标签：python, database, django

我正在 Django 中制作一个简单的博客应用程序作为学习练习。我可以添加帖子，在首页上看到它们，所以到目前为止它正在工作。我遇到的问题是创建一个在单独的页面上显示整个帖子的视图。我想单击标题，然后转到具有标题和正文的 url /post/primary 键的页面。当我点击链接时，我得到一个只有 base.html 的页面。不知道我在哪里遗漏了任何东西，这里是 urls.py、views.py 和 post.html：

来自 django.conf.urls 的 urls.py 导入模式、包含、url

```
# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('blog.views',
    url(r'^$', 'frontpage'),
    url(r'^post/(\d+)/$', 'post'),
)

urlpatterns += patterns('',
    url(r'^admin/', include(admin.site.urls)),
) 

from django.core.paginator import Paginator, InvalidPage, EmptyPage
from django.core.urlresolvers import reverse
from django.shortcuts import get_object_or_404, render_to_response
from blog.models import * 
```

视图.py

```
def frontpage(request):
    posts = Post.objects.all().order_by("-created")
    paginator = Paginator(posts, 5)

    page = request.GET.get('page', '1')

    try: 
        posts = paginator.page(page)
    except (InvalidPage, EmptyPage):
        posts = paginator.page(paginator.num_pages)

    return render_to_response("list.html", dict(posts=posts, user=request.user))

def post(request, pk):
    """Single Post"""
    post = Post.objects.get(pk = pk)
    d = dict(post=post, user=request.user)
    return render_to_response("post.html", d) 
```

post.html

```
{% extends "base.html" %}

{% block content %}
    <div class ="main">
        <ul>
            {% for post in posts.object_list %}
                <div class = "title">{{ post.title }}</div>
                <ul>
                    <div class="time"> {{ post.created }}</div>
                    <div class ="body"> {{ post.body|linebreaks }}</div>
                </ul>
            {% endfor %}
        </ul>
    </div>
{% endblock %} 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:14:44.220

我假设这`page.html`实际上是`post.html`您在 yoru 代码示例中拥有的？您不再拥有一系列帖子，而是只有 1 个帖子

这需要更改为：（循环浏览您的帖子）

```
{% extends "base.html" %}

{% block content %}
    <div class ="main">
        <ul>
            {% for post in posts.object_list %}
                <div class = "title">{{ post.title }}</div>
                <ul>
                    <div class="time"> {{ post.created }}</div>
                    <div class ="body"> {{ post.body|linebreaks }}</div>
                </ul>
            {% endfor %}
        </ul>
    </div>
{% endblock %} 
```

类似于（仅显示您的单曲`post`）：

```
{% extends "base.html" %}

{% block content %}
    <div class ="main">
        {{ post.title }}
        {{ post.created }}
        {{ post.body }}      
    </div>
{% endblock %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T06:52:30.917

您必须更改 urls.py 才能转到 url /post/primary 键处的页面。

```
urlpatterns = 模式（'blog.views',
    网址（r'^$'，'首页'），
    url(r'^post/(?P<pk>\d+)/$', 'post'),
)

```

# r - R：带有log y轴的spineplot和spineplot的表面

> ID：13864939
> 
> 赞同：1
> 
> 时间：2012-12-13T17:11:04.713
> 
> 标签：r

关于 R 中的 spinplot 函数，我有两个问题。（A spinplot plots P(Y|x) vs. x）。

1.  我需要找出脊柱图下的表面。换句话说，我可以提取 spinplot() 以某种方式创建的条的宽度和高度吗？

2.  反正有没有使y轴对数？

谢谢！弗拉克

# python - Python：使用 Peewee 转储数据库数据

> ID：13864940
> 
> 赞同：6
> 
> 时间：2012-12-13T17:11:09.663
> 
> 标签：python, openpyxl, peewee

**背景**

我正在寻找一种将使用 Python 和 Peewee 进行的 MySQL 查询结果转储到 excel 文件的方法，包括数据库列标题。我希望导出的内容以与数据库中的列几乎相同的顺序排列。此外，我希望有一种方法可以跨多个可能具有略微不同字段的*类似数据库工作。*澄清一下，一个数据库可能有一个包含“User, PasswordHash, DOB, [...]”的用户表，而另一个数据库有“User, PasswordHash, Name, DOB, [...]”。

**问题**

我的主要问题是以有序的方式获取列标题。迄今为止的所有尝试都导致了无序的结果，并且所有这些都没有那么优雅。

其次，到目前为止，我的方法导致我（个人）讨厌维护的代码，我知道这是一个不好的迹象。

**工作至今**

目前，我已经使用 Peewee 的 pwiz.py 脚本为目标数据库中的每个预先存在的数据库表生成模型，然后输入所有主键和外键。关系已建立，一些简短的测试表明它们正确关联。

代码：我设法使用类似于以下内容的方式获取列标题：

```
 for i, column in enumerate(User._meta.get_field_names()):
        ws.cell(row=0,column=i).value = column 
```

如前所述，这是无序的。此外，这样做会迫使我做一些类似的事情

```
 getattr(some_object, title) 
```

相应地动态填充字段。

**想法和可能的解决方案**

*   手动写出我想要的东西在数组中的顺序，并使用它来循环和填充数据。这样做的优点是非常严格/精细的控制。缺点是我需要为每个数据库指定这个。

*   为所有可能遇到的字段创建（无论是手动还是通过方法）具有相关加权值的字段哈希，然后编写一个根据权重对“_meta.get_field_names()”进行排序的方法。这样做的缺点是列可能不是 100% 以正确的顺序排列，例如在一个 DB 中 Name 在 DOB 之前，而在另一个 DB 之后。

随时告诉我我做错了，或者提出完全不同的方法，我全都听好了。我对 Python 和 Peewee（实际上是一般的 ORM）非常陌生。我可以切换回 Perl 并通过 DBI 进行数据库查询，几乎没有任何麻烦。但是，它的 excel 库会给我带来很多问题，我想借此机会扩展我的知识。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T19:26:30.747

您可以使用模型元数据上的一种方法：

```
for field in User._meta.get_sorted_fields():
    print field.name 
```

这将按照在模型*上声明的顺序*打印字段名称。

# asp.net-mvc - 在 razor 中创建动态视图

> ID：13864941
> 
> 赞同：0
> 
> 时间：2012-12-13T17:11:11.570
> 
> 标签：asp.net-mvc, razor

我通过此代码有一个 webgrid

```
@grid.GetHtml(
                        tableStyle: "webgrid",
                        columns: grid.Columns(
                        grid.Column(header: "Link", style: "labelcolumn", format: (item) => Html.ActionLink("Edit Item", "EditQueue", new { id = item.QueueID})),
                        grid.Column("Description", "Description"),
                        grid.Column("QueueDate", "QueueDate"),
                        grid.Column("Note", "Note"),
                        grid.Column("Status", "Status"),
                        grid.Column("LastUpdated", "LastUpdated")
                            )
                    ) 
```

我创建了一个 ID 为 1 的测试用例。然后单击第一列中的链接。我收到 404 错误，因为我没有在*/Home/EditQueue/1上为此创建页面*

但是我显然不想为每个号码创建一个页面。创建一个只显示我传递给它的 ID 的页面的最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:17:08.743

`id`在 HomeController 中创建一个接受 as 参数的操作方法

```
public ActionResult EditQueue(int id)
{
    //Get the details of queue using id and return a view.
    return View();
} 
```

您可能希望显示要编辑的数据。所以使用 id 获取数据并返回。

```
public ActionResult EditQueue(int id)
{
    //Get the details of queue using id and return a view.
    Queue queue=repositary.GetQueueFromID(id);
    return View(queue);
} 
```

假设`repositary.GetQueueFromID`方法将返回一个`Queue`类对象，并且您的 View ( `Edit.cshtml`) 是强类型的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:13:58.173

只需使用您在控制器中传递的参数的方法..

# c# - InstallShield LE - 本地化语言文件夹中的第 3 方 dll

> ID：13864944
> 
> 赞同：1
> 
> 时间：2012-12-13T17:11:17.453
> 
> 标签：c#, winforms, installshield

当我在 VS 2012 中使用 InstallShield LE 创建安装项目时，我将需要安装的项目添加到“文件”选项卡中（在安装项目中指定应用程序数据）。我还需要应用程序的本地化资源，所以我选择本地化资源。
安装后，第 3 方 dll 全部复制到语言文件夹中，而不是应用程序的主文件夹中。因此应用程序无法找到它们并且无法启动事件。
我尝试取消选中本地化资源输出的依赖项（构建时扫描的依赖项），但它们在主输出中也未选中。

如果我在输出中添加第 3 方 dll，它似乎可以工作，但这不好，因为它硬编码了 dll 的路径，迫使我的团队中的每个成员在每次需要构建它时更改设置项目。

关于如何将依赖项安装在正确位置的任何想法？

**编辑：**
经过进一步测试，问题似乎是随机的，在某些情况下它会正确创建路径，但在大多数情况下不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T10:16:54.113

假设设置有以下输出：

MainProject.Debug 符号
MainProject.Localized 资源
MainProject.Primary 输出
AuxProject.Debug 符号
AuxProject.PrimaryOutput AnotherProject.PrimaryOutput
如果

您右键单击“MainProject.Localized 资源”和“MainProject.Primary 输出”，然后选择“Dependencies from scan at build...”，可以看到它们都具有相同的依赖关系。这是我的问题的原因（在本地化文件夹中复制的依赖项）。
为了解决这个问题，我转到 MainProject.Localized 资源，右键单击它，选择属性 -> COM & .NET 设置选项卡 -> 将“扫描时生成”设置为“无” -> 确定。
现在它在 InstallShield builds DVD-5 和 Single Image (tested) 上构建设置并正确安装。

# ruby-on-rails - Rails 2.3 风格的插件：为什么会有弃用警告？

> ID：13864945
> 
> 赞同：0
> 
> 时间：2012-12-13T17:11:19.997
> 
> 标签：ruby-on-rails, heroku

在部署到 Heroku 时，我收到一组关于 vendor/plugins 文件夹的弃用警告（见下文）。我的里面有一个 .gitkeep 声明，没有别的。有什么我需要做的吗？

```
2012-12-13T02:56:59+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-12-13T02:56:59+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-12-13T02:56:59+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:16:27.160

Heroku 已经指出了这一点，他们已经在为 Rails 4 开发它

Heroku 通过注入插件来工作，它会导致这种情况发生

```
-----> Rails plugin injection
       Injecting rails_log_stdout
       Injecting rails3_serve_static_assets 
```

[在 Heroku 中运行任务的 Rails 2.3 样式插件和弃用警告](https://stackoverflow.com/questions/9027403/rails-2-3-style-plugins-and-deprecation-warnings-running-task-in-heroku)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-29T18:48:26.200

I just noticed a workaround that Heroku has now.

```
 Injecting plugin 'rails_log_stdout'
   Injecting plugin 'rails3_serve_static_assets'
   Add 'rails_12factor' gem to your Gemfile to skip plugin injection 
```

# android - div 在调整大小时不适合 android 屏幕

> ID：13864946
> 
> 赞同：3
> 
> 时间：2012-12-13T17:11:23.343
> 
> 标签：android, css, browser

我已经在 Google、SitePoint 论坛和 Stack Overflow 上进行了多次搜索。似乎还找不到答案。

我看到的所有答案似乎都是针对图像的，但我的问题比这更简单：我需要一个 div 来适应调整后的 android 窗口的宽度。

我的网站：（soletron.com）我在标题中有一个黄色背景的 div。这个 div（就像网站的页脚）设置为 100% 宽度，显示：块，我什至在其中放了一个 1000px 宽的透明 gif，所有这些都是为了尝试使 div 填充至少 1000px 宽屏幕在 Android 上调整大小。

在电脑上一切正常。但在 Android 上，该 div 和页脚 div 只会在网站首次加载时填充 android 窗口大小的 100%。如果您旋转屏幕或捏合缩放，最初加载的 div 将不会移动。

我讨厌在调整大小后不得不求助于使用 javascript 来强制宽度，因为我觉得这可以通过适当的 css 解决？不确定，如果您知道什么可以提供帮助，请告知。提前致谢。

# android - 如果 Http 调用需要时间返回，则按钮单击会卡在 Android 小部件上

> ID：13864952
> 
> 赞同：1
> 
> 时间：2012-12-13T17:11:45.563
> 
> 标签：android, android-widget, widget, android-pendingintent

我的小部件在小部件中有两个用于左右导航的按钮。如果我有一组数据，那么我使用左右箭头按钮在数据之间切换。为了更新数据，我每分钟进行一次 Http 调用。如果 http 调用需要时间才能返回，我的按钮点击开始累积，并在暂停 7-8 秒后突然连续触发。我正在将pendingIntents 用于按钮并在小部件的广播接收器中接收它。

如果 HTTP 调用很快，则按钮单击工作正常。

但是，如果 HTTP 调用返回缓慢，并且我在右箭头上单击 10 次，而单击不会发生任何事情，并且在 7-8 秒后会瞬间触发 10 次单击。

请建议我如何阻止我的按钮点击被阻止然后连续被解雇。

HTTP调用缓慢是按钮卡住的真正原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:16:16.077

您不应该从您的 UI 线程进行 HTTP 调用，因此请确保您使用 AsyncTask 来执行任何 i/O 或网络操作。

[异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:40:21.137

这可能是因为您在 UI 线程上执行 HTTP 请求不是一个好主意，因为 HTTP 请求可能像其他网络任务或 I/O 任务一样需要时间，并且 android 会检测到这一点并可能向用户显示 ANR 消息（App没有响应）并询问用户是否要强制关闭应用程序。

您需要在 onclick 事件将触发的 ASyncTask 中运行 HTTP 请求。这样，将为 HTTP 内容创建一个新线程，同时用户界面可以继续工作并接受用户输入而不是锁定。

# c - 在 c Web 服务器上无法接受 ipv6 请求

> ID：13864954
> 
> 赞同：0
> 
> 时间：2012-12-13T17:11:45.627
> 
> 标签：c, webserver, ipv6

我编写的以下 c 函数返回一个接受 IPv4 连接但不接受 IPv6 的文件描述符。有人可以帮我弄清楚出了什么问题吗？我怀疑我没有正确使用 getaddrinfo() 。

打开侦听连接的文件描述符。

```
/*
 * open_listenfd - open and return a listening socket on port
 *     Returns -1 and sets errno on Unix error.
 */
int open_listenfd(int port)
{
    const char* hostname=0;
    // Converts port to string
    char* pName = malloc(numPlaces(port) + 1);
    sprintf(pName, "%d", port);
    const char* portname= pName;

    struct addrinfo hints;
    memset(&hints,0,sizeof(hints));
    hints.ai_family=AF_UNSPEC;
    hints.ai_socktype=SOCK_STREAM;
    hints.ai_protocol= 0;
    hints.ai_flags=AI_PASSIVE|AI_ADDRCONFIG;
    struct addrinfo* res=0;
    int err=getaddrinfo(hostname,portname,&hints,&res);
    free(pName);
    if (err!=0) {
            return -1;
    }

    int listenfd, optval=1;
    struct sockaddr_in serveraddr;

    /* Create a socket descriptor */
    if ((listenfd = socket(res->ai_family,res->ai_socktype, res->ai_protocol)) < 0)
        return -1;

    /* Eliminates "Address already in use" error from bind. */
    if (setsockopt(listenfd, SOL_SOCKET, SO_REUSEADDR,
               (const void *)&optval , sizeof(int)) < 0)
        return -1;

    /* Listenfd will be an endpoint for all requests to port
       on any IP address for this host */
    bzero((char *) &serveraddr, sizeof(serveraddr));
    serveraddr.sin_family = /*AF_INET;*/ AF_UNSPEC;
    serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);
    serveraddr.sin_port = htons((unsigned short)port);
    if (bind(listenfd, res->ai_addr, res->ai_addrlen/*(SA *)&serveraddr, sizeof(serveraddr)*/) < 0)
    return -1;
    freeaddrinfo(res);

    /* Make it a listening socket ready to accept connection requests */
    if (listen(listenfd, 1024) < 0)
        return -1;
    return listenfd;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:26:53.250

如果你想让你的服务器监听 IPV4 和 IPV6 地址，你~~需要~~设置两个套接字来监听。

`getaddrinfo()`可能会返回给定主机和/或服务的多个 Internet 地址的信息。

`ai_family`传递的结构成员`hints`指定调用者感兴趣的地址族。如果`AF_UNSPEC`指定了 IPV4 和 IPV6 地址，则可能会返回。

要了解是否有这样的地址可用，您可能想修改您的代码，如下所示：

```
int open_listenfd(int port, int * pfdSocketIpV4, int * pfdSocketIpV6)
{
  ...

  struct addrinfo hints = {0};
  hints.ai_family = AF_UNSPEC;
  hints.ai_socktype = SOCK_STREAM;
  hints.ai_flags = AI_PASSIVE|AI_ADDRCONFIG;
  hints.ai_next = NULL;

  struct addrinfo * res = NULL;

  int err=getaddrinfo(hostname, portname, &hints, &res);
  free(pName);
  if (err) 
  {
    return -1;
  }

  struct addrinfo * pAddrInfoIpV4 = NULL;
  struct addrinfo * pAddrInfoIpV6 = NULL;

  {
    struct addrinfo * pAddrInfo = res;

    /* Loop over all address infos found until a IPV4 and a IPV6 address is found. */
    while (pAddrInfo)
    {
      if (!pAddrInfoIpV4 && AF_INET == pAddrInfo->ai_family)
      {
        pAddrInfoIpV4 = pAddrInfo; /* Take first IPV4 address available */
      }
      else if (!pAddrInfoIpV6 && AF_INET6 == pAddrInfo->ai_family)
      {
        pAddrInfoIpV6 = pAddrInfo; /* Take first IPV6 address available */
      }
      else
      {
        break; /* Already got an IPV4 and IPV6 address, so skip the rest */
      }

      pAddrInfo= pAddrInfo->ai_next; /* Get next address info, if any */
    }
  }

  if (pAddrInfoIpV4)
  {
    ... /* create, bind and make IPV4 socket listen */
    int fdSocketIpV4 = socket(pAddrInfoIpV4->ai_family,...

    *pfdSocketIpV4 = fdSocketIpV4; 
  }

  if (pAddrInfoIpV6)
  {
    /* create, bind and make IPV6 socket listen */
    int fdSocketIpV6 = socket(pAddrInfoIpV6->ai_family,...

    *pfdSocketIpV6 = fdSocketIpV6; 
  }

  freeaddrinfo(res);

  ... 
```

然后像这样调用它：

```
...
int fdSocketIpV4 = -1;    
int fdSocketIpV6 = -1;

if (0 > open_listenfd(port, &fdSocketIpV4, &fdSocketIpV6))
{
  printf("Error executing 'open_listenfd()'\n");
}
else 
{
  ... /* go for accepting connectings on 'fdSocketIpV4' and 'fdSocketIpV6' */ 
```

* * *

**更新：**

正如*Per Johansson*所评论的那样，另一种方法是设置一个双栈套接字，同时支持 Ipv4 和 Ipv6，正如这个答案所提到的：[如何同时支持 IPv4 和 IPv6 连接](https://stackoverflow.com/q/1618240/694576)

# ios - 如何获得带有大量图像（50-200）的活泼 UICollectionView？

> ID：13864958
> 
> 赞同：13
> 
> 时间：2012-12-13T17:11:59.597
> 
> 标签：ios, cocoa-touch, ios6, uicollectionview, rubymotion

我`UICollectionView`在一个显示大量照片（50-200）的应用程序中使用，但我在让它变得活泼时遇到问题（例如像照片应用程序一样活泼）。

我有一个自定义`UICollectionViewCell`，`UIImageView`因为它是子视图。我正在将文件系统中的图像加载`UIImage.imageWithContentsOfFile:`到单元格内的 UIImageViews 中。

我现在尝试了很多方法，但它们要么有问题，要么存在性能问题。

***注意：****我使用的是 RubyMotion，所以我会以 Ruby 风格编写任何代码片段。*

首先，这是我的自定义 UICollectionViewCell 类供参考...

```
class CustomCell < UICollectionViewCell
  def initWithFrame(rect)
    super

    @image_view = UIImageView.alloc.initWithFrame(self.bounds).tap do |iv|
      iv.contentMode = UIViewContentModeScaleAspectFill
      iv.clipsToBounds = true
      iv.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth
      self.contentView.addSubview(iv)
    end

    self
  end

  def prepareForReuse
    super
    @image_view.image = nil
  end

  def image=(image)
    @image_view.image = image
  end
end 
```

**方法#1**

保持简单..

```
def collectionView(collection_view, cellForItemAtIndexPath: index_path)
  cell = collection_view.dequeueReusableCellWithReuseIdentifier(CELL_IDENTIFIER, forIndexPath: index_path)
  image_path = @image_paths[index_path.row]
  cell.image = UIImage.imageWithContentsOfFile(image_path)
end 
```

使用这个向上/向下滚动是可怕的。它跳动而缓慢。

**方法#2**

通过 NSCache 添加一些缓存...

```
def viewDidLoad
  ...
  @images_cache = NSCache.alloc.init
  ...
end

def collectionView(collection_view, cellForItemAtIndexPath: index_path)
  cell = collection_view.dequeueReusableCellWithReuseIdentifier(CELL_IDENTIFIER, forIndexPath: index_path)
  image_path = @image_paths[index_path.row]

  if cached_image = @images_cache.objectForKey(image_path)
    cell.image = cached_image
  else
    image = UIImage.imageWithContentsOfFile(image_path)
    @images_cache.setObject(image, forKey: image_path)
    cell.image = image
  end
end 
```

再一次，在第一个完整的卷轴上跳动和缓慢，但从那时起它就一帆风顺了。

**方法#3**

异步加载图像......（并保持缓存）

```
def viewDidLoad
  ...
  @images_cache = NSCache.alloc.init
  @image_loading_queue = NSOperationQueue.alloc.init
  @image_loading_queue.maxConcurrentOperationCount = 3
  ...
end

def collectionView(collection_view, cellForItemAtIndexPath: index_path)
  cell = collection_view.dequeueReusableCellWithReuseIdentifier(CELL_IDENTIFIER, forIndexPath: index_path)
  image_path = @image_paths[index_path.row]

  if cached_image = @images_cache.objectForKey(image_path)
    cell.image = cached_image
  else
    @operation = NSBlockOperation.blockOperationWithBlock lambda {
      @image = UIImage.imageWithContentsOfFile(image_path)
      Dispatch::Queue.main.async do
        return unless collectionView.indexPathsForVisibleItems.containsObject(index_path)
        @images_cache.setObject(@image, forKey: image_path)
        cell = collectionView.cellForItemAtIndexPath(index_path)
        cell.image = @image
      end
    }
    @image_loading_queue.addOperation(@operation)
  end
end 
```

这看起来很有希望，但有一个我无法追踪的错误。在初始视图加载时，所有图像都是相同的图像，并且当您滚动整个块时会加载另一个图像，但都具有该图像。我试过调试它，但我无法弄清楚。

我也试过用 NSOperation 代替，`Dispatch::Queue.concurrent.async { ... }`但这似乎是一样的。

如果我能让它正常工作，我认为这可能是正确的方法。

**方法#4**

无奈之下，我决定将所有图像预加载为 UIImages ......

```
def viewDidLoad
  ...
  @preloaded_images = @image_paths.map do |path|
    UIImage.imageWithContentsOfFile(path)
  end
  ...
end

def collectionView(collection_view, cellForItemAtIndexPath: index_path)
  cell = collection_view.dequeueReusableCellWithReuseIdentifier(CELL_IDENTIFIER, forIndexPath: index_path)
  cell.image = @preloaded_images[index_path.row]
end 
```

这在第一个完整的卷轴中被证明有点缓慢和跳跃，但在那之后一切都很好。

**概括**

因此，如果有人能指出我正确的方向，我将不胜感激。照片应用程序如何做得**这么好**？

* * *

其他人请注意：[已接受] 答案解决了我的图像出现在错误单元格中的问题，但即使在将图像大小调整为正确大小后，我的滚动仍然不稳定。在将我的代码剥离到最基本的部分之后，我最终发现 UIImage#imageWithContentsOfFile 是罪魁祸首。尽管我使用这种方法预热了 UIImages 的缓存，但 UIImage 似乎在内部做了某种惰性缓存。在更新了我的缓存预热代码以使用此处详述的解决方案 - [stackoverflow.com/a/10664707/71810](https://stackoverflow.com/questions/10400209/custom-uitableviewcell-with-large-uiimageview-causing-scroll-lag/10664707#10664707) - 我终于获得了超级流畅的 ~60FPS 滚动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T21:52:30.823

我认为方法#3 是最好的方法，我想我可能已经发现了这个错误。

您`@image`在操作块中分配给整个集合视图类的私有变量。你可能应该改变：

```
@image = UIImage.imageWithContentsOfFile(image_path) 
```

至

```
image = UIImage.imageWithContentsOfFile(image_path) 
```

并更改所有引用`@image`以使用局部变量。我敢打赌，问题在于每次创建操作块并分配给实例变量时，都会替换已经存在的内容。由于操作块出列方式的一些随机性，主队列异步回调正在获取相同的图像，因为它正在访问最后一次`@image`分配的时间。

本质上，`@image`它就像操作和异步回调块的全局变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T11:19:07.397

我发现解决此问题的最佳方法是保留我自己的图像缓存，并在后台线程上的 viewWillAppear 上对其进行预热，如下所示：

```
- (void) warmThubnailCache
{
    if (self.isWarmingThumbCache) {
        return;
    }

    if ([NSThread isMainThread])
    {
        // do it on a background thread
        [NSThread detachNewThreadSelector:@selector(warmThubnailCache) toTarget:self withObject:nil];
    }
    else
    {
        self.isWarmingThumbCache = YES;
        NIImageMemoryCache *thumbCache = self.thumbnailImageCache;
        for (GalleryImage *galleryImage in _galleryImages) {
            NSString *cacheKey = galleryImage.thumbImageName;
            UIImage *thumbnail = [thumbCache objectWithName:cacheKey];

            if (thumbnail == nil) {
                // populate cache
                thumbnail = [UIImage imageWithContentsOfFile:galleryImage.thumbImageName];

                [thumbCache storeObject:thumbnail withName:cacheKey];
            }
        }
        self.isWarmingThumbCache = NO;
    }
} 
```

您也可以使用 GCD 代替 NSThread，但我选择了 NSThread，因为一次只能运行其中一个，因此不需要队列。此外，如果您有基本上无限数量的图像，那么您将必须比我更加小心。您必须更聪明地在用户滚动位置周围加载图像，而不是像我在这里所做的那样全部加载。我可以这样做，因为对我来说，图像的数量是固定的。

我还应该补充一点，您的 collectionView:cellForItemAtIndexPath: 应该使用您的缓存，如下所示：

```
- (PSUICollectionViewCell *)collectionView:(PSUICollectionView *)collectionView
                  cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"GalleryCell";

    GalleryCollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:CellIdentifier
                                                                                forIndexPath:indexPath];

    GalleryImage *galleryImage = [_galleryManager.galleryImages objectAtIndex:indexPath.row];

    // use cached images first
    NIImageMemoryCache *thumbCache = self.galleryManager.thumbnailImageCache;
    NSString *cacheKey = galleryImage.thumbImageName;
    UIImage *thumbnail = [thumbCache objectWithName:cacheKey];

    if (thumbnail != nil) {
        cell.imageView.image = thumbnail;
    } else {
        UIImage *image = [UIImage imageWithContentsOfFile:galleryImage.thumbImageName];

        cell.imageView.image = image;

        // store image in cache
        [thumbCache storeObject:image withName:cacheKey];
    }

    return cell;
} 
```

确保在收到内存警告时清除缓存，或使用类似 NSCache 的东西。我正在使用一个名为 Nimbus 的框架，它有一个名为 NIImageMemoryCache 的东西，它可以让我设置要缓存的最大像素数。很方便。

除此之外，要注意的一个问题是不要使用 UIImage 的“imageNamed”方法，它自己缓存，会给你带来内存问题。请改用“imageWithContentsOfFile”。

# android - Android NDK 未找到实现

> ID：13864960
> 
> 赞同：0
> 
> 时间：2012-12-13T17:12:06.007
> 
> 标签：android, c, android-ndk

```
W/dalvikvm(3937): No implementation found for native Lcom/video/v2/camera/ExternalCamera;.converttobmp (Landroid/graphics/Bitmap;)V 
```

加载已`public class ExternalCamera`使用的库

```
static {
            try {
                System.loadLibrary("ExternalFullHd");
            } catch (UnsatisfiedLinkError e) {
                e.getMessage();
            }
    }   
public native void converttobmp(Bitmap bitmap); 
```

在 ExternalFullHd.c & ExternalFullHd.hi 有

```
void Java_com_video_v2_camera_ExternalCamera_stopCamera(JNIEnv* env,jobject thiz);
void Java_com_video_v2_camera_ExternalCamera_converttobmp ( JNIEnv* env,jobject thiz,jobject bitmap); 
```

&

```
void 
Java_com_video_v2_camera_ExternalCamera_converttobmp( JNIEnv* env,jobject thiz,jobject bitmap){
//code

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T08:50:57.630

正如我的评论中所述，不要忘记将 C/C++ 函数声明为`extern "C"`和 JNIEXPORT。

# sql - SQL 表，导入 CSV 文件将撇号变成问号

> ID：13864963
> 
> 赞同：0
> 
> 时间：2012-12-13T17:12:15.977
> 
> 标签：sql, csv, mamp

我有一个包含撇号的 CSV 文件，当我使用 MAMP 将其导入数据库时​​，它会将所有撇号变成问号。有解决办法吗？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:27:37.890

这是将文件保存`non UTF-8`为`ANSI`. 当您使用不支持 UTF-8 的文本编辑器打开文件并再次保存时，就会发生这种情况。

下载 Notepad++ 等文本编辑器，检查所有（插件或主题）文件并将其转换为`UTF-8`UTF-8 或无 BOM

[http://wordpress.org/support/topic/how-fix-black-diamond-question-marks-in-wp-321](http://wordpress.org/support/topic/how-fix-black-diamond-question-marks-in-wp-321)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-18T13:50:17.477

即使将我的 CSV 文件保存为 UTF-8，我也遇到了同样的问题。所以在 Microsoft Word 中，我编辑了文本并用 HTML 代码（' 和 "）替换了实际的撇号和引号，然后将其复制并粘贴到我的 CSV 文件中。这似乎对我有用。我使用这个网站作为 html代码：[http ://www.ascii.cl/htmlcodes.htm](http://www.ascii.cl/htmlcodes.htm)

# c# - 摆脱 C# datagridview 行中的蓝色背景

> ID：13864965
> 
> 赞同：2
> 
> 时间：2012-12-13T17:12:23.897
> 
> 标签：c#, winforms, datagridview

如何在将数据加载到 datagridview 时摆脱蓝色背景，第一行的背景默认颜色为蓝色，当您选择一行时，背景变为蓝色。我希望它完全没有蓝色背景。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T17:34:22.903

我假设您正在使用`DataGridView`Windows 窗体应用程序中的控件。蓝色背景是选定行的默认颜色。您可以在属性窗口中更改此颜色

1.  选择`datagridview`
2.  在属性窗口中，单击省略号 (...)`DefaultCellStyle`
3.  在 下`Appearance`，改变`SelectionBackColor`

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-26T11:48:32.083

蓝色背景是 gridview 中选定行的默认颜色。您可以在属性窗口中更改此颜色

```
Gridview1.DefaultCellStyle.SelectionBackColor = Color.Red; or Color.Transparent
Gridview1.DefaultCellStyle.SelectionForeColor = Color.Black; or Color.Transparent 
```

但是，如果您**在很短的时间内刷新 gridview 说持续时间少于 1 秒**，那么在这种情况下，您必须更改 Gridview 中添加的行的默认颜色，（上面的 senario 将适用于静态 gridview）。

```
Gridview1.Rows[i].DefaultCellStyle.SelectionBackColor = Color.Red;  or Color.Transparent 
Gridview1.Rows[i].DefaultCellStyle.SelectionForeColor = Color.Black;or Color.Transparent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T09:33:22.100

The DataGridView control has a [ClearSelection](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.clearselection.aspx) method. Just call that and your top row is no longer selected.

Actually I think this is what you want to do rather than changing the SelectionBackColor as suggested by the other answer.

# c# - System.Diagnostics.Debug 类是否有 TextWriter 接口，可与 Console.SetOut 一起使用？

> ID：13864969
> 
> 赞同：1
> 
> 时间：2012-12-13T17:12:39.067
> 
> 标签：c#, console-application, stdout, output-window

是否有任何内置功能可以将 Console.WriteLine 调用重定向到 System.Diagnostic.Debug-calls？

我希望有这样的事情：

```
public static void CallNastyConsoleWriteLineUsingFunction() {
    Console.WriteLine(GetImportantInformation());
}

[...]

var writer = DebugTextWriter();
TextWriter stdout = Console.Out;
try
{
    Console.SetOut(writer);
    CallNastyConsoleWriteLineUsingFunction();
}
finally
{
    Console.SetOut(stdout);
} 
```

甚至可能：

```
using(new ConsoleToDebugRedirector())
{
    CallNastyConsoleWriteLineUsingFunction();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:30:30.367

你可以反过来。使用标准的 Debug/Trace 调用并将[ConsoleTraceListener 类](http://msdn.microsoft.com/en-us/library/system.diagnostics.consoletracelistener%28v=vs.80%29.aspx)添加到您的配置中。净效果应该与标准编码/行为相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T17:26:03.353

你可以这样做：

```
public class Program
{
    public static void Main(string[] args)
    {
        using (new ConsoleRedirect<DebugTextWriter>())
        {
            Console.WriteLine("Testing testing...");
        }

        Console.WriteLine("Testing testing 2...");
        Console.ReadLine();
    }
}

public class ConsoleRedirect<T> : IDisposable
    where T : TextWriter, new()
{
    private readonly TextWriter _tmpTextWriter;

    public ConsoleRedirect()
    {
        _tmpTextWriter = Console.Out;
        Console.SetOut(new T());
    }

    public void Dispose()
    {
        Console.SetOut(_tmpTextWriter);
    }
}

public class DebugTextWriter : TextWriter
{
    public override void WriteLine(string value)
    {
        Debug.WriteLine(value);
    }

    public override void WriteLine(object value)
    {
        Debug.WriteLine(value);
    }

    public override void WriteLine(string format, params object[] arg)
    {
        Debug.WriteLine(format, arg);
    }

    public override Encoding Encoding
    {
        get { return Encoding.UTF8; }
    }
} 
```

它将所有`Console.WriteLine`调用重定向到语句`Debug.WriteLine`内的while 。`using`覆盖 的所有 write 方法非常麻烦`TextWriter`，但是您可以在[此答案中使用包装器](https://stackoverflow.com/questions/2779746/is-there-a-textwriter-interface-to-the-system-diagnostics-debug-class)

# xml - gemfire 本地区域创建

> ID：13864975
> 
> 赞同：0
> 
> 时间：2012-12-13T17:13:38.767
> 
> 标签：xml, spring, gemfire, spring-data-gemfire

我的 cache.xml 如下：

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gfe="http://www.springframework.org/schema/gemfire"
xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:cache="http://www.springframework.org/schema/cache"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/gemfire http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
    http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

<cache:annotation-driven />

<context:property-placeholder location="classpath:test-cache.properties"
    system-properties-mode="OVERRIDE" />

<util:properties id="gemfireProperties">
    <prop key="mcast-port">0</prop>
    <prop key="log-level">info</prop>
    <prop key="license-data-management">${license-data-management}</prop>
</util:properties>

<gfe:cache properties-ref="gemfireProperties" id="gemfireCache" />

<gfe:local-region id="pet-region">
    <gfe:cache-listener>
        <bean
            class="com.mycompany.cache.TestLoggingCacheListener" />
    </gfe:cache-listener>
</gfe:local-region> 
```

我看到如下异常

> schema_reference.4：未能读取架构文档“http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd”，因为 1) 找不到该文档；2) 文件无法读取；3) 文档的根元素不是 .
> 
> cvc-complex-type.2.4.c：匹配通配符是严格的，但找不到元素“gfe:cache”的声明。

我尝试更改为不同版本的 xsd，如下所示，但没有运气，我仍然看到问题。

> [http://www.springframework.org/schema/gemfire/spring-gemfire.xsd](http://www.springframework.org/schema/gemfire/spring-gemfire.xsd)

和

> [http://www.springframework.org/schema/gemfire/spring-gemfire-1.1.xsd](http://www.springframework.org/schema/gemfire/spring-gemfire-1.1.xsd)

和

> [http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd](http://www.springframework.org/schema/gemfire/spring-gemfire-1.2.xsd)

经过以上所有尝试，当我更改为 1.1 版本时，我发现它现在引发了另一个问题

> cvc-complex-type.2.4.c：匹配通配符是严格的，但找不到元素“gfe:local-region”的声明。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:06:07.417

我找到了解决方案。春季版本需要更改为 3.1.1，gemfire 需要更改为 6.6.2。我基本上是一个兼容性问题。

# python - 在 Python 中对字典列表中的数据进行排序和组合

> ID：13864981
> 
> 赞同：2
> 
> 时间：2012-12-13T17:14:04.350
> 
> 标签：python, list, sorting, dictionary

我有一个类似于这个的字典列表：

```
{'Catch': 4.414, 'ShipID': 173, 'Name': u'Sigur\xf0ur \xd3lafsson SF - 44', 'Gear': u'BOTN'}
{'Catch': 2.401, 'ShipID': 173, 'Name': u'Sigur\xf0ur \xd3lafsson SF - 44', 'Gear': u'BOTN'}
{'Catch': 67.463, 'ShipID': 1275, 'Name': u'J\xf3n V\xeddal\xedn VE - 82', 'Gear': u'BOTN'}
{'Catch': 51.803, 'ShipID': 1275, 'Name': u'J\xf3n V\xeddal\xedn VE - 82', 'Gear': u'BOTN'}
{'Catch': 7.539, 'ShipID': 1595, 'Name': u'Fr\xe1r VE - 78', 'Gear': u'BOTN'}
{'Catch': 97.984, 'ShipID': 1903, 'Name': u'\xdeorsteinn \xdeH - 360', 'Gear': u'BOTN'}
{'Catch': 94.796, 'ShipID': 1903, 'Name': u'\xdeorsteinn \xdeH - 360', 'Gear': u'BOTN'}
{'Catch': 61.347, 'ShipID': 2020, 'Name': u'Su\xf0urey VE - 12', 'Gear': u'BOTN'}
{'Catch': 21.135, 'ShipID': 2401, 'Name': u'\xde\xf3runn Sveinsd\xf3ttir VE - 401', 'Gear': u'BOTN'}
{'Catch': 16.151, 'ShipID': 2444, 'Name': u'Vestmannaey VE - 444', 'Gear': u'BOTN'}
{'Catch': 41.213, 'ShipID': 2677, 'Name': u'Bergur VE - 44', 'Gear': u'BOTN'}
{'Catch': 5.046, 'ShipID': 2403, 'Name': u'Hvanney SF - 51', 'Gear': u'NET'}
{'Catch': 2.311, 'ShipID': 2403, 'Name': u'Hvanney SF - 51', 'Gear': u'NET'}
{'Catch': 6.304, 'ShipID': 2403, 'Name': u'Hvanney SF - 51', 'Gear': u'NET'}
{'Catch': 4.231, 'ShipID': 2732, 'Name': u'Skinney SF - 20', 'Gear': u'NET'}
{'Catch': 6.46, 'ShipID': 2732, 'Name': u'Skinney SF - 20', 'Gear': u'NET'}
... 
```

此列表已预先排序：

```
list_sorted = sorted(landingList, key=lambda d:(d['Gear'], d['ShipID'])) 
```

这是冰岛船只登陆的列表，我想做的是将列表按“Gears”拆分并添加捕获量，以便显示总捕获量。与此类似

'BOTN' 列表如下所示：

```
{'Catch': 6.815, 'ShipID': 173, 'Name': u'Sigur\xf0ur \xd3lafsson SF - 44', 'Gear': u'BOTN'}
{'Catch': 119.266, 'ShipID': 1275, 'Name': u'J\xf3n V\xeddal\xedn VE - 82', 'Gear': u'BOTN'}
{'Catch': 7.539, 'ShipID': 1595, 'Name': u'Fr\xe1r VE - 78', 'Gear': u'BOTN'}
{'Catch': 192.78, 'ShipID': 1903, 'Name': u'\xdeorsteinn \xdeH - 360', 'Gear': u'BOTN'}
{'Catch': 61.347, 'ShipID': 2020, 'Name': u'Su\xf0urey VE - 12', 'Gear': u'BOTN'}
{'Catch': 21.135, 'ShipID': 2401, 'Name': u'\xde\xf3runn Sveinsd\xf3ttir VE - 401', 'Gear': u'BOTN'}
{'Catch': 16.151, 'ShipID': 2444, 'Name': u'Vestmannaey VE - 444', 'Gear': u'BOTN'}
{'Catch': 41.213, 'ShipID': 2677, 'Name': u'Bergur VE - 44', 'Gear': u'BOTN'} 
```

那么“NET”列表将是这样的：

```
{'Catch': 13.661, 'ShipID': 2403, 'Name': u'Hvanney SF - 51', 'Gear': u'NET'}
{'Catch': 10.691, 'ShipID': 2732, 'Name': u'Skinney SF - 20', 'Gear': u'NET'} 
```

当然还有更多的齿轮和着陆。但这只是为了演示列表的外观和我手头的任务。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:18:10.383

您可以使用以下[`itertools.groupby()`功能](http://docs.python.org/2/library/itertools.html#itertools.groupby)：

```
from itertools import groupby
from operator import itemgetter

for gear, group in groupby(list_sorted, key=itemgetter('Gear')):
    # group is now an iterator, loop over it to get all items with the same value for Gear.
    # gear is the value of this group's "Gear" key. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:36:54.653

@Martijn 指定使用[itertools.groupby](http://docs.python.org/2/library/itertools.html#itertools.groupby)，但实现不会是直截了当的。这就是我能够做到这一点的方法

```
from itertools import groupby, tee
from operator import itemgetter
from copy import deepcopy
#Create a Wrapper named combine to wrap the entire functionality
def combine(data):

    #Which has a nested function to calculate the subtotal
    #For each Gear and Name Pair
    def subtotal(data):
            #Now Iterate through the grouped Gear Items
        for k1, v1 in data.iteritems():
            #And save the current Gear
            gear = k1
            #For Each person grouped catch
            for k2, v2 in v1:
                #Save the name
                name = k2
                #Create two iterator from one
                #We need this as we don't want
                #to lose the iterator after we
                #make an entire pass to calculate
                #the total catch
                v2_1, v2_2 = tee(v2)
                #Now calculate the total catch for each person
                tot_catch = sum(e['Catch'] for e in v2_1)
                #and select the first element from the group
                v2_2 = next(v2_2)
                #and update the catch with the total catch under
                #his belt and discard the rest
                v2_2['Catch'] = catch
                #finlly yield a tuple of the subtotal row
                #along with the gear and fisherman's name
                yield (gear, name, v2_2)
    #First create a copy of the data as we would be changing it in-place
    data = deepcopy(data)
    #First Group by the Gear
    data_groupby_Gear = groupby(data, key = itemgetter('Gear'))
    #For each Gear group by the fisherman
    data_groupby_Gear_then_Name = {k: groupby(list(v), itemgetter('Name'))
                                   for k,v in data_groupby_Gear}
    #and return the combined result
    return subtotal(data_groupby_Gear_then_Name)

#Just iterate through the combined data and print
#in any way you desire
for gear, name, sumtotal in combine(data):
    print u"{:10} {:20} {}".format(gear, name, sumtotal) 
```

最终输出如下所示，但可以根据需要重新格式化显示

```
NET        Hvanney SF - 51      {'Catch': 13.661000000000001, 'ShipID': 2403, 'Name': u'Hvanney SF - 51', 'Gear': u'NET'}
NET        Skinney SF - 20      {'Catch': 10.690999999999999, 'ShipID': 2732, 'Name': u'Skinney SF - 20', 'Gear': u'NET'}
BOTN       Sigurður Ólafsson SF - 44 {'Catch': 6.8149999999999995, 'ShipID': 173, 'Name': u'Sigur\xf0ur \xd3lafsson SF - 44', 'Gear': u'BOTN'}
BOTN       Jón Vídalín VE - 82  {'Catch': 119.26599999999999, 'ShipID': 1275, 'Name': u'J\xf3n V\xeddal\xedn VE - 82', 'Gear': u'BOTN'}
BOTN       Frár VE - 78         {'Catch': 7.539, 'ShipID': 1595, 'Name': u'Fr\xe1r VE - 78', 'Gear': u'BOTN'}
BOTN       Þorsteinn ÞH - 360   {'Catch': 192.78, 'ShipID': 1903, 'Name': u'\xdeorsteinn \xdeH - 360', 'Gear': u'BOTN'}
BOTN       Suðurey VE - 12      {'Catch': 61.347, 'ShipID': 2020, 'Name': u'Su\xf0urey VE - 12', 'Gear': u'BOTN'}
BOTN       Þórunn Sveinsdóttir VE - 401 {'Catch': 21.135, 'ShipID': 2401, 'Name': u'\xde\xf3runn Sveinsd\xf3ttir VE - 401', 'Gear': u'BOTN'}
BOTN       Vestmannaey VE - 444 {'Catch': 16.151, 'ShipID': 2444, 'Name': u'Vestmannaey VE - 444', 'Gear': u'BOTN'}
BOTN       Bergur VE - 44       {'Catch': 41.213, 'ShipID': 2677, 'Name': u'Bergur VE - 44', 'Gear': u'BOTN'} 
```

# node.js - 如何使用 node.js superagent 发布 multipart/form-data

> ID：13864983
> 
> 赞同：26
> 
> 时间：2012-12-13T17:14:16.520
> 
> 标签：node.js, superagent

我正在尝试将我的超级代理发布请求中的内容类型发送到 multipart/form-data。

```
var myagent = superagent.agent();

myagent
  .post('http://localhost/endpoint')
  .set('api_key', apikey)
  .set('Content-Type', 'multipart/form-data')
  .send(fields)
  .end(function(error, response){
    if(error) { 
       console.log("Error: " + error);
    }
  }); 
```

我得到的错误是： TypeError: Argument must be a string

如果我删除：

```
.set('Content-Type', 'multipart/form-data') 
```

我没有收到任何错误，但我的后端正在接收内容类型的请求：application/json

如何强制内容类型为 multipart/form-data 以便我可以访问 req.files()？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2017-05-03T06:01:54.430

首先，您没有提及以下任何一项：

```
.set('Content-Type', 'multipart/form-data') 
```

或者

```
.type('form') 
```

第二，你不使用`.send`，你使用`.field(name, value)`。

### 例子

假设您想发送一个带有以下内容的表单数据请求：

*   两个文本字段：`name`和`phone`
*   一个文件：`photo`

所以你的请求将是这样的：

```
superagent
  .post( 'https://example.com/api/foo.bar' )
  .set('Authorization', '...')
  .accept('application/json')
  .field('name', 'My name')
  .field('phone', 'My phone')
  .attach('photo', 'path/to/photo.gif')

  .then((result) => {
    // process the result here
  })
  .catch((err) => {
    throw err;
  }); 
```

并且，假设您想将 JSON 作为您的某个字段的值发送，那么您将执行此操作。

```
try {
  await superagent
         .post( 'https://example.com/api/dog.crow' )
         .accept('application/json')
         .field('data', JSON.stringify({ name: 'value' }))
}
catch ( ex ) {
    // .catch() stuff
}

// .then() stuff... 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-15T12:25:14.453

尝试 `.type('form')` 代替 `.set('Content-Type', 'multipart/form-data')`

见[http://visionmedia.github.io/superagent/#setting-the-content-type](http://visionmedia.github.io/superagent/#setting-the-content-type)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-26T04:34:51.000

目前尚不清楚`fields`您发送的变量中有什么，但这里有一些信息可以帮助您确定问题所在。

首先，如果您实际上是在尝试构建一个多部分请求，这是这样做的官方文档：http: [//visionmedia.github.com/superagent/#multipart-requests](http://visionmedia.github.com/superagent/#multipart-requests)

至于你得到的错误......

原因是在准备请求的过程中，SuperAgent 会检查要发送的数据是否为字符串。如果不是，它会尝试根据“Content-Type”的值序列化数据，如下所示：

```
exports.serialize = {
  'application/x-www-form-urlencoded': qs.stringify,
  'application/json': JSON.stringify
}; 
```

在这里使用：

```
// body
if ('HEAD' != method && !req._headerSent) {
  // serialize stuff
  if ('string' != typeof data) {
    var serialize = exports.serialize[req.getHeader('Content-Type')];
    if (serialize) data = serialize(data);
  }

  // content-length
  if (data && !req.getHeader('Content-Length')) {
    this.set('Content-Length', Buffer.byteLength(data));
  }
} 
```

这意味着要手动设置表单“Content-Type”，您将使用

`.set('Content-Type', 'application/x-www-form-urlencoded')`

或者

`.type('form')`正如[risyasin](https://stackoverflow.com/a/15432418/355743)提到的

任何其他“Content-Type”都不会被序列化，如果变量的值不是字符串，`Buffer.byteLength(data)`则会随后引发`TypeError: Argument must be a string`异常 。`fields`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-08-29T17:26:36.170

这对我有用。我有一个单字段表单，即上传文件。我将表单转换为 HTML5 FormData 元素，然后按如下方式进行操作：

```
var frm = new FormData(document.getElementById('formId'));
var url =  'url/here';

superagent.post(url)                    
.attach('fieldInFormName', frm.get('fieldInFormName'))                                        
.end( function (error, response) {
    //handle response
}); 
```

请注意，我尝试了各种在 superagent 中手动设置“Content-Type”的方法，但由于 Content-Type 中需要多部分标识符，它从未正常工作。

# java - 如何为方法添加返回语句 - 初学者

> ID：13864985
> 
> 赞同：0
> 
> 时间：2012-12-13T17:14:20.667
> 
> 标签：java

当我输入一个值 ( `202 cents`) 时，它应该以`5 cents or 2 cents`硬币形式给我这个金额。在我的代码中一切正常，但是输出在它自己的类`TwoCent`中作为 System.out 语句给出。`FiveCent`我想要做的是`return`数量`5 cents`和`2 cents`硬币，以便我可以在`Test`课堂上捕获并展示它。

注意：在下面的代码中，2 美分和 5 美分硬币的数量从它自己的类返回（显示/打印到控制台）。但我想修改代码，以便那些方法（在`TwoCents`和`FiveCents`类中）将`return`并且`int`可能与硬币的数量有关。我应该只能从`Test`类中获取这些值并显示。

```
 public abstract class Coin {
    protected Coin co;
    public abstract void finCoin(Money m);
    public void setnext(Coin c) {
        co = c;
    }
}

public class TwoCent extends Coin{

    @Override
    public void finCoin(Money m) {
        if(m.getChange()%2==0){
          System.out.PrintLn("Return "+ m.getChange/2);
    else {
        int remainngCoins=m.getChange()*((m.getChange/2)*2));
        m.setChange(remainngCoins);
        co.setnext(m);
    }
}

public class FiveCent extends Coin{

    @Override
    public void finCoin(Money m) {
        if(m.getChange()%5==0){
          System.out.PrintLn("Return "+ m.getChange/5);
    else {
        int remainngCoins=m.getChange()*((m.getChange/5)*5));
        m.setChange(remainngCoins);
        co.setnext(m);
    }
}

public class Test {
public void showcoin(){
Coin f = new FiveCent();
        Cash t = new TwoCent();

        f.setSuccessor(t);

        Money cr = new Money(200);
        f.finCoin(cr);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:20:02.143

您必须先添加返回类型才能让您的方法返回某些内容。

一个简单的例子：

```
public int getInteger(){

int i = 10;
return i;

// see the return type is int and 
// I am returning an integer value 10
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:20:47.460

有趣的是，抽象类 Coin 的定义已经描述了方法 finCoin(Money m) 必须返回一个 int。但是在这两个实现中（FiveCent 和 TwoCent）都没有返回这个值。

你要做的是用这样的返回替换 System.out.println 的东西：

**代替**

```
 @Override
public void finCoin(Money m) {
    if(m.getChange()%5==0){
      System.out.PrintLn("Return "+ m.getChange/5);
else {
    int remainngCoins=m.getChange()*((m.getChange/5)*5));
    m.setChange(remainngCoins);
    co.setnext(m);
} 
```

** 你做 **

```
 @Override
public int finCoin(Money m) {   // VERY IMPORTANT replace void by int
    if(m.getChange()%5==0){
      // System.out.PrintLn("Return "+ m.getChange/5);
      return m.getChange/5;   // thats how you return a value and end this method call
    else {
      int remainngCoins=m.getChange()*((m.getChange/5)*5));
      m.setChange(remainngCoins);
      co.setnext(m);
    }
    return 0;   // this is just a guess but you MUST return something
} 
```

# iphone - 拍照后翻转图像

> ID：13864986
> 
> 赞同：3
> 
> 时间：2012-12-13T17:14:23.757
> 
> 标签：iphone, objective-c

我正在开发前置摄像头应用程序`UIImagePickercontroller`。

当我捕获图像时，它显示为从左到右翻转。

我怎样才能翻转它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:15:01.150

试试这个

```
UIImage * flippedImage = [UIImage imageWithCGImage:picture.CGImage scale:picture.scale orientation:UIImageOrientationLeftMirrored];

picture = flippedImage; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:03:05.617

你也可以使用

```
image.transform = CGAffineTransformScale(image.transform, -1, 1); 
```

# ruby-on-rails-3 - Rails 3：在数据库中存储时间量

> ID：13864988
> 
> 赞同：1
> 
> 时间：2012-12-13T17:14:25.697
> 
> 标签：ruby-on-rails-3

有没有办法在数据库中存储天、周或月。我不是在谈论日期（如 2012 年 12 月 13 日），而是关于时间量，如 2 周、5 天或 6 个月。

我发现的建议之一是：[在数据库中存储时间 (hh:mm) 的最佳方法](https://stackoverflow.com/questions/538739/best-way-to-store-time-hhmm-in-a-database)，在这种方法中，您将分钟作为整数存储在数据库中并根据需要对其进行操作。

另一种，[在 MySQL 数据库中按时存储跨度的最佳方法？](https://stackoverflow.com/questions/3867598/best-way-to-store-span-on-time-in-a-mysql-database)，谈到了简单地使用时间数据类型，但这有一个非常低的范围限制。

有没有更干净的方法来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:46:33.233

是的，有一种更清洁的方法可以做到这一点。只需使用 postgres 和内置数据类型 INTERVAL：[http ://www.postgresql.org/docs/6.3/static/c0804.htm](http://www.postgresql.org/docs/6.3/static/c0804.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T21:28:20.303

对于rails，我最成功的只是在我的模型中存储一个整数字段来表示以秒为单位的累积时间。根据您的用例，您可能会更成功地存储整数分钟。

为了演示几秒钟，您可以执行以下操作：

```
rails g migration add_seconds_elapsed_to_foo seconds_elapsed:integer 
```

在您的应用程序中的某处：

```
@foo.seconds_elapsed
 => 2343 
distance_of_time_in_words(Time.now, Time.now + @foo.seconds_elapsed.seconds, true)
 => "39 minutes" 
```

结合时间对象，您可以为各种精度和格式选择许多选项。

# tsql - 比较 ASP.NET 中的两个时间列

> ID：13864989
> 
> 赞同：3
> 
> 时间：2012-12-13T17:14:31.247
> 
> 标签：tsql

我对 ASP.NET 和 SQL 比较陌生，所以我很难弄清楚如何比较两个时间列。我在 .mdb 数据库中有一个带时间戳的列，然后是一个 Now() 列。我需要一个 gridview 显示时间戳中“大于或等于 3 小时”的记录。知道我怎么能做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:18:16.340

Transact-SQL 时间戳数据类型是没有时间相关值的二进制数据类型。

所以回答你的问题：有没有办法从时间戳类型列中获取 DateTime 值？

答案是不

您需要另一列`datetime2`类型并使用`>`运算符进行比较。您可能希望设置默认值`getutcdate()`以在插入每一行时设置它。

更新：

由于该列是`datetime`类型而不是`timestamp`类型（SQL Server 中有一种类型称为`timestamp`，因此会造成混淆），您可以这样做

`WHERE [TimeCalled] <= DATEADD(hour, -3, GETDATE())`

确保您的服务器与您的代码在同一时区运行。以 UTC 格式存储所有日期可能更安全。在这种情况下，请`GETUTCDATE`改用`GETDATE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:19:23.900

时间戳一般用于跟踪记录的更改，并在每次记录更改时更新。如果要存储特定值，则应使用日期时间字段。

如果您使用的是 DateTime 列，并且想要 TSQL 中的结果，请尝试

```
DATEDIFF(Hour, 'Your DateTime Column here', 'pass Now() here' ) 
```

尝试在 TSQL 中执行此示例：

```
select DATEDIFF(Hour, '2012-11-10 00:00:59.900', '2012-11-10 05:01:00.100') 
```

# jquery - 具有隐藏行/行 ID 的数据表/服务器端处理显示为图像

> ID：13864992
> 
> 赞同：2
> 
> 时间：2012-12-13T17:14:34.803
> 
> 标签：jquery, datatables

我正在使用 DataTables，以及 jquery-datatables-editable，使用服务器端处理和隐藏的详细信息行。

它运行良好，除了每一行都有一个“id”，它等于显示隐藏详细信息行的可点击图像。例如，表中的每一行（从 firebug 或 chrome 元素检查器查看）如下所示：

```
<tr id="&lt;img src=&quot;images/details_open.png&quot;&gt;" class="odd">
<td class="center"><img src="images/details_open.png"></td>
<td class=" sorting_1">Carpet By Joe</td>
<td class="">Joe</td><td class="">123-456-7890</td>
<td class="">ad@here.com</td>
</tr> 
```

这是javascript：

```
$(document).ready(function() {
    var what = "customer";
    /* Init DataTables */
    var oTable = $('#example').dataTable({
        "bJQueryUI" : true,
        //"bProcessing" : true,
        "bServerSide" : true,
        "sPaginationType" : "full_numbers",
        "sAjaxSource" : "lib/gen.php?what=" + what,

        "aoColumns" : [{
            "sClass" : "center",
            "bSortable" : false,
        }, {
            "sName" : "name",
            "mData" : "2"
        }, {
            "sName" : "contact",
            "mData" : "3"
        }, {
            "sName" : "phone",
            "mData" : "4"
        }, {
            "sName" : "email",
            "mData" : "5"
        }],
        "aaSorting" : [[1, 'desc']]
    }).makeEditable({

        sUpdateURL : "lib/edit.php?what=" + what + "&action=edit",
        sAddURL : "lib/edit.php?what=" + what + "&action=add",
        sDeleteURL : "DeleteData.php",
        sAddDeleteToolbarSelector : ".dataTables_length",
        "oAddNewRowFormOptions" : {
            "title" : "Add A New Customer",
            "width" : 400,
            "height" : 450
        },
        "aoColumns" : [null, {
            cssclass : 'required'
        }, {
            indicator : "<img src='images/indicator.gif'>",
            tooltip : "Doubleclick to edit...",
            event : "dblclick",
            style : "inherit",

        }]
    });

    /* Formating function for row details */
    function fnFormatDetails(nTr) {
        var aData = oTable.fnGetData(nTr);
        //var id = aData[1];
        var sOut = '<div>';
        var sOut = '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
        sOut += '<tr><th width="75" align="left">&nbsp;</th><th width="300" align="left">Address Information</th><th align="left">Notes</th></tr>';
        sOut += '<tr><td><strong>Address: </strong></td><td class="5"><div class="edittable">' + aData[6] + '</div></td><td  style="vertical-align: top;" class="9" rowspan="4"><div class="edittextarea">' + aData[10] + '</div></td></tr>';
        sOut += '<tr><td><strong>City: </strong></td><td class="6"><div class="edittable">' + aData[7] + '</div></td></tr>';
        sOut += '<tr><td><strong>State: </strong></td><td class="7"><div class="edittable">' + aData[8] + '</div></td></tr>';
        sOut += '<tr><td><strong>Zip: </strong></td><td class="8"><div class="edittable">' + aData[9] + '</div></td></tr>';
        sOut += '</table>';
        return sOut;
    }

    $('#example tbody td img').live('click', function() {
        var nTr = this.parentNode.parentNode;
        if (this.src.match('details_close')) {
            /* This row is already open - close it */
            this.src = "images/details_open.png";
            oTable.fnClose(nTr);
        } else {
            /* Open this row */
            this.src = "images/details_close.png";
            oTable.fnOpen(nTr, fnFormatDetails(nTr), 'details');
            //make_jeditable(nTr);
        }
    });

}); 
```

这是我的服务器端处理的输出（json 在底部，这是传递给数据表的内容，数组是为了便于阅读）：

```
Array
(
    [sEcho] => 0
    [iTotalRecords] => 3
    [iTotalDisplayRecords] => 3
    [aaData] => Array
        (
            [0] => Array
                (
                    [0] => <img src="images/details_open.png">
                    [1] => 1
                    [2] => Company 1
                    [3] => Joe Bob
                    [4] => 123-456-7890
                    [5] => admin@here.com
                    [6] => 123 My Way
                    [7] => Fayetteville
                    [8] => AR
                    [9] => 12345
                    [10] => This is a note for this customer, 1
                    [extra] => hrmll
                    [DT_RowId] => 1
                )

            [1] => Array
                (
                    [0] => <img src="images/details_open.png">
                    [1] => 2
                    [2] => Aaron's Floor Cleaning
                    [3] => Aaron Man
                    [4] => (133) 456-7890
                    [5] => email@there.com
                    [6] => 321\. There Way
                    [7] => Scottsdale
                    [8] => AR
                    [9] => 54327
                    [10] => This is another note, but about another customer, 36

                    [extra] => hrmll
                    [DT_RowId] => 2
                )

            [2] => Array
                (
                    [0] => <img src="images/details_open.png">
                    [1] => 4
                    [2] => Carpet By Joe
                    [3] => Joe
                    [4] => 123-456-7890
                    [5] => ad@here.com
                    [6] => 123 SW Way Over St.
                    [7] => Springfield
                    [8] => AL
                    [9] => 87654
                    [10] => This is a note here.
                    [extra] => hrmll
                    [DT_RowId] => 4
                )

        )

)

{"sEcho":0,"iTotalRecords":"3","iTotalDisplayRecords":"3","aaData":[{"0":"<img src=\"images\/details_open.png\">","1":"1","2":"Company 1","3":"Joe Bob","4":"123-456-7890","5":"admin@here.com","6":"123 My Way","7":"Fayetteville","8":"AR","9":"12345","10":"This is a note for this customer, 1","extra":"hrmll","DT_RowId":"1"},{"0":"<img src=\"images\/details_open.png\">","1":"2","2":"Aaron's Floor Cleaning","3":"Aaron Man","4":"(133) 456-7890","5":"email@there.com","6":"321\. There Way","7":"Scottsdale","8":"AR","9":"54327","10":"This is another note, but about another customer, 36\n","extra":"hrmll","DT_RowId":"2"},{"0":"<img src=\"images\/details_open.png\">","1":"4","2":"Carpet By Joe","3":"Joe","4":"123-456-7890","5":"ad@here.com","6":"123 SW Way Over St.","7":"Springfield","8":"AL","9":"87654","10":"This is a note here.","extra":"hrmll","DT_RowId":"4"}]} 
```

这是表格的 HTML：

```
<table cellpadding="0" cellspacing="0" border="0" class="display" id="example">
<thead>
    <tr>
        <th width="4%"></th>
        <th width="25%">Customer Name</th>
        <th width="20%">Contact</th>
        <th width="20%">Phone</th>
        <th width="25%">Email</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td colspan="8" class="dataTables_empty">Loading data from server</td>
    </tr>
</tbody>
<tfoot>
    <tr>
        <th></th>
        <th>Customer Name</th>
        <th>Contact</th>
        <th>Phone</th>
        <th>Email</th>
    </tr>
</tfoot>
</table> 
```

返回的信息具有“DT_RowId”项，但它并未按应有的方式解析为行的 id。如果我可以提供任何进一步的信息，请告诉我。

编辑：

阿克提，你是个天才。

我删除了这个：

```
[0] => <img src="images/details_open.png"> 
```

完全从服务器端处理，根据您的建议，我的 javascript 的顶部现在看起来像：

```
"aoColumns" : [{
    "sClass" : "center",
    "mData": function () {
        return '<img src="images/details_open.png">';
 },
    "bSortable" : false
}, 
```

我注意到在文档中提到“mData”是“mDataProp”的较新版本，所以我改用它。您的其他建议使我重新考虑我的其他一些代码。非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:01:32.397

似乎 dataTable 使用 [0] 作为 id 名称。这是不好的。最后推下去试试。。

或使用以下提示：

*   使用 mDataProp 而不是 mData。您将拥有更多的控制权，并且在阅读代码时会更加合乎逻辑。此外，在添加内容时，您不必确保拥有正确的索引。

    ```
    aoColumns: [
       { mDataProp: "customername", bSortable: true },
       { mDataProp: "contact", bSortable: true },
    ] 
    ```

    JSON 输出类似于

    ```
    [aaData] => Array
      (
        [0] => Array
            (
                [company] => Company 1
                [customername] => Joe Bob 
    ```

*   我注意到您总是将 src="images/details_open.png" 作为 [0]。这有点浪费带宽。相反，试试这个

    ```
    aoColumns: [

        [...]

       { mDataProp: function(x) {
          return '<img src="images/details_open.png">';
       }, bSortable: true },

    ] 
    ```

    这非常有用，因为你可以做这样的事情！

    ```
    aoColumns: [

        [...]

       { mDataProp: function(x) {
          return '<img src="images/details_open.png" data-id="' + x.id + '">';
       }, bSortable: true },

    ] 
    ```

    *   如果要编辑每一行，请使用 fnDrawCallBack...

        ```
         fnDrawCallback: function ( oSettings ) {
                 if ( oSettings.aiDisplay.length == 0 ) {
                     return;
                 }

                 var TRs = $('#lst_production tbody tr');
                 var iColspan = TRs[0].getElementsByTagName('td').length;

                 for ( var i=0 ; i<TRs.length ; i++ ) {

                     var iDisplayIndex = oSettings._iDisplayStart + i;
                     data = oSettings.aoData[ oSettings.aiDisplay[iDisplayIndex] ]._aData;

                     // add the ID to the row
                     $(TRs[i]).attr("id", data.id);

                     // add class red-background if customer is from AR
                     if (data.state == 'AR') {
                         $(TRs[i]).addClass("red-background");
                     }

                 }
             }, 
        ```

# mysql - MySQL #1064 错误

> ID：13864999
> 
> 赞同：-1
> 
> 时间：2012-12-13T17:14:55.063
> 
> 标签：mysql, mysql-error-1064

虽然我已经用谷歌搜索了很长一段时间的解决方案，但我仍然找不到这个错误的嵌套位置。

我可以创建一个不会产生任何问题的好表

```
CREATE  TABLE IF NOT EXISTS `jcom_11645246_silowniainz_karta`.`Cennik` ( 
  `Klub_idKlubu` INT NOT NULL , 
  `Kategoria` VARCHAR(20) NOT NULL , 
  `Nazwa` VARCHAR(50) NOT NULL , 
  `Koszt` DECIMAL(6,2) NOT NULL , 
  `Id` INT NOT NULL , 
  PRIMARY KEY (`Klub_idKlubu`, `Id`) , 
  INDEX `fk_Cennik_Klub` (`Klub_idKlubu` ASC) , 
  CONSTRAINT `fk_Cennik_Klub` 
    FOREIGN KEY (`Klub_idKlubu` ) 
    REFERENCES `jcom_11645246_silowniainz_karta`.`Klub` (`idKlubu` ) 
    ON DELETE NO ACTION 
    ON UPDATE NO ACTION) 
ENGINE = MyISAM; 
```

有问题的创建表看起来像这样

```
CREATE  TABLE IF NOT EXISTS `jcom_11645246_silowniainz_karta`.`Ogloszenie` ( 
  `idOgloszenia`  NOT NULL , 
  `Klub_idKlubu` INT NOT NULL , 
  `TytulOgloszenia` VARCHAR(40) NOT NULL , 
  `TrescOgloszenia` VARCHAR(400) NOT NULL , 
  PRIMARY KEY (`Klub_idKlubu`, `idOgloszenia`) , 
  INDEX `fk_Ogloszenia_Klub` (`Klub_idKlubu` ASC) , 
  CONSTRAINT `fk_Ogloszenia_Klub` 
    FOREIGN KEY (`Klub_idKlubu` ) 
    REFERENCES `jcom_11645246_silowniainz_karta`.`Klub` (`idKlubu` ) 
    ON DELETE NO ACTION 
    ON UPDATE NO ACTION) 
ENGINE = MyISAM; 
```

错误看起来像这样

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your   MySQL server version for the right syntax to use near 'NOT NULL , 
  `Klub_idKlubu` INT NOT NULL , 
  `TytulOgloszenia` VARCHAR(40) N' at line 2 
```

我看不出 table1 和 table2 结构之间有什么不同可能导致这个错误。我找过“'”、太多的“、”或缺少“;”。我能得到一些帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:16:48.230

错误告诉你去哪里看，这里是：

> ```
>  `idOgloszenia`  NOT NULL 
> ```

你忘了写字段的类型，所以`NOT NULL`在这一点上是出乎意料的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:17:24.790

你错过了这里的类型：

```
`idOgloszenia`  NOT NULL , 
```

只需插入一个类似的类型`INT`，它就会起作用。

```
`idOgloszenia` INT NOT NULL , 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:17:38.207

您的查询缺少`INT`第 2 行：

```
`idOgloszenia` INT NOT NULL 
```