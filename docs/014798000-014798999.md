# StackOverflow 问答 14798000-14798999

# java - String.intern() 线程安全吗

> ID：14798003
> 
> 赞同：14
> 
> 时间：2013-02-10T13:02:46.133
> 
> 标签：java, string, thread-safety

我想在 Java 中使用 String.intern() 来节省内存（将内部池用于具有相同内容的字符串）。我从不同的线程调用这个方法。这是个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T13:11:36.823

你的问题的简短回答是肯定的。它是线程安全的。

但是，您可能需要重新考虑使用此工具来减少内存消耗。原因是您无法从实习字符串列表中删除任何整数。更好的解决方案是为此创建自己的设施。您只需要`HashMap<String,String>`像这样存储字符串：

```
public String getInternedString(String s) {
    synchronized(strings) {
        String found = strings.get(s);
        if(found == null) {
            strings.put(s, s);
            found = s;
        }
        return found;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T13:12:09.457

*   当返回一个不可变的 Java-String 时，该方法是线程安全的。您不能按原样操作字符串。

*   该文档确实表明它*是*线程安全的。（通过强调*任何*）

> 由此可见，*对于任何*两个字符串 s 和 t，当且仅当 s.equals(t) 为真时，s.intern() == t.intern() 才为真。

*   第三，JNI 接口使用 C 语言`jobject`。`jstring`是其中之一，并且按照`jobject`定义都是不可变的。因此，在本机 c 级别上，我们也保留了线程安全性。

命名这些，我们有充分的理由说它是线程安全的。

**PS：**但是，如果您使用多个类加载器，您最终可能会得到具有挑战性的结果，因为字符串池是按`String-class`.

```
A pool of strings, initially empty, is maintained privately by the class String. 
```

# java - 签名 Java 小程序中的 SocketException

> ID：14798004
> 
> 赞同：0
> 
> 时间：2013-02-10T13:02:47.483
> 
> 标签：java, security, ftp, firewall, signed-applet

我有一个使用 Apache commons.net API for FTP 的 Java 小程序。我最初在没有签名的情况下运行了这个小程序，它抛出了一个

```
SocketException : Software caused connection abort 
```

我在网上查了一下，发现我的防火墙阻止了我的小程序。因此，为了确认这一点，我禁用了防火墙并运行了小程序。它工作得很好。

然后，我按照另一个站点中的说明使用 nnetbeans 对小程序进行了自签名：

**项目属性**->**启用 Web 启动**->**使用生成的密钥进行自签名**

尽管如此，同样的错误仍然存​​在。我找不到任何解释这个特定错误的东西。

# javascript - Three.js - 导入带有纹理的 3d 对象

> ID：14798005
> 
> 赞同：2
> 
> 时间：2013-02-10T13:02:59.447
> 
> 标签：javascript, three.js, webgl, 3dsmax

我有一个从 3ds max 导出的 .obj 文件和一个包含材料的 .mtl 文件。我想用 three.js 渲染这个对象，但它似乎没有加载纹理。这是我的javascript代码

```
var texture = THREE.ImageUtils.loadTexture( 'items/m16/m16.jpg' );

var loader = new THREE.OBJLoader();
loader.load( "items/m16/m16.obj", function ( object ) {

for ( var i = 0, l = object.children.length; i < l; i ++ ) {

     object.children[ i ].material.map = texture;

}

//  object.position.y = -100;

scene.add( object );

} ); 
```

这是 .mtl 文件的上下文

```
newmtl Material__25
Ns 10.0000
Ni 1.5000
d 1.0000
Tr 0.0000
Tf 1.0000 1.0000 1.0000 
illum 2
Ka 0.5880 0.5880 0.5880
Kd 0.5880 0.5880 0.5880
Ks 0.0000 0.0000 0.0000
Ke 0.0000 0.0000 0.0000
map_Ka m16.jpg
map_Kd m16.jpg 
```

我看不出我哪里错了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-10T13:11:56.947

由于您有一个 .mtl 文件，因此您应该改用 OBJMTLLoader。这样您发布的所有代码都将变为：

```
var loader = new THREE.OBJMTLLoader();
loader.load( "items/m16/m16.obj", function ( object ) { scene.add( object ); } ); 
```

# javascript - 将视频嵌入到警报消息中

> ID：14798006
> 
> 赞同：0
> 
> 时间：2013-02-10T13:03:08.970
> 
> 标签：javascript, video, embed, alert

我正在使用 HTML 和 Javascript 创建一个网页，我包含一个使用 javascripts 警报功能的帮助按钮，以便用户获得有关如何使用网页的一些信息。

我进行了无休止的研究，以了解是否可以将视频嵌入到警报消息中。我还没有找到一个甚至接近这样的网页，它甚至可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:12:05.260

由于该`alert(...)`函数只接受一个字符串作为参数，因此这些是您的备用选项：

*   [jQuery UI 对话框](http://jqueryui.com/dialog/)
*   [引导模式](http://twitter.github.com/bootstrap/javascript.html#modals)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:09:04.153

您必须为任务创建自己的 javascript 弹出/警报/对话框，或者您可以使用[jQuery UI 对话框](http://jqueryui.com/dialog/)或[Bootstrap Modal](http://twitter.github.com/bootstrap/javascript.html#modals)。您不能在警告框中显示纯文本以外的任何内容。

从[文档](https://developer.mozilla.org/en-US/docs/DOM/window.alert)中：

```
window.alert(message); 
```

> message 是要在警报对话框中显示的文本字符串，或者是转换为字符串并显示的对象。

# php - 获取当前帖子 ID 的 the_terms 名称

> ID：14798009
> 
> 赞同：1
> 
> 时间：2013-02-10T13:03:47.570
> 
> 标签：php, wordpress, custom-taxonomy

当我想获得包含所有分类名称的数组时，这对我有用：

```
get_terms( 'portfolio-skills', array( 'fields' => 'names' ) ); 
```

如果我想获取与当前帖子相关的术语名称怎么办。我试过这个，但它不工作：

```
get_terms( 'portfolio-skills', array( 'fields' => 'names' ), 'include' => array( $post->ID ) ); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T13:12:46.340

谢谢@Pekka 웃，我改变了它并且它正在工作：

```
wp_get_object_terms( $post->ID, 'portfolio-skills', array( 'fields' => 'names' ) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-26T18:19:39.723

```
$term_list = get_the_terms($post->ID, 'your_taxonomy');
$types ='';
foreach($term_list as $term_single) {
     $types .= ucfirst($term_single->slug).', ';
}
$typesz = rtrim($types, ', ');
echo $typesz; 
```

# perl - 存储和访问数据以供将来分析运营商内部和运营商间的可变性

> ID：14798012
> 
> 赞同：1
> 
> 时间：2013-02-10T13:04:01.640
> 
> 标签：perl, r, postgresql

我即将开始一个简短的项目，该项目将涉及合理数量的数据，我希望以合理的方式存储这些数据 - 最好是 postgressql 数据库。

我将简要介绍一下这项任务。我将处理和分析一系列图像的数据，每个图像都有一个唯一的 ID。对于每张图像，我自己和其他操作员将完成一些简单的图像处理任务，包括调整角度和放置区域，最终结果是许多定量参数 - 例如均值、方差等。我们预计这些措施将存在操作员内部和操作员之间的可变性这是我想分析的。

我最初的计划是按以下方式存储数据

```
ID   Operator   Attempt    Date     Result1     Result2      Reconstruction Method    Iterations 
1    AB         1          01/01/13   x         x            FBP
1    AB         2          01/01/13   x         x            FBP
1    CD         1          01/01/13   x         x            FBP
1    CD         2          01/01/13   x         x            FBP
2    AB         1          01/01/13   x         x            FBP
2    AB         2          01/01/13   x         x            FBP
2    CD         1          01/01/13   x         x            FBP
2    CD         2          01/01/13   x         x            FBP
1    AB         1          11/01/13   x         x            FBP
1    AB         2          01/01/13   x         x            MLEM 
```

现在我想比较（使用相关性和 Bland Altman 图）是同一操作员处理相同图像（图像必须具有相同的 ID、日期、重建技术）的所有操作员的结果差异。即对于所有相同的图像和操作员，尝试 1 和 2 有何不同。我想对互操作者的可变性进行相同的分析，即对于使用 FBP 重建的所有图像，AB 与 ID 1 的 CD 相比如何，或者对于使用 MLEM 重建的所有图像，与 AB 相比如何。不应比较具有相同唯一 ID 但在不同日期或重建技术获取的图像，因为它们将包含差异而不是操作员的可变性。

我有各种 R 脚本来进行分析，但我不确定如何访问我的数据并以合理的格式排列数据以进行分析，或者我计划的存储方法是否最适合这样做。过去我使用 perl 访问数据库并提取数字，但我最近发现 Rpostgressql 可能更合适。

我想我的问题是，对于这样的数据库，我该如何挑选：

(a) 所有唯一图像（ID，在同一日期使用相同的重建方法获取）并比较操作员 AB（CD 等）在尝试 1 和 2 的所有结果 1 中的差异

(b) 同样的事情比较 AB 和 CD、CD 和 EF 等之间的所有 Result1 尝试 1

这是我想要的输出示例（a）

```
ID   Operator    Date     Result1 (Attempt 1)    Result1(Attempt 2)
1    AB          01/01/13     10                      12
2    AB          01/01/13     22                      21
3    AB          03/01/13     15                      17
4    AB          04/01/13     27                      25
5    AB          06/01/13     14                      12
1    AB          11/01/13     3                       6 
```

然后我会分析最后两列

(b) 比较 AB 和 CD 的示例输出

```
ID   Date     Result1 (Op: AB, Att: 1)    Result1(Op: CD: Att 1)
1    01/01/13        10                          12
2    01/01/13        22                          21
3    05/01/13        12                          14
1    11/01/13        19                          24 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:23:30.653

这些只是一个粗略的想法！

> (a) 所有唯一图像（ID，在同一日期使用相同的重建方法获取）并比较操作员 AB（CD 等）在尝试 1 和 2 的所有结果 1 中的差异

对于 (a)，您可以使用使用参数`DISTINCT`&的 SQL 语句`SORT BY`。

### 例如

```
SELECT DISTINCT Images FROM YourTable SORT BY DATE(Date), "Reconstruction Method" 
```

> (b) 同样的事情比较 AB 和 CD、CD 和 EF 等之间的所有 Result1 尝试 1

对于 (b)，您可以使用使用参数的 SQL 语句`WHERE`。

### 例如

```
SELECT * From YourTable WHERE Operator=AB 
```

# jquery - 搜索框中的间距

> ID：14798013
> 
> 赞同：-1
> 
> 时间：2013-02-10T13:04:06.483
> 
> 标签：jquery, keyup, backspace

```
$(document).ready(function()
{
   $('#searchInput').keypress(function() 
   {
      if($(this).val() == '')
      {
        $('#button').attr('disabled', true);
      }
      else
      {
        $('#button').removeAttr('disabled');
      }

   });
}); 
```

我在按钮 id 旁边添加了“禁用”现在我有一个问题。当我按下空格并单击搜索按钮时，没问题，一切都很好。但是在我按下空格键并按下退格键后，我正在单击搜索按钮并显示结果。我无法解决问题。我想防止空间初始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:12:54.653

空格不为空，您应该尝试*$.trim()*函数，trim 将删除所有空格并只给出没有任何尾随空格的字符串

```
 $('#searchInput').keypress(function() 
 {
   if ($.trim($(this).val()) == '')
   {
     $('#button').attr('disabled', true);
   }
   else
   {
     $('#button').removeAttr('disabled');
   }
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T01:40:41.523

Just a bit minified and use `$.trim` to prevent *`enabling`* by whitespace:

```
$('#searchInput').keyup(function () {
       $('#button').prop('disabled', !$.trim(this.value));
}).keyup(); 
```

[Demo](http://fiddle.jshell.net/tS4zF/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:15:28.567

奇怪的是，您遇到了一些奇怪的浏览器行为。在 IE 和 Webkit 浏览器中，`backspace`不会触发`keypress`事件，因此永远不会执行处理程序。

然而，在 Firefox 中，该函数在元素的 更改*之前运行。*`value`因此，当您键入 时`space`，该函数将运行并且`value`仍然为空。因此该按钮被禁用。然后按`backspace`，运行的函数`value`仍然是一个单字符的字符串，其中有一个空格。所以按钮是启用的。

您需要使用它，因为它在按下`keyup`时在所有浏览器中运行，并且在更改*后运行。*`backspace`*`value`*

 *```
$(document).ready(function () {
    $('#searchInput').keyup(function () {
        if (this.value == '') {
            $('#button').prop('disabled', true);
        } else {
            $('#button').prop('disabled', false);
        }
    }).keyup(); 
}); 
```

[工作示例](http://jsfiddle.net/Ecad5/1/)

我所做的更改：

*   更改`keypress`为`keyup`
*   `this.value`而不是`$(this).val()`：快得多
*   `prop('disabled', true)`而不是`attr('disabled', true)`：这是使用的正确功能，并且避免做奇怪的事情`removeAttr`
*   添加`keyup()`到末尾，因此该功能也在页面首次加载时运行*

# linux - 'echo 'a\\b' 有什么问题？grep "\\"'

> ID：14798018
> 
> 赞同：0
> 
> 时间：2013-02-10T13:04:53.830
> 
> 标签：linux, bash, grep

当我运行这个

```
echo 'a\\b' | grep '\\' 
```

它正确识别反斜杠

但是当我使用双引号时

```
echo 'a\\b' | grep "\\" 
```

它没有运行并且它正在返回一个尾随的反冲错误，我无法弄清楚为什么会发生这种情况。它应该与单引号完全相似，因为我已经避开了反斜杠。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:10:41.720

当使用双引号时，`\\`被评估为`\`. 单引号保持原样。做一个`echo "\\"`看看我的意思。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T13:22:01.197

有多个地方可以处理反斜杠转义：

*   在您的外壳中：当您使用双引号而不是单引号时会发生这种情况。请注意，这是一个非常有限的处理，并且`"\n"`无法进行转义。这意味着当您执行时`echo "a\\b"`echo 将`a\b`作为第一个参数，而当您执行时`echo 'a\\b'`echo 将`a\\b`作为第一个参数。
*   在您调用的程序中：`grep`将输入解析为具有自己的转义集的 POSIX 正则表达式。`echo`默认情况下可能会或可能不会处理转义码。默认情况下，我`/bin/echo`不会处理转义码，我的`bash`bulitin`echo`也不会，但我的`zsh`内置`echo`会。如果需要某种行为，可以通过`-e`启用转义或`-E`禁用转义来指定。

因此，如果您调用`grep "\\"`shell 将处理`\\`转义序列并传递`\`给 grep，它将尝试将其解析为正则表达式，并且 correclty 抱怨尾随反斜杠。

因此，当您使用双引号时，您必须对所有内容进行双重转义，从而导致相当笨拙的`echo 'a\\b' | grep "\\\\"`.

要获得最少的转义，您可以使用`echo 'a\\b' | grep '\\'`or `echo 'a\\b' | grep -F '\'`，其中`-F`标志告诉 grep 将模式解释为逐字字符串而不是正则表达式。如果您碰巧有一个`echo`进程默认转义（这将导致`echo 'a\\b'`打印`a\b`），您还需要添加`-E`到`echo`命令中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T13:12:27.587

grep 做了一些基本的正则表达式匹配。

当使用双引号时，shell 会解析`\\`，因此`\\`将解析为单个反斜杠作为参数。

此外，grep 会进行一些基本的正则表达式匹配，因此要匹配单个反斜杠，您需要将两个反斜杠传递给 grep。

因此，通过调用`grep "\\"`您实际上 get `grep \`，它不会解析为正则表达式，因此会使 grep 失败。

要仅正确匹配双反斜杠，请执行`grep -F '\\'`（这意味着固定字符串匹配而不是正则表达式），`grep '\\\\'`或`grep "\\\\\\\\"`.

# osgi - Brindy Vaadin OSGi/Guessit -Felix 有效，Equinox 无效

> ID：14798019
> 
> 赞同：2
> 
> 时间：2013-02-10T13:05:01.363
> 
> 标签：osgi, vaadin, bndtools

使用 bndtools 2.0 并根据[最新的 Brindy Github 版本](https://github.com/brindy/VaadinOSGi)创建项目，当我创建基于 felix http jetty 和 felix scr 的依赖项的 run bnd 时，Vaadin 启动并且一切正常。

但是，如果我尝试使用 org.eclipse.equinox.http.jetty 等运行，servlet 似乎没有注册并且 vaadin 无法启动。

调试代码时，所有 ds 组件工厂位都可以正常工作，但 servlet 无法识别别名。

在尝试为 vaadin 7 更改它之前，我试图让它运行。

问题可能出在哪里的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:45:04.190

它现在正在工作..我没有输入 org.eclipse.equinox.cm 作为依赖项。

使用这些包提供了工作结果，只有一个问题。

org.apache.felix.webconsole 导致错误

2013-02-12 12:20:14.441:WARN:/:ERROR: org.apache.felix.webconsole.internal.servlet.OsgiManager: 无法实例化插件 org.apache.felix.webconsole.internal.deppack.DepPackServlet

引起：java.lang.ClassNotFoundException：org.osgi.service.deploymentadmin.DeploymentException

```
id  State       Bundle
0   ACTIVE      org.eclipse.osgi_3.7.2.v20120110-1415
1   ACTIVE      com.vaadin_6.8.0
2   ACTIVE      javax.servlet_3.0.0.v201112011016
3   ACTIVE      org.eclipse.equinox.cm_1.0.400.v20120522-1841
4   ACTIVE      org.eclipse.equinox.ds_1.4.0.v20120522-1841
5   ACTIVE      org.eclipse.equinox.http.jetty_3.0.0.v20120522-1841
6   ACTIVE      org.eclipse.equinox.http.servlet_1.1.300.v20120522-1841
7   ACTIVE      org.eclipse.equinox.util_1.0.300.v20110502
8   ACTIVE      org.eclipse.jetty.continuation_8.1.3.v20120522
9   ACTIVE      org.eclipse.jetty.http_8.1.3.v20120522
10  ACTIVE      org.eclipse.jetty.io_8.1.3.v20120522
11  ACTIVE      org.eclipse.jetty.security_8.1.3.v20120522
12  ACTIVE      org.eclipse.jetty.server_8.1.3.v20120522
13  ACTIVE      org.eclipse.jetty.servlet_8.1.3.v20120522
14  ACTIVE      org.eclipse.jetty.util_8.1.3.v20120522
15  ACTIVE      org.eclipse.osgi.services_3.3.100.v20120522-1822
16  ACTIVE      org.vaadin.osgi_0.0.0
17  ACTIVE      org.vaadin.osgi.staticres_0.0.0
18  ACTIVE      org.vaadin.guessit_0.0.0
19  ACTIVE      org.vaadin.guessit-support_0.0.0
20  ACTIVE      org.apache.felix.webconsole_3.1.8 
```

# api - 文件上传rest api.....？

> ID：14798020
> 
> 赞同：0
> 
> 时间：2013-02-10T13:05:13.160
> 
> 标签：api, rest, file-upload, salesforce, sendgrid

我正在使用它在salesforce中使用sendgrid api发送带有附件的邮件...我收到错误响应作为错误请求和状态代码：400

有人帮我弄清楚..???

```
String Boundary = '----------------------------400f182a9360';       
String requestBody;
requestBody ='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="api_user"'+'\r\n\r\n'+'youremail'+'\r\n\r\n' ;
requestBody +='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="api_key"'+'\r\n\r\n'+'yourpassword'+'\r\n\r\n' ;
requestBody +='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="to"'+'\r\n\r\n'+'xxx@gmail.com'+'\r\n\r\n' ;
requestBody +='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="subject"'+'\r\n\r\n'+'test'+'\r\n\r\n' ;
//requestBody +='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="html"'+'\r\n\r\n'+'<b>hi</b>'+'\r\n\r\n' ;
requestBody +='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="text"'+'\r\n\r\n'+'mail'+'\r\n\r\n' ;
requestBody +='--' + Boundary +'\r\n\r\n'+'Content-Disposition: form-data; name="from"'+'\r\n\r\n'+'yyy@gmail.com'+'\r\n\r\n' ;
requestBody +=  '--' + Boundary + '\r\n\r\n'+'Content-Disposition: form-data; name="files['+mails.filename+']";filename="'+mails.filename+ '"\r\n\r\n'+ 'Content-Type:'+mails.conType+'\r\n\r\n'+Encodingutil.base64Encode(mails.bl)+'\r\n\r\n';
requestBody+=   '--' + Boundary + '--\r\n';

String url= 'https://sendgrid.com/api/mail.send.json';  

Http h = new Http();         
HttpRequest req = new HttpRequest();       
// req.setTimeout(60000);          
req.setEndpoint(url); 
req.setMethod('GET');        
req.setHeader('Content-Type', 'multipart/form-data; boundary=' +Boundary);                  
req.setHeader('Content-Length',String.valueof(requestBody.length()));      
 system.debug('=====length======'+String.valueof(requestBody.length()));
//req.setHeader('Authorization','Bearer '+ssId); 
req.setBody(requestBody);   
HttpResponse res;              
String resURL;            
res = h.send(req);
 response=res.getbody();
System.debug('++++++++++++++'+requestBody);
System.debug('++++++++++++++'+url);
system.debug('=====response is======'+response);
if(response.contains('success'))
{
    response='{"message":"success"}';
}
else
{
    response='error: '+res.getbody();
} 
```

**这个的输出是**

```
------------------------------400f182a9360

Content-Disposition: form-data; name="api_user"

sendgridusername

------------------------------400f182a9360

Content-Disposition: form-data; name="api_key"

sendgridpassword

------------------------------400f182a9360

Content-Disposition: form-data; name="to"

xxx@gmail.com

------------------------------400f182a9360

Content-Disposition: form-data; name="subject"

test

------------------------------400f182a9360

Content-Disposition: form-data; name="text"

mail

------------------------------400f182a9360

Content-Disposition: form-data; name="from"

yyy@gmail.com

------------------------------400f182a9360

Content-Disposition: form-data; name="files[New Text Document.txt]";filename="New Text Document.txt"

Content-Type:text/plain

YW5pbWVzaCBzZGYgc2RmIHMgZiBzIGRmIHNk

------------------------------400f182a9360-- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T16:49:43.600

您的代码中有很多内容对我来说没有意义，尤其是当您对 base64 编码数据进行特殊处理时（如果它以`=`. 我不确定你为什么需要它。页眉和页脚在正文中显示为纯文本，无需任何额外处理。

一种猜测是您需要使用`bodyBlob.toString()`而不是仅`bodyBlob`在建立身体时使用（调用该变量`url`会令人困惑）。

这个[StackOverflow 问题](https://stackoverflow.com/q/913626/266392)有一个很好的例子，说明如果您发布二进制数据，正文应该是什么样子。我有一种感觉，你没有正确地建立你的。

这是另一个关于[已发布数据的主体外观](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2)的好资源。你似乎没有用这种格式构建东西。

# django - Django 错误（13，“权限被拒绝”）

> ID：14798021
> 
> 赞同：6
> 
> 时间：2013-02-10T13:05:24.260
> 
> 标签：django, windows, permissions

我一直在[http://lightbird.net/dbe/photo.html](http://lightbird.net/dbe/photo.html)上开发这个照片管理器和共享应用程序第一部分。我正在尝试生成缩略图，当我这样做时。我得到这个错误。

我有 Windows Vista。

```
 IOError at /admin/photo/image/add/
  (13, 'Permission denied')
  Request Method:   POST
  Request URL:  http://127.0.0.1:8000/admin/photo/image/add/
  Django Version:   1.4.3
  Exception Type:   IOError
  Exception Value:  (13, 'Permission denied')

  Exception Location:C:\Python26\lib\site-packages\PIL\Image.py in save, line 1399
  Python Executable:C:\Python26\python.exe
  Python Version:   2.6.0
  Python Path:  

  ['C:\\djcode\\mysite',
  'C:\\Python26\\python26.zip',
  'C:\\Python26\\DLLs',
  'C:\\Python26\\lib',
  'C:\\Python26\\lib\\plat-win',
  'C:\\Python26\\lib\\lib-tk',
  'C:\\Python26',
  'C:\\Python26\\lib\\site-packages',
  'C:\\Python26\\lib\\site-packages\\PIL']

  Server time: Sun, 10 Feb 2013 23:49:34 +1100 
```

我`models.py`的是

```
from django.db import models
from django.contrib.auth.models import User
from django.contrib import admin
from string import join
from django.core.files import File
from os.path import join as pjoin
from tempfile import *

import os
from PIL import Image as PImage
from mysite.settings import MEDIA_ROOT

class Album(models.Model):
    title = models.CharField(max_length=60)
    public = models.BooleanField(default=False)
    def __unicode__(self):
        return self.title

class Tag(models.Model):
    tag = models.CharField(max_length=50)
    def __unicode__(self):
        return self.tag

class Image(models.Model):
    title = models.CharField(max_length=60, blank=True, null=True)
    image = models.FileField(upload_to="images/")
    tags = models.ManyToManyField(Tag, blank=True)
    albums = models.ManyToManyField(Album, blank=True)
    created = models.DateTimeField(auto_now_add=True)
    rating = models.IntegerField(default=50)
    width = models.IntegerField(blank=True, null=True)
    height = models.IntegerField(blank=True, null=True)
    user = models.ForeignKey(User, null=True, blank=True)
    thumbnail2 = models.ImageField(upload_to="images/", blank=True, null=True)

    def __unicode__(self):
        return self.image.name
    def save(self, *args, **kwargs):
        """Save image dimensions."""
        super(Image, self).save(*args, **kwargs)
        im = PImage.open(pjoin(MEDIA_ROOT, self.image.name))
        self.width, self.height = im.size

        # large thumbnail
        fn, ext = os.path.splitext(self.image.name)
        im.thumbnail((128,128), PImage.ANTIALIAS)
        thumb_fn = fn + "-thumb2" + ext
        tf2 = NamedTemporaryFile()
        im.save(tf2.name, "JPEG")
        self.thumbnail2.save(thumb_fn, File(open(tf2.name)), save=False)
        tf2.close()

        # small thumbnail
        im.thumbnail((40,40), PImage.ANTIALIAS)
        thumb_fn = fn + "-thumb" + ext
        tf = NamedTemporaryFile()
        im.save(tf.name, "JPEG")
        self.thumbnail.save(thumb_fn, File(open(tf.name)), save=False)
        tf.close()

        super(Image, self).save(*args, ** kwargs)

    def size(self):
        """Image size."""
        return "%s x %s" % (self.width, self.height)

    def __unicode__(self):
        return self.image.name

    def tags_(self):
        lst = [x[1] for x in self.tags.values_list()]
        return str(join(lst, ', '))

    def albums_(self):
        lst = [x[1] for x in self.albums.values_list()]
        return str(join(lst, ', '))

    def thumbnail(self):
        return """<a href="/media/%s"><img border="0" alt="" src="/media/%s" height="40" /></a>""" % (
                                                                (self.image.name, self.image.name))
    thumbnail.allow_tags = True
class AlbumAdmin(admin.ModelAdmin):
    search_fields = ["title"]
    list_display = ["title"]

class TagAdmin(admin.ModelAdmin):
    list_display = ["tag"]

class ImageAdmin(admin.ModelAdmin):
    search_fields = ["title"]
    list_display = ["__unicode__", "title", "user", "rating", "size", "tags_", "albums_","thumbnail", "created"]
    list_filter = ["tags", "albums"]
def save_model(self, request, obj, form, change):
    obj.user = request.user
    obj.save() 
```

问题在这里：

```
from django.core.files import File
from os.path import join as pjoin
from tempfile import *

class Image(models.Model):
    # ...

    thumbnail2 = models.ImageField(upload_to="images/", blank=True, null=True)

def save(self, *args, **kwargs):
    """Save image dimensions."""
    super(Image, self).save(*args, **kwargs)
    im = PImage.open(pjoin(MEDIA_ROOT, self.image.name))
    self.width, self.height = im.size

    # large thumbnail
    fn, ext = os.path.splitext(self.image.name)
    im.thumbnail((128,128), PImage.ANTIALIAS)
    thumb_fn = fn + "-thumb2" + ext
    tf2 = NamedTemporaryFile()
    im.save(tf2.name, "JPEG")
    self.thumbnail2.save(thumb_fn, File(open(tf2.name)), save=False)
    tf2.close()

    # small thumbnail
    im.thumbnail((40,40), PImage.ANTIALIAS)
    thumb_fn = fn + "-thumb" + ext
    tf = NamedTemporaryFile()
    im.save(tf.name, "JPEG")
    self.thumbnail.save(thumb_fn, File(open(tf.name)), save=False)
    tf.close()

    super(Image, self).save(*args, ** kwargs) 
```

如何修复此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:41:29.127

在我看来，django 没有访问您的`MEDIA_ROOT`文件夹所需的权限。

查看`MEDIA_ROOT`settings.py 文件中的设置。然后检查文件夹的权限（类似于`ls -lsa /path/to/media_root`bash shell）。确保运行 django 的用户对该文件夹具有写权限。

此外，正如 asermax 指出的那样，请确保您已在 MEDIA_ROOT 中创建了一个图像目录。

查看[提供静态文件](https://docs.djangoproject.com/en/1.4/howto/static-files/)的文档，特别是有关[提供其他目录的部分](https://docs.djangoproject.com/en/1.4/howto/static-files/#serving-other-directories)

更新

也许是[这个问题](https://stackoverflow.com/questions/4125859/how-do-you-fix-the-following-django-error-type-ioerror-value-errno-13-pe)。尝试替换`im.save(tf2.name, "JPEG")`为`im.save(tf2, "JPEG")`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-11T17:58:42.753

设置 SELinux 权限 [http://wiki.apache.org/httpd/13PermissionDenied](http://wiki.apache.org/httpd/13PermissionDenied) 看看这个，它可能有解决方案

# ruby-on-rails - Sinatra 中的资源生成器

> ID：14798026
> 
> 赞同：0
> 
> 时间：2013-02-10T13:05:51.850
> 
> 标签：ruby-on-rails, sinatra, generator

我在 Rails 中开发了几个应用程序，我需要开发一个 API。我收到了在 Sinatra 中构建它的建议，所以我开始研究它。

看起来很不错，但是在 Rails 中自动化的很多东西似乎在 Sinatra 中并不存在。具体来说，我似乎必须从头开始编写我的资源。例如。模型本身、迁移和 REST 路由。

我想知道是否有像 Rails 提供的那样的 Sinatra 生成器？或者如果我希望这些事情自动化，我应该简单地使用 Rails 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:28:32.757

我个人不使用 Sinatra，但我从其他 Rails 开发人员那里得到的很多反馈是，他们最终会切换回 Rails。我确信在 Rails 上使用 Sinatra 有很好的理由，但如果您已经了解 Rails，并且没有速度或应用程序大小限制，我会坚持下去。

Sinatra 的另一个替代方案是[Rails API](https://github.com/rails-api/rails-api)项目，它不包含 Rails 框架的任何与视图相关的部分。我过去使用过它并且喜欢它，但它比仅使用 Rails 更好吗？很难说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T15:47:23.910

如果你必须有 Sinatra，你应该去看看[Padrino 。](http://www.padrinorb.com/)

> Padrino 是一个基于 Sinatra 网络库的 ruby​​ 框架。Sinatra 是一种 DSL，用于在 Ruby 中创建简单的 Web 应用程序。Padrino 的创建是为了让编写更高级的 Web 应用程序变得有趣和容易，同时仍然坚持使 Sinatra 变得伟大的精神！

或者正如 Beerlington 所提到的，如果您对 Rails 感觉更熟悉，您可以使用[Rails API 。](https://github.com/rails-api/rails-api)我们最近一直在使用它并取得了很好的成功。我们创建了一个带有 mongo 后端的简单 API。启动非常快:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-11T01:27:13.163

查看可用于处理 RESTful 路由的[`sinatra-rest`gem 。](http://blindgaenger.github.com/sinatra-rest/)为方便起见，引用如下：

* * *

[sinatra-rest 是] 一组将 RESTful 路由引入 Sinatra 的模板。您唯一要做的就是提供意见。自动适用于基于 ActiveRecord、DataMapper 或 Stone 的模型。

例如，如果您的模型类名为 Person，您只需添加以下行：

```
rest Person 
```

这会将以下 RESTful 路由添加到您的应用程序。（注意路线的复数形式`Person`。`/people/*`）

```
Verb    Route            Controller   View
GET     /people          index        /people/index.haml
GET     /people/new      new          /people/new.haml
POST    /people          create       → redirect to show
GET     /people/1        show         /people/show.haml
GET     /people/1/edit   edit         /people/edit.haml
PUT     /people/1        update       → redirect to show
DELETE  /people/1        destroy      → redirect to index 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T01:15:49.563

> Or should I simply use Rails if I want these kind of things automated?

If you're that used to Rails that using Ruby is a problem, then maybe. Alternatively, you could try this API generator that uses Sinatra:

[https://github.com/mattetti/Weasel-Diesel](https://github.com/mattetti/Weasel-Diesel)

# javascript - 排序后隐藏div

> ID：14798027
> 
> 赞同：2
> 
> 时间：2013-02-10T13:06:05.000
> 
> 标签：javascript, jquery, google-maps, show-hide

我有带有属性图钉的谷歌地图，下面有一个搜索框。用户单击“排序”后，将根据用户的标准显示图钉。我正在寻找一种解决方案，可以让我隐藏搜索框，只留下“显示搜索”框，而不是“排序”框。

这是它目前的样子：http: [//i.imgur.com/S1q1xNH.jpg](https://i.imgur.com/S1q1xNH.jpg)

这是搜索框代码的一部分：

```
<div class="main-search">           
    <form id="main-search" method="post" action="#">
        <!-- search box fields here -->
        <input type="submit" value="Sort" class="search-submit" id="search-submit" />          
    </form>     
</div> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:37:58.750

一个简单的演示位于[http://jsfiddle.net/xekR9/1/](http://jsfiddle.net/xekR9/1/)。

不要忘记更改`return false`为`return true`允许[PHP](http://en.wikipedia.org/wiki/PHP)发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:15:55.683

我不确定您离开节目搜索的意思，但要隐藏按钮，请执行以下操作：

```
$('.search-submit').on('click',function(){
    $(this).hide();
}); 
```

# google-app-engine - 暂时禁用我的 Google App Engine 应用以执行架构迁移的推荐方法是什么？

> ID：14798032
> 
> 赞同：6
> 
> 时间：2013-02-10T13:06:37.573
> 
> 标签：google-app-engine, schema-migration

我想禁用用户对我的应用程序的访问，以便我可以执行架构迁移。我研究了一些可能性并发现了可能的缺点：

1.  禁用数据存储写入 - 我宁愿关闭我的整个应用程序，这样人们就不会看到任何错误等。此外，我认为禁用写入会阻止我执行迁移。

2.  禁用应用程序 - 我不清楚这是否只会对我的用户禁用它，从而使我无法执行迁移。我也不确定禁用/启用周转时间。

3.  将我的域名重定向到一个临时页面 - 我的应用仍然可以在 appspot.com 上访问

4.  上传我的应用程序的新版本，除了指向“暂时关闭”页面之外，它不响应请求。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T16:14:07.863

建议 4 似乎可能是最好的方法。一些框架有一个“维护模式”，在这种模式下，所有传入的请求都将被重定向到一个页面，该页面指示该站点由于维护而关闭。如果您的框架不支持这种模式，您只需上传应用程序的新版本（可能称为 version `maintenance`）并将其切换为新的默认版本。此版本可能是一个空应用程序，其中所有传入请求都转到“维护页面”，指示该站点已关闭以进行维护。然后使用迁移代码手动转到您的应用程序版本并执行它 ( `http://<version>.<appname>.appspot.com`)。完成迁移后，将您的应用默认版本切换到具有新架构的新版本。

解释你的其他想法

1.  禁用写入甚至会阻止您在应用程序上进行写入。我相信这更意味着从一个应用程序迁移到另一个或其他“冻结”数据存储的应用程序。
2.  禁用应用程序会使应用程序完全关闭
3.  重定向您的域会给您的迁移造成 DNS 延迟，这可能需要 48 小时才能完全传播（切换到临时页面，然后切换回新版本）
4.  如前所述，恕我直言，这将是最好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T14:10:59.693

是否不能同时使用两种模式，并使用新版本的应用程序进行迁移，它只使用新模式。通过这种方式，您始终可以退回到旧版本。

顺便一提。因为数据存储是无模式的，所以我总是可以更改“模式”，而不会关闭应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-08T17:35:57.860

转到 GCP > 应用引擎 > 设置 > 禁用应用程序。

您可以随时启用您的应用程序。

如果您禁用此应用程序，将会发生一些事情：

1.  该应用程序将停止服务

2.  所有数据和状态将被保存

3.  适用时仍会产生帐单费用

4.  您的任务队列将继续运行。它们可以在 Cloud Tasks UI 中暂停

# wpf - 如何使用 VB.NET 在 WPF 应用程序中设置左边距？

> ID：14798036
> 
> 赞同：0
> 
> 时间：2013-02-10T13:06:49.583
> 
> 标签：wpf, vb.net

如何将 WPF 应用程序中的左边距设置为 213 像素？

我努力了：

```
MyRecatgle.Margin.left = 213 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T13:10:26.750

利用

```
MyRecatgle.Margin = New Thickness(213, 0, 0, 0) 
```

厚度的构造函数参数是：

```
Thickness(left, top, right, bottom) 
```

# text - 文本/字体是否可以与输入字段重叠？

> ID：14798037
> 
> 赞同：2
> 
> 时间：2013-02-10T13:06:55.643
> 
> 标签：text, z-index, overlap, input-field

我想知道是否可以使输入字段内的字体/文本与输入字段本身重叠。我想知道这是否可行，而无需执行诸如创建两个输入字段之类的操作，其中一个与另一个重叠，一个具有隐藏字段框。

例如，假设您有一个看起来像手写的字体，并且您希望小写字母的下降（例如“p”“y”“g”的底部）挂在字段框下方而不是被它截断- 类似于在横格纸上书写时笔迹延伸到基线以下的方式。

我已经进行了广泛的搜索，但运气不佳，所以即使有人知道比“文本重叠输入框”和类似的字符串更好的搜索词，这本身也会有很大的帮助。

问题是，我不知道只关注输入框内文本的 CSS 选择器，或者我会尝试增加文本的 z-index 以便它位于框上方的图层上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:11:20.703

您是否尝试在输入元素上设置背景图像？您的背景图像可能是线条。

IE

```
input {
    background: url(path/to/image.png) repeat-x;
} 
```

**编辑：**

我对此进行了快速尝试，并在这里启动并运行了一些东西：http: [//jsfiddle.net/qUc9Y/](http://jsfiddle.net/qUc9Y/)

我已将输入包装在另一个元素 (fieldset.input-wrapper) 中，并将您的 CSS 转换移动到这个新元素。我已经将输入向下推了 10 像素，因此它悬垂在容器创建的阴影上。我已将输入的背景设置为透明，因此 .input-wrapper 上的框阴影可以通过它看到。

最后，我添加了一些快速的 jQuery，以便当输入悬停时，css 转换将应用于新的 .input-wrapper 容器（即输入的父容器）。您应该能够对焦点/模糊执行相同的操作。

我希望这有帮助。

**编辑2：**

焦点状态现在也应该可以工作了，请参阅[http://jsfiddle.net/yZ3uw/14/](http://jsfiddle.net/yZ3uw/14/)。

# rdf - 地址本体

> ID：14798040
> 
> 赞同：5
> 
> 时间：2013-02-10T13:07:26.840
> 
> 标签：rdf, ontology, street-address

我需要为调度创建一个本体。我使用 FOAF 和 Time OWL 来存储参与者和时间，但我还需要存储约会地点：地址。像 GeoNames 和 WGS84 地理定位这样的本体不适合我的目的——我不能在那里存储街道。

我可以自己创建它，但如果有一个已建立的地址本体，那么我会使用它。我考虑过使用 vCard Ontology，但它是为不同目的而设计的。你觉得，这是个好主意吗？你知道其他一些本体吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-11T14:40:35.243

I do not think the fact that vcard was meant for a different purpose should be a problem, if the address options in vcard suit your needs.
there are some other vocabularies that cover physical addresses. note however that - internationally - physical addresses are very difficult to standardize (see some information [here](http://answers.semanticweb.com/questions/3200/ontology-for-all-global-postal-address))

I would propose to look into [LODE](http://linkedevents.org/ontology/)
and into the [future](http://www.w3.org/ns/locn#) w3c location core vocabulary, you will find the current version (proposal) [here](https://joinup.ec.europa.eu/asset/core_location/asset_release/core-location-vocabulary-100).

Furthermore, I think asking on [http://answers.semanticweb.com](http://answers.semanticweb.com) could give you more answers.

# playframework-2.0 - 如何使用 Play 2.0 将 HTML 电子邮件重定向到客户端浏览器

> ID：14798041
> 
> 赞同：0
> 
> 时间：2013-02-10T13:07:32.800
> 
> 标签：playframework-2.0

当注册过程完成时，我会从我的 Play 应用程序中发送欢迎电子邮件……并且我想提供在客户端的 Web 浏览器中查看其内容的能力。我试过这样的东西......

```
@(title: String)(content: Html)

...

<html>
    <head>
        <title>@title</title>

        ...

    </head>

    ...

    <p>Trouble viewing this email? <a href="@views.html.emails.email(title)(content)">View in Browser</p>

    ...

    <body>
        @content
    </body>
</html> 
```

...但是这段代码总是以 [StackOverflowError: null] 结尾：

```
In /home/j3d/Projects/test/app/views/mails/email.scala.html at line 8.

 5 <html>
 6 <head>
 7    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 8    <title>@title</title>
 9    <style type="text/css">
10        a { color: #4A72AF; }
11        body, #header h1, #header h2, p { margin: 0; padding: 0; }
12        #main { border: 1px solid #cfcece; } 
```

任何帮助将不胜感激:-) 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:24:07.380

显然你`@title`是空的，确保在控制器中它的字符串有值或在视图中为它设置一些默认值：

```
@(title: String="Email was sent, check your mailbox")(content: Html) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T19:45:59.733

我认为您将电子邮件模板包含在 中`a href=""`，而不是将链接放入此页面。

您显示`views.html.emails.email`视图，其中包括`views.html.emails.email`视图，其中包括`views.html.emails.email`视图...您已经了解；）

`a`解决方案是在您的标签中放置一个真实的链接（而不是内容） 。类似的东西（我不知道你的控制器/路由）：

```
<a href="@routes.Emails.showEmailAction(....)"> 
```

# graphics - R将热图简化为pdf

> ID：14798043
> 
> 赞同：6
> 
> 时间：2013-02-10T12:54:12.280
> 
> 标签：graphics, svg, inkscape, r

我想绘制一个简化的热图，使用我正在使用的标量矢量图形程序（inkscape）进行编辑并不难。下面生成的原始热图包含许多矩形，我想知道它们是否可以在不同的扇区中合并在一起以简化输出 pdf 文件：

```
nentries=100000
ci=rainbow(nentries)
set.seed=1
mean=10
## Generate some data (4 factors)
i = data.frame(
  a=round(abs(rnorm(nentries,mean-2))),
  b=round(abs(rnorm(nentries,mean-1))),
  c=round(abs(rnorm(nentries,mean+1))),
  d=round(abs(rnorm(nentries,mean+2)))
  )
minvalue = 10
# Discretise values to 1 or 0
m0 = matrix(as.numeric(i>minvalue),nrow=nrow(i))
# Remove rows with all zeros
m = m0[rowSums(m0)>0,]
# Reorder with 1,1,1,1 on top
ms =m[order(as.vector(m %*% matrix(2^((ncol(m)-1):0),ncol=1)), decreasing=TRUE),]
rowci = rainbow(nrow(ms))
colci = rainbow(ncol(ms))

colnames(ms)=LETTERS[1:4]
limits=c(which(!duplicated(ms)),nrow(ms))
l=length(limits)
toname=round((limits[-l]+ limits[-1])/2)
freq=(limits[-1]-limits[-l])/nrow(ms)

rn=rep("", nrow(ms))
for(i in toname) rn[i]=paste(colnames(ms)[which(ms[i,]==1)],collapse="")
rn[toname]=paste(rn[toname], ": ", sprintf( "%.5f", freq ), "%")

heatmap(ms,
        Rowv=NA,
        labRow=rn,
        keep.dendro = FALSE,
        col=c("black","red"),
        RowSideColors=rowci,
        ColSideColors=colci,
        )

dev.copy2pdf(file="/tmp/file.pdf") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T16:52:56.030

我使用这个`Cairo`包来制作 svg。这非常容易。这是一个比您的示例中的更简单的图：

```
require(Cairo)
CairoSVG(file = "tmp.svg", width = 6, height = 6)
plot(1:10)
dev.off() 
```

在 Inkscape 中打开后，您可以取消组合元素并根据需要进行编辑。

### 示例（移动点，添加漩涡）：

![在此处输入图像描述](../Images/b58ea7efaacd577825bbc7feb0ec619f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T11:44:01.907

为什么不试试 RSvgDevice？使用它，您可以将图像保存为 svg 文件，这对于 Inkscape 来说比 pdf 方便得多

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T05:00:19.000

我认为我们（互联网）在这方面不够清楚。

让我从一个成功的导出示例开始

```
png("heatmap.png") #Ruby dev's think of this as kind of like opening a `File.open("asdfsd") do |f|` block
heatmap(sample_matrix, Rowv=NA, Colv=NA, col=terrain.colors(256), scale="column", margins=c(5,10))
dev.off() 
```

在我看来，这`dev.off()`让我想起了对`end`ruby​​ 块或方法的调用，因为“嵌套”或封闭（在`png()`and之间`dev.off()`）代码输出的最后一行是转储到 png 文件中的内容。

例如，如果您运行以下代码：

```
png("heatmap4.png")
heatmap(sample_matrix, Rowv=NA, Colv=NA, col=terrain.colors(32), scale="column", margins=c(5,15))
heatmap(sample_matrix, Rowv=NA, Colv=NA, col=greenred(32), scale="column", margins=c(5,15))
dev.off() 
```

它会将第二个（绿红色配色方案，我刚刚测试过）热图输出到 heatmap4.png 文件，就像 ruby​​ 方法默认返回其最后一行一样

# javascript - 字符串中出现的每个字符

> ID：14798049
> 
> 赞同：0
> 
> 时间：2013-02-10T13:08:34.857
> 
> 标签：javascript

如何编写一个 javascript 代码来计算字符串中每个字符的出现次数？

```
e.g 
String is : Hello World 

Output :  
count of H -> 1
count of e -> 1
count of l -> 3
count of o -> 2 
count of r -> 1
count of d -> 1 
count of W -> 1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T13:15:20.457

```
var counts = {};
yourstring.split('').map(function(ch) {
  counts[ch] = (counts[ch] || 0) + 1;
}); 
```

或者是时髦并使用 map/reduce：

```
var counts = yourstring.split('').reduce(function(dst, c) {
  dst[c] = (dst[c] || 0) + 1;
  return dst;
}, {}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T13:15:04.540

这段代码应该可以工作：

```
var str = "Hello World";
var arr = str.split('');
var occ = {};
for(var i=0,c=arr.length;i<c;i++){
    if(occ[arr[i]]) occ[arr[i]]++;
    else occ[arr[i]] = 1;
}
for(var i in occ){
    alert('count of '+i+' -> '+occ[i]); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:15:28.837

```
var splitWord = "Hello World".split('');
var letters = {};
for(var i in splitWord)
{
    var letter = splitWord[i];
    if(letter == ' ') continue;
    if(typeof letters[letter] == 'undefined')
    {
        letters[letter] = 0;
    }
    letters[letter]++;
}
console.dir(letters); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-08T16:27:33.810

下面是我使用旧的简单 for 循环的解决方案。这种方法以最简单的方式回答了初学者的问题。此代码会将输入中的所有字母转换为小写并计算它们的出现次数。在这个解决方案中，我们还将特殊字符和空格算作有效字符。

```
 function countChar(str) {
            var count = {};
            for (let i = 0; i < str.length; i++) {
                var ch = str[i].toLowerCase();
                if (count[ch] > 0) {
                    count[ch]++;
                } else {
                    count[ch] = 1;
                }
            }
            return count;
        } 
```

count 对象表示输入中的字符。

# javascript - jQuery cookie，当我按 F5 时，我看不到选择的选项

> ID：14798051
> 
> 赞同：0
> 
> 时间：2013-02-10T13:08:50.307
> 
> 标签：javascript, jquery, cookies

我的 cookie 有问题。我正在尝试存储在 cookie 中选择的选项。但我不明白为什么我的例子不起作用。

例如，不记住字体大小。这是我第一次使用[jQuery.cookie](https://github.com/carhartl/jquery-cookie)。

HTML（在第一次选择中，选项内容图像更改背景）：

```
<h3>Seleccione un fondo de imagen</h3>
<select name="foo" id="foo" size="2">
    <option value="1"></option>
    <option value="2"></option>
    <option value="3"></option>
    <option value="4"></option>
    <option value="5"></option>
    <option value="6"></option>
</select>
<input type="button" id="button1" value="Establecer fondo" />

<h3>Seleccione una fuente</h3>
<select name="fuente" id="fuente" size="2" style='-moz-border-radius: 8px;'>
    <option value="1">Arial</option>
    <option value="2">Tahoma</option>
    <option value="3">Verdana</option>
</select>
<input type="button" id="button2" value="Establecer fuente" />

<h3>Seleccione un tama&ntilde;o de fuente</h3>
<select name="fuentesize" id="fuentesize" size="2" style='-moz-border-radius: 8px;'>
    <option value="1">8</option>
    <option value="2">10</option>
    <option value="3">12</option>
    <option value="4">14</option>
</select>
<input type="button" id="button3" value="Establecer tama&ntilde;o de fuente" />

<h3>Seleccione un color de fuente</h3>
<select name="fuentecolor" id="fuentecolor" size="2" style='-moz-border-radius: 8px;'>
    <option value="1">rojo</option>
    <option value="2">azul</option>
    <option value="3">verde</option>
    <option value="4">rosa</option>
</select>
<input type="button" id="button4" value="Establecer color de fuente" />

<h3>Seleccione un estilo para la fuente</h3>
<select name="fuentestilo" id="fuentestilo" size="2" style='-moz-border-radius: 8px;'>
    <option value="1">cursiva</option>
    <option value="2">subrayado</option>
    <option value="3">sin subrayado</option>
</select>
<input type="button" id="button5" value="Establecer estilo de fuente" /> 
```

### JavaScript

```
$(document).ready(function() {
    var value;
    value = $.cookie("cookieFondo");
    if (value) {
        $("#foo").val(value);
    }
    value = $.cookie("cookieFuente");
    if (value) {
        $("#fuente").val(value);
    }
    var value;
    value = $.cookie("cookieFuenteSize");
    if (value) {
        $("#fuentesize").val(value);
    }
    value = $.cookie("cookieFuenteColor");
    if (value) {
        $("#fuentecolor").val(value);
    }
    value = $.cookie("cookieFuentEstilo");
    if (value) {
        $("#fuentestilo").val(value);
    }

    $('#button1').click(function() {
        //alert($('#foo option:selected').text());
        var bg = $('#foo').val();
        if(bg==1){
            $('body').css('background-image', 'url(img/bg00.png)');
            $.cookie("cookieFondo", bg);
        }
        if(bg==2){
            $('body').css('background-image', 'url(img/bg01.png)');
            $.cookie("cookieFondo", bg);
        }
        if(bg==3){
            $('body').css('background-image', 'url(img/bg02.png)');
            $.cookie("cookieFondo", bg);
        }
        if(bg==4){
            $('body').css('background-image', 'url(img/bg03.png)');
            $.cookie("cookieFondo", bg);
        }
        if(bg==5){
            $('body').css('background-image', 'url(img/bg04.png)');
            $.cookie("cookieFondo", bg);
        }
        if(bg==6){
            $('body').css('background-image', 'url(img/bg05.png)');
            $.cookie("cookieFondo", bg);
        }
    });

    $('#button2').click(function() {
        //alert($('#foo option:selected').text());
       var font = $('#fuente').val();
           if(font==1){
            $('body').css('font-family', 'Arial');
            $.cookie("cookieFuente", font);
        }
        if(font==2){
            $('body').css('font-family', 'Tahoma');
            $.cookie("cookieFuente", font);
        }
        if(font==3){
            $('body').css('font-family', 'Verdana');
            $.cookie("cookieFuente", font);
        }
    });

    $('#button3').click(function() {
        //alert($('#foo option:selected').text());
       var fontsize = $('#fuentesize').val();
           if(fontsize==1){
            $('body').css('font-size', 8);
            $.cookie("cookieFuenteSize", fontsize);
        }
        if(fontsize==2){
            $('body').css('font-size', 10);
            $.cookie("cookieFuenteSize", fontsize);
        }
        if(fontsize==3){
            $('body').css('font-size', 12);
            $.cookie("cookieFuenteSize", fontsize);
        }
        if(fontsize==4){
            $('body').css('font-size', 14);
            $.cookie("cookieFuenteSize", fontsize);
        }
    });

    $('#button4').click(function() {
        //alert($('#foo option:selected').text());
       var fontcolor = $('#fuentecolor').val();
           if(fontcolor==1){
            $('body').css('color', 'red');
            $.cookie("cookieFuenteColor", fontcolor);
        }
        if(fontcolor==2){
            $('body').css('color', 'blue');
            $.cookie("cookieFuenteColor", fontcolor);
        }
        if(fontcolor==3){
            $('body').css('color', 'green');
            $.cookie("cookieFuenteColor", fontcolor);
        }
        if(fontcolor==4){
            $('body').css('color', 'pink');
            $.cookie("cookieFuenteColor", fontcolor);
        }
    });

    $('#button5').click(function() {
        //alert($('#foo option:selected').text());
       var fontstyle = $('#fuentestilo').val();
           if(fontstyle==1){
            $('body').css('font-style', 'italic');
            $.cookie("cookieFuentEstilo", fontstyle);
        }
        if(fontstyle==2){
            $('body').css('text-decoration', 'underline');
            $.cookie("cookieFuentEstilo", fontstyle);
        }
        if(fontstyle==3){
            $('body').css('text-decoration' , 'none');
            $.cookie("cookieFuentEstilo", fontstyle);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:59:21.373

You are saving values into cookies, but when the page loads, you are not reading the cookies to initialize the state of your page from the values stored in the cookies.

You need to do something like this:

```
$(document).ready(function() {
    var value;
    value = $.cookie("cookieFondo");
    if (value) {
         $("#foo").val(value);
    }
    value = $.cookie("cookieFuente");
    if (value) {
         $("#fuente").val(value);
    }
    // ... more here
}); 
```

Or a more DRY version using a table would be like this:

```
$(document).ready(function() {
    var value;
    var items = [
        "cookieFondo", "#foo",
        "cookieFuente", "#fuente"
        // list more items here
    ];
    for (var i = 0; i < items.length; i+=2) {
        value = $.cookie(items[i]);
        if (value) {
            $(items[i+1]).val(value);
        }
    }
}); 
```

# c# - Asp.net Mvc3 部分视图

> ID：14798053
> 
> 赞同：0
> 
> 时间：2013-02-10T13:09:13.307
> 
> 标签：c#, asp.net-mvc-3

我想在我的网站中有动态类别，在管理区域添加类别并在主页中显示为部分视图，很明显我应该缓存它，我的类别操作是这样的：

```
 public ActionResult Category()
        {

            var category = _categoryRepository.GetAllCategory();
            return PartialView(category);
        } 
```

我的部分视图是：

```
@model IEnumerable<Blog.Domain.Model.Category>
@{
    ViewBag.Title = "Category";
    Layout = null;
}
<div>
    @foreach (var item in Model)
    {
        <ul>
            @Html.DisplayFor(x => item.Name)
        </ul>
    }
</div> 
```

我不确定上面的代码，也不知道如何缓存 Category ，请有人帮助我，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:41:30.360

不确定你真正想要什么，但看看`OutputCache`- [http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/improving-performance-with-output-caching-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/improving-performance-with-output-caching-cs)

```
[OutputCache(Duration=10, VaryByParam="none")]
public ActionResult Category()
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:50:56.683

不确定这是否回答了您的问题，但只需使用 Html.ActionLink() 为他们分配一个链接，然后执行一个将所选类别 ID 作为参数并加载类别的详细视图的操作。

```
 @model IEnumerable<Blog.Domain.Model.Category>
    @{
        ViewBag.Title = "Category";
        Layout = null;
    }
    <div>
        @foreach (var item in Model)
        {
            <ul>
                @Html.ActionLink(item.Name, "Detail". "Category", new {id = item.id)
            </ul>
        }
    </div>

public ActionResult Details(int id)
        {

            var category = _categoryRepository.GetById(id);
            //detail CategoryView
            return PartialView(category);
        } 
```

# .htaccess - htaccess 仅重写子域

> ID：14798054
> 
> 赞同：0
> 
> 时间：2013-02-10T13:09:19.600
> 
> 标签：.htaccess, rewrite

我正在尝试将一些参数重写为漂亮的链接，但**仅限**于子域/文件夹。不幸的是我无法让它工作，也许也是因为之前还有一些其他的重写......

这是我的代码：

```
<IfModule mod_rewrite.c>
# NON-WWW TO WWW
RewriteEngine On
RewriteCond %{HTTP_HOST} ^example.com
RewriteRule (.*) http://www.example.com/$1 [R=301,L]

# WORDPRESS-BLOG
Options +FollowSymlinks
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]

# REDIRECT FOR SUBDOMAIN
RewriteCond %{HTTP_HOST} ^subdomain.example.com
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/.]+)(?:/)?$ index.php?cshort=$1 [L]
RewriteRule ^([^/.]+)/([^/.]+)(?:/)?$ /index.php?cshort=$1&cid=$2 [L]
RewriteRule ^([^/.]+)/([^/.]+)/([^/.]+)(?:/.*)?$ /index.php?cshort=$1&cid=$2&step=$3 [L]
</IfModule> 
```

基本上只有最后一部分是我想重写的部分，以更改 URL，例如

`http://subdomain.example.com/index.php?cshort=abc&cid=123&step=1`至`http://subdomain.example.com/abc/123/1`

www.example.com 的其他重写规则不应该受到影响。不幸的是，我当前的代码只为博客和 www 做了前两个规则，但子域没有任何反应。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T17:43:04.617

当你说你想从 to 重写时`http://subdomain.example.com/index.php?cshort=abc&cid=123&step=1`，`http://subdomain.example.com/abc/123/1`你的意思是你希望用户输入漂亮的 URL 并让它在后台提供完整的 URL，而不是你想从丑陋的 URL 重定向到漂亮的 URL，对吗？

在你的 RewriteRules 中，你想用“ `(?:/)?`”来完成什么？正如所写，这对我没有任何意义。如果你只是想匹配目录路径是否以斜杠结尾，你可以这样做：

```
RewriteRule ^([^/.]+)/?$ index.php?cshort=$1 [L] 
```

编辑：其他建议：

1.  将“重定向子域”部分移到“Wordpress 博客”部分上方。由于 Wordpress 规则适用于“所有不是真实文件或目录的内容，无论域如何”，因此应该放在最后。

2.  RewriteConds 仅适用于它们之后的单个 RewriteRule。对于您在“重定向子域”下列出的三个规则中的每一个，在按照上述建议更新它们之后，您需要重复 RewriteRule 前面的两个 RewriteCond 行。

# xcode - 如何知道 Cocoa 应用程序何时将退出？

> ID：14798056
> 
> 赞同：4
> 
> 时间：2013-02-10T13:09:37.197
> 
> 标签：xcode, cocoa, nsdocument, nsapplication

我有一个基于 NSDocument 的应用程序。我想知道应用程序何时将退出以验证某些内容。我希望可能有一种方法，例如 applicationWillQuit，但是查看 NSDocument 和 NSApplication 的文档我找不到类似的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T13:46:33.977

There is a notification you can use coming from your NSApplication:

```
NSNotificationCenter* nc = [NSNotificationCenter defaultCenter];
 [nc addObserver:self 
        selector:@selector(appWillTerminate:) 
            name:NSApplicationWillTerminateNotification 
          object:nil]; 
```

This is documented here: [https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/nsapplication_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/nsapplication_Class/Reference/Reference.html)

By passing the object as `nil` your method is being called whenever an object fires the notification.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-11-07T07:50:55.693

我们在**AppDelegate.swift**或**AppDelegate.m**类中有一个委托方法。您可以在关闭它之前使用它并向您的应用程序添加功能。

```
func applicationWillTerminate(_ aNotification: Notification) {
    // Insert code here to tear down your application
} 
```

# python - 在 PyQt 中对单选按钮进行分组

> ID：14798058
> 
> 赞同：5
> 
> 时间：2013-02-10T13:09:45.327
> 
> 标签：python, qt4, pyqt, pyqt4

```
import sys
from PyQt4 import QtCore, QtGui

class Class1(QtGui.QMainWindow):
    def __init__(self):
        super(Class1, self).__init__()
        self.func()

    def func(self):

        r0=QtGui.QRadioButton("0",self)
        r1=QtGui.QRadioButton("1",self)
        ra=QtGui.QRadioButton("a",self)
        rb=QtGui.QRadioButton("b",self)
        r0.move(100,100)
        r1.move(400,100)
        ra.move(100,400)
        rb.move(400,400)
        number_layout=QtGui.QButtonGroup()
        letter_layout=QtGui.QButtonGroup()
        number_layout.addButton(r0)
        number_layout.addButton(r1)
        letter_layout.addButton(ra)
        letter_layout.addButton(rb)
        layout=QtGui.QHBoxLayout(self)
        self.show()

def main():
    app = QtGui.QApplication(sys.argv)
    mw = Class1()
    mw.show()
    sys.exit(app.exec_())

if __name__=='__main__':
    main() 
```

我正在尝试对R0进行R0，RB IE进行分组，当检查R0时，R1应不受控制，对RA或RB状态没有影响。我怎样才能做到这一点？该代码表明了我到目前为止所尝试的内容。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-10T13:27:48.140

A`QMainWindow`已经提供了一个布局，你不能简单地用你自己的替换它。要么从一个 plain 继承`QWidget`，要么创建一个新的小部件并添加布局和按钮。

您的命名也令人困惑，`QButtonGroup`不是布局。它实际上并没有提供任何可见的 UI。如果您需要一个对按钮进行分组的 UI 元素，则应`QGroupBox`改为查看。

这是您上述内容的简单变化：

```
def func(self):
    layout=QtGui.QHBoxLayout()  # layout for the central widget
    widget=QtGui.QWidget(self)  # central widget
    widget.setLayout(layout)

    number_group=QtGui.QButtonGroup(widget) # Number group
    r0=QtGui.QRadioButton("0")
    number_group.addButton(r0)
    r1=QtGui.QRadioButton("1")
    number_group.addButton(r1)
    layout.addWidget(r0)
    layout.addWidget(r1)

    letter_group=QtGui.QButtonGroup(widget) # Letter group
    ra=QtGui.QRadioButton("a")
    letter_group.addButton(ra)
    rb=QtGui.QRadioButton("b")
    letter_group.addButton(rb)
    layout.addWidget(ra)
    layout.addWidget(rb)

    # assign the widget to the main window
    self.setCentralWidget(widget)
    self.show() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-21T19:59:27.547

所有容器都可以对单选按钮进行分组。您不一定需要 QGroupBox，您可以使用 QFrame 或 QTabWidget。你的选择。这是一个示例代码。

```
 self.centralwidget = QtWidgets.QWidget(MainWindow)
    self.layoutWidget1 = QtWidgets.QWidget(self.centralwidget)
    self.frame_1       = QtWidgets.QFrame(self.layoutWidget1)
    self.radio_btn_a   = QtWidgets.QRadioButton(self.frame_1)
    self.radio_btn_a.setGeometry(QtCore.QRect(160, 80, 40, 17))
    self.radio_btn_a.setObjectName("radio_btn_a")
    MainWindow.setCentralWidget(self.centralwidget) 
```

# arrays - COBOL 表达式作为表数组中的索引

> ID：14798059
> 
> 赞同：0
> 
> 时间：2013-02-10T13:10:06.667
> 
> 标签：arrays, indexing, cobol

只是一个简短的快速问题。如何将表达式索引到 COBOL 数组中？例如，如果我的 index `k=1`，我想执行以下操作来查找`k=2`

```
element(k+1) 
```

不幸的是，这在 COBOL 中是不可接受的，我想知道是否有其他选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T13:24:33.970

我不确定为什么你认为这行不通，只要你把它放在 Cobol 语句中。

```
 ID DIVISION. 
   PROGRAM-ID. SUBMOD. 
   DATA DIVISION. 
   WORKING-STORAGE SECTION. 
   01  A-NICELY-NAMED-TABLE. 
       05  FILLER OCCURS 2 TIMES. 
           10 A-NICELY-NAMED-ENTRY  PIC X. 
   01  ANOTHER-PIECE-OF-DATA        PIC X VALUE SPACE. 
   01  A-NICELY-NAMED-SUBSCRIPT BINARY 
                                    PIC 9(4). 
   LINKAGE SECTION. 
   01  L-INPUT                      PIC X(4). 
   01  L-TO-HEX                     PIC BXBXBXBX. 
   PROCEDURE DIVISION USING L-INPUT L-TO-HEX. 
       MOVE "A"                     TO A-NICELY-NAMED-ENTRY ( 1 )
       MOVE "B"                     TO A-NICELY-NAMED-ENTRY ( 2 )
       MOVE 1                       TO A-NICELY-NAMED-SUBSCRIPT 
       IF A-NICELY-NAMED-ENTRY ( A-NICELY-NAMED-SUBSCRIPT + 1 ) 
           EQUAL TO "B" 
           MOVE A-NICELY-NAMED-ENTRY 
            ( A-NICELY-NAMED-SUBSCRIPT + 1 ) 
                                    TO ANOTHER-PIECE-OF-DATA 
       END-IF 
       DISPLAY ">" ANOTHER-PIECE-OF-DATA "<" 

       GOBACK 
       . 
```

输出是：

```
>B< 
```

参考您的评论，这无论如何都不是“严格”的事情。就是“+1”是一回事，是“相对下标”，而“+1”是另外一回事，是第二个下标。

根据您的编译器，您可以编写以下代码：

```
MOVE ELEMENT(k++1) ... 
```

你可能不得不忍受编译器的一些抱怨，我想在某些情况下它可能不起作用。然而，这将是编写 Cobol 的一种可怕的方式。

我建议不要使用像 ELEMENT 这样的名称。太可能在未来某个时候出现为 Cobol 的“保留词”。不要简写。使用好的名称，使用有效的间距。它会帮助你稍后理解你的程序，并且会帮助任何需要查看它的人。

# django - 亚马逊会员 API

> ID：14798066
> 
> 赞同：4
> 
> 时间：2013-02-10T13:10:32.550
> 
> 标签：django, amazon-web-services

有人对亚马逊的产品广告 API 有一些经验吗？我有一个 django 网站，我需要获取与我的网站相关的附属信息。您使用哪些 python/django 包以及如何使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-13T17:45:05.363

我正在开始一个类似的项目。我还没有完成它，所以我还不能完美地回答这个问题，但这是我发现的一个开源 python 项目，它与 PyPi 上的 Amazon Product API 相关：

[https://pypi.python.org/pypi/python-amazon-product-api/](https://pypi.python.org/pypi/python-amazon-product-api/)

# android - 从呼叫返回时 ViewRootImpl 中的 NullPointerException（仅限三星触控）

> ID：14798067
> 
> 赞同：1
> 
> 时间：2013-02-10T13:10:34.953
> 
> 标签：android, android-layout, android-intent

我有一个非常奇怪的 NullPointerException （仅在 Android 4.1 上发生，既不在 ICS 也不在 Jelly Bean 4.2 上）**编辑：仅在三星触控设备上。**

按下按钮时，我从我的一个内部启动一个 ACTION_CALL 活动，如下所示：

```
final Uri dialInFormat = Uri.parse("tel:" + number + ",," + code + "#");
log.info("Starting call: " + dialInFormat);
Intent intent = new Intent(Intent.ACTION_CALL, dialInFormat);
startActivity(intent); 
```

电话活动显示并拨打号码。但是一旦我完成通话，回到我的应用程序并触摸屏幕，就会出现以下错误并且应用程序被杀死：

（有时错误发生得更早，而电话仍在拨号）

```
02-10 13:55:37.470: E/UCE(13354): Uncaught Exception
02-10 13:55:37.470: E/UCE(13354): java.lang.NullPointerException
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl.drawAccessibilityFocusedDrawableIfNeeded(ViewRootImpl.java:2431)
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl.onHardwarePostDraw(ViewRootImpl.java:2059)
02-10 13:55:37.470: E/UCE(13354):   at android.view.HardwareRenderer$GlRenderer.draw(HardwareRenderer.java:1182)
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl.draw(ViewRootImpl.java:2275)
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl.performDraw(ViewRootImpl.java:2147)
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1958)
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:1112)
02-10 13:55:37.470: E/UCE(13354):   at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4518)
02-10 13:55:37.470: E/UCE(13354):   at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
02-10 13:55:37.470: E/UCE(13354):   at android.view.Choreographer.doCallbacks(Choreographer.java:555)
02-10 13:55:37.470: E/UCE(13354):   at android.view.Choreographer.doFrame(Choreographer.java:525)
02-10 13:55:37.470: E/UCE(13354):   at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
02-10 13:55:37.470: E/UCE(13354):   at android.os.Handler.handleCallback(Handler.java:615)
02-10 13:55:37.470: E/UCE(13354):   at android.os.Handler.dispatchMessage(Handler.java:92)
02-10 13:55:37.470: E/UCE(13354):   at android.os.Looper.loop(Looper.java:137)
02-10 13:55:37.470: E/UCE(13354):   at android.app.ActivityThread.main(ActivityThread.java:4898)
02-10 13:55:37.470: E/UCE(13354):   at java.lang.reflect.Method.invokeNative(Native Method)
02-10 13:55:37.470: E/UCE(13354):   at java.lang.reflect.Method.invoke(Method.java:511)
02-10 13:55:37.470: E/UCE(13354):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
02-10 13:55:37.470: E/UCE(13354):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
02-10 13:55:37.470: E/UCE(13354):   at dalvik.system.NativeStart.main(Native Method)
02-10 13:55:37.555: E/AndroidRuntime(13354): FATAL EXCEPTION: main
02-10 13:55:37.555: E/AndroidRuntime(13354): java.lang.NullPointerException
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl.drawAccessibilityFocusedDrawableIfNeeded(ViewRootImpl.java:2431)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl.onHardwarePostDraw(ViewRootImpl.java:2059)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.HardwareRenderer$GlRenderer.draw(HardwareRenderer.java:1182)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl.draw(ViewRootImpl.java:2275)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl.performDraw(ViewRootImpl.java:2147)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1958)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:1112)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4518)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.Choreographer.doCallbacks(Choreographer.java:555)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.Choreographer.doFrame(Choreographer.java:525)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.os.Handler.handleCallback(Handler.java:615)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.os.Looper.loop(Looper.java:137)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at android.app.ActivityThread.main(ActivityThread.java:4898)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at java.lang.reflect.Method.invokeNative(Native Method)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at java.lang.reflect.Method.invoke(Method.java:511)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
02-10 13:55:37.555: E/AndroidRuntime(13354):    at dalvik.system.NativeStart.main(Native Method) 
```

任何提示可能导致 NullPointer 异常？忙主线程？不兼容的 UI 元素？（我正在使用支持包、FragmentLayouts 和 android.support.v4.view.ViewPager）

//只是在完全不同的环境中遇到了同样的问题。我想它必须与 ViewPager/PageAdapter

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-29T08:48:30.777

我找到了解决方案：

我们将[Quick Actions Pop](http://www.androidpatterns.com/uap_pattern/quick-actions)用于触发电话呼叫的菜单。在开始通话之前，我在 PopupWindow 上调用了dismiss。

```
public void dismiss() {
    AnimationSet shrinkAnimation = createAnimation(false);
    shrinkAnimation.setAnimationListener(mShrinkAnimationListener);

    mRoot.startAnimation(shrinkAnimation);
} 
```

如您所见，触发动画以关闭快速操作弹出窗口。我猜三星 Touch 在动画手完成之前破坏了后台的 Activity。删除动画并调用`super.dismiss()`反而解决了问题。

但同样：此错误仅发生在 Samsung Touch 设备上。

# java - 用于异常翻译的无 Spring Hibernate DAO 和 @Repository！这不是依赖吗？

> ID：14798071
> 
> 赞同：1
> 
> 时间：2013-02-10T13:10:57.000
> 
> 标签：java, spring, hibernate, dependencies, dao

我读过创建 Hibernate DAO 的新方法是使用 Hibernate 上下文会话。主要原因是避免使用基于`HibernateTemplate/HiberateDaoSupport`Spring 的无 Spring DAO。

当我搜索如何处理异常翻译时？它写在我应该使用的任何地方`@Repository`！`@Repository`确实需要导入并在我的代码中创建依赖项。我对吗？

注释不被认为是依赖关系吗？如果是的话，无论如何我可以使用 XML 来实现吗？或者我应该使用旧`HibernateDaoSupport`方法，因为无论如何我都要将我的代码与 Spring 结合起来？

### 更新

发现了一个类似的问题：“[在 dao 中集成 hibernate 和 spring 而没有 spring 依赖](https://stackoverflow.com/questions/12243459/integrate-hibernate-with-spring-without-spring-dependency-in-dao/12244626#12244626)”但是：

*   @pap 给出的答案的第一段没有为@Repository 指定任何明确的XML 替代方案。
*   该答案的其余部分提供的见解是合理的，**但我的问题仍然没有得到解答**，如果解耦不是什么大问题，为什么 Spring 尝试提出 Hibernate DAO 的新方法？

PS这不是批评。而是尝试学习思考这个主题的正确方式（即依赖关系）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T15:07:59.070

首先，Spring 异常翻译的重点是通过创建对 Spring 的依赖来打破对 Hibernate 的依赖。无论注解如何，Spring 异常翻译都会捕获 Hibernate 异常并将其转换为 Spring 异常。通过将 catch 语句放入与 Spring 异常相关联的代码中，您将代码与 Spring 耦合比添加任何 @Repository 注释更直接。如果您不想依赖 Spring，那么只需直接使用 Hibernate 异常即可。基本上，有两种方法：

1.  将 Hibernate 用于异常和上下文会话（不与 Spring 耦合）。在这种情况下，根本不使用 Spring 异常翻译。
2.  使用 Spring 进行异常和会话处理（与 Hibernate 的松散耦合，与 Spring 的额外耦合）。

# android - android小部件的按钮单击事件

> ID：14798073
> 
> 赞同：48
> 
> 时间：2013-02-10T13:11:08.150
> 
> 标签：android, android-widget

我有一个 android 小部件，它每 10 分钟从服务器获取数据并将其显示在屏幕上。
我想为该小部件添加一个“刷新”按钮。
当用户单击该按钮时，我想运行从服务器获取信息的方法。
向应用程序中的按钮添加事件处理程序非常容易，但是我找不到小部件的示例。
我想获得一些帮助，将功能添加到小部件中的按钮单击。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-05-29T13:05:36.723

这是一个应该有帮助的例子：

```
package com.automatic.widget;

import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.widget.RemoteViews;

public class Widget extends AppWidgetProvider {

    private static final String SYNC_CLICKED    = "automaticWidgetSyncButtonClick";

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
        RemoteViews remoteViews;
        ComponentName watchWidget;

        remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
        watchWidget = new ComponentName(context, Widget.class);

        remoteViews.setOnClickPendingIntent(R.id.sync_button, getPendingSelfIntent(context, SYNC_CLICKED));
        appWidgetManager.updateAppWidget(watchWidget, remoteViews);
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub
        super.onReceive(context, intent);

        if (SYNC_CLICKED.equals(intent.getAction())) {

            AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);

            RemoteViews remoteViews;
            ComponentName watchWidget;

            remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
            watchWidget = new ComponentName(context, Widget.class);

            remoteViews.setTextViewText(R.id.sync_button, "TESTING");

            appWidgetManager.updateAppWidget(watchWidget, remoteViews);

        }
    }

    protected PendingIntent getPendingSelfIntent(Context context, String action) {
        Intent intent = new Intent(context, getClass());
        intent.setAction(action);
        return PendingIntent.getBroadcast(context, 0, intent, 0);
    }
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-02-18T09:10:23.177

我发现了如何做到这一点。在 >标记 中
向文件添加操作：`AndroidManifest.xml``<receiver><intent-filter>`

```
<action android:name="MY_PACKAGE_NAME.WIDGET_BUTTON" /> 
```

在提供程序中添加一个与操作名称匹配的常量：

```
public static String WIDGET_BUTTON = "MY_PACKAGE_NAME.WIDGET_BUTTON"; 
```

在`onUpdate()`方法中添加与操作匹配的待处理意图：

```
Intent intent = new Intent(WIDGET_BUTTON);
PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
views.setOnClickPendingIntent(R.id.MY_BUTTON_ID, pendingIntent ); 
```

最后，在 onRecieve() 方法中，检查动作名称：

```
 if (WIDGET_BUTTON.equals(intent.getAction())) {
//your code here

    } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-07-22T02:48:26.603

这是另一个具有以下好处的答案：

*   它处理所有 App Widget 实例（用户可能在您的屏幕上有多个不同配置/大小的小部件实例）。所有实例的编码都是官方文档规定的。请参阅[指南 > 应用小部件 > 使用 AppWidgetProvider 类](http://developer.android.com/guide/topics/appwidgets/index.html#AppWidgetProvider)，向下滚动到“ExampleAppWidgetProvider”的代码示例。
*   `onReceive`实际调用中的主力代码`onUpdate`（因此您可以减少代码重复）。
*   中的代码`onUpdate(Context context)`是通用的，因此可以将其放入任何 AppWidgetProvider 子类中。

编码：

```
public class MyWidget extends AppWidgetProvider {

    private static final String ACTION_UPDATE_CLICK = 
              "com.example.myapp.action.UPDATE_CLICK";

    private static int mCount = 0;

    private static String getMessage() {
        return String.valueOf(mCount++);
    }

    private PendingIntent getPendingSelfIntent(Context context, String action) {
        // An explicit intent directed at the current class (the "self").
        Intent intent = new Intent(context, getClass());
        intent.setAction(action);
        return PendingIntent.getBroadcast(context, 0, intent, 0);
    }

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
                         int[] appWidgetIds) {
        super.onUpdate(context, appWidgetManager, appWidgetIds);

        String message = getMessage();

        // Loop for every App Widget instance that belongs to this provider.
        // Noting, that is, a user might have multiple instances of the same
        // widget on
        // their home screen.
        for (int appWidgetID : appWidgetIds) {
            RemoteViews remoteViews = new RemoteViews(context.getPackageName(),
                                                      R.layout.my_widget);

            remoteViews.setTextViewText(R.id.textView_output, message);
            remoteViews.setOnClickPendingIntent(R.id.button_update,
                                                getPendingSelfIntent(context,
                                                           ACTION_UPDATE_CLICK)
            );

            appWidgetManager.updateAppWidget(appWidgetID, remoteViews);

        }
    }

    /**
     * A general technique for calling the onUpdate method,
     * requiring only the context parameter.
     *
     * @author John Bentley, based on Android-er code.
     * @see <a href="http://android-er.blogspot.com
     * .au/2010/10/update-widget-in-onreceive-method.html">
     * Android-er > 2010-10-19 > Update Widget in onReceive() method</a>
     */
    private void onUpdate(Context context) {
        AppWidgetManager appWidgetManager = AppWidgetManager.getInstance
                (context);

        // Uses getClass().getName() rather than MyWidget.class.getName() for
        // portability into any App Widget Provider Class
        ComponentName thisAppWidgetComponentName =
                new ComponentName(context.getPackageName(),getClass().getName()
        );
        int[] appWidgetIds = appWidgetManager.getAppWidgetIds(
                thisAppWidgetComponentName);
        onUpdate(context, appWidgetManager, appWidgetIds);
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        super.onReceive(context, intent);

        if (ACTION_UPDATE_CLICK.equals(intent.getAction())) {
            onUpdate(context);
        }
    }

} 
```

小部件看起来像这样

![小部件更新按钮示例。 简单计数。](../Images/b4f8fc194b83ea4777661e95f3f89884.png)

这建立在`getPendingSelfIntent`@Kels、@SharonHaimPour 和@Erti-ChrisEelmaa 的工作之上。

它还建立在[Android-er > 2010-10-19 > Update Widget in onReceive() 方法](http://android-er.blogspot.com.au/2010/10/update-widget-in-onreceive-method.html)（不是我）的基础上，其中演示了如何在 App Widget 实例基础上从 onReceive 调用 onUpdate。我使该代码通用并将其包装在`callOnUpdate`.

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-02-10T13:14:06.997

```
protected PendingIntent getPendingSelfIntent(Context context, String action) {
    Intent intent = new Intent(context, getClass());
    intent.setAction(action);
    return PendingIntent.getBroadcast(context, 0, intent, 0);
}

views.setOnClickPendingIntent(R.id.Timm, getPendingSelfIntent(context,
                              "ham")); 
```

也更喜欢 URL ：

[如何正确处理 Widget 上的点击事件](https://stackoverflow.com/questions/2797947/how-to-correctly-handle-click-events-on-widget?rq=1)

如果您以其他方式解决了它，请提供此作为答案

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-17T03:47:53.743

在 中`pendingIntent`，我们还可以放置额外的属性`appWidgetId`以便稍后重用它`onReceive`来更新小部件单击的小部件实例

```
class ExampleAppWidgetProvider : AppWidgetProvider() {

    override fun onUpdate(context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray {

        appWidgetIds.forEach { appWidgetId ->
            Log.e("TAG", "onUpdate $appWidgetId")
            val pendingRefreshClickIntent: PendingIntent = Intent(context, javaClass).let {
                it.action = ACTION_REFRESH_CLICK
                it.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)
                return@let PendingIntent.getBroadcast(
                    context,
                    appWidgetId, // click in all instances widget will work well (base on Alireza Mirian comment in the top answer)
                    it,
                    PendingIntent.FLAG_UPDATE_CURRENT
                )
            }

            val views = RemoteViews(
                context.packageName,
                R.layout.example_appwidget
            )
            views.setOnClickPendingIntent(R.id.button_refresh, pendingRefreshClickIntent)

            appWidgetManager.updateAppWidget(appWidgetId, views)
        }
    }

    override fun onReceive(context: Context?, intent: Intent?) {
        super.onReceive(context, intent)
        Log.i("TAG", "onReceive " + intent?.action)

        if (intent?.action == ACTION_REFRESH_CLICK) {
            val appWidgetId = intent.extras?.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID) ?: return
            Log.i("TAG", "onReceive appWidgetId $appWidgetId")

            val appWidgetManager = AppWidgetManager.getInstance(context)
            val views = RemoteViews(context!!.packageName, R.layout.example_appwidget)

            views.setTextViewText(R.id.text_data, "a " + (Math.random() * 9).roundToInt())
            appWidgetManager.updateAppWidget(appWidgetId, views)
        }
    }

    companion object {
        private const val ACTION_REFRESH_CLICK =  "com.example.androidwidgetbuttonclick.action.ACTION_REFRESH_CLICK"
    }
} 
```

小部件初始布局

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <TextView
        android:id="@+id/text_data"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="AA"
        android:textSize="20sp" />

    <Button
        android:id="@+id/button_refresh"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Refresh" />
</LinearLayout> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-28T04:15:47.960

我尝试了[上面](https://stackoverflow.com/a/14932752/3340706)Sharon Haim Pour 建议的解决方案，但我在 AppWidgetProvider 类中的 onReceive() 方法从未在按钮按下时被调用。

```
Intent intent = new Intent(WIDGET_BUTTON);
PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, 
PendingIntent.FLAG_UPDATE_CURRENT);
views.setOnClickPendingIntent(R.id.MY_BUTTON_ID, pendingIntent ); 
```

经过一番研究，我可以通过更新代码来解决问题，如下所示：

```
Intent intent = new Intent(context, MY_APPWIDGETPROVIDER_CLASS.class);
intent.setAction(WIDGET_BUTTON);
PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, 
PendingIntent.FLAG_UPDATE_CURRENT);
views.setOnClickPendingIntent(R.id.MY_BUTTON_ID, pendingIntent ); 
```

不要忘记在下面放：

```
appWidgetManager.updateAppWidget(appWidgetId, views); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-05T14:08:15.773

与此处使用的其他答案不同`onReceive()`，我发现在`onUpdate()`.

官方的 Android codelab [Advanced Android 02.1: App widgets](https://developer.android.com/codelabs/advanced-android-training-widgets?index=..%2F..advanced-android-training#4)提供了这个解决方案。Java 中的示例代码。在这里，我介绍了 Kotlin 中的解决方案。

```
class MyAppWidgetProvider : AppWidgetProvider() {

    override fun onUpdate(
        context: Context?,
        appWidgetManager: AppWidgetManager?,
        appWidgetIds: IntArray?
    ) {
        appWidgetIds?.forEach { appWidgetId ->
            val views = RemoteViews(
                context?.packageName,
                R.layout.appwidget
            )
            // Coroutine to perform background IO task.
            GlobalScope.launch(Dispatchers.IO) {
                // Suspend function.
                val apiData = Api.retrofitService.getData()
                updateWidgetUI(views, apiData)
                context?.let {
                    views.setOnClickPendingIntent(
                        R.id.widget_button,
                        getUpdatePendingIntent(it, appWidgetId)
                    )
                }
                appWidgetManager?.updateAppWidget(appWidgetId, views)
            }
        }
    }

    private fun updateWidgetUI(views: RemoteViews, apiData: ApiData){
        views.apply {
            setTextViewText(R.id.widget_value_textview, apiData.value)
            setTextViewText(
                R.id.widget_last_updated_value_textview,
                DateFormat.getTimeInstance(DateFormat.MEDIUM).format(Date())
            )
        }
    }

    private fun getUpdatePendingIntent(context: Context, appWidgetId: Int): PendingIntent {
        val intent = Intent(context, MyAppWidgetProvider::class.java).also {
            it.action = AppWidgetManager.ACTION_APPWIDGET_UPDATE
            // It's very important to use intArrayOf instead of arrayOf,
            // as a primitive int array is expected.
            it.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, intArrayOf(appWidgetId))
        }
        // Set the immutability flag for Android 12.
        val flags = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
            PendingIntent.FLAG_IMMUTABLE or PendingIntent.FLAG_UPDATE_CURRENT
        } else {
            PendingIntent.FLAG_UPDATE_CURRENT
        }
        return PendingIntent.getBroadcast(
            context,
            appWidgetId,
            intent,
            flags
        )
    }
// No need for onReceive().
} 
```

这里的关键是使用内置`AppWidgetManager.ACTION_APPWIDGET_UPDATE`操作而不是自定义操作。

# php - 生产服务器：URL 未打开

> ID：14798075
> 
> 赞同：0
> 
> 时间：2013-02-10T13:11:19.367
> 
> 标签：php, fopen

URL是正确的并且发送的参数被确认在开发服务器上工作，但它在生产服务器上一直返回错误。

```
$url  = "http://www.smslive247.com/http/index.aspx?";
$url .= "cmd=sendquickmsg";
$url .= "&owneremail=".urlencode($owenerEmail);
$url .= "&subacct=".urlencode($subAcct);
$url .= "&subacctpwd=".urlencode($subPwd);
$url .= "&message=".urlencode($msg);
$url .= "&sender=".urlencode($sender);
$url .= "&sendto=".urlencode($phone);
$url .= "&msgtype=0";

if($f = @fopen($url, "r")){
    echo "Successful.";
}else{
    echo $url." Error: URL could not be opened.";
} 
```

当我尝试返回 URL 并将其放在浏览器上时，它会返回成功消息。我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:18:16.523

您的主机不允许 URL 下载。这可能是由于几个不同的原因：

> 1.  您的主机已禁用在 URL 上使用 fopen，这很可能。
> 2.  您的 PHP 版本太旧，无法支持包装器。

您可以通过让您的主机允许或使用`curl`访问来解决此问题。

# sms - 如何将 USSD 代码发送到手机

> ID：14798077
> 
> 赞同：1
> 
> 时间：2013-02-10T13:11:24.187
> 
> 标签：sms, ussd

我想通过 PHP 在手机上发送和运行 USSD 代码。我有一个短信网关，我可以通过短信发送还是需要购买其他服务？我一直在网上搜索，并没有找到适合我的解决方案。

一些公司的支持告诉我，我可以在 SMS 中使用 XML 发送它。

我要运行的 USSD 命令是：

```
 1\. *21*___SOME NO____#
    2\. #21# 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T16:57:34.487

USSD 和 SMS 是 3gpp 移动协议都支持的两种不同服务。
检查您的文档，或向提供 SMS 网关的组织的支持工程师询问他们是否也支持 USSD。如果是，那么他们应该为您提供有关如何使用它的详细信息。

USSD 网关的接口不是标准的，这取决于各个公司如何实现它。

在 Google 上快速搜索“ussd gateway”这个词会出现几个 USSD 产品。

# django - {% trans "string" as my_translated_string %} 未在模板中呈现内容

> ID：14798078
> 
> 赞同：6
> 
> 时间：2013-02-10T13:11:33.310
> 
> 标签：django, internationalization, django-templates, translation

Django 1.4 文档说，您可以使用以下语法将翻译后的字符串转换为“vars”，以便在不同的地方使用或用作模板标签或过滤器中的参数：

```
{% trans "String" as my_translated_string %}

<h1>{{ my_translated_string }}</h1> 
```

[https://docs.djangoproject.com/en/1.4/topics/i18n/translation/#trans-template-tag](https://docs.djangoproject.com/en/1.4/topics/i18n/translation/#trans-template-tag)

我正在这样做，但是定义的 var 永远不会呈现内容。在我的模板代码下面：

```
{% extends "default_layout.html" %}

{% load i18n %}

{% trans "My page title" as title %}

{% block meta_title %}{{ title }}{% endblock %}

{% block content %} 
    <h1>{{ title }}</h1>
{% endblock %} 
```

当然，在这两种情况下，“标题”都被渲染为空。

我错过了什么吗？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T22:36:16.623

如前所述`okm`，您需要在要使用它的块内定义变量，并且该变量的范围也在块内：

```
{% extends "default_layout.html" %}
{% load i18n %}

{% block meta_title %}
{% trans "My page title" as title %}
{{ title }}
{% endblock %}

{% block content %}
{% trans "My page title" as title %}
    <h1>{{ title }}</h1>
{% endblock %} 
```

# java - 启用评论 PDF

> ID：14798087
> 
> 赞同：1
> 
> 时间：2013-02-10T13:12:05.073
> 
> 标签：java, pdf, comments, pdf-generation

我编写了一个 java 程序，它在 pdf 上启用了共享审阅功能。将 pdf 制作为 Shared Review PDF 后，它会将 pdf 发送到 UNIX 机器中的链接文件夹（链接文件夹表示文件夹的快捷路径）。之后，通过 crontab 以不同方式运行的 shell 脚本使 pdf 成为启用注释，并通过脚本将 pdf 复制到某个文件夹。

现在的问题是，每当我在 UNIX 链接文件夹中复制文件时（用于将文件复制到我正在使用的链接文件夹**`FileUtils.copyInputStream()`**中），启用注释的脚本正在执行并在 pdf(.sh 脚本中执行所有启用注释的操作UNIX，它不是从我的程序运行的。）但在保存文件期间，它会提示文件是只读的并退出而不保存文件。但是，如果我手动执行相同的操作（将文件手动放入 UNIX 中的链接文件夹），它将使 pdf 文件成为启用注释。这是我将文件发送到文件夹的示例代码。

```
try{
                    String outFname="SR_"+fname;
                    srEnabledIs = new FileInputStream(pdfoutputPath+fname);

                    if(srEnabledIs!=null && !path.equals("")){
                        Date today = new Date();
                        SimpleDateFormat format = new SimpleDateFormat("dd_MM_yyyy_hh_mm_ss_a");
                        String timeStamp=format.format(today);
                        FileUtils.copyInputStreamToFile(srEnabledIs, new File(path+outFname));
                        logtracker.writeDebugNormalLog("AnnotationMain","file copied to " + path);
                        try{
                            lrfile.renameTo(new File(pdfinputPath+"/pdf/"+fname.split("[.]")[0]+"_"+timeStamp+".pdf"));
                        }catch(Exception ex){
                            logtracker.writeDebugNormalLog("AnnotationMain", ex.getMessage());
                            ex.printStackTrace();
                        }                        
                    }else{
                        if(path.equals("")){
                            logtracker.writeDebugNormalLog("AnnotationMain", "File not copied as path not found.");
                        }
                        if(srEnabledIs==null){
                            logtracker.writeDebugNormalLog("AnnotationMain", "File not copied as InputStream is null.");
                        }
                        if(srEnabledIs==null && path.equals("")){
                            logtracker.writeDebugNormalLog("AnnotationMain", "File not copied as InputStream is null and path not found.");
                        }
                    }
                   }catch(IOException e){
                       logtracker.writeDebugNormalLog("AnnotationMain", e.getMessage());
                       e.printStackTrace();
                   }finally{
                       if(srEnabledIs!=null){
                           srEnabledIs.close();
                       }
                   } 
```

但是相同的程序在其他 UNIX 机器上运行并成功执行。我真的无法理解这种情况。请帮助我摆脱这种情况。

# windows-phone-7 - 隐藏Windows Phone浏览器用户控件后如何返回Windows Phone应用页面？

> ID：14798089
> 
> 赞同：0
> 
> 时间：2013-02-10T13:12:14.453
> 
> 标签：windows-phone-7, windows-phone-7.1, facebook-c#-sdk

我开发了一个 windows phone 用户控件，它的网格中只有浏览器控件。单击按钮后，我正在从我的应用程序主页导航到此浏览器控件。此浏览器控件加载 Facebook 身份验证页面。将消息发布到 facebook 后，我想回到我的主应用程序。

为此，我尝试隐藏浏览器控件，并将可见性设置为折叠，并显示一个空白屏幕。

有关如何返回调用此浏览器控件并保持与以前相同状态的主应用程序的任何帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T16:24:38.753

以下代码有效...

```
 (Application.Current.RootVisual as PhoneApplicationFrame).GoBack() 
```

# perl - 如何使用perl在各自位置使用两个文件中的元素进行计算？

> ID：14798091
> 
> 赞同：0
> 
> 时间：2013-02-10T13:12:23.230
> 
> 标签：perl

我有两个文本文件。
1.我想将两个文件的每个元素除以各自文件中存在的数字。
2.我想在两个文件中的各个索引位置**计算通过上述计算获得的值之间的差异平方。**

文件1：

> ```
>  1000    1.45            1450    1.56            2559     
>     335 0.35            499 0.54            1104    
>     1433    1.49            1498    1.62            2511    
>     684 0.71            263 0.28            1481 
> ```
> 
> 第1111章

文件2：

> ```
>  2000    1.45            1450    1.56            2559     
>     335 0.35            499 0.54            1104    
>     1433    1.49            1498    1.62            2511    
>     684 0.71            263 0.28            1481 
> ```
> 
> 第2222章

我想要输出，例如第一个元素 [(1000/1111)-(2000/2222)] ^2 等等...

（注意：两个文件中有相同数量的空格或制表符）

```
#!/usr/bin/perl -w

use List::MoreUtils qw<pairwise>;
print"Enter file 1: ";
chomp($file=<STDIN>);
open(FH,$file);

print"Enter file 2: ";
chomp($hspfile=<STDIN>);
open(FH1,$hspfile);

open(OUT,">$file.$hspfile.txt");

my @list1 = split '\s+', <FH>;
my @list2 = split '\s+', <FH1>;

my @diff  = pairwise { ($p - $q)^2 } @list1, @list2;

print OUT "@diff";
close FH;
close FH1; 
```

**此代码不会在空格处运行。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:14:13.687

大概是这样的？

```
use strict;
use warnings;

use autodie;

my @data;

for my $file (qw/ file1.txt file2.txt /) {
  open my $fh, '<', $file;
  local $/;
  my $data = <$fh>;
  my $i = 0;
  push @{$data[$i++]}, $_ for  $data =~ /[0-9.]+/g;
}

my $divisor = pop @data;
for (@data) {
  my $val = $_->[0] / $divisor->[0] - $_->[1] / $divisor->[1];
  printf "%.10f\n", $val * $val;
} 
```

**输出**

```
0.0000000000
0.0000004258
0.4258414140
0.0000004929
1.3263326558
0.0227301083
0.0000000248
0.0504327886
0.0000000591
0.2468596095
0.4159147013
0.0000004497
0.4545017058
0.0000005315
1.2770423982
0.0947597910
0.0000001021
0.0140095243
0.0000000159
0.4442444469 
```

# javascript - 表单字段验证似乎被忽略了

> ID：14798096
> 
> 赞同：0
> 
> 时间：2013-02-10T13:12:44.327
> 
> 标签：javascript, html, forms

我觉得我一定错过了一些如此简单的东西，因为这种表单字段验证方法在过去对我来说措辞很好。我相信所有文件路径都是正确的，但是无论何时我点击提交它都会生成一封电子邮件，无论字段内容如何。

测试站点是[PortfolioPrep](http://www.portfolioprep.com)

```
 <form action="<?php echo base_url()?>" method="POST">

  <input type="hidden" name="subject" id="subject" value="Portfolio Prep From Reply">

  <div class="dot_spacer_lt_green"></div>
  <label>NAME</label><dl class="field row">
  <dt class="text"><input name="name" type="text" id="name" placeholder="Contact Name" /></dt>
  <dd class="msg"><span class="caret"></span>You filled this out wrong.</dd>
</dl>
  <label>EMAIL</label><dl class="field row">
  <dt class="text"><input name="from" type="text" id="from" placeholder="Contact Email" /></dt>
  <dd class="msg"><span class="caret"></span>You filled this out wrong.</dd>
</dl>
  <div class="dot_spacer_lt_green"></div>
  <ul class="field row">
  <li>
    <label class="radio" for="high_school">HIGH SCHOOL</label>
      <input name="radio1" type="radio" form="high_school" value="High School">

  </li>
  <li>
    <label class="radio" for="recent_graduate">RECENT GRADUATE</label>
      <input name="radio1" type="radio" form="recent_graduate" value="Recent Graduate">

  </li>
</ul>
  <div class="dot_spacer_lt_green"></div>
  <dl class="field row">
  <dt class="textarea"><textarea name="message" id="message" placeholder="Text Field"></textarea></dt>
  <dd class="error msg"><span class="caret"></span>You filled this out wrong.</dd>
</dl>
<input type="image" src="<?php echo base_url()?>img/submit.png" alt="Submit"  onClick="return validateForm()"/>
  <div class="dot_spacer_lt_green"></div>
  </form>
  </div>
  <div class="one columns"></div> 
  </div>

</div>

 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="<?php echo base_url()?>js/libs/jquery-1.7.2.min.js"><\/script>')</script>
<script src="<?php echo base_url()?>js/libs/gumby.min.js"></script>
<script src="<?php echo base_url()?>js/plugins.js"></script>
<script src="<?php echo base_url()?>js/main.js"></script>
<script src="<?php echo base_url()?>js/libs/modernizr-2.0.6.min.js"></script>
<!-- end scripts-->
<!-- Change UA-XXXXX-X to be your site's ID -->

<script>

   $(document).ready(function(e) {

$("#from").blur(function(){
    if($(this).val()=='' )
    {
        $(this).css('color','#000');
        $(this).val('Email')

        }
});

$("#fron").click(function(){
    if($(this).val()=='Email' || $("#fron").val()=='Please enter a valid email.' || $("#from").val()=='Please enter your email.')
    {$(this).val('')}
});

$("#name").blur(function(){
    if($(this).val()=='')
    {$(this).css('color','#000');
        $(this).val('Contact Name')}
});

$("#name").click(function(){
    if($(this).val()=='Please enter your name.' || $(this).val()=='Contact Name')
    {$(this).val('')}
});

function validateForm()
{
    var i=0;
    if($("#name").val()=='Contact Name' || $("#name").val()=='Please enter your name.')
    {   $("#name").css('color','red');
        $("#name").val('Please enter your name.');

        i++;
    }

    if($("#from").val()=='Email' || $("#from").val()=='Please enter your email.' || $("#from").val()=='Please enter a valid email.')
    {
        $("#from").css('color','red');  
        $("#from").val('Please enter your email.');
        i++;
    }
    else
    {
        var filter = /^[a-zA-Z0-9]+[a-zA-Z0-9_.-]+[a-zA-Z0-9_-]+@[a-zA-Z0-9]+[a-zA-Z0-9.-]+[a-zA-Z0-9]+.[a-z]{2,4}$/;   
        if(!filter.test($("#from").val()))
        {
            $("#from").css('color','red');
            $("#from").val('Please enter a valid email.');              
            i++;
        }

    }

    if(i>0)
    {
        return false;   
    }
    else{
            //$("#contactusform").submit();
        }   

}

    window._gaq = [['_setAccount','UAXXXXXXXX1'],['_trackPageview'],['_trackPageLoadTime']];

    Modernizr.load({
      load: ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js'
    });

  </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:17:48.610

您的 Javascript 中有一些拼写错误：

“#fron”需要在以下部分变为“#from”：

```
$("#fron").click(function(){
    if($(this).val()=='Email' || $("#fron").val()=='Please enter a valid email.' || $("#from").val()=='Please enter your email.')
    {$(this).val('')}
}); 
```

# asp.net - 使用 LINQ 从另一个（对象）列表中删除匹配列表（对象）

> ID：14798100
> 
> 赞同：0
> 
> 时间：2013-02-10T13:13:28.333
> 
> 标签：asp.net, vb.net, linq

我很难弄清楚如何完成我的问题标题中概述的任务。

基本上，我有一个 ' `News`' 对象列表，定义为：

```
Dim news_list As List(Of News) = myNamespcae.News.ListNews() 
```

根据条件，我有另一个“新闻”对象列表；

```
Dim news_headlines As List(Of News) = myNamespace.News.getHeadlines() 
```

然后，我再次将“点”作为列表（新闻）作为；

```
Dim spots = (From n In news_list Take (10) Select n) 
```

我正在努力完成；如果 news_headlines 不为空，如果点中存在任何 news_headlines 新闻对象，则将其从点中删除。返回过滤的斑点。

任何指导将不胜感激..

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:18:33.803

如果您想从中挑选十个`Spots`然后过滤掉 中的那些`news_headlines`，它将是这样的（警告：VB 中的 LINQ 语法完全来自内存）：

```
Dim spots1 = (From n In news_list Take (10) Select n)
Dim spots2 = (From n in spots1 Where Not news_headlines.Contains(n) Select n) 
```

如果你想过滤掉那些，`news_headlines`然后选择十个，它会是这样的：

```
Dim spots1 = (From n In news_list Where Not news_headlines.Contains(n) Select n)
Dim spots2 = (From n in spots1 Take (10) select n) 
```

您当然可以组合这两个查询。请注意，我假设`news_headlines`不为空。我还假设您的新闻项目是相同的对象实例或实现`IEquatable<T>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:18:53.443

我认为stackoverflow中有类似的问题。无论如何，您可以使用[“相交”](http://msdn.microsoft.com/en-GB/library/system.linq.enumerable.intersect.aspx)来获取同时在广告位和标题中的元素，并将它们从广告位列表中删除。

代码应该很简单，但我有一段时间没有使用 VB.net，抱歉。

# c# - 刷新计算属性的依赖树的最佳方法是什么？

> ID：14798103
> 
> 赞同：0
> 
> 时间：2013-02-10T13:13:48.773
> 
> 标签：c#, properties, onchange, inotifypropertychanged, inotifycollectionchanged

我这里有一些课程或多或少地相互依赖。关系形式有点像依赖树：

```
class A {
  List<B> _bs = new List<B>();

  public int ValueOfA { 
    get {
      return _bs.Sum(p => p.ValueOfB);
    }
}

class B {
  List<C> _cs = new List<C>();
  public int ValueOfB {
    get {
      return _cs.Where(p => p.ValueOfC > 1).Sum(p => p.ValuOfC);
    }
  }

class C {
  public int ValueOfC { get; set }
} 
```

因此，无论何时`_bs`，`_cs`或`ValueOfC`发生变化，与它们相关的每个属性都应该被通知为也发生了变化，并因此被重新计算。

始终如一且可靠地实现这一目标的最佳方式是什么？有没有办法自动做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:08:19.517

你会想`INotifyPropertyChanged`用你的类来实现`C`。在 的集合中`ValueOfC`，您将触发事件：

```
class C : INotifyPropertyChanged 
{
    public event PropertyChangedEventHandler PropertyChanged;

    private int valueOfC;
    public int ValueOfC
    {
        get { return valueOfC; }
        set
        {
            valueOfC = value;
            OnPropertyChanged(PropertyChanged);
        }
    }

    protected virtual void OnPropertyChanged(PropertyChangedEventHandler handler)
    {
        if (handler != null)
            handler(this, new PropertyChangedEventArgs("ValueOfC"));
    }
} 
```

我刚刚测试了它，它工作得很好。

让受保护的虚拟方法为您触发事件只是常见做法。

附带说明一下，如果您想在列表发生变化时做某事，您可能需要考虑使用[BindingList](http://msdn.microsoft.com/en-us/library/ms132679.aspx)或[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604.aspx)。

**编辑**

我写了一个小例子来刷新整个树：

```
public class Bank : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private BindingList<Customer> customers = new BindingList<Customer>();
    public int Worth
    {
        get { return customers.Sum(cust => cust.FullBalance); }
    }

    public Bank()
    {
        customers.ListChanged += new ListChangedEventHandler(customers_ListChanged);
    }

    void customers_ListChanged(object sender, ListChangedEventArgs e)
    {
        Console.WriteLine("A customer has changed.");
        var handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs("Worth"));
    }

    public void Add(Customer c) { customers.Add(c); }
}

public class Customer : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private BindingList<Account> accounts = new BindingList<Account>();
    public int FullBalance
    {
        get { return accounts.Sum(acc => acc.Balance); }
    }

    public Customer()
    {
        accounts.ListChanged += new ListChangedEventHandler(accounts_ListChanged);
    }

    void accounts_ListChanged(object sender, ListChangedEventArgs e)
    {
        Console.WriteLine("An account has changed.");
        var handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs("FullBalance"));
    }

    public void Add(Account a) { accounts.Add(a); }
}

public class Account : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private int balance = 0;
    public int Balance
    {
        get { return balance; }
        set
        {
            var handler = PropertyChanged;
            if (handler != null)
                handler(this, new PropertyChangedEventArgs("Balance"));
        }
    }
}

class Program
{
    static void Main(string[] args)
    {
        Account a1 = new Account() { Balance = 5 };
        Account a2 = new Account() { Balance = 10 };
        Account a3 = new Account() { Balance = 15 };

        Customer c1 = new Customer(); c1.Add(a1); c1.Add(a2);
        Customer c2 = new Customer(); c2.Add(a3);

        Bank b = new Bank(); b.Add(c1); b.Add(c2);

        Console.WriteLine();

        a1.Balance += 100;
    }
} 
```

现在您可以`if (e.ListChangedType == ListChangedType.ItemChanged)`在事件处理程序中编写类似的内容，或类似的内容。

# sunspot-rails - 当少于 3 个字符时，Rails Sunspot Solr 搜索不起作用

> ID：14798105
> 
> 赞同：-1
> 
> 时间：2013-02-10T13:14:01.303
> 
> 标签：sunspot-rails, sunspot-solr

当我搜索“啤酒”时，我得到了结果，但是当我搜索“蜜蜂”时，我没有得到任何结果。我无法搜索任何短于 4 个字符的单词。有没有办法让这成为可能？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:17:04.960

检查您的 SOLR 配置`conf/schema.xml`并根据您的需求配置设置。更改后重建索引并重试。

这可能是这部分，但你必须“玩”设置。

试试这个配置作为例子：

```
<fieldType name="text" class="solr.TextField" omitNorms="false">

  <analyzer type="index">
          <tokenizer class="solr.WhitespaceTokenizerFactory"/>
          <filter class="solr.PhoneticFilterFactory" encoder="DoubleMetaphone" inject="true"/>

          <filter class="solr.WordDelimiterFilterFactory"
                  generateWordParts="1"
                  generateNumberParts="0"
                  catenateWords="1"
                  catenateNumbers="1"
                  catenateAll="1"
                  splitOnNumerics="0"
                  splitOnCaseChange="1"
                  preserveOriginal="1" />
          <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
          <filter class="solr.StopFilterFactory"
                  ignoreCase="true"
                  words="stopwords.txt"
                  enablePositionIncrements="true" />
          <filter class="solr.LowerCaseFilterFactory"/>
          <filter class="solr.SnowballPorterFilterFactory" language="German2" protected="protwords.txt"/>
          <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
          <filter class="solr.NGramFilterFactory" minGramSize="1" maxGramSize="42" /> 
  </analyzer>
  <analyzer type="query">
          <tokenizer class="solr.WhitespaceTokenizerFactory"/>
          <filter class="solr.StopFilterFactory"
                  ignoreCase="true"
                  words="stopwords.txt"
                  enablePositionIncrements="true" />
          <filter class="solr.LowerCaseFilterFactory"/>
          <filter class="solr.SnowballPorterFilterFactory" language="German2" protected="protwords.txt"/>
          <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
  </analyzer>

</fieldType> 
```

# xcode - 在 Xcode 中有效地初始化大型数组

> ID：14798109
> 
> 赞同：0
> 
> 时间：2013-02-10T13:14:19.473
> 
> 标签：xcode, large-data-volumes

我需要在我的项目中存储大量不同类型的机密数据。数据可以表示为编码的 NSStrings。我更喜欢在代码中初始化它而不是从文件中读取，因为这样更安全。

所以我需要大约 100k 行，如下所示：

```
[myData addObject: @"String"]; 
```

或者像这样

```
myData[n++] = @"String"; 
```

将这些行放入 Xcode 会导致编译时间大幅增加长达几个小时（顺便说一下，在 Eclipse 中编译 100k 行这样的代码只需要几分之一秒）

什么是可行的安全替代方案？

（请不要建议从文件中读取，因为这会使数据更容易破解）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T18:42:26.440

代码中的字符串可以很容易地用[`strings`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/strings.1.html).

无论如何，如果您想将数据文件直接合并到可执行文件中，您可以使用`-sectcreate`链接器选项来实现。`-Wl,-sectcreate,MYSEG,MYSECT,path`在其他链接器命令构建设置中添加类似的内容。在您的代码中，您可以使用[`getsectdata()`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/getsectdata.3.html)来访问该数据部分。

但是，您不得将实际交付给最终用户的任何数据（无论是在代码文件中还是在资源文件中）视为“机密”。它不是，也永远不可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T13:20:08.013

我会将字符串放在 plist 文件中，然后`NSArray`在运行时将其读入。为安全起见，对文件进行加密。

# php - 在 wordpress 插件中合并两个 php 函数

> ID：14798112
> 
> 赞同：0
> 
> 时间：2013-02-10T13:14:49.973
> 
> 标签：php, wordpress, scripting, merge, calendar

我正在使用日历插件，我想更改一件事

有一个添加事件名称的 php 函数：

包括/日历/Calendar.class.php

```
$tab .= '<div class="namevent"> '.$event['event'].'</div>'; 
```

输出：**我的事件名称**

我想在事件标题中添加一个时间，找了一会儿我发现时间函数在

公共/事件.php

```
if(!empty($custom['stime'][0]))
                            echo '<br /><strong>'.$home[16].':</strong> '.$custom['stime'][0].' ';

if(!empty($custom['etime'][0]))
                            echo '<strong>'.$home[17].'</strong> '.$custom['etime'][0]; 
```

输出： 10: **00 到 11:00**（假设你的活动时间是这些）

所以我尝试了这个：

```
$tab .= '<div class="namevent"> '.$custom['stime'][0].' - '.$custom['etime'][0].' '.$event['event'].'</div>'; 
```

Expeting 输出为：**10:00 - 11:00 我的活动名称**

但它没有用；

我做错了什么？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:35:03.730

确保`$custom['stime'][0]`和`$custom['etime'][0]`存在，每个都有一个`var_dump()`或`print_r()`。在导致错误的行之前添加以下代码：

```
var_dump($custom['stime']);  // Be sure the var is not undefined and [0] exists
var_dump($custom['etime']); 
```

# c# - 错误 C# 类型被用作字段

> ID：14798113
> 
> 赞同：-2
> 
> 时间：2013-02-10T13:15:00.503
> 
> 标签：c#

嗨，我遇到了一些奇怪的错误

[http://pastebin.com/edBdmFAV](http://pastebin.com/edBdmFAV)是源代码

我尝试将对象添加到 main

```
 ConsoleRectangle b = new ConsoleRectangle(10, 10, 10, 10, ConsoleColor.White);
    b.Draw(); 
```

不起作用，错误在主要而不是在类中。

错误 1 ​​类、结构或接口成员声明中的无效标记 '(' 错误 2 'TestTest.Program.b' 是“字段”，但用作“类型”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:16:43.293

该语句`b.Draw()`只能*在*方法（或属性）内部进行。

它目前*在*任何方法之外。

# android - 滚动列表片段与照片不流畅

> ID：14798123
> 
> 赞同：-2
> 
> 时间：2013-02-10T13:15:53.157
> 
> 标签：android, android-layout, android-fragments, android-listfragment

我有一个带有用户照片的列表片段。当我滚动我的列表时，它很慢。然后我异步加载我的照片：

```
public class UserArrayAdapter extends ArrayAdapter<Friend>{
.
.
.
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) context
        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View rowView = inflater.inflate(R.layout.list_user, parent, false);
    TextView textView = (TextView) rowView.findViewById(R.id.label);
    textView.setText(friends.get(position).getName());
    String s = friends.get(position).getName();
    String Contact_Id = friends.get(position).getID();
    new BackgroundLoadPhoto(context, Contact_Id, rowView).execute();

    return rowView;
}

class BackgroundLoadPhoto extends AsyncTask<Void, Void, Void> {
Context mContext;
String Contact_Id;
View rowView;
Bitmap photo;
ImageView profile;
public BackgroundLoadPhoto(Context mContext,String Contact_Id,View rowView){
    this.mContext=mContext;
    this.Contact_Id=Contact_Id;
    this.rowView=rowView;
    profile  = (ImageView)rowView.findViewById(R.id.logo); 
}
@Override
protected void onPostExecute(Void result) {
    //set real user immage
    if(photo!=null){
      profile.setImageBitmap(photo);            
    }
}

@Override
protected void onPreExecute() {
    //set default photo
    profile.setImageResource(R.drawable.search_marker);
}

@Override
protected Void doInBackground(Void... params) {
//get user photo in background
photo=getPhoto(Contact_Id);
return null;
}
private Bitmap getPhoto(String Contact_Id){
    Bitmap my_btmp = null;
    //only if it is a real user..
    if(Contact_Id!="-1"){
        Uri my_contact_Uri = Uri.
                withAppendedPath(ContactsContract.Contacts.CONTENT_URI, String.valueOf(Contact_Id));
        InputStream photo_stream = ContactsContract
                .Contacts.openContactPhotoInputStream(mContext.getContentResolver(),my_contact_Uri);            
        BufferedInputStream buf =new BufferedInputStream(photo_stream);
        my_btmp = BitmapFactory.decodeStream(buf);          
    }
    return my_btmp; 
}
} 
```

现在我可以流畅地滚动我的列表了..但我可以在一段时间后看到照片..我不喜欢！我该怎么办？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:42:29.877

您正在异步加载位图，当您滚动它们时它们还没有准备好，所以一旦它们准备好就可以看到它们。

您可以通过对位图使用内存缓存来提高性能，例如[http://developer.android.com/reference/android/util/LruCache.html](http://developer.android.com/reference/android/util/LruCache.html)

看到这个 - [https://developers.google.com/events/io/sessions/gooio2012/103/](https://developers.google.com/events/io/sessions/gooio2012/103/)

# c# - 使用类继承创建模板类型的实例

> ID：14798127
> 
> 赞同：1
> 
> 时间：2013-02-10T13:16:29.363
> 
> 标签：c#, templates, inheritance, activator

我有一个似乎无法解决的问题。

假设我有这样的课程设置：

```
public abstract class GenericCustomerInformation
{
    //abstract methods declared here
}

public class Emails : GenericCustomerInformation
{
    //some new stuff, and also overriding methods from GenericCustomerInformation
}

public class PhoneNumber : GenericCustomerInformation
{
    //some new stuff, and also overriding methods from GenericCustomerInformation
} 
```

现在假设我有这样的功能设置：

```
private void CallCustomerSubInformationDialog<T>(int iMode, T iCustomerInformationObject)
{
    //where T is either Emails or PhoneNumber

    GenericCustomerInformation genericInfoItem;

    //This is what I want to do:
    genericInfoItem = new Type(T);

    //Or, another way to look at it:
    genericInfoItem = Activator.CreateInstance<T>(); //Again, does not compile
} 
```

在`CallCustomerSubInformationDialog<T>`函数中，我有一个基本类型的变量`GenericCustomerInformation`，我想用进来的任何东西来实例化它`T`（派生类型之一：要么`Emails`或`PhoneNumber`）

一个简单的事情是使用一堆`if`条件，但我不想做任何有条件的事情，因为这会使我的代码比它需要的大得多..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:21:33.550

像这样的东西？（还是我误解了？）

```
private void CallCustomerSubInformationDialog<T>(int iMode, T iCustomerInformationObject) where T: GenericCustomerInformation, new()
{
    //where T is either Emails or PhoneNumber
    GenericCustomerInformation genericInfoItem;
    //This is what you could try to do:
    genericInfoItem = new T();

} 
```

注意：请注意对 T 的限制...

# php - 问题：关于 toggleGroup 的 Google maps v3

> ID：14798129
> 
> 赞同：1
> 
> 时间：2013-02-10T13:16:35.120
> 
> 标签：php, javascript, google-maps-api-3

单击复选框不会显示组标记，但会显示所有标记和所有组。当我搜索“T^T”时，它需要很长时间。

```
<script type="text/javascript">
//<![CDATA[

var customIcons = {
  "01": {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_purple.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  },
  "02": {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_green.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  },
  "03": {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_blue.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  },
  "04": {
    icon: 'http://labs.google.com/ridefinder/images/mm_20_brown.png',
    shadow: 'http://labs.google.com/ridefinder/images/mm_20_shadow.png'
  }
};

function load() {
  var map = new google.maps.Map(document.getElementById("map"), {
    center: new google.maps.LatLng(13.754059,100.493317),
    zoom: 13,
    mapTypeId: 'roadmap'
  });
  var infoWindow = new google.maps.InfoWindow;

  // Change this depending on the name of your PHP file
  downloadUrl("dbxml.php", function(data) {
    var xml = data.responseXML;
    var markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
      var name_place = markers[i].getAttribute("name_place");
      var id_category = markers[i].getAttribute("id_category");
      var point = new google.maps.LatLng(
          parseFloat(markers[i].getAttribute("latitude")),
          parseFloat(markers[i].getAttribute("longitude")));
          var html = "<b>" + name_place ;
      var icon = customIcons[id_category] || {};
      var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: icon.icon,
        shadow: icon.shadow
      });
      bindInfoWindow(marker, map, infoWindow, html);
    }
  });
}

function bindInfoWindow(marker, map, infoWindow, html) {
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(html);
    infoWindow.open(map, marker);
  });
}

 var markerGroups = { "01": [], "02": [] , "03": [] , "04": [] };}
function toggleGroup(id_category) {
 for (var i = 0; i < markerGroups[id_category].length; i++) {
var marker = markerGroups[id_category][i];
markerGroups[id_category].push(marker);
if (marker.isHidden()) {
  marker.show();
} else {
  marker.hide();
}
 } 
  }

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }

  };

  request.open('GET', url, true);
  request.send(null);
}

function doNothing() {}

//]]> 
```

这是复选框

```
<p>
    <label>
    <input type="checkbox" id="01"  onclick="toggleGroup('01')"CHECKED/>
    </label>
  01 
  <label>
  <input type="checkbox" id="02"  onclick="toggleGroup('02')" CHECKED/>
  </label>
  02 
  <label>
  <input type="checkbox" id="03"  onclick="toggleGroup('03')" CHECKED/>
  </label>
  03 
  <label>
  <input type="checkbox" id="04" onclick="toggleGroup('04')" CHECKED/>
  </label>
  04</p> 
```

它显示所有标记，但如果单击“复选框”，它不会按组显示标记。

# python - 如何通过迭代现有的 OSM 数据表在 PostgreSQL 中生成新表

> ID：14798130
> 
> 赞同：1
> 
> 时间：2013-02-10T13:16:42.013
> 
> 标签：python, postgresql, psycopg2, openstreetmap, tilemill

我有一个由伦敦的 OSM 地图数据组成的 PostgreSQL 数据库。我使用 osm2psql 导入了这些数据。我想：

*   遍历planet_osm_line 表中的每一行
*   将线条分成单独的线段
*   计算每个线段的值（在本例中将值设置为 0.5）
*   将线段作为新条目写入新表。

下面的 python 代码似乎实现了这一点，但有一个问题。它似乎只是访问整个数据库的一小部分。

```
import psycopg2

conn = psycopg2.connect("dbname=db user=username")
maincur = conn.cursor()
readcur = conn.cursor()
writecur = conn.cursor()

maincur.execute("DROP TABLE lines_red")
maincur.execute("CREATE TABLE lines_red (osm_id bigint, name text, way geometry, value float);")

maincur.execute("SELECT osm_id, ST_NPOINTS(way) FROM planet_osm_line")
    for record in maincur:
    pointlist = []
    for i in range(0,record[1]):
        readcur.execute("SELECT ST_ASTEXT(ST_POINTN(way, %s+1)) FROM planet_osm_line WHERE osm_id=%s;",(i,record[0]))
        output = readcur.fetchone()
        pointlist.append(output[0])
    for i in range(0,record[1]-1):  
        if pointlist[i+1] != None:
            value = 0.5
            writecur.execute("INSERT INTO lines_red (name, way, value) VALUES ('testname', ST_Makeline(%s, %s), %s);", (pointlist[i],pointlist[i+1],value))

conn.commit()
maincur.close()
readcur.close()
writecur.close()
conn.close() 
```

为了说明下图显示了以灰色显示的完整planet_osm_line 表和以红色显示的查询结果。红线应该覆盖整个地图，因为代码应该遍历整个planet_osm_line 表。我正在使用 tilemill 来显示结果。

![Result of trying to iterate over the entire planet_osm_line table](../Images/4f9a121c0bf122b25a4375d9015ff2e9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:43:29.523

The problem in this case was with my use of TileMill.

When a new layer is created the default setting for its extent is to pre-calculate based on the database table used as input. This means that the layer will only ever be the size of the dataset with which it was initially created.

In this case I had iterated over a subset of my data as a test of my code and the extents were calculated based on the results. When I iterated over the whole data set the code iterated over the entire database but only displayed the results within the previously calculated constraints.

The solution is to create a new layer or set the extents setting in the layer to 'dynamic' rather than 'pre-calculate'

# uitableview - 在一个视图控制器中编程按钮按下，以在不同的表视图控制器中加载和保存单元格

> ID：14798136
> 
> 赞同：0
> 
> 时间：2013-02-10T13:17:29.450
> 
> 标签：uitableview, core-data, ios6, xcode4.5

在我的应用程序中，我有许多视图控制器，它们都有一个收藏按钮。按下收藏按钮时，我希望将有关视图控制器的一些信息保存在不同表视图控制器中的单独表视图中。

这是我的第一个 IOs 应用程序，即使在阅读了 Core Data 之后，我仍然对如何前进感到有些茫然。

我将如何实现这样的功能？

感谢您帮助新手！

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T05:35:02.120

要在本地存储信息，您可以使用**NSUserDefaults**类。

在最喜欢的按钮操作方法上，使用 NSUserDefaults 将视图控制器名称保存在 NSMutableArray 中

```
 -(IBAction)btnFavouriteClick:(id)sender {

      NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

      //Get favorited views array (new array will be created if it doesn't  exist)    
      NSMutableArray *favoriteviews = [defaults mutableArrayValueForKey:@"favorite_views_key"];

      //Add current view name to the array
      [favoriteviews addObject:@"viewcontroller_name"];

      //Add the array back in NSUserDefaults
      [defaults setObject:favoriteviews forKey:@"favorite_views_key"];

      //Save NSUserDefaults
      [defaults synchronize];
    } 
```

**您可以使用favorite_views_key**检索值并在 UITableView 中显示它们

```
 NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];  

    //Get favorited views array
    NSMutableArray *favoriteviews = [defaults mutableArrayValueForKey:@"favorite_views_key"]; 
```

favoriteviews 是所有收藏视图的数组。

# android - 多线程 UI：exceptionininitializererror 和运行时异常 android

> ID：14798138
> 
> 赞同：0
> 
> 时间：2013-02-10T13:17:31.900
> 
> 标签：android, multithreading, android-asynctask, runtimeexception

我正在尝试制作多线程，但我在少数智能手机（SGS2）上得到了这个堆栈跟踪：

```
java.lang.ExceptionInInitializerError
at com.android.bordeaux.code.model.AnnouncersContainer.setLoudArrayFromJSON_online(AnnouncersContainer.java:68)
at com.android.bordeaux.code.SplashscreenActivity_Second$1.run(SplashscreenActivity_Second.java:55)
Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
at android.os.Handler.<init>(Handler.java:121)
at android.os.AsyncTask$InternalHandler.<init>(AsyncTask.java:421)
at android.os.AsyncTask$InternalHandler.<init>(AsyncTask.java:421)
at android.os.AsyncTask.<clinit>(AsyncTask.java:152)
... 2 more 
```

这是我的主要活动（启动画面），它在几秒钟内等待以等待我的 asynctask 完成：

```
 public class SplashscreenActivity_Second extends Activity 
        {       
            @Override
            public void onCreate(Bundle savedInstanceState) 
            {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.splashscreen_second);

                // thread
                Thread splashThread = new Thread()
                {
                    @Override
                    public void run()
                    {
                        try
                        {
                            int waited = 0;

                            if (isInternetOn())
                            {
// Here I'm making my asynctask !!
AnnouncersContainer.setLoudArrayFromJSON_online(getApplicationContext());
                                while (waited < 5000)
                                {
                                    sleep(50);
                                    waited += 40;
                                }
                            }
                            else
                            {                       
                                AnnouncersContainer.setLoudArrayFromXML_local(getApplicationContext());
                                while(waited < 5000)
                                {
                                    sleep(50);
                                    waited += 60;
                                }
                            }
                        }
                        catch( InterruptedException e )
                        {
                            e.printStackTrace();
                        }
                        finally
                        {
                            Intent intent_to_tabhost = new Intent(SplashscreenActivity_Second.this, MyTabActivity.class);
                            startActivity(intent_to_tabhost);
                            finish();
                        }
                    }
                };
                splashThread.start();
            }
} 
```

这是我的异步任务：

```
public class DownloadAnnouncers extends AsyncTask<Void, Integer, Boolean>
{
    public static Boolean loadFinished = false;

    //JSON variables..

    private static String url = null;

    Context context;

    public DownloadAnnouncers(Context context) 
    {
        this.context = context;
    }

    @Override
    protected void onPreExecute() 
    {
        super.onPreExecute();
    }

    protected Boolean doInBackground(Void... params) 
    {

    // fine retrieving all my JSON data in a global array..

    }

    @Override
    protected void onPostExecute(Boolean downloadedArray) 
    {
        super.onPostExecute(downloadedArray);
    }
} 
```

我知道问题是我在 UI 中进行多线程处理，但有人可以告诉我如何删除我的循环线程并将其替换为我的 Asynctask 的 onPostExecute() 方法？（最好等待 asynctask 完成而不是等待..）

或者可以帮助我用多线程纠正这个错误..

编辑 ：

我的异步任务：

```
public class DownloadAnnouncers extends AsyncTask<Void, Integer, Boolean>
    {
        public static Boolean loadFinished = false;

        //JSON variables..

        private static String url = null;

        Context context;

        public DownloadAnnouncers(Context context) 
        {
            this.context = context;
        }

        @Override
        protected void onPreExecute() 
        {
            super.onPreExecute();
        }

        protected Boolean doInBackground(Void... params) 
        {

        // fine retrieving all my JSON data in a global array..

        }

        @Override
        protected void onPostExecute(Boolean downloadedArray) 
        {
            super.onPostExecute(downloadedArray);
        Intent intent_to_tabhost = new Intent(context, MyTabActivity.class);
        intent_to_tabhost.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(intent_to_tabhost);
        }
    } 
```

但是现在如果我按下取消按钮，我将返回到我的启动画面活动.. 我不能在 onPostExecute 方法中执行 ctx.finish() ..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:50:05.140

正如您的错误消息所说，您`Handler`不能在未调用的 Thread 内部创建：`Looper.prepare()`

> 无法在未调用 Looper.prepare() 的线程内创建处理程序

处理程序是在 中创建的`AsyncTask`，因此您一开始可能不会看到它。

如果您想保持代码原样，您可以通过将 AsyncTask 的创建移到自定义线程之外来修复它。

但是，您无需创建线程，您只需在 ui 线程中创建 AsyncTask（它将在自己的线程上运行，因此在工作时不会锁定您的手机），然后执行您想要的任何操作任务在 - 方法中完成`onPostExecute`。

```
class ExampleAsync extends AsyncTask<Void, Integer, Boolean>
{
    public static Boolean loadFinished = false;
    //JSON variables..
    private static String url = null;
    Context context;

    public DownloadAnnouncers(Context context){
        this.context = context;
    }

    protected Boolean doInBackground(Void... params){
        // fine retrieving all my JSON data in a global array..
    }

    @Override
    protected void onPostExecute(Boolean downloadedArray){
        Intent intent_to_tabhost = new Intent(context, MyTabActivity.class);
        startActivity(intent_to_tabhost);
    }
} 
```

在您的活动中：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splashscreen_second);
    AsyncTask myTask = new ExampleAsync(this);
    myTask.execute();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:53:57.307

不要等待 asyncTask ，而是使用 onPostExecute ，它仅在任务完成后在 UI 线程上调用。

如果活动被破坏，您还应该取消任务（例如，如果用户在显示初始屏幕时按下了后退按钮）。

# android - 在子进程完成后更新列表

> ID：14798139
> 
> 赞同：0
> 
> 时间：2013-02-10T13:17:36.693
> 
> 标签：android

该应用程序的主要活动是显示一个列表。用户单击列表中的某些内容会打开一个编辑屏幕。完成后，编辑屏幕关闭 - 我希望使用编辑屏幕上发生的任何内容更新原始列表。我将数据保存到一个文件中——我可以再次读取它来更新列表。但是我不知道在哪里插入重新读取的代码。

在 ListActivity - 当列表再次获得焦点时调用什么方法？

这是我的主要列表活动代码：

创建视图：

```
@Override
       public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Inflate our UI from its XML layout description.
    setContentView(R.layout.my_activity);

   list=new Data_List(this);  // my data reading class
   list.read_data();           // reads from a file

  load_dynamic_list();

} 
```

加载数据：

```
private void load_dynamic_list(){
             ladapter=new         
list_adapter(this,android.R.layout.simple_list_item_1,list);  // the type is actually  ignored                                                                                  // getview function in list_adapter handles everything
          setListAdapter(ladapter);
         this.getListView().invalidate();

} 
```

选择了一些东西：

```
protected void onListItemClick (ListView l, View v, int position, long id){
  int a;
   intent = new Intent(this,Editing.class);

        intent.putExtra("New_entry",0);
        intent.putExtra("Entry",position);

        //start the second Activity
        this.startActivity(intent);

 } 
```

在编辑功能中，我这样结束：

```
 @Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    if(v.getId() == R.id.button_save){
        do_save();  // saves to a file

  //  I want something like: caller.getListView().invalidate();

         finish();
                    }
    if(v.getId() == R.id.button_cancel){
        finish();
                    }
} 
```

编辑完成后，我可以覆盖或调用什么方法？在这一点上，我想`read_data()`然后再`load_dynamic_list()`一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:20:13.337

您必须使用 AsyncTask。

首选网址：

[http://steveliles.github.com/android_s_asynctask.html](http://steveliles.github.com/android_s_asynctask.html) [http://www.vogella.com/articles/AndroidPerformance/article.html](http://www.vogella.com/articles/AndroidPerformance/article.html)

举个例子：

[http://labs.makemachine.net/2010/05/android-asynctask-example/](http://labs.makemachine.net/2010/05/android-asynctask-example/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:41:06.923

```
 @Override
 protected void onResume() {
      super.onResume();

     list=new Data_List(this);
     list.read_data();
           load_dynamic_list();    // becuase whatever was edited needs to be reread. 

} 
```

# c# - 在运行时根据记录更改图像名称，然后在asp.net中显示？

> ID：14798150
> 
> 赞同：0
> 
> 时间：2013-02-10T13:19:05.863
> 
> 标签：c#, asp.net

我有一个关于在运行时更改图像名称的问题，之后我想显示图像。请阅读以下内容：

我的 Web 应用程序中有两个页面**（state.aspx 和 images.aspx）**。在状态页面上，我列出了所有状态。假设**newyork**是州，当我点击**newyork**时。它转到带有状态名称的**查询字符串的****images.aspx**页面。

 **现在我想根据所选状态更改**“images.aspx”页面上所有图像的名称。**

**例如 - myimage.jpg 到 myimage-newyork.jpg**

现在的主要问题是，如果我要更改图像的名称。应该存在同名的图像。

**我怎样才能做到这一点？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T19:37:57.813

自从我这样做以来已经有一段时间了，但我相信您想要做的是更改标题：

```
 Response.AddHeader("content-disposition","myimage.jpg"));
    Response.ContentType = "image/jpeg"; 
```**

# express - Express + Jade 给我语法错误

> ID：14798152
> 
> 赞同：1
> 
> 时间：2013-02-10T13:19:12.620
> 
> 标签：express, pug

我是第一次使用 Jade + Express，只是在玩弄它看看能做什么。

我正在使用 Brian Fords[种子应用程序](http://briantford.com/blog/angular-express.html)作为我学习的基础，同时也是第一次使用 Jade（模板引擎）。

但是，当我尝试写出一个新`index.jade`文件时，Express 不断给我语法错误或缩进标记错误。

这是我试图使用的代码。

```
doctype 5
   html(lang="en" ng-app="myApp")
   head
     meta(charset='utf8')
     base(href='/')
     link(rel='stylesheet' href='/css/app.css')
     title= pageTitle
   body
     block body 
```

任何帮助，将不胜感激 ：）

*编辑*

给出的错误是：

```
500 Error: /Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/views/layout.jade:2 1| doctype 5 > 2| html(lang="en" ng-app="myApp") 3| head 4| meta(charset='utf8') 5| base(href='/') unexpected token "indent"
1| doctype 5
> 2| html(lang="en" ng-app="myApp")
3| head
4| meta(charset='utf8')
5| base(href='/')
unexpected token "indent"
at Object.Parser.parseExpr (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/parser.js:241:15)
at Object.Parser.parse (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/parser.js:134:25)
at Object.Parser.parse (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/parser.js:140:24)
at parse (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/jade.js:100:62)
at Object.exports.compile (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/jade.js:163:9)
at Object.exports.render (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/jade.js:215:17)
at View.exports.renderFile [as engine] (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/jade/lib/jade.js:243:13)
at View.render (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/express/lib/view.js:75:8)
at Function.app.render (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/express/lib/application.js:505:10)
at ServerResponse.res.render (/Users/Keva161/Documents/Web Dev/Webapps/Node/angular-express-seed/node_modules/express/lib/response.js:717:7) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:25:01.997

我认为玉将您的 html 解释为在文档类型中。而不是！

```
doctype 5
html(lang="en" ng-app="myApp")
 head
   base(href='website.domain/url')
   link(rel='stylesheet', href='css/app.css', type='text/css')
   title pageTitle
 meta(http-equiv="content-type", content="#{contentType}; charset=UTF-8")
 body 
```

也不确定`block body`是为了什么？！`block body`当您使用另一个视图文件并将文本附加到布局文件时，将使用AFAIK 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-25T02:42:37.373

> html(lang="en" ng-app="myApp")

您可能需要添加一个逗号，像这样

html(lang="en", ng-app="myApp")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-30T14:45:34.940

你的代码应该是这样的

```
doctype html
html(lang="en" ng-app="myApp")
    head
        meta(charset='utf8')
        base(href='/')
        link(rel='stylesheet' href='/css/app.css')
        title= pageTitle
    body
        block body 
```

1.  你不应该在 doctype 中缩进 html 标签
2.  你必须在 html 标签内缩进 body 和 head 标签

# symfony - Symfony2 Doctrine 加入实体

> ID：14798154
> 
> 赞同：0
> 
> 时间：2013-02-10T13:19:18.180
> 
> 标签：symfony, annotations, doctrine

我有一个具有下一个连接的实体：

```
class blogComment
{
    ....

    /**
     * @ORM\OneToMany(targetEntity="BlogComment", mappedBy="replyTo")
     */
    protected $replies;

    ....
} 
```

现在我成功地得到了所有的回复。但我只想得到：`where active = true`

怎么做？

好吧，如果你们建议在控制器中通过查询获取评论，如何构建嵌套数组以获得如下结果：

![嵌套评论](../Images/92f6b417935c43cbff16bfdf8e5f5c4e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-18T19:43:12.170

为了解决您只需要主动回复的部分，有几个选项：

1）在存储库中使用一些自定义 DQL：

```
$dql = 'SELECT bc FROM BlogComment bc WHERE bc.replyTo = :id AND bc.active = :active';
$q = $em->createQuery($dql)
    ->setParameters(array('id' => $id, 'active' => true)); 
```

2）`ArrayCollection::filter()`在吸气剂中使用：

```
public function getReplies()
{
    return $this->replies
        ->filter(function ($reply) {
            return $reply->isActive();
        })
        ->toArray();
} 
```

3）在getter中使用`ArrayCollection::matching()`（[Collection Criteria API ）：](http://docs.doctrine-project.org/en/latest/reference/working-with-associations.html#filtering-collections)

```
use Doctrine\Common\Collections\Criteria;

// ...

public function getReplies()
{
    $criteria = new Criteria::create()
        ->where(Criteria::expr()->eq('active', true));

    return $this->replies
        ->matching($criteria)
        ->toArray();
} 
```

4）使用[过滤器](https://doctrine-orm.readthedocs.org/en/latest/reference/filters.html)。这些可以将 where 子句添加到查询中，而不管该查询是在哪里生成的。请参阅[文档](https://doctrine-orm.readthedocs.org/en/latest/reference/filters.html)。

如果您希望能够在单个查询中获取整套回复、嵌套和所有回复，则需要实现某种“嵌套集”功能的“树”。我建议您查看[l3pp4rd/DoctrineExtensions的](https://github.com/l3pp4rd/DoctrineExtensions)[Tree](https://github.com/l3pp4rd/DoctrineExtensions/blob/master/doc/tree.md)行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:25:49.943

[http://doctrine-orm.readthedocs.org/en/latest/reference/dql-doctrine-query-language.html](http://doctrine-orm.readthedocs.org/en/latest/reference/dql-doctrine-query-language.html)

无论您在何处获取博客评论以显示它们（可能在控制器上），您都需要自定义查询以便只提取活动回复。就像是：

```
$query = $em->createQuery('SELECT b FROM blogComment b JOIN b.replies r WHERE r.active = :active');
$query->setParameter('active', true);
$blogComments = $query->getResult(); 
```

编辑：

对于嵌套回复的新要求，您需要指定评论实体与其父评论之间的关系。

# objective-c - 使用完成块保存到 docs 目录？

> ID：14798155
> 
> 赞同：0
> 
> 时间：2013-02-10T13:19:19.867
> 
> 标签：objective-c

我有一种将图像保存到文档目录的方法。看起来像这样：

```
+(void)saveImageInDocumentsDirectory:(UIImage *)image withImageName:(NSString *)name { 
    NSArray * paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString * basePath = ([paths count] > 0) ? [paths objectAtIndex:0] : nil;
    NSData * binaryImageData = UIImagePNGRepresentation(image);
    [binaryImageData writeToFile:[basePath stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.png",name]] atomically:YES];  
} 
```

有没有办法为此添加一个完成块，它将在保存图像时运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:03:15.093

我认为没有完成块。根据文档，返回值表示

**返回值** *如果操作成功，则返回 YES，否则返回 NO。*

对我来说，这意味着该方法会阻塞调用它的线程，直到它完成。如果您的保存需要一些时间，您可以使用 Grand Central Dispatch 在单独的线程中执行操作。当您的方法返回时，您可以调用一个方法用作完成块。寻找`dispatch_async`，你应该找到很多。

这里也有很多关于 SO 的例子。例如： [处理块、完成处理程序、dispatch_async 与 dispatch_sync](https://stackoverflow.com/questions/9510225/dealing-with-blocks-completion-handlers-dispatch-async-vs-dispatch-sync)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T18:11:19.033

您可以向您的方法添加一个表示完成块的附加参数。但是，没有意义。这里涉及的代码都不是异步的。当您调用该`saveImageInDocumentsDirectory:withImageName:`方法时，当方法返回时，写入已经完成。因此，添加对完成块的支持不会给您带来任何好处。

因此，不要添加对完成块的支持并进行如下调用：

```
[Whatever saveImageInDocumentsDirectory:someImage withImageName:@"SomeName" completion:^{
    // some completion code
}]; 
```

你只需要这样做：

```
[Whatever saveImageInDocumentsDirectory:someImage withImageName:@"SomeName"];
// some completion code here 
```

# android - 对齐到屏幕右侧，有边距 Android

> ID：14798156
> 
> 赞同：3
> 
> 时间：2013-02-10T13:19:27.777
> 
> 标签：android, android-layout, android-linearlayout, android-relativelayout

我在 RelativeLayout 中有一个 Linearlayout，我试图用边距与屏幕的最右侧对齐。例子：

![在此处输入图像描述](../Images/0e2021c3c62881274b527f38189bcebe.png)

我应该如何修改 LinearLayout 的属性来实现这一点？谢谢

这是 XML 文件（应该向右对齐的 LinearLayout 的名称是 slide_right）：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:gravity="top"
    tools:context=".MainActivity" >

    <WebView android:id="@+id/webview"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"/>

     <LinearLayout
        android:id="@+id/slide_left"
        android:layout_width="400dp"
        android:layout_height="550dp"
        android:layout_marginLeft="-367dp"
        android:layout_marginTop="150dp"
        android:background="@drawable/left_slide"
        android:orientation="vertical" >

    </LinearLayout>

    <LinearLayout
        android:id="@+id/slide_right"
        android:layout_width="400dp"
        android:layout_height="550dp"
       android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:layout_marginRight="-30dp"
        android:orientation="horizontal" 
        android:background="@drawable/right_slide">

    </LinearLayout>

    <LinearLayout
        android:id="@+id/header_linear_l"
        android:layout_width="match_parent"
        android:layout_height="80dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:orientation="horizontal" >

        <ImageButton
            android:id="@+id/mapbt"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/mapbt" />

        <ImageButton
            android:id="@+id/profilebt"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/profilebt" />

        <ImageButton
            android:id="@+id/settingsbt"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/settingsbt" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >

                <ImageButton
                    android:id="@+id/optionalbt"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:background="@drawable/optionbt" />

                <ImageButton
                    android:id="@+id/lvlbt"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:background="@drawable/levelbt" />
            </LinearLayout>

            <ProgressBar
                android:id="@+id/experiencebar"
                style="?android:attr/progressBarStyleHorizontal"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" />

        </LinearLayout>

    </LinearLayout>

    <ImageButton
        android:id="@+id/Attack_Button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/slide_left"
        android:layout_marginBottom="129dp"
        android:layout_marginLeft="36dp"
        android:layout_toRightOf="@+id/slide_left"
        android:src="@drawable/ic_launcher_old"
        android:visibility="invisible" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-10T15:19:13.730

改变你的`Relative layout's Property`

从

```
 android:layout_width="wrap_content" 
```

到

```
 android:layout_width="match_parent" 
```

就是这样......（肯定我已经测试过了，**见下面的快照**）

![在此处输入图像描述](../Images/55e1b1c475021201d1dbb1ab35994094.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:28:54.527

请参阅以下代码

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/your_relative_layout_id"        
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white" >

    <LinearLayout
        android:id="@+id/your_linear_layout_id"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:layout_marginRight="-30dip"
        android:background="#e42c2a"
        android:orientation="horizontal" >
    </LinearLayout>

</RelativeLayout> 
```

这里

```
android:layout_alignParentRight="true"
android:layout_centerVertical="true"
android:layout_marginRight="-30dip" 
```

对你有用。

# javascript - 工具提示脚本。需要更正代码

> ID：14798157
> 
> 赞同：0
> 
> 时间：2013-02-10T13:19:46.830
> 
> 标签：javascript, jquery

```
$(function() {
    $('.challenge').tooltip({html: true, trigger: 'hover'});

    $('.challenge').mouseover(function(){
    var that = $(this);
    var ajaxQueue = $({
    url: "<?=base_url();?>/ajax/challenge_tip",
     type: 'POST',
     cache: true,
     data: {
      'idd': $(this).attr("rel"),
     },
     dataType: 'json',
       success: function(challenge_j) {
         that.tooltip('hide')
        .attr('data-original-title', challenge_j)
        .tooltip('fixTitle')
        .tooltip('show');
       }
  });

  $.ajaxQueue = function(ajaxOpts) {

    var oldComplete = ajaxOpts.complete;

    ajaxQueue.queue(function(next) {

      ajaxOpts.complete = function() {
        if (oldComplete) oldComplete.apply(this, arguments);

        next();
      };

      $.ajax(ajaxOpts);
    });
  };
});
}); 
```

这是我第一次接触 js，我需要一些帮助。对于工具提示，我使用引导工具提示。当光标悬停在链接上时，脚本将发布数据发送到控制器并接收回调数据。在第一个悬停脚本中接收数据，但没有弹出工具提示，只有第二个悬停。我该如何解决？

还有一个问题。脚本能否仅在第一次鼠标悬停时发送请求，而下一次悬停将使用缓存中的信息？

对不起我的英语;D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:07:24.410

为 ajax 查询创建标志。

```
var isTooltipTextEmpty = true;

$('.challenge').mouseover(function(){

    if(isTooltipTextEmpty) {

     ...add ajax query here)

    }

} 
```

当ajax查询像这样准备好时，您需要触发工具提示显示事件

```
.success(data) {

     $('.challenge').show();
     isTooltipTextEmpty = false; //prevents multiple ajax queries

} 
```

在此处查看更多信息：[引导工具提示](http://twitter.github.com/bootstrap/javascript.html#tooltips)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T10:52:52.810

跨域测试难

这是我认为你需要的

```
$(function() {
  $('.challenge').tooltip({html: true, trigger: 'hover'});

  $('.challenge').mouseover(function(){
    var that = $(this);
    $.ajax({
     url: "<?=base_url();?>/ajax/challenge_tip",
     type: 'POST',
     cache: true,
     data: {
      'idd': $(this).attr("rel"),
     },
     dataType: 'json',
       success: function(challenge_j) {
         that.tooltip('hide')
        .attr('data-original-title', challenge_j)
        .tooltip('fixTitle')
        .tooltip('show');
       }
    });
  });
}); 
```

# visual-studio-2010 - Visual Studio 的调试器/交互式窗口如何在 .NET 中转储 COM 对象的属性？

> ID：14798159
> 
> 赞同：10
> 
> 时间：2013-02-10T13:20:06.393
> 
> 标签：visual-studio-2010, com, com-interop, linqpad, arcobjects

在这个[相关问题](https://stackoverflow.com/q/14716871/386205)中，我注意到 Visual Studio 的调试器能够枚举[`System.__ComObject`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getobjectforiunknown.aspx)引用的属性，这是“当包装器类型不明确时使用的隐藏类型”——例如，当你从另一个获取它时获得的对象类型COM 对象，不要自己实例化它：

![COM 对象调试视图](../Images/29deed85e9a9f60eb49f59298c7d4369.png)

此外，如果您只是将 COM 对象的标识符写入即时窗口，它的属性和值也会被类似地转储：

![COM 对象立即窗口](../Images/1ca5ee025ba650416b71d1d0a612d78b.png)

[请注意，这与 VS2010 的“动态视图](http://blogs.msdn.com/b/habibh/archive/2009/09/22/debugging-a-com-object-runtime-callable-wrapper-with-visual-studio-2010.aspx)”是分开的，我相信它使用[`IDispatch`](http://en.wikipedia.org/wiki/IDispatch)和 COM 反射来枚举 COM 对象的属性，而不使用 PIA 和 .NET 反射。我正在使用的对象*没有*实现`IDispatch`（它们也没有为此实现[`IProvideClassInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687303%28v=vs.85%29.aspx)），因此，“动态视图”无法获取有关它们的任何信息：

![动态视图](../Images/8674e69ff50eff971d3521978debff2d.png)

有趣的是，[SharpDevelop](http://www.icsharpcode.net/opensource/sd/)的调试器无法列出`System.__Comobject`s 的成员（例如`point.Envelope`），只能列出强类型的 RCW（例如`point`）。

![SharpDevelop 调试器](../Images/bf9abe52b0de778977faff1c1193a7b0.png)

那么 Visual Studio 是如何做到的呢？

我相信在这种情况下，这是因为主互操作程序集存在这些对象支持的接口的定义，并且 Visual Studio 很可能使用反射来枚举支持的接口和属性。那准确吗？如果是这样，它是如何工作的？

首先，它如何访问 PIA？它只查看当前加载的 PIA 还是动态加载它们（如果是，如何加载）？它如何确定枚举属性的接口，其中可以有很多？它似乎只使用一个，不一定是第一个。从我正在使用的 API的[文档](http://help.arcgis.com/en/sdk/10.0/arcobjects_net/conceptualhelp/index.html#//000100000195000000)[`IUnknown`](http://en.wikipedia.org/wiki/IUnknown)（ArcObjects）来看，这些对象的默认接口是，因此它也不仅仅是使用默认接口。

在屏幕截图的示例中，它枚举成员的接口是[`IEnvelope`](http://help.arcgis.com/en/sdk/10.0/arcobjects_net/componenthelp/index.html#//002m00000169000000)接口，它继承自[`IGeometry`](http://help.arcgis.com/en/sdk/10.0/arcobjects_net/componenthelp/index.html#/IGeometry_Interface/002m000001rm000000/)接口。VS2010怎么知道不枚举成员`IGeometry`，在我的测试中，如果你只枚举PIA中的所有接口类型，它首先出现？发生了一些非常聪明的事情，或者我错过了一些明显的事情？

我问的原因是，如果[LINQPad](http://www.linqpad.net/) 的开发人员知道 VS 是如何做到的，他[似乎愿意实现相同的功能。](https://stackoverflow.com/q/14716871/386205)因此，这里的一个好的答案可以大大有助于改进这个非常流行的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:49:15.660

这是如何做到的：

*   获取 COM 对象的`IDispatch`（替代可能的路径是`IDispatchEx`）
*   获取类型库的引用——[`IDispatch::GetTypeInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221571%28v=vs.85%29.aspx)
*   加载类型库并枚举属性
*   查询真实对象以获取已发现属性的值

其他增强选项适用：查询`IPersist*`接口系列或`IProvideClassInfo`获取对象类型库的引用并发现属性。

# scala - 缩写@specialized

> ID：14798160
> 
> 赞同：4
> 
> 时间：2013-02-10T13:20:07.227
> 
> 标签：scala

我记得 PaulP 展示了一个很酷的技巧来缩写重复的长`@specialized`序列，但我再也找不到原来的帖子了。就像我有

```
trait Foo[@specialized(Int, Float, Double, Long, Char, Boolean) A]
trait Bar[@specialized(Int, Float, Double, Long, Char, Boolean) A] 
```

有可能以某种方式对其进行别名...

```
type SpecDef = ???
trait Foo[SpecDef ??? A]
trait Bar[SpecDef ??? A] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T13:26:40.790

答案在对象中`scala.Specializable`：

```
import scala.{specialized => spec, Specializable => Spec}
final val MySpec = new Spec.Group((Int, Float, Double, Long, Char, Boolean))

trait Foo[@spec(MySpec) A]
trait Bar[@spec(MySpec) A] 
```

# c# - App Harbor 上的 Twitter Bootstrap（MVC 4 包）

> ID：14798171
> 
> 赞同：0
> 
> 时间：2013-02-10T13:21:12.947
> 
> 标签：c#, javascript, asp.net-mvc, twitter-bootstrap, appharbor

我刚刚使用示例 mvc 4 nuget 包将示例 twitter 引导应用程序上传到 app Harbor，并且在单击示例登录页面顶部的任何按钮时出现以下 javascript 错误：

```
Uncaught SyntaxError: Unexpected token * 
```

在本地一切正常，我检查了我在本地获得的所有文件都在我的 bitbucket 存储库中。

所有文件都被请求并正确返回，状态为 200。

我已经在 chrome 和 IE 中尝试过这个。同样的问题。

任何人都知道为什么这可能发生在 APPHB 而不是本地？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T16:43:50.553

好的，我找到了这个问题的答案。该问题的概要可以在以下位置找到：

[http://bugs.jquery.com/ticket/13274](http://bugs.jquery.com/ticket/13274)

这与缩小器如何处理有关`//@ sourceMappingURL=jquery.min.map`

这些“注释”对于调试缩小的 js 文件很有用，因为它们为您提供了指向未缩小版本的链接，但它们似乎会导致缩小器出现问题。

你有两个选择来解决这个问题。要么完全删除线条。或者使用如下块注释来转义它们：

```
/*
//@ sourceMappingURL=jquery.min.map
*/ 
```

而不是默认值：

```
//@ sourceMappingURL=jquery.min.map 
```

# .net - 如何使用 C# 2010 中的删除按钮删除无界 DataGridView 中的选定行和整行？

> ID：14798172
> 
> 赞同：0
> 
> 时间：2013-02-10T13:21:16.523
> 
> 标签：.net

在我的项目中，我使用的是 Unbounded DataGridView 。在其中我将第一行设为 CheckBoxColumn With Header Check Box 。我让我的最终用户在 DataGridView 中选择单行或多行或整行，并且可以在需要时将其删除。但真正的问题是当我选择所有行并单击删除时，它会删除整行，而当我选择单行时，它会执行相同的操作。

下面是我的删除按钮代码。

```
private void BtnDcDelete_Click(object sender, EventArgs e)
{
    do
    {
        foreach (DataGridViewRow row in dataGridViewEx1.Rows)
        {
            try
            {
                dataGridViewEx1.Rows.Remove(row);
            }
            catch (Exception) { }
        }
    } while (dataGridViewEx1.Rows.Count > 1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:39:24.143

试试这个：

```
//foreach (DataGridViewRow row in dataGridViewEx1.Rows)
foreach (DataGridViewRow row in dataGridViewEx1.SelectedRows) { 
... 
```

# java - 如何在匿名类中为返回 void 的方法返回字符串

> ID：14798177
> 
> 赞同：0
> 
> 时间：2013-02-10T13:21:50.513
> 
> 标签：java

我有点困惑。我有以下内容：

```
public static String showInputDialog() {
   Form frm = new Form();
   final Command cmd = new Command("Ok");
   final TextField txt = new TextField("Enter the text", null, 1024, 0);
   frm.addCommand(cmd);
   frm.append(txt);
   frm.setCommandListener(new CommandListener() {

       public void commandAction(Command c, Displayable d) {
            if (c == cmd) {
                return txt.getString(); // Error !!
            } else {
                return null; // Error !!
            }
       }
   });
} 
```

如您所见，我想返回输入对话框字符串，而匿名类方法应该返回 void。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:25:22.247

这不像您预期​​的那样工作。

我看到已经有一些解决方案，但我觉得对实际发生的事情进行更多讨论可能会有所帮助。

当您调用`frm.setCommandListener(new CommandListener() { ... })`代码时，代码会向用户显示一个对话框，她可以在其中输入一些文本并提交，但代码不会停止并等待用户完成。相反，代码继续执行 - 不产生结果。只有在用户完成输入并提交后，您才会被回调以处理结果 - 这可能会在很久以后发生，或者根本不会发生。

我猜你有一些代码调用这个方法，比如：

```
public void someMethod(int foo, String bar) {

   [...]
   String result = MyInputForm.showInputDialog();
   // do something with the result
   System.out.println("hey, got a result "+ result);
   [...]
} 
```

相反，您需要重新组织它。首先编写一个帮助类来处理结果：

公共静态类 MyCallBack {

```
 public MyCallBack(... /* here pass in what you need to process the result*/) {
      ... remember necessary stuff in instance variables
   }

   public void processResult(String result) {
      // do something with the result
      System.out.println("hey, got a result "+ result);
      [...]
   } 
```

}

然后调用方只是：

```
public void someMethod(int foo, String bar) {

   [...]
   MyInputForm.showInputDialog( new MyCallBack(... here pass in stuff ...) );
   [...]
} 
```

并且实际代码必须更改为：

```
public static String showInputDialog(final MyCallBack callback) {
   Form frm = new Form();
   final Command cmd = new Command("Ok");
   final TextField txt = new TextField("Enter the text", null, 1024, 0);
   frm.addCommand(cmd);
   frm.append(txt);
   frm.setCommandListener(new CommandListener() {

       public void commandAction(Command c, Displayable d) {
            if (c == cmd) {
                return callback.processResult(txt.getString());
            } else {
                return; // or just omit the else part
            }
       }
   });
} 
```

两个问题：

*   这种编程方式感觉很倒退，但它确实是它的工作方式。
*   感觉不对的是我需要在`CommandListener`. 这真的不是很好的风格。我希望它可以改进，但由于我没有看到完整的代码（无论如何这将是太多的信息），我不得不把它留给你来改进代码并摆脱混乱。虽然我觉得你想要一个模块化的、可重用的输入对话框助手，但这可能不是最好的方法；更好地定义`Form`,`TextField`并`Command`直接在您需要结果并使其运行的位置。让它在运行后的第二步中可重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:27:51.840

鉴于[CommandListener 是固定](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/CommandListener.html)的，2 个可能的选项是

在外部类中使用类成员变量并分配给该变量

```
private static String myText;
...

public static String showInputDialog() {
   ...
   frm.setCommandListener(new CommandListener() {

       public void commandAction(Command c, Displayable d) {
            if (c == cmd) {
                myText = txt.getString(); 
            } else {
                myText = null;
            }
       }
   });
} 
```

或创建您的具体实现`CommandListener`并将返回值设置为新实现的属性

我会看看使这个片段中的方法/变量成为*非静态的*......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:31:45.690

如果您使用 String 执行某些操作或将其存储在某处，则不需要返回它，例如：

```
static String result;

public String commandAction(Command c, Displayable d) {
    if (c == cmd) {
        result = txt.getString();
    } else {
        result = null;
    }
} 
```

尽管您将需要处理线程问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T13:45:16.417

You cant return the string because you dont know when the listener will be called. You can do something with it once you have the string though.

```
public static void showInputDialog() {

   StringHandler sh = new StringHandler();

   frm.setCommandListener(new CommandListener() {

       public void commandAction(Command c, Displayable d) {
            if (c == cmd) {
                sh.handle(txt.getString()); 
            } else {
                sh.handle(null);
            }
       }
 });}

public class StringHandler {
    public void handle(String s){
        // Do something with that string.
    }
} 
```

# asp.net - 禁用按钮，直到选择值---选择---不出现

> ID：14798184
> 
> 赞同：0
> 
> 时间：2013-02-10T13:22:33.037
> 
> 标签：asp.net, drop-down-menu, disabled-control, javascript

到目前为止一切正常，按钮被禁用，直到从下拉列表中选择值，但是我希望 ---select--- 成为下拉列表中的第一个选项，但这没有发生......任何想法至于为什么？

```
<asp:DropDownList ID="DropDownListSubContractors" runat="server" 
    AppendDataBoundItems="true" DataTextField="Company_Name" DataValueField="id" 
    onchange='selectChanged(this);'>
    <asp:ListItem Text="---Select---" Value="0" />
    <asp:ListItem Text="Option 1" Value="1" />
</asp:DropDownList>

<script type="text/javascript">

   function selectChanged(e) {
    document.getElementById("<%= addNewSubContractor.ClientID %>").disabled 
      = (e.options[e.selectedIndex].value == "0") ? "disabled" : "";
                          }
</script>

<asp:Button ID="addNewSubContractor" Text="Add Sub Contractor" 
    OnClick="UploadSubContractor" runat="server" disabled='disabled' /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:12:37.530

首先显示手动添加的项目，然后显示数据绑定项目是下拉列表的默认行为，因此理论上应该是第一个项目`---Select---` *。*

我怀疑其他地方有一些逻辑（可以是javascript或后面的代码）将所选项目设置为其他内容，即：

`DropDownListSubContractors.SelectedIndex = 1;`

仔细查看您的代码并确保所选项目没有在任何地方重新设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:57:45.820

您是否将附加数据绑定项目设置为 true，这会检查集合中是否有任何项目，并在绑定之前先添加它们？

# .htaccess - 仅当存在时才将 HTTP 请求重定向到文件

> ID：14798185
> 
> 赞同：0
> 
> 时间：2013-02-10T13:22:38.887
> 
> 标签：.htaccess, mod-rewrite, apache2

我正在尝试（内部）将呼叫重定向`/server123/get_file.php?file=frame-38-227113.jpg`到`/server123/cache/2/2/7/227113/frame-38-227113.jpg`.

当然，只有当该文件实际存在时。否则它将需要通过`get_file`脚本才能获取文件。

但我未能创建正确的重写规则。

到目前为止我所拥有的：

```
RewriteEngine On

RewriteCond %{REQUEST_URI} =/get_file.php
RewriteRule ^.*$ /server063/get_file.php [L]

RewriteCond %{QUERY_STRING} file=(frame-[0-9]+-([0-9])([0-9])([0-9])[0-9]+.jpg)
RewriteCond %{REQUEST_URI} ^/(server[0-9]+)/get_file.php
RewriteCond %6/cache/%2/%3/%4/%1 -f
RewriteRule ^.*$ /$6/$5/cache/%2/%3/%4/%1 [L] 
```

但这不起作用。

我希望有人能给我一些见解？

同样，当我尝试在这里防止无限循环时，我尝试使用`IS_SUBREQ`，但这似乎没有多大作用（例如：它总是重新尝试循环）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:41:53.060

我在您的规则中看到 2 个问题：

1.  您的组和文件名似乎与您所说的不符。仔细查看目录结构，您似乎有一个包含文件的完整 6 位 id 的目录，您没有捕获该目录；
2.  **%N 替换仅包含最后一个**RewriteCond 语句的匹配项（根据文档，请参阅： [http](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond) ://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond ）；这意味着您*不能通过*多个 RewriteConds 访问匹配项。

我认为通过一些环境变量魔术，您可以在多个语句中执行您想要的操作，但是鉴于您的文件名看起来很安全，我认为在您的情况下，您可以使用变量 THE_REQUEST，它可以让您同时访问 uri查询字符串是这样的：

```
RewriteCond %{THE_REQUEST} ^GET\ /(server[0-9]+)/get_file\.php\?file=(frame-[0-9]+-(([0-9])([0-9])([0-9])[0-9]+).jpg)
RewriteCond %{DOCUMENT_ROOT}/%1/cache/%4/%5/%6/%3/%2 -f
RewriteRule . %1/cache/%4/%5/%6/%3/%2 [L] 
```

当心：THE_REQUEST 没有被转义！

# javascript - disqus 评论引用页面的一部分

> ID：14798186
> 
> 赞同：0
> 
> 时间：2013-02-10T13:22:40.013
> 
> 标签：javascript, disqus

我有一个很长的 HTML 页面...分隔成部分 (h2) 我在底部添加了 disqus。

我希望人们在 disqus 上发表评论。

人们写了一条评论，而这条评论实际上是指页面的某个部分。有没有办法写这样的评论：

```
#chapter_14 I think this section should improve

#chapter_3 the first two sentences are wrong... 
```

但随后转换 #chapter_14 使其成为某种相对 url 并将主页移动到该部分......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T19:49:18.830

正如您在 Disqus 中描述的那样，目前没有办法做到这一点。知道的用户通常会利用我们允许`<blockquote>`标签引用内容这一事实。

创建某种视觉助手可能会鼓励用户这样做——例如，一个“引用部分”按钮，它使用适当的`<blockquote>`标签将内容复制到剪贴板，然后导航到`#disqus_thread`带有粘贴说明的锚点。

一个有趣的扩展可能是使用您引用的内容轮询我们的 API 以获取评论，并将它们与内容内联显示。这绝对可以使用我们的帖子/列表端点，您可以在这里找到更多信息：http: [//disqus.com/api/docs/posts/list/](http://disqus.com/api/docs/posts/list/)

只是一些想法，如果有任何想法，请告诉我们。

# c# - 从字符串创建对象

> ID：14798187
> 
> 赞同：0
> 
> 时间：2013-02-10T13:22:49.517
> 
> 标签：c#

我从文本中提取 4 个字符串，然后我想创建一个带有属性的对象，使用第一个字符串作为对象名称，其余的作为属性：

```
public void Load()
{
    string line = File.ReadAllText(path);
    foreach (var item in line)
    {
        string objectname = line.Split(':', '#')[1];
        string Name = line.Split('$', ':')[2];
        string Number = line.Split(':', '%')[3];
        string Addres = line.Split(':', '&')[4];

        StringBuilder StringBuilder = new StringBuilder();

    }
} 
```

我应该用`StringBuilder`这个吗？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:43:27.860

如果您的意思是根据动态数据设置属性值，则可以使用反射。

假设这是您的课程：

```
public class Contact
{
    public string Name { get; set; }
    public string Number { get; set; }
    public string Address { get; set; }
} 
```

这是文本文件的可能格式：

```
姓名=约翰$地址=加拿大$号码=111
号码=333$姓名=鲍勃$地址=

```

`Contact`然后这样的代码将迭代这些行并根据值为每个行创建实例：

```
string[] lines = File.ReadAllLines(path);
foreach (string line in lines)
{
    Contact contact = new Contact();
    string[] parts = line.Split('$');
    foreach (string part in parts)
    {
        string[] temp = part.split('=');
        string propName = temp[0];
        string propValue = (temp.Length > 1) ? temp[1] : "";
        contact.GetType().GetProperty(propName).SetValue(contact, propValue, null);
    }
} 
```

在上面的示例中使用它，两行将创建两个具有给定详细信息的实例。

# jsf-2 - JSF 正确使用依赖

> ID：14798192
> 
> 赞同：0
> 
> 时间：2013-02-10T13:23:41.857
> 
> 标签：jsf-2, managed-bean

JSF 2.1 雄猫 7.0

这是对依赖注入的错误使用吗？

它可以在页面上移动。但是“它有效”与“它是正确的”不同。

我也会将此模式用于搜索目的。我有一个请求，我喜欢用它来填充同一页面中的表格。这可能吗？

**索引.xhtml**

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <link rel="SHORTCUT ICON" href= "resources/img/onlyT.ico"></link>
        <title>title</title>
        <h:outputStylesheet library="css" name="compass.css"/>
    </h:head>
    <h:body>
        Login system
        <br />

        <h:form>
            User : <h:inputText value="#{user.username}" />
            Password : <h:inputSecret value="#{user.password}" />
            <h:commandButton action="#{loginBean.performLogin()}" value="Submit" />
            <h:commandButton value="reset" type="reset" />
            <h:commandButton value="ChangePsW" action="changePassword"></h:commandButton>
        </h:form>

        <h:message for="" style="color:red;margin:8px;"/>

    </h:body>
</html> 
```

**LoginBan.java**

```
@ManagedBean
@RequestScoped
public class LoginBean {

    @ManagedProperty(value="#{user}")
    private UserBean userBean;

    //must povide the setter method
    public void setUserBean(UserBean userBean) {
        this.userBean = userBean;
    }

    public LoginBean() {}

    public String performLogin(){

        //Mi connetto al db
        if(userBean.getUsername().equalsIgnoreCase( "mario")){

        //effettuo i controlli per stabilire se esiste l'utente

        userBean.setRoles("-EE-E-E-E-E-E");
        return "/mainPortal/mainPortal";
        }
        return "/mainPortal/index";

    }
} 
```

**用户Bean.java**

```
@ManagedBean (name="user")
@SessionScoped 
public class UserBean implements Serializable  {

private String Username;
private String Password;
private String Roles;

/** Creates a new instance of UserBean */
public UserBean() {
}

/**
 * @return the Username
 */
public String getUsername() {
    return Username;
}

/**
 * @param Username the Username to set
 */
public void setUsername( String Username ) {
    this.Username = Username;
}

/**
 * @return the Password
 */
public String getPassword() {
    return Password;
}

/**
 * @return the Roles
 */
public String getRoles() {
    return Roles;
}

/**
 * @param Roles the Roles to set
 */
public void setRoles( String Roles ) {
    this.Roles = Roles;
}

/**
 * @param Password the Password to set
 */
public void setPassword( String Password ) {
    this.Password = Password;
} 
```

更改密码也使用userBean，并拥有他的changePasswordBean。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T22:28:29.683

JSF 2 允许您在其他托管 bean 中[注入托管](http://www.mkyong.com/jsf2/injecting-managed-beans-in-jsf-2-0/)bean。这仅受您实际注入的 bean 的范围的限制，它必须大于您实际所在的 bean 的范围。我的意思是，您可以`@SessionScoped`在其中注入 bean `@ViewScoped`，但不能以另一种方式注入。当您遵循该约定时，我认为您做得很好。

通常，您的应用程序应该由处理当前用户输入/输出的 bean 和用于会话或应用程序手段的更广泛范围的 bean`@ViewScoped`组成。`@RequestScoped`因此，当用户登录时，最好在会话上下文中维护他的数据，但是我建议您不要在会话中维护用户的密码，至少如果您在成功登录后不打算使用它.

Finally the question you make about **search requests**, I think you can implement a search input in your page and make your result table load dinamically depending on the search. Just use ajax to obtain it without having to reload the whole page. You can implement everything in a `@ViewScoped` bean, but remember not to return navigation results in your listener methods if you want to maintain the bean working.

# r - 更新 df col 值，使用另一个 df 中 col 的条件，当两个 df 中的 char col 可以充当键时

> ID：14798195
> 
> 赞同：2
> 
> 时间：2013-02-10T13:24:10.787
> 
> 标签：r, syntax, indexing, dataframe

我需要有选择地更新 df 列中的值，具体取决于对 df2 中列的条件的满足，并提供 df1 的更新值，即 df2 列中的值。两个 df 都有一个 col ，其值是唯一的，并且 df2 中的唯一值是 df1 中的一个真子集。我尝试的方法是获取两个 df 中的唯一列值，并将它们转换为行名，使用它们来定义一个选择索引，该索引是从 df2 创建的，然后应用于 df1 以进行值更新。通过使用数字下标定义列，并结合我的基于字符的行共享键索引，我得到了可以工作的语法（最终！）。唷。

但是，有没有一种比我正在尝试的更简单、更有效、更“R”的方式来做到这一点，也许是使用内置的？我将需要扩展。测试示例如下：

```
goo <- data.frame(Uids=c("UidD", "UidA", "UidC"), Payout=c(3,0,5), stringsAsFactors = FALSE)
moo <- data.frame(Uids=c("UidB", "UidC", "UidA", "UidD"), PayOut=0, stringsAsFactors = FALSE)
goo
  Uids Payout
1 UidD      3
2 UidA      0
3 UidC      5
moo
  Uids PayOut
1 UidB      0
2 UidC      0
3 UidA      0
4 UidD      0
# I want to update moo$Payout with the value of goo$Payout, for matching Uids,
# when goo$Payout > 0, i.e. moo[4,2] <- goo[1,2]; moo[2,2 <- goo[3,2]
rownames(goo) <- goo$Uids
rownames(moo) <- moo$Uids
#I am trying to create and apply an index based on turning uids into rownames
IndexToUpdate <- goo$Uids[goo$Payout>0]
IndexToUpdate
[1] "UidD" "UidC"
 moo[IndexToUpdate, 2] <- goo[IndexToUpdate, 2]
#this works, but is there a better way to do it?
moo
     Uids PayOut
UidB UidB      0
UidC UidC      5
UidA UidA      0
UidD UidD      3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T13:45:57.523

I would use `merge` with `all.x = TRUE`:

```
voo <- merge(moo, goo, by = "Uids", all.x = TRUE)
voo
#   Uids PayOut.x PayOut.y
# 1 UidA        0        0
# 2 UidB        0       NA
# 3 UidC        0        5
# 4 UidD        0        3 
```

Then `ifelse`:

```
within(voo, PayOut <- ifelse(is.na(PayOut.y), PayOut.x, PayOut.y))
#   Uids PayOut.x PayOut.y PayOut
# 1 UidA        0        0      0
# 2 UidB        0       NA      0
# 3 UidC        0        5      5
# 4 UidD        0        3      3 
```

* * *

The same thing using `data.table`s:

```
library(data.table)
GOO <- data.table(goo)
MOO <- data.table(moo)
setkey(GOO, Uids)
setkey(MOO, Uids)
VOO <- GOO[MOO]
VOO[, FinalPayout := ifelse(is.na(PayOut), PayOut.1, PayOut)] 
```

# php - Ajax 请求最大执行超时

> ID：14798196
> 
> 赞同：0
> 
> 时间：2013-02-10T13:24:22.793
> 
> 标签：php, loops

在使用此代码使用 Ajax XHTMLRequest 收集数据时，我遇到了 PHP Max 执行超时

```
if(isset($_GET['func']) and $_GET['func'] == 'feed') {
    global $ado;
    $old_msg_id = $_GET['old_msg_id']; 
    $result = $ado->exec("SELECT * FROM `earnings` ORDER BY `id` DESC LIMIT 1");
    while($row = $ado->fetch_assoc($result)) {
        $last_msg_id = $row['id']; 
    }
    while($last_msg_id <= $old_msg_id) {
        $result = $ado->exec("SELECT * FROM `earnings` ORDER BY `id` DESC LIMIT 1");
        while($row = $ado->fetch_assoc($result)) {
            $last_msg_id = $row['id'];
        }
    }
    $response = array();
    $response['msg'] = 'new';
    $response['old_msg_id'] = $last_msg_id;
    echo json_encode($response);
} 
```

我在 error_log 中收到的错误是

```
PHP Fatal error:  Maximum execution time of 30 seconds exceeded in /ajax.php on line 165 
```

第 165 行如下：

```
while($last_msg_id <= $old_msg_id) { 
```

我目前没有看到代码有问题，有什么提示有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:27:42.840

# JS级别

在 AJAX 中，您可以像下面这样发布超时，

```
 jQuery.ajax({
           url: 'ajaxhandler.php',
           success: function (result) {                               
                returned_value=result;
           },
           timeout: 10000,
           async: false
        }); 
```

# PHP级别

如果您正在获取 PHP，您可以在 PHP.ini 中更改它

```
max_execution_time = 30 //make it like 300 
```

**其他**在您的 PHP 代码中使用[set_time_limit](http://php.net/manual/en/function.set-time-limit.php)

> 调用时， set_time_limit() 从零重新启动超时计数器。换句话说，如果超时是默认的 30 秒，并且在脚本执行 25 秒后调用了诸如 set_time_limit(20) 之类的调用，则脚本将在超时之前总共运行 45 秒。

**还要**确保那些 while 循环不是永无止境的循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:35:08.230

似乎您的两个 while 循环执行时间过长，数据库中是否有数据分配。

# php - 在多维数组PHP中搜索重复项

> ID：14798200
> 
> 赞同：1
> 
> 时间：2013-02-10T13:24:41.313
> 
> 标签：php, arrays, multidimensional-array

我在 JSON 中有一个像这样的多维 PHP 数组：

```
array = [{
          "id":"1",
          "key":"Ferrari",
          "type":"car"},
         {
          "id":"1",
          "key":"Red",
          "type":"color"},
         {
          "id":"73",
          "key":"Yellow",
          "type":"color"
         }] 
```

因为它实际上是一个搜索结果，所以我想动态组合 id 相同的结果。换句话说，新数组应如下所示：

```
 array = [{
          "id":"1",
          "key":"Red Ferrari",
          "type":"keyword"}, 
         {
          "id":"73",
          "key":"Yellow",
          "type":"color"
         }] 
```

我一直在研究很多 PHP 函数，但它们在多维数组中的功能有限。任何建议表示赞赏:)

许多问候
安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:36:20.230

没有基本功能可以做您提到的特定事情。所以你可以做这样的事情：

```
print_r(my_array_merge($data));
function my_array_merge($data)
{
    // sort all records by id to merge them later
    $data_by_id = array();
    foreach ($data as $item)
    {
        if (!isset($data_by_id[ $item['id'] ])) {
            $data_by_id[ $item['id'] ] = array();
        }
        $data_by_id[ $item['id'] ][] = $item;
    }
    // merge records with same id
    $return = array();
    foreach ($data_by_id as $id => $items)
    {
        foreach ($items as $item)
        {
            if (!isset($return[ $id ])) {
                $return[ $id ] = $item;
            } else {
                $return[ $id ]['key'] .= ' ' . $item['key'];
                $return[ $id ]['type'] = 'keyword'; // I don't really get what you mean by 'keyword'
            }
        }
    }
    // reset keys before return
    return array_values($return);
} 
```

# jsf - selectOneMenu 在更改后将字段设置为 null

> ID：14798202
> 
> 赞同：0
> 
> 时间：2013-02-10T13:24:51.660
> 
> 标签：jsf, richfaces, seam

[我尝试做一些与这个](http://docs.jboss.org/richfaces/latest_3_3_X/en/devguide/html/a4j_support.html) *Richfaces*示例非常相似的事情。如果您没有选择其中一个预定义的，我有一个描述自定义 ID 验证的表单，否则该表单将被禁用。因此表单成员的禁用表达式将转到下一个方法：

```
public boolean isPredefinedValidator() {
    return !currentProjectRegField.getIdValidation().getIdType().equals(IdValidatorType.NONE);
} 
```

像这样调用：

```
disabled="#{accountHome.isPredefinedValidator()}" 
```

这是预定义验证器的选择器：

```
<h:selectOneMenu value="#{accountHome.currentProjectRegField.idValidation.idType}"
    rendered="#{!(empty accountHome.currentProjectRegField or empty accountHome.currentProjectRegField.idValidation)}">
    <a4j:support event="onchange" reRender="customIdValidator"/>
        <s:convertEnum />
            <s:enumItem enumValue="NONE" label="#{messages['IdValidatorType_enum.NONE']}"/>
            <s:enumItem enumValue="USA_ID" label="#{messages['IdValidatorType_enum.USA_ID']}"/>
            <s:enumItem enumValue="MEXICO_ID" label="#{messages['IdValidatorType_enum.MEXICO_ID']}"/>
</h:selectOneMenu> 
```

问题是，当在重新渲染时（在禁用的 EL 上）`isPredefinedValidator()`调用该方法时`a4j`，我收到 NPE。

```
Caused by: java.lang.NullPointerException
at com.whatever.something.action.AccountHome.isPredefinedValidator(AccountHome.java) 
```

当我尝试调试时 - 结果发现从 设置的值`selectOneMenu`是空的。

这是否意味着`reRender`变量的设置值是异步发生的，并且存在竞争条件？这种情况的正确解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T08:05:30.587

`rich:modalPanel`包含`h:selectOneMenu`解决此问题的一些黑魔法配置。它是这样的`<rich:modalPanel ... domElementAttachment="form">`

# imagemagick - 如何使用 imagemagick 制作动画 gif 灰度？

> ID：14798209
> 
> 赞同：2
> 
> 时间：2013-02-10T13:25:35.113
> 
> 标签：imagemagick, animated-gif

我有一个彩色的动画 GIF，我想让它变成灰度。如何使用 ImageMagick 做到这一点？我试过用这个：

```
convert image.gif -fx "(r+g+b)/3" imageGS.gif 
```

但这给我留下了一个灰度图像，它只是动画的第一帧。

如何告诉 ImageMagick 影响动画的所有帧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T20:34:27.107

改用[调制](http://www.imagemagick.org/script/command-line-options.php?#modulate)命令并将饱和度设置为 0：

```
convert image.gif -modulate 100,0,100 imageGS.gif 
```

我用我自己的动画 gif 对此进行了测试，它确实有效。

# ios - Adobe Flash CS6 的 iOS 直接部署功能对每个人来说都需要这么长时间吗？

> ID：14798212
> 
> 赞同：0
> 
> 时间：2013-02-10T13:26:22.463
> 
> 标签：ios, ipad, flash, air

我第一次尝试了 Flash Professional CS6 的 iOS 部署功能，但是使用一个全新的空白“Air for iOS”项目完成部署过程大约需要 2 分钟。每个人通常都需要这么长时间吗？

如果部署一个空白项目需要 2-3 分钟，那么在我的 iPad2 上部署一个复杂的应用程序或游戏会不会永远需要花费？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:14:30.000

我是 Flash CS6 和 iOS 发布的新手，但从我的测试中可以看出，一个空项目或一个大项目几乎需要相同的时间才能发布。不知道具体为什么。

# javascript - 查找并获取类名的最后一个字符

> ID：14798213
> 
> 赞同：0
> 
> 时间：2013-02-10T13:26:28.640
> 
> 标签：javascript, jquery

我的 html 的类总是根据其中的元素数量而有所不同（ul>li `sf-single-children-*`... `*`）我如何`*`用 javascript 得到这个，所以我可以根据这个数字设置样式？

示例代码：

```
<ul class='someclass'>
    <li class="sf-single-children-* some-other-classes-here-aswell">
        <ul style="width: * ">
            <li>Item with no children element</li>
            <li>Item with no children element</li>
            <li>Item with no children element</li>
            <li>Item with no children element</li>
            <li>Item with no children element</li>
            <li>Item with childer element which should not be counted
              <ul>
                 <li>Item with no children element</li>
                 <li>Item with no children element</li>
                 <li>Item with no children element</li>
              </ul>
            </li>
        </ul>
    </li>
</ul> 
```

另一种方法是我如何做到这一点，它只在父级中计数元素`<ul>`但我不知道该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:04:15.983

好的，最简单的解决方案肯定是只获取类名的最后一个字符。

此代码将获取指定元素的第一个类并获取最后一个破折号之后的所有字符。

```
var number
function getVal() {
    var cls = $(".someclass > li").attr('class').split(' ')[0];
    number = cls.substr(cls.lastIndexOf("-") + 1);
} 
```

只要确保：

1.  这门课永远是第一
2.  类总是以这种方式格式化

如果您希望将其作为数字而不是强数字，则必须对其进行转换。

[演示](http://jsfiddle.net/8WXhN/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:40:09.943

您可以使用如下的 jquery 选择器

```
$('ul > li[class^="sf-single-children-"]').each(function(){
   // u get all the 'li' elements with class starting with 'sf-single-children-'
   // you can check the class with $(this).attr('class').split('-')[3];
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:43:29.693

鉴于您对您的要求的评论，以下将起作用：

```
$('.someclass > li').each(function() {
    var liCount = $('> ul > li', this).filter(function() {
        return $(this).children('ul').length == 0;
    }).length;
}); 
```

[**示例小提琴**](http://jsfiddle.net/EeRZb/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T13:48:23.610

这可能会有所帮助，它展示了如何从元素中提取类名，并分解该名称以便可以使用您描述的“*”。

```
var haystack = document.querySelector("ul>li");
var needle = haystack.getAttribute("class").split("-").pop();
console.log(needle); 
```

如果您的意思是单个类定义中的多个类，那么：

```
var haystack = document.querySelector("ul>li");
for (var i=0; i<haystack.classList.length; i++) {
  var needle = haystack.classList[i].split("-").pop();
  console.log(needle);
} 
```

如果您的意思是多个节点，则扩展前面的示例：

```
var haystack = document.querySelectorAll("ul>li");

for (var h=0; h<haystack.length; h++) {
  for (var i=0; i<haystack[h].classList.length; i++) {
    var needle = haystack[h].classList[i].split("-").pop();
    console.log(needle);
  }
} 
```

示例：http: [//jsbin.com/igowaw/7/](http://jsbin.com/igowaw/7/)

基于原版的最新模组，这是否符合您的要求？

```
var haystack = document.querySelectorAll("ul>li");
for (var h=0; h<haystack.length; h++) {
  for (var i=0; i<haystack[h].classList.length; i++) {
    var c = haystack[h].classList[i];
    if (c.indexOf("sf-single-children") === 0) {
      var needle = c.split("-").pop();
      console.log(needle);
    }
  }
} 
```

示例：http: [//jsbin.com/igowaw/8/edit](http://jsbin.com/igowaw/8/edit)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-10T13:50:44.647

```
var star = $(".someclass li").attr("class").split("sf-single-children-")[1]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T14:13:54.160

给定像你这样的结构。如何使用包含并获取 N（基于 jQuery 的解决方案）`li`的所述类获取 's ：`sf-single-children-N`

```
$('li[class*="sf-single-children-"]').each(function () {
    var classNames = this.className.split(' '),
        count;

    for (var i=0; !count && i<classNames.length; i++)
        if (classNames[i].indexOf('sf-single-children-') == 0)
            count = parseInt(classNames[i].replace('sf-single-children-', ''), 10);

    // there you have it in the count
    // with `this` being the element currently being inspected
}); 
```

您也可以在类名中包含其他类。

原版 Javascript 解决方案（sans-jQuery）：

```
var elements = document.getElementsByTagName('li');
for (var i=0; i<elements.length; i++) {
    if (elements[i].className.indexOf('sf-single-children-') < 0)
        continue;

    var classes = elements[i].className.split(' '),
        count = 0;

    for (var j=0; !count && j<classes.length; j++)
        if (classes[j].indexOf('sf-single-children-') == 0)
            count = parseInt(classes[j].replace('sf-single-children-', ''), 10);

    // count contains the number you need
    // elements[i] contains the element
}; 
```

但是，如果您想在客户端上进行计数，鉴于`li`您想要找出`ul > li`子节点数量的元素具有`count-child-nodes`类名，您可以这样做（使用 jQuery）：

```
$('li.count-child-nodes').each(function () {
    var count = $(this).find('> ul > li').length;

    // you have the count here
}); 
```

...或者没有 jQuery：

```
var els = document.getElementsByTagName('li');
for (var i=0; i<els.length; i++) {
    var el = els[i];
    if (!/\bcount-child-nodes\b/.test(el.className))
        continue;

    for (var j=0, count=0; j<el.children.length; j++) {
        var ul = el.children[j];
        if (ul.nodeName.toLowerCase() != 'ul')
            continue;

        for (var k=0; k<ul.children.length; k++) {
            if (ul.children[k].nodeName.toLowerCase() == 'li')
                count++;
        }
    }

    // the count has your number
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-10T17:17:50.800

从这里的字里行间看，您似乎知道在服务器端有多少没有子元素的元素。如果您在 HTML5 中构建，则最好为此使用 data 属性，而不是在类中传递它，因此：

```
<ul class='someclass'>
    <li class="some-other-classes-here-aswell" data-single-children="2">
        <ul style="width: * ">
            <li>Item with no children element</li>
            <li>Item with no children element</li>
        </ul>
    </li>
</ul> 
```

然后，您可以访问该数据：

```
var x = document.querySelector("[data-single-children]");
console.log(x.dataset.singleChildren); 
```

示例：http: [//jsbin.com/uqadub/1/edit](http://jsbin.com/uqadub/1/edit)

# java - 玩！1.2.5 javascript datetimepicker 未显示

> ID：14798214
> 
> 赞同：0
> 
> 时间：2013-02-10T13:26:32.593
> 
> 标签：java, playframework, playframework-1.x

伙计们，

我正在尝试在其中一个屏幕中添加一个 DateTimePicker javascript 文件。单击日历图标时，不会弹出日历。

我在文件夹中添加了javascript文件，在`public/javascript`文件夹中添加了图像`public/images`。

然后我在 main.html 中添加了这一行：

```
<script type="text/javascript" src="@{'/public/javascripts/datetimepicker_css.js'}" ></script> 
```

这条线用于在文本框旁边显示图像：

```
<input type="text" styleId="demo1" name="transaction.returnDate" size="10">
<img src="@{'/public/images/cal.gif'}" onclick="javascript:NewCssCal('demo1')" style="cursor:pointer"/> 
```

加载屏幕后，图像会在文本框旁边正确显示。但是当我点击它时，日历没有显示出来。

我在我的其他 struts 应用程序中使用了这两行，它工作正常：

```
<script language="javascript" type="text/javascript" src="/MediaTest/datetimepicker/datetimepicker_css.js">

<html:text styleId="demo1" name="returnForm" property="returnDate" size="10"></html:text>
<img src="/MediaTest/datetimepicker/cal.gif" onclick="javascript:NewCssCal('demo1')" style="cursor:pointer"/> 
```

请让我知道如何使它工作。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T13:01:54.253

将`styleId`属性更改为`id`

```
<input type="text" id="demo1" name="transaction.returnDate" size="10"> 
```

# bdd - 在我的 BDD 场景中自动执行 Then 步骤的设计问题

> ID：14798219
> 
> 赞同：0
> 
> 时间：2013-02-10T13:26:53.117
> 
> 标签：bdd, jbehave

我对 BDD 很陌生，我正在尝试使用 BDD 为网站开发一个**简单的注册模块**。

我有**以下情况**：

```
Scenario: An anonymous visitor successfully signs up with the website  
Given the following email address: john.smith@gmail.com and a chosen member status of childminder and the following password: ------ 
When the anonymous visitor signs up  
Then a confirmation email with activation information is sent to the anonymous visitor 
```

我很茫然**自动化然后步骤**（“*然后将带有激活信息的确认电子邮件发送给匿名访问者*”）

这是我所做的（使用 JBehave）：

```
@Given("the following email address: $email and a chosen member status of $status and the following password: $password")
public void anonymousVisitorEntersDetails(String email, String status, String password) {
    pages.home().open();
    pages.home().enterDetails(email, status, password);
}

@When("the anonymous visitor signs up")
public void anonymousVisitorDoesRegister(String login, String password) {
    pages.home().doRegister();
}

@Then("a confirmation email with activation information is sent to the anonymous visitor")
public void activationInformationIsSent() {
    //TODO ??
} 
```

我遇到的问题与其说是工具问题，不如说是设计问题。如果一些有经验的 BDD 从业者能帮助我解决这个问题，我将不胜感激......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T15:36:15.320

让我们从您的 Given 开始。这设置了上下文。如果我了解您的情况，可能感兴趣的相关内容是： - 未登录 - 在主页（或注册）页面上 不要在此处提及用户详细信息。

接下来，您的 When 步骤指定匿名用户注册的用户详细信息。

最后，Then 步骤需要检查是否发送了确认电子邮件。虽然发送电子邮件并检查它是否到达很诱人，但这将是 IMO 的错误。电子邮件不能保证到达，而且在任何情况下都很慢。让您的测试套件保持快速和健壮。

而是使用您的 When 语句的措辞或场景中的标签来指示您的应用程序应该使用模拟电子邮件组件构建。在您的 Then 步骤中，您可以询问模拟以验证它是否已按预期调用。

在您的测试中，您仍然需要集成和/或验收测试来验证“真实”电子邮件组件是否已正确部署。这可能是手动测试，也可能是登录到邮件客户端并轮询直到包含预期内容的电子邮件到达的缓慢且喜怒无常的自动化测试。

# python - 如何使用 glob.glob 模块搜索子文件夹？

> ID：14798220
> 
> 赞同：148
> 
> 时间：2013-02-10T13:27:01.647
> 
> 标签：python, filesystems, glob, fnmatch

我想在一个文件夹中打开一系列子文件夹并找到一些文本文件并打印一些文本文件的行。我正在使用这个：

```
configfiles = glob.glob('C:/Users/sam/Desktop/file1/*.txt') 
```

但这也不能访问子文件夹。有谁知道我如何使用相同的命令来访问子文件夹？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2013-02-10T13:31:59.937

在 Python 3.5 和更新版本中使用新的递归`**/`功能：

```
configfiles = glob.glob('C:/Users/sam/Desktop/file1/**/*.txt', recursive=True) 
```

`recursive`设置时，`**`后跟路径分隔符匹配 0 个或多个子目录。

在早期的 Python 版本中，`glob.glob()`不能递归地列出子目录中的文件。

在那种情况下，我会使用[`os.walk()`](http://docs.python.org/2/library/os.html#os.walk)组合 with[`fnmatch.filter()`](http://docs.python.org/2/library/fnmatch.html#fnmatch.filter)代替：

```
import os
import fnmatch

path = 'C:/Users/sam/Desktop/file1'

configfiles = [os.path.join(dirpath, f)
    for dirpath, dirnames, files in os.walk(path)
    for f in fnmatch.filter(files, '*.txt')] 
```

这将递归遍历您的目录并将所有绝对路径名返回到匹配`.txt`文件。在这种*特定*情况下，这`fnmatch.filter()`可能是矫枉过正，您也可以使用`.endswith()`测试：

```
import os

path = 'C:/Users/sam/Desktop/file1'

configfiles = [os.path.join(dirpath, f)
    for dirpath, dirnames, files in os.walk(path)
    for f in files if f.endswith('.txt')] 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2019-07-14T06:13:05.280

关于这个话题有很多困惑。让我看看我是否可以澄清它（Python 3.7）：

1.  `glob.glob('*.txt') :`匹配当前目录中所有以 '.txt' 结尾的文件
2.  `glob.glob('*/*.txt') :`与 1 相同
3.  `glob.glob('**/*.txt') :`**仅匹配直接子目录**中所有以 '.txt' 结尾的文件，但不匹配当前目录中的所有文件
4.  `glob.glob('*.txt',recursive=True) :`与 1 相同
5.  `glob.glob('*/*.txt',recursive=True) :`与 3 相同
6.  `glob.glob('**/*.txt',recursive=True):`匹配当前目录和所有子目录中所有以 '.txt' 结尾的文件

所以最好总是指定`recursive=True.`

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-02-10T13:47:12.467

在直接子目录中查找文件：

```
configfiles = glob.glob(r'C:\Users\sam\Desktop\*\*.txt') 
```

对于遍历所有子目录的递归版本，您可以使用`**`并`recursive=True` [从 Python 3.5 开始](https://docs.python.org/3/library/glob.html#glob.glob)传递：

```
configfiles = glob.glob(r'C:\Users\sam\Desktop\**\*.txt', recursive=True) 
```

两个函数调用都返回列表。您可以使用`glob.iglob()`一一返回路径。或[使用`pathlib`](https://docs.python.org/3/library/pathlib.html#pathlib.Path.rglob)：

```
from pathlib import Path

path = Path(r'C:\Users\sam\Desktop')
txt_files_only_subdirs = path.glob('*/*.txt')
txt_files_all_recursively = path.rglob('*.txt') # including the current dir 
```

两种方法都返回迭代器（您可以一一获取路径）。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-03-13T19:10:15.290

glob2包支持[通配符](https://pypi.python.org/pypi/glob2)并且相当快

```
code = '''
import glob2
glob2.glob("files/*/**")
'''
timeit.timeit(code, number=1) 
```

[在我的笔记本电脑上，匹配>60,000 个文件路径](https://github.com/jsdelivr/jsdelivr/tree/master/files)大约需要 2 秒。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-02-12T01:12:09.837

您可以在 Python 2.6中使用[Formic](http://pypi.python.org/pypi/formic)

```
import formic
fileset = formic.FileSet(include="**/*.txt", directory="C:/Users/sam/Desktop/") 
```

披露 - 我是这个包的作者。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-26T02:20:41.323

这是一个改编版本，`glob.glob`无需使用`glob2`.

```
def find_files(directory, pattern='*'):
    if not os.path.exists(directory):
        raise ValueError("Directory not found {}".format(directory))

    matches = []
    for root, dirnames, filenames in os.walk(directory):
        for filename in filenames:
            full_path = os.path.join(root, filename)
            if fnmatch.filter([full_path], pattern):
                matches.append(os.path.join(root, filename))
    return matches 
```

所以如果你有以下目录结构

```
tests/files
├── a0
│   ├── a0.txt
│   ├── a0.yaml
│   └── b0
│       ├── b0.yaml
│       └── b00.yaml
└── a1 
```

你可以做这样的事情

```
files = utils.find_files('tests/files','**/b0/b*.yaml')
> ['tests/files/a0/b0/b0.yaml', 'tests/files/a0/b0/b00.yaml'] 
```

几乎`fnmatch`整个文件名本身的模式匹配，而不仅仅是文件名。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-05-26T09:31:21.217

`configfiles = glob.glob('C:/Users/sam/Desktop/**/*.txt")`

不适用于所有情况，而是使用 glob2

```
configfiles = glob2.glob('C:/Users/sam/Desktop/**/*.txt") 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-07-26T15:05:32.993

如果你可以安装 glob2 包...

```
import glob2
filenames = glob2.glob("C:\\top_directory\\**\\*.ext")  # Where ext is a specific file extension
folders = glob2.glob("C:\\top_directory\\**\\") 
```

所有文件名和文件夹：

```
all_ff = glob2.glob("C:\\top_directory\\**\\**") 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-06-29T23:07:04.780

如果您正在运行 Python 3.4+，则可以使用该[`pathlib`](https://docs.python.org/3.6/library/pathlib.html)模块。该[`Path.glob()`](https://docs.python.org/3.6/library/pathlib.html#pathlib.Path.glob)方法支持该`**`模式，这意味着“此目录和所有子目录，递归地”。它返回一个生成器，[`Path`](https://docs.python.org/3.6/library/pathlib.html#pathlib.Path)为所有匹配的文件生成对象。

```
from pathlib import Path
configfiles = Path("C:/Users/sam/Desktop/file1/").glob("**/*.txt") 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-12-03T21:33:26.840

（第一个选项当然在其他答案中提到，这里的目标是显示 glob 在`os.scandir`内部使用，并提供直接答案）。

* * *

## 使用全局

如前所述，使用 Python 3.5+，很容易：

```
import glob
for f in glob.glob('d:/temp/**/*', recursive=True):
    print(f)

#d:\temp\New folder
#d:\temp\New Text Document - Copy.txt
#d:\temp\New folder\New Text Document - Copy.txt
#d:\temp\New folder\New Text Document.txt 
```

## 使用路径库

```
from pathlib import Path
for f in Path('d:/temp').glob('**/*'):
    print(f) 
```

## 使用 os.scandir

`os.scandir`是`glob`在内部做什么。所以这里是如何直接做到这一点，使用`yield`：

```
def listpath(path):
    for f in os.scandir(path):
        f2 = os.path.join(path, f)
        if os.path.isdir(f):
            yield f2
            yield from listpath(f2)
        else:
            yield f2

for f in listpath('d:\\temp'):
    print(f) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-05T23:45:30.280

正如 Martijn 所指出的，glob 只能通过`**`Python 3.5 中引入的运算符来做到这一点。由于 OP 明确要求 glob 模块，以下将返回一个行为类似的惰性求值迭代器

```
import os, glob, itertools

configfiles = itertools.chain.from_iterable(glob.iglob(os.path.join(root,'*.txt'))
                         for root, dirs, files in os.walk('C:/Users/sam/Desktop/file1/')) 
```

请注意，您只能`configfiles`在此方法中迭代一次。如果您需要可在多个操作中使用的真实配置文件列表，则必须使用`list(configfiles)`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-03-26T14:03:51.423

该命令`rglob`将在目录结构的最深子级别下进行无限递归。但是，如果您只想要一层深度，则不要使用它。

我意识到 OP 正在谈论使用 glob.glob。然而，我相信这回答了递归搜索所有子文件夹的意图。

该`rglob`函数最近使数据处理算法的速度提高了 100 倍，该算法使用文件夹结构作为数据读取顺序的固定假设。但是，`rglob`我们能够对指定父目录下的所有文件进行一次扫描，将它们的名称保存到一个列表中（超过一百万个文件），然后使用该列表来确定我们需要随时打开哪些文件仅基于文件命名约定与它们所在的文件夹指向未来。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-09-04T22:29:46.353

您可以使用该函数`glob.glob()`或`glob.iglob()`直接从 glob 模块从目录/文件和子目录/子文件中递归检索路径。

句法：

```
glob.glob(pathname, *, recursive=False) # pathname = '/path/to/the/directory' or subdirectory
glob.iglob(pathname, *, recursive=False) 
```

在您的示例中，可以这样写：

```
 import glob
import os

configfiles = [f for f in glob.glob("C:/Users/sam/Desktop/*.txt")]

for f in configfiles:
    print(f'Filename with path: {f}')
    print(f'Only filename: {os.path.basename(f)}')
    print(f'Filename without extensions: {os.path.splitext(os.path.basename(f))[0]}') 
```

输出：

```
Filename with path: C:/Users/sam/Desktop/test_file.txt
Only filename: test_file.txt
Filename without extensions: test_file 
```

帮助 ：的[文档](https://docs.python.org/3/library/os.path.html#os.path.splitext)`os.path.splitext`和[文档](https://docs.python.org/3/library/os.path.html#os.path.basename)。`os.path.basename`

# php - 多个正则表达式

> ID：14798223
> 
> 赞同：1
> 
> 时间：2013-02-10T13:27:06.893
> 
> 标签：php, regex, preg-replace

我正在使用多个正则表达式语句，`preg_replace`并发现它们单独工作。一旦我包含多​​个 preg_replace，另一个将停止工作。

有没有办法以`preg_replace`有序的方式使用，而不是在加载后立即使用？

这是我到目前为止所拥有的：

```
file_put_contents("$uploadedfile", preg_replace("/<[^>]*>/", "", "$filecontents"));         

file_put_contents("$uploadedfile", preg_replace('/\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})/', '<em>(\1) \2-\3</em>', $filecontents)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:30:06.503

因为您在第二个中使用的文件内容是旧的。您不会看到第一个语句的效果，因为您没有从文件中获取新内容。

尝试这个

```
file_put_contents("$uploadedfile", preg_replace("/<[^>]*>/", "", "$filecontents"));  

$filecontents = file_get_contents($uploadedfile);       

file_put_contents("$uploadedfile", preg_replace('/\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})/', '<em>(\1) \2-\3</em>', $filecontents)); 
```

或者

将所有内容保存到一个临时变量并在最后写入文件

# r - 密度图矩阵，每个图覆盖两个分布

> ID：14798226
> 
> 赞同：4
> 
> 时间：2013-02-10T13:27:32.087
> 
> 标签：r, matrix, ggplot2, dataframe

我有一个`data.frame`5 列，我想生成一个密度图矩阵，这样每个密度图都是两个密度图的叠加。（这类似于 plotmatrix，除了在我的情况下，每列中非 NA 值的数量因列而异，我想要叠加分布而不是散点图）。

我的第一次尝试没有成功，如下所示：

```
library(ggplot2)
library(reshape)

tmp1 <- data.frame(do.call(cbind, lapply(1:5, function(x) {
  r <- rnorm(100)
  r[sample(1:100, 20)] <- NA
  return(r)
})))

ggplot( melt(tmp1), aes(x=value, fill=variable))+
  geom_density(alpha=0.2, position="identity")+opts(legend.position = "none")+
  facet_grid(variable ~ variable) 
```

我的第二种方法让我接近了那里，但我不想使用 5 种不同的颜色，而只想在所有地块中使用两种颜色。而且，我确信有一种更优雅的方式来构建这个扩展矩阵：

```
tmp2 <- do.call(rbind, lapply(1:5, function(i) {
  do.call(rbind, lapply(1:5, function(j) {
    r <- rbind(data.frame(var=sprintf('X%d', i), val=tmp1[,i]),
               data.frame(var=sprintf('X%d', j), val=tmp1[,j]))
    r <- data.frame(xx=sprintf('X%d', i), yy=sprintf('X%d', j), r)
    return(r)
  }))
}))
ggplot(tmp2, aes(x=val, fill=var))+
  geom_density(alpha=0.2, position="identity")+opts(legend.position = "none")+
  facet_grid(xx ~ yy) 
```

我的解决方案是手动循环遍历成对的列并手动生成叠加密度图，将它们保存到列表中。然后我使用“grid.arrange”将它们排列在一个网格中，如下图所示。

但是是否可以改为使用来实现这一目标`facet_grid`？

![叠加密度图矩阵](../Images/6db9982f77a2a3fa1c91978d6d3e530c.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T13:56:11.433

最简单的方法是使用所有排列（其中 5 * 5 = 25）重塑您的数据。

```
require(gregmisc)
perm <- permutations(5, 2, paste0("X", 1:5), repeats.allowed=TRUE)
# instead of gregmisc + permutations, you can use expand.grid from base as:
# perm <- expand.grid(paste0("X", 1:5), paste0("X", 1:5))
o <- apply(perm, 1, function(idx) {
    t <- tmp1[idx]
    names(t) <- c("A", "B")
    t$id1 <- idx[1]
    t$id2 <- idx[2]
    t
})
require(ggplot2)
require(reshape2)    
o <- do.call(rbind, o)
o.m <- melt(o, c("id1", "id2"))
o.m$id1 <- factor(o.m$id1)
o.m$id2 <- factor(o.m$id2)
p <- ggplot(o.m, aes(x = value))
p <- p + geom_density(alpha = 0.2, position = "identity", aes(fill = variable)) 
p <- p + theme(legend.position = "none")
p <- p + facet_grid(id1 ~ id2)
p 
```

![ggplot2_facet_grid](../Images/19beb28f80120129e6c304090290d6d1.png)

# java - Java：在大型项目实践中将文件处理代码放在哪里

> ID：14798227
> 
> 赞同：1
> 
> 时间：2013-02-10T13:27:33.910
> 
> 标签：java, oop, exception-handling

假设用户在某个 gui 处理类中选择了一个文件路径。因此，我收到一个带有文件路径的字符串。

现在，放置文件打开/关闭代码的最佳做法是什么？是应该在GUI类中将路径转换为InputStream对象，然后将该对象传递给解析器类，还是传递String对象，让解析器类处理文件打开/关闭操作？

我更喜欢第二个选项，因为在同一个类中进行文件处理和错误处理似乎很方便，然后我传递 null，或者如果出现任何类型的失败则抛出异常。GUI 处理代码虽然很冗长，但我想将 GUI 和用户操作代码与核心逻辑分开。

但是，第一个选项很好，因为我可以更早地捕获文件读取异常，因此无需“跳下”一个类，只是在那里抛出异常。

这有什么好的做法？我相信还有更多这样的情况，其中对象在被处理之前被传递了一点。错误处理应该在“高级”类还是“低级”核心类中进行？

**基本上，我应该尽快从 String 转换为 InputStream 还是迟到？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:30:37.377

首先不应在 Event Dispatch Thread 上进行任何文件处理。该线程应该只执行接收事件、驱动 GUI 和将其他关注点分派到单独线程所需的最少代码。否则，您将把自己画到一个称为*缓慢 GUI*的角落，从而导致您的应用程序的用户体验不佳。

关于解析器和文件处理代码之间的关注点分离，最常见的情况是，如果 API 坚持其核心业务，它将具有更大的价值，这意味着它可以在面对与其无关的关注点变化时被重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:33:34.180

您可以尝试使用命令解决此问题。

[命令模式](http://en.wikipedia.org/wiki/Command_pattern)

基本上你描述的是一个“打开文件”命令。

# flash - Flash CS6：文本框只显示几个字符

> ID：14798236
> 
> 赞同：0
> 
> 时间：2013-02-10T13:28:43.127
> 
> 标签：flash, button, text, actionscript

我正在学习 Flash，但遇到了一个小问题。

我有一个文本字段，我想根据随机数更改文本，这是我的文本字段：

[http://imgur.com/Uhm3wlV](http://imgur.com/Uhm3wlV)

这是我的简单代码：

```
function fl_GenerateRandomNumber(limit:Number):Number

{
    var randomNumber:Number = Math.floor(Math.random()*(limit+1));
    return randomNumber;
}

button_1.addEventListener(MouseEvent.CLICK, fl_MouseClickHandler);

function fl_MouseClickHandler(event:MouseEvent):void
{
    var getRandNum:Number = fl_GenerateRandomNumber(199);
    trace(getRandNum);
    Display_number_in_center.text = String(getRandNum);
} 
```

**由于OUTPUT中的****TRACE**语句，运行上面并单击按钮会给我随机数，但在文本字段中我只显示 1 或两个字符，而不是完整的随机数。

 **例如，如果随机数是**123**则显示**1**，如果是**112**则显示**11**。

完全不知道出了什么问题以及在哪里:(

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:45:00.627

听起来这是一个字体嵌入问题。

使用嵌入字体时，Flash 默认不包含字体的所有字符。为了节省文件大小，它仅包含您在“字体嵌入”面板中指定的字符，或者被编辑到文本字段中的字符，例如示例中按钮中的“1”。

换句话说，由于“1”是您在文本字段中编辑的唯一字符，因此在“+1”和“-1”按钮上，“1”是字体字形嵌入 swf 时包含的唯一数字，并且唯一可以显示的数字。因此“如果是 123 则显示 1，如果是 112 则显示 11”。

因此，进入“字体嵌入”面板并确保所用字体包含“数字”。**

# neural-network - 神经网络 (FFW, BP) - 函数逼近

> ID：14798238
> 
> 赞同：1
> 
> 时间：2013-02-10T13:29:05.083
> 
> 标签：neural-network, approximation

是否可以训练 NN 来逼近这个函数： ![功能](../Images/841fc457de5ec6fa9768f06297ad9c5d.png)

如果我调整 x^2 或 sin 或其他简单的近似值，它可以正常工作，但对于这种函数，我只得到恒定值线。我的 NN 有 2 个输入 (x, f(x))，一个隐藏层 (10 个神经元)，1 个输出 (f(x)) 我使用 BP 进行训练，激活函数 sigmoid -> tanh

我的目标是获得没有噪音的“平滑”功能，即上图中的捕获功能。

或者有没有其他方法可以使用 NN 或遗传算法，如何近似？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:32:10.237

由于输入 (x, f(x)) 是不连续的（不完全是，但有点），因此您遇到了重大问题。

因此，考虑到较大的不连续性，您的 NN 必须逐字记住 xf(x) 映射。

一种方法是使用可以解决不连续性的四层神经网络。

但实际上，您可能只想查看其他平滑方法而不是 NN 来解决这些问题。

你有一个周期函数，所以首先，只使用一个周期，否则你会记住而不是概括。

# javascript - 类和 id 名称中的拼写错误的预防工具

> ID：14798239
> 
> 赞同：5
> 
> 时间：2013-02-10T13:29:07.593
> 
> 标签：javascript, html, css, error-checking

是否有任何用于 HTML/CSS/JavaScript 的基本调试工具有助于识别拼写错误？

对于“#fron”应该是“#from”的时候。我不是在谈论代码本身，而是在谈论类名和 id 之类的东西。

我知道有强大的 IDE，但只是想知道是否有一些我根本不知道的相当基本的工具或扩展。

在我在这里发布问题之前，我会尝试彻底审查代码，但我自己是最差的校对者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T00:27:26.307

我发现有两件事很有用： [http ://blog.whatwg.org/vnu-parser-1-4](http://blog.whatwg.org/vnu-parser-1-4)

我对 css 使用自重： [https ://github.com/aanand/deadweight](https://github.com/aanand/deadweight)

或者 ucss [https://github.com/operasoftware/ucss](https://github.com/operasoftware/ucss)

对于我的客户端渲染，我使用 phantomjs 抓取页面内容，然后通过 vnu 和 deadweight/ucss 运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T23:28:23.053

我会说也检查一下。通过 firebug 的控制台运行前两个示例，并得到了您正在寻找的内容。问题是第一个（ilia choly's）只显示类，尽管它处于警报状态。第二个示例（MisterGreen 的）更简洁，为您提供类和 id，但将它们吐入控制台并给您带来不必要的结果。试试看，选一个。无需将其编码到您的页面中。最糟糕的部分可能是手动完成所有这些。 [如何获取 HTML 文件中使用的 Css 类列表？](https://stackoverflow.com/questions/7538483/how-to-get-list-of-css-class-use-in-the-html-file)

# delphi - BorderWidth > 0 的错误修复与滚动条结合使用？

> ID：14798240
> 
> 赞同：5
> 
> 时间：2013-02-10T13:29:12.413
> 
> 标签：delphi, scrollbar

在编写自定义控件期间，在尝试`BorderWidth`正确实现默认属性时，我似乎偶然发现了显示滚动条时绘制行为中的一个错误：滚动条之间的空间和控件的范围没有绘制。

`OnCreate`要重现该错误，请为新项目的主窗体实现以下处理程序：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  AutoScroll := True;
  BorderWidth := 20;
  SetBounds(10, 10, 200, 200);
  with TGroupBox.Create(Self) do
  begin
    SetBounds(300, 300, 50, 50);
    Parent := Self;
  end;
end; 
```

D7 和 XE2 的结果：

![在此处输入图像描述](../Images/6eb95e61b4c89ca9a1f5a85a817f9259.png)

似乎这在 Delphi XE2 中终于得到了修复。很可能，此错误将驻留在 中`TWinControl.WMNCPaint`，但在查看时`Controls.pas`，我找不到 D7 和 XE2 之间的实现有任何显着差异。

我想得到以下答案：

*   如何为这个奇怪的东西写一个错误修正，
*   似乎从哪个 Delphi 版本修复了此错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:29:12.413

### 从哪个 Delphi 版本修复？

在 QualityCentral on *BorderWidth*中的[搜索结果](http://qc.embarcadero.com/wc/qcmain.aspx?search=1&type=B+OR+A+OR+D+OR+C&proj=10&kw=borderwidth)显示之前没有报告过此错误。错误[QC 2433](http://qc.embarcadero.com/wc/qcmain.aspx?d=2433)（已在 D2010 中解决，更新 4）似乎相关，但从评论中我了解到 D2007 中不存在有问题的错误。

 *不过，这里更需要社区的验证。

### 如何修复 < D2007 的版本？

覆盖`WM_NCPAINT`消息处理程序：

```
 private
    procedure WMNCPaint(var Message: TWMNCPaint); message WM_NCPAINT;

procedure TForm1.WMNCPaint(var Message: TWMNCPaint);
{$IF CompilerVersion < 19}
var
  DC: HDC;
  WindowStyle: Longint;
  TotalBorderWidth: Integer;
{$IFEND}
begin
{$IF CompilerVersion < 19}
  DC := GetWindowDC(Handle);
  try
    WindowStyle := GetWindowLong(Handle, GWL_STYLE);
    if WindowStyle and WS_VSCROLL <> 0 then
      TotalBorderWidth := (Width - ClientWidth - GetSystemMetrics(SM_CXVSCROLL)) div 2
    else
      TotalBorderWidth := (Width - ClientWidth) div 2;
    if WindowStyle and WS_HSCROLL <> 0 then
      FillRect(DC, Rect(0, Height - TotalBorderWidth, Width, Height), Brush.Handle);
    if WindowStyle and WS_VSCROLL <> 0 then
      FillRect(DC, Rect(Width - TotalBorderWidth, 0, Width, Height), Brush.Handle);
  finally
    ReleaseDC(Handle, DC);
  end;
{$IFEND}
  inherited;
end; 
```

两个绘制的矩形故意太大，在调整大小时给出更好的结果。*

# java - 用于简单 Web 应用程序的 Maven (Tomcat 7)

> ID：14798242
> 
> 赞同：0
> 
> 时间：2013-02-10T13:29:22.030
> 
> 标签：java, jsf, maven, jsf-2, maven-2

我尝试用 jsf 编写第一个 maven web 应用程序。我遇到了问题。我试图找到答案。每次部署我都会得到下一个堆栈跟踪

```
java.lang.NullPointerException
    com.sun.faces.context.flash.ELFlash.getPhaseMapForReading(ELFlash.java:736)
    com.sun.faces.context.flash.ELFlash.isEmpty(ELFlash.java:465)
    com.sun.faces.facelets.util.DevTools.writeVariables(DevTools.java:318)
    com.sun.faces.facelets.util.DevTools.writeVariables(DevTools.java:208)
    com.sun.faces.facelets.util.DevTools.debugHtml(DevTools.java:123)
    com.sun.faces.renderkit.RenderKitUtils.renderHtmlErrorPage(RenderKitUtils.java:1139)
    com.sun.faces.context.ExceptionHandlerImpl.throwIt(ExceptionHandlerImpl.java:249)
    com.sun.faces.context.ExceptionHandlerImpl.handle(ExceptionHandlerImpl.java:136)
    com.sun.faces.lifecycle.Phase.doPhase(Phase.java:119)
    com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    javax.faces.webapp.FacesServlet.service(FacesServlet.java:311)
note The full stack trace of the root cause is available in the Apache Tomcat/7.0.12 logs. 
```

我的绒球

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"> 
    <modelVersion>4.0.0</modelVersion>
    <groupId>by.bsuir.transport</groupId>
    <artifactId>transportApp</artifactId>
    <packaging>war</packaging>

    <version>1.0-SNAPSHOT</version>

    <properties>
    <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <java-version>1.6</java-version>
    </properties>

    <repositories>
    <repository>
        <id>prime-repo</id>
        <name>PrimeFaces Maven Repository</name>
        <url>http://repository.primefaces.org</url>
        <layout>default</layout>
    </repository>
    </repositories>

    <dependencies>
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-web-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.apache.myfaces.core</groupId>
            <artifactId>myfaces-api</artifactId>
            <version>2.1.10</version>
        </dependency>

        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.5</version>
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.8.2</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>
            <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.1.1</version>
            </plugin>
        </plugins>

    </build>
</project> 
```

我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         id="WebApp_ID" version="3.0" metadata-complete="true">
    <welcome-file-list>
        <welcome-file>index.xhtml</welcome-file>
    </welcome-file-list>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>
    <context-param>
        <param-name>javax.faces.PROJECT_STAGE</param-name>
        <param-value>Development</param-value>
    </context-param>
    <context-param>
        <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
        <param-value>.xhtml</param-value>
    </context-param>
    <context-param>
        <param-name>facelets.SKIP_COMMENTS</param-name>
        <param-value>true</param-value>
    </context-param>
    <context-param>
        <param-name>javax.faces.FACELETS_VIEW_MAPPINGS</param-name>
        <param-value>.xhtml</param-value>
    </context-param>
    <context-param>
        <param-name>javax.faces.DATETIMECONVERTER_DEFAULT_TIMEZONE_IS_SYSTEM_TIMEZONE</param-name>
        <param-value>true</param-value>
    </context-param>
    <context-param>
        <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
        <param-value>client</param-value>
    </context-param>
    <context-param>
        <param-name>org.apache.myfaces.ALLOW_JAVASCRIPT</param-name>
        <param-value>true</param-value>
    </context-param>
    <context-param>
        <param-name>org.apache.myfaces.AUTO_SCROLL</param-name>
        <param-value>true</param-value>
    </context-param>
    <context-param>
        <param-name>org.apache.myfaces.DETECT_JAVASCRIPT</param-name>
        <param-value>false</param-value>
    </context-param>
    <context-param>
        <param-name>org.apache.myfaces.PRETTY_HTML</param-name>
        <param-value>true</param-value>
    </context-param>
</web-app> 
```

这个问题的原因可能是什么&

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T18:50:03.830

我更改了依赖项并且它有效

```
<dependencies>

        <dependency>
            <groupId>org.apache.myfaces.core</groupId>
            <artifactId>myfaces-api</artifactId>
            <version>2.1.10</version>
        </dependency>

        <dependency>
            <groupId>org.apache.myfaces.core</groupId>
            <artifactId>myfaces-impl</artifactId>
            <version>2.1.10</version>
        </dependency>

        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.5</version>
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.8.2</version>
            <scope>test</scope>
        </dependency>
    </dependencies> 
```

# android - Android：倒计时不工作

> ID：14798244
> 
> 赞同：1
> 
> 时间：2013-02-10T13:29:34.707
> 
> 标签：android, countdown, countdowntimer

我正在尝试为我的应用程序创建一个倒数计时器，但是在这样做之后`TextView`，它应该显示剩余时间的位置没有显示任何内容，因此我的计时器无法正常工作。我不知道我是否错过了什么。

这是我的计时器：

```
 setContentView(R.layout.layout7);
         cronometro = (TextView) findViewById(R.id.cronometro);
         new CountDownTimer(60000, 1000) {

                public void onTick(long millisUntilFinished) {
                    cronometro.setText(Long.toString(millisUntilFinished / 1000));
                }

                public void onFinish() {
                   cronometro.setText("done!"); 
                }
             }.start(); 
```

**编辑：**正如西蒙所说，改变定时器现在工作的一些东西。有没有办法将格式设置为 MM:SS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:10:04.090

```
cronometro.setText(DateUtils.formatElapsedTime(millisUntilFinished/1000)); 
```

# c++ - 回调函数混淆参数？

> ID：14798245
> 
> 赞同：0
> 
> 时间：2013-02-10T13:29:36.283
> 
> 标签：c++, callback, containers, sfml

我有一个 sfml 窗口容器，它似乎正在工作，但是 glViewPorts 的大小错误，我认为这是因为传递了错误的 sf::Window。

这是一个添加到窗口的函数：它获取有关 sfml 窗口的一些信息。

```
int WindowContainer::PushBack(WindowData& data)
{
    if(data.WindowSettingsOK() && data.VideoModeOK()){

        mWindowVector.resize(mWindowVector.size() + 1);
        mDisplayFuncVector.resize(mWindowVector.size());
        mInputFuncVector.resize(mWindowVector.size());

        mWindowVector.at(mWindowVector.size() - 1) = new sf::Window();
        mWindowVector.at(mWindowVector.size() - 1)->Create(data.VideoMode(), data.Title(), data.Style(), data.Settings());
        mWindowVector.at(mWindowVector.size() - 1)->SetPosition(data.PositionX(), data.PositionY());

        mDisplayFuncVector.at(mWindowVector.size() - 1) = nullptr;
        mInputFuncVector.at(mWindowVector.size() - 1) = nullptr;

        return 0;
    }
    else{
        PrintError(ErrorMessageType::BadSettings);
        return 1;
    }
} 
```

或者，可以调用此函数来设置显示和输入函数回调：

```
int WindowContainer::PushBack(WindowData& data, function_p displayFunc, function_p inputFunc)
{
    int return_val = PushBack(data);
    mDisplayFuncVector.at(mWindowVector.size() - 1) = displayFunc;
    mInputFuncVector.at(mWindowVector.size() - 1) = inputFunc;

    return return_val;
} 
```

然后，当窗口需要`.Display()`'ing 时，调用此函数：

```
void WindowContainer::ProcessDisplay()
{
    for(unsigned int i = 0; i < mWindowVector.size(); i ++){
        if(mDisplayFuncVector.at(i) != nullptr){
            mDisplayFuncVector.at(i)(*mWindowVector.at(i), mClock, (const void*&)mExternalDrawingDataPointer);
        }
        mWindowVector.at(i)->Display();
    }
} 
```

...这一切都很好，直到屏幕上的结果是调整一个窗口的大小会影响两个窗口的视口。这表明调用回调函数：`mDisplayFuncVector.at(i)(*mWindowVector.at(i), mClock, (const void*&)mExternalDrawingDataPointer);`给出`*mWindowVector.at(0)`每次的参数，而不是单独的每个窗口。（如`*mWindowVector.at(i)`）

任何人都可以帮助解决这个问题吗？

主循环包含以下代码：

```
while(container.Access(0)->IsOpened()){
    container.ProcessInput();
    container.ProcessDisplay();
} 
```

`Container.Access(int)`是这个功能：

```
const sf::Window*& WindowContainer::Access(unsigned int index)
{
    if(index > mWindowVector.size()){
        PrintError(ErrorMessageType::IndexOutOfRange);
    }
    else{
        return (const sf::Window*&)mWindowVector.at(index);
    }
    return (const sf::Window*&)mWindowVector.at(0);
} 
```

再次感谢，我确定我在某处犯了错误，但无法发现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:36:26.220

我一直在考虑这个问题，并且怀疑如果在没有调用 Display() 来同步所有内容的情况下将多个对象推回，openGL 会混淆它绘制到哪个窗口。

我还没有对此进行测试和确认。

**编辑**窗口容器现在可以工作了。它与回调函数参数无关。

# video - 是否有适用于 43 行或更多行的标准 BIOS Int 10h 视频模式？

> ID：14798249
> 
> 赞同：4
> 
> 时间：2013-02-10T13:30:06.957
> 
> 标签：video, x86, bios, real-mode

我正在编写在加载任何操作系统之前以实模式运行的代码。我的程序的一部分涉及将信息转储到视频显示器，而标准的 80x25 文本模式并没有削减它。

许多版本的 Windows 和其他操作系统似乎可以毫无问题地切换到更大的文本模式，我认为是 43 行，当它们显示内核恐慌时。我知道更大的文本模式已经存在了很长时间，所以我希望至少有一种标准模式。

这里有一个相当大的 BIOS 视频模式列表：

[http://www.columbia.edu/~em36/wpdos/videomodes.txt](http://www.columbia.edu/~em36/wpdos/videomodes.txt)

不幸的是，相同的模式编号似乎在芯片组之间的含义差异很大。

曾几何时，我似乎记得曾经使用一种名为 VESA BIOS 的东西以独立于设备的方式访问 Super VGA 图形模式，但我似乎还记得涉及必须加载的 DOS TSR。这不是一个选项在这里，因为 DOS 没有运行。

我正在寻找一种可以在最广泛的硬件上运行的模式，包括 VMware ESXi 中的虚拟视频适配器。更改模式的代码也需要紧凑，所以我希望一个简单的 Int 10h 可以做到。

有任何想法吗？Windows 和 VMware 内核恐慌是如何做到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:53:59.490

您可以使用 80x25 模式并加载 8x8 字体（ax = 1112h），这将产生 80x50 字符。据我所知，这是相当标准的。

# html - 如何通过单击不同的表单按钮而不使用javascript将文本框值传递到下一个jsp页面

> ID：14798250
> 
> 赞同：0
> 
> 时间：2013-02-10T13:30:16.927
> 
> 标签：html, jsp

这是我的代码

```
<body>
<input type=text name=name>
<form action=new3.jsp method=post name="f1">
<input type=text name=name>
<input type=submit value=next>
</form>
<form action=new1.jsp method=post>
<input type=submit value=back>
</form>
</body> 
```

如您所见，这里有两个表单，其中有两个不同的提交按钮，分别名为“next”和“back”。文本框采用“下一步”按钮所在的形式。我的问题是如何将此文本框的值发送到“new1.jsp”单击“后退按钮”而不使用javascript。提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:54:30.780

不要将表单发布到 JSP。改为发布到 servlet，让服务器分析参数并根据单击的按钮转发到适当的 JSP：

```
<form action="/controllerServlet" method="post" name="f1">
    <input type="text" name="name"/>
    <input type="submit" name="destination" value="next"/>
    <input type="submit" name="destination" value="back"/>
</form> 
```

使用上述形式（顺便说一句，它是有效的 HTML），servlet 可以使用“destination”参数的值。如果是“下一个”，它应该转发到`new3.jsp`. 如果是`back`，它应该转发到“new1.jsp”。例如，如果您想重新显示同一页面，因为用户没有在文本字段中输入有效值，它可以这样做。

这就是著名的 MVC 模式。你应该使用它。

# java - 如何启动音乐播放器

> ID：14798251
> 
> 赞同：1
> 
> 时间：2013-02-10T13:30:35.087
> 
> 标签：java, android, android-intent

我想怎么用这个

```
android.intent.category.APP_MUSIC 
```

启动音乐播放器？如果我调用 makeMainSelectorActivity 它不起作用

```
 Intent intent = new Intent();  
 intent.makeMainSelectorActivity(intent.ACTION_MAIN, 
 "android.intent.category.APP_MUSIC");
  startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-19T05:36:25.303

此解决方案可能会帮助希望启动默认音乐播放器的人：

```
if(android.os.Build.VERSION.SDK_INT>=15){        
    Intent intent=Intent.makeMainSelectorActivity(Intent.ACTION_MAIN,
    Intent.CATEGORY_APP_MUSIC);
    intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);//Min SDK 15
    startActivity(intent);
}else{
    Intent intent = new Intent("android.intent.action.MUSIC_PLAYER");//Min SDK 8
    startActivity(intent);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T13:52:08.727

使用以下代码：

```
Uri uri = Uri.withAppendedPath(MediaStore.Audio.Media.INTERNAL_CONTENT_URI, "1");   
Intent it = new Intent(Intent.ACTION_VIEW, uri);   
startActivity(it); 
```

或者

```
Intent intent = new Intent("android.intent.action.MUSIC_PLAYER");
startActivity(intent); 
```

Ans 也更喜欢 url ：

[启动默认音乐播放器](https://stackoverflow.com/questions/14792018/launching-the-default-music-player)

# c# - 强制对特定对象和任何扩展的修改是原子的

> ID：14798254
> 
> 赞同：0
> 
> 时间：2013-02-10T13:31:01.040
> 
> 标签：c#, concurrency, locking

我有一点读者/作家的问题。

我有一个特定对象的静态集合，许多读者和作者可以同时访问这些对象。

作者将从集合处理程序中获取一个项目，然后以某种方式对其进行修改。

阅读器可以从集合处理程序中获取该特定项目，然后以某种方式显示它。

现在我意识到这个问题的标准解决方案是创建一个锁（或一个 ReaderWriter 锁）并强制每个写入器和读取器进入锁。问题是我不是唯一一个添加读取器/写入器的人，因此有人可能会忘记在他们的实现中使用锁并破坏一切。

那么有没有办法从对象的角度强制所有更改以原子方式进行？请记住，该对象将以多种形式扩展，并且它们也必须以这种方式进行约束。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:12:50.867

如果您的对象的消费者不能被信任遵守安全规则，那么您就有一个大问题。我可以看到两种解决方案：

1）什么都不做。如果您的消费者编写了损坏的代码，那么他们发现自己的痛苦将成为不再这样做的良好动力。

1a）你可以让他们的痛苦更加痛苦，比如说，让你的对象以某种方式检测它何时被读取而没有读锁并抛出异常。这就是我们在为 JScript 和 VBScript 引擎设计线程规则时所做的；如果用户曾经在不支持该方法的线程上调用某个方法，那么引擎将返回“灾难性故障”错误代码。引擎的用户不会两次犯同样的错误；他们很快就知道哪个是正确的线程，哪个是错误的线程，并停止调用错误的线程。

这是一个更好的解决方案，而不是简单地让调用在大多数情况下成功，然后在百万分之一的情况下死于一些疯狂的竞争条件问题。

2）将获取锁的责任移到对象中。让消费者正常使用对象；对象在读取或写入时取出自己的读写器锁。

# unit-testing - 如何在动态脚手架 Grails 控制器的集成测试中模拟服务？

> ID：14798255
> 
> 赞同：1
> 
> 时间：2013-02-10T13:31:03.123
> 
> 标签：unit-testing, grails, mocking

我正在尝试在动态脚手架控制器的集成测试中模拟服务。我收到一条错误消息，表明无法从测试中访问服务的控制器属性。

似乎根本无法使用单元测试来测试动态脚手架控制器，所以我正在使用集成测试。我想模拟该服务以测试我的应用程序中的错误处理。这是 Grails 2.2.0 中的错误还是我做错了？

结果`grails test-app`是：

```
groovy.lang.MissingPropertyException: No such property: myService for class: MyController 
```

例子：

我修改了`src/templates/scaffolding/Controller.groovy`：

```
class ${className}Controller {
  MyService myService

  def action() {
    render myService.serviceMethod()
  }
} 
```

动态脚手架`MyController.groovy`：

```
class MyController {
    static scaffold = MyDomainClass
} 
```

集成测试`MyControllerTests.groovy`：

```
class MyControllerTests extends GroovyTestCase {
  def myController

  @Before
  void setUp() {
    myController = new MyController()
  }

  void testMock() {
    myController.myService = [ serviceMethod : { return "foo" } ] as MyService
    controller.action()
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:24:37.610

尝试使用 setter 方法：

```
void testMock() {
    myController.setMyService([ serviceMethod : { return "foo" } ])
    controller.action()
} 
```

如果你执行: `println c.metaClass.methods*.name`，你会看到有getSetMyService() 和getGetMyService() 之类的方法。我不确定，但可能 Grails 没有添加字段，而是添加字段获取/设置方法的 getter。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T17:13:48.590

集成测试应按如下所示实施。如果我们在测试中模拟服务，我们必须自己重置它。Grails 不会为我们做这件事，这很神秘，因为控制器是在`setUp()`.

droggo 上面的回答揭示了在 SUT 中注入模拟的正确方法。我还将添加一个使用 Groovy 模拟的示例。虽然它有点冗长。

```
class MyControllerTests extends GroovyTestCase {
  def myController
  def myService

  @Before
  void setUp() {
    myController = new MyController()
  }

  @After
  void tearDown() {
    myController.setMyService(myService)
  }

  void testMapMock() {
    myController.setMyService([ serviceMethod : { return "foo" } ] as MyService)
    controller.action()
  }

  void testGroovyMock() {
    def myServiceMockContext = new StubFor(MyService)
    myServiceMockContext.demand.serviceMethod() { -> return "bar" }
    def myService = myServiceMockContext.proxyInstance()
    controller.setMyService(myService)
    controller.action()
  }
} 
```

# c# - 如果没有任何 SQL 异常，如何显示消息

> ID：14798259
> 
> 赞同：0
> 
> 时间：2013-02-10T13:31:36.067
> 
> 标签：c#, sql, exception, try-catch

我想简单地通知用户他们已成功将新数据插入数据库。

这是我到目前为止所拥有的：

```
try { cont.NewMember(txtSS.Text, txtName.Text, txtCity.Text, txtStreet.Text, txtZipcode.Text, txtEmail.Text, txtPhone.Text); }
catch (SqlException ex) { MessageBox.Show("The social security number \"" + txtSS.Text + "\"is already registered"); }

MessageBox.Show("Added succesfully"); 
```

仅当（显然）没有异常时，我才想显示“已成功添加”。更新本身运行良好，但始终显示“已添加...”消息（即使出现异常）。

我该如何解决这个问题，使用 C#？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T13:32:31.873

将语句放在块`MessageBox...`的末尾`try`

```
try 
{ 
    cont.NewMember(txtSS.Text, txtName.Text, txtCity.Text, txtStreet.Text, txtZipcode.Text, txtEmail.Text, txtPhone.Text);
    MessageBox.Show("Added succesfully"); 
}
catch (SqlException ex) 
{ 
    MessageBox.Show("The social security number \"" + txtSS.Text + "\"is already registered"); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T09:44:53.123

这不是正确的做法。您怎么知道异常是因为 SSN 已存在于数据库中。对于许多其他情况，例如连接失败等，它可能会引发异常......

最佳实践是在数据库中处理所有这些。

参考处理数据库中的异常。

# ruby-on-rails - 由于 PowerPC 架构，无法获取 RVM 文件

> ID：14798260
> 
> 赞同：2
> 
> 时间：2013-02-10T13:31:37.080
> 
> 标签：ruby-on-rails, rvm, powerpc

我在 OS X 10.7.5 上从 railsinstaller.org 运行 railsinstaller，然后在 RVM 上遇到了一些问题：

1）首先，我得到“RVM：找不到命令”。所以我创建了 .bash_profile 并添加了

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" 
```

2）重新启动终端，但仍然收到相同的错误消息。我检查了 .rvm 文件夹，看看它是否安装正确；它似乎缺少“脚本”文件夹。所以我跑了

```
\curl -L https://get.rvm.io | bash -s stable 
```

3）然后我得到这个：

```
Launch of "gtar" failed: the PowerPC architecture is no longer supported. Could not extract RVM sources. 
```

根据我的研究，这意味着我需要一台 Intel 64 位机器。但我仔细检查了一下，这确实是我所拥有的（英特尔酷睿双核 2）。我一直在花费数小时试图找到更多相关文档但无济于事，所以我真的被困住了，因为我的项目需要 RVM。

我真的很感激任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:26:22.340

在我的研究中，**Jewelry Box 似乎不支持较新版本的 RVM**。我实际上不知道这是否是您遇到的问题，但似乎很可能。我建议卸载 Jewelry Box 并重新安装 RVM。

要重新安装 RVM，您需要完全[删除 RVM](https://stackoverflow.com/questions/3558656/how-to-remove-rvm-ruby-version-manager-from-my-system)，然后使用之前使用的相同字符串，但这次在末尾添加 --rails，这样您也可以获得 rails。

```
\curl -L https://get.rvm.io | bash -s stable --rails 
```

rails 安装程序的其他部分应该仍然存在，例如 git 和 sm。

珠宝盒将不再有用，但为此我强烈建议您了解 Bundler。使用红宝石的事实标准。在使用 rails 时它会更有用，并且不太可能遇到依赖问题。

也欢迎 Rails，坚持下去，你很快就会成为专业人士。我强烈推荐看看[Rails Casts](http://railscasts.com)。非常好的 Rails 短视频教程。

希望有帮助。

# php - PDO：找不到驱动程序 php/mysql

> ID：14798262
> 
> 赞同：5
> 
> 时间：2013-02-10T13:31:57.157
> 
> 标签：php, mysql, pdo

我在连接到我拥有的网络主机上的数据库时遇到问题，我正在使用以下内容：

```
$dsn = 'mysql:host=mysql1.hosting.digiweb.ie;dbname=mydbname';
 $user = 'myusername';
 $password = 'mypassword'; 
```

根据网站：主机名mysql1.hosting.digiweb.ie（ip地址）

正如标题所说，我遇到了找不到驱动程序错误，我是否错误地输入了主机，我尝试输入上面的内容以及 IP 地址 - 谢谢！

编辑：

这是我所有的代码

```
<?php

 $dsn = 'mysql:host=localhost;dbname=';
 $user = '';
 $password = '';

try {
  // Connect and create the PDO object
 $dbh = new PDO($dsn, $user, $password);
 $dbh->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION);
}
catch(PDOException $e) {
 echo 'Database connection failed - ';
 echo $e->getMessage();
 exit;
}

echo 'works';
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T14:00:50.990

go to your php.ini file and uncomment this line

```
 extension=php_pdo_mysql.dll 
```

and then restart your apache

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-21T18:30:48.007

在 php.ini 中将扩展目录更改为绝对目录。我把它从

```
extension_dir = "ext" 
```

至

```
extension_dir = "C:/{PATH TO PHP DIRECTORY}/ext" 
```

它奏效了。

# c# - 如何在gridview的rowcommand事件中在新选项卡中打开页面？

> ID：14798264
> 
> 赞同：4
> 
> 时间：2013-02-10T13:32:10.690
> 
> 标签：c#, javascript, jquery, asp.net, gridview

我有以下代码：

```
protected void gv_inbox_RowCommand(object sender, GridViewCommandEventArgs e)
{
    int index = Convert.ToInt32(e.CommandArgument);

    if (e.CommandName == "sign")
    {
        Session["TransYear"] = int.Parse(((HiddenField)gv_inbox.Rows[index].Cells[1].FindControl("HDN_TransYear")).Value);
        Session["MailNumber"] = int.Parse(((HiddenField)gv_inbox.Rows[index].Cells[1].FindControl("HDN_MailNumber")).Value);
        Response.Redirect("Signature.aspx", false);
        //Response.Write("<script>");
        //Response.Write("window.open('Signature.aspx','_blank')");
        //Response.Write("</script>");
    }
} 
```

我想在新选项卡或窗口中打开页面。注释代码会这样做，但是当`refresh`原始页面导致错误时`Signature.aspx`。如何在我的 gridview 的行命令事件中以正确的方式在新窗口或选项卡中打开。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T20:55:38.270

您要做的是使用`ScriptManager`来进行 JavaScript 调用。

您定义的 JavaScript 片段有效，但是，您需要负责`ScriptManager`为您执行它。

```
String js = "window.open('Signature.aspx', '_blank');";
ScriptManager.RegisterClientScriptBlock(this, this.GetType(), "Open Signature.aspx", js, true); 
```

using 的问题`Response.Write`是，在 期间`PostBack`，浏览器*不会*执行脚本标签。另一方面，在使用 时`ScriptManager.RegisterClientScriptBlock`，ASP.NET`ScriptManager`会自动执行代码。

**更新 - 2013/02/14**

正如[弗拉迪斯拉夫的回答](https://stackoverflow.com/a/14875305/238722)所建议的那样，使用`ClientScript`vs. `ScriptManager`; 区别在于`ClientScript`仅用于*同步*回发（no `asp:UpdatePanel`），而`ScriptManager`用于异步回发（使用`asp:UpdatePanel`）。

此外，根据以下作者的评论 - 将其包含`asp:GridView`在 an`asp:UpdatePanel`中将消除确认刷新的浏览器消息。同步回发（no）后刷新页面时`asp:UpdatePanel`，浏览器将重新发送最后一条命令，导致服务器再次执行相同的过程。

最后，当将 an`asp:UpdatePanel`与 结合使用时`ScriptManager.RegisterClientScriptBlock`，请确保将第一个和第二个参数更新为`asp:UpdatePanel`对象。

```
ScriptManager.RegisterClientScriptBlock(updatePanel1, updatePanel1.GetType(), "Open Signature.aspx", js, true); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T17:00:42.877

首先，这里的练习是如何将简单的值从一个页面传递到另一个页面。

在您的情况下，这些只是键/值，因此您可以通过 GET 传递它们。

您需要呈现每一行，而不是命令按钮。

```
<a href="Signature.aspx?TransYear=value1&MailNumber=value2" target="_blank">
    Sign
</a> 
```

在此示例中，value1 和 value2 是您分别写入 HDN_TransYear 和 HDN_MailNumber 的值。

在 Signature.aspx 中，如果您想使用会话变量，则必须执行以下操作：

```
Session["TransYear"]
Session["MailNumber"] 
```

现在应该改成这样：

```
Request.QueryString["TransYear"]
Request.QueryString["MailNumber"] 
```

这通常会满足您的要求。但...

如果您说此方法不安全，那么任何人都可以通过更改参数值来使用查询字符串变量，那么...

为每一行计算一个签名，将此签名作为第三个参数放在查询字符串中，并验证另一侧的值和签名。

如何计算签名，这取决于你。那是你的**秘诀**。有很多散列函数和加盐算法。

作为一个非常简单的例子：

```
string signature = CRC32(HDN_TransYear + "stuff that you only know" + HDN_MailNumber) 
```

然后你的链接应该是这样的：

```
<a href="Signature.aspx?TransYear=2012&MailNumber=1&sig=8d708768" target="_blank">
    Sign
</a> 
```

在 Signature.aspx 中，您使用来自查询字符串的值和“您只知道的东西”再次计算 CRC32 签名，并根据在查询字符串中作为参数传递的签名进行验证。

没有剧情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T02:42:32.470

为什么要在打开新窗口之前设置会话？

**如果在打开新窗口后**设置会话是可以的，我认为你可以在后面的代码中进行设置`Signature.aspx`，考虑到你已经将所需的参数作为查询字符串传递，正如@David 指出的那样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-14T12:53:16.507

我宁愿使用 `ClientScript.RegisterStartupScript(this.GetType(), "Open Signature.aspx", js, true);` ，你不需要刷新你的页面。页面从回发中恢复后，脚本块将触发。

只是一个建议：-在您的情况下是否可以使用 DataKeys 来检索 TransYear 和 MailNumber 的值而不是使用 HiddenFields

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-18T17:49:56.833

我们已经成功使用以下代码多年了。这几种方法是从一个更大的通用模块中提取出来的，但我想我已经包含了所有内容......

```
public class Utilities
{
    /// <summary>
    /// This will return the first parent of the control that is an update panel
    /// </summary>
    /// <param name="source">The source control</param>
    /// <returns>The first parent found for the control. Null otherwise</returns>
    public static UpdatePanel GetFirstParentUpdatePanel(Control source)
    {
        Page currentPage = source.Page;
        UpdatePanel updatePanel = null;
        Type updatePanelType = typeof(UpdatePanel);
        object test = source.Parent;
        while (test != null && test != currentPage)
        {
            // is this an update panel
            if (test.GetType().FullName == updatePanelType.FullName)
            {
                // we've found the containing UpdatePanel
                updatePanel = (UpdatePanel)test;
            }

            // check the next parent
            test = ((Control)test).Parent;
        } // next test

        return updatePanel;
    }

    /// <summary>
    /// This will open the specified url in a new window by injecting a small script in
    /// the current page that is run when the page is sent to the client's browser.
    /// This method accounts for the presence of update panels and script managers on the
    /// page that the control resides in.
    /// </summary>
    /// <param name="source">The control that the call is being made from</param>
    /// <param name="url">The URL to bring up in a new window</param>
    public static void RedirectToNewWindow(Control source, string url)
    {
        // create the script to register
        string scriptKey = "_NewWindow";
        string script = "window.open('" + url + "');";
        RegisterControlScript(source, scriptKey, script);
    }

    /// <summary>
    /// This will register a script for a specific control accounting for the control's UpdatePanel
    /// and whether or not there is a script manager on the page
    /// </summary>
    /// <param name="source">The control that will be affected by the script</param>
    /// <param name="scriptKey">A unique key for the script</param>
    /// <param name="script">The script that will affect the control</param>
    public static void RegisterControlScript(Control source, string scriptKey, string script)
    {
        // get the control's page
        Page currentPage = source.Page;

        // does the control reside in an UpdatePanel
        UpdatePanel updatePanel = GetFirstParentUpdatePanel(source);

        // did we find the UpdatePanel
        if (updatePanel == null)
        {
            // register the script on the page (works outside the control being in an update panel)
            currentPage.ClientScript.RegisterStartupScript(currentPage.GetType(), scriptKey,
                                                           script, true /*addScriptTags*/);
        }
        else
        {
            // register the script with the UpdatePanel and ScriptManger
            ScriptManager.RegisterClientScriptBlock(source, source.GetType(), scriptKey,
                                                    script, true /*addScriptTags*/);
        } // did we find the UpdatePanel
    }
} 
```

然后，为了你的使用，你会打电话

```
protected void gv_inbox_RowCommand(object sender, GridViewCommandEventArgs e)
{
    int index = Convert.ToInt32(e.CommandArgument);

    if (e.CommandName == "sign")
    {
        Session["TransYear"] = int.Parse(((HiddenField)gv_inbox.Rows[index].Cells[1].FindControl("HDN_TransYear")).Value);
        Session["MailNumber"] = int.Parse(((HiddenField)gv_inbox.Rows[index].Cells[1].FindControl("HDN_MailNumber")).Value);
        Utilities.RedirectToNewWindow(gv_inbox, "Signature.aspx");
    }
} 
```

不是最简洁的代码，因为我已经提取了这些帮助方法，但你明白了。上面的代码适用于 c#2.0 及更高版本，无论`UpdatePanel`嵌套如何，甚至根本不`UpdatePanel`使用 s 都可以工作

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-20T07:09:15.563

为什么我们使用回发来在 URL 的不同窗口中打开链接。

在创建控件链接时，我们可以将 signature.aspx 所需的值作为 Querystring 嵌入到链接控件上，这将只是一个简单的浏览器单击。

我希望这是简单而干净的。

# html - 为所有浏览器制作全宽图像（bg）

> ID：14798267
> 
> 赞同：0
> 
> 时间：2013-02-10T13:32:37.260
> 
> 标签：html, css

我正在尝试制作目前大约 1500 像素全宽的横幅图像，我已将其设置为背景图像，因此我可以在上面播放一些元素，我知道您可以制作全宽图像标签，但我我不确定你是否可以对背景图像标签做同样的事情！

这是我的代码；

```
<div id="bannerbg">
     <div class="container">
          <p id="bannertxt">demo text</p>
     </div>
</div>

.container{
    width:980px;
    margin:0px auto;
}

#bannerbg{
    background-image:url('../images/banner.png');
    width:1520px;
    height:369px;
    background-repeat: no-repeat;
    margin:0px auto;
    position: absolute;
}

#bannertxt{
    background:rgba(0,0,0,0.5);
    font-size:26px;
    font-family: 'Roboto Condensed', sans-serif;
    width:300px;
    color:white;
}

.bannertxt{
    padding-top:40px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:45:38.597

Maybe you are looking for:

```
#bannerbg{
  /*Your code*/
  background-size:cover;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:40:12.733

尝试使用这个：

```
* {
    margin:0;
    padding:0;
} 
```

[这](http://jsfiddle.net/YmSB6/)是一个工作示例。

# magento - 错误处理请求：Mage 注册表项“_singleton/incho_notes/feed_updates”已经存在

> ID：14798268
> 
> 赞同：2
> 
> 时间：2013-02-10T13:33:07.557
> 
> 标签：magento, admin

每当我通过magento connect安装inhcoo特色2.0（magento扩展）后尝试登录magento admin时，我都会收到此错误消息：

```
There has been an error processing your request
Mage registry key "_singleton/inchoo_notes/feed_updates" already exists

Trace:

#0 /home/.../public_html/app/Mage.php(222): Mage::throwException('Mage registry k...')
#1 /home/.../public_html/app/Mage.php(476): Mage::register('_singleton/inch...', false)
#2 /home/..../public_html/includes/src/__default.php(20995): Mage::getSingleton('inchoo_notes/fe...')
#3 /home/...../public_html/app/Mage.php(447): Mage_Core_Model_App->dispatchEvent('controller_acti...', Array)
#4 /home/..../public_html/includes/src/__default.php(13663): Mage::dispatchEvent('controller_acti...', Array)
#5 /home/..../public_html/includes/src/Mage_Adminhtml_Controller_Action.php(160): Mage_Core_Controller_Varien_Action->preDispatch()
#6 /home/..../public_html/includes/src/__default.php(13543): Mage_Adminhtml_Controller_Action->preDispatch()
#7 /home/..../public_html/includes/src/__default.php(17899): Mage_Core_Controller_Varien_Action->dispatch('login')
#8 /home/..../public_html/includes/src/__default.php(17456): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#9 /home/..../public_html/includes/src/__default.php(20033): Mage_Core_Controller_Varien_Front->dispatch()
#10 /home/..../public_html/app/Mage.php(683): Mage_Core_Model_App->run(Array)
#11 /home/..../public_html/index.php(89): Mage::run('', 'store')
#12 {main} 
```

错误日志记录号：214959287644

我该如何解决这个问题？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T17:05:48.867

当尝试调用单例（模型或助手）但无法映射时，会发生此特定错误。根据我在堆栈跟踪中看到的路径，看起来好像您已启用编译。您应该在尝试安装此模块时禁用编译，这可以在管理 GUI 中的**System > Compilation**中完成。

# iphone - 用于 GUID 的 iPhone 正则表达式

> ID：14798272
> 
> 赞同：0
> 
> 时间：2013-02-10T13:33:52.450
> 
> 标签：iphone, regex, hex, guid

我正在寻找一些简单的 iPhone 正则表达式来验证 NSString 是否为有效的十六进制格式，仅包含 0-9 和 af 的字符。GUID 也是如此。或者是否已经内置了一个函数来检查 GUID 是否有效？

我只发现了一些关于创建 GUID 的帖子。[这个](https://stackoverflow.com/a/427521/633945)SO 答案是以我正在使用的格式创建 GUID。

示例 GUID

```
ADD2B9F7-A699-4EF3-9A70-130B92154B11 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-10T15:42:19.743

为了简化 Zaph 的正确答案，只需将此方法添加到 NSString 上的类别中：

```
-(BOOL) isGuid {
    NSString *regexString = @"[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}";
    NSRange guidValidationRange = [self rangeOfString:regexString options:NSRegularExpressionSearch];
    return (guidValidationRange.location == 0 && guidValidationRange.length == self.length);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T14:04:19.960

一种方法是使用`NSCharacterSet`：

```
NSString *testCharacters = @"ABCDEFabcdef0123456789-";
NSCharacterSet *testCharacterSet = [[NSCharacterSet characterSetWithCharactersInString:testCharacters] invertedSet];

NSString *testString1 = @"ADD2B9F7-A699-4EF3-9A70-130B92154B11";
NSRange range1 = [testString1 rangeOfCharacterFromSet:testCharacterSet];
NSLog(@"testString1: %@", (range1.location == NSNotFound) ? @"Good" : @"Bad");

NSString *testString2 = @"zDD2B9F7-A699-4EF3-9A70-130B92154B11";
NSRange range2 = [testString2 rangeOfCharacterFromSet:testCharacterSet];
NSLog(@"testString2: %@", (range2.location == NSNotFound) ? @"Good" : @"Bad"); 
```

NSLog 输出：

```
testString1: Good
testString2: Bad 
```

或使用 RE：

```
NSString *reString = @"[a-fA-F0-9-]+";

NSString *testString1 = @"ADD2B9F7-A699-4EF3-9A70-130B92154B11";
NSRange range1 = [testString1 rangeOfString:reString options:NSRegularExpressionSearch];
NSLog(@"testString1: %@", (range1.location != NSNotFound && range1.length == testString1.length) ? @"Good" : @"Bad");

NSString *testString2 = @"zDD2B9F7-A699-4EF3-9A70-130B92154B11";
NSRange range2 = [testString2 rangeOfString:reString options:NSRegularExpressionSearch];
NSLog(@"testString2: %@", (range1.location != NSNotFound && range2.length == testString2.length) ? @"Good" : @"Bad"); 
```

对于更严格的 GUID 匹配：

```
NSString *reString = @"[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"; 
```

# php - 计算 wordpress 站点视图

> ID：14798273
> 
> 赞同：-1
> 
> 时间：2013-02-10T13:33:57.543
> 
> 标签：php, wordpress

我创建了计算站点视图的函数，我调用了`add_action('init', 'wp125_adview');`，但是当我在仪表板函数中时，一个问题也计算了我的视图，我希望这个函数只计算站点中的视图而不是管理面板中的视图，也许是`add_action`它的一些参数不会从仪表板进行 cal 功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:45:03.013

I found it's `add_action('wp', 'wp125_adview');` , when I'm in dashboard wordpess not call function `wp125_adview();`

# php - 在 MYSQL 数据库中存储密码的最佳方法

> ID：14798275
> 
> 赞同：43
> 
> 时间：2013-02-10T13:34:04.770
> 
> 标签：php

是的，我知道不建议以纯文本形式存储密码。是否有一种最好、最简单的方法来存储密码，以便应用程序保持安全？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-02-10T13:40:04.670

首先，md5 和 sha1 已被证明容易受到碰撞攻击，并且可以很容易地被彩虹表（当他们看到你的哈希在他们的常用密码数据库中是否相同时）。

目前有两件事对于您可以使用的密码来说是足够安全的。

第一个是sha512。sha512 是 SHA2 的子版本。SHA2 尚未被证明容易受到碰撞攻击，sha512 将生成 512 位哈希。以下是如何使用 sha512 的示例：

```
<?php
hash('sha512',$password); 
```

另一个选项称为 bcrypt。bcrypt 以其安全散列而闻名。它可能是最安全的，也是最可定制的。

在您想开始使用 bcrypt 之前，您需要检查您的服务器是否启用了它，输入以下代码：

```
<?php
if (defined("CRYPT_BLOWFISH") && CRYPT_BLOWFISH) {
    echo "CRYPT_BLOWFISH is enabled!";
}else {
echo "CRYPT_BLOWFISH is not available";
} 
```

如果它返回它已启用，那么下一步很容易，您需要做的就是 bcrypt 密码（注意：为了获得更多可定制性，您需要查看[How do you use bcrypt for hashing passwords in PHP?](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)）：

```
crypt($password, $salt); 
```

盐通常是一个随机字符串，当您对它们进行哈希处理时，您在所有密码的末尾添加它。使用盐意味着如果有人获取了您的数据库，他们将无法检查散列以获取常用密码。使用彩虹表调用检查数据库。散列时应始终使用盐！

以下是我对 SHA1 和 MD5 碰撞攻击漏洞的证明：
[http](http://www.schneier.com/blog/archives/2012/10/when_will_we_se.html) ://www.schneier.com/blog/archives/2012/10/when_will_we_se.html，http : [//eprint.iacr.org/2010/413.pdf](http://eprint.iacr.org/2010/413.pdf) ,
[http://people.csail.mit.edu/yiqun/SHA1AttackProceedingVersion.pdf](http://people.csail.mit.edu/yiqun/SHA1AttackProceedingVersion.pdf) ,
[http://conf.isi.qut.edu.au/auscert/proceedings/2006/gauravaram06collision.pdf](http://conf.isi.qut.edu.au/auscert/proceedings/2006/gauravaram06collision.pdf)和
[了解 sha-1 碰撞弱点](https://stackoverflow.com/questions/1147830/understanding-sha-1-collision-weakness)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T13:39:39.497

sha1 和 md5 等散列算法不适用于密码存储。它们的设计非常高效。这意味着暴力破解非常快。即使黑客获得了您散列密码的副本，暴力破解也很快。如果您使用盐，它会使彩虹表的效果降低，但对蛮力没有任何作用。使用较慢的算法会使蛮力无效。例如，bcrypt 算法可以随心所欲地变慢（只需更改工作因子），并且它在内部使用盐来防止彩虹表。如果我是你，我会采用这种方法或类似方法（例如 scrypt 或 PBKDF2）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T13:40:31.453

数据库中的密码应加密存储。建议采用一种加密方式（散列），例如 SHA2、SHA2、WHIRLPOOL、bcrypt DELETED: MD5 或 SHA1。（那些年龄较大，易受伤害的

除此之外，您可以使用额外的每个用户生成的随机字符串 - 'salt'：

```
$salt = MD5($this->createSalt());

$Password = SHA2($postData['Password'] . $salt); 
```

`createSalt()`在这种情况下，是一个从随机字符生成字符串的函数。

编辑：或者如果您想要更高的安全性，您甚至可以添加 2 种盐： $salt1 。$通行证。$盐2

您可以采取的另一种安全措施是用户停用：在 5 次（或任何其他次数）错误登录尝试后，用户被阻止 x 分钟（比如说 15 分钟）。它应该最大限度地减少暴力攻击的成功。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-10T13:40:56.537

为用户存储一个唯一的盐（例如从用户名 + 电子邮件生成），并存储一个密码。登录时，从数据库中获取盐和哈希盐+密码。
使用 bcrypt 对密码进行哈希处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-10T13:42:34.953

最好使用 crypt 将密码存储在数据库中

示例代码：

```
$crypted_pass = crypt($password);

//$pass_from_login is the user entered password
//$crypted_pass is the encryption
if(crypt($pass_from_login,$crypted_pass)) == $crypted_pass)
{
   echo("hello user!")
} 
```

文档：

[http://www.php.net/manual/en/function.crypt.php](http://www.php.net/manual/en/function.crypt.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-10T13:43:58.813

您应该使用单向加密（这是一种加密值的方法，因此很难反转它）。我对 MySQL 不熟悉，但快速搜索显示它有一个 password() 函数，正是这种加密。在数据库中，您将存储加密值，当用户想要验证您提供的密码时，您使用相同的算法/函数对其进行加密，然后检查该值是否与存储在数据库中的密码相同那个用户。这假设浏览器和您的服务器之间的通信是安全的，即您使用 https。

# c# - 从非托管代码中获得一个返回 int 的外部函数是否安全

> ID：14798276
> 
> 赞同：4
> 
> 时间：2013-02-10T13:34:12.573
> 
> 标签：c#, c++, pinvoke

```
[DllImport(MyUnmanagedLibrary, CallingConvention = CallingConvention.Cdecl)]
internal static extern int MyFunction(); 
```

假设这是我从非托管 C++ 库中导入的函数。在这种情况下，外部函数被声明为返回一个`int`. 的大小`int`在托管 C# 代码中不会改变，但它会根据非托管 C++ 代码中的体系结构而改变。假设它返回一个是否安全`int`？我应该`IntPtr`改用它作为返回值吗？或者是其他东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T13:39:54.160

`int`在 C# 中是并且将永远是`System.Int32`，关键是每个 C++ 编译器（理论上）都可以自由地使用类型大小（在一定限制内）做任何它想做的事情，所以，如果你想避免不匹配，你应该改变 C++代码的一面，使其返回一个固定大小的整数（例如`int32_t`）。`IntPtr`无能为力，因为`int`没有定义为具有指针的大小（实际上，在 x86_64 上，Windows`int`是 32 位，`int *`而是 64 位）。

另一方面，由于明显的二进制兼容性原因，x86 Windows 上的任何编译器都*极*不可能定义`int`为不同于 32 位 2 的补码整数的任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:16:41.867

例如，您需要使用“-m32”或“-m64”为 g++ 设置编译器选项。更具体地根据您的“机器相关选项”[选择最佳匹配](http://ae-www.technion.ac.il/cgi-bin/man.cgi?section=all&topic=g%2b%2b)

# php - Objective-C HTTP 文件上传返回 0 字节

> ID：14798283
> 
> 赞同：0
> 
> 时间：2013-02-10T13:35:04.163
> 
> 标签：php, ios, objective-c, xcode, http

我正在尝试运行 HTTP 请求以保存图像。PHP脚本处理POST，它似乎接收到手动设置的文件名，但文件没有大小也没有保存。

我正在使用的 Obj-C 代码是：

```
 MyImage.image = [info objectForKey:UIImagePickerControllerOriginalImage];

    NSData *imageData = UIImageJPEGRepresentation(MyImage.image, 90);
    NSString *urlString = @"http://localhost/api/phptest.php";

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    NSMutableData *body = [NSMutableData data];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"ipodfile.jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [request setHTTPBody:body];

    NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
    NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];

    NSLog(returnString); 
```

我的 PHP 文件看起来像：

```
//echo basename($_FILES['userfile']['name']);
$uploaddir = '/api/uploads/';
$file = basename($_FILES['userfile']['name']);
$uploadfile = $uploaddir . $file;

echo $uploadfile."\n";
echo $file."\n";
echo $uploaddir."\n";
echo $_FILES["file"]["type"]."\n";
echo $_FILES["file"]["size"] / 1024;
if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
        echo "Uploaded";
} 
```

但是我在 XCode 中得到的回报是

```
2013-02-10 13:23:09.116 Dablia[3419:907] /api/uploads/ipodfile.jpg
ipodfile.jpg
/api/uploads/

0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:00:56.887

尝试更改内容类型，现在您正在使用它：

```
[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]]; 
```

试试这个：

```
[body appendData:[[NSString stringWithString:@"Content-Type: image/jpeg\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]]; 
```

还

```
UIImageJPEGRepresentation(UIImage *image, CGFloat compressionQuality); 
```

来自文档：

> 压缩质量
> 
> 生成的 JPEG 图像的质量，表示为 0.0 到 1.0 之间的值。值 0.0 表示最大压缩（或最低质量），而值 1.0 表示最小压缩（或最佳质量）。

我也注意到了这一点：

```
[body appendData:[NSData dataWithData:imageData]]; 
```

你为什么做这个？你已经有一个 NSData 对象（imageData）

# asp.net - 绑定并传递 2 个值 commandArgument 和隐藏字段，ERROR

> ID：14798286
> 
> 赞同：1
> 
> 时间：2013-02-10T13:35:14.450
> 
> 标签：asp.net, repeater, hidden-field, commandargument

使用中继器显示列表，（在每条记录旁边带有“删除”按钮）单击“删除”，它将从列表中删除。我使用commandArgument传递'id'，我想传递另一个值......'公司名称'通过文本尝试过，但不知道如何传递它......然后在后面的代码中我使用companyName来获取contractorId，（公司名称对于承包商

```
<td>
<asp:LinkButton ID="LinkButton1" CommandArgument='<%# Bind ("id") %>' runat="server" OnCommand="RemoveSubContractor" CssClass="bottomhyperlink">Remove</asp:LinkButton>
<asp:HiddenField id="hdnCompanyName" value='<%#Bind("Company_Name")%>'>
</td> 
```

在后面的代码中：

```
HiddenField hdnCompanyName = (HiddenField)e.CommandArgument.ToString("hdnCompanyName); 
string companyName = hdnCompanyName.Value; 
```

然后问题来自我尝试执行 .findControl 的 e.commandArgument 之后的代码，但它不允许我......有人知道我错过了什么吗？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:45:31.907

您可以遍历中继器项目，获取通过的 id 的项目`CommandArgument='<%# Bind ("id") %>'`并调用`FindControl()`以获取公司名称，这是一个示例：

**ASPX：**

```
<asp:Repeater ID="Repeater1" runat="server">
    <ItemTemplate>
        <asp:Label ID="lblId" runat="server" Text='<%# Eval("ID") %>' />
        <asp:HiddenField ID="hdCompanyName" runat="server" Value='<%# Eval("CompanyName") %>' />
        <asp:Button ID="btnSave" runat="server" OnCommand="Save" CommandArgument='<%# Eval("ID") %>' Text="Save" />
    </ItemTemplate>
</asp:Repeater> 
```

**后面的代码：**

```
public partial class RepeaterExample : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            var employees = new List<Employee>()
            {
                new Employee{ Id="1",CompanyName="Company 1"},
                new Employee{ Id="2",CompanyName="Company 2"}
            };
            Repeater1.DataSource = employees;
            Repeater1.DataBind();
        }
    }

    protected void Save(object sender, CommandEventArgs e)
    {
        string id = e.CommandArgument.ToString();
        string companyName = string.Empty;

        foreach (RepeaterItem item in Repeater1.Items)
        {
            Label lblId = item.FindControl("lblId") as Label;
            if (lblId.Text.Equals(id))
            {
                companyName = (item.FindControl("hdCompanyName") as HiddenField).Value;
                break;
            }
        }
        System.Diagnostics.Debug.WriteLine(companyName);
    }
}

public class Employee
{
    public string Id { get; set; }
    public string CompanyName { get; set; }
} 
```

也许更好的解决方案是将*id*和*公司名称*都传递给`CommandArgument`this 将避免通过循环通过中继器创建的额外处理：

**ASPX：**

```
<asp:Repeater ID="Repeater1" runat="server">
    <ItemTemplate>
        <asp:Label ID="lblId" runat="server" Text='<%# Eval("ID") %>' />
        <asp:HiddenField ID="hdCompanyName" runat="server" Value='<%# Eval("CompanyName") %>' />
        <asp:Button ID="btnSave" runat="server" OnCommand="Save" CommandArgument='<%# String.Format("{0},{1}",Eval("ID"),Eval("CompanyName"))  %>' Text="Save" />
    </ItemTemplate>
</asp:Repeater> 
```

**后面的代码：**

只需拆分字符串，就有两个参数！

```
protected void Save(object sender, CommandEventArgs e)
{
    string [] arguments = e.CommandArgument.ToString().Split(',');
    string id = arguments[0];
    string companyName = arguments[1];
} 
```

# c++ - GEOSGeometry 到 geos::geom::Geometry

> ID：14798288
> 
> 赞同：1
> 
> 时间：2013-02-10T13:35:50.570
> 
> 标签：c++, macros, qgis, geos

我可能有小问题。我正在尝试使用 GEOS 库。我在自己的库中有使用 GEOS 库的函数。我想在我用 C++ 编写的 QGIS 插件中使用这个库。问题是，我的库中的函数使用 . `geos::geom::Geometry`，但在 QGIS 插件中，有`GEOSGeometry`. 我认为这是同一件事，但可能不是。

谁能解释我这两者之间的区别并给我一个建议，如何将它们相互转换或告诉我我做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:45:01.263

`GEOSGeometry` is a `typedef` for the structure used in the C (not C++) API. It is stated on the official documentation that the use of the C API is preferred to the C++ API as it may be more stable (in terms of future changes).

I'm not sure if you can simply cast the structures (I'd advise against it). I suggest you use the C API instead of the C++ API.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-15T22:40:28.423

不，您不能简单地`GEOSGeometry`从基于类的层次结构中转换 GEOS C API 类型和 C++ API 类型`geos::geom::Geometry`。

但是，您可以[使用 WKB 作为](https://lists.osgeo.org/pipermail/geos-devel/2013-July/006438.html)C API 和 C++ API 对象之间的交换格式来转换几何图形。

# ruby-on-rails - 未初始化的常量，但表存在

> ID：14798289
> 
> 赞同：1
> 
> 时间：2013-02-10T13:35:51.853
> 
> 标签：ruby-on-rails

我确信这是 RoR 中的一个基本问题，但我添加了一个名为 hooods_one_providers 的新表。该表没有对应的模型 - 它应该连接两个模型 - Providers 和 Hoods。我试图在控制台中调用它，但得到的是 - 未初始化的常量。

当我运行时：

```
ActiveRecord::Base.connection.tables
=> ["schema_migrations", "users", "roles", "users_roles", "providers", "food_items", "food_items_users", "feedbacks", "addresses", "carts", "link_carts", "hoods", "drink_items", "addons_ons", "addons_nears", "customize_foods", "addresses_hoods", "hoods_one_providers"] 
```

我可以看到表格，但我无法从中读取。当我运行 hooods_one_providers 我得到未初始化的常量错误：

```
NameError: uninitialized constant HoodsOneProvider
    from (irb):14
    from /home/ido/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands/console.rb:47:in `start'
    from /home/ido/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands/console.rb:8:in `start'
    from /home/ido/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

在模型提供者中，我有：

```
has_and_belongs_to_many :hoods_one, class_name: 'HoodsOne' 
```

在模型引擎盖中，我有：

```
has_and_belongs_to_many :providers 
```

将不胜感激任何帮助。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-03-16T06:17:09.933

这可能发生在以下任何一种情况下

1.  运行`reload!`应该修复。
2.  退出控制台并再次运行控制台`rails c`
3.  确保相应表的模型文件存在。假设您的表名是模型下`hoods_one_providers`应该有`hoods_one_providers.rb`文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T13:37:30.467

如果您在控制台运行时添加了表，则控制台已经缓存了这些类。运行`reload!`应该可以解决问题，但如果没有，应该重新启动控制台。

更新：

您正在使用 has_and_belongs_to_many 这需要您手动创建连接表。

更新：创建连接表

创建一个包含以下内容的迁移以创建连接表。该`id: false`选项告诉它不要创建`id`列

```
create_table :hoods_ones_providers, id: false do |t|
  t.references :hoods_one, :provider
end

add_index :hoods_ones_providers, [:hoods_one_id, :provider_id] 
```

# asp.net-mvc - MvcMusicStore 的 MVC 安全性

> ID：14798290
> 
> 赞同：0
> 
> 时间：2013-02-10T13:35:55.327
> 
> 标签：asp.net-mvc

我正在尝试通过 MVCMusicStore [TutoralPDF](http://mvcmusicstore.codeplex.com/downloads/get/228002)工作，但第 6 章和第 7 章一直很痛苦。

在第 7 章中，我相信我遵循了所有的指示

1.  将控制器、模型和视图添加到项目中
2.  通过 ASP.net 配置创建了管理员角色
3.  创建了一个用户并向他们添加了管理员角色
4.  将 Authorize 属性添加到 StoreManager 类

现在，当我浏览到 /StoreManager 时，我被重定向到 login.aspx 页面，并带有 Return URl 返回到 StoreManager 而不是转到 Account 控制器，这就是我所期望的吗？

我做错了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:03:27.557

所以我必须在 web 配置文件中添加一个表单标签到我的身份验证中。

```
 <authentication mode="Forms">
      <forms loginUrl="~/Account/Logon"  />
  </authentication> 
```

否则，IIS 和虚拟服务器中的默认值是 login.aspx，出现 302 错误。

# iframe - Schema.org VideoObject 标签可以应用于 iframe 吗？

> ID：14798297
> 
> 赞同：6
> 
> 时间：2013-02-10T13:36:57.747
> 
> 标签：iframe, seo, microdata, schema.org

VideoObject 标签 ( [Schema.org](http://schema.org/VideoObject) ) 可以应用于 iframe 吗？他们自己的例子和[googlewebmastercentral 上的这个](http://googlewebmastercentral.blogspot.co.uk/2012/02/using-schemaorg-markup-for-videos.html)例子没有提到嵌入 iframe 的视频。

应该将它添加到 iframe 本身并在 iframe 内使用 meta 还是包装 div？

```
<iframe itemprop="video" itemscope itemtype="http://schema.org/VideoObject" src="http://player.vimeo.com/video/CLIP_ID" width="400" height="225" frameborder="0">
    <meta itemprop="duration" content="T1M33S" />
</iframe> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-14T08:27:43.617

是的，可以将 VideoObject 标签应用于使用 iframe 嵌入的视频。但如果它真的有帮助，鉴于以下帖子，是问题，请查看此帖子：[http](http://www.reelseo.com/embedded-youtube-indexed-google/) ://www.reelseo.com/embedded-youtube-indexed-google/ 。

此外，为了回答您（和我）的问题，我使用了以下 Google 关键字：[https](https://www.google.com/#q=schema.org+videoobject+iframe) ://www.google.com/#q=schema.org+videoobject+iframe 。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-13T15:02:21.870

您是否担心 Google Snippet（视频架构标记）？我这是不可能的，因为应该在**head**标签和**iframe**标签之间找到 Meta 标签，通常嵌入另一个页面，所以这不会通过[Google Snippet Testing Tool](http://www.google.com/webmasters/tools/richsnippets)检测到。

更多信息请访问[http://searchenginewatch.com/article/2278710/Embedded-Video-Schema-Markup-A-7-Step-Checklist-for-Great-Results](http://searchenginewatch.com/article/2278710/Embedded-Video-Schema-Markup-A-7-Step-Checklist-for-Great-Results)

# python - Matplotlib：以数据坐标中给定的宽度绘制线条

> ID：14798303
> 
> 赞同：8
> 
> 时间：2013-02-10T13:37:16.857
> 
> 标签：python, matplotlib

我试图弄清楚如何在数据单元中绘制具有宽度的线条。例如，在下面的代码片段中，我希望宽度为 80 的线的水平部分始终从 y=-40 延伸到 y=+40 标记，并且即使坐标系的限制也保持这种状态改变。有没有办法用 matplotlib 中的 Line2D 对象来实现这一点？有没有其他方法可以获得类似的效果？

```
from pylab import figure, gca, Line2D

figure()
ax = gca()
ax.set_xlim(-50, 50)
ax.set_ylim(-75, 75)

ax.add_line(Line2D([-50, 0, 50], [-50, 0, 0], linewidth=80))

ax.grid() 
```

![屏幕坐标中的线宽](../Images/91ed1327ee6a7eb6d01e1887ca7baad0.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T14:00:34.127

You could use [fill_between](http://matplotlib.org/examples/pylab_examples/fill_between_demo.html):

```
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(1, 1, 1)
ax.set_xlim(-50, 50)
ax.set_ylim(-75, 75)
x = [-50, 0, 50]
y = np.array([-50, 0, 0])

ax.fill_between(x,y-30,y+30)

ax.grid()
plt.show() 
```

yields

![enter image description here](../Images/63c4ef8505ec4998cd3286fb77732f96.png)

but unlike the line generated by

```
ax.add_line(Line2D([-50, 0, 50], [-50, 0, 0], linewidth=80)) 
```

the vertical thickness of the line will always be constant in data coordinates.

See also [link to documentation](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.fill_between).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-23T09:54:07.857

为了以数据单位的线宽绘制一条线，您可能想看看**[这个答案](https://stackoverflow.com/a/42972469/4124317)**。

它使用一个与命令签名`data_linewidth_plot`非常相似的类。`plt.plot()`

```
l = data_linewidth_plot( x, y, ax=ax, label='some line', linewidth = 1, alpha = 0.4) 
```

linewidth 参数以 (y-) 数据单位解释。

# wordpress - 从带有 wpdb 的页面中选择自定义元 (WPAlchemy)

> ID：14798307
> 
> 赞同：0
> 
> 时间：2013-02-10T13:37:32.973
> 
> 标签：wordpress

我已经阅读了一些文档和其他人关于我的 wpdb 问题的类似问题，但是我看到了非常不同的答案，所以我有点困惑。

我要做的是从（最终）Wordpress 中的大约 250 页获取自定义元数据。wpdb 请求将在 header.php 中，并且代码必须构建一个数组，该数组将用作 Google 地图的输入。自定义元字段称为 _ytF_f_name、_ytF_f_lat 和 _ytF_f_lng（不要问我为什么 :-)）。

所以最终的输出应该是：`[name1,lat1,lng1], [name2,lat2,lng2],`等。

我正在为 Wordpress 使用自定义表，它具有前缀 yt_（在 wp-config.php 中定义）。自定义元是使用 WPAlchemy 构建的。我检查了数据库并且元数据在那里（在 postmeta 表中）。

在结合了几件事之后，这就是我现在所拥有的：

```
<?php
global $wpdb;
$querystr = "SELECT ".$wpdb->prefix."postmeta._ytF_f_name, ".$wpdb->prefix."postmeta._ytF_f_lat, ".$wpdb->prefix."postmeta._ytF_f_lng FROM ".$wpdb->prefix."postmeta WHERE post_type='page'";
$vars = $wpdb->get_results($querystr);
foreach ($vars as $var) {
echo '[' . $var->_ytF_f_name . ',' . $var->_ytF_f_lat . ',' . $var->_ytF_f_lat . '],';
}
?> 
```

输出是空白的，所以我在这里缺少什么？

与此相关的另一个问题是；我读过一些关于“准备”以防止 sql 注入的内容。

是正确使用prepare类来改变

```
$vars = $wpdb->get_results($querystr); 
```

进入：

```
$vars = $wpdb->get_results($wpdb->prepare($querystr)); 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:44:40.670

About your problem, I don't see the error, so verify if you have SQL errors with `$wpdb->show_errors();` before your query (doc [here](http://codex.wordpress.org/Class_Reference/wpdb#Show_and_Hide_SQL_Errors)).

The prepare method protects you against SQL injections. As the [doc](http://codex.wordpress.org/Class_Reference/wpdb#Protect_Queries_Against_SQL_Injection_Attacks) said, it works like the following :

```
 $wpdb->query(
    $wpdb->prepare(
       "INSERT INTO ___
       ( attr1, attr2 )
       VALUES ( %s, %d )",
       $valueOfAttr1,
       $valueOfAttr2
    )
 ); 
```

Of course, you must change the types and values to your needs.

# gem - Macruby 无法在应用程序中加载调度 gem

> ID：14798314
> 
> 赞同：0
> 
> 时间：2013-02-10T13:38:18.970
> 
> 标签：gem, macruby, dispatch

我想在 MacRuby 中使用 Dispatch gem 在我的应用程序中使用并发。但我遇到了一个棘手的问题。我尝试通过“gem install dispatch”、“macgem install dispatch”和 sudo 安装 Dispatch gem，这两种方式都是以前的变体。但是，如果我尝试通过“sudo macrake”运行我的应用程序，我总是会得到：rake aborted！没有要加载的文件——分派

我究竟做错了什么？将宝石与 macruby 一起使用时，我是否遗漏了某些部分？

PS我在我的rakefile中需要'rubygems'......

这是 macgem env 输出： macgem env

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.20
  - RUBY VERSION: 1.9.2 (2008-06-03 patchlevel 0) [universal-darwin10.0]
  - INSTALLATION DIRECTORY: /Users/DarkDeny/.rvm/gems/ruby-1.9.3-p327
  - RUBYGEMS PREFIX: /Users/DarkDeny/Projects/SpaceInspector
  - RUBY EXECUTABLE: /Library/Frameworks/MacRuby.framework/Versions/0.12/usr/bin/macruby
  - EXECUTABLE DIRECTORY: /Users/DarkDeny/.rvm/gems/ruby-1.9.3-p327/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - universal-darwin-10
    - universal-macruby-0.12
  - GEM PATHS:
     - /Users/DarkDeny/.rvm/gems/ruby-1.9.3-p327
     - /Users/DarkDeny/.rvm/gems/ruby-1.9.3-p327@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "install" => "--no-rdoc --no-ri"
     - "update" => "--no-rdoc --no-ri"
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

# windows-phone-7 - 如何在 Windows Phone 的数字输入键盘上显示回车键？

> ID：14798316
> 
> 赞同：2
> 
> 时间：2013-02-10T13:38:31.720
> 
> 标签：windows-phone-7, xaml

我有以下 XAML 片段：

```
<TextBox MaxLength="3" Text="30" LostFocus="UpdateValue">
  <TextBox.InputScope>
    <InputScope >
      <InputScopeName NameValue="Number" />
    </InputScope>
  </TextBox.InputScope>
</TextBox> 
```

这会导致点击时出现一个数字键盘，但要在操作后关闭它，我不得不烦人地在它外面敲击。有没有办法让它包括像输入按钮这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T20:23:05.573

我不相信这有一个[InputScope](http://msdn.microsoft.com/en-us/library/system.windows.input.inputscopenamevalue%28VS.95%29.aspx)，但我现在无法检查它们。你可能有这个问题。

如果没有[InputScope](http://msdn.microsoft.com/en-us/library/system.windows.input.inputscopenamevalue%28VS.95%29.aspx)，您可以添加一个带有单个“完成”按钮的应用程序栏。显示键盘时，也显示应用程序栏。当用户点击“完成”应用栏按钮时，您可以通过将焦点设置到页面来隐藏键盘。

```
Page.Focus(); 
```

另一个选项， Windows Phone 7[的数字输入控件。](http://csharperimage.jeremylikness.com/2011/03/numeric-input-control-for-windows-phone.html)

# java - 在字符串中查找各种字符

> ID：14798317
> 
> 赞同：1
> 
> 时间：2013-02-10T13:38:40.207
> 
> 标签：java, string, char

我有一个基本的字符串变量，其中包含字母 xa 总共三次。我尝试使用 charAt 在字符串中找到 x，然后打印 char 及其旁边的下两个字符。

我在我的代码中遇到了障碍，希望能提供任何帮助。

这是我的代码。

```
public class StringX{
    public static void main(String[] args){
        String ss = "xarxatxm";
        char first = ss.charAt(0);
        char last == ss.charAt(3);

        if(first == "x"){ 
            String findx = ss.substring(0, 2);
        }
        if(last == "x"){
            String findX = ss.substring(3, 5);
        }

        System.out.print(findx + findX);
    }
} 
```

另外，有没有办法实现 for 循环来循环遍历寻找 x 的字符串？

我只需要一些建议来看看我的代码哪里出错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:41:55.500

你找不到字符使用`charAt`-一旦你知道它在哪里，它是为了*获取一个字符。*

> 有没有办法实现 for 循环以循环通过字符串寻找 x 呢？

您需要[`indexOf`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#indexOf%28int,%20int%29)用于查找字符的位置。传递初始位置，`x`即您到目前为止找到的最后一个位置以获得后续位置。

例如下面的代码

```
String s = "xarxatxm";
int pos = -1;
while (true) {
    pos = s.indexOf('x', pos+1);
    if (pos < 0) break;
    System.out.println(pos);
} 
```

[打印`0 3 6`](http://ideone.com/yot1Pq)`'x'`字符串中的三个位置。

# django - 模型的 Django HTML 片段

> ID：14798318
> 
> 赞同：2
> 
> 时间：2013-02-10T13:38:40.900
> 
> 标签：django

我是 Django 新手，我正在尝试找出如何将 HTML 片段与模型相关联。

我的 HTML 片段只是一个 div。我想重用那个 div（你可以把它想象成一个缩略图）

情况是这样的：在我的主页中，我想显示 x 个对象，而在我的搜索页面中，我想显示更多对象。但是表示是一样的。

我可以在 mainpage.html 和 searchpage.html 中编写将模型对象转换为 div 的所需方法，但我不确定重用该转换的最佳方法是什么？

我可以向我的模型添加一个返回 HTML div 的函数，然后我可以从主页和搜索页面模板调用它。但这会将模型和表示结合起来，我认为这不是一件好事。

如果我没记错的话， [inclusion_tag](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#inclusion-tags)是要走的路，但是我应该在哪个文件中保留函数定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T13:54:52.703

正如您正确地说的那样，您不希望在模型中使用 html，这违反了 MVC 模式。

[模型](https://docs.djangoproject.com/en/1.4/topics/db/models/)用于存储数据。[视图](https://docs.djangoproject.com/en/1.4/topics/http/views/)用于选择要呈现的数据，而[模板](https://docs.djangoproject.com/en/1.4/topics/templates/)用于实际呈现数据。（请参阅有关[django 对 MVC 的解释的](https://docs.djangoproject.com/en/dev/faq/general/#django-appears-to-be-a-mvc-framework-but-you-call-the-controller-the-view-and-the-view-the-template-how-come-you-don-t-use-the-standard-names)注释）。

要回答您的问题，您需要一个模板（甚至是[模板标签](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/)）来表示您的模型，例如`model_block.html`. 就像是

```
{% if obj %}
    <div id=obj.id>
        {{ obj.name }}
    </div>
{% endif %} 
```

然后将您的模板包含在您的`mainpage.html`喜欢中

```
{% for obj in object_list %}
    {% include 'model_block.html' %}
{% endfor %} 
```

你可以在你的 中做同样的事情，从你的视图中`searchpage.html`传递一个不同的变量。`object_list`

# iphone - 无法正常播放声音

> ID：14798322
> 
> 赞同：0
> 
> 时间：2013-02-10T13:39:00.383
> 
> 标签：iphone, ios, audio

我一直在努力寻找解决这个问题的方法。我已经正确设置了带有声音文件的 AudioToolbox 框架，没有任何错误。它编译并运行正常，但是当我尝试点击按钮播放声音时，我在一个名为`main.m`. 这是`main.m`尝试播放声音后它带给我的文件：

```
#import <UIKit/UIKit.h>
#import "AppDelegate.h"

int main(int argc, char *argv[]) {
    @autoreleasepool {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
    }
} 
```

在线上`return UIApplicationMain`，这就是绿色出现的地方。它说`Thread 1: Signal SIGABRT`。

这里有什么问题？

这是我的 ViewController .m 和 .h 文件：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize bannerIsVisible;

-(void)bannerViewDidLoadAd:(ADBannerView *)banner {
if (!self.bannerIsVisible) {

    [UIView beginAnimations:@"animateAdBanner" context:NULL];
    banner.frame = CGRectOffset(banner.frame, 0, -50.0f);
    [UIView commitAnimations];
    self.bannerIsVisible = YES;
}
}

-(void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error {
if (self.bannerIsVisible) {
    [UIView beginAnimations:@"animateAdBannerOff" context:NULL];
    banner.frame = CGRectOffset(banner.frame, 0, 50.0f);
    [UIView commitAnimations];
    self.bannerIsVisible = NO;
 }
}

- (void)viewDidLoad
{
[super viewDidLoad];

adView = [[ADBannerView alloc] initWithFrame:CGRectZero];
adView.frame = CGRectOffset(adView.frame, 0, 460.0f);
adView.requiredContentSizeIdentifiers = [NSSet       setWithObject:ADBannerContentSizeIdentifierPortrait];
adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifierPortrait;
[self.view addSubview:adView];
adView.delegate=self;
self.bannerIsVisible=NO;

}

- (void)didReceiveMemoryWarning

{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

- (IBAction)cstring:(id)sender {
CFBundleRef mainBundle = CFBundleGetMainBundle();
CFURLRef soundFileURLRef;
soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"CString", CFSTR    ("caf"), NULL);
UInt32 soundID;
AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
AudioServicesPlaySystemSound(soundID);
}
@end 
```

现在我的.h：

```
#import <iAd/iAd.h>
#import <UIKit/UIKit.h>
#import <AudioToolbox/AudioToolbox.h>
#import <iAd/ADBannerView_Deprecated.h>
#import <Foundation/Foundation.h>
#import <AVFoundation/AVFoundation.h>

@interface ViewController : UIViewController <ADBannerViewDelegate> {

ADBannerView *adView;
BOOL bannerIsVisible;

}

@property (nonatomic, assign) BOOL bannerIsVisible;

- (IBAction)cstring:(id)sender;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:31:54.737

您需要找出错误的来源。您可以单步执行，也可以至少执行以下两个步骤之一：

1.  [将此补丁](https://stackoverflow.com/a/12268397/581994)安装在您的主目录中，以将异常记录到控制台。
2.  在 Xcode 断点选项卡的底部，按“+”添加新断点，然后选择添加异常断点的选项。（我忘记了显示的确切单词，但它相当明显。）这将在发生异常时导致断点。

# jquery - 如何通过 fadeIn() 函数使 div 可见

> ID：14798326
> 
> 赞同：0
> 
> 时间：2013-02-10T13:39:27.123
> 
> 标签：jquery, fadein

我在 display:none 中有一个 div，如下所示：

```
<div id="mydiv" style="display:none">My Text</div> 
```

我希望我的 div 出现，所以我使用了：

```
$("#mydiv").fadeIn(); 
```

但它不起作用...我的 div 停留在 display:none...

谢谢你的帮助。

* * *

**现在可以使用...只是引用错误...不要怪我 :) 感谢您的帮助**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:46:41.253

Does it work if you remove the inline "display: none" and use fadeOut() to hide the element first? Also, does anything of note get logged in the JS console?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:41:25.297

隐藏jQuery中的元素

```
$('#mydiv').hide(); 
```

比淡入淡出，它应该可以工作（也应该与 display:none 一起工作）

否则给我看一些代码-> [http://jsfiddle.net/genesis/7NdPJ/](http://jsfiddle.net/genesis/7NdPJ/)

# ios - 确定特定 CGSize 的 UIFont 的 pointSize

> ID：14798328
> 
> 赞同：1
> 
> 时间：2013-02-10T13:39:40.567
> 
> 标签：ios, objective-c, cocoa-touch, uilabel, frame

我有一个特定`CGSize`的 a `UILabel`，我无法扩展的框架，`UILabel`因为它是一个多行`UILabels` ***`adjustsFontSizeToFitWidth`***方法不起作用。

所以我想我应该创建这样的函数，看起来像；

```
- (CGFloat)fontSizeWithText:(NSString*)text andFont:(UIFont*)font constrainedSize:(CGSize)size LBM:(UILineBreakMode)LBM
{
    // check if text fits to label
    CGSize labelSize = [text sizeWithFont:font constrainedToSize:CGSizeMake(size.width, 9999) lineBreakMode:LBM];

    // if not, decrease font size until it fits to the given size
    while (labelSize.height > size.height) {
        font = [UIFont fontWithName:font.fontName size:font.pointSize - 0.5];
        labelSize = [text sizeWithFont:font constrainedToSize:CGSizeMake(size.width, 9999) lineBreakMode:LBM];
    }

    return font.pointSize;
} 
```

用法：

```
// fit detail label by arranging font's size
    CGFloat fontSize = [self fontSizeWithText:self.titleLabel.text andFont:self.titleLabel.font constrainedSize:self.titleLabel.frame.size LBM:self.titleLabel.lineBreakMode];
    self.titleLabel.font = [UIFont fontWithName:self.titleLabel.font.fontName size:fontSize]; 
```

但是使用这种方法，我发现我的一些文本不适合 UILabel 的框架并被截断。一定有什么我错过了。对代码的任何帮助或解决**“将具有给定字体的文本拟合到特定的多行 UILabel”的**任何其他建议都会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:17:22.157

首先让我们快速看一下整个问题。您正在尝试将文本放入预定义的框架并调整字体大小。这通常不会很好地工作，因为你会很快找到尺寸太小而无法阅读，即使在视网膜显示器上也是如此。您应该调整标签的框架以容纳多余的文本（在可能的情况下。有时，截断是唯一的选择。）

现在，这已经不碍事了，让我们来看看调整字体大小。尽管不推荐它，但我仍然会解释如何最好地去做。

**重要**的是，此代码未经测试，很可能需要一些调整，但这可能是读者的练习。

所以我们首先需要知道的是单行的高度。现在，我们有了标签的高度，以及它可以显示的行数，所以我们可以通过简单地将标签高度除以行数来确定这一点。

```
CGFloat optimalLineHeight = CGRectGetHeight(label.frame) / label.numberOfLines; 
```

您可能已经注意到，这可能会返回比实际需要*高的行。*您将能够实施额外的检查和约束来处理这个问题。但目前，字体大小也将能够增长，而不仅仅是缩小。

现在，获得最佳行高只是故事的一部分。我们现在需要优化字体大小。这是一些代码：

```
CGFloat optimumFontSize = 0.0;
BOOL optimumFontSizeFound = NO;
do {
    CGSize charSize = [@"M" sizeWithFont:[UIFont systemFontOfSize:optimumFontSize]
                       constrainedToSize:CGSizeMake(100, 9999)
                           lineBreakMode:0];
    if ( CGSizeGetHeight(charSize) > optimalLineHeight ) {
        optimumFontSizeFound = YES;
    }
    else {
        optimumFontSize++;
    }
} while ( !optimumFontSizeFound ); 
```

那么这有什么作用呢？到目前为止，我们在此跟踪最佳字体大小。我们从字体大小为 0 的假设开始，我们看到使用该字体大小的单个字符有多高。如果该高度大于先前计算的最佳线高，则先前的高度是最佳高度。如果不是，我们增加大小并重复，直到我们找到最佳的。

在这方面仍有很多问题需要克服，以使其在所有情况下都能完美运行。这*应该*确保您看不到字符的可见垂直剪切，但不能确保所有文本内容都显示在框架中。要做到这一点，您需要更聪明地确定所需的行数，但我再次将其留作读者练习。

希望这可以帮助您实现目标。

# php - Cakephp 视频透传

> ID：14798337
> 
> 赞同：2
> 
> 时间：2013-02-10T13:40:47.043
> 
> 标签：php, cakephp, html5-video, mp4, jwplayer

我一直在为使用 cakephp 2.0.3 的教师开发一个网站。一项要求是教师能够上传只有给定班级的学生才能查看的文件（图像、文档、pdf 和视频）。我一直在使用 php fpassthrough 将二进制数据读取到 http 输出流。

这对除视频外的所有文档都有效，chrome 内置播放器、vlc firefox 插件或 jwplayer 将无法播放视频，视频将在实际网站上使用。但是，如果我保存文件，Windows 媒体播放器将正常播放该文件。从 cakephp webroot 目录播放文件也可以正常工作。这是文件查看代码：

加载和输出文件的控制器代码：

```
//cakephp find used to pull file information from database
$fileName = "/redacted/" . $File['File']['unit_id'] . "/" . $File['File']['id'];
$fp = fopen($fileName, 'rb');

header("Content-Type: " . $File['File']['type']);
header("Content-Length: " . filesize($fileName));

fpassthru($fp); 
```

使用的布局：

```
<?php echo $this->fetch('content'); ?> 
```

jwplayer加载代码：

```
<div style="width: 200px; height: 91px;" id="1">&nbsp;</div>
<script type="text/javascript">
    jwplayer("1").setup({
        file: "/Files/view/1/blah.m4v",
    });
</script> 
```

视图文件为空，因为所有输出都在控制器中完成。我浏览了这个网站和谷歌，但找不到问题的原因或执行此功能的更好方法。我已经验证[标题是正确的，并且之前或之后没有错误的换行符或数据](https://stackoverflow.com/questions/3222642/why-is-php-interfering-with-my-html5-mp4-video)。我还检查了是否不需要扩展名（在最后的代码块中，'1' 指定文件 ID，最后的文件名是虚拟的）。

我的问题，因此：

1.  fpassthru()、readfile() 或类似的 php 视频直通的正确方法是什么？
2.  这个问题是我的代码特有的，还是 cakephp 处理 MVC 所固有的？有没有人成功实施过这样的解决方案？
3.  是否有任何其他“跳出框框思考”的解决方案（使用 node.js 或其他语言，.htaccess 技巧）会更好。
4.  我可以在 webroot 文件夹中使用非 cakephp 脚本，但我将如何传递用户会话数据？这只是一个愚蠢的想法吗？

**[编辑]** 在与 cakephp 分开的视频文件上测试 fpassthrough 后，我发现问题出在视频直通而不是 cakephp 上。此代码用于测试，在 app/webroot 目录中：

```
<?php
    $fileName = "/var/www/redacted/files/2/1";
    $fp = fopen($fileName, 'rb');
    header("Content-Type: video/mp4");
    header("Content-Length: 18485");
    fpassthru($fp);
?> 
```

内容类型、路径和长度取自该文件的数据库条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T21:00:23.360

Cake 具有您想要内置的功能，请查看文档中的[媒体视图](http://book.cakephp.org/2.0/en/views/media-view.html)。请注意，它在 Cake 2.3.0 中已被弃用，但由于您使用的是 2.0，它应该可以正常工作。我测试了以下代码，在 jwplayer 或 VLC 插件中播放示例 m4v 没有问题：

```
$this->viewClass = 'Media';

$fileName = WWW_ROOT . DS . 'sample_iPod.m4v';

$parts = pathinfo($fileName);

$params = array(
    'id' => $parts['basename'],
    'name' => $parts['filename'], // requires PHP >= 5.2.0
    'extension' => $parts['extension'],
    'download' => false,
    'path' => $parts['dirname'] . DS
);

$this->set($params); 
```

请注意，Cake 会根据扩展名自动为您输出正确的内容类型/长度。

# asp.net - 用于在提醒日期从 SQL Server 数据库发送电子邮件的 Windows 服务或控制台应用程序

> ID：14798341
> 
> 赞同：0
> 
> 时间：2013-02-10T13:41:12.087
> 
> 标签：asp.net, sql-server, email

我正在尝试执行以下操作，用户在 aspx 页面上填写发布日期和到期日期。这些日期的`yyyy/MM/dd`格式保存在数据库中。

我希望能够在截止日期前 3 天向用户发送电子邮件。

我能够找到的方法是使用 a `Windows Service`or `SQL Job`，但问题是我无法围绕这个概念并让它发挥作用。

令人困惑的部分是我必须为 Windows 服务创建一个新项目，现在我不知道这是否正确，但我的方法是连接到 SQL Server 并使用问题和截止日期查询数据库，然后执行计算并将其存储在 中`resultdate`，如果`resultdate`等于`Today's date`则将电子邮件发送给以下用户，否则不进行轮询。

* * *

**编辑：**

我试图通过创建一个来实现上述目标`Stored Procedure`，它将设置在`Windows Service`. 目前，我正在努力解决以下问题：

我有一个`MS SQL DB`包含 a`closing date`的目标是向其电子邮件`2 days`在`closing date`.

请看下面的代码，我正在使用`CURSOR FOR`但不确定如何对`SELECT`不同的数据库使用两组命令，而第一组命令`SELECT`存储在一些变量中，这些变量从另一个数据库中检索余额数据。

```
USE ROG
DECLARE @Currentdate varchar(10), @DueDate varchar(10), @Serial_No int, @Product_Line varchar(50), @Email varchar(50)
SET @Currentdate = GETDATE()

DECLARE RFQDate CURSOR FOR

SELECT Serial_No, RFQ_Closing_Date, Product_Line FROM RFQDB WHERE DATEDIFF(day, GETDATE(), RFQ_Closing_Date) = 2

OPEN RFQDate

FETCH NEXT FROM RFQDate INTO @Serial_No, @DueDate, @Product_Line 

WHILE @@FETCH_STATUS = 0

BEGIN 

FETCH NEXT FROM RFQDate INTO @Serial_No, @DueDate, @Product_Line

PRINT ' Due Date ' + @DueDate + ' Serial No ' + coalesce(Convert(varchar(4), @Serial_No),'') + ' Product Line ' + @Product_Line 

END

DECLARE EMAIL CURSOR FOR     --Not sure if this way is correct (this is where I need help!!!

SELECT Sales_Email_ID FROM ProductLineDB WHERE Product_Line = @Product_Line

OPEN EMAIL

FETCH NEXT FROM EMAIL INTO @Email

WHILE @@FETCH_STATUS = 0

BEGIN 

FETCH NEXT FROM EMAIL INTO @Email

PRINT ' EMAIL ' + @Email

END

CLOSE EMAIL

DEALLOCATE EMAIL

CLOSE RFQDate

DEALLOCATE RFQDate 
```

但是，如果您测试上述代码，它将正确显示所有到期日期，但仅显示与到期日期关联的 1 封电子邮件。相反，它应该显示 5 封电子邮件。

**MS SQL 消息屏幕**

```
Due Date 2013/02/14 Serial No 1015 Product Line Tubes
Due Date 2013/02/14 Serial No 1015 Product Line Instrumentation
Due Date 2013/02/14 Serial No 1015 Product Line Tooling
Due Date 2013/02/14 Serial No 1015 Product Line Tooling
Due Date 2013/02/14 Serial No 1015 Product Line Tooling
EMAIL xxx@abc.com 
```

**编辑正确的代码**

以下代码正在获取我需要的所有信息，现在我只需要实现从标量值`sp_send_dbmail`中获取。`@recipients``@Email`

```
The working code is as the following:

USE ROG
DECLARE @Currentdate varchar(10), @DueDate varchar(10), @Serial_No int, @Product_Line varchar(50), @Email varchar(50)
SET @Currentdate = GETDATE()

DECLARE RFQDate CURSOR FOR

SELECT Serial_No, RFQ_Closing_Date, Product_Line FROM RFQDB WHERE DATEDIFF(day, GETDATE(), RFQ_Closing_Date) = 2

OPEN RFQDate

FETCH NEXT FROM RFQDate INTO @Serial_No, @DueDate, @Product_Line 

WHILE @@FETCH_STATUS = 0

BEGIN 

DECLARE EMAIL CURSOR FOR

SELECT Sales_Email_ID FROM ProductLineDB WHERE Product_Line = @Product_Line

OPEN EMAIL

FETCH NEXT FROM EMAIL INTO @Email

PRINT ' EMAIL: ' + @Email

WHILE @@FETCH_STATUS = 0

BEGIN 

FETCH NEXT FROM EMAIL INTO @Email 

END

CLOSE EMAIL

DEALLOCATE EMAIL

FETCH NEXT FROM RFQDate INTO @Serial_No, @DueDate, @Product_Line

PRINT ' Due Date: ' + @DueDate + ' Serial No: ' + coalesce(Convert(varchar(4), @Serial_No),'') + ' Product Line: ' + @Product_Line 

END

CLOSE RFQDate

DEALLOCATE RFQDate 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:21:41.487

工作代码如下：

```
USE ROG
DECLARE @Currentdate varchar(10), @DueDate varchar(10), @Serial_No int, @Product_Line varchar(50), @Email varchar(50), @RFQ_No bigint, @Subject nvarchar(500), @Profile_No int, @Body nvarchar(500), @copy_recipients varchar(max) = 'abc@xyz; dfg@xyz'
SET @Currentdate = GETDATE()

DECLARE RFQDate CURSOR FOR

SELECT Serial_No, RFQ_No, RFQ_Closing_Date, Product_Line FROM RFQDB WHERE DATEDIFF(day, GETDATE(),       RFQ_Closing_Date) = 2

OPEN RFQDate

FETCH NEXT FROM RFQDate INTO @Serial_No, @RFQ_No, @DueDate, @Product_Line 

WHILE @@FETCH_STATUS = 0

BEGIN 

DECLARE EMAIL CURSOR FOR

SELECT Profile_No, Sales_Email_ID FROM ProductLineDB WHERE Product_Line = @Product_Line

OPEN EMAIL

FETCH NEXT FROM EMAIL INTO @Profile_No, @Email

PRINT ' EMAIL: ' + @Email + ' | Profile No: ' + coalesce(Convert(varchar(4), @Profile_No),'')

WHILE @@FETCH_STATUS = 0

BEGIN 

FETCH NEXT FROM EMAIL INTO @Profile_No, @Email 

END

CLOSE EMAIL

DEALLOCATE EMAIL

FETCH NEXT FROM RFQDate INTO @Serial_No, @RFQ_No, @DueDate, @Product_Line

SET @Subject = ' Profile No: ' + coalesce(Convert(varchar(4), @Profile_No),'') + ' | RFQ No: ' +  coalesce(Convert(nvarchar(10), @RFQ_No),'') + ' | Due Date: ' + @DueDate 

SET @Body = 'The following ' + ' RFQ No: ' +  coalesce(Convert(nvarchar(10), @RFQ_No),'') + ' is due on date: ' + @DueDate 

PRINT ' Due Date: ' + @DueDate + ' | Serial No: ' + coalesce(Convert(varchar(4), @Serial_No),'') + ' | Product Line: ' + @Product_Line 

PRINT @Body

PRINT @Subject

IF @Email != ''
BEGIN
EXEC msdb.dbo.sp_send_dbmail
@profile_name = '31BM',
@importance = 'High',
@recipients = @Email,
@copy_recipients = @copy_recipients,
@subject = @Subject,
@body = @Body;
END
ELSE
PRINT 'No Email to send'
END

CLOSE RFQDate

DEALLOCATE RFQDate 
```

以上是最终的工作代码，我决定`SQL SERVER AGENT`每天用它来执行这项工作。

我希望它有所帮助。

# javascript - 使用 pdf.js 查看器在特定页面加载 PDF

> ID：14798342
> 
> 赞同：8
> 
> 时间：2013-02-10T13:41:16.710
> 
> 标签：javascript, pdf, pdf.js

我正在使用 pdf.js 和包含的查看器在我的网站上显示 pdf。我在查看器中添加了一个菜单，用户可以在其中选择不同 pdf 文件的特定书签。如果用户单击菜单项，则应打开文件并跳转到特定页面。

到目前为止，我设法打开了一个新的 pdf 文件，但我没有找到在特定页面打开它的方法。我试过这样：

```
PDFView.open(src + "/" + dest.file);
PDFView.page = dest.page; 
```

我知道，我可以`#page=`在第一次打开查看器时使用主题标签，但是当我在查看器已经打开后加载其他文件时，这不起作用。

有什么理由要解决这个问题吗？也许在新文件成功加载后我可以调用一个事件监听器，这样我就可以跳转到页面？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-10T19:27:41.993

`initialBookmark`在打开文件之前尝试重置值：

```
PDFView.initialBookmark = "page=10";
PDFView.open(src + "/" + dest.file); 
```

# php - PHP扩展类继承

> ID：14798347
> 
> 赞同：0
> 
> 时间：2013-02-10T13:41:45.467
> 
> 标签：php

我有一个要扩展的基类，但我无法弄清楚为什么我在基类中定义的变量不能被子类访问。我知道它们必须受到保护才能允许访问，但它们仍然对我不起作用。

```
class user {

    protected static $username;
    protected static $password;
    protected static $remember;

    function __construct() {

    }

    public function login($username, $password, $remember) {

        $this->username = $username;
        $this->password = $password;
        $this->remember = $remember;

        $login = new login();

    }

}

class login extends user {

    function __construct() {

        print("user is: " . $this->username);

        die();

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:44:27.353

因为变量应该是非静态的。如果你想要静态变量（就像你知道的那样）它应该看起来像这样

```
print("user is: " . self::$username); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T13:49:14.013

这会更有意义：

```
class user {

    protected $username;
    protected $password;
    protected $remember;

    public function __construct($username, $password, $remember) {
        $this->username = $username;
        $this->password = $password;
        $this->remember = $remember;
    }

    public static function login($username, $password, $remember) {
        return new login($username, $password, $remember);
    }

}

class login extends user {

    public function __construct($username, $password, $remember) {
        parent::__construct($username, $password, $remember);

        print("user is: " . $this->username);

        die();

    }
}

$foo = new user::login('foo', 'bar', 'meh'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T13:51:08.787

基类中的变量是静态的，可以更好地理解继承。

你需要这个：

```
class user {

    protected $username;
    protected $password;
    protected $remember;

    public function __construct($username, $password, $remember) {
        $this->username = $username;
        $this->password = $password;
        $this->remember = $remember;
    }
}

class login extends user {

    public function __construct($username, $password, $remember) {
        parent::__construct($username, $password, $remember);
        print("user is: " . $this->username);
    }
}

$user = new login('joe bloggs', 'a password', TRUE); 
```

# android - 获取照片 uri android 2.3.7 和 android 4

> ID：14798349
> 
> 赞同：1
> 
> 时间：2013-02-10T13:41:59.617
> 
> 标签：android, photo

我在 android 2.x 和 4.x 之间遇到了一些关于 gettin photo uri 的问题

以下代码在 2.x 上完美运行，但不适用于 4.x

```
 public static Uri getPhotoURIFromAddress(Context activity, String address) {
            String contactId = fetchContactIdFromPhoneNumber(address,activity);
            //Se non trovo il contatto il rubrica
            if(contactId.equals("0")){
                    return null;
            }

            ContentResolver contentResolver = activity.getContentResolver();
            try {
                Cursor cursor = contentResolver
                        .query(ContactsContract.Data.CONTENT_URI,
                                null,
                                ContactsContract.Data.CONTACT_ID
                                        + "="
                                        + contactId
                                        + " AND "

                                        + ContactsContract.Data.MIMETYPE
                                        + "='"
                                        + ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE
                                        + "'", null, null);

                if (cursor != null) {
                    if (!cursor.moveToFirst()) {
                        Log.i("No photo","No photo");
                        return null; // no photo
                    }
                } else {

                    return null; // error in cursor process
                }
                cursor.close();

            } catch (Exception e) {
                e.printStackTrace();
                return null;
            } 
```

我如何整合 4.x 的工作代码？谢谢

# java - Eclipse 中奇怪的 Xuggler 行为

> ID：14798350
> 
> 赞同：0
> 
> 时间：2013-02-10T13:42:08.540
> 
> 标签：java, eclipse, debugging, transcoding, xuggler

我有一个 Xuggler 类，可以将给定的媒体格式转换为 mp3。这适用于我扔给它的大多数东西，但是有时我会遇到一些 flv 文件，这会导致应用程序在 eclipse 中崩溃。

当我尝试在相关文件的调试中运行该类时，它实际上会正确执行并完成，即使输出的是有效的 mp3 文件！这也是可重现的，它发生在我在调试模式下完成的所有测试运行中，并且我已经交叉检查以确保相同的文件在正常执行中使应用程序崩溃。

无论我尝试过什么，我都无法在正常运行条件下转换一些 flv 文件。

在调试模式下是否有任何额外的 Eclipse 正在导致这种奇怪的效果？

**编辑**

更具体地说，崩溃发生在对 IContainer#open 的调用上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:18:59.413

似乎这不是问题。

我只是在将项目导出到可运行的 .jar 后尝试运行它，它运行良好。我只需要使用调试模式在发货前执行适当的测试。

# php - 上传图片：转换格式

> ID：14798351
> 
> 赞同：0
> 
> 时间：2013-02-10T13:42:16.300
> 
> 标签：php, image, imagemagick

我想将上传的图像转换为其原始格式（jpg、jpeg rpng 等），但我需要将这些图像的大小重新调整为 150 像素宽和 210 像素高。复制时是否可以更改大小，还是必须转换它？

这是不成功的：

```
 $uploaddir1 = "/home/myweb/public_html/temp/sfds454.png";
    $uploaddir2 = "/home/myweb/public_html/images/sfds454.png";

    $cmd = "/usr/bin/ffmpeg -i $uploaddir1 -vframes 1 -s 150x210 -r 1 -f mjpeg $uploaddir2";
    @exec($cmd); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T13:46:34.513

您可以使用**gd**代替**ffmpeg**。要转换或调整图像大小，请参阅此示例：[http ://ryanfait.com/resources/php-image-resize/resize.txt](http://ryanfait.com/resources/php-image-resize/resize.txt)

**gd**的 PHP 库：

[http://php.net/manual/en/function.imagecopyresampled.php](http://php.net/manual/en/function.imagecopyresampled.php)

该页面中还有一些调整脚本大小的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T01:12:16.893

我最近不得不解决这个问题，并实现了这个简单的缓存解决方案：

```
<?php
function send($name, $ext) {
    $fp = fopen($name, 'rb');
    // send the right headers
    header("Content-Type: image/$ext");
    header("Content-Length: " . filesize($name));

    // dump the picture and stop the script
    fpassthru($fp);
    exit;
}

error_reporting(E_ALL);
ini_set('display_errors', 'On');

if (isset($_REQUEST['fp'])) {
    $ext = pathinfo($_REQUEST['fp'], PATHINFO_EXTENSION);

    $allowedExt = array('png', 'jpg', 'jpeg');
    if (!in_array($ext, $allowedExt)) {
        echo 'fail';
    }

    if (!isset($_REQUEST['w']) && !isset($_REQUEST['h'])) {
        send($_REQUEST['fp']);
    }
    else {
        $w = $_REQUEST['w'];
        $h = $_REQUEST['h'];

        //use height, width, modification time and path to generate a hash
        //that will become the file name
        $filePath = realpath($_REQUEST['fp']);
        $cachePath = md5($filePath.filemtime($filePath).$h.$w);
        if (!file_exists("tmp/$cachePath")) {
            exec("gm convert -quality 80% -colorspace RGB -resize " .$w .'x' . $h . " $filePath tmp/$cachePath");
        }
        send("tmp/$cachePath", $ext);

    }
}
?> 
```

我注意到的一些事情：

1.  Graphicsmagick 的转换速度比 imagemagick 快得多，尽管我没有使用 cuda 处理测试转换。
2.  对于最终产品，我使用语言的本机图形库在 ASP 中重新实现了此代码。这又快了很多，但如果发生内存不足错误会中断（在我的工作站上运行良好，但在 4GB RAM 服务器上无法运行）。

# c# - Marshal.AllocHGlobal(Marshal.SizeOf(input)) 错误

> ID：14798357
> 
> 赞同：1
> 
> 时间：2013-02-10T13:42:51.113
> 
> 标签：c#, pinvoke

`input600`是一个长度为 600 的浮点数组。

```
IntPtr ip = Marshal.AllocHGlobal(Marshal.SizeOf(input600)); 
```

上述语句引发以下错误：

> 类型“System.Single[]”不能作为非托管结构封送；无法计算出有意义的大小或偏移量。

这个说法有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:46:00.707

从以下文档[`Marshal.SizeOf(object)`](http://msdn.microsoft.com/en-us/library/y3ybkfb3.aspx)：

> 此方法接受结构的实例，该实例可以是引用类型或装箱值类型。布局必须是顺序的或显式的。

数组不满足这个要求。但是，您应该能够像这样计算空间需求，假设数组元素类型是具有所需布局的结构的原语：

```
IntPtr ip = Marshal.AllocHGlobal(Marshal.SizeOf(input600.GetType().GetElementType())*input600.Length); 
```

# synchronization - 带有 FreeFileSync 的 linux/ubuntu 批处理脚本

> ID：14798358
> 
> 赞同：0
> 
> 时间：2013-02-10T13:43:09.483
> 
> 标签：synchronization, backup

### 如何在 Ubuntu 上执行 FreeFileSync 批处理脚本？

我设置了一个批处理作业，保存在扩展名为“.ffs_batch”的文件中。现在怎么办？如果我双击它，则没有文件关联。

我熟悉通过双击在 Windows 上执行 .bat 文件，但我在 Ubuntu 上。我希望有一个命令行，例如：sudo something batchjob.ffs_batch。还是我需要在执行之前设置正确的文件关联？或者编写另一个脚本来执行 .ffs_batch 文件。

我在 kUbuntu 10.10 上。我通过程序上传器安装了 FreeFileSync（所以可能不是最新版本）

不用说，我确实可以访问 Google 和帮助文件。有很多关于在 Windows 下做什么的信息，但我找不到 Linux 的相关解释。

以下是我目前掌握的所有信息：

### FreeFileSync 帮助

批处理脚本 FreeFileSync 可以从命令行调用并支持集成到批处理脚本中。本节提供了一些关于 Windows *.cmd 和 *.bat 脚本的一般提示和示例。当 FreeFileSync 以批处理模式启动时（*.ffs_batch 文件作为参数传递），它返回以下状态代码之一：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:02:00.240

It appears you didn't understand what `FreeFileSync` documentation was trying to tell you. The scripts themselves are not like `.bat` files, i.e., they are not self-executable. Ubuntu has no idea what to do with the file that you're double clicking. They need to be passed into the command line prompt for `FreeFileSync` in some pre-defined interface. Probably something like:

`./free_file_sync myBatch.ffs_batch`

I'm not sure what the executable is called, but it's probably something along those lines.

# batch-file - file name with Space causing missing operand

> ID：14798361
> 
> 赞同：0
> 
> 时间：2013-02-10T13:43:29.757
> 
> 标签：batch-file, operand

Attempting to make a batch to display the filesize of a file. I have found an (almost) perfect solution in another post ([How can I check the size of a file in a Windows batch script?](https://stackoverflow.com/questions/1199645/)) but whenever I enter a filename with a space, I get "missing operand" on the "FOR" line

I have implemented in a batch like this:

```
echo off
set /p title="Enter Film title: " %=%
set sum1=0
set fname="C:\Users\Public\Videos\ripped\%title%.mkv"
FOR /F "usebackq" %%A IN ('%fname%') DO set size=%%~zA
set /a sum1=%size%/1000000
echo Finished %title%.mkv, Size %sum1%Mb 
```

So, for example, [Royals] works, but [True Lies] doesnt. I've tried several combinations of quote marks etc but cant get it to work. Probably missing something small but can anyone help? Thanks Rob

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:50:09.490

尝试`FOR /F "usebackq tokens=*" %%A IN ('%fname%') DO set size=%%~zA`

# c - 删除工具栏控件中的字符串？

> ID：14798365
> 
> 赞同：0
> 
> 时间：2013-02-10T13:43:54.763
> 
> 标签：c, winapi

我目前正在将工具栏控件添加到 Windows 应用程序。我注意到通过文档（[MSDN Toolbar](http://msdn.microsoft.com/en-us/library/windows/desktop/bb760435%28v=vs.85%29.aspx)）没有消息或功能可以从工具栏控件中删除字符串，这看起来很奇怪，因为可以删除按钮和图像。拥有这个功能并不是很重要，只是想知道我是否遗漏了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T11:53:19.693

对于遇到此问题的其他人，我通过使用`TB_SETBUTTONINFO`消息设置按钮文本来解决它。这样您就不必将字符串添加到工具栏控件的字符串池中。

```
#define ID_BUTTONCOMMAND 101

//...

TBBUTTONINFO tbButtonInfo;

tbButtonInfo.cbSize     = sizeof( TBBUTTONINFO );
tbButtonInfo.dwMask     = TBIF_TEXT;
tbButtonInfo.pszText    = TEXT( "My Button" );

// HWND handle -- window handle to toolbar control

SendMessage( handle, TB_SETBUTTONINFO, ID_BUTTONCOMMAND, ( LPARAM )&tbButtonInfo ); 
```

# php - Dont understand where and how to put javascript block change page

> ID：14798368
> 
> 赞同：1
> 
> 时间：2013-02-10T13:44:04.500
> 
> 标签：php, javascript, block

I have this notification page (page before going to register page) this page check data from database, if false / true will show message under textbox, but its only to show that message not block process input. This one my notification page (show true message if from check.php no conflic):

```
<head>
<script src="js/jquery.js" type="text/javascript"></script>
<script src="js/settings.js" type="text/javascript"></script>
<SCRIPT type="text/javascript">
pic1 = new Image(16, 16); 
pic1.src = "img/loader.gif";
//untuk nim
$(document).ready(function(){
$("#cekintern").change(function() { 
var nomor = $("#cekintern").val();
if(nomor.length >= 8)
{
$("#status2").html('<img src="img/loader.gif" align="absmiddle">&nbsp;Checking availability...');
    $.ajax({  
    type: "POST",  
    url: "check.php",  
    data: "cekintern="+ nomor,  
    success: function(msg){  
   $("#status2").ajaxComplete(function(event, request, settings){ 
    if(msg == 'OK')
    { 
        $("#cekintern").removeClass('object_error'); // if necessary
        $("#cekintern").addClass("object_ok");
        $(this).html('&nbsp;<img src="img/accepted.png" align="absmiddle"> <font color="Green"> Available </font>  ');
    }  
    else  
    {  
        $("#cekintern").removeClass('object_ok'); // if necessary
        $("#cekintern").addClass("object_error");
        $(this).html(msg);
    }    
   });
 } 
  }); 
}
else
    {
    $("#status2").html('&nbsp;<img src="img/decline.jpg" align="absmiddle">  <font color="red">Maaf NIM anda salah.</font>');
    $("#cekintern").removeClass('object_ok'); // if necessary
    $("#cekintern").addClass("object_error");
    alert('Maaf NIM salah!!'); window.location.href='?get=2';
    }
});
});
//-->
</SCRIPT>
</head>
<body><br />
<form name="form1" method="post" action="register.php">
<center>
<em>Input <strong>NIM</strong></em><br />
    <input name="cekintern" type="text" id="cekintern" size="15" maxlength="9" placeholder="Input NIM Here"/><div id="status2"></div><br />
    <input type="submit" value="Confirm" />
    <input type="button" name="button" id="button" value="Cancel" onClick="window.location='index.php'"/></center>
</form> 
```

and this one check.php to check from database and show message error if has conflic:

```
<?php if(isSet($_POST['cekintern']))
{
$nimintern = $_POST['cekintern'];
$sql_check = mysql_query("SELECT * FROM {$prefix}intern WHERE nim='$nimintern'");
if(mysql_num_rows($sql_check))
{
$nimintern = $_POST['cekintern'];
$sql_check2 = mysql_query("SELECT * FROM {$prefix}pengguna WHERE nim_pengguna='$nimintern'");
if(mysql_num_rows($sql_check2))
{
echo '&nbsp;<img src="img/decline.jpg" align="absmiddle"> <font color="red">Maaf NIM <STRONG>'.$nim.'</STRONG> nim anda sudah terdaftar.</font>';
return false;
}
else
{
echo 'OK';  
}}
else
{
echo '&nbsp;<img src="img/decline.jpg" align="absmiddle"> <font color="red">Maaf NIM <STRONG>'.$nim.'</STRONG> tidak ada dalam daftar mahasiswa.</font>';
return false;
}}
?> 
```

all message is works, but im confuse what should i write to make notification.php (javascrit) & check.php (php) cancel input if the message is has conflic.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:23:34.257

您在成功的 ajax 回调中有此代码，如果发生冲突，您可以只添加一条指令：

```
$("#status2").ajaxComplete(function(event, request, settings){ 
if(msg == 'OK')
{ 
    $("#cekintern").removeClass('object_error'); // if necessary
    $("#cekintern").addClass("object_ok");
    $(this).html('&nbsp;<img src="img/accepted.png" align="absmiddle"> <font color="Green"> Available </font>  ');
}  
else  
{  
    $("#cekintern").removeClass('object_ok'); // if necessary
    $("#cekintern").addClass("object_error");
    $(this).html(msg);
    $("#cekintern").val("");/******/
} 
```

# javascript - Edit one row in a list of records?

> ID：14798370
> 
> 赞同：0
> 
> 时间：2013-02-10T13:44:09.030
> 
> 标签：javascript, jquery, html, asp.net-mvc-4, knockout.js

I have a list of records, e.g. addresses. It's displayed using the following html5/knockout code.

```
<section id="lists" data-bind="foreach: addresses, visible: addresses().length > 0">
    <article>
        <div>
            <button>Edit</button>
            <span data-bind="text: DisplayAddress"></span>
        </div>
        <p class="error" data-bind="visible: ErrorMessage, text: ErrorMessage"></p>
    </article>
</section> 
```

I want to show a table of editable input boxes () under the row after *Edit* button is clicked. Is there any way without generate a big html5 code?

I want to show the following *editing* html below the `<div>` after click the *Edit* button. (not completed)

```
<div>
    <table>
        <tr>
            <th>Street address</th><th>Apt#</th><th>City</th><th>State</th><th>Zip</th>
        </tr>
        <tr>
            <td><input type="text" class="col1"/></td>
            <td><input type="text" class="col2"/></td>
            <td><input type="text" class="col3"/></td>
            <td><input type="text" class="col4"/></td>
            <td><input type="text" class="col5"/></td>
        </tr>
    </table>
    <button data-bind="click: saveAddress">Save</button>
    <button data-bind="click: cancelAdding">Cancel</button>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:37:27.057

有几个合理的选择：

1) 使用[if](http://knockoutjs.com/documentation/if-binding.html)绑定来控制 HTML 块的呈现（不仅仅是可见性）。每行数据都有一个名为 的可观察属性`isEditing`。然后，添加行为函数来控制编辑/取消/等。您的文章模板将包括以下内容：

```
<div data-bind="if:isEditing">
   <input type="text" data-bind="value: DisplayAddress" />
</div> 
```

2）如果它只是一个字段，您可能想要创建一个自定义绑定处理程序，将您想要的行为添加到一个元素（它将动态添加/删除一个字段）。[Stackoverflow](https://stackoverflow.com/questions/13354491/knockout-inline-edit-binding)上有几个很好的例子。

# iphone - AVPlayer background issue

> ID：14798381
> 
> 赞同：0
> 
> 时间：2013-02-10T13:44:57.617
> 
> 标签：iphone, ios, background, avplayer

I have a problem with `AVPlayer`, when I tried to make the player working on the background, the iPhone 6.0 simulator works fine, but the sound on the real device disappears when the application goes to the background!

```
- (IBAction)RayaFM { 
    NSURL *URLA = [NSURL URLWithString:@"http://live.raya.fm:8032/;stream.mp3"];
    self.player = [AVPlayer playerWithPlayerItem:[AVPlayerItem playerItemWithURL:URLA]];

    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
    [[AVAudioSession sharedInstance] setActive: YES error: nil];

    UIBackgroundTaskIdentifier newTaskId = UIBackgroundTaskInvalid;
    [self.player play];
    newTaskId = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:NULL];

    if (newTaskId !=  bgTaskId != UIBackgroundTaskInvalid)
        [[UIApplication sharedApplication] endBackgroundTask: bgTaskId];

    bgTaskId = newTaskId;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T13:54:44.123

您还需要在 -info.plist 文件中包含以下内容：

```
<key>UIBackgroundModes</key>
<array>
    <string>audio</string>
</array> 
```

请参阅[http://developer.apple.com/library/ios/#qa/qa1668/_index.html](http://developer.apple.com/library/ios/#qa/qa1668/_index.html)

# regex - 从正则表达式的子集生成所有匹配项

> ID：14798388
> 
> 赞同：1
> 
> 时间：2013-02-10T13:45:51.390
> 
> 标签：regex

我需要定义一堆向量序列，它们都是一系列的`L`, `D`, `R`,`U`用于左、下、右、上或`x`中断。有可选部分和非此即彼的部分。我一直在使用自己发明的系统来记录它，但我想记录下来，以供其他可能不是程序员的人阅读。

我现在想使用正则表达式的子集（例如，我不打算使用任何通配符或无限重复）来定义向量序列和生成所有可能匹配字符串的脚本......

```
/LDR/ produces ['LDR']
/LDU?R/ produces ['LDR','LDUR']
/R(LD|DR)U/ produces ['RLDU','RDRU']
/DxR[DL]U?RDRU?/ produces ['DxRDRDR','DxRDRDRU','DxRDURDR','DxRDURDRU','DxRLRDR','DxRLRDRU','DxRLURDR','DxRLURDRU'] 
```

是否有可用于生成***所有匹配项***的现有库？

**编辑**

我意识到我只需要***or***语句，因为可选的东西可以由`thing or nothing`a 或 b 指定，两个可选的都可以是`(a|b|)`. 是否有另一种语言可以用来定义我正在尝试做的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T10:58:05.677

通过将@Dukeling提供的链接中的java代码翻译成javascript，我想我已经解决了我的问题......

```
var Node = function(str){
    this.bracket = false;
    this.children = [];
    this.s = str;
    this.next = null;
    this.addChild = function(child){
        this.children.push(child);
    }
}

var printTree = function(root,prefix){
  prefix = prefix.replace(/\./g, "");
  for(i in root.children){
    var child = root.children[i]
    printTree(child, prefix + root.s);
  }
  if(root.children.length < 1){
    console.log(prefix + root.s);
  }
}

var Stack = function(){
    this.arr = []
    this.push = function(item){
        this.arr.push(item)
    }
    this.pop = function(){
        return this.arr.pop()
    }
    this.peek = function(){
        return this.arr[this.arr.length-1]
    }
}

var createTree = function(s){

    // this line was causing errors for `a(((b|c)d)e)f` because the `(((` was only
    // replacing the forst two brackets.
    // var s = s.replace(/(\(|\||\))(\(|\||\))/g, "$1.$2");
    // this line fixes it
    var s = s.replace(/[(|)]+/g, function(x){ return x.split('').join('.') });

    var str = s.split('');
    var stack = new Stack();
    var root = new Node("");
    stack.push(root); // start node
    var justFinishedBrackets = false;
    for(i in str){
        var c = str[i]
        if(c == '('){
            stack.peek().next = new Node("Y"); // node after brackets
            stack.peek().bracket = true; // node before brackets
        } else if (c == '|' || c == ')'){
            var last = stack.peek(); // for (ab|cd)e, remember b / d so we can add child e to it
            while (!stack.peek().bracket){ // while not node before brackets
                stack.pop();
            }
            last.addChild(stack.peek().next); // for (b|c)d, add d as child to b / c
        } else {
            if (justFinishedBrackets){
                var next = stack.pop().next;
                next.s = "" + c;
                stack.push(next);
            } else {
                var n = new Node(""+c);
                stack.peek().addChild(n);
                stack.push(n);
            }
        }
        justFinishedBrackets = (c == ')');
    }
    return root;
}

// Test it out
var str = "a(c|mo(r|l))e";
var root = createTree(str);
printTree(root, "");
// Prints: ace / amore / amole 
```

我只更改了一行，允许处理两个以上连续的括号，并将原始翻译留在评论中

我还添加了一个函数来返回结果数组，而不是打印它们......

```
var getTree = function(root,prefix){
  this.out = this.out || []
  prefix = prefix.replace(/\./g, "");
  for(i in root.children){
    var child = root.children[i]
    getTree(child, prefix + root.s, out);
  }
  if(root.children.length < 1){
    this.out.push(prefix + root.s);
  }
  if(!prefix && !root.s){
    var out = this.out;
    this.out = null
    return out;
  }
}

// Test it
var str = "a(b|c)d";
var root = createTree(str);
console.log(getTree(root, ""));
// logs ["abd","acd"] 
```

最后一部分，也允许空字符串，所以...`(ab|c|)`表示`ab`or `c`or `nothing`，以及一个方便的快捷方式，以便`ab?c`翻译成`a(b|)c`.

```
var getMatches = function(str){
    str = str.replace(/(.)\?/g,"($1|)")
    // replace all instances of `(???|)` with `(???|µ)`
    // the µ will be stripped out later
    str = str.replace(/\|\)/g,"|µ)")
    // fix issues where last character is `)` by inserting token `µ`
    // which will be stripped out later
    str = str+"µ"
    var root = createTree(str);
    var res = getTree(root, "");
    // strip out token µ
    for(i in res){
        res[i] = res[i].replace(/µ/g,"")
    }
    // return the array of results
    return res
}

getMatches("a(bc|de?)?f");
// Returns: ["abcf","adef","adf","af"] 
```

最后一部分有点骇人听闻，因为它依赖于`µ`不在字符串中（对我来说不是问题）并解决了一个错误，其中输入字符串末尾的 a导致错误输出，方法是在末尾`)`插入 a`µ`每个字符串，然后从结果中剥离它。我很乐意有人提出更好的方法来处理这些问题，因此它可以作为更通用的解决方案。

这段代码可以满足我的一切需求。感谢你的帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:19:37.450

我想你正在尝试用一棵树很容易（只要它只是或语句）。

将（或任何或语句）解析`a(b|c)d`为如下所示的树：`a`有孩子`b`和`c`，`b`并且`c`有一个共同的孩子`d`。`b`并且`c`都可以由 0 个或多个节点组成（例如在`c`这种`g(e|f)h`情况下（部分）树将为空`a -> g -> e/f (2 nodes) -> h -> d`或`c`可能为空，在这种情况下（部分）树将为`a -> d`空，但实际的物理空节点可能会简化东西，你应该在尝试编写代码时看到）。

使用递归或堆栈生成树应该不会太困难。

一旦你有了一棵树，递归地遍历整个事物并生成所有字符串就很简单了。

此外，[这里](https://stackoverflow.com/questions/22115/using-regex-to-generate-strings-rather-than-match-them)是一个类似问题的链接，提供一两个库。

**编辑：**

`"shouldn't be too difficult"`- 好吧，也许不是

[这](http://ideone.com/iqLtso)是一个有点复杂的示例（Java），可能需要一些有关堆栈的高级知识。

`((`由于在每个, `))`,`|(`等之间插入了一个特殊字符，[这是一个稍微简单的版本 (Java)。](http://ideone.com/fHeFJf)

请注意，这些都不是特别有效，关键是要传达这个想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T19:34:12.320

这是一个 JavaScript 示例，用于解析 (a|b) 和 (a|b|) 的可能性，创建一个可能的子字符串数组，并根据[这个答案](https://stackoverflow.com/a/8461467/2034787)组成匹配项。

```
var regex = /\([RLUD]*\|[RLUD]*\|?\)/, 
    str = "R(LD|DR)U(R|L|)",
    substrings = [], matches = [], str_tmp = str, find

while (find = regex.exec(str_tmp)){
  var index = find.index

  finds = find[0].split(/\|/)
  substrings.push(str_tmp.substr(0, index))

  if (find[0].match(/\|/g).length == 1) 
    substrings.push([finds[0].substr(1), finds[1].replace(/.$/, '')])
  else if (find[0].match(/\|/g).length == 2){
    substrings.push([finds[0].substr(1), ""])
    substrings.push([finds[1], ""])
  }

  str_tmp = str_tmp.substr(index + find[0].length)
}
if (str_tmp) substrings.push([str_tmp])
console.log(substrings) //>>["R", ["LD", "DR"], "U", ["R", ""], ["L", ""]]

//compose matches
function printBin(tree, soFar, iterations) {
  if (iterations == tree.length) matches.push(soFar)
  else if (tree[iterations].length == 2){
      printBin(tree, soFar + tree[iterations][0], iterations + 1)
      printBin(tree, soFar + tree[iterations][1], iterations + 1)
  }
  else printBin(tree, soFar + tree[iterations], iterations + 1)
}
printBin(substrings, "", 0)
console.log(matches) //>>["RLDURL", "RLDUR", "RLDUL", "RLDU", "RDRURL", "RDRUR", "RDRUL", "RDRU"] 
```

# perl - Perl : Regex/File::Basename

> ID：14798397
> 
> 赞同：1
> 
> 时间：2013-02-10T13:46:44.957
> 
> 标签：perl

```
use File::Basename;
my $path = "a/b/c/d";
my $dirpath = basename ($path);
my $basepath = dirname ($path);
my $base_basepath = dirname ($basepath);
my $dir_dirpath = basename ($basepath);
print "$dir_dirpath/$dirpath\n"; 
```

I want c/d to be printed (i.e the list dir/filename). Is the above the best way to do that? The above obviously works but I somehow don't like it. Is there a better/cool/efficient way to do it? Something like a regex match??

Actually, that program just does a part of what I really want it to do. These are the different use cases and what the expected result is :

```
a/b/c/d => c/d d
b/c/d => c/d d
/c/d => c/d d
c/d => c/d d
/d => d
d => d 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:52:17.437

该[`File::Spec`](https://metacpan.org/module/File%3a%3aSpec)模块是操作文件路径的规范且可移植的方式，并 [`File::Spec::Functions`](https://metacpan.org/module/File%3a%3aSpec%3a%3aFunctions)允许直接访问该模块的功能，而不必在`File::Spec->`任何地方都为它们加上前缀。

```
use strict;
use warnings;

use File::Spec::Functions qw/ splitdir catdir /;

my $path = "a/b/c/d";
my @path = splitdir $path;
print catdir @path[-2,-1]; 
```

**输出**

```
c/d 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:19:27.503

### 使用拆分的一种方法

```
#!/usr/bin/perl

my $z="a/b/c/d";
my ($a, $b, $c, $d) = split ('/', $z);
print "$c/$d"; 
```

### 仅使用正则表达式

```
#!/usr/bin/perl

my $z = "a/b/c/d"; 
($a, $b) = $z[$cnt] =~ m#(\w+){0,1}/{0,1}(\w+)$#;
printf "$a/$b - $b\n"; 
```

**注意：**此方法查找尾随 dir1/dir2 并将它们保存到`$a`和`$b`. 美元符号 ($) 强制匹配锚定到字符串的末尾，因此它匹配右侧 or `$z`。如果`{0,1}`它存在，则允许我们在那里匹配某些东西，但如果不存在则忽略它。这些对于`/d`和`d`情况是必要的。

### 所有可能的路径演示

```
#!/usr/bin/perl

my @z = qw(a/b/c/d b/c/d /c/d c/d);

for (my $cnt = 0; $cnt <= 3; $cnt++) {
  ($a, $b) = $z[$cnt] =~ m#(\w+){0,1}/{0,1}(\w+)$#;
  printf "%10s   -   %s/%s  -  %s\n", $z[$cnt], $a, $b, $b;
}

### output
% ./script.pl 
a/b/c/d   -   c/d  -  d
  b/c/d   -   c/d  -  d
   /c/d   -   c/d  -  d
    c/d   -   c/d  -  d
     /d   -   /d  -  d
      d   -   /d  -  d 
```

这只是表明这种方法适用于问题中提到的目录。

**注意：**这种方法确实有它的缺点。它仅适用于 UNIX 系统，需要特别注意目录名称的**(\w+)**匹配器。如果您的目录中有空格，这将失败。

# jquery - multiple file inputs, how to get id of each for preview

> ID：14798399
> 
> 赞同：1
> 
> 时间：2013-02-10T13:47:02.063
> 
> 标签：jquery, image, input, upload

after trying to get a multiple file selection input working with previews, but then finding out IE doesn't support it, i've changed how i'm going about a multiple file upload.

now I have multiple single file inputs, each with their own 'preview' div. the id of each select and preview div are linked (input select id ="file1", preview div id="previews_file1") etc up to 10.

Im using this code to preview the image selected:

```
function readURL(input) {
if (input.files && input.files[0]) {
    var reader = new FileReader();

    reader.onload = function (e) {
        var thisid = $(this).id;
        var container = $('#previews_'+ thisid);
        var image = $('<img>').attr('src', e.target.result).css({'max-width':'200px','max-height':'200px'});
        image.appendTo(container);
    };
    reader.readAsDataURL(input.files[0]);
}
} 
```

with html:

```
 <div id="previews_file1" style="float:left;width:200px;height:200px;"></div>
    <input type='file' id="file1" name="file1" onchange="readURL(this);" style="float:left;" /> 
```

my problem is i cant seem to pass the inputs id over to the function, certainly $(this).id doesn't work. how would i go about putting the preview into the right preview div?

**EDIT:**

js fiddle: [http://jsfiddle.net/KE3tv/](http://jsfiddle.net/KE3tv/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T13:51:27.770

[http://jsfiddle.net/KE3tv/1/](http://jsfiddle.net/KE3tv/1/)

```
<input type='file' name="file1" />
<input type='file' name="file2" />
<input type='file' name="file3" /> 
```

江青

```
$('input[type="file"]').on('change', function(){
    ...
    // name is already a unique attribute, no need for an id
    var container = $('#previews_'+ $(this).attr('name')); 
    ...
}); 
```

# jquery - 类型错误：$.browser 未定义

> ID：14798403
> 
> 赞同：74
> 
> 时间：2013-02-10T13:47:45.610
> 
> 标签：jquery, jquery-blockui

我正在使用 msdropdown 图像组合框来创建下拉选择选项。当我在我的 PC 上本地运行此代码时，一切正常。但是当我在 go daddy 服务器上运行它时，msdropdown 被禁用。

它不适用于任何浏览器。Firebug 将错误显示为：

```
TypeError: $.browser is undefined 
```

请帮我解决一下这个。

```
 echo <<<_START
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
 <title>profile</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="generator" content="HAPedit 3.1">
<link rel="stylesheet" href="profile.css" type="text/css">
<link rel="stylesheet" type="text/css" href="dd.css" />
<link rel="stylesheet" href="javascript/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.9.0.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.1.0.js"></script>
<script type="text/javascript" src="jQuery.js"></script>
<script src="javascript/jquery-ui.js"></script>
<script type="text/javascript" src="javascript/drop.js"></script>
<script src="jquery.dd.min.js"></script>
<script type="text/javascript" src="jquery.blockUI3.js"></script>
<script type="text/javascript" src="javascript/req.js"></script>
<link rel="stylesheet" href="css/body.css" />
<script>
$(function() {
$( "#datepicker" ).datepicker({dateFormat: 'dd-mm-yy', minDate: 0, maxDate: "+0M +5D"       
 });
});
</script>
<script type="text/javascript">
    <!--
        function otherSelect() {
            var other = document.getElementById("otherBox");
            if    (document.getElementById("form3").place.options[document.getElementById("form3").place.selectedIndex].value == "other") {
                other.style.visibility = "visible";
            }
            else {
                other.style.visibility = "hidden";
            }
        }
    //-->
</script>
</head>

<body id="body">

 <div id="container">
<div class="header">
<a href="profile.php" class="logo">
    <img title="Title" alt="Alter" src="images/logo.png" border="0" height="60px"  width="200px">
</a>
<a style="text-decoration:none; margin-top:15px; font-family:Bookman Old Style;  font-size:12px; color:#FFFFFF; font-weight:bold;" href="logout.php?id='$session_id'"  class="req">
Logout
</a>
<a href="notification.php?email='$encrypted_string'" class="req1">
<img border="0" title="Notifications" alt="Notifications" src="images/notification.png" height="60px" width="60px"><div class="text1">$numbr</div>
</a>
<a href="request.php?email='$encrypted_string'" class="req2">
<img border="0" title="requests" alt="Requests" src="images/request.png" height="60px" width="60px"><div class="text">$req</div>
</a>
</div>

<div id="navigation">
<div id="picture"><img src="$img">
<h1 id="display" style="margin-left:30px;">$name</h1><hr>
<table style="background-color:#81F781;font-family:Chaparral Pro,corbel; font-   size:17px; color:#1C1C1C; width:100%;" border="1" cellpadding="25">
<tr><th>Requests($n)</th></tr></table>
</div>
</div></div>
<div style="margin-top: 90px;" id="conte">

_START;

 echo <<<_START
 </div>
 <div id="accept" style="display:none">
<form method="post" id="form3" action="cnfrm.php">
<br><table border="0" style="width:100%;" cellspacing="4" cellpadding="4"><tr>    <td  style="font-family:Chaparral Pro,corbel; font-size:17px; color:#1C1C1C;">Meeting Date:   <input type="text" id="datepicker" name="date"/></td>
<td style="font-family:Chaparral Pro,corbel; font-size:17px; color:#1C1C1C;">@ about<input  type="text" id="time" size="3">AM<input type="radio" name="time2" id="time2" value="am"> |   PM<input type="radio" name="time2" id="time2" value="pm"></td></tr>
_START;

echo <<<H
<tr><td valign="top" rowspan="2">
<select id="place" name="place" style="width:300px;" onchange="otherSelect()">
    <option value="" data-description="Choose your meeting place"  selected="selected">Meet me @</option>
    <option value="LC" data-image="image/msdropdown/icons/meet.png" data-description="Limbdi Corner">L.C</option>
    <option value="VT" data-image="image/msdropdown/icons/meet.png" data-description="Vishwanath temple">V.T</option>
    <option value="H.G" data-image="image/msdropdown/icons/meet.png" data-description="Hyderabaad Gate">H.G</option>
    <option value="D.G Corner" data-image="image/msdropdown/icons/meet.png" data-description="Dhanrajgiri Corner">D.G corner</option>
    <option value="Library" data-image="image/msdropdown/icons/meet.png" data-description="IIT Library">Library</option>
    <option value="other" data-image="image/msdropdown/icons/meet.png" data-description="Add your own...">Other place</option>
</select> </td></tr>
H; 
```

此问题已解决：[msdropdown 更新](https://github.com/marghoobsuleman/ms-Dropdown)并下载最新文件。

感谢大家

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-07-05T18:39:28.253

只需将 $.browser 代码放入您的 js

```
var matched, browser;

jQuery.uaMatch = function( ua ) {
    ua = ua.toLowerCase();

    var match = /(chrome)[ \/]([\w.]+)/.exec( ua ) ||
        /(webkit)[ \/]([\w.]+)/.exec( ua ) ||
        /(opera)(?:.*version|)[ \/]([\w.]+)/.exec( ua ) ||
        /(msie) ([\w.]+)/.exec( ua ) ||
        ua.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec( ua ) ||
        [];

    return {
        browser: match[ 1 ] || "",
        version: match[ 2 ] || "0"
    };
};

matched = jQuery.uaMatch( navigator.userAgent );
browser = {};

if ( matched.browser ) {
    browser[ matched.browser ] = true;
    browser.version = matched.version;
}

// Chrome is Webkit, but Webkit is also Safari.
if ( browser.chrome ) {
    browser.webkit = true;
} else if ( browser.webkit ) {
    browser.safari = true;
}

jQuery.browser = browser; 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-02-10T13:51:50.283

`$.browser`已从 JQuery 1.9 中删除。您可以改用[Modernizr](http://modernizr.com/)项目

[http://jquery.com/upgrade-guide/1.9/#jquery-browser-removed](http://jquery.com/upgrade-guide/1.9/#jquery-browser-removed)

**更新以支持 IE 10 和 IE 11（TRIDENT 版本）**

要完成@daniel.moura 的回答，这里有一个**支持 IE 11 和 +**

```
var matched, browser;

jQuery.uaMatch = function( ua ) {
    ua = ua.toLowerCase();

    var match = /(chrome)[ \/]([\w.]+)/.exec( ua ) ||
        /(webkit)[ \/]([\w.]+)/.exec( ua ) ||
        /(opera)(?:.*version|)[ \/]([\w.]+)/.exec( ua ) ||
        /(msie)[\s?]([\w.]+)/.exec( ua ) ||       
        /(trident)(?:.*? rv:([\w.]+)|)/.exec( ua ) ||
        ua.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec( ua ) ||
        [];

    return {
        browser: match[ 1 ] || "",
        version: match[ 2 ] || "0"
    };
};

matched = jQuery.uaMatch( navigator.userAgent );
//IE 11+ fix (Trident) 
matched.browser = matched.browser == 'trident' ? 'msie' : matched.browser;
browser = {};

if ( matched.browser ) {
    browser[ matched.browser ] = true;
    browser.version = matched.version;
}

// Chrome is Webkit, but Webkit is also Safari.
if ( browser.chrome ) {
    browser.webkit = true;
} else if ( browser.webkit ) {
    browser.safari = true;
}

jQuery.browser = browser;
// log removed - adds an extra dependency
//log(jQuery.browser) 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-08-01T13:54:43.573

只需包含此脚本

[http://code.jquery.com/jquery-migrate-1.0.0.js](http://code.jquery.com/jquery-migrate-1.0.0.js)

在你包含你的 jquery javascript 文件之后。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-03-29T04:54:00.240

我在我的代码中放置了以下 html，这清除了 $.browser 错误

```
<script src="http://code.jquery.com/jquery-migrate-1.0.0.js"></script> 
```

希望这对你有帮助

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-08-19T15:33:20.433

用以下内容替换您的 jquery 文件：

`<script src="//code.jquery.com/jquery-1.11.3.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>`

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-02-10T13:53:09.560

[$().live(函数(){}); 并且 jQuery.browser 在 jquery 1.9.0 中未定义](https://stackoverflow.com/questions/14458511/livefunction-and-jquery-browser-is-undefined-in-jquery-1-9-0) - $.browser 在 jquery 更新中已弃用

听起来您在 Godaddy 中使用的是不同版本的 jquery 1.9，因此请更改代码或包含迁移插件[http://code.jquery.com/jquery-migrate-1.0.0.js](http://code.jquery.com/jquery-migrate-1.0.0.js)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-15T05:27:27.673

我确实使用下面指定的 jQuery 迁移链接解决了它：

```
<script src="http://code.jquery.com/jquery-migrate-1.0.0.js"></script> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-10T13:55:02.967

某个地方的代码——无论是你的代码还是一个 jQuery 插件——正在调用`$.browser`以获取当前的浏览器类型。

然而，早在一年前[，该`$.browser`功能就被弃用了](http://pupunzi.open-lab.com/2012/08/14/jquery-1-8-and-browser-detection/)了。从那时起，一些错误已经被提交，但由于它已被弃用，jQuery 团队决定不修复它们。我决定完全不依赖这个功能。

我在您的代码中没有看到任何引用`$.browser`，因此问题可能在于您的插件之一。要找到它，请查看您使用标记引用的每个插件的源代码`<script>`。

至于如何解决它：嗯，这取决于上下文。例如，也许有问题插件的更新版本。或者也许你可以使用另一个插件来做类似的事情，但不依赖于`$.browser`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-20T07:01:20.307

我确实使用这个 jquery 解决了 Github

`<script src="http://code.jquery.com/jquery-migrate-1.0.0.js"></script>`

请参阅此链接了解更多信息。 [https://github.com/Studio-42/elFinder/issues/469](https://github.com/Studio-42/elFinder/issues/469)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-07T16:51:19.247

在 Wordpress 8.5.1 中，我安装了这个插件“ [Enable jQuery Migrate Helper](https://wordpress.org/plugins/enable-jquery-migrate-helper/) ”。

它没有任何问题。

# git - 你是如何在现实世界中使用 GIT 的？

> ID：14798409
> 
> 赞同：2
> 
> 时间：2013-02-10T13:48:30.590
> 
> 标签：git, version-control

这个问题实际上是关于分支和合并的。我上周刚开始使用 git，我真的很喜欢它，但我有一些问题.. 我读到的所有内容都告诉我永远不要在 master 分支中工作。因此，在我进行任何编程更改之前，我会创建一个新分支并完成我的工作，然后我会合并回 master ......我不知道这是否正确，所以我想听听其他人的意见。

但是我如何处理要登台和生产的代码呢？我只是在 master 中标记代码还是为每个版本创建一个生产分支。

请有人告诉我你是如何处理将代码转移到登台、测试和生产的……你是使用标签还是分支还是两者兼而有之。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:52:59.030

那里有很多模型：您的版本控制设置可以根据您的需要简单或复杂。这是一种流行的方法： http: [//nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

就个人而言，我为每个功能/错误使用一个新分支，然后像你一直在做的那样合并到 master 中。然后简单地标记生产版本，其中登台服务器在主服务器上运行。

如果您需要更复杂的东西，您可以执行上述 Git Flow 技术，它具有发布分支等，但如果您不需要它，那么您不必这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:20:31.793

不要忘记*分布式*版本控制系统的另一个维度：

您不仅有标记和分支，还有一个[合并工作流程](https://stackoverflow.com/questions/216212/how-do-you-maintain-development-code-and-production-code#216228)来管理您的代码在发布管理过程中的推广，您*还*具有发布的[正交特性](https://stackoverflow.com/questions/2563836/sell-me-distributed-revision-control/2563917#2563917)（跨存储库推/拉）

因此，没有什么能阻止您将某个标签（从您想要的任何分支）推送到专用的 UAT、SIT 或 pre-prod 存储库，以便在将其发布到生产环境之前进行测试。
请注意，生产方面可以很好地将 git 从其进程中排除，以便仅保留运行和监视应用程序所需的内容，为应用程序*开发*生命周期保留 git。请参阅“[在生产环境中使用 Web 根目录下的 git](https://stackoverflow.com/questions/3144670/using-git-below-web-root-in-production/3144865#3144865) ”。

# java - netbeans 7.1.2、scala 2.9.1-1、nbscala-7.1v2.9.x-0.1.zip

> ID：14798412
> 
> 赞同：0
> 
> 时间：2013-02-10T13:48:44.747
> 
> 标签：java, scala, netbeans

你能帮我解决这个问题吗？我尝试使用“Hello，world”之类的简单代码运行scala文件，但出现这样的错误

```
C:\Users\Ersain\Documents\NetBeansProjects\ScalaApplication4\nbproject\build-impl.xml:403: **The following error occurred while executing this line**:
C:\Users\Ersain\Documents\NetBeansProjects\ScalaApplication4\nbproject\build-impl.xml:236: Problem: **failed to create task or type scalac
Cause: The name is undefined.** 
```

我用这个参数创建了用户变量：`SCALA_HOME,`value- `C:\scala-2.9.1-1\bin;` system variable has parameter like user variable

当我去`TOOLS->SCALA PLATFORMS`它时，它会向我显示这条消息

```
"Error: The specified folder does not contain a Scala platform.
If you want to specify a different folder for this platform, remove this platform and create a new one with exactly the same name pointing to the correct platform folder." 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T13:55:40.207

尝试设置`SCALA_HOME`为`C:\scala-2.9.1-1`，而不是`bin`目录。

# android - 使用 Android 地图 v2 进行自由绘图

> ID：14798419
> 
> 赞同：0
> 
> 时间：2013-02-10T13:49:41.563
> 
> 标签：android, google-maps-android-api-2

我有一个使用新的 v2 Google Maps API for Android 的地图应用程序。我想要做的是允许用户在地图上画一条沿着他们手指的路径的线。我知道我可能需要一个按钮来启用/禁用此功能，因为它显然需要禁用平移/缩放控件。一旦用户画出他们的线，我需要能够将末端连接起来形成一个多边形。有谁知道如何做到这一点？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:14:18.910

我认为您可以通过使用覆盖地图片段上方**视图的框架布局来实现这一点。**侦听该视图上的触摸事件，并在用户想要禁用绘图时将其可见性设置为 GONE，这样它就不会触发您的触摸侦听器，而是触发地图侦听器。

另一种方法是使用标记而不是允许自由绘图，您可以轻松地监听标记拖动事件并在拖动事件完成时绘制线条。

关闭多边形就像从头到尾画一条线一样简单。

这将允许您在地图上原始[https://developers.google.com/maps/documentation/android/lines](https://developers.google.com/maps/documentation/android/lines)

# linux - 带有 scape 字符的 Linux 命令

> ID：14798420
> 
> 赞同：-2
> 
> 时间：2013-02-10T13:49:44.323
> 
> 标签：linux, shell, sed, command

当我尝试执行这样的命令时：

> > ssh host_1 "cat test_file | sed 's/$/\tOK/'"

我收到了这个错误：

> > 非法变量名。

问题是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:52:00.487

尝试转义美元符号：

```
ssh host_1 "cat test_file | sed 's/\$/\\tOK/'" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T13:52:12.963

我认为您必须转义特殊字符：

```
ssh host_1 "cat test_file | sed 's/\$/\\tOK/'" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T15:10:56.327

当你跑

```
ssh host_1 "cat test_file | sed 's/$/\tOK/'" 
```

您的本地 shell 首先对其参数执行参数扩展。命令是`ssh`，第一个参数是`host_1`，第二个参数是`"cat test_file | sed 's/$/\tOK'"`。由于第二个参数在双引号中，因此尝试了参数扩展。但是，`$/`不是 中的有效参数`bash`。请注意，单引号只是双引号字符串中的文字字符；它们不保护美元符号不受参数扩展的影响。因此，正如其他问题中指出的那样，您需要避开美元符号。

执行命令后，远程端的 shell 会收到以下字符串：

```
cat test_file | sed 's/$/\tOK'. 
```

双引号消失了，因为它们在本地 shell 删除引号期间被删除。美元符号现在同样未转义。现在，因为远程 shell 将第一个参数`sed`看成是一个单引号字符串，所以不执行参数扩展，并且不需要转义美元符号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T08:08:56.020

我终于知道发生了什么。

当答案对你有用而不是对我有用时，我疯了。你们的答案是完全正确的。但是问题是我使用的是 csh 而不是 ksh，每个人都以不同的方式解释命令（参数扩展）。

谢谢你们。

# weka - Weka：测试文件的 ReplaceMissingValues

> ID：14798421
> 
> 赞同：4
> 
> 时间：2013-02-10T13:50:03.230
> 
> 标签：weka

`ReplaceMissingValues`使用 Weka仅为测试**arff 数据集**而不是**训练数据集**输入缺失值时，我有点担心。下面是命令行：

```
java -classpath weka.jar weka.filters.unsupervised.attribute.ReplaceMissingValues -c last  -i "test_file_with_missing_values.arff" -o "test_file_with_filled_missing_values.arff" 
```

从上一篇文章（[Replace missing values with mean (Weka)](https://stackoverflow.com/questions/10269884/replace-missing-values-with-mean-weka)）中，我了解到 Weka`ReplaceMissingValues`只是将每个缺失值替换为相应属性的平均值。这意味着需要为每个属性计算平均值。虽然这个平均值的计算对于训练文件来说非常好，但对于测试文件来说就不行了。

这是因为在典型的测试场景中，我们不应该假设我们知道输入缺失值的测试属性的平均值。我们只有一个具有多个分类属性的测试记录，而不是将整个测试记录集放在一个测试文件中。因此，相反，我们将根据使用训练数据计算的平均值输入缺失值。然后上面的命令将变得不正确，因为我们需要另一个输入（火车属性的手段）。

以前有人想过这个吗？你如何通过使用 weka 来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T18:52:26.400

简单，请参阅[批量过滤](http://weka.wikispaces.com/Use+Weka+in+your+Java+code#Filter-Batch%20filtering)

```
Instances train = ...   // from somewhere
Instances test = ...    // from somewhere
Standardize filter = new Standardize();
filter.setInputFormat(train);  // initializing the filter once with training set
Instances newTrain = Filter.useFilter(train, filter);  // configures the Filter based on train instances and returns filtered instances
Instances newTest = Filter.useFilter(test, filter);    // create new test set 
```

过滤器使用训练数据初始化，然后应用于训练和测试数据。

问题是当您在任何处理管道之外应用 ReplaceMissingValue 过滤器时，因为在写入过滤后的数据后，您无法再区分“真实”值和“估算”值。这就是为什么您应该在单个管道中完成所有需要完成的事情，例如，使用 FilteredClassifier：

```
java -classpath weka.jar weka.classifiers.meta.FilteredClassifier
-t "training_file_with_missing_values.arff"
-T "test_file_with_missing_values.arff"
-F weka.filters.unsupervised.attribute.ReplaceMissingValues
-W weka.classifiers.functions.MultilayerPerceptron -- -L 0.3 -M 0.2 -H a 
```

此示例将使用“ **training** _file_with_missing_values.arff”数据集初始化 ReplaceMissingValues 过滤器，然后将过滤器应用于“ **test_file_with_missing_values.arff** ”（使用从训练集中学习的方法），然后在过滤后的训练数据上训练多层感知器并预测过滤后的测试数据的类别。

# c# - 一些文件丢失了！使用 Math.net 数字 2.4.0

> ID：14798424
> 
> 赞同：-2
> 
> 时间：2013-02-10T13:50:23.447
> 
> 标签：c#, winforms, teamcity, numerics

我在我的 C# 项目、winform 中使用 Math.Net numerics 2.4.0 版，并且在运行项目并执行某些部分后，它说：

> **查找来源：ManagedLinearAlgebraProvider.Double 原始位置：c:\TeamCity\buildAgent\work\d4ecde2945c804d6\src\Numerics\Algorithms\LinearAlgebra\ManagedLinearAlgebraProvider.Double。**

并在我按下取消程序时打开一个窗口来定位它，但我的矩阵条目变为 NAN。

这不是它想要的唯一文件，每次它都需要不同的文件。我该怎么办？

我认为软件包未安装，所以我将其删除并重新安装，但它没有用。

[1](http://i.stack.imgur.com/iW5mr.jpg)、[2](http://i.stack.imgur.com/aCn2x.jpg) 和这些是错误图片。（单击蓝色 1 和 2）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T22:14:30.873

当矩阵运算存在逻辑问题时会发生这种情况，例如，如果矩阵不是方阵，但在代码中您尝试对其求逆，则会出现此错误。

我的问题在于我的程序的数学......并最终解决了。

# c# - "\a" 和 Console.Beep() 方法是否播放相同的哔声？

> ID：14798426
> 
> 赞同：5
> 
> 时间：2013-02-10T13:50:31.313
> 
> 标签：c#, .net, escaping, beep

`\a`是一个[*`escape sequence`*](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)代表字符常量的*警钟。*关于*MSDN*[`Console.Beep()`](http://msdn.microsoft.com/en-us/library/8hftfeyw.aspx)的方法说明：

 *> 通过控制台扬声器播放哔声。

让我们考虑这个示例代码：

```
public static void Main(string[] args)
{
     Console.WriteLine("\a");
     Console.Beep();
} 
```

这段代码会产生 2 次哔哔声，它们对我来说听起来一样。现在我需要看看证据。

当我反编译该[`Console.Beep()`](http://msdn.microsoft.com/en-us/library/8hftfeyw.aspx)方法时，它使用`Win32Native.Beep`from *kernel32.dll*；

```
public static void Beep(int frequency, int duration)
{
    Win32Native.Beep(frequency, duration);
} 
```

它们的频率和持续时间可能不同，我没有说这些东西，但它们的来源是否相同（`Win32Native.Beep`）？*响铃警报*`\a`使用哪个来源？

 ** * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T15:01:55.053

这是我通过检查音频所能收集到的（Windows 7 64 位（是的，我不得不重新启动到 Windows，我就是那么专注:)）。我使用 Fraps 录制了音频，所以它应该是可靠的。

这是我用来检查它们的代码：

```
using System;
using System.Threading;

namespace StackOverflow
{
    class Program
    {
        private static void Main(string[] args)
        {
            Console.Write("\a");
            Thread.Sleep(500);
            Console.Beep();
        }
    }
} 
```

这是 Audacity 中的两条轨道（`Console.Write('\a')`上一条，`Console.Beep()`下一条）。

![两声哔哔声](../Images/d9bb82ab9f9ff78c42726aeff255b9e9.png)

在我放大轨道的任何时候，正弦波彼此完全匹配，并且它们具有完全相同的持续时间，所以我必须得出结论，它们实际上是相同的（在 Windows 7 上）。**

# scala - 使用scala读取二维数组

> ID：14798429
> 
> 赞同：0
> 
> 时间：2013-02-10T13:50:39.590
> 
> 标签：scala, functional-programming

假设我有一个名为“input.txt”的txt文件，我想用scala来读入。文件的维度一开始是不可用的。

那么，如何构造这样一个 Array[Array[Float]] 呢？我想要的是一种简单而整洁的方法，而不是像在 Java 中那样编写一些代码来迭代行并解析每个数字。我认为函数式编程应该很擅长......但到目前为止还想不出一个。

最好的祝福

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T14:18:15.183

如果你的输入是正确的，你可以这样做：

```
val source = io.Source.fromFile("input.txt")
val data = source.getLines().map(line => line.split(" ").map(_.toFloat)).toArray
source.close() 
```

**更新**：有关使用`Source`检查[此线程的其他信息](https://groups.google.com/forum/?fromgroups=#!searchin/scala-user/io.Source.fromFile/scala-user/QZ6oje6hSHo/xELVmjBkhaQJ)

# css - Twitter Bootstrap：制作 2x2 网格

> ID：14798430
> 
> 赞同：2
> 
> 时间：2013-02-10T13:50:40.643
> 
> 标签：css, twitter-bootstrap

我有以下内容：

```
<div class="container-fluid">
   <div class="row-fluid">
      <div class="span3"></div>
      <div class="span3"></div>
      <div class="span3"></div>
      <div class="span3"></div>
   </div>
</div> 
```

默认情况下，这个 div.span* 跨越屏幕的整个宽度，如下所示：

```
[x][x][x][x] 
```

在一定的屏幕宽度下，我希望它出现在 2x2 网格中，如下所示：

```
[x][x]
[x][x] 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T13:55:04.947

很抱歉我之前的尝试，我没有完全理解你的问题：

除非您使用自己的 @media 选择器，否则您正在尝试使用引导程序的事情实际上是不可能的。有一个名为[Neat](http://neat.bourbon.io/)的库。我认为这是一个[例子](http://neat.bourbon.io/examples/)您正在寻找

早期的尝试：

* * *

试试这个，从[这里](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)：

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span6">
      <div class="row-fluid">
        <div class="span6">A</div>
        <div class="span6">B</div>
      </div>
      <div class="row-fluid">
        <div class="span6">C</div>
        <div class="span6">D</div>
      </div>
    </div>
  </div>
</div> 
```

这应该会给你以下结果：

```
[A][B] 
[C][D] 
```

那是很多`div`s。不确定这是否可以变得更轻。

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-03T19:01:00.180

最初的问题似乎是针对旧版本的引导程序。

这是在 Bootstrap 3 标记中巧妙地解决问题的方法。关键元素是`clearfix`影响`xs`和`sm`视口的 div [典型用例]。（`sm`不包括在下面的示例中）。

```
<div class="row">
  <div class="col-xs-6 col-sm-3">.col-xs-6 .col-sm-3</div>
  <div class="col-xs-6 col-sm-3">.col-xs-6 .col-sm-3</div>

  <!-- Add the extra clearfix for only the required viewport -->
  <div class="clearfix visible-xs-block"></div>

  <div class="col-xs-6 col-sm-3">.col-xs-6 .col-sm-3</div>
  <div class="col-xs-6 col-sm-3">.col-xs-6 .col-sm-3</div>
</div> 
```

> [通过 getbootstrap.com](http://getbootstrap.com/css/#grid-responsive-resets)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T16:53:51.230

这里有 2 个响应式选项，无需媒体查询。调整窗口大小以查看它们的反应。

CSS 列：

[http://jsfiddle.net/88t4L/](http://jsfiddle.net/88t4L/)

```
.row-fluid {
    columns: 2 8em;
} 
```

在这里，列必须至少为 8em 宽，但如果有空间让所有列出现在一行中，它就会这样做。

[http://caniuse.com/#search=columns](http://caniuse.com/#search=columns)

CSS 弹性盒：

[http://jsfiddle.net/88t4L/1/](http://jsfiddle.net/88t4L/1/)

```
.row-fluid {
    display: flex;
    flex-flow: row wrap;
}

.row-fluid .span3 {
    flex: 1 0 8em; /* grow equally, don't shrink, preferred width of 8em */
} 
```

[http://caniuse.com/#search=flexbox](http://caniuse.com/#search=flexbox)

# winapi - IAT 在自己的进程上挂钩 ExitProcess

> ID：14798433
> 
> 赞同：0
> 
> 时间：2013-02-10T13:51:03.390
> 
> 标签：winapi, hook, portable-executable, thunk, api-hook

我想问一个关于 IAT 挂钩我自己的进程的问题。

我目前正在尝试挂钩 ExitProcess，以便它在任何 ExitProcess 调用之前运行某个函数，并且我面临一些麻烦。

我在运行时遍历 PE，通过 IMAGE_IMPORT_DESCRIPTOR ，在那里找到 kernel32.dll （这是第一个 .dll）之后，我按名称遍历它 THUNK_DATA-s，试图在那里找到 ExitProcess，尽管没有运气。

记录功能，那些是在那里找到的功能 -

```
GetModuleHandleA
GetProcAddress
LoadLibraryA
GetModuleFileNameW
FreeLibrary
VirtualQuery
GetProcessHeap
HeapFree
HeapAlloc
GetSystemTimeAsFileTime
GetCurrentThreadId
GetCurrentProcessId
QueryPerformanceCounter
IsProcessorFeaturePresent
WideCharToMultiByte
MultiByteToWideChar
LoadLibraryW
lstrlenA
LoadLibraryExW
GetLastError
RaiseException
IsDebuggerPresent
DecodePointer
EncodePointer
GetModuleHandleW 
```

尽管 ExitProcess 不在 .

我尝试通过函数指针而不是名称进行枚举（使用 thunkdata 而不是 originalthunkdata），尽管它也失败了。

ExitProcess 的 GetProcAddress 确实在 PE 中返回了一个指针，我尝试通过 loadlibrary 强制加载 kernel32.dll（尽管它应该自动加载），尽管结果是相同的。

可能是什么问题呢 ？

```
HMODULE hMod = GetModuleHandle(NULL);
PIMAGE_DOS_HEADER pImgDosHeaders = (PIMAGE_DOS_HEADER)hMod;
PIMAGE_NT_HEADERS pImgNTHeaders = (PIMAGE_NT_HEADERS)((LPBYTE)pImgDosHeaders + pImgDosHeaders->e_lfanew);
PIMAGE_IMPORT_DESCRIPTOR pImgImportDesc = (PIMAGE_IMPORT_DESCRIPTOR)((LPBYTE)pImgDosHeaders + pImgNTHeaders->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress);
UINT indx = 0;
while(strcmpi((PCHAR)((LPBYTE)pImgDosHeaders + pImgImportDesc[indx].Name), "kernel32.dll")) { ++indx; };
PIMAGE_THUNK_DATA pImgThunkData = (PIMAGE_THUNK_DATA)((LPBYTE)pImgDosHeaders +pImgImportDesc[indx].OriginalFirstThunk);
PIMAGE_IMPORT_BY_NAME pImgImportByName = NULL;
for(;pImgThunkData->u1.Function; ++pImgThunkData)
{
    pImgImportByName = (PIMAGE_IMPORT_BY_NAME)((LPBYTE)pImgDosHeaders + pImgThunkData->u1.AddressOfData);
    !strcmpi("ExitProcess",pImgImportByName->Name) ? cout << "ExitProcess Found" : false;
}
return true; 
```

非常感谢你，祝你有美好的一天！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T06:40:13.537

如果您的应用程序没有`ExitProcess()`静态调用，例如根本没有调用它（甚至没有被您的应用程序的 RTL 调用），或者如果它是通过 动态加载的`GetProcAddress()`，那么它就不会出现在您的应用程序的 IMPORTS 表中。IMPORTS 表仅列出您的应用静态链接到的函数。这可能是您的代码找不到它的原因。使用 PEDUMP 或 DependancyWalker 之类的实用程序来确保您的应用实际上是静态链接到`ExitProcess()`. 例如，在我的开发环境（C++Builder XE2）中，如果我创建了一个控制台项目，`ExitProcess()`则在 IMPORTS 表中找不到，但如果我创建了一个 GUI 项目，则可以找到它。`ExitProcess()`不同之处在于这两种类型的项目在底层使用了不同的 RTL，因此显然控制台 RTL在应用程序终止时不使用。

# php - ffmpeg：转换为 mp4 时出现错误：不支持的编解码器

> ID：14798434
> 
> 赞同：1
> 
> 时间：2013-02-10T13:51:04.653
> 
> 标签：php, ffmpeg

我正在用 php 中最新版本的 ffmpeg 转换视频文件：

```
exec("ffmpeg -y -i capture.wmv capture.mp4 2>&1", $output);
var_dump($output); 
```

这是结果：

```
array(21) {
  [0]=>
  string(99) "FFmpeg version SVN-r0.5.9-4:0.5.9-0ubuntu0.10.04.3, Copyright (c) 2000-2009 Fabrice Bellard, et al."
  [1]=>
  string(451) "  configuration: --extra-version=4:0.5.9-0ubuntu0.10.04.3 --prefix=/usr --enable-avfilter --enable-avfilter-lavf --enable-vdpau --enable-bzlib --enable-libgsm --enable-libschroedinger --enable-libspeex --enable-libtheora --enable-libvorbis --enable-pthreads --enable-zlib --disable-stripping --disable-vhook --enable-runtime-cpudetect --enable-gpl --enable-postproc --enable-swscale --enable-x11grab --enable-libdc1394 --enable-shared --disable-static"
  [2]=>
  string(35) "  libavutil     49.15\. 0 / 49.15\. 0"
  [3]=>
  string(35) "  libavcodec    52.20\. 1 / 52.20\. 1"
  [4]=>
  string(35) "  libavformat   52.31\. 0 / 52.31\. 0"
  [5]=>
  string(35) "  libavdevice   52\. 1\. 0 / 52\. 1\. 0"
  [6]=>
  string(35) "  libavfilter    0\. 4\. 0 /  0\. 4\. 0"
  [7]=>
  string(35) "  libswscale     0\. 7\. 1 /  0\. 7\. 1"
  [8]=>
  string(35) "  libpostproc   51\. 2\. 0 / 51\. 2\. 0"
  [9]=>
  string(43) "  built on Jan 24 2013 19:42:59, gcc: 4.4.3"
  [10]=>
  string(34) "Input #0, asf, from 'capture.wmv':"
  [11]=>
  string(60) "  Duration: 00:04:11.45, start: 3.000000, bitrate: 1755 kb/s"
  [12]=>
  string(62) "    Stream #0.0: Audio: wmav2, 44100 Hz, stereo, s16, 128 kb/s"
  [13]=>
  string(82) "    Stream #0.1: Video: wmv2, yuv420p, 1280x720, 1600 kb/s, 1k tbr, 1k tbn, 1k tbc"
  [14]=>
  string(33) "Output #0, mp4, to 'capture.mp4':"
  [15]=>
  string(83) "    Stream #0.0: Video: mpeg4, yuv420p, 1280x720, q=2-31, 200 kb/s, 90k tbn, 1k tbc"
  [16]=>
  string(62) "    Stream #0.1: Audio: 0x0000, 44100 Hz, stereo, s16, 64 kb/s"
  [17]=>
  string(15) "Stream mapping:"
  [18]=>
  string(21) "  Stream #0.1 -> #0.0"
  [19]=>
  string(21) "  Stream #0.0 -> #0.1"
  [20]=>
  string(40) "Unsupported codec for output stream #0.1"
} 
```

我需要一个标准的 mp4 文件来使用 html5 在 web 中播放。问题可能出在哪里？没有安装codex？还是控制台命令有问题？

编辑：使用静态构建后，我尝试将 wmv 转换为 mp4

```
exec("/www/htdocs/xxxx/video/ffmpeg -y -i capture.wmv capture.mp4 2>&1", $output); 
```

结果文件的大小只有一些字节 - 这是输出：

```
array(40) {
  [0]=>
  string(77) "ffmpeg version N-49805-gfd6a021 Copyright (c) 2000-2013 the FFmpeg developers"
  [1]=>
  string(61) "  built on Feb 11 2013 05:23:18 with gcc 4.6 (Debian 4.6.3-1)"
  [2]=>
  string(609) "  configuration: --prefix=/root/ffmpeg-static/64bit --extra-cflags='-I/root/ffmpeg-static/64bit/include -static' --extra-ldflags='-L/root/ffmpeg-static/64bit/lib -static' --extra-libs='-lxml2 -lexpat -lfreetype' --enable-static --disable-shared --disable-ffserver --disable-doc --enable-bzlib --enable-zlib --enable-postproc --enable-runtime-cpudetect --enable-libx264 --enable-gpl --enable-libtheora --enable-libvorbis --enable-libmp3lame --enable-gray --enable-libass --enable-libfreetype --enable-libopenjpeg --enable-libspeex --enable-libvo-aacenc --enable-libvo-amrwbenc --enable-version3 --enable-libvpx"
  [3]=>
  string(40) "  libavutil      52\. 17.101 / 52\. 17.101"
  [4]=>
  string(40) "  libavcodec     54\. 91.102 / 54\. 91.102"
  [5]=>
  string(40) "  libavformat    54\. 62.100 / 54\. 62.100"
  [6]=>
  string(40) "  libavdevice    54\.  3.103 / 54\.  3.103"
  [7]=>
  string(40) "  libavfilter     3\. 37.101 /  3\. 37.101"
  [8]=>
  string(40) "  libswscale      2\.  2.100 /  2\.  2.100"
  [9]=>
  string(40) "  libswresample   0\. 17.102 /  0\. 17.102"
  [10]=>
  string(40) "  libpostproc    52\.  2.100 / 52\.  2.100"
  [11]=>
  string(54) "Guessed Channel Layout for  Input Stream #0.0 : stereo"
  [12]=>
  string(34) "Input #0, asf, from 'capture.wmv':"
  [13]=>
  string(11) "  Metadata:"
  [14]=>
  string(32) "    WMFSDKNeeded    : 0.0.0.0000"
  [15]=>
  string(32) "    DeviceConformanceTemplate: @"
  [16]=>
  string(37) "    WMFSDKVersion   : 12.0.7601.17514"
  [17]=>
  string(23) "    IsVBR           : 0"
  [18]=>
  string(60) "  Duration: 00:04:13.40, start: 0.000000, bitrate: 1742 kb/s"
  [19]=>
  string(90) "    Stream #0:0(ger): Audio: wmav2 (a[1][0][0] / 0x0161), 44100 Hz, stereo, fltp, 128 kb/s"
  [20]=>
  string(125) "    Stream #0:1(ger): Video: wmv2 (WMV2 / 0x32564D57), yuv420p, 1280x720, 1600 kb/s, SAR 1:1 DAR 16:9, 1k tbr, 1k tbn, 1k tbc"
  [21]=>
  string(35) "[libx264 @ 0x2f082e0] using SAR=1/1"
  [22]=>
  string(63) "[libx264 @ 0x2f082e0] MB rate (3600000) > level limit (2073600)"
  [23]=>
  string(88) "[libx264 @ 0x2f082e0] using cpu capabilities: MMX2 SSE2Fast SSSE3 FastShuffle SSE4.2 AVX"
  [24]=>
  string(45) "[libx264 @ 0x2f082e0] profile High, level 5.2"
  [25]=>
  string(684) "[libx264 @ 0x2f082e0] 264 - core 129 r2230 1cffe9f - H.264/MPEG-4 AVC codec - Copyleft 2003-2012 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=6 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00"
  [26]=>
  string(33) "Output #0, mp4, to 'capture.mp4':"
  [27]=>
  string(11) "  Metadata:"
  [28]=>
  string(32) "    WMFSDKNeeded    : 0.0.0.0000"
  [29]=>
  string(32) "    DeviceConformanceTemplate: @"
  [30]=>
  string(37) "    WMFSDKVersion   : 12.0.7601.17514"
  [31]=>
  string(23) "    IsVBR           : 0"
  [32]=>
  string(35) "    encoder         : Lavf54.62.100"
  [33]=>
  string(122) "    Stream #0:0(ger): Video: h264 ([33][0][0][0] / 0x0021), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], q=-1--1, 16k tbn, 1k tbc"
  [34]=>
  string(90) "    Stream #0:1(ger): Audio: aac ([64][0][0][0] / 0x0040), 44100 Hz, stereo, s16, 128 kb/s"
  [35]=>
  string(15) "Stream mapping:"
  [36]=>
  string(39) "  Stream #0:1 -> #0:0 (wmv2 -> libx264)"
  [37]=>
  string(45) "  Stream #0:0 -> #0:1 (wmav2 -> libvo_aacenc)"
  [38]=>
  string(31) "Press [q] to stop, [?] for help"
  [39]=>
  string(96) "frame=  158 fps=0.0 q=33.0 size=       0kB time=00:00:00.10 bitrate=   3.6kbits/s dup=155 drop=0"
} 
```

slhck - 感谢您的提示 - 您看到问题了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T14:10:27.903

您的 FFmpeg 版本是 0.5.9，它来自于 2009 年被削减的分支（！）。问题可能是由于旧版本造成的，尝试对完全不受支持的问题进行故障排除是没有意义的。据我所知，FFmpeg 找不到合适的音频编解码器来编码视频。您也没有任何外部 AAC 或 MP3 编码器。

无论如何：**安装更新的版本。**通过[自己编译](https://ffmpeg.org/trac/ffmpeg/wiki/UbuntuCompilationGuide)或[下载静态构建](http://ffmpeg.org/download.html)来做到这一点。

* * *

要制作支持 HTML5 的 MP4 视频，您可能会明确选择具有 Baseline 配置文件（以适应移动设备）和 AAC 音频的 H.264 编码视频：

```
ffmpeg -i capture.wmv -c:v libx264 -profile:v baseline -c:a aac -strict experimental -b:a 192k out.mp4 
```

要更改视频质量，请添加`-crf`选项，其值介于 18–28 之间（默认值为 23）。较低意味着更好的质量。有关详细信息，请参阅FFmpeg Wiki 上的[x264 编码指南。](http://ffmpeg.org/trac/ffmpeg/wiki/x264EncodingGuide)

您的视频应在文件开头包含 MOOV atom，这将允许您的用户立即开始流式传输内容（否则他们必须下载整个文件）。您可以在编码时设置：

```
ffmpeg -i [上面的东西…] -movflags faststart out.mp4

```

* * *

如果你有支持 FAAC 的 FFmpeg（用 勾选`ffmpeg -codecs | grep libfaac`），你也可以使用下面的，类似于上面的：

```
ffmpeg -i -c:v libx264 -profile:v baseline -c:a libfaac -q:a 100 out.mp4 
```

在这里，您将获得质量更好的 VBR AAC 音频，而不是上面的固定比特率流。质量以百分比表示，默认值为 100。

# javascript - 这是使用 jQuery 解析 XML 的错误吗？

> ID：14798449
> 
> 赞同：3
> 
> 时间：2013-02-10T13:52:10.440
> 
> 标签：javascript, jquery, xml

好的，我会尽量简单地解释这一点；

我正在尝试使用 jQuery 解析通过 Web 服务获得的 XML。一切都在按应有的方式进行，直到我注意到看在上帝的份上，我无法解析名为“图像”的节点。长话短说（2 小时后）我注意到，问题出在标签名上。显然，“图像”是保留字或类似的东西？？？

这是一个演示；首先，我模拟了具有“图像”节点且不会显示任何结果的 xml。其次，我模拟了相同的 xml，相同的解析，我只是将“image”重命名为“image1”，它可以工作。请参阅此处的示例：http: [//jsbin.com/evinah/1/edit](http://jsbin.com/evinah/1/edit)

所以，显然我无法更改网络服务，它不在我的域中。如何使用 jQuery 获取“图像”值？

感谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:21:39.910

其他答案中已经提到了如何解决这个问题，但我认为解释`image`标签的“错误”是很重要的。

当您将 XML 字符串传递给 jQuery 时，它将使用浏览器的原生 DOM 方法来解析 XML。这些 DOM 方法主要用于解析和处理 HTML。

让我们看看创建`root`元素时会发生什么：

```
> var e = document.createElement('root');
  <root></root> 
```

`console.log(e)`列出了一堆属性，但最重要的是，这个元素继承自`HTMLUnknownElement`，这是有道理的。

现在让我们创建一个`image`元素：

```
> var e = document.createElement('image');
  <img> 
```

呃？在哪里`<image></image>`？原来那[`image`是`img`](https://stackoverflow.com/questions/11928566/img-vs-image-tag-in-html). 新元素继承自`HTMLImageElement`.

您现在可能认为您可以这样做`.children('img').text()`，但这不起作用，因为`img`元素不能有后代。浏览器生成的结果结构是：

```
<root>
    <item>
        <img>
        image link
    </item>
    <item>
        <img>
        image link2
    </item>
</root> 
```

文本节点是`img`元素的兄弟姐妹，而不是后代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T13:56:48.703

该`$`函数不用于解析 XML。您必须使用`$.parseXML`，然后将其包装在一个 jQuery 对象中：`$($.parseXML(...))`. 其实对于 HTML 也有专门的功能`$.parseHTML`。使用字符串调用的`$`函数应该与选择器或简单`"<tag>"`字符串一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T13:57:42.523

如果你正在处理一个字符串，你应该使用[`$.parseXML`](http://api.jquery.com/jQuery.parseXML/)它，这将返回一个可以与 jQuery 一起使用的有效的 XML 文档。

```
$($.parseXML(xml)).find('item').each(function(i, e){
  alert($(e).children('image').text());
}); 
```

[（看这里。）](http://jsfiddle.net/tphWe/)

如果您使用的是 AJAX，那么您应该将`dataType`选项设置为`xml`.

* * *

`$(xml)`部分工作而不使用`$.parseXML`except 的主要原因`<image>`，是因为在 DOM 构建过程中`<image>`元素被转译为元素。`<img>`最重要的是，`<img>`是一个空元素，不会包含任何破坏 XML 结构的子文本元素。

有关历史用法的更多信息，`<img>`请`<image>`参阅 HTML 中的[`<img>`vs`<image>`标签](https://stackoverflow.com/q/11928566/417685)。

# c++ - TImage宽度/高度锚不起作用

> ID：14798454
> 
> 赞同：0
> 
> 时间：2013-02-10T13:53:12.713
> 
> 标签：c++, c++builder, vcl, timage

我有一个 TForm 有一个事件`FormResize`，在那个函数中我想在我的 TImage 中绘制一些东西。

我的 FormResize 函数如下所示

```
void __fastcall TForm1::FormResize(TObject *Sender)
{
    // Teken de blokjes
    _viewPort->draw(_viewPortImage->Canvas, _viewPortImage->Width, _viewPortImage->Height);
} 
```

在这个函数中，我只绘制一个绘制边框的矩形：

```
ViewPort::draw(Vcl::Graphics::TCanvas* Canvas, int width, int height)
{
    Canvas->Rectangle(0, 0, width, height);
} 
```

现在的问题。当我使表单小于原始表单时，它可以很好地缩放。但是当表格变得比原始尺寸大时。背景+边框画得不好。请参阅下面的屏幕截图。白色背景/画布来自 TImage。TImage 在所有 4 个方向上都锚定。

任何人都知道如何使图像能够调整更大？

![截图原图更小更大](../Images/fe9c557f16c8af0d673bf0adf4e27ccc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T23:20:04.537

使用 a`TPaintBox`代替 a`TImage`并在`TPaintBox::OnPaint`活动中进行绘图。然后你就不需要再使用这个`TForm::OnResize`事件了。

```
void __fastcall TForm1::ViewPortPaintBoxPaint(TObject *Sender)
{
    // Teken de blokjes
    _viewPort->draw(ViewPortPaintBox->Canvas, ViewPortPaintBox->ClientWidth, ViewPortPaintBox->ClientHeight);
} 
```

# java - 避免在 Null 布局中重叠组件

> ID：14798457
> 
> 赞同：0
> 
> 时间：2013-02-10T13:53:48.663
> 
> 标签：java, layout

我在扩展的类中有一个空布局，`JComponent`以便我可以在我想要的坐标处添加组件。但我也不希望某些组件重叠。任何想法，我怎样才能实现这个目标？通过使用任何其他布局？其实我想要的一些功能`FlowLayout`。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:16:28.593

您可能需要实现自己的布局管理器，例如：

```
public class NonOverlappingLayout implements LayoutManager
{
    @Override
    public void addLayoutComponent (String name, Component comp)
    {
        // Do nothing
    }

    @Override
    public void removeLayoutComponent (Component comp)
    {
        // Do nothing
    }

    @Override
    public Dimension preferredLayoutSize (Container parent)
    {
        int count = parent.getComponentCount ();
        Rectangle [] r = new Rectangle [count];

        for (int i = 0; i < count; i++)
        {
            Component c = parent.getComponent (i);
            if (c.isVisible ())
                r [i] = c.getBounds ();
            else r [i] = new Rectangle (0, 0, 0, 0);
        }

        r = doLayout (r);

        Rectangle result = new Rectangle (0, 0, 0, 0);
        for (int i = 0; i < count; i++)
        {
            result = result.union (r [i]);
        }

        return result.getSize ();
    }

    @Override
    public Dimension minimumLayoutSize (Container parent)
    {
        return preferredLayoutSize (parent);
    }

    @Override
    public void layoutContainer (Container parent)
    {
        int count = parent.getComponentCount ();
        Rectangle [] r = new Rectangle [count];

        for (int i = 0; i < count; i++)
        {
            Component c = parent.getComponent (i);
            if (c.isVisible ())
                r [i] = c.getBounds ();
            else r [i] = new Rectangle (0, 0, 0, 0);
        }

        r = doLayout (r);

        int minX = 0;
        int minY = 0;
        for (int i = 0; i < count; i++)
        {
            minX = Math.min (minX, r [i].x);
            minY = Math.min (minY, r [i].y);
        }

        for (int i = 0; i < count; i++)
        {
            r [i].translate (-minX, -minY);
            Component c = parent.getComponent (i);
            if (c.isVisible ())
                c.setBounds (r [i]);
        }
    }

    public Rectangle [] doLayout (Rectangle [] initialPositions)
    {
        int count = initialPositions.length;
        Rectangle [] result = new Rectangle [count];
        for (int i = 0; i < count; i++)
            result [i] = new Rectangle (initialPositions [i]);

        boolean intersection;

        do
        {
            intersection = false;

            for (int i = 0; i < count; i++)
            {
                int xf = 0;
                int yf = 0;

                Rectangle r1 = result [i];

                for (int j = 0; j < count; j++)
                {
                    Rectangle r2 = result [j];

                    if (i != j && r1.intersects (r2))
                    {
                        if (r1.x * 2 + r1.width < r2.x * 2 + r2.width)
                            xf -= 1;
                        else
                            xf += 1;

                        if (r1.y * 2 + r1.height < r2.y * 2 + r2.height)
                            yf -= 1;
                        else
                            yf += 1;

                        intersection = true;
                    }
                }

                if (xf > 0) result [i].x += 1;
                else if (xf < 0) result [i].x -= 1;

                if (yf > 0) result [i].y += 1;
                else if (yf < 0) result [i].y -= 1;
            }
        } while (intersection);

        return result;
    }

    public static void main (String [] args)
    {
        JFrame frame = new JFrame ();
        frame.setDefaultCloseOperation (JFrame.EXIT_ON_CLOSE);
        frame.getContentPane ().setLayout (new NonOverlappingLayout ());

        Random r = new Random ();
        for (int i = 0; i < 100; i++)
        {
            JButton b = new JButton ();
            b.setBounds (r.nextInt (780), r.nextInt (580), 20, 20);
            frame.getContentPane ().add (b);
        }
        frame.getContentPane ();

        frame.pack ();
        frame.setVisible (true);
    }
} 
```

# javascript - 将 KineticJS 与 box2dweb 一起使用

> ID：14798461
> 
> 赞同：3
> 
> 时间：2013-02-10T13:54:17.963
> 
> 标签：javascript, html, kineticjs, box2dweb

如何将 kineticJS 与 box2dweb 一起使用，以便可以进行碰撞检测？就像，我怎样才能在通过 kineticJS 渲染的图像周围放置一个圆形边界并通过 box2dweb 应用物理？

有没有关于这个的好教程或任何可以帮助我的代码？或者有什么有效的方法可以用 kineticJS 本身进行碰撞检测？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-10T17:05:30.153

你要做的是：

1.  建立一个box2d“世界”——把世界想象成地球（或任何其他星球）上的一个房间

2.  将“物体”添加到世界中——物体是移动或静止的物体，它们的行为取决于您分配给它们的物理特性。

3.  对于每个 box2d 主体，分配一个 kineticJs“皮肤”——皮肤是由 kineticJs 在画布上绘制的“漂亮”的 kineticJs 形状对象。例如，在游戏中，皮肤可能是足球。

4.  让 box2d 世界运动并监听 box2d 的“tick”事件——当 box2d 计算出在您指定的时间长度内发生的物理现象时，就会触发 tick 事件。此时 box2d 知道了 box2d 世界中每个 box2d 主体的位置和旋转。

5.  在 box2d tick 事件中，检查每个 box2d body 的位置/旋转，并在 box2dbody 的相同位置/旋转处绘制 kineticJs 皮肤。

有一个很好的例子：[http ://www.luxanimals.com/blog/article/combining_easel_box2d](http://www.luxanimals.com/blog/article/combining_easel_box2d)

此示例使用画架在画布上绘图，但转换为 kineticJs 库非常简单——应用*完全相同的*概念。

[编辑以提供更多信息]

此外，如果您不需要 box2d 中的所有物理，这里有一个非常简单的使用 kineticJs 的 2 圆碰撞测试。

```
function CirclesAreColliding(circle1,circle2){
    var dx = circle2.getX() - circle1.getX();
    var dy = circle2.getY() - circle1.getY();
    if( Math.sqrt( dx*dx + dy*dy ) <= ( circle1.getRadius() + circle2.getRadius() ) {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-19T19:49:55.490

这是一个关于它的教程。祝你好运 [http://www.codeproject.com/Articles/571743/Box2D-and-JavaScript-Part-3](http://www.codeproject.com/Articles/571743/Box2D-and-JavaScript-Part-3)

# excel - EXCEL 应用程序更新事件

> ID：14798465
> 
> 赞同：0
> 
> 时间：2013-02-10T13:54:38.710
> 
> 标签：excel, vba, rtd

我的工作表中的大多数单元格每秒接收一次 RTD 数据，并且在刷新数据时会进行大量计算。它变得非常缓慢。如果我将 Application.ScreenUpdating 设置为 false，是否意味着即使屏幕上没有刷新最新数据，但仍会使用最新值计算函数？

例如，我有单元格 C1:C300，它每秒更新一次。另一列 D1:D300 使用 C1:C300 中的值来计算一些公式。现在，如果我将 Application.ScreenUpdating 设置为 false 但将计算模式设置为自动，我会加快速度而不引起任何问题吗？我的意思是，我无法从屏幕上判断 D1:D300 中的计算是否使用 C 中的新数据计算？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T18:04:25.237

Application.ScreenUpdating=false 不影响自动计算，所以没关系。但是当您的 VBA 退出到 Excel 时，Application.screenUpdating 会自动重新打开。
因此，从 VBA 控制计算和屏幕更新可能会更好

# android - 通过android代码连接到wifi时出现身份验证错误

> ID：14798480
> 
> 赞同：2
> 
> 时间：2013-02-10T13:55:53.990
> 
> 标签：android, android-wifi, wifi

我正在尝试通过编写一个简单的 android 应用程序来连接到我的 WIFI。它启用了 wifi。但是当我在手机的设置中看到那个 n/w 时，我遇到了身份验证错误。我的代码是

```
WifiConfiguration wc = new WifiConfiguration();

wc.SSID = "\"Network_SSID\"";
        wc.hiddenSSID = true;
        wc.status = WifiConfiguration.Status.DISABLED;     
        wc.priority = 40;
        wc.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);
        wc.allowedProtocols.set(WifiConfiguration.Protocol.RSN); 
        wc.allowedProtocols.set(WifiConfiguration.Protocol.WPA);
        wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.OPEN);
        wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.SHARED);
        wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.CCMP);
        wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.TKIP);
        wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.WEP40);
        wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.WEP104);

        wc.wepKeys[0] = "\"8447657855\""; //This is the WEP Password
        wc.wepTxKeyIndex = 0; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T14:37:41.580

```
 if (Type == 1) // WIFICIPHER_NOPASS
    {
        config.hiddenSSID = true;
        config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);
    }

    if (Type == 2) // WIFICIPHER_WEP
    {
        config.hiddenSSID = true;
        config.wepKeys[0] = "\"" + Password + "\"";
        config.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.WEP40);
        config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);
        config.wepTxKeyIndex = 0;
    }

    if (Type == 3) // WIFICIPHER_WPA
    {
        config.preSharedKey = "\"" + Password + "\"";
        config.hiddenSSID = true;
    } 
```

# asp.net-mvc - 部分视图中的@Section

> ID：14798487
> 
> 赞同：0
> 
> 时间：2013-02-10T13:56:35.963
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我试图在局部视图中使用@section 将脚本放置在布局的指定部分。但它不起作用。

**_Layout.cshtml**

```
<!DOCTYPE html>
<html lang="en">
<head>
@RenderSection("PageSpecificCSSFiles", false)
</head>
<body>
<div>@RenderBody()</div>
 <script src="@Url.Content("~/Scripts/jquery-1.8.2.min.js")"></script>
<script src="@Url.Content("~/Scripts/jquery-ui.js")"></script>
@RenderSection("PageSpecificJSFiles", false)
@RenderSection("PageSpecificJSScript", false)
</body> 
```

**详细页面.cshtml**

```
@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div id="tabs">
 @{ Html.RenderPartial("BasicDetails");}
</div> 
```

**局部视图 BasicDetails.cshtml**

```
<input id="dob" name="DateOfBirth" value="" />
@section PageSpecificJSScript{

<script type="text/javascript">

$(document).ready(function(){
   $('#dob').datepicker();
});

</script>

} 
```

日期选择器尚未配置，因为 @section 不工作。

***谁能告诉如何在局部视图中实现这一目标？我们如何将部分视图中的脚本强制进入布局的特定部分？***

> **注意：**为了提高性能，我在底部添加了 JS 文件。我不喜欢将它移到页面顶部。

# c - run func() based on what time it is

> ID：14798497
> 
> 赞同：0
> 
> 时间：2013-02-10T13:58:29.073
> 
> 标签：c, timer

i wrote some code that monitors a directory DIR with **inotify()** and when a file gets moved in DIR i get a .txt output of that file(its an nfcapd file with flows of my network interface). This happens every 5 minutes.

After that, i used Snort's DPX starter kit, with which you can extend Snort by writing your own preprocessor. This preprocessor,like all the others, is just a function that's executed every time a new packet is available. My problem is that i want, when a new file gets exported from my previous code(so every 5 minutes), to read that file inside the preprocessor's function.

So, is there any way of getting the time and executing only if it's the desired time?

```
if (time is 15:36){
    func(output.txt);} 
```

i'm writing in c.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:05:35.147

您可以执行以下操作：

```
#include <time.h>
...

time_t t = time(NULL); //obtain current time in seconds
struct tm broken_time;
localtime_r(&t, &broken_time); // split time into fields

if(broken_time.tm_hour == 15 && broken_time.tm_min == 36) { //perform the check
    func(output.txt);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T15:17:27.913

由于您使用的是`inotify`，我假设您的环境支持 POSIX 信号。

您可以使用[`alarm()`](http://pubs.opengroup.org/onlinepubs/009695399/functions/alarm.html)在经过预定时间后发出信号，并让[适当的信号处理程序](http://pubs.opengroup.org/onlinepubs/7908799/xsh/sigaction.html)执行您需要执行的任何工作。它将避免我认为最终会在您的代码中成为一个非常丑陋的无限循环。

所以，在你的情况下，函数处理`SIGALRM`不需要担心它是什么时间，它会知道预定的时间已经过去了，因为它被输入了。但是，您需要提供一些函数可以访问的上下文以知道*要做什么*，在没有看到您的代码的情况下很难建议如何操作。

我不完全确定您是否走在正确的道路上，但是`alarm()`鉴于您所描述的，使用可能是最明智的方法。

# iphone - iOS - 使用属性文本自动收缩 UILabel

> ID：14798500
> 
> 赞同：10
> 
> 时间：2013-02-10T13:59:14.300
> 
> 标签：iphone, ios, xcode, cocoa-touch, nsattributedstring

我有`UILabel`其中包含由新行分隔的两个属性字符串。`NSMutableAttributedString`第一个字符串的字体大小设置为 17，第二个字符串的字体大小设置为 14。如果其内容不能放在一行中，我希望将第一个字符串的大小调整为最小字体大小。

那可能吗？

通过在 IB 中为纯文本设置“自动缩小到最小字体大小”来配置此类行为非常简单`UILabel`，但不知道如何为属性文本执行此操作。

这是我的代码：

```
NSString *eventName = @"Looong Event Name";
NSString *placeString = @"My place";

eventName = [eventName stringByAppendingString:@"\n"];        
NSMutableAttributedString *attrName = [[NSMutableAttributedString alloc] initWithString:eventName];
[attrName addAttribute:NSFontAttributeName value:[UIFont boldSystemFontOfSize:17] range:NSMakeRange(0, [eventName length])];

 NSMutableAttributedString *attrPlace = [[NSMutableAttributedString alloc] initWithString:placeString];
 [attrPlace addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:14] range:NSMakeRange(0, placeString.length)];
 [attrPlace addAttribute:NSForegroundColorAttributeName value:[UIColor grayColor] range:NSMakeRange(0, placeString.length)];

  NSMutableAttributedString *finalString = [[NSMutableAttributedString alloc] initWithAttributedString:attrName];
  [finalString appendAttributedString:attrPlace];

  UILabel *nameLabel = (UILabel *)[cell viewWithTag:100];

  nameLabel.attributedText = finalString; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:15:49.210

我想这是您[之前问题](https://stackoverflow.com/questions/14791831/auto-layout-uilabels)的后续。

我认为您不能自动执行此操作，但是有一种[`size`](http://developer.apple.com/library/ios/documentation/uikit/reference/NSAttributedString_UIKit_Additions/Reference/Reference.html#//apple_ref/occ/instm/NSAttributedString/size)NSAttributedString 方法，您可以使用它来检查您的字符串是否太大，并在需要时自行调整。

# opencv - Fastest way to get frames from webcam

> ID：14798504
> 
> 赞同：4
> 
> 时间：2013-02-10T13:59:24.333
> 
> 标签：opencv, webcam

I have a little wee of a problem developing one of my programs in C++ (Visual studio) - Right now im struggling with connection of multiple webcams (connected via usb cables), creating for each of them separate thread to capture frames, and separate frame for processing image.

I use OpenCV to process frames, but the problem is that i dont get a peak of webcam possibilities (it supports 25 fps, i get only 18) is there some library that i could use to get frames, than process them with OpenCV that would made frames be captured faster?

I was researching a bit and the most popular way is to use directshow to get frames and OpenCV to process them.

Do You agree? Or do You have another solution? I wouldn't be offended by some links :)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T15:16:20.763

1.  仅当您使用 CV_CAP_DSHOW 标志打开捕获时才使用 DirectShow，例如：

    ```
    VideoCapture capture( CV_CAP_DSHOW + 0 );  // 0,1,2, your cam id there 
    ```

    （没有它，它默认为 vfw ）

2.  捕获已经在单独的线程中运行，因此用更多线程包装它不会给您任何收益。

3.  多个摄像头的另一个障碍是 USB 带宽，因此，如果您的机器背面和前面有端口，请不要将所有摄像头插入同一个端口/控制器，否则您只会将其饱和

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T14:04:25.903

OpenCV uses DirectShow. Using DirectShow (primary video capture API in Windows) directly will obviously get you par or better performance (and even more likely so if OpenCV is set to use Video for Windows). USB cams typically hit USB bandwidth and hence frame rate limit, using DirectShow to capture in compressed formats or in formats with less bits/pixel is the way to reach higher frame rates within the same USB bandwidth limit.

Another typical problem causing low frame rates is slow synchronous processing delaying the capture. You typically identify this by putting trivial processing into the same capture loop and seeing higher FPS compared to processing-enabled operation.

# c# - ProviderUserKey 返回错误的密钥

> ID：14798507
> 
> 赞同：1
> 
> 时间：2013-02-10T13:59:49.780
> 
> 标签：c#, asp.net, oracle11g, asp.net-membership

我正在尝试以下代码

aspx：

```
Username: <br />
<asp:TextBox runat="server" ID="txtUserName"></asp:TextBox>
<br />
Password: <br />
<asp:TextBox runat="server" ID="txtPassword" TextMode="Password"></asp:TextBox>
<br />
<asp:Button runat="server" ID="btnLogin" Text="Login" onclick="btnLogin_Click"/> 
```

后面的代码：

```
protected void btnLogin_Click(object sender, EventArgs e)
{
    if(!string.IsNullOrEmpty(txtUserName.Text.Trim()) && !string.IsNullOrEmpty(txtPassword.Text.Trim()))
    {
        string username = txtUserName.Text.Trim();
        string password = txtPassword.Text.Trim();
        if (Membership.ValidateUser(username, password))
        {
            MembershipUser user = Membership.GetUser(username);
            string userid = user.ProviderUserKey.ToString();
        }
 } 
```

我在 userid 中获得的值与我在数据库中获得的值不同。我究竟做错了什么。我试过`MembershipUser user = Membership.GetUser()`了，但它返回 null

注意：我正在使用配置了 asp.net 成员资格的 Oracle。

**编辑：** 数据库中的用户 ID：161863BC7C244AADBF27F5F6250AF99C

用户 ID var 中的用户 ID：bc631816-247c-ad4a-bf27-f5f6250af99c

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:35:54.317

正如我在评论中提到的，似乎`Oracle`是以不同的顺序存储用户 guid。如果您真的想在数据库中获得相同的 guid，则需要一种解决方法。检查[此代码项目文章](http://www.codeproject.com/Tips/247677/Oracle-ASP-Net-membership-provider-ProviderUserKey)。作者使用了一种方法来翻译 guid ：

```
public static string TranslateOraceEndianUserID() 
    { 
        MembershipUser myObject = Membership.GetUser(); 
        Guid g = new Guid(myObject.ProviderUserKey.ToString()); 
        byte[] b = g.ToByteArray(); 
        string UserID = BitConverter.ToString(b, 0).Replace("-", string.Empty); 
        return UserID; 
    } 
```

虽然这是未经测试的。作者说

> 创建了以下方法，为我解决了这个问题

# python - Including python modules for PyInstaller?

> ID：14798508
> 
> 赞同：2
> 
> 时间：2013-02-10T13:59:59.663
> 
> 标签：python, scipy, pyinstaller

In one of my first attempts to package my python code into a .exe file, I experience issues with packaging and running code using the `scipy.weave` module. When I check my warnproject.txt, I see 1324 lines of warnings (a couple of lines included below)

```
W: no module named numpy.negative (top-level import by scipy.weave.size_check)
W: no module named numpy.asarray (top-level import by scipy.optimize.nonlin)
W: no module named termios (top-level import by tty)
W: no module named scipy.arange (conditional import by scipy.sparse.linalg.isolve.minres)
W: no module named numpy.polyder (top-level import by scipy.signal.signaltools)
W: no module named matplotlib.rcParams (top-level import by matplotlib.figure)
etc... 
```

First question: why do I get this many warnings whereas the program partially runs ok?

Second question: how do I import these modules in a correct manner? In my `project.spec` file I have written `exe = EXE(..., a.binaries + [('scipy.weave', 'C:\Python27\Lib\site-packages', 'PYMODULE')], ...)` but it can't find the module and will not package any file?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:14:43.877

一种方法是对 Analysis 对象使用[hooks](http://www.pyinstaller.org/export/v2.0/project/doc/Manual.html?format=raw#listing-hidden-imports)选项。这迫使分析（编译依赖项列表的人）考虑来自钩子的模块已被导入，因此是必需的。

```
a = Analysis(['myscript.py'], hookspath='/my/priv/hooks') 
```

[**挂钩**](http://www.pyinstaller.org/export/v2.0/project/doc/Manual.html?format=raw#listing-hidden-imports)文件是简单的文本文件。

另一方面，我有很多这样的警告，我的应用程序在 linux 和 windows 上运行，没有导入相关的问题。

# wordpress - how can i configure tinymce to insert spans into list tags

> ID：14798510
> 
> 赞同：1
> 
> 时间：2013-02-10T14:00:23.850
> 
> 标签：wordpress, tinymce, html-lists, html

I am using the tinyMCE in wordpress and I would like to alter the numbered list html so that when the editors create the lists using the button in between each li, a span is also added.

## Current

```
<ol>
<li>this</li>
<li>is</li>
<li>current</li>
</ol> 
```

## Required

```
<ol>
<li><span class="test">this</span></li>
<li><span class="test">is </span></li>
<li><span class="test">what i want </span></li>
</ol> 
```

my preference is to make the span the default when clicking on numlist button, but if it is easy to make a custom button to achieve this that advice would be very welcome too.

Many thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T12:15:30.330

AFAIK，这是不可能的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-05T18:14:02.637

万一其他人有兴趣，我确实实现了结果，但不是通过修改tinymce编辑器，因为tinymce自定义按钮路线不是我有时间追求的。

因此，我在离开数据库的过程中操纵了“内容”，并做了一些简单的正则表达式 preg__replace 和 str_replace 工作，最终得到了我需要的东西。

所以内容管理器现在只是创建一个无序列表并在开始时自己添加数字。然后我们循环并在内容和数字周围添加 span 和 p 标签。这意味着内容可以设计得很漂亮！不是一个理想的解决方案，但它现在可以工作。

例如 $content = "1.帮我做这个"

```
 $content = str_replace("<li>","<li><p>",$content);
    $content = str_replace("</li>","</p></li>",$content);
    $pattern = "/(<p>?)+([0-9]{1,}\.?)/";
    echo preg_replace($pattern,"<span>$2</span> $1",$content); 
```

# iphone - UITableView自定义单元格滚动后消失的内容

> ID：14798516
> 
> 赞同：7
> 
> 时间：2013-02-10T14:01:13.033
> 
> 标签：iphone, xcode, uitableview

我在这里多次看到这个问题，但没有一个解决方案对我有用。这是我的代码片段：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellClassName = @"DemoTableViewCell_sched";
    DemoTableViewCell_sched *cell = [tableView dequeueReusableCellWithIdentifier:CellClassName];

    if (cell == nil)
    {
        NSArray *topLevelItems = [cellLoader instantiateWithOwner:self options:nil];
        cell = [topLevelItems objectAtIndex:0];
    }
    cell.fooData = [self.bugs objectAtIndex:indexPath.row];    
    return cell;
} 
```

然后我有`ViewDidLoad`

```
 cellLoader = [UINib nibWithNibName:@"DemoTableViewCell_sched" bundle:[NSBundle mainBundle]]; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-06-28T02:15:39.840

就我而言，发生的事情是我没有保留指向 tableview 数据源的强指针。因此，当滚动 tableview 时，数据源已经被释放并设置为 nil，这导致 tableview 的 numRowsForSection 为 0，而 cellForRowAtIndexPath 为 nils。

如果有人有类似的问题，您可能会查看您的数据源和/或自定义对象是否正确保留。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-03-16T13:35:59.700

您是否将 UITableViewcontroller 添加为 addSubView ？那么你应该这样做：

```
1) addChildViewController,then
2) addSubview
The problem is delegate and datasource of the tableview getting nil since the parent controller unable to a reference to the UITableViewController. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-19T16:10:32.000

就我而言，问题如下：

1.  我有一个特殊情况，视图控制器的视图没有被推送或以模态方式呈现，但我已将其作为子视图 (view.addSubview) 添加到另一个视图。

2.  这样，实际视图由其父视图保留，但 ViewController 对象（它是表视图的 DataSource）没有保留并且内存不足。

3.  我必须将视图控制器分配给一个（强）变量，以便它留在内存中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-10T17:10:03.823

当以下任一情况出现时，问题就消失了：

1.  表格视图包含许多单元格（10+），

2.  每个单元格的高度超过 50。

奇怪的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-26T20:21:34.750

我知道这个问题已经有了答案，但只针对谷歌人：

在我的情况下，问题是视图仍在，`UITableViewCell`但由于`frame`视图属性错误而滚动后，它们进入下一个`UITableViewCell`，我看不到它们。

我认为正如公认的答案已经明确表示：

> 当以下任一情况出现时，问题就消失了：
> 
> *   表格视图包含许多单元格（10+），
>     
>     
> *   每个单元格的高度超过 50。

他和我有类似的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-28T10:04:37.540

确保您已实现 heightForRowAtIndexPath 委托方法，并确保您的约束设置正确。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-21T06:41:12.653

就我而言，因为我已经覆盖了这个函数：

```
- (void)setFrame:(CGRect)frame
{
//    frame.origin.y += 10;
//    frame.size.height -= 10;
    [super setFrame:frame];
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-03T12:07:14.673

我有好几次类似的问题。这是非常令人不安的，因为它可能是任何东西。从错误的布局约束到严重的问题。在第一种情况下：在*UITableViewCell*我有

```
contentView.translatesAutoresizingMaskIntoConstraints = false 
```

删除此行后，everytnig 恢复正常。

在几秒钟的情况下：我以编程方式设置了错误的布局约束：

```
stackView.topAnchor.constraint(equalTo: contentView.bottomAnchor, constant: 16) 
```

堆栈元素应该设置为顶部，而不是底部。修好这条线后一切正常。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-02-11T05:23:30.883

您需要根据其内容计算每个单元格的正确高度。

这可以在 UITableView 委托方法中完成：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
       CGFloat height;
       //Calculate height for each cell
       return height;
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-04-27T19:13:51.913

TableView 中的这种行为让我大吃一惊。原来我用过

```
@property (weak, nonatomic) NSMutableArray *itemsArray; 
```

代替

```
@property (strong, nonatomic) NSMutableArray *itemsArray; 
```

希望这些信息有所帮助。

# entity-framework - 动态更改 ProxyCreationEnabled

> ID：14798517
> 
> 赞同：1
> 
> 时间：2013-02-10T14:01:13.750
> 
> 标签：entity-framework

好吗？如果我将在 EF 4.3 中动态更改 ProxyCreationEnabled 配置的值？

```
 somecontext.Configuration.ProxyCreationEnabled = false;
    somecontext.Set().Get(id);
    somecontext.Configuration.ProxyCreationEnabled = true;
    ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T18:59:39.280

是的。实际上有时在运行时更改代理创建或延迟加载配置非常有用。

# php - jQuery AJAX 调用两次

> ID：14798519
> 
> 赞同：1
> 
> 时间：2013-02-10T14:01:29.570
> 
> 标签：php, javascript, jquery, ajax, json

我已经发布了一个关于它的问题，但我已经弄清楚了确切的问题。现在，我需要一个解决方案:)

这是我的代码：

```
$('input[type="text"][name="appLink"]').unbind('keyup').unbind('ajax').keyup(function() {

    var iTunesURL = $(this).val();
    var iTunesAppID = $('input[name="iTunesAppID"]').val();

    $.ajax({
        type: 'POST',
        url: jsonURL,
        dataType: 'json',
        cache: false,
        timeout: 20000,
        data: { a: 'checkiTunesURL', iTunesURL: iTunesURL, iTunesAppID: iTunesAppID },
        success: function(data) {
            if (!data.error) {
                $('section.submit').fadeOut('slow');
                //Modifying Submit Page
                setTimeout(function() {
                    $('input[name="appLink"]').val(data.trackViewUrl);
                    $('div.appimage > img').attr('src', data.artworkUrl512).attr('alt', data.trackName);
                    $('div.title > p:nth-child(1)').html(data.trackName);
                    $('div.title > p:nth-child(2)').html('by '+data.sellerName);
                    $('span.mod-category').html(data.primaryGenreName);
                    $('span.mod-size').html(data.fileSizeBytes);
                    $('span.mod-update').html(data.lastUpdate);
                    $('select[name="version"]').html(data.verSelect);
                    $('input[name="iTunesAppID"]').attr('value', data.trackId);
                }, 600);
                //Showing Submit Page
                $('section.submit').delay('600').fadeIn('slow');
            } else {
                $('.json-response').html(data.message).fadeIn('slow');
            }
        },
        error: function(jqXHR, textStatus, errorThrown) {
            //$('.json-response').html('Probléma történt! Kérlek próbáld újra később! (HTTP Error: '+errorThrown+' | Error Message: '+textStatus+')').fadeIn('slow');
            $('.json-response').html('Something went wrong! Please check your network connection!').fadeIn('slow');
        }
    });
}); 
```

问题及解释：

每次触发一个键时，它都会加载这个 ajax。如果我的 JSON 文件找到 a`keyword`它会返回`error = false`标志。你看，如果它发生，它会加载效果，改变等等......

问题是，例如，当您开始键入时，`asdasdasd`然后我粘贴/写入，`keyword`将会有一些仍在处理的 ajax 查询。这些正在修改和加载淡入效果 X 次。

所以我需要一个解决方案来停止处理 ajax 请求，同时按下另一个键！

在此先感谢，马塞尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:05:18.187

就我个人而言，我会让脚本等待，这样它就不会在每个键位上触发。其实我可能会使用[http://jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)

但是您可以在重试之前中止 ajax。

```
...
var iTunesAppID = $('input[name="iTunesAppID"]').val();

if (typeof req!='undefined' && req!=null) req.abort();
req = $.ajax({
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T20:09:22.193

尝试将选项添加`async: false`到您的 ajax 这将阻止任何其他调用，直到当前调用完成。

# javascript - 即使网站离线，如何保持我的用户脚本正常工作？

> ID：14798522
> 
> 赞同：4
> 
> 时间：2013-02-10T14:01:54.983
> 
> 标签：javascript, google-chrome, greasemonkey, userscripts, tampermonkey

我想做一个用户脚本（现在我只担心 Chrome 兼容性）每 30 秒重新加载一次页面（我的意思是，这不是重点，我只是想在互联网离线时以某种方式执行一些脚本），以防万一互联网出现故障，用户不在这里看到它。

现在，问题是，一旦互联网出现故障，页面将被重定向到“此网页不可用”，并且所有用户脚本都停止工作。

我已经尝试添加`@include *`到元数据中，希望这将允许用户脚本在所述页面上工作，但是我没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T22:10:27.123

Chrome 的“此网页不可用”显示不是具有“可润滑”方案的标准页面。这意味着 Tampermonkey 脚本和 Chrome 用户脚本不会为它触发。您必须制作一个成熟的[Chrome 扩展程序](https://stackoverflow.com/tags/google-chrome-extension/info)。（[这个问题](https://stackoverflow.com/q/8514883/331508)的更多细节。）

有一些解决方法：

(1) 您可以**将您的 DNS 提供商切换**为[OpenDNS 之](http://en.wikipedia.org/wiki/OpenDNS)类的提供商。OpenDNS 劫持 DNS 解析错误并提供垃圾邮件“搜索”页面。（页面是`guide.opendns.com`，IIRC。）

该搜索页面***可被***Tampermonkey 润滑。您的脚本可以搜索 OpenDNS 的“不可用”消息并知道该站点已离线。

(2)**使用 AJAX 轮询页面**标题，并且仅在页面启动和在线时才重新加载。

使用[GM_xmlhttpRequest()](http://wiki.greasespot.net/GM_xmlhttpRequest)（或 jQuery）[发出`head`请求](http://wiki.greasespot.net/GM_xmlhttpRequest#HEAD_request)。如果请求出错，则该站点处于脱机状态，请不要重新加载页面。

同样，如果`Last-Modified`标题与您上次检查时相同，则重新加载页面（通常）没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:22:08.530

如评论中所述：

将页面包装在一个中`<iframe>`并在父级中执行用户脚本。一旦连接断开，Chrome 应该继续在父级中执行用户脚本，因为它仍然在加载，不像 iframe，一旦你刷新它就无法加载。请注意，您可能会遇到一些同源策略困难：afaik 您将无法注意到 iframe 无法加载。

# javascript - 测试浏览器扩展

> ID：14798528
> 
> 赞同：36
> 
> 时间：2013-02-10T14:02:18.040
> 
> 标签：javascript, testing, tdd, bdd, browser-extension

我将编写一堆浏览器扩展（每个流行的浏览器都具有相同的功能）。我希望，一些代码将被共享，但我还不确定这一点。当然，一些扩展将使用本机 API。我在 TDD/BDD 方面没有太多经验，我认为现在是从这个项目中开始遵循这些想法的好时机。

问题是，我不知道如何处理它。我应该为每个浏览器编写不同的测试吗？这些测试我应该走多远？这些扩展将非常简单——本地存储中的一些数据、刷新页面和通过 Web 套接字进行侦听。

我观察到为什么对我来说很难——因为有很多行为，而不是太多模型，它们也依赖于平台。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-06-28T17:35:29.707

我练习了两种不同的方法来测试我的浏览器扩展：

*   单元测试
*   集成测试

# 介绍

在整个答案中，我将使用 Rob W 扩展的跨浏览器[YouTube 歌词](https://robwu.nl/youtubelyrics/)作为示例。此扩展的核心是用 JavaScript 编写的，并使用 AMD 模块进行组织。构建脚本会为每个浏览器生成扩展文件。使用[r.js](https://github.com/jrburke/r.js/)，我简化了浏览器特定模块的包含，例如用于跨域 HTTP 请求和持久存储（用于首选项）的模块，以及用于 IE 的具有大量 polyfill 的模块。

该扩展插入一个面板，其中包含当前在 YouTube、Grooveshark 和 Spotify 上播放的歌曲的歌词。我无法控制这些第三方网站，因此我需要一种自动化的方式来验证扩展程序是否仍能正常工作。

### 工作流程

开发过程中：

1.  实现/编辑功能，如果该功能不是微不足道的，则编写单元测试。
2.  运行所有*单元测试*以查看是否有任何问题。如果有任何问题，请返回 1。
3.  提交给 git。

发布前：

1.  运行所有*单元测试*以验证各个模块是否仍在工作。
2.  运行所有*集成测试*以验证整个扩展是否仍在工作。
3.  凹凸版本，构建扩展。
4.  将更新上传到官方扩展库和我的网站（Safari 和 IE 扩展必须由您自己托管）并提交到 git。

# 单元测试

我使用[mocha](https://mochajs.org/) + [expect.js](https://github.com/LearnBoost/expect.js/)编写测试。我不会测试每个模块的所有方法，只测试重要的方法。例如：

*   DOM 解析方法。大多数 DOM 解析方法（包括 jQuery）都存在缺陷：加载任何外部资源并执行 JavaScript。
    我验证 DOM 解析方法是否正确解析 DOM 而没有负面影响。

*   首选项模块：我验证数据可以保存和返回。

*   我的扩展从外部来源获取歌词。这些源在单独的模块中定义。这些定义被模块识别和使用，该`InfoProvider`模块接受查询（黑框）并输出搜索结果。

    *   首先我测试`InfoProvider`模块是否正常工作。
    *   然后，对于 17 个源中的每一个，我将预定义的查询传递给源（使用`InfoProvider`）并验证结果是否符合预期：
        *   查询成功
        *   返回的歌曲标题匹配（通过[应用](http://jsperf.com/dice-s-similarity-coefficient-hash-vs-array)单词相似度算法）
        *   返回的歌词长度在预期范围内。
*   UI 是否没有明显损坏，例如通过单击关闭按钮。

这些测试可以直接从本地服务器运行，也可以在浏览器扩展中运行。本地服务器的优点是您可以编辑测试并刷新浏览器以查看结果。如果所有这些测试都通过了，我会从浏览器扩展运行测试。
通过向我的构建脚本传递一个额外的参数`debug`，单元测试与我的扩展捆绑在一起。

在网页中运行测试是不够的，因为扩展的环境可能与普通页面不同。例如，在 Opera 12 扩展中，没有全局`location`对象。

备注：我没有在发布版本中包含测试。大多数用户不会努力报告和调查错误，他们只会给出低评价并说“不起作用”之类的话。在发布之前确保您的扩展功能没有明显的错误。

### 概括

*   将模块视为黑盒。你不在乎里面有什么，只要输出匹配是预期的或给定的输入。
*   从测试扩展的关键部分开始。
*   确保测试可以轻松构建和运行，可能在非扩展环境中。
*   不要忘记在扩展的执行上下文中运行测试，以确保在扩展的上下文中没有约束或意外条件会破坏您的代码。

# 集成测试

我使用 Selenium 2 来测试我的扩展程序是否仍然适用于 YouTube、Grooveshark (3x) 和 Spotify。

最初，我只是使用[Selenium IDE](http://docs.seleniumhq.org/docs/02_selenium_ide.jsp)来记录测试并查看它是否有效。一切顺利，直到我需要更大的灵活性：我想根据测试帐户是否登录有条件地运行测试。这对于默认的 Selenium IDE 是不可能的（据说使用[FlowControl 插件](https://github.com/davehunt/selenium-ide-flowcontrol)是可能的——我没有尝试过）。

Selenium IDE 提供了以其他格式导出现有测试的选项，包括 JUnit 4 测试 (Java)。不幸的是，这个结果并不令人满意。许多命令无法识别。

所以，我放弃了 Selenium IDE，转而使用 Selenium。
请注意，当您搜索“Selenium”时，您会找到有关 Selenium RC (Selenium 1) 和 Selenium WebDriver (Selenium 2) 的信息。第一个是旧的和已弃用的，后者（Selenium WebDriver）应该用于新项目。

一旦你了解了文档的工作原理，它就很容易使用。
我更喜欢项目页面上的文档，因为它通常简洁（[wiki](https://code.google.com/p/selenium/w/list)）和完整（[Java docs](http://selenium.googlecode.com/git/docs/api/java/index.html)）。

如果您想快速入门，请阅读[入门 wiki 页面](https://code.google.com/p/selenium/wiki/GettingStarted)。如果您有空闲时间，请查看[SeleniumHQ 的文档](http://docs.seleniumhq.org/docs/)，尤其是[Selenium WebDriver](http://docs.seleniumhq.org/docs/03_webdriver.jsp)和[WebDriver：高级用法](http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp)。
[Selenium Grid](http://docs.seleniumhq.org/docs/07_selenium_grid.jsp)也值得一读。此功能允许您在不同的（虚拟）机器上分发测试。*如果您想同时*在 IE8、9 和 10 中测试您的扩展，那就太好了（要运行多个版本的 Internet Explorer，您需要虚拟化）。

自动化测试很好。还有什么好看的？自动安装扩展！
ChromeDriver和[FirefoxDriver](https://code.google.com/p/selenium/wiki/ChromeDriver)[支持](https://code.google.com/p/selenium/wiki/FirefoxDriver)安装扩展，如[本例所示](https://stackoverflow.com/a/17117849/938089)。

对于[SafariDriver](https://code.google.com/p/selenium/wiki/SafariDriver)，我编写了两个类来安装自定义 Safari 扩展。我已经发布了它并在 PR 中发送给 Selenium，因此将来可能对所有人都可用：[https ://github.com/SeleniumHQ/selenium/pull/87](https://github.com/SeleniumHQ/selenium/pull/87)

OperaDriver不支持安装自定义扩展（从技术上讲，它应该是可能的）[。](https://github.com/operasoftware/operadriver)
请注意，随着基于[Chromium 的 Opera](http://business.opera.com/press/releases/desktop/2013-05-28)的出现，旧的 OperaDriver 不再工作。

有一个[Internet Explorer 驱动程序](https://code.google.com/p/selenium/wiki/InternetExplorerDriver)，这个绝对不允许安装自定义扩展。Internet Explorer 没有对扩展的内置支持。扩展是通过 MSI 或 EXE 安装程序安装的，它们甚至没有集成在 Internet Explorer 中。因此，为了在 IE 中自动安装您的扩展程序，您需要能够静默运行安装 IE 插件的安装程序。我还没试过*这个*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-26T19:57:41.050

测试浏览器扩展也给我带来了一些困难，但我已经决定在几个不同的领域实现测试，我可以从 Selenium 驱动的浏览器同时调用这些测试。

我使用的步骤是：

首先，我编写集成到扩展代码中的测试代码，只需转到特定 URL 即可激活。当扩展程序看到该 URL 时，它开始运行测试。

然后，在激活扩展中的测试的页面中，我执行服务器端测试以确保 API 执行，并在那里记录和记录问题。我记录了调用的方法、它们花费的时间以及任何错误。所以我可以看到扩展调用的方法、Web 性能、业务逻辑性能和数据库性能。

最后，我使用 Selenium 自动调用浏览器指向该特定 URL，并在任何给定客户端系统上记录它们的性能以及其他测试信息、错误等：

[http://docs.seleniumhq.org/](http://docs.seleniumhq.org/)

通过这种方式，我可以根据浏览器、扩展程序、服务器、应用程序和数据库来分解测试，并根据特定的测试集将它们链接在一起。将它们放在一起需要一些工作，但是一旦完成，您就可以拥有一个非常好的扩展测试框架。

通常用于跨浏览器扩展开发以维护单个代码库，我使用 crossrider，但您可以使用任何框架或使用本机扩展来执行此操作，Selenium 不在乎，它只是将扩展驱动到一个特定页面并允许您进行交互和执行测试。

这种方法的一个好处是您也可以将它用于实时用户。如果您正在为您的扩展提供支持，请让用户访问您的测试 url，您将立即看到扩展和服务器端性能。当然，您不会获得 Selenium 测试，但您会以这种方式捕获很多问题 - 当您针对各种浏览器和浏览器版本进行编码时非常有用。

# json - Symfony2 JSON 响应返回奇怪的 UTF 字符

> ID：14798532
> 
> 赞同：4
> 
> 时间：2013-02-10T14:02:44.357
> 
> 标签：json, symfony, unicode

这是我的控制器方法：

```
 public function sendjsonAction()
  {

    $message = $this->getDoctrine()
    ->getRepository('AcmeStoreBundle:Message')
    ->findAll();
    $serializer = new Serializer(array(new GetSetMethodNormalizer()), array('message' => new 
JsonEncoder()));
    $message = $serializer->serialize($message, 'json');    
    return new JsonResponse($message);

  } 
```

这是我的路由器：

```
acme_store_sendjson:
    pattern:  /sendjson/
    defaults: { _controller: AcmeStoreBundle:Default:sendjson} 
```

这是我去 /sendjson/ 时得到的：

`"[{\u0022id\u0022:1,\u0022iam\u0022:1,\u0022youare\u0022:2,\u0022lat\u0022:50.8275853,\u0022lng\u0022:4.3809764,\u0022date\u0022:{\u0022lastErrors\u0022:{\u0022warning_count\u0022:0,\u0022warnings\u0022:[],\u0022error_count\u0022:0,\u0022errors\u0022:[]},\u0022timezone\u0022:{\u0022name\u0022:\u0022UTC\u0022,\u0022location\u0022:{\u0022country_code\u0022:\u0022??`

（并且类似地继续）

我尝试使用以下内容进行 ajax 调用（使用 jQuery）：

```
$.getJSON('/app_dev.php/sendjson', function(data) {
  var items = [];

  $.each(data, function(key, val) {
    items.push('<li id="' + key + '">' + val + '</li>');
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('body');
}); 
```

我得到一个

```
Uncaught TypeError: Cannot use 'in' operator to search for '1549' in [{"id":1,... 
```

当我更改 Symfony2 的响应类型时，我得到一个列表

[对象] [对象] [对象] [对象] [对象] [对象] ...

我究竟做错了什么？我应该解析答案以将 \u0022 转换为 " 还是我的响应从一开始就有错误？

**编辑**

我还尝试将控制器更改为：

```
 public function sendjsonAction()
  {
$encoders = array(new XmlEncoder(), new JsonEncoder());
$normalizers = array(new GetSetMethodNormalizer());
$serializer = new Serializer($normalizers, $encoders);

    $message = $this->getDoctrine()
    ->getRepository('AcmeStoreBundle:Message')
    ->findAll();
$serializer = $serializer->serialize($message, 'json');
    return new Response($serializer);
} 
```

这次我得到了 VALID JSON，（根据 Jsonlint）但标头不是 application/json ...（这是有道理的，因为我发送的是响应而不是 JsonResponse ...）（但这就是我试图避免的JsonResponse 似乎正在改变添加奇怪的字符）

```
[{"id":1,"iam":1,"youare":2,"lat":50.8275853,"lng":4.3809764,"msgbody":"I saw you over there what's up!"},{"id":2,"iam":1,"youare":2,"lat":50.8275853,"lng":4.3809764,"msgbody":"I saw you over there what's up!"},{"id":3,"iam":1,"youare":2,"lat":50.8275853,"lng":4.3809764,"msgbody":"I saw you over there what's up!"},{"id":4,"iam":1,"youare":2,"lat":50.8275853,"lng":4.3809764,"msgbody":"I saw you over there what's up!"},{"id":5,"iam":1,"youare":2,"lat":50.8275853,"lng":4.3809764,"msgbody":"I saw you over there what's up!"},{"id":6,"iam":1,"youare":2,"lat":50.8275853,"lng":4.3809764,"msgbody":"I saw you over there what's up!"}] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-11T17:30:23.847

我找到了答案。

1) 只要 JSON 有效，内容类型不是 application/json 而是 text/html 并不“真正重要”。我的 JS 没有播放的原因是我要求的是 val 而不是 val 的属性，例如 val.msgbody。：

所以我的Javascript应该是

```
$.getJSON('/app_dev.php/sendjson', function(data) {
  var items = [];

  $.each(data, function(key, val) {
    items.push('<li id="' + key + '">' + val.msgbody + '</li>');
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('body');
}); 
```

如果 Content-Type 是必需的，那么控制器可能是这样的：

```
 public function sendjsonAction()
  {
    $encoders = array(new JsonEncoder());
    $normalizers = array(new GetSetMethodNormalizer());
    $serializer = new Serializer($normalizers, $encoders);
    $message = $this->getDoctrine()
      ->getRepository('AcmeStoreBundle:Message')
      ->findAll();
    $response = new Response($serializer->serialize($message, 'json')); 
    $response->headers->set('Content-Type', 'application/json');
    return $response;
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-04T18:28:19.743

序列化是规范化的过程 - 制作一个表示对象的数组 - 并将该表示编码（即 JSON 或 XML ）。JsonResponse 为您处理编码部分（查看类的名称），因此您不能传递“序列化对象”，否则它将再次被编码。因此，解决方案只是规范化对象并将其传递给 JsonResponse：

```
public function indexAction($id)
{
    $repository = $this->getDoctrine()->getRepository('MyBundle:Product');
    $product = $repository->find($id);

    $normalizer = new GetSetMethodNormalizer();

    $jsonResponse = new JsonResponse($normalizer->normalize($product));
    return $jsonResponse;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-27T08:40:31.037

您可以只使用没有序列化器的规范化器来解决这个问题：

```
 $normalizer = new ObjectNormalizer();
    $array = $normalizer->normalize($newEntry);
    $entryJSONFile = json_encode($array, JSON_UNESCAPED_UNICODE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-07T11:43:27.660

您的代码在 json 中编码两次。当您使用序列化程序自己进行 json 编码时，请使用 Response 类。

将 return new JsonResponse($message) 替换为 return new Response($message)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-15T08:39:56.573

[https://www.php.net/manual/en/json.constants.php](https://www.php.net/manual/en/json.constants.php)

[https://www.php.net/manual/en/function.json-encode.php](https://www.php.net/manual/en/function.json-encode.php)

输出 JSON 字符串的对象`\Symfony\Component\HttpFoundation\JsonResponse`使用函数`json_encode`，通过对象方法，`setEncodingOptions`您可以通过按位常量设置输出 JSON 字符串选项，例如`JSON_UNESCAPED_UNICODE`：

> 对多字节 Unicode 字符进行逐字编码（默认转义为 \uXXXX）。自 PHP 5.4.0 起可用。

```
$jsonResponse = new \Symfony\Component\HttpFoundation\JsonResponse($arrayForJSON);
$jsonResponse->setEncodingOptions($this->getEncodingOptions()|JSON_UNESCAPED_UNICODE|JSON_NUMERIC_CHECK|JSON_PRETTY_PRINT);
$jsonResponse->send(); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-02-02T17:27:03.753

问题是您将字符串传递给 JsonResponse 而不是数组。

您的*控制器*代码是：

```
...
return new JsonResponse($message)
... 
```

您的*控制器*代码必须是：

```
...
return new JsonResponse(json_decode($message, true))
... 
```

# php - hide html columns when exporting to excel

> ID：14798544
> 
> 赞同：2
> 
> 时间：2013-02-10T14:04:37.760
> 
> 标签：php, jquery, excel, header

I'm trying to export html table using header output in php. I'm using jquery to hide the columns by checkbox event.

My jquery code to unhide and hide column is:

```
$('.col').css('display','table-cell');
$('.col').css('display','none'); 
```

When I export my html table with hidden columns, the hidden columns still appears. I want to hide those columns while exporting to excel using php header.

Thanks for your help in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-28T11:36:49.090

我只是在找这个，我发现

[如何删除 style="display: none;" 将 HTML 表格导出到 Excel 时的列？| ASP.NET 论坛](http://forums.asp.net/t/1985239.aspx?How+to+remove+style+display+none+columns+when+exporting+an+HTML+table+to+Excel+)；`display:none;`诀窍是先克隆您的表，然后在导出之前从其中删除所有样式为 " " 的元素：

> 最简单的方法（如果可以的话）可能是在提交表单之前显式删除任何不可见的元素`<th>`：`<td>`
> 
> ```
> // This will remove any hidden <th> or <td> elements from the DOM
> $("th:hidden,td:hidden").remove(); 
> ```
> 
> [...] 将现有的 html 克隆到 jQuery 变量中，然后从该实际变量中执行删除：
> 
> ```
> // When the stripped button is clicked, clone the existing source
> var $clonedTable = $("#my-table").clone();
> // Strip your empty characters from the cloned table (hidden didn't seem to work since the cloned table isn't visible)
> $clonedTable.find('[style*="display: none"]').remove(); 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-04T09:21:45.053

```
$("th:hidden,td:hidden").remove();
var $clonedTable = $("#my-table").clone();

$clonedTable.find('[style*="display: none"]').remove(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-10T14:40:59.617

我写了一个小类，您可以在其中使用表格中所需的数据填充数组后生成 xls 表格，它非常易于使用，并且可以根据您的要求进行扩展，希望对您有所帮助：[http://www.anchorx。 com/ali/2011/02/27/create-spreadsheet-with-php/](http://www.anchorx.com/ali/2011/02/27/create-spreadsheet-with-php/)

# ios - 为什么在将 UI 对象委托设置为 self 时在 .h 中声明？

> ID：14798546
> 
> 赞同：-2
> 
> 时间：2013-02-10T14:04:50.413
> 
> 标签：ios, objective-c

每当我以编程方式创建 UI 对象`UITextField`时，我都会这样做：

```
txt.delegate = self; 
```

出现编译器警告并要求我添加`UITextFieldDelegate`.h 文件。

我注意到，不管有没有，代码都可以正常工作。

但是编译器警告消失了。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:29:52.980

`delegate`除非您实际使用委托方法，否则您实际上不需要设置对象的属性。例如，如果您需要知道何时`UITextField`开始编辑。如果您不需要知道这些事情何时发生，则无需设置委托。

换个角度看，如果你让你的类符合委托方法（通过`<SomeClassDelegate>`在`.h`文件中添加），然后忘记实现所需的委托方法，你会收到编译器的警告，当应用程序崩溃时运行（并向您的对象发送所需的委托消息）。

要回答关于不添加`UITextFieldDelegate`到`.h`文件的问题，假设您的朋友正在寻找法语翻译。你找到一个长相外国的男人并介绍他。你的朋友问“但是他会说法语吗？” 你回答“我不知道”。这是你的警告。

# mongodb - MongoDB 2.x 写入关注 { w : 1 } 真的等于 { safe : true } 吗？

> ID：14798552
> 
> 赞同：2
> 
> 时间：2013-02-10T14:05:37.210
> 
> 标签：mongodb, nosql

标题说明了一切，真的。我似乎再也无法在文档中找到“安全”关键字的正确答案，但是 w:1 = 等待独立服务器（可以是副本集 env 中的主服务器），这似乎符合我对“安全”的理解。

此外，我们在 mongodb 上启用了日志，是否需要 {j:true} 才能使其与 {safe:true} 兼容？

[http://docs.mongodb.org/manual/core/write-operations/#write-concern](http://docs.mongodb.org/manual/core/write-operations/#write-concern)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T19:11:13.373

是的，文档永远不会很好地告诉你这些东西，但是，是的，`safe`是`w`1。那里有很多来源，但这里有一个我觉得有用的 PHP 驱动程序：

[http://derickrethans.nl/mongoclient.html](http://derickrethans.nl/mongoclient.html)

他在此声明：

> 所有其他 MongoDB 驱动程序都在进行类似的更改。

和：

> 最大的原因是新类将默认确认写入 - 或以不推荐的措辞表示：MongoClient 默认具有安全模式。

所以答案是肯定的。

至于日记：

> 我们在 mongodb 上启用日志，是否需要 {j:true} 才能使其与 {safe:true} 兼容？

没有一个日志确认写入与一般的日志不同。即使您使用 1，MongoDB 仍将继续使用该日志，`w`但它不会在响应您的请求之前等待日志写入。`j`默认情况下通常为假。

# symfony - symfony 2中相同的url需要多个角色

> ID：14798554
> 
> 赞同：4
> 
> 时间：2013-02-10T14:05:51.600
> 
> 标签：symfony, symfony-2.1

这就是我的 security.yml 对于访问控制列表的样子：

```
access_control:
    - { path: ^/admin, roles: IS_AUTHENTICATED_FULLY }
    - { path: ^/admin, roles: ROLE_ADMIN } 
```

我想要做的是用户必须同时具有两个角色（ROLE_ADMIN 和 IS_AUTHENTICATED_FULLY）才能访问定义的路径。但是使用上述规则，如果用户具有任何一个角色，则用户可以访问我不想要的定义的路径。我也尝试给出如下规则但没有成功：

```
 - { path: ^/admin, roles:[ROLE_ADMIN,IS_AUTHENTICATED_FULLY] } 
```

如何添加要求用户具有两个角色才能访问定义的路径的规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:20:07.747

```
IS_AUTHENTICATED_FULLY 
```

当用户实际通过身份验证时返回 true。

> 匿名用户在技术上是经过身份验证的，这意味着匿名用户对象的 isAuthenticated() 方法将返回 true。要检查您的用户是否真正通过了身份验证，请检查 IS_AUTHENTICATED_FULLY 角色。

因此，如果用户具有角色 ROLE_ADMIN 并已登录，则他已完全通过身份验证。因此，无需设置此要求：

```
- { path: ^/admin, roles: IS_AUTHENTICATED_FULLY } 
```

因为您拥有（见下文），其中包括经过完全身份验证

```
- { path: ^/admin, roles: ROLE_ADMIN } 
```

和

```
- { path: ^/admin, roles: IS_AUTHENTICATED_FULLY } 
```

将允许任何用户查看管理部分。

阅读：[http ://symfony.com/doc/current/book/security.html](http://symfony.com/doc/current/book/security.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-11T08:24:49.930

看问题本身，而不是看你的具体情况。

如果您需要用户具有所有指定角色来访问某个路径，则需要更多配置，因为`RoleVoter`如果当前安全令牌至少具有一个指定角色，则默认授予访问权限。

`RoleVoter`如果令牌具有至少一个传递的角色，则授予访问权限，但安全组件将每个指定的角色单独传递给每个投票者。因此，要将 OR 行为更改为 AND 行为，您需要做的就是更改决策管理器策略：

```
# app/config/security.yml
security:
    access_decision_manager:
        # strategy can be: affirmative (default one), unanimous or consensus
        strategy: unanimous # if any voter returns ACCESS_DENIED, access is denied 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-02-19T17:45:49.713

如果我没有误会你，我认为分层角色
是更好的方法[http://symfony.com/doc/current/book/security.html#hierarchical-roles](http://symfony.com/doc/current/book/security.html#hierarchical-roles)）。

```
#分层角色
您可以通过创建角色层次结构来定义角色继承规则，而不是将许多角色与用户相关联：

YAML

应用程序/配置/security.yml
安全：
    ...

    角色层次结构：
        ROLE_ADMIN：ROLE_USER
        ROLE_SUPER_ADMIN：ROLE_ADMIN
        ROLE_BOTH_ROLE_TOGETHER：[IS_AUTHENTICATED_FULLY，ROLE_ADMIN]

```

他们 oyu 可以检查层次结构。

# node.js - Mongoose 查询参考

> ID：14798560
> 
> 赞同：0
> 
> 时间：2013-02-10T14:06:12.277
> 
> 标签：node.js, mongodb, express, mongoose

我的应用程序具有以下架构结构：

```
var User = new Schema({
  name: {type: String, required: true},
    screen_name: {type: String, required: true, index:{unique:true}},
    email: {type: String, required: true, unique:true},
    created_at: {type: Date, required: true, default: Date}
});

var Line = new Schema({
    user: {type: Schema.ObjectId, ref: 'User'},
    text: String,
    entered_at: {type: Date, required: true, default: Date}
});

var Story = new Schema ({
    sid: {type: String, unique: true, required: true},
    maxlines: {type: Number, default: 10}, // Max number of lines per user
    title: {type: String, default: 'Select here to set a title'},
    lines: [Line],
    created_at: {type: Date, required: true, default: Date}
});

var Story = db.model('Story', Story);
var User = db.model('User', User); 
```

当我使用 sid 查询故事时，我希望它输出该故事中的行以及用户屏幕名称。

目前我正在使用以下内容来查询故事：

```
app.get('/api/1/story/view/:id', function(req, res){
  Story.findOne({ sid: req.params.id }, function(err, story){
            if (err) {
            res.json(err);
        }
        else if(story == null) {
            res.json(err);
        }
        else{
        res.send(story);       
            }
        });
}); 
```

这只是带回了这样的结果：

```
{
  "__v": 1,
  "_id": "5117878e381d7fd004000002",
  "sid": "DIY0Ls5NwR",
  "created_at": "2013-02-10T11:42:06.000Z",
  "lines": [
    {
      "user": "511782cab249ff5819000002",
      "text": "TESTING",
      "_id": "51178795381d7fd004000003",
      "entered_at": "2013-02-10T11:42:13.000Z"
    }
  ],
  "title": "Select here to set a title",
  "maxlines": 10
} 
```

有一个使用该 _id 的用户设置，但我不完全确定如何输出故事并让它包含用户 screen_name 甚至整个用户信息以及输出

```
{
  "__v": 0,
  "screen_name": "Tam",
  "email": "test@test.com",
  "name": "Tam",
  "_id": "511782cab249ff5819000002",
  "created_at": "2013-02-10T11:21:46.000Z"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:51:07.950

我还没有测试过它，但你应该能够使用它[`populate`](http://mongoosejs.com/docs/populate.html)来获取每个`lines`元素的完整用户文档，如下所示：

```
Story.findOne({sid: req.params.id})
    .populate('lines.user')
    .exec(function(err, story){ ... 
```

# jquery - Jquery planner calendar

> ID：14798564
> 
> 赞同：0
> 
> 时间：2013-02-10T14:06:54.370
> 
> 标签：jquery, calendar

Hoping someone has stumble on something that would help me, I am trying to add a jquery calendar to my site, and the only ones I can seem to find are ones that have hourly events, for one person. I am looking for a grid, booked out type thing. My explanation is poor so I brought pictures. Something like.

![Grid layout](../Images/408f3741c3d22c8b561268154e09f977.png)

So basically I can add a list of items and what days they are marked out. Sort of a booking system. I don't need hourly, just daily markers.

Anyone know one? If not I am going to have to write my own.

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:13:38.443

为什么需要日历？你没有日期，它是一个每周的概念，你可以用表格或 div 做你需要的一切。

您只需要返回一个带有人员及其可用性的 json 对象。

```
data = {
  'schedule': [
    {
    'name': 'Car1',
    'week': 51,
    'availability':  {
         'mon': True,
         'tue': False,
         //etc
     }
     }, /etc
   ]
  } 
```

或者

```
data = {
   // ...
  'availability': [1,0,0,0,0,0,1]
} 
```

只是我的两分钱，我看不出对日历有什么特别需要。

# android - 在活动中显示下载管理器进度

> ID：14798569
> 
> 赞同：19
> 
> 时间：2013-02-10T14:07:25.400
> 
> 标签：android, android-download-manager

我在我的活动中使用了下载管理器类来执行下载；它工作正常，我的下一个任务是在我的活动中显示相同的进度百分比。我不知道该怎么做。

到目前为止我的代码

```
public class DownloadSampleBook extends Activity{

private long enqueue;
private DownloadManager dm;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_sample_download);

    BroadcastReceiver receiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            String action = intent.getAction();
            if (DownloadManager.ACTION_DOWNLOAD_COMPLETE.equals(action)) {
                long downloadId = intent.getLongExtra(
                        DownloadManager.EXTRA_DOWNLOAD_ID, 0);
                Query query = new Query();
                query.setFilterById(enqueue);
                Cursor c = dm.query(query);
                if (c.moveToFirst()) {
                    int columnIndex = c
                            .getColumnIndex(DownloadManager.COLUMN_STATUS);
                    if (DownloadManager.STATUS_SUCCESSFUL == c
                            .getInt(columnIndex)) {

                       view.setImageURI(Uri.parse(uriString));
                    }
                }
            }
        }
    };

    registerReceiver(receiver, new IntentFilter(
            DownloadManager.ACTION_DOWNLOAD_COMPLETE));
}

public void onClick(View view) {
    dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);
    Request request = new Request(
            Uri.parse("http://abc.com/a.png"));
    enqueue = dm.enqueue(request);

}

public void showDownload(View view) {
    Intent i = new Intent();
    i.setAction(DownloadManager.ACTION_VIEW_DOWNLOADS);
    startActivity(i);
}
} 
```

有没有什么方法可以给出进度下载百分比？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-07-22T18:50:48.630

如果您正在寻找一种合适的方式来确定何时查询`DownloadManager`进度更新，请考虑`ContentObserver`为 uri注册`content://downloads/my_downloads`

例子：

```
DownloadManager manager = (DownloadManager) getSystemService( Context.DOWNLOAD_SERVICE );
manager.enqueue( myRequest );

Uri myDownloads = Uri.parse( "content://downloads/my_downloads" );
getContentResolver().registerContentObserver( myDownloads, true, new DownloadObserver() );

...

public static class DownloadObserver extends ContentObserver {
   @Override
   public void onChange( boolean selfChange, Uri uri ) {
      Log.d( "DownloadObserver", "Download " + uri + " updated" );
   } 
```

当接收到长时间运行的下载的每个块时，这会产生以下输出

```
D/DownloadObserver(15584): Download content://downloads/my_downloads/437 updated
D/DownloadObserver(15584): Download content://downloads/my_downloads/437 updated
D/DownloadObserver(15584): Download content://downloads/my_downloads/437 updated
D/DownloadObserver(15584): Download content://downloads/my_downloads/437 updated 
```

其中“437”是您下载的 ID。

请注意，这遵循类`android.provider.Downloads`中定义的内容 URI，该 URI 似乎隐藏在框架中，并且可能无法在所有设备上一致地工作。（[https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/provider/Downloads.java#89](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/provider/Downloads.java#89)）

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-06-06T19:58:31.070

您可以使用该方法查询到目前为止已下载的字节数以及需要下载的总字节数，其`query`方式与您在示例代码中查询状态的方式大致相同。一旦有了这些值，就很容易将进度计算为百分比。

收到新数据时似乎没有任何方法可以通知您，因此您需要定期轮询下载管理器以确定您要监控的任何下载的当前状态。

```
Query query = new Query();
query.setfilterById(downloadId);

Cursor c = dm.query(query);
if (c.moveToFirst()) {
  int sizeIndex = c.getColumnIndex(DownloadManager.COLUMN_TOTAL_SIZE_BYTES);
  int downloadedIndex = c.getColumnIndex(DownloadManager.COLUMN_BYTES_DOWNLOADED_SO_FAR);
  long size = c.getInt(sizeIndex);
  long downloaded = c.getInt(downloadedIndex);
  double progress = 0.0;
  if (size != -1) progress = downloaded*100.0/size;  
  // At this point you have the progress as a percentage.
} 
```

请注意，总大小最初为 -1，只有在下载开始后才会填写。因此，在上面的示例代码中，我检查了 -1，如果尚未设置大小，则将进度设置为 0。

但是，您可能会发现在某些情况下总大小永远不会返回（例如，在 HTTP 分块传输中，将没有 Content-Length 标头可以确定大小）。如果您需要支持这种服务器，您可能应该向用户提供某种指示下载正在进行中，而不仅仅是卡在零的进度条。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-17T10:41:34.330

我需要跟踪多个文件的下载。经过大量的思考和实验，我想出了以下代码：

```
private void startDownloadThread(final List<DownloadFile> list) {

        // Initializing the broadcast receiver ...
        mBroadCastReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                mFinishedFilesFromNotif.add(intent.getExtras()
                        .getLong(DownloadManager.EXTRA_DOWNLOAD_ID));
            }
        };

        IntentFilter intentFilter = new IntentFilter(
                "android.intent.action.DOWNLOAD_COMPLETE");
        DownloadProgressUIFragment.this.getActivity().registerReceiver(mBroadCastReceiver,
                intentFilter);

        // initializing the download manager instance ....
        mDownloadManager = (DownloadManager) getActivity()
                .getSystemService(Context.DOWNLOAD_SERVICE);

        // adding files to the download manager list ...
        for(DownloadFile f: list) {
            mDownloadIds.add(FileUtils.addFileForDownloadInBkg(getApplicationContext(),
                    f.getUrl(),
                    f.getPath()));
        }

        // starting the thread to track the progress of the download ..
        mProgressThread = new Thread(new Runnable() {
            @Override
            public void run() {

                // Preparing the query for the download manager ...
                DownloadManager.Query q = new DownloadManager.Query();
                long[] ids = new long[mDownloadIds.size()];
                final List<Long> idsArrList= new ArrayList<>();
                int i = 0;
                for (Long id: mDownloadIds) {
                    ids[i++] = id;
                    idsArrList.add(id);
                }
                q.setFilterById(ids);

                // getting the total size of the data ...
                Cursor c;

                while(true) {

                    // check if the downloads are already completed ...
                    // Here I have created a set of download ids from download manager to keep
                    // track of all the files that are dowloaded, which I populate by creating
                    //
                    if(mFinishedFilesFromNotif.containsAll(idsArrList)) {
                        isDownloadSuccess = true;

                        // TODO - Take appropriate action. Download is finished successfully
                        return;
                    }

                    // start iterating and noting progress ..
                    c = mDownloadManager.query(q);
                    if(c != null) {
                        int filesDownloaded = 0;
                        float fileFracs = 0f; // this stores the fraction of all the files in
                        // download
                        final int columnTotalSize = c.getColumnIndex
                                (DownloadManager.COLUMN_TOTAL_SIZE_BYTES);
                        final int columnStatus = c.getColumnIndex(DownloadManager.COLUMN_STATUS);
                        //final int columnId = c.getColumnIndex(DownloadManager.COLUMN_ID);
                        final int columnDwnldSoFar =
                                c.getColumnIndex(DownloadManager.COLUMN_BYTES_DOWNLOADED_SO_FAR);

                        while (c.moveToNext()) {
                            // checking the progress ..
                            if(c.getInt(columnStatus) == DownloadManager.STATUS_SUCCESSFUL) {
                                filesDownloaded++;
                            }
                            // If the file is partially downloaded, take its fraction ..
                            else if(c.getInt(columnTotalSize) > 0) {
                                fileFracs += ((c.getInt(columnDwnldSoFar) * 1.0f) /
                                        c.getInt(columnTotalSize));
                            } else if(c.getInt(columnStatus) == DownloadManager.STATUS_FAILED) {
                                // TODO - Take appropriate action. Error in downloading one of the
                                // files.
                                return;
                            }
                        }

                        c.close();

                        // calculate the progress to show ...
                        float progress = (filesDownloaded + fileFracs)/ids.length;

                        // setting the progress text and bar...
                        final int percentage = Math.round(progress * 100.0f);
                        final String txt = "Loading ... " + percentage + "%";

                        // Show the progress appropriately ...
                    }
                }
            }
        });

        mProgressThread.start();
    } 
```

入队文件的功能是：

```
public static long addFileForDownloadInBkg(Context context, String url, String savePath) {
        Uri uri = Uri.parse(url);
        DownloadManager.Request request = new DownloadManager.Request(uri);
        request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_HIDDEN);
        request.setDestinationUri(Uri.fromFile(new File(savePath)));

        final DownloadManager m = (DownloadManager) context.getSystemService(Context.DOWNLOAD_SERVICE);
        return m.enqueue(request);
    } 
```

基本上，我会为每个已完成下载的文件单独收到通知，然后将它们添加到一个集合中，该集合基本上是帮助我确定所有下载是否已完成的集合。我根据文件的数量和每个文件完成的比例来跟踪进度。我希望这有帮助。

# java - 我无法接收从我的 servlet 发送的 json 对象

> ID：14798570
> 
> 赞同：1
> 
> 时间：2013-02-10T14:07:38.140
> 
> 标签：java, javascript, jquery, ajax, servlets

```
$(document).ready(function() {
        var path = null;
        console.log('${pageContext.request.contextPath}/loadfile');
        $.ajax({
              dataType: "json",
              url: '${pageContext.request.contextPath}/loadfile',
              success: function(data){
                $.each(data,function(index,obj){
                    console.log(obj.id);
                    alert('inside');
                    path = obj.path;
                });  
              }     
              }); 
```

这里 /loadfile 是返回 json 对象的 url，当我转到这个 url 时，我可以看到打印在 html 页面上的 JSON 对象，但是当我访问包含上述 javascript 代码的页面时，我没有得到相同的结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T08:11:13.653

人们通常不会告诉他们的服务器给浏览器他们发送的 JSON 字符串将被解释为一个 json 对象。

尽管`dataType:'json'`应该对其进行整理，但情况并非总是如此。

在 PHP 中

```
header("Content-type: application/json"); 
```

ASP

```
Response.AddHeader('Content-Type', 'application/json'); 
```

做不到这一点，

```
success: function(data){
    if (typeof data!='object') data=$.parseJSON(data); // make sure it's an object 
```

我不知道为什么 jQuery 没有修复它，但是响应标头，即使设置了 dataType:'json' 也可以显示为`application/x-www-form-urlencoded; charset=UTF-8`并且对象没有被创建。

# graphics - 如何成功地将位图绘制到另一个位图上？

> ID：14798578
> 
> 赞同：0
> 
> 时间：2013-02-10T14:08:19.713
> 
> 标签：graphics, map, bitmap, draw

我一直在尝试为我正在使用的游戏做一些地图的东西。我正在寻找显示 9 个地图文件（我已经阅读并处理了这些文件，并且有一个将这些地图文件转换为位图对象的函数）。

基本上我有一个位图数组和一个大位图。每个小位图为 256x256，大位图为 768x768，我想以正确的偏移量绘制它们（所以所有位图都排成一行，每个位图都设计为其前任旁边，直到行尾，此时有一列用于开始下一个 3，依此类推）。

我现在在做什么：

```
 for (int i = 0; i < 9; i++)
        {
            bmpList[i] = getMapFile(sb[i].ToString());
        }

        using (Graphics g = Graphics.FromImage(bmp))
        {
            g.DrawImage(bmpList[0], 256, 0, 256, 256);
            g.DrawImage(bmpList[1], 512, 0, 256, 256);
            g.DrawImage(bmpList[2], 0, 256, 256, 256);
            g.DrawImage(bmpList[3], 256, 256, 256, 256);
            g.DrawImage(bmpList[4], 512, 256, 256, 256);
            g.DrawImage(bmpList[5], 0, 512, 256, 256);
            g.DrawImage(bmpList[6], 256, 512, 256, 256);
            g.DrawImage(bmpList[7], 512, 512, 256, 256);
            g.DrawImage(bmpList[8], 0, 0, 256, 256);
        } 
```

结果是 bmp 只是一个空白图像（当我将其转换为 Image.Source 时，它​​什么也不显示。为了证明其余代码我已经这样做了：

```
 Rectangle rect = new Rectangle();
        rect.Height = 256;
        rect.Width = 512;
        rect.X = 0;
        rect.Y = 0;
        Objects.Colour color = new Objects.Colour();
        color = colourlist[0];
        Graphics.FromImage(bmp).FillRectangle(new SolidBrush(Color.FromArgb(color.r, color.g, color.b)), rect); 
```

它按预期绘制了一个黑色矩形，高度为 256，宽度为 512。我也更改了这些数字以填充矩形，所以这不是问题。

有人知道我在做什么错吗？所有帮助将不胜感激！

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:23:02.827

答案是上面的代码实际上没有任何问题，而且我错误地将文件路径传递给了另一个函数。我的错，还是谢谢！

# java - Java Swing 合集不对？

> ID：14798580
> 
> 赞同：1
> 
> 时间：2013-02-10T14:08:37.240
> 
> 标签：java, swing

我正在编写一个 Java (Swing) 应用程序，我正在尝试将内容存储在`ArrayList`. 我的计划是首先实例化一个类，在该类中设置一些变量，然后将该类添加到`ArrayList`.

所以我有这个类：

```
public class CollectionClass {

private ArrayList<OwnerClass> owners;

public CollectionClass() {

    owners = new ArrayList<OwnerClass>();

}

public void AddOwner(OwnerClass oc) {
    owners.add(oc);
}
 } 
```

而这堂课：

```
public class OwnerClass {
public int id = 0;
public String name = "";
public String employeeNr="";
 } 
```

现在在我的对话框中我有这个：

```
CollectionClass myCC;

public InvoerNewOwner(CollectionClass cc) {

            myCC = cc;
        btSave.setActionListener(new ActionListener() {
        OwnerClass oc = new OwnerClass();

        oc.name = txtOwner.getText();               <<<
        oc.employeeNr = txtEmployeeNr.getText();    <<<

        myCC.addOwner(oc);                            <<<

    }); 
```

在标有 <<< 的 3 行上出现错误。错误是“ `error: <identifier> expected`”

我在这里做错了什么？

这不是创建对象集合的好方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:12:18.930

```
btSave.setActionListener(new ActionListener() {
    @Override
    public void actionPerformed(ActionEvent e) {
        OwnerClass oc = new OwnerClass();

        oc.name = txtOwner.getText();
        oc.employeeNr = txtEmployeeNr.getText();

        myCC.addOwner(oc);
    }
}); 
```

你必须把你想做的所有事情都包装在一个`actionPerformed`事件中。

# html - 让 Gill Sans 在 IE 中正确显示

> ID：14798583
> 
> 赞同：1
> 
> 时间：2013-02-10T14:08:57.337
> 
> 标签：html, css, fonts

我正在开发一个使用 Gill Sans 字体的网站。到目前为止，它在 Chrome 和 Firefox 上都能正常显示，但在 IE 中不能正常显示。这是CSS：

```
@font-face {font-family:"Gill Sans"; 
src:url(../../GillSansStd.otf);}
@font-face {font-family:"Gill Sans"; 
font-weight:bold; src:url(../../GillSansStd-Bold.otf);}
@font-face {font-family:"Gill Sans"; 
font-style:italic; src:url(../../GillSansStd-Italic.otf);} 
```

我尝试将 .otf 转换为 .eot 并为 IE 添加条件语句，但我也无法让它工作。我对字体不太了解，所以请原谅，但如果有人能帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:24:46.617

当使用由两个单词组成的 FONT 类型时，必须在它们上面加上引号，这样浏览器就不会将它们作为单独的条目读取。

```
@font-face {font-family:""Gill Sans""; 
src:url(../../GillSansStd.otf);}
@font-face {font-family:""Gill Sans""; 
font-weight:bold; src:url(../../GillSansStd-Bold.otf);}
@font-face {font-family:""Gill Sans""; 
font-style:italic; src:url(../../GillSansStd-Italic.otf);} 
```

更多示例可以在这里找到：[CSS 字体样式](http://www.htmlite.com/CSS004.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:24:57.740

有关使用 Gills Sans 作为网络字体的[信息](http://www.fonts.com/font/monotype-imaging/gill-sans/roman/web-font)，请参阅 fonts.com 。

请注意，Gill Sans 字体的正常许可不允许用作 Web 字体，并且某些浏览器可能会强制执行此法律限制作为技术限制。

# sql - 从表中将多行插入表中

> ID：14798587
> 
> 赞同：0
> 
> 时间：2013-02-10T14:09:40.090
> 
> 标签：sql, sql-server-2008, tsql, stored-procedures, insert

我有一个 SQL Server 2008 数据库。数据库有一个存储过程，它接收两个字符串作为参数。一个参数用于构建一个临时表，该表通常只有 1 或 2 行，但理论上可以有更多。

对于临时表中的每一行，我需要将一行插入到一个不同的表中，该表由另一个参数和临时表的内容组成。有没有办法在没有光标的情况下做到这一点？

我尝试了以下变体：

伪代码：

```
procedure InsertLinks(@Key varchar(36), @LinkKey varchar(36)

tempLinks Table = getLinks(@LinkKey)

Insert into MyTable (Key, LinksTo) Values (@Key, Select LinksTo From tempLinks) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:11:17.437

该`VALUES`子句搞砸了 - 你有一个单值逗号表。那是无效的。

以下应该可以正常工作：

```
INSERT INTO MyTable (Key, LinksTo) 
SELECT @Key, LinksTo 
FROM tempLinks 
```

# github - Github 页面、HTTP 标头

> ID：14798589
> 
> 赞同：60
> 
> 时间：2013-02-10T14:10:04.283
> 
> 标签：github, http-headers, github-pages

我从我的 Github 页面帐户中提供了一些文件。但是当我检查我的“js”文件的标题时，我看到了以下内容：

```
Last-Modified:Sun, 10 Feb 2013 14:00:46 GMT 
Expires:Sun, 10 Feb 2013 14:13:23 GMT
Cache-Control:max-age=600 
```

该文件于 14 天前提交。但我不会如此频繁地计划这些文件。所以我需要设置更大的 max-age 值并将 Last-Modified 值更改为最后提交的日期。

是否可以更改 Github 页面的标题？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-02-27T20:57:19.217

我向 Github 管理员询问了这个问题，他们告诉我“不可能”更改标题。他们将此问题添加到愿望清单。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-08-02T12:10:01.727

`<meta http-equiv>`答案是否定的，但是我们可以使用标签在 html 页面上激发 html header 。

```
<meta http-equiv="last-modified" content="Sun, 10 Feb 2013 14:00:46 GMT " />
<meta http-equiv="cache-control" content="Private" />
<meta http-equiv="Expires" content="600" /> 
```

您可以将这些片段嵌入到 HTML 页面中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-09-25T12:44:40.360

这适用于所有仍然遇到此问题并从谷歌来到这里的人。

最近遇到了同样的问题。实际上，如果您足够固执并希望使用一些额外的第三方服务，这是可能的。您需要做的是使用带有自定义 nginx buildpack 的免费层 heroku 应用程序。这个 buildpack 可以作为代理传递，它可以根据需要添加/删除 HTTP 标头。

但是，您将失去 GitHub CDN，因此利用另一个服务 - cloudflare 来做到这一点可能是个好主意（并且 SSL 作为奖励）。

如果有人感兴趣，我写了一篇详细设置如何执行此操作的文章：[https](https://www.rzegocki.pl/blog/custom-http-headers-with-github-pages/) ://www.rzegocki.pl/blog/custom-http-headers-with-github-pages/ - 设置非常繁琐但它有效.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-11-22T03:26:55.777

目前在 Github Pages 中是不可能的。您可以将 Github 与[Netlify](https://netlify.com)一起使用。他们让你改变标题。它们还具有不错的功能，例如表单、预渲染等。Github Pages 中都缺少这些。

# iphone - 无法获取超过 10k 条记录

> ID：14798592
> 
> 赞同：3
> 
> 时间：2013-02-10T14:10:53.940
> 
> 标签：iphone, ios, xcode, parse-platform

我正在开发一个应用程序，其中我有超过 10k 条记录添加到解析中的类中。现在我正在尝试使用 PFQuery 获取这些记录（我正在使用“ ***skip*** ”属性）。但我无法获取超过 10k 的记录，并且收到以下错误消息

***“不允许超过 10000 的跳过***”

这对我来说是个大问题，因为我需要所有数据。

有没有人遇到过这样的问题。请分享您的观点。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T18:37:12.363

问题确实是由于 mongo 跳过操作的成本。您可以制定一个不需要跳过运算符的查询。我的首选方法是 orderBy objectId，然后添加 objectId > last yielded objectId 的条件。这种类型的查询可以被索引并保持快速，这与跳过分页不同，后者在查找中具有 O(N^2) 成本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T05:53:50.920

我的假设是它基于 MongoDB 的[跳过](http://docs.mongodb.org/manual/reference/method/cursor.skip/)实现的性能问题。

> cursor.skip() 方法通常很昂贵，因为它要求服务器在开始返回结果之前从集合或索引的开头步行以获取偏移量或跳过位置。随着偏移量（例如上面的 pageNumber）增加，cursor.skip() 将变得更慢并且更占用 CPU。对于较大的集合，cursor.skip() 可能会成为 IO 绑定。

# iphone - MPMoviePlayerViewController 旋转问题

> ID：14798598
> 
> 赞同：0
> 
> 时间：2013-02-10T14:11:04.813
> 
> 标签：iphone, objective-c, video

我在 tabbarcontroller 中有一个“VideoLecturesDetails”，这个类有这个方法

```
-(IBAction) playVideo{
    NSString *fileURL = [NSString stringWithFormat:@"%@" ,FileName];

    NSURL* videoURL = [NSURL URLWithString:fileURL];                
    MPMoviePlayerViewController* theMoviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:videoURL];
    [theMoviePlayer shouldAutorotate];
    [self presentMoviePlayerViewControllerAnimated:theMoviePlayer];
}

-(BOOL)automaticallyForwardAppearanceAndRotationMethodsToChildViewControllers {
    return NO;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{
    return YES;//This allows all orientations, set it to whatever you want
} 
```

所以在播放视频时自动旋转不起作用，我怎样才能使用这种方法启用自动旋转。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:52:54.507

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{
return YES;//This allows all orientations, set it to whatever you want 
```

}

上面的代码在 IOS 6 中不再可用！您应该为使用 IOS 5 或更低版本的应用程序的用户保留它。

在 IOS 6 中，您应该按如下方式实现轮换：

在 appDelegate 中：使用：

```
window.rootViewController = viewController 
```

代替：

```
[window addSubview:viewController.view]; 
```

并添加：

```
- (NSUInteger) application:(UIApplication *)application 

supportedInterfaceOrientationsForWindow:(UIWindow *)window {
return  UIInterfaceOrientationMaskAll;
} 
```

每次旋转时都会发生这种情况。

在您的视图控制器中，您应该添加以下内容：

```
-(BOOL)shouldAutorotate {

    return YES;
}
-(NSUInteger)supportedInterfaceOrientations {

        return UIInterfaceOrientationMaskAllButUpsideDown;
} 
```

# mysql - MySQL，在过去几个小时内返回所有结果

> ID：14798599
> 
> 赞同：1
> 
> 时间：2013-02-10T14:11:07.203
> 
> 标签：mysql, sql

我的表由多个列组成，包括 unixtimestamp：

```
CREATE MyTable(
   id INT NOT NULL AUTO_INCREMENT,
   ...
   timeStart INT(11)
)ENGINE=MyISAM; 
```

新项目不断插入到该表中。

我需要返回所有带有时间戳 > (MAX(startTime)-X_duration) 的项目

我有兴趣编写一个单一且最佳的查询来实现它。

1.  一种简单的方法是编写嵌套选择，其中内部选择返回 , ，然后`MAX(timeStart) as maxTime`选择所有大于 where 子句的记录。

如果有更好、更有效的解决方案，我很感兴趣？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:24:37.880

```
SELECT  *
FROM    tableName
WHERE   timeStart > (SELECT MAX(timeStart) + INTERVAL -1 SECOND FROM tableName) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/12713/4)

# kineticjs - 文本底部对齐

> ID：14798600
> 
> 赞同：0
> 
> 时间：2013-02-10T14:11:09.653
> 
> 标签：kineticjs

我想知道是否可以将文本对齐到底部。如果我使用函数 setY()，它只会将文本移动到确切的位置，但如果文本太长，它会出现在画布之外。你有什么建议？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-11T15:21:55.967

假设您的 Kinetic Stage 对象被调用`stage`并且您的 Kinetic Text 对象被调用`text`：

```
// wrap lines to the full width if you want
text.setWidth(stage.getWidth());

// move text to the bottom
text.setY(stage.getHeight() - text.getHeight()); 
```

基本上，这会把你的文本推到底部，它会“溢出”，所以我们把它提出来。我们也可以通过 y 偏移来实现：

```
// move text to the bottom
text.setY(stage.getHeight());

// offset it up
text.setOffset({ y: text.getHeight() }); 
```

设置宽度将包裹您的文本，以防它太宽而无法容纳在舞台中。

# libgdx - 使用 GL20 时在 LibGdx 中设置点大小

> ID：14798601
> 
> 赞同：1
> 
> 时间：2013-02-10T14:11:11.010
> 
> 标签：libgdx

我需要使用 ShapeRenderer 渲染一些具有指定大小的点。

使用 GL20 时，Gdx.gl 和 Gdx.gl20 将被初始化，而 Gdx.gl10 和 Gdx.gl11 将为空。

我可以使用如下代码设置线宽和渲染：

```
Gdx.gl.glLineWidth(5);
mShapeRenderer.begin(ShapeType.Rectangle);
mShapeRenderer.rect(0.0f, 0.0f, 50.0f, 50.0f);
mShapeRenderer.end(); 
```

但是，据我所知，我只能使用`Gdx.gl10.glPointSize(5)`or设置点大小`Gdx.gl11.glPointSize(5)`- 这在我的情况下不起作用，因为 gl10 和 gl11 都是空的。

这个问题有什么简单的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T03:15:27.357

[OpenGL ES 在 2.0 中放弃了对 glPointSize （除其他外）的支持](https://stackoverflow.com/questions/9426803/glpaint-in-opengl-es-2-0)，这就是为什么您无法在`Gdx.gl20`或 中找到它的原因`Gdx.gl`。

无需设置点大小，只需使用 ShapeRenderer 的 fillCircle 来渲染“大”点。（我会指向 API 文档，但他们上周刚刚更改了 API，我不确定您使用的是哪个版本。）

# javascript - 表单打印结果后 Greasemonkey 不再执行

> ID：14798602
> 
> 赞同：-1
> 
> 时间：2013-02-10T14:11:11.603
> 
> 标签：javascript, jquery, forms, greasemonkey

我正在使用greasemonkey 来操作现有网页上的表单。（自动填充）

表单的 action 属性是它本身，一旦提交，它会在提交按钮上方打印一条成功消息。

我想要做的是，一旦提交表单 - 我想将浏览器重定向到另一个页面。但这不适用于greasemonkey。什么都没发生。

我写了一个代码来检测页面何时提交，但在表单提交后不起作用。

```
getData("goingback"); //pulls the goingback data from database using ajax

if (goingback == "yes") {
    window.location = "index.php";
} else {
//business as usual

 // manipulate the form and get it ready for submission

sendPost("goback","yes"); // this function sends data to a php to be handled via ajax

//ajax stores the data in database

//the form is submitted using a timer and .click();

var submission = Math.floor(Math.random() * 10000) + 5000;
setTimeout(function() {
$('button[value="submit"]:first').click();
}, submission);
} 
```

我怎样才能做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T20:03:07.280

问题不清楚；我们可能需要查看实际页面本身。但是，听起来页面是通过 AJAX 提交表单，而不是完整的帖子。

在这种情况下，您的脚本不会重新启动。相反，请监视页面以获取成功消息。这是一种方法：

假设成功消息是这样的：

```
<div id="post_status">
    <h2>Some one set us up the (data) bomb!</h2>
</div> 
```

在`<h2>`表单帖子之后添加的位置。

然后此代码将在帖子发生后重定向：

```
var postChkTimer = setInterval (checkForPostDoneNode, 200);

function checkForPostDoneNode () {
    var postDoneNode = $("#post_status h2");
    if (postDoneNode.length) {
        window.location.assign ("index.php");
    }
} 
```

不需要那个`getData("goingback")` or `sendPost("goback","yes")`。看起来*它*正在设置`goback`但正在*检查* `goingback`- 这可能是一个问题。尽管这不是导致问题中描述的行为的问题。

# c++ - C\C++ 中的简单翻转缓冲区（垂直）问题

> ID：14798604
> 
> 赞同：2
> 
> 时间：2013-02-10T14:11:30.930
> 
> 标签：c++, c, pixels, memcpy, flip

我正在尝试翻转缓冲区，但缓冲区没有得到完全处理。是像素缓冲区，我基本上需要垂直翻转它。谁能发现我做错了什么？提前致谢。

```
void flipVertically(unsigned int* buffer, const unsigned int width, const unsigned int height)
{
    const unsigned int rowWidth = width; // Length of a row
    const unsigned int rows = height / 2; // Iterate only half the buffer to get a full flip
    unsigned int* tempRow = (unsigned int*)malloc(rowWidth);

    for (int rowIndex = 0; rowIndex < rows; rowIndex++)
    {
        memcpy(tempRow, buffer + (rowIndex * rowWidth), rowWidth);
        memcpy(buffer + (rowIndex * rowWidth), buffer + (height - rowIndex - 1) * rowWidth, rowWidth);
        memcpy(buffer + (height - rowIndex - 1) * rowWidth, tempRow, rowWidth);
    }

    free(tempRow);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T14:32:21.340

这行得通吗？

```
void flip(unsigned* buffer, unsigned width, unsigned height)
{
    unsigned rows = height / 2; // Iterate only half the buffer to get a full flip
    unsigned* tempRow = (unsigned*)malloc(width * sizeof(unsigned));

    for (unsigned rowIndex = 0; rowIndex < rows; rowIndex++)
    {
        memcpy(tempRow, buffer + rowIndex * width, width * sizeof(unsigned));
        memcpy(buffer + rowIndex * width, buffer + (height - rowIndex - 1) * width, width * sizeof(unsigned));
        memcpy(buffer + (height - rowIndex - 1) * width, tempRow, width * sizeof(unsigned));
    }

    free(tempRow);
} 
```

# android - Android：当我使用 scrollTo(x,y) 滚动 ListView 时，ListView 不会重绘

> ID：14798607
> 
> 赞同：1
> 
> 时间：2013-02-10T14:11:42.707
> 
> 标签：android, listview

1.  我的 ListView 在后台（使用相对布局）。
2.  我有一个文本框，用作 ListView 中的视图，为不同的行设置不同的背景颜色。这是使用适配器中的以下代码完成的。

    ```
    public View getView(int position, View convertView, ViewGroup parent)
    {

        View rowView = convertView;

        if (rowView == null)
        {
            LayoutInflater inflater = ((Activity)context).getLayoutInflater();
            rowView = inflater.inflate(R.layout.listview_background, null);
            rowView.setTag(new ViewHolder((TextView) rowView.findViewById(R.id.listBackgroundTV)));
        }

        ((ViewHolder)rowView.getTag()).tv.setHeight((position != 0)?((CompareTextBox)((Activity)context).findViewById(R.id.ctb1)).getLineHeight():((CompareTextBox)((Activity)context).findViewById(R.id.ctb1)).getLineHeight() + (int) (context.getResources().getDisplayMetrics().density + 0.5f));
        ((ViewHolder)rowView.getTag()).tv.setBackgroundColor((b[position])?0xff000000:0xffffffff);

        return rowView;
    } 
    ```

所以你看到文本框的背景颜色是使用位置设置的。

3.  现在我使用 ListView.scrollTo(x,y) 函数向上滚动 ListView。
4.  现在，由于文本框的背景是根据位置计算的，当 ListView 向上滚动时，应该为显示的新行显示文本框的正确颜色。但这并没有发生。ListView 中由于向上滚动而暴露的所有项目都具有相同的黑色背景。

任何想法，如何刷新/重绘 ListView 视图，或者上面代码中发现的任何问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:58:15.280

`ListView`您可以通过调用[`notifyDataSetChanged()`](http://developer.android.com/reference/android/widget/BaseAdapter.html#notifyDataSetChanged%28%29)适配器的方法来刷新。您可以尝试在 之后调用它`scrollTo`，即使通常应该在底层数据集更改以刷新视图项时调用它。

# java - 我如何进行这项工作并在退出时保存并在重新加载时恢复

> ID：14798608
> 
> 赞同：1
> 
> 时间：2013-02-10T14:12:08.500
> 
> 标签：java, android, function, save

现在我的按钮计数器工作了，点击时它会增加，但我现在的问题是它不会保存，所以当它重新打开时它会重新开始......我把我的代码放在下面，但任何帮助添加保存功能都会不胜感激！

```
package com.example.counter;

import android.app.Activity; import android.os.Bundle; import android.view.View; import         android.view.View.OnClickListener; import android.widget.Button; import     android.widget.TextView;

public class MainActivity extends Activity {

// Private member field to keep track of the count
private int mCount = 0;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);

final TextView countTextView = (TextView) findViewById(R.id.TextViewCount);
final Button countButton = (Button) findViewById(R.id.ButtonCount);

countButton.setOnClickListener(new OnClickListener() {

    public void onClick(View v) {
        mCount++;
        countTextView.setText("Count: " + mCount);
    }
});

}
} 
```

xml布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/TextViewCount"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world" />

<Button
    android:id="@+id/ButtonCount"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/ButtonCount"
    android:layout_alignRight="@+id/ButtonCount"
    android:layout_marginBottom="61dp"
    android:text="Count" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:16:34.113

重载 onPause 方法并使用 SharedPreferences 类保存变量。您还需要重载 onResume 方法以将该值重新加载到 mCount 中。

请阅读：http: [//developer.android.com/training/basics/activity-lifecycle/pausing.html](http://developer.android.com/training/basics/activity-lifecycle/pausing.html)

```
public static final String PREFS_NAME = "com.example.myApp.mCount";
private SharedPreferences settings = getSharedPreferences(PREFS_NAME, MODE_PRIVATE);
private SharedPreferences.Editor editor = settings.edit();

@Override
public void onPause() {
    super.onPause();  // Always call the superclass method first
    mCount = settings.getInt("mCount", 0);
}

@Override
public void onResume() {
    super.onResume();  // Always call the superclass method first
    editor.putInt("mCount", mCount);
    editor.commit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:17:24.737

此链接将为您提供帮助。它是存储数据的最简单方法 [http://developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)

您将在 onCreate 读取计数器数据并将其保存在 onPause 以便当您的用户再次打开应用程序时它可以很好地恢复。更多详情请访问[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

不要在每次单击按钮时保存计数器，它会为您的简单任务带来过多的 I/O，从而耗尽电池。

# javascript - 按零件名称获取班级编号

> ID：14798609
> 
> 赞同：2
> 
> 时间：2013-02-10T14:12:11.883
> 
> 标签：javascript, jquery, regex, string, replace

我有以下元素：

```
<ul id="towns">
    <li class="clearfix odd 516_499_132_0_0 town132">...</li>
</ul> 
```

我需要为一个参数提取类“town132”，但数字（例如 132）是可变的。

我该如何提取？

```
$('#towns').children('li').each(function() {
    parameter = $(this). // ???
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:14:03.440

如果您知道课程将永远在那里：

```
parameter = this.className.match(/town(\d+)/)[1]; 
```

除此以外：

```
var m = this.className.match(/town(\d+)/);
if (m) {
    parameter = m[1];
} 
```

# machine-learning - 考虑上下文的 机器学习算法

> ID：14798611
> 
> 赞同：-1
> 
> 时间：2013-02-10T14:12:26.393
> 
> 标签：machine-learning, cluster-computing, classification, intrusion-detection

我是机器学习的初学者。到目前为止，我看到的算法几乎可以衡量一个记录（众多字段）与数据集中其他记录（例如 k-means）的差异。

我正在尝试将一些 ml 算法应用于网络入侵检测，但我认为此类算法可能不合适，因为它们将记录视为单个实体，而不是记录上下文中的记录（即跟随或跟随特定记录）。例如，对应于同步数据包的记录在正常流量的记录中存在时可能是正常的，但如果该记录存​​在于许多其他同步记录中，那么我们可能正在处理同步泛洪攻击。这只是一个例子……我希望我说清楚。

有没有具有这种能力的算法？如果是这样，任何人都可以指点？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:15:04.590

您需要检查有状态的方法，例如隐马尔可夫模型或卡尔曼滤波器，它们确实考虑了 contrxt。

或者，您可以创建先前值的长向量并使用它来推断上下文，但 HMM 是普遍采用的方法，并且具有许多理论和实践优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:15:13.777

你在正确的区域。我认为您对分类算法感兴趣，而不是聚类。

对您拥有的数据进行聚类可以让您了解哪些特征是重要的。但它的分类允许你决定一个请求是否是敌对的。它与垃圾邮件过滤有更多共同点。

# performance - Data.Sequence.Seq 与 [] 相比有多快？

> ID：14798613
> 
> 赞同：13
> 
> 时间：2013-02-10T14:12:49.450
> 
> 标签：performance, list, haskell, finger-tree

显然`Seq`渐近地执行与所有可能的操作相同或更好`[]`的操作。但是由于它的结构比列表更复杂，对于小尺寸，它的恒定开销可能会使其变慢。我想知道多少钱，特别是：

1.  `<|`相比慢了`:`多少？
2.  `Seq`与折叠/遍历相比，折叠/遍历慢了多少`[]`（不包括折叠/遍历函数的成本）？
3.  `\xs x -> xs ++ [x]`变慢的大小（大约）是`|>`多少？
4.  `++`变慢的大小（大约）是`><`多少？
5.  `viewl`与列表上的模式匹配相比，结果上的调用和模式匹配的成本是多少？
6.  与-元素列表相比，-元素占用`n`多少内存？（不计算元素占用的内存，只计算结构。）`Seq``n`

我知道这很难衡量，因为`Seq`我们谈论的是摊销复杂性，但我想至少知道一些粗略的数字。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T14:46:35.880

这应该是一个开始 - [http://www.haskell.org/haskellwiki/Performance#Data.Sequence_vs._lists](http://www.haskell.org/haskellwiki/Performance#Data.Sequence_vs._lists)

一个序列使用的空间是等效列表的 5/6 到 4/3 倍（假设每个节点一个字的开销，如在 GHC 中）。如果只使用 deque 操作，空间使用量将接近范围的下限，因为所有内部节点都是三元的。大量使用 split 和 append 将导致序列使用与列表大致相同的空间。详细地：

*   一个长度为 n 的列表由 n 个 cons 节点组成，每个节点占用 3 个单词。
*   长度为 n 的序列具有大约 n/(k-1) 个节点，其中 k 是内部节点的平均数量（每个 2 或 3）。每个节点都有一个指针、一个大小和开销，以及每个元素的一个指针，即 n(3/(k-1) + 1) 个字。

对于头部（cons 和 head）的操作，List 是一个非常重要的常数因子，使其成为类堆栈和类流访问模式的更有效选择。Data.Sequence 对于其他所有访问模式（例如队列和随机访问）都更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-31T16:44:09.940

我有一个更具体的结果要添加到上述答案中。我正在求解一个朗之万方程。我使用了 List 和 Data.Sequence。此解决方案中正在进行列表/序列后面的大量插入。

总而言之，我没有看到速度有任何提高，实际上使用序列时性能下降了。此外，使用 Data.Sequence，我需要增加 Haskell RTS 的可用内存。

因为我绝对不是优化的权威；我在下面发布了这两种情况。我很高兴知道这是否可以改进。`-O2`两个代码都是用标志编译的。

1.  [使用 List 的解决方案](https://github.com/dilawar/Courses/blob/d70d9cd025ce19f28f8d0f2a01c7e361cdf9d8dc/RandomnessInBiology_Monsoon_2014/Assignment07/solve.hs)，大约需要 13.01 秒
2.  [使用 Data.Sequence 的解决方案](https://github.com/dilawar/Courses/blob/cc9eff7d3270a9fc64dddc0591bfb43668ef4805/RandomnessInBiology_Monsoon_2014/Assignment07/solve.hs)，大约需要 15.13 秒

# c++ - C ++中树结构上的自定义迭代器

> ID：14798614
> 
> 赞同：0
> 
> 时间：2013-02-10T14:13:07.467
> 
> 标签：c++, tree

我正在用 C++ 实现一个树结构，它有一个像这样的节点类：

```
class Node {
protected:
    // relations
    Node *_parent;
    std::vector<Node*> _children;

public:
    // some example method 
    void someMethod(Node *node) {

        // do something with *node

        for (int i = 0; i < node->_children; i++) {
            _children[i]->myFunction;
        }
    }
} 
```

现在，要在树中的节点上工作，我正在实现递归函数，就像`someMethod`我的示例中一样。

它可以工作，但我最终为每个在我的树上工作的新函数一遍又一遍地编写相同的递归代码。

有没有像在普通数组上那样迭代树结构的通用方法？一些返回下一个对象的方法，直到我完成整个分支。

**编辑：**

感谢迄今为止发表评论的所有人，在您的帮助下，我可以缩小问题的范围。根据我的理解（我是 C++ 新手），我需要一个迭代器类来封装用于遍历我的树的代码。

访问所有树成员应该很简单：

```
for (Node<Node*>::iterator it = _node.begin(); it != _node.end(); ++it) {
    Node *node = *it;
    // do something with *node
} 
```

现在的问题是：

如何实现这样的迭代器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:22:52.290

将函数指针传递给返回您正在寻找的节点的递归函数。

这就是 C/C++ 中函数指针和函数指针数组的强大之处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:29:22.637

许多函数不会简单地遍历所有节点，如果树（通常）是排序的，那么要找到最大值，您只会在右子树中查找。

如果您搜索最小值，它位于最左边的子树中。

因此，拥有一个迭代整个树的迭代器并不总是有意义的。
但是，如果您需要精确地遍历所有节点，则可以使用函数指针或访问者模式（Erich Gamma，设计模式）。

# android - 如何使用 onTouch 事件在 android 中绘制或编写类似 MS-Paint 的文本？

> ID：14798615
> 
> 赞同：0
> 
> 时间：2013-02-10T14:13:11.893
> 
> 标签：android, canvas, touch, paint, motionevent

我创建了面板，其中包含不同颜色、铅笔、橡皮擦和类似于 MS-Paint 的不同形状。我可以使用 Touch Event 方法在屏幕上绘图或书写。但是当我在屏幕上画一些东西时（当我触摸屏幕时），MotionEvent.ACTION_Down 方法正在调用。所以它工作正常。当我从屏幕上松开手指时，MotionEvent.ACTION_up 方法正在调用并且工作正常。

所以，我的问题是，就像 MS-PAINT 一样，在我从屏幕上松开手指之前，我无法看到我画或写的东西。例如，请参阅[此视频](http://www.youtube.com/watch?v=v65AUWyfjo0)。用户可以看到他何时拖动形状或尝试绘制铅笔。此外，在此链接中，用户使用铅笔绘图，无需在屏幕上松开手指即可看到。

但是，当我在屏幕上画一些东西时，一旦我松开手指，它就会出现。

我需要的是，当用户触摸屏幕本身时，如果他/她在屏幕上移动手指，用户必须能够看到他们试图在屏幕上绘制或书写的内容。

例如：如果我尝试在屏幕上写一些像“Apple”这样的词，我会尝试输入“A”。但是当我写字母“A”时，除非我将手指从屏幕上移开，否则它是不可见的。有一次，如果我在画完字母“A”后将手指从屏幕上松开，那么屏幕上只会出现我所画的文字或图片。

所以，我已经完成了 MotionEvent.ACTION_DOWN 和 MotionEVent.ACTION_UP。它工作正常。

但是，MotionEvent.ACTION_MOVE 根本无法正常工作。

这是我的代码，

```
 @Override
 public boolean onTouchEvent(MotionEvent event) 
 {
 if(event.getAction() == MotionEvent.ACTION_DOWN)
 {
 if(Shape == ShapeLine)
 {
 GraphicObject = new Line();
 ((Line) GraphicObject).getBegin().setX(event.getX());
 ((Line) GraphicObject).getBegin().setY(event.getY());
 }
 if(Shape== ShapeRect)
  { 
  GraphicObject = new Rectangle();
  Point temp = new Point(event.getX(), event.getY());
  endPoint = new Point();
  ((Rectangle) GraphicObject).settemppointOfOneEndRectangle(temp);
  }
 else if(event.getAction() == MotionEvent.ACTION_MOVE){
if(Shape== ShapeLine)
{
final float x=event.getX();
final float y=event.getY();     
}
if(Shape == ShapeRect)
{
 endPoint.x=event.getX();
 endPoint.y=event.getY();
 invalidate();
 } 
```

任何人都建议我，关于 ACTION_MOVE。我在代码中尝试了很多，但没有更改，移动时也没有找到任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:20:56.167

基本思想是，当您在变量中点击记录该点时，然后在 ACTION_MOVE 中记录当前点并在这两个点之间画一条线。完成后将此点保存在前一点中。须藤代码：

```
Point last;
Point current;
...
case ACTION_DOWN:
      last=mouse.position;
      break;
case ACTION_MOVE:
      current=mouse.position;
      drawLine(current,last);
      last=current;
      break; 
```

这样做，你的画应该​​没问题。NB 请记住，这是一个 sudo 代码。:P

编辑。我的一个应用程序的示例。基本上我指出了你应该做什么：

```
public boolean onTouchEvent(MotionEvent event)
    {
        int action = event.getAction();
        switch(action & MotionEvent.ACTION_MASK)
        {

            case MotionEvent.ACTION_DOWN:
                initial.x=(int)event.getX();
                initial.y=(int)event.getY();
                break;
            case MotionEvent.ACTION_MOVE:
                current.x=(int)event.getX();
                current.y=(int)event.getY();
                //draw line using initial as start and current as end point
                //sudo code: drawLine(initial,current)
                //now set initial to current
                initial=current// for the continuity of drawing.
                break;
        }
        return true;
    } 
```

**initial**和**current**都是 Point 对象。

# c - CFDataCreateWithBytesNoCopy() 不能与“const char var[xx]”一起使用，但可以与 malloc 一起使用？

> ID：14798618
> 
> 赞同：0
> 
> 时间：2013-02-10T14:13:46.047
> 
> 标签：c, pointers, malloc, core-foundation

只是真的在寻找以下的解释，如果变量**摘要**不是手动分配的，那么 **CFDataCreateWithBytesNoCopy()**返回的数据在整个程序中引用时会不断变化。

```
CFDataRef sha1(CFStringRef string)
{
    unsigned char* digest = malloc(CC_SHA1_DIGEST_LENGTH);

    const char* cData  = CFStringGetCStringPtr(string, CFStringGetFastestEncoding(string));
    CC_SHA1(cData, strlen(cData), digest);
    CFDataRef sha = CFDataCreateWithBytesNoCopy(kCFAllocatorDefault, digest, CC_SHA1_DIGEST_LENGTH, kCFAllocatorDefault);
    free(digest);
    CFRelease(string);
    return sha;
} 
```

因为这行不通...

```
CFDataRef sha1(CFStringRef string)
{
    unsigned char digest[CC_SHA1_DIGEST_LENGTH];

    const char* cData  = CFStringGetCStringPtr(string, CFStringGetFastestEncoding(string));
    CC_SHA1(cData, strlen(cData), digest);
    CFDataRef sha = CFDataCreateWithBytesNoCopy(kCFAllocatorDefault, digest, CC_SHA1_DIGEST_LENGTH, kCFAllocatorDefault);
    return sha;
} 
```

顶部代码中是否还有内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:29:58.503

[CFDataCreateWithBytesNoCopy](https://developer.apple.com/library/mac/#documentation/CoreFOundation/Reference/CFDataRef/Reference/reference.html)的第二个参数是*“指向用作 CFData 对象后备存储的字节缓冲区的指针”*，在讨论部分，您会发现*“创建的对象不会将外部缓冲区复制到内部存储，而是使用缓冲区作为其后备存储”*。

现在在您的代码`unsigned char digest[CC_SHA1_DIGEST_LENGTH];`中是一个具有自动存储持续时间的数组，这意味着一旦执行离开定义它的范围，它就会被释放。

请注意，文档还指出，*当 CFData 对象被解除分配时**，外部缓冲区*被解除分配。

# php - 在php中使用ajax发送多个请求

> ID：14798621
> 
> 赞同：-1
> 
> 时间：2013-02-10T14:13:57.593
> 
> 标签：php, ajax

我正在尝试使用 php 脚本将推送通知发送到 android 设备。如果我每次将它发送到一台设备，这工作正常，但我有超过 1000 台设备并且想一次将它发送给所有设备。我尝试使用循环，但它不起作用。

```
<script type="text/javascript"> 
            $(document).ready(function(){ 

            }); 

            function sendToAll(totalUsers){

                for(var i=0;i<totalUsers;i++)
                {
                    sendPushNotification(i);
                }

            }
            function sendPushNotification(id){ 
                var data = $('form#1').serialize(); 
                $('form#1').unbind('submit'); 
                $.ajax({ 
                    url: "send_message.php", 
                    type: 'GET', 
                    data: data, 
                    beforeSend: function() { 

                    }, 
                    success: function(data, textStatus, xhr) { 
                          $('.txt_message').val("");
                          $('.txt_excerpt').val("");    
                    }, 
                    error: function(xhr, textStatus, errorThrown) { 

                    } 
                }); 
                return false; 
            } 
        </script> 
```

这是我的 HTML 表单。$no_of_users 变量包含在选择查询中获取的总行数，即表中的用户总数。

```
<form id="1" name="" method="post" onsubmit="return sendToAll('<?php echo $no_of_users; ?>')"> 
                                <label>Send Message to All the Users</label> 
                                <div class="clear"></div> 
                                <div class="send_container"> 
                                    <textarea rows="3" name="excerpt" cols="10" class="txt_excerpt" placeholder="Type excerpt here"></textarea>
                                    <textarea rows="3" name="message" cols="25" class="txt_message" placeholder="Type message here"></textarea> 

                                    <input type="submit" class="send_btn" value="Send" onclick=""/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:37:46.730

您应该使用异步请求在“同时”进行所有操作，在您的 ajax 调用中使用此指令：

```
async: true, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:46:57.367

您想将一些消息推送到大约。来自服务器的 1000 台设备。并且您想使用您在问题中提供的表单和脚本来启动此操作。但是您还必须考虑服务器如何与设备通信的方式。您的服务器必须有某种方式可以访问客户端。

一种方法 - 例如，指示您的客户端每 N 秒轮询一次服务器以获取新消息。这会产生不必要的流量并加载服务器。

第二种方式 - 在客户端上使用 websocket 并为此提供服务器端支持。它可能不像看起来那么微不足道

还有一种方法 - 是使用长轮询。

无论如何-必须以某种方式指示设备如何从服务器接收推送消息。

# ruby - 为什么括号改变返回值？

> ID：14798624
> 
> 赞同：1
> 
> 时间：2013-02-10T14:14:14.733
> 
> 标签：ruby

我正在学习红宝石，但遇到了可能很简单的问题。有代码：

```
str = 'abc'
a = 1
b = 2
a = str.reverse if str.size > 3
b = (str.reverse if str.size > 3)
p a
p b 
```

输出：

```
1
nil 
```

有人能告诉我这些括号在返回值上有什么变化吗？
它是一种代码“块”吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T14:16:38.683

它们是两种不同的说法。

第一个是条件赋值：

```
a = str.reverse if str.size > 3 
```

`if`适用于整行。如果`str.size`不大于 3，那么绝对不会发生任何事情；`a`完全没有被触动。你也可以这样写：

```
if str.size > 3 then 
  a = str.reverse
end 
```

能够坚持`if`到底只是让你在一行而不是一个块中完成它。

第二个是条件值的赋值。

```
b = (str.reverse if str.size > 3) 
```

在这种情况下，值`b`总是会改变，无论如何；just的值`str.size`决定了它变成*了*什么。您也可以使用`if`这里的块形式：

```
b = if str.size > 3 then 
  str.reverse
end 
```

重要的区别是赋值`b`发生在 之外`if`，所以它不是有条件的；它总是发生。

括号不会创建块，但它们确实确定优先级。每当您有一个可以根据事情发生的顺序以多种方式解释的语句时，实际发生的事情由优先规则决定。例如，标准算术规则告诉我们这是真的：

```
3 + 2 × 4 = 11 
```

答案不是 20，因为乘法优先于加法。括号可以让你改变它；以上等价于

```
3 + (2 × 4) = 11 
```

如果你希望答案是 20，那么你可以这样写：

```
(3 + 2) × 4 = 20 
```

Ruby 也是如此。没有括号，第一行相当于这个带括号的版本：

```
(a = str.reverse) if str.size > 3 
```

这清楚地表明，分配是由条件保护的，而不仅仅是被分配的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T15:12:00.693

括号将在操作过程中改变优先级。由于其作为条件表达式的状态，括号之间的代码将被评估为布尔值。就像@Mark Reed 所说，有不同的说法。使用正确的取决于您的意图。希望它有所帮助。;)

# c# - 使用 Linq C# 从具有特定属性的特定 xml 标记中查询值

> ID：14798629
> 
> 赞同：0
> 
> 时间：2013-02-10T14:14:29.283
> 
> 标签：c#, xml, linq

我有这个 xml 文件，我试图从中获取一些标签。
这是事情......我想提取具有特定属性和特定值的标签......

这是一个例子

```
<root>
    <input class="x">Data</input>
    <input>Data2</input>
    <input name="y">Data3</input>
    <input class="z">Data4</input>
</root> 
```

我想获取所有具有“类”属性的“输入”标签。

```
List<XElement> selected = xmlDoc.Descendants("input").Where(t => t.Element("input").Attributes("class") != null).ToList(); 
```

但它在 lambda 表达式中给了我一个空引用异常......你能帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:19:05.170

你会想要这个

```
List<XElement> selected = xmlDoc.Descendants("input").Where(t => t.Attribute("class") != null).ToList(); 
```

您试图查看输入节点内的输入节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:21:04.400

`t.Attributes("class")`永远不会返回null。改用`t.Attribute("class")`（或`.Where(t => t.Attributes("class").Any())`）。

你也不需要`t.Element("input")`

```
var selected = xmlDoc.Descendants("input")
                      .Where(t => t.Attribute("class") != null)
                      .ToList(); 
```

或者干脆

```
var selected = xmlDoc.XPathSelectElements("//input[@class]").ToList(); 
```

在 XPATH 的帮助下

# xamarin.ios - 只有 UITableViewCell 中的最后一个 UISwitch 触发

> ID：14798634
> 
> 赞同：0
> 
> 时间：2013-02-10T14:15:25.610
> 
> 标签：xamarin.ios

我正在尝试在每个单元格中添加一个 UISwitch （这有效）。当我点击以切换除最后一个开关之外的任何开关时，它们都会给出最后一个开关状态，直到我更改最后一个开关状态

```
 `public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath) {
            //---- declare vars
            UITableViewCell cell = tableView.DequeueReusableCell (this._cellIdentifier);

            //---- if there are no cells to reuse, create a new one
            if (cell == null) {
                // This changes the style of the UITableViewCell to the Default style
                cell = new UITableViewCell (UITableViewCellStyle.Default, this._cellIdentifier);

                // Instantiate a cell accessory here
                uiSwitch = new UISwitch (new RectangleF (0f, 0f, 20f, 20f));
                uiSwitch.Tag = indexPath.Row;
                uiSwitch.ValueChanged += (object sender, EventArgs e) => {
                    Console.WriteLine ("Cell Switch value is now {0}", uiSwitch.On);
                };
                _vRMs.View.AddSubview (uiSwitch);

                // keep a reference to each cell you create,
                //  e.g. add them to a static List<UITableViewCell>.
                //  The GC won't be able to collect them so the event handler will work later.
                cells.Add (cell);
            }

            //---- create a shortcut to our item
            TableViewItem item = this._TableViewItemGroupList[indexPath.Section].Items[indexPath.Row];

            cell.TextLabel.Text = item.Name;
            cell.Accessory = UITableViewCellAccessory.DisclosureIndicator;
            cell.AccessoryView = uiSwitch;
            // cell.DetailTextLabel.Text = item.SubHeading;

            return cell;
        }` 
```

我想知道所有这些代码是否对于使用 UISwitches 创建一个表是必要的——对于 iPhone 开发世界来说是新手，我不确定。我希望此更新将有助于我的事业。

```
`using System;
using System.Drawing;
using System.Collections.Generic;

using MonoTouch.Foundation;
using MonoTouch.UIKit;

namespace eOneRaw {
    public partial class vRMs : UIViewController {

        #region FIELDS
        private string _ViewTitle = "RMs";
        private UITableView _TableView;
        private TableViewDataSource _TableViewDataSource;
        private List<TableViewItemGroup> _TableViewItemGroupList;
        private static vRMs _vRMs;
        #endregion      

        #region PROPERTIES
#endregion

        #region ViewDidLoad
        public override void ViewDidLoad () {
            base.ViewDidLoad ();

            // Title the Controller
            Title = _ViewTitle;

            #region UITableView Setup
            // Set up the table and data
            this.CreateTableItems ();

            // Create the UITableView
            _TableView = new UITableView() {
                Delegate = new TableViewDelegate(_TableViewItemGroupList),
                DataSource = _TableViewDataSource,
                AutoresizingMask = UIViewAutoresizing.FlexibleHeight | UIViewAutoresizing.FlexibleWidth,
            };

            _TableView.SizeToFit();

            // Reposition and resize the receiver
            _TableView.Frame = new RectangleF (0, 0, this.View.Frame.Width, this.View.Frame.Height);

            // Add the table view as a subview
            this.View.AddSubview(_TableView);
#endregion

            #region Define the Look of the View
            var _barbtnCancel = new UIBarButtonItem(UIBarButtonSystemItem.Done);
            NavigationItem.LeftBarButtonItem = _barbtnCancel;

            _barbtnCancel.Clicked += (s, e) => {
                this.NavigationController.PopViewControllerAnimated(true);
            };
#endregion

        } // end ViewDidLoad
#endregion

        #region METHODS
        public vRMs () {
            // Shouldn't ever happen
            _vRMs = this;
            Console.WriteLine (Environment.StackTrace);
        }

        public override void DidReceiveMemoryWarning () {
            // Releases the view if it doesn't have a superview.
            base.DidReceiveMemoryWarning ();

            // Release any cached data, images, etc that aren't in use.
        }
#endregion

        #region ALL TABLE FUNCTIONALITY

        #region CreateTableItems
        //========================================================================
        /// <summary>
        /// Creates a set of table items.
        /// </summary>
        // This is where you define your table
        protected void CreateTableItems () {
            _TableViewItemGroupList = new List<TableViewItemGroup> ();

            //---- declare vars
            TableViewItemGroup tGroup;

            tGroup = new TableViewItemGroup() { Name = "Regional Managers" };
            tGroup.Items.Add (new TableViewItem() { Name = "Chris" });
            tGroup.Items.Add (new TableViewItem() { Name = "Mike" });
            tGroup.Items.Add (new TableViewItem() { Name = "Dan" });
            tGroup.Items.Add (new TableViewItem() { Name = "Steve" });
            _TableViewItemGroupList.Add (tGroup);

            this._TableViewDataSource = new TableViewDataSource(_TableViewItemGroupList);
        }
#endregion

        #region CLASS TableViewDelegate
        // The delegate manages the transitions from view-to-view
        private class TableViewDelegate : UITableViewDelegate {
            private List<TableViewItemGroup> _TableViewItemGroupList;

            public TableViewDelegate(List<TableViewItemGroup> pList) {
                this._TableViewItemGroupList = pList;
            }

            public override void RowSelected (UITableView tableView, NSIndexPath indexPath) {
                return;
            }
        }
#endregion

        #region CLASS TableViewDataSource
        public class TableViewDataSource : UITableViewDataSource {

            protected List<TableViewItemGroup> _TableViewItemGroupList;
            string _cellIdentifier = "TableViewCell";
            private static UISwitch uiSwitch;
            static List<UITableViewCell> cells = new List<UITableViewCell> ();

            public TableViewDataSource (List<TableViewItemGroup> items) {
                this._TableViewItemGroupList = items;
            }

            /// <summary>
            /// Called by the TableView to determine how many sections(groups) there are.
            /// </summary>
            public override int NumberOfSections (UITableView tableView) {
                return this._TableViewItemGroupList.Count;
            }

            /// <summary>
            /// Called by the TableView to determine how many cells to create for that particular section.
            /// </summary>
            public override int RowsInSection (UITableView tableview, int section) {
                return this._TableViewItemGroupList[section].Items.Count;
            }

            /// <summary>
            /// Called by the TableView to retrieve the header text for the particular section(group)
            /// </summary>
            public override string TitleForHeader (UITableView tableView, int section) {
                return this._TableViewItemGroupList[section].Name;
            }

            /// <summary>
            /// Called by the TableView to retrieve the footer text for the particular section(group)
            /// </summary>
            public override string TitleForFooter (UITableView tableView, int section) {
                return this._TableViewItemGroupList[section].Footer;
            }

            #region UITableViewCell
            /// <summary>
            /// Called by the TableView to get the actual UITableViewCell to render for the particular section and row
            /// </summary>
            public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath) {
                //---- declare vars
                UITableViewCell cell = tableView.DequeueReusableCell (this._cellIdentifier);

                //---- if there are no cells to reuse, create a new one
                if (cell == null) {
                    // This changes the style of the UITableViewCell to the Default style
                    cell = new UITableViewCell (UITableViewCellStyle.Default, this._cellIdentifier);

                    // This changes the style of the UITableViewCell to the Subtitle style,
                    //  which displays a second line of text within the cell.
                    // cell = new UITableViewCell (UITableViewCellStyle.Subtitle, this._cellIdentifier);

                    // Instantiate a cell accessory here
                    uiSwitch = new UISwitch (new RectangleF (0f, 0f, 20f, 20f));
                    uiSwitch.Tag = indexPath.Row;
                    uiSwitch.ValueChanged += (object sender, EventArgs e) => {
                        Console.WriteLine ("Cell Switch value is now {0}", uiSwitch.On);
                    };
                    _vRMs.View.AddSubview (uiSwitch);

                    // keep a reference to each cell you create,
                    //  e.g. add them to a static List<UITableViewCell>.
                    //  The GC won't be able to collect them so the event handler will work later.
                    cells.Add (cell);
                }

                //---- create a shortcut to our item
                TableViewItem item = this._TableViewItemGroupList[indexPath.Section].Items[indexPath.Row];

                cell.TextLabel.Text = item.Name;
                cell.Accessory = UITableViewCellAccessory.DisclosureIndicator;
                cell.AccessoryView = uiSwitch;
                // cell.DetailTextLabel.Text = item.SubHeading;

                // Add an image if needed
                /*
                if(!string.IsNullOrEmpty(item.ImageName))
                {
                    cell.ImageView.Image = UIImage.FromFile("Images/" + item.ImageName );
                }
                */

                return cell;
            }
#endregion
        } // end TableViewDataSource Class
#endregion

        #region CLASS TableViewItemGroup
        //========================================================================
        /// <summary>
        /// A group that contains table items
        /// </summary>
        public class TableViewItemGroup {
            public string Name { get; set; }
            public string Footer { get; set; }

            public List<TableViewItem> Items {
                get { return this._items; }
                set { this._items = value; }
            }

            protected List<TableViewItem> _items = new List<TableViewItem>();

            public TableViewItemGroup () {
            }
        }
#endregion

        #region CLASS TableViewItem
        //========================================================================
        /// <summary>
        /// Represents our item in the table
        /// </summary>
        public class TableViewItem {
            public string Name { get; set; }
            public string SubHeading { get; set; }
            public string ImageName { get; set; }

            public TableViewItem () {
            }
        }
#endregion

#endregion

        #region OBSOLETE methods
        // ***************************** OBSOLETE
        // ***************************** OBSOLETE
        // ***************************** OBSOLETE
        [Obsolete]
        public override void ViewDidUnload () {
            base.ViewDidUnload ();

            // Clear any references to subviews of the main view in order to
            // allow the Garbage Collector to collect them sooner.
            //
            // e.g. myOutlet.Dispose (); myOutlet = null;

            ReleaseDesignerOutlets ();
        }

        [Obsolete]
        public override bool ShouldAutorotateToInterfaceOrientation (UIInterfaceOrientation toInterfaceOrientation) {
            // Return true for supported orientations
            return (toInterfaceOrientation != UIInterfaceOrientation.PortraitUpsideDown);
        }
#endregion

    }
}` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:05:19.790

您的代码存在一些问题。

* * *

首先，我认为您的代码示例遗漏了一个重要部分？

UISwitch 变量的作用域是什么？好像是类级别的参考？

* * *

其次，我认为您的代码并不能很好地处理单元重用 - 在`uiSwitch.Tag = indexPath.Row;`重用的情况下不会调用该行。

* * *

第三，我不太确定您的方法是否真的非常可扩展 - 尽管它适用于小型列表

* * *

老实说，您最好为这个开关创建一个自定义单元格 - 然后使用这些自定义单元格中的值......要创建一个自定义单元格，请参阅：

*   使用[http://docs.xamarin.com/ios/Guides/User_Interface/Tables/Part_3_-_Customizing_a_Table%27s_Appearance中的代码](http://docs.xamarin.com/ios/Guides/User_Interface/Tables/Part_3_-_Customizing_a_Table%27s_Appearance)
*   使用 XIB - [http://www.alexyork.net/blog/2011/07/18/creating-custom-uitableviewcells-with-monotouch-the-correct-way/](http://www.alexyork.net/blog/2011/07/18/creating-custom-uitableviewcells-with-monotouch-the-correct-way/)和[http://slodge.blogspot.co.uk/ 2013/01/uitableviewcell-使用-xib-editor.html](http://slodge.blogspot.co.uk/2013/01/uitableviewcell-using-xib-editor.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T21:31:39.933

除了 Stuart 指出的问题之外，另一个问题是您正在回收单元格，因此您最终可能会得到一个指向另一个状态的回收单元格，而不是您想要的。

对于这种情况，您可以只为您创建的每个 UISlider 使用唯一键，以确保您永远不会为两个不同的变量重用 UISlider。或者，您需要更改您的代码，以便处理程序根据作用于它的 IndexPath 告诉不同。

# wpf - TreeView 跳跃滚动

> ID：14798635
> 
> 赞同：1
> 
> 时间：2013-02-10T14:15:31.930
> 
> 标签：wpf, scroll, treeview, virtualization, ui-virtualization

我有一个具有以下属性的虚拟化 TreeView：

```
<TreeView
    ScrollViewer.CanContentScroll="True" 
    VirtualizingPanel.IsVirtualizing="True"
    VirtualizingPanel.IsVirtualizingWhenGrouping="True" 
    VirtualizingStackPanel.ScrollUnit="Pixel"  
    VirtualizingStackPanel.CacheLength="20,20"
    VirtualizingStackPanel.CacheLengthUnit="Item"
    />
  ...
</TreeView> 
```

TreeViewItem 的高度大致相同。

问题是，当向下滚动时，滚动条的手柄会改变大小并且滚动是“跳跃的”，这会导致用户体验很差。

如何获得更流畅的用户体验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-10T12:37:26.620

我意识到这是一篇旧帖子，您现在可能有一个解决方案，但它有一个简单的答案，因此对于将来可能遇到此问题的任何人，这里是：

你描述的行为是正常的。如果您在 MSDN 中搜索[`ScrollViewer.CanContentScroll`](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.cancontentscroll%28v=vs.110%29.aspx)您使用的第一个属性，您会发现：

> ScrollViewer 中的内容可以按物理单位或逻辑单位滚动。物理单位是与设备无关的像素。逻辑单元用于在 ItemsControl 中滚动项目。ScrollViewer 的默认行为是使用物理单位来滚动其内容。但是，在 CanContentScroll 设置为 true 的情况下，内容可以使用逻辑单元进行滚动。例如，从 ItemsControl 继承的 ListBox、ListView 和其他控件使用逻辑单元进行滚动。如果 CanContentScroll 为 true，则 ExtentHeight、ScrollableHeight、ViewportHeight 和 VerticalOffset 属性的值是项目数，而不是物理单位。
> 
> 如果您需要物理滚动而不是逻辑滚动，请将宿主 Panel 元素包装在 ScrollViewer 中并将其 CanContentScroll 属性设置为 false。物理滚动是大多数 Panel 元素的默认滚动行为。

因此，这基本上意味着您可以按像素滚动，也可以从集合中滚动整个项目。因此，为了平滑滚动，您需要使用像素进行滚动。为此，您只需将`ScrollViewer.CanContentScroll`属性设置为`False`. 所以事实证明，这毕竟是一个简单的修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-12T06:56:32.047

不幸的是，设置`ScrollViewer.CanContentScroll = False`将禁用虚拟化，因此并不能真正帮助解决这个问题。

我发现为 TreeViewItem 的内容设置硬编码的高度值会使滚动条表现得更好，但滚动条仍然会调整大小。

# python - scrapy：通过多次解析和收集数据传输项目

> ID：14798639
> 
> 赞同：0
> 
> 时间：2013-02-10T14:16:21.120
> 
> 标签：python, scrapy

我只是第一次尝试填充一个项目，同时将它从一个页面传输到另一个页面。

它在每个循环中都有效，并且性别信息也在 parse_3 中正确到达，但 g2 不适合响应 url 的类别，并且 g1（第一类别级别）始终是我在 parse_sub 中循环遍历的列表中列表的最后一个元素...

当然我做错了什么，但我找不到问题，如果有人能解释我它是如何工作的，那就太好了。

最好的，杰克

```
class xspider(BaseSpider):
    name = 'x'
    allowed_domains = ['x.com']
    start_urls = ['http://www.x.com']

    def parse(self, response):
        hxs = HtmlXPathSelector(response)
        maincats = hxs.select('//ul[@class="Nav"]/li/a/@href').extract()[1:3]
        for maincat in maincats:
            item = catItem()
            if 'men' in maincat:
                item['gender'] = 'men'
                maincat = 'http://www.x.com' + maincat
                request = Request(maincat, callback=self.parse_sub)
                request.meta['item'] = item
            if 'woman' in maincat:
                item['gender'] = []
                item['gender'] = 'woman'
                maincat = 'http://www.x.com' + maincat
                request = Request(maincat, callback=self.parse_sub)
                request.meta['item'] = item
            yield request

    def parse_sub(self, response):
        i = 0
        hxs = HtmlXPathSelector(response)
        subcats = hxs.select('//ul[@class="sub Sprite"]/li/a/@href').extract()[0:5]
        text = hxs.select('//ul[@class="sub Sprite"]/li/a/span/text()').extract()[0:5]
        for item in text:
            item = response.meta['item']
            subcat = 'http://www.x.com' + subcats[i]
            request = Request(subcat, callback=self.parse_subcat)
            item['g1'] = text[i]
            item['gender'] = response.request.meta['item']
            i = i + 1
            request.meta['item'] = item
            yield request

    def parse_subcat(self, response):
        hxs = HtmlXPathSelector(response)
        test = hxs.select('//ul[@class="sub"]/li/a').extract()
        for s in test:
            item = response.meta['item']
            item['g2'] = []
            item['g2'] = hxs.select('//span[@class="Active Sprite"]/text()').extract()[0]
            s = s.encode('utf-8','ignore')
            link = s[s.find('href="')+6:][:s[s.find('href="')+6:].find('/"')]
            link = 'http://www.x.com/' + str(link) + '/'
            request = Request(link, callback=self.parse_3)
            request.meta['item'] = item
            yield request

    def parse_3(self, response):
        item = response.meta['item']
        print item 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T09:46:18.210

```
def parse_subcat(self, response):
    hxs = HtmlXPathSelector(response)
    test = hxs.select('//ul[@class="sub"]/li/a').extract()
    for s in test:
        item = response.meta['item']
        item['g2'] = []
        item['g2'] = hxs.select('//span[@class="Active Sprite"]/text()').extract()[0]
        s = s.encode('utf-8','ignore')
        link = s[s.find('href="')+6:][:s[s.find('href="')+6:].find('/"')]
        link = 'http://www.x.com/' + str(link) + '/'
        request = Request(link, callback=self.parse_3)
        request.meta['item'] = item
        yield request 
```

响应不包含元，但请求所以`item = response.meta['item']` 应该是`item = response.request.meta['item']`

# mysql - 使用 MYSQL 创建随机数

> ID：14798640
> 
> 赞同：102
> 
> 时间：2013-02-10T14:16:27.820
> 
> 标签：mysql, sql

我想知道是否有一种方法可以选择 100 到 500 之间随机生成的数字以及选择查询。

例如：`SELECT name, address, random_number FROM users`

我不必将此数字存储在数据库中，仅用于显示目的。

我试过这样的东西，但它无法工作..

```
SELECT name, address, FLOOR(RAND() * 500) AS random_number FROM users 
```

希望有人帮助我。谢谢

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2013-02-10T14:20:35.433

这应该给你想要的：

```
FLOOR(RAND() * 401) + 100 
```

通常，`FLOOR(RAND() * (<max> - <min> + 1)) + <min>`生成介于`<min`> 和（`<max>`含）之间的数字。

**更新**

这个完整的声明应该有效：

```
SELECT name, address, FLOOR(RAND() * 401) + 100 AS `random_number` 
FROM users 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-10T14:28:09.593

As`RAND`产生一个数字 0 <= v < 1.0 （请参阅[文档](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_rand)），您需要使用它`ROUND`来确保您可以获得上限（在这种情况下为 500）和下限（在这种情况下为 100）

所以要产生你需要的范围：

```
SELECT name, address, ROUND(100.0 + 400.0 * RAND()) AS random_number
FROM users 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-15T16:58:07.443

除了这个答案，创建一个类似的函数

```
CREATE FUNCTION myrandom(
    pmin INTEGER,
    pmax INTEGER
)
RETURNS INTEGER(11)
DETERMINISTIC
NO SQL
SQL SECURITY DEFINER
BEGIN
  RETURN floor(pmin+RAND()*(pmax-pmin));
END; 
```

并打电话给

`SELECT myrandom(100,300);`

这为您提供了 100 到 300 之间的随机数

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-10T14:24:48.660

您可以使用（n 是一个整数）创建一个随机数`FLOOR(RAND() * n) as randnum`，但是如果您不需要重复相同的随机数，那么您将不得不在一些临时表中存储。所以你可以检查它与`where randnum not in (select * from temptable)`...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-01T11:43:47.660

这些都运行良好：

```
select round(<maxNumber>*rand()) 
```

* * *

```
FLOOR(RAND() * (<max> - <min> + 1)) + <min> // generates a number
between <min> and <max> inclusive. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-27T11:29:37.027

`i`这是从`j`哪里找到整数的正确公式`i <= R <= j`

```
FLOOR(min+RAND()*(max-min)) 
```

# html - 带有菜单标签的有序列表 - 重置编号

> ID：14798644
> 
> 赞同：0
> 
> 时间：2013-02-10T14:16:49.650
> 
> 标签：html

我有一个简单的有序列表，每个列表都有一个菜单标签和一些列表项，例如：

```
<ol>
    <li>
        <h2>List item 1</h2>
        <menu>
            <li><a href="#">Action 1</a></li>
            <li><a href="#">Action 2</a></li>
        </menu>
    </li>
    <li>
        <h2>List item 2</h2>
        <menu>
            <li><a href="#">Action 1</a></li>
            <li><a href="#">Action 2</a></li>
        </menu>
    </li>
</ol> 
```

不幸的是，使用此标记，外部列表项的编号会受到菜单内列表项的影响。

所以第二个外部列表项应该编号为 2，但实际上它编号为 4。

如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:14:41.277

这是某些浏览器中的错误。Chrome 的编号错误，IE 和 Firefox 的编号正确。

用 CSS 解决这个问题会有点棘手，所以最好`ul`使用`menu`. 根据 HTML 4.01 规范，该[`menu`元素](http://www.w3.org/TR/REC-html40/struct/lists.html#edef-MENU)是一个已弃用的元素，类似于`ul`但旨在呈现为菜单列表，但实际上浏览器将其显示为`ul`. `ul`但是正如这里所观察到的，Chrome 实现中存在一个错误——这是使用而不是 的另一个原因`menu`，正如规范中强烈推荐的那样。

（HTML5 建议以`menu`复杂的方式重新定义，使其更不适合简单的逐项列表。）

# android - Flurry - 保护公钥

> ID：14798646
> 
> 赞同：1
> 
> 时间：2013-02-10T14:16:59.760
> 
> 标签：android, flurry, api-key

为了向 Flurry 发送事件，他们提供了一个 API 密钥。我必须在我的 Android 应用程序中保护该密钥吗？

如果是，最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:29:13.400

我不明白为什么您真的需要保护分析密钥。我真诚地怀疑某些黑客想在您的分析中注入恶意使用。

除此之外，还有几种保护密钥的方法是：

1.  在运行时从 base 64 字符串或其他内容构造它。不是很好的保护，但它可以防止只是阅读代码的人得到它。
2.  将其存储在您的服务器上，并在运行时通过网络服务或其他方式拉取它。这样一来，它就不会被编译到应用程序中，并且更难检索。

这些都不是不可能得到的，但你不应该真的需要保护它。

# facebook - 组 api 返回空字符串

> ID：14798648
> 
> 赞同：2
> 
> 时间：2013-02-10T14:17:04.217
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk, facebook-login

请帮我从 facebook api 获取组列表。

当我使用此代码时：

```
$token = $facebook->getAccessToken();
$groups = $facebook->api('/me/groups','GET', array('access_token' => $token)); 
```

它返回空数组。

或者，如果我切断访问令牌，它仍然不起作用。

但是当我使用以下命令调用图形 api 时：

[https://graph.facebook.com/me/groups?access_token=](https://graph.facebook.com/me/groups?access_token=) ....

它返回所有组，当我使用时：

```
$groups = file_get_contents('https://graph.facebook.com/me/groups?access_token='.$token); 
```

它也返回空 json。

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:22:12.050

我相信您需要添加`user_groups`权限才能获得结果。

当您登录 Facebook 时：

```
FB.login(function(response) {
      if (response.authResponse) {
          ...
      } else {
        ....
      }
  }, {scope: 'user_groups'}); 
```

**编辑：**

使用 Facebook PHP SDK：

```
$loginUrl = $facebook->getLoginUrl(array('scope' => 'user_groups')); 
```

# javascript - 粘贴到文本字段 TideSDK

> ID：14798657
> 
> 赞同：0
> 
> 时间：2013-02-10T14:18:07.163
> 
> 标签：javascript, clipboard, tidesdk

我有以下代码，我希望用户能够复制或粘贴到文本字段中，基本上模仿`ctrl`+`c`或`ctrl`+`v`

我的问题是：

1.  如何确保上下文菜单仅出现在文本字段中
2.  如何将文本粘贴到区域中。

我已经阅读了文档，到目前为止我还没有工作：

```
 var menu = Ti.UI.createMenu();

    menu.addItem('Copy', function() {
        var data =$.("#this").val()

       Ti.UI.Clipboard.getData('text/plain',data);

    });
    menu.addItem('Paste', function() {

       var data =Ti.UI.Clipboard.getData('text/plain');
       $.("#this").val(data)
    });

function showrightmenu(){  Ti.UI.getCurrentWindow().setContextMenu(menu);} 
```

我可以使用它来调用它，`oncontextmenu= "showrightmenu()"`但是现在，如何在这一行中粘贴一些东西：

```
 $.(#this).val(Ti.UI.Clipboard.setData('text/plain')) 
```

*我在黑暗中摸索。*我是 TideSDK 的新手，这是我的第一个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:18:47.507

## 问题 1

我也是 TideSDK 的新手，可能是错的，但据我从 API 文档中可以看出，上下文菜单绑定到一个窗口，并且在右键单击窗口的不同部分时显示不同的上下文菜单需要你每次更改窗口的上下文菜单...

例子：

```
//Create different menus
var context_menu = Ti.UI.createMenu();
var copy_menu    = Ti.UI.createMenu();
//Add menu items etc.
...

//Change context menus on click events depending on clicked element
$('#some-element').mousedown(function(event){
    if(event.which==3){//detect right click
        editor_window.setContextMenu(context_menu);
    }
});
$('#text-field').mousedown(function(event){
    if(event.which==3){//detext right click
        editor_window.setContextMenu(copy_menu);
    }
}); 
```

这样，当您单击具有 id 的元素时`some-element`，将显示第一个上下文菜单，当您单击该`#text-field`元素时，将显示第二个上下文菜单。

请注意，如果一个元素在另一个元素内部，这将不起作用，因为这两个事件都会被触发。

## 问题2

在您提供的这段代码中：

```
$.(#this).val(Ti.UI.Clipboard.setData('text/plain')) 
```

您想使用`Ti.UI.Clipboard.getData`而不是`Ti.UI.Clipboard.setData`，因为您想获取存储在剪贴板中的文本，然后将其放入文本字​​段中。此外，您可能希望更改`$.(#this)`为`$("#this")`或`$(this)`。

这应该有效：

```
$("#some-element").val(Ti.UI.Clipboard.getData('text/plain')) 
```

## 评论

您似乎对如何使用 jQuery 感到困惑。要选择一个元素，请使用`$()`and not `$.()`。此外，`$("#example")`您可以选择带有 id 的 DOM 元素`example`。`$(this)`在触发事件时调用的函数内部使用，并引用触发事件的元素。`$("#this")`不一样`$(this)`。希望那有所帮助...

# macos - 在 OSX 上的 Monodevelop 下创建 F# 项目失败

> ID：14798658
> 
> 赞同：1
> 
> 时间：2013-02-10T14:18:08.227
> 
> 标签：macos, f#, monodevelop

我从 MonoDevelop 收到以下错误

```
System.TypeLoadException: A type load exception has occurred.
  at MonoDevelop.Projects.DotNetProject.CreateConfiguration (System.String name) [0x000cc] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Core/MonoDevelop.Projects/DotNetProject.cs:753 
  at MonoDevelop.Projects.DotNetProject..ctor (System.String languageName, MonoDevelop.Projects.ProjectCreateInformation projectCreateInfo, System.Xml.XmlElement projectOptions) [0x0011f] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Core/MonoDevelop.Projects/DotNetProject.cs:120 
  at MonoDevelop.Projects.DotNetAssemblyProject..ctor (System.String languageName, MonoDevelop.Projects.ProjectCreateInformation projectCreateInfo, System.Xml.XmlElement projectOptions) [0x00000] in <filename unknown>:0 
  at MonoDevelop.Projects.DotNetProjectBinding.CreateProject (System.String languageName, MonoDevelop.Projects.ProjectCreateInformation info, System.Xml.XmlElement projectOptions) [0x00000] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Core/MonoDevelop.Projects/DotNetProjectBinding.cs:51 
  at MonoDevelop.Projects.DotNetProjectBinding.CreateProject (MonoDevelop.Projects.ProjectCreateInformation info, System.Xml.XmlElement projectOptions) [0x0000c] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Core/MonoDevelop.Projects/DotNetProjectBinding.cs:46 
  at MonoDevelop.Projects.ProjectService.CreateProject (System.String type, MonoDevelop.Projects.ProjectCreateInformation info, System.Xml.XmlElement projectOptions) [0x00033] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Core/MonoDevelop.Projects/ProjectService.cs:498 
  at MonoDevelop.Ide.Templates.ProjectDescriptor.CreateItem (MonoDevelop.Projects.ProjectCreateInformation projectCreateInformation, System.String defaultLanguage) [0x00036] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Templates/ProjectDescriptor.cs:116 
  at MonoDevelop.Ide.Templates.SolutionDescriptor.CreateEntry (MonoDevelop.Projects.ProjectCreateInformation projectCreateInformation, System.String defaultLanguage) [0x001bc] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Templates/SolutionDescriptor.cs:152 
  at MonoDevelop.Ide.Templates.ProjectTemplate.CreateWorkspaceItem (MonoDevelop.Projects.ProjectCreateInformation cInfo) [0x00000] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Templates/ProjectTemplate.cs:232 
  at MonoDevelop.Ide.Projects.NewProjectDialog.CreateProject () [0x001ef] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/monodevelop/main/src/core/MonoDevelop.Ide/MonoDevelop.Ide.Projects/NewProjectDialog.cs:432 
```

如果我尝试加载现有的 F# 项目，则会收到错误消息

```
Error while trying to load the project
 '/Users/bradphelan/workspace/myfirstfsharp/myfirstfsharp/myfirstfsharp.fsproj': 
 Could not load type 'MonoDevelop.FSharp.FSharpCompilerParameters' 
 from assembly 'FSharpBinding, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'. 
```

请注意，我可以创建一个 C# 项目。

*** 编辑更新 ***

重建 fsharp 绑定时出错

```
Errors:

/Users/bradphelan/workspace/fsharpbinding/monodevelop/MonoDevelop.FSharpBinding/MonoDevelop.FSharp.local.fsproj (default targets) ->
/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/Microsoft.Common.targets (ResolveProjectReferences target) ->
/Users/bradphelan/workspace/fsharpbinding/FSharp.CompilerBinding/FSharp.CompilerBinding.fsproj (default targets) ->
/Users/bradphelan/workspace/fsharpbinding/lib/fsharp/Microsoft.FSharp.Targets (CoreCompile target) ->

    : error : Error initializing task ItemGroup: Not registered task ItemGroup.

/Users/bradphelan/workspace/fsharpbinding/monodevelop/MonoDevelop.FSharpBinding/MonoDevelop.FSharp.local.fsproj (default targets) ->
/Users/bradphelan/workspace/fsharpbinding/lib/fsharp/Microsoft.FSharp.Targets (CreateManifestResourceNames target) ->

    : error : Error initializing task ItemGroup: Not registered task ItemGroup. 
```

# jquery - 使用 jQuery 实现完整网页的跨浏览器模糊

> ID：14798664
> 
> 赞同：0
> 
> 时间：2013-02-10T14:18:49.553
> 
> 标签：jquery, blur

我有一个问题，我找不到令人满意的解决方案。

我需要在用户单击链接时显示的页面上添加一个覆盖。显示叠加层时，所有其他内容都应模糊。这需要跨浏览器、无闪存，并且适用于具有任意内容（即图像、文本、样式化的 html 元素等）的网页。

我用谷歌搜索，但我只能找到一些解决方案，显示文本、不同元素或其他的模糊效果。我知道 blur.js，但这似乎不起作用。

有什么简单的方法可以让整个网页变得模糊吗？我更喜欢在 jquery 中执行此操作，因为 css3 并非完全跨浏览器...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:33:27.980

你可以使用 colorbox lightbox（一个轻量级的 jQuery 可定制的灯箱插件），它非常易于使用并且有很多功能。

[http://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)

# yahoo-pipes - 如何使用 Yahoo Pipes 更新项目的标题？

> ID：14798669
> 
> 赞同：0
> 
> 时间：2013-02-10T14:19:17.427
> 
> 标签：yahoo-pipes

我将提要与以下项目一起使用：

```
<item xmlns:hhvac="http://hh.ru/spec/hhvac">
    <pubDate>2013-02-04T10:13:51.616+04:00</pubDate>
    <hhvac:creationTime>2013-02-04T10:13:51.616+04:00</hhvac:creationTime>
    <hhvac:vacancyId>6887864</hhvac:vacancyId>
    <title>Title</title>
    <link>http://example.com/vacancy/6887864</link>
    <description>Description</description>
    <hhvac:compensationFrom/><hhvac:compensationTo/>
    <hhvac:compensationCurrency/>
    <hhvac:areaName>New York</hhvac:areaName>
    <hhvac:employerId>12345</hhvac:employerId>
    <hhvac:employerName>Employer Name</hhvac:employerName>
</item> 
```

我想用类似的值替换项目的标题`Employer Name: Title`。首先，我尝试只是添加`Rename`方法并在那里指出（只是为了测试）`item.title Rename item.hhvac:employerName`，但在结果中标题被命名为`1`, `2`,`3`等`4`。我的方法有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:24:05.007

使用**循环**模块。然后将一个**字符串生成器**模块放在它的中间。将**item.hhvac:employerName**放在第一个字段中，单击加号以获取另一个字段，将**:**放在该字段中，再次单击加号以获取另一个字段，然后将**item.title**放在该字段中

然后将**item.title**作为“Assign results to:”的值（并检查它旁边的单选按钮）。

# python - Python上的列表突变

> ID：14798676
> 
> 赞同：3
> 
> 时间：2013-02-10T14:19:58.960
> 
> 标签：python

我尝试通过用第一个元素交换列表和另一个引用列表之间的公共元素来改变列表。实现如下图所示：

```
>>> L = [1,2,3,4,5,6,7,8,9]
>>> A = [3]
>>> L[0], L[L.index(A[0])] = L[L.index(A[0])], L[0] #want to swap 3 with 1  
>>> L 
[1,2,3,4,5,6,7,8,9,] #List L was not mutated 
```

该列表没有像我预期的那样发生变化。但是当我如下所示修改实现时，它起作用了：

```
>>> L = [1,2,3,4,5,6,7,8,9]
>>> A = [3]
>>> i = L.index(A[0])
>>> L[0], L[i] = L[i], L[0]
>>> L
[3,2,1,4,5,6,7,8,9,] #Now list mutated as desired even though L[i] and L[L.index(A[0])] evaluate to same value. 
```

我的问题是，为什么第一个任务不能改变列表？我想到了，但我的大脑无法解释。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T14:32:40.297

虽然在 Python 中，在进行多次赋值时*首先*计算右侧，但左侧的赋值*目标*（如果其中有表达式）在赋值时会被逐个计算。

如果相反，它们会按照您的预期首先被评估为分配目标，这当然会奏效。

这记录在[赋值语句部分](http://docs.python.org/2/reference/simple_stmts.html#assignment-statements)：

> 赋值语句计算表达式列表（请记住，这可以是单个表达式或逗号分隔的列表，后者产生一个元组）并将单个结果对象分配给每个目标列表，*从左到右*。

和

> 如果目标列表是逗号分隔的目标列表：该对象必须是与目标列表中的目标具有相同数量的项目的可迭代对象，并且这些项目*从左到右分配给相应的目标*。

强调我的。从左到右在这里很重要。`L[0]`在分配给之前`L[L.index(3)]`分配给。

然后，该文档详细描述了订阅目标发生的情况，例如`L[0]`和`L[L.index(3)]`：

> 如果目标是订阅：计算引用中的主要表达式。它应该产生一个可变序列对象（例如列表）或映射对象（例如字典）。*接下来，计算下标表达式。*

再次强调我的；下标表达式是单独评估的，并且由于目标列表是从左到右评估的，因此评估发生*在之前的赋值之后`L[0]`*。

您可以通过反汇编 python 代码看到这一点：

```
>>> import dis
>>> def f(L):
...     L[0], L[2] = L[2], L[0]
... 
>>> def g(L):
...     L[0], L[L.index(3)] = L[L.index(3)], L[0]
... 
>>> dis.dis(f)
  2           0 LOAD_FAST                0 (L)   # L[2]
              3 LOAD_CONST               1 (2)
              6 BINARY_SUBSCR       
              7 LOAD_FAST                0 (L)   # L[0]
             10 LOAD_CONST               2 (0)
             13 BINARY_SUBSCR       
             14 ROT_TWO             
             15 LOAD_FAST                0 (L)   # Store in L[0]
             18 LOAD_CONST               2 (0)
             21 STORE_SUBSCR        
             22 LOAD_FAST                0 (L)   # Store in L[2]
             25 LOAD_CONST               1 (2)
             28 STORE_SUBSCR        
             29 LOAD_CONST               0 (None)
             32 RETURN_VALUE        
>>> dis.dis(g)
  2           0 LOAD_FAST                0 (L)   # L[L.index(3)]
              3 LOAD_FAST                0 (L)
              6 LOAD_ATTR                0 (index)
              9 LOAD_CONST               1 (3)
             12 CALL_FUNCTION            1
             15 BINARY_SUBSCR       
             16 LOAD_FAST                0 (L)  #  L[0]
             19 LOAD_CONST               2 (0)
             22 BINARY_SUBSCR       
             23 ROT_TWO             
             24 LOAD_FAST                0 (L)  # Store in L[0]
             27 LOAD_CONST               2 (0)
             30 STORE_SUBSCR        
             31 LOAD_FAST                0 (L)  # Store in L[L.index(3)]
             34 LOAD_FAST                0 (L)
             37 LOAD_ATTR                0 (index)
             40 LOAD_CONST               1 (3)
             43 CALL_FUNCTION            1
             46 STORE_SUBSCR        
             47 LOAD_CONST               0 (None)
             50 RETURN_VALUE 
```

存储操作首先存储`L[0] = 3`，所以下一次调用`L.index(3)`返回`0`，`1`因此存储在原位`0`！

以下确实有效：

```
L[L.index(3)], L[0] = L[0], L[L.index(3)] 
```

because now the `L.index(3)` lookup is done first. However, it's best to store the result of an `.index()` call in a temporary variable as not calling `.index()` twice is going to be more efficient in any case.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-10T14:24:13.940

问题是两者不等价。第一个例子类似于做：

```
>>> L = [1,2,3,4,5,6,7,8,9]
>>> A = [3]
>>> i = L.index(A[0])
>>> L[0] = L[i]
>>> i = L.index(A[0])
>>> L[i] = L[0] 
```

这意味着您最终会交换，然后找到刚刚交换的元素并交换回来。

你感到困惑的原因是你认为元组赋值是 Python 同时做这两个事情 - 这不是执行的方式，它是按顺序执行的，这会改变结果。

值得注意的是，即使它确实有效，这也是一种次优方式。`list.index()`不是一个特别快的操作，所以无缘无故地做两次不是一个好主意。

# javascript - 我可以预加载动画吗？

> ID：14798679
> 
> 赞同：0
> 
> 时间：2013-02-10T14:20:09.863
> 
> 标签：javascript, performance, animation, svg

我有一个使用大量过滤器的 svg 动画，但运行速度不够快。有没有我使用的代码可以预先计算结果图像（在开始时全部加载），以便在动画开始时，它可以全速执行代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:39:20.617

尝试将 BufferedRenderingProperty 设置为“动态”

[http://www.w3.org/TR/SVGTiny12/painting.html#BufferedRenderingProperty](http://www.w3.org/TR/SVGTiny12/painting.html#BufferedRenderingProperty)

# php - 如果mysql结果不存在回显？

> ID：14798680
> 
> 赞同：0
> 
> 时间：2013-02-10T14:20:11.023
> 
> 标签：php, mysql

嗨，我的网站上有一个基本的点赞系统。基本上一旦用户点击喜欢，这会将 user_id-has_liked 从 0 设置为 1。

如果他们的 user_id_has_liked 设置为 0，则显示类似链接，如果设置为 1，则显示不同。但是我想添加另一个条件，如果结果不在 mysql 中，则回显类似的链接。

有人可以告诉我在哪里以及我会添加什么来实现这一点。

```
<div class="profile_likes">
<?php
$user_like_set = user_like_status();
while ($like = mysql_fetch_array($user_like_set)) 
if ($like['user_id_has_liked'] == '0')  { ?>

<a href="like_profile.php?to=<?php echo "$profile_id"; ?>">Like</a>&nbsp;&nbsp;|&nbsp;&nbsp;<?

$count_likes_set = count_likes();
while ($likes = mysql_fetch_array($count_likes_set)) {

    echo "". $likes['likes'] ." People Like ".$profile[2]."";

    //$check_new_duos_set = check_new_escort_duos(); while ($newd = mysql_fetch_array($check_new_duos_set)) { 

    ?>

    <? } }?>

    <?php
$user_like_set = user_like_status();
while ($like = mysql_fetch_array($user_like_set)) 
if ($like['user_id_has_liked'] == '1')  { ?>

<a href="unlike_profile.php?to=<?php echo "$profile_id"; ?>">Unlike</a>&nbsp;&nbsp;|&nbsp;&nbsp;<?

$count_likes_set = count_likes();
while ($likes = mysql_fetch_array($count_likes_set)) {

    echo "". $likes['likes'] ." People Like ".$profile[2]."";

    //$check_new_duos_set = check_new_escort_duos(); while ($newd = mysql_fetch_array($check_new_duos_set)) { 
    ?>

    <? } }?>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:31:52.783

try this i just made one change that your user_like_status(); should return true or false

```
<div class="profile_likes">
<?php
    $user_like_set = user_like_status();//should return true or false
    if ($user_like_set == false){
        $what = "Like"; 
    }else{
        $what = "Unlike";
    }?>    
    <a href="like_profile.php?to=<?php echo "$profile_id"; ?>"><?php echo $what ;?></a>&nbsp;&nbsp;|&nbsp;&nbsp;
    <?php 
    $count_likes_set = count_likes();
    while ($likes = mysql_fetch_array($count_likes_set)) {
    echo "". $likes['likes'] ." People Like ".$profile[2]."";
    }
 ?>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:31:23.023

尝试在使用 echo/print 函数时保持一致性，并通过终止 php 标签来模拟它们，你的代码会变得更加清晰。

```
<?php
    function printLikeLink($likeLink){
          echo "<a href='{$likeLink}'>Like this profile</a>";
    }
    $user_like_set = user_like_status();
    if ($like = mysql_fetch_array($user_like_set)){
        if ($like['user_id_has_liked'] == '1')  {
            echo "<a href=\"unlike_profile.php?to={$profile_id}\">Unlike</a>|";
            $count_likes_set = count_likes();
            while ($likes = mysql_fetch_array($count_likes_set)) {
                echo "". $likes['likes'] ." People Like ".$profile[2]."";
                //$check_new_duos_set = check_new_escort_duos(); while ($newd = mysql_fetch_array($check_new_duos_set)) { 
            }
        }else printLikeLink("like_profile.php?to={$profile_id}");
    }else printLikeLink("like_profile.php?to={$profile_id}"); // Edit this link.
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T14:32:01.513

您应该尝试[mysql_num_rows](http://www.php.net/manual/en/function.mysql-num-rows.php)。它将为您提供记录集中存在的行数。除此之外，请注意，您使用的 API 已弃用。在 mysql 网站上寻找建议的替代方案。

# html - 我该如何使用和带有 Django 的 iOS Safari？

> ID：14798682
> 
> 赞同：0
> 
> 时间：2013-02-10T14:20:23.340
> 
> 标签：html, django-forms, mobile-safari, datetimepicker

我真的很喜欢 Safari iOS 中特殊键盘的便利性。

但是，它似乎以“2013 年 2 月 10 日 9:07”格式输出日期时间。

Django 表单不会解析这种格式。与 django 文档中一样，django 不解析 %b 或 %B、缩写或完整月份名称。

让 django 表单解析“2013 年 2 月 10 日 9:07”的任何简单解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T00:44:19.307

格式实际上是`2013-02-10T09:07:00Z`，它只是呈现为`Feb 10, 2013, 9:07`（或根据您的语言环境设置）。由于格式是标准的日期时间格式，我认为 Django 应该能够正确处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T04:33:03.753

目前 Django 不支持 HTML5 datetime 或 datetime-local 输入使用的格式，因此您需要使用自定义格式模块手动添加它，例如：

（将示例中的“mysite”替换为您的项目名称）

```
FORMAT_MODULE_PATH = 'mysite.formats' 
```

在你的 settings.py

和

```
DATETIME_INPUT_FORMATS = (
    '%Y-%m-%dT%H:%M:%SZ',
    '%Y-%m-%dT%H:%M:%S',
    '%Y-%m-%d %H:%M:%S',
    '%Y-%m-%d %H:%M:%S.%f',
    '%Y-%m-%d %H:%M',
    '%Y-%m-%d',
    '%Y/%m/%dT%H:%M:%S',
    '%Y/%m/%d %H:%M:%S',
    '%Y/%m/%d %H:%M:%S.%f',
    '%Y/%m/%d %H:%M',
    '%Y/%m/%d',
) 
```

在`mysite/formats/en/formats.py`

确保还创建

```
mysite/formats/__init__.py
mysite/formats/en/__init__.py 
```

并复制`en`您使用的任何其他语言环境的目录。

# javascript - AngularJS 1.2 的发布和支持方案怎么样？

> ID：14798689
> 
> 赞同：9
> 
> 时间：2013-02-10T14:21:01.083
> 
> 标签：javascript, angularjs, versioning

可以[在这里阅读](http://blog.angularjs.org/2012/07/angularjs-10-12-roadmap.html)

> AngularJs 1.2 版本预计在 2012 年 9 月发布

好吧，我们都是程序员，并且知道项目时间表会发生什么；）

**但是**那些想要采用 AngularJS 并在上面投资的人可能会担心，因为同一篇博客文章中的声明说：

> 1.0.x 将只接收从 1.1.x 分支向后移植的错误修复，并且将在 1.2 发布之前得到支持

基本上，缺乏路线图意味着当新的 1.2 版本出现时，我们的 AngularJs 1.0.x 应用程序可能突然变得不受支持，会发生什么……什么时候？

提前感谢您提供有关 AngularJS 1.2 的预期发布日期的任何信息；）

# c# - 将 Ascii 字符串转换为比特流

> ID：14798691
> 
> 赞同：0
> 
> 时间：2013-02-10T14:21:13.743
> 
> 标签：c#, bit-manipulation, microcontroller, 8051

我正在做一个项目，我从一些开关和 8051 MC 引脚上的按钮获取数据。现在我必须将端口引脚上的这些数据串行传输到 PC。在 PC 端，我使用串行端口类在 C#sharp .net 应用程序中接收数据。现在的问题是我希望在 C sharp 应用程序中接收到的数据是位串而不是 Ascii 的形式。

有人可以指导我如何实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:30:01.800

像这样的东西？

```
byte b = 23;
var str = Convert.ToString(b, 2).PadLeft(8,'0'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:37:18.853

在 C# 中，字符通常存储在双字节集中。因此，对于每 16 位，将二进制集转换为 char 类型。

```
char c = (char)myBinary; 
```

编辑：这当然取决于您的项目分配给每个字符的位数。它很可能是一个字节。如果是这样，您将需要查看下面的链接以了解字符结构。

参考：http: [//msdn.microsoft.com/en-us/library/vstudio/x9h8tsay.aspx](http://msdn.microsoft.com/en-us/library/vstudio/x9h8tsay.aspx)

# ruby-on-rails - Turbolinks 未正确链接到 Webkit 中的锚点

> ID：14798692
> 
> 赞同：0
> 
> 时间：2013-02-10T14:21:24.273
> 
> 标签：ruby-on-rails, anchor, turbolinks

我的索引页上有这样的代码：

```
<% for article in @articles %>
  <%= link_to article_url(article, :anchor=>"comments") do %>
    <span><%= pluralize article.comments.count, "Comment" %></span>
  <% end %>
<% end %> 
```

我希望它能够链接到每篇博文的评论部分。

```
<a id="comments" name="comments"></a> 
```

在 FF 中一切正常，但在 Chrome 中查看时，只有这些链接中的第一个实际上会按预期工作，如果单击其他任何链接，则一旦文章加载，视口将自动滚动到页面底部。

有什么想法吗？我知道有一些关于 turbolink 和锚点的错误，但它们已被修复。除非有人能指出我在这里做错了什么，否则我会将其作为问题记录在 github 上。

考虑到我在我的大多数网站上都做这种事情，我希望它能够正常工作。

FWIW：使用 WattOS、Chromium 最新 vrsn、Turbolinks 1.0 和 Rails 3.2.11

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:28:22.983

这似乎在 Rails 4.0.0.beta1 中得到了解决。我将按固定方式关闭它。

# asp.net - asp.net 访问数据库未更新

> ID：14798696
> 
> 赞同：1
> 
> 时间：2013-02-10T14:21:50.950
> 
> 标签：asp.net, visual-studio, ms-access, datasource

我正在尝试更新我的访问数据库中的值，但是在某些情况下它不起作用。

编码 ：

```
<form id="form1" runat="server">
<asp:AccessDataSource ID="AccessDataSource1" runat="server" 
        DataFile="~/App_Data/Database1.mdb" 
        DeleteCommand="UPDATE DT_Person SET Deleted = NOW() WHERE (Person_Ref = ?)" 
        InsertCommand="INSERT INTO [DT_Person] ([Person_Ref], [Created], [Updated], [Deleted],     [Person_Name], [Person_No]) VALUES (?, ?, ?, ?, ?, ?)" 
        OldValuesParameterFormatString="original_{0}" 
        SelectCommand="SELECT * FROM [DT_Person]" 
        UpdateCommand="UPDATE DT_Person SET Updated = NOW(), Person_Name = ?, Person_No = ? WHERE (Person_Ref = ?)">
        <DeleteParameters>
            <asp:Parameter Name="original_Person_Ref" Type="Int32" />
        </DeleteParameters>
        <UpdateParameters>
            <asp:Parameter Name="Created" Type="DateTime" />
            <asp:Parameter Name="Updated" Type="DateTime" />
            <asp:Parameter Name="Deleted" Type="DateTime" />
            <asp:Parameter Name="Person_Name" Type="String" />
            <asp:Parameter Name="Person_No" Type="String" />
            <asp:Parameter Name="original_Person_Ref" Type="Int32" />
        </UpdateParameters>
        <InsertParameters>
            <asp:Parameter Name="Person_Ref" Type="Int32" />
            <asp:Parameter Name="Created" Type="DateTime" />
            <asp:Parameter Name="Updated" Type="DateTime" />
            <asp:Parameter Name="Deleted" Type="DateTime" />
            <asp:Parameter Name="Person_Name" Type="String" />
            <asp:Parameter Name="Person_No" Type="String" />
        </InsertParameters>
    </asp:AccessDataSource>
    <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
        AllowSorting="True" AutoGenerateColumns="False" BackColor="White" 
        BorderColor="#CCCCCC" BorderStyle="None" BorderWidth="1px" CellPadding="3" 
        DataKeyNames="Person_Ref" DataSourceID="AccessDataSource1">
        <RowStyle ForeColor="#000066" />
        <Columns>
            <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" 
                ShowSelectButton="True" />
            <asp:BoundField DataField="Person_Ref" HeaderText="Person_Ref" 
                InsertVisible="False" ReadOnly="True" SortExpression="Person_Ref" />
            <asp:BoundField DataField="Created" HeaderText="Created" 
                SortExpression="Created" />
            <asp:BoundField DataField="Updated" HeaderText="Updated" 
                SortExpression="Updated" />
            <asp:BoundField DataField="Deleted" HeaderText="Deleted" 
                SortExpression="Deleted" />
            <asp:BoundField DataField="Person_Name" HeaderText="Person_Name" 
                SortExpression="Person_Name" />
            <asp:BoundField DataField="Person_No" HeaderText="Person_No" 
                SortExpression="Person_No" />
        </Columns> 
```

如您所见，删除命令

```
(DeleteCommand="UPDATE DT_Person SET Deleted = NOW() WHERE (Person_Ref = ?)" ) 
```

真的是一个更新声明，这很好用。但是，实际的更新语句在网页上不起作用。奇怪的是，如果您在“查询构建器”中测试查询，它可以正常工作。

这里真的需要一些帮助。

TIA

PS 我每次都使用 Visual Studio 2008 并使用数据源生成器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T23:01:50.990

众所周知，Windows 7（如果您正在使用）会在调试文件中制作 Access 数据库的副本，并将该副本用于所有数据更改。您可能想检查您实际访问的数据库是否是您认为的副本。

在整个开发机器上搜索具有相同名称的文件。你可能会对出现的情况感到惊讶。

# algorithm - NP类：为什么多项式长度输出？

> ID：14798698
> 
> 赞同：2
> 
> 时间：2013-02-10T14:21:56.940
> 
> 标签：algorithm, np-complete, np

对于有资格获得 NP 类的问题：

1.  该问题的解决方案必须具有多项式输出长度，并且
2.  解决方案必须在多项式时间内是可验证的。

多项式输出长度的意义是什么？

PS：我认为多项式输出长度是输出在多项式时间内可验证的必要先决条件。（但是仅仅说可以在多项式时间内验证解决方案仍然是足够的。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:50:56.117

多项式长度强制是因为您将机器建模为通用图灵机。

在这种情况下，输出“磁带”必须是多项式长度。

这不是因为您使用的是现代语言并期望得到多项式长度的结果。

# ios - 如何使用 UTF-8 读取 NSInputStream？

> ID：14798706
> 
> 赞同：2
> 
> 时间：2013-02-10T14:22:52.403
> 
> 标签：ios, utf-8, nsinputstream

我尝试使用 NSInputStream 在 iOS 中读取一个大文件，以用换行符分隔文件（我不想使用`componentsSeparatedByCharactersInSet`，因为它使用了太多内存）。

但由于并非所有行似乎都是 UTF-8 编码的（因为它们可以显示为 ASCII，相同的字节）我经常收到`Incorrect NSStringEncoding value 0x0000 detected. Assuming NSASCIIStringEncoding. Will stop this compatiblity mapping behavior in the near future.`警告。

我的问题是：有没有办法通过设置编译器标志来抑制这个警告？

此外：附加/连接两个缓冲区读取是否保存，因为从字节流中读取，然后将缓冲区转换为字符串，然后附加字符串可能会使字符串损坏？

下面的示例方法演示了字节到字符串的转换将丢弃 UTF-8 字符的前半部分和后半部分，因为它是无效的。

```
- (void)NSInputStreamTest {
  uint8_t testString[] = {0xd0, 0x91}; // @"Б"

  // Test 1: Read max 1 byte at a time of UTF-8 string
  uint8_t buf1[1], buf2[1];
  NSString *s1, *s2, *s3;
  NSInteger c1, c2;
  NSInputStream *inStream = [[NSInputStream alloc] initWithData:[[NSData alloc] initWithBytes:testString length:2]];

  [inStream open];
  c1 = [inStream read:buf1 maxLength:1];
  s1 = [[NSString alloc] initWithBytes:buf1 length:1 encoding:NSUTF8StringEncoding];
  NSLog(@"Test 1: Read %d byte(s): %@", c1, s1);
  c2 = [inStream read:buf2 maxLength:1];
  s2 = [[NSString alloc] initWithBytes:buf2 length:1 encoding:NSUTF8StringEncoding];
  NSLog(@"Test 1: Read %d byte(s): %@", c2, s2);
  s3 = [s1 stringByAppendingString:s2];
  NSLog(@"Test 1: Concatenated: %@", s3);
  [inStream close];

  // Test 2: Read max 2 bytes at a time of UTF-8 string
  uint8_t buf4[2];
  NSString *s4;
  NSInteger c4;
  NSInputStream *inStream2 = [[NSInputStream alloc] initWithData:[[NSData alloc] initWithBytes:testString length:2]];

  [inStream2 open];
  c4 = [inStream2 read:buf4 maxLength:2];
  s4 = [[NSString alloc] initWithBytes:buf4 length:2 encoding:NSUTF8StringEncoding];
  NSLog(@"Test 2: Read %d byte(s): %@", c4, s4);
  [inStream2 close];
} 
```

输出：

```
2013-02-10 21:16:23.412 Test[11144:c07] Test 1: Read 1 byte(s): (null)
2013-02-10 21:16:23.413 Test[11144:c07] Test 1: Read 1 byte(s): (null)
2013-02-10 21:16:23.413 Test[11144:c07] Test 1: Concatenated: (null)
2013-02-10 21:16:23.413 Test[11144:c07] Test 2: Read 2 byte(s): Б 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-06T10:04:24.167

首先，在线：`s3 = [s1 stringByAppendingString:s2];`您正在尝试连接到“nil”值。结果也将是“零”。因此，您可能想要连接字节而不是字符串：

```
uint8_t buf3[2];
buf3[0] = buf1[0];
buf3[1] = buf2[0];
s3 = [[NSString alloc] initWithBytes:buf3 length:2 encoding:NSUTF8StringEncoding]; 
```

输出：

```
2015-11-06 12:57:40.304 Test[10803:883182] Test 1: Read 1 byte(s): (null)
2015-11-06 12:57:40.305 Test[10803:883182] Test 1: Read 1 byte(s): (null)
2015-11-06 12:57:40.305 Test[10803:883182] Test 1: Concatenated: Б 
```

其次，UTF-8 字符的长度可能位于 [1..6] 字节中。

```
(1 byte)   0aaa aaaa         //if symbol lays in 0x00 .. 0x7F (ASCII)
(2 bytes)  110x xxxx 10xx xxxx
(3 bytes)  1110 xxxx 10xx xxxx 10xx xxxx
(4 bytes)  1111 0xxx 10xx xxxx 10xx xxxx 10xx xxxx
(5 bytes)  1111 10xx 10xx xxxx 10xx xxxx 10xx xxxx 10xx xxxx
(6 bytes)  1111 110x 10xx xxxx 10xx xxxx 10xx xxxx 10xx xxxx 10xx xxxx 
```

因此，如果您打算从 NSInputStream 读取原始字节，然后将它们转换为 UTF-8 NSString，您可能希望从 NSInputStream 中逐字节读取，直到获得有效字符串：

```
#define MAX_UTF8_BYTES 6
NSString *utf8String;
NSMutableData *_data = [[NSMutableData alloc] init]; //for easy 'appending' bytes

int bytes_read = 0;
while (!utf8String) {
    if (bytes_read > MAX_UTF8_BYTES) {
        NSLog(@"Can't decode input byte array into UTF8.");
        return;
    }
    else {
        uint8_t byte[1];
        [_inputStream read:byte maxLength:1];
        [_data appendBytes:byte length:1];
        utf8String = [NSString stringWithUTF8String:[_data bytes]];
        bytes_read++;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:40:34.887

ASCII（因此换行符）是 UTF-8 的子集，因此不应该有任何冲突。

应该可以在换行符处划分流，就像在简单的 ASCII 流中一样。然后，您可以将每个块（“行”）转换为`NSString`使用 UTF-8 的格式。

您确定编码错误不是真实的，即您的流实际上可能包含与 UTF-8 编码相关的错误字符吗？

**编辑从评论中添加：**

这假定这些行包含足够少的字符以在从 UTF-8 转换之前将整行保留在内存中。

# ruby-on-rails - rails 可执行文件无法在 yakuake 应用程序上运行

> ID：14798707
> 
> 赞同：0
> 
> 时间：2013-02-10T14:22:58.910
> 
> 标签：ruby-on-rails, ruby, shell, rvm, ubuntu-12.04

我在 Ruby 上安装了 Rails 3.2.11，版本`1.9.3-p374`通过 Ubuntu 12.04 上的 RVM。我还安装了[Yakuake](http://yakuake.kde.org/)应用程序，其版本`2.9.8-1`为我提供了一个下拉终端。通常，在 Gnome 终端上，我可以同时运行 Ruby 和 Rails 命令。但是在 Yakuake 上，我可以运行 Ruby，但不能运行 Rails 命令。以下是来自 Yakuake 的命令：

```
➜  ~  ruby -v
ruby 1.9.3p374 (2013-01-15 revision 38858) [i686-linux]
➜  ~  rvm -v
rvm 1.18.5 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]
➜  ~  rails -v
zsh: correct 'rails' to 'tail' [nyae]? n
zsh: command not found: rails 
```

除此之外：

*   bash 和 zsh shell 都试过了，但结果相同
*   在相关的[RVM](https://rvm.io/integration/gnome-terminal/)站点上，Ruby 和 Rails 命令应作为登录 shell 运行，但 Yakuake 应用程序没有选项将命令作为登录 shell 运行
*   我还尝试了 Guake 终端，它是 Yakuake 的替代品，它具有登录 shell 选项，但不是一个很好的替代应用程序，并且不会在登录时启动 - 尽管被设置为在登录时启动 -。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:21:35.397

如果您不能强制您的 shell 使用默认 ruby​​，您需要在每个新 shell 中手动运行默认值：

```
rvm use default 
```

或将采购默认值添加到`~/.bashrc`or `~/.zshenv`：

```
export rvm_path="$HOME/.rvm"
if [[ -s "$rvm_path/environments/default" ]]
then source "$rvm_path/environments/default"
else PATH="$PATH:$rvm_path/bin"
fi 
```

# javascript - 如何使 WebSQL 查询同步？

> ID：14798710
> 
> 赞同：9
> 
> 时间：2013-02-10T14:23:30.653
> 
> 标签：javascript, sqlite, asynchronous, synchronous, web-sql

考虑：

```
var globalvar;

function viewyearmain() {
  db.transaction(function (tx) 
  {
    tx.executeSql('SELECT * FROM BUDGET WHERE holdingtype="month"', [], function (tx, results) 
    {
       var len = results.rows.length;
       msg = len;
       globalvar = msg;
    }, null);

  });

  if (globalvar>0)
  {
    alert("ROWS FOUND");
  }
  else
  {
    alert("ROWS NOT FOUND");
  }
} 
```

出现问题是因为在到达语句`ROWS NOT FOUND`时事务尚未完成。`if`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T21:53:03.177

异步回调不是同步的，无论您想要多少。

只需将依赖于结果的*所有代码移动到回调中：*

```
var globalvar;

function viewyearmain() {
  db.transaction(function (tx) 
  {
    tx.executeSql('SELECT * FROM BUDGET WHERE holdingtype="month"', [], function (tx, results) 
    {
       var len = results.rows.length;
       msg = len;
       globalvar = msg;
       if (globalvar>0)
       {
         alert("ROWS FOUND");
       }
       else
       {
         alert("ROWS NOT FOUND");
       }
    }, null);

  });
} 
```

或者，将其移动到第二个函数中，并从回调中调用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-05-23T08:24:46.993

如今，您可以像这样利用`async / await`和承诺：

```
async function alertResult() {
  const rows = await viewyearmain();
  if (rows.length) {
    alert("ROWS FOUND");
  } else {
    alert("ROWS NOT FOUND");
  }
}

function viewyearmain() {
  return new Promise(resolve => {
    db.transaction(function(tx) {
      tx.executeSql(
        "SELECT * FROM BUDGET WHERE holdingtype = ?;", ["month"],
        function(tx, result) { resolve(result.rows); },
        null
      );
    });
  });
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-11T14:15:09.213

我迟到了几年，但考虑到这个问题从未被直接回答，我想我会投入两分钱，并添加一些建议！

首先，如果您正在阅读本文，您可能不应该使用 WebSQL。它已被[弃用](http://caniuse.com/#search=websql)，取而代之的是 IndexedDB，此时它是 W3C 标准轨道上的唯一数据库。

如果出于某种原因，您打算使用 WebSQL，并且您可以享受其异步 API 提供的好处（其中一些在 John Fowler 的回答中提到），那么您应该知道它的规范还定义了一个[同步 API](https://www.w3.org/TR/webdatabase/#synchronous-database-api) .

所以是的，有一种方法可以在 WebSQL 中同步执行语句，前提是您正在开发的浏览器已经实现了同步 API。

如果您不介意处理与同步接口一样简单的异步接口，请查看[BakedGoods](https://github.com/klawson88/Baked-Goods)。

有了它，执行您的查询就像这样简单：

```
bakedGoods.getAll({
    filter: "valueObj.holdingType === 'month'",
    storageTypes: ["webSQL"],

    //Contains database configuration data and operation preferences
    options: optionsObj,

    complete: function(byStorageTypeResultDataObj, byStorageTypeErrorObj){}
}); 
```

其简单的界面和无与伦比的存储设施支持是以缺乏对某些存储设施特定配置的支持为代价的。例如，它不支持在具有多列主键的 WebSQL 表中进行存储操作。

因此，如果您大量使用这些类型的功能，您可能想看看其他地方。

哦，为了完全透明，BakedGoods 由您真正维护 :) 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-11T14:58:09.273

据我所知，WebSQL 不支持同步 SQL 语句。这通常是一件好事，因为您不希望 SQL 处理中断或冻结您的用户界面。因此，CL. 的答案为处理查询结果提供了正确的异步机制。

但是，如果您真的需要同步 SQL 查询，请查看 WebSQL 替代方案： [SequelSphere - 一个 HTML5/JavaScript SQL 关系数据库](http://www.sequelsphere.com/ "SequelSphere HTML5 JavaScipt SQL 关系数据库")。

它是 100% JavaScript，所以它可以在任何浏览器和任何平台上运行。此外，它将数据存储在 IndexedDB 或 LocalStorage 中。它还包含许多 WebSQL 没有的花里胡哨：JSON 集成、更改跟踪器、用户定义的 SQL 函数、同步 SQL 处理等。由于 WebSQL 标准已被弃用，我认为这是一个很好的替代方案。

完全披露：我喜欢 WebSQL，但我嫁给了 SequelSphere。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-06T05:47:24.857

不太同步 - 但这是一个开始。

创建一个辅助函数以在 Promise 中执行查询

```
const executeSql = (query, params) => new Promise ( (resolve, reject) => {
  tx.executeSql(query, params, resolve, reject);
}; 
```

然后从异步函数运行时，您可以使用“等待”关键字

```
const myFunc = async () => {
   let result = await executeSql("SELECT * FROM BUDGET WHERE holdingtype=?", ["month"]);
} 
```

但是，您可能对事务的结果有疑问，因为一旦 Promise 实现，对象可能会取消引用。

```
const executeSql = (query, params) => new Promise ( (resolve, reject) => {
    tx.executeSql(query, params, 
        (tx, results) => {
            var items = [];
            if(results.rows.length)
            {
                var max = results.rows.length;
                for (var x = 0; x < max; x++) items.push(results.rows.item(x))
            }
            resolve(items)
        }, reject)
    }) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-08T19:34:20.183

现在有点晚了，但值得一提的是……您不能使调用同步，但是您可以使用诸如[Async](https://github.com/caolan/async)之类的库来简化代码。这可能看起来有点矫枉过正，但如果您需要连续执行 3 或 4 条语句，它可以使您的代码更易于阅读。

```
async.waterfall([
    function(callback){
        db.transaction(function (tx) {
            tx.executeSql('SELECT * FROM BUDGET WHERE holdingtype="month"', [], 
                function (tx, results) {
                    var len = results.rows.length;
                    callback(null, len)
                }, 
                function(){
                    callback("An error occurred when reading data");
                }
            }); 
       });
    },
    function(len, callback){
        // Now do something with the length.
        console.log("The length is: " + len);
    }
]); 
```

# ruby-on-rails - Rails：下拉选择到控制器动作

> ID：14798715
> 
> 赞同：0
> 
> 时间：2013-02-10T14:23:58.683
> 
> 标签：ruby-on-rails, forms, controller, interaction

美好的一天，我有这个表单 view/startseites/index.html.erb 并且我在我的 people_controller 中指定了一个方法，她没有去。我准备了一些幽灵代码以供理解。我想将带有 button_to 标记的下拉列表中的条目提供给控制器操作 checkValid。我想在数据库中验证条目。我必须在桌子上读写。我希望它足够清楚。

```
 class PeopleController < ApplicationController

   def checkValid
      @trainerName = params[:trainer_name]
      @sportlerName = params[:sportler_name]
      @trainerPID = params[:trainer_pid]
      @sportlerPID = params[:sportler_pid]

      #checks if sportlerID is null
       @person = Person.find(params[:sportler_pid])
        id = Person.sportler_id
        if id = nil then
             Person.sportler_id = params[:trainerPID]
         else
           puts "Sportler can have only one Trainer!"
        end

   end
   ... 
```

查看/startseites/index.html.erb：这段代码不走

这应该将下拉选择发送到控制器操作 checkValid()。我如何使用参数？

```
 <%=button_to( "Zuordnung erstellen", :action => "checkValid", :controller =>"people" %>** 
```

* * *

```
 <table>
   <tr>
     <td colspan="3">
       Jeder Sportler kann ein Trainer haben. </br>
     </td>
   </tr>
   <tr>
       <td>Trainer</td>
       <td>
          <%= collection_select(:trainer, :trainer_id, Trainer.all, :id, :name) %>

       </td>

       <td>
         <%= link_to 'Neuer Trainer', new_person_path(:type => "Trainer") %>
       </td>

     <tr>
     <tr>
       <td>Sportler</td>
       <td>
           <%= collection_select(:sportler, :sportler_id, Sportler.all, :id, :name) %> 

       </td>
       <td>
         <%= link_to 'Neuer Sportler', new_person_path(:type => "Sportler") %>
       </td>
     <tr>
     <tr>
       <td></td>
       <td></td>
       <td>
        **<%=button_to( "Zuordnung erstellen", :action => "checkValid", :controller => "people") %>**
          </td>
        <tr>

    </table> 
```

我将此行添加到我的路线

```
 match '/people/checkValid', :controller => 'people', :action => 'checkValid' 
```

但是：没有路由匹配 {:controller=>"people/checkValid", :method=>:checkValid}

不，我认为它会发生，但是

模板丢失

```
 Missing template people/checkValid, application/checkValid with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}. Searched in: * "C:/Users/jord/testmood/app/views" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:06:05.833

该`Missing template`错误是指缺少视图。您应该在目录中`check_valid.html.erb`查看文件。`app/views/people/`

此外，`rake routes`在应用程序目录中的任何位置都可以在命令行上运行。您将收到由您的 routes.rb 文件生成的路线列表。如果`people#checkValid`存在，您可以在那里仔细检查。

顺便说一句，您可能想要更改`checkValid`为，`check_valid`以便遵循 Rails 中操作的命名约定。

# java - Android , SQLite .... 主键插入为 null

> ID：14798718
> 
> 赞同：0
> 
> 时间：2013-02-10T14:24:33.613
> 
> 标签：java, android, sql, android-sqlite

我是 android 的初学者，并试图创建一个数据库。具有一张表和三个功能添加，删除，更新和检索。

当我将一个项目插入数据库时​​，主键将被赋予一个每次递增的数字..但它作为空值插入到数据库中！

因此我无法更新和删除记录，因为我需要 id。对于检索，输出工作正常，除了 id 它为空。

这是架构

```
private static final int DATABASE_VERSION = 2;
private static final String DATABASE_NAME= "alarmapp"; 
private static final String CREATE_alarm= "CREATE TABLE alarm" +
        " (Aid integer  PRIMARY KEY NOT NULL AUTOINCREMENT," +
        "message varchar(100)," +
        "date varchar(100));"; 
```

这是插入代码：

```
// columns 
private static final String AI = "Aid";
private static final String Message= "message";
private static final String Date = "date";

// tables
private static final String TABLE_NAME= "alarm";

private Context context;
private DatabaseHelper dbhelper;
private SQLiteDatabase database;

public long add( String message, String date) {
    ContentValues values= new ContentValues();

    values.put(Message,message);
    values.put(Date, date);

    return database.insert(TABLE_NAME, null,values);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T14:34:01.227

查看以下链接： [http ://www.androidph.com/2012/01/android-sqlite-primary-key-auto.html](http://www.androidph.com/2012/01/android-sqlite-primary-key-auto.html)

# android - tessbaseAPI.getUTF8Text() 在三星 GalaxyTab 上运行时崩溃

> ID：14798721
> 
> 赞同：0
> 
> 时间：2013-02-10T14:24:42.310
> 
> 标签：android, tesseract

我正在开发基于 OCR 的*Android*应用程序。我正在使用 Tesseract 库。我的应用程序在*索尼爱立信 Xperia Arc S*设备上运行良好。*但是，相同的应用程序在我的Samsung Galaxy Tab 8.9*上崩溃了。我不确定为什么会这样。以下是代码片段：

```
TessBaseAPI baseApi = new TessBaseAPI();

baseApi.init(Environment.getExternalStorageDirectory().toString() + "/tesseract/", "eng",TessBaseAPI.OEM_DEFAULT); 
baseApi.setImage(bitmap);

String recognizedText=baseApi.getUTF8Text();    //App Crashes here 
```

如何解决？

不幸的是，logCat 没有报告任何错误。

以下是我在 logCat 中看到的输出：

```
02-12 09:57:20.720: I/Tesseract(native)(5577): Initialized Tesseract API with language=eng
02-12 09:57:20.720: D/dalvikvm(5577): Trying to load lib /data/data/com.project.meter_reader/lib/liblept.so 0x4074d618
02-12 09:57:20.720: D/dalvikvm(5577): Shared lib '/data/data/com.project.meter_reader/lib/liblept.so' already loaded in same CL 0x4074d618
02-12 09:57:21.030: D/dalvikvm(5577): Trying to load lib /data/data/com.project.meter_reader/lib/liblept.so 0x4074d618
02-12 09:57:21.030: D/dalvikvm(5577): Shared lib '/data/data/com.project.meter_reader/lib/liblept.so' already loaded in same CL 0x4074d618
02-12 09:57:24.160: I/dalvikvm(5577): threadid=4: reacting to signal 3
02-12 09:57:24.160: I/dalvikvm(5577): Wrote stack traces to '/data/anr/traces.txt' 
```

在`baseApi.getUTF8Text()`应用程序显示一个空白屏幕并停止响应时，调试器就会分离。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-27T12:32:52.353

我在本机库中使用 Tesseract 3.0.19 时遇到了类似的问题。将 tess-data 更新到 3.02 版对我有帮助。

# algorithm - 算法分析：大 O/最坏情况

> ID：14798724
> 
> 赞同：-1
> 
> 时间：2013-02-10T14:24:51.810
> 
> 标签：algorithm

一个家庭作业问题要求我分析以下代码片段：

```
for (int i = N; i > 0; i--)
    for (int j = 0; j < i; j++) 
```

我认为内部循环运行以下次数：

```
N + (N-1) + (N-2) + ... + (N - N + 1) 
```

但是，我无法将其转换为 O() 表示法。

有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:38:10.977

通过观察，内部循环运行了 1 + 2 + ... + N 次。那正是 N(N+1)/2 （这是三角数的公式）。首先，记住 big-O 的定义：如果 |f/g| 则 f 是 O(g) 有足够大的 N 为界。例如，这是 O(exp(n))，也是 O(n^3)。也是 O(N(N+1)/2)，但你的老师可能期待 O(N^2) 的答案。如何证明这是 O(N^2)？那么 (N(N+1)/2) / N^2 是 1/2 + 1/2N。对于 N > 0，它以 1 为界。

# php - 收件人回复 php-script 发送的电子邮件时自动抄送

> ID：14798725
> 
> 赞同：0
> 
> 时间：2013-02-10T14:24:59.953
> 
> 标签：php, html, email

我有一个标准的 php '从 html 表单发送邮件' 脚本。有没有办法修改这个，这样收件人会自动抄送地址到他们的回复中？

希望这很清楚，并在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:30:09.043

你能做的最好的事情就是在你的标题中包含一个 cc 到那个地址。然后，如果您很幸运，用户将选择“全部回复”。

# c++ - 向量元素是否保证有序？

> ID：14798727
> 
> 赞同：3
> 
> 时间：2013-02-10T14:25:06.087
> 
> 标签：c++, vector

我知道拥有指向向量元素的指针是一个坏主意，因为在扩展时，所涉及的内存地址会发生变化，因此会使指针无效。但是，如果我只是使用一个整数来保存我想要访问的元素的索引号呢？随着向量大小的增长，这会失效吗？我在想的是这样的：

```
 #include <vector>

    class someClass{
    string name
    public: string getName(){return name;}
    };

    vector<someClass> vObj;
    int currIdx;
    string search;
    cout<<"Enter name: ";
    cin>>search;

    for(int i=0; i<vObj.size(); i++){
      if(vObj[i].getName()==search)
         currIdx = i;} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T14:26:59.780

不，当向量扩展时，索引号当然不会失效。但是，如果您删除前一个元素，它们将无效（从某种意义上说，您不再在恒定索引处找到相同的元素）：

`vector: 3 5 1 6 7 4`

在这里，`vector[2] == 1`。但是如果你删除`vector[1]`（5），那么之后，`vector[2] == 6`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T14:30:05.147

我认为你的问题的标题和你似乎在问什么并不真正匹配。根据定义，没有向量保证被排序，因此元素不会“按顺序”。

此外，**只有**在发生重新分配时（即当向量的大小超过其容量时） ，*所有*迭代器和对向量元素的引用才会在插入时失效。否则，插入点*之前*的迭代器和引用不会失效（参见 C++11 标准的第 23.3.6.5/1 段）。

 ***存储索引只会受到潜在的*逻辑*失效的影响：如果您将元素插入到向量中您正在索引的位置*之前*的位置，您正在索引的元素将向右移动一个位置，并且相同的索引现在将引用不同的元素；同样，如果您在索引位置之前擦除元素，则您索引的元素将在位置上向左移动 - 您的索引现在可能指的是超出范围的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T14:26:38.547

它不应该，因为系统会简单地分配更多的内存，然后做一个 memcopy。

顺序应保留在 std::vector STL 模板中。

是的，如果您删除元素，排序将会改变。但是，如果您要进行大量删除，请使用不同的数据结构，例如链表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T14:28:39.720

不，当向量展开时，索引号不会失效。由于您声明向量容器对象不是指针`vector<someClass>`而不是`vector<someClass*>`，因此您指向的元素也将被保留。***

# internet-explorer-8 - 如何在用户需要时通过 bho 获取 html 文本，而不是在 OnDocumentComplete （高于 ie8）

> ID：14798730
> 
> 赞同：0
> 
> 时间：2013-02-10T14:25:34.760
> 
> 标签：internet-explorer-8, bho, ihtmldocument

这些步骤是我所做的。

1）我刚刚从 SetSite 中的 pUnkSite 获得了 IWebBrowser2 接口指针，就像大多数 bhos 通常所做的那样。

2) 在 OnDocumentComplete 中，2-1) 从 IWebBrowser2 成功获得 IHTMLDocument 接口指针。2-2) 从 IHTMLDocument 获取 html 文本

我确认上述这些步骤工作正常。

但我真正想做的是，只要用户想要获取 html 文本（例如，用户单击“获取 html”按钮），bho 就会显示包含当前页面的 html 的消息框。

因此，当用户单击“获取 html”按钮时，我编写了一个函数来执行此操作，如下所示。

```
void CBHO::ClickedOnGetHtml()
{
    CComPtr<IDispatch> spDispDoc; 
    HRESULT hr = m_spWebBrowser->get_Document(&spDispDoc);  // m_spWebBrowser from SetSite
    if (SUCCEEDED(hr))
    {
        CComQIPtr<IHTMLDocument2> spHtmlDoc;
        spHtmlDoc = spDispDoc;
        CComPtr<IDispatch> spDisp;   
        spHtmlDoc->get_Script(&spDisp);        <- exception occured here in ie8\. (worked correctly in ie6, but not in ie8.)
    }
} 
```

这是发生异常时的调用堆栈。

```
mshtml.dll!GetCurrentServiceProvider()  + 0xc bytes
mshtml.dll!GetCallerCommandTarget()  + 0xa6 bytes
mshtml.dll!COmWindowProxy::SecureObject()  - 0x600c5 bytes
mshtml.dll!CDocument::get_Script()  + 0x9c bytes
BHO.dll!CBHO::ClickedOnGetHtml()  line 37 + 0x2d bytes C++ 
```

更有趣的是它在 ie6 中可以正常工作，但在 ie8 中不能正常工作。（与 ie6 相比，ie8 有什么变化吗？）

请留下任何关于这个问题的建议或意见，

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:06:34.530

尝试使用[outerHTML](http://msdn.microsoft.com/en-us/library/ie/ms534310%28v=vs.85%29.aspx)属性获取页面 HTML：

```
CString GetOuterHTML(IWebBrowser2* pWebBrowser)
{
    CComDispatchDriver pDocDisp; 
    if(SUCCEEDED(pWebBrowser->get_Document(&pDocDisp)) && pDocDisp != NULL)
    {
        CComQIPtr<IHTMLDocument3> pDoc3 = pDocDisp;
        if(pDoc3 != NULL)
        {
            CComPtr<IHTMLElement> pRootElem;
            if(SUCCEEDED(pDoc3->get_documentElement(&pRootElem)) && pRootElem != NULL)
            {
                CComBSTR bstrText;
                if(SUCCEEDED(pRootElem->get_outerHTML(&bstrText)))
                {
                    return bstrText;
                }
            }
        }
    }
    return L"";
} 
```

# android - NDEF URI 有效负载中的非法字符

> ID：14798731
> 
> 赞同：1
> 
> 时间：2013-02-10T14:25:36.987
> 
> 标签：android, nfc, ndef

我正在编写基于 NFC 的应用程序，该应用程序将使用 Url 扫描 NFC 标签。扫描标签后，应用程序应从数据库中检索信息并将其显示在 ListView 中。

扫描 NFC 标签时发生错误。

```
 Error in http connection java.lang.IllegalArgumentException: Illegal character in scheme at index 0: ??http://abc.com/~090123/get_items.php 
```

logcat`??`之前会显示一些奇怪的字符`http://`。

我正在使用以下代码在标签中编写 Url：

```
private boolean writeTag(Tag tag) {         
    byte[] uriField = "http://abc.com/~090123/get_items.php".getBytes(Charset.forName("US-ASCII"));
    byte[] payload = new byte[uriField.length + 1];

    System.arraycopy(uriField, 0, payload, 1, uriField.length);         

    NdefRecord uriRecord = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
                NdefRecord.RTD_URI, new byte[0], payload);
    NdefMessage message = new NdefMessage(new NdefRecord[] { uriRecord});
    // ....
} 
```

我收到来自 NFC 标签的意图，如下所示：

```
protected void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
    setContentView(R.layout.content_display);           

    Intent intent =  getIntent();    

    if(NfcAdapter.ACTION_NDEF_DISCOVERED.equals(getIntent().getAction())) {

        Parcelable[] rawMsgs = intent.getParcelableArrayExtra(
            NfcAdapter.EXTRA_NDEF_MESSAGES);

        if(rawMsgs != null) {           

            NdefMessage msg = (NdefMessage) rawMsgs[0];        

            GetData getData = new GetData(this);
                getData.execute(new String(msg.getRecords()[0].getPayload()));
        }
    }
} 
```

我正在使用以下代码从数据库中检索信息：

```
protected BufferedReader doInBackground(String... params) {
    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    try {
        HttpClient httpclient = new DefaultHttpClient();

        for (int i = 0; i < params.length; i++) 
        {
            HttpPost httppost = new HttpPost(params[i]);
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
             is = entity.getContent();
        }

    } catch (Exception e) {
            Log.e("log_tag", "Error in http connection " + e.toString());
    }

    Log.e("Input Stream", "Input Stream:" + is);

    BufferedReader myReader = new BufferedReader(new InputStreamReader(is));

    return myReader;
} 
```

我对以前的 NDEF 记录有这样的意图过滤器：

```
<activity
            android:name=".DisplayContentActivity"
            android:label="@string/app_name" >

            <intent-filter>
                <action android:name="android.nfc.action.NDEF_DISCOVERED" />
                <data
                    android:host="abc.com"
                    android:pathPrefix="/~090123/get_items.php"
                    android:scheme="http" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:52:23.533

URI 有效负载的第一个字节是*URI 标识符代码*，它是一个 URI 前缀，例如`http://www.`or `mailto:`。您在有效负载长度中正确添加了一个字节，并`1`在复制 URL 时使用了偏移量。你永远不会写这个字节，所以它仍然存在`0x00`（*没有前缀*），这意味着你需要写整个 URL。这很好，但如果您想保存几个字节，您可以将其设置`0x03`为前缀。`http://`

使用 读取有效负载时`msg.getRecords()[0].getPayload()`，您需要切断该字节并自己添加前缀。我认为没有本机 Android API，因此您必须自己查找前缀或尝试其他答案中提到的库。

要正确读取 uri，您应该使用以下内容：

```
byte[] payload = msg.getRecords()[0].getPayload();
byte identifierCode = payload[0];

String prefix = getUrlPrefix(identifierCode); // you need to implement this one
String url = prefix +
    new String(payload, 1, payload.length -1, Charset.forName("US-ASCII"));

getData.execute(url); 
```

该方法`getUrlPrefix`可以包含一个简单的 switch 语句来返回标识符代码的前缀字符串。

您可以在此处查看代码列表：[关于 NDEF 格式](http://learn.adafruit.com/adafruit-pn532-rfid-nfc/ndef)

> ```
> Value    Protocol
> -----    --------
> 0x00     No prepending is done ... the entire URI is contained in the URI Field
> 0x01     http://www.
> 0x02     https://www.
> 0x03     http://
> 0x04     https://
> 0x05     tel:
> 0x06     mailto:
> 0x07     ftp://anonymous:anonymous@
> 0x08     ftp://ftp.
> 0x09     ftps://
> 0x0A     sftp://
> ... 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:46:46.487

您正在错误地解析 NDEF 记录。第一个字节不是字符。要么阅读 NFC 论坛标准，要么查看我为在这种情况下提供帮助而创建的这个[库。](http://code.google.com/p/ndef-tools-for-android/)您可以查看 Android 源代码以了解您尝试读取的记录是如何构建的。

# javascript - 在 jQuery 中向下滑动

> ID：14798733
> 
> 赞同：0
> 
> 时间：2013-02-10T14:25:48.323
> 
> 标签：javascript, jquery, html

我希望在我的页面上获得类似于 host-gators 实时聊天的效果，我看过[这里](https://stackoverflow.com/questions/8702912/jquery-slidedown-on-page-load)，这与我想要实现的类似，但是有一个问题，`div`比如开始`height:1px`并向下滑动`div`到它的原始高度，我想要的是让`div`s 高度始终相同，并且它从页面顶部而不是顶部向下滑动`div`，我希望这能很好地解释它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:32:31.400

你的意思是`blind`-效果。看看这里： http: [//fiddle.jshell.net/cZQTR/](http://fiddle.jshell.net/cZQTR/)

我为那个 fx 写了一个小插件：

```
jQuery.fn.blindToggle = function (duration, easing, complete) {
    return this.animate({
        marginTop: parseFloat(this.css('marginTop')) < 0 ? 0 : -this.outerHeight(true)
    }, jQuery.speed(duration, easing, complete));
}; 
```

**更新**

```
jQuery.fn.blindUp = function (duration, easing, complete) {
    return this.animate({
        marginTop: -this.outerHeight(true)
    }, jQuery.speed(duration, easing, complete));
};

jQuery.fn.blindDown = function (duration, easing, complete) {
    return this.animate({
        marginTop: 0
    }, jQuery.speed(duration, easing, complete));
}; 
```

**[演示](http://fiddle.jshell.net/cZQTR/8/)**

# c++ - 我应该使用 static_cast 还是 INT64_C 可移植地分配 64 位常量？

> ID：14798739
> 
> 赞同：3
> 
> 时间：2013-02-10T14:26:39.970
> 
> 标签：c++, static-cast, int64

将 64 位常量分配为

```
int64_t foo = 0x1234LL; 
```

不可移植，因为`long long` 不一定`int64_t`. 这篇文章[哪个初始化程序适合 int64_t？](https://stackoverflow.com/q/13275136/252576)讨论了`INT64_C()`宏 from的使用`<stdint.h>`，但是否也可以使用`static_cast`as

```
int64_t foo = static_cast<int64_t>(0x1234); 
```

?

我应该更喜欢哪一个，为什么，或者它们都运作良好？

我在互联网和 SO 上进行了搜索，但没有找到任何`static_cast`探索该选项的地方。我还进行了测试，`sizeof()`以确认它在简单的情况下有效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:33:02.163

实际上，`long long`C 实现限制标头保证至少为 64 位`<climits>`。类型对象的最小值和最大值的最小限制`long long`为：

```
LLONG_MIN   -9223372036854775807 // −(2^63 − 1)
LLONG_MAX   +9223372036854775807 // 2^63 − 1 
```

这对应于带符号的 64 位整数。如果没有至少 64 个信息位，您将无法存储这样一个范围的值。

所以继续使用`0x1234LL`. 事实上，您也可以不使用后缀，因为将选择以下可以适合该值的类型中的第一个：

```
Suffix | Decimal constants | Octal or hexadecimal constant
-------|-------------------|------------------------------
none   | int               | int
       | long int          | unsigned int
       | long long int     | long int
       |                   | unsigned long int
       |                   | long long int
       |                   | unsigned long long int
...    | ...               | ... 
```

# android - 在android上显示导航栏

> ID：14798740
> 
> 赞同：0
> 
> 时间：2013-02-10T14:26:44.273
> 
> 标签：android, sony

我的 android (4.0.4) 手机 (xperia neo L) 带有用于 4 个主要操作（返回、主页、设置、搜索）的物理按钮

是否也可以在操作系统中提供这些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:09:28.387

要打开菜单（与单击菜单物理按钮的行为相同），只需使用活动的 openOptionsMenu() 方法。

这是一个使用按钮打开菜单的代码：

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

        Button button = (Button) findViewById(R.id.testButton);

        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                openOptionsMenu();
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

# c# - 如何根据与点的距离计算新的经纬度

> ID：14798751
> 
> 赞同：0
> 
> 时间：2013-02-10T14:29:05.583
> 
> 标签：c#, map, latitude-longitude

我正在尝试根据与该点的距离（以米为单位）从该点计算新的纬度。

我在这里和其他地方发现了一些有用的帖子，但我仍然遇到了一些麻烦。

这是我到目前为止的代码：

```
 public LatLon CalculateNewCoords(decimal startingLat, decimal startingLon, int distanceEast, int distanceNorth)
    {
        int r = 6378137;
        decimal dLat = Convert.ToDecimal(distanceNorth) / Convert.ToDecimal(r);

        decimal pi = Convert.ToDecimal(Math.PI);
        double cosInput = Convert.ToDouble(pi * startingLat / Convert.ToDecimal(180));

        decimal dLon = Convert.ToDecimal(distanceEast) / Convert.ToDecimal(Convert.ToDouble(r) * Math.Cos(cosInput));

        decimal lat0 = startingLat + dLat * (180 * pi);
        decimal lon0 = startingLon + dLon * (180 / pi);     

        LatLon output = new LatLon();
        output.Latitude = lat0;
        output.Longitude = lon0;

        return output;
    } 
```

经度似乎是正确的，但纬度显示得非常明显。

我使用它如下：

```
CalculateNewCoords(Convert.ToDecimal(40.743461), Convert.ToDecimal(-74.175847), 0, 1000); 
```

有人可以指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:34:01.013

错误在第一行：

```
 decimal lat0 = startingLat + dLat * (180 * pi);
    decimal lon0 = startingLon + dLon * (180 / pi); 
```

这肯定是不正确的，两条线必须使用相同的弧度到度数的转换。替换为第 2 行中的 180/pi
。如果使用十进制，请进一步考虑使用双精度数。

# javascript - 如何从数组中检查

> ID：14798762
> 
> 赞同：0
> 
> 时间：2013-02-10T14:30:15.783
> 
> 标签：javascript, arrays

```
var a=new Array;
for (j=0;j<=10;j++) {
a[j]=Math.floor(Math.random()*99)+2
}

var check=Math.floor(Math.random()*99)+2 
```

那么如何检查是否`check`是任何`a[j]`（即`a[0]`to `a[10]`）的值？一个又好又简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:32:39.800

试试这个：

```
a.indexOf(check) > -1 
```

# java - 使用 JAXB 解析 XML，面临 Unmarshal 绑定注释错误

> ID：14798764
> 
> 赞同：1
> 
> 时间：2013-02-10T14:30:31.290
> 
> 标签：java, xml-parsing, jaxb, unmarshalling

XML 输入：[http ://maps.googleapis.com/maps/api/geocode/xml?address=Connaught+Place,+New%20+Delhi,+India&sensor=true](http://maps.googleapis.com/maps/api/geocode/xml?address=Connaught+Place,+New%20+Delhi,+India&sensor=true)

我正在尝试使用 JAXB 从此 XML（以上链接）获取数据。我的目标是获取给定地址的纬度和经度。

我已经制作了这些类，但缺少绑定注释。帮助得到这个，在此先感谢

* * *

编辑：现在我的代码可以正常工作了，所以我在其答案中粘贴了新代码

* * *

```
public class JAXBExample {
    public static void main(String[] args) {

     try {

        File file = new File("GeoLocation.xml");
        JAXBContext jaxbContext = JAXBContext.newInstance(GeocodeResponse.class);//(GeocodeResponse.class);

        Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();
        GeocodeResponse latLong = (GeocodeResponse) jaxbUnmarshaller.unmarshal(file);

        System.out.println(latLong);
//      System.out.println(latLong.getLatitude()+ ", "+latLong.getLongitude());

      } catch (JAXBException e) {
        e.printStackTrace();
      }

    }
} 
```

* * *

```
 @XmlType(propOrder={"latitude","longitude"})
public class Location {

    double lat;
    double lng;

//  @XmlElement(name="lat")
    public double getLatitude() {
        return lat;
    }

//  @XmlElement
    @XmlElement(name="lat")
    public void setLatitude(double latitude) {
        this.lat = latitude;
    }

//  @XmlElement(name="lng")
    public double getLongitude() {
        return lng;
    }

//  @XmlAttribute
    @XmlElement(name="lng")
    public void setLongitude(double longitude) {
        this.lng = longitude;
    }

} 
```

* * *

```
@XmlType(propOrder={"geometry"})
public class Geometry {
    Location aLocation;

//  @XmlElement(name="location")
    public Location getaLocation() {
        return aLocation;
    }

    @XmlElement(name="location")
    public void setaLocation(Location aLocation) {
        this.aLocation = aLocation;
    }

} 
```

* * *

```
@XmlType(propOrder={"result"})
public class Result {
    Geometry aGeometry;

//  @XmlElement(name="geometry")
    public Geometry getaGeometry() {
        return aGeometry;
    }

    @XmlElement(name="geometry")
    public void setaGeometry(Geometry aGeometry) {
        this.aGeometry = aGeometry;
    }
} 
```

* * *

```
@XmlRootElement
public class GeocodeResponse {
    Result aResult;

    public Result getaResult() {
        return aResult;
    }

    @XmlElement(name = "result")
    public void setaResult(Result aResult) {
        this.aResult = aResult;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T16:59:47.430

## 只是我修复了代码所以在这里我将其粘贴在这里，以便有人使用它。

```
import java.io.File;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Unmarshaller;

public class JAXBxmlToJavaCordinate {
    public static void main(String[] args) {

     try {

        File file = new File("resources/GeoLocation.xml");
        JAXBContext jaxbContext = JAXBContext.newInstance(GeocodeResponse.class);

        Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();
        GeocodeResponse geoResponse = (GeocodeResponse) jaxbUnmarshaller.unmarshal(file);

        Location latLong = geoResponse.getaResult().getGeometry().getLocation();

        System.out.println(latLong.getLatitude()+ ", "+latLong.getLongitude());

      } catch (JAXBException e) {
        e.printStackTrace();
      }

    }
} 
```

* * *

```
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name="GeocodeResponse")
public class GeocodeResponse {
    Result result;

    public Result getaResult() {
        return result;
    }

    @XmlElement(name = "result")
    public void setResult(Result result) {
        this.result = result;
    }
} 
```

* * *

```
import javax.xml.bind.annotation.*;

@XmlRootElement
public class Result {
    Geometry geometry;

    public Geometry getGeometry() {
        return geometry;
    }

    @XmlElement(name="geometry")
    public void setGeometry(Geometry geometry) {
        this.geometry = geometry;
    }
} 
```

* * *

```
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlType;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name="geometry")
public class Geometry {
    Location location;

    public Location getLocation() {
        return location;
    }

    @XmlElement(name="location")
    public void setaLocation(Location location) {
        this.location = location;
    } 
```

## }

```
import javax.xml.bind.annotation.XmlAttribute;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlType(propOrder={"latitude","longitude"})
public class Location {

    double lat;
    double lng;

    public double getLatitude() {
        return lat;
    }

    @XmlElement(name="lat")
    public void setLatitude(double latitude) {
        this.lat = latitude;
    }

    public double getLongitude() {
        return lng;
    }

    @XmlElement(name="lng")
    public void setLongitude(double longitude) {
        this.lng = longitude;
    }

} 
```

# java - 画布 - 良好的渲染实践？

> ID：14798767
> 
> 赞同：18
> 
> 时间：2013-02-10T14:31:17.763
> 
> 标签：java, rendering

我最近一直在使用 Canvas 进行小型 Java 游戏，我注意到可能会发生很多奇怪的事情。例如，今天早些时候我创建了一个小游戏，其目标是射击敌舰并获得积分。游戏在屏幕上绘制了微小的 32x32 图像（有时略大），出于某种我没有注意到的原因，游戏呈现奇怪。

例如，我的船头上有一个健康栏：

![在此处输入图像描述](../Images/0b93121c46d6c81cdbcdd93c618b2405.png)

正如您从图像中看到的那样，纹理非常小。尽管如此，游戏还是会滞后，有时会出现这样的错误渲染，例如：

![在此处输入图像描述](../Images/dc19e8b5ff0b8bc88bae4a0f6ddc3a02.png)

如果您仔细查看生命值条的顶部，您会发现它略微向上移动，这让我感到困惑，因为我的所有渲染都被缓冲了。

我的渲染代码：

```
public void render(){
    BufferStrategy bs = getBufferStrategy();
    if(bs == null){
        createBufferStrategy(3);
        return;
    }
    Graphics2D g = (Graphics2D)bs.getDrawGraphics();
    toDrawG.setColor(new Color(0x222222));
    toDrawG.fillRect(0, 0, WIDTH, HEIGHT);
    draw((Graphics2D)toDrawG);
    g.drawImage(toDraw, 0, 0, null);
    g.dispose();
    bs.show();
}

public void draw(Graphics2D g){
    if(Settings.planets){
    renderer.renderPlanets();
    }
    if(level != null){
    for(int i = 0 ; i < level.entityList.size(); i++){
        if(level.entityList.get(i) != null){
        level.entityList.get(i).render(renderer);
        }
        }
    }
    renderer.overlayString("Space Game", 20, 20, 24, 0xFFFFFF);
    renderer.overlayString(VERSION, 20, 50, 24, 0xFFFFFF);
    renderer.overlayString("FPS: " + renderer.fps, 20, 70, 24, 0xFFFFFF);
    renderer.overlayString("Ships spawned: " + level.shipsSpawned, 20, 90, 24,     0xFFFFFF);
    renderer.overlayString("Time Survived: " + level.time / 100 + "s", 20, 110,     24, 0xFFFFFF);
    renderer.overlayString("Physics FPS: " + fps, 20, 130, 24, 0xFFFFFF);

    if(currentGui != null){
        currentGui.render(renderer);
    }else{
        map.drawMinimap(SpaceGame.WIDTH-Minimap.WIDTH-20, SpaceGame.HEIGHT-    Minimap.HEIGHT-30);
    }

} 
```

如果你需要学习我的“Render.class”：

```
package com.maestrum;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.image.BufferedImage;
import java.awt.image.ConvolveOp;
import java.awt.image.Kernel;
import java.util.Random;

public class Render implements Runnable{

public Graphics2D g2d;

public double xScroll,yScroll;

public int frames;
public int fps;
public long lastTime;

public int[] pSequence = new int[40];   
public SpaceGame game;

public Entity trackedEntity;

public Random rand;

public Render(SpaceGame game, Graphics2D g){
    this.game = game;
    this.g2d = g;
    this.rand = new Random();
    for(int i = 0 ; i < 40; i++){
        pSequence[i] = rand.nextInt(15) + 1;
    }
}

@Override
public void run() {     
    renderLoop();
}

public void renderLoop(){
    while(true){
        game.render();
        if(System.currentTimeMillis() - lastTime >= 1000){
            fps = frames;
            frames = 0;
            lastTime = System.currentTimeMillis();
        }
        frames++;
    }
}

public void renderPlanets(){
    overlayImage(ImageHandler.background, 0, 0, 1.5);
    for(int i = 0 ; i < 20; i++){
        overlayImage(ImageHandler.planets[pSequence[i]/4][pSequence[i]%4], i * 400 - xScroll/pSequence[i], i * pSequence[i]*40 - yScroll/pSequence[i]*2, pSequence[i]);
    }
}

private class PlanetRenderer {

}

public void overlayString(String s, double x, double y, int fontSize, int colour){
    drawString(s, x+xScroll, y+yScroll, fontSize, colour);
}

public void overlayRectangle(double x, double y, int xs, int ys, int colour){
    drawRectangle(x+xScroll, y+yScroll, xs, ys, colour);
}

public void overlayBlurred(BufferedImage img, double x, double y, double scale){
    drawImageBlurred(img, x+xScroll, y+yScroll, scale);
}

public void overlayImage(BufferedImage img, double x, double y, double scale){
    drawImage(img, x+xScroll, y+yScroll, scale);
}

public BufferedImage execute(BufferedImage img) {
    // TODO Auto-generated method stub
    float weight = 1.0f/2.0f;

    float [] elements = {weight, weight, weight, weight, weight, weight, weight, weight, weight};

    Kernel k = new Kernel (3,3,elements);
    ConvolveOp op = new ConvolveOp(k);

    BufferedImage dest = new BufferedImage(img.getWidth(), img.getHeight(), img.getType());

    op.filter(img, dest);
    return dest;
}

public void drawImageBlurred(BufferedImage img, double x, double y, double scale){
    x -= xScroll;
    y -= yScroll;
    BufferedImage image = new BufferedImage((int)(img.getWidth()*scale), (int)(img.getHeight()*scale), BufferedImage.TYPE_INT_ARGB);
    Graphics g = image.getGraphics();
    g.drawImage(img, 0, 0, (int)(img.getWidth()*scale), (int)(img.getHeight()*scale), null);
    execute(image);
    g2d.drawImage(image, (int)x, (int)y, null);
    g.dispose();
}

public void drawString(String s, Vector2D pos, int fontSize, int colour){
    drawString(s, pos.x, pos.y, fontSize, colour);
}

public void drawString(String s, double x, double y, int fontSize, int colour){
    if(s == null){
        return;
    }
    x -= xScroll;
    y -= yScroll;
    BufferedImage img = new BufferedImage(s.length()*fontSize+1, fontSize*2, BufferedImage.TYPE_INT_ARGB);
    Graphics g = img.getGraphics();
    g.setColor(new Color(colour));
    g.setFont(new Font("Consolas", Font.BOLD, fontSize));
    g.drawString(s, 0, img.getHeight()/2);
    g2d.drawImage(img, (int)x, (int)y, null);
    g.dispose();
}

public void drawImage(BufferedImage img, Vector2D pos, double scale){
    drawImage(img, pos.x, pos.y, scale);
}

public void drawLine(Vector2D v1, Vector2D v2, int colour, int width){
    drawLine(v1.x, v1.y, v2.x, v2.y, colour, width);
}

public void drawLine(double x1, double y1, double x2, double y2, int colour, int lWidth){
    x1 -= xScroll;
    y1 -= yScroll;
    x2 -= xScroll;
    y2 -= yScroll;
    g2d.setColor(new Color(colour));
    g2d.setStroke(new BasicStroke(lWidth));
    g2d.drawLine((int)x1, (int)y1, (int)x2, (int)y2);
}

public void drawImage(BufferedImage img, double x, double y, double scale){
    x -= xScroll;
    y -= yScroll;
    BufferedImage image = new BufferedImage((int)(img.getWidth()*scale), (int)(img.getHeight()*scale), BufferedImage.TYPE_INT_ARGB);
    Graphics g = image.getGraphics();
    g.drawImage(img, 0, 0, (int)(img.getWidth()*scale), (int)(img.getHeight()*scale), null);
    g2d.drawImage(image, (int)x, (int)y, null);
    g.dispose();
}

public void drawRectangle(Vector2D pos, int xs, int ys, int colour){
    drawRectangle(pos.x, pos.y, xs, ys, colour);
}

public void drawRectangle(double x, double y, int xs, int ys, int colour){
    if(xs <= 0){
        return;
    }
    x -= xScroll;
    y -= yScroll;
    BufferedImage image = new BufferedImage(xs, ys, BufferedImage.TYPE_INT_RGB);
    Graphics2D g = (Graphics2D) image.getGraphics();
    g.setColor(new Color(colour));
    g.fillRect(0, 0, xs, ys);
    g2d.drawImage(image, (int)x, (int)y, null);
    g.dispose();
}

public void drawImageRotated(BufferedImage img, Vector2D pos, double scale, double angle) {
    drawImageRotated(img, pos.x, pos.y, scale, angle);
}

 public void drawImageRotated(BufferedImage img, double x, double y, double scale, double angle) {
        x -= xScroll;
        y -= yScroll;  
        BufferedImage image = new BufferedImage((int)(img.getWidth() * 1.5D), (int)(img.getHeight() * 1.5D), 2);
        Graphics2D g = (Graphics2D)image.getGraphics();
        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g.rotate(Math.toRadians(angle), image.getWidth() / 2, image.getHeight() / 2);
        g.drawImage(img, image.getWidth() / 2 - img.getWidth() / 2, image.getHeight() / 2 - image.getHeight() / 2, null);
        g2d.drawImage(image, (int)(x-image.getWidth()*scale/2), (int)(y-image.getHeight()*scale/2), (int)(image.getWidth()*scale), (int)(image.getHeight()*scale), null);
        g.dispose();      
 } 
```

}

正如您在渲染类中看到的那样，渲染过程每秒完成尽可能多的次数。这是为了给游戏尽可能高的 FPS。如果您错过了我要问的重点；在使用 Java 渲染内容时，我应该考虑哪些好的做法？而且，是什么可能导致太空船的健康条呈现这样的？

注意：看一下这个视频，我运行该程序并获得了 80FPS 和 50000 个粒子，但是使用我的渲染代码（显然质量低得多）我只能渲染 100 个左右的粒子，然后事情就开始搞砸了向上。

[http://www.youtube.com/watch?v=6M3Ze4Eu87Y](http://www.youtube.com/watch?v=6M3Ze4Eu87Y)

这是我的tick() 函数，它在每个游戏tick (10ms) 中被调用

```
public void tick(){
    if(System.currentTimeMillis() - lastTime >= 1000){
        fps = frames;
        frames = 0;
        lastTime = System.currentTimeMillis();
    }
    frames++;
    if(renderer.trackedEntity != null){
        renderer.xScroll = renderer.trackedEntity.pos.x-SpaceGame.WIDTH/2;
        renderer.yScroll = renderer.trackedEntity.pos.y-SpaceGame.HEIGHT/2;
    }
    if(level != null && !paused){
        level.tick();
    }
    if(currentGui != null && currentGui.pausesGame()){
        paused = true;
    }else{
        paused = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T11:46:46.043

我认为@mantrid 的答案应该可以解决您的问题。就性能而言……您的代码中有一些明显的“罪过”：

**不要将图像绘制成图像来绘制图像**

```
public void drawImage(BufferedImage img, double x, double y, double scale){
    x -= xScroll;
    y -= yScroll;
    BufferedImage image = new BufferedImage((int)(img.getWidth()*scale), (int)(img.getHeight()*scale), BufferedImage.TYPE_INT_ARGB);
    Graphics g = image.getGraphics();
    g.drawImage(img, 0, 0, (int)(img.getWidth()*scale), (int)(img.getHeight()*scale), null);
    g2d.drawImage(image, (int)x, (int)y, null);
    g.dispose();
} 
```

我不明白这一点。为什么不这样做：

```
public void drawImage(BufferedImage img, double x, double y, double scale){
    g2d.drawImage(img, (int)(x-xScroll), (int)(y-yScroll), (int)(img.getWidth()*scale), (int)(img.getHeight()*scale), null);
} 
```

**啊啊啊啊啊**

下一个真的烧了我的眼睛

```
public void drawRectangle(double x, double y, int xs, int ys, int colour){
    if(xs <= 0){
        return;
    }
    x -= xScroll;
    y -= yScroll;
    BufferedImage image = new BufferedImage(xs, ys, BufferedImage.TYPE_INT_RGB);
    Graphics2D g = (Graphics2D) image.getGraphics();
    g.setColor(new Color(colour));
    g.fillRect(0, 0, xs, ys);
    g2d.drawImage(image, (int)x, (int)y, null);
    g.dispose();
} 
```

为什么？这非常简单和快捷：

```
public void drawRectangle(double x, double y, int xs, int ys, int colour){
    if(xs <= 0)
        return;

    g2d.setColor(new Color(colour));
    g2d.fillRect((int)(x-xScroll), (int)(y-yScroll), xs, ys);
} 
```

`drawImageRotated`和 也是如此`drawString`。直接画到g2d缓冲区就行了，还怕什么？

**drawImageBlurred**

首先……你又来了！第二：您似乎在对每一帧的图像应用卷积操作，为什么不只执行一次该操作（例如在应用程序启动时，或者更好的是，在图像编辑程序中）。

我的意思一点也不坏，但你显然对一般的编程不是很有经验。我想你可以看看处理（[http://processing.org](http://processing.org)）。我在这里有点偏见，因为我几乎每天都在自己使用它。这是一个用 java 编写的很棒的学习和原型设计环境，它应该让您停止思考实现细节（如翻转缓冲区）并专注于您真正关心的事情（制作游戏！）。

好吧，希望我说的有道理。祝你编码好运！:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-10T15:24:56.257

健康栏可能会因为游戏滞后而移动，`xScroll`并且`yScroll`在组件/叠加层仍被渲染到后台缓冲区时更新。要解决这个问题：

1) 根据最新更新后的时间按比例移动游戏对象，以保持游戏速度始终不变。向所有游戏对象更新方法添加`delta`参数`level.tick()`

2) 将`level.tick()`和`game.render()`放在同一个循环序列中，以确保首先更新游戏对象：

```
currentTime = System.currentTimeMillis();
delta = currentTime - lastTime; 

if(level != null && !paused){
    level.tick(delta); // introduce delta here
    game.render();
}

lastTime = currentTime; 
```

通常，请考虑以下附加步骤：

1）设置`Component.setIgnoreRepaint(true)`加速渲染

2) 在开始时优化当前显示的图像

```
GraphicsConfiguration gc = GraphicsEnvironment
.getLocalGraphicsEnvironment()
.getDefaultScreenDevice()
.getDefaultConfiguration();
Image optimized = gc.createCompatibleImage(img.getWidth(),img.getHeight(),Transparency.BITMASK);
optimized.getGraphics().drawImage(unoptimized, 0, 0, null); 
```

# android - 使输入延迟的最简单方法是什么

> ID：14798772
> 
> 赞同：1
> 
> 时间：2013-02-10T14:31:48.060
> 
> 标签：android

我是一个新的安卓开发者，

由于安全原因，我想在我的登录操作中延迟输入，（只显示一个 ProgressDialog 2 秒，然后继续主程序）。我已经知道如何使用多线程编程来做到这一点，但是由于其他线程中没有任何事情发生，我想也许有一些方法可以在不使用后台工作人员的情况下做到这一点。

如果你能告诉我一个在android中做的简单方法，我会很高兴

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:38:38.133

我建议你使用不需要线程的[Action Bar Sherlock 。](https://github.com/JakeWharton/ActionBarSherlock)打电话

```
setSupportProgressBarIndeterminateVisibility(boolean) 
```

我认为学习这个 api 比使用线程更难，但新一代 Android（api 11 之后）应用程序通常使用操作栏进度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:35:18.113

您可以将主线程延迟 2 秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T13:07:21.363

好吧，只是为了将来参考，我找到了另一种使用**Timer**解决这个问题的方法，我认为它比**Background Thread**更好，我创建了一个包装函数，它在特定时间后调用主事件

```
public void onClick(View view) {
    try {
        progressDialog = ProgressDialog.show(this, "sometitle", "somecontent");

        /**
         * input delay
         */
        Timer delayWorker = new Timer();
        TimerTask task = new TimerTask() {
            public View view = null;

            @Override
            public void run() {
                onClickAction(view);
                this.cancel();
            }
        };

        task.getClass().getField("view").set(task, view);
        delayWorker.schedule(task, INPUT_DELAY);

    } catch (Exception e) {
        /**
         * error occurred
         */
    }

}

private void onClickAction(View view) {

      /**
       * actual action click
       */

 } 
```

# c++ - 我怎样才能修复丢失的';' 在我的程序中出现“*”错误之前？

> ID：14798774
> 
> 赞同：0
> 
> 时间：2013-02-10T14:31:50.053
> 
> 标签：c++, visual-c++

我尝试创建`MyWindowSplitter`类，并将从 CView 类派生的另一个新类作为类中的运行时`MySplitter`类。但是当我尝试编译时，我`MyProjectView.h`在`GetDocument`函数中遇到了这些错误：

```
Error 1
error C2143: syntax error : missing ';' before '*'

Error 2
error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

问题出在哪里，我该如何解决？

```
//MySplitter.cpp
#include "StdAfx.h"
#include "MySplitter.h"
#include "SplitDemoSixView.h"
#include "TestView.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

CMySplitter::CMySplitter(void)
{
}

CMySplitter::~CMySplitter(void)
{
}

void CMySplitter::ChangeViewClass(CRuntimeClass* pNewView)
{
m_pDynamicViewClass = pNewView;
}

void CMySplitter::DeleteView(int row, int col)
{
CView* pView = (CView*)GetDlgItem(IdFromRowCol(row, col));

if(pView->IsKindOf(RUNTIME_CLASS(CSplitDemoSixView)))
{
    ChangeViewClass(RUNTIME_CLASS(CSplitDemoSixView));
}
else
{
    if(pView->IsKindOf(RUNTIME_CLASS(CTestView)))
    {
        ChangeViewClass(RUNTIME_CLASS(CTestView));
    }
}

CSplitterWnd::DeleteView(row, col);
}

//TestView.cpp drived from CView

#include "stdafx.h"
#include "SplitDemoSix.h"
#include "TestView.h"
#include "SplitDemoSixDoc.h"
#include "SplitDemoSixView.h"

// CTestView

IMPLEMENT_DYNCREATE(CTestView, CView)

CTestView::CTestView()
{

}

CTestView::~CTestView()
{
}

BEGIN_MESSAGE_MAP(CTestView, CView)
END_MESSAGE_MAP()

// CTestView drawing

void CTestView::OnDraw(CDC* pDC)
{
CDocument* pDoc = GetDocument();
// TODO: add draw code here
}

// CTestView diagnostics

#ifdef _DEBUG
void CTestView::AssertValid() const
{
CView::AssertValid();
}

#ifndef _WIN32_WCE
void CTestView::Dump(CDumpContext& dc) const
{
CView::Dump(dc);
}
#endif
#endif //_DEBUG

// CTestView message handlers 
```

问题就在这里：

```
//MyProjectView.h

#pragma once

#include "resource.h"
#include "MySplitter.h"

class CSplitDemoSixView : public CFormView
{
 protected: // create from serialization only
CSplitDemoSixView();
DECLARE_DYNCREATE(CSplitDemoSixView)

public:
enum{ IDD = IDD_SPLITDEMOSIX_FORM };

// Attributes
public:
    //ERROR PERFORMS IN THIS FUNCTION:
CSplitDemoSixDoc* GetDocument();

// Operations
public:

// Overrides
public:
virtual BOOL PreCreateWindow(CREATESTRUCT& cs);
protected:
virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
virtual void OnInitialUpdate(); 
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:48:16.047

您需要 CDocument 派生类的前向声明：

```
// Attributes
public:
    //ERROR PERFORMS IN THIS FUNCTION:
class CSplitDemoSixDoc;
CSplitDemoSixDoc* GetDocument(); 
```

# c# - 带有左连接的 Linq

> ID：14798778
> 
> 赞同：1
> 
> 时间：2013-02-10T14:32:10.337
> 
> 标签：c#, linq

```
 var query =
            (from Contact con in e.Results
             from ContactPhoneNumber phn in con.PhoneNumbers
             from ContactEmailAddress email in con.EmailAddresses.DefaultIfEmpty()
             where con.DisplayName.Contains(txtContasctSearch.Text)
             select new person()
             {
                 displayName = con.DisplayName,
                 displayEmail = (email.EmailAddress == null ? String.Empty : email.EmailAddress),
                 displayPhone = phn.PhoneNumber
             }).ToList(); 
```

该`EmailAddress`字段并不总是可用的。但是，如果它存在，我仍然想把它带回来。但是，我想模仿左连接，上面的代码返回错误。

有任何想法吗？

我收到的错误是：

```
 System.NullReferenceException occurred
   _HResult=-2147467261
    _message=NullReferenceException
     HResult=-2147467261
    Message=NullReferenceException
    Source=wpChoreList
    StackTrace:
       at wpChoreList.personSetup.<Contacts_SearchCompleted>b__8(<>f__AnonymousType1`2    h__TransparentIdentifier1)
   InnerException: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:38:37.417

您正在检查 null 的错误值：

```
displayEmail = (email.EmailAddress == null ? String.Empty : email.EmailAddress), 
```

email 应该为空，而不是 email.EmailAddress，尝试将该行更改为这一行：

```
displayEmail = (email == null ? String.Empty : email.EmailAddress), 
```

# ruby - 对红宝石中“puts”的调用感到困惑

> ID：14798786
> 
> 赞同：-2
> 
> 时间：2013-02-10T14:33:07.040
> 
> 标签：ruby

我们都知道在 ruby​​ 中的 . 运算符左侧有一个对象，`.`有助于发送消息（右侧`.`）。

有了上面这个原理`"100".to_s`，我们可以说操作员正在向对象`.`发送消息。好一个！`to_s``100`

那么`puts("hello")`呢？以下是我向当地红宝石专家提出的问题：

1.  在哪里。操作员？

2.  谁是这里的接收者？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-10T14:36:52.127

在这种情况下 Receiver 是隐式的`self`。`puts`是一种方法`Kernel`。所有类都包含内核模块，因此**所有**对象都有一个`puts`方法。唯一的事情是：它是私人的。私有方法只能通过隐式`self`（或使用`send`）调用

```
puts 'foo' # >> foo
1.puts 'bar' # ~> -:3:in `<main>': private method `puts' called for 1:Fixnum (NoMethodError)

1.send :puts, 'bar' # >> bar 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T14:35:06.610

接收者被省略，并且`self`在那个上下文中。因此，`.`也省略了。`puts`是 on 的一个方法`Kernel`，无论接收者是什么，它都可以访问，`puts`因为`Kernel`它包含在任何具有实例的类中。

# java - java.io.File.createNewFile() 处的 IOException；

> ID：14798787
> 
> 赞同：2
> 
> 时间：2013-02-10T14:33:24.850
> 
> 标签：java, serialization, filestream, ioexception

我确实有一些不起作用的序列化代码。我试图在 if 语句中插入 CanRead() 和 CanWrite() ，这表明它们没有读写权限。我还尝试将 'java.io.File.setReadable' 和 'java.io.File.setWriteable 插入 true 但它仍然会引发错误。

代码如下：

```
public static void save(Object obj, String filename) throws FileNotFoundException, IOException
{
    File f = new File("c:/DatoChecker/" + filename);
    File dir = new File("c:/DatoChecker");
    if(!dir.exists())
        dir.mkdirs();
    f.setReadable(true);
    f.setWritable(true);
    if(!f.exists())
    {
        f.createNewFile();
    }
    FileOutputStream op = null;
    ObjectOutputStream objectStream = null;
    op = new FileOutputStream(f);
    objectStream = new ObjectOutputStream(op);
    objectStream.writeObject(obj);
    objectStream.close();
}

public static Object fetch(String filename) throws FileNotFoundException, IOException, ClassNotFoundException
{
    File f = new File("c:/DatoChecker" + filename);
    File dir = new File("c:/DatoChecker");
    if(!dir.exists())
        dir.mkdirs();
    f.setReadable(true);
    f.setWritable(true);
    if(!f.exists())
    {
        f.createNewFile();
    }
    FileInputStream ip = null;
    ObjectInputStream objectStream = null;
    Object obj = null;
    ip = new FileInputStream(f);
    objectStream = new ObjectInputStream(ip);
    obj = objectStream.readObject();
    ip.close();
    objectStream.close();  
    return obj;
} 
```

堆栈跟踪：

```
SEVERE: null
java.io.IOException: access denied
    at java.io.WinNTFileSystem.createFileExclusively(Native Method)
    at java.io.File.createNewFile(File.java:947)
    at com.check.me.Serialization.fetch(Seralization.java:39)
    at com.check.me.GoodsList.load(GoodsList.java:82)
    at com.check.me.START.main(START.java:22) 
```

用于保存的一个是来自 GoodsList 的 congruet（只是保存而不是加载），但它在下面要长一些，所以我现在将其省略。

事先感谢您的帮助
Highace2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T14:36:45.040

You state that you did *not* have permission to read or write. And, indeed, you get an error telling you that you don't have permission. You need to change the ACL on the directory in which you are creating the file, or pick a different directory.

# php - 使用 PHP foreach 代码填充日历

> ID：14798794
> 
> 赞同：0
> 
> 时间：2013-02-10T14:34:14.943
> 
> 标签：php, jquery, mysql, jquery-plugins

我正在使用以下 jQuery 日历：[https ://github.com/MrHus/jquery-monthly-ical/tree/](https://github.com/MrHus/jquery-monthly-ical/tree/)

按照文档，它告诉我应该像这样输入日期：

```
eventdates: [{"date": "2009-03-21", "title": "My birthday", "desc": "Its my birthday!"},
             {"date": "yyyy-01-01", "title": "New Year", "desc": "Its a new year!"},
             {"date": "2009-mm-01", "title": "New Month", "desc": "First day of the new month!"},
             {"date": "2010-mm-01", "title": "New Month", "desc": "First day of the new month!"},
             {"date": "2010-09-01", "title": "Convention", "desc": "September convention."}, 
             {"date": "2010-09-02", "title": "Convention", "desc": "September convention day two."}, 
             {"date": "2010-mm-01", "title": "Towl", "desc": "Dont forget to bring a towl."}    
            ] 
```

但是，我想用 PHP 变量填充上述数组，并使用 foreach 语句。我有这个，但是它不起作用，没有错误，没有警告，但是没有显示该事件：

```
 <?php
        foreach($events as $event)
        {
        ?>
            eventdates: [{"date": "<?php date('Y/m/d') ?>", "title": "<?php $event->title ?>", "desc": "<a href="<?php  echo SITE_URL ?>/index.php/events/get_event?id=<?php $event->id ?>">Details/Signups</a>"},]
        <?php
        }
        ?> 
```

这是日历之外的先前代码，在我拥有的表格内，它可以工作：

```
<?php
if(!$events)
{
    echo 'No Upcoming Events';
}
else
{
    ?>
<center>
    <table border="1px" width="80%">
        <tr>
            <td width="25%"><b>Date:</b></td>
            <td width="60%"><b>Event:</b></td>
            <td><b>Details/Signups</b></td>
        </tr>
            <?php
            foreach($events as $event)
            {
                if($event->active == '2')
                {
                    continue;
                }
        echo '<tr><td>'.date('n/j/Y', strtotime($event->date)).'</td>';
        echo '<td>'.$event->title.'</td>';
        echo '<td><a href="'.SITE_URL.'/index.php/events/get_event?id='.$event->id.'">Details/Signups</a></td></tr>';
    }
    ?>
    </table>
</center>
    <?php
}
?> 
```

代码位于 .tpl 文件中，该文件通过 .class.php 文件显示。在其中，是运行必要变量的所有查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:41:43.623

这应该这样做：

```
$dates = array();

// build an array with that data
foreach($events as $event)
  $dates[] = (object)array(
     'date'  => date('Y/m/d'),
     'title' => $event->title,
     'desc'  => sprintf('<a href="%s/index.php/events/get_event?id=%s">Details/Signups</a>', SITE_URL, $event->id),
  );

?>

eventdates:

<?php print json_encode($dates); // print it as a json string ?> 
```

# android - Android推送通知发送给所有没有限制和谷歌帐户的人

> ID：14798795
> 
> 赞同：0
> 
> 时间：2013-02-10T14:34:22.667
> 
> 标签：android, google-cloud-messaging

嗨，我的客户要求可以在没有谷歌帐户的情况下在 android 中发送推送通知，并且每个请求也可以免费发送给所有人，而不是 1,000

我已经检查了 GCM，但他们有限制

另外，如果我创建自己的服务器，每秒向服务器发送请求，它会导致服务器崩溃吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:40:53.857

抱歉，我不是要打广告，但这对我来说完美无缺：

我使用名为[Parse](https://parse.com/)的免费服务，它可以很容易地将通知推送到 android 和 iOS 设备。[教程](https://parse.com/apps/quickstart)很简单，看看就好。

# c++ - 将节点添加到单链表中

> ID：14798797
> 
> 赞同：1
> 
> 时间：2013-02-10T14:34:24.633
> 
> 标签：c++, linked-list, singly-linked-list

我正在尝试学习链表。我刚刚编写了一个说明链表的程序，但它似乎不起作用。这是代码：

```
#include <iostream>
using namespace std;

struct node
{
    int data;
    node* next;
};

int main(int argc, const char * argv[])
{
    node* trav;
    node* root;
    root = new node;

    trav = root;

    trav -> data = 4;
    trav -> next = new node;

    trav -> data = 5;
    trav -> next = new node;

    trav -> data = 6;
    trav -> next = 0;
    trav = root;

    while (trav!=0) {
        std::cout<<trav->data;
        trav=trav->next;
    }
} 
```

我希望 root 指向第一个节点，但是`trav`当我们进一步进入程序时，它似乎复制了 的数据。知道有什么问题吗？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:36:30.907

在这段代码中：

```
trav = root;

trav -> data = 4;
trav -> next = new node;

trav -> data = 5;
trav -> next = new node; 
```

您没有更改`trav`指针，这意味着您正在覆盖其成员。通过调用创建新节点后，`trav->next = new node;`您应该通过调用“移动”到下一个节点：

```
trav = trav-> next; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:36:03.777

你从不做

```
trav = trav -> next; 
```

当你填写清单时。您不会在列表中移动，而只是继续修改根目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T14:36:23.767

之后你失踪`trav = trav -> next`了`trav -> next = new node`；换句话说，您创建了一个新节点，但您从未真正“跨步”到那里。

# c++ - ioctrl 使用 SCSI 直通

> ID：14798798
> 
> 赞同：2
> 
> 时间：2013-02-10T14:34:28.233
> 
> 标签：c++, c, linux, scsi

使用 Windows，我可以使用以下简化代码轻松地与我的 USB 设备进行通信：

```
DWORD dwJunk;    // discard results from DeviceIOControl()
int   iReply;
char  cBuffer[100];
// cBuffer is initialized here.
HANDLE hDevice; // handle to the drive to be examined 
CString sDrive = _T(\\\\.\\H:); // drive H: for this test
hDevice = CreateFile(sDrive,            // drive to open
   GENERIC_READ | GENERIC_WRITE,        // read and write access to the drive
   FILE_SHARE_READ | FILE_SHARE_WRITE,  // share mode           
   NULL,                                // default security attributes
   OPEN_EXISTING,                       // disposition
   0,                                   // file attributes
   NULL);                               // do not copy file attributes

iReply = DeviceIoControl(hDevice, IOCTL_SCSI_PASS_THROUGH_DIRECT, &cBuffer, sizeof(cBuffer), &cBuffer, sizeof(cBuffer), &dwJunk, (LPOVERLAPPED)NULL); 
```

我正在尝试在 linux 中做同样的事情，但无法弄清楚 ioctrl() 参数，或者更好地放置结构。非常感谢代码片段。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:05:55.993

这里还有一些文档：

*   [Linux SG 驱动程序版本 2.1.36 的注意事项](http://www.opennet.ru/docs/FAQ/OS/Linux/SCSI-Generic-FAQ.html)
*   *SCSI-Programming*，[第 8 页](http://www.tldp.org/HOWTO/archived/SCSI-Programming-HOWTO/SCSI-Programming-HOWTO-8.html) *（`handle_SCSI_cmd`功能）*，[第 9](http://www.tldp.org/HOWTO/archived/SCSI-Programming-HOWTO/SCSI-Programming-HOWTO-9.html)页，[第 11 页](http://www.tldp.org/HOWTO/archived/SCSI-Programming-HOWTO/SCSI-Programming-HOWTO-11.html) *（示例）*等等
*   [Linux 的通用 SCSI 目标子系统](http://scst.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T15:50:30.690

不幸的是，我使用您的链接修改的代码没有返回任何结果。这是我使用的剥离代码。ioctl() 返回没有错误：

```
#define DEF_TIMEOUT 5000 // 5 seconds
char cDiskName[] = "/dev/sg3";
int fd = open(cDiskName, O_RDWR);
if (fd < 0)
{
  printf("Open error: %s, errno=%d (%s)\n", cDiskName, errno, strerror(errno));
  return 1;
}

unsigned char turCmbBlk[] = {0x00, 0, 0, 0, 0, 0};
struct sg_io_hdr io_hdr;

unsigned char cIOBuffer[100];

// buffer initialization code omitted

memset(&io_hdr, 0, sizeof(struct sg_io_hdr));
io_hdr.interface_id = 'S';
io_hdr.cmd_len = sizeof(turCmbBlk);
io_hdr.mx_sb_len = sizeof(cIOBuffer);
io_hdr.dxfer_direction = SG_DXFER_NONE;
io_hdr.cmdp = turCmbBlk;
io_hdr.sbp = cIOBuffer;
io_hdr.timeout = DEF_TIMEOUT;
if (ioctl(fd, SG_IO, &io_hdr) < 0)
{
  printf("ioctl error: errno=%d (%s)\n", errno, strerror(errno));
}

// Code returned here without any errors but cIOBuffer remains unchanged. 
```

也许呼叫需要不同的请求代码？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T14:52:16.977

看这里：

```
#include <sys/ioctl.h>

int ioctl(int d, int request, ...); 
```

**参数：**

1.  **文件描述符**（必须打开！）
2.  **请求代码**号（取决于设备）
3.  **指向**内存的无类型指针（去往/来自驱动程序）

**例子**

```
#include <stdio.h>
#include <fcntl.h>
#include <errno.h>
#include <sys/ioctl.h>
#include <linux/usbdevice_fs.h>

void main(int argc, char **argv)
{
    const char *filename;
    int fd;

    filename = argv[1];

    fd = open(filename, O_WRONLY);
    ioctl(fd, USBDEVFS_RESET, 0);

    close(fd);

    return;
} 
```

**文档：**

*   [ioctl(2) - Linux 手册页](http://linux.die.net/man/2/ioctl)
*   [IOCTL(2)](http://www.freebsd.org/cgi/man.cgi?query=ioctl&sektion=2)
*   [通用 I/O 控制操作 (GNU libc)](http://www.gnu.org/software/libc/manual/html_node/IOCTLs.html)
*   [ioctl() 请求](http://tali.admingilde.org/linux-docbook/usb/ch07s06.html)
*   [usb.c](http://www.linux-usb.org/gadget/usb.c) *（可能对您有所帮助的示例）*
*   [Linux / Unix 命令：ioctl](http://linux.about.com/library/cmd/blcmdl2_ioctl.htm)
*   [如何在 Linux 中重置 USB 设备](http://www.roman10.net/how-to-reset-usb-device-in-linux/) *（示例）*
*   [IOCTL 示例程序](http://embedded.seattle.intel-research.net/wiki/index.php?title=An_example_Program_with_IOCTL)

* * *

**编辑**

```
#define BUFF_SIZE 100 // - Buffersize

#define DEF_TIMEOUT 5000 // 5 seconds
char cDiskName[] = "/dev/sg3";
int fd = open(cDiskName, O_RDWR);
if (fd < 0)
{
  printf("Open error: %s, errno=%d (%s)\n", cDiskName, errno, strerror(errno));
  return 1;
}

unsigned char turCmbBlk[] = {0x00, 0, 0, 0, 0, 0};
struct sg_io_hdr *p = (struct sg_io_hdr *) malloc(sizeof(struct sg_io_hdr)); // - dynamic memory allocation - free() required somewhere

unsigned char cIOBuffer[BUFF_SIZE];
unsigned char replyBuffer[BUFF_SIZE]; // - dxfer buffer

// buffer initialization code omitted

memset(p, 0, sizeof(struct sg_io_hdr));
p->interface_id = 'S';
p->cmd_len = sizeof(turCmbBlk);
p->mx_sb_len = BUFF_SIZE;
p->dxfer_direction = SG_DXFER_NONE;
p->cmdp = turCmbBlk;
p->sbp = cIOBuffer;
p->timeout = DEF_TIMEOUT;
p->flags = SG_FLAG_DIRECT_IO; // - Does this help?
p->dxferp = replyBuffer; // - Set dxferp buffer - (A)
p->dxfer_len = BUFF_SIZE; // - buffersize

if (ioctl(fd, SG_IO, p) < 0)
{
  printf("ioctl error: errno=%d (%s)\n", errno, strerror(errno));
}

// Code returned here without any errors but cIOBuffer remains unchanged. 
```

*注意（A）：*请尝试设置您在此处工作的输入/输出缓冲区。

**文档：**

*   [SCSI 通用 HOWTO，SG_IO_HDR_T](http://www.faqs.org/docs/Linux-HOWTO/SCSI-Generic-HOWTO.html#SG_IO_HDR_T)
*   [浏览 Linux 通用 SCSI 驱动程序](http://www.ibm.com/developerworks/linux/library/l-scsi-api/)

# excel - 从 VBA 自动排序中排除文本值

> ID：14798805
> 
> 赞同：0
> 
> 时间：2013-02-10T14:35:21.950
> 
> 标签：excel, excel-2003, vba

我想知道是否有人可以帮助我。

我正在使用下面的代码在工作簿关闭之前执行排序。

```
Private Sub Workbook_BeforeClose(Cancel As Boolean) 
    Sheets("Input").Protect "password", UserInterFaceOnly:=True 
    With ThisWorkbook.Worksheets("Input") 

        If .Range("B7").Value = "" Then Exit Sub 
        .Range("B7:AH400").Sort Key1:=.Range("B7"), _ 
        Order1:=xlAscending, _ 
        Header:=xlGuess, _ 
        OrderCustom:=1, _ 
        MatchCase:=False, _ 
        Orientation:=xlTopToBottom, _ 
        DataOption1:=xlSortNormal 
    End With 
End Sub 
```

代码工作正常，但我想进一步扩展功能并从排序中排除文本值“输入您的姓名”，因此 B 列中具有此值的单元格将**始终**是我所有数据下方的最后一行行。

我花了一周左右的时间试图找到解决方案，但不幸的是我一直无法这样做。我还查看了 Microsft 网站，看看它们是否是“Range.sort”方法中的任何内置函数，但我再次对此一无所知。

我什至不确定这是否可能，但我只是想知道是否有人可以看看这个并就我如何实现这一目标提供一些指导。

非常感谢和亲切的问候

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:38:21.760

由于您希望排除的数据位于范围的底部，您可以简单地“调整大小”排序范围以排除它。使用`.end`and`.row`方法来计算你有多少数据

```
Dim EndRow as long 
```

在 if 语句后添加

```
'find last row of data
EndRow = Range("B7").end(xldown).row -1 
```

更改范围以使用新计算的结束行。

```
.Range("B7:AH400") 
```

变成

```
.Range("B7:AH" & EndRow) 
```

# drupal - Drupal menu_link 带有节点/编号而不是别名

> ID：14798807
> 
> 赞同：0
> 
> 时间：2013-02-10T14:35:38.027
> 
> 标签：drupal, drupal-7, drupal-path-aliases

我有个问题：

```
 function drupal_menu_link($variables) {
  $element = $variables['element'];

  $sub_menu = $element['#below'] ? drupal_render($element['#below']) : '';

  return '<a href="/drupal/'.$element['#href'].'" title = "'.$element['#title'].'" ><li' . drupal_attributes($element['#attributes']) . '>' . $element['#title'] .'</li></a>';
} 
```

我怎样才能基于别名，而不是hrefs？当我将鼠标悬停在一个元素上时，我看到的是节点/编号而不是别名。我做了一个重定向，但它发生在点击之后。有人可以帮助我吗？我一直在其他主题中寻找它，但我不擅长它，我只是不明白它是如何工作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T15:03:28.870

要将 node/{number} - url 转换为现有的 url_alias，您可以使用[url](http://api.drupal.org/api/drupal/includes!common.inc/function/url/7)方法。

```
return '<a href="/drupal/'.url($element['#href']).'" title = "'.$element['#title'].'" ><li' . drupal_attributes($element['#attributes']) . '>' . $element['#title'] .'</li></a>'; 
```

更好的方法是使用[l](http://api.drupal.org/api/drupal/includes!common.inc/function/l/7)方法生成完整的链接：

```
return l($element['#title'], $element['#href'], array('attributes'=>$element['#attributes'])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:58:52.607

要返回路径别名，请使用[drupal_get_path_alias](http://api.drupal.org/api/drupal/includes!path.inc/function/drupal_get_path_alias/7)

```
drupal_get_path_alias("node/" . $nid); 
```

# android - OpenGL ES Lighting（矩阵和/或法线问题）

> ID：14798813
> 
> 赞同：2
> 
> 时间：2013-02-10T14:36:14.437
> 
> 标签：android, opengl-es-2.0

我正在尝试在 OpenGL ES 中添加每个顶点照明，但遇到了我没有找到解决方案的奇怪问题。

我首先使用 Android 文档来创建形状：http: [//developer.android.com/training/graphics/opengl/index.html](http://developer.android.com/training/graphics/opengl/index.html)

然后我用学习opengl es添加lightinh： http: [//www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/](http://www.learnopengles.com/android-lesson-two-ambient-and-diffuse-lighting/)

所以这是我的渲染器的代码：

```
@Override
public void onSurfaceCreated(GL10 unused, EGLConfig config) {
    // Set the background frame color
    GLES20.glClearColor(1.0f, 1.0f, 1.0f, 1.0f);

    // Enable depth testing
    GLES20.glEnable(GLES20.GL_DEPTH_TEST);

    float[] coords = new float[]{
            -0.5f, 0.5f, 0.5f,
            -0.5f, 0.5f, -0.5f,
            0.5f, 0.5f, -0.5f,
            0.5f , 0.5f, 0.5f,

            -0.5f, 0.5f, 0.5f,
            -0.5f, -0.5f, 0.5f,
            0.5f, -0.5f, 0.5f,
            0.5f , 0.5f, 0.5f
    };

    short[] drawOrder = new short[]{
            0,1,2,
            0,2,3,

            4,5,6,
            4,6,7,
    };

    float[] normals = new float[]{
            0.0f, 1.0f, 0.0f,
            0.0f, 1.0f, 0.0f,
            0.0f, 1.0f, 0.0f,
            0.0f, 1.0f, 0.0f,
            0.0f, 1.0f, 0.0f,
            0.0f, 1.0f, 0.0f,

            0.0f, 0.0f, 1.0f,
            0.0f, 0.0f, 1.0f,
            0.0f, 0.0f, 1.0f,
            0.0f, 0.0f, 1.0f,
            0.0f, 0.0f, 1.0f,
            0.0f, 0.0f, 1.0f,
    };

    float[] colors = new float[]{
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
            1.0f, 0.0f, 0.0f, 1.0f,
    };

    testSolid = new Solid(coords, drawOrder, colors, normals);
}

public void onDrawFrame(GL10 unused) {
    float[] lightPos = new float[]{0.5f, 0.5f, -0.5f, 1.0f};

    // Redraw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);

    // Set the camera position (View matrix)
    Matrix.setLookAtM(mViewMatrix, 0, 0, 0, -5.0f, 0f, 0f, 0f, 0f, 2.0f, 0.0f);                       

    Matrix.setIdentityM(mModelMatrix, 0);

    Matrix.multiplyMM(mVMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);

    Matrix.setIdentityM(mLightModelMatrix, 0);
    Matrix.multiplyMV(mLightPosInWorldSpace, 0, mLightModelMatrix, 0, lightPos, 0);
    Matrix.multiplyMV(mLightPosInEyeSpace, 0, mVMatrix, 0, mLightPosInWorldSpace, 0);

    Matrix.setRotateM(mRotationMatrix, 0, mAngle, 1.0f, 0.0f, 0.0f);

    // Calculate the projection and view transformation
    Matrix.multiplyMM(mLightMatrix, 0, mProjMatrix, 0, mVMatrix, 0);

    // Combine the rotation matrix with the projection and camera view
    Matrix.multiplyMM(mMVPMatrix, 0, mRotationMatrix, 0, mLightMatrix, 0);

    // Draw shape
    testSolid.draw(mVMatrix, mMVPMatrix, mLightPosInEyeSpace);
}

public void onSurfaceChanged(GL10 unused, int width, int height) {
    GLES20.glViewport(0, 0, width, height);

    float ratio = (float) width / height;

    // this projection matrix is applied to object coordinates
    // in the onDrawFrame() method
    Matrix.frustumM(mProjMatrix, 0, -ratio, ratio, -1, 1, 3, 7);
} 
```

然后，我的 Solid 代码：

*   首先，我的程序：

    ```
     private final String vertexShaderCode =
        // This matrix member variable provides a hook to manipulate
        // the coordinates of the objects that use this vertex shader
        "uniform mat4 uMVPMatrix;" +
        "uniform mat4 uMVMatrix;"+
        "uniform vec3 uLightPos;"+

        "attribute vec3 aNormal;" +
        "attribute vec4 aColor;" +
        "attribute vec4 aPosition;" +

        "varying vec4 vColor;" +

        "void main() {" +
        // the matrix must be included as a modifier of gl_Position
        "  vec3 modelViewVertex = vec3(uMVMatrix * aPosition);"+
        "  vec3 modelViewNormal = vec3(uMVMatrix * vec4(aNormal, 0.0));"+
        "  float distance = length(uLightPos - modelViewVertex);"+
        "  vec3 lightVector = normalize(uLightPos - modelViewVertex);"+
        "  float diffuse = max(dot(modelViewNormal, lightVector), 0.1);"+
        "  diffuse = diffuse * (1.0 / (1.0 + (0.25 * distance * distance)));"+
        "  vColor = aColor * diffuse;"+
        "  gl_Position = aPosition * uMVPMatrix;" +
        "}";

    private final String fragmentShaderCode =
        "precision mediump float;" +
        "varying vec4 vColor;" +
        "void main() {" +
        "  gl_FragColor = vColor;" +
        "}"; 
    ```

我的绘图功能：

```
 public void draw(float[] mvMatrix, float[] mvpMatrix, float[] lightPos) {
        // Add program to OpenGL ES environment
        GLES20.glUseProgram(mProgram);

        // Positions
        mPositionHandle = GLES20.glGetAttribLocation(mProgram, "aPosition");

        GLES20.glEnableVertexAttribArray(mPositionHandle);

        GLES20.glVertexAttribPointer(mPositionHandle, DATA_PER_VERTEX,
                                     GLES20.GL_FLOAT, false,
                                     0, vertexBuffer);
        CubeRenderer.checkGlError(String.format("Positions (%d)", mPositionHandle));

        // Colors
        mColorHandle = GLES20.glGetAttribLocation(mProgram, "aColor");

        GLES20.glEnableVertexAttribArray(mColorHandle);

        GLES20.glVertexAttribPointer(mColorHandle, 4,
                                     GLES20.GL_FLOAT, false,
                                     0, colorBuffer);
        CubeRenderer.checkGlError(String.format("Colors (%d)", mColorHandle));

        // Normals
        mNormalHandle = GLES20.glGetAttribLocation(mProgram, "aNormal");

        GLES20.glVertexAttribPointer(mNormalHandle, 3,
                                     GLES20.GL_FLOAT, false,
                                     0, normalBuffer);

        GLES20.glEnableVertexAttribArray(mNormalHandle);
        CubeRenderer.checkGlError(String.format("Normals (%d)", mColorHandle));

        // get handle to shape's transformation matrix
        mMVPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVPMatrix");
        CubeRenderer.checkGlError("glGetUniformLocation");
        mMVMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVMatrix");
        CubeRenderer.checkGlError("glGetUniformLocation");
        mLightPosHandle = GLES20.glGetUniformLocation(mProgram, "uLightPos");
        CubeRenderer.checkGlError("glGetUniformLocation");

        // Apply the projection and view transformation
        GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mvpMatrix, 0);
        GLES20.glUniformMatrix4fv(mMVMatrixHandle, 1, false, mvMatrix, 0);
        GLES20.glUniform3f(mLightPosHandle, lightPos[0], lightPos[1], lightPos[2]);
        CubeRenderer.checkGlError("glUniformMatrix4fv");

        // Draw the polygon
        GLES20.glDrawElements(GLES20.GL_TRIANGLES, drawOrder.length,
                              GLES20.GL_UNSIGNED_SHORT, drawListBuffer);

        // Disable vertex array
        GLES20.glDisableVertexAttribArray(mPositionHandle);
    } 
```

但是，当我运行它时，我得到了非常奇怪的结果。

*   一、光线很暗，而且不是好地方
*   其次，我有一个带有触摸事件的旋转，如果我旋转我的形状，灯光也会旋转。

请问你知道这个问题是从哪里来的吗？

谢谢你。

# c# - C# WPF - 在数据表中实时搜索

> ID：14798819
> 
> 赞同：0
> 
> 时间：2013-02-10T14:36:56.870
> 
> 标签：c#, wpf, datatable, rowfilter

我有一个 WPF 浏览器应用程序，它获取存储在 SQL Server 上的数据，将其存储在 DataTable 中并将其显示在 DataGrid 中。现在我想要一个文本框，您可以在其中搜索 DataTable 中的条目，但是当我加载应用程序时，我收到一条错误消息，告诉我找不到 [Company] 行。

我认为问题在于，当将过滤器应用于 DataTable 时，DataTable 尚未填充。有人可以给我一个提示如何使它工作吗？

```
DataTable dt = new DataTable();

public Page1()
{
    InitializeComponent();
    showSQLData();
}

private void showSQLData() 
{
    string sqlConnectionString = @"blabla";
    string sqlCommandString = "SELECT * FROM Excel_import";

    using (SqlConnection sqlConnection = new SqlConnection(sqlConnectionString))
    {
        SqlCommand cmd = new SqlCommand(sqlCommandString, sqlConnection);
        SqlDataAdapter adapter = new SqlDataAdapter(cmd);

        adapter.Fill(dt);

        dataGridSQLData.ItemsSource = dt.DefaultView;
    }
}

private void textBoxSearch_TextChanged(object sender, TextChangedEventArgs e)
{
    dt.DefaultView.RowFilter = string.Format("Company LIKE '%{0}%'", textBoxSearch.Text);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T17:09:48.277

根据您的最新评论，我猜想这是在通话`textBoxSearch_TextChanged`中被解雇的。如果不满足该条件`InitializeComponent()`，您可以签`dt.Rows.Count > 0`入并返回。`textBoxSearch_TextChanged`

# c - 如何在 VS 2010 中使用 Nvidia NSight 查看 CUDA 线程值？

> ID：14798821
> 
> 赞同：1
> 
> 时间：2013-02-10T14:37:14.043
> 
> 标签：c, cuda, nvidia, nsight

我想知道有没有办法查看给定内核中的所有变量值，例如，对于 threadIdx.x = 1，它当前正在工作哪些数据以及该数据的值是什么？

一切正常，所以我的问题是如何使用“快速监视”或“添加监视”来查看您可以在普通 VS 中执行的变量，它们在 NSight 中的等价物是什么？谢谢，已经挣扎了几个小时了。

通过 NSight 进行调试时，我有 CUDA Info 窗口和 CUDA Warp 窗口仅显示 blockIdx、threadIDx 坐标。

```
 __global__ void addKernel(int *c, const int *a, const int *b)
{
    int i = threadIdx.x;

    if(i<N)
        c[i]=a[i]*b[i];
    // DUmmy code
    if(i<2)
    int k=i;
} 
```

我的内核是这样调用的`addKernel<<<1,N>>>(dev_c,dev_a,dev_b)`，我的#DEFINE N 10。

我在 if 和 else 中设置了断点。Warp 窗口中的输出设置为显示：

```
*(a+i)  *(b+i)  *(c+i)  i

 0          0     -1     0
 2          1     -1     1
 4          4     -1     2
 6          9     -1     3
 8         16     -1     4 
```

所以，我的 c 从未设置过。怎么会这样？谢谢你

PS当他们看到我的问题时，那些给我缺点的人总是放弃我得到-1。再次感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-16T03:03:39.267

Nsight VSE CUDA 调试器支持几乎所有 Visual Studio 调试器工具窗口，包括变量视图、监视窗口、内存视图、调用堆栈视图和断点视图。这些可以从 Debug | 中打开。Visual Studio 中的 Windows 菜单。

为了查看特定线程的值，您必须设置一个条件断点，其中条件定义为对感兴趣的特定线程 ID 为真。

请参阅 Nsight VSE 手册中的以下主题

1.  [演练：调试 CUDA 应用程序](http://docs.nvidia.com/gameworks/index.html#developertools/desktop/debugging_cuda_application.htm)
2.  [设置 GPU 断点](http://docs.nvidia.com/gameworks/index.html#developertools/desktop/set_gpu_breakpoints.htm)
3.  [查看变量](http://docs.nvidia.com/gameworks/index.html#developertools/desktop/view_variables.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T22:03:13.607

在我的内核中添加了一些虚拟行后，我能够看到 c 列的值已更新。所以，这就是解决方案。我知道这听起来微不足道，但我之前尝试过添加虚拟行，除非额外的虚拟行是其他变量，而不是用于计算 c 的线程，否则它不起作用。因此，简而言之，计算新线程（或任何新线程可以进入内核）并在您希望在 CUDA Warp 窗口中看到的变量之后添加这些额外的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T19:32:49.007

在具有 Compute Capability 2.1 (c[i] = 0) 的 555m gt 上有同样的问题。具有 Compute Capability 3.0 的 GTX 660 显示正确的值，但有时 c[i] = -1。

使用“虚拟”行，它在任何情况下都可以正常工作（c[i] = c[i] 行中的断点）。

```
__global__ void addKernel(int *c, const int *a, const int *b)
{
    int i = threadIdx.x;
    c[i] = a[i] + b[i]; //if breakpoint will be here c[i] = -1 or 0
    c[i] = c[i]; //breakpoint here guarantees c[i] is correct
} 
```

# jquery - Jquery mouseleave 事件：如何知道鼠标正在向哪个元素移动？

> ID：14798824
> 
> 赞同：1
> 
> 时间：2013-02-10T14:37:50.117
> 
> 标签：jquery, events, event-handling, event-bubbling, mouseleave

我认为这是非常 jquery/javascript ninja 的问题。

基本上我有两个不同的 div，在第一个里面我有其他元素，在树的末尾我有一个 ul。

示例http：http: [//jsfiddle.net/thTpB/23/](http://jsfiddle.net/thTpB/23/)

我希望当我将 li 留在无序列表中时，只有当我直接从那个“li”进入第二个 div（div.to_show）时，它才会保持打开状态。

这是一个经典菜单，但由于某种原因，我无法重写 html 并在每个 li 中包含第二个 div 并将其显示为一个孩子。

`EventObject e`我尝试从以下属性中读取：

*   `e.toElement`: 火狐没有设置
*   `e.relatedTarget`：通常是父级，而不是第二个 div

我必须做什么才能获得这种行为？冒泡事件直到我有`e.relatedTarget == second div`？

**编辑：请假设我无法更改 DOM 层次结构。因此很难。**

显然，在某个 li 上使用 mouseenter 我将更改 div.to_show 的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:52:30.943

这是您想要的示例。如果您将鼠标完全移出菜单，它只会隐藏菜单内容。这意味着如果您将鼠标移入菜单项选择，然后将鼠标移入菜单内容 div，它仍然会显示该菜单内容 div，而不仅仅是消失。这是通过将您想要隐藏和显示的内容以及菜单 li 项目本身放在一个容器中来实现的，并放置一个 mouseout 处理程序以仅隐藏该容器上的所有内容。所以菜单项 li 不再有任何 mouseout 处理程序，只有整个 divs + li 的容器（当您在单个 li 项上有一个 mouseout 处理程序时，这就是为什么您会得到您不希望内容一直消失的行为）。

此外，当您将鼠标悬停在它上面时，它会显示您想要的菜单项，然后如果您将鼠标移到另一个 li，当您从一个鼠标移到另一个时，它会隐藏所有其他菜单项，但显示您想要的菜单项，并且看起来很流畅。这是通过在项目之间隐藏所有项目来实现的（通过调用具有特定类的所有内容 div，例如“elem”）。并隐藏所有这些，然后通过使用菜单项名称的内容和要显示的元素的类名称之间的连接来显示当前选定的项目。例如，“elem foo”类的菜单内容div项，当我将鼠标悬停在html内容为“foo”的li项上时，“.elem”类的所有div菜单内容都被隐藏了，但显示类“foo”。

希望这可以帮助！

[**在这里工作 JSFIDDLE 演示**](http://jsfiddle.net/QAUx5/1/)

JS

```
 $("div.another_container li").mouseenter(function(){ 
       $(".elem").hide();
       $("." + $(this).children("a").eq(0).html()).show();
    });

    $(".elem").hide();

    $(".wrapper").mouseleave(function(){
        $(".elem").hide();
    }); 
```

HTML

```
<div class="container head">
some header
</div>
<div class="wrapper">
    <div class="container">
        <div class="sixteen columns">
            <div class="another_container">
                <ul class="menu">
                    <li><a href="#">foo</a></li>
                    <li><a href="#">bar</a></li>
                </ul>

            </div>
        </div>
    </div>
     <div class="elem bar">
        BAR blabla
    </div>
      <div class="elem foo">
    FOO blabla
    </div>

</div>
<div class="container footer">
 some footer
</div> 
```

CSS

```
.container .sixteen.columns{
    width: 940px;
}

.container .column, .container .columns {
    float: left;
    display: inline;
    margin-left: 10px;
    margin-right: 10px;
}

.another_container ul {
height: 25px;
width: 100%;
margin: 0;
position: relative;
padding-top: 0px;
padding-left: 0;
padding-right: 0;
padding-bottom: 4px;
}
ol, ul {
list-style: none;
}

.another_container li:first-child {
margin-left: 0px !important;
}
.another_container li {
position: relative;
text-align: left !important;
float: left;
width: auto;
margin-left: 27px;
}

.elem {
display: none;
position: relative;
width: 100%;
height: 200px;
text-align: center;
float: left;
padding-bottom: 20px;
padding-left: auto;
padding-right: auto;
background-color: #f2f2f2;
border-style: solid;
border-color: red;
border-bottom-width: 2px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:51:27.653

为什么不这样做呢？

[http://jsfiddle.net/thTpB/15/](http://jsfiddle.net/thTpB/15/)

将要显示的 div 放在`li`元素中...这样您就不必离开选择器上下文来获得花哨的东西流动 :)

PS：不要试图让事情变得复杂，尤其是当它们可以用更简单更好的方法完成时:)

更新：在这里发布解决方案......

该`html`部分

```
<div class="container">
    <div class="sixteen columns">
        <div class="another_container">
            <ul class="menu">
                <li>
                    <a href="#">foo</a>
                    <div class="to_show">blabla</div>
                </li>
                <li>
                    <a href="#">bar</a>
                    <div class="to_show">blabla</div>
                </li>
            </ul>
    </div>
</div> 
```

该`javascript`部分...

```
$("div.another_container li").mouseenter(function(){ 
    $(this).find("div.to_show").show();
});  

$("div.another_container li").mouseleave(function(event){ 
        $(this).find("div.to_show").hide();
}); 
```

# android - 运行时Android上的重复视图

> ID：14798826
> 
> 赞同：6
> 
> 时间：2013-02-10T14:38:03.407
> 
> 标签：android, view, layout-inflater

我为一个活动创建了一个布局文件。在这个布局中，我创建了一个带有 textview 和 edittext 的 LinearLayout。现在我想创建额外的LinearLayouts，它们看起来和包含与我原来的LinearLayout完全相同的视图，但文本不同。我还想在运行期间以编程方式执行此操作，因为这些 LinearLayout 的数量在运行之间会有所不同。我读过一些关于充气机的文章，但我对它们的了解还不够，无法使用它们。

我在想这样的事情，显然代码是错误的，但希望你明白我想要做什么：

```
LinearLayout llMain = (LinearLayout)findViewById(R.id.mainLayout);
LinearLayout llToCopy = (LinearLayout)findViewById(R.id.linearLayoutToCopy);
for(int player = 0; player < size; player++)
{
   LinearLayout llCopy = llToCopy.clone();
   TextView tv = (TextView)llCopy.getChildAt(0);
   tv.setText(players.get(player).getName());
   llMain.addView(llCopy);
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-10T15:14:07.177

有几种方法可以做到这一点。
一种快速简单的方法是在循环的每次迭代中扩充一个新布局：

```
LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
LinearLayout parent = (LinearLayout) inflater.inflate(R.layout.main, null);

for (int i = 0; i < 10; i++) {
    View child = inflater.inflate(R.layout.child, null);
    TextView tv = (TextView) child.findViewById(R.id.text);
    tv.setText("Child No. " + i);
    parent.addView(child);
}

setContentView(parent); 
```

另一个（更优雅的）解决方案是创建一个扩展 LinearLayout 的单独类：

```
public class ChildView extends LinearLayout {

    private TextView tv;

    public ChildView(Context context) {
        super(context);

        View.inflate(context, R.layout.child, this);
        tv = (TextView) findViewById(R.id.text);
    }

    public void setText(String text) {
        tv.setText(text);
    }
} 
```

`ChildView`现在您可以在循环的每次迭代中创建一个并通过以下`setText(String text)`方法设置文本：

```
for (int i = 0; i < 10; i++) {
    ChildView child = new ChildView( this );
    child.setText("Child No. " + i);
    parent.addView(child);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T15:08:38.450

您可以通过使用布局充气器来实现

通过使用这个来获得布局充气器

```
LayoutInflater inflater = (LayoutInflater) context.getSystemService
      (Context.LAYOUT_INFLATER_SERVICE);
LinearLayout newlayout = inflater.inflate(R.layout.yourlayout, null);

// newlayout is the copy of your layout and you can use it and to get 
// the textview and edittext do it like this

TextView text = (TextView) newlayout.findView(R.id.yourtextviewid);
text.setText("new text");
EditText et = (EditText) newlayout.findView(R.id.yourtextviewid); 
```

# .net - 无法从通用处理程序访问会话

> ID：14798828
> 
> 赞同：0
> 
> 时间：2013-02-10T14:38:22.630
> 
> 标签：.net, session

得到了一个classfile，helpers.cs，为什么这段代码：

```
public class Helpers
{
    public static void LoginCheck(string Username, string Password)
    {        
        HttpContext.Current.Session["UserRoute"] = DoStuff();
    }
} 
```

给我错误：

> System.NullReferenceException

会话如何为空？我的 Helpers 类是否需要继承其他页面或类？

NullException 在这一行：

```
HttpContext.Current.Session["UserRoute"] = reader["Link"].ToString(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:43:07.583

您的处理程序需要实现`IRequiresSessionState`标记接口。

# android - 为什么 JDBC 不适合 Android 开发

> ID：14798832
> 
> 赞同：2
> 
> 时间：2013-02-10T14:38:55.737
> 
> 标签：android, jdbc

我已经阅读了无数关于在 Android 中使用 JDBC 的文章。每个人都建议走在 Android 代码中使用 PHP 脚本和使用 HTTP 客户端的路径。

最好能清楚地说明为什么不建议使用 JDBC。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T14:42:39.317

直接从 Web 客户端（无论是浏览器还是网络电话）进行 JDBC 访问意味着数据库端口暴露在公共 Internet 上。对于任何数据来说，这都不是一个安全的地方。

我认为更好的方法是在客户端和数据库之间放置一个或多个 servlet。让 servlet 处理安​​全、验证、绑定、决定调用哪些服务来完成用例、编组响应以及根据结果路由到下一页。

这种设计让您可以将中间层放在 Internet 上，并在防火墙后面保护您的数据安全。

它被称为 Model-2 MVC。十多年来，它一直是 Java Web 开发的标准习语。

如果您将数据的表示与数据的生成方式完全分开，您将从代码中获得更多用途。UI 来来去去，但服务和数据流连忘返。首先考虑服务，你会做得更好。

# javascript - 检查按钮上的哪个数据图像

> ID：14798837
> 
> 赞同：0
> 
> 时间：2013-02-10T14:39:27.837
> 
> 标签：javascript, jquery, html

ive 以下按钮

```
<button class="image1-button" data-image="bg_images/1.jpg">button 1</button>
<button class="image1-button" data-image="bg_images/2.jpg">button 2</button>
<button class="image1-button" data-image="bg_images/3.jpg">button 3</button>
<button class="image1-button" data-image="bg_images/4.jpg">button 4</button> 
```

使用以下代码

```
$(".image1-button").click(function() { 
var url = 'url(' + $(this).data('image') + ')';

$('#div1').css('background-image', url).fadeIn(500);

 // what to write in this if that it works...
 if('data-image="bg_images/2.jpg"') {
     here should something happen if button 2 is pressed
 } 
```

我如何编写它进入并触发我的事件的 if 条件？谢谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T14:41:32.563

```
if ($(this).data("image") === "bg_images/2.jpg") {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T14:41:53.107

```
if($(this).data('image') == 'g_images/2.jpg' ) { 
    //do your stuff.
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-10T14:43:39.663

```
if ( $(this).data('image') == 'bg_images/2.jpg' ) {
    // ...
} 
```

或者

```
if ( $(this).attr('data-image') == 'bg_images/2.jpg' ) {
    // ...
} 
```

# c# - 在 C# 中将字符串列表添加到 OracleCommand.Parameters

> ID：14798839
> 
> 赞同：5
> 
> 时间：2013-02-10T14:39:54.117
> 
> 标签：c#, oracle, ado.net

以下查询有一个要分配字符串列表的参数：

```
select * from a_table where something in :list_of_strings 
```

我有一个`List<string>`要分配给`list_of_strings`参数的 C#。

给定一个`OracleCommand`（代表上述查询），如何将 my 绑定`List<string>`到命令的`list_of_strings`参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-10T14:59:27.327

实际上，您不能将单个参数绑定到值列表。在这种情况下，您可以将值连接到查询字符串。但是，这是不建议的，因为您可以在子句
中放置的值是有限的。`IN`

```
List<string> list = new List<string>();
list.Add("1");
list.Add("2");
list.Add("3");
list.Add("4");

string listStr = string.Join(",", list);
//result: "1,2,3,4" 
```

如果您的字符串列表是字符串列表，您可以这样做：

```
List<string> list = new List<string>();
list.Add("one");
list.Add("two");
list.Add("three");
list.Add("four");

string listStr = string.Concat("'", string.Join("','", list), "'");
//result: "'one','two','three','four'" 
```

请求参数：

```
string query = string.Format("select * from a_table where something in({0})", listStr); 
```

*Obs：您可能必须处理列表为空的可能性。*

另一种可能性是在临时表上插入所有值并在 select 语句中使用它。与连接技术相比，这将具有无限字符串值的优势并避免在 DBMS 上进行新的硬解析：

```
SELECT * 
    FROM A_TABLE 
   WHERE SOMETHING IN(SELECT SOMETHING FROM TEMP_TABLE) 
```

# backbone.js - 如果视图本身通过 Backbone.Model.set() 更新了模型，则不要调用 render()

> ID：14798842
> 
> 赞同：0
> 
> 时间：2013-02-10T14:40:22.850
> 
> 标签：backbone.js, backbone-views, backbone-events, backbone-model

在我的 Backbone.js 项目中，我有一个模型和几个视图。`'change:currentTextTitle'`所有视图都在此模型上注册了回调：

```
// 'this' stands for any of the Views here
myModel.on('change:currentTextTitle', this.render, this); 
```

现在用户执行一些操作，这会导致特定视图更改其“当前文本标题”字段。然后，这个特定`myModel.set("currentTextField", newTextValue)`的视图调用它又触发`'change:currentTextTitle'`调用*所有*视图的事件（包括 set() 起源的那个）。然后*所有*视图调用它们的`render`回调函数。

问题是该`render`方法也在最初调用 set()-Method 的 View 上调用，这是完全没有必要的，因为它已经与`currentTextTitle`.

我的视图如何调用 myModel.set() 以通知*其他*视图的回调，但不触发/调用“源视图”本身？

一种解决方法似乎是将源视图作为方法`options`参数的一部分`set()`传递（传递给回调`trigger()`，然后传递给`render()`回调）：

```
myModel.set("currentTextField", newTextValue, thisViewSetAttribute) 
```

然后在`render`回调中可以检查是否`thisViewSetAttribute != this`. 但是，我认为不是在每个回调中实现检查，而是通过仅调用必要的回调并忽略发起 set() 方法调用的源视图来在模型本身中处理这个更有意义。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T06:05:53.077

我认为“正确”的 MCV 解决方案是您的视图不应该知道或关心模型是如何变化的，他们应该简单地处理变化并相应地更新。如果它们已经是最新的，则用户不应该知道其中的区别。

我绝对不会将源视图传递给模型。相反，当模型更改时，您可以让视图检查它是否是当前的而不是重新渲染。但是，如果额外的渲染不会导致任何问题，那就让它发生吧:)

在 Backbone 中，“视图”既是视图又是控制器。因此，请尝试将更改视为 2 个单独的步骤。首先，将用户输入转换为模型上的更改，然后作为单独的步骤（由模型更改事件启动）处理该更改并更新视图。如果每个视图都这样做，那么无论模型如何更改，一切都将保持最新。

# javascript - 向 Knockout javascript 添加加载图标

> ID：14798846
> 
> 赞同：1
> 
> 时间：2013-02-10T14:40:49.117
> 
> 标签：javascript, jquery, knockout.js

我使用 Knockout 创建了一个非常简单的数据加载示例。我想要做的是添加一个加载图标以在数据加载时显示。谁能告诉我下面的示例使用的正确语法？

```
 <script type="text/javascript" src="@Url.Content("~/Scripts/knockout-2.1.0.js")"></script>
<script type="text/javascript">

    function QBRatingsViewModel() {
            var self = this;
            var baseUri = '@ViewBag.ApiUrl';
            self.qbratings = ko.observableArray();

            $.getJSON("/api/qbrating", self.qbratings);
    }

    $(document).ready(function () {
        ko.applyBindings(new QBRatingsViewModel());
    }); 

  </script>

        <div class="page" id="page-index">
    <div class="page-region">
        <div class="page-region-content">
            <div class="grid">
                <div class="row">
                    <div class="span4">
                                    <h3>QB Ratings (up to week 12)</h3>
                                    <div id="divLoading">
                                        <table class="bordered">
                                            <thead>
                                                <tr style="background-color:#f1f1f1">
                                                    <td>Team</td>
                                                    <td>Comp %</td>
                                                    <td>Av Gain</td>
                                                    <td>TD %</td>
                                                    <td>Int %</td>
                                                    <td>Rating</td>
                                                </tr>
                                            </thead>
                                            <tbody data-bind="foreach: qbratings">
                                                <tr class="qbrating">
                                                    <td><span data-bind="text: $data.TeamName"></span></td>
                                                    <td><span data-bind="text: $data.Completion"></span></td>
                                                    <td><span data-bind="text: $data.Gain"></span></td>
                                                    <td><span data-bind="text: $data.Touchdown"></span></td>
                                                    <td><span data-bind="text: $data.Interception"></span></td>
                                                    <td><span data-bind="text: $data.CalculatedRating"></span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-10T15:27:55.133

虽然这不是您的具体示例，但这是一种可用于显示任何类型的加载指示器的技术：

[http://jsfiddle.net/wiredprairie/Uq8VJ/](http://jsfiddle.net/wiredprairie/Uq8VJ/)

重要的部分是仅在视图模型中切换可观察对象的状态，然后可以触发可见性绑定以隐藏或显示加载指示器。

```
var vm = {
    isLoading: ko.observable(false),
    loadData: function () {
        var self = this;
        self.isLoading(true);
        $.getJSON("/echo/json?json={}&delay=2")
            .success(function () {
            // success!
        })
            .complete(function () {
                // always remove the loading, regardless of load/failure
            self.isLoading(false);
        });
    }
};

ko.applyBindings(vm); 
```

和 HTML：

```
<div id='container'>
    <div>always showing</div>
    <div id='loading' data-bind="visible: isLoading">Loading...</div>
</div>
<div>
    <button data-bind="click: loadData">Simulate Load</div>
</div> 
```

# ruby-on-rails - 引导模式中的 Rails client_side_validations

> ID：14798847
> 
> 赞同：2
> 
> 时间：2013-02-10T14:40:51.267
> 
> 标签：ruby-on-rails, twitter-bootstrap, client-side-validation

我正在尝试将 gem 添加`client_side_validations`到我的应用程序中。如果我去类似的东西，它工作得很好`controller/new`，但是，在引导模式中，它根本什么都不做。

我检查了 HTML，它没有添加`data-validate`属性。我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-11T02:28:39.917

我刚刚想通了。在我的咖啡脚本调用中，我执行以下操作：

```
$('.modal').on 'shown', ->
    $(this).find('input:visible:first').focus().end().find('form').enableClientSideValidations() 
```

这将关注第一个可见输入，并在表单上启用客户端验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-26T14:43:50.927

上述解决方案对我不起作用，但以下解决方案！不知道为什么，但如果你发现和我一样，那可能是你的答案......

```
$(document).on('shown.bs.modal', function () { $(ClientSideValidations.selectors.forms).validate(); }); 
```

# youtube-api - YouTube 每月浏览量检查器 API 和 PHP？

> ID：14798849
> 
> 赞同：0
> 
> 时间：2013-02-10T14:40:54.050
> 
> 标签：youtube-api, youtube-channels

我的问题是是否有办法获得每月的原始视图。来自具有 Google 身份验证系统和 YouTube API 的 YouTube 频道。因为我正在编写一个小脚本，说就像当窗帘人超过一定数量时，他们将被进一步发送到网站并获得文件发送。否则他们会返回主页，是否可以这样做，所以是的，因为我似乎找不到方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T19:19:14.443

您可以使用[YouTube Analytics API](https://developers.google.com/youtube/analytics/v1/)针对给定视频生成报告，以请求任意日期范围内按月汇总的“唯一身份”[数量。](https://developers.google.com/youtube/analytics/v1/dimsmets/mets#uniques)报告定义看起来像

```
ids=channel==UC...
dimensions=month
metrics=uniques
filters=video==VIDEO_ID
start-date=2013-01-01
end-date=2013-01-01 
```

但是，您必须针对频道中的每个视频运行一次该报告，然后将总数相加。

请注意，结束日期不是您要查找的月份的最后一天，而是该月的第一天（即，它是“月份标识符”，而不是天数范围）。

您应该注意，您需要为频道所有者拥有一个 OAuth 2 令牌，该令牌具有适当的 YouTube 分析（和数据 API，以获取视频列表）范围，才能运行该报告；您不能在未经授权的情况下为任意视频运行任意 Analytics 报告。

# c# - C#、XML、添加新节点

> ID：14798854
> 
> 赞同：8
> 
> 时间：2013-02-10T14:41:26.353
> 
> 标签：c#, xml, xml-namespaces

我正在尝试将新节点添加到现有 XML 文件中。我有这个文件，其中包含第一个测试元素：

```
 <?xml version="1.0" encoding="utf-8"?>
<Root xmlns="http://prpa.org/XMLSchema1.xsd">
  <studenti>
    <student>
      <ime>test</ime>
      <prezime>test</prezime>
      <ocijena>0</ocijena>
    </student>
  </studenti>
  <profesori>
    <profesor>
      <ime>test</ime>
      <prezime>test</prezime>
    </profesor>
  </profesori>
</Root> 
```

我使用这个模式来生成这个 XML 文档

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="XMLSchema1"
    targetNamespace="http://prpa.org/XMLSchema1.xsd"
    elementFormDefault="qualified"
    xmlns="http://prpa.org/XMLSchema1.xsd"
    xmlns:mstns="http://prpa.org/XMLSchema1.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
           >
  <xs:element name='Root'>
    <xs:complexType>
      <xs:sequence>

  <xs:element name="studenti">
    <xs:complexType>
      <xs:sequence>       
   <xs:element name="student">
     <xs:complexType>
      <xs:sequence>
        <xs:element name="ime" type="xs:string"/>
        <xs:element name="prezime" type="xs:string"/>
        <xs:element name="ocijena" type="xs:int"/>
     </xs:sequence>
    </xs:complexType>
  </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:element name="profesori">
    <xs:complexType>
      <xs:sequence>
  <xs:element name="profesor">
      <xs:complexType>
        <xs:sequence>
         <xs:element name="ime" type="xs:string"/>
         <xs:element name="prezime" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>
</xs:element>
  </xs:sequence>
  </xs:complexType>
  </xs:element>

      </xs:sequence>
    </xs:complexType>
  </xs:element>

</xs:schema> 
```

现在，我需要添加新节点

```
 <profesor>
      <ime>test2</ime>
      <prezime>test2</prezime>
    </profesor> 
```

到目前为止，我已经尝试过：

```
XmlDocument xmldoc = new XmlDocument();
        xmldoc.Load(Server.MapPath("data/sve.xml"));
        XmlNode root = xmldoc.SelectSingleNode("root/profesori", null);

            XmlNode prof = xmldoc.CreateNode(XmlNodeType.Element, "profesor", null);

            XmlNode ime = xmldoc.CreateNode(XmlNodeType.Element, "ime", null);
            ime.InnerText = name;
            prof.AppendChild(ime);

            XmlNode prezime = xmldoc.CreateNode(XmlNodeType.Element, "prezime", null);
            prezime.InnerText = surname;
            prof.AppendChild(prezime);

             root.AppendChild(prof);

            xmldoc.Save(Server.MapPath("data/sve.xml")); 
```

我还尝试向它添加命名空间管理器：

```
XmlNamespaceManager nsMgr = new XmlNamespaceManager(xmldoc.NameTable);
                nsMgr.AddNamespace("ns", xmldoc.NamespaceURI);
XmlNode root = xmldoc.SelectSingleNode("/ns:root/ns:profesori", nsMgr); 
```

我仍然无法选择父节点并向其添加新的子节点。在调试模式下，“根”对象为空，有或没有命名空间，所以最后我当然会得到一个空指针异常。

我究竟做错了什么？

PS Schemas，命名空间，xml 文件都是本地的，由我编写，如果这有什么不同的话......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-10T15:03:43.167

您的第一个问题是 XPath 中的节点名称与 XML 中的节点名称不匹配。XML 区分大小写，因此您需要使用`Root`，而不是`root`：

```
XmlNode root = xmldoc.SelectSingleNode("/ns:Root/ns:profesori", nsMgr); 
```

接下来，`xmldoc.NamespaceURI`使用实际的命名空间 uri 而不是 ：

```
string strNamespace= "http://prpa.org/XMLSchema1.xsd";
nsMgr.AddNamespace("ns", strNamespace); 
```

或这样做：

```
string strNamespace= xmldoc.DocumentElement.NamespaceURI;
nsMgr.AddNamespace("ns", strNamespace); 
```

对象的 NamespaceURI`XmlDocument`将始终为空字符串。

您还应该在创建元素时使用此命名空间：

```
XmlNode prof = xmldoc.CreateNode(XmlNodeType.Element, "profesor", strNamespace);

XmlNode ime = xmldoc.CreateNode(XmlNodeType.Element, "ime", strNamespace);
ime.InnerText = name;
prof.AppendChild(ime);

XmlNode prezime = xmldoc.CreateNode(XmlNodeType.Element, "prezime", strNamespace);
prezime.InnerText = surname;
prof.AppendChild(prezime);

root.AppendChild(prof); 
```

您也可以考虑使用该`CreateElement()`方法，该方法会稍微短一些：

```
XmlNode prof = xmldoc.CreateElement("profesor", strNamespace); 
```

或者，我更喜欢使用 XmlWriter：

```
using(XmlWriter writer = root.CreateNavigator().AppendChild())
{
    writer.WriteStartElement("profesor", strNamespace);
    writer.WriteElementString("ime", strNamespace, name);
    writer.WriteElementString("prezime", strNamespace, surname);
    writer.WriteEndElement();
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-07-31T13:29:43.120

我有同样的麻烦，`root==null`但 MSDN 帮助了我。

您需要使用`//`而不是`/`

```
XmlNode root = xmldoc.SelectSingleNode("//ns:Root//ns:profesori", nsMgr); 
```

# ruby - Ruby Sequel 内存泄漏？

> ID：14798856
> 
> 赞同：1
> 
> 时间：2013-02-10T14:41:34.487
> 
> 标签：ruby, memory-leaks, sequel

我需要阅读许多 SQLite 数据库，超过 54,000 个数据库，以生成统计信息。

我创建了一个 Ruby 应用程序，在 Ruby 1.8.7 补丁级别 371 上运行，使用 Sequel 3.44.0 和 Sqlite 1.3.7。

我写了这段代码来读取数据库：

```
for i in databases 
   db= Sequel.sqlite(i)
        # DB'query and other operation
   db.disconnect
end 
```

一段时间后程序崩溃，没有错误。我在我的应用程序运行时查看了内存的消耗，它会增加直到 RAM 的大小。

是垃圾回收问题吗？还是我有什么错误？有没有用 Ruby 读取大量数据库的方法？

* * *

编辑：

我有 4GB 内存。我试过：

```
databases.each { |i| } 
```

但没有任何效果。当程序达到 2GB 的内存使用它停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T01:01:43.610

Sequel 将您连接到的数据库缓存在`Sequel::DATABASES`阵列中。如果您从大量数据库连接/断开连接，您应该从`Sequel::DATABASES`阵列中删除您的数据库对象，以便它们可以被垃圾收集。

[http://sequel.rubyforge.org/rdoc/classes/Sequel.html](http://sequel.rubyforge.org/rdoc/classes/Sequel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T17:19:35.427

如果您有 54,000 个 SQLite 数据库，我认为是时候升级到功能更强大的 DBM 了，它可以包含这些单个文件的数据。这将立即解决由于打开如此多的单独数据库而导致内存不足的问题。我会推荐 PostgreSQL，但 MySQL 也很容易胜任。

即使您必须拥有 54,000 个单独的表，您也可以使用单个表连接到服务器`Sequel.connect`并使用该`DB.tables`方法迭代表，从而节省内存。

这样做的另一个好处是您可以轻松地关联不同表中的数据以进行统计。

# ruby - JRuby 字符串类方法不可用

> ID：14798865
> 
> 赞同：0
> 
> 时间：2013-02-10T14:42:21.530
> 
> 标签：ruby, jruby

我似乎无法从 JRuby 中调用任何 Java 的字符串方法。不过，同样的语法风格也适用于 Math 类。我究竟做错了什么？

```
#! /usr/bin/env jruby

require 'rubygems'
require 'java'

puts java.lang.Math::max(1000,200)
puts java.lang.Math::PI

# this doesn't work 
puts java.lang.String::toUpperCase("we, the people")

# this doesn't work either 
JString = java.lang.String
puts JString.toUpperCase('We, the people')

#toUpperCase exists though, see below
puts java.lang.String.java_class.declarSed_instance_methods 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:48:18.447

我认为这就是你想要做的：

```
java.lang.String.new("we, the people").toUpperCase 
```

正如@Jesper 所提到的， toUpperCase 是 String 类的实例方法。将其用作静态方法将不起作用。

另请注意，返回的类是原生 Ruby 类型。

# android - 无法让 listPreference 在 Android 中工作

> ID：14798868
> 
> 赞同：0
> 
> 时间：2013-02-10T14:42:45.277
> 
> 标签：android, listpreference

我尝试在这里和谷歌上搜索答案，但没有成功。

我正在尝试`listPreference`在 Android 平台上允许用户选择他们的文本颜色。目前它只返回默认值，我不太确定为什么我的 if/else 语句不起作用。

首选项.xml：

```
 <ListPreference
    android:title="textcolorpreference"
    android:key="list1"
    android:summary="Text Color"
    android:entries="@array/list"
    android:entryValues="@array/lValues"
    /> 
```

数组.xml：

```
 <string-array name="list">
    <item>Red</item>
    <item>Green</item>
    <item>Blue</item>
    <item>Yellow</item>
    </string-array>
    <string-array name="lValues">
    <item>1</item>
    <item>2</item>
    <item>3</item>
    <item>4</item>
    </string-array> 
```

爪哇：

```
 SharedPreferences getPrefs =
    PreferenceManager.getDefaultSharedPreferences(getBaseContext());

        String values = getPrefs.getString("list", "2");

        if(values.contentEquals("1")){
            tp.setColor(Color.RED);
        } else if(values.contentEquals("2")){
            tp.setColor(Color.GREEN);
        } else if(values.contentEquals("3")){
            tp.setColor(Color.BLUE);
        }else if(values.contentEquals("4")){
            tp.setColor(Color.YELLOW);
        } 
```

目前只有列表首选项的默认值有效，例如，如果我将 listPreference 默认值设置为`String values = getPrefs.getString("list", "2")`我得到的`color.GREEN`，这让我认为我需要添加一个首选项更改的侦听器，但我目前无法实现它。

对于你们能够提供的任何帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:47:21.463

您可以从首选项列表中检索正确的整数**1**

```
Integer values = getPrefs.getInt("list1", 2); 
```

那么您可以从检索到的值进行切换：

```
switch(values ) {
    case 1:
        tp.setColor(Color.RED);
        break;
    case 2:
        tp.setColor(Color.GREEN);
        break;
    case 3:
        tp.setColor(Color.BLUE);
        break;
    case 4:
        tp.setColor(Color.YELLOW);
        break;
    default:
        tp.setColor(Color.GREEN);
} 
```

# c++ - 类所需的模板参数

> ID：14798870
> 
> 赞同：0
> 
> 时间：2013-02-10T14:43:04.387
> 
> 标签：c++

我有一个我正在调用的基于动态数组的类，`MyList`如下所示：

```
#ifndef MYLIST_H
#define MYLIST_H
#include <string>
#include <vector>

using namespace std;

template<class type>
class MyList
{
public:
  MyList(); 
  ~MyList(); 
  int size() const;
  type at() const;
  void remove();
  void push_back(type);

private:
  type* List;
  int _size;
  int _capacity;
  const static int CAPACITY = 80;
};

#endif 
```

我还有一个我正在调用的类，`User`我想包含一个`MyList`作为私有数据成员的实例。用户看起来像这样：

```
#ifndef USER_H
#define USER_H
#include "mylist.h"
#include <string>
#include <vector>

using namespace std;

class User
{
public:
  User();
  ~User();

private:
  int id;
  string name;
  int year;
  int zip;
  MyList <int> friends;
};

#endif 
```

当我尝试编译时，我的`user.cpp`文件中出现错误：

> 未定义的引用`MyList::Mylist()`

我觉得这很奇怪，因为`MyList`与 完全无关`user.cpp`，它只包含我的 User 构造函数和析构函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:46:33.373

确保将模板类的声明和定义都写入标题中（在标题中定义*MyList*而不是在 .cpp 文件中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:18:29.560

原因是您没有提供`MyClass<int>`构造函数定义。不幸的是，在 C++ 中，您不能通过在头文件中声明方法并在实现中定义它们来划分模板类定义。至少如果您想在其他模块中使用它。因此，在您的情况下，用户类现在需要`MyClass<int>::MyClass()`定义。有两种方法可以做到：

1.  （最简单的）提供适当的构造函数定义： `MyClass() { ... }`或

2.  在类定义之后在 MyClass.h 中添加方法定义，如下所示： `template<class type> MyList<type>::MyList() { ... }`

# mysql - SUM，COUNT 与 MySql 中的 UNION

> ID：14798876
> 
> 赞同：4
> 
> 时间：2013-02-10T14:44:14.283
> 
> 标签：mysql

我有一个具有以下架构的表：

```
DATA | CAUSE_1 | TIME_1 | CAUSE_2 | TIME_2 | CAUSE_3 | TIME_3 
```

`CAUSE.*`字段 ( )`VarChar`不能包含任何字符串，如果是，则字段`TIME.*`为 0。

我正在尝试创建一个查询，但不幸的是没有成功，我将以这种形式显示结果：

```
CAUSE | TOT_TIME | N_RIPET_CAUSE, 
```

在哪里：

*   在`CAUSE`我有一个列表中包含的内容`CAUSE_1 ... CAUSE_3`，
*   在`TOT_TIME`中的值的总和中`TIME_1 ... TIME_3`，
*   在`N_RIPET_CAUSE`每个的重复次数中`CAUSE`。

我希望我解释了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T15:06:23.363

尝试这个

```
 SELECT DATA ,CAUSE , TOT_TIME , N_RIPET_CAUSE
 FROM ( select DATA, CONCAT(`CAUSE_1`,' ',`CAUSE_2`, ' ', `CAUSE_3`) as CAUSE ,
 sum(`TIME_1` + `TIME_2` +`TIME_3`) as TOT_TIME ,
 (count(`CAUSE_1`)+count(`CAUSE_2`)+count(`CAUSE_3`)) as N_RIPET_CAUSE
 FROM your_table
 group by DATA
 ) t 
```

[**查看 SQLFIDDLE 演示**](http://sqlfiddle.com/#!2/b7679/6)

编辑。

尝试这个

```
 ( select DATA , `CAUSE_1` as CAUSE ,
     sum(`TIME_1` + `TIME_2` +`TIME_3`) as TOT_TIME ,
     (count(`CAUSE_1`)+count(`CAUSE_2`)+count(`CAUSE_3`)) as N_RIPET_CAUSE
     FROM Table1 
    group by DATA)
  union all
    (select DATA , `CAUSE_2` as CAUSE ,
    sum(`TIME_1` + `TIME_2` +`TIME_3`) as TOT_TIME ,
    (count(`CAUSE_1`)+count(`CAUSE_2`)+count(`CAUSE_3`)) as N_RIPET_CAUSE
    FROM Table1
    group by DATA   )
  union all

    (select DATA , `CAUSE_3` as CAUSE ,
    sum(`TIME_1` + `TIME_2` +`TIME_3`) as TOT_TIME ,
    (count(`CAUSE_1`)+count(`CAUSE_2`)+count(`CAUSE_3`)) as N_RIPET_CAUSE
    FROM Table1
    group by DATA   ) 
```

[**SQL 演示在这里**](http://sqlfiddle.com/#!2/b7679/11)

**编辑：**

根据您的需要试试这个

```
 select cause, sum(time) Tot_time, count(cause) N_Ripet_Cause
 from(
    select  cause_1 as cause, time_1 as time
    from Table1
    union all
    select  cause_2 as cause, time_2 as time
   from Table1
   union all
   select  cause_3 as cause, time_3 as time
   from Table1
 ) t
 group by cause 
```

[**演示 SQL 小提琴**](http://sqlfiddle.com/#!2/94442/10)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T15:01:30.977

如果您无法更改表结构，那么为了获得此结果，您需要将列*取消透视*为行。

MySQL 没有 unpivot 函数，但这可以使用`UNION ALL`查询来完成。然后，您可以将聚合应用于这些值以获得最终结果：

```
select cause, sum(time) Tot_time, count(cause) N_Ripet_Cause
from
(
  select data, cause_1 as cause, time_1 as time
  from yourtable
  union all
  select data, cause_2 as cause, time_2 as time
  from yourtable
  union all
  select data, cause_3 as cause, time_3 as time
  from yourtable
) src
group by cause 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T14:59:24.630

您可以像这样从 union select 中进行选择：

```
select * from
(
    select cause_1 as cause, time_1 as time from tableName
    union
    select cause_2 as cause, time_2 as time from tableName
    union
    select cause_3 as cause, time_3 as time from tableName
) as joinedValues 
```

然后您可以从该选择中执行任何操作。每个子句的类似数量：

```
select cause, count(cause) from
(
...
) as joinedValues
group by cause 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T14:53:53.533

杰克是对的——你的表格结构中有太多可能冗余的单元格。使用关系来消除此类事件。

***数据*** 表 dID | 数据

***实例表*** ID | 身份证 | 原因 | 时间

然后在两个表上使用 NATURAL JOIN 来提取信息；

```
SELECT * FROM DataTable NATURAL JOIN instancesTable WHERE dID=? LIMIT 3 
```

此查询将返回第一个表中“数据”的 ID 上发生的任何原因和时间的列表。

编辑：*N_RIPET_CAUSE* 可以在 dID 上使用**SUM(CAUSE)**找到。

# css - 如何可视化 CSS3 三次贝塞尔曲线？

> ID：14798881
> 
> 赞同：0
> 
> 时间：2013-02-10T14:44:43.580
> 
> 标签：css, drawing, bezier

在[CSS3 过渡](http://www.w3.org/TR/css3-transitions/#transition-timing-function)规范中，加速度的标准贝塞尔曲线定义如下：

> ```
> The ease function is equivalent to cubic-bezier(0.25, 0.1, 0.25, 1.0) 
> The linear function is equivalent to cubic-bezier(0.0, 0.0, 1.0, 1.0)
> The ease-in function is equivalent to cubic-bezier(0.42, 0, 1.0, 1.0)
> The ease-out function is equivalent to cubic-bezier(0, 0, 0.58, 1.0)
> The ease-in-out function is equivalent to cubic-bezier(0.42, 0, 0.58, 1.0) 
> ```

你如何可视化这些曲线？我想看看他们（比如这里：[http](http://hosted.zeh.com.br/tweener/docs/en-us/misc/transitions.html) ://hosted.zeh.com.br/tweener/docs/en-us/misc/transitions.html ）。

三次贝塞尔函数中有四个点，但只有一个值。但是要绘制曲线 x 和 y 是否需要它们中的每一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:57:22.847

只要我得到它，CSS三次贝塞尔插值使用曲线上的两个*隐式*点来表示插值函数的图形，即P0 =（0,0）和P3 =（1,1）。那里指定的四个数字代表另外两个领先点。

例如，线性插值图等于具有以下前导点的贝塞尔曲线：P0 = (0,0)（隐式），P1 = (0,0)（前两个参数），P2 = (1,1)（最后两个参数）和 P3 = (1,1)（隐式）。

# .net - 使用 [Obsolete] 属性来指示开发人员不要使用 API 的某些部分是一种好习惯吗？

> ID：14798884
> 
> 赞同：6
> 
> 时间：2013-02-10T14:45:11.143
> 
> 标签：.net, obsolete, code-inspection

最近我一直在写一些可序列化的对象，它也处理特定的逻辑并具有特定的生命周期。为了使其正常工作，必须使用适当的构造函数对其进行实例化，该构造函数需要强制参数。但是，出于序列化目的，我还必须添加一个公共默认构造函数。

该对象将由我们的 API 公开可用，并且第 3 方开发人员应该能够实例化和使用它。尽管会有适当的文档说明如何正确操作该对象，但不能保证有人会尝试使用不正确的构造函数——然后遇到麻烦。

我正在寻找一种巧妙的方法来在第 3 方开发人员编写他们的代码时应用一些指导。我想到了这个`Obsolete`属性——我可以用适当的注释来注释序列化构造函数作为消息。然后该消息将出现在输出警告中，并将开发人员引导至正确的代码行。此外，Visual Studio 和使用的任何代码检查插件都会适当地突出显示构造函数的用法。

这种方法困扰我的是`Obsolete`属性的目的完全不同。它的语义含义是被装饰的项目已被弃用，并且可能会在以后的版本中被删除。在序列化构造函数场景中这是错误的，并且该属性的用法和含义之间会存在差异。更不用说某些开发部门可能启用的“将警告视为错误”选项......

所以，问题是 - 对于这种属性的使用，这是一种可接受的做法吗？是否有任何其他合法和通用的方式来达到相同的效果（通用我的意思是不依赖第 3 方代码检查插件等 - 我不控制谁使用代码以及他们的设置是什么）？

* * *

关于下面答案中的评论（这对我仍然有用），我必须澄清我在可继承类上使用受保护的默认构造函数。构造函数用于支持 XML 序列化，但不应用于在业务逻辑中初始化类。继承类应该调用其他一些基本构造函数，编写继承类的开发人员需要知道这一点。尽管如此，如果需要，从该代码派生的开发人员还必须能够为其继承的类启用 XML 序列化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:52:06.610

嗯，我认为这不是一个好的解决方案。但是，您真的需要默认构造函数吗？

请注意，序列化 API 具有创建未初始化实例的方法，根本不需要使用构造函数（请参阅 MSDN：[FormatterServices.GetUninitializedObject](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatterservices.getuninitializedobject.aspx)）。

此外，普通的自定义序列化构造函数不是默认构造函数，而是采用 SerializationInfo 和 StreamingContext 的构造函数。如果您有一些自定义序列化，您还可以通过将默认构造函数设置为内部并为执行序列化的程序集应用[InternalsVisibleToAttribute来解决您的问题。](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)

# android - android中的图像按钮更改

> ID：14798886
> 
> 赞同：0
> 
> 时间：2013-02-10T14:45:42.403
> 
> 标签：android, image, button, timer

在我的应用程序中，我将按钮的图像更改为 1 秒。如何比较按钮的图像。我尝试了很多。请帮助我。当我在 1 秒后更改图像的第一个时间时，它不会改变 agian。它保持不变。下面是代码-

```
 myTimer = new Timer();

    myTimer.schedule(new TimerTask() {  

        @Override
        public void run() {
            if(time==-1){
                onStop();
            }
            else
            runOnUiThread(new Runnable() {
                public void run() {

                    Random rand=new Random();
                    System.out.println("timer...."+time);               
                    time=time-1;
                    int num = rand.nextInt(buttonIds.length);
                    int buttonId = buttonIds[num];
                    Button bb=(Button) findViewById(buttonId);

                    if((bb.getBackground()).equals(button.getBackground()))
                    {
                     bb.setBackgroundResource(R.drawable.happy);
                     wrong++;
                     System.out.println("llllllllllll"+wrong);
                    }
                    else
                     {
                        bb.setBackgroundResource(R.drawable.whoa);
                        count++;
                        System.out.println("mmmmmm"+count);
                     }

                }
            });
        }

    },0, 1000);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:56:59.580

**编辑** 你正在像这样新鲜地获得按钮

```
Button bb=(Button) findViewById(buttonId); 
```

所以它总是会保持哇......因为条件总是错误的......

* * *

我建议你在设置背景资源的同时设置内容描述，然后比较内容描述......你不能通过`bb.getBackground()).equals(button.getBackground())` 做这样的事情来比较

```
 but1=(Button) findViewById(R.id.b1);
    but1.setBackgroundResource(R.drawable.happy);
but1.setContentDescription("happy"); 
```

和

```
if(bb.getContentDescription().equals(button.getContentDescription()) 
```

# java - 尝试连接到 Eclipse 市场会给出 InvocationTargetException

> ID：14798887
> 
> 赞同：0
> 
> 时间：2013-02-10T14:45:49.900
> 
> 标签：java, eclipse, eclipse-marketplace

当我点击“Help / Eclipse Marketplace”时，我得到一个弹出进度框，上面写着“Retrying data from [http://marketplace.eclipse.org](http://marketplace.eclipse.org) ”，等待足够长的时间成为网络超时，然后显示 Eclipse Marketplace 对话框显示 java.lang.reflect.InvocationTargetException 的弹出窗口。“详细信息”按钮没有提供任何进一步的信息，“错误日志”提供了很多数据，但没有提供任何进一步的信息（我猜其他人会知道这意味着什么）。

我在 Windows 7 64 位上，运行 eclipse Indigo 3.7；作为解决这个问题的一部分，我做了一个“帮助/检查更新”并让它放松。我再次运行它，它说没有找到更新。

我查看了 IE（我从不使用）和 Chrome（我的默认浏览器）中的互联网设置；它们都设置为自动检测网络连接设置。这台机器在我家，使用无线路由器连接有线 ISP，所以我认为不需要任何代理。但是，我是一名程序员，而不是网络人员，我很乐意在那里了解应该检查的其他内容。

我在 Windows 机器上启用了 telnet 并执行了“telnet marketplace.eclipse.org 80”；它清除了命令屏幕，似乎正在等待输入。我输入了 telnet 控制字符，它弹回到 dos 提示符。在端口 80 上似乎没有与该域的连接问题。

我的运行环境是java 1.6.0_24；jre6 是 Eclipse 中唯一安装的执行环境（“Windows / Preferences / Java / Installed JREs”）。

我发现一篇帖子声称打开 Windows 防火墙解决了他的问题；我看了看，很不高兴地发现我的机器已经打开了 Windows 防火墙；我把它关掉了，但它并没有改变错误。（我有一个硬件防火墙，不知道为什么我需要微软或 BitDefender 的。）

关于这个主题有几个 SO 帖子，但似乎没有一个足够适合我；我在上面尝试过的一些事情来自那些帖子。

在 Eclipse 中报告了一个或两个关于该问题的错误，但它们似乎至少有一年的历史，并且据报道已得到修复。

有人可以告诉我如何解决这个问题，或者至少在哪里看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T23:38:13.077

我做了所有的工作..终于安装 JRE 6 就像魔术一样工作......试试这个！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:48:35.197

[http://h-online.com/-1797226](http://h-online.com/-1797226)

阅读上面的文章。他们正在移动服务器，希望能在周日下午完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T05:34:05.820

试试这个 -vmargs -Djava.net.preferIPv4Stack=true

# javascript - jQuery JSON 结果中的 ForEach 数组值

> ID：14798888
> 
> 赞同：1
> 
> 时间：2013-02-10T14:45:55.027
> 
> 标签：javascript, jquery, ajax, arrays, foreach

好的，我想处理来自 jQuery 请求的 JSON 响应中返回的每个值的另一个 javascript 请求，这是我用于此请求的当前代码

```
function waitForEvents(){
$.ajax({
            type: "GET",
            url: "/functions/ajax.php?func=feed&old_msg_id="+old_msg_id,

            async: true, /* If set to non-async, browser shows page as "Loading.."*/
            cache: false,
            timeout:50000, /* Timeout in ms */

            success: function(data){
                var json = jQuery.parseJSON(data);
                **//Foreach json repsonse['msg_id'] call another function**
                setTimeout('waitForEvents()',"1000");  
            },

            error: function (XMLHttpRequest, textStatus, errorThrown){
                alert("Error:" + textStatus + " (" + errorThrown + ")");
                setTimeout('waitForEvents()',"15000");       
            },
});
}; 
```

对于每个 json 响应变量 ['msg_id'] 我想调用另一个 javascript 函数，但不知道如何在 javascript 中使用 foreach 来处理数组，知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:49:42.943

由于您已经在使用 jQuery，因此可以使用 $.each 函数：

[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

```
$.each(json.msg_id, function (index, value) {
    // Do something with value here, e.g.
    alert('Value ' + index + ' is ' value);
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:09:20.603

使用简单的 for 循环，可能比 for each 更快

```
function myfunction(id){
    alert("myid:"+id):
}

var i=0;
for (i=0; i< json.length;i++){
    var thisId = json[i].msg_id;
    myfunction(thisId);
} 
```

更简单：

```
function myfunction(id){
    alert("myid:"+id):
}

var i=0;
for (i=0; i< json.length;i++){
     myfunction(json[i].msg_id);
} 
```

既然你问：

```
function checkArrayElements(element, index, array) {
     console.log("a[" + index + "] = " + element);
     var myId = element.msg_id;
};
json.forEach(checkArrayElements); 
```

和讨论如果旧浏览器没有被暗示：[https](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach) ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach 所以你可以这样做

# bash - 反斜杠如何与 bash shell 中的 grep 一起使用？

> ID：14798890
> 
> 赞同：0
> 
> 时间：2013-02-10T14:46:23.197
> 
> 标签：bash, shell, unix, grep

我正在尝试匹配此表达式以使用 grep 测试反斜杠：

> '\紫外线'

当我写这个正则表达式时：

> '\\紫外线'

整个表达式与正则表达式匹配，但是当我写`\u`只期望正则表达式失败时，因为没有字符`\u`，`\v`（有`\t`，`\n`），它匹配给定字符串的**u**。

正则表达式如何**`\u`**匹配 u 字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T14:54:40.180

它有助于[阅读](http://manpages.ubuntu.com/manpages/precise/man7/regex.7.html)您使用的（正则表达式）语言的描述。

我们从中了解到，与 C 字符串字面量不同，它`\n`表示字面量`n`和`\t`字面量`t`。同样，`\u`表示字面量`u`。

> 原子是 [.....]，一个 '\' 后跟任何其他字符（！）（匹配作为普通字符的字符，就好像 '\' 不存在（！））[.. ....]

# ckeditor - 如何在ckeditor中设置文本

> ID：14798897
> 
> 赞同：2
> 
> 时间：2013-02-10T14:46:55.367
> 
> 标签：ckeditor, ckfinder

如何在 CKEditor 中设置文本？CKEditor 还需要与 ckfinder 集成。

我试着做

// 我需要在后面的代码中设置 ckeditor 文本的值。为了从代码隐藏中获取该值，我使用了一个将在代码后面设置的 div。这目前没有隐藏，但我最终会这样做。我需要将此值设置为我的 ckeditor。

```
 <textarea id="editor1" name="editor1"></textarea>
        <script type="text/javascript">
            window.onload = function () {

                    var edt = CKEDITOR.replace('editor1', { toolbar: 'Basic' });
 CKFinder.setupCKEditor(edt, '/ckfinder/');

                    var t = <%=editortext.InnerText %>;

                    CKEDITOR.instances.editor1.setData(t);

            } 
```

如果我为 t 放置一些静态文本，则 var t = "Some Text";

然后设置

CKEDITOR.instances.editor1.setData(t); 它工作正常。

如果我使用，

```
var t = <%=editortext.InnerText %>;

                    CKEDITOR.instances.editor1.setData(t); 
```

ckeditor 不再显示。仅显示文本区域。如何在ckeditor中设置文本？请帮忙

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-27T21:42:32.570

此语法在这里可能很有用：

```
CKEDITOR.instances['editor1'].setData(t); // where editor1 is id 
```

或者试试这个

```
edt.setData(t); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-30T04:29:12.387

```
<script>
     function SetContents(value ) {

        var oEditor =  CKEDITOR.instances.MainContent_editor1;       
        var t = document.getElementById('<%=editor1.ClientID %>').value ;
        oEditor.setData(t); 

     } 

 </script>

<script type="text/javascript">

                var ckEditor = CKEDITOR.replace('<%=editor1.ClientID %>', {

                    //               extraPlugins: 'bbcode',
                    //               fullPage : true,
                    extraPlugins: 'docprops',
                    removeDialogTabs: 'image:advanced',
                    filebrowserImageUploadUrl: 'Upload.ashx',
                    resize_enabled: false,

                    toolbar: [

                ['Source', '-', 'Bold', 'Italic', '-', 'NumberedList', 'BulletedList', '-', 'Link', 'Unlink'],

                ['FontSize', 'TextColor', 'BGColor'],

                ['Image']

            ]

                });
                var oEditor = CKEDITOR.instances.MainContent_editor1;
                var t = document.getElementById('<%=editor1.ClientID %>').value;
                oEditor.setData(t);

                function pageLoad() { // this is because after postback jquery not working

                            var instance = CKEDITOR.instances['<%=editor1.ClientID %>'];

                    if (instance) {
                        CKEDITOR.remove(ckEditor);
                    }
                    CKEDITOR.replace('<%=editor1.ClientID %>', {

                        //               extraPlugins: 'bbcode',
                        //               fullPage : true,
                        extraPlugins: 'docprops',
                        removeDialogTabs: 'image:advanced',
                        filebrowserImageUploadUrl: 'Upload.ashx',
                        resize_enabled: false,
                        toolbar: [

                ['Source', '-', 'Bold', 'Italic', '-', 'NumberedList', 'BulletedList', '-', 'Link', 'Unlink'],

                ['FontSize', 'TextColor', 'BGColor'],

                ['Image']

            ]

                    });

                    var oEditor = CKEDITOR.instances.MainContent_editor1;
                    var t = document.getElementById('<%=editor1.ClientID %>').value;
                    oEditor.setData(t);

                    }

 </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-24T09:56:18.920

this post is quote old but I hope I am not too late for others to see this:

You forgot to enclose the server side code with quotes:

> var t = "<%=editortext.InnerText %>";

the page will be rendered like this:

```
var t = "your text here"; 
```

instead of

> var t = your text here;

using your code will definitely break javascript's parser

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T22:23:13.290

首先检查浏览器的控制台是否有错误。还要观察从您的后端代码呈现到此模板中的内容。您最有可能缺少的是引号`""`和/或您呈现的字符串包含未转义的撇号/引号。分数。

控制台就是一切。

# vb.net - 如何找到 GetManifestResourceStream 的 MyNamespace？

> ID：14798900
> 
> 赞同：0
> 
> 时间：2013-02-10T14:47:08.233
> 
> 标签：vb.net, visual-studio-2010

我的解决方案资源管理器中加载了一个名为british-english-dictionary.xml 的XML。它被设置为构建操作下的嵌入式资源。

我正在尝试使用以下代码阅读它：

```
Dim asm = Assembly.GetExecutingAssembly()
Dim var = asm.GetManifestResourceStream("MyNamespace.british-english-dictionary.xml") 
```

问题是它没有加载；我相信这是因为 MyNamespace 部分不正确，但是我如何找出应该替换 MyNamespace 的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T16:41:59.657

重要的设置是项目 + 属性、应用程序选项卡、默认命名空间。这是文件名前面的名称。

您始终可以使用 Ildasm.exe 仔细检查程序集清单中使用的实际名称。双击主窗口中的 Manifest 并找到 .mresource 语句。我使用默认命名空间设置为“Foo”并将 test.xml 添加为嵌入式资源创建的示例程序在 Ildasm.exe 中生成了以下输出：

```
.mresource public Foo.test.xml
{
  // Offset: 0x00000000 Length: 0x00000011
} 
```

# ruby-on-rails - 没有路线匹配 [GET] "/flare.json"

> ID：14798901
> 
> 赞同：0
> 
> 时间：2013-02-10T14:47:13.890
> 
> 标签：ruby-on-rails, json, d3.js, rails-routing

我正在使用一个示例，`D3.js`该示例使用该函数在 Rails`d3.json`中加载。`flare.json`我的`flare.json`文件与我的视图位于同一文件夹中。当我加载页面时，我收到此错误：

```
ActionController::RoutingError (No route matches [GET] "/flare.json"): 
```

我如何告诉 rails 将此请求路由到flare.json 文件？

这是执行加载的代码：

```
d3.json("flare.json", function(error, root) {
  var node = svg.selectAll(".node")
      .data(bubble.nodes(classes(root))
      .filter(function(d) { return !d.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  node.append("title")
      .text(function(d) { return d.className + ": " + format(d.value); });

  node.append("circle")
      .attr("r", function(d) { return d.r; })
      .style("fill", function(d) { return color(d.packageName); });

  node.append("text")
      .attr("dy", ".3em")
      .style("text-anchor", "middle")
      .text(function(d) { return d.className.substring(0, d.r / 3); });
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T21:51:56.087

在路线中添加条目：

```
match "flare" => "some_controller#index" 
```

在控制器中：

```
def index
  respond_to do |format|
    format.json { render :json => { 1 => "First", 2 => "Second"} }
  end
end 
```

# javascript - jQuery focusin 事件：为什么 event.data 为空？

> ID：14798904
> 
> 赞同：1
> 
> 时间：2013-02-10T14:47:28.377
> 
> 标签：javascript, jquery, events, focus

我的活页夹：

```
$("#wrapper").on("focusin", ".someInputField", function(e, a) {
    /* do something */
}); 
```

我的触发器：

```
$('.someInputField').trigger("focus", ["extra", "data"]); 
```

如何获得“额外”和“数据”值？`e.data`并且`a`总是未定义的。（火狐 18）

然而相关的问题：是否有可能区分a）inputField通过tab或单击获得焦点b）inputField通过一些.trigger（）方法获得焦点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:57:48.777

这是`trigger`额外参数使用的示例：http: [//jsfiddle.net/UQTY2/10/](http://jsfiddle.net/UQTY2/10/)

关于你的第二个问题，如果你在使用`trigger`函数时添加了一个额外的参数，你可以测试它是否是原生事件。在以下示例中，如果`param1`和`param2`不是`null`，则事件已从`trigger`函数调用：

```
$("#wrapper").on("focus", ".someInputField", function(e, param1, param2) {
    /* do something */
    param1 = param1 || null;
    param2 = param2 || null;

    //param 1 and param2 are not null if the event has been called from trigger function
    console.log(param1);
    console.log(param2);   
});

$('.someInputField').trigger("focus", ["data","test"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:57:25.637

您触发事件的顺序在这里很重要：

```
$('input').on('focusin', function(event, extra, data) {
    console.log(extra, data);
});
$('input').trigger('focusin', ['extra', 'data']); 
```

**[小提琴](http://fiddle.jshell.net/rvX5Y/)**

# php - Php 套接字、Apache 和 CentOS 6.3 给予 Permission denied

> ID：14798907
> 
> 赞同：4
> 
> 时间：2013-02-10T14:47:51.197
> 
> 标签：php, apache, sockets, centos, minecraft

我想要做的是运行一个简单的 PHP 脚本来检查游戏服务器是否在线并从中获取一些信息。我在带有 WAMP 服务器的本地机器上运行完全相同的脚本，我只是取消注释 php_openssl.dll 和 php_sockets.dll 并且 - 瞧 - 它按预期工作。

但随后我们的生产环境来了！我通常使用 Debian，但我们的主机决定在我们的专用服务器上安装 CentOS，因为 Debian 中的 NIC 出现故障，此后一直很麻烦。

我克服了一些问题，并留下了这个问题：如何修复 PHP 套接字？我读到我需要 php-common，所以我安装了这个：

```
# yum install php-common 
```

然后我检查了一下`phpinfo()`，我得到了这个

```
'./configure'  '--with-openssl' '--enable-sockets' ... 
```

因此，如果您问我，这看起来不错，openssl 和套接字都已安装并且应该可以工作，但事实并非如此。我在 Stack Overflow 上找到了这个脚本：

```
<?php
//just in case
if (!extension_loaded('sockets')) {
die('The sockets extension is not loaded.');
}
echo '<p><strong>Establishing connection...</strong></p>';
$socket = socket_create(AF_INET,SOCK_STREAM,0);
if (!socket_connect($socket, "stackoverflow.com", 80))
{
die('Socket error : '.socket_strerror(socket_last_error()));
}

echo '<p><strong>Connection successful!</strong></p>';

$request = join("\n",array(
"GET / HTTP/1.1",
"Connection: close",
"Host: stackoverflow.com",
"User-Agent: Mozilla/5.0 (Windows NT 6.1)",
"Accept: text/html,*/*;q=0.8",
""));
socket_write($socket,$request,strlen($request));

$response = socket_read($socket,2048);

echo "<p><strong>This is the received data : </strong></p>";
echo '<pre>'.htmlentities($response).'</pre>';

socket_close($socket); 
```

这个输出完全让我吃惊：

```
Establishing connection...

Connection successful!

This is the received data :

HTTP/1.0 408 Request Time-out
Cache-Control: no-cache
Connection: close
Content-Type: text/html

<html><body><h1>408 Request Time-out</h1>
Your browser didn't send a complete request in time.
</body></html> 
```

但是，我的脚本仍然无法运行？:( 我已经禁用了 iptables

```
# service iptables stop 
```

只是为了确保这不是防火墙问题。当我打开页面而不是游戏服务器名称时，会发生以下情况：

> 警告：socket_connect()：无法连接 [13]：第 9 行 /var/www/test.php 中的权限被拒绝 <<<

这是我正在使用的代码，它是 xPaw 的开源代码，所以我不相信它：

```
<?php
function queryserver( $IP, $Port = 25565, $Timeout = 2 )
{
$Socket = Socket_Create( AF_INET, SOCK_STREAM, SOL_TCP );
Socket_Set_Option( $Socket, SOL_SOCKET, SO_SNDTIMEO, array( 'sec' => (int)$Timeout, 'usec' => 0 ) );
Socket_Set_Option( $Socket, SOL_SOCKET, SO_RCVTIMEO, array( 'sec' => (int)$Timeout, 'usec' => 0 ) );
if( $Socket === FALSE || Socket_Connect( $Socket, $IP, (int)$Port ) === FALSE )
{
return FALSE;
}
Socket_Send( $Socket, "\xFE\x01", 2, 0 );
$Len = @Socket_Recv( $Socket, $Data, 256, 0 );
Socket_Close( $Socket );
if( $Len < 4 || $Data[ 0 ] !== "\xFF" )
{
return FALSE;
}
$Data = SubStr( $Data, 3 );
$Data = iconv( 'UTF-16BE', 'UTF-8', $Data );

if( $Data[ 1 ] === "\xA7" && $Data[ 2 ] === "\x31" )
{
$Data = Explode( "\x00", $Data );
return Array(
'HostName'   => $Data[ 3 ],
'Players'    => IntVal( $Data[ 4 ] ),
'MaxPlayers' => IntVal( $Data[ 5 ] ),
'Protocol'   => IntVal( $Data[ 1 ] ),
'Version'    => $Data[ 2 ]
);
}
$Data = Explode( "\xA7", $Data );
return Array(
'HostName'   => SubStr( $Data[ 0 ], 0, -1 ),
'Players'    => isset( $Data[ 1 ] ) ? IntVal( $Data[ 1 ] ) : 0,
'MaxPlayers' => isset( $Data[ 2 ] ) ? IntVal( $Data[ 2 ] ) : 0,
'Protocol'   => 0,
'Version'    => '1.3'
);
}

$test = queryserver('SERVERADDRESSHERE'); // (i tried multiple, which are all working @wamp)
$echo = $test['HostName'] . "<<< <br />";
echo $echo; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-03T15:02:48.477

在你的 linuxbox 中尝试这个命令（以 root 身份）。

```
setsebool -P httpd_can_network_connect 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-04T21:25:34.180

我有类似的问题，所以我想我也会在这里为遇到此问题的下一个人提供答案。在不禁用/限制 SELinux 的情况下，一种解决方法是更改​​围绕您的 httpd 的策略。

希望这可以为下一个阅读本文的人节省 2 天时间。哈哈

```
chcon -R -t httpd_sys_content_t /var/www
chcon -R -t httpd_sys_content_rw_t /var/www/html 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-11T17:39:16.843

*（代表 OP 发布）。*

我找到了答案。似乎 SELinux 正在阻止套接字连接。使用“# setenforce Permissive”禁用 SE Linux，它现在可以工作了。以防万一有人遇到同样的陌生感。

# php - simplexml_load_file($feedURL) 返回 bool(false) 即使 RSS 工作

> ID：14798909
> 
> 赞同：0
> 
> 时间：2013-02-10T14:48:24.207
> 
> 标签：php, youtube, rss, simplexml

我正在尝试制作一个简单的小部件来加载 youtube rss 提要并显示少数第一个视频。

问题是即使 RSS 地址是正确的，它总是会转储错误

```
$feedURL = 'http://gdata.youtube.com/feeds/api/users/ninpetit/uploads?alt=rss&v=2';
$sxml = simplexml_load_file($feedURL);
var_dump($sxml); /* output:  bool(false)  */ 
```

我究竟做错了什么？有什么替代方法`simplexml_load_file`吗？

PS：此代码正在共享服务器中执行

编辑

我通过 curl 成功获取了数据，但是如果我通过 $data，simplexml_load_file 将返回 false

```
$feedURL = 'http://gdata.youtube.com/feeds/api/users/ninpetit/uploads?alt=rss&v=2';
$ch = curl_init($feedURL);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$data = curl_exec($ch);
echo $data.'<br>'; /* shows data!! */
sxml = simplexml_load_file($data); /*Also false*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T09:33:50.660

如果您的 $data 字符串中有 xml 数据，您可以使用`simplexml_load_string()`函数轻松解析它。

# c# - 反应式扩展，主题

> ID：14798912
> 
> 赞同：0
> 
> 时间：2013-02-10T14:48:39.620
> 
> 标签：c#, system.reactive

我很难理解 Subject 对象。

考虑以下代码：

```
 var sub = new Subject<int>();
        sub.Subscribe(x => Console.WriteLine(x));    //subscriber #1        
        sub.Subscribe(x => Console.WriteLine(x));    //subscriber #2        
        sub.OnNext(2); 
```

我正在创建一个 int 主题，当我执行 OnNext 时，它会调用其他订阅者（#1 和 #2）。我不明白的是，我读到 Subject 意味着一个既可观察又可观察的对象，但这如何解释为什么当我调用 OnNext 时会调用其他订阅者。

我会理解主题的 OnNext 是否会将其传播给所有订阅者 = 发布给所有其他订阅者（这是有道理的），但是当我检查源代码时，我看不到任何这样做的东西，见下文。

有人可以从下面的代码中了解究竟是什么让 OnNext(2) 传播到其他订阅？（＃1，＃2）？

public seal class Subject : ISubject, ISubject, IObserver, IObservable, IDisposable { // 字段 private volatile IObserver _observer;

```
// Methods
public Subject()
{
    this._observer = NopObserver<T>.Instance;
}

public void Dispose()
{
    this._observer = DisposedObserver<T>.Instance;
}

public void OnCompleted()
{
    IObserver<T> comparand = null;
    IObserver<T> completed = DoneObserver<T>.Completed;
    do
    {
        comparand = this._observer;
    }
    while (((comparand != DisposedObserver<T>.Instance) && !(comparand is DoneObserver<T>)) && (Interlocked.CompareExchange<IObserver<T>>(ref this._observer, completed, comparand) != comparand));
    comparand.OnCompleted();
}

public void OnError(Exception error)
{
    if (error == null)
    {
        throw new ArgumentNullException("error");
    }
    IObserver<T> comparand = null;
    DoneObserver<T> observer3 = new DoneObserver<T> {
        Exception = error
    };
    DoneObserver<T> observer2 = observer3;
    do
    {
        comparand = this._observer;
    }
    while (((comparand != DisposedObserver<T>.Instance) && !(comparand is DoneObserver<T>)) && (Interlocked.CompareExchange<IObserver<T>>(ref this._observer, observer2, comparand) != comparand));
    comparand.OnError(error);
}

public void OnNext(T value)
{
    this._observer.OnNext(value);
}

public IDisposable Subscribe(IObserver<T> observer)
{
    if (observer == null)
    {
        throw new ArgumentNullException("observer");
    }
    IObserver<T> comparand = null;
    IObserver<T> observer3 = null;
    do
    {
        comparand = this._observer;
        if (comparand == DisposedObserver<T>.Instance)
        {
            throw new ObjectDisposedException("");
        }
        if (comparand == DoneObserver<T>.Completed)
        {
            observer.OnCompleted();
            return Disposable.Empty;
        }
        DoneObserver<T> observer4 = comparand as DoneObserver<T>;
        if (observer4 != null)
        {
            observer.OnError(observer4.Exception);
            return Disposable.Empty;
        }
        if (comparand == NopObserver<T>.Instance)
        {
            observer3 = observer;
        }
        else
        {
            Observer<T> observer5 = comparand as Observer<T>;
            if (observer5 != null)
            {
                observer3 = observer5.Add(observer);
            }
            else
            {
                observer3 = new Observer<T>(new ImmutableList<IObserver<T>>(new IObserver<T>[] { comparand, observer }));
            }
        }
    }
    while (Interlocked.CompareExchange<IObserver<T>>(ref this._observer, observer3, comparand) != comparand);
    return new Subscription<T>((Subject<T>) this, observer);
}

private void Unsubscribe(IObserver<T> observer)
{
    IObserver<T> comparand = null;
    IObserver<T> instance = null;
Label_0004:
    comparand = this._observer;
    if ((comparand != DisposedObserver<T>.Instance) && !(comparand is DoneObserver<T>))
    {
        Observer<T> observer4 = comparand as Observer<T>;
        if (observer4 != null)
        {
            instance = observer4.Remove(observer);
        }
        else
        {
            if (comparand != observer)
            {
                return;
            }
            instance = NopObserver<T>.Instance;
        }
        if (Interlocked.CompareExchange<IObserver<T>>(ref this._observer, instance, comparand) != comparand)
        {
            goto Label_0004;
        }
    }
}

// Properties
public bool HasObservers
{
    get
    {
        return (((this._observer != NopObserver<T>.Instance) && !(this._observer is DoneObserver<T>)) && (this._observer != DisposedObserver<T>.Instance));
    }
}

// Nested Types
private class Subscription : IDisposable
{
    // Fields
    private IObserver<T> _observer;
    private Subject<T> _subject;

    // Methods
    public Subscription(Subject<T> subject, IObserver<T> observer)
    {
        this._subject = subject;
        this._observer = observer;
    }

    public void Dispose()
    {
        IObserver<T> observer = Interlocked.Exchange<IObserver<T>>(ref this._observer, null);
        if (observer != null)
        {
            this._subject.Unsubscribe(observer);
            this._subject = null;
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T17:57:18.007

我知道，但困扰我的是它没有意义。我进一步研究了代码，发现他们内部的观察者实现包含更多的观察者，见下文。

如果您检查 OnNext 方法，您可以看到它们正在遍历所有观察者并调用它们的 OnNext 方法。

现在一切对我来说都是有意义的，我理解了逻辑，但看不到它是在哪里实现的。

```
internal class Observer<T> : IObserver<T>
{
    private readonly ImmutableList<IObserver<T>> _observers;

    public Observer(ImmutableList<IObserver<T>> observers)
    {
        this._observers = observers;
    }

    internal IObserver<T> Add(IObserver<T> observer)
    {
        return new Observer<T>(this._observers.Add(observer));
    }

    public void OnCompleted()
    {
        foreach (IObserver<T> observer in this._observers.Data)
        {
            observer.OnCompleted();
        }
    }

    public void OnError(Exception error)
    {
        foreach (IObserver<T> observer in this._observers.Data)
        {
            observer.OnError(error);
        }
    }

    public void OnNext(T value)
    {
        foreach (IObserver<T> observer in this._observers.Data)
        {
            observer.OnNext(value);
        }
    }

    internal IObserver<T> Remove(IObserver<T> observer)
    {
        int index = Array.IndexOf<IObserver<T>>(this._observers.Data, observer);
        if (index < 0)
        {
            return this;
        }
        if (this._observers.Data.Length == 2)
        {
            return this._observers.Data[1 - index];
        }
        return new Observer<T>(this._observers.Remove(observer));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:17:37.023

Subject 是一个 observable，因为你可以订阅它。您在示例中执行此操作（您确实订阅了两个订阅者）。

Subject 也是观察者，因为您可以执行以下操作：

```
someObservable.Subscribe(subject); 
```

这样，您的主题将从接收事件`someObservable`并将其传播给自己的订阅者。

PS 在您的代码中，您`OnNext()`自己调用了该方法。但这正是`someObservable`您使用主题订阅它时要做的事情。

# android - 通过意图保存特定活动

> ID：14798914
> 
> 赞同：0
> 
> 时间：2013-02-10T14:48:46.470
> 
> 标签：android

我有一个主要活动，它有一个开始按钮，该按钮将指向下一页（第二个活动）然后从第二个活动有一个按钮也将指向下一页（第三个活动），我的问题是

1.如何在第二个活动意图之后保存第三个活动？

2.如果我退出应用程序并再次打开它，我的主要活动上的开始按钮应该让我进入第三个活动而不是第二个活动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T17:51:31.473

你`finish()`在转换之间打电话吗？你不应该。Android`Activity`为您存储堆栈，因此当用户返回应用程序时，所有三个（1、2、3）活动都将在堆栈上。

现在，为了从 1st -> 3rd 而不是 1st -> 2nd -> 3rd 跳跃，您可以存储第一个`Activity`将检查的标志。如果存在标志，则`startActivity(Intent intent)`直接调用第三个活动。

另一种方法是让 2nd`Activity`检查该标志，`onCreate()`如果它的存在立即开始 3rd `Activity`。确保调用`finish()`，`onCreate()`因为这将避免执行其余的生命周期方法（`onStart()` `onResume()`等）。

希望这可以帮助。

# java - 用于桌面应用程序的 Apache Shiro？

> ID：14798915
> 
> 赞同：2
> 
> 时间：2013-02-10T14:48:50.633
> 
> 标签：java, apache, desktop-application, shiro, rbac

是否可以将 Apache Shiro 用于桌面应用程序？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T17:48:52.907

是的，正如他们在其[网站](http://shiro.apache.org/10-minute-tutorial.html)上指出的那样：

> Shiro 可以在任何环境中运行，从最简单的命令行应用程序到最大的企业 Web 和集群应用程序，

# c# - 检查模型是否为空失败

> ID：14798916
> 
> 赞同：0
> 
> 时间：2013-02-10T14:48:51.587
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, razor

```
 @model Seriebeheer.Domain.Serie

    @{
        ViewBag.Title = "Verijwder serie";
        Layout = "~/Views/Shared/_AdminLayout.cshtml";
    }

    @if (Model != null) 
    {
    <h1>Verwijder @Model.Name</h1>

    Weet u zeker dat u deze serie wilt verwijderen? Dit zal ook alle afleveringen van deze serie verwijderen!<br />

    using (Html.BeginForm("Delete", "SerieAdmin", FormMethod.Post, new {enctype = "multipart/form-data"}))
    {
        @Html.AntiForgeryToken()
        @Html.Hidden("id", @Model.ID)
        <input type="submit" value="Verwijder" />
    }

        <br />
} else 
{ <b>Deze serie bestaat niet</b> } 
```

上面的代码在“weet u zeker ...”行上失败（预期的;）。这个空检查有什么问题？

谢谢

编辑：确切的错误信息：Foutbericht van compiler: CS1002: ; 文字

翻译：来自编译器的错误消息：CS1002：预期；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:53:24.080

如果大括号中的所有内容`{ }`不在 html 标记之间，则 Razor 引擎会将其视为代码。为了使这个起作用，您必须`<span>`在 Weet 之前和 verwijderen`</span>`之后添加！
到这个工作。（当然你可以使用任何你喜欢/想要的 html 标签：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T16:30:26.913

最好改变这个

```
 Weet u zeker dat u deze serie wilt verwijderen? Dit zal ook 
   alle afleveringen van deze serie verwijderen! 
```

至

```
<text>  Weet u zeker dat u deze serie wilt verwijderen? Dit zal ook
       alle afleveringen van deze serie verwijderen!
</text> 
```

用文本节点包装将是一个更好的选择，这不会损害您的 CSS 或 html 此外，Razor 视图引擎不会假定它是服务器端代码，因为它以 HTML 标记开头。在您的情况下，您在没有 @{} 的情况下在 razor 中编写 Html

# c# - 为什么 Reactive ToObservable 使用的方法没有返回？

> ID：14798917
> 
> 赞同：1
> 
> 时间：2013-02-10T14:48:52.853
> 
> 标签：c#, system.reactive

我一直在为我在 RX 上看到的问题寻找解决方案。

我有一个对象列表：`List<Employee>`，每个员工都有一个 ID 和代码。另一个 dll 中有一个类，它获取每个员工的 id 和代码编号并执行涉及多个数据库插入的长时间运行的处理。此数据库插入位于另一个 dll 中的静态类中。

我的问题是我正在使用的 RX 查询有时只能工作，而大多数时候不能工作。这意味着代码中没有错误。如果运行代码 10 次，2 次可以正常工作，8 次失败。我正在使用 .NET 框架的 v4.0。

```
 IObservable<string> RunProcess(Employee emp)
    {           
        using (AnotherDLLClass p = new AnotherDLLClass(emp.id))
        {
            return Observable.Start(() => p.StartLongRun(emp.Code),   Scheduler.ThreadPool);
        }                        
    } 
```

这个employeedatas 列表可能包含1000 或2000 条记录。

```
 EmployeeDatas.ToObservable().Select(x => RunProcess(x).Select(y => new { edata = x, retval = y }))
                    .Merge(10)
                    .ObserveOn(Scheduler.CurrentThread)
                    .Subscribe(x =>
                    {
                        SendReportStatus(x.retval.Item1, x.retval);                           
                    }); 
```

另一个 dll 中的 StartLongRun() 方法具有以下结构。

```
 public string StartLongRun(string code)
  {
     Method1(); // this method has a loop and each loop inserts data to db.
                // each loop calls DBHelper.Save() method to insert data to db.
                // sql con.opens and closes for each insert.

     Method2(); // doing exactly the same like Method1;

     return statusreport; // This return is not happening ????

  } 
```

运行应用程序后，当我检查数据库时，这些值会正确插入到数据库中。当我检查表的计数时，每秒都会正确保存数据，并且计数每秒钟都在增加。

但是为什么该方法没有正确返回。AnotherDLLClass 实现了 IDisposable。当我将断点放在返回部分代码上时，它没有到达那里。

当 EmployeeDatas 只有 1 个项目时，它将到达那里。我实现代码的第一天，它在 1000 个项目上运行良好。我一整天都在使用相同的代码，并且在 1000 个项目上运行良好。

但是第二天当我运行应用程序时，数据正确插入，但没有返回调用。我不明白这种奇怪的行为。

请对此有所了解并指导我。

没有人回答这种奇怪行为的任何解决方案。我在这里做错了吗？请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:28:16.800

```
using (AnotherDLLClass p = new AnotherDLLClass(emp.id))
{
    return Observable.Start(() => p.StartLongRun(emp.Code),   Scheduler.ThreadPool);
} 
```

`p`在上面的代码中，您在`using`子句中进行实例化。然后，您将使用`p`将异步调用的 lambda 表达式。它看起来像比赛条件。如果`() => p.StartLongRun`将被快速执行，那么也不例外。但是在`}`of之后`using`，`p`被释放并且内部 lambda 表达式将失败。

# common-lisp - 编程函数定义：如何去掉这里的“eval”？

> ID：14798920
> 
> 赞同：5
> 
> 时间：2013-02-10T14:49:15.313
> 
> 标签：common-lisp

我有一组名为“ip”、“date”、“url”等的函数。

有了这些，我想生成另一组函数“ip-is”、“date-is”等。

我终于有了以下解决方案，它工作正常，但使用“eval”。

```
(loop for name in '(ip date url code bytes referer user-agent) do
  (let ((c-name (intern (concatenate 'string (symbol-name name) "-IS"))))
    (eval `(defun ,c-name (c)
           #'(lambda (l) (equal (,name l) c)))))) 
```

有人可以帮助我，如何摆脱“邪恶的评估”？对于我的程序来说，函数名称以列表的形式提供是很重要的。所以调用一些宏

```
 (define-predicate ip)
   (define-predicate date)
   (define-predicate url) 
```

等等

不符合我的需要。我对“eval”没有真正的问题，但我经常读到，eval 被认为是不好的风格，应该尽可能避免。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T16:34:54.477

您应该在这里使用宏。宏在编译（或加载）期间进行评估，可用于以编程方式生成函数定义。你的代码可以这样写：

```
(defmacro define-predicates (&rest names)
  `(progn
     ,@(loop
          for name in names
          collect (let ((c-sym (gensym))
                        (l-sym (gensym)))
                    `(defun ,(intern (concatenate 'string (symbol-name name) "-IS")) (,c-sym)
                       #'(lambda (,l-sym) (equal (,name ,l-sym) ,c-sym)))))))

(define-predicates ip date url) 
```

请注意，符号是使用`GENSYM`函数生成的。在这种特殊情况下，这并不是绝对必要的，但我通常更喜欢这样做，以便在以后重构代码时没有任何泄漏的机会。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-10T18:27:56.363

如果您想使用一个函数（而不是另一个答案中的宏），您应该使用[`(setf fdefinition)`](http://www.lispworks.com/documentation/HyperSpec/Body/f_fdefin.htm)：

```
(loop for name in '(ip date url code bytes referer user-agent) do
  (let ((c-name (intern (concatenate 'string (symbol-name name) "-IS"))))
    (setf (fdefinition c-name)
          (lambda (c) (lambda (l) (equal (funcall name l) c)))))) 
```

# java - Paint Like JComponent 绘图板

> ID：14798922
> 
> 赞同：0
> 
> 时间：2013-02-10T14:49:25.670
> 
> 标签：java, layout, paint, jcomponent

我有一个扩展类 Pad_Draw `JComponent`。构造函数是

```
public Pad_Draw()
{
      this.setDoubleBuffered(true);
      this.setLayout(null);
}; 
```

paintComponent 方法是：

```
 public void paintComponent( Graphics g )
 {
      graphics2D = (Graphics2D)g;
      graphics2D.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
      graphics2D.setPaint(Color.white);
      graphics2D.fillRect(0, 0, getSize().width, getSize().height);
 } 
```

在`JFrame`我通过 ScrollPane 添加这个：

```
 JScrollPane Padscroller = new JScrollPane();
    Padscroller.setWheelScrollingEnabled(true);
    Padscroller.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
    Padscroller.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
    Padscroller.setPreferredSize(new Dimension(200, 100));
    Padscroller.setMinimumSize(new Dimension(200, 100));
    Padscroller.setMaximumSize(new Dimension(200, 100));
    Padscroller.setViewportView(drawPad);
    content.add(Padscroller, BorderLayout.CENTER); 
```

但是只要我在框架中添加内容并设置框架的大小。绘图板根据需要采用整个尺寸。

我希望保持我指定的大小（200,100），我实际上想要像 Windows Paint 应用程序那样的东西。我应该可以通过扩展一个角落来增加尺寸。一旦我扩展角落，滚动条就会被激活。谁能给我任何想法如何实现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T14:56:10.137

的默认布局管理器`JFrame`不`BorderLayout`尊重其组件的首选大小。

您可以使用布局管理器，例如`BoxLayout`，并在组件中覆盖 getPreferredSize `Padscroller`：

```
JScrollPane padScroller = new JScrollPane() {
   @Override
   public Dimension getPreferredSize() {
      return new Dimension(200, 100);
   } 
}; 
```

关于增加大小，请查看在[mouseDragged](http://docs.oracle.com/javase/7/docs/api/java/awt/event/MouseAdapter.html#mouseMoved%28java.awt.event.MouseEvent%29)方法中使用`MouseAdapter`并更新此属性。

# javascript - 动态加载的div上的Javascript AJAX？

> ID：14798924
> 
> 赞同：0
> 
> 时间：2013-02-10T14:49:41.057
> 
> 标签：javascript, html, ajax

[如何将 onload 事件添加到 div 元素？](https://stackoverflow.com/questions/4057236/how-to-add-onload-event-to-a-div)

我读过这个，尽管我有一个问题..我知道没有`onLoad`div，但我应该能够像这样执行一个片段：

```
...
<div id="content">
    <div class="text">
    </div>
</div>
<script type="text/javascript">
    navigate('main.php', 'content');
</script>
.... 
```

这不起作用，如果我启动一个新的浏览器会话并导航到 index.php，它会显示一个登录窗口。登录后它会将我重定向到 index.php，但设置了一些会话变量和 cookie。现在 index.php 包含上面的代码，在此`content`之前不存在。

现在到我的问题：似乎大多数浏览器拒绝接受`content`存在的存在，在我拥有的导航功能中：

```
function navigate(str, what) {
    if(what == null) {
        what = document.documentElement;
    } else {
        what = document.getElementById(what);
    } 
```

会变成什么，`null`因为它在执行时不是有效的元素。

我试过了：

```
window.onLoad = naviate('main.php', 'content'); 
```

哪个什么都不做，那里有同样的问题..还尝试`<script>`在没有运气的情况下将块放在最后。

我不能使用 jQuery 或任何东西，所以请将其保留为标准的 Javascript、HTML 和 CSS。使用的浏览器：IE8、Chrome、FireFox。

* * *

1.  加载 index.php
2.  登录到登录窗口
3.  加载 index.php
4.  完成 index.php 加载后，读取所有元素，包括`content`
5.  更新`content`一些 AJAX 数据。

## 如果它有效

我登录，加载页面一次，结果不成功，然后再次刷新页面。

## 原因如下：

我也在登录窗口上使用 AJAX，它使用`navigate()`我所有的按钮，而不是什么。所以问题是`index.php`通过登录窗口加载，该登录窗口使用 AJAX (javascript) 更新整个页面，然后尝试`navigate()`从 AJAX 调用的返回数据中再次调用...... **“内联”`navigate()`得到打电话！！！**，只是它不知道所有元素，因为它是通过 AJAX 加载的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:58:48.850

根据我的测试，您`.getElementById`甚至可以在页面加载之前获取 div 元素。
不要忘记`navigate`函数必须在调用之前定义。因此，如果您的脚本位于文档末尾（这是正确的），则必须在执行这些脚本后调用该函数。

但是无论如何，您`.onload`错误地分配了该功能。像这样做：

```
window.onload = function(event) {
                /*any script here*/
} 
```

或者像这样：

```
function load(event) {
                /*any script here*/
}
window.onload =load; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:56:35.777

尝试这个 ：

```
window.onload = function(){
    navigate('main.php', 'content');
} 
```

# java - Android Activity 显示内容的时间过长

> ID：14798927
> 
> 赞同：8
> 
> 时间：2013-02-10T14:49:58.540
> 
> 标签：java, android, android-activity

我的 Activity in`onCreate()`执行需要一些时间的长时间计算。

同样`onCreate()`，我调用`setContentView()`设置活动的外观。

关键是，由于执行上述计算需要一段时间，因此只有在很长一段时间后才会加载 Activity 的屏幕。

请，关于如何避免这种情况的任何建议？

我试图调用`setContentView()`并`onCreate()`开始计算`onResume()`，但活动屏幕仅在最后加载。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-10T14:53:03.293

[除了使用例如AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)之外别无他法。原因是实际的渲染不是异步进行的；换句话说， setContentView 只会设置一些数据，但不会在那个时间点显示任何内容。

然而，AsyncTask 并不一定意味着“长”计算。但是，如果您的应用程序依赖于结果，并且没有其他并行计算发生，那么它可能仍然是您实现所需目标的最简单方法。如果没有，您甚至可能不得不使用线程。

**更新由于每个人都在用更多不同质量的***AsyncTask*答案轰炸原始海报，我想再强调一次 AsyncTask 用于*短*操作（引用参考：*最多几秒钟*），而 OP 有没有说明他的计算真正需要多长时间*。*此外，AsyncTask 是一次性对象，只能运行一次。

需要考虑的另一个非常重要的点如下。Android 为 AsyncTask 分配一个后台任务优先级。这意味着，除了较低的调度优先级外，**AsyncTask 中的计算将比在前台执行的时间长十倍**，因为 Android 运行所有具有后台优先级的任务，人为限制了 10% 的 CPU 周期。但是，可以通过“稍微”提高其优先级来将 AsyncTasks 从该组中移除。对于 AsyncTask，它会像这样完成：

```
public R doInBackground(I... is) {
    Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND +
                              Process.THREAD_PRIORITY_MORE_FAVORABLE);
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T15:14:04.810

你必须实现 AsyncTask

```
 public class AsyncTaskActivity extends Activity implements OnClickListener {
    Button btn;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        btn = (Button) findViewById(R.id.button1);.
                    //because we implement OnClickListener we only have to pass "this" (much easier)
        btn.setOnClickListener(this);
    }

    public void onClick(View view){
        //detect the view that was "clicked"
        switch(view.getId())
        {
          case R.id.button1:
              new LongOperation().execute("");
          break;

        }

    }

    private class LongOperation extends AsyncTask<String, Void, String> {

          @Override
          protected String doInBackground(String... params) {
                for(int i=0;i<5;i++) {
                    try {
                        Thread.sleep(1000);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                }

                return "Executed";
          }      

          @Override
          protected void onPostExecute(String result) {
                TextView txt = (TextView) findViewById(R.id.output);
                txt.setText("Executed"); // txt.setText(result);
                //might want to change "executed" for the returned string passed into onPostExecute() but that is upto you
          }

          @Override
          protected void onPreExecute() {
          }

          @Override
          protected void onProgressUpdate(Void... values) {
          }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T14:53:05.857

如果所有计算都需要很长时间才能执行，那么您的 UI 将被“锁定”并且不会更新。

您需要在[AsyncTask中完成所有长期工作](http://developer.android.com/reference/android/os/AsyncTask.html)

*AsyncTask 允许正确和轻松地使用 UI 线程。此类允许在 UI 线程上执行后台操作并发布结果，而无需操作线程和/或处理程序。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T14:54:01.473

在开始初始化视图之前在 onCreate 方法中调用 setContentView(layoutID)，创建[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)并在仅在 onCreate 方法中调用 setContentView 之后启动[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)线程。如下所示

```
 onCreate(....){
    --
    --
    setContentView(layoutID);
    ---
    --
    new asynchTask(); // load your ui in AsyncTask by creating an inner class in your activity by extending AsyncTask class

    } 
```

这是一个[如何实现 AsyncTask的教程](http://www.vogella.com/articles/AndroidPerformance/article.html)

# c# - C# datagrid 视图等待选定的行

> ID：14798928
> 
> 赞同：0
> 
> 时间：2013-02-10T14:50:07.140
> 
> 标签：c#, datagrid, wait

我有一个带有函数的 ac# 表单，它在 sql 数据库中搜索一个项目，然后在另一个窗口中弹出一个可能的结果列表。我想等到用户选择一行，然后返回该结果。一切都按预期工作，但我想不出一种有效的方法来循环等待，直到项目被选中。有任何想法吗？

显示窗口的功能：

```
 // Some sql crap to fill a dataset...//

      Da.Fill(Items, "Items");
      Connection.Close();

      var ItemSearch = new Window1(); // Load new window with a datagrid
      ItemSearch.Show();
      ItemSearch.dataGrid1.ItemsSource = Items.Tables["Items"].DefaultView;
      ItemSearch.dataGrid1.SelectionMode = DataGridSelectionMode.Single;
      ItemSearch.dataGrid1.SelectionUnit = DataGridSelectionUnit.FullRow;

      while (ItemSearch.dataGrid1.SelectedItem != null)
      {
        // Do something until the user selects a row, then return that row
          Thread.Sleep(100); // Doesn't work... Locks whole screen
      }

      }
      return ItemCode; // Selected row 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:51:55.403

使用`ItemSearch.ShowDialog`. 它将阻止后续代码运行，直到表单关闭。

您应该在表单本身中设置 datagrid1 属性。将数据源传递给 window1 构造函数（您应该重载默认构造函数）：

```
 var ItemSearch = new Window1(Items.Tables["Items"].DefaultView); 
  ItemSearch.ShowDailog(); 
```

Window1 构造函数：

```
public Window1(System.Data.DataView datasource)
  {  
      InitializeComponent();

      dataGrid1.ItemsSource = datasource;
      dataGrid1.SelectionMode = DataGridSelectionMode.Single;
      dataGrid1.SelectionUnit = DataGridSelectionUnit.FullRow;
  } 
```

# c# - 如何使用关键字拆分文本并循环它

> ID：14798932
> 
> 赞同：0
> 
> 时间：2013-02-10T14:50:35.293
> 
> 标签：c#, split

我有一个文本，我想在文本的每一行上执行相同的方法。我的问题是文本不在一个长行（db）示例中：

```
string text = "dog aa aa aa aa dog bb bb bb bb dog cc cc cc cc dog dd dd dd dd dog" 
```

我想每次在“狗”这个词之间执行我的方法，

1.preform on aa aa aa aa
2.preform on bb bb bb bb
3.preform on cc cc cc cc
4.preform on dd dd dd dd

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:55:34.840

```
int i = 0
for(string[] arr = text.Split("dog"); i < arr.Count; i++)
{
method(arr[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:02:27.050

在 System.Text.RegularExpressions 中，您可以使用静态 RegEx.Split 方法执行以下操作：

```
string[] list = Regex.Split(text, @"dog");
foreach (string s, list)
{
    Console.WriteLine(s);
} 
```

或者您可以使用 ForEach 方法：

```
Regex.Split(text, @"dog").ToList().ForEach(s => Console.WriteLine(s)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T14:55:36.273

怎么样：

```
var text = "dog aa aa aa aa dog bb bb bb bb dog cc cc cc cc dog dd dd dd dd dog";
var lines = text.Split(new string[] { "dog" }, StringSplitOptions.RemoveEmptyEntries);
foreach (var line in lines)
    Console.WriteLine(x); 
```

# sql - VBA UDF 有没有办法“知道”将运行哪些其他函数？

> ID：14798933
> 
> 赞同：2
> 
> 时间：2013-02-10T14:50:38.133
> 
> 标签：sql, excel, user-defined-functions, excel-2010, vba

假设我有一个将在工作表中使用 100,000 多次的 UDF。在函数中，有没有办法让它知道在批处理中还要调用多少次？基本上我想做的是让每个函数都创建一个待办事项列表。我想做类似的事情：

```
IF remaining functions to be executed after this one = 0 then ... 
```

有没有办法做到这一点？

背景：

我想制作一个 UDF，用户只需提供参数（日期、小时、节点、类型）即可执行 SQL 查询。如果您愿意在每次运行函数时实际执行 SQL 查询，这很容易做到。我知道这很容易，因为我这样做了而且速度非常慢。我的新想法是让函数首先查看它要查找的数据是否存在于全局缓存变量中，如果不将其添加到全局变量“job-list”中。

我想要它做的是当调用最后一个函数时，然后遍历作业列表并执行最少数量的 SQL 查询并填充全局缓存变量。一旦缓存变量已满，它将执行表刷新以使所有其他函数再次被调用，因为在随后的调用中，它们将在缓存中找到所需的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T17:55:21.983

首先：
VBA UDF 性能对 UDF 的编码方式极为敏感：请参阅我关于编写高效 VBA UDF 的系列文章：

[http://fastexcel.wordpress.com/2011/06/13/writing-efficient-vba-udfs-part-3-avoiding-the-vbe-refresh-bug/](http://fastexcel.wordpress.com/2011/06/13/writing-efficient-vba-udfs-part-3-avoiding-the-vbe-refresh-bug/)

[http://fastexcel.wordpress.com/2011/05/25/writing-efficient-vba-udfs-part-1/](http://fastexcel.wordpress.com/2011/05/25/writing-efficient-vba-udfs-part-1/)

您还应该考虑使用数组 UDF 返回多个结果： http:
[//fastexcel.wordpress.com/2011/06/20/writing-efiicient-vba-udfs-part5-udf-array-formulas-go-faster/](http://fastexcel.wordpress.com/2011/06/20/writing-efiicient-vba-udfs-part5-udf-array-formulas-go-faster/)

其次：
本系列的第 12 篇文章概述了使用 AfterCalculate 事件和缓存 [http://fastexcel.wordpress.com/2012/12/05/writing-efficient-udfs-part-12-getting-used-range-fast-using -application-events-and-a-cache/](http://fastexcel.wordpress.com/2012/12/05/writing-efficient-udfs-part-12-getting-used-range-fast-using-application-events-and-a-cache/)
基本上，您需要的方法是让 UDF 检查缓存，如果不是当前的或可用的，则将请求添加到队列中。
然后使用计算后事件处理队列，并在必要时触发另一个重新计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T17:32:52.910

从 Excel 电子表格执行 100,000 个 SQL 查询似乎是一个糟糕的设计。在这些之上创建缓存机制似乎使问题复杂化，使其比可能需要的更复杂。在某些情况下这可能是合适的，但我会考虑其他设计方法。

最明显的是从 Excel 电子表格中获取数据并将其加载到数据库中的表中。然后使用数据库*对所有行进行一次*处理。最后一步是将结果读回 Excel。

我发现将大量行从 Excel 获取到数据库的最佳方法是将 Excel 文件保存为 csv 并批量插入它们。

这种方法可能不适用于您的问题。不过，总的来说，在数据库中运行的基于集合的方法会表现得更好。

至于缓存机制，如果你必须走那条路。我可以想象一个具有以下伪代码的函数：

```
Check if input values are in cache.
If so, read values from cache.
Else do complex processing.
Load values in cache. 
```

这个逻辑可以进入函数。不过，正如@Bulat 建议的那样，最好在函数周围添加一个额外的缓存层。

# java - 使用 JPA 休眠不会创建表

> ID：14798934
> 
> 赞同：3
> 
> 时间：2013-02-10T14:50:49.760
> 
> 标签：java, hibernate, jpa

我想使用 Hibernate + JPA 创建一个表。问题是，每当我运行我的代码时，它都不会创建任何表。我已经创建了一个空数据库。我使用休眠 + JPA + HSQL + Maven。

这是我的persistence.xml：

```
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"> 
```

```
<!-- Provider of Persistence -->
<provider>org.hibernate.ejb.HibernatePersistence</provider>

<!-- Classes, in which JPA-Annotations are read -->
<class>com.mysite.warehousebase.base.ProductData</class>

<properties>
  <property name="hibernate.connection.driver_class" value="org.hsqldb.jdbcDriver"/>
  <property name="hibernate.connection.url" value="jdbc:hsqldb:Warehouse"/>
  <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
  <property name="hibernate.connection.username" value="sa" />
  <property name="hibernate.connection.password" value="" />

  <property name="hibernate.show_sql" value="true"/>
  <property name="hibernate.format_sql" value="true"/>

  <property name="hibernate.hbm2ddl.auto" value="update"/>
</properties>
</persistence-unit>
</persistence> 
```

这是我的 productData.java 代码：

```
import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.Table;
import org.hibernate.annotations.ForeignKey;
import org.hibernate.validator.NotNull;

@Entity
@Table(name = "products")
public class ProductData extends Entityclass {

private static final long serialVersionUID = 1L;

/*
//Product Addition Time
@NotNull
@Column(name = "added", nullable = false)
private Date productAdded;*/

//Product Name
@NotNull
@Column(name = "productname", nullable = false)
private String productName;

//Product Description
@Column(name = "productdescription", nullable = true)
private String productDescription;

//Product Size
@Column(name = "productsize", nullable = true)
private String productSize;

//Product Amount
@NotNull
@Column(name = "productamount", nullable = false)
private int productAmount;

//Product Left
//Attribute to be calculated in own method
@NotNull
@Column(name = "productleft", nullable = false)    
private int productLeft;

//Product buy price
@NotNull
@Column(name = "productprice", nullable = false)     
private double productPrice;

//Total cost
//Attribute to be calculated in own method
@NotNull
@Column(name = "totalproductprice", nullable = false)
private double totalProductPrice;

//Product sell price
@NotNull
@Column(name = "productsellprice", nullable = false)
private double productSellPrice;

//Product sale
//Attribute to be calculated in own method
@NotNull
@Column(name = "totalsellprice", nullable = false)    
private double totalSellPrice;

//Difference between cost and sale (total)
//Attribute to be calculated in own method
@NotNull
@Column(name = "buyselldifference", nullable = false)    
private double buySellDifference;

//Product status; ordered, at warehouse, reserved.
//Attribute to be calculated in own method
@NotNull
@Column(name = "productstatus", nullable = false)    
private String productStatus;

@Column(name = "reservedproducts", nullable = true)
private int reservedProducts;

/**
 * All Setters and Getters
 * 
 */

/**
 * @return the productName
 */
public String getProductName() {
    return productName;
}

/**
 * @param productName the productName to set
 */
public void setProductName(String productName) {
    this.productName = productName;
}

/**
 * @return the productDescription
 */
public String getProductDescription() {
    return productDescription;
}

/**
 * @param productDescription the productDescription to set
 */
public void setProductDescription(String productDescription) {
    this.productDescription = productDescription;
}

/**
 * @return the productSize
 */
public String getProductSize() {
    return productSize;
}

/**
 * @param productSize the productSize to set
 */
public void setProductSize(String productSize) {
    this.productSize = productSize;
}

/**
 * @return the productAmount
 */
public int getProductAmount() {
    return productAmount;
}

/**
 * @param productAmount the productAmount to set
 */
public void setProductAmount(int productAmount) {
    this.productAmount = productAmount;
}

/**
 * @return the productLeft
 */
public int getProductLeft() {
    return productLeft;
}

/**
 * @param productLeft the productLeft to set
 */
public void setProductLeft(int productLeft) {
    this.productLeft = productLeft;
}

/**
 * @return the productPrice
 */
public double getProductPrice() {
    return productPrice;
}

/**
 * @param productPrice the productPrice to set
 */
public void setProductPrice(double productPrice) {
    this.productPrice = productPrice;
}

/**
 * @return the totalProductPrice
 */
public double getTotalProductPrice() {
    return totalProductPrice;
}

/**
 * @param totalProductPrice the totalProductPrice to set
 */
public void setTotalProductPrice(double totalProductPrice) {
    this.totalProductPrice = totalProductPrice;
}

 /**
 * @return the productSellPrice
 */
public double getProductSellPrice() {
    return productSellPrice;
}

/**
 * @param productSellPrice the productSellPrice to set
 */
public void setProductSellPrice(double productSellPrice) {
    this.productSellPrice = productSellPrice;
}

/**
 * @return the totalSellPrice
 */
public double getTotalSellPrice() {
    return totalSellPrice;
}

/**
 * @param totalSellPrice the totalSellPrice to set
 */
public void setTotalSellPrice(double totalSellPrice) {
    this.totalSellPrice = totalSellPrice;
}

/**
 * @return the buySellDifference
 */
public double getBuySellDifference() {
    return buySellDifference;
}

/**
 * @param buySellDifference the buySellDifference to set
 */
public void setBuySellDifference(double buySellDifference) {
    this.buySellDifference = buySellDifference;
}

/**
 * @return the productStatus
 */
public String getProductStatus() {
    return productStatus;
}

/**
 * @param productStatus the productStatus to set
 */
public void setProductStatus(String productStatus) {
    this.productStatus = productStatus;
}

    /**
 * @return the reservedProducts
 */
public int getReservedProducts() {
    return reservedProducts;
}

/**
 * @param reservedProducts the reservedProducts to set
 */
public void setReservedProducts(int reservedProducts) {
    this.reservedProducts = reservedProducts;
}

/**
 * @return the productSection
 */
public ProductSection getProductSection() {
    return productSection;
}

/**
 * @param productSection the productSection to set
 */
public void setProductSection(ProductSection productSection) {
    this.productSection = productSection;
}

public ProductData(){

}

public ProductData(String productName){
    this.productName = productName;
}

} 
```

我的 main.java 代码：

```
 public static void main(String[] args) {

    DataStructureTest testProduct = new DataStructureTest();
    testProduct.testProductData();
} 
```

怎么了？为什么 Hibernate 不会创建需要的表？我尝试使用值为“update”的 hibernate.hbm2ddl.auto。它不会有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T10:04:50.847

我找到了解决方案。出于某种原因，价值

`property name="hibernate.connection.url" value="jdbc:hsqldb:Warehouse"`

不会工作。因此，我没有做的是创建了一个数据库连接，该连接的值如下 `jdbc:hsqldb:file:[folder name]`

此文件夹名称是用户定义的。因此，该特定行的新代码将是：

`property name="hibernate.connection.url" value="jdbc:hsqldb:file:[folder name]"`

现在一切运行顺利，表已创建和更新:)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:56:58.737

你能试试吗

```
<property name="hibernate.hbm2ddl.auto" value="create"/> 
```

同样 '`transaction-type="RESOURCE_LOCAL"`在持久性 xml 中定义

# javascript - javascript读取鼠标位置并写入文件

> ID：14798937
> 
> 赞同：-1
> 
> 时间：2013-02-10T14:50:58.613
> 
> 标签：javascript, html, webpage

我试图在 HTML 页面上单击图像时获取鼠标指针的坐标，用户必须单击图像，我想使用 javascript 获取单击位置的坐标并写入文件服务器本身。我正在使用 site44 从我的 Dropbox 帐户托管。我无法将坐标写入文件。

```
<html>
<head>
<title>image click test</title>
<script type="text/javascript">
function coord()
{
var x;
var y;
x=event.offsetX; 
y=event.offsetY;
ActiveXObject("Scripting.FileSystemObject");
var file = object.CreateTextFile("hello.txt",false);
file.WriteLine(x);
file.WriteLine("by");
file.WriteLine(y); 
file.Close();
}
</script>
</head>

<body onclick="coord()">This is a sample image, please click anywhere on the image. But ensure you click only once.<br>
<img src="index_catfish.jpg" alt="Click Image" usemap="#imageclick"/>
<map name="imageclick">
</map>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:52:39.257

浏览器的 JS 实现不能直接写入本地文件。唯一的方法是将数据存储在 cookie 或 localStorage 中（如果浏览器支持）。

# jquery - 当 div#footerstart 在屏幕上时，fadeOut div#wrapper_footer_fixed

> ID：14798939
> 
> 赞同：0
> 
> 时间：2013-02-10T14:51:13.050
> 
> 标签：jquery, anchor, fadein, fadeout, sticky-footer

我正在尝试在我的页面上设置一个粘性页脚，条件是显示或隐藏它。HTML如下：

```
 <div id="wrapper_footer_fixed">
            <?php echo $this->getChildHtml('footer') ?>

            <div class="clear"></div>
        </div>

        <div id="footerstart"></div>

        <div id="wrapper_footer">
            <?php echo $this->getChildHtml('footer') ?>

            <div class="clear"></div>
        </div> 
```

我为#wrapper_footer_fixed 拥有的CSS 是：

```
 #wrapper_footer_fixed {
            position: fixed;
            bottom: 0;
            left: 0;
            z-index: 99999;
            display: block;
            width: 100%;
            height: 40px;
            border-top: 1px solid #e5e5e5;
            background: #292929 url("../images/bkg_site_rock_pattern.png");
            } 
```

#footerstart 是#wrapper_footer 开始位置的标记。

我需要这个工作的方式是：

1.  #wrapper_footer_fixed 默认加载到屏幕上
2.  当#footerstart（或#wrapper_footer）在页面上可见时，#wrapper_footer_fixed 不可见（fadeOut）。
3.  如果视口正在查看#footerstart（或#wrapper_footer）并且用户向上滚动（以便#footerstart 不再在屏幕上），#wrapper_footer_fixed 立即显示在屏幕中（淡入）。
4.  如果页面的高度足够短以至于没有垂直滚动，则 #wrapper_footer_fixed 不会显示，但如果内容是在没有重新加载的情况下动态添加到页面时会显示 (fadeIn)，显示垂直滚动条。

我的失败尝试如下（我对 jQuery 的了解非常有限）：

```
 jQuery(document).ready(function(){ 
    if(jQuery('#footerstart').is(':visible')){
        jQuery('#wrapper_footer_fixed').fadeOut();
    } else if(jQuery('#footerstart').not(':visible')) {
        jQuery('#wrapper_footer_fixed').fadeIn();
    }
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:03:36.503

您必须计算#footerstart 是否可见。“如果元素占用了文档中的空间，则它们被认为是可见的。可见元素的宽度或高度大于零。” - [http://api.jquery.com/visible-selector/](http://api.jquery.com/visible-selector/)

```
$(function() {
    if($(window).height() + $(window).scrollTop() > $('#footerstart').offset().top) {
        // $('#footerstart') is visible
    }
    else {

    }
}); 
```

# xml - 如何在 actionscript 3 中修改我的 xml 文件

> ID：14798943
> 
> 赞同：0
> 
> 时间：2013-02-10T14:51:49.627
> 
> 标签：xml, actionscript-3, flash, xmlhttprequest

我在互联网上有 xml 文件，例如[http://www.w3schools.com/xml/note.xml](http://www.w3schools.com/xml/note.xml)。我可以在 actionscript 中读取这个 xml 文件。但是我想修改这个 xml，所以我想添加 xml 节点或删除 xml 节点.

例如：

```
<note>
 <to>Tove</to>
 <from>Jani</from>
 <heading>Reminder</heading>
 <body>Don't forget me this weekend!</body>
</note> 
```

我想添加到我的 xml 笔记的节点中

```
<example>mynodecontent</example> 
```

后来想修改，比如我的xml文件上的如下xml

```
<note>
 <to>Tove</to>
 <from>Jani</from>
 <heading>Reminder</heading>
 <body>Don't forget me this weekend!</body>
 <example>mynodecontent</example>
</note> 
```

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T15:00:32.190

试试这个：

```
var xmlLoader:URLLoader = new URLLoader();
xmlLoader.load(new URLRequest("http://www.w3schools.com/xml/note.xml"));
xmlLoader.addEventListener(Event.COMPLETE, processXML);

var newNode:XML = <example>mynodecontent</example>

function processXML(e:Event):void
{
    var myXML:XML = new XML(e.target.data);

    myXML.insertChildAfter(myXML.body, newNode);

    trace(myXML);
} 
```

**如果你想发送修改后的 XML，你就是链接。必须有服务器 PHP 代码或其他。**

# c++ - 为什么多个增量/减量在 C++ 中有效但在 C 中无效？

> ID：14798953
> 
> 赞同：8
> 
> 时间：2013-02-10T14:52:27.057
> 
> 标签：c++, c, language-lawyer, lvalue, incompatibility

**测试。（c/cpp）**

```
#include <stdio.h>

int main(int argc, char** argv)
{
  int a = 0, b = 0;
  printf("a = %d, b = %d\n", a, b);
  b = (++a)--;
  printf("a = %d, b = %d\n", a, b);

  return 0;
} 
```

如果我将以上内容保存为 .cpp 文件，它会在执行时编译并输出：

```
a = 0, b = 0
a = 0, b = 1 
```

但是，如果我将其保存为 .c 文件，则会收到以下错误：

```
test.c:7:12: error: lvalue required as decrement operator. 
```

手术前不应该`(++a)`先解决`(newValue)--`手术吗？有人对此有任何见解吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-10T14:55:15.163

在 C 中，前缀和后缀递增/递减运算符的结果不是左值。

在 C++ 中，后缀递增/递减运算符的结果也不是左值，但前缀递增/递减运算符的结果是左值。

现在在 C++ 中做类似的事情`(++a)--`是未定义的行为，因为您在两个序列点之间修改了两次对象值。

**编辑：**跟进@bames53 评论。它在 C++98/C++03 中是未定义的行为，但 C++11 中关于序列点概念的更改现在使该表达式已定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T14:58:09.393

在 C 和 C++ 中，左值表达式可以用在运算符的左侧，`=`而右值表达式则不能。C++ 允许更多的东西成为左值，因为它支持引用语义。

```
++ a = 3; /* makes sense in C++ but not in C. */ 
```

递增和递减运算符类似于赋值，因为它们修改了它们的参数。

在 C++03 中，`(++a)--`会导致未定义的行为，因为两个没有相互排序的操作正在修改同一个变量。（即使一个是“pre”，一个是“post”，它们是无序的，因为没有`,`, `&&`,`?`等。）

在 C++11 中，表达式现在可以满足您的期望。但是 C11 并没有改变任何这样的规则，这是一个语法错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-10T15:04:34.787

对于任何可能想要标准中所述差异的精确细节的人，C99，§6.5.3/2 说：

> 前缀 ++ 运算符的操作数的值递增。结果是递增后操作数的新 **值**。

相比之下，C++11，§5.3.2/1 说：

> 结果是更新的*操作数*；它是一个**左值**，如果操作数是一个位域，它就是一个位域。

[强调，在这两种情况下]

另请注意，虽然在is an`(++a)--`时给出了未定义的行为（至少在 C++03 中），但 if是一些用户定义的类型，所以您使用自己的and重载，行为将被定义——在这种情况下，你得到相当于：`a``int``a``++``--`

```
a.operator++().operator--(0); 
```

由于每个运算符都会导致一个函数调用（不能重叠），因此您实际上*确实*有序列点来强制定义行为（请注意，我不建议使用它，只注意在这种情况下实际定义了行为）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T15:02:58.143

§5.2.7 递增和递减：

> 后缀`++`表达式的值是其操作数的值。*[...]*  **操作数应该是一个可修改的左值**。

您在 C 编译中遇到的错误有助于表明这只是 C++ 中存在的一个功能。

# spring - 试图将 ldap 连接到 spring 项目 - LDAP：错误代码 32 - 没有这样的对象

> ID：14798957
> 
> 赞同：-1
> 
> 时间：2013-02-10T14:52:38.100
> 
> 标签：spring, spring-security, ldap, openldap

我试图在我的 mac 上使用 openldap 启动并运行一个 spring 项目。

因为 openldap 默认安装在 OSX 上，我使用那个，然后用 Apache Directory studio 配置它。

我的目录如下所示：

![当前目录结构](../Images/52ad9a4f9da2bc6b43f48d8b38678268.png)

像这样的实体：

![在此处输入图像描述](../Images/d9504b91b73d6169a942e32e20727cd2.png)

当我尝试使用 nilsi 和正确的密码登录时，在 Eclipse 中出现错误：

```
org.springframework.ldap.NameNotFoundException: [LDAP: error code 32 - No Such Object]; nested exception is javax.naming.NameNotFoundException: [LDAP: error code 32 - No Such Object]; remaining name ''
at org.springframework.ldap.support.LdapUtils.convertLdapException(LdapUtils.java:174)
at org.springframework.ldap.core.LdapTemplate.search(LdapTemplate.java:306)
at org.springframework.ldap.core.LdapTemplate.search(LdapTemplate.java:259)
at org.springframework.ldap.core.LdapTemplate.search(LdapTemplate.java:606)
at org.springframework.ldap.core.LdapTemplate.search(LdapTemplate.java:524)
at org.springframework.security.ldap.SpringSecurityLdapTemplate.searchForSingleAttributeValues(SpringSecurityLdapTemplate.java:173)
at org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator.getGroupMembershipRoles(DefaultLdapAuthoritiesPopulator.java:215)
at org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator.getGrantedAuthorities(DefaultLdapAuthoritiesPopulator.java:185)
at org.springframework.security.ldap.authentication.LdapAuthenticationProvider.loadUserAuthorities(LdapAuthenticationProvider.java:197)
at org.springframework.security.ldap.authentication.AbstractLdapAuthenticationProvider.authenticate(AbstractLdapAuthenticationProvider.java:63)
at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:156)
at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174)
at org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.attemptAuthentication(UsernamePasswordAuthenticationFilter.java:94)
at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:194)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:680) 
```

在 ldap 控制台中，我得到以下信息：

```
conn=1000 fd=14 ACCEPT from IP=127.0.0.1:49474 (IP=0.0.0.0:389)
connection_get(14): got connid=1000
connection_read(14): checking for input on id=1000
ber_get_next
ber_get_next: tag 0x30 len 34 contents:
op tag 0x60, time 1360507317
ber_get_next
conn=1000 op=0 do_bind
ber_scanf fmt ({imt) ber:
ber_scanf fmt (m}) ber:
>>> dnPrettyNormal: <ou=users,o=backlog>
<<< dnPrettyNormal: <ou=users,o=backlog>, <ou=users,o=backlog>
conn=1000 op=0 BIND dn="ou=users,o=backlog" method=128
do_bind: version=3 dn="ou=users,o=backlog" method=128
conn=1000 op=0 BIND dn="ou=users,o=backlog" mech=SIMPLE ssf=0
do_bind: v3 bind: "ou=users,o=backlog" to "ou=users,o=backlog"
send_ldap_result: conn=1000 op=0 p=3
send_ldap_response: msgid=1 tag=97 err=0
ber_flush2: 14 bytes to sd 14
conn=1000 op=0 RESULT tag=97 err=0 text=
connection_get(14): got connid=1000
connection_read(14): checking for input on id=1000
ber_get_next
ber_get_next: tag 0x30 len 85 contents:
op tag 0x63, time 1360507317
ber_get_next
conn=1000 op=1 do_search
ber_scanf fmt ({miiiib) ber:
>>> dnPrettyNormal: <ou=users,o=backlog>
<<< dnPrettyNormal: <ou=users,o=backlog>, <ou=users,o=backlog>
ber_scanf fmt ({mm}) ber:
ber_scanf fmt ({M}}) ber:
=> get_ctrls
ber_scanf fmt ({m) ber:
=> get_ctrls: oid="2.16.840.1.113730.3.4.2" (noncritical)
<= get_ctrls: n=1 rc=0 err=""
conn=1000 op=1 SRCH base="ou=users,o=backlog" scope=2 deref=3 filter="(uid=nilsi)"
=> bdb_search
bdb_dn2entry("ou=users,o=backlog")
=> bdb_dn2id("o=backlog")
<= bdb_dn2id: got id=0x8
=> bdb_dn2id("ou=users,o=backlog")
<= bdb_dn2id: got id=0xa
entry_decode: "ou=users,o=backlog"
<= entry_decode(ou=users,o=backlog)
search_candidates: base="ou=users,o=backlog" (0x0000000a) scope=2
=> bdb_equality_candidates (objectClass)
=> key_read
<= bdb_index_read: failed (-30988)
<= bdb_equality_candidates: id=0, first=0, last=0
=> bdb_dn2idl("ou=users,o=backlog")
<= bdb_dn2idl: id=3 first=9 last=11
=> bdb_equality_candidates (uid)
<= bdb_equality_candidates: (uid) not indexed
bdb_search_candidates: id=-1 first=9 last=11
entry_decode: "cn=Knut Knutsson,ou=users,o=backlog"
<= entry_decode(cn=Knut Knutsson,ou=users,o=backlog)
=> bdb_dn2id("cn=knut knutsson,ou=users,o=backlog")
<= bdb_dn2id: got id=0x9
=> send_search_entry: conn 1000 dn="cn=Knut Knutsson,ou=users,o=backlog"
conn=1000 op=1 ENTRY dn="cn=knut knutsson,ou=users,o=backlog"
ber_flush2: 226 bytes to sd 14
<= send_search_entry: conn 1000 exit.
bdb_search: 10 does not match filter
entry_decode: "cn=Mathias Nordin,ou=users,o=backlog"
<= entry_decode(cn=Mathias Nordin,ou=users,o=backlog)
=> bdb_dn2id("cn=mathias nordin,ou=users,o=backlog")
<= bdb_dn2id: got id=0xb
bdb_search: 11 does not match filter
send_ldap_result: conn=1000 op=1 p=3
send_ldap_response: msgid=2 tag=101 err=0
ber_flush2: 14 bytes to sd 14
conn=1000 op=1 SEARCH RESULT tag=101 err=0 nentries=1 text=
slap_listener_activate(8): 
>>> slap_listener(ldap:///)
conn=1001 fd=16 ACCEPT from IP=127.0.0.1:49475 (IP=0.0.0.0:389)
connection_get(16): got connid=1001
connection_read(16): checking for input on id=1001
ber_get_next
ber_get_next: tag 0x30 len 51 contents:
op tag 0x60, time 1360507317
ber_get_next
conn=1001 op=0 do_bind
ber_scanf fmt ({imt) ber:
ber_scanf fmt (m}) ber:
>>> dnPrettyNormal: <cn=Knut Knutsson,ou=users,o=backlog>
<<< dnPrettyNormal: <cn=Knut Knutsson,ou=users,o=backlog>, <cn=knut knutsson,ou=users,o=backlog>
conn=1001 op=0 BIND dn="cn=Knut Knutsson,ou=users,o=backlog" method=128
do_bind: version=3 dn="cn=Knut Knutsson,ou=users,o=backlog" method=128
bdb_dn2entry("cn=knut knutsson,ou=users,o=backlog")
conn=1001 op=0 BIND dn="cn=Knut Knutsson,ou=users,o=backlog" mech=SIMPLE ssf=0
do_bind: v3 bind: "cn=Knut Knutsson,ou=users,o=backlog" to "cn=Knut Knutsson,ou=users,o=backlog"
send_ldap_result: conn=1001 op=0 p=3
send_ldap_response: msgid=1 tag=97 err=0
ber_flush2: 14 bytes to sd 16
conn=1001 op=0 RESULT tag=97 err=0 text=
connection_get(16): got connid=1001
connection_read(16): checking for input on id=1001
ber_get_next
ber_get_next: tag 0x30 len 101 contents:
op tag 0x63, time 1360507317
ber_get_next
conn=1001 op=1 do_search
ber_scanf fmt ({miiiib) ber:
>>> dnPrettyNormal: <cn=Knut Knutsson,ou=users,o=backlog>
<<< dnPrettyNormal: <cn=Knut Knutsson,ou=users,o=backlog>, <cn=knut knutsson,ou=users,o=backlog>
ber_scanf fmt (m) ber:
ber_scanf fmt ({M}}) ber:
=> get_ctrls
ber_scanf fmt ({m) ber:
=> get_ctrls: oid="2.16.840.1.113730.3.4.2" (noncritical)
<= get_ctrls: n=1 rc=0 err=""
conn=1001 op=1 SRCH base="cn=Knut Knutsson,ou=users,o=backlog" scope=0 deref=3 filter="(objectClass=*)"
==> limits_get: conn=1001 op=1 self="cn=knut knutsson,ou=users,o=backlog" this="cn=knut knutsson,ou=users,o=backlog"
=> bdb_search
bdb_dn2entry("cn=knut knutsson,ou=users,o=backlog")
=> send_search_entry: conn 1001 dn="cn=Knut Knutsson,ou=users,o=backlog"
conn=1001 op=1 ENTRY dn="cn=knut knutsson,ou=users,o=backlog"
ber_flush2: 226 bytes to sd 16
<= send_search_entry: conn 1001 exit.
send_ldap_result: conn=1001 op=1 p=3
send_ldap_response: msgid=2 tag=101 err=0
ber_flush2: 14 bytes to sd 16
conn=1001 op=1 SEARCH RESULT tag=101 err=0 nentries=1 text=
connection_get(16): got connid=1001
connection_read(16): checking for input on id=1001
ber_get_next
ber_get_next: tag 0x30 len 34 contents:
op tag 0x42, time 1360507317
ber_get_next
ber_get_next on fd 16 failed errno=0 (Undefined error: 0)
conn=1001 op=2 do_unbind
conn=1001 op=2 UNBIND
connection_close: conn=1001 sd=16
conn=1001 fd=16 closed
connection_get(14): got connid=1000
connection_read(14): checking for input on id=1000
ber_get_next
ber_get_next: tag 0x30 len 245 contents:
op tag 0x63, time 1360507317
ber_get_next
conn=1000 op=2 do_search
ber_scanf fmt ({miiiib) ber:
>>> dnPrettyNormal: <>
<<< dnPrettyNormal: <>, <>
ber_scanf fmt ({mm}) ber:
>>> nameUIDPretty: <cn=Knut Knutsson,ou=users,o=backlog>
>>> dnPretty: <cn=Knut Knutsson,ou=users,o=backlog>
<<< dnPretty: <cn=Knut Knutsson,ou=users,o=backlog>
<<< nameUIDPretty: <cn=Knut Knutsson,ou=users,o=backlog>
>>> dnNormalize: <cn=Knut Knutsson,ou=users,o=backlog>
<<< dnNormalize: <cn=knut knutsson,ou=users,o=backlog>
ber_scanf fmt ({M}}) ber:
=> get_ctrls
ber_scanf fmt ({m) ber:
=> get_ctrls: oid="2.16.840.1.113730.3.4.2" (noncritical)
<= get_ctrls: n=1 rc=0 err=""
conn=1000 op=2 SRCH base="" scope=2 deref=3 filter="(uniqueMember=cn=knut knutsson,ou=users,o=backlog)"
conn=1000 op=2 SRCH attr=cn objectClass javaSerializedData javaClassName javaFactory javaCodeBase javaReferenceAddress javaClassNames javaRemoteLocation
send_ldap_result: conn=1000 op=2 p=3
send_ldap_response: msgid=3 tag=101 err=32
ber_flush2: 14 bytes to sd 14
conn=1000 op=2 SEARCH RESULT tag=101 err=32 nentries=0 text= 
```

我与 ldap 的连接如下所示：

```
<security:http auto-config="true" use-expressions="true">

    <security:intercept-url pattern="/auth/login"
        access="permitAll" />

    <security:form-login login-page="/auth/login"
        authentication-failure-url="/auth/login?error=true" />

    <security:logout invalidate-session="true"
        logout-success-url="/auth/login" logout-url="/auth/logout" />

</security:http>

<security:ldap-server url="${ldap.url}"
    manager-dn="${ldap.managerdn}" manager-password="${ldap.managerpassword}" /> 
```

和属性文件：

```
# Ldap server settings:
ldap.url=ldap://localhost:389
ldap.managerdn=ou=users,o=backlog
ldap.managerpassword=1234
ldap.user-search-filter=(uid={0})
ldap.user-search-base=ou=users,o=backlog 
```

slapd.conf 中的 DBD 定义：

```
#######################################################################
# BDB database definitions
#######################################################################

database    bdb
suffix      "o=backlog" 
rootdn      "ou=users,o=backlog"
# Cleartext passwords, especially for the rootdn, should
# be avoid.  See slappasswd(8) and slapd.conf(5) for details.
# Use of strong authentication encouraged.
rootpw      {MD5}gdyb21LQTcIANtvYMT7QVQ==
# The database directory MUST exist prior to running slapd AND 
# should only be accessible by the slapd and slap tools.
# Mode 700 recommended.
directory   /private/var/db/openldap/backlog
# Indices to maintain
index   objectClass eq 
```

但是，当我尝试使用我的 ldap 目录中不存在的帐户登录时，Spring 会以干净的日志和无效的用户名/密码响应进行响应。

此外，如果 ldap 返回以前没有使用过应用程序的用户，应用程序将自动映射具有权限的用户。所以换句话说，如果 ldap 只是返回一个 id/用户名，那么它应该可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T08:47:29.720

我刚刚面临这个问题。在可能的情况下，错误与身份验证管理器有关。我们的配置（对我们有用）是：

```
<security:authentication-manager>
            <security:ldap-authentication-provider
                    user-search-filter="(uid={0})"
                    group-search-filter="(uniqueMember={0})"
                    group-role-attribute="cn"
                    role-prefix="ROLE_">
            </security:ldap-authentication-provider>
    </security:authentication-manager>

      <security:ldap-server url="ldap://172.31.7.20:389/dc=gt,dc=local"/> 
```

在我们的例子中，我们不需要 ldap 服务器的 manager-dn 配置，因为我们只使用身份验证和授权，但我们不修改来自 LDAP 的条目。

我们使用 OpenLDAP 作为 LDAP 服务器，架构为 rfc2307bis

# r - 获取 R 中 SVD 的列名

> ID：14798958
> 
> 赞同：1
> 
> 时间：2013-02-10T14:52:38.507
> 
> 标签：r, plot, svd

我在 R 中对一个名为 data 的数据框进行 SVD

```
svd1 <- svd(scale(data)) 
```

我使用绘制结果

```
plot(svd1$d^2/sum(svd1$d^2),xlab="Column",ylab="Percent of variance explained",pch=19) 
```

我发现在图中，列号与数据框中的列号不对应（无论我使用 SVD 的列子集，第一列总是显示最高方差）。

我的问题是，如何在图中获取列名（或“真实”索引）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T19:59:05.540

根据 R 文档（.../library/base/html/svd.html）：

```
d is a vector containing the singular values of x, of length min(n, p). 
```

这些奇异值是通过 SVD 算法从整个输入矩阵中计算出来的，因此无法根据列名来标记奇异值。

# c# - 直接访问基类变量/对象c#

> ID：14798961
> 
> 赞同：3
> 
> 时间：2013-02-10T14:52:39.647
> 
> 标签：c#

```
public class myWorld
{
    public int data;
    public void ChangeData()
    {
        data = 10;
    }
}

public class myRobot : myWorld
{
    public void robotChangesData()
    {
        //how can i make the robot change the data in world?
    }
} 
```

我理解（或多或少）不应该这样做，并且已经被问了一千次，因为每一次改变都应该通过方法 - 但是：

如果我们继续以世界和机器人为例，稍后我想为机器人提供一种方法，例如：`robot.MoveBox(25)` 机器人必须能够访问世界、对象框并更新绘图对象（网格、形状等） .) 我现在唯一能想到的就是通过机器人的每一种方法（比如`movebox`，或`robotChangesData`）整个世界 + 盒子 + 绘图东西作为“参考”，然后他可以改变它.. 但是每个方法看起来像`robot.MoveBox(25, ref myworldObject, ref myworldBoxes,ref etc etc)`

这真的是正确的方法吗？还是我错过了一些重要的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T15:01:15.617

也许一个例子有帮助：

你的机器人基类

```
public class RobotBase
{
    protected int data;

    // Reference to the world
    protected World _world;

    public RobotBase(World world)
    {
        _world = world;
    }

    public void ChangeData()
    {
        data = 10;
    }
} 
```

你的机器人类：

```
public class Robot : RobotBase
{
    public Robot(World world) : base(world)
    {}

    public void RobotChangesData()
    {
        //Change data in base
        data = 20;

        // Change data in world, the object is passed by reference, no need for further "ref" declarations
        _world.Terminate();
    }
} 
```

你的世界级：

```
public class World
{
    public void Terminate() 
    {
       // terminate world! noooess!
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:55:37.080

您不要将其作为参考传递。

为您的模型创建一个类/对象表示，并将其作为参数传递给您的机器人。

暴露的方法应该对应于他可以改变的变量。

不要对每个世界/模型状态变量使用 refs 和 outs。

# c - 分配和释放指向指针的指针

> ID：14798970
> 
> 赞同：0
> 
> 时间：2013-02-10T14:53:50.270
> 
> 标签：c, pointers

我正在尝试将指向指针（char**）的指针传递给将初始化它的函数，然后将其传递给另一个将释放内存的函数，但是我在释放时遇到了段错误，这导致我相信我的分配出了问题。

Valgrind 报告在这条线上使用了未初始化的值。tmp[i] 指向 0x0。

```
if(tmp[i]) free((char*)tmp[i]); 
```

这是代码（这只是测试代码）

```
void 
alloc_strings(char ***test, int count) 
{
  char **tmp = *test;
  tmp = malloc(count * sizeof(char*));

  int i;
  for(i = 0; i < count; i++) {
    tmp[i] = malloc(6);
    strcpy(tmp[i],"Hello");
  }
}

void
free_strings(char ***test, int count)
{
  char **tmp = *test;

  int i;
  for(i = 0; i < count; i++) {
    if(tmp[i]) free((char*)tmp[i]);
  }

  if(tmp)
    free(tmp);
} 
```

和调用：

```
int
main(int argc, char **argv)
{

  char **test;
  alloc_strings(&test, 10);
  free_strings(&test, 10);

  return 0;
} 
```

我已经玩了一段时间了，阅读了指针等，但是我无法解决这个问题。任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:55:28.693

您需要分配给`*test`，而不是从中分配。怎么样：

```
void 
alloc_strings(char ***test, int count) 
{
    char **tmp = malloc(count * sizeof *tmp);
    /*...*/
    *test = tmp;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T14:59:07.867

在代码示例中，

```
alloc_strings(char ***test, int count) 
{
    char **tmp = *test; 
```

`*test`应该有一些空间来存储`char **`当前未分配的指针。因此，如果示例是这样的

```
char** array[1];

alloc_strings(&array[0], 7); 
```

我觉得代码会起作用。

# c++ - 初学者 C++：奇怪的行为

> ID：14798976
> 
> 赞同：2
> 
> 时间：2013-02-10T14:54:04.590
> 
> 标签：c++

感谢您花时间阅读这个问题！

该程序是在十亿之后找到最小的素数。在 int main() 的末尾，我包含了一个控制台输入`cin>>x;`，目的是防止命令提示符关闭得太快，以便我可以看到结果。但是，我意识到我必须先输入一些内容，然后才能显示我想要的结果。

所以问题是：即使控制台输出语句 `cout<<i;`在输入语句之前，为什么会这样`cin>>x;`？

```
#include <iostream>
#include <math.h>
using namespace std;

int is_prime(int x);

int main()
{
    for (int i=100000000;;i++){ 
        if(is_prime(i)){ 
                cout<<i;
                break;}
    int x;
    cin>>x;

       }

}

int is_prime(int x)
{
    double maxvalue = sqrt(static_cast<double>(x));
    for ( int i=2;i<=maxvalue;i++){
        if (x%i == 0 ) return false; }
        return true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T15:00:39.480

似乎 cin >> x 在 for 循环内。因此，循环的每次迭代，您都会尝试从流中读取一些内容。因此，您需要在 i 变为素数之前输入一些数字。

编辑：显然，1000003 是素数，所以你不必输入很多数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-10T14:56:48.103

> 即使控制台输出语句`cout<<i;`在输入语句之前，为什么会这样`cin>>x;`？

因为更改了执行顺序，所以一旦找到素数`break`就让控件跳过。`cin >> x`您需要移出`cin >> x`循环。

你可以做几件事来优化事情：而不是试图除以每个数字`1`，`sqrt(N)`你应该只除掉你到目前为止找到的素数。这将大大加快速度。您也可以`sqrt`通过使用`i*i < x`作为退出条件来放弃调用。

# c - 头文件中声明的函数在主文件中不可访问

> ID：14798983
> 
> 赞同：0
> 
> 时间：2013-02-10T14:55:01.890
> 
> 标签：c, arduino, undefined-reference

我有一个文件结构如下：

```
interface.h --> interface.c
      |
      |
effects.h --> effects.c
      |
      |
    main 
```

然而，在 effects.h 中声明的函数在 main 中是不可访问的。

代码片段：

主要的 ：

```
#include "interface.h"
#include "effects.h"
void setup()  //Initialize all variables here
{

....
turnoff();
}; 
```

效果.h：

```
#ifndef EFFECTS
#define EFFECTS
void turnoff();
#endif 
```

效果.c：

```
#include "interface.h"
#include "effects.h"
void turnoff()
{
....
}; 
```

接口.h：

```
#ifndef INTERFACE
#define INTERFACE
....
#endif 
```

错误信息 ：`In function ``loop':undefined reference to ``turnoff()'`

错误消息没有意义，因为循环函数为空！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:03:55.240

您需要将所有 3 个 .c 文件编译并链接在一起。就`gcc`这么简单

`gcc main.c interface.c effects.c -o executable_name`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T19:08:33.280

我认为 IDE 需要 *.cpp 文件而不是 *.c 文件。

无论如何，您应该更改 file->preferences 下的设置以获得详细的编译器输出。通常这会给出一些提示。至少它向您显示了包含***实际***编译的文件的临时目录。这反过来又允许对问题进行更精确的分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T16:07:45.927

what are the flags you are using? maybe you need to declare your functions as extern explicitly?

```
extern void turnoff(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T15:25:23.100

从最新的回复来看，我觉得这`effects.c`不是汇编的一部分。我不了解开发环境，但从现有数据来看，这是我的观察。

# c++ - 继承对象上指针算术的安全性

> ID：14798984
> 
> 赞同：0
> 
> 时间：2013-02-10T14:55:05.537
> 
> 标签：c++, memory, standards

如果我们有以下代码：

```
struct Base
{
    int x;
    int y;
    void foo();
    virtual unsigned getCrc() = 0;
};

struct Derived1 : public Base
{
    int a;
    int b;
    unsigned getCrc();
};

struct Derived2 : public Base
{
    float a;
    float b;
    unsigned getCrc();
}; 
```

它是 C++ 标准，`a`并且`b`应该在内存之后`x`和`y`内存中吗？或者它是最常用的布置继承对象的方法？（即编译器事实上的标准）。

换句话说，我能保证：

```
Derived1 obj;

    int* unsafe_internal_a = (int*)((unsigned)(&obj) + sizeof(Base)); 
```

**编辑**：我的问题是'内存布局是否包含在某些标准中？或者它依赖于编译器？该代码仅用于说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T15:37:08.990

您的问题的答案是：它们在某些情况下依赖于编译器，而不是在其他情况下。 [内的详细信息](https://stackoverflow.com/questions/1632600/memory-layout-c-objects)

如果您需要从类中提取数据，并将其压缩为最小格式，我建议为它们实现一组[序列化/反序列化方法](http://en.wikipedia.org/wiki/Serialization)。如果您只是想弄清楚 c++ 做了什么，那么链接的问题应该会有很大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T15:02:45.987

这样会更安全

```
size_t off = offsetof( Derived1, a );
Derived1 obj;

unsigned* unsafe_internal_a = (unsigned*)((char *)(&obj) + off); 
```

# c# - 托管服务器编译 .aspx 但不编译 .cshtml

> ID：14798994
> 
> 赞同：1
> 
> 时间：2013-02-10T14:56:09.553
> 
> 标签：c#, asp.net-mvc, web-applications, web-hosting, web-deployment

一个星期以来，我一直在互联网上寻找一个好的答案，但找不到任何答案。我将提供我所拥有的所有信息，我认为这可能有助于你们解决这个令人沮丧的问题，最后我会告诉你们问题本身以及我所做的测试及其结果。

我正在使用 ASP.NET MVC 3 (C#)，这是我一步一步做的：

1.  我已将 .dll 和 .xml 文件添加到我的项目中，并根据许多在线网站和教程将 Copy Local 更改为 True。
2.  我已经构建了我的项目并在我自己的计算机上本地发布了它（通过使用文件系统发布方法）。
3.  然后我通过 FileZilla 软件将部署的网站实现到我的托管服务器中。

这是在我的网站中部署后的 Bin 文件夹：

*   实体框架.dll
*   Microsoft.Web.Infrastructure.dll
*   PagedList.dll
*   System.Web.Abstraction.dll
*   System.Web.Helpers.dll
*   System.Web.Mvc.dll
*   System.Web.Providers.dll
*   System.Web.Razor.dll
*   System.Web.Routing.dll
*   System.Web.WebPages.Deployment.dll
*   System.Web.WebPages.dll
*   System.Web.WebPages.Razor.dll

这是我的 packages.config 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="EntityFramework" version="5.0.0" targetFramework="net45" />
  <package id="jQuery" version="1.7.1.1" targetFramework="net45" />
  <package id="jQuery.UI.Combined" version="1.8.20.1" targetFramework="net45" />
  <package id="jQuery.Validation" version="1.9.0.1" targetFramework="net45" />
  <package id="Microsoft.AspNet.Mvc" version="3.0.20105.1" targetFramework="net45" />
  <package id="Microsoft.AspNet.Providers.Core" version="1.1" targetFramework="net45" />
  <package id="Microsoft.AspNet.Providers.LocalDB" version="1.1" targetFramework="net45" />
  <package id="Microsoft.AspNet.Razor" version="1.0.20105.408" targetFramework="net45" />
  <package id="Microsoft.AspNet.WebPages" version="1.0.20105.408" targetFramework="net45" />
  <package id="Microsoft.Web.Infrastructure" version="1.0.0.0" targetFramework="net45" />
  <package id="Modernizr" version="2.5.3" targetFramework="net45" />
  <package id="PagedList" version="1.15.0.0" targetFramework="net45" />
</packages> 
```

我的托管服务器支持 MVC 和 ASP.NET 4.0，服务器是 IIS7.0（集成管道）。但是，他们支持的最新 ASP.NET 框架是 4.0。在我的项目属性中，它显示目标框架是 4.5，但是当我部署网站时，在其属性中显示目标框架是 4.0。

# 问题

当我在互联网上打开我的网站时，它设法在目录中找到 Index.cshtml 文件，但是只能编译纯 html 和 css，服务器由于某些未知原因无法编译 C# 代码我。这就是为什么我的所有链接都是空引用和空引用，因为这`<a href="@Url.Action("Learn", "Home")">`是我用于链接页面的链接。

但无论如何，当我使用一个使用 Visual Basic 语言的简单 .aspx 文件（我不太熟悉）时，它能够完美地编译该文件而没有任何问题。

可能是什么问题？我已经与我的托管服务提供商客户服务 (godaddy.com) 进行了长时间的讨论，即使他们将我的案子交给了他们的“最先进的技术人员”，但他们仍然找不到问题。

这个问题可能来自我的 bin 文件夹中缺少的库吗？

我也不得不说，当我在我自己的计算机 localhost 服务器上的 IIS 7.0 Express 下运行我的网站时，它可以完美运行。

谢谢和问候，阿明