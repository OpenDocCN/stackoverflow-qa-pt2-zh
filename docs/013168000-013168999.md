# StackOverflow 问答 13168000-13168999

# ios - 从图像创建视频并保存到相册

> ID：13168001
> 
> 赞同：0
> 
> 时间：2012-10-31T21:54:12.070
> 
> 标签：ios, image, audio, video, save

我正在用一组图像和一个音频文件制作视频

但我似乎无法将其保存到相机胶卷

有时它会保存，但有时它不会并给我一个奇怪的错误

outputFile.mp4 无法保存到已保存的相册中：Error Domain=NSOSStatusErrorDomain Code=-12848 "电影无法播放。" UserInfo=0x7bd7370 {NSLocalizedDescription=电影无法播放。}

此函数从图像数组创建视频：

```
-(void) writeImagesToMovieAtPath:(NSString *) path withSize:(CGSize) size
{
    NSLog(@"Write Started");

    NSError *error = nil;

    AVAssetWriter *videoWriter = [[AVAssetWriter alloc] initWithURL:
                                  [NSURL fileURLWithPath:path] fileType:AVFileTypeMPEG4
                                                              error:&error];
    NSParameterAssert(videoWriter);

    NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                   AVVideoCodecH264, AVVideoCodecKey,
                                   [NSNumber numberWithInt:size.width], AVVideoWidthKey,
                                   [NSNumber numberWithInt:size.height], AVVideoHeightKey,
                                   nil];

    AVAssetWriterInput* videoWriterInput = [[AVAssetWriterInput
                                             assetWriterInputWithMediaType:AVMediaTypeVideo
                                             outputSettings:videoSettings] retain];

    AVAssetWriterInputPixelBufferAdaptor *adaptor = [AVAssetWriterInputPixelBufferAdaptor
                                                     assetWriterInputPixelBufferAdaptorWithAssetWriterInput:videoWriterInput
                                                     sourcePixelBufferAttributes:nil];

    NSParameterAssert(videoWriterInput);
    NSParameterAssert([videoWriter canAddInput:videoWriterInput]);
    videoWriterInput.expectsMediaDataInRealTime = YES;
    [videoWriter addInput:videoWriterInput];

    //Start a session:
    [videoWriter startWriting];
    [videoWriter startSessionAtSourceTime:kCMTimeZero];

    CVPixelBufferRef buffer = NULL;

    //convert uiimage to CGImage.

    int frameCount = 16;
    int kRecordingFPS = 30;
    UIImage * im = [UIImage imageNamed:@"IMG_0103.JPG"];

    NSArray * imageArray = [[NSArray alloc]initWithObjects:im,im,im,im,im,im,im,im,im,im,im,im,im,im,im,im, nil];

    for(UIImage * img in imageArray)
    {
        buffer = [self pixelBufferFromCGImage:[img CGImage] andSize:size];

        BOOL append_ok = NO;
        int j = 0;
        while (!append_ok && j < 30)
        {
            if (adaptor.assetWriterInput.readyForMoreMediaData)
            {
                printf("appending %d attemp %d\n", frameCount, j);

                CMTime frameTime = CMTimeMake(frameCount,(int32_t) kRecordingFPS);
                append_ok = [adaptor appendPixelBuffer:buffer withPresentationTime:frameTime];

                if(buffer)
                    CVBufferRelease(buffer);
                [NSThread sleepForTimeInterval:0.05];
            }
            else
            {
                printf("adaptor not ready %d, %d\n", frameCount, j);
                [NSThread sleepForTimeInterval:0.1];
            }
            j++;
        }
        if (!append_ok) {
            printf("error appending image %d times %d\n", frameCount, j);
        }
        frameCount++;
    }

    //Finish the session:
    [videoWriterInput markAsFinished];
    [videoWriter finishWriting];
    NSLog(@"Write Ended");
    [videoWriterInput release];
    [videoWriter release];
    [imageArray release];
} 
```

此函数添加音频：

```
 -(void)CompileFilesToMakeMovie{
        AVMutableComposition* mixComposition = [AVMutableComposition composition];

        NSString *documentsDirectoryPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];

        NSString* audio_inputFileName = @"Rihanna-Take a Bow.mp3";

        NSString* audio_inputFilePath = [NSString stringWithFormat:@"%@/%@",documentsDirectoryPath,audio_inputFileName];

        NSURL*    audio_inputFileUrl = [NSURL fileURLWithPath:audio_inputFilePath];

        NSString* video_inputFileName = @"a.mp4";
        NSString* video_inputFilePath = [NSString stringWithFormat:@"%@/%@",documentsDirectoryPath,video_inputFileName];
        NSURL*    video_inputFileUrl = [NSURL fileURLWithPath:video_inputFilePath];

        NSString* outputFileName = @"outputFile.mp4";
        NSString* outputFilePath = [NSString stringWithFormat:@"%@/%@",documentsDirectoryPath,outputFileName];

        NSURL*    outputFileUrl = [NSURL fileURLWithPath:outputFilePath];

        if ([[NSFileManager defaultManager] fileExistsAtPath:outputFilePath])
            [[NSFileManager defaultManager] removeItemAtPath:outputFilePath error:nil];

        CMTime nextClipStartTime = kCMTimeZero;

        AVURLAsset* videoAsset = [[AVURLAsset alloc]initWithURL:video_inputFileUrl options:nil];
        CMTimeRange video_timeRange = CMTimeRangeMake(kCMTimeZero,videoAsset.duration);

        AVMutableCompositionTrack *a_compositionVideoTrack = [mixComposition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid];
        [a_compositionVideoTrack insertTimeRange:video_timeRange ofTrack:[[videoAsset tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0] atTime:nextClipStartTime error:nil];

        //nextClipStartTime = CMTimeAdd(nextClipStartTime, a_timeRange.duration);

        AVURLAsset* audioAsset = [[AVURLAsset alloc]initWithURL:audio_inputFileUrl options:nil];
        CMTimeRange audio_timeRange = CMTimeRangeMake(kCMTimeZero, videoAsset.duration);
        AVMutableCompositionTrack *b_compositionAudioTrack = [mixComposition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
        [b_compositionAudioTrack insertTimeRange:audio_timeRange ofTrack:[[audioAsset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0] atTime:nextClipStartTime error:nil];

        AVAssetExportSession* _assetExport = [[AVAssetExportSession alloc] initWithAsset:mixComposition presetName:AVAssetExportPresetMediumQuality];
        _assetExport.outputFileType = AVFileTypeMPEG4;
        _assetExport.outputURL = outputFileUrl;
        [_assetExport setTimeRange:CMTimeRangeMake(kCMTimeZero, videoAsset.duration)];
        [_assetExport exportAsynchronouslyWithCompletionHandler:nil];

        [audioAsset release];
        [videoAsset release];

        [_assetExport release];
    } 
```

该函数调用：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    NSString *documentsDirectoryPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];

    UIImage * i = [UIImage imageNamed:@"IMG_0103.JPG"];

    [self writeImagesToMovieAtPath:[NSString stringWithFormat:@"%@/%@",documentsDirectoryPath,@"a.mp4"] withSize:CGSizeMake(i.size.width, i.size.height)];

    NSString* exportVideoPath1 = [NSString stringWithFormat:@"%@/%@",documentsDirectoryPath,@"a.mp4"];

    NSString* exportVideoPath = [NSString stringWithFormat:@"%@/%@",documentsDirectoryPath,@"outputFile.mp4"];

    UISaveVideoAtPathToSavedPhotosAlbum (exportVideoPath,self, @selector(video:didFinishSavingWithError: contextInfo:), nil);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T03:45:25.383

就我而言，原因是 AVAssetWriter 还没有写完。使用以下代码解决了它：

```
__block BOOL _finished = NO;

[assetWriter finishWritingWithCompletionHandler:^{
    _finished = YES;
}];

while (!_finished) {
    [NSThread sleepForTimeInterval:0.1];
} 
```

# ruby - Ruby 定义方法

> ID：13168009
> 
> 赞同：1
> 
> 时间：2012-10-31T21:54:48.077
> 
> 标签：ruby, metaprogramming

我有以下必须通过的测试：

```
def test_can_find_by_arbitrary_fields
  assert @library.respond_to? :find_by_artist
  assert !@library.respond_to?(:find_by_bitrate)
  @library.add_song({ :artist => 'Green Day',
                     :name => 'American Idiot',
                     :bitrate => 192 })
  assert @library.respond_to?(:find_by_bitrate)
end 
```

而且我不确定我该怎么做。

我试着做：

```
def respond_to?(method)
     if self.public_methods.include? method
         true
     elsif (method == :find_by_bitrate)
         define_method :find_by_bitrate, ->(default = nrb)  { @songs.select |a| a[:bitrate] == nrb }       
         false
     else
         false
end 
```

但它说“define_method 未定义”。有什么方法可以定义`find_by_bitrate`方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:36:49.663

您可以在第一次调用方法时定义方法`method_missing`。

您是否*应该*进行一些辩论，但它比`respond_to?`.

```
class Foo
  def method_missing(sym)
    puts "Method missing; defining."
    self.class.send(:define_method, sym) do
      puts "Called #{sym}."
    end
  end
end 
```

完整性检查：

```
f = Foo.new
=> #<Foo:0x007fa6aa09d3c0>
f.wat
=> Method wat missing; defining.
f.wat
=> Called wat.
f2 = Foo.new
=> Called wat. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:06:10.867

我不认为你应该重新定义`respond_to?`方法。测试的重点是（可能）该`@library`对象应该`find_by_artist`定义一个方法，并且`find_by_bitrate`在添加具有比特率的歌曲之前没有。即当它看到一首具有比特率（？）的歌曲时，该`add_song`方法应该定义方法。`find_by_bitrate`

此外，`define_method`是一个私有方法`Class`。上面，您试图从实例方法中调用它。请参阅“ [Ruby：define_method vs. def](https://stackoverflow.com/questions/185947/ruby-define-method-vs-def) ”，还有更多关于这些内容的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T23:25:00.053

缺少很多信息来正确回答这个问题。测试意味着`find_by_artist`即使`@library`是空的也总是定义的，但是只有当库包含具有这种方法的记录时，其他属性（例如：比特率）上才有可用的动态方法。

`respond_to?`在任何情况下都不应该重新定义。有一个明确的钩子方法来回答respond_to？对于动态方法：[`Object#respond_to_missing?`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-respond_to_missing-3F).

因此，让您的测试通过的一种简单方法是确保 @library 对象有一个具体的方法`#find_by_artist`和一个响应钩子来检查它的任何元素是否具有请求的属性。如果我假设@library 是一个集合对象`Library`，它会在其中保留歌曲的枚举`@songs`

```
class Library
  def find_by_artist artist
    @songs.select { |song| song['artist'] == artist }
  end

  def method_missing meth, arg
    m = /^find_by_(.+)$/.match meth.to_s
    return super unless attr = m && m[1]

    @songs.select { |song| song[attr] ==  arg }
  end

  def respond_to_missing? meth, include_private
    m = /^find_by_(.+)$/.match meth.to_s
    return super unless attr = m && m[1]

    @songs.any? { |song| song.has_key? attr }
  end
end 
```

这在 response_to 中有性能问题吗？现在会搜索所有歌曲。可以通过保留一组包含在@songs 中的所有属性并在添加/更新/删除集合中元素的方法中对其进行更新来进行优化。

# .net - 扩展方法必须在非泛型静态类中定义 - 扩展 System.Delegate？

> ID：13168011
> 
> 赞同：0
> 
> 时间：2012-10-31T21:54:49.863
> 
> 标签：.net, c#-4.0, c#-3.0, extension-methods

这是参考页面[http://msdn.microsoft.com/en-us/library/orm-9780596516109-03-09.aspx中的代码示例](http://msdn.microsoft.com/en-us/library/orm-9780596516109-03-09.aspx)

C# 编译器期望该`EveryOther()`方法在它自己的静态类中定义。

我是否需要`System.Delegate`使用新方法进行扩展`EveryOther()`？

```
namespace DelegateTest
{    
    public class TestInvokeIntReturn
    {
        public static int Method1()
        {
            Console.WriteLine("Invoked Method1");
            return 1;
        }

        public static int Method2()
        {
            Console.WriteLine("Invoked Method2");
            return 2;
        }

        public static int Method3()
        {
            //throw (new Exception("Method1"));
            //throw (new SecurityException("Method3"));
            Console.WriteLine("Invoked Method3");
            return 3;
        }
    }

    class Program
    {       
        static void Main(string[] args)
        {
            Func<int> myDelegateInstance1 = TestInvokeIntReturn.Method1;
            Func<int> myDelegateInstance2 = TestInvokeIntReturn.Method2;
            Func<int> myDelegateInstance3 = TestInvokeIntReturn.Method3;

            Func<int> allInstances = //myDelegateInstance1;
                    myDelegateInstance1 +
                    myDelegateInstance2 +
                    myDelegateInstance3;

            Delegate[] delegateList = allInstances.GetInvocationList();
            Console.WriteLine("Invoke every other delegate");
            foreach (Func<int> instance in delegateList.EveryOther())
            {
                // invoke the delegate
                int retVal = instance();
                Console.WriteLine("Delegate returned " + retVal);
            }
        }

        static IEnumerable<T> EveryOther<T>(this IEnumerable<T> enumerable)
        {
            bool retNext = true;
            foreach (T t in enumerable)
            {
                if (retNext) yield return t;
                retNext = !retNext;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:59:57.763

要`EveryOther`用作扩展方法，您必须将其放在静态类中：

```
public static class MyExtensions
{
    public static IEnumerable<T> EveryOther<T>(this IEnumerable<T> enumerable)
    {
        bool retNext = true;
        foreach (T t in enumerable)
        {
            if (retNext) yield return t;
            retNext = !retNext;
        }
    }
} 
```

如果您不想将其用作扩展方法，则可以将签名更改`EveryOther`为

```
static IEnumerable<T> EveryOther<T>(IEnumerable<T> enumerable) 
```

然后只需调用`EveryOther(delegateList)`而不是`delegateList.EveryOther()`.

# node.js - 猫鼬连接connectTimeoutMS

> ID：13168013
> 
> 赞同：2
> 
> 时间：2012-10-31T21:54:54.723
> 
> 标签：node.js, mongodb, mongoose

我似乎无法让我的 mongo 连接比默认连接更快地超时。

```
var databaseUrl = 'mongodb://localhost/doesnotexist';
var options = { server: { connectTimeoutMS: 10000 } };

var db = mongoose.connect(databaseUrl, options, function (err) {
    ...
} 
```

我正在尝试模拟数据库脱机以测试到消息队列的故障转移，但似乎无法使其正常工作。

对此的任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:17:39.457

connectTimeoutMS 是一个套接字选项，指定如下：

```
var databaseUrl = 'mongodb://localhost/doesnotexist';
var options = { server: { socketOptions: { connectTimeoutMS: 10000 }}};

var db = mongoose.connect(databaseUrl, options, function (err) {

}) 
```

# jquery - jquery on click 在点击时激活另一个，但在标记中最近的一个

> ID：13168019
> 
> 赞同：0
> 
> 时间：2012-10-31T21:55:24.817
> 
> 标签：jquery

这是烤我的面条，任何专业的想法/建议都会非常感谢。

我在下面有我的标记...

```
<a href="#" class="launch-fancybox">Preview Image Gallery</a>

<!-- lots of mark up in between -->

<a href="enlarge-1.jpg" class="fancybox"><img src="thumb-1.jpg" alt=""/></a>

<a href="enlarge-2.jpg" class="fancybox"><img src="thumb-2.jpg" alt=""/></a>

<a href="enlarge-3.jpg" class="fancybox"><img src="thumb-3.jpg" alt=""/></a>

<a href="enlarge-4.jpg" class="fancybox"><img src="thumb-4.jpg" alt=""/></a> 
```

然后我的fancybox jquery ...

```
$('.fancybox').on('click', function () {

    var data = $(this).attr('data-rel');

    $('.fancybox[data-rel="' + data + '"]').attr('rel','fancybox-thumb').fancybox({

        prevEffect  : 'none',
        nextEffect  : 'none',
        helpers : {
            title   :  null,
            overlay : {
                opacity : 0.8,
                css : {
                    'background-color' : '#000'
                }
            },
            thumbs  : {
                width   : 50,
                height  : 50
            }
        },
        closeClick: true

    });

}); 
```

现在我的问题是，如何获得与“launch-fancybox”类的链接以找到与“fancybox”类的第一个/最近的链接并运行上面的脚本。

基本上我想模拟点击第一个缩略图。而是点击“launch-fancybox”链接。

关于我如何做到这一点的任何想法或指示都会很棒。

谢谢

==================================================== ====

我什至尝试将我的 jquery 放入一个函数中......

```
fancybox = function () {

    var data = $(this).attr('data-rel');

    $('.fancybox[data-rel="' + data + '"]').attr('rel','fancybox-thumb').fancybox({

        prevEffect  : 'none',
        nextEffect  : 'none',
        helpers : {
            title   :  null,
            overlay : {
                opacity : 0.8,
                css : {
                    'background-color' : '#000'
                }
            },
            thumbs  : {
                width   : 50,
                height  : 50
            }
        },
        closeClick: true

    });

};

$('.fancybox').on('click', fancybox);

$('.launch-fancybox').on('click', function (e){

    e.preventDefault();

    $(this).closest('.fancybox').click();

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:58:59.477

jQuery 的[`closest`](http://api.jquery.com/closest/)方法应该做你想做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:59:09.010

```
$('.launch-fancybox').click(function(e){
    e.preventDefault();
    $(this).next('.fancybox').click();
}); 
```

# amazon-ec2 - 是否可以有一个带有远程桌面 GUI 的 Windows 实例

> ID：13168026
> 
> 赞同：0
> 
> 时间：2012-10-31T21:55:42.387
> 
> 标签：amazon-ec2

我对亚马逊的 linux 实例有一些经验。但是，我需要一台 Windows 机器，并且我需要使用 GUI（类似于远程桌面等）来管理它。如果可能的话，任何人都可以回答我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:14:33.437

是的，这绝对是可能的，我一直在使用它。只需配置一个 windows 实例，然后在它运行后，在 EC2 管理界面中右键单击它并选择“获取管理员密码”。

您需要在启动时指定一个私钥，并使用它来获取解密的密码。

然后，您可以使用任何远程桌面客户端使用此密码和公共 DNS 名称访问计算机。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-31T22:04:14.313

Windows 有远程桌面，它允许你通过 GUI 驱动，或者安装 VNC 并通过那里连接。

# alias - “无符号”类型转换要求在顺序过程敏感度列表中输入

> ID：13168034
> 
> 赞同：1
> 
> 时间：2012-10-31T21:56:28.247
> 
> 标签：alias, vhdl, unsigned

我在 VHDL 顺序过程中有一个地址计数器。它的空闲值在配置寄存器中设置为某个最大值；之后，只要它进入某个状态，它就应该加一。

为了获得最大值，我将输入 std_logic_vector 的子集声明为别名。

我将 address_int 声明为无符号变量。然后，我在敏感度列表中定义了一个带有 clk 和 reset 的顺序过程。当复位有效时，地址计数器设置为别名值。释放复位后，计数器在处于特定状态时在上升沿翻转/递增。

综合工具给了我这个消息：*WARNING:Xst:819 line 134：过程敏感性列表中缺少以下信号：DL_CADU_SIZE*

而且所有的地址线都变成了异步信号！这里发生了什么？整数不会出现无符号的一些奇怪行为吗？我通常在这里使用整数，但是出于代码维护的目的，从无符号转换似乎更直接。我曾尝试放弃别名并进行直接转换，但没有帮助。

```
library IEEE;            
use ieee.std_logic_1164.a
use ieee.numeric_std.all;
-- entity declaration, ports, architecture, etc.

signal address_int : unsigned(8 downto 0);                                     
alias  aMaxWords   : std_logic_vector(8 downto 0) is DL_CADU_SIZE(10 downto 2);

begin
  WADDR           <= std_logic_vector(address_int);

  OUT_PROC: process (CLK_CORE, RST_N_CORE)
    begin
      if RST_N_CORE = '0' then
        address_int <= unsigned(aMaxWords);
      elsif rising_edge(CLK_CORE) then

        if next_state = WRITE_WORD then
          if address_int = unsigned(aMaxWords) then
            address_int <= (others => '0');
          else
            address_int <= address_int + 1;
          end if;
        end if; -- WRITE_WORD
      end if; -- rising_edge
    end process OUT_PROC;
end RTL; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T15:20:05.623

这：

```
if RST_N_CORE = '0' then
    address_int <= unsigned(aMaxWords) 
```

描述了一个异步复位——因此`aMaxWords`无论是否同步，合成器都将其视为异步。

合成器将您的代码解释为“当 rst_n_core 为低时，将 aMaxWords 的值复制到 address_int”，因此如果 aMaxWords 在重置期间发生更改，则必须复制该值。您的灵敏度列表中缺少该信号意味着合成器正在制作的电路与语言所说的行为不同，因此会发出警告。

* * *

它真的不应该这样做：没有灵敏度列表中的信号，它应该在复位线的下降沿捕获信号。但由于大多数芯片不是这样工作的，合成器设计者（以他们无限的智慧）多年前决定假设设计者*打算*将该信号放在灵敏度列表中，并发出警告，而不是说“这行不通， 修理它”。因此，您将获得在模拟和综合中工作方式不同的代码。结束吐槽。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-02T05:52:30.117

您的重置代码：

```
if RST_N_CORE = '0' then
    address_int <= unsigned(aMaxWords); 
```

是错的。复位的定义是将您的电路设置为已知状态。但是您的代码将其分配给信号。您应该将其分配为 all`0`或 all`1`以进行重置，或者您`aMaxWords`必须是**常量**（请注意，您的合成器可能没有足够的智能来知道它，然后应该将其分配为常量）：

```
if RST_N_CORE = '0' then
    address_int <= (others => '0'); 
```

或者

```
if RST_N_CORE = '0' then
    address_int <= (others => '1'); 
```

# yaml-cpp - 使用 YAML-cpp，如何识别未知密钥？

> ID：13168043
> 
> 赞同：1
> 
> 时间：2012-10-31T21:57:15.937
> 
> 标签：yaml-cpp

该用例正在逐步执行用 YAML 编写的配置文件。我需要检查每个键并相应地解析其值。我喜欢使用诸如 之类的随机访问方法的想法`doc["key"] >> value`，但我真正需要做的是警告用户在配置文件中存在无法识别的键，例如，以防他们拼错了键。如果不遍历文件，我不知道该怎么做。

我知道我可以这样做`YAML::Iterator`，就像这样

```
for (YAML::Iterator it=doc.begin(); it<doc.end(); ++it) 
{ 
   std::string key;
   it.first() >> key;
   if (key=="parameter") { /* do stuff, possibly iterating over nested keys */ }
   } else if (/* */) {
   } else {
       std::cerr << "Warning: bad parameter" << std::endl;
   }
} 
```

但是有没有更简单的方法来做到这一点？我的方式似乎完全规避了 YAML-cpp 内置的任何错误检查，并且似乎取消了随机访问密钥的所有简单性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:06:21.117

如果您担心由于用户拼写错误而导致密钥不存在，您可以使用`FindValue`：

```
if(const YAML::Node *pNode = doc.FindValue("parameter")) {
   // do something
} else {
   std::cerr << "Parameter missing\n";
} 
```

如果您真的想在特定列表之外获取地图中的所有键，那么您必须在执行过程中进行迭代。

# c++ - 包含的函数隐藏了重载的虚函数

> ID：13168045
> 
> 赞同：2
> 
> 时间：2012-10-31T21:57:30.617
> 
> 标签：c++, class, function, virtual, overloading

我正在使用 OpenCV 开发一个系统。该系统有一个带有虚函数的类，它与 OpenCV 使用的虚函数同名（train）。编译时，我收到以下警告：

> /opt/local/include/opencv2/ml/ml.hpp:957:18：警告：'CvForestTree::train' 隐藏重载的虚拟函数 [-Woverloaded-virtual]

大多数与隐藏重载虚函数有关的问题都涉及类和派生类，但在这种情况下，我（可能不正确）假设问题是 OpenCV 实现的类具有同名的函数。请注意，必须包含 OpenCV 标头才能使我的函数的类定义起作用。

显然，我不想更改我创建的类中的函数名称，并且我怀疑我正在做一些愚蠢的事情来解决这个问题。

编辑：CvForestTree 是 OpenCV 的课程，不是我的。我不确定导致问题的代码行的确切区域，因为任何包含 OpenCV 标头的文件都会出现警告。也许这意味着它是一个 OpenCV 错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T22:18:43.143

问题不在于您的代码，而在于 OpenCV 的代码：`CvForestTree`该类派生自`CvTree`并且两个类都具有 [虚拟]`train()`成员函数。由于`CvForestTree`没有覆盖所有三个重载（我不知道它是否覆盖了任何重载，但有两个`train()`重载 in`CvForestTree`和三个 in `CvTree`），因此至少`CvTree::train()`隐藏了一个函数。

解决这个问题的方法是有一个像这样的声明

```
using CvTree::train; 
```

在 的定义中`CvForestTree`。当然，这不是你的课。这是警告的问题之一：经常为您无法控制的代码发出警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-26T00:48:14.693

实际上，您必须使用 CvDTree::train 添加它；在 ml.hpp 的几个地方：

```
class CV_EXPORTS CvBoostTree: public CvDTree
{
public:
  using CvDTree::train;
    CvBoostTree();

class CV_EXPORTS CvForestTree: public CvDTree
{
public:
  using CvDTree::train;
    CvForestTree(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-10T08:00:26.740

我的解决方案是`using CvDTree::train;`在`include/opencv2/ml/ml.hpp`. 1.在 CvForestTree 类定义中：

```
class CV_EXPORTS CvForestTree: public CvDTree
{
using CvDTree::train; 
```

2\. 在 CvBoostTree 类定义中：

```
class CV_EXPORTS CvBoostTree: public CvDTree
{
using CvDTree::train; 
```

# css - 使用 `box-sizing: border-box` 和 `inline-block` 元素

> ID：13168048
> 
> 赞同：3
> 
> 时间：2012-10-31T21:57:46.843
> 
> 标签：css

我想使用`box-sizing: border-box`CSS 属性将表单分成左右两半：

```
<form class=container>
  <fieldset class=left>
    <label>Description</label>
    <textarea name=description></textarea>
  </fieldset>
  <fieldset class=right>
    <label>Name</label>
    <input type=text name=name />
  </fieldset>
</form> 
```

为了完成这项工作，我需要将两个`<fieldset>`元素都向左浮动：

```
.left, .right {
  width: 50%;
  margin-left: 0px;
  marign-right: 0px;
  box-sizing: border-box;
  float: left;
} 
```

问题当然是，由于`<fieldset>`'s 是浮动的，它们不再流入，并且`<form>`元素的高度为 0（除非我添加了 clearfix 或其他东西）。如果我删除 float 属性并将它们的显示更改为`inline-block`，它们会重新流动，但它们不再彼此相邻排列。

有什么方法可以`border-box`在这里使用而不需要添加 clearfix 元素（或`:after`伪元素）？

作为参考，[这是](http://jsfiddle.net/aaronj1335/amXeB/1/)一个使用浮点数的小提琴，[这是](http://jsfiddle.net/aaronj1335/amXeB/)一个使用 inline-block 的小提琴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:04:33.850

这是一个很常见的问题。

在容器上添加一个`overflow`值，将使浏览器重新计算容器的尺寸，尽管它没有非浮动元素。

```
.container { overflow: hidden; } 
```

**[之前](http://jsfiddle.net/amXeB/2/)**和**[之后](http://jsfiddle.net/amXeB/3/)**

# javascript - 在带有注释的 XRegExp 中查找哈希 ("#")

> ID：13168049
> 
> 赞同：2
> 
> 时间：2012-10-31T21:57:53.550
> 
> 标签：javascript, regex, xregexp

如果您使用 XRegExp 的“x”标志，则不清楚如何将文字“#”添加到搜索中。

[该文件](http://xregexp.com/syntax/)似乎没有产生任何照明。

例如：

```
> XRegExp("the # hey",'x').toString()
'/the(?:)/' 
```

正如预期的那样 - '#' 之后的所有内容都是注释并被忽略。

明显的解决方案，不忽略该`#`行的后续内容，通常（根据我的有限经验）以转义修饰符开头，例如`\\`：

```
> XRegExp("the \# hey",'x').toString()
'/the(?:)/' 
```

或者

```
> XRegExp("the \\# hey",'x').toString()
'/the(?:)\\#(?:)hey/' 
```

不幸的是，两者都没有按预期工作，前者出于明显的原因，后者产生：

```
> XRegExp("the \\# hey",'x').xtest("the # hey")
false 
```

甚至在更有害的情况下，我们必须修改输入数据：

```
> XRegExp("the \\# hey",'x').xtest("the \\# hey")
false 
```

另一种规范转义是使用双哈希 ( `##`)，但这也不起作用：

```
> XRegExp("the ## hey",'x').toString()
'/the(?:)/' 
```

那么问题就变成了，如何将`#`文字添加到使用 'x' 标志的 XRegExp 表达式中？我难住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:59:59.523

我找到了答案，请注意我上面的测试不起作用，因为空格应该替换为`\\s+`.

答案似乎是使用`[#]`例如

```
> XRegExp("the\\s+[#]\\s+hey",'x').xtest("the # hey")
true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-25T22:20:54.897

flag 的文档`x`位于[http://xregexp.com/flags/#extended](http://xregexp.com/flags/#extended)。

的影响之一`x`是您的正则表达式模式中的空格被忽略。我看到您发现正则表达式中的文字空格可以替换为`\s`(`\\s`由于字符串转义规则而嵌入字符串文字时)。但请注意，这会将您的模式从仅匹配空格字符更改为匹配任何空格字符。或者，您可以转义空格：`XRegExp('the\\ \\# \\ hey', 'x')`. 或者您可以使用`[ ]`与使用`[#]`. 或者你可以做类似的事情`XRegExp('the' + XRegExp.escape(' # ') + 'hey', 'x')`。或者，如果您的模式中有文字空格和字符，则不要使用该`x`标志。`#`

# heroku - What does 'Non-persistent' mean with Heroku's Redis To Go Nano plan?

> ID：13168050
> 
> 赞同：12
> 
> 时间：2012-10-31T21:57:55.517
> 
> 标签：heroku, redis, redistogo

I recently signed up for Heroku's Redis To Go [https://addons.heroku.com/redistogo](https://addons.heroku.com/redistogo). For now, I'm using the free Nano plan, which says:

*   5 MB Redis Instance
*   1 Database
*   Non-persistent
*   No Backups
*   10 Connections

I get what 'No Backups' etc. mean, but can't find any info on what is 'Non-persistent'? Does it mean the data is wiped out every time I deploy? Daily? Every now and then? When Heroku crashes?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-17T00:48:47.520

**非持久性**意味着如果需要重新启动您的实例，您的数据将会消失，
**例如** AWS 引起的服务器问题通常涉及实例重启。

其他计划都提供数据的 AOF 持久性和每日快照 RDB 备份。[Direct 计划](https://redistogo.com/p/morgan)便宜 30%，而且您可以获得
更多[功能](http://support.redistogo.com/kb/info/the-benefits-of-a-direct-plan)。

*[有关持久性和备份](http://redis.io/topics/persistence)的更多信息*

# knockout.js - Knockout observableArray in TypeScript

> ID：13168051
> 
> 赞同：8
> 
> 时间：2012-10-31T21:57:57.030
> 
> 标签：knockout.js, typescript, ko.observablearray

What is the proper way to initialize a Knockout observableArray in a TypeScript class?

I am doing something like this:

```
 module ViewModel { 

        declare var ko;

        export class IndexPageViewModel {       

                agencies: any;                   

                constructor () {               
                    this.agencies = ko.observableArray([]);              
                }                                                                                                   
        }
    }

var ivm = new ViewModel.IndexPageViewModel();
ivm.agencies.push({name: "name", alias : "alias"});
for (var i = 0; i < ivm.agencies.length; i++){
    alert(ivm.agencies[i].name);
 } 
```

Looks simple enough, but when I attempt to access the agencies property as indicated, execution hangs. Did I miss something?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-31T22:42:21.630

这一行是您的错误所在：

```
agencies[i] 
```

当你访问一个可观察数组时，它实际上被包装在一个函数中，所以你可以像这样访问它：

```
agencies()[i] 
```

也请帮自己一个忙，并从以下网址下载 Knockout 定义： [https ://github.com/borisyankov/DefinitelyTyped](https://github.com/borisyankov/DefinitelyTyped)

然后用类型声明你的属性：

```
module ViewModel {

    export class IndexPageViewModel {

        agencies: KnockoutObservableArray;

        constructor () {
            this.agencies = ko.observableArray([]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-31T15:44:33.810

我只是在 TypeScript 1.3 中做到了这一点（尽管它也应该在旧版本中工作）：

```
pendingAddAssociations: KnockoutObservableArray<ControllerModel> = ko.observableArray<ControllerModel>([]); 
```

对于您的示例，如果您有一个代理类。

```
export class IndexPageViewModel {

        agencies: KnockoutObservableArray<Agency>;

        constructor () {
            this.agencies = ko.observableArray<Agency>([]);
        }
    } 
```

我还发现，`this.agencies = <any>[];`如果您使用[Knockout ES5 插件](http://blog.stevensanderson.com/2013/05/20/knockout-es5-a-plugin-to-simplify-your-syntax/)，您可以转换为任何内容。

# php - Integrating simpleSAMLphp (SAML 2.0) with CMS Made Simple (CMSMS)

> ID：13168057
> 
> 赞同：0
> 
> 时间：2012-10-31T21:58:52.600
> 
> 标签：php, saml, saml-2.0, cmsmadesimple

I'm trying to build a service proviuder (SP) site for a client using a SAML2.0 based user ID system.

I've been able to install simpleSAMLphp on my server and have tested it with an open IdP authentication network - all is working fine if I just create php files which demand authentication against this IdP. Simple adding this to any page makes it work.

```
require_once('../simplesamlphp/lib/_autoload.php');
$auth = new SimpleSAML_Auth_Simple('default-sp');
$auth->requireAuth();
$attributes = $auth->getAttributes(); 
```

Within CMSMS however, if I add the above as a user defined smarty tag (the usual way of including php) I get a "state lost" error. I've tried adding it to the page meta data (via the content interface) as well as simply in the body of the page or at the head of the template.

I always get:

> ```
> State information lost
> State information lost, and no way to restart the request 
> ```

Does anyone have any ideas what could be going wrong? I've tried the usual fixes for this error messages (adjusting the domain the cookies are assigned to in php.ini etc). No joy.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T06:15:12.127

这似乎是 simpleSAMLphp 和 CMSMS 之间的冲突会话管理。

解决此问题的一种简单方法是安装 memcached，并使用 memcache 会话处理程序而不是 simplesamlphp 中的 php 会话处理程序。

*   [http://simplesamlphp.org/docs/stable/simplesamlphp-maintenance#section_2_1](http://simplesamlphp.org/docs/stable/simplesamlphp-maintenance#section_2_1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T12:21:30.943

eZ publish (4.x) 和 Symfony2 (2.3+) 也有类似的会话冲突。SQL 会话存储解决了这个问题

# mysql - mysql选择开始和结束在2个工作日内的记录

> ID：13168061
> 
> 赞同：1
> 
> 时间：2012-10-31T21:59:05.343
> 
> 标签：mysql

我只有一张桌子`requests`

```
| 身份证 | 已打开 | 关闭 |
| 1 | 2012-08-21 16:11:22 | 2012-10-31 11:48:58 |
| 2 | 2012-08-15 16:17:19 | 2012-09-18 09:31:32 |

```

并想编写一个查询来检查表中所有在 2 个工作日内关闭的记录

我在想类似的东西

SELECT * FROM requests WHERE Closed <= (Opened+TWO BUSINESS DAYS)

但无法弄清楚两个工作日部分的逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T16:46:10.797

我实际上发现使用日历表是最好的。（尽管我不想这样做） [http://www.brianshowalter.com/calendar_tables](http://www.brianshowalter.com/calendar_tables)有一个很棒的工具可以做到这一点！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-31T22:18:16.513

使用之间：SELECT * FROM requests WHERE Open BETWEEN '06-Jan-1999' AND '10-Jan-1999' AND Closed BETWEEN '06-Jan-1999' AND '10-Jan-1999'

[http://www.1keydata.com/es/sql/sql-between.php](http://www.1keydata.com/es/sql/sql-between.php)

[http://www.w3schools.com/sql/sql_between.asp](http://www.w3schools.com/sql/sql_between.asp)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T22:18:23.690

我认为这就是您的意思：您要选择关闭日期介于打开日期和打开日期+ 2 之间的所有记录

```
 SELECT *
  FROM requests
 WHERE closed BETWEEN opened AND opened + 2 
```

# sonarqube - How to specify library paths for sonar-runner with C code

> ID：13168063
> 
> 赞同：1
> 
> 时间：2012-10-31T21:59:14.393
> 
> 标签：sonarqube, sonar-runner

I am trying to set up sonar-runner on a legacy code base. It seems to be working. However, I get several warnings like this:

> *WARN #include the file filename1.h could not be found at file:filename2.h. Please check your additional library configuration.*

I found a property I can possibly set in the sonar-project.properties file to point to all the library directories:

```
sonar.c.library.directories=/path/to/library/ 
```

My problem is, there are seriously about *50 directories* I will need to include to capture them all, and as far as I can tell, I need to type them all on a single line, comma-separated.

So, my question is,

# *is it worth it*?

Does sonar-runner need to find these dependencies to do an appropriate analysis? Would I gain anything at all, or should I just let it be?

# objective-c - NSManagedObject 无法从 NSAtomicStoreCacheNode 获取属性

> ID：13168064
> 
> 赞同：17
> 
> 时间：2012-10-31T21:59:17.373
> 
> 标签：objective-c, core-data, attributes, entity-relationship, nsmanagedobject

我在实体 A 和实体 B（一侧）之间存在一对一的关系，例如名为 bRel。我有`NSAtomicStore`(MyStore) 和`NSAtomicStoreCacheNode`(MyCacheNode) 的子类。在`load:`MyStore 的方法中，我为实体 A 和 B（aNode 和 bNode）创建 MyCacheNode 实例，并为每个实体分配相应的 propertyCache 字典。aNode 的 propertyCache 包含 key 的 bNode `@"bRel"`。

aManagedObject 是正常创建的，并且所有属性都有效。但是当 aManagedObject 通过 访问 bManagedObject 时`aManagedObject.bRel.someAttribute`，bManagedObject 仍然是错误的。bManagedObject 不接收`awakeFromInsert`或`awakeFromFetch`。bNode 和 bManagedObject 共享相同的`managedObjectID`. 当 bManagedObject 访问 someAttribute 时，bNode 是活动的。当一个ManagedObject 访问它的属性时，它会经过`valueForKey:`MyCacheNode 的。当 bManagedObject 这样做时，我们没有到达那里。

bManagedObject 根本不会触发。

谁能想到在这种情况下我应该检查什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-25T19:20:19.467

从目前的角度来看，我认为我只是没有要求`willAccessValueForKey:/didAccessValueForKey:`合成属性，这与自定义商店无关。B是A的综合属性，AFAIR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-21T05:10:24.910

是的。问题可能是您的托管对象上有 aRel 的前向声明。尝试在 aManagedObject.h 文件中导入它。这样，您应该能够访问它的属性。

让我知道事情的后续 ：）

# sql - 仅使用最小 COUNT() 转置行和列（又名枢轴）？

> ID：13168066
> 
> 赞同：8
> 
> 时间：2012-10-31T21:59:22.537
> 
> 标签：sql, postgresql, pivot, crosstab

这是我的表'tab_test'：

```
year    animal  price
2000    kittens 79
2000    kittens 93
2000    kittens 100
2000    puppies 15
2000    puppies 32
2001    kittens 31
2001    kittens 17
2001    puppies 65
2001    puppies 48
2002    kittens 84
2002    kittens 86
2002    puppies 15
2002    puppies 95
2003    kittens 62
2003    kittens 24
2003    puppies 36
2003    puppies 41
2004    kittens 65
2004    kittens 85
2004    puppies 58
2004    puppies 95
2005    kittens 45
2005    kittens 25
2005    puppies 15
2005    puppies 35
2006    kittens 50
2006    kittens 80
2006    puppies 95
2006    puppies 49
2007    kittens 40
2007    kittens 19
2007    puppies 81
2007    puppies 38
2008    kittens 37
2008    kittens 51
2008    puppies 29
2008    puppies 72
2009    kittens 84
2009    kittens 26
2009    puppies 49
2009    puppies 34
2010    kittens 75
2010    kittens 96
2010    puppies 18
2010    puppies 26
2011    kittens 35
2011    kittens 21
2011    puppies 90
2011    puppies 18
2012    kittens 12
2012    kittens 23
2012    puppies 74
2012    puppies 79 
```

这是一些转置行和列的代码，因此我得到了“小猫”和“小狗”的平均值：

```
SELECT
    year,
    AVG(CASE WHEN animal = 'kittens' THEN price END) AS "kittens",
    AVG(CASE WHEN animal = 'puppies' THEN price END) AS "puppies"
FROM tab_test
GROUP BY year
ORDER BY year; 
```

上面代码的输出是：

```
 year    kittens puppies
    2000    90.6666666666667    23.5
    2001    24.0    56.5
    2002    85.0    55.0
    2003    43.0    38.5
    2004    75.0    76.5
    2005    35.0    25.0
    2006    65.0    72.0
    2007    29.5    59.5
    2008    44.0    50.5
    2009    55.0    41.5
    2010    85.5    22.0
    2011    28.0    54.0
    2012    17.5    76.5 
```

我想要的是一个像第二个一样的表，但它只包含`COUNT()`第一个表中 a 至少为 3 的项目。换句话说，目标是将*其*作为输出：

```
year    kittens
2000    90.6666666666667 
```

第一个表中至少有 3 个“小猫”实例。
这在 PostgreSQL 中可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T23:40:41.843

### `CASE`

如果您的案例与演示的一样简单，`CASE`则可以使用以下语句：

```
SELECT year
     , sum(CASE WHEN animal = 'kittens' THEN price END) AS kittens
     , sum(CASE WHEN animal = 'puppies' THEN price END) AS puppies
FROM  (
   SELECT year, animal, avg(price) AS price
   FROM   tab_test
   GROUP  BY year, animal
   HAVING count(*) > 2
   ) t
GROUP  BY year
ORDER  BY year; 
```

`sum()`使用,`max()`或`min()`作为外部查询中的聚合函数都没有关系。在这种情况下，它们都会产生相同的值。

[**SQL小提琴**](http://sqlfiddle.com/#!15/c64b4/4)

### `crosstab()`

使用更多类别，查询会更简单`crosstab()`。*对于更大的表，*这也应该更快。

您需要安装附加模块[tablefunc](http://www.postgresql.org/docs/current/interactive/tablefunc.html)（每个数据库一次）。从 Postgres 9.1 开始，这很简单：

```
CREATE EXTENSION tablefunc; 
```

此相关答案中的详细信息：

*   [PostgreSQL 交叉表查询](https://stackoverflow.com/questions/3002499/postgresql-crosstab-query/11751905#11751905)

```
SELECT * FROM crosstab(
      'SELECT year, animal, avg(price) AS price
       FROM   tab_test
       GROUP  BY animal, year
       HAVING count(*) > 2
       ORDER  BY 1,2'

      ,$$VALUES ('kittens'::text), ('puppies')$$)
AS ct ("year" text, "kittens" numeric, "puppies" numeric); 
```

这个没有 sqlfiddle，因为该站点不允许附加模块。

### 基准

为了验证我的说法，我在我的小型测试数据库中运行了一个接近真实数据的快速基准测试。PostgreSQL 9.1.6。测试`EXPLAIN ANALYZE`，最好的 10：

具有 10020 行的测试设置：

```
CREATE TABLE tab_test (year int, animal text, price numeric);

-- years with lots of rows
INSERT INTO tab_test
SELECT 2000 + ((g + random() * 300))::int/1000 
     , CASE WHEN (g + (random() * 1.5)::int) %2 = 0 THEN 'kittens' ELSE 'puppies' END
     , (random() * 200)::numeric
FROM   generate_series(1,10000) g;

-- .. and some years with only few rows to include cases with count < 3
INSERT INTO tab_test
SELECT 2010 + ((g + random() * 10))::int/2
     , CASE WHEN (g + (random() * 1.5)::int) %2 = 0 THEN 'kittens' ELSE 'puppies' END
     , (random() * 200)::numeric
FROM   generate_series(1,20) g; 
```

结果：

[@bluefeet](https://stackoverflow.com/a/13168127/939860)
*总运行时间：95.401 毫秒*

[@wildplasser](https://stackoverflow.com/a/13168617/939860)（不同的结果，包括带有 的行`count <= 3`）
*总运行时间：64.497 毫秒*

[@Andreiy](https://stackoverflow.com/a/13168400/939860) (+ `ORDER BY`)
& @Erwin1 - `CASE`(两者的表现差不多)
*总运行时间: 39.105 ms*

@Erwin2 -`crosstab()`
*总运行时间：17.644 毫秒*

只有 20 行的大比例（但不相关）结果。只有@wildplasser 的 CTE 有更多的开销和尖峰。

拥有超过几行，`crosstab()`迅速领先。@Andreiy 的查询执行与我的简化版本大致相同，外部`SELECT`( `min()`, `max()`, `sum()`) 中的聚合函数没有可测量的差异（每组只有两行）。

一切都如预期的那样，毫不奇怪，接受我的设置并尝试@home。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T22:32:03.750

[这是@bluefeet 建议](https://stackoverflow.com/a/13168127/297408)的替代方案，它有点相似但避免了连接（相反，上层分组应用于已经分组的结果集）：

```
SELECT
  year,
  MAX(CASE animal WHEN 'kittens' THEN avg_price END) AS "kittens",
  MAX(CASE animal WHEN 'puppies' THEN avg_price END) AS "puppies"
FROM (
  SELECT
    animal,
    year,
    COUNT(*) AS cnt,
    AVG(Price) AS avg_price
  FROM tab_test
  GROUP BY
    animal,
    year
) s
WHERE cnt >= 3
GROUP BY
  year
; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T22:05:34.077

这是你想要的：

```
SELECT t1.year,
    AVG(CASE WHEN t1.animal = 'kittens' THEN t1.price END) AS "kittens",
    AVG(CASE WHEN t1.animal = 'puppies' THEN t1.price END) AS "puppies"
FROM tab_test t1
inner join 
(
  select animal, count(*) YearCount, year
  from tab_test
  group by animal, year
) t2
  on t1.animal = t2.animal 
  and t1.year = t2.year
where t2.YearCount >= 3
group by t1.year 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!1/a089f/6)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T22:55:20.233

```
CREATE TABLE pussyriot(year INTEGER NOT NULL
        , animal varchar
        , price integer
        );

INSERT INTO pussyriot(year , animal , price ) VALUES
 (2000, 'kittens', 79)
, (2000, 'kittens', 93)
...
, (2007, 'puppies', 81)
, (2007, 'puppies', 38)
        ;

-- a self join is a poor man's pivot:
WITH cal AS ( -- generate calendar file
        SELECT generate_series(MIN(pr.year) , MAX(pr.year)) AS year
        FROM pussyriot pr
        )
, fur AS (
        SELECT distinct year, animal, AVG(price) AS price
        FROM pussyriot
        GROUP BY year, animal
        -- UPDATE: added next line
        HAVING COUNT(*) >= 3
        )
SELECT cal.year
        , pussy.price AS price_of_the_pussy
        , puppy.price AS price_of_the_puppy
FROM cal
LEFT JOIN fur pussy ON pussy.year=cal.year AND pussy.animal='kittens'
LEFT JOIN fur puppy ON puppy.year=cal.year AND puppy.animal='puppies'
        ; 
```

# c# - 如何将堆栈面板内的 wpf 数据网格与主窗口的四个角固定距离

> ID：13168067
> 
> 赞同：0
> 
> 时间：2012-10-31T21:59:35.313
> 
> 标签：c#, wpf, datagrid, wpfdatagrid, stackpanel

我的雇主给了我以下 wpf 布局。它利用了多个嵌套的堆栈面板。我正在尝试将位于堆栈面板内的数据网格与主窗口的四个角相距固定距离。并且每当网格包含由于父窗口大小而隐藏的数据时，它应该显示滚动条，如果不需要，滚动条必须消失。

* * *

我将数据网格和堆栈面板的宽度设置为自动，以便它填充宽度并使水平和垂直滚动条按我想要的方式运行。但是网格没有所需的高度。

* * *

但是当我尝试将数据网格的高度属性设置为自动时，水平和垂直滚动条都会消失，从而导致隐藏数据。我尝试将数据网格高度属性设置为固定大小并在调整窗口大小时更新它但滚动条仍然隐藏我该如何解决这个问题？

```
<UserControl x:Class="WpfApplication1.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="441" d:DesignWidth="300">
    <Grid>
        <StackPanel Margin="0" Name="stackPanel1">
            <ListBox Height="100" Name="listBox1" Width="253" />
            <Button Content="Button" Height="23" Name="button1" Width="256" Click="button1_Click" />
            <StackPanel Name="stackPanel2">
                <StackPanel Height="34" Name="stackPanel3" Width="249" />
                <DataGrid AutoGenerateColumns="False" Name="dataGrid1" Height="282" />
            </StackPanel>
        </StackPanel>
    </Grid>
</UserControl>

<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:my="clr-namespace:WpfApplication1" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" x:Class="WpfApplication1.MainWindow"
        Title="MainWindow" Height="502" Width="525" StateChanged="Window_StateChanged">
    <Grid Margin="0">
        <my:UserControl1 x:Name="userControl11" Loaded="userControl11_Loaded" />
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:52:06.293

当您将项目放入垂直`StackPanel`时，他们喜欢假装它们有无限的垂直空间。切换到在您的 上指定行`Grid`，并将您`DataGrid`的行放在这些行之一中。当它在 a`Grid`中时，它知道它有多少可用空间并且应该适当地显示滚动条。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:03:16.547

我不明白 StackPanel 里面的所有这些 StackPanel 的东西。您应该简单地使用 Grid 进行布局：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
    </Grid.RowDefinitions>
    <ListBox Grid.Row="0" Height="100" Name="listBox1" Width="253" />
    <Button Grid.Row="1" Content="Button" Height="23" Name="button1" Width="256" />
    <StackPanel Grid.Row="2" Height="34" Name="stackPanel3" Width="249" />
    <DataGrid Grid.Row="3" AutoGenerateColumns="False" Name="dataGrid1" />
</Grid> 
```

并且有一个空的 StackPanel`stackPanel3`作为空间持有者似乎很尴尬。这就是 WPF 元素具有[Margin](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.margin.aspx)属性的原因。

# javascript - Spotify 获取艺术家信息 - 错误 503 服务

> ID：13168069
> 
> 赞同：1
> 
> 时间：2012-10-31T21:59:45.033
> 
> 标签：javascript, html, ajax, json, spotify

Spotify 有一个 WEB API，它允许你查询他们的数据库。我正在尝试获取以下链接，例如： `http://ws.spotify.com/search/1/artist.json?q=Nas`. 这是服务器端问题还是我这边的问题？好的，所以我突然遇到了一个非常奇怪的错误，它说：

```
Error 503 Service Unavailable

Service Unavailable

Guru Meditation:

XID: 333508029

Varnish cache server 
```

几个小时前它工作得很好，现在突然就不行了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T05:03:42.363

该服务似乎已关闭。我看到同样的事情。[如果您查看此页面](https://developer.spotify.com/technologies/web-api/#introduction)上列出的响应，则会显示 503 错误意味着该服务暂时不可用。这正是错误消息本身所说的，但很高兴得到确认。希望我知道它可能会下降多长时间。

# php - 联系表格 7 添加操作以提交

> ID：13168075
> 
> 赞同：1
> 
> 时间：2012-10-31T22:00:18.967
> 
> 标签：php, wordpress, contact-form-7

我试图向 FC1 提交按钮添加操作，但我真的无法在网络上的任何地方找到适合它的功能。我发现的唯一一个叫`"wpcf7_before_send_mail"` 我真的不能让它工作

```
add_action('wpcf7_before_send_mail', 'mytheme_save_to_getresponse', 10, 1);
function mytheme_save_to_getresponse($form)
{
   echo "testing";
} 
```

有什么建议么？

# perl - 如何从 CGI 服务器下载 perl 脚本而不是运行它？

> ID：13168077
> 
> 赞同：1
> 
> 时间：2012-10-31T22:00:44.580
> 
> 标签：perl, apache, firefox, cgi

我正在尝试从该站点下载 perl 脚本：http: [//pages.cs.wisc.edu/~david/courses/cs552/S12/handouts/bins/](http://pages.cs.wisc.edu/~david/courses/cs552/S12/handouts/bins/)

当我打开或下载其中任何一个时，脚本就会执行。但是，我想要脚本中的文本。有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T22:04:14.093

## 对于非 .pl 文件，

服务器实际上是在重新调整脚本（而不是它的输出），所以您必须最终执行它。右键单击链接并选择将链接另存为。

## 对于 .pl 文件，

服务器实际上正在执行这些脚本并返回输出。您需要使用不同的 URL 来获取脚本本身。不可能存在这样的 URL。

联系您的教授并就该问题向他提出建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T05:44:48.930

如果脚本正在执行，那么网络服务器被配置为执行该目录中的脚本，或者它被配置为执行所有 .pl 或 .cgi 文件所在的位置。网络服务器执行脚本是正常的。如果您想要脚本源，则必须将网络服务器配置为不执行脚本，在这种情况下，它将提供您所追求的源。假设他们不应该执行，请联系管理员正确配置。

否则，您将需要访问 ~david/courses/cs552/S12/handouts/bins/ 的文件系统，无论是通过 FTP 还是通过其他方式下载它们。基本上可以访问，但您可以不通过 HTTP 访问。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T22:10:33.550

只需右键单击它并选择“将链接另存为...”（仅在服务器端未启用脚本处理时有效）

通常你不能这样做，因为当你请求任何脚本时，它正在服务器端处理，并且只在浏览器上显示结果。如果您尝试将 httpd 配置为让用户下载脚本，您应该禁用按扩展名处理脚本，或者只是将扩展名更改为 txt。

# java - Java 小程序多次显示自身

> ID：13168078
> 
> 赞同：1
> 
> 时间：2012-10-31T22:00:44.877
> 
> 标签：java, swing, applet, awt

我正在为学校制作一个Java小程序，其功能是随机选择六个数字作为三个点的坐标并将它们连接成一个三角形。它只应该绘制一个三角形并找到“边长”。但是，当我把它放在我的网站上时，它会多次重绘自己。

![](../Images/0aaa1c178a972719e7102306ddfff842.png)

我制作了另一个更简单的小程序，它只选择 4 个随机数作为坐标来绘制一条线。同样的问题。

重绘问题似乎发生在用户移动屏幕时，例如当我滚动或在 Eclipse 中调整小程序查看器的大小时。我的源代码发布在这里。

我很感激任何帮助！谢谢！

```
import javax.swing.JApplet;
import java.awt.*;

@SuppressWarnings("serial")
public class LineApplet extends JApplet {

    /**
     * Create the applet.
     */

    static int width;
    int height;

    public void init() {

          width = getSize().width;
          height = getSize().height;

       }

    public static int[] randomLine() {
        int[] pointArray = new int[4];
        int x;
        for (int i = 0; i < 4; i++) {
            x = ((int)(Math.random()*(width/10-2)))*20+10;
            pointArray[i] = x;
        }
        return pointArray;
    }

    public void paint(Graphics g) {
        g.setColor(Color.blue);
        int[] coords = new int[4];
        coords = randomLine();
        g.drawLine(coords[0], coords[1], coords[2], coords[3]);
        g.drawString(coords[0]/10 + ", " + coords[1]/10, coords[0], coords[1]);
        g.drawString(coords[2]/10 + ", " + coords[3]/10, coords[2], coords[3]);
        int midpointx = (coords[0] + coords[2])/2;
        int midpointy = (coords[1] + coords[3])/2;
        g.drawString(midpointx/10 + ", " + midpointy/10, midpointx, midpointy);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:25:29.477

正如 Reimues 所指出的，每次重新绘制小程序时，您都会重新生成坐标。

您的方法的另一个问题`paint`实际上是您不清楚图形上下文的先前状态（这将由 完成`paint`，但是当您覆盖它时您没有尊重它的功能）。

你有两个选择。

1.  称呼`super.paint(g)`
2.  打电话`super.paint(g)`和打电话[`Graphics#clearRect(int, int, int, int)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#clearRect%28int,%20int,%20int,%20int%29)或[`Graphics#fillRect(int, int, int, int)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#fillRect%28int,%20int,%20int,%20int%29)

您还应该（很少）需要覆盖`paint`顶级容器的方法。一个原因是它们没有双缓冲，另一个是油漆链复杂且容易断裂......

你最好使用一个`JPanel`（或这样的）并覆盖该`paintComponent`方法......

**更新**

我更新了您的代码以演示这些问题。

```
public class TestBadApplet extends JApplet {

    public void init() {
    }

    @Override
    public void start() {

        final LinePane linePane = new LinePane();

        setLayout(new BorderLayout());
        JButton update = new JButton("Update");
        add(linePane);
        add(update, BorderLayout.SOUTH);

        update.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                linePane.regenerate();
            }
        });

    }

    protected class LinePane extends JPanel {

        private int[] coords = new int[4];

        public void regenerate() {
            coords = randomLine();
            repaint();
        }

        public int[] randomLine() {
            int[] pointArray = new int[4];
            int x;
            for (int i = 0; i < 4; i++) {
                x = ((int) (Math.random() * (Math.min(getWidth(), getHeight()) / 10 - 2))) * 20 + 10;
                pointArray[i] = x;
            }
            return pointArray;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.blue);
            g.drawLine(coords[0], coords[1], coords[2], coords[3]);
            g.drawString(coords[0] / 10 + ", " + coords[1] / 10, coords[0], coords[1]);
            g.drawString(coords[2] / 10 + ", " + coords[3] / 10, coords[2], coords[3]);
            int midpointx = (coords[0] + coords[2]) / 2;
            int midpointy = (coords[1] + coords[3]) / 2;
            g.drawString(midpointx / 10 + ", " + midpointy / 10, midpointx, midpointy);
        }
    }
} 
```

和`super.paintComponent`

![好小程序](../Images/19dea8d459ab415c3fe5185a72fd323a.png)

没有`super.paintComponent`

![坏小程序](../Images/eeaf96f11424b8b474731b062d301bdd.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T22:15:15.460

`paint()`每次调用时，您都在计算新坐标。

`paint()`每次调整小程序窗口大小或重新获得焦点时调用。

要修复，您可以制作

```
int[] coords = new int[4]; 
```

类成员变量并移动

```
coords = randomLine(); 
```

到您的`init()`方法，该方法只会在初始化时调用一次。

**附录：**

*   `super.paint(g);`覆盖时总是调用`paint()`。

*   对于使用 Swing 进行自定义绘制，首选方法是扩展`JComponent`组件，利用`paintComponent`.

有关更多信息，请参阅：[执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:15:52.360

问题似乎在于[`paint()`](http://docs.oracle.com/javase/6/docs/api/java/awt/Component.html#paint%28java.awt.Graphics%29)每次组件需要重新绘制时都会调用它。

`paint()`方法应该以不产生副作用的方式编写，并且它们不应该改变小程序的内部状态。`paint()`必须仅限于这样做：绘画。

# sdk - Alfresco SDK 代码挂在 AuthenticationUtils.startSession

> ID：13168080
> 
> 赞同：0
> 
> 时间：2012-10-31T22:00:48.743
> 
> 标签：sdk, alfresco, bitnami

我正在测试来自 SDK 的代码，以在 bitNami Alresco 4.0.e-0 服务器上使用与 Alfresco 位于同一 tomcat 服务器上的 web 应用程序调用 Alfresco。代码在第一次调用 AuthenticationUtils 以获取会话时挂起。我很确定我为此提供了标准的 bitNami Alfresco 用户和密码。我错过了任何图书馆吗？我将大多数可用的依赖项放在我的本地 maven 存储库中，并且代码编译得很好。

以下是没有 Alfresco 许可的 SDK 代码，因为我无法用它格式化代码：

```
package org.alfresco.sample.webservice;

import org.alfresco.webservice.repository.RepositoryServiceSoapBindingStub;
import org.alfresco.webservice.types.Store;
import org.alfresco.webservice.util.AuthenticationUtils;
import org.alfresco.webservice.util.WebServiceFactory;

public class GetStores extends SamplesBase
{
/**
 * Connect to the respository and print out the names of the available 
 * 
 * @param args
 */
public static void main(String[] args) 
    throws Exception
{
    // Start the session
    AuthenticationUtils.startSession(USERNAME, PASSWORD);

    try
    {   
        // Get the respoitory service
        RepositoryServiceSoapBindingStub repositoryService = WebServiceFactory.getRepositoryService();

        // Get array of stores available in the repository
        Store[] stores = repositoryService.getStores();
        if (stores == null)
        {
            // NOTE: empty array are returned as a null object, this is a issue with the generated web service code.
            System.out.println("There are no stores avilable in the repository.");
        }
        else
        {
            // Output the names of all the stores available in the repository
            System.out.println("The following stores are available in the repository:");
            for (Store store : stores)
            {
                System.out.println(store.getScheme() + "://" + store.getAddress());
            }
        }
    }
    finally
    {
        // End the session
        AuthenticationUtils.endSession();
    }
}       
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:51:04.457

WebServiceFactory 使用

```
http://localhost:8080/alfresco/api 
```

作为默认端点。您可以通过在 alfresco 下的类路径上**提供**一个名为**webserviceclient.properties**的文件来更改端点（资源路径：alfresco/webserviceclient.properties）

 **属性文件必须提供一个名为**repository.location**的属性，该属性指定端点 URL。由于您使用的是 bitnami Alfresco 实例，它可能在端口 80 上运行。该文件应包含以下属性条目：

```
repository.location=http://localhost:80/alfresco/api 
```**

# r - 从R中的循环返回多个结果？

> ID：13168081
> 
> 赞同：0
> 
> 时间：2012-10-31T22:00:54.220
> 
> 标签：r, for-loop, return

> **可能重复：**
> [具有多个输出的函数，](https://stackoverflow.com/questions/8216470/function-with-multiple-outputs)
> [对数据框中组内的行进行编号](https://stackoverflow.com/questions/12925063/numbering-rows-within-groups-in-a-data-frame)

G'day，我有一个按地点分组的个人列表。我想生成一个新变量，根据他们的位置为每个人提供一个数字。我希望我的数据看起来像：

```
place       individual
here        1
here        2
here        3
there       1
there       2
somewhere   1 
somewhere   2 
```

我写了这个：

```
 nest<-data.frame(location=c("one","one","two", "three", "three", "three"))
    individual<- function(x)
      {
        pp = 1
        jj = 1
        for (i in 2:length(x)){
            if (x[i] == x[pp]){
                res<- jj+1
                pp = pp + 1
                jj = jj + 1
            }
            else{
                res<- 1
                pp = pp + 1
                jj = 1
            }
        }
        return(res)
      }

    test<- individual(nest$location)
    test 
```

我很确定这可以满足我的要求，但是，我不知道如何返回多个结果值。如何更改此函数以返回每个位置值的结果？或者，有没有更简单的方法可以使用预先存在的 R 包来做到这一点？

PS 在旁注中，我从 nest$individual[2] 启动函数，因为当它从 1 启动函数并尝试查找先前的值（不存在）时，它会返回错误。如果有人对如何解决这个问题有想法，我很想听听。干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:14:05.073

也许是这样的......？

```
ddply(nest,.(location),transform,individual = seq_len(length(location)))
  location individual
1      one          1
2      one          2
3    three          1
4    three          2
5    three          3
6      two          1 
```

（`ddply`在**plyr**包中）

我敢肯定也有一些巧妙的方法可以做到这一点`rle`。确实，只是为了好玩：

```
do.call(c,lapply(rle(nest$location)[[1]],seq_len)) 
```

# python - 如何让导入的函数调用新函数？

> ID：13168082
> 
> 赞同：2
> 
> 时间：2012-10-31T22:00:54.953
> 
> 标签：python, function, python-2.7, return

经过几天的搜索和尝试不同的代码，我仍然无法找出我的问题。因此，我在这里发布了这个问题。

对于这个问题，我正在使用 Python 2.7.2 具体来说，我正在使用组合将一个类的函数导入另一个类。导入类的函数包括一个简单的 if 语句，基于`raw_input`. 根据用户的输入，if 语句应该以某种方式调用或至少有助于调用与输入对应的新函数。但是，此函数将在导入的类的一部分中，而不是在导入的类中。

我在这里使用了两个 .py 文件，每个类一个，它们位于同一个文件夹中。

这是第一个文件（main.py），其中包括主类：

```
# importing class from file in same folder
from class_decision import Decision

class Main_Compositor(object):

    def __init__(self):
        # using composition to call the function of the imported class
        self.door_decision = Decision()

    def comp_door(self):
        self.door_decision.user_text()

        if door == "left":
            left_door()
        elif door == "right":
            right_door()
        else:
            print "incorrect input"

    def left_door(self):
        print "you're in the left room"

    def right_door(self):
        print "you're in the right room"

# instantiating
A_Compositor = Main_Compositor()

# calling A_Compositor's function comp_door()
A_Compositor.comp_door() 
```

这是正在导入其类的 class_decision.py 文件：

```
class Decision(object):

    def user_text(self):
        print "which door do you open:"
        print "left or right?"

        door = raw_input("> ")

        if door == "left":
            print "you have chosen the left door"
            return door
        elif door == "right":
            print "you have chosen the right door"
            return door
        else:
            print "you must choose a door"
            self.user_text() 
```

正如你所看到的，我试图`Return`让主类知道变量`door`。这可能是对`Return`. 我也试过玩弄`getattr`没有成功。如果这个问题被问了很多，我很抱歉。我的类似问题似乎都与数组有关，我无法通过他们的回答真正找出我的问题。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:42:41.477

```
def user_text(self):
    print "which door do you open:"
    print "left or right?"

    door = raw_input("> ")

    if door == "left":
        print "you have chosen the left door"
        return door
    elif door == "right":
        print "you have chosen the right door"
        return door
    else:
        print "you must choose a door"
        return self.user_text()  # don't forget to return in the recursion case 
```

```
def comp_door(self):
    choice = self.door_decision.user_text()  # actually use the returned result

    if choice == "left":
        self.left_door()
    elif choice == "right":
        self.right_door()
    else:
        print "incorrect input" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:26:05.920

在这里使用类没有意义，因为只有*一种*方法。

只是做成`Decision`一个函数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T22:48:58.727

# python - 使用可配置文本编辑器的 Python raw_input() 替换

> ID：13168083
> 
> 赞同：3
> 
> 时间：2012-10-31T22:00:56.310
> 
> 标签：python

我正在尝试实现 raw_input() 的替换，它将使用像 vim 这样的可配置文本编辑器作为用户界面。

理想的工作流程是这样的：

1.  您的 python 脚本正在运行，并调用 my_raw_input()。
2.  Vim（或 emacs、gedit 或任何其他文本编辑器）打开时显示空白文档
3.  您在文档中键入一些文本，然后保存并退出
4.  python 脚本继续运行，文件的内容作为 my_raw_input() 的返回值。

如果你熟悉 git，这就是使用时的体验`git commit`，编辑器是通过[core.editor](http://git-scm.com/book/en/Customizing-Git-Git-Configuration)配置的。其他实用程序`crontab -e`也这样做。

最终，我希望这个 my_raw_input() 函数也采用带有默认输入内容的可选字符串，然后用户可以对其进行编辑。

# 研究至今

*   [os.exec](http://docs.python.org/2/library/os.html#os.execl)用编辑器命令替换当前进程，但不返回。即，当 vim 启动时，您的 python 脚本会退出。
*   [popen](http://docs.python.org/2/library/subprocess.html)不以交互方式启动子进程，没有显示用户界面。
*   vim 有一个`-`命令行参数可以从标准输入读取，但没有任何东西可以用`:w`.
*   我查看了[git 的代码](https://github.com/git/git/blob/master/run-command.c)，我根本无法理解。

这可能吗？

# 编辑

到目前为止很好的答案。我还发现了做同样事情的[mecurial 代码。](http://selenic.com/repo/hg-stable/file/2770d03ae49f/mercurial/ui.py)我还提出了一个通过查看[crontab 代码](http://www.opensource.apple.com/source/cron/cron-35/crontab/crontab.c)的示例，但与某些响应相比，它看起来不必要地复杂。

```
#!/usr/bin/python
import os
import tempfile

def raw_input_editor(default=None, editor=None):
    ''' like the built-in raw_input(), except that it uses a visual
    text editor for ease of editing. Unline raw_input() it can also
    take a default value. '''

    editor = editor or get_editor()

    with tempfile.NamedTemporaryFile(mode='r+') as tmpfile:

        if default:
            tmpfile.write(default)
            tmpfile.flush()

        child_pid = os.fork()
        is_child = child_pid == 0

        if is_child:
            os.execvp(editor, [editor, tmpfile.name])
        else:
            os.waitpid(child_pid, 0)
            tmpfile.seek(0)
            return tmpfile.read().strip()

def get_editor():
    return (os.environ.get('VISUAL')
        or os.environ.get('EDITOR')
        or 'vi')

if __name__ == "__main__":
    print raw_input_editor('this is a test') 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T22:16:08.930

您将数据写入一个临时文件，然后在编辑器返回时读取它。如果你运行`git commit`，你会注意到 git 正在做同样的事情。

交互式启动程序没有额外的步骤，只要子进程具有`stdin`并`stdout`连接到终端，它将是交互式的。

使用编辑器有一个陷阱——他们中的许多人会通过在同一目录中写入一个临时文件并将其移动到旧文件上来保存文件。这使得保存操作完全是原子的（忽略电源可能会断电），但这意味着我们必须在编辑器运行后重新打开临时文件，因为我们的旧文件句柄将指向一个不再属于文件系统（但它仍在磁盘上）。

这个问题意味着我们不能使用`TemporaryFile`or `NamedTemporaryFile`，我们必须使用较低级别的工具，以便我们可以关闭文件描述符并重新打开文件而不删除它。

```
import tempfile
import subprocess
import os

def edit(data):
    fdes = -1
    path = None
    fp = None
    try:
        fdes, path = tempfile.mkstemp(suffix='.txt', text=True)
        fp = os.fdopen(fdes, 'w+')
        fdes = -1
        fp.write(data)
        fp.close()
        fp = None

        editor = (os.environ.get('VISUAL') or
                  os.environ.get('EDITOR') or
                  'nano')
        subprocess.check_call([editor, path])

        fp = open(path, 'r')
        return fp.read()
    finally:
        if fp is not None:
            fp.close()
        elif fdes >= 0:
            os.close(fdes)
        if path is not None:
            try:
                os.unlink(path)
            except OSError:
                pass

text = edit('Hello, World!')
print(text) 
```

`subprocess`Git 示例代码非常复杂，因为它没有使用像 Python模块这样的高级库。如果您阅读`subprocess`模块源代码，它的大部分内容看起来就像链接的 Git 源代码（用 Python 而不是 C 编写的除外）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:21:22.530

您必须创建一个临时文件名，以便编辑器存储其内容。您可以使用[`tempfile.mkstemp()`](http://docs.python.org/2/library/tempfile.html#tempfile.mkstemp)它。如果您想在该文件中放入一些内容，您可以这样做。

对于运行该命令，[`subprocess.check_call()`](http://docs.python.org/2/library/subprocess.html#subprocess.check_call)似乎是该作业的正确工具，因为 python 一直等到该命令返回，并在子进程失败时引发异常。大致：

```
import os
import tempfile
import subprocess

def my_raw_input(default=''):
    tf, tn = tempfile.mkstemp()
    os.close(tf)
    with open(tn) as tf:
        tf.write(default)
    rv = subprocess.check_call(['emacs', tn])
    with open(tn) as f:
        data = f.read()
    os.unlink(tn)
    return data 
```

您当然可以自定义要使用的编辑器等等。

# c# - FindName 和 FindLogicalNode 返回 null

> ID：13168084
> 
> 赞同：1
> 
> 时间：2012-10-31T22:01:01.833
> 
> 标签：c#, wpf, user-controls, reference

我在运行时以编程方式添加一个元素：

```
private void AddModule(string modulename, string ip, string description)
    {
        ModuleInfobox infobox = new ModuleInfobox();
        infobox.Modulename = modulename;
        infobox.IpAddress = ip;
        infobox.Description = description;
        infobox.Modulenamecolor = "Lime";
        infobox.Name = modulename;
        ModulePanel.RegisterName(infobox.Name, infobox);
        ModulePanel.Children.Add(infobox);
    } 
```

ModuleInfoBox 是我的`UserControl`. 现在我需要一个对这个对象的引用。我试试这个：

```
private FindLogicalNodeDelegate delFindLogicalNode;
private FindNameDelegate delFindName;
delegate object FindLogicalNodeDelegate(DependencyObject wantedObject, string name);
delegate object FindNameDelegate(string name);
delFindLogicalNode = new FindLogicalNodeDelegate(LogicalTreeHelper.FindLogicalNode);
delFindName = new FindNameDelegate(ModulePanel.FindName); 
```

在一个线程中：

```
object wantedObject = ModulePanel.Dispatcher.BeginInvoke(delFindLogicalNode, DispatcherPriority.Normal, ModulePanel, "modulename").Result;
object wantedObject2 =  this.Dispatcher.BeginInvoke(delFindName, DispatcherPriority.Normal, "moduleName").Result; 
```

当我使用调试器时，FindLogicalNode 有时会找到一个引用，但通常不会。我阅读了这些主题：[WPF - FindName 在不应该返回 null](https://stackoverflow.com/questions/2285491/wpf-findname-returns-null-when-it-should-not)并且[如果在代码中添加元素但“FindName”不起作用](https://stackoverflow.com/questions/10260122/findname-doesnt-work-if-an-element-added-in-code) 但我的代码中仍然存在错误

# c# - Reportviewer 通过 gmail 发送电子邮件

> ID：13168085
> 
> 赞同：1
> 
> 时间：2012-10-31T22:01:04.677
> 
> 标签：c#, smtpclient, report-viewer2010

我正在开发一个嵌入了报表查看器的 WinForm。

如何通过 gmail/yahoo 发送电子邮件并将此报告附加为 pdf？我查看了这篇文章 [http://www.codeproject.com/Articles/32109/Send-Mail-and-Print-Report-in-Report-Viewer-Contro](http://www.codeproject.com/Articles/32109/Send-Mail-and-Print-Report-in-Report-Viewer-Contro)但不确定它是否仅适用于桌面电子邮件客户端等作为 Outlook 还是支持基于 Web 的电子邮件客户端？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:16:09.547

```
const string HTML_TAG_PATTERN = "<.*?>";
static string StripHTML(string inputString)
{
  return Regex.Replace(inputString, HTML_TAG_PATTERN, string.Empty);
}

public static void sendMessage()
{
  var username = "john.doe@gmail.com";
  var password = "password";
  MailAddress MailFrom = new MailAddress("john.doe@gmail.com");
  MailAddress MailTo = new MailAddress("john.doe@gmail.com");
  var subject = "TEST SUBJECT";
  var attachmentPath = "test.pdf";
  var mailBody = "<b>test</b>";

  NetworkCredential cred = new NetworkCredential(username, password);

  System.Net.Mail.SmtpClient smtp = new System.Net.Mail.SmtpClient();
  smtp.Host = "smtp.gmail.com";
  smtp.UseDefaultCredentials = false;
  smtp.EnableSsl = true;
  smtp.Credentials = cred;
  smtp.Port = 587;

  MailMessage mail = new MailMessage();

  mail.IsBodyHtml = true;

  AlternateView avAlternateView = null;
  Encoding myEncoding = Encoding.GetEncoding("UTF-8");

  avAlternateView = AlternateView.CreateAlternateViewFromString(StripHTML(mailBody), myEncoding, "text/plain");
  mail.AlternateViews.Add(avAlternateView);

  avAlternateView = AlternateView.CreateAlternateViewFromString(mailBody, myEncoding, "text/html");
  mail.AlternateViews.Add(avAlternateView);

  mail.Sender = MailFrom;
  mail.From = MailFrom;
  mail.ReplyTo = MailFrom;

  mail.To.Add(MailTo);

  mail.Subject = subject;
  mail.SubjectEncoding = Encoding.GetEncoding("UTF-8"); 

  mail.BodyEncoding = Encoding.GetEncoding("UTF-8");

  Attachment attachment = new Attachment(attachmentPath);
  mail.Attachments.Add(attachment);
  try
  {
    smtp.Send(mail);
  }
  catch (Exception ex)
  {
  }
} 
```

# javascript - HTML5 - FileAPI - 写入文件

> ID：13168088
> 
> 赞同：3
> 
> 时间：2012-10-31T22:01:13.673
> 
> 标签：javascript, html, fileapi

我正在用 JavaScript 和 HTML5 创建应用程序。我需要将数据写入特定文件，因此我想在代码中设置文件路径。这样做没有问题：

```
function onInitFs(fs) {
    console.log('Opened file system: ' + fs.name);
}
window.webkitRequestFileSystem(window.TEMPORARY, 5 * 1024 * 1024 /* 5MB */, onInitFs, errHandl); 
```

但问题是，它会调用一个安全错误，因为`--allow-file-access-from-files`没有为 exe 文件设置。我不想为所有页面设置它。我只想为我的页面设置它，即我从本地文件系统打开的页面

例如它可以是 index.html：

```
C:\page\index.html. 
```

有没有办法做到这一点？

我只知道 manifest.json，但这意味着我必须使用通过 Chrome 商店分发我的应用程序。这对我来说是不可接受的，我的项目以这种方式没有任何意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-15T12:05:53.783

FileAPI 的想法是拥有一个虚拟沙盒文件系统，而不是管理 OS 文件系统。您不能编辑用户驱动器中的任意文件，这将是一个**巨大**的安全漏洞。

您可能想要做的是**动态生成页面**。如下例所示，首先保存内容 (html)，然后加载并添加到页面：

```
function onInitFs(fs) {
  console.log('Opened file system: ' + fs.name);

  fs.root.getFile(FILE_NAME, {create: true}, function(fileEntry){
    fileEntry.createWriter(function(fw){
      fw.onwriteend = function(e){ console.info('Write completed'); }
      fw.onerror = function(e){ console.log('Error:'+e.toString()); }

      var blobToWrite = new Blob(['<span>test</span>'], {type: 'text/plain'});
      fw.write(blobToWrite);
    }, null);

    console.log(fileEntry.toURL());
  }, null);

    fs.root.getFile(FILE_NAME, {}, function(fileEntry) {

    fileEntry.file(function(file) {
       var reader = new FileReader();

       reader.onloadend = function(e) {
         var someDiv = document.createElement('div');
         someDiv.innerHTML = this.result;
         document.body.appendChild(someDiv);
       };

       reader.readAsText(file);
    }, null);

  }, null);
} 
```

希望有帮助:)

# iphone - RestKit 根据值动态映射关系名称

> ID：13168090
> 
> 赞同：7
> 
> 时间：2012-10-31T22:01:15.797
> 
> 标签：iphone, objective-c, ios, json, restkit

我正在使用 RestKit 解析 JSON 并将其映射到 Core Data NSManagedObjects。这是一个示例 JSON。

```
{
    "events": [
        {
            "description": "...",
            "subject_type": "photo",
            "subject": {
                "id": 1,
                "thumb_url": "...",
                "medium_url": "...",
                "large_url": "..."
            }
        },
        {
            "description": "...",
            "subject_type": "user",
            "subject": {
                "id": 1,
                "username": "...",
                "followers": "..."
            }
        }
    ]
} 
```

使用`RKObjectMappingProvider`并且`RKManagedObjectMapping`我将`"events"`数组映射到单独的核心数据`Event`对象中。这工作正常。

现在有`Event`两个关系。现在我需要根据 的值将主题数组映射到正确的 Core Data 对象，并将其设置为.`User``Photo``"subject_type"``Event`

我尝试使用`RKDynamicObjectMapping`，但我不知道如何为“动态关系”指定它。我需要一些方法来根据 的值设置目标关系的名称`subject_type`。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T17:01:16.230

在 RestKit 中， `RKDynamicMapping`还允许使用指定的块来执行更复杂的动态映射操作，就像您描述的那样。提供此功能的特定方法称为`setObjectMappingForRepresentationBlock`

以下是有关该方法的一些文档： [http](http://restkit.org/api/latest/Classes/RKDynamicMapping.html#//api/name/setObjectMappingForRepresentationBlock) ://restkit.org/api/latest/Classes/RKDynamicMapping.html#//api/name/setObjectMappingForRepresentationBlock ：

RestKit 单元测试说明了此方法的一些简单案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:19:00.403

看来您应该能够使用`RKDynamicObjectMapping`（请参阅[对象映射](https://github.com/RestKit/RestKit/wiki/Object-mapping)）。您可以创建用户映射和照片映射，然后`RKDynamicObjectMapping`像这样使用：

```
[dynamicMapping setObjectMapping:userMapping 
              whenValueOfKeyPath:@"subject_type" 
                       isEqualTo:@"user"];
[dynamicMapping setObjectMapping:photoMapping 
              whenValueOfKeyPath:@"subject_type" 
                       isEqualTo:@"photo"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-20T05:34:07.893

我最近遇到了这个问题。通过 RestKit 跟踪，看起来它正在尝试将所有对象映射应用于 RKDynamicMapping 实例中的所有关系。参见`applyRelationshipMappings`RKMappingOperation.m

我想出了一个 hack 解决方案，但不需要我大量修改 restkit 代码。

在 RKMappingOperation.m 中，我修改了以下方法：

```
destinationObjectForMappingRepresentation:parentRepresentation:withMapping:inRelationship: 
```

我添加了以下代码（从注释开始）检查关系的目标是否与正在应用的对象类型相同，并且仅在匹配时继续。（这没有经过严格的测试，但在我的特定用例中有效。）

```
- (id)destinationObjectForMappingRepresentation:(id)representation parentRepresentation:(id)parentRepresentation withMapping:(RKMapping *)mapping inRelationship:(RKRelationshipMapping *)relationshipMapping
{
    RKObjectMapping *concreteMapping = nil;
    if ([mapping isKindOfClass:[RKDynamicMapping class]]) {
        concreteMapping = [(RKDynamicMapping *)mapping objectMappingForRepresentation:representation];
        if (! concreteMapping) {
            RKLogDebug(@"Unable to determine concrete object mapping from dynamic mapping %@ with which to map object representation: %@", mapping, representation);
            return nil;
        }
        // Make sure the destination of a core data relationship is the right entity class for the object we're mapping;
        if ([self.destinationObject respondsToSelector:@selector(managedObjectContext)])
        {
            NSEntityDescription *destinationEntity = [self.destinationObject entity];
            NSDictionary *destinationPropertiesDictionary = [destinationEntity propertiesByName];
            NSRelationshipDescription *destinationPropertyForDestinationKeyPath = [destinationPropertiesDictionary valueForKey:relationshipMapping.destinationKeyPath];
            NSString *relationshipDestinationClassName = [[destinationPropertyForDestinationKeyPath destinationEntity] name];
            NSString *mappedObjectClassName = [NSString stringWithCString:class_getName(concreteMapping.objectClass) encoding:NSUTF8StringEncoding];
            if (![relationshipDestinationClassName isEqualToString:mappedObjectClassName])
            {
                return nil;
            }
        } 
```

...

# conditional-statements - Opencart 控制器中的条件

> ID：13168092
> 
> 赞同：0
> 
> 时间：2012-10-31T22:01:44.017
> 
> 标签：conditional-statements, where, opencart

我正在开发一个 opencart 模块来显示特定类别的产品。

我不知道如何将“Where”条件添加到以下代码中。请帮忙。

```
 $data = array(
        'sort'  => 'pd.name',
        'order' => 'ASC',
        'start' => 0,
        'limit' => $setting['limit']
    ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:31:35.250

您需要使用键添加类别 ID`filter_category_id`

```
'filter_category_id' => 123, 
```

# expressionengine - 从存储列表中排除某些条目

> ID：13168098
> 
> 赞同：4
> 
> 时间：2012-10-31T22:02:36.517
> 
> 标签：expressionengine

好的，所以在我的主页上，我想拉出 3 个新闻项目列表；重大新闻、专题新闻和新闻头条。一次应该只在主要新闻标题下显示一个项目，任何其他被标记为此类的条目将过滤回特色新闻列表。

我的问题是捕获“一个”主要新闻项目的 entry_id 并将其从特色列表中排除。主要新闻项目可能并不总是最新的新闻项目，因此排除使用 offset="1"。

因此，我整理了一些基于自定义字段 (cf_news_article_type) 过滤掉新闻的 Stash 集。cf_news_article_type 是用户在添加新闻项目时设置的 3 个单选按钮的列表。字段的值设置如下：

```
mj : Major Feature
gf : Featured Article
gn : General article 
```

我存储了一组 13 条来自所有类型的新闻：

```
{!-- Bring out all the recent news --}
{exp:channel:entries channel="news" orderby="date" sort="desc" dynamic="no" limit="13" parse="inward" disable="categories|category_fields|member_data|pagination|trackbacks"}
{exp:stash:append_list name='recent_articles'}
    {stash:item_count}{count}{/stash:item_count}
    {stash:item_type}{cf_news_article_type}{/stash:item_type}
    {stash:item_title}{title}{/stash:item_title}
{/exp:stash:append_list}
{/exp:channel:entries} 
```

然后稍后在我的模板中，我提取了主要新闻项目：

```
<article class="major-feature">
{exp:stash:get_list name="recent_articles" match="#mj#" against="item_type" limit="1" parse_tags="yes"}
    {sn_news_story}
{/exp:stash:get_list}
</article> 
```

现在的大问题是：我如何才能从精选新闻列表中排除该单一主要新闻项目，但在获得精选隐藏列表时将其他项目标记为“mj”？

```
<section class="featured-stories">
<h1>Featured stories</h1>
{exp:stash:get_list name="recent_articles" match="#(mj|gf)#" against="item_type" limit="3" parse_tags="yes"}
    {sn_news_story}
{/exp:stash:get_list}
</section> 
```

然后对于我的头条新闻，我很想排除这两个列表中显示的所有特色和主要新闻项目，但我认为我会在另一篇文章中解决这个问题。

这甚至是做这种事情的正确方法吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:21:30.087

单独存放您的精选新闻文章怎么样？例如：

```
{!-- find just the featured article --}
{exp:channel:entries channel="news" orderby="date" sort="desc" dynamic="no" search:cf_news_article_type="mj" limit="1" parse="inward"}
    {exp:stash:append_list name='featured_article'}
        {stash:item_count}{count}{/stash:item_count}
        {stash:item_type}{cf_news_article_type}{/stash:item_type}
        {stash:item_title}{title}{/stash:item_title}
    {/exp:stash:append_list}
    {exp:stash:set_value name="featured_article_id" value="{entry_id}" type="snippet"}
{/exp:channel:entries} 
```

然后，当您找到其余新闻时，只需忽略您已经隐藏的特色文章：

```
{!-- find the rest of the news --}
{exp:channel:entries channel="news" orderby="date" sort="desc" dynamic="no" limit="12" entry_id="not {featured_article_id}" parse="inward"}
    {exp:stash:append_list name='recent_articles'}
        {stash:item_count}{count}{/stash:item_count}
        {stash:item_type}{cf_news_article_type}{/stash:item_type}
        {stash:item_title}{title}{/stash:item_title}
    {/exp:stash:append_list}
{/exp:channel:entries} 
```

（我不确定您是否会遇到解析顺序问题`{featured_article_id}`，但如果是这样，应该有办法解决）

或者，如果您不介意所有精选新闻文章都在列表顶部，您可以使用`orderby="cf_news_article_type|date"`, 然后使用`limit=""`and`offset=""`将第一篇新闻文章从列表中删除。

**更新：**您也可以反过来执行此操作，并在检索列表时检查 entry_id：

```
<article class="major-feature">
    {exp:stash:get_list name="recent_articles" match="#mj#" against="item_type" limit="1" parse_tags="yes"}
        {exp:stash:set_value name="featured_article_id" value="{entry_id}" type="snippet"}
        {sn_news_story}
    {/exp:stash:get_list}
</article> 

<section class="featured-stories">
    <h1>Featured stories</h1>
    {exp:stash:get_list name="recent_articles" match="#(mj|gf)#" against="item_type" limit="3" parse_tags="yes"}
        {if "{entry_id}" != "{featured_article_id}"}
            {sn_news_story}
        {/if}
    {/exp:stash:get_list}
</section> 
```

# python - DateTimeField上的Django时间不一致

> ID：13168099
> 
> 赞同：0
> 
> 时间：2012-10-31T22:02:44.720
> 
> 标签：python, django

我有下一个模型：

```
class People(models.Model):
    name = models.CharField(max_length=100)
    lastname = models.CharField(max_length=100)
    _date=models.DateTimeField() 
```

在views.py

- 当我尝试这个时：

```
p = People(name='foo', lastname='bar', _date=datetime.now())
p.save() 
```

它返回当前时间：`2012-10-31 17:33:10.152323`

但是，当我检查我的数据库中的这条记录时，它显示：

```
name lastname _date 
foo   bar      2012-10-31 21:33:10 
```

为什么会发生这种情况（两个不同的时间）？

编辑：（相差4小时）：`2012-10-31 17:33:10.152323 and 2012-10-31 21:33:10`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:02:29.577

Django 使用时区存储`DatetimeFields`到您的数据库中。这就是您`TIME_ZONE`在设置中提供 a 的原因。

您可以在此处阅读有关此内容的更多信息：[https ://docs.djangoproject.com/en/dev/topics/i18n/timezones/](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/)

如果你想为你的字段提供一个非天真的日期时间，你必须使用：

```
now = datetime.utcnow().replace(tzinfo=timezone('Your/Timezone')) 
```

时区可以在这里找到：[http ://en.wikipedia.org/wiki/List_of_tz_zones_by_name](http://en.wikipedia.org/wiki/List_of_tz_zones_by_name)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-15T05:42:14.193

即使我也面临同样的问题。这是因为根据 django 文档

> 当启用对时区的支持时，Django 以 UTC 格式将日期时间信息存储在数据库中，在内部使用时区感知的日期时间对象，并在模板和表单中将它们转换为最终用户的时区。

解决此问题的方法是编写一个函数，将存储在数据库中的时间转换为本地时间。

```
from django.utils import timezone
import pytz

def get_localtime(utctime):
    utc = utctime.replace(tzinfo=pytz.UTC)
    localtz = utc.astimezone(timezone.get_current_timezone())
    return localtz 
```

现在你可以

```
now = get_localtime(datetime.now())
p = People(name='foo', lastname='bar', _date=now)
p.save() 
```

# java - 这个程序的逻辑有什么问题？

> ID：13168103
> 
> 赞同：-1
> 
> 时间：2012-10-31T22:03:01.747
> 
> 标签：java

我对这段代码有疑问。它是一个程序的一部分，用于计算您在某些计算器上称为 nPr 的值。它编译时没有错误，但每次我运行它并设置 n = 0 时，我都会得到一个看似无穷无尽的错误消息列表。为什么它不能打印出“错误！” 并像我编写的那样终止程序？

```
{
    System.out.print("n = ");
    int n = j.nextInt();
    System.out.print("r = ");
    int r = j.nextInt();
    long n_fact = factorial(n);
    if ( ( (n - r) <= 0 ) || (n <= 0) || (r < 0) )
    {
        System.out.println("Error!");
        System.exit(0);
    }
    else
    {
        long nr_fact = factorial(n - r);
        long nPr = n_fact / nr_fact;
        NumberFormat f = NumberFormat.getNumberInstance();
        System.out.println("nPr = " + f.format(nPr));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:05:25.797

您`factorial(n)`在检查是否`n > 0`. 移动线

```
long n_fact = factorial(n); 
```

到`else`块内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:06:35.027

**将此行移动到`else`块中：**

```
 long n_fact = factorial(n); 
```

因为它被触发了`even when n=0 or n < 0`，因为你`n > 0`在上面的调用之后检查，这是你不想要的。**我怀疑 this(n <=0) 是否在您的`factorial()`方法中得到正确处理。**

`n`或者，在您的方法中进行检查和处理，`factorial(n)`即如果 n=0，则返回 1，如果 n < 0，则返回错误（抛出异常）；

# c# - 将 jabber-net 与 Unity3d 集成的内部编译器错误

> ID：13168104
> 
> 赞同：5
> 
> 时间：2012-10-31T22:03:10.210
> 
> 标签：c#, xmpp, unity3d

将 jabber-net dll 从[这里](http://code.google.com/p/jabber-net/downloads/list)导入我的项目并运行后

```
using UnityEngine;
using System.Collections;
using jabber;
using jabber.client;
using jabber.connection;

public class XMPP : MonoBehaviour {

    jabber.client.JabberClient jC;

        // Use this for initialization
        void Start () {
        jC = new JabberClient();
    }
} 
```

Unity 抱怨：

> 内部编译器错误。有关更多信息，请参阅控制台日志。输出为：未处理的异常：System.TypeLoadException：无法从程序集“jabber-net，版本=2.1.0.710，文化=中性，PublicKeyToken=924c5b18328d6f09”加载类型“jabber.connection.XmppStream”。

我读过其他人（极少数人）已经设法将 jabber-net 与他们的 Unity 代码集成。任何人都可以阐明如何做到这一点或将我指向一个替代图书馆吗？我非常希望能够在我的项目中使用 XMPP。

谢谢

*编辑*

感谢@Calvin 提供有用的回复并帮助我深入研究问题。

解决步骤：

1.  剥离 System.Drawing 和 System.Windows.Form 后在 monodevelop 中编译 dll（将构建目标更改为库而不是可执行文件）
2.  导入 Plugins 文件夹中的 dll（不是随机文件夹）
3.  将 Unity 构建目标更改为 Net 2.0（不是 Net 2.0 子集）并指示它剥离字节码
4.  删除 SystemAssemblies 文件夹以强制重新编译

*验尸*

而且......这种方法似乎最终失败了。编译到 ios 似乎用 ExecutionEngineException: Attempting to JIT compile method '(wrapper managed-to-native) System.Threading.Interlocked:CompareExchange (jabber.protocol.ProtocolHandler&,jabber.protocol.ProtocolHandler,jabber.protocol. ProtocolHandler)' 使用 --aot-only 运行时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T16:18:23.847

我只是能够在 MonoDevelop 中编译 2005-jabber-net 解决方案并将其添加到 Unity 3.5.6 项目中，而 Unity 不会生成编译器错误。

该解决方案引用了 Unity 不支持的 System.Drawing 和 System.Windows.Forms。我删除了这些，将编译目标更改为“库”，并将 2005-jabber-net.dll、netlib.Dns.dll 和 zlib.net.dll 复制到 Unity 项目中。

您的示例代码在附加到游戏对象时编译并运行，但我没有进一步测试。

编辑：刚刚意识到这个程序集可能需要 Unity Pro，因为 .Net 套接字访问在 Unity 的免费版本中受到限制。

双重编辑：我收回了这一点，刚刚检查了他们的产品比较表，现在 .Net 套接字在 Unity 的免费版本中列为可用。

# c# - 如何在起订量中调试验证？

> ID：13168106
> 
> 赞同：4
> 
> 时间：2012-10-31T22:03:14.423
> 
> 标签：c#, .net, unit-testing, moq, autofixture

我正在为数据库调用方法使用 IDatabase 类附带的 NPoco。我想验证进入 NPoco Insert 方法的对象是否具有正确的数据（以域对象的形式）。

```
 public interface IUnitOfWorkProvider
    {
        IUnitOfWork GetUnitOfWork();
    }

    public interface IUnitOfWork : IDisposable 
        {
            void Commit();
            IDatabase Db { get; }
            void SetOneTimeCommandTimeout(int timeout);
            void SetGlobalCommandTimeout(int timeout);
        }
    public interface IDatabase : IDatabaseQuery
    {
        IDbConnection Connection { get; }
        IDbTransaction Transaction { get; }

        void AbortTransaction();
        void BeginTransaction();
        void BeginTransaction(IsolationLevel? isolationLevel);
        void CompleteTransaction();
        IDataParameter CreateParameter();
        int Delete(object poco);
        int Delete<T>(object pocoOrPrimaryKey);
        int Delete<T>(Sql sql);
        int Delete<T>(string sql, params object[] args);
        int Delete(string tableName, string primaryKeyName, object poco);
        int Delete(string tableName, string primaryKeyName, object poco, object primaryKeyValue);
        void Dispose();
        Transaction GetTransaction();
        Transaction GetTransaction(IsolationLevel? isolationLevel);
        object Insert(object poco);
        object Insert(string tableName, string primaryKeyName, object poco);
        object Insert(string tableName, string primaryKeyName, bool autoIncrement, object poco);
        void Save(object poco);
        void Save(string tableName, string primaryKeyName, object poco);
        IDatabase SetTransaction(IDbTransaction tran);
        int Update(object poco);
        int Update<T>(Sql sql);
        int Update(object poco, IEnumerable<string> columns);
        int Update(object poco, object primaryKeyValue);
        int Update<T>(string sql, params object[] args);
        int Update(object poco, object primaryKeyValue, IEnumerable<string> columns);
        int Update(string tableName, string primaryKeyName, object poco);
        int Update(string tableName, string primaryKeyName, object poco, IEnumerable<string> columns);
        int Update(string tableName, string primaryKeyName, object poco, object primaryKeyValue);
        int Update(string tableName, string primaryKeyName, object poco, object primaryKeyValue, IEnumerable<string> columns);
    }

 // my test class file
 private IFixture fixture;
  private Mock<IUnitOfWork> unitOfWork;
  private MyService myService;
     private Mock<IDatabase> database; // new based on responses

    [SetUp]
        public void Setup()
        {
            fixture = new Fixture().Customize(new AutoMoqCustomization());
 database = fixture.Freeze<Mock<IDatabase>>();// new based on responses 
            unitOfWork = fixture.Freeze<Mock<IUnitOfWork>>();
            myService = fixture.CreateAnonymous<MyService>();
        }

        [Test]
        public MyTest()
        {       
              // fails
            unitOfWork.Setup(x => x.Db.Insert(It.IsAny<MyDomainObject>()));
            myService.CallMyMethod();
            unitOfWork.Verify(x => x.Db.Insert(It.IsAny<MyDomainObject>()));

            // fails
            unitOfWork.Setup(x => x.Db.Insert(It.IsAny<object>()));
            myService.CallMyMethod();
            unitOfWork.Verify(x => x.Db.Insert(It.IsAny<object>()));
// fails (this was a try based on responses)
 database.Setup(x => x.Insert(It.IsAny<object>()));       
 myService.CallMyMethod();        
 database.Verify(x => x.Insert(It.IsAny<object>()));

            // passes
            unitOfWork.Setup(x => x.Db.Insert(It.IsAny<object>()));
            myService.CallMyMethod();
            unitOfWork.Verify();
        }

public class MyDomainObject
{
   public void Id {get; set;}
} 
```

被调用的代码（什么应该触发验证）

```
 using (var unitOfWork = unitOfWorkProvider.GetUnitOfWork())
            {
       MyDomainObject myDomain = anotherService.getMyDomain(DateTime.Now, 100);
       unitOfWork.Db.Insert(myDomain); 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T05:03:51.913

[SUT](http://en.wikipedia.org/wiki/System_Under_Test)中的代码使用 IUnitOfWorkProvider 来生成 IUnitOfWork：

```
using (var unitOfWork = unitOfWorkProvider.GetUnitOfWork())
{
    MyDomainObject myDomain = anotherService.getMyDomain(DateTime.Now, 100);
    unitOfWork.Db.Insert(myDomain); 
} 
```

您当前尝试模拟的 IUnitOfWork 实例是其他一些实例。它们不是由这个 IUnitOfWorkProvider 生成的。

假设 IUnitOfWorkProvider 被注入到您的 SUT 中，您应该能够冻结它并从那里开始。像这样的东西应该可以工作：

```
var fixture = new Fixture().Customize(new AutoMoqCustomization());
var uowProviderStub = fixture.Freeze<Mock<IUnitOfWorkProvider>>();
var uowMock = fixture.CreateAnonymous<Mock<IUnitOfWork>>();
var sut = fixture.CreateAnonymous<MyService>();

uowProviderStub.Setup(p => p.GetUnitOfWork()).Returns(uowMock.Object);
uowMock
    .Setup(x => x.Db.Insert(It.IsAny<MyDomainObject>()))
    .Verifiable();

// etc. 
```

That's all a bit of a bother, which is really the test trying to tell you that the [Law of Demeter violation](http://en.wikipedia.org/wiki/Law_of_Demeter) is not the best of designs...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:10:31.107

你需要让你的模拟调用可验证

```
unitOfWork
    .Setup(x => x.Db.Insert(It.IsAny<MyDomainObject>()))
    .Verifiable(); 
```

# android - Getting NullPointerException Using Robolectric to Unit Test Android Activity

> ID：13168109
> 
> 赞同：1
> 
> 时间：2012-10-31T22:03:24.600
> 
> 标签：android, junit, robolectric

I am developing an Android app with several Activity classes. I am using Robolectric for unit testing. In the test setup I call onCreate(null) in the Activity being tested:

```
@Before
public void setUp() throws Exception {
    activity = new StartARound();
    activity.onCreate(null);
    btnSelectCourse = (Button) activity.findViewById(com.catalyst.golfapp.R.id.btnSelectCourse);
    btnAddACourse = (Button) activity.findViewById(com.catalyst.golfapp.R.id.btnAddACourse);
    btnShowLocation = (Button) activity.findViewById(com.catalyst.golfapp.R.id.btnShowLocation);
    textView1 = (TextView) activity.findViewById(com.catalyst.golfapp.R.id.textView1);
} 
```

The problem is, the onCreate method for the Activity I'm testing calls:

```
getActionBar().setDisplayHomeAsUpEnabled(true); 
```

Execution of this line of code produces a java.lang.NullPointerException error and the tests do not run. Any ideas, or additional code you'd like to examine?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T01:50:48.910

`getActionBar()`未在最新版本的 Robolectric 中实现。

这是 ShadowActivity 的源文件： [https ://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowActivity.java](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowActivity.java)

此 API 可用于查看您何时使用 robolectric 中不存在的功能：http://pivotal.github.com/robolectric/javadoc/com/xtremelabs/robolectric/Robolectric.html#logMissingInvokedShadowMethods [()](http://pivotal.github.com/robolectric/javadoc/com/xtremelabs/robolectric/Robolectric.html#logMissingInvokedShadowMethods())

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-08T02:10:06.727

顺便说一句，`getActionBar()`不推荐使用。而是使用包含较新操作栏的 Android-AppCompat-v7。你可以使用它`getSupportActionBar()`

# java - 在来自 Java 的 Cypher 查询中指定参数

> ID：13168111
> 
> 赞同：0
> 
> 时间：2012-10-31T22:03:34.570
> 
> 标签：java, neo4j, cypher

我正在使用来自 Java 的嵌入式 Neo4j 数据库。给定一个属性值对（例如，（'id'，'29384234'），我想使用 Cypher 找到相应的唯一节点。我查看了[Neo4j 文档](http://docs.neo4j.org/chunked/stable/cypher-query-lang.html)中的一些示例，但所有示例都假设一些静态 id 或键值对来标识起始节点。Cypher Java API 描述了该[`execute(String query,Map<String,Object> params)`](http://components.neo4j.org/neo4j-cypher/1.8/apidocs/index.html#execute%28java.lang.String,%20java.util.Map%29)方法，但没有给出任何示例。

查询中如何引用参数值？

或者，在给定唯一标识节点的（属性名称，值）对的情况下，是否有更好的方法来获取单个节点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:14:01.893

这太明显了：答案在[参数](http://docs.neo4j.org/chunked/stable/cypher-parameters.html)页面上。

# sql - JDOQL：如何执行“创建用户”？

> ID：13168112
> 
> 赞同：0
> 
> 时间：2012-10-31T22:03:56.623
> 
> 标签：sql, datanucleus, jdoql

我正在尝试在 DataNucleus 中使用 JDOQL 创建一个用户（在这种情况下使用 H2 数据库）

```
PersistenceManager pm=pmf.getPersistenceManager();
Query query = pm.newQuery("javax.jdo.query.SQL", "CREATE USER GUEST PASSWORD 'abc'");
query.execute(); 
```

结果：**org.h2.jdbc.JdbcSQLException：方法只允许用于查询。使用 execute 或 executeUpdate 而不是 executeQuery**；

我该如何执行？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:25:19.650

您是否尝试设置 pmf 属性？datanucleus.query.sql.allowAll=true

您可以尝试的另一种方法是：

```
JDOConnection con = pm.getDataStoreConnection();
Connection nativeCon = (Connection) con.getNativeConnection();
...
Statement stmt = nativeCon.createStatement();
stmt.executeUpdate("CREATE USER GUEST PASSWORD 'abc'");
... 
```

# python - 二分查找功能

> ID：13168114
> 
> 赞同：0
> 
> 时间：2012-10-31T22:04:04.070
> 
> 标签：python, algorithm, search, binary, binary-search

晚上好。我正在尝试重新开始编程，并决定在自己的时间做一些练习编码。我目前正在尝试实现二进制搜索，但我的代码中似乎存在一个连续循环。有人可以告诉我发生了什么吗？

```
def binChop(key, ordered_set):

    found = False
    newSet = ordered_set

    while found != True or newSet > 0:
        midpoint = int(len(newSet)/2)
        if key < newSet[midpoint]:
            found = False
            newSet = newSet[:midpoint]
        elif key > newSet[midpoint]:
            found = False
            newSet = newSet[midpoint:]
        elif key==newSet[midpoint]:
            found = True
    return found 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:11:17.803

我认为您的问题出在 while 循环的条件下。你有一个“或”而不是一个“和”——这意味着即使你找到了你的结果，newSet>0 条件也会得到满足。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:12:57.450

我怀疑“newSet > 0”总是正确的。如果它是一个标准的 python 集，你会得到一个错误：

```
>>> b=set()
>>> b
set([])
>>> b > 0
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: can only compare to a set 
```

但既然你没有，我猜这是一个列表或元组：

```
>>> a=[]
>>> a > 0
True
>>> b=()
>>> b > 0
True 
```

两者都没有达到您的预期（检查长度）。

通常，添加`import pdb; pdb.set_trace()`到代码中并单步执行以查找错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T05:47:24.063

您有一些问题，其中一些可以改进：

*   当元素不在有序列表中时，您需要左右边界索引才能正确执行二进制搜索。[在此处](http://en.wikipedia.org/wiki/Binary_search_algorithm)查看正确的算法。当您找到您的键或左边界在右边界的右侧或反之亦然 ( `max_point < min_point`) 时，您将退出 while 循环。
*   你不需要`newSet`. 您始终可以在排序列表中使用索引。所以 mid_point 只是一个索引，`min_point`（左边界）和`max_point`（右边界）也是如此。
*   二进制搜索通常返回键的索引作为返回值。如果没有找到，返回`-1`。

我的python代码如下所示：

```
def binChop(key, ordered_list):

    min_point, max_point = 0, len(ordered_list)-1

    while min_point <= max_point:
        mid_point = (min_point+max_point)/2

        if ordered_list[mid_point] < key:
            min_point += 1
        elif ordered_list[mid_point] > key:
            max_point -= 1
        else:
            return mid_point
    return -1

test_cases = [[], [5], [4,5], [5,6], [1,5,6], [1], [1,4], [1,6,15]]
for ordered_list in test_cases:
    print "%-10s %5s" % (ordered_list, binChop(5, ordered_list)) 
```

* * *

```
Outputs:
list       index of 5
[]            -1
[5]            0
[4, 5]         1
[5, 6]         0
[1, 5, 6]      1
[1]           -1
[1, 4]        -1
[1, 6, 15]    -1 
```

# php - 我收到此错误代码：为 foreach() 提供的参数无效

> ID：13168120
> 
> 赞同：6
> 
> 时间：2012-10-31T22:04:40.557
> 
> 标签：php, sql, pdo

我正在学习 PDO，我很困惑，我在下面有这段代码，对我来说一切正常，但是我收到了这个错误代码，我不知道该怎么做才能修复它，请帮助我：

```
<?php
$hostname='localhost';
$username='root';
$password='';

try {
    $dbh = new PDO("mysql:host=$hostname;dbname=stickercollections",$username,$password);
    echo 'Connected to Database<br/>';

    $sql = "SELECT * FROM stickercollections";
foreach ($dbh->query($sql) as $row)
    {
    echo $row["collection_brand"] ." - ". $row["collection_year"] ."<br/>";
    }

    $dbh = null;
    }
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
?> 
```

* * *

**错误代码**

```
Invalid argument supplied for foreach() in /Applications/XAMPP/xamppfiles/htdocs/GOTSWAPMAIN/index.php on line 11 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-31T22:23:05.737

尝试增加错误模式：

```
<?php
$hostname='localhost';
$username='root';
$password='';

try {
    $dbh = new PDO("mysql:host=$hostname;dbname=stickercollections",$username,$password);

    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); // <== add this line
    echo 'Connected to Database<br/>';

    $sql = "SELECT * FROM stickercollections";
foreach ($dbh->query($sql) as $row)
    {
    echo $row["collection_brand"] ." - ". $row["collection_year"] ."<br/>";
    }

    $dbh = null;
    }
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
?> 
```

**编辑：** [pdo.error-handling](http://www.php.net/manual/en/pdo.error-handling.php)说，您可以选择使用[pdo.errorcode](http://www.php.net/manual/en/pdo.errorcode.php)和[pdostatement.errorcode](http://www.php.net/manual/en/pdostatement.errorcode.php)（或类似）来获取更多信息，但我认为抛出异常是处理不良连接的更好方法，而不是解决主机等。

# c# - 如何提示用户输入值以响应 RightTapped 事件？

> ID：13168121
> 
> 赞同：0
> 
> 时间：2012-10-31T22:04:45.283
> 
> 标签：c#, gridview, windows-8

当用户右键单击或点击`GridView`. 我怎么做？我是否需要创建一个自定义`user control`或者有什么方法可以使用`Popup`它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:42:01.167

查看包含轻量级弹出控件的[Callisto 库。](https://github.com/timheuer/Callisto)

# android - 无 GPS 时 OSMdroid 默认起始位置

> ID：13168124
> 
> 赞同：0
> 
> 时间：2012-10-31T22:05:03.067
> 
> 标签：android, map, gps, osmdroid

我正在制作一个使用 OSMdroid 地图的应用程序。我希望地图的中心是用户所在的位置。到目前为止，这在 GPS 开启时有效，但我也想确保默认中心，以防 GPS 不工作/关闭。我通过关闭设备上的 GPS 来测试我的代码。她是我自己尝试的代码，但如果 GPS 关闭，地图的中心将被放置在海洋中央。

```
 myLocationoverlay = new MyLocationOverlay(this, osmv);
    myLocationoverlay.enableMyLocation(); 
    myLocationoverlay.disableCompass();
    myLocationoverlay.enableFollowLocation();
    myLocationoverlay.setDrawAccuracyEnabled(true);
    myLocationoverlay.runOnFirstFix(new Runnable() {
    public void run() {
    if (myLocationoverlay.getMyLocation() != null){ 
            // go to MyLocation
            osmv.getController().animateTo(myLocationoverlay
                    .getMyLocation());
        }
        else {
        }
        //go to NYcenter
        osmv.getController().animateTo(new GeoPoint(40714200, 74006400));   

        } 
```

设置默认开始位置的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:29:07.873

代码看起来不错，但你的坐标是错误的。尝试替换`osmv.getController().animateTo(new GeoPoint(40714200, 74006400));` 为`osmv.getController().animateTo(new GeoPoint(40714200, -74006400));`

# ruby - 保存 ActiveRecord 对象数组？

> ID：13168131
> 
> 赞同：0
> 
> 时间：2012-10-31T22:05:46.073
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.1

在我看来，我这样做：

```
<table border="1">
 <tr>
    <th>Question</th>
    <th>Counter</th>
    <th>Lastsent</th>
    <th>Email</th>
  </tr>
<% @email_stats.each do |email_stat| %>
<% post = Post.find(email_stat.postId) %>
  <% if post.posttype == 'Question' %>
  <tr>
    <td><%= post.question %></td>
    <td><%=  email_stat.counter%></td>
    <td><%= email_stat.lastsent %></t>
    <td><%=  text_field_tag 'email', email_stat.email%></td>
  </tr>
  <%  end %>
 </table> 
```

这就是我所拥有的：对于某些对象，电子邮件将是“空白”，因此我想显示表中的所有记录并允许主持人输入电子邮件并单击保存存储它。

我用过`form_for`，但它只用来保存一个对象。

将数组发送回服务器进行保存的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T05:35:44.783

我认为您可以使用 ajax 以便使用 jquery 序列化表中的数据并将数据发布回服务器端。所以你可以保存数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T13:54:29.673

可以通过使用 form_tag 而不是 form_for 来实现预期的行为。例子

```
<%= form_tag :url => , :html => {:id=> , :method => , :class => ""} do %>
  <% text_field_tag <id>, <default_value>, :name=>"post[question]" %>
  <% text_field_tag <id>, <default_value>, :name=>"email_stat[counter]" %>
  <% text_field_tag <id>, <default_value>, :name=>"email_stat[last_sent]" %>
  <% text_field_tag <id>, <default_value>, :name=>"email_stat[email]" %>
  <%= submit_tag 'save' %>
<% end %> 
```

然后参数将很好地分组在一个哈希中

```
{'post' => {'question' => 'xxx' }, 'email_stat' => {'counter' => 'xxx' , 'last_sent' =>  'xxx', 'email' => 'xxx'}} 
```

您可以对其进行解析以更新两个模型。您需要做的就是正确命名 text_field。

# regex - Matlab分割字符串多个分隔符

> ID：13168138
> 
> 赞同：9
> 
> 时间：2012-10-31T22:06:28.277
> 
> 标签：regex, string, matlab, split, tokenize

我有一个像这样的字符串的单元格列表：

```
cellArr = 
      'folderName_fileName_no.jpg',
      'folderName2_fileName2_no2.jpg' 
```

我想像这样得到它

```
{folderName, fileName, no},
{folderName2, fileName2, no2} 
```

在matlab中怎么做？我知道我可以使用

```
regexp(cellArr, '_', 'split'), 
```

但是如何使用多个分隔符？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T22:23:21.853

找到了。。谢谢回复。。

```
regexp(cellArr, '[_.]', 'split') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:08:44.143

它与字符串标记化的 C 方法非常相似。使用`strtok`，您可以根据您选择的任何分隔符进行标记（在您的情况下为 '_' ）

[STRTOK 参考](http://www.mathworks.com/help/matlab/ref/strtok.html)

请注意，您将使用 C 习惯用法`strtok`在循环中重复调用其剩余字符串，因为它每次只返回第一个标记。参考文献中给出了一个例子。

要回答您的编辑：

> 对字符串元胞数组使用 strtok 会返回令牌中的字符串元胞数组和剩余字符数组：

```
s = {'all in good time'; ...
 'my dog has fleas'; ...
 'leave no stone unturned'};

remain = s;

for k = 1:4
   [token, remain] = strtok(remain);
   token
end 
```

直接来自参考中的示例 3。< 为了使其非常明显，您只需替换`strtok(remain)`并`strtok(remain,REQUIRED_DELIMITERS)`添加简单的逻辑来删除文件扩展名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-27T07:11:29.213

使用以下方法也很有用`strsplit`：

```
cellArr = 
      'folderName_fileName_no.jpg',
      'folderName2_fileName2_no2.jpg'

C = strsplit(cellArr,'_') 
```

那么 C 是一个包含三个向量的元胞数组。还有`filepath`是否需要删除不必要的部分，例如扩展。`strsplit`如果需要，也可以与 Regex 一起使用！

# css - 是否可以使用 -webkit-filter: blur(); 在背景图像上？

> ID：13168142
> 
> 赞同：34
> 
> 时间：2012-10-31T22:06:51.537
> 
> 标签：css

是否可以`-webkit-filter: blur();`在背景图像上使用？

我已经尝试过这段代码，它只是模糊了除背景图像之外的所有内容：

```
body {
  background-image: url('http://www.publicdomainpictures.net/pictures/10000/velka/pebbles-and-sea-11284647414Rbeh.jpg');
  background-attachment: fixed;
  -webkit-filter: blur(5px);
} 
```

我已经搜索了一段时间，但找不到任何描述如何执行此操作的资源。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-08-11T02:23:28.943

***未来用户*：IE7、IE8、IE9、IE10、IE11 或当前版本的 EDGE 不支持此功能。**

**不要在真实网站上使用，除非您有备用方案。**

如果您正在寻找不依赖额外标记的解决方案，您可以将背景图像和过滤器应用于正文上的伪元素。

```
body {
    position: absolute;
    top: 0; bottom: 0; left: 0; right: 0;
    height: 100%;
}
body:before {
    content: "";
    position: absolute;
    background: url(http://lorempixel.com/420/255);
    background-size: cover;
    z-index: -1; /* Keep the background behind the content */
    height: 20%; width: 20%; /* Using Glen Maddern's trick /via @mente */

    /* don't forget to use the prefixes you need */
    transform: scale(5);
    transform-origin: top left;
    filter: blur(2px);
} 
```

看看[这个 JsFiddle](http://jsfiddle.net/juanojeda/T5j6H/1/)。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-31T22:23:32.493

不要将其应用于正文，将其应用于如下全尺寸容器，将容器大小和位置设置为绝对，然后将其余内容设置为相对并设置 z-indexes。

```
​&lt;body>
<div class="bgImageContainer">
</div>
<div class="content"> Some text and stuff here</div>
</body>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

```
.bgImageContainer{
    background-image:url('http://www.whitegadget.com/attachments/pc-wallpapers/16950d1224057972-landscape-wallpaper-blue-river-scenery-wallpapers.jpg'); 
    width:500px;
    height:400px;
    -webkit-filter: blur(5px);
    z-index:0;
    position:absolute;
}
.content{
    z-index:10;
    position:relative;
} 
```

编辑 - 更新了小提琴，旧图像不再起作用。

[http://jsfiddle.net/Yr2zD/1130/](http://jsfiddle.net/Yr2zD/1130/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-08-29T07:16:49.677

> 如果整页的背景，那么这对我来说是最好的解决方案。

```
body {
    //background-color: black;  use it if you don't want the background border
}
body:before {
    content: '';
    position: fixed;
    width: 100vw;
    height: 100vh;
    background-image: url('http://www.publicdomainpictures.net/pictures/10000/velka/pebbles-and-sea-11284647414Rbeh.jpg'); // your image
    background-position: center center;
    background-repeat: no-repeat;
    background-position: 100% 100%;
    background-size: cover;
    filter: blur(2px);
    z-index: -9;
} 
```

# c# - 主服务器宕机

> ID：13168145
> 
> 赞同：4
> 
> 时间：2012-10-31T22:06:57.243
> 
> 标签：c#, exception

我正在制作一个程序，帮助办公桌工作人员在我的大学里检查和检查设备。我可以使用 Enviroment.username，但作为一种学习体验，我想获取当前登录用户的全名。按下 windows 按钮时看到的用户名。所以我目前的游戏测试代码是：

```
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);
UserPrincipal user = UserPrincipal.Current;
string displayName = user.DisplayName;
Console.WriteLine(displayName);
Console.ReadLine(); 
```

但它给了我一个主服务器关闭异常。我想这是权限问题，但我什至不知道从哪里开始。

我该怎么做才能让它发挥作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:35:59.877

如果您的意图是显示当前用户的属性...

`UserPrincipal.Current`抓取`Principal`正在运行的当前线程。如果这是有意的（例如使用模拟），那么您应该手头有用户数据，并且根本不需要设置主体上下文。

```
var up = UserPrincipal.Current;
Console.WriteLine(user.DisplayName); 
```

但是，如果运行线程的主体不是您想要的用户，并且您需要从域（即 SLaks 点）收集他们的帐户信息，那么您需要设置主体上下文并搜索它以获取正确的 UserContext .

```
var pc = new PrincipalContext(ContextType.Domain, "domainName");
var user = UserPrincipal.FindByIdentity(pc, "samAccountName");
Console.WriteLine(user.DisplayName); 
```

`IdentityType`如果您不喜欢 samAccountName，也可以使用另一个：

```
var user = UserPrincipal.FindByIdentity(pc, IdentityType.Name, "userName");
// or
var user = UserPrincipal.FindByIdentity(pc, IdentityType.Sid, "sidAsString"); 
```

如果您需要先手动验证用户身份，请参阅**@DJKRAZE 的**示例使用`principalContext.ValidateCredentials()`

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:14:51.500

你有没有想过尝试这样的事情

```
bool valid = false;
using (var context = new PrincipalContext(ContextType.Domain))
{
    valid = context.ValidateCredentials(username, password);
} 
```

如果您想更深入地了解，可以在下面执行此操作

```
using System.Security;
using System.DirectoryServices.AccountManagement;

public struct Credentials
{
    public string Username;
    public string Password;
}

public class Domain_Authentication
{
    public Credentials Credentials;
    public string Domain;
    public Domain_Authentication(string Username, string Password, string SDomain)
    {
        Credentials.Username = Username;
        Credentials.Password = Password;
        Domain = SDomain;
    }

    public bool IsValid()
    {
        using (PrincipalContext pc = new PrincipalContext(ContextType.Domain, Domain))
        {
            // validate the credentials
            return pc.ValidateCredentials(Credentials.Username, Credentials.Password);
        }
    }
} 
```

# python - Askbot - 没有名为 xdg.Config 的模块

> ID：13168146
> 
> 赞同：1
> 
> 时间：2012-10-31T22:07:02.910
> 
> 标签：python, django, centos, askbot

我已经安装了 Python 2.7.3 + Django 1.3.1 + Askbot 和[这些要求](https://github.com/ASKBOT/askbot-devel/blob/master/askbot_requirements.txt)

当我在端口 8000 上运行我的服务器并尝试与浏览器建立连接时，我遇到了这个不寻常的错误：***无法导入 myapp01.deps.django_authopenid.views。错误是：没有名为 xdg.Config* 的模块**。

回溯输出为： http: [//pastebin.com/4uzbWvR0](http://pastebin.com/4uzbWvR0)

我的操作系统是 CentOS 6.3，所有的安装都是由 Puppet 自动化和管理的。

有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:15:02.010

我猜你需要安装[`xdg`](http://freedesktop.org/wiki/Software/pyxdg)模块：

```
pip install pyxdg 
```

# asp.net - 使用 jQuery.ajax (500) 将字符串发布到 WCF 服务端点

> ID：13168149
> 
> 赞同：0
> 
> 时间：2012-10-31T22:07:25.463
> 
> 标签：asp.net, ajax, json, wcf, web-services

这个问题已经在许多帖子中以类似的方式提出，但没有可行的解决方案。

我的服务端点`ManagerDiscountService`如下所示：

```
[ServiceBehavior]
[ServiceContract(Namespace = "Cart")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class ManagerDiscountService : CartService

    [OperationContract]
    // also tried [WebInvoke(RequestFormat=WebMessageFormat.Json)]
    // also tried [WebInvoke(RequestFormat=WebMessageFormat.Json, Method="POST")]
    public MyObject ToggleMode(string userId, string pwd, string domain) 
```

网络配置：

```
<service name="Cart.ManagerDiscountService">
    <endpoint address="" behaviorConfiguration="Item.ItemAspNetAjaxBehavior"
     binding="webHttpBinding" bindingConfiguration="wsSecureHttp" 
     contract="Cart.ManagerDiscountService" />
</service>
<!-- tried adding a similar wsHttp binding since the POST is not SSL, no luck --> 
```

我正在尝试将`userId`,`pwd`和发布`domain`到这个端点，但我看到的只有 500 个。*为什么这种发布方法不起作用*？当我在 Chrome 中调试时，`error`总是下一次执行`$.ajax`：

```
params = { "userId": "user", "pwd": "password", "domain": "mydomain" };
$.ajax({
    type: "POST",
    url: "/Ajax/Cart/ManagerDiscountService.svc/ToggleMode",
    dataType: "json",
    data: JSON.stringify(params, null, null),
    contentType: "application/json; charset=utf-8",
    success: function (data) {
        // ...
    },
    error: function() {
        // ...
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T10:54:28.413

我猜你只需要一个uri模板。我在这里编辑了你的代码：
`[OperationContract]
[WebGet(UriTemplate="ToggleMode?userId={userId}&pwd={pwd}&domain="{domain}", ResponseFormat=WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]`

where 方法看起来像：
`MyObject ToggleMode(string userId, string pwd, string domain);`

此外，您的 ajax 调用 url 看起来像：
`url: "/Ajax/Cart/ManagerDiscountService.svc/ToggleMode?userId=uid&pwd=pwd&domain=domain",`
然后您不需要在 ajax 调用中设置“数据”......看看这是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T10:06:59.257

Try using code as follows:

```
params = { "userId": "user", "pwd": "password", "domain": "mydomain" };
$.ajax({
    type: "POST",
    url: "/Ajax/Cart/ManagerDiscountService.svc/ToggleMode",
    dataType: "json",
    data: JSON.stringify(params),
    contentType: "application/json; charset=utf-8",
    success: function (data) {
        // ...
    },
    error: function() {
        // ...
    }
}); 
```

also for what you are passing extra two null parameters to the contract.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T14:13:16.993

::sigh:: 已通过将`wsSecureHttp`绑定替换为`wsHttp`

```
<endpoint address="" behaviorConfiguration="Item.ItemAspNetAjaxBehavior"
 binding="webHttpBinding" bindingConfiguration="wsHttp" 
 contract="Cart.ManagerDiscountService" /> 
```

# windows-phone-8 - Windows Phone 8 游戏开发

> ID：13168151
> 
> 赞同：0
> 
> 时间：2012-10-31T22:07:28.530
> 
> 标签：windows-phone-8

我现在正在安装适用于 WP8 的 SDK，并且有几个问题。XNA 似乎受支持，但仅限于传统模式。所以对于游戏的东西，我假设你可以选择基于 XAML，......什么，它仍然是 Silverlight 吗？如果游戏是 3D 或图形密集型游戏，那么它是 C++ 和 Direct X 吗？

那里有用于游戏的托管 Direct X 的 C# 选项吗？

还是一些 XAML + DirectX 组合？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T23:13:15.440

> 那里有用于游戏的托管 Direct X 的 C# 选项吗？

不。*（或者好吧，[SharpDX](http://www.sharpdx.org/news/new-version-2-4-0)现在可用于 WP8）*

> 还是一些 XAML + DirectX 组合？

你不想走那条路。如果您想创建游戏，请坚持使用 DirectX 和 C++。Silverlight 强制 60 FPS，这对于电池寿命来说是可怕的，如果用于渲染游戏或视频，设备会变得异常热。

# c# - 声明数组长度时的C#Wpf datagrid问题

> ID：13168153
> 
> 赞同：1
> 
> 时间：2012-10-31T22:07:36.430
> 
> 标签：c#, wpf, arrays, datagrid

为了清楚起见，我有 3 个数组。ArrX, ArrY, ArrZ

这些将被放入数组中：GridArr

我想做的是一个 wpf 应用程序，它将收集信息，将所需信息分类为 Arr1、Arr2 和 Arr3。将它们放在 GridArr 中。所以它可以被加载到数据网格中。用户可以编辑然后将更改后的值放入它曾经来自的同一数组中。（ArrX、ArrY、ArrZ）

数据网格可视化示例：

```
Test    | Dest    | Testy
ArrX[0] | ArrY[0] | ArrZ[0]
ArrX[1] | ArrY[1] | ArrZ[1]
ArrX[2] | ArrY[2] | ArrZ[2] 
```

ArrX 将值放入测试中。ArrY to Dest 等。

问题是我必须声明 GridArr 的大小。我创建了一个函数来为 GridArr 返回正确的大小，但是我无法在不必将数组放入类中（没有出错）的情况下声明它，如果 GridArr 在类中，我不知道我应该怎么做设法将新用户编辑的值放入 ArrX、ArrY 和 ArrZ。

```
 string[] ArrX = { "test", "", "asd" };
    int[] ArrY = { 1, 2, 3 };
    int[] ArrZ = {111, 2212, 32323};

    private LootData[] GridArr = new LootData[ArrX.Length]; /* Error occurs.
    What should I do to declare it´s length without writing for example 3 */

    public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
            GridArr[0] = new LootData(ArrX[0], ArrY[0], ArrZ[0]);//Code LootData below
            GridArr[1] = new LootData(ArrX[1], ArrY[1], ArrZ[1]);
            GridArr[2] = new LootData(ArrX[2], ArrY[2], ArrZ[2]);

            dataGrid1.ItemsSource = null;
            dataGrid1.ItemsSource = arr;
    } 
```

LootData 类，以防有人想知道后面的内容。

```
class LootData
{
    private string name;
    private int dest;
    private int id;

    public LootData(string Name, int Dest, int Id)
    {
        name = Name;
        dest = Dest;
        id = Id;
    }

    public string Name 
    {
        get { return name; } 
        set { name = value; } 
    }

    public int Dest
    {
        get { return dest; }
        set { dest = value; }
    }

    public int Id
    {
        get { return id; }
        set { id = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:20:15.130

`GridArr`在构造函数或按钮事件处理程序中初始化字段

```
private LootData[] GridArr;

public MainWindow()
{
    InitializeComponent();
    GridArr = new LootData[ArrX.Length];//ArrX.Length is accessible now
} 
```

# windows - 通过 RGBA 的 X11 窗口透明度是否可以通过 Cygwin/X 在 Windows 7 上工作？

> ID：13168154
> 
> 赞同：1
> 
> 时间：2012-10-31T22:07:45.120
> 
> 标签：windows, cygwin, x11

我想在 Windows 7 上的 Cygwin/X 上运行一个使用 RGBA 的具有任意形状透明区域的 X11 程序（以便这些区域下方的任何内容都显示出来）。

这可能吗？如果是这样，它是有效的，即透明度以某种方式（或以其他方式）映射到 Windows 对不透明度或透明度键的类似支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:15:18.253

是的，这是可能的。

您可能希望查看非常实验性的[XtoW](http://cygwin.com/ml/cygwin-xfree-announce/2012-12/msg00003.html)合成 WM。

这是“高效”的，因为带有 alpha 通道的 X 窗口图像被简单地绘制到本机窗口中。

# c# - 以后如何使用 linq 延迟执行为每个项目执行自定义函数？

> ID：13168156
> 
> 赞同：2
> 
> 时间：2012-10-31T22:07:51.517
> 
> 标签：c#, linq

我有一个：

```
public Dictionary<string,BaseModel> data  { get; set; } 
```

我想实现与我现在正在工作的这段代码的等效，仅使用 Linq 延迟执行。

```
foreach (KeyValuePair<string, BaseModel> item in data)
{
   T model = (T)item.Value; //each item needs to be cast to T, T inherits from BaseModel
   model.Init(this, personId); //Init is a function I wrote I want to call on each item
   l.Add(model); //currently I am adding each item to a list, but IEnumerable<T> can work
} 
```

我开始编写如下代码：

```
IEnumerable<T> l = Cache[type].Data.Cast<T>()
                                   .Select(item => item); 
```

但我不知道如何在每个项目上调用 Init 函数（每个模型都有一个，它们都继承自 BaseModel）。我一直在阅读有关谓词代表之类的内容，但找不到如何执行类似（pseduocode）的示例：

```
IEnumerable<T> l = Cache[type].Data.Cast<T>()
                                   .Select(item => item)
                                   .RunMeOnEachItemLater(InitWrapperDelegate); 
```

如果您想知道这是做什么用的，我有一个 MVC 项目，并且我正在实现一个模型数据缓存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:15:59.673

不。强烈建议以*函数*式风格使用 LINQ - 您的谓词不应有副作用。这正是因为延迟执行——这意味着您传递给 LINQ 方法的 lambda 表达式只有在需要时才会执行，如果有的话。

如果您想确保在您的元素上调用某些副作用，请`IEnumerable`使用`foreach`：

```
foreach (var model in Cache[type].Data.Select(i=>i.Value).Cast<T>()) {
    model.Init(...);
} 
```

即使那样，如果您需要知道已初始化的对象，我也会考虑将 LINQ 表达式的结果缓存在字段或变量中：

```
var models = Cache[type].Data.Select(i=>i.Value).Cast<T>().ToArray();
foreach (var model in models) {
    ...
} 
```

这样做的原因`IEnumerable`是不能保证每次枚举时都返回相同的项目。显然，如果底层类型是一个集合，它会，但如果你知道它是你应该使用`ICollection`而不是`IEnumerable`来表达它。

如果您不能使`Init`幂等性以便每次从缓存中获取内容时都可以重新执行，那么您可能应该在将模型添加到缓存时初始化模型，或者以其他方式清理它们的生命周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:14:33.533

你可以使用这样的[`List(T).ForEach`](http://msdn.microsoft.com/en-us/library/bwabdf9z%28v=vs.100%29.aspx)方法：

```
var l = Cache[type].Data.Cast<T>().ToList().ForEach(InitWrapperDelegate); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T22:49:12.780

为什么不将您的伪代码转换为真实代码？

```
public static class MyExtensions
{
  public static IEnumerable<T> RunMeOnEachItemLater(this IEnumerable<T> sequence,
                                                    Action<T> action)
  {
      foreach(T item in sequence)
      {
         action(item);
         yield return item;
      }
  }
} 
```

现在，您可以稍后使用 LINQ 延迟执行为每个项目执行自定义函数：

```
IEnumerable<BaseModel> l = Cache[type].Data.Cast<BaseModel>()
                                           .RunMeOnEachItemLater(m => m.Init()); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-31T22:14:12.530

等效的功能是：

```
var list = data.Values.Cast<T>()
    .Select(x=>
    {
        x.Init(this, personId); 
        return x;
    })
    .ToList(); 
```

请注意，您可以删除`.ToList()`以返回 an`IEnumerable<T>`并且`Init`在枚举列表时稍后会运行调用。

# .htaccess - 重定向错误的网址

> ID：13168159
> 
> 赞同：0
> 
> 时间：2012-10-31T22:08:13.997
> 
> 标签：.htaccess

我想将所有错误请求重定向到我识别的另一个 url。例如，如果用户输入`http://www.mywebsite.com/unavailablepage.html`，他不会得到 404 页面，而是会被重定向到另一个 url。我怎么能在`.htaccess`文件中做到这一点？提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:15:36.340

`ErrorDocument 404 /your_page.html`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:19:29.640

将以下内容添加到您的 .htaccess 文件中，将 /404.php 更改为实际 404 页面的位置。

```
ErrorDocument 404 /404.php 
```

有关详细信息，请参阅[http://www.htaccessbasics.com/404-custom-error-page/ 。](http://www.htaccessbasics.com/404-custom-error-page/)

# javascript - 除了单击菜单外，如何隐藏菜单

> ID：13168160
> 
> 赞同：0
> 
> 时间：2012-10-31T22:08:27.227
> 
> 标签：javascript, jquery, html, events

我有一个链接，它是个人用户名。单击它时，会出现一个小弹出窗口（无序列表）。我正在努力做到这一点：

1.  单击人员用户名将弹出 ul 切换为淡入/淡出
2.  如果您单击以显示弹出窗口，然后单击 ul，它不会消失
3.  如果您单击除弹出按钮以外的任何地方的主体，它就会消失

这就是我到目前为止所拥有的，但我基本上只是在自欺欺人地认为我知道自己在做什么:(

```
$(document).ready(function() {
    $('.flyout h3 a').click(function() {
        var flyout = $('.flyout ul');
        flyout.fadeToggle(80,function() {
            if ( flyout.is(':visible') ) {
                console.log('visible');
                $(document).on('click',function(e) {
                    flyout.fadeOut(80);
                    e.stopPropagation();
                });
            } else {
                $(document).off('click');
            }
        });
    });
}); 
```

html:

```
<div class="flyout">
                <h3>Welcome back, <a href="#">Dogbreath</a><img src="img/down-arrow.png" alt="dropdown"></h3>
                <div class="menu">
                    <ul>
                        <li><a href="#"><span class="icon">&#128101;</span>Users</a></li>
                        <li><a href="#"><span class="icon">&#128360;</span>Groups</a></li>
                        <li><a href="#"><span class="icon">&#9881;</span>Configuration</a></li>
                        <li><a href="#"><span class="icon">&#59201;</span>Logout</a></li>
                    </ul>
                </div>
            </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:20:18.183

你试图在回调函数中做太多`fadeToggle()`

试试这样的东西（未经测试）

```
$flyout = $('.flyout ul');
$('.flyout h3 a').click(function() { $flyout.fadeToggle(80) } 
```

这负责在单击用户名时隐藏/显示菜单，不是吗？

然后，分别独立地绑定事件`document`（这可能需要一些调整）

```
// any click on document element that isn't a child of flyout, closes flyout
$(document).on('click',function(e) { if ($(e.target).parents($flyout).length == 0 $flyout.fadeOut() }); 
```

# sql-server-2008 - “基础提供程序在打开时失败”实体框架错误

> ID：13168166
> 
> 赞同：3
> 
> 时间：2012-10-31T22:09:16.083
> 
> 标签：sql-server-2008, entity-framework, sql-server-express

我收到错误“底层提供程序在打开时失败”。最近，我一直在拔头发试图找出原因。仔细检查错误，内部异常是“连接未关闭。连接的当前状态为正在连接。” 堆栈跟踪是

```
"at System.Data.ProviderBase.DbConnectionClosedConnecting.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Data.EntityClient.EntityConnection.OpenStoreConnectionIf(Boolean openCondition, DbConnection storeConnectionToOpen, DbConnection originalConnection, String exceptionCode, String attemptedOperation, Boolean& closeStoreConnectionOnFailure)" 
```

据我所知，错误似乎是随机发生的，或者可能是在对应用程序进行更改时发生的。任何帮助将不胜感激。

我目前的设置是

*   IIS 快递
*   Microsoft SQL Server 速成版
*   视觉工作室 2012
*   MVC Web API \ Asp.net MVC 4
*   实体框架 5

我的数据层是根据存储库模式建模的，并通过结构图注入。

**存储库**

```
public class Repository<T> : IDisposable, IRepository<T> where T : class
{
    private readonly DbSet<T> _dbSet;
    private readonly DbContext _dbContext;

    public Repository(IDbContextFactory<MyContext> dbContextFactory)
    {
        _dbContext = dbContextFactory.Create();
        _dbSet = _dbContext.Set<T>();
    }

    //removed for brevitity

    public void Dispose()
    {
        _dbContext.Dispose();
    } 
```

**数据库上下文工厂**

```
public class MyContextFactor : IDbContextFactory<MyContext>, IDisposable
{
    private MyContext _dataContext;

    public MyContextFactor Create()
    {
        return _dataContext ?? (_dataContext = new MyContext());
    }

    public void Dispose()
    {
        _dataContext.Dispose();
    }
} 
```

**IOC 结构图注册表**

```
For(typeof(IDbContextFactory<MyContext>)).HybridHttpOrThreadLocalScoped().Use(typeof(MyContextFactory)); 
```

**连接字符串**

```
<add name="MyContextConnectionString" connectionString="metadata=res://*/Model.MyProject.csdl|res://*/Model.MyProject.ssdl|res://*/Model.MyProject.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=(local);initial catalog=MyDB;User Id=SQLUser;Password=****;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient"/> 
```

我试图解决问题但到目前为止还没有奏效的事情

*   通过结构映射范围确保上下文是每个 http 上下文
*   将 dispose 添加到存储库
*   向 ContextFactory 添加了 dispose
*   从集成 Sql 身份验证切换到 Sql 身份验证

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T02:48:36.490

结果证明这是一个被缓存的 ActionFilterAttribute。ActionFilterAttribute 有一个实体框架上下文，该上下文没有被正确处理，而是在请求之间共享。

# delphi - winapinameA vs winapinameW - Unicode vs Ansi - Delphi XE2

> ID：13168169
> 
> 赞同：1
> 
> 时间：2012-10-31T22:09:21.983
> 
> 标签：delphi, winapi, unicode, delphi-xe2, ansi

我正在使用 Delphi XE2 并从 Shell32.dll 导入 SHGetFolderPath。我正在运行 windows vista x64。运行 SHGetFolderPathA 时结果不清楚。

IE：

```
uses
  Windows;

function SHGetFolderPath(hwnd: Cardinal; csidl: Integer; hToken: Cardinal; dwFlags: Cardinal; pszPath: PChar): Cardinal; stdcall;external 'Shell32.dll' name 'SHGetFolderPathA';

Var
  Path:Array [0..MAX_PATH] of Char;
  AppData:String;

begin
  SHGetFolderPath(0,$001A,0,0,@path[0]);
  MessageBox(0,Path,'a',0);
end. 
```

结果是：

![在此处输入图像描述](../Images/755f45c1211e6c4572f868ea07a7ca9f.png)

与使用 SHGetFolderPathW 相比：

使用视窗；

```
function SHGetFolderPath(hwnd: Cardinal; csidl: Integer; hToken: Cardinal; dwFlags: Cardinal; pszPath: PChar): Cardinal; stdcall;external 'Shell32.dll' name 'SHGetFolderPathW';

Var
  Path:Array [0..MAX_PATH] of Char;
  AppData:String;

begin
  SHGetFolderPath(0,$001A,0,0,@path[0]);
  MessageBox(0,Path,'a',0);
end. 
```

结果清楚地说明了我的 AppData 文件夹的路径，没有问题。

当使用 SHGetFolderPathA 在 x32 Vista 上运行相同的代码时，效果很好。

如果有人可以阐明这是为什么？我的印象是“W”api通常用于Unicode机器......？

* * *

编辑：

我现在正在使用以下代码，但出现相同的错误：

```
uses
  Windows;

function SHGetFolderPath(hwnd: HWND; csidl: Integer; hToken: THandle; dwFlags: DWord; pszPath: PAnsiChar): HRESULT; stdcall; external 'SHFolder.dll' name 'SHGetFolderPathA';

var
  path: array[0..MAX_PATH] of char;
begin
  SHGetFolderPath(0,$001A,0,0, @path[0]);
  MessageBox(0,path,'a',0);
end. 
```

* * *

最终编辑：

谢谢大家的回复。SHGetFolderPath 的上述声明很好。在查看了所有回复并获取了每个回复中的信息后，我得出了以下结果：

```
uses
  Windows;

function SHGetFolderPath(hwnd: HWND; csidl: Integer; hToken: THandle; dwFlags: DWord; pszPath: PAnsiChar): HRESULT; stdcall; external 'shell32.dll' name 'SHGetFolderPathA';

var
  path: array[0..MAX_PATH] of ansichar;
  xRes:String;
begin
  If SHGetFolderPath(0,$001A,0,0, @path[0]) = S_OK Then Begin
    xRes := Path;
    MessageBox(0,PWideChar(xRes),'Result',0);
  End Else
    MessageBox(0,'An error has occurred.','Result',0);
end. 
```

生成的消息框正确显示了我的 AppData 路径的路径。

再次感谢所有回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:19:13.920

您将 的最终参数声明`SHGetFolderPath`为具有 type `PChar`。在 Delphi 2009 及更高版本（包括您的版本 Delphi XE2）中，`PChar`是 的别名`PWideChar`，但您告诉 Delphi 将您声明的函数链接到需要`AnsiChar`字符的“A”版本。

在声明对字符类型敏感的函数时，我建议完全不要使用`PChar`。显式使用`PWideChar`或`PAnsiChar`。

“A”和“W”后缀与程序在哪种*机器*上运行无关。*现在所有*受支持的 Windows 版本都是 Unicode——最后一个非 Unicode 版本是 Windows ME。“A”和“W”是指参数的字符类型。

至于为什么你的代码在 32 位版本的 Vista 上运行，而在 64 位版本上失败，我没有解释。也许您很幸运，操作系统进行了一些转换，在您的情况下碰巧可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:16:29.893

`Char`在 XE2 中是 Unicode，但是您正在导入 Ansi 版本`SHGetFolderPath()`并将 Unicode 输出缓冲区传递给它。这就是您`MessageBox()`显示垃圾的原因 - 它试图在 Unicode 对话框中显示 Ansi 数据。您需要导入 Unicode 版本`SHGetFolderPath()`：

```
uses
  Windows;

function SHGetFolderPath(hwnd: HWND; csidl: Integer; hToken: THandle; dwFlags: DWord; pszPath: PWideChar): HRESULT; stdcall; external 'SHFolder.dll' name 'SHGetFolderPathW';

var
  path: array[0..MAX_PATH] of Char;
begin
  SHGetFolderPath(0, $001A, 0, 0, path);
  MessageBox(0, path,'a', 0);
end. 
```

顺便说一句，XE2 已经为您导入了 Ansi 和 Unicode 版本`SHGetFolderPath()`，并定义了 CSIDL 值，因此您无需手动执行：

```
uses
  Windows, ShlObj, SHFolder;

var
  path: array[0..MAX_PATH] of Char;
begin
  SHGetFolderPath(0, CSIDL_APPDATA, 0, 0, path);
  MessageBox(0, path, 'a', 0);
end. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:01:06.553

在你的代码中我看到~~两个错误~~一个错误：

~~- “路径”被声明为局部变量（即在堆栈上），因此它包含“随机”/陈旧数据。建议用零初始化：fillChar(path[0], sizeOf(path), #0)~~

*   SHGetFolderPath 是一个函数。它返回一个值。您永远不会测试函数的结果以查看它是否退出 - 您只是输出“路径”变量的内容。但是如果 SHGetFolderPath 由于某种原因失败了，内容是否有意义？

# jquery - TypeError: f[s] 不是 jquery 表单提交的函数

> ID：13168171
> 
> 赞同：15
> 
> 时间：2012-10-31T22:09:23.577
> 
> 标签：jquery, function, submit, typeerror

我试图让表单以迂回的方式提交，因为我需要它在提交之前附加新的输入。由于在实际的 $(form).submit() 函数中添加附加内容不会收集它们以进行发布，因此我添加了一个 html 按钮来调用 submitCheck()，然后提交实际函数。

```
function init() {
  $("#submit").click(submitCheck);
  //and lots of other stuff
}

function submitCheck() {
    //go through fabric canvases, save xml to input.
    for (var i=1; i<probNum; i++) {
        var csvg = gcanvas[i].toSVG();
        $('#output').append("<input type='hidden' name='svg"+probNum+"' value='"+csvg+"'></input>");
    }
    //make sure a topic was selected. If not cancel submission and don't do anything.
    if ($("#topic").val() == '-1') 
    {
        $('#error').html("You must select a valid topic");
    } else {
        //submit the form
        alert('should submit now');
        $("form:first").submit();
    }
} 
```

但是......它失败了，抛出了类型错误：

```
TypeError: f[s] is not a function 
```

我没有找到关于这个特定错误的文档。有任何想法吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-31T22:15:28.147

您的表单中有一些输入`name="submit"`，它覆盖了`form.submit`在 jQuery 内部调用的本机（以编程方式提交表单）方法。您需要将其更改为其他名称。

[请参阅文档](http://api.jquery.com/submit/#entry-longdesc)中的附加说明段落。

您还可以使用[DOMLint](http://kangax.github.com/domlint/)查看其他可能的冲突问题。

# php - MVC - Codeigniter - 视图与模型对话

> ID：13168174
> 
> 赞同：2
> 
> 时间：2012-10-31T22:09:29.760
> 
> 标签：php, codeigniter, database-abstraction

在我在 StackOverflow 上看到的围绕 MVC 架构的大多数帖子中，人们都说模型应该只从控制器进行通信，而不是从视图进行通信。

我对此有点困惑，因为当您使用 Google MVC 时： - [http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller) - [http://i.msdn。 microsoft.com/dynimg/IC108622.gif](http://i.msdn.microsoft.com/dynimg/IC108622.gif) 图形似乎表明存在从视图直接到模型的通信。

我想知道的具体应用程序是一个 Ajax/jQuery 分层选择框，就像这里的[http://kotowicz.net/jquery-option-tree/demo/demo.html](http://kotowicz.net/jquery-option-tree/demo/demo.html)一样。每次选择后，我都在考虑从模型中获取下一个框的数据。我正在使用 Codeigniter 框架。

就在这里的最佳实践进行了一些专业知识之后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:25:52.100

当你有一个以 XHR 为中心的应用程序时，实际上有两个 MVC 三元组是有意义的。一个用于前端，一个用于后端。前端会将后端 MVC 仅视为数据源（与后端模型层中的数据抽象结构处理数据库、缓存和其他形式的存储的方式相同）。

基本上，您的“ajax 应用程序”不是*view*。它应该是一个完全实现的应用程序。当然，如果您实际上是在创建一个大型 XHR 驱动的应用程序，那么这样做是有意义的。

通常，您在浏览器中看到的不是视图。这只是视图创建的响应。在 web 上下文中，**MVC 应用程序的用户是 web-browser**。

* * *

![在此处输入图像描述](../Images/f08601f3f52018374a45f0990b2c4e2e.png) [来源：[维基百科](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)]

上图表示[经典 MVC](http://www.itu.dk/courses/VOP/E2005/VOP2005E/8_mvc_krasner_and_pope.pdf)和 Model2 MVC *（也称为“Web MVC”）*中的简化信息流。它们之间的区别来自网络的本质：每次用户发送输入时，它都希望收到响应。这意味着时间上没有歧义。MVC 三元组的所有部分仅在发送响应之前存在。没有观察模型层的观点。

Web 应用程序中的 View 实际上是实例，它包含所有 UI 逻辑并负责将响应发送到浏览器。它创建的响应可以是 HTML（由多个模板组合而成）、JSON 或 XML 文件。或者可能只是 HTTP 位置标头。

> [**PS**您可能会发现[此答案](https://stackoverflow.com/a/5864000/727208)与您的学习相关。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T04:21:05.987

我认为第二个链接上的图像是错误的，因为正确的方法应该是控制器与模型通信。如果视图与模型直接通信，则表示html代码与php大语句混合，这是错误的。

# sql - 创建自动过期登录的 SQL 脚本

> ID：13168175
> 
> 赞同：1
> 
> 时间：2012-10-31T22:09:31.820
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005, login

如何编写创建新 SQL 登录的脚本（无论是通过 Windows 身份验证还是使用 SQL 密码）并让它在一段时间后自动过期，例如 8 小时、24 小时

我试过在 stackoverflow 中搜索，但没有找到解决方案。如果你们知道这里存在一个，也请告诉我。谢谢你。

我正在使用 SQL Server 2005 和 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:53:25.720

首先创建一个表来存储自动过期的登录信息

```
create table master.dbo.logins(
    id int identity primary key clustered,
    login_name sysname not null unique,
    valid_from datetime not null,
    valid_to datetime not null,
    check (valid_from < valid_to)
)
GO 
```

创建一个 SERVER LEVEL LOGON 触发器来捕获和阻止特殊登录。 **请注意**，我专门测试了前缀`XPR`作为约定，因为如果您的 LOGON 触发器错误，修复起来很不方便。

```
CREATE TRIGGER deny_expired_logins
ON ALL SERVER
with execute as 'sa'
FOR LOGON
AS
BEGIN
    if original_login() like 'XPR%' and not exists (
        select *
          from master.dbo.logins
        where login_name = original_login()
          and GETDATE() between valid_from and valid_to)
        rollback
END
GO 
```

当您需要创建新登录时，请记住在表中插入一条记录。

```
create login XPR00001 with password = 'ABCD1234..';
insert master.dbo.logins select 'XPR00001', getdate(), dateadd(hh,8,getdate()); 
```

# prolog - 在单独的行中打印矩阵

> ID：13168178
> 
> 赞同：2
> 
> 时间：2012-10-31T22:10:01.180
> 
> 标签：prolog

我想打印矩阵，每一行在单独的行中，例如

```
?- print_matrix([[a,b,c],[d,e,f]]). 
```

我想得到

```
[a,b,c]
[d,e,f] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:14:05.453

```
?- maplist(\X^(writeq(X),nl),[[a,b,c],[d,e,f]])。
[a,b,c]
[d,e,f]
真的。

```

使用[库（lambda）](http://www.complang.tuwien.ac.at/ulrich/Prolog-inedit/lambda.pl)。或者：

```
写qln（X）：-
   写q（X），
   荷兰语

?- maplist(writeqln,[[a,b,c],[d,e,f]])。

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:16:31.733

最简单的方法是在递归规则中使用`write`and ，如下所示：`nl`

```
print_matrix([]).
print_matrix([H|T]) :- write(H), nl, print_matrix(T). 
```

这是用于列表处理的“经典”Prolog 解决方案，其中包含处理空列表的事实和逐个处理标题元素的规则。

# visual-studio-2010 - 使用 MSBuild 构建具有多个环境的解决方案

> ID：13168180
> 
> 赞同：0
> 
> 时间：2012-10-31T22:10:09.843
> 
> 标签：visual-studio-2010, msbuild

我们有一个构建在 AnyCPU 中的解决方案，我们构建在 x64 机器上。它包含几个引用 Silverlight SDK（仅针对 x86）的项目。当我们在 Visual Studio 2010 中构建解决方案时，一切正常。

我们正在尝试自动化构建，当我们在该解决方案文件上触发 msbuild 时，依赖 Silverlight SDK 的两个项目都无法构建，而其他 50 个左右的项目构建得很好。如果我调用 devenv.exe 来构建解决方案，它会构建整个解决方案（如我所料）。

我想我可以创建某种构建文件来解决这个问题，但我宁愿不必在现有解决方案文件之外维护另一个构建文件。有没有办法告诉 msbuild 在没有单独的构建文件的情况下为每个项目构建“正确”的环境？

如果不是，那么我认为 msbuild 构建文件基本上只是 .proj 文件。是否有比[MSBuild 参考](http://msdn.microsoft.com/en-us/library/5dy88c2e%28v=vs.100%29.aspx)更好的配置参考，或者这真的是最无用的起点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T01:44:18.243

如果没有更多关于您看到的确切错误的详细信息，我猜您遇到了这个问题，因为 64 位版本的 msbuild 正在您的构建服务器上运行。由于 Visual Studio 2010 是 32 位的，因此您不会在此处看到此问题。

要让团队构建使用 32 位 msbuild，请将构建配置中高级下的进程选项卡上的 MSBuild 平台设置设置为 X86。

您的其他项目仍然可以以 AnyCPU 为目标，甚至可以以 x64 为目标，但除非您知道自己需要它，否则不建议这样做，并且可以正常编译。

有用的图片[在这里](http://blogs.msdn.com/b/jamlew/archive/2010/01/22/64-bit-team-build-fails-on-silverlight-projects-and-how-to-fix-it.aspx)。

更多信息可以在这里找到接近[这篇文章](http://blogs.msdn.com/b/msbuild/archive/2010/05/07/building-on-cross-targeting-scenarios-and-64-bit-msbuild.aspx)的底部。

希望这可以帮助。

# javascript - EmberJS 路由器 connectOutlets firstObject 绑定似乎没有传播

> ID：13168182
> 
> 赞同：2
> 
> 时间：2012-10-31T22:10:13.247
> 
> 标签：javascript, html, ember.js

访问关联的 DS.model 到 DS.model 时似乎存在绑定问题`array.firstObject`。所以下面小提琴中的路径是，`App.person.parties.firstObject`但它似乎没有正确绑定。`App.person.parties`绑定OK，可以在插座中使用，但`firstObject`似乎从来没有工作过。有任何想法吗？

另外，我认为这不是最好的方法`nextParty`-如果有人可以就如何构建它提供一些建议，将不胜感激！

[http://jsfiddle.net/mJ7q7/5/](http://jsfiddle.net/mJ7q7/5/)

JS：-

```
/* Flip this switch to compare. You should see 'Ember party' appear after 2s when it works */
var works = true;

window.App = Em.Application.create({

    ready: function() {            
        App.set('person', App.store.find(App.Person, 1));                        
    },

    ApplicationView: Em.View.extend({templateName: 'application'}),
    ApplicationController: Em.Controller.extend(),

    Router: Em.Router.extend({

        root: Em.Route.extend({

            index: Em.Route.extend({

                route: '/',
                connectOutlets: function(router, context) {

                    router.get('applicationController').connectOutlet('dashboard', App.get('person'));
                    router.get('dashboardController').connectOutlet('nextParty', 'party',
                        App.get('person.nextParty')
                    );
                }
            })
        })
    }),

    DashboardController: Em.Controller.extend({}),

    DashboardView: Em.View.extend({
        templateName: 'dashboard'
    }),

    PartyController: Em.Controller.extend({}),
    PartyView: Em.View.extend({
        templateName: 'party'
    }),

    Party: DS.Model.extend({
        name: DS.attr('string') 
    }),

    Person: DS.Model.extend({
        firstName: DS.attr('string'),
        lastName: DS.attr('string'),
        parties: DS.hasMany('App.Party'),

        nextParty: function() { return this.get('parties.firstObject'); }.property('parties.firstObject')
    }),

    store: DS.Store.create({
        revision: 7,
        adapter: DS.Adapter.create({

            find: function(store, type, id) {

                if (type == 'App.Person') {

                    if (works) {

                         store.load(type, id, {
                            id: 1,
                            firstName: 'John',
                            lastName: 'Jackson',
                            parties: [99]   
                        });

                    } else {

                        setTimeout(function() {
                            store.load(type, id, {
                                id: 1,
                                firstName: 'John',
                                lastName: 'Jackson',
                                parties: [99]   
                            });
                        }, 1000);

                    }

                }
                if (type == 'App.Party') {
                    setTimeout(function() {
                        store.load(type, id, {
                            id: 99,
                            name: 'Ember party'  
                        });  
                    }, 2000);                            
                }
            }
        })
    })

}); 
```

模板： -

```
<script type="text/x-handlebars" data-template-name="application">
    <h1>Party app</h1>
    {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="dashboard">
    <h2>Hi {{content.firstName}} {{content.lastName}}</h2>
    <h3>Next party</h3>
    {{outlet nextParty}}
</script>

<script type="text/x-handlebars" data-template-name="party">

    {{content.name}}

</script>    ​  ​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:13:20.480

和`firstObject`属性`lastObject`不可绑定。您可以通过创建计算属性来规避它：

```
myFirstObject: function() {
  return this.get('content.firstObject');
}.property('content.[]') 
```

见[这里](http://codebrief.com/2012/03/eight-ember-dot-js-gotchas-with-workarounds/)。

# ios - 将一个 UIView 分割成多个 CALayers

> ID：13168184
> 
> 赞同：0
> 
> 时间：2012-10-31T22:10:30.263
> 
> 标签：ios, core-graphics

如何将 UIView 切片为多个 CAlayer，以便分别在每个切片上执行动画？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:44:21.190

我不知道您到底要做什么，但是您可以将该视图渲染为图像 (1)，从中裁剪出多个图像 (2) 并在它们上执行动画。

(1)[在 iOS 4 中将 UIView 内容保存为内部图像的实际大小（即放大内容以保存）](https://stackoverflow.com/questions/4213529/saving-uiview-contents-in-ios-4-with-real-size-of-the-images-inside-i-e-scale)

(2) [iPhone 4 (HD) 如何使用CGImageCreateWithImageInRect？](https://stackoverflow.com/questions/3150364/how-use-cgimagecreatewithimageinrect-for-iphone-4-hd)

# javascript - Javascript 在 IE9 中不起作用

> ID：13168188
> 
> 赞同：1
> 
> 时间：2012-10-31T22:10:44.100
> 
> 标签：javascript, internet-explorer-9

以下 javascript 在 IE9 中不起作用，但在 Firefox 中可以正常工作。知道如何解决这个问题吗？谢谢。

```
var element = e.srcElement || e.target;

if(element != null){
   if(element.tagName == "INPUT") {

   //alert("Before: " + element.getAttribute("type"));
   element.setAttribute("type", "password");
   //alert("After: " + element.getAttribute("type"));

  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:16:46.640

以下是一些注意事项：

```
 // ------------v---favor e.target
var element = e.target || e.srcElement;

// -----v---simple truthy test
if (element){
  // ------------v---------v---- use nodeName, and toUpperCase() for safety
    if (element.nodeName.toUpperCase() == "INPUT") {

           // Not all IE respects the changing of the "type" on an input
        element.setAttribute("type", "password");

    } 
} 
```

我认为`tagName`IE9 中的表示可能已经改变。使用`nodeName` *应该*保证大写字符，但有几个罕见的错误需要避免，所以我们使用`toUpperCase()`.

过去，IE 不允许更改元素`"type"`的。`input`如果在 IE9 中仍然是这种情况，那不是很重要，但肯定 IE8 和更低版本不允许这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T22:22:19.600

由于我发现一个合理的解决方案是用新元素替换元素，因此您可以使用以下内容：

```
var input = element;
var input2 = input.cloneNode(false);
input2.type = "password";
input.parentNode.replaceChild(input2, input); 
```

在这里找到[http://bytes.com/topic/javascript/answers/705445-dynamically-change-input-type-text-password](http://bytes.com/topic/javascript/answers/705445-dynamically-change-input-type-text-password)并稍作修改。另一个解决方案是使用`createElement`而不是克隆，但这可能需要更多的工作。

编辑：

忘了提到问题似乎是IE不喜欢在`type`将元素包含在DOM中后动态更改它的属性。

# xquery - XQuery，检查元素是否为空？

> ID：13168191
> 
> 赞同：0
> 
> 时间：2012-10-31T22:11:03.483
> 
> 标签：xquery

如何检查节点中是否没有文本？我可以使用 string($node)="" 因为节点可以是这样的

```
<node>              </node> 
```

我的意思是，它可以包含空格但不能包含文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:57:17.740

我们被这件事抓住了，在检查节点是否真的有文本时，空格和换行符让我们有些悲伤。最后，我们创建了一个函数来检查元素的文本节点，并检查这些文本节点是否包含任何单词字符。这是它的样子：

```
some $child in $node/text() satisfies (fn:matches($child, "\w+")) 
```

如果其中一个子文本节点有任何单词字符，我们将其定义为具有文本，当然如果它没有文本节点或具有没有单词字符的文本节点，我们将其定义为没有文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:15:01.857

看`fn:normalize-space`功能。

# android - 实施 9 个旧机器人薄片的问题

> ID：13168196
> 
> 赞同：1
> 
> 时间：2012-10-31T22:11:27.583
> 
> 标签：android, image, bitmap, illegalargumentexception

我是 android 的菜鸟，我正在尝试在我的应用程序中实现 9 Old Androids flakes 演示。但是，当我将图像资源从演示使用的图像更改为我选择的应用程序之一时，应用程序崩溃并说 IllegalArgumentException: width and height must be > 0\. 我的 logcat 说我 createscaledbitmap 和 createFlake 的行导致问题. 我迷失了为什么会发生这种情况，演示图像的宽度为 75 像素 x 90 像素，而我的图像的宽度为 166 像素 x 72 像素。任何帮助是极大的赞赏。

FLAKE VIEW CLASS（我创建 Flake 的地方）

```
void addFlakes(int quantity) {
    for (int i = 0; i < quantity; ++i) {
        flakes.add(Flake.createFlake(getWidth(), droid)); //This line causes exception
    }
    setNumFlakes(numFlakes + quantity);
}

/**
 * Subtract the specified number of droidflakes. We just take them off the end of the
 * list, leaving the others unchanged.
 */
void subtractFlakes(int quantity) {
    for (int i = 0; i < quantity; ++i) {
        int index = numFlakes - i - 1;
        flakes.remove(index);
    }
    setNumFlakes(numFlakes - quantity);
}

@Override
protected void onSizeChanged(int w, int h, int oldw, int oldh) {
    super.onSizeChanged(w, h, oldw, oldh);
    // Reset list of droidflakes, then restart it with 8 flakes
    flakes.clear();
    numFlakes = 0;
    addFlakes(8); //This line causes exception
    // Cancel animator in case it was already running
    animator.cancel();
    // Set up fps tracking and start the animation
    startTime = System.currentTimeMillis();
    prevTime = startTime;
    frames = 0;
    animator.start();
} 
```

FLAKE CLASS（我在其中创建缩放位图）

```
static Flake createFlake(float xRange, Bitmap originalBitmap) {
    Flake flake = new Flake();
    // Size each flake with a width between 5 and 55 and a proportional height
    flake.width = (int)(5 + (float)Math.random() * 50);
    float hwRatio = originalBitmap.getHeight() / originalBitmap.getWidth();
    flake.height = (int)(flake.width * hwRatio);

    // Position the flake horizontally between the left and right of the range
    flake.x = (float)Math.random() * (xRange - flake.width);
    // Position the flake vertically slightly off the top of the display
    flake.y = 0 - (flake.height + (float)Math.random() * flake.height);

    // Each flake travels at 50-200 pixels per second
    flake.speed = 50 + (float) Math.random() * 150;

    // Flakes start at -90 to 90 degrees rotation, and rotate between -45 and 45
    // degrees per second
    flake.rotation = (float) Math.random() * 180 - 90;
    flake.rotationSpeed = (float) Math.random() * 90 - 45;

    // Get the cached bitmap for this size if it exists, otherwise create and cache one
    flake.bitmap = bitmapMap.get(flake.width);
    if (flake.bitmap == null) {
        flake.bitmap = Bitmap.createScaledBitmap(originalBitmap, //This line causes exception
                (int)flake.width, (int)flake.height, true);
        bitmapMap.put(flake.width, flake.bitmap);
    }
    return flake;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T04:10:41.500

由于图像的宽度大于高度，因此您需要基本上反转这三行代码。

```
flake.width = (int)(5 + (float)Math.random() * 50);
float hwRatio = originalBitmap.getHeight() / originalBitmap.getWidth();
flake.height = (int)(flake.width * hwRatio); 
```

对此

```
flake.height = (int)(5 + (float)Math.random() * 50);
float hwRatio = originalBitmap.getWidth() / originalBitmap.getheight();
flake.width = (int)(flake.height * hwRatio); 
```

# php - 使用 CURL 从 URL 下载文件

> ID：13168198
> 
> 赞同：10
> 
> 时间：2012-10-31T22:11:35.443
> 
> 标签：php, curl, download

我尝试使用 php 脚本从如下 URL 下载文件：

```
http://www.xcontest.org/track.php?t=2avxjsv1.igc 
```

我使用的代码如下所示，但它只生成空的下载文件：

```
$DLFile= "testfile.igc";
$DLURL="http://www.xcontest.org/track.php?t=2avxjsv1.igc"; 
$fp = fopen ($DLFile, 'w+');
$ch = curl_init($DLURL);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_FILE, $fp);
curl_exec($ch);
curl_close($ch);
fclose($fp); 
```

另一个奇怪的事情是在网络浏览器中输入 URL 时，我没有得到文件。我只能在单击[网站](http://www.xcontest.org/world/en/flights/detail:pepino/31.10.2012/07:20)上的链接时下载文件！。

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-31T22:37:15.153

试一试

```
<?php

    $output_filename = "testfile.igc";

    $host = "http://www.xcontest.org/track.php?t=2avxjsv1.igc";
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $host);
    curl_setopt($ch, CURLOPT_VERBOSE, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_AUTOREFERER, false);
    curl_setopt($ch, CURLOPT_REFERER, "http://www.xcontest.org");
    curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    $result = curl_exec($ch);
    curl_close($ch);

    print_r($result); // prints the contents of the collected file before writing..

    // the following lines write the contents to a file in the same directory (provided permissions etc)
    $fp = fopen($output_filename, 'w');
    fwrite($fp, $result);
    fclose($fp);
?> 
```

#

或者如果你想把它放在一个循环中来解析几个链接......你需要一些功能......这是一个粗略的想法......

```
<?php

    function collect_file($url){
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_VERBOSE, 1);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_AUTOREFERER, false);
        curl_setopt($ch, CURLOPT_REFERER, "http://www.xcontest.org");
        curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
        curl_setopt($ch, CURLOPT_HEADER, 0);
        $result = curl_exec($ch);
        curl_close($ch);
        return($result);
    }

    function write_to_file($text,$new_filename){
        $fp = fopen($new_filename, 'w');
        fwrite($fp, $text);
        fclose($fp);
    }

    // start loop here

    $new_file_name = "testfile.igc";
    $url = "http://www.xcontest.org/track.php?t=2avxjsv1.igc";

    $temp_file_contents = collect_file($url);
    write_to_file($temp_file_contents,$new_file_name)

    // end loop here
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-11-05T21:31:05.263

@Chris 的回答有效，但这似乎更适合下载非常大的文件而不会耗尽内存，因为它不会在写入磁盘之前将整个文件下载到变量中：

```
$file_url = 'http://www.test.com/images/avatar.png';
$destination_path = "downloads/avatar.png";

$fp = fopen($destination_path, "w+");

$ch = curl_init($file_url);
curl_setopt($ch, CURLOPT_FILE, $fp);
curl_exec($ch);
$st_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);
fclose($fp);

if($st_code == 200)
 echo 'File downloaded successfully!';
else
 echo 'Error downloading file!'; 
```

来源：[https ://www.kodingmadesimple.com/2018/02/php-download-file-from-url-curl.html](https://www.kodingmadesimple.com/2018/02/php-download-file-from-url-curl.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-15T14:03:19.200

在我这样做之前，我在使用 Curl 时出现了一些问题，使（文件下载对话框）出现：

```
// $ch = curl_init();
// curl_setopt($ch, CURLOPT_URL, $url); 
// Other Curl options ....
$output = curl_exec($ch);
if (isset($_POST["downloadExcelFile"])){ 
        // in my code the "downloadExcelFile" field
        // is sent when i'm trying to download an excel file
        header('Content-Type: application/vnd.ms-excel');
        header('Content-Disposition: attachment;filename="file.xls"');
        header('Cache-Control: max-age=0');
        $fp = fopen("php://output", 'w');
        fwrite($fp, $output );
        fclose($fp);
    } 
```

# sql - 如何对多个表使用子查询

> ID：13168200
> 
> 赞同：0
> 
> 时间：2012-10-31T22:11:39.673
> 
> 标签：sql, sql-server-2005

我正在尝试创建一个子查询以将两个表放在一起，但什么也没得到。

代码：

```
SELECT DISTINCT Agreements.AgrmntID, Agreements.Status, JobSites.SiteName,
  PurchaseOrderDetails.ExtCost
FROM Agreements Inner Join
  JobSites On Agreements.CustSiteID = JobSites.CustSiteID
WHERE Agreements.Status = 2 And PurchaseOrderDetails.ExtCost = (Select
    PurchaseOrderDetails.ExtCost
  FROM PurchaseOrderDetails 
  Inner Join PurchaseOrders On PurchaseOrders.POID = PurchaseOrderDetails.POID
  WHERE PurchaseOrders.Description Like ('%', JobSites.SiteName, '%') And   
  Convert(varchar(8),PurchaseOrderDetails.TimeCreated,1) = '09/10/12')
ORDER BY JobSites.SiteName 
```

预期输出：

```
AgreemntID   Status  SiteName  ExtCost
----------------------------------------
1            2       TEST01    $144.00
2            2       TEST02    $400.00 
```

我正在使用子查询，因为除了 PurchaseOrders 下的描述之外，没有任何东西可以将 ExtCost 链接到 SiteName。

希望这是足够的信息，可以帮助我。先感谢您！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:27:26.857

如果我认为我了解您要做什么，您可以像这样使用外部应用

```
SELECT DISTINCT A.AgrmntID, A.Status, JobSites.SiteName,
  PurchaseOrderDetails.ExtCost
FROM Agreements A 
Join JobSites J On J.CustSiteID = A.CustSiteID
OUTER APPLY(Select P.ExtCost From 
PurchaseOrders PO
JOIN PurchaseOrderDetails POD ON POD.POID = PO.POID
Where PO.Description Like ('%', JobSites.SiteName, '%') And   
  Convert(varchar(8),PurchaseOrderDetails.TimeCreated,1) = '09/10/12') POD
WHERE A.Status = 2 AND POD.ExtCost IS NOT NULL
ORDER BY JobSites.SiteName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:21:08.860

不确定这是否只是您编写问题时的拼写错误，但是在您的 SQL 中您指定了 Agreements.Status = 2 但在您的示例中您期望状态为 3 的结果？

否则，我将首先测试您的各个子查询以确保您的数据采用您期望的格式，例如尝试运行

```
Select
    PurchaseOrderDetails.ExtCost
  FROM PurchaseOrderDetails 
  Inner Join PurchaseOrders On PurchaseOrders.POID = PurchaseOrderDetails.POID
  WHERE PurchaseOrders.Description Like ('%', JobSites.SiteName, '%') And   
  Convert(varchar(8),PurchaseOrderDetails.TimeCreated,1) = '09/10/12' 
```

看看你得到了什么，等等。

# android - 使用画布和事件触摸在图像上绘制圆圈

> ID：13168209
> 
> 赞同：0
> 
> 时间：2012-10-31T22:12:03.563
> 
> 标签：android, android-layout

我正在制作一个应用程序，它在屏幕上绘制一个带有触摸事件的圆圈。下一个代码工作正常：

```
 Class Punto extends view{
   Paint paint;
   Point point = new Point();

 Public Punto(Context contex){
 super(context);
 }

 @Override
 protected void onDraw(Canvas canvas){
            super.onDraw(canvas);              
            paint.setColor(Color.BLUE);
            canvas.drawCircle(point.x,point.y,10,paint);
            }

 @Override
 public boolean onTouchEvent (MotionEvent event) {
        switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN :
                point.x = event.getX();
                point.y = event.getY();
                break;
        }
        return true;
    }

class Point{
   float x,y;
 } 
```

活动：

```
public class Pintar extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   Punto punto = new Punto(this);
   setContentView(punto);
} 
```

但是我需要将圆圈画在图片上（在我的情况下是市场飞机），但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:15:45.890

只需扩展一个 ImageView：

```
class Punto extends ImageView { 
```

* * *

对不起，我假设您发布的代码已编译...

尝试这个：

```
public class TouchImage extends ImageView {
    Paint paint = new Paint();
    Point point = new Point();

    public TouchImage(Context context, AttributeSet attrs) {
        super(context, attrs);
        paint.setColor(Color.BLUE);
    }

    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        canvas.drawCircle(point.x, point.y, 10, paint);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            point.x = event.getX();
            point.y = event.getY();
            invalidate();
        }
        return true;
    }

    class Point {
        float x, y;
    }
} 
```

使用这样的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

        <!-- Use your reverse package name, for instance "example.com" is -->  
    <com.example.TouchImage
        android:id="@+id/touchImage"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/map" />

</LinearLayout> 
```

以及一个在TouchImage被触摸时截取坐标的Activity：

```
public class Example extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        TouchImage touchImage = (TouchImage) findViewById(R.id.touchImage);
        touchImage.setOnTouchListener(new OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                // Call the existing onTouchEvent() in TouchImage,
                //   if it draws a circle fetch the coordinates
                if(v.onTouchEvent(event)) {
                    // Do something with event.getX(), event.getY()
                }
                return true;
            }
        });
    }
} 
```

# jquery - 如何使用 jQuery 读取多对象 JSON 字符串

> ID：13168212
> 
> 赞同：1
> 
> 时间：2012-10-31T22:12:29.807
> 
> 标签：jquery, arrays, json

挑战：如何读取/解析以下 json：

> ```
> > {"d":"{\"NewDataSet\":{\"Table\":{\"LICENSE_PLATE\":\"PLATE
> > 1\",\"PARKING_LOCATION\":\"1001\",\"START_TIME\":\"05:05:00\"}}}"} 
> ```

尝试的方法：

```
var objNDS = jQuery.parseJSON(e.d); //where e.d is the above returned json
var objTbl = objNDS.NewDataSet.Table;
var tblARR = [];
$.each(objTbl, function (i, val) {
  tblARR.push([val.LICENSE_PLATE, val.PARKING_LOCATION, val.START_TIME]);
}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:16:18.917

如图所示，您`Table`的 不是列表。Using`$.each`将遍历其键/值对，因此您将拥有：

```
i                 val
LICENSE_PLATE     PLATE1
PARKING_LOCATION  1001
START_TIME        05:05:00 
```

可能您的输入是错误的，而您的意思实际上是：

```
...\"Table\":[{\"LICENSE_PLATE\":...}, {\"LICENSE_PLATE\":...}]... 
```

如果输入正确，并且`Table`应该只有一个值，请不要直接使用`each`和查询`objTbl`：

```
tblARR.push([objTbl.LICENSE_PLATE, objTbl.PARKING_LOCATION, objTbl.START_TIME]); 
```

**更新：**如果两种形式都可以显示，只需测试是否`objTbl`是一个数组，如果不是，则包装它（理想情况下，您的服务器应该发送标准化的数据）。然后您的原始代码将按原样工作：

```
if ( !(objTbl instanceof Array) )
    objTbs = [objTbl];
$.each(objTbl, function(i, val) {
    tblARR.push([val.LICENSE_PLATE, val.PARKING_LOCATION, val.START_TIME]);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:04:26.530

我试图解释您要完成的工作，并将 JS fiddle 实现放在一起。请注意，我必须更改“e”变量的格式。

```
var e = {"d":"{\"NewDataSet\":{\"Table\":[{\"Plate\":{\"LICENSE_PLATE\":\"PLATE 1\",\"PARKING_LOCATION\":\"1001\",\"START_TIME\":\"05:05:00\"}}, {\"Plate\": {\"LICENSE_PLATE\":\"PLATE 1\",\"PARKING_LOCATION\":\"1001\",\"START_TIME\":\"05:05:00\"}}]}}"}; 
```

然后你用一个常规`for`循环循环。

链接是：http: [//jsfiddle.net/Dracorat/EFcjA/10/](http://jsfiddle.net/Dracorat/EFcjA/10/)

# php - 通过php ftp远程递归搜索目录

> ID：13168213
> 
> 赞同：0
> 
> 时间：2012-10-31T22:12:46.210
> 
> 标签：php, ftp

我正在通过 php 的 ftp 连接连接到另一台服务器。

但是我需要能够从它的 web 根目录中提取所有 html 文件，这让我有点头疼......

我发现这篇文章[Recursive File Search (PHP)](https://stackoverflow.com/questions/1860393/recursive-file-search-php)讨论了使用`RecursiveDirectoryIterator`函数，但是这是针对与 php 脚本自身位于同一服务器上的目录。

我已经尝试过编写自己的函数，但不确定我是否正确...假设发送到该方法的原始路径是服务器的文档根目录：

```
public function ftp_dir_loop($path){

    $ftpContents = ftp_nlist($this->ftp_connection, $path);

    //loop through the ftpContents
    for($i=0 ; $i < count($ftpContents) ; ++$i)
        {
            $path_parts = pathinfo($ftpContents[$i]);

            if( in_array($path_parts['extension'], $this->accepted_file_types ){

                //call the cms finder on this file
                $this->html_file_paths[] = $path.'/'.$ftpContents[$i];

            } elseif(empty( $path_parts['extension'] )) {

                //run the directory method
                $this->ftp_dir_loop( $path.'/'.$ftpContents[$i] );  
            }
        }
    }   
} 
```

有没有人看过预制的课程来做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:19:01.973

你可以试试

```
public function ftp_dir_loop($path) {
    $ftpContents = ftp_nlist($this->ftp_connection, $path);
    foreach ( $ftpContents as $file ) {
        if (strpos($file, '.') === false) {
            $this->ftp_dir_loop($this->ftp_connection, $file);
        }
        if (in_array(pathinfo($file, PATHINFO_EXTENSION), $this->accepted_file_types)) {
            $this->html_file_paths[$path][] = substr($file, strlen($path) + 1);
        }
    }
} 
```

# spring - PropertyTypeDescriptor 和 Spring 3.1.2

> ID：13168215
> 
> 赞同：1
> 
> 时间：2012-10-31T22:13:08.513
> 
> 标签：spring, apache-flex

我正在使用 Spring-Flex 1.5.2 和 Spring 3.1.2 开发一个项目，最近在我的项目中添加了一些 DAO 后，当我尝试填充我的一个组合时，我开始在 WebLogic 控制台上收到此错误：

```
[BlazeDS]org/springframework/core/convert/support/PropertyTypeDescriptor
java.lang.NoClassDefFoundError: org/springframework/core/convert/support/PropertyTypeDescriptor
    at org.springframework.flex.core.io.HibernateProxyConverter.convert(HibernateProxyConverter.java:48)
    at org.springframework.core.convert.support.ConversionUtils.invokeConverter(ConversionUtils.java:35)
    at org.springframework.core.convert.support.GenericConversionService.convert(GenericConversionService.java:171)
    at org.springframework.flex.core.io.SpringPropertyProxy.getValue(SpringPropertyProxy.java:160)
    at flex.messaging.io.amf.Amf3Output.writePropertyProxy(Amf3Output.java:601)
    at flex.messaging.io.amf.Amf3Output.writeCustomObject(Amf3Output.java:532)
    at flex.messaging.io.amf.Amf3Output.writeObject(Amf3Output.java:207)
    at flex.messaging.io.amf.Amf3Output.writeObjectArray(Amf3Output.java:854)
    at flex.messaging.io.amf.Amf3Output.writeAMFArray(Amf3Output.java:445)
    at flex.messaging.io.amf.Amf3Output.writeObject(Amf3Output.java:193)
    at flex.messaging.io.ArrayCollection.writeExternal(ArrayCollection.java:97)
    at flex.messaging.io.amf.Amf3Output.writePropertyProxy(Amf3Output.java:594)
    at flex.messaging.io.amf.Amf3Output.writeArrayCollection(Amf3Output.java:476)
    at flex.messaging.io.amf.Amf3Output.writeObject(Amf3Output.java:189)
    at flex.messaging.messages.AbstractMessage.writeExternalBody(AbstractMessage.java:705)
    at flex.messaging.messages.AbstractMessage.writeExternal(AbstractMessage.java:435)
    at flex.messaging.messages.AsyncMessage.writeExternal(AsyncMessage.java:140)
    at flex.messaging.messages.AcknowledgeMessage.writeExternal(AcknowledgeMessage.java:94)
    at flex.messaging.messages.AcknowledgeMessageExt.writeExternal(AcknowledgeMessageExt.java:55)
    at flex.messaging.io.amf.Amf3Output.writePropertyProxy(Amf3Output.java:594)
    at flex.messaging.io.amf.Amf3Output.writeCustomObject(Amf3Output.java:532)
    at flex.messaging.io.amf.Amf3Output.writeObject(Amf3Output.java:112)
    at flex.messaging.io.amf.Amf0Output.writeObject(Amf0Output.java:206)
    at flex.messaging.io.amf.AmfMessageSerializer.writeObject(AmfMessageSerializer.java:196)
    at flex.messaging.io.amf.AmfMessageSerializer.writeBody(AmfMessageSerializer.java:186)
    at flex.messaging.io.amf.AmfMessageSerializer.writeMessage(AmfMessageSerializer.java:142)
    at flex.messaging.endpoints.amf.SerializationFilter.invoke(SerializationFilter.java:198)
    at flex.messaging.endpoints.BaseHTTPEndpoint.service(BaseHTTPEndpoint.java:291)
    at flex.messaging.endpoints.AMFEndpoint$$EnhancerByCGLIB$$25364767.service(<generated>)
    at org.springframework.flex.servlet.MessageBrokerHandlerAdapter.handle(MessageBrokerHandlerAdapter.java:109)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:292)
    at weblogic.servlet.internal.TailFilter.doFilter(TailFilter.java:26)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:42)
    at org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:147)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:42)
    at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)
    at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:42)
    at weblogic.servlet.internal.RequestEventsFilter.doFilter(RequestEventsFilter.java:27)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:42)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3496)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(Unknown Source)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2180)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2086)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1406)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:173)
Caused by: java.lang.ClassNotFoundException: org.springframework.core.convert.support.PropertyTypeDescriptor
    at weblogic.utils.classloaders.GenericClassLoader.findLocalClass(GenericClassLoader.java:283)
    at weblogic.utils.classloaders.GenericClassLoader.findClass(GenericClassLoader.java:256)
    at weblogic.utils.classloaders.ChangeAwareClassLoader.findClass(ChangeAwareClassLoader.java:54)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:251)
    at weblogic.utils.classloaders.GenericClassLoader.loadClass(GenericClassLoader.java:176)
    at weblogic.utils.classloaders.ChangeAwareClassLoader.loadClass(ChangeAwareClassLoader.java:35)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)
    ... 57 more 
```

谷歌在这方面让我失望了......所以非常感谢任何帮助。

我已经用 @RemotingDestination 注释了我的服务，并在我的 Mxml 中创建了远程对象，如下所示：

```
<s:RemoteObject id="marketSegment" destination="marketSegmentServiceImpl" endpoint="http://localhost:7001/scpi/messageBroker/amf"></s:RemoteObject> 
```

然后我在我的组合框中添加这个：

```
dataProvider="{marketSegment.findAllCatalogs.lastResult}" 
```

这在我的创作完成：

```
private function init():void{
    marketSegment.findAllCatalogs();
    biotech.findAllCatalogs();
} 
```

这用于获取仅具有原始类型属性的对象，但在尝试获取具有复杂类型属性的任何对象时失败并出现上述错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T14:55:43.097

看起来有些版本不兼容。

这个类`org.springframework.core.convert.support.PropertyTypeDescriptor`在 Spring 3.1 中被删除了！

看看包含`org.springframework.flex.core.io.HibernateProxyConverter`. 也许您在 pom.xml 中找到了所需的 spring-core 版本。

# c++ - Audiere 库和 Sound FX，它们是如何启用的？

> ID：13168221
> 
> 赞同：0
> 
> 时间：2012-10-31T22:14:13.533
> 
> 标签：c++, audio

有没有人可以为我指出一个很好的参考/教程，说明如何将粉红噪声生成效果（或任何一种）添加到 OutputStream 或使其与 Audiere 库一起工作所需的任何对象。

到目前为止，我只能播放和更改声音对象的平移、音高效果，但对其他 FX 效果一无所知。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:28:35.673

好的，如果您想要粉红噪音，这应该可以完成

```
audiere::OutputStreamPtr pSample = audiere::OpenSound(m_pAudiereDevice, "getout.ogg", audiere::MULTIPLE, audiere::FF_OGG);
pSample->setVolume(0.5f);
pSample->play();

audiere::SoundEffectPtr pSoundEffect = audiere::OpenSoundEffect(m_pAudiereDevice, audiere::CreatePinkNoise(), audiere::SINGLE );
pSoundEffect->play(); 
```

# security - 带有用户页面的网站的安全性：文件夹或子域？

> ID：13168230
> 
> 赞同：1
> 
> 时间：2012-10-31T22:14:56.763
> 
> 标签：security, directory, subdomain

客户想要创建网站（webservice，正如他命名的那样），用户可以在其中创建自己的页面，包括使用 JS 脚本等。我看到两种方法 - 使用文件夹：

```
http://service.com/user/name/ ... 
```

和子域：

```
http://user.service.com/... 
```

两条路径都不是问题，但客户希望使用文件夹来获得 SEO 好处。我认为如果我使用文件夹，它会使网站的安全性降低。例如，用户可以从其页面发送 AJAX 请求，服务器将响应他。如果是子域，按照SOP（Same Origin Policy）请求会被拒绝。如果我错了，请纠正。

文件夹的 SOP 真的有问题吗？文件夹还有其他安全问题吗？使用子域更安全吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T16:02:38.913

继续研究这个问题。据我了解，如果使用文件夹，用户也可以使用 Black Hat SEO 创建页面，搜索引擎将禁止我的域。我对吗？

所以我已经可以在文件夹中看到 2 个安全问题并且无法修复它。有解决方案吗？子域真的更安全还是有其他问题？

# android - 如何验证用户，使用 Google 帐户 user_id 到第三方套接字服务器

> ID：13168233
> 
> 赞同：0
> 
> 时间：2012-10-31T22:15:13.173
> 
> 标签：android, authentication, accountmanager

本教程非常有助于理解`AccountManager`和`authToken`：
[***Nick's Blog Authenticating against App Engine from an Android app***](http://blog.notdot.net/2010/05/Authenticating-against-App-Engine-from-an-Android-app)

我仍然需要让它与一个基本的 Java SSL/TSL 套接字服务器一起工作，现在我的 Android 用户使用密码对自己进行身份验证。

*更新：
服务器作为[SPRIID](https://play.google.com/store/apps/details?id=com.hellberg.spriid&hl=en)应用程序用户的中继站。
使用 SPRIID 应用程序，您可以通过这个专用的 java 服务器将文件发送到其他设备。
- 一切都通过 C2DM（GCM）工作
- 后端 MongoDb 数据库注册用户和 frindlist 并处理传输详细信息
为了测试尝试应用程序，安装它，将自己添加为朋友，发送一些东西..*

服务器如何解析`authToken`返回 `getAuthToken()`？
我的服务器必须运行一些 GAE api 吗？
“联合登录”是要走的路吗？怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T03:21:54.700

不太清楚您到底在做什么，也许可以提供有关您的服务器的更多详细信息。

通常，您只需使用自己的自定义协议传递令牌。如果您使用 ClientLogin 令牌，检查它们是否有效的唯一方法是尝试调用相应的 Google 服务（例如，日历）并检查您是否收到 200（未授权时为 401）响应。对于 OAuth 令牌，有一个 API 可以验证它们。

还可以考虑使用 HTTP 并使用标准身份验证协议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:05:45.517

认为我现在可以工作了，警告我还在学习吗

在上面尼克的示例代码中，我替换了

```
accountManager.getAuthToken(account, "ah", false, new GetAuthTokenCallback(), null); 
```

和

```
accountManager.getAuthToken(account,"oauth2:https://www.googleapis.com/auth/userinfo.profile", false, new GetAuthTokenCallback(), null); 
```

现在我得到一个令牌，可以在我的 chrome 浏览器中执行以下操作：

```
https://www.googleapis.com/oauth2/v1/userinfo?access_token=ya29.AHeS6ZQpS0T0jipB0grWzuqINDdP98zjj-uljvw1GTR1_2s 
```

这将返回这个json

```
{
 "id": "100864638927226952543326",
 "name": "Billy Bob",
 "given_name": "Billy",
 "family_name": "Bob",
 "link": "https://plus.google.com/13444649626952543326",
 "picture": "https://lh5.googleusercontent.com/--QPesNgxryI/AAAAAeewAAAI/AAAAAAAAAFo/J-LSwl0bcVU/photo.jpg",
 "gender": "male",
 "locale": "us"
} 
```

我想要的是“id”，这应该是独一无二的

# python - 比较两个元组列表中元素之间的元素

> ID：13168252
> 
> 赞同：6
> 
> 时间：2012-10-31T22:16:49.880
> 
> 标签：python

这是我想要做的。我有两个元组列表。构建一个元素列表，使得 list1 中的元组中的第一个元素与列表 2 中的元组中的第一个元素匹配

```
list1 = [('a', 2), ('b', 3), ('z', 5)]

list2 = [('a', 1), ('b', 2), ('c', 3)]

list3 = ['a','b'] 
```

注意：不能有重复的第一个元素

在查看了 python 列表推导之后，这就是我所做的

```
[x[0] for x in list1 if (x[0] in [y[0] for y in list2])] 
```

我的问题是，这将是一个有经验的 python 程序员如何编写代码吗？自己编写了代码后，我仍然觉得这很难阅读。如果不是，你会怎么做

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T22:18:30.840

我会使用`zip()`：

```
In [25]: l1 = [('a', 2), ('b', 3), ('z', 5)]

In [26]: l2 = [('a', 1), ('b', 2), ('c', 3)]

In [27]: [x[0] for x,y in zip(l1,l2) if x[0]==y[0]]
Out[27]: ['a', 'b'] 
```

**编辑：**阅读您上面的评论后，您似乎正在寻找这样的东西：

```
In [36]: [x[0] for x in l1 if any(x[0]==y[0] for y in l2)]
Out[36]: ['a', 'b'] 
```

或使用`sets`：

```
In [43]: from operator import itemgetter

In [44]: set(map(itemgetter(0),l1)) & set(map(itemgetter(0),l2))
Out[44]: set(['a', 'b']) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T22:26:46.747

我想你想在[`set`](http://docs.python.org/2/library/stdtypes.html#set)这里使用 s ：

```
set(x[0] for x in list1).intersection(y[0] for y in list2) 
```

或使用语法糖：

```
{x[0] for x in list1} & {y[0] for y in list2} 
```

两者都导致：

```
set(['a', 'b']) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T22:27:51.167

我认为在这里使用集合可能更清楚（因为你没有重复的元素）：

```
set1 = set( el[0] for el in list1 )
set2 = set( el[0] for el in list2 )
set3 = set1 & set2 # set intersection
# list3 = list(set3) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T22:30:31.340

假设您想要元组的第一个元素的集合交集，您可以使用 Python 2.7 中引入的字典键视图：

```
dict(list1).viewkeys() & dict(list2).viewkeys() 
```

对于长列表，这将比您的解决方案更有效，因为它具有线性运行时间（与您的解决方案的 O(mn) 相反），但以任意顺序返回结果（与 定义的顺序相反`list1`）。

在 Python 3.x 中，这将是

```
dict(list1).keys() & dict(list2).keys() 
```

# java - 水平获胜检测不会在连接 4 游戏的底行检测获胜

> ID：13168254
> 
> 赞同：0
> 
> 时间：2012-10-31T22:17:02.517
> 
> 标签：java, swing

现在我正在创建一个 connect 4 游戏。我没有发布所有的 GUI 组件，因为它并不重要。游戏检测除底行之外的所有行的水平获胜。这是获胜检测的代码。

```
boolean CheckForWin()
    {
        for (int row = 1; row < gameBoard.length; row++) //Plus 1 is added to prepare for dimension swap.
        { 
            //Player 1 horizontal count
            int max=0;
            //Player 2 horrizontal count
            int max2=0;
            int count_piece=0;
            for(int column=1; column<gameBoard.length; column++)
            {   
                // check for horizontal
                if(row==6)
                {
                    break;
                }
                if(count_piece<max || count_piece<max2) 
                {
                    count_piece=max;
                    count_piece=max2;
                }
                if(gameBoard[row][column]=='r')
                {
                    max++;
                }
                else
                {
                    max=0;
                }
                if(gameBoard[row][column]=='b')
                {
                    max2++;
                }
                else
                {
                    max2=0;
                }
                if(max==4 || max2==4)
                {
                    return true;
                }
      // check for vertical
            }               
        }   
      // check for diagonal up
      // check for diagonal down
      return false;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:30:13.850

我假设游戏板是一组数组？您在循环中从 1 开始行和列，但它们在 java 中是 0。您是否也没有在最左列中检测到胜利？

您应该将循环更改为`for int row = 0;...`和`for int column = 0...`

# java - 更新方法中的值 - java

> ID：13168258
> 
> 赞同：-2
> 
> 时间：2012-10-31T22:17:25.307
> 
> 标签：java

所以在这个程序中有银行账户，我正在研究一种允许用户更改余额的方法，这就是我所拥有的：

```
 public double modifyBalance(int accountID, double adjustment) {
     Account temp = findAccount(accountID, 0, size, lastPos);
     double currBal = temp.getBalance();    
     if (temp!= null){      
        currBal = currBal + adjustment;
     }
     else {
           System.out.println("No account found. ");
        }

     return currBal;
  } 
```

然而 currBal 的返回并没有更新实际账户的余额，我试过`temp.getBalance() = currBal;`但没有奏效，并给了我一个编译错误说：

> OrderedVectorOfAccounts.java:95：错误：找不到符号
> temp.getBalance = currBal；
>         ^
> 符号：变量 getBalance
> 位置：Account
> 1 类型的变量 temp 错误

例如：如果帐户的余额是 200，我“存款”或添加 200，它应该是 400，但我所拥有的仍然是 200。
任何帮助都会很棒！谢谢！

这是我的 findAccount()：

```
public Account findAccount(int accountID, int from, int to, int [] lastPos){
     if(from > to || (from+2)/2 >= size)
        return null;
     while(from <=to) {   
        if(accountID == theAccounts[(from+to)/2].getAccountNum())
           return theAccounts[(from + to)/2];
        else if (accountID>theAccounts[(from + to)/2].getAccountNum()){
          // return findAccount(accountID, (((from + to)/2)+1), to, lastPos);
           return theAccounts[accountID-1];
        }
        else if (accountID<theAccounts[(from + to)/2].getAccountNum()){
           //return findAccount(accountID, from, (((from + to)/2)-1),lastPos);
           return theAccounts[accountID-1];
        }
     }
     lastPos[0] = (from + to)/2;
     return null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:12:10.180

您的`modifyBalance`方法只是更新`currBal`变量，使`temp`对象保持不变。`temp`这就是不更新's`currentBalance`变量的原因。为什么不直接删除所有这些混乱并创建一个简单的`setBalance`方法？

```
public void setBalance(double balance) { this.currentBalance = balance;   } 
```

有了这个，你可以在代码中的任何地方调用：

```
 Account temp = findAccount(accountID, 0, size, lastPos); 
 if (temp!= null) {   
   temp.setBalance(temp.getBalance() + adjustment); //updates temp currentBalance
 } 
 else { System.out.println("No account found. "); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:32:49.537

由于您尚未发布代码的相关部分，我假设您`temp.getBalance()`正在返回`0.0`或您的`findAccount()`方法返回一个空的新`Account()`对象。

```
 public Account findAccount(yourparameters) {
      Account account = new Account();
       //do your finding logic
      return account; 
```

如果说它没有找到帐户，它仍然会返回一个 Account 对象，因此

```
 double currBalc= temp.getBalance(); would return 0.0  

 if (temp!= null){  // your if passes here as temp is not null    
    currBal = currBal + adjustment;   0.0+200.0
 }
 else {
       System.out.println("No account found. ");
    } 
```

**更新您的 finfAccount() 后编辑**

可能是您的调用`getBalance()`返回 0.0

`double currBal = temp.getBalance();`如果它打印你 200.0 那么你的温度是空的 。

# php - 在 PHP 中通过套接字读取/写入 C 数据结构

> ID：13168259
> 
> 赞同：1
> 
> 时间：2012-10-31T22:17:25.683
> 
> 标签：php, c, sockets, struct

因此，我正在开发一个 Web 应用程序，其中所有数据都存储为 C 数据结构，并且可以通过套接字访问。Web 应用程序是用 PHP 编写的，这就是为什么我想在 PHP 中找到一种方法。请记住，我只能控制 PHP 应用程序，而不是服务器读取/写入数据的方式。

对于这个问题的广泛性，我深表歉意，但我并不是在寻找一个非常具体的答案。我更关心的是通过集体经验找到一种“最佳”方式来进行，这样我就不会花太多时间去寻找糟糕的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:54:09.263

您需要定义一种交换格式，也称为[序列化](http://en.wikipedia.org/wiki/Data_serialization)。然后 PHP 和 C 代码可以转换为它们的本机数据结构和从它们的本机数据结构转换。

虽然您可以将原始数据写入套接字，但这往往是有问题的。除非都是字符数据，否则必须处理字节顺序问题。

[JSON](http://en.wikipedia.org/wiki/JSON)是当今流行的首选格式。如今，大多数语言要么有内置支持，要么很容易获得库。[XML](http://en.wikipedia.org/wiki/XML)也是一种可能，但它更冗长并且在调试时更难阅读。

如果你想要一个非常紧凑的格式，[XDR](http://en.wikipedia.org/wiki/External_Data_Representation)是相当不错的。请参阅我的第一个链接以查找其他人。

# c# - 从 MVC Web 应用程序访问共享文件夹被拒绝

> ID：13168268
> 
> 赞同：2
> 
> 时间：2012-10-31T22:18:01.763
> 
> 标签：c#, asp.net-mvc, excel, iis, file-io

我有一个 MVC Web 应用程序，它使用模板 .xlt 和 .rpt 生成 Excel 和 PDF 报告（使用 Crystal），当我将模板放在 Web 服务器本身时，它生成报告没有故障，但是一旦我将模板放在**远程位置**，然后我收到一个拒绝访问错误，我通过进程监视器发现了该错误，屏幕截图如下

![在此处输入图像描述](../Images/9453542e2123d47e947da2fe7d0e15da.png)

当我从服务器通过资源管理器手动浏览远程文件夹时，一切正常，我可以打开我需要的文件，它只是在服务器读取文件时触发访问被拒绝错误。我的 Web 应用程序使用集成管道中的 ApplicationPoolIdentity。身份验证是通过模拟和 Windows 身份验证进行的。甚至令人困惑的是，运行 Excel 模板的用户是我自己，但我的访问被拒绝，而用于生成 PDF 的用户是 IIS Apppool。

有谁知道如何解决访问被拒绝的问题，我已经尝试让所有用户完全访问该文件夹，但它仍然不起作用。

**附加信息**

我使用的是 IIS 7.5，我还检查了共享所在的文件服务器，在事件日志上注册的用户不是我，而是以下详细信息

```
An account was successfully logged on.

Subject:
    Security ID:        NULL SID
    Account Name:       -
    Account Domain:     -
    Logon ID:       0x0

Logon Type:         3

New Logon:
    Security ID:        ANONYMOUS LOGON
    Account Name:       ANONYMOUS LOGON
    Account Domain:     NT AUTHORITY
    Logon ID:       0x90eb7c7
    Logon GUID:     {00000000-0000-0000-0000-000000000000}

Process Information:
    Process ID:     0x0
    Process Name:       -

Network Information:
    Workstation Name:   MYWEBSERVER
    Source Network Address: 10.10.10.01
    Source Port:        00000

Detailed Authentication Information:
    Logon Process:      NtLmSsp 
    Authentication Package: NTLM
    Transited Services: -
    Package Name (NTLM only):   NTLM V1
    Key Length:     128 
```

**更新**

在这种情况下我需要使用ApplicationPoolIdentity，所以我正在寻找一个仍然可以使用ApplicationPoolIdentity 的解决方案。

**另一个更新**

我在下面尝试了@Davids 的建议，现在我收到了相同的错误消息

> System.Runtime.InteropServices.COMException (0x800A03EC)：Microsoft Excel 无法访问文件“\MyServer\Templates\MyTemplate.xlt”。有几个可能的原因：
> 
> • 文件名或路径不存在。• 该文件正被另一个程序使用。• 您尝试保存的工作簿与当前打开的工作簿同名。在 Microsoft.Office.Interop.Excel.Workbooks.Open（字符串文件名、对象 UpdateLinks、对象只读、对象格式、对象密码、对象 WriteResPassword、对象 IgnoreReadOnlyRecommended、对象来源、对象分隔符、对象可编辑、对象通知、对象转换器、对象Ci.Infrastructure.Reporting.ReportProviderExcel.RunReport() 处的 AddToMru、对象本地、对象 CorruptLoad)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:11:23.960

I believe your problem is because the application pool needs to be configured to run either as a domain account or network service account.

If you choose the latter you'll need to grant permissions to `'<domainname>\<machinename>$'` if you choose to run as a specific account then this is the user you will need to grant permissions to.

You've already granted everyone access, so it should just be a case of changing the app pool user, but once you have it working I recommend you restrict this to the specific account.

The following link will give you more information:

[http://www.iis.net/learn/manage/configuring-security/application-pool-identities](http://www.iis.net/learn/manage/configuring-security/application-pool-identities)

# android - 如何将“actionNext”应用于物理输入

> ID：13168282
> 
> 赞同：0
> 
> 时间：2012-10-31T22:19:34.897
> 
> 标签：android, enter

我正在制作一个登录活动，它有两个 EditText，第一个带有“actionNext”，第二个带有“actionDone”。

使用虚拟键盘一切正常，因为虚拟 Enter 按钮已更改为“下一步/完成”按钮。

但是问题出现在物理（在 AVD 中）输入按钮上。因为当我触摸它时，它会在 EditText 中创建一个断线。我也尝试使用“android:lines="1" 但这只会产生“图形”效果，因为 Enter 按钮也会创建一个新的断线。

当我在平板电脑上运行应用程序时，也会出现此问题。在我的平板电脑中，我只有一个虚拟键盘，但它有两个按钮（Next 和 Enter）。

我怎样才能达到这个“输入”“actionNext/actionDone”功能，或者我怎样才能禁用这个按钮，以避免创建新行。

谢谢。

PD：对不起我的英语，我正在学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:30:53.783

尝试`dispatchKeyEvent(KeyEvent event)`在您的活动中使用

```
@Override
  public boolean dispatchKeyEvent(KeyEvent event) {
    Log.i("key pressed", String.valueOf(event.getKeyCode()));
    return super.dispatchKeyEvent(event);
} 
```

通过 keyCode 您可以检测是否按下了物理键盘按钮 Enter。

# html - Html 内联 svg 内容放错了位置

> ID：13168285
> 
> 赞同：2
> 
> 时间：2012-10-31T22:19:43.227
> 
> 标签：html, css, svg

如果您查看以下 html [http://jsfiddle.net/aLcxj/，+](http://jsfiddle.net/aLcxj/)和 T 图标的位置比应有的位置低一位（它们位于父级之外）。
**html:**

```
<ul class="Grid">
    <li>
        <span>Test1</span>
        <ul class="Manage">
            <li>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52.334 52.334" version="1.1"  ><path d="m 19.833 0 l 12.667 0 l 0 19.834 l 19.834 0 l 0 12.667 l -19.834 0 l 0 19.832 l -12.667 0 l 0 -19.832 l -19.833 0 l 0 -12.667 l 19.833 0 Z" /></svg>
            </li>
            <li>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 31.812 32.617" version="1.1"><path d="m 29.7119 0 l 1.05591 0.01221 l 0.43335 0.427245 l 0.494385 3.50342 l 0.115966 4.01611 L 31.7017 8.55713 L 31.2012 8.78906 L 30.4504 8.71582 L 30.0049 8.10547 L 28.8574 5.40162 L 27.5146 3.78418 L 26.326 3.13263 L 24.762 2.66724 L 22.8226 2.388 l -2.31476 -0.09308 l -1.5686 0.109864 l -0.653076 0.32959 l -0.07324 0.415039 l 0 24.3408 l 0.183105 1.32752 l 0.549316 0.857543 l 1.09253 0.595093 l 1.81274 0.540161 l 0.726318 0.164795 l 0.323487 0.10376 l 0.24414 0.927734 l -0.537109 0.610352 l -0.274658 -0.0061 l -0.726319 -0.06714 l -5.88379 -0.292969 l -4.76074 0.244141 l -1.29395 0 l -0.317383 -0.585938 l 0.115967 -0.653076 l 0.738525 -0.396728 l 1.75781 -0.592041 l 1.07422 -0.701905 l 0.622559 -1.11694 l 0.20752 -1.64185 l 0 -23.6572 L 13.6475 2.5879 L 12.9883 2.31934 L 12.5793 2.30103 L 11.5479 2.29493 L 7.51953 2.69776 L 4.71192 3.90626 L 3.14331 5.60304 L 1.75781 8.30079 L 1.26343 8.96607 L 0.610354 8.95997 L 0.0427246 8.63647 L 0 8.05664 L 0.640869 4.87671 L 0.854492 0.610351 L 1.22681 0.213624 L 2.34375 0.146484 L 7.89795 0.402832 L 14.0137 0.488282 L 19.5358 0.457762 L 23.9929 0.366212 L 27.3849 0.213625 L 29.7119 2e-006 Z" /></svg>
            </li>
        </ul>
    </li>
    <li>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52.334 52.334" version="1.1"><path d="m 19.833 0 l 12.667 0 l 0 19.834 l 19.834 0 l 0 12.667 l -19.834 0 l 0 19.832 l -12.667 0 l 0 -19.832 l -19.833 0 l 0 -12.667 l 19.833 0 Z" /></svg>
    </li>
</ul> 
```

**CSS：**

```
body {
    fill: white;
    color: white;
    background-color: black;
    font-size: 2em;
    font-family: "Segoe UI", "Segoe UI Light", "Verdana", "Arial", "Helvetica";
    letter-spacing: 1px;
}

.Grid > li {
    background-color: rgb(229, 20, 0);
    width: 5em;
    height: 5em;
    list-style-type: none;
    float: left;
    padding: 0.25em;
    margin: 0.25em;
    position: relative;
}

.Grid > li > span {
    left: 0.25em;
    bottom: 0.25em;
    position: absolute;
}

.Grid > li > .Manage {
    top: 0.25em;
    right: 0.25em;
    bottom: 0.25em;
    position: absolute;
}
.Grid > li > .Manage > li {
    width: 0.5em;
    height: 0.5em;
    display: block;
    list-style-type: none;
} 
```

这似乎与父 li 元素的宽度和高度有关，如果我将宽度和高度更改为 1em 而不是 0.5em，那么它们会被正确放置。

它在 IE9、Opera、Chrome 中的行为方式相同。

我究竟做错了什么？

![在此处输入图像描述](../Images/549c9f910cb6b6263e14dfaad1332edb.png) ![在此处输入图像描述](../Images/2c75b9e703472c2d36c7d63c959a6ea0.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T06:03:42.757

SVG 的初始显示值为`inline`，因此它的行为类似于文本。如果你用纯文本替换你的 SVG，你会得到相同的结果，因为它受行高的影响。为了克服这个问题，只需设置`svg {display: block;}`

# c++ - 我是否需要 SE_SHUTDOWN_NAME 权限才能注销用户？

> ID：13168289
> 
> 赞同：0
> 
> 时间：2012-10-31T22:20:13.623
> 
> 标签：c++, winapi, logoff

我需要从 C++ 程序中注销用户。我为此使用[ExitWindowsEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376868%28v=vs.85%29.aspx) API，但我不确定文档中是否需要任何特殊权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-16T00:20:33.027

你做。这是一个例子

```
bool ShutdownWindows(void)
{
HANDLE hToken = NULL; 
TOKEN_PRIVILEGES tkp = {0};
bool bRet = false;

// Get a token for this process. 
if (OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &hToken)) {
    if (LookupPrivilegeValue(NULL, SE_SHUTDOWN_NAME, &tkp.Privileges[0].Luid)) {
        tkp.PrivilegeCount = 1;  // one privilege to set    
        tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED; 

        // Get the shutdown privilege for this process. 
        if (AdjustTokenPrivileges(hToken, FALSE, &tkp, 0, NULL, 0)) {
            ::CloseHandle(hToken);

            if (ERROR_SUCCESS == GetLastError()) {

                DWORD dwFlags = EWX_POWEROFF;
                DWORD dwReason = SHTDN_REASON_MAJOR_SYSTEM;

                if (ExitWindowsEx(dwFlags, dwReason)) {
                    bRet = true;
                }
            }
        }
    }
}

return bRet; 
```

} // 关闭窗口

# javascript - 鼠标悬停时更改文本颜色

> ID：13168292
> 
> 赞同：6
> 
> 时间：2012-10-31T22:20:23.250
> 
> 标签：javascript, css, onmouseover, onmouseout

我希望使用纯 CSS 和 Javascript 来实现这一点。我对 PHP 也很好。我正在避免使用 jquery，因为我正在尝试更多地学习 javascript，并且我发现在某些 word-press 网站中，jquery 并不总是按我需要的方式工作。据我所知，我没有犯任何程序错误，但我一定遗漏了一些东西，因为它似乎无法正常工作。首先，我将提供一个可以找到代码的链接。[http://jsfiddle.net/FFCFy/13/](http://jsfiddle.net/FFCFy/13/)

接下来我将给出实际代码。

### Javascript：

```
setInterval(function() {
    var x = document.getElementById("div1");
    var y = document.getElementById("div2");

    function stext() {
        x.style.color = 'red';
        y.style.color = 'black';
    }

    function htext() {
        x.style.color = 'black';
        y.style.color = 'red';
    }
}, 250); 
```

### html:

```
<html>
<body>
    <span id="div1" style="color:black;" onmouseover="stext"   onmouseout="htext">TEXT1</span><p />
    <hr color="black" />
<span id="div2" style="color:red;"onmouseover="htext" onmouseout="stext">Text2</span>

</body>
</html> 
```

最终，我将对其进行修改以隐藏和显示不同的文本，但是一旦我弄清楚了，我就会做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-12T13:29:00.327

您可以简单地使用以下代码：

```
<html>
<head>
<body>
<font onmouseover="this.style.color='red';" onmouseout="this.style.color='black';">Text1</font>
<font onmouseover="this.style.color='black';" onmouseout="this.style.color='red';">Text2</font>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T22:27:09.353

您不需要**setInterval**。

```
function stext() {
    var x = document.getElementById("div1");
    var y = document.getElementById("div2");
    x.style.color = 'red';
    y.style.color = 'black';
} 
```

[更新了工作 JSFiddle](http://jsfiddle.net/FFCFy/16/)

​</p>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T22:32:28.930

为什么不只是：

```
#div1:hover {
    color: red;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T22:27:12.710

您不需要 setInterval：

```
 var x = document.getElementById("div1");
 var y = document.getElementById("div2");
 function stext() {
     x.style.color = 'red';
     y.style.color = 'black';
 }
 function htext() {
     x.style.color = 'black';
     y.style.color = 'red';
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T22:29:57.387

您的函数`htext`和`stext`是在匿名函数中定义的，因此不能全局使用。将函数定义移到匿名函数之外，或将函数分配给全局对象（窗口）以便它们可用。

但是话又说回来......为什么这段代码仍然在 setInterval 调用中？这没有任何意义。

# c++ - 用户是否在不退出进程的情况下关闭进程分配的控制台？

> ID：13168298
> 
> 赞同：1
> 
> 时间：2012-10-31T22:21:29.850
> 
> 标签：c++, winapi, visual-c++, console, visual-studio-2012

使用 Visual C++ 中的 Win32 API，我想在 Windows 子系统下创建一个程序，该程序`AllocConsole`用`WriteConsole`. 但是，如果用户关闭控制台，该进程应该继续在后台运行。就目前而言，我不能让这种情况发生。当在控制台标题栏上按下 X 时，进程退出。

有什么特别的方法可以做到这一点吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:39:55.747

关键是响应用户尝试关闭控制台时引发的[控制台控制事件。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685049%28v=vs.85%29.aspx)然后，您可以调用[FreeConsole](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683150%28v=vs.85%29.aspx)将您的程序与控制台分离，并让控制台被销毁。这*应该*让你的程序运行。

附加信息：

如果`HandlerRoutine`退出时进程终止，那么我的建议没有按预期工作。如果是这种情况，那么您可能会遇到问题。您可以尝试挂钩 SC_CLOSE 系统消息，并`FreeConsole`在传递消息之前执行此操作。这*可能会*起作用，尽管我不知道如果用户按下 Ctrl+C 或 Ctrl+Break 会发生什么。

问题是控制处理程序退出了进程。可能是打电话太晚了`FreeConsole`。`HandlerRoutine`

# javascript - 服务器端变量无法在链接元素中解析

> ID：13168299
> 
> 赞同：0
> 
> 时间：2012-10-31T22:21:32.027
> 
> 标签：javascript, asp.net, html

我一直在挠头并试图弄清楚这一点。我有一个 site.master 页面

我只是想做一件简单的事情。我在标题中包含一个链接元素

```
<link rel="canonical" href="<%=CannoicalURL%>" /> 
```

然而，上面的总是解析为`Views/CMSTemplates/%3C%25=%20CannoicalURL%20%25%3E` 所以换句话说，CannoicalURL 的值甚至没有被渲染

CannoicalURL 是我在后面的代码中设置的字符串变量，我在调试器中检查了值，它很好......

此外，我什至在下面创建了一个虚拟 javascript

```
<script>

    var a = <%=CannoicalURL%>;
</script> 
```

这非常有效。

有人可以解释为什么它不能与元素一起使用吗？任何解决方案/建议都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T22:34:53.737

你的头部标签是否标有`runat="server"`？如果是这样，则无法内联修改该控件内的标记，因为 ASP.NET 正在管理该控件。

如果是这种情况，请`runat="server"`从您的`<head>`标签中删除

# database - 将业务规则建模到数据库中

> ID：13168307
> 
> 赞同：2
> 
> 时间：2012-10-31T22:21:58.113
> 
> 标签：database, design-patterns, architecture, business-rules

有任何模式或建模技术可以将业务规则存储在数据库中吗？我正在寻找能够为我的系统业务规则提供与 EAV（实体-属性-值）在字段方面给我相同的可扩展性的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T09:44:51.453

“业务规则”是根据谁使用它们而改变含义的短语之一。我假设您的意思首先是您需要一种在应用程序中执行逻辑的方法，该方法适用于每个业务事务，可以由非技术人员管理，并且允许这些规则随时间而变化。

如果是这种情况，常见的架构解决方案是集成[业务规则引擎](http://en.wikipedia.org/wiki/Business_rules_engine)，而不是自己构建。这是一个不平凡的问题 - 对业务领域进行建模并选择可以应用规则的点已经足够困难了，但是随后为这些规则编写一种特定于领域的语言，最终用户可以通过用户友好的 GUI 进行修改不让系统慢下来是很难的。

业务规则引擎的示例是[Drools](http://www.jboss.org/drools/)和[Visual Rules](http://www.visual-rules.com)。两者都是相当复杂的软件 - 值得阅读并确保它们是您所需要的！

# objective-c - 通知 NSFetchedResultsController 动态属性更改

> ID：13168312
> 
> 赞同：0
> 
> 时间：2012-10-31T22:22:31.857
> 
> 标签：objective-c, ios, core-data

我有一个基于关系的具有动态属性的 NSManagedObject。我有一个`NSFetchedResultsController`获取这些对象的列表。但是，当动态属性发生变化时，在发送 KVO 通知时，`NSFetchedResultsController`永远不会调用它的委托来重新加载 tableView。

```
- (BOOL)read
{
    return self.lastMessage.read;
}

- (void)setRead:(BOOL)read
{
    [self.messages enumerateObjectsUsingBlock:^(TSMessage *message, BOOL *stop) {
        message.read = read;
    }];
}

+ (NSSet *)keyPathsForValuesAffectingRead
{
    return [NSSet setWithObject:@"lastMessage.read"];
} 
```

如何强制为 managedObject 注册更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T12:56:05.980

在 Core Data Programming Guide 中，有一整[章](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdAccessorMethods.html#//apple_ref/doc/uid/TP40002154-SW1)是关于自定义访问器的。本质上，您负责调用通知方法。

> 如果要实现自己的属性或一对一关系访问器方法，请使用原始访问器方法从托管对象的私有内部存储获取和设置值。您必须调用相关的访问和更改通知方法

因此：

```
-(BOOL)read {
   [self willAccessValueForKey:@"read"];
   BOOL r = self.lastMessage.read;
   [self didAccessValueForKey:@"read"];
   return r;
}

-(void)setRead:(BOOL)read {
   [self willChangeValueForKey:@"read"];
   [self.messages enumerateObjectsUsingBlock:^(TSMessage *message, BOOL *stop) {
      message.read = read;
   }];
   [self didChangeValueForKey:@"read"];
} 
```

# objective-c - 无法从类外访问 UIView 的“中心”属性

> ID：13168313
> 
> 赞同：1
> 
> 时间：2012-10-31T22:22:39.883
> 
> 标签：objective-c, ios, uiview, properties

我有一个`UICollectionViewCell`（让我们称之为`c`）的实例。 `c`有一个`child`类型的属性`B*`

```
@property (strong) B* child; 
```

里面有`B`一个声明

```
@property (strong) C* parent; 
```

在`C.m`我设置

```
self.child.parent = self 
```

在`B.m`我有代码：

```
position = self.parent.center.x; 
```

由于某种原因，我无法`center`从实例外部访问 UIVIew 的属性。是私人的吗？我查看`UIView.h`了文档。我不认为它是私人的。

访问`self.parent`是`B.m`给我正确的价值观......

那为什么我不能访问它？在`C.m`

```
self.center 
```

正在按预期工作...

编辑：使用真实代码

这就是所谓的“Ch”

```
#import <UIKit/UIKit.h>
#import "UIMovableImage.h"

@interface LetterCollectionCell : UICollectionViewCell

@property (weak, nonatomic) IBOutlet UIImageView *letterCellView;

@end 
```

这是“Bh”

```
#import <UIKit/UIKit.h>

@class LetterCollectionCell;

@interface UIMovableImage : UIImageView
{
    CGPoint currentPoint;
}
@property (strong) LetterCollectionCell* parent;

@end 
```

这是“厘米”

```
#import "LetterCollectionCell.h"
#import "LettersCollection.h"

@implementation LetterCollectionCell

-(void)PrepareImage:(int)index Hint:(BOOL)hint Rotate:(BOOL)rotate
{
    if ([_letterCellView respondsToSelector:@selector(parent)])
    {
       UIMovableImage* temp = ((UIMovableImage*)self.letterCellView);
       temp.parent = self;
    }     
}    

@end 
```

这是“Bm”

```
#import "UIMovableImage.h"
#import "LetterCollectionCell.h"

@implementation UIMovableImage

- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
        // Get active location upon move
        CGPoint activePoint = [[touches anyObject] locationInView:self.parent];

        // Determine new point based on where the touch is now located
        CGPoint newPoint = CGPointMake(self.parent.center.x + (activePoint.x - currentPoint.x),
                                       self.parent.center.y + (activePoint.y - currentPoint.y));

 }
@end 
```

请注意，LetterCollectionCell 的 letterCellView 是 UIImageView 类型，而不是 UIMovableImage 类型。原因是我想将此声明保留为占位符。在 Interface Builder 中，我有两个使用 LetteCollection 的场景。在一个场景中，我将 imageview 设置为 UIMovableImage（通过 Inspector Window），而在另一个场景中，我将图像设置为 UIImageView 类型。因此，运行时将在不同的场景中创建适当的类，并在我检查的集合中：如果图像具有“父级”属性 - 我设置它。否则我不会。它工作正常，分配工作正常......但访问权限不是

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:52:47.133

您无法访问该属性的唯一原因是该类不知道它（前向声明）。因此，您必须`#import "C.h"`在 B 的实现文件中丢失。

也许需要一个例子来安抚反对者，所以让我们用你的：

这是B的标题应该是什么样子

```
//Give us the ability to subclass UICollectionViewCell without issue
#import <UIKit/UIKit.h>

//forward declare a reference to class B.  We cannot access it's properties until we
//formally import it's header, which should be done in the .m whenever possible.
@class B;

@interface C : UICollectionViewCell

//Declare a child property with a strong reference because we are it's owner and creator.
@property (strong, nonatomic) B* child;

@end 
```

现在是 C 的标题。

```
//import foundation so we can subclass NSObject without a problem.
#import <Foundation/Foundation.h>

//Forward-declare classe C so we don't have to #import it here
@class C;

@interface B : NSObject

//keep an unretained reference to our parent because if the parent and the child have
//strong references to each other, they will create a retain cycle.
@property (unsafe_unretained, nonatomic) C* parent;

@end 
```

现在已经不碍事了，这是您最有可能使用的 C 的实现：

```
#import "C.h"
#import "B.h"

@implementation C

-(id)init {
    if (self =  [super init]) {
        self.child = [[B alloc]init];
        self.child.parent = self;
    }
    return self;
}

@end 
```

还不错，但问题是：

```
#import "B.h"

@implementation B

-(id)init {
    if (self = [super init]) {
        CGFloat position = self.parent.center.x; //ERROR!
    }
    return self;
}

@end 
```

因为 C 唯一声明它有一个`center`属性（或者更确切地说它的超类有一个`center`属性），并且 C 的类型在 Ch 文件中，所以 B 在没有显式`#import`Ch的情况下不知道 C 的属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T20:27:07.520

我找到了原因。整个问题都是对着错误的树吠叫。事实上，错误在另一个地方，我只是一直在调试器的监视窗口中查看“无效表达式”。

总结一下：在原始问题中描述的情况下，访问“中心”属性只是找到了。调试器的“无效表达式”和另一个地方的错误让我追逐了一个错误的东西。

我 +1d 一般正确的答案和评论，但不能接受它们，因为它可能会误导人们。

感谢大家的帮助和努力

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T22:49:03.320

根据您的问题的顺序，在我看来，您从设置 Cm 开始，但在该行代码上，子实例尚未设置.. self.child = nil 所以设置 self.child.parent = self 会给你没有结果...因此在 Bm 上将无法访问父对象...

如果我是正确的，只需在设置 self.child.parent = self 之前设置您的子实例对象 - self.child = B* ---

# accurev - 查找最新版本文件的时间戳

> ID：13168324
> 
> 赞同：0
> 
> 时间：2012-10-31T22:24:30.433
> 
> 标签：accurev

对于流中的最新文件，如何获取与版本关联的时间戳？我试过`accurev hist <elem>`了，但这会返回整个历史记录，现在我必须解析它。

编辑：

当我尝试`accurev hist -t highest <fileName>`

结果是：

```
element: /./a/b/c/Ver_2.xlsm
eid: 461
transaction 1335; promote; 2012/10/30 16:50:01 ; user: scrubbed
  version 1/3 (46/1) 
```

因此，从整个结果中仅提取时间戳，即 2012/10/30 16:50:01 似乎更有效。所以，我在评论中的第一个问题是我们是否可以恢复时间戳，即 2012/10/30 16:50:01

尝试新命令后`accurev hist -fx -t highest -p mydepot Ver_2.xlsm`，返回值为 xml 值：

```
......
    <transaction
        id="1335"
        type="promote"
        time="1351630201"
        user="scrubbed">
........ 
```

这一次，时间戳作为 epoch 值返回。我想我可以找到一种将其转换为时间戳值的方法，但如果有可能返回 2012/10/30 16:50:01 的值，那将是最好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T14:51:51.827

尝试为您的 hist 命令添加“-t最高”标志，这将只检索该流中文件的最新事务信息......

这是针对特定流中的最新版本：
accurev hist -fx -t highest -s stream_name .\path_to_element

这是仓库中的最新版本：
accurev hist -fx -t最高 -p depot_name .\path_to_element

编辑后，我现在明白您只需要时间戳值。没有办法返回单个属性。我建议您使用 -fx 选项并解析正确的属性。要将纪元时间转换为可读值，请使用以下命令：

c:>perl -e "打印标量本地时间(1334932836);"
2012 年 4 月 20 日星期五 10:40:36

希望这可以帮助。
~詹姆斯

# mysql - MySQL：使用 IN 的嵌套 SQL

> ID：13168329
> 
> 赞同：0
> 
> 时间：2012-10-31T22:25:21.443
> 
> 标签：mysql, sql, database

我有一个如下所示的 SQL：

```
SELECT * FROM foo WHERE foo.bar IN (SELECT foobar.bar FROM foobar) 
```

这不好，对吧？嵌套的 SELECT 会导致事情变慢吗？我应该如何查询这样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:33:59.650

IN 子句是完全有效的 SQL，但它并不总是首选方式。我经常发现 MySQL 在它们上的性能很差，即使`foo.bar`被索引了。

如果将其更改为联接，则必须小心第二张表是否有多行与第一张表的每一行的联接条件匹配，因为联接会产生多个结果行。如果这是可能的，连接应该是：

```
SELECT f.*
FROM foo f
INNER JOIN (SELECT DISTINCT bar FROM foobar) fb USING (bar); 
```

最终的答案是您应该使用 EXPLAIN 来查看如何执行不同形式的查询。但是，如果您一开始没有遇到性能问题，请不要担心。

如果你想要所有不存在的行`f.bar`，*通常*是`foobar`最`NOT IN`简洁的写法。但也可以使用 a 来编写`LEFT OUTER JOIN`：

```
SELECT f.*
FROM foo f
LEFT OUTER JOIN foobar fb USING (bar)
WHERE fb.bar IS NULL 
```

在这种情况下，您不需要子查询，因为您只报告不匹配的行，因此结果中显然不能有多个匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:44:31.597

您也可以将其重写为

```
Select
  * 
From
  foo f
Where
  Exists ( -- If you want the opposite, put Not in front here
    Select 'x'
    From foobar fb
    Where f.bar = fb.bar
  ); 
```

多年来，不同的 DBMS 以不同形式之一更好地处理查询，即使它们都是等效的。我尝试过的大多数现在都可以为两者生成相同的计划。不过，不是我在 mysql 上尝试过的东西。

# node.js - 在节点上安装猫鼬

> ID：13168332
> 
> 赞同：2
> 
> 时间：2012-10-31T22:25:48.960
> 
> 标签：node.js, mongodb, mongoose, npm

我正在尝试在 Mac OS X 上安装猫鼬：

```
$ sudo npm install -g mongoose
npm http GET https://registry.npmjs.org/mongoose
npm http 304 https://registry.npmjs.org/mongoose
npm http GET https://registry.npmjs.org/hooks/0.2.1
npm http GET https://registry.npmjs.org/mongodb/1.1.11
npm http GET https://registry.npmjs.org/ms/0.1.0
npm http GET https://registry.npmjs.org/sliced/0.0.3
npm http 304 https://registry.npmjs.org/hooks/0.2.1
npm http 304 https://registry.npmjs.org/mongodb/1.1.11
npm http 304 https://registry.npmjs.org/ms/0.1.0
npm http 304 https://registry.npmjs.org/sliced/0.0.3
npm http GET https://registry.npmjs.org/bson/0.1.5
npm http 304 https://registry.npmjs.org/bson/0.1.5

> bson@0.1.5 install /usr/local/lib/node_modules/mongoose/node_modules/mongodb/node_modules/bson
> node install.js || (exit 0)

================================================================================
=                                                                              =
=  Attempting to build bson c++ extension                                      =
=   Windows: no build will be attempted as binaries are prepackaged            =
=   Unix: on failure the package will still install without the C++ extension  =
=                                                                              =
================================================================================
node-gyp clean
node-gyp configure build
  CXX(target) Release/obj.target/bson/ext/bson.o
  SOLINK_MODULE(target) Release/bson.node
  SOLINK_MODULE(target) Release/bson.node: Finished
child process exited with code 0
mongoose@3.3.1 /usr/local/lib/node_modules/mongoose
├── sliced@0.0.3
├── hooks@0.2.1
├── ms@0.1.0
└── mongodb@1.1.11 (bson@0.1.5)
$ node
> require('mongoose');
Error: Cannot find module 'mongoose'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at repl:1:1
    at REPLServer.self.eval (repl.js:111:21)
    at rli.on.e (repl.js:260:20)
    at REPLServer.self.eval (repl.js:118:5)
    at Interface.<anonymous> (repl.js:250:12)
    at Interface.EventEmitter.emit (events.js:93:17) 
```

不应该`require`工作吗？难道我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T23:11:21.137

根据[npm 常见问题解答](https://npmjs.org/doc/faq.html)：

> **我在全球范围内安装了一些东西，但我不能 require() 它**
> 
> 在本地安装它。
> 
> 全局安装位置是命令行实用程序将其 bin 放入系统的位置`PATH`。它不适用于`require()`.
> 
> 如果您`require()`的代码中有一个模块，那么这意味着它是一个依赖项，并且是您程序的一部分。您需要在程序中本地安装它。

# css - 喜欢和发送按钮弹出消失

> ID：13168334
> 
> 赞同：1
> 
> 时间：2012-10-31T22:25:53.207
> 
> 标签：css, wordpress, facebook-like, facebook-likebox, flyout

我在使用 Facebook 赞和发送按钮时遇到了一些问题。我在 Wordpress、Blogum 主题中使用 XFBML 作为按钮。

但问题是，当单击“赞”或“发送”按钮时，您可以做出反应等的浮出控件会在网站上的其他对象下消失。

要自己检查一下，请参阅：http: [//zephyrhet4e.nl/2012/06/frisse-wind/](http://zephyrhet4e.nl/2012/06/frisse-wind/) 在帖子底部，我们有“赞”和“发送”按钮。

我希望看到弹出窗口高于网页上的所有其他内容。

有人能帮我解决这个问题吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:54:28.823

第80 行的`.post_content`类有. 因为您的 Facebook 按钮位于帖子内容 div 的最底部，所以当它们超出其边界时，它会将它们隐藏起来。将其更改为，Facebook 弹出窗口将可见（尽管您可能需要检查这不会影响其他站点元素）。`style.css``overflow:hidden``overflow:visible`

# ubuntu - 如何停止暴发户工作的所有实例

> ID：13168337
> 
> 赞同：3
> 
> 时间：2012-10-31T22:26:02.443
> 
> 标签：ubuntu, upstart

我有以下新贵作业，它需要参数来运行同一作业的多个实例：

```
instance $ARG1,$ARG2

script
    exec /path/to/executable "$ARG1" "ARG2"
end script 
```

现在，如果我像这样开始我的工作的两个实例：

```
$ start my-job ARG1=ABCD ARG2=1
my-job (ABCD,1) start/running, process 6242

$ start my-job ARG1=EFGH ARG2=2
my-job (EFGH,2) start/running, process 6254 
```

如何`my-job`在一个命令中停止所有实例，而不是执行 grep on `initctl list`，提取运行实例的参数并对每个实例`my-job`执行 a `stop`。

我试过`stop my-job`和`stop my-job ARG1=\* ARG2=\*`。两者都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T17:09:09.027

我最终做了以下事情，它适用于`[start|stop|restart] svc`.

***scv.conf：***

```
description "An Example Service"
start on networking
stop on runlevel[06] 
```

***svc-instance.conf：***

```
instance $ADDR,$PORT
manual
respawn
console log
exec /opt/svc/bin/svc -a $ADDR -p $PORT 
```

***启动-svc-task.conf：***

```
start on starting svc

task

script
  for a in 10.10.10.1 10.10.10.2 10.10.10.3 10.10.10.4
  do
    for p in 4001 4002 4003 4004
    do status svc-instance ADDR=$a PORT=$p \
      || start svc-instance ADDR=$a PORT=$p \
    done
  done
end script 
```

***停止我的工作任务.conf：***

```
start on stopping svc

task

script
  for a in 10.10.10.1 10.10.10.2 10.10.10.3 10.10.10.4
  do
    for p in 2001 2002 2003 2004
    do status svc-instance ADDR=$a PORT=$p \
      && stop svc-instance ADDR=$a PORT=$p \
      || continue
    done
  done
end script 
```

自己看看你的情况是否`status || start`需要`status && stop || continue`逻辑。我应该注意，我的原始用例只需要一个实例变量，我还没有用两个这样的变量测试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-20T15:20:44.360

使用信号。您可以通过以下方式立即停止所有这些`initctl emit scv-stop`

scv.conf：

```
description "An Example Service Starter"
start on networking
stop on runlevel[06]

for addr in 10.10.10.1 10.10.10.2 10.10.10.3 10.10.10.4;
{
    for port in 4001 4002 4003 4004;
    {
        status svc-n $addr:$port || start svc-n ADDR=$addr PORT=$port
    }
}
script 
```

scv-n.conf

```
description "An Example Service Instance"
instance $ADDR:$PORT
stop on runlevel[06] or scv-stop

script
    exec /opt/svc/bin/svc -a $ADDR -p $PORT
end script 
```

# php - 如何在各自的文本输入中显示正确的数据？

> ID：13168340
> 
> 赞同：-1
> 
> 时间：2012-10-31T22:26:35.080
> 
> 标签：php

我无法在各自的文本输入中显示 SessionName、SessionDate 和 SessionTime。应该发生的是用户应该从下拉菜单中选择一个会话（评估）。现在，当他们提交下拉菜单时，应在其文本输入中显示 Session 的详细信息，即 SessionName、SessionDate 和 SessionTime。但相反，我收到未定义的变量错误，这些错误如下：

> 注意：未定义的变量：dbSessionName in ...第 243 行
> 
> 注意：未定义的变量：dbSessionDate in ... 第 244 行
> 
> 注意：未定义的变量：dbSessionTime in ... 第 245 行

如何让 SessionName、SessionTime 和 SessionDate 显示在它们各自的文本输入中？

下面是代码：

```
$sessionquery = "
SELECT SessionId, SessionName, SessionDate, SessionTime, ModuleId
FROM Session
WHERE
(ModuleId = ?)
ORDER BY SessionDate, SessionTime 
";

$sessionqrystmt=$mysqli->prepare($sessionquery);
// You only need to call bind_param once
$sessionqrystmt->bind_param("s",$_POST['modules']);
// get result and assign variables (prefix with db)

$sessionqrystmt->execute(); 

$sessionqrystmt->bind_result($dbSessionId,$dbSessionName,$dbSessionDate,$dbSessionTime, $dbModuleId);

$sessionqrystmt->store_result();

$sessionnum = $sessionqrystmt->num_rows();   

if($sessionnum ==0){
echo "<p>Sorry, You have No Assessments under this Module</p>";
} else { 

$sessionHTML = '<select name="session" id="sessionsDrop">'.PHP_EOL;
$sessionHTML .= '<option value="">Please Select</option>'.PHP_EOL;           

while ( $sessionqrystmt->fetch() ) {
    $sessionHTML .= sprintf("<option value='%s'>%s - %s - %s</option>", $dbSessionId, $dbSessionName, $dbSessionDate, $dbSessionTime) . PHP_EOL;  
}

$sessionHTML .= '</select>';

$assessmentform = "<form action='".htmlentities($_SERVER['PHP_SELF'])."' method='post' onsubmit='return sessionvalidation();'>
<p>Assessments: {$sessionHTML} </p>
<p><input id='sessionSubmit' type='submit' value='Submit Assessment' name='sessionSubmit' /></p>  
<div id='sessionAlert'></div>    
</form>";

echo $assessmentform;

}

}

if (isset($_POST['sessionSubmit'])) {   

$currentsession = "form action='".htmlentities($_SERVER['PHP_SELF'])."' method='post'>
<p>Current Assessment's Date/Start Time:</p>
<p>Assessment: <input type='text' id='currentAssessment' name='Assessmentcurrent' readonly='readonly' value='{$dbSessionName}'/> </p> //Line 243
<p>Date: <input type='text' id='currentDate' name='Datecurrent' readonly='readonly' value='{$dbSessionDate}'/> </p> //Line 244
<p>Start Time: <input type='text' id='currentTime' name='Timecurrent' readonly='readonly' value='{$dbSessionTime}'/> </p> //Line 245
</form>
";  

echo $currentsession;

    } 
```

**更新：**

下面的代码可以做到吗：

```
if (isset($_POST['sessionSubmit'])) {

    $sessionquery = "
    SELECT SessionId, SessionName, SessionDate, SessionTime, ModuleId
    FROM Session
    WHERE
    (ModuleId = ?)
    ORDER BY SessionDate, SessionTime 
    ";

    $sessionqrystmt=$mysqli->prepare($sessionquery);
    // You only need to call bind_param once
    $sessionqrystmt->bind_param("s",$_POST['modules']);
    // get result and assign variables (prefix with db)

    $sessionqrystmt->execute(); 

    $sessionqrystmt->bind_result($dbSessionId,$dbSessionName,$dbSessionDate,$dbSessionTime, $dbModuleId);

    $sessionqrystmt->store_result();

$currentsession = "<form action='".htmlentities($_SERVER['PHP_SELF'])."' method='post'>
<p>Current Assessment's Date/Start Time:</p>
<p>Assessment: <input type='text' id='currentAssessment' name='Assessmentcurrent' readonly='readonly' value='{$dbSessionName}'/> </p>
<p>Date: <input type='text' id='currentDate' name='Datecurrent' readonly='readonly' value='{$dbSessionDate}'/> </p>
<p>Start Time: <input type='text' id='currentTime' name='Timecurrent' readonly='readonly' value='{$dbSessionTime}'/> </p>
<input type='hidden' id='hiddenId' name='hiddenAssessment' value='{$dbSessionId}'/>
</form>
";  

echo $currentsession;

    } 
```

我需要 store_result(); 在这个情况下？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:46:49.893

您实际上并没有使用发布的值`session`从数据库中检索选定的会话。

您显示的 sql 用于生成`select`框并`session`在发布的表单中选择，您需要在

```
if (isset($_POST['sessionSubmit'])) {
  ...
} 
```

部分使用 获取先前选择的会话`$_POST['session']`，可能类似于：

```
$sessionquery = "
SELECT SessionId, SessionName, SessionDate, SessionTime, ModuleId
FROM Session
WHERE
(SessionId = ?)
";
....
$sessionqrystmt->bind_param("i",$_POST['session']);    // assuming the session ID is an integer 
```

# ruby-on-rails - Rails：在这个例子中，为什么以及如何将明显相等的值添加到相等的日期会产生不同的结果？

> ID：13168342
> 
> 赞同：2
> 
> 时间：2012-10-31T22:26:50.433
> 
> 标签：ruby-on-rails, ruby, date

我看到打字`100.days`给了我[编辑：*似乎*给了我]一个 Fixnum `8640000`：

```
> 100.days.equal?(8640000)
 => true 
```

我原以为这两个值是可以互换的，直到我尝试了这个：

```
x = Time.now.to_date
=> Wed, 31 Oct 2012 
> [x + 100.days, x + 8640000]
=> [Fri, 08 Feb 2013, Mon, 07 May 25668] 
```

**为什么以及如何将明显相等的值添加到相等的日期会产生不同的结果？**

以上结果来自 Rails 控制台，使用 Rails 版本 3.1.3 和 Ruby 版本 1.9.2p320。（我知道，我应该升级到最新版本...）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:33:06.090

`100.days`不返回 Fixnum，它返回一个`ActiveSupport::Duration`，它在大多数操作下都非常努力地看起来像一个整数。

`Date#+`并被`Time#+`覆盖以检测是否添加了 Duration，如果是，则计算是否正确，而不是仅仅添加整数值（虽然 Time.+ 预计秒数，即 + 86400 提前 1 天，Date.+ 预计天数，因此 +86400 提前 86400 天）。

此外，还涵盖了一些特殊情况，例如在夏令时生效的当天添加一天。这也允许`Time.now + 1.month`提前 1 个日历月，而与当月的天数无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:54:42.867

除了弗雷德里克的回答提供的内容之外，将 8640000 添加到日期与将 8640000 添加到时间不同，`100.days`100 天的正确名称也不是。

想想`100.days`意思是“给我 100 天的秒数”，而不是“这个值代表天数”。Rails 过去常常返回秒数，但变得花哨/更智能并将其更改为持续时间，以便日期数学可以做正确的事情 - 主要是。那个更花哨/更聪明的东西会通过掩盖真正发生的事情而导致像你遇到的问题，并且在你知道之前很难调试。

日期数学假定日值，而不是秒，而时间需要秒。因此，使用`100 * 24 * 60 * 60 = 8640000`：

```
100 * 24 * 60 * 60               => 8640000
date = Date.parse('31 Oct 2012') => Wed, 31 Oct 2012
time = Time.new(2012, 10, 31)    => 2012-10-31 00:00:00 -0700

date + 8640000                   => Mon, 07 May 25668
time + 8640000                   => 2013-02-08 00:00:00 -0700
date + 100                       => Fri, 08 Feb 2013 
```

有时处理时间和日期会很痛苦，而且您肯定会在忘记的地方遇到您编写的代码中的错误。这就是 ActiveSupport::Duration 部分通过为您处理一些日期/时间偏移来提供帮助的地方。最好的策略是使用日期/日期时间或时间，除非绝对必要，否则不要混合使用。如果您确实必须将它们混合在一起，那么将代码限制在方法中，这样您就可以在一个地方查看是否出现问题。

如果我需要处理比 Time 可以处理的更大的范围，我使用 Date 和 DateTime，再加上 DateTime 有一些其他有用的功能，否则我使用 Time 因为它与操作系统和 C 更紧密地耦合。（我在那里揭示了我的一些根源。 )

# matlab - Simulink 中的 Matlab 函数不支持 RMS

> ID：13168346
> 
> 赞同：0
> 
> 时间：2012-10-31T22:27:10.957
> 
> 标签：matlab, code-generation, simulink, matlab-coder

Simulink 有一个名为“Matlab Function”的模块，允许您在 Simulink 流程图中创建自定义函数。

我在 Simulink Matlab Function 模块中实现了一个简单的函数。我的函数包含对 Matlab 内置的`rms()`. 当我运行 Simulink 模型时，我收到以下错误：

```
The function 'rms' not supported for standalone code generation 
```

如果我`rms`从 Simulink 模型中的 Matlab 函数中删除，错误就会消失并且模型运行完美。

**问题：**

*   **有没有办法`rms`在 Simulink 中使用 Matlab？**
*   **Simulink 中是否还有许多其他本机 Matlab 调用无法使用？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T14:06:40.490

我只是想澄清和扩展*learnvst的*回答中提出的一些观点。

即使您只是尝试模拟包含 MATLAB Function 模块的模型并且没有明确尝试执行代码生成，您仍然会收到`not supported for standalone code generation`错误消息。

正如*learnvst 所*指出的，对可用于代码生成的函数有多种限制。但是，如果您只想模拟您的模型，如果您将这些“列入黑名单”的函数表示为**外部**函数，Simulink 允许您执行此操作。这让 Simulink 知道这些函数将仅用于仿真目的，不会成为代码生成的一部分。

在您的特定情况下，在调用之前添加以下代码行`rms`：

```
coder.extrinsic('rms'); 
```

即使在执行代码生成时，在 MATLAB 函数中将函数声明为外部函数通常也很有用。例如，您可能希望`plot`在仿真期间使用该命令可视化您的数据，但显然不需要该`plot`命令成为生成代码的一部分。

有关将函数声明为外部函数的更多信息，请参阅[此文档](http://www.mathworks.com/help/simulink/ug/calling-matlab-functions.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:52:43.917

错误的`not supported for standalone code generation`一部分向我表明您正在尝试使用 Matlab Coder 之类的产品来制作可执行代码或本机代码。如果是这种情况，则有许多幼稚的调用不能在核心 Matlab 和工具箱中直接使用。编码器产品仅支持该语言的一个子集。更多信息可以在这里找到 。. .

[http://www.mathworks.co.uk/products/matlab-coder/description2.html](http://www.mathworks.co.uk/products/matlab-coder/description2.html)

至于您对 的调用`rms`，它只是计算平方均值的根。尝试使用类似 . . .

`sqrt(mean(x.^2))`

...`x`信号在哪里。

# c# - Visual Studio 2010 重命名项目和主要窗体

> ID：13168349
> 
> 赞同：1
> 
> 时间：2012-10-31T22:27:18.873
> 
> 标签：c#, visual-studio-2010

我想很多人开始做一些事情。后来他们发现这些名称并没有真正涵盖最终产品。或者至少，我确实经常为东西选择糟糕的名字，我开始编程比考虑类似的事情更快（最后我也经常重命名我的按钮，这样我的代码也变得更加清晰）。

当前正在进行的工作（未完成）重命名的最佳方法是什么？在不破坏代码的情况下，或者在编辑后做很多事情。

我在这里问它的原因是我已经看到它出错了几次，让我的代码不再起作用，所以我更好地了解如何执行此操作以及在哪个窗格中，最好重命名。

那么有什么问题呢？在 Visual Studio 2010 C#（解决方案资源管理器）的右上方窗格中：

*   解决方案本身的名称错误
*   它的下一行有错误的名称
*   主要形式也可以改进

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:36:55.037

如果您要重命名主窗体，它会询问您是否要更改对它的所有引用，您说是，问题就解决了。

重命名解决方案同样简单，只需在解决方案资源管理器中单击鼠标右键并重命名。它不会破坏您的本地构建或任何东西。

我不知道“它的下一行有错误的名称”指的是什么（也许是项目？）但可能也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:31:20.513

好吧，通常您应该在解决方案资源管理器中更改您的类的文件名，它应该询问您是否要更改所有引用，尽管有时它可能会出错，因此仔细检查您可以替换所有命令以查找旧名称的所有引用和换新的。。

[http://msdn.microsoft.com/en-us/library/139eef4h.aspx](http://msdn.microsoft.com/en-us/library/139eef4h.aspx)

此外，如果您更改代码、类或变量的名称或任何内容，然后您应该会在更改后的名称下方看到小线，将鼠标指针放在变量上并按 ctrl+。（ctrl dot）并且应该弹出小选项，第一个应该让您更改该变量新名称的所有引用：

[http://www.dofactory.com/ShortCutKeys/ShortCutKeys.aspx](http://www.dofactory.com/ShortCutKeys/ShortCutKeys.aspx)

# symfony - Symfony2 集合字段 by_reference=false vs. setter

> ID：13168350
> 
> 赞同：0
> 
> 时间：2012-10-31T22:27:20.867
> 
> 标签：symfony, collections, arraycollection, fieldtype

我有一个带有标签字段的表单。Tags 是绑定实体上的 Doctrine ArrayCollection。正如文档建议的那样，该字段是 by_reference=false ，但是在添加新元素时将表单绑定到实体是非法的，如下所示：

```
$data=$entity->getTags(); //gets the ArrayCollection but does not care that it is not an array, and shoulrd be converted first
//do the value modifications like:
$data[]=new Tag(...);
$entity->setTags($data); //poor setter gets called with the already-updated collection, this operation is pointless 
```

我认为 by_reference false 是为了避免这个问题。如果是，那么它出现故障。如果不是，那么文档非常差，有一个 ArrayCollections 的例子，但不关心这种对设置器的非常残酷的忽视......

我应该改用什么？在 getter 中返回 toArray() 是行不通的（显然设计模型以兼容较差的表单实现是不明智的。是否可能有类似于“集合”的类型强制转换为数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:30:21.490

将标签添加到实体，因为它应该发生：

```
$new_tag = new Tag(...);
$entity->addTag($new_tag); 
```

在基本的 Doctrine 生成实体中没有集合的集合函数。

# emacs - 改进 melpa、elpa 和 marmalade 存储库上的 Emacs 包描述

> ID：13168352
> 
> 赞同：1
> 
> 时间：2012-10-31T22:27:25.530
> 
> 标签：emacs, repository, emacs24, elpa

Emacs 包描述有时不是很详细或有错别字。用户如何改进这一点？

是否有 bugtracker 或像 GitHub 之类的公共存储库用于贡献？

您不应该**使用**，`M-x report-emacs-bug`因为存储库不是 Emacs 代码本身的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T01:44:48.470

`M-x report-emacs-bug`是官方的方式。这会将错误提交给`debbugs.gnu.org`错误跟踪器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T22:47:56.873

果酱的开发在 GitHub 上进行。所有有关果酱的错误和请求都应作为问题发送到[果酱存储库](https://github.com/nicferrier/marmalade)

我在这里找到了联系人：http `elpa`: [//tromey.com/elpa/upload.html](http://tromey.com/elpa/upload.html)

我还没有发现其他存储库的错误跟踪器。

# java - AppEngine JDO 查询过滤器“属性有祖先”

> ID：13168354
> 
> 赞同：1
> 
> 时间：2012-10-31T22:27:32.273
> 
> 标签：java, google-app-engine, jdo

我存储了一个类型为“ContainableObject”的实体，它有一个类型为“Container”的实体作为其属性之一。

```
class ContainableObject {

    @Persistent
    @Unowned
    private Container container;
    ... 
```

“容器”有一个“建筑”类型的父实体

由于该表实际上存储了一个包含其父键的容器的键（即属性容器是否`Key('Building',1,'Container',23)`有任何方法可以按照以下方式编写查询`select * from ContainableObject where container has ancestor Key('Building', 1)`

我知道我可以另外将 Building 存储为 ContainableObject 的直接属性，以便在查询过滤器中使用它，但这是唯一的方法吗？我很确定答案是肯定的，但我想要一些确认，因为它不是一个完整的连接，因为父密钥被埋在那里的某个地方。

注意： ContainableObject 与 Container 位于不同的实体组中，这不是祖先查询，JDO 的 AppEngine 实现无论如何都不支持 AFAIK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T11:04:39.243

不可能有您指定的查询。您需要修改代码结构以实现您的目标。

希望这可以帮助。

# java - 从 Java Swing GUI 文本区域运行 ANTLR 语法

> ID：13168357
> 
> 赞同：2
> 
> 时间：2012-10-31T22:27:52.067
> 
> 标签：java, swing, user-interface, antlr, jtextarea

我有运行良好的 ANTLR 解析器和树语法。我希望用户在 JTextarea 中输入语法（我正在使用 java swing 进行 gui 开发）。一旦语法在 JTextarea 中，用户应按下按钮（运行），语法的结果（动作）将显示在另一个文本区域中。

为了简单起见，可以使用最简单的 HelloWorld ANTLR 语法（解析器和树语法）来演示我们如何从 Java Swing gui 的 JTextarea 运行 ANTLR 语法。

我还没有找到任何将 ANTLR 与 JavaSwing GUI 相关联的东西，或者任何说明如何从 Java Swing GUI 的 JTextArea 运行 ANTLR 语法的东西。

任何想法/建议/简单示例/演示？
**编辑解决方案**
下面是我的 GUI 类中处理模拟按钮的部分代码。用户在 JTextarea 中输入 ANTLR 语法。

```
private void addReRunButtonListener() {
        btnReRun.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {

                 try {
                     //for Random Simulation
                     if(rdbtnRandomWithSeed.isSelected())
                     {
                      String line = "";
                      String nl ;

                      Process p = Runtime.getRuntime().exec("java org.antlr.Tool protocol.g protocolWalker.g");
                      p.waitFor();
                      p = Runtime.getRuntime().exec("javac protocolLexer.java protocolParser.java protocolWalker.java SimulatorRandom.java");
                      p.waitFor();
                      p = Runtime.getRuntime().exec("java RandomSimulator");

                      OutputStreamWriter stdin = new OutputStreamWriter(p.getOutputStream ());

                      stdin.write(simAlgoEdit.getText()+"\n");

                              stdin.close();

                      BufferedReader bri = new BufferedReader
                        (new InputStreamReader(p.getInputStream()));
                      nl = bri.readLine();
                      while (nl != null) {
                          line = line + nl + "\n";
                          nl = bri.readLine();

                      }
                      bri.close();

                      System.out.println("Done.");
                      simGraphicsArea.setText(line);
                      graphicsArea.setText(line);

                     } 
```

上面的代码还获取输出并将其插入到我的 GUI 中的另一个 JTextarea 中。@trashgod：非常感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T00:46:19.903

`ProcessBuilder`您可以像[从命令行](http://www.antlr.org/wiki/pages/viewpage.action?pageId=729)一样使用 ANTLR 。[这里](https://stackoverflow.com/a/5740673/230513)有一个相关的例子。您可以使用 的`append()`方法`JTextArea`显示来自 的结果`stdout`。

# javascript - javascript - 遍历二维数组

> ID：13168358
> 
> 赞同：1
> 
> 时间：2012-10-31T22:27:54.993
> 
> 标签：javascript, arrays, html, canvas

我正在尝试编写一个 javascript 程序，在 HTML5 画布上呈现 8x8 网格的污垢瓷砖。但是，当我运行此代码时，它会在运行该函数时抛出错误消息`draw_terrain()`，这似乎是`blockArray.length`组件的问题。有人可以向我解释如何解决这个问题吗？提前致谢。

```
//Define initial canvas variables and images

var canvas;
var ctx;
var WIDTH = 800;
var HEIGHT = 800;
var dirt = new Image();
dirt.src = 'dirt.png';

//Function called to initialise canvas variables and run draw on interval

function init(){
    canvas = document.getElementById('myCanvas');
    ctx = canvas.getContext('2d');
    return setInterval(draw, 15);
}

//Function that generates an 8x8 Array called blockArray

function gen_terrain(){

var blockArray = new Array(8);

for(var i=0; i<blockArray.length; i++) {
    blockArray[i] = new Array(8);
    for(var j=0; j<blockArray[i].length; j++){
        blockArray[i][j] = 0;
    };
};
}

//Function that returns a random number between a min and max

function randomRange (min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function draw_terrain(){
    for(var i=0; i<blockArray.length; i++) {
        for(var j=0; j<blockArray[i].length; j++){
            ctx.drawImage(dirt,(n-1)*32,(j-1)*32);
        };
    };
}

function draw(){
    draw_terrain();
}

gen_terrain();
init(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:33:45.980

正如其他人所解释的那样，您的问题是您正在使用构建数组的变量在绘制发生时将不存在。只需将您的数组声明放在函数之外，您的问题就会消失。

请参阅下面的评论：

```
function init(){
    canvas = document.getElementById('myCanvas');
    ctx = canvas.getContext('2d');
    return setInterval(draw, 15);
}

//Function that generates an 8x8 Array called blockArray
var blockArray = []; // <== has to be global (outside function).

function gen_terrain(){
    // Not here -> var blockArray = [];
    for(var i=8; i--;) {
        blockArray[i] = [0,0,0,0,0,0,0,0];
    };
} 
```

[例子](http://jsfiddle.net/UWL8V/1/)

# android - 新的 apk 上传并在我的开发者控制台上获得“支持的设备 0”

> ID：13168361
> 
> 赞同：2
> 
> 时间：2012-10-31T22:28:06.230
> 
> 标签：android, release, device

刚刚上传了 2 个新的 apk，在这两个上我都得到了支持的设备 0。只是环顾四周，我想不出我的清单有任何可疑之处。有人可以对此有所了解吗？谢谢

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.CHANGE_NETWORK_STATE"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-09-16T04:14:29.593

我在 build.gradle 中使用 commons.jar 时遇到了类似的问题，如下所示：

```
compile 'org.apache.directory.studio:org.apache.commons.io:2.4 
```

我通过这样做解决了它：

```
compile 'commons-io:commons-io:2.4' 
```

或者，可以手动下载库并将其放在 libs 文件夹中，从而按如下方式应用它：

```
compile files('libs/commons-io-2.4.jar') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T22:31:44.233

我最近发布我的应用程序时遇到了同样的问题。如果我没记错的话，我必须单击 APK 选项卡并选择 APK 文件（可能通过单击“激活”按钮）。我希望这可以帮助您朝着正确的方向前进。因为我已经修复了它，所以我看不到你看到的相同选项。

# mysql - 棘手的 SQL 查询 - 需要获取时间范围

> ID：13168362
> 
> 赞同：1
> 
> 时间：2012-10-31T22:28:13.480
> 
> 标签：mysql, tsql

当我需要一个查询来生成加速时间框架列表时，我偶然发现了一个问题。

这是数据示例

```
[idgps_unit_location]   [dt]    [idgps_unit]    [lat]   [long]  [speed_kmh]
26  10/18/2012 18:53    2   47  56  30
27  10/18/2012 18:53    2   49  58  31
28  10/18/2012 18:53    2   28  37  15
29  10/18/2012 18:54    2   56  65  33
30  10/18/2012 18:54    2   152 161 73
31  10/18/2012 18:55    2   134 143 64
32  10/18/2012 18:56    2   22  31  12
36  10/18/2012 18:59    2   98  107 47
37  10/18/2012 18:59    2   122 131 58
38  10/18/2012 18:59    2   91  100 44
39  10/18/2012 19:00    2   190 199 98
40  10/18/2012 19:01    2   194 203 101
41  10/18/2012 19:02    2   182 191 91
42  10/18/2012 19:03    2   162 171 78
43  10/18/2012 19:03    2   174 183 83
44  10/18/2012 19:04    2   170 179 81
45  10/18/2012 19:05    2   189 198 97
46  10/18/2012 19:06    2   20  29  10
47  10/18/2012 19:07    2   158 167 76
48  10/18/2012 19:08    2   135 144 64
49  10/18/2012 19:08    2   166 175 79
50  10/18/2012 19:09    2   9   18  5
51  10/18/2012 19:09    2   101 110 48
52  10/18/2012 19:09    2   10  19  7
53  10/18/2012 19:10    2   32  41  20
54  10/18/2012 19:10    1   54  63  85
55  10/19/2012 19:11    2   55  64  50 
```

我需要一个查询，可以将此表转换为以下报告，显示速度大于 80 的时间帧：

```
[idgps_unit]    [dt_start]  [lat_start] [long_start]    [speed_start]   [dt_end]    [lat_end]   [long_end]  [speed_end] [speed_average]
2   10/18/2012 19:00    190 199 98  10/18/2012 19:02    182 191 91  96.66666667
2   10/18/2012 19:03    174 183 83  10/18/2012 19:05    189 198 97  87
1   10/18/2012 19:10    54  63  85  10/18/2012 19:10    54  63  85  85 
```

现在，我尝试了什么？我尝试将其放入单独的表中，查询并进行一些连接...没有任何效果，我很沮丧...我什至不确定这是否可以通过查询来完成。求高手帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:21:27.870

你是对的，这相当棘手，但我想我已经做到了：

```
SELECT  s.idgps_unit,
        MIN(s.dt) AS DT_Start,
        MIN(CASE WHEN s.RowNumber = 1 THEN s.Lat END) AS Lat_Start,
        MIN(CASE WHEN s.RowNumber = 1 THEN s.Long END) AS Long_Start,
        MIN(CASE WHEN s.RowNumber = 1 THEN s.Speed_kmh END) AS Speed_Start,
        MAX(s.dt) AS dt_end,
        MIN(CASE WHEN s.RowNumber = MaxRowNumber THEN s.Lat END) AS Lat_End,
        MIN(CASE WHEN s.RowNumber = MaxRowNumber THEN s.Long END) AS Long_End,
        MIN(CASE WHEN s.RowNumber = MaxRowNumber THEN s.Speed_kmh END) AS Speed_End,

        AVG(Speed_kmh) AS Speed_Average
FROM    (   SELECT  T.*,
                    @i:= CASE WHEN Speed_Kmh > 80 AND @b = 0 THEN @i + 1 ELSE @i END AS IntervalID,
                    @r:= CASE WHEN Speed_Kmh > 80 AND @b = 0 THEN 1 ELSE @r + 1 END AS RowNumber,
                    @b:= CASE WHEN Speed_Kmh> 80 THEN 1 ELSE 0 END AS IntervalCheck
            FROM    T,
                    (SELECT @i:= 0) i,
                    (SELECT @r:= 0) r,
                    (SELECT @b:= 0) b
            ORDER BY dt, idgps_unit_location
        ) s
        INNER JOIN
        (   SELECT  IntervalID, MAX(RowNumber) AS MaxRowNumber
            FROM    (   SELECT  T.*,
                                @i:= CASE WHEN Speed_Kmh > 80 AND @b = 0 THEN @i + 1 ELSE @i END AS IntervalID,
                                @r:= CASE WHEN Speed_Kmh > 80 AND @b = 0 THEN 1 ELSE @r + 1 END AS RowNumber,
                                @b:= CASE WHEN Speed_Kmh> 80 THEN 1 ELSE 0 END AS IntervalCheck
                        FROM    T,
                                (SELECT @i:= 0) i,
                                (SELECT @r:= 0) r,
                                (SELECT @b:= 0) b
                        ORDER BY dt, idgps_unit_location
                    ) d
            WHERE   IntervalCheck = 1
            GROUP BY IntervalID
        ) MaxInt
            ON MaxInt.IntervalID = s.IntervalID
WHERE   s.IntervalCheck = 1
GROUP BY s.IntervalID, s.idgps_unit; 
```

关键在这部分：

```
SELECT  T.*,
        @i:= CASE WHEN Speed_Kmh > 80 AND @b = 0 THEN @i + 1 ELSE @i END AS IntervalID,
        @r:= CASE WHEN Speed_Kmh > 80 AND @b = 0 THEN 1 ELSE @r + 1 END AS RowNumber,
        @b:= CASE WHEN Speed_Kmh> 80 THEN 1 ELSE 0 END AS IntervalCheck
FROM    T,
        (SELECT @i:= 0) i,
        (SELECT @r:= 0) r,
        (SELECT @b:= 0) b
ORDER BY dt, idgps_unit_location 
```

每次遇到速度超过的行时，它会将变量 @b 设置为 1，如果此变量在为该行分配一个新的 intervalID 之前为 0，如果它这样做，它开始再次将行编号为 1，所以你结束用这样的东西：

```
[idgps_unit_location]   [dt]                [idgps_unit]    [lat]   [long]  [speed_kmh] [IntervalID]    RowNumber   IntervalCheck
37                      10/18/2012 18:59    2               122     131     58          1               1           0
38                      10/18/2012 18:59    2               91      100     44          1               2           0
39                      10/18/2012 19:00    2               190     199     98          2               1           1
40                      10/18/2012 19:01    2               194     203     101         2               2           1
41                      10/18/2012 19:02    2               182     191     91          2               3           1
42                      10/18/2012 19:03    2               162     171     78          2               4           0
43                      10/18/2012 19:03    2               174     183     83          3               1           1 
```

然后您需要排除所有速度低于 80 的行（WHERE IntervalCheck = 1），最后您可以使用聚合函数和 CASE 来查找`RowNumber`为 1 的行（超速的第一行）或最高行数那个间隔（最后一排超速）。最后的连接只是重复该过程以找到每个间隔ID 的最大行数。

**[SQL Fiddle 示例](http://sqlfiddle.com/#!2/35ecf/9)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:48:01.560

您是否尝试过这样的事情（省略平均速度计算）：

```
SELECT * FROM (
SELECT
   start.idgps_unit,
   start.dt dt_start,
   ...
   end.dt dt_end,
   ...
   (...) average_speed
FROM
   your_table start,
   your_table end
WHERE
   start.dt < end.dt
)
WHERE average_speed > 80 
```

这会给你带来很多重叠的时间框架，不确定这是否需要。如果没有，您可以使用 NOT EXISTS 过滤：

```
SELECT *
FROM (query_above) timeframes
WHERE NOT EXISTS (
SELECT *
FROM (query_above) longer_timeframes
WHERE 
   longer_timeframes.dt_start < timeframes.dt_end OR
   longer_timeframes.dt_end > timeframes.dt_end
) 
```

这可能仍然会给您带来一些重叠，例如，如果您从 19:00 到 19:03 走 60，从 19:03 到 19:07 走 100，从 19:07 到 19:10 再走 60。然后你有两个平均速度大于 80 的最大长度时间间隔，一个从 19:00 到 19:07，另一个从 19:03 到 19:10。

# wordpress - Wordpress：在 author.php 中列出作者的帖子

> ID：13168364
> 
> 赞同：1
> 
> 时间：2012-10-31T22:28:48.887
> 
> 标签：wordpress, list, posts, author

我想在 author.php 模板中列出作者的最后 10 篇文章。我使用了这段代码：

```
<?php while (have_posts()) : the_post(); ?>
    <li><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></li>
<?php endwhile;?> 
```

但我只能看到当前作者的最后一篇文章。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T16:28:24.477

这是代码

```
 <?php  global $query_string;
         query_posts( $query_string . '&posts_per_page=10' );
         while (have_posts()) : the_post(); ?>
             <li><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></li>
<?php    endwhile;?> 
```

# javascript - 用 Javascript 进行测验，只需要“是”而不是“是”

> ID：13168366
> 
> 赞同：-3
> 
> 时间：2012-10-31T22:29:02.113
> 
> 标签：javascript

所以我学习 javascript 并决定做一个有趣的测验，当我做测验时遇到了这个问题，它要求答案它只需要“是”而不是“是”的例子......

```
var questions = [
['Do you like Pizza', 'Yes']
 ];

function askQuestion(question) {
var answer = prompt(question[0],'');
    if (answer == question[1]) {
        alert('Correct!');
        score++;
    } else { 
        alert('Sorry the correct answer is ' + question[1]);
        }
} 
for (var i=0;i<questions.length; i++) {
    askQuestion(questions[i]);
} 
```

它只会用大写的 Y 来回答，我知道这是一个不好的例子。但我想你知道我在说什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:32:31.137

我将继续发布似乎很明显的内容-您正在接受一个字符串并将其与“是”进行比较，但是您需要将两个值的字母大小写设置为相同，然后进行比较。例如：

```
var questions = [
    ['Do you like Pizza', 'Yes']
];

var input = document.getElementById("user_input").value;
if (input.toLowerCase() == questions[i][1].toLowerCase()) {
    // `input` was "yes", "yEs", "Yes", etc.
} 
```

**更新**：

既然您共享了实际代码，请将您的函数更改为：

```
function askQuestion(question) {
    var answer = prompt(question[0],'');
    if ((""+answer).toLowerCase() == (""+question[1]).toLowerCase()) {
        alert('Correct!');
        score++;
    } else { 
        alert('Sorry the correct answer is ' + question[1]);
    }
} 
```

请注意我如何将用户的答案和问题的正确答案都转换为字符串（以确保您可以实际调用`toLowerCase`，因为它仅适用于字符串），然后同时调用`toLowerCase`两者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:31:51.003

我会接受您的回答和用户的回答，并使用 .toLowerCase() 方法将它们都设为小写。

# java - 检测字符串是否仅由一种字符组成

> ID：13168370
> 
> 赞同：4
> 
> 时间：2012-10-31T22:29:26.240
> 
> 标签：java, string, character

我想知道 a`String`是否仅由一种字符的重复组成。

例如，我想检测 a`String`是否仅由“b”组成，所以“bb”、“bbbb”、“bbbbbbbbbbb”、...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:37:07.103

正则表达式怎么样？

```
String pattern = "([a-zA-Z])\\1*";

if (string.matches(pattern)) {
    // The string contains is made up of the same character...

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T22:37:17.620

使用**[模式](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html)**

使用**反向引用的东西**

```
 boolean b = Pattern.matches("^(.)\\1+$", "aaaaaaa");
 //true

 b = Pattern.matches("^(.)\\1+$", "aaaabbbbaaa");
 //false 
```

如果您还想匹配**1 个字符的**字符串，`+`请将 Regex 中的 更改为`*`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T22:31:58.867

获取字符串的第一个字符并将其与其余字符进行比较，如果它没有更改，则字符串只有一种类型的字符（此解决方案适用于非 BMP unicode）。

```
public boolean sameCaracterInString(String string){
     if(string == null || string.isEmpty()) 
       return false;

    for(int i = 1; i < string.length(); i++)
       if(string.charAt(i) != string.charAt(0))
          return false;

    return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T22:38:38.660

```
String regex = "^" + str.charAt(0) + "+$"
return str.replaceAll(regex,"").length() == 0 ? true : false; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T22:56:40.093

```
private final static Pattern ONE_CHAR_PATTERN = Pattern.compile("(.)\\1*");
public static boolean isOneChar(String str) {
    return ONE_CHAR_PATTERN.matcher(str).matches();
} 
```

我想出了许多其他方法来做到这一点，但使用正则表达式（如上）是我能想出的唯一简单的方法，它可以正确处理 unicode 基本多语言平面之外的字符，例如

```
System.err.println(isOneChar("")); 
```

在处理 BMP 之外的字符时，不能依赖字符串上的 charAt 或 length 来返回字符或字符数。

如果正确处理 unicode，dreamcrashes 的答案可能如下所示：

```
public static boolean isOneChar(String string) {
    if(string == null || string.isEmpty()) return false; // probably, could also make an argument for empty being true.
    int startCodePoint = Character.codePointAt(string, 0);
    int length = string.length();
    int position = Character.charCount(startCodePoint);
    while (position < length) {
        int thisCodePoint = Character.codePointAt(string, position);
        if (thisCodePoint != startCodePoint) return false;
        position += Character.charCount(thisCodePoint);
    }
    return true;
} 
```

这是另一种可能性，基于 Satyajit 提出的替代想法：

```
public static boolean isOneChar(String string) {
    String firstCharacter = string.substring(0, string.offsetByCodePoints(0, 1));
    return string.replaceAll(Pattern.quote(firstCharacter), "").length() == 0;
} 
```

我认为这是低效的（因为它正在替换），但我实际上并没有对其进行性能测试......

StringTokenizer 可以正确处理 unicode 字符，因此您也可以执行以下操作：

```
public static boolean isOneChar(String string) {
    String firstChar = string.substring(0, string.offsetByCodePoints(0, 1));
    return new StringTokenizer(string, firstChar).countTokens() == 0;
} 
```

同样，实际上不需要一直遍历字符串，所以我认为这不如正则表达式解决方案有效。

# python - 从 Sublime Text 2 中的值列表填充片段

> ID：13168374
> 
> 赞同：1
> 
> 时间：2012-10-31T22:29:49.793
> 
> 标签：python, sublimetext2, code-snippets

我有一个值列表，我想用作片段的输入

*   我创建了一个包含占位符变量的基本片段

*   我有一个值列表作为 Python 列表（可以是字符串列表，如果使用更复杂的值，可以是字典列表）

通过使用 Sublime Text 2 对列表中的每个值运行代码段来生成基于输出文本的最轻松的方法是什么？有哪些方式可以通过输入数据以编程方式调用片段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:51:05.303

您可以使用它`run_command`来执行 UI 中可见的任何操作：

```
view.run_command("insert_snippet", {"name": "Packages/etc/my.sublime-snippet"})
view.run_command("insert", {"characters": "field 1"})
view.run_command("next_field")
view.run_command("insert", {"characters": "field 2"})
view.run_command("next_field")
view.run_command("insert", {"characters": "field 3"}) 
```

查找命令名称和参数的一个好方法是使用 Tools -> Record Macro 记录宏，然后查看生成的 JSON。

# actionscript - 带 Loader 的外部游戏在 Flash、Action Script 3 中不起作用

> ID：13168378
> 
> 赞同：4
> 
> 时间：2012-10-31T22:30:10.450
> 
> 标签：actionscript, flash, embed, loader

我想将第 3 方游戏加载到我自己的 swf 中，这样我就可以给它拍照了。我正在`flash.display.Loader`为加载部分使用标准类。

第 3 方游戏示例： http: [//andkon.com/arcade/adventureaction/megaminer/megaminer.swf](http://andkon.com/arcade/adventureaction/megaminer/megaminer.swf)

[将其嵌入](http://jsbin.com/iwabib/1/)到 html 文档中似乎可以正常工作，但不适用于`Loader`.

所以它显然在一种情况下有效，必须有一种方法来使用 ActionScript 加载它，就像简单的 html`<embed>`一样。

没有错误消息，`Event.COMPLETE`火灾，但游戏卡在加载屏幕。

*（旁注：我有一个可以完美加载一些游戏的工作脚本，但有些像这样的脚本无法正常加载。我还在 PHP 中设置了一个代理来解决跨域权限错误）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T19:15:30.873

在我看来，它加载得很好（当您直接链接到游戏时，它仍然停留在加载屏幕上，这表明这是正确的行为）。

~~所以问题不在于加载，而在于您将其加载到的包装器。当您在托管的任何网站上查看它时，您很可能正在查看将游戏加载到其中的包装 swf - 并且根据托管它的网站的指南，包装 swf 将调用*启动*函数或类似的东西开始它。您需要查看需要在 swf 上调用什么来启动它。~~

您也许可以查看托管它的网站，看看他们是否公开发布了针对游戏开发者的指导方针，但我环顾四周，看起来不像他们这样做。

~~或者您可以反编译包装器 swf 并查看它正在调用什么函数……尽管我不保证他们会同意您这样做。~~

* * *

所以没有包装器 swf... 也许游戏在开始之前检查它的宽度和高度是否与预定义的大小匹配？

# python - python multiprocessing.Process.Manager 没有产生一致的结果？

> ID：13168380
> 
> 赞同：1
> 
> 时间：2012-10-31T22:30:14.377
> 
> 标签：python, multiprocessing, python-multiprocessing

我编写了以下代码来说明我看到的问题。我正在尝试使用 a`Process.Manager.list()`来跟踪列表并增加该列表的随机索引。

每次产生 100 个进程时，每个进程都会将列表的随机索引增加 1。因此，人们会期望结果列表的 SUM 每次都相同，对吗？我得到介于 203 和 205 之间的东西。

```
from multiprocessing import Process, Manager
import random

class MyProc(Process):
    def __init__(self, A):
        Process.__init__(self)
        self.A = A

    def run(self):
        i = random.randint(0, len(self.A)-1)
        self.A[i] = self.A[i] + 1

if __name__ == '__main__':
    procs = []
    M = Manager()
    a = M.list(range(15))
    print('A: {0}'.format(a))
    print('sum(A) = {0}'.format(sum(a)))

    for i in range(100):
        procs.append(MyProc(a))

    map(lambda x: x.start(), procs)
    map(lambda x: x.join(), procs)
    print('A: {0}'.format(a))
    print('sum(A) = {0}'.format(sum(a))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:59:16.583

正如**millimoose**指出的那样，这里的问题是发生在`self.A[i] = self.A[i] + 1`. 在计算出时间时`self.A[i] + 1`，`self.A[i]`可能已经被另一个进程更改了。

您的问题的一个可能解决方案是您的问题是将索引传递回父级，然后执行加法。

```
from multiprocessing import Process, Manager
import random

class MyProc(Process):
    def __init__(self, B, length):
        Process.__init__(self)
        self.B = B
        self.length = length

    def run(self):
        i = random.randint(0, self.length-1)
        self.B.append(i)

if __name__ == '__main__':
    procs = []
    M = Manager()
    a = range(15)
    b = M.list()
    print('A: {0}'.format(a))
    print('sum(A) = {0}'.format(sum(a)))

    for i in range(100):
        procs.append(MyProc(b, len(a)))

    map(lambda x: x.start(), procs)
    map(lambda x: x.join(), procs)

    for i in b:
        a[i] = a[i] + 1

    print('A: {0}'.format(a))
    print('sum(A) = {0}'.format(sum(a))) 
```

将元素附加到数组只是一种操作，因此避免了竞争条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:58:44.517

答案是通过上面的评论得出的，因为以下行而发生了竞争条件：

```
self.A[i] = self.A[i] + 1 
```

实际上是两个操作，a`__getitem__`和a`__setitem__`

# android - 如何在 Eclipse 中查看 ActionBarSherlock displayOptions 的变化？

> ID：13168384
> 
> 赞同：0
> 
> 时间：2012-10-31T22:30:45.670
> 
> 标签：android, android-actionbar, actionbarsherlock, android-xml

我刚开始`ActionBarSherlock`，我设置了自定义样式：

```
<style name="AppTheme.ActionBar" parent="@style/Theme.Sherlock.Light">
    <item name="actionBarStyle">@style/actionBarStyle</item>
    <item name="android:actionBarStyle">@style/actionBarStyle</item>
</style>

<style name="actionBarStyle" parent="@style/Widget.Sherlock.Light.ActionBar">
    <item name="android:background">@drawable/header_bar</item>
    <item name="background">@drawable/header_bar</item>
    <item name="android:displayOptions">showTitle</item>
    <item name="displayOptions">showTitle</item>
</style> 
```

并将其应用于清单中的活动。

如果我在 Eclipse 的查看器中打开 Activity 的 XML 布局文件，我可以看到背景，但 displayOptions 不会更改查看器，而且我总是看到默认的图标+徽标。

在模拟器中运行应用程序会按预期显示 ActionBar。

为什么会这样？是否可以在 Eclipse 的布局编辑器中看到实际结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:39:43.203

我假设您的构建目标是>API Level 13，因此您在 Eclipse 中的 GUI 编辑器会向您显示默认的 ActionBar。ActionBarSherlock 是第三方库。它不会改变 XML 编辑器的外观。简而言之：不，AFAIK 无法在 GUI 编辑器中看到实际的 ActionBarSherlock。如果您想查看它，您还必须设置默认 ActionBar 的样式（只是为了预览它）。

要设置默认 ActionBar 的样式，您必须使用这些父样式：

`@android:style/Theme.Holo.Light`（而不是`@style/Theme.Sherlock.Light`）

对于动作栏：

`@android:style/Widget.Holo.Light.ActionBar`（而不是`@style/Widget.Sherlock.Light.ActionBar`）

# emacs - 带有 4 个空格键的 Emacs BSD/Allman 风格？

> ID：13168388
> 
> 赞同：0
> 
> 时间：2012-10-31T22:30:57.123
> 
> 标签：emacs, coding-style, elisp

使用这个 emacs lisp 设置最终会使用 BSD/Allman 样式的大括号，但会引入带有 8 个空格的制表符。

```
(add-hook 'c-mode-hook
          (lambda ()
            (c-set-style "linux"))) 
```

如何保持 Allman 风格的大括号但将制表符空格保持在 4？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:38:28.120

我不使用`c-set-style`，所以也许这个建议不适合你的环境。我的初始化文件中有：

```
(custom-set-variables
 ...
 '(c-basic-offset 8)
 ...) 
```

因此，设置`c-basic-offset`为 4 after`c-set-style`可能会奏效：

```
(add-hook 'c-mode-hook
          (lambda ()
            (c-set-style "linux")
            (setq c-basic-offset 4))) 
```

看`C-h f c-set-style`。也许，玩弄`DONT-OVERRIDE`也可能有帮助。

# javascript - 将屏幕输出居中到屏幕宽度

> ID：13168392
> 
> 赞同：0
> 
> 时间：2012-10-31T22:31:28.510
> 
> 标签：javascript

将屏幕输出居中到屏幕宽度

我在这里使用 3GL 逻辑来初始化一个全局变量 (ScreenX) 来表示屏幕的起始 X 位置，从该位置将显示 1024px 宽的页面。

这是将所有内容都集中在屏幕上的正确方法，还是 Web 脚本世界为这项任务提供了其他东西？

感谢您的输入。代码如下……</p>

```
 <!DOCTYPE html>
 <html><body>

 <script>

 if (screen.width>1024)
  {
  ScreenX=(screen.width-1024)/2;
  }
 else
   {
  ScreenX=0;
   }

 </script>

 </body></html> 
```

# scala - for循环中的Scala类型不匹配错误

> ID：13168401
> 
> 赞同：6
> 
> 时间：2012-10-31T22:32:06.917
> 
> 标签：scala, types

我正在尝试在 Scala 中编写一个反向方法，该方法接受一个列表并返回反向。我有：

```
object Reverse {
  def reverseList(list: List[Int]): List[Int] = {
    var reversed: List[Int] = List()
    for (i <- list) {
      reversed = i :: reversed
    }
  }
  def main(args: Array[String]) {
    println(reverseList(List(1,2,3,4)))
  }
} 
```

但是当我尝试编译时，我得到：

```
example.scala:4: error: type mismatch;
 found   : Unit
 required: List[Int]
    for (val i <- list) {
               ^ 
```

List "list" 被声明为 List[Int] 类型。为什么它被识别为类型单元？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:40:22.240

`reversed`在 for 循环之后添加。在 Scala 中，函数的最后一行是返回值。`for (i <- list){...}`回报`Unit`。_

```
object Reverse {
  def reverseList(list: List[Int]): List[Int] = {
    var reversed: List[Int] = List()
    for (i <- list) {
      reversed = i :: reversed
    }
    reversed
  }
  def main(args: Array[String]) {
    println(reverseList(List(1,2,3,4)))
  }
} 
```

# c# - 未找到带有 Access 数据库的 Visual Studio 项目已发布的项目数据库

> ID：13168403
> 
> 赞同：1
> 
> 时间：2012-10-31T22:32:26.620
> 
> 标签：c#, ms-access

我在 Visual Studio 中编写了一个使用 Access 数据库的程序。当我通过 Visual Studio 运行程序时，它按预期工作，但是当我发布到程序时它不会运行，因为找不到数据库文件。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:50:17.213

右键单击您的项目，然后选择属性-> 发布-> 应用程序。

将数据库文件的**'Publish Status'**属性从**'Include (Auto)'**更改为**'Data File'**，使文件为**Required**和**Include**。

# jquery-ui-dialog - 如何使jquery ui对话框不限于视口

> ID：13168406
> 
> 赞同：1
> 
> 时间：2012-10-31T22:32:46.323
> 
> 标签：jquery-ui-dialog

该文件说：基本对话框窗口是位于视口内的覆盖层。

有没有办法让它在视口之外部分可拖动？就像Windows系统的窗口一样，你可以把它拖到屏幕外的99%。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T00:58:38.997

我在这里找到了答案：[jQuery UI Dialog / Drag Question](https://stackoverflow.com/questions/6696461/jquery-ui-dialog-drag-question)

```
if (!$.ui.dialog.prototype._makeDraggableBase) {
    $.ui.dialog.prototype._makeDraggableBase = $.ui.dialog.prototype._makeDraggable;
    $.ui.dialog.prototype._makeDraggable = function() {
        this._makeDraggableBase();
        this.uiDialog.draggable("option", "containment", false);
    };
} 
```

这很神奇，谢谢。

顺便说一句：您可能需要添加“溢出：隐藏；” 某处，例如 body {overflow: hidden;}

# c++ - 函数参数到子类c++的转换

> ID：13168408
> 
> 赞同：2
> 
> 时间：2012-10-31T22:32:58.737
> 
> 标签：c++, parameters, implicit-conversion

我有一个非虚拟接口（NVI）的父类：

```
class Parent {
private:
    virtual int do_function(void) = 0;
public:
    int function(void);
    virtual ~Parent() {};
} 
```

和一个子类（实际上，我有很多子类，但我希望只有一个这样工作）

```
class Child : public Parent {
private:
    int _x;
    int do_function(void) { return _x; };
public:
    Child(int x): Parent(), _x(x) {}
    virtual ~Child() {return do_function();};
} 
```

我想调用一个函数：

```
int myFunction(Parent& x) {
    return x.function();
} 
```

使用代码

```
int x = 5;
myFunction(x); 
```

但不是

```
int myFunction(const Child& x) {
    return x.function();
} 
```

效果很好。是否可以通过类型的隐式转换来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:08:21.833

基本上，您想隐式创建一个用 x 构造的子对象，然后将其传递给`myFunction( Parent& )`.

你可以做`myFunction(Child(x));`

但我认为，当您尝试使用 bare 时`x`，它​​会尝试构造一个对象：`Parent(x)`但它失败了。无论如何，这不是您想要的，因为您**确实**想要一个 Child 对象的实例。

make_pair 执行类似操作的方式是在正在创建的对象（对）上使用模板复制构造函数，该对象创建所需类型的对象。

我认为你想做的事情不能以这种方式完成，因为你想创建派生类，它不会尝试这样做，因为函数签名是`Parent&`.

**编辑和替代解决方案** 我尝试通过向 Parent 类添加模板化构造函数来创建基于模板的解决方案，但它确实归结为最终您需要为派生类调用构造函数的事实。

我认为允许使用的唯一明智的解决方案`myFunction(Parent&)`是使用间接方法，该方法在构造（临时？）孩子之后返回对 Parent 的引用 - 这当然意味着如果你有很多孩子，你会有很多这样的方法类。我意识到这并不像传入 int 那样简单（并让它构造并传入 ref），但这几乎是你想要的:)

# unit-testing - Scala中的JUnit测试类别？

> ID：13168411
> 
> 赞同：4
> 
> 时间：2012-10-31T22:33:03.563
> 
> 标签：unit-testing, scala, junit

我让它工作了！我将这里的 Java 逐行翻译成 Scala：

[https://github.com/junit-team/junit/blob/master/doc/ReleaseNotes4.8.md](https://github.com/junit-team/junit/blob/master/doc/ReleaseNotes4.8.md)

大多数情况下，这意味着执行 Array(classOf[ClassName])、删除“公共”关键字等。我的 IntelliJ IDE 提供了很多建议。

* * *

我希望能够运行测试类别，因此我可能将一类测试标记为“Version2dot3”和“SlowTest”，然后能够仅运行“慢速测试”，或运行“慢速测试和 2.3 测试”。

我一直在尝试使这篇文章适应我的 Scala 测试：

[http://weblogs.java.net/blog/johnsmart/archive/2010/04/25/grouping-tests-using-junit-categories-0](http://weblogs.java.net/blog/johnsmart/archive/2010/04/25/grouping-tests-using-junit-categories-0)

我有一个几乎可以工作的基本 shell 设置，但是`java.lang.Exception: No runnable methods`当我尝试运行 testSuite 时出现错误。

想法？我已经成功地能够使用 SuiteClasses 仅运行某些测试类，但无法运行测试类别（@Category 注释）。

```
import org.junit.experimental.categories.{Categories, Category}
import org.junit.runners.Suite.SuiteClasses
import org.scalatest.FunSuite
import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner

@RunWith(classOf[JUnitRunner])
@Category(Array(classOf[SlowTests]))
class FunSuiteTest extends FunSuite with DemoHelpers {
  test("demoTest1") {
    println("\n\nrunning DemoTest1...\n\n")
  }
}

@RunWith(classOf[JUnitRunner])
@Category(Array(classOf[SlowTests]))
class FunSuiteTest2 extends FunSuite with DemoHelpers {
  test("demoTest2") {
    println("\n\nrunning DemoTest2...\n\n")
  }
}

@RunWith(classOf[Categories])
@SuiteClasses(Array(classOf[SlowTests]))
class testSuite {

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T22:36:26.920

将此处的 Java 逐行翻译成 Scala：

[https://github.com/junit-team/junit/blob/master/doc/ReleaseNotes4.8.md](https://github.com/junit-team/junit/blob/master/doc/ReleaseNotes4.8.md)

大多数情况下，这意味着执行 Array(classOf[ClassName])、删除“public”关键字等。

带有 Scala 插件的 IntelliJ IDE 对建议有很大帮助。

# c# - 如何访问网络摄像头设置（如 Skype）C#

> ID：13168415
> 
> 赞同：1
> 
> 时间：2012-10-31T22:33:19.193
> 
> 标签：c#, skype

> **可能重复：**
> [如何使用 DotNet 访问网络摄像头设置（如在 Skype 中）](https://stackoverflow.com/questions/8224748/how-to-access-web-camera-settings-like-in-skype-using-dotnet)

我发现了另一个问题“如何使用 DotNet 访问网络摄像头设置（如在 Skype 中）”，但它已经很老了，没有答案。我有几乎相同的问题。

我正在使用 SkypeKit 开发一个应用程序，并使其对用户更完整，我希望能够利用网络摄像头/音频/麦克风设置。

有没有使用 C# 或 skypekit 的简单方法？&任何建议。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:49:46.870

您可以使用[DirectShow](http://msdn.microsoft.com/en-us/library/windows/desktop/dd375454%28v=vs.85%29.aspx)或 .Net 包装器，例如[DirectShow.Net](http://directshownet.sourceforge.net/)。

以下是一些可以帮助您进行的项目：

[http://www.codeproject.com/Articles/18511/Webcam-using-DirectShow-NET](http://www.codeproject.com/Articles/18511/Webcam-using-DirectShow-NET)

[http://www.barebonescoder.com/2012/01/finding-your-web-cam-with-c-directshow-net/](http://www.barebonescoder.com/2012/01/finding-your-web-cam-with-c-directshow-net/)

# php - PHP：这个对象类型是什么，我如何添加它而不引起警告

> ID：13168425
> 
> 赞同：0
> 
> 时间：2012-10-31T22:34:22.573
> 
> 标签：php, object, spl

***我在这里和那里遇到过这个问题，我***一直在解决它，但我只是想知道。
这是一个数组，一个对象，还是？？？（假设我是通过这个`var_export($co)`）

```
stdClass::__set_state(array(
   'name' => 'Acme Anvil Corp.',
)) 
```

最重要的是，我怎样才能为它增加价值？
假设我想添加一个值，例如`$co->owner = 'Wiley Coyote'`. 这总是会引发警告。

如何？
什么？

好奇心简直要了我的命：）

**[编辑]**
作为澄清，我想我的问题的根源是“如何在不触发警告的情况下向对象添加变量？”

这是我经常收到的警告：

> 遇到 PHP 错误
> 严重性：警告
> 消息：尝试分配非对象的属性

和`var_dump($co)`产量：（目前在一个循环中完成，如果它是相关的）

```
object(stdClass)#185 (1) {
  ["name"]=>
  string(16) "Acme Anvil Corp."
} 
```

**[/编辑]**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:42:50.240

`$co`是类型的对象`stdClass`。您可以创建一个并添加任意数量的属性，而不会发出任何警告：

```
$obj = new stdClass();
$obj->prop1 = 'val1';
$obj->prop2 = 3.14; 
```

您面临的警告很可能是`Creating default object from null value`，这意味着您正在尝试将属性分配给未初始化的变量。

您不应该尝试运行`var_export`for`stdClass`对象生成的代码，因为它们没有 method `__setState`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:40:41.033

不太确定您的错误 - 但 stdClass 类是 PHP 内置类的默认值。

它基本上是一个空对象

您应该能够设置属性`$class->foo = 'bar'`

如果您不是在谈论 stdClass - 但事实上您在 var_export 中获得了一个数组 - 它只是内部对象状态的表示。

```
class Foo
{
    private $bar = 'baz';
}

$foo = new Foo();

var_export($foo); 
```

应该给出类似于

```
Foo::__set_state(array(
   'bar' => 'baz',
)) 
```

您收到的警告可能是由于财产受到保护/私有。

`var_dump()`通常告诉你关于内部对象的访问修饰符比`var_export()`

你能澄清你收到的警告是什么以及问题是什么，我会编辑我的答案以使其与你的要求相关

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T00:47:01.733

`var_export()`打印能够重新创建导出变量的可执行 PHP 代码。

当遇到对象时，它们总是被导出为对其静态魔法方法的调用`__set_state()`。与其他魔术方法相比，除了 var_export 保证使用此方法创建静态调用这一事实之外，此方法并没有真正的魔力，因此它只是此类方法的约定名称。

类的`__set_state()`方法应该返回对象的一个​​实例，其中所有导出的属性都设置为作为数组参数给出的值。

例子：

```
class Foo {
  public $bar;

  public static function __set_state($params) {
    $obj = new Foo;
    foreach ($params as $key => $value) {
      $obj->$key = $value;
    }
    return $obj;
  }
}

$foo = new Foo;
$foo->bar = "Hello World"; 
```

var_export($foo);

这会打印出类似的内容：

```
Foo::__set_state(array('bar' => 'Hello World')); 
```

如果您执行此操作并再次将其保存到变量中：

```
$x = Foo::__set_state(array('bar' => 'Hello World')); 
```

它将重新创建具有所有给定属性集的对象。

它不适用于 stdClass 对象，因为它们没有`__set_state()`方法。

有关详细信息，请参阅[http://de3.php.net/manual/en/language.oop5.magic.php#object.set-state](http://de3.php.net/manual/en/language.oop5.magic.php#object.set-state)。

更新：

此代码不会触发任何警告：

```
ini_set('display_errors', 1);
error_reporting(E_ALL | E_STRICT);

$co = new stdClass();

$co->name = 'Acme Anvil Corp.';

var_export($co);

$co->owner = 'Wiley Coyote'; 
```

# biztalk - 如何强制暂停当前消息并稍后从自定义 BizTalk **send** 管道组件中重试？

> ID：13168426
> 
> 赞同：2
> 
> 时间：2012-10-31T22:34:21.920
> 
> 标签：biztalk, custom-pipeline-component

这是我的场景。BizTalk 需要从共享/中央文档库传输文件。第一个 BizTalk 接收到带有库中此文档的引用/路径的传入消息。然后它只需要从这个库中读取它并发送它（可能通过不同的适配器）。这实质上是一个与 ClaimCheck EAI 模式相距不远的场景。

一些实现声明检查的方法已记录在案，特别是[BizTalk ESB 工具包声明检查](http://mikearnett.wordpress.com/2012/04/08/biztalk-esb-toolkit-claim-check/)和 BizTalk 2009：处理超大消息，第 I 部分和[第 II 部分](http://allcomputers.us/windows_server/biztalk-2009---dealing-with-extremely-large-messages-%28part-2%29---large-message-encoding-component.aspx)。然而，这些实现确实假设发送管道可以立即读取已“签入”的流。</p>

这不是我的情况：文档在共享库中可用之前需要一些时间，我**不能延迟**最初收到的消息。这给我留下了两个选择：要么通过编排引入一些延迟，要么确保发送端口稍后会在文档不存在时重试。

（延迟只能通过编排引入，BizTalk 中没有基于时间的订阅。对吗？）

由于这是一个仅消息流，我想我可以跳过编排。我已经看到了有关如何在“使用管道的仅消息解决方案中自定义重试逻辑”的方法，但我需要的不仅是一种控制重试行为（由适配器执行）的方法，而且还可以从管道内强制执行它…</p>

到目前为止，我所做的每一次尝试都以暂停消息结束，即使发送适配器已配置重试，也不会自动重试……如果这确实可能，那么我应该在哪里/做什么？

哦，对了……还有排队……但不幸的是，既不在本地也不在云端；）

好吧，我可能是在挑战极限……但只是出于好奇……</p>

非常感谢您的帮助和建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T04:04:32.353

我对没有 Orch 怎么能做到这一点感到困惑。我能想到的唯一方法是：

*   初始消息的接收端口只是“吃掉”消息，例如，使用 Null 适配器将这些消息订阅到虚拟发送端口，完全忽略它们。
*   您使用接收端口监视共享文档库，寻找任何？任何新？文件在那里。
*   任何定位的文档都由发送端口订阅并发送到下游。

基于编排的方法将遵循以下原则：

*   Orch 是由接收到库中“即将到来的”新文件的初始通知触发的。如果您的初始通知是请求响应（例如暴露的 Web 服务，您可以立即同步发出响应）
*   另一个*接收*端口用于监视共享库中文件的可用性和检索，与原始通知消息相关（例如，通过文件名或其他键）
*   一种在文档不可用时处理重试的机制，并且可能会导致最终超时，例如，如果文档从未进入共享库。
*   成功后，发送端口将文档发送到下游

与在自定义适配器或管道代码中使用或类似方法相比，将延迟形状放置在 Orch 中将提供更大的可扩展性`Thread.Sleep()`，因为 BTS 仅计算 SQL 记录上的“唤醒”时间戳，然后可以使 orch 脱水，从而释放线程。

'文件还在吗？检查可以通过重试循环完成，每次检查失败后延迟，并行分支超时，例如一个小时左右。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T17:16:00.407

轮询间隔可以在接收位置控制，所以我不明白 Biztalk 中没有基于时间的订阅是什么意思。您还有一个日程安排窗口。

引入延迟的一种方法是将初始消息发送到内部 Web 服务，该服务将在指定的时间间隔后将消息简单地回传到 Biztalk。

还有环回适配器，它只是将消息发送回消息框。这可以修改以增加延迟。

# java - 在数据库中插入/选择 joda-time 日期类型

> ID：13168427
> 
> 赞同：0
> 
> 时间：2012-10-31T22:34:28.817
> 
> 标签：java, jdbc, jodatime

使用 JDBC 将 jodatime 对象插入数据库的最佳方法是什么，以及如何从中获取它们？我曾经使用 MutableDateTime，并在插入之前将其转换为 Timestamp。但是当我想从数据库中获取我的数据时，我遇到了一个问题......我不知道该怎么做，以及如何解析类型。再说一次：如何将 Joda-Time 对象插入/从数据库中插入和选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:10:15.643

如果您有时间戳，并且想将其转换回 MutableDateTime，您只需要

```
new MutableDateTime(timestamp.getTime()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T16:41:25.547

您可以使用支持自定义类型的 ORM。例如，[sormula Joda Time 示例](http://www.sormula.org/jodatime/)。实现一个像**LocalDateTranslator这样的**[TypeTranslator](http://www.sormula.org/javadoc/org/sormula/translator/TypeTranslator.html)并且所有使用相应的类**LocalDate**将使用类型转换器来转换到/从 db 中的列。

 ****```
@ExplicitType(type=LocalDate.class, translator=LocalDateTranslator.class)
public class StudentLD
{
    int id;
    String firstName;
    String lastName;
    LocalDate graduationDate;
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T12:12:28.293

JodaTime 对象比 SQL 和大多数（如果不是全部）数据库支持的 DateTime 数据类型更具表现力，因此没有通用的万无一失的方法。[相关问题](https://stackoverflow.com/questions/2916942/does-a-library-exist-with-joda-time-ibatis-integration-classes)****

# .net - 测量 TPL 中的并行度

> ID：13168429
> 
> 赞同：4
> 
> 时间：2012-10-31T22:34:57.927
> 
> 标签：.net, task-parallel-library

任务并行库和 TPL 数据流允许指定最大并行度。该值是一个上限，而不是保证。实际上，TPL 将根据包括系统资源在内的许多因素确定实际并行度，而不会超过任何程序员指定的最大值。

是否有某种机制可以确定 TPL 在某个时间点对并行度所做的选择？

我之所以这么问，是因为我移植了一些相当复杂的代码来使用 TPL Dataflow，并且整体吞吐量远低于原始代码。我想看看 TPL 代表我做出了哪些选择，以了解它为什么慢得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:34:22.903

我遇到了和你非常相似的情况。我最终使用我的日志数据来*大致*告诉我每分钟使用了多少线程。这给了我一个粗略的数字，但并不准确。

我不相信 TPL 可以为您提供有关线程使用的遥测。如果你想实现更精确的东西，我建议在每个任务/线程中实现逻辑，以标记它开始时间和结束时间的一些共享列表。这是我将如何开始的示例。

```
public class DoSomeTPLWork
{
    public static void Start()
    {
        List<int> numberList = Enumerable.Range(1, 1000).ToList();

        Parallel.ForEach(numberList, number =>
            {
                ThreadTracking.ThreadStarted();

                int square = number * number;
                Console.WriteLine("Square of {0} is {1}", number, square);

                ThreadTracking.ThreadFinished();
            }
        );

        var threadInfo = ThreadTracking.GetThreadInfo();
    }
}

public class ThreadTracking
{
    private static ConcurrentBag<ThreadInfo> _threadInfo = new ConcurrentBag<ThreadInfo>();

    public static void ThreadStarted()
    {
        var threadInfo = new ThreadInfo(Thread.CurrentThread.ManagedThreadId);
        threadInfo.Start();
        _threadInfo.Add(threadInfo);
    }

    public static void ThreadFinished()
    {
        var threadInfo = _threadInfo.Where(ti => ti.ThreadId == Thread.CurrentThread.ManagedThreadId && !ti.Complete).SingleOrDefault();
        if(threadInfo != null)
        {
            threadInfo.Stop();
        }
    }

    public static List<ThreadInfo> GetThreadInfo()
    {
        return _threadInfo.ToList();
    }
}

public class ThreadInfo
{
    public bool Complete { get; set; }
    public int ThreadId { get; set; }
    public DateTime? TimeStarted { get; set; }
    public DateTime? TimeFinished { get; set; }

    public ThreadInfo(int threadId)
    {
        ThreadId = threadId;
    }

    public void Start()
    {
        TimeStarted = DateTime.Now;
        Complete = false;
    }

    public void Stop()
    {
        TimeFinished = DateTime.Now;
        Complete = true;
    }
} 
```

使用这些数据，您可以通过添加更多方法来查询数据或在 Excel 中将其弹出以使用它来查看在任何给定的秒内使用了多少线程。

# ios - 对许多人的核心数据谓词

> ID：13168433
> 
> 赞同：0
> 
> 时间：2012-10-31T22:35:50.193
> 
> 标签：ios, core-data, one-to-many

我有一个具有一对多关系的核心数据模型，有一个类别，它可以包含许多子类别。

类别 <---->> 子类别

我正在尝试执行检查特定类别是否包含具有特定名称的子类别的提取。假设我在下面有两个类别，我想查看名为“Fruits”的类别中是否有任何子类别名称为“Apple”。

```
 Vetegables
    - Carrot
    - Lettuce

 Fruits
    - Apple
    - Orange
    - Pear 
```

代码：

```
- (SubCategory *)searchForSubCategoryWithName:(NSString *)subCategory
                                   inCategory:(Category *)category
{
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"SubCategory" inManagedObjectContext:self.beer.managedObjectContext];
    [fetchRequest setEntity:entity];

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name == [c] %@", subCategory];
    [fetchRequest setPredicate:predicate];

    NSError *error;
    NSArray *fetchedObjects = [self.beer.managedObjectContext executeFetchRequest:fetchRequest error:&error];

    if (fetchedObjects != nil && fetchedObjects.count > 0) {
        return [fetchedObjects objectAtIndex:0];
    }
    else {
        return nil;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:58:59.987

尝试寻找具有您喜欢的子类别的类别实体，而不是相反，然后从结果中返回 category.subcategory。我不确定你的 NSManagedObjects 是什么样子，但试试这个：

```
- (SubCategory *)searchForSubCategoryWithName:(NSString *)subCategory
                                   inCategory:(Category *)category
{
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Category" inManagedObjectContext:self.beer.managedObjectContext];
    [fetchRequest setEntity:entity];

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"subcategory.name == [c] %@ AND name == %@", subCategory, category.name];
    [fetchRequest setPredicate:predicate];

    NSError *error;
    NSArray *fetchedObjects = [self.beer.managedObjectContext executeFetchRequest:fetchRequest error:&error];

    if (fetchedObjects != nil && fetchedObjects.count > 0) {
        Category *categoryManagedObject = [fetchedObjects objectAtIndex:0];
        return categoryManagedObject.subcategory;
    }
    else {
        return nil;
    }
} 
```

...或者只是将类别添加到您的谓词中，您应该在子类别托管对象定义中包含它：

```
- (SubCategory *)searchForSubCategoryWithName:(NSString *)subCategory
                                       inCategory:(Category *)category
    {
        NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
        NSEntityDescription *entity = [NSEntityDescription entityForName:@"Category" inManagedObjectContext:self.beer.managedObjectContext];
        [fetchRequest setEntity:entity];

        NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name == [c] %@ AND category == %@", subCategory, category];
        [fetchRequest setPredicate:predicate];

        NSError *error;
        NSArray *fetchedObjects = [self.beer.managedObjectContext executeFetchRequest:fetchRequest error:&error];

        if (fetchedObjects != nil && fetchedObjects.count > 0) {
            return [fetchedObjects objectAtIndex:0];
        }
        else {
            return nil;
        }
    } 
```

# javascript - Javascript mouseover/mouseout 动画按钮

> ID：13168440
> 
> 赞同：2
> 
> 时间：2012-10-31T22:36:49.307
> 
> 标签：javascript, button, animated

我有一个按钮和鼠标悬停，我希望它以 10 像素的速度向右移动 100 像素然后停止。移动不是问题，它是停止。我可以用 jquery 做到这一点，但我需要学习如何在 javascript 中从头开始。这是我到目前为止的脚本。

```
function rollRight() {      
    imgThumb.style.left = parseInt (imgThumb.style.left) + 10 + 'px';
    animate = setTimeout(rollRight,20);
} 
```

这让它移动得很好，所以为了阻止它，我尝试将循环数量 5x10=50px 并再次写为

```
function rollRight() {
    var i=0;
    while (i < 5) {     
    imgThumb.style.left = parseInt (imgThumb.style.left) + 10 + 'px';
    animate = setTimeout(rollRight,20);
    i++;
    };
} 
```

现在，我想我错过了让它返回 while 函数的 [] 值的部分，但我不确定如何让它工作。一旦我有正确的移动，我可以应用相同的原则将它移回onmouseout。

如果有人可以帮我解决这个问题，那就太好了。如果你有一个更好的脚本来做动画，只是 javascript，没有库，那也很好。

编辑：因为将其作为评论保留效果不佳，这是我当前的代码

```
function rollRight() {   
    var left = parseInt (imgThumb.style.left);
    if(left < 50) { // or any other value   
    imgThumb.style.left = left + 10 + 'px';
    animate = setTimeout(rollRight,20);
    }
}

function revert() {   
    var left = parseInt (imgThumb.style.left);
    if(left < 50) { // or any other value   
    imgThumb.style.left = left + -10 + 'px';
    animate = setTimeout(rollRight,20);
    }
} 
```

在还原中，我无法将其移回。它可能在 if(left<50) 部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:48:46.963

```
var animate = null;

function rollRight() { 
    if(animate) clearTimeout(animate);  
    var left = parseInt (imgThumb.style.left);
    if(left < 50) { // or any other value   
        imgThumb.style.left = left + 10 + 'px';
        animate = setTimeout(rollRight,20);
   }
}

function revert() {
    if(animate) clearTimeout(animate);
    var left = parseInt (imgThumb.style.left);
    if(left > 0) {
        imgThumb.style.left = (left - 10) + 'px';
        animate = setTimeout(revert,20); 
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:49:02.770

如果您想坚持使用 setTimeout，那么您就已经接近第一个了。我将一些硬编码的数字移动到变量中：

```
var totalPixels = 100;
var increment = 10;
var frameTime = 20;
var numFrames = totalPixels / increment;
var curFrame = 0;

function rollRight() {      
    imgThumb.style.left = parseInt (imgThumb.style.left) + increment + 'px';

    if(curFrame++ < numFrames) {
        animate = setTimeout(rollRight,frameTime);
    }
} 
```

您也可以切换到使用 setInterval ，然后每次触发间隔时，根据一些递增值决定是否应该停止间隔。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T22:46:51.323

尝试这个

```
var i = 0;
var moveInterval = setInterval(function(){
    if(i>=5) clearInterval(moveInterval);       
    rollRight();
    i++;
},20);

function rollRight() {      
    imgThumb.style.left = parseInt (imgThumb.style.left) + 10 + 'px';
} 
```

一旦达到5，它将清除间隔，并完成。

# java - 固定幂指数的递归方法

> ID：13168441
> 
> 赞同：0
> 
> 时间：2012-10-31T22:36:48.867
> 
> 标签：java, methods, recursion

是否可以创建一个将单个 int 作为参数并将传递的 int 返回到 10 次方的递归方法？

这是我到目前为止所拥有的，但我收到 StackOverFlow 错误：

```
public static int exponent(int baseNum) {                       

   return baseNum * exponent(baseNum); 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:40:51.767

您忘记告诉递归函数何时停止递归。它会永远消失，这就是你得到堆栈错误的原因。

```
public static int exponent(int baseNum, int exp) {
   if (exp == 0)
       return 1;
   else
       return baseNum * exponent(baseNum, --exp); 
} 
```

现在您可以通过调用获得 32^10：

```
exponent(32, 10); 
```

如果你想要一个专门的函数来将一个数字提高到 10 的幂，那么你可以重载指数方法：

```
public static int exponent(int baseNum) {
   return exponent(baseNum, 10); 
} 
```

当然，仅适用于指数值 >= 0。

# php - 在 cakePHP 1.3 中使用纯 jQuery AJAX

> ID：13168443
> 
> 赞同：0
> 
> 时间：2012-10-31T22:36:57.603
> 
> 标签：php, jquery, ajax, cakephp-1.3

我正在使用 cakePHP 1.3，并且想在我的搜索视图中使用 AJAX 到我的控制器中的搜索操作。我正在使用原型和 scriptaculous，它工作正常，但需要使用纯 jQuery。

搜索动作基本上如下所示：

```
 public function search() {
    if (empty($this->data)) {
    } else {
        $request = $this->data;
        $this->set('data', $this->Event->search($request['Event']['search']));
    }  
} 
```

该视图当前如下所示：

```
<script type="text/javascript">

$(function() {

    $(".search_button").click(function() {
        var searchString    = $("#search_box").val();
        var data = searchString;

        if(searchString) {

            $.ajax({
                type: "POST",
                url: "/events/search",
                data: data,
                beforeSend: function(html) { // this happens before actual call
                    $("#results").html('');
                    $("#searchresults").show();
                    $(".word").html(searchString);
                },
                success: function(html){ // this happens after we get results
                    $("#results").show();
                    $("#results").append(html);
                }
            });    
        }
        return false;
    });
});
</script>

<div id='container'>
<h1>Corporate Events</h1> 

<form method="post" action="search">
    <input type="text" name="search" id="search_box" class='search_box'/>
    <input type="submit" value="Search" class="search_button" /><br />
</form>
<div id="searchresults">Search results :</div>
<ul id="results" class="update"> 
```

使控制器中的 $this->data 可以使用“数据”变量的最佳方法是什么？我用类似的问题检查了其他线程，但无法看到如何做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:48:07.200

将其作为 POST（请参阅[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)）或 url_encode（谷歌“javascript url 编码”）字符串发送并将其附加到 url。不确定哪个更好，两者都应该工作并且易于实施。

# ruby-on-rails - 运行 rake db:migrate 时，Rails 创建迁移以向表中添加列会导致错误

> ID：13168450
> 
> 赞同：22
> 
> 时间：2012-10-31T22:37:16.620
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, migration

我创建了一个名为“users”的模型，并创建了一个新的迁移以将一些列添加到 users 表中。现在，当我运行 rake db:migrate 时，我在 b/c 下面得到错误，它正在尝试再次创建用户表

```
$ rake db:migrate
==  DeviseCreateUsers: migrating ==============================================
-- create_table(:users)
rake aborted!
An error has occurred, all later migrations canceled:

Mysql::Error: Table 'users' already exists: CREATE TABLE `users`..... 
```

为什么它试图再次创建表？

这是我用来创建新迁移的命令

```
$ rails generate migration AddDetailsToUsers home_phone:decimal cell_phone:decimal work_phone:decimal birthday:date home_address:text work_address:text position:string company:string 
```

新的迁移如下所示：

```
class AddDetailsToUsers < ActiveRecord::Migration
  def change
    add_column :users, :home_phone, :decimal
    add_column :users, :cell_phone, :decimal
    add_column :users, :work_phone, :decimal
    add_column :users, :birthday, :date
    add_column :users, :home_address, :text
    add_column :users, :work_address, :text
    add_column :users, :position, :string
    add_column :users, :company, :string
  end
end 
```

**编辑**

20120511224920_devise_create_users

```
class DeviseCreateUsers < ActiveRecord::Migration
  def change
    create_table(:users) do |t|
      ## Database authenticatable
      t.string :email,              :null => false, :default => ""
      t.string :username,           :null => false, :default => ""
      t.string :encrypted_password, :null => false, :default => ""

      ## Recoverable
      t.string   :reset_password_token
      t.datetime :reset_password_sent_at

      ## Rememberable
      t.datetime :remember_created_at

      ## Trackable
      t.integer  :sign_in_count, :default => 0
      t.datetime :current_sign_in_at
      t.datetime :last_sign_in_at
      t.string   :current_sign_in_ip
      t.string   :last_sign_in_ip

      ## Encryptable
      # t.string :password_salt

      ## Confirmable
      # t.string   :confirmation_token
      # t.datetime :confirmed_at
      # t.datetime :confirmation_sent_at
      # t.string   :unconfirmed_email # Only if using reconfirmable

      ## Lockable
      # t.integer  :failed_attempts, :default => 0 # Only if lock strategy is :failed_attempts
      # t.string   :unlock_token # Only if unlock strategy is :email or :both
      # t.datetime :locked_at

      ## Token authenticatable
      # t.string :authentication_token

      t.timestamps
    end

    add_index :users, :email,                :unique => true
    add_index :users, :reset_password_token, :unique => true
    # add_index :users, :confirmation_token,   :unique => true
    # add_index :users, :unlock_token,         :unique => true
    # add_index :users, :authentication_token, :unique => true
  end
end 
```

20120619023856_add_name_to_users

```
class AddNameToUsers < ActiveRecord::Migration
  def change
    add_column :users, :first_name, :string
    add_column :users, :last_name, :string
  end
end 
```

20121031174720_add_details_to_users.rb

```
class AddDetailsToUsers < ActiveRecord::Migration
  def change
    add_column :users, :home_phone, :decimal
    add_column :users, :cell_phone, :decimal
    add_column :users, :work_phone, :decimal
    add_column :users, :birthday, :date
    add_column :users, :home_address, :text
    add_column :users, :work_address, :text
    add_column :users, :position, :string
    add_column :users, :company, :string
  end
end 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-05T21:54:01.447

Rails 在数据库的“schema_migrations”表中跟踪迁移。除非有“20120511224920”条目，即设计迁移，否则它将尝试再次运行它，它似乎已经存在。

如果是这种情况，您可以手动将其添加到表中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T23:07:35.460

该错误表示它正在尝试再次运行原始的 DeviseCreateUsers 迁移并且不能因为用户表已经存在。

要解决此问题，您可以运行向下迁移`DeviseCreateUsers`，然后正常运行迁移。你可以这样做：

```
rake db:migrate:down VERSION=20121031XXXXXXXX
rake db:migrate 
```

`20121031XXXXXXXX`迁移名称的日期戳在哪里。换句话说，您将拥有一个名为的迁移`20120410214815_devise_create_users.rb`，并从文件名中复制日期戳并将其粘贴到命令中。[这是 Rails Guide on Migrations 供参考](http://guides.rubyonrails.org/migrations.html)。

**编辑：**这在评论中注明，但只是一个警告。运行表的向下迁移将丢失该表的所有条目。我假设您正在开发模式下运行，所以这应该不是问题。如果您在生产中，则需要采取额外的步骤来备份表数据并在之后重新加载，否则您将度过糟糕的一天（或一周）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-05T07:45:05.820

您可以尝试创建一个新数据库然后再次迁移它：

```
rake db:drop:all
rake db:create:all
rake db:migrate 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T03:29:27.520

因此，根据我从中收集到的信息：

*   你已经有一个用户模型
*   你在生产中有这个版本
*   你运行了一个默认的 rails generate devise:install
*   然后你运行 rails generate devise User

我希望：

*   您使用源代码控制
*   你检查代码很多

注意：如果没有，您将了解为什么需要这样做。

**将您的代码恢复到生成设计之前**

希望您可以在生成设计之前创建一个点的新沙箱。如果没有，请复制您的项目目录并手动完成。唯一的其他选项是手动编辑 Devise 生成的所有文件。

**重新运行您的设计生成**

*   将 gem 'devise' 读入你的 Gemfile
*   rails 生成设计：安装
*   rails 生成设计模型

确保该模型不存在！如果你不这样做，你就会陷入你目前遇到的问题。

**将当前用户从一种模型迁移到另一种模型**

如果您可以生成一个脚本以将身份验证信息从旧用户模型完全移动到新用户模型，那么对您有好处。如果您使用与 Devise 不同的哈希算法进行当前身份验证，那么您将使其所有密码无效并要求您的用户使用其电子邮件中的确认码创建新密码，或者您可以在用户登录时迁移他们第一种方法干净、完整、粗鲁。第二种方法是丑陋的、不完整的、沉默的。选择你喜欢的方法。

编辑：您可能会找到一种方法来自定义设计以使用您的算法。那可能会更好，但需要更多的工作并且相当脆弱。

另一件事是您的身份验证模型不应该因帐户数据而过载。您应该有一个只处理身份验证的模型，该模型具有帐户数据模型，该模型存储您可能想要跟踪的有关帐户的任何内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-07T05:58:57.570

使用 up 和 down 方法。这对于回滚和运行特定的迁移文件很有用。

请按照语法..

```
 class AddDetailsToUsers < ActiveRecord::Migration
    def self.up
      add_column :users, :home_phone, :decimal
      add_column :users, :cell_phone, :decimal
      add_column :users, :work_phone, :decimal
      add_column :users, :birthday, :date
      add_column :users, :home_address, :text
      add_column :users, :work_address, :text
      add_column :users, :position, :string
      add_column :users, :company, :string
   end

   def self.down
      remove_column :users, :home_phone
      remove_column :users, :cell_phone
      remove_column :users, :work_phone
      remove_column :users, :birthday
      remove_column :users, :home_address
      remove_column :users, :work_address
      remove_column :users, :position
      remove_column :users, :company
   end
  end

    In this case please try to migrate using version number. 
```

像 rake db:migrate:down VERSION=version number #version number 是您要迁移的版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-01T00:27:34.090

我猜你跑了`rails generate devise user`某个时候生成了`DeviseCreateUsers`. 如果你已经创建了 User 模型和 users 表，你可以从 db/migrate 中删除生成的迁移文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-08T19:12:54.857

检查可能为迁移版本提供意外值的一些环境变量。我在 Stack Overflow 上发现[了一个老问题](https://stackoverflow.com/questions/70318/rake-dbmigrate-doesnt-detect-new-migration)（如果它已经过时，请原谅我）在哪里`db:migrate`破坏了表，而不是应用现有的新迁移。

他们最终发现环境变量导致`db:migrate`以“0”的版本参数运行，这在功能上等同于`rake db:migrate:down`

您的情况是否可能是由于版本被意外更改为包含或匹配先前的迁移而导致的`DeviseCreateUsers`？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-06T07:28:34.983

你试一试

在第一个文件中

```
create_table(:users), :force => true do |t| 
```

这将覆盖任何其他表

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-26T06:13:49.240

根据您所说，您使用此命令创建了一个新的迁移

$ rails 生成迁移 AddDetailsToUsers home_phone:decimal cell_phone:decimal work_phone:decimalbirthday:date home_address:text work_address:text position:string company:string

我不确定它是否只是一个错字，但它应该是“AddDetailsToUser”而不是“Users”。请再次检查，我们将能够为您提供帮助。这是用于设计生成的模型。当您提到用户时，它会在 db 中查找用户。

Ruby on Rails 遵循语言约定。table_name 是复数，而 model_name 是单数。您必须在使用的命令中使用 model_name。

如果你想使用 table_name 然后使用这个

rails g migration add_details_to_users home_phone:decimal......等

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-10-14T22:27:05.357

如果您需要手动进行一些脏迁移：

```
class A < ActiveRecord::Migration
  def up
    add_column :images, :name
  end
end

A.new.migrate(:up) 
```

# java - CardLayout 约束适用于 Windows 但不适用于 OS X

> ID：13168451
> 
> 赞同：0
> 
> 时间：2012-10-31T22:37:29.020
> 
> 标签：java, swing

作为前言：我知道代码很粗糙——我上周刚学了 Java，所以我可以让这个东西跨平台进行实验，这样即使我的学生也会让 OS X 机器参与研究。

所以我现在已经在大约 10 台 Windows 机器上测试了它，没有问题，但在 OS X 上，frame3 显示时根本没有面板（例如，只是一个空白框架）。我现在正在 OS X 机器上编译，我看到以下控制台输出：

```
Exception in thread "main" java.lang.IllegalArgumentException: cannot add to layout:     constraint must be a string
at java.awt.CardLayout.addLayoutComponent(CardLayout.java:190)
at java.awt.Container.addImpl(Container.java:1072)
at java.awt.Container.add(Container.java:363)
at Reflexology1.<init>(Reflexology1.java:150)
at Reflexology1.main(Reflexology1.java:51) 
```

代码发布在[http://pastebin.com/t3vqa0s6](http://pastebin.com/t3vqa0s6)

有谁知道仅在 OS X 下可能导致此问题的原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:40:29.850

我的第一个猜测是 Windows 和 Mac 机器使用不同版本的 JDK。`javac -version`您可以通过运行编译器和`java -version`运行时环境从命令行检查这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T22:55:27.143

JVM 6 仅**允许** `String`对`CardLayout`.

JVM 7 也允许`null`-value 并将其替换为 emtpy `String`( `""`)

您可能在一个平台上使用一个版本，而在另一个平台上使用另一个版本。

# javascript - 在浏览器中打开保存的 html 页面时如何使其停止连接到互联网（服务器）？

> ID：13168453
> 
> 赞同：-3
> 
> 时间：2012-10-31T22:37:44.753
> 
> 标签：javascript, html

我已将网页（例如 yahoo.com）保存到本地文件系统。在浏览器中打开它时（URL 看起来像 file:///home/.../*.html），网页会尝试连接到 Internet（以下载广告等）。必须在网页中修改什么以阻止它连接 Internet（服务器）。我不想为浏览器使用广告拦截插件，而是希望更改网页，使其永远不尝试连接到任何服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:51:26.397

您可以通过删除对外部资源的引用使其停止请求外部资源。没有真正的标志或开关可以处理这个问题。现代网页是一个非常相互关联的东西，出于各种不同的原因从许多域加载数据。（Google 托管了 JS 框架，来自社交网络的图片，或者来自不同 CDN 域的图片/css/js 以加速加载等）

如果您确实需要这样做，我会在页面中搜索`"http"`并删除或更改它找到匹配项的 HTML 元素。对外部文件的任何引用都应以“http”开头，以便可以找到它们。

在某些情况下，您可以从外部服务器复制资源并将其保存到本地文件，然后将引用指向本地相对 url。

如何在不破坏整个页面的情况下删除这些引用，这取决于很多事情，比如资源是什么以及它负责什么。如果没有页面的实际来源，这是不可能提供建议的。

使用 JavaScript 会更加麻烦。例如，您可能拥有插入图像的 JS，并且经过硬编码以从特定域加载这些图像。所以现在你也必须编辑那个 JS 来加载本地图像。

所以，是的。祝你好运。

* * *

或者，也许您只是想要[HTTrack](http://www.httrack.com/)之类的东西为您做这件事？

# mysql - MYSQL 更高效地删除重复项？

> ID：13168454
> 
> 赞同：4
> 
> 时间：2012-10-31T22:38:02.253
> 
> 标签：mysql

虽然这个问题在过去已经提出，但我很好奇这是否仍然是清理大型（3M 和不断增长的）表中重复条目的最佳方法。每次批量插入后，我都会运行这一行以保持整洁，但它开始需要很长时间才能执行。

重复行只能通过 3 列确定。其他的要么自动递增，有唯一ID、来源等。

这是我目前要做的-

```
DELETE n1 
FROM main n1, main n2 
WHERE n1.id < n2.id 
AND n1.col1 = n2.col1 
AND n1.col2 = n2.col2 
AND n1.col3 = n2.col3 
```

有没有机会我可以加快速度，或者这是否尽可能好？

感谢您的任何帮助/见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:52:43.530

像这样在 col1、col2 和 col2 列上为您的表添加唯一索引。

```
ALTER TABLE `main` ADD UNIQUE INDEX `col1_col2_col3` (`col1`, `col2`, `col3`); 
```

这将防止在您的表中插入重复的行。

例如：插入此值后；

```
INSERT INTO `main` (`col1`, `col2`, `col3`) VALUES (1, 11, 111); 
```

你不能插入这个，你会得到重复行错误

```
INSERT INTO `main` (`col1`, `col2`, `col3`) VALUES (1, 11, 111); 
```

使用正确的唯一索引，您以后不必担心重复记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T07:23:17.587

同意其他海报 - 您可以将 UNIQUE KEY 添加到约束重复项。

如果要删除重复项，可以使用此查询 -

```
DELETE t1 FROM main t1
  JOIN (SELECT MIN(id) id, col1, col2, col3 FROM main
        GROUP BY col1, col2, col3) t2
  ON
    t1.id <> t2.id AND
    t1.col1 = t2.col1 AND t1.col2 = t2.col2 AND t1.col3 = t2.col3; 
```

# servicebus - 代理后面通过 http 的 Azure 服务总线

> ID：13168459
> 
> 赞同：0
> 
> 时间：2012-10-31T22:38:30.240
> 
> 标签：servicebus, azureservicebus

微软上周发布了新版本的服务总线 1.8。我想知道他们是否解决了上一篇文章中讨论的以下问题。

[http://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/a7c78246-9d76-482a-b683-fc4a1e27df59](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/a7c78246-9d76-482a-b683-fc4a1e27df59)

[通过代理后面的 http 发布到 Azure 服务总线](https://stackoverflow.com/questions/12281570/publish-to-azure-service-bus-over-http-behind-proxy/13116717#13116717)

我已经在最新版本上进行了测试，似乎问题仍然存在。

无法连接到 net.tcp://abc.servicebus.windows.net:9354/。连接尝试持续了 00:00:21.0500000 的时间跨度。TCP错误码10060：连接尝试失败，因为连接方一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应 65.52.160.127:9354

任何人都可以请指导我。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T18:06:11.720

我们在 SDK 1.8 中进行了改进，特别是针对较旧的代理。请为 ServiceBus 客户端设置`ConnectivityMode`为`AutoDetect`并试一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-18T17:41:45.193

我通过将 ConnectivityMode 设置为 Http 并在 app.config 中指定要使用的代理解决了这个问题。它是应用程序的全局状态，但它适用于我的场景，所以也许它在这里也有帮助。[http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx](http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx)

在我的场景中，配置是忽略代理：

```
 <system.net>
   <defaultProxy>
     <proxy usesystemdefault="False" />
   </defaultProxy>
 </system.net> 
```

# .net - 捕捉时更改列表框的 itemTemplateSelector 的问题

> ID：13168460
> 
> 赞同：0
> 
> 时间：2012-10-31T22:38:36.543
> 
> 标签：.net, windows-8, winrt-xaml, windows-store-apps

我正在编写的应用程序中使用默认的 Windows 应用商店模板。

我希望突出显示列表视图中的第一项；我已经使用自定义 itemtemplateSelector 实现了这一点。

我遇到的问题是我需要在页面被捕捉时修改样式。

“默认”模板不使用模板选择器，因此只需更改 visualstate 故事板中的 itemTemplate。

如果我修改此代码以更改 itemTemlateSelector (storyboard.TargetProperty="itemTemplateSelector") 我会收到运行时错误。

然后，我尝试修改我的 DatatemplateSelector 类以考虑 ApplicationViewState：如果页面加载到快照/全屏状态但不会更改应用程序视图状态更改时使用的模板，则此方法有效。

有没有办法“刷新” Listview 以便它重新应用模板？

有没有其他方法可以做到这一点？

感谢您提供任何帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:35:32.717

示例模板使用两个不同的列表，一个用于 Snapped，一个用于其余列表。这是一种非常容易采用的方法。

我没有测试过下一个，但是如果您的页面是 LayoutAwarePage，那么您可以更改DetermineVisualState 方法中的选择器。

```
 protected override string DetermineVisualState(ApplicationViewState viewState)
    {
        if (viewState == ApplicationViewState.Snapped)
        {
            // change to snapped selector
        }
        else
        {
            // change to regular selector
        }
        return base.DetermineVisualState(viewState);
    } 
```

# linux - 使用 `date` 命令获取上个月、当前和下个月

> ID：13168463
> 
> 赞同：67
> 
> 时间：2012-10-31T22:39:00.333
> 
> 标签：linux, bash, unix, date

`Ubuntu`我在下面使用来获取11.04下的上一个、当前和下个月：

```
LAST_MONTH=`date +'%m' -d 'last month'`
NEXT_MONTH=`date +'%m' -d 'next month'`
THIS_MONTH=`date +'%m' -d 'now'` 
```

直到今天，2012 年 10 月的最后一天 (2012-10-31)，它都运行良好

截至目前，我得到以下结果：

```
$ date
Wed Oct 31 15:35:26 PDT 2012
$ date +'%m' -d 'last month'
10
$ date +'%m' -d 'now'
10
$ $ date +'%m' -d 'next month'
12 
```

我想输出应该分别是`9`, 。`10``11`

不明白为什么`date`输出会这样。什么应该是获得一致和月份的`previous`好`current`方法`next`？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-10-31T22:56:19.647

问题是`date`从字面上理解您的请求并尝试使用 9 月 31 日（即 10 月 31 日减去一个月）的日期，然后因为不存在它移动到第二天。`date`文档（来自）有以下`info date`建议：

> 单位中的模糊可能会导致相关项目出现问题。例如，“2003-07-31 -1 月”可能计算为 2003-07-01，因为 2003-06-31 是无效日期。为了更可靠地确定上个月，您可以要求当月 15 日之前的月份。例如：
> 
> ```
>  $ date -R
>  Thu, 31 Jul 2003 13:02:39 -0700
>  $ date --date='-1 month' +'Last month was %B?'
>  Last month was July?
>  $ date --date="$(date +%Y-%m-15) -1 month" +'Last month was %B!'
>  Last month was June! 
> ```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2018-10-31T12:08:12.817

以下将做：

```
date -d "$(date +%Y-%m-1) -1 month" +%-m
date -d "$(date +%Y-%m-1) 0 month" +%-m
date -d "$(date +%Y-%m-1) 1 month" +%-m 
```

或根据需要：

```
LAST_MONTH=`date -d "$(date +%Y-%m-1) -1 month" +%-m`
NEXT_MONTH=`date -d "$(date +%Y-%m-1) 1 month" +%-m`
THIS_MONTH=`date -d "$(date +%Y-%m-1) 0 month" +%-m` 
```

你要求像 9,10,11 这样的输出，所以我使用了`%-m`

`%m`（没有 - ）将产生像 09,...（前导零）的输出

这也适用于多于/少于 12 个月：

```
date -d "$(date +%Y-%m-1) -13 month" +%-m 
```

你试一试

```
date -d "$(date +%Y-%m-1) -13 month" 
```

查看完整结果

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-02-21T04:01:27.063

如果你碰巧在 MacOS 环境中使用 date，试试这个：

```
ST1:~ ejf$ date
Mon Feb 20 21:55:48 CST 2017
ST1:~ ejf$ date -v-1m +%m
01
ST1:~ ejf$ date -v+1m +%m
03 
```

另外，我宁愿在每个月的第一天计算上个月和下个月，这样你就不会遇到结束 30/31 或 28/29（闰年）的月份的问题

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-28T07:50:04.110

当您没有可用的 date --date 选项并且您没有安装它的权限时，会出现主要问题，然后在下面尝试 -

```
Previous month
#cal -3|awk 'NR==1{print toupper(substr($1,1,3))"-"$2}'
DEC-2016 
Current month
#cal -3|awk 'NR==1{print toupper(substr($3,1,3))"-"$4}'
JAN-2017
Next month
#cal -3|awk 'NR==1{print toupper(substr($5,1,3))"-"$6}'
FEB-2017 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-24T05:49:09.627

前一个月：

```
date -d "1 month ago" +'%m' 
```

这个月：

```
date +'%m' 
```

下个月：

```
date -d "-1 month ago" +'%m' 
```

# javascript - 如何区分“真实”和“虚拟”onpopstate 事件

> ID：13168465
> 
> 赞同：4
> 
> 时间：2012-10-31T22:39:11.020
> 
> 标签：javascript, html, browser-history, html5-history

我正在构建一个使用 AJAX 和`pushState`/`replaceState`在非 JavaScript 后备（[http://biologos.org/resources/find](http://biologos.org/resources/find)）之上的工具。基本上，它是一个搜索工具，它返回一个真实的 HTML 链接列表（单击一个链接会带您离开该工具）。

我正在使用`onpopstate`，因此用户可以浏览由`pushState`. **当从真实链接（不是**用实际浏览器导航创建而是由实际浏览器导航创建的）导航返回时*也会*触发此事件。我不想让它在这里开火。**`pushState`**

 **所以这是我的问题：如何区分`onpopstate`来自`pushState`历史项目的事件与来自真实导航的事件？

我想做这样的事情：

```
window.onpopstate = function(event){
  if(event.realClick) return;

  // otherwise do something

} 
```

我试过[onpopstate 处理程序 - ajax 后退按钮](https://stackoverflow.com/questions/5257819/onpopstate-handler-ajax-back-button)但没有运气:(

提前致谢！

**编辑：** 这里的一个问题是不同浏览器处理`onpopstate`事件的方式。以下是似乎正在发生的事情：

铬合金

*   触发`onpopstate`真实和*虚拟*事件*_*
**   实际上重新运行javascript（所以设置`loaded=false`实际上会测试为假）*   上面链接中的解决方案确实有效！*

 *火狐

*   仅`onpopstate`在*虚拟*事件上触发
*   实际上重新运行javascript（所以设置`loaded=false`实际上会测试为假）
*   要使链接的解决方案真正起作用，`loaded`需要在页面加载时设置为 true，这会破坏 Chrome！

苹果浏览器

*   触发`onpopstate`真实和*虚拟*事件*_*
**   似乎**不会**在事件之前重新运行 javascript（`loaded`如果之前设置为 true，则为 true！）*

 *希望我只是错过了一些东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T15:13:41.387

您也许可以使用[history.js](https://github.com/balupton/History.js/)。它应该为您提供一个在所有主要平台上都表现一致的 API（尽管它可能无法解决这个特定问题；您必须尝试找出答案）。

但是，在我看来，处理这个（以及其他相关问题）的最佳方法是设计您的应用程序，使这些问题无关紧要。自己跟踪应用程序的状态，而不是完全依赖历史堆栈中的状态对象。

跟踪您的应用程序*当前显示*的页面。在一个变量中跟踪它——与`window.location`. 当导航事件（包括 popstate）到达时，将您的 known`current page`与请求的`next page`. 首先确定是否确实需要更改页面。如果是这样，则呈现请求的页面，并在必要时调用 pushState（仅调用 pushState 进行“正常”导航——从不响应 popstate 事件）。

处理 popstate 的相同代码也应该处理您的正常导航。就您的应用程序而言，应该没有区别（除了普通导航包含对 pushState 的调用，而 popstate 驱动的导航则不包含）。

这是代码中的基本思想（参见[jsBin](http://jsbin.com/aberog/1)的实时示例）

```
// keep track of the current page.
var currentPage = null;

// This function will be called every time a navigation
// is requested, whether the navigation request is due to
// back/forward button, or whether it comes from calling
// the `goTo` function in response to a user's click... 
// either way, this function will be called. 
// 
// The argument `pathToShow` will indicate the pathname of
// the page that is being requested. The var `currentPage` 
// will contain the pathname of the currently visible page.
// `currentPage` will be `null` if we're coming in from 
// some other site.
// 
// Don't call `_renderPage(path)` directly.  Instead call
// `goTo(path)` (eg. in response to the user clicking a link
// in your app).
//
function _renderPage(pathToShow) {
  if (currentPage === pathToShow) {
    // if we're already on the proper page, then do nothing.
    // return false to indicate that no actual navigation 
    // happened.
    //
    return false;
  }

  // ...
  // your data fetching and page-rendering 
  // logic goes here
  // ...

  console.log("renderPage");
  console.log("  prev page  : " + currentPage);
  console.log("  next page  : " + pathToShow);

  // be sure to update `currentPage`
  currentPage = pathToShow;

  // return true to indicate that a real navigation
  // happened, and should be stored in history stack
  // (eg. via pushState - see `function goTo()` below).
  return true;
}

// listen for popstate events, so we can handle 
// fwd/back buttons...
//
window.addEventListener('popstate', function(evt) {
  // ask the app to show the requested page
  // this will be a no-op if we're already on the
  // proper page.
  _renderPage(window.location.pathname);
});

// call this function directly whenever you want to perform
// a navigation (eg. when the user clicks a link or button).
// 
function goTo(path) {

  // turn `path` into an absolute path, so it will compare
  // with `window.location.pathname`. (you probably want
  // something a bit more robust here... but this is just 
  // an example).
  //
  var basePath, absPath;
  if (path[0] === '/') {
    absPath = path;
  } else {
    basePath = window.location.pathname.split('/');
    basePath.pop();
    basePath = basePath.join('/');    
    absPath = basePath + '/' + path;
  }

  // now show that page, and push it onto the history stack.
  var changedPages = _renderPage(absPath);
  if (changedPages) {
    // if renderPage says that a navigation happened, then
    // store it on the history stack, so the back/fwd buttons
    // will work.
    history.pushState({}, document.title, absPath);
  }
}

// whenever the javascript is executed (or "re-executed"), 
// just render whatever page is indicated in the browser's 
// address-bar at this time.
//
_renderPage(window.location.pathname); 
```

如果您查看[jsBin 上的示例](http://jsbin.com/aberog/1)，您会看到`_renderPage`每次应用程序请求转换到新页面时都会调用该函数——无论是由于`popstate`（例如后退/前进按钮），还是由于调用`goTo(page)`(例如，某种用户操作）。它甚至在页面第一次加载时被调用。

您的逻辑，在`_renderPage`函数中可以使用值`currentPage`来确定“请求来自哪里”。如果我们来自外部站点，则为 ，否则，`currentPage`它将`null`包含当前可见页面的路径名。****

# forms - Symfony2：创建绑定到具有不是属性的字段的实体的表单

> ID：13168466
> 
> 赞同：1
> 
> 时间：2012-10-31T22:39:16.960
> 
> 标签：forms, symfony, doctrine

我提出的以下（简单）问题：

```
 $user = new User();
  $user->setEventid(2);
  $user->setT(new \DateTime('now'));

  $em = $this->getDoctrine()->getManager();
  $em->persist($user);
  $em->flush();

  $form = $this->createFormBuilder($user)
    ->add('email', 'email')
    ->add('terms', 'checkbox', array(
          'label'     => 'Read terms?',
          'required'  => true))
    ->getForm(); 
```

这是我的代码。电子邮件是用户的财产，条款不是。我希望他们的用户保存他们的电子邮件并检查条款复选框，但我只需要保存电子邮件，而不是如果他们选中该框 - 如果他们不这样做，他们就无法提交表格。

你知道我的意思？我确信实现这一点非常简单；）

第二个问题：如何给渲染的 from-tag 一个 id-attribute 以便在 jquery 中进一步处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T06:34:45.253

要将实体中不存在的字段添加到表单中，请使用以下命令：

```
->add('terms', 'checkbox', array(
    'label'         => 'Read terms?',
    'required'      => true,
    'mapped'        => false, // this works since Symfony 2.1
    'property_path' => false, // this works since Symfony 2.0
)) 
```

Symfony 为每个表单元素生成一个 ID；只需打开呈现的页面源并查看所需元素的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:43:46.217

如果您的实体中没有“条款”字段，则不会保存。对于您的第二个问题，将 id 设置为 twig 中的表单非常简单，只需：

```
{{ form_label(form.name, 'Your Name', { 'attr': {'id': 'foo'} }) }} 
```

# java - 如何将包含另一个 Map 作为元素的 java Map 映射到 hibernate *.hbm.xml

> ID：13168467
> 
> 赞同：0
> 
> 时间：2012-10-31T22:39:21.953
> 
> 标签：java, hibernate

是否有可能映射类似的东西：

```
private Map<Website, Map<String, String>> parameterMaps =
  new HashMap<Website, Map<String, String>>(); 
```

其中“网站”是我的类具有一些字符串属性，而内部地图应该是一些特定于网站的 url 部分。我想将它映射到 *.hbm.xml 而不是使用注释，因为它在我的项目中的习惯。我也感谢任何对任何手册的有用参考。谢谢！

# java - 从表达式树递归创建完全括号表达式的算法

> ID：13168470
> 
> 赞同：3
> 
> 时间：2012-10-31T22:39:53.047
> 
> 标签：java, recursion

我知道要进行中序遍历，但我不知道如何区分左孩子和右孩子。我什至应该基于何时在叶子上加上括号，还是应该做其他事情。我很讨厌递归。我已经让树完美地工作了，所以我可以输入一个像 (1 + 2) * (3 - 4) 这样的表达式，将其转换为后缀并将其添加到树中。我只需要找到一种方法来为每个表达式赋予其自己的一组括号。

这是使它工作的代码，感谢算法dreamcrash！

```
private void printInfix(Node n)
{   
    if (n != null)
    {
        if (n.isLeaf())//if n is a leaf, therefore a number
            System.out.print(n.element);
        else//n is not a leaf
        {
            System.out.print("(");
            printInfix(n.left);
            System.out.print(n.element);
            printInfix(n.right);
            System.out.print(")");
        }//end else
    }//end if   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:20:20.523

我做了一些研究，我发现了这个：

```
Algorithm infix (tree)
/*Print the infix expression for an expression tree.
 Pre : tree is a pointer to an expression tree
 Post: the infix expression has been printed*/
 if (tree not empty)
    if (tree token is operand)
       print (tree token)
    else
       print (open parenthesis)
       infix (tree left subtree)
       print (tree token)
       infix (tree right subtree)
       print (close parenthesis)
    end if
 end if
end infix 
```

在[http://en.wikipedia.org/wiki/Binary_expression_tree](http://en.wikipedia.org/wiki/Binary_expression_tree)上。

我还找到了一个很好的解释和一些代码实现（但在 python 中）。尽管如此，这个想法仍然是一样的，只是语法问题：http: [//interactivepython.org/courselib/static/pythonds/Trees/bintreeapps.html](http://interactivepython.org/courselib/static/pythonds/Trees/bintreeapps.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:52:57.820

您应该在父节点中添加括号，而不是在子节点中。正如您所说，您很难区分右孩子和左孩子。这是因为子节点不知道它是哪个。但是，父节点手头有此信息。

# assembly - 将命令行参数正确放入堆栈

> ID：13168475
> 
> 赞同：2
> 
> 时间：2012-10-31T22:40:27.197
> 
> 标签：assembly, command-line, x86, stack

如果我的术语不正确，请原谅我。

我正在尝试实现一个基于 x86 gnu c 的系统，它能够将命令行参数传递给程序。不要与在程序中访问它们混淆，实际上是在将执行传递给用户程序之前设置堆栈。

从我收集到的内容中，argc 和 argv 被推入堆栈，但正是我遗漏了一些东西的构造过程。下面是我执行另一个程序的方式。

```
__asm__ __volatile__ ("pushl %%ds\n" /* save data and extra segment registers */
        "pushl %%es\n" 
        "movl %%esp, %%ebx\n" 
        "movl %%ebx, oldsp\n" 
        "movl %%ss, %%ebx\n" 
        "movl %%ebx, oldss\n" 
        "movl %0, %%ds\n"   /* set data segment to new user base */

        "movl %0, %%ss\n" 
        "movl $0xfff0, %%ebx\n" /* start of the new user stack pointer */
        "movl %%ebx, %%esp\n"
        "movl %2, %%eax\n"  /* place i into eax - push it onto the stack*/
        "pushl %%eax\n"
        "pushl %%eax\n"
        "lcallw  *%%fs:(%1)\n" 
        "movl %%fs:oldss, %%ebx\n" 
        "movl %%ebx, %%ss\n" 
        "movl %%fs:oldsp, %%ebx\n" 
        "movl %%ebx, %%esp\n" 
        "popl  %%es\n"  /* restore old segment registers */
        "popl  %%ds\n"
        :
        :"a" (userbase), "d" (&useg), "r" (i)
        :"%ebx", "eax", "memory");  /* prevents gcc from optimizing useg away*/ 
```

我的印象是在堆栈指针更新后我可以将值压入堆栈。我显然没有得到我推入堆栈的值，所以我什至不确定我是否以正确的方式去做。

下面是一个简单的测试程序，它试图将 argc 打印到屏幕上。

```
.file    "prog3.c"
#APP
.code16gcc

call main

lretw

.section    .rodata.str1.1,"aMS",@progbits,1
.LC0:
.string    "\r\nstring: %u"
#NO_APP
.section    .text.startup,"ax",@progbits
.globl    main
.type    main, @function
main:
.LFB0:
.cfi_startproc
pushl    %ebp
.cfi_def_cfa_offset 8
.cfi_offset 5, -8
movl    %esp, %ebp
.cfi_def_cfa_register 5
andl    $-16, %esp
subl    $16, %esp
movl    8(%ebp), %eax
movl    %eax, 4(%esp)
movl    $.LC0, (%esp)
call    printf
leave
.cfi_restore 5
.cfi_def_cfa 4, 4
ret
.cfi_endproc
.LFE0:
.size    main, .-main
.ident    "GCC: (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3"
.section    .note.GNU-stack,"",@progbits 
```

我已经查看了堆栈是如何为函数调用准备的，认为这可能是一个类似的过程，但我仍然处于断开状态。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T03:46:40.040

让我们看看程序尝试读取其参数时的堆栈，以及一切是如何到达那里的：

```
mov    %ebx, %esp # 0xfff0
push   %eax       # 0xffec i
push   %eax       # 0xffe8 i
lcallw *%fs:useg  # 0xffe4 return address 1
call   main       # 0xffe0 return address 2
push   %ebp       # 0xffdc old ebp
mov    %esp, %ebp # ebp = 0xffdc 
```

GCC 期望函数参数被放置在堆栈上的返回地址之上。这意味着第一个参数应该是 at `ebp + 8`。但是，您可以在此处看到，该位置的值是`lcallw`指令的返回地址，因此主函数将其视为第一个参数。为了获得放置在那里的参数，您需要让调用的用户代码`main`（让我们称之为`start`）在两个返回地址之间复制它，或者根本不更改该代码中堆栈的大小。

`start`由于堆栈上参数的长度当前是恒定的并且很小，因此简单地复制数据并不困难。您只需要重新推送这两个值，`start`如下所示：

```
push   8(%esp) # Copy the high value
push   8(%esp) # Copy the low value
call   main
add    $8,%esp
lretw 
```

对于更长或非常量的参数，这会更慢，因为您必须确定要复制多少，并复制所有内容。

如果`start`在调用`main`. 由于它需要将自己的返回地址放在堆栈上，这意味着它需要将另一个返回地址移动到其他地方。最好的方法是让您的系统假设通常保留的寄存器之一不是，以便`start`可以将返回地址存储在那里。看起来你没有在运行程序的代码中使用`ebp`, `esi`, 或`edi`任何东西，所以你可以使用它们中的任何一个，只需将其添加到内联程序集中的已销毁寄存器列表中，然后更改你`start`的存储第一个退货地址在那里。

```
pop    %esi  # Pop first return address
call   main
push   %esi  # Restore first return address
lretw 
```

# c++ - 如何初始化结构的向量成员？

> ID：13168479
> 
> 赞同：3
> 
> 时间：2012-10-31T22:40:43.013
> 
> 标签：c++, struct

假设我有一个结构，其成员是一个向量。在构造函数中，我只想将其设置为 NULL。但后来我希望能够 push_back 给它。向量为 NULL 后如何初始化它？

```
struct structName {
    vector<int> vec;
    structName() {
        vec = NULL
    }
    void set(int);
}

void structName::set(int n) {
    // What do I put here?
    vec.push_back(n);
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:45:03.267

它已经通过默认构造函数初始化，如果您需要调用不同的构造函数，请使用初始化列表。

请记住，这是 C++，而不是 Java/C#/其他。*对象*为空是没有意义的（好吧，这些语言也没有，但请继续阅读）。这不可能发生。在 Java 和类似的语言中，您有变量是对对象的引用，而这些*引用*（不是对象！）可能为空，也可能不为空。

在 C++ 中情况并非如此。对象和引用它们的指针之间有严格的划分（指针，或者当然，可以为空或引用无效的内存位置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:43:29.007

向量的默认构造函数会将其设置为最简单的状态：无内容。所以别管它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:44:38.387

将向量初始化为 NULL 没有任何意义。也许你对指针感到困惑。如果你想将你的向量初始化为*空向量*，那么这会自动发生。换句话说就是这样

```
struct structName {
    vector<int> vec;
    structName() {
    }
    void set(int);
}

void structName::set(int n) {
    vec.push_back(n);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T22:45:40.227

我认为您会像在 Java 中一样考虑 C++ 对象。**不要**他们是完全不同的野兽。

在 C++ 中，对象不是 Java 中的引用，因此，将它们归零没有意义。事实上，尝试`vec = NULL`是一个错误，`NULL`实际上只是 0。

相反，只需删除该行`vec = NULL`，它就会按原样工作。该向量将默认构造为空，您无需进行任何其他初始化。

# mysql - 如何从子查询中选择更多行

> ID：13168483
> 
> 赞同：0
> 
> 时间：2012-10-31T22:40:51.783
> 
> 标签：mysql

当我尝试运行此查询时：

```
 select * FROM `activity` 
 WHERE user_id = 1
 AND activity_id NOT LIKE (select activity_id from activity where user_id = 1 ORDER BY activity_id DESC LIMIT 8) 
```

我收到以下错误：

```
 Subquery returns more than 1 row 
```

我怎么解决这个问题？我想从表中选择活动 ID，不包括某个用户的最新 8 个活动 ID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:42:17.290

NOT LIKE 期望一个表达式或一个值来比较，而不是一个结果集。将 NOT LIKE 更改为 NOT IN

试试这个：

```
 SELECT * FROM `activity` 
             WHERE user_id = 1 AND activity_id NOT IN (
                     SELECT activity_id FROM activity WHERE user_id = 1 
                                        ORDER BY activity_id DESC LIMIT 8) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:05:02.400

通过这样做解决了它：

```
 $sql2 = "DELETE t1.*
                        FROM activity t1
                        left join (select activity_id from activity where user_id = '".$row['user_id']."' ORDER BY activity_id DESC LIMIT 8) t2
                        on (t1.activity_id = t2.activity_id)
                        where t2.activity_id is null
                        and t1.user_id = '".$row['user_id']."'"; 
```

# jquery - jQuery 的 .serialize() 没有做任何事情

> ID：13168484
> 
> 赞同：2
> 
> 时间：2012-10-31T22:41:15.283
> 
> 标签：jquery, serialization

我有一个相当简单的表单，其中包含一些复选框、单选按钮和选择框。我想使用 jQuery 的 $.ajax 发布所有选定的表单数据。但由于某种原因，表单并没有被序列化。我不确定是什么原因造成的……（旁注：`$('#FormID').submit(..)`对我也不起作用）。所以我用以下代码创建了一个按钮：

```
$(document).ready(function() {
    $('#DoSearchRequest').click(function(event) {
        //event.preventDefault(); // read about this somewhere, doesn't help
        $('#res').html($('#FormSearch').serialize()); // just some <p> to output the result to
        $.ajax({
            url:        'http://www.domain.nl/ajax/GetResultsBySearchRequest.php',
            data:       $('#FormSearch').serialize(),
            type:       'POST',
            success:    function(result) {
                            console.log(result);
                        },
            error: function(a, b, c) { console.log(a); }

        });

        return false;
    });
}); 
```

我的按钮在表单之外（不管它是否在表单中）。

我的表格：

```
<form name="FormSearch" id="FormSearch" method="post">
... form elements
</form> 
```

我正在使用 jQuery 1.7.1 和 jQueryUI 1.8.18

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-03-13T10:34:40.437

愚蠢，但对我来说，我没有在表单中命名字段，所以`.serialize`给了我一个空字符串，也`.serializeArray`没有用。

请**命名**您的表单字段，否则您将无法获得任何值。

```
<input name='importantField'/> 
```

不一样

```
<input id='importantField'/> 
```

`.serialize`如果您没有在表单字段上定义任何名称，甚至`.serializeArray`默认表单提交将不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-01T00:20:16.283

查看您的预览网页后，我会说问题可能是您将表单元素“form543”嵌套在另一个表单元素“搜索栏”中。

在Firefox中测试，我发现jQuery显然`$("#form543").length`根本`0`找不到表单。当我尝试`$("#searchbar").serialize()`它返回选择元素的实际字段值和我检查过的复选框等等。

我建议删除外部表单元素“搜索栏”（或以其他方式更改标记，以便您没有嵌套表单），然后查看您的 JS 代码是否有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T22:47:17.077

你必须做这样的事情：

```
$('form').submit(function() {
  alert($(this).serialize());
  return false;
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-22T07:22:29.597

对表单中的所有输入（包括按钮）使用名称属性，例如`<input type="text" id="fname" name="fname"/>`

然后您可以测试该`serial()`功能是否有效：

```
$('#contact-form').submit(function() {
  alert($(this).serialize());
}); 
```

然后在阿贾克斯：

```
 $.ajax({
    type: 'POST',
    url: 'SendAd.php',
    dataType: 'json',
    data: $('#contact_form').serialize(),
}) 
```

# perl - TCP Server 多重接收和响应

> ID：13168485
> 
> 赞同：1
> 
> 时间：2012-10-31T22:41:20.057
> 
> 标签：perl, tcp

我试图在运行应用程序的同一台 PC 上模拟 TCP 服务器。我不知道它是否可以在 Perl 中完成，因为我不是很有经验。

使用下面的代码，第一个回复正在工作，但我不知道如何实现第二个。

```
#!/usr/bin/perl -w

use IO::Socket::INET;
use strict;

my $socket = IO::Socket::INET->new('LocalPort' => '3000',
                   'Proto' => 'tcp',
                   'Listen' => SOMAXCONN)
    or die "Can't create socket ($!)\n";
print "Server listening\n";
while (my $client = $socket->accept) {
    my $name = gethostbyaddr($client->peeraddr, AF_INET);
    my $port = $client->peerport;
    while (<$client>) {
    print "$_";
    print $client "RESPONSE1";
    }
    close $client
    or die "Can't close ($!)\n";
}
die "Can't accept socket ($!)\n"; 
```

编辑：谢谢你们的投入，我最终用 php 完成了它并且它的工作，耶！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T06:56:14.670

使用[Net::Server](http://search.cpan.org/dist/Net-Server)进行连接，并在 sub 中使用一个变量来保持当前状态（此代码中的 $state）；像这样的东西：

```
package MyServer;
use base qw/Net::Server/;
use strict;
use warnings;

sub process_request {
  my $self = shift;
  my $state = 0;
  while (<STDIN>) {
    s/\r?\n$//; # like chomp but for crlf too
    if ($state == 0 and $_ eq 'data1') {
      print "> okay1\n";
      $state++;
    } elsif ($state == 1 and $_ eq 'data2') {
      print "> okay2\n";
      $state++;
    } else {
      last if $state == 2;
      $state = 0;
    }
  }
}

my $port = shift || 3000;
MyServer->run( port => $port ); 
```

Net::Server POD 中的示例建议使用警报来超时连接，这在此处可能是合适的。上面的代码执行以下操作：

```
$ nc localhost 3000
data1
> okay1
data2
> okay2
data3
$ 
```

如果您需要迁移到分叉/预分叉/非阻塞/协同程序驱动的系统，可以使用 Net::Server 个性化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T09:39:50.610

**在我看来，当设置低端口（在我的情况下，端口 23**）时， process_request sub 无法正常工作。特别是只有低端口，在解析数据输入时，第一个请求包含额外的字符（但后续请求都可以）。你有窍门吗？谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T04:18:17.190

“准备就绪”代码：

```
package MyServer;
use base qw/Net::Server/;
use strict;
use warnings;

sub process_request {
  my $self = shift;
  my $state = 0;
  $| = 1;
  binmode *STDIN;
  while (read(*STDIN, local $_, 3 )) {
    if ($state == 0 and $_ eq "\x{de}\x{c0}\x{ad}") {
      print "\x{c4}\x{1a}\x{20}\x{de}";
      $state++;
    } elsif ($state == 1 and $_ eq "\x{18}\x{c0}\x{0a}") {
      print "\x{11}\x{01}\x{73}\x{93}";
      $state++;
      last;
    }
  }
}

my $port = shift || 3000;
MyServer->run( port => $port ); 
```

# javascript - 绳索模拟html5

> ID：13168486
> 
> 赞同：3
> 
> 时间：2012-10-31T22:41:39.337
> 
> 标签：javascript, jquery, html, canvas

我正在尝试在网站上模拟物理上正确的绳索。

在网上搜索后，我的结论是我需要一个像 box2d 这样的物理引擎？

如果我理解正确，解决方案是将对象分成小段，然后将它们连接在一起并制作动画。另外，我想将物理与浏览器结合起来。这意味着：当我快速向下滚动网站时，绳索必须以物理上正确的方式做出反应。

这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-01T01:25:58.900

你根本不需要图书馆。您可以通过对象、组件或程序代码以及对基本机械物理和一些 2D 几何的理解（基本微积分可能有所帮助）愉快地做到这一点。

以优化的方式进行操作需要更多的工作。以模块化和可重用的方式进行操作需要一些前期工程。

但是制作一根绳子，并使绳子正常运行是非常简单的。

2D 绳索将是一系列线段或“骨骼”。每块骨头都可以围绕其关节弯曲。

您可以对每个骨骼施加重力或任何其他您想要的力。
每个骨骼都有约束（它附加到的其他骨骼，上方和下方）。
因此，当您更新“绳索”时，您会根据之前和之后的约束更新每个骨骼。
您可以创建一个锚点——将绳索的顶部固定在墙上，这样无论其他骨骼如何移动，最顶部的骨骼都将围绕其顶部关节旋转，但不会移动到任何地方。

要将物理应用到吊绳的中间（比如从中间拉它，然后放开），您可以使用逆运动学来解决对一个或两个关节的力如何影响其他每个连接（和***受约束***）的关节.

少把它想象成一条蛇，而更像是一条自行车链。
链条中的每个“链接”越短，绳索看起来越流畅，但处理所需的时间就越长。
链中的每个“链接”越长，计算变化的速度就越快，但它在弯曲时看起来越僵硬和块状。

查找“Verlet Integration”、“Kinematics”（“Forward”/“Inverse”），对旋转和沿 2D 向量移动对象背后的数学有一个半体面的掌握......
那里有一点质量，如果你想看中鞭子般的东西，而不仅仅是制造波浪。

剩下的只是循环。

有关基本示例，请参见以下内容：http:
[//gamedev.tutsplus.com/tutorials/implementation/simulate-fabric-and-ragdolls-with-simple-verlet-integration/](http://gamedev.tutsplus.com/tutorials/implementation/simulate-fabric-and-ragdolls-with-simple-verlet-integration/)

玩得开心。

# c++ - 在自然语言处理中使用 boost::iterator_range

> ID：13168488
> 
> 赞同：0
> 
> 时间：2012-10-31T22:41:50.167
> 
> 标签：c++, regex, boost, nlp, boost-iterators

我的问题与自然语言处理 (NLP) 和将输入字符串分块成逻辑组有关。

为了简化事情，我所拥有的是一个 Token 数据结构的向量，其中每个都包含一个“标签”字符串值等。

```
class Token
{
   public:
      std::string tag;
      std::string word;
      // other stuff;
};

std::vector<Token> input_tokens;
typedef std::vector<Token>::iterator tok_iter; 
```

我还形成了一个串联的“标签”值字符串，该字符串取自向量中的每个标记，如下所示：

```
std::string pos_tags = "DT JJ NN NN IN RB JJ NN DT"; 
```

我只对形成 JJ（形容词）和 NN（名词）实例的块感兴趣，因此对于上面的 pos_tags 示例，将有两个匹配的块：

“JJ NN NN”，“JJ NN”

是否可以在 pos_tags 字符串上运行一种正则表达式，以便每个正则表达式匹配代表输入令牌集 (input_tokens) 中的令牌范围？换句话说，形成的每个块都不是一个字符串，而是由一个开始/结束迭代器表示。

理想情况下，我想将找到的匹配存储为 boost::iterator_range 的向量，其中每个范围代表找到的每个块的开始/结束，如下所示：

```
std::vector< boost::iterator_range<tok_iter> > chunks; 
```

我希望这是有道理的。我不一定要寻找完整的代码，而是提示如何以这种方式使用正则表达式（我是新手）。

# c# - 来自 C# 中数据集的 foreach 循环中的 XML

> ID：13168491
> 
> 赞同：1
> 
> 时间：2012-10-31T22:42:19.420
> 
> 标签：c#, xml, linq-to-xml, xelement

我必须在 C# 中动态创建一个非常特定的形状 XML 文件来为网站上的 flash 对象供电。我在许多尝试中遇到的问题是大多数输出​​都希望每个节点都有某种唯一标识方式，我不希望这样。相反，下面是我要追求的输出，而不是我目前可以获得的输出。请注意，它也是无效的 XML。

```
<data>
    <Annual Enrollment>
        <row>
            <column>value1</column>
            <column>value2</column>
            <column>value3</column>
        </row>
        <row>
            <column>value1</column>
            <column>value2</column>
            <column>value3</column>
        </row>
    </Annual Enrollment>
    <Pre-College>
        <row>
            <column>value1</column>
            <column>value2</column>
            <column>value3</column>
        </row>
        <row>
            <column>value1</column>
            <column>value2</column>
            <column>value3</column>
        </row>
    </Pre-College> 
```

....等等。节点标题或和不能改变，每棵树的根也不能改变。

到目前为止我的代码看起来像这样，在我看来它应该可以工作，但它没有。

```
 var tableResult = DashboardData.GetMetricData(1);
  // Outlinining structure
  XDocument document = new XDocument(
       new XDeclaration("1.0", "utf-8", null),
       new XElement("data",
            new XElement("AnnualEnrollment"),
            new XElement("Pre-College"),
            new XElement("Summary")
            ));
  // Now I need to append children to each of the three nodes within the root "data"
  foreach (DataRow row in tableResult.Tables[0].Rows)
  {
      document.Element("AnnualEnrollment").Add(new XElement("row"));

      foreach (var item in row.ItemArray)
      {
          var element = new XElement("column", item);

      }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:27:30.910

考虑使用 XmlWriter 来获得对文档结构的更多控制和灵活性

```
var docBuilder = new StringBuilder();
using (var writer = XmlWriter.Create(docBuilder))
{
    writer.WriteStartElement("data");
    writer.WriteStartElement("AnnualEnrollment");
    foreach (var row in dataTable.Rows)
    {
        writer.WriteStartElement("row");
        foreach (var item in row.ItemArray)
            writer.WriteElementString("column", item);
        writer.WriteEndElement(); // row
    }
    writer.WriteEndElement(); // Annual Enrollment
    writer.WriteEndElement(); // data
}
docBuilder.Replace("<AnnualEnrollment>", "<Annual Enrollment>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:20:38.147

我希望它看起来更像这样：

```
 foreach (DataRow row in tableResult.Tables[0].Rows)
  {
     XElement aRow = new XElement("row")

     foreach (var item in row.ItemArray)
     {
          aRow.Add(new XElement("column", item))
     }

     document.Element("AnnualEnrollment").Add(aRow);

  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:40:04.310

下面的示例从第一个表中读取行并将它们转换为行元素，提供转换为列元素的内容列值。

```
XDocument document = new XDocument(
    new XDeclaration("1.0", "utf-8", null),
    new XElement("data",
        new XElement("AnnualEnrollment", 
            from row in tableResult.Tables[0].AsEnumerable()
            select new XElement("row", 
                from column in tableResult.Tables[0].Columns.Cast<DataColumn>()
                select new XElement("column", row[column]))),
        new XElement("Pre-College"), // same for pre-college table
        new XElement("Summary") // and same for summary
        )); 
```

我还将 DataTable 转换提取到单独的（扩展）方法中：

```
public static object ToXml(this DataTable dataTable)
{
    return from row in dataTable.AsEnumerable()
           select new XElement("row",
                      from column in dataTable.Columns.Cast<DataColumn>()
                      select new XElement("column", row[column]));
} 
```

现在您的 Xml 生成将如下所示：

```
XDocument document = new XDocument(
    new XDeclaration("1.0", "utf-8", null),
    new XElement("data",
        new XElement("AnnualEnrollment", tableResult.Tables[0].ToXml()),
        new XElement("Pre-College", tableResult.Tables[1].ToXml()),
        new XElement("Summary", tableResult.Tables[2].ToXml()) 
        )); 
```

# routing - Kohana 3.2 useradmin 路由问题

> ID：13168495
> 
> 赞同：0
> 
> 时间：2012-10-31T22:42:38.057
> 
> 标签：routing, kohana

我是 kohana 的新手，正在开发一个简单的应用程序，它使用来自[http://blog.mixu.net](http://blog.mixu.net)的 useradmin 模块。我有，我认为，一个理解问题。目前，当非管理员用户登录时，action_index 会重定向到用户/配置文件。我想改为转到一个名为 home 的控制器。我想重定向到 home/index.php

我试过简单地更改重定向，但这不起作用。我怀疑我需要对路线做一些事情才能让我回家/索引，但我无法弄清楚我应该做什么。

如果有人能在这里引导我朝着正确的方向前进，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T04:23:29.433

你说...

> 我想重定向到 home/index.php

不是在科哈纳，你没有。Kohana 使用前端控制器模式，这意味着您的整个应用程序通过框架附带的单个 index.php 文件运行。你所说的你想要的，是做不到的。无需使用 Kohana 访问 home/index.php。相反，您*可以*通过 3 个步骤实现：

1.  将一个名为 home 的新控制器保存到 application/controllers/home.php
2.  创建一个路由并将其放在 application/bootstrap.php 中的默认路由之上
3.  从您的其他控制器重定向到此路由。

您的家庭控制器将是这样的：

```
class Controller_Home extends Controller 
{
    public function action_index()
    {
       echo 'Home Controller Index method';
    }
} 
```

为了测试上面的控制器，你可以使用如下的路由。您可以将它放在默认路由上方的 application/bootstrap.php 中（靠近文件底部。）

```
Route::set('home', 'home(/<controller>(/<action>(/<id>)))')
    ->defaults(array(
        'controller' => 'home',
        'action'     => 'index',
    )); 
```

然后，您可以通过浏览到 your_app_url/home 或 your_app_url/home/index ... 来访问家庭控制器的 action_index 方法。

但我们正在超越自己。在您尝试之前，我**强烈建议**您阅读Kohana 3.2 中[控制器的工作原理](http://kohanaframework.org/3.2/guide/kohana/mvc/controllers)以及Kohana 3.2 中的[路由工作原理](http://kohanaframework.org/3.2/guide/kohana/routing)以及一般用户指南页面（不要错过级联文件系统！）。

接下来，下载 Kohana 3.2 源文件，创建一个虚拟的空项目并创建一个带有一条新路由的新控制器，并确保在弄乱 mixu.net 的东西之前让它工作。那家伙很摇滚，但他很先进。

# c - 如何将数据从 C 导出到 MATLAB（在不同的机器上）

> ID：13168498
> 
> 赞同：3
> 
> 时间：2012-10-31T22:42:56.413
> 
> 标签：c, linux, matlab

我在 Linux 集群上的 C 程序中生成长双浮点数据。我需要将数据导出到集群上未安装的 Matlab。

什么是最好的方法？我的顾问说要使用`printf`语句导出。我假设他的意思是将数据发送到逗号分隔的文件（和`fprintf`）。但在我看来，这可能会很慢并且使用太多内存，我们可能会失去很多精度。

我找到[了这个](http://www.mathworks.com/help/matlab/programming-interfaces-for-c-c-fortran-com.html)用于读取和写入 .MAT 文件的网页，但我并不真正理解我复制到集群但无法编译的页面或[示例](http://www.mathworks.com/help/matlab/matlab_external/creating-a-mat-file-in-c.html)（因为它缺少显然来自的库MATLAB。

*将数据从 Linux/C 导出到 Windows/MATLAB 的最佳、最简单或最快的方法是什么？我如何开始使用这种方法？*当您回答我对 C 很陌生，并且可能需要帮助来弄清楚如何获取、安装、配置和链接任何库时，请注意。但是一旦完成，我认为我很擅长学习使用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T07:09:11.273

Why do you think you would you lose precision? The only drawback with CSVs is that ASCII files require much more storage than binary files, but in this day and age where you get terabytes of storage for the price of a good haircut, that hardly seems like a problem.

It will only be noticeably slower if you're writing gigabytes upon gigabytes, but normally calculations take so much longer that the difference between ASCII and binary is completely negligible (and if the calculations *don't* take so long: why do you need a cluster then?)

In any case, I'd go for ASCII -- how to write and read some binary blob needs to be documented in two places, it's easier to create bugs in both the writing end and the reading end, it's harder to solve them since no human can read the file, etc. Also, MAT file formats may change in the next Matlab release (as they have in the past).

With ASCII, you have none of these problems, the only drawback I can think of is that you have to write a small cluster-specific file reader in Matlab (which is still a lot less work than working out all the bugs and maintaining a MAT file writer).

Anyway, there's tons of tools available in Matlab for ASCII: `textread`, `dlmread`, `importdata`, to name a few. On the C-end, indeed just use `fprintf` (documentation [here](http://www.cplusplus.com/reference/clibrary/cstdio/fprintf/)).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:25:23.940

我曾经也遇到过这个问题（嗯，有点......）并使用简单的二进制格式来完成这项工作。

如果您的数据格式是静态的，这意味着如果它永远不会改变，您可以将自己限制在您需要的内容中，并在加载程序中硬编码确切的格式。但是，如果您想灵活地添加和删除列，您应该定义一种标题来添加有关数据格式的信息并在读取时对其进行评估。

简单导入数据的技巧如下：

*   让 MATLAB 程序知道您的数据记录有多长以及它们是如何组成的。
*   读取数据

    ```
    rest = fread(fid, 'uchar=>uint8', 'b').'; 
    ```

    为了得到`uint8`s 的行向量。

*   重塑数据

    ```
    rest = reshape(rest, recordlength, []).'; 
    ```

    为了在`recordlength`列和尽可能多的行中获取您的数据。

*   对于每个数据列，将相关`uint8`行组合成一个“子矩阵”，使用`reshape`、`typecast`、的组合对`swapbytes`数据进行适当的分组并将它们转换为所需的格式。

    这里最重要的是[`typecast()`函数](http://www.mathworks.de/de/help/matlab/ref/typecast.html)，它接受“按字节”数据作为第一个参数，所需的数据类型作为第二个参数。有多种可接受的数据类型，例如`intXX`, `uintXX`（使用,和(AFAIK)`XX`之一）以及and 。`8``16``32``64``float``double`

    例如，`typecast([1, 1], 'uint16')`给你`257`，同时`typecast([0, 0, 96, 64], 'float')`给你`3.5`。

这样做后，与文本文件相比，您可以将阅读速度提高 20 倍左右。（至少，在我编写的应用程序中就是这种情况：每 10 毫秒大约有 10 个不同的测量值，一次测量可能是几分钟甚至几小时，我想尽可能快地读入这样的文件. 所以我将这些东西从文本重新编码为二进制并获得了大约 20 倍，或者可能是 15 倍 - 不确切知道。但它很多......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:01:59.297

正如你所说，我会将工作区保存为 .MAT 文件。然后，您可以将所有当前变量中包含的任何值保存为当时的工作区。但是，如果您正在读取千兆字节长的数组（您的数据），那么您可能会逐块读取它们（可能是由于 RAM 限制？）并且在这种情况下保存工作空间可能对您没有帮助。

我永远不会打印任何东西来运输。在我的工作中（长时间渐近，所以我有大量的输出），我使用 fwrite 将所有内容保存为二进制文件。据我所知，转换为文本既慢又昂贵。

我希望这会有所帮助！

# c# - 如何使用网络连接另一台服务器？

> ID：13168499
> 
> 赞同：0
> 
> 时间：2012-10-31T22:42:59.570
> 
> 标签：c#, web-services

我想使用网络连接到另一台服务器。所以我写了下面的代码。

```
var webRequest = WebRequest.Create(@"10.3.4.56");

            using (var response = webRequest.GetResponse())
            {
                using (var rd = new StreamReader(response.GetResponseStream()))
                {
                    var soapResult = rd.ReadToEnd();
                }
            } 
```

但是有错误，它说

```
Invalid URI: The format of the URI could not be determined. 
```

如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:47:08.430

您传入的字符串`WebRequest.Create`必须是有效的[Uri](http://msdn.microsoft.com/en-us/library/system.uri.aspx)。试试`WebRequest.Create("http://10.3.4.56")`。

**小费！**使用静态`Uri.IsWellFormedUriString`方法检查 URI 字符串是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:46:25.020

尝试包括shema“http://10.3.4.56”

# matlab - 计算图像中白色像素的错误，matlab

> ID：13168521
> 
> 赞同：1
> 
> 时间：2012-10-31T22:45:07.747
> 
> 标签：matlab

在matlab中处理图像时我有一个问题，我有一个白色图像，当我尝试打印图像的灰度并将其增加1时，它给了我255，它从来没有给我256。这是代码. 并且计数为 0。

```
 function [ count ] = white( I )
    [row,col]=size(I);
    count=0;
    for x=1:row
        for y=1:col
            g=I(x,y);   %the value of the gray level on each pixel
            if((g+1) == 256)
            count=count+1;
            256
        end
    end
  end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:01:42.603

您的图像类可能是 uint8 ，而 255 是此类的最大值。例如：

```
 >>  uint8(inf)

ans =

  255 
```

而是尝试转换为不同的类，例如`I=uint32(I)`...

在@Aganders3 之后，我还将为您的代码提供一个不使用 for 循环的解决方案：

```
count=sum(I(:)>threshold); % Credit to @Jonas and @Aganders3 
```

其中 threshold 是您想要阈值的灰度级

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:05:05.243

我认为 nate 关于为什么这不起作用是正确的。

另外，考虑一个更简单的问题解决方案（给定`I`充满整数）：

`count = sum(vector(I == intmax(class(I))));`

# python - Django admin 可以处理数百万条记录吗？

> ID：13168523
> 
> 赞同：1
> 
> 时间：2012-10-31T22:45:20.943
> 
> 标签：python, django, scalability

我想知道 Django 管理员是否可以处理大量记录。

假设我有 200 万用户，例如如何处理分页？它会因为每次所有记录都被计算以提供给偏移量而变得非常缓慢吗？

注意：我打算使用 PostgreSQL。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:54:43.173

计数很快，对象的管理分页限制为每页 100 条记录。虽然对 200 万条记录进行排序可能需要一些时间，但是对于 200 万用户，您可以负担得起一些 ram 来在这些字段上放置一些索引；）

说真的：只要您的数据库可以处理它，这根本没有问题。

# .net - DrawString 仅适用于表单 vb.net 的左上角部分

> ID：13168524
> 
> 赞同：0
> 
> 时间：2012-10-31T22:45:22.017
> 
> 标签：.net, vb.net, visual-studio-2010, system.drawing, drawstring

这是我的代码

```
Public Class Form1

Public MyFormObject As Graphics = Me.CreateGraphics
Public objFont = New System.Drawing.Font("arial", 20)
Public a, b As Integer
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Randomize()
    For i = 1 To 10
        a = CInt(Int(Rnd() * Me.Width))
        b = CInt(Int(Rnd() * Me.Height))
        MyFormObject.DrawString("text", objFont, System.Drawing.Brushes.Black, a, b)
    Next
End Sub
End Class 
```

如您所见，我有一个按钮可以在表单中随机绘制字符串“text” 10 次。我的问题是它只会在表单的左上角绘制字符串，大约 260x260 从 0,0 开始。如果超出，它会从字面上切断文本。为什么是这样？它不应该适用于整个表格吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:59:03.080

您需要将 CreateGraphics 移动到您的子目录中。来自[微软的文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.creategraphics.aspx)：

> 通过 CreateGraphics 方法检索的 Graphics 对象通常不应在处理当前 Windows 消息后保留，因为使用该对象绘制的任何内容都将与下一个 WM_PAINT 消息一起删除。**因此，您不能缓存 Graphics 对象以供重用**。

```
Public Class Form1

    Public objFont = New System.Drawing.Font("arial", 20)
    Public a, b As Integer

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

        Dim MyFormObject As Graphics = Me.CreateGraphics

        Randomize()
        For i = 1 To 10
            a = CInt(Int(Rnd() * Me.Width))
            b = CInt(Int(Rnd() * Me.Height))
            MyFormObject.DrawString("text", objFont, System.Drawing.Brushes.Black, a, b)
        Next

        MyFormObject.Dispose

    End Sub

End Class 
```

# signals - 如何从计算机传输信号？

> ID：13168527
> 
> 赞同：0
> 
> 时间：2012-10-31T22:45:30.193
> 
> 标签：signals, device

是否有可以让我从计算机传输信号的设备？

例如，我想让我的电脑发送信号让我的汽车打开。

如果不是设备，还有其他方法吗？也许让我的电脑以某种方式按下遥控器？也许让我的电脑关闭我的远程电路以便发送信号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:49:34.707

您需要一个 RF 发射器外围设备供您的 PC 和软件控制它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:47:50.863

您可以对 arduino 进行编程，以将机器人手臂向下移动到足以按下遥控器的程度，这是我唯一能想到的。你需要学习一些C

# c# - 此接口是否已存在于标准 .NET 库中？

> ID：13168531
> 
> 赞同：3
> 
> 时间：2012-10-31T22:46:03.110
> 
> 标签：c#, .net, interface

我发现自己需要一个简单的通用接口，我编写了它，但结果证明它几乎是世界上最简单的接口。我想知道它是否已经以其他名称存在。我只是想确保我不会重新发明已经包含在 .NET 框架中的东西。

```
interface IReceiver<T>
{
   void Receive(T obj);
} 
```

我真的找不到一个很好的.NET 附带的“标准”接口列表。这个界面的结构对任何人来说都很熟悉吗？我是否重新发明了已经是标准的东西？

编辑：我有一个数据对象和一些对接收数据感兴趣的对象。对接收数据感兴趣的对象实现该接口，以便“路由”列表和地图可以将数据发送给它们。这个想法是路由中的完全泛化，路由将是数据驱动的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:47:25.953

好吧，这听起来像是`Action<T>`委托类型...我不知道任何等效的*接口*，但是您可以只使用委托吗？

编辑：好的，如果您需要使各种类实际实现它，那么我会将其保留为新接口...尤其是如果您可以给它一个比`IReceiver`.

# c++ - c++：以整数索引作为迭代器的循环缓冲区？

> ID：13168535
> 
> 赞同：2
> 
> 时间：2012-10-31T22:46:43.143
> 
> 标签：c++, boost, stl, c++11, circular-buffer

我正在编写一个 C++ 应用程序，我需要缓存已到达的最后*n条消息。*而且我需要一种方法来获取存储的最后一条消息的索引，以便以后可以找出所有随后到达的消息。由于该索引必须通过 HTTP 来回传输，因此它应该易于表示和检查，因为它可能成为不安全的用户内容。

到目前为止，我正在考虑使用`boost::circular_buffer`. 但是除了迭代器之外，我找不到找出最新条目索引的方法。

那么有没有办法（有效地）获得整数索引？
或者有没有办法将迭代器编码和解码成一个可以保存验证的字符串？
或者甚至是我还没有想到的完全不同的方式？

（允许使用 C++11 之前的任何内容；STL/stdlib 和 Boost 是首选）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T00:44:07.877

如果您不关心从缓冲区中擦除项目，直到它们被新数据覆盖，那么使用`std::vector`.

```
std::vector<item> buffer;
buffer.reserve(BUFFER_SIZE);
int next_slot = 0;

// to insert:
if (next_slot >= buffer.size())
    buffer.push_back(new_item);
else
    buffer[next_slot] = new_item;
++next_slot;
if (next_slot >= BUFFER_SIZE)
    next_slot = 0; 
```

# java - Netty socket.shutdownOutput() 相当于避免TCP RST？

> ID：13168539
> 
> 赞同：4
> 
> 时间：2012-10-31T22:46:52.430
> 
> 标签：java, sockets, tcp, netty

我想知道是否有一种方法可以避免在关闭 Netty 中的连接时设置 TCP RST 标志而不是 TCP FIN 标志，因为在 TCP 接收缓冲区中剩余输入数据。

用例是：

*   客户端（用 C 编写）发送包含许多字段的数据包。
*   服务器读取数据包，在早期字段遇到错误，抛出异常。
*   异常处理程序捕获异常，写入错误消息，并将写入时关闭回调添加到写入未来。

问题是：

接收缓冲区中的剩余数据会导致 Linux（或 Java..）使用 RST 标志标记 TCP 数据包。这可以防止客户端读取数据，因为当它开始尝试时，它发现由于套接字关闭而导致读取错误。

使用直接的 Java 套接字，我相信解决方案是在关闭之前调用 socket.shutdownOutput() 。Netty 中是否有等效功能或解决方法？

如果我只是继续从套接字读取，避免 RST 可能是不够的，因为在调用 close 时缓冲区中可能有也可能没有数据。

供参考：[http ://cs.baylor.edu/~donahoo/practical/CSockets/TCPRST.pdf](http://cs.baylor.edu/~donahoo/practical/CSockets/TCPRST.pdf)

更新：

问题的另一个参考和描述：http: [//docs.oracle.com/javase/1.5.0/docs/guide/net/articles/connection_release.html](http://docs.oracle.com/javase/1.5.0/docs/guide/net/articles/connection_release.html)

调用 shutdownOutput() 应该有助于更有序地关闭连接（通过发送 FIN），但如果客户端仍在发送数据，那么无论如何都会发送 RST 消息（请参阅 EJP 的回答。可能会提供等效的 shutdownOutput()在 Netty 4+。

解决方案是从客户端读取所有数据（但您永远无法确定客户端何时会完全停止发送，尤其是在恶意客户端的情况下），或者在发送响应后关闭连接之前简单地等待（参见答案来自声名狼藉）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:31:10.987

如果您可以从 Netty 获得底层证券`SocketChannel`，我不是专家，您可以致电`channel.socket().shutdownOutput().`

> 接收缓冲区中的剩余数据会导致 Linux（或 Java..）使用 RST 标志标记 TCP 数据包。这可以防止客户端读取数据，因为当它开始尝试时，它发现由于套接字关闭而导致读取错误。

我不明白这一点。TCP 保证客户端在获得 FIN 之前将接收到其套接字接收缓冲区中的所有数据。如果您在谈论*服务器的*套接字接收缓冲区，它将被 close() 丢弃，并且客户端*进一步*尝试发送将得到一个 RST，这将成为`IOException:`连接重置'，因为没有连接可以与之关联因此无处可放。NB 是 TCP 完成了这一切，而不是 Java。

但是在我看来，如果频道不好，您应该在关闭频道*之前阅读整个请求。*

您还可以尝试增加套接字接收缓冲区，使其足以容纳整个请求。这确保了当您想要关闭连接时客户端不会仍然发送。*编辑：*我看到请求是兆字节，所以这不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:26:51.737

你可以试试这个：服务器写入错误消息后，等待 500 毫秒，然后关闭（）。看看客户端现在是否可以收到错误消息。

我猜测由于 TCP 延迟确认，服务器接收缓冲区中的数据包尚未被确认。如果现在调用 close()，则这些数据包的正确响应是 RST。但是如果调用了shutdownOutput()，这是一个优雅的关闭过程；数据包首先被确认。

* * *

编辑：进一步了解此事后的另一次尝试：

应用程序协议是，服务器可以随时响应，即使客户端请求仍在流式传输中。因此，假设阻塞模式，客户端应该有一个从服务器读取的单独线程。一旦客户端从服务器读取响应，它就需要插入写入线程，以停止进一步写入服务器。这可以通过简单地关闭（）套接字来完成。

在服务器端，如果在读取所有请求数据之前写入响应，然后调用 close()，则很可能会向客户端发送 RST。显然，如果在接收缓冲区不为空时调用 close()，大多数 TCP 堆栈都会将 RST 发送到另一端。即使 TCP 堆栈不这样做，也很可能会有更多数据在 close() 之后立即到达，无论如何都会触发 RST。

发生这种情况时，客户端很可能无法读取服务器响应，因此会出现问题。

所以服务器不能在响应后立即关闭（），它需要等到客户端收到响应。服务器怎么知道的？

首先，客户端如何知道它已收到完整的响应？也就是说，响应是如何终止的？如果响应被 TCP FIN 终止，服务器必须在响应后通过调用 shutdownOutput() 发送 FIN。如果响应是自终止的，例如通过 HTTP Content-Length 标头，则服务器不需要调用 shutdownOutput()。

客户端收到完整响应后，根据协议，它应该立即停止向服务器发送更多数据。这是通过粗略地切断连接来完成的；该协议没有设计更优雅的方式。FIN 或 RST 都可以。

因此，服务器在写入响应后，应该继续从客户端读取，直到 EOF 或错误。然后它可以关闭（）套接字。

但是，此步骤应该有一个超时，以解决恶意/损坏的客户端和网络问题。在大多数情况下，几秒钟应该足以完成该步骤。

此外，服务器可能不想从客户端读取，因为它不是免费的。服务器可以简单地等待超时，然后关闭（）。

# jquery - 使用 jquery width 使 div 不断成为窗口宽度

> ID：13168543
> 
> 赞同：0
> 
> 时间：2012-10-31T22:47:27.513
> 
> 标签：jquery, width

我有一个 div，我希望它始终是浏览器窗口的宽度，即使用户正在调整它的大小。我想使用 jquery .width 但我不知道如何设置它，所以即使用户调整他们的窗口大小它也总是在调整。我不确定是否将 jquery .css 与 .width 一起使用，或者不同的方式是否会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:49:13.173

```
$(window).on('resize', function(){
    $('div').width($(window).width());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:08:20.580

您可能想要研究[jQuery outerWidth](http://api.jquery.com/outerWidth/) `outerWidth([addMarginBoolean])`方法添加`border`、`padding`和可选`margin`到元素的法线`width`。如果您预见到 div 的宽度超出窗口边缘会出现问题，那么您可以试试这个。

```
function setWidth() {
  $('.width100').outerWidth($(window).width() - $('.width100').offset().left);
}
$(window).on('resize', setWidth); // resize div on window resize
setWidth();​ // resize div on page load 
```

[这是它的一个小提琴](http://jsfiddle.net/scrimothy/fVMdR/3/)

# ruby - 如何与工头一起运行多个捆绑包的多个应用程序

> ID：13168544
> 
> 赞同：3
> 
> 时间：2012-10-31T22:47:32.110
> 
> 标签：ruby, bundler, foreman

我有一个 ruby​​ 应用程序，它依赖于我构建的几个 Web 服务。

首先，我有以下 Procfile：

```
mondodb: /home/dwaynemac/mongodb/bin/mongod 
accounts: ./script/start_accounts.sh
contacts: ./script/start_contacts.sh
activity: ./script/start_activity_stream.sh
web: ./script/start.sh 
```

每个 start_xxx.sh 脚本都执行以下操作：

```
cd ../activity_stream; bundle exec unicorn -p 3003 -c ./config/unicorn.rb 
```

如果我手动运行这些前一行 activity_stream 运行正常。但是当从工头那里跑出来时，一些宝石是无法识别的。好像捆绑包没有正确构建。

示例错误：

```
activity_stream/config/boot.rb:2:in `require': no such file to load -- grape (LoadError) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T03:02:11.410

使用[分包商 gem](https://github.com/pitluga/subcontractor)更改工作目录：

```
image_fallback: subcontract -d lib/rack/img_fallback/ -- bundle exec unicorn -c unicorn.conf config.ru 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-15T23:33:26.713

您必须为要启动的每个应用程序使用新的 bash shell。

```
# Procfile
app1: sh -c 'cd path/to/app1 && bundle exec rackup config.ru -p $PORT'
app2: sh -c 'cd path/to/app2 && bundle exec rackup config.ru -p $PORT' 
```

然后使用工头

```
foreman start --procfile path/to/Procfile 
```

更多信息在这里[http://www.seanbehan.com/how-to-boot-up-multiple-sinatra-applications-at-the-same-time-with-foreman](http://www.seanbehan.com/how-to-boot-up-multiple-sinatra-applications-at-the-same-time-with-foreman)

# r - xts::period.apply 和 cumprod

> ID：13168545
> 
> 赞同：7
> 
> 时间：2012-10-31T22:47:41.373
> 
> 标签：r, finance, xts

我正在尝试计算 xts 对象子集的累积乘积。这是我想要的一个示例，以及一个问题是否可以使用 period.apply 或其他一些基于 c++ 的快速函数更快/更优雅地完成？

```
# install.packages("qmao", repos="http://R-Forge.R-project.org")
require(qmao) # for do.call.rbind()

# I need something like cumprod over xts but by endpoints (subsets of xts)
test <- xts(rep(0.01, length(as.Date(13514:13523, origin="1970-01-01"))), as.Date(13514:13523, origin="1970-01-01"))
ep <- c(0, 5, NROW(test))
# This does not do the trick
period.prod(test, INDEX=ep)
# So, try the obvious, but it does not do the trick
period.apply(test, INDEX=ep, FUN=function(x) cumprod(1 + x))

# Well, write your own
# Hm, there is no split.xts that takes ep (endpoints) as parameter...
# OK, split it manually
test.list <- list(length(ep) - 1)
k <- 1:(length(ep) - 1)
test.list <- lapply(k, function(x) test[(ep[x] + 1):ep[x + 1], ])
# This is what I want...
do.call.rbind(lapply(test.list, function(x) cumprod(1 + x)))
# Is there a better/faster way to do this? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T23:07:29.950

`period.apply`和朋友不会工作，因为他们每个时期只返回一个观察结果。你想要更多的东西`ave`：

```
dep <- diff(ep)
out.ave <- ave(test+1, rep(ep, c(0,dep)), FUN=cumprod) 
```

# php - PHP通过多个表搜索功能

> ID：13168551
> 
> 赞同：3
> 
> 时间：2012-10-31T22:48:08.843
> 
> 标签：php, mysql

我正在编写一个搜索功能，它需要查询 4 ​​个表。

*   用户
*   类型
*   亚型
*   提供的服务

我需要对表进行搜索，该`users`表查询`types`,`subtypes`并`services offered`基于`id`users 表中的相应项。

例如：

users 表中的一行可能是这样的：

```
| id | type | subtype | services_offered | first_name | last_name | contact | company |
| 1  |  1   |    2    |        47        | Gareth     | Davies    | g@g.com | Gazza   | 
```

类型表中的一行可能是这样的：

```
| id |   type  |
| 1  | finance | 
```

等等...

我已经让它工作了，但由于某种原因，它为每个联系人返回大约 30 行！这是我的 SQL。

```
SELECT
    c.type, c.subtype, c.first_name, c.last_name, c.company, c.contact, c.services_provided, c.additional_information, c.date_updated,  t.id, t.type, s.id, s.subtype, so.id, so.services_offered 
FROM 
    contacts c, types t, subtypes s, services_offered so 
WHERE 
    ((c.type LIKE '%$q%' || c.subtype LIKE '%$q%' || c.first_name LIKE '%$q%' || c.last_name LIKE '%$q%' || c.company LIKE '%$q%' || c.services_provided LIKE '%$q%' || c.contact LIKE '%$q%' || c.additional_information LIKE '%$q%' || t.type LIKE '%$q%' || s.subtype LIKE '%$q%' || so.services_offered LIKE '%$q%') 
    AND (c.type = t.id || c.subtype = s.id || c.services_provided = so.id)) 
```

理想情况下，它只会返回每个联系人中的一个！

任何帮助将不胜感激！

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:12:26.123

一个合理的猜测是您需要对结果进行分组，所以使用

```
 GROUP BY c.id 
```

在查询结束时可能会这样做

# sql - SQL Oracle 组合多个结果行

> ID：13168557
> 
> 赞同：0
> 
> 时间：2012-10-31T22:48:56.500
> 
> 标签：sql, oracle

我有以下查询

```
Select 
case upper(device_model)
        when 'IPHONE' then 'iOS - iPhone'
        when 'IPAD' then 'iOS - iPad'
        when 'IPOD TOUCH' then 'iOS - iPod Touch'
        Else 'Android'
        End As Device_Model,
count(create_dtime) as Installs_Oct17_Oct30
From Player
Where Create_Dtime >= To_Date('2012-Oct-17','yyyy-mon-dd')
And Create_Dtime <= To_Date('2012-Oct-30','yyyy-mon-dd')
Group By Device_Model
Order By Device_Model 
```

这会吐出多行显示为“Android”的结果....我希望只有 4 个结果行，每个案例一个....所以结果如下：

```
Device_Model     Installs_Oct17_Oct30
Android            987
iOS - iPad         12003
iOS - iPhone       8563
iOS- iPod Touch    3482 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:59:35.823

您按字段 device_model 分组，而不是您的表达式：

```
Select 
case upper(device_model)
    when 'IPHONE' then 'iOS - iPhone'
    when 'IPAD' then 'iOS - iPad'
    when 'IPOD TOUCH' then 'iOS - iPod Touch'
    Else 'Android'
    End As Device_Model,
count(create_dtime) as Installs_Oct17_Oct30
From Player
Where Create_Dtime >= To_Date('2012-Oct-17','yyyy-mon-dd')
And Create_Dtime <= To_Date('2012-Oct-30','yyyy-mon-dd')
Group By
case upper(device_model)
    when 'IPHONE' then 'iOS - iPhone'
    when 'IPAD' then 'iOS - iPad'
    when 'IPOD TOUCH' then 'iOS - iPod Touch'
    Else 'Android'
    End
Order By Device_Model 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T18:23:59.887

无需按大字段分组...只需使用下面的简单查询.. [您的 sql] Group By 1 Order By Device_Model

这意味着您在选择查询中按字段 1 进行分组。或者尝试给出别名。按 device_model 的别名顺序分组

# php - 如何使用 Holt-Winters 季节性阻尼法计算 PHP 中的两个月销售预测？

> ID：13168568
> 
> 赞同：0
> 
> 时间：2012-10-31T22:49:30.137
> 
> 标签：php, projection, ecommerce-sales

Holt-Winters 在这里介绍：

[http://en.wikipedia.org/wiki/Holt-Winters](http://en.wikipedia.org/wiki/Holt-Winters)

此处讨论了它的季节性阻尼版本（向下滚动页面）：

[http://otexts.com/fpp/7/5/](http://otexts.com/fpp/7/5/)

简而言之，它基本上着眼于 3 件事：

*   长期趋势
*   短期趋势
*   季节性趋势

它也不会将它们平均在一起，因为您真正需要的是加权平均，其中季节性和短期比长期趋势更重要，自然地，财务数据趋势。

*给定 $anYear1 和 $anYear2，我如何应用 Holt-Winters 季节性阻尼方法来预测 $anYear2 结束后的 2 个月？*假设 $anYear1 是一个包含 12 个数字的数组。假设 $anYear2 是一个范围为 0 到 12 个数字的数组。

所以，我可以用随机数据填充它，如下所示：

```
<?php

$anYear1 = array();
$anYear2 = array();
$nStop = 10; // so we need 11 and 12 of the year
for ($i = 1; $i <= 12; $i++) {
  $anYear1[$i] = rand(200,500);
  if ($i <= $nStop) {
    // give it a natural lift like real financial data
    $anYear2[$i] = rand(400,700); 
  }
}
$nSeasonRange = 4; // 4 months in a business quarter

Therefore, I want to create a function like so:

function forecastHoltWinters($anYear1, $anYear2, $nSeasonRange = 4) {
  ///////////////////
  // DO MAGIC HERE //
  ///////////////////

  // an array with 2 numbers, indicating 2 months forward from end of $anYear2
  return $anForecast;
}

$anForecast = forecastHoltWinters($anYear1, $anYear2, $nSeasonRange);
echo "YEAR 1\n";
print_r($anYear1);
echo "\n\nYEAR 2\n"
print_r($anYear2);
echo "\n\nTWO MONTHS FORECAST\n";
print_r($anForecast); 
```

注意：我在[这里](https://github.com/ianbarber/PHPIR/blob/master/holtwinters.php)找到了一个 Github 示例，但它没有显示如何进行投影。它也在[这里](http://phpir.com/smoothing-with-holt-winter)讨论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:11:18.977

我找到了一种方法来调整[Ian Barber 的](https://github.com/ianbarber/PHPIR/blob/master/holtwinters.php)功能来做我需要的事情。

```
<?php

error_reporting(E_ALL);
ini_set('display_errors','On');

$anYear1 = array();
$anYear2 = array();
$nStop = 10;
for($i = 1; $i <= 12; $i++) {
    $anYear1[$i] = rand(100,400);
    if ($i <= $nStop) {
        $anYear2[$i+12] = rand(200,600);
    }
}

print_r($anYear1);
print_r($anYear2);
$anData = array_merge($anYear1,$anYear2);
print_r(forecastHoltWinters($anData));

function forecastHoltWinters($anData, $nForecast = 2, $nSeasonLength = 4, $nAlpha = 0.2, $nBeta = 0.01, $nGamma = 0.01, $nDevGamma = 0.1) {

    // Calculate an initial trend level
    $nTrend1 = 0;
    for($i = 0; $i < $nSeasonLength; $i++) {
      $nTrend1 += $anData[$i];
    }
    $nTrend1 /= $nSeasonLength;

    $nTrend2 = 0;
    for($i = $nSeasonLength; $i < 2*$nSeasonLength; $i++) {
      $nTrend2 += $anData[$i];
    }
    $nTrend2 /= $nSeasonLength;

    $nInitialTrend = ($nTrend2 - $nTrend1) / $nSeasonLength;

    // Take the first value as the initial level
    $nInitialLevel = $anData[0];

    // Build index
    $anIndex = array();
    foreach($anData as $nKey => $nVal) {
      $anIndex[$nKey] = $nVal / ($nInitialLevel + ($nKey + 1) * $nInitialTrend);
    }

    // Build season buffer
    $anSeason = array_fill(0, count($anData), 0);
    for($i = 0; $i < $nSeasonLength; $i++) {
      $anSeason[$i] = ($anIndex[$i] + $anIndex[$i+$nSeasonLength]) / 2;
    }

    // Normalise season
    $nSeasonFactor = $nSeasonLength / array_sum($anSeason);
    foreach($anSeason as $nKey => $nVal) {
      $anSeason[$nKey] *= $nSeasonFactor;
    }

    $anHoltWinters = array();
    $anDeviations = array();
    $nAlphaLevel = $nInitialLevel;
    $nBetaTrend = $nInitialTrend;
    foreach($anData as $nKey => $nVal) {
      $nTempLevel = $nAlphaLevel;
      $nTempTrend = $nBetaTrend;

      $nAlphaLevel = $nAlpha * $nVal / $anSeason[$nKey] + (1.0 - $nAlpha) * ($nTempLevel + $nTempTrend);
      $nBetaTrend = $nBeta * ($nAlphaLevel - $nTempLevel) + ( 1.0 - $nBeta ) * $nTempTrend;

      $anSeason[$nKey + $nSeasonLength] = $nGamma * $nVal / $nAlphaLevel + (1.0 - $nGamma) * $anSeason[$nKey];

      $anHoltWinters[$nKey] = ($nAlphaLevel + $nBetaTrend * ($nKey + 1)) * $anSeason[$nKey];
      $anDeviations[$nKey] = $nDevGamma * abs($nVal - $anHoltWinters[$nKey]) + (1-$nDevGamma) 
                  * (isset($anDeviations[$nKey - $nSeasonLength]) ? $anDeviations[$nKey - $nSeasonLength] : 0);
    }

    $anForecast = array();
    $nLast = end($anData);
    for($i = 1; $i <= $nForecast; $i++) {
       $nComputed = round($nAlphaLevel + $nBetaTrend * $anSeason[$nKey + $i]);
       if ($nComputed < 0) { // wildly off due to outliers
         $nComputed = $nLast;
       }
       $anForecast[] = $nComputed;
    }

    return $anForecast;
} 
```

# javascript - jQuery Ajax OPTIONS 调用中的自定义标头

> ID：13168569
> 
> 赞同：0
> 
> 时间：2012-10-31T22:49:32.310
> 
> 标签：javascript, jquery, ajax, http, rest

所以我知道，如果我的 Ajax 调用中有自定义标头，浏览器会进行预检以确保资源可用。我的问题是我的 REST 服务使用 Http-Authorization 来保证安全性，但是在 OPTIONS 调用中，这个标头没有被传入，即使它是通过 beforeSend() 添加的。

我必须回复未经身份验证的选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:12:53.247

我相信该`OPTIONS`请求是对 CORS（跨源资源共享）的预检。我认为您无法控制`OPTIONS`请求，您的浏览器会自动发出请求。

另外，我不一定认为这是一个问题。您可以在白名单的基础上实施 CORS 回复标头。比如说，允许域 X 和 Y，但不允许域 Z。如果您要求`OPTIONS`来自 X，您可以回复“允许：X”。Y 也是如此。但如果你来自 Z，你会说“不允许”。

解决这个问题的方法，以及与旧浏览器（`DomainRequest`任何人？）的向后兼容性，您可以使用 JSONp，它不是很好，但更简单。

# jquery - 调用 jquery ajax - .fail vs. :error

> ID：13168572
> 
> 赞同：79
> 
> 时间：2012-10-31T22:49:46.107
> 
> 标签：jquery, ajax, callback

我应该使用哪一个？

有什么理由使用其中一个而不是另一个？

一种更适合错误处理吗？

```
$.ajax({
    url: url,
    data: { start: start, end: end }
}).done(function(data, textStatus, jqXHR) {
    $('#myElement').append(data);
}).fail(function() {
    // report error    
}); 
```

或者

```
$.ajax({
    url: url,
    data: { start: start, end: end },
    success: function(data, textStatus, jqXHR) {
        $('#myElement').append(data);
    },
    error: function(jqXHR, textStatus, errorThrown) {
        // report error
    }
}); 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-31T22:51:26.863

这两个选项是等效的。

但是，promise 样式的接口 (`.fail()`和`.done()`) 允许您将创建请求的代码与处理响应的代码分开。

您可以编写一个发送 AJAX 请求并返回 jqXHR 对象的函数，然后在别处调用该函数并添加一个处理程序。

当与该`.pipe()`函数结合使用时，promise 样式的接口还可以帮助减少在进行多个 AJAX 调用时的嵌套：

```
$.ajax(...)
    .pipe(function() { 
        return $.ajax(...);
    })
    .pipe(function() { 
        return $.ajax(...);
    })
    .pipe(function() { 
        return $.ajax(...);
    }); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-02-03T17:34:07.450

只是为了刷新这个...

从 jQuery 1.8 起，成功和错误方法已被弃用。

[jQuery 阿贾克斯](http://api.jquery.com/jquery.ajax/)

> 弃用通知：jqXHR.success()、jqXHR.error() 和 jqXHR.complete() 回调自 jQuery 1.8 起已弃用。要为最终删除准备代码，请改用 jqXHR.done()、jqXHR.fail() 和 jqXHR.always()。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-04-01T13:56:35.883

使用可链接的[延迟对象](http://api.jquery.com/category/deferred-object/)承诺样式允许更简洁的结构和使用[always](http://api.jquery.com/deferred.always/)。

```
let data = {"key":"value"}

$.ajax({
    type: 'PUT',
    url: 'http://example.com/api',
    contentType: 'application/json',
    data: JSON.stringify(data), 
}).done(function () {
    console.log('SUCCESS');
}).fail(function (msg) {
    console.log('FAIL');
}).always(function (msg) {
    console.log('ALWAYS');
}); 
```

# .net - 在 VB.NET 中使用 HTML 进行 URL 路由以调用模块？

> ID：13168573
> 
> 赞同：0
> 
> 时间：2012-10-31T22:49:44.923
> 
> 标签：.net, vb.net, visual-studio

目的是通过按下按钮来访问控制器中的模块。

因此，HelloWorld 消息确实会打印在屏幕上。

## 目录结构

* * *

*   模型/HelloWorldController.vb
*   意见/首页/FrontPage.vbhtml
*   意见/_ViewStart.vbhtml
*   视图/共享/_Layout.vbhtml

## 示例代码

* * *

### FrontPage.vhtml

```
<h1>Cause the HelloWorld Line...</h1>

<form name="hello_world_button" action="" method="post">
    <button type="button" name="button">Press it!</button>
</form> 
```

### HelloWorldController.vb

```
Module HelloWorld
    ' Every console application starts with Main
    Sub Main()
        System.Console.WriteLine("Hello world!")

    End Sub
End Module 
```

## 使用的工具

* * *

Visual Studio 2012、Visual Basic、MVC 4

## 进一步的附录

* * *

对于那些想知道的人，这里展示了使用 PHP 的预期 HelloWorld 应用程序 - （PHP 一直是我在编程方面的背景）

```
<body>
    <form action="" method="POST">
        <button name="button">Press It!</button>
    </form>

    <?php
    $button = $_POST['button'];

    if(isset($button)) {
        echo "Hello World Message!";
        }
    ?>

</body> 
```

这是一个可以查看的示例：[单击此处](http://zikanti.com/myroot/helloworldmessage.php)

## URL 路由

* * *

我目前还专注于 VB.NET 的“路由”和“http”协议系统。

我尝试了以下方法：

```
<h1>Cause the HelloWorld Line...</h1>

<form name="hello_world_button" action="@Url.Action("HelloWorld", "~/~/Models/HelloWorldController.vb")" method="post">
    <button type="button" name="button">Press it!</button>
</form> 
```

HTML`action`属性包含`url.action`带有模块名称`HelloWorld`和控制器文件路径的命令。

但是，当按下按钮时，消息不会打印在屏幕上。

有没有办法检查是否`routing`正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T01:47:57.243

您无需填写`action`Web 表单的属性。

来源：[ASP.NET 表单处理基础](http://www.sitepoint.com/net-form-processing-basics/)

> 标签的 action 属性已被完全移除；ASP.NET 在处理标签时会为我们添加它。

# ruby-on-rails - 用图片加速工厂测试

> ID：13168575
> 
> 赞同：3
> 
> 时间：2012-10-31T22:49:48.243
> 
> 标签：ruby-on-rails, rspec

我有一个集成测试，它使用回形针和一个带有`Rack::Test::UploadedFile`to `(:create`) 图像的工厂`20.times`。

这个测试异常缓慢。完成时间超过 60 秒。我用小 30 倍的图像替换了图像，它只将测试时间缩短了 20 秒。

我怎样才能加快这个测试和其他类似的测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T07:46:22.820

我建议你存根 imagemagick，因为这是最减慢测试的部分。

你可以试试[这样](https://gist.github.com/gabrielecirulli/6340651 "存根 imagemagick（方法 1）")或[这样](https://gist.github.com/ngauthier/406460 "存根 imagemagick（方法 2）")

而且，如果您不使用回形针（我只是假设...），您可以使用类似[mockfs](http://mockfs.github.io/ "模拟文件")的东西，它会在测试中存根您的文件系统以加快速度。

# mysql - 将年时日期间隔转换为天数

> ID：13168579
> 
> 赞同：1
> 
> 时间：2012-10-31T22:50:10.290
> 
> 标签：mysql, date, mysql-5.1

我有一个 0012-11-03 （年-月-日）的间隔，并想将其转换为天数：

12 * ~365 + 从 01-01 到 11-03 的天数 = 答案。

必须考虑闰年。（答案 + 12/4 ??）

我能想出的最接近的方法是使用 TO_DAYS() MySQL 5.1，但该功能“没有考虑日历更改时丢失的天数”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:13:09.243

您真的在使用 0012-11-03 的日期吗？即公元12年？

最近没有更改日历。他们指的是公元 1582 年从儒略历到公历转换中损失的日子。

这应该有效：

```
SELECT TO_DAYS('2012-11-03') - TO_DAYS('2012-01-01'); 
```

返回 307。

# ruby-on-rails - 为 Rails 应用程序实现移动视图

> ID：13168581
> 
> 赞同：0
> 
> 时间：2012-10-31T22:50:19.637
> 
> 标签：ruby-on-rails, jquery-mobile

我想以这样一种方式设置它，当手机使用我的网站时，它将被重定向到带有“m”子域的 url，但我将使用相同的控制器，但只是不同的视图。我只需要一个关于如何实施类似事情的一般路线图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T06:56:53.530

为此，您需要在应用程序控制器中添加一个前置过滤器，例如

```
before_filter :detect_mobile_device

#Checking against the user agent
def detect_mobile_device       
   if request.user_agent =~ /Mobile|webOS/
     redirect_to m.****.com
   end
end 
```

然后你可以修改并利用它来渲染不同的视图，你也可以使用

```
 def is_mobile_device?   
   return request.user_agent =~ /Mobile|webOS/
 end 
```

对于某些浏览器，它可能不起作用，因此您可以使用此 gem

```
gem 'mobile-fu' 
```

# ruby-on-rails - 测试未通过：未定义的方法“验证！” 对于零：NilClass？

> ID：13168586
> 
> 赞同：10
> 
> 时间：2012-10-31T22:51:17.617
> 
> 标签：ruby-on-rails, rspec

我有以下失败：

> ```
> Failures:
> 
>   1) RelationshipsController creating a relationship with Ajax should increment the Relationship count
>      Failure/Error: xhr :post, :create, relationship: { followed_id: other_user.id }
>      NoMethodError:
>        undefined method `authenticate!' for nil:NilClass
>      # ./spec/controllers/relationships_controller_spec.rb:14:in `block (4 levels) in <top (required)>'
>      # ./spec/controllers/relationships_controller_spec.rb:13:in `block (3 levels) in <top (required)>' 
> ```

但这很奇怪，如果我访问该站点，事情就会起作用（如果我单击“*关注*”按钮，`followers`计数器会增加：

 *![在此处输入图像描述](../Images/9b41f8b51123fe08c41871099ea3bc59.png)

最奇怪的是没有任何身份验证！**Relations_controller_spec.rb**中的方法：

```
require 'spec_helper'

describe RelationshipsController do

  let(:user) { FactoryGirl.create(:user) }
  let(:other_user) { FactoryGirl.create(:user) }

  before { sign_in user }

  describe "creating a relationship with Ajax" do

    it "should increment the Relationship count" do
      expect do
        xhr :post, :create, relationship: { followed_id: other_user.id }
      end.to change(Relationship, :count).by(1)
    end

    it "should respond with success" do
      xhr :post, :create, relationship: { followed_id: other_user.id }
      response.should be_success
    end
  end

  describe "destroying a relationship with Ajax" do

    before { user.follow!(other_user) }
    let(:relationship) { user.relationships.find_by_followed_id(other_user) }

    it "should decrement the Relationship count" do
      expect do
        xhr :delete, :destroy, id: relationship.id
      end.to change(Relationship, :count).by(-1)
    end

    it "should respond with success" do
      xhr :delete, :destroy, id: relationship.id
      response.should be_success
    end
  end
end 
```

既不在控制器中：

```
class RelationshipsController < ApplicationController
  before_filter :authenticate_user!

  def create
    @user = User.find(params[:relationship][:followed_id])
    current_user.follow!(@user)
    respond_to do |format|
      format.html { redirect_to @user }
      format.js
    end
  end

  def destroy
    @user = Relationship.find(params[:id]).followed
    current_user.unfollow!(@user)
    respond_to do |format|
      format.html { redirect_to @user }
      format.js
    end
  end
end 
```

可能是什么问题呢？

（顺便说一下，这些测试是按照[Ruby on Rails 教程](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)进行的。之后，我删除了所有的身份验证系统，因为我想使用**Devise**。）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-01-16T15:50:32.420

设置`config.include Devise::TestHelpers, :type => :controller`在更高版本的设计中不再起作用。您需要做的是注销匿名用户以设置正确的变量：

```
before :each do
  sign_out :user
end 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-01T01:05:24.533

我不得不添加这个：

**spec_helpers.rb：**

```
RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller
end 
```*

# javascript - 使用 CSS 或 Javascript 样式化下拉表单元素（选择）

> ID：13168588
> 
> 赞同：0
> 
> 时间：2012-10-31T22:51:21.663
> 
> 标签：javascript, jquery, forms, html, css

我四处寻找，并没有找到任何方法来做我想做的事。我想为标准表单下拉（选择）元素的顶层设置样式。

我希望它看起来像这样：
![在此处输入图像描述](../Images/7b298c5c894ea2ac8222676439a9adf5.png)

现在我知道我可以使用 CSS 设置边框、文本和渐变样式，但我想知道将下拉菜单设为静态图像是否更容易？

或者甚至可以以这种方式设置下拉样式？我从来没有这样做过。

编辑：我发现[这个教程](http://bavotasan.com/2011/style-select-box-using-only-css/)非常接近。不过就是想看看别人的看法。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:05:34.763

在这里找到我的答案，这正是我想要完成的，它只使用 CSS，这是一个奖励：
[http ://danielneumann.com/blog/how-to-style-dropdown-with-css-only/](http://danielneumann.com/blog/how-to-style-dropdown-with-css-only/)

```
select { 
font-size:1.1em; 
text-transform: uppercase;
font-weight: 200;
width:195px;
border:0; 
border-radius: 0px;
color:#787878; 
background:transparent;
padding-top: 7px; 
padding-bottom: 10px; 
-webkit-appearance: none;
*width:190px; 
*background:#58B14C;
}

#mainselection  { 
color: #787878 !important;
width: 197px;
background: url("http://i.imgur.com/N6SyH.png") no-repeat scroll 165px 8px, #f5f5f5; /* Old browsers */
/* IE9 SVG, needs conditional override of 'filter' to 'none' */
background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2Y1ZjVmNSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjQwJSIgc3RvcC1jb2xvcj0iI2VmZWZlZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlOGU4ZTgiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
background: url('http://i.imgur.com/N6SyH.png') no-repeat scroll 169px 8px, -moz-linear-gradient(top, #f5f5f5 0%, #efefef 40%, #e8e8e8 100%); /* FF3.6+ */
background: url('http://i.imgur.com/N6SyH.png') no-repeat scroll 169px 8px, -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f5f5f5), color-stop(40%,#efefef), color-stop(100%,#e8e8e8)); /* Chrome,Safari4+ */
background: url('http://i.imgur.com/N6SyH.png') no-repeat scroll 169px 8px, -webkit-linear-gradient(top, #f5f5f5 0%,#efefef 40%,#e8e8e8 100%); /* Chrome10+,Safari5.1+ */
background: url('http://i.imgur.com/N6SyH.png') no-repeat scroll 169px 8px, -o-linear-gradient(top, #f5f5f5 0%,#efefef 40%,#e8e8e8 100%); /* Opera 11.10+ */
background: url('http://i.imgur.com/N6SyH.png') no-repeat scroll 169px 8px, -ms-linear-gradient(top, #f5f5f5 0%,#efefef 40%,#e8e8e8 100%); /* IE10+ */
background: url('http://i.imgur.com/N6SyH.png') no-repeat scroll 169px 8px, linear-gradient(to bottom, #f5f5f5 0%,#efefef 40%,#e8e8e8 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f5f5f5', endColorstr='#e8e8e8',GradientType=0 ); /* IE6-8 */
border: solid 1px #D1D1D1;
-webkit-box-shadow: inset 0px 1px 0px 0px #FFF;
-moz-box-shadow: inset 0px 1px 0px 0px #FFF;
box-shadow: inset 0px 1px 0px 0px #FFF;
} 
```

这 [是一个现场的jsfiddle](http://jsfiddle.net/mattmagi/yvgZP/)。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T17:41:03.483

[https://github.com/Pryme8/prymeUI](https://github.com/Pryme8/prymeUI)

我正在开发一个插件，该插件将允许您对所有元素进行样式设置以匹配您创建的选择框等主题。

它仍处于 alpha 开发阶段，但我会在空闲时间进行开发，一旦我支持至少 80% 的 DOM 元素及其属性，我将开始添加主题，希望通过一次调用 jquery 字符串，您将能够为整个表单或页面设置样式，甚至不必担心 CSS...

# php - 避免 XML 解析中的数据重复 (PHP)

> ID：13168599
> 
> 赞同：0
> 
> 时间：2012-10-31T22:52:53.823
> 
> 标签：php, xml

我正在尝试使用 XML 和 php 对我的产品进行排序。我想以
这样的方式在页面上显示结果：

**A）首先代码可以根据我的基于字段（代码）的urisegment提取XML数据，并根据段（$id）给我相关的具体产品。**

**B）其次，它可以在同一页面中显示属于同一类别的所有产品，而无需再次显示上述产品。**

我的查询字符串如下所示： http: [//myspec.com/productspec/listings/10004/EDEN%2046cmTROUGH](http://myspec.com/productspec/listings/10004/EDEN%2046cmTROUGH)

```
<?
 $list = groupBy(file_get_contents('XML/output.xml'), "WhatMoreProductSubRange");
 $id=urldecode($this->uri->segment(4)); // URL values for WhatMoreProductSubRange 
 $id2=urldecode($this->uri->segment(3)); // URL values for Code 

 foreach ($list[$id] as $product ) 
 {
  if ($id2==$product->Code)
   {
     $subcat=$product->WhatMoreProductSubRange;

  ?>
      <h1><?=$product->Name?> </h1>
<?
   }
   else { 
?>
      <h2><?=$product->Name?> </h2>
<? 
        }
}

?>
<?
  function groupBy($xml, $categoryName) {
   $xml = new \SimpleXMLElement($xml);
    $category = array();
    foreach ( $xml as $row ) {
     $attr = $row->attributes();

    if (! isset($attr->$categoryName)) {
        trigger_error("$categoryName does not exist in XML");
        break;
    }

    $category[(string) $attr->$categoryName][] = $attr;
  }
  return $category;
}
?> 
```

**XML：输出.xml**

```
<?xml version="1.0" standalone="yes"?>
<Rows>
<Row Code="1002" Name="EDEN TROUGH  Terracotta Blue" WhatMoreProductRange="Eden"    
WhatMoreProductSubRange="EDEN 46cmTROUGH" WhatMoreWebCategory="Garden Products" />
<Row Code="1003" Name="EDEN TROUGH  Terracotta Black" WhatMoreProductRange="Eden"    
WhatMoreProductSubRange="EDEN 46cmTROUGH" WhatMoreWebCategory="Garden Products" />
<Row Code="1004" Name="EDEN TROUGH  Terracotta Orange" WhatMoreProductRange="Eden"    
WhatMoreProductSubRange="EDEN 46cmTROUGH" WhatMoreWebCategory="Garden Products" />
<Row Code="1005" Name="EDEN TROUGH  Terracotta blue" WhatMoreProductRange="Eden"    
WhatMoreProductSubRange="EDEN 46cmTROUGH" WhatMoreWebCategory="Garden Products" />
</Rows> 
```

此代码输出属于该 WhatMoreProductSubRange 的所有产品，但我不想在我的产品列表中重复产品（在 A 部分中提到）（在 B 部分中提到）。我不知道如何避免重复，因为我是新手到 xml 解析。请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T09:51:58.113

排序。虽然效率较低，但这个工作正常。

```
<?
$list = groupBy(file_get_contents('XML/output.xml'), "WhatMoreProductSubRange");
$id=urldecode($this->uri->segment(4));
$id2=$this->uri->segment(3);
foreach ($list[$id] as $product) 
{
if ($id2==$product->Code)
{
$subcat=$product->WhatMoreProductSubRange;
 ?>
 <h1><?=$product->Name?></h1>
 <?
}
}     
?>
<?
 $list = groupBy(file_get_contents('XML/output.xml'), "WhatMoreProductSubRange");
 $id=urldecode($this->uri->segment(4));
 $id2=$this->uri->segment(3);
 foreach ($list[$id] as $product ) 
 {
   if ($id2!=$product->Code)
   {
    $subcat2=$product->WhatMoreProductSubRange;
 ?>
      <h2><?=$product->Name?></h2>
 <?
   }
  } 
  ?> 
```

# python - 在 Django 中将值传递给 Bootstrap 模式

> ID：13168606
> 
> 赞同：6
> 
> 时间：2012-10-31T22:53:50.387
> 
> 标签：python, django, html, twitter-bootstrap

每次用户想要删除数据时，我都有一个很好的模式显示删除确认对话框。问题是我的许多视图在模板中呈现元素列表，每个元素都有其详细信息以及一个小的删除红色按钮。当然，在 django 中，视图会将元素列表传递给模板，例如客户端列表，它们会呈现在如下表中：

```
<table class="table table-striped">  
    <thead>  
      <tr>
        <th>Email</th>
      </tr>  
    </thead>  
    <tbody>
      {% for client in clientes %}
        <tr>  
          <td>{{ client.email }}</td>
          <td>
            <div class="btn-group">
              <!-- Delete button -->
              <a href="#myModal" class="btn btn-danger btn-mini" title="Eliminar">
                <i class="icon-trash icon-white"></i></a>
            </div>
          </td>
        </tr> 
      {% endfor %}
    </tbody> 
```

每次用户按下删除按钮以显示并确认他正在删除一些数据时，我都希望有一个引导模式。现在，我设法使模态出现并删除用户，但不是正确的用户，模态以某种方式仅获取或尝试删除列表中的第一个用户。您可以在以下链接中使用模态检查我的整个模板：[FULL HTML](http://pastie.org/5145275)

最后，我的问题在某种程度上与将正确的 {{ client }} 传递给模态而不是客户端列表中的第一个有关，我认为这是因为 for 上第一个声明的模态然后确实不再声明它。

例如，我在表中有 3 个客户：

```
client1@something.com         detele-button
client2@something.com         detele-button
client3@something.com         detele-button 
```

无论我按下什么客户端删除按钮，它总是显示带有 client1 数据的模式，如果按下确认删除，它实际上会删除它。

谢谢你。

edit1：href 不行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-05T17:07:32.287

找到了答案，实际上要感谢 keithxm23。

检查生成的 HTML 帮助我得到了正确的结果。实际上每个模态都是正确生成的，问题是每个模态的 id 属性都设置为相同，在这种情况下`id="myModal"`，删除按钮具有`href="#myModal"`. 解决方案是将 modal id 属性设置为整个文档中的唯一值，我设法通过设置 modal`id="{{client.pk}}"`和 button来做到这一点`href="#{{client.pk}}"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-28T04:34:02.377

@**普拉奇夏尔马**

这可能是因为您使用的是整数，在 css 中，标识符不能以数字、两个连字符或一个连字符后跟一个数字开头。你可以试试`id="letter or word{{client.pk}}"` `href="#letter or word{{client.pk}}"`

# javascript - 如何将事件侦听器添加到我的 javascript 函数

> ID：13168616
> 
> 赞同：0
> 
> 时间：2012-10-31T22:55:15.410
> 
> 标签：javascript, jquery, ajax, animation, addeventlistener

我的页面上有一个动画，将 div 滑入屏幕，将屏幕中的当前 div 推出。在制作动画时，会发送一个 ajax 请求来抓取一个页面并将其放入 div 中。

出于某种原因，我的代码在 Firefox 上运行良好，但在使用 Chrome 时会卡住。

这是页面：（尝试单击左眼）

[http://www.uvm.edu/~areid/homesite/index.html](http://www.uvm.edu/~areid/homesite/index.html)

我想要做的（根据@jfriend00 的建议）是在 slideOut() 函数中添加一个事件监听器，以便在 slideOut() 完成之前不会启动 ajax 请求。将 ajax 调用和动画分开应该可以减少代码的负载，从而防止 Chrome 像现在这样卡顿。

这是我的滑出功能：

JAVASCRIPT：

```
 function SlideOut(element) {
                var opened = $(".opened"),
                    div = $("#" + element),
                    content = $("#content");
                opened.removeClass("opened");
                div.addClass("opened");
                content.removeClass().addClass(element);
            } 
```

CSS：

```
 #content {
        margin: 0 auto;
        position:relative;
        left:0;
        -webkit-transition: all 0.9s ease;
        -moz-transition: all 0.9s ease;
        -o-transition: all 0.9s ease;
        transition: all 0.9s ease;
    }
    #content.right {
        left:-1150px;
    }
    #content.left {
        left:1150px;
    }
    #content.bottom {
        top:-300px;
    }
    #content.top {
        top:1100px;
    }

    #content div {
        cursor:pointer;
    #left {
        padding:0;
        margin:0;
        position:absolute;
        top:0;
        left:-1800px;
        height:100%;
        width:1750px;
        -webkit-transition: all 0.9s ease;
        -moz-transition: all 0.9s ease;
        -o-transition: all 0.9s ease;
        transition: all 0.9s ease;
        background-color: #1a82f7;
        /* Safari 4-5, Chrome 1-9 */
        background: -webkit-gradient(linear, left top, right top, from(#C6421F), to(#2F2727));
        /* Safari 5.1, Chrome 10+ */
        background: -webkit-linear-gradient(right, #C6421F, black);
        /* Firefox 3.6+ */
        background: -moz-linear-gradient(right, #C6421F, black);
        /* IE 10 */
        background: -ms-linear-gradient(right, #C6421F, black);
        /* Opera 11.10+ */
        background: -o-linear-gradient(right, #C6421F, black);
    }

    #left.opened {
        left:0;
    }
    #left-content{
        margin-left:70px;
        position:relative;
        -webkit-transition: all 0.9s ease;
        -moz-transition: all 0.9s ease;
        -o-transition: all 0.9s ease;
        transition: all 0.9s ease;
    } 
```

HTML：

```
<html>
<body>
<div id="fullContainer">

    <div id="right">
        <div class="return-right">
            <p>click me</p>
        </div>
        <div id="resume">
        </div>

    </div>
    <div id="left">

            <div class="return-left">
        <p>click me</p>
        </div>
            <div id="left-content">
        </div>

    </div>
    <div id="top">
            <div class="return">
        <p>click me</p>
        </div>

    </div>
    <div id="bottom">
            <div class="return">
        <p>click me</p>
        </div>

    </div>
</div>
<div id="centerContainer">
    <div id="relativeContainer">
        <div id="content" class="center">
  </div>
    </div>
</div>
</body>
</html> 
```

最好只在实际站点上使用 firebug。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:03:49.853

您将希望使用 transitionend 事件来跟踪#left 的转换何时完成。您必须检查我在下面完成的浏览器前缀。之后我们就可以使用指定的前缀进行监听了。一旦被解雇，您就可以进行 ajax 调用。

**Javascript：**

```
var myDiv, transition;
myDiv = document.getElementById('left');

if('ontransitionend' in window) {
  // Firefox
  transition = 'transitionend';
} else if('onwebkittransitionend' in window) {
  // Chrome/Saf (+ Mobile Saf)/Android
  transition = 'webkitTransitionEnd';
} else if('onotransitionend' in myDiv || navigator.appName == 'Opera') {
  // Opera
  // As of Opera 10.61, there is no "onotransitionend" property added to DOM elements,
  // so it will always use the navigator.appName fallback
  transition = 'oTransitionEnd';
} else {
  // IE - not implemented (even in IE9) :(
  transition = false;
}

myDiv.addEventListener(transition, function(){
  //make ajax call here.
}, false); 
```

# assembly - 调用函数后确定ARM堆栈上使用的绝对字节数？

> ID：13168620
> 
> 赞同：0
> 
> 时间：2012-10-31T22:55:32.600
> 
> 标签：assembly, stack, arm, depth, raspberry-pi

我正在尝试使我的 c 代码免受 Raspberry Pi 上的堆栈溢出的影响。我是这方面的初学者，所以请耐心等待。有人告诉我，确定调用函数使用的字节量的一种方法是通过用已知值（例如 0xff）填充堆栈空间来初始化堆栈空间。然后运行该函数，然后向后搜索以查看有多少堆栈从已知值更改。通过获取原始堆栈深度和第一个未更改值之前的堆栈深度，我可以确定该函数使用的堆栈数量。对我来说听起来很合理。

我的问题是这个组装的东西让我很困惑。我一直在阅读我可以使用 asm() 将 ARM 汇编代码嵌入到我的 c 代码中，但我不确定如何初始化堆栈内存，然后返回并检查它。有没有我可以查看的资源会有所帮助？我对汇编知之甚少，以至于我什至不知道如何形成一个很好的搜索词。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T00:40:18.540

这在 asm 中应该很容易做到，前提是您很清楚可以安全地走多远（您甚至可以将其作为参数传递）

```
.globl fill_stack
fill_stack:
  mov r2,sp
  mvn r3,#0
fsloop:
  stmdb r2!,{r3}
  subs r0,r0,#1
  bne fsloop
  bx lr 
```

上面的C原型是

```
void fill_stack ( unsigned int ); 
```

其中参数是要填充的 32 位字数。

将 asm 放在某个文件中，比如 fill_stack.s 并将该文件与您的 c 程序一起添加到您的编译器命令行中（或者如果您不以这种方式使用 c 编译器，则将其单独组装到对象和链接中）。内联汇编更难，不值得努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:07:53.703

我认为您不需要在汇编中执行此操作：您可以在 C 中执行此操作

```
void stack_init(unsigned int size)
{
        int i;
        unsigned char mem[size];

        for (i = 0; i < size; i++)
                mem[i] = 0xAA; /* Best not to use 0 or all ones */
}

unsigned int stack_check(unsigned int max)
{
        int i;
        unsigned char mem[max];

        for (i = max - 1; i >= 0; --i) {
                if (mem[i] != 0xAA)
                        break;
        }
        return i + sizeof(int);
} 
```

# django - Django 测试在无效关键字参数上失败

> ID：13168622
> 
> 赞同：1
> 
> 时间：2012-10-31T22:55:40.717
> 
> 标签：django, django-models, django-testing

我有一个这样的models.py：

```
from django.db import models
from django.contrib.auth.models import User
from datetime import datetime

class UserProfile(models.Model):
    user = models.OneToOneField(User)

    def __unicode__(self):
        return self.user.username

class Project(models.Model):
    user = models.ForeignKey(UserProfile)
    created = models.DateTimeField(auto_now_add=True)
    updated = models.DateTimeField(auto_now=True)
    product = models.ForeignKey('tool.product')
    module = models.ForeignKey('tool.module')
    model = models.ForeignKey('tool.model')
    zipcode = models.IntegerField(max_length=5)

    def __unicode__(self):
        return unicode(self.id) 
```

还有我的tests.py：

```
from django.test import TestCase, Client
# --- import app models
from django.contrib.auth.models import User
from tool.models import Module, Model, Product
from user_profile.models import Project, UserProfile

# --- unit tests --- #
class UserProjectTests(TestCase):

    fixtures = ['admin_user.json']

    def setUp(self):
        self.product1 = Product.objects.create(
            name='bar',
        )
        self.module1 = Module.objects.create(
            name='foo',
            enable=True
        )
        self.model1 = Model.objects.create(
            module=self.module1,
            name='baz',
            enable=True
        )
        self.user1 = User.objects.get(pk=1)

    ...

    def test_can_create_project(self):
        self.project1 = Model.objects.create(
            user=self.user1,
            product=self.product1,
            module=self.module1,
            model=self.model1,
            zipcode=90210
        )

        self.assertEquals(self.project1.zipcode, 90210) 
```

但我得到一个`TypeError: 'product' is an invalid keyword argument for this function`错误。

我不确定是什么失败了，但我猜测与 FK 关系有关......

任何帮助将非常感激。

**编辑：** 完整追溯：

```
 ERROR: test_can_create_project (user_profile.tests.UserProjectTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/sam/Dropbox/django-projects/unirac/user_profile/tests.py", line 52, in test_can_create_project
    zipcode=90210
  File "/home/sam/.envs/unirac/local/lib/python2.7/site-packages/django/db/models/manager.py", line 137, in create
    return self.get_query_set().create(**kwargs)
  File "/home/sam/.envs/unirac/local/lib/python2.7/site-packages/django/db/models/query.py", line 375, in create
    obj = self.model(**kwargs)
  File "/home/sam/.envs/unirac/local/lib/python2.7/site-packages/django/db/models/base.py", line 367, in __init__
    raise TypeError("'%s' is an invalid keyword argument for this function" % kwargs.keys()[0])
TypeError: 'product' is an invalid keyword argument for this function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:58:06.283

`Model.objects.create(`...应该是`Project.objects.create(`

在：

```
self.project1 = Model.objects.create(
    user=self.user1,
    product=self.product1,
    module=self.module1,
    model=self.model1,
    zipcode=90210
) 
```

* * *

在旁注中，命名你的,`Model`似乎暗示着，是*一个坏主意*。`Model``from tool.models import Module, Model, Product`

 ** * *

另一方面，回溯通常提供关于错误发生位置的*非常有用的信息。*在这里，您可以看到回溯表明错误发生在：

```
File "/home/sam/Dropbox/django-projects/unirac/user_profile/tests.py", line 52, in test_can_create_project 
```

在跳转到库代码之前，您可以合理地期望它不会出错。*

# cuda - CUDA 未指定的启动失败错误

> ID：13168624
> 
> 赞同：0
> 
> 时间：2012-10-31T22:56:08.017
> 
> 标签：cuda

我有以下代码[http://pastebin.com/vLeD1GJm](http://pastebin.com/vLeD1GJm)工作得很好，但如果我增加：

```
#define GPU_MAX_PW 100000000 
```

到：

```
#define GPU_MAX_PW 1000000000 
```

然后我收到：

```
frederico@zeus:~/Dropbox/coisas/projetos/delta_cuda$ optirun ./a
block size = 97657 grid 48828 grid 13951

unspecified launch failure in a.cu at line 447.. err number 4 
```

我在具有 2GB 内存的 GTX 675M 上运行它。GPU_MAX_PW 的第二个定义大约有 1000000000×2÷1024÷1024 = 1907 MB，所以我没有内存不足。由于我只分配更多内存，可能是什么问题？也许网格和块配置变得不可能？

请注意，错误指向此行：

```
HANDLE_ERROR(cudaMemcpy(gwords, gpuHashes, sizeof(unsigned short) * GPU_MAX_PW, cudaMemcpyDeviceToHost)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T03:02:59.740

首先，您的尺码列出不正确。该程序适用于 10,000,000 而不是 100,000,000（而您说它适用于 100,000,000 而不是 1,000,000,000）。所以内存大小不是问题，你的计算是基于错误的数字。

calculate_grid_parameters 搞砸了。此函数的目标是根据 GPU_MAX_PW 指定需要的线程总数和每个块 1024 个线程（硬编码）来确定需要多少块以及网格大小。打印出块大小=网格...网格...的行实际上有问题的线索。对于 100,000,000 的 GPU_MAX_PW，此函数正确计算需要 100,000,000/1024 = 97657 个块。但是，网格尺寸计算不正确。网格尺寸 grid.x * grid.y 应该等于所需的块总数（大约）。但是这个函数决定它需要 48828 的 grid.x 和 13951 的 grid.y。如果我将这两个相乘，我得到 681,199,428，这比所需的总块数 97657 大得多。现在，如果我启动一个请求的网格尺寸为 48828 (x) 和 13951 (y) 的内核，并且每个块请求 1024 个线程，我在该内核启动中请求了 697,548,214,272 个总线程。首先，这不是你的意图，其次，虽然目前我不能确切地说出为什么，这显然是线程太多了。可以说这个整体网格请求超过了机器的某些资源限制。

请注意，如果您将 GPU_MAX_PW 从 100,000,000 降至 10,000,000，则网格计算变得“合理”，我得到：

```
block size = 9766 grid 9766 grid 1 
```

并且没有发射失败。

# php - 是否值得缓存简单的 MySQL 结果

> ID：13168626
> 
> 赞同：2
> 
> 时间：2012-10-31T22:56:23.633
> 
> 标签：php, mysql, caching, apc

我有一个 PHP 脚本，它在 MySQL 数据库上运行非常简单的查询（每页最多 25 次）。是否值得缓存结果（例如使用 APC），或者性能差异可能可以忽略不计？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:03:03.740

缓存几乎总是值得的。从 APC 的内存用户缓存中提取它与建立数据库连接并运行查询是一个巨大的差异——尤其是如果您在一个页面上执行 25 个查询！

好处将复合：

1.  从内存中提取，您将通过减少开销来更快地提供请求
2.  您将释放数据库连接
3.  您将更快地释放 apache 进程
4.  所有这些都将帮助服务器更快地请求请求......

# vb.net - 使用 VB.NET 从 MySql 表中读取值

> ID：13168630
> 
> 赞同：1
> 
> 时间：2012-10-31T22:56:54.133
> 
> 标签：vb.net

我在尝试使用 VB.NET 从 MySQL 数据库中读取数据时遇到问题，我收到的错误消息是“ArgumentExcpetion 未处理”

此外，读数应返回“F”，因为这是分配在桌子上特定位置的值。

```
Imports MySql.Data.MySqlClient
Public Class Form1
    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Application.Exit()
    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim query As String = "SELECT DO FROM klein WHERE COMMAND='DELETE'"
        Dim connStr As String = "server=" & TextBox1.Text & ";" _
            & "user id=" & TextBox2.Text & ";" _
            & "password=" & TextBox3.Text & ";" _
            & "database=hidro201_liberato"
        Dim connection As New MySqlConnection(connStr)
        Dim cmd As New MySqlCommand(query, connection)
        connection.Open()
        Dim reader As MySqlDataReader
        reader = cmd.ExecuteReader()
        While reader.Read()
            TextBox4.Text = (reader.GetChar(1))   '<- **problem is here**
        End While
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:01:06.057

字段索引从零开始。

```
TextBox4.Text = (reader.GetChar(0)) 
```

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getchar.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getchar.aspx)

参数 i：“从零开始的列序号。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:01:34.810

您的查询中只有一列，该列的索引应为零

```
TextBox4.Text = (reader.GetChar(0)) 
```

[这适用于 SqlServer](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getchar.aspx)，但规则与 MySqlDataReader 相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T11:02:01.293

TextBox4.Text = (reader.GetChar("获取值的列名")) 万事如意

# java - 当我拖动它时，按钮从 JToolbar 中消失

> ID：13168631
> 
> 赞同：-1
> 
> 时间：2012-10-31T22:56:58.003
> 
> 标签：java, swing, jtoolbar

我的 JToolBar 有问题。它包含许多按钮

![纽扣](../Images/4fd779ccd3dc54e6759db3822059beb3.png)

问题是当我拖动工具栏时，按钮消失了，它的宽度是一个常数“126 pt”，我无法改变尺寸。

![问题](../Images/f69550a4b42807636143bfd6cf36cc4c.png)

拖动时如何更改尺寸“或调整大小”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T12:58:13.713

Window that appears when toolbar is being dragged takes its size from JToolbar preferred size. It seems that you have hardcoded its size or you have some incorrect layout that gives a wrong preferred width.

Anyway, i cannot say anything more specififc without seeing the code that presents this problem.

# android - Android：如何写入 SQL 数据库

> ID：13168638
> 
> 赞同：1
> 
> 时间：2012-10-31T22:57:40.250
> 
> 标签：android, sqlite, button

我一直在尝试遵循 newBoston 教程，并在单击按钮将数据写入数据库时​​发现自己遇到运行时错误。LogCat 显示“在活动中找不到方法 addModuleButton(View)。

有什么建议么？

添加模块活动

```
 public class AddCourse extends Activity implements OnClickListener {

        Button sqlAddModule;
        EditText sqlModuleCode, sqlModuleName, sqlModuleType, sqlModuleDay, 
        sqlModuleStart, sqlModuleEnd, sqlModuleLocation, sqlModuleComments;

         @Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.add_course);

                sqlAddModule= (Button)findViewById(R.id.addToDatabase);
                sqlModuleCode = (EditText)findViewById(R.id.labelEditModuleCode);
                sqlModuleName = (EditText)findViewById(R.id.labelEditModuleFull);
                sqlModuleType = (EditText)findViewById(R.id.labelCourseType);
                sqlModuleDay = (EditText)findViewById(R.id.labelDay);
                //sqlModuleStart = (EditText)findViewById(R.id.labelEditModuleCode);
                //sqlModuleEnd = (EditText)findViewById(R.id.labelEditModuleCode);
                sqlModuleLocation = (EditText)findViewById(R.id.labelEditModuleLocation);
                sqlModuleComments = (EditText)findViewById(R.id.labelEditModuleComments);
         }

                public void onClick (View addModuleButton) 
                {
                    boolean didItWork = true;
                    try{
                    String moduleCode = sqlModuleCode.getText().toString();
                    String moduleName = sqlModuleName.getText().toString();
                    String moduleDay = sqlModuleDay.getText().toString();
                    String moduleType = sqlModuleType.getText().toString();
                    String moduleLocation = sqlModuleLocation.getText().toString();
                    String moduleComments = sqlModuleComments.getText().toString();

                    database entry = new database(AddCourse.this);
                    entry.open();
                    entry.createEntry(moduleCode, moduleName,moduleType, moduleDay,moduleLocation, moduleComments);
                    entry.close();

                    }catch(Exception e){
                        didItWork = false;
                    }finally{ if(didItWork){
                        Dialog d = new Dialog(this) ;
                        d.setTitle("BooYa!");
                        TextView tv = new TextView(this);
                        tv.setText("Success");
                        d.setContentView(tv);
                        d.show();
                    }

                    }

                }
} 
```

数据库类

```
public class database {

    public static final String KEY_ROWID = "_id";
    public static final String KEY_MODULECODE = "module_code";
    public static final String KEY_MODULENAME = "module_name";
    public static final String KEY_MODULETYPE = "module_type";
    public static final String KEY_MODULEDAY = "module_day";
    public static final String KEY_MODULESTART = "module_start";
    public static final String KEY_MODULEEND = "module_end";
    public static final String KEY_MODULELOCATION = "module_location";
    public static final String KEY_MODULECOMMENTS = "module_comments";

    private static final String DATABASE_NAME = "module_database";
    private static final String DATABASE_TABLE = "my_modules";
    private static final int DATABASE_VERSION = 1;

    private DbHelper myHelper;
    private final Context myContext;
    private SQLiteDatabase moduleDatabase;

    private static class DbHelper extends SQLiteOpenHelper {

        public DbHelper(Context context){
            super(context, DATABASE_NAME, null, DATABASE_VERSION);

        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                        KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                        KEY_MODULECODE + " TEXT NOT NULL, " +
                        KEY_MODULENAME + " TEXT NOT NULL, " +
                        KEY_MODULETYPE + " TEXT NOT NULL, " +
                        KEY_MODULEDAY + " TEXT NOT NULL, " +
                        //KEY_MODULESTART + " TEXT, " +
                        //KEY_MODULEEND + " TEXT, " +
                        KEY_MODULELOCATION + " TEXT NOT NULL, " +
                        KEY_MODULECOMMENTS + " TEXT NOT NULL,);"
                    );

        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            db.execSQL("DROP TABEL IF EXISTS " + DATABASE_TABLE);
            onCreate(db);

        }

    }

    public database(Context c){
        myContext = c;
    }

    public  database open()throws SQLException{
        myHelper = new DbHelper(myContext);
        moduleDatabase = myHelper.getWritableDatabase();
        return this;
    }

    public void close(){
    myHelper.close();
    }

    public long createEntry(String moduleCode, String moduleName, String moduleType,
            String moduleDay, String moduleLocation, String moduleComments) {
        ContentValues cv = new ContentValues();
        cv.put(KEY_MODULECODE,moduleCode);
        cv.put(KEY_MODULENAME,moduleName);
        cv.put(KEY_MODULETYPE,moduleType);
        cv.put(KEY_MODULEDAY,moduleDay);
        cv.put(KEY_MODULELOCATION,moduleLocation);
        cv.put(KEY_MODULECOMMENTS,moduleComments);
        return moduleDatabase.insert(DATABASE_TABLE,null,cv);
        // TODO Auto-generated method stub

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:03:38.037

> LogCat 显示“在活动中找不到方法 addModuleButton(View)。”

您的按钮似乎使用 XML 属性`android:onClick="addModuleButton"`，所以只需更改此：

```
public void onClick (View addModuleButton) 
```

进入这个：

```
public void addModuleButton (View view) 
```

* * *

从[`onClick`](http://developer.android.com/reference/android/view/View.html#attr_android%3aonClick)文档中：

> 此名称必须对应于只采用一个 View 类型参数的公共方法。例如，如果您指定`android:onClick="sayHello"`，则必须声明`public void sayHello(View v)`上下文的方法（通常是您的 Activity）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T06:35:11.257

数据库类

```
private static class DbHelper extends SQLiteOpenHelper {
           public static final String KEY_ROWID = "_id";
            public static final String KEY_MODULECODE = "module_code";
            public static final String KEY_MODULENAME = "module_name";
            public static final String KEY_MODULETYPE = "module_type";
            public static final String KEY_MODULEDAY = "module_day";
            public static final String KEY_MODULESTART = "module_start";
            public static final String KEY_MODULEEND = "module_end";
            public static final String KEY_MODULELOCATION = "module_location";
            public static final String KEY_MODULECOMMENTS = "module_comments";

    private static final String DATABASE_NAME = "module_database";
    private static final String DATABASE_TABLE = "my_modules";
    private static final int DATABASE_VERSION = 1;

    private DbHelper myHelper;
    private final Context myContext;
    private SQLiteDatabase moduleDatabase;

        public DbHelper(Context context){
            super(context, DATABASE_NAME, null, DATABASE_VERSION);

        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                        KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                        KEY_MODULECODE + " TEXT NOT NULL, " +
                        KEY_MODULENAME + " TEXT NOT NULL, " +
                        KEY_MODULETYPE + " TEXT NOT NULL, " +
                        KEY_MODULEDAY + " TEXT NOT NULL, " +
                        //KEY_MODULESTART + " TEXT, " +
                        //KEY_MODULEEND + " TEXT, " +
                        KEY_MODULELOCATION + " TEXT NOT NULL, " +
                        KEY_MODULECOMMENTS + " TEXT NOT NULL,);"
                    );

        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            db.execSQL("DROP TABEL IF EXISTS " + DATABASE_TABLE);
            onCreate(db);

        }

    }

    public database(Context c){
        myContext = c;
    }

    public  database open()throws SQLException{
        myHelper = new DbHelper(myContext);
        moduleDatabase = myHelper.getWritableDatabase();
        return this;
    }

    public void close(){
    myHelper.close();
    }

    public long createEntry(String moduleCode, String moduleName, String moduleType,
            String moduleDay, String moduleLocation, String moduleComments) {
        ContentValues cv = new ContentValues();
        cv.put(KEY_MODULECODE,moduleCode);
        cv.put(KEY_MODULENAME,moduleName);
        cv.put(KEY_MODULETYPE,moduleType);
        cv.put(KEY_MODULEDAY,moduleDay);
        cv.put(KEY_MODULELOCATION,moduleLocation);
        cv.put(KEY_MODULECOMMENTS,moduleComments);
        return moduleDatabase.insert(DATABASE_TABLE,null,cv);
        // TODO Auto-generated method stub

    } 
```

模块活动

```
DbHelper  myHelper= new DbHelper (this, DATABASENAME, null, VERSION_CODE);
SQLiteDatabase db = myHelper.getWritableDatabase();
ContentValues values = new ContentValues();
values.put("module_code", "XXX");
values.put("module_name", "XXX");
...
db.insert("module_database", "", values); 
```

# java - 如何创建提供自己标记的链接？

> ID：13168639
> 
> 赞同：1
> 
> 时间：2012-10-31T22:57:48.427
> 
> 标签：java, wicket

我正在尝试创建一个链接来隐藏或显示我的页面的一部分。该链接应该是可重复使用的，并根据状态显示两个图像之一。

在我使用链接的每个页面上添加两个子组件有点笨拙，所以我想创建一个行为类似于链接的组件，同时自动添加其内容。

这是链接组件：

```
public class ToggleVisibilityLink extends AjaxFallbackLink<Boolean>
{
  public ToggleVisibilityLink(final String id, final IModel<Boolean> model)
  {
    super(id, model);

    setOutputMarkupId(true);

    add(new Image("collapseImage")
    {
      @Override
      public boolean isVisible()
      {
        return !getModelObject();
      }
    });
    add(new Image("expandImage")
    {
      @Override
      public boolean isVisible()
      {
        return getModelObject();
      }
    });
  }

  @Override
  public void onClick(final AjaxRequestTarget target)
  {
    setModelObject(!getModelObject());
    if (target != null)
    {
      target.add(this);
      send(this.getParent(), Broadcast.EXACT, target);
    }
  }
} 
```

这就是我目前在 HTML 中使用它的方式（这被添加到我使用链接的页面或面板中）：

```
<a href="#" wicket:id="collapseExpandLink" class="collapseExpandLink">
  <wicket:link>
    <img src="collapse.png" wicket:id="collapseImage" class="collapseExpandImage collapse">
  </wicket:link>
  <wicket:link>
    <img src="expand.png" wicket:id="expandImage" class="collapseExpandImage expand">
  </wicket:link>
</a> 
```

以及相应的 Java 调用：

```
add(new ToggleVisibilityLink("collapseExpandLink", new PropertyModel(this, "hidden"))); 
```

但我希望能够跳过链接内的正文，因为必须了解 ToggleVisibilityLink 的内部结构。我尝试了 IMarkupResourceStreamProvider，使用[Wicket 中的动态标记](https://stackoverflow.com/questions/2086732/dynamic-markup-in-wicket)作为起点。通过谷歌搜索，我发现了另一个例子，海报只能在[使用 Panel](http://apache-wicket.1842946.n4.nabble.com/dynamic-markup-and-components-td4366970.html)时让它工作，我也能做到这一点。但我真的很想保留链接而不是将其打包在面板中，因为我无法在标记中设置链接的样式。

我也对封装链接及其正文的替代方案持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T12:52:57.677

我能够使用 setBody() 让它工作，即使我试图严重破坏自己（我有重复的库、我自己的不兼容的 jQuery 库导入和自定义资源版本控制策略）。

这是当前的 ToggleVisibilityLink：

```
public class ToggleVisibilityLink extends AjaxFallbackLink<Boolean>
{
  static {
    Application.get().getSharedResources().add("ToggleVisibilityLinkCollapse",
                                               new MyPackageResource(ToggleVisibilityLink.class, "collapse.png"));
    Application.get().getSharedResources().add("ToggleVisibilityLinkExpand",
                                               new MyPackageResource(ToggleVisibilityLink.class, "expand.png"));
  }

  public ToggleVisibilityLink(final String id, final IModel<Boolean> model)
  {
    super(id, model);

    setOutputMarkupId(true);
    setEscapeModelStrings(false);

    setBody(new BodyModel(model));
  }

  @Override
  public void onClick(final AjaxRequestTarget target)
  {
    setModelObject(!getModelObject());
    if (target != null)
    {
      target.add(this);
      send(this.getParent(), Broadcast.EXACT, target);
    }
  }

  private static final class BodyModel extends AbstractReadOnlyModel<String>
  {
    private final IModel<Boolean> model;

    private BodyModel(final IModel<Boolean> model)
    {
      this.model = model;
    }

    @Override
    public String getObject()
    {
      return this.model.getObject() ?
              "<img src=\""
            + RequestCycle.get().urlFor(new SharedResourceReference("ToggleVisibilityLinkExpand"), null)
            + "\" class=\"collapseExpandImage expand\">"
              :
              "<img src=\""
            + RequestCycle.get().urlFor(new SharedResourceReference("ToggleVisibilityLinkCollapse"), null)
            + "\" class=\"collapseExpandImage collapse\">";
    }
  }
} 
```

（为什么该构造函数受保护？）`MyPackageResource`的简单实现在哪里。`PackageResource`

然后可以简单地将其添加`ToggleVisibilityLink`到容器中：

```
super.add(new ToggleVisibilityLink("collapseExpandLink", new PropertyModel(this, "hidden"))); 
```

和

```
<a wicket:id="collapseExpandLink" class="collapseExpandLink"></a> 
```

并在单击链接时通过事件获得通知。

# php - 用于 php 单元测试的理想存根实用程序

> ID：13168640
> 
> 赞同：3
> 
> 时间：2012-10-31T22:57:51.280
> 
> 标签：php, unit-testing, stub, utilities

我正在寻找用于 php 中单元测试的存根的实用程序。存根必须满足类型提示。必须能够检查带参数的方法调用。必须能够根据指定的参数返回值。你知道任何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:06:46.023

[嘲讽](https://github.com/padraic/mockery)是一个很好的选择：

来自 GitHub [padraic / mockery](https://github.com/padraic/mockery)

> Mockery 是一个简单而灵活的 PHP 模拟对象框架，用于使用 PHPUnit、PHPSpec 或任何其他测试框架进行单元测试。它的核心目标是提供一个带有简洁 API 的测试双重框架，能够使用人类可读的领域特定语言 (DSL) 清楚地定义所有可能的对象操作和交互。作为 PHPUnit 的 phpunit-mock-objects 库的替代品而设计，Mockery 很容易与 PHPUnit 集成，并且可以与 phpunit-mock-objects 一起运行而无需 World 结束。
> 
> Mockery 是在新的 BSD 许可证下发布的。

# python - 广度优先搜索所有路径

> ID：13168641
> 
> 赞同：2
> 
> 时间：2012-10-31T22:57:51.280
> 
> 标签：python, breadth-first-search

首先，感谢您看这个问题。

对于学校作业，我们应该创建一个 BFS 算法并用它来做各种事情。其中一件事是我们应该找到图的根节点和目标节点之间的所有路径。我不知道如何做到这一点，因为我找不到一种方法来跟踪所有备用路线，而不包括副本/循环。

这是我的 BFS 代码：

```
def makePath(predecessors, last):
    return makePath(predecessors, predecessors[last]) + [last] if last else []

def BFS1b(node, goal):
    Q = [node]
    predecessor = {node:None}

    while Q:
        current = Q.pop(0)
        if current[0] == goal:
            return makePath(predecessor, goal)

        for subnode in graph[current[0]][2:]:
            if subnode[0] not in predecessor:
                predecessor[subnode[0]] = current[0]
                Q.append(subnode[0]) 
```

将不胜感激朝着正确方向的概念推动。

tl;dr 如何使用 BFS 查找两个节点之间的所有路径？

这是图表，因为我不确定如何回答 Jeff Marcado 的问题。

```
graph = {   'A':[366, 3,    ('Z',   75 ), ('T', 118), ('S', 140)],
            'Z':[374, 2,    ('A',   75 ), ('O', 71 )],
            'T':[329, 2,    ('A',   118), ('L', 111)],
            'L':[244, 2,    ('T',   111), ('M', 70 )],
            'M':[241, 2,    ('L',   70 ), ('D', 75 )],
            'D':[242, 2,    ('M',   75 ), ('C', 120)],
            'C':[160, 3,    ('D',   120), ('R', 146), ('P', 138)],
            'R':[193, 3,    ('C',   146), ('P', 97 ), ('S', 80 )],
            'S':[253, 4,    ('R',   80 ), ('F', 99 ), ('O', 151), ('A', 140)],
            'O':[380, 2,    ('S',   151), ('Z', 71 )],
            'P':[100, 3,    ('C',   138), ('R', 97 ), ('B', 101)],
            'F':[176, 2,    ('S',   99 ), ('B', 211)],
            'B':[  0, 4,    ('P',   101), ('F', 211), ('G', 90 ), ('U', 85 )],
            'G':[ 77, 1,    ('B',   90 )],
            'U':[ 80, 3,    ('B',   85 ), ('H', 98 ), ('V', 142)],
            'H':[151, 2,    ('U',   98 ), ('E', 86 )],
            'E':[161, 1,    ('H',   86 )],
            'V':[199, 2,    ('U',   142), ('I', 92 )],
            'I':[226, 2,    ('V',   92 ), ('N', 87 )],
            'N':[243, 1,    ('I',   87 )],
            'W':[400, 1,    ('X',   100)],
            'X':[400, 1,    ('W',   100)],} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T09:21:59.147

首先，当您到达目标节点时，您的算法不应返回，否则您将只有一个解决方案。相反，您应该使用列表来存储各种解决方案。

关于算法的核心，请记住，BFS 搜索不会一次探索一条路径，而是全部。因此，您不能只将一个节点存储在队列中，而是存储一条路径。

然后，您只需检查下一个节点是否不在当前路径中以添加它以避免循环。如果当前路径的最后一个节点是目标节点，则将其附加到解决方案列表中。

最后，当队列中不再有不完整路径时（==队列为空），返回解列表。

# c++ - 得到“ISO C++ 禁止声明......”错误。？

> ID：13168643
> 
> 赞同：0
> 
> 时间：2012-10-31T22:58:15.213
> 
> 标签：c++, syntax-error

以下代码只是我的头文件的一部分

```
 double calculateDistance(const wp, &CWaypoint);
    void print(int format);
    bool less(wp_right, const &CWaypoint); 
    CWaypoint add(wp_right, const &CWaypoint); 
```

错误是：

```
g++ -O0 -g3 -Wall -c -fmessage-length=0 -o src\Waypoint.o ..\src\Waypoint.cpp
In file included from ..\src\Waypoint.cpp:15:0:
..\src\/Waypoint.h:45:33: error: 'wp' does not name a type
..\src\/Waypoint.h:45:33: error: ISO C++ forbids declaration of 'parameter' with no type
..\src\/Waypoint.h:47:12: error: 'wp_right' has not been declared
..\src\/Waypoint.h:48:16: error: 'wp_right' has not been declared 
```

PS：我是 C++ 初学者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:02:17.250

我想你的意思是

```
double calculateDistance(const wp, CWaypoint&); 
```

等等

`&`放在类型之后而不是之前。您可能还有其他错误，很难确定。通常我会在函数原型中同时使用类型和变量名，尽管变量名是可选的。

好的，根据下面评论中的代码，您似乎想要

```
class CWaypoint
{
...
    double calculateDistance(const CWaypoint& wp); 
    void print(int format); 
    bool less(const CWaypoint& wp_right);
    CWaypoint add(const CWaypoint& wp_right);
}; 
```

我不确定您为什么将参数名称放在类型之前，或者为什么用逗号分隔参数名称和类型。您已经使用 getAllDataByPointer 和 getAllDataByReference 等其他方法正确完成了它。

规则是逗号分隔方法参数，因此如果您的方法采用单个参数，则不应有逗号，如果采用两个参数，则两个参数声明之间应有一个逗号，依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T00:49:02.083

您的函数声明中有 3 个错误。报告的第一个错误`gcc`是：`wp`没有类型：你说`const wp`，OK`wp`是一个常量，但是等待什么常量？

第二个错误是你放在`&`类型之前，这也是一个错误。

第三，在输入参数之前放置参数名称，所以最后你应该有：

```
double calculateDistance(const CWaypoint& wp);
bool less(const CWaypoint& wp_right); 
```

# ruby-on-rails - 使用 .where 时出现 NoMethodError（渴望获取）

> ID：13168644
> 
> 赞同：0
> 
> 时间：2012-10-31T22:58:16.143
> 
> 标签：ruby-on-rails, ruby, model

我有以下模型类...

```
class Image < ActiveRecord::Base
  attr_accessible :description, :title
  has_many :imageTags
  has_many :tags, :through => :imageTags
end

class Tag < ActiveRecord::Base
  attr_accessible :name
  has_many :imageTags
  has_many :images, :through => :imageTags
end

class ImageTag < ActiveRecord::Base
  attr_accessible :position
  belongs_to :image
  belongs_to :tag
end 
```

当我`find`用于获取 id 为 1 的标签时

```
t = Tag.find(1);
@images = t.images; 
```

但是当我对 做同样的事情时`where`，我得到一个`NoMethodError`, 描述`undefined method 'images'`：

```
t = Tag.where(:name => "foo");
@images = t.images; 
```

我也尝试在语句`.includes(:images)`之前添加`.where`，但这也不起作用。**那么，我怎样才能获得`Images`属于 a 的所有内容`Tag`？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:02:24.117

`.where`返回一个 ActiveRecord::Relation 实例，而不是单个对象。附加一个`.first`以获取（大概）返回的唯一记录：

```
t = Tag.where(name: "foo").first
@images = t.images 
```

# spring - 来自 Session 的空指针异常

> ID：13168648
> 
> 赞同：2
> 
> 时间：2012-10-31T22:58:49.547
> 
> 标签：spring, session, gwt, spring-4-gwt

我[`spring4gwt`](http://code.google.com/p/spring4gwt/)在我的项目中使用。

我有以下登录服务实现：

```
@Service("loginService")
public class LoginServiceImpl extends RemoteServiceServlet implements LoginService {

    @Override
    @Transactional(propagation = Propagation.REQUIRED, rollbackFor = Exception.class)
    public UserBean checkUser(String userName, String password) throws Exception {

        HttpSession httpSession = getThreadLocalRequest().getSession();

    }
} 
```

当我调用`loginService.checkUser("test","test")`（在托管模式下）时，我得到一个 NullPointerException，因为`getThreadLocalRequest()`返回 NULL 而不是实际会话。

我还没有尝试在网络模式下。

为什么我会得到一个空会话？它与spring4gwt有关吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:29:53.290

是的，因为`spring4gwt`，我们需要不同的方法。

我在这里找到了解决方案[http://code.google.com/p/spring4gwt/issues/detail?id=2](http://code.google.com/p/spring4gwt/issues/detail?id=2)：

在 web.xml 中：

```
<filter>
    <filter-name>springRequestFilter</filter-name>
    <filter-class>org.springframework.web.filter.RequestContextFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>springRequestFilter</filter-name>
    <url-pattern>/your-url/*</url-pattern>
</filter-mapping> 
```

而不是：

```
 HttpSession httpSession = getThreadLocalRequest().getSession(); 
```

采用 ：

```
ServletRequestAttributes attr = (ServletRequestAttributes) RequestContextHolder.currentRequestAttributes();
HttpSession httpSession = attr.getRequest().getSession(); 
```

# typescript - 我可以使用什么 TypeScript 模式来强制函数获取属性？

> ID：13168656
> 
> 赞同：3
> 
> 时间：2012-10-31T22:59:19.630
> 
> 标签：typescript

在 JavaScript 中，我可以这样做：

```
function f() {}
f.prop = "property"; 
```

我想在 TypeScript 中使用它，但需要进行类型检查。

**除了类，我可以使用什么 TypeScript 模式来强制函数获取属性？**

我可以使用接口吗？

```
interface functionWithProperty {
    (): any;
    prop: string;
} 
```

这似乎是 TypeScript 中的一个有效接口，但我如何实现这个接口，以便 TypeScript 编译器检查它`prop`的设置？

我看到了[这个例子](https://stackoverflow.com/questions/12766528/build-a-function-object-with-properties-in-typescript)：

```
var f : functionWithProperty = (() => {
    var _f : any = function () { };
    _f.prop = "blah";
    return _f;
}()); 
```

但这不起作用，因为我可以删除`_f.prop = "blah";`所有内容仍然可以编译。我需要执行`prop`设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:26:36.507

我认为您需要在 TypeScript 中接受面向对象并创建一个具有属性和函数的类。

像您在示例中那样组合函数和属性是有效的 JavaScript，但如果您正在跳入 TypeScript，您不妨完全沉浸在其中。

```
class MyClass {
    constructor(public myProp: string) {
    }

    myFunc(): string{
        return this.myProp;
    }
} 
```

**更新**

免责声明：我不建议以这种方式做事——正如我所说，我建议使用 TypeScript 的结构特性以最易读的方式组织你的代码。

但是，如果您想使用类型声明，您可以定义函数的类型：

```
var f: { (): void; prop: string; } = (() => {
    var _f : any = function () { 
        alert(_f.prop);
    };
    _f.prop = "blah";
    return _f;
}());

f(); 
```

这允许调用者`f`获得自动完成和类型检查，但不会导致内容`f`被检查以确保它符合 - 因为你在这个阶段是“幕后” - 所以你可以写这个......

```
var f: { (): void; prop: string; } = (() => {
    var _f : any = undefined;
    return _f;
}());

f(); 
```

如果您想对定义进行类型检查`f`以及调用`f`检查，则需要查看类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-29T21:20:51.170

您可以通过利用[声明合并](http://www.typescriptlang.org/Handbook#declaration-merging)和[结构类型来](http://www.typescriptlang.org/Handbook#interfaces)干净地管理它并使用完整的类型信息！

```
interface functionWithProperty {
    (): any;
    prop: string;
}

function MyCoolFunc() {
    return "yay";
}

module MyCoolFunc {
    export var prop: string = "wow";
}

// this will compile without errors, MyCoolFunc implements the
// functionWithProperty interface (structurally)
let x: functionWithProperty = MyCoolFunc;

console.log(x.prop, x());
console.log(MyCoolFunc.prop, MyCoolFunc());

// this would result in a compiler error
// let y: functionWithProperty = console.log; 
```

编译后的[javascript](http://www.typescriptlang.org/Playground#src=%0D%0Ainterface%20functionWithProperty%20%7B%0D%0A%20%20%20%20%28%29%3A%20any%3B%0D%0A%20%20%20%20prop%3A%20string%3B%0D%0A%7D%0D%0A%0D%0A%0D%0Afunction%20MyCoolFunc%28%29%20%7B%0D%0A%20%20%20%20return%20%22yay%22%3B%0D%0A%7D%0D%0A%0D%0Amodule%20MyCoolFunc%20%7B%0D%0A%20%20%20%20export%20var%20prop%3A%20string%20%3D%20%22wow%22%3B%0D%0A%7D%0D%0A%0D%0A%2F%2F%20this%20will%20compile%20without%20errors%2C%20MyCoolFunc%20implements%20the%0D%0A%2F%2F%20functionWithProperty%20interface%20%28structurally%29%0D%0Alet%20x%3A%20functionWithProperty%20%3D%20MyCoolFunc%3B%0D%0A%0D%0Aconsole.log%28x.prop%2C%20x%28%29%29%3B%0D%0Aconsole.log%28MyCoolFunc.prop%2C%20MyCoolFunc%28%29%29%3B%0D%0A%0D%0A%2F%2F%20this%20would%20result%20in%20a%20compiler%20error%0D%0A%2F%2F%20let%20y%3A%20functionWithProperty%20%3D%20console.log%3B)看起来很像您在问题中给出的示例，但 TypeScript 编译器会确切地知道发生了什么！基本上，MyCoolFunc 的模块声明被添加到函数声明中，从而产生一个具有属性的函数。

如果你想在编译时断言 MyCoolFunc 正确地实现了 functionWithProperty，你可以在你的模块中有一个未导出的变量声明，就像上面例子中的那样。

# javascript - 如何按图像名称按降序对 Div 内容进行排序？

> ID：13168657
> 
> 赞同：1
> 
> 时间：2012-10-31T22:59:29.690
> 
> 标签：javascript, html

我想根据图像名称按 DESCENDING 顺序对 div 进行排序。

**从此改变：**

```
<div id="sort-this-div">
<p><img src="image/1.jpg"/></p>
<p><img src="image/3.jpg"/></p>
<p><img src="image/4.jpg"/></p>
<p><img src="image/2.jpg"/></p>
</div> 
```

**至此**

```
<div id="sort-this-div">
<p><img src="image/4.jpg"/></p>
<p><img src="image/3.jpg"/></p>
<p><img src="image/2.jpg"/></p>
<p><img src="image/1.jpg"/></p>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:14:41.693

这是一种使用纯 JavaScript 的方法。[**在这里查看。**](http://jsfiddle.net/mLUd7/6/)

```
var sort = document.getElementById('sort-this-div');
var imgs = sort.getElementsByTagName('img');

var i, img, sorted = [];
for(i = 0; (img = imgs[i]); i++){
    sorted.push(img.getAttribute('src'));
}
sorted = sorted.sort(function(a, b){
    return +b.match(/\/(\d+?)\.jpg/)[1] - +a.match(/\/(\d+?)\.jpg/)[1];
});

for(i = 0; (img = imgs[i]); i++){
    img.src = sorted[i];
}​ 
```

这是做什么的，它将图像的所有 src 路径复制到`sorted`变量中，对它们进行排序，然后使用新的排序顺序更新图像的所有 src 路径。

**更新**

添加自定义排序功能以解决@EugeneXa 提出的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:24:01.740

**HTML：**

```
<div id="sort-this-div">
    <p><img src="image/1.jpg"/></p>
    <p><img src="image/3.jpg"/></p>
    <p><img src="image/4.jpg"/></p>
    <p><img src="image/2.jpg"/></p>
</div>​ 
```

**JavaScript：**

```
/* as option:
function sort(container) {
    var images = [],
        paragraphs = container.getElementsByTagName('p');        
    while(!!paragraphs.length) {
        var p = paragraphs[0];
        images.push(p.getElementsByTagName('img')[0].getAttribute('src'));
        container.removeChild(p);
    }
    images = images.sort();
    console.log(images);
    for(var i = images.length; i-- > 0;) {
        var p = document.createElement('p'),
            img = document.createElement('img');
            img.src = images[i];
            p.appendChild(img);
        container.appendChild(p);
    }
}*/

function sort(container) {
    var images = [],
        imageSources = [],
        paragraphs = container.getElementsByTagName('p');        
    for(var i = paragraphs.length; i-- > 0;) {
        var img = paragraphs[i].getElementsByTagName('img')[0],
            src = img.getAttribute('src');
        images.push(img);
        imageSources.push(src);
    }
    imageSources = imageSources.sort();
    console.log(imageSources);
    for(var i = imageSources.length; i-- > 0;) {
        images[i].src = imageSources[i];
    }
}

var container = document.getElementById('sort-this-div');
sort(container); 
```

​</p>

[小提琴](http://jsfiddle.net/f0t0n/jWmXT/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:11:54.597

您可以使用 jquery 的排序插件[http://qd9.co.uk/projects/jQuery-Plugins/sort/demo.html](http://qd9.co.uk/projects/jQuery-Plugins/sort/demo.html)

小提琴 - [http://jsfiddle.net/tariqulazam/PuUn5/](http://jsfiddle.net/tariqulazam/PuUn5/)

```
$(document).ready(function(){
    $("p img").sort(function(a, b){
        return $(a).attr('src') > $(b).attr('src') ? -1 : 1;
    });
});​ 
```

# php - 返回 SQL 查询结果，即使未找到完全匹配

> ID：13168663
> 
> 赞同：2
> 
> 时间：2012-10-31T23:00:25.973
> 
> 标签：php, sql

我希望这个问题不是多余的。我想要完成的是让用户在页面上选择一堆复选框，如果没有匹配的行，则返回最接近的匹配记录。例如：

一个人检查 [x]Apples [x]Oranges [x]Pears [x]Bananas

但是表格看起来像这样：

```
Apples     Oranges      Pears     Bananas
 1             1           1        null
 1             1         null       1
 1             1         null       null 
```

（很明显，我在这里错过了 id 列，但你明白我的意思。）所以，期望的结果是让这三行仍然按照大多数匹配的顺序返回，几​​乎是它们现在的顺序。我只是不确定采取此类事情的最佳方法是什么。我考虑过全文搜索，即 levenshtein 函数，但我真的很喜欢返回完全匹配（如果存在）的想法。如果不需要，您无需详细说明代码。我只是希望被送到正确的方向。我见过其他类似的问题，但我仍然不确定该走哪条路。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:05:02.687

编写一个查询，将匹配的列数相加，并按此总数对行进行排序。例如

```
SELECT *
FROM mytable
ORDER BY COALESCE(Apples, 0) = $apples + COALESCE(Oranges, 0) = $oranges + ... DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:47:49.083

按分数排序很容易...

```
SELECT fb.ID, fb.Apples, fb.Oranges, fb.Pears, fb.Bananas
FROM FruitBasket fb
ORDER BY
  CASE WHEN @Apples = fb.Apples THEN 1 ELSE 0 END
  + CASE WHEN @Oranges = fb.Oranges THEN 1 ELSE 0 END
  + CASE WHEN @Pears = fb.Pears THEN 1 ELSE 0 END
  + CASE WHEN @Bananas = fb.Bananas THEN 1 ELSE 0 END
  DESC, ID 
```

但是，这会导致表扫描（即使使用 TOP）。最后一条记录可能比目前找到的记录更匹配，因此必须读取每条记录。

* * *

你可以考虑一个标签系统，像[这样](https://stackoverflow.com/questions/163887/sql-query-simulating-an-and-over-several-rows-instead-of-sub-querying#163907)

```
Content --< ContentTag >-- Tag 
```

将以这种方式查询：

```
SELECT ContentID
FROM ContentTag
WHERE TagID in (334, 338, 342)
GROUP BY ContentID
ORDER BY COUNT(DISTINCT TagID) desc 
```

此查询将使用 ContentTag.TagId 上的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:07:46.583

这相当简单，但您可以只使用`IFNULL()`（MySQL 或您的数据库的等价物）返回匹配的总和并在您的`ORDER BY`

```
// columns and weighting score
$types = array("oranges"=>1, "apples"=>1, "bananas"=>1, "pears"=>1);
$where = array();
// loop through the columns
foreach ($types as $key=>&$weight){
    // if there is a match in $_REQUEST at it to $where and increase the weight
    if (isset($_REQUEST[$key])){
        $where[] = $key . " = 1";
        $weight = 2;
    }
}
// build the WHERE clause
$where_str = (count($where)>0)? "WHERE " . implode(" OR ", $where) : "";

// build the SQL - non-null matches from the WHERE will be weighted higher
$sql = "SELECT apples, oranges, pears, bananas, ";
foreach ($types as $key=>$weight){
    $sql .= "IFNULL({$key}, 0, {$weight}) + ";
} 
$sql .= "0 AS score FROM `table` {$where_str} ORDER BY score DESC"; 
```

假设选择“橙子”和“苹果”，您的 SQL 将是：

```
SELECT apples, oranges, pears, bananas, 
IFNULL(apples, 0, 2) + IFNULL(oranges, 0, 2) + IFNULL(pears, 0, 1) + IFNULL(bananas, 0, 1) + 0 AS score 
FROM `table` 
WHERE oranges = 1 OR apples = 1 
ORDER BY score DESC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T23:42:35.603

按复选框/数据匹配的总和降序排列

```
SELECT * FROM table
ORDER BY (COALESE(Apple,0) * @apple) + (COALESE(Orange,0) * @orange) ..... DESC 
```

其中@apple / @orange 代表用户选择：1 = 选中，0 = 未选中

# google-app-engine - ä、ö、ü 等特殊字符

> ID：13168664
> 
> 赞同：0
> 
> 时间：2012-10-31T23:00:26.773
> 
> 标签：google-app-engine, utf-8, special-characters

我正在尝试让特殊字符（如德语变音符号（ä、ö、ü）与 . 一起使用`Google App Engine`，但遗憾的是它不起作用。Eclipse 文本文件编码设置为`UTF-8`，我用`<meta http-equiv="content-type" content="text/html; charset=UTF-8">`在我`index.html`的，`web.xml`也在用`encoding="utf-8"`。

如果我在本地编译我的项目，字符会正确显示。如果我将它部署到 google apppot，字符显示如下：`��`. 我还检查了浏览器编码，设置为`UTF-8`，我错过了什么？

**编辑** 这是一个在本地工作但不能在线工作的示例：

```
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>ä ö ü</title>
</head>
<body>
    <form name="profile" action="">
        <select name="p" size="1">
            <option value="1">ä</option>
            <option value="2">ö</option>
        </select>
    </form>
</body> 
```

**Edit2** 我可以隔离问题。一开始我使用谷歌频道 api 与客户沟通。在这里，我将令牌写给用户。这就是问题。这是代码：

我想我必须转换为 UTF-8，但是在哪里呢？

```
FileReader reader = new FileReader("index.html");
CharBuffer buffer = CharBuffer.allocate(16384);
reader.read(buffer);
reader.close();

String index = new String(buffer.array());
index = index.replaceAll("\\{\\{ token \\}\\}", token);
index = index.replaceAll("\\{\\{ user \\}\\}", account);

resp.getWriter().write(index); 
```

为什么字符在网上显示不正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T16:30:43.103

FileReader 始终使用平台默认编码。采用

```
InputStreamReader(new FileInputStream("index.html"), "UTF-8") 
```

# python - 带引号的 Python argparse 参数

> ID：13168666
> 
> 赞同：11
> 
> 时间：2012-10-31T23:00:31.127
> 
> 标签：python, argparse, optparse

有什么办法可以告诉 argparse 不要吃引号？

例如，当我给出带引号的参数时，argparse 仅将引号内的内容作为参数。我也想捕获引号（不必在命令行上转义它们。）

```
pbsnodes -x | xmlparse -t "interactive-00" 
```

生产

```
interactive-00 
```

我想

```
"interactive-00" 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-31T23:01:55.387

我认为是壳吃掉了它们，所以蟒蛇实际上永远不会看到它们。在命令行上转义它们可能是您唯一的选择。

如果它是`\"backslash\"`由于某种原因不喜欢你不喜欢的风格，那么这种方式应该可以代替：

```
pbsnodes -x | xmlparse -t '"interactive-00"' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-22T12:31:34.463

命令行由 python 进程本身解析为参数向量。根据 python 的构建方式，这将由某种运行时库完成。对于 Windows 构建，这很可能是 MS Visual C++ 运行时库。有关它如何解析命令行的更多详细信息，请参阅 Visual C++ 文档：[解析 C++ 命令行参数](https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments)。

尤其：

*   由双引号 ("string") 包围的字符串被解释为单个参数，无论其中包含什么空格。带引号的字符串可以嵌入到参数中。

*   前面有反斜杠 (\") 的双引号被解释为文字双引号字符 (")。

如果你想查看未处理的命令行，在 Windows 上你可以这样做：

```
import win32api
print(win32api.GetCommandLine()) 
```

# c++ - 如何为一个函数参数接受多个类？

> ID：13168667
> 
> 赞同：0
> 
> 时间：2012-10-31T23:00:30.347
> 
> 标签：c++

假设我有两个班级，ClassA 和 ClassB。

ClassB 继承了 ClassA，并且有一些额外的函数和变量。

我是否可以制作一个可以接受 ClassA 或 ClassB 作为同一参数的函数，并让我确定使用了哪一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:07:06.130

将函数参数声明为指针或对`ClassA`实例的引用（不要按值传递它，否则输入实例将在运行时被切片）。然后，您可以`dynamic_cast`在需要访问`ClassB`特定功能时使用。例如：

```
class ClassA
{
public:
    int a;

    virtual ~ClassA() {}
    void DoSomething();
};

class ClassB : public ClassA
{
public:
    int b;
    void DoSomethingElse();
};

void func(ClassA *obj)
{
    int a = obj->a;
    obj->DoSomething();

    ClassB *objB = dynamic_cast<ClassB*>(obj);
    if (objB)
    {
        int b = objB->b;
        objB->DoSomethingElse();
    }
}

int main()
{
    ClassA a;
    func(&a);

    ClassB b;
    func(&b);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:02:39.060

是的，您可以通过引用获取参数：

```
void foo(ClassA& x) //or const ClassA 
```

您将能够传递`ClassA`or的两个实例`ClassB`，并使用 RTTI 来确定它实际上是函数内部的类型。

或者，您可以将指针传递给`ClassA`，但在可能的情况下应优先使用引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:23:23.527

这是一个有点间接的想法。该函数`Consumer::accept`同时接受 type`A`和 type的对象`B`，并且特定的行为由*这些*类而不是您的使用者实现。

```
struct Consumer;

struct A
{
    virtual ~A() { }
    virtual int use(Consumer &);
};

struct B : A
{
    virtual int use(Consumer &);
};

struct Consumer
{
    void accept(A & x)
    { 
        int n = x.use(*this);
        do_more_stuff(n);
    }

    void do_more_stuff(int);

    // ...
}; 
```

# android - 在 Tabhost 选项卡上单击显示弹出窗口

> ID：13168676
> 
> 赞同：0
> 
> 时间：2012-10-31T23:01:54.560
> 
> 标签：android, tabs

我需要创建具有三个选项卡的应用程序。第一个选项卡是 MapViewActivity，第二个选项卡是搜索。

```
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_tab);

    tabHost = getTabHost();
    resources = getResources();

    AddTab(resources.getString(R.string.tab_tag1),
            R.drawable.icon_tab1, MapViewActivity.class);

    AddTab(resources.getString(R.string.tab_tag2),
            R.drawable.icon_tab2, MapViewActivity.class);

    AddTab(resources.getString(R.string.tab_tag3), R.drawable.icon_tab3,
            MapViewActivity.class);     
}

private void AddTab(String tabName, int idPhoto, Class className) {
    TabSpec tabspec = tabHost.newTabSpec(tabName);
    tabspec.setIndicator(tabName, getResources().getDrawable(idPhoto));
    Intent intent = new Intent(this, className);
    tabspec.setContent(intent);
    tabHost.addTab(tabspec);
} 
```

但是当有人选择第二个标签（搜索）时，我想在第一个标签内容中显示弹出窗口。是否可以？你有一些例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T05:03:02.957

在你的代码中添加这个

```
getTabWidget().getChildAt(1).setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            tabHost.setCurrentTab(0);
            Toast.makeText(getApplicationContext(), "Clicked", 35).show();
            // Add pop up code here
        }
}); 
```

所以它应该是这样的

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_tab);

    tabHost = getTabHost();
    resources = getResources();

    AddTab(resources.getString(R.string.tab_tag1),
            R.drawable.icon_tab1, MapViewActivity.class);

    AddTab(resources.getString(R.string.tab_tag2),
            R.drawable.icon_tab2, MapViewActivity.class);

    AddTab(resources.getString(R.string.tab_tag3), R.drawable.icon_tab3,
            MapViewActivity.class);
    getTabWidget().getChildAt(1).setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            tabHost.setCurrentTab(0);
            Toast.makeText(getApplicationContext(), "Clicked", 35).show();
            // Add pop up code here
        }
    });
} 
```

编辑2：你可以使用

```
getTabWidget().getChildAt(1).setOnClickListener(this);

OR

getTabWidget().getChildAt(1).setOnClickListener(someListener); 
```

# android - 自定义视图不会缩小布局

> ID：13168678
> 
> 赞同：1
> 
> 时间：2012-10-31T23:01:55.760
> 
> 标签：android, android-layout, android-linearlayout, android-view

我有一个自定义视图，我试图在垂直方向上使用位于屏幕下方的文本视图/按钮组合（卡在水平线性布局中）。目前我的布局如下所示：

```
 <com.company.widgets.MyCustomView
        android:id="@+id/custom"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        android:layout_alignParentTop="true"
        android:layout_weight="0.0" />

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal|center_vertical"
        android:layout_marginTop="10dp"
        android:layout_alignParentBottom="true"
        android:layout_weight="1.0"
        android:orientation="horizontal" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical|left"
            android:layout_marginLeft="15dp"
            android:layout_marginRight="5dp"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textColor="#000000"
            android:text="foobar" />

        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical|right"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="15dp"
            android:text="foobar" />
    </LinearLayout> 
```

在我的自定义视图中，我已经覆盖了 onMeasure() 和 onSizeChanged()。我努力确保我的视图大小不超过它传递的 measureSpec（对于 onMeasure）或宽度/高度值（对于 onSizeChanged）。但是，当我的活动布局时，传递给这两个方法的值表示“屏幕的整个垂直高度”。

因此，我的自定义视图最终使自己尽可能高，而按钮/文本视图使自己“尽可能高”（wrap_content）。当这两个高度超过屏幕的高度时，自定义视图的底部被绘制在按钮/文本视图的*后面。*

我的问题：我应该如何修改布局，以便我的自定义视图的 onMeasure() 和/或 onSizeChanged() 方法传递一个较短的高度值？我希望他们收到一个代表“屏幕高度 - 文本视图/按钮的高度”的值。

注意：如果我更改布局以使 textview/button 位于自定义视图*上方*，则我传递的高度值是正确的（即小于屏幕高度）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:20:46.700

解决了。使外部元素成为 LinearLayout 而不是 Relative 并反转权重。自定义视图的权重应为“1”，包含 TextView 和 Button 的 LinearLayout 的权重应为零。这会导致传递给我的自定义视图的 onMeasure() 的高度值仅是 textview/button 未占用的屏幕部分。

# php - DOMXpath 移除标签

> ID：13168682
> 
> 赞同：3
> 
> 时间：2012-10-31T23:02:15.787
> 
> 标签：php, parsing, domdocument, domxpath

我有这个 HTML 代码：

```
<div class ="lvlone">
    <div class = "lvltwo"> Hello
        <span>World</span>
    </div>
</div> 
```

我这样做：`$res = $xpath->query(//div[@class='lvlone']/div[@class='lvltwo']);`

我在标签`Hello World`中包含了字符串，但我想要它！ 我只想要. 我能做些什么 ？ 谢谢！`<span>`
`Hello`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:15:26.903

正如 TheZ 指出的那样，您可以使用`text()`XPath 中的函数：

```
$nodes = $xpath->query( '//div[@class="lvltwo"]/text()');
echo $nodes->item(0)->nodeValue; // Prints 'Hello' 
```

# ios - iOS 上的网络嗅探器

> ID：13168688
> 
> 赞同：1
> 
> 时间：2012-10-31T23:02:46.400
> 
> 标签：ios, networking, sniffing

我需要将视频流式传输到 iPhone。但是，我还没有播放 H.264 流的自制应用程序。我必须先了解，iPhone 接收第一个数据包/帧有多少延迟。 **任何人都知道如何在 iPhone 上获得像 WireShark 这样的“嗅探器”？有可能吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:10:41.070

您可以将 Fiddler 配置为反向代理并监控来自移动设备的流量。我不知道这是否会完全符合您的要求（我已经很长时间没有这样做了），但我工作的公司有针对各种移动平台的分析产品，这就是我们用来监控他们网络的方法用法。

[http://www.fiddler2.com/Fiddler/help/reverseproxy.asp](http://www.fiddler2.com/Fiddler/help/reverseproxy.asp)

# iphone - 该应用程序需要能够离线工作，以便以后通过 WiFi 或蜂窝连接上传

> ID：13168689
> 
> 赞同：-1
> 
> 时间：2012-10-31T23:02:56.220
> 
> 标签：iphone, ios, ipad, ios5, ios6

我正在开发一个应用程序，我需要将数据上传到服务器，因为如果网络不存在，我需要检查网络连接（wifi/3G），它将存储在某个地方，直到网络可用，一个网络发现它会自动上传到服务器。我对这种情况没有任何概念..谁能告诉我如何工作...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:06:08.317

使用[可达性](https://developer.apple.com/library/ios/#samplecode/Reachability/index.html)框架来检测连接类型。将其包装到某个背景循环中进​​行检查，然后就完成了。

# air - 使用 Starling 和 Air for iOS 查看 iAd 后恢复 Stage3D 上下文

> ID：13168694
> 
> 赞同：0
> 
> 时间：2012-10-31T23:03:45.793
> 
> 标签：air, air-native-extension, starling-framework, iad

我有一个使用 Starling 的应用程序和 iAds 的原生扩展（Milkman Games iAds Extension）

我注意到，当用户单击 iad，与之交互然后返回游戏时，由于 Starling 恢复 Stage3D 上下文，会出现很长的黑屏延迟。

我希望能够在此期间显示某种加载屏幕，但我尝试的一切似乎都不起作用。有没有人建议如何实施这个？甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T17:13:32.913

这只是一个理论，尚未测试，但它应该有效。

听听`Event.ACTIVATE`。这应该在 iAd 关闭时触发。它也被触发了很多次，所以我们需要确保我们检查这个黑屏，为此我们可以简单地在事件处理程序中使用它：

```
private function _onActivateHandler(e:Event):void
{
    if (starling.context.driverInfo.indexOf("Disposed") != -1)
    {
        this.addChild(loadingTextOrBitmapEtcEtc);

        starling.stage3D.addEventListener(Event.CONTEXT3D_CREATE, this._onContext3DCreateHandler);
    }
}

private function _onContext3DCreateHandler(e:Event):void
{
    starling.stage3D.removeEventListener(Event.CONTEXT3D_CREATE, this._onContext3DCreateHandler);

    this.removeChild(loadingTextOrBitmapEtcEtc);
} 
```

# ruby - Rails应用程序中的Ruby方法覆盖

> ID：13168695
> 
> 赞同：0
> 
> 时间：2012-10-31T23:03:45.937
> 
> 标签：ruby, ruby-on-rails-3

我有几个包含相同模块的类，我想在我的代码中的一个位置覆盖模块的方法之一。这该怎么做？

我试过

```
module [Module_name]
  def [method_to_override] 
```

并将其添加到rails的自动加载路径但没有成功

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T11:01:19.877

如果您将模块用作 mixin，则可以在类中重新定义该方法。在类级别定义的方法在调用时将优先。在这种情况下，作为 mixin 的模块只是表现为超类。

如果您将模块用作命名空间，我不确定是否有一种方法可以像您尝试做的那样动态地重新定义代码。也许就地打开命名空间模块并包含该方法的新代码将起作用。我以前没试过这个。

一些[参考资料](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html)

# ruby-on-rails-3 - UnknownAttributeError 使用构建虚拟属性

> ID：13168697
> 
> 赞同：0
> 
> 时间：2012-10-31T23:03:55.050
> 
> 标签：ruby-on-rails-3, forms, associations, nested-attributes, virtual-attribute

我有一个包含虚拟属性的嵌套表单：card_number 和：card_verification。当我尝试在控制器更新操作中使用这些构建时，我得到 ActiveRecord::UnknownAttributeError。

模型有一个简单的 has_one 关系，其中约会 has_one 订单

```
#/models/appointment.rb
class Appointment < ActiveRecord::Base
  has_one :order
  accepts_nested_attributes_for :order

  attr_accessible (...)
end

#/models/order.rb
class Order < ActiveRecord::Base
  belongs_to :appointment

  attr_accessible :email, (...)
  attr_accessor :card_number, :card_verification
end 
```

我正在生成这样的表格：

```
# /views/appointments/edit.html.erb
<%= form_for @appointment do |f| %>
  ...
  <%= f.fields_for @appointment.order do |builder| %>
    <%= builder.label :email %>
    <%= builder.text_field :email %> # works fine on its own
    ...
    <%= f.label :card_number %>
    <%= f.text_field :card_number %>

    <%= f.label :card_verification %>
    <%= f.text_field :card_verification %>
  <% end %>
  ...
<% end %> 
```

并在控制器中构建：

```
# /controllers/appointments_controller.rb
def update
  @appointment = Appointment.find(params[:id])
  @order = @appointment.build_order(params[:appointment]['order']) # This line is failing

  if @appointment.update_attributes(params[:appointment].except('order'))
    # ... Success
  else
    # ... Failure
  end
end 
```

有了这个，`Can't mass-assign protected attributes: card_number, card_verification`当我尝试使用参数提交更新时出现错误：

```
{"utf8"=>"✓",
 "_method"=>"put",
 "authenticity_token"=>"KowchWLNmD9YtPhWhYfrNAOsDfhb7XHW5u4kdZ4MJ4=",
 "appointment"=>{"business_name"=>"Name",
 "contact_method"=>"Phone",
 "contact_id"=>"555-123-4567",
 "order"=>{"email"=>"user@example.com",
 "first_name"=>"John",
 "last_name"=>"Doe",
 "card_number"=>"4111111111111111", # normally [FILTERED]
 "card_verification"=>"123", # normally [FILTERED]
 "card_type"=>"visa",
 "card_expires_on(1i)"=>"2015",
 "card_expires_on(2i)"=>"11",
 "card_expires_on(3i)"=>"1",
 "address_line_1"=>"123 Main St",
 "address_line_2"=>"",
 "city"=>"Anywhere",
 "state"=>"CA",
 "country"=>"USA",
 "postal_code"=>"90210"}},
 "commit"=>"Submit",
 "id"=>"2"} 
```

没有包含在表单中的 :card_number 和 :card_verification 值，一切正常。

有谁知道这里出了什么问题？

**编辑：**

我可以得到这个工作：

```
@order = @appointment.build_order(params[:appointment]['order'].except('card_number', 'card_verification')) 
```

但这似乎有点笨拙。还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T06:31:59.003

错误消息“无法批量分配受保护的属性”是关于批量分配安全性的。您可以通过 without_protection 忽略批量分配检查。

```
@order = @appointment.build_order(params[:appointment]['order'], without_protection: true) 
```

此链接说明什么是批量分配安全性。 [Rails 内部结构：批量分配安全性](https://github.com/oscardelben/words-about-code/blob/master/2012/04/rails-internals-mass-assignment-security.md)

如果要指定大量可分配的属性，请使用 attr_accessible :one, :another 作为模型属性。如果您需要其他非模型属性，请使用 attr_accessor :card_number ，然后使用 attr_accessible :card_number 来声明和公开它。

我看到您在 Order 模型中定义了 card_number 和 card_verfication，但是您使用 form_builder => f 在 html 中定义这两个字段。尝试改用 fields_for 构建器。

# ruby - Ruby 树上的 concatAll

> ID：13168698
> 
> 赞同：0
> 
> 时间：2012-10-31T23:04:00.947
> 
> 标签：ruby, string, tree

我有两个类 Leaf 和 BinaryNode Leaf 包含一个字段，它是一个字符串 BinaryNode 包含两个孩子，它们都是 Leaf 或 BinaryNode

我正在尝试编写一个 concatAll 方法，它将从左到右返回树中所有单词的字符串...

以下是我到目前为止的内容，但它只返回它找到的最后一个字符串，而不是已构建的整个字符串......怎么会？

```
def concatAll
 final = ""

 if @lchild.respond_to?('string')   
   final += @lchild.to_s
 else
   @lchild.concatAll unless @lchild.nil?
 end

 if @rchild.respond_to?('string')   
   final +=  @rchild.to_s
 else
   @rchild.concatAll unless @rchild.nil?
 end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:29:10.707

方法的返回值是最后执行的表达式的值。如果没有明确的返回值，您只会得到最后一个找到的字符串。

您可以简单地在 : 之前添加一行`end`：

```
 final
end 
```

这将返回`final`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T00:57:44.437

我发现当递归调用返回树时，我需要 final += 。

```
def concatAll
 final = ""

 if @lchild.respond_to?('string')   
    final += @lchild.to_s
 else
   final += @lchild.concatAll unless @lchild.nil?
 end

 if @rchild.respond_to?('string')   
   final +=  @rchild.to_s
 else
   final += @rchild.concatAll unless @rchild.nil?
 end

 final
end 
```

特别感谢马克托马斯

# r - 以便携式 USB 形式部署 R 脚本

> ID：13168701
> 
> 赞同：9
> 
> 时间：2012-10-31T23:04:19.163
> 
> 标签：r, deployment, usb, portable-applications

我有一个 R 脚本，我想部署它以防白痴，单击即可运行它等。不幸的是，我没有能力购买服务器，并且它需要运行的环境不允许安装新软件，只能运行便携式应用程序。（学校计算机）我的脚本还依赖于几个非基础包。

有什么方法可以以易于运行的方式部署 R 和我的脚本，以便可以在 USB 棒上使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:11:27.653

您可以在 USB 驱动器上安装 R，并在运行相同操作系统的任何计算机上使用它。如果您使用的是 Windows，请参阅[R for Windows FAQ](http://cran.r-project.org/bin/windows/base/rw-FAQ.html)的[问题 2.6](http://cran.r-project.org/bin/windows/base/rw-FAQ.html#Can-I-run-R-from-a-CD-or-USB-drive_003f)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T23:10:42.550

如果您将 USB 记忆棒设置为安装了 R 的可启动磁盘环境（例如 linux），您可以启动它并这样做。

# html - 如何在 HTML 输出中将 rel 属性添加到 docutils sphinx 参考？

> ID：13168702
> 
> 赞同：3
> 
> 时间：2012-10-31T23:04:24.090
> 
> 标签：html, hyperlink, python-sphinx, docutils

我有一个 Sphinx 文档实用程序的简单扩展（我使用的版本是Sphinx-1.1.3-py2.6）。非常喜欢Doug Hellmann 的[这个](http://www.doughellmann.com/articles/how-tos/sphinx-custom-roles/index.html)出色的例子。如何在最终的 HTML 中添加*rel='bar'属性**标签？*

 *似乎有几种方法可以做到这一点，但我找不到一个简单的方法。建议和提示表示赞赏。

参考节点以这种方式创建：

```
node = nodes.reference(rawtext, utils.unescape(text),
            internal=False,
            refuri=ref,
            classes=['foocss'],
            rel='bar',
            **options) 
```

但是，*rel='bar'*属性会从最终的 HTML 标记中删除。通过源代码搜索让我找到了*sphinx/writers/html.py*和*HTMLTranslator*类。这是 visit_reference 方法的一部分：

```
# overwritten
def visit_reference(self, node):
    atts = {'class': 'reference'}

    <snip>

    if 'reftitle' in node:
        atts['title'] = node['reftitle']
    self.body.append(self.starttag(node, 'a', '', **atts)) 
```

不处理附加属性。也许它们可以在其他部分被替换。在这方面我找不到任何有用的东西。

所以，我可以：

*   创建一个自定义节点，重新实现参考节点的所有功能。一点点的工作量就够了。
*   *覆盖sphinx/writers/html.py*中的 *visit_reference* 方法。更快，但在未来的 Sphinx 更新方面很糟糕。
*   事后将带有 jQ​​uery 的 rel 属性添加到链接标记。嗯，也不漂亮。

我确定我错过了明显而优雅的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T21:07:09.640

我设法做到了这一点`download_reference`。使用`app.add_node`我覆盖该`visit_...`方法：

```
import posixpath
from sphinx.writers.html import HTMLTranslator
from sphinx.addnodes import download_reference

def visit_download_reference(self, node):
    if node.hasattr('filename'):
        self.body.append(
            '<a class="reference download internal" href="%s" %s>' %
            (posixpath.join(self.builder.dlpath, node['filename']), 'rel="%s"' % node['rel'] if node.get('rel', None) else ''))
        self.context.append('</a>')
    else:
        self.context.append('')

def setup(app):
    app.add_node(download_reference, html=(visit_download_reference, HTMLTranslator.depart_download_reference)) 
```

[完整的扩展在这里](http://pastebin.com/pMhKnTkv)*

# android - 创建一个安卓智能应用横幅

> ID：13168706
> 
> 赞同：63
> 
> 时间：2012-10-31T23:04:59.337
> 
> 标签：android, ios, android-layout, android-widget, ios6

有没有类似 iOS 6 智能应用横幅的安卓设备解决方案？

**这是智能应用横幅的代码**

```
<meta name="apple-itunes-app" content="app-id=311507490, affiliate-data=partnerId=30&siteID=k1CkFsOh4nQ"/> 
```

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-11-09T13:31:58.440

> 从 Chrome 44 Beta 开始，您可以在您的网站上使用原生应用安装横幅在 Chrome for Android 中推送您的应用。

[请看下面的答案。](https://stackoverflow.com/questions/13168706/creating-an-android-smart-app-banner#32046978)

* * *

## 旧答案

我自己也需要它，所以我创建了一个 jquery 插件来模仿 Android 和旧 iOS 版本的智能横幅。

[http://jasny.github.com/jquery.smartbanner/#android](http://jasny.github.com/jquery.smartbanner/#android)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-08-17T09:30:48.147

从 Chrome 44 Beta 开始，您可以在您的网站上使用原生应用安装横幅在 Chrome for Android 中推送您的应用。为了启用它，需要满足几个标准：

*   您将需要一个[Web 应用清单文件](http://updates.html5rocks.com/2014/11/Support-for-installable-web-apps-with-webapp-manifest-in-chrome-38-for-Android)
*   您必须使用 https 服务您的网络
*   用户在两周内分别在两天内访问了您的网站两次。

[在Google 的官方文档](https://developers.google.com/web/fundamentals/app-install-banners/native)中阅读有关它的更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-15T03:00:42.233

您使用特殊参数将 Google 登录按钮添加到您的页面，然后用户可以登录并指定直接从您的网站安装您的应用程序的设备。

这是我所知道的最“官方支持”的实现：

[https://developers.google.com/identity/sign-in/web/android-app-installs](https://developers.google.com/identity/sign-in/web/android-app-installs)

从链接：

通过将 Google 登录按钮添加到您的网站，您可以自动提示您的用户通过无线方式将您的 Android 应用程序下载到他们的 Android 设备上。要启用此功能，您必须为您的 Web 和 Android 客户端使用相同的 Google Developers Console 项目，并配置您的 Web 应用程序的登录按钮。

您的 Web 应用程序必须使用 Google 登录按钮来提示您的网站用户在他们首次登录时下载您的应用程序。通过将 apppackagename 参数添加到您的登录按钮来启用此功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-15T15:16:46.657

有两个 API 可用：

*   要检测**应用程序是否已安装**，请使用 getInstalledRelatedApps（仅适用于 Chrome 80+）
    *   包含一般信息的文章：[https ://web.dev/get-installed-related-apps/](https://web.dev/get-installed-related-apps/)
    *   带有代码的文档和演示（网络+应用程序）[https://www.chromestatus.com/feature/5695378309513216](https://www.chromestatus.com/feature/5695378309513216)
*   显示**安装应用程序的提示**
    *   带有代码示例的文章：[https ://web.dev/customize-install/](https://web.dev/customize-install/)
    *   文档：[https ://developers.google.com/web/fundamentals/app-install-banners/native](https://developers.google.com/web/fundamentals/app-install-banners/native)

# android - 安装 Android SDK $(^Name) appcrash 错误

> ID：13168709
> 
> 赞同：0
> 
> 时间：2012-10-31T23:05:08.510
> 
> 标签：android, android-sdk-2.3

我正在尝试在 Windows 7 平台上安装 androids SDK + AVD 管理器，并且在安装向导失败后返回 $(^Name) 错误。在“更多描述链接选项”下，已产生定义的“应用程序崩溃”。我该如何解决这个问题，我已经尝试了很多次！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T13:25:06.663

我建议你安装 Eclipse，并安装 ADK Eclipse 插件。[这里](http://developer.android.com/sdk/installing/installing-adt.html)有更多关于如何做的细节。

# java - 绘制图形和事件处理

> ID：13168712
> 
> 赞同：0
> 
> 时间：2012-10-31T23:06:05.073
> 
> 标签：java, graphics, event-handling, jframe, actionlistener

我正在尝试编写一个程序，在屏幕上绘制一个圆圈，然后为您提供 3 个按钮（红色、黄色和绿色），然后单击该按钮相应地更改圆圈的填充颜色。

我想我已经接近了，我只是不知道如何实际创建一个绘制圆圈并改变颜色的方法。我可以编写一个方法来绘制和填充一个圆圈我只是在将它与 jbutton 合并时遇到问题

这是我到目前为止所拥有的：

（忽略未使用的导入）

* * *

采取了不同的方法，我不知道它是否更好。我的按钮显示，一切都只是在改变颜色时遇到问题。实际上现在我什至不能显示一个圆圈。我知道我需要调用`repaint();`我的事件处理程序我只是不知道该怎么做。这是由于星期天，我花了很多时间看视频和阅读示例，我只是无法让我的工作。我敢肯定它很简单，但它让我很沮丧！

```
 public class test3 extends JPanel {

JRadioButton RED, YELLOW, GREEN; 
Color currentColor;          

public void paintComponent(Graphics g){

    currentColor= Color.RED; 

        super.paintComponent(g);
        this.setBackground(Color.WHITE);

        g.setColor(currentColor);
        g.fillOval(50, 50, 100, 100);    
       }

public static void main(String[] args) {

  test3 frame = new test3();
  frame.setSize(500,500);

  frame.setVisible(true);
    }

public test3 (){

JPanel jpRadioButtons=new JPanel();
jpRadioButtons.setLayout(new GridLayout(1,1));
jpRadioButtons.add(RED=new JRadioButton("RED"));
jpRadioButtons.add(GREEN=new JRadioButton("GREEN"));
jpRadioButtons.add(YELLOW=new JRadioButton("YELLOW"));

add(jpRadioButtons, BorderLayout.SOUTH);

ButtonGroup group=new ButtonGroup();
group.add(RED);
group.add(YELLOW);
group.add(GREEN);

GREEN.addActionListener(new ActionListener()
{
    public void actionPerormed(ActionEvent e)
    {        

        currentColor = Color.GREEN;
     repaint();           
    }
      });

   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:56:52.863

1.  用圆的当前颜色引入一个类变量/属性/...。
2.  在您的事件处理程序中设置此变量
3.  也调用“repaint();” 在您的事件处理程序中
4.  覆盖该`paintComponent()`方法并使其以颜色绘制一个圆圈，您可以从类变量中读取该圆圈。

你`paintComponent(Graphics g)`可能看起来像这样：

```
@Override
void paintComponent(Graphics g)
{
  g.setColor(currentColor);
  g.drawOval(50,50,100,100);
} 
```

# node.js - Node.js 内存泄漏：无法理解我的堆快照

> ID：13168718
> 
> 赞同：1
> 
> 时间：2012-10-31T23:06:42.810
> 
> 标签：node.js

我正在使用 nodetime 来分析我的节点应用程序。显然，存在内存泄漏；这是我在 2 天内的堆（2 次下降是由于重新启动应用程序）：

![在此处输入图像描述](../Images/ac6228e3ed489725298cd4e4ff7fd702.png)

所以我正在拍摄堆快照，但很难弄清楚泄漏的原因是什么。对象似乎来来去去（例如，堆中的对象并不总是相同的）。这是一个例子：

![在此处输入图像描述](../Images/da3c3308eb2101c2bf826beddc272644.png)

我不太确定从这里去哪里。在这种特殊情况下，我识别出“最大实例”中表示的字符串。第二个和第三个字符串都来自我使用[Node-OAuth加载](https://github.com/ciaranj/node-oauth)[Facebook Graph](http://graph.facebook.com)的 /me/home 端点。

说实话，我实际上并不清楚“body”属性是否真的在泄漏，或者它是否只是在我拍摄快照时*巧合*在堆中（如果我拍摄另一个快照，它并不总是存在）。

无论如何，这是我的 OAuthNetwork 课程的摘录：

```
OAuthNetwork.prototype.oauth = function() {
    return new OAuth(
            this.settings['url_request_token'],
            this.settings['url_access_token'],
            this.data['key'],
            this.data['secret'],
            this.settings['version'],
            this.settings['url_callback'],
            this.settings['encoding'],
            null,//nonceSize
            this.settings['request_headers']
        );
};
OAuthNetwork.prototype.requestWithCredentials = function(credentials, endpoint, method, params, callback)
{
    var url = this.getRequestURL(endpoint, method, params),
        m = (method || 'GET').toUpperCase(),
        body = (m==='PUT'||m==='POST') ? this.buildRequestBody(params) : '',
        ct = this.settings.request_headers['Content-Type'] || null,
        extra = null;

    this.oauth()._performSecureRequest(credentials.key, credentials.secret, method, url, extra, body, ct, function(error, data, response) {

        if(error)
        {
            callback(new Errors.External({'message':'there was an error with the remote service: '+JSON.stringify(error),'error':error,'endpoint': endpoint}));
            return;
        }
        callback(null, {'body': data, 'response': response});
    });
}; 
```

所以，我留下的印象是“body”字段以某种方式被保留/泄露。不过，我发现堆快照专门引用了 body 属性，而不是“响应”属性，这很奇怪。

任何人都可以为我提供一些关于如何找出泄漏的最终原因的可靠方向吗？

# ruby - OSX RoR Guard 无法自动运行某些文件的文件更新

> ID：13168725
> 
> 赞同：1
> 
> 时间：2012-10-31T23:07:11.780
> 
> 标签：ruby, rspec, guard, fsevents

我非常困惑..（也很沮丧..）

出于某种原因，guard 没有检测 osx 上的文件更新，而只是检测某些文件。这几乎就像 watch 函数中定义的正则表达式不起作用或什么的..

我已经创建了一个全新的 Rails 应用程序，用于在 Ryans 防护 railscast 之后摆弄——http [://railscasts.com/episodes/264-guard](http://railscasts.com/episodes/264-guard)

并具有生成的默认保护文件；

```
guard init spec 
```

看起来像这样；

```
# A sample Guardfile
# More info at https://github.com/guard/guard#readme

guard 'rspec', :cli => "--color --format nested --fail-fast" do
  watch(%r{^spec/.+_spec\.rb$})
  watch(%r{^lib/(.+)\.rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" }
  watch('spec/spec_helper.rb')  { "spec" }

  # Rails example
  watch(%r{^app/(.+)\.rb$})                           { |m| "spec/#{m[1]}_spec.rb" }
  watch(%r{^app/(.*)(\.erb|\.haml)$})                 { |m| "spec/#{m[1]}#    {m[2]}_spec.rb" }
  watch(%r{^app/controllers/(.+)_(controller)\.rb$})  { |m| ["spec/routing/#    {m[1]}_routing_spec.rb", "spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb", "spec/acceptance/#    {m[1]}_spec.rb"] }
  watch(%r{^spec/support/(.+)\.rb$})                  { "spec" }
  watch('config/routes.rb')                           { "spec/routing" }
  watch('app/controllers/application_controller.rb')  { "spec/controllers" }

  # Capybara request specs
  watch(%r{^app/views/(.+)/.*\.(erb|haml)$})          { |m| "spec/requests/#{m[1]}_spec.rb" }

  # Turnip features and steps
  watch(%r{^spec/acceptance/(.+)\.feature$})
  watch(%r{^spec/acceptance/steps/(.+)_steps\.rb$})   { |m| Dir[File.join("**/#{m[1]}.feature")][0] || 'spec/acceptance' }
end 
```

如果我在规范目录中编辑 application_controller.rb 或规范文件，守卫将自动运行就好了。

但是，如果我编辑并保存任何其他控制器，则什么也不会发生。

我两者都跑后卫`guard`，`bundle exec guard`没有区别；它只运行一次完整的套件，然后在提示时坐在那里。

macbook pro 操作系统 v10.6.8。
带有 Ruby-1.9.3-p286 和 Rails 3.2.8 rb-fsevent 0.9.2 的 RVM

我的一位同事正在运行具有相同系统规格（公司发行的 mbp）直接从 git 中提取的完全相同的东西，并且它适用于他。

当他编辑`app/home_controller.rb`并只给它额外的一行或其他东西时，点击保存..测试触发。

当我编辑文件并点击保存时，没有任何反应，但如果我编辑`app/application_controller.rb`它会触发..

我很困惑..我很沮丧..我需要帮助，因为我不知所措..

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T08:51:30.287

它看起来像[rb-fsevent](https://github.com/thibaudgg/rb-fsevent)和 OS X 10.6 的问题。您可以通过在您的喜欢`rb-fsevent`中设置一个固定版本来尝试旧版本是否可以工作`Gemfile`

`gem 'rb-fsevent', '0.9.0'`

或者您可以通过切换到轮询来解决此问题：

`bundle exec guard --force-polling`

# android - 使用 SimpleCursorTreeAdapter 在 Android 中管理光标的推荐方法是什么？

> ID：13168729
> 
> 赞同：0
> 
> 时间：2012-10-31T23:07:33.503
> 
> 标签：android, cursor, android-cursoradapter

我有一个扩展 ExpandableListActivity 的类。为了填充这个列表的数据，我使用了一个扩展 SimpleCursorTreeAdapter 的类。我有一个看起来像这样的组（顶级）游标：

```
mGroupCursor = ((MyApplication)getApplication()).
    getDatabaseHelper().getGroupCursor();
startManagingCursor(mGroupCursor); 
```

当然，我还需要提供子游标：

```
@Override
protected Cursor getChildCursor(Cursor groupCursor)
{
    Cursor childCursor = ((MyApplication)getApplication().
        getDatabaseHelper().
        getChildCursorForGroup(groupCursor.getInt(mGroupIdIndex));
    startManagingCursor(childCursor);
    return childCursor;
} 
```

我的印象是我可以在这些游标上调用 startManagingCursor 并且一切都会得到处理。显然情况并非如此，因为离开列表视图并使用后退按钮返回会引发异常，“无法恢复活动：尝试重新查询关闭的光标”或类似的东西。

删除调用以`startManagingCursor()`解决问题，尽管我认为这不是真正正确的做事方式，因为在这种情况下，我不会在任何地方关闭游标。

处理这些游标的推荐方法是什么？我正在寻找简单轻便的东西。我的数据库是一个本地 SQLite 数据库，并且相对较小，所以只要性能不是太慢，这对我来说不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:31:29.770

startManagingCursor 已过时。我会考虑使用 AsyncTask 在后台获取光标，并自己设置观察者。

# jquery - 使用json在多选中将选项标记为选中

> ID：13168731
> 
> 赞同：3
> 
> 时间：2012-10-31T23:07:34.943
> 
> 标签：jquery, ajax, json

我在 jQuery 模式对话框中有一个编辑表单。它有一个直接从数据库填充的多选框。我正在编辑的记录来自使用 json 的数据库。有一个名为的字段`problemids`，它具有逗号分隔的 id。

多选看起来像这样：

```
<select name="Problems" size="5" multiple="multiple" id="Problems">
    <option value="26">Backup battery error or cannot hold correct time.</option>
    <option value="22">Battery contacts damage</option>
    <option value="20">Belt clip damage</option>
    <option value="31">Cannot flash firmware</option>
    <option value="32">Cannot load task</option>
    <option value="34">Case damage</option>
    etc...  
</select> 
```

json 返回如下所示：

```
[{
    "ModelID":33,
    "AccountID":1,
    "RandomID":"lo9876yhgbvfdr54",
    "ManID":5,
    "Model":"5090",
    "ProblemIDs":"22,26",
    "Active":true,
    "DateCreated":"2/27/2012 5:35:00 PM",
    "DateUpdated":"10/26/2012 2:04:00 PM",
    "UpdatedBy":6998,
    "CreatedBy":null
}] 
```

还有我的阿贾克斯：

```
$.ajax({
    url: "ajax/edit-model.asp",
    cache: false,
    data: { recordid: recordid, rid: rid, crud: crud },
    type: 'GET',
    dataType: "json",
    error: function(xhr, textStatus, errorThrown) {
        alert("An error occurrred! " + errorThrown);
    },
    success: function(data, textStatus) {
        $("#edit-dialogForm #RecordID").val(data[0].ModelID);
        $("#edit-dialogForm #RID").val(data[0].RandomID);
        $("#edit-dialogForm #ManID").val(data[0].ManID);
        $("#edit-dialogForm #Model").val(data[0].Model);
        if(data[0].Active){
            $('#edit-dialogForm input[name="Active"]:eq(0)').prop('checked', true);
        }else{
            $('#edit-dialogForm input[name="Active"]:eq(1)').prop('checked', true);
        }
    }
}); 
```

如何在我的多选中将项目标记为“已选择”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:26:29.957

小提琴 - [http://jsfiddle.net/tariqulazam/TXcgh/](http://jsfiddle.net/tariqulazam/TXcgh/)

```
var data = {
    "ModelID":33,
    "AccountID":1,
    "RandomID":"lo9876yhgbvfdr54",
    "ManID":5,
    "Model":"5090",
    "ProblemIDs":"22,26",
    "Active":true,
    "DateCreated":"2/27/2012 5:35:00 PM",
    "DateUpdated":"10/26/2012 2:04:00 PM",
    "UpdatedBy":6998,
    "CreatedBy":null
};
$.each(data.ProblemIDs.split(','), function(index, element){
                     $('#Problems').find('option[value="'+ element +'"]').attr('Selected', 'Selected');
}); 
```

**更新**：修改您的成功回调，如下所示

```
success: function(data, textStatus) {
        $("#edit-dialogForm #RecordID").val(data[0].ModelID);
        $("#edit-dialogForm #RID").val(data[0].RandomID);
        $("#edit-dialogForm #ManID").val(data[0].ManID);
        $("#edit-dialogForm #Model").val(data[0].Model);
        if(data[0].Active){
            $('#edit-dialogForm input[name="Active"]:eq(0)').prop('checked', true);
        }else{
            $('#edit-dialogForm input[name="Active"]:eq(1)').prop('checked', true);
        }
        $.each(data[0].ProblemIDs.split(','), function(index, element){
                     $('#edit-dialogForm #Problems').find('option[value="'+ element +'"]').attr('Selected', 'Selected');
        });
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-11T07:57:09.633

选择标签中的选项值应等于数组中的值或我们标记为从 jquery 中选择的值

$('#updatecategoryname').multiselect('select', array);

[`Here Is The Example of Multi Select`](https://jsbin.com/wuvixoqihu/edit?html,js,output)

# c# - '[Unknown]' 属性未指向路径 '(0).(1)[3].(2)' 中的 DependencyObject

> ID：13168740
> 
> 赞同：5
> 
> 时间：2012-10-31T23:09:11.603
> 
> 标签：c#, wpf, xaml, styles, togglebutton

如何解决由以下样式引起的异常？

```
 <Style x:Key="OnOffSwitchToggleButton" TargetType="{x:Type ToggleButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Grid Margin="0,0,0,-0.033">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.456*"/>
                                <ColumnDefinition Width="0.544*"/>
                            </Grid.ColumnDefinitions>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="Switch">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="0.083"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="path1">
                                                <EasingColorKeyFrame KeyTime="0" Value="White"/>
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MouseOver">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Effect).(DropShadowEffect.Opacity)" Storyboard.TargetName="path">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed"/>
                                    <VisualState x:Name="Disabled"/>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="CheckStates">
                                    <VisualState x:Name="Checked">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="path">
                                                <EasingColorKeyFrame KeyTime="0:0:0.2" Value="#FF39B54A"/>
                                            </ColorAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Stroke).(SolidColorBrush.Color)" Storyboard.TargetName="path">
                                                <EasingColorKeyFrame KeyTime="0:0:0.2" Value="#FF319D40"/>
                                            </ColorAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="label">
                                                <EasingColorKeyFrame KeyTime="0" Value="#00999999"/>
                                                <DiscreteColorKeyFrame KeyTime="0:0:0.2" Value="#0039B54A"/>
                                                <EasingColorKeyFrame KeyTime="0:0:0.3" Value="White"/>
                                            </ColorAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(ContentControl.Content)" Storyboard.TargetName="label">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="ON"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.HorizontalAlignment)" Storyboard.TargetName="Switch">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="{x:Static HorizontalAlignment.Left}"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="Switch">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="39.965"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="label">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0.2" Value="-19.224"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unchecked">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="Switch">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="label">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0.2" Value="0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="label">
                                                <EasingColorKeyFrame KeyTime="0" Value="#00999999"/>
                                                <EasingColorKeyFrame KeyTime="0:0:0.2" Value="#00999999"/>
                                                <EasingColorKeyFrame KeyTime="0:0:0.3" Value="#FF999999"/>
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Indeterminate"/>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Canvas x:Name="_switch" UseLayoutRounding="False" Height="30" Width="70" d:LayoutOverrides="VerticalMargin" Grid.ColumnSpan="2">
                                <Canvas x:Name="Background" Height="30" Canvas.Left="0" Canvas.Top="0" Width="70" RenderTransformOrigin="0.5,0.5">
                                    <Canvas.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Canvas.RenderTransform>
                                    <Path x:Name="path" Height="30" Canvas.Left="0" Canvas.Top="0" Width="70" Data="F1M55.0161,-0.966799999999999L14.9831,-0.966799999999999C6.7081,-0.966799999999999,0.00010000000000332,5.7412,0.00010000000000332,14.0162C0.00010000000000332,22.2922,6.7081,29.0002,14.9831,29.0002L55.0161,29.0002C63.2911,29.0002,70.0001,22.2922,70.0001,14.0162C70.0001,5.7412,63.2911,-0.966799999999999,55.0161,-0.966799999999999" Fill="#FFEDEDED" Stretch="Fill" Stroke="#FFCCCCCC">
                                        <Path.Effect>
                                            <DropShadowEffect ShadowDepth="0" Color="#FF00ADEF" Opacity="0"/>
                                        </Path.Effect>
                                    </Path>
                                </Canvas>
                                <Grid x:Name="Switch" Height="22" Canvas.Left="4.815" Canvas.Top="3.568" Width="22" RenderTransformOrigin="0.5,0.5">
                                    <Grid.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Grid.RenderTransform>
                                    <Grid.Effect>
                                        <DropShadowEffect BlurRadius="3" ShadowDepth="0" Opacity="0.5"/>
                                    </Grid.Effect>
                                    <Path x:Name="path1" Data="F1M14.9614,27.0166C7.7934,27.0166,1.9614,21.1846,1.9614,14.0166C1.9614,6.8486,7.7934,1.0166,14.9614,1.0166C22.1294,1.0166,27.9614,6.8486,27.9614,14.0166C27.9614,21.1846,22.1294,27.0166,14.9614,27.0166" Height="22" Stretch="Fill" Width="22" Margin="0" Fill="White"/>
                                </Grid>
                            </Canvas>
                            <Label x:Name="label" Content="OFF" Grid.Column="1" Margin="-2.506,2,0,0" HorizontalAlignment="Left" Padding="0" VerticalAlignment="Center" FontFamily="Avenir 45" FontSize="14.667" Foreground="#FF999999" RenderTransformOrigin="0.5,0.5">
                                <Label.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform/>
                                        <SkewTransform/>
                                        <RotateTransform/>
                                        <TranslateTransform/>
                                    </TransformGroup>
                                </Label.RenderTransform>
                            </Label>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style> 
```

我将此样式应用于网格单元格内的切换按钮：

```
<ToggleButton Grid.Column="1" IsChecked="{Binding Path=ObjectStatus}" Style="{StaticResource ResourceKey=OnOffSwitchToggleButton}" Margin="5,0,0,0"/> 
```

我在 devexpress GridControl 中有另一个切换按钮，并且没有出现此异常。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T07:38:38.923

正如约翰所说，错误就在这一行

```
<DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="Switch"> 
```

它无法在 switch 中迭代和查找属性，因此解决方案是给变换命名，然后直接引用变换

```
<DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(TranslateTransform.Y)" Storyboard.TargetName="SwitchTranslate"> 
```

和

```
<Grid x:Name="Switch" Height="22" Canvas.Left="4.815" Canvas.Top="3.568" Width="22" RenderTransformOrigin="0.5,0.5">
                            <Grid.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform/>
                                    <SkewTransform/>
                                    <RotateTransform/>
                                    <TranslateTransform x:Name="SwitchTranslate"/>
                                </TransformGroup> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:53:54.777

```
<DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="Switch"> 
```

这是 '(0).(1)3' 的违规行，其中：

*   (0) 是 (UIElement.RenderTransform),
*   (1) 是 (TransforGroup.Children),
*   [3] 是 [3]，并且
*   (2) 是 (TranslateTransform.Y)

没有多大帮助，但我遇到了类似的问题。我认为，如果您注释掉该行，问题就会消失，但可能不起作用。也许对这类问题有更多经验的人可以在这里插话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-09T16:28:29.490

以下是您的固定样式：

```
<Style x:Key="OnOffSwitchToggleButton" TargetType="{x:Type ToggleButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Grid Margin="0,0,0,-0.033">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.456*"/>
                                <ColumnDefinition Width="0.544*"/>
                            </Grid.ColumnDefinitions>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="Switch">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="0.083"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="path1">
                                                <EasingColorKeyFrame KeyTime="0" Value="White"/>
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="MouseOver">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Effect).(DropShadowEffect.Opacity)" Storyboard.TargetName="path">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed"/>
                                    <VisualState x:Name="Disabled"/>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="CheckStates">
                                    <VisualState x:Name="Checked">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="path">
                                                <EasingColorKeyFrame KeyTime="0:0:0.2" Value="#FF39B54A"/>
                                            </ColorAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Stroke).(SolidColorBrush.Color)" Storyboard.TargetName="path">
                                                <EasingColorKeyFrame KeyTime="0:0:0.2" Value="#FF319D40"/>
                                            </ColorAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="label">
                                                <EasingColorKeyFrame KeyTime="0" Value="#00999999"/>
                                                <DiscreteColorKeyFrame KeyTime="0:0:0.2" Value="#0039B54A"/>
                                                <EasingColorKeyFrame KeyTime="0:0:0.3" Value="White"/>
                                            </ColorAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(ContentControl.Content)" Storyboard.TargetName="label">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="ON"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.HorizontalAlignment)" Storyboard.TargetName="Switch">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="{x:Static HorizontalAlignment.Left}"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="Switch">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="39.965"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="label">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0.2" Value="-19.224"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unchecked">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="Switch">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.2" Value="0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="label">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0.2" Value="0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="label">
                                                <EasingColorKeyFrame KeyTime="0" Value="#00999999"/>
                                                <EasingColorKeyFrame KeyTime="0:0:0.2" Value="#00999999"/>
                                                <EasingColorKeyFrame KeyTime="0:0:0.3" Value="#FF999999"/>
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Indeterminate"/>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Canvas RenderTransformOrigin="0.5,0.5" x:Name="_switch" UseLayoutRounding="False" Height="30" Width="70"  Grid.ColumnSpan="2">
<Canvas.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Canvas.RenderTransform>

                                <Canvas x:Name="Background" Height="30" Canvas.Left="0" Canvas.Top="0" Width="70" RenderTransformOrigin="0.5,0.5">
                                    <Canvas.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Canvas.RenderTransform>
                                    <Path x:Name="path" Height="30" Canvas.Left="0" Canvas.Top="0" Width="70" Data="F1M55.0161,-0.966799999999999L14.9831,-0.966799999999999C6.7081,-0.966799999999999,0.00010000000000332,5.7412,0.00010000000000332,14.0162C0.00010000000000332,22.2922,6.7081,29.0002,14.9831,29.0002L55.0161,29.0002C63.2911,29.0002,70.0001,22.2922,70.0001,14.0162C70.0001,5.7412,63.2911,-0.966799999999999,55.0161,-0.966799999999999" Fill="#FFEDEDED" Stretch="Fill" Stroke="#FFCCCCCC">
                                        <Path.Effect>
                                            <DropShadowEffect ShadowDepth="0" Color="#FF00ADEF" Opacity="0"/>
                                        </Path.Effect>
                                    </Path>
                                </Canvas>
                                <Grid x:Name="Switch" Height="22" Canvas.Left="4.815" Canvas.Top="3.568" Width="22" RenderTransformOrigin="0.5,0.5">
                                    <Grid.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Grid.RenderTransform>
                                    <Grid.Effect>
                                        <DropShadowEffect BlurRadius="3" ShadowDepth="0" Opacity="0.5"/>
                                    </Grid.Effect>
                                    <Path x:Name="path1" Data="F1M14.9614,27.0166C7.7934,27.0166,1.9614,21.1846,1.9614,14.0166C1.9614,6.8486,7.7934,1.0166,14.9614,1.0166C22.1294,1.0166,27.9614,6.8486,27.9614,14.0166C27.9614,21.1846,22.1294,27.0166,14.9614,27.0166" Height="22" Stretch="Fill" Width="22" Margin="0" Fill="White"/>
                                </Grid>
                            </Canvas>
                            <Label x:Name="label" Content="OFF" Grid.Column="1" Margin="-2.506,2,0,0" HorizontalAlignment="Left" Padding="0" VerticalAlignment="Center" FontFamily="Avenir 45" FontSize="14.667" Foreground="#FF999999" RenderTransformOrigin="0.5,0.5">
                                <Label.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform/>
                                        <SkewTransform/>
                                        <RotateTransform/>
                                        <TranslateTransform/>
                                    </TransformGroup>
                                </Label.RenderTransform>
                            </Label>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-24T14:40:31.633

我认为 TransformGroup 的 Children 集合更有可能没有 4 个元素（还），所以`(TransforGroup.Children)[3]`给出了一个例外。`Children`确保在设置集合之前转换不会运行。

# css - element1+element2 - 选择紧跟在 element2 元素之后的所有 element1 元素

> ID：13168743
> 
> 赞同：1
> 
> 时间：2012-10-31T23:09:54.553
> 
> 标签：css, css-selectors

> **可能重复：**
> [CSS 上一个兄弟选择器](https://stackoverflow.com/questions/1817792/css-previous-sibling-selector)

这个 css 选择器选择紧跟在 element2 元素之后的所有 element1 元素

```
element1+element2 {

} 
```

是否有任何选择器可以选择紧挨**在**element2 元素之前放置的所有 element1 元素？

# php - 添加文件上传到mail.php

> ID：13168750
> 
> 赞同：0
> 
> 时间：2012-10-31T23:10:57.917
> 
> 标签：php, email, html-email

我有联系表格结构。具有以下内容：

HTML：

```
 <form name="feedback_form" method="post" action="" class="feedback_form">
                                                <input type="text" name="field-name" value="İsim" title="İsim" class="field-name form_field">
                                                <input type="text" name="field-email" value="Email" title="Email" class="field-email form_field">
                                                <input type="text" name="field-subject" value="Başlık" title="Subject" class="field-subject form_field">
                                                <textarea name="field-message" cols="45" rows="5" title="Mesajınız..." class="field-message form_field">Mesajınız...</textarea>
                                                <input type="reset" name="reset" id="reset2" value="Temizle" class="feedback_reset">
                                                <input type="button" name="submit" class="feedback_go" id="submit2" value="Gönder">                                    

</form> 
```

我为文件上传添加了这个代码：

```
<label for='uploaded_file'>Upload your picture:</label>
 <input type="file" name="uploaded_file"> 
```

我想，用户可以通过这个标签上传jpg、png、gif、bmp图像。但我不知道如何重新组织我的 mail.php 文件？

邮件.php：

```
<?php
header('Content-Type: text/html; charset=utf-8');

function sendFeedback($feedback_email, $feedback_msg, $feedback_name, $feedback_subject, $feedback_file) {

    /* EDIT THIS */
    $admin_email = "mymail@gmail.com";
    if ($feedback_subject == "Subject" || empty($feedback_subject) ) {
        $subj = "Email from your site";
    } else {
        $subj = $feedback_subject;
    }

    /* //EDIT THIS */

    $message = "
    <html>
    <head>
      <title>Websitenizin emaili</title>
    </head>
    <body>
        <p><a href='mailto:".$feedback_email."'>".$feedback_name."</a> send this message:</p>
        <p>".$feedback_msg."</p>
        <p>".$subject."</p>
    </body>
    </html>
    ";
    $headers  = 'MIME-Version: 1.0' . "\r\n";
    $headers .= 'Content-type: text/html; charset=UTF-8' . "\r\n";

    if ($feedback_name!=="Name" && $feedback_email!=="Email" && !empty($feedback_email) && !empty($feedback_msg) && !empty($feedback_name) ) {
        if ($feedback_email == "mail_error") {
            echo "<span class='ajaxok'>Geçersiz email adresi.</span>";
        } else {            
            mail($admin_email, $subj, $message, $headers);
            echo "<span class='ajaxok'>Teşekkürler. Mesajınız gönderilmiştir.</span>";  
        }
    } else {
        echo "<span class='ajaxalert'>Lütfen zorunlu alanları doldurunuz.</span>";      
    }

}

sendFeedback($_POST['email'], $_POST['message'], $_POST['name'], $_POST['subject'], $_POST['file']);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:32:43.937

首先将操作更改为您拥有 mail.php 文件的目录，如下面的代码所示。然后在 mail.php 中，您将使用与下面的 PHP 代码类似的东西。

```
 <form name="feedback_form" method="post" action="mail.php" class="feedback_form"> 
```

有一种东西叫

```
$_FILES['file']['type']; 
```

您可以在下面的代码中使用它。

如果您想了解更多信息或其他内容，请在本网站上回复或阅读更多内容

[W3Schools 文件上传](http://www.w3schools.com/php/php_file_upload.asp)

```
<?php
$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 20000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

    if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
      }
    }
  }
else
  {
  echo "Invalid file";
  }
?> 
```

# c# - 无法在 VS 2012 SqlExpress 中插入 >1000 条记录

> ID：13168751
> 
> 赞同：0
> 
> 时间：2012-10-31T23:11:07.057
> 
> 标签：c#, visual-studio, visual-studio-2012, sql-server-express

嗯嗯.. 我有一个本地数据库 .. 使用 VS 2012 创建 .. 不是 LocalDB .. 它的 SqlExpress x64 ..

我有一个 C# 程序，它读取和解析一个 txt 文件.. 并将数据转换为记录.. 在一个执行流程中插入大约 200,000 条记录.. 程序解析并创建一个插入查询并执行它..

我使用了 Sql 对象 .. SqlCommand .. SqlConnection ..... 用于插入 ..

问题是控制台 C# 应用程序确实显示所有记录都已成功插入，直到最后计数..

但我只能在数据库表中看到 1000 条记录..

要插入的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using System.Data.SqlClient;
using System.IO;

namespace SentiWordDBPopulate
{
class DBPopulateSentiWord
{
    static SqlCommand sqlCmd;
    static SqlConnection sqlConn;

    static void Main(string[] args)
    {
        try
        {
            sqlConn = new SqlConnection("server=localhost\\SqlExpress; DataBase=WordDBForBlogMiner; integrated security=true");
            sqlConn.Open();
            //sqlCmd = new SqlCommand("select * from KWTable", sqlConn);

            //skip 1st 13 lines
            //for (int i = 1; i <= 13; i++)
            //fin.ReadLine();

            string[] lines = File.ReadAllLines("C:\\Users\\Ritesh\\Desktop\\WordDB.txt");

            Console.WriteLine("Done reading! Press enter to insert everything into DB.");
            Console.Read();

            long IDCounter = 0;
            //enter next 117658 lines into DB
            for (int i = 13; i < lines.Length; i++)
            {
                //string line =fin.ReadLine();
                string[] s = (lines[i].Remove(lines[i].IndexOf('#')).Split(new char[] { '\t' }, StringSplitOptions.RemoveEmptyEntries));
                //s[5] = s[6] = null;
                s[2] = s[2].Equals("NaN") ? "0" : s[2];
                s[3] = s[3].Equals("NaN") ? "0" : s[3];
                float tempNegScore = float.Parse(s[3]), tempPosScore = float.Parse(s[2]);
                int negScore = (int)Math.Round((tempNegScore * 27), MidpointRounding.AwayFromZero);
                int posScore = (int)Math.Round((tempPosScore * 31), MidpointRounding.AwayFromZero);

                if (posScore <= 31 && negScore <= 27)
                {
                    //Console.WriteLine((++IDCounter) + "\t => " + s[0] + "\t" + posScore + "\t" + negScore + "\t" + s[4]);
                    string category = "";
                    if (posScore.Equals(0) && negScore.Equals(0))
                        category = "neutral";
                    else if (posScore > 0 && negScore.Equals(0))
                        category = "positive";
                    else if (posScore.Equals(0) && negScore > 0)
                        category = "negative";
                    else if (posScore > 0 && negScore > 0)
                        category = "PosNeg";

                    string query = "insert into SentiWordKWTable values ('" + s[0] + "', " + (++IDCounter) + ", " + posScore + ", " + negScore + ", '" + s[4].Replace("'", "") + "', '" + category + "')";
                    sqlCmd = new SqlCommand(query, sqlConn);
                    sqlCmd.ExecuteNonQuery();
                    Console.WriteLine("Record Num: " + IDCounter + " successfully inserted!");
                }
                else
                {
                    Console.WriteLine((++IDCounter) + "\t => " + s[0] + "\t" + posScore + "\t" + negScore + "\t" + s[4]);
                    break;
                }

                tempNegScore = tempPosScore = 0;
                posScore = negScore = 0;
            }
            Console.Read();
        }
        catch (Exception e)
        {
            Console.WriteLine("Exception occured => " + e.Message);
            sqlCmd = new SqlCommand("delete from SentiWordKWTable", sqlConn);
            sqlCmd.ExecuteNonQuery();
            Console.WriteLine("all rows of table deleted");
        }
        Console.Read();
    }
} 
```

}

在 VS 2008 早期这不是问题 .. VS 2012 中是否有一些限制 .. 或者可以启用 >1000 插入的东西？..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:44:25.397

它只是可见性选项。顶部有一个小工具栏，其中有一个字段： Max Rows: 1000 我在其中选择了“全部”，一切都是可见的...... * facepalm *

很抱歉给大家带来麻烦，感谢@MarcGravell，我将使用参数而不是串联。

# php - html链接中的php函数

> ID：13168756
> 
> 赞同：1
> 
> 时间：2012-10-31T23:11:37.480
> 
> 标签：php, html, function, hyperlink

我试图通过在 HTML 链接中使用 PHP 函数来调用网站根目录。

我在下面创建了函数 bloginfo() ，正确的链接输出是[http://www.example.com/subdirectory/file.php](http://www.example.com/subdirectory/file.php)。

调用函数的两种方法相似，但**方法 1 不起作用**，**方法 2 起作用**。

请有人解释为什么方法1不起作用并提出解决方案。谢谢。

```
<?php
function bloginfo($show) {
switch ($show) {
    case 'template_url':
        echo "www.example.co.uk";
        break;
}
}

// Method 1 - does not work
echo "<a href=\"http://<?php bloginfo('template_url'); ?>/subdirectory/file.php\">test link 1</a>";

?>
<html>
<body>

<!-- Method 2 - works! -->
<a href="http://<?php bloginfo('template_url'); ?>/subdirectory/file.php">test link 2</a>

</body>
</html> 
```

**更新**

```
echo "<a href=\"http://".bloginfo('template_url')."/subdirectory/file.php\"> 
```

谢谢大家的帮助。不幸的是，由于某种原因，我无法获得通用答案（代码行上方），但会打印“www.example.com”但不会作为链接，并且链接方向只是变成了“/subdirectory/file.php” .

为了解决这个问题，我放弃了合并一个函数并决定简单地使用下面的 PHP 定义方法，该方法适用于两种方法。

```
<?php

//this line of code can be put into an external PHP file and called using the PHP Include method.
define("URL", "www.example.com", true);

// Method 1 - works!
echo "<a href=\"http://".URL."/subdirectory/file.php\">test link 1</a>";

?>
<html>
<body>

<!-- Method 2 - works! -->
<a href="http://<?php echo URL; ?>/subdirectory/file.php">test link 2</a>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:13:14.603

双引号字符串使您在第一种方法中的 php 块只是一个普通的旧文本字符串。尝试这个：

```
 echo "<a href=\"http://".bloginfo('template_url')."/subdirectory/file.php\">test link 1</a>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:14:03.317

你已经嵌套了一些 php 标签

```
echo "<a href=\"http://" .bloginfo('template_url') . "/subdirectory/file.php\">test link 1</a>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:20:15.820

或这个：

```
echo "<a href=\"http://{bloginfo('template_url')}/subdirectory/file.php\">test link 1</a>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T23:42:24.247

这是因为您在标签内使用并且没有告诉它回显。下面的代码可以工作 - 我已经注释掉了你的旧行并添加了一个可以工作的新行

```
<?php
function bloginfo($show) {
  switch ($show) {
    case 'template_url':
    echo "www.example.co.uk";
    break;
  }
}

// Method 1 - does not work
//echo "<a href=\"http://<?php bloginfo('template_url'); ?>/subdirectory/file.php\">test link 1</a>";

echo "<a href=\"http://".bloginfo('template_url')."/subdirectory/file.php\">test link 1</a>"; <--- changed the above line to this... now both this and the lower line work

?>
<html>
<body>

<!-- Method 2 - works! -->
<a href="http://<?php bloginfo('template_url'); ?>/subdirectory/file.php">test link 2</a>

</body>
</html> 
```

# python - Python在1遍中多次使用Regex Sub

> ID：13168761
> 
> 赞同：0
> 
> 时间：2012-10-31T23:12:17.650
> 
> 标签：python, regex

有没有办法将多个正则表达式组合成一个，这样它就可以一次完成不同的子程序？

```
no_Punct = re.sub('(\w)([?:!.,;-]+)(\s)',r'\1 ',raw)
no_Punct = re.sub('(\s)([-]+)(\s)',r'\1',no_Punct) 
```

输入字符串是“原始”。我试图去掉单词末尾的某些标点符号，并删除每边被空格包围的连字符。我可以将这两者结合到一个语句中吗？

给定输入：这是一个句子！四分之一等于 0.25。

输出是：这是一个四分之一等于 0.25 的句子

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T23:13:51.120

微不足道，只需将一个替换为另一个：

```
no_Punct = re.sub('(\s)([-]+)(\s)', r'\1', re.sub('(\w)([?:!.,;-]+)(\s)', r'\1 ', raw)) 
```

虽然这也可能有效：

```
no_Punct = re.sub('(?<=\w)[?:!.,;-]+(?=\s)|(?<=\s)-+\s', '', raw) 
```

# netbeans - Netbeans“新文件”-“Web 服务客户端”缺少选项

> ID：13168765
> 
> 赞同：1
> 
> 时间：2012-10-31T23:12:25.747
> 
> 标签：netbeans

如果我在 Netbeans 7 中创建一个新的 maven 项目，我可以向它添加一个“Web 服务客户端”文件类型，它会读取 wsdl 并生成存根对象。我有另一个预先存在的 Maven 项目，Netbeans 可以很好地导入和构建。但是，如果我尝试添加类型为“Web 服务客户端”的文件（新文件 -> Web 服务），则该选项不存在。

为什么会这样？即在 Netbeans 中定义了哪些文件类型可以添加到哪些项目中，尤其是在这种情况下使用 maven 项目？

如果相关，第二个项目基于 Spring MVC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T13:39:46.910

需要下载EE版： http://netbeans.org/downloads/start.html?platform=windows&lang=en&option= [javaee](http://netbeans.org/downloads/start.html?platform=windows&lang=en&option=javaee)

# javascript - 如何在 raphael.js 中进行 rotateX？

> ID：13168766
> 
> 赞同：1
> 
> 时间：2012-10-31T23:12:26.510
> 
> 标签：javascript, raphael, transform

我在 Raphael.js 文档中的搜索以`transform`功能结束，[似乎] 只支持 2D 转换。即平移、旋转、缩放。

现在的问题是：有什么方法可以应用（和动画）具有 3D 变换的元素。例如旋转X。就像我们在 CSS3 中所拥有的：

```
transform: rotateX(100deg); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:17:29.393

[不，Raphael 仅支持使用rotate](http://raphaeljs.com/reference.html#Element.rotate)方法围绕给定点进行 2D旋转。

# knockout.js - 如何防止在执行敲除绑定之前显示 Html

> ID：13168767
> 
> 赞同：70
> 
> 时间：2012-10-31T23:12:32.210
> 
> 标签：knockout.js

我在我的 Html 中使用以下淘汰脚本：

```
<!-- kno ifnot: bla -->

 <tr><td>some stuff</td></tr>

<!-- /ko --> 
```

我遇到的问题是，在执行绑定之前，这一行将显示一两秒钟。

我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2012-11-01T01:04:31.310

这是一个简单的技巧。只需使您的根元素最初隐藏并将可见绑定设置为 true。

```
<div style="display: none;" data-bind="visible: true">
    <!-- the rest of your stuff -->
</div> 
```

当它被渲染时，在淘汰赛做它的事情之前，它最初会被隐藏。应用绑定后，剔除将覆盖样式并使其可见。

* * *

或者，您可以将视图放入脚本块中并通过模板对其进行实例化。脚本块不会被渲染，但会在敲除渲染模板时可见。

```
<!-- ko template: 'myView' --><!-- /ko -->
<script id="myView" type="text/html">
    <!-- the rest of your stuff -->
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-08T06:22:10.277

由于您想要的行为通常因页面而异 - 这就是我在布局/模板文件 (ASP.NET) 中所做的事情。

```
 <div class="ko-unbound" data-bind="css: { 'ko-unbound': false, 'ko-bound': true }">
    @RenderBody()
 </div> 
```

页面绑定时：

*   `ko-unbound`类从页面中删除（最初添加`class`属性）。
*   `ko-bound`类被添加到页面。

然后在不需要的内容是一个问题的页面中，我可以自定义 css 以显示或隐藏基于这两个类的东西。我还使用这种技术来显示“加载”图像，或者可能为元素施加最小高度。

```
.ko-unbound #storeWizard
{
    display: none;  // hide entire section when the page is binding
}

.ko-bound #loadingGraphic
{
    display: none;  // hide loading graphic after page is bound
} 
```

在测试期间，在应用绑定时，我添加了一个超时，以便我可以看到闪光灯。

```
 setTimeout(function ()
 {
     ko.applyBindings(RR.VM);

 }, 300); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T23:33:27.697

用这样的方式包装你的 html -

```
<div id="hideme" style="display:none">
</div> 
```

然后在您的 JavaScript 中，在您的应用绑定之后添加以下 jquery 行 -

```
$('#hideme').show(); 
```

这是我发现的最简单的方法。您可以使用一些淘汰赛绑定来做到这一点，但是您会失去保证的时间，因为您无法控制执行绑定的顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-10T09:04:50.720

[我在这里](https://github.com/knockout/knockout/issues/773)找到的另一个解决方案

```
<div id="binding-start" style="visibility:hidden" data-bind="attr: { 'style': 'visibility:visible' }" /> 
```

这具有优点或缺点，具体取决于您的需要 - 将为隐藏的内容保留空间。应用绑定时页面不会“跳转”。

# java - FileInputStream 从特定位置读取文件？

> ID：13168768
> 
> 赞同：0
> 
> 时间：2012-10-31T23:12:33.207
> 
> 标签：java

如果我将文本文件放在同一个项目文件夹中，程序可以毫无问题地读取它。但是我怎样才能让它从我电脑的某个地方读取文件（例如：在桌面中）

```
FileInputStream fstream = new FileInputStream("Contact.txt"); 
```

我将其更改为“C:...\Desktop\Contact.txt”）但出现错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:22:07.177

`\`将反斜杠 ( )更改为正斜杠 ( ) 或在文件路径中`/`使用双反斜杠 ( )。`\\`

```
 FileInputStream fstream = new FileInputStream("C:.../Desktop/Contact.txt"); 
```

或者

```
 FileInputStream fstream = new FileInputStream("C:...\\Desktop\\Contact.txt"); 
```

请注意：`\`是一个转义字符。如果您使用`\\`，它将使用 single`\`作为文字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:53:33.430

您应该使用`File.separator`而不是`/`和`\\`来分隔您的路径，因为这将适用于基于 Window 和 Unix 的系统。[这](https://stackoverflow.com/questions/2417485/file-separator-vs-slash-in-paths#answer-2417515)可能有助于说服你......！

# neo4j - Neo4j 索引和遗留数据

> ID：13168771
> 
> 赞同：4
> 
> 时间：2012-10-31T23:13:05.387
> 
> 标签：neo4j, cypher, gremlin

我有一个想要查询的旧数据集（以 GraphML 表示的[ENRON 数据）。](http://www.infochimps.com/datasets/enron-email-data-with-manager-subordinate-relationship-metadata)在相关问题的[评论中，](https://stackoverflow.com/questions/13148032/using-a-legacy-neo4j-database-with-grails#comment-17916717) [@StefanArmbruster](https://stackoverflow.com/users/158701/stefan-armbruster)建议我使用 Cypher 来查询数据库。我的查询用例很简单：给定消息 id（Message 节点的属性），检索具有该 id 的节点，并检索该消息的发送者和接收者节点。

似乎要在 Cypher 中执行此操作，我首先必须创建节点的索引。当从 graphML 文件加载数据时，有没有办法自动执行此操作？（我曾使用 Gremlin 加载数据并创建数据库。）

我还有一个数据的外部 Lucene 索引（我需​​要它用于其他目的）。有两个索引有意义吗？例如，我可以将 Neo4J 节点 ID 索引到我的外部索引中，然后根据这些 ID 查询图形。我担心的是这些 id 的持久性。（以此类推，不应将 Lucene 文档 ID 视为持久性。）

那么，我应该：

1.  在内部索引 Neo4j 图以使用 Cypher 查询消息 ID？（如果是这样，最好的方法是什么：用一些合适的咒语重新生成数据库以建立索引？在已经存在的数据库上建立索引？）

2.  将 Neo4j 节点 ID 存储在我的外部 Lucene 索引中并通过这些存储的 ID 检索节点？

**更新**

我一直在尝试让自动索引与 Gremlin 和嵌入式服务器一起工作，但没有运气。在[文档](http://docs.neo4j.org/chunked/snapshot/gremlin-plugin.html#rest-api-load-a-sample-graph)中它说

> 底层数据库是自动索引的，请参阅第 14.12 节，“自动索引”，因此脚本可以通过索引查找返回导入的节点。

但是当我在加载新数据库后检查图表时，似乎不存在任何索引。

[Neo4j 关于自动索引](http://docs.neo4j.org/chunked/snapshot/auto-indexing.html)的文档说需要进行大量配置。除了设置之外`node_auto_indexing = true`，您还必须对其进行配置

> 要真正自动索引某些东西，您必须设置应该索引哪些属性。您可以通过列出要索引的属性键来做到这一点。在配置文件中，使用 node_keys_indexable 和 relationship_keys_indexable 配置键。使用嵌入模式时，请使用 GraphDatabaseSettings.node_keys_indexable 和 GraphDatabaseSettings.relationship_keys_indexable 配置键。在所有情况下，该值都应该是要索引的属性键的逗号分隔列表。

那么 Gremlin 应该设置`GraphDatabaseSettings`参数吗？我尝试将地图传递给 Neo4jGraph 构造函数，如下所示：

```
 Map<String,String> config = [
        'node_auto_indexing':'true',
        'node_keys_indexable': 'emailID'
        ]
    Neo4jGraph g = new Neo4jGraph(graphDB, config);
    g.loadGraphML("../databases/data.graphml"); 
```

但这对索引创建没有明显影响。

**更新 2**

我没有通过 Gremlin 配置数据库，而是使用[Neo4j 文档](http://docs.neo4j.org/chunked/snapshot/auto-indexing.html)中给出的示例，这样我的数据库创建就像这样（在 Groovy 中）：

```
protected Neo4jGraph getGraph(String graphDBname, String databaseName) {
    boolean populateDB = !new File(graphDBName).exists();
    if(populateDB)
        println "creating database";
    else
        println "opening database";

    GraphDatabaseService graphDB = new GraphDatabaseFactory().
        newEmbeddedDatabaseBuilder( graphDBName ).
        setConfig( GraphDatabaseSettings.node_keys_indexable, "emailID" ).
        setConfig( GraphDatabaseSettings.node_auto_indexing, "true" ).
        setConfig( GraphDatabaseSettings.dump_configuration, "true").
        newGraphDatabase();
    Neo4jGraph g = new Neo4jGraph(graphDB);

    if (populateDB) {
        println "Populating graph"
        g.loadGraphML(databaseName);
    }

    return g;
} 
```

我的检索是这样完成的：

```
ReadableIndex<Node> autoNodeIndex = graph.rawGraph.index()
    .getNodeAutoIndexer()
    .getAutoIndex();
def node = autoNodeIndex.get( "emailID", "<2614099.1075839927264.JavaMail.evans@thyme>" ).getSingle(); 
```

这似乎奏效了。但是请注意，`getIndices()`对`Neo4jGraph`对象的调用仍然返回一个空列表。所以结果是我可以正确地使用 Neo4j API，但是 Gremlin 包装器似乎无法反映索引状态。表达式`g.idx('node_auto_index')`（记录在[Gremlin Methods](https://github.com/tinkerpop/gremlin/wiki/Gremlin-Methods)中）返回 null。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T05:11:05.933

自动索引是懒惰地创建的。也就是说 - 当您启用自动索引时，实际索引是在您索引您的第一个属性时首先创建的。确保在检查索引是否存在之前插入数据，否则它可能不会显示。

对于一些自动索引代码（使用编程配置），请参阅例如[https://github.com/neo4j-contrib/rabbithole/blob/master/src/test/java/org/neo4j/community/console/IndexTest.java](https://github.com/neo4j-contrib/rabbithole/blob/master/src/test/java/org/neo4j/community/console/IndexTest.java)（这适用于 Neo4j 1.8

/彼得

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T00:21:42.333

您是否尝试过自动索引功能？它基本上是您正在寻找的用例——不幸的是，它需要在您导入数据之前启用。（否则，您必须删除/添加属性以重新索引它们。）

[http://docs.neo4j.org/chunked/milestone/auto-indexing.html](http://docs.neo4j.org/chunked/milestone/auto-indexing.html)

# .net - 如何让 CodeDom 生成的类实现一个自引用的泛型接口

> ID：13168782
> 
> 赞同：3
> 
> 时间：2012-10-31T23:14:37.207
> 
> 标签：.net, generics, interface, code-generation, codedom

我正在生成[值对象](http://thatextramile.be/blog/2007/07/implementing-a-value-object/)，我想将我的方法从模板切换到[CodeDom](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)方法。

我希望我的类型实现一两个自引用通用接口（即`IEquatable<MyValueObject>`and `IComparable<MyValueObject>`）。

我已经能够通过执行字符串操作并调用等效的 来获得所需的结果`CodeTypeDeclaration.Members.Add("IEquatable<MyValueObject")`，但如果可能的话，我宁愿使用对象模型。有没有更好的方法或者字符串将是我最好的选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T08:22:16.320

您可以执行以下操作：

```
var type = new CodeTypeDeclaration("MyValueObject");
var iequatable = new CodeTypeReference(
    "IEquatable", new CodeTypeReference(type.Name));
type.BaseTypes.Add(iequatable); 
```

# android - Android 从文本字段中获取信息并进入网站进行登录

> ID：13168783
> 
> 赞同：0
> 
> 时间：2012-10-31T23:14:39.857
> 
> 标签：android, eclipse

我试图创建一个简单地将用户集成到 facebook 或 twitter 的应用程序。

以下代码将用户与 facebook 连接起来

```
import android.net.Uri;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Intent browserIntent = new Intent("android.intent.action.VIEW", Uri.parse("http://www.facebook.com"));
        startActivity(browserIntent);
    } 

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

现在我的问题是，我想向用户展示他们在其中输入用户名和密码的两个文本区域，然后将它们发送到 facebook 登录屏幕并在没有看到登录屏幕的情况下登录该人。

如果有人知道如何做到这一点，或者知道哪里有很好的教程，我们将不胜感激。

我知道 facebook 和 twitter 有应用程序，我只是将它们用作学习目的的示例。

此外，如果我要将链接更改为仅说一个您登录后可以查看 pdf 的站点。如何使 PDF 在该屏幕上可见而无需下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:37:53.897

您始终可以创建一个向 Facebook 登录页面提交请求的代理页面。您的页面可能如下所示：

```
<html>
<head>
<script type="text/javascript">
    function redirect() {
        document.forms["frmRedirect"].submit(); 
    }
</script>
</head>
<body onload="redirect();">
<form name="frmRedirect" action="https://www.facebook.com/login.php" method="POST">
<input type="hidden" name="email" id="email" value="<USERNAME>" />
<input type="hidden" type="password" name="pass" id="pass" value="<PASSWORD>" />
<input id="btnSubmit" type="submit" />
</form>
</body>
</html> 
```

我不相信 Facebook 有任何可以将用户名和密码传递给的查询字符串值，而且我不确定 Android SDK 是否有任何网络请求 API。如果他们这样做，那么你可能最好使用这些。尽管您可以完全控制请求，但您可以使用上述自己的代理页面。如果用户名和密码是动态的，就像您的情况一样，您可以轻松修改上述代码，因此它还包括对查询字符串值的支持。然后，您将修改 onload 函数以读取这些查询字符串值并将它们的值插入到电子邮件和传递字段中。

完成所有这些后，您只需从您的 android 应用程序而不是 facebook 直接打开您的代理页面。

此外，根据您的最终结果，您可能需要阅读他们的文档。[http://developers.facebook.com/](http://developers.facebook.com/)

# jsf - Primefaces：构建项目出现错误

> ID：13168787
> 
> 赞同：0
> 
> 时间：2012-10-31T23:15:07.300
> 
> 标签：jsf, maven, jsf-2, build, primefaces

我试图从[这里检查 PrimeFaces 源代码](http://primefaces.googlecode.com/svn/primefaces/trunk/)

但是当我尝试从它的 pom.xml 打开它并构建它时，会出现 187 个错误，就像 DataTable Class not found 或 Carousel... not found 等一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T05:42:19.450

检查出 pom.xml 所在目录中的源代码后，键入：

```
mvn install 
```

这应该下载所需的依赖项，编译源代码并打包二进制文件。最后你会看到类似的东西：

```
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 47 seconds
[INFO] Finished at: Thu Nov 01 06:33:24 CET 2012
[INFO] Final Memory: 41M/366M
[INFO] ------------------------------------------------------------------------ 
```

# php - Symfony2 中的遍历 Doctrine2 ODM/MongoDB 对象图无法填充 2 级对象中的属性

> ID：13168789
> 
> 赞同：1
> 
> 时间：2012-10-31T23:15:09.640
> 
> 标签：php, mongodb, symfony, doctrine-orm, doctrine-odm

我正在通过 Doctrine-ODM 将我原本可以工作的 Symfony2 应用程序转换为使用 MongoDB。我有绝大多数系统工作，但我无法让用户角色部分工作。我可以登录，但是没有附加到用户的角色。

相关的文档类都在这里，除了相关的内容外，所有内容都被剥离了。

用户

```
<?php

namespace XXXXX\UserBundle\Document;

use Doctrine\ODM\MongoDB\Mapping\Annotations as MongoDB;
use Doctrine\Common\Collections\ArrayCollection;
use XXXXX\UserBundle\Interfaces\UserInterface;

/**
 * 
 * @MongoDB\Document( collection="user")
 * 
 */
class User implements UserInterface {

    /**
     * @MongoDB\Id
     */
    protected $id;

    /**
     * @MongoDB\ReferenceMany(targetDocument="Group")
     */
    protected $groups;

    /**
     * Constructor
     */
    public function __construct() {
        $this->groups = new ArrayCollection();
        $this->salt = base_convert(sha1(uniqid(mt_rand(), true)), 16, 36);
    }

    public function getRoles() {
        $array = array();
        //parse the roles down to an array
        foreach ($this->getGroups() as $group) {
            /* @var $group Group */
            foreach ($group->getRoles() as $role) {
                /* @var $role Role */
                if(!$role->getName())
                    throw new \Exception('Role must exist in group: '.$group->getName().' with ID: '.$group->getId().'.');
                $array[$role->getName()] = $role->getName();
            }
        }
        sort($array);
        return $array;
    }

    /**
     * Get groups
     *
     * @return Doctrine\Common\Collections\Collection 
     */
    public function getGroups() {
        return $this->groups;
    }

} 
```

团体

```
<?php

namespace XXXXX\UserBundle\Document;

use Doctrine\ODM\MongoDB\Mapping\Annotations as MongoDB;
use XXXXX\UserBundle\Interfaces\UserInterface;
use XXXXX\UserBundle\Interfaces\RoleInterface;
use XXXXX\UserBundle\Interfaces\GroupInterface;
use Doctrine\Common\Collections\ArrayCollection;

/**
 * @MongoDB\Document( collection="user_group" )
 */
class Group implements GroupInterface {

    /**
     * @MongoDB\Id
     */
    protected $id;

    /**
     * @MongoDB\String
     * @var string 
     */
    protected $name;

    /**
     * @MongoDB\ReferenceMany(targetDocument="User")
     */
    protected $users;

    /**
     * @MongoDB\ReferenceMany(targetDocument="Role", inversedBy="groups")
     */
    protected $roles;

    /**
     * Constructor
     */
    public function __construct() {
        $this->users = new ArrayCollection();
        $this->roles = new ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Get roles
     *
     * @return Doctrine\Common\Collections\Collection 
     */
    public function getRoles()
    {
        return $this->roles;
    }
} 
```

角色

```
<?php

namespace XXXXX\UserBundle\Document;

use Doctrine\ODM\MongoDB\Mapping\Annotations as MongoDB;
use XXXXX\UserBundle\Interfaces\UserInterface;
use XXXXX\UserBundle\Interfaces\GroupInterface;
use XXXXX\UserBundle\Interfaces\RoleInterface;
use Doctrine\Common\Collections\ArrayCollection;

/**
 * @MongoDB\Document( collection="user_role")
 */
class Role implements RoleInterface {

    /**
     * @MongoDB\Id
     */
    protected $id;

    /**
     * @MongoDB\String
     * @var string 
     */
    protected $name;

    /**
     * @MongoDB\String
     * @var string 
     */
    protected $description;

    /** 
     * @MongoDB\ReferenceMany(targetDocument="Group", mappedBy="roles") 
     */
    protected $groups;

    /**
     * Set name
     *
     * @param string $name
     * @return RoleInterface
     */
    public function setName($name) {
        $this->name = $name;

        return $this;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName() {
        return $this->name;
    }

    public function getId() {
        return $this->id;
    }

    public function getDescription() {
        return $this->description;
    }

    public function setDescription($description) {
        $this->description = $description;
    }

} 
```

我使用fixture将数据加载到数据库中，MongoDB中的数据如下。（我剥离了额外的数据元素。）

用户。

```
{ "_id" : ObjectId("5091a7241311fae01f00000d"), "groups" : [  DBRef("user_group", ObjectId("5091a7241311fae01f00000b")),      DBRef("user_group", ObjectId("5091a7241311fae01f00000c")) ] } 
```

用户引用的组。（这是来自 Symfony2 运行的查询）

```
db.user_group.find({ "_id": { "$in": { "5091a7241311fae01f00000b":ObjectId("5091a7241311fae01f00000b"), "5091a7241311fae01f00000c": ObjectId("5091a7241311fae01f00000c") } } }).sort([ ]);

{ "_id" : ObjectId("5091a7241311fae01f00000b"), "name" : "Base.Users", "roles" : [ DBRef("user_role", ObjectId("5091a7241311fae01f000009")) ] }
{ "_id" : ObjectId("5091a7241311fae01f00000c"), "name" : "AdminPortal.Base", "roles" : [ DBRef("user_role", ObjectId("5091a7241311fae01f000009")),        DBRef("user_role", ObjectId("5091a7241311fae01f00000a")) ] } 
```

最后，组引用的角色。（也取自 Symfony2 运行的确切查询）

```
db.user_role.find({ "_id": { "$in": { "5091a7241311fae01f000009": ObjectId("5091a7241311fae01f000009") } } }).sort([ ]);
{ "_id" : ObjectId("5091a7241311fae01f000009"), "name" : "ROLE_USER", "description" : "Role required for all system users." } 
```

此外，调用用户的 getRoles() 函数中的异常并返回以下文本。

> 角色必须存在于组中：Base.Users，ID 为：5091a7241311fae01f00000b。

问题是角色正在从数据库中查询，但没有被填充到角色对象中。我可以验证它们是否正在加载，因为当我评论异常时，它将运行并尝试为每个组添加正确数量的角色。问题是角色的 name 属性设置为 NULL。角色对象本身是一个持久化和加载的对象，就像我执行 print_r($role);exit; 时一样。直接在 if 语句之前，我将得到教义对象展示的大量递归输出。唯一没有发生的是“名称”（和其他）属性没有从数据库中加载。

任何有关我如何解决此问题的见解将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T14:39:56.480

我能够确定解决方法。基本上，使用 find、findBy、findOneBy 等方便的函数似乎并没有设置对象进行遍历。通过修改加载函数以使用查询构建器而不是方便的函数“findOneBy”，我能够获得正确的结果。

我修改后的查询如下。希望这对将来的某人有所帮助。

```
/**
     * 
     * @param string $username
     * @return User|Null
     */
    public function findUserByUserName($username) {
        $qb = $this->createQueryBuilder();
        $qb->find($this->getClassName());
        $qb->field('username');
        $qb->equals($username);
        $query = $qb->getQuery();
        return $query->getSingleResult();
    } 
```

我想它可以更简洁，但我不得不把它拆开来调试它，然后继续我的生活。:)

# c# - EF5 Code First GUID 与 MySQL

> ID：13168792
> 
> 赞同：0
> 
> 时间：2012-10-31T23:15:33.040
> 
> 标签：c#, mysql, code-first, entity-framework-5, fluent-interface

我确定我只是遗漏了一些明显的东西，但我似乎无法让以下代码正常运行。

这是我使用 Guid 的 POCO 类之一：

```
public class Player
{
    public virtual Guid PlayerID { get; set; }
    public virtual int? GuildID { get; set; }

    public virtual int AccountNumber { get; set; }
    public virtual string UserName { get; set; }

    public virtual Guild Guild { get; set; }

    public virtual ICollection<Coordinate> Coordinates { get; set; }
} 
```

它使用 Fluent API 链接到它自己的配置类：

```
public class PlayerConfiguration : EntityTypeConfiguration<Player>
{
    public PlayerConfiguration()
    {
        ToTable("Players", "ACDB");

        Property(p => p.PlayerID)
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);

        Property(p => p.UserName).HasMaxLength(25);
    }
} 
```

然后将配置注册到 DbContext。

我得到的错误如下：列'PlayerID'的列说明符不正确

关于我哪里出错的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:20:47.997

我认为这里发生的是实体框架将`PlayerID`列创建为 GUID（MySql 中的 UUID），然后将`AUTO_INCREMENT`属性应用于它。

从[http://docs.oracle.com/cd/E17952_01/refman-5.5-en/numeric-type-attributes.html](http://docs.oracle.com/cd/E17952_01/refman-5.5-en/numeric-type-attributes.html)看来，这似乎`AUTO_INCREMENT`只对整数列有效，这可能就是您收到此错误的原因。

我认为在这里尝试的是将`PlayerID`Guid 更改为 int - 这至少应该缩小错误的原因。

**编辑 1**

从[Convert and modify a model field as an DataColumn object](https://stackoverflow.com/questions/7227812/convert-and-modify-a-model-field-as-an-datacolumn-object) and [Disabling identity (auto-incrementing) on integer primary key using code first](https://stackoverflow.com/questions/7206273/disabling-identity-auto-incrementing-on-integer-primary-key-using-code-first)你应该能够关闭自动递增：

```
HasKey(p => p.PlayerID)
Property(p => p.PlayerID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.None) 
```

**编辑 2**

至少在 SQL Server 上， using`Property(p => p.PlayerID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.None)`将导致在创建新行时插入一个空的 Guid（尽管假设它在其他地方会以这种方式表现似乎是合理的）。我能看到的唯一明智的解决方法是`PlayerID`在`Player`构造函数中填充：

```
public Player()
{
    this.PlayerID = Guid.NewGuid();
} 
```

# ruby-on-rails - 使用具有模型之间一对多关系的 Carrierwave

> ID：13168797
> 
> 赞同：5
> 
> 时间：2012-10-31T23:16:10.280
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, carrierwave, has-many

**阶段**

图像画廊应用程序。我有两个模型`Handcraft`和`Photos`. *一个手工艺品可能有很多照片*，假设我有这样的模型：

*   `Handcraft(name:string)`
*   `Photo(filename:string, description:string, ...)`

在`_form.html.erb`手工艺品中，有：

```
<%= form_for @handcraft, html: {multipart: true} do |f| %>
  # ... other model fields

  <div class="field">
    <%= f.label :photo %><br />
    <%= f.file_field :photo %>
  </div>

  # ... submit button
<% end %> 
```

`handcraft.rb`看起来像这样：

```
class Handcraft < ActiveRecord::Base
  attr_accessible :photo
  has_many :photos
  mount_uploader :photo, PhotoUploader
  # ... 
end 
```

`photo_uploader.rb`：

```
class PhotoUploader < CarrierWave::Uploader::Base

  include CarrierWave::RMagick

  storage :file

  def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end

  version :thumb do
    process :resize_to_limit => [100, 100]
  end

  def extension_white_list
    %w(jpg jpeg gif png)
  end
end 
```

**问题**

当我提交表单时，它会引发此错误：

```
NoMethodError (undefined method `photo_will_change!' for #<Handcraft:0xb66de424>): 
```

**问题**

在这种情况下，我应该如何使用/配置 Carrierwave？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-01T14:09:31.237

您需要将上传器安装在将存储文件名的字段上，因此您的模型应该看起来像

```
class Handcraft < ActiveRecord::Base
  attr_accessible :name
  has_many :photos
  # ... 
end

class Photo < ActiveRecord::Base
  attr_accessible :filename, :description
  mount_uploader :filename, PhotoUploader
  # ... 
end 
```

然后看起来您将通过手工表格创建照片，您应该添加

```
accepts_nested_attributes_for :photos 
```

在你的`Handcraft`课上

然后你的表格看起来像

```
<%= form_for @handcraft, html: {multipart: true} do |f| %>
  # ... other model fields

  <%= f.fields_for :photos do |photo| %>
    <%= photo.label :photo %><br />
    <%= photo.file_field :photo %>
  <% end %>

  # ... submit button
<% end %> 
```

对于显示照片字段的表单，您需要创建`Handcraft`实例`photos`，这可以在您的`new`方法中完成，`HandcraftsController`如下所示：

```
def new
  @handcraft = Handcraft.new
  4.times { @handcraft.photos.build }
end 
```

这将使表单中的 4 个（任意数字）字段可用，如果您希望用户以某种方式在表单中动态添加新照片，请查看[nested_form](https://github.com/ryanb/nested_form)

# java - JVM 如何知道在运行时在哪里捕获异常？

> ID：13168798
> 
> 赞同：8
> 
> 时间：2012-10-31T23:16:28.413
> 
> 标签：java, exception, exception-handling, jvm, stack-unwinding

据我了解，`throw`是一个原始的 jvm 命令。当它被调用时，JVM“检查当前调用堆栈是否可以捕获它”。如果不能，那么 java 几乎就像调用 return 一样简单地弹出调用堆栈。然后jvm“检查当前调用堆栈是否可以捕获它”等等递归。

我的问题：JVM 如何在算法上知道调用堆栈中的哪个位置可以捕获给定的异常？每个调用堆栈条目映射异常到代码块中是否存储元数据？堆中是否有一个静态数据结构以某种方式跟踪这一点？因为某处必须有数据来跟踪它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T23:20:12.160

[JVM 规范](http://docs.oracle.com/javase/specs/jvms/se7/html/index.html)对此有详细说明。

特别是，[第 4.7.3 节](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7.3)提供了有关异常表的详细信息，该表是一系列条目，说明在哪些指令之间捕获了哪些异常。[3.12 节](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-3.html#jvms-3.12)给出了一个具体的例子。

当然，如何将此元数据映射到 JIT 的本机代码是另一回事 - 并且是特定于实现的。例如，可能有一些从本地 JITted 代码中的每个指令位置返回到原始字节码位置的映射，此时可以查阅异常表以找到正确的处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-29T02:56:26.503

一般来说：当抛出异常时，JVM 会提取“调用堆栈”。这标识了在调用堆栈的每个级别上正在执行的字节码或机器指令，以及与该位置关联的类和方法。

然后，对于堆栈中的每个方法（从发生异常的方法开始并向后工作），JVM （在内部类对象中）查看方法的表，将 try/catch 范围映射到字节码/机器指令范围。

如果在表中找到方法的“匹配”，并且抛出的异常类型是在找到的范围内监视的类，则`catch`在将异常设置为某种参数后，控制权将转移到入口点位置，以便`catch`子句可以引用它。

如果在表中未找到“匹配”，则调用堆栈实际上被“弹出”，将下一个较早的方法放在堆栈顶部，并且上述在较早方法的 try/catch 表中搜索“匹配”范围重复。

这当然是过于简单化了。处理范围涉及很多额外的逻辑`finally`，例如，和几个“边缘”情况。

# datatable - 在 Meteor 中的异步填充数据表上调用函数

> ID：13168806
> 
> 赞同：0
> 
> 时间：2012-10-31T23:17:26.643
> 
> 标签：datatable, meteor

我正在使用 Meteor 和 jquery 数据表库。我有一张桌子，我正在使用这样的东西加载流星/车把：

```
<table>
{{each x}}
  // code to insert rows of data
{{/each}}
</table> 
```

一旦完全填充了数据，我需要在表上调用它以将其转换为可排序的表：

```
$('#tableID').dataTable(); 
```

一旦DOM完全加载并且数据在那里，当我从控制台调用它时它就可以工作，但是使用 Template.rendered() 不起作用，也不能用 .observe 监听更改，因为数据是在那个特定之前加载的视图被渲染。

我在哪里可以运行此代码以确保数据已完全加载，并且如果表中的数据有更新，它将再次运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:27:14.683

我找到了一种方法，在我将各个行拆分为模板后似乎可以工作 - 随着我继续调试它会更新（这当然不是理想的）。

```
Template.individualRow.rendered = function() {
  if (!$('#tableID').hasClass('initialized')) {
      $('#tableID').not('.initialized').addClass('initialized').dataTable();
  };
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T11:05:02.163

它打败了我，但我可以建议一种解决方法：不要使用handlbars的助手，并观察数据，当数据发生变化时，手动重新渲染模板，如下所示：</p>

```
<table id="tableID"></table>

<template name="yourTemplate">
    {{#each this}}
        <tr>....</tr>
    {{/each}}
</template>

var query = ...
query.observe({
    added: function () {
        manuallyRender();
    },
    changed: function () {
        manuallyRender();
    },
    ...
});
function manuallyRender() {
    // don't need Meteor.render here, because you don't need it to be reactive.
    var frag = $(Template.yourTemplate(query.fetch()));  
    $('#tableID').empty().append(frag).dataTable();    
} 
```

它应该可以工作，但也许不是最好的方法，有什么想法吗？

其实我觉得meteor还有很长的路要走...

# c# - 如何在 MVC 3 应用程序中将代码优先的存储库转换为数据库优先

> ID：13168811
> 
> 赞同：0
> 
> 时间：2012-10-31T23:17:38.333
> 
> 标签：c#, asp.net-mvc-3, repository-pattern, database-first

我对 MVC 3 很陌生，但对软件不熟悉，所以当我决定在 MVC 3 中启动应用程序时，我想让它可测试。所以我找到[了这篇](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)关于如何实现存储库模式的好文章。

在这篇文章的最后，他们提出了一个非常好的“通用存储库”，您可以将其重用于大多数对象，因为在正常情况下，我们都希望能够删除、创建、更新等。

一切工作正常（读取编译），直到我意识到我指向的是不久前使用“代码优先”方法创建的旧数据库上下文。从那时起，我决定采用“数据库优先”的方法，但我忘了删除这个旧上下文。所以我只是在存储库中更改上下文的名称，希望一切正常，但它不起作用。我的旧上下文是 DBContext，但我的新上下文似乎是 ObjectContext。我不确定2之间有什么区别。

我的通用存储库中的代码如下，关于 Set 和 Entry 方法的这 3 行有错误：

```
this.dbSet = context.Set<TEntity>();

if (context.Entry(entityToDelete).State == EntityState.Detached)

context.Entry(entityToUpdate).State = EntityState.Modified; 
```

这是存储库的完整代码

```
public class GenericRepository<TEntity> where TEntity : class
{
    internal RecettesMaisonDBEntities context;
    internal DbSet<TEntity> dbSet;

    public GenericRepository(RecettesMaisonDBEntities context)
    {
        this.context = context;
        this.dbSet = context.Set<TEntity>();
    }

    public virtual IEnumerable<TEntity> Get(
        Expression<Func<TEntity, bool>> filter = null,
        Func<IQueryable<TEntity>, IOrderedQueryable<TEntity>> orderBy = null,
        string includeProperties = "")
    {
        IQueryable<TEntity> query = dbSet;

        if (filter != null)
        {
            query = query.Where(filter);
        }

        foreach (var includeProperty in includeProperties.Split
            (new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries))
        {
            query = query.Include(includeProperty);
        }

        if (orderBy != null)
        {
            return orderBy(query).ToList();
        }
        else
        {
            return query.ToList();
        }
    }

    public virtual TEntity GetByID(object id)
    {
        return dbSet.Find(id);
    }

    public virtual void Insert(TEntity entity)
    {
        dbSet.Add(entity);
    }

    public virtual void Delete(object id)
    {
        TEntity entityToDelete = dbSet.Find(id);
        Delete(entityToDelete);
    }

    public virtual void Delete(TEntity entityToDelete)
    {
        if (context.Entry(entityToDelete).State == EntityState.Detached)
        {
            dbSet.Attach(entityToDelete);
        }
        dbSet.Remove(entityToDelete);
    }

    public virtual void Update(TEntity entityToUpdate)
    {
        dbSet.Attach(entityToUpdate);
        context.Entry(entityToUpdate).State = EntityState.Modified;
    }
} 
```

如果有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T05:15:15.307

听起来您没有使用 DbContext 代码生成器。

[http://blogs.msdn.com/b/adonet/archive/2011/09/28/ef-4-2-model-amp-database-first-walkthrough.aspx](http://blogs.msdn.com/b/adonet/archive/2011/09/28/ef-4-2-model-amp-database-first-walkthrough.aspx)

请注意，这有点过时了，因为他们将生成器重命名为将 4.x 和 5.x 版本分开。使用适合您情况的任何一种。

然后，由于您的上下文是 DbContext 派生的，因此您可以在存储库中使用它。

# jsp - JSP/JSF 在 Wndow 入口处初始化

> ID：13168814
> 
> 赞同：1
> 
> 时间：2012-10-31T23:18:13.050
> 
> 标签：jsp, jsf

我有：SP/JSF 网页 DelegateBean.jsp 关联的 bean DelegateBean.java

委托Bean.java：

```
String msg;

public DelegateBean() {}
  clearMsg();
  ...
}

public void clearMsg() {
   msg = "":
}
.. other methods 
```

当页面第一次打开时，会调用构造函数 DelegateBean()。

如果操作员按下页面上的命令按钮，刷新页面，则不调用构造函数（也不应该调用）；

如果操作员按下后退按钮，然后按下前进按钮，构造函数不会被调用（它可能不应该被调用）。

问题是：如何强制 clearMsg() 在从转发按钮（另一个网页）重新进入时执行，但在从自身重新进入时不执行（按下命令按钮）？

有没有好的（简单）例子？

谢谢，约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:04:21.690

看起来就像您的托管 Bean 一样，`@SessionScoped`并且只有在使用 bean 时用户第一次访问页面时才会调用构造函数。

在 JSF 2 中，这可以通过将 Managed Bean 更改为`@ViewScoped`.

```
@ManagedBean
@ViewScoped
public class Bean {

    public Bean() {
    }

    @PostConstruct
    public void init() {
        clearMsg();
    }
} 
```

BalusC 在这个答案中对 JSF Managed Bean 范围给出了很好的解释：[如何选择正确的 bean 范围？](https://stackoverflow.com/q/7031885/1065197). 另外，我建议您阅读答案底部的链接，以更好地理解这些概念。

* * *

`faces-config.xml`在 JSF 1.x 中，您应该将托管 Bean 配置为在文件中请求范围并`clearMsg`在`@PostConstruct public void init`方法中调用。请注意，这意味着`clearMsg`将在涉及创建托管 bean 类的每个请求（甚至是 ajax 请求）上调用该方法。为了解决这个问题，您应该提供有关如何以及何时在 JSF 代码中调用此 bean 的更多信息。默认情况下，您可以通过在会话中设置一个标志并在调用`clearMsg`方法（或只需要调用一次的方法）之前检查此标志来解决此问题。

```
public class Bean {

    public Bean() {
    }

    @PostConstruct
    public void init() {
        HttpSession session = ((HttpRequest)FacesContext.getCurrentInstance().
            getExternalContext().getRequest()).getSession();
        if (session.getAttribute("flag") == null) {
            clearMsg();
            //other methods...
        }
    }
} 
```

面配置

```
<managed-bean>
    <managed-bean-name>bean</managed-bean-name>
    <managed-bean-class>your.package.Bean</managed-bean-class>
<managed-bean-scope>request</managed-bean-scope> 
```

有一种方法可以通过`@ViewScoped`使用[`@KeepAlive`来自](http://livedemo.exadel.com/richfaces-demo/richfaces/keepAlive.jsf?c=keepAlive&tab=usage)`RichFaces 3`. 考虑到 bean 将一直处于活动状态，直到您通过显式重定向更改视图。基于此，代码将是这样的：

```
@KeepAlive
public class Bean {

    public Bean() {
    }

    @PostConstruct
    public void init() {
        //no need to use session flags
        clearMsg();
        //other methods...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:36:29.853

faces-config.xml 中 bean 的范围是什么？

正如您描述的问题，看起来是这样`session`，因为每个会话都在构造哪个 bean 而不是请求。

将范围更改为`request`，您可能应该很好。

根据与@BalusC 的讨论进行更新

上述`request`范围与要求相冲突`not to be called from the same page`

如果您使用的是 jsf 2.x，请将范围更改为`viewscope`.

更新#2

我认为看到您的要求，`jsf 1.2`并且不能更改 bean 的范围。

最简单的方法是添加`clearmessage()`对前进按钮内部操作的显式调用

# javascript - 使用 require.js 加载非 amd 模块

> ID：13168816
> 
> 赞同：9
> 
> 时间：2012-10-31T23:18:31.653
> 
> 标签：javascript, requirejs

目前，我正在将 require.js 用于一个有趣的项目，除了一个名为 prism.js 的代码语法高亮插件外，我的工作一切正常。我可以看到插件正在通过 chrome 中的网络选项卡拉出，但插件没有初始化。

我不确定这是一个需要问题还是插件是问题所在，并且想知道是否有人可以提供帮助。

这是我的 main.js：

```
require.config({
  // 3rd party script alias names
  paths: {
    // Core Libraries
    modernizr: "libs/modernizr",
    jquery: "libs/jquery",
    underscore: "libs/lodash",
    backbone: "libs/backbone",
    handlebars: "libs/handlebars",

    text: "libs/text",
    prism: "plugins/prism",

    templates: "../templates"
  },
  // Sets the configuration for your third party scripts that are not AMD compatible
  shim: {
    "backbone": {
      "deps": ["underscore", "jquery", "handlebars"],
      "exports": "Backbone"  //attaches "Backbone" to the window object
    }
  }
});

// Include Specific JavaScript
require(['prism', 'modernizr', 'jquery', 'backbone', 'routers/router', 'views/AppVIew' ],
  function(Prism, Modernizr, $, Backbone, Router, App) {
    this.router = new Router();
    this.App = new App();
  }
); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-01T00:08:57.677

更改 shim 部分以包括 prism，并确保它导出“Prism”：

```
shim: {
  "backbone": {
      "deps": ["underscore", "jquery", "handlebars"],
      "exports": "Backbone"  //attaches "Backbone" to the window object
  },
  "prism": {
      "exports": "Prism"
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-23T04:50:46.627

Handlebars 和 Prism 与 A​​MD（Asyncronous Module Definition）不兼容，因此您需要像下面一样自己**填充**它；

```
requirejs.config({
    shim: {
        'backbone': {
            "deps": ["underscore", "jquery", "handlebars"],
            "exports": "Backbone"  //attaches "Backbone" to the window object
        },
        'handlebars': {
            "exports": 'Handlebars'
        },
        'prism': {
            "exports": "Prism"
        }
    }
}); 
```

您可能希望查看 require.js shim 文档站点； [http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)

希望这会有所帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T23:30:24.770

棱镜也应该添加`shim`。就像主干一样，它不符合 AMD 标准，因此必须以相同的方式声明。

# objective-c - UISegmentedControl 分隔线图像未显示

> ID：13168817
> 
> 赞同：0
> 
> 时间：2012-10-31T23:18:38.500
> 
> 标签：objective-c, ios, cocoa-touch, uisegmentedcontrol

我有一个`UISegmentedControl`并且我正在尝试设置一个分隔符图像。图像是黑色的，大约 2 像素宽。

```
UIImage *divider = [UIImage imageNamed:@"ZSDivider.png"];
[self.segmentedControl setDividerImage:divider forLeftSegmentState:UIControlStateNormal rightSegmentState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
[self.segmentedControl setDividerImage:divider forLeftSegmentState:UIControlStateSelected rightSegmentState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
[self.segmentedControl setDividerImage:divider forLeftSegmentState:UIControlStateNormal rightSegmentState:UIControlStateSelected barMetrics:UIBarMetricsDefault]; 
```

我不想要任何花哨的分隔线，只是每个州都有一条黑线，但它根本没有出现。

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T01:20:52.777

您的分隔线图像与分段控件的高度相同吗？如果我没记错的话，如果分隔线与控件高度不匹配，UISegmentedControl 会出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T00:53:39.277

你确定 " `divider`" 和 " `self.segmentedControl`" 不为空吗？

这看起来是一个很好的错误检查机会：

```
UIImage *divider = [UIImage imageNamed:@"ZSDivider"];
if(divider)
{
    if(self.segmentedControl)
    {
        [self.segmentedControl setDividerImage:divider forLeftSegmentState:UIControlStateNormal rightSegmentState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
        [self.segmentedControl setDividerImage:divider forLeftSegmentState:UIControlStateSelected rightSegmentState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
        [self.segmentedControl setDividerImage:divider forLeftSegmentState:UIControlStateNormal rightSegmentState:UIControlStateSelected barMetrics:UIBarMetricsDefault];
    } else {
        NSLog( @"segmentedControl is NULL");
    }
} else {
    NSLog( @"divider image is NULL");
} 
```

# java - 阻止某些图形重绘

> ID：13168820
> 
> 赞同：2
> 
> 时间：2012-10-31T23:19:27.483
> 
> 标签：java, swing, graphics, paint, repaint

我完全被这个程序遇到的一个问题所困扰，我必须用秋千画一个城市。基本上我想要做的是让窗户不会改变每一帧。我已经尝试了几乎所有我能想到的东西，但还没有任何效果。

这是绘制所有内容的主要类

```
import java.applet.Applet;
import java.awt.*;
import java.util.*;
import javax.swing.JFrame;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionListener;

public class Skyline extends JFrame implements MouseMotionListener
{
    private int mX, mY; //Mouse cooddinates
    private Image mImage; //Image buffer
    //private Image mImage2; //Image buffer

    private int num = 0;

    private Building bldg1 = new Building(305, 110, 30);
    private Building bldg2 = new Building(380, 125, 170);
    private Building bldg3 = new Building(245, 200, 325);
    private Building bldg4 = new Building(470, 170, 555);
    private Building bldg5 = new Building(395, 200, 755);
    private Background bg = new Background();

    public void init ()
    {
    }

    public static void main(String []args)
    {
        Skyline f = new Skyline();

        f.setSize(1017, 661); //Sets size of window
        f.setTitle("Skyline"); //Sets title of window
        f.show();
    }

    public void paintOffscreen(Graphics page)
    {
        //Draws the background
        bg.draw(page);

        //Moving square
        num++;
        if (num > 1200)
            num = 0;
        page.setColor(Color.yellow);
        page.fillRect(num,100,100,100);

        //Draws the buildings
        bldg1.draw(page);
        bldg2.draw(page);
        bldg3.draw(page);
        bldg4.draw(page);
        bldg5.draw(page);

        //Mouse move square
        int s = 100;

        page.setColor(Color.yellow);
        page.fillRect(mX - s / 2, mY - s / 2, s, s);

        repaint();
    }

    //====================================BUFFER CODE========================================
    public void paint(Graphics g)
    {
        //Clear the buffer
        Dimension d = getSize();
        checkOffscreenImage();
        Graphics offG = mImage.getGraphics();
        offG.setColor(getBackground());
        offG.fillRect(0, 0, d.width, d.height);

        //Save frame to buffer
        paintOffscreen(mImage.getGraphics());

        //Draw the buffer
        g.drawImage(mImage, 0, 0, null);

    }

    private void checkOffscreenImage()
    {
        Dimension d = getSize();

        if (mImage == null || mImage.getWidth(null) != d.width || mImage.getHeight(null) != d.height)
            mImage = createImage(d.width, d.height);
    }
    //=======================================================================================

    //==================================MOUSE MOVE         CODE======================================
    public Skyline()
    {
        addMouseMotionListener(this);
        setVisible(true);
    }

    public void mouseMoved(MouseEvent me)
    {
        Graphics g = getGraphics();
        mX = (int) me.getPoint().getX();
        mY = (int) me.getPoint().getY();
        update(g);
        //repaint();
    }

    public void mouseDragged(MouseEvent me)
    {
        mouseMoved(me);
    }
    //=======================================================================================

} 
```

* * *

这是可能能够以某种方式修复的窗口类。

```
import java.applet.Applet;
import java.awt.*;
import java.util.Random;
import javax.swing.JFrame;

public class Windows extends JFrame
{
    private Random gen = new Random();
    private int height, width, locX;
    private int onOff = 0;

    public Windows()
    {
        height = 305;
        width = 110;
        locX = 30;
    }

    public Windows(int height, int width, int locX)
    {
        this.height = height;
        this.width= width;
        this.locX = locX;
    }

    public void draw(Graphics page)
    {
    page.setColor (Color.darkGray);

    page.fillRect (locX, 550 - height, width, height);

        for (int i = 550 - height + 5; i < 550; i += 15)
        {
            for (int x = locX + 5; x < locX + width; x += 15)
            {
                onOff = gen.nextInt(2);

                if(onOff == 0)
                    page.setColor(Color.black);
                else
                    page.setColor(Color.yellow);

                page.fillRect (x,i,10,10);
            }
        }
    }
} 
```

* * *

这是建筑类以防万一。

```
import java.applet.Applet;
import java.awt.*;
import javax.swing.JFrame;

public class Building extends JFrame
{
    private int height, width, locX;
    private int onOff;
    private Windows windows1;// = new Windows(height, width, locX);

    public Building()
    {
        height = 305;
        width = 110;
        locX = 30;

        windows1 = new Windows(height, width, locX);
    }

    public Building(int height, int width, int locX)
    {
        this.width = width;
        this.height = height;
        this.locX = locX;

        windows1 = new Windows(height, width, locX);
    }

    public void draw(Graphics page)
    {
    page.setColor (Color.darkGray);

    page.fillRect (locX, 550 - height, width, height);

    windows1.draw(page);
    }
} 
```

* * *

而 bg 类只是为了安全

```
import java.applet.Applet;
import java.awt.*;

public class Background extends Applet
{
    private int height, width;

    public Background()
    {
        height = 400;
        width = 2000;
    }

    public Background(int height, int width)
    {
        this.height = height;
        this.width = width;
    }

    public void draw(Graphics page)
    {
        //Draws the sky
        page.setColor(Color.cyan);
        page.fillRect(0,0,2000,2000);
        //Draws the grass
        page.setColor (Color.green);
        page.fillRect (0,500,width,height);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:42:33.153

很多事情立刻在我身上跳出来......

您正在尝试使用屏幕外缓冲区，但每次在屏幕上绘制时都会重新创建它...

```
public void paintOffscreen(Graphics page)
{
    //Draws the background
    bg.draw(page);

    //Moving square
    num++;
    if (num > 1200)
        num = 0;
    page.setColor(Color.yellow);
    page.fillRect(num,100,100,100);

    //Draws the buildings
    bldg1.draw(page);
    bldg2.draw(page);
    bldg3.draw(page);
    bldg4.draw(page);
    bldg5.draw(page);

    //Mouse move square
    int s = 100;

    page.setColor(Color.yellow);
    page.fillRect(mX - s / 2, mY - s / 2, s, s);

    repaint();
} 
```

此外，该方法中的最后一次调用是 to `repaint`。这是一个坏主意。这可能会导致您`paint`的方法一次又一次地被召回......

仅在需要更改时才渲染后备缓冲区会更好...

```
public void paint(Graphics g)
{
    super.paint(g); // YOU MUST CALL super.paint!!!!  

    //Clear the buffer
    Dimension d = getSize();
    checkOffscreenImage();

    //Draw the buffer
    g.drawImage(mImage, 0, 0, null);

}

private void checkOffscreenImage()
{
    Dimension d = getSize();

    if (mImage == null || mImage.getWidth(null) != d.width || mImage.getHeight(null) != d.height) {
        mImage = createImage(d.width, d.height);
        Graphics offG = mImage.getGraphics();
        offG.setColor(getBackground());
        offG.fillRect(0, 0, d.width, d.height);

        //Save frame to buffer
        paintOffscreen(offG);
        offG.dispose(); // If you create it, you must dispose of it...
    }
} 
```

现在，这将引发一些使缓冲区无效的问题。这可以通过覆盖`invalidate`和设置`mImage`来实现`null`

```
public void invalidate() {  
    mImage = null;
    super.invalidate();
} 
```

`JFrame`您正在从???扩展大部分组件

`Building`，`Window`并且`Background`没有自己的绘画（来自Swing的内容），您只是在调用该`draw`方法。无需从`JFrame`or扩展`JApplet`，它们对您的程序没有任何好处，只是混淆了问题。

您应该（很少）需要覆盖`paint`顶级容器，例如`JFrame`. 你最好使用类似的东西`JPanel`并覆盖该`paintComponent`方法，如果没有其他原因，它们（顶级容器）不是双缓冲的。

我会将 for 的逻辑移动`Skyline`到 a中`JPanel`，然后将其添加到 a`JFrame`中以进行显示-恕我直言

**更新**

我已经浏览了代码并更新了它以按照我认为应该的（基本）方式工作，并在此过程中发现了其他一些事情......

这是个坏主意……

```
 public void mouseMoved(MouseEvent me) {
        Graphics g = getGraphics();
        mX = (int) me.getPoint().getX();
        mY = (int) me.getPoint().getY();
        update(g);
        //repaint();
    } 
```

您永远不需要调用`update(Graphics)`，此外，`Graphics`您获得的上下文只是上次重绘的快照。这将大大减慢您的绘画过程，因为它会反复调用`paint`.

所以，这是我的看法...

```
public class Skyline extends JFrame {

    private int num = 0;
    private Building bldg1 = new Building(305, 110, 30);
    private Building bldg2 = new Building(380, 125, 170);
    private Building bldg3 = new Building(245, 200, 325);
    private Building bldg4 = new Building(470, 170, 555);
    private Building bldg5 = new Building(395, 200, 755);
    private Background bg = new Background();

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                Skyline f = new Skyline();

                f.setSize(1017, 661); //Sets size of window
                f.setTitle("Skyline"); //Sets title of window
                f.setVisible(true);
            }
        });
    }

    public Skyline() {
        setLayout(new BorderLayout());
        add(new SkyLinePane());
        setDefaultCloseOperation(EXIT_ON_CLOSE);
    }

    public class SkyLinePane extends JPanel {

        private Image mImage; //Image buffer
        private boolean painting = false;

        private int mX, mY; //Mouse cooddinates

        public SkyLinePane() {
            addMouseMotionListener(new MouseAdapter() {
                @Override
                public void mouseMoved(MouseEvent me) {
                    mX = (int) me.getPoint().getX();
                    mY = (int) me.getPoint().getY();
                    repaint();
                }
            });

        }

        protected void updateBuffer() {
            if (!painting && mImage == null) {
                painting = true;
                new BackgroundPainter(this).execute();
            }
        }

        //====================================BUFFER CODE========================================
        @Override
        public void paintComponent(Graphics g) {
            Dimension d = getSize();
            if (mImage != null) {
                g.drawImage(mImage, 0, 0, null);
            } else {
                updateBuffer();
            }
            g.setColor(Color.RED);
            g.drawOval(mX - 5, mY - 5, 10, 10);
        }
        //=======================================================================================

        protected void setBackground(Image image) {
            mImage = image;
            painting = false;
            repaint();
        }
    }

    public class BackgroundPainter extends SwingWorker<Image, Image> {

        private SkyLinePane skyLinePane;

        public BackgroundPainter(SkyLinePane skyLinePane) {
            this.skyLinePane = skyLinePane;
        }

        @Override
        protected Image doInBackground() throws Exception {
            Dimension d = skyLinePane.getSize();

            Image backgroundBuffer = null;
            if (d.width > 0 && d.height > 0) {

                System.out.println("Paint offscreen...");
                backgroundBuffer = createImage(d.width, d.height);
                Graphics offG = backgroundBuffer.getGraphics();
                offG.setColor(getBackground());
                offG.fillRect(0, 0, d.width, d.height);

                //Save frame to buffer
                paintOffscreen(offG);

                offG.dispose();
                System.out.println("Done Paint offscreen...");

            }

            return backgroundBuffer;
        }

        @Override
        protected void done() {
            try {
                skyLinePane.setBackground(get());
            } catch (ExecutionException exp) {
                exp.printStackTrace();
            } catch (InterruptedException exp) {
                exp.printStackTrace();
            }
        }

        public void paintOffscreen(Graphics page) {
            //Draws the background
            bg.draw(page);

            //Moving square
            num++;
            if (num > 1200) {
                num = 0;
            }
            page.setColor(Color.yellow);
            page.fillRect(num, 100, 100, 100);

            //Draws the buildings
            bldg1.draw(page);
            bldg2.draw(page);
            bldg3.draw(page);
            bldg4.draw(page);
            bldg5.draw(page);
        }
    }

    //=======================================================================================
    public class Windows {

        private Random gen = new Random();
        private int height, width, locX;
        private int onOff = 0;

        public Windows() {
            height = 305;
            width = 110;
            locX = 30;
        }

        public Windows(int height, int width, int locX) {
            this.height = height;
            this.width = width;
            this.locX = locX;
        }

        public void draw(Graphics page) {
            page.setColor(Color.darkGray);

            page.fillRect(locX, 550 - height, width, height);

            for (int i = 550 - height + 5; i < 550; i += 15) {
                for (int x = locX + 5; x < locX + width; x += 15) {
                    onOff = gen.nextInt(2);

                    if (onOff == 0) {
                        page.setColor(Color.black);
                    } else {
                        page.setColor(Color.yellow);
                    }

                    page.fillRect(x, i, 10, 10);
                }
            }
        }
    }

    public class Building {

        private int height, width, locX;
        private int onOff;
        private Windows windows1;// = new Windows(height, width, locX);

        public Building() {
            height = 305;
            width = 110;
            locX = 30;

            windows1 = new Windows(height, width, locX);
        }

        public Building(int height, int width, int locX) {
            this.width = width;
            this.height = height;
            this.locX = locX;

            windows1 = new Windows(height, width, locX);
        }

        public void draw(Graphics page) {
            page.setColor(Color.darkGray);

            page.fillRect(locX, 550 - height, width, height);

            windows1.draw(page);
        }
    }

    public class Background {

        private int height, width;

        public Background() {
            height = 400;
            width = 2000;
        }

        public Background(int height, int width) {
            this.height = height;
            this.width = width;
        }

        public void draw(Graphics page) {
            //Draws the sky
            page.setColor(Color.cyan);
            page.fillRect(0, 0, 2000, 2000);
            //Draws the grass
            page.setColor(Color.green);
            page.fillRect(0, 500, width, height);
        }
    }
} 
```

基本上，我将天际线的核心渲染移到了它自己的面板上，并用于`JComponent#paintComponent`渲染天际线。

我使用 a`SwingWorker`将后备缓冲区的渲染卸载到另一个线程，允许 UI 在渲染后备缓冲区时保持响应。

# java - Java Swing 设置 JPanel 大小

> ID：13168822
> 
> 赞同：2
> 
> 时间：2012-10-31T23:19:33.103
> 
> 标签：java, swing, layout, layout-manager

谁能指出我在使用这个 java swing gui 代码时哪里出错了。我正在尝试向 JPanel 添加两个按钮，然后在设置大小后将其添加到框架中，但它似乎没有响应`setSize`传递给它的值

```
public Test() {
    GridLayout layout = new GridLayout(1, 2);
    //this.setLayout(layout);
    this.setSize(700, 700);
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    buttonPanel = new JPanel();
    buttonPanel.setSize(new Dimension(30, 100));

    JButton rectButton = new JButton("Rectangle");
    JButton ovalButton = new JButton("Oval");
    buttonPanel.add(rectButton);
    buttonPanel.add(ovalButton);
    this.add(buttonPanel);
    this.add(new PaintSurface());
    this.setVisible(true);  
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:27:39.507

这可能无法回答您的直接问题......但是......

```
GridLayout layout = new GridLayout(1, 2);
this.setLayout(layout);
// You're original code...
// Why are you using `BorderLayout.CENTER` on a `GridLayout`
this.add(new PaintSurface(), BorderLayout.CENTER); 
```

您将布局设置为`GridLayout`，但您正在使用`BorderLayout`约束来应用其中一个组件？？

另外，请确保`Test#pack`代码中没有对 else 的调用，因为这将覆盖`setSize`

**更新（从更改到问题）**

请记住，默认布局管理器`JFrame`是`BorderLayout`，因此即使您正在调用`buttonPanel.setSize`，它也可能开始被布局管理器覆盖。

我会阅读布局管理器[的可视化指南](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)和[使用布局管理](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)器，以找到最符合您要求的布局管理器。

如果您找不到单个，请考虑使用具有不同布局管理器的复合组件，以使布局更接近您想要实现的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:35:28.170

根据您更新的答案，您没有在任何东西上设置布局。

无论如何，如果你使用 LayoutManager（你应该这样做），调用它是没有意义的，`setSize()/setBounds()/setLocation()`因为它将被 LayoutManager 覆盖（这实际上是它的工作）。

并猜测您的`Test`类 extends `JFrame`，通过调用`this.add(buttonPanel); this.add(new PaintSurface());`您将具有相同约束的两个组件（`BorderLayout.CENTER`因为`BorderLayout`是 的内容窗格的默认 LayoutManager `JFrame`）添加到内容窗格。

考虑阅读[LayoutManager 教程](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)。

仅供参考，虽然远非完美，但这显示了一些“工作”：

```
import java.awt.Dimension;
import java.awt.GridLayout;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Test extends JFrame {
    private JPanel buttonPanel;

    public class PaintSurface extends JButton {
        public PaintSurface() {
            super("Paint surface dummy");
        }
    }

    public Test() {
        GridLayout layout = new GridLayout(1, 2);
        this.setLayout(layout);
        this.setSize(700, 700);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        buttonPanel = new JPanel();
        buttonPanel.setSize(new Dimension(30, 100));

        JButton rectButton = new JButton("Rectangle");
        JButton ovalButton = new JButton("Oval");
        buttonPanel.add(rectButton);
        buttonPanel.add(ovalButton);
        this.add(buttonPanel);
        this.add(new PaintSurface());
        this.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T23:38:30.667

好的，我只是给你一个解决方案：

```
import java.awt.Color;
import java.awt.EventQueue;
import java.awt.GridLayout;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Cobie extends JFrame{
    JButton rectButton = new JButton("Rectangle");
    JButton ovalButton = new JButton("Oval");

    JPanel buttonPanel = new JPanel();
    JPanel paintSurface = new JPanel();

    public Cobie(){
        setLayout(new GridLayout(2,1));
        buttonPanel.setBackground(Color.RED);
        paintSurface.setBackground(Color.BLUE);
        buttonPanel.add(rectButton);
        buttonPanel.add(ovalButton);
        add(buttonPanel);
        add(paintSurface);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable(){
            public void run(){
                Cobie c = new Cobie();
                c.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                c.setSize(600,400); //Avoid using this method
                c.setVisible(true);
            }
        });

    }
} 
```

# boost-graph - 使用 BGL 的图形水平化

> ID：13168823
> 
> 赞同：2
> 
> 时间：2012-10-31T23:19:40.877
> 
> 标签：boost-graph

您能否发布示例代码以使用 BGL 对有向图进行平整化？水平化的定义：顶点有一个属性“int level”。在图的 BFS 遍历期间，当“检查”一个顶点时，查看其前一个顶点的级别，取其中的最大值，递增，并将其分配给该顶点的“级别”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-18T22:47:38.547

如果您指的是 BFS 深度，那么这已经内置以提高 BFS 并且可以轻松获得。

只需使用一个向量来存储深度和一个深度 BFS 访问者，就像我制作的这个示例一样：

```
#include <iostream>
#include <vector>

#include <boost/graph/adjacency_list.hpp>
#include <boost/graph/graph_traits.hpp>
#include <boost/graph/breadth_first_search.hpp>

using namespace std;
using namespace boost;

typedef adjacency_list < vecS, vecS, directedS,
                    property< vertex_index_t, size_t> ,
                    property< edge_index_t, size_t > > Graph;

typedef graph_traits<Graph>::vertex_descriptor Vertex;
typedef graph_traits<Graph>::edge_descriptor Edge;

int main(int argc, char* argv[]){

    Graph G;

    vector<Vertex> verts;

    for(size_t i = 0; i < 9; ++i){
        Vertex v = add_vertex(G);
        verts.push_back(v);
    }

   /*
    0          0
             /  \
    1        1    4
           /      \
    2      2        5
         /          \
    3   3            6
                      \
    4                  7
                        \
    5                    8
   */
    add_edge(verts.at(0),verts.at(1),G);
    add_edge(verts.at(1),verts.at(2),G);
    add_edge(verts.at(2),verts.at(3),G);
    add_edge(verts.at(0),verts.at(4),G);
    add_edge(verts.at(4),verts.at(5),G);
    add_edge(verts.at(5),verts.at(6),G);
    add_edge(verts.at(6),verts.at(7),G);
    add_edge(verts.at(7),verts.at(8),G);

    cout << "vertices " << num_vertices(G) << endl;
    cout << "edges    " << num_edges(G) << endl;

    //store depths
    vector<size_t> d(num_vertices(G));

    //get an index map, from Graph definition property< vertex_index_t, size_t>
    typedef boost::property_map< Graph, boost::vertex_index_t>::type VertexIndexMap;
    VertexIndexMap v_index = get(boost::vertex_index, G);

    // Create the external property map, this map wraps the storage vector d
    boost::iterator_property_map< std::vector< size_t >::iterator, VertexIndexMap >
        d_map(d.begin(), v_index);

    //Start at 0
    boost::breadth_first_search(G, verts.at(0),
        boost::visitor(boost::make_bfs_visitor(
          boost::record_distances(d_map, boost::on_tree_edge())
          )));

    cout << "Starting at 0" << endl;

    for(size_t i = 0; i < 9; ++i){
        //depth (level) of BFS
        cout << "vertex " << i << "\t" << d.at(i) << endl; 
    }

    vector<size_t> d2(num_vertices(G));

    cout << "Starting at 4" << endl;

    // Create the external property map, this map wraps the storage vector d
    boost::iterator_property_map< std::vector< size_t >::iterator, VertexIndexMap >
        d2_map(d2.begin(), v_index);

    //start at 4
    boost::breadth_first_search(G, verts.at(4),
        boost::visitor(boost::make_bfs_visitor(
          boost::record_distances(d2_map, boost::on_tree_edge())
          )));

    for(size_t i = 0; i < 9; ++i){
        //depth (level) of BFS
        cout << "vertex " << i << "\t" << d2.at(i) << endl; 
    }

} 
```

输出应如下所示：
顶点 9
边 8
从 0
顶点开始 0 0
顶点 1 1
顶点 2 2
顶点 3 3
顶点 4 1
顶点 5 2
顶点 6 3
顶点 7 4
顶点 8 5
从 4
顶点开始 0 0
顶点 1 0
顶点2 0
顶点 3 0
顶点 4 0
顶点 5 1
顶点 6 2
顶点 7 3
顶点 8 4

当您从 4 开始时，其他顶点不可到达（定向），因此向量包含默认值（在本例中为 0）。这也适用于无向。

# c# - 模型绑定不适用于表达式 x=>x.InputModel.PropertyName

> ID：13168825
> 
> 赞同：0
> 
> 时间：2012-10-31T23:19:53.317
> 
> 标签：c#, asp.net-mvc-4, model-binding, modelbinders

**控制器：**

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        var myViewModel = new CreateFavoriteListViewModel();
        var favoriteTypeDropdownList = new List<SelectListItem>();
        favoriteTypeDropdownList.Add(new SelectListItem { Text = "Text1", Value = "1" });
        favoriteTypeDropdownList.Add(new SelectListItem { Text = "Text2", Value = "2" });

        myViewModel.FavoriteTypeDropdownList = favoriteTypeDropdownList;
        return View(myViewModel);
    }

    [HttpPost]
    public ActionResult Post(CreateFavoriteListInputModel createFavoriteListInputModel)
    {
        return new EmptyResult();
    }
} 
```

**楷模：**

```
public class CreateFavoriteListViewModel
{
    public CreateFavoriteListInputModel CreateFavoriteListInputModel { get; set; }
    public List<SelectListItem> FavoriteTypeDropdownList { get; set; }
}

public class CreateFavoriteListInputModel
{
    [Required]
    public string ListName { get; set; }
    public int SelectedFavoriteType { get; set; }
} 
```

**看法：**

```
@model MvcApplication3.Controllers.CreateFavoriteListViewModel
<h2>title</h2>

@using (Html.BeginForm("Post", "Home", FormMethod.Post))
{
    @Html.LabelFor(x => x.CreateFavoriteListInputModel.ListName)
    @Html.TextBoxFor(x => x.CreateFavoriteListInputModel.ListName)

    @Html.LabelFor(x => x.CreateFavoriteListInputModel.SelectedFavoriteType)
    @Html.DropDownListFor(x => x.CreateFavoriteListInputModel.SelectedFavoriteType, Model.FavoriteTypeDropdownList)
    <input type="submit" value="Save" id="btnCreateList" name="btnCreateList" />
} 
```

如您所见，我使用带有特殊 lambda 表达式的输入模型。( `x=>x.CreateFavoriteListInputModel.ListName`)。奇怪的问题是，这确实适用于我的家用计算机，但不适用于我的公司一台（`createFavoriteListInputModel = Null`）。似乎有不同版本的 ASP.NET MVC4 或类似的东西。

也许你们中的某些人知道，ASP.NET MVC 何时支持这种模型绑定。

我的代码对你有用吗？

如果我将视图模型和 Lamba 表达式更改为 ie`x=>x.ListName`一切都在两台计算机上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:04:23.060

我认为问题在于您传递给页面的模型与传递给控制器​​的模型之间的差异。

```
@model MvcApplication3.Controllers.CreateFavoriteListViewModel  <-- was passed to the page 
```

但`CreateFavoriteListInputModel`被传递给控制器​​ Post 动作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T11:55:22.563

我发现了问题。问题在这里：

```
[HttpPost]
public ActionResult Post(CreateFavoriteListInputModel createFavoriteListInputModel)
{
    return new EmptyResult(); // DOES WORK
} 
```

在我公司的机器上，我有这样的东西：

```
[HttpPost]
public ActionResult Post(CreateFavoriteListInputModel inputModel)
{
    return new EmptyResult(); // DOES NOT WORK
} 
```

**参数名称必须与复杂对象的名称相同`CreateFavoriteListInputModel`（不区分大小写）。**

**帖子参数：**

*   CreateFavoriteListInputModel.ListName=TestList
*   CreateFavoriteListInputModel.SelectedFavoriteType=1
*   btnCreateList=保存

我不明白为什么参数名称很重要？对于原始类型，这很清楚，但对于复杂类型，我不明白。

# c++ - C++ 命令行界面

> ID：13168833
> 
> 赞同：16
> 
> 时间：2012-10-31T23:20:59.813
> 
> 标签：c++, linux, command-line-interface

我目前正在设计一个 linux c++ 应用程序。它将从命令行运行，然后一旦运行，我需要能够发出命令来控制其执行，理想情况下如下所示：

```
$ sudo ./myapplication
APP > 
APP > 
APP > //just pressing return
APP > openlog test1.txt //APP will now call the openlog function
APP > 
```

我想这是一个相对简单的任务，但我不知道会调用什么这样的接口来搜索一个。有人知道可以执行此功能的库或示例吗？还是我需要使用 cout 和 cin 自己编写？如果是这样，是否有任何首选方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-31T23:47:58.660

我为此推荐 GNU readline 库。它负责获取输入行的繁琐工作，并允许用户使用退格键、左右箭头等编辑行，并使用向上箭头调用旧命令，甚至使用 ^R 搜索旧命令，等等。Readline 安装了典型的类 unix 发行版，如 linux，但如果你没有它，你可以在[这里](http://www.gnu.org/s/readline/)找到它。

编辑：这是一个最小的 readline 示例：

```
#include <stdio.h>
#include <readline/readline.h>
#include <readline/history.h>

int main(int argc, char ** argv)
{
    while(1)
    {
        char * line = readline("> ");
        if(!line) break;
        if(*line) add_history(line);
        /* Do something with the line here */
        free(line);
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-31T23:48:21.250

如果您想要完整的行编辑和历史功能， [GNU readline](http://www.gnu.org/software/readline/)库非常棒，但是如果一个简单的提示就足够了（或者如果您不想要 GNU 许可证），那么您可以只使用标准库来做到这一点：

```
#include <iostream>
#include <string>

void process(std::string const & line);

int main()
{
    for (std::string line; std::cout << "APP > " && std::getline(std::cin, line); )
    {
        if (!line.empty()) { process(line); }
    }

    std::cout << "Goodbye.\n";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-01T02:37:19.933

正如其他人所建议的那样，GNU readline 是迄今为止一个很好的选择。如果许可问题会迫使您将其排除，那么您应该考虑[linenoise](https://github.com/antirez/linenoise)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T23:44:52.750

您可能应该看一下[readline 库](http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html)。它有一点学习曲线，但它仍然比你自己重新创建一个完整的 CLI 容易得多。请检查许可，因为它可能不适合您的项目。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-01T00:00:15.510

我同意 Chris 的评论，即在没有反思性的语言中这会更难。在 C++ 中，您需要将您键入的任何内容显式映射到特定函数。

如果你要自己动手，你的一般设计应该是这样的：

*   读取输入行（很可能使用 cin.getline 到字符串中）
*   识别第一个单词并确定它是否映射到任何函数（例如，您可以使用简单的 switch 语句、哈希表等）
*   如果它没有映射到函数，请发布错误并重新打印提示。
*   如果它确实映射，您必须检查该行中的其他单词。
*   对于每个其他单词，您必须逐字将字符串转换为您想要的任何数据类型作为函数参数（字符串流在这里会派上用场）。
*   现在您必须确保您提供的参数对于您调用的函数是合法的。您可以在调用函数之前预先检查它们，或者检查函数内部的错误。
*   一旦你验证了你的函数名称和参数是正确的（并且是正确的数字），你就可以调用这个函数了。

在反射语言中，前半部分被大大简化了，因为您可以将字符串直接转换为函数名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-31T23:43:47.937

您将必须至少部分滚动自己的。GNU readline 可能会有所帮助；查看[http://en.wikipedia.org/wiki/GNU_readline](http://en.wikipedia.org/wiki/GNU_readline)以获得一个简短的程序，它是实现这一目标的“骨架”，您可以在其周围实际添加代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-09T22:59:33.207

有点晚了，但无论如何...

只是为了让您了解专门为此需求设计 的**CLI 工具包项目：http:** [//sourceforge.net/projects/aroyer-cli/](http://sourceforge.net/projects/aroyer-cli/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-04T00:51:07.360

请注意 GNU Readline 的 GPL 许可。在答案中，人们提到了 GNU readline 的 GPL 许可证。在这个答案中，我想强调 GPL 许可证的含义——新用户/开发人员可能会忽略它。

[从https://en.wikipedia.org/wiki/GNU_Readline](https://en.wikipedia.org/wiki/GNU_Readline)复制的文本

> 选择 GPL 作为 GNU Readline 的许可证[编辑] GNU Readline 是一个自由软件库，它是根据 GNU 通用公共许可证 (GPL) 而不是 GNU 宽通用公共许可证 (LGPL) 授权的。自由软件库通常在 LGPL 下获得许可，例如 GNU C 库、GNU gettext 和 FLTK。
> 
> 在构建新应用程序时选择链接到 LGPL 许可库的应用程序开发人员在分发组合的结果应用程序时，需要将其使用的 LGPL 许可库保留在 LGPL 之下。组合应用程序中不包括 LGPL 许可库的部分可以保留在原始许可下。 [1] 这与选择使用 GPL 许可库来创建新应用程序的开发人员形成对比，在这种情况下，整个组合生成的应用程序在分发时需要根据 GPL 获得许可，以符合 GPL 第 5 节。 [2 ][3]
> 
> GNU Readline 的 GPL 许可证的含义[编辑] 应用程序更改其许可证以符合 GNU Readline 的 copyleft 条件的一个重要示例是 CLISP，它是 Common Lisp 的一个实现。最初于 1987 年发布，1992 年更改为 GPL 许可证，[4] 在 CLISP 的原作者之一布鲁诺·海布尔（Bruno Haible）和理查德·斯托曼（Richard Stallman）之间进行电子邮件交换后，斯托曼认为 [5] CLISP 中的 readline 链接意味着如果 Haible 希望分发使用 readline 的 CLISP 的实现，他必须根据 GPL 重新许可​​ CLISP。[6]
> 
> 希望实现命令行编辑功能但希望保持在许可许可下的软件项目可以使用获得许可许可的替代命令行编辑库。其中典型的是 BSD 许可的 libedit。一些应用程序，例如 MariaDB[7] 或 PHP[8]，允许用户在构建时选择是与 GNU Readline 还是与 libedit 链接。其他命令行编辑库有双重用途：它们具有与某些主要项目的 API 保持一致的 API，并具有兼容的许可条款。这方面的一个例子是 Haskeline 库，它向 Glasgow Haskell 编译器 [9] 和其他需要行编辑服务的 Haskell 项目公开了与 Haskell 兼容的 API。 [10]
> 
> 外部链接中列出了几个此类库的链接。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-05-17T13:23:16.790

这个[库](https://github.com/GrossoMoreira/shpp)似乎完全符合 OP 的要求：

它本质上是 readline 库的包装器，但是将函数的参数解析/转换为它们各自的类型：

```
shpp::service svc;
svc.provide_command("my_function", [](int arg1, string arg2) -> { /* Do Something */ });
shpp::shell sh(svc);
sh.start(); 
```

它适用于函数指针和 lambda。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-10-31T23:23:24.240

您可以将您的应用程序编写为 TCL 或 python 应用程序并将它们用作前端。

# ruby - Fancybox 将 blob 显示为字符串而不是图像（Ruby 问题？）

> ID：13168836
> 
> 赞同：0
> 
> 时间：2012-10-31T23:21:51.730
> 
> 标签：ruby, string, image, fancybox, blob

我正在`img`使用以下方法在标签中显示从数据库获得的图像（存储为长 blob）：

```
<img src="http://localhost:3000/show_image/265" /> 
```

show_image 函数从数据库中获取图像数据并使用该方法将其呈现给`img`标签。`send_data`

在`img`标签上应用 Fancybox 时，数据显示为 BLOB 数据而不是图像。

任何人都可以提出一个原因吗？或者我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T09:16:22.307

1）您必须将 fancyBox 应用于链接（而不是图像），并且结构应该是这样的 -

`<a class="fancybox" href="big_image"><img src="small_image" /></a>`

示例 - [http://jsfiddle.net/CYCeM/](http://jsfiddle.net/CYCeM/)。

好吧，实际上可能只有图像，但是你必须使用“data-fancybox-href”属性来指定大的 - [http://jsfiddle.net/6ZSWB/](http://jsfiddle.net/6ZSWB/)

2）看起来脚本无法从您的 href 中猜测内容类型。你必须要么 -

a) 创建具有扩展名的链接，例如“http://localhost:3000/show_image/265.jpg”

b) 为 fancybox 设置内容类型，例如 -`$('.fancybox').fancybox(type : 'image');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T15:40:14.507

设置 :type => "image/jpg" 解决了这个问题。我查看了 MIME 内容类型，发现它写错了。

# javascript - 我的弹出窗口在 jsfiddle 中有效，但在我的网站上无效

> ID：13168839
> 
> 赞同：1
> 
> 时间：2012-10-31T23:22:20.323
> 
> 标签：javascript, jquery, html, bpopup

我正在做一个小项目，我试图从一个按钮实现一个弹出窗口。我正在使用在此开发人员网站[bPopup](http://dinbror.dk/bpopup)上找到的代码。我在 JSFiddle 上玩过代码，它可以工作，但是当我将代码上传到我的网站时，它不起作用。我尝试使用引用 jquery 和 bpopup javascript 文件的方式，但仍然没有。我还研究了 DOM Ready 问题，我相信我在那里没问题，但也许我错了。

当我使用这三个文件运行站点时，输出是一个按钮，当我单击它时，没有任何反应，并且 iframe 中的视频显示在它下方（在我单击按钮之前）。提前感谢您的帮助！！

Html（文件名 blog.html，它是从我的 index.html 链接到的）：

```
 <!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="animate.css"/>
    <script src="bPopup.js"></script>
    <script src="jquery-1.8.2.min.js"></script>
    <meta name ="viewport" content = "width=640, user-scalable=yes">
    <title>OneLine</title>
</head>
<body>
    <!-- Button that triggers the popup -->
    <button id="my-button">POP IT UP</button>
    <!-- Element to pop up -->
    <div id="element_to_pop_up">
      <a class="bClose"></a>
     <iframe width="280" height="157.5" src="http://www.youtube.com/embed/iw8wDinJxBQ" frameborder="0" allowfullscreen></iframe>
    </div>
</body>
</html> 
```

CSS（文件名 animate.css）：

```
/* PopUp Window */ 
#element_to_pop_up {
    background-color:#000000;
    border-radius:15px;
    color:#000;
    display:none;
    padding:20px;
    min-width:300px;
    min-height: 400px;
}
.bClose{
    cursor:pointer;
    position:absolute;
    right:10px;
    top:5px;
} 
```

Javascript（文件名 bPopup.js）：

```
 // Semicolon (;) to ensure closing of earlier scripting
    // Encapsulation
    // $ is assigned to jQuery
    ;(function($) {

         // DOM Ready
        $(function() {

            // Binding a click event
            // From jQuery v.1.7.0 use .on() instead of .bind()
            $('#my-button').on('click', function(e) {

                // Prevents the default action to be triggered.
                e.preventDefault();

                // Triggering bPopup when click event is fired
                $('#element_to_pop_up').bPopup();

            });

        });

    })(jQuery);

/*********************************************************************************
 * @name: bPopup
 * @author: (c)Bjoern Klinggaard (http://dinbror.dk/bpopup - twitter@bklinggaard)
 * @version: 0.7.0.min
 *********************************************************************************/
(function(b) {
    b.fn.bPopup = function(n, p) {
        function t() {
            b.isFunction(a.onOpen) && a.onOpen.call(c);
            k = (e.data("bPopup") || 0) + 1;
            d = "__bPopup" + k;
            l = "auto" !== a.position[1];
            m = "auto" !== a.position[0];
            i = "fixed" === a.positionStyle;
            j = r(c, a.amsl);
            f = l ? a.position[1] : j[1];
            g = m ? a.position[0] : j[0];
            q = s();
            a.modal && b('<div class="bModal ' + d + '"></div>').css({
                "background-color": a.modalColor,
                height: "100%",
                left: 0,
                opacity: 0,
                position: "fixed",
                top: 0,
                width: "100%",
                "z-index": a.zIndex + k
            }).each(function() {
                a.appending && b(this).appendTo(a.appendTo)
            }).animate({
                opacity: a.opacity
            }, a.fadeSpeed);
            c.data("bPopup", a).data("id", d).css({
                left: !a.follow[0] && m || i ? g : h.scrollLeft() + g,
                position: a.positionStyle || "absolute",
                top: !a.follow[1] && l || i ? f : h.scrollTop() + f,
                "z-index": a.zIndex + k + 1
            }).each(function() {
                a.appending && b(this).appendTo(a.appendTo);
                if (null != a.loadUrl) switch (a.contentContainer = b(a.contentContainer || c), a.content) {
                case "iframe":
                    b('<iframe scrolling="no" frameborder="0"></iframe>').attr("src", a.loadUrl).appendTo(a.contentContainer);
                    break;
                default:
                    a.contentContainer.load(a.loadUrl)
                }
            }).fadeIn(a.fadeSpeed, function() {
                b.isFunction(p) && p.call(c);
                u()
            })
        }
        function o() {
            a.modal && b(".bModal." + c.data("id")).fadeOut(a.fadeSpeed, function() {
                b(this).remove()
            });
            c.stop().fadeOut(a.fadeSpeed, function() {
                null != a.loadUrl && a.contentContainer.empty()
            });
            e.data("bPopup", 0 < e.data("bPopup") - 1 ? e.data("bPopup") - 1 : null);
            a.scrollBar || b("html").css("overflow", "auto");
            b("." + a.closeClass).die("click." + d);
            b(".bModal." + d).die("click");
            h.unbind("keydown." + d);
            e.unbind("." + d);
            c.data("bPopup", null);
            b.isFunction(a.onClose) && setTimeout(function() {
                a.onClose.call(c)
            }, a.fadeSpeed);
            return !1
        }
        function u() {
            e.data("bPopup", k);
            b("." + a.closeClass).live("click." + d, o);
            a.modalClose && b(".bModal." + d).live("click", o).css("cursor", "pointer");
            (a.follow[0] || a.follow[1]) && e.bind("scroll." + d, function() {
                q && c.stop().animate({
                    left: a.follow[0] && !i ? h.scrollLeft() + g : g,
                    top: a.follow[1] && !i ? h.scrollTop() + f : f
                }, a.followSpeed)
            }).bind("resize." + d, function() {
                if (q = s()) j = r(c, a.amsl), a.follow[0] && (g = m ? g : j[0]), a.follow[1] && (f = l ? f : j[1]), c.stop().each(function() {
                    i ? b(this).css({
                        left: g,
                        top: f
                    }, a.followSpeed) : b(this).animate({
                        left: m ? g : g + h.scrollLeft(),
                        top: l ? f : f + h.scrollTop()
                    }, a.followSpeed)
                })
            });
            a.escClose && h.bind("keydown." + d, function(a) {
                27 == a.which && o()
            })
        }
        function r(a, b) {
            var c = (e.width() - a.outerWidth(!0)) / 2,
                d = (e.height() - a.outerHeight(!0)) / 2 - b;
            return [c, 20 > d ? 20 : d]
        }
        function s() {
            return e.height() > c.outerHeight(!0) + 20 && e.width() > c.outerWidth(!0) + 20
        }
        b.isFunction(n) && (p = n, n = null);
        var a = b.extend({}, b.fn.bPopup.defaults, n);
        a.scrollBar || b("html").css("overflow", "hidden");
        var c = this,
            h = b(document),
            e = b(window),
            k, d, q, l, m, i, j, f, g;
        this.close = function() {
            a = c.data("bPopup");
            o()
        };
        return this.each(function() {
            c.data("bPopup") || t()
        })
    };
    b.fn.bPopup.defaults = {
        amsl: 50,
        appending: !0,
        appendTo: "body",
        closeClass: "bClose",
        content: "ajax",
        contentContainer: null,
        escClose: !0,
        fadeSpeed: 250,
        follow: [!0, !0],
        followSpeed: 500,
        loadUrl: null,
        modal: !0,
        modalClose: !0,
        modalColor: "#000",
        onClose: null,
        onOpen: null,
        opacity: 0.7,
        position: ["auto", "auto"],
        positionStyle: "absolute",
        scrollBar: !0,
        zIndex: 9997
    }
})(jQuery); 
```

所有文件都在我网站的同一目录中。

编辑：这些是我在运行控制台错误时遇到的错误

```
[18:14:51.018] GET http://www.onelineco.net/Blog.html [HTTP/1.1 200 OK 47ms]
[18:14:51.076] GET http://www.onelineco.net/animate.css [HTTP/1.1 304 Not Modified 68ms]
[18:14:51.077] GET http://www.onelineco.net/bPopup.js [HTTP/1.1 304 Not Modified 68ms]
[18:14:51.078] GET http://www.onelineco.net/jquery-1.8.2.min.js [HTTP/1.1 404 Not Found 78ms]
[18:14:51.106] ReferenceError: jQuery is not defined @ http://www.onelineco.net/bPopup.js:23
[18:14:51.201] GET http://www.onelineco.net/jquery-1.8.2.min.js [HTTP/1.1 404 Not Found 61ms]
[18:14:51.232] The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must to be declared in the document or in the transfer protocol. @ http://www.onelineco.net/Blog.html
[18:14:51.285] GET http://www.youtube.com/embed/iw8wDinJxBQ [HTTP/1.1 200 OK 141ms]
[18:14:51.386] Unrecognized at-rule or error parsing at-rule '@-moz-viewport'. @ http://www.youtube.com/embed/iw8wDinJxBQ:14
[18:14:51.386] Unrecognized at-rule or error parsing at-rule '@viewport'. @ http://www.youtube.com/embed/iw8wDinJxBQ:17
[18:14:51.391] Error in parsing value for 'filter'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.391] Unknown property '-moz-border-radius'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.391] Unknown property '-moz-box-shadow'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.391] Error in parsing value for 'background-image'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.391] Expected declaration but found '*'.  Skipped to next declaration. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.393] Expected media feature name but found '-webkit-min-device-pixel-ratio'. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.393] Unknown property 'box-sizing'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.393] Unknown property '-moz-border-radius-topleft'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.393] Unknown property '-moz-border-radius-bottomleft'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.411] Unknown property '-moz-border-radius-topright'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.411] Unknown property '-moz-border-radius-bottomright'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.411] Error in parsing value for 'cursor'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.413] Unknown property '-moz-background-size'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.416] Error in parsing value for 'background'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-embed-vflkVRvOv.css:1
[18:14:51.877] Expected declaration but found '*'.  Skipped to next declaration. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.877] Unknown property '-moz-border-radius'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.877] Error in parsing value for 'filter'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.877] Unknown property '-moz-box-shadow'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.877] Error in parsing value for 'background-image'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.879] Expected media feature name but found '-webkit-min-device-pixel-ratio'. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.879] Unknown property 'box-sizing'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.879] Unknown property '-moz-border-radius-topleft'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.879] Unknown property '-moz-border-radius-bottomleft'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.880] Unknown property '-moz-border-radius-topright'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.880] Unknown property '-moz-border-radius-bottomright'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.880] Error in parsing value for 'cursor'.  Declaration dropped. @ http://s.ytimg.com/yts/cssbin/www-player-actions-vflaifYoV.css:1
[18:14:51.886] Use of getAttributeNodeNS() is deprecated. Use getAttributeNS() instead. @ resource://dwhelper/util-service.jsm:567
[18:14:51.886] Use of attributes' ownerDocument attribute is deprecated. @ resource://dwhelper/util-service.jsm:567
[18:14:51.886] Use of attributes' nodeType attribute is deprecated. It always returns 2\. @ resource://dwhelper/util-service.jsm:571
[18:14:51.886] Use of attributes' firstChild attribute is deprecated. Use value instead. @ resource://dwhelper/util-service.jsm:580 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T01:23:58.400

您必须在依赖它的其他脚本之前加载 jQuery。

```
<script src="jquery-1.8.2.min.js"></script>
<script src="bPopup.js"></script> 
```

# c++ - 类的静态实例在程序退出时无法正确处理资源删除

> ID：13168840
> 
> 赞同：2
> 
> 时间：2012-10-31T23:22:48.590
> 
> 标签：c++, linux, static, destructor, gcc4.7

我今天在做我的项目时偶然发现了这一点。基本上，在我的项目中，我有类似于下面的资源处理。

```
class Resource {
public:
    static Resource instance_;
    ~Resource () {
        std::for_each(res_.begin(), res_.end(), [&] (Stuff *stuff) {
            delete stuff;
        });
    }
private:
    std::set<Stuff*> res_;
}; 
```

再次运行 valgrind，在程序退出时，我看到了一些非常神秘的错误。像这样的东西：

```
by 0x40DD42: std::_Rb_tree<unsigned int, std::pair<unsigned int const, std::pair<Vertex*, unsigned int> >, 
std::_Select1st<std::pair<unsigned int const, std::pair<Vertex*, unsigned int> > >, std::less<unsigned int>, 
std::allocator<std::pair<unsigned int const, std::pair<Vertex*, unsigned int> > > >::equal_range(unsigned int const&)
\\ a lot, lot more to come... 
```

通读所有这些，似乎表明析构函数`Resource`正在释放已经释放的内存区域。

但是我的析构函数绝对正确地处理了事情。为了证明这一点，我将删除代码从析构函数中移到另一个成员函数中。所以，像这样：

```
class Resource {
public:
    static Resource instance_;
    ~Resource () { /* does nothing */ }
    void clear () {
        std::for_each(res_.begin(), res_.end(), [&] (Stuff *stuff) {
            delete stuff;
        });
    }
// ... more
}; 
```

然后，我只需在程序退出之前对静态实例调用 clear() 即可。现在，错误不再出现在 valgrind 中！

为了进一步证明这仅与程序死亡时静态实例死亡有关，我删除了静态实例。在我的程序启动时，我只是`Resource`在堆栈上分配了一个实例，而不是静态实例。`main()`在此更改之后，问题也消失了。

现在，我想知道为什么会这样？这和操作系统有关系吗？

我的猜测是，操作系统可能会在程序终止时尝试释放所有内容，而我的析构函数恰好在清理过程中启动，而不是之前。

这里有问题的操作系统是 Linux (Ubuntu 12.10)。编译器是 gcc 4.7.2。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T01:27:22.550

我正在运行 Xubuntu 12.10，我的 gcc 版本与你的匹配：

```
$ gcc --version
gcc (Ubuntu/Linaro 4.7.2-2ubuntu1) 4.7.2 
```

有了这个测试用例：

```
#include <set>
#include <algorithm>

class Thing {};

class Test {
public:
    static Test test;

    std::set<Thing*> things;

    ~Test() {
        std::for_each(things.begin(), things.end(), 
                      [&](Thing* thing){ 
                          delete thing; 
                      });
    } 
};

Test Test::test;

int main() {
    Test::test.things.insert(new Thing());
    Test::test.things.insert(new Thing());

    return 0;
} 
```

并`valgrind`报告一切都很好，4 个分配，4 个释放。如果你尝试相同的测试用例会发生什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T01:32:58.687

您忘记实现 [deep] 复制构造函数和关联的赋值运算符。

当您创建 的实例的副本时会发生什么`Resource`？第一个副本最终被破坏，然后第二个副本最终被破坏......每个副本的破坏都会导致`delete`相同指针的离子。不好。

简而言之，您忘记执行**三的规则**。在您的 C++ 书籍的词汇表中查找它，因为它肯定会在那里。

# c# - asp.net 抑制 Internet Explorer 错误对话框

> ID：13168841
> 
> 赞同：0
> 
> 时间：2012-10-31T23:22:52.427
> 
> 标签：c#, asp.net, ajax, error-handling

这应该只适用于 IE 8.0

在我的 asp.net 页面上，我按下保存按钮，它会通过一些服务器端代码。在服务器端代码出错时，在网页上，我得到标题为“此网页上的错误可能导致其无法正常工作”的 Internet Explorer 错误对话框。我确切地知道是什么导致服务器端出现此错误。

我的网页中没有尝试捕获处理。我将所有错误都冒泡到 Global.asax 并将它们记录在事件 Application_Error 中。

所以..我的问题是

**1\. 如何抑制弹出 Internet Explorer 错误对话框？**

**2\. 我如何在 Global.asax 中的 Application_Error 中重定向到另一个名为 GenericErrPage.aspx 的 asp.net 页面，在该页面中显示用户友好的自定义文本消息。**

请帮忙。谢谢。

![在此处输入图像描述](../Images/101bcf96eca89bdccb700ab8f66a178d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T01:07:18.137

我所要做的就是在 web.config 的 system.web 部分中添加以下行，它会阻止弹出对话框。此外，我能够在 Global.asax 文件的 Application_Error 中记录错误。

```
 <customErrors defaultRedirect="~/CustomError.aspx" mode="On" /> 
```

# ruby-on-rails-3 - Rails 3: As json with include 选项不考虑 as_json 对包含关联的重新定义

> ID：13168842
> 
> 赞同：0
> 
> 时间：2012-10-31T23:22:57.297
> 
> 标签：ruby-on-rails-3, json

我有两个模型。

```
Class ModelA < ActiveRecord::Base

  has_many :model_bs

end

Class ModelB < ActiveRecord::Base

  belongs_to :model_a

  def as_json(options = {})
    {
       :whatever => 'hello world'
    }
  end

end 
```

当我调用 时`model_a.as_json(:include => :model_b)`，我希望它返回一个包含所有 model_bs 的 json，它确实如此，但使用了我的 as_json 重新定义，它没有，因为它只使用默认值。有没有办法使用我自己的方法而不是原来的方法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T05:57:34.343

在 Rails 3 中， as_json 方法调用 serializable_hash 来获取属性哈希。它们共享相同的“选项”参数。在您的情况下，覆盖 serializable_hash 会产生预期的结果。

```
def serializable_hash(options = {})
  {:whatever => 'hello world'}
end 
```

但是，我的建议是，不要覆盖约定，而是对“super”的结果进行操作，就像：

```
 def serializable_hash(options = {})
  hash = super
  has[:name] = "hello world"
  hash
end 
```

# android - ActionBarSherlock：更改 homeAsUpIndicator 不起作用

> ID：13168843
> 
> 赞同：4
> 
> 时间：2012-10-31T23:23:02.707
> 
> 标签：android, android-actionbar, actionbarsherlock, android-xml

我想通过将以下样式应用于我的活动来更改向上图标，但它不起作用，但我仍然得到默认的黑色“<”图标。

谁能找出这里缺少的东西？

```
<style name="AppTheme.ActionBar" parent="@style/Theme.Sherlock.Light">
    <item name="actionBarStyle">@style/actionBarStyle</item>
    <item name="android:actionBarStyle">@style/actionBarStyle</item>
</style>

<style name="actionBarStyle" parent="@style/Widget.Sherlock.Light.ActionBar.Solid">
    <item name="android:background">@drawable/header_bar</item>
    <item name="background">@drawable/header_bar</item>

    <item name="android:homeAsUpIndicator">@drawable/up_indicator</item>
    <item name="homeAsUpIndicator">@drawable/up_indicator</item>
    <item name="android:displayOptions">homeAsUp|showHome</item>
    <item name="displayOptions">homeAsUp|showHome</item>

</style> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-31T23:27:47.167

如果我没记错的话，我通过将and元素移动到主题声明中~~来解决这个问题。~~换句话说，尝试：`android:homeAsUpIndicator``homeAsUpIndicator`

```
<style name="AppTheme.ActionBar" parent="@style/Theme.Sherlock.Light">
    <item name="actionBarStyle">@style/actionBarStyle</item>
    <item name="android:actionBarStyle">@style/actionBarStyle</item>
    <item name="android:homeAsUpIndicator">@drawable/up_indicator</item>
    <item name="homeAsUpIndicator">@drawable/up_indicator</item>
</style>

<style name="actionBarStyle" parent="@style/Widget.Sherlock.Light.ActionBar.Solid">
    <item name="android:background">@drawable/header_bar</item>
    <item name="background">@drawable/header_bar</item>
    <item name="android:displayOptions">homeAsUp|showHome</item>
    <item name="displayOptions">homeAsUp|showHome</item>
</style> 
```

~~不确定我是否也必须向上移动`displayOptions`，但您可能也想尝试一下，以防上述方法无法立即工作。~~

顺便说一句，我发现命名一种风格`AppTheme.ActionBar`，然后继承`Theme.Sherlock.Light`相当混乱。如果它是特定于 ActionBar 的样式，我会期望类似`Widget.Holo.Light.ActionBar`（或任何其他小部件样式）作为父级。如果这是你的主题，我会相应地命名它。当然取决于你。

* * *

**编辑：**杰克发表评论后更新了答案。

# c# - 上传 csv 文件，解析，然后将数据插入到 SQL 表中

> ID：13168846
> 
> 赞同：1
> 
> 时间：2012-10-31T23:23:10.820
> 
> 标签：c#, list, parsing, webforms

有一个带有上传按钮的网络表单来上传 csv 文件，然后我的代码需要解析文件并使用解析后的数据插入到 SQL 表中。是我为将数据解析到列表所做的正确操作，它没有为流读取器获取文件名。这是解析数据的最有效方法吗？我应该解析成数据表吗？

```
protected void UploadBtn_Click(object sender, EventArgs e)
{
    if (FileUpload.HasFile)
    {

        string filename = Path.GetFileName(FileUpload.FileName);
        List<string[]> ValuesToUpload = parseData(filename);

        //if (!Directory.Exists(ConfigurationManager.AppSettings["temp_dir"].ToString().Trim()))
        //{
        //    Directory.CreateDirectory(ConfigurationManager.AppSettings["temp_dir"].ToString().Trim());
        //}
        //FileUpload.SaveAs(ConfigurationManager.AppSettings["temp_dir"].ToString().Trim() + filename);
        //using (FileStream stream = new FileStream(ConfigurationManager.AppSettings["temp_dir"].ToString().Trim() + filename, FileMode.Open, FileAccess.Read, FileShare.Read))
    }
}
      public List<string[]> parseData(filename)
            {
             int j=0;
             List <string[]> members = new List<string[]>();
             try
             {
                using (StreamReader read = new StreamReader(filename))
                {
                    while (!read.EndOfStream)
                    {
                        string line = read.ReadLine();
                        string[] values = line.Split(',');
                        if(j==0)
                        {
                            j++;
                            continue;
                        }

                        long memnbr = Convert.ToInt64(values[0]);
                        int loannbr = Convert.ToInt32(values[1]);
                        int propval = Convert.ToInt32(values[2]);
                        members.Add(values);
                    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T02:01:29.943

使用[KBCsv](http://kbcsv.codeplex.com/)。我们每秒解析 40K 行，每秒跳过 70K+ 行。这是我见过的最快的。而且也很稳定。然后按照上面的建议手动生成 SQL。如果进行数据重新加载并以性能为目标，请运行多线程、无事务（仅限 MS SQL）。可以达到每秒 10K 行的导入速度，具体取决于您到数据库服务器的网络带宽。

不要解析到`DataTable`- 它非常慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:50:30.050

由于您要将数据插入到 SQL 表中，因此我首先创建一个表示该表的类并为每条记录创建一个新对象。（这是为了可见性）。

或者我可以使用以下方法（假设您使用的是 MS SQL Server） 1\. 动态插入查询

```
StringBuilder strInsertValues = new StringBuilder("VALUES");

your ParsingCode HERE..
string [] values = line.Split(',');
strInsertValues.AppendFormat("({0},{1},{2}),", values[0], values[1], values[2]);

end parse

using(SqlConnection cn = new SqlConnection(YOUR_CONNECTION_STRING)){
    SqlCommand cmd = cn.CreateCommand;
    cmd.CommandType = SqlCommandType.Text;
    cmd.CommandText = "INSERT INTO TABLE(Column1, Column2, Column3) " + strInsertValues.ToString().SubString(0, strInsertValues.Length);
    cn.Open();
    cmd.ExecuteNonQuery();

} 
```

2\. 使用 BulkCopy（推荐）创建一个代表您的 CSV 值的 DataSet 为解析的每一行添加一条新记录 为您的 DataSet 和 SQL 表创建 Column Mappings，使用 BulkCopy 对象插入您的数据。参考 BulkCopy：http: [//msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:54:45.617

不是真正的答案，但作为评论发布太长了......

看起来您正在丢弃解析的值（`memnbr`等...），您可以将 csv 解析代码显着减少为：

```
return 
 File
   .ReadLines(filename)
   .Skip(1)
   .Select(line => line.Split(','))
   .ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-01T11:08:15.643

下面的代码示例会将 CSV 数据批量插入到具有匹配列的暂存表中，然后执行存储过程以规范化服务器上​​的数据。

这比手动解析数据并逐行插入数据要高效得多。几个月前，我使用类似的代码向我们的数据库提交了 1,500,000 多条记录，并在几秒钟内对数据进行了规范化。

```
var sqlConnection = new SqlConnection(DbConnectionStringInternal);

// Bulk-import our unnormalized data from the .csv file into a staging table
var inputFileConnectionString = String.Format("Driver={{Microsoft Text Driver (*.txt; *.csv)}};Extensions=csv;Readonly=True;Dbq={0}", Path.GetDirectoryName(csvFilePath));
using (var inputFileConnection = new OdbcConnection(inputFileConnectionString))
{
    inputFileConnection.Open();

    var selectCommandText = String.Format("SELECT * FROM {0}", Path.GetFileName(csvFilePath));
    var selectCommand = new OdbcCommand(selectCommandText, inputFileConnection);
    var inputDataReader = selectCommand.ExecuteReader(CommandBehavior.CloseConnection);

    var sqlBulkCopy = new SqlBulkCopy(sqlConnection) { DestinationTableName = "Data_Staging" };    
    if (sqlConnection.State != ConnectionState.Open)
        sqlConnection.Open();

    sqlBulkCopy.WriteToServer(inputDataReader);    
}

// Run a stored-procedure to normalize the data in the staging table, then efficiently move it across to the "real" tables.
var addDataFromStagingTable = String.Format("EXEC SP_AddDataFromStagingTable");
if (sqlConnection.State != ConnectionState.Open)
    sqlConnection.Open();

using (var addToStagingTableCommand = new SqlCommand(addDataFromStagingTable, sqlConnection) { CommandTimeout = 60 * 20 })
    addToStagingTableCommand.ExecuteNonQuery();    

sqlConnection.Close(); 
```

# sencha-touch - 发出 Ajax 请求时没有记录

> ID：13168850
> 
> 赞同：0
> 
> 时间：2012-10-31T23:23:48.770
> 
> 标签：sencha-touch, sencha-touch-2

我正在尝试向服务器发出请求，但我没有收到任何记录。当我运行代码时，我没有收到任何错误消息，所以我假设我的代码正在运行，但是当在存储加载时执行回调函数时，我只会收到一条空白消息。

```
var proxy = Ext.data.proxy.Ajax.create({
           type:'ajax',
           url:loginHostUri,
           method:'POST',
           headers:{
               'Accept':'application/x-www-form-urlencoded'
           },
           extraParams:{
               grant_type:'password',
               username:username,
               password:psswd,
               client_id: consumerKey,
               client_secret: consumerSecret
           },
           reader:{
               type:'json',
               root:''
           }
       });

       var store = Ext.getStore('instance');
       store.setProxy(proxy);
       store.load({
           callback:function(records,operation,success){
               Ext.Msg.alert('INFO',records,Ext.emptyFn);
           },
           scope:this
       }); 
```

该消息只是空白，但我知道 Json 响应如下所示：

```
 {
           "":{
               "id":"2332123",
               "issued_at":"090342",
              " instance_url":"instance",
               "signature":"sig",
               "access_token":"access"
           }
       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T05:29:37.627

为商店定义字段或模型

```
store.setFields({name: 'id', name: 'issued_id' ...});(put this before store.load()) 
```

在回调下尝试和 console.log(records) 并回复你得到的......

# ruby - 如何在ruby main方法中返回整数

> ID：13168854
> 
> 赞同：1
> 
> 时间：2012-10-31T23:24:00.727
> 
> 标签：ruby

这是我的代码

```
if __FILE__ == $PROGRAM_NAME
  puts "tests"
  puts $PROGRAM_NAME
  return 1
end 
```

我正在尝试使用 ruby​​ 提供 git 预提交功能。而这个预提交需要一个整数返回。

当我运行这段 ruby​​ 代码时出现错误

```
`<main>': unexpected return (LocalJumpError) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:29:18.033

正如[@minitech 所说](https://stackoverflow.com/questions/13168854/how-to-return-integer-in-ruby-main-method#comment17919340_13168854)，您想使用[`exit`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-exit).

```
if __FILE__ == $PROGRAM_NAME
  puts "tests"
  puts $PROGRAM_NAME
  exit 1
end 
```

# xml - 按多个元素排序

> ID：13168858
> 
> 赞同：1
> 
> 时间：2012-10-31T23:24:35.577
> 
> 标签：xml, xslt, xslt-1.0

我熟悉 XSLT 的基础知识，但我遇到了一个我似乎无法弄清楚的奇怪情况。对于这么长时间，我深表歉意，但我非常感谢您能提供的任何帮助。

我想根据排序后的 Brand/Value/@Name 和 Docs/Value/@Name 的串联对 Level_5 节点进行排序，因此对 Level_5 进行排序

```
XML unsorted:
<Root att="x">
  <Level_1 Name="NEW Level">    
    <Level_2>      
      <Level_3 Name="nameLvl_3">        
        <Level_4>       
          <Level_5 Name="aa">
            <Brand>
              <Value Name="Text" Value="1" />
            </Brand>            
        <Docs>
              <Value Name="Pro" Value="2" />
              <Value Name="Numeric" Value="0.05" />
            </Docs>            
          </Level_5>              
          <Level_5 Name="aa">            
            <Text>
              <Val Id="1"/>
            </Text>
          </Level_5>
          <Level_5 Name="aa">
            <Brand>
              <Value Name="Text" Value="2" />
              <Value Name="Number" Value="1" />
              <Value Name="Long" Value="3" />
            </Brand>
          </Level_5>
        </Level_4>
      </Level_3>
    </Level_2>    
  </Level_1>
</Root> 
```

完成连接后，您应该有 ""、LongNumberText、TextNumericPro 和预期输出是：

```
<Root att="x">
  <level_1 Name="NEW Level">    
    <level_2>      
      <Level_3 Name="nameLvl_3">        
        <Level_4>
          <Level_5 Name="aa">            
            <Text>
              <Val Id="1"/>
            </Text>
          </Level_5>
          <Level_5 Name="aa">
            <Brand>
          <Value Name="Long" Value="3" />
      <Value Name="Number" Value="1" />
              <Value Name="Text" Value="2" />             
            </Brand>
          </Level_5>
          <Level_5 Name="aa">
            <Brand>
              <Value Name="Text" Value="1" />
            </Brand>            
    <Docs>          
              <Value Name="Numeric" Value="0.05" />
              <Value Name="Pro" Value="2" />
            </Docs>            
          </Level_5>
        </Level_4>
      </Level_3>
    </Level_2>    
  </Level_1>
</Root> 
```

我只能按 /Brand/Value/@Name 的第一个元素排序，但我不知道如何连接 Brand 和 Docs 中的其余属性，这是我正在使用的代码：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Level_3/Level_4/Level_5/Brand|Docs">
    <xsl:copy>
      <xsl:apply-templates>
        <xsl:sort select="@Name" data-type="text"/>
        <xsl:sort select="@Value" data-type="text"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <!--                                                    -->
  <xsl:template match="Level_2/Level_3/Level_4">
    <xsl:copy>  
      <xsl:apply-templates select="Level_5">
        <xsl:sort select="Brand|Docs/Value/@Name" data-type="text"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

但我只是对 Brand 或 Docs 中的第一个元素进行排序，请提供任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:48:27.203

在 XPath 1.0 表达式中可能有一种聪明的方法可以做到这一点，但我没有看到。更直接的方法是分两步处理数据。

首先编写一个执行近似身份转换的样式表：输入只是按原样写回输出，但是在每个 Level_5 元素上添加一个带有排序键的属性，通过处理所有适当的子元素来构造一个make-sort-key模式。

然后编写另一个样式表并使用 sort-key 属性来控制排序（如果您不想要它，请再次删除它）。

关于另一个主题：匹配模式`Level_3/Level_4/Level_5/Brand | Docs`不等同于`Level_3/Level_4/Level_5/Brand | Level_3/Level_4/Level_5/Docs`. 如果你的意思是后者，你需要一个不同的匹配模式。

# iphone - 更改选择视图的 UINavigationBar 字体大小

> ID：13168859
> 
> 赞同：2
> 
> 时间：2012-10-31T23:24:41.663
> 
> 标签：iphone, ios, uinavigationcontroller

我知道如何使用以下代码更改 UINavigationBar 的标题字体属性：

```
[self.navigationController.navigationBar setTitleTextAttributes:
 [NSDictionary dictionaryWithObjectsAndKeys:
  [UIFont boldSystemFontOfSize:16.0f], UITextAttributeFont, nil]]; 
```

但是，我发现当我以这种方式更改字体大小时，它会影响所有视图，而不仅仅是我实现上述代码的视图。问题是，我只想更改 2 个具有长标题的视图的大小。其他视图（包括根视图）我希望保留字体大小的默认设置。我已经尝试在使用上述代码的方法中将字体大小改回正常`viewDidLoad`，但它不起作用。

有没有办法改变某些视图的标题字体大小？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-01T00:22:43.823

`viewWillAppear:`您应该在每个视图控制器的方法中调用该代码。当您将其设置为 时`viewDidLoad`，该设置将被下一个视图控制器的操作覆盖。您可能还需要调用`setNeedsDisplay`navigationBar 来刷新它（尽管我不这么认为）。

像这样：

```
- (void)viewWillAppear:(BOOL)animated
{
     [super viewWillAppear:animated];
     [self.navigationController.navigationBar setTitleTextAttributes:
          [NSDictionary dictionaryWithObjectsAndKeys:
              [UIFont boldSystemFontOfSize:16.0f],
              UITextAttributeFont,
              nil]];
} 
```

# postgresql - 使用 `INSERT ... SELECT ... WHERE NOT IN(..)` 合并 PostgreSQL 中的两个表

> ID：13168860
> 
> 赞同：0
> 
> 时间：2012-10-31T23:24:57.420
> 
> 标签：postgresql, copy

全部，

我正在尝试使用 COPY TO 命令在表中批量插入一些数据，但我似乎无法解决唯一键错误。这是我的工作流程。

创建我要移动到另一台服务器的数据的转储

```
COPY (
  SELECT *
  FROM mytable
  WHERE created_at >= '2012-10-01')
    TO 'D:\tmp\file.txt' 
```

在目标数据库中创建一个新的“临时”表，然后像这样复制数据。

```
COPY temp FROM 'D:\tmp\file.txt' 
```

我现在想将数据从“临时”表移动到目标 DBlike 中的主表中。

```
 INSERT INTO master SELECT * FROM temp 
                WHERE id NOT IN (SELECT id FROM master) 
```

这运行正常，但没有插入任何内容，也没有更新任何字段。有谁知道这里可能发生了什么？temp 和 master 的架构是相同的。在这个问题上的任何帮助都会很棒！我正在使用 Postgresql 9.2

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:29:04.663

如果列表中有`null`值，就会发生这种情况`IN`。

在 SQL 中，`null`进行比较时总是存在 a `false`（您需要特殊`IN NULL`测试才能获得匹配）。如果有任何*值*`null`从`SELECT id FROM master`.

查看此查询是否返回任何行：

```
SELECT id
FROM master
WHERE id is null; 
```

如果不是，那么这*不是*你的问题。

如果有值，则修复方法是`null`从列表中排除 id：

```
INSERT INTO master
SELECT *
FROM temp 
WHERE id NOT IN (SELECT id FROM master where id is not null) 
```

另一件要考虑的事情是，根本就没有尚未插入的值！

# ruby-on-rails - 如何为不在数据库中的测试固定数据

> ID：13168862
> 
> 赞同：0
> 
> 时间：2012-10-31T23:25:04.377
> 
> 标签：ruby-on-rails

假设我想测试我的控制器行为，但它通过 GET 接受 JSON 字符串。

现在我的测试类@testJson 中有var，但是这些JSONS 有时会发生一些意想不到的事情（ie 中的坏字符）。所以我想添加另一个测试用例。

但是添加另一个 var @problematicJson1 （可能还有更多）似乎不是一个好主意。

保持这样的“固定装置”的最佳方法是什么？我应该将它们保存在文件中并加载它们吗？是否有一些我不知道的夹具功能可以提供帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T08:12:18.387

那些东西不是固定装置。

您应该使用 RSpec 的一个简洁功能（如果您完全使用 RSpec），它允许延迟定义变量，因此只有在特定“它”使用时才实例化实际变量，即使它是在外部“上下文”中定义的/描述”块。

[https://www.relishapp.com/rspec/rspec-core/v/2-6/docs/helper-methods/let-and-let](https://www.relishapp.com/rspec/rspec-core/v/2-6/docs/helper-methods/let-and-let)

```
context "some context" do
  let(:testJson) { put your json inside the block }
  let(:otherJson) { {:my_json => textJson} } # this will use the defined testJson

  it "something" do
    testJson.should have_key "blah"
  end

  context "some internal context"
    let(:testJson) { something else }

    it "some other test" do
      otherJson[:my_json].should .... 
      # this will use the local version of testJson
      # you only have to redefine the things you need to, unlike a before block
    end
  end
end 
```

# ios - 修改内置框架ios

> ID：13168863
> 
> 赞同：1
> 
> 时间：2012-10-31T23:25:21.303
> 
> 标签：ios, frameworks

我是一名开发 iOS 机器人应用程序的开发人员。我不打算将这个应用程序提交到应用程序商店，我也不希望建议的方法得到苹果的批准......

我正在尝试让蓝牙工作，我认为一个好的起点是尝试修改现有的苹果框架。我是否可以修改框架，以便在将它们构建到我的 iOS 设备时为应用程序修改框架（但不是同一设备上的其他应用程序）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:59:51.143

事实上，你可以！

Objective-C 允许你“调配”方法来覆盖它们的默认行为，但如果你愿意，仍然可以调用原始实现。您可以对任意数量的 Objective-C 方法执行此操作，次数不限。

如果您希望覆盖 C 函数中存在的行为，则需要对平台进行更多控制。越狱允许您使用 Jay Freeman 的 CydiaSubstrate 的全部功能来挂钩或混合 Objective-C 方法和 C/C++ 函数。

虽然我不建议使用`MethodSwizzle`本身，但以下 URL 对 swizzling [http://cocoadev.com/wiki/MethodSwizzling](http://cocoadev.com/wiki/MethodSwizzling)进行了很好的讨论。

但是你真的应该使用[CydiaSubstrate 的](http://iphonedevwiki.net/index.php/MobileSubstrate)MSHookMes​​sageEx 和 MSHookFunction 来代替。特别是因为您没有向 App Store 提交任何内容。

现在关于蓝牙，我已经在这个领域做了大量的工作（我开发了 Celeste，这是一个系统范围的调整，为 iOS 上的系统应用程序提供香草蓝牙 OBEX 支持）。我建议您考虑使用[BTstack 之](https://code.google.com/p/btstack/)类的东西，它可以让您访问从 HCI 到 RFCOMM 级别的蓝牙模块，并支持您可能需要的 SDP 和配对等功能。它还有一个额外的好处，那就是不需要方法混搭，有些人似乎认为这是某种邪恶的仪式，应该不惜一切代价避免。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:44:50.363

除了[类别](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)（扩展这些框架中提供的基类的功能）之外，我认为您不能“修改”现有的 Apple 框架本身。更好的做法可能是简单地创建您自己的框架（或找到其他人的开源、商业或只是第三方框架），然后将该框架构建到您安装到您想要使用的 iOS 设备上的应用程序中。

# python - 将python结果返回到html

> ID：13168865
> 
> 赞同：3
> 
> 时间：2012-10-31T23:26:04.463
> 
> 标签：python, html, beautifulsoup

我有一个test.html：

```
<form action="/cgi-bin/test.py" method="GET">
<input type="text" name="search">
<input type="submit" value="Submit">
</form>
<div id="res"></res> 
```

还有一个python脚本test.py：

```
#....
print Result
#.... 
```

我不想在 test.py 上打印结果，而是将其返回到 test.html 并将其写入 id 为 res 的 div 中......我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:43:14.353

```
<form id="myform">
<input id="my_text">
<button id="submit_btn">
</form>
<div id="result">
</div>
<script>
//you need to use jquery for this part
$("#submit_btn").click( function() {
    $("#result").load("/path/to/cgi?my_text="+$("#my_text").val())
})
</script> 
```

类似的东西......（这是真正的 hacky 1 分钟帖子，未经测试，因此可能需要一些工作......

你的问题真的与 python 无关......它只是网络技术问题......如果它是一个 php 或 C# 或任何处理表单数据的东西，它会是一样的

它与 python 无关，因为你如何处理表单数据无关紧要......这只是 web 技术，它与 perl 脚本而不是 python 脚本或使用 C# 而不是 python 或其他任何东西的工作方式完全相同...您想将一些数据返回到网页...您如何获取数据实际上并不相关

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
</head>
<body>
<form action="someother.html" method="get">
<input id="my_text">
<input type="button" id="my_button" value="click me">
</form>
<div id="result">

</div>
<script>
$("#my_button").click(function(){
     $("#result").load("");
})
</script>
</body>
</html> 
```

这是一个示例...只需将其粘贴到file.html中并转到它并单击按钮...它只是在加载自身`load("")`，因此当您单击它时它应该复制页面上的数据...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:31:10.070

好吧，我以这种方式理解了您的问题，也许您正在寻找其他东西，但我知道一种方法可以完全满足您的需求：Ajax。

只需向 cgi python 发出 ajax 请求并将响应放入 div 中。幸运的是，现在这很容易。

如果您对 jQuery（一个 javascript 框架）有所了解，您应该访问此链接以开始使用：http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery#Rate_me: [_Using_Ajax](http://docs.jquery.com/Tutorials%3aGetting_Started_with_jQuery#Rate_me%3a_Using_Ajax)

再见

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-02T12:18:48.487

```
print "Content-type:text/html\r\n\r\n"
print "<html>"
print "<head>"
print "<title>Hello - Second CGI Program</title>"
print "</head>"
print "<body>"
print "<h2>Hello World</h2>"
print "<p>Executing HTML code from python script</p>"
print "</body>"
print "</html>" 
```

# ruby-on-rails - 合并视频、音频和图像文件的最简单方法是什么？

> ID：13168866
> 
> 赞同：5
> 
> 时间：2012-10-31T23:26:08.787
> 
> 标签：ruby-on-rails, ruby, ffmpeg

我们正在为大约 2 周后的 Hackathon 计划一个 Wep 应用程序。该应用程序的基本功能是：

*   用户被逐步引导上传视频、音频和图像。
*   该图像用作音频的封面。制作成视频文件。
*   这两个视频文件被**合并**，从而从最初的三个文件创建了**一个视频。**

所以，我的问题是：

1.  如何从带有图像作为“封面”的音频创建视频。
2.  你如何合并这两个视频。

我们正在考虑使用 Heroku 进行部署。有没有办法使用类似[stremio](https://github.com/streamio/streamio-ffmpeg)的东西来做到这一点？

最好的方法是什么？运行 C++ 脚本的 VPS？最简单的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T15:44:27.400

FFMPEG 将是一个良好的开端，如此处所示 [https://stackoverflow.com/a/6087453/1258001](https://stackoverflow.com/a/6087453/1258001)

FFMPEG 可以在[http://ffmpeg.org/找到](http://ffmpeg.org/)

另一个可能过度杀戮的选项是 Blender 3d，因为它也可以提供类似的结果，并且可以通过 shell 命令进行控制，并且在资产组合的复杂需求方面可能更灵活。

在任何情况下，您都需要一台可以运行繁重的渲染进程的服务器，这将需要大量的内存和 CPU 处理。使用可以运行 gpu 作为渲染主处理器的渲染农场可能是一个不错的选择，因为这将为您带来更多收益，但可能很难设置并保持正确运行。我还要说 VPS 不是一个好的选择。在任何情况下，您需要的资源类型也恰好是 Web 服务器成本中最昂贵的。祝你好运，请更新你的结果。

# python - PyMySQL：查询大量行失败

> ID：13168869
> 
> 赞同：2
> 
> 时间：2012-10-31T23:26:28.567
> 
> 标签：python, mysql, pymysql

我正在使用 PyMySQL 执行一个非常简单的查询：

```
SELECT `id` FROM `records` ORDER BY `id` DESC 
```

`records`其中有超过 150 万行。`id`是主键。

这是 PyMySQL 的限制吗？如果我一次查询这么多行，还有什么我应该使用的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T00:05:50.187

您可以将查询分解为几个较小的查询：

```
from math import ceil

batch_size = 1000

for start_at in range(int(ceil(total_rows / 1000 * 1.0))):
    sql = 'SELECT `id` from `RECORDS` ORDER BY `id` DESC LIMIT %i, %i'
    sql = sql % (start_at * batch_size, batch_size)
    # fetch rows 
```

# opengl - OpenGL 窗口画得很好，但我的 OpenGL 窗口顶部的所有窗口都变黑了

> ID：13168873
> 
> 赞同：0
> 
> 时间：2012-10-31T23:26:42.343
> 
> 标签：opengl, motif

我有一个将 OpenGL 与 Motif 混合的应用程序。包含 OpenGL 的大主窗口可以重新绘制。但是，坐在它上面的子窗口都变黑了。具体来说，只是那些位于主窗口顶部的子窗口的一部分。这些子窗口中都只有 Motif 代码（除了一个）。

该应用程序不会冻结或转储核心。数据仍在流动，随着文本字段等各种子窗口的更新，这些部分会重新绘制。相互拖动窗口或最小化/取消最小化也会触发重绘。“停电”的时间是随机的。我每次都运行相同的 1 小时数据集，有时停电发生在运行 5 分钟，有时是 30 分钟，等等。

我经历了关闭部分代码的过程，直到问题停止。越来越窄，发现它与使用深度缓冲区有关。换句话说，当我注释掉 时`glEnable(GL_ENABLE_DEPTH_TEST)`，问题就消失了。所以这个问题似乎与深度缓冲区的使用有关。

据我所知，深度缓冲区在重绘完成之前就被清除了，这是应该的。调用周围有 if 语句`glClear`，所以我把消息放在那里，并确认`glClear`即使发生中断，深度缓冲区也确实发生了。而且，`glGetError`什么都没回。

更新 6/30/2014 看起来至少还有一个人在看这个（感谢 UltraJoe）。如果我没记错的话，事实证明它有时会在没有先定义后台缓冲区并向其绘制任何内容的情况下交换缓冲区。以前对我来说并不明显，因为这是一个很长的例程。还有一些其他的小东西我必须清理，但我认为这是主要原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-09T18:20:18.850

这是一个老问题，我知道，但答案可能对其他人有所帮助。

这听起来像是您为 OpenGL 窗口选择了一个糟糕的视觉效果，或者您正在创建一个覆盖默认值的新颜色图。如果可能，请为应用程序中的所有内容选择 DirectColor 24 平面视觉效果。DirectColor 视觉效果使用只读颜色单元，但 24 个平面将允许每个窗口都可以使用每种支持的颜色，而无需覆盖颜色单元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T07:08:21.630

How did you create the OpenGL window/context. Did you just get the X11 Window handle of your Motif main window and created the OpenGL context on that one? Or did you create a own subwindow within that Motif window for OpenGL?

You should not use any window managed by a toolkit directly, unless this was some widget for exclusive OpenGL use. The reason is, that most toolkits don't create a own sub-window for each an every element and also reuse parts of their graphics resources.

Thus you should create a own sub-window for OpenGL, and maybe a further subwindow using glXCreateWindow as well.

# windows-runtime - winrt xaml 独立于分辨率

> ID：13168884
> 
> 赞同：0
> 
> 时间：2012-10-31T23:27:53.437
> 
> 标签：windows-runtime, screen-resolution

我正在开发基本上为屏幕分辨率 1366x768 开发的 Windows Store 应用程序。但是对于其他分辨率，我想在所有内容以相同的比例显示在屏幕上时提供比例调整，就像它在定义的屏幕分辨率（在我的情况下为 1366x768）上显示的一样。

是否可以为应用程序提供静态分辨率之类的东西，或者是否有其他方法可以实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T00:19:35.307

尝试使用 a[`ViewBox`](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.controls.viewbox.aspx)并将子元素设置为 1366 宽，768 高。内容应与用户设备的分辨率成比例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T16:06:10.993

如有必要，Viewbox 将在侧面/顶部和底部使用信箱（或空白）。[多分辨率问题](https://stackoverflow.com/questions/12477357/windows-8-metro-app-designing-for-multiple-resolution)。

更好的方法是使用自适应布局。[缩放到屏幕的指南](http://msdn.microsoft.com/en-us/library/windows/apps/hh780612.aspx)

使用网格控件的示例实现可以在[Windows Phone 8 的多分辨率应用程序中找到](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206974%28v=vs.105%29.aspx)

# c++ - 未解决的外部符号错误，mfc

> ID：13168885
> 
> 赞同：0
> 
> 时间：2012-10-31T23:27:56.697
> 
> 标签：c++, mfc

这是我的代码。我不知道为什么会出现“未解析的外部符号”错误：

这是整个消息：domaci1View.obj：错误 LNK2001：未解析的外部符号“public：void __thiscall CDomaci1View::Nacrtaj(class CDC *,class CRect,int * const,int,int,int,int)" (?Nacrtaj@CDomaci1View@ @QAEXPAVCDC@@VCRect@@QAHHHHH@Z

```
void CDomaci1View::OnDraw(CDC* pDC)
{
CDomaci1Doc* pDoc = GetDocument();
ASSERT_VALID(pDoc);
// TODO: add draw code for native data here
RECT rect;
::GetClientRect(GetSafeHwnd(),&rect);

pDC->SelectStockObject(LTGRAY_BRUSH);
pDC->Rectangle(&rect);
//pravim okvirni
RECT okvirni;
CPen pravougaonikpen(PS_SOLID,2,RGB(201,202,202));
CBrush pravougaonik(RGB(172,171,171));
pDC->SelectObject(pravougaonikpen);
pDC->SelectObject(pravougaonik);
okvirni.left = rect.left +85;
okvirni.right = rect.right - 10;
okvirni.top = rect.top + 10;
okvirni.bottom = rect.bottom -71;
pDC->Rectangle(&okvirni);
    //brisem cektu i olovku

pravougaonik.DeleteObject();

//linije
pDC->SelectStockObject(BLACK_PEN);
int i = 1;
while (i!=6){
pDC->MoveTo(okvirni.left+1, i * okvirni.bottom/6);
pDC->LineTo(okvirni.right-2,i * okvirni.bottom/6);
i++;
}
// cetvorougao sa strane
pDC->SelectObject(pravougaonikpen);
CPoint* tacke = new CPoint[4];
tacke[0] = ::CPoint(rect.left+35,okvirni.top+15);
tacke[1] = ::CPoint(okvirni.left,okvirni.top);
tacke[2] = ::CPoint(okvirni.left,okvirni.bottom);
tacke[3] = ::CPoint(rect.left+35,okvirni.bottom+15);
pDC->Polygon(tacke,4);
pravougaonikpen.DeleteObject();
//linije sa strane
pDC->SelectStockObject(BLACK_PEN);
pDC->MoveTo(rect.left+35,rect.bottom -71 - 5*((okvirni.bottom-okvirni.top)/6)+10);
pDC->LineTo(okvirni.left,rect.bottom -71 - 5*((okvirni.bottom-okvirni.top)/6)-8);

pDC->MoveTo(rect.left+35,rect.bottom -71 - 4*((okvirni.bottom-okvirni.top)/6)+10);
pDC->LineTo(okvirni.left,rect.bottom -71 - 4*((okvirni.bottom-okvirni.top)/6)-8);

pDC->MoveTo(rect.left+35,rect.bottom -71 - 3*((okvirni.bottom-okvirni.top)/6)+10);
pDC->LineTo(okvirni.left,rect.bottom -71 - 3*((okvirni.bottom-okvirni.top)/6)-8);

pDC->MoveTo(rect.left+35,rect.bottom -71 - 2*((okvirni.bottom-okvirni.top)/6)+16);
pDC->LineTo(okvirni.left,rect.bottom -71 - 2*((okvirni.bottom-okvirni.top)/6)-4);

pDC->MoveTo(rect.left+35,rect.bottom -71 - ((okvirni.bottom-okvirni.top)/6)+16);
pDC->LineTo(okvirni.left,rect.bottom -71 - ((okvirni.bottom-okvirni.top)/6)-2);
//Donji cetvorougao
pDC->SelectStockObject(DKGRAY_BRUSH);
pDC->SelectStockObject(BLACK_PEN);
tacke[0] = ::CPoint(rect.left+35,okvirni.bottom+15);
tacke[1] = ::CPoint(okvirni.left,okvirni.bottom);
tacke[2] = ::CPoint(okvirni.right,okvirni.bottom);
tacke[3] = ::CPoint(rect.left+35+okvirni.right-okvirni.left,okvirni.bottom+15);
pDC->Polygon(tacke,4);
int vrednosti [] = {10, 15, 30, 44,33,12,99};
int duzina = sizeof(vrednosti)/sizeof(int);
    // stubovi;

    Nacrtaj(pDC,okvirni,vrednosti,duzina,255,255,255);

}

void Nacrtaj(CDC* pDC,CRect okvir,int vektor1[],int duzina,int R1,int G1,int B1){
int a = (okvir.bottom+okvir.bottom+15)/2;
CBrush stub(RGB(R1,G1,B1));
pDC->SelectObject(stub);
int j = 0;
int s = (okvir.right-okvir.left)/(duzina*3);
int raz = s*3/2;
int kor = raz;
while (j != duzina)
    {
        int v = vektor1[j]*(okvir.bottom-okvir.top)/100;
        int visina = okvir.bottom-v;
        ->Rectangle(okvir.left+kor,visina,okvir.left+s+kor,a);
        kor+=s+raz;
        j++;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T23:37:31.160

```
void Nacrtaj(CDC* pDC,CRect okvir,int vektor1[],int duzina,int R1,int G1,int B1)
{ 
```

应该

```
void CDomaci1View::Nacrtaj(CDC* pDC,CRect okvir,int vektor1[],int duzina,int R1,int G1,int B1)
{ 
```

容易犯错误。

# c# - 如何在 Web 服务中传递数据？

> ID：13168888
> 
> 赞同：1
> 
> 时间：2012-10-31T23:28:44.780
> 
> 标签：c#, web-services

我想将数据用户 ID 和用户代码传递到另一台服务器并使用网络获取响应。

所以，我创建了这段代码

```
var webRequest = WebRequest.Create(@"http://10.2.1.85/"); 
```

它工作正常，但我不知道如何传递用户 ID 和用户代码。
我必须创建对象或其他东西吗？

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:33:10.750

这是在 Web 服务上发布数据的方法：

WebService 发布功能

```
public static string JsonPost(string url, string method, string postData)
{

    Uri address = new Uri(url + method);

    //Get User current network credential
    ICredentials credentials = CredentialCache.DefaultCredentials;
    NetworkCredential credential = credentials.GetCredential(address, "Basic");

    HttpWebRequest request = WebRequest.Create(address) as HttpWebRequest;
    request.Method = "POST";
    request.ContentType = "application/json";

    //Network Credential should be included on the request to avoid network issues when requesting to the web service
    request.Proxy = WebRequest.DefaultWebProxy;
    request.Credentials = new NetworkCredential(credential.UserName, credential.Password, credential.Domain);
    request.Proxy.Credentials = new NetworkCredential(credential.UserName, credential.Password, credential.Domain);

    byte[] byteData = UTF8Encoding.UTF8.GetBytes(postData);
    request.ContentLength = byteData.Length;
    using (Stream postStream = request.GetRequestStream())
    {
        postStream.Write(byteData, 0, byteData.Length);
    }

    using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
    {
        StreamReader reader = new StreamReader(response.GetResponseStream());

        string JsonResponse = reader.ReadToEnd();

        return JsonResponse;
    }
} 
```

登录功能

```
public static string Login(string Email, string Password)
{

    try
    {
        string postData = "{" + "\"Email\":\"" + Email + "\"," +
        "\"Password\":\"" + Password + "\"" +
        "}";

        string JsonResult = JsonPost("Your Web Service URL", "Login", postData);
        return JsonResult;
    }
    catch (Exception ex)
    {

        return "";
    }

} 
```

示例如何使用：

```
public void LoginUser()
{
    string Email = "me@example.com";
    string Password = "password";
    string JsonUserAccount = Login(Email, Password);

    if(!string.IsNullOrEmpty(JsonUserAccount))
    {
        Debug.Print("User logged in");
    }
    else
    {
        Debug.Print("Failed to logged in");
    }

} 
```

# bluej - 为什么我会得到一个预期的标识符。那是什么

> ID：13168889
> 
> 赞同：0
> 
> 时间：2012-10-31T23:28:53.553
> 
> 标签：bluej

我收到一条显示“预期”的错误。我在这部分代码中得到它（***** ******）。

为什么我会得到这个？我是初学者，我被困在这个问题上，想知道我该如何解决这个问题。为什么在我有*****的地方出现标识符预期错误。这是什么意思广告我该如何解决这个问题？谢谢

```
/**
* TicketMachine models a ticket machine that issues
* flat-fare tickets.
* The price of a ticket is specified via the constructor.
* Instances will check to ensure that a user only enters
* sensible amounts of money, and will only print a ticket
* if enough money has been input.
*/
public class TicketMachine
{
// The price of a ticket from this machine.
private int price;
// The amount of money entered by a customer so far.
private int balance;
// The total amount of money collected by this machine.
private int total;

/**
* Create a machine that issues tickets of the given price.
*/
public TicketMachine(int cost)
{
if (cost > 0) 
{
price = cost;
balance = 0;
total = 0;
}
else
{ 
System.out.println("can not be minus");
}
}

/**
* @Return The price of a ticket.
*/
public int getPrice()
{
return price;
}

/**
* Return The amount of money already inserted for the
* next ticket.
*/
public int getBalance()
{
return balance;
}

/**
* Receive an amount of money from a customer.
* Check that the amount is sensible.
*/
public void insertMoney(int amount)
{
if(amount > 0) {
balance = balance + amount;
}
else {
System.out.println("Use a positive amount rather than: " +
amount);
}
}

/**
* Print a ticket if enough money has been inserted, and
* reduce the current balance by the ticket price. Print
* an error message if more money is required.
*/
public void printTicket()
{
if(balance >= price) {
// Simulate the printing of a ticket.
System.out.println("##################")…
System.out.println("# The BlueJ Line");
System.out.println("# Ticket");
System.out.println("# " + price + " cents.");
System.out.println("##################")…
System.out.println();

// Update the total collected with the price.
total = total + price;
// Reduce the balance by the prince.
balance = balance - price;
}
else {
System.out.println("You must insert at least: " +
(price - balance) + " more cents.");

}
}

/**
* Exercise printtickettwo
*/
public void printTicketTwo();
int amountLeftToPay;
amountLeftToPay (***********) = price - balance;

if (amountLeftToPay > 0) 
{
// Simulate the printing of a ticket.
System.out.println("##################")…
System.out.println("# The BlueJ Line");
System.out.println("# Ticket ");
System.out.println("# " + price + " cents.");
System.out.println("##################")…
System.out.println();
}
else
{
System.out.println.("Amount Still Required);
} 
}

/**
* Return the money in the balance.
* The balance is cleared.
*/
public int refundBalance()
{
int amountToRefund;
amountToRefund=balance;
balance = 0;
return amountToRefund;
}

/**
* Exercise empty machine money
*/ 
public int emptyMachine()
{
int emptyMachine;
emptyMachine = total;
total = 0;
return total;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:34:25.380

这条线`public void printTicketTwo();`

而是需要

`public void printTicketTwo() { *method body* }`

编辑 - 一般调试建议；当您收到这样的错误时，通常会有一个行号，如果您有错误或错误，请找到最小的行号并查看那里的代码。通常语法错误在上面提到的一行中，例如，如果你有`int myInt = 5`，并且`int mySecondInt = 7;`在下一行，错误可能会引用第二行，即使它是由于在前一行省略分号引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:05:25.350

评论已添加到您犯的每个错误旁边的类中，现在可以正常工作

```
 public void printTicket()
    {
    if(balance >= price) {
    // Simulate the printing of a ticket.
    System.out.println("##################");  // you for got ;
    System.out.println("# The BlueJ Line");
    System.out.println("# Ticket");
    System.out.println("# " + price + " cents.");
    System.out.println("##################");    // you for got ;
    System.out.println();

    // Update the total collected with the price.
    total = total + price;
    // Reduce the balance by the prince.
    balance = balance - price;
    }
    else {
    System.out.println("You must insert at least: " +
    (price - balance) + " more cents.");

    }
    }

public void printTicketTwo() // ; means an extarnl call of another existing method in the class 
{
int amountLeftToPay;
amountLeftToPay = price - balance;   // any method must have { method body  } 

if (amountLeftToPay > 0) 
{
// Simulate the printing of a ticket.
System.out.println("##################");
System.out.println("# The BlueJ Line");
System.out.println("# Ticket ");
System.out.println("# " + price + " cents.");
System.out.println("##################");
System.out.println();
}
else
{
System.out.println("Amount Still Required");   // you have added an extra . which is not needed and you for got the " and the end of Required
} 
} 
```

# java - 对 ArrayList 进行排序时，DefaultListModel 不会改变

> ID：13168890
> 
> 赞同：0
> 
> 时间：2012-10-31T23:28:55.590
> 
> 标签：java, swing, sorting, collections, defaultlistmodel

我在显示按名称对 Person 对象进行排序的方法的结果时遇到问题`sortujKolekcjePoImionach()`。当我将它`rozpocznijProgram()`放入加载一些名称并将其放入 Person 对象然后将每个 Person 放入 ArrayList 时，此方法非常有效。DefaultListModel`model`刷新 Jlist 所以它工作得很好。但是，当我将方法放到`sortujKolekcjePoImionach()`连接到单个按钮的其他 claas 时，它不起作用`class sortujKolekcjePoImionach`。我不知道模型是否没有看到`ArrayList daneOsobowe`已排序或者我可能不知道如何使用`Collections.sort(daneOsobowe,new SortujImie());`

**主.java**

```
public class Main {

    JFrame oknoGlowne;
    JTextArea sciezkaDoPliku;
    DefaultListModel<Person> model = new DefaultListModel<>();
    JList listaOsob;
    JButton wczytaj;
    JButton sortujImie;
    JButton sortujDate;
    JButton sortujImieNazwiskoDate;
    ArrayList daneOsobowe = new ArrayList();

    public void createGUI(){

        oknoGlowne = new JFrame("Kolekcje");
        oknoGlowne.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        sciezkaDoPliku  = new JTextArea(); 

        wczytaj = new JButton("Wczytaj");

        sortujImie = new JButton("Posortuj Imiona");
        sortujDate = new JButton("Posortuj Daty");
        sortujImieNazwiskoDate = new JButton("Posortuj Imiona Nazwiska Daty");

        wczytaj.addActionListener(new rozpocznijProgram());

        listaOsob = new JList(model);  //MODEL
                    sortujImie.addActionListener(new sortujKolekcjePoImionach());  //TRYING TO SORT PERSON OBJECTS BY NAME
                    //rest of GUI...
                    oknoGlowne.setPreferredSize(new Dimension(870, 550));
        oknoGlowne.setLayout(new FlowLayout());
        oknoGlowne.setVisible(true);
        oknoGlowne.pack();
}
//METHOD WHICH IS ADDING PERSON OBJECTS TO ARRAY
class rozpocznijProgram implements ActionListener{
    @Override
    public void actionPerformed(ActionEvent evt) {

        try {
            Wczytywanie wczytaj = new Wczytywanie(sciezkaDoPliku.getText());
            daneOsobowe = wczytaj.kopiowanieTablicy(sciezkaDoPliku.getText());

            //Collections.sort(daneOsobowe,new SortujImieNazwiskoData());

            for(int i=0; i<daneOsobowe.size(); i++){
                model.add(i, (Person) daneOsobowe.get(i));
                System.out.println(model.get(i));
            }

        } catch (IOException e) {
            e.printStackTrace();
        }

        }
    }
    //METHOD WHICH IS SORTING PERSON OBJECTS BY NAME
    class sortujKolekcjePoImionach implements ActionListener{
    @Override
    public void actionPerformed(ActionEvent evt) {

        Collections.sort(daneOsobowe,new SortujImie());  //IT DOESN'T WORK, JLIST DOESN'T CHANGE AFTER CLICK

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:35:18.633

您有一个人员列表 ( `daneOsobowe`)，并且列表中的每个人员都被添加到一个 ListModel 中，该 ListModel 维护着自己的人员列表。因此，您实际上有两个不同的人员列表：一个在您自己的班级中，另一个在列表模型中。

对您自己的列表进行排序不会神奇地对模型使用的列表进行排序。即使这样做了，模型也必须触发事件才能让视图重新绘制自己。

因此，如果您对列表进行排序，则需要更新列表模型以对列表模型中的人员进行重新排序（例如，通过从模型中删除所有人员并以新顺序重新添加他们）。

另一个更好的解决方案是实现您自己的列表模型（基于 AbstractListModel），并在此模型中提供排序方法，对内部列表进行排序并触发适当的事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:36:39.103

您需要将排序后的数据添加到表模型中，就像您最初所做的一样，但首先要清除：

```
model.clear();

for (int i = 0; i < daneOsobowe.size(); i++) {
   model.add(i, (Person) daneOsobowe.get(i));
   System.out.println(model.get(i));
} 
```

另一种方法是使用 Swing 的`TableRowSorter`. 请参阅此[示例](http://www.java2s.com/Tutorial/Java/0240__Swing/UsingRowSortertosortaJTable.htm)。

# ruby-on-rails - 将多个参数传递给 Rails 服务器端数据源的 jQuery-UI 自动完成小部件

> ID：13168894
> 
> 赞同：0
> 
> 时间：2012-10-31T23:29:18.340
> 
> 标签：ruby-on-rails, jquery-ui, jquery-ui-autocomplete

AutoComplete Railscast 的评论部分有一个问题没有得到解答，我需要有关相同问题的帮助。 [http://railscasts.com/episodes/102-auto-complete-association-revised?view=comments#comment_159833](http://railscasts.com/episodes/102-auto-complete-association-revised?view=comments#comment_159833)

我正在使用来自 Rails 控制器的数据源实现 jQuery-UI 自动完成，而 Rails 控制器又调用 Foursquare API。Foursquare API 需要 2 个参数（一个“查询”和一个“纬度/经度”值）。

发送到 Rails 控制器的 Autocomplete 小部件的默认参数是 params[:term]，其中包含“查询”。我需要自动完成小部件从另一个 text_field 中提取值（我们称之为 geocode_location 字段）并将其作为“latlong”参数传递。

如此有效，对 Rails 控制器的 GET 请求将是

请求网址：[http://localhost:3000/foursquare?ll=37.7+-122.5&term=McDonalds](http://localhost:3000/foursquare?ll=37.7+-122.5&term=McDonalds)

并不是

请求网址：网址：[http://localhost:3000/foursquare?term=McDonalds](http://localhost:3000/foursquare?term=McDonalds)

以下是我当前的咖啡脚本文件。我需要尝试传递它 extraParams 或某种方式让它知道传递一个名为 :latlong 的参数。如何使用 Coffeescript 和这种类型的数据源来做到这一点？

```
 $('[type="text"][name*="[location]"]').autocomplete
    source: $('[type="text"][name*="[location]"]').data('autocomplete-source')
    focus: (event, ui) ->
      event.preventDefault()
      $(this).val ui.item.label
    select: (event, ui) ->
      event.preventDefault()
      $(this).val ui.item.label
      $(this).siblings('[name*="[foursquare_id]"]').val ui.item.value 
```

我对 Coffeescript 语法不是很熟悉，但非常感谢这里的帮助。这里有一个类似的问题，但自动完成结果的数据源不同。[jQuery UI - 带有额外参数的自动完成 - 返回的数据](https://stackoverflow.com/questions/3803998/jquery-ui-autocomplete-with-extra-params-returned-data)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T21:54:15.597

经过很多很多小时终于得到它。有关如何应用附加参数以传递到服务器端 Rails 控制器的语法，请参见下文。如此有效，我现在能够得到这个请求 URL：http://localhost:3000/foursquare?ll=37.7+-122.5&term=McDonalds。希望这可以帮助某人。

```
 $('[type="text"][name*="[location]"]').autocomplete(
    source: (request, response) ->
      $.ajax 
        url: $('[type="text"][name*="[location]"]').data('autocomplete-source')
        data: {term: request.term, ll: this.element.siblings('[name*="[geocode_location]"]').val()}
        contentType: "application/json; charset=utf-8"
        success: (data) ->
          response $.map(data, (item) ->
            value: item.value
            label: item.label
            address: item.address
          )

    focus: (event, ui) ->
      event.preventDefault()
      $(this).val ui.item.label
    select: (event, ui) ->
      event.preventDefault()
      $(this).val ui.item.label
      $(this).siblings('[name*="[foursquare_id]"]').val ui.item.value
  ).data("autocomplete")._renderItem = (ul, item) ->
    $("<li>").data("item.autocomplete", item).append("<a>" + item.label + "<br>" + item.address + "</a>").appendTo ul 
```

# c# - OpenXML 将文本放入具有书签的表单字段中

> ID：13168895
> 
> 赞同：0
> 
> 时间：2012-10-31T23:29:20.880
> 
> 标签：c#, ms-word, openxml, openxml-sdk

我有一个 word 模板，打开时有灰色的表单域要填写，每个表单域都有一个书签。

我可以毫无问题地获得书签，但我无法在该确切位置添加文本。我尝试了以下方法，但文本永远不会在灰色表单字段内，无论是前行、后行还是同一行但在灰色之后。

```
bookmark.Parent.Append(new Run(new Text("append"))));
bookmark.Parent.InsertAfterSelf(new Run(new Text("pafter")));
bookmark.Parent.InsertBeforeSelf(new Run(new Text("pbefore")));
bookmark.InsertAfterSelf(new Run(new Text("after")));
bookmark.InsertBeforeSelf(new Run(new Text("before"))); 
```

任何人都知道如何正确地做到这一点？

谢谢。

# objective-c - 我应该使用保留来通过对 NSString 指针的引用输出 NSString 吗？

> ID：13168898
> 
> 赞同：1
> 
> 时间：2012-10-31T23:29:33.753
> 
> 标签：objective-c

```
// targ_url is passed in as an address to a NSString pointer.

- (long) analyse_scan_result : (NSString *)scan_result  target_url : (NSString **)targ_url

{

    NSLog (@" RES analyse string : %@", scan_result);

    NSRange range = [scan_result rangeOfString : @"http://"
                                 options       : NSCaseInsensitiveSearch
                     ];

    // **** The following retain is the first retain 
    // **** statement in this method.

    if (range.location == NSNotFound)
    {
        *targ_url = @"";
       [*targ_url retain];
        NSLog(@" FND string not found");
        return 0;
    }

    NSString *sub_string = [scan_result substringFromIndex : range.location];

    range = [sub_string rangeOfString : @" "];

    if (range.location != NSNotFound) {
        sub_string = [sub_string substringToIndex : range.location];         
    }

    NSLog(@"FND sub_string = %@", sub_string);

    *targ_url = sub_string;

    // ** The following retain is the second retain
    // ** statement in this method.

    [*targ_url retain];

    return [*targ_url length];

} 
```

[这个问题与我之前提出的](https://stackoverflow.com/questions/13132101/should-i-retain-nsstring-when-it-points-to-a-literal)问题相似并且相关（这似乎得到了令人满意的解决）。同样，上述方法仅在添加了保留语句后才有效。上面添加了 2 个，但在任何给定时间只执行一个。

该例程所做的是从条形码扫描仪输出中查找“http://”字符串并将其返回。我的问题是保留语句是必要的还是适当的？

希望有懂行的能帮忙...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:32:51.607

**TL;博士**

不要通过引用返回拥有的对象值。

**解释：**

按照惯例，通过引用（甚至按值）返回的对象是不拥有的，除非该方法明确说明这一点。如果方法名称包含`copy`或者`new`它应该提供一个拥有的引用，否则引用计数被认为是不相关的。

例如，`NSError`通过引用返回的Cocoa 方法会返回一个`NSError`您不希望释放的 autoreleased。

这意味着，只要您通过方法名称表明您正在做什么，您就可以执行任何一项。您可能只想返回一个自动释放的引用并让调用者决定他们是否要继续持有它。

显然，根据本文档，Apple 认为您不应该通过引用返回拥有的值：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)

# javascript - 脚本生成元素上的jquery单击事件

> ID：13168900
> 
> 赞同：0
> 
> 时间：2012-10-31T23:29:52.830
> 
> 标签：javascript, jquery, dom, onclick

我有这个脚本：

```
<script>
    $(document).ready(function() {
       $('.block-link').click(function() {
          $('body').addClass("gallery-on");
       });

       $('body').delegate('.ps-toolbar-close', 'click', function() {
          $('body').removeClass("gallery-on");
          });
       });
</script> 
```

当我单击`.gallery-on`任何. 该元素是通过一个[**插件**](https://github.com/codecomputerlove/PhotoSwipe)（相当不错的顺便说一句！）生成的，当点击任何一个时，它会创建一个模态灯箱。`body``.block-link`
`.ps-toolbar-close`[](https://github.com/codecomputerlove/PhotoSwipe)**`.block-link`**

 **脚本的第一部分正在工作，第二部分应该`.gallery-on`从正文中删除类，但它只是关闭灯箱并让正文类在它所在的位置。

我究竟做错了什么？不幸的是，我是 javascript 和 jquery 的初学者..

我最好的猜测是，由于`.ps-toolbar-close`页面加载时文档中尚未出现，因此脚本的第二部分没有放置单击处理程序，尽管我认为这`.delegate()`能够处理尚不存在的元素，我错了吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:45:08.580

这很可能是由于委托方法的一个有趣属性。来自 jQuery 文档：

> 补充说明：
> 
> 由于 .live() 方法在事件传播到文档顶部后处理事件，因此无法停止实时事件的传播。同样，由 .delegate() 处理的事件将传播到它们被委托的元素；在调用委托的事件处理程序时，绑定在 DOM 树中它下面的任何元素上的事件处理程序将已经被执行。因此，这些处理程序可能会阻止委托处理程序通过调用 event.stopPropagation() 或返回 false 来触发。

模态对话框的 close 方法被附加在 DOM 的下方，并在您的主体处理程序之前被调用，并防止您的处理程序正确触发。

尝试绑定到对话框的[关闭事件](http://api.jqueryui.com/dialog/#event-close)并删除那里的类。**

# cakephp - CakePHP - Escape (htmlspecialchars) 不适用于 FormHelper

> ID：13168903
> 
> 赞同：0
> 
> 时间：2012-10-31T23:30:03.033
> 
> 标签：cakephp

我的印象是 FormHelper 不仅自动保护我免受 SQL 注入，而且默认情况下也会像 HtmlHelper 那样转义特殊字符。但是，当我有：

```
<?php echo $this->Form->input('field', array('escape' => true)); ?> 
```

然后在字段中输入 & 和 ' 例如并点击保存。这些特殊字符无需任何转义即可保存到数据库中。如果没有将选项转义设置为 true，也会发生这种情况。所以我的问题如下。

CakePHP 的设计是否真的是让您在使用 FormHelper 的选项保存之前不应该也不能够转义表单字段？还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:48:47.960

您做错了，您应该使用 h() 函数（htmlspecialchars() 的快捷方式）*转义所有类型的*未通过核心帮助程序的输出。核心助手，如 Html::link() 会自动转义。

另请参阅[如何在 PHP 中转义输出](https://stackoverflow.com/questions/5141513/how-to-escape-output-in-php)

# javascript - 来自 Codeigniter 站点上的 Javascript 文件的通过 http 提供的内容的不安全内容警告

> ID：13168908
> 
> 赞同：0
> 
> 时间：2012-10-31T23:30:29.493
> 
> 标签：javascript, codeigniter, ssl, https, assets

对于在我的某些页面上提供的内容，Google Chrome 会返回不安全的内容警告。内容由 Codeigniter 中 assets/js 目录中的 Javascript 文件调用。Javascript 文件通过引用在asset_helper 文件中列出的js_asset_url 加载到页脚中。

```
<script src="<?php echo js_asset_url('script.js'); ?>"></script> 
```

我只在特定控制器上使用 SSL，因此资产文件夹内容当前加载不安全，并且由于显示的警告而让用户担心。有没有人有一个解决方案让 Codeigniter 强制资产（如 .js 文件）通过 SSL 加载？

编辑：我终于修复了使用外部参考源（希望可以发布链接！） [http://www.davidnard.com/2011/04/easy-ssl-redirection-in-codeigniter/](http://www.davidnard.com/2011/04/easy-ssl-redirection-in-codeigniter/) 被调用的内容.js 文件用于控制器中的 2 个功能。在 $partial 数组中设置相关的控制器（见上面的链接）就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:51:27.167

如果我使用绝对 URL 指向脚本文件，我通常通过 https 而不是 http 来引用它。比如用 jQuery，我通过引用

如果我使用标准 HTTP 协议，我的浏览器并不关心我是否正在尝试访问受保护的内容，并且可以正确处理使用 HTTPS。

要使用您的代码处理此问题，您始终可以进行字符串替换。

例如，在您的情况下，您可以执行以下操作：

```
<!-- str_replace([needle], [replacement_text], [haystack]); -->
<script src="<?php echo str_replace('http:', 'https:', js_asset_url('script.js')); ?>"></script> 
```

# vb.net - 在 VB 2010 的数据表中插入新列时，如何更新 SQL Server 2008 数据库？

> ID：13168909
> 
> 赞同：3
> 
> 时间：2012-10-31T23:30:36.263
> 
> 标签：vb.net, sql-server-2008

使用 VB 2010 和 SQL Server 2008：

我能够在数据表中插入新行、删除行和更新数据，并使用数据适配器更新数据库而不会出现任何问题。当我尝试添加新列时，该列出现在数据表中，但它不会更新到数据库。我目前正在使用 DataAdapter.Update(DataTable) 方法。

我的代码如下：

```
Dim dcNewColumn As New DataColumn
dcNewColumn.ColumnName = strClassColumnName
m_DataTable.Columns.Add(dcNewColumn)
m_DataTable.Row(intCurrentRow).Item(strClassColumnName) = strClassName
dcNewColumn = Nothing

m_DA.Update(m_DataTable) 
```

插入新列时是否有不同的方法来更新数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:48:33.857

您正在寻找[`ALTER TABLE`](http://msdn.microsoft.com/en-us/library/ms190273.aspx)sql 命令。
或[SQLDMO 列集合](http://msdn.microsoft.com/en-us/library/ms135184%28v=sql.105%29.aspx) （请查看页面开头的通知）

添加列的 ALTER TABLE 命令可以用这种方式编码

```
Dim cn As SqlConnection
Dim cmd As SqlCommand
Using cn = GetConnection()
    cn.Open()
    Using cmd = new SqlCommand()
         cmd.Connection = cn
         cmd.CommandText = "ALTER TABLE myTable ADD aNewColumn VARCHAR(20) NULL"
         cmd.CommandType = CommandType.Text
         cmd.ExecuteNonQuery()
    End Using
End Using 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:51:09.397

添加新列不是更新。您可以发出一些 sql 来更改数据库中表的结构，例如

```
Alter Table MyTable AddMyNewColumn int null 
```

如果您有相关权限。

除了管理员类型的功能，这不是你通常会做的事情。

# windows - 仅列出文件夹中的图像文件

> ID：13168910
> 
> 赞同：1
> 
> 时间：2012-10-31T23:30:40.333
> 
> 标签：windows, batch-file, cmd

如何仅列出文件夹中的图像文件？像 jpg, gif, png, bmp

这是我到目前为止得到的代码。它的作用是在每个子文件夹中创建一个目录列表并列出所有文件。现在我只想列出图像文件。你怎么能用windows cmd来做到这一点？

```
@echo off
for /r "C:\Documents and Settings\Administrator\Billy\Artworks\" %%d in (.) do dir /s/b "%%~fd" > "%%~dpnd\dirlist.txt" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T10:55:18.957

只需添加文件扩展名过滤器；

```
....works\" %%d in (*.gif;*.jpg;*.jpeg;*.png;*.bmp;*.tiff) do dir /s/b "% ... 
```

# ruby-on-rails - 如何重定向rails中不存在的路线

> ID：13168912
> 
> 赞同：3
> 
> 时间：2012-10-31T23:31:02.813
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我已经从具有良好页面排名的旧网站切换到 RubyOnRails。

当然，现在所有链接都已断开。当用户通过谷歌链接访问我的网站时，他会得到：

```
Routing Error

No route matches [GET] "/SOME_WRONG/URL/WITH/PARAMETERS" 
```

将出现此类错误的用户重定向到我的 root_url 的最佳方法是什么？

我必须把这段代码放在哪里？

```
.htaccess?
application_controller?
application.rb?
routes.rb? 
```

非常感谢提前:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T23:47:50.450

在 config/routes.rb 的最底部，添加一个重定向的通配符路由：

```
match "*missing" => redirect("/") 
```

现在任何未知的路由最终都会被这条规则捕获并重定向到主页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T07:31:54.863

研究所有未识别的路线将被重定向回您的 Rails 应用程序主页的路线通配符...

[http://blog.jayfields.com/2007/12/rails-route-globbing.html](http://blog.jayfields.com/2007/12/rails-route-globbing.html)

# jquery - 从电话链接中删除按钮

> ID：13168916
> 
> 赞同：0
> 
> 时间：2012-10-31T23:31:29.523
> 
> 标签：jquery, mobile, jquery-mobile

[http://w5webdesigns.com/bwick/](http://w5webdesigns.com/bwick/)

我希望电话号码显示为一个可点击的链接，该链接将激活系统电话，到目前为止有效，但我需要删除按钮，所以你看到的只是电话号码。这是如何运作的？

```
 <a href="tel:1518279392">518.279.392</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:27:10.983

添加`data-role="none"`到您的标签

```
 <a data-role="none" href="tel:1518279392">518.279.392</a> 
```

通常在使用锚标记时，除非您指定`data-role="button"`jQuery Mobile，否则将不理会它。但是，当您将它放在页眉或页脚中时，jQuery Mobile 似乎无论如何都会增强它。显式添加 data-role="none" 属性将阻止 jQuery Mobile 对其进行增强。防止 jQuery Mobile 增强页眉/页脚中的标记的另一个*技巧*`div`是将其包装在.

```
 <div><a  href="tel:1518279392">518.279.392</a></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:48:21.037

jQuery mobile 应用了他们品牌的移动友好 ui 样式。您可以使用 Firebug 或 Chrome 开发工具检查元素以查明您不想要哪些样式，然后专门编写您自己的 CSS 来覆盖这些样式。或者您可以尝试[此答案](https://stackoverflow.com/a/2128383/1408356)中的方法。

# content-management-system - CMS 与 3rd 方扩展一起使用

> ID：13168917
> 
> 赞同：0
> 
> 时间：2012-10-31T23:31:30.880
> 
> 标签：content-management-system

我的问题是其他内容管理系统如何与第三方开发人员制作的扩展一起工作？

我正在阅读 wordpress、joomla、drupal 的代码，但我需要更深入的解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:42:05.693

基本上，您需要有一个 API，第 3 方开发人员可以通过该 API 与您的 CMS 进行交互，而不会破坏或破解您的“核心”代码。在 Wordpress 中，它是通过所谓的“钩子”完成的，您可以通过它将一些逻辑注入核心模块，而无需实际编辑它们。一切都取决于需要开发哪种类型的 3rd 方工具：主题、插件、黑客等。

# git - Git：限制推送到远程仓库的文件

> ID：13168921
> 
> 赞同：2
> 
> 时间：2012-10-31T23:32:29.940
> 
> 标签：git, web-config

我有一个 web 项目，它的根是我的 git repo 的根。Git 正在跟踪该项目中的大部分文件并推送到远程仓库。在项目的根目录中，我有一个 web.config 文件，我想在本地跟踪它，但不推送到我们的远程仓库。

这甚至可以用git吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:58:40.187

一种方法是添加一个[虚拟引用](http://sitaramc.github.com/gitolite/vref.html)，其中[Gitolite](https://github.com/sitaramc/gitolite)安装在 Git 上游 repo 端（您要推送到的那个）。

这种更新钩子可以分析推送到的文件的内容，如果它包含错误的文件，则拒绝推送。[VREF FILETYPE](https://github.com/sitaramc/gitolite/blob/master/src/VREF/FILETYPE)就是一个例子
。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-30T15:34:07.260

这是可能的，只需在项目的根目录中创建一个文件，并为其命名`.gitignore`（不要忘记`.`文件名前面的点 ( )）。然后编辑文件并粘贴您想要忽略的任何文件，例如，我喜欢忽略所有具有 .ini 扩展名的文件，所以我`.gitignore`看起来像：

```
<<<<<<< HEAD
# built application files
*.ini
>>>>>>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T00:26:34.227

您可以创建一个单独的分支（我称之为`config`）并在那里添加您的文件并使用该分支来跟踪对该文件的更改，合并来自另一个分支的更改（可能`master`）。然后，您可以自由地将更改推送到`master`分支，而无需推送配置文件。但是你需要小心避免从错误的分支推送。

另一种选择可能是将更改提交到单独的存储库中的配置文件，并在当前存储库的工作树中具有符号链接或副本。将其添加到 .gitignore 文件将阻止当前存储库中的 git 将其列为要添加的内容。这种方式不太可能导致意外将该文件推送到您的服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-23T16:23:21.227

VonC 的答案在理论上是最好的，假设您可以根据您喜欢的 git repo 找到可以为您完成工作的工具。

Mohamed 正在做某事，但还没有完全做到。

[我在这个问题](https://stackoverflow.com/questions/9794931/keep-file-in-a-git-repo-but-dont-track-changes)上复制了 nasirkhan 的最佳选择

在您的文件准备好生产后，例如：Web.config，运行以下命令：

```
git update-index --assume-unchanged Web.config 
```

如果您需要再次更新 Web 配置（跟踪更改），请运行以下命令：

```
git update-index --no-assume-unchanged Web.config 
```

[git-update-index 文档](https://git-scm.com/docs/git-update-index)

# sbt - 如何在发布之前让 sbt-release 插件自动清理？

> ID：13168924
> 
> 赞同：0
> 
> 时间：2012-10-31T23:32:48.463
> 
> 标签：sbt

我尝试了一些方法，例如`addCommandAlias("release", ";clean ;release")`，以及类似的方法：

```
ReleaseKeys.releaseProcess ~= {
   (seq: Seq[ReleaseStep]) =>
    cleanStep +: seq
} 
```

cleanStep 就像：

```
lazy val cleanStep = ReleaseStep(
    action = st => Project.extract(st).runTask(clean, st)._1
) 
```

和

```
lazy val cleanStep = ReleaseStep(
    action = st => Project.extract(st).runAggregated(clean, st)
) 
```

基本上，这些方法都不起作用。 `runTask`适用于简单的built.sbt 构建，但似乎不适用于多模块构建。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T11:00:05.723

这最终奏效了。我真的不明白 runAggregated 应该做什么；我原以为它会做这个。但无论如何，这有一些直观的意义；建议仍然受到赞赏，因为我觉得我错过了一些东西。

```
 lazy val cleanStep = ReleaseStep(
    action = st => {
      implicit val display = Project.showContextKey(st)
      val session = Project.session(st)
      val structure = Project.structure(st)
      (structure.allProjectRefs foldLeft st) {
        case (s: State, p: ProjectRef) =>
          Extracted(structure, session, p).runTask(clean, s)._1
      }
    }
  ) 
```

# css - 标签在悬停时消失

> ID：13168926
> 
> 赞同：0
> 
> 时间：2012-10-31T23:32:53.337
> 
> 标签：css

当悬停它的父 ul 时尝试显示 ul 时，我遇到了一个奇怪的问题。当我将鼠标悬停在“关于我们”上时，“联系人 li”会消失，然后在我悬停时重新出现。在所有浏览器上进行了测试，并且始终存在相同的问题。

任何帮助将不胜感激！

```
#topNav ul li:hover ul {
display: inline-block;
}

#topNav ul li {
display:inline;
list-style-type:none;
padding-right:15px; 
color:#FFF;
}

#topNav ul li ul a {
color:#FFF; 
}

#navHover {
display:none;
position:relative;
top:40px;
left:40px;
width:275px;
height:18px;
background-color:#913f93;
color:white;
text-align:center;
border-bottom-right-radius:.5em;
border-bottom-left-radius:.5em;
}

#navHover li {
margin-left:7px; 
}

<nav id="topNav" class="georgia">

    <ul>
        <li><a href="home.php"> </a> </li>
      <li> <a href="/creations/activities/">activities</a></li>

         <li id="aboutUsLink"><a href="/creations/about-us/">about us</a>

            <ul id="navHover">

              <li> <a href="whatwedo"> What we do </a> </li>
              <li> <a href="what-it-costs">What it costs </a></li>

            </ul>   

        </li>  

          <li><a href="/blog/">contact</a></li>

    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:56:07.700

如果你看这里 [http://jsfiddle.net/t3vZ6/](http://jsfiddle.net/t3vZ6/)

联系人 li 并没有真正消失，它只是向右移动，因为子 ul 不是绝对定位的。

如果你会这样做

```
#topNav ul li:hover ul {
display: inline-block;
position: absolute;
} 
```

它应该工作..希望它有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T10:26:58.910

嘿看我想我解决了你的问题。没有javascript，没有jquery。享受。

HTML部分：

```
<div id="topnav">
<ul>
<li><a href="#">Home</a> </li>
<li><a href="#">activities</a></li>
<li><a href="#">about us</a>
<ul>
<li> <a href="#"> What we do </a> </li>
<li> <a href="#">What it costs </a></li>
</ul></li>  
<li><a href="#">contact</a></li>
</ul>
<div class="clear"></div>
</div> 
```

CSS部分：

```
.clear{clear:both;}

#topnav{width:100%;}

#topnav ul{list-style:none;}

#topnav li{float:left;}

#topnav a{padding-left:10px; padding-right:10px;}

#topnav ul ul{width:200px; height:60px; position:absolute; visibility:hidden;}

#topnav ul ul li{width:50%; height:30px;}

#topnav ul ul a{font-size:13px;}

#topnav ul li:hover ul{visibility:visible;} 
```

# android - 尝试写入数据库但没有响应

> ID：13168927
> 
> 赞同：-5
> 
> 时间：2012-10-31T23:32:58.683
> 
> 标签：android, sqlite

> **可能重复：**
> [Android：如何写入 SQL 数据库](https://stackoverflow.com/questions/13168638/androidhow-to-write-to-sql-database)

我在表单中输入数据，按下按钮后，字符串应该被发送到数据库，如果写入成功，我会打开一个对话框，但是我没有得到任何响应。

编辑：我将错误识别为“仅在整数主键上允许使用自动增量”但是我的主键是整数？

```
public class AddCourse extends Activity implements OnClickListener {

Button sqlAddModule;
EditText sqlModuleCode, sqlModuleName, sqlModuleStart, sqlModuleEnd, sqlModuleLocation, sqlModuleComments;
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.add_course);

        sqlAddModule= (Button)findViewById(R.id.addToDatabase);
        sqlModuleCode = (EditText)findViewById(R.id.labelEditModuleCode);
        sqlModuleName = (EditText)findViewById(R.id.labelEditModuleFull);
        sqlModuleLocation = (EditText)findViewById(R.id.labelEditModuleLocation);
        sqlModuleComments = (EditText)findViewById(R.id.labelEditModuleComments);

        sqlAddModule.setOnClickListener(this);
 }

        public void onClick (View addModuleButton) 
        {
            boolean didItWork = true;
            try{
            String moduleCode = sqlModuleCode.getText().toString();
            String moduleName = sqlModuleName.getText().toString();
            String moduleLocation = sqlModuleLocation.getText().toString();
            String moduleComments = sqlModuleComments.getText().toString();

            database entry = new database(AddCourse.this);
            entry.open();
            entry.createEntry(moduleCode, moduleName,moduleLocation, moduleComments);
            entry.close();

            }catch(Exception e){
                didItWork = false;
            }finally{ if(didItWork){
                Dialog d = new Dialog(this) ;
                d.setTitle("BooYa!");
                TextView tv = new TextView(this);
                tv.setText("Success");
                d.setContentView(tv);
                d.show();
            }

            }

            finish();

        }    

} 
```

SQL 类

```
public class database {

    public static final String KEY_ROWID = "_id";
    public static final String KEY_MODULECODE = "module_code";
    public static final String KEY_MODULENAME = "module_name";
    public static final String KEY_MODULETYPE = "module_type";
    public static final String KEY_MODULEDAY = "module_day";
    public static final String KEY_MODULESTART = "module_start";
    public static final String KEY_MODULEEND = "module_end";
    public static final String KEY_MODULELOCATION = "module_location";
    public static final String KEY_MODULECOMMENTS = "module_comments";

    private static final String DATABASE_NAME = "module_database";
    private static final String DATABASE_TABLE = "my_modules";
    private static final int DATABASE_VERSION = 1;

    private DbHelper myHelper;
    private final Context myContext;
    private SQLiteDatabase moduleDatabase;

    private static class DbHelper extends SQLiteOpenHelper {

        public DbHelper(Context context){
            super(context, DATABASE_NAME, null, DATABASE_VERSION);

        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                        KEY_ROWID + " INTERGER PRIMARY KEY AUTOINCREMENT, " +
                        KEY_MODULECODE + " TEXT NOT NULL, " +
                        KEY_MODULENAME + " TEXT NOT NULL, " +
                        KEY_MODULELOCATION + " TEXT NOT NULL, " +
                        KEY_MODULECOMMENTS + " TEXT NOT NULL,);"
                    );

        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            db.execSQL("DROP TABEL IF EXISTS " + DATABASE_TABLE);
            onCreate(db);

        }

    }

    public database(Context c){
        myContext = c;
    }

    public  database open()throws SQLException{
        myHelper = new DbHelper(myContext);
        moduleDatabase = myHelper.getWritableDatabase();
        return this;
    }

    public void close(){
    myHelper.close();
    }

    public long createEntry(String moduleCode, String moduleName,  String moduleLocation, String moduleComments) {
        ContentValues cv = new ContentValues();
        cv.put(KEY_MODULECODE,moduleCode);
        cv.put(KEY_MODULENAME,moduleName);
        cv.put(KEY_MODULELOCATION,moduleLocation);
        cv.put(KEY_MODULECOMMENTS,moduleComments);
        return moduleDatabase.insert(DATABASE_TABLE,null,cv);
        // TODO Auto-generated method stub

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:46:34.027

您的数据库类中有一个错字： `" INTERGER PRIMARY KEY AUTOINCREMENT, "` 这不是“INTEGER”的正确拼写，您可能已经知道了。另外，请注意`db.execSQL("DROP TABEL IF EXISTS " + DATABASE_TABLE);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T00:50:27.923

我的代码的问题是 CREATETABLE 的额外逗号

```
 public void onCreate(SQLiteDatabase db) {
            db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                        KEY_ROWID + " INTERGER PRIMARY KEY AUTOINCREMENT, " +
                        KEY_MODULECODE + " TEXT NOT NULL, " +
                        KEY_MODULENAME + " TEXT NOT NULL, " +
                        KEY_MODULELOCATION + " TEXT NOT NULL, " +
                        KEY_MODULECOMMENTS + " TEXT NOT NULL);"
                    ); 
```

# visual-studio - 为什么 Visual Studio 开发服务器会为某些文件类型提供 404 错误？

> ID：13168928
> 
> 赞同：2
> 
> 时间：2012-10-31T23:33:01.757
> 
> 标签：visual-studio, iis-express

我正在尝试测试 Visual Studio 开发服务器，但某些文件类型出现 404 错误。例如，如果我有一个文件 /Views/Users/SignIn.js 它被拒绝，其中允许使用 css。同样的项目在 IIS Express 中可以正常工作。我认为这与允许的文件类型有关，但我不知道如何在 isual studio 开发服务器中启用它们。任何帮助，将不胜感激。谢谢

# sqlite - “ALL”的 SQLite 语法

> ID：13168929
> 
> 赞同：15
> 
> 时间：2012-10-31T23:33:03.797
> 
> 标签：sqlite

有没有办法在**SQLite**中执行以下操作？

```
select name
from   table
where  number >= ALL (<subquery, "such as select x from table ...">) 
```

`ALL`具体来说，无论我如何格式化查询，我都会在运算符之后收到语法错误。在我搜索解决方案时，我发现有人提到`ALL`SQLite 中的语法不同，但我似乎无法弄清楚。

有人可以告诉我基本`ALL (<subquery>)`语句在 SQLite 中是如何工作的吗？或者让我知道他们是否根本不工作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-01T01:29:07.380

我怀疑SQLite中有一个[ALL()运算符。](http://msdn.microsoft.com/en-us/library/ms178543.aspx)但是，您可以使用 MAX() 和 MIN() 编写功能等效的内容。

```
SELECT name 
FROM table 
WHERE number >= (SELECT MAX(another_number) FROM another_table WHERE ...) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-25T04:40:50.777

SQLite 确实有一个 ALL 关键字；但是，它不会做你想做的事。（幸运的是，@lawrence 的回答确实如此。）

虽然 ALL 关键字不允许作为 WHERE 表达式的一部分，但该关键字可以出现在其他几个地方。

来自[http://www.sqlite.org/lang_select.html](http://www.sqlite.org/lang_select.html)：

## 全选 * ...

> ALL 或 DISTINCT 关键字之一可以在简单的 SELECT 语句中跟在 SELECT 关键字之后。如果简单 SELECT 是 SELECT ALL，则 SELECT 返回整个结果行集。如果 ALL 或 DISTINCT 都不存在，则行为就像指定了 ALL。

## 选择...联合所有选择...

> 使用 UNION ALL 运算符创建的复合 SELECT 返回 UNION ALL 运算符左侧的 SELECT 中的所有行，以及右侧的 SELECT 中的所有行。UNION 运算符的工作方式与 UNION ALL 相同，只是从最终结果集中删除重复行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-12T23:05:21.327

SQLite 没有 ALL 运算符。你可能会想写这样的东西：

```
select ... where number >= (select max(...) from ...); 
```

但是，这**并不**等同于所有情况下的原始查询。如果子查询没有结果，则`number`大于所有结果（[空虚为真](https://en.wikipedia.org/wiki/Vacuous_truth)）。但是零个数的最大值为 NULL，并且`number >= NULL`为假（或者更确切地说，在三元逻辑中*未知*，最终被视为假）。

以下查询等同于使用 ALL 的查询，包括空结果情况：

```
select ... where not exists (select * from ... where number < X); 
```

# generics - 可以为具有通用成员的私有记录类型重载 = 运算符吗？

> ID：13168935
> 
> 赞同：1
> 
> 时间：2012-10-31T23:33:36.717
> 
> 标签：generics, operator-overloading, ada

我正在尝试为通用链表类重载相等运算符。以下是相关代码：

## 列表广告：

```
generic
    type Element_Value_Type is private;

package List is
    type List_Type   is private;
    type Element     is private;
    type Element_Ptr is private;

    function "=" (L, R : List_Type) return Boolean;

    --  Other linked list function declarations  --

private
    type Element is
        record
            Value : Element_Value_Type;
            Next  : Element_Ptr;
            Prev  : Element_Ptr;
        end record;

    type Element_Ptr is access Element;

    type List_Type is
        record
            Length : Integer     := 0;
            Head   : Element_Ptr := null;
            Tail   : Element_Ptr := null;
        end record;
end List; 
```

* * *

## 列表.adb：

```
package body List is
    function "=" (Left, Right : List_Type) return Boolean is
    begin
        --  Code for equality checking  --
    end "=";

    --  Other function implementations  --
end List; 
```

* * *

## 主.adb：

```
with Text_IO;
with List;
use Ada;

procedure Main is
    package Int_Lists is new List (Integer);

    procedure Print_List (List : Int_Lists.List_Type) is
    begin
        --  code to print the contents of a list  --
    end

    L1, L2 : Int_Lists.List_Type;
begin
    Int_Lists.Append (L1, 1);
    Int_Lists.Append (L2, 1);
    Int_Lists.Append (L1, 2);
    Int_Lists.Append (L2, 2);

    Text_IO.Put_Line (Item => Boolean'Image (L1 = L2));
end Main; 
```

* * *

这是我在 Main 正文的最后一行得到的错误：

```
operator for private type "List_Type" defined at list.ads:X, instance at line X is not directly visible 
```

有没有办法让它看到“=”功能？如果我这样做`Int_Lists."=" (L1, L2)`，或者如果我把它放在`use Int_Lists`Main 的主体之前，它就可以工作，但是第一种破坏了运算符重载的目的，而第二种允许从 Main 中无限制地访问所有 List 函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T15:52:28.020

在`Main`, 之后

```
package Int_Lists is new List (Integer); 
```

你可以写

```
use type Int_Lists.List_Type; 
```

或者

```
function "=" (L, R : Int_Lists.List_Type) return Boolean
  renames Int_Lists."="; 
```

就个人而言，我会去`use type`。这就是它的用途。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:49:35.650

是的，您可以将“=”与私有类型泛型参数一起使用，但是我建议将“=”函数与私有类型一起传递，但默认为可见的，如`with function … is <>`所示。

**另外**，请注意，比较`Element`时必须比较值，而不是整个记录。（参见带有元素参数的“=”的定义；它在私有部分中，作为 Ada 2012 的表达式函数之一。）

`Test_List.ads`

```
generic
    type Element_Value_Type is private;
    with function "=" (Left, Right : Element_Value_Type) Return Boolean is <>;
    -- Image only for debugging.
    with function Image( Value : Element_Value_Type ) Return String;
package Test_List is
    type List_Type   is private;
    type Element     is private;
    type Element_Ptr is private;

    function "=" (L, R : List_Type) return Boolean;
    Procedure Append(List : in out List_Type; Item : Element_Value_Type);
    function Image( List : List_Type ) Return String;

private
    type Element is
        record
            Value : Element_Value_Type;
            Next  : Element_Ptr;
            Prev  : Element_Ptr;
        end record;

    function "=" (Left, Right : Element ) Return boolean is
    ( Left.Value = Right.Value );

    type Element_Ptr is access Element;

    type List_Type is
        record
            Length : Integer     := 0;
            Head   : Element_Ptr := null;
            Tail   : Element_Ptr := null;
        end record;
end Test_List; 
```

`Test_List.adb`

```
Package Body Test_List is

    function "=" (L, R : List_Type) return Boolean is
    begin
    Return Result : Boolean:= L.Length = R.Length do
        -- We only need to check if lengths are equal.
        if not Result then Return; end if;

        declare
        SubType NN_Element_Ptr is Not Null Element_Ptr;
        L_Cursor : NN_Element_Ptr:= L.Head;
        R_Cursor : NN_Element_Ptr:= R.Head;
        begin
        loop
            if L_Cursor.Value /= R_Cursor.Value then
            Result:= False;
            Return;
            end if;

            Exit when L_Cursor = L.Tail;
            L_Cursor:= L_Cursor.Next;
            R_Cursor:= R_Cursor.Next;
        end loop;
        end;
    exception
        when Constraint_Error =>
        -- Handle empty lists.
        Result:= L.Tail = R.Tail;
    End return;
    end "=";

    Procedure Append(List : in out List_Type; Item : Element_Value_Type) is
    begin
    List.Tail:= new Element'(
            Value => Item,
            Next  => null,
            Prev  => List.Tail
             );
    -- If this is the inital element we link head to ie, if not we need
    -- to link the previous tail's next-pointer to the current tail.
    if List.Length = 0 then
        List.Head := List.Tail;
    else
        List.Tail.Prev.Next:= List.Tail;
    end if;
    List.Length:= List.Length + 1;
    end Append;

    Function Image( List : List_Type ) Return String is
    Separator : Constant String := ", ";

    Function Image( Item : Element_Ptr ) Return String is
    begin
        if Item = Null then
        Return "";
        else
        Return Image(Item.Value) & Separator & Image(Item.Next);
        end if;
    end Image;

    Temp : String:= Image( List.Head );
    begin
    Return '(' & Temp(temp'First..temp'Last-Separator'Length) & ')';
    end Image;

End Test_List; 
```

`test.adb`

```
With
Test_List,
Ada.Text_IO;

Procedure Test is
    Package J is new Test_List( Integer, Image => Integer'Image );
    L1, L2 : J.List_Type;
    Use J;

Begin
    Ada.Text_IO.Put_Line( Image(L1) );
    J.Append (L1, 1);
    J.Append (L2, 1);
    J.Append (L1, 2);
    J.Append (L2, 2);
    J.Append (L1, 3);
    J.Append (L2, 3);
    Ada.Text_IO.Put_Line( Image(L1) );
    Ada.Text_IO.Put_Line( "List equality: " & Boolean'(L1 = L2)'Img );
    J.Append (L2, 1);
    J.Append (L1, 2);    
    Ada.Text_IO.Put_Line( "List equality: " & Boolean'(L1 = L2)'Img );
End Test; 
```

输出是：

```
()
( 1,  2,  3)
List equality: TRUE
List equality: FALSE 
```

# ruby - 如何向标签添加额外数据

> ID：13168937
> 
> 赞同：-4
> 
> 时间：2012-10-31T23:33:43.150
> 
> 标签：ruby, xml, rss

红宝石。我使用标准生成器来生成 rss。我的构建器文件是：

```
xml.instruct! :xml, :version => "1.0"
xml.rss(:version => "2.0") {
xml.channel {
    xml.title(@digest.name)
    xml.description(@digest.name)
    xml.link(url_for(:only_path => false))
    for post in @posts
        xml.item do
            xml.title(post.title || '')
            xml.description(post.summary)
            xml.link(post.url)
            xml.source(post.feed.name)
            xml.guid(post.url)
            xml.pubDate(post.pub_date.to_s(:rfc822))
        end
     end
    }
} 
```

要生成 rss feed( `require rss`)，我使用下一个代码：

```
xml.source(post.feed.name) 
```

并得到：

```
<source>Cnn news</source> 
```

但我想要这样的东西：

```
<source url="http://news.cnn.com">Cnn news</source> 
```

如何将参数添加`url`到 xml 源标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T04:55:26.777

我不确定您使用什么库来执行此操作，但如果您将哈希传递给构建器，它只会将其添加为节点的属性。

```
require 'builder'
 => true 
x = Builder::XmlMarkup.new(:target => $stdout, :indent => 1)
<inspect/>
 => #<IO:0x000000008822a0> 
x.source("CNN News", "url" => "http://www.cnn.com")
<source url="http://www.cnn.com">CNN News</source>
 => #<IO:<STDOUT>> 
```

# javascript - Node.js http get 请求与工头提前退出

> ID：13168938
> 
> 赞同：2
> 
> 时间：2012-10-31T23:33:57.853
> 
> 标签：javascript, node.js, http-get

编辑：正如已经指出的那样，这段代码实际上直接通过 Node 运行良好——我现在意识到问题在于当我尝试使用作为 Heroku 工具包的一部分的工头运行它时。有谁知道为什么我在使用 foreman 命令运行时应该得到不同的结果？

我正在尝试使用 Node.js 解析 XML 提要。到目前为止，我有代码只是为了获取块中的 xml 提要并将它们输出到控制台。出于某种原因，每当我运行它时，我都会在随机点（每次运行时不同）收到“以代码 0 退出”“向所有进程发送 SIGKILL”消息。该消息散布在 xml 的最后几行中（输出示例结束）：

```
01:17:55 web.1  |     </item>
    01:17:55 web.1  | exited with code 0
    01:17:55 web.1  |     <item>
    01:17:55 system | sending SIGKILL to all processes
    01:17:55        |       <title>The Church of Scot
    C:\CK3\dashboard> 
```

有谁知道可能导致这种提前退出的原因是什么？这是我的代码

```
var http = require('http');
//var xml2js = require('xml2js');

var options = {
  host: 'feeds.bbci.co.uk',
  port: 80,
  path: '/news/rss.xml'
};

var req = http.get(options, function(res) {
  //console.log('STATUS: ' + res.statusCode);
  //console.log('HEADERS: ' + JSON.stringify(res.headers));
  res.setEncoding('utf8');
  res.on('data', function (chunk) {
    console.log("\n\n new chunk \n\n");
    console.log(chunk);
  });
});

req.on('error', function(e) {
  console.log('problem with request: ' + e.message);
});

req.end(); 
```

非常感谢您的时间和回复！

-六霍比特人

# python - python中大于x且小于y的元素的表达式，全部在一个return语句中。没有循环。Python

> ID：13168943
> 
> 赞同：-5
> 
> 时间：2012-10-31T23:34:55.983
> 
> 标签：python, numpy

返回数组`A`中大于 x 且小于 y 的项目数。`A`是一维浮点数组，x 和 y 是浮点数。例如`F6(np.array([1.1, 2.2, 3.3, 2.3]), 2, 3)`应该返回`2`。

```
def F(A,x,y):
     return ________? 
```

只能使用这条线。在蟒蛇

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T23:55:24.990

这是一种将其作为矢量化操作的方法：

```
import numpy as np

def F(A, x, y):
    return np.sum((A > x) & (A < y)) 
```

每个比较都返回一个布尔数组。表达式按元素对这两个数组进行 AND 运算并将结果相加。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T23:38:09.350

我对numpy一无所知，但是在香草python中：

```
def F(A, x, y):
    return sum(x < v < y for v in A) 
```

`True`这使用了这样一个事实，即您可以通过求和来计算布尔数组中 s 的数量，因为`int(True) == 1`和`int(False) == 0`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T23:39:52.727

列表理解是一种选择。

```
def F(A,x,y):
    return len([i for i in A if i > x and i < y]) 
```

# javascript - 为什么 143.55 在 javascript 中等于 143.54999999999？

> ID：13168954
> 
> 赞同：1
> 
> 时间：2012-10-31T23:37:21.317
> 
> 标签：javascript, math, floating-point

> **可能的重复：**
> [JavaScript 的数学被破坏了吗？](https://stackoverflow.com/questions/588004/is-javascripts-math-broken)

我在 javascript 中运行了一些非常基本的函数来尝试将浮点数转换为货币。例如：

```
var t = Array(15.90, 15.95, 15.95);
var x = t[0];
if(x%1 == 0)
output += ".0";
if(x%.1 == 0)
output += "0"; 
```

输出应该 yield `0`，但由于某种原因，在某些情况下，这不起作用，当我将 x 的值回显到控制台时，我会得到`15.89999999999`或`15.900000000001`。为什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:41:41.423

你可以只`toFixed()`打印出你想要的小数位数：

```
var priceString = price.toFixed(2); 
```

这将始终为您提供格式化为两位小数的数字。

我知道这里很多人会告诉你不要使用浮点数进行基于货币的计算。但是，我发现浮点数的精度对于合理的美元金额来说绰绰有余。除非您将大量金额乘以很小的百分比，否则您不会丢失便士。例如：`1000000 * .0000001 = .099999999`

# delphi - 获取记录字段的结构 var AKA 偏移量的位置

> ID：13168959
> 
> 赞同：4
> 
> 时间：2012-10-31T23:38:11.567
> 
> 标签：delphi, memory-management, struct, delphi-7, record

我想获得结构/记录的“位置”。

假设我有这个记录：

```
type
  MyStruct = record
    MyInteger   : Integer;
    MyInteger2  : Integer;
    MyInteger3  : Integer;
    MyFunc      : function (FirstParam : WideString; SecondParam : String) : Integer;
    MyString    : String;
    MyString2   : WideString;
    MyPchar     : pchar;
end; 
```

如您所见，该记录的大小为 28 字节（7 vars x 4 字节）。基本上是因为所有变量都是 4 字节变量（例如整数）或指针（也是 4 字节）。现在假设我们将这个结构加载到内存地址 (X = 0) 中（这也意味着 MyInteger 的地址将为 0）。MyInteger3 的地址（例如）将是 8 （注意 X = 0 ！）如何动态获取结构的位置（数字/地址）？

希望大家明白我的意思吗？提前致谢。

顺便说一句：结构中的任何 Var 是否总是 4 个字节？编辑：如果您修复 spcae ，这是错误的：`String[100]`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-01T02:39:05.167

您可以使用一些指针算法获得任何记录成员的偏移量：

```
type
  PMyStruct = ^MyStruct;

var
  Offset: Integer;
begin
  Offset := Integer(@(PMyStruct(nil).MyInteger3));
  // or:
  // Offset := Integer(Addr(PMyStruct(nil).MyInteger3));
end; 
```

如果你想要函数的偏移量，你需要这样编码：

```
Offset := Integer(@@PMyStruct(nil).MyFunc);
// or:
// Offset := Integer(Addr(@PMyStruct(nil).MyFunc)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-01T02:47:00.100

```
program OffsetTest; {$APPTYPE CONSOLE}

type
  f = function (FirstParam : WideString; SecondParam : String) : Integer;
  TStruct = record
    MyInteger   : Integer;
    MyInteger2  : Integer;
    MyInteger3  : Integer;
    MyFunc      : ^f;
    MyString    : String;
    MyString2   : WideString;
    MyPchar     : pchar;
  end;

var MyStruct :TStruct;

begin
  Writeln( int64(@(MyStruct.MyInteger )) - int64(@(MyStruct)));
  Writeln( int64(@(MyStruct.MyInteger2)) - int64(@(MyStruct)));
  Writeln( int64(@(MyStruct.MyInteger3)) - int64(@(MyStruct)));
  Writeln( int64(@(MyStruct.MyFunc    )) - int64(@(MyStruct)));
  Writeln( int64(@(MyStruct.MyString2 )) - int64(@(MyStruct)));
  Writeln( int64(@(MyStruct.MyPchar   )) - int64(@(MyStruct)));
  Readln;
end. 
```

32 位版本的结果：

```
0 
4 
8
12
20
24 
```

64 位版本的结果：

```
0
4
8
16
32
40 
```

64位结果，打包记录：

```
0
4
8
12
28
36 
```

显示不同的结果以指出在代码中依赖这些偏移量可能是个坏主意。或者至少要非常清楚不同的情况可能会导致不同的偏移量。

# php - php ajax绕过嵌套表单问题

> ID：13168961
> 
> 赞同：1
> 
> 时间：2012-10-31T23:38:33.240
> 
> 标签：php, ajax, forms, wordpress, nested-forms

我正在使用 wordpress 并尝试创建一个用于上传文件的插件。问题是插件出现在发布和编辑页面上，基本上是两个巨大的形式。只要我在这些页面中放了一些东西，我就在这些表格中。

所以我坚持使用嵌套形式。

我能想到的唯一解决方案是：

1.  在 iframe 中有一个表单并从公共/编辑页面获取 $_FILES 数据。
2.  有一个元素（jquery？），它作为文件输入做出反应，但不是文件输入，以便在能够检索 $_FILES 数据的同时不必使用表单。
3.  保留嵌套表单并有一种解决方法使它们工作并获取 $_FILES 数据

无论选择什么，我都无法在互联网上找到任何关于它的信息。

有什么帮助吗？

谢谢你。

# java - 我可以使用 main() 重新启动我的应用程序吗？

> ID：13168962
> 
> 赞同：6
> 
> 时间：2012-10-31T23:38:45.940
> 
> 标签：java, application-restart

我正在研究一种通过单击 GUI 上的按钮来重新启动我的 java 应用程序的方法。我在网上搜索并发现了 main(new String[0])。我需要了解这是否是重新启动我的应用程序的有效方法。有人可以请教谢谢。

```
private void bnNewsaleActionPerformed(java.awt.event.ActionEvent evt) {

    main( new String[0]);
    } 
```

编辑这会更好吗？

```
private void bnNewsaleActionPerformed(java.awt.event.ActionEvent evt) {
    classname.this.dispose();
    main( new String[0]);
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-31T23:40:56.020

`main`它使用空字符串数组调用静态方法。看看这是否使它更清楚：

```
String[] args = new String[0]; // Or String[] args = {};
main(args); 
```

诚然，`main`从非主方法调用方法是不寻常的......这不会真正“重新启动”应用程序。它将*从您现有的处理程序*中调用它，这很可能会产生令人讨厌的后果。我不会推荐它。

如果你能找到一种方法来启动一个完全干净的过程，那将是一个更可靠的“重启”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-31T23:45:30.173

您将无法在不退出 JVM 的情况下重新启动您的应用程序 - JVM 将分配对象、线程等，并且如果没有大量的内务处理，您将不会轻易地破坏它。

我认为更简单的方法是将您的应用程序包装在一个脚本中，并让脚本在您的应用程序以特定退出代码退出时重新启动您的应用程序。这样，您可以通过`System.exit()`调用完全破坏您的 JVM，并且如果脚本仅在看到特定退出代码时重新启动您的应用程序，您可以选择退出或退出并重新启动。

例如检查[JavaServiceWrapper](http://wrapper.tanukisoftware.com/doc/english/download.jsp)。这提供了使用特定配置/参数启动 Java 应用程序并控制[重新启动](http://wrapper.tanukisoftware.com/doc/english/introduction.html#restarts)行为的能力。请注意，它提供了一个[特定的 API 调用来](http://wrapper.tanukisoftware.com/jdoc/org/tanukisoftware/wrapper/WrapperManager.html#restart%28%29)从您的应用程序中调用重新启动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T23:41:21.983

这不是重新启动应用程序的好方法，因为应用程序的初始调用仍将运行。如果你像那样“重启”你的应用程序足够多次，你会得到一个堆栈溢出。

如果您必须重新启动您的应用程序而不退出它（这是不寻常的），您可以在您的 中设置一个`try`/`catch`块`main`，围绕它放置一个循环，并在遇到异常时继续循环。诚然，这更像是一种解决方法，因为它使用异常来控制“正常”程序流。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-01T07:34:06.547

这是@Brian Agnew 上面已经提出的具体示例。

在您的**Java 代码**中，在重新启动的情况下使用特定的退出退出

```
if(restart){

System.exit(5);

}else{
 System.exit(0);
} 
```

现在创建一个实际用于启动应用程序的脚本。我在这里给出了 Windows 批处理脚本的示例，但您可以为其他操作系统使用类似的脚本。

**批处理文件：**

```
@echo off

:start

java Test %1
set exitcode=%ERRORLEVEL%

if %exitcode% == "5" (goto :start) 
```

当您以状态码 5（可以是任何整数）退出时，您将批量重新启动程序（*`Test`是具有 main 方法的示例类*）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T23:49:32.047

当你读到那个。

```
private void bnNewsaleActionPerformed(java.awt.event.ActionEvent evt) {

    main( new String[0]);
    } 
```

它正在做的是`bnnewsaleActionPerformed`用一个空的新字符串调用 main() 。
这不会重新启动您的应用程序。

重新开始意味着，停止并重新开始。

而使用您的代码，它将在 ypur 当前应用程序中再次启动您的应用程序。
有点像嵌套它，它会产生讨厌的效果，例如：不重置任何静态分配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-31T23:40:43.790

`main()`是您在该类中定义的函数。
它需要一个类型的参数`string[]`。

这一行调用该函数，就像任何其他函数一样。
它传递一个空字符串数组 ( `new String[0]`)

由于您的`main()`函数开始您的应用程序，这将“重新启动”它。

但是，它不会重置任何静态状态。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-01T12:31:07.270

java中的main方法没有什么特别之处，所以调用main与调用其他方法没有区别。jvm 初始化的每一点都发生在 java 运行时搜索名为“main”的方法之前。

如果您想在不退出 jvm 的情况下重新启动应用程序，则必须避免或清理所有静态状态。对于简单的情况，您只需编写一个类来管理您的应用程序生命周期并创建一个新实例以重新启动。

```
class MyApplication{
    public void start(){}//setup all application state and run it
    public void shutdown(){}//close all Windows/Connections and Threads
} 
```

对于非平凡的示例，这可能会导致丑陋的 ThreadLocals/静态变量/在退出时标记为删除的文件必须小心处理。此外，应用程序类的更新只能通过一些类加载器技巧可见。

# c - 系统调用 open() 权限

> ID：13168964
> 
> 赞同：1
> 
> 时间：2012-10-31T23:39:13.360
> 
> 标签：c

我使用系统调用打开一个文件`open()`。

```
if ((fd2 = open(logFile, O_RDWR |O_APPEND | O_CREAT ), 0666) == -1)
    DieWithError("open() failed"); 
```

我的文件 FTP_track.log 创建没有任何问题。问题是虽然我有模式`0666`，它可以读写，但我无法在 unix 中打开文件。我必须更改文件属性的权限才能读取和写入。

有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:49:27.227

您的行的问题是括号不匹配。您的表达式被解析为`fd2 = open(), 0666`. 在 C 中，表达式`expr1, expr2`具有值`expr2`，因此您的`if`语句基本上说`fd2 = 0666`.

# sql - 按查询分组没有返回我所期望的

> ID：13168965
> 
> 赞同：4
> 
> 时间：2012-10-31T23:39:16.510
> 
> 标签：sql, sql-server, sql-server-2005

我试图找到所有具有相同`groupCol`但不止一个非 0的记录`infoCol`。这是我正在尝试做的一个完整示例。

```
CREATE TABLE #t
    (
    groupCol varchar(14) NOT NULL,
    infoCol int NOT NULL,
    indexCol int NOT NULL IDENTITY (1, 1)
    )
GO

insert into #t (groupCol, infoCol) 
values ('NoRows',1),      ('NoRows',1),      ('NoRows',1),       --Not in output due to having only 1 disticnt infoCol
       ('TwoResults',1),  ('TwoResults',1),  ('TwoResults',2),   --In the output with "'TwoResults', 2"
       ('ThreeResults',1),('ThreeResults',2),('ThreeResults',3), --In the output with "'ThreeResults', 3"
       ('ExcludedZero',1),('ExcludedZero',1),('ExcludedZero',0)  --Not in the output due to 0 being excluded for finding distinct infoCol's
       ('TwoAndZero',1),  ('TwoAndZero',2),  ('TwoAndZero',0)    --In the output but returns 2 not 3.

select * from #t

select groupCol, count(groupCol) as distinctInfoCol 
from #t 
where infoCol <> 0
group by groupCol, infoCol
having count(groupCol) > 1

drop table #t 
```

但是我查询的结果是

```
groupCol distinctInfoCol
-------------- ---------------
排除零 2
NoRows 3
两个结果 2

```

当我期望我的输出是

```
groupCol distinctInfoCol
-------------- ---------------
两个结果 2
三结果 3
二与零 2

```

我做错了什么，我该如何纠正以获得我需要的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:46:32.357

```
select groupCol, count(distinct infoCol) as distinctInfoCol 
from #t 
where infoCol <> 0
group by groupCol
having count(distinct infoCol) > 1 
```

# php - 从 MySQL 数据库中构造 select 语句

> ID：13168966
> 
> 赞同：0
> 
> 时间：2012-10-31T23:39:16.807
> 
> 标签：php, mysql

我有 4 张桌子用来尝试获取客户订单：

```
account
- account_id
- username

product
- product_number
- product_name

customer_order
- customer_order_id
- fk_account_id (foreign key)

customer_order_details
- fk_customer_order_id (foreign key)
- fk_product_id (foreign key) 
```

这是我的查询......这有点令人困惑，但是：

```
SELECT customer_order_details.fk_customer_order_id, product.product_name,
customer_order_details.colour, customer_order_details.size
FROM customer_order, customer_order_details, product, account
WHERE customer_order.customer_order_id = 
customer_order_details.fk_customer_order_id
AND customer_order_details.fk_product_id = product.product_id
AND customer_order.fk_account_id = account.account_id
AND account.username = 'user1'
GROUP BY customer_order_details.fk_customer_order_id; 
```

它应该按 customer_order_details 表中的外键 (fk_customer_order_id) 分组。我想要的结果是这样的：

```
1
Microfleece Vest
Jacket With Hood

2
Jacket With Hood 
```

相反，我得到类似的东西：

```
1
Microfleece Vest

2
Jacket With Hood 
```

我的 PHP 代码只是通过一个 while 循环运行并打印出 product_name 和 fk_customer_order_id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:55:46.930

下面是一个 JOIN 语法的例子：

```
 SELECT d.fk_customer_order_id, p.product_name, d.colour, d.size
 FROM customer_order AS o
 LEFT JOIN customer_order_details AS d ON o.customer_order_id = d.fk_customer_order_id
 LEFT JOIN product AS p ON d.fk_product_id = p.product_id
 LEFT JOIN account as a ON o.fk_account_id = a.account_id
 WHERE a.username = 'user1'
 GROUP BY d.fk_customer_order_id
 ORDER BY d.fk_customer_order_id; 
```

请尝试上述方法。我使用表别名使它更容易阅读。为了加快查询速度，请确保为所有关系键设置了索引。

但是，您的输出将是：

```
1 Microfleece Vest
1 Jacket With Hood
2 Jacket With Hood 
```

由于对订单详细信息进行分组将在每个详细信息中列出一行...

# javascript - 如何阻止我的网站被他人陷害？

> ID：13168968
> 
> 赞同：1
> 
> 时间：2012-10-31T23:39:42.547
> 
> 标签：javascript, iframe, xss

如何阻止我的网站加载到框架中？

可以在这里看到：http: [//yehg.net/lab/pr0js/pentest/cross_site_framing.php](http://yehg.net/lab/pr0js/pentest/cross_site_framing.php)

Google.com 不会加载，msn.com 会跳出框架。AOL.com 将加载正常。如何使我的网站脱离框架或加载到整个窗口中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-01T00:01:59.850

这个小脚本片段应该可以工作：

```
<script>
if (window !== top) top.location = window.location;
</script> 
```

此外，您可以通过指定`X-Frame-Options: DENY`标题来防止您的页面被加载到 iframe 中。有关详细信息，请参阅[https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header](https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T23:58:55.590

如果您将顶部框架的 url 与当前框架的 url 进行比较，则可以完成框架中断脚本：

```
if(window.top.location.href != window.href)
{
  window.top.location = window.href;
} 
```

# c# - for循环骰子滚动和文本框。文本更新麻烦c#

> ID：13168977
> 
> 赞同：0
> 
> 时间：2012-10-31T23:40:51.907
> 
> 标签：c#, dice

我正在尝试制作一个程序，其中首先有一个随机掷骰子“掷骰子”来决定`dicethrow`应该掷骰子的次数（1到9次之间），任何大于掷骰子的东西都应该是结束游戏。`TryParse`我还需要在每次滚动后更新分数，这是我在评论中尝试做的，但我不确定是否需要`wagerTextBox.Text`获取值并防止格式异常，或者是否可以没有它（或者我会把它放在哪里`TryParse`）。

```
#region private method randomdiceroll
private void rollButton_Click(object sender, EventArgs e)
{
    rollDice();
    wagerTextBox.Enabled = false;
}
private int RollsNumber()
{
    Random rolls = new Random();
    return rolls.Next(1, 10);
}
private int diceThrow()
{
    Random dice = new Random();
    return dice.Next(1,7);
}
private void rollDice()
{
   int i = RollsNumber();
   for (i = 0; i <= 10; i++)
   {
       diceThrow();
       int wager = Convert.ToInt32(wagerTextBox.Text);
       int score = wager * 100;
       scoreTextBox.Text = Convert.ToString(score);
       {
          // wagerTextBox.Text = null;
         //  wagerTextBox.Text = scoreTextBox.Text;
       }
   }
}
#endregion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:58:04.963

要解决滚动随机次数的问题，请切换此代码：

```
int i = RollsNumber();
for (i = 0; i <= 10; i++)
{ 
```

到：

```
int i;
int maxRolls = RollsNumber();
for (i = 0; i < maxRolls; i++)
{ 
```

对于您问题的第二部分，我不知道您到底要完成什么，抱歉。

# java - JFrame JPanel GUI 中的 CardLayout

> ID：13168980
> 
> 赞同：0
> 
> 时间：2012-10-31T23:41:09.110
> 
> 标签：java, swing, user-interface, jbutton, cardlayout

我有一个包含默认 JPanel 的主 JFrame。我正在尝试使用此 JPanel 将不同的 JPanel 附加到我的应用程序，以模拟浏览应用程序的效果。我注意到，要使 CardLayout 工作，JFrame 通常必须有某种方式来控制 JPanel 中显示的内容（例如按钮、下拉框等）。我想要做的是有一个主页（ JPanel）加载到 JFrame 中的默认 JPanel 中，并允许用户使用该主页 JPanel 中可用的可点击按钮/图标进行导航。

由于 JFrame 和默认 JPanel 与其他 JPanel 位于不同的类中，因此我无法通过单击其中一个 JPanel 上的按钮来访问默认 JPanel（因为它是私有的）来更改其上显示的内容其他类。有没有办法解决？

另外，如果我将应用程序中所需的每个按钮都附加到 JFrame 并控制从那里显示的 JPanel，它会起作用吗？我可以根据需要使按钮可见/不可见，这有意义吗？

这是我在 JFrame 类中调用的代码：

```
 private void jButton45MouseClicked(java.awt.event.MouseEvent evt) {
    CardLayout card= (CardLayout) displayPanel.getLayout();
    card.show(displayPanel, "register");
} 
```

displayPanel 是循环显示所有卡片的默认面板，jButton45 是 JFrame 中标题为“Register”的按钮。“注册”是我试图显示的 JPanel 变量的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T00:01:03.680

这听起来像是一个设计问题。没有看到一些代码，我无法给出具体的细节。话虽如此，您需要解决的主要问题是提供控制导航的按钮，并引用默认的 JPanel 及其 CardLayout。从那里只需调用`next()`,`previous()`或`show()`。

**附录：**

的第二个参数`show()`是您在调用时提供的名称`add()`。如果您使用的是 NetBeans GUI Builder，则可以在属性窗口中进行设置。选择面板并向下滚动到“布局”。将 Card Name 设置为所需的 String 值，然后在调用时使用相同的值`show()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:52:24.543

使用可以在导航窗格（主页）和用于切换`CardLayout`视图的“默认”之间进行对话的模型。

基本上，模型将具有简单的 setter 和 getter，应用程序的两个部分可以使用它们来更改和观察模型的状态。您需要提供某种侦听器来通知相关方模型已更改，最简单的可能是`ChangeListener`or `PropertyChangeListener`。

这样，您可以随着时间的推移更改模型，而不会影响使用它的那些组件。

# php - 隐藏已经出现在 MySQL 表中的行的最简单方法是什么？

> ID：13168983
> 
> 赞同：1
> 
> 时间：2012-10-31T23:41:31.390
> 
> 标签：php, mysql, row

我的意思是我有 2 个表格，一个是课程列表 ( `courses`)，第二个是我注册的课程列表 ( `StudentCourseRegistration`)。我想知道如何发出我保存在`StudentCourseRegistration`表中的主键，称为，**当我调用显示此表时**从表`CourseCode`中隐藏`course`

 **所以如果表中出现行数据“CourseCode”-> CAD9047 `registered`，那么我调用表时不要显示`courses`。当然，我不能硬编码我想从该表中发出的确切课程代码，因此一旦该代码已向该用户注册，它就会动态更改。

查询是最好的方法吗？

这是我调用输出表的地方：

```
$string2012 = "SELECT Course.CourseCode, Course.Title, Course.WeeklyHours, Semester.Term, Semester.SemesterCode
    FROM Course, CourseOffer, Semester, StudentCourseRegistration WHERE Semester.YearNum='$selectedYear' AND Course.CourseCode=CourseOffer.CourseCode 
    AND Semester.SemesterCode=CourseOffer.SemesterCode ";
    if($Result2012 = mysqli_query($link, $string2012))
    {
        echo "<form action='CourseSelection.php' method='get'>
        <table><tr><th>Code</th><th>Course Title</th><th>Hours</th><th>Term</th><th>Select</th></tr>";
        while($row2012 = mysqli_fetch_assoc($Result2012))
        {
            echo "<tr><td>$row2012[CourseCode]</td><td>$row2012[Title]</td><td>$row2012[WeeklyHours]</td>
            <td>$row2012[Term]</td><td><input type='checkbox' name='courses[]' value='$row2012[CourseCode]'></td></tr>";
        }
        echo "</table>";
    } 
```

**如果存在，我可以在一个表中指定主键/外键现在显示在另一个表中吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:46:04.667

```
SELECT *
FROM course c
WHERE c.coursecode 
    NOT IN(SELECT r.coursecode FROM studentcourseregistration r) 
```

如果你经常这样做，你可能想要：

```
CREATE VIEW filtered_courses AS
    SELECT *
    FROM course c
    WHERE c.coursecode 
        NOT IN(SELECT r.coursecode FROM studentcourseregistration r) 
```**

# android - 使用 OrmLite 加强数据完整性

> ID：13168993
> 
> 赞同：4
> 
> 时间：2012-10-31T23:42:17.633
> 
> 标签：android, ormlite

我有一个`Question`包含`Answer`对象列表的类。在我的 POJO 中，我在 Question 类中将其表示为：

```
@ForeignCollectionField 
private ForeignCollection<Answer> answers; 
```

在我的 Answer 类中，这种关系被声明为：

```
@DatabaseField(foreign = true, canBeNull=false)
private Question question; 
```

`Answer`如果我试图持久化引用了`Question`尚未持久化到数据库的 a，我曾预计 ORMlite 会抛出异常。但是，这似乎不会发生。我可以随意保存对象`Answer`而不保存引用的`Question`对象。我通过`Answer`使用`SQLliteBrowser`. 这破坏了我的数据完整性，因为当我重新启动程序时，数据库现在包含引用不存在问题的答案。

有什么办法可以强制执行吗？根据我在 Hibernate 中的经验，如果不先保存引用的“父”对象，则不允许您保存子对象。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T08:41:52.687

将以下内容添加`columnDefinition`到您的字段中，如果它引用的外部 ID 不存在，它将不允许创建对象。

```
@DatabaseField(foreign = true, canBeNull=false,
     columnDefinition = "integer references question(id) on delete cascade")
private Question question; 
```

另见其他线程：[在 SQLite 下的 ORMLite 中创建外键约束](https://stackoverflow.com/questions/6090075/creating-foreign-key-constraints-in-ormlite-under-sqlite)

# javascript - Javascript中的PayDay Loan APR计算

> ID：13168999
> 
> 赞同：0
> 
> 时间：2012-10-31T23:42:39.517
> 
> 标签：javascript, jquery

我正在尝试创建一个发薪日贷款计算，并且我在 math.stackexchange 上得到了帮助。

我得到了一个计算 APR 数字的公式。

我有一笔要借的 100 英镑，我想在 14 天内还清这笔钱。这笔贷款的利息是 15% 这项服务的费用是每天 0.20 便士。据此，我计算出费用为 17.80 英镑。

(100+100×0.15+0.2×14100)365.25/14−1≈70.80

所以有效的 APR 将是 7080%

我如何将 Javasript 中的这个答案计算到小数点后两位？

我目前有这个，但我得到了错误的数字。

```
function update() {            
     $interest = 0.15 ;
     $perday = 20 ;
     $amount1 = $("#amount").val();
     $amount1 = parseInt($amount1, 10) || 100;
     $dayscount = $("#days").val();
     $amount2 = parseInt($amount1) + $interest * parseInt($amount1) + (parseInt($dayscount) * ($perday/100));
     $apr = (($amount2-$amount1 / $amount1 ) / ((parseInt($dayscount)/365.25) * 100));
     $("#amount").text($amount1);
     $("#amount2").text($amount2);
     $("#amount3").text(parseFloat($amount2-$amount1).toFixed(2));
     $("#amount4").text(parseFloat($apr).toFixed(2));     
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:00:24.077

更改此行

```
$apr = (($amount2-$amount1 / $amount1 ) / ((parseInt($dayscount)/365.25) * 100)); 
```

对此

```
$apr = Math.pow($amount2 / 100, 365.25 / $dayscount) - 1; 
```

它会给你 70.80

PS 在 Javascript 中，开发人员通常将 $ 放在变量前面，表示它是一个 jQuery 对象。没必要在这里做。