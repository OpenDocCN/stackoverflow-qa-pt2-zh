# StackOverflow 问答 15853000-15853999

# java - 使用 Jsoup 提取和解析 HTML 表格

> ID：15853002
> 
> 赞同：3
> 
> 时间：2013-04-06T16:07:06.590
> 
> 标签：java, html, web-scraping, jsoup

我如何使用 Jsoup 从[该网站](http://mobilereviews.net/details-for-Motorola%20L7.htm)分别提取每一行的规格数据，例如 Network->Network Type、Battery 等。

```
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class mobilereviews {
    public static void main(String[] args) throws Exception {
        Document doc = Jsoup.connect("http://mobilereviews.net/details-for-Motorola%20L7.htm").get();
        for (Element table : doc.select("table")) {
            for (Element row : table.select("tr")) {
                Elements tds = row.select("td");
                System.out.println(tds.get(0).text());   
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T17:46:20.277

这是尝试找到解决问题的方法

```
Document doc = Jsoup.connect("http://mobilereviews.net/details-for-Motorola%20L7.htm").get();

for (Element table : doc.select("table[id=phone_details]")) {
     for (Element row : table.select("tr:gt(2)")) {
        Elements tds = row.select("td:not([rowspan])");
        System.out.println(tds.get(0).text() + "->" + tds.get(1).text());
     }
} 
```

解析 HTML 很棘手，如果 HTML 发生更改，您的代码也需要更改。

您需要首先研究 HTML 标记以提出您的解析规则。

*   HTML 中有多个表格，因此您首先筛选正确的表格`table[id=phone_details]`
*   前 2 行仅包含用于格式化的标记，因此请跳过它们`tr:gt(2)`
*   每隔一行以内容类型的全局描述开始，将其过滤掉`td:not([rowspan])`

有关选择器语法中更复杂的选项，请查看此处[http://jsoup.org/cookbook/extracting-data/selector-syntax](http://jsoup.org/cookbook/extracting-data/selector-syntax)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T18:05:11.110

列的 xpath -`//*[@id="phone_details"]/tbody/tr[3]/td[2]/strong`

值的 xpath -`//*[@id="phone_details"]/tbody/tr[3]/td[3]`

@Joey 的代码试图将这些归零。您应该能够编写`select()`基于 Xpath 的规则。

用适当的值替换数字 (tr[N] / td[N])。

或者，您可以通过纯文本浏览器传输 HTML 并从文本中提取数据。这是页面的[文本版本](https://w3dt.net/tools/textbrowser/?host=http://mobilereviews.net/details-for-Motorola%2520L7.htm&submit=Browse&clean_opt=1)。您可以分隔文本或在 N 个字符后读取以提取数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-05T03:20:02.097

这就是我从 html 表中获取数据的方式。

```
org.jsoup.nodes.Element tablaRegistros = doc
                    .getElementById("tableId");
for (org.jsoup.nodes.Element row : tablaRegistros.select("tr")) {
                for (org.jsoup.nodes.Element column : row.select("td")) {
                    // Elements tds = row.select("td");
                    // cadena += tds.get(0).text() + "->" +
                    // tds.get(1).text()
                    // + " \n";
                    cadena += column.text() + ",";
                }
                cadena += "\n";
            } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-17T05:33:45.900

这是通过 JSoup 从 HTML 页面中提取表格的通用解决方案。

```
import java.io.IOException;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class ExtractTableDataUsingJSoup {

    public static void main(String[] args) {
        extractTableUsingJsoup("http://mobilereviews.net/details-for-Motorola%20L7.htm","phone_details");
    }

    public static void extractTableUsingJsoup(String url, String tableId){
        Document doc;
        try {
            // need http protocol
            doc = Jsoup.connect(url).get();

            //Set id of any table from any website and the below code will print the contents of the table.
            //Set the extracted data in appropriate data structures and use them for further processing
            Element table = doc.getElementById(tableId);

            Elements tds = table.getElementsByTag("td");

            //You can check for nesting of tds if such structure exists
            for (Element td : tds) {
                System.out.println("\n"+td.text());
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

# php - 如何从 javascript 中获取 codeigniter 中视图类的名称？

> ID：15853004
> 
> 赞同：0
> 
> 时间：2013-04-06T16:07:10.900
> 
> 标签：php, codeigniter

我需要从 js 获取我的视图的类名。

说我的网址是

```
http://localhost/test/index.php/mytest/newtest/34 
```

这里 newtest 是视图类的名称。我想从我的 js 中获取这个类名。我在谷歌上搜索过它，但没有找到任何有用的东西。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:17:23.447

```
var pathArray = window.location.pathname;
pathArray = pathArray.replace(/^\/|\/$/g, '');
pathArray = pathArray.split( '/' );
console.log(pathArray); 
```

使用此 Javascript，您将从您的 url 中获取所有部分作为数组。在那里你会知道哪个元素是你正在寻找的元素..

# objective-c - 在视图控制器之间传输变量

> ID：15853005
> 
> 赞同：-1
> 
> 时间：2013-04-06T16:07:26.903
> 
> 标签：objective-c, variables, viewcontroller

我的 iOS 应用项目有问题。我想将我的 SearchViewController 的值传输到我的 ResultGeneralInfoViewController。没有错误或问题，但它不起作用。

这是我的 SearchViewController.m 中的代码

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    NSDictionary *item = [searchResults objectAtIndex:[indexPath row]];

    ResultGeneralInfosViewController *detailViewController = [ResultGeneralInfosViewController alloc];
    detailViewController.companyName = [item objectForKey:@"companyName"];
    NSLog([item objectForKey:@"companyName"]);
} 
```

结果GeneralInfoViewController.h

```
@interface ResultGeneralInfosViewController : UIViewController {

    NSString *companyName;
}

@property NSString *companyName;

@property (weak, nonatomic) IBOutlet UILabel *companyNameLabel; 
```

和 ResultGeneralInfoViewController.m

```
@implementation ResultGeneralInfosViewController

@synthesize companyName;

//Outlets
@synthesize companyNameLabel;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {

    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    companyNameLabel.text = self.companyName;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:17:34.283

您还没有初始化 ResultGeneralInfosViewController，只分配了它。调用适当的`init`方法以首先对其进行初始化。例如：

```
ResultGeneralInfosViewController *detailViewController =
    [[ResultGeneralInfosViewController alloc] initWithNibName:@"NibName" bundle:nil]; 
```

确保在对象初始化后设置属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:17:03.737

在`didSelectRowAtIndexPath`中，您创建了 的实例`ResultGeneralInfosViewController`，但您什么也不做。如果您使用导航控制器，那么您应该添加

```
[self.navigationController pushViewController:detailViewController animated:YES]; 
```

# jsp - 容器如何处理 JSP

> ID：15853009
> 
> 赞同：0
> 
> 时间：2013-04-06T16:07:37.340
> 
> 标签：jsp

jsp 何时实际加载（在启动或第一次请求时），因为我们为 servlet 提供了此选项。如果它是第一次请求，那么服务器如何知道这是第一次请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:32:40.900

> *什么时候真正加载了jsp（在启动或第一次请求时）*

应第一次请求。然而，也可以让服务器在启动时向自己发送请求。或者，您可以在部署之前的构建期间预编译 JSP。有关详细信息，另请参阅以下相关问题：

*   [如何让 Tomcat 在启动时预编译 JSP？](https://stackoverflow.com/questions/497830/how-can-i-make-tomcat-pre-compile-jsps-on-startup)
*   [是否可以将jsp预编译到eclipse中？](https://stackoverflow.com/questions/3282595/is-it-possible-to-precompile-jsp-into-eclipse)
*   [使用 Ant 预编译 JSP 的最佳方法是什么](https://stackoverflow.com/questions/230037/what-is-the-best-way-to-precompile-jsps-using-ant)

* * *

> *如果它是第一次请求，那么服务器如何知道这是第一个请求。*

当服务器内存中没有可用的已编译 JSP 类时。所以它不会准确地检查请求是否是第一个请求，而只是检查所请求的 JSP 是否已经编译。

# java - 提取姓名和姓氏并保存在 2 个不同的变量中？

> ID：15853011
> 
> 赞同：-2
> 
> 时间：2013-04-06T16:07:45.090
> 
> 标签：java, netbeans

我有一个小问题，现在让我很紧张！问题是：

只需说您有一个名字：“Jeremy Clarkson”，我怎样才能从中提取“Jeremy”并将其保存在变量中？

这就是我所做的：

```
String[]FirstName = Name.split(" "); 
```

我已经拆分了它，但是现在我如何将这 2 个单词存储在 2 个不同的变量中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:11:24.047

```
String[] result = Name.split(" ");
String firstName = result[0]; 
```

尝试遵循[Java 命名约定](http://java.about.com/od/javasyntax/a/nameconventions.htm)并将变量名称更改为以小写字母开头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T16:11:26.470

这真的需要二十秒才能抬头……

```
String[] nameParts = Name.split(" ");
String firstName = nameParts[0];
String surname = nameParts[1]; 
```

你不应该在没有先尝试自己的家庭作业的情况下发布到 SO，否则你将无法改进。请记住，如果只有一个名称，这将失败

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-06T16:11:31.417

的结果`split`将是一个包含两个名称的列表，而不仅仅是第一个，因此`FirstName`可能不是变量的最佳名称。:) 此外，常规变量不应大写；那是常量和类名。这是一种方法：

```
String[] names = fullName.split(" ");
String firstName = names[0];
String lastName = names[1]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-06T16:12:03.580

```
String name = "Jeremy Clarkson";
String[] names = name.split(" ");

String firstName = names[0];
String lastName = names[1]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-06T16:11:08.190

```
String[] nameStrings = "Jeremy Clarkson".split(" ");
String firstName = nameStrings[0];  
String surName = nameStrings[1]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-06T16:11:33.983

```
String[] names = Name.split(" ");
String firstName = names[0];
String lastName = names[1]; 
```

查看[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)以获取有关其`split()`工作原理的信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-06T16:20:21.890

好吧，如果将值放入数组中，则可以访问每个数组的值并将其复制到单个变量中（要访问它，请使用索引）：

```
String[]FirstName = Name.split(" ");
String value1 = FirstName[0];
String value2 = FirstName[1]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-20T14:52:21.937

建议的解决方案不适用于姓氏为 van Der Schyff 且名字为 Peter 的“Peter van Der Schyff”（荷兰/德国姓氏）。

```
String fullName = "Peter van Der Schyff";
String firstname = fullName.split(" ")[0];
String surname = fullname.substring(fullName.indexOf(' ')); 
```

# pdf-generation - PowerBuilder 12.5 Classic PDF SaveAs 在 Win7 x64 上创建 0 大小的文件

> ID：15853014
> 
> 赞同：1
> 
> 时间：2013-04-06T16:08:00.280
> 
> 标签：pdf-generation, ghostscript, powerbuilder, datawindow

## 平台：

视窗 7 **x64**

PB 12.5 经典

Ghostscript 9.07（安装了 x32 和 x64）

HP Laserjet PS 打印机安装为“Sybase DataWindow PS”

* * *

Datawindow 的 Data Export 选项卡具有 Format to configure:`PDF`和 Method: `Distill`。未选中“Distill custom postscript”和“Print using XSLFOP”复选框。

我单击`File | Run/Preview`并`File | Save Rows As`选择`PDF`另存为类型并输入pdf文件名并单击保存。它在一个消息框中说`Save Rows As failed`。我发现该文件已在磁盘上创建，但大小为 0 字节。

我注意到手册指出，如果未安装 Ghostscript，可能会发生这种情况。但是，我先安装了 x64，然后又安装了 x32 版本的 Ghostscript。我在 PB 手册中的某处安装了 x64，它提到我需要为操作系统平台安装 Ghostscript，并且由于我在 x64 Win7 上，所以我安装了 x64 Ghostscript。但是，它不适用于两者。

有什么问题？有人有什么想法吗？我已经在网络和 stackoverflow 上搜索了解决方案，每个人似乎都指向 x32 平台（在我看来）以及 XP 上。我之前的 XP 安装工作正常。我现在在 Win7 x64 上，需要它来处理它。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:56:11.340

我想我有同样的问题。问题出在 Ghostscript 软件的版本上：

[http://ghostscript.com/pipermail/gs-bugs/2012-July/026615.html](http://ghostscript.com/pipermail/gs-bugs/2012-July/026615.html)

您应该卸载 Ghostscript 并重新安装此版本：Ghostscript 8.71。你可以在这里下载：

[http://sourceforge.net/projects/ghostscript/files/GPL%20Ghostscript/8.71/](http://sourceforge.net/projects/ghostscript/files/GPL%20Ghostscript/8.71/) [http://sourceforge.net/projects/ghostscript/files/GPL%20Ghostscript/8.71/gs871w64.exe/download](http://sourceforge.net/projects/ghostscript/files/GPL%20Ghostscript/8.71/gs871w64.exe/download)

在此之后它应该工作:)

祝你好运！

兄弟。加博尔

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T10:28:49.117

大约 18 个月前，我们遇到了这个问题。IIRC 的基本问题是打印机的驱动程序必须是 64 位的，然后您必须使用适当的 64 位 Ghostcript exe gswin64c.exe。据我所知，Powerbuilder 作为 32 位应用程序是硬连接到 gswin32c.exe。

我最终不得不实际上手动执行 Powerbuilder 所做的事情。首先，我必须通过搜索注册表的相关部分来找到 gswin32c.exe 或 gswin64c.exe 的路径。这意味着搜索 64 位部分和 32 位部分，因为我们的应用程序不仅仅在 64 位机器上运行。我想我最终使用 ProcessMonitor 和 ProcessExplorer 来观察 Powerbuilder 的运行情况并模仿它在做什么。

确定 Ghostscript-EXE 的路径后，您可以手动将打印机设置为“Sybase DataWindow PS”并执行 pDw.Object.DataWindow.Print.FileName = sz_pathps 其中 sz_pathps 是 PostScript 文件所在的临时文件的路径通过蒸馏器生产。然后您执行 pDw.print(false,false) 并且您有一个 PostScript 文件。

然后，您可以使用在注册表中找到的 exe 路径手动调用 GhostScript。我使用的命令行参数是

-q -dNOPAUSE -dBATCH -dSAFER -sDEVICE=pdfwrite -sOutputFile=xxxxx.pdf -c .setpdfwrite -f yyyyy.ps

xxxxx.pdf 是您希望生成的 PDF 文件的路径，yyyyy.ps 是您使用蒸馏器生成的 PS 文件的路径。

手动调用 GhostScript-Exe 意味着调用 CreateProcess，然后调用 WaitForSingleObject。

这当然意味着您不能再使用 dw.saveas 并且必须提供一些菜单或图标来完成这项工作。

这确实很混乱，但我别无选择。这是“必须具备”的功能，所以我必须这样做。

好了，这是我对 stackoverflow 的第一个贡献，希望对您有所帮助。

问候，

理查德·夏普

# php - 包括_SERVER['DOCUMENT_ROOT']。_SERVER[ 'SCRIPT_NAME' ] 找不到当前正在运行的脚本

> ID：15853026
> 
> 赞同：0
> 
> 时间：2013-04-06T16:09:25.353
> 
> 标签：php, file, include

我正在尝试使用 $_SERVER['DOCUMENT_ROOT'] 变量包含文件。到目前为止，我尝试包含的每个文件都引发了 file-not-found 错误。我以为我只是弄错了目录，所以我尝试包含当前正在运行的脚本。我希望它递归地包含自己，直到它用完堆栈并摔倒。

```
echo( 'document root = ' . $_SERVER['DOCUMENT_ROOT'] . '<br>' );
echo( 'script name   = ' . $_SERVER['SCRIPT_NAME'] . '<br>' );

$szServerPath   = $_SERVER['DOCUMENT_ROOT'];
$szIncludePath  = $szServerPath . $_SERVER['SCRIPT_NAME'];
echo( "including     = " . $szIncludePath );
include( $szIncludePath ); 
```

这将产生以下输出：

```
document root = /var/httpd/htdocs
script name = /CSRC/Damflask/Main/Articles/index.php
including = /var/httpd/htdocs/CSRC/Damflask/Main/Articles/index.php
Warning: include_once(/var/httpd/htdocs/CSRC/Damflask/Main/Articles/index.php) [function.include]: failed to open stream: No such file or directory in /home/www/glmorriL/CSRC/Damflask/Main/Articles/index.php on line 33 
```

看起来它仍然找不到文件。我包含的所有其他文件都显示了相同的错误消息。为什么这行不通？

编辑：似乎差异是由于“别名”。 [http://php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)（参见 Jamie 2 年前的评论）。没有等效的路径吗？看起来 DOCUMENT_ROOT 对我来说完全没用。

谢谢，G

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:13:10.033

您可以从错误消息中看到您的文件路径应该是：

```
/home/www/glmorriL/CSRC/Damflask/Main/Articles/index.php 
```

所以显然`/var/httpd/htdocs/...`不会找到它。

尝试改用`__FILE__`魔法常数。

# c++ - 从派生类对象调用基类方法

> ID：15853031
> 
> 赞同：46
> 
> 时间：2013-04-06T16:10:01.030
> 
> 标签：c++, inheritance

如何从派生类对象调用被派生类覆盖的基类方法？

```
class Base{
  public:
    void foo(){cout<<"base";}
};

class Derived:public Base{
  public:
    void foo(){cout<<"derived";}
}

int main(){
  Derived bar;
  //call Base::foo() from bar here?
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-04-06T16:13:55.653

您可以始终(*) 使用*qualified-id*引用基类的函数：

```
#include <iostream>

class Base{
  public:
    void foo(){std::cout<<"base";}
};

class Derived : public Base
{
  public:
    void foo(){std::cout<<"derived";}
};

int main()
{
  Derived bar;
  //call Base::foo() from bar here?
  bar.Base::foo(); // using a qualified-id
  return 0;
} 
```

[还修正了OP的一些错别字。]

(*) 访问限制仍然适用，基类可能不明确。

* * *

如果`Base::foo`不是`virtual`，`Derived::foo`则不*覆盖* `Base::foo`。而是`Derived::foo` *隐藏* `Base::foo`。可以在以下示例中看到差异：

```
struct Base {
   void foo()         { std::cout << "Base::foo\n"; }
   virtual void bar() { std::cout << "Base::bar\n"; }
};

struct Derived : Base {
   void foo()         { std::cout << "Derived::foo\n"; }
   virtual void bar() { std::cout << "Derived::bar\n"; }
};

int main() {
    Derived d;
    Base* b = &d;
    b->foo(); // calls Base::foo
    b->bar(); // calls Derived::bar
} 
```

（`Derived::bar`即使您不使用`virtual`关键字也是隐式虚拟的，只要它的签名与 兼容`Base::bar`。）

一个*合格的 id*要么是形式`X :: Y`，要么只是`:: Y`. 前面的部分`::`指定我们要在哪里查找标识符`Y`。在第一种形式中，我们查找`X`，然后`Y` *从`X`的上下文中查找。*`Y`在第二种形式中，我们在全局命名空间中查找。

unqualified *-id*不包含 a `::`，因此（本身）不指定查找名称的上下文。

在一个表达式`b->foo`中，`b`和`foo`都是*不合格的 ids*。`b`在当前上下文中查找（在上面的示例中是`main`函数）。我们找到局部变量`Base* b`。因为`b->foo`具有类成员访问的形式，所以我们`foo`从上下文中查找`b`（或者更确切地说`*b`）的类型。`foo`所以我们从上下文中查找`Base`。我们将找到在`void foo()`内部声明的成员函数`Base`，我将其称为`Base::foo`.

对于`foo`，我们现在完成了，然后调用`Base::foo`。

对于`b->bar`，我们首先找到`Base::bar`，但它是声明的`virtual`。因为它是`virtual`，我们执行一个*虚拟调度*。这将调用对象`b`指向的类型的类层次结构中的最终函数覆盖器。因为`b`指向一个类型的对象`Derived`，所以最终的覆盖是`Derived::bar`.

`foo`从`Derived`的上下文中查找名称时，我们会发现`Derived::foo`。这就是为什么`Derived::foo`说*隐藏* `Base::foo`。诸如`d.foo()`or 之类的表达式，在 的成员函数中`Derived`，简单地使用`foo()`or `this->foo()`，将从 的上下文中查找`Derived`。

当使用*qualified-id*时，我们明确说明了查找名称的上下文。该表达式`Base::foo`表明我们`foo`要从上下文中查找名称`Base`（例如，它可以找到`Base`继承的函数）。**此外，它禁用虚拟调度。**

因此，`d.Base::foo()`会找到`Base::foo`并调用它；`d.Base::bar()`会找到`Base::bar`并调用它。

* * *

有趣的事实：纯虚函数可以有一个实现。它们不能通过虚拟调度调用，因为它们*需要*被覆盖。*但是，您仍然可以使用qualified-id*来调用他们的实现（如果他们有的话）。

```
#include <iostream>

struct Base {
    virtual void foo() = 0;
};

void Base::foo() { std::cout << "look ma, I'm pure virtual!\n"; }

struct Derived : Base {
    virtual void foo() { std::cout << "Derived::foo\n"; }
};

int main() {
    Derived d;
    d.foo();       // calls Derived::foo
    d.Base::foo(); // calls Base::foo
} 
```

* * *

请注意，类成员和基类的*访问说明符*都会影响您是否可以使用限定 ID在派生类型的对象上**调用**基类的函数。

例如：

```
#include <iostream>

struct Base {
public:
    void public_fun() { std::cout << "Base::public_fun\n"; }
private:
    void private_fun() { std::cout << "Base::private_fun\n"; }
};

struct Public_derived : public Base {
public:
    void public_fun() { std::cout << "Public_derived::public_fun\n"; }
    void private_fun() { std::cout << "Public_derived::private_fun\n"; }
};

struct Private_derived : private Base {
public:
    void public_fun() { std::cout << "Private_derived::public_fun\n"; }
    void private_fun() { std::cout << "Private_derived::private_fun\n"; }
};

int main() {
    Public_derived p;
    p.public_fun();        // allowed, calls Public_derived::public_fun
    p.private_fun();       // allowed, calls Public_derived::public_fun
    p.Base::public_fun();  // allowed, calls Base::public_fun
    p.Base::private_fun(); // NOT allowed, tries to name Base::public_fun

    Private_derived r;
    r.Base::public_fun();  // NOT allowed, tries to call Base::public_fun
    r.Base::private_fun(); // NOT allowed, tries to name Base::private_fun
} 
```

可访问性与名称查找正交。因此，名称隐藏不会对其产生影响（您可以在派生类中省略`public_fun`并`private_fun`在限定 ID 调用中获得相同的行为和错误）。

顺便说一下，错误与错误`p.Base::private_fun()`不同`r.Base::public_fun()`：第一个错误已经无法引用名称`Base::private_fun`（因为它是私有名称）。第二个无法转换`r`为`Private_derived&`-指针（基本上）。这就是为什么第二个来自内部或朋友的工作。`Base&``this``Private_derived``Private_derived`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-06T16:11:13.437

首先 Derived 应该从 Base 继承。

```
 class Derived : public Base{ 
```

那说

首先，你不能在 Derived 中有 foo

```
class Base{
  public:
    void foo(){cout<<"base";}
};

class Derived : public Base{

}

int main(){
  Derived bar;
  bar.foo() // calls Base::foo()
  return 0;
} 
```

其次，您可以让 Derived::foo 调用 Base::foo。

```
class Base{
  public:
    void foo(){cout<<"base";}
};

class Derived : public Base{
  public:
    void foo(){ Base::foo(); }
                ^^^^^^^^^^
}

int main(){
  Derived bar;
  bar.foo() // calls Base::foo()
  return 0;
} 
```

第三，您可以使用 Base::foo 的合格 id

```
 int main(){
    Derived bar;
    bar.Base::foo(); // calls Base::foo()
    return 0;
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-06T16:12:08.107

首先考虑`foo()`虚拟化。

```
class Base {
public:
    virtual ~Base() = default;

    virtual void foo() { … }
};

class Derived : public Base {
public:
    virtual void foo() override { … }
}; 
```

但是，这可以完成工作：

```
int main() {
    Derived bar;
    bar.Base::foo();
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-30T05:39:30.167

**一个重要的 [附加] 注意**：如果发生***名称隐藏***，您仍然会遇到编译错误。

在这种情况下，要么使用 using 关键字，要么使用限定符。此外，请参阅[此答案](https://stackoverflow.com/a/16837660/786356)。

```
#include <iostream>

class Base{
  public:
    void foo(bool bOne, bool bTwo){std::cout<<"base"<<bOne<<bTwo;}
};

class Derived : public Base
{
  public:
    void foo(bool bOne){std::cout<<"derived"<<bOne;}
};

int main()
{
  Derived bar;
  //bar.foo(true,true);      // error:    derived func attempted
  bar.foo(true);             // no error: derived func
  bar.Base::foo(true,true);  // no error: base func, qualified
  return 0;
} 
```

# css - CSS Color 网站是否考虑了链接？

> ID：15853032
> 
> 赞同：0
> 
> 时间：2013-04-06T16:10:08.497
> 
> 标签：css, hyperlink

我在决定我的网站的配色方案时遇到了麻烦，因为我已经选择了`background-color`，`color`但是链接在访问的不同状态下的外观、悬停等与我的主要颜色不协调。

我知道如何控制链接上的颜色：

```
a:link
{
    color: #66FF33;
}
a:visited
{
    color: #FF0000;
}
a:hover
{
    color: #FFFF66;
}
a:active
{
    color: #66FF33;
} 
```

我的问题是在我的脑海中处理 6 种颜色，2 种主要颜色和 4 种用于链接的颜色，看看它们在我更改一种时是否会发生冲突等，我知道有很多网站可以帮助您选择配色方案，有没有哪个在其预览/生成 CSS 函数中考虑了访问、悬停等链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:18:04.910

我认为你应该只在网络浏览器中加载你试图弄乱的页面，并使用 Firebug 来改变你的 CSS 并测试不同的颜色。
为自己制作一个示例 HTML 页面，其中包含指向已访问和未访问站点的链接。添加一个包含单元格的表格，您可以更改颜色并在浏览器中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:20:37.110

```
Choose colors that do not overlap themselves, and avoided as much as you can the too many colors, unless if this is the concept.
Webpages are often designed in 2-3 basic, contrasted or complementary colours. 
For starters, it is good to counsel websites that offer combinations but occasionally it is good to try and develop your own style.
Do not forget to research the well-designed pages on the internet,
as aesthetics is something dynamic.
The main thing is the content and the character of the site that will determine
and the aesthetics and color. 
```

# mysql - MySQL/JPA：如何创建正确的关系和级联？

> ID：15853034
> 
> 赞同：0
> 
> 时间：2013-04-06T16:10:21.903
> 
> 标签：mysql, sql, database-design, jpa, jpa-2.0

我的项目给我留下了深刻的印象，但突然间我注意到我做错了什么，因为每次创建、合并、删除我都是手动进行的，但我应该让 JPA 为我处理这件事对吗？

我所做的是创建数据库，然后从中创建实体。所以[这是我的数据库](http://pastebin.com/6dAfmryt)，所以你们可以理解我的概念问题。

以一种简单的方式： An`user`有一个`address`，只有一个地址。这`address`由`city`和`state`组成`country`。我希望能够创建、更新`user address`逐级联。

我认为我的由 JPA 生成的映射是错误的（或者我的理解是错误的），让我展示一下：

```
public class User {
  ..
  //bi-directional many-to-one association to UserAddress
  @ManyToOne(cascade = CascadeType.ALL) // should be one to one ?
  @JoinColumn(name="id_user_address")
  private UserAddress userAddress;
  ..
}

public class UserAddress {
  ..

  //bi-directional many-to-one association to User
  @OneToMany(mappedBy="userAddress", fetch=FetchType.EAGER)
  private List<User> users;

  //bi-directional many-to-one association to AddressCity
  @ManyToOne
  @JoinColumn(name="id_city")
  private AddressCity addressCity;

  //bi-directional many-to-one association to AddressState
  @ManyToOne
  @JoinColumn(name="id_state")
  private AddressState addressState;

  //bi-directional many-to-one association to AddressCountry
  @ManyToOne
  @JoinColumn(name="id_country")
  private AddressCountry addressCountry;
  ..
} 
```

我认为`user`有`one adress only`，所以它应该是`OneToOne`映射？`UserAdress`关于`country`和`state`也是如此`city`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T06:54:02.043

如果您想允许多个用户使用同一地址，@ManyToOne 就是您想要的。如果您使用@O​​neToOne，则每个地址只能有一个用户。

# spring - 为具有不同参数的相同 url 模式创建两个方法

> ID：15853035
> 
> 赞同：111
> 
> 时间：2013-04-06T16:10:41.667
> 
> 标签：spring, spring-mvc

我有一个 url “serachUser” 可能带有两个不同值（请求参数）userId 或 UserName 的场景。

所以为此我创建了两种方法

```
public String searchUserById(@RequestParam long userID, Model model) 
public ModelAndView searchUserByName(@RequestParam String userName) 
```

但是我得到了不明确的映射发现异常。Spring可以处理这种情况吗？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-04-06T16:25:40.523

您可以使用该[`params`](https://docs.spring.io/spring/docs/5.0.8.RELEASE/javadoc-api/org/springframework/web/bind/annotation/RequestMapping.html#params--)参数按 HTTP 参数进行过滤。在您的情况下，它将类似于：

```
@RequestMapping(value = "/searchUser", params = "userID")
public String searchUserById(@RequestParam long userID, Model model) {
  // ...
}

@RequestMapping(value = "/searchUser", params = "userName")
public ModelAndView searchUserByName(@RequestParam String userName) {
  // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-25T20:09:42.170

如果您不传递任何值，则允许任何方式的请求参数为空，它将为空，那么您可以编写如下代码：

```
@RequestMapping(value = "/searchUser", params = {"userID","userName"})
public String searchUserById(@RequestParam long userID,@RequestParam String 
userName, 
Model model) {    
if(userID != null){
//..
}else{
// ...
} 
```

# php - php - 矩阵 - 我在哪里犯了错误？

> ID：15853037
> 
> 赞同：1
> 
> 时间：2013-04-06T16:11:01.417
> 
> 标签：php, arrays, loops, matrix

创建具有以下输出的程序：

a 00000000
b 00000000
c 00000X00
d 00000000
e 00000000
f 000X0000
g 00000000
h 00000X00
12345678

用户在程序开始时输入二维数组。基于这个序列（坐标）在桌子上绘制 X。

条件：必须使用数组和循环。

我 18 岁，两周前开始学习 php。我在完成这项任务时遇到了麻烦。谁能帮我 ？谢谢！

对不起！

这就是我所做的：

```
<?php
$input = array(2 => array(5),5 => array(3),7 => array(6));
$range = array('a','b','c','d','e','f','g','h');
$length = 8;

$output = '';
foreach($range as $index => $letter)
{
$output .= "$letter ";

for($i = 0; $i < $length; ++$i)
{
$output .= (array_key_exists($index, $input) && in_array($i, $input[$index])) ? 'X' : '0';
}

$output .= "\n";
}

echo $output;
?> 
```

我得到了这个输出：

a 00000000
b 00000000
c 00000X00
d 00000000
e 00000000
f 000X0000
g 00000000
h 000000X0

而不是这个：

a 00000000
b 00000000
c 00000X00
d 00000000
e 00000000
f 000X0000
g 00000000
h 00000X00
12345678

我在哪里犯错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:12:34.220

`7 => array(6)`应该`7 => array(5)`

[http://sandbox.onlinephpfunctions.com/code/423262c6a4bcdb8693c179dc620966d779b65a51](http://sandbox.onlinephpfunctions.com/code/423262c6a4bcdb8693c179dc620966d779b65a51)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-16T04:35:11.017

```
<?php
$input = array(2 => array(5),5 => array(3),7 => array(5));
$range = array('a','b','c','d','e','f','g','h');
$length = 8;

$output = '';
$x='';
foreach($range as $index => $letter)
{
    $output .= "$letter ";
    for($i = 0; $i < $length; ++$i)
    {
        $output .= (array_key_exists($index, $input) && in_array($i, $input[$index])) ? 'X' : '0';
    }

    $output .= "\n";
    $x.= 1+$index;
}

$output .= $x;
echo $output;

?> 
```

这将输出

```
a 00000000
b 00000000
c 00000X00
d 00000000
e 00000000
f 000X0000
g 00000000
h 00000X00
12345678 
```

# c# - 如何保存多维数组索引？

> ID：15853038
> 
> 赞同：1
> 
> 时间：2013-04-06T16:11:05.650
> 
> 标签：c#, arrays, loops, reference

基本上我的第一个任务是将'0'的位置保存在一个整数中。使用标准数组非常简单。此代码循环遍历数组（大小：8），直到找到 0，然后将其保存为位置。请参见下面的代码：

ps：n 是对保存在其他地方的数组的引用。

```
int position = 0;
        this.nodesExpanded++;
        // Loop through the array to get the position of where '0' is
        for (int i = 0; i < n.getPuzzle().length; i++){
            if (n.getPuzzle()[i] == 0){
                position = i;
                break;
            }
        } 
```

我的最终任务是使多维数组（大小：[3, 3]）成为可能。所以这是我迄今为止创建的：

```
for (int x = 0; x < 3; x++)
        {
            for (int y = 0; y < 3; y++)
            {
                if (n.getPuzzle()[x,y] == 0)
                {
                    **position = ;**
                    break;
                }
            }//end y loop
        }//end x loop 
```

那么如何将数组引用保存到某个位置的值呢？我猜“位置”需要是 int 以外的东西。

如果您需要更多说明，请务必发表评论，提前抱歉并谢谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:12:55.863

您可以使用 a`Tuple`来存储该位置。或者您可以创建自己的数据结构。

示例：最后您可以看到如何访问元组项。

```
var positions = new List<Tuple<int, int>>();

            for (int x = 0; x < 3; x++)
            {
                for (int y = 0; y < 3; y++)
                {
                    if (n.getPuzzle()[x,y] == 0)
                    {
                        positions.Add(new Tuple<int, int>(x,y));
                        break;
                    }
                }//end y loop
            }//end x loop

            if(positions.Any())
            {
                var xpos = positions[0].Item1;
                var ypos = positions[0].Item2;
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:26:53.830

我发现存储多维数组索引的一种自然方法是使用大小为维数的单维数组。

因此，如果您有一个`object[,,] A`和索引`int[] i`，您将使用表达式索引到 A 中`A[i[0],i[1],i[2]]`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:47:34.510

它的工作方式与您的一维数组相同，但您需要保留两个位置值。我`int`在示例中使用了 s，但您可能希望使用自定义结构或元组（如 AD.Net）所说。

```
int xpos = -1;
int ypos = -1;
for (int x = 0; x < 3; x++)
{
    for (int y = 0; y < 3; y++)
    {
        if (n.getPuzzle()[x,y] == 0)
        {
            xpos = x;
            ypos = y;
            break;
        }
    }//end y loop
}//end x loop
if (!(xpos > -1 && ypos > -1)) ; // 0 was not found 
```

# javascript - 如何将两个符号之间的字符串的一部分复制到javascript中的另一个字符串中？帮我...

> ID：15853040
> 
> 赞同：0
> 
> 时间：2013-04-06T16:11:10.327
> 
> 标签：javascript

```
var var1="hi (help) me"; 
```

我想将之间的字母复制`()`到一个新变量`var2`中。也就是“帮助”这个词。我是 Javascript 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:12:47.323

您可以使用[substring()](http://www.w3schools.com/jsref/jsref_substring.asp)和[indexOf()](http://www.w3schools.com/jsref/jsref_indexof.asp)来提取`parenthesis`.

**[现场演示](http://jsfiddle.net/Ff45Y/)**

```
var var2 = var1.substring(var1.indexOf('(')+1, var1.indexOf(')')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-10T11:45:00.743

Slice() 方法可用于将字符串的一部分提取或复制到新字符串中，使原始字符串保持原样。以下是如何使用它：

**代码：**

```
var var1="hi (help) me"; 
var var2 = var1.slice(4,8);
console.log(var2);
```

# ios - 使用 AFNetworking 按顺序下载图像

> ID：15853046
> 
> 赞同：0
> 
> 时间：2013-04-06T16:11:26.797
> 
> 标签：ios, afnetworking, nsoperation, nsoperationqueue

如何使用 AFNetworking 按顺序下载图像？通过“按顺序”，我还指`success`按顺序执行块。

`NSOperationQueue`最初我认为使用 a并将每个设置`AFImageRequestOperation`为下一个的依赖项就足够了。像这样：

```
- (void) downloadImages
{
    { // Reset
        [_downloadQueue cancelAllOperations];
        _downloadQueue = [[NSOperationQueue alloc] init];
        _images = [NSMutableArray array];
    }
    AFImageRequestOperation *previousOperation = nil;
    for (NSInteger i = 0; i < _imageURLs.count; i++) {
        NSURL *URL = [_imageURLs objectAtIndex:i];
        NSURLRequest *request = [NSURLRequest requestWithURL:URL];
        AFImageRequestOperation *operation = [AFImageRequestOperation 
                                              imageRequestOperationWithRequest:request 
                                              imageProcessingBlock:nil 
        success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
            [_images addObject:image];
            NSLog(@"%d", i);
        } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {}];

        if (previousOperation) {
            [operation addDependency:previousOperation];
        }
        previousOperation = operation;

        [_downloadQueue addOperation:operation];
    }
} 
```

`i`下载图像时按顺序打印。但是，当请求已经被缓存时，成功块将被乱序处理。我怀疑这是一个`NSOperation`限制，而不是 AFNetworking。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T18:43:14.940

您的解决方案可以正常工作，这是另一种方法：

对于“完美”的用户体验，您应该并行发出所有操作并按顺序处理图像（如果不需要，请不要等待）。
（这里的错误处理方式不同）
你可以试试这个（未经测试，你可以更好地设计模型[不要只使用这样的数组]）：

```
- (void) processImage:(UIImage*)image
{
    //do something with the image or just [_images addObject:image]
}

- (void) downloadImages
{
    { // Reset
        [_downloadQueue cancelAllOperations];
        _downloadQueue = [[NSOperationQueue alloc] init];
    }

    __block NSMutableArray* queue = [[NSMutableArray alloc] initWithCapacity:[_imageURLs count]];

    for (NSURL* url in _imageURLs) {
        __block NSLock* lock = [[NSLock alloc] init];
        __block NSMutableArray* container = [NSMutableArray new];
        [lock lock];
        [queue addObject:@[lock,container,url]];
        NSURLRequest *request = [NSURLRequest requestWithURL:url];
        void(^compBlock)(NSURLRequest *request,
                         NSHTTPURLResponse *response,
                         UIImage *image) = ^(NSURLRequest *request,
                                             NSHTTPURLResponse *response,
                                             UIImage *image)
        {
            [container addObject:image];
            [lock unlock];
        };
        NSOperation *operation = [AFImageRequestOperation imageRequestOperationWithRequest:request
                                                                      imageProcessingBlock:nil
                                                                                   success:compBlock
                                                                                   failure:compBlock];
        [_downloadQueue addOperation:operation];
    }

    __block __weak id weakSelf = self;
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        for (NSArray* arr in queue) {
            NSLock* lock = arr[0];
            [lock lock];
            NSMutableArray* container = arr[1];
            if ([container count]) {
                [weakSelf processImage:container[0]]; //might want to call this on main thread
            } else {
                //error on url = arr[2]
            }
            [lock unlock];
        }
    });    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:21:21.097

作为一种解决方法，我将图像存储在字典中，并在每次请求成功时按顺序处理它们。像这样：

```
- (void) downloadImages
{
    { // Reset
        [_downloadQueue cancelAllOperations];
        _downloadQueue = [[NSOperationQueue alloc] init];
        _images = [NSMutableArray array];
        _imageDictionary = [NSMutableDictionary dictionary];
    }
    AFImageRequestOperation *previousOperation = nil;
    for (NSInteger i = 0; i < _imageURLs.count; i++) {
        NSURL *URL = [_imageURLs objectAtIndex:i];
        NSURLRequest *request = [NSURLRequest requestWithURL:URL];
        AFImageRequestOperation *operation = [AFImageRequestOperation 
                                              imageRequestOperationWithRequest:request 
                                              imageProcessingBlock:nil 
        success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
            [_imageDictionary setObject:image forKey:@(i)];
            [self processImages];
        } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {}];

        if (previousOperation) {
            [operation addDependency:previousOperation];
        }
        previousOperation = operation;

        [_downloadQueue addOperation:operation];
    }
}

- (void) processImages 
{
    for (NSInteger i = _images.count; i < _imageURLs.count; i++) {
        UIImage *image = [_imageDictionary objectForKey:@(i)];
        if (!image) break;
        [_images addObject:image];
        NSLog(@"%d", i);
    }
} 
```

这总是按顺序打印`i`。

# c++ - C++ - SDL/OpenGL 加载图像的颜色被反转

> ID：15853050
> 
> 赞同：3
> 
> 时间：2013-04-06T16:11:33.403
> 
> 标签：c++, opengl, sdl, sdl-image

我正在尝试将图像加载到我的游戏中。它是用 C++ 编写的，带有 SDL 和 OpenGL，以及 SDL_Image 框架。我已经获得了图像，并根据我的需要对其进行了旋转/反转，但是有两个主要问题。

~~首先，图像的颜色完全反转。（即蓝色-> 红色）我的格式为“GL_RGB”或“GL_RGBA”，具体取决于每个像素的字节数。我尝试过使用 PNG、JPEG 和 BMP，但它们都一样。我迷路了！~~ --感谢 datenwolf 纠正我的愚蠢错误！

其次，图像绘制一次，仅此而已。它不会在另一个缓冲区上重新绘制，它只会显示一次，然后在绘制下一帧时立即消失。

```
GLuint loadTexture()
{
SDL_Surface* image = IMG_Load( "/Users/<My name>/Pictures/pacman board.jpeg" );

SDL_DisplayFormatAlpha(image);

unsigned object(0);

glGenTextures(1, &object);

glBindTexture(GL_TEXTURE_2D, object);

glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);

int Mode = NULL;

if(image->format->BytesPerPixel == 3) {Mode = GL_RGB;}
else if(image->format->BytesPerPixel == 4) {Mode = GL_RGBA;}

glTexImage2D(GL_TEXTURE_2D, 0, Mode, image->w, image->h, 0, Mode, GL_UNSIGNED_BYTE, image->pixels);

SDL_FreeSurface(image);
return object;
}

int main(int argc, char * argv[])
{
SDL_Init(SDL_INIT_EVERYTHING);

SDL_GL_SetAttribute(SDL_GL_RED_SIZE, 8);
SDL_GL_SetAttribute(SDL_GL_GREEN_SIZE, 8);
SDL_GL_SetAttribute(SDL_GL_BLUE_SIZE, 8);
SDL_GL_SetAttribute(SDL_GL_ALPHA_SIZE, 8);
SDL_GL_SetAttribute(SDL_GL_BUFFER_SIZE, 32);
SDL_GL_SetAttribute(SDL_GL_DEPTH_SIZE, 16);
SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);

SDL_WM_SetCaption("HI", NULL);
SDL_SetVideoMode(600, 600, 32, SDL_OPENGL);

glClearColor(0,0,0,1);
glViewport(0, 0, 600, 600);

glShadeModel(GL_SMOOTH);

glMatrixMode(GL_PROJECTION);
glLoadIdentity();

unsigned int pad_texture = 0;
pad_texture = loadTexture();

//---MAIN LOOP---\\

bool isRunning = true;
SDL_Event event;
while (isRunning)
{
    while (SDL_PollEvent(&event))
    {
        if (event.type == SDL_QUIT) { isRunning = false; }
        if (event.type == SDL_KEYUP && event.key.keysym.sym == SDLK_ESCAPE) {isRunning = false;}   
    }

    glClear(GL_COLOR_BUFFER_BIT);
    gluOrtho2D(0, 600, 0, 600); // For some reason, I prefer having '0,0' at the bottom left.

    glPushMatrix();

    glEnable(GL_TEXTURE_2D);
    glBindTexture(GL_TEXTURE_2D,pad_texture);

    glBegin(GL_QUADS);

    glTexCoord2d(0, 1); glVertex2f(0, 0);
    glTexCoord2d(1, 1); glVertex2f(600, 0);
    glTexCoord2d(1, 0); glVertex2f(600, 600);
    glTexCoord2d(0, 0); glVertex2f(0, 600);
    glEnd();

    glDisable(GL_TEXTURE_2D);

    glPopMatrix(); //Stop drawing

    SDL_GL_SwapBuffers();   
}
SDL_Quit();    
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:17:51.393

大多数图像文件格式具有 BGR 或 BGRA 顺序的像素数据。如果您使用 RGB 排序加载此类图像数据，则蓝色和红色通道将被交换，当然。

从 1.4 版开始，OpenGL 也提供了这些像素格式。你必须要么使用像 GLEW 这样的扩展包装器，要么获取并安装一个 current`glext.h`来访问新的格式令牌。查看[http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml](http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml)以获得 OpenGL-3 核心及更高版本中支持的格式的完整列表。对于较旧的 OpenGL，即 OpenGL-1.4 到 OpenGL-2.1，请查看[http://www.opengl.org/sdk/docs/man2/xhtml/glTexImage2D.xml](http://www.opengl.org/sdk/docs/man2/xhtml/glTexImage2D.xml)

### 更新

您的图像仅显示一次是由于以下原因：

```
while (isRunning)
{
    /*...*/

    glClear(GL_COLOR_BUFFER_BIT);
    gluOrtho2D(0, 600, 0, 600); // For some reason, I prefer having '0,0' at the bottom left. 
```

`gluOrtho2D`乘以矩阵上已有的内容。这就是`gluOrtho2D`上一次迭代中所做的。您还让矩阵模式处于“悬空”状态。作为一般规则，您应该始终在每次绘图迭代开始时重新设置整个 OpenGL 绘图状态（视口、清晰颜色、清晰深度、所有矩阵）。在你的情况下

```
while (isRunning)
{
    /*...*/

    glViewport(0, 0, win_width, win_height);

    glClearColor(0,0,0,1);
    glClear(GL_COLOR_BUFFER_BIT);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, win_width, 0, win_height, -1, 1); // gluOrtho2D is the most useless wrapper ever..., just put a -1, 1 as additional parameters to glOrtho

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glShadeModel(GL_SMOOTH); 
```

# asp.net - 将 ASP.NET 文本框控件 .text 内容转换为日期/时间格式

> ID：15853054
> 
> 赞同：6
> 
> 时间：2013-04-06T16:11:46.753
> 
> 标签：asp.net, vb.net, ms-access, calendarextender, datetimeformatinfo

我正在尝试插入数据库 - 有关事件的各种详细信息。asp.net 文本框正在使用日历扩展器（因此会弹出一个小日历并用正确格式的日期填充文本框）。我的 Access 数据库中的 EventDate 字段属于日期/时间类型。我需要将文本/字符串转换为日期/时间格式

到目前为止，我已经尝试过：

VB：

> ```
> Protected Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
> 
>     Dim oleDbConn As New OleDb.OleDbConnection(ConfigurationManager.ConnectionStrings("BookMeetConnString").ConnectionString)
>     Dim SqlString As String = "Insert into Events(EventTitle,EventDescription,EventDate,EventCategory) Values
>    (@f1,@f2,@f3,@f4)"
>     Dim cmd As OleDbCommand = New OleDbCommand(SqlString, oleDbConn)
> 
>     Dim strDate As String = tb_eventdate.Text
>     Dim dtfi As New System.Globalization.DateTimeFormatInfo
>     dtfi.ShortDatePattern = "dd/MM/yyyy"
>     dtfi.DateSeparator = "/"
>     Dim objDate As DateTime = Convert.ToDateTime(strDate, dtfi)
> 
>     cmd.CommandType = CommandType.Text
>     cmd.Parameters.AddWithValue("@f1", tb_eventtitle.Text)
>     cmd.Parameters.AddWithValue("@f2", tb_eventdescription.Text)
>     cmd.Parameters.AddWithValue("@f3", tb_eventdate.Text)
>     cmd.Parameters.AddWithValue("@f4", dd_eventcategory.Text)
>     oleDbConn.Open()
>     cmd.ExecuteNonQuery()
>     System.Threading.Thread.Sleep("2000")
>     Response.Redirect("~/calendar.aspx")
> End Sub 
> ```

这是我的客户端代码仅供参考：

> ```
>  <h1>Add An Event!<ajaxToolkit:ToolkitScriptManager
>  ID="ToolkitScriptManager1" 
>                    runat="server">
>                </ajaxToolkit:ToolkitScriptManager>
>             </h1>
>             <p>Title of Event:
>                 <asp:TextBox ID="tb_eventtitle" runat="server"></asp:TextBox>
>             </p>
>             <p>Event Description:
>                 <asp:TextBox ID="tb_eventdescription" runat="server"></asp:TextBox>
>             </p>
>             <p>Event Date:
>                 <asp:TextBox ID="tb_eventdate" runat="server"></asp:TextBox>
>                 <ajaxToolkit:CalendarExtender ID="tb_eventdate_CalendarExtender" runat="server" 
>                     TargetControlID="tb_eventdate">
>                 </ajaxToolkit:CalendarExtender>
>             </p>
>             <p>Event Category:
>                 <asp:DropDownList ID="dd_eventcategory" runat="server" 
>                     DataSourceID="SqlDataSource1" DataTextField="CategoryTitle" 
>                     DataValueField="CategoryTitle">
>                 </asp:DropDownList>
>             </p>
>             <p>
>                 <asp:Button ID="Button1" runat="server" Text="Submit" />
>             </p> 
> ```

当我尝试填写表格时，我收到此错误：

![日期时间错误](https://i.stack.imgur.com/UJ8Ka.png)

我的两个问题是：

1.  上面的代码有什么问题，如何成功使用 DateTimeFormatInfo 类将字符串转换为日期/时间？
2.  附带说明，日历扩展器以美国时间格式 (MM/DD/YYYY) 将日期输入到文本框中，如何将其更改为英国 (DD/MM/YYYY) 格式（我看不到明显的属性在属性对话框中执行此操作？）

提前感谢您的回答！

亚当

编辑：更新代码如下：

> ```
> Protected Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
> 
>     Dim oleDbConn As New OleDb.OleDbConnection(ConfigurationManager.ConnectionStrings("BookMeetConnString").ConnectionString)
>     Dim SqlString As String = "Insert into Events(EventTitle,EventDescription,EventDate,EventCategory) Values
>  (@f1,@f2,@f3,@f4)"
>     Dim cmd As OleDbCommand = New OleDbCommand(SqlString, oleDbConn)
>     cmd.CommandType = CommandType.Text
>     cmd.Parameters.AddWithValue("@f1", tb_eventtitle.Text)
>     cmd.Parameters.AddWithValue("@f2", tb_eventdescription.Text)
>     cmd.Parameters.AddWithValue("@f3", DateTime.ParseExact(tb_eventdate.Text, "dd/MM/yyyy",
>    CultureInfo.InvariantCulture))
>     cmd.Parameters.AddWithValue("@f4", dd_eventcategory.Text)
>     oleDbConn.Open()
>     cmd.ExecuteNonQuery()
>     System.Threading.Thread.Sleep("2000")
>     Response.Redirect("~/calendar.aspx")
> End Sub 
> ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T16:15:20.873

我建议你使用`DateTime.ParseExact`静态方法，尤其是这个超载：

`DateTime.ParseExact(textBox.Text, "dd/MM/yyyy",`**`CultureInfo.InvariantCulture`**`)`

这将按照您指定的具体格式解析您拥有的文本（`"dd/MM/yyyy"`目前，**大小写很重要**，因为`mm`它是分钟而不是`MM`几个月）。使用`CultureInfo.InvariantCulture`保证将从格式字符串（第二个参数）中检索日期分隔符。我注意到如果使用当前文化，它会覆盖您传递给的格式字符串的某些方面`ParseExact`。

* * *

### 关于文化信息的说明

不变的文化也很好，因为您的本地开发环境可能具有与部署环境不同的区域信息设置。通常，.NET在所有调用和隐式格式化或解析中都使用**当前区域性。**`.ToString`当明确地强制格式和文化不变性时，您不太容易出现无法在本地重现但存在于生产应用程序中的问题。

* * *

### 关于日期/时间格式的说明

通过精确解析，日期时间格式应与输入格式*严格*匹配。然后，您应该考虑以下示例：

*   `dd`仅匹配两位数的天数。所以`"dd/MM/yyyy"`它会匹配`"01/01/2013"`，但会失败，`"1/1/2013"`因为它需要日期部分的确切位数。如果您不想使用前导零，请改用：`d/M/yyyy`。单个字母表示少于几天的一位`10`数字，其余的两位数字。
*   `MM`匹配两位数的月份，因此适用于`dd`vs.`d`的所有内容对于月份都是相同的。
*   `yyyy`预计年份为 4 位数。如果您使用两位数年份，请`yy`改用。

* * *

### 关于一些 ADO.NET 提供程序的说明

事实证明，MS Access 就是这种情况，正确解析的日期时间对象不足以使查询工作。目前，以下代码

```
 cmd.Parameters.AddWithValue(...) 
```

用于向查询添加参数。但是，这种方法忽略了将信息传递给 ADO.NET 数据库提供程序，该提供程序告诉参数使用什么数据库类型。我在一些论坛上读到 MS Access/OleDb 无法在所有情况下解析正确的类型。因此，我推荐以下方法：

```
Dim prm as OleDbParameter = _
   New OleDbParameter("@dateTimeParameterName", OleDbType.DateTime)
prm.Value = value  'value is an instance of `System.DateTime` parsed 
                   'from the input
cmd.Parameters.Add(prm) 
```

上面的代码允许显式指定参数数据库类型，因此 OleDb 驱动程序现在能够正确地将`DateTime`对象传递给 MS Access 数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-09T14:34:11.007

**我使用了以下短代码：**

```
//myDateValue is System.DateTime object.
OleDbCommand commandObject = new OleDbCommand(); 
...   
commandObject.Parameters.Add(new OleDbParameter("@ADDED_DATE_PARAM", OleDbType.Date).Value = myDateValue); 
```

# r - 在 R 中映射空间分布

> ID：15853055
> 
> 赞同：1
> 
> 时间：2013-04-06T16:11:48.970
> 
> 标签：r, map, distribution, spatial

我的数据集包括 17 个站点，每个站点都有 24 小时的温度值。我想在每个小时内映射每个站点的值，并且在所有时间都这样做。我想做的是类似于图像的东西。

![在此处输入图像描述](https://i.stack.imgur.com/acUuT.png)

数据格式如下：

```
 N2     N3     N4    N5     N7     N8    N10    N12   N13    N14   N17   N19    N25    N28   N29    N31    N32
1 1.300 -0.170 -0.344 2.138  0.684  0.656  0.882  0.684 1.822  1.214 2.046 2.432  0.208  0.312 0.530  0.358  0.264
2 0.888 -0.534 -0.684 1.442 -0.178 -0.060  0.430 -0.148 1.420  0.286 1.444 2.138 -0.264 -0.042 0.398 -0.196 -0.148
3 0.792 -0.564 -0.622 0.998 -0.320  1.858 -0.036 -0.118 1.476  0.110 0.964 2.048 -0.480 -0.434 0.040 -0.538 -0.322
4 0.324 -1.022 -1.128 1.380 -0.792  1.042 -0.054 -0.158 1.518 -0.102 1.354 2.386 -0.708 -0.510 0.258 -0.696 -0.566
5 0.650 -0.774 -0.982 1.124 -0.540  3.200 -0.052 -0.258 1.452  0.028 1.022 2.110 -0.714 -0.646 0.266 -0.768 -0.532
6 0.670 -0.660 -0.844 1.248 -0.550  2.868 -0.098 -0.240 1.380 -0.012 1.164 2.324 -0.498 -0.474 0.860 -0.588 -0.324
  MeteoSwiss
1       -0.6
2       -1.2
3       -1.0
4       -0.8
5       -0.4
6       -0.2 
```

其中 N2, N3, ...m MeteoSwiss 是气象站，每行显示该站每小时的温度值。

```
id  Longitude   Latitude
2   7.1735          45.86880001
3   7.17254         45.86887001
4   7.171636    45.86923601
5   7.18018         45.87158001
7   7.177229    45.86923001
8   7.17524         45.86808001
10  7.179299    45.87020001
12  7.175189    45.86974001
13  7.179379    45.87081001
14  7.175509    45.86932001
17  7.18099  45.87262001
19  7.18122  45.87355001
25  7.15497  45.87058001
28  7.153399 45.86954001
29  7.152649 45.86992001
31  7.154419 45.87004001
32  7.156099 45.86983001
MeteoSwiss  7.184    45.896 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T20:50:32.673

我定义了一个或多或少类似于您的数据的玩具示例：

```
vals <- matrix(rnorm(24*17), nrow=24)
cds <- data.frame(id=paste0('N', 1:17),
                  Longitude=rnorm(n=17, mean=7.1),
                  Latitude=rnorm(n=17, mean=45.8))
vals <- as.data.frame(t(vals))
names(vals) <- paste0('H', 1:24) 
```

该`sp`包定义了几个类和方法来存储和显示空间数据。对于您的示例，您应该使用 `SpatialPointsDataFrame`该类：

```
library(sp)

mySP <- SpatialPointsDataFrame(coords=cds[,-1], data=data.frame(vals)) 
```

以及`spplot`显示信息的方法：

```
spplot(mySP, as.table=TRUE,
       col.regions=bpy.colors(10),
       alpha=0.8, edge.col='black') 
```

![spplot.points](https://i.stack.imgur.com/V56V1.png)

此外，您可能会发现该`spacetime`包很有用（[JSS 上的论文](http://www.jstatsoft.org/v51/i07)）。

# node.js - 请求发射器不会在 Express 中发出“结束”

> ID：15853056
> 
> 赞同：2
> 
> 时间：2013-04-06T16:11:57.580
> 
> 标签：node.js, express

我遇到请求发射器确实发出“数据”事件但不发出“结束”事件的情况。我不确定如何排除故障。你会怎么做？

```
var Review = require('../lib/review')
    , qs = require('querystring');

exports.processReview = function(req, res){
        var body = '';
        req.setEncoding('utf8');
        req.on('data', function(chunk){body += chunk});
        req.on('end', function(){
            console.log('got here: ' + body);
            var obj = qs.parse(body);
            var review = new Review({
                title: obj.param('title'),
                content: obj.param('content'),
                submittedBy: obj.param('submittedBy'),
                recommendedFor: obj.param('recommendedFor')
            });
            console.log('New Review: ' + JSON.stringify(review));
            res.end('Ok\n');
        });
        res.end('Ok\n');
        console.log('_________end______' + body);
    };

    exports.displayForm = function(req, res){
        var html = '<html><head><title>some head</title></head><body><h1>Review Form</h1>'
            + '<form method="post" action="/process/review" >'
            + '<p>Title: <input type="text" name="title" /></p>'
            + '<p>Content: <input type="text" name="content" /></p>'
            + '<p>Nickname: <input type="text" name="submittedBy" /></p>'
            + '<p>Recommended for: <input type="text" name="recommendedFor" /></p>'
            + '<p><input type="submit" value="Submit Review" /></p>'
            + '</form></body></html>';
        res.setHeader('Content-Type', 'text/html');
        res.setHeader('Content-Length', Buffer.byteLength(html));
        res.end(html);
    }; 
```

您将如何解决此问题？问题是什么？谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:40:50.937

如果您使用的是 express`bodyParser`或任何类似的中间件，那么`end`在它到达您的处理程序之前已经发出。

但就像我在评论中说的那样，如果你使用快递，你也会让事情变得对自己太难了。在这种情况下，您*无需*担心。`end`让中间件负责解析正文。

[并且通过使用`res.send`](https://github.com/visionmedia/express/blob/master/lib/response.js#L80)，您可以让 express 处理其他常见任务。 `send`基本上是围绕[节点的`end`](http://nodejs.org/api/http.html#http_response_end_data_encoding). 举几个例子，它：

*   接受 HTTP 状态、正文或两者作为参数
*   将对象转换为 json 响应
*   设置内容长度和其他标题
*   计算并设置 etag
*   为命中新缓存的请求发送 304
*   发送无身体发送的头部响应

您的处理程序可以编写如下：

```
var Review = require('../lib/review');

exports.processReview = function(req, res){
  // the bodyParser (if it is in fact already a middleware) will have parsed
  // the request body already into `req.body`
  var review = new Review({
    title: req.body.title,
    content: req.body.content,
    submittedBy: req.body.submittedBy,
    recommendedFor: req.body.recommendedFor
  });
  console.log('New Review: ' + JSON.stringify(review));
  // here you'd probably save your view before sending.
  res.send(200);
};

exports.displayForm = function(req, res){
  // here you could keep your html in a template (e.g. /views/form.html), then:
  // res.render("form");

  // but even without doing that, express handles setting the content-type
  // and body length, like so:
  var html = '<html><head><title>some head</title></head><body><h1>Review Form</h1>'
    + '<form method="post" action="/process/review" >'
    + '<p>Title: <input type="text" name="title" /></p>'
    + '<p>Content: <input type="text" name="content" /></p>'
    + '<p>Nickname: <input type="text" name="submittedBy" /></p>'
    + '<p>Recommended for: <input type="text" name="recommendedFor" /></p>'
    + '<p><input type="submit" value="Submit Review" /></p>'
    + '</form></body></html>';
  res.send(html);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:43:37.950

在您的`processReview`函数中，您将结束每个请求的响应。

```
 res.end('Ok\n'); // end response
    console.log('_________end______' + body); 
```

请求已完成处理，`res.end`不再监听/处理更多事件。由于您`res.end`无条件执行，它不会到达`end`请求的事件处理程序。

# python - 调用“pip install”时运行自定义任务

> ID：15853058
> 
> 赞同：20
> 
> 时间：2013-04-06T16:12:01.127
> 
> 标签：python, pip, distutils

我想让我的 python 包“可安装 pip”。问题是该软件包具有必须在用户的 init shell 脚本中获取的 shell 脚本（例如`.bashrc`）。

但安装后，用户并不确切知道脚本去了哪里（大概是`/usr/bin`，但我们不能保证）。当然，用户可以运行`which myscript.sh`并手动编辑他的初始化脚本。

但我想自动化这一步。我可以创建一个新的 distutils 命令，但`pip install`不会调用它。我可以扩展`distutils.command.install.install`，但安装通过 pip 中断（虽然通过 工作`python setup.py install`）：

**安装程序.py**

```
from distutils.command.install import install

class CustomInstall(install):
    def run(self):
        install.run(self)
        # custom stuff here
        do_my_stuff()

setup(..., cmdclass={'install': CustomInstall}) 
```

**贝壳**

```
$ pip install dist/mypackage.tar.gz
Unpacking ./dist/mypackage.tar.gz
  Running setup.py egg_info for package from file:///path/to/mypackage/dist/mypackage.tar.gz

Installing collected packages: mypackage
  Running setup.py install for mypackage
    usage: -c [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]
       or: -c --help [cmd1 cmd2 ...]
       or: -c --help-commands
       or: -c cmd --help

    error: option --single-version-externally-managed not recognized
    Complete output from command /path/to/.virtualenvs/myvirtualenv/bin/python -c "import setuptools;__file__='/tmp/pip-OFjrqU-build/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /tmp/pip-s4Yo4d-record/install-record.txt --single-version-externally-managed --install-headers /path/to/.virtualenvs/myvirtualenv/include/site/python2.7:
    usage: -c [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]
       or: -c --help [cmd1 cmd2 ...]
       or: -c --help-commands
       or: -c cmd --help

error: option --single-version-externally-managed not recognized

----------------------------------------
Command /path/to/.virtualenvs/myvirtualenv/bin/python -c "import setuptools;__file__='/tmp/pip-OFjrqU-build/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /tmp/pip-s4Yo4d-record/install-record.txt --single-version-externally-managed --install-headers /path/to/.virtualenvs/myvirtualenv/include/site/python2.7 failed with error code 1 in /tmp/pip-OFjrqU-build
Storing complete log in /path/to/myhome/.pip/pip.log 
```

通过安装软件包后运行自定义任务的最佳方法是什么`pip`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-06T16:37:14.923

您可以尝试使用`from setuptools.command.install import install`而不是使用`distutils`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-28T17:26:43.270

我更新代码以使用

> 点安装 <路径>

也是。在这个例子中，我们在安装过程中创建了一个目录结构。所有这些都进入 setup.py 文件，然后`$ pip install .`这个解决方案还回答了这个相关的帖子：[自定义 pip 安装命令未运行](https://stackoverflow.com/questions/36702902/custom-pip-install-commands-not-running)

```
from setuptools import setup
from setuptools.command.install import install
import pip
import os, errno

my_dir_paths = ['1', '2', '3']

class CustomInstall(install):

    def __init__(self, dist):
        super(install, self).__init__(dist)
        self.__current  = "/home/..."
        self.__post_install(self.__current)

    def run(self):
        install.run(self)

    def __post_install(self, curr):
        try:
            os.makedirs(os.path.join(curr, "data2"))
        except FileExistsError:
            print("Directory %s already exists!"%("data2"))
            pass

        for path in my_dir_paths:
            try:
                os.makedirs(os.path.join(curr, "data2", path))
            except FileExistsError:
                print("Directory %s already exists!"%(path))
                pass

setup(
    name='some_name',
    version='0.1.0',
    author='me',
    author_email='...',
    url='http://...',
    packages=setuptools.find_packages(),
    license='...',
    description='....',
    long_description=open('README.txt').read(),
    install_requires=[
       "pandas >= 1.0.5",
    ],
    python_requires='>=3.6',

    cmdclass={'install': CustomInstall}

) 
```

# javascript - 类别块有 DISPLAY:none - Prestashop

> ID：15853064
> 
> 赞同：2
> 
> 时间：2013-04-06T16:12:13.970
> 
> 标签：javascript, css, categories, prestashop, displaytag

我有一个问题，我不知道为什么，但是我的 prestashoop 类别停止工作。他们只是消失了。

我检查了代码，并以某种神奇的方式将`display:none`其应用于元素。

我如何跟踪应用了它的内容？我该如何修复它（不是 CSS 覆盖，使用 !important）。

页面如下：[Growmundocannabico.com](http://www.growmundocannabico.com)

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T06:55:53.990

如果没有 CSS 覆盖，至少在这里是不可能的，因为你有 prestashop 的代码而不是我们。它只能通过外部样式访问。

```
#categories_block_left .block_content .tree,#categories_block_left .block_content .dhtml{
display: block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T07:01:49.140

可能的解决方案 1：尝试清除 /tools/smarty/cache 文件夹

可能的解决方案 2：您有一个 javascript 错误：

```
ReferenceError: HoverWatcher is not defined
[Break On This Error]   

var cart_block = new HoverWatcher('#cart_block'); 
```

在您的 ajax-cart.js 文件中。尝试禁用 ajax 购物车，如果可行，然后修复 ajax-cart.js 中的错误

# android - 让 MapFragment 在 AlertDialog 中工作

> ID：15853066
> 
> 赞同：2
> 
> 时间：2013-04-06T16:12:28.160
> 
> 标签：android, android-alertdialog, android-maps-v2, mapfragment

我想在 AlertDialog 中显示 MapFragment。

在阅读了以下问题后，我最终提出了这个问题[括号中的观察结果是我的结果，有人可能已经让它们工作了，但我不会因为我把事情搞砸而忽视我惊人的天赋]：

*   [http://www.stackoverflow.com/questions/14659705/android-maps-api-v2-in-dialog](http://www.stackoverflow.com/questions/14659705/android-maps-api-v2-in-dialog) [不工作：地图对象未实例化]
*   [http://www.stackoverflow.com/questions/13733299/initialize-mapfragment-programmatically-with-maps-api-v2](http://www.stackoverflow.com/questions/13733299/initialize-mapfragment-programmatically-with-maps-api-v2) [不工作：非静态类中的静态方法问题]

尝试其中任何一个，或两者的陪审团操纵的婚姻，都会导致 IllegalArgument 或 NullPointer 异常。有时我抱怨无法在扩展的 MapFragment 中找到与 ID 关联的视图。

到目前为止我得到的相关代码：

```
public class PropDetailActivity extends Activity
{
    static final int PICK_REQUEST = 70003;

    private static final int TABLE_PROP_TYPES = 13,
        ADD_ID = Menu.FIRST + 1,
        DELETE_ID = Menu.FIRST + 3;                 

    Button btnLocation;

    private LocationManager daLocationManager;
    private String daProvider;
    private double daCurrentLat, daCurrentLong;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {   
        super.onCreate(savedInstanceState);
        setContentView(R.layout.prop_detail);

        btnLocation = (Button) findViewById(R.id.btnLocation);

        btnLocation.setOnClickListener(new OnClickListener()
        {           
            @Override
            public void onClick(View v)
            {
                openGps();
            }
        });

        doMapGubbinz();
    }

    private void openGps()
    {
        LayoutInflater inflater = LayoutInflater.from(this);

        LatLng here = new LatLng(daCurrentLat, daCurrentLong);

        MapFragment fragment = PreparedMapFragment.newInstance(here);

        FragmentTransaction transaction = getFragmentManager().beginTransaction();

        transaction.add(R.id.mapView, fragment)
            .commit();

        //daMap = fragment.getMap();

        View gps = inflater.inflate(R.layout.location_gps, null);

        new AlertDialog.Builder(this)
            .setTitle("Property location")
            .setView(gps)
            .show();

//      Marker currentLoc = daMap.addMarker(new MarkerOptions().position(here).title("Ubicación actual"));
//      
//      daMap.moveCamera(CameraUpdateFactory.newLatLngZoom(here, 15));
//      
//      daMap.animateCamera(CameraUpdateFactory.zoomTo(15), 2000, null);
    }

    public void doMapGubbinz()
    {
        daLocationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

        Criteria criteria = new Criteria();

        daProvider = daLocationManager.getBestProvider(criteria, false);

        daLocationManager.requestLocationUpdates(daProvider, 400, 1, this);

        Location location = daLocationManager.getLastKnownLocation(daProvider);     

        if (location != null) 
        {
            System.out.println("Provider " + daProvider + " has been selected.");
            onLocationChanged(location);
        } 
        daCurrentLat = location.getLatitude();
        daCurrentLong = location.getLongitude();
    }

    static public class PreparedMapFragment extends MapFragment
    {
        static MapFragment frag;

        public PreparedMapFragment() 
        {
            super();
        }

        public static MapFragment newInstance(LatLng pos)
        {
            frag = new MapFragment();

            UiSettings settings = frag.getMap().getUiSettings();

            settings.setAllGesturesEnabled(false);
            settings.setMyLocationButtonEnabled(false);

            frag.getMap().moveCamera(CameraUpdateFactory.newLatLngZoom(pos, 16));

            frag.getMap().addMarker(new MarkerOptions().position(pos).title("Ubicación actual"));

            frag.getMap().animateCamera(CameraUpdateFactory.zoomTo(15), 2000, null);

            return frag;
        }

//      @Override
//      public View onCreateView(LayoutInflater arg0, ViewGroup arg1, Bundle arg2)
//      {
//          View v = super.onCreateView(arg0, arg1, arg2);
//          initMap();
//          return v;
//      }
//
//      private void initMap()
//      {
//          UiSettings settings = getMap().getUiSettings();
//          
//          settings.setAllGesturesEnabled(false);
//          settings.setMyLocationButtonEnabled(false);
//          
//          getMap().moveCamera(CameraUpdateFactory.newLatLngZoom(daCurrentPos, 16));
//          
//          getMap().addMarker(new MarkerOptions().position(daCurrentPos).title("Ubicación actual"));
//
//          getMap().animateCamera(CameraUpdateFactory.zoomTo(15), 2000, null);
//      }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T12:41:20.360

您可以通过此在对话框中显示地图片段

```
public class DialogMapFragment extends DialogFragment {

    private SupportMapFragment fragment;

    public DialogMapFragment() {
        fragment = new SupportMapFragment();
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.mapdialog, container, false);
        getDialog().setTitle("");
        FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
        transaction.add(R.id.mapView, fragment).commit();

        return view;
    }

    public SupportMapFragment getFragment() {
        return fragment;
    }
}

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="0dp" >

    <FrameLayout
        android:id="@+id/mapView"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >
    </FrameLayout>

</RelativeLayout>` 
```

并通过 new DialogMapFragment().show(getFragmentManager(),"tag"); 显示对话框 您可以使用所需的任何按钮进一步自定义对话框片段

# php - mysql_connect() 是否不适用于 000webhost

> ID：15853075
> 
> 赞同：3
> 
> 时间：2013-04-06T16:13:02.690
> 
> 标签：php, mysql

如果您不能将 MySQL_connect 与[000webhost](http://www.000webhost.com/)一起使用，我想确认一下。

他们说 MySQL 的“远程连接”被禁用，但在做了一些研究后我找不到“远程连接”的真正含义。有谁知道它是否行不通？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:15:43.047

远程连接与您的 API 不同。

```
mysql_connect("localhost","user","pass"); 
```

与以下有很大不同：

*您的服务器 IP：* 98.568.321.210 例如。

```
mysql_connect("98.568.321.210","user","password"); 
```

第二个示例被阻止，因为您尝试从**远程**服务器建立连接，该远程服务器不是 localhost/127.0.0.1

所以总的来说，是的，虽然不推荐，但你可以使用`mysql_*`函数。

我建议调查`mysqli`或`pdo` 由于 mysql 被贬值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T18:21:28.950

当您使用 000webhost 创建数据库时，您将获得与此类似的连接详细信息

```
$mysql_host = "xxxx000webhost.com";
$mysql_database = "xxx_xxx";
$mysql_user = "xxx_xxx";
$mysql_password = "xxxx"; 
```

将这些保存在一个名为 dbinfo.php 的文件中

[使用PDO](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)连接到数据库

```
<?php
require_once("dbinfo.php");
$dbh = new PDO("mysql:host=$mysql_host;dbname=$mysql_database", $mysql_user, $mysql_password); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:17:47.637

您必须允许您的主机（您的 IP）从目标主机进入 mysql 用户设置

[MySQL用户添加手册](http://dev.mysql.com/doc/refman/4.1/en/adding-users.html)

# sql - 无论如何要加快大表的归档

> ID：15853078
> 
> 赞同：2
> 
> 时间：2013-04-06T16:13:08.523
> 
> 标签：sql, sql-server, sql-server-2008, archive

在午夜，我通过在存储过程中执行此操作来归档 SQL Server 2008 表：

```
INSERT INTO archive(col1, col2....)
select col1, col2...
from tablename
where date <= @endDate

delete from tablename where date <= @enddate 
```

这是表模式。我显然已经更改了列名。存档表的结构完全相同。

```
[col1] [uniqueidentifier] NOT NULL,
[col1] [bigint] NOT NULL,
[col1] [nvarchar](255) NOT NULL,
[col1] [nvarchar](255) NOT NULL,
[col1] [datetime] NOT NULL,
[col1] [nvarchar](75) NULL,
[col1] [nvarchar](255) NULL,
[col1] [nvarchar](255) NULL,
[col1] [nvarchar](255) NULL,
[col1] [nvarchar](255) NULL,
[col1] [nvarchar](50) NULL,
[col1] [nvarchar](50) NULL,
[col1] [nvarchar](1000) NULL,
[col1] [nvarchar](2) NULL,
[col1] [nvarchar](255) NULL,
[col1] [nvarchar](255) NULL, 
```

该表通常有大约 100,000 - 150,0000 行和多个索引，并且在我尝试执行此归档时仍然有信息写入其中。

此过程最快需要 6 分钟，最慢需要 13 分钟。

有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T17:30:02.363

分区是最快的技术，但会增加复杂性并且需要企业版。

另一种方法是使用 OUTPUT 子句将 DELETE 和 INSERT 组合成一个语句。[http://msdn.microsoft.com/en-us/library/ms177564.aspx](http://msdn.microsoft.com/en-us/library/ms177564.aspx)。带有 OUTPUT 子句的 DELETE 比单独的 INSERT/DELETE 语句更快。

```
DELETE FROM tablename 
    OUTPUT DELETED.Col1, DELETED.col2, DELETED.col3 DELETED.col4 -- etc
    INTO archive ( col1, col2, col3, col4 )
 WHERE date <= @enddate; 
```

如果由于并发插入而出现阻塞问题，则可以通过执行循环来批处理上述语句：

```
DECLARE @i int
SET @i = 1 
WHILE @i > 0
BEGIN
    DELETE  top (1000) FROM tablename 
        OUTPUT DELETED.Col1, DELETED.col2, DELETED.col3 DELETED.col4 -- Eric
        INTO archive ( col1, col2, col3, col4 )
    WHERE date <= @enddate  
    SET @i = @@rowcount
END 
```

附加说明：输出表有一些限制。它不能有触发器，不能涉及外键或有检查约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:19:22.510

处理归档的更合适的方法是创建和管理分区。

有几个可用的指南和教程，例如：http: [//blogs.msdn.com/b/felixmar/archive/2011/08/29/partitioning-amp-archiving-tables-in-sql-server-part-2 -split-merge-and-switch-partitions.aspx](http://blogs.msdn.com/b/felixmar/archive/2011/08/29/partitioning-amp-archiving-tables-in-sql-server-part-2-split-merge-and-switch-partitions.aspx)

# iphone - 核心绘图设备 UI 错误

> ID：15853080
> 
> 赞同：0
> 
> 时间：2013-04-06T16:13:11.010
> 
> 标签：iphone, ios, objective-c, ios-simulator

我的设备有错误。在IOS模拟器中一切都好。我想在设备上正确显示文本层。

这张来自设备的图片。 ![在此处输入图像描述](https://i.stack.imgur.com/IIqbk.png)

这张来自IOS模拟器的图片 ![在此处输入图像描述](https://i.stack.imgur.com/kd0go.png)

将文本层添加到图形的代码

```
-(void)scatterPlot:(CPTScatterPlot *)plot plotSymbolWasSelectedAtRecordIndex:(NSUInteger)index
{

    if ( symbolTextAnnotation ) {
        [self.graph.plotAreaFrame.plotArea removeAnnotation:symbolTextAnnotation];
        symbolTextAnnotation = nil;
    }

    CPTMutableTextStyle *hitAnnotationTextStyle = [CPTMutableTextStyle textStyle];
    hitAnnotationTextStyle.color    = [CPTColor whiteColor];
    hitAnnotationTextStyle.fontSize = 14.0f;
    hitAnnotationTextStyle.fontName = @"Helvetica";

    NSNumber *x          = [[self.plotDataFact objectAtIndex:index] valueForKey:@"x"];
    NSNumber *y          = [[self.plotDataFact objectAtIndex:index] valueForKey:@"y"];
    NSArray *anchorPoint = [NSArray arrayWithObjects:x, y, nil];

    NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init] ;
    [formatter setMaximumFractionDigits:2];
    NSString *yString = [formatter stringFromNumber:[NSNumber numberWithFloat:[y floatValue] * graphYStep]];

    CPTTextLayer *textLayer = [[CPTTextLayer alloc] initWithText:yString style:hitAnnotationTextStyle];
    symbolTextAnnotation              = [[CPTPlotSpaceAnnotation alloc] initWithPlotSpace:self.graph.defaultPlotSpace anchorPlotPoint:anchorPoint];
    symbolTextAnnotation.contentLayer = textLayer;

    textLayer.borderColor = [[UIColor whiteColor] CGColor];
    textLayer.borderWidth = 0.5;
    textLayer.cornerRadius = 4;
    textLayer.backgroundColor = [[UIColor colorWithRed:85.0/255.0 green:85.0/255.0 blue:85.0/255.0 alpha:1.0] CGColor];

    symbolTextAnnotation.displacement = CGPointMake(0.0f, 20.0f);
    [self.graph.plotAreaFrame.plotArea addAnnotation:symbolTextAnnotation];

} 
```

# javascript - 为什么 jCanvas 绘制错误的像素？

> ID：15853082
> 
> 赞同：2
> 
> 时间：2013-04-06T16:13:16.693
> 
> 标签：javascript, html5-canvas, jcanvas

我有一个像素图对象，每行包含一个列对象，其中包含颜色信息。然后我使用 选择颜色`switch()`，然后将其简单地绘制到画布上。这是代码：

```
 for(var pixX in pixmap) {
    for(var pixY in pixmap[pixX]) {
      switch(pixmap[pixX][pixY]) {
        case 1: var pixColor='lightgray'; break;
        case 2: var pixColor='black'; break;
        default: var pixColor='forestgreen'; break;
        }
      $('canvas#surface').drawRect({
        fillStyle: pixColor,
        width: 1, height: 1,
        x: pixX, y: pixY,
        fromCenter: false
        });
      }
    } 
```

它绘制像素，但像素位置以某种方式缩放，尽管像素实际上只有 1px 大。我无法确定，它放大了多少。当我在画布上画了一段时间后，位置是正确的。有什么问题？

**编辑：**我在 jsFiddle 上重新创建了它：http: [//jsfiddle.net/qyNTn/](http://jsfiddle.net/qyNTn/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-24T21:17:09.813

简单来说，`pixX`and`pixY`变量通过 JavaScript 转换为字符串。在将它们传递给 jCanvas 之前，您需要将它们转换为`pixX`数字。`pixY`

原因是因为 JavaScript 将每个键名（对于任何对象）存储为字符串。因此，当您使用循环遍历对象时`for in`，键名将始终是字符串。换句话说， `pixX`和`pixY`被视为字符串，因此您需要使用诸如`parseFloat`.

此外，jCanvas 在绘制形状时会执行许多数值计算，因此对于任何数值，它总是优先使用数字而不是字符串。

`drawRect()`无论如何，修复您的代码（以产生预期的行为）只需要对您的参数进行一次更改。

```
x: parseFloat(pixX), y: parseFloat(pixY), 
```

# android - Android：环形内的圆形图像

> ID：15853084
> 
> 赞同：0
> 
> 时间：2013-04-06T16:13:21.710
> 
> 标签：android, android-linearlayout, shapedrawable, layer-list

我想创建一个带有图像的按钮，如这张图片底部所示[https://trianglewiki.org/RGreenway_App/_files/android.jpg/_info/](https://trianglewiki.org/RGreenway_App/_files/android.jpg/_info/)。我正在尝试使用图层列表和形状可绘制对象，并且能够创建非常相似的按钮。我的问题是我的图像没有像我想要的那样在按钮内缩放。环形出现在图像的顶部，但图像不在其中。

我希望图像完全在环内。我认为我给出的参数值有问题。但这可能是我没有以正确的方式做到这一点。

有人可以检查我的 xml 文件并查看问题所在，或者向我提供如何操作的任何信息，以便我在按钮中获得与上面链接中相同的效果。谢谢

custom_button.xml（在 res/drawable 中）

```
<?xml version="1.0" encoding="utf-8"?>

<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
<item android:drawable="@drawable/map"/>

<item>
    <shape
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:innerRadius="20dp"
        android:innerRadiusRatio="1.75"
        android:shape="ring"
        android:thicknessRatio="25"
        android:useLevel="false" 
        >
        <gradient
            android:angle="90"
            android:endColor="#FFFFFF"
            android:startColor="#FFFFFF" />

        <size
            android:width="50dp" 
            android:height="40dp" />

        <solid android:color="#008000" />
    </shape>
</item>

</layer-list> 
```

custom_layout（在 res/drawable 中，用于线性布局的背景）

```
<?xml version="1.0" encoding="utf-8"?>
<shape
xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="rectangle">
<gradient
    android:angle="90"
    android:startColor="#FF000000"
    android:endColor="#FFFFFFFF"
    android:type= "linear" />   
<stroke
    android:width="1dp"
    android:color="#FF000000" />
<padding
    android:left="5dp"
    android:right="5dp"
    />
<size
    android:height="50dp"
    />
<solid
    android:color="#00FF00"
    />

</shape> 
```

header.xml（在 res/layout 中）

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/buttonBar"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
android:background="@drawable/custom_layout"
android:orientation="horizontal" >

<ImageButton
    android:id="@+id/home"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical"
    android:layout_weight="1"
    android:contentDescription="Button"
    android:paddingLeft="2dip"
    android:paddingRight="2dip"
    android:background="@drawable/custom_button"
    android:scaleType="fitXY"
    android:color="#ff0000"
     />

<ImageButton
    android:id="@+id/map"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical"
    android:layout_weight="1"
    android:background="@drawable/custom_button"
    android:contentDescription="Map"
    android:paddingLeft="2dip"
    android:paddingRight="2dip"
    android:scaleType="fitXY"
     />

<ImageButton
    android:id="@+id/weather"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical"
    android:layout_weight="1"
    android:background="@drawable/custom_button"
    android:contentDescription="Weather"
    android:paddingLeft="2dip"
    android:paddingRight="2dip"
    android:scaleType="fitXY"
    />

<ImageButton
    android:id="@+id/citilink"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical"
    android:layout_weight="1"
    android:background="@drawable/custom_button"
    android:contentDescription="CitiLink"
    android:paddingLeft="2dip"
    android:paddingRight="2dip"
    android:scaleType="fitXY"
    />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T15:36:25.443

如果我理解你的问题，你就过于复杂了。在[这里](https://stackoverflow.com/questions/3914329/round-button-in-android)寻找答案。这是我过去使用的技巧。

# android - 以特定格式发送彩信

> ID：15853086
> 
> 赞同：0
> 
> 时间：2013-04-06T16:13:24.193
> 
> 标签：android

我想通过Android手机中的消息发送带有图标的短信

并采用***以下格式***

![在此处输入图像描述](https://i.stack.imgur.com/XfC2v.png)

1.  使用彩信有可能实现吗？

2.  其他用户是否需要启用彩信才能接收彩信？

3.  有没有办法知道其他用户是否在他的手机中启用了彩信？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:16:55.450

> 使用彩信有可能实现吗？

您可以附加图像，但由客户决定将其放置在任何地方（或完全显示它）

> 其他用户是否需要启用彩信才能接收彩信？

另一台设备应具有支持彩信的短信客户端。如果用户禁用它，某些设备可能会拒绝接收该消息，但大多数不会。

> 有没有办法知道其他用户是否在他的手机中启用了彩信？

不。

# php - 标题不想移动到下一页

> ID：15853095
> 
> 赞同：-1
> 
> 时间：2013-04-06T16:14:11.093
> 
> 标签：php, header

我解决了我的旧问题，但现在我有了一个新问题:)

这是我的代码 [http://wklej.org/id/1004299/](http://wklej.org/id/1004299/)

第 41 行：//header('location:test.php?pytanie='.$next); 这是行不通的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:17:14.940

标题上方不应有任何输出。造成这种情况的原因有很多。例子。

```
<?php
header ("Location: test.php");
?> 
```

这不会引发错误

```
<?php
 echo "blabla";
header ("Location: test.php");
?> 
```

或者

```
<strong> test</strong>
<?php
header ("Location: test.php");
?> 
```

在你的情况下：

```
print_r($Array);
header ("Location: page.php"); 
```

会抛出错误。

# php - 使用正则表达式和 PHP 将段落拆分为句子

> ID：15853097
> 
> 赞同：12
> 
> 时间：2013-04-06T16:14:20.917
> 
> 标签：php, regex, text-segmentation

我是一个正则表达式菜鸟，并试图将段落分成句子。在我的语言中，我们在句子中间使用了很多缩写词（例如：bl.a.），所以我得出结论，我需要做的是寻找标点符号，然后是一个空格，然后是一个以大写字母开头的单词，例如：

```
[sentence1]...anymore. However...[sentence2] 
```

所以一段像：

```
Der er en lang og bevæget forhistorie bag lov om varsling m.v. i forbindelse med afskedigelser af større omfang. Det er ikke en bureaukratisk lovtekst blandt så mange andre. 
```

应该以这个输出结束：

```
[0] => Der er en lang og bevæget forhistorie bag lov om varsling m.v. i forbindelse med afskedigelser af større omfang.
[1] => Det er ikke en bureaukratisk lovtekst blandt så mange andre. 
```

而不是这个：

```
[0] => Der er en lang og bevæget forhistorie bag lov om varsling m.v. 
[1] => i forbindelse med afskedigelser af større omfang.
[2] => Det er ikke en bureaukratisk lovtekst blandt så mange andre. 
```

我找到了一个解决方案，它使用积极的后向功能来完成第一部分：

```
$regexp = (?<=[.!?] | [.!?][\'"]); 
```

进而

```
$sentences = preg_split($regexp, $paragraph, -1, PREG_SPLIT_NO_EMPTY); 
```

这是一个很好的起点，但由于缩写太多而分裂了太多次。

我试图这样做：

```
(?<=[.!?]\s[A-Z] | [.!?][\'"]) 
```

针对任何一个的每一次出现

```
. or ! or ? 
```

后跟一个空格和一个大写字母，但这不起作用。

有谁知道，是否有办法完成我想做的事情？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-06T17:11:34.817

用于拆分句子的 Unicode RegExp：`(?<=[.?!;])\s+(?=\p{Lu})`

在这里解释演示：[http ://regex101.com/r/iR7cC8](http://regex101.com/r/iR7cC8)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T16:24:41.700

搜索这种模式似乎仍然不可靠，但由于句子可能以换行结束，我会尝试以下方法

```
[.\!\?][\s\n\r\t][A-Z] 
```

我不认为你真的是为了前瞻的，对吧？（ !? 一起，所以使用 \ 转义它 - 告诉正则表达式忽略任何特殊含义）

# clojure - Compojure：可选的 URL 参数

> ID：15853103
> 
> 赞同：6
> 
> 时间：2013-04-06T16:15:06.973
> 
> 标签：clojure, compojure

我想在 Compojure 中定义一个资源，如下所示：

```
(ANY "myres/:id" [id] (handler)) 
```

我希望 :id 是可选的（取决于是否指定了 ID，我的 API 的行为会有所不同）。

如果我尝试访问，这可以正常工作

```
http://mydomain/myres/12 
```

但是，如果我尝试访问

```
http://mydomain/myres 
```

没有指定 ID，我得到 404。

有没有办法让参数 :id 是可选的？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-06T16:29:30.050

如何创建 2 个不同的路由，一个带有 id，另一个没有它，并从两个路由调用您的处理程序，如下所示：

```
(defn handler
    ([] "Response without id")
    ([id] (str "Response with id - " id)))

(defroutes my-routes
    (ANY "myres" [] (handler))
    (ANY "myres/:id" [id] (handler id))) 
```

# mercurial - 执行 hg clone 时中止且无消息

> ID：15853106
> 
> 赞同：0
> 
> 时间：2013-04-06T16:15:09.663
> 
> 标签：mercurial, tortoisehg, abort

我们使用 mercural-server 作为服务器上的中央存储库，Windows 开发人员使用 TortoiseHg 作为客户端。其中一位开发人员甚至无法克隆存储库——hg 以“abort:”响应，没有任何消息。

SSH 授权成功通过——在其他计算机上使用相同的密钥是可以的，我可以克隆存储库并在其中进行更改。

如果我在该开发人员的计算机上运行 hg --traceback clone <...> 我得到：

```
Traceback (most recent call last):
File "mercurial\dispatch.pyo", line 88, in _runcatch
File "mercurial\dispatch.pyo", line 743, in _dispatch
File "mercurial\dispatch.pyo", line 514, in runcommand
File "mercurial\dispatch.pyo", line 833, in _runcommand
File "mercurial\dispatch.pyo", line 804, in checkargs
File "mercurial\dispatch.pyo", line 740, in <lambda>
File "mercurial\util.pyo", line 475, in check
File "mercurial\commands.pyo", line 1234, in clone
File "mercurial\hg.pyo", line 267, in clone
File "mercurial\hg.pyo", line 121, in peer
File "mercurial\hg.pyo", line 101, in _peerorrepo
File "mercurial\sshpeer.pyo", line 59, in __init__
File "mercurial\sshpeer.pyo", line 73, in validate_repo
File "mercurial\util.pyo", line 137, in popen3
File "subprocess.pyo", line 679, in __init__
File "subprocess.pyo", line 896, in _execute_child
WindowsError: [Error 2]
abort: 
```

目标文件夹是可写的。我什至不知道问题的根源是什么，因为在其他 Windows 计算机上使用相同版本的 TortoiseHg（TortoiseHg 2.7.1（使用 Mercurial 2.5.2））并且使用相同的存储库可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T21:10:50.143

在这种情况下，你应该去源头 - `hg clone https://www.mercurial-scm.org/repo/hg`。查看 sshpeer.py 第 73 行及其周围的上下文，似乎在尝试执行 ssh 调用时发生了错误。

最可能的原因是：

1.  开发人员在某处的 hgrc 中有一个混乱的`ui.ssh`条目。可能他们已经指定如下：

    ```
    [ui]
    ssh = "ssh -C" 
    ```

    代替：

    ```
    [ui]
    ssh = ssh -C 
    ```

2.  开发人员可能已经指定了一个`ui.ssh`没有可用的适当 ssh 二进制文件的部分。默认情况下，TortoiseHg 将使用 PuTTY（它会安装二进制文件），但如果您说要使用其他东西，Mercurial 会服从。

如果检查以上没有帮助，克隆 mercurial 源，修改它以显示 ssh 命令（sshpeer ~line 73）并以纯模式安装它，然后尝试克隆。这将准确地告诉您正在调用什么。

```
hg clone https://www.mercurial-scm.org/repo/hg
cd hg
<path\to\python>\python setup.py --pure install
cd <other directory>
<path\to\python>\Scripts\hg.bat clone <repo> 
```

另外，请在适当的[错误跟踪器](https://www.mercurial-scm.org/wiki/BugTracker)上提出错误报告。

# ember.js - Ember 对象和 Ember Data 对象之间的区别

> ID：15853108
> 
> 赞同：12
> 
> 时间：2013-04-06T16:15:18.623
> 
> 标签：ember.js, ember-data

Ember Objects 和 Ember Data 中的对象有什么区别？我知道当服务器上有一些数据时我应该使用 Ember Data 模型，但是我应该在何时何地使用它们中的任何一个？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-06T17:55:04.190

注意：这是相当长的，有偏见的，代表我自己对此事的看法。可能不是*答案*。

类型`Object`是您可以称之为 Ember 中最“简单”的对象类型。它具有您可能会在现代应用程序中使用的*最基本功能，例如计算属性和可观察对象。*并且与运行时相关，它还允许绑定、过滤等。我将其称为通用对象，它可以扩展以创建其他类型，也可以与 mixins 结合以进一步增强其使用。它具有大量但有限的功能，但我不会称它为后端友好，只是因为我知道`DS.Model`它的功能。

Ember-Data`DS.Model`大量扩展了这些功能，`Object`以便在（大多数情况下）RESTful 环境中处理后端数据时提供更多有意义的功能。很像 ORM 支持的对象（例如：.NET 的 EntityFramework 或 Ruby 的 ActiveRecord），它提供了一组特性，因此该类型的对象`DS.Model`（它将允许状态管理（`DS.Store`、、、等）、存储中的和对象的能力（以及随后的后端 API）、关系/关联等。`Object``isDirty``isNew``isError``isNew``commit``rollback`

如果您使用的是 Ember-Data，则应该使用 type `Model`，因为它（旨在与商店一起使用，并且）在侧载、关联、复数以及整个 AJAX 请求/响应工作流程中使用模型类型。事实上，使用由 a`Model`支持的一个优点`Store`正是这样：让框架通过自己构建对正确 RESTful 资源的 AJAX 请求、管理响应、将 JSON 有效负载侧加载到正确类型的对象，同时向您*保证*可以在请求/处理/物化数据时使用模型（因此您可以在发生这种情况时转换视图/路由）。

它还在商店支持的对象本身（例如：）中为您提供了大量方便的功能`record.deleteRecord(); store.commit()`，最终，使我们更有效率，我们可以更快地构建应用程序。

话虽如此，这种方法也受到了批评，因为大量开发人员通常不喜欢或不喜欢使用人们所说的*技术魔法*；换句话说，他们不想使用它，因为他们觉得自己不能 100% 控制引擎盖下发生的事情。在我个人看来，同时我可以看到这些人来自哪里，我相信 Ember-Data 并没有帮助我提高工作效率，它要求的唯一回报是我与我的代码保持一致并且我遵循某些约定，对此我很满意。

回到`Object`，如果你不使用 Ember-Data，你应该使用`Object`类型作为你的模型。这意味着您将不得不手动完成所有这些任务（通常没什么大不了的）。因此，您必须手动创建 AJAX 请求、处理响应、将响应数据加载到您的对象中，并基本上维护客户端应用程序和 API 之间的所有通信工作流。优点是您将 100% 控制，但需要付出更多努力，如Robin Ward所述[。](http://eviltrout.com/2013/03/23/ember-without-data.html)您仍然可以使用路由 API 和使 Ember 成为现在这样的大多数强大功能。

因此，何时何地使用这些类型的问题实际上取决于您在后端拥有的架构以及您在此方面拥有的灵活性水平。

这不是可以为每个人提供明确答案的问题，但可以通过回答几个问题来解决，这些问题将评估使用 Ember-Data 的可行性（从长远来看）。

*   [我的 API 是否以Ember 约定](http://emberjs.com/guides/models/the-rest-adapter/#toc_json-conventions)定义的相同格式返回 JSON ？
*   如果这只是部分正确，我和我的团队是否可以简单地基于模型定义[映射以使所有内容都符合约定？](https://stackoverflow.com/questions/15552117/camelcased-model-names/15553071#15553071)
*   如果不是，我可以更改我的后端 API 以符合这些约定吗？
*   如果没有，我在哪里可以找到专门针对我的后端技术的适配器？
*   我找不到一个；编写自己的适配器是否可行？

回答完这些问题后，再考虑开发迭代和生命周期；想想从长远来看，用任何一种方法来维护它需要什么；并考虑社区中[其他](https://github.com/discourse/discourse) [人](https://grouptalent.com/blog/migrating-from-rails-to-ember)在决定他们的架构和/或开发策略时采取的路径。

归根结底，您必须了解这些对象在功能方面带来了什么，以及您是否需要它们来构建您的应用程序。恕我直言，Ember-Data 是大多数情况下要走的路，当我们接近（可能是 RC3 和然后）Ember 1.0 最终版时，它只会变得更好，它可能会将 Ember-Data 作为包的一部分包含在内。

我希望这可以帮助

# java - JOptionPane 是 否 选项

> ID：15853112
> 
> 赞同：4
> 
> 时间：2013-04-06T16:15:38.070
> 
> 标签：java, swing, applet, awt, joptionpane

我有一个 JOptionPane 和是和否按钮。但是，无论您单击哪个按钮，它仍然存在。帮助！继承人的代码：

```
int dialogButton = JOptionPane.YES_NO_OPTION;
            JOptionPane.showConfirmDialog (null, "Are you sure?","WARNING", dialogButton);
            if(dialogButton == JOptionPane.YES_OPTION) {
                System.exit(0);
            if(dialogButton == JOptionPane.NO_OPTION) {
                  remove(dialogButton);
                }
              } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-06T16:16:59.253

您实际上应该从选项窗格中获取结果：

```
dialogButton = JOptionPane.showConfirmDialog (null, "Are you sure?","WARNING", dialogButton); 
```

否则，它仍然设置为`JOptionPane.YES_NO_OPTION`。

清洁剂将是：

```
if (JOptionPane.showConfirmDialog(null, "Are you sure?", "WARNING",
        JOptionPane.YES_NO_OPTION) == JOptionPane.YES_OPTION) {
    // yes option
} else {
    // no option
} 
```

虽然，我不确定这一行在发布的代码中应该做什么：`remove(dialogButton);`.

有关更多详细信息和示例，请查看[如何制作对话框](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)教程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-28T06:58:19.993

```
int dialogButton = JOptionPane.showConfirmDialog (null, "Are you sure?","WARNING",JOptionPane.YES_NO_OPTION);

if(dialogButton == JOptionPane.YES_OPTION) {
System.exit(0);}else {remove(dialogButton);} 
```

这是正确的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T16:18:08.950

将代码更改为

`int dialogButton = JOptionPane.showConfirmDialog (null, "Are you sure?","WARNING", dialogButton);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T16:19:33.607

```
if(dialogButton == JOptionPane.YES_OPTION) { // <<< start
    System.exit(0);
        if(dialogButton == JOptionPane.NO_OPTION) {
            remove(dialogButton);
        }
}// <<< stop 
```

结果是由于外部`if`包含另一个`if`语句，请确保您没有在`if`语句旁边，它应该如下： -

```
if(dialogButton == JOptionPane.YES_OPTION) {
    System.exit(0);
}else {
    remove(dialogButton);
} 
```

另一件事是这一行`int dialogButton = JOptionPane.YES_NO_OPTION;`，将其更改为

```
int dialogButton = JOptionPane.showConfirmDialog (null, "Are you sure?","WARNING", dialogButton); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-29T23:28:21.077

如果您希望 JOptionPane 消失，那么您可以：

```
optionPane.setVisible(false); 
```

如果你不那么看一个不同的答案。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-02-09T11:25:53.790

```
if (JOptionPane.showConfirmDialog(this, "sfd", "sd", JOptionPane.YES_NO_OPTION) == JOptionPane.YES_OPTION) {
    jProgressBar1.setValue(jProgressBar1.getValue() + 10);
    jProgressBar1.setComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);
}
else {
    System.exit(0);
} 
```

# resharper - 在 resharper 中打开花括号后找不到换行设置

> ID：15853114
> 
> 赞同：0
> 
> 时间：2013-04-06T16:15:43.893
> 
> 标签：resharper

当我创建一个新的 javascript 构造函数时，我想这样做：

```
var PersonViewModel = function(){}; 
```

然后我在分号后按回车键并得到这个：

```
var PersonViewModel = function()
{
}; 
```

但我想要的是这样的：

```
var PersonViewModel = function()
{
   // so I can immediately continue writing code here
}; 
```

我希望在左大括号之后换行。

我在javascript选项中找不到设置，有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T20:29:30.850

ReSharper 非常努力地不弄乱用户输入（至少在输入正确时）。它可以帮助您不要触摸太多，但是如果您想完整地输入某些内容，它会尝试允许您这样做。但是您想要的功能打破了这一原则：当用户并排键入函数语句时，第二个将在第一个内部。

我建议只是键入`...function(){`并按 Enter 键。ReSharper 会`}`自动为您添加，因此您可以继续编写函数体。你会得到语法正确的代码，因为`;`在 JavaScript 中可以省略。ReSharper`;`无论如何都会突出显示缺失，并建议`;`在整个文件中添加所有缺失的内容。只需不时使用此功能即可使您的代码美观。

# c# - 更改 Gridview 页面后，Gridview 不会重新绑定数据

> ID：15853115
> 
> 赞同：2
> 
> 时间：2013-04-06T16:15:44.597
> 
> 标签：c#, asp.net, visual-studio-2010, gridview, ispostback

我正在尝试用亚马逊搜索结果填充我的 gridview。在页面加载的那一刻，数据源被数据填充。我想要做的是在按下搜索按钮后显示数据，但它显示“未找到记录”。我尝试了许多不同的方法，唯一有效的方法是没有回发，但问题是每次我在 gridview 上更改页面时，都会重新启动 GetProducts("Playstation") 命令。

我一直在寻找的解决方案：加载页面->单击按钮->用数据填充gridview->在gridview中选择新页面时，会显示数据，但不会再次启动Getproducts("Playstation")。

有没有办法做到这一点 ？

```
protected void Page_Load(object sender, EventArgs e) {
  Button1.Click += new EventHandler(this.GreetingBtn_Click);
  if (!Page.IsPostBack) {
    AmazonSearch us = new Amazon.PAAPI.AmazonSearch();
    GridView1.DataSource = us.GetProducts("Playstation");
  }
}
void Search(Object sender, EventArgs e) {
  Button clickedButton = (Button) sender;
  GridView1.DataBind();
}
protected void grid_PageIndexChanging(object sender, GridViewPageEventArgs e) {
  GridView1.PageIndex = e.NewPageIndex;
  GridView1.DataBind();
} 
```

**编辑**

感谢 FastGeeks anwser，我想通了。我在代码中添加了变量 ds 。并进行了以下更改：

```
DataSet ds = new DataSet();

protected void Page_Load(object sender, EventArgs e) {
  Button1.Click += new EventHandler(this.GreetingBtn_Click);
 }
void Search(Object sender, EventArgs e) {
  Button clickedButton = (Button) sender;
  AmazonSearch us = new Amazon.PAAPI.AmazonSearch();
  ds.Tables.Add(us.GetProducts("Playstation"));
  GridView1.DataSource = ds;
  Session["ds"] = ds;
  GridView1.DataBind();
}
protected void grid_PageIndexChanging(object sender, GridViewPageEventArgs e) {
  GridView1.PageIndex = e.NewPageIndex;
  ds = (DataSet)Session["ds"];
  GridView1.DataSource = ds;
  GridView1.DataBind();;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:16:47.683

您需要在绑定之前`DataSource`再次分配。`PageIndexChanging`

```
protected void grid_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    GridView1.PageIndex = e.NewPageIndex;
    GridView1.DataSource = us.GetProducts("Playstation");
    GridView1.DataBind();
} 
```

同样在 search 方法中分配 DataSource 。

```
void Search(Object sender,  EventArgs e)
{
    Button clickedButton = (Button)sender;
    GridView1.DataSource = us.GetProducts("Playstation");
    GridView1.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T07:49:44.823

我对此的看法是将亚马逊搜索的结果存储到 DataTable 中，然后将 DataTable 存储在会话变量中；这是完全可能的，因为 DataTable 是可序列化的并且将存储在会话中。

然后在您的 grid_PageIndexChanging 事件和 Search 方法中，您可以从会话中检索 DataTable 并重新分配您的数据，而无需重复 Amazon 搜索。

# android - Google Maps Api v2 - 具有自己的信息窗口的多个标记

> ID：15853119
> 
> 赞同：2
> 
> 时间：2013-04-06T16:16:17.403
> 
> 标签：android, google-maps, google-maps-markers, google-maps-android-api-2, google-maps-api-2

我正在尝试在地图上添加多个标记，每个标记都有自己的信息窗口（我需要信息窗口在多行上显示一些信息），但我不明白该怎么做。我已经阅读了 Google 文档，现在我正在寻找示例代码或教程。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:25:14.343

看看这段代码，有解释我的行为的注释。但这将为您创建`InfoWindow`一个预定义的 XML 布局，您必须在运行时创建一个填充。

接下来，我检查当前单击`InfoWindow`的标记是否是指示我的位置的标记，如果是，我呈现一个正确的`Toast`，如果不是，我让用户使用另一个 Activity 导航到该位置：

```
 // Setting a custom info window adapter for the google map
        map.setInfoWindowAdapter(new InfoWindowAdapter() {

            // Use default InfoWindow frame
            @Override
            public View getInfoWindow(Marker args) {
                return null;
            }

            // Defines the contents of the InfoWindow
            @Override
            public View getInfoContents(Marker args) {

                // Getting view from the layout file info_window_layout
                View v = getLayoutInflater().inflate(R.layout.info_window_layout, null);

                // Getting the position from the marker
                clickMarkerLatLng = args.getPosition();

                TextView title = (TextView) v.findViewById(R.id.tvTitle);
                title.setText(args.getTitle());

                    //Setting InfoWindow click listener
                map.setOnInfoWindowClickListener(new OnInfoWindowClickListener() {          
                    public void onInfoWindowClick(Marker marker) 
                    {
                        if (SGTasksListAppObj.getInstance().currentUserLocation!=null)
                        {   
                            if (String.valueOf(SGTasksListAppObj.getInstance().currentUserLocation.getLatitude()).substring(0, 8).contains(String.valueOf(clickMarkerLatLng.latitude).substring(0, 8)) &&
                                    String.valueOf(SGTasksListAppObj.getInstance().currentUserLocation.getLongitude()).substring(0, 8).contains(String.valueOf(clickMarkerLatLng.longitude).substring(0, 8)))
                            {
                                Toast.makeText(getApplicationContext(), "This your current location, navigation is not needed.",  Toast.LENGTH_SHORT).show();
                            }
                            else
                            {
                                FlurryAgent.onEvent("Start navigation window was clicked from daily map");
                                tasksRepository = SGTasksListAppObj.getInstance().tasksRepository.getTasksRepository();
                                for (Task tmptask : tasksRepository)
                                {
                                    String tempTaskLat = String.valueOf(tmptask.getLatitude());
                                    String tempTaskLng = String.valueOf(tmptask.getLongtitude());

                                    Log.d(TAG, String.valueOf(tmptask.getLatitude())+","+String.valueOf(clickMarkerLatLng.latitude).substring(0, 8));

                                    if (tempTaskLat.contains(String.valueOf(clickMarkerLatLng.latitude).substring(0, 8)) && tempTaskLng.contains(String.valueOf(clickMarkerLatLng.longitude).substring(0, 8)))
                                    {  
                                        task = tmptask;
                                        break;
                                    }
                                }
                                Intent intent = new Intent(getApplicationContext() ,RoadDirectionsActivity.class);
                                intent.putExtra(TasksListActivity.KEY_ID, task.getId());
                                startActivity(intent);

                            }
                        }
                        else
                        {
                            Toast.makeText(getApplicationContext(), "Your current location could not be found,\nNavigation is not possible.",  Toast.LENGTH_SHORT).show();
                        }
                    }
                });

                // Returning the view containing InfoWindow contents
                return v;

            }
        }); 
```

# regex - 尝试在 url 重写中替换破折号

> ID：15853137
> 
> 赞同：0
> 
> 时间：2013-04-06T16:17:42.823
> 
> 标签：regex, url-rewriting

我想更改 URL 从

```
example.com/shows/2013-car-show-pictures-set 
```

至

```
example.com/pics/2013+car+show+pictures+set 
```

如何使用重写替换所有破折号？

```
RewriteRule ^shows/(.*)/$       /pics/$1 [L,NC] 
```

# filter - CUDA 中的 FIR 滤波器（作为一维卷积）

> ID：15853140
> 
> 赞同：3
> 
> 时间：2013-04-06T16:17:56.583
> 
> 标签：filter, cuda, signal-processing

我正在尝试在 CUDA 中实现 FIR（有限脉冲响应）滤波器。我的方法很简单，看起来有点像这样：

```
#include <cuda.h>

__global__ void filterData(const float *d_data,
                           const float *d_numerator, 
                           float *d_filteredData, 
                           const int numeratorLength,
                           const int filteredDataLength)
{
    int i = blockDim.x * blockIdx.x + threadIdx.x;

    float sum = 0.0f;

    if (i < filteredDataLength)
    {
        for (int j = 0; j < numeratorLength; j++)
        {
            // The first (numeratorLength-1) elements contain the filter state
            sum += d_numerator[j] * d_data[i + numeratorLength - j - 1];
        }
    }

    d_filteredData[i] = sum;
}

int main(void)
{
    // (Skipping error checks to make code more readable)

    int dataLength = 18042;
    int filteredDataLength = 16384;
    int numeratorLength= 1659;

    // Pointers to data, filtered data and filter coefficients
    // (Skipping how these are read into the arrays)
    float *h_data = new float[dataLength];
    float *h_filteredData = new float[filteredDataLength];
    float *h_filter = new float[numeratorLength];

    // Create device pointers
    float *d_data = nullptr;
    cudaMalloc((void **)&d_data, dataLength * sizeof(float));

    float *d_numerator = nullptr;
    cudaMalloc((void **)&d_numerator, numeratorLength * sizeof(float));

    float *d_filteredData = nullptr;
    cudaMalloc((void **)&d_filteredData, filteredDataLength * sizeof(float));

    // Copy data to device
    cudaMemcpy(d_data, h_data, dataLength * sizeof(float), cudaMemcpyHostToDevice);
    cudaMemcpy(d_numerator, h_numerator, numeratorLength * sizeof(float), cudaMemcpyHostToDevice);  

    // Launch the kernel
    int threadsPerBlock = 256;
    int blocksPerGrid = (filteredDataLength + threadsPerBlock - 1) / threadsPerBlock;
    filterData<<<blocksPerGrid,threadsPerBlock>>>(d_data, d_numerator, d_filteredData, numeratorLength, filteredDataLength);

    // Copy results to host
    cudaMemcpy(h_filteredData, d_filteredData, filteredDataLength * sizeof(float), cudaMemcpyDeviceToHost);

    // Clean up
    cudaFree(d_data);
    cudaFree(d_numerator);
    cudaFree(d_filteredData);

    // Do stuff with h_filteredData...

    // Clean up some more
    delete [] h_data;
    delete [] h_filteredData;
    delete [] h_filter;
} 
```

过滤器有效，但由于我是 CUDA 编程的新手，我不确定如何优化它。

我看到的一个小问题是`dataLength`,`filteredDataLength`和`numeratorLength`在我打算在其中使用过滤器的应用程序中事先不知道。此外，即使`dataLength`是上述代码中的倍数`32`，也不能保证在最后应用。

当我将上面的代码与 ArrayFire 进行比较时，我的代码需要大约三倍的时间来执行。

有人对如何加快速度有任何想法吗？

编辑：已全部更改`filterLength`为`numeratorLength`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:12:42.373

我可以建议以下内容来加快您的代码速度：

1.  使用共享内存：它是一种类似于缓存的微型内存，但比全局卡内存快得多。您可以通过在 CUDA 文档中查找 __shared__ 关键字来找到有关它的更多信息。例如，您可以在共享内存中预取过滤器分子和大块数据，这将显着提高您的性能。在这种情况下，您需要特别注意数据对齐，因为它确实很重要，并且会减慢您的代码速度。
2.  考虑展开分子和的 for 循环。您可以查看 CUDA 文档中的 reduce-vector 示例。
3.  您还可以考虑将分子循环本身并行化。这可以通过向您的线程块添加一个额外的维度（比如“y”）来完成。您还需要将 sum 设为具有 numeratorLength 维度的共享向量。您还可以查看减少向量示例，了解如何在最后快速获取该向量的总和。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-19T15:33:00.893

您正在尝试通过 CUDA 内核直接评估一维卷积来计算滤波器输出。

在滤波器脉冲响应持续时间*较长*的情况下，您可以做的一件事来评估滤波后的输入，即使用 FFT 在共轭域中直接执行计算。下面我报告一个使用 CUDA Thrust 和 cuFFT 库的示例代码。它是在报告的基于 Matlab 的示例的直接翻译

[FFT卷积的低通滤波](http://www.dsprelated.com/dspbooks/sasp/Example_1_Low_Pass_Filtering.html)

让我否认此代码可以进行一些优化，但我更愿意将其保留原样，以便与 Matlab 的对应部分相比更容易。

```
#include <stdio.h>
#include <math.h>

#include <cufft.h>

#include <thrust\device_vector.h>
#include <thrust\sequence.h>

#define pi_f  3.14159265358979f                 // Greek pi in single precision

/****************/
/* SIN OPERATOR */
/****************/
class sin_op {

    float fk_, Fs_;

    public:

        sin_op(float fk, float Fs) { fk_ = fk; Fs_ = Fs; }

        __host__ __device__ float operator()(float x) const { return sin(2.f*pi_f*x*fk_/Fs_); }
};

/*****************/
/* SINC OPERATOR */
/*****************/
class sinc_op {

    float fc_, Fs_;

    public:

        sinc_op(float fc, float Fs) { fc_ = fc; Fs_ = Fs; }

        __host__ __device__ float operator()(float x) const 
        {
            if (x==0)   return (2.f*fc_/Fs_);
            else            return (2.f*fc_/Fs_)*sin(2.f*pi_f*fc_*x/Fs_)/(2.f*pi_f*fc_*x/Fs_);
        }
};

/********************/
/* HAMMING OPERATOR */
/********************/
class hamming_op {

    int L_;

    public:

        hamming_op(int L) { L_ = L; }

        __host__ __device__ float operator()(int x) const 
        {
            return 0.54-0.46*cos(2.f*pi_f*x/(L_-1));
        }
};

/*********************************/
/* MULTIPLY CUFFTCOMPLEX NUMBERS */
/*********************************/
struct multiply_cufftComplex {
    __device__ cufftComplex operator()(const cufftComplex& a, const cufftComplex& b) const {
        cufftComplex r;
        r.x = a.x * b.x - a.y * b.y;
        r.y = a.x * b.y + a.y * b.x;
        return r;
    }
};

/********/
/* MAIN */
/********/
void main(){

    // Signal parameters:
    int M = 256;                            // signal length
    const int N = 4;
    float f[N] = { 440, 880, 1000, 2000 };              // frequencies
    float Fs = 5000.;                       // sampling rate

    // Generate a signal by adding up sinusoids:
    thrust::device_vector<float> d_x(M,0.f);            // pre-allocate 'accumulator'
    thrust::device_vector<float> d_n(M);                // discrete-time grid
    thrust::sequence(d_n.begin(), d_n.end(), 0, 1);

    thrust::device_vector<float> d_temp(M);
    for (int i=0; i<N; i++) { 
        float fk = f[i];
        thrust::transform(d_n.begin(), d_n.end(), d_temp.begin(), sin_op(fk,Fs));
        thrust::transform(d_temp.begin(), d_temp.end(), d_x.begin(), d_x.begin(), thrust::plus<float>()); 
    }

    // Filter parameters:
    int L = 257;                        // filter length
    float fc = 600.f;                   // cutoff frequency

    // Design the filter using the window method:
    thrust::device_vector<float> d_hsupp(L);            
    thrust::sequence(d_hsupp.begin(), d_hsupp.end(), -(L-1)/2, 1);
    thrust::device_vector<float> d_hideal(L);           
    thrust::transform(d_hsupp.begin(), d_hsupp.end(), d_hideal.begin(), sinc_op(fc,Fs));
    thrust::device_vector<float> d_l(L);                
    thrust::sequence(d_l.begin(), d_l.end(), 0, 1);
    thrust::device_vector<float> d_h(L);                
    thrust::transform(d_l.begin(), d_l.end(), d_h.begin(), hamming_op(L));
    // h is our filter
    thrust::transform(d_hideal.begin(), d_hideal.end(), d_h.begin(), d_h.begin(), thrust::multiplies<float>());  

    // --- Choose the next power of 2 greater than L+M-1
    int Nfft = pow(2,(ceil(log2((float)(L+M-1))))); // or 2^nextpow2(L+M-1)

    // Zero pad the signal and impulse response:
    thrust::device_vector<float> d_xzp(Nfft,0.f);
    thrust::device_vector<float> d_hzp(Nfft,0.f);
    thrust::copy(d_x.begin(), d_x.end(), d_xzp.begin());
    thrust::copy(d_h.begin(), d_h.end(), d_hzp.begin());

    // Transform the signal and the filter:
    cufftHandle plan;
    cufftPlan1d(&plan, Nfft, CUFFT_R2C, 1);
    thrust::device_vector<cufftComplex> d_X(Nfft/2+1);
    thrust::device_vector<cufftComplex> d_H(Nfft/2+1);
    cufftExecR2C(plan, (cufftReal*)thrust::raw_pointer_cast(d_xzp.data()), (cufftComplex*)thrust::raw_pointer_cast(d_X.data()));
    cufftExecR2C(plan, (cufftReal*)thrust::raw_pointer_cast(d_hzp.data()), (cufftComplex*)thrust::raw_pointer_cast(d_H.data()));

    thrust::device_vector<cufftComplex> d_Y(Nfft/2+1);
    thrust::transform(d_X.begin(), d_X.end(), d_H.begin(), d_Y.begin(), multiply_cufftComplex());  

    cufftPlan1d(&plan, Nfft, CUFFT_C2R, 1);
    thrust::device_vector<float> d_y(Nfft);
    cufftExecC2R(plan, (cufftComplex*)thrust::raw_pointer_cast(d_Y.data()), (cufftReal*)thrust::raw_pointer_cast(d_y.data()));

    getchar();

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-25T13:24:24.297

除了我期望的其他答案对于持续时间*较长*的卷积核会更方便之外，我在下面报告了一个不同的实现，它更符合 OP 的初始尝试，我希望对于持续时间*短*的卷积核会更方便。这种实现基于利用共享内存中缓存的手写内核。更多细节可以在 DB Kirk 和 W.-m 的书中找到。W·胡

[大规模并行处理器编程，第二版：实践方法](https://rads.stackoverflow.com/amzn/click/com/0124159923)

```
#include <stdio.h>
#include <stdlib.h>

#include "TimingGPU.cuh"
#include "Utilities.cuh"

#define RG          10
#define BLOCKSIZE   8

/****************/
/* CPU FUNCTION */
/****************/
void h_convolution_1D(const float * __restrict__ h_Signal, const float * __restrict__ h_ConvKernel, float * __restrict__ h_Result_CPU, 
                      const int N, const int K) {

    for (int i = 0; i < N; i++) {

        float temp = 0.f;

        int N_start_point = i - (K / 2);

        for (int j = 0; j < K; j++) if (N_start_point + j >= 0 && N_start_point + j < N) {
            temp += h_Signal[N_start_point+ j] * h_ConvKernel[j];
        }

        h_Result_CPU[i] = temp;
    }
}

/********************/
/* BASIC GPU KERNEL */
/********************/
__global__ void d_convolution_1D_basic(const float * __restrict__ d_Signal, const float * __restrict__ d_ConvKernel, float * __restrict__ d_Result_GPU, 
                                       const int N, const int K) {

    int i = blockIdx.x * blockDim.x + threadIdx.x;

    float temp = 0.f;

    int N_start_point = i - (K / 2);

    for (int j = 0; j < K; j++) if (N_start_point + j >= 0 && N_start_point + j < N) {
        temp += d_Signal[N_start_point+ j] * d_ConvKernel[j];
    }

    d_Result_GPU[i] = temp;
}

/***************************/
/* GPU KERNEL WITH CACHING */
/***************************/
__global__ void d_convolution_1D_caching(const float * __restrict__ d_Signal, const float * __restrict__ d_ConvKernel, float * __restrict__ d_Result_GPU, 
                                         const int N, const int K) {

    int i = blockIdx.x * blockDim.x + threadIdx.x;

    __shared__ float d_Tile[BLOCKSIZE];

    d_Tile[threadIdx.x] = d_Signal[i];
    __syncthreads();

    float temp = 0.f;

    int N_start_point = i - (K / 2);

    for (int j = 0; j < K; j++) if (N_start_point + j >= 0 && N_start_point + j < N) {

            if ((N_start_point + j >= blockIdx.x * blockDim.x) && (N_start_point + j < (blockIdx.x + 1) * blockDim.x))

                // --- The signal element is in the tile loaded in the shared memory
                temp += d_Tile[threadIdx.x + j - (K / 2)] * d_ConvKernel[j]; 

            else

                // --- The signal element is not in the tile loaded in the shared memory
                temp += d_Signal[N_start_point + j] * d_ConvKernel[j];

    }

    d_Result_GPU[i] = temp;
}

/********/
/* MAIN */
/********/
int main(){

    const int N = 15;           // --- Signal length
    const int K = 5;            // --- Convolution kernel length

    float *h_Signal         = (float *)malloc(N * sizeof(float));
    float *h_Result_CPU     = (float *)malloc(N * sizeof(float));
    float *h_Result_GPU     = (float *)malloc(N * sizeof(float));
    float *h_ConvKernel     = (float *)malloc(K * sizeof(float));

    float *d_Signal;        gpuErrchk(cudaMalloc(&d_Signal,     N * sizeof(float)));
    float *d_Result_GPU;    gpuErrchk(cudaMalloc(&d_Result_GPU, N * sizeof(float)));
    float *d_ConvKernel;    gpuErrchk(cudaMalloc(&d_ConvKernel, K * sizeof(float)));

    for (int i=0; i < N; i++) { h_Signal[i] = (float)(rand() % RG); }

    for (int i=0; i < K; i++) { h_ConvKernel[i] = (float)(rand() % RG); }

    gpuErrchk(cudaMemcpy(d_Signal,      h_Signal,       N * sizeof(float), cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy(d_ConvKernel,  h_ConvKernel,   K * sizeof(float), cudaMemcpyHostToDevice));

    h_convolution_1D(h_Signal, h_ConvKernel, h_Result_CPU, N, K);

    d_convolution_1D_basic<<<iDivUp(N, BLOCKSIZE), BLOCKSIZE>>>(d_Signal, d_ConvKernel, d_Result_GPU, N, K);
    gpuErrchk(cudaPeekAtLastError());
    gpuErrchk(cudaDeviceSynchronize());

    gpuErrchk(cudaMemcpy(h_Result_GPU, d_Result_GPU, N * sizeof(float), cudaMemcpyDeviceToHost));

    for (int i = 0; i < N; i++) if (h_Result_CPU[i] != h_Result_GPU[i]) {printf("mismatch2 at %d, cpu: %d, gpu %d\n", i, h_Result_CPU[i], h_Result_GPU[i]); return 1;}

    printf("Test basic passed\n");

    d_convolution_1D_caching<<<iDivUp(N, BLOCKSIZE), BLOCKSIZE>>>(d_Signal, d_ConvKernel, d_Result_GPU, N, K);
    gpuErrchk(cudaPeekAtLastError());
    gpuErrchk(cudaDeviceSynchronize());

    gpuErrchk(cudaMemcpy(h_Result_GPU, d_Result_GPU, N * sizeof(float), cudaMemcpyDeviceToHost));

    for (int i = 0; i < N; i++) if (h_Result_CPU[i] != h_Result_GPU[i]) {printf("mismatch2 at %d, cpu: %d, gpu %d\n", i, h_Result_CPU[i], h_Result_GPU[i]); return 1;}

    printf("Test caching passed\n");

    return 0;
} 
```

# opengl - 我的着色器通过 glUniform1i 使用纹理有什么问题

> ID：15853148
> 
> 赞同：1
> 
> 时间：2013-04-06T16:18:56.237
> 
> 标签：opengl, glsl

在我使用 GLSL 程序的纹理中，只有一个纹理绑定到纹理单元 0。如下所示：

```
.......................
        glActiveTexture(GL_TEXTURE0);
        GLuint tid;
        glGenTextures(1, &tid);
        glBindTexture(GL_TEXTURE_2D, tid);
        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, img.width, img.height, 0,
                     img.format, GL_UNSIGNED_BYTE, img.data);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); 
```

然后通过一个统一变量通知frag shader（就像setUniform一样），这里的名字是“texture0”，对应于我的frag shader：

```
void CShader::setUniform( const char *name, int val )
    {
        int loc = getUniformLocation(name);
        glAssert();  //note!,my own assertion wrapping around glGetError.
              if( loc >= 0 )
        {
            glUniform1i(loc, val);

        } else {
            printf("Uniform: %s not found.\n",name);
        }
              glAssert();   //note!,my own assertion wrapping around glGetError.

    } 
```

出乎我的意料，它在最后`glAssert()`一行断言失败，并给我。出了什么`GL_INVALID_OPERATION`问题，我的显卡不支持这个操作吗？，不可能，我的`OpenGL`版本是 3.x。经过几个小时的挣扎，尝试评论了最后一个`glAssert()`，但另一个断言在我的 gldrawelements 调用中失败了。显然，我绝对认为原因`gldrawelements`失败是`glUniform1i`失败的。有人可以给我建议。

**编辑：**

来自 datenwolf 的建议，这里是 glAssert 的代码，非常简单，只需调用 glGetError 一次。

```
void _glAssert(const char * info, int line){
 char const* sz_GL_INVALID_ENUM="GL_INVALID_ENUM";
 char const* sz_GL_INVALID_VALUE="GL_INVALID_VALUE";
 char const* sz_GL_INVALID_OPERATION="GL_INVALID_OPERATION";
 char const* sz_GL_OUT_OF_MEMORY ="GL_OUT_OF_MEMORY";
GLenum result;
    if((result=glGetError()) != GL_NO_ERROR )
    {
        const char *  sz_result=NULL;
        switch(result)
        {
        case GL_INVALID_ENUM:
            sz_result = sz_GL_INVALID_ENUM;
        break;
        case GL_INVALID_VALUE:
            sz_result = sz_GL_INVALID_VALUE;
        break;
        case GL_INVALID_OPERATION:
            sz_result = sz_GL_INVALID_OPERATION;
        break;
        case GL_OUT_OF_MEMORY:
            sz_result = sz_GL_OUT_OF_MEMORY;
        break;
        }

        _assert(sz_result,info,line);
    }
}

#define glAssert() \
    _glAssert(__FILE__, __LINE__); 
```

顺便说一句，在我使用 glUniform1i 调用之前，我的着色器一切正常

```
attribute vec3 VertexPosition;
varying vec3 Color;
void main()
{
Color = vec3(0.5,0,0);
gl_TexCoord[0]  = gl_MultiTexCoord0;
gl_Position = gl_ModelViewProjectionMatrix * vec4( VertexPosition, 1.0 );
}

uniform sampler2D texture0;

varying vec3 Color;
void main() {

 vec4 texColor = texture2D( texture0, gl_TexCoord[0].st);
gl_FragColor= vec4(Color, 1.0)*texColor;
} 
```

我已经在着色器中删除了许多代码以简化问题。

对不起，我没有详细描述这一点。实际上，我对 opengl 的包装非常简单，没有复杂的东西，没有多线程。

这是用于将纹理和着色器脚本分别加载到GPU，内存中的构造函数，然后调用“compileandlink”方法编译着色器脚本，并立即调用setUniform。

```
IEntity(const char * szvs,const char * szfs): m_shader(new CShader(szvs,szfs)){
         ...........................
}

CCube::CCube():IEntity("v_simple.glsl","f_simple.glsl") {
    ...................

        IMAGE img;
        img.Load("texture.bmp");
        img.ExpandPalette();

        glActiveTexture(GL_TEXTURE0);
        GLuint tid;
        glGenTextures(1, &tid);
        glBindTexture(GL_TEXTURE_2D, tid);
        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, img.width, img.height, 0,
                     img.format, GL_UNSIGNED_BYTE, img.data);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);

        m_shader->compileandlink();
        m_shader->setUniform("texture0", 0);
} 
```

**CShader::compileandlink 方法**

```
bool CShader::compileandlink(){
            if(m_vsscript == NULL || m_fsscript == NULL)
                return false;

            if(strlen(m_vsscript) <= 0  || strlen(m_fsscript) <= 0)
                return false;

            glShaderSource(m_vs, 1, (const GLchar **) &m_vsscript, NULL);
            glCompileShader(m_vs);

            glShaderSource(m_fs, 1, (const GLchar **) &m_fsscript, NULL);
            glCompileShader(m_fs);

            glAttachShader(m_program, m_vs);
            glAttachShader(m_program, m_fs);
            //glBindFragDataLocation(m_program, 0, "FragColor");
            glLinkProgram(m_program);
            glAssert();

            GLint status;
            glGetProgramiv( m_program, GL_LINK_STATUS, &status );
            if( GL_FALSE == status ) {
            fprintf( stderr, "Failed to link shader program!\n" );
            GLint logLen;
            glGetProgramiv(m_program, GL_INFO_LOG_LENGTH,
            &logLen);

            if( logLen > 0 )
                {
                char * log = (char *)malloc(logLen);
                GLsizei written;
                glGetProgramInfoLog(m_program, logLen,
                    &written, log);
                printf("Program log: \n%s", log);
                free(log);
                }
            }

            return true;

    } 
```

**CShader::setUniform 方法**，正如我之前所说，在 glGetUniformiv 在此方法中返回后，它具有“glGetError”的 GL_INVALID_OPERATION 结果。

```
void CShader::setUniform( const char *name, int val )
    {
        int loc = getUniformLocation(name);
        glAssert();
        if( loc >= 0 )
        {
            GLint outval=-1;

            glUniform1i(loc, val);
            /*int tmploc =glGetUniformLocation(m_program, name);
            glGetUniformiv(m_program,
                            tmploc,
                           &outval);
            printf("Value is %d\n", outval);*/

        } else {
            printf("Uniform: %s not found.\n",name);
        }
        glAssert();
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T14:25:22.400

```
m_shader->compileandlink();
m_shader->setUniform("texture0", 0); 
```

这是行不通的，因为[只有在有活动的程序对象时才能设置制服](http://www.opengl.org/wiki/GLSL_%3a_common_mistakes#glUniform_doesn.27t_work)。即，您需要`glUseProgram(m_program)`在尝试设置统一值之前。这就是函数没有`program`参数的原因`glUniform`。

我不明白：`int loc = getUniformLocation(name)`，因为它*确实*需要链接程序的名称。评论：`glGetUniformLocation(m_program, name)`实际上是正确的。

# python - 如何在 Python 3.2 中安装 Python-RSA 3.1.1 包？

> ID：15853149
> 
> 赞同：-1
> 
> 时间：2013-04-06T16:18:57.133
> 
> 标签：python, python-3.x, rsa, python-2.x, python-3.2

到目前为止，我已经尝试过这些方法来安装包 `pip install rsa`和`python setup.py install`

但似乎我为python2.7安装了一个。

如何为 python3.2 安装一个？还是将 2.x 转换为 3.x？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:21:36.503

您只需指定要使用的版本，例如`python3 setup.py install`.

# python - Networkx 创建一个带有节点属性的图以确定哪些边是连接的

> ID：15853156
> 
> 赞同：1
> 
> 时间：2013-04-06T16:19:41.840
> 
> 标签：python, graph, networkx

我正在尝试创建一个连接图，其中每个节点都有一些属性来确定它连接到的其他节点。网络是一个圆形空间，便于建立链接（有 1000 个节点）。

这个网络的工作方式是一个节点有两个邻居（即它的左/右的邻居 - 即节点 3 有邻居 1 和 2）和***k***个长距离链路。节点选择长距离链接的方式是它只是从顺时针方向随机选择节点（即节点 25 可能有 200 个作为其长距离链接而不是 15 个）。

这是它可能看起来的示例图像：http: [//i.imgur.com/PkYk5bz.png](http://i.imgur.com/PkYk5bz.png) 给定的是一个交响乐网络，但我的实现是它的简化。

我在java中部分实现了这一点（通过一个包含arraylist的链表），但我不知道如何在NetworkX中做到这一点。我对如何添加这些特定节点属性感到特别困惑，这些属性表示节点会找到 k 个长链接，但在 k 之后将不再接受任何链接。networkx 中是否有适合此模型的特定内置图，或者只要我具有正确的节点属性，任何图都可以接受？

这是一个更复杂的网络的简化，没有节点离开，也没有边缘消失。

对此，我们将不胜感激任何帮助或示例链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:25:27.687

这近似于您的需要：

```
import networkx as nx
import matplotlib.pyplot as plt
import random

N = 20 # number of nodes
K = 3 # number of "long" edges

G = nx.cycle_graph(N)

for node in G.nodes():
    while len(G.neighbors(node)) < K+2:
        # Add K neighbors to each node
        # (each node already has two neighbors from the cycle)
        valid_target_found = False
        while not valid_target_found:
            # CAUTION
            # This loop will not terminate
            # if K is too high relative to N
            target = random.randint(0,N-1)
            # pick a random node
            if (not target in G.neighbors(node)
                and len(G.neighbors(target)) < K+2):
                # Accept the target if (a) it is not already
                # connected to source and (b) target itself
                # has less than K long edges
                valid_target_found = True
        G.add_edge(node, target)

nx.draw_circular(G)
plt.show() 
```

它创建了下面的图表。有待改进，例如，为长边更有效地选择目标节点，但我希望这能让你开始。

![循环图与](https://i.stack.imgur.com/P95XK.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T18:40:24.877

在 NetworkX 中，如果有任何关于连接节点的逻辑，一切都应该留给你。

不过，如果您想在 Python 中迭代节点（未测试）：

```
for (nodeId, data) in yourGraph.nodes(data=True):
    // some logic here over data

    // to connect your node
    yourGraph.add_edge(nodeId, otherNodeId) 
```

旁注：如果你想继续使用 Java，你也可以考虑使用 Jung 和 Gephi。

# c++ - C++ - 基于距离的对象最快排序算法

> ID：15853158
> 
> 赞同：3
> 
> 时间：2013-04-06T16:19:54.183
> 
> 标签：c++, sorting

我正在尝试使用 openGL 制作游戏或 3D 应用程序。游戏/程序将包含许多对象并绘制到屏幕上（大约 7000 个）。当我渲染它们时，我需要计算相机和物体之间的距离并对它们进行排序，以便正确渲染场景中的物体。知道了这一点，对它们进行排序的最佳方法是什么？我真的希望排序能够非常快地完成，但我听说它们需要“权衡”，那么我应该使用什么算法来获得最佳性能呢？

任何帮助将不胜感激。

编辑：很多人都在谈论 z-buffer/depth 缓冲区。这在某些情况下不起作用，就像一些人谈到的那样。这就是我问这个问题的原因。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-06T16:29:02.040

按距离排序并不能完美解决透明度问题。考虑两个透明表面相交并且每个表面都有一个离您更近的部分的情况。也许在游戏中很少见，但如果您不希望渲染器偶尔出现故障外观，仍然需要考虑。

更好的解决方案是与订单无关的透明度。借助支持原子操作的最新图形硬件，您可以使用 A 缓冲区以很少的内存开销和单次通过来执行此操作，因此非常高效。例如见[这篇文章](http://blog.icare3d.org/2010/07/opengl-40-abuffer-v20-linked-lists-of.html)。

尽管如此，对场景进行排序的问题仍然是一个有效的问题，即使它不是为了透明——将不透明的对象从前到后排序以允许深度测试丢弃看不见的片段仍然很有用。为此，Vaughn 提供了 BSP 树的出色解决方案——只要 3D 游戏出现，这些树就一直用于此目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:31:34.047

使用[http://en.wikipedia.org/wiki/Insertion_sort](http://en.wikipedia.org/wiki/Insertion_sort)，它对于几乎排序的数组具有 O(n) 复杂度。

在您的情况下，通过利用时间凝聚力插入排序可以提供最快的结果。它用于[http://en.wikipedia.org/wiki/Sweep_and_prune](http://en.wikipedia.org/wiki/Sweep_and_prune)

从上面的链接：

> 在许多应用程序中，物理实体的配置从一个时间步到下一个时间步变化很小。许多物体可能根本不动。算法的设计使得在前一个时间步中完成的计算可以在当前时间步中重复使用，从而更快地完成计算。

所以在这种情况下插入排序是最好的（或者在最好的情况下使用 O(n) 的类似排序）

# c# - IsAssignableFrom、IsInstanceOfType 和 is 关键字，有什么区别？

> ID：15853159
> 
> 赞同：47
> 
> 时间：2013-04-06T16:19:54.573
> 
> 标签：c#, c#-4.0, casting

我有一个安全转换对象的扩展方法，如下所示：

```
public static T SafeCastAs<T>(this object obj) {
    if (obj == null)
        return default(T);

    // which one I should use?

    // 1\. IsAssignableFrom
    if (typeof(T).IsAssignableFrom(obj.GetType()))
        return (T)obj;

    // 2\. IsInstanceOfType
    if (typeof(T).IsInstanceOfType(obj))
        return (T) obj;

    // 3\. is operator
    if (obj is T)
        return (T) obj;

    return default(T);
} 
```

如您所见，我有 3 个选择，那么我应该使用哪一个？`IsAssignableFrom`实际上，`IsInstanceOfType`, 和`is`operator之间有什么区别？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-04-06T16:26:48.497

您可以使用您拥有的任何信息。

如果您有要检查的实例和静态类型，请使用`is`.

如果您没有静态类型，那么您只有一个`Type`对象，但您有一个要检查的实例，请使用`IsInstanceOfType`.

如果您没有实例，并且只想检查 a 的理论实例`Type`与 another之间的兼容性`Type`，请使用`IsAssignableFrom`.

但实际上似乎您只是在重新实现[as 运算符](http://msdn.microsoft.com/en-us/library/cscsdfbt%28v=vs.110%29.aspx)（除了您的运算符也适用于不可为空的值类型，这通常不是一个很大的限制）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-06T16:25:34.137

我猜你正在有效地实现一个`as`适用于值类型和引用类型的运算符版本。

我会去：

```
public static T SafeCastAs<T>(this object obj)
{
    return (obj is T) ? (T) obj : default(T);
} 
```

`IsAssignableFrom`适用于类型，`is`适用于实例。他们会给你相同的结果，所以你应该使用最简单的版本恕我直言。

至于`IsInstanceOfType`: 那是按照 来实现的`IsAssignableFrom`，所以不会有什么区别。

您可以通过使用 Reflector 查看 的定义来证明`IsInstanceOfType()`：

```
public virtual bool IsInstanceOfType(object o)
{
    if (o == null)
    {
        return false;
    }
    return this.IsAssignableFrom(o.GetType());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-06T16:38:51.117

我想您应该只使用“ [as](http://msdn.microsoft.com/en-us/library/cscsdfbt%28v=vs.110%29.aspx) ”而不是您的自定义“SafeCastAs”。但这仅适用于类（不适用于结构），因此如果您也想将此方法用于结构，我可以得到它。

运算符“is”基本上与 Type.IsAssignableFrom 相同，因此您只能保留“is”，它检查是否可以安全地将 obj 转换为 T，没有例外。因此，它将涵盖您方法中先前的两项检查。但是您应该知道，由于用户定义的转换：[显式](http://msdn.microsoft.com/en-us/library/xhbhezf4%28v=vs.110%29.aspx)和[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2%28v=vs.110%29.aspx)关键字，它不会检查您是否可以将 obj 分配给 T。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-14T11:12:36.240

这些函数和运算符具有不同的含义。如果你有对象，你总是可以得到类型。所以你不为你所拥有的而工作，而是你做需要做的事情。

当您使用类层次结构时，差异非常明显。

看下面的例子

```
 class ABase
        {

        }

        class BSubclass : ABase
        {

        }
    ABase aBaseObj = new ABase();
                BSubclass bSubclassObj = new BSubclass();

                ABase subObjInBaseRef = new BSubclass(); 
```

不同的操作会产生不同的结果。

```
typeof(ABase).IsInstanceOfType(aBaseObj) = True

typeof(ABase).IsInstanceOfType(bSubclassObj) = True

typeof(ABase).IsInstanceOfType(bSubclassObj) = True

typeof(BSubclass).IsInstanceOfType(aBaseObj) = False

bSubclassObj is ABase = True

aBaseObj is BSubclass = False

subObjInBaseRef is BSubclass = True

subObjInBaseRef is BSubclass = True

typeof(ABase).IsAssignableFrom(typeof(BSubclass))  = True

typeof(BSubclass).IsAssignableFrom(typeof(ABase))= False 
```

如果没有层次结构，可能一切都是一样的。但是，如果您使用层次结构，`IsAssignableFrom`， is ，并`IsInstanceOfType`产生不同的结果。

还有更多可能的组合可以尝试。例如，您可以在此示例中引入一个与现有类无关的类 C。

# android - 创建动态 R.drawable 源和 ImageView

> ID：15853162
> 
> 赞同：1
> 
> 时间：2013-04-06T16:20:16.140
> 
> 标签：android, android-imageview, dynamically-generated, android-drawable

我有一个活动，它的变量`position`来自另一个活动。我用下面的方法处理这个变量`Intent`。（*实际上`position`是 listView 在另一个活动中的位置。*）`position`变量的值是 0 到 200

我拿了我的 Extra，然后将其分配给一个字符串，然后将其解析为一个整数。这些对我和工作来说都是正常和容易的。

```
Intent i            = getIntent();
String position     = i.getStringExtra("POSITION");
int position_to_int = Integer.parseInt(position); 
```

但我的问题是关于资源。

**只是我想动态地**将图像放到我的 LinearLayout中。我有一些国旗，它们的名称格式为`0.gif`, `1.gif`, `2.gif`, `3.gif`...

我的想法是`position`为此目的使用变量的值。

但是当我尝试使用`position_to_int`变量作为标志的名称时，Eclipse 会正常返回错误。因为`R.drawble.XXX`值存储在`R.java`

```
ImageView imageView = new ImageView(this);
// setting image resource
imageView.setImageResource(R.drawable.position_to_int); 
```

**如何使用`position_to_int`变量动态显示 ImageView？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:23:45.843

你不能直接访问它。您必须使用其名称获取资源：

```
private Drawable getDrawableResourceByName(int name) {
    String packageName = getPackageName();
    int resId = getResources().getIdentifier("character_you_prefixed" + String.valueOf(name), "drawable", packageName);
    return getResources().getDrawable(resId);
} 
```

请注意，您的资源名称必须以字母开头，而不是数字，否则您的项目将无法编译。尝试在每个文件名的开头添加一个字符。

# angularjs - AngularJS + Elasticsearch - 如何搜索文档

> ID：15853165
> 
> 赞同：0
> 
> 时间：2013-04-06T16:20:58.127
> 
> 标签：angularjs, elasticsearch

我正在将 AngularJS 与 ElasticSearch 一起使用。

到目前为止，我一直在使用`curl`终端中的命令来玩 ElasticSearch。

现在，我希望在 AngularJS 中对我的弹性搜索索引执行搜索。我该怎么做？我假设使用 $http.get() 但我在任何地方都找不到示例。

基本上，我如何转换以下内容：

```
curl -XGET 'http://localhost:9200/twitter/mark/_search?pretty=true&size=100' -d '{
    "term": {
        "tag": "comedy"
    }
}' 
```

到 Angular 请求？那就是我如何在控制器内的 AngularJS 中实现上述目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-06T19:19:42.737

Elasticsearch 已经发布了一个官方的 JS 客户端。你可以在 github 上找到它：[https ://github.com/elasticsearch/elasticsearch-js](https://github.com/elasticsearch/elasticsearch-js)

我发现以下示例[https://github.com/elasticsearch/elasticsearch-js/issues/19](https://github.com/elasticsearch/elasticsearch-js/issues/19)有助于设置客户端实例。设置好客户端后（客户端为“es”，queryTerm 将映射到搜索框或类似内容），您可以执行如下搜索：

```
esApp.controller('SearchCtrl', function($scope, es) {
es.cluster.health(function (err, resp) {
    if (err) {
        $scope.data = err.message;
    } else {
        $scope.data = resp;
    }
});

$scope.search = function() {
    es.search({
        index: 'your_index',
        size: 50,
        body: {
            query: {
                query_string: {
                    default_field: 'title', 
                    query: ($scope.queryTerm || '*')
                }
            }
        }
    }).then(function (resp) {
        $scope.results = resp.hits.hits;
        $scope.hitCount = resp.hits.total;
        }, function (err) {
            $scope.results(err.message);
    });
}; 
```

# r - 使用 RPostgreSQL 从 R 远程连接到 Heroku 上的 PostgreSQL 的问题

> ID：15853167
> 
> 赞同：4
> 
> 时间：2013-04-06T16:21:13.533
> 
> 标签：r, postgresql, rpostgresql

我在 Windows 7 64 位下的 R 2.15.2 上使用 RPostgreSQL 0.4 库（在 R 2.15.3 上编译）与 PostgreSQL 接口。当连接到本地主机上的我的 PostgreSQL 数据库时，这工作正常。我正在尝试让我的 R 代码与 Heroku 上的远程 PostgreSQL 数据库一起运行。我可以从我机器上的 psql 命令 shell 连接到 Heroku 的 PostgreSQL 数据库，并且连接没有问题。我收到消息：

```
psql (9.2.3, server 9.1.9)
WARNING: psql version 9.2, server version 9.1.
         Some psql features might not work.
WARNING: Console code page (437) differs from Windows code page (1252)
         8-bit characters might not work correctly. See psql reference
         page "Notes for Windows users" for details.
SSL connection (cipher: DHE-RSA-AES256-SHA, bits: 256) 
```

显然，psql 使用 SSL 进行连接。但是，当我尝试使用 RPostgreSQL 库例程 dbConnect() 进行连接时，使用 dname=、host=、port=、user=、password= 提供完全相同的凭据时，连接失败并出现以下问题：

```
Error in postgresqlNewConnection(drv, ...) :
  RS-DBI driver: (could not connect <user>@<hostname> on dbname <dbname>)
Calls: source ... .valueClassTest -> is -> is -> postgresqlNewConnection -> .Call
Execution halted 
```

我知道如果您想远程访问 Heroku 的数据库，Heroku 坚持使用 SSL 连接，因此 R 接口例程 dbConnect() 似乎没有尝试使用 SSL。我还能做些什么来让 Heroku 上从 R 到 PostgreSQL 的远程连接正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-08T22:02:14.127

要获取 heroku 实例的 JDBC URL：

1.  使用 [pg:credentials] 获取您的主机名、用户名和密码。
2.  您的 jdbc URL 将是： `jdbc:postgresql://[hostname]/[database]?user=[user]&password=[password]&ssl=true&sslfactory=org.postgresql.ssl.NonValidatingFactory`
3.  像往常一样处理 JDBC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-07T06:52:39.420

显然有一种使用 RJDBC 的方法。看：

[http://ryepup.unwashedmeme.com/blog/2010/11/17/working-with-r-postgresql-ssl-and-mssql/](http://ryepup.unwashedmeme.com/blog/2010/11/17/working-with-r-postgresql-ssl-and-mssql/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-22T12:13:28.347

[请参阅https://stackoverflow.com/a/38942581](https://stackoverflow.com/a/38942581)上对相关 Q 的回答。使用 RPostgres ( [https://github.com/rstats-db/RPostgres](https://github.com/rstats-db/RPostgres) ) 而不是 RPostgreSQL 的建议为我解决了同样的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-31T11:46:12.030

请注意，为了在外部使用 JDBC 连接到 Heroku 数据库，设置 sslfactory 参数也很重要。希望 Heroku 团队通过它并修改他们的文档。

```
String dbUri = "jdbc:postgresql://ec2-54-243-202-174.compute-1.amazonaws.com:5432/**xxxxxxx**";
Properties props = new Properties();
props.setProperty("user", "**xxxxx**");
props.setProperty("password", "**xxxxx**");
props.setProperty("ssl", "true");//ssl to be set true
props.setProperty("sslfactory", "org.postgresql.ssl.NonValidatingFactory");// sslfactory to be set as shown above
Connection c=DriverManager.getConnection(dbUri,props); 
```

# javascript - 谷歌地图 api v3 航点未显示在地图上

> ID：15853170
> 
> 赞同：2
> 
> 时间：2013-04-06T16:21:32.643
> 
> 标签：javascript, jquery, api

我正在做一个谷歌地图 v3 项目，我已经到了需要帮助的地步。我有一个谷歌地图，用户可以在其中输入起点和终点，这很好，但是当我出于某种原因想要输入航点时，它们将无法工作（最多 8 个航点）。有人可以看一下代码并帮助我吗？这就是我在项目中取得的进展：

```
<!DOCTYPE html>

<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
<meta charset="utf-8">
<title></title>
<link href="map_style.css" rel="stylesheet">
<script src="jquery-1.8.3.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
<script src="maps.js"></script>
<script type="text/javascript">
<!--
function toggle_visibility(id) {
   var e = document.getElementById(id);
   if(e.style.display == 'block')
      e.style.display = 'none';
   else
      e.style.display = 'block';
}
//-->
</script>

</head>
<body onload="initialize()">
<div id="total"></div>
<div id="map-canvas"></div>
    <div id="control_panel">
        <div id="user_input">

            <label for="start">Start :</label>
              <input type="text" id="start" name="start" /><br />

            <i>Add multiple Stops along the route (Optional)</i><br />
            <ul id="stops">
               <li>
                <label for="stop1">Stop 1:</label>
                <input type="text" id="stop1" name="stop1" />
                </li>
            </ul>
            <input type="button" id="addScnt" value="Add Stop" /><br />

            <label for="end">End :</label>
              <input type="text" id="end" name="end" /><br />
            <br />
              <input type="submit" value="Create Route" onclick="calcRoute();" />
              <input type="button" id="button" value="Show/Hide Directions" onclick="toggle_visibility('directions_panel');" />
        </div>

    </div>
    <div id="directions_panel"></div>
</body>
</html> 
```

这是我的 js 文件：

```
 $(document).ready(function () {

  var scntUl = $('#stops');
  var ii = $('#stops').size() + 1;
 var MaxInputs = 8;

$('#addScnt').live('click', function () {
    if (ii <= MaxInputs) {

    $('<li><label for="stop' + ii +'">Stop ' + ii + ': </label><input type="text" id="stop' + ii +'" name="stop' + ii + '" /><input type="button" id="remScnt" value="X" /></li>').appendTo(scntUl);
    ii++;
    }
    return false;
});

$('#remScnt').live('click', function () {
    if (ii > 2) {
        $(this).parents('li').remove();
        ii--;
    }
    return false;
 });
}); 

 var directionDisplay;
 var directionsService = new google.maps.DirectionsService();
 var map;

 function initialize() {
 directionsDisplay = new google.maps.DirectionsRenderer();
 var map = new google.maps.LatLng(37.09, -95.71);
 var mapOptions = {
  zoom: 4,
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  center: map
 }
 map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
 directionsDisplay.setMap(map);
directionsDisplay.setPanel(document.getElementById("directions_panel"));

 }

 function calcRoute() {
 var start = document.getElementById('start').value;
 var end = document.getElementById('end').value;
var waypts = [];
    for (var ii = 0; ii < thisStop; ii++) {      
        var thisStop = document.getElementById("stop" + (ii+1)).value;
        if (thisStop.length > 0) {
            if (thisStop.length > 0) {
                waypts[ii] = {location: thisStop};
            }
        }
    }   

    var request = {
        origin: start,
        destination: end,
        waypoints: waypts,
        optimizeWaypoints: false,
        travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    directionsService.route(request, function(response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(response);
        var route = response.routes[0];
        var summaryPanel = document.getElementById('directions_panel');
        summaryPanel.innerHTML = '';
    }
      computeTotalDistance(response);
    }); 
}

    function computeTotalDistance(result) {
        var totalDist = 0;
        var totalTime = 0;
        var myroute = result.routes[0];
            for (i = 0; i < myroute.legs.length; i++) {
                totalDist += myroute.legs[i].distance.value;
                totalTime += myroute.legs[i].duration.value;      
            }
        var miles = 0.000621371192;

        document.getElementById("total").innerHTML = ("Total distance is: "+ (Math.round( totalDist * miles * 10 ) / 10 ) + " miles " + " and " + " Approximate time is: " + (totalTime / 60 / 60).toFixed(1) + " hours.");
    } 
```

如果有人需要更多信息，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:50:50.530

有很多代码要看。你能放一个测试页，甚至是一个[小提琴](http://jsfiddle.net/)吗？

与此同时，我确实在这里看到了一个问题：

```
var scntUl = $('#stops');
var ii = $('#stops').size() + 1; 
```

`$('#stops')`给你一个`<ul id="stops">`元素本身的 jQuery 对象，而不是它的子元素。`length`无论您在其中添加多少元素，此对象的 都将为1 `<li>`。也许你想要`$('#stops>li')`呢？这将为您提供一个包含所有`<li>`元素的 jQuery 对象。

（顺便说一句，您可以使用`.length`属性而不是`.size()`方法 - 该方法仅用于与旧代码兼容。）

另外，为什么要在该长度上加 1？除此之外，我并没有看太多代码，但是如果您想要`<li>`元素的数量，您可以直接采用`.length`。

我还注意到`<input>`所有元素都有`id="remScnt"`. 你不应该`id`多次使用；使用 a`class`或生成唯一 ID（或两者）。

另一件事 -`.live()`已弃用；改为使用`.on`。

发布地图链接后更新...

看看这段代码：

```
for (var ii = 0; ii < thisStop; ii++) {      
    var thisStop = document.getElementById("stop" + (ii+1)).value;
    if (thisStop.length > 0) {
        if (thisStop.length > 0) {
            waypts[ii] = {location: thisStop};
        }
    }
} 
```

这里至少有三四个问题。但是，与其尝试按原样修复此代码，为什么不利用 jQuery 来简化它呢？

首先，返回到`#addScnt`单击处理程序中的代码，它将每个新的附加`<li>`到 DOM 中，并将类名添加到`<input>`标记中，例如

```
<input class="waypoint" ...and the existing attributes here... /> 
```

然后在上面有那个循环的地方，将其更改为：

```
var waypts = [];
$('.waypoint').each( function( i, input ) {
    var value = $(input).val();
    if( value.length ) waypts.push({ location: value });
}); 
```

请注意，此代码不再依赖于具有 ID `stop1`、`stop2`等的输入。除非您在其他地方需要这些 ID，否则您可以删除它们。

另外我注意到你仍然有这个代码：

```
var scntUl = $('#stops>li');
var ii = $('#stops').length; 
```

你认为`ii`这里的价值是什么？另外，稍后你有这个：

```
$('<li>...</li>').appendTo(scntUl); 
```

这不可能。这不应该附加到`#stops`自己身上吗？您现在正在嵌套`<li>`元素，这不是您想要的。

最后，使用 Chrome 或其他浏览器中的开发者工具来解决这些问题。当然，SO 是一个很好的资源，欢迎在这里提问。但是，如果您可以使用 Chrome 或其他浏览器中的开发人员工具解决您**现在**遇到的问题，那就更好了。值得花一些时间探索那里的所有可用选项。[从这里开始获取有关 Chrome DevTools 的教程](https://developers.google.com/chrome-developer-tools/)。

# jquery - jQuery 和 Django 模板

> ID：15853172
> 
> 赞同：0
> 
> 时间：2013-04-06T16:21:40.177
> 
> 标签：jquery, django, django-templates, django-views

是否可以通过 jQuery将 html 格式的文本（例如“**嘿！ ”）显示为 html？**我正在从 db 获取此文本。当我试图做类似的事情时

```
 $('.course_content').find('.content').html('{{ course.description }}') 
```

它看起来像纯文本

```
 <strong>Hey!</strong> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:01:50.100

您可以使用`safe`过滤器。一个示例用法是：

`{{course.description|safe|escape}}`

[你可以在这里](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#std%3atemplatefilter-safe)阅读它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:57:09.567

您不能这样做，因为您正在混合服务器和客户端执行。Django 视图代码在服务器中执行（因此所有`{{ value }}`标签都替换为各自的值），返回给 Web 浏览器的只是 HTML。然后在生成的 HTML 的上下文中执行 javascript 代码。

所以，如果你想像在 Django 上一样使用客户端模板，你可以使用[Handlebar.js](http://handlebarsjs.com/)之类的东西，它有类似的语法。

# php - 使用 PHP 加载包含分隔符的 SQL 文件

> ID：15853173
> 
> 赞同：0
> 
> 时间：2013-04-06T16:21:40.480
> 
> 标签：php, mysql-workbench

我成功地使用下面的 run_sql_script() 函数在使用 PHP 的文件中执行 SQL。

```
 static public function run_sql_script($script)
    {
        // Load and explode the sql file
        $f = fopen($script,"r+");
        $sqlFile = fread($f,filesize($script));
        $sqlFile=preg_replace("/\\\;/", '&#59', $sqlFile);   //replace semicolons with ascii
        $sqlArray = explode(';',$sqlFile);
        //Process the sql file by statements
        foreach ($sqlArray as $stmt)
        {
            if (strlen($stmt)>8)
            {
                //Used to prevent blank lines at end of sql script from executing
                $stmt=preg_replace("/&#59/", ';', $stmt);   //replace ascii with semicolons
                try {db::db()->exec($stmt);}
                catch(PDOException $e){library::sql_error($e,$stmt);}
            }
        }
        return;
    } 
```

我使用 MySQL Workbench 生成 SQL，最近，我还通过 MySQL Workbench 添加了一个触发器。它将以下 SQL 添加到文件中。

```
DELIMITER $$

CREATE TRIGGER tg_contacts_upd AFTER UPDATE ON contacts
FOR EACH ROW
.... 
BEGIN
END$$

DELIMITER ; 
```

通过我的 run_sql_script() 函数运行新文件后，我现在收到以下错误。

> 查询错误：DELIMITER $$ CREATE TRIGGER tg_contacts_upd AFTER UPDATE ON Contacts FOR EACH ROW BEGIN END$$ DELIMITER SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“DELIMITER $$ CREATE TRIGGER tg_contacts_upd AFTER ON contacts FOR EACH”附近使用正确的语法

任何建议如何解决

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:18:11.593

似乎太容易了，但以下似乎可行。

```
 static public function run_sql_script($script)
    {
        $sql = file_get_contents($script);
        db::db()->exec($sql);
    } 
```

# rdf - 动物本体

> ID：15853174
> 
> 赞同：2
> 
> 时间：2013-04-06T16:21:41.287
> 
> 标签：rdf, ontology, owl

我正在寻找像动物本体这样的本体，我可以在其中获得层次结构，例如

```
Bird
==>Duck
======>Mallard_Duck 
```

我看过这个[http://www.bbc.co.uk/ontologies/wildlife/2010-11-04.shtml](http://www.bbc.co.uk/ontologies/wildlife/2010-11-04.shtml)，但到目前为止我还没有成功通过 sparql 获得层次结构，有可能吗它与它？

如果没有，是否有人知道显示层次结构的动物本体？

# unicode - 是否有带有笔划 unicode 字符的向下双箭头？

> ID：15853179
> 
> 赞同：2
> 
> 时间：2013-04-06T16:22:46.430
> 
> 标签：unicode, character

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T17:33:26.920

There is no such character as a precomposed character (i.e., as a single encoded character, a code point assigned to a character), but you can in principle represent it using an arrow character followed by a combining overlay character.

The character “⇏” [U+21CF](http://www.fileformat.info/info/unicode/char/21cf/index.htm) RIGHTWARDS DOUBLE ARROW WITH STROKE has been defined as having the canonical decomposition RIGHTWARDS DOUBLE ARROW (U+21D2) COMBINING LONG SOLIDUS OVERLAY (U+0338). In principle, a character should be expected to be rendered the same way as its canonical decomposition. In practice, things don’t always go that way.

Along the same lines, a downwards double arrow with stroke could be written as the two-character sequence DOWNWARDS DOUBLE ARROW (U+21D3) COMBINING LONG SOLIDUS OVERLAY (U+0338) or, in HTML, as `&#x21d3;&#x338;`. In practice, few fonts contain these characters, and browsers may fail to implement the combination properly. Moreover, in many fonts, the result is awkward. In Arial Unicode MS and in DejaVu Serif, the result might be acceptable, but only the latter is free (can be legally used as a downloadable font via `@font-face`). Here’s the combination as rendered by your browser with the SO stylesheets in effect: ⇓̸.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:31:52.367

It doesn't seem to exist, [according to this page](http://www.fileformat.info/info/unicode/char/search.htm?q=DOUBLE%20ARROW%20WITH%20STROKE&preview=entity) (compared to [this](http://www.fileformat.info/info/unicode/char/search.htm?q=DOUBLE%20ARROW%20&preview=entity)).

# java - 我可以在 Struts 2 中直接使用 jquery.js 吗？

> ID：15853181
> 
> 赞同：1
> 
> 时间：2013-04-06T16:23:00.460
> 
> 标签：java, jquery, nullpointerexception, struts2, struts2-jquery-plugin

我已经有一个简单的应用程序，要进行实验，我在 Struts 2 中实现了相同的功能。在我使用过 jQuery 的旧应用程序中，现在我可以在`jquery.js`这里直接使用相同的应用程序，还是应该选择 Struts 2 jQuery 插件？

我试过了`jquery.js`，我得到空指针异常。所以我现在很困惑。有人说出两者之间的区别。两者都是 jQuery 唯一赖特？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T06:09:46.250

尝试`loadAtOnce`在`<sj:header>`标签中设置`true`以禁用按需脚本加载。所以`jQuery`脚本将在页面加载时加载。您应该能够使用自己的库脚本，而无需手动加载自己的`jquery.js`.

[参考。这里](https://code.google.com/p/struts2-jquery/wiki/HeadTag)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:04:13.600

如果你有`NullPointerException`，这并不意味着 JQuery 或[插件](https://cwiki.apache.org/confluence/plugins/servlet/mobile?contentId=119537#content/view/119537)有错误。你得到错误是因为你在代码中做错了什么，误解或其他什么。

Struts 2 JQuery 是一个标签库，可以与 Struts 2 框架一起使用。它包含里面的JQuery。JQuery 只是一个 JavaScript 库。使用该插件，您可以在 Struts 2 框架中获得 Ajax 支持。

# android - 使用 shadowOf 方法时出现 Robolectric 编译错误

> ID：15853182
> 
> 赞同：1
> 
> 时间：2013-04-06T16:23:02.040
> 
> 标签：android, robolectric

我在 Andorid 2.3.3 项目（API 10）中使用 Robolectric 1.2
使用 shadowOf 方法时会引发以下编译错误

```
ShadowView shadowView = Robolectric.shadowOf(view); 
```

错误：无法访问 ObjectAnimator

但是错误消失了，如果我将 android sdk 更改为 API 11 及更高版本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-23T00:02:44.083

我仍然有这个问题与2.2。我解决了这个问题

```
import static org.robolectric.Robolectric.shadowOf_;
...
ShadowView shadowView = Robolectric.shadowOf_(view); 
```

如果有人能提供一些见解为什么会这样，那就太棒了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T14:39:30.360

经过一番分析，发现这是robolectric中的一个bug。

目前，使用 2.0-alpha-1 似乎可以解决问题。

这是为该问题创建的 github 问题
[https://github.com/pivotal/robolectric/issues/431](https://github.com/pivotal/robolectric/issues/431)

# c# - 在 vs2008 中创建的使用互操作程序集的 exe 可以部署在任何地方吗？

> ID：15853186
> 
> 赞同：1
> 
> 时间：2013-04-06T16:23:16.120
> 
> 标签：c#, clr, office-interop

这是我问的一个相当蹩脚的问题，但我想知道是否将使用 Microsoft Office 互操作程序集的小程序部署在其他地方？没有任何 .NET clr 是否会支持它...我经历了几个解决方案，但我真的不知道

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:23:50.563

> 没有任何.NET clr 是否会支持它。

不，不会的。托管代码需要 CLR 才能运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T07:35:48.103

您是否能够检查将要部署它的机器？如果是这样，请查看它是否已经具有 .net - 不太可能不会。

> C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework

如果没有，您可以查看为先决条件 [http://msdn.microsoft.com/en-gb/library/ms165429%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-gb/library/ms165429%28v=vs.80%29.aspx)创建部署包。

目标机器还需要安装正确版本的 excel。

# python - 在模板中显示相关对象的数据 - Django

> ID：15853188
> 
> 赞同：2
> 
> 时间：2013-04-06T16:23:39.370
> 
> 标签：python, django, django-templates, foreign-keys

在模板中，我想显示与“源对象”相关的所有对象的数据。

这是我想在文章详细信息页面上显示的事件模型：

```
### Models ###
class EventRecord(models.Model):
    article = models.ForeignKey(Article, related_name='events')
    event_date = models.DateField('Event Date')
    country = models.CharField(blank=True, max_length=100)
    location = models.CharField(blank=True, max_length=100)
    actors = models.CharField(blank=True, max_length=100)
    .
    .
    .
    def __unicode__(self):
        return self.event_date 
```

这是我为它写的视图（有效）：

```
### View ###
def article_detail(request, pk):
    """ Detail View for articles"""
    article = get_object_or_404(Article, pk=pk)
    events = article.events.all()

    return render(request, 'coding/article-detail.html', {'article': article,
    'events': events})
    pass 
```

这个模板也可以，但我看到的只是 event_date 信息。

```
### Template ### 
<div>
<h2>Events</h2>
{% for event in events %}
    {{ event }}
{% endfor %}

</div> 
```

这是因为`__unicode__(self)`?
我需要做什么才能查看**所有**活动信息？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:49:21.380

您是对的，在渲染时`{{event}}`您只是看到它的表示，您在方法中将其定义`__unicode__`为 event_date 字段。如果您想查看 EventRecord 的其他字段，只需像这样渲染它们：

```
{% for event in events %}
    {{ event.country }}
    {{ event.location }}
    .
    .
    .
{% endfor %} 
```

# jquery - $find().click 不工作

> ID：15853190
> 
> 赞同：1
> 
> 时间：2013-04-06T16:23:48.900
> 
> 标签：jquery, modalpopupextender, cancel-button

我的 modalpopup 有多个取消控件，但只有 btnCancel 起作用，$find().click 不起作用，我收到“错误：无法获取属性 'click' 的值：对象为空或未定义”任何帮助将不胜感激。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true"
    CodeBehind="WebForm1.aspx.cs" Inherits="web.WebForm1" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>
<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <asp:ScriptManager runat="server" ID="scriptManager" EnablePageMethods="true">
    </asp:ScriptManager>
    <asp:Button ID="btnShowPopupAmend" runat="server" />
    <asp:ModalPopupExtender ID="mpeAmend" runat="server" TargetControlID="btnShowPopupAmend"
        PopupControlID="pnlpopupAmend" CancelControlID="btnCancel" BackgroundCssClass="modalBackground" />
    <asp:Panel ID="pnlpopupAmend" runat="server" Width="700px" Style="display: none;"
        class="ModalPanel">
        <img src="images/close.png" style="cursor: hand" onclick="$find('btnCancel').click()"
            width="15" height="15" />
        <asp:Button ID="btnCancel" Text="Cancel" runat="server" OnClick="btnCancel_Click" />
    </asp:Panel>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:32:06.607

我会从元素中取出逻辑......

在您的图像上添加一个 id，例如“closeImg”

那么你的js可以是这样的：

```
$('#closeImg').click( function() {
    $('#btnCancel').click();
});
$('#btnCancel').click( function() {
    //whatever you want to have happen
}); 
```

一个例子：http: [//jsfiddle.net/vgDPd/](http://jsfiddle.net/vgDPd/)

确保将其放在 $(document).ready() 中，以便为其加载 dom

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:41:15.293

$find 语法不正确。此外，要选择一个 id，我们需要在元素的 id 之前使用一个“#”。您可以尝试以下方法：

```
$('#btnCancel').click() 
```

或者

```
$("body").find('#btnCancel').click() 
```

正如@smerny 提到的那样。尝试从模板中取出逻辑并将调用包装在准备好的函数中。

就绪函数可以写成

```
<script>
$(document).ready(function(){
  $('#btnCancel').click();
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T19:56:42.897

好的，我通过使用以下方法使它工作...

我设置了 modalpopupextender 的 behaviorID，然后在图像的 onclick 事件中调用 $find().hide()。

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true"
        CodeBehind="WebForm1.aspx.cs" Inherits="web.WebForm1" %>

    <%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>
    <asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
        <asp:ScriptManager runat="server" ID="scriptManager" EnablePageMethods="true">
        </asp:ScriptManager>
        <asp:Button ID="btnShowPopupAmend" runat="server" />
        <asp:ModalPopupExtender ID="mpeAmend" BehaviorID="mpeAmend" runat="server" TargetControlID="btnShowPopupAmend"
            PopupControlID="pnlpopupAmend" CancelControlID="btnCancel" BackgroundCssClass="modalBackground" />
        <asp:Panel ID="pnlpopupAmend" runat="server" Width="700px" Style="display: none;"
            class="ModalPanel">
            <img src="images/close.png" id="imgClose" alt="" style="cursor: hand" onclick="$find('mpeAmend').hide()"
                width="15" height="15" />
            <asp:Button ID="btnCancel" Text="Cancel" runat="server" OnClick="btnCancel_Click" />
        </asp:Panel>
    </asp:Content> 
```

# asp.net - 如何使用 R 登录然后从 aspx 网页下载文件

> ID：15853204
> 
> 赞同：14
> 
> 时间：2013-04-06T16:25:04.083
> 
> 标签：asp.net, r, download, rcurl, httr

我正在尝试使用 R 自动下载[此网页上](http://simba.isr.umich.edu/Zips/ZipMain.aspx)可用*的收入动态面板研究*文件。单击这些文件中的任何一个都会将用户带到[此登录/身份验证页面](http://simba.isr.umich.edu/u/Login.aspx)。身份验证后，您可以使用 Web 浏览器轻松下载文件。不幸的是，下面的代码似乎没有维护身份验证。我已经尝试在 Chrome 中检查 Login.aspx 页面（[如此处所述](https://stackoverflow.com/questions/10213194/use-rcurl-to-bypass-disclaimer-page-then-do-the-web-scrapping)），但即使我相信我传递了所有正确的值，它似乎也无法维持身份验证。我不在乎它是否完成了`httr``Headers``httr``RCurl`或其他东西，我只是喜欢在 R 中工作的东西，所以我不需要这个脚本的用户必须手动或使用一些完全独立的程序下载文件。我的尝试之一如下，但它不起作用。任何帮助，将不胜感激。谢谢！！:D

```
require(httr)

values <- 
    list( 
        "ctl00$ContentPlaceHolder3$Login1$UserName" = "you@email.com" , 
        "ctl00$ContentPlaceHolder3$Login1$Password" = "somepassword" ,
        "ctl00$ContentPlaceHolder3$Login1$LoginButton" = "Log In" ,
        "_LASTFOCUS" = "" ,
        "_EVENTTARGET" = "" ,
        "_EVENTARGUMENT" = "" 
    )

POST( "http://simba.isr.umich.edu/u/Login.aspx?redir=http%3a%2f%2fsimba.isr.umich.edu%2fZips%2fZipMain.aspx" , body = values )

resp <- GET( "http://simba.isr.umich.edu/Zips/GetFile.aspx" , query = list( file = "1053" ) ) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-09T09:14:31.277

除了在身份验证后存储 cookie（请参阅我上面的评论），您的解决方案中还有另一个问题点：ASP.net 站点`VIEWSTATE`在 cookie 中设置了一个键值对，该键值对将在您的查询中保留 - 如果您检查，您可以在您的示例中甚至没有登录（`POST`命令的结果包含有关如何登录的信息，只需检查一下）。

**可能解决方案的概述：**

1.  加载`RCurl`包：

    ```
    > library(RCurl) 
    ```

2.  设置一些方便的`curl`选项：

    ```
    > curl = getCurlHandle()
    > curlSetOpt(cookiejar = 'cookies.txt', followlocation = TRUE, autoreferer = TRUE, curl = curl) 
    ```

3.  首次加载页面以捕获`VIEWSTATE`：

    ```
    > html <- getURL('http://simba.isr.umich.edu/u/Login.aspx', curl = curl) 
    ```

4.  `VIEWSTATE`使用正则表达式或任何其他工具提取：

    ```
    > viewstate <- as.character(sub('.*id="__VIEWSTATE" value="([0-9a-zA-Z+/=]*).*', '\\1', html)) 
    ```

5.  将参数设置为您的用户名、密码*和`VIEWSTATE`*：

    ```
    > params <- list(
        'ctl00$ContentPlaceHolder3$Login1$UserName'    = '<USERNAME>',
        'ctl00$ContentPlaceHolder3$Login1$Password'    = '<PASSWORD>',
        'ctl00$ContentPlaceHolder3$Login1$LoginButton' = 'Log In',
        '__VIEWSTATE'                                  = viewstate
        ) 
    ```

6.  最后登录：

    ```
    > html = postForm('http://simba.isr.umich.edu/u/Login.aspx', .params = params, curl = curl) 
    ```

    恭喜，现在您已登录并`curl`持有 cookie 来验证！

7.  验证您是否已登录：

    ```
    > grepl('Logout', html)
    [1] TRUE 
    ```

8.  因此，您可以继续下载任何文件 - 只需确保传递`curl = curl`您的所有查询。

# python - 使用 SAX Python 将 XML 转换为 CSV

> ID：15853205
> 
> 赞同：2
> 
> 时间：2013-04-06T16:25:09.587
> 
> 标签：python, xml, sax

我有一个数据量很大的 XML 文件。

XML 文件包含

```
<us-bibliographic-data-grant>
    <publication-reference>
        <document-id>
            <country>US</country>
            <doc-number>D0607176</doc-number>
            <kind>S1</kind>
            <date>20100105</date>
        </document-id>
    </publication-reference>

    <application-reference appl-type="design">
        <document-id>
            <country>US</country>
            <doc-number>29327507</doc-number>
            <date>20081107</date>
        </document-id>
    </application-reference>

    <invention-title id="d0e55">Doughnut product with six appendages</invention-title>

    <applicants>
        <applicant sequence="001" app-type="applicant-inventor" designation="us-only">
            <addressbook>
            <last-name>Peters</last-name>
            <first-name>Brian Jeffery</first-name>
                <address>
                    <street>7052 Moonlight Cir.</street>
                    <city>Huntington Beach</city>
                    <state>CA</state>
                    <postcode>92647</postcode>
                    <country>US</country>
                </address>
            </addressbook>
            <nationality>
                <country>omitted</country>
            </nationality>
            <residence>
                <country>US</country>
            </residence>
        </applicant>
    </applicants>
</us-bibliographic-data-grant> 
```

我怎样才能得到这样的输出

```
last-name,first-name,street,city,state,postcode,country
peters,brian jeffery, 7052 moonlight cir.,huntington beach,CA,92647 
```

我对 XML 完全没有经验，请帮忙 在这个 XML 代码中，有很多`<addressbook>`. 那么如何才能获得`applicant`第一行中的所有属性，并且下一行被所有值填充。我想这样做是因为我想稍后将 csv 文件导入 sql。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:32:39.023

如果您只想从一种文件类型转换为另一种文件类型，则应使用工具。这是一个建议——https: [//code.google.com/p/xml2csv-conv/](https://code.google.com/p/xml2csv-conv/)

过去，当我需要解释复杂的 xml 文档时，我使用过 xslt。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-22T06:59:32.383

我为此使用 BeautifulSoup，只需将您的 filename.xml 替换为“字符串格式”中的 sample_1.xml

```
from bs4 import BeautifulSoup
with open("sample_1.xml", encoding= 'UTF-8') as fp:
soup = BeautifulSoup(fp, 'xml')
for a in soup.findAll("addressbook"):
    print(a.text) 
```

输出：Peters Brian Jeffery 7052 Moonlight Cir. 美国加利福尼亚州亨廷顿海滩 92647

# java - 使用静态的摩尔斯电码

> ID：15853206
> 
> 赞同：1
> 
> 时间：2013-04-06T16:25:11.600
> 
> 标签：java, morse-code

我有这个程序，但我有一些问题：这是我进行计算的地方。

```
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class MorseCode {
 public MorseCode()
    {
    }//end default constructor
    public String[] translateHere(String s)throws IOException
    {
        String compare = s, codedLine = "";  //userInput toUpperCase
        int length = compare.length();  //length of userInput
        String line, file = "C:\\APCS  Course B\\Unit 4\\Unit 4 Documents\\morse.txt";// variable holding file name and variable for each letter/number
        char code;
        //Constants
        final int MAX = 36;
        //Arrays
        char[] morseLetter = new char[MAX];
        String[] morseCode = new String[MAX];
        String[] newMessage = new String[length];
        //putting user input in a character array;
        char[] userLetters = compare.toCharArray();
        //object creation
        File openFile = new File(file);
        Scanner inFile = new Scanner(openFile);
        int  counter = 0;
        while(inFile.hasNext())
            {
                line = inFile.next();
                code = (char)line.charAt(0);
                //System.out.println(code);
                morseLetter[counter] = code;
                morseCode[counter] = inFile.next();
                counter++;
            }//end nested while loop
        for(int j = 0; j < length; j++)
        {
            for(int k = 0; k < MAX; k++)
            {
                if(userLetters[j] == morseLetter[k])
                {
                    newMessage[j] = morseCode[k];
                }
            }//end nested for loop
        }//end for loop
        return newMessage;
    }//end method that completes translateion
    public String toString(String a, String[] b)
{
   System.out.println("Input: " + a);
   System.out.println("Output:");
   String output = "";
   for(int i = 0; i < b.length; i++)
   {
      output = output + b[i];
   }
   return output;
 }//end toString method
}//end Translate Class 
```

主要方法：

```
import javax.swing.JOptionPane;
import java.io.*;
import java.util.Scanner;
public class MorseCodeTester
{
    public static void main(String[] args)throws IOException
    {
        String userInput;
        final String SENTINEL = "0";//for exiting program when entered
        //object creation
        MorseCode text = new MorseCode();
        //getting user input to be translated
        do
        {
            Scanner in = new Scanner(System.in);
            System.out.print("Please enter what you wish to translte to Morse code (no punctuation): ");
            userInput = in.nextLine();
            String compare = userInput.toUpperCase();
            String[] codedText = new String[compare.length()];
            codedText = text.translateHere(compare);
            text.toString(userInput, codedText);
        }while(!userInput.equals(SENTINEL));
    }//end main
}//end class 
```

所以我的程序是当我输入一个输入时，即使在我进行了将其转换为摩尔斯电码的计算的主要方法中，输出也显示为黑色。还有关于我是否可以在我的任何方法中使用静态标识符的任何建议。

这是文本文件：

```
1 .----

2 ..---

3 ...--

4 ....-

5 .....

6 -....

7 --...

8 ---..

9 ----.

0 -----

A .-

B -...

C -.-.

D -..

E .

F ..-.

G --.

H ....

I ..

J .---

K -.-

L .-..

M --

N -.

O ---

P .--.

Q --.-

R .-.

S ...

T -

U ..-

V ...-

W .--

X -..-

Y -.--

Z --.. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:52:02.373

您的代码应使用哈希图按字母键入莫尔斯电码，这使您的代码更简单。获取一个字母的摩尔斯电码是一个简单的查找。

你也可以只加载一次数据，也许在摩尔斯电码的构造函数中。

但是要解决您的问题，您只是没有打印输出。只是返回它而不是在控制台上显示它。

如果你改变你的 toString 方法看起来像这样，它应该打印出一些东西。

```
public String toString(String a, String[] b) {
    System.out.println("Input: " + a);
    System.out.print("Output:"); // changed to a print, to avoid newline
    String output = "";
    for (int i = 0; i < b.length; i++) {
        output = output + b[i];
    }
    System.out.println(output); // this was missing
    return output;
}//end toString method 
```

# wpf - wpf彩色动画绑定

> ID：15853209
> 
> 赞同：1
> 
> 时间：2013-04-06T16:25:16.760
> 
> 标签：wpf, binding, coloranimation

我偶然发现了一个非常烦人的问题，这似乎是一件微不足道的事情，但我无法找到解决方案。我想要做的是将 ColorAnimation 的*To*属性绑定到名为 MouseOverColor 的 DependencyProperty。这就是我的风格：

```
<Style TargetType="{x:Type local:Button}">
  <Setter Property="Background" Value="{StaticResource SolidBlueDark}" />
  <Setter Property="BorderBrush" Value="{x:Null}" />
  <Setter Property="BorderThickness" Value="0" />
  <Setter Property="FocusVisualStyle" Value="{x:Null}" />
  <Setter Property="Foreground" Value="White" />
  <Setter Property="HorizontalContentAlignment" Value="Center" />
  <Setter Property="MouseOverColor" Value="Cyan" />
  <Setter Property="Padding" Value="1" />
  <Setter Property="VerticalContentAlignment" Value="Center" />
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type local:Button}">
        <Grid>
          <VisualStateManager.VisualStateGroups>
            <VisualStateGroup Name="CommonStates">
              <VisualStateGroup.Transitions>
                <VisualTransition GeneratedDuration="0:0:0.4" />
              </VisualStateGroup.Transitions>
              <VisualState Name="Normal" />
              <VisualState Name="MouseOver">
                <Storyboard>
                  <ColorAnimation Storyboard.TargetName="Border" Storyboard.TargetProperty="(Border.Background).Color" To="{TemplateBinding MouseOverColor}" />
                </Storyboard>
              </VisualState>
              <VisualState Name="Pressed" />
              <VisualState Name="Disabled" />
            </VisualStateGroup>
            <VisualStateGroup Name="FocusStates">
              <VisualState Name="Unfocused" />
              <VisualState Name="Focused" />
            </VisualStateGroup>
          </VisualStateManager.VisualStateGroups>
          <Border 
            Name="Border" 
            Background="{TemplateBinding Background}" 
            BorderBrush="{TemplateBinding BorderBrush}" 
            BorderThickness="{TemplateBinding BorderThickness}" 
            Height="{TemplateBinding Height}" 
            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
            Width="{TemplateBinding Width}" />
          <ContentPresenter 
            TextBlock.Foreground="{TemplateBinding Foreground}" 
            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
            Margin="{TemplateBinding Padding}" 
            RecognizesAccessKey="True" 
            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
            VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
        </Grid>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

发生的事情是什么都没有发生，按钮的颜色保持不变。如果我将 ColorAnimation 线更改为以下内容，它会更改颜色：

```
<ColorAnimation 
  Storyboard.TargetName="Border"
  Storyboard.TargetProperty="(Border.Background).Color"
  To="Cyan" /> 
```

但是我需要通过 MouseOverColor 属性设置*To*颜色而不是硬编码，我该如何实现呢？我尝试了各种绑定，但结果总是一样的。

提前致谢。

**编辑：**如果我使用静态资源，它也可以工作，但这不是我想要的。真的没有办法做我想做的事吗？为我希望能够使用的每种“鼠标悬停”颜色创建新样式并对其进行硬编码是没有任何意义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-17T22:44:11.283

根据[此 MSDN 论坛主题](https://social.msdn.microsoft.com/Forums/vstudio/en-US/027c364f-5d75-424f-aafd-7fb76b10b676/templatebinding-on-storyboard?forum=wpf)中的一位 Microsoft 作者的说法，WPF 不支持您尝试执行的操作。动画值必须被冻结，因此它们不能是动态的或绑定的。我只是偶然发现了同样的限制。如果您尝试这样做，则不会引发错误，它只是没有设置任何颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T11:36:10.057

不确定这是否适合您的情况...

如果`MouseOverColor`是您自己的自定义属性 - 尝试另一种`Templated Binding`工作方式。

```
{Binding RelativeSource={RelativeSource TemplatedParent}, Path=MouseOverColor} 
```

我在这里更详细地解释了它

[Image.Height TemplateBinding 不起作用](https://stackoverflow.com/questions/15435385/image-height-templatebinding-does-not-work/15435781#15435781)

# c# - 返回同类型的同类型集合

> ID：15853210
> 
> 赞同：2
> 
> 时间：2013-04-06T16:25:17.447
> 
> 标签：c#, generics, type-parameter

我正在尝试创建一种洗牌集合的方法。我希望它是通用的，这意味着它应该采用特定类型的集合（`TCollection`）类型的元素`TEl`。我希望该方法返回包含与参数相同类型的*元素的相同类型的**集合*。

 *这是我到目前为止所尝试的：

```
internal static TCollection FisherYatesShuffle<TCollection, TEl>(this TCollection objects)
    where TCollection : IEnumerable<TEl>
{
    var ret = new TEl[objects.Count()];
    ret[0] = objects.First();
    var rand = new Random();
    for (var i = 1; i < objects.Count(); i++)
    {
        var j = rand.Next(0, i);
        ret[i] = ret[j];
        ret[j] = objects.ElementAt(i);
    }

    return ret; //CS0029: Cannot implicitly convert type 'TEl[]' to 'TCollection'
  //return (TCollection)ret; //CS0030: Cannot convert type 'TEl[]' to 'TCollection'
} 
```

我尝试使用的泛型类型是否可行？如果是，我将如何改变我的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:29:17.053

你最好的选择是使用：

```
where TCollection : IList<TEl>, new() 
```

进而

```
var result = new TCollection();
...
    result.Add(item)
...
return result; 
```

不过，这不适用于数组 - 可能需要对它们进行特殊处理。*

# c# - 使用网络浏览器控件进行自动登录时如何避免安全页面？

> ID：15853215
> 
> 赞同：5
> 
> 时间：2013-04-06T16:25:34.903
> 
> 标签：c#

朋友我的任务是使用 C# 窗口应用程序必须自动登录到站点和登录后的第一页。有链接，点击该链接后，用户可以下载excel文件。我可以实现这个，就像我可以制作这个 exe 并把它放在我的日程安排上，我会设置时间。所以它会自动下载excel文件。

我完成了登录代码，但登录后遇到问题，它显示了安全问题页面。那么我怎样才能避免这个页面呢？当通过调度执行exe时，它没有显示任何前端？所以我必须隐藏前端，这样也可以保留。

任何与我的概念或代码相关的建议都会对我很有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:28:22.780

这些安全问题和验证码的全部意义在于避免您正在尝试实现的目标，并防止自动脚本和机器人访问该站点。如果网站的作者决定将他们放在网站上，那是因为他们不希望他们的网站以您打算使用的方式使用。所以恐怕没有正式的、简单的方法来完成这个任务。

# html - 如何在前两列中创建跨度跨度的表头？

> ID：15853221
> 
> 赞同：-5
> 
> 时间：2013-04-06T16:25:53.947
> 
> 标签：html, html-table

请看这个：

[jsfiddle.net/hTRQJ/](http://jsfiddle.net/hTRQJ/)

```
<table class="table table-bordered table-striped"><thead>
            <tr>
                <th colpan="">
                    Checkin
                </th>
                <th>
                    Checkout
                </th>

                <th>
                    Description
                </th>
                <th>Total</th>

            </tr>
        </thead>
        <tbody><tr>
        <td>test</td>
        <td>2013-03-28 19:19:00</td>
        <td>2013-03-28 19:35:00</td>
        <td>Implementatie OAuth</td>
        <td>00:16</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:19:00</td>
        <td>2013-03-28 19:20:00</td>
        <td>Site werkt niet</td>
        <td>00:01</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:15:00</td>
        <td>2013-03-28 19:42:00</td>
        <td>apache recompile</td>
        <td>00:27</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:14:00</td>
        <td>2013-03-28 19:47:00</td>
        <td>Site werkt niet</td>
        <td>00:33</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:12:00</td>
        <td>2013-03-28 19:37:00</td>
        <td>Site werkt niet</td>
        <td>00:25</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:08:00</td>
        <td>2013-03-28 19:36:00</td>
        <td>apache recompile</td>
        <td>00:28</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:07:00</td>
        <td>2013-03-28 19:39:00</td>
        <td>Git repos</td>
        <td>00:32</td>
    </tr><tr>
        <td>test</td>
        <td>2013-03-28 19:05:00</td>
        <td>2013-03-28 19:34:00</td>
        <td>Server failure</td>
        <td>00:29</td>
    </tr><tr>
        <td colspan="4"><span style="float:right">Total</span></td><td>03:11</td></tr>
</tbody></table> 
```

我希望“测试”与第一个日期时间在同一列。我需要改变什么？

编辑：

我想要这样；[http://s7.postimg.org/yb4hppnfv/Knipsel.png](http://s7.postimg.org/yb4hppnfv/Knipsel.png) 所以你在最后一列看到的效果，我想要在第一列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:37:16.750

这是表格的标题和前两行。其余的可以按照相同的规则完成。

```
<table class="table table-bordered table-striped"><thead>
                                    <tr>
                                        <th colpan="2">
                                            Checkin/Checkout
                                        </th>
                                        <th>
                                            Description
                                        </th>
                                        <th>Total</th>

                                    </tr>
                                </thead>
                                <tbody><tr>
                                <td colspan="2">test 2013-03-28 19:19:00</td>
                                <td>2013-03-28 19:35:00</td>
                                <td>Implementatie OAuth</td>
                                <td>00:16</td>
                            </tr><tr>
                                <td colspan="2">test 2013-03-28 19:19:00</td>
                                <td>2013-03-28 19:20:00</td>
                                <td>Site werkt niet</td>
                                <td>00:01</td>
                            </tr><tr> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:34:44.080

您是说您希望“测试” td 跨越两列，进入日期时间吗？

然后将 colspan 属性添加到 td 测试，并将其设置为“2”。

```
<tr> <td colspan="2">test</td> </tr> 
```

像那样，它应该在一个空间上移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-26T18:53:50.540

总的来说，您需要有名称的单元格数 (td = 5) 和 th colspans (2 + 1 + 2 = 5)。

这是前两行：

```
<table class="table table-bordered table-striped"><thead>
    <tr>
    <th colspan = "2">
        Checkin/Checkout
    </th>
    <th>
        Description
    </th>
    <th colspan = "2">Total</th>                                    
    <tr>
    <td>test</td>
    <td>2013-03-28 19:19:00</td>
    <td>2013-03-28 19:35:00</td>
    <td>Implementatie OAuth</td>
    <td>00:16</td>
</tr><tr>
    <td>test</td>
    <td>2013-03-28 19:19:00</td>
    <td>2013-03-28 19:20:00</td>
    <td>Site werkt niet</td>
    <td>00:01</td>
</tr>></tr></tbody></table> 
```

# jquery - 为什么 index() 不能按预期工作

> ID：15853229
> 
> 赞同：2
> 
> 时间：2013-04-06T16:27:05.857
> 
> 标签：jquery

**HTML：**

```
<div class="div1">Div 1</div>
<div class="div2">Div 2</div> 
<div class="div3">Div 3</div> 
<div class="div4">Div 4</div> 

<div class="test">Test</div>
<br />
<div class="test">Test</div>
<br />
<div class="test">Test</div> 
<br />
<div class="test">Test</div>
<br /> 
```

**查询：**

```
$(".test").each(function(){
    var i = $(this).index();
    alert(i);
}); 
```

`[**Fiddle Demo**](http://jsfiddle.net/9w5zS/)`

我希望结果是`0, 1, 2, 3`，但为什么输出是`4, 6, 8, 10`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:28:45.107

轻松修复 - .each 支持索引：

```
$(".test").each(function(idx){
    alert(idx);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T16:28:55.900

> 为什么输出是`4, 6, 8, 10`

`$(this).index()`返回元素相对于其**兄弟**元素的索引，而不是选定元素的索引。和元素也是兄弟姐妹`br`！`.divX`

看起来你想要：

```
var $tests = $(".test");

$tests.each(function(){
    var i = $tests.index(this);
    alert(i);
}); 
```

或更简单：

```
$(".test").each(function(i){
    alert(i);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-06T16:29:05.913

*index() 给出元素相对于其兄弟元素的索引*。具有文本类的第一个 div 是第 5 个元素，索引为 4，br 位于 5 索引处，下一个具有类 test 的 div 具有索引 6，依此类推。我们可以通过下面的demo查看每个元素的索引

**[现场演示](http://jsfiddle.net/WqunB/)**

```
$("#parent1 *").each(function () {
    alert("TagName >> " + this.tagName + ", Index >> " + $(this).index() + ", Text " + $(this).text());
}); 
```

> 如果没有参数传递给 .index() 方法，则返回值是一个整数，指示 jQuery 对象中的第一个元素相对于其兄弟元素[Reference](http://api.jquery.com/index/)的位置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-06T16:29:38.210

你想要做的是：

```
$(".test").each(function(i) {
    alert(i);
}); 
```

[`.index()`](http://api.jquery.com/index/#index)返回相对于其兄弟的索引。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-06T16:29:11.220

您必须使其与您要测试的内容相关。采用：

```
$(".test").each(function(){
    var i = $('.test').index($(this));
    console.log(i);
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/9w5zS/1/)**

根据以下文档[`.index()`](http://api.jquery.com/index/)：

> 如果在元素集合上调用 .index() 并传入 DOM 元素或 jQuery 对象，则 .index() 返回一个整数，指示传递的元素相对于原​​始集合的位置。

# objective-c - NSApp terminate:id 是否已弃用？

> ID：15853230
> 
> 赞同：9
> 
> 时间：2013-04-06T16:27:06.967
> 
> 标签：objective-c, macos, cocoa, nsapplication

我一直在寻找如何以编程方式终止我的应用程序。我在许多主题中发现人们使用`NSApp terminate:id`.

在 Xcode`terminate:id`中是交叉的。这种方法是否已弃用？我应该用它来终止我的应用程序吗？如果没有，这是正确的方法吗？

**更新：** 当我说它被交叉时，我的意思是： ![在此处输入图像描述](https://i.stack.imgur.com/F1NKM.png)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-06T16:41:47.003

我没有看到它`terminate`已被弃用。编译器警告的一个可能原因可能是

```
[NSApp terminate:sender] 
```

`NSApp`返回一个 general `id`，以便编译器不知道`terminate`实际意味着哪个消息。确实，如果我使用“跳转到定义”，Xcode 会跳转到

```
@protocol NSInputServiceProvider
...
- (void) terminate:(id)sender NS_DEPRECATED_MAC(10_0, 10_6); 
```

但是如果你使用等效的代码

```
[[NSApplication sharedApplication] terminate:sender]; 
```

然后编译器警告消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:40:42.013

[不，不推荐使用](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/20000012-CACCGIJC)：

* * *

## 终止：

终止接收器。

```
- (void)terminate:(id)sender 
```

### 参数

*发件人*

通常，此参数包含发起终止请求的对象。

### 讨论

当用户从应用程序的菜单中选择退出或退出时，通常会调用此方法。

调用时，此方法执行几个步骤来处理终止请求。首先，它要求应用程序的文档控制器（如果存在）保存其文档中所有未保存的更改。在此过程中，文档控制器可以响应来自用户的输入取消终止。如果文档控制器没有取消操作，则此方法然后调用委托的`applicationShouldTerminate:`方法。如果`applicationShouldTerminate:`返回`NSTerminateCancel`，则终止过程中止并将控制权交还给主事件循环。如果方法返回`NSTerminateLater`，应用程序在模式下运行它的运行循环，`NSModalPanelRunLoopMode`直到`replyToApplicationShouldTerminate:`使用值`YES`or调用方法`NO`。如果该`applicationShouldTerminate:`方法返回`NSTerminateNow`，则该方法发布一个`NSApplicationWillTerminateNotification`通知到默认通知中心。

不要费心将最终的清理代码放入应用程序的`main()`函数中——它永远不会被执行。如果需要清理，请在委托的`applicationWillTerminate:`方法中执行清理。

### 可用性

在 OS X v10.0 及更高版本中可用。

### 也可以看看

*   `– run`
*   `– stop:`
*   `– applicationShouldTerminate:`(NSApplicationDelegate)
*   `– applicationWillTerminate:`(NSApplicationDelegate)
*   `– replyToApplicationShouldTerminate:`
*   `NSApplicationWillTerminateNotification`

### 相关示例代码

*   爆炸应用
*   登录前代理

### 宣布于

NSApplication.h

# php - 单击链接以针对链接中的特定值运行 MySQL 查询 (php)

> ID：15853232
> 
> 赞同：1
> 
> 时间：2013-04-06T16:27:20.503
> 
> 标签：php, mysql, hyperlink

我很难找到解决方案，大多数问题都是单击按钮运行查询。

我所拥有的是 HTML 表中的 db 表名列表。我需要它们采用超链接格式，一旦我单击表名，它应该将表名发送到 php 文件并运行 mysql 查询以获取表的所有属性。

最好的方法是什么？提前感谢所有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:36:14.367

嗯？如果要使用查询，phpmyadmin 怎么样

但如果你喜欢构建自己的 SQL 查询工具，那么请学习以下内容：

**列表数据库：**

[http://php.net/manual/en/function.mysql-list-dbs.php](http://php.net/manual/en/function.mysql-list-dbs.php)

**列表：**

[http://www.php.net/manual/en/function.mysql-list-tables.php](http://www.php.net/manual/en/function.mysql-list-tables.php)

**最后列出字段**

[http://www.php.net/manual/en/function.mysql-list-fields.php](http://www.php.net/manual/en/function.mysql-list-fields.php)

* * *

**添加 Q-Starter 的模糊请求。**

**@example:index.php**

```
<form method="get" action="query.php">
    <label>Statement: </label><input type="text" name="sqlState"/>
</form> 
```

**@example:query.php**

```
<?php
    $sqlState = $_GET['sqlState'];
    $result = mysql_query($sqlState);
    echo $result;
?> 
```

这是糟糕的编程代码，但是如果您真的想探索然后去尝试这些代码，只需自己使用它，如果其他用户尝试使用所谓的**“SQL INJECTION”** ，这可能会损坏您的数据库。

# plot - gnuplot 绘制一列与整数的关系

> ID：15853234
> 
> 赞同：0
> 
> 时间：2013-04-06T16:27:39.480
> 
> 标签：plot, gnuplot, using

我知道要绘制两列一一对比我必须使用：使用 1:2 绘制“datafile.dat”但是如果我的数据文件中只有一列并且我想通过将每个值关联到一个整数来绘制它从0开始的数字，即我在数据文件中的列将是y轴，整数将是x轴

感谢您的帮助，谢谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T19:14:42.377

这样做的方法是使用`0`伪列：

```
plot 'datafile.dat' u 0:1 
```

简单的！:)

我建议在 gnuplot 文档中查找伪列以及`using`命令的详细信息；还有许多其他有用的操作可能。

# user-interface - Kendo UI Web Grid - 选择所有性能问题

> ID：15853235
> 
> 赞同：2
> 
> 时间：2013-04-06T16:27:40.167
> 
> 标签：user-interface, kendo-ui

在工具栏上创建全选/取消全选时是否有人遇到性能问题并且更新非常慢。使用数据源 set/get 方法遍历网格中的 300 条记录大约需要 10 秒。

我使用的代码如下：

```
 var data = dataSource.view();
    for (var idx = 0, length = data.length; idx < length; idx++) {
        if (!data[idx].IsActive) data[idx].set("IsActive", true);
    } 
```

有人遇到过这个问题吗？有没有办法提高性能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T13:17:10.880

不是每次都计算数据的长度，而是像这样将长度存储在局部变量中

```
 var data = dataSource.view();
  var dataLength=data.length;
  for (var idx = 0, length = dataLength; idx < length; idx++) {
         data[idx].Active = true;
  }
  grid.refresh(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T13:54:03.747

三个问题：

1.  如果您要设置`IsActive`为`true`，请不要花时间检查它是否已经存在`true`；
2.  它不是`set`直接分配值，`set`而是一个非常昂贵的操作，然后进行刷新以更新 UI。
3.  您的计算机比我的要快得多，在我的情况下，300 个值需要更长的时间；-)

尝试做：

```
var data = dataSource.view();
for (var idx = 0, length = data.length; idx < length; idx++) {
    data[idx].Active = true;
}
grid.refresh(); 
```

# javascript - KnockoutJS - 如何将值插入 html viewmodel？

> ID：15853236
> 
> 赞同：-2
> 
> 时间：2013-04-06T16:27:40.967
> 
> 标签：javascript, knockout.js

我有这个作为我的淘汰视图模型：

`<a href="javascript:void(0);" onclick="CreateChatWindow('SomeValue');" class="socialsChat">`

现在，我怎样才能插入我的模型值来代替`SomeValue`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:41:54.917

您必须使用 knockoutjs 处理单击事件，请尝试以下操作：

```
<a href="#" data-bind="click: CreateChatWindow($root.someValue)">I'm a link</a> 
```

其中 $root 是对您的 viewModel 的引用。

# c# - User.Identity.IsAuthenticated 与 WebSecurity.IsAuthenticated

> ID：15853237
> 
> 赞同：9
> 
> 时间：2013-04-06T16:27:44.107
> 
> 标签：c#, authentication, asp.net-mvc-4, forms-authentication

在 MVC4 应用程序中，在控制器逻辑中，我想检查用户是否已登录。
我应该使用：

```
User.Identity.IsAuthenticated 
```

或者：

```
WebSecurity.IsAuthenticated 
```

据我所知`WebSecurity`只是一个包装。我应该使用它还是`User.Identity`具有不同的功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T16:30:37.050

> 据我所知，WebSecurity 只是一个包装器。

没错，两者都是一样的。让我们看看`WebSecurity.IsAuthenticated`属性是如何实现的：

```
public static bool IsAuthenticated
{
    get
    {
        return Request.IsAuthenticated;
    }
} 
```

现在让我们看看`WebSecurity.Request`静态属性是如何实现的：

```
internal static HttpRequestBase Request
{
    get
    {
        return Context.Request;
    }
} 
```

最后让我们看看`WebSecurity.Context`静态属性是如何实现的：

```
internal static HttpContextBase Context
{
    get
    {
        return new HttpContextWrapper(HttpContext.Current);
    }
} 
```

如您所见：

```
WebSecurity.IsAuthenticated 
```

是相同的：

```
new HttpContextWrapper(HttpContext.Current).Request.IsAuthenticated 
```

反过来，这`Context.User.Identity.IsAuthenticated`与存在 null 检查的细微差别相同，并且如果例如`Identity`属性为 null，则该属性将返回 false。

> 我应该使用它还是 User.Identity 具有不同的功能？

即使两者严格等价，我也会使用`User.Identity`官方的 ASP.NET 实现，因为如果明天您决定用其他东西替换简单的成员资格提供程序，那么您的代码中要替换的东西就会少得多。

# java - 友好数字Java程序

> ID：15853242
> 
> 赞同：1
> 
> 时间：2013-04-06T16:28:55.517
> 
> 标签：java

所以我有这个奇怪的输出，其中只有第一个数字被检查了两次，而第二个数字甚至没有被考虑。请帮忙。

**代码 ：-**

```
import java.util.Scanner;

public class Amicable
{
    private static int a,b;
    private static String m,n; 

    public static void main()
    {       
        acceptNumbers();

        if (firstNumber() == secondNumber())
        {
            System.out.println(a+" and "+b+" are amicable numbers");
        }

        else    System.out.println(a+" and "+b+" are not amicable numbers");
    }

    public static void acceptNumbers()
    {
        Scanner sc = new Scanner(System.in);

        int count=0;

        System.out.print("Enter two numbers [ separated by a ',' ] : ");
        String input = sc.nextLine(); 

        System.out.println();

        for (int i = 0; i < input.length(); i++)
        {
            char c = input.charAt(i);

            if (c == ',')
            {
                count++;
                if (count == 1)
                {
                    m = input.substring(0,i);
                    n = input.substring(0,i);
                }

                break;
            }            
        }

        if (count == 0)
        {
             System.out.println("Invalid operation : You have entered only 1 number");
        }        

        m = m.trim(); n = n.trim();

        a = Integer.valueOf(m);
        b = Integer.valueOf(n);
    }

    public static int firstNumber()
    {
        int a1,a2=0;

        for (int i = 0; i < m.length()-1; i++)
        {
            a1 = Integer.valueOf(m.charAt(i));

            if (a%a1 == 0)    a2 = a2+a1;        
        }

        return a2;
    }

    public static int secondNumber()
    {
        int b1,b2=0;

        for (int i = 0; i < n.length()-1; i++)
        {
            b1 = Integer.valueOf(n.charAt(i));

            if (b%b1 == 0)    b2 = b2+b1;        
        }       

        return b2;
    }
} 
```

**这是输出：-**

输入 2 个数字 [用 ',' 分隔] : 248 , 222

248 和 248 是友好的数字

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:31:58.260

你的 m 和 n 是相等的，因为你有：

```
m = input.substring(0,i);
n = input.substring(0,i); 
```

将其更改为：

```
m = input.substring(0,i);
n = input.substring(i+1); 
```

顺便说一句，您正在做很多不必要的事情，完整的解决方案（我不关心异常）：

```
import java.util.Scanner;

public class Amicable {
    public static void main(String args[]) {
        try {
            Scanner sc = new Scanner(System.in);
            System.out.print("Enter two numbers [ separated by a ',' ] : ");
            String input = sc.nextLine();

            String[] numbers = input.split(",");

            int num1 = Integer.parseInt(numbers[0].trim());
            int num2 = Integer.parseInt(numbers[1].trim());
            int sum1 = 0, sum2 = 0;
            for (int i = 1; i <= num1; i++) {
                if (num1 % i == 0)
                    sum1 += i;
            }
            for (int i = 1; i <= num2; i++) {
                if (num2 % i == 0)
                    sum2 += i;
            }
            if (sum1 == sum2)
                System.out.println(num1 + " and " + num2
                        + " are amicable numbers");
            else
                System.out.println(num1 + " and " + num2
                        + " are not amicable numbers");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

部分代码来自：[http ://www.daniweb.com/software-development/java/code/304600/amicable-numbers](http://www.daniweb.com/software-development/java/code/304600/amicable-numbers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:32:30.130

`a`and`b`派生自`m`and `n`，后者被初始化为完全相同的值：

```
 m = input.substring(0,i);
                n = input.substring(0,i); 
```

你的意思是设置`n`为

```
 n = input.substring(i+1); 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:33:49.157

```
m = input.substring(0,i);
n = input.substring(0,i); 
```

`m`并且`n`具有**相同的价值**。

`n`应该：

`n = input.substring(i+1);`

现在第二个号码将分配给`n`。

# magento-1.7 - Magento 1.7 无法保存追加销售产品

> ID：15853249
> 
> 赞同：2
> 
> 时间：2013-04-06T16:29:06.537
> 
> 标签：magento-1.7

我遇到了一个奇怪的问题。我在magento中有一个虚拟产品，我点击编辑，我去追加销售产品，选择一个并点击保存。产品正在保存，没有错误。如果我再次点击编辑，我之前选择的追加销售产品不会被保存。

尽管表单提交完成且没有错误，但没有保存来自追加销售、相关或交叉销售选项卡的数据。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-14T09:58:04.507

您是否尝试使用数据库修复工具，您的数据库可能有问题[http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/db-repair-tool](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/db-repair-tool)

# multithreading - java - 避免不必要的线程唤醒

> ID：15853256
> 
> 赞同：1
> 
> 时间：2013-04-06T16:29:51.413
> 
> 标签：multithreading, notifications, throughput, java1.4

我有一组 12 个线程并行执行工作（*Runnable*）。本质上，每个线程执行以下操作：

```
Runnable r;

while (true) {
    synchronized (work) {
        while (work.isEmpty()) {
            work.wait();
        }
        r = work.removeFirst();
    }
    r.execute();
} 
```

添加工作如下：

```
Runnable r = ...;

synchronized (work) {
    work.add(r);
    work.notify();
} 
```

当有新作品可用时，它会被添加到列表中并通知锁定。如果有线程在等待，它就会被唤醒，所以它可以执行这个工作。

问题就在这里。当一个线程被唤醒时，很有可能**另一个**线程会执行这个工作。当后一个线程完成其先前的工作并重新进入*while(true)*循环时，就会发生这种情况。工作动作越小/越短，发生这种情况的可能性就越大。

**这意味着我正在无缘无故地唤醒一个线程。**由于我需要高吞吐量，我相信这种行为会降低性能。

你会如何解决这个问题？理论上，我需要一种机制来取消挂起的线程唤醒通知。当然，这在 Java 中是不可能的。

我考虑为每个线程引入一个工作列表。不是将工作推入一个单独的列表，而是将工作分布在 12 个工作列表中。但我相信这会带来其他问题。例如，一个线程可能有很多待处理的工作，而另一个线程可能没有待处理的工作。从本质上讲，我相信**提前**将工作分配给特定线程的解决方案可能会变得非常复杂并且是次优的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:55:10.833

你正在做的是一个线程池。看看 pre java-5 并发框架，那里的 PooledExecutor 类：http: [//gee.cs.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/intro.html](http://gee.cs.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/intro.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:38:23.503

除了我之前的答案 - 另一个解决方案。这个问题让我很好奇。

在这里，我添加了一个带有 volatile 布尔值的检查。

它并不能完全避免无用唤醒线程的情况，但有助于避免这种情况。实际上，如果没有额外的限制，例如“我们知道 100 毫秒后最有可能完成一项工作”，我看不出如何完全避免这种情况。

```
volatile boolean free = false;

while (true) {
    synchronized (work) {
        free = false;               // new rev.2
        while (work.isEmpty()) {
            work.wait();
        }
        r = work.removeFirst();
    }
    r.execute();
    free = true;        // new
} 
```

--

```
synchronized (work) {
    work.add(r);
    if (!free) {         // new
         work.notify();
    }                    // new
    free = false;        // new rev.2
} 
```

# c - Xlib：使用 PIxmap 和 XDrawPoint 显示网络摄像头太慢了……我该如何改进？

> ID：15853264
> 
> 赞同：2
> 
> 时间：2013-04-06T16:30:42.463
> 
> 标签：c, xlib

我想打开网络摄像头并用 Xlib 显示视频。因此，我打开网络摄像头，获取图像，然后执行以下操作：

```
for(x = 0; x < webcamX; x++){
    for(y = 0; y < webcamY; y++){
        pixel = GetCameraPixel(x, y);
        XDrawPoint(dpy, pixmap, pixel, x, y);
    }
}
XCopyArea(dpy, pixmal, window, ....); 
```

但是，调用 XDrawPoint 太慢了。我也尝试使用 XImage，但这次 XPutPixel 和 XPutImage 都很慢（使用 Pixmap 比 XImage 快）

我认为问题在于执行 XDrawPoint 640 * 480 次会向 X 服务器发出大量请求。做XPutImage的时候也是一样，发一个640*480的图片很多..不是吗？

**所以，忘记网络摄像头，**想象一下我想做一个游戏，一个动画，一个视频播放器，或者任何东西，只有 XLib.. 有可能吗？我确定逐像素绘制效率不高，那我该如何做好呢？我在互联网上找到的所有信息都是使用 Pixmap 或 XImage，它比在窗口本身上绘图要好，但还不够。

例如，xscreensavers 全屏显示非常漂亮的动画（我认为他们只使用 Xlib），他们如何使动画流畅？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T03:12:56.203

好吧，我想这是我的错。使用 XImage 是最好的方法，它在逐像素绘制时非常快速和流畅，例如网络摄像头示例。但是，我正在使用 XYPixmap 创建 XImage，它太慢了，我改为 ZPixmap，一切都很完美！

所以，我用于网络摄像头的解决方案是：

```
image = XCreateImage(dpy, DefaultVisual(dpy, DefaultScreen(dpy)), DefaultDepth(dpy, DefaultScreen(dpy)), ZPixmap, 0, imagedata, webcamX, webcamY, 32, 0);
/* ....*/
for(x = 0; x < webcamX; x++){
    for(y = 0; y < webcamY; y++){
        pixel = GetCameraPixel(x, y);
        XPutPixel(image, x, y, pixel);
    }
}
XPutImage(dpy, window, gc, image, 0, 0, 0, 0, webcamX, webcamY); 
```

*   使用 ZPixmap 格式创建 XImage
*   在那个 XImage 中绘制（在我的例子中使用 XPutPixel）
*   将 XImage 复制到窗口（使用 XPutImage）

我认为使用 XYPixmap 太慢了，因为 X 需要进行某种转换，从而使过程非常缓慢

# php - PDO bindParam 不允许语句返回结果

> ID：15853266
> 
> 赞同：1
> 
> 时间：2013-04-06T16:30:50.830
> 
> 标签：php, mysql, select, binding, pdo

我有一个 pdo 语句来选择行并将它们返回到一个数组中。我正在使用分页显示每页 12 个结果。如果我直接输入`LIMIT 12, 12`，而不是`LIMIT ?, ?`语句正常工作。

我对这两个变量的 bindParam 做错了什么？

两个变量都包含正确的数据。

这是我正在使用的功能：

```
// Retrieve active posts
function retrieve_active_posts(){
    //test the connection
    try{
        //connect to the database
        $dbh = new PDO("mysql:host=db2940.oneandone.co.uk;dbname=db348699391","xxx", "xxx");
    //if there is an error catch it here
    } catch( PDOException $e ) {
        //display the error
        echo $e->getMessage();

    }

    // Get all the posts
    $stmt = $dbh->prepare(" SELECT  p.post_id, post_year, post_desc, post_title, post_date, img_file_name, p.cat_id
                            FROM    mjbox_posts p
                            JOIN    mjbox_images i
                            ON      i.post_id = p.post_id
                                    AND i.cat_id = p.cat_id
                                    AND i.img_is_thumb = 1
                                    AND post_active = 1
                            ORDER BY post_date
                            DESC
                            LIMIT ?,?");
    $stmt->bindParam(1, $limit);
    $stmt->bindParam(2, $offset);                       
    $stmt->execute();

    while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {

            $resultarray[] = $row;
    }

    return $resultarray;
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:36:59.240

确保 和 的类型`$limit`设置`$offset`为`PDO::PARAM_INT`：

```
$limit = 20;
$offset = 0;

$stmt->bindParam(1, $limit,  PDO::PARAM_INT);
$stmt->bindParam(2, $offset, PDO::PARAM_INT); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-02T22:31:39.337

连接到数据库后，插入以下代码行：

```
$conn->setAttribute( PDO::ATTR_EMULATE_PREPARES, false); 
```

来源：[https ://www.php.net/manual/en/pdo.setattribute.php](https://www.php.net/manual/en/pdo.setattribute.php)

# javascript - 为什么 Flash 播放器在 Firefox 中设置较大的容器 div 高度时会崩溃？

> ID：15853268
> 
> 赞同：2
> 
> 时间：2013-04-06T16:31:15.907
> 
> 标签：javascript, html, css, apache-flex, flash

我在 HTML Div 中加载了一个 Flex 应用程序：

```
 <div id="flashContent" style="height: 350px;"></div> 
```

像这样

```
var so = new SWFObject("photoGallery.swf", "photoGallery", "100%", "100%", "9", "#FFFFFF");
    so.addParam("wmode", "transparent");
    so.addVariable("varLang", lang);
    so.write("flashContent"); 
```

我想让 div 的高度适应 SWF 的内容，所以从 Flex 我使用`externalInterface.call()`这个 Javascript 函数：

```
function loadPhotoGallery(newHeight)
{
    document.getElementById('flashContent').style.height = (newHeight + 70) + 'px';
} 
```

直到最近，当内容（照片库）变大时，一切都运行良好……调用大于 9000的`loadPhotoGallery`函数会使使用 Firefox 和 Safari 的 Flash 播放器崩溃。`newHeight`它适用于 Chrome。（在 Mac 上测试）。是否有导致崩溃的最大高度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T16:22:41.127

您可能想尝试像Photosynth这样的东西。该程序可以将数千张图片组织成类似全景的视图。您可以在图形加速器上拥有高达千兆像素的处理能力。

祝你好运！延长内容交付的未来

# jquery - jQuery Masonry 在两个元素之间添加额外的空间

> ID：15853278
> 
> 赞同：3
> 
> 时间：2013-04-06T16:32:11.013
> 
> 标签：jquery, css, jquery-masonry

我正在使用 jQuery Masonry，但它不能正常工作。它没有按应有的方式排列元素。这里有一些截图来演示这个问题。

![额外空间截图：](https://i.stack.imgur.com/iFrgO.jpg)

CSS 代码：

```
#cont {
width:100%;
height:0 auto;
min-height:670px;
padding:15px 15px;
}
#cont .item {
display:block;
width:auto;
padding:10px;
border-radius:2px 2px 2px;
background:#fff;
border:1px solid #ddd;
float:left;
margin:5px;
} 
```

jQuery代码：

```
$('#cont').masonry({
        itemSelector: '.item'
}).imagesLoaded(function() {
    $('#cont').masonry('reload');
}); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-08T06:43:52.983

用于元素而`disply: inline-block;`不是`.item``display:block;`

# ms-access - MS Access 报告的 VBA 代码中的表达式

> ID：15853279
> 
> 赞同：-1
> 
> 时间：2013-04-06T16:32:11.013
> 
> 标签：ms-access, vba

当只有一条记录时，此表达式给出正确的计算，但当有多个记录时，最后一条记录的计算值会反映在所有`Total_Time`（未绑定的文本框）中。我已经给出了报告的加载和打开代码。请帮我。

```
Private Sub Report_Load()

  strSQL = "SELECT * FROM [q_1ltduty]"
  Set db = CurrentDb
  Set rs = db.OpenRecordset(strSQL)
  rs.MoveFirst
  Do While Not rs.EOF
    'Assigning values of fields to varia
    strtime1 = Op_Time
    strtime2 = Cl_Time
    'This is a simple expression my code has some more detailed calculations
    strhrs = strtime2 - strtime1
    strtotalhrs = strhrs
    'Printing the variable in Total_Time textbox(unbound)
    Me.Total_Time.Value = strtotalhrs
    rs.MoveNext
  Loop
  rs.Close
  db.Close
  Set db = Nothing
  Set rs = Nothing
End Sub

Private Sub Report_Open(Cancel As Integer)

  strSQL = "SELECT * FROM [q_1ltduty]"
  Me.RecordSource = strSQL
  Debug.Print strSQL

  Exit Sub
  ErrHandler:
  MsgBox Err.Description

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:16:58.263

您的变量`strtotalhrs`仅包含`strhrs`一条记录的值，因此每次循环时，当前记录的值都会擦除前一条记录的值。你应该做的而不是删除价值是增加它。

在循环之前（如果尚未完成）：

```
strtotalhrs = 0 
```

然后在循环中，而不是`strtotalhrs = strhrs`：

```
strtotalhrs = strtotalhrs + strhrs 
```

这应该给你总和而不是最后一个值。

# javascript - 无法使用事件处理程序访问对象内部的对象

> ID：15853287
> 
> 赞同：0
> 
> 时间：2013-04-06T16:32:41.933
> 
> 标签：javascript, object, dom-events

我有两个用作类的函数：`Person`和`Eye`. `Person`自己创建一个`Eye`对象。稍后，我尝试访问创建的眼睛对象，每当用户单击网页时，都会使用事件处理程序。

```
function Eye(){
   this.color="Green";
}

function Person() {

   this.name="John";
   this.eye = new Eye();
   //eye=this.eye; // uncomment and everything works!

   document.addEventListener("click", function(){
      console.log(name); // This works

      console.log(eye);  // This doesn't work

   })

}

var person= new Person(); 
```

为什么这不起作用？制作第二个变量`eye`似乎可以解决问题，但我不知道为什么..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:36:11.557

它不起作用，因为“眼睛”不是变量，它是对象的属性。您没有做任何事情来告诉 JavaScript 要查看什么对象。

您必须将 的值保存`this`在另一个局部变量中：

```
function Person() {
  this.name="John";
  this.eye = new Eye();
  var person = this; 
```

然后你可以在事件处理程序中使用它：

```
 console.log(person.eye); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:37:05.350

```
document.addEventListener("click", function() {
    console.log(name);
    console.log(eye);
}); 
```

在这种情况下，`name`指`name`的是窗口对象的属性，因为您没有指定要访问它的对象。`window.name`恰好返回`"result"`我的实施。并且 ogging`eye`将不起作用，因为`eye`尚未将其定义为变量。

要解决此问题，请使用一个变量来存储对事件函数*外部当前对象的引用并在内部使用它。*

```
var ref = this;

document.addEventListener("click", function() {
    console.log(ref.name);
    console.log(ref.eye);
}); 
```

> 输出：
> 
> ```
> John
> Eye { color: "Green" } 
> ```

[***现场演示***](http://jsfiddle.net/TUEgB/)

# c# - C# 苦苦挣扎，从生成器中的 XML 读取

> ID：15853288
> 
> 赞同：0
> 
> 时间：2013-04-06T16:32:44.180
> 
> 标签：c#, xml, arrays, random

我放弃了在 Excel 中这样做，所以我制作了一个 XML 文件（名为“ideas.xml”），如下所示：

```
<ideas>
<verbs>
    <verb>Verb1</verb>
    <verb>Verb2</verb>
    <verb>Verb3</verb>
    <verb>Verb4</verb>
    <verb>Verb5</verb>

</verbs>
<adjectives>
    <adjective>Adjective1</adjective>
    <adjective>Adjective2</adjective>
    <adjective>Adjective3</adjective>
    <adjective>Adjective4</adjective>
    <adjective>Adjective5</adjective>
</adjectives>
<nouns>
    <noun>Noun1</noun>
    <noun>Noun2</noun>
    <noun>Noun3</noun>
    <noun>Noun4</noun>
    <noun>Noun5</noun>
</nouns>
</ideas> 
```

我正在尝试制作一个像这样打印出随机动词、形容词和名词的生成器。这是我正在努力解决的问题：

```
 public void button1_Click(object sender, EventArgs e)
    {

        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.Load("ideas.xml");

        Random r = new Random();
        XmlNodeList verbTag = xmlDoc.GetElementsByTagName("verb");
        XmlNodeList adjectiveTag = xmlDoc.GetElementsByTagName("adjective");
        XmlNodeList nounTag = xmlDoc.GetElementsByTagName("noun");

        textBox1.Text = ((verbTag[0].InnerText) + " " + (adjectiveTag[0].InnerText) + " " + (nounTag[0].InnerText)) + ".";
    } 
```

我正在尝试在输出中添加一个随机化器，但我似乎无法做到正确。此外，我打印出数组中的第一个值只是为了让它工作，任何关于如何在 0 和最后一个之间选择随机数的提示都会非常好。

非常感谢任何帮助、提示或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:43:46.807

使用您的`r`变量（即`Random`类实例）来生成索引，而不是`0`像代码中那样硬编码：

```
textBox1.Text = ((verbTag[r.Next(0, verbTag.Count - 1)].InnerText) + " " + (adjectiveTag[r.Next(0, adjectiveTag.Count - 1)].InnerText) + " " + (nounTag[r.Next(0, nounTag.Count - 1)].InnerText)) + "."; 
```

# javascript - 尝试通过 jQuery Isotope 使用 CSS 过渡时出现问题

> ID：15853290
> 
> 赞同：0
> 
> 时间：2013-04-06T16:32:46.633
> 
> 标签：javascript, jquery, css, jquery-isotope

我已经复制了同位素的流体/响应模式：http: [//isotope.metafizzy.co/demos/fluid-responsive.html](http://isotope.metafizzy.co/demos/fluid-responsive.html)，但添加了使用“过渡：宽度 0.3s”为单击元素的宽度设置动画。这确实有效，但是它禁用了我在“transitionend”上触发的“reLayout”动画。

我认为一个是压倒一切/与另一个冲突。有没有人有类似的问题或知道解决这个问题的方法？我试过设置'animationEngine：'jquery'，这确实解决了这个问题，但它看起来很糟糕 - 浏览器重新绘制问题！？

谢谢你的帮助！

这是一个现场演示......

[http://www.voyced.com/isotope-test/](http://www.voyced.com/isotope-test/)

如果您在开发人员工具中禁用 css 属性“transition: width 0.3s”，“reLayout”动画将再次起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:59:50.963

`$(window).resize()`为项目设置动画后发出 a 。

或者

```
$container.isotope('reLayout', function() {
   $(window).resize();
 }); 
```

# django - 在模板中使用 MPTT 做 get_children（在运行时）

> ID：15853291
> 
> 赞同：0
> 
> 时间：2013-04-06T16:32:49.497
> 
> 标签：django, django-mptt, mptt

我的模板接收一个名为 categories 的变量，我想列出其父类别的“儿子”类别

这是我在模板中的代码

```
{% for category,structure in categories|tree_info %}
    {% if structure.new_level %}
<li><a href="/categories/{{ category.id }}/">{{ category.name }}</a> </li>   
    {% endif %}

    {% for level in structure.closed_levels %}
<li>{{level.name}}
    {% endfor %}

    <ul class="noJS">
    {% for cat in category.get_children|tree_info %}
    <li><a href="/categories/{{ cat.id }}/">{{  cat.name }}aa</a> </li> 

    {% endfor %}
    </ul>
{% endfor %} 
```

这是模型

```
class Category(MPTTModel):
    name = models.CharField(max_length=50, unique=True)
    description = models.TextField(blank=True)
    parent = TreeForeignKey('self', null=True, blank=True, related_name='children')

    class MPTTMeta:
        order_insertion_by = ['name']

    def __unicode__(self):
        return self.name 
```

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:01:06.733

这有效

```
{% for category in categories %}
                <li>
                <a href="/categories/{{ category.id }}/">{{ category.name }}</a>  
                <ul class="noJS">
                    {% for cat in category.get_children %}              
                    <li><a href="/categories/{{ cat.id }}/">{{  cat.name }}</a> </li> 
                    {% endfor %}

                </ul>
            </li>
                {% endfor %} 
```

# ruby-on-rails-3 - simple_form 错误消息不会消失

> ID：15853294
> 
> 赞同：0
> 
> 时间：2013-04-06T16:33:19.323
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, validation, simple-form

我在 Rails 上使用 simple_form 和 twitter 引导程序。

一切都很好，除了在表单内联类中显示实时验证。我的表格代码是：

```
<%= simple_form_for @message, 
                    url: mailing_list_path,
                    html: { class: "form-inline" },
                    method: :post,
                    validate: true do |f| %>

    <%= f.input_field :email_address, label: false %>
    <%= f.submit "Submit" %>
<% end %> 
```

这会正确显示错误消息（例如“无效”），但如果我单击关闭输入然后再次打开，它会添加另一条消息（例如，它会说“无效是无效”）。例如，两个连续的无效条目，然后是一个空白条目将给出：

![错误没有被删除](https://i.stack.imgur.com/8B8V6.png)

有没有办法让 simple_form 在添加新错误消息之前删除现有的错误消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:47:04.950

**编辑：**

我使用一些 ghetto js 解决了这个问题，但仍然想知道我上面提到的功能是否是内置的。div 仍然存在，它们只是隐藏而不是全部显示在一起。通过表单验证将它们实际删除会很棒......

```
$('input.email-address-input').on 'keyup', () ->
    $(this).parent('form').siblings('.help-inline').hide() 
```

# vb.net - 更改文本框字体大小保持文本框大小（高度）

> ID：15853295
> 
> 赞同：1
> 
> 时间：2013-04-06T16:33:22.467
> 
> 标签：vb.net, visual-studio-2010

如何更改 TextBox 的字体大小但保持 TextBox 高度？

目前，每次我尝试更改字体大小时，TextBox 高度都会根据字体大小重新调整大小，我通过将 TextBox 更改为多行但只需要单行 Textbox 来让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:50:04.663

文本框控件有一个隐藏的 AutoSize 属性，可以禁用

```
textBox1.AutoSize = False
textBox1.Height = 50 
```

我添加到 foo_load 中，你最终会得到一个大框和小字体，并且由于文本框没有任何填充属性而看起来有点奇怪，但这可以通过在其后面放置一个面板并将文本框定位在里面来纠正。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T17:22:36.243

在 WinForms 中，您可以设置 TextBox 的`MinimumSize`和/或`MaximumSize`属性，以便在字体高度更改时覆盖 TextBox 高度的自动调整。

请注意，设置最小和最大大小不会立即更改 TextBox 大小。但是，当您在表单设计器中更改 TextBox 的宽度时，其高度将更改为在指定范围内。

# c# - 获取数组的所有组合（如果我将它们一一删除）

> ID：15853296
> 
> 赞同：0
> 
> 时间：2013-04-06T16:33:23.483
> 
> 标签：c#, .net, linq, theory

鉴于：

```
{1,2,3} 
```

预期结果：

```
{1,2,3},
{1,2},{1,3},{2,3},
{1},{2},{3} 
```

所以我基本上想要一个列表中的所有可能组合（但包括所有可能的组合 - 当每个元素都被删除时）。

我希望你明白我的意思；）

问题：哪种算法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:47:01.340

你想要[幂集](http://en.wikipedia.org/wiki/Power_set)算法。

[Rosetta Code](http://rosettacode.org/wiki/Power_set)上有一些示例。

# css - 在 Wordpress 页脚上安装更多小部件

> ID：15853297
> 
> 赞同：0
> 
> 时间：2013-04-06T16:33:26.693
> 
> 标签：css, wordpress, widget, footer, areas

我的主题显示我可以在页脚中放置多达 4 个小部件，如此处的演示站点所示： [http ://demo.woothemes.com/?name=simplicity](http://demo.woothemes.com/?name=simplicity)

但是当我想要 3 个时，我只能装 2 个。这是我的作业网站： [http ://www.brightpixelstudios.com/](http://www.brightpixelstudios.com/)

我猜我需要修改CSS。我真的很感激任何建议！

先感谢您，

将要

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T07:19:34.447

您可以使用“BNS 添加小部件”wordpress 插件将小部件区域添加到任何 wordpress 主题的页脚。

这是插件链接：[http ://buynowshop.com/plugins/bns-add-widget/](http://buynowshop.com/plugins/bns-add-widget/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:39:47.947

有可能，如果您查看输出，您会说：

```
<div id="footer-widgets" class="col-full col-2"> 
```

但是将输出更改为：

```
<div id="footer-widgets" class="col-full col-4"> 
```

将宽度分成 4 个部分。

如果没有看到网站的实际管理端，我就无能为力了，但如果`col-4`是动态设置的，那么它就是你必须在管理端更改主题的设置。

# php - 洗牌数组并插入数据库；在当前元素之前插入元素

> ID：15853299
> 
> 赞同：0
> 
> 时间：2013-04-06T16:33:39.403
> 
> 标签：php, phpmyadmin

每次我单击提交数组中的元素名称时，我都会在保存到数据库时对更改进行投票。在当前回显元素输入数据库后显示的元素，而不是我单击的那个元素。关于如何将数组中的元素单击保存到数据库中的任何建议？我似乎无法弄清楚。

我已经尝试使用`lists`并且`unshift`仍然得到相同的结果。

可以说，回显显示了表单中的值的 example2。我单击 example2 但 example1 保存在数据库中。我不知道如何解决这个问题。谢谢您的帮助。

这是我的代码：

我正在使用的阵列设置：

```
$array = array("example1","example2","example3");
shuffle($array);
foreach($array as $random);

<?php echo array_pop($random);?> 
```

HTML：

```
 <tbody>
         <tr>
                <form action="Voting_action.php" method="post">
            <td>
                <input type="submit" class="buttontable1" value="<?php echo $random ?>" name="name"/>
            </td>
                </form>
          </tr>
    </tbody> 
```

PHP：动作

```
$mysqli = new mysqli("", "", "", "");
if ($mysqli->connect_error) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_error . ") " . $mysqli->connect_error;
}
if (!$mysqli->query("INSERT INTO table(id, name, votes) VALUES (id, '".$random."', '".$votes."')")) {
    echo "Multi-INSERT failed: (" . $mysqli->errno . ") " . $mysqli->error;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:46:46.650

您的 html 表单使用 name="name" 发送您的随机密钥（这本身就令人困惑）。

`$_POST['name']`通过not访问该变量`$random`。

考虑到将来出现这样的问题，首先总是这样做

```
var_dump($_POST); 
```

在您的表单处理程序中，以查看可以使用哪些变量以及它们携带的值。

Ps 您在 db 查询中使用未过滤和未转义值的方式让您对 sql 注入攻击敞开大门，请查看 Mysqli 的准备好的语句来回避这个问题。

# vector - 增加元素宽度的 OCTAVE

> ID：15853300
> 
> 赞同：0
> 
> 时间：2013-04-06T16:33:41.293
> 
> 标签：vector, matrix, octave

我有一个问题（八度音阶）：假设我有 a = 1 2 3 4 5

我想在 a.. 中的每个元素中添加 'b' 字符。这样我就得到了类似的东西：a = 1b 2b 3b 4b 5b

我怎么做？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T13:28:59.507

为了能够做到这一点，`a`必须将其定义为字符串而不是双精度数组。可能有一个更优雅的解决方案，但以下工作：

```
a = num2str(1:5); % '1' is a(1), '2' is a(5), etc...
% a(2) to a(4) are white spaces
for k=2:4:18
    a(k) = 'b';
end 
```

# html - 搜索栏中的图标字体

> ID：15853303
> 
> 赞同：1
> 
> 时间：2013-04-06T16:33:50.363
> 
> 标签：html

如何在搜索栏中放置图标字体（搜索图标）？

这是我用于搜索栏的 html：

```
<input class="search-input" type="search" placeholder="Search"> 
```

这是搜索图标字体的 CSS：

```
.icon-search:before { content: ''; } /* '\1f50d' */ 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:38:17.513

由于`<input>`它是一个 void 元素（它不允许任何子元素），因此您不能在其上使用`:before`或`:after`。

您尝试做的最佳解决方案是执行以下操作之一：

```
<span class="search-input-icon">&#x1f50d;</span><input type="search" placeholder="Search" class="search-input" /> 
```

然后使用这个 CSS：

```
.search-input-button {
    position:absolute;
    margin-left:4px; /* adjust as needed */
}
.search-input {padding-left:16px;} 
```

* * *

或者，保留您的原始 HTML 并使用此 CSS：

```
.search-input {
    padding-left:16px;
    background-image:url('some_icon.png');
    background-position:0% 50%;
    background-repeat:no-repeat;
} 
```

# javascript - 遍历猫鼬查找结果

> ID：15853304
> 
> 赞同：7
> 
> 时间：2013-04-06T16:33:53.207
> 
> 标签：javascript, mongoose

我在从 mongoose 的查询结果中获取数据时遇到了一些麻烦：这是我的函数：

```
getNinjas : function(res){
    var twisted = function(res){
        return function(err, data){
            if (err){
                console.log('error occured');
                return;
            }
            res.send('My ninjas are:\n');
            for (var i;i<data.length;i++){
                console.log(data[i].name);
            }
                            //I need to process my data one by one here
        }
    }

    Ninja.find({},'name skill',twisted(res));
} 
```

所以如果我`console.log(data)`在 getNin​​jas 函数中，我会得到我的查询结果。如何逐条访问每条记录？我在控制台中什么都没有。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T16:52:05.763

你忘了初始化`i`：

```
for (var i = 0;i<data.length;i++){
//        ^^^^
  console.log(data[i].name);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-14T09:14:05.240

由于您询问如何逐一访问每条记录，因此最好`forEach`在您的武器库中拥有标准`for`循环以外的内容。一旦你通过了错误检查`if`：

```
data.forEach(function(record){
    console.log(record.name);
    // Do whatever processing you want
}); 
```

# c# - 将 SQL Server CE 数据库加载到内存中

> ID：15853307
> 
> 赞同：0
> 
> 时间：2013-04-06T16:33:56.657
> 
> 标签：c#, sql-server-ce

我有一个应用程序，我需要多次查询 SQL Server CE 数据库，通常是针对相同的数据。数据库有很多表，打算以后增加表的数量，所以没有修复。

这个过程非常慢，所以我需要一种将整个数据库转储到内存中并在那里执行查询的方法。查询都将非常简单（与从表 Y 中获取 id X 的记录相当）。

我正在考虑一个`DataTable`，但我有很多桌子，所以这不起作用。

我也在考虑使用 LINQ ，但是每个表都非常不同，我不想每次都手写一个新对象（并且`.dbml`文件不能与 SQL Server CE 一起使用——看图）。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:03:23.480

我最终解决它的方式如下。

我保留了一个将表名映射到数据表的字典。

每当我尝试访问 DataTable 时，我都会搜索该名称是否在字典中。

```
public static DataTable GetDataTable(string tableName)
    {
            lock (lockMe)

            {
                    if (!dictionary.Keys.Contains(tableName))
                    {
                        ReadTableIntoMemory(tableName);
                    }

                   return dictionary[tableName];
            }

    } 
```

如果它们不存在，我会懒惰地将整个表读入内存（使用 select * 和数据表）并将其添加到字典中。

该解决方案适用于我的情况，但作为通用解决方案可能过于具体。

# wpf - WPF ListBox - 检测滚动条向上/向下按钮单击

> ID：15853308
> 
> 赞同：0
> 
> 时间：2013-04-06T16:34:12.493
> 
> 标签：wpf, button, listbox, wpf-controls, scrollbar

我正在使用列表框来显示数值列表，其中选定的值被应用于对象并被保存。我有想法将列表框上的高度设置为足以显示单行。当然，这会导致出现垂直 scollbar，并且没有滚动体，这正是我想要的。

当我单击列表框滚动条上的向上/向下箭头时，它会将下一个项目正确滚动到视图中。但是，未选择该项目。我立即遇到了保存实际选定值而不是视图中的值的问题。这是因为它需要点击滚动条按钮后面的数字才能真正选择值，这不是很直观。

因此，在进行了一些智能搜索之后，我开始寻找通过单击列表框滚动条按钮来增加所选值的可能方法，但我找不到任何实际使用它们的东西。

我发现了描述单击滚动条主体时的操作的帖子，还有其他使用设计器添加的按钮来执行列表框上的索引更改的帖子。但是，由于列表框的高度较短，滚动条主体是不可见的，当我已经拥有这两个按钮并完成大部分工作时，添加更多按钮似乎很愚蠢。

我还发现了一篇描述类似内容的帖子，但使用了列表视图。但是，我不想此时必须将控件换成我认为应该在我当前使用的控件的某个位置可用的一个功能。

所以，我想我正在寻找一种方法来解决列表框控件上垂直滚动条按钮的单击事件处理程序。

任何帮助将不胜感激。（谢谢大家，还有 1000 件其他事情我不必在这里发帖解决！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:31:53.487

我听说过那个菲尔，还有你的权利。我正在替换数字上下。

我只是认为可能有一个可行的替代方案，因为该特定控件最初不是框架的一部分。我也得到了很多工作，非常喜欢结果，以及它抓住主题的方式。

由于该应用程序的核心将成为未来应用程序的起点，因此我想包含此功能并准备为它做一些工作。

我最终做的事情有点复杂，但它是值得的，但通过一个有用的辅助函数变得容易了。我需要在“视觉树”中搜索我的目标类型。从那里我能够访问足够的功能来完成。

首先：使用我在[这里](http://channel9.msdn.com/Forums/TechOff/261274-Accessing-WPF-Control-parts-from-code)找到的辅助函数（感谢 Bruno）我能够将它添加到我的 Loaded 事件中：

```
private Double currentVerticalOffset;
private void Page_Loaded_1(object sender, RoutedEventArgs e)
    {            
        ScrollViewer sv = Helpers.ViewHelpers.ListBoxHelper.FindVisualChild<ScrollViewer>(listbox);
        sv.ScrollChanged += HandleRankScrollChange;
        currentVerticalOffset = sv.VerticalOffset;
    } 
```

然后，我处理滚动更改事件：

```
private void HandleRankScrollChange(object sender, ScrollChangedEventArgs e)
    {
        ScrollViewer sv = Helpers.ViewHelpers.ListBoxHelper.FindVisualChild<ScrollViewer>(listbox);

        if (sv.VerticalOffset > currentVerticalOffset)
        {
            Helpers.ViewHelpers.ListBoxHelper.SelectNextItem(listbox);
        }

        if (sv.VerticalOffset < currentVerticalOffset)
        {
            Helpers.ViewHelpers.ListBoxHelper.SelectPreviousItem(listbox);
        }
        currentVerticalOffset = sv.VerticalOffset;
    } 
```

我在这里调用的助手非常简单，但同样，这将成为一个基础工具包，因此拥有这些方法可能会再次派上用场。

```
public static void SelectNextItem(ListBox lb)
    {
        if (lb.SelectedIndex < lb.Items.Count)
        {
            lb.SelectedIndex++;
        }
    }

    public static void SelectPreviousItem(ListBox lb)
    {
        if (lb.SelectedIndex > 0)
        {
            lb.SelectedIndex--;
        }
    } 
```

布鲁诺的辅助函数

```
public static childItem FindVisualChild<childItem>(DependencyObject obj) where childItem : DependencyObject
    {
        for (int i = 0; i < VisualTreeHelper.GetChildrenCount(obj); i++)
        {
            DependencyObject child = VisualTreeHelper.GetChild(obj, i);
            if (child != null && child is childItem)
            {
                return (childItem)child;
            }
            else
            {
                childItem childOfChild = FindVisualChild<childItem>(child);
                if (childOfChild != null)
                {
                    return childOfChild;
                }
            }
        }
        return null;
    } 
```

再次感谢。

# neo4j - java中嵌入neo4j的加权图

> ID：15853310
> 
> 赞同：0
> 
> 时间：2013-04-06T16:34:24.113
> 
> 标签：neo4j

我对 neo4j 中的加权图有疑问。是属性（如“.setProperty("cost", weight)"）构造加权图的唯一方法。问题是一个经常需要“（Double）rel.getProperty（”cost“）”权重的程序会变得太慢，因为演员需要一些时间；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T12:57:33.977

好吧，您实际上可以将权重编码为更快的关系类型，例如

```
create a-[:`KNOWS_0.34`]->b 
```

[以http://console.neo4j.org/r/2dez98](http://console.neo4j.org/r/2dez98)为例。

# django - 如何在 django-mptt 中更改节点的父级

> ID：15853313
> 
> 赞同：6
> 
> 时间：2013-04-06T16:34:44.833
> 
> 标签：django, python-2.7, django-mptt

我正在使用 django-mptt (Ver 5.5) django-mptt.github.io/django-mptt/

我有一个树结构：

```
+Object Oriented
|----Java
+Procedural
|----Python
|----PHP
|----B
|----C 
```

现在我想通过将父节点`Python`和`PHP`节点更改为来重构树，如下所示`Object Oriented`：

```
 +Object Oriented
|----Java
|----Python
|----PHP
+Procedural
|----B
|----C 
```

我已经通过将节点的父属性更改为

```
>>>oo=Nodes.objects.get(name='Object Oriented')
>>>py=Nodes.objects.get(name='Python')
>>>py.parent=oo 
```

这样做后，我得到：

```
>>>py.parent==oo
True
>>>py.get_ancestors(ascending=False, include_self=False)
[<Nodes : 'Procedural'>] 
```

即使是内置方法，例如：

```
py.move_to(oo,'first-child') 
```

似乎对我不起作用。

如果需要更多说明，我的模型是：

```
from django.db import models
from mptt.models import MPTTModel, TreeForeignKey

class Nodes(MPTTModel):
    name = models.CharField(max_length=50, unique=True)
    parent = TreeForeignKey('self', null=True, blank=True, related_name='children')

    def __unicode__(self):
        return self.name

    class MPTTMeta:
        order_insertion_by = ['name'] 
```

请告诉我改变父母的方法。

# php - 锂 PHP 路由不起作用

> ID：15853316
> 
> 赞同：0
> 
> 时间：2013-04-06T16:34:55.880
> 
> 标签：php, routes, lithium

我正在关注锂的快速入门指南：http: [//li3.me/docs/manual/quickstart](http://li3.me/docs/manual/quickstart)

我在 /var/www/my_app/app/models/Posts.php 中创建了我的帖子模型

```
<?php

namespace app\models;

class Posts extends \lithium\data\Model {
}

?> 
```

我在 /var/www/my_app/app/controllers/PostsController.php 中创建了我的帖子控制器

```
<?php

namespace app\controllers;

class PostsController extends \lithium\action\Controller {

    public function index() {
            return array('foo' => 'bar', 'title' => 'Posts');
    }
}

?> 
```

我在 /var/www/my_app/app/views/posts/index.html.php 中创建了我的视图

```
Lithium is less dense than <?=$foo;?>ium. 
```

然后快速入门指南说我应该能够通过转到查看我的帖子索引页面

```
http://localhost/my_app/posts 
```

但我得到一个

```
Not Found

The requested URL /my_app/posts was not found on this server. 
```

但是，如果我去

```
http://localhost/my_app 
```

将显示 Lithium 附带的默认主页。

所以我尝试通过将此行添加到我的 /var/www/my_app/config/routes.php 文件来解决问题：

```
Router::connect('/posts', 'Posts::index'); 
```

但我得到相同的 Not Found 错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T16:34:20.657

您需要确保在您的 Apache`mod_rewrite`中安装*并启用它。*

还要检查`.htaccess`文件是否存在并且`allow_override`是否为虚拟主机正确设置，否则`.htaccess`文件将被忽略。

有关更多信息，请查看文档中的[故障排除](http://lithify.me/docs/manual/getting-started/troubleshooting.wiki)部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:20:20.217

[在Routing 文档](http://lithify.me/docs/manual/handling-http-requests/routing.wiki)中稍微深入一点，对方法的参数进行了`Router::connect()`更全面的解释。后面的部分`::`应该是路由调用的动作的名称；在您的情况下`index`（或者可能没有，如果 indexAction 有默认设置；不熟悉锂）。`Action`您通过从控制器的方法名称中删除后缀来派生“名称” 。我建议更全面地探索路由文档，以免将来让自己头疼。

# floating-point - 对 FPU 舍入模式有弹性的 double-double 实现

> ID：15853317
> 
> 赞同：1
> 
> 时间：2013-04-06T16:35:10.817
> 
> 标签：floating-point, ieee-754, double-double-arithmetic

## 上下文：双双算术

“Double-double”是[数字表示为两个双精度数字之和，](http://en.wikipedia.org/wiki/Double-double_arithmetic#Double-double_arithmetic)有效数字没有重叠。这种表示利用现有的双精度硬件实现来进行“近四倍精度”计算。

double-double 实现中的一个典型的低级 C 函数可能需要两个双精度数`a`，`b`并`|a| ≥ |b|`计算`(s, e)`表示它们和的双精度数：

```
s = a + b;
e = b - (s - a); 
```

（改编自[这篇文章](http://web.mit.edu/tabbott/Public/quaddouble-debian/qd-2.3.4-old/docs/qd.pdf)。）

**这些实现通常采用舍入到最近的偶数模式。**

在上面的计算中，`(s, e)`是一个归一化的 double-double 只是因为这个假设。没有它，`a == 0x1.0p60`在`b == 1`向上舍入模式下，使用 ,`s`计算为`0x1.0000000000001p60`和`e`略高于`-0x0.0000000000001p60`。它们的和等于 的数学和，`a`但`b`它们的有效数字重叠。

Take和一方面 和 另一方面的`a == 0x1.0p120`数学和甚至不再重合。`a``b``s``e`

## 问题

有没有办法构建一个具有与典型双双库在舍入到最近偶数（即相对快速且相对准确）中具有相同属性的双双类库，但无论舍入如何都有效模式恰好是？

这样的图书馆是否已经存在？

## 更一般的上下文：正确舍入的基本函数

双双排序的实现用于正确舍入基本函数库的实现中的中间计算。结果，以这种方式实现的库[在 FPU 未处于舍入到最近偶数模式时调用函数时往往会失败](http://blog.frama-c.com/index.php?post/2011/09/14/Linux-and-floating-point:-nearly-there)。出于性能原因以及在函数执行时到达的信号会使 FPU 处于舍入到最近偶数模式，更改函数内部的舍入模式不是很可口。我认为拥有在任何舍入模式下工作的快速、正确舍入的基本函数的最简单方法是，如果可以以某种方式依赖于在任何舍入模式下工作的双双类型算术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T19:40:44.623

njuffa 提到的[文章](http://www-pequan.lip6.fr/~graillat/papers/IJRS.pdf)提供了以下功能，其符号与我的问题的符号非常相似，只是在我的问题`fl (a+b)`中简单地表示了那里的表示`a+b`：

```
Two−Sum−toward−zero2 (a, b)

if (|a| < |b|)
  swap (a , b)
s = fl (a + b)
d = fl (s − a)
e = fl (b − d)
if(|2 ∗ b|<|d|)
  s = a, e = b
return (s, e) 
```

当处于向零舍入模式时，对于这种特定的基本计算，这是一个非常巧妙的修复。它让人希望有可能实现正确舍入的基本函数，至少通过尽早测试舍入模式并选择单独的算法，或者通过编写适用于所有舍入模式的非常仔细的代码。

# javascript - 用鼠标位置改变不透明度

> ID：15853321
> 
> 赞同：2
> 
> 时间：2013-04-06T16:35:34.190
> 
> 标签：javascript, jquery, mouseevent, opacity

我正在尝试根据鼠标位置更改元素的不透明度（在本例中为 .png）。

我发现了这个很好的颜色示例：http: [//jsfiddle.net/WV8jX/](http://jsfiddle.net/WV8jX/)

```
var $win = $(window),
w = 0,h = 0,
rgb = [],
getWidth = function() {
    w = $win.width();
    h = $win.height();
};

$win.resize(getWidth).mousemove(function(e) {

rgb = [
    Math.round(e.pageX/w * 255),
    Math.round(e.pageY/h * 255),
    150
];

$(document.body).css('background','rgb('+rgb.join(',')+')'); }).resize(); 
```

但我很困惑如何使用不透明度来做到这一点。我想要同样流畅无缝的效果。

所有帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:40:37.607

这很简单：

[JSFiddle](http://jsfiddle.net/WV8jX/161/)

```
$(function(){
    var $win = $(window),
    w = 0,h = 0,
    opacity = 1,
    getWidth = function() {
        w = $win.width();
        h = $win.height();
    };

    $win.mousemove(function(e) {
        getWidth();
        opacity = (e.pageX/w * 0.5) + (e.pageY/h * 0.5);

        $('#myElement').css('opacity',opacity);

    });
}); 
```

我编辑了整个调整大小的东西，因为它对我来说没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:47:17.937

```
<div id="wrapper"><h1></h1></div> 
```

[http://jsfiddle.net/WV8jX/159/](http://jsfiddle.net/WV8jX/159/)

```
var $win = $(window),
    w = 0,
    h = 0,
    opacity = 0,
    getWidth = function() {
        w = $win.width();
        h = $win.height();
    };

$win.resize(getWidth).mousemove(function(e) {

    opacity = (e.pageX/w) * (e.pageY/h);
    $('h1').text(opacity);

    $('#wrapper').css('opacity',opacity);

}).resize(); 
```

# xcode - Sigabrt 错误 NSPredicate 出现在搜索栏中 xcode 4.5+

> ID：15853327
> 
> 赞同：1
> 
> 时间：2013-04-06T16:35:56.240
> 
> 标签：xcode, uisearchbar, nspredicate, sigabrt

大家好，我目前的搜索栏有问题。当我运行项目时，搜索栏出现并且一切正常，但是当我在搜索栏中实际输入时，它会在此处返回一个 sigabrt 错误：

```
int main(int argc, char *argv[])
{
@autoreleasepool {
    return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
}
} 
```

这是我的 viewcontroller.h：

```
@interface CollegeViewController : UIViewController  <UITableViewDataSource, UITableViewDelegate,ADBannerViewDelegate>
{
IBOutlet UITabBar *tabBar1;
}
@property (nonatomic, strong) IBOutlet UITableView *tableView;
@property(nonatomic, retain) UITabBar *tabBar1;

@end 
```

这是我的viewcontroller.m：

```
@interface CollegeViewController ()

@end

@implementation CollegeViewController {
NSArray *colleges;
NSArray *searchResults;

}
- (void)viewDidLoad
{

[self.tableView setSeparatorStyle:UITableViewCellSeparatorStyleNone];
self.parentViewController.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"common_bg.png"]];
self.tableView.backgroundColor = [UIColor clearColor];
UIEdgeInsets inset = UIEdgeInsetsMake(5, 0, 0, 0);
self.tableView.contentInset = inset;
[super viewDidLoad];
self.navigationItem.title = @"List of Colleges";
UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStyleBordered target:nil action:nil];
[[self navigationItem] setBackBarButtonItem:backButton];

// Do any additional setup after loading the view.
College *college1 = [College new];
college1.name = @"Harvard University";
college1.collegeName = @"Harvard University";
college1.rank = @"#1";
college1.imageFile = @"01.jpg";
college1.sizeofCollegeCampus = @"210 acres";
college1.tuition = @"$38,480";
college1.numberofStudents = @"27,392";
college1.address = @"Massachusetts Hall, Cambridge, MA 02138";
college1.acceptanceRate = @"5.9%";
college1.phoneNumber = @"(617) 495-1000";
college1.majorPrograms = @"Economics, Political Science and Government, Psychology,  English Language and Literature/Letters, and Social Sciences";
college1.website = @"www.harvard.edu/";
college1.isitIvyLeague = @"Yes";
college1.mascot = @"John Harvard";
college1.color = @"crimson";
college1.satScore = @"";
college1.actScore = @"";
college1.collegeNameCell = @"Harvard University";
college1.collegeRankCell = @"#1";
college1.collegePhotoCell = @"Harvard_Wreath_Logo_1.svg.png";

..............

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

-(void)bannerViewDidLoadAd:(ADBannerView *)banner {
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[banner setAlpha:1];
[UIView commitAnimations];

}

- (void)bannerView:(ADBannerView *)
banner didFailToReceiveAdWithError:(NSError *)error
{
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[banner setAlpha:0];
[UIView commitAnimations];
}

- (void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope
{
NSPredicate *resultPredicate = [NSPredicate
                                predicateWithFormat:@"SELF contains[cd] %@",
                                searchText];

searchResults = [colleges filteredArrayUsingPredicate:resultPredicate];
}

-(BOOL)searchDisplayController:(UISearchDisplayController *)controller
shouldReloadTableForSearchString:(NSString *)searchString
{
[self filterContentForSearchText:searchString
                           scope:[[self.searchDisplayController.searchBar scopeButtonTitles]
                                  objectAtIndex:[self.searchDisplayController.searchBar
                                                 selectedScopeButtonIndex]]];

return YES;
}

- (BOOL)shouldAutorotateToInterfaceOrientation (UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
if (tableView == self.searchDisplayController.searchResultsTableView) {
    return [searchResults count];

} else {
    return [colleges count];

}
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (UIImage *)cellBackgroundForRowAtIndexPath:(NSIndexPath *)indexPath
{
NSInteger rowCount = [self tableView:[self tableView] numberOfRowsInSection:0];
NSInteger rowIndex = indexPath.row;
UIImage *background = nil;

if (rowIndex == 0) {
    background = [UIImage imageNamed:@"cell_top.png"];
} else if (rowIndex == rowCount - 1) {
    background = [UIImage imageNamed:@"cell_bottom.png"];
} else {
    background = [UIImage imageNamed:@"cell_middle.png"];
}

return background;
}   

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath (NSIndexPath *)indexPath
{
static NSString *simpleTableIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

// Configure the cell...
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];

}

    College *college = [colleges objectAtIndex:indexPath.row];
    UIImageView *collegeImageView = (UIImageView *)[cell viewWithTag:100];
    collegeImageView.image = [UIImage imageNamed:college.collegePhotoCell];

    UILabel *CollegeNameLabel = (UILabel *)[cell viewWithTag:101];
    CollegeNameLabel.text = college.collegeNameCell;

    UILabel *CollegeRankLabel = (UILabel *)[cell viewWithTag:102];
    CollegeRankLabel.text = college.collegeRankCell;

    if (tableView == self.searchDisplayController.searchResultsTableView) {
        College *college = [colleges objectAtIndex:indexPath.row];
        UIImageView *collegeImageView = (UIImageView *)[cell viewWithTag:100];
        collegeImageView.image = [UIImage imageNamed:college.collegePhotoCell];

        UILabel *CollegeNameLabel = (UILabel *)[cell viewWithTag:101];
        CollegeNameLabel.text = college.collegeNameCell;

        UILabel *CollegeRankLabel = (UILabel *)[cell viewWithTag:102];
        CollegeRankLabel.text = college.collegeRankCell;
    } else {

        College *college = [colleges objectAtIndex:indexPath.row];
        UIImageView *collegeImageView = (UIImageView *)[cell viewWithTag:100];
        collegeImageView.image = [UIImage imageNamed:college.collegePhotoCell];

        UILabel *CollegeNameLabel = (UILabel *)[cell viewWithTag:101];
        CollegeNameLabel.text = college.collegeNameCell;

        UILabel *CollegeRankLabel = (UILabel *)[cell viewWithTag:102];
        CollegeRankLabel.text = college.collegeRankCell;

    }

    // Assign our own background image for the cell
    UIImage *background = [self cellBackgroundForRowAtIndexPath:indexPath];

    UIImageView *cellBackgroundView = [[UIImageView alloc] initWithImage:background];
    cellBackgroundView.image = background;
    cell.backgroundView = cellBackgroundView;

// Display college in the table cell

return cell;
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
if ([segue.identifier isEqualToString:@"showCollegeDetail"]) {
    CollegeDetailViewController *destViewController = segue.destinationViewController;
    NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
        indexPath = [self.tableView indexPathForSelectedRow];
        destViewController.college = [colleges objectAtIndex:indexPath.row];
        destViewController.hidesBottomBarWhenPushed = YES;
    }

}

@end 
```

有什么建议么？

# actionscript-3 - 使用 Flashpunk 在 Actionscript 3 中进行俄罗斯方块式碰撞检测

> ID：15853333
> 
> 赞同：0
> 
> 时间：2013-04-06T16:36:31.073
> 
> 标签：actionscript-3, flash, actionscript, tetris

我正在使用 flashpunk 库在 Actionscript 3 中创建俄罗斯方块风格的游戏。除了一些我无法弄清楚的碰撞检测之外，我一切正常。当积木掉落时，它们不会堆叠在一起。有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:18:18.987

使用矩阵来描述游戏逻辑。

检查：[http ://wonderfl.net/search?q=tetris](http://wonderfl.net/search?q=tetris)

这里有很多代码示例

# ruby-on-rails - rails：为模型创建脚手架以从超类继承？

> ID：15853334
> 
> 赞同：6
> 
> 时间：2013-04-06T16:36:40.060
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, model, scaffolding

我是 Rails 的新手，我的脚还是湿的，所以如果这是微不足道的或“错误的方式”做事，请原谅我。

我想为一些脚手架模型创建一个超类。例如，我想为`Men`和 for创建一个脚手架`Women`，但我希望它们都继承自`People`超类；`Men`并且会从类`Women`继承像`height`和类的字段。`weight``People`

我在哪里/如何定义这个`People`超类？如何定义子类`Men`和`Women`通过脚手架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-06-20T03:04:17.700

通常我会做类似的事情：

```
rails g scaffold People type:string name:string birth:date height:integer

class People < ActiveRecord::Base
end 
```

重要的是使用保留字'type'！那是表格将保留该类的类型的地方。运行迁移。

因此，对于您可以执行的子类：

```
rails g scaffold Men --parent=People 
```

结果男子：

```
class Men < People
end 
```

女性也一样：

```
rails g scaffold Women --parent=People 
```

结果

```
class Women < People
end 
```

不会为子类生成迁移。我不确定，但这种方法只适用于 STI。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T16:41:11.430

这是我考虑过用我的应用程序做的事情。我还没有这样做，如果您是 Rails 新手，我不会推荐它。我要么完全制作单独的模型，要么制作一个模型，并拥有属性`gender`，它应该是 0 或 1，然后制作一个返回相应性别的字符串的方法。

**编辑**

所以我打开了rails控制台，从我所见，完全有可能，你需要做的就是声明类，如果你想使用不同的表，`set_table_name`

```
class This < That
  set_table_name :this
end

class There < This
   set_table_name :there
end 
```

或者你可以使用一张桌子，但如果你想保持干燥，我会使用两张。

如果你想使用脚手架生成器，你必须`rails g scaffold Men`为每个你想要查看的类（男性和女性）运行典型的。它生成的模型继承自`ActiveRecord::Base`该类。继承标记是小于号 ( `<`)。

```
# THESE WILL BE THE DEFAULT GENERATED MODELS
class Men < ActiveRecord::Base

end

class Women < ActiveRecord::Base

end 
```

然后您将手动创建超类`User`

```
class User < ActiveRecord::Base

end 
```

然后编辑要继承的`Men`和模型`Women``User`

```
# men.rb
class Men < User
end

# women.rb
class Women < User
end 
```

假设您想使用一个表进行子类化，您可以正确迁移该表，然后将其添加`attr_accessible`到适当的子类中。

`attr_accessible`是 Rails 的安全功能。它确定可以在批量分配中设置哪些属性。任何与安全、站点排名等相关的内容都不应被访问。

例子：

```
attr_accessible :favorite_food, :interests, :password, :email # THIS IS GOOD

attr_accessible :admin, :has_access_to_missile_launch_codes # THIS IS BAD 
```

因为那样的话有人可能会破坏你的安全系统通过

`params => { :man => { :admin => true }}`

要点是使用这些`attr_accessible`将确定哪种类型的用户可以设置什么。显然，您可以通过将共享功能放在超类中来解决这个问题。希望这可以帮助

您还应该阅读有关`super`关键字和`self`关键字的信息。如果您运行继承的设置，您最终会想要使用这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:46:37.600

AFAIK 你需要调整现有的脚手架模板，我不相信有办法指定控制器基类。也就是说，我认为在 Rails 3 中，您可以将模板复制到`$ROOT/lib/templates/rails/...`您`...`想要更改的位置。

也就是说，在脚手架中执行此操作的真正目标是什么？一般来说，模型将 (a) 很少是子类，并且 (b) 更罕见的是*同一*个子类。

只需手动编辑它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T18:13:57.717

观看有关单表继承的截屏视频。

[http://railscasts.com/episodes/394-sti-and-polymorphic-associations](http://railscasts.com/episodes/394-sti-and-polymorphic-associations)

* * *

[单表继承以及在 Rails 中的使用位置](https://stackoverflow.com/questions/555668/single-table-inheritance-and-where-to-use-it-in-rails)

# flash - 在 Flash cs6 中插入影片剪辑后，AS3 立即进入下一帧

> ID：15853346
> 
> 赞同：0
> 
> 时间：2013-04-06T16:38:02.740
> 
> 标签：flash, flash-cs6, actionscript-3

我在某个帧添加了一个影片剪辑，但我发现了一个问题，即在测试场景后，影片剪辑结束后无法继续到下一帧。除了将 stop() 和 gotoAndPlay (FRAME NUMBER) 放入影片剪辑之外，如何处理动作脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T03:08:38.953

您可以在主时间轴上停止，以便它一直播放您的影片剪辑，然后在该影片剪辑结束时告诉它转到下一帧。

```
parent.nextFrame(); 
```

# java - Java模式匹配正则表达式

> ID：15853350
> 
> 赞同：0
> 
> 时间：2013-04-06T16:38:21.373
> 
> 标签：java, regex, pattern-matching

我正在做一个模式匹配 matcher.matches 是假的，而 matcher.replaceAll 实际上找到了模式并替换它。matcher.group(1) 也返回异常。

```
@Test
public void testname() throws Exception {
    Pattern p = Pattern.compile("<DOCUMENT>(.*)</DOCUMENT>");
    Matcher m = p.matcher("<RESPONSE><DOCUMENT>SDFS878SDF87DSF</DOCUMENT></RESPONSE>");
    System.out.println("Why is this false=" + m.matches());
    String s = m.replaceAll("HEY");
    System.out.println("But replaceAll found it="+s);

} 
```

我需要 matcher.matches() 返回 true，并且 matcher.group(1) 返回 "<DOCUMENT>SDFS878SDF87DSF</DOCUMENT>"

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:40:29.303

```
final Pattern pattern = Pattern.compile("<DOCUMENT>(.+?)</DOCUMENT>");
final Matcher matcher = pattern.matcher("<RESPONSE><DOCUMENT>SDFS878SDF87DSF</DOCUMENT></RESPONSE>");
if (matcher.find())
{
    System.out.println(matcher.group(1));
    // code to replace and inject new value between the <DOCUMENT> tags
} 
```

# c++ - 将 intptr_t 传递给需要 int 的函数是否安全？

> ID：15853353
> 
> 赞同：6
> 
> 时间：2013-04-06T16:38:26.553
> 
> 标签：c++, c, callback, function-pointers

更具体地说，如果我有以下函数指针类型：

```
typedef void (*callback_type) (intptr_t context, void* buffer, size_t count); 
```

我可以安全且没有“未定义的行为”吗：

```
callback_type func_ptr = (callback_type)write;
intptr_t context = fd;

func_ptr(context, some_buffer, buffer_size); 
```

?

`write()`系统调用在哪里（编辑：具有签名`ssize_t write(int fd, const void *buf, size_t count);`，因此将 a`int`作为第一个参数），并且`fd`是`int`文件描述符。我假设 C 和 C++ 的答案是相同的，所以我标记了两者。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T16:46:09.180

### 不

这不会是可移植的，因为您传递的参数在常见的 LP64 范例中将具有不同的大小。

此外，您没有取消引用具有正确类型的函数指针，其结果*是*未定义的。

现在，正如您似乎已经得出的结论，函数指针将按预期工作，唯一的实际问题将是：*write(2) 将如何解释第`intptr_t`一个参数？*

实际的运行时问题是，在 LP64 上，您将 64 位值传递给 32 位参数。这可能会使后续参数错位。在具有寄存器参数的系统上，它可能工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T16:57:14.100

让我们看一下C标准。

> ### C11 (n1570)，第 6.3.2.3 节指针
> 
> 指向一种类型的函数的指针可以转换为指向另一种类型的函数的指针，然后再返回；结果应与原始指针比较。如果转换后的指针用于调用类型与引用类型不兼容的函数，则行为未定义。
> 
> ### C11 (n1570), § 6.7.6.3 函数声明符（包括原型）
> 
> 对于要兼容的两种函数类型，两者都应指定兼容的返回类型。此外，参数类型列表（如果两者都存在）在参数数量和省略号终止符的使用方面应一致；相应的参数应具有兼容的类型。
> 
> ### C11 (n1570), § 6.2.7 兼容型和复合型
> 
> 如果它们的类型相同，则两种类型具有兼容的类型。

结论：

```
void (*) (intptr_t context, void* buffer, size_t count); 
```

不能转换为：

```
void (*) (int context, void* buffer, size_t count); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T16:42:46.240

问题不在于在函数之间来回传递参数，因为已经完成了从一种整数类型到另一种的自动提升。

问题是，如果`intptr_t`比 短怎么办`int`，因此不是每个值`int`都可以用一个来表示`intptr_t`？在这种情况下，在转换为 时， 中的一些最高位`int`将被截断`intptr_t`，因此您最终会`write()`得到一个无效的文件描述符。尽管这不应该调用未定义的行为，但它仍然是错误的。

# sql - 如何插入每两个后续行的减法并将其插入新列

> ID：15853354
> 
> 赞同：0
> 
> 时间：2013-04-06T16:38:31.603
> 
> 标签：sql, sql-server, tsql

我有一个关于在 sql 中编写查询的问题。

在图片 1 中，我想从 row1 中减去第 2 行（在列日期中），并将其结果插入到标题为 Recency 的新列的第 1 行中。并再次从 row2 中减去 row3 并将其插入新列的 row2 中，依此类推。

[图片1](http://www.8pic.ir/images/14490285632526381013.jpg)：

![在此处输入图像描述](https://i.stack.imgur.com/fJHLv.jpg)

事实上，我想计算每个用户活动的新近度。例如在下图中，我为一个用户计算了这个（手动）；我想通过在 sql 中编写查询来为所有用户执行此操作。

[图二](http://www.8pic.ir/images/38478033832080790150.jpg)：

![在此处输入图像描述](https://i.stack.imgur.com/JwsLf.jpg)

..................................................... …………………………………………………………………………………………………………………………………………

和其他问题：

我还想计算当前日期之前每个用户的活动频率。我想计算每一行的频率。例如对于这个例子，对于用户 abkqz，我们有：

```
user name     frequency
abkqz             4
abkqz             3
abkqz             2
abkqz             1
abkqz             0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:54:46.707

假设如下表结构

```
CREATE TABLE [15853354] -- Stack Overflow question number
(
    [user-name] VARCHAR(20),
    [submissions] INT,
    [date] DATE,
    [score] NUMERIC(9,2),
    [points] NUMERIC(9,1)
)

INSERT [15853354]
VALUES
    ('abkqz', 5, '12 JUL 2010', 83.91, 112.5),
    ('abkqz', 5, '9 JUN 2010', 77.27, 0),
    ('abkqz', 5, '17 MAY 2010', 91.87, 315) 
```

然后您可以编写以下查询

```
;WITH [cte15853354] AS
(
    SELECT 
        [user-name],
        [submissions],
        [date],
        [score],
        [points],
        ROW_NUMBER() OVER (ORDER BY [user-name], [date] DESC) AS [ROWNUMBER]
    FROM [15853354]
)
SELECT 
    t.[user-name],
    t.[submissions],
    DATEDIFF(DAY, ISNULL([t-1].[date],t.[date]),t.[date]) AS [recency],
    t.[score],
    t.[points]
FROM [cte15853354] t
LEFT JOIN [cte15853354] [t-1]
    ON [t-1].[user-name] = t.[user-name]
    AND [t-1].[ROWNUMBER] = t.[ROWNUMBER] + 1 
```

这使用[公用表表达式](http://msdn.microsoft.com/en-us/library/ms190766.aspx)来计算[行号](http://msdn.microsoft.com/en-GB/library/ms186734.aspx)，然后进行自连接以将每一行与下一行连接起来，然后以天为单位计算日期差。

这是结果：

![在此处输入图像描述](https://i.stack.imgur.com/3hfwO.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:59:26.167

尝试这样的事情（未经测试，因为示例数据仅发布在图片中）。SQL Server 2012 中引入的查询用户分析功能选项，因此这不适用于早期版本。

```
select
  [user-name],
  submissions,
  score,
  datediff(day,
    lag([date],1) over (
      partition by [user-name]
      order by [date],
    [date]) as recency,
  count(*) over (
    partition by [user-name]
    order by [date] desc) -1 as frequency
from yourTable; 
```

# ruby - 如何使用 rspec 测试 ruby eval()？

> ID：15853355
> 
> 赞同：2
> 
> 时间：2013-04-06T16:38:45.063
> 
> 标签：ruby, rspec, sandbox

我正在创建一个 ruby​​ 沙盒环境。我正在使用 eval() 来评估代码并使用 ruby​​cop gem 来确保安全。如何使用 rspec 测试代码的输出。例如，用户键入代码，我对其进行评估。如何针对 rspec 测试运行结果？

例如，我要求用户创建一个 add 方法，一旦我得到输出运行 eval(code) 就可以了。我写了一个 rspec 测试。

```
describe "#add" do 
  it "should equal the sum of two numbers" do 
    add(2, 3).should eq 5
  end
end 
```

我如何运行此代码并在后端获取结果。

# jquery - 我的图像一直是垂直的，而不是水平的

> ID：15853360
> 
> 赞同：0
> 
> 时间：2013-04-06T16:39:18.617
> 
> 标签：jquery, css, image

我的图像似乎一直是垂直的，而不是我想要的水平。 [http://jsfiddle.net/MrPsau/3eCKJ/](http://jsfiddle.net/MrPsau/3eCKJ/) `Here's a fiddle.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:58:23.537

摆脱`width`上`#tabLeft`。然后你的图像将倾向于内联，但如果它们太大，它们仍然会中断到下一行：

[http://jsfiddle.net/3eCKJ/1/](http://jsfiddle.net/3eCKJ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:07:22.503

为您的 #tabs 类添加硬宽度：

```
#tabs {
    width: 910px; 
```

[http://jsfiddle.net/iGanja/3eCKJ/2/](http://jsfiddle.net/iGanja/3eCKJ/2/)

或添加 nowrap

```
#tabs {
    white-space: nowrap; 
```

[http://jsfiddle.net/iGanja/3eCKJ/3/](http://jsfiddle.net/iGanja/3eCKJ/3/)

# merge - 在 MERGE 和 SET 之间进行选择以在 SAS 中组合数据

> ID：15853362
> 
> 赞同：0
> 
> 时间：2013-04-06T16:39:33.097
> 
> 标签：merge, set, sas

我有一个关于方法论的一般性问题。我如何知道匹配合并 (MERGE) 或交错 (SET) 是否更适合组合数据集？如果我有两个相关的数据集，它们似乎包含许多相同的变量（但不是全部），但我不知道所述变量中的信息是否相同，哪个更好？

是否有某种决定哪个更好的一般规则？

谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:50:20.167

这个问题真的没有很好的答案；“合并”和“交错”之间存在根本区别。花几分钟时间阅读 SAS 概念手册中的示例，[尤其是此处](http://support.sas.com/documentation/cdl/en/lrcon/65287/HTML/default/viewer.htm#p15jvywi5avt3cn1bee8r6c33ux1.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:49:49.057

我认为这是一个非常特定于您的数据以及您想要实现的目标的问题。在您对数据有足够的了解以知道您是否可以组合它们（设置）或想要匹配合并它们之前，您根本不应该组合数据集。不可能有一般规则，因为它仅取决于您的数据 - 如果我有两个数据集

```
data have_1;
input x y;
datalines;
1 2
2 3
3 4
;;;;
run;

data have_2;
input x y z;
datalines;
1 2 3
2 3 4
3 4 5 
;;;;
run; 
```

你可以猜到 have_1 和 have_2 是相同的观察值，只是多了一个变量 z；但它们也很容易成为不同的观察结果。如果我告诉您“x”是唯一标识符，那么您会怀疑这些是相同的记录；但如果我告诉你“x”和“y”是定性特征，那么它们很可能是不同的观察结果，而这些观察结果恰好在定性上相似。

这里的重点：在对数据进行任何操作之前了解您的数据。如果您不知道您的数据，那么您一开始就不应该使用它。

# git - 同一文件夹中的多个存储库

> ID：15853363
> 
> 赞同：0
> 
> 时间：2013-04-06T16:39:34.613
> 
> 标签：git, version-control, github, repository, bitbucket

我在 github 上检查了一些东西，我可以将整个文件夹提交到 bitbucket 并能够从 github 和 bitbucket 拉取和推送吗？以及在存储库之间有多个不同的分支？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:59:56.450

在 bitbucket 上创建目标 repo，然后：

```
git remote add bitbucket <bitbucket-url> 
```

请注意，上面的 'bitbucket' 只是一个任意名称 - 如果您愿意，可以使用 'bb' 或 foo'。

如果您打算同时使用这两个存储库，我还将您的“来源”重命名为提醒您真实来源的名称（例如“github”）：

```
git remote rename origin github 
```

检查一切：

```
git remote -v show

git remote show github

git remote show bitbucket 
```

[阅读手册页以查看git push](https://www.kernel.org/pub/software/scm/git/docs/git-push.html)的较长形式（以及 fetch、pull 等其他命令）以了解如何将特定分支推送到特定 repos，例如

```
git push bitbucket master

git push -u bitbucket master 
```

我还会阅读[git 配置](https://www.kernel.org/pub/software/scm/git/docs/git-config.html)文件的`remote`和`branch`部分。

使用多个 repos 是一种“高级” git - 特别是如果你想在每个 repos 上都有不同的分支。很容易意外地将一个分支（或您打算保密的一组更改）推送到错误的存储库，特别是如果您是 git 新手。我不知道这样做对您的情况有多大的负面影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T03:17:31.910

请注意，BertF 的答案为同一本地存储库中的单独远程存储库创建了多个*分支。*您可能需要的是单独的*存储库*，每个遥控器一个。混合不同的开发线并不是一个好主意，而且由于 git 非常轻量级，拥有单独的存储库（可能在一个目录中以将它们保持在附近）更容易处理，并且不会使用更多资源。

# javascript - 页面“刷新”后的 2 个计时器

> ID：15853364
> 
> 赞同：0
> 
> 时间：2013-04-06T16:39:37.947
> 
> 标签：javascript, jquery, jquery-mobile

使用 setInterval 做一些动作。提交表单（jQuery mobile）后，页面会刷新，但副作用是现在有 2 个计时器处于活动状态。为什么第一个计时器在提交后没有结束和/或如何防止启动第二个计时器？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:45:39.990

可能是因为表单是使用 ajax 提交的，并且 setInterval javascript 会以某种方式重新执行。

尝试使用

```
window.timer = window.timer || setInterval(....); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:45:52.197

setInterval 返回一个整数（比如说你的计时器的“id”）。
知道这一点，您可以通过存储此 ID 轻松地：
- 在启动第二个计时器之前停止您的第一个计时器（函数 stopInterval(id)）
- 防止它第二次启动

# android - Android 的 JDBC 与 Web 服务

> ID：15853367
> 
> 赞同：29
> 
> 时间：2013-04-06T16:40:01.413
> 
> 标签：android, mysql, web-services, postgresql, jdbc

有人可以回答我的困境，使用哪种方法将**Android**设备连接到 mySQL 或 Postgresql？

我可以通过两种方式做到这一点，没有任何错误和问题，没有明显的区别，但每个人都推荐使用 Web 服务而不是使用 jdbc 驱动程序和直接连接，

有人可以用一些事实解释为什么吗？

**编辑：**我没有提到它更简单，并且需要更少的时间来完成 jdbc。那么，为什么是 Web 服务，或者为什么不呢？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-06T16:58:01.737

您*认为*使用 JDBC 更简单、更快捷，因为您没有考虑手机和便携式设备的真实操作环境。他们经常通过错误的流量重写代理和疯狂的防火墙来实现脆弱的连接。他们通常使用网络传输层，该层具有高且可变的丢包率和延迟，在短时间内变化多个数量级。TCP 在这种环境中确实不是很好，尤其是与长期连接的斗争。

Web 服务的主要优势在于：

*   具有最小状态的短时连接，因此当设备切换 WiFi 网络、与蜂窝网络、短暂失去连接等时，很容易回到您所在的位置；和

*   可以通过除最可怕和最严苛的网络代理之外的所有网络代理

您*经常会*遇到直接 JDBC 连接的问题。一个挑战是可靠地使死连接超时，重新建立会话并释放旧会话持有的锁（因为服务器可能不会在客户端决定它死的同时）。另一个是数据包丢失导致操作非常缓慢、长时间运行的数据库事务，以及随之而来的锁定持续时间和事务清理任务的问题。您还将在阳光下遇到各种疯狂和损坏的代理和防火墙 - 支持的代理`CONNECT`但后来假设所有流量都是 HTTP，如果不是，则将其破坏；带有错误状态连接跟踪的防火墙，导致连接失败或进入半开僵尸状态；你能想象到的每一个 NAT 问题；运营商“有用地”生成 TCP ACK 以减少延迟，更不用说丢包发现和窗口大小导致的问题；古怪的端口阻塞；等等

因为*每个人都*使用 HTTP，所以您可以期望它能够工作——至少，比其他任何事情都更频繁。现在尤其如此，即使在移动 Web 应用程序中，普通网站也使用 REST+JSON 通信方式。

您还可以使用唯一的请求令牌将您的 Web 服务调用编写为*幂等的。*这使您的应用程序可以重新发送修改请求，而不必担心它会对数据库执行两次操作。请参阅[幂等](http://en.wikipedia.org/wiki/Idempotence)性和[定义幂等性](https://stackoverflow.com/questions/8505889/defining-idempotence)。

说真的，来自移动设备的 JDBC 现在看起来可能是个好主意——但我什至会考虑的唯一方法是，如果移动设备都在我直接控制的单个高可靠 WiFi 网络上。即使这样，如果可能的话，出于数据库性能管理的原因，我也会避免使用它。您可以使用 PgBouncer 之类的东西在服务器端的许多设备之间建立连接池，因此连接池不是一个大问题，但是清理丢失和放弃的连接是，使其工作所需的 tcp keepalive 流量和长期停滞不前来自废弃连接的交易。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-06T17:00:09.247

我能想到几个原因

1.  **为您的数据库提供 JDBC android 驱动程序支持**。
2.  跨各种 Android 设备的连接**池**使得监控和限制它们变得困难。
3.  从 DB 发送到 android 的结果集会消耗大量**带宽**和**电池**电量。
4.  **代理**通常允许 HTTP 访问您的设备。
5.  将数据库直接暴露给客户端具有**安全**隐患。

Web 服务可以在 JDBC 连接之上提供附加功能，例如**身份验证**/服务**质量**/**授权**/**条件 GET**请求/**错误**处理等。JDBC 不能做任何这些。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-06T17:00:07.410

除了 Craig Ringer 所说的（我完全同意）之外，JDBC 还有另一个问题：它会迫使您的数据库向世界公开。如果您希望 android 设备访问它，您需要为您的应用程序提供数据库凭据，并且数据库必须具有公共访问权限。

使用 WebService 或 RESTful API 显然是确保应用程序安全的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-12T00:53:13.717

另一种选择是使用像 SymmetricDS 这样的数据库同步工具。

这会让你在你的服务器上说一个 Postgres 数据库，在你的平板电脑上说一个 SQLite 数据库。

当连接可用时，SymmetricDS 将通过 HTTP 同步数据库。当然，您不必同步整个数据库，只需同步相关部分即可。

（我不隶属于 SymmetricDS）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-10-20T09:05:04.800

TL; DR：**这取决于！** （对不起所有“从来没有做过，直接的骗子总是邪恶的”-开发者）

在为 Playstore 之类的东西创建公共领域/通用应用程序时，我主要与我的响应者同行。向“所有人”开放您的数据库（尤其是当权限配置错误或根本没有配置时）通常不是一个好主意！

但是（！），故事可能完全不同，例如，当您在**公司的网络边界**内创建一些供内部使用的东西时，例如用于物流、库存等的 Android 手持设备。在这些情况下，我什至大部分时间肯定会建议使用 JDBC 或类似的直接连接。原因是：

*   少一个故障点
*   少一个开发（子）项目
*   少了一件需要维护和更新数据结构的事情
*   少一件事要保持和运行，CI/CD，测试等（你得到草稿）

这 - 我的拙见 - 比连接池、重新建立等（**如果**它真的变得有必要，请小心那里的过早优化）的（实施一次）工作更糟糕。

但是对于公共项目......好吧，如果它们只需要读取访问权限，我也可以想象它，或者如果您只允许添加某些表，但不允许删除或修改。您可以应用一些技巧来使其仍然安全（允许添加但不允许使用特定表的 id-secrets 读取、触发器和其他表的一般读取等），但还有很多需要考虑和很多想念这些。所以一般来说，我会说让你的公共域客户端获取你的 SQL 连接是**不好的做法。**但是，不要让这妨碍您问自己（并理解）“为什么”并查看具体情况。甚至可能有很好的理由/用途。特别是因为它“少”，这通常也更好。这肯定取决于。

请注意并注意（即使权限设置正确）**很多都可能被滥用**（并且只有很少的阻碍），与您的客户端直接连接。（加上可能需要处理的连接问题。）

**作为旁注**：许多这些考虑因素再次与使用*GraphQL*等技术相关，它们有一些相似之处（但是没有连接问题并且具有更安全的控制）。

# jquery - 我需要一个 jquery 命令来更改背景图像：url() 内容

> ID：15853369
> 
> 赞同：2
> 
> 时间：2013-04-06T16:40:15.300
> 
> 标签：jquery

我是新手。我有这个代码：

```
<div id="cloud-zoom-big" class="cloud-zoom-big" style="position: absolute; left: 342px; top: -10px; width: 390px; height: 390px; background-image: url(http://kato-shoes.ro/image/cache/data/balerini/balerini1234verde-750x750.jpg); z-index: 99; background-position: -359px -359px;">
    <div class="cloud-zoom-title" style="opacity: 0.5;">Balerini Prada 1234</div>
</div> 
```

我需要一个 jquery 命令来更改**背景图像： url()**内容（里面是什么 () ），以及另一个链接。这另一个链接是这样的（'href'.data.data.pop）

这是应该更改的注释行：

图像交换变体

```
if(data.data.image !='')  {

$('#image').attr('src', data.data.thumb);
$('#wrap a').attr('href', data.data.pop);
$('.image a').attr('href', data.data.pop);  // this line to be fixed
                       } 
```

粗线应该如何？有人可以帮忙吗，我被困了 3 周... :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:43:59.077

你需要这样做：

```
var imageUrl = data.data.pop;
$('#image').css('background-image', 'url(' + imageUrl + ')'); 
```

# html - iPad上奇怪的保证金问题

> ID：15853376
> 
> 赞同：-2
> 
> 时间：2013-04-06T16:40:30.187
> 
> 标签：html, ios, css, ipad, layout

当我访问我的演示站点时，我在 ipad 上遇到了奇怪的问题，基本上播放器似乎被移到了顶部，这就是它在 iPad 上的样子（ipad Mini iOS 6.1，在 chrome 和 safari 中测试）：

![在此处输入图像描述](https://i.stack.imgur.com/m39Wj.png)

这是演示站点（将屏幕分辨率更改为 ipad 大小）： http: [//freshbeer.lv/test/index.html](http://freshbeer.lv/test/index.html) 它在 mac 和 pc 上运行良好，只是 ipad 的一些问题，我假设智能手机也是如此；/你能建议是什么导致了这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T18:27:24.377

由于您使用`reset.css`的`display: inline-block`是 , 适用于`<audio>`. 去掉它。也`margin: 0 !important;`从`.audiojs .scrubber, .audiojs .scrubber:hover`（第 442、447 行）中删除

# .net - 如何手动创建一个 mdf 文件供 localdb 使用？

> ID：15853382
> 
> 赞同：42
> 
> 时间：2013-04-06T16:40:48.390
> 
> 标签：.net, visual-studio-2012, localdb

我正在设置一些单元测试来测试使用数据库完成的工作。我想使用 localdb v11 但首先我需要创建数据库。我该怎么做？

只需`(localdb)v11`在 sql management studio 中连接即可将我连接到（我假设）所在的数据库`C:\Users\George\`。如何指定一个新的？

该代码使用手动 ADO.Net，而不是实体框架，据我所知，我不能依赖它来简单地创建数据库。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-06T17:04:24.863

只需使用 CREATE DATABASE 语句

```
SqlConnection connection = new SqlConnection(@"server=(localdb)\v11.0");
using (connection)
{
    connection.Open();

    string sql = string.Format(@"
        CREATE DATABASE
            [Test]
        ON PRIMARY (
           NAME=Test_data,
           FILENAME = '{0}\Test_data.mdf'
        )
        LOG ON (
            NAME=Test_log,
            FILENAME = '{0}\Test_log.ldf'
        )",
        @"C:\Users\George"
    );

    SqlCommand command = new SqlCommand(sql, connection);
    command.ExecuteNonQuery();
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2016-05-05T11:30:37.870

我知道，老问题，但我发现以下方式仍然相关且快速。以下是完整的步骤，但实际上只有最后一部分是真正相关的：

先决条件：

1.  MS Sql LocalDb 引擎
2.  MS Sql 服务器管理工​​作室

脚步：

1.  打开命令提示符
2.  运行`SqlLocalDb info`以列出当前安装的 LocalDb 实例。至少应该有`v11.0`Sql Server 2012/Visual Studio 2012 或`MSSQLLocalDB`Sql Server 2014/Visual Studio 2015
3.  打开 Sql Server Management Studio，或显示连接对话框（如果已运行）
4.  使用 Server name`(localdb)\v11.0`或`(localdb)\MSSQLLocalDB`，无论您感兴趣。选择 Windows 身份验证
5.  创建新查询
6.  粘贴以下模板，根据需要调整路径和名称：

    ```
    CREATE DATABASE __YourDbName__ ON (
      NAME='__YourDbName__', 
      FILENAME='YourDrive:\Your\path\to\data\files\__YourDbName__.mdf') 
    ```

7.  运行查询

8.  刷新数据库的对象资源管理器列表

在对象资源管理器中，您现在应该看到新创建的数据库，而在 Windows 资源管理器中，您现在应该看到新创建的`.mdf`文件`.ldf`和指定路径的文件。

高温高压

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-11-26T21:14:50.887

不确定您所说的“手动”是什么意思。我将使用 Visual Studio 2013 和 LocalDb 添加一个选项：

打开服务器资源管理器，右键单击数据连接，选择创建新的 SQL Server 数据库。对于“服务器名称”，请使用“(LocalDB)\v11.0”。

如[这里](http://msdn.microsoft.com/en-us/library/vstudio/ms233763.aspx)所述，还有另一个选项，但它需要安装 SQL Server Data Tools。[还提供](http://msdn.microsoft.com/en-us/library/vstudio/ms233763%28v=vs.110%29.aspx)了适用于 Visual Studio 2012 的说明版本。

由于您还提到了 SQL Server Management Studio，您可以简单地连接到 LocalDb 实例并右键单击 Databases，然后单击 Create，这是标准方式。它或多或少是一个常规的 SQL Server 实例，所有标准操作都将照常运行。

显然，也可以从应用程序代码中创建数据库，但这需要设置适当的数据库权限。根据您的环境，这可能是一个好主意，也可能不是一个好主意。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-11-01T15:13:52.283

如果您（像我一样）正在寻找一种在您的代码之外执行此操作的方法，您可能需要考虑使用 .bat 脚本来执行此操作。我将它作为 .txt 文件保存在解决方案中，当我需要再次设置开发环境时可以使用该文件。

## LocalDB 和 SQLCmd

此脚本假设已安装 LocalDB。我还没有找到关于它的明确信息，但如果您使用实体框架，它似乎可以与 Visual Studio 2012 和 2015 一起安装。如果不是这种情况，您可以从独立安装程序或 SQL Server express 下载页面安装它（您可以选择它作为您想要的下载。更多详细信息在这里：[如何单独安装 localdb？](https://stackoverflow.com/questions/23320013/how-to-install-localdb-separately)

SQLCmd 可以从 SQLServer Feature Pack 以相同的方式下载，查找 SQLCmdlnUtility.msi。这是2012版本的[链接](https://www.microsoft.com/en-us/download/details.aspx?id=35580)。

如果您没有与我相同的版本，您可能需要更改 LocalDbDir 和 SQLCmdDir 路径。

## 脚本

```
:: Script to Create Local DB Instance and a database

::echo setting variables - Default Server is v11 but it may be useful to evolve in a server instance of your own...
SET localdDbDir=C:\Program Files\Microsoft SQL Server\120\Tools\Binn
SET sqlCmdDir=C:\Program Files\Microsoft SQL Server\120\Tools\Binn
SET SRV_NAME=your-dev-srv
SET DB_NAME=your-dev-db
SET DB_PATH=C:\CurDev\Temp

echo Creates the localDB server instance
pushd "%localdDbDir%"
:: uncomment those lines if you want to delete existing content
::SqlLocalDb stop %SRV_NAME%
::SqlLocalDb delete %SRV_NAME%
SqlLocalDb create %SRV_NAME%
SqlLocalDb start %SRV_NAME%
popd

echo Create the database intance
pushd "%sqlCmdDir%"
sqlcmd -S "(localdb)\%SRV_NAME%" -Q "CREATE DATABASE [%DB_NAME%] ON PRIMARY ( NAME=[%DB_NAME%_data], FILENAME = '%DB_PATH%\%DB_NAME%_data.mdf') LOG ON (NAME=[%DB_NAME%_log], FILENAME = '%DB_PATH%\%DB_NAME%_log.ldf');"
popd
echo completed 
```

希望这可以帮助！

# javascript - 更改图像相对宽度

> ID：15853384
> 
> 赞同：0
> 
> 时间：2013-04-06T16:40:53.413
> 
> 标签：javascript, jquery, html, image

如何动态更改图像的相对百分比宽度？

```
<div style="width: 350px; background-color: #DDDDDD">
    <img id="gradient" src="img.png" style="width: 74.074%;"></img>
</div> 
```

我无法使用 jquery`attr()`或点获得宽度：

```
<input type="submit" value="button" />

<script>                                                                      
$(function() {
  $( "input[type=submit], a, button" )
    .button()
    .click(function( event ) {
     $("#gradiant").width;
  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:42:20.227

利用：

```
$("#gradiant").width(); 
```

`width()`：

> 获取匹配元素集中第一个元素的当前计算宽度或设置每个匹配元素的宽度。或者：

```
$("#gradiant").outerWidth(); 
```

`Outerwidth()`：

> 获取匹配元素集中第一个元素的当前计算宽度，包括填充和边框。

您还可以将布尔值传递给方法`.outerWidth(true)`，以`margin`在返回的宽度中包含（第一个）元素的。

[顺便说一句，我在jQuery API](http://api.jquery.com/)中找不到对方法的*任何*引用，并且搜索仅返回*选择器*，使用不存在的方法*将*[导致错误](http://jsfiddle.net/davidThomas/EZCjb/)（检查控制台）。`button()``:button`

 **参考：

*   [`outerWidth()`](http://api.jquery.com/outerWidth/).
*   [`width()`](http://api.jquery.com/width/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:13:16.883

`gradiAnt`!= `gradient`
`<img></img>`!=`<img />`

```
<div style="width: 350px; background-color: #DDDDDD">
    <img id="gradient" src="img.png" style="width: 74.074%;" />
</div>
<input type="submit" value="button" />

<script>                                                                      
$(function() {
  $( "input[type=submit]").click(function() {
     var imgW = $("#gradient").width(); // in PX (Number)
     var parentW= $("#gradient").closest('div').width();
     var percent= imgW*100/parentW;

     alert(imgW +' '+ parentW +' '+ percent +'%');

  });
});
</script> 
```**

# grails - grails 中的集成测试：在查询字符串参数中获取 null

> ID：15853385
> 
> 赞同：1
> 
> 时间：2013-04-06T16:41:05.063
> 
> 标签：grails, request.querystring, integration-testing

我正在为 grails 中的控制器进行集成测试。我需要在测试用例中传递查询字符串，并且我正在传递它`controller.request.queryString`。

我的测试失败了。它给了我`null value`查询字符串参数。

控制器 - UserExController

Foll 是我正在进行集成测试的操作。在此我正在读取查询字符串参数“uid”并使用 GORM 方法获取 userInstance

```
def getUser() {
    //reading the query string parameter 'uid'
    def userId = request.getParameter("uid")  
    User user = User.findByUsername(userId)
    render view:'edit', model:[userInstance:user]
} 
```

这是对上述书面操作的测试。在此我传递查询字符串参数并调用操作

```
class UserInstanceTests extends GroovyTestCase {

    @Test
    void testPerfSummaryApi() {
        def userExController=new UserExController()
        userExController.request.queryString='uid=rp123'
        userExController.getUser()
        def model = userExController.modelAndView.model.userInstance
        assertNotNull model
    }
} 
```

我正在`groovy.lang.MissingMethod.Exception`接听电话：

```
User.findByUsername(userId) //userId is comming null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:22:05.803

控制器变化：

```
def userId = request.getParameter("uid") 
```

到

```
def userId = params.uid 
```

int测试的变化：

```
userExController.request.queryString='uid=rp123' 
```

到

```
userExController.params.uid='rp123' 
```

Grails 的动态绑定有助于将查询参数`params`和请求绑定到`request`控制器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T12:04:34.830

这应该会让事情为你工作（在 Grails 2.0.4 上测试）：

```
 userExController.request.addParameter('uid', 'rp123') 
```

但是，我建议转向 dmahapatro 的建议并重构您的控制器以使用`params.uid`而不是`request.getParameter("uid")`. 甚至引入一个命令对象。你现在做的方式似乎不是标准的 Grails 方式。

# php - PHP：时间格式

> ID：15853392
> 
> 赞同：1
> 
> 时间：2013-04-06T16:41:38.760
> 
> 标签：php, time

我知道，这应该很容易，但我在 PHP 中的时间函数有问题。我有一个像“1 h 38 min”这样的字符串，我想将它转换为带有分钟数的整数。任何帮助还是微不足道的？;)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:49:41.313

这听起来更像是[sscanf](http://php.net/sscanf)的工作，而不是任何时间函数。

像这样的东西：

```
<?php

$input = '1 h 38 min';
sscanf($input, '%d h %d min', $hours, $minutes);

$minutes += 60 * $hours;

echo "total minutes: $minutes\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T19:47:11.163

下面是一些比 sscanf 更健壮的代码，并且更具体地使用时间（并且适用于旧版本的 PHP）：

```
$input = '1 d 1 hour 38 min';
$usableInput = trim(str_replace(array(' y ', ' m ', ' d ', ' h ', ' s '), array(' years ', ' months ', ' days ', ' hours ', ' seconds '), " $input "));
$now = time();
$seconds = strtotime("+$usableInput", $now) - $now;
$minutes = floor($seconds / 60); 
```

# css - CSS如何将输入框附加到分隔窗口的底部

> ID：15853395
> 
> 赞同：0
> 
> 时间：2013-04-06T16:41:50.130
> 
> 标签：css

我有一个包装分隔器以及一个用于聊天窗口的子分隔器和一个输入文本框。但我不知道如何在`input box`保留属性的同时保留聊天窗口下方`float:left`，因为会有超过 1 个聊天窗口，我希望它们彼此相邻。

这是我所拥有的一个jsfiddle

[http://jsfiddle.net/pu7gK/1/](http://jsfiddle.net/pu7gK/1/)

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:46:40.240

`float``float:left`将容器取出并从容器中取出`.chat-window`应该会产生所需的结果。`<div class="chat-window">`默认显示是这样`block`它会自动创建一个换行符，因此`<input>`自然会出现在下面。

多个`.chat-tab-container`将彼此相邻浮动。

**CSS**

```
.chat-tab-container {
    float:left;
}

.chat-window {
    background:#fff;  
    height:200px;  
    width:250px;  
    border:1px solid #ACD8F0;  
    overflow:scroll;
} 
```

**HTML**

```
<div class="chat-tab-container">
    <div class="chat-window"></div>
    <input type="text" class="messages"/>
</div>

<div class="chat-tab-container">
    <div class="chat-window"></div>
    <input type="text" class="messages"/>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:56:54.210

对于初学者，我会将您的文本框 div 放在您的聊天框 div 内。
**HTML**

```
 <div class="chat-tab-container">
        <div class="chat-window">
        <input type="text" class="messages"/>
            </div>
    </div> 
```

然后你想让那个文本框到窗口 **CSS的底部**

```
 .chat-window
    {
        float:left;
        background:#fff;  
        height:200px;  
        width:250px;  
        border:1px solid #ACD8F0;  
        overflow:scroll;
         position:relative;
    }

    .messages
    {

    position:absolute; bottom:0;
        float:left;
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-06T16:47:55.017

```
<div class="chat-tab-container">
    <div class="chat-window"></div>
    <input type="text" class="messages"/>
</div>
<div class="chat-tab-container">
    <div class="chat-window"></div>
    <input type="text" class="messages"/>
</div> 
```

和

```
.chat-window {
    background:#fff;  
    height:200px;  
    width:250px;  
    border:1px solid #ACD8F0;  
    overflow:scroll;
    clear:right;
}

.chat-tab-container { float:left; } 
```

...基本上浮动每个容器而不是单个元素 - 如果“聊天标签容器”应该是顶级聊天容器，那么在两者之间有一个级别

# imagej - 学习使用 Scilab 和 ImageJ

> ID：15853399
> 
> 赞同：0
> 
> 时间：2013-04-06T16:42:13.263
> 
> 标签：imagej, scilab

我正在尝试学习使用 Scilab 和 ImageJ，这是使用计算机编码命令制作图形和电子表格等的软件。我从来没有学过如何编码，你能指导我到任何网站/课程/在线教程吗？有帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:02:56.670

使用 ImageJ 是否有特定原因？

Scilab 提供了许多本机绘图功能，对于特定的图像处理操作，您可以使用[SIVP](http://sivp.sourceforge.net/)之类的工具箱扩展 Scilab 。

# internet-explorer - IE10中的关键帧动画问题

> ID：15853405
> 
> 赞同：1
> 
> 时间：2013-04-06T16:42:45.833
> 
> 标签：internet-explorer, css, animation, keyframe

我的 css 动画在所有真正的浏览器中都能很好地工作，但正如预期的那样，它在 IE10 中效果不佳。**现在看来，IE 不想`360deg`正确旋转。仍在寻找可能的解决方法，这不会牺牲实际浏览器中的功能。**

**编辑** ~~似乎 ie10 会`translateX`或`rotate(360deg)`，但不会同时做这两个~~。

这是[jsFiddle](http://jsfiddle.net/apaul34208/v7k7f/4/)和代码：

```
@keyframes lightSpeedIn {
0% {
    top: 30px;
    transform-origin: top left;
    transform: translateX(700px) skewX(-50deg) rotate(0deg);
    opacity: 0;
}
25% {
    top: 15px;
    transform-origin: top left;
    transform: translateX(0px) skewX(-50deg)rotate(0deg);
    opacity: 1;
}
35% {
    top: 15px;
    transform-origin: top left;
    transform: translateX(-25px) skewX(0deg)rotate(180deg);
    opacity: 1;
}
65% {
    top: -15px;
    transform-origin: top left;
    transform: translateX(0px) skewX(0deg)rotate(360deg);
    opacity: 1;
}
100% {
    top: -15px;
    transform-origin: top left;
    transform: translateX(0px) skewX(0deg);
    opacity: 1;
}
}
.lightSpeedIn {
    -webkit-animation-name: lightSpeedIn;
    -moz-animation-name: lightSpeedIn;
    -o-animation-name: lightSpeedIn;
    animation-name: lightSpeedIn;
    -webkit-animation-timing-function: ease-out;
    -moz-animation-timing-function: ease-out;
    -o-animation-timing-function: ease-out;
    animation-timing-function: ease-out;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T07:13:12.540

好吧，我设法让它工作。

我在越野车区附近又创建了 3 个步骤：

```
34.98% {
    top: 15px;
    transform-origin: top left;
    transform: translateX(-25px) skewX(0deg)rotate(179deg);
    opacity: 1;
}    
34.985% {
    top: 15px;
    transform-origin: top left;
    transform: translateX(-25px) skewX(0deg)rotate(179deg);
    opacity: 0;
}    
34.99% {
    top: 15px;
    transform-origin: top left;
    transform: translateX(-25px) skewX(0deg)rotate(180deg);
    opacity: 0;
}
35% {
    top: 15px;
    transform-origin: top left;
    transform: translateX(-25px) skewX(0deg)rotate(180deg);
    opacity: 1;
} 
```

如您所见，这个想法是接近 180 度，关闭能见度，达到 180 度，然后打开能见度。所有这一切都在尽可能短的时间内完成。

## [更新的小提琴](http://jsfiddle.net/v7k7f/5/)

我已经放慢了速度，以便于检查

关于防止它破坏其他兄弟，好吧，鉴于 IE 人******决定取消该属性的前缀（我将保留 * 空间，以便每个人都可以放置想要的形容词），我想您应该在某个时间查看该设计未来。

# android - 显示调试透视图时 Eclipse 挂起

> ID：15853408
> 
> 赞同：2
> 
> 时间：2013-04-06T16:42:59.790
> 
> 标签：android, eclipse, perspective

当我打开 Debug Perspective 时 Eclipse 挂起。

当我的应用程序遇到断点时，我认为 Eclipse 正在挂起……但事实证明，当显示调试透视图时，Eclipse 会挂起。

我可以通过打开 Eclipse 来重现挂起，然后单击 Window/Open Perspective/Debug

Eclipse 3.7.2，在 Ubuntu 12.x 上运行

帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-12T16:21:28.613

今天我在 Eclipse 4.3 (Kepler) 上遇到了同样的问题，并在做了一些研究后找到了如何解决它的解决方案。对于您的问题可能为时已晚，但我希望它可以帮助其他人解决问题。

**这些步骤帮助我解决了这个问题**

1.  在您原来的工作区中打开`Window / Preferences / General / Perspectives`. 单击`Debug`此窗口中的透视图，然后单击`Revert`
2.  使用新的工作区启动 Eclipse。
3.  打开`Debug`冻结 Eclipse 的透视图。就我而言，它在原始工作区中冻结，但在新工作区中没有冻结。
4.  保持`Debug`视角打开！然后关闭新的工作区，打开原来的工作区。就我而言，`Debug`视角不再冻结，我可以在所有视角之间切换。但是，有些按钮没有正确的位置，所以我再次重新启动了原来的工作区。这为我确定了观点。

最好的问候，迈克尔

*PS：我卸载 PyDev 以获得干净的 Android IDE 后出现问题（在此之前我将 Android 和 Python 混合在一个 IDE 中）。PyDev 在调试透视图中生成了一些 UI 元素，这可能导致了该问题。*

# ios - 在添加到 UITextField 输入法的“完成”按钮上添加验证方法

> ID：15853410
> 
> 赞同：1
> 
> 时间：2013-04-06T16:43:04.580
> 
> 标签：ios, validation, uibarbuttonitem, uitoolbar

当按下添加的“完成”UIBarButtonItem 时，我试图验证 UITextField 中的输入，但由于其目标设置为我正在编辑的 UITextField，因此我无法调用自定义验证方法。有谁知道如何解决这个问题？我试图通过用 validateInput（自定义方法）替换“resignFirstReponder”来添加自定义方法，但它会引发异常错误，因为目标 textField 没有调用的方法，我想。如果我将目标设置为“自我”，那么它不会将“完成”按钮添加到 UITextField。请帮忙。

对不起，我没有把整个代码。以下是围绕此功能的完整代码：

```
- (void) addDoneButton: (UITextField *) textField
{
    UIBarButtonItem *barButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone                                                                                 target:textField action:@selector(resignFirstResponder)];
    UIToolbar *toolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
    toolbar.items = [NSArray arrayWithObject:barButton];

    textField.inputAccessoryView = toolbar;    
}

- (void) viewDidLoad{

    [super viewDidLoad];
    [self addDoneButton:txtBox];    
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:48:53.257

只需在您的`barButtom`财产上设置操作：

```
[barButton setAction:@selector(myValidationMetod)]; 
```

在该方法内的 textField 上使用任何验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:55:02.493

我猜目标应该是自我并采取行动：@selector(yourCustomMethod)。

```
-(void)yourCustomMethod
{
  if(textField.length>0)
     {
       NSLog(@"textField Validated");
     }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:10:26.983

你需要做的是让完成按钮调用控制器上的一个方法，然后控制器将负责验证`text`和调用`resignFirstResponder`.

看起来像这样

```
UIBarButtonItem *barButton =
  [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone
                                                target:self
                                                action:@selector(doneTapped)];

UIToolbar *toolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
toolbar.items = @[ barButton ];

self.textField.inputAccessoryView = toolbar; 
```

现在您需要实现该`doneTapped`方法

```
- (void)doneTapped
{
  [self.textField resignFirstResponder];

  NSString *text = self.textField.text;

  // validate text
} 
```

# java - Jasperreports 的 Jasperviewer 打印尺寸不正确

> ID：15853418
> 
> 赞同：2
> 
> 时间：2013-04-06T16:44:08.753
> 
> 标签：java, printing, jasper-reports

我使用 iReport 设计了一个报告，并将其填充到我的 Java 应用程序中。
然后我使用`JasperViewer`. 显示的报告是正确的；但是当我使用 JasperViewer 的打印按钮打印它时；虽然纸张尺寸是 A5，报告尺寸也是 A5，但它在 A4 页面上打印报告！（它将整个 A5 报告放在 A4 页面的左下角！）我的报告配置是这样的：

```
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="pe_report" language="groovy" pageWidth="421" pageHeight="595" columnWidth="381" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="9fdf75fc-52e2-4af7-893b-e11093715503">
    <property name="ireport.zoom" value="1.5"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/> 
```

我用这个来展示它：

```
JasperReport jasperReport = null;
JasperPrint jasperPrint = null;
JasperDesign jasperDesign = null;
Map parameters = new HashMap();
jasperDesign = JRXmlLoader.load("/home/user1/reports/pe_report.jrxml");
jasperReport = JasperCompileManager.compileReport(jasperDesign);
jasperPrint  = JasperFillManager.fillReport(jasperReport, parameters, new JRBeanCollectionDataSource(data));
JasperViewer.viewReport(jasperPrint,false); 
```

问题是什么？

* * *

 **从输出和打印**编辑图像：**
**这是 JasperView 显示的内容：**
![在此处输入图像描述](https://i.stack.imgur.com/RSlji.png)
**这是它打印的内容：****

 **![在此处输入图像描述](https://i.stack.imgur.com/uuHN3.png)**

# c# - 使用 ToString 格式化十进制数

> ID：15853420
> 
> 赞同：0
> 
> 时间：2013-04-06T16:44:19.850
> 
> 标签：c#

如果我得到像 14.50 这样的十进制数，我想被表示为`decimal 10.2`

```
0000000014.50 
```

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:47:00.650

使用[自定义数字格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)：

```
var value = 14.50m;

string valueString = value.ToString("0000000000.00"); 
```

`0`是占位符：*如果存在一个，则用相应的数字替换零；否则，结果字符串中将出现零。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:51:02.623

如果您没有将数据类型转换为字符串的问题，那么您可以在 c# 中使用 Padding。

请参考以下链接：

[http://msdn.microsoft.com/en-us/library/66f6d830(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/66f6d830(v=vs.100).aspx)

# mysql - MySQL 在索引期间被关闭 - 如何修复索引？

> ID：15853421
> 
> 赞同：0
> 
> 时间：2013-04-06T16:44:23.793
> 
> 标签：mysql, indexing, shutdown

MySQL 在索引操作过程中被关闭。它仍然有效，但一些查询似乎比以前慢得多。有什么特别的我们可以检查的吗？索引是否有可能通过一半？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:48:59.960

正如我在评论中所建议的那样，您可以尝试修复相关表。

也就是说，MySQL 手册中有一部分[专门针对这个精确的主题](http://dev.mysql.com/doc/refman/5.0/en/rebuilding-tables.html)，其中详细说明了如何使用该`REPAIR <table>`语句以及如何转储/重新导入。

这是否没有任何区别，您可能需要检查数据库设置（如果它是 InnoDB 引擎表/数据库，例如，它会*喜欢*能够驻留在内存中）并可能尝试查看特定索引是什么通过`EXPLAIN`引起痛苦的查询使用。

还有诸如[New Relic](http://newrelic.com/)之类的商业工具，它可以在很多细节上显示哪些特定查询是缓慢的，以及监视系统的其他方面，如果这是一个商业项目/网站，这可能值得探索。

# php - PHP Twitteroauth reset_time_in_seconds 转换为日期时间

> ID：15853425
> 
> 赞同：0
> 
> 时间：2013-04-06T16:44:40.407
> 
> 标签：php, datetime, twitter, twitter-oauth

我正在使用在这里找到的 twitteroauth 库：[twitteroauth](https://github.com/abraham/twitteroauth)。其中一种连接方法是检索速率限制。它包含的返回值之一是：`[reset_time_in_seconds] => 1365270026`. 如何将其转换为 PHP 日期时间值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:46:54.457

看起来像一个 UNIX 时间戳，所以你可以使用[`DateTime::setTimestamp()`](http://www.php.net/manual/en/datetime.settimestamp.php)：

```
$date = new DateTime;
$date->setTimestamp( 1365270026); 
```

然后，您可以根据需要对其进行格式化：

```
echo $date->format( 'F jS Y, h:i:sA'); 
```

# stata - Stata：不允许使用错误因子变量和时间序列运算符

> ID：15853426
> 
> 赞同：3
> 
> 时间：2013-04-06T16:44:40.463
> 
> 标签：stata

我想将数据从 Stata 导出到 csv 文件中：

```
 outsheet "$dirLink/analysis.csv",  replace comma 
```

但我收到以下错误消息：

```
 factor variables and time-series operators not allowed
 r(101); 
```

我在网上找不到解决方案。感谢帮助。

以下是变量定义：

```
 tab0            str1   %9s                    
 linkid          float  %10.0g                 
 recid2          float  %9.0g                  
 recid1          float  %10.0g                 
 patient1        str28  %28s                   
 patient2        str9   %9s                    
 totwght         int    %10.0g                 
 status          str1   %9s                    
 fname           str13  %13s                   
 sname           str13  %13s                   
 doby            int    %10.0g                 
 cohort          str2   %9s    
 res1            str27  %27s                   
 res2            str29  %29s                   
 residence       str50  %50s   
 facility        str22  %22s                   
 maxwght         int    %10.0g 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-06T17:06:12.557

语法应该是

```
outsheet using "$dirLink/analysis.csv",  replace comma 
```

也就是说，这个词`using`是必需的。这在帮助中有记录：无需互联网搜索。确实，错误消息是不透明的，因为 Stata 猜测您正在尝试除`using`变量列表之外的其他内容，其中任何一个都可能跟随`outsheet`.

PS 在我对您之前的问题的回答中，我指出正确的拼写是 Stata：请参阅[http://www.stata.com/support/faqs/resources/statalist-faq/#spell](http://www.stata.com/support/faqs/resources/statalist-faq/#spell)这仍然是正确的。

# php - 使用 html 表单输入 twitter id 并使用 ajax 和 PHP 返回最近的状态

> ID：15853427
> 
> 赞同：0
> 
> 时间：2013-04-06T16:44:42.523
> 
> 标签：php, ajax, twitter

我正在尝试使用 html 文本字段在页面上打印 Twitter 帐户的最新推文以输入用户 ID。到目前为止，我可以将用户 ID 发送到获取推文并打印它们的 PHP 页面。

我可以使用 php 连接到 twitter api 并打印出最近的推文。我需要能够将推文打印回我的原始页面。此外，我需要 ajax 来继续请求 php 访问 twitter api，以便在用户提交 twitter id 后它会更新而不刷新。

这是链接到 php 的 html 表单：

```
<form name="input" action="twitterTest2.php" method="get">Twitter Username: 
  <input type="text" name="userid">
  <input type="submit" value="Get recent Tweets">
</form> 
```

这是从 twitter 获取推文的 php：

```
<?php
  function getTwitterStatus()
  {
    $userid = $_GET['userid'];
    //url that accesses the twitter api for statuses xml
    $url = "https://api.twitter.com/1/statuses/user_timeline/$userid.xml?count=5";
    $xml = simplexml_load_file($url) or die("could not connect");
    foreach ($xml->status as $status) {
      $text = $status->text;
      echo $text;
    }
  }
  getTwitterStatus();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T15:45:42.033

```
<script>

    /** Create a cross-browser XMLHttp Request object. **/
    function getXMLHttp() {
        var xmlhttp;
        if (window.ActiveXObject) {
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        } else if (window.XMLHttpRequest) {
           xmlhttp = new XMLHttpRequest();
        } else {
        alert("Your browser does not support XMLHTTP!");
        }
        return xmlhttp;
}
     //function that searches for the tweets  via php
     function getStatuses(){

   XMLHttp1 = getXMLHttp();

      //ajax call to a php file that will search  the tweets
       XMLHttp1.open( 'GET', 'twitterTest2.php', true);

  // Process the data when the ajax object changes its state
       ajax.onreadystatechange = function() {
         if( ajax.readyState == 4 ) {
           if ( ajax.status ==200 ) {  //no problem has been detected

  response = XMLHttp.responseText;
      document.getElementById("showText").value = response;

      }
}
  }
}

/** Check for response and update the text-area. **/
function updateInfo() { 
    if(xmlhttp1.readyState == 4) { 
        response=XMLHttp1.responseText;
        document.getElementById("showText").value = response;

    } 
}

</script> 
```

# javascript - 为什么在 console.log javascript 中再次迭代？

> ID：15853428
> 
> 赞同：1
> 
> 时间：2013-04-06T16:44:51.863
> 
> 标签：javascript, console.log

我理解我猜的循环，但我很惊讶在 console.log 中看到 firebug 再次迭代。我希望迭代 10 倍（0-9）。为什么是10？？

```
$i = 0;

while ($i < 10) {
    console.log($i);//the last time here should be $i=9, not $i=10
    ++$i;
}

// in console log i have(0...10)

while ($i < 10) {
    console.log($i);
    $i++;
}
// in console.log i have doubled 9(0...9,9) Why 9 doubled??? 
```

谢谢你的建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:48:04.890

我认为您看到的只是最后一条语句的结果，即`$i++`or `++$i`。如果您直接在控制台中键入此语句，您也会看到输出的数字，即使您没有显式输出它。

例如，如果我直接在 Firefox 的控制台中运行代码，我实际上会看到

```
10
0
1
...
9 
```

这`10`是最后一次执行的结果，`++$i`其他是`console.log`语句，它们仅在代码终止后执行（看起来）。

如果你使用

```
console.log('Iteration: ' + $i); 
```

然后你会更清楚地看到差异。

* * *

这也是您看到两个`9`s 的原因，因为`$i++`(where `$i = 9`) 的结果是`9`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T16:48:14.377

我认为您不希望看到的“10”和“9”是控制台中返回的内容。

# c# - 如何在 webmatrix 的 App 变量中访问自定义对象的属性？

> ID：15853432
> 
> 赞同：1
> 
> 时间：2013-04-06T16:45:35.897
> 
> 标签：c#, dynamic, global-variables, webmatrix

我有这个自定义对象，其中包含我的数据库中的一些信息：

```
App.Model = new
{
  Niveles = (IEnumerable<dynamic>)db.Query("select * from nivel"),
  Dificultades = (IEnumerable<dynamic>)db.Query("select * from dificultad"),
  Asignatura_Eje_Nivel = (IEnumerable<dynamic>)db.Query("select * from asignatura_eje_nivel"),
  Asignatura = (IEnumerable<dynamic>)db.Query("select * from asignatura")
}; 
```

我想以这种方式使用 LINQ 查询这个对象：

```
var asignaturas = (from x in (IEnumerable<dynamic>)App.Model.Asignatura
                     from y in (IEnumerable<dynamic>)App.Model.Asignatura_Eje_Nivel
                    where y.id_nivel == nivel
                       && x.id_asignatura == y.id_asignatura
                    select x).Distinct(); 
```

问题是，当我尝试这样做时，我得到一个异常，告诉我模型（对象类型）不包含 Asignatura 的定义......以及任何其他属性。因此我想知道，如何正确访问这些对象？

# jquery - 获取用户在文本框中写入的文本，并使用 jQuery 在另一个 div 中显示

> ID：15853436
> 
> 赞同：1
> 
> 时间：2013-04-06T16:46:01.557
> 
> 标签：jquery, html, text

我是 jQuery 的新手。我有一个用此代码包装的简单表单：

```
<div class="search_container"> 
    <form action="mode" onSubmit="calcRoute();return false;" id="routeForm">
          <input type="text" id="routeStart" PlaceHolder="Pikënisja" ><br/>
          <input type="text" id="routeEnd" class="routeEnd" PlaceHolder="Destinacioni">
        <button id="submit"><i class="icon-map-marker"></i></button>
    </form>
</div> 
```

我想要这样的东西：

当有人填写文本框并单击提交按钮时，他在文本框中输入的文本将被发布到另一个 div 中。

前任。在第一个文本框中，我写“纽约”，在第二个文本框中，我写“佛罗里达”。

在表单下的 div 中，我得到以下结果：

第一个文本（在本例中为纽约），第二个文本（在本例中为佛罗里达州）。

我希望有人能帮助我。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:48:52.033

我建议：

```
$('#submit').click(function(e){
    // prevents the form's submission
    e.preventDefault();
    $('selector').text($('#routeStart').val()); // sets the text of the element 
    $('otherSelector').text($('#routeEnd').val()); // to the value of the input
}); 
```

假设要插入文本的元素具有可预测的后缀（例如“txt”）和类，则可以使用以下内容使上述内容更具可扩展性：

```
<div class="search_container"> 
    <form action="mode" onSubmit="calcRoute();return false;" id="routeForm">
          <input type="text" id="routeStart" PlaceHolder="Pikënisja" ><br/>
          <input type="text" id="routeEnd" class="routeEnd" PlaceHolder="Destinacioni">
        <button id="submit"><i class="icon-map-marker"></i></button>
    </form>
</div>
<div class="waypoints" id="routeStartTxt"></div>
<div class="waypoints" id="routeEndTxt"></div> 
```

和 jQuery：

```
$('#submit').click(function(e){
    e.preventDefault(); // prevents form-submission
    $('.waypoints').text(function(){ // iterates over each of the .waypoints elements
        /* finds the element whose id matches the id of the current .waypoint element,
           *without* the 'Txt' suffix, and sets the text of the current .waypoint to 
           be the value found in that element. */
        $('#' + this.id.replace('Txt','')).val();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:47:55.767

为了将文本从输入中放入另一个 div：

HTML：

```
<div id="routeStartTxt"></div> 
```

JS：

```
$('#submit').click(function(e) {
   e.preventDefault();
   $('#routeStartTxt').html($('#routeStart').val());
   // do the other inputs here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:49:02.843

您可以使用 jQuery 的`.val()`方法来获取文本框的**值**。然后，您可以使用该`.html()`方法设置另一个元素的 html。

```
value = $('input').val();
$('div').html(value); 
```

或作为一个班轮

```
$('div').html($('input').val()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T16:52:55.207

试试这个：

添加一个新的div：

```
<div id="route"></div> 
```

JS：

```
$('#submit').click(function (e) {

    // 1\. First prevent the default action of button click
    e.preventDefault();

    // 2\. Get the textbox values and trim it
    var routeStart = $.trim($('#routeStart').val());
    var routeEnd = $.trim($('#routeEnd').val());

    // 3\. Check it the values are not empty
    if (routeStart == '' || routeStart == '') 
        $('#route').html('Please enter some text!');
    else 
        $('#route').html(routeStart + '  ' + routeEnd);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-06T16:58:23.597

你可以这样做：

**HTML：**

```
<div class="search_container"> 
    <form action="mode" onSubmit="calcRoute();return false;" id="routeForm">
        <input type="text" id="routeStart" PlaceHolder="Pikënisja" /><br/>
        <input type="text" id="routeEnd" class="routeEnd" PlaceHolder="Destinacioni" />
        <button id="submit">Submit</button>
    </form>
</div>

<div id="append"></div> 
```

**jQuery**

```
$("form#routeForm").submit(function(e) {
    e.preventDefault();

    var firstVal = $("#routeStart").val();
    var SecondVal = $("#routeEnd").val();

    $("#append").append("<p>" + firstVal + " " + SecondVal + "</p>");

}); 
```

**[演示](http://jsfiddle.net/XcANe/)**

# c++ - 如何在控制台中正确显示二叉搜索树？

> ID：15853438
> 
> 赞同：3
> 
> 时间：2013-04-06T16:46:17.277
> 
> 标签：c++, recursion, binary-search-tree

我正在尝试在控制台中显示 BST。那是我的代码（它是在这里找到的代码的修改版本：[Printing Level Order Binary Search Tree Formatting](https://stackoverflow.com/questions/13186941/printing-level-order-binary-search-tree-formatting)）：

```
string printLevel(node *root, int level, string gap) {
  if (!root) {
    return gap + "-" + gap;
  }
  if (level==1) {
    stringstream out;
    out<<root->value;
    return gap + out.str() + gap;
  } else if (level>1) {
    string leftStr = printLevel(root->left, level-1, gap);
    string rightStr = printLevel(root->right, level-1, gap);
    return leftStr + " " + rightStr;
  } else return "";
}

void printLevelOrder (node* root, int depth) {
  for (int i=1; i<=depth; i++) {
    string gap="";
    for (int j=0; j<pow(2,depth-i)-1; j++) {
      gap+=" ";
    }
    string levelNodes = printLevel(root, i, gap);
    cout<<levelNodes<<endl;
  }
} 
```

例如结果应该是这样的：

```
 4
   1       6
 -   2   5   - 
- - - 3 - - - - 
```

但相反的是：

```
 4       
   1       6
 -   2   5   -
- - 3 - - - 
```

如果我理解正确，当程序到达空叶子时递归停止，因此结果中的较低级别缺少“ - ”。但是我怎么知道我应该在较低的层次上画多少呢？如何使这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:56:16.780

我检测了代码以查看它出错的地方（因为在浏览器中运行调试器......），你可以[在这里](http://liveworkspace.org/code/yZGb4%245)看到它。复现函数为：

```
string printLevel(node *root, int level, string gap) {
  if (root == 0) {
    cout << ".. printLevel - " << root << ": " << gap << "-" << gap << "\n";
    return gap + "-" + gap;
  }
  if (level==1) {
    stringstream out;
    out<<root->value;
    cout << ".. printLevel - " << root << ": " << gap << root->value << gap << "\n";
    return gap + out.str() + gap;
  } else if (level>1) {
    string leftStr = printLevel(root->left, level-1, gap);
    string rightStr = printLevel(root->right, level-1, gap);

    cout << ".. printLevel - " << root << ": '" << leftStr << "', '" << rightStr << "'\n";
    return leftStr + " " + rightStr;
  } else return "";
} 
```

这是一个有趣的输出：

```
.. printLevel - <none>: -
.. printLevel - <none>: -
.. printLevel - { 3, <none>, <none> }: 3
.. printLevel - { 2, <none>, { 3, <none>, <none> } }: '-', '3'
.. printLevel - { 1, <none>, { 2, <none>, { 3, <none>, <none> } } }: '-', '- 3' 
```

所以，问题是你在 0 时短路`root`，这实际上是一个问题：`-`不是正确的输出，除非`level`is `1`。

`root`为 0 和不为 0之间的唯一区别`root`是您无法从中读取值（因此可以将其替换为`-`）；`level`但是，您仅在is时才真正读取该值（请注意，您可能也`1`尝试读取），因此除非您在分支中，否则没有理由进行测试。`left``right``root == 0``level == 1`

让我们稍微重新排序一下：

```
string printLevel(node *root, int level, string gap) {
  if (level==1) {
//    if (root == 0) {
//      cout << ".. printLevel - " << root << ": " << gap << "-" << gap << "\n";
//      return gap + "-" + gap;
//    }
    stringstream out;
    out<<root->value;
    cout << ".. printLevel - " << root << ": " << gap << root->value << gap << "\n";
    return gap + out.str() + gap;
  } else if (level>1) {
//    string leftStr = printLevel(root ? root->left : 0, level-1, gap);
//    string rightStr = printLevel(root ? root->right : 0, level-1, gap);

    cout << ".. printLevel - " << root << ": '" << leftStr << "', '" << rightStr << "'\n";
    return leftStr + " " + rightStr;
  } else return "";
} 
```

注意：我用“评论”“突出显示”了修改后的行。

现在，树可以正确打印。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-15T05:40:55.137

```
void BinaryTree::Display(TreeNode *current, int indent)
{
    if (current != nullptr)
    {
        Display(current->left, indent + 4);
        if (indent > 0)
            cout << setw(indent) << " ";
        cout << current->value << endl;
        Display(current->right, indent + 4);
    }
} 
```

从左到右打印树而不是自上而下。

```
 1
        2
    3
        4
5
        6
    7
            8
        12
            18 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-31T22:25:57.950

这是我的代码。它打印得很好，可能不是完全对称。小说明：

*   第一个功能 - 逐级打印（根 lv -> 离开 lv）
*   第二个功能 - 距新行开头的距离
*   第三个功能 - 打印节点并计算两次打印之间的距离；

* * *

```
void Tree::TREEPRINT()
{
    int i = 0;
    while (i <= treeHeight(getroot())){
        printlv(i);
        i++;
        cout << endl;
    }
}

void Tree::printlv(int n){
    Node* temp = getroot();
    int val = pow(2, treeHeight(root) -n+2);
    cout << setw(val) << "";
    prinlv(temp, n, val);
}

void Tree::dispLV(Node*p, int lv, int d)
{
    int disp = 2 * d;
    if (lv == 0){
        if (p == NULL){

            cout << " x ";
            cout << setw(disp -3) << "";
            return;
        }
        else{
            int result = ((p->key <= 1) ? 1 : log10(p->key) + 1);
            cout << " " << p->key << " ";
            cout << setw(disp - result-2) << "";
        }
    }
    else
    {
        if (p == NULL&& lv >= 1){
            dispLV(NULL, lv - 1, d);
            dispLV(NULL, lv - 1, d);
        }
        else{
            dispLV(p->left, lv - 1, d);
            dispLV(p->right, lv - 1, d);
        }
    }
} 
```

输入：

```
50-28-19-30-29-17-42-200-160-170-180-240-44-26-27 
```

输出：[https ://i.stack.imgur.com/TtPXY.png](https://i.stack.imgur.com/TtPXY.png)

# java - 返回较大的数字

> ID：15853440
> 
> 赞同：0
> 
> 时间：2013-04-06T16:46:29.337
> 
> 标签：java

我正在尝试这个问题，我遇到了这个错误

这是一个非常普遍的语法错误，可能是由各种问题引起的，例如 { } 大括号错位或 Java 关键字/运算符的错误序列。有时错误不在指示的行上，而是在前一行上。

```
illegal start of expression
if(num1>(num2+num3)) ||(num2>(num1 +num3)) || (num3 >(num1 + num2)) { 
```

> 编写一个占主导地位的方法，它接受三个整数作为参数，如果三个整数中的任何一个大于其他两个整数的和，则返回 true。整数可以按任何顺序传递，因此最大值可以是三个中的任何一个。如果没有值大于其他两个的总和，则您的方法应返回 false。
> 
> 例如，dominant(4, 9, 2) 的调用将返回 true，因为 9 大于 4 + 2。dominant(5, 3, 7) 的调用将返回 false，因为这三个数字中没有一个大于其他人的总和。你可以假设没有一个数字是负数。

我的尝试：

```
public boolean dominant(int num1,int num2,int num3){
    if(num1>(num2+num3)) ||(num2>(num1 +num3)) || (num3 >(num1 + num2)) {
        return true;

    }else{
        return false;
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:48:37.677

您正在关闭 if 语句`if(num1>(num2+num3))`。尝试用另一组括号将整个内容括起来。

```
public boolean dominant(int num1,int num2,int num3){
    if((num1>(num2+num3)) ||(num2>(num1 +num3)) || (num3 >(num1 + num2))) {
        return true;

    }else{
        return false;
    }  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:48:57.897

问题在于您的 if （条件）。您可以按如下所示进行更正：

```
 public boolean dominant(int num1,int num2,int num3){
        if ((num1 > (num2+num3)) ||(num2 > (num1 +num3)) || (num3 > (num1 + num2))) {
            return true;

        } else { return false; }  
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:49:18.770

你的括号放错了： if(num1>(num2+num3)) ||(num2>(num1 +num3)) || (num3 >(num1 + num2))

它应该是：

```
if((num1>(num2+num3)) ||(num2>(num1 +num3)) || (num3 >(num1 + num2)) 
```

# jquery - CSS 菜单 - 移动条：怎么了？

> ID：15853441
> 
> 赞同：-1
> 
> 时间：2013-04-06T16:46:31.090
> 
> 标签：jquery, css, menu, slider, nav

我想在我的网站导航中实现一个移动栏，但我遇到了一些麻烦。作为教程，我点击了这个链接（[http://css-tricks.com/jquery-magicline-navigation/](http://css-tricks.com/jquery-magicline-navigation/)）

这是我的结果： http: [//matt-productions.be/berto/index.html](http://matt-productions.be/berto/index.html)

有人会这么好心检查出了什么问题吗？

太感谢了！马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:03:31.943

首先，`#magic-line`由于您在 CSS 中调用`#MagicLine`了一个选择器，因此缺少 CSS。

其次，`.hover()`选择器不正确。它应该将*悬停*事件绑定到菜单项的子`<a>`标签`$("#example-one li a").hover(function() {`，但您已将其绑定到魔术线`$("#navMagicLine li a").hover(function() {`。这会导致*宽度*计算产生错误的值，从而使魔术线比预期的要长很多。

解决这些问题*应该可以*纠正您的菜单，但将来我建议您再次查看任何示例代码或尝试创建您自己的独立演示。我经常发现在尝试在[jsFiddle](http://jsfiddle.net/)或其他演示站点中创建演示时，问题变得清晰 :-)

**编辑：**

您的 CSS 仍然与演示不同。*列表项*需要，否则`display:inline-block`jQuery 将无法计算`.width()`. *内联*元素没有宽度（或高度）。

CSS 需要：

```
#navMagicLine li {
    display: inline-block;
} 
```

`.hover()`需要在`<a>`您**的**菜单上，而不是动态行。它需要是：

```
$("#navMagicLine li a").hover(function() {
    // function body
}) 
```

# html - 将 div 大小调整为设置为包含的背景图像

> ID：15853442
> 
> 赞同：0
> 
> 时间：2013-04-06T16:46:37.293
> 
> 标签：html, dynamic, height, background-image

我想知道是否有人可以指出我正确的方向。我有一个带有大背景图像的 div。BG 图像设置为包含，因此它将随浏览器大小而扩展和收缩。我遇到的问题是，如果你缩小浏览器，div 仍然显示高度为 1000px。因此，当图像适当地展开以适应时，如果您开始向下滚动，您会看到现在占据图片下方 1000 像素高度的大间隙，主体 bg 颜色通过（因为图片已通过包含缩小）。我怎样才能使 div 向上移动并且间隙消失？我已经在几个网站上看到了这一点。

CSS 代码：

```
.contain { background-size: contain; }
.mainsplashtop {
    width:100%;
    height:1000px;
    background-image:url(../images/main_splash.jpg);
    background-repeat:no-repeat;
    margin-top:0;

} 
```

HTML

```
<div data-stellar-background-ratio="0.5" class="mainsplashtop contain"><a class="scroll" href="#destination1"></a></div> 
```

您可以在网站上看到我的意思（请忽略 disaray，因为它仍处于早期开发阶段）

www.doyouhaveasaddle.com

以下是我试图实现的目标的示例。 [http://www.unbornink.com/](http://www.unbornink.com/) [http://www.fmolinari.com](http://www.fmolinari.com)

提前致谢。

# c++ - C++ 检查变量和 0 是否相等时，给出段错误（调试时）

> ID：15853457
> 
> 赞同：0
> 
> 时间：2013-04-06T16:47:33.107
> 
> 标签：c++

假设我有一个这样的数组：

```
1 0 0 
0 2 1
0 1 0 
```

所以我想检查2以上的数字是否为0，如果为真则将其更改为2。假设 i = 1 且 j = 1：

```
string var = "2";
if(tab[i][j] == var && tab[i-1][j] == "0") {
       tab[i-1][j] = "2";
} 
```

这是我得到段错误的地方，如果我在 if 语句中将 0 更改为 1，它工作正常。为什么？甚至尝试将二维数组设为 int，同样的问题。

将“0”更改为“0”，反之亦然=同样的问题。

```
for(int i = 0; i < n; i++) {
    vector<string> current_row;
    for(int j =0; j < m; j++) {
        myfile >> buff;
        current_row.push_back(buff);
    }
    tab.push_back(current_row);

} 
```

这就是我填充它的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T16:58:03.347

您似乎正在访问数组边界之外的内存。可能导致这种情况的一件事是如果 tab[0][?] == var. 这会导致您的条件检查 tab[-1][?] 并生成异常。

# c# - OpenTK C# Windows Phone (8)

> ID：15853466
> 
> 赞同：1
> 
> 时间：2013-04-06T16:48:17.943
> 
> 标签：c#, opengl, windows-phone-8, direct3d, opentk

我正在尝试将桌面 C# 项目移植到 Windows Phone (8)，但我的问题是它在某些部分使用 OpenTK 来显示一些 3d 模型。经过一番研究，我确定 OpenTK 是一个 .NET 或单声道绑定到 OpenGL。我知道 Windows Phone 不支持 OpenGL，只支持 XNA 和 Direct3D。

我现在的问题是，我该怎么做才能使这段代码正常工作。是否已经有某种 OpenTK 到 Windows Phone 的端口？OpenTK 到 direct3d 的一些端口，然后我可以移植到 WP，但我不确定我是否能够从 C# 访问 Direct3D；我是否必须以某种方式弄清楚如何将 OpenTK 代码转换为 XNA 代码（甚至（实际上）可能）；还是有其他一些希望更简单的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:55:18.413

恐怕没有简单的方法可以自动将您的 OpenTK 代码转换为 DirectX。

我会将代码移植到[http://www.monogame.net/](http://www.monogame.net/)，它在 Windows、Android、iOS 和 Linux 的后台使用 OpenTK，在 Windows Phone8 和 Windows 8 Store/Metro 使用 SharpDX。

这样你的代码就独立于目标平台了，但是让你的 OpenTK 迁移到 monogame 需要一些工作。所以这可能不是你想听到的，抱歉。

# python - 将当前类作为返回类型注释

> ID：15853469
> 
> 赞同：147
> 
> 时间：2013-04-06T16:48:29.453
> 
> 标签：python, python-3.x, class, annotations

在 python 3 中，我可以创建参数并返回类型注释。例子：

```
class Graph:
    def __init__(self, V: int, E: int, edges: list):
        pass

    @classmethod
    def fromfile(cls, readobj: type(sys.stdin)):
        pass

    def V(self) -> int:
        pass

    def E(self) -> int:
        pass 
```

问题是我无法使用当前类（Graph）的返回类型进行注释，该类尚未定义。例子：

```
class Graph:
   def reverse(self) -> Graph:
       pass 
```

此代码有错误

```
def reverse(self) -> Graph:
NameError: name 'Graph' is not defined 
```

这些注释对于记录和允许 IDE 识别参数和返回类型都非常有用 => 启用自动完成

UPD：所以我想这要么是不可能的，要么需要一些我不喜欢的 hack，所以我决定使用`def reverse (self) -> 'Graph':` 可以理解的文档，尽管违反了规则。缺点是它不适用于 IDE 自动完成功能。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2018-04-17T07:36:05.613

在 python-3.7 中，此问题已通过在函数定义时不评估注释来解决。相反，它们`__annotations__`以字符串形式保存。这称为*注释的延迟评估，在*[PEP 563](https://www.python.org/dev/peps/pep-0563/)中引入。

另请注意：

> **弃用政策**
> 
> 从 Python 3.7 开始，需要`__future__`导入才能使用所描述的功能。不会发出警告。
> 
> 在 Python 3.8 中，a`PendingDeprecationWarning`由编译器在没有`__future__` 导入的模块中存在类型注释的情况下引发。
> 
> 从 Python 3.9 开始，警告变为`DeprecationWarning`.
> 
> 在 Python 4.0 中，这将成为默认行为。不再支持使用与此 PEP 不兼容的注释。

这是一个例子：

```
In [7]: from __future__ import annotations

In [8]: class C:
   ...:     def func(cls, arg:str) -> C:
   ...:         pass
   ...:     

In [9]: c = C() 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2013-07-08T21:04:52.020

所以现在过了一段时间，我可以说我做出的决定是使用`-> 'Graph'`而不是`-> Graph`. 它不会使我的 IDE (PyCharm) 能够以这种方式识别类型，但它对于文档目的来说已经足够好了。

我可以使用的另一个可能的解决方案是在运行时更改注释，但这并不能解决文档的问题——你不会想在源代码中间的某个地方寻找类型声明......

该问题的根源在于在实际定义类之前识别类对象。这在python中根本不可能做到。

# android - 推特 Android 集成

> ID：15853474
> 
> 赞同：0
> 
> 时间：2013-04-06T16:48:55.317
> 
> 标签：android, twitter, oauth, twitter4j, socialauth

每次尝试对 Twitter 进行身份验证并从我的应用程序中发布推文时，我都会遇到问题。我之前使用过 Socialauth 和 Twitter4j 无济于事。有没有人试过这个教程并让它工作？ [http://www.androidhive.info/2012/09/android-twitter-oauth-connect-tutorial/](http://www.androidhive.info/2012/09/android-twitter-oauth-connect-tutorial/)

我的 Facebook 运行良好。似乎 twitter 无缘无故变得复杂得多。任何人都可以推荐在 android 应用程序中使用 twitter 时最好使用哪个库或 jar。

我想做的就是在应用程序中发布一条推文。

有什么建议么 ？

# c# - 使用 Html Helper 创建

> ID：15853486
> 
> 赞同：2
> 
> 时间：2013-04-06T16:49:41.007
> 
> 标签：c#, asp.net-mvc, html-helper

我想创建 Html 助手，仅当用户扮演角色时才会显示内部内容，如下所示：

```
@using(Html.AdminBlock()) {

} 
```

并且块中的代码仅在用户角色时才会显示......

我怎么能做到？

如果你不明白我在这里的意思是什么例子，我希望这两个代码将返回相同的结果：

```
@if(Html.IsUserInRole("Admin")) {
    <span>hey</span>
} 
```

.

```
@using(Htm.RoleBlock()) {
    <span>hey</span>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:17:42.960

使用返回的 HTML 帮助程序无法实现您想要做的事情`IDisposable`。这样做的原因是因为它的主体**总是**会被渲染。您不能有条件地将主体排除在这样的语句中：

```
@using(Htm.RoleBlock()) {
    <span>hey</span>
} 
```

此外，以下内容看起来足够可读：

```
@if(Html.IsUserInRole("Admin")) {
    <span>hey</span>
} 
```

或者您可以编写一个返回布尔值的助手，并且可以像这样使用：

```
@if(Html.IsAdmin()) {
    <span>hey</span>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:58:41.263

## 更新 2

因此，您希望尽可能多地保留视图之外的逻辑，在这种情况下，您可以将 if 条件从视图中拉出并放入`HtmlHelper`扩展方法中。

```
public static class HtmlHelperExtensions
{
    public static bool IsAdmin(this HtmlHelper htmlHelper)
    {
        return htmlHelper.ViewContext.HttpContext.Current.User.IsInRole("admin");
    }
} 
```

用法：

```
@if (Html.IsAdmin()) {
    ...
} 
```

## 更新

如果您只想在用户担任角色时输出某些内容，那么这种帮助者完全是矫枉过正。你应该`if`在你的观点中寻求一个简单的陈述。

```
@if (HttpContext.Current.User.IsInRole("admin")) {
    ...
} 
```

## 制作自定义助手

去年我发布了[一篇关于这个主题的博客文章](http://www.growingwiththeweb.com/2012/09/custom-helper-for-surrounding-block-in.html)`BeginForm()`，我打开了 ASP.NET MVC 源代码，看看它是如何组合在一起的，并且是我自己的。这是亮点，这将允许您`<div>`在 MVC 视图中环绕块。

```
public class MvcDiv : IDisposable
{
    private bool _disposed;
    private readonly FormContext _originalFormContext;
    private readonly ViewContext _viewContext;
    private readonly TextWriter _writer;

    public MvcDiv(ViewContext viewContext)
    {
        if (viewContext == null)
        {
            throw new ArgumentNullException("viewContext");
        }

        _viewContext = viewContext;
        _writer = viewContext.Writer;
        _originalFormContext = viewContext.FormContext;
        viewContext.FormContext = new FormContext();

        Begin();
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    public void Begin()
    {
        _writer.Write("<div>");
    }

    private void End()
    {
        _writer.Write("</div>");
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!_disposed)
        {
            _disposed = true;
            End();

            if (_viewContext != null)
            {
                _viewContext.OutputClientValidation();
                _viewContext.FormContext = _originalFormContext;
            }
        }
    }

    public void EndForm()
    {
        Dispose(true);
    }
} 
```

然后把这个扩展方法放在某处：

```
public static class HtmlHelperExtensions
{
    public static MvcDiv BeginDiv(this HtmlHelper htmlHelper)
    {
        return new MvcDiv(htmlHelper.ViewContext);
    }
} 
```

然后你可以像这样使用它：

```
@using (Html.BeginDiv())
{
    ...
} 
```

# c# - 我应该使用嵌套类还是 IoC 容器？

> ID：15853490
> 
> 赞同：1
> 
> 时间：2013-04-06T16:49:58.033
> 
> 标签：c#, oop, dependency-injection

我有两个类，服务器和客户端。服务器需要在多个线程中实例化客户端，客户端有一个需要提供自定义实现的虚拟成员。我的问题是。Client 类应该是 Server 类的嵌套类，还是我应该使用接口和依赖注入将自定义实现放入 Server 类。现在，Client 类也有许多私有方法，它们提供了一些不应更改的标准逻辑。

```
public class Server
{
    public void DoWork()
    {
        for (var i = 0;i < 10; i++)
        {
            Client client = new Client();
            client.Process(i);
        }
    }
}

public class Client
{
    private void doSomething() 
    { 
       ...
    }

    // Needs to be overridden and provide custom logic
    public virtual string Process(int i)
    {
        return i.ToString();
    }
} 
```

工作示例：

```
public interface IClient
{
    string Process(string message);
}

public abstract class Client : IClient
{
    public virtual string Process(string message)
    {
        return message;
    }
}

public class CustomClient : Client
{
    public CustomClient() { }

    public override string Process(string message)
    {
        return string.Format("Custom Client:{0}", message);
    }
}

public class Server
{
    private Func<IClient> createClient;    

    public Server() { }

    public Server(Func<IClient> client)
    {
        createClient = client;
    }

    public void DoWork()
    {
        for (var i = 0; i < 10; i++)
        {
            IClient = client = createClient();
            client.Process(string.Format("Client #{0}", i));
        }
    }
} 
```

测试程序...您将逐步查看它是否命中了 CustomClient

```
class Program
{
    static void Main(string[] args)
    {
        Func<CustomClient> factory = () => new CustomClient();
        var server = new Server(factory);
        server.DoWork();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:00:52.800

是否应该注入或修复依赖项的问题有一个简单的答案 - 提供作为更改主题的逻辑的类是要注入的候选对象。另一方面，如果您不打算更改逻辑，您可以针对固定类型进行编码，就像使用大多数基类库一样。

您所描述的听起来像是 DI 的场景 - 如果您允许覆盖客户端类，那么您假设更改是可能的。DI 是同时处理依赖和变化的最明显的方法之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T18:07:27.460

如果服务器需要创建客户端，我会将工厂方法传递给服务器以供其使用。所以我会去依赖注入。

例如：您可以将`Server`a 传递给构造函数`Func<IClient>`并将其分配给一个名为的私有字段，比如说，`createClient`然后代替

```
Client client = new Client(); 
```

采用

```
IClient client = createClient(); 
```

这样你就可以完全解耦服务器和客户端。

我更喜欢使用简单的`Func`委托而不是完整的工厂类，因为它 (a) 更易于使用并且 (b) 更松散耦合。

# javascript - 将 jQuery 输入插入表格模板

> ID：15853494
> 
> 赞同：1
> 
> 时间：2013-04-06T16:50:14.900
> 
> 标签：javascript, jquery

我遇到了一些问题，我在 JavaScript 变量中有一个表格模板，如下所示：

```
var myTab= "<table id='mag-1'><tr><td>Name</td><td>"+libellesMag['nom']+"</td></tr></table>"; 
```

where`libellesMag['nom']`是一个包含输入类型文本的 jQuery 变量。

当我`append()`显示这个变量时，我的输入被显示，但是当我尝试将我的变量连接到一个字符串中时，`append()`这个字符串我的`libellesMag['nom']`显示`[Object object]`

你知道如何显示我的输入吗？

编辑：`console.log(libellesMag['nom'])=[input#monapp_homebundle_enseignetype_magasins_1_nomMagasin, prevObject: jQuery.fn.jQuery.init[1], context: div, selector: ":nth-child(2)", jquery: "1.9.1", constructor: function…]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:09:30.340

您需要先将元素添加到父元素，然后在父元素上使用[**.html()**](http://api.jquery.com/html/)，您可以创建一个临时元素用作父元素，以免影响页面的 DOM，如下所示：

```
var myTab= "<table id='mag-1'><tr><td>Name</td><td>" + $('<span>').append(libellesMag['nom']).html() + "</td></tr></table>"; 
```

查看[**工作演示**](http://tinker.io/5d039)

请注意，我使用的 span 元素从未添加到您的 DOM 中，它仅用作您元素的临时父级，因此我们可以`.html()`在其上使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:57:51.737

尝试使用`libellesMag['nom'].val()`，像这样：

```
var myTab= "<table id='mag-1'><tr><td>Name</td><td>"+libellesMag['nom'].val()+"</td></tr></table>"; 
```

# php - MySQL连接两行，两个表，具有相同的字段

> ID：15853496
> 
> 赞同：2
> 
> 时间：2013-04-06T16:50:24.467
> 
> 标签：php, mysql, join, alias

嗨，我是 MySQL 和 PHP 的新手，这是我的第一篇文章。所以请多多包涵。我正在尝试从一个表中添加两个表和两行
`friends`

```
member_ID | friend_ID | status 
```

和一张`user`桌子

```
member_ID | username 
```

我想要做的是将两个表合并为一个朋友请求，`friends.member_ID`是`user.member_ID`发送请求，`friends.member_ID`是`user.member_ID`被请求的，`status`是当他们接受请求时，它将转向`0`这`1`将使关系成为真实。

到目前为止，我有这个用于我的查询以显示所有这些字段以显示谁已将此人请求为朋友

```
SELECT users.member_ID, friends.member_ID, friends.friend_ID, friends.status 
FROM `users` , `friends` 
WHERE friends.status=0   
AND users.member_ID = friends.member_ID
AND friends.member_ID = users.member_ID
AND users.member_ID = 6 (this will be $_SESSION[member_ID] when I add it to php) 
```

我知道您可以使用别名，但我有点困惑

请帮忙，我的作业明天就要交了，还有很多事情要做。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:55:33.307

试试这个加入

```
 SELECT users.member_ID, friends.member_ID, friends.friend_ID, friends.status 
 FROM `users` 
 INNER JOIN `friends` 

 ON users.member_ID = friends.member_ID
 WHERE friends.status=0 
 AND users.member_ID = 6 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:02:13.837

列别名 - 在列名后使用 AS(/as)

```
users.member_ID as uId, friends.member_ID as fId 
```

表别名 - 在表名之后定义

```
users u , friends f 
```

如果使用表别名，您可以在选择列名时使用它们

```
u.member_ID as uId, f.member_ID as fId 
```

[http://dev.mysql.com/doc/refman/4.1/en/problems-with-alias.html](http://dev.mysql.com/doc/refman/4.1/en/problems-with-alias.html)

```
SELECT u.member_ID as uId, f.member_ID as fId, f.friend_ID as ffId, f.status as fStatus
FROM `users` u 
INNER JOIN `friends` f

ON u.member_ID = f.member_ID
WHERE f.status=0 
AND u.member_ID = 6 
```

当您从多个表中选择 2 个或更多具有相同名称的列时，别名很有用 - `users.member_ID, friends.member_ID`。而不是使用模棱两可`$row['member_ID']`或不得不使用`$row[0]/$row[1]`，你可以使用`$row['uID']/$row['fID']`

# c++ - 功能文件结束循环额外循环？C++

> ID：15853499
> 
> 赞同：0
> 
> 时间：2013-04-06T16:50:49.343
> 
> 标签：c++

我正在尝试从文件中读取字符，但是当我使用文件结尾函数时，它循环的次数比文件中的字符数多 1 .. 但我不知道为什么？

```
#include <iostream>
#include <fstream>

int main()
{
    ifstream file;
    char ch1;
        file.open("c:\\Downloads\\test.txt" , ios::in);

    int i=0;
    while(!file.eof())
    {  i++;
        file>>ch1;
                    cout<<ch1<<endl;
          }
           cout <<i<<endl;
file.close();
return 0;
} 
```

文件包含

```
[] 
```

输出 ：`[ ] ] 3`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:53:04.543

好吧，当您读取文件中的最后一个字符时`file.eof()`仍然是错误的，因为流还不知道它已经到达末尾。只有在您尝试读取已经不存在的字符后，才会将 eof 设置为 true。你可能应该这样做

```
char ch;

while(file >> ch)
{
      ... 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T16:53:09.303

原因是因为您还没有到达文件末尾，并不意味着下一次读取会成功。因为您正在读取字符，所以只有在您实际尝试在最后一个字符之后读取时才会设置 EOF。

事实上，即使你从文件中读取字符串、整数或其他类似的东西，也会出现类似的问题。在许多文本文件的末尾是一个额外`\n`的，后面没有文本。所以当读到最后一行时，流中还有a`\n`但是没有设置EOF。然后，您继续阅读下一行，该行不存在您提取的任何内容，其内容与以前相同。这导致似乎是重复读数。

# java - 递归函数的时间复杂度

> ID：15853504
> 
> 赞同：-2
> 
> 时间：2013-04-06T16:51:27.767
> 
> 标签：java, recursion, time-complexity, asymptotic-complexity

我有一个 Java 函数，它接收一个矩阵（二维数组 [] []）并为此数组创建一个更改选项的动态数组，然后为动态数组的每个选项递归地创建一个动态数组。**最终，对于 N 个选项之一中的每个选项，它会创建 N 个其他选项。** 有人告诉我它的时间复杂度函数是T(n)=T(n)*n，这可能吗？大 O 表示法的渐近时间复杂度是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:58:06.570

如果递归关系是 T(n)=nT(n)，则递归永远不会停止。这种递归关系意味着每个子问题与原始问题的大小相同。在递归函数中，如果每个子问题的大小都与原始问题的大小相同，则意味着递归不会结束。从您的问题看来，您的函数在原始矩阵上运行一次，然后在第一个函数应用程序的结果上运行一次，然后停止。这不是一个真正的递归函数，也不真正适合计算时间复杂度的递归关系模型。不过，计算时间复杂度也非常简单，因为您实际上可以将所有计算加起来。

# php - 通过 javascript 将表单值传递给另一个 php 类

> ID：15853512
> 
> 赞同：0
> 
> 时间：2013-04-06T16:52:06.077
> 
> 标签：php, javascript, html, image, forms

我的网站有一个 MyAccount 页面，该页面将有一个允许用户上传图像的表单。

```
<from action='javascript:uploadFile'>
     <input type='file' name='Upload'>
</form> 
```

我想做的是让它调用另一个 .php 文件，例如：

```
<script type="text/javascript">
    function uploadFile()
    {
         addPhoto.php giving files $id and Upload (from the form)
    } 
```

在用户实际离开 MyAccount 页面的情况下，如何实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T16:54:52.453

您可以在 PHP 文件中使用`include`或使用。`require`

> 该`include`语句包括并评估指定的文件。

你需要 AJAX/jQuery 来通过 JavaScript 调用它。

[文档](http://php.net/manual/en/function.include.php)

# algorithm - 模拟退火算法中的邻居选择

> ID：15853513
> 
> 赞同：9
> 
> 时间：2013-04-06T16:52:36.283
> 
> 标签：algorithm, artificial-intelligence, simulated-annealing

选择邻居时应该考虑算法的温度吗？因此，例如，如果在挑选邻居时温度很高，应该进行排列吗？还是温度只影响接受概率？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T17:44:04.743

后者是正确的：只有接受概率受温度影响。温度越高，越“坏”的动作被接受以逃避局部最优。如果您预先选择具有低能量值的邻居，您基本上会与模拟退火的想法相矛盾，并将其变成贪婪搜索。

[来自维基百科](http://en.wikipedia.org/wiki/Simulated_annealing)的伪代码：

```
s ← s0; e ← E(s)                                  // Initial state, energy.
sbest ← s; ebest ← e                              // Initial "best" solution
k ← 0                                             // Energy evaluation count.
while k < kmax and e > emax                       // While time left & not good enough:
  T ← temperature(k/kmax)                         // Temperature calculation.
  snew ← neighbour(s)                             // Pick some neighbour.
  enew ← E(snew)                                  // Compute its energy.
  if P(e, enew, T) > random() then                // Should we move to it?
    s ← snew; e ← enew                            // Yes, change state.
  if enew < ebest then                            // Is this a new best?
    sbest ← snew; ebest ← enew                    // Save 'new neighbour' to 'best found'.
  k ← k + 1                                       // One more evaluation done
return sbest                                      // Return the best solution found. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-11T20:27:34.330

这是来自维基百科的描述，其中指出实际上应该针对某些问题计算温度。

> **高效的候选生成**
> 
> 启发式的更精确的陈述是，应该尝试第一个候选状态 s'，其中 P(E(s), E(s'), T) 很大。对于上面的“标准”接受函数 P，它意味着 E(s') - E(s) 在 T 或更少的数量级上。因此，在上面的旅行推销员示例中，可以使用交换两个随机城市的 neighbour() 函数，其中**选择城市对的概率随着距离增加超过 T 而消失。**

这确实意味着在确定邻居时温度可能是相关因素。

更多关于如何编写邻域函数的有用读物：[How to Effective select neighbor in 1-dimensional and n-dimensional space for Simulated Annealing](https://stackoverflow.com/questions/30786439/how-to-efficiently-select-neighbour-in-1-dimensional-and-n-dimensional-space-for)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-10T08:39:40.673

我也有同样的问题，但我认为[Python 中模拟退火基础的](https://stackoverflow.com/questions/19757551/basics-of-simulated-annealing-in-python#comment29395600_19759101)另一篇文章的答案表明 T 可能与选择邻居有关是非常合理的。

> 选择邻居也将取决于您的问题。限制邻里的主要原因是，一旦你找到了一个不错的解决方案，即使你后来转向更糟糕的解决方案，你至少也留在附近。直觉是大多数目标函数都有些平滑，因此好的解决方案将靠近其他好的解决方案。因此，您需要一个足够小的社区，让您靠近好的解决方案，但又足够大，让您可以快速找到它们。您可以尝试的一件事是随着时间的推移减少邻域（例如，使其与温度成正比）。– 2013 年 11 月 4 日 20:58

# java - 永恒的工作线程在Android中运行多长时间？

> ID：15853524
> 
> 赞同：1
> 
> 时间：2013-04-06T16:53:19.663
> 
> 标签：java, android

嗨，我在 android 的主线程上创建了一个线程，它永远运行以执行一些后端操作。那么这个线程运行多长时间？它是在活动的“onCreate”方法中创建的。那么android是在一段时间后自动杀死这些线程还是在我们手动杀死它们之前一直运行？或者当我们切换到另一个应用程序时它会自动被杀死？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T16:56:16.980

希望你知道 android Activity 的生命周期。Android 结束了长时间不使用的进程。是的，如果它在后台，它会在一段时间后被杀死。如果用户离开您的应用程序，您的应用程序中的 Activity 实例会在其生命周期中切换到不同的状态。如果您启动另一个活动或切换到另一个应用程序，Android`onPause`会在您的活动进入后台时调用另一个生命周期方法。

如果活动保持隐藏一段时间，它会自动结束。您无需手动结束它。安卓是不是很棒？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T18:17:24.027

> 嗨，我在 android 的主线程上创建了一个线程，它永远运行以执行一些后端操作。那么这个线程运行多长时间？

没有什么是永远运行的。甚至没有`Service`。任何运行足够长的时间都可能被 Android 杀死。

使用 an并使用 an和 a`AlarmManager`安排您的任务。将每 X 秒/分钟调用一次服务。`IntentService``BroadcastReceiver``AlarmManager`

看看这个与在 Android 上调度重复任务有关的问题 - 在 Android[中调度重复任务](https://stackoverflow.com/questions/14376470/scheduling-recurring-task-in-android)

# macos - 为什么 cabal-install 不自行升级？

> ID：15853525
> 
> 赞同：2
> 
> 时间：2013-04-06T16:53:22.803
> 
> 标签：macos, haskell, cabal, haskell-platform, cabal-install

当我进行 cabal 更新时，我得到以下输出：

```
Downloading the latest package list from hackage.haskell.org
Note: there is a new version of cabal-install available.
upgrade, run: cabal install cabal-install 
```

所以我跑

```
cabal install cabal-install 
```

但是，在我跑步之后

```
cabal update 
```

关于新版本的 cabal-install，我仍然得到相同的说明。

当我跑

```
cabal --version 
```

我得到以下输出：

```
cabal-install version 0.14.0
using version 1.14.0 of the Cabal library 
```

然而，在

```
/~/Library/Haskell/ghc-7.4.2/lib 
```

我只有这两个项目：

```
Cabal-1.16.0.3      cabal-install-1.16.0.2 
```

为什么我会有这种不一致？

我在 Mac OSX v. 10.8.3 上运行

# c++ - 文件支持的内存映射的 CPU 缓存行为/策略？

> ID：15853526
> 
> 赞同：15
> 
> 时间：2013-04-06T16:53:23.873
> 
> 标签：c++, x86, operating-system, cpu-architecture, cpu-cache

有谁知道现代 x86 系统上的内存映射*文件支持区域分配了哪种类型的 CPU 缓存行为或策略（例如不可缓存的写入组合）？*

有什么方法可以检测是哪种情况，并可能覆盖默认行为？

Windows 和 Linux 是人们感兴趣的主要操作系统。

（编者注：这个问题以前被表述为[memory mapped I/O](https://en.wikipedia.org/wiki/Memory-mapped_I/O)，但该短语具有不同的特定技术含义，尤其是在谈论 CPU 缓存时。即实际的 I/O 设备，如 NIC 或与负载交谈的视频卡/ 商店。

`mmap(some_fd, ...)`这个问题实际上是关于当您不使用 MAP_ANONYMOUS 并且它由磁盘上的常规文件支持时，您从哪种内存中获得。）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-07T17:20:31.577

TL:DR 内存映射文件对它们映射到进程地址空间的页面缓存页面使用正常的回写策略。如果您想要不是 WB 的页面，您必须做一些特殊的和特定于操作系统的事情。

* * *

应用于地址空间区域的缓存策略通常与操作系统无关，并且仅取决于地址空间页面后面的设备类型。事实上，操作系统可以自由地将任何缓存策略应用于任何内存区域，但错误分配的缓存策略会降低系统性能或完全破坏系统逻辑。

至少有四种缓存策略：

1.  **完全缓存（回写，又名 WB）**。应用于映射到主存 (RAM) 的物理地址空间。用于提高内存子系统性能的性能。这种设备的主要特性是它的状态只能由软件改变，并且只能影响软件。

    **内存映射文件实现使用完全缓存**，因为它们完全由软件（操作系统）实现，从磁盘读取文件块并将其放置在内存中，然后将该块（可能已修改）放回磁盘。硬件更新页表中的“脏”位，以让操作系统找出需要同步到磁盘的内容。

2.  **直写式缓存。(WT)** 此类设备的主要属性是其状态只能通过软件更改，但更改必须立即对设备产生影响。根据该策略，写入内存映射IO设备寄存器的数据将同时放置在两个地方：缓存中和设备中。但是当开始读取数据时，数据将从缓存中捕获，而无需昂贵的设备访问。

    这种缓存策略对于不写入内存、只读取 CPU 写入内容的 MMIO 设备可能很有用。在实践中，它很少用于任何事情。GPU不是那样的，并且会写入视频内存，因此它不用于视频RAM。（GPU 没有使该区域的 CPU 缓存失效的机制，因为 GPU 不是 CPU 缓存一致性域的一部分）

3.  **Uncacheable, write-combining (WC aka USCW)**：弱排序内存，通常用于映射视频 RAM。与不可缓存类似，只是 NT 存储可以让您一次有效地写入整个缓存行。 [`movntdqa`加载让您可以有效地读取整个缓存行](https://software.intel.com/en-us/articles/copying-accelerated-video-decode-frame-buffers)，这是您无法从 WC 区域执行的任何其他方式。正常加载为每个加载单独获取数据，即使在同一行中，因为它是不可缓存的。
4.  **禁用缓存。(UC)** 适用于几乎所有的 IO 设备，因为写入内存映射的 IO 设备寄存器必须立即生效，从内存映射的 IO 设备寄存器读取必须从设备返回给读取器的实际数据。如果缓存将应用于内存映射的 IO 设备，则会引入两个负面影响：
    1.  写入内存映射的 IO 设备寄存器将被延迟，直到缓存控制器决定用写入的数据刷新缓存行。结果，驱动程序将无法知道写入设备的命令何时生效。
    2.  可以缓存从内存映射的 IO 设备寄存器读取的数据。从同一个内存映射的 IO 设备寄存器读取的后续数据可能不会从设备返回实际数据，而是从缓存中返回过时的数据。因此，驱动程序很难捕获设备的实际状态。

由于软件可以指定缓存策略的方式仅取决于处理器，因此可以在任何操作系统中应用相同的算法。最简单的方法是捕获 CR3 寄存器的内容，并使用它找到与您想知道的缓存策略地址对应的页表条目，并检查 PCD 和 PWT 标志。但是这种方式并不完整，因为几乎没有其他功能会影响缓存（例如，可以在 CR0 上完全禁用缓存，另请参阅 MTRR、PAT）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T23:28:31.837

添加到 ZarathustrA 的现有答案：在 Windows 上，`SEC_NOCACHE`关闭此缓存。有一个`SEC_WRITECOMBINE`, 但它似乎已损坏（它仅适用于`SEC_RESERVE`or `SEC_COMMIT`，这意味着仅适用于页面文件，并且您不想对其进行设置`SEC_WRITECOMBINE`）。

# android - 获取触摸事件时如何禁用移动阈值？

> ID：15853528
> 
> 赞同：10
> 
> 时间：2013-04-06T16:53:32.567
> 
> 标签：android, events, touch, threshold

我正在创建一个使用触摸输入的 Android 游戏。我注意到，当我放下手指并移动它时，在`MotionEvent.ACTION_MOVE` 生成第一个像素之前，会有几个像素的阈值。禁用此阈值过滤器的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T11:21:10.773

它被称为触摸斜率。这里已经回答了同样的问题：[Android ACTION_MOVE 阈值](https://stackoverflow.com/questions/6785068/android-action-move-threshold)

# .net - Wpf 样式在设计器中应用但在运行时不应用

> ID：15853529
> 
> 赞同：2
> 
> 时间：2013-04-06T16:53:36.640
> 
> 标签：.net, wpf

**我有三个 xaml 文件。**

1.  Button.xaml（按钮样式）
2.  Default.xaml（主题文件）（包括按钮的合并资源文件）
3.  MainWindo.xaml（使用 default.xaml 资源字典）。

**按钮.xaml：**

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

<ControlTemplate x:Key="ButtonControlTemplate" TargetType="Button">
    <Border Name="Back" >
        <Border.Background>
            <ImageBrush ImageSource="..\Images\ButtonBackground.png" />
        </Border.Background>
        <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center" />
    </Border>
    <ControlTemplate.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
            <Setter TargetName="Back" Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="0" Direction="0"               
                                             BlurRadius="15"Color="#D3F80A" Opacity="1"/>
                </Setter.Value>
            </Setter>
        </Trigger>
    </ControlTemplate.Triggers>
</ControlTemplate>

<Style TargetType="{x:Type Button}">
    <Setter Property="Template" Value="{StaticResource ButtonControlTemplate}" />
</Style>

 </ResourceDictionary> 
```

**默认.xaml：**

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:primatives="clr-namespace:System.Windows.Controls;assembly=PresentationFramework">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Controls\Button.xaml"></ResourceDictionary>
    </ResourceDictionary.MergedDictionaries>

</ResourceDictionary> 
```

**MainWindow.xaml：**

```
<Window x:Class="RemoteDesktop.GUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="375" Width="195" WindowStyle="None" Topmost="True" AllowsTransparency="True" Background="Transparent" WindowStartupLocation="CenterScreen" ResizeMode="NoResize" 
        TextOptions.TextFormattingMode="Ideal"
        >
    <Window.Resources>

        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source=".\Themes\Default\Default.xaml" />
            </ResourceDictionary.MergedDictionaries>

        </ResourceDictionary>

    </Window.Resources>

    <Border x:Name="border" Margin="10" CornerRadius="10,10,10,10" BorderBrush="#111111" BorderThickness="0">
        <Border.Background>
            <ImageBrush ImageSource=".\Resources\Background.png" Stretch="Fill" />
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect ShadowDepth="0" Direction="0" BlurRadius="15" Color="Black" Opacity="1"/>
        </Border.Effect>
        <Grid  >
            <Grid.ColumnDefinitions>
                <ColumnDefinition ></ColumnDefinition>
                <ColumnDefinition Width="58" ></ColumnDefinition>
                <ColumnDefinition Width="10" ></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="33" />
                <RowDefinition Height="15"/>
                <RowDefinition Height="33" />
                <RowDefinition Height="15"/>
                <RowDefinition Height="33"/>
                <RowDefinition Height="23"/>
                <RowDefinition Height="33"/>
            </Grid.RowDefinitions>
            <Border Background="Transparent" Name="titleBorder" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" MouseLeftButtonDown="titleBorder_MouseLeftButtonDown">
                <Label Foreground="LightGray" TextOptions.TextHintingMode="Animated" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Center" >Please Log In</Label>
            </Border>
            <TextBox Grid.Row="2" Grid.Column="0" Width="148" Height="32" Grid.ColumnSpan="3" >
                Email
            </TextBox>
            <TextBox Grid.Row="4" Grid.Column="0" Width="148" Height="32" Grid.ColumnSpan="3" >
                Password
            </TextBox>
            <Button  Name="btn"  Grid.Row="6" Grid.Column="1" BorderThickness="0" Foreground="#232323" Content="Sign In" TextOptions.TextHintingMode="Animated" BorderBrush="{x:Null}" >

                <!--<Button.Style>
                    <Style TargetType="Button">

                        <Setter Property="OverridesDefaultStyle" Value="True"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type Button}">
                                    <Border Name="Back" >
                                        <Border.Background>
                                            <ImageBrush ImageSource=".\Resources\ButtonBackground.png" />
                                        </Border.Background>
                                        <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center" Text="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}"  ></TextBlock>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Back" Property="Effect">
                                                <Setter.Value>
                                                    <DropShadowEffect ShadowDepth="0" Direction="0" BlurRadius="15" Color="#D3F80A" Opacity="1"/>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>

                            </Setter.Value>
                        </Setter>

                    </Style>
                </Button.Style>-->

            </Button>
        </Grid>
    </Border>
</Window> 
```

上面的窗口按钮样式在设计时应用，但运行时会重置为默认状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T18:12:48.587

我看到你有

根目录\控件\button.xaml

根目录\主题\默认\default.xaml

根目录\mainwindow.xaml

所以这是事情

在 default.xaml 中，您必须转到后面的目录才能访问您的按钮控件，如下所示

```
<ResourceDictionary Source="..\..\Controls\Button.xaml"></ResourceDictionary> 
```

# javascript - 如何使用变量中的位置在 Google 地图上获取图钉？

> ID：15853530
> 
> 赞同：0
> 
> 时间：2013-04-06T16:54:14.767
> 
> 标签：javascript, google-maps-api-3, maps, google-maps-markers

我想用一个包含位置的变量将图钉放在我的谷歌地图地图上，当我这样制作时，我的图钉就可以工作了。

```
var imageDriver = 'marker.png';
var DriverLatLng = new google.maps.LatLng(62.446026, 17.331340);
var driverMarker = new google.maps.Marker({
    position: DriverLatLng,
    map: map,
    icon: imageDriver, 
```

但我想使用这种方法，将纬度和经度存储在一个变量中：

```
var location = "62.446026, 17.331340";
var imageDriver = 'marker.png';
var DriverLatLng = new google.maps.LatLng(location);
var driverMarker = new google.maps.Marker({
    position: DriverLatLng,
    map: map,
    icon: imageDriver, 
```

当我做第二个片段时，图钉就消失了。这是什么原因造成的？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T17:01:51.240

该`google.maps.LatLng()`函数不接受字符串参数。它采用以下参数：

```
lat    : number
lng    : number 
noWrap : boolean // Optional 
```

这记录在这里：[https ://developers.google.com/maps/documentation/javascript/reference#LatLng](https://developers.google.com/maps/documentation/javascript/reference#LatLng)

您可以这样存储纬度和经度：

```
var location = { 
    lat: 62.446026, 
    lng: 17.331340 
};

var imageDriver = 'marker.png';
var DriverLatLng = new google.maps.LatLng(location.lat, location.lng);
var driverMarker = new google.maps.Marker({
    position: DriverLatLng,
    map: map,
    icon: imageDriver, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T17:00:56.863

`google.maps.LatLng()`需要 2 个数值，您正在尝试使用字符串对其进行初始化。

您可以将字符串拆分为一个数组，然后将数组内的两个字符串解析为 float 以获取 long 和 lat 值：

```
location = location.split(',');
var DriverLatLng = new google.maps.LatLng(parseFloat(location[0]),parseFloat(location[1]));
.... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T17:03:24.347

问题是您在第二个实例中为您的 LatLng 构造函数提供了一个字符串。这是不正确的，并且不起作用 - 这就是您没有看到图钉的原因。在第一种情况下，你给它两个数字，这很好。

您可以在此处查看文档：[https](https://developers.google.com/maps/documentation/javascript/reference#LatLng)

://developers.google.com/maps/documentation/javascript/reference#LatLng 要做您想做的事情，您可以有两个变量（它们是数字）：

```
var locationLat = 62.446026;
var locationLng = 17.331340;
var DriverLatLng = new google.maps.LatLng(locationLat,locationLng); 
```

...或者你可以做他们在这个答案中所做的事情：[Convert String to latlng google maps](https://stackoverflow.com/questions/6778061/convert-string-to-latlng-google-maps)，如果你决定将你的纬度和经度保留在一个字符串中。
...或者，如果您想要一个变量，您可以创建一个新对象并将 latlng 分配给它：

```
var myLatLng = new Object();
myLatLng.lat = 62.446026;
myLatLng.lng = 17.331340; 
```

...或者，在构建了 google LatLng 对象之后，您可以稍后从中获取 lat 和 lng，如下所示：

```
 var myLatLng = new google.maps.LatLng(62.446026, 17.331340);
// some other stuff here
var myStringLatLng = myLatLng.lat() + ',' + myLatLng.lng(); 
```

我想最好的选择取决于你想要做什么！

# iphone - 调整 tableview 的第一个可见节标题高度

> ID：15853533
> 
> 赞同：1
> 
> 时间：2013-04-06T16:54:28.913
> 
> 标签：iphone, ios, objective-c, uitableview

我创建了一个`UITableView`包含自定义部分标题视图。现在，我希望它在最上面的当前可见部分显示更多数据。我计划使用该事件`scrollViewDidEndDecelerating`来更新节标题。目前，问题是我无法为特定节号设置节标题高度。

我确实尝试过使用`heightForHeaderInSection`，但应用程序只是崩溃并显示以下输出：

`'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 0 beyond bounds for empty array'`

我正在使用代码：

```
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    if (tableView == self.tableView)
    {
        NSArray *visibleCells = [self.tableView visibleCells];
        NSMutableArray *visibleSections = [[NSMutableArray alloc] init];
        for (NSInteger index = 0; index < [visibleCells count]; index++)
        {
            UITableViewCell *currentCell = [visibleCells objectAtIndex:index];
            NSIndexPath *currentPath = (NSIndexPath *)[self.tableView indexPathForCell:currentCell];
            if (![visibleSections containsObject:[NSNumber numberWithInt:currentPath.section]])
            {
                [visibleSections addObject:[NSNumber numberWithInt:currentPath.section]];
                NSLog([NSString stringWithFormat:@"%ld", (long)[visibleSections count]]);
                [visibleSections sortedArrayUsingDescriptors:[NSArray arrayWithObject:[[NSSortDescriptor alloc] initWithKey:nil ascending:YES]]];
            }
        }
        if (visibleSections == nil)
        {
            return 42.0;
        }
        else if ([[visibleSections objectAtIndex:0] integerValue] == section)
        {
            return 58.0;
        }
        else
        {
            return 42.0;
        }
    }
} 
```

我无法完全弄清楚我的`heightForHeaderInSection`方法出了什么问题，但我知道它与`NSMutableArray`, visibleSections 有关。

关于如何更改外部特定部分标题视图的高度`heightForHeaderInSection`和/或如何修复上面的代码的任何提示或答案将非常有帮助。

**编辑：**

只是为了让我的崩溃问题的解决方案更清楚一点，`if (visibleSections == nil)`不应该用来代替`if ([visibleSections count] < 1)`or `if ([visibleSections count] == 0)`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:08:15.383

我认为您也可以这样做，如果您希望在表格首次出现时第一节标题更高（topSection 是一个 NSInteger 属性）：

```
-(void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView {
    self.topSection = ((NSIndexPath *)[self.tableView indexPathsForVisibleRows][0]).section;
    [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:self.topSection] withRowAnimation:NO];
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {

        if (self.topSection == section)
        {
            return 58.0;
        }
        else
        {
            return 42.0;
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:04:49.337

您不能通过调用 objectAtIndex:0 直接引用数组第一个对象，您必须保持防御，因此请更改此：

```
else if ([[visibleSections objectAtIndex:0] integerValue] == section)
    {
        return 58.0;
    } 
```

到

```
else if([visibleSections count]>0)
    {
      if ([[visibleSections objectAtIndex:0] integerValue] == section)
        {
           return 58.0;
        }
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T21:37:24.760

好的，事实证明这是一个比最初看起来更难的问题。到目前为止我想出的最好的是

*   不要对顶部的标题进行任何不同的处理，并用额外的数据填充它们。
*   您可以通过巧妙地定位“附加”项目来显示和隐藏不同的部分，以便它们在父视图较小时超出父视图的边界并制作父视图`clipToBounds`。
*   如果您无法创建自定义`UIView`子类并在`layoutSubviews`

我决定的最终实现是这样的

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
  NSArray *indexPaths = [self.tableView indexPathsForVisibleRows];
  self.topSection = [indexPaths count] ? [indexPaths[0] section] : -1;
  if (indexPaths.count > 1) {
    self.topSection = [indexPaths[1] section];
  }

  [self.tableView beginUpdates];
  [self.tableView endUpdates];
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section;
{
  if (section <= self.topSection) {
    return 60;
  } else {
    return 20;
  }
} 
```

它绝不是完美的，但它看起来是半合理的，可以调整。

注意事项：

*   您可能需要评估是否有太多的工作正在进行，`scrollViewDidScroll:`但它似乎并没有对我造成任何滞后（我没有真正正确地测试过）
*   如果可用，我使用第二个设置顶部，`indexPath`因为它看起来更令人愉悦/不那么笨重
*   我之所以使用`section <= self.topSection`，是因为标题的前面都是屏幕，所以没有必要减小它们的大小，这会导致动画非常笨拙。

因此，在尝试此操作后，您可能需要更深入地挖掘或想要重新考虑您的设计

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-06T17:02:01.710

尝试更改此行：

```
NSMutableArray *visibleSections = [[NSMutableArray alloc] init] 
```

到：

```
NSMutableArray *visibleSections = [NSMutableArray array]; 
```

初始化数组。

# html5-canvas - Mouseup 事件在 Scaled KineticJS 层间断

> ID：15853541
> 
> 赞同：0
> 
> 时间：2013-04-06T16:55:08.720
> 
> 标签：html5-canvas, kineticjs

例如，请参见此处：

[http://jsfiddle.net/tigz_uk/B8UDq/45/embedded/result/](http://jsfiddle.net/tigz_uk/B8UDq/45/embedded/result/)

小提琴代码：

[http://jsfiddle.net/tigz_uk/B8UDq/45/](http://jsfiddle.net/tigz_uk/B8UDq/45/)

最相关的片段：

```
function whenAreaSelected(stage, layer, image) {
    var rect, down = false;
    var eventObj = layer;
    eventObj.off("mousedown");
    eventObj.off("mousemove");
    eventObj.off("mouseup");
    eventObj.on("mousedown", function (e) {
        console.log("Mousedown...");
        if (rect) {
            rect.remove();
        }            
        var relativePos = getRelativePos ( stage, layer);

        down = true;
        var r = Math.round(Math.random() * 255),
            g = Math.round(Math.random() * 255),
            b = Math.round(Math.random() * 255);
        rect = new Kinetic.Rect({
            x: relativePos.x,
            y: relativePos.y,
            width: 11,
            height: 1,
            fill: 'rgb(' + r + ',' + g + ',' + b + ')',
            stroke: 'black',
            strokeWidth: 4,
            opacity: 0.3
        });
        layer.add(rect);
    });

    eventObj.on("mousemove", function (e) {
        if (!down) return;
        var relativePos = getRelativePos ( stage, layer );
        var p = rect.attrs;

        rect.setWidth(relativePos.x - p.x);
        rect.setHeight(relativePos.y - p.y);
        layer.draw();
    });

    eventObj.on("mouseup", function (e) {
        console.log("Mouse Up...");
        down = false;
        var p = rect.attrs;
        var s = layer.getScale();
        console.log("Rect x: " + p.x + " y: " + p.y + " width: " + p.width + " height: " + p.height + " sx: " + s.x + " sy: " + s.y);
    });
}

var stageWidth = 1024;
var stageHeight = 700;
var imageWidth = 1299;
var imageHeight = 1064;

var initialScale = calcScale(imageWidth, imageHeight, stageWidth, stageHeight);

var stage = new Kinetic.Stage({
    container: "canvas",
    width: stageWidth,
    height: stageHeight
});

var layer = new Kinetic.Layer();

var imageObj = new Image();
imageObj.onload = function () {
    var diagram = new Kinetic.Image({
        x: -500,
        y: -500,
        image: imageObj,
        width: imageWidth,
        height: imageHeight
    });

    layer.add(diagram);
    layer.setScale(initialScale);

    whenAreaSelected(stage, layer, diagram);

    layer.draw();
}

var zoom = function (e) {
    var zoomAmount = e.wheelDeltaY * 0.001;
    layer.setScale(layer.getScale().x + zoomAmount)
    layer.draw();
}

document.addEventListener("mousewheel", zoom, false);

stage.add(layer);

imageObj.src = 'https://dl.dropbox.com/u/746967/Serenity/MARAYA%20GA.png'; 
```

在我看来，mouseup 事件充其量是间歇性的。

知道这里发生了什么吗？当图像偏移而不是显示在 0,0 时，它似乎也更糟。而且我认为这与图层的缩放有关，因为它在比例 1 上一切正常。

这是动力学错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:03:52.190

**尝试在 mousemove 处理程序中使用 layer.drawScene() 而不是 layer.draw()**

```
eventObj.on("mousemove", function (e) {
    if (!down) return;
    var relativePos = getRelativePos ( stage, layer );
    var p = rect.attrs;

    rect.setWidth(relativePos.x - p.x);
    rect.setHeight(relativePos.y - p.y);

    // try drawScene() instead of draw()

    layer.drawScene();
}); 
```

[根据此处从 user814628 转发的信息进行编辑：绑定 MouseMove 事件导致与触发鼠标释放事件不一致

# knockout.js - 淘汰赛未在单选按钮上设置初始真值

> ID：15853556
> 
> 赞同：9
> 
> 时间：2013-04-06T16:56:56.873
> 
> 标签：knockout.js

名称+复选框的单向绑定工作正常，但它最初不适用于单选按钮employeeTypeA，尽管它在viewmodel中的值为true，html显示单选按钮未设置，为什么会这样？

```
 <script type="text/javascript">

        $(function()
        {
            var PersonViewModel = function()
            {
                this.firstName = ko.observable('Lisa');
                this.lastName = ko.observable('T');
                this.isCustomer = ko.observable(true);
                this.employeeTypeA = ko.observable(true);
                this.employeeTypeB = ko.observable(false);
            };

            var personViewModel = new PersonViewModel();
            ko.applyBindings(personViewModel, $('data').get(0));
        });
    </script>

    <div id="data">
        <span data-bind="text: firstName"></span>
        <span data-bind="text: lastName"></span>
        <input type="checkbox" data-bind="checked: isCustomer" title="Is a customer" />
        <input name="x" type="radio" data-bind="checked: employeeTypeA" title="Employee type A" />
        <input name="x" type="radio" data-bind="checked: employeeTypeB" title="Employee type B" />
    </div> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-06T17:14:42.097

从文档中，单选按钮的`checked`绑定工作方式不同：

> `value`对于单选按钮，当且仅当参数值等于单选按钮节点的属性时，KO 将设置要检查的元素。

所以你需要改变你`PersonViewModel`的东西是这样的：

```
var PersonViewModel = function()
{
    this.firstName = ko.observable('Lisa');
    this.lastName = ko.observable('T');
    this.isCustomer = ko.observable(true);
    this.employeeType = ko.observable('TypeB');                
}; 
```

还有你的单选按钮：

```
<input name="x" type="radio" data-bind="checked: employeeType" 
       value="TypeA" title="Employee type A" />
<input name="x" type="radio" data-bind="checked: employeeType" 
       value="TypeB" title="Employee type B" /> 
```

演示[JSFiddle。](http://jsfiddle.net/xKcQs/)

如果你想保留`employeeTypeA`and`employeeTypeB`属性，你可以引入一个返回类型的计算属性：

```
this.employeeTypeA = ko.observable(false);
this.employeeTypeB = ko.observable(true);
this.employeeType = ko.computed(function()
{
     if (this.employeeTypeA())
        return 'TypeA';
     if (this.employeeTypeB())
        return 'TypeB';
},this); 
```

Also in this case you need to add the `value` attributes on your radio buttons.

Demo [JSFiddle.](http://jsfiddle.net/uugjH/)

# java - struts2 jquery ajax 从服务器返回数据，如何？

> ID：15853558
> 
> 赞同：1
> 
> 时间：2013-04-06T16:57:14.380
> 
> 标签：java, struts2, struts, struts2-jquery, actionresult

我想从 action 方法中返回一行。我的 JSP 在下面

```
<%@ taglib prefix="s" uri="/struts-tags"%>
<%@ taglib prefix="sj" uri="/struts-jquery-tags"%>
<html>
  <head>
    <sj:head/>
  </head>
  <body>
    <div id="div1">Div 1</div>
    <s:url id="ajaxTest" value="/test.action"/>

    <sj:a id="link1" href="%{ajaxTest}" targets="div1">
      Update Content
    </sj:a>
  </body>
</html> 
```

**那个行动：**

```
@Action(value="test")
    public String jquery() throws IOException
    {
       System.out.println("hello");
        return SUCCESS;
    } 
```

目前，我将输出视为成功，我认为这是由于 return `SUCCESS`。我需要的是弹出一些从测试操作发送的自定义文本。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:14:47.090

传统上，要从操作中返回某些内容，您需要将结果注释放在操作或方法上

```
@Result(location = "/pages/success.jsp") 
```

在结果中，您编写将插入目标中的标记。您可能需要提供 http 标头以在页面未重新加载时关闭缓存控制。

处理您需要执行的操作的响应`ServletResponseAware`。

# css - 带有普通按钮的 CSS 下拉菜单

> ID：15853559
> 
> 赞同：1
> 
> 时间：2013-04-06T16:57:14.500
> 
> 标签：css

问题是我的悬停适用于所有按钮，但我不希望这样。例如，我想要的是有两个不需要悬停的按钮，因此它们能够将您转移到另一个页面，以及另一个像现在一样悬停的按钮。

CSS：

```
#wrapper {
    width:173px; 
    margin: 0 3px 0 0;
    display: inline-block;
/*  width: 220px;
    margin: 100px auto;
    font-size: 0.8125em;*/
}
.menu {
    width: auto;
    height: auto;
    -webkit-box-shadow: 0px 1px 3px 0px rgba(0,0,0,.73), 0px 0px 18px 0px rgba(0,0,0,.13);
    -moz-box-shadow: 0px 1px 3px 0px rgba(0,0,0,.73), 0px 0px 18px 0px rgba(0,0,0,.13);
    box-shadow: 0px 1px 3px 0px rgba(0,0,0,.73), 0px 0px 18px 0px rgba(0,0,0,.13);
}
.menu > li > a {
    background-color: #616975;
    background-image: -webkit-gradient(linear, left top, left bottom, from(rgb(114, 122, 134)),to(rgb(80, 88, 100)));
    background-image: -webkit-linear-gradient(top, rgb(114, 122, 134), rgb(80, 88, 100));
    background-image: -moz-linear-gradient(top, rgb(114, 122, 134), rgb(80, 88, 100));
    background-image: -o-linear-gradient(top, rgb(114, 122, 134), rgb(80, 88, 100));
    background-image: -ms-linear-gradient(top, rgb(114, 122, 134), rgb(80, 88, 100));
    background-image: linear-gradient(top, rgb(114, 122, 134), rgb(80, 88, 100));
    filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,StartColorStr='#727a86', EndColorStr='#505864');
    border-bottom: 1px solid #33373d;
    -webkit-box-shadow: inset 0px 1px 0px 0px #878e98;
    -moz-box-shadow: inset 0px 1px 0px 0px #878e98;
    box-shadow: inset 0px 1px 0px 0px #878e98;
    width: 100%;
    height: 2.75em;
    line-height: 2.75em;
    display: block;
    position: relative;
    font-weight: 600;
    color: #fff;
    text-shadow: 0px 1px 0px rgba(0,0,0,.5);
}
.menu ul li a {
    background: #fff;
    border-bottom: 1px solid #efeff0;
    width: 100%;
    height: 2.75em;
    line-height: 2.75em;
    display: block;
    position: relative;
    font-size: 0.923em;
    font-weight: 400;
    color: #878d95;
}
.menu ul li:last-child a {
    border-bottom: 1px solid #33373d;
}
.menu > li hr > a:hover, 
.menu > li > a.active {
    background-color: #35afe3;
    background-image: -webkit-gradient(linear, left top, left bottom, from(rgb(69, 199, 235)),to(rgb(38, 152, 219)));
    background-image: -webkit-linear-gradient(top, rgb(69, 199, 235), rgb(38, 152, 219));
    background-image: -moz-linear-gradient(top, rgb(69, 199, 235), rgb(38, 152, 219));
    background-image: -o-linear-gradient(top, rgb(69, 199, 235), rgb(38, 152, 219));
    background-image: -ms-linear-gradient(top, rgb(69, 199, 235), rgb(38, 152, 219));
    background-image: linear-gradient(top, rgb(69, 199, 235), rgb(38, 152, 219));
    filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,StartColorStr='#45c7eb', EndColorStr='#2698db');
    border-bottom: 1px solid #103c56;
    -webkit-box-shadow: inset 0px 1px 0px 0px #6ad2ef;
    -moz-box-shadow: inset 0px 1px 0px 0px #6ad2ef;
    box-shadow: inset 0px 1px 0px 0px #6ad2ef;
}
.menu > li > a.active {
    border-bottom: 1px solid #1a638f;
}
.menu > li > a:before {
    content: '';
    background-image: url(../images/sprite.png);
    background-repeat: no-repeat;
    font-size: 36px;
    height: 1em;
    width: 1em;
    position: absolute;
    left: 0;
    top: 50%;
    margin: -.5em 0 0 0;
}
.item1 > a:before {
    background-position: 0 0;
}
.item2 > a:before {
    background-position: -38px 0;
}
.item3 > a:before {
    background-position: 0 -38px;
}
.item4 > a:before {
    background-position: -38px -38px;
}
.item5 > a:before {
    background-position: -76px 0;
}
.item6 > a:before {
    background-position: -76px -76px;
}
.item7 > a:before {
    background-position: -114px 0;
}
.item8 > a:before {
    background-position: -114px -114px;
}
.item9 > a:before {
    background-position: -152px 0;
}
.item10 > a:before {
    background-position: -152px -152px;
}
.item11 > a:before {
    background-position: -190px 0;
}
.item12 > a:before {
    background-position: -190px -190px;
}
.menu > li > a span {
    font-size: 0.857em; 
    display: inline-block;
    position: absolute;
    right: 1em;
    top: 50%; 
    background: #48515c;
    line-height: 1em;
    height: 1em;
    padding: .4em .6em;
    margin: -.8em 0 0 0; 
    color: #fff;
    text-indent: 0;
    text-align: center;
    -webkit-border-radius: .769em;
    -moz-border-radius: .769em;
    border-radius: .769em;
    -webkit-box-shadow: inset 0px 1px 3px 0px rgba(0, 0, 0, .26), 0px 1px 0px 0px rgba(255, 255, 255, .15);
    -moz-box-shadow: inset 0px 1px 3px 0px rgba(0, 0, 0, .26), 0px 1px 0px 0px rgba(255, 255, 255, .15);
    box-shadow: inset 0px 1px 3px 0px rgba(0, 0, 0, .26), 0px 1px 0px 0px rgba(255, 255, 255, .15);
    text-shadow: 0px 1px 0px rgba(0,0,0,.5);
    font-weight: 500;
}
.menu > li > a:hover span, .menu > li a.active span {
    background: #2173a1;
}
.menu > li > ul li a:before{
    content: '?';
    font-size: 8px;
    color: #bcbcbf;
    position: absolute;
    width: 1em;
    height: 1em;
    top: 0;
    left: -2.7em;
}

.menu > li > ul li:hover a,
.menu > li > ul li:hover a span,
.menu > li > ul li:hover a:before {
    color: #32373D;
}

.menu ul > li > a span {
    font-size: 0.857em; 
    display: inline-block;
    position: absolute;
    right: 1em;
    top: 50%; /
    background: #fff;
    border: 1px solid #d0d0d3;
    line-height: 1em;
    height: 1em;
    padding: .4em .7em;
    margin: -.9em 0 0 0; 
    color: #878d95;
    text-indent: 0;
    text-align: center;
    -webkit-border-radius: .769em;
    -moz-border-radius: 769em;
    border-radius: 769em;
    text-shadow: 0px 0px 0px rgba(255,255,255,.01));
} 
```

HTML：

```
 <div id="wrapper">
            <ul class="menu">
                <li class="item1"><a href="?page=overview">{$lm_overview} </a>
                    </li>
                <ul>
                <li class="item2"><a href="?page=chat">{$lm_chat} <span>{$chatusers}</span></a>
                    </li>
                </ul>
                <li class="item3"><a href="#">{$lm_research} </a>
                    <ul>
                        <li class="subitem1"><a href="#">Cute Kittens </a></li>
                        <li class="subitem2"><a href="#">Strange "Stuff" </a></li>
                        <li class="subitem3"><a href="#">Automatic Fails </a></li>
                    </ul>
                </li>
    </ul>
    </div>
<script type="text/javascript">
    $(function() {

        var menu_ul = $('.menu > li > ul'),
               menu_a  = $('.menu > li > a');

        menu_ul.hide();

        menu_a.click(function(e) {
            e.preventDefault();
            if(!$(this).hasClass('active')) {
                menu_a.removeClass('active');
                menu_ul.filter(':visible').slideUp('normal');
                $(this).addClass('active').next().stop(true,true).slideDown('normal');
            } else {
                $(this).removeClass('active');
                $(this).next().stop(true,true).slideUp('normal');
            }
        });

    });
</script> 
```

[图片链接](http://oi45.tinypic.com/2civ7p.jpg)

概述按钮和*聊天按钮应该是普通按钮，其设计与**其他*按钮一样，但它们不应悬停，并且它们应立即将您转移到另一个页面。其他按钮按我的意愿工作。我的问题是，当我单击“*概述*”按钮时，它不会将我转移到任何地方，因为当我单击它时它仍然会悬停。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:34:31.803

根据我对你问题的理解。您希望“**概览**”和“**聊天**”按钮像普通的锚标记一样工作并重定向到给出的 URL，`href`但“**研究**”按钮应该按原样工作。那么主要问题在于您的菜单-> li-> 锚点击代码中，您正在阻止默认点击行为`e.preventDefault()`。这将不允许锚标记重定向到 href 中的 url（默认行为）。请参阅下面的代码，您只需要删除`e.preventDefault()`，以便锚标记可以重定向到 URL 并且无论如何 Research 按钮和其他类似内容都会包含在内`#`，`href`因此它们不会重定向到任何 URL。

```
menu_a.click(function(e) {

    if(!$(this).hasClass('active')) {
        menu_a.removeClass('active');
        menu_ul.filter(':visible').slideUp('normal');
        $(this).addClass('active').next().stop(true,true).slideDown('normal');
    } else {
        $(this).removeClass('active');
        $(this).next().stop(true,true).slideUp('normal');
    }
}); 
```

这是更新的 jsfiddle [http://jsfiddle.net/VRBwm/1/](http://jsfiddle.net/VRBwm/1/)

希望这会有所帮助，请告诉我是否需要其他内容。**

# spring - Spring使用取决于用户的不同数据源

> ID：15853561
> 
> 赞同：0
> 
> 时间：2013-04-06T16:57:31.457
> 
> 标签：spring, spring-mvc, authorization, datasource

我有 web 应用程序，我使用 Spring MVC。现在我想为管理员和简单用户添加不同的数据源。所以我的应用程序应该通过匿名用户连接到数据库，它只能从表中选择并插入到一些表中。但是当用户通过管理员授权自己时 - 应用程序应该更改数据库连接上的用户和密码，并以 root 权限连接到数据库。spring 3.0.5可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:12:32.663

尝试

```
org.springframework.jdbc.datasource.UserCredentialsDataSourceAdapter 
```

例如，您可以通过登录过滤器中的 setCredentialsForCurrentThread() 方法在数据源上设置凭据。

# algorithm - 递归函数在结果中生成重复项

> ID：15853562
> 
> 赞同：0
> 
> 时间：2013-04-06T16:57:31.703
> 
> 标签：algorithm, recursion, coffeescript

我在 coffescript 中玩了一些算法，结果得到了一些意想不到的输出。这是我的代码：

```
traverse = (tree, stack) ->
  stack.push tree.node
  if not tree.branches
    stack
  else
    traverse branch, stack for branch in tree.branches

one  = { node: 1 }
two  = { node: 2 }
tree = { node: "+", branches: [one, two] }

console.log traverse  one, [] # => [ 1 ]
console.log traverse  two, [] # => [ 2 ]
console.log traverse tree, [] # => [ [ '+', 1, 2 ], [ '+', 1, 2 ] ] 
```

我希望在遍历时得到的输出`tree`是`[ '+', 1, 2 ]`，但这会被重复。我在这里错过了一些简单的事情吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:04:11.523

如果函数没有显式`return`，则返回值是最后一个表达式的值。函数中的最后一个表达式是：

```
if not tree.branches
  stack
else
  traverse branch, stack for branch in tree.branches 
```

注意`if`s 和`for`s 都是 CoffeeScript 中的表达式。

那么它的价值是什么`if`，因此函数的价值是什么？如果`tree.branches`存在那么你得到`stack`，否则你得到的值`for`。CoffeeScript`for`循环计算为一个数组：

```
a = (i for i in [0 .. 6])
# a is now [0, 1, 2, 3, 4, 5, 6] 
```

因此，如果`tree.branches`存在，您最终会返回一个返回的数组`transverse`：一个数组数组的数组 ... 其中最终的数组是 all `stack`。

您只需要更明确地了解您的返回值，这样的事情应该可以解决问题：

```
traverse = (tree, stack) ->
  stack.push tree.node
  if tree.branches
    traverse branch, stack for branch in tree.branches
  stack # <------------ Now we always return stack 
```

演示：http: [//jsfiddle.net/ambiguous/2QJ9e/](http://jsfiddle.net/ambiguous/2QJ9e/)

# sql - 仅当记录不存在时才插入值

> ID：15853564
> 
> 赞同：-2
> 
> 时间：2013-04-06T16:57:46.347
> 
> 标签：sql, sqlite

我正在使用 sqlite3 数据库。我在名为 device 的表中插入了一组 device_ids(unique)，这是在表为空时完成的。但是当我尝试再次插入包含一些新 id 的 id 时，由于唯一性，它会抛出错误。

```
 device_all_id.each do |device_id|

     insert into device (Device_id) values ('#{device_id.first}') where  where Device_id <> '#{device_id.first}'

 end 
```

所以我想在插入device_ids之前检查记录是否已经存在，所以我尝试了'IF EXISTS'查询，但这也作为语法错误抛出。

任何人都可以帮我解决这个问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:04:52.620

插入前检查将要求数据库回答两个查询，它不会真正减少您的错误处理。（您*必须*捕获错误。更新可能会出错的方式有很多。）您几乎总是更好

*   执行 INSERT 语句，
*   捕获错误，以及
*   采取适当的措施来解决错误。

从您的问题中不清楚 UPSERT 是否适合您。看到[这个答案](https://stackoverflow.com/a/4330694/562459)。

# slickgrid - 简单 SlickGrid 的数据不显示

> ID：15853569
> 
> 赞同：2
> 
> 时间：2013-04-06T16:58:10.450
> 
> 标签：slickgrid

刚开始使用 SlickGrid，不确定我是否遗漏了什么，但这个简单的代码似乎不起作用。它显示标题，但不显示行。

**网格代码：**

```
var grid;
var data = [
   { ID: 1, VALUE: "Value1"},
   { ID: 2, VALUE: "Value2"},
   { ID: 3, VALUE: "Value3"},
   { ID: 4, VALUE: "Value4"},
   { ID: 5, VALUE: "Value5"}
];
var columns = [
   {name:'ID NUM', field:'ID', id:'ID'},
   {name:'VALUE', field:'VALUE', id:'VALUE'}    
];
var options = {
    enableCellNavigation: true,
    enableColumnReorder: false
};
grid = new Slick.Grid("#container-div", data, columns, options);
grid.render(); 
```

由于某种原因，只有第一行的第一个单元格在 html 中呈现并且没有显示。

**HTML：**

```
<div class="slick-viewport" style="width: 100%; overflow: auto; outline: 0px none; position: relative; height: 0px;">
   <div class="grid-canvas" style="height: 150px; width: 880px;">
      <div class="ui-widget-content slick-row even" style="top:0px">
        <div class="slick-cell l0 r0">1</div>
      </div>
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T20:48:31.790

您缺少用于显示数据的容器 div，在您引用的 javascript 代码中，`#container-div`但它在您的 html 代码中不存在。通常，除了网格容器本身之外，您不必编写任何 html 代码，就像您正在做的那样（或者它是您显示的结果？）。尝试在您的 html 正文中简单地添加或替换此代码：`<div id="container-div" style="width:600px;height:500px;"></div>`您可以在此处查看 SlickGrid 的一个简单示例：[https ://github.com/mleibman/SlickGrid/blob/master/examples/example1-simple.html](https://github.com/mleibman/SlickGrid/blob/master/examples/example1-simple.html)

# macos - Process.Start 在 Mac 上的应用程序包中（使用 MonoMac）

> ID：15853574
> 
> 赞同：0
> 
> 时间：2013-04-06T16:58:26.010
> 
> 标签：macos, process, bundle, monomac

我正在使用 MonoMac 为 Mac 开发一个非常简单的应用程序。我有一个由两个项目组成的解决方案：主项目和自动更新程序。主项目引用自动更新程序，因此自动更新程序成为主应用程序的应用程序包的一部分。

运行主应用程序时，如果有新更新，我想启动自动更新程序。在 Windows 上，这是一个简单的`Process.Start("C:\path\to\updater.exe")`; 然而，在 Mac 上，这似乎是有问题的。以上述方式执行此操作时（使用 updater.exe 的绝对路径和相对路径时），什么都没有发生，调试只是说当我尝试获取任何信息时进程已经结束。

我尝试使用 AppleScript 启动更新程序：

```
do shell script "mono /path/to/bundle.app/Contents/MonoBundle/updater.exe" 
```

但这会产生错误“应用程序包中没有 Info.plist 文件或 Info.plist 文件中没有 NSPrincipalClass，正在退出”。当我尝试以相同的方式启动主可执行文件时会出现同样的错误，并且我知道 Info.plist 已为此正确配置（因为我确实能够启动应用程序），所以肯定还有其他错误.

我在做一些明显错误的事情吗？我只想从主可执行文件启动更新程序，我怎么做并不重要。

# c# - 如何在 C# 中的时间跨度字段上排序？

> ID：15853576
> 
> 赞同：3
> 
> 时间：2013-04-06T16:58:39.490
> 
> 标签：c#

我使用 C#。我有一个事件列表：

```
List<Event> events = new List<Event>(); 
```

每个事件都有名称和时间。因此，如果您要查看列表，您会看到如下内容：

```
Event A | 18:00
Event B | 18:30
Event C | 18:45
Event D | 18:15 
```

我一直在尝试按事件发生时间排序列表，但它似乎没有奏效。我在我的控制器中使用了这个：

```
events.OrderBy(e => e.Time); 
```

上网看了下，看到有人用了OrderBy和ThenBy，于是试了一下：

```
events.OrderBy(e => e.Time.ToString().Length).ThenBy(e => e.Time); 
```

但这也不起作用。任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-06T17:01:09.507

`OrderBy`并且`ThenBy`不会`List`就地排序 - 它会创建具有相同项目排序的新集合。

您必须使用已订购的列表重新分配您的列表：

```
events = events.OrderBy(e => e.Time).ToList(); 
```

或与`ThenBy`：

```
events = events.OrderBy(e => e.Time.).ThenBy(e => e.AsrTime).ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T17:01:19.487

如果您*只是*作为单独的语句调用[`OrderBy`](http://msdn.microsoft.com/en-gb/library/bb534966.aspx)，那绝对行不通。与所有 LINQ 方法一样，`OrderBy`它不会改变原始序列 - 而是返回一个应用了排序的*新*序列。

所以你想要这样的东西：

```
var orderedEvents = events.OrderBy(e => e.Time); 
```

或对于复合排序：

```
var orderedEvents = events.OrderBy(e => e.Time).ThenBy(e => e.AsrTime); 
```

我强烈建议您*不要*调用`e.Time.ToString()`，当然也不要按字符串的*长度排序。*从根本上说，您对字符串表示不感兴趣，所以不要费心使用它。

如果需要，您可以调用`ToList()`结果，但如果您只是要迭代它一次，那么实现结果就没有什么意义了。如果您要对其进行多次迭代，调用`ToList`将确保排序只需要发生一次，而不是每次迭代。

了解 LINQ 的功能性质以及它通过使每个返回一个新序列来组合操作的方式非常重要，该新序列是对前一个序列应用操作的结果 - 通常是懒惰的。

# java - 事件分发线程

> ID：15853578
> 
> 赞同：0
> 
> 时间：2013-04-06T16:59:06.807
> 
> 标签：java

我试图在框架内制作一个简单的按钮，但按钮图标未正确显示我的问题是为什么？2.) 为什么我们不能把 S 放在 SwingDemo() 或 public void actionPerformed(ActionEvent ae) 3.) 哪个语句使 edt 线程？请尽量用简单的语言解释，否则会产生更多的疑问。`wingUtilities.invokeLater(new Runnable() {
public void run() { new SwingDemo(); } });`

```
import javax.swing.*;
import java.awt.event.*;
class SwingDemo implements ActionListener {
SwingDemo() {
    JFrame jfrm = new JFrame("A Simple Swing Application");
    jfrm.setSize(275, 100);
    jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    JButton jlab = new JButton(" Button ");
    jfrm.add(jlab);
    jfrm.setVisible(true);
}
public static void main(String args[]) {
    SwingUtilities.invokeLater(new Runnable() {       //2
    public void run() {
    new SwingDemo();
    }
    });
}
    public void actionPerformed(ActionEvent ae) {
    //jlab.setText("You selected " + ae.getActionCommand());
    //showStatus("You selected " + ae.getActionCommand()); 
```

} }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:02:42.837

在应用程序的初始阶段对其进行调用，`SwingUtilities.invokeLater(...)`以便在事件调度线程中创建 UI。它需要在调用应用程序中的构造函数或任何后续方法*之前发生。*创建的线程称为[初始线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)。

# opengl - 在 Ubuntu 上开发 32 位和 64 位 OpenGL 应用程序

> ID：15853579
> 
> 赞同：4
> 
> 时间：2013-04-06T16:59:19.667
> 
> 标签：opengl, ubuntu, ubuntu-12.04, mesa

我想开发 32 位和 64 位库，这取决于 Ubuntu（64 位）上的 OpenGL（台面）。

然而，似乎不可能同时安装 32 位和 64 位版本的 libgl1-mesa-dev。当 I 时`sudo apt-get install libgl1-mesa-dev`，它会安装 64 位版本。之后`sudo apt-get install libgl1-mesa-dev:i386`，它将安装 32 位版本，但将卸载 64 位版本。

是否可以让 32 位和 64 位版本的 libgl1-mesa-dev 共存？或者我可以尝试任何替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T08:46:06.150

如果包管理器出现问题，请[从源代码](http://www.mesa3d.org/)下载并编译 Mesa 。

顺便说一句，您始终可以根据您的硬件配置或操作系统平台使用您想要的任何 OpenGL。

# python - python django 模拟缓存

> ID：15853582
> 
> 赞同：4
> 
> 时间：2013-04-06T16:59:28.353
> 
> 标签：python, django, caching, mocking

在我的 settings.py 中，我将缓存指定为：

```
 CACHES = {
    'default': {
     ......
   }
} 
```

在我的views.py中，我有

```
import requests
from django.core.cache import cache, get_cache

def aview():
    #check cache
    if not get_cache('default').get('key'):
        #make request and save in cache
        result = request.get('some_url')
        get_cache('default').set('key', result)
        return result
    else:
        return get_cache('default').get('key') 
```

现在在我的tests.py 中，我已经能够模拟requests.get('aurl')，这样可以确保不发出任何外部请求。

但是测试代码仍然会命中缓存并从中获取/设置。因此，如果我的产品已经设置了缓存，那么测试将失败，因为它从同一个缓存中获取数据。或者，如果我先运行测试，那么测试用例会使用测试数据设置缓存，当我运行 prod 网站时，我会看到同样的情况。

我怎样才能模拟调用

```
get_cache('default').set('key', result) 
```

和

```
get_cache('default').get('key') 
```

这样 set 调用不会设置真正的缓存（返回 None？）并且 get 不会在实际缓存中返回任何内容。

请为我提供如何完成此操作的代码示例。

这是我如何嘲笑我的 requests.get

```
def test_get_aview(self):
    with mock.patch('requests.get') as mymock:
        mymock.side_effect = (lambda url: MOCKED_DATA[url]) 
```

我可以在这之后添加什么代码以使其工作？我尝试了类似的东西

```
class MockCacheValue(mock.MagicMock):
    def get(self, key):
        print 'here'
        return None
    def set(self, key, value):
        print 'here 2'
        pass

def test_get_aview(self):
        with mock.patch('requests.get') as mymock:
            mymock.side_effect = (lambda url: MOCKED_DATA[url])
            mock.patch('django.core.cache.get_cache', new=MockCacheValue) 
```

但它不起作用，并且在上面的 get/set 中放置一个 print 语句不会打印任何东西，让我觉得它没有正确模拟

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-06T19:24:12.833

我认为你应该在运行测试时使用[虚拟缓存：](https://docs.djangoproject.com/en/dev/topics/cache/?from=olddocs/#dummy-caching-for-development)

*   测试用例中的覆盖设置，请参阅[文档](https://docs.djangoproject.com/en/1.5/topics/testing/overview/#overriding-settings)
*   在 settings.py 中进行测试时检查要使用的缓存后端：

    ```
    CACHES = ...
    if 'test' in sys.argv:
        CACHES['default'] = {'BACKEND': 'django.core.cache.backends.dummy.DummyCache',} 
    ```

*   有一个单独的 settings.py 用于测试
*   嘲笑，请参阅有关如何做到这一点的好[文章](http://www.2general.com/blog/2012/08/09/changing_django_cache_backend_between_test_cases.html)

希望有帮助。

# jquery - 从 jQuery 库中提取 Ajax 部件

> ID：15853584
> 
> 赞同：1
> 
> 时间：2013-04-06T16:59:45.103
> 
> 标签：jquery, jquery-plugins

我的问题与下面的帖子有关，目前还没有明确的答案。

[jQuery 是否只有 Ajax 部分？](https://stackoverflow.com/questions/4132163/is-there-only-ajax-part-of-jquery)

我只想使用 jQuery 的 Ajax 部分，不想使用整个库。任何人都可以为此提供帮助。

在上述帖子的一个答案中，我发现了这个 ajax 库 [https://github.com/dtjm/jquery/tree/ajaxonly](https://github.com/dtjm/jquery/tree/ajaxonly)

正如那里提到的，我尝试了以下命令，但是我没有密码来提取 jquery 部分。

```
git clone https://dtjm@github.com/dtjm/jquery.git
git checkout ajaxonly
make 
```

它要求输入密码。有没有专家知道，如何获得 Ajax 部分？或者任何其他提取ajax的最简单方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:27:44.607

[按照在jQuery github 页面](https://github.com/jquery/jquery#how-to-build-your-own-jquery)上构建自定义版本的 jQuery 的说明进行操作。（请注意，这只适用于 jQuery 1.9+）

克隆存储库并安装 grunt 后，您应该能够构建一个仅包含 ajax 的 jQuery 版本：

`grunt custom:-css,-deprecated,-dimensions,-effects,-event-alias,-offset,-sizzle`

如果您需要在`ajax`没有 jQuery 的情况下方便地进行包装/规范化，我的建议是使用[ender并使用诸如](http://enderjs.com/)[reqwest 之](https://github.com/ded/reqwest)类的 ajax 库构建一个包。这将大大减少您的 ajax 功能的文件大小，同时使您能够在将来更新/添加其他类似库的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:30:11.807

答案是“不，没有可用的资源只为您提供 jQuery 库的 AJAX 部分”。但是，您可以访问[code.jquery.com](http://code.jquery.com)并导航，直到找到所需的版本。单击指向该版本`.js`CDN 的链接，但不是其缩小版本 ( `.min.js`)。因为 jQuery 是开源的，所以您可以删除不需要的所有内容，或者复制您需要的所有内容。您将不得不对您需要哪些核心功能进行一些研究，我建议您在完成后缩小提取的版本。

如果您有任何问题，请告诉我。祝你好运！:)

# java - GWT 托管模式和小程序

> ID：15853602
> 
> 赞同：0
> 
> 时间：2013-04-06T17:00:59.550
> 
> 标签：java, gwt

在托管模式下启动 GWT 时，可以在小程序和 GWT 应用程序之间进行通信（反之亦然）？我认为不会，因为小程序只能与 JavaScript 通信（通过 LiveConnect），但 GWT 的托管模式不会产生任何 JS ......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:48:54.880

虽然托管模式在 jvm 中运行部分代码，但所有 jsni/dom/native 调用都委托给浏览器，因此在您的情况下应该没有任何区别，您可以调用 js 与您的小程序进行通信。当然，在同一个调试器会话中调试 gwt 和 applet 代码是不可能的。

要从 GWT 调用 applet 方法，您需要一个 jsni 块，例如：

```
 private native Object callFoo(String param) /*-{
    var appplet = document.getElementById('myapplet');
    return applet.foo(param);
 }-*/ 
```

要从您的小程序调用 GWT 代码，您需要另一个 jsni 方法来导出您的 gwt 代码（请注意，您必须在入口点调用一次）

```
 private native void exportBar() /*-{
    window.bar = function(param) {
      return @com.examle.MyClass::myStaticMethod(*)(param);
    }
 }-*/ 
```

无论如何，我所知道的与小程序通信的最佳方法是使用[gwtai](http://code.google.com/p/gwtai/)，因为所需的所有样板代码（包装器和 jsni）都是自动生成的。

Gwtai，在托管模式下工作没有问题，虽然他们在他们的网站上说`don't expect it to be stable`，它足够稳定，我已经在生产中使用了很长时间。

> GwtAI 为 Google Web Toolkit (GWT) 项目提供了易于使用的跨浏览器 Java Applets 集成。GwtAI 包含许多实用程序和帮助类，例如自动创建包装小部件和与 Java Applet 通信的机制。

您需要下载两个文件（GwtAI-Client.jar 和 GwtAI-Core.jar ）并包含在项目的类路径中，然后修改您的`.ui.xml`文件以继承 gwtai，您就可以开始编码了。

首先，您必须在 gwt 代码中定义小程序接口，以便使用延迟绑定的 GWT 编译器创建通信类实现。

```
 @ImplementingClass(MyClassImpl.class)
 @Height("60") @Width("350") @Archive("GwtAI-Client.jar, MyApp.jar")
 public interface MyApplet extends Applet {
   public Object foo();
 } 
```

然后你必须在你的小程序代码中实现这个接口。

```
 public class MyClassImpl extends JApplet implements MyApplet {
   public Object foo(){
      return "Hello";
   }
 } 
```

最后使用 gwt 应用程序中的小程序

```
 MyApplet applet = GWT.create(MyApplet.class);
 Object foo = applet.foo(); 
```

阅读[入门](http://code.google.com/p/gwtai/wiki/GettingStarted)指南了解更多信息。

# android - 如何将 SD 卡图像添加到 Coverflow？

> ID：15853611
> 
> 赞同：0
> 
> 时间：2013-04-06T17:01:58.703
> 
> 标签：android, image, drawable, android-sdcard, coverflow

![在此处输入图像描述](https://i.stack.imgur.com/T2ikN.png) 这是我的可绘制封面流:(这是我的图像适配器代码

```
 /** The Constant IMAGE_RESOURCE_IDS. */
private static final List<Integer> IMAGE_RESOURCE_IDS = new ArrayList<Integer>(DEFAULT_LIST_SIZE);

/** The Constant DEFAULT_RESOURCE_LIST. */
private static final int[] DEFAULT_RESOURCE_LIST = {
    R.drawable.promo_blue_bg_medium,
    R.drawable.promo_green_bg_medium,
    R.drawable.flow,
    R.drawable.promo_yellow_bg_medium,
    R.drawable.promo_black_bg_medium ,

};

/** The bitmap map. */
private final Map<Integer, WeakReference<Bitmap>> bitmapMap = new HashMap<Integer, WeakReference<Bitmap>>();

private final Context context;

/**
 * Creates the adapter with default set of resource images.
 * 
 * @param context
 *            context
 */
public ResourceImageAdapter(final Context context) {
    super();
    this.context = context;
    setResources(DEFAULT_RESOURCE_LIST);
}

/**
 * Replaces resources with those specified.
 * 
 * @param resourceIds
 *            array of ids of resources.
 */
public final synchronized void setResources(final int[] resourceIds) {

       String ExternalStorageDirectoryPath = Environment
         .getExternalStorageDirectory()
         .getAbsolutePath();

       String targetPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath() + "/CamWay/";

       File targetDirector = new File(targetPath);

    IMAGE_RESOURCE_IDS.clear();
    for (final int resourceId : resourceIds) {
        IMAGE_RESOURCE_IDS.add(resourceId);
    }
    notifyDataSetChanged();
}

/*
 * (non-Javadoc)
 * 
 * @see android.widget.Adapter#getCount()
 */
@Override
public synchronized int getCount() {
    return IMAGE_RESOURCE_IDS.size();
}

/*
 * (non-Javadoc)
 * 
 * @see pl.polidea.coverflow.AbstractCoverFlowImageAdapter#createBitmap(int)
 */
@Override
protected Bitmap createBitmap(final int position) {
    Log.v(TAG, "creating item " + position);
    final Bitmap bitmap = ((BitmapDrawable) context.getResources().getDrawable(IMAGE_RESOURCE_IDS.get(position)))
            .getBitmap();
    bitmapMap.put(position, new WeakReference<Bitmap>(bitmap));
    return bitmap;
} 
```

}

你看，上面列出了 5 个可绘制对象。我想从文件夹中加载 5 个最后添加的图像。如何将 sdcard 图像添加到该代码中。

我正在尝试使用coverflow 显示最后拍摄的5 张照片。我希望有人能帮助我。

编辑（最后一个代码）：

```
 public class ResourceImageAdapter extends AbstractCoverFlowImageAdapter {

    //Dosya alımı başlangıç
     public class ImageAdapter extends BaseAdapter {

            private Context mContext;
            ArrayList<String> itemList = new ArrayList<String>();

            public ImageAdapter(Context c) {
             mContext = c; 
            }

            void add(String path){
             itemList.add(path); 
            }

         @Override
         public int getCount() {
          return itemList.size();
         }

         @Override
         public Object getItem(int position) {
          // TODO Auto-generated method stub
          return itemList.get(position);
         }

         @Override
         public long getItemId(int position) {
          // TODO Auto-generated method stub
          return 0;
         }

         @Override
         public View getView(int position, View convertView, ViewGroup parent) {
          ImageView imageView;
                if (convertView == null) {  // if it's not recycled, initialize some attributes
                    imageView = new ImageView(mContext);
                    imageView.setLayoutParams(new GridView.LayoutParams(220, 220));
                    imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
                    imageView.setPadding(8, 8, 8, 8);
                } else {
                    imageView = (ImageView) convertView;
                }

                Bitmap bm = decodeSampledBitmapFromUri(itemList.get(position), 220, 220);

                imageView.setImageBitmap(bm);
                return imageView;
         }

         public Bitmap decodeSampledBitmapFromUri(String path, int reqWidth, int reqHeight) {

          Bitmap bm = null;
          // First decode with inJustDecodeBounds=true to check dimensions
          final BitmapFactory.Options options = new BitmapFactory.Options();
          options.inJustDecodeBounds = true;
          BitmapFactory.decodeFile(path, options);

          // Calculate inSampleSize
          options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

          // Decode bitmap with inSampleSize set
          options.inJustDecodeBounds = false;
          bm = BitmapFactory.decodeFile(path, options); 

          return bm;   
         }

         public int calculateInSampleSize(

          BitmapFactory.Options options, int reqWidth, int reqHeight) {
          // Raw height and width of image
          final int height = options.outHeight;
          final int width = options.outWidth;
          int inSampleSize = 1;

          if (height > reqHeight || width > reqWidth) {
           if (width > height) {
            inSampleSize = Math.round((float)height / (float)reqHeight);    
           } else {
            inSampleSize = Math.round((float)width / (float)reqWidth);    
           }   
          }

          return inSampleSize;    
         }

        }

           ImageAdapter myImageAdapter;

           //Burası Dosya alımı bitimi
    /** The Constant TAG. */
    private static final String TAG = ResourceImageAdapter.class.getSimpleName();

    /** The Constant DEFAULT_LIST_SIZE. */
    private static final int DEFAULT_LIST_SIZE = 20;

    /** The Constant IMAGE_RESOURCE_IDS. */
    private static final List<Integer> IMAGE_RESOURCE_IDS = new ArrayList<Integer>(DEFAULT_LIST_SIZE);

    /** The Constant DEFAULT_RESOURCE_LIST. */
    private static final int[] DEFAULT_RESOURCE_LIST = {
        R.drawable.promo_blue_bg_medium,
        R.drawable.promo_green_bg_medium,
        R.drawable.flow,
        R.drawable.promo_yellow_bg_medium,
        R.drawable.promo_black_bg_medium ,

    };
    private String[] mFileStrings;
    ArrayList<String> f = new ArrayList<String>();

   public void getFromSdcard()
   {
       File file=  new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath() ,"CamWay");

           if (file.isDirectory())
           {
               File[] listFile = file.listFiles();//get list of filess
               mFileStrings = new String[listFile.length];

               for (int i = 0; i < listFile.length; i++)
               {
                   mFileStrings[i] = listFile[i].getAbsolutePath();
                   f.add(listFile[i].getAbsolutePath());//add path of files to array list
                   System.out.println("...................................."+mFileStrings[i]);
               }
           }
   }

    /** The bitmap map. */
    private final Map<Integer, WeakReference<Bitmap>> bitmapMap = new HashMap<Integer, WeakReference<Bitmap>>();

    private final Context context;

    /**
     * Creates the adapter with default set of resource images.
     * 
     * @param context
     *            context
     */
    public ResourceImageAdapter(final Context context) {
        super();
        this.context = context;
        setResources(DEFAULT_RESOURCE_LIST);
    }

    /**
     * Replaces resources with those specified.
     * 
     * @param resourceIds
     *            array of ids of resources.
     */
    public final synchronized void setResources(final int[] resourceIds) {

           String ExternalStorageDirectoryPath = Environment
             .getExternalStorageDirectory()
             .getAbsolutePath();

           String targetPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath() + "/CamWay/";

           File targetDirector = new File(targetPath);

        IMAGE_RESOURCE_IDS.clear();
        for (final int resourceId : resourceIds) {
            IMAGE_RESOURCE_IDS.add(resourceId);
        }
        notifyDataSetChanged();
    }

    /*
     * (non-Javadoc)
     * 
     * @see android.widget.Adapter#getCount()
     */
    @Override
    public synchronized int getCount() {
        return IMAGE_RESOURCE_IDS.size();
    }

    /*
     * (non-Javadoc)
     * 
     * @see pl.polidea.coverflow.AbstractCoverFlowImageAdapter#createBitmap(int)
     */
    @Override
    protected Bitmap createBitmap(final int position) {
        Log.v(TAG, "creating item " + position);
        final Bitmap bitmap =  BitmapFactory.decodeFile(f.get(position));

        bitmapMap.put(position, new WeakReference<Bitmap>(bitmap));

        return bitmap;
    }
} 
```

编辑 2：

它开始，然后从头开始显示 3 个项目。当我尝试查看 4+ 个项目时，它会停止。这是代码——`getFromSdcard() ; int size= f.size()-5; //get the size of arraylist then decrease it by 5 //then loop from that point to your arraylist size //to get the last 5 items in the list for(int j=size;j<f.size();j++) { System.out.println("Position = "+j); System.out.println("Path of files"+f.get(j)); } final Bitmap bitmap = BitmapFactory.decodeFile(f.get(position)); bitmapMap.put(position, new WeakReference<Bitmap>(bitmap)); return bitmap;`

```
04-06 21:41:05.013: E/AndroidRuntime(11217): at     com.project.smyrna.camway.ResourceImageAdapter.createBitmap(ResourceImageAdapter‌​.java:152) 
```

--行是`final Bitmap bitmap = BitmapFactory.decodeFile(f.get(position));`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:09:19.417

```
private String[] mFileStrings;
 ArrayList<String> f = new ArrayList<String>();

public void getFromSdcard()
{
    File file=  new File(android.os.Environment.getExternalStorageDirectory(),"Your Sdcard");

        if (file.isDirectory())
        {
            listFile = file.listFiles();//get list of files
            for (int i = listFile.length-5; i < listFile.length; i++)
            {
                    //get the length decrease it 5 . loop to last 
                mFileStrings[i] = listFile[i].getAbsolutePath();
                f.add(listFile[i].getAbsolutePath());//add path of files to array list
                System.out.println("...................................."+mFileStrings[i]);
            }
        }
} 
```

您可以获取 sdcard 中某个文件夹下的文件路径。但请确保 sdcard 文件夹没有其他文件格式。然后将arraylist传递给您的适配器以在coverflow中显示相同的内容

要过滤 .png 文件，您可以使用以下内容

```
 File dir= new File(android.os.Environment.getExternalStorageDirectory()); 
```

然后打电话

```
walkdir(dir);

ArrayList<String> filepath= new ArrayList<String>();//contains list of all files ending with 

public void walkdir(File dir) {
String Patternpng = ".png";

File listFile[] = dir.listFiles();

if (listFile != null) {
for (int i = 0; i < listFile.length; i++) {

if (listFile[i].isDirectory()) {
    walkdir(listFile[i]);
} else {
  if (listFile[i].getName().endsWith(Patternpng)){
      //Do what ever u want
      filepath.add( listFile[i].getAbsolutePath());
    }
   }
  }  
 }    
 } 
```

从发表的评论中，我假设您需要显示 sdcard 文件夹中的最后 5 个项目

```
 int  size= f.size()-5; 
         //get the size of arraylist then decrease it by 5
         //then loop from that point to your arraylist size 
         //to get the last 5 items in the list
         for(int j=size;j<f.size();j++)
         {
             System.out.println("Position = "+j);
             System.out.println("Path of files"+f.get(j));  
         } 
```

你的适配器

```
 public class MyAdapter extends AbstractCoverFlowImageAdapter {

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return f.size();
}

@Override
public Object getItem(int position) {
    // TODO Auto-generated method stub
    return position;
}

@Override
public long getItemId(int position) {
    // TODO Auto-generated method stub
    return 0;
}

   public View getView(int position, View convertView, ViewGroup parent) {
      //inflate layout
          //do something
          //use the edit 2 to get last 5 items in the arraylist.
          ImageView image=(ImageView)vi.findViewById(R.id.ivv);
          Bitmap b = BitmapFactory.decodeFile(f.get(position));
          image.setImageBitmap(b);     
    }

  } 
```

更新：

1.  在 getFromSdcard() 中仅将最后 5 个文件路径添加到您的数组列表 f

2.  您的列表视图项目数是 f.size()

3.  要获取路径，您可以在 getview() 中使用 f.get(position)。

在 getFromSdcard()

```
 for (int i = listFile.length-5; i < listFile.length; i++)
         // add only last 5 file paths from your folder 
```

在您的适配器中

```
@Override
 public int getCount() {
// TODO Auto-generated method stub
return f.size();
} 
```

在 getView

```
 ImageView image=(ImageView)vi.findViewById(R.id.ivv);
        Bitmap b = BitmapFactory.decodeFile(f.get(position));
        image.setImageBitmap(b); 
```

# php - PayPal DoAuthorization、DoCapture 和 DoVoid

> ID：15853614
> 
> 赞同：0
> 
> 时间：2013-04-06T17:02:03.507
> 
> 标签：php, paypal

我正在使用 Paypal 创建一个拍卖网站。客户支付少量费用参加，当报价落在某人身上时，其他人收回他们的钱。

如何在 php 中实现`DoAuthorization`,`DoCapture`和(NVP) 方法？`DoVoid`我没有找到任何关于这个案例的教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T12:59:01.760

你看过这里的代码示例[了](https://www.x.com/developers/paypal/documentation-tools/paypal-code-samples)吗？此页面上有所有这 3 个的 PHP 示例，包括 DoDirectPayment 和 Express Checkout API。[SDK](https://www.x.com/developers/paypal/documentation-tools/paypal-sdk-index)也非常有用，因为它们包含 PHP 的所有代码示例。在示例和 SDK 之间，这些将为您提供一个工作示例，一些可以构建的东西。

# javascript - 解释用户在 JavaScript 中输入的日期

> ID：15853615
> 
> 赞同：1
> 
> 时间：2013-04-06T17:02:09.517
> 
> 标签：javascript, date, input, format, interpreter

我正在寻找一种方便的方法来获取用户输入的日期并执行以下操作：

1）判断输入的日期是否有效，如果有效，返回一个对象：

2) 一个 JavaScript 日期对象

3) mySQL 格式的日期 (YYYY-MM-DD)

4）以典型格式（MM-DD-YYYY）格式化的日期

最后，我编写了自己的函数，该函数使用正则表达式，可以处理 YYYY-MM-DD、YYYY/MM/DD、MM-DD-YY、MM/DD/YY、MM-DD-YYYY 或 MM/DD 的输入/YYYY。

函数在对象中返回 mySQL 格式和常规格式的原因只是为了方便。我的 web 应用程序需要在字段中显示典型格式，并在保存数据时需要将 mysql 格式发送到服务器。

代码如下所示在我的答案中。我确信有一些方法可以优化代码，但为了便于阅读，我分部分写。即使它被设置为每次用户在日期字段中输入数据时运行，它也不会陷入困境。希望这可以帮助某人！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:02:09.517

**更新：** [momentjs](http://momentjs.com/)好多了。

代码和示例可以在这个[jsfiddle](http://jsfiddle.net/lukewarm74/3MWyR/13/)上看到。

```
function interpretDate(stringDate){
    var mysqlF = "(\\d{4})[-/](\\d{1,2})[-/](\\d{1,2})";
    var dispF = "(\\d{1,2})[-/](\\d{1,2})[-/]((?:\\d{4})|(?:\\d{2}))";
    var dispNoYearF = "(\\d{1,2})[-/](\\d{1,2})";
    var dateFormats = "(^"+mysqlF+"$)|(^"+dispF+"$)|(^"+dispNoYearF+"$)";

    //Let's try to extract the data
    data = stringDate.match(dateFormats);
    var month = -1;
    var day = -1;
    var year = -1;

    //Check to see if the verification failed
    if (data == undefined){
        //Invalid date
        return {valid: false, date: null, mysqlDate:null, displayDate: ""};
    }

    //Extract the data based on the entry type
    if (data[1] != undefined){//YYYY-MM-DD
        month = parseInt(data[3]);
        day = parseInt(data[4]);
        year = parseInt(data[2]);
    }else if (data[5] != undefined){//MM-DD-YYYY or MM-DD-YY
        month = parseInt(data[6]);
        day = parseInt(data[7]);
        year = parseInt(data[8]);
        if (year < 100){
            var yearString = new String(new Date().getFullYear());
            year = parseInt(yearString.substr(0,2) + year);
        }
    }else if (data[9] != undefined){//MM-DD
        month = parseInt(data[10]);
        day = parseInt(data[11]);
        year = parseInt(new Date().getFullYear());
    }

    //If we are here, we have three numbers, let's see if they make a real date
    var extractedDate = new Date(year, month-1, day);
    if (extractedDate.getFullYear() != year || extractedDate.getDate() != day || extractedDate.getMonth() != (month-1)){
        return {valid: false, date: null, mysqlDate:null, displayDate: ""};
    }

    //We have a valid date, let's add front zeros
    var monthFixed = month;
    if (monthFixed < 10) monthFixed = "0"+monthFixed;
    var dayFixed = day;
    if (dayFixed < 10) dayFixed = "0"+dayFixed;

    //We are done
    return {valid: true, date: extractedDate, mysqlDate:year+"-"+monthFixed+"-"+dayFixed, displayDate: month+"/"+day+"/"+year};
} 
```

# entity-framework - 许多域模型在 EF 5 中共享一个数据上下文

> ID：15853618
> 
> 赞同：2
> 
> 时间：2013-04-06T17:02:16.397
> 
> 标签：entity-framework, repository, entity-framework-5, dbcontext, dbset

最近，由于无知和时间紧迫，我将多个项目中的域模型（POCO 实体类）合并到一个“DataModel”项目中，因为我不想在所有项目中复制专用的 DbContext。让我印象深刻的是，可以完成一些通用的事情，比如 DbContext 扩展，可以从各种客户端项目中添加 DbSet 实例。

我读过提到这些事情，通常与作者在同一个圈子里争辩 - 我完全同意 - 存储库功能完全由 DbSet 类实现。

任何人都可以为构建一个可以存在于一个项目中的通用 DbContext 提供任何建议，其中其他项目都可以将其域模型（域实体集）注册到共享 DbContext 中，在那里它们都被分配了他们拥有的 DbSet 作为他们的存储库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T21:35:13.430

> 构建一个可以存在于一个项目中的通用 DbContext，其他项目都可以注册其域模型（域实体集）

有趣的想法，但我不确定你会从中获得什么。

一方面，您永远无法简单地输入`db.Customer`（或类似的）。应该一直是`genericdb.Set<Customer>()`，*根本不知道*知`genericdb`不知道`Customer`。（它可能尚未注册）。

那么，这个注册应该如何进行呢？有两种方法可以让上下文将类映射到数据库模型：

1.  在 - 派生类中创建`DbSet`属性`DbContext`并依赖于代码优先的默认约定，涉及表名和列名、复数等。
2.  提供映射配置。

第一个选项违背了通用上下文类的目的，因此您必须通过为域中的*每个*`EntityTypeConfiguration<T>`类提供s来注册域类，对于通常可以不用的类也是如此。（顺便说一句，这应该在上下文的构造函数中完成。）

 *进一步的暗示是，在某个地方，您需要一个组件/服务，该组件/服务知道哪些类组属于一起，并且能够提供连贯的配置列表。因此，您必须创建自己的组织者，而不是将专门的上下文作为开箱即用的组织原则。

但回到起点。您不能创建一个包含 DbContext 工厂的 DAL，该工厂提供以前为您的项目存在的上下文吗？您不必以这种方式复制专用的 DbContext 类。*

# javascript - jQuery：突出显示 div 框加载

> ID：15853619
> 
> 赞同：3
> 
> 时间：2013-04-06T17:02:21.870
> 
> 标签：javascript, jquery, html, onload, highlight

此 jQuery 代码将在单击时突出显示 div 框。

我想**在加载**时获得亮点，我该怎么做？

```
<!DOCTYPE html>
<html>
<head>
  <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

<style type="text/css">
div { margin: 0px; width: 100px; height: 80px; background: #666; border: 1px solid black; position: relative; }
</style>

  <script>
  $(document).ready(function() {

$("#div1").click(function () {
      $(this).effect("highlight", {}, 3000);
});

  });
  </script>
</head>
<body">
  <div id="div1"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:04:01.280

将声明 for `highlight`in document.ready 放在您绑定`click`事件的同一级别。

**[现场演示](http://jsfiddle.net/ZUV7C/)**

```
$(document).ready(function() {
      $("#div1").effect("highlight", {}, 3000); //this will highlight on load
      $("#div1").click(function () {
           $(this).effect("highlight", {}, 3000);
      });    
 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:07:45.710

或者，这种方式可能会更简洁一些，因为如果您添加一些其他想要在点击状态上显示的效果，您只需要定义一次。

```
$(document).ready(function() {      
      $("#div1").click(function () {
           $(this).effect("highlight", {}, 3000);
      });    
      $('#div1').click();
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:08:08.303

Javascript

```
$(document).ready(function() {
    $("#div1").effect("highlight", {}, 3000);
}); 
```

这将突出显示`div1`文档何时准备就绪。如果您还想要一个`click`处理程序，您可以保留它并输入您想要的任何代码（即`effect`，如果您愿意，您也可以将它保留在那里）。

[小提琴](http://jsfiddle.net/bizmark/h2aDy/)

# backbone.js - Backbone：从包含模型集合的模型集合创建模型

> ID：15853621
> 
> 赞同：0
> 
> 时间：2013-04-06T17:02:40.133
> 
> 标签：backbone.js, backbone-relational, backbone-model

我有一个 API，它正在生成每个场地发生的多个场地和事件的 GeoJSON 数据。

查看示例输出：

```
{
   "crs":null,
   "type":"FeatureCollection",
   "features":[
      {
         "geometry":{
            "type":"Point",
            "coordinates":[
               -122.330056,
               47.603828
            ]
         },
         "type":"Feature",
         "id":39,
         "properties":{
            "city_slug":"seattle",
            "neighborhood_name":"Downtown",
            "events__all":[
               {
                  "category__category":"Gallery",
                  "eventid":16200847,
                  "description":"A Wider View, curated by Onyx Fine Arts Collective, features 60 works by 23 artists of African descent.",
                  "title":"A Wider View",
                  "cost":"Free",
                  "category__slug":"gallery",
                  "slug":"a-wider-view"
               }
            ],
            "venue_name":"City Hall Lobby Gallery",
            "venue_address":"600 4th Avenue, Seattle, WA 98104, USA",
            "city_name":"Seattle",
            "neighborhood_slug":"downtown",
            "venue_slug":"city-hall-lobby-gallery"
         }
      },
      {
         "geometry":{
            "type":"Point",
            "coordinates":[
               -122.348512,
               47.6217233
            ]
         },
         "type":"Feature",
         "id":42,
         "properties":{
            "city_slug":"seattle",
            "neighborhood_name":"Downtown",
            "events__all":[
               {
                  "category__category":"Museums",
                  "eventid":15455000,
                  "description":"The Art of Video Games tackles a 40-year history, with a focus on video game as art form. Nerdy heartstrings will be tugged in this nostalgia-inducing retrospective, including everything from the Atari VCS to Playstation 3.",
                  "title":"The Art of Video Games",
                  "cost":"$20",
                  "category__slug":"museums",
                  "slug":"the-art-of-video-games"
               },
               {
                  "category__category":"Museums",
                  "eventid":15213972,
                  "description":"There's just something about the black leather jacket. It's a garment that invariably comes with context, that cannot help but be an icon. Worn to Be Wild: The Black Leather Jacket explores the evolution of the leather jacket from \"protective gear to revolutionary garb.\"",
                  "title":"Worn to Be Wild: The Black Leather Jacket",
                  "cost":"$20",
                  "category__slug":"museums",
                  "slug":"worn-to-be-wild-the-black-leather-jacket"
               }
            ],
            "venue_name":"Experience Music Project | Science Fiction Museum.",
            "venue_address":"325 5th Avenue North, Seattle, WA 98109, USA",
            "city_name":"Seattle",
            "neighborhood_slug":"downtown",
            "venue_slug":"experience-music-project-science-fiction-museum"
         }
      }
   ],
   "bbox":[
      -122.348512,
      47.6035448,
      -122.3233742,
      47.6217233
   ]
} 
```

我想将其映射到一个名为`VenueEvents`. `VenueEvents`包含名为 的模型`JsonVenues`，然后这些场地中的每一个都包含一个名为 的集合`EventSet`，其中包含许多`Event`模型（旁白：将模型命名为“事件”是否会导致灾难？）。

我的模型概述如下：

```
var Event = Backbone.Model.extend({
  parse: function(response){
    return {
      id: response.eventid,
      slug: response.slug,
      title: repsonse.title,
      description: response.description,
      category: response.category__category,
      cost: response.cost
    }
  }
});

var EventSet = Backbone.Collection.extend({
  model: Event,
  }
});

var JsonVenue = Backbone.Model.extend({
  initialize: function(attributes) {
    console.log(attributes)
  },
  parse: function(response){
    // var eventSet = new EventSet(response.properties.events__all);
    return {
      name: response.properties.venue_name,
      address: response.properties.venue_address,
      neighborhood: response.properties.neighborhood_name,
      //eventSet: eventSet
    }
  }
});

// Is this actually a model?
var VenueEvents = Backbone.Collection.extend({
  model: JsonVenue,
  url: '/json/',
  parse: function(response){
    return response.features;
  }
}); 
```

和对象按预期创建，但`VenueEvents`对象似乎没有进入模型（这是我希望使用它来创建集合的地方）。我在对象的参数中放入了 a ，它表明虽然 a 中的所有其他值都进入了模型，但没有。`JsonVenue``response.properties.events__all``JsonVenue``EventSet``console.log(attributes)``initialize``JsonVenue``features.properties``JsonVenue``events__all`

有什么理由会发生这种情况吗？这种将嵌套的 JSON 数据加载到模型中的方法是否可行？在大多数示例中，人们仅`id`在其 JSON 输出中包含嵌套对象的 ，然后（我假设）从另一个 JSON 字符串中的该对象构建模型并根据 ID 关联它们。这似乎需要服务器和客户端之间的更多流量。我还看到人们侧加载数据，这是在单个 API 调用中关联模型的推荐方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:54:28.900

好吧..我刚刚尝试了您的代码，使用：

```
new VenueEvents(json, {parse: true}); 
```

创建您的收藏。而且......[它似乎工作得很好](http://jsfiddle.net/96QV8/4/)......

尽管如此，[Backbone-relational](https://github.com/PaulUithol/Backbone-relational)可能具有您想要简化代码的行为（这只是一个假设，我自己从未测试过，也没有真正看过它）。

# javascript - 在 Window.history.pushState() 之后返回上一个 URL

> ID：15853624
> 
> 赞同：0
> 
> 时间：2013-04-06T17:02:54.777
> 
> 标签：javascript

我有产品网格。网格中的每个产品行都可以扩展以显示完整的产品详细信息（使用 Ajax 完成）。

当一行被消耗时，出于 SEO 目的，我正在使用：

```
window.history.pushState() 
```

更改 URL。

例如： URL 如：

```
http://mydomain.com/bouquets/cityName 
```

将改为：

```
http://mydomain.com/bouquets/cityName/prodId 
```

问题是当另一行花费新 URL 时：

```
http://mydomain.com/bouquets/cityName/prodId/prodId 
```

第三行已花费：

```
http://mydomain.com/bouquets/cityName/prodId/prodId/prodId/ 
```

等等...

当第一次后花费一行时，我需要在 JS 中执行以下操作：

```
<a href= "../URL" > 
```

# apache - nutch 仅提取 pdf 文件

> ID：15853628
> 
> 赞同：1
> 
> 时间：2013-04-06T17:03:06.883
> 
> 标签：apache, hadoop, search-engine, web-crawler, nutch

有什么方法可以执行 1-5 级的 urlfilter 和 5 级以后的不同 urlfilter。我需要提取只有在给定级别之后的pdf文件（只是为了实验）。

pdf 文件将以二进制格式存储在 crawl/segment 文件夹中。我想提取这些 pdf 文件并将所有文件存储在 1 个文件夹中。我已经能够编写一个java程序来识别一个pdf文件。我不知道如何制作一个内容具有**相同字体、页码、图像**等的 pdf 文件。

1.  执行爬网
2.  合并段数据
3.  运行 makePDF.java

这仅识别 pdf 文件：

```
 String uri = "/usr/local/nutch/framework/apache-nutch-1.6/merged572/20130407131335";
    Configuration conf = new Configuration();
    FileSystem fs = FileSystem.get(URI.create(uri), conf);
    Path path = new Path(uri, Content.DIR_NAME + "/part-00000/data");

    SequenceFile.Reader reader = null;
    try {
      reader = new SequenceFile.Reader(fs, path, conf);
      Text key = new Text();
      Content content = new Content();
      while (reader.next(key, content)) {
          String contentType = content.getContentType();
          if (contentType.equalsIgnoreCase("application/pdf")) {
            //System.out.write( content.getContent(), 0, content.getContent().length );
            System.out.println(key);
          }
      }
      reader.close();
    } 
        finally {
        fs.close();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T22:20:09.447

`content.getContent()`将以字节为单位返回内容。
只需使用将字节写入文件`BufferedOutputStream`并将其保存为pdf

# ssis - 在 SSIS 包中发送带有附件的邮件任务

> ID：15853629
> 
> 赞同：3
> 
> 时间：2013-04-06T17:03:07.520
> 
> 标签：ssis, attachment

在我的 ssis 包中，我在序列容器中有数据流任务。OLEDB 是源，平面文件是目标。我为平面文件的位置（@[User::strUnknownFileLocation]）提供了一个变量。同样对于平面文件的名称，我添加了一个变量（@[User::StrUnknownFileName]）。在数据流任务之后，我有发送邮件任务。我将该平面文件作为附件附加到发送邮件任务中。

这是我在文件名变量 (@[User::StrUnknownFileName]) 中评估的表达式。我已经在属性中设置了 Evaluate Expression is True 。

```
"UnknownValue_"+ (DT_STR,4,1252)YEAR(getdate()) +(MONTH( getdate()) < 10 ? "0" : "")+  (DT_STR,4,1252)MONTH(getdate()) +(DAY( getdate()) < 10 ? "0" : "") + (DT_STR,4,1252)DAY(getdate()) + ".txt" 
```

这是在我的平面文件连接属性表达式中——连接字符串

```
@[User::strUnknownFileLocation]+ @[User::StrUnknownFileName] 
```

这是我的平面文件连接属性表达式

文件位置的变量我没有任何表达式。我在变量中添加了位置值

```
(@[User::strUnknownFileLocation]). 
```

像 M:\ETL\Tmp\ 在发送邮件任务中，我有一个附件，附件的表达式如下所示，

```
@[User::strUnknownFileLocation]+ @[User::StrUnknownFileName] 
```

我昨天运行了包裹，它很好。它附加了一个文件为 UnknownValue_20130405.txt。但是今天打开包裹，发送邮件任务出错。当我点击错误时，它说它找不到文件 UnknownValue_20130406.txt 或者我没有打开该位置的权限。它有点奇怪。

所以，我执行 DFT 任务。所以文件生成了。然后它可以工作，因为文件在那里。那么为什么它不首先运行。所以现在明天当我打开我的包并尝试运行时，它不会运行，因为那个日期没有文件？但是，如果我只运行 DFT 任务，它将生成一个平面文件，并且在该位置会有一个平面文件。但这不是应该的样子。

有什么我做错了吗？我无法理解这一点。任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T21:31:03.260

我相信您遇到了问题，因为 SSIS 作为预执行阶段的一部分，会验证它需要的所有资源是否可用。在新的一天，文件在程序包运行后才可用。

为了解决这个问题，您可以告诉您 SSIS 等到它实际需要使用资源后再验证它。在 SSIS 中的任何元素上，它都应该有一个`DelayValidation`默认设置为 False 的属性。在“发送邮件任务”上将值设置为 True

# javascript - KineticJS Canvas - 从中 心点缩放组

> ID：15853630
> 
> 赞同：2
> 
> 时间：2013-04-06T17:03:15.297
> 
> 标签：javascript, canvas, html5-canvas, kineticjs

我想扩大我的小组（图像和其他东西）。

```
group.setScale(zoom, zoom); 
```

[http://jsfiddle.net/K8nK3/](http://jsfiddle.net/K8nK3/)

但是当我扩展我的团队时，我认为它不是从我的团队中心扩展的。我想像这样
![在此处输入图像描述](https://i.stack.imgur.com/bcBeD.jpg)
我希望它从中心缩放
![在此处输入图像描述](https://i.stack.imgur.com/1QD3X.jpg)

我尝试了更多，但并不成功。我该怎么做，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:18:30.467

[编辑以更好地满足提问者的需求]

**这是从中心点缩放动力学组的方法**

首先我们存储原始组的 centerX 和 centerY 以便我们可以保持组居中：

```
 group.cx=group.getX()+group.getWidth()/2;
      group.cy=group.getY()+group.getHeight()/2; 
```

然后我们编写一个自定义缩放方法，既可以缩放组又可以重新居中：

```
 group.scale=function(x,y){
          group.setScale(x,y);
          group.setPosition(
              group.cx-group.getWidth()/2*group.getScale().x,
              group.cy-group.getHeight()/2*group.getScale().y);
          group.draw();
      } 
```

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/dVGGz/](http://jsfiddle.net/m1erickson/dVGGz/)

```
<!DOCTYPE HTML>
<html>
  <head></head>
  <body>
    <button id="larger">Larger</button>
    <div id="container"></div>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.4.0.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script>
    $(function(){
      var stage = new Kinetic.Stage({
        container: 'container',
        width: 400,
        height: 400
      });
      var layer = new Kinetic.Layer();

      // Be sure to set width and height
      // They are required for this method to work
      var group = new Kinetic.Group({
        x: 100,
        y: 100,
        width:100,
        height:100
      });
      // store the original group center
      // so we can center the group there
      group.cx=group.getX()+group.getWidth()/2;
      group.cy=group.getY()+group.getHeight()/2;
      // custom scale function to both
      // scale the group and center the results
      group.scale=function(x,y){
          group.setScale(x,y);
          group.setPosition(
              group.cx-group.getWidth()/2*group.getScale().x,
              group.cy-group.getHeight()/2*group.getScale().y);
          group.draw();
      }

      var box1 = new Kinetic.Rect({
        x: 0,
        y: 0,
        width: 50,
        height: 50,
        fill: "blue",
        stroke: 'black',
        strokeWidth: 4
      });
      group.add(box1);

      var box2 = new Kinetic.Rect({
        x: 50,
        y: 50,
        width: 50,
        height: 50,
        fill: "green",
        stroke: 'black',
        strokeWidth: 4
      });
      group.add(box2);

      layer.add(group);
      stage.add(layer);

      var scaleFactor=1;
      $("#larger").click(function(){
          scaleFactor+=0.10;
          group.scale(scaleFactor,scaleFactor);
          console.log(scaleFactor);
      });

});

    </script>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T15:16:27.743

最简单的方法是重新定位/居中偏移。所有缩放和移动都将基于您的新偏移位置。

> > group.offset( { x: group.width() * .5, y: group.height() * .5 } );

[http://kineticjs.com/docs/Kinetic.Group.html](http://kineticjs.com/docs/Kinetic.Group.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-29T16:55:47.580

您是否尝试过使用偏移属性？即偏移量：[宽度/2，高度/2]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-24T23:43:15.153

问题#1：我需要从中心缩放一个组。问题 #2：Kinetic JS group.getWidth() 和 group.getHeight() 不起作用，除非您在创建时明确设置宽度。问题#3：我不知道宽度和高度，我正在动态改变形状。

这意味着为了尝试您的代码，我必须编写自己的 getWidth 和 getHeight 函数。那我就可以用你提出的方法了。

下面的解决方案。

（可能有更好的方法，但这是我现在的编程水平......如果有人可以为此添加递归以查看包含包含组的组等的组，那就太好了。）

```
var results = getGroupMinsAndMaxes(myKineticGroup);
console.log('results: '+ results.groupMinX, results.groupMaxX, 
     results.groupMinY, results.groupMaxY);

function getGroupMinsAndMaxes( group ) {

   // note this does not handle children that are groups, 
   // it expects children to be shapes

   var item;
   var groupMinX = 99999;
   var groupMaxX = -99999;
   var groupMinY = 99999;
   var groupMaxY = -99999;
   var shapeFunctionDefinition = '';
   var bounds = {};

   for (var i = 0; i < group.children.length; i++ ) {

       item = group.children[ i ];
       if ( item.getType() !== 'Shape' ) {

            alert('The getGroupMinsAndMaxes function is not designed to handle groups that contain groups.');
            break;

       } else {

            shapeFunctionDefinition = item.attrs.drawFunc.toString();

            bounds = getShapeMinsAndMaxes( shapeFunctionDefinition );

            if ( bounds.shapeMinX < groupMinX ) { groupMinX = bounds.shapeMinX; }
            if ( bounds.shapeMaxX > groupMaxX ) { groupMaxX = bounds.shapeMaxX; }
            if ( bounds.shapeMinY < groupMinY ) { groupMinY = bounds.shapeMinY; }
            if ( bounds.shapeMaxY > groupMaxY ) { groupMaxY = bounds.shapeMaxY; }

        }
   }

    return {
            groupMinX: groupMinX,
            groupMaxX: groupMaxX,
            groupMinY: groupMinY,
            groupMaxY: groupMaxY
        };

}

function getShapeMinsAndMaxes( shape ) {

   // the shape definition is passed as a string

    var regex = /[+-]?\d+\.\d+/g;

    var floats = shape.match(regex).map(function (v) {
        return parseFloat(v);
    });

   // preset some unrealistically large numbers which 
   // we will never encounter

    var shapeMinX = 99999;
    var shapeMaxX = -99999;
    var shapeMinY = 99999;
    var shapeMaxY = -99999;

    for (var i = 0; i < floats.length; i++) {

        if (isOdd(i)) {

            // Check Y values
            if (floats[i] < shapeMinY) {
                shapeMinY = floats[i];
            }
            if (floats[i] > shapeMaxY) {
                shapeMaxY = floats[i];
            }

        } else {

            // Check X values
            if (floats[i] < shapeMinX) {
                shapeMinX = floats[i];
            }
            if (floats[i] > shapeMaxX) {
                shapeMaxX = floats[i];
            }

        }
    }

    return {
            shapeMinX: shapeMinX,
            shapeMaxX: shapeMaxX,
            shapeMinY: shapeMinY,
            shapeMaxY: shapeMaxY
        };

}

function isOdd(num) {
    return num % 2;
} 
```

# php - 是否有任何安全的方法来允许跨站点 AJAX 请求？

> ID：15853633
> 
> 赞同：4
> 
> 时间：2013-04-06T17:03:25.353
> 
> 标签：php, jquery, ajax, security, cross-domain

我目前正在开发一个网站所有者可以安装的脚本，该脚本允许用户突出显示一个单词并在一个小的弹出 div 中查看该单词的定义。我只是在业余时间做这件事，无意出售它或任何东西，但我希望它是安全的。

当文本突出显示时，它会向我的域发送 AJAX 请求到 PHP 页面，然后在数据库中查找单词并输出包含信息的 div。我了解同源策略禁止我使用普通 AJAX 完成此操作，但我也不能使用 JSONP，因为我需要返回 HTML，而不是 JSON。

我研究过的另一个选项是添加

```
header("Access-Control-Allow-Origin: *"); 
```

到我的 PHP 页面。

由于我在安全方面真的没有太多经验，因为我这样做是一种爱好，有人可以向我解释使用 Access-Control-Allow-Origin: * 的安全风险吗？或者有没有更好的方法我应该考虑这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:36:34.847

[跨域资源共享 (CORS)](http://www.w3.org/TR/cors/)是标头字段背后的规范，旨在允许通过[XMLHttpRequest](http://www.w3.org/TR/XMLHttpRequest/)`Access-Control-Allow-Origin`进行跨域请求，但通过提供允许[服务器定义哪个跨域的接口来保护用户免受恶意站点读取响应](http://www.w3.org/TR/cors/#resource-processing-model)[请求是允许的，哪些是不允许的](http://www.w3.org/TR/cors/#resource-processing-model)。所以 CORS 不仅仅是，它表示允许来自任何来源的 XHR 请求。`Access-Control-Allow-Origin: *`

现在回答您的问题：假设您的服务是公开的并且不需要任何身份验证，那么使用`Access-Control-Allow-Origin: *`允许来自任何来源的 XHR 请求是安全的。但请确保仅在您希望允许该访问策略的那些脚本中发送该标头字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:55:11.137

> “当文本被突出显示时，它会向我的域发送一个 AJAX 请求到一个 PHP 页面，然后在数据库中查找该单词并输出一个包含该信息的 div。我知道同源策略禁止我正常完成此操作AJAX，但我也不能使用 JSONP，因为我需要返回 HTML，而不是 JSON。”

正如 hek2mgl 所指出的，JSONP 可以很好地解决这个问题。您需要做的就是将 HTML 包装在 JSONP 包装器中，如下所示：

```
displayDefinition({"word": "example", "definition": "<div>HTML text...</div>"}); 
```

where`displayDefinition()`是一个 JS 函数，它显示一个带有给定 HTML 代码的弹出窗口（并可能缓存它以供以后使用）。

> “我研究过的另一个选项是添加`header("Access-Control-Allow-Origin: *");`到我的 PHP 页面。由于我在安全方面真的没有太多经验，因为我这样做是出于一种爱好，有人可以向我解释一下使用中的安全风险`Access-Control-Allow-Origin: *`吗？”

风险与 JSONP 基本相同；在任何一种情况下，您都允许任何网站向您的脚本发出任意 GET 请求（它们实际上可以这样做）并读取结果（使用普通 JSON，它们通常不能，尽管较旧的浏览器可能存在一些安全漏洞可以允许这个）。特别是，如果用户在登录您的网站时访问了恶意网站，并且如果您的网站可能通过 JSONP 或 CORS 暴露敏感的用户数据，则恶意网站可能会访问这些数据。

对于您描述的用例，任何一种方法都应该是安全的，只要您仅将它用于该特定脚本，并且只要脚本仅执行您描述的操作（查找单词并返回其定义）。

当然，您也不应该将 CORS 或 JSONP 用于您不希望任何网站访问的脚本，例如银行转账表格。此类脚本，如果它们可以修改服务器上的数据，通常还需要采用额外的防御措施，例如[反 CSRF 令牌](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#General_Recommendation%3a_Synchronizer_Token_Pattern)，以防止攻击者并不真正关心响应而只关心副作用的“盲目”CSRF 攻击的请求。显然，反 CSRF 令牌本身是敏感的用户特定数据，因此不应通过 CORS、JSONP 或任何其他绕过同源保护的方法获得。

> “或者我应该研究一个更好的方法来做到这一点？”

另一种（虽然不一定更好）的方法可能是让您的 PHP 脚本将定义作为 HTML 返回，并且弹出窗口仅包含`iframe`指向脚本的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T17:05:42.460

[JSONP](http://en.wikipedia.org/wiki/JSONP)应该满足您的需求。它是一种广泛部署的 Web 技术，旨在解决跨域问题。您还应该了解[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，它解决了 JSONP 的一些缺点。我给您的链接还将包含有关这些技术的安全注意事项的信息。

你写了：

> 但我也不能使用 JSONP，因为我需要返回 HTML，而不是 JSON。

为什么不？您可以像这样使用 JSONP 响应：

```
callback({'content':'<div class="myclass">...</div>'}); 
```

然后`result.content`使用 DOM 操作注入当前页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T17:14:49.427

CORS 问题很简单 - 您是否希望任何人都能够远程 AJAX 您域中的内容？如果您的表单容易出现 CSRF，这可能会非常危险。这是一个直接从我脑海中摘取的例子。

设置：

*   一家银行，其网上银行服务器的 CORS 标头设置为接受所有（ACAO：*）（称为 A）
*   登录的合法客户（称他们为 B）
*   一个恰好能够让客户端运行任何东西的黑客（称它为 E）

A<->B 对话被认为是合法的。但是，如果黑客可以设法使标记 (B) 加载一个带有一些 JS 的站点，这些 JS 可以触发 AJAX 请求（很容易通过大型站点上的永久 XSS 缺陷），他/她可以让 B 向 A 发送请求通过 JSON，这将*被允许并视为正常请求*！

你可以用这个做很多可怕的事情。假设银行有一个表单，输入如下：

```
POST:
* targetAccountID -> the account that will receive money
* money -> the amount to be transferred 
```

如果标记已登录，我可以注入：

```
$.ajax({ url: "http://A/money.transfer.php"; data { targetAccountID: 123; money: 9999; }; }); 
```

突然间，任何访问该站点并登录到 A 的人都会看到他们的帐户耗尽了 9999 个单位。

**这**就是为什么 CORS 与少量盐一起服用的原因 - 在实践中，打开的次数*不要*超过您需要打开的次数。打开你的 API，就是这样。

一个很酷的旁注，CORS 不适用于 IE9 之前的任何东西。所以你需要构建一个后备，可能是 iframe 或 JSONP。

不久前，我写了关于这个主题的文章：[http](http://www.sebrenauld.co.uk/en/index/view/access-json-apis-remotely-using-javascript) ://www.sebrenauld.co.uk/en/index/view/access-json-apis-remotely-using-javascript ，其形式比维基百科更快乐，由方法。这是一个我非常珍视的话题，因为我不得不多次与 API 开发作斗争。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-06T17:16:47.620

CSRF(Cross Site Request Foregery) 的概念可以引起你的关注 [http://en.wikipedia.org/wiki/Cross-site_request_forgery](http://en.wikipedia.org/wiki/Cross-site_request_forgery) 有多种方法可以限制这个问题，最常用的技术是使用`csrf token`.

此外，您还应该`Rate limiter`为“限制执行从某个 ip 发出的数量请求”设置一个 IP，以限制如果您是目标可以进行的 DoS 攻击，您可以从[如何限制我的网站的 API 用户？](https://stackoverflow.com/questions/1375501/how-do-i-throttle-my-sites-api-users)

# emacs-dirtree - Emacs ditree，如何删除文件和刷新

> ID：15853635
> 
> 赞同：1
> 
> 时间：2013-04-06T17:03:35.637
> 
> 标签：emacs-dirtree

我在 emacs 中使用[脏器。](https://github.com/zkim/emacs-dirtree)问题是当我添加新文件时，它永远不会刷新它的结构。此外，来自 Visual Studio 背景，能够直接从树中删除文件会很好，这可能吗？（我的意思是我知道使用 emacs 一切皆有可能，但想知道是否有人已经解决了这个问题）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-16T09:54:17.617

您可以按 刷新树`g`。这会刷新您当前所在的树（但不是整棵树！）。

不幸的是，您不能删除除根节点之外的单个文件或目录（这真的很愚蠢）。要删除根节点，请键入`D`并确认。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-04T02:51:33.967

如果你想刷新只是杀死污垢的缓冲区，然后再次打开污垢。Cx k ---- 终止缓冲区 Mx ditree RET

# asp.net-mvc - 我的表单有两个提交按钮，用于两个决定。应该是一种形式还是两种形式？

> ID：15853636
> 
> 赞同：1
> 
> 时间：2013-04-06T17:03:42.800
> 
> 标签：asp.net-mvc, vb.net, forms, coding-style

我想知道我的用户选择了哪个决定。

**方法一**

![方法一](https://i.stack.imgur.com/2uRp4.png)

*HTML*

```
<form method="post">
    <input type="submit" value="Accept" name="decision" />
    <input type="submit" value="Decline" name="decision" />
</form> 
```

*VB.NET*

```
If Decision = "Accept" Then
    ' Do this
ElseIf Decision = "Decline" Then
    ' Do that
End If 
```

**方法二**

![方法二](https://i.stack.imgur.com/3rQar.png)

*HTML*

```
<form method="post">
    <input type="hidden" name="decision" value="true" />
    <input type="submit" value="Accept" />
</form>

<form method="post">
    <input type="hidden" name="decision" value="false" />
    <input type="submit" value="Decline" />
</form> 
```

*VB.NET*

```
If Decision Then
    ' Do this
Else
    ' Do that
End If 
```

有什么真正的区别吗？你会选择哪个，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:08:54.283

两者都是有效的，但我个人会选择第一个。

我这样做的原因是标记更清晰。表单的目的是让用户做出决定，这些元素 IMO 应该组合在一起，例如名为`frmDecision`.

第二个原因是第二个示例中的代码不明确。

例如，在后面的代码中

```
 If Decision Then 
```

如果Decision 等于true，则读取该值不表示`Accept`或`Decline`。同样将参数传递回名为 Decision 的服务器，其值为 true 或 false ，这有点麻烦。

我发现第一个示例更清洁，尽管您可以使用资源文件，因此您不必使用魔术字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:17:33.937

案例#1 不可扩展。When number of choices will grow it will be hard to manage. 并且在操作之间没有清晰的分离，当您通过 AJAX 调用它们时这可能很有用。案例#2 是多余的。我更喜欢第三种方式。起初我有名称选择器属性（我已经从 C# 转换它，所以不确定它是否正常工作）：

```
Imports System
Imports System.Web
Imports System.Web.Mvc
Imports System.Reflection

Namespace MySpace
    <AttributeUsage(AttributeTargets.Method, AllowMultiple := False, Inherited := True)> _
    Public Class SubmitActionAttribute
        Inherits System.Web.Mvc.ActionNameSelectorAttribute
        #Region "-- Constants -----------------------------------------------------------------------"
        Friend Const ACTION_PREFIX As String = "action:"
        Private Const ROUTE_ACTION As String = "action"
        #End Region

        Private _Name As String = Nothing
        Public ReadOnly Property Name() As String
            Get
                Return _Name
            End Get
        End Property

        Public Overrides Function IsValidName(controllerContext As ControllerContext, actionName As String, methodInfo As MethodInfo) As Boolean
            Dim name As String = If(_Name, methodInfo.Name)

            Dim key As String = String.Concat(SubmitActionAttribute.ACTION_PREFIX, name)
            Dim value As ValueProviderResult = controllerContext.Controller.ValueProvider.GetValue(key)
            If value IsNot Nothing Then
                controllerContext.RouteData.Values(SubmitActionAttribute.ROUTE_ACTION) = name
                Return True
            End If

            Return False
        End Function

        Public Sub New(name As String)
            _Name = name
        End Sub

        Public Sub New()
        End Sub
    End Class
End Namespace 
```

然后我将此属性添加到控制器的操作中

```
 <SubmitAction("Accept")> _
    Public Function AcceptSmth() As ActionResult

    End Function 
```

并在 HTML 中使用：

```
<input type="submit" value="Any value for caption" name="action:Accept" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:25:43.990

我会选择第一个。您提供的 vb 代码应该看起来更像这样

```
Private Sub Accept_Click(sender As Object, e As EventArgs) Handles Accept.Click
    'do this
End Sub

Private Sub Decline_Click(sender As Object, e As EventArgs) Handles Decline.Click
    'do that
End Sub 
```

或者如果两者之间有共同的代码

```
Private Sub Accept_Click(sender As Object, e As EventArgs) Handles Accept.Click
    doThisOrThat(True)
End Sub

Private Sub Decline_Click(sender As Object, e As EventArgs) Handles Decline.Click
    doThisOrThat(False)
End Sub

Private Sub doThisOrThat(decision As Boolean)
    If decision Then
        'do this
    Else
        'do that
    End If
End Sub 
```

# c++ - lambda 及其捕获的值

> ID：15853639
> 
> 赞同：0
> 
> 时间：2013-04-06T17:03:49.920
> 
> 标签：c++, visual-studio-2010, c++11, lambda, frp

我最近刚刚对函数式反应式编程及其是什么进行了一些试验，当我试图在 c++ 中实现类似的东西时，我求助于 lambda。我想出了这样的开始，

```
template<class T>
class Reactive
{ 
public:
  Reactive(T data)
  {
      m_Data = data;
  }

  Reactive(std::function<T()> func, T data)
  {
    m_Data = data;
    m_Affecter = func;
  }

  template<class H>
  Reactive & operator+(const H & rhs)
  {
      m_Data += rhs;

      return *this;
  }

  template<class H>
  Reactive operator+(Reactive<H> & rhs)
  {
    std::function<decltype(m_Data + rhs.m_Data)()> func;

    if (!rhs.m_Affecter)
      func = [&](){return m_Data + rhs.m_Data;};
    else
      func = [&](){return m_Data + rhs.m_Affecter();};

    return Reactive<decltype(m_Data + rhs.m_Data)> (func, m_Data + rhs.m_Data);
  }

  Reactive & operator=(const T & data)
  {
      m_Data = data;

      return *this;
  }

  Reactive & operator=(const Reactive & rhs)
  {
      m_Data = rhs.m_Data;
      m_Affecter = rhs.m_Affecter;

      return *this;
  }

  T & Get()
  {
      return m_Data;
  }

  void Update()
  {
      m_Data = m_Affecter();
  }

private:
  std::function<T()> m_Affecter;
  T m_Data;
}; 
```

到目前为止它只支持添加。我试图创建一个称为响应式的对象，它可以环绕任何其他类型，除了在对其执行数学运算时，会创建一个 lambda，在该操作发生的位置，以便记住已经完成的操作之前，并在其中一个影响值发生更改时再次执行此操作（在调用更新函数之后）。例如，如果我要这样做。

```
Reactive<int> cheh = 0;
Reactive<int> meh = 3;
Reactive<int> peh = 7;
cheh = meh + peh;
meh = meh + 4;
cheh.Update();
std::cout << cheh.Get(); 
```

那么继承人会发生什么。将第五行中的两个 Reactive 相加将使另一个 Reactive 将它们的两个值添加到 10，并将其影响器设置为执行类似操作的 lambda， &{meh.m_Data + peh.m_Data} 。然后那个 Reactive 将被分配给 cheh。当值 m_meh 添加了 4 并更新了 cheh 时，它的影响器被调用为新值 14，这就是打印到屏幕上的内容，完全符合我的预期。

但后来我开始思考，如果参与 cheh 影响者的那些反应物之一超出范围怎么办。如果处理不当，程序应该会出错。所以我这样做了，

```
Reactive<int> cheh = 0;
Reactive<int> meh = 3;

{
    Reactive<int> peh = 7;
    cheh = meh + peh;
    peh = peh + 4;
}

cheh.Update();
std::cout << cheh.Get(); 
```

在调用 update 时，在他的影响器中发生的反应性 peh 已经超出范围并且不再存在。然而，这个程序和 cheh 的影响器成功执行，它像以前一样打印出 14。我知道 lambda 中的值是由引用捕获传入的，那么影响函数如何仍然访问对 peh 的引用？只要 lambda 存在，通过引用传递给 lambda 的对象或整数类型是否会强制它们持续存在？有什么腥味...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T17:07:11.157

> 我知道 lambda 中的值是由引用捕获传入的，那么影响函数如何仍然访问对 peh 的引用？只要 lambda 存在，通过引用传递给 lambda 的对象或整数类型是否会强制它们持续存在？有什么腥味...

该程序具有未定义的行为。正如您所怀疑的那样，通过引用捕获*不会*延长这些引用所绑定的对象的生命周期，并且取消引用对不再存在的对象的引用是 UB。

但是，未定义的行为并不一定意味着会发生崩溃。有可能（就像这里的情况一样）该程序*似乎*工作正常。这在另一台机器上可能不是真的，或者在你重新启动你的机器之后。

另请参阅[这个精彩的解释](https://stackoverflow.com/a/6445794/1932150)，说明为什么即使在对象超出范围后也可以访问对象。

# c++ - C++ 如何将此 lisp 函数引入可编译代码？

> ID：15853642
> 
> 赞同：0
> 
> 时间：2013-04-06T17:03:59.237
> 
> 标签：c++, lisp

我有一个巨大的 lisp 函数，我想在我的 c++ 应用程序中使用它。这个函数是使用决策树算法生成的。

我对如何轻松地将其合并到我的代码中没有一个好主意。我不想使用任何外部库，也不想用树和树叶制作类。另外，我想让它易于加载，这就是为什么我首先考虑在一个大的 if-then 函数中编译它。

如果有人知道如何以一种漂亮的方式使其可编译，请告诉我。如果您不知道我想做什么，或者没有任何想法，那么请不要发布任何内容。

这是 lisp 函数的示例。它大约有 10.000 行。

```
((prev_is_pause is 0)
 ((prev_prev_gender is d)
  ((houses_from_month_start < 1.9)
   ((houses_from_month_start < 0.1)
    ((customer_numsegs < 3.6)
     ((customers_from_company_start < 6)
      ((prev_jobtype is n)
       ((next_hairtype is -)
        ((0.0332597 0.109037))
        ((0.0535314 0.143047)))
       ((called_houses_from_month_end < 3.5)
        ((next_next_single is +)
         ((0.0682613 0.200642))
         ((month_numhouses < 8.3)
          ((0.0631857 0.11954))
          ((0.0737018 0.165414))))
        ((0.0442889 0.225281))))
      ((0.075459 0.110669)))
     ((next_garden is 2)
      ((0.0726842 0.152881))
      ((prev_jobtype is n)
       ((0.0458975 0.12033))
       ((next_customerbegin_jobtype is s)
        ((0.0246754 0.0992865))
        ((prev_prev_talks is aI)
         ((0.0240179 0.0708011))
         ((0.0238049 0.0894625)))))))
    ((prev_birthplace is a)
     ((next_invoice is ".")
      ((company_numcustomers < 13)
       ((called_houses_from_month_end < 2.4)
        ((next_talks is t)
         ((0.0586338 0.13392)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:19:32.440

你有两个选择：

*   使用 Lisp 作为嵌入在 C++ 应用程序中的脚本语言，然后将函数作为脚本运行。请参阅[此答案](https://stackoverflow.com/questions/1716456/lisp-as-a-scripting-language-in-a-c-app)以查找一些用于此类任务的 C++ 库。
*   用 C++ 完全翻译你的 lisp 函数。显然，您已将数据和代码放在同一个函数中。您应该将其分开，将数据放入您将加载的文件中，然后使算法更清晰。不要忘记将算法分成几个不同的函数......另外，一个 10000 行的函数维护起来很痛苦，所以即使你没有将它翻译成 C++，你也应该像之前所说的那样打破它。如果您确切地知道该功能是什么，那应该不会太难。您可以使用一些 C++11 特性来模拟某种函数式语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T07:31:12.040

另一个选择是使用 CFFI 的回调机制：

[http://common-lisp.net/project/cffi/manual/html_node/defcallback.html#defcallback](http://common-lisp.net/project/cffi/manual/html_node/defcallback.html#defcallback)

但这将改变您看待应用程序的方式。

# java - java用浮点数和双精度数计算

> ID：15853643
> 
> 赞同：0
> 
> 时间：2013-04-06T17:03:59.177
> 
> 标签：java, math, opengl, lwjgl

我有java数学问题。我有以下表达：

```
double tripp = (timeNow-previousTime)/(seconds*Sys.getTimerResolution())*trip; 
```

我试图计算我的立方体的旋转速度。这是我执行该功能的完整代码：

```
public float getTripLenghtToGo(int seconds, double trip) {
    long timeNow = Sys.getTime();
    System.out.println("RES: "+Sys.getTimerResolution());
    double tripp = (timeNow-previousTime)/(seconds*Sys.getTimerResolution())*trip;
    System.out.println("("+timeNow+"-"+previousTime+")/("+seconds+"*"+Sys.getTimerResolution()+")*"+trip+" = "+tripp);
    if(tripp != 0){
        previousTime = timeNow;
    }
    return (float)tripp;
} 
```

我使用 OpenGL，所以它必须返回浮点数。它返回浮点数，但始终为零。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:11:30.880

`timeNow`是`long`类型。你部门的“上部”部分给出了一个很长的部分。整个师都会给一个长的。您需要将其转换为 double，否则小数部分将丢失。

例如，输出：

```
long timeNow = 10;
long previousTime = 1;
double trip = 0.1d;
int seconds = 50;

double trippCast = ((double) (timeNow-previousTime))/((double)seconds)*trip;
System.out.println(trippCast);
double trippWithoutCast = (timeNow-previousTime)/seconds*trip;
System.out.println(trippWithoutCast); 
```

是：

```
0.018
0.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:12:16.827

两种可能：

*   使用`System.nanoTime()`- 它为您提供更精确的时间测量
*   使用`((double)(timeNow-previousTime))/(seconds*Sys.getTimerResolution())`- 如果将 long 与 int 相除，则结果会很长。那就是`0L`

# unity3d - 车轮对车辆运动的影响

> ID：15853649
> 
> 赞同：0
> 
> 时间：2013-04-06T17:04:22.173
> 
> 标签：unity3d, unityscript

我是 Unity 的新手。如果我按下键盘上的“向上”按钮，我想做这辆车的轮子（汽缸）会转动。这是我写的代码：

```
var forwardSpeed: float = 3;

function Start () {

}

function Update () {
    var forwardMoveAmount = Input.GetAxis("Vertical")*forwardSpeed;
    transform.Rotate(0, forwardMoveAmount, 0);
} 
```

好的。车轮在转动，但我的车还在原地。我应该怎么做才能移动这辆车？ ![在此处输入图像描述](https://i.stack.imgur.com/1gkcv.png)

PS：你能解释一下，当我使用Y轴时，为什么这个圆柱体旋转正确？应该是z。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T15:21:44.487

对于基于物理的轮子，您可能需要轮子对撞机。它们的使用在这里得到了很好的记录：

[http://docs.unity3d.com/Documentation/Components/class-WheelCollider.html](http://docs.unity3d.com/Documentation/Components/class-WheelCollider.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:17:46.813

您将距离标量应用于旋转函数，而不是平移（移动）对象。

`transform.Rotate`将旋转对象。

`transform.Translate`将移动对象。

在你的桌子上挑选一个物体。如果将其旋转 90 度两次，它将旋转 180 度，但仍然在同一个位置。现在想象一下，每次旋转该对象时，都会将它朝它所面对的方向移动几英寸。4 个循环后，物体将完成 360 度的完整循环。

要在代码中表示这一点：

```
var forwardSpeed: float = 3; // Tweak me
var turnAngle:    float = 1; // Tweak me

function Start () {

}

function Update () {
    // Rotate first
    transform.Rotate(0, Vector3.right * turnAngle, 0);
    // Move forward along the rotated axis
    transform.Translate(0, Vector3.forward * forwardSpeed, 0);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:07:31.623

您还需要同时显式移动汽车，在父汽车对象上使用大概 , 或类似的东西`transform.position`。`transform.Translate()`

# java - 即使在 .flush()/.close() 之后，FileWriter 也不会写入文件

> ID：15853656
> 
> 赞同：5
> 
> 时间：2013-04-06T17:04:53.193
> 
> 标签：java, filewriter

我正在尝试写入文本文件，但即使该方法创建该文件（如果它不存在），它也不会写入。我已经通过其他几个类似问题的帖子并遵循了建议但没有运气。

通过使用调试器，字符串数据包含应该写入的正确数据，但它永远不会写入文本文件。

任何我忽略的东西的建议将不胜感激。

```
private static void createReservation(String filmName, String date, int noOfSeats, String username) {
    FileWriter fw = null;
    try {
        File bookingFile = new File("C:\\server\\bookinginfo.txt");
        if (!bookingFile.exists())
        {
            bookingFile.createNewFile();
        }
        fw = new FileWriter(bookingFile.getName(),true);
        String data = "<"+filmName+"><"+date+"><"+Integer.toString(noOfSeats)+"><"+username+">\r\n";
        fw.write(data);
        fw.flush();
    } catch (IOException ex) {
        Logger.getLogger(FilmInfoHandler.class.getName()).log(Level.SEVERE, null, ex);
    } finally {
        try {
            fw.close();
        } catch (IOException ex) {
            Logger.getLogger(FilmInfoHandler.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-06T17:10:50.827

明白了——这就是问题所在：

```
new FileWriter(bookingFile.getName(),true); 
```

该`getName()`方法将只返回`bookinginfo.txt`，这意味着它将创建一个`bookinginfo.txt`在当前工作目录中调用的文件。

只需使用带有 a 的构造函数`File`：

```
fw = new FileWriter(bookingFile, true); 
```

另请注意，您不需要先调用`createNewFile()`-`FileWriter`如果文件不存在，构造函数将创建该文件。

顺便说一句，我个人不喜欢`FileWriter`- 它*总是*使用平台默认编码。我建议在可以指定编码`FileOutputStream`的地方使用 Wrapped 。`OutputStreamWriter`或者使用[Guava](https://code.google.com/p/guava-libraries/)辅助方法，使这一切变得更加简单。例如：

```
Files.append(bookingFile, data, Charsets.UTF_8); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:15:40.487

用这个

```
fw = new FileWriter(bookingFile.getAbsolutePath(),true); 
```

代替

```
fw = new FileWriter(bookingFile.getName(),true); 
```

# html - 可以限制滑块在（垂直）滚动条上向下移动多远吗？

> ID：15853660
> 
> 赞同：1
> 
> 时间：2013-04-06T17:05:20.480
> 
> 标签：html, css, scrollbar

这是一个图表，它清楚地显示了我对滑块体的确切含义，您可以选择“按钮”并向下拖动垂直滚动条。 [http://www.maani.us/xml_charts/images/scroll.gif](http://www.maani.us/xml_charts/images/scroll.gif)

我的问题很简单。假设高度为 100 像素，我可以在向下滚动时以某种方式阻止用户到达最后 20% 吗？即，在不改变元素高度的情况下以 80 像素“阻止”它？我希望有一个 CSS 解决方案:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:10:29.843

假设 a`div`的高度为 100px，您可以使用绝对或相对定位：

```
div {
    position: absolute;
    bottom: -20px;
} 
```

# c++ - C ++ 11 lambda函数-如何传递参数

> ID：15853665
> 
> 赞同：22
> 
> 时间：2013-04-06T17:05:49.353
> 
> 标签：c++, c++11, lambda, functional-programming

我使用 lambda 函数将其传递给`std::condition_variable`wait() 函数，但事实并非如此。我使用不接收任何参数的 lambda 函数，对我来说一切都非常清楚。但我完全不明白如何使用具有参数列表的 lamdba 函数。使用带参数的显示 lambda？如何向它们传递参数？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-06T17:08:54.883

> 使用带参数的显示 lambda？如何向它们传递参数？

它与任何其他类型的可调用对象完全一样：

```
#include <iostream>

int main()
{
    auto l = [] (int i) { std::cout << "The answer is " << i; };
    l(42);
} 
```

另请注意，您无需将 lambda 存储在变量中即可调用它。以下是重写上述程序的另一种方法：

```
#include <iostream>

int main()
{
    [] (int i) { std::cout << "The answer is " << i; } (42);
    //                                                 ^^^^
    //                                 Invoked immediately!
} 
```

lambda 函数的类型（所谓的“lambda 闭包”）由编译器定义，是一个带有调用运算符的函子，其签名是您在定义 lambda 时指定的签名。因此，您调用 lambda 的方式与调用仿函数的方式完全相同（即，与调用函数或任何可调用对象的方式完全相同）。

因此，如果您想将 lambda 分配给一个对象，最好的做法是让编译器使用`auto`. 如果您不想或不能使用`auto`，那么您可以：

1.  对非捕获 lambda 使用函数指针（捕获 lambda*不能*转换为函数指针）。因此，在上述情况下，以下内容也将起作用：

    ```
    #include <iostream>

    int main()
    {
        void (*f)(int) = [] (int i) { std::cout << "The answer is " << i; };
        f(42);
    } 
    ```

2.  使用`std::function`（这总是可能的，即使 lambda 正在捕获）：

    ```
    #include <iostream>
    #include <functional>

    int main()
    {
        std::function<void(int)> f = [] (int i) 
                                   { std::cout << "The answer is " << i; };
        f(42);
    } 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-06T17:08:27.080

```
auto lambda = [] (int a, int b) { return a + b; };
assert(lambda(1, 2) == 3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T17:17:04.510

你甚至不需要一个变量来保存你的 lambda——你可以直接调用它：

```
std::cout << [](int n) { return n + 1 ; } (99) << std::endl ; 
```

# algorithm - 这可以用线扫描算法解决吗？

> ID：15853667
> 
> 赞同：7
> 
> 时间：2013-04-06T17:05:59.513
> 
> 标签：algorithm

编辑：现在我认为这是一个扫描线问题。（见底部的update2）

在这个问题中，我们得到了`N`对象和`M`约束。（`N`可以`200k`，`M`可以`100k`）。每个物体要么是黑色的，要么是白色的。每个约束的形式`(x, y)`是指在对象的范围内`x..y`，*只有一个*白色对象；其余的都是黑色的。我们想确定可以存在的白色对象的最大数量，或者是否不可能满足约束。

我观察到，如果一个约束完全包含在另一个约束中，则内部约束将决定可以放置白色对象的位置。此外，如果在另一个约束中包含多个不相交的约束，这应该是不可能的，因为它违反了每个约束只能有*一个*白色对象的事实。该算法应该足够快，可以在 2-3 秒内运行。

更新：其中一个答案提到了确切的封面问题；这是一个不是 NP 完全的特殊实例吗？

更新 2：如果我们将每个约束更改为*开始*和*结束*事件，并对这些事件进行排序，我们是否可以系统地扫过这些事件并分配白色对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T18:33:59.367

您的问题可以表示为[精确覆盖问题](http://en.wikipedia.org/wiki/Exact_cover)：约束区间形成要覆盖的集合，每个白色对象都覆盖了它所在的约束区间。那么，您的问题是找到一个白色对象的子集，该子集恰好覆盖每个约束间隔一次。

精确覆盖问题通常是 NP 完全的，尽管这显然并不一定意味着它们的任何特定子集都是。然而，仍然存在可以非常有效地解决*大多数*此类问题的算法，例如[Knuth 的算法 X](http://en.wikipedia.org/wiki/Knuth%27s_Algorithm_X)（由[dance links实现）。](http://en.wikipedia.org/wiki/Dancing_Links)

 *您的问题的一维结构也可能允许更直接的专门解决方法。然而，算法 X 是解决此类问题的一个非常好的通用工具。（例如，最快的[数独求解器](http://en.wikipedia.org/wiki/Sudoku_solving_algorithms)通常使用类似的东西。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T16:51:34.130

是的，有一个（点）扫描算法。这个有点不雅，但我认为它有效。

首先，扫描嵌套间隔。按排序顺序处理开始和结束事件（决胜局留给您），并保留一个不知道包含另一个间隔的活动间隔列表。要处理开始事件，请附加相应的时间间隔。要处理结束事件，请检查相应的时间间隔`I`是否已被删除。如果不是，则从列表中删除之前的`I`所有剩余间隔。对于每一个这样的 ，将两个其并集为集差的区间附加到涂黑区间的列表中。`J``I``J``J \ I`

其次，扫一扫以收缩被涂黑的区间。换句话说，删除已知为黑色的对象，重新编号，并相应地调整约束。如果整个约束被涂黑，则没有解决方案。

第三，扫一扫，解决现在非嵌套区间的问题。贪婪的解决方案被证明是最优的。

示例：假设我有半开约束 [0, 4), [1, 3), [2, 5)。第一次扫描会产生中断 [0, 1) 和 [3, 4)。第二次扫描留下约束 [a, c), [a, c), [b, d)。* 贪婪扫描将白色对象放置在新位置 a、c、d（旧位置 1、4、5）。

第二次扫的图解：

```
0 1 2 3 4 5  old coordinates
[       )
  [   )
    [     )
**    **     blackouts
  a b   c d  new coordinates
[       )
  [   )
    [     ) 
```*

# javascript - 如何使用 jquery waypoint 切换功能

> ID：15853668
> 
> 赞同：0
> 
> 时间：2013-04-06T17:06:11.277
> 
> 标签：javascript, jquery, jquery-waypoints

我想使用 jQuery waypoint 函数来切换函数，我怎样才能结合这些代码来实现呢？（我也会对替代解决方案感到满意）。

我想把这个结合起来......

```
$('#pageborder').waypoint(function(direction) {
  //do something here
}, { offset: 'bottom-in-view' }); 
```

有了这个......

```
.toggle(function(){
  $('.play', this).removeClass('pausing');
  $('.play', this).addClass('playing');
}, function(){
  $('.play', this).addClass('pausing');
  $('.play', this).removeClass('playing');
}); 
```

最终结果应该是在到达路径点时切换功能。

有关 JQuery Waypoint 插件的更多信息：http: [//imakewebthings.com/jquery-waypoints/#doc-waypoint](http://imakewebthings.com/jquery-waypoints/#doc-waypoint)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:18:36.560

这是一个使用航点插件在到达航点时执行某些操作的示例。在我的示例中，我根据用户是向上还是向下滚动来显示和隐藏某些内容：

演示：http: [//jsfiddle.net/lucuma/pTjta/](http://jsfiddle.net/lucuma/pTjta/)

```
$(document).ready(function () {
    $('.container div:eq(1)').waypoint(function (direction) {
        if (direction == 'down') $('.toggleme').show();
        else {
            $('.toggleme').hide();
        }
    }, {
        offset: $.waypoints('viewportHeight') / 2

    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T20:45:02.223

EBD，我看到你有一些工作。

如果您想要一个更简洁的切换操作，那么您可以考虑以下内容：

```
var $next_btn_containers = $('.next_btn_container, .next_btn_container_static');
$('#pageborder').waypoint(function(dir) {
    $next_btn_containers
        .toggleClass('next_btn_container_static', dir == 'down')
        .toggleClass('next_btn_container', dir == 'up');
}, { offset: 'bottom-in-view' }); 
```

通过预先选择并记住这两个类的所有成员，执行速度会更快——尤其是在大型 DOM 中。

原始选择器可能会简化，具体取决于元素的初始化方式。

稍加思考（并适当调整样式表指令），您就可以通过切换单个“静态”类来进一步简化事情：

```
var $next_btn_containers = $('.next_btn_container');
$('#pageborder').waypoint(function(dir) {
    $next_btn_containers.toggleClass('static', dir == 'down')
}, { offset: 'bottom-in-view' }); 
```

`.next_btn_container`因此，无论元素的静态/非静态状态如何，都将保持可靠的选择器（用于其他目的）。

注意：与第一个版本（和您自己的代码）不同，这将不会处理在反相中切换的两组元素，如果这是您所拥有的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:36:38.680

我使用此代码使其工作，感谢 lucuma 为我指明了正确的方向！

```
$('#pageborder').waypoint(function(direction) {

    if (direction == 'down') $('.next_btn_container').removeClass('next_btn_container').addClass('next_btn_container_static');
    else {
        $('.next_btn_container_static').removeClass('next_btn_container_static').addClass('next_btn_container');
    }
}, { offset: 'bottom-in-view' }); 
```

# file - 钛移动选择文件

> ID：15853671
> 
> 赞同：1
> 
> 时间：2013-04-06T17:06:15.017
> 
> 标签：file, titanium-mobile

我需要打开一个对话框来选择一个文件。

1.  要保存文件，我需要用户选择要保存到的文件名
2.  要加载文件，我需要用户选择现有文件

我在 API 中找不到任何文件对话框。有没有弹出文件选择对话框的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T19:57:01.437

*第一：这仅适用于 android，因为 iOS 不允许这样做。（当然你可以这样做，但在 iOS 上这没有意义，因为其他应用程序无法访问文件并且没有 SD 卡）。*

不幸的是，Titanium 中没有可用的文件对话框。您可以查看 Appcelerators 的现有插件市场，也可以自己尝试。

在 Android 上，您应该能够读取 SD 卡的内容并将它们显示在 tableview 中。您只需要[`Ti.Filesystem`](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.Filesystem)API。它允许读取和写入文件到 SD 卡。但请注意：Android 4.1+ 中发生了一些变化，因此似乎无法与其他应用共享文件，因为您无法使它们全局可读。（不可能有意分享这个文件 URL，我试过了。你需要一个 ContentProvider ，因为它需要本机扩展，所以用 Titanium 实现它并不容易。）但它们可能是可读的另一个文件管理器。

# c - valgrind 的内存泄漏

> ID：15853675
> 
> 赞同：1
> 
> 时间：2013-04-06T17:06:56.527
> 
> 标签：c, valgrind

这可能最终成为一个愚蠢的问题。我已经完成了以下功能：

```
char **getArrayOfStrings(int rows, int cols){
    int i;
    char **aux = malloc(rows * sizeof(char*));

    for(i = 0; i < rows; i++) 
        aux[i] = malloc(cols+1);

    return aux;
} 
```

这将返回一个“字符串”数组，重要的代码块类似于：

```
void f(...)
{
char **arrayOfStrings;
     int i = 0;
     arrayOfStrings = getArrayOfStrings(ROWS,COLS);

     while(ch != '.' && sscanf (globalString,"%[^,|.]s", arrayOfStrings[i]) > 0)       
     {
      globalString += strlen(arrayOfStrings[i++]) + 1;    
      ch =  (*globalString-1);                  /** take the terminal characters */ 
     }

    freeMemory(&arrayOfStrings,ROWS);

} 
```

其中 freeMemory 是：

```
void freeMemory(char ***matrix, int size){
    int i;

    for(i = 0; i < size; i++) free((*matrix)[i]);

    free(*matrix); 

    *matrix = NULL;
} 
```

完成我的应用程序后，我使用 valgrind 运行以查找内存泄漏（我第一次使用 valgrind）。

我收到以下错误：

```
Finding Invalid Pointer Use With Valgrind

    ==25012== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
    ==25012== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
    ==25012== Command: dist/Debug/GNU-MacOSX/app
    ==25012== 
    ==25012== Invalid read of size 8
    ==25012==    at 0x406445: f (Data.c:24)
    ==25012==    by 0x400BE3: main (main.c:27) 
```

我不知道我错过了什么，因为函数 getArrayOfStrings 对我来说似乎非常好（我本可以只使用一个 malloc，但这是另一个问题）。

* * *

**编辑**。

valgrind 指示的行是这个 f (Data.c:24)：

```
char **aux = malloc(rows * sizeof(char*)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T18:36:45.023

以我对 valgrind 的经验，它准确地表明非法访问已经完成。但是，您的输出似乎只显示与非法访问相关的指针及其分配位置。

这意味着我们可能正在查看错误的代码行。

仔细观察你的 while 循环：

```
 while(ch != '.' && sscanf (globalString,"%[^,|.]s", arrayOfStrings[i]) > 0)       
 {
  globalString += strlen(arrayOfStrings[i++]) + 1;    
  ch =  (*globalString-1);                  /** take the terminal characters */ 
 } 
```

如果由于某种原因，在最后一行`ch`不等于`.`非法访问将在`arrayOfStrings[rows]`. 分配行+1 是一种解决方法。内容是未知的，并且很可能没有`.`，使得 while 条件评估为 false 且没有非法访问。

我建议要么确保 a在最终迭代中出现，要么在你的 while 条件中`.`包含类似的东西`i < ROWS`

# android - 如何从android通过json向mysql插入多行？

> ID：15853677
> 
> 赞同：-1
> 
> 时间：2013-04-06T17:06:59.953
> 
> 标签：android, mysql, json

我正在尝试从android向mysql db插入多行，但我只知道如何插入一行

php脚本：

```
$r=mysql_query($sql);
if(!$r)
echo "Error in query: ".mysql_error();
mysql_close();
?> 
```

android文件的一部分：

```
 param = new ArrayList<NameValuePair>();
    param.add(new BasicNameValuePair("c_name", city));
    param.add(new BasicNameValuePair("s_name", street));

    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(url_select); 
```

如果我向参数数组列表添加更多条目，它会起作用吗？在循环中？就像是

```
for (String[] s : examp){
    param.add(new BasicNameValuePair("c_name", s[0]));
    param.add(new BasicNameValuePair("s_name", s[1]));
} 
```

或者我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T00:38:21.543

好的，我做的可能不是很干净，但它有效

我在循环中从光标获取数据，每次调用上传函数时

从游标数据库获取数据 db = new Database(this); 光标 c = db.getSpolecnostiUpSyn();

```
 int sp_id;
 String sp_spolecnost;

if (c != null ) {

if  (c.moveToFirst()) {
    do {
        sp_id = c.getInt(c.getColumnIndex(Database.COLUMN_ID_SPOLECNOST));
        sp_spolecnost = c.getString(c.getColumnIndex(Database.COLUMN_SPOLECNOST_SPOLECNOST));

        spolecnostNahraj(sp_id, sp_spolecnost); // for upload data each row
        Log.d("up spolecnost", "nahrano");
       }while (c.moveToNext());
   } 
}
} 
```

并上传

```
void spolecnostNahraj(int idspolecnosti,  String spolecnost){   

JSONArray jArray;
ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
//http post
try{
nameValuePairs.add(new BasicNameValuePair("spolecnost",spolecnost));

HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://***.cz/syn/****.php");
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs,"UTF-8"));
HttpResponse response = httpclient.execute(httppost);
HttpEntity entity = response.getEntity();
is = entity.getContent();
}catch(Exception e){
    Log.e("log_tag", "Error in http connection"+e.toString());
}
//convert response to string
try{
 BufferedReader reader = new BufferedReader(new InputStreamReader(is,"UTF-8"),8);
  sb = new StringBuilder();
  sb.append(reader.readLine() + "\n");

  String line="0";
  while ((line = reader.readLine()) != null) {
                 sb.append(line + "\n");
   }
   is.close();
   result=sb.toString();
   }catch(Exception e){
         Log.e("log_tag", "Error converting result "+e.toString());
   }
//paring data
int sp_id;
try{
 jArray = new JSONArray(result);
 JSONObject json_data=null;

 Database db = new Database(this);

 for(int i=0;i<jArray.length();i++){
        json_data = jArray.getJSONObject(i);
        sp_id=json_data.getInt("ID_Spol_Pumpa");

        db.opravOdSpolecnosti(idspolecnosti, sp_id);

        Log.d("id spolecnosti vlozenyho", String.valueOf(sp_id));

    }
 }
 catch(JSONException e1){
  Toast.makeText(getBaseContext(), "No City Found" ,Toast.LENGTH_LONG).show();
 } catch (ParseException e1) {
        e1.printStackTrace();
}

} 
```

我希望能帮助别人

# jquery - 使用 jquery 将焦点设置在链接之前的字段上

> ID：15853678
> 
> 赞同：0
> 
> 时间：2013-04-06T17:07:01.700
> 
> 标签：jquery, forms, datepicker

我有几个与 pickadate.js 一起使用的日期字段。当您聚焦该字段时，会弹出日期选择器。效果很好。

客户希望在每个字段旁边有一个图形图标，该图标应该将焦点设置到该字段（并因此弹出选择器），如下所示：

![拣货员](https://i.stack.imgur.com/YoDRt.png)

我的每个字段的代码是这样的：

```
<div class="date-picker">
    <label for="start-date">Start Date</label>
    <input id="start-date" class="datepicker" type="text" readonly="">
    <div class="date-button"><img src="/images/icon-datefield.png" alt=""></div>
</div> 
```

我已经尝试了一些这样的事情，但无济于事：

```
$('.date-button').click(function(){
    $(this).prev().focus();
}) 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:09:19.227

尝试

```
$('.date-button').click(function(){
$(this).prev().click();
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:09:56.057

而不是这个：

```
$(this).prev().focus(); 
```

尝试通过`.siblings()`方法获取元素并将`.focus()`事件触发：

```
$(this).siblings('input').focus(); 
```

* * *

根据您的最新评论：

```
$('.date-button').click(function () {
    $(this).siblings(".datepicker").datepicker().focus();
}); 
```

在这里，您也必须初始化日期选择器。

### [在小提琴中找到这个](http://jsfiddle.net/bNKdW/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:42:21.110

上面的答案更适合使用 jquery UI datepicker 来解决它，但如果有人想使用[datepicker.js](http://amsul.ca/pickadate.js/)，这终于奏效了：

```
var start_date_open = $( '#start-date' ).pickadate(),
    start_calendar_open = start_date_open.data( 'pickadate' ),
    start_button_open = $( '.date-button' ).on({
                    click: function() {
                        setTimeout( function() {
                            start_calendar_open.open()
                        }, 0)
                    }
                }); 
```

# osgi - 使 Sonar Runner Gradle 任务依赖于我的一项任务

> ID：15853688
> 
> 赞同：2
> 
> 时间：2013-04-06T17:07:49.203
> 
> 标签：osgi, gradle, sonarqube, bnd, runner

我正在尝试最近在 gradle 1.5 中发布的新 Sonar Runner 任务。我想做的是能够使声纳运行器任务依赖于另一个任务，以便我可以为这个项目正确设置声纳属性（即 sonar.sources、sonar.binaries、sonar.libraries、sonar.java.source , sonar.java.target)。

具体来说，我正在使用一个名为 bnd 的 osgi 构建工具，它将在执行 ant init 任务时提供这些值（请注意，虽然我包含了默认的 bnd build.xml 文件，但我的完整构建实际上是使用 gradle 完成的）。

我想我可以通过这样做来自定义声纳运行器任务（这是一个多模块构建）：

```
subprojects {
    sonarRunner.dependsOn init
} 
```

最终添加这样的东西（根据我对 bnd ant 变量的理解）：

```
subprojects {
    sonarRunner {
        sonarProperties {
            property "sonar.java.source", ant.property["project.sourcepath"]
            property "sonar.java.target", ant.property["project.output"]
            property "sonar.sources", ant.property["project.allsourcepath"]
            property "sonar.libraries", ant.property["project.buildpath"]
        }
    }

    sonarRunner.dependsOn init
} 
```

不幸的是，当我尝试添加dependsOn时出现错误：

```
* What went wrong:
A problem occurred evaluating root project 'myproject'.
> Could not find property 'init' on project ':com.company.myproject.mymodule'. 
```

如果我尝试让 sonarRunner 依赖于 gradle 任务，我会收到以下错误：

```
* What went wrong:
A problem occurred evaluating root project 'myproject'.
> Could not find method dependsOn() for arguments [task ':gradletask'] on org.gradle.api.sonar.runner.SonarRunnerExtension_Decorated@c4d7c0c. 
```

我在这里遗漏了一些明显的东西吗？如果有人能指出我正确的方向，那将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-07T17:07:06.767

您无法调用任务的问题`dependsOn()`来自`sonarRunner`插件定义了`sonarRunner`扩展和`sonarRunner`任务的事实。当对象在 gradle 构建文件中按名称解析时，扩展似乎优先于任务，因此您的堆栈跟踪指出您正在尝试调用`dependsOn()`实例`org.gradle.api.sonar.runner.SonarRunnerExtension_Decorated`而不是在`SonarRunner`任务实例上调用它。

我认为，如果您明确地从任务容器中检索任务，您应该没问题：

```
tasks.sonarRunner.dependsOn init 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-06T20:23:35.003

根项目 gradle 文件在子项目 gradle 文件之前被评估，这意味着 init 在您尝试解决它的位置不存在。

如果要在根项目中声明依赖项，一种解决方法是按照[http://www.gradle.org/docs/current/userguide/build_lifecycle.html](http://www.gradle.org/docs/current/userguide/build_lifecycle.html)中的描述使用 afterEvaluate ，尝试：

```
subprojects {
    afterEvaluate{
        sonarRunner.dependsOn init
    }
} 
```

另一种解决方案是直接或通过应用另一个根 gradle 文件在子项目中添加依赖项。

```
apply from: '../sonardependency.gradle' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T23:09:50.157

如果有人感兴趣，这是在声纳中为每个子项目正确设置 bnd 信息的一种方法（我相信有更好的方法）：

```
subprojects {
    afterEvaluate {
        sonarRunner {
            sonarProperties {
                ant.taskdef(resource:"aQute/bnd/ant/taskdef.properties",
                   classpath: "../cnf/plugins/biz.aQute.bnd/biz.aQute.bnd-2.0.0.jar");
                def projectDir = project.rootDir.toString() + "/" + project.name;
                ant.bndprepare(basedir:projectDir,print:"false",top:null);

                def binaries = ant.properties['project.buildpath'].split(':') as ArrayList;
                binaries.remove(0);
                def binariesString = binaries.join(',');
                properties["sonar.java.source"] = ant.properties['javac.source'];
                properties["sonar.java.target"] = ant.properties['javac.target'];
                properties["sonar.binaries"] = ant.properties['project.output'].replace(':',',');
                properties["sonar.sources"] = ant.properties['project.sourcepath'].replace(':',',');
                properties["sonar.libraries"] = binariesString;
            }
        }
    }
} 
```

# c# - 如何在 LINQ to Entities 查询中添加空格

> ID：15853692
> 
> 赞同：1
> 
> 时间：2013-04-06T17:08:06.350
> 
> 标签：c#, .net, entity-framework, linq-to-entities

在 linq-to-entities 查询中，在查询 nvarchar 列时，如何将空格添加到较短长度的值？

我寻求这种能力来促进对某些字段的正确排序。

**这是我的场景**：

我的数据库几乎在每个表中都包含*零件编号*列。这些零件号列在数据库中表示为 nvarchar(20)。它们通常包含 6 位和 8 位部件号的组合。这些部分“数字”中的绝大多数实际上是数字；但有些是非数字的。因此，它们被表示为字符串而不是整数。

因为这些部件号表示为字符串而不是数字，所以它们不能正确排序。6 位和 8 位值混合在一起，而不是单独分组。所以我想用前导空格填充较短的长度值来解决排序问题。

我确实意识到，如果这些列被存储为*nchar*而不是*nvarchar*，我会自动得到这个填充。但是此时更改这些列的数据类型不是一种选择。

当我制作自己的 linq 查询时，我可以正确排序：

```
db.table.Select(_ => _.partNumberColumn).OrderBy(_ => _.Length).ThenBy(_ => _); 
```

当其他工具（例如网格）自动组成查询时，就会出现问题。然后不知道额外的排序要求。因此，似乎一个好的解决方案是将空格添加到长度较短的值之前。

这是一个示例查询。当我构建模型时，我想在 6 个字符的值前面加上 2 个空格，而不仅仅是引入值。

```
_db.HubAssembliesWides
    .Select(_ =>
        new Models.HubAssemblyModel()
        {
            HubAssemblyNumber = _.HubAssemblyNumber,
            DetailedOnNumber = _.DetailedOnNumber,
            HubMachiningNumber = _.HubMachiningNumber,
            HubCastingNumber = _.HubCastingNumber,
            ComponentHubAssemblyNumber = _.ComponentHubAssemblyNumber
        }
    ); 
```

所以而不是

```
HubAssemblyNumber = _.HubAssemblyNumber 
```

我想

```
HubAssemblyNumber = _.HubAssemblyNumber.Length == 6 ? "  " + _.HubAssemblyNumber : _.HubAssemblyNumber 
```

这可以做到吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T18:08:41.217

惊喜！我没有意识到我提出的语法确实有效。

```
HubAssemblyNumber = _.HubAssemblyNumber.Length == 6 ? "  " + _.HubAssemblyNumber : _.HubAssemblyNumber 
```

当被 linq-to-entities 翻译成 T-SQL 时，被翻译成***case***语句。

# ios - 使用 CoreData，如果我有一个 @dynamic 属性，我可以像 @synthesized 一样覆盖它的 getter 吗？（惰性实例化）

> ID：15853696
> 
> 赞同：20
> 
> 时间：2013-04-06T17:08:10.850
> 
> 标签：ios, objective-c, core-data, nsmanagedobject

使用 CoreData 我创建了一个实体，然后将其子类化到它自己的文件中，其中包含 @propertys，然后在 .m 文件中包含 @dynamic 部分。

当我希望某个从未设置过的东西具有一定的价值时，我总是使用惰性实例化，如下所示：

```
- (NSString *)preview {
    if ([self.body length] < 200) {
        _preview = self.body;
    }
    else {
        _preview = [self.body substringWithRange:NSMakeRange(0, 200)];
    }

    return _preview;
} 
```

但是我如何使用@dynamic 属性来做到这一点？如果我做同样的事情，它会说 _preview 是一个未声明的属性，但它在 .h 文件中。我对惰性实例化有什么不同？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-06T17:20:51.830

一种标准方法是在 Core Data 模型中定义`preview`为*瞬态属性*（这样该值实际上并不存储在数据库中），并实现自定义 getter 方法。在您的情况下，它看起来像：

```
- (NSString *)preview
{
    [self willAccessValueForKey:@"preview"];
    NSString *preview = [self primitiveValueForKey:@"preview"];
    [self didAccessValueForKey:@"preview"];
    if (preview == nil) {
        if ([self.body length] < 200) {
            preview = self.body;
        } else {
            preview = [self.body substringWithRange:NSMakeRange(0, 200)];
        }
        [self setPrimitiveValue:preview forKey:@"preview"];
    }
    return preview;
} 
```

（您可以为 @dynamic 属性提供自定义的 getter、setter 方法。但是，Core Data 属性并不是简单地由实例变量备份。这就是您无法访问的原因`_preview`。）

如果您需要在属性更改时`preview`重新计算`body`，那么您还必须实现一个自定义的 setter 方法以`body`将其设置`preview`回`nil`.

有关更多信息，请阅读“核心数据编程指南”中的[非标准持久属性](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html#//apple_ref/doc/uid/TP40001919-SW1)。

*更新：*当前版本的核心数据编程指南不再包含该章节。您可以从[Way Back Machine](http://web.archive.org/web/20150908004746/https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreData/Articles/cdNSAttributes.html)中找到存档版本。当然，这必须持保留态度，因为它不再是官方文档的一部分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-06T17:18:24.543

请参阅有关使用的[文档](https://developer.apple.com/reference/coredata/nsmanagedobject/1506728-primitivevalueforkey)`primitiveValueForKey:`

基本上：

```
@dynamic name;

- (NSString *)name
{
    [self willAccessValueForKey:@"name"];
    NSString *myName = [self primitiveName];
    [self didAccessValueForKey:@"name"];
    return myName;
}

- (void)setName:(NSString *)newName
{
    [self willChangeValueForKey:@"name"];
    [self setPrimitiveName:newName];
    [self didChangeValueForKey:@"name"];
} 
```

# android - 带有 UTF8 文本的 POST 以 ASCII 形式出现

> ID：15853697
> 
> 赞同：1
> 
> 时间：2013-04-06T17:08:12.363
> 
> 标签：android, post, utf-8

我用这段代码打了 4 个小时，也许我做错了什么。“文本”像“？？？”一样来到服务器

我检查了日志：

```
error_log(mb_detect_encoding($_POST['text'])) 
```

它给了我ASCII。

```
 /**
     * Send the question to the server
     */
    private void sendQuestion() {
        final String uid = getContext().getSharedPreferences(LoginActivity.PREFS_NAME, 0).getString("uid", "0");
        final String text = ((EditText) findViewById(R.id.question_et)).getText().toString();

        final MultipartEntity multipartEntity = new MultipartEntity();

        if (mFile != null) {
            final FileBody fileBody = new FileBody(mFile);
            multipartEntity.addPart("userfile", fileBody);
        }

        try {
            multipartEntity.addPart("uid", new StringBody(uid));
            multipartEntity.addPart("type", new StringBody(mFile == null ? "1" : "2"));
            multipartEntity.addPart("category", new StringBody(String.valueOf(mCategoryId + 1)));
            multipartEntity.addPart("text", new StringBody(URLEncoder.encode(text, "UTF-8")));

        } catch (UnsupportedEncodingException e) {
        }

        final HttpParams httpParameters = new BasicHttpParams();
        HttpProtocolParams.setContentCharset(httpParameters, HTTP.UTF_8);
        HttpProtocolParams.setHttpElementCharset(httpParameters, HTTP.UTF_8);

        final HttpPost httpPost = new HttpPost("http://site.ru/add.php");
        httpPost.setEntity(multipartEntity);

        final HttpClient httpClient = new DefaultHttpClient(httpParameters);

        new AsyncTask<Void, Void, Void>() {

            @Override
            protected void onPreExecute() {
                super.onPreExecute();

                Toast.makeText(getContext(), "Ваш вопрос отправлен, ждите ответа", Toast.LENGTH_LONG).show();
            }

            @Override
            protected Void doInBackground(Void... voids) {
                try {
                    final HttpResponse httpResponse = httpClient.execute(httpPost);
                    final int code = httpResponse.getStatusLine().getStatusCode();
                    final String response = EntityUtils.toString(httpResponse.getEntity());
                } catch (IOException e) {
                    e.printStackTrace();
                }

                return null;
            }

        }.execute();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T16:48:32.790

这是正确的答案（根据评论:)）

尝试直接在 StringBody 对象上设置编码。

通过`StringBody(String text, Charset charset)`使用

如果您不设置编码，`US-ASCII charset`则使用 ，这不是您想要的。

[Stringbody 构造函数的 JavaDoc](http://hc.apache.org/httpcomponents-client-ga/httpmime/apidocs/org/apache/http/entity/mime/content/StringBody.html#StringBody%28java.lang.String,%20java.nio.charset.Charset%29)

# html - 在 HTML 中显示未知的新行

> ID：15853705
> 
> 赞同：-1
> 
> 时间：2013-04-06T17:08:59.053
> 
> 标签：html, html-table

我正在使用这个简单的 HTML 代码

```
<html>

    <head>
        <meta name='viewport' content='width=device-width; initial-scale=1.0;
         maximum-scale=1.0; user-scalable=0;' />
        <meta name='apple-mobile-web-app-capable' content='yes' />
    </head>

    <body>
        <div align='center'>
            <img src='data:image/png;base64,Base64_code' />
        </div>
        <br/>
        <table>
            <tr>
                <td>
                    <br/>April 2, 2013
                    <br/>xxxxxxx
                    <br/>
                    <br/>2xxxxx xxxxxxx
                    <br/>xxxxxxxx
                    <br/>
                    <br/>Hello xxxx,
                    <br/>
                </td>
                <br/>
                <td>
                    <br/>
                    <img src='data:image/jpeg;base64,Base64_code' />
                    <br/>
                </td>
                <br/>
            </tr>
            <br/>
            <tr>
                <br/>
                <td colspan='2' align='center'>
                    <br/>
                     <h2><font color='blue'>xxxxxxxxxxx</font></h2>

                    <br/>
                </td>
                <br/>
            </tr>
            <br/>
            <tr>
                <br/>
                <td>
                    <br/>xxxxxxxxxxxx
                    <br/>
                    <br/>xxxxx xxxxx
                    <br/>
                    <br/>xxxxxxx
                    <br/>
                    <br/>xxxxxxxx
                    <br/>
                    <br/>xxxxxx
                    <br/>
                    <br/>
                    <br/>xxxx
                    <br/>xxxx
                    <br/>xxxxxx
                    <br/>
                </td>
                <br/>
                <td>
                    <br/>
                    <img src='data:image/jpeg;base64,/9j/
               +691//2Q==' />
                    <br/>
                </td>
                <br/>
            </tr>
            <br/>
        </table>
    </body>

</html> 
```

但是在显示时，它有一些未知的新行：

我使用 Inspect Element of Chrome 并看到类似的东西

![在此处输入图像描述](https://i.stack.imgur.com/tBioH.jpg)

我不知道原因！我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T17:16:15.667

tr 元素的[内容模型](http://www.w3.org/TR/html5/tabular-data.html#the-tr-element)是“零个或多个 td 或 th 元素”。

由于那里不允许使用 br 元素，因此您的浏览器正试图通过将其移动到表格之前来从错误中恢复。

要解决此问题，请[编写有效的 HTML](http://validator.w3.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:12:48.047

`<br/>`从您的遗嘱中删除所有`<tr>`内容可以解决您的问题。

# google-app-engine - App Engine HRD 迁移后，我的应用程序将无法加载任何人都知道有什么问题吗？

> ID：15853706
> 
> 赞同：-2
> 
> 时间：2013-04-06T17:08:59.870
> 
> 标签：google-app-engine

我刚刚尝试迁移（我还没有完成别名位），但是当我尝试运行应用程序时出现 500 个错误。

这是日志中的一堆错误，这表明服务器部分只是没有运行，或者不存在或其他什么......我在下面的仪表板中包含了错误以及日志中的一个严重错误是：

> 2013-04-06 17:14:44.584 servlet javax.servlet.UnavailableException 未捕获的异常：初始化失败。在 com.google.apphosting.runtime.jetty.AppVersionHandlerMa

```
Errors           URI Count % Errors

/process/actions     6      100%
/demo                5      100%
/Login/admin         4      100%
/images/hborder.png  3      100% 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:54:01.993

好的，所以我对项目进行了“干净构建”并重新部署它，然后它似乎开始工作，但是没有一个索引是正确的，所以我不得不手动重建它们..不确定那里发生了什么，但是我没有时间研究它我需要尽快重新生活！

# linux - UNIX Shell：列出目录中除目录名之外的所有文件

> ID：15853708
> 
> 赞同：1
> 
> 时间：2013-04-06T17:09:15.680
> 
> 标签：linux, shell, recursion, tree, ls

我想递归地列出目录中的所有文件。我将此输出存储在一个文件中，稍后我将遍历该文件并将每一行用作另一个命令中的参数。

但是，我尝试过的所有命令都将目录名称列为输出行之一，后跟目录中包含的文件和目录。

我尝试了以下方法：

```
tree -if --noreport . > files_names.txt 
```

这给了我一些成功，但它仍然打印目录。示例输出如下：

```
/testdir
/testdir/rightfolder/
/testdir/rightfolder/file2.txt
/testdir/rightfolder/file3.txt
/testdir/wrongfolder/
/testdir/wrongfolder/file.txt 
```

我已经检查了树和 ls 的手册页。

是否有标志或其他命令会给我正确的输出。我考虑过使用树的标志来列出目录，然后从原始列表中删除所有这些条目，但这一点也不优雅。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T17:11:52.223

您可以`find(1)`按类型使用和过滤：

```
find ./ -type f 
```

# delphi - Firefox 从 Delphi 获取和更改 url

> ID：15853712
> 
> 赞同：1
> 
> 时间：2013-04-06T17:09:28.057
> 
> 标签：delphi, url, firefox

有没有办法让当前的 url 在 Firefox 中输入，然后基于重播来更改该文本。我可以找到用 DDEClient 打开的 url，但我不知道如何更改它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T15:57:48.233

许多年前，我是这样使用它的（只是一个片段）：

```
 ...
    DdeClientConv:=TDdeClientConv.Create(nil);
    try with DdeClientConv do
      begin
        if SetLink(Browser, 'WWW_OpenURL') then
          begin
            PCH := RequestData(Format('"%s",,%d',[AURL,0]));
            if Assigned(PCH) then
              begin
                PD := PDWORDS(PCH);
                if PD^[0]=dword(-3) then
                  ShellExecute(GetDesktopWindow(),'Open',PChar(AURL),nil,nil,SW_SHOWNORMAL);
                StrDispose(PCH);
              end;
          end
        else
          ShellExecute(GetDesktopWindow(),'Open',PChar(AURL),nil,nil,SW_SHOWNORMAL)
      end;
    finally
      DdeClientConv.Free;
    end;
    ... 
```

# html - JQuery 和 Perl 在下拉选择中显示动态结果

> ID：15853714
> 
> 赞同：0
> 
> 时间：2013-04-06T17:09:30.010
> 
> 标签：html, ajax, perl, jquery

我目前正在使用 Perl CGI 在工作中显示一些内部计费页面。如果你愿意的话，我也在使用 JQuery 来添加一点“勇气”。

我希望根据用户的下拉选择生成/显示 HTML。现在，我可以处理这部分没有问题。我正在根据用户所做的选择在点击时生成表格行/表格数据。

我想检索并显示存储在数据库中的值，以便在单击按钮时显示相应的数据，并且当然不刷新页面。

有人可以指出我正确的方向吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:14:46.323

您需要使用 AJAX 请求来获取数据。因此，例如，如果您有一个带有“ajax”类的选择，并且您想根据所选选项显示数据，您可以执行以下操作：

```
$('.ajax').change(function(){
    $.get({'url', { value: this.val() }, function(data){
        // display the data with a .html() or .append() or something
    });
}); 
```

将“url”替换为使用您发送的值查询数据库的页面的 url。

# python - Django ModelChoiceField 在 django.contrib.auth 和 Profile 表中显示值

> ID：15853715
> 
> 赞同：0
> 
> 时间：2013-04-06T17:09:37.163
> 
> 标签：python, django, django-models, django-forms

我对 python 或 django 非常陌生。我继承了一些需要“修复”的代码，我可以使用一些帮助。

情况如下：

我们有一个下拉框，您可以从中选择多个用户。目前，用户显示为用户名。我们希望它们显示为全名。

问题：用户名来自：`django.contrib.auth`

名字和姓氏来自配置文件模型。下面是 Profile 模型的样子：

```
class Profile(models.Model):
CURRENTLY_STUDENT = "STU"
CURRENTLY_PROFESSOR = "PFR"
CURRENTLY_CHOICES = [
    (CURRENTLY_STUDENT, "Student"),
    (CURRENTLY_PROFESSOR, "Professor"),
]

user = models.OneToOneField(User, related_name="profile")
currently_am = models.CharField(max_length=3, choices=CURRENTLY_CHOICES, default=CURRENTLY_STUDENT)
first_name = models.CharField(max_length=50)
last_name = models.CharField(max_length=50) 
```

如果您必须显示全名，我们使用以下内容：

```
user.profile.display_name 
```

其中 display_name 是：

```
def display_name(self):
        name = "%s %s" % (self.first_name, self.last_name)
    return name 
```

下面是forms.py中下拉框的代码：

```
 from django import forms
 from django.contrib.auth.models import User
 from account.utils import user_display

class UserMultipleChoiceField(forms.ModelMultipleChoiceField):

def label_from_instance(self, obj):
    return user_display(obj)

class ShareForm(forms.Form):

participants = UserMultipleChoiceField(
    queryset=User.objects.none(),
    label="",
    widget=forms.SelectMultiple(
        attrs={
            "data-placeholder": "Choose members.. "
        }
    )
) 
```

以下是 account/utils.py 中的代码`user_display`

```
from account.conf import settings

def user_display(user):
return settings.ACCOUNT_USER_DISPLAY(user) 
```

这是来自 account/conf.py 的代码

```
class AccountAppConf(AppConf):
USER_DISPLAY = lambda user: user.username 
```

*   您不能使用`obj.get_full_name()`名字和姓氏不是来自 django.contrib.auth 而是存储在上述配置文件模型中。

*   您也不能使用 return obj.profile.display_name()，因为 ModelChoiceField 是在 django.contrib.auth 上绘制的。

有人可以帮我解决这个问题吗？一旦有人从下拉列表中做出选择并点击提交，如何在下拉框中显示全名并仍将“用户”作为值传递？

感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:17:35.667

好吧，您可以将自定义选择分配为：

```
choices = [(obj.id, obj.profile.display_name()) for obj in User.objects.all()]

participants = UserMultipleChoiceField(
    queryset=User.objects.none(),
    label="",
    widget=forms.SelectMultiple(
        attrs={
            "data-placeholder": "Choose members.. "
        }
    ),
    choices=choices
) 
```

# java - 在java中设置JTable中行的高度

> ID：15853720
> 
> 赞同：18
> 
> 时间：2013-04-06T17:10:24.930
> 
> 标签：java, swing, jtable, row-height

我一直在寻找一种能够增加 JTable 中行高的解决方案。我一直在使用 setRowHeight(int int) 方法，该方法可以编译并运行正常，但没有增加任何行 [s]。当我使用设置高度的行的 getRowHeight(int) 方法时，它会打印出我将行增加到的大小，所以我不确定出了什么问题。下面的代码是我试图解决它的粗略说明。

我的课程扩展了 JFrame。

```
String[] columnNames = {"Column 1", "Column 2", "Column 1 3"};

JTable table = new JTable(new DefaultTableModel(columnNames, people.size()));

DefaultTableModel model = (DefaultTableModel) table.getModel();

int count =1;
for(Person p: people)
{
    model.insertRow(count,(new Object[]{count, p.getName(), p.getAge()+"", 
    p.getNationality}));
    count++;
}

table.setRowHeight(1, 15);//Try set height to 15 (I've tried higher) 
```

谁能告诉我哪里出错了？我正在尝试将第 1 行的高度增加到 15 像素？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-06T17:14:12.357

您可以使用：

`table.setRowHeight(int par1);`

或者，如果您想为特定行设置行高，请使用：

`table.setRowHeight(int par1, int par2);`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-04-06T18:19:27.190

不确定将索引 0 处的第一行留空的目的是什么。从索引 0 开始运行的行。`JTable`最好发布一个完整的示例（即[SSCCE](http://sscce.org/)）来演示这些问题。与这个运行良好的简单示例进行比较：

![在此处输入图像描述](https://i.stack.imgur.com/l0xMP.png)

```
import javax.swing.*;
import javax.swing.table.DefaultTableModel;

public class DemoTable {
    private static void createAndShowGUI() {
        JFrame frame = new JFrame("DemoTable");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        DefaultTableModel model = new DefaultTableModel();
        model.setColumnIdentifiers(new Object[] {
                "Column 1", "Column 2", "Column 3" });

        JTable table = new JTable(model);
        for (int count = 0; count < 3; count++){
            model.insertRow(count, new Object[] { count, "name", "age"});
        }
        table.setRowHeight(1, 30);

        frame.add(new JScrollPane(table));
        frame.setLocationByPlatform(true);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-12T17:52:44.367

右键单击 JFrame 中的 JTable，然后单击属性。向下滚动并设置 rowHeight 值。

[![设置 rowHeight 值](https://i.stack.imgur.com/AyGpN.png)](https://i.stack.imgur.com/AyGpN.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-06T17:40:33.510

你也可以添加一个tableModelListener？

```
model.addTableModelListener(new TableModelListener() {
    @Override public void tableChanged(final TableModelEvent e) {
        EventQueue.invokeLater(new Runnable() {
            @Override public void run() {
                table.setRowHeight(e.getFirstRow(), 15); //replace 15 with your own height
            }
        });
    }
}); 
```

# javascript - Javascript/jQuery - 数组中的 IF 和 IF 值：对

> ID：15853727
> 
> 赞同：0
> 
> 时间：2013-04-06T17:10:31.560
> 
> 标签：javascript, jquery

我有一个数值**：对**列表如下：

```
var level1 = {0:1,1:0,2:0,3:0,4:0,5:0,6:0,1:1,2:1,3:1,4:1,5:1}; 
```

...如果我将它重写为这样的数组（这将失去它的数字格式）：

```
var level1 = ['0:1','1:0','2:0','3:0','4:0','5:0','6:0','1:1','2:1','3:1','4:1','5:1']; 
```

...我可以通过以下方式检查值是否存在这样的数组：

```
if($.inArray(value, level1) > -1)
{
    // let's party    
} 
```

**如何检查上面的 value:pair 列表中是否存在数值：pair？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T17:12:17.880

在第一个示例中，您使用 JavaScript*对象*，而不是数组。因此要检查具有名称的元素是否`value`存在并且等于`pair`使用：

```
if (level1[value] === pair) {
    // ...
} 
```

但您也应该注意，对象属性是独一无二的。这意味着对象中不能有多个具有相同名称的属性，例如`{ a: 1, b: 2, a: 3 }`- 它最终会导致`{ a: 3, b: 2 }`. 因此，在您的情况下，最好使用数组。

**阅读更多：** [https ://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:16:54.710

不确定您的确切意思；如果你的意思是搜索一个值：对，那么 VisioN 的解决方案是完美的。但是假设您不想检查例如该对是否`2:0`存在，但您想获取以您`level1`开头的所有条目的列表，`2`您可以使用：

```
level1.filter(function(v){ return v[0] === '2'; }) 
```

# c# - XAML 中的图像按钮样式问题

> ID：15853730
> 
> 赞同：0
> 
> 时间：2013-04-06T17:11:19.147
> 
> 标签：c#, xaml, windows-8, microsoft-metro, winrt-xaml

我有一个 XAML 代码如下：

```
<Button 
    x:Name="stopButton" 
    Click="Stop_Click" 
    IsEnabled="False" 
    HorizontalAlignment="Right" 
    Height="75" 
    Width="75" 
    Grid.Column="1" 
    Margin="0,15,60,0" 
    BorderBrush="{x:Null}" 
    Visibility="Collapsed" >
    <Button.Background>
        <ImageBrush ImageSource="Images/stop.png"/>
    </Button.Background>
</Button> 
```

stop.png 是[以下图像](http://www.reignofcomputer.com/tmpsend/stop.png)

该按钮在应用程序中的事件期间启用，按下可停止媒体播放。按下按钮时，它变为白色，如下图所示：![正常、悬停和按下状态之间的比较](https://i.stack.imgur.com/EnjXB.png)

我知道这是由于一些 Button Style 问题，并且想知道如何让这个工作更好地为我作为一个按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:58:22.657

如果此按钮在 AppBar 中，请为停止按钮使用预定义样式：

```
<Button Style="{StaticResource StopAppBarButtonStyle}" /> 
```

您只需在 Common/StandardStyles.xaml 中取消注释（该文件包含在项目中）

如果按钮不在 AppBar 中，您可以设置 Segoe UI Symbol 字体和停止字符代码：

```
<Button FontFamily="Segoe UI Symbol" Content="&#xE1B5;"/> 
```

你可以在这里看到符号：

[http://blogs.msdn.com/b/mohamedg/archive/2012/10/12/useful-segoe-ui-symbols.aspx](http://blogs.msdn.com/b/mohamedg/archive/2012/10/12/useful-segoe-ui-symbols.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T06:02:47.030

您必须为按钮创建自定义样式。根据需要设置所有视觉状态。

[按钮样式和模板](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/jj709909.aspx#Default_style)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T15:11:12.337

使用视觉状态改变按钮样式

```
 <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="btnEffect">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="Red" />
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Pressed">
                 <Storyboard>

                  <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Text" Storyboard.TargetName="BackgroundGlyph">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="&#xE19A;" />
                    </ObjectAnimationUsingKeyFrames>
                 <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="btnEffect">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="Black" />
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
              </VisualState>
              <VisualState x:Name="Disabled">

              </VisualState>
            </VisualStateGroup>

          </VisualStateManager.VisualStateGroups>

          <StackPanel Name="btnEffect" Opacity="1"  Width="100" Height="100" Background="Gray" Canvas.ZIndex="100" >
              <TextBlock x:Name="BackgroundGlyph" Text="&#xE0A8;" 
                         FontFamily="Segoe UI Symbol" FontSize="53.333" Margin="-4,-19,0,0" 
                         Foreground="White"
                         Canvas.ZIndex="150"
            />

          </StackPanel>

        </Grid>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

# delphi - 使用 WinAPI 将击键发送到另一个应用程序

> ID：15853732
> 
> 赞同：7
> 
> 时间：2013-04-06T17:11:31.643
> 
> 标签：delphi, winapi, delphi-7, sendmessage, postmessage

我必须通过向它发送击键来控制另一个应用程序，例如`CTRL``S`or`CTRL``SHIFT``C`或`CTRL``F`。

我已经尝试了很多东西，但我无法让它工作。所以我试图在一个更简单的情况下做到这一点。

这成功发送`Hey`到记事本：

```
procedure TForm1.Button1Click(Sender: TObject);
  var notepad, edit: HWND;
begin
  notepad := FindWindow('notepad', nil);
  edit := FindWindowEx(notepad, FindWindow('Edit', nil), nil, nil);

  SendMessage(edit, WM_CHAR, dword('H'), 0);
  SendMessage(edit, WM_CHAR, dword('e'), 0);
  SendMessage(edit, WM_CHAR, dword('y'), 0);
end; 
```

这成功地将`F5`密钥发送到记事本，并且还可以`F3`弹出“查找”对话框。

```
notepad := FindWindow('notepad', nil);
PostMessage(notepad, WM_KEYDOWN, VK_F5, 0);
PostMessage(notepad, WM_KEYUP, VK_F5, 0); 
```

但我不知道为什么 using`SendMessage`在上面的例子中不起作用。

我能想到的最好的事情就是这样，它什么也没做。

```
notepad := FindWindow('notepad', nil);
PostMessage(notepad, WM_KEYDOWN, VK_CONTROL, 0);
PostMessage(notepad, WM_KEYDOWN, VkKeyScan('F'), 0);
PostMessage(notepad, WM_KEYUP, VkKeyScan('F'), 0);
PostMessage(notepad, WM_KEYUP, VK_CONTROL, 0); 
```

我在这里的某个地方找到了一个库，它有点模拟 VBScript 发送键功能，但只是查看代码，它似乎只是将键广播到当前应用程序或所有应用程序，因为没有 Handle 参数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T17:14:39.913

***警告：**此方法取决于实现细节，如果您需要保证程序的正确性，则不应使用此方法。*（另一方面，您已经走上了这条路。例如，IIRC，在 Windows 95 中甚至没有`Go to`对话框。）

我`notepad.exe`在我最喜欢的资源编辑器中打开，并调查了菜单栏。我注意到`Save`菜单项的 ID 是`3`. 因此，以下代码`Save`在记事本中执行菜单命令：

```
var
  notepad: HWND;
begin
  notepad := FindWindow('notepad', nil);

  SendMessage(notepad, WM_COMMAND, 3, 0); 
```

同样，`Find`在`21`我的`notepad.exe`. `Go to`是`24`。

**更新，根据评论：**如果你需要发送`Ctrl`+ `Key`，你可以使用`SendInput`：

```
var
  notepad: HWND;
  inputArray: array[0..3] of TInput;
begin
  notepad := FindWindow('notepad', nil);

  // TODO: Either exit if notepad isn't focused, or set focus to notepad

  FillChar(inputArray, length(inputArray) * sizeof(TInput), 0);

  inputArray[0].Itype := INPUT_KEYBOARD;
  inputArray[0].ki.wVk := VK_LCONTROL;
  inputArray[1].Itype := INPUT_KEYBOARD;
  inputArray[1].ki.wVk := VkKeyScan('S');
  inputArray[2].Itype := INPUT_KEYBOARD;
  inputArray[2].ki.wVk := VkKeyScan('S');
  inputArray[2].ki.dwFlags := KEYEVENTF_KEYUP;
  inputArray[3].Itype := INPUT_KEYBOARD;
  inputArray[3].ki.wVk := VK_LCONTROL;
  inputArray[3].ki.dwFlags := KEYEVENTF_KEYUP;

  SendInput(length(inputArray), inputArray[0], sizeof(TInput)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-06T23:58:04.550

我已经使用 keybd_event 多年了。即使其他一切都失败了，它也将始终工作，因为它将输入直接馈送到键盘驱动程序和 Windows 之间的接口。手动输入和使用下面的函数生成密钥之间确实没有区别。唯一的缺点是目标窗口必须始终保持在前台。

```
procedure SendKey(Wnd,VK : Cardinal; Ctrl,Alt,Shift : Boolean);
var
  MC,MA,MS : Boolean;
begin
  // Try to bring target window to foreground
  ShowWindow(Wnd,SW_SHOW);
  SetForegroundWindow(Wnd);

  // Get current state of modifier keys
  MC:=Hi(GetAsyncKeyState(VK_CONTROL))>127;
  MA:=Hi(GetAsyncKeyState(VK_MENU))>127;
  MS:=Hi(GetAsyncKeyState(VK_SHIFT))>127;

  // Press modifier keys if necessary (unless already pressed by real user)
  if Ctrl<>MC then keybd_event(VK_CONTROL,0,Byte(MC)*KEYEVENTF_KEYUP,0);
  if Alt<>MA then keybd_event(VK_MENU,0,Byte(MA)*KEYEVENTF_KEYUP,0);
  if Shift<>MS then keybd_event(VK_SHIFT,0,Byte(MS)*KEYEVENTF_KEYUP,0);

  // Press key
  keybd_event(VK,0,0,0);
  keybd_event(VK,0,KEYEVENTF_KEYUP,0);

  // Release modifier keys if necessary
  if Ctrl<>MC then keybd_event(VK_CONTROL,0,Byte(Ctrl)*KEYEVENTF_KEYUP,0);
  if Alt<>MA then keybd_event(VK_MENU,0,Byte(Alt)*KEYEVENTF_KEYUP,0);
  if Shift<>MS then keybd_event(VK_SHIFT,0,Byte(Shift)*KEYEVENTF_KEYUP,0);
end; 
```

# html - 混合 http 和 https

> ID：15853740
> 
> 赞同：2
> 
> 时间：2013-04-06T17:12:23.367
> 
> 标签：html, http, https

我的理解是，如果您有一个 https 站点，您希望所有外部文件（js、css、图像等）也都是 https，以免您收到有关某些内容不安全或其他内容的警告。

好吧，我只是尝试了一下，根本没有收到任何警告。

我在哪里可以看到这些警告？另外，假设这是真的……相反的是真的吗？如果您在 http 网站上包含 https 内容，您会冒任何警告的风险吗？

FWIW我试过这个：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

谷歌默认有人这样做：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

这样就可以了，因此它可以从 http 或 https 获取，具体取决于您的网站使用的内容。当然，如果 http 上的 https 没有给出任何警告，似乎对所有 js 文件执行 https 也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T21:01:21.913

错误消息将显示在用户/查看者的浏览器上。[此站点]（[https://security.stackexchange.com/questions/1692/is-posting-from-http-to-https-a-bad-practice](https://security.stackexchange.com/questions/1692/is-posting-from-http-to-https-a-bad-practice)）有一些解释为什么会出现错误消息。

假设你问的是 google 的代码是如何工作的，它被称为协议相对 URL。链接文件的协议将继承包含它的页面的协议。因此，如果您的页面是 https，那么它将通过 https 发送。

您可以使用

```
<script src="https://ajax.googleapis.com/ajax/jquery/1.8.3/jquery.min.js"></script> 
```

或者删除“https：”并通过 https 发送 js，前提是您的页面是 https。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:39:24.740

再补充一点，如果您在 https 网页上通过 http 加载内容，那么您会收到警告，但如果您反其道而行之，则不会有任何警告，但请记住，https 比 http 慢。因此，仅在 https 页面上使用 https。

# linux - 无法更新 metasploit 框架

> ID：15853741
> 
> 赞同：1
> 
> 时间：2013-04-06T17:12:29.163
> 
> 标签：linux, backtracking

我是回溯 5 r3 的新手。当我尝试执行命令时`msfupdate`，出现以下错误。

> 安装 pg (0.15.0) 时出错，Bundler 无法继续。`gem install pg -v '0.15.0'`在捆绑之前确保成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T21:56:57.420

我修改了这个文件：/opt/metasploit/ruby/lib/ruby/1.9.1/i686-linux/rbconfig.rb

更改行 => CONFIG["LIBRUBYARG_STATIC"] = "-Wl,-R -Wl,$(libdir) -L$(libdir) -l$(RUBY_SO_NAME)-static" 由 => CONFIG["LIBRUBYARG_STATIC"] = "-Wl,-R -Wl,$(libdir) -L$(libdir)"

转到 /opt/metasploit/msf3 并运行 /opt/metasploit/ruby/bin/bundle install

信用——http : [//top-hat-sec.com/forum/index.php?](http://top-hat-sec.com/forum/index.php?topic=2668.0) topic= 2668.0——鲍比

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T12:58:12.793

## In my ubuntu system

> sudo apt-get install libpq-dev
> 
> gem install pg -v '0.15.0'

# java - Java 简单的绕点旋转

> ID：15853742
> 
> 赞同：1
> 
> 时间：2013-04-06T17:12:34.043
> 
> 标签：java, rotation, affinetransform

我正在尝试使用这种方法来旋转一个点：

```
 AffineTransform at = AffineTransform.getRotateInstance(Math.toRadians(90), 1, 2);
 double[] pt = {0, 1};
 at.transform(pt, 0, pt, 0, 1);
 int x = (int)pt[0];
 int y = (int)pt[1]; 
```

预期的结果是`x=0`and`y=3`因为我们顺时针旋转了 90*，但是当前的输出是`x=2`and `y=1`;

为什么我没有得到预期的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T17:27:34.843

该程序没有做错任何事情。通过指定`Math.toRadians(90)`您的 theta，您指示它逆时针旋转，而不是顺时针旋转。这就是三角学中旋转的定义方式。

使用`-Math.toRadians(90)`会给你正确的结果。

另外，作为旁注，将点值转换`int`为并不是检查代码的最佳方法。双精度三角函数容易出现非常小的错误，因此错误方向上的微小碰撞会使您得到错误的整数。（即，2.99999999995 将被转换为 2）

`(int) Math.round(value)`更安全

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T17:28:00.137

实际上，你是在逆时针旋转。Javadoc 说：

> 旋转正角度 theta 将正 X 轴上的点向正 Y 轴旋转

请参阅[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/awt/geom/AffineTransform.html#getRotateInstance%28double%29)

# c# - 如何从 DataGridView 控件打印值

> ID：15853746
> 
> 赞同：5
> 
> 时间：2013-04-06T17:12:52.243
> 
> 标签：c#, winforms, printing, datagridview

我有一个应用程序，它有一个`DataGridView`控件，当按下“打印”按钮时，它保存着我想要打印出来的数据。

到目前为止，我已经让“打印”按钮工作了，但是当我在应用程序上打印时，页面出现空白！

如何编辑我的代码以启用要打印的数据？

```
public partial class frmViewBookings : Form
{
    private void btnClose_Click(object sender, EventArgs e)
    {
        Form3 mainpage = new Form3();
        mainpage.Show();
        this.Close();
    }

    private void frmViewBookings_Load(object sender, EventArgs e)
    {
        this.bookingTableAdapter.Fill(this.usersDataSet1.Booking);
    }

    private void printDocument1_PrintPage(object sender, PrintPageEventArgs e)
    {
        var myPaintArgs = new PaintEventArgs
        (
            e.Graphics,
            new Rectangle(new Point(0, 0), this.Size)
        );

        this.InvokePaint(dataGridView1, myPaintArgs);
    } 

    private void btnPrint_Click(object sender, EventArgs e)
    {
        printDocument1.Print();
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-06T17:21:02.283

我以前测试过这个类的打印`data grid view`内容

将此类添加到您的项目中：

```
 class ClsPrint
    {
        #region Variables

        int iCellHeight = 0; //Used to get/set the datagridview cell height
        int iTotalWidth = 0; //
        int iRow = 0;//Used as counter
        bool bFirstPage = false; //Used to check whether we are printing first page
        bool bNewPage = false;// Used to check whether we are printing a new page
        int iHeaderHeight = 0; //Used for the header height
        StringFormat strFormat; //Used to format the grid rows.
        ArrayList arrColumnLefts = new ArrayList();//Used to save left coordinates of columns
        ArrayList arrColumnWidths = new ArrayList();//Used to save column widths
        private PrintDocument _printDocument = new PrintDocument();
        private DataGridView gw = new DataGridView();
        private string _ReportHeader;

        #endregion

        public ClsPrint(DataGridView gridview, string ReportHeader)
        {
            _printDocument.PrintPage += new PrintPageEventHandler(_printDocument_PrintPage);
            _printDocument.BeginPrint += new PrintEventHandler(_printDocument_BeginPrint);
            gw = gridview;
            _ReportHeader = ReportHeader;
        }

        public void PrintForm()
        {
            ////Open the print dialog
            //PrintDialog printDialog = new PrintDialog();
            //printDialog.Document = _printDocument;
            //printDialog.UseEXDialog = true;

            ////Get the document
            //if (DialogResult.OK == printDialog.ShowDialog())
            //{
            //    _printDocument.DocumentName = "Test Page Print";
            //    _printDocument.Print();
            //}

            //Open the print preview dialog
            PrintPreviewDialog objPPdialog = new PrintPreviewDialog();
            objPPdialog.Document = _printDocument;
            objPPdialog.ShowDialog();
        }

        private void _printDocument_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e)
        {
            //try
            //{
            //Set the left margin
            int iLeftMargin = e.MarginBounds.Left;
            //Set the top margin
            int iTopMargin = e.MarginBounds.Top;
            //Whether more pages have to print or not
            bool bMorePagesToPrint = false;
            int iTmpWidth = 0;

            //For the first page to print set the cell width and header height
            if (bFirstPage)
            {
                foreach (DataGridViewColumn GridCol in gw.Columns)
                {
                    iTmpWidth = (int)(Math.Floor((double)((double)GridCol.Width /
                        (double)iTotalWidth * (double)iTotalWidth *
                        ((double)e.MarginBounds.Width / (double)iTotalWidth))));

                    iHeaderHeight = (int)(e.Graphics.MeasureString(GridCol.HeaderText,
                        GridCol.InheritedStyle.Font, iTmpWidth).Height) + 11;

                    // Save width and height of headers
                    arrColumnLefts.Add(iLeftMargin);
                    arrColumnWidths.Add(iTmpWidth);
                    iLeftMargin += iTmpWidth;
                }
            }
            //Loop till all the grid rows not get printed
            while (iRow <= gw.Rows.Count - 1)
            {
                DataGridViewRow GridRow = gw.Rows[iRow];
                //Set the cell height
                iCellHeight = GridRow.Height + 5;
                int iCount = 0;
                //Check whether the current page settings allows more rows to print
                if (iTopMargin + iCellHeight >= e.MarginBounds.Height + e.MarginBounds.Top)
                {
                    bNewPage = true;
                    bFirstPage = false;
                    bMorePagesToPrint = true;
                    break;
                }
                else
                {

                    if (bNewPage)
                    {
                        //Draw Header
                        e.Graphics.DrawString(_ReportHeader,
                            new Font(gw.Font, FontStyle.Bold),
                            Brushes.Black, e.MarginBounds.Left,
                            e.MarginBounds.Top - e.Graphics.MeasureString(_ReportHeader,
                            new Font(gw.Font, FontStyle.Bold),
                            e.MarginBounds.Width).Height - 13);

                        String strDate = "";
                        //Draw Date
                        e.Graphics.DrawString(strDate,
                            new Font(gw.Font, FontStyle.Bold), Brushes.Black,
                            e.MarginBounds.Left +
                            (e.MarginBounds.Width - e.Graphics.MeasureString(strDate,
                            new Font(gw.Font, FontStyle.Bold),
                            e.MarginBounds.Width).Width),
                            e.MarginBounds.Top - e.Graphics.MeasureString(_ReportHeader,
                            new Font(new Font(gw.Font, FontStyle.Bold),
                            FontStyle.Bold), e.MarginBounds.Width).Height - 13);

                        //Draw Columns                 
                        iTopMargin = e.MarginBounds.Top;
                        DataGridViewColumn[] _GridCol = new DataGridViewColumn[gw.Columns.Count];
                        int colcount = 0;
                        //Convert ltr to rtl
                        foreach (DataGridViewColumn GridCol in gw.Columns)
                        {
                            _GridCol[colcount++] = GridCol;
                        }
                        for (int i = (_GridCol.Count() - 1); i >= 0; i--)
                        {
                            e.Graphics.FillRectangle(new SolidBrush(Color.LightGray),
                                new Rectangle((int)arrColumnLefts[iCount], iTopMargin,
                                (int)arrColumnWidths[iCount], iHeaderHeight));

                            e.Graphics.DrawRectangle(Pens.Black,
                                new Rectangle((int)arrColumnLefts[iCount], iTopMargin,
                                (int)arrColumnWidths[iCount], iHeaderHeight));

                            e.Graphics.DrawString(_GridCol[i].HeaderText,
                                _GridCol[i].InheritedStyle.Font,
                                new SolidBrush(_GridCol[i].InheritedStyle.ForeColor),
                                new RectangleF((int)arrColumnLefts[iCount], iTopMargin,
                                (int)arrColumnWidths[iCount], iHeaderHeight), strFormat);
                            iCount++;
                        }
                        bNewPage = false;
                        iTopMargin += iHeaderHeight;
                    }
                    iCount = 0;
                    DataGridViewCell[] _GridCell = new DataGridViewCell[GridRow.Cells.Count];
                    int cellcount = 0;
                    //Convert ltr to rtl
                    foreach (DataGridViewCell Cel in GridRow.Cells)
                    {
                        _GridCell[cellcount++] = Cel;
                    }
                    //Draw Columns Contents                
                    for (int i = (_GridCell.Count() - 1); i >= 0; i--)
                    {
                        if (_GridCell[i].Value != null)
                        {
                            e.Graphics.DrawString(_GridCell[i].FormattedValue.ToString(),
                                _GridCell[i].InheritedStyle.Font,
                                new SolidBrush(_GridCell[i].InheritedStyle.ForeColor),
                                new RectangleF((int)arrColumnLefts[iCount],
                                (float)iTopMargin,
                                (int)arrColumnWidths[iCount], (float)iCellHeight),
                                strFormat);
                        }
                        //Drawing Cells Borders 
                        e.Graphics.DrawRectangle(Pens.Black,
                            new Rectangle((int)arrColumnLefts[iCount], iTopMargin,
                            (int)arrColumnWidths[iCount], iCellHeight));
                        iCount++;
                    }
                }
                iRow++;
                iTopMargin += iCellHeight;
            }
            //If more lines exist, print another page.
            if (bMorePagesToPrint)
                e.HasMorePages = true;
            else
                e.HasMorePages = false;
            //}
            //catch (Exception exc)
            //{
            //    MessageBox.Show(exc.Message, "Error", MessageBoxButtons.OK,
            //       MessageBoxIcon.Error);
            //}
        }

        private void _printDocument_BeginPrint(object sender, System.Drawing.Printing.PrintEventArgs e)
        {
            try
            {
                strFormat = new StringFormat();
                strFormat.Alignment = StringAlignment.Center;
                strFormat.LineAlignment = StringAlignment.Center;
                strFormat.Trimming = StringTrimming.EllipsisCharacter;

                arrColumnLefts.Clear();
                arrColumnWidths.Clear();
                iCellHeight = 0;
                iRow = 0;
                bFirstPage = true;
                bNewPage = true;

                // Calculating Total Widths
                iTotalWidth = 0;
                foreach (DataGridViewColumn dgvGridCol in gw.Columns)
                {
                    iTotalWidth += dgvGridCol.Width;
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }

    } 
```

**使用：**这将显示带有网格视图结果的打印对话框

```
ClsPrint _ClsPrint = new ClsPrint(dataGridView1, "header doc text");
 _ClsPrint.PrintForm(); 
```

## 结果

![在此处输入图像描述](https://i.stack.imgur.com/Kk6jY.jpg)

[更多信息和完整示例项目](http://www.codeproject.com/Articles/28046/Printing-of-DataGridView)

**编辑**

要以正确的顺序获取列（而不是使它们以相反的顺序排列），请执行以下操作：

```
 int colcount = gw.Columns.Count - 1;
                        //Convert ltr to rtl
                        foreach (DataGridViewColumn GridCol in gw.Columns)
                        {
                            _GridCol[colcount--] = GridCol;
                        } 
```

和

```
 int cellcount = GridRow.Cells.Count - 1;
                    //Convert ltr to rtl
                    foreach (DataGridViewCell Cel in GridRow.Cells)
                    {
                        _GridCell[cellcount--] = Cel;
                    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-13T03:19:40.127

使用 IRSOG 的代码时，将下面的循环方向更改为 Convert ltr to rtl 以获得常规结果。否则整个 dgv 将被翻转。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-17T11:11:39.783

1.  打开 Visual Studio 2010。
2.  创建新项目并给出适当的名称。
3.  从工具箱中将 datagridview 拖放到表单中。
4.  在 datagridview 中添加数据。
5.  从工具箱中拖放 printDocument。
6.  在表单上添加打印按钮。
7.  双击获取按钮的点击事件。
8.  在打印按钮单击事件中编写以下代码。printDocument1.Print();
9.  双击 printDocument 以获取 Print Page 事件。
10.  编写以下代码以打印 datagridview：-

    ```
    private void printDocument1_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e)
    {
        Bitmap bm = new Bitmap(this.dataGridView1.Width, this.dataGridView1.Height);

        dataGridView1.DrawToBitmap(bm, new Rectangle(0, 0, this.dataGridView1.Width, this.dataGridView1.Height));
        e.Graphics.DrawImage(bm, 0, 0);
    } 
    ```

来源 [https://www.mindstick.com/Articles/1356/datagridview-printing-in-c-sharp](https://www.mindstick.com/Articles/1356/datagridview-printing-in-c-sharp)

这将完全有效

# mod-rewrite - 使用大写的 Mod 重写添加查询字符串

> ID：15853748
> 
> 赞同：0
> 
> 时间：2013-04-06T17:13:06.687
> 
> 标签：mod-rewrite

我正在使用 mod Rewrite 将部分 URL 重写为查询参数

URL 的格式为

```
http://www.my_site.com/ABC 
```

`index.php`其中 ABC 是在子目录中强制进入我的查询参数的位

我`.htaccess`的有以下几点：

```
RewriteEngine on
RewriteRule ^/?([a-zA-Z0-9]+)/?$ directory/index.php?Site=$1 [L] 
```

当我有一个小写的 ABC 例如：

```
my_site.com/abc 
```

浏览器 URL 保持不变，页面与通过 GET 传递的 abc 完美配合。

但是，当 ABC 为大写时，例如：

```
my_site.com/ABC 
```

浏览器中的 URL 变为：

```
my_site.com/ABC/?Site=ABC 
```

它工作正常，ABC 仍在`GET`参数中，但看起来很难看！

为什么大小写会影响这一点，我可以让大写和小写都保持原始 URL？

进一步说明：我尝试了一个不同服务器的示例，它运行良好！如果有可能影响此的服务器设置有什么想法吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T18:47:05.743

我已经解决了 - 正如 sidoh 所说的那样，正在发生其他事情。

如果我的服务器上有一个与参数同名的目录，则 mod_rewrite 会将查询添加到 URL。

例如，如果我在服务器上有一个目录 ABC，那么将我的 mod_rewrite 与 www.domain.com/ABC 一起使用会导致浏览器 URL www.domain.com/ABC/Site=ABC - 如果没有目录 ABC 一切都很好，并且URL 仍然是 www.domain.com/ABC （这是我想要的）。

由于我在 Linux ABC 与 abc 不同 - 这解释了行为明显区分大小写的性质。

感谢大家的投入。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-06T18:04:32.437

你的意思是，*[NC]* nocase 标志？这将使规则以不区分大小写的方式匹配。意味着，它不关心字母是大写还是小写。

```
RewriteRule ^([a-zA-Z0-9]+)/?$ /directory/index.php?Site=$1 [NC] 
```

* * *

我想，您想将*/bigSMALL 之*类的 URL 重写为*/directory/index.php?Site=BIGsmall*吗？如果我是对的，那么问题出在程序中，而不是在 URL 重新映射中。但是，在**MySQL**数据库中，当您获取查询字符串的值以查询`WHERE`值时，它是不区分大小写的匹配。看一下图片：

![用户名 = 'nAmE 不区分大小写'](https://i.stack.imgur.com/8FC6W.png)

你在开发网站吗？如果有，那么您使用的是什么 DBMS？也许，**MySQL**？

# python - PyQuery：从 html 中提取 id？

> ID：15853749
> 
> 赞同：1
> 
> 时间：2013-04-06T17:13:15.470
> 
> 标签：python, html, attr, pyquery

我尝试使用 PyQuery 从 html 文件中获取所有“id”，但带来了麻烦……我试试这个：

```
from pyquery import PyQuery

file = open('index.html', 'r').read
jQuery = PyQuery(html)

jQuery.attr('id') 
```

但是什么都没有显示...

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T18:08:43.637

我不确定您的示例代码是否是您正在使用的，但是您在那里缺少一些不同的东西，例如调用`read()`而不是创建`file`方法`read`，然后您就永远不会使用它。`html`当你从未分配任何东西给它时，你也通过了。

但这是我写的东西，似乎找到了所有带有 的元素`id`，我尽可能地遵循你的名字，但我不想重复使用`file`，因为据我所知这是一个保留字：

```
from pyquery import PyQuery

html = open('temp.html').read()

jquery = PyQuery(html)
ids = jquery.find('[id]')

print ids
>>>[<link#screen-switcher-stylesheet>, <div#search>, <input#term.input-text>, <input#submit.input-button>] 
```

# android - 我无法使用 TITANIUM STUDIO 启动我的安卓模拟器

> ID：15853751
> 
> 赞同：0
> 
> 时间：2013-04-06T17:13:31.167
> 
> 标签：android, android-emulator, titanium, titanium-mobile, appcelerator-mobile

我一直试图让我的 android 模拟器使用钛工作室在我的 mac 上工作。

这是我尝试运行时得到的日志表：

```
**[ERROR] Application Installer abnormal process termination. Process exit value was 1
[INFO] logfile = /Users/xxx/Desktop/xxx/Titanium WorkSpace/abc/build.log
[DEBUG] /Users/xxx/Library/Application Support/Titanium/mobilesdk/osx/3.0.2.GA/android/builder.py simulator abc /Applications/Android SDK/sdk /Users/xxx/Desktop/xxx/Titanium WorkSpace/abc com.xxx.abc 1 QVGA 
Traceback (most recent call last):
File "/Users/xxx/Library/Application Support/Titanium/mobilesdk/osx/3.0.2.GA/android/builder.py", line 2340, in <module>
    builder = Builder(project_name,sdk_dir,project_dir,template_dir,app_id)
File "/Users/xxx/Library/Application Support/Titanium/mobilesdk/osx/3.0.2.GA/android/builder.py", line 341, in __init__
self.sdk = AndroidSDK(sdk, self.tool_api_level)
File "/Users/xxx/Library/Application Support/Titanium/mobilesdk/osx/3.0.2.GA/android/androidsdk.py", line 49, in __init__
self.set_api_level(api_level)
File "/Users/xxx/Library/Application Support/Titanium/mobilesdk/osx/3.0.2.GA/android/androidsdk.py", line 53, in set_api_level
self.find_platform_dir()
File "/Users/xxx/Library/Application Support/Titanium/mobilesdk/osx/3.0.2.GA/android/androidsdk.py", line 131, in find_platform_dir
raise Exception("No \"%s\" or \"%s\" in the Android SDK" % ('android-%s' % api_level, android_api_levels[api_level]))
Exception: No "android-8" or "android-2.2" in the Android SDK** 
```

希望大家帮帮我。我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T19:48:54.110

> 例外：Android SDK 中没有“android-8”或“android-2.2”**

通常表示所选 Android 版本没有虚拟设备。要么你缺少一些 SDK（注意：如果你想运行 Android 2.2，你需要使用 SDK Manager 下载 2.2 的 SDK 资源）或者 Titanium Studio 做错了（我已经在 mac 机器上注意到了）。

所以...

1.  确保您已经下载了 2.2 的 SDK 资源（SDK 管理器应该可以通过 Titanium Studion 获得）。重新启动钛工作室。
2.  如果 (1) 为真并且这无济于事：
    1.  检查环境变量（JAVA_HOME、ANDROID_SDK）。重新启动钛工作室。
    2.  仅当这也无济于事时：使用 AVD Manager 创建您自己的虚拟设备并将其命名为 android-8 或 android-2.2 或先运行模拟器，然后在 Titanium Studio 中单击运行。

**但**通常的方法是在 Titanium Studio 中单击运行，它会启动模拟器并运行您的应用程序。因此，还请查看[设置 Titanium Studio](http://docs.appcelerator.com/titanium/latest/#!/guide/Setting_up_Titanium_Studio)、[安装故障排除](http://docs.appcelerator.com/titanium/latest/#!/guide/Installation_Troubleshooting)、[环境变量](http://docs.appcelerator.com/titanium/latest/#!/guide/Software_Locations_and_Environment_Variables)，当然还有包含所需版本[的兼容性矩阵。](http://docs.appcelerator.com/titanium/latest/#!/guide/Titanium_Compatibility_Matrix)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-07T16:02:45.073

真的很老的问题......但我遇到了它并通过安装旧版本的Android SDK找到了解决方案。Titanium 不适用于 3.x 或 4.x，但所有示例应用程序（现在是我的生产应用程序）都可以使用 2.2 包。

# emacs - CEDET 中的自动补全？

> ID：15853753
> 
> 赞同：6
> 
> 时间：2013-04-06T17:13:38.287
> 
> 标签：emacs, cedet, emacs24, emacs-ecb

我正在尝试在 Emacs 24.3 中设置 CEDET 2.2 来为我提供自动补全功能，使用[“对 cedet 的温和介绍”](http://alexott.net/en/writings/emacs-devenv/EmacsCedet.html)，但它并不完全希望按照我想要的方式工作。

首先，我尝试使用 CEDET 自己的补全，但是那个不提供“弹出菜单”，只有它可以找到的第一个补全，并且无法循环。[然后我安装了带有包的自动完成功能并按照页面](http://alexott.net/en/writings/emacs-devenv/EmacsCedet.html)上的描述进行设置。这也不起作用 - 自动完成崩溃说`auto-complete error: (void-variable ac-source-semantic)`. ac-source-gtags 也是如此。

由于目前 CEDET 有问题，这是不可能的，还是我配置错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T17:47:07.170

配置 CEDET 是一件非常痛苦的事情（我花了几个月的时间才在现有项目中实现跳转到定义和自动完成）。

因此，您当然可能错误地配置了 CEDET，因为它很难正确配置，我将把我的配置留在这里供您查看，但这确实取决于您的项目，而且非常挑剔。

```
(setq cedet-root-path (file-name-as-directory "~/.emacs.d/lisp/cedet-bzr/trunk/"))

(load-file (concat cedet-root-path "cedet-devel-load.el"))
(add-to-list 'load-path (concat cedet-root-path "contrib"))

;; select which submodes we want to activate
(mapc (lambda (MODE) (add-to-list 'semantic-default-submodes MODE))
      '(global-semantic-mru-bookmark-mode
        global-semanticdb-minor-mode
        global-semantic-idle-scheduler-mode
        global-semantic-stickyfunc-mode
        global-cedet-m3-minor-mode
        global-semantic-highlight-func-mode
        global-semanticdb-minor-mode))

;; Activate semantic
(semantic-mode 1)

;; load contrib library
(require 'eassist)

;; customisation of modes
(mapc
 (lambda (MODE)
   (add-hook MODE
             (lambda ()
               (when (boundp 'semantic-ia-complete-symbol) (add-to-list 'completion-at-point-functions 'semantic-ia-complete-symbol))
               (local-set-key [(control return)] 'semantic-ia-complete-symbol-menu)
               (local-set-key "\C-c?" 'semantic-ia-complete-symbol)
               (local-set-key "\C-c>" 'semantic-complete-analyze-inline)
               (local-set-key "\C-c=" 'semantic-decoration-include-visit)
               (local-set-key "\C-cj" 'semantic-ia-fast-jump)
               (local-set-key "\C-cq" 'semantic-ia-show-doc)
               (local-set-key "\C-cs" 'semantic-ia-show-summary)
               (local-set-key "\C-cp" 'semantic-analyze-proto-impl-toggle)
               ))) '(c-mode-common-hook lisp-mode-hook emacs-lisp-mode-hook))

(add-hook 'c-mode-common-hook (lambda ()
                                (local-set-key "\C-ct" 'eassist-switch-h-cpp)
                                (local-set-key "\C-xt" 'eassist-switch-h-cpp)
                                (local-set-key "\C-ce" 'eassist-list-methods)
                                (local-set-key "\C-c\C-r" 'semantic-symref)))

(semanticdb-enable-gnu-global-databases 'c-mode t)
(semanticdb-enable-gnu-global-databases 'c++-mode t)

(when (cedet-ectag-version-check t)
  (semantic-load-enable-primary-ectags-support))

;; SRecode
(global-srecode-minor-mode 1)

;; EDE
(global-ede-mode 1)
(ede-enable-generic-projects)

(defun qt-cedet-setup ()
  "Set up c-mode and related modes. Includes support for Qt code (signal, slots and alikes)."

  ;; add knowledge of qt to emacs
  (setq qt4-base-dir (concat (getenv "QTDIR") "/include"))
  (semantic-add-system-include (concat qt4-base-dir "/Qt") 'c++-mode)
  (semantic-add-system-include (concat qt4-base-dir "/QtGui") 'c++-mode)
  (semantic-add-system-include (concat qt4-base-dir "/QtCore") 'c++-mode)
  (semantic-add-system-include (concat qt4-base-dir "/QtTest") 'c++-mode)
  (semantic-add-system-include (concat qt4-base-dir "/QtNetwork") 'c++-mode)
  (semantic-add-system-include (concat qt4-base-dir "/QtSvg") 'c++-mode)
  (add-to-list 'auto-mode-alist (cons qt4-base-dir 'c++-mode))
  (add-to-list 'semantic-lex-c-preprocessor-symbol-file (concat qt4-base-dir "/Qt/qconfig.h"))
  (add-to-list 'semantic-lex-c-preprocessor-symbol-file (concat qt4-base-dir "/Qt/qconfig-large.h"))
  (add-to-list 'semantic-lex-c-preprocessor-symbol-file (concat qt4-base-dir "/Qt/qglobal.h"))

  ;; qt keywords and stuff ...
  ;; set up indenting correctly for new qt kewords
  (setq c-protection-key (concat "\\<\\(public\\|public slot\\|protected"
                                 "\\|protected slot\\|private\\|private slot"
                                 "\\)\\>")
        c-C++-access-key (concat "\\<\\(signals\\|public\\|protected\\|private"
                                 "\\|public slots\\|protected slots\\|private slots"
                                 "\\)\\>[ \t]*:"))

  ;; modify the colour of slots to match public, private, etc ...
  (font-lock-add-keywords 'c++-mode '(("\\<\\(slots\\|signals\\)\\>" . font-lock-type-face)))
  ;; make new font for rest of qt keywords
  (make-face 'qt-keywords-face)
  (set-face-foreground 'qt-keywords-face "BlueViolet")
  ;; qt keywords
  (font-lock-add-keywords 'c++-mode '(("\\<Q_[A-Z]*\\>" . 'qt-keywords-face)))
  (font-lock-add-keywords 'c++-mode '(("\\<SIGNAL\\|SLOT\\>" . 'qt-keywords-face)))
  (font-lock-add-keywords 'c++-mode '(("\\<Q[A-Z][A-Za-z]*\\>" . 'qt-keywords-face)))
  (font-lock-add-keywords 'c++-mode '(("\\<Q[A-Z_]+\\>" . 'qt-keywords-face)))
  (font-lock-add-keywords 'c++-mode
                          '(("\\<q\\(Debug\\|Wait\\|Printable\\|Max\\|Min\\|Bound\\)\\>" . 'font-lock-builtin-face)))

  (setq c-macro-names-with-semicolon '("Q_OBJECT" "Q_PROPERTY" "Q_DECLARE" "Q_ENUMS"))
  (c-make-macro-with-semi-re)
  )
(when (getenv "QTDIR") (add-hook 'c-mode-common-hook 'qt-cedet-setup)) 
```

# php - Jquery从循环中获取输入值

> ID：15853754
> 
> 赞同：0
> 
> 时间：2013-04-06T17:13:41.793
> 
> 标签：php, jquery, mysql, ajax

我想使用 php、jquery、ajax 制作内联编辑解决方案

我的循环：

```
$a=0;

  while($row = $db->fetch_array($res)){
  if($a%2==1){
  $class = 'class="even"';
  }
  else{
  $class = 'class="odd"';
  }
  $a++; 
```

html表：

```
 <tr <?php echo $class; ?>>
    <td class="th table-check-cell sorting_1"><input type="checkbox" name="zones_id[]" value="<?php echo $row['zone_id']; ?>"></td>
    <td><?php echo $a; ?></td>
    <td><?php echo $row['zone_name']; ?></td>
    <td><?php echo $row['zone_position']; ?></td>
    <td><?php echo $row['status']; ?></td>

    <td class="table-actions">
    <a href="javascript:void(0);" title="Edit" class="with-tip" onclick="slidemenu('innerlinks_<?php echo $a; ?>')"><img src="images/icons/fugue/pencil.png" width="16" height="16"></a></td>
    </tr>

    <tr style="display:none;" id="innerlinks_<?php echo $a; ?>" class="sub">
    <td><?php echo $a; ?></td>
    <td><input type="checkbox" /></td>
    <td><input type="text" class="zn" name="zone_name" id="zone_name" value="<?php echo $row['zone_name']; ?>" /></td>
    <td><input type="text" name="zone_pos" id="zone_pos"  value="<?php echo $row['zone_position']; ?>" /></td>
    <td colspan="2"><a><?php echo $row['zone_name']; ?></a></td>
    </tr>

    <?php } ?>   

    function slidemenu(id){
       $('#'+id).slideToggle();
      }

    ///second proccess 

    $(".sub").click(function(){
        $(this).closest('tr').find("input,select").each(function() {

        $.ajax({
          type: "POST",
          url: "<?php echo SITE_URL .'controlls/zone_add.php'; ?>",
          data: datastring,
          success: function (data) {

            alert("Details saved successfully!!!");
          }
            })

            });

    }); 
```

我想要两件事：

一种是隐藏我的数据行并显示表单行以进行编辑。其次是如何通过ajax请求的名称获取所有输入选择收音机等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T21:15:39.380

您不想为每个字段执行 AJAX POST。

```
$(".sub").click( 
    function() {
        var data = {};
        $(this).closest("tr").find( "input,select").each(
            function() {
                data[$(this).attr("name")] = $(this).val();
            }
        );
        $.post( "your URL", data, function( data ) { alert( "Successful!" ); } );
    }
); 
```

我没有看你的选择器。我假设你有正确的。我只关注从每个字段中捕获值、将其添加到 JavaScript 对象并通过 AJAX 发布它的过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T18:05:37.310

您需要做的是为表中的每一行生成一个唯一 ID - 并为表行提供该 ID：

```
<tr id="<?= $id ?>" class="<?= $class ?>"> 
```

然后您可以使用 jQuery 找到该行`$("#<?= $id ?>")`并操作该行的内容以使用输入控件和提交/取消按钮替换静态文本。

此外，当您要提交时，您可以通过使用 jQuery 查询输入值来检索它们。例如：

```
$("tr#<?= $id ?> input#zone_name").value(); 
```

关键是给每一行一个唯一的ID，你可能已经在数据库中......

# c++ - stl unordered_set 如何设置初始桶数

> ID：15853756
> 
> 赞同：1
> 
> 时间：2013-04-06T17:14:00.183
> 
> 标签：c++, c, unordered-map, bucket, unordered-set

对于 unordered_map，我通过以下方式设置初始存储桶计数：

```
unordered_map<string, dictionaryWord> dictionary(17749); // set initial bucket count to 17749 
```

这种方式似乎不适用于 unordered_set。

```
/*line 150*/ unsigned char mask;
/*line 151*/ unordered_set<QueryID> query_id(109); // set initial bucket count to 109 
```

编译器错误 = 1) 数字常量之前的预期标识符。2) 数字常量前应有 ',' 或 '...'。并继续出现一堆错误

如何为 unordered_set 做同样的事情？

谢谢你。

=================================================

如果我删除“（109）”，则没有错误

```
"/usr/bin/make" -f nbproject/Makefile-Release.mk QMAKE= SUBPROJECTS= .clean-conf
make[1]: Entering directory `/home/petros/NetBeansProjects/ACM_test'
rm -f -r build/Release
rm -f dist/Release/GNU-Linux-x86/acm_test
make[1]: Leaving directory `/home/petros/NetBeansProjects/ACM_test'

CLEAN SUCCESSFUL (total time: 80ms)

"/usr/bin/make" -f nbproject/Makefile-Release.mk QMAKE= SUBPROJECTS= .build-conf
make[1]: Entering directory `/home/petros/NetBeansProjects/ACM_test'
"/usr/bin/make"  -f nbproject/Makefile-Release.mk dist/Release/GNU-Linux-x86/acm_test
make[2]: Entering directory `/home/petros/NetBeansProjects/ACM_test'
mkdir -p build/Release/GNU-Linux-x86/ref_impl
rm -f build/Release/GNU-Linux-x86/ref_impl/core.o.d
g++ -pthread -O3 -std=c++11   -c -O2 -pthread -O3 -std=c++11 -MMD -MP -MF build/Release/GNU-Linux-x86/ref_impl/core.o.d -o build/Release/GNU-Linux-x86/ref_impl/core.o ref_impl/core.cpp
ref_impl/core.cpp:151:37: error: expected identifier before numeric constant
ref_impl/core.cpp:151:37: error: expected ‘,’ or ‘...’ before numeric constant
ref_impl/core.cpp: In function ‘ErrorCode StartQuery(QueryID, const char*, MatchType, unsigned int)’:
ref_impl/core.cpp:250:24: error: expected unqualified-id before ‘(’ token
ref_impl/core.cpp:250:38: error: missing template arguments before ‘)’ token
ref_impl/core.cpp:250:39: error: expected ‘;’ before ‘query_id’
ref_impl/core.cpp:257:19: error: ‘query.SameQueries::query_id’ does not have class type
ref_impl/core.cpp: In function ‘ErrorCode EndQuery(QueryID)’:
ref_impl/core.cpp:265:44: error: ‘queries.std::vector<_Tp, _Alloc>::operator[]<SameQueries, std::allocator<SameQueries> >(((std::vector<SameQueries>::size_type)i)).SameQueries::query_id’ does not have class type
ref_impl/core.cpp:265:58: error: unable to deduce ‘const auto’ from ‘&lt;expression error>’
ref_impl/core.cpp:266:38: error: ‘queries.std::vector<_Tp, _Alloc>::operator[]<SameQueries, std::allocator<SameQueries> >(((std::vector<SameQueries>::size_type)i)).SameQueries::query_id’ does not have class type
ref_impl/core.cpp:267:32: error: ‘queries.std::vector<_Tp, _Alloc>::operator[]<SameQueries, std::allocator<SameQueries> >(((std::vector<SameQueries>::size_type)i)).SameQueries::query_id’ does not have class type
ref_impl/core.cpp:268:36: error: ‘queries.std::vector<_Tp, _Alloc>::operator[]<SameQueries, std::allocator<SameQueries> >(((std::vector<SameQueries>::size_type)i)).SameQueries::query_id’ does not have class type
ref_impl/core.cpp: In function ‘void* TaskCode(void*)’:
ref_impl/core.cpp:463:41: error: ‘quer.SameQueries::query_id’ does not have class type
ref_impl/core.cpp:463:48: error: unable to deduce ‘auto’ from ‘&lt;expression error>’
ref_impl/core.cpp:463:70: error: ‘quer.SameQueries::query_id’ does not have class type
make[2]: *** [build/Release/GNU-Linux-x86/ref_impl/core.o] Error 1
make[2]: Leaving directory `/home/petros/NetBeansProjects/ACM_test'
make[1]: *** [.build-conf] Error 2
make[1]: Leaving directory `/home/petros/NetBeansProjects/ACM_test'
make: *** [.build-impl] Error 2

BUILD FAILED (exit value 2, total time: 1s) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T14:34:53.040

**它在一个结构内。**它应该是：

```
unordered_set<QueryID> query_id = unordered_set<QueryID>(109); 
```

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:36:43.167

我怀疑桶数是红鲱鱼。它看起来像`QueryID`不可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:41:33.237

我怀疑您`QueryID`没有标准构造函数，即`QueryID::QueryID() { std::cout << "foo!" };`无序集不知道如何使用空 QueryID 预填充。

尝试添加一个。

或者，您可以使用第二个参数设置要用于每个预构建存储桶的默认数据。

参考： [http ://en.cppreference.com/w/cpp/container/unordered_set/unordered_set](http://en.cppreference.com/w/cpp/container/unordered_set/unordered_set)

# java - Tomcat 资源工厂 org.apache.openejb.OpenEJBException：没有可用于 resource-env-ref 的提供程序

> ID：15853769
> 
> 赞同：1
> 
> 时间：2013-04-06T17:14:59.173
> 
> 标签：java, tomcat, apache-tomee

我使用 TomEE 作为应用程序服务器。TomEE 使用 Tomcat 7。我有以下代码：

```
package com.jndi;

import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.Name;
import javax.naming.NamingException;
import javax.naming.RefAddr;
import javax.naming.Reference;
import javax.naming.spi.ObjectFactory;

public class GitObjectFactory implements ObjectFactory {

public GitObjectFactory() {

}

public Object getObjectInstance(Object obj, Name name, Context nameCtx, Hashtable     environment) throws NamingException {
    GitConnection gitConnection = new GitConnection();
    // Customize the bean properties from our attributes
    Reference ref = (Reference) obj;
    RefAddr refAddr = ref.get("gitLocation");
    String value = (String) refAddr.getContent();
    gitConnection.setGitLocation(value);
    return gitConnection;
}
}

public class GitConnection {

private String gitLocation;

public GitConnection() {

}

public String getGitLocation() {
    return gitLocation;
}

public void setGitLocation(String gitLocation) {
    this.gitLocation = gitLocation;
}
 }

in context.xml
<Context>

<!-- Default set of monitored resources -->
<WatchedResource>WEB-INF/web.xml</WatchedResource>
<Resource name='git/GitConnectionFactory' auth='Container'
type='com.jndi.GitConnection'
factory='com.jndi.GitObjectFactory'
gitLocation='C:\jGitClone\.git'/> 
```

在 web.xml http://java.sun.com/xml/ns/j2ee/web-app_2_5.xsd" version="2.5">

```
 <context-param>
        <!-- Specifies the list of Spring Configuration files in comma separated format.-->

        /WEB-INF/spring/email.xml
     </context-param>

     <listener>
        <!-- Loads your Configuration Files-->
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
     </listener>

     <servlet>
        <servlet-name>i</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
     </servlet>

     <servlet-mapping>
        <servlet-name>i</servlet-name>
        <url-pattern>/</url-pattern>
     </servlet-mapping>

     <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
     </welcome-file-list>

     <resource-env-ref>
        <description>Object Factory for GitConnection instances.</description>
        <resource-env-ref-name>git/GitConnectionFactory</resource-env-ref-name>
        <resource-env-ref-type>com.jndi.GitConnection</resource-env-ref-type>
     </resource-env-ref>     
 </web-app>

When I load Tomcat, I can see successfully that the resource git/GitConnectionFactory is registered:

 INFO: Configuring Service(id=git/GitConnectionFactory, type=Resource, provider-id=ProvidedByTomcat) 
```

2013 年 4 月 6 日 17:54:25 org.apache.openejb.assembler.classic.Assembler createRecipe

一旦我部署应用程序，我就会得到以下异常：

```
 org.apache.openejb.OpenEJBException: No provider available for resource-env-ref 'git/GitConnectionFactory' of type 'com.jndi.GitConnection' for 'i'. 
```

任何想法问题出在哪里？

# c# - 从虚拟文件中的字符串实现 virtualpathprovide 和显示日期时间

> ID：15853771
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:03.243
> 
> 标签：c#, asp.net-mvc, dynamic-programming, virtualpathprovider

我对 MVC 非常陌生，并试图刺穿虚拟路径提供程序，并在屏幕上显示日期时间。该路径工作正常并被应用程序识别，但它不会显示detetime，而是只显示字符串“时间是：@DateTime.Now”。但如果我直接返回虚拟文件，它将正确显示时间。

以下代码检索虚拟文件：

```
 public override VirtualFile GetFile(string virtualPath)
    {
        //if (virtualPath.StartsWith("/test") || virtualPath.StartsWith("~/test"))
            return new StringVirtualFile(virtualPath);

        //return base.GetFile(virtualPath);
    } 
```

正如我所提到的，如果我注释掉上面的一些代码，你可以看到它会正确显示时间。

虚拟文件代码：

```
 public class StringVirtualFile : System.Web.Hosting.VirtualFile
    {
        public StringVirtualFile(string path)
            : base(path)
        {
        }
        public override System.IO.Stream Open()
        {
            return new MemoryStream(Encoding.UTF8.GetBytes("Time is: @DateTime.Now"));
        }
    } 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T10:18:17.960

“@”用于 Razor 视图引擎。要么做 string.format("Time is: {0}", DateTime.Now") 要么使用 ASP MVC 的路由、控制器和视图（你可以在这里使用“@”）而不是 VirtualFile

路由：

*   [http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs)

*   [http://dotnet.dzone.com/articles/aspnet-mvc-routing-basics](http://dotnet.dzone.com/articles/aspnet-mvc-routing-basics)

# android - 如何在 Android 上处理首选项中的长文本？

> ID：15853773
> 
> 赞同：13
> 
> 时间：2013-04-06T17:15:15.600
> 
> 标签：android, textview, android-preferences, preferenceactivity, longtext

## 背景

我正在制作一个有一些设置的应用程序，我想使用内置的 PreferenceActivity 或 PreferenceFragment 来完成这项工作

## 问题

有些偏好的标题很长，我无法缩短，而且我认为如果我将应用程序本地化（翻译成多种语言），我会面临同样的问题（例如德语，有时单词很长）。

在这种情况下，您得到的只是文本的开头，然后是“...”（或更少的点，顺便说一句，这没有多大意义）。

例子：

![在此处输入图像描述](https://i.stack.imgur.com/BapHU.png)

## 我试过的

我知道 PreferenceActivity 是从 ListActivity 扩展而来的，所以我可以将它的适配器更改为我想要的任何东西，但这会删除它的工作方式。

我也知道我可以从偏好类的每种类型扩展，使用“onCreateView”方法来引用创建的视图，然后访问它的子视图，但这很奇怪，不是吗？我的意思是，这几乎就像假设它永远不会改变它的外观一样。

编辑：这是我尝试过的示例代码：

从每个偏好类扩展，并在每个偏好类中使用：

```
...
@Override
protected View onCreateView(final ViewGroup parent)
  {
  final View view=super.onCreateView(parent);
  ViewUtil.handlePreferenceTitleTextView(view);
  return view;
  }
...

//ViewUtil.java :

private void handlePreferenceTitleTextView(final View v)
  {
  final TextView titleTextView=(TextView)v.findViewById(android.R.id.title);
  if(titleTextView!=null)
    titleTextView.setSingleLine(false);
  } 
```

它有效，但我不建议这样做，因为谷歌可能会改变偏好视图的工作方式。

## 问题

如何在 Android 上处理首选项标题中的长文本？

是否有可能让它有一个椭圆/选框（这样它就有一个动画来显示一切）？或者也许自动适应字体大小？或者将其设置为自动换行？或者一个允许用户滚动阅读其余文本的水平滚动视图？

是否有关于如何处理此类案件的约定？也许长按以显示吐司/对话框以查看整个文本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-26T10:48:31.663

这是我针对特定情况`SwitchPreference`和一般偏好的问题的解决方案。

首先，我应该注意，对于 14 之前的 API 级别，默认情况下，偏好标题似乎是多行的——至少我没有看到 Android 2.3.3 中的长标题有任何问题。在较新版本的 Android 中，此行为已更改为强制单行标题。

解决方法是稍微调整一下`SwitchPreference`或任何其他类型的首选项布局。

在首选项屏幕文件中添加`android:layout`所需首选项的属性，例如：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
  <PreferenceCategory android:title="@string/prefs_category">
    <SwitchPreference
        android:key="keyOfThePreference"
        android:title="@string/pref_title"
        android:switchTextOn="@string/pref_on"
        android:switchTextOff="@string/pref_off"
        android:summaryOn="@string/pref_enabled"
        android:summaryOff="@string/pref_disabled"
        android:layout="@layout/preference_multiline"
        />
        ... 
```

接下来，提供`preference_multiline.xml`替代布局。我使用了标准的修改版本`preference.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- Layout for a Preference in a PreferenceActivity. The
     Preference is able to place a specific widget for its particular
     type in the "widget_frame" layout. -->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:minHeight="?android:attr/listPreferredItemHeight"
    android:gravity="center_vertical"
    android:paddingRight="?android:attr/scrollbarSize"
    android:background="?android:attr/selectableItemBackground" >

    <ImageView
        android:id="@+android:id/icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        />

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="15dip"
        android:layout_marginRight="6dip"
        android:layout_marginTop="6dip"
        android:layout_marginBottom="6dip"
        android:layout_weight="1">

        <TextView android:id="@+android:id/title"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:singleLine="false"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:ellipsize="marquee"
            android:fadingEdge="horizontal" />

        <TextView android:id="@+android:id/summary"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@android:id/title"
            android:layout_alignLeft="@android:id/title"
            android:textAppearance="?android:attr/textAppearanceSmall"
            android:textColor="?android:attr/textColorSecondary"
            android:maxLines="4" />

    </RelativeLayout>

    <!-- Preference should place its actual preference widget here. -->
    <LinearLayout android:id="@+android:id/widget_frame"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:gravity="center_vertical"
        android:orientation="vertical" />

</LinearLayout> 
```

在这里，我故意`android:singleLine`将标题中的值`TextView`从更改`true`为`false`。这可以完成工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-02-23T22:28:59.060

根据[此处](https://stackoverflow.com/a/67337810/878126)和[此处](https://stackoverflow.com/a/51568782/878126)的解决方案，如果有人愿意，这是一种为所有人设置它的方法：

```
abstract class BasePreferenceFragment : PreferenceFragmentCompat() {

    private fun applyOperationsForAllPreferences(preference: Preference) {
        // preference.isIconSpaceReserved = false //you can add this too, if you don't want icons space
        preference.isSingleLineTitle = false
        if (preference is PreferenceGroup)
            for (i in 0 until preference.preferenceCount)
                applyOperationsForAllPreferences(preference.getPreference(i))
    }

    override fun setPreferenceScreen(preferenceScreen: PreferenceScreen?) {
        preferenceScreen?.let { applyOperationsForAllPreferences(it) }
        super.setPreferenceScreen(preferenceScreen)
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-30T17:03:22.820

## **2021：**使用 androidx.preference 时（可能每个人都有）

## 你可以简单地使用`app:singleLineTitle="false"`

```
<Preference
        app:key="your_key"
        app:singleLineTitle="false"
        app:title="LONG TITLEEEEEEE EEEEEEEEE EEEEEEEEEEEEEEE" /> 
```

也适用于开关等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-12T15:01:17.697

我不想复制粘贴布局，所以我最终将首选项子类化：

```
import android.content.Context;
import android.support.v7.preference.CheckBoxPreference;
import android.support.v7.preference.PreferenceViewHolder;
import android.util.AttributeSet;
import android.widget.TextView;

public class CustomCheckboxPreference extends CheckBoxPreference {

  public CustomCheckboxPreference(Context context) {
    super(context);
  }

  public CustomCheckboxPreference(Context context, AttributeSet attrs) {
    super(context, attrs);
  }

  public CustomCheckboxPreference(Context context, AttributeSet attrs, int defStyleAttr) {
    super(context, attrs, defStyleAttr);
  }

  public CustomCheckboxPreference(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
    super(context, attrs, defStyleAttr, defStyleRes);
  }

  @Override
  public void onBindViewHolder(PreferenceViewHolder holder) {
    super.onBindViewHolder(holder);
    TextView title = (TextView) holder.findViewById(android.R.id.title);
    if (title != null) {
      title.setSingleLine(false);
    }
  }

} 
```

然后只需在您的`prefs.xml`：

```
<android.support.v7.preference.PreferenceScreen ...>
  <android.support.v7.preference.PreferenceCategory ...>
    <com.example.CustomCheckboxPreference
      ...
      /> 
```

# c# - 在 C# 中打印预览图像

> ID：15853774
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:16.187
> 
> 标签：c#, printing

我试图自动填写 pdf 表单，但它不会让我在 pdf 上绘图。所以我创建了一个表格的图像并使用拉绳方法填充它。问题是，即使打印审查在我尝试打印时正确显示文档，我也会得到一个大于纸张尺寸的放大文档。我无法想象为什么。这是我的代码：

```
private void buttonPrint_Click(object sender, EventArgs e)
    {
        Image img = panelForm.BackgroundImage;
        printDocumentForm.DefaultPageSettings.PaperSize = new PaperSize("A4", img.Width, img.Height);
        printPreviewForm.Document = printDocumentForm;
        printPreviewForm.ShowDialog();
    }

    private void printDocumentForm_PrintPage(object sender, PrintPageEventArgs e)
    {

        Image img = panelForm.BackgroundImage;
        Image copy = (Image) img.Clone();
        // I've added some drawstring methods here to fill the blanks
        // but I removed them in this example to save some space
        e.Graphics.DrawImage(copy, new Point(0, 0));
    } 
```

预览窗口显示了正确的文档，其中填满了空白。但是当我按下预览窗口上的打印按钮时，我得到了放大的文档......编辑：我应该补充一点，当我用 Paint 打开 .bmp 文件时，我可以正确打印图像。同样的图像在我的项目中显得更大更模糊，没有任何明显的原因。为什么打印机会拉伸我的图像？为什么预览窗口会显示正确的图像尺寸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:31:23.747

这就是我想出的：

```
 printDoc.DefaultPageSettings.PaperSize=printDoc.PrinterSettings.PaperSizes[4];
        // this sets the printPreview document size to A4\. The previously presented code doesn't
        Image img = panelDM.BackgroundImage; // this is what I want to print
        Rectangle bounds = e.PageBounds;            
        int mx = 30;
        int my = 30; // add borders
        int x = img.Width;
        int y = img.Height;
        int xp = bounds.Width*9/10; // for some reason (I can't explain why)
        int yp = bounds.Height*9/10; // 100% appears larger than the page...
        int xr, yr;
        if (x > y)
        {
            xr = xp-mx;
            yr = xr*y/x;
        }
        else
        {
            yr = yp-my;
            xr = yr*x/y;
        }
        Size size = new Size(xr,yr);
        Image copy = (Image)img.Clone();            

        e.Graphics.DrawImage(copy, new Rectangle(new Point (mx,my), size)); 
```

所以我认为您需要通过更改 defaultpagesettings.pagesize 属性来设置打印预览页面大小。我不知道为什么自定义纸张尺寸不起作用。然后你需要在 DrawImage 方法中设置图像大小。最后一件事：图像不像原点那样清晰。它可用但模糊。

# sql - 将 SQL 语句转换为 LINQ

> ID：15853776
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:33.267
> 
> 标签：sql, sql-server, entity-framework

我正在使用 EF 开发 ASP.Net MVC4 应用程序，我正在编写我的查询。我还在探索 linq ！

这是我的 SQL 语句：我有 7 个表在它们之间进行连接 :: Date、Student、Task、Timing、Assign、SousType、TypeT

```
select  type ,  from Date , Student, Task,  Timing , Assign ,SousType,TypeT 
where DateT.ID_Date=Timing.ID_Date and Timing.ID_Timing = Assign.ID_Assign and Assign.ID_Student=Student.ID_Student 
and Assign.ID_Task= Task.ID_Task and Task.ID_SousType = SousType.ID_Sousype and SousType.ID_TypeT = TypeT.ID_Type ; 
```

我开始一步一步地转换它，但我可以走得更远，

```
 var students = from s in db.student
                      select s;
   IQueryable<Assign> mylist = db.Assign.Where(s => s.ID_Student == students.ID_student); 
```

但是自从我得到“IQueryable”以来，我不能继续以同样的方式来验证每个表的 ID。

我是不是走对了！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:21:16.283

查看 LINQ 101，有一个专用的连接运算符：[http ://code.msdn.microsoft.com/LINQ-Join-Operators-dabef4e9](http://code.msdn.microsoft.com/LINQ-Join-Operators-dabef4e9)

# java - 组织 java GUI

> ID：15853777
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:33.877
> 
> 标签：java, swing, model-view-controller, user-interface, windowbuilder

我对 GUI 很陌生，我想了解如何正确构建我的程序。

我正在寻找为 MVC 模型创建一个 GUI（所有控制方法都已实现）。假设我需要有 3 个单独的窗口，某些按钮关闭一个窗口并打开另一个窗口。

我正在考虑开设 3 节课，每个窗口一节课。每个窗口都是一个 JFrame。这合理吗？然后，我们需要放入动作监听器。那些会去哪里？我在想应该有另外一个类，主要方法。该类还可以具有所有动作侦听器，因为该类还创建了控件并能够调用控件的方法。这是一个很好的方法吗？

无论您的建议是什么，您能否提供一个关于这在代码方面的外观的想法？我知道如何将组件放在一个框架中，并在该框架中添加一个侦听器，以便按钮执行某些操作。但我不确定这在多个窗口中会是什么样子。任何小例子都可以。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:34:44.097

我建议您不要使用交换 JFrame，因为这对用户来说非常烦人——您目前使用多少个应用程序会依次向您抛出一堆窗口？相反，请考虑在需要时明智地使用对话窗口，例如，程序必须停止，直到用户以某种方式（例如登录）与其交互，但主要是您使用 CardLayout交换*视图（通常是 JPanel）。*您的 Swing GUI 类应该面向创建 JPanel，这将更好地实现这种灵活性。

是的，您的 GUI 代码的主要单独部分应该在单独的类中。

此外，我强烈建议不要使用 GUI 构建器实用程序来创建 Swing 应用程序，直到程序员对 Swing 基础知识掌握得很好。

有关 Swing MVC 的简单示例，请看这里：[using-a-jfilechooser-with-swing-gui-classes-and-listeners](https://stackoverflow.com/questions/15728619/using-a-jfilechooser-with-swing-gui-classes-and-listeners/15729267#15729267)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T23:07:13.237

请注意，每个`JFrame`都有自己的任务栏条目（我认为）。考虑`JDialog`是否要避免这种情况和/或需要模态窗口。

组织在多个地方使用的动作的一种方法是创建一个单例散列（作为它自己的类或上下文类）来存储它们。使用`Action`类而不是`ActionListener`为此 - 将其传递给`JButton`的构造函数。

你的程序可能是这样的：

1.  创建 ShowViewFooAction 并添加到 ActionHash
2.  创建 ShowViewBarAction 并添加到 ActionHash
3.  创建 ShowViewBazAction 并添加到 ActionHash
4.  创建 ViewFoo
    1.  使用 ActionHash 中的 ShowViewBarAction 创建 ShowViewBarButton
    2.  使用 ActionHash 中的 ShowViewBazAction 创建 ShowViewBazAction
5.  创建 ViewBar ...
6.  创建 ViewBaz ...

至于一般结构化 Swing 代码，请查看[JGoodies Binding](http://www.jgoodies.com/download/libraries/binding/binding-1_5_0.zip)。他们在[1.5.0](http://www.jgoodies.com/downloads/archive/)版本中有教程/示例代码（它很旧但仍然是一个很好的例子）。

# merge - 在记事本++中合并末尾没有句点的行

> ID：15853778
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:35.940
> 
> 标签：merge, notepad++

我有一个断行的 PDF 文本：S

我想加入不以句点（或点）结尾的行。

例如：

```
STAN LEE: There are over
six billion people on Earth.
Genetically, most of us are
almost the same.
But every now and then,
a mutation occurs. 
```

在

```
STAN LEE: There are over six billion people on Earth.
Genetically, most of us are almost the same.
But every now and then, a mutation occurs. 
```

对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:21:26.043

打开查找和替换。`regular expressions`在底部设置选项。寻找

```
([^.])\r\n 
```

并替换为

```
\1_ 
```

`_`这里是一个空间。

# html - 文本旁边的输入单选按钮

> ID：15853781
> 
> 赞同：1
> 
> 时间：2013-04-06T17:15:46.140
> 
> 标签：html, css

我试图在输入单选按钮之后放置文本，但文本始终位于单选按钮下方。我使用了显示的 CSS，但我得到了相同的结果。

**CSS：**

```
<style>  

.sp-list .sp-item {
  list-style:none;
  margin:0;
  padding:0;
}

.sp-item {
  clear:both;
  display:block;
  margin:1em 0;
}

.sp-input-radio {
  float:left;
  margin:0.5em 1em 0 0;
}

.sp-label {
  display:inline-block;
  width:200px;
  white-space:nowrap;
}

</style> 
```

**HTML：**

```
<fieldset>
<ul class="sp-list">
<li class="sp-item">
<input name="answer" value="1" id="poll-1-1" class="sp-input-radio" type="radio">
<label for="poll-1-1" class="sp-label"> Ok very nice </label>
</li>
</fieldset> 
```

我试过了，但无法在同一行的输入单选之后显示文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:19:58.377

尝试删除`float:left;`输入，它会像你想要的那样排列 - **[jsFiddle here](http://jsfiddle.net/ET2zJ/)**。

只是改变：

```
.sp-input-radio {
  float:left;
  margin:0.5em 1em 0 0;
} 
```

到：

```
.sp-input-radio {
  margin:0.5em 1em 0 0;
} 
```

如有必要，您也可以在该类中取出边距（除非您最初希望它是这样间隔的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:20:19.183

我为您的解决方案创建了一个小提琴，发现您的单选按钮具有以下 css 属性

```
margin:0.5em 1em 0 0; 
```

哪个螨虫引起了问题，我删除了：

**演示**： http: [//jsfiddle.net/u7n4h/](http://jsfiddle.net/u7n4h/)希望对您有所帮助

# actionscript-3 - (AS3) 修复 Frogger Game ActionScript 3

> ID：15853782
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:49.270
> 
> 标签：actionscript-3, flash

我有 10 个与访问未定义属性相关的错误 (1120)。onEnterFrame、onClick、onLeftClick、MouseUp、onUpClick、MouseUp、onDownClick、MouseUp、onRightClick 和 MouseUp。

从第 58 行到第 73 行的 .addEventListener 抛出错误

```
package 
{
    import flash.display.MovieClip;
    import flash.events.KeyboardEvent;
    import flash.ui.Keyboard;
    import flash.events.Event;
    import flash.events.MouseEvent;

    public class FrogKatta extends MovieClip
    {
        // Create instances of library symbols 
        var car1:Car = new Car();
        var car2:Car = new Car();
        var truck1:Truck = new Truck();
        var truck2:Truck = new Truck();
        var frog:Frog = new Frog();
        var FinishLine:finishLine = new finishLine();
        var HealthBar:healthBar = new healthBar();
        var vx:int = 0;
        var vy:int = 0;

        var hit:Boolean = false;
        var carStart:Boolean = false;
        var truckStart:Boolean = false;

        public function frogKatta()
        {
            frog.x = 230;
            frog.y = 375;

            truck1.x = 545;
            truck1.y = 230;

            truck2.x = 560;
            truck2.y = 235;

            car1.x = 550;
            car1.y = 78;

            car2.x = 560;
            car2.y = 80;

            // add created instances to stage 
            addChild(frog);
            addChild(truck1);
            addChild(truck2);
            addChild(car1);
            addChild(car2);
            // * PROBLEM WITH STAGE.ADDEVENTLISTENER
            // Add event listener for keyboard 

// PROBLEM STARTS HERE ***********

            stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
            stage.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);

            addEventListener(Event.ENTER_FRAME, onEnterFrame);

            // Add Event for mouse click 
            stage.addEventListener(MouseEvent.CLICK, onClick);
            // creating instance of onClick from the MouseEvent.CLICK
            //Keyboard 
            left.addEventListener(MouseEvent.MOUSE_DOWN, onLeftClick);
            // to move
            left.addEventListener(MouseEvent.MOUSE_UP, MouseUp);
            // to stop 
            up.addEventListener(MouseEvent.MOUSE_DOWN, onUpClick);
            up.addEventListener(MouseEvent.MOUSE_UP, MouseUp);
            down.addEventListener(MouseEvent.MOUSE_DOWN, onDownClick);
            down.addEventListener(MouseEvent.MOUSE_UP, MouseUp);
            right.addEventListener(MouseEvent.MOUSE_DOWN, onRightClick);
            right.addEventListener(MouseEvent.MOUSE_UP, MouseUp);

//  PROBLEM ENDS HERE****

            // Keyboard functionality 
            function onKeyDown(event:KeyboardEvent):void
            {
                if (event.keyCode == Keyboard.LEFT)
                {
                    vx = -5;
                    frog.play();
                }
                else if (event.keyCode == Keyboard.RIGHT)
                {
                    vx = 5;
                    frog.play();
                }
                else if (event.keyCode == Keyboard.DOWN)
                {
                    vy = 5;
                    frog.play();
                }
                else if (event.keyCode == Keyboard.UP)
                {
                    vy = -5;
                    frog.play();
                }
            }

            // Keyboard again to stop 
            function onKeyUp(event:KeyboardEvent):void
            {
                if (event.keyCode == Keyboard.LEFT || event.keyCode == Keyboard.RIGHT)
                {
                    vx = 0;
                    frog.stop();
                }
                else if (event.keyCode == Keyboard.DOWN || event.keyCode == Keyboard.UP)
                {
                    vy = 0;
                    frog.stop();
                }

                // Clicking Functionality
                function MouseUp(event:MouseEvent):void
                {
                    vy = 0;
                    vx = 0;
                    frog.stop();
                }
                // on"librarybutton name left" Click
                function onLeftClick(event:MouseEvent):void
                {
                    vx = -5;
                    frog.play();
                }
                function onUpClick(event:MouseEvent):void
                {
                    vy = -5;
                    frog.play();
                }
                function onDownClick(event:MouseEvent):void
                {
                    vy = 5;
                    frog.play();
                }
                function onRightClick(event:MouseEvent):void
                {
                    vx = 5;
                    frog.play();
                }

                // on enter frame 
                function onEnterFrame(event:Event):void
                {
                    frog.x +=  vx;
                    frog.y +=  vy;

                    truck1.x +=  -10;
                    car1.x +=  -20;

                    //Car1 & 2 SCREEN WRAPPING 
                    if (car1.x <= -400)
                    {
                        car1.x = 550;
                    }
                    // If car 1 leaves screen add car to other side of the screen

                    if (car2.x <= -400)
                    {
                        car2.x = 550;
                    }

                    if (car1.x <= 135)
                    {
                        carStart = true;
                    }
                    // Screen wrap so if car is less than or equal to 135 in distance add another car 

                    if (carStart)
                    {
                        car2.x +=  -15;
                    }

                    //Truck1 & 2 
                    if (truck1.x <= -400)
                    {
                        truck1.x = 550;
                    }

                    if (truck2.x <= -400)
                    {
                        truck2.x = 550;
                    }

                    if (truck1.x <= 135)
                    {
                        truckStart = true;

                    }

                    if (truckStart)
                    {
                        truck2.x +=  -10;

                    }
                    if (frog.hitTestObject(truck1) || frog.hitTestObject(truck2) || frog.hitTestObject(car1) || frog.hitTestObject(car2))
                    {
                        frog.y +=  10;
                        hit = true;

                    }
                    if (hit)
                    {
                        if (HealthBar.width < 10)
                        {
                            HealthBar.width = 0;
                        }
                        else
                        {
                            HealthBar.width -=  10;
                        }
                    }

                    if (HealthBar.width < 1)
                    {
                        //S.O.P you lose);
                    }

                    if (frog.hitTestObject(FinishLine))
                    {

                        removeChild(frog);
                        removeChild(FinishLine);
                        removeChild(car1);
                        removeChild(car2);
                        removeChild(truck1);
                        removeChild(truck2);
                        // addchild of you winning

                    }

                }
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:35:15.170

我相信你有一个括号问题。

在 onKeyDown 函数之前需要一个 '}'。

检查所有括号，在插入我告诉你的位置之后，文件末尾可能还会有一个额外的括号。

这些行是一个问题，因为您的代码中不存在上/下/左/右。如果它们是阶段实例，它们可能没有命名，因此您的代码将无法使用它们。如果是这种情况，请通过属性面板命名实例。

```
 left.addEventListener(MouseEvent.MOUSE_DOWN, onLeftClick);
    // to move
    left.addEventListener(MouseEvent.MOUSE_UP, MouseUp);
    // to stop 
    up.addEventListener(MouseEvent.MOUSE_DOWN, onUpClick);
    up.addEventListener(MouseEvent.MOUSE_UP, MouseUp);
    down.addEventListener(MouseEvent.MOUSE_DOWN, onDownClick);
    down.addEventListener(MouseEvent.MOUSE_UP, MouseUp);
    right.addEventListener(MouseEvent.MOUSE_DOWN, onRightClick);
    right.addEventListener(MouseEvent.MOUSE_UP, MouseUp); 
```

在不关闭 onKeyUp 函数时，您还有另一个括号问题。

这导致它认为您的所有事件处理程序都在该函数中。

但正如我在评论中所说，这真的不是调试您的应用程序论坛。

请按照我的要求花时间验证您的括号。当您没有花时间检查已发现有问题的事情时，它不会对某人的时间表示太多赞赏。请花时间验证每个功能的所有括号，您将节省大量时间。

# iphone - 将 cllocation 传递给 tableview

> ID：15853784
> 
> 赞同：0
> 
> 时间：2013-04-06T17:15:51.210
> 
> 标签：iphone, ios, uitableview, cllocation

我正在尝试显示用户位置和目标位置之间距离的应用程序。我打算获取用户位置 didUpdateToLocation 方法并存储在数组中。然后，将其放入表格视图委托“cellForRowAtIndexPath”中以计算距离并显示在表格单元格中。但是，它不起作用。请看我的代码如下。有人可以帮忙吗？

```
-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation   *)newLocation fromLocation:(CLLocation *)oldLocation{

if (newLocation.horizontalAccuracy < 0) return;

NSTimeInterval locationAge = -[newLocation.timestamp timeIntervalSinceNow];

if (locationAge > 5.0) return;

if (currentLocation == nil || currentLocation.horizontalAccuracy >   newLocation.horizontalAccuracy) {

self.currentLocation = newLocation;
// locationMeasurements is NSMutableArray to store currentLocation (CLLocation) information.

[locationMeasurements addObject:currentLocation];

[self.tableView reloadData];          
       }
    }
}

 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle 
                                   reuseIdentifier:CellIdentifier] autorelease];
    }

   CLLocation *location = [locationMeasurements objectAtIndex:indexPath.row];

return cell;

} 
```

它崩溃了，在控制台的数组中什么也没告诉我（见下文）。但是，我在 'didUpdateToLocation' 中 NSLog 这个数组，它可以正确显示它。

```
**** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 0 beyond bounds for empty array'* 
```

然后，我尝试 NSLog locationMeasurements (array) in cellForRowAtIndexPath

```
NSLog(@"locationMeasurements ===%@",[locationMeasurements description]); 
```

它在几个语句中显示空白信息，然后显示正确的信息。见下文。

```
locationMeasurements ===(
)
locationMeasurements ===(
)
locationMeasurements ===(
)
locationMeasurements ===(
)
locationMeasurements ===(
    "<+37.33233141,-122.03121860> +/- 5.00m (speed 0.00 mps / course -1.00) "
)
locationMeasurements ===(
    "<+37.33233141,-122.03121860> +/- 5.00m (speed 0.00 mps / course -1.00) "
)
locationMeasurements ===(
    "<+37.33233141,-122.03121860> +/- 5.00m (speed 0.00 mps / course -1.00) "
)
locationMeasurements ===(
     "<+37.33233141,-122.03121860> +/- 5.00m (speed 0.00 mps / course -1.00) "
) 
```

有人可以给我一些建议吗？我应该怎么办？

预先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:21:13.670

它崩溃了，因为您试图读取不存在的位置测量值。从数组中与值不对应的位置从数组中获取值是错误的。

通常，如果您使用数据数组来填充 a `UITableView`（这很常见），则表中的行数应与数组的大小匹配：

```
-(NSInteger)tableView:(UITableView*)tableView 
            numberOfRowsInSection:(NSInteger)section 
{
    return [self.locationMeasurements count];
} 
```

如果你这样做，你的表格视图应该在每次添加`CLLocation`到你的测量数组时更新一个新行。

无需在每次添加测量时重新加载整个表，您还可以只添加新行，这很容易，因为您总是在追加。它还允许您为添加的行设置动画。代替

```
[locationMeasurements addObject:currentLocation];
[self.tableView reloadData]; 
```

和

```
[locationMeasurements addObject:currentLocation];
NSIndexPath *newPath = [NSIndexPath indexPathForRow:([locationMeasurements count] - 1)
                                          inSection:0];
NSArray *paths = [NSArray arrayWithObject:newPath];
[self.tableView insertRowsAtIndexPaths:paths
                      withRowAnimation:UITableViewRowAnimationBottom]; 
```

# c++ - 为什么从字符串到 char 数组的赋值缺少最后一个字符？

> ID：15853785
> 
> 赞同：1
> 
> 时间：2013-04-06T17:15:57.233
> 
> 标签：c++

我正在尝试将 a 的内容插入`std::string`到 char 数组中。所以我制作了一个字符串流并`getline`对其进行处理，但由于某种原因，`a`当我打印它时，数组中缺少最后一个字符。为什么是这样？

```
#include <iostream>
#include <sstream>
#include <string>

int main()
{
   std::string str = "Hello, World";
   std::stringstream ss(str);

   char a[256];

   ss.getline(&a[0], str.length());

   std::cout << a; // "Hello, Worl"
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-06T17:20:44.663

原因是第二个参数`getline`应该给出你愿意放弃的缓冲区的大小，而不是要提取的字符数。所以实际上，大小包括空字符。您是说您希望它最多提取 12 个字符（字符串的长度）。由于我们需要为空字符腾出空间，当然我们只能比整个字符串少一个。

真的，你应该像这样使用它：

```
ss.getline(a, 256); 
```

参数是它可能在数组中写入的*最大*s数，*而不是*您要获取的字符串中的字符数。它提取的字符数由分隔符（在本例中）确定。当然，您可以创建任意数量的s from以允许其写入。请记住，它包含空字符。`char`*`\n``256``char``a`*

 *请注意，这`&a[0]`是不必要的。如果需要，数组将进行数组到指针的转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T17:27:47.373

检查`getline` [文档](http://www.cplusplus.com/reference/istream/istream/getline)，第二个参数指定带有空终止字符的字符串大小，因此在您的程序中您应该使用： `ss.getline(&a[0], str.length() + 1);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T17:22:10.477

你的问题是你传递的大小太少了`getline()`，但是有更好的方法来做到这一点。使用 C++11，您可以模拟一个可修改的字符数组（`std::string`具有不可修改的成员函数），只需使用`std::string`：

```
std::string str = "Hello";
someFunc(&str[0], str.size()); 
```

但是，请确保`someFunc`它不会覆盖空字符，即使它与另一个空字符一起使用。传递正确的尺寸以适应它。

如果没有 C++11，最简单的方法可能是向量：

```
std::string str = "Hello";
std::vector<char> vec(str.begin(), str.end());
someFunc(&vec[0], vec.size()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-06T17:23:01.473

的第二个参数`getline()`是要写入的最大字符数`a`（包括空字符）。*

# java - 带有 Oracle 11G 的休眠条件 setMaxResults 给出 org.hibernate.exception.SQLGrammarException: ORA-00918: 列定义不明确

> ID：15853786
> 
> 赞同：0
> 
> 时间：2013-04-06T17:16:11.027
> 
> 标签：java, oracle, hibernate, criteria, ambiguous

我们针对 Oracle 11G 数据库使用带有 JBoss 7 的 Hibernate 4.0。java pojo 类具有这两个属性（除其他属性外）。请注意，SalesPerson 类有一个 SalesPersonId，它是一个持续存在于 SalesOrder 表中的复合键。

```
public class SalesOrder extends OurBaseClass<SalesOrder>{
    private SalesPersonId salesPersonId;
    private SalesPerson salesPerson;

    @Embedded
    @AttributeOverride(name = "location", column = @Column(name = "sale_person_loc"))
    @XmlElement
    public SalesPersonId getSalesPersonId() {
       return salesPersonId;
    }
    public void setSalesPersonId(SalesPersonId salesPersonId) {
        this.salesPersonId = salesPersonId;
    }
    //The below object contains a SalesPersonId as composite primary key
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumns( {
    @JoinColumn(name = "sales_person_no",  insertable = false, updatable = false),
    @JoinColumn(name = "sales_person_loc",  insertable = false, updatable = false)
    } )
    @XmlElement
    public SalesPerson getSalesPerson() {
        return salesPerson;
    }
    public void setSalesPerson(SalesPerson salesPerson) {
        this.salesPerson = salesPerson;
    }
} 
```

休眠条件代码如下：

```
Session session = (Session) manager.getDelegate();
Criteria criteria = session
    .createCriteria(SalesOrder.class,"so")
    .createAlias("salesPerson", "salesperson",JoinType.LEFT_OUTER_JOIN)
    .setMaxResults(100)
    .addOrder(Order.asc("id")); 
```

hibernate生成的sql是这样的：

```
select * from ( select this_.sales_person_no as sales_person4_641_2_,
            this_.sales_person_loc as sales_person5_641_2_, 
            this_.SALES_PERSON_NO as SALES_PERSON4_641_2_
            from SALES_ORDER this_, sales_person sales_person2_
            where this_.sales_person_no=sales_person2_.sales_person_no(+) and
            this_.sales_person_loc=sales_person2_.loc(+) 
order by this_.order_no asc ) where rownum <= ? 
```

返回的错误是由于休眠生成的重复列名。有什么可以解决这个错误的吗？我知道如果我从 pojo 中删除 SalesPersonId，我不会收到错误，但是，我被告知该类需要 SalesPerson 和 SalesPersonId。我也知道如果我删除 setMaxResults 我没有收到错误，但是，这不是一个选项。感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T14:35:43.967

我确实想通了。这个问题帮助了我： [@AttributeOverride 是什么意思？](https://stackoverflow.com/questions/4432748/what-does-attributeoverride-mean)

出于某种原因，仅覆盖了嵌入 id 的复合键的一个属性。所以我在位置覆盖中添加了一个客户属性覆盖，这就解决了这个问题。

# playframework-2.1 - Play 2.1 的 SecureSocial 配置问题

> ID：15853787
> 
> 赞同：0
> 
> 时间：2013-04-06T17:16:12.713
> 
> 标签：playframework-2.1, securesocial

我想在我的应用程序中只支持 facebook、twitter 和 google，所以我从`securesocial.conf`. 我的应用程序现在没有启动，我收到以下错误：

```
Cannot load plugin
An exception occurred during Plugin [securesocial.core.providers.LinkedInProvider] initialization
No source available, here is the exception stack trace:
->java.lang.RuntimeException: [securesocial] Missing properties for provider 'linkedin'. Verify your configuration file is properly set.
 securesocial.core.IdentityProvider.throwMissingPropertiesException(IdentityProvider.scala:136)
 securesocial.core.OAuth1Provider.createServiceInfo(OAuth1Provider.scala:50)
 securesocial.core.OAuth1Provider.<init>(OAuth1Provider.scala:33)
 securesocial.core.providers.LinkedInProvider.<init>(LinkedInProvider.scala:29) 
```

这是一个错误还是我遗漏了什么，我必须以其他方式配置 SecureSocial？

SecureSocial：提交[6f0ff343e1](https://github.com/jaliss/securesocial/blob/6f0ff343e1647005eedfd52e264dc1c406e05b5d)，播放 2.1

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:43:38.957

您必须`conf/play.plugins`正确配置并删除不需要的提供程序。另请参阅[http://securesocial.ws/guide/installation.html](http://securesocial.ws/guide/installation.html)

# java - 在刽子手程序中显示猜测的字母？

> ID：15853796
> 
> 赞同：0
> 
> 时间：2013-04-06T17:16:58.540
> 
> 标签：java

一旦在我的刽子手程序中被猜到，我希望能够显示猜到的字母。因此，例如，如果单词是 hello，它将向玩家显示为**所以是 h 被玩家猜到了，它会说是，但是然后显示字符串 h* *** 有谁知道我怎么能做到这一点？这是我的代码：*

 *刽子手类：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package hangman;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Random;
import java.util.Scanner;

/**
 *
 * @author Adam2_000
 */
public class Hangman {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        String player = "";
        String selection;
        int turn = 12;
        List<String> wordBox = new ArrayList<String>();
        boolean hangman = false;
        Scanner scan = new Scanner(System.in);

        //New instances of class and arrays
        words words = new words();
        String easyWords1[] = words.easyWords;
        String mediumWords1[] = words.mediumWords;
        String hardWords1[] = words.hardWords;
        Random random = new Random();

        System.out.println("Welcome to Hangman version 1");
        System.out.println("Please choose a difficulty");
        System.out.println("A: Easy");
        System.out.println("B: Medium");
        System.out.println("C: Hard");

        System.out.println(" _________     ");
        System.out.println("|         |    ");
        System.out.println("|         0    ");
        System.out.println("|        /|\\  ");
        System.out.println("|        / \\  ");
        System.out.println("|              ");
        System.out.println("|              ");

        char iChoice;

        do {
            selection = scan.nextLine().toUpperCase();
        } while (selection.isEmpty());
        iChoice = selection.charAt(0);
        if (iChoice != 'X') {
            switch (iChoice) {

                case 'A':
                    System.out.println("You have choosen easy:");
                    //Get and print random string from easyWords                   
                    int selectA = random.nextInt(easyWords1.length);
                    String replaceAllEasy = easyWords1[selectA].replaceAll("\\S", "*");
                    // Print the randomly selected word and its length
                    System.out.println("Random String selected: " + replaceAllEasy);
                    System.out.println("This word contains " + easyWords1[selectA].length() + " letters");

                    //while hangman == false continue to ask player for letters
                    while (hangman == false) {
                        System.out.println("Turns remaining: " + turn);
                        System.out.println("Please choose a letter A-Z :");
                        String easyChosenLetter = scan.next();

                        if (wordBox.contains(easyChosenLetter)) {
                            System.out.println("Letter alreay choosen please choose another letter");
                        } else {
                            wordBox.add(easyChosenLetter);
                        }

                        if (easyWords1[selectA].contains(easyChosenLetter)) {

                            System.out.println("Wordbox letters are: " + wordBox);
                            System.out.println("Yes!");
                            turn--;
                        } else {
                            System.out.println("Wordbox letters are: " + wordBox);
                            System.out.println("No!");
                            turn--;
                        }

                        if (turn == 0) {
                            hangman = true;
                        }

                        while (hangman == true) {
                            System.out.println("You lose!");
                            System.exit(0);
                        }

                        //unstarredString = "Bee", you can do unstarredString.substring(0,1) + oldstr.substring(1,2)
                    }
                    break;

                case 'B':
                    System.out.println("You have choosen Medium");
                    //Get and print random string from mediumWords
                    int selectB = random.nextInt(mediumWords1.length);
                    String replaceAllMedium = mediumWords1[selectB].replaceAll("\\S", "*");
                    // Print the randomly selected word and its length
                    System.out.println("Random String selected: " + replaceAllMedium);
                    System.out.println("This word contains " + mediumWords1[selectB].length() + " letters");

                    //while hangman == false continue to ask player for letters
                    while (hangman == false) {
                        System.out.println("Turns remaining: " + turn);
                        System.out.println("Please choose a letter A-Z :");
                        String mediumChosenLetter = scan.next();

                        if (wordBox.contains(mediumChosenLetter)) {
                            System.out.println("Letter alreay choosen please choose another letter");
                        } else {
                            wordBox.add(mediumChosenLetter);
                        }

                        wordBox.add(mediumChosenLetter);
                        if (easyWords1[selectB].contains(mediumChosenLetter)) {
                            System.out.println("Wordbox letters are: " + wordBox);
                            System.out.print("Yes!");
                            turn--;

                        } else {
                            System.out.println("Wordbox letters are: " + wordBox);
                            System.out.println("No!");
                            turn--;
                        }

                        if (turn == 0) {
                            hangman = true;
                        }

                        while (hangman == true) {
                            System.out.println("You lose!");
                            System.exit(0);
                        }

                    }
                    break;

                case 'C':
                    System.out.println("You have choosen Hard");
                    //Get and print random string from hardWords
                    int selectC = random.nextInt(hardWords1.length);
                    String replaceAllHard = hardWords1[selectC].replaceAll("\\S", "*");
                    // Print the randomly selected word and its length  
                    System.out.println("Random String selected: " + replaceAllHard);
                    System.out.println("This word contains " + hardWords1[selectC].length() + " letters");

                    //while hangman == false continue to ask player for letters
                    while (hangman == false) {
                        System.out.println("Turns remaining: " + turn);
                        System.out.println("Please choose a letter A-Z :");
                        String hardChosenLetter = scan.next();

                        if (wordBox.contains(hardChosenLetter)) {
                            System.out.println("Letter alreay choosen please choose another letter");
                        } else {
                            wordBox.add(hardChosenLetter);
                        }

                        wordBox.add(hardChosenLetter);
                        if (easyWords1[selectC].contains(hardChosenLetter)) {
                            System.out.println("Wordbox letters are: " + wordBox);
                            System.out.print("Yes!");
                            turn--;

                        } else {
                            System.out.println("Wordbox letters are: " + wordBox);
                            System.out.println("No!");
                            turn--;
                        }

                        if (turn == 0) {
                            hangman = true;
                        }

                        while (hangman == true) {
                            System.out.println("You lose!");
                            System.exit(0);
                        }

                    }
                    break;

            }

        }
    }
} 
```

词类：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package hangman;

import java.lang.reflect.Array;
import java.util.Random;

/**
 *
 * @author Adam2_000
 */
public class Words extends Hangman {

    String[] easyWords = {"Bee", "Car", "Fish", "Shed"};
    String[] mediumWords = {"House", "Sheep", "Castle", "Phone"};
    String[] hardWords = {"Octagon", "Crocodile", "Chocolate", "Motorbike"};

    public String[] getEasyWords() {
        return easyWords;
    }

    public void setEasyWords(String[] easyWords) {
        this.easyWords = easyWords;
    }

    public String[] getMediumWords() {
        return mediumWords;
    }

    public void setMediumWords(String[] mediumWords) {
        this.mediumWords = mediumWords;
    }

    public String[] getHardWords() {
        return hardWords;
    }

    public void setHardWords(String[] hardWords) {
        this.hardWords = hardWords;
    }

    @Override
    public String toString() {
        return "words{" + "easyWords=" + easyWords + ", mediumWords=" + mediumWords + ", hardWords=" + hardWords + '}';
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:19:34.067

首先，我建议您将 Hangman 代码拆分为两个文件。前任。

刽子手.java

```
package hangman;

import java.util.Scanner;

/**
 *
 * @author Adam2_000
 */
public class Hangman {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        String selection;
        Scanner scan = new Scanner(System.in);

        /*
         *  I moved the variables found here to the Game class 
         */

        //New instances of class and arrays
        Words words = new Words();

        System.out.println("Welcome to Hangman version 1");
        System.out.println("Please choose a difficulty");
        System.out.println("A: Easy");
        System.out.println("B: Medium");
        System.out.println("C: Hard");
        System.out.println("X: Exit");      // Just for user friendlyness

        System.out.println(" _________     ");
        System.out.println("|         |    ");
        System.out.println("|         0    ");
        System.out.println("|        /|\\  ");
        System.out.println("|        / \\  ");
        System.out.println("|              ");
        System.out.println("|              ");

        char iChoice;

        do {
            selection = scan.nextLine().toUpperCase();
        } while (selection.isEmpty());

        iChoice = selection.charAt(0);
        if (iChoice != 'X') {
            switch (iChoice) {
                case 'A':
                    System.out.println("You have chosen easy:");
                    new Game(words.easyWords, scan);                //All three levels can be called from the same class with the same code.
                    break;                                          //This will help reduce amount of code, and help when you need to change all three at once.

                case 'B':
                    System.out.println("You have chosen Medium");
                    new Game(words.mediumWords, scan);              //Called with the String[] of words you want to use and the scanner to save memory.
                    break;

                case 'C':
                    System.out.println("You have chosen Hard");
                    new Game(words.hardWords, scan);
                    break;
            }
        }
    }
} 
```

游戏.java

```
 package hangman;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;
import java.util.Scanner;

public class Game {
    String player = "";
    int turn = 12;
    List<String> wordBox = new ArrayList<String>();
    boolean hangman = false;
    Scanner scan;
    Random random = new Random();

    String letters;     // For displaying letters
    String mask;        // For character Mask

    public Game(String[] words, Scanner scanner){
        scan = scanner;

        int selectA = random.nextInt(words.length);

        letters = words[selectA];               //Load word into String for display. This just makes the code more readable.        
        mask = letters.replaceAll("\\S", "*");  // Mask the words

        System.out.println("Random String selected: " + mask);
        System.out.println("This word contains " + letters.length() + " letters");

        while (hangman == false) {
            System.out.println("Turns remaining: " + turn);
            System.out.println("Please choose a letter A-Z :");
            String ChosenLetter = scan.next();

            if (wordBox.contains(ChosenLetter)) {
                System.out.println("Letter already chosen please choose another letter");
            } else {
                wordBox.add(ChosenLetter);
            }

            if (letters.contains(ChosenLetter)) {
                char[] cLetters = letters.toCharArray();    //Load letters and mask to char array for editing
                char[] cMask = mask.toCharArray();

                for(int i=0; i < cMask.length; i++){
                    if(cLetters[i] == ChosenLetter.charAt(0)){
                        cMask[i] = cLetters[i];
                    }
                }

                mask = new String(cMask);   //Load new mask into String

                System.out.println("Wordbox letters are: " + wordBox);
                System.out.println("Yes!" + mask);                      // Prints mask after Yes!

                turn--;
            } else {
                System.out.println("Wordbox letters are: " + wordBox);
                System.out.println("No!" + mask);                               //Prints mask after No!
                turn--;
            }

            if (turn == 0) {
                hangman = true;
            }

            while (hangman == true) {
                System.out.println("You lose!");
                System.exit(0);
            }
        }
    }
} 
```

接下来我想告诉你我是如何回答你的问题的。

在上面的代码中，您会看到我已经将单词加载到了一些名为`mask`and的变量`letters`中。然后我在这段代码中使用了这些变量

```
 char[] cLetters = letters.toCharArray();//Load letters and mask to char array for editing
 char[] cMask = mask.toCharArray();

 for(int i=0; i < cMask.length; i++){
      if(cLetters[i] == ChosenLetter.charAt(0)){
          cMask[i] = cLetters[i];
      }
  }

  mask = new String(cMask); //Load new mask into String

  System.out.println("Wordbox letters are: " + wordBox);
  System.out.println("Yes!" + mask);                        // Prints mask after Yes! 
```

而对于没有 `System.out.println("No!" + mask);`

我希望这会有所帮助。代码做得很好。我喜欢你设置菜单的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:34:19.300

您需要为每个级别执行此操作。基本上，它依靠在`indexOf`单词中找到字符的位置并替换它。

```
 if (easyWords1[selectC].contains(hardChosenLetter)) {
                String word = easyWords1[selectC];
                char[] unMasked = replaceAllHard.toCharArray();
                unMasked[word.indexOf(hardChosenLetter)] = hardChosenLetter.charAt(0);
                replaceAllHard = new String(unMasked);
                System.out.println("Wordbox letters are: " + wordBox);
                System.out.print("Yes!");
                System.out.println(replaceAllHard);
                turn--;

            } else {
                System.out.println("Wordbox letters are: " + wordBox);
                System.out.println("No!");
                turn--;
            } 
```*

# jquery - 如何在 jQuery 中为我的赛车手生成随机速度？

> ID：15853807
> 
> 赞同：0
> 
> 时间：2013-04-06T17:18:10.553
> 
> 标签：jquery, animation, random

我正在尝试创建一个基本的赛车手，让两个精灵相互对抗。经过一些调整，我让我的赛车手以缓慢的速度向右移动了 550 像素

有我的赛车手和允许他们比赛的按钮

```
<center><button id="race">Race!!</button></center>
<div class="kimo"><img id="kimo" src="images/kimo.gif"  alt="Kimo" height="80"></div>
<div class="kahuna"><img id="kahuna" src="images/kahuna.gif"  alt="Kahuna" height="80"></div> 
```

这是动画它们的脚本

```
<script>
$("#race").click(function(){
$(".kimo").animate({"left": "+=550px"}, "slow");
$(".kahuna").animate({"left": "+=550px"}, "slow");
});
</script> 
```

现在这里是速度明显“慢”的地方，但我想让它们在单击按钮时生成随机速度，并且只使用一次动画。例如，赛车手总共移动了 550 像素。

我需要完成的其他事情：无论谁先到达 550px 的末尾，都会出现说明 Kimo 或 Kahuna 获胜的文字。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:22:50.213

您可以使用它`Math.random`来生成速度，但您首先必须弄清楚最大和最小速度 - 最小速度非常重要，因为 Math.random 可能会生成一个非常小的数字，以至于动画需要任意长的时间去完成。

[编辑]：OP询问是否可以只触发一次动画 - 我已经添加了该`.unbind()`方法，并为该函数分配了一个处理程序。

```
<script>
// Assign handler name, so that we can unbind it specifically
$("#race").click(function animateSprite(){
    // Unbind after first click
    $(this).unbind('click', animateSprite);

    // Set minimum speed
    var minSpeed = 1000;

    // Get random speed
    var kimoSpeed = parseInt(minSpeed + Math.random()*1000, 10),
        kahunaSpeed = parseInt(minSpeed + Math.random()*1000, 10);

    // In this case, the lowest possible speed is 1000, 
    // and the highest possible speed is 2000.
    // You are of course free to adjust the speed.

    // Animate
    $(".kimo").animate({"left": "+=550px"}, kimoSpeed);
    $(".kahuna").animate({"left": "+=550px"}, kahunaSpeed);

    // And if you want to decide who is the fastest, and assuming that you have an element with the id of "announce"
    // Delay announcement by 500ms after the slowest racer
    setTimeout(function(){
        if(kimoSpeed < kahunaSpeed) {
            // Declare Kimo as winner, e.g.
            // $("#announce").text("Kimo has won the race!");
        } else {
            // Declare Kahuna as winner
            // $("#announce").text("Kahuna has won the race!");
        }
    }, Math.max.apply(Math, [kimoSpeed, kahunaSpeed])+500);
});
</script> 
```

# c# - 丢弃参数c#中的对象类型

> ID：15853819
> 
> 赞同：0
> 
> 时间：2013-04-06T17:19:02.913
> 
> 标签：c#, casting, polymorphism

这是我遇到问题的代码部分；

`List<People> people = new List<People>();`

这被填充了 3 种不同类型的对象，它们都派生自 People 类；

```
people.Add(new Student(constructorarguments);
people.Add(new AcademicStaff(constructorarguments);
people.Add(new AdministrativeStaff(constructorarguments); 
```

这是给我带来问题的代码；

```
private void studentCheckbox_CheckedChanged(object sender, EventArgs e)
{
    if (studentCheckbox.CheckState == CheckState.Checked)
    {
        foreach (Student student in people)
        {
            if (student.Compare(SearchTextBox.Text) == 0)
            {
                resultsListBox.Items.Add(student.Forename);
            }
        }
    }
    else
    {}
} 
```

正如您从 CheckState 代码中看到的那样，它使用的是 Windows 窗体。但我遇到的问题是它并没有限制与学生的比较。它试图继续过去的学生，并试图将 AcademicStaff 投射为学生，这是我的程序的错误所在。在过去的几个小时里，我一直在为此苦苦挣扎，没有任何回旋余地，任何帮助将不胜感激！

我不认为问题出在表格或课程本身，但我不知道为什么当我将其限制为 Student 类型时，它为什么要尝试转移到 AcademicStaff

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:32:45.503

这是预期的行为，编译器会枚举您的集合并将每个项目隐式转换为`Student`类型。
如果您只想循环`Students`，则应首先使用[OfType<>()](http://msdn.microsoft.com/ru-ru/library/bb360913.aspx)`people`过滤您的集合：

```
foreach(var student in people.OfType<Student>())
{
  ..
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:33:18.157

您不能在有人员的列表上使用“学生”类型进行迭代，这段代码不应该编译。你需要迭代这样的东西：

```
foreach (People person in people) 
```

如果你想把当前的人选为学生，你应该写：

```
Student s = person as Student; 
```

然后您将能够访问学生方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:32:52.327

您可以使用 linq 方法 OfType()：

```
private void studentCheckbox_CheckedChanged(object sender, EventArgs e)
{
    if (studentCheckbox.CheckState == CheckState.Checked)
    {
        foreach (Student student in people.OfType<Student>())
        {
            if (student.Compare(SearchTextBox.Text) == 0)
            {
                resultsListBox.Items.Add(student.Forename);
            }
        }
    }
    else
    {}
} 
```

希望这对您的探索有所帮助。

# jquery - 预期对象 - IE8 和 IE9 中的 jQuery 错误

> ID：15853825
> 
> 赞同：0
> 
> 时间：2013-04-06T17:19:51.033
> 
> 标签：jquery, google-maps-api-3

我正在使用 Google Maps API v3，但 IE8,9 出现问题。请注意，在其他浏览器中它可以完美运行，没有错误（在页面或控制台上）。

```
jQuery(document).ready(function () {

    var target = jQuery('.google-map'),
        desiredheight = target.parent().siblings('div').height();

    target.height(desiredheight);

});

jQuery(document).ready(function () {

    var target = jQuery('.google-map'),
        myLatlng, myOptions, map, infowindow, marker, mapStyle, styledMap;

    if (target.length > 0) {

        myLatlng = new google.maps.LatLng(target.attr('data-latitude'), target.attr('data-longitude'));

        myOptions = {
            zoom: parseInt(target.attr('data-zoom'), 10) || 6,
            center: myLatlng,
            html: target.attr('data-title'),
            mapTypeControl: false,
            popup: true,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        map = new google.maps.Map(target[0], myOptions);

        mapStyle = [{
            stylers: [{
                saturation: -100
            }]
        }, {
            featureType: 'road',
            elementType: 'geometry',
            stylers: [{
                lightness: 100
            }, {
                visibility: 'simplified'
            }]
        }, {
            featureType: 'road',
            elementType: 'labels',
            stylers: [{
                visibility: 'off'
            }]
        }];

        if (mapStyle) {

            styledMap = new google.maps.StyledMapType(mapStyle, {
                name: 'InspireThemes'
            });
            map.mapTypes.set('map_style', styledMap);
            map.setMapTypeId('map_style');

        }

        infowindow = new google.maps.InfoWindow({
            content: target.attr('data-content')
        });

        marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            title: target.attr('data-title')
        });

        google.maps.event.addListener(marker, 'click', function () {

            infowindow.open(map, marker);

        });

    }

}); 
```

我在第 72 行收到错误报告，这将是：

```
myLatlng = new google.maps.LatLng( target.attr( 'data-latitude' ), target.attr( 'data-longitude' ) ); 
```

现在，我当然尝试了谷歌，所有问题都是由数组或对象末尾的额外逗号引起的，这在 IE 中当然不起作用。但即使我的问题确实有这样的症状，我也无法弄清楚我会在哪里有额外的逗号。

我尝试了各种 js 工具，但没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T18:10:20.600

通过上传到实时服务器解决了问题，localhost 导致了问题。

感谢所有帮助过的人，我很感激！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:41:22.600

老实说，我实际上并不熟悉他们 API 的这一部分，也不了解您的整个用例，但从您的其余代码来看，我认为问题在于您没有指定哪个目标采用该属性从这里：

```
myLatlng = new google.maps.LatLng( target.attr( 'data-latitude' ), target.attr( 'data-longitude' ) ); 
```

它认为它应该是：

```
myLatlng = new google.maps.LatLng( target[i].attr( 'data-latitude' ), target[i].attr( 'data-longitude' ) ); 
```

您从中获取该属性`i`的对象的索引在哪里。`target`

（数组中的第一个元素是一个 jQuery 元素）。 ~~这也可以解释为什么`object expected`当您调用`.attr`on时会出现错误`target`，它是一个对象数组，但它本身不是一个对象。这可能有点令人困惑，因为`.attr`可以在 jQuery 数组上调用 jQuery 方法，但`target`它不是 jQuery 数组，即使是这样，您也可能不会得到预期的结果。~~

**更新**

这不是答案，但您可能还需要`parseInt`调用`target.attr('data-latitude')`and `target.attr('data-longitude')`。

# list - 如何使用记事本++删除复制列表中的数字

> ID：15853826
> 
> 赞同：0
> 
> 时间：2013-04-06T17:19:51.673
> 
> 标签：list, notepad++

我正在使用记事本++；我复制了一个带有如下文本的编号列表

1.  文本
2.  文本
3.  文本 。. .
4.  文本

我想删除数字并只在每一行中留下文本......在记事本++中有没有快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:26:00.977

按 Shitf + Alt 键，然后您将能够从文本中选择任何部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:36:22.520

你也可以使用`Ctrl+alt`。按住 Ctrl + Alt 拖动数字，然后删除

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T21:52:06.460

在正则表达式模式下使用 Notepad++ 查找/替换：
`Find: \d+\. (.*)`
`Replace: $1`

# c - c中的动态char**数组

> ID：15853827
> 
> 赞同：0
> 
> 时间：2013-04-06T17:19:53.090
> 
> 标签：c, pointers, memory-management

我正在尝试执行 execv() 命令，第二个参数是要传递的参数列表。

我的论点目前以字符串格式保存，即

`--config=moo --console --something=moo2 --path="this can have spaces" --format=x`

我想做的是把它分成`char**`参数，即

```
argv[0] = "--config=moo"
argv[1] = "--console" 
```

我不太明白的是一件事（很抱歉，自从我上次使用 C 以来已经很长时间了）。如果我想构建一个字符串以放入这个 argv 数组中，我该怎么做，例如：-

```
char* argv[10];
char* myPath = getMyPath();
argv[0] = "--config=moo";
argv[1] = ... ... ... 
...
...
argv[10] = "--path=" + myPath; 
```

我相信这在 C 中是不允许的，因为我必须提前分配所有内存，所以通过将 argv 分配为 10 个元素，我不能再去单独定义每个元素.. 或者我可以吗？

我知道 + 修饰符在 C 中不起作用，但我不确定复制它需要什么函数（我意识到我可以使用 strcat 添加到现有定义的数组，但不认为这适用于新形成的阵列）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:22:43.900

`char buffer[N]`您可以 malloc 将使用 strcat() 的内存，或者您可以在堆栈上使用大于需要的内存。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

const char * someFunction();

int main(int argc, char ** argv) {

  const char[] path = "commandName";
  const char[] arg1 = "--config=moo";
  const char[] arg2 = "--console";
  const char[] arg3 = "--something=moo2";
  //arg4 is skiiped
  const char[] arg5 = "--format=x";

  const char * mypath = someFunction();
  const char[] pathprefix = "--path=";

  size_t pathprefixlength = strlen(pathprefix);
  size_t stringlength =  pathprefixlength + strlen(mypath);

  char * arg4 = (char *)malloc(stringlength + 1);

  strcpy(arg4, pathprefix);
  strcpy(arg4 +  pathprefixlength, mypath);

  arg4[stringlength] = '\0'; //null terminate
  char *argvec[7]; // array of pointers
  argvec[0] = path;
  argvec[1] = arg1;
  argvec[2] = arg2;
  argvec[3] = arg3;
  argvec[4] = arg4;
  argvec[5] = arg;
  argvec[6] = NULL;
  //do something with argvec;
  free(arg4);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:53:15.333

## 通用malloc

[man malloc](http://linux.die.net/man/3/malloc)可能会有所帮助。`malloc`占用`minimum`您需要的内存字节数（即`malloc`可以选择为您提供更多）。因此，如果您需要数组`10`中的元素，最好像您已经完成的那样`char`简单地分配。`char* argv[10]`但是，这会为 10 个`char*`尚未定义的容器创建一个容器。因此，对于每个`char*`，`argv[0]...argv[9]`您都可以准确定义其中的内容。例如，如果你想 malloc 一个大小为 200 的字符串 for `argv[0]`，你可以使用如下语句（注意，`200`可以保存在常量或变量中）：

```
argv[0] = malloc(200 * sizeof(char)); 
```

一般来说，`sizeof(char) == 1 byte`, 所以这个值可能会尝试获取 200 字节。但是，此时您可以`argv[0]`按您需要的任何方式进行修改（即`strncpy`、`strncat`等）。

现在，如果你不知道你可能有多少参数，你可以动态分配你的容器。因此`char* argv[10]`，您可以尝试分配一个`char** argv`. 为此，您将执行以下语句：

```
int SOME_SIZE = 1500 ; // Or some dynamic value read, etc.
char** argv = malloc(SOME_SIZE * sizeof(char*)); 
```

通常`sizeof(char*) == 4 bytes`在 32 位系统上（典型指针的大小）。现在你可以使用这块内存，`argv`，以与之前类似的方式。为了便于思考，`malloc`以这种方式使用可以让您执行相对等价的`char* argv[WITH_SOME_DYNAMIC_NUMBER]`. 因此，您可以按照我上面描述的类似方式操作这个新容器。

但是请记住，当您使用完由 创建的内存时`malloc`，您必须调用`free`，否则在程序终止之前它不会被释放。

## 你的问题

如果我正确理解了您的问题，则您有一个扁平的字符串，您想将其转换为`execve`. 我将制定一个简单的示例，试图解释可以做到这一点的众多方法中的一种。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
void someMethod()
{
  char* argv[10];
  char* path = getMyPath();

  // Notice - this is a little messy and can/should be encapsulated away in another
  // method for ease of use - this is to explicitly show, however, how this can work.
  argv[9] = malloc((strlen(path) + strlen("--path=") + 1) * sizeof(char));
  strncpy(argv[9], "--path=", strlen("--path="));
  argv[9][strlen("--path=")] = '\0'; // NULL-terminate since strncpy doesn't
  strncat(argv[9], path, strlen(path));

  // Do stuff with array
  printf("%s\n", argv[9]);

  // Technically, you should never get here if execve succeeds since it will blow this
  // entire program away (unless you are fork()'ing first)
  free(argv[9]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:46:34.373

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char* strcata(char* s1, char* s2){
    char *p;
    p=(char*)malloc(sizeof(char)*(strlen(s1)+strlen(s2)+1));
    if(p == NULL) return NULL;

    *p='\0';

    return strcat(strcat(p, s1), s2);
}

int main(int argc, char *argv[])
{
    char *p;

    p=strcata("--path=", ".:./bin");
    printf("%s\n", p);

   return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T17:50:04.807

您可以使用 malloc 进行动态内存分配

例如，假设我们有以下简单的结构：

```
struct myRecord {

 char firstName[60];

 char lastName[60];

 int employeeID;

 struct myRecord * nextRecord;

};

struct myRecord * headPtr; // point to first structure in the list
// This line allocates memory for the first record:
headPtr = (struct myRecord *)malloc(sizeof(myRecord)); 
```

# python - Python "a=ab" 和 "a-=b" 真的等价吗？

> ID：15853831
> 
> 赞同：3
> 
> 时间：2013-04-06T17:20:18.133
> 
> 标签：python

这似乎与我`a = a-b`不同`a -= b`，我不知道为什么。

代码：

```
cache = {}
def part(word):
    if word in cache:
        return cache[word]
    else:
        uniq = set(word)
        cache[word] = uniq
        return uniq

w1 = "dummy"
w2 = "funny"

# works
test = part(w1)
print(test)
test = test-part(w2)
print(test)
print(cache)

# dont't works
test = part(w1)
print(test)
test -= part(w2) # why it touches "cache"?
print(test)
print(cache) 
```

结果：

```
set(['y', 'm', 'u', 'd'])
set(['m', 'd'])
{'dummy': set(['y', 'm', 'u', 'd']), 'funny': set(['y', 'n', 'u', 'f'])}
set(['y', 'm', 'u', 'd'])
set(['d', 'm'])
{'dummy': set(['d', 'm']), 'funny': set(['y', 'n', 'u', 'f'])} 
```

如您所见，第三行和最后一行不同。为什么在第二种情况下变量“缓存”不同？`test -= part(w2)`不喜欢`test = test-part(w2)`吗？

**编辑 1** - 感谢您的回答，但为什么 var`cache`会发生变化？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T17:22:20.180

`a = a - b`是一个`a`用新对象替换的操作 - 的结果`a - b`。

`a -= b`是一种`a`就地操作并使用`b`.

在某些事情上，这两者是等价的，在其他事情上，它们不是。显而易见的情况是在不可变对象上，它们的行为相同。正如您所发现的，在可变对象上存在很大差异。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-06T17:23:38.387

是的，它们是不同的。比较以下内容：

```
>>> x = set([1,2,3])
>>> y = x
>>> y -= set([1])
>>> x
set([2, 3])

>>> map(id, (x, y))
[18641904, 18641904] 
```

和

```
>>> x = set([1,2,3])
>>> y = x
>>> y = y - set([1])
>>> x
set([1, 2, 3])

>>> map(id, (x, y))
[2774000, 21166000] 
```

换句话说，就地`y -= set(...)`变化。`y`由于两者`x`和都`y`引用同一个对象，因此它们都发生了变化。

另一方面，`y = y - set(...)`创建一个新对象，重新绑定`y`以引用这个新对象。`x`不受影响，因为它仍然指向旧对象。

# php - 将具有大量 jquery ajax 函数的 php 脚本的输出保存到新文件

> ID：15853840
> 
> 赞同：0
> 
> 时间：2013-04-06T17:20:42.357
> 
> 标签：php, jquery, ajax, ob-get-contents

我在 [http://www.seooutlook.info/Testing_only/seo_latest/](http://www.seooutlook.info/Testing_only/seo_latest/)有一个 php 脚本 （PLZ 仅使用 GOOGLE.COM 作为工作示例），其中包含大量 j 查询 Ajax 函数，一旦加载文档就会触发。

现在我想将文件的输出保存到一个新文件中。

我使用的代码是这个

```
file_put_contents("../site/$site_name", ob_get_contents()); 
```

但是文件的输出与完全执行时不同，它错过了 j 查询函数获取的所有内容。

任何帮助将不胜感激..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:36:20.293

PHP 在服务器端运行；JavaScript 在客户端运行。这意味着 PHP 已经在您的任何 JavaScript 功能运行之前运行。为了实现您的目标，您可能需要使用另一个 AJAX 调用并将文档发送到另一个可以为您编写的 PHP 文件。

# javascript - KnockoutJS - attr 绑定 $data 不起作用

> ID：15853844
> 
> 赞同：0
> 
> 时间：2013-04-06T17:20:59.473
> 
> 标签：javascript, knockout.js

我有这个：

```
<a href="javascript:void(0);" data-bind="attr: { onclick: 'CreateChatWindow(\'$data.peer\');'}" class="socialsChat"><img src="~/Content/Styles/Default/Images/Icons/chat.png"/></a> 
```

现在，输出如下所示：

```
<a href="javascript:void(0);" class="socialsChat" onclick="CreateChatWindow('$data.peer');"><img src="~/Content/Styles/Default/Images/Icons/chat.png"/></a> 
```

为什么没有`$data.peer`从我的模型中获得它的价值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:24:36.813

首先，为什么是“点击”？这应该是“点击”，至少我在最新版本中使用它。二、为什么要用\'？第三，将参数传递给 viewmodel 方法看起来像这样

```
data-bind="click: function() { CreateChatWindow($data); }" 
```

# php - 从文件中读取时间并在未来找到最近的时间

> ID：15853850
> 
> 赞同：0
> 
> 时间：2013-04-06T17:21:35.917
> 
> 标签：php, date, fgetcsv

我是 PHP 新手，现在有问题。我想制作一个包含一天巴士时间的文件，并希望向用户展示未来最近的巴士。每天只有15辆公共汽车，所以不会是一个大文件。我想过像这样保存文件：0120、0230、1020、1340 等等。我现在的想法是通过 fgetcsv 使用 for 循环从该文件中读取，并将所有时间存储在一个大于日期（“His”）的数组中。这将发生在控制器中。在我向用户显示输出的文件中，我将以大字体显示数组的第一个元素作为下一个总线，并以较小的字体显示接下来的 10 个元素。这行得通吗？我不确定我的时间格式。我可以将文本文件中的 0230 与 date() 的输出进行比较吗？

谢谢你的帮助！

编辑：根据下面的评论，我尝试了这个。根据我的理解，这应该在 while 循环的每次迭代中读取 csv 的一个元素，对吗？

```
<?php
$buses = 0;
$hoursMins = date("Gi");
$times = [];
if (($handle = fopen("1.csv", "r")) !== FALSE) 
{
    while (($element = fgetcsv($handle, 200, ",")) !== FALSE) 
    {
        if($hoursMins < $element)
        {
            $times = $element;
            echo $times[$buses++] . "<br />\n";
            $buses++;
        }

    }
    fclose($handle);
}
?> 
```

不过，这只是向我展示了 755。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:59:43.593

我建议改为使用`date("Gi")`. “G”表示没有前导零的小时的 24 小时格式。前导零会导致很多奇怪的问题，因为它们被认为是 base8 数值：

```
var_dump(0200); // int(128) 
```

虽然`date()`and`fgetcsv()`将返回字符串，但如果您曾经将这些值转换为数字类型，则不执行零填充字符串只能使您避免可能出现的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T17:34:40.443

是的你可以。要将当前时间以 24 小时格式获取为小时/分钟，只需使用以下内容：

```
$hoursMins = date('Gi'); 
```

如果您在下午 2:06 运行此语句，您将得到`1406`. 如果你在早上 7:15 运行它，你会得到`715`.

**完全披露**：我最初有格式字符串，`Hi`但正如**bparise**在另一个答案中正确解释的那样，`Gi`更好。

* * *

要读取像您这样的小文件，请使用该`file_get_contents`函数将整个文件吸入字符串：

```
$timesList = file_get_contents('1.csv'); 
```

从那里，您可以将其“分解”成一个数组：

```
$times = explode(',', $timesList); 
```

然后，您可以遍历数组并查找大于或等于当前时间的时间。至于当前时间，您可能会更好地使用另一个答案中提到`Gi`的通话格式，`date`因为如果小时小于上午 10 点，它不会有前导零。

# jsf - EJBException 后的 JSF 重定向

> ID：15853855
> 
> 赞同：0
> 
> 时间：2013-04-06T17:22:23.477
> 
> 标签：jsf, redirect, jpa

我将 JSF 与 JPA 一起使用。我的错误处理是由一个全局异常处理程序完成的，如果发生任何错误，它将被触发。在这个处理程序中，我只是重定向到我的 error.xhtml。

除了 JPA 处理程序之外，这工作正常。如果@EJB jpa 处理程序产生错误，在我的情况下，我将其视为 EJB 异常。在这种情况下，jsf 重定向不起作用。

```
FacesContext.getCurrentInstance().getExternalContext().redirect("/error/"); 
```

但我没有收到任何错误消息。我认为这与一些生命周期问题有关，但我不知道如何解决它。我只想用 jpa 和 jsf 实现全局错误处理，它总是在一个特定的错误页面结束:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T18:08:13.947

您是否使用一些 jsf 机制捕获异常？

如果是，那么 JSF 可能错过了那些 JPA 异常。您可以尝试通过 web.xml 捕获这些：

```
<error-page>
       <exception-type>javax.faces.application.ViewExpiredException</exception-type>
       <location>/error_redirect.html</location>
</error-page>

<error-page>
    <error-code>404</error-code>
    <location>/error_redirect.html</location>
</error-page>

<error-page>
    <error-code>500</error-code>
    <location>/error_redirect.html</location>
</error-page>

<error-page>
       <exception-type>java.lang.Exception</exception-type>
       <location>/error_redirect.html</location>
</error-page>

<error-page>
       <exception-type>java.lang.Throwable</exception-type>
       <location>/error_redirect.html</location>
</error-page> 
```

在“error_redirect.html”中，您可以重定向到“/faces/error.xhtml”或其他任何内容。

也许您也可以直接将这些条目指向“/error/”，但由于某种原因（我不记得）我使用了这个重定向 html :)

# ios - 如何在 iOS 应用程序的 Xcode 上为不同目标设置不同的启动图像？

> ID：15853860
> 
> 赞同：0
> 
> 时间：2013-04-06T17:22:53.913
> 
> 标签：ios, xcode

如何在 iOS 应用程序的 Xcode 上为不同目标设置不同的启动图像？

当我尝试为第二个目标执行此操作时，Xcode 将其重命名为 Default.png 并显示文件已存在的警告。

![在此处输入图像描述](https://i.stack.imgur.com/zgcNU.png)

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:35:56.993

您可以通过在 Info.plist 文件中将其分配为**UILaunchImageFile的值来为启动屏幕文件名设置不同的基本名称。**

[从App 相关资源](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html)的 Apple 文档中了解更多信息。

专门用于 4 英寸 iOS 设备（iPhone 5 和 iPod）

> 要为 iPhone 5 和 iPod touch（第 5 代）设备指定默认启动图像，请在文件名部分之后立即包含修饰符字符串 -568h。由于这些设备具有 Retina 显示屏，因此必须始终将 @2x 修饰符包含在设备的启动图像中。例如，设备的默认启动图像名称是 Default-568h@2x.png。（如果您的应用在其 Info.plist 文件中有 UILaunchImageFile 键，请将字符串的 Default 部分替换为您的自定义字符串。） -568h 修饰符应始终是列表中的第一个。

# screen-resolution - 批处理或 VBScript 检查 Windows 分辨率是否为宽屏

> ID：15853862
> 
> 赞同：2
> 
> 时间：2013-04-06T17:23:04.777
> 
> 标签：screen-resolution, widescreen

我正在尝试查找/编写一个脚本（现有脚本是一个批处理文件，尽管如果 VBS 我总是可以在批处理文件中调用它）可以检测当前屏幕分辨率是否为宽屏格式，以便我可以复制适当的背景图像到机器。我只发现了几篇具有相同代码的帖子，正如一个回复所说，您始终可以将图像设置为拉伸。但这意味着图像可能会失真（正如其他人所说的那样）。

[我从这篇文章](http://www.edugeek.net/forums/scripts/38928-vbs-detect-screen-resolution.html)中找到了以下 VBScript ，尽管它似乎只适用于 Windows XP（虽然我没有尝试过 Windows 7 32 位）。在 Windows 7 64 中，它只是与星号相呼应。

```
Set objWMIService = GetObject("Winmgmts:\\.\root\cimv2")
 Set colItems = objWMIService.ExecQuery("Select * From Win32_DesktopMonitor where DeviceID = 'DesktopMonitor1'",,0)
 For Each objItem in colItems
 intHorizontal = objItem.ScreenWidth
 intVertical = objItem.ScreenHeight
 Next 

msgbox intHorizontal & " * " & intVertical 
```

但即使我可以让这个脚本工作，我仍然必须有多个 IF 才能将水平和垂直与宽屏分辨率列表相匹配。除非有一个我可以使用的数学方程式（我确定有）。但无论如何，我需要一个适用于 XP 和 7（32 和 64）的脚本，或者如果需要，每个操作系统或体系结构都有两个脚本。

提前致谢，

布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-22T19:33:19.720

很抱歉耽搁了，我不经常来这里。我的最后一条评论是有效的答案/解决方案。

# sql - 获得最大的价格上涨

> ID：15853867
> 
> 赞同：0
> 
> 时间：2013-04-06T17:23:51.950
> 
> 标签：sql

我在弄清楚这一点时遇到了问题，我需要找到价格上涨百分比最大的商品。这是我的代码：

```
 Select
  q.Grocery_Item,
  TO_CHAR(q.Price_IN_2000, '$90.00') price_in_2000,
  TO_CHAR(q.Estimated_Price_In_2025, '$90.00') price_in_2025,
  TO_CHAR(w.MY_OUTPUT,'9,990') || '%' as My_Output
From
  GROCERY_PRICES q,
  (SELECT
     GROCERY_ITEM,
     (((Estimated_Price_In_2025-Price_IN_2000)/Price_IN_2000)*100) as MY_OUTPUT
   FROM
     GROCERY_PRICES
  ) w
Where
  q.GROCERY_ITEM = w.GROCERY_ITEM  and w.my_output in (select max(w.my_output) from GROCERY_PRICES group by grocery_item)
GROUP BY
 w.MY_OUTPUT, q.GROCERY_ITEM,  q.Price_IN_2000, q.Estimated_Price_In_2025 
```

我的输出是：

```
 GROCERY_ITEM                   PRICE_IN_2000 PRICE_IN_2025 MY_OUTPUT
------------------------------ ------------- ------------- ---------
B_001                            $0.80         $2.64          230%   
B_002                            $2.72         $7.36          171%   
M_004                            $2.70         $5.65          109%   
T_006                            $5.70         $6.65           17%   
R_003                            $4.00        $13.20          230%   
E_001                            $0.62         $1.78          187%   

 6 rows selected 
```

这基本上是我表中的所有数据

我需要得到的是：

```
GROCERY_ITEM                   PRICE_IN_2000 PRICE_IN_2025 MY_OUTPUT
------------------------------ ------------- ------------- ---------
B_001                            $0.80         $2.64          230%   
R_003                            $4.00        $13.20          230% 
```

抱歉，新来的，不知道如何格式化我的问题:(

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:42:04.853

像这样的东西：

```
with price_delta as (
  select grocery_item, 
         price_in_2000, 
         ESTIMATED_PRICE_IN_2025, 
         ((ESTIMATED_PRICE_IN_2025 - Price_IN_2000)/Price_IN_2000)*100 as delta,
         rank() over (order by ((ESTIMATED_PRICE_IN_2025 - Price_IN_2000)/Price_IN_2000)*100 desc) as rnk
  from grocery_prices
)
select grocery_item, 
       price_in_2000, 
       ESTIMATED_PRICE_IN_2025,
       delta
from price_delta
where rnk = 1; 
```

SQLFiddle（甲骨文）：[http ://sqlfiddle.com/#!4/43379/2](http://sqlfiddle.com/#!4/43379/2)

# entity-framework - 为什么实体框架会抛出“字符串或二进制数据将被截断”异常？

> ID：15853871
> 
> 赞同：2
> 
> 时间：2013-04-06T17:24:15.640
> 
> 标签：entity-framework, entity-framework-4.1

如果您查看下面的代码，您会发现我正在尝试以两种不同的方式将相同的数据添加到我的上下文中。一个——方法 A，我通常使用它没有问题——当我在我的上下文中调用 SaveChanges() 时不断抛出这个异常：

> 更新条目时出错。有关详细信息，请参阅内部异常。内部异常：字符串或二进制数据将被截断。该语句已终止。

我知道数据库字段的数据不会太长，因为方法 B 使用与方法 A 完全相同的数据，但由于显而易见的原因，它不是理想的插入方式，但工作正常。它们之间的唯一区别是，在方法 B 中，我在与 DbContext 对话的方法中创建实体类的新实例，并将传递给该方法的实体实例的属性值分配给它的属性。谁能解释可能发生的事情？

```
public class MyEntity
{
    public int Id { get; set; }
    public string Name { get; set; }
    public DateTime LiftOff { get; set; }
}

//**************************************
public class MyContext : DbContext
{
    public DbSet<MyEntity> MyEntities { get; set; }
}

//**********************************
public class EntityManager
{
    public MyEntity AddEntity(MyEntity entity)
    {
        // Method A: Throws exception:
        MyEntity e = null;
        using (MyContext context = new MyContext())
        {
            e = context.MyEntities.Add(entity);
            context.SaveChanges();
        }

        //Method B: Works fine:
        e = new MyEntity();
        e.Name = entity.Name;
        e.LiftOff = entity.LiftOff;
        using (MyContext context = new MyContext())
        {
            e = context.MyEntities.Add(e);
            context.SaveChanges();
        }

        return e;
    }
} 
```

感谢您提供的任何帮助/建议。

**编辑**：EntityManager.AddEntity() 方法 A 是否有效似乎取决于它的调用位置：添加患者（使用 NUnit）的自动化测试运行良好，但是当从 WinForms 应用程序程序集中调用该方法时，它不会不行。

# python - 使用 Scipy 进行图像腐蚀和膨胀

> ID：15853875
> 
> 赞同：13
> 
> 时间：2013-04-06T17:25:10.127
> 
> 标签：python, image, image-processing, scipy

我正在尝试使用 scipy 对图像进行[腐蚀](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.morphology.binary_erosion.html)和[膨胀](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.morphology.binary_dilation.html)。使用 scipy -> 似乎很简单`binary_erosion / dialation`。但是，输出完全不是预期的。

这是我的基本代码：

```
import scipy
from scipy import ndimage
import matplotlib.pyplot as plt
import numpy as np
import Image

#im = Image.open('flower.png')
im = ndimage.imread('flower.png')
im = ndimage.binary_erosion(im).astype(np.float32)
scipy.misc.imsave('erosion.png', im)

im2 = Image.open('flower.png')
im2 = ndimage.binary_dilation(im2)
scipy.misc.imsave('dilation.png', im2) 
```

这是输出：

![在此处输入图像描述](https://i.stack.imgur.com/8qlqi.png)

膨胀的输出只是原始“flower.png”的完全白色图像

我相信我必须指定一个更好的内核或掩码，但我不确定为什么我得到一个绿色输出来表示腐蚀，而完全白色输出表示膨胀。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-09T00:11:53.990

我使用的是二元腐蚀而不是[灰色腐蚀](http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.morphology.grey_erosion.html#scipy.ndimage.morphology.grey_erosion)数组。我使用`flatten=true`这样的方法将原始图像转换为灰度：

```
im = scipy.misc.imread('flower.png', flatten=True).astype(np.uint8) 
```

然后调用：

```
im1 = ndimage.grey_erosion(im, size=(15,15)) 
```

得到了一个很好的侵蚀图片，虽然它是灰度的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T14:09:43.410

您有两个问题：正如@theta 的评论中所指出的，二进制操作期望输入仅包含 0 和 1。第二个问题是`nd`in `ndimage`--- 您提供了一个 shape 数组`(nx, ny, 3)`。最后一个长度为 3 的轴被认为是第三个空间维度，而不是三个颜色通道。

# android - 滚动滚动视图时自动在滚动视图内滚动地图

> ID：15853877
> 
> 赞同：0
> 
> 时间：2013-04-06T17:25:25.787
> 
> 标签：android, android-mapview, android-scrollview

如何自动滚动像**Expedia Application**这样的滚动视图内的地图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-12T11:27:38.590

得到了解决方案。首先创建自定义滚动视图。将地图视图放在滚动视图中。然后在自定义滚动视图的 onScrollChanged 上，像滚动地图视图一样，

在 CustomScrollView.java 上：

```
protected void onScrollChanged(int l, int t, int oldl, int oldt) 
{
    super.onScrollChanged(l, t, oldl, oldt);
    scrollMap(l,t);
} 
```

在 YourActivity.java 上：

```
public void scrollMap(int x, int y)
{
    int scrollLength = scrollView.getMeasuredHeight();
    int mapViewHeight = mapView.getMeasuredHeight();

    int mapViewCenter = (int)(mapViewHeight/2);
    int scrollMapHeight = (mapViewCenter + ((int)((mapViewHeight*y)/scrollLength)));

    scrollMapHeight = (int)((mapViewCenter - scrollMapHeight)/(1.5));

    if(scrollMapHeight<0)           
    mapView.scrollTo(x, scrollMapHeight);       
} 
```

# android - 我应该使用 Android 菜单吗？

> ID：15853887
> 
> 赞同：0
> 
> 时间：2013-04-06T17:26:16.163
> 
> 标签：android, android-layout

我最近才开始学习安卓。我正在为自己制作一个项目应用程序，以跟踪我从事的自由职业项目，并且进展顺利。虽然现在我有点想知道是否应该使用 Android Menu 标签进行导航。

这是应用程序的快速模型： ![在此处输入图像描述](https://i.stack.imgur.com/mXIu7.jpg)

如您所见，我正在使用应用左侧的导航栏。我的顶部没有导航栏。通过选择左边的一项，右边的内容应该改变在框架布局中使用的片段。我有片段和框架布局，其中有片段，但现在我想知道我应该如何处理导航（以便将导航项放在该片段中）。我应该使用列表视图（并使用 ListFragment）、仅使用按钮还是应该使用 Android SDK 附带的菜单来执行此操作？如果它与菜单布局一起使用，我可以设计出足够的样式来获得我想要的设计吗？

希望可以有人帮帮我 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:05:39.733

对于平板电脑和手机布局，您需要具有不同导航的不同布局。

对于平板电脑版本，我建议您使用自定义按钮（例如`ImageButton`），并使用 OnClickListeners 更改您的 Fragment 内容。

对于手机版本，您可以使用 Android 的操作栏。您可以像在草图中那样使用它进行下拉导航。
[http://developer.android.com/design/patterns/actionbar.html](http://developer.android.com/design/patterns/actionbar.html)

我认为您不想为导航实现菜单。它通常用于设置或一些更隐藏的操作。您的导航对用户来说应该是显而易见的并且不言自明。
[http://developer.android.com/guide/topics/ui/menus.html](http://developer.android.com/guide/topics/ui/menus.html)

# tcp - 基本的 Send() 和 Recv() TCP 服务器和客户端 C++

> ID：15853889
> 
> 赞同：-1
> 
> 时间：2013-04-06T17:26:27.193
> 
> 标签：tcp, send, sendmessage, recv

仍在尝试理解 send() 和 recv() 函数。为什么这不起作用？服务器输出上没有打印任何内容。（除了一些测试“cout”）

这基本上是我正在搞乱的代码的一部分。

**客户端：**

```
char *mesg_to_send;   
Socket servSock;
mesg_to_send = The King is Dead!";
// Establish the connection to the echo server 
if(connect(servSock, (struct sockaddr *) &srvr_addr, sizeof(srvr_addr)) < 0)  
  DieWithError("connect() failed");
send(servSock, (char*) mesg_to_send, sizeof(int), 0); 
```

**服务器端：**

```
char *sentence;
Socket clnt_socket;
// Wait for the client to connect
if((clnt_socket = accept(srvr_socket, (struct sockaddr *) &clnt_addr, &addr_len)) < 0)
  DieWithError("accept() failed");
recv(clnt_socket, (char*) sentence, sizeof(int), 0);
cout << sentence; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T19:59:49.337

马上，您的代码中有几个问题，除了语法错误（您的意思是在前面有一个开头引号`The King`吗？）。[您是否真的编译和测试了您发布的相同代码？](http://sscce.org/)

*   您只发送第一个`sizeof(int)`字节，而不是发送整个句子。由于`sizeof(int)`在您的平台上可能是 4，这意味着您可能只发送“The”。

*   同样，您只是`sizeof(int)`从服务器上的客户端读取字节。相反，您可能希望读入更大的缓冲区，并在客户端发送数据时一直循环读取（即，只要您不读取 EOF）。

*   什么数据类型`Socket`？套接字文件描述符应该保存在类型变量中`int`。

*   在服务器端，您不需要初始化`sentence`缓冲区。在您将它传递给 时`recv`，它是一个未初始化的指针，可能指向随机内存。

*   您也可能没有`addr_len`在服务器上初始化（它应该`sizeof(clnt_addr)`在调用之前初始化`recv`）。

# python - Python - 在不阻止客户端连接到服务器的情况下，无法在 Tornado 中运行计时器

> ID：15853891
> 
> 赞同：4
> 
> 时间：2013-04-06T17:26:46.223
> 
> 标签：python, timer, tornado, countdown

在 Tornado 中不是很有经验，如果这听起来像一个新手问题，很抱歉。

我正在使用标准 html/js 代码和服务器上的龙卷风与客户端构建纸牌游戏。一切正常，但是我需要在服务器上实现倒计时，在一定时间后运行特定代码。我正在使用以下 python 代码并在发出请求后从龙卷风中调用它

```
import time

class StartTimer(object):

    timerSeconds = 0

    def __init__(self):

        print "start timer initiated"
    def initiateTime(self, countDownSeconds):
        self.timerSeconds = countDownSeconds

        while self.timerSeconds >= 0:
            time.sleep(1)
            print self.timerSeconds
            self.timerSeconds -=1

            if self.timerSeconds == 0:
                #countdown finishes
                print "timer finished run the code"

    def getTimer(self):

        return self.timerSeconds 
```

倒计时工作正常但是我首先有两个问题，而计时器正在倒计时服务器阻止任何其他连接并将它们放入队列并在计时器完成后运行代码其次，我需要 getTimer 函数来工作所以一个新的进来的客户知道还剩多少时间（基本上是获取 timerSeconds 值）。我可以避免计时器不向用户显示，但是代码被阻止的事实绝对不好。

请帮忙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T18:56:08.120

`time.sleep()`将阻止，`add_timeout()`改用检查[这里](http://www.tornadoweb.org/en/stable/ioloop.html?highlight=time#tornado.ioloop.IOLoop.add_timeout)

编辑：抱歉，@Armin Rigo 已回答

这是[一个例子](https://groups.google.com/group/python-tornado/browse_thread/thread/ae9b7527bf3d8948/ceeb64cfd39b0c1f?lnk=gst&q=how%20to%20make%20a%20periodic%20post%20after%20X%20seconds#ceeb64cfd39b0c1f)：

```
import time
import tornado.ioloop

def delayed_print(s):
    if len(s) == 0:
        ioloop.stop()
    else:
        print s[0]
        ioloop.add_timeout(time.time() + 1, lambda:delayed_print(s[1:]))

ioloop = tornado.ioloop.IOLoop()
delayed_print('hello world')
ioloop.start() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-21T07:56:37.683

[IOLoop.call_later](http://tornado.readthedocs.org/en/latest/ioloop.html#tornado.ioloop.IOLoop.call_later)从 Tornado 4.0 开始会更方便。对于相对情况，因为它不需要 timedelta 对象。

# xcode - Mac 上 libstdc++ 中的 C++11 标准库

> ID：15853893
> 
> 赞同：1
> 
> 时间：2013-04-06T17:27:00.090
> 
> 标签：xcode, macos, clang, libstdc++, libc++

在我目前从事的 Xcode 项目中，我使用 C++11 和 Apple LLVM 4.2 (clang) 编译器，并使用 libstdc++ 作为我的标准库，因为我使用的库 (NTL) 不是用 libc++ 编译的，并且所以我必须使用 libstdc++。

编写以下代码时：

```
#include <regex>
int main()
{
     return 0;
} 
```

它不编译，说：

`'regex' file not found`

所以我不能在我的 libstdc++ 中使用任何 C++11 库（也试过了`<mutex>`）`<thread>`。

我尝试采用的另一个方法是`NTL`使用 cc 和 libc++ 重新编译，但这似乎没什么用。以下是产生的一些错误：

```
../include/NTL/config.h:57:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:88:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:95:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:112:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:120:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:143:7: error: expected value in expression
#elif 
      ^
../include/NTL/config.h:168:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:189:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:208:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:226:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:248:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:260:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:273:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:289:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:309:5: error: expected value in expression
#if 
    ^
../include/NTL/config.h:326:7: error: expected value in expression
#elif 
      ^
In file included from FFT.c:3:
In file included from ../include/NTL/FFT.h:6:
In file included from ../include/NTL/ZZ.h:19:
../include/NTL/tools.h:21:10: fatal error: 'iostream.h' file not found` 
```

似乎配置标头以某种方式“损坏”并且 libc++ 没有`<iostream.h>`旧的 c++ 标头。因此，重新编译`NTL`对我来说有点麻烦。

那么，我该如何解决呢？如何在我的项目中仍然使用 libstdc++ 并拥有 C++11 库？如果这有帮助，我已经用 brew 安装了 g++-4.8。有没有办法将clang使用的libstdc++映射到新的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T21:37:00.930

您需要告诉您的 clang 副本如何找到您想要使用的 libstdc++ 标头。显然它没有找到它们。我认为你想要的标志是`"-nostdinc -I /path/to/better/headers"`.

第一部分告诉 clang 不要使用它的标准标题，第二部分告诉它在“那边”寻找标题。

# sqlite - 计算数据库sqlite中的表数

> ID：15853897
> 
> 赞同：0
> 
> 时间：2013-04-06T17:27:17.263
> 
> 标签：sqlite

我找不到用 JAVA 计算数据库中的表数和要滚动的系统的方法。

我有一个大小为 100000 列 x 100 行的矩阵 M，出于各种原因，我不得不在多个表上拆分数据库的复制，我会在这里解释。现在我必须读取数据库以重新加载矩阵 M2，其中 M2 = M，M 的全部内容但不知道该怎么做，因为我找不到一种方法来计算构成数据库的表数M. 我发现了这个话题：

[统计sqlite数据库中的表数](https://stackoverflow.com/questions/11506527/count-the-number-of-tables-in-the-sqlite-database)

但我找不到“光标”和“getReadableDatabase”。我在哪里可以下载最新版本的 SQLite for java？我正在使用以下版本：

“sqlite-jdbc-3.7.15-SNAPSHOT-2.jar”

* * *

如果我写：

```
int numero_tabelle = 0;
        try {
            Class.forName("org.sqlite.JDBC").getInterfaces();
            String nome = "jdbc:sqlite:" + nome_database;
            Connection conn = DriverManager.getConnection(nome);
            Statement stat = conn.createStatement();
            ResultSet rs = stat.executeQuery("SELECT COUNT(*) FROM sqlite_master WHERE type = 'table'"); 
            //ResultSet rs = stat.executeQuery("SELECT * FROM sqlite_master WHERE type = 'table'");
            numero_tabelle = rs.getInt("sqlite_master");
            conn.close();
            rs.close();
        } catch (ClassNotFoundException a) {
            System.out.println("Manca la libreria SQLITE.");
        } catch (SQLException b) {
            System.out.println(nome_database + " inesistente.");
            System.out.println("E' anche possibile "
                    + "che le risorse hardware siano insufficienti.");
        }
        System.out.println("Number of tables: " + numero_tabelle); 
```

我得到：

```
SuperM.sqlite inesistente.
E' anche possibile che le risorse hardware siano insufficienti.
Number of tables: 0 
```

:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-01-05T13:05:44.487

使用以下查询来实现您的目标，

```
SELECT count(*) FROM sqlite_master WHERE type = 'table' AND name != 'android_metadata' AND name != 'sqlite_sequence'; 
```

它将返回表的计数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T08:44:04.087

SQLite 有一个系统表[sqlite_master](http://www.sqlite.org/fileformat2.html#sqlite_master)，其中包含每个数据库对象的记录。

要获取表的数量，请执行如下查询：

```
rs = stat.executeQuery("SELECT * FROM sqlite_master WHERE type = 'table'"); 
```

这将为每个表返回一条记录。

或者，执行如下查询：

```
rs = stat.executeQuery("SELECT COUNT(*) FROM sqlite_master WHERE type = 'table'");
int tableCount = rs.getInt(1); 
```

这将返回一条包含表数的记录。

# html - 在 DIV 中设置 SPAN 样式

> ID：15853899
> 
> 赞同：7
> 
> 时间：2013-04-06T17:27:23.620
> 
> 标签：html, css

假设我有以下内容：

```
<DIV class="msg-warn">
 <SPAN>some message</SPAN>
</DIV> 
```

我想在as上的类中添加一个`background-color`以继承所述背景颜色。我无法将课程应用于.`msg-warn``DIV``SPAN``SPAN`

我怎样才能做到这一点？（请不要使用javascript，只需CSS）

**编辑**：我发现`DIV`继承的东西使它的高度为 1px...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-06T17:28:45.600

`.msg-warn`如果您想为*整个类*设置样式并使其继承，只需将其添加到。

```
.msg-warn {
    background-color:#F00;
} 
```

如果你想在 .msg-warn 目标中设置*所有s 的样式，如下所示：* `<span>`

```
.msg-warn span {
    background-color:#F00;
} 
```

如果要设置*所有直系后代* `<span>`的样式（直接子代，而不是子代的子代），请使用`>`

```
.msg-warn > span {
    background-color:#F00;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-06T17:28:49.723

您是否尝试过类似以下的方法？

```
div.msg-warn > span {
   background-color: #f00;
} 
```

# java - 比较2个字符串数组Java的索引

> ID：15853900
> 
> 赞同：0
> 
> 时间：2013-04-06T17:27:25.700
> 
> 标签：java, arrays, string

我试图弄清楚如何引用 2 个字符串数组的索引。在 checkAnswer 方法中，我可以确认用户输入存储在索引 [i] 处的 capitalArray 但如何比较 capitalArray[i] == stateArray[i] 的索引而不是比较存储在索引 [i] 处的字符串

```
 public static void main{ 
        ...

        for (int i = 1; i <=10;  i++){

        System.out.println("What is the capital of " + stateArray[randomQuestion(0)]"?");
        answer = in.nextLine();

        if (checkAnswer(stateArray, capitalArray, answer) == true)
        {
            correct++;
        }
        total = i;
    }
  }

   public static boolean checkAnswer(String[]stateArray, String[]capitalArray, String answer) {

    for (int i = 0; i < stateArray.length; i++) 
    {
        if (capitalArray[i].equalsIgnoreCase(answer) && capitalArray[i] == stateArray[i])    
        {
            return true;
        }
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:35:54.477

只需使用 Hashmap 来存储资本和状态。您通过使用 2 个数组使其变得复杂。Hashmap 可以将 state 作为 key，将 capital 作为 vaule，现在您可以轻松地进行迭代和检查。

编辑：

当您知道 capital 和 state 将处于相同索引时，那么通过比较 2 个数组的索引您将获得什么？一旦你在资本阵列中拥有了喜欢的资本，你就完成了。无需检查状态数组。

但我不会推荐数组方法。

编辑：

在开始 for 循环之前检查两个数组是否具有相同的长度就足够了，如果您想要进行验证

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T18:04:02.213

您应该确定要使用的随机状态，保留该索引，然后`capitalArray`根据同一索引中的 来检查用户的输入。检查答案时无需遍历两个数组。

像这样的东西：

```
index = Random.nextInt(50);  // random number between 0-49

System.out.println("Enter the capital for " + states[index] + ":");
String answer = in.nextLine();

//Precondition: the arrays for the capitals and state must be in the correct order for
//this to work properly
if ( capitals[index].equalsIgnoreCase( answer ) )
{
    return true;
}
else
{
    return false;
} 
```

您拥有的`checkAnswer`功能是比较然后查看是否`answer`和是相同的字符串。当然后者不是真的。`capitalArray``capitalArray[i]``stateArray[i]`

# objective-c - 使用 NSWindowController 加载 NIB 文件但窗口不可见

> ID：15853901
> 
> 赞同：1
> 
> 时间：2013-04-06T17:27:27.057
> 
> 标签：objective-c, macos, nswindowcontroller

使用 NSWindowController 加载 NIB 文件可以工作，但是当窗口加载时它会显示并立即隐藏。发生什么事？我不知道。这是我的代码：

```
- (IBAction)loadMyWindow:(id)sender
{
    NSWindowController * windowController;

    if (windowController == nil) {
        windowController = [[NSWindowController alloc] initWithWindowNibName:@"myWindow"];
       [windowController window];
    }
} 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-09T10:59:36.157

在使用 ARC 的项目中，我们必须`windowController`在方法之外声明一个变量`loadMyWindow`

```
NSWindowController *windowController; //for example here

- (IBAction)loadMyWindow:(id)sender
{
    if (windowController == nil) {
        windowController = [[NSWindowController alloc] initWithWindowNibName:@"myWindow"];
       [windowController window];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T18:10:32.210

只需添加行`[windowController showWindow:self]`

# javascript - 如何更改 jQuery 代码以仅允许 jpg 文件

> ID：15853905
> 
> 赞同：0
> 
> 时间：2013-04-06T17:27:46.607
> 
> 标签：javascript, jquery

我有一个允许用户上传图像的 jQuery 函数。诚然，我对 jQuery 知之甚少，但我需要能够稍微更改此代码。目前，如果使用不是图像的文件，它会抛出错误，但我希望它抛出错误是该文件不是 jpg、JPG、jpeg 或 JPEG。

我不确定需要多少原始代码，但这是进行过滤的部分。

```
 $(document).ready(function() {

    // Makes sure the dataTransfer information is sent when we
    // Drop the item in the drop box.
    jQuery.event.props.push('dataTransfer');

    var z = -40;
    // The number of images to display
    var maxFiles = 5;
    var errMessage = 0;

    // Get all of the data URIs and put them in an array
    var dataArray = [];

    // Bind the drop event to the dropzone.
    $('#drop-files').bind('drop', function(e) {

        // Stop the default action, which is to redirect the page
        // To the dropped file

        var files = e.dataTransfer.files;
        var ext = $('#drop-files').val().split('.').pop().toLowerCase();

        // Show the upload holder
        $('#uploaded-holder').show();

        // For each file
        $.each(files, function(index, file) {
            // Some error messaging
            if (!files[index].type.match('image.*')) {

                if(errMessage == 0) {
                    $('#drop-files').html('Only jpg files are allowed');

                }

                return false;
            }

            // Check length of the total image elements

            if($('#dropped-files > .image').length < maxFiles) {
                // Change position of the upload button so it is centered
                var imageWidths = ((220 + (40 * $('#dropped-files > .image').length)) / 2) - 20;
                $('#upload-button').css({'left' : imageWidths+'px', 'display' : 'block'});
            }

            // Start a new instance of FileReader
            var fileReader = new FileReader();

                // When the filereader loads initiate a function
                fileReader.onload = (function(file) {

                    return function(e) { 

                        // Push the data URI into an array
                        dataArray.push({name : file.name, value : this.result});

                        // Move each image 40 more pixels across
                        z = z+40;
                        var image = this.result;

                        // Just some grammatical adjustments
                        if(dataArray.length == 1) {
                            $('#upload-button span').html("1 file to be uploaded");
                        } else {
                            $('#upload-button span').html(dataArray.length+" files to be uploaded");
                        }
                        // Place extra files in a list
                        if($('#dropped-files > .image').length < maxFiles) { 
                            // Place the image inside the dropzone
                            $('#dropped-files').append('<div class="image" style="left: '+z+'px; background: url('+image+'); background-size: cover;"> </div>'); 
                        }
                        else {

                            $('#extra-files .number').html('+'+($('#file-list li').length + 1));
                            // Show the extra files dialogue
                            $('#extra-files').show();

                            // Start adding the file name to the file list
                            $('#extra-files #file-list ul').append('<li>'+file.name+'</li>');

                        }
                    }; 

                })(files[index]);

            // For data URI purposes
            fileReader.readAsDataURL(file);

        });

    });

    function restartFiles() {

        // This is to set the loading bar back to its default state
        $('#loading-bar .loading-color').css({'width' : '0%'});
        $('#loading').css({'display' : 'none'});
        $('#loading-content').html(' ');
        // --------------------------------------------------------

        // We need to remove all the images and li elements as
        // appropriate. We'll also make the upload button disappear

        $('#upload-button').hide();
        $('#dropped-files > .image').remove();
        $('#extra-files #file-list li').remove();
        $('#extra-files').hide();
        $('#uploaded-holder').hide();

        // And finally, empty the array/set z to -40
        dataArray.length = 0;
        z = -40;

        return false;
    }

    $('#upload-button .upload').click(function() {

        $("#loading").show();
        var totalPercent = 100 / dataArray.length;
        var x = 0;
        var y = 0;

        $('#loading-content').html('Uploading '+dataArray[0].name);

        $.each(dataArray, function(index, file) {   

            $.post('upload.php', dataArray[index], function(data) {

                var fileName = dataArray[index].name;
                ++x;

                // Change the bar to represent how much has loaded
                $('#loading-bar .loading-color').css({'width' : totalPercent*(x)+'%'});

                if(totalPercent*(x) == 100) {
                    // Show the upload is complete
                    $('#loading-content').html('Uploading Complete!');
                    window.location = "http://www.dentaldigs.co.uk/upload_success.php";

                    // Reset everything when the loading is completed
                    setTimeout(restartFiles, 500);

                } else if(totalPercent*(x) < 100) {

                    // Show that the files are uploading
                    $('#loading-content').html('Uploading '+fileName);

                }

                // Show a message showing the file URL.
                var dataSplit = data.split(':');
                if(dataSplit[1] == 'upload successful') {
                    var realData = '<li><a href="images/'+dataSplit[0]+'">'+fileName+'</a> '+dataSplit[1]+'</li>';

                    $('#uploaded-files').append('<li><a href="images/'+dataSplit[0]+'">'+fileName+'</a> '+dataSplit[1]+'</li>');

                    // Add things to local storage 
                    if(window.localStorage.length == 0) {
                        y = 0;
                    } else {
                        y = window.localStorage.length;
                    }

                    window.localStorage.setItem(y, realData);

                } else {
                    $('#uploaded-files').append('<li><a href="images/'+data+'. File Name: '+dataArray[index].name+'</li>');
                }

            });
        });

        return false;
    });

    // Just some styling for the drop file container.
    $('#drop-files').bind('dragenter', function() {
        $(this).css({'box-shadow' : 'inset 0px 0px 20px rgba(0, 0, 0, 0.1)', 'border' : '4px dashed #B3C234'});
        return false;
    });

    $('#drop-files').bind('drop', function() {
        $(this).css({'box-shadow' : 'none', 'border' : '4px dashed rgba(0, 0, 0, 0.1)'});
        return false;
    });

    // Let them know that they aren’t in the correct dragenter zone
    $('#drop-files').bind('dragleave', function() {
    $(this).css({'box-shadow' : 'none', 'border' : '4px dashed rgba(0,0,0,0.2)'});
    return false;
    });

    // For the file list
    $('#extra-files .number').toggle(function() {
        $('#file-list').show();
    }, function() {
        $('#file-list').hide();
    });

    $('#dropped-files #upload-button .delete').click(restartFiles);

    // Append the localstorage the the uploaded files section
    if(window.localStorage.length > 0) {
        $('#uploaded-files').show();
        for (var t = 0; t < window.localStorage.length; t++) {
            var key = window.localStorage.key(t);
            var value = window.localStorage[key];
            // Append the list items
            if(value != undefined || value != '') {
                $('#uploaded-files').append(value);
            }
        }
    } else {
        $('#uploaded-files').hide();
    }
}); 
```

目前这将允许任何图像类型，我需要它只允许 jpg、JPG、jpeg 和 JPEG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:49:41.257

更改此行：

```
if (!files[index].type.match('image.*')) { 
```

进入这个：

```
if (!(files[index].type.match("image.*") && files[index].name.match(/\.(jpg|jpeg)$/i) ) ) { 
```

然后它应该工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T18:04:44.270

从文件数组中删除不需要的文件怎么样？

```
if (!files[index].type.match('image.*')) {

            if(errMessage == 0) {
                $('#drop-files').html('Only jpg files are allowed');

            }

            return false;
        }
        /* Remove file from the array if it doesnt match jpg | jpeg */
        else if ((files[index].name.match(/.+(jpg|jpeg)$/)){
            files.splice(index, 1);
            return;
        }
       .... 
```

如果文件不在文件列表中，则不会被读取/上传

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:35:59.153

也许尝试正则表达式？

```
 $.each(files, function(index, file) {
            // Some error messaging
            if (!files[index].type.match('image.*')) {
                    errMessage = 1;
                    var pattern = /(\.(?:jpg|jpeg|JPG|JPEG))$/gm;

                    if (!file.name.match(pattern)){
                    errMessage = 0
                    }
                if(errMessage == 0) {
                    $('#drop-files').html('Only jpg files are allowed');

                }

                return false;
            }
} 
```

编辑：代码未经测试。但希望能说明我的意思。还假设您在“文件”中获取文件对象

# javascript - 如何使 .click 在 jquery 中执行两个功能？

> ID：15853907
> 
> 赞同：0
> 
> 时间：2013-04-06T17:27:50.377
> 
> 标签：javascript, jquery

我是 jQuery 和 JaVascript 的超级新手，我喜欢它，但我遇到了问题，，，

我有一个名为 button1 的元素，我想让另一个名为 bubble1 的元素在单击一次时消失，并在再次单击时重新出现。

我试过了，但没有用

```
$(document).ready(function(){
    $('#button_1').click(function (){
        $('#bubble1').css('visibility','hidden');
        $('#button_1').click (function(){
            $('#bubble1'.css('visibility'.'visible');
        });
    });
}); 
```

这第二个有效，但对象消失并一键重新出现。

```
$(document).ready(function (){
    $('#button_1').click(function (){
        $('#bubble1').fadeOut();
    });
});
$('#button_1').click(function (){
    $('#bubble1').fadeIn();
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T17:28:51.017

你不应该重新绑定`click`事件，你可以使用[`toggle()`](http://api.jquery.com/toggle/)or [`fadeToggle()`](http://api.jquery.com/fadeToggle/)：

```
$("#button_1").click(function() {
    $("#bubble1").fadeToggle();
}); 
```

**演示：http:** [//jsfiddle.net/E9PRa/](http://jsfiddle.net/E9PRa/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:29:05.520

您可以使用[切换](http://api.jquery.com/toggle/)而不是单击。

**[现场演示](http://jsfiddle.net/emLfR/)**

```
$('#button_1').click(function (){
   $('#bubble1').toggle();
}); 
```

您正在绑定单击两次，您可以设置条件并绑定两次将导致双重动作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:32:35.233

先前答案中的切换效果很好，并且是大多数人会做的。如果你想要一些明确的东西来做同样的事情，并允许你根据其他元素的状态做更多的事情：

```
$("#button_1").click(function() {
    if ($("#bubble1").is(':visible')) 
       $('#bubble1').fadeOut();
    else
       $('#bubble1').fadeIn();
}); 
```

# java - 删除偶数长度

> ID：15853924
> 
> 赞同：1
> 
> 时间：2013-04-06T17:29:15.040
> 
> 标签：java

编写一个方法 removeEvenLength，它以字符串的 ArrayList 作为参数，并从列表中删除所有偶数长度的字符串。

```
public void removeEvenLength(ArrayList <String> stringList){
    for(int i=0;i<stringList.size();i++){
        String word=stringList.get(i);
        if(word.length()%2==0){//even
            stringList.remove(word);//if it is even,test from the first word  then continue looping

        }

    }
} 
```

当我尝试传入 ["This", "is", "a", "test"] 时，它应该返回我 a。但它给我的是，a。它有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T17:30:32.280

提示：您正在迭代期间从列表中删除当前项目。想想这可能对随后的迭代产生什么影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:43:20.533

在循环遍历列表时从列表中删除项目时使用迭代器。它会为你处理这个问题。

```
public void removeEvenLength( List<String> stringList ) {
    Iterator<String> iterator = stringList.iterator();
    while( iterator.hasNext() ) {
        final String word = iterator.next();
        if( word.length() % 2 == 0 ) {
            iterator.remove();
        }
    }
} 
```

更好的方法是创建一个包含所有奇数长度值的新列表。这样您就不会修改原始列表。一般来说，没有副作用的功能越多越好。

```
public List<String> removeEvenLength( List<String> stringList ) {
    List<String> oddList = new ArrayList<String>();
    for( String word : stringList ) {
        if( word.length % 2 == 1 ) {
            oddList.add( word );
        }
    }
    return oddList;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-26T07:22:49.447

这些答案似乎都那么复杂……

每当您需要修改列表中的元素数量时，为了避免影响尚未测试的元素的索引，您应该反向遍历列表。

```
 public static void removeEvenLength(ArrayList<String> arr){
        for(int i=arr.size()-1; i>=0; i--)
            if(arr.get(i).length() % 2 == 0)
                arr.remove(i);
    } 
```

无需创建列表的副本，或以任何方式更改 for 循环计数器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T17:40:06.897

你能试试下面的吗？这个对我有用

```
import java.util.*;

class Fun
{
    public static void removeEvenLength(ArrayList <String> stringList){
        for(int i=0;i<stringList.size();i++){
            String word=stringList.get(i);
            if(word.length()%2==0){//even
                stringList.remove(word);//if it is
                i = i-1;
                continue;
            }
        }

        for(int i=0;i<stringList.size();i++){
            String word=stringList.get(i);
            System.out.println(word);
        }
    }

public static void main(String []args)
{
    ArrayList <String> stringList = new ArrayList <String>();
    stringList.add("this");
    stringList.add("is");
    stringList.add("a");
    stringList.add("test");
    removeEvenLength(stringList);
} 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-22T03:51:21.020

这是我这样做的方式:)

```
public static void removeEvenLength(ArrayList<String> l){

    ArrayList<String> temp = new ArrayList<>();
    for(String word : l){

        if(word.length()%2==0){temp.add(word);}

    }

    l.removeAll(temp);

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-09T17:51:03.583

在 Java 8 中，您可以使用 removeIf(predicate) 从 Collection 中删除元素，而无需手动创建 Iterator：

 `````
Set<String> set = new HashSet<String>(Arrays.asList("1234","wsxw","qaz","qwertyui","q","qwe","qwerty","qwqw"));
set.removeIf(p -> p.length() %2 == 0); 
````  `* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-04-06T17:39:12.407

```
public static void removeEvenLength(ArrayList <String> stringList){
        for(int i=0;i<stringList.size();i++){
            String word=stringList.get(i);
            System.out.println(word+" "+word.length()+" "+word.length()%2);
            if(word.length()%2==0){//even
                System.out.println("Rmoving "+word);
                stringList.remove(word);
                removeEvenLength(stringList);//Recursive call
            }
        }
    } 
```

使用递归调用函数。``

# jquery - 使用 jquery 排序数据来自 Mysql 查询 PHP

> ID：15853925
> 
> 赞同：0
> 
> 时间：2013-04-06T17:29:17.150
> 
> 标签：jquery, sorting, html

我想知道如何使用 Jquery 或 AJAX（我是新手）根据年份对这些 div 进行排序，我有这个模式：

```
 <div class="content">
       <h1 class="year"><a name='2012'>2012</a></h1>
           <ul>
              <li>

              </li>

          </ul>
  </div>
  <div class="content">
       <h1 class="year"><a name='2011'>2011</a></h1>
            <ul>

             <li>

             </li>
           </ul>
 </div>
 <div class="content">
      <h1 class="year"><a name='2010'>2010</a></h1>
            <ul>
             <li>

            </li>

           </ul>
 </div> 
```

我想排序以获得：

```
 <div class="content">
           <h1 class="year"><a name='2010'>2010</a></h1>...............
     <div class="content">
          <h1 class="year"><a name='2011'>2011</a></h1>................ 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T19:00:13.203

我终于用 JQuery 找到了：

```
$('div.content').each(function() {
    $(this).prependTo(this.parentNode);
}); 
```

# c# - 在 Gridview 中显示图像 - BLOB 类型 - Oracle 11g Apex

> ID：15853927
> 
> 赞同：0
> 
> 时间：2013-04-06T17:29:20.610
> 
> 标签：c#, asp.net, visual-studio-2010, oracle

System.Data.OleDb.OleDbException：处理命令时出现一个或多个错误。ORA-00936: 缺少表达式

这是我得到的错误。有什么建议么？

我的 ashx 处理程序代码是：

```
 public class Handler1 : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        OracleConnection conn = new OracleConnection("Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=localhost)(PORT=1521)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVER_NAME=XE)));User Id=sakthi_studdb;Password=sakthi;");
        OracleCommand cmd = new OracleCommand();
        cmd.CommandText = "Select IMG_NAME, IMG_IMAGE from MYIMGTABLE where IMG_ID =:IMG_ID";
        cmd.CommandType = System.Data.CommandType.Text;
        cmd.Connection = conn;

        OracleParameter ImageID = new OracleParameter(":IMG_ID",OracleDbType.Int32);
        ImageID.Value = context.Request.QueryString["IMG_ID"];
        cmd.Parameters.Add(ImageID);
        conn.Open();
        OracleDataReader dReader = cmd.ExecuteReader();
        dReader.Read();
        context.Response.BinaryWrite((byte[])dReader["IMG_IMAGE"]);
        dReader.Close();
        conn.Close();
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

我的 aspx 代码是：

```
 <asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1" AutoGenerateColumns="False" DataKeyNames="IMG_ID">
    <Columns>
    <asp:BoundField DataField="IMG_ID" HeaderText="IMG_ID" InsertVisible="False" ReadOnly="True" SortExpression="IMG_ID" />
    <asp:BoundField DataField="IMG_NAME" HeaderText="IMG_NAME" SortExpression="IMG_NAME" />
    <asp:TemplateField HeaderText="IMG_IMAGE">
    <ItemTemplate>
    <asp:Image ID="Image1" runat="server" ImageUrl='<%# "Handler1.ashx?IMG_ID=" + Eval("IMG_ID")%>'/>
    </ItemTemplate>
    </asp:TemplateField>
    </Columns>
    </asp:GridView>
    <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
        ConnectionString="<%$ ConnectionStrings:ConnectionString2 %>" 
        ProviderName="<%$ ConnectionStrings:ConnectionString2.ProviderName %>" 
        SelectCommand="SELECT [IMG_ID],[IMG_NAME],[IMG_IMAGE] FROM [MYIMGTABLE]">
    </asp:SqlDataSource> 
```

![在此处输入图像描述](https://i.stack.imgur.com/UECS8.jpg) 这是完成我的项目的最后一个难题……救命！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T09:21:52.347

我看到您缺少 OracleCommand 上 BindByName 属性的设置，默认为 false 然后它将按参数位置绑定，我不确定它是否可能是您的问题的根源，但尝试设置它并查看确实如此。

[http://docs.oracle.com/cd/E11882_01/win.112/e23174/OracleCommandClass.htm#i997666](http://docs.oracle.com/cd/E11882_01/win.112/e23174/OracleCommandClass.htm#i997666) [http://docs.oracle.com/cd/E11882_01/win.112/e23174/featOraCommand.htm#i1007242](http://docs.oracle.com/cd/E11882_01/win.112/e23174/featOraCommand.htm#i1007242)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T06:46:39.280

ORA-00936、ORA-936 是一个通用错误，表示您刚刚执行的 SQL 语句中缺少表达式。此错误很可能表明您错过了 , [ 逗号 ] 或 from 子句或 where 子句或刚刚解析的 SQL 的其他部分。

# django - django-compressor、heroku、s3：请求已过期

> ID：15853928
> 
> 赞同：9
> 
> 时间：2013-04-06T17:29:29.953
> 
> 标签：django, heroku, amazon-s3, django-compressor

我在 heroku 上使用 django-compressor 和 amazon s3 提供静态文件，我一直遇到以下错误，因为压缩器生成了指向静态文件的链接。我对压缩机和 s3 完全陌生：

```
https://xxx.s3.amazonaws.com/static/CACHE/css/989a3bfc8147.css?Signature=tBJBLUAWoA2xjGlFOIu8r3SPI5k%3D&Expires=1365267213&AWSAccessKeyId=AKIAJCWU6JPFNTTJ77IQ

<Error>
<Code>AccessDenied</Code>
<Message>Request has expired</Message>
<RequestId>FE4625EF498A9588</RequestId>
<Expires>2013-04-06T16:53:33Z</Expires>
<HostId>Fbjlk4eigroefpAsW0a533NOHgfQBG+WFRTJ392v2k2/zuG8RraifYIppLyTueFu</HostId>
<ServerTime>2013-04-06T17:04:41Z</ServerTime>
</Error> 
```

我配置了两台heroku 服务器，一台用于登台，一台用于生产。他们每个人都有自己的数据库和 s3 存储桶。它们还共享相同的设置文件，所有唯一设置都配置为环境变量。我已经检查过静态文件实际上被推送到它们各自的存储桶中。

压缩机和s3设置如下：

```
COMPRESS_ENABLED = True
COMPRESS_STORAGE = STATICFILES_STORAGE 
COMPRESS_URL = STATIC_URL
COMPRESS_ROOT = STATIC_ROOT
COMPRESS_OFFLINE = False

AWS_ACCESS_KEY_ID = os.environ.get('AWS_ACCESS_KEY_ID')
AWS_SECRET_ACCESS_KEY = os.environ.get('AWS_SECRET_ACCESS_KEY')
AWS_STORAGE_BUCKET_NAME = os.environ.get('AWS_STORAGE_BUCKET_NAME') 
```

每次我在登台或生产上向 heroku 推送更新时，我最终都会遇到上述问题。有时会在一小时后发生，有时会发生在一天后，有时会发生在一周后，有时会在推出更新后立即发生。奇怪的是，如果我将相同的更新推送到两个环境，一个会起作用，我会在另一个上得到错误，或者它们都将首先起作用，一个会在一小时后过期，另一个会在一周后过期.

如果有人能解释发生了什么，我将不胜感激。显然是 Expires 参数导致了这个问题，但是为什么每次推送都会改变持续时间以及决定时间量的因素是什么？您如何更改到期时间？如果您需要更多信息，请告诉我。

更新：我通过设置 AWS_QUERYSTRING_AUTH = False 暂时解决了这个问题。似乎没有任何方法可以在查询字符串中设置 EXPIRATION TIME，只能在请求标头中使用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-14T02:45:01.777

试试这个：

```
AWS_QUERYSTRING_EXPIRE = 63115200 
```

该值是从生成链接开始的秒数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-15T20:27:48.427

以防万一有人遇到同样的问题：

```
AWS_QUERYSTRING_AUTH = False 
```

这消除了任何到期等。根据用例（如我的和许多其他情况）并不总是需要到期。这将允许您删除任何到期。

# c - 使用 register_chrdev 动态分配主号码时，保留 256 个次号码有什么意义吗？

> ID：15853931
> 
> 赞同：3
> 
> 时间：2013-04-06T17:30:02.410
> 
> 标签：c, linux

使用 register_chrdev 函数为动态分配的主要号码分配 256 个次要号码是否有意义

1.  要动态分配主编号，我使用内核中定义的 register_chrdev 函数

    ```
    static inline int register_chrdev(unsigned int major, const char *name,
                              const struct file_operations *fops)
    {
            return __register_chrdev(major, 0, 256, name, fops);
    } 
    ```

2.  __register_chrdev 现在将分配一个动态主编号，如果作为参数传递的主值是 0。此特定操作在内核中有以下源代码

    ```
    if (major == 0) {
            for (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {
                    if (chrdevs[i] == NULL)
                    break;
            } 
    ```

3.  chrdev 是指向 struct char_device_struct *chrdevs[CHRDEV_MAJOR_HASH_SIZE] 的指针数组；

4.  宏 CHRDEV_MAJOR_HASH_SIZE 的大小为 255

5.ARRAY_SIZE(chrdevs) 将返回 *chrdevs 数组的大小，考虑到 struct char_device_struct 的大小为 84 字节，结果为 5334（请原谅我的错误数学计算）。

问题：这很可能是一个愚蠢的问题，但为什么自动分配 256 个次要编号有什么意义吗？

以上截取的源代码来自 linux-3.6.7 内核文件：fs/char_dev.c

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:42:22.277

Register_chrdev 是旧接口，默认提供 256 个未成年人。这是从较旧的内核中携带的，并为向后兼容而维护。在 2.6 以后的新内核中，您有 register_chrdev_region 或 alloc_chrdev_region 。在此您可以指定您需要的未成年人数量。这是比 register_chrdev 更好的接口。

# gcc - 将 wxDev-C++ 与 GCC 或 MSVC 编译器一起使用时，可执行文件太大

> ID：15853936
> 
> 赞同：1
> 
> 时间：2013-04-06T17:30:17.570
> 
> 标签：gcc, wxwidgets, exe, visual-studio-2010, code-size

我正在使用 wxDev-C++ IDE（在 windows 7 中）创建一个简单的（hello world！）C++ 应用程序，它有一个非常简单的 GUI（只有一个没有元素的框架）。
问题是输出 .exe 文件的大小太大（当我使用 MSVC10 编译器编译时大约为 2MB，当我使用 GCC 编译时超过 8MB，这些大小是最好的情况！）。
我检查了许多可能性（例如排除调试信息或优化大小），但没有一个对减小可执行文件大小没有帮助。
我强烈猜测存在链接问题，因为我见过一个[演示应用程序](ftp://biolpc22.york.ac.uk/pub/binary/wxWidgets-WidgetsDemo-Windows.zip)，其中包含几乎所有小部件，代码大小只有大约 1MB。
任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T20:05:06.170

以下是使用 mingw 减小静态链接的 wxWidgets 应用程序大小所需遵循的步骤：

1.使用以下选项编译库：

> -ffunction-sections -fdata-sections -Os

这会将每个函数或数据项放入其自己的部分。

2.使用以下选项将可执行文件链接到库：

> -Wl,--gc-sections -s

符号和未使用的功能和数据部分将被删除。

使用这些选项，生成的可执行文件大小约为 3.3 MB。当然，这意味着您必须自己编译库，而不是使用预构建的二进制文件。我使用了以下 bat 文件来编译库：

```
cd C:\wxWidgets\build\msw
mingw32-make SHELL=CMD.exe -j4 -f makefile.gcc BUILD=release UNICODE=1 SHARED=0 clean
mingw32-make SHELL=CMD.exe -j4 -f makefile.gcc CPPFLAGS="-MD -MP -DHAVE_W32API_H -D__WXMSW__ -DNOPCH -DwxDEBUG_LEVEL=0 -DNDEBUG" CFLAGS="-mthreads -pipe -fmessage-length=0 -ffunction-sections -fdata-sections -fno-builtin -Os" CXXFLAGS="-mthreads -Wno-ctor-dtor-privacy -pipe -fmessage-length=0 -ffunction-sections -fdata-sections -fno-builtin -Os" LDFLAGS="-Wl,--subsystem,windows -Wl,--gc-sections -s -mthreads -mwindows" BUILD=release UNICODE=1 SHARED=0 
```

我还建议您使用 code::block 或 Qt Creator 而不是 wxDev。我个人使用 Qt Creator。它有一个很棒的编辑器，QMake 让事情变得更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T20:24:40.113

当您将全部内容打包到一个 exe 文件中时，您期望什么？（静止的）

编译的 .exe 文件的大小基于许多因素。但是，如果您将其编译为静态，您将创建迄今为止最大的。

例如，这是一个 wxWidgets 应用程序。编译了两次。一个使用 VC2010，第二个使用 minGW。

![在此处输入图像描述](https://i.stack.imgur.com/4FETT.jpg)

用 VS2010 WinXP 编译动态 127.488 KB

![在此处输入图像描述](https://i.stack.imgur.com/XqVuv.jpg)

使用 MinGW gcc WinXP 1.018.639 KB 编译动态

![在此处输入图像描述](https://i.stack.imgur.com/QaBKY.jpg)

你写了：
`about 2MB when I compile using MSVC10 compiler & more that 8MB when I use GCC compile & these sizes are best cases!.`

只要我们能看到任何make文件。或其他设置，这里很难提供帮助。

从以上结果可以看出，创建一个只有 128.000 KB 的 wx 应用程序是可能的。

dtx02.cpp

```
#include "dtx02.h"

///////////////////////////////////////////////////////////////////////////

dxDialog::dxDialog( wxWindow* parent, wxWindowID id, const wxString& title, const wxPoint& pos, const wxSize& size, long style ) : wxDialog( parent, id, title, pos, size, style )
{
    this->SetSizeHints( wxDefaultSize, wxDefaultSize );

    wxBoxSizer* bSizer2;
    bSizer2 = new wxBoxSizer( wxVERTICAL );

    m_button1 = new wxButton( this, ID_SHOWMESSAGE, wxT("&Show a message"), wxDefaultPosition, wxDefaultSize, 0 );
    bSizer2->Add( m_button1, 0, wxALL, 5 );

    m_button2 = new wxButton( this, wxID_OK, wxT("&Close"), wxDefaultPosition, wxDefaultSize, 0 );
    bSizer2->Add( m_button2, 0, wxALL, 5 );

    m_notebook1 = new wxNotebook( this, wxID_ANY, wxDefaultPosition, wxDefaultSize, 0 );
    m_panel1 = new wxPanel( m_notebook1, wxID_ANY, wxDefaultPosition, wxDefaultSize, wxTAB_TRAVERSAL );
    m_panel1->SetBackgroundColour( wxSystemSettings::GetColour( wxSYS_COLOUR_BTNFACE ) );

    m_notebook1->AddPage( m_panel1, wxT("a page"), true );
    m_panel2 = new wxPanel( m_notebook1, wxID_ANY, wxDefaultPosition, wxDefaultSize, wxTAB_TRAVERSAL );
    m_notebook1->AddPage( m_panel2, wxT("a page"), false );

    bSizer2->Add( m_notebook1, 1, wxEXPAND | wxALL, 5 );

    this->SetSizer( bSizer2 );
    this->Layout();

    this->Centre( wxBOTH );

    // Connect Events
    this->Connect( wxEVT_CLOSE_WINDOW, wxCloseEventHandler( dxDialog::OnClosex ) );
    m_button1->Connect( wxEVT_COMMAND_BUTTON_CLICKED, wxCommandEventHandler( dxDialog::OnShowMessage ), NULL, this );
    m_button2->Connect( wxEVT_COMMAND_BUTTON_CLICKED, wxCommandEventHandler( dxDialog::OnClose ), NULL, this );
}

dxDialog::~dxDialog()
{
    // Disconnect Events
    this->Disconnect( wxEVT_CLOSE_WINDOW, wxCloseEventHandler( dxDialog::OnClosex ) );
    m_button1->Disconnect( wxEVT_COMMAND_BUTTON_CLICKED, wxCommandEventHandler( dxDialog::OnShowMessage ), NULL, this );
    m_button2->Disconnect( wxEVT_COMMAND_BUTTON_CLICKED, wxCommandEventHandler( dxDialog::OnClose ), NULL, this );

} 
```

dtx02App.cpp

```
#include "dtx02App.h"
#include "dtx02dxDialog.h"

IMPLEMENT_APP(dtx02App)

dtx02App::dtx02App()
{
}

dtx02App::~dtx02App()
{
}

bool dtx02App::OnInit()
{
    dtx02dxDialog* dialog = new dtx02dxDialog( (wxWindow*)NULL );
    dialog ->Show();
    SetTopWindow( dialog );
    return true;
} 
```

dtx02dxDialog.cpp

```
#include "dtx02dxDialog.h"

dtx02dxDialog::dtx02dxDialog( wxWindow* parent )
:
dxDialog( parent )
{

}

void dtx02dxDialog::OnClosex( wxCloseEvent& event )
{
    wxTheApp->Exit();
}

void dtx02dxDialog::OnShowMessage( wxCommandEvent& event )
{
      wxMessageBox( wxT("wxFormBuilder Tut") );
}

void dtx02dxDialog::OnClose( wxCommandEvent& event )
{
    wxTheApp->Exit();
} 
```

# java - 查找运行时间为 O(1) 的最小数字 - java

> ID：15853938
> 
> 赞同：4
> 
> 时间：2013-04-06T17:30:28.357
> 
> 标签：java, algorithm, data-structures

我需要创建一个基于链表、数组和常量内存使用的数据结构。

作为输入，我得到两个数字：N 和 M。

N代表密钥盘的最大容量，M代表计算机硬盘的最大容量，所以M>N。

所以我需要创建一个程序，将信息从硬盘驱动器“移动”到密钥磁盘，该程序需要实现以下方法：

1.  插入（数据） - 将数据插入密钥磁盘，如果它已满，则删除最不重要的数据（*）：最坏情况运行时 O(1)。
2.  delete(data) - 从磁盘上删除给定的数据 - O(1)

(*) 用户可以更改文件的重要性。

最大内存使用量为 O(M)

到目前为止我做了什么：

我创建了一个数组 [1...M] 来“保存”计算机数据，我创建了一个双向链表来保存磁盘键数据。[想法是：每次将数据添加到disk-on-key时，它都会添加到链表中，我可以使用数组作为索引（/key）存储直接访问数据。]

我的电脑数据字段：

```
node firstNode;
node currentNode; 
node[] dataCollection; // Will hold computer hard-drive data 
```

所以我想创建一个方法，用我想添加的数据替换最不重要的数据[这样我就可以在插入中使用]，我的替换代码：

```
public void replace(int leastImportantdata, int insertData){
    node leastImportant = dataCollection[leastImportantdata];
    if (leastImportant.prev!=null) leastImportant.prev.next=dataCollection[insertData-1];
    if (leastImportant.next!=null) leastImportant.next.prev=dataCollection[insertData-1];
    numOfReplacements++; 
```

所以，我的主要问题是在给定这两个“组合”数据结构的情况下找到最不重要的数据，并且仍然保持 O(1) 的运行时间，尤其是当用户决定更改文件重要性时。

*   假设我们从 {4,3,2,1} 开始（数字代表重要性），最不重要的数据是 1。突然，用户决定将最后一个文件的重要性更改为 5，我们得到 {4,3,2, 5}，最不重要的数据是 2。

任何想法？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-06T18:09:45.900

为了能够找出最不重要的数据，您需要将订单添加到您的列表中。

那么首先想到链表的顺序是否重要？您似乎是根据索引而不是通过遍历列表来获取数据。（如果该顺序很重要，那么我的其余答案可能不是很有帮助：D）。

这意味着您可以潜在地将项目插入列表，以便按最低优先级对它们进行排序，这将允许您以恒定的性能获得要删除的项目，只要您有对列表头部的引用。

不幸的是，这会导致插入的复杂性上升。要解决此问题，您可以将优先级映射保留到具有该优先级的链接列表中的最后一个（也可能是第一个）文件。

使用此映射，您应该能够立即找出需要插入新文件的位置，从而获得稳定的性能。

所以如果你有 3 个文件 P(A) = 1 ， P(B) =3 ， P(C) = 3，你的地图看起来像 1->(A,A) 3->(B,C) 说如果你想插入另一个优先级为 1 的文件，它应该在 A 之后，如果你想插入一个优先级为 2 的文件，它应该在 B 之前。

显然，我在这里假设有限数量的可能优先级，并且使用的优先级之间没有差距。（这需要搜索）

希望这可以帮助

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-06T18:18:21.957

我对解决您的问题的建议如下：

*   定义节点类来实现 Comparable 接口。

*   将数据收集实现为跳过列表 - 您可以通过使用[ConcurrentSkipListMap](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)来做到这一点。

使用 SkipList 实现可以确保条目按重要性排序。

根据 Java API doc - 此类 ( [ConcurrentSkipListMap](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html) ) 实现了 SkipLists 的并发变体，为 containsKey、get、put 和 remove 操作及其变体提供预期的平均 log(n) 时间成本。

通常，该实现允许以与平衡二叉搜索树相当的效率进行项目查找（即，[探测器的数量与 log n 而不是 n 成正比](http://en.wikipedia.org/wiki/Skip_list)）。

最后[在 [这里]](http://en.literateprograms.org/Skip_list_%28Java%29)了解更多关于 SkipList 的信息，以及如何编写自己的实现。

# jquery - jQuery 函数的异常

> ID：15853939
> 
> 赞同：1
> 
> 时间：2013-04-06T17:30:28.653
> 
> 标签：jquery

变量`a`总是`#u-about`, `#u-projects`, `#u-contact`, 中的一个`#u-follow`。
如何使功能不动画`a`？

```
function bla(a) {$('#u-about, #u-projects, #u-contact, #u-follow').animate(...); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:32:10.453

您可以使用[not()](http://api.jquery.com/not/)并将 a 传递给 not 以**排除**`element`您*不*想要的。

```
function bla(a) {$('#u-about, #u-projects, #u-contact, #u-follow').not(a).animate(... 
```

**不是（）**

> 给定一个表示一组 DOM 元素的 jQuery 对象，.not() 方法从匹配元素的子集构造一个新的 jQuery 对象。提供的选择器针对每个元素进行测试；与选择器不匹配的元素将包含在结果中，[参考](http://api.jquery.com/not/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:33:01.867

使用[`.not()`](http://api.jquery.com/not/)选择器从 jQuery 对象中排除特定变量或选择器。

```
$('#u-about, #u-projects, #u-contact, #u-follow').not(a).animation 
```

# ruby-on-rails - Rails rabl json 格式

> ID：15853940
> 
> 赞同：1
> 
> 时间：2013-04-06T17:30:31.397
> 
> 标签：ruby-on-rails, json, rabl

我正在使用 rabl 以 json 格式显示我的数据库中的数据，以将其解析为 android...我的 json 看起来像这样：

```
[
   {
      "bank":{
         "central_office_address":"ololo",
         "license":"12312312",
         "location_id":3,
         "name":"Pbank",
         "tax_number":"12312312",
         "year_of_foundation":1987
      }
   },
   {
      "bank":{
         "central_office_address":"sdfsdf sdf",
         "license":"321312",
         "location_id":3,
         "name":"Bbank",
         "tax_number":"321321",
         "year_of_foundation":1999
      }
   }
] 
```

我需要我的 json 格式如下：

```
{
    "contacts": [
        {
                "id": "c200",
                "name": "Ravi Tamada",
                "email": "ravi@gmail.com",
                "address": "xx-xx-xxxx,x - street, x - country",
                "gender" : "male",
                "phone": {
                    "mobile": "+91 0000000000",
                    "home": "00 000000",
                    "office": "00 000000"
                }
        },
        {
                "id": "c201",
                "name": "Johnny Depp",
                "email": "johnny_depp@gmail.com",
                "address": "xx-xx-xxxx,x - street, x - country",
                "gender" : "male",
                "phone": {
                    "mobile": "+91 0000000000",
                    "home": "00 000000",
                    "office": "00 000000"
                }
        }
    ]
} 
```

这些数据通常在java中解析......

我的观点：

```
object @banks

attributes :central_office_address, :license, :location_id, :name, :tax_number, :year_of_foundation 
```

如何更改其输出以匹配第二个示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:24:47.440

我已经这样做了：

```
collection @banks, :root => "bank", :object_root => false
attributes :central_office_address, :license, :location_id, :name, :tax_number, :year_of_foundation 
```

也许这是个坏主意？

# qt - QTransform quadToQuad 总是返回 false

> ID：15853943
> 
> 赞同：3
> 
> 时间：2013-04-06T17:30:45.497
> 
> 标签：qt, qml, blackberry-10

我正在尝试使用 quadToQuad 来转换坐标，以便我可以在调整大小的图像上绘制一个像素，并将该坐标传输回原始图像。

出于示例目的，我制作了 2 个矩形，但 quadToQuad 函数始终返回 false。

有谁知道它为什么失败？

```
QRectF origRect(QPointF(0, 0), QPointF(800, 800));

QRectF resizeRect(QPointF(0, 0), QPointF(400, 400));

QTransform mappingTransform;

qDebug() << (QTransform::quadToQuad(origRect, resizeRect, mappingTransform));

QPointF point = mappingTransform.map(QPointF(x, y)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:50:38.913

我想说的问题是quadToQuad将QPolygonF作为输入，而不是QRectF。在声明 mappingTransform 后尝试插入以下内容：

```
QPolygonF orig(origRect);
QPolygonF resize(resizeRect);
qDebug() << (QTransform::quadToQuad(orig, resize, mappingTransform)); 
```

挖掘我的一些源代码，这就是我计算一个变换的方式：

```
QRectF  tileBox(QPointF(w, s+D), QPointF(w+D, s));
QPolygonF   q0 = rectToQuad(tileBox);

QPolygonF   q1;
q1      <<  QPointF(0,0)
    <<  QPointF(1201,0)
    <<  QPointF(1201,1201)
    <<  QPointF(0, 1201);

QTransform  tileTransform;

bool ok = QTransform::quadToQuad(q0, q1, tileTransform); 
```

我这样编码 rectToQuad：

```
QPolygonF   MyClass::rectToQuad(QRectF rect) {
QPolygonF   quad;

quad    << rect.topLeft()
    << rect.topRight()
    << rect.bottomRight()
    << rect.bottomLeft();

return quad;
} 
```

所以我一定遇到了和你类似的问题。您可能希望尝试类似的方法。

# linux - 如何在 linux 上使用“pmap”来查找我编写的程序的内存使用情况

> ID：15853946
> 
> 赞同：0
> 
> 时间：2013-04-06T17:30:49.693
> 
> 标签：linux, memory, pmap

我知道我可以使用：pmap pid 其中 pid 是我想在其上运行 pmap 的进程 id，但是如果我编写的程序只执行一次然后关闭，我将如何获得该进程的 pid？关闭后它甚至会有一个pid吗？

例如，假设我有 example.c，我已将其编译为示例。

我使用 ./example 运行它，它运行一次然后关闭。

我将如何使用 pmap 查看示例的内存使用情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:33:27.613

[`pause()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pause.html)在您的末尾添加 a`main`并执行以下操作：

```
pmap `pidof example` 
```

或者，在不更改示例的情况下，您可以在`gdb`想要检查内存时运行它并中断`pmap`。

# python - 从类到类的 Python 方法调用

> ID：15853947
> 
> 赞同：1
> 
> 时间：2013-04-06T17:30:51.990
> 
> 标签：python, class, call

我正在学习 Python，我对从一个类到另一个类的调用语法感到困惑。我做了很多搜索，但无法回答任何工作。我总是得到如下变化：

```
TypeError: __init__() takes exactly 3 arguments (1 given) 
```

非常感谢帮助

```
import random
class Position(object):
    '''
    Initializes a position
    '''
    def __init__(self, x, y):
        self.x = x
        self.y = y

    def getX(self):
        return self.x

    def getY(self):
        return self.y

class RectangularRoom(object):
    '''
    Limits for valid positions
    '''
    def __init__(self, width, height):
        self.width = width
        self.height = height

    def getRandomPosition(self):
        '''
        Return a random position
        inside the limits
        '''        
        rX = random.randrange(0, self.width)
        rY = random.randrange(0, self.height)

        pos = Position(self, rX, rY)
        # how do I instantiate Position with rX, rY?

room = RectangularRoom()
room.getRandomPosition() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:32:32.057

您不需要传递`self`- 那是新创建的实例，由 Python 自动提供。

```
pos = Position(rX, rY) 
```

请注意，此处的错误发生在此行上，但是：

```
room = RectangularRoom() 
```

这条线上的问题是你没有给予`width`或`height`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T19:05:02.303

也许这些前面问题的答案可以帮助你理解为什么 python 决定在方法上添加显式的特殊第一个参数：

*   [自我的目的是什么？](https://stackoverflow.com/questions/2709821/python-self-explained)
*   [为什么需要在 Python 方法中显式地添加“self”参数？](https://stackoverflow.com/questions/68282/why-do-you-need-explicitly-have-the-self-argument-into-a-python-method)
*   [Python - 为什么在课堂上使用“自我”？](https://stackoverflow.com/questions/475871/python-why-use-self-in-a-class)

错误消息可能有点神秘，但是一旦您看到它一两次，您就知道要检查什么：

1.  您是否忘记在方法上定义 self/cls 第一个参数？
2.  您是否传递了所有必需的方法参数？（第一个不算）

那些期望/给定的数字有很大帮助。

# javascript - 图表 - 如何对依赖资源进行建模？

> ID：15853948
> 
> 赞同：2
> 
> 时间：2013-04-06T17:30:54.310
> 
> 标签：javascript

没有图书馆，我正在尝试学习数据结构。

我有这些依赖项

```
jquery.js->jqueryui.js

(underscores.js, jquery.js) -> backbone.js 
```

基本上，jqueryui 依赖于 jquery。Bacbkone 依赖于下划线和 jquery。Jquery 和下划线不相关。

我想创建一个依赖树让你“阐明”这些关系。

有人告诉我这是如何在这个[发布的问题](https://stackoverflow.com/questions/15724403/modeling-dependencies-into-parallelism-serialism)上完成的。特别是这个评论。

> 只要您没有循环依赖项，您始终可以构建一个依赖项林，它仅由有向树和/或唯一节点组成。在树上，您可以简单地使用 DFS。然后，您首先将所有根或单个节点添加到队列中，并在加载它们的依赖项时将其他资源添加到队列中。（请注意，如果一个资源有多个依赖项，您不能将您的依赖项建模为森林，但它保持非循环，您可以使用类似的方法）。– 泽塔

...所以我确实有具有多个依赖项的资源，所以我不能使用依赖林。

...进一步的讨论提出了一个有向无环图。

> 有向无环图。从起点开始的每条路径都可以并行完成，但是如果一个节点有多个事件边，则您必须等待所有依赖项被加载。顺便说一句，我将示例 3 表示为 P:[U-underscore, U-jquery] S:[U-underscore, U-backbone-js] S:[U-jquery, U-backbone.js]，显示原始依赖，但它们是等价的

我可以使用依赖树吗？如果不是，建议使用什么数据结构来模拟复杂的依赖关系......最后我该如何实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T19:06:23.613

我相信我已经解决了这个问题，尽管它是很久以前的事了。让依赖关系描述如下：

*   模块 A
    *   模块 X
    *   模块 Y
*   模块 B
    *   模块 X
    *   模块 A
*   模块 C
    *   模块 A
    *   模块 B

这意味着模块 A 依赖于模块 X 和模块 Y - 依此类推。

遍历这个森林中的叶子，并且对于没有依赖关系的每个叶子（在基部查找），将叶子放入加载队列并将其从森林中删除，所以第一次通过产生：

*   模块 A
*   模块 B
    *   模块 A
*   模块 C
    *   模块 A
    *   模块 B

队列：模块 X，模块 Y。

第二关：

*   模块 B
*   模块 C
    *   模块 B

队列：模块 X、模块 Y、模块 A。

……等等。在同一通道中找到的模块可以并行加载，因此表示这一点的一种方法可能是：

```
[[Module X, Module Y], [Module A], [Module B], [Module C]] 
```

这意味着应该首先加载模块 X 和模块 Y，并且它们可以并行加载。其余的必须按顺序加载。

我对上述方法的最大担忧是它的复杂度为 O(n^2)。应该可以改进。使用查找图可以轻松检测循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T19:14:04.650

考虑到您询问*没有*库但使用库作为模块（jQuery、jQuery-ui 等）的模块化代码，看来这个问题实际上是两个问题。

1.  您如何理解您拥有的许多外部库（取决于使用脚本标签的线性加载）
2.  如何实现模块化依赖

回答第一个，有点复杂。设计的大多数模块化依赖项都需要围绕模块进行一些包装以跟踪它们。大多数 JS 库不使用这样的系统，假设它们将通过脚本标签加载（线性加载）。一些系统（例如[require.js）](http://requirejs.org/)将提供修改后的版本以兼容，而其他系统则尝试以预定义的顺序将脚本标签注入页面。更流行的解决方案是使用一种构建工具，它将您拥有的不同库文件连接到一个大文件中，该文件将以正确的顺序对它们进行排序。

大多数库都很好，并且会在其中包含它们的代码，以防止破坏也加载的其他脚本。甚至 jQuery 也提供了一种`noConflict()`方法来防止`$`语法破坏其他库可能期望的内容（例如[Zepto](http://zeptojs.com)）。

处理与外部库的依赖关系的答案取决于修改库以符合您拥有的任何模块化系统或拥有一个外部系统，例如构建环境，它将（由于缺乏更好的术语）将它们编译成正确的顺序.

这就是坏消息。好消息是您控制的代码实际上可以使用运行良好的依赖关系树。[require.js](http://requirejs.org/)是这样做的一个主要例子。尽管像[CommonJS](http://www.commonjs.org/)或[AMD](http://requirejs.org/docs/whyamd.html)这样的系统可能非常强大，但您可以自己实现一个简单的依赖 API。

以[Rye.js](http://ryejs.com/)为例，[说明](https://github.com/ryejs/rye/blob/master/lib/rye.js#L36)如何为您的代码实现自己的模块化系统：

```
(function(global) {

  var module_list = {};

  global.require = function (module) {
    return module_list[module];
  };

  global.define = function (module, fn) {
    modules[module] = fn();
  };

})(this); 
```

然后你可以定义你自己的模块：

```
define("hello_world", function() {

  function helloWorld() {
    alert("Hello World!");
  }

  return {
    sayHello: helloWorld
  };

}); 
```

然后在另一个依赖于该模块的模块中：

```
define("greetings", function() {

  var hello = require("hello_world");

  function sayAll() {
    hello.sayHello();
    alert("Good-Bye!");
  }

  return {
    sayAll: sayAll
  };

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-07T11:14:38.710

我在上一个答案中向您展示的数据结构，

```
deps = {
    "U-jqueryui": ["U-jquery"],
    "group1": ["U-underscore", "U-jquery"],
    "U-backbone.js": ["group1"]
} 
```

is 代表一个 DAG：

```
U-jquerui   U-backbone.js
     |          |
     |          v
     |       group1
     |      /     |
     v    L       v
 U-jquery    U-underscore.js 
```

从中，您可以提取依赖关系树，例如

```
 root
    |    |
    v    v 
```

U-jquery U-underscore.js

为`group1`. 所有可能的树的集合称为[森林](http://en.wikipedia.org/wiki/Forest_%28graph_theory%29)。

> 所以我确实有具有多个依赖项的资源，所以我不能使用依赖林。

不，你没有。拥有具有多个依赖项的资源仅意味着您需要一棵树而不是队列。当你的 DAG 图中有菱形时，它不再变成（[多](http://en.wikipedia.org/wiki/Multitree)/[多](http://en.wikipedia.org/wiki/Polytree)`U-myapp`）树的地方，例如，如果你有一个依赖于`U-jquerui`和`U-backbone.js`- 它依赖于`U-jquery`“两次”的模块。

但是，我认为我们真的不需要对整个图使用任何算法。

> 如果不是，建议使用什么数据结构来建模复杂的依赖关系

我已经向您展示了一个 - 只是对直接依赖项进行建模。即使您还不需要它，它也允许您表示 DAG（包括多森林）。

> 最后我该如何实现它？

我会选择记忆中的承诺（对不起，我喜欢它们）。每一个promise都代表一个模块已经被加载和执行的事实；我们通过模块名称记忆（缓存）它们，因此我们不会多次启动它们。那么代码就相当简单了：

```
var modulepromises = {};
function loadAndExecute(name) {
    if (name in modulepromises) // memoized?
        return modulepromises[name]; // we're on it already!

    var dependencies = [];
    if (name in deps)
        dependencies = deps[name].map(loadAndExecute);
    // all promises for direct dependencies (indirect deps are included) combined
    // will be fulfilled already if empty array
    var depsExecuted = Promise.when(dependencies);

    if (name.slice(0, 2) == "U-") // if a group, don't load anything
        var file = ajaxPromiseForModulesource(name);

    return modulepromises[name] = /*memoize!*/ depsExecuted.then(function() {
        if (file)
            return file.then(function(code) {
                execute(code); // eval?
                return "module "+name+" executed";
            });
        return "group loaded";
    });
} 
```

# python - Memcached 不允许缓存大于 1mb 限制的项目，即使它被覆盖

> ID：15853950
> 
> 赞同：1
> 
> 时间：2013-04-06T17:31:14.173
> 
> 标签：python, caching, memcached

使用`python-memcached==1.48`

终端：

```
memcached -I 10m 
```

Python：

```
Python 2.7.3 (default, Sep 26 2012, 21:51:14) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import memcache
>>> mc = memcache.Client(['127.0.0.1:11211'], debug=0)
>>> print(mc.set('test', ''.join(['a' for x in xrange(1*1024*1024+1)])))
0
>>> print(mc.set('test', ''.join(['a' for x in xrange(1*1024*1024)])))
True 
```

有人可以复制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:15:22.867

在接受大于 1MB 的值之前，您必须知道`python-memcache`最大值大小是多少：

```
import memcache

mc = memcache.Client(['127.0.0.1:11211'],
    debug = 0,
    server_max_value_length = 1024*1024*10
) 
```

# asp.net-mvc - 在调试器下运行时 MVC Azure 应用程序挂起

> ID：15853951
> 
> 赞同：1
> 
> 时间：2013-04-06T17:31:21.667
> 
> 标签：asp.net-mvc, asp.net-mvc-4, azure, freeze

我已经升级到 VS2012 和 MVC4。当我在没有调试器的情况下运行时，我的应用程序在本地开发环境中运行。但是，当我使用调试器运行时，它不会加载第一个视图。浏览器只是挂起。

我一直在跟踪代码，直到调用 View，然后什么也没有发生。在 Azure 模拟器下运行的全新 MVC 应用程序没有问题。有任何想法吗？谢谢马丁

# java - System.exit(0) 在安全管理器下可能没有授权

> ID：15853952
> 
> 赞同：0
> 
> 时间：2013-04-06T17:31:24.030
> 
> 标签：java, grant, securitymanager, system.exit

```
System.exit(0); or
System.exit(2); 
```

可以正确执行，运行

```
java -Djava.security.manager -Djava.security.policy==app.policy -cp bin pl.com.App 
```

应用政策：

```
grant {
      permission java.io.FilePermission "./*", "read,write";
      permission java.net.SocketPermission "localhost:18080", "accept, connect, listen";
      //permission java.util.PropertyPermission "java.home", "read";
}; 
```

写入文件的安全管理器工作正常，当我从 app.policy 中删除授权时，执行 new FileWriter("out.txt"); 时我正确地得到异常；

C:\workspace_tomcat\secureWeb>java-版本

```
java version "1.6.0_29"
Java(TM) SE Runtime Environment (build 1.6.0_29-b11)
Java HotSpot(TM) 64-Bit Server VM (build 20.4-b02, mixed mode) 
```

当我运行 System.exit(0); 在带有安全管理器的Tomcat下的webapp中，我正确地得到了异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T18:07:12.390

Javadoc 状态（[http://docs.oracle.com/javase/7/docs/technotes/guides/security/permissions.html](http://docs.oracle.com/javase/7/docs/technotes/guides/security/permissions.html)）：

> 注意：“exitVM.*”权限会自动授予从应用程序类路径加载的所有代码，从而使应用程序能够自行终止

这适用于您将代码作为独立应用程序运行时。这同样适用于 Tomcat - 它可能会自行关闭。**但是**这并**没有**扩展到在 Tomcat 容器中运行的程序。这些程序完全由 Tomcat 安全管理器控制：( [http://tomcat.apache.org/tomcat-7.0-doc/security-manager-howto.html](http://tomcat.apache.org/tomcat-7.0-doc/security-manager-howto.html) )

# ios - 即使应用程序在后台，也可以在 iOS 中重复某种方法

> ID：15853953
> 
> 赞同：-1
> 
> 时间：2013-04-06T17:31:25.860
> 
> 标签：ios, methods, background-process, repeat

我正在开发一个应用程序来解析来自网络的一些数据并将其放入表格视图中。它现在仅在用户告诉应用程序这样做（通过单击某个单元格）时才起作用，但我想更改它或更确切地说添加一个功能，这将简化用户的生活并每小时解析该数据（例如） . 我在考虑本地通知，因为这是我所知道的唯一事情，即使你杀死了应用程序。所以问题是：

**是否可以在应用程序中重复某个方法或功能，直到（例如）用户禁用此选项？即使应用程序在后台甚至被杀死，是否有类似服务的东西在运行？**

这可以通过本地通知来完成吗？如何？

或者什么是合适的方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:41:04.853

> 即使应用程序在后台运行，是否有类似服务的东西

参见，例如：

[在后台运行 iOS 应用程序](https://stackoverflow.com/questions/10758038/running-ios-app-in-the-background)

只有在执行某些允许的活动时，您的应用才能在后台运行。

# c++ - 通过 TCHAR 键名在 MAP 中查找项目

> ID：15853957
> 
> 赞同：-1
> 
> 时间：2013-04-06T17:31:59.887
> 
> 标签：c++, map, vector, tchar

所以，我有两个文本框（早期定义）和两个向量：

```
 std::vector<TCHAR*> v1;
 std::vector<int> v2; 
```

和地图：

```
std::map <TCHAR*, int> m1;
std::map <TCHAR*, int>:: iterator i1; 
```

地图初始化：

```
void mapInit()
{
m1[L"one"] = 1;
m1[L"two"] = 2;
m1[L"three"] = 3;
m1[L"four"] = 4;
m1[L"five"] = 5;
m1[L"six"] = 6;
m1[L"seven"] = 7;
m1[L"eight"] = 8;
m1[L"nine"] = 9;
m1[L"ten"] = 10;
 } 
```

我应该从第一个文本框中获取单词“one”并将其写入向量'v1'（文本框将来必须有更多单词，所以没有向量我不能这样做）。之后，程序必须通过键名在映射中找到所需的值：

```
TCHAR *zr = v1.at(0); // v1.at(0) has the word `one` atm
i1 = m1.find(zr); // want to get value `1` by key `one`
int z = i1->second; // and get it completely 
```

我得到一个调试断言错误“map/set iterator not dereferencable” .. :(

如果我将做所有相同但将其更改为 L"one"：

```
TCHAR *zr = L"one"; // 
i1 = m1.find(zr);
int z = i1->second; 
```

所以它会起作用......为什么它不能与向量值一起使用？我用调试器检查了我的向量值——它也是'L"one"'！但无论如何都不起作用...

注意：我也试图找到没有 .find() 方法的单词：

```
TCHAR *zr = v1.at(0);
int z = m1[zr]; // - now `z` returns a null... 
```

如果我将 'v1.at(0)' 更改为 L"one"，它将再次起作用

Heeeeeelp :( 为什么它不起作用？

=================================================

Yeeeeeeeah 现在它可以工作了！:) 轻松修复：

```
wstring zr = v1.at(0);
int z = m1[zr]; 
```

双喜临门）谢谢大家的帮助兄弟：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:48:42.177

我想“map/set iterator not dereferencable”是因为你试图取消引用指向 end() 的迭代器，你应该检查 find 是否真的找到了任何东西。

原因可能是因为您的地图：

```
std::map <TCHAR*, int> m1; 
```

保持为键指针，它们的值在v1中不同，因此无法找到它。如果您想保留您的设计（迭代所有映射值并打印键值，然后对 v1 执行相同操作），您可以检查它，或者按照评论中的建议以正确的方式进行操作并使用 std::wstring。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T19:06:11.753

不要使用 TCHAR* 作为映射键，它只会给你带来痛苦和头痛。引用释放的内存**会**导致内存泄漏和/或崩溃。

如果不是 unicode，TCHAR 只是 char 的 typedef，如果是 unicode，则为 wchar_t。

你可以做这样的事情

```
typedef std::basic_string<TCHAR> tstring; 
```

然后将您的地图声明为

```
std::map<tstring,int> 
```

注意不要使用指向字符串的指针。您应该能够将从 GetWindowText 返回的任何内容转换为 tstring。

你可以使用win32 api

```
tstring window_text(max_window_text,0);
auto ncount = ::GetWindowText(window_hwnd,&window_text[0],window_text.size());
if(ncount){
    window_text.resize(ncount);
} else{
    // handle failure
} 
```

这样做会为你省去很多痛苦。

知道如何从 TCHAR* 到 std::string/wstring 对于能够为 Windows 编写良好的原生 C++ 程序非常重要。这是你需要学习的东西，所以如果你仍然在邮政编码和错误中遇到问题。如果您不了解如何执行此操作，我建议您**不要**在 Windows 中使用 C++ 编写程序，而是使用 C# 之类的东西。

# google-apps-script - 使用脚本将公式设置为单元格不起作用

> ID：15853960
> 
> 赞同：1
> 
> 时间：2013-04-06T17:32:28.413
> 
> 标签：google-apps-script, google-sheets

我正在尝试使用谷歌脚本将公式设置为单元格，但它不起作用。我的条件和双引号很少，不知道如何在工作表中添加双引号。

```
=if(B17<>"",IF(Form!B8 = "","",IF(Form!B8 = "Representative",index(House!A:H,MATCH(B17,House!G:G,0),8),index(House!A:H,MATCH(B17,Senate!G:G,0),8))),"") 
```

如何将此公式添加到单元格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T17:57:46.100

您是否尝试过简单地用单引号括起来？

像这样：（*更新范围值）*

```
sheet.getRange(1,1).setFormula('=if(B17<>"",IF(Form!B8 = "","",IF(Form!B8 = "Representative",index(House!A:H,MATCH(B17,House!G:G,0),8),index(House!A:H,MATCH(B17,Senate!G:G,0),8))),"")') 
```

# iphone - 尝试在数字键盘上实现完成/取消按钮，但在模拟器中选择文本字段时出错

> ID：15853961
> 
> 赞同：1
> 
> 时间：2013-04-06T17:32:29.047
> 
> 标签：iphone, ios, objective-c, xcode

我有一个只有数字的文本字段。我正在尝试在键盘上实现完成/取消按钮以摆脱键盘。

在模拟器中，当我选择文本字段输入金额时，出现以下错误：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-       
[durood keyboardWillShow:]: unrecognized selector sent to instance 0x7644900'
*** First throw call stack:
(0x1c93012 0x10d0e7e 0x1d1e4bd 0x1c82bbc 0x1c8294e 0xb914f9 0x1ced0c5 0x1c47efa 0xac5bb2     
0x3c5777 0x3be929 0x3c08a2 0x3c0931 0x3c097b 0x3ba117 0x123386 0x122e29 0x2e63c3 0x2e8442   
0x2df85a 0x2de99b 0x2e00df 0x2e2d2d 0x2e2cac 0x2daa28 0x47972 0x47e53 0x25d4a 0x17698 
0x1beedf9 0x1beead0 0x1c08bf5 0x1c08962 0x1c39bb6 0x1c38f44 0x1c38e1b 0x1bed7e3 0x1bed668 
0x14ffc 0x209d 0x1fc5 0x1)
libc++abi.dylib: terminate called throwing an exception 
```

这是我的 h 文件中的代码：

```
#import <UIKit/UIKit.h>

int dcounter;
int total;
int enteramount;

@interface durood : UIViewController {

IBOutlet UILabel *dcount;
IBOutlet UILabel *dtotal;
IBOutlet UITextField *numberTextField; 
```

这是我的 m 文件中要添加到键盘的额外按钮的代码：

```
[super viewDidLoad];

UIToolbar *numberToolbar = [[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, 320, 50)];
numberToolbar.barStyle = UIBarStyleBlackTranslucent;
numberToolbar.items = [NSArray arrayWithObjects:
                       [[UIBarButtonItem alloc]initWithTitle:@"Cancel" 
style:UIBarButtonItemStyleBordered target:self action:@selector(cancelNumberPad)],
                       [[UIBarButtonItem  
alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],
                       [[UIBarButtonItem alloc]initWithTitle:@"Apply"  
style:UIBarButtonItemStyleDone target:self action:@selector(doneWithNumberPad)],
                       nil];
[numberToolbar sizeToFit];
numberTextField.inputAccessoryView = numberToolbar;
}

-(void)cancelNumberPad{
[numberTextField resignFirstResponder];
numberTextField.text = @"";
}

-(void)doneWithNumberPad{
NSString *numberFromTheKeyboard = numberTextField.text;
[numberTextField resignFirstResponder];
} 
```

我错过了什么？任何帮助将不胜感激。键盘应如下所示：![在此处输入图像描述](https://i.stack.imgur.com/DYVRL.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T17:38:19.910

`durood`崩溃来自于没有方法实现的事实`keyboardWillShow:`。

您是否订阅通知，例如`UIKeyboardWillShowNotification`？您可能添加了一个`@selector(keyboardWillShow)`，但实际上并没有创建方法实现。

# haskell - 如何在 Haskell 中构建图表？

> ID：15853965
> 
> 赞同：1
> 
> 时间：2013-04-06T17:32:41.420
> 
> 标签：haskell, graph

如何在 Haskell 中构建图表：

```
type Node = Int
type Arc = (Node, Node) 
```

和功能：

```
class Graph g where
         build :: [Node] -> [Arc] -> g 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-06T18:05:35.607

目前你只有一个[typeclass](http://learnyouahaskell.com/types-and-typeclasses#typeclasses-101)，它有点像 OOP 接口。就像接口一样，您实际上不能“构造”一个​​类。您需要选择一个具体的实现（使用关键字`data`），然后`build`在其上实现该功能。这就是您将传递给需要的函数的内容`Graph`

举个简单的例子：

```
--The concrete data type
data NaiveGraph = NG [Node] [Arc]

--Now we make it an instance of Graph
instance Graph NaiveGraph where
   build = NG 
```

这可能是也可能不是一个可接受的实例，具体取决于您想要做什么。有关您的实际目标的更多信息将帮助我提出更好的表示。

# dart - 使用单选按钮和 Web UI 进行数据绑定

> ID：15853970
> 
> 赞同：2
> 
> 时间：2013-04-06T17:32:55.197
> 
> 标签：dart, dart-webui

我无法使用无线电输入获得以下数据绑定代码来工作：

```
<!DOCTYPE html>

<html>
  <body>
    <div>
      <input type="radio" name='veggies' value="kale" bind-value={{name}}>Kale<br>
      <input type="radio" name='veggies' value="spinach" bind-value={{name}}>Spinach<br>
      <input type="radio" name='veggies' value="carrots" bind-value={{name}}>Carrots
    </div>

    <p>name = {{name}}</p>

    <script type="application/dart">

      import 'package:web_ui/web_ui.dart';

      @observable
      String name = "Carrots";

      void main() {}

    </script>
  </body>
</html> 
```

该文件是 radio_binding.html。

当我构建这个文件时，我在 out/radio_binding.html.dart 文件中得到一个错误：

```
Error: line 42 pos 46: semicolon expected
  __t.listen(__e0.onChange, ($event) { {{name}} = 'kale'; }); 
```

这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T20:39:47.583

尝试使用此绑定：

```
<div>
  <input type="radio" name='veggies' value="Kale" bind-value="name">Kale<br>
  <input type="radio" name='veggies' value="Spinach" bind-value="name">Spinach<br>
  <input type="radio" name='veggies' value="Carrots" bind-value="name">Carrots
</div> 
```

而且我认为您不需要@observable，我只是使用了：

```
String name = 'Spinach'; 
```

# javascript - Teehan & Lax 使用 javascript 隐藏标题——向下滚动时隐藏，向上滚动时显示

> ID：15853974
> 
> 赞同：0
> 
> 时间：2013-04-06T17:33:15.813
> 
> 标签：javascript, jquery, css, scroll, transition

我一直在开发具有固定标题的移动版本的网站，我希望在向下滚动以隐藏导航时获得相同的效果，仅在向上滚动超过 5 个像素时才显示它。

就像[teehanlax.com](http://www.teehanlax.com/story/medium/)一样。我已经使用我在网上找到的一些代码试了一下，但它的行为很奇怪。它隐藏在向下滚动时，但只会再次显示，似乎......随机。

这是我的代码。

```
//Hide Header on on scroll down
        $(function(){
            var lastScrollTop = 0, delta = 5;
            $(window).scroll(function(event){
               var st = $(this).scrollTop();

               if(Math.abs(lastScrollTop - st) <= delta)
                  return;

               if (st > lastScrollTop){
                   // Scroll Down
                    $("header").delay(100).queue(function() {
                        $(this).addClass("animated fadeOutUp");
                        $(this).dequeue();
                    });

               } else {
                  // Scroll Up
                    $('header').delay(100).queue(function() {
                        $(this).removeClass("fadeOutUp").addClass("animated fadeInDown");
                        $(this).dequeue();
                    });
               }
               lastScrollTop = st;
            });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T13:40:08.000

您发布的 JS 看起来很不错，可能更多的是 CSS 问题。你能发布与此相关的 CSS 吗？

# java - Java在调用paint方法时清除屏幕 - 如何避免这种情况？

> ID：15853980
> 
> 赞同：4
> 
> 时间：2013-04-06T17:33:45.443
> 
> 标签：java, screen, paint, java-canvas

我试图在 Java 中的 Canvas 中绘制两条线，分别调用两个方法，但是当我绘制第二条线时，第一条线消失（Java 清除屏幕）。我怎样才能避免这种情况？我想看看这两条线。我看过画图教程（如何在 Windows 上制作像画图这样的程序），其中用户使用鼠标画线，当画出一条线时，另一条线不会消失。他们只是调用paint方法，它不会清除屏幕。

如果有人可以帮助我，我将不胜感激。谢谢。

查看课程

```
import java.awt.BorderLayout;
import java.awt.Canvas;
import java.awt.Color;
import java.awt.Graphics;

import javax.swing.JFrame;

public class CircuitTracePlotView extends JFrame {

    private CircuitTracePlot circuitTracePlot;

    public  CircuitTracePlotView() {

        this.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        this.getContentPane().add(circuitTracePlot = new CircuitTracePlot(), BorderLayout.CENTER);
        this.pack();
        this.setSize(250,250);
        this.setLocationRelativeTo(null);

        this.setVisible(true);
        circuitTracePlot.drawLine();
        circuitTracePlot.drawOval();
    }

}

class CircuitTracePlot extends Canvas {

    private final static short LINE = 1;
    private final static short OVAL = 2;
    private int paintType;

    private int x1;
    private int y1;
    private int x2;
    private int y2;

    public CircuitTracePlot() {
        this.setSize(250,250);
        this.setBackground(Color.WHITE);

    }

    private void setPaintType(int paintType) {
        this.paintType = paintType;
    }

    private int getPaintType() {
        return this.paintType;
    }

    public void drawLine() {
        this.setPaintType(LINE);
        this.paint(this.getGraphics());
    }

    public void drawOval() {
        this.setPaintType(OVAL);
        this.paint(this.getGraphics());
    }

    public void repaint() {
        this.update(this.getGraphics());
    }

    public void update(Graphics g) {
        this.paint(g);
    }

    public void paint(Graphics g) {
        switch (paintType) {
        case LINE:
            this.getGraphics().drawLine(10, 10, 30, 30);            
        case OVAL:
            this.getGraphics().drawLine(10, 20, 30, 30);
        }

    }

} 
```

主班

```
import javax.swing.SwingUtilities;

import view.CircuitTracePlotView;

public class Main {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                CircuitTracePlotView cr = new CircuitTracePlotView();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T17:39:43.320

*   你几乎不应该`paint(...)`直接打电话。我可以一方面计算我需要这样做的次数。
*   不要通过调用`getGraphics()`组件来获取 Graphics 对象，因为这将返回一个非持久的 Graphics 对象。而是在 BufferedImage 中绘制并在paint 方法中显示它，或者在paint 方法中绘制（如果是AWT）。
*   因为这是一个 Swing GUI，所以不要使用 AWT 组件来绘制。使用 JPanel 并覆盖`paintComponent(...)`方法，而不是`paint(...)`方法。否则，您将失去 Swing 图形的所有优点，包括自动双缓冲。
*   该`super.paintComponent(g)`方法应该在`paintComponent(Graphics g)`覆盖中调用，通常作为该方法内部的第一个方法调用。这让组件可以进行自己的内务绘制，包括擦除需要擦除的绘图。
*   阅读有关 Swing 图形的教程，因为其中大部分内容都得到了很好的解释。例如，请看这里：
    *   [课程：执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)
    *   [在 AWT 和 Swing 中绘画](http://www.oracle.com/technetwork/java/painting-140037.html)

**编辑**

*   为了让您的图像持久存在，我建议您绘制到 BufferedImage，然后在 JPanel 的`paintComponent(...)`方法中显示该图像。
*   或者另一种选择是创建一个 Shape 对象的集合，也许是一个`ArrayList<Shape>`并用您想要绘制的 Shapes 填充它，然后在`paintComponent(...)`方法中将 Graphics 对象转换为 Graphics2D 对象并遍历 Shape 集合绘制每个形状`g2d.draw(shape)`当你迭代时。

由于 Trash 发布了他的代码，...

```
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.*;

public class CircuitTracePlot2 extends JPanel {

   private static final int PREF_W = 250;
   private static final int PREF_H = PREF_W;

   private int drawWidth = 160;
   private int drawHeight = drawWidth;
   private int drawX = 10;
   private int drawY = 10;
   private PaintType paintType = PaintType.LINE;

   public CircuitTracePlot2() {

   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   public void setPaintType(PaintType paintType) {
      this.paintType = paintType;
      repaint();
   }

   @Override
   protected void paintComponent(Graphics g) {
      super.paintComponent(g);
      if (paintType == null) {
         return;
      }
      switch (paintType) {
      case LINE:
         g.drawLine(drawX, drawY, drawWidth, drawHeight);
         break;
      case OVAL:
         g.drawOval(drawX, drawY, drawWidth, drawHeight);
         break;
      case SQUARE:
         g.drawRect(drawX, drawY, drawWidth, drawHeight);

      default:
         break;
      }
   }

   private static void createAndShowGui() {
      final CircuitTracePlot2 circuitTracePlot = new CircuitTracePlot2();

      JFrame frame = new JFrame("CircuitTracePlot2");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(circuitTracePlot);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);

      int timerDelay = 2 * 1000;
      new Timer(timerDelay , new ActionListener() {
         private int paintTypeIndex = 0;

         @Override
         public void actionPerformed(ActionEvent arg0) {
            paintTypeIndex++;
            paintTypeIndex %= PaintType.values().length;
            circuitTracePlot.setPaintType(PaintType.values()[paintTypeIndex]);
         }
      }).start();
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

enum PaintType {
   LINE, OVAL, SQUARE;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T18:01:58.427

这是您的程序的一个变体，它实现了@Hovercraft 的许多有用建议。尝试注释掉调用来`setPaintType()`查看效果。

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

/** @see http://stackoverflow.com/a/15854246/230513 */
public class Main {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                CircuitTracePlotView cr = new CircuitTracePlotView();
            }
        });
    }

    private static class CircuitTracePlotView extends JFrame {

        private CircuitTracePlot plot = new CircuitTracePlot();

        public CircuitTracePlotView() {
            this.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
            plot.setPaintType(CircuitTracePlot.OVAL);
            this.add(plot, BorderLayout.CENTER);
            this.pack();
            this.setLocationRelativeTo(null);
            this.setVisible(true);
        }
    }

    private static class CircuitTracePlot extends JPanel {

        public final static short LINE = 1;
        public final static short OVAL = 2;
        private int paintType;

        public CircuitTracePlot() {
            this.setBackground(Color.WHITE);
        }

        public void setPaintType(int paintType) {
            this.paintType = paintType;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            switch (paintType) {
                case LINE:
                    g.drawLine(10, 10, 30, 30);
                case OVAL:
                    g.drawOval(10, 20, 30, 30);
                default:
                    g.drawString("Huh?", 5, 16);
            }
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(250, 250);
        }
    }
} 
```

# c++ - Boost Log 2.0：日志中的空严重级别

> ID：15853981
> 
> 赞同：26
> 
> 时间：2013-04-06T17:33:46.993
> 
> 标签：c++, boost, boost-log

我使用的是 Boost-Log 2.0，它与版本 1 有一些不同，我很难输出“严重性”属性。

我正在使用“Boost.Format-style”格式化程序

```
"%TimeStamp% [%Uptime%] (%LineID%) <%Severity%>: %Message%" 
```

`TimeStamp`, `LineID`,`Message`是`common_attributes`. `Uptime`是我使用添加的属性`attrs::timer()`。我认为这`Severity`是在使用时自动添加的`severity_logger`，但显然不是，这是我的问题。我得到空的严重性，例如：

```
2013-Apr-06 19:21:52.408974 [00:00:00.001337] (3) <>: A warning severity message 
```

注意空`<>`。我尝试使用添加严重性，`register_simple_formatter_factory`但随后出现编译器错误：

```
error: no matching function for call to ‘register_simple_formatter_factory(const char [9])’ 
```

我不明白为什么。

这是我的代码：

```
#include <iostream>

#include <boost/log/common.hpp>
#include <boost/log/core.hpp>
#include <boost/log/trivial.hpp>
#include <boost/log/expressions.hpp>
#include <boost/log/sinks/text_file_backend.hpp>
#include <boost/log/sinks/sync_frontend.hpp>
#include <boost/log/sinks/text_ostream_backend.hpp>
#include <boost/log/utility/setup/file.hpp>
#include <boost/log/utility/setup/common_attributes.hpp>
#include <boost/log/utility/setup/formatter_parser.hpp>
#include <boost/log/sources/severity_logger.hpp>
#include <boost/log/sources/severity_feature.hpp>
#include <boost/log/sources/record_ostream.hpp>

#include <boost/log/attributes.hpp>

using namespace std;

namespace logging = boost::log;
namespace expr = boost::log::expressions;
namespace attrs = boost::log::attributes;
namespace src = boost::log::sources;
namespace keywords = boost::log::keywords;

enum severity_level
{
    DEBUG,
    INFO,
    WARNING,
    ERROR,
    CRITICAL
};

BOOST_LOG_INLINE_GLOBAL_LOGGER_DEFAULT(my_logger, src::severity_logger_mt< severity_level> )

// The formatting logic for the severity level
template< typename CharT, typename TraitsT >
inline std::basic_ostream< CharT, TraitsT >& operator<< (
    std::basic_ostream< CharT, TraitsT >& strm, severity_level lvl)
{
    static const char* const str[] =
    {
        "DEBUG",
        "INFO",
        "WARNING",
        "ERROR",
        "CRITICAL"
    };
    if (static_cast< std::size_t >(lvl) < (sizeof(str) / sizeof(*str)))
        strm << str[lvl];
    else
        strm << static_cast< int >(lvl);
    return strm;
}

void init() {
    // logging::register_simple_formatter_factory< severity_level >("Severity");
    logging::add_file_log(
            keywords::file_name = "blop.log",
            keywords::auto_flush = true,
            keywords::open_mode = (std::ios::out | std::ios::app),
            keywords::format = "%TimeStamp% [%Uptime%] (%LineID%) <%Severity%>: %Message%"
            );
    logging::add_common_attributes();
    logging::core::get()->add_global_attribute("Uptime", attrs::timer());
}

int main(int argc, const char *argv[]) {
    init();
    src::severity_logger_mt< severity_level > lg = my_logger::get();
    BOOST_LOG_SEV(lg, DEBUG) << "A debug severity message";
    BOOST_LOG_SEV(lg, INFO) << "An informational severity message";
    BOOST_LOG_SEV(lg, WARNING) << "A warning severity message";
    BOOST_LOG_SEV(lg, ERROR) << "An error severity message";
    BOOST_LOG_SEV(lg, CRITICAL) << "A critical severity message";
    return 0;
} 
```

注意注释掉的行：

```
// logging::register_simple_formatter_factory< severity_level >("Severity"); 
```

这会产生上述错误。

我编译它：

```
g++ main.cpp -Wall -DBOOST_ALL_DYN_LINK  -lboost_system -lboost_log_setup -lboost_log -lboost_filesystem -lboost_date_time -lboost_thread -o main 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-10-13T21:57:54.493

遇到同样的问题（日志文件中的空白 %Severity% 以及尝试添加注册函数时出现相同的编译器错误）。我发现对 register_simple_formatter_factory 的调用应该是：

```
boost::log::register_simple_formatter_factory< boost::log::trivial::severity_level, char >("Severity"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-14T15:24:23.327

`register_simple_formatter_factory`这是函数模板的原型：

```
template<typename AttributeValueT, typename CharT>
void register_simple_formatter_factory(attribute_name const &); 
```

这意味着您忘记了`typename CharT`，所以，这是正确的：

```
logging::register_simple_formatter_factory<severity_level, char>("Severity"); 
```

或其他一些字符类型，例如`wchar_t`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-22T19:15:44.847

您可以制作自己的后端并在其上调用 set_formatter。这是我的代码，展示了如何执行此操作以及一些附加功能，例如日志文件清理和自动刷新：

```
BOOST_LOG_DECLARE_GLOBAL_LOGGER(db_logger, src::severity_logger_mt< dreambridge::log::LogLevel >);

#define LOGGER(level) BOOST_LOG_STREAM_SEV(db_logger::get(), level)
    void InitializeFileLog(const std::string & logDir)
    {   
        boost::shared_ptr< logging::core > loggingCore = logging::core::get();

        db_logger::get().add_attribute(
            "TimeStamp",
            boost::make_shared< attrs::local_clock >());

        string logPath = logDir + "/DreamBridgeSapi2MrcpTts_%N.log";

        boost::shared_ptr< sinks::text_file_backend > backend =
            boost::make_shared< sinks::text_file_backend >(
                // file name pattern
                keywords::file_name = logPath,
                // rotate the file upon reaching 5 MiB size...
                keywords::rotation_size = 5 * 1024 * 1024,
                // ...or at midnight, whichever comes first
                keywords::time_based_rotation = sinks::file::rotation_at_time_point(0, 0, 0)                    
            );

        backend->auto_flush(true);

        // Wrap it into the frontend and register in the core.
        // The backend requires synchronization in the frontend.
        typedef sinks::synchronous_sink< sinks::text_file_backend > sink_t;
        boost::shared_ptr< sink_t > sink(new sink_t(backend));

        loggingCore->add_sink(sink);

        backend->set_formatter(fmt::stream
                        << fmt::date_time< boost::posix_time::ptime >("TimeStamp")
                        << " : [" << fmt::attr< dreambridge::log::LogLevel >("Severity")
                        << "] " << fmt::message()
                        );

        backend->set_file_collector(sinks::file::make_collector(
            // rotated logs will be moved here
            keywords::target = logDir + "/old_logs",
            // oldest log files will be removed if the total size reaches 100 MiB...
            keywords::max_size = 100 * 1024 * 1024,
            // ...or the free space in the target directory comes down to 50 MiB
            keywords::min_free_space = 50 * 1024 * 1024
        ));

        try
        {
            backend->scan_for_files(sinks::file::scan_all);
        }
        catch(std::exception & e)
        {
            LOGGER(emergency) << "exception during scanning : " << e.what();

        }

    } 
```

您还可以将日志记录级别设置为：

```
void SetLogLevel(dreambridge::log::LogLevel logLevel)
    {
        boost::shared_ptr< logging::core > loggingCore = logging::core::get();

        loggingCore->set_filter
        (
            flt::attr< dreambridge::log::LogLevel >("Severity") <= logLevel
        );
    } 
```

注意：此代码来自我自己的存储库。dreamdridge 是产品名称，因此是名称空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-11T19:14:45.690

[正如W. Merrt](https://stackoverflow.com/a/19350764/1016861)和[Matt Yang](https://stackoverflow.com/a/24221423/1016861)`operator<<`的回答所指出的，更正注册格式化程序的调用（即）是使当前代码正确编译和运行所需的全部内容。

但是，为了充分利用 Boost Log 的过滤功能，您还需要定义`operator>>`自定义严重级别，然后将该方法注册到过滤器工厂。

```
template< typename CharT, typename TraitsT>
inline std::basic_istream< CharT, TraitsT >& operator>> (
    std::basic_istream< CharT, TraitsT >& strm, severity_level &lvl)
{
    std::string tmp;
    strm >> tmp;

    // can make it case insensitive to allow 'warning' instead of only 'WARNING'
    // std::transform(tmp.begin(), tmp.end(), tmp.begin(), ::toupper);

    // if you have a lot of levels you may want use a map instead
    if (tmp.compare("DEBUG") == 0) lvl = DEBUG;
    else if (tmp.compare("INFO") == 0) lvl = INFO;
    else if (tmp.compare("WARNING") == 0) lvl = WARNING;
    else if (tmp.compare("ERROR") == 0) lvl = ERROR;
    else if (tmp.compare("CRITICAL") == 0) lvl = CRITICAL;
    // provide a default value for invalid strings
    else lvl = DEBUG;
    // or you could throw an exception
    // else tmp.append(" is not a valid severity level."), throw std::invalid_argument(tmp);

    return strm;
}

void init() {
    // register operator<< for severity_level
    logging::register_simple_formatter_factory< severity_level, char >("Severity");
    // register operator>> for severity_level
    logging::register_simple_filter_factory< severity_level >("Severity");
    logging::add_file_log(
            keywords::file_name = "blop.log",
            keywords::auto_flush = true,
            keywords::open_mode = (std::ios::out | std::ios::app),
            keywords::format = "%TimeStamp% [%Uptime%] (%LineID%) <%Severity%>: %Message%",
            // now you can filter using the name of the severity level
            keywords::filter = "%Severity% >= INFO"                );
    logging::add_common_attributes();
    logging::core::get()->add_global_attribute("Uptime", attrs::timer());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-19T06:51:48.647

原因可能是您不应该将数据写入 std::ostream。boost.log 使用 boost.log.formatting_ostream 来输出日志，而不是 std::ostream。[请参阅从页面http://www.boost.org/doc/libs/1_54_0/libs/log/doc/html/log/detailed/expressions.html](http://www.boost.org/doc/libs/1_54_0/libs/log/doc/html/log/detailed/expressions.html)中提取的此代码

```
// The operator is used when putting the severity level to log
logging::formatting_ostream& operator<<
(
    logging::formatting_ostream& strm,
    logging::to_log_manip< severity_level, severity_tag > const& manip
)
{
    static const char* strings[] =
    {
        "NORM",
        "NTFY",
        "WARN",
        "ERRR",
        "CRIT"
    };

    severity_level level = manip.get();
    if (static_cast< std::size_t >(level) < sizeof(strings) / sizeof(*strings))
        strm << strings[level];
    else
        strm << static_cast< int >(level);

    return strm;
} 
```

# android - 带有变量的 Android 微调器计算

> ID：15853987
> 
> 赞同：0
> 
> 时间：2013-04-06T17:34:24.720
> 
> 标签：android, variables, spinner

我有一个问题，我不知道如何解决。我的代码如下：

```
 package com.app.BoomBase;

import android.app.Activity;
import android.app.LauncherActivity.ListItem;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.Toast;

public class Distance extends Activity implements OnItemSelectedListener {
    Button Calc;
    Spinner spType, spForce, spWeight;
    double FarstCatch, TrickCatch, MTA, LongDistance ;
    String[] types  = { "Farst Catch", "Trick Catch", "MTA" , "Long Distance" };
    EditText etWeight;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.distance);
        super.onCreate(savedInstanceState);
        FarstCatch = 100;
        TrickCatch = 43.56; 
        MTA = 32.60 ; 
        LongDistance = 25;

        ArrayAdapter<String> AdapterT = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, types);
        spType = (Spinner) findViewById(R.id.spType);
        AdapterT.setDropDownViewResource(android.R.layout.simple_spinner_item);
        spType.setAdapter(AdapterT);
        spType.setPrompt("Select Type");
        spType.setOnItemSelectedListener(this);
        Button Calc = (Button) findViewById(R.id.button1);

        Calc.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                String selected = spType.getSelectedItem().toString();
                Toast.makeText(getApplicationContext(), "Your Boomerang will apoximately fly this far:" + selected, Toast.LENGTH_LONG).show();

            }
        });
        }

    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub
        int position = spType.getSelectedItemPosition();
        switch (position){
        case 0:
            double FarstCatch;
            break; 
        case 1: 
            double TrickCatch;
            break;
        case 2: 
            double MTA;
            break;
        case 3: 
            double LongDistance;
            break;
        }
        }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub

    }
} 
```

我想从用户输入（spType）中获取与所选案例相对应的变量，然后将其用于计算。示例：如果用户选择 FarstCatch，我想取数字 100 并在此计算中使用它：R = m / FarstCatch。

我怎样才能做到这一点 ？

**编辑：** 新代码：

```
 package com.app.BoomBase;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.Toast;

public class Distance extends Activity implements OnItemSelectedListener {
    Button Calc;
    Spinner spType, spForce, spWeight;
    double FarstCatch, TrickCatch, MTA, LongDistance, r ;
    String[] types  = { "Farst Catch", "Trick Catch", "MTA" , "Long Distance" };
    double[] values = {100, 43.56, 32.6, 25};
    EditText etWeight;
    int etNum;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.distance);
        super.onCreate(savedInstanceState);
        FarstCatch = 100;
        TrickCatch = 43.56; 
        MTA = 32.60 ; 
        LongDistance = 25;

        ArrayAdapter<String> AdapterT = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, types);
        spType = (Spinner) findViewById(R.id.spType);
        AdapterT.setDropDownViewResource(android.R.layout.simple_spinner_item);
        spType.setAdapter(AdapterT);
        spType.setPrompt("Select Type");
        spType.setOnItemSelectedListener(this);
        etWeight = (EditText) findViewById(R.id.etWeight);
        Button Calc = (Button) findViewById(R.id.button1);

        Calc.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                String etValue = etWeight.getText().toString();
                etNum = Integer.parseInt(etValue);
                Toast.makeText(getApplicationContext(), "Your Boomerang will apoximately fly this far:" + r , Toast.LENGTH_LONG).show();

            }
        });
    }

    public void onItemSelected1(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
          // value corresponds to the selected spType
          double value = values[arg2];

          r = etNum/value;  
}

    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
            long arg3) {
        // TODO Auto-generated method stub
        int position = spType.getSelectedItemPosition();
        switch (position){
        case 0:
            double FarstCatch;
            break; 
        case 1: 
            double TrickCatch;
            break;
        case 2: 
            double MTA;
            break;
        case 3: 
            double LongDistance;
            break;
        }
}

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub

    }
} 
```

但它仍然不起作用..这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T18:05:36.977

为与类型数组对应的值创建另一个数组。

```
double[] values = {100, 43.56, 32.6, 25}; 
```

接下来，按如下方式实现 onItemSelected() -

```
@Override
public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
  // value corresponds to the selected spType
  double value = values[arg2];

  // Do your calculation
  //double R = m/value; 
} 
```

**注意**：arg2 是选中项的位置，所以需要使用 getSelectedItem()

```
public void onItemSelected(AdapterView<?> parent, View view, int position, long id) 
```

示例代码：

```
public class Distance extends Activity implements OnItemSelectedListener {
    Button Calc;
    Spinner spType, spForce, spWeight;
    double selectedValue, r;
    String[] types  = { "Farst Catch", "Trick Catch", "MTA" , "Long Distance" };
    double[] values = {100, 43.56, 32.6, 25};
    EditText etWeight;
    int etNum;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.distance);
        super.onCreate(savedInstanceState);

        ArrayAdapter<String> AdapterT = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, types);
        spType = (Spinner) findViewById(R.id.spType);
        AdapterT.setDropDownViewResource(android.R.layout.simple_spinner_item);
        spType.setAdapter(AdapterT);
        spType.setPrompt("Select Type");
        spType.setOnItemSelectedListener(this);
        etWeight = (EditText) findViewById(R.id.etWeight);
        Button Calc = (Button) findViewById(R.id.button1);

        Calc.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                String etValue = etWeight.getText().toString();
                etNum = Integer.parseInt(etValue);
                r = etNum/selectedValue; 
                Toast.makeText(getApplicationContext(), "Your Boomerang will apoximately fly this far:" + r , Toast.LENGTH_LONG).show();

            }
        });
    }

    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
          // value corresponds to the selected spType
          selectedValue = values[arg2]; 
    }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {
    }
} 
```

# c# - 使用 MVC 集成将上下文传递给 FluentValidation 中的集合验证器

> ID：15853991
> 
> 赞同：3
> 
> 时间：2013-04-06T17:34:37.373
> 
> 标签：c#, asp.net-mvc, ninject, fluentvalidation

有谁知道在使用 FluentValidation 的 MVC4 集成和 Ninject Validator Factory 集成时如何将一个验证器的上下文传递给集合验证器？

例子：

```
public class Foo
{
    public IEnumerable<Bar> Bars { get; set; } 
}

public class Bar
{
    public string Bizz { get; set; }
}

public class FooValidator : AbstractValidator<Foo>
{

    public FooValidator()
    {
        // TODO: send context instance (Foo object) to each BarValidator?
        RuleFor(f => f.Bars).SetCollectionValidator(new BarValidator(/* my context instance here */ ));
    }
}

public class BarValidator : AbstractValidator<Bar>
{
    private IEnumerable<Bar> BarList { get; set; }

    public BarValidator(){ /* this is what the validator factory currently uses but i want to use the one that passes the fooInstance some how */ }

    public BarValidator(Foo fooInstance)
    {
        BarList = fooInstance.Bars.Where(b => b != null).ToList();

        // some function here to validate the Bizz property based on other Bar objects in the BarList collection
        RuleFor(f => f.Bizz).NotEmpty()/* .SomeBizzSiblingFunction() */;

    }
} 
```

当我使用这个 Ninject Validator Factory 时

```
public class NinjectValidatorFactory : ValidatorFactoryBase
{
    /// <summary>
    /// Initializes a new instance of the <see cref="NinjectValidatorFactory"/> class.
    /// </summary>
    /// <param name="kernel">The kernel.</param>
    public NinjectValidatorFactory(IKernel kernel)
    {
        Kernel = kernel;
    }

    /// <summary>
    /// Gets or sets the kernel.
    /// </summary>
    /// <value>The kernel.</value>
    public IKernel Kernel { get; set; }

    /// <summary>
    /// Creates an instance of a validator with the given type using ninject.
    /// </summary>
    /// <param name="validatorType">Type of the validator.</param>
    /// <returns>The newly created validator</returns>
    public override IValidator CreateInstance(Type validatorType)
    {
        if (((IList<IBinding>)Kernel.GetBindings(validatorType)).Count == 0)
        {
            return null;
        }

        return Kernel.Get(validatorType) as IValidator;
    }
} 
```

并将相关的验证器工厂添加到 MVC ModelValidatorProviders 并绑定它们。

```
ModelValidatorProviders.Providers.Add(new FluentValidationModelValidatorProvider(new NinjectValidatorFactory(kernel)));

DataAnnotationsModelValidatorProvider.AddImplicitRequiredAttributeForValueTypes = false;

AssemblyScanner.FindValidatorsInAssemblyContaining<FooValidator>()
                            .ForEach(match => kernel.Bind(match.InterfaceType).To(match.ValidatorType).InRequestScope()); 
```

所以它最终可以在控制器中像这样使用，所以我不必每次都新建一个验证器..但我还需要在验证时传递相关的上下文实例。

```
public class FooController : Controller {
    public ActionResult Create() {
        return View();
    }

    [HttpPost]
    public ActionResult Create(Foo foo) {

        if(! ModelState.IsValid) { // re-render the view when validation failed.
            return View("Create", foo);
        }

        return RedirectToAction("Index");

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T20:03:51.223

我找到了一种方法。见下文：

```
public class FooValidator : AbstractValidator<Foo>, IValidatorInterceptor   
{

    public FooValidator() { }

    public ValidationContext BeforeMvcValidation(ControllerContext controllerContext, ValidationContext validationContext)
    {
        RuleFor(f => f.Bar).SetCollectionValidator(new BarValidator(validationContext.InstanceToValidate as Foo));

        return validationContext;
    }

    public ValidationResult AfterMvcValidation(ControllerContext controllerContext, ValidationContext validationContext, ValidationResult result)
    {
        return result;
    }
} 
```

使用验证器拦截器并在 BeforeMvcValidation 方法中而不是在构造函数中应用规则。然后将验证上下文实例传递给 BarValidator。

# c# - 如何设置 Xamarin MonoMac 项目，使其生成输出 .app 包而不是 .exe？

> ID：15853994
> 
> 赞同：3
> 
> 时间：2013-04-06T17:34:49.830
> 
> 标签：c#, macos, xamarin, monomac

在 Xamarin 中构建 MonoMac 项目时，我试图将 Mac 包 (.app) 作为构建输出。这个项目实际上是一个默认项目 - 它只显示一个空窗口，可以通过以下方式在 Xamarin 中创建：*Add New Project...*，选择*Mac(open source)*，然后选择*MonoMac Project (C#)*。

项目构建没有错误，但构建输出是 .exe 文件。**如何设置项目构建以输出 .app 包而不是 .exe？**我查看了*Project Options-->Build-->General*在哪里可以选择*Compile Target* as *Executable/Executable with GUI/...* 但这不是我需要的。还查看了 Xamarin studio *Preferences-->Projects-->Build*但它也没有帮助。

我的设置：

```
 - Xamarin studio 4.0.3 (build 13) which includes free MonoMac 
 - Xcode 4.6.1 (2067, build 4H512); gcc installed 
 - Mono frameworks 2.10.9 and 2.10.12 
 - all running on Mac OS X 10.7.5 
```

Debug|x86 构建配置的构建输出： ![Debug|x86 构建配置的构建输出：](https://i.stack.imgur.com/hRsEa.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T10:03:00.287

查看生成exe的位置：

**/Users/rolf/Projects/test-project/bin/Debug/test-project.app** /Contents/MonoBundle/test-project.exe _

输出始终是一个 .app 包，exe 只是一个进入 .app 包的文件。

# regex - 如何使用反向引用突出显示所有匹配项？

> ID：15853999
> 
> 赞同：0
> 
> 时间：2013-04-06T17:35:22.333
> 
> 标签：regex, search, vim, match

我有这个：

`/\(\d\{4}_\d\{2}_\d\{2}\).*\1`

在同一行中查找双日期。

我想突出显示（如在正常搜索中）找到的所有匹配项（不仅是上述正则表达式中的第一个匹配项）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T18:38:20.843

您正在使用[Vim](http://www.vim.org)，我从问题标签中收集到。在 Vim 中，激活[hlsearch](http://vimdoc.sourceforge.net/htmldoc/options.html#%27hlsearch%27)：

```
:set hlsearch 
```

然后像这样搜索：

```
/\d\{4}_\d\{2}_\d\{2}[^0-9]*\d\{4}_\d\{2}_\d\{2} 
```

这会突出显示整个文件中一行中的所有双日期。正则表达式假定日期之间的空格由非数字字符填充。

正则表达式的插图： ![正则表达式的插图](https://i.stack.imgur.com/wQVYg.gif)