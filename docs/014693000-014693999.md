# StackOverflow 问答 14693000-14693999

# php - foreach 中的两个条件

> ID：14693003
> 
> 赞同：4
> 
> 时间：2013-02-04T18:23:51.373
> 
> 标签：php, mysql

```
 foreach(($no_items as $key=>$txt ) && ($b_cost as $key=>$txt1 ))
    {
    $sql1 = "INSERT INTO bulk_s (`no_items`,`b_cost`) VALUES ('$txt[$key]','$txt1[$key]')       ";
    } 
```

我的 php 页面中有两个动态创建的数组，我需要将它们的值存储在数据库的同一行中

我的js代码

```
 function changeIt()
    {
    my_div.innerHTML = my_div.innerHTML +"<br> items <input type='text'  name='txt[]'+ i>"

    my_div.innerHTML = my_div.innerHTML +" cost <input type='text'  name='txt1[]'+ j>"
    i++;
    j++;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:41:24.487

您的`foreach`语法不是有效的 PHP。如果要同时迭代两个具有相同键的数组，则必须迭代键：

```
foreach (array_keys($no_items) as $key) {
    $txt = $no_items[$key];
    $txt1 = $b_cost[$key];
    $sql1 = "INSERT INTO bulk_s …";
} 
```

但是，请注意，[您**永远不**应该像这样构造 SQL 语句](http://xkcd.com/327/)，这会使它们容易受到[SQL 注入](https://en.wikipedia.org/wiki/SQL_injection)的影响。这是一种不可接受的编码做法。在最好的情况下，它会使您的程序不那么优雅，在最坏的情况下，它会让您面临诉讼，并且[有一个非常简单的优越解决方案](http://php.net/manual/en/pdo.prepared-statements.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:35:51.457

试试这样

```
 $i = 0;
foreach($no_items as $key=>$items) {

   $data[$i] = array(
           'variable1' => $items['no_items'],
           'variable2' => $items['b_cost'],
   );
    $sql1 = "INSERT INTO bulk_s (`no_items`,`b_cost`) VALUES ('$data['variable1']','$data['variable2']')       ";
   $i++;

 } 
```

# java - 获取 mySQL 表并创建 Hibernate bean 的任何快速方法

> ID：14693005
> 
> 赞同：0
> 
> 时间：2013-02-04T18:23:56.983
> 
> 标签：java, mysql, hibernate, spring-mvc

我刚开始工作的公司必须使用大约 200 个 MySQL 表并从中制作 Java、Hibernate Bean。我们正在开发 Spring MVC Web 项目。有谁知道任何可以从 mySQL 表中为我们提供 Java 代码的工具或产品>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:27:26.603

Eclipse（和 Hibernate Tools）有很多自动生成代码的功能。我假设其他 IDE 也一样。演练： http: [//www.wikihow.com/Generate-Hibernate-Pojo-Classes-from-DB-Tables](http://www.wikihow.com/Generate-Hibernate-Pojo-Classes-from-DB-Tables)

# c# - IIS 中的 WCF EntityFrameWork 异常

> ID：14693008
> 
> 赞同：1
> 
> 时间：2013-02-04T18:24:04.163
> 
> 标签：c#, wcf, entity-framework

我需要帮助配置通过 EF 访问 SQL 数据库的 WCF 服务。当我通过 Visual Studio 在本地启动它时，该服务运行良好，但是当我将它部署到另一台服务器并通过我的客户端应用程序访问它时，我不断收到“{”从数据库获取提供程序信息时发生错误。这可能是由 Entity Framework 使用不正确的连接字符串引起的。检查内部异常以获取详细信息并确保连接字符串正确。“}”错误。

在将服务发布到服务器之前，我的连接字符串是：

```
<configSections>
  <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
  <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
</configSections>
<entityFramework>
  <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework"/>
</entityFramework>
<connectionStrings>
  <add name="DefaultConnection" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-ECUWebUi-20121116095239;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-ECUWebUi-20121116095239.mdf" />
</connectionStrings> 
```

我发布后的连接字符串：

```
<configSections>
  <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
  <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
</configSections>
<entityFramework>
  <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" />
</entityFramework>
<connectionStrings>
  <add name="DefaultConnection" providerName="System.Data.SqlClient" connectionString="Data Source=localhost; Integrated Security=SSPI; Initial Catalog=ECUWeb-Staging;User ID=user;Password=password" />
</connectionStrings> 
```

这是对服务中 EF 上下文的调用：

```
public RegisterResponse Register(RegisterRequest request)
{
    EfDataAccessFactory factory = new EfDataAccessFactory(new DtoMapper());
    RegisterResponse response = new RegisterResponse();

    if (request.Computer.Exists())
    {
        factory.ComputerDataAccess.Update(request.Computer);
        response.Message = string.Format("{0} is already registered.", request.Computer.Name);
    }
    else
    {
        request.Computer = factory.ComputerDataAccess.Insert(request.Computer);
        response.Message = string.Format("{0} registered with id: {1}", request.Computer.Name, request.Computer.Id);
    }

    RegisterInstances(request);

    return response;
} 
```

有什么建议么？内部异常也是空的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:40:18.330

修复它我必须添加：

```
<add name="DefaultConnection" providerName="System.Data.SqlClient" connectionString="Data Source=localhost;Initial Catalog=ECUWeb-Staging;User Id = user; Password = password" />
    <add name="EcuWeb.Data.EcuWebDataContext" connectionString="Data Source=localhost;Initial Catalog=ECUWeb-Staging; User Id = user; Password = password" providerName="System.Data.SqlClient" /> 
```

然后它工作没有问题。

# c++ - std::wstring 的标准定义字节顺序是什么？

> ID：14693016
> 
> 赞同：4
> 
> 时间：2013-02-04T18:24:29.747
> 
> 标签：c++, string, unicode, standards, endianness

我知道 UTF-16 有两种字节序：大字节序和小字节序。

C++ 标准是否定义了 std::wstring 的字节顺序？或者它是实现定义的？

如果是标准定义的，C++ 标准的哪一页提供了关于这个问题的规则？

如果是实现定义的，如何确定？例如在 VC++ 下。编译器是否保证 std::wstring 的字节序严格依赖于处理器？

我必须知道这一点；因为我想将 UTF-16 字符串发送给其他人。我必须在 UTF-16 字符串的开头添加正确的 BOM 以指示其字节顺序。

**简而言之：给定一个 std::wstring，我应该如何可靠地确定它的字节顺序？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T18:32:10.387

Endianess 是 MACHINE 相关的，而不是语言相关的。Endianess 由处理器定义，以及它如何安排数据进出内存。在处理 wchar_t（比单个字节宽）时，处理器本身在读取或写入时会根据需要对齐多个字节，以便再次将其读取或写入 RAM。代码只是将其视为处理器内部寄存器中表示的 16 位（或更大）字。

为了确定（如果这确实是您想要做的）字节顺序（您自己），您可以尝试将一个已知的 32 位（无符号整数）值写入 ram，然后使用 char 指针将其读回。查找返回的订单。

它看起来像这样：

```
unsigned int aVal = 0x11223344;
char * myValReadBack = (char *)(&aVal);

if(*myValReadBack == 0x11) printf("Big endian\r\n");
else                       printf("Little endian\r\n"); 
```

我确定还有其他方法，但是像上面这样的方法应该可以工作，尽管检查我的小与大:-)

此外，直到 Windows RT，VC++ 才真正只编译到英特尔类型的处理器。他们真的只有一种字节序类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:27:27.740

它是实现定义的。wstring 只是 wchar_t 的字符串，它可以是任何字节顺序，或者就此而言，任何旧大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T18:41:45.663

`wchar_t`内部不需要是 UTF-16，并且 UTF-16 字节序不会影响 wchar 的存储方式，它是保存和读取它的问题。

在将它发送到任何地方之前，您必须使用将 wstring 转换为 UTF-16 字节流的显式过程。wchar 的内部字节序依赖于体系结构，最好使用一些不透明的接口进行转换，而不是尝试手动转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T20:44:49.887

为了发送正确的 BOM，您不需要知道字节顺序。只需使用代码 \uFEFF。这将是 bigendian 或 little-endian，具体取决于您的实现的字节序。您甚至不需要知道您的实现是 UTF-16 还是 UTF-32。只要它是某种 unicode 编码，您就会得到适当的 BOM。

不幸的是，wchars 和宽流都不能保证是 unicode。

# ubuntu - JUnit 找不到类

> ID：14693017
> 
> 赞同：0
> 
> 时间：2013-02-04T18:24:30.433
> 
> 标签：ubuntu, junit4, selenium-ide

我是 JUnit 和 selenium 服务器的新手，因此不胜感激。

我正在使用 java 7 和 selenium ide 和服务器运行 ubuntu 12。我使用 selenium IDE 创建了一个简单的登录测试脚本，并将其导出到 Java/Junit4/webdriver。

然后我使用以下命令编译了该脚本

```
javac -cp .:/usr/share/java/junit4.jar -cp .:/home/sakamoto/SeleniumServer/selenium-server-standalone-2.28.0.jar LoginTest.java 
```

这似乎没有任何错误（或就此向终端发送任何消息）。

我在尝试运行从 selenium ide 导出到 JUnit4 webdriver 生成的单元测试时看到此错误：

```
java -cp /home/sakamoto/SeleniumServer/selenium-server-standalone-2.28.0.jar org.junit.runner.JUnitCore com.example.tests.LoginTest
JUnit version 4.11
Could not find class: com.example.tests.LoginTest

Time: 0.001

OK (0 tests)

sakamoto@ubuntu:~/Workspace$ 
```

我的 .bashrc 文件末尾还有以下几行，并且能够使用 junit4 运行示例测试。

```
export CLASSPATH=.:/usr/share/java/junit4.jar
export CLASSPATH=.:/usr/share/java/junit.jar 
```

所以......我如何摆脱找不到类：问题并运行脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:34:03.270

似乎 junit 在类路径中找不到您的 LoginTest.class 文件。

假设您有这样的目录结构：

```
/home/sakamoto/my-project/com/examples/tests/LoginTest.class 
```

然后，尝试在类路径中显式包含`my-project`目录的路径。例如，试试这个：

```
 java -cp /home/sakamoto/SeleniumServer/selenium-server-standalone-2.28.0.jar:/home/sakamoto/my-project org.junit.runner.JUnitCore com.example.tests.LoginTest 
```

我认为junit是使用类路径+包名来确定LoginTest测试的位置。我猜测/希望 junit 会 1) find`/home/sakamoto/my-project`在类路径中，它会 2) 附加包目录`com/examples/tests`，以便它在内部查找 LoginTest.class `/home/sakamoto/my-project/com/examples/tests`。

自从我使用硒已经有一段时间了，不幸的是，我没有设置硒，否则我会测试这个！但希望这行得通。

# c# - 以表格格式打印数据

> ID：14693019
> 
> 赞同：1
> 
> 时间：2013-02-04T18:24:33.467
> 
> 标签：c#, winforms, tabular

所以我有一些数据存储到一个对象中，我需要检索数据并以表格格式输出。我尝试过使用格式说明符，并且由于字符的宽度，信息会发生变化。我需要创建类似于表格的东西，返回该对象，然后能够在一张纸上打印信息而不打印单元格线。我尝试了一个数据表，但我看不到表中的信息。最简单的方法是什么？它是一个 Windows 窗体应用程序。用户将信息保存在 3 个类中。使用列表。我尝试使用空格和 \t 来制表格式。但是根据字符的宽度，格式会偏离几个空格。数据的长度也可以在 1-3 个字符之间来回变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:31:51.137

只需从对象填充数据表并将 datagridview 源设置为数据表。

```
public class Form1
{
    public void BuildDataTable()
    {
        DataTable dt = new DataTable("Customers");  
        dt.Columns.Add(new DataColumn("LastName")); 
        dt.Columns.Add(new DataColumn("FirstName")); 

        // Populate the table 
        dt.Rows.Add("Baggins", "Bilbo");
    }

    private void Button2_Click(System.Object sender, System.EventArgs e)
    {
        PrintDocument1.Print();
    }

    private void PrintDocument1_PrintPage(object sender, PrintPageEventArgs e)
    {
         Bitmap bm = new Bitmap(this.DataGridView1.Width, this.DataGridView1.Height);
         DataGridView1.DrawToBitmap(bm, new Rectangle(0, 0, this.DataGridView1.Width, this.DataGridView1.Height));
         e.Graphics.DrawImage(bm, 0, 0);
    }
} 
```

# vim - Vim 中类似 Sublime 代码的方法浏览器

> ID：14693020
> 
> 赞同：5
> 
> 时间：2013-02-04T18:24:33.850
> 
> 标签：vim, editor, sublimetext, vim-plugin

Sublime 代码有一个快捷方式 Super-R，它打开一个方法浏览器，列出当前类 (Ruby) 中的所有方法。是否有插件可以在 Vim 中获得类似的功能？

“/def”或“m]”仅在您熟悉该类并知道要使用哪种方法时才有效，而 Super+R 仅适用于探索类。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T20:18:35.507

[TagList](http://www.vim.org/scripts/script.php?script_id=273)插件是另一个（非常流行的）选项。还有一堆[其他](http://www.vim.org/scripts/script_search_results.php?keywords=tags&script_type=&order_by=creation_date&direction=descending&search=search)的。

仅供参考，`/def`并不`m]`等同于 Sublime Text 的`Ctrl`+ `R`。如果`:tag foo`您不知道方法的所有名称，您可以使用制表符完成。

当我们使用它时，[CtrlP](http://www.vim.org/scripts/script.php?script_id=3736)`Ctrl`插件有一个与 Sublime Text 的+非常相似的功能`R`：`:CtrlpBufTag`我每天使用数百次。

所有这些方法都依赖于[Exuberant Ctags](http://ctags.sourceforge.net/)或某些兼容程序`tags`生成的文件的存在。实际上，标签是 Vim 体验中相当重要的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T13:01:14.177

你可以使用我的项目[https://github.com/fatih/subvim](https://github.com/fatih/subvim)

因为`cmd+r`您可以即时直接跳转到任何定义。无需生成标签或其他任何东西。目前 ctags 支持的任何语言都可以使用此功能。我还添加了 Go、Coffeescript、Objective-C 等语言……这意味着只需启动它。

它还支持类似 Sublime 的功能（意味着不需要插件）。因此，您可以使用以下快捷方式：

*   `cmd + p`-> 去任何地方
*   `cmd + t`-> 转到文件
*   `cmd + r`-> 转到符号
*   `cmd + k`-> 显示侧边栏
*   `cmd + /`-> 切换评论
*   `cmd + [`-> 缩进
*   `cmd + ]`-> 取消缩进
*   `cmd + <number>`-> 跳转到标签 1、标签 2、...
*   `cmd + alt + left`-> 移动到下一个标签
*   `cmd + alt + right`-> 移动到上一个选项卡
*   `cmd + z`-> 撤消
*   `cmd + shift + z`-> 重做
*   `cmd + s`-> 保存文件
*   `cmd + w`-> 关闭
*   `cmd + f`-> 搜索

此外，自动补全、恢复最新会话、自动括号关闭和许多小改动使其真正使用起来非常愉快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T18:37:19.940

tagbar插件与 Ruby 文件[配合](http://majutsushi.github.com/tagbar/)得很好。也许它与 Sublime Super-R 并不完全相同，但它确实为您提供了一种快速简便的方式来探索课程。

# python - Python 中的 KeyError (Last.fm/@attr)

> ID：14693021
> 
> 赞同：0
> 
> 时间：2013-02-04T18:24:34.443
> 
> 标签：python, json, last.fm

我正在使用 last.fm-API。

我当前播放的歌曲有问题。以下是 JSON 输出的示例：

```
{"recenttracks":{"track":[{"artist":{"#text":"Gorillaz","mbid":"e21857d5-3256-4547-afb3-4b6ded592596"},"name":"Feel Good Inc - Single Edit","streamable":"0","mbid":"","album":{"#text":"","mbid":""},"url":"http:\/\/www.last.fm\/music\/Gorillaz\/_\/Feel+Good+Inc+-+Single+Edit","image":[{"#text":"","size":"small"},{"#text":"","size":"medium"},{"#text":"","size":"large"},{"#text":"","size":"extralarge"}],"@attr":{"nowplaying":"true"}},{"artist":{"#text":"Infected Mushroom","mbid":"eab76c9f-ff91-4431-b6dd-3b976c598020"},"name":"Muse Breaks RMX","streamable":"1","mbid":"","album":{"#text":"IM the Supervisor","mbid":"34ffab65-62d4-3cab-a6f6-043dd798fec7"},"url":"http:\/\/www.last.fm\/music\/Infected+Mushroom\/_\/Muse+Breaks+RMX","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/64129101.jpg","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/64129101.jpg","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/64129101.jpg","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/64129101.jpg","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 17:48","uts":"1360000129"}},{"artist":{"#text":"Eminem","mbid":"b95ce3ff-3d05-4e87-9e01-c97b66af13d4"},"name":"Lose Yourself","streamable":"0","mbid":"047a94b1-c42e-4867-8aa5-36d8c1f57d00","album":{"#text":"Lose Yourself","mbid":"0dc7d254-c4bf-4101-8f90-27a2f721722e"},"url":"http:\/\/www.last.fm\/music\/Eminem\/_\/Lose+Yourself","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/82366349.png","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/82366349.png","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/82366349.png","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/82366349.png","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 17:43","uts":"1359999789"}},{"artist":{"#text":"Eminem","mbid":"b95ce3ff-3d05-4e87-9e01-c97b66af13d4"},"name":"Mockingbird","streamable":"0","mbid":"0f530514-9275-45f4-a5d5-0264374c1261","album":{"#text":"Curtain Call","mbid":""},"url":"http:\/\/www.last.fm\/music\/Eminem\/_\/Mockingbird","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/81765923.png","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/81765923.png","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/81765923.png","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/81765923.png","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 17:38","uts":"1359999537"}},{"artist":{"#text":"Macklemore & Ryan Lewis","mbid":""},"name":"Thrift Shop - feat. Wanz","streamable":"0","mbid":"","album":{"#text":"Thrift Shop","mbid":""},"url":"http:\/\/www.last.fm\/music\/Macklemore+&+Ryan+Lewis\/_\/Thrift+Shop+-+feat.+Wanz","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85090943.png","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85090943.png","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85090943.png","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85090943.png","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 17:34","uts":"1359999255"}},{"artist":{"#text":"Macklemore & Ryan Lewis","mbid":""},"name":"Thrift Shop - feat. Wanz","streamable":"0","mbid":"","album":{"#text":"Thrift Shop","mbid":""},"url":"http:\/\/www.last.fm\/music\/Macklemore+&+Ryan+Lewis\/_\/Thrift+Shop+-+feat.+Wanz","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85090943.png","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85090943.png","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85090943.png","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85090943.png","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 17:29","uts":"1359998975"}},{"artist":{"#text":"Callejon","mbid":"97501ef9-b868-4d05-89d8-6161ccdf8d3f"},"name":"Alles nur geklaut","streamable":"1","mbid":"","album":{"#text":"Man spricht Deutsch","mbid":"d57af610-0996-41ff-9493-b6c5bff5da3e"},"url":"http:\/\/www.last.fm\/music\/Callejon\/_\/Alles+nur+geklaut","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85713183.jpg","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85713183.jpg","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85713183.jpg","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85713183.jpg","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 16:24","uts":"1359995076"}},{"artist":{"#text":"Callejon","mbid":"97501ef9-b868-4d05-89d8-6161ccdf8d3f"},"name":"Ein Kompliment","streamable":"1","mbid":"","album":{"#text":"Man spricht Deutsch","mbid":"d57af610-0996-41ff-9493-b6c5bff5da3e"},"url":"http:\/\/www.last.fm\/music\/Callejon\/_\/Ein+Kompliment","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85713183.jpg","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85713183.jpg","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85713183.jpg","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85713183.jpg","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 16:18","uts":"1359994723"}},{"artist":{"#text":"Callejon","mbid":"97501ef9-b868-4d05-89d8-6161ccdf8d3f"},"name":"Mein Block","streamable":"1","mbid":"","album":{"#text":"Man spricht Deutsch","mbid":"d57af610-0996-41ff-9493-b6c5bff5da3e"},"url":"http:\/\/www.last.fm\/music\/Callejon\/_\/Mein+Block","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85713183.jpg","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85713183.jpg","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85713183.jpg","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85713183.jpg","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 16:14","uts":"1359994490"}},{"artist":{"#text":"Callejon","mbid":"97501ef9-b868-4d05-89d8-6161ccdf8d3f"},"name":"Durch den Monsun","streamable":"1","mbid":"","album":{"#text":"Man spricht Deutsch","mbid":"d57af610-0996-41ff-9493-b6c5bff5da3e"},"url":"http:\/\/www.last.fm\/music\/Callejon\/_\/Durch+den+Monsun","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85713183.jpg","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85713183.jpg","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85713183.jpg","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85713183.jpg","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 16:11","uts":"1359994270"}},{"artist":{"#text":"Callejon","mbid":"97501ef9-b868-4d05-89d8-6161ccdf8d3f"},"name":"Ich Find Dich Schei\u00dfe","streamable":"1","mbid":"","album":{"#text":"Man spricht Deutsch","mbid":"d57af610-0996-41ff-9493-b6c5bff5da3e"},"url":"http:\/\/www.last.fm\/music\/Callejon\/_\/Ich+Find+Dich+Schei%C3%9Fe","image":[{"#text":"http:\/\/userserve-ak.last.fm\/serve\/34s\/85713183.jpg","size":"small"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/64s\/85713183.jpg","size":"medium"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/126\/85713183.jpg","size":"large"},{"#text":"http:\/\/userserve-ak.last.fm\/serve\/300x300\/85713183.jpg","size":"extralarge"}],"date":{"#text":"4 Feb 2013, 16:08","uts":"1359994098"}}],"@attr":{"user":"xxxx","page":"1","perPage":"10","totalPages":"2029","total":"20285"}}} 
```

如您所见，当前正在播放的第一首歌曲有一个@attribute

```
"@attr":{"nowplaying":"true"} 
```

这是一些代码：

```
info = last.read('user.getRecentTracks', user='xxxx')
for track in info['recenttracks']['track']:
        title = track['name']
        url = track['url']
        by = track['artist']['#text']
        form = '#np ' + by + ' - ' + title + ' ' + url

        np = track['@attr']['nowplaying'] 
```

一切正常，除了`np`！`@`是不是因为

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:29:43.893

不是所有的轨道都有*key*`@attr`，先测试一下：

```
np = track['@attr']['nowplaying'] if '@attr' in track else '' 
```

事实上，只有第*一个*条目有该键，可能是因为您一次只播放一首曲目，即播放曲目列表中最顶部的曲目。

# java - 将字符串拆分为字符串数组

> ID：14693025
> 
> 赞同：1
> 
> 时间：2013-02-04T18:24:46.257
> 
> 标签：java, android, arrays, split

所以我目前将一堆字符串标题一起存储到用户手机上的一个文件中，然后稍后读取（当他们重新启动应用程序时）。我正在尝试读回字符串并将其拆分为我为其设置的分隔符，但由于某种原因它拆分它然后将字符串加倍......

因此，例如，如果我存储了这些字符串

瑞奇（哈）鲍比（哈）是（哈）酷（哈）

(har) 是我用来存储它们的分隔符。（例如）

出于某种原因，当我在“har”上使用拆分功能时

它给了我一个字符串数组，但是将我存储的数量翻了一番......所以字符串数组将有两个 Ricky 的两个 Bobby 的两个 is 和两个 cool 的。老实说，我不知所措。盯着这个看了好几个小时……有人知道吗？

```
line = BR.readLine();
            String[] each = line.split("<TAG>");
            for (int i = 0; i < each.length; i++) {
                listOfCourses.add((each[i]));
                //Toast.makeText(context, each[i], Toast.LENGTH_SHORT).show();
            } 
```

这是将数据存储到用户手机的函数

```
//adds data into the classes file on user's phone
    public void addClassesIntoFile(Context context, ArrayList<String> classList) {
        try {
            FileOutputStream fos = context.openFileOutput(CLASSLIST_FILENAME,
                    Context.MODE_PRIVATE | Context.MODE_APPEND);
            OutputStreamWriter osw = new OutputStreamWriter(fos);
            for (int i = 0; i < classList.size(); i++) {
                osw.write(classList.get(i) + "<TAG>");
            }
            osw.flush();
            osw.close();
        } catch (FileNotFoundException e) {
            // catch errors opening file
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:32:40.187

我不相信您的拆分功能是问题，而是认为它与您的代码的其他部分有关。

1.  进行`String`拆分之前是否正确？或者你看到里面有重复吗？
2.  我想问题出在你的`addClassIntoFile`方法上。由于您要追加到 中`File`，因此请确保您没有重新添加已经存在的值。除非您在某个时候删除该文件，否则它会在下次启动应用程序时保留。
3.  最后确保你没有打电话给`addClassIntoFile`你的意思。IE，不小心在给定对象上多次调用它。

如果我在这一切上都不正确，那么请发布`String`一个拆分前的示例，以便我们确定给定的正则表达式是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:38:14.110

代替：

```
String[] each = line.split("<TAG>")` 
```

有了这个：

```
String[] each= line.split("[(har)]"); 
```

如果还有错，请告诉我

# c++ - 从文本框获取输入 Visual C++ 2010 Express

> ID：14693026
> 
> 赞同：-1
> 
> 时间：2013-02-04T18:24:50.713
> 
> 标签：c++, winapi, visual-c++, c++-cli

我是新来的，希望能从一个很棒的社区学到很多东西。

我开始学习一些 GUI C++ 编程，但只是基础知识。在使用 mingw 并创建自己的资源和头文件之前，我已经制作了一个 win32 GUI 应用程序。此时我需要程序做的就是从文本框中获取文本。

使用 mingw，我会使用这样的回调函数，当单击某个按钮时，使用 GetDigItem() 从文本框中获取用户输入。

```
LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    switch(msg)
    {
    case WM_LBUTTONDOWN:
         {
              char szFileName[MAX_PATH];
              HINSTANCE hInstance = GetModuleHandle(NULL);
              GetModuleFileName(hInstance, szFileName, MAX_PATH);
              MessageBox(hwnd, szFileName, "This program is:", MB_OK | MB_ICONINFORMATION);

         }
    break;

    case WM_CLOSE:
        DestroyWindow(hwnd);
    break;

    case WM_DESTROY:
        PostQuitMessage(0);
    break;

    case WM_COMMAND:
         switch(LOWORD(wParam))
             {
                 case ID_FILE_EXIT:
                      DestroyWindow(hwnd);
                      break;
                 case ID_STUFF_GO:
                      break;

                 case REG_BUTTON:
                 char NameInput[MAX_PATH];

                 // Gets inputted info from text boxes

                 // this is what I want to do in vc++
                 GetWindowText(GetDlgItem(hwnd, NAME_BOX), NameInput, MAX_PATH);

                 break;

    case WM_CREATE:
    {    

         CreateWindow (TEXT("EDIT"), TEXT("Name Here"), WS_VISIBLE | WS_CHILD | WS_BORDER, 10, 10, 230, 20, hwnd, (HMENU) NAME_BOX, NULL, NULL);
         CreateWindow (TEXT("EDIT"), TEXT("Number Here"), WS_VISIBLE | WS_CHILD | WS_BORDER, 10, 35, 230, 20, hwnd, (HMENU) SERIAL_BOX, NULL, NULL);
         CreateWindow (TEXT(button), TEXT(button1), WS_VISIBLE | WS_CHILD, 75, 60, 90, 20, hwnd, (HMENU) REG_BUTTON, NULL, NULL); 
```

我注意到 VC++ 中的代码有点不同。我从 Windows 窗体设计器创建了一个按钮和文本框。我已经设法操纵输入的信息，并将其显示在文本框中，但我需要获取输入的信息并将其作为 char、std::string 等返回。这是我有问题的代码，它不按原样编译。

```
private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) 
     {
         // Storage buffer for serial and name

          std::string test;

                      // Upon button click, this will transfer inputted text to the label next to it
                      label1->Text = textBox1->Text;

          // this does not compile            
                      test = textBox1->Text;

                      // Gets inputted info from text boxes
                      // This does not compile either
                      //GetWindowText(GetDlgItem(NULL, textBox1), NameInput, MAX_PATH);
                      //GetWindowText(GetDlgItem(NULL, textBox2), SerialInput, MAX_PATH); 
```

有没有人知道如何在文本框中获取输入的信息以作为 char、char*、(std::)string 或其他类型返回以进行进一步操作？谢谢。

编辑-

我想出了在 mingw 中我可以使用 GetDigItem() 来返回用户输入的位置，我在 VC++ 中通过使用 System::String^ 来执行此操作，如下面的代码所示。

```
private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) 
     {

                        label1->Text = textBox1->Text;

            //char SerialInput[MAX_PATH];
                        //test -> textBox1->Text

                        // The following compiles and works to retrieve input
                        // as a System::String^
                System::String^ userinput;
            textBox1->Text = userinput;

                        // However this yields 2 compiler error
                        // error C2065: 'marshal_as' : undeclared identifier
                        // error C2275: 'std::string' : illegal use of this type as an expression
                        std::string stdString = marshal_as<std::string>(newer);

                        // Forgive any spacing errors, this 4 space indent to repr code
                        // isn't working with my long expressions 
```

现在的问题似乎是让 System::String^ 成为我可以使用的东西。我尝试将其转换为 std::string 并没有像我展示的那样工作，我还包含在我的 stdafx.h 中。一个字符或任何东西都会很棒。有任何想法吗？

编辑2：

我需要将 SYStem::String^ 转换为我可以转换的任何其他内容（最好是 std::string 或 char）。这是我尝试过的，并且收到了编译器错误。

```
System::String^ userinput;
userinput = textBox1->Text;

// method 1
const __wchar_t __pin * str1 = PtrToStringChars(userinput);

// error recieved
error C4980: '__pin' : use of this keyword requires /clr:oldSyntax command line option

// method 2
char* str2 = (char*)(void*)Marshal::StringToHGlobalAnsi(str);

// error recieved
error C2653: 'Marshal' : is not a class or namespace name
error C3861: 'StringToHGlobalAnsi': identifier not found

// method 3
// #include <atlstr.h>
// CString str3(userinput); 

// error recieved
fatal error C1083: Cannot open include file: 'atlstr.h': No such file or directory
// Where can I get this header file from? 
```

我觉得有一些明显的事情我没有做......

PS - 微软称它为 Visual C++ 非常误导，因为这不是 C++！

PSS - 对于任何阅读本文的 C++ 编码人员，VC++ 都有自己的标准和语言，与传统的 C++ 甚至 win api 完全不同。这是最好的复杂性 - 帮自己和您的客户一个忙，坚持使用 QT 来赢得胜利！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:25:07.407

您应该指出您正在使用哪个框架（例如，MFC 或 WTL），并给出具体的编译器错误，而不是简单地说它不能编译。没有更多信息，我猜这是问题所在：

```
std::string test;
test = textBox1->Text; 
```

文本字段可能是一个宽字符串。（Windows 内部使用 UTF-16，所以 - 在 Windows 上 - std::wstring 是一个 16 位字符值的字符串。大多数 Windows 函数处理访问 BMP 之外的字符的代理项。在其他操作系统上，std:: wstring 通常是一个 32 位字符值的字符串。）

您不能在没有转换的情况下将宽字符串分配给 a `std::string`。您的选择是使用宽字符串（例如，`std::wstring`）或应用转换。

对于转换，Windows 具有[`WideCharToMultibyte`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd374130%28v=vs.85%29.aspx)您可以使用的功能。C++ 有[`std::codecvt`](http://en.cppreference.com/w/cpp/locale/codecvt).

# python - Process.StandardOutput.Readline() 在 Mono 上挂起，但在 .NET 上没有

> ID：14693029
> 
> 赞同：2
> 
> 时间：2013-02-04T18:24:55.380
> 
> 标签：python, mono, stdout, stdin

我试图让一个在 Mono（在 Ubuntu 上）上运行的 C# 程序调用 python 脚本，将数据发送到它的标准输入，并从它的标准输出读回数据。下面的测试代码抓住了基本思想：

```
var startInfo = new ProcessStartInfo("python");
startInfo.Arguments = "./hello.py";
startInfo.UseShellExecute = false;
startInfo.RedirectStandardInput = true;
startInfo.RedirectStandardOutput = true;

var p = Process.Start(startInfo);
if(p.HasExited)
    return;

p.StandardInput.WriteLine("Bob");
var result = p.StandardOutput.ReadLine();
Console.WriteLine("Result: {0}", result); 
```

hello.py 的代码很简单：

```
#!/usr/bin/python
line = raw_input()
while len(line) > 0:
    print("Hello " + line)
    line = raw_input() 
```

当我在 .NET/Windows 上执行此测试代码时，上面的测试按预期工作，返回结果“Hello Bob”。但在 Mono/Linux 上，C# 程序挂起对`p.StandardOutput.ReadLine();`. 知道为什么它不能在 Mono/Linux 上运行，以及我需要进行哪些更改才能使其正常运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:50:28.067

回答我自己的问题......原来这与 Mono 或 Linux 无关，而是 Python 在 Windows 和 Linux 上的行为。要让它在 Linux 上工作，需要使用 -u 标志（无缓冲输出）调用 Python，以便打印的数据实际上被刷新到标准输出。感谢 Mono 邮件列表中的“weeble”提供提示！

# java - 独立 Java 应用程序中的 PostgreSQL 安全连接

> ID：14693031
> 
> 赞同：0
> 
> 时间：2013-02-04T18:25:09.607
> 
> 标签：java, security, postgresql

我正在创建独立的应用程序（基于 Swing 的 GUI）。它就像密码持有者（例如用户指定站点的登录名/密码）

它连接到远程 psql 数据库。与数据库的连接存储在 db.properties 文件中。

我想要什么：

1.  我如何“隐藏”将取消归档我的 .jar 包的用户的数据库连接？（在最坏的情况下，至少是连接用户的密码）
2.  有什么方法可以防止反编译/调试文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:54:38.023

我建议将数据库凭据存储在环境变量中，并在值中读取源代码。

这避免了将凭据存储在源代码控制或二进制文件中，但允许您轻松配置/更改您的秘密。

这已成为[“12 要素应用程序”](http://www.12factor.net/)中包含的最佳实践，并模拟了 Heroku 和其他托管服务管理应用程序级别配置的方式。

# haskell - 递归素数检查器是如何用 Haskell 编写的？

> ID：14693032
> 
> 赞同：1
> 
> 时间：2013-02-04T18:25:10.923
> 
> 标签：haskell, primes

我对 Haskell（以及一般的函数式编程）非常陌生，我正在尝试一些基本练习来尝试理解该语言。我正在编写一个“朴素”的素数检查器，它将输入下的每个数字除以检查是否有余数。到目前为止，我学到的唯一结构是理解列表和递归函数，所以我仅限于此。这是我正在尝试的：

```
isprime 1 = False
isprime 2 = True
isprime n = isprimerec n (n-1)

isprimerec _ 1 = False
isprimerec n t = if (n `rem` t) == 0 then False else isprimerec n (n-1) 
```

目的是用户将使用`isprime n`. 然后`isprime`将用于`isprimerec`确定该数字是否为素数。这是一种非常迂回的方式，但由于我对 Haskell 的了解有限，我不知道任何其他方式。

当我尝试这个时会发生以下情况：

```
isprimerec 10 9 
```

永远运行。我必须使用 Ctrl+C 来阻止它。

```
isprimerec 10 5 
```

返回假。该`else`部分永远不会被评估，因此该函数永远不会调用自己。

我不确定为什么会这样。此外，这是否接近于 Haskell 程序员解决这个问题的方式？（我不是说检查素数，我知道这不是这样做的方法。我只是作为练习这样做）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T19:04:00.740

您的错误是一个简单的错字；最后`isprimerec`，您的第二个参数变为`n-1`而不是`t-1`. 但除此之外，该功能不是很地道。这是我如何编写它的第一遍：

```
isPrime :: (Ord a, Integral a) => a -> Bool
isPrime n | abs n <= 1 = False
isPrime 2 = True
isPrime n = go $ abs n - 1
  where go 1 = False
        go t = (n `rem` t /= 0) && go (t-1) 
```

（我可能会调用类似的`go`东西`checkDivisors`，但是`go`对于循环来说是惯用的。）请注意，这会暴露代码中的错误：一旦`go`是本地的`isPrime`，您不需要传递`n`，因此更清楚的是递归它是不正确的. 我所做的更改按重要性的粗略顺序排列：

1.  我做`isprimerec`了一个本地函数。没有其他人需要调用它，并且我们丢失了额外的参数。

2.  我把这个功能全部完成了。没有理由失败`0`，也没有任何理由因为负数失败。（从技术上讲，*p*是素数当且仅当 - *p*是素数。）

3.  我添加了一个类型签名。养成一个好习惯。使用`Integer -> Bool`, 甚至`Int -> Bool`, 也是合理的。

4.  我切换到 interCaps 而不是全小写。只是格式化，但这是习惯性的。

除了我可能会让事情变得更简洁。在 Haskell 中手动递归通常是不必要的，如果我们完全摆脱它，你的 bug 就变得不可能了。您的函数检查从`2`到的所有数字`n-1`不除`n`，因此我们可以直接表示：

```
isPrime :: (Ord a, Integral a) => a -> Bool
isPrime n | abs n <= 1 = False
          | otherwise  = all ((/= 0) . (n `rem`)) [2 .. abs n - 1] 
```

你可以把它写在一行上

```
isPrime :: (Ord a, Integral a) => a -> Bool
isPrime n = abs n > 1 && all ((/= 0) . (n `rem`)) [2 .. abs n - 1] 
```

但看到最后两种实现中的任何一种，我都不会感到惊讶。正如我所说，这些实现的好处是你的拼写错误不可能在这些表示中出现：`t`隐藏在 的定义中`all`，所以你不能不小心给它错误的值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-04T18:45:04.873

问题出在这一行

```
isprimerec n t = if (n `rem` t) == 0 then False else isprimerec n (n-1) 
```

你`(n - 1)`在它应该在的地方使用作为第二个参数`(t - 1)`。还有一点，我想你想要这个`isprimerec _ 1`案子`= True`。

至于您关于这是否是惯用的更普遍的问题，我认为您走在正确的轨道上。 `ghci`有一个不错的命令行调试器。我通过将您的代码放在一个文件中，加载它，然后发出命令来发现这一点`:break isprimerec`。然后我调用了您的函数并使用`:step`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-04T18:43:53.543

您的`else`分支已损坏，因为它`isprimerec n (n-1)`每次都调用。你可能应该改写`isprimerec n (t-1)`让它倒计时。

您还可以使用高阶函数`all`来简化此操作。

```
isprime 1 = False
isprime n = all (\t -> n `rem` t /= 0) [2..(n-1)] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T19:37:40.323

好吧，你有两个错误：你的

```
isprimerec _ 1 = False
isprimerec n t = if (n `rem` t) == 0 then False else isprimerec n (n-1) 
```

本来应该

```
isprimerec _ 1 = True
isprimerec n t = if (n `rem` t) == 0 then False else isprimerec n (t-1) 
```

或者，通过列表理解，

```
isprime n = n>1 && and [ rem n t /= 0 | t <- [n-1,n-2..2] ] 
```

（*内部*化那个额外的参数*`t`*，无论如何它是一个技术性问题！--啊哈，但是那是什么`and`，你问？就像这个递归函数一样`foldr (&&) True :: [Bool] -> Bool`。）

但是现在一个主要的*算法*缺陷在*视觉上*变得很明显：我们以*错误*的顺序进行测试。如果我们按升序测试会更快：

```
isprime n = n>1 && and [ rem n t /= 0 | t <- [2..n-1] ] 
```

`sqrt`如果我们停在,甚至更快

```
isprime n = n>1 && and [ rem n t /= 0 | t <- [2..q] ]
   where  q = floor (sqrt (fromIntegral n)) 
```

或仅在*2*之后通过*2*进行测试（如果我们已经通过*2*进行了测试，为什么要通过*6*进行测试？）：

 *```
isprime n = n>1 && and [ rem n t /= 0 | t <- 2:[3,5..q] ]
   where  q = floor (sqrt (fromIntegral n)) 
```

或仅按*素数*（如果我们已经通过*3*测试，为什么要按*9*测试？）：

 *```
isprime n = n>1 && and [ rem n t /= 0 | t <- takeWhile ((<= n).(^2)) primes ]
primes = 2 : filter isprime [3..] 
```

为什么在过滤素数时测试*偶数*- 首先不生成它们不是更好吗？

```
primes = 2 : filter isprime [3,5..] 
```

但`isprime`总是测试除以*2——*但我们只给它输入奇数；所以，

```
primes = 2 : 3 : filter (noDivs (drop 1 primes)) [5,7..]
noDivs factors n = and [ rem n t /= 0 | t <- takeWhile ((<= n).(^2)) factors ] 
```

为什么要生成*3*的倍数（即`[9,15 ..] == map (3*) [3,5..]`），只是为了稍后测试和删除它们？--

```
{-       [5,7..]
    ==   [j+i | i<-[0,2..], j<-[5]]                 -- loop unrolling, 3x:
    ==   [j+i | i<-[0,6..], j<-[5,7,9]]
    == 5:[j+i | i<-[0,6..], j<-[7,9,11]]            
    == 5:[7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43, ...
    \\   [  9,      15,      21,      27,      33,      39,       ...
    ==   [j+i | i<-[0,6..], j<-[  9   ]]
-}
primes = 2:3:5: filter (noDivs (drop 2 primes)) 
         [j+i | i<-[0,6..], j<-[7,  11]] 
```

我们也可以提前跳过*5的倍数（作为*[*[欧拉筛的](http://www.haskell.org/haskellwiki/Prime_numbers#Unbounded_Euler.27s_sieve)*][*另一个步骤, ）：`euler (x:xs) = x : euler (xs `minus` map (x*) (x:xs))`*]

```
--       [j+i | i<-[0, 6..], j<-[7, 11]]            -- loop unrolling, 5x:
--  == 7:[j+i | i<-[0,30..], j<-[11,13,17,19,23,25,29,31,35,37]]
--  \\   [j+i | i<-[0,30..], j<-[               25,      35   ]]

primes = 2:3:5:7: filter (noDivs (drop 3 primes)) 
         [j+i | i<-[0,30..], j<-[11,13,17,19,23,   29,31,   37]] 
```

......但这已经[够远了，就目前而言](http://www.haskell.org/haskellwiki/Prime_numbers#Wheeled_list_representation)。**

# actionscript-3 - Flash AS3 命中测试转到下一帧

> ID：14693035
> 
> 赞同：1
> 
> 时间：2013-02-04T18:25:14.497
> 
> 标签：actionscript-3, flash, hittest

我有一个可以拖到另一个对象中的对象。我已经为碰撞设置了命中测试。当发生碰撞时，我想前进到下一帧，但是我必须单击可拖动对象才能这样做。我希望它无需单击即可立即移至下一帧。有没有什么办法解决这一问题？

我的意思是在我拖动对象以创建碰撞后，我需要再次单击对象以前进到下一帧。我不想再次单击对象，我希望它在发生碰撞时转到下一帧。

这是我的代码

```
bottle.buttonMode = true;

bottle.addEventListener(MouseEvent.MOUSE_DOWN, drag);

bottle.addEventListener(MouseEvent.MOUSE_UP, drop);

function collision():void{
   if(bottle.hitTestObject(hit)){
    nextFrame();
    }
  }

 function drag(e:MouseEvent):void{
 bottle.startDrag();
 collision();
}

    function drop(e:MouseEvent):void{
    bottle.stopDrag();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:31:55.283

更改`collision()`为事件侦听器并将其附加到`bottle`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T00:19:21.980

您应该在 之后而`drop`不是在开始时检查碰撞`drag`：

```
function collision():void{
    if(bottle.hitTestObject(hit)){
        nextFrame();
    }
}

function drag(e:MouseEvent):void{
    bottle.startDrag();
}

function drop(e:MouseEvent):void{
    bottle.stopDrag();
    collision();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:21:26.533

试试这个（改编自 Gary Rosenzweig）：

```
bottle.buttonMode = true;

bottle.addEventListener( MouseEvent.MOUSE_DOWN, startBottleDrag );
stage.addEventListener( MouseEvent.MOUSE_UP, stopBottleDrag );

function collision():void {
    if( bottle.hitTestObject( hit ) ) {
        stopBottleDrag();
        nextFrame();
    }
}

// to keep bottle location as it is when clicked
var clickOffset:Point = null;

function startBottleDrag( e:MouseEvent ) {
    clickOffset = new Point( e.localX, e.localY );
    bottle.addEventListener( Event.ENTER_FRAME, dragBottle );
}

function stopBottleDrag( e:MouseEvent = null ) {
    clickOffset = null;
    bottle.removeEventListener( Event.ENTER_FRAME, dragBottle );
}

function dragBottle( e:Event ) {
    bottle.x = mouseX - clickOffset.x;
    bottle.y = mouseY - clickOffset.y;
    collision();
} 
```

# .htaccess - 使用 mod_rewrite 重写 url：多条规则出错

> ID：14693038
> 
> 赞同：0
> 
> 时间：2013-02-04T18:25:33.373
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, rewrite

我在 .htaccess 中有以下代码

```
 Options +FollowSymLinks 
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)(/([^/]+))?(/(edit)+)(/([^/]+))?/?$ edit.php?secret=Y7qD7&category=$1&slug=$3&edit=$5&part=$7 [L]
RewriteRule ^([^/]+)(/([^/]+))?/?$ content.php?category=$1&slug=$3 [L]
RewriteRule ^(/)?$ content.php [L] 
```

我期望实现的是

```
http://example.com/test/test1/edit/part   to  edit.php?category=test&slug=test1&edit=edit&part=part
http://example.com/test/edit/part   to  edit.php?category=test&slug=&edit=edit&part=part 
```

（以上重写按预期工作）

```
 `http://example.com/test/test/` to `content.php?category=test&slug=test` 
 `http://example.com/test/` to `content.php?category=test&slug=` 
```

（请注意，以上 2 个网址中没有“/edit/”和“/part/”）

对于以上两个重写，第一个工作正常，但第二个没有按预期工作。最后一个被重写为 content.php?category=content.php&slug= 这是不正确的。

尾部斜杠也不应该对重写产生影响。

有人可以告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:57:43.003

我没有检查为什么您的问题中的规则没有按预期工作，但您可以试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  ^/([^/]+)/?([^/]*)?/?([^/]*)?/?([^/]*)?/?
RewriteRule .*    edit.php?key1=%1&key2=%2&key3=%3&key4=%4     [L] 
```

静默地图：

`http://example.com/val1/`取决于

`http://example.com/val1/val2/val3/val4/`带或不带斜杠

至：

`http://example.com/edit.php?key1=val1&key2=val2&key3=val3&key4=val4`

`valN`传入 URL 中传递的值的最大数量为 4。最小值为 1。不过，可以通过修改规则来调整该范围。

当`valN`传入 URL 中不存在任何内容时，添加到替换 URL 的查询中相应键值对中的值将为空。

但是，`key`将始终出现在查询中，因为所有`keys`都是固定字符串，而不是传入 URL 传递的。

此规则集已经过测试并且可以正常工作，并且应该在没有任何其他可能与之冲突的规则的情况下对其进行测试。我没有检查问题中的其他规则，也不能说它们是否有效或是否会影响这个规则。那不是问题的一部分。

### 更新

**重定向到edit.php：**

仅当 URL 路径中有 3 或 4 个文件夹时才需要映射到 edit.php。

修改后的规则集是：

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_URI} !edit\.php  [NC]
RewriteCond %{REQUEST_URI}  ^/([^/]+)/([^/]+)/([^/]+)/?([^/]*)?/?$  [NC]
RewriteRule .*    edit.php?key1=%1&key2=%2&key3=%3&key4=%4     [L,QSA] 
```

静默地图：

`http://example.com/val1/val2/val3/`取决于

`http://example.com/val1/val2/val3/val4/`带或不带斜杠

至：

`http://example.com/edit.php?key1=val1&key2=val2&key3=val3&key4=val4`

传入 URL 中传递的 valN 值的最大数量为 4。最小值为 3。

* * *

**重定向到 content.php：**

映射到 content.php 与上一个非常相似，除了仅在文件夹数为 1 或 2 时进行。

所以规则集与较少的正则表达式组基本相同：

```
RewriteCond %{REQUEST_URI} !content\.php  [NC]
RewriteCond %{REQUEST_URI}  ^/([^/]+)/?([^/]*)?/?$  [NC]
RewriteRule .*    content.php?key1=%1&key2=%2   [L,QSA] 
```

静默地图：

`http://example.com/val1/` 取决于

`http://example.com/val1/val2/`带或不带斜杠

至：

`http://example.com/content.php?key1=val1&key2=val2`

传入 URL 中传递的 valN 值的最大数量为 2。最小值为 1。

完整的**规则集**是这样的：

```
Options +FollowSymLinks 
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_URI} !edit\.php  [NC]
RewriteCond %{REQUEST_URI}  ^/([^/]+)/([^/]+)/([^/]+)/?([^/]*)?/?$ [NC]
RewriteRule .*    edit.php?key1=%1&key2=%2&key3=%3&key4=%4  [L,QSA]

RewriteCond %{REQUEST_URI} !content\.php  [NC]
RewriteCond %{REQUEST_URI}  ^/([^/]+)/?([^/]*)?/?$  [NC]
RewriteRule .*    content.php?key1=%1&key2=%2   [L,QSA] 
```

希望我明白你想要什么。

# ibm-mq - MQ Explorer 中未启用 MQFTE 浏览远程代理

> ID：14693039
> 
> 赞同：1
> 
> 时间：2013-02-04T18:25:35.820
> 
> 标签：ibm-mq, websphere-mq-fte

我正在尝试在同一域中通过网络连接的两个 Windows 服务器之间进行文件传输。我已经通过资源管理器成功连接到远程代理，但是当尝试浏览远程系统中的目标目录时，我发现它没有启用。我在代理日志中看不到任何特定错误。我在 MQ 或代理日志中看不到任何特定错误，因为我实际上无能为力。这是因为我使用的用户在远程服务器中没有写入权限。如果是这种情况如何确保用户在远程服务器中具有写访问权限？我使用的用户在直接登录时对远程服务器具有写访问权限。请找到随附的屏幕截图。![浏览远程代理已禁用](../Images/0ca7349be11f70ee845383cd30e7752b.png)

当我在命令模式下运行时，我得到 2087 原因码

```
C:\>fteCreateTransfer -sa AGENT1 -sm hubQM -da AGENT3 -dm hubQ
M -w -dd "D:\MQFTE\Destination" "D:\MQFTE\Source\sample.txt" 
```

5724-H72 版权所有 IBM Corp. 2008, 2012。保留所有权利 BFGCL0003E: 对于队列管理器 hubQM 上的队列 SYSTEM.FTE.COMMAND.AGENT1，消息传递问题阻止命令成功完成。WebSphere MQ 完成代码为 2，原因代码为 2087。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T22:32:31.593

`2087`手段`MQRC_UNKNOWN_REMOTE_Q_MGR`。_ 这表明您的 WMQ Explorer 所连接的 QMgr 无法解析远程代理所连接的 QMgr。您需要查看您的 FTE 命令 QMgr 以确保它具有到远程代理所在的 QMgr 的路径。

# eclipse - Eclipse，Git 拉到现有存储库，新项目在哪里

> ID：14693040
> 
> 赞同：0
> 
> 时间：2013-02-04T18:25:38.007
> 
> 标签：eclipse, egit, pull, new-project

在 Linux 上使用 Eclipse 4.21 + Egit 2.20，所有组件都是最新的。Eclipse 工作区链接到存储在工作区文件夹之外的本地存储库。远程存储库位于 GitHub 上。

在拉取之后（在 Eclipse 内或在外部使用 git cmdline），我和我的朋友可以在现有项目中看到彼此的更新或新文件。但是我们每个人都看不到其他开发人员添加的 NEW 项目。新的项目文件在 GitHib 上，实际上是在 git pull 之后保存在本地工作文件夹中。

无论我刷新包资源管理器视图或退出/重新启动 Eclipse 多少次。新项目未显示在 Eclipse 包资源管理器中。每次都需要手动“导入现有项目”。

是不是因为我添加了 .metadata 是存储库根目录下的 .gitignore 文件？更重要的是，推荐的做法是什么，以便在 git pull 后在 Eclipse 包资源管理器中自动同步提交到远程存储库的新项目、已删除项目？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T22:39:22.107

您正在使用它，因为它是为使用而设计的。Eclipse 工作区的概念和 Git 存储库中的文件夹不会以这种方式自动链接，就像在工作区目录中创建新目录不会自动使新项目出现在 UI 中一样。

# php - 我的 php 注册码有什么问题？

> ID：14693044
> 
> 赞同：-3
> 
> 时间：2013-02-04T18:25:43.560
> 
> 标签：php, forms

**我正在制作一个通过包含连接到 mysql 数据库的注册页面。当我尝试应用一些规则**（没有空的电子邮件、用户名或密码）时，出了点问题......

当我运行脚本时，**它只给了我 HTTP 500（内部服务器错误）：** 我已将脚本粘贴在下面...
[对不起我糟糕的编码技能...我是新手！]

```
if ($submit) {
$check = empty($_POST['username']) || empty($_POST['password']) || empty($_POST['email']))
if ($check == true) {
echo "Fill all the info!";
}
else {
$check1 = mysql_num_rows(mysql_query("SELECT * FROM accounts WHERE login='".$username."'"));

if ($check1 == 0) {

$password = base64_encode( pack( "H*", sha1( utf8_encode( $password))));

mysql_query("INSERT INTO accounts VALUES ('".$username."', '".$password."', '".$lastactive."', '0', '".$IP."', '1', '".$email."')");

echo "<b><font color='gray'>You have been registered. Visit the login page in order to login and edit your account.</b>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:42:13.973

我相信我发现的错误很少。

$check = empty($_POST['username']) || 空（$_POST['密码']）|| empty($_POST['email']) **)** <-- 这不是必需的

最后有一个额外的 ) ，也没有 ; 完成这条线。

最后也没有关闭 if 语句

```
if ($check1 == 0) {

$password = base64_encode( pack( "H*", sha1( utf8_encode( $password)))); 
```

**}** <-- 这是必需的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:33:27.657

您没有在第二行关闭 )，也没有关闭 } 其他行

这就是开始。

# javascript - Javascript 从 API 登录 Gmail

> ID：14693046
> 
> 赞同：-1
> 
> 时间：2013-02-04T18:25:57.170
> 
> 标签：javascript, html, xml

我想设计一个 API，我将在其中填写我的电子邮件 ID 和密码并抛出该页面，我可以直接登录到我的 gmail 帐户。

例如，我想做以下步骤。

1.  打开[http://gmail.com](http://gmail.com)
2.  等待一段时间
3.  使用 document.getElementById() 按我在 API 中输入的值填写 ID 和密码字段
4.  单击“登录”按钮进入我的 Gmail 帐户。

请帮助我完成此操作的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:28:57.757

使用以下 jQuery：

```
$(document).ready(function(){
     $("#usernamefield").val('My.Username');
     $("#passwordfield").val('My.Password');
     $("#loginbutton").click();
}); 
```

# iphone - 自定义 UITableViewCell 和调整单元格高度

> ID：14693048
> 
> 赞同：0
> 
> 时间：2013-02-04T18:26:00.743
> 
> 标签：iphone, uitableview

我想为 uitableview 创建一个自定义单元格，左侧有一个图像，这样会发生以下事情

1)当单元格被选中时，它的高度增加，背景颜色改变，并在附件视图的位置得到一个绿色的圆形按钮

我的方法：-我制作了一个自定义uiview，使其在附件视图的位置包含一个imageview，然后我做了

```
[[table cellForRowAtIndexPath:indexPath].contentView addSubview:customCellBackgroundView]; 
```

但这不起作用，因为它隐藏了单元格的文本

2）选中的单元格应该保持相同的高度，这样可以选择多个单元格，并且选中的单元格比未选中的单元格具有更大的高度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:45:57.487

您可以为每个单元格保留一个属性，说明它是否被选中。在绘制每个单元格时，您检查该单元格是否应该被选中，并使用您之前创建的 2 个不同单元格布局中的一个（一个折叠，另一个打开）。

因此，当您单击某个单元格时，您会更改该单元格的选定状态并要求重新加载表格视图，以便现在将相同的单元格绘制为打开/关闭。

# html - 如何阻止文本显示/流出

> ID：14693051
> 
> 赞同：0
> 
> 时间：2013-02-04T18:26:09.870
> 
> 标签：html, css, css-float

我不知道为什么，但我得到这个文本显示/在`<h3>`标签之外流动。我认为这与浮动有关，但我已经尝试了所有我知道的解决方案来修复它，但它们没有奏效。

这是 jsfiddle（我在 Safari 中）：http: [//jsfiddle.net/BJCkv/1/](http://jsfiddle.net/BJCkv/1/)

**HTML：**

```
<div id="header-container">
    <div class="wrapper"> <!-- has width of 940px; and aligned in middle -->
        <h1>PCSA - TRAINING</h1>
        <h3>Security Architecture</h3> <!-- This is the problem text -->
    </div>
</div> 
```

**CSS：**

```
#header-container {
    height: 84px;
    line-height: 84px;
    background-color: #e0dfd9;
    background-image: url(../img/header.png);
    border-top: 1px solid #ccccc7;
    border-bottom: 1px solid #ccccc7;
}
#header-container .wrapper {
    overflow: hidden;
}
#header-container h1 {
    color: #b8622b;
    font-family: 'Open Sans', sans-serif;
    font-size: 38px;
    text-shadow: 0 1px 0 #f7f7f5;
    font-weight: 600;
    float: left;
    background: red;
}
#header-container h3 {
    color: #a5a5a4;
    float: left;
    font-family: 'Open Sans', sans-serif;
    font-style: italic;
    padding: 3px 0 3px 10px;
    margin-left: 20px;
    height: 30px;
    border-left: 1px solid #a5a5a4;
    background: yellow;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:34:33.643

你可以`replace height: 30px;`用`line-height: 30px;`那应该可以解决问题。 [http://jsfiddle.net/BJCkv/7/](http://jsfiddle.net/BJCkv/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:35:19.483

您需要重置`h3`元素的行高：现场演示：http: [//jsfiddle.net/BJCkv/5/](http://jsfiddle.net/BJCkv/5/)

```
#header-container h3 {
    line-height: 30px; /* add this */
    color: #a5a5a4;
    float: left;
    font-family: 'Open Sans', sans-serif;
    font-style: italic;
    padding: 3px 0 3px 10px;
    margin-left: 20px;
    height: 30px;
    border-left: 1px solid #a5a5a4;

    background: yellow;
} 
```

# javascript - $watch ngModel from inside 指令使用隔离范围

> ID：14693052
> 
> 赞同：57
> 
> 时间：2013-02-04T18:26:17.337
> 
> 标签：javascript, angularjs, angularjs-directive

我试图从我的链接函数内部观察我的模型值。

```
scope.$watch(attrs.ngModel, function() {
       console.log("Changed"); 
    }); 
```

当我更改控制器中的模型值时，不会触发 $watch 函数。

```
$scope.myModel = "ACT";

$timeout(function() {
   $scope.myModel = "TOTALS"; 
}, 2000); 
```

小提琴：http: [//jsfiddle.net/dkrotts/BtrZH/4/](http://jsfiddle.net/dkrotts/BtrZH/4/)

我在这里想念什么？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2013-02-04T18:34:34.570

您需要观看一个返回您正在观看的 $modelValue 的函数。

以下代码显示了一个基本示例：

```
app.directive('myDirective', function (){
    return {
        require: 'ngModel',
        link: function(scope, element, attrs, ngModel) {
           scope.$watch(function () {
              return ngModel.$modelValue;
           }, function(newValue) {
               console.log(newValue);
           });
        }
     };
}); 
```

[这是一个](http://plnkr.co/edit/N2dfF6aW8hVt0yAcQuIG?p=preview)在行动中同样想法的笨蛋。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-02-04T18:44:38.777

问题是你`$watch`ing`attrs.ngModel`等于“myModel”。您的范围内没有绑定“myModel”。你想`$watch`“建模”。这就是您的指令范围内的约束。见[http://jsfiddle.net/BtrZH/5/](http://jsfiddle.net/BtrZH/5/)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-11-24T08:28:32.913

正确的方法是：

```
app.directive('myDirective', function () {
  return {
    require: 'ngModel',
    link: function (scope, element, attrs, ngModel) {

        ngModel.$render = function () {
            var newValue = ngModel.$viewValue;
            console.log(newValue)
        };

    }
  };
}); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-11-11T10:25:56.180

这是另一种方法：

```
app.directive('myDirective', function (){
    return {
        require: 'ngModel',
        link: function(scope, element, attrs, ngModel) {
           attrs.$observe('ngModel', function(value){ // Got ng-model bind path here
              scope.$watch(value,function(newValue){ // Watch given path for changes
                  console.log(newValue);  
              });
           });
        }
    };
}); 
```

这样做你将能够通过这样的绑定来监听值的变化

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-13T16:54:52.650

这是上面@Emmanuel 回答@Martin Velez 的延伸，虽然我知道已经很晚了！（另外我还不能发表评论，所以如果这不是合适的地方，对不起！）

我不确定使用的是哪个版本的 Angular OP，但在 Angular#1.2+ 中至少在官方文档[https://docs.angularjs.org/api/ng/type/ngModel.NgModelController#$render](https://docs.angularjs.org/api/ng/type/ngModel.NgModelController#$render)， $render是这样列出的：

> 当视图需要更新时调用。预计 ng-model 指令的用户将实现此方法。
> 
> $render() 方法在以下情况下被调用：
> 
> $rollbackViewValue() 被调用。如果我们将视图值回滚到最后提交的值，则调用 $render() 来更新输入控件。ng-model 引用的值以编程方式更改，并且 $modelValue 和 $viewValue 都与上次不同。由于 ng-model 不做深度观察，$render() 只有在 $modelValue 和 $viewValue 的值实际上不同于它们之前的值时才会被调用。

我将此解释为意味着从指令中 $watch ngModel 的正确方法是要求 ngModel 并实现注入 ngModelController 的链接函数。然后使用 $render-on-change ($watch) 或其他任何内容中内置的 ngModel API。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-22T15:37:31.930

有两种方法可以做到这一点。

1）您可以使用`$attrs.[any_attribute]`并设置任何监听器

2）您可以使用**2 种方式绑定**变量来隔离范围并在其上设置一个侦听器。如果您想要更多，这里有一篇很酷的文章

[http://www.w3docs.com/snippets/angularjs/bind-variable-inside-angularjs-directive-isolated-scope.html](http://www.w3docs.com/snippets/angularjs/bind-variable-inside-angularjs-directive-isolated-scope.html)

# redirect - Twitter - 奖励关注的用户

> ID：14693057
> 
> 赞同：1
> 
> 时间：2013-02-04T18:26:35.580
> 
> 标签：redirect, twitter, twitter-follow

我正在建立一个为用户提供积分系统的网站。如果他们在 Twitter 上关注该网站但不知道从哪里开始，我想奖励他们积分。

本质上，我希望发生以下情况：

1.  用户点击管理员内的链接，将他们带到 Twitter
2.  他们关注网站
3.  一旦被关注，它会将他们重定向回网站

有人知道在哪里可以找到这方面的指南吗？

谢谢尼克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:04:25.667

查看网络意图 @ [https://dev.twitter.com/docs/intents#tweet-intent](https://dev.twitter.com/docs/intents#tweet-intent) - 它有示例代码。还登录到您的 Twitter 帐户并转到[https://twitter.com/about/resources/buttons#mention](https://twitter.com/about/resources/buttons#mention) 第一个可能是您最有可能使用的。

祝你好运！

雷切尔：）

# matrix - 计算边界内矩阵中的值

> ID：14693059
> 
> 赞同：0
> 
> 时间：2013-02-04T18:26:37.597
> 
> 标签：matrix, polygon, counting

我自己尝试过使用“直线方程之间”的方法，但我需要执行以下操作：

我有一个 n x n 矩阵，它存储 2D 直方图计数。我需要能够按顺序指定点，并让程序计算这些点之间的所有内容。

至少现在，我对一个简单的矩形最满意（但是，矩形可以旋转任意度数）。

![矩阵的表示](../Images/7e8a74ae1c0e6fd003545f0c748908e8.png)

从我的 Paint.exe 的直方图图片中，您可以看到我希望能够在蓝色框中进行计数。计算水平（右上角）矩形不是问题（将 For 循环中的边界指定为矩阵的开始/结束 bin）。

我被困在如何定义代码中的边界以在另一个（最左边的）蓝色框中进行计数。我正在使用 Igor Pro（来自 WaveMetrics）来执行此操作，因此在大多数情况下，这不是特定于语言的。

基本上，这是用于分析这些图表中感兴趣的区域。有一些工具可以分析带有“多边形/自由形式”类型的东西的图像，但它们无法准确地从该矩阵中获取计数（它们基于图像颜色而不是计数进行分析）。此外，我无法根据“此垃圾箱中是否有超过 X？”进行过滤。因为必须将相同的矩形应用于基线“噪声”矩阵。

想法？我真的坚持要了解这将如何工作的核心概念..

编辑：我的尝试似乎无法正常工作，特别是当我放入一个“盒子”时，它是空的，类似于上面右边的蓝色盒子。我也不一定能改变倾斜的矩形（因为无论如何我们都没有真正的方法来计算它..）

```
// Find polygon boundaries
s1 = (y2-y1)/(x2-x1)
o1 = s1==inf || s1==-inf ? 0 : y2 - (s1*x2)
s2 = (y3-y2)/(x3-x2)
o2 = s2==inf || s2==-inf ? 0 : y3 - (s2*x3)
s3 = (y4-y3)/(x4-x3)
o3 = s3==inf || s3==-inf ? 0 : y4 - (s3*x4)
s4 = (y1-y4)/(x1-x4)
o4 = s4==inf || s4==-inf ? 0 : y1 - (s4*x1)
// Get highest/lowest points (used in For loop)
maxX = max(max(max(x1, x2), x3), x4)
maxY = max(max(max(y1, y2), y3), y4)
minX = min(min(min(x1, x2), x3), x4)
minY = min(min(min(y1, y2), y3), y4)

For (i=minX; i<=maxX; i+=1) // Iterate over each X bin
        For (j=minY; j<=maxY; j+=1) // Iterate over each Y bin
            //     |                   BETWEEN LINE 1 AND LINE 3?                                |        |                        BETWEEN LINE 2 AND LINE 4?                           |
            If ( ( ((s1*i + o1) > j && j > (s3*i + o3)) || ((s1*i + o1) < j && j < (s3*i +o3)) ) && ( ((s2*i + o2) > j && j > (s4*i + o4)) || ((s2*i + o2) < j && j < (s4*i +o4)) ) )
                totalCount += matrixRef[i][j] // Add the count of this bin to the total count
            EndIf
        EndFor // End Y iteration
    EndFor // End X iteration 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-18T15:41:14.253

Igor 有一个比您当前的解决方案更强大的工具

1.  转到窗口菜单
2.  选择帮助窗口
3.  选择“XOP 索引.ihf”
4.  搜索“选择掩码点”

它将解释如何在图形中定义任何形状的多边形并获得内部点的掩码。然后你可以在它们上运行你想要的任何代码。

您还可以在代码中制作/更改多边形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:49:52.643

您可以像在水平矩形中一样计算对角矩形中的值，您将有一个更复杂的循环来确定边界的位置。您可以通过循环一个水平矩形来完成此操作，该矩形包括整个对角矩形，并且仅在它们落在对角矩形内时才计算值。

如果您知道构成对角矩形角的点，那么您可以获得每个边界的方程（斜率截距方程）。从那里您可以看到点在每个边界的哪一侧。如果它们位于与矩形内部相对应的侧面，则包含它们，如果它们不是，则不包含它们。

您将不得不为您正在处理的每个点找到边界的 X 和 Y 点。如果你只检查左下角的边框，你会得到类似的东西：

```
for(each point in the matrix){
  if(point.x > border X value @ height Y && point.y > border Y value @ column X)
    include this point
  else
    don't include it
} 
```

如果您有边界方程并且您知道要分析的点，您可以使用已知的 X 值（从该点）来获取边界的 Y 值（您正在查看的那一列中的高度）和已知的 Y 值（同样，从您正在分析的点开始）以获得边界的 X 值（边界在点的高度处有多远）。

对于完整的条件列表，您应该注意的是：

*   左下边框：point.x >border.x && point.y >border.y
*   右下边框：point.x <border.x && point.y >border.y
*   左上边框：point.x > border.x && point.y <border.y
*   右上边框：point.x <border.x && point.y <border.y

# ruby-on-rails - 如何逃避haml中的评论？

> ID：14693063
> 
> 赞同：2
> 
> 时间：2013-02-04T18:26:54.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, haml

我有以下行，其中包含在视图中使用 RoR 的正则表达式（show.html.haml）：

```
- unless @article.content =~ /find(#{image.id})/ 
```

问题是正则表达式没有被评估，因为它被解释为注释。我怎样才能逃避评论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:38:19.127

```
- unless @article.content =~ Regexp.new("find(#{image.id})") 
```

或者

```
- unless @article.content =~ %r{find(#{image.id})} 
```

**编辑：**我想我并没有真正回答这个问题。要逃避评论，请查看[cyle](https://stackoverflow.com/users/1028922/cyle)建议使用该`\`角色的答案。

# vb.net - 如何设置 TableLayoutPanel 单元格的大小

> ID：14693065
> 
> 赞同：3
> 
> 时间：2013-02-04T18:27:01.010
> 
> 标签：vb.net

我正在尝试在每个单元格中`TableLayoutPanel`使用`PictureBox`+ 。`Label`我已经做好了，但我无法将单元格大小设置为相同！我试图有 4 列，行数无穷无尽，我希望单元格在`Label`宽度内，除非`Label`宽度小于`Picture`宽度。

现在，我的代码几乎可以工作，只是没有设置单元格大小，因为我不知道该怎么做。

这是我的代码：

```
 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim movieN As Integer = MoviesDataSet.movies.Rows.Count
    Dim tablePanel As New TableLayoutPanel

    With tablePanel
        .Size = New Point(650, 450)
        .ColumnCount = 4
        .GrowStyle = TableLayoutPanelGrowStyle.AddRows
        .AutoScroll = True
        .Margin = New System.Windows.Forms.Padding(0)
        .Location = New System.Drawing.Point(5, 50)
        .CellBorderStyle = TableLayoutPanelCellBorderStyle.Inset
    End With

    For Each MovieRow As DataRow In MoviesDataSet.Tables("movies").Rows
        'define two new controls to be added
        Dim myLabel As New Label
        Dim myPicture As New PictureBox
        Dim container As New Panel

        'set the properties of the new controls
        myLabel.Text = MovieRow("movieName")
        myLabel.Location = New System.Drawing.Point(30, 110)
        With myPicture
            .Image = Image.FromFile(MovieRow("moviePhoto"))
            .Tag = MovieRow("ID")
            .Size = New System.Drawing.Size(100, 100)
            .SizeMode = PictureBoxSizeMode.StretchImage
            .Location = New System.Drawing.Point(2, 2)
        End With

        'here we add the controls to a flow layout panel to
        'manage the positioning of the controls but you could
        'explicitly set the location of the controls if you 
        'just wanted to add them to the forms controls collection
        With container
            .Dock = DockStyle.Fill
            .Margin = New System.Windows.Forms.Padding(0)
            .Controls.Add(myPicture)
            .Controls.Add(myLabel)
        End With

        With tablePanel.Controls
            .Add(container)
        End With

        'here we add a handler for the picture boxs click event
        AddHandler myPicture.Click, AddressOf MyPictureClickEvent
        AddHandler myPicture.MouseHover, AddressOf MyPictureHoverEvent
    Next
    Me.Controls.Add(tablePanel)
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T00:03:24.003

如果您希望单元格宽度与`PictureBox`or中的较宽者相同`Label`，并且通过将它们包装在 a 中将它们放置在同一个单元格中，`Panel`则将`Panel`'s [AutoSizeMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.panel.autosizemode.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)属性设置为`AutoSizeMode.GrowAndShrink`，并将其[AutoSize](http://msdn.microsoft.com/en-us/library/system.windows.forms.panel.autosize.aspx)属性设置为`True`。如果你然后对它做同样的事情，`TableLayoutPanel`它将使每个单元格根据它的大小增长或缩小，`Panel`并且`Panel`会根据它内部控件的大小做同样的事情。

# java - 在java中使用正则表达式验证文件名

> ID：14693069
> 
> 赞同：0
> 
> 时间：2013-02-04T18:27:04.947
> 
> 标签：java, regex

在这里，我想在 java 中使用正则表达式验证文件名。我实现了下面的代码，但这不适用于第三种类型的文件。

我可以检查正则表达式中的前缀和扩展名？？？

我的验证文件名看起来像这 3 种方式

```
1) prefix_digit.digit.extenstion         example : AB_1.1.fuij (Here fuij is my extension)
2) prefix_digit.digit.digit.extenstion   example : AB_1.1.1.fuij
3) prefix_digit.digit.B/P.digit.extensionexample : AB_1.1.B.1.fuij 
```

只有这 3 种类型的文件有效。第三个是测试版和试用版文件。如果有测试版和试用版文件，那么应该是我上面提到的

我要写一些有效和无效的文件

```
**Valid :** 
    AB_1.1.fuij
    AB_1.4.fuij
    AB_1.1.1.fuij
    AB_1.1.B.1.fuij
    AB_3.4.P.7.fuij

***Invalid :***
    AB_0.1.fuij
    AB_1.B.1.1.fuij(B/P should be place on 3rd always)
    AB_1.2.B.0.fuij 
```

***代码 ：***

```
import java.util.ArrayList;
import java.util.regex.Pattern;

public class democlass {
    /**
     * Test harness.
     */
    public static void main(String[] args) {
        ArrayList<String> demoversion = new ArrayList<String>();

        System.out.println("Result >>>>>>>>>>>>  "
                +isFileValid("AB_1.1.fuij"));
        System.out.println("Result >>>>>>>>>>>>  "
                +isFileValid("AB_1.B.fuij"));
        System.out.println("Result >>>>>>>>>>>>  "
                +isFileValid("AB_1.1.1.fuij"));
        System.out.println("Result >>>>>>>>>>>>  "
                +isFileValid("AB_1.P.1.1.fuij"));
        System.out.println("Result >>>>>>>>>>>>  "
                +isFileValid("AB_1.1.B.1.fuij"));

    }

    private static boolean isFileValid(String input)
    {
        String regexFinalBugFix = "^\\d+\\.\\d+\\.\\d+$"; 
        String regexFinal = "^\\d+\\.\\d+$"; 
        String regexBetaPilot = "^\\d+\\.\\d+\\.\\[BP]+\\.\\d+$"; 
        final Pattern pattern1 = Pattern.compile(regexFinal);
        final Pattern pattern2 = Pattern.compile(regexBetaPilot);
        final Pattern pattern3 = Pattern.compile(regexFinalBugFix);

        String inputVersion = null;

        int suffixIndex = input.lastIndexOf(".");
        int prefixIndex = input.lastIndexOf("_");
        if (suffixIndex > 0 && prefixIndex > 0) {
            inputVersion = input.substring(prefixIndex + 1,
                    suffixIndex);
            String prefixString1 = input.substring(0, 3);
            String suffixString1 = input.substring(suffixIndex);
            if(prefixString1.equals("AB_") && suffixString1.equals(".fuij"))
            {
                if (pattern1.matcher(inputVersion).matches()
                        || pattern2.matcher(inputVersion).matches()
                        || pattern3.matcher(inputVersion).matches()) {
                    return true;
                }
                return false;
            }
            return false;
        }
        return false;
    }
} 
```

**输出 ：**

```
Result >>>>>>>>>>>>  true
Result >>>>>>>>>>>>  false
Result >>>>>>>>>>>>  true
Result >>>>>>>>>>>>  false
Result >>>>>>>>>>>>  false : It should be valid but it is false, why?? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:39:29.037

你错了：你正在逃避班级`regexBetaPilot`的开括号。`[BP]`试试这个：

```
String regexBetaPilot = "^\\d+\\.\\d+\\.[BP]+\\.\\d+$"; 
```

您可以轻松地将所有三种模式组合成一个模式：

```
String regex = "\\d+\\.(\\d+\\.([BP]+\\.)?)?\\d+"; 
```

您不需要锚点（`^`和`$`）。由于您使用`matches()`而不是`find()`，它总是会尝试匹配整个字符串。

**编辑**我后来离开了`+`，`[BP]`因为那是您在原始代码中所拥有的。但是，如果要匹配*单个*B 或 P，则应`+`从模式中删除 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:39:39.590

您正在转义 的左括号`[BP]`，因此它会尝试`[`在字符串中找到 a 。

这有效：

```
String regexBetaPilot = "^\\d+\\.\\d+\\.[BP]+\\.\\d+$"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:27:29.650

您可以将正则表达式简化为

```
AB_\d+\.\d+(?:(?:\.[BP])?\.\d+)?\.fuij 
```

这符合`AB_digits.digits`. 然后是一个可选的`.digits`,`.B.digits`或`.P.digits`。最后匹配`.fuij`。从您的示例中，可能只有一个`B`or `P`。如果要匹配多个`B`s 和`P`s，只需`+`再次添加。

然后你的`isFileValid()`功能可能会减少到

```
private static boolean isFileValid(String input)
{
    final String re = "AB_\\d+\\.\\d+(?:(?:\\.[BP])?\\.\\d+)?\\.fuij";
    final Pattern pattern = Pattern.compile(re);
    return pattern.matcher(input).matches();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T18:45:51.280

像这样的东西应该适用于 AB 是静态的：

正则表达式： `AB_\d+\.\d+((\.\d){0,1}|\.[BP]\.\d+)\.fuij`

作为 Java 字符串 `AB_\\d+\\.\\d+((\\.\\d){0,1}|\\.[BP]\\.\\d+)\\.fuij`

这错过了您列出的两个无效，但我不确定为什么它们应该无效。如果你能更好地解释成功/失败的规则，我可以更多地了解吗？

# wxpython - 如果在 init 中隐藏，为什么嵌套的 sizer 不会在 wxPython 中扩展？

> ID：14693070
> 
> 赞同：1
> 
> 时间：2013-02-04T18:27:08.853
> 
> 标签：wxpython, panel, init, sizer

我正在尝试构建一个 3 面板 GUI，一切都很顺利，直到我尝试将面板/窗口嵌套在其他面板中并在 GUI 启动时隐藏它们。

看到这张图片...黄色/绿色/蓝色框在初始化期间自动扩展以填充它们的面板，但是在 wx.Panel 初始化期间构建了小紫色框但随后隐藏，直到 2 秒计时器到期然后在那个时候该对象的 Show() 方法被调用。那时它不会填满包含面板。似乎在初始化期间隐藏面板会导致面板大小调整器选择默认大小 20x20。

![尺寸测试](../Images/a392aa4c2e597c185c28a479c11ef516.png)

这是代码：

```
import wx
import  wx.lib.scrolledpanel as scrolled

class NavPanel(wx.Panel):
    """"""
    def __init__(self, parent, actionPanel):
        """Constructor"""
        wx.Panel.__init__(self, parent) #, size=(200,600))
        self.actionPanel = actionPanel
        self.SetBackgroundColour("Yellow")

class ActionPanel(wx.Panel):
    """"""
    def __init__(self, parent, target_item=None):
        """Constructor"""
        wx.Panel.__init__(self, parent)
        self.SetBackgroundColour("Green")

        self.sc = NestedScrolledActionPanel(self)

        sizer = wx.BoxSizer(wx.HORIZONTAL)
        sizer.Add(self.sc, 1, wx.EXPAND)
        self.SetSizer(sizer)

    def show_child(self):
        # Putting a sizer here doesn't work either...
        self.sc.Show()

class NestedScrolledActionPanel(wx.ScrolledWindow):
    """"""
    def __init__(self, parent, target_item=None):
        """Constructor"""
        wx.ScrolledWindow.__init__(self, parent)
        self.SetBackgroundColour("Purple")

        # I don't want to show this at starutp, but hiding it causes the sizer to startup at 20x20!
        # Comment out this line and the sizer set in ActionPanel works, but you see it at startup
        self.Hide()       

class ConsolePanel(scrolled.ScrolledPanel): 
    """"""
    def __init__(self, parent):
        """Constructor"""

        scrolled.ScrolledPanel.__init__(self, parent, -1)
        self.SetBackgroundColour("Blue")

class MainPanel(wx.Panel):
    """"""
    def __init__(self, parent):
        """Constructor"""
        wx.Panel.__init__(self, parent)

        mainSplitter = wx.SplitterWindow(self)
        topSplitter = wx.SplitterWindow(mainSplitter)

        self.rightPanel = ActionPanel(topSplitter)
        self.rightPanel.SetBackgroundColour("Green")

        leftPanel = NavPanel(topSplitter, self.rightPanel)
        leftPanel.SetBackgroundColour("Yellow")

        topSplitter.SplitVertically(leftPanel, self.rightPanel, sashPosition=0)
        topSplitter.SetMinimumPaneSize(200)

        bottomPanel = ConsolePanel(mainSplitter)

        mainSplitter.SplitHorizontally(topSplitter, bottomPanel, sashPosition=400)
        mainSplitter.SetSashGravity(1)

        sizer = wx.BoxSizer(wx.HORIZONTAL)
        sizer.Add(mainSplitter, 1, wx.EXPAND)
        self.SetSizer(sizer)

        return

########################################################################
class MainFrame(wx.Frame):
    """"""
    def __init__(self):
        """Constructor"""

        wx.Frame.__init__(self, None, title="Sizer Test",
                          size=(800,600))

        self.panel = MainPanel(self)

        self.Centre()
        self.Show()

        self.timer = wx.Timer(self)
        self.Bind(wx.EVT_TIMER, self.OnTimer, self.timer)
        self.timer.Start(2000)

    def OnTimer(self, e):
        self.panel.rightPanel.show_child()

if __name__ == '__main__':
    app = wx.App(redirect=False)
    print "Launching frame"
    frame = MainFrame()
    print "starting mainloop"
    app.MainLoop() 
```

我希望在 GUI 启动时隐藏此面板的原因是因为我将在该 ActionPanel 空间（绿色框）中有许多不同的面板，并且当用户单击黄色框中的树节点时，显示在将隐藏绿色框并显示不同的面板。如果我在启动时不隐藏所有面板，它们会“堆叠”在彼此之上，我将不得不设置一个计时器来通过并在 GUI 启动后的某个时间点将它们全部隐藏？？？这似乎很胡扯。我还能怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:55:35.610

添加`self.Layout()`到您的 show_child 方法。仅显示孩子不会像 size 事件那样触发布局。对于那些需要在没有大小事件的情况下更改布局的时候，您需要自己调用 Layout。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T06:51:43.127

我为 Stack Overflow 构建了一个简单的案例经历了很多麻烦，但这只暴露了第二个问题，RobinDunn 回答了这个问题。我的另一个更令人抓狂的问题是我试图向一个对象添加两个 sizer。只有最后一个有sizer，其余的是20x20，我想不通。

我希望两个不同的面板在不同的时间共享同一个父面板，所以我这样做了......（未经测试的代码）..

```
some_object= wx.Panel(self)  # Could be anything
sizer = BoxSizer(wx.VERTICAL)
sizer.Add(some_object, 1, wx.EXPAND)
sizer.SetSizer(sizer)

something_else = wx.Panel(self)  # Could be anything
something_else.Hide()
sizer = BoxSizer(wx.VERTICAL)
sizer.Add(something_else, 1, wx.EXPAND)
sizer.SetSizer(sizer) 
```

但我应该做的是：

```
some_object= wx.Panel(self)  # Could be anything
something_else = wx.Panel(self)  # Could be anything
something_else.Hide()
sizer = BoxSizer(wx.VERTICAL)
sizer.Add(some_object, 1, wx.EXPAND)
sizer.Add(something_else, 1, wx.EXPAND)
sizer.SetSizer(sizer) 
```

然后，当然，在每次显示/隐藏不同面板后执行 Layout() 操作，以及 36 小时的头疼之后，我已经痊愈了！

# c - 如何找到集合的第 i 个最大数，并对 i 个最大数进行排序

> ID：14693071
> 
> 赞同：2
> 
> 时间：2013-02-04T18:27:16.160
> 
> 标签：c, algorithm, sorting, selection

从*“Cormen Leiserson Rivest Stein，第 3 版，问题 9-1，C 点，第 224 页”*中，我有以下作业：

> 给定一个包含*n 个*数字的集合（数组）*A*，使用排序统计算法找到第*i 个*最大的数字，围绕该数字进行分区，并对最大的*i*个数字进行排序。

 ***我使用了随机选择算法（来自同一本书，第 216 页 - 它使用随机分区算法）找到第 i 个**最小**的数字，而我想找到第 i 个**最大**的数字（我们称之为“ k-th”以避免混淆）。基本上，我可以获得第 k 个最大的数字：

> n - i + 1

然后我调用 RandomizedSelect() 来找到第 k 个最大的数字，一切都很好！

这里有一个例子（在 C 中）我如何找到第 4 个最大的数：

```
int A[10] = {3, 20, 15, 4, 1, 9, 18, 64, 22, 5}; // the given A set
int ith = 4; // I want to find the 4-th largest number of A
int kth = 10 - ith + 1; // I do this "conversion" for the reasons I explained above
int i = RandomizedSelect(A, 0, 9, kth); // it returns the index of A pointing to the 4-th largest number

printf("A vector: ");
for (j = 0; j < 10; j++) printf ("%u ", A[j]); // prints the A vector partially "ordered"

printf("\n4-th largest number: %u", A[i]); // prints the 4-th largest number 
```

这里有一个输出示例：

> 向量：3 1 4 5 9 15 18 64 22 20
> 
> 第 4 大数字：18

现在我不仅想要第 4 个最大的数字，还想要其他 4 个最大的数字 S 以有序的方式（来自示例：18 20 22 64）。所以我只是在 A 向量上运行例如 MergeSort()，从之前找到的第 i 个索引开始直到结束。输出将是：18 20 22 64。

问题是作业说我必须围绕第 i 个（第 4 个）最大数字进行分区，并对其他 i（4）个最大数字进行排序，然后如前所述运行 MergeSort()。但我不明白我为什么要这样做......在我的例子中，在 18 左右进行分区没有任何意义，因为我尝试过，这是在我进行分区（调用 SelectedPartition()）之后 A 向量的输出：

> 3 1 4 5 9 15 18 64 22 20
> 
> 18

......这是相同的输出！

那么，我对作业有什么误解？或者，我做得更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:41:24.497

有许多不同的算法用于计算订单统计。许多，如快速选择或中位数算法，自动将数组围绕第 k 个元素分区，作为其实现的一部分。但是，不能保证选择算法必须这样做。例如，您可以通过将所有元素放入顺序统计树数据结构中来实现选择，然后查询第 k 个元素。因此，最正确的做法是放入显式分区步骤以确保分区发生。

在您的情况下，由于您使用的算法已经进行了分区，因此您可以放心地忽略此步骤。

希望这可以帮助！***

# usb - USB - 无中断端点的 MTP/PTP

> ID：14693072
> 
> 赞同：2
> 
> 时间：2013-02-04T18:27:21.203
> 
> 标签：usb, endpoint, mtp

由于我们计划为您的下一个设备使用 MTP（媒体传输协议），因此我们评估使用 MTP 作为当前发布设备中当前（不稳定）USB 驱动程序的替代品。

此设备的限制是，其处理器 (Strong Arm) 最多仅支持 3 个端点：

> *“串行端口 0 是一个通用串行总线设备控制器 (UDC)，它支持三个端点，并且可以以 12 Mbps 的波特率运行半双工（仅从属，而不是主机或集线器控制器）。”*

但根据规范，MTP 至少需要 4 个端点（来自 PTP 规范）：

> *“设备应包含至少四个端点：默认、数据输入、数据输出和中断端点。”*

现在的问题是：我们可以跳过设备上的中断端点吗？我知道它违反了规范 - 但如果我们这样做会发生什么？

从我们目前的评估软件中，我可以看到以下场景：

1.  “可用空间”未更新 - 用户将看到有 100Mb 的可用内存，但放置 1Mb 文件会出现错误“内存不足”
2.  非主机驱动的操作在主机上不可见（因此当在设备上删除、创建或移动文件时，连接的主机不知道）

如果我们可以忍受它，是否建议以这种方式实现它？

* * *

**更新**：该死的......当我上次测试它时，我刚刚删除了中断EP数据传输的代码。现在我还删除了端点定义（我不再创建端点），从这一点开始，无法再建立 MTP 连接:(

似乎 Windows 驱动程序 (wpd) 需要中断端点——即使它没有被使用。厄运...

有没有人知道，是否以及如何让 MTP 与 3 个端点一起工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T09:52:46.817

最后我得到了微软的答复：

> *不支持 3 端点设置。*
> 
> *需要中断端点，以便驱动程序可以从设备接收 MTP 事件。这些事件是一种通知机制，驱动程序依赖于将事件中继到应用程序（例如，当创建、更新或删除对象时）。*
> 
> *如果您的设备对端点不执行任何操作（即不发送任何事件），则只要您设备上的对象发生更改，诸如 Explorer 之类的应用程序就不会正确运行。*

所以我们埋葬了我们的计划...... :(

# opencv - 如何编译我的使用 opencv 的 c 程序

> ID：14693073
> 
> 赞同：1
> 
> 时间：2013-02-04T18:27:23.540
> 
> 标签：opencv, compilation

我已经开始学习 OpenCV。我正在研究Linux。从他们的文档页面我能够编译这个 [http://docs.opencv.org/doc/tutorials/introduction/linux_gcc_cmake/linux_gcc_cmake.html#linux-gcc-usage](http://docs.opencv.org/doc/tutorials/introduction/linux_gcc_cmake/linux_gcc_cmake.html#linux-gcc-usage)

然而，在那之后我迷失了试图声明一个新的垫子和它的构造函数。所以我决定看这本书[http://www.amazon.com/Learning-OpenCV-Computer-Vision-Library/dp/0596516134](https://rads.stackoverflow.com/amzn/click/com/0596516134) 但是我无法编译这本书的第一个程序。程序在这里：

```
#include "highgui.h"
int main(int argc, char** argv)
{
    IplImage* img = cvLoadImage (argv[1]);
    cvNamedWindow("Example1", CV_WINODW_AUTOSIZE);
    cvShowImage("Example1",img);
    cvWaitKey(0);
    cvReleaseImage(&img);
    cvDestroyWindow("Example1");
} 
```

我将它保存在一个名为**load.c的文件中**

然后我创建了一个**CMakeLists.txt**文件并将其放入其中：

```
project( load )
find_package( OpenCV REQUIRED )
add_executable( load load )
target_link_libraries( load ${OpenCV_LIBS} ) 
```

从终端运行“ **cmake . ”时，它是成功的。**但是当我运行“ **make** ”时，它给了我这个错误：

```
Scanning dependencies of target load
[100%] Building C object CMakeFiles/load.dir/load.o
/home/ishan/load/load.c: In function ‘main’:
/home/ishan/load/load.c:4:2: error: too few arguments to function ‘cvLoadImage’
/usr/local/include/opencv2/highgui/highgui_c.h:212:18: note: declared here
/home/ishan/load/load.c:5:28: error: ‘CV_WINODW_AUTOSIZE’ undeclared (first use in this  function)
/home/ishan/load/load.c:5:28: note: each undeclared identifier is reported only once for each function it appears in
make[2]: *** [CMakeFiles/load.dir/load.o] Error 1
make[1]: *** [CMakeFiles/load.dir/all] Error 2
make: *** [all] Error 2 
```

我认为这是因为本书中的这个例子是针对 OpenCV 1.x 而我目前正在运行 2.4.3，但是我相信必须有一种方法来运行这个程序和书中的后续程序。我认为问题在于正确链接头文件。我想先阅读本书并使用文档中的参考，然后完全切换到文档。但是现在我希望从这本书中学习，因为从书中学习对我来说比文档要容易得多。另外，我花了大约 3000 卢比买了这本书，今天才拿到，我不想看到它浪费掉。我想从中学习。

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:39:36.070

`CV_WINODW_AUTOSIZE`拼写错误。正确的常数是`CV_WINDOW_AUTOSIZE`

`cvLoadImage (argv[1]);`应该是`cvLoadImage (argv[1], 1);`（用于加载彩色图像），因为 C 标准不支持默认参数。

顺便说一句，如果您使用的是 OpenCV 2.0+，我建议您学习[C++ API](http://opencv.willowgarage.com/documentation/cpp/introduction.html)。它比 C API 复杂得多，性能也相当。

# jquery - 点击时将标题放入div

> ID：14693074
> 
> 赞同：1
> 
> 时间：2013-02-04T18:27:24.357
> 
> 标签：jquery, variables, click

目前使用：

```
$(function () {
    $(".playbtn").on("button", "click", function (e) {
        var title = $(this).attr('name');
    });
});

$('.movie-title').html(title); 
```

我试图在单击时获取 playbtn 的名称内容并将其存储在变量中。然后把这个内容放到一个div中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:28:04.950

*   在所需功能*内*运行预期操作

*   你`delegated element selector`来错地方了。应该

```
$(function () {
    $(".playbtn").on("click", "button", function() {
        var title = $(this).attr('name');
        $('.movie-title').html(title);
    });
}); 
```

如果您想在另一个函数中使用该变量，则需要*全局*使用您的`var`like：

```
$(function () {

    var title = '';       // DEFINED

    $(".playbtn").on("click", "button", function() {
         title = $(this).attr('name');    // SET
        $('.movie-title').html(title);    // USED
    });

    $("#alertTitleButton").on("click", function() {
         alert( title );                  // USED
    });

}); 
```

阅读更多：`**[jquery.com/on](http://api.jquery.com/on/)**`

^(*Post Scriptum：*
请注意，以上将针对所有元素`.movie-title`，因此使用您的 jQuery 选择器更具体：) 

`**[jquery.com/selectors](http://api.jquery.com/category/selectors/)**` `**[jquery.com/traversing](http://api.jquery.com/category/traversing/)**`

# jquery - 如何验证两个输入 - jquery

> ID：14693075
> 
> 赞同：0
> 
> 时间：2013-02-04T18:27:25.813
> 
> 标签：jquery, validation

我有几组问题，每组问题包含 2 个输入字段。

```
 <!--Question Set-->
            <tr class="options_row">
                <td>
                <img src="images/top_bullet.gif" alt="bullet" />
                    I will only be satisfied with a usually high standard of living                    </td>
                <td width="5%">
                    <input name="score[]" type="text" class="score num" title="1" maxlength="1" />
                </td>
            </tr>                                  
            <tr class="options_row">
                <td>
                <img src="images/top_bullet.gif" alt="bullet" />
                    I wish to have considerable influence over other people.                    </td>
                <td width="5%">
                    <input name="score[]" type="text" class="score num" title="2" maxlength="1" />
                </td>
            </tr> 
```

现在我需要验证 2each 输入值集

例如

->问题集1->Input_1 + Input_2 >=3

->问题集1->Input_1 + Input_2 <=3

我尝试过使用该`closest`功能，但它不起作用。

`var score_val = $(this).closest('.score');`

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:44:25.307

您可以为每个集合添加一个额外的数据属性：

```
<input name="score[]" type="text" data-set="1" class="score num" title="1" maxlength="1" /> 
```

然后遍历那些：

```
var questionSet = {}, i = 0;
$('.score attr["data-set"]').each(function(){
    i++;
    questionSet[$(this).data('set') = {
        i: $(this).value()
    };
    i = (i > 2)? 0 : i;
}); 
```

这将返回一个对象，如：

```
questionSet = {
    1: {
        1: "value1",
        2: "value2"
    },
    2: {
        1: "value1",
        2: "value2"
    }
} 
```

现在你可以迭代这个对象：

```
for(x in questionSet){
    if (x[1] + x[2] >= 3) {
        // do something...
    } else {
        // do something else...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T06:25:34.077

毕竟这是我想出的

```
(function($) {
$.fn.calVal = function(params) {        
    params = $.extend({value:3,message:'The combined value should not be greater than or less than 3'});
    //Get the current node
    var $t = $(this);
        //If the node out of focus
        $t.blur(function() {
            //get the current group
            var data_set = $(this).attr('data-set');
            //the actual sum
            var total = 0;
            //loop through the current node to get the group of its own
            $t.each(function(){
                //get the group of sellected node
                var cur_data_set = $(this).attr('data-set');
                //if any matching group of the current node
                if(cur_data_set==data_set)
                {
                    //total the value of each selected node group
                    total += parseFloat($(this).val());
                }
            });
            //Validate the group value and return the result
            if(total>params.value)
            {
                alert(params.message);
                 $(this).val('');
            }else if(total<params.value)
            {
                alert(params.message);
                 $(this).val('');
            }
        });         
        // allow jQuery chaining
        return this;        
   };
 })(jQuery); 
```

逻辑可能有点蹩脚，但它对我有用；）

感谢 AvL 先生展示了正确的道路:)

# php - 为 pthread 配置 PHP

> ID：14693080
> 
> 赞同：1
> 
> 时间：2013-02-04T18:27:33.197
> 
> 标签：php, pthreads, centos

我正在尝试为 PHP 安装 pthreads，[这里是](https://github.com/krakjoe/pthreads)。

在 PHP 扩展手册中它说：

> 要启用 pthreads 支持，请使用 --enable-maintainer-zts 和 --enable-pthreads 配置 PHP。

我有一个安装了 PHP 的 CentOS 服务器，但我不知道如何使用这些设置重新配置它，我检查了我`phpinfo()`可以看到当前的 ./configure 选项。

如果有人能告诉我如何重新配置​​我的 php，我会很高兴。我是否需要先卸载当前的 PHP，然后再安装另一个，或者有什么方法可以轻松运行这个 ./configure 命令。我可以通过 SSH 访问我的服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-26T11:31:23.183

我已经写了一个关于这个的教程 - [Compile PHP with pthreads and ZTS enabled](http://blog.flowl.info/2015/compile-php-5-6-pthreads-mongo-ubuntu/)。

您必须编译 PHP，因为没有预构建的包。

重新配置您`./configure`主要使用的所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:30:59.517

您可以尝试使用 PECL 安装：

[http://pecl.php.net/package/pthreads](http://pecl.php.net/package/pthreads)。

如何安装 PECL 扩展： http: [//php.net/manual/en/install.pecl.php](http://php.net/manual/en/install.pecl.php)

```
pecl install pthreads 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-18T21:54:11.493

如果centos没有提供线程安全的版本，则必须自己编译php。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-10T16:45:31.950

您必须为您的 centos 操作系统构建 pthread。之后，您可以将其用作扩展程序...

使用以下教程

[http://blog.slowbro.org/2013/08/compiling-php-55-with-pthreads-on-centos/](http://blog.slowbro.org/2013/08/compiling-php-55-with-pthreads-on-centos/)

[http://eddmann.com/posts/compiling-php-5-5-with-zts-and-pthreads-support/](http://eddmann.com/posts/compiling-php-5-5-with-zts-and-pthreads-support/)

或者直接看说明书...

[http://www.php.net/manual/en/pthreads.installation.php](http://www.php.net/manual/en/pthreads.installation.php)

# powershell - 是否可以在另一个脚本中调用 powershell 脚本作为变量？

> ID：14693083
> 
> 赞同：2
> 
> 时间：2013-02-04T18:27:45.293
> 
> 标签：powershell, parameters, parameter-passing, powershell-2.0

我有一个 Powershell 脚本，用户在其中将脚本作为参数传递。传入之后，我无法使用 $scriptvariable 调用脚本。当需要从变量调用一个脚本时，有什么方法可以从另一个 Powershell 脚本中调用一个 Powershell 脚本。

```
param(
  [string]hostval,
  [string]$scriptpath
)

Invoke-Command -Computer $hostval -Scriptblock { $scriptpath } -credential $cred 
```

这不起作用，我不确定我想要的是否可行。是否有我可以使用的参数类型（例如：[script]$scriptpath）以便可以从 $scriptpath 调用脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T18:41:27.207

听起来您需要使用 -FilePath 参数，而不是 -Scriptblock：

```
-FilePath <String>
    Runs the specified local script on one or more remote computers. Enter the path and file name of the script, or pipe a script path to Invoke-Command. The script must reside on the local computer or in a directory that the local computer can access. Use the ArgumentList parameter to specify the values of parameters in the script. 
```

# c# - .NET 版本的 TNonblockingServer

> ID：14693085
> 
> 赞同：1
> 
> 时间：2013-02-04T18:27:53.430
> 
> 标签：c#, .net, thrift

Thrift 是否有任何已知的 .NET 版本的异步服务器和协议？特别是我正在寻找用 C# 编写的 TThreadedSelectorServer 版本。

我刚刚检查了 git 存储库，但与 Java 版本相比，CSharp 版本缺少很多东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-04T04:59:49.350

有一个RPC框架，使用标准thrift Protocol，名字叫“thrifty”，和使用thrift IDL定义服务的效果一样，即thrify可以兼容使用thrift IDL的代码，非常有帮助跨平台，它使用 DotNetty（windows 是 iocp，linux 是 nio）

```
[ThriftStruct]
public class LogEntry
{

    [ThriftConstructor]
    public LogEntry([ThriftField(1)]String category, [ThriftField(2)]String message)
    {
        this.Category = category;
        this.Message = message;
    }

    [ThriftField(1)]
    public String Category { get; }

    [ThriftField(2)]
    public String Message { get; }
}

[ThriftService("scribe")]
public interface IScribe
{
    [ThriftMethod("getMessages")]
    List<LogEntry> GetMessages();

    [ThriftMethod]
    ResultCode Log(List<LogEntry> messages);
}

public class Scribe : IScribe
{
    public List<LogEntry> GetMessages()
    {
        return new List<LogEntry>
        {
            new LogEntry { Category = "c1", Message = Guid.NewGuid().ToString() },
            new LogEntry { Category = "c2", Message = Guid.NewGuid().ToString() },
            new LogEntry { Category = "c3", Message = Guid.NewGuid().ToString() }
        };
    }

    public ResultCode Log(List<LogEntry> messages)
    {
        return ResultCode.TRY_LATER;
    }
} 
```

C#：[https](https://github.com/endink/Thrifty) ://github.com/endink/Thrifty 类似的Java可以使用Swift：[https ://github.com/facebook/swift](https://github.com/facebook/swift)

# css - 移动分辨率和 CSS 纵横比

> ID：14693087
> 
> 赞同：0
> 
> 时间：2013-02-04T18:27:59.243
> 
> 标签：css, responsive-design, media-queries

我正在使用 RWD 构建 Web 应用程序。我已经为不同的分辨率编写了媒体查询，例如 1024、768 和 320。

我使用下面的元标记来决定页面宽度

```
<meta  name="viewport" content="width=device-width, initial-scale=1" /> 
```

很少有设备，例如分辨率为 1136×640 的 iPhone 5。当我在 iPhone 中打开我的网页时，它在横向模式下显示 320 布局，因为它的分辨率显示它的 1136px 宽。

我知道它的 CSS 像素比为 2，但不确定 CSS 像素比、媒体查询宽度和设备分辨率计算之间的逻辑。

是否有任何文章或链接可以解释这一点，并会说明为什么它为 iPhone 显示 320 布局。

先谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:12:46.053

尝试使用此元声明：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
```

# jquery - jQuery 会在任何点击时重置 textarea，但据说只有在 textarea 具有特定值时才会这样做

> ID：14693088
> 
> 赞同：0
> 
> 时间：2013-02-04T18:28:00.710
> 
> 标签：jquery, textarea, reset

我目前遇到问题。我正在尝试重置我的 textarea，如果它具有值`Message...`（它在您加载页面时具有）。但就像现在一样，无论它有什么价值，它都会重置。这是我的jQuery代码：

```
if ($("#text").value = 'Message...') 
{
    $("#text").click(function () {
        $(this).val('');
    });
} 
```

HTML 代码只是表单中的一个文本区域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:35:01.133

`$("#text").value = 'Message...'`将始终为**真**，因为您使用的是赋值运算符。`===`改为用于比较。

```
if ($("#text").val() === 'Message...') 
{
    $("#text").click(function () {
        $(this).val('');
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:56:49.960

你的一些问题是

```
if ($("#text").value = 'Message...') 
// should be replaced with the line below
if ($(this).val() == 'Message...') 
```

请注意使用 of`val()`而`value`不是赋值运算符，我使用了相等运算符（您也可以使用身份运算符`===`）。

此外，您的文本总是被重置的原因是因为您的事件处理程序每​​次单击`#text`元素时都会重置文本，因此要实现预期的行为，您需要将逻辑包装在事件处理程序中。

```
$("#text").click(function () {
  if ($(this).val() == 'Message...')
    $(this).val('');
 }); 
```

如果您想实现“占位符”效果，可以改用以下内容：

```
$("#text").focusin(function () {
  if ($(this).val() == 'Message...')
    $(this).val('');
}).focusout(function() {
  if ($(this).val() == '')
    $(this).val('Message...');
}); 
```

# javascript - 在没有 java 插件的 phonegap 应用程序中共享链接

> ID：14693093
> 
> 赞同：0
> 
> 时间：2013-02-04T18:28:20.997
> 
> 标签：javascript, cordova, sharing

是否有任何可靠的方法可以在无需插件的情况下在 iphone 和 android 兼容的 phonegap 应用程序中共享链接？（我们正在通过 phonegap-build 构建，它不允许您包含任何 java 插件）

已尝试使用 iframe，但它们的行为奇怪且不一致，或者在 facebook 的情况下，甚至似乎都没有加载。

```
<iframe src="http://mobile.twitter.com/?status={{url}}" frameborder="0"></iframe>

<iframe src="https://m.facebook.com/sharer.php?u={{url}}" frameborder="0"></iframe> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T07:08:40.190

您可以使用 childbrowser(InAppBrowser for cordova 2.3) 插件来共享这些链接，基本上 childbrowser 允许您从应用程序内部启动浏览器对话框并且您可以完全控制它，该插件与 phonegap 构建兼容，因此您可以使用它不会失去使用官方 phonegap 构建的能力。

也不建议对 android 使用 iframe，因为 iframe 在移动浏览器中（特别是在 android 中）有一些奇怪的行为，我个人有一个实例，当 iframe 被隐藏时，android 姜饼设备中的页面没有滚动：P

# java - jmap输出理解

> ID：14693094
> 
> 赞同：1
> 
> 时间：2013-02-04T18:28:22.377
> 
> 标签：java, jvm, heap-memory, classloader

Jmap histo live O/P 是这样的：

```
 8:         72350       99408664  <instanceKlassKlass>
   9:         72350       85348552  <constantPoolKlass>
  10:         70884       48964288  <constantPoolCacheKlass> 
```

谁能解释一下instanceKlassKlass和其他两个的含义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:19:21.797

这些是用于类加载的内部 JVM 对象。

JVM 加载的每个类都在 VM 内部表示为 class 的一个实例`Klass`，这些对象驻留在堆中。因此，堆包含您的应用程序数据以及 VM 内部使用的数据/对象。

# php - PHP curl版本更改程序不起作用

> ID：14693099
> 
> 赞同：1
> 
> 时间：2013-02-04T18:28:42.593
> 
> 标签：php, curl

我已经使用 EASY PHP 在虚拟机中用 PHP 编写了一个应用程序（我知道我不应该使用 Windows，而是使用 Linux :)）。现在我已经将我的程序移到了一个 linux 真实服务器（事实上，这是我的 Synology 磁盘站），并且没有任何工作了。我做了一些调试，似乎我没有从 curl 函数中得到任何回报。

在我的 windows 服务器中，curl 版本是 7.21，现在在群晖上，版本是 7.26-DEV。也许是因为我使用的是DEV版本？

这是代码的一部分，我使用的是非常基本的 curl，所以我不知道是否需要做一些事情来激活 curl。当我在我的 linux 服务器上执行 phpinfo 时，我可以看到启用了 curl 支持。

代码：'

```
 $ch = curl_init();
   if ($debug == 1) 
   {
     curl_setopt($ch, CURLOPT_VERBOSE, 1);
   }
   curl_setopt($ch, CURLOPT_FRESH_CONNECT, true); 
   curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
   curl_setopt($ch, CURLOPT_POSTFIELDS, $xml_request);
   curl_setopt($ch, CURLOPT_COOKIESESSION, true); 
   curl_setopt($ch, CURLOPT_COOKIEJAR, './cookie/cookie.txt'); 
   curl_setopt($ch, CURLOPT_URL,$ihcip."ws/AuthenticationService");
   curl_setopt($ch, CURLOPT_TIMEOUT, $timeout); 
   curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout); 

   if (preg_match('`^https://`i', $ihcip)) 
   { 
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); 
   } 

   if ($debug == 1) {
      curl_setopt($ch, CURLOPT_HEADERFUNCTION, 'dbg_curl_data');
      curl_setopt($ch, CURLOPT_WRITEFUNCTION, 'dbg_curl_data');
      curl_setopt($ch, CURLINFO_HEADER_OUT, true);
   }

   $result = curl_exec($ch);
   if ($debug == 1) 
   {
      echo '<fieldset><legend>request headers</legend> <pre>', htmlspecialchars(curl_getinfo($ch, CURLINFO_HEADER_OUT)), '</pre> </fieldset>';
      echo '<fieldset><legend>xml request</legend> <pre>', htmlspecialchars($xml_request), '</pre> </fieldset>';
      echo '<fieldset><legend>response</legend> <pre>', htmlspecialchars(dbg_curl_data(null)), '</pre> </fieldset>';
   } 
```

'

# bash - 通过管道时为脚本传递参数

> ID：14693100
> 
> 赞同：48
> 
> 时间：2013-02-04T18:28:46.137
> 
> 标签：bash

我有这个示例 shell 脚本：

```
echo /$1/ 
```

所以我可以打电话

```
$ . ./script 5
# output: /5/ 
```

我想将脚本通过管道传输到 sh(ell)，但我也可以传递 arg 吗？

```
cat script | sh 
# output: // 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-02-04T18:41:14.313

`-s`您可以使用以下选项将参数传递给 shell ：

```
cat script | bash -s 5 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2018-12-04T03:52:50.680

采用`bash -s -- <args>`

例如，安装 google cloud sdk

`~ curl https://sdk.cloud.google.com | bash -s -- --disable-prompts`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-05-27T20:54:15.033

```
cat script | sh -s -- 5 
```

该`-s`参数告诉`sh`从标准输入中获取命令，并且不需要文件名作为位置参数。（否则，如果没有`-s`，下一个非标志参数将被视为文件名。）

告诉 sh 停止处理进一步的`--`参数，以便它们只被脚本拾取（而不是应用于`sh`自身）。这在您需要将标志传递给脚本的情况下很有用，该标志以`-`or开头`--`（例如：）`--dry-run`必须被忽略`sh`。另请注意， single`-`等效于`--`.

```
cat script | sh -s - --dry-run 
```

# c# - 发出一个覆盖两个同名接口方法的类

> ID：14693103
> 
> 赞同：3
> 
> 时间：2013-02-04T18:29:01.860
> 
> 标签：c#, .net, reflection.emit

我正在尝试使用 Reflection.Emit 发出一个将在运行时从多个接口继承的类，但我无法提前知道哪些接口。

根据[MSDN/TypeBuilder.DefineMethodOverride](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.definemethodoverride.aspx)：

> 要重写基类的方法或实现接口的方法，只需发出与要重写或实现的方法具有相同名称和签名的方法

这是我覆盖接口方法的代码：

```
private void OverrideMethod(TypeBuilder typeBuilder, 
                            Type interfaceToOverride,
                            MethodInfo methodToOverride)
{
    // Create the method stub
    MethodBuilder methodBuilder = typeBuilder.DefineMethod(
        methodToOverride.Name,
        MethodAttributes.Public
        | MethodAttributes.HideBySig
        | MethodAttributes.NewSlot
        | MethodAttributes.Virtual
        | MethodAttributes.Final,
        CallingConventions.HasThis,
        methodToOverride.ReturnType,
        methodToOverride.GetParameters().Select(p => p.ParameterType).ToArray()
    );

    // Implement the overriding method
    ILGenerator il = methodBuilder.GetILGenerator();

    // ... a bunch of calls to il.Emit ...

    // Return 
    il.Emit(OpCodes.Ret);
} 
```

这有效，除非我从两个都有同名方法的接口继承。显然，这是因为我没有给出该方法的完全限定名称。我不确定如何正确执行此操作。

更改`methodToOverride.Name`为`interfaceToOverride.FullName + "." + methodToOverride.Name`无效：发出时出现错误，“TypeLoadException：类没有实现。

使用`DefineMethodOverride`部分工作，但由于某种原因，当我针对嵌套接口测试它时没有。此外，上面链接的文档明确表示不要这样做。

解决此问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:32:09.427

正确的方法是定义一个名为的方法`<InterfaceName>.<MethodName>`，然后调用[`TypeBuilder.DefineMethodOverride`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.definemethodoverride.aspx).

> *当方法体和方法声明具有不同的名称时，*使用 DefineMethodOverride 方法。

在您的情况下，方法主体名称是`<InterfaceName>.<MethodName>`，而方法声明名称是`<MethodName>`。所以很好用[`TypeBuilder.DefineMethodOverride`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.definemethodoverride.aspx)。

**示例用法**：

```
private void OverrideMethod(TypeBuilder typeBuilder, 
                            Type interfaceToOverride,
                            MethodInfo methodToOverride)
{
    // Create the method stub
    MethodBuilder methodBuilder = typeBuilder.DefineMethod(
        /* Change method name here */
        string.Format("{0}.{1}", interfaceToOverride.FullName,
            methodToOverride.Name),
        MethodAttributes.Public
        | MethodAttributes.HideBySig
        | MethodAttributes.NewSlot
        | MethodAttributes.Virtual
        | MethodAttributes.Final,
        CallingConventions.HasThis,
        methodToOverride.ReturnType,
        methodToOverride.GetParameters().Select(p => p.ParameterType).ToArray()
    );

    // Implement the overriding method
    ILGenerator il = methodBuilder.GetILGenerator();

    // ... a bunch of calls to il.Emit ...

    // Return 
    il.Emit(OpCodes.Ret);

    // And define a methodimpl, which consists of a pair of metadata tokens.
    // One token points to an implementation, and the other token points
    // to a declaration that the body implements
    typeBuilder.DefineMethodOverride(methodBuilder, methodToOverride);
} 
```

**笔记**

实际上，您可以使用*任何*名称定义您的方法（使用`TypeBuilder.DefineMethod`） 。但它应该不同，您*必须*使用方法声明调用“链接”方法体。*`<MethodName>`*[`TypeBuilder.DefineMethodOverride`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.typebuilder.definemethodoverride.aspx)**

# c++ - istream::ignore() 是如何工作的？

> ID：14693106
> 
> 赞同：2
> 
> 时间：2013-02-04T18:29:08.933
> 
> 标签：c++

我一直在这里阅读有关 istream::ignore()[的信息](http://www.cplusplus.com/reference/istream/istream/ignore/)。我想我明白了它所做的功能的主要思想，但我已经看到了一些[只接受使用此功能的数字输入](http://en.cppreference.com/w/cpp/io/basic_istream/ignore)的示例，我不确定它为什么会起作用。

为什么这段代码会忽略除数字输入之外的所有内容？

```
#include <iostream>
#include <sstream>
#include <limits>

int main()
{
    std::istringstream input("1\n"
                             "some non-numeric input\n"
                             "2\n");
    for(;;) {
        int n;
        input >> n;

        if (input.eof() || input.bad()) {
            break;
        } else if (input.fail()) {
            input.clear(); // unset failbit
            input.ignore(std::numeric_limits<std::streamsize>::max(), '\n'); // skip bad input
        } else {
            std::cout << n << '\n';
        }
    }
} 
```

我曾认为 istream::ignore( ) 会忽略由某个数字指定的任何和所有字符，直到分隔符..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T18:32:29.327

当`input >> n;`遇到非数字输入时，它会设置`fail`标志。代码检查它是否已设置 ( `if (input.fail())`)，如果是，则忽略最多`numeric_limits<streamsize>::max()`字符，直到遇到换行符`\n`。实际上，这意味着遇到故障的行的其余部分将被忽略。

请注意，这仍会在行首读取一个数字，例如`"25 asdasf"`. 但是，如果该行是`"25 asdfasf 26"`25，则将读取 25，但随后会发生故障并忽略该行的其余部分，包括末尾的 26。

# cakephp - CakePHP：从视图中返回一个非 id

> ID：14693108
> 
> 赞同：0
> 
> 时间：2013-02-04T18:29:11.197
> 
> 标签：cakephp

我在cakephp中有一个表单，它实现了一个下拉，如下：

```
echo $this->Form->input('city', array('type' => 'select','options' => $cities,              'label' => 'City')); 
```

传递给视图的`$cities`数组类似于 `Array ( [0] => London [1] => Tokyo )`

该表单显示城市的名称（伦敦、东京、...）。

在提交表单时，表单会提交 id（键）（例如，如果用户选择了 London，则为“0”）。相反，我想将值（伦敦）作为文本。我需要在视图中进行哪些更改才能返回包含该值的字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:37:15.437

您可以通过以下`select`方法指定：

```
 echo $this->Form->select('city', array(
        'London' => 'London',
        'New York' => 'New York',
        'Tokyo' => 'Tokyo'
    )); 
```

将产生：

```
 <select name="data[Model][city]" id="ModelCity">
        <option value="London">London</option>
        <option value="New York">New York</option>
        <option value="Tokyo">Tokyo</option>
    </select> 
```

参见：[CakePHP 手册](http://book.cakephp.org/2.0/en/core-libraries/helpers/form.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:42:14.493

Cake 用您提供的值填充选择。如果你需要一个城市的名字，你需要传递一个数组，你的键就是这个名字。

```
$foo = array('London'=>'London', 'Tokyo'=>'Tokyo'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T18:39:05.407

将 $cities 数组格式化为关联数组，将“keys”和“values”都设置为城市名称；

```
 $cities = array(
     'London' => 'London',
     'Paris' => 'Paris',
     // etc.
 ); 
```

# c++ - C++：监控和条件变量进程间

> ID：14693110
> 
> 赞同：1
> 
> 时间：2013-02-04T18:29:16.820
> 
> 标签：c++, c++11

在学习了一个学期的并发编程理论之后，我想把我学到的东西付诸实践，即整体监视器。我知道监视器是一个收集数据结构、函数和条件变量的对象（类的实例）。我已经看到在 C++ 中我可以用线程来完成所有这些工作。相反，如果我想在进程之间共享一个监视器（条件、数据结构......），我该怎么办？也许用 fork() 创建...例如生产者和消费者。我已经看到有一个 boost 库可以在进程间共享条件变量……对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:53:41.177

有几种选择，请参阅主要搜索引擎上的*进程间通信。*如果您想共享对象和标志，听起来这两个进程紧密合作，在这种情况下线程是更好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T21:13:18.690

进程间通信通常通过操作系统信号量和共享内存完成。分配和管理这些资源的框架非常依赖于操作系统。

幸运的是，Boost C++ 库已经有一个独立于操作系统的抽象可以做到[这一点](http://www.boost.org/doc/libs/1_52_0/doc/html/interprocess/sharedmemorybetweenprocesses.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T22:31:26.290

一种方法是将问题拆分为 3 个或更多部分。

监视器上方法的抽象接口。如果对象应该是进程间的，您可以在后台实现 IPC，或者依赖每个进程具有相同的方法代码。

数据既可以存储在一个地方（每个人都使用 IPC 与那个地方通信），也可以存储在每个进程中并保持同步。请注意，数据的共享内存是 IPC 数据的一种解决方案（允许代码在每个进程中本地存在）。

第三部分是同步。这可以作为与“公共对象”完全不同的问题来处理，并且主要与您如何使其工作正交地解决。

一种方法是制作一个同步访问任意数据的模板，有点像这样：

```
template<typename T, typename MyMutex=std::mutex, typename MyLock=std::unique_lock>
struct Synced {
  mutable MyMutex mutex;
  T* t;
  Synced( T& t_ ):t(&t_), mutex() {}
  Synced( T& t_, MyMutex&& m ):t(&t_), mutex(std::move(m)) {}
  template<typename Functor>
  auto operator()( Functor&& f )->decltype( f(declval<T>()) ) const {
    MyLock _(mutex);
    return f(*t);
  }
}; 
```

这是一个围绕任意类型 T 的同步包装器的示例。即：

```
Synced<std::ostream> synced_cout(std::cout);
void test() {
  synced_cout([&](std::ostream& os) {
    os << "Hello world!\n";
  });
} 
```

我以`ostream`通用方式同步访问。

（以上大部分内容都是从 Bjarne Stroustrup 或 Herb Stutter 公然窃取的，任何错误都是我自己的）。

# php - 如果为空值，它不会进行插入

> ID：14693112
> 
> 赞同：0
> 
> 时间：2013-02-04T18:29:35.980
> 
> 标签：php, jquery, mysqli

我正在尝试为数据库中的每个问题插入每个答案。问题是问题可能没有答案，所以我尝试了下面的代码，但如果问题没有答案，它不会插入数据库行，我想做的是，如果没有答案，则显示该问题列`No Answer`下的字符串`Answer`：

```
 $answersql = "INSERT INTO Answer (QuestionId, Answer) 
    VALUES (?, ?)";
if (!$insertanswer = $mysqli->prepare($answersql)) {
    // Handle errors with prepare operation here
    echo __LINE__.': '.$mysqli->error;
}

if( $insert && $insertanswer)
{

    $c = count($_POST['numQuestion']);
    $question_ids = array();

    for($i = 0;  $i < $c; $i++ )
    {

... //Question INSERT goes here

        $questionId = $mysqli->insert_id;

            $question_ids[$questionNo] = $questionId;

}

        $results = $_POST['value'];
        foreach($results as $id => $value) 
        {
            $answer = $value;

            $quesid = (int)$question_ids[$id];   

            foreach($value as $answer) 
            {

            if($answer == '' || $answer === null){
                $answer = 'No Answer';
            }

                $insertanswer->bind_param("is", $quesid, $answer);

                $insertanswer->execute();

                if ($insertanswer->errno) {
                    // Handle query error here
                    echo __LINE__.': '.$insertanswer->error;
                    break 7;
                }
            }
        }

    //close your statements at the end

    $insertanswer->close();

} 
```

来自`['value']`输入：

```
var $newBtn = $(("<input class='answerBtnsRow answers' type='button' style='display:%s;' onclick='btnclick(this, " + gQuestionIndex + ");' />").replace('%s', $this.is(':visible') ? 'inline-block' : 'none')).attr('name', "value[" + gQuestionIndex + "][]").attr('value', $this.val()).attr('class', $this.attr('class')).attr('id', $this.attr('id') + 'Row'); 
```

更新：

下面是表的 SHOW CREATE TABLE `Answer`：

```
CREATE TABLE `Answer` (
 `AnswerId` int(10) NOT NULL AUTO_INCREMENT,
 `QuestionId` int(10) NOT NULL,
 `Answer` varchar(10) DEFAULT NULL,
 PRIMARY KEY (`AnswerId`)
) ENGINE=InnoDB AUTO_INCREMENT=280 DEFAULT CHARSET=utf8 
```

下面是一个 var 转储，如果我将问题 1 设置为有答案`B`并将`C`问题 2 设置为根本没有答案，它会输出以下内容：

```
var_dump($question_ids);
    var_dump($results);

 array(2) { 
[1]=> int(247) 
[2]=> int(248) 
} 
array(1) { 
[1]=> array(2) { 
[0]=> string(1) "B" 
[1]=> string(1) "C" } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:44:09.770

您可以从 var_dumps 看出您有两个问题，但只有一组答案。据我所知，您的设计缺陷并未将问题的答案与问题联系起来。

$results 中没有第二个索引，意味着没有第二组答案，因此没有插入...

但是如果您有三个问题和两个答案集，那么这些答案是否属于问题 1&2 或 2&3 或 1&3。我看不到您如何将您的问题 id 设置为结果集。

# jquery - 将变量传递给 JQuery 动画

> ID：14693113
> 
> 赞同：3
> 
> 时间：2013-02-04T18:29:36.817
> 
> 标签：jquery, jquery-animate, sprite

```
$(document).ready(function(){
for(var i=1;i<5;i++){
    var pos = -411*i;
    var pospx = "{'background-position-x':'"+ pos.toString() + "px'}";
    $("#newsPix").delay(2000).animate(pospx, 1000);
    }
}); 
```

我是一个 jquery 初学者，我正在尝试使用动画精灵来制作类似于幻灯片的东西。我一直试图让这段代码工作几个小时，但我不确定问题在哪里！我检查了 HTML 和 CSS，它们看起来很好。我认为问题在于将值传递给 animate 方法或为 pospx 变量添加字符串。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T18:33:21.727

您正在传递一个字符串，一个对象会更合适，因为它是 animate() 接受的：

```
$(document).ready(function(){
    for(var i=1; i<5; i++){
        var pos   = -411*i,
            pospx = {'background-position-x' : pos};

        $("#newsPix").delay(2000).animate(pospx, 1000);
    }
}); 
```

`background-position-x`并非所有浏览器都支持。

# c# - 为什么 SmtpMail 不发送，除非在 web.config 中设置了 from/host？

> ID：14693116
> 
> 赞同：0
> 
> 时间：2013-02-04T18:29:41.750
> 
> 标签：c#, asp.net

我正在尝试使用 SmtpMail 发送电子邮件。在我的本地服务器上，即使代码具有主机/服务器、密码和代码中设置的信息，我也可以执行此操作。在我的托管服务 (1and1) 上，它只会在我在 web.config 文件中设置这些内容时发送！有谁知道可能导致这种情况的原因（1and1 不知道）。

**在本地工作，但不在托管服务上**

```
<%@ Page language="c#" %>
<%@ Import namespace="System.Net.Mail" %>
<%

    MailMessage mail = new MailMessage();

    //Set my from address
    mail.From = new MailAddress( "myemail@myemail.com");

    //Who I'm sending to
    mail.To.Add( new MailAddress("you@you.com") );

    mail.Subject = "A test";
    mail.Body = "Test message";

    //Set the mail server (default should be smtp.1and1.com)
    SmtpClient smtp = new SmtpClient( "smtp.1and1.com" );

    //Enter your full e-mail address and password
    smtp.Credentials = new NetworkCredential("myemail@myemail.com", "mypassword");

    //Send the message
    smtp.Send(mail);

%> 
```

**这就是我如何让它在主机上工作（两个文件，测试页和 web.config）**

```
<%@ Page language="c#" %>
<%@ Import namespace="System.Net.Mail" %>
<%

    MailMessage mail = new MailMessage();

    //Set my from address
    mail.From = new MailAddress( "myemail@myemail.com");

    //Who I'm sending to
    mail.To.Add( new MailAddress("you@you.com") );

    mail.Subject = "A test";
    mail.Body = "Test message";

    //Create with no server or credentials (grabs from web.config)
    SmtpClient smtp = new SmtpClient();

    //Send the message
    smtp.Send(mail);

%> 
```

（和 web.config）

```
 <configuration>
    <system.net>
        <mailSettings>
            <smtp from="myemail@myemail.com">
                <network host="smtp.1and1.com" port="25" userName="myemail@myemail.com" password="mypassword"/>
            </smtp>
        </mailSettings>
    </system.net>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:43:40.887

我看到您在使用本地代码时没有设置 SMTP 端口，而是在 web.config 中设置了它。您是否尝试过像这样手动添加 SMTP 端口：

```
smtp.Port = 25; 
```

另外，您是否尝试过手动设置 EnableSsL 属性？

# sql - 当表列相同时，EXCEPT 是否比 JOIN 执行得快

> ID：14693118
> 
> 赞同：10
> 
> 时间：2013-02-04T18:29:51.640
> 
> 标签：sql, sql-server, performance, join, except

要查找两个数据库之间的所有更改，我将加入 pk 上的表并使用 date_modified 字段来选择最新记录。`EXCEPT`由于表具有相同的架构，因此将使用提高性能。我想用 a 重写它`EXCEPT`，但我不确定 for 的实现是否会在每种情况下`EXCEPT`都执行 a 。`JOIN`希望有人对何时使用有更技术性的解释`EXCEPT`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-04T18:39:01.817

任何人都无法告诉您，它`EXCEPT`总是或永远不会胜过同类产品`OUTER JOIN`。无论您如何编写意图，优化器都会选择适当的执行计划。

也就是说，这是我的指导方针：

* * *

`EXCEPT`当*以下至少一项*为真时使用：

1.  查询更具可读性（这几乎总是正确的）。
2.  性能得到改善。

*以下两个*都是真的：

1.  该查询产生语义相同的结果，您可以通过充分的回归测试来证明这一点，包括所有边缘情况。
2.  性能不会降低（同样，在所有边缘情况下，以及环境变化，例如清除缓冲池、更新统计信息、清除计划缓存和重新启动服务）。

* * *

重要的是要注意，编写等效`EXCEPT`查询可能是一个挑战，因为它`JOIN`变得更加复杂和/或您依赖于部分列而不是其他列中的重复项。写一个`NOT EXISTS`等价的，虽然可读性比`EXCEPT`完成起来要简单得多 - 而且通常会导致更好的计划（但请注意，我永远不会说`ALWAYS`or `NEVER`，除非我刚才那样做）。

[在这篇博文中，我展示了至少一个案例，其中`EXCEPT`一个被正确构造`LEFT OUTER JOIN`的，当然还有一个等效的`NOT EXISTS`变体](http://www.sqlperformance.com/2012/12/t-sql-queries/left-anti-semi-join)所胜过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-04T09:14:50.447

在以下示例中，`LEFT JOIN`速度比`EXCEPT`70 **%** (PostgreSQL 9.4.3)快

例子：

有三张桌子。`suppliers`, `parts`, `shipments`. 我们需要得到不是伦敦任何供应商提供的所有零件。

数据库（在所有涉及的列上都有索引）：

```
CREATE TABLE suppliers (
  id     bigint    primary key,
  city   character varying NOT NULL
);

CREATE TABLE parts (
  id     bigint    primary key,
  name   character varying NOT NULL,
);

CREATE TABLE shipments (
  id          bigint primary key,
  supplier_id bigint NOT NULL,
  part_id     bigint NOT NULL
); 
```

记录数：

```
db=# SELECT COUNT(*) FROM suppliers;
  count
---------
 1281280
(1 row)

db=# SELECT COUNT(*) FROM parts;
  count
---------
 1280000
(1 row)

db=# SELECT COUNT(*) FROM shipments;
  count
---------
 1760161
(1 row) 
```

使用 查询`EXCEPT`。

```
SELECT parts.*
  FROM parts

EXCEPT

SELECT parts.*
  FROM parts
  LEFT JOIN shipments
    ON (parts.id = shipments.part_id)
  LEFT JOIN suppliers
    ON (shipments.supplier_id = suppliers.id)
 WHERE suppliers.city = 'London'
;

-- Execution time: 3327.728 ms 
```

使用`LEFT JOIN`with 表查询，由子查询返回。

```
SELECT parts.*
  FROM parts
  LEFT JOIN (
    SELECT parts.id
      FROM parts
      LEFT JOIN shipments
        ON (parts.id = shipments.part_id)
      LEFT JOIN suppliers
        ON (shipments.supplier_id = suppliers.id)
     WHERE suppliers.city = 'London'
  ) AS subquery_tbl
  ON (parts.id = subquery_tbl.id)
WHERE subquery_tbl.id IS NULL
;

-- Execution time: 1136.393 ms 
```

# c# - GridView 复选框字段是灰色的？

> ID：14693124
> 
> 赞同：1
> 
> 时间：2013-02-04T18:30:00.860
> 
> 标签：c#, asp.net

我有一个从数据集中绘制字段的 GridView：

```
protected void Page_Load(object sender, EventArgs e)
{
    var dat = SecurityManager.GetAllGroups();
    GridView1.DataSource = dat;
    GridView1.DataBind();
} 
```

其中之一是 IsAdministrator 属性。

它应该显示为一个复选框。可以，但它是灰色的。我希望启用它，以便我可以修改它。从那里，我将浏览每一行并相应地更新。

这可能吗？如何取消选中复选框？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:33:37.803

如果您使用[CheckBoxField](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxfield.aspx)，则只能在编辑模式下更改值。要解决此问题，如果您想要所有行的复选框，请使用[TemplateField](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.templatefield.aspx)并在项目模板中提供一个复选框，例如：

```
<asp:TemplateField ..>
   <ItemTemplate>
      <asp:CheckBox .. Checked='<%# Bind("IsAdministrator") %>' />
   </ItemTemplate>
</asp:TemplateField> 
```

# for-loop - 防止 Windows 命令解释器 (FOR) 将列表视为通配符？

> ID：14693125
> 
> 赞同：0
> 
> 时间：2013-02-04T18:30:03.550
> 
> 标签：for-loop, batch-file, wildcard, command-prompt, wildcard-expansion

我正在尝试编写一个带有几个参数的批处理文件，后跟一个或多个可选文件名（可能包括通配符），并在某些时候处理每个可选文件名，但该`for`命令一直试图扩展它们，所以即使只是打印它们也行不通。

我检查了帮助 ( `for /?`)，但似乎没有任何开关可以防止这种情况发生。我尝试使用单引号、双引号和反引号以及`/f`，但似乎没有任何效果。

以下命令按预期工作：

```
> for %i in (foo bar baz) do @echo %i
foo
bar
baz 
```

以下命令不会：

```
> for %i in (foo bar baz really?) do @echo %i
foo
bar
baz 
```

以下，甚至更少：

```
> ren > reallyz
The syntax of the command is incorrect.

> dir /b really*
reallyz

> for %i in (foo bar baz really?) do @echo %i
foo
bar
baz
reallyz 
```

有没有办法让 Windows 命令解释器将传递的列表视为字符串，而不是尝试将其解释为文件名通配符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T21:55:33.633

否 - 简单的 FOR 命令将始终扩展通配符`*`和`?`通配符。

您需要使用 GOTO 循环来执行您想要的操作。SHIFT 命令可以访问所有参数。

```
@echo off
:argLoop
if "%~1" neq "" (
  echo %1
  shift /1
  goto :argLoop
) 
```

很可能你想对参数做更多的事情，然后打印它们。通常，您会将它们存储在变量“数组”中以供以后使用。

```
@echo off
setlocal

set argCnt=1
:argLoop
if "%~1" neq "" (
  set "arg.%argCnt%=%~1"
  set /a argCnt+=1
  shift /1
  goto :argLoop
)
set /a argCnt-=1

:: Show Args
setlocal enableDelayedExpansion
for /l %%N in (1 1 %argCnt%) do echo arg.%%N = !arg.%%N! 
```

# memory - gcc：设备上没有剩余空间？

> ID：14693131
> 
> 赞同：5
> 
> 时间：2013-02-04T18:30:28.377
> 
> 标签：memory, gcc, ubuntu, compilation

我正在尝试在 Ubuntu 10 中使用简单的 gcc 命令编写一些 C 代码，但由于某种原因，我不断收到错误消息：

```
Cannot create temporary file in /tmp/: No space left on device 
```

但问题是，我的磁盘上有足够的空间。这是 df -h 的输出：

```
Filesystem            Size  Used Avail Use% Mounted on
/                     3.7G  2.4G  1.1G  70% /
devtmpfs              312M  112K  312M   1% /dev
none                  312M   24K  312M   1% /dev/shm
none                  312M   80K  312M   1% /var/run
none                  312M     0  312M   0% /var/lock
none                  312M     0  312M   0% /lib/init/rw 
```

还有 df -i，以防您对 inode 感到疑惑：

```
Filesystem            Inodes   IUsed   IFree IUse% Mounted on
/                     240960  195198   45762   82% /
devtmpfs               79775     609   79166    1% /dev
none                   79798       3   79795    1% /dev/shm
none                   79798      41   79757    1% /var/run
none                   79798       2   79796    1% /var/lock
none                   79798       1   79797    1% /lib/init/rw 
```

我也可以`touch /tmp/test`成功，所以我知道我的驱动器上有空间。关于为什么 gcc 突然决定放弃的任何想法？（它早些时候工作）事先谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T03:26:40.700

在我看来，您的 /tmp 目录实际上是挂载的`devtmpfs`，如果我没记错的话，它实际上是您计算机的 RAM。

您可以随时重新启动并查看是否有帮助，增加您的虚拟内存分区，或者您可以关闭正在运行的程序以查看是否有帮助。此外，您可以从 /tmp 中删除一些不必要的文件，因为它们至少在会话的生命周期内是不稳定的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T03:58:41.083

中间文件对于 来说太大了`/tmp`，因此使用另一个临时目录 ( `TMPDIR=/var/tmp g++ ...`) 可能会有所帮助。

# jquery - 将 Facebook 连接按钮更改为我自己的图像

> ID：14693133
> 
> 赞同：0
> 
> 时间：2013-02-04T18:30:36.423
> 
> 标签：jquery, css, facebook, button, customization

我正在使用 Facebook PHP SDK 将用户登录到我的网站。但我的问题是我不明白如何将按钮更改为我自己的按钮/图像。

```
<div class="fb-login-button" onlogin="javascript:CallAfterLogin();" size="xlarge" scope="<?php echo $fbPermissions; ?>">Connect With Facebook</div> 
```

这就是我的代码的外观。但我想显示我的图像“connect.png”而不是他们给我的丑陋标准按钮。

你能帮助我吗？

爱/卡尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:42:15.623

使用提到的 fb-login-button 您不能指定自己的图像。但是您可以创建自己的 facebook 登录页面链接（附加到自定义图像）。看看这里，如何获取您的个人登录网址：

[https://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/](https://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/)

# javascript - 在此块中用 if/else 替换嵌套的条件运算符

> ID：14693135
> 
> 赞同：3
> 
> 时间：2013-02-04T18:30:39.150
> 
> 标签：javascript, conditional-operator

如果使用 if/else 语句而不是三元语句，这个块会是什么样子？

> 返回值 == 空？名称.local ? attrNullNS : attrNull : typeof value === "function" ? 名称.local ? attrFunctionNS : attrFunction : name.local ? attrConstantNS : attrConstant;

（我想确定在处理另外 15 个类似块之前我这样做是正确的......理想情况下，我想用正则表达式替换所有这些块，但似乎没有方法？ [用 if/else 自动替换条件运算符?](https://stackoverflow.com/questions/14690067/replace-conditional-operator-with-if-else-automatically) )

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:52:54.380

好问题。

首先，我同意给你留下这段代码的开发者应该是 LARTed。

但是，如果您认为[条件运算符的语法是](http://www.ecma-international.org/ecma-262/5.1/#sec-11.12)[or](http://www.ecma-international.org/ecma-262/5.1/#sec-11.12)并且[*最长*](http://www.ecma-international.org/ecma-262/5.1/#sec-7)[可能的](http://www.ecma-international.org/ecma-262/5.1/#sec-7)[匹配获胜](http://www.ecma-international.org/ecma-262/5.1/#sec-7)，您可以弄清楚这一点（没有[Eclipse JSDT](http://www.eclipse.org/webtools/jsdt/)等代码格式化程序） 。[`LogicalORExpression ? AssignmentExpression : AssignmentExpression``… : AssignmentExpressionNoIn`](http://www.ecma-international.org/ecma-262/5.1/#sec-11.12)[](http://www.ecma-international.org/ecma-262/5.1/#sec-7)

 *属于同一原子条件操作的相邻表达式不能在两边用 s 或 s 分隔，*因为*`?`语法`:`不允许这样做。因此，只需将自己置于根据 ECMAScript 语法工作的 LL(n) 解析器的位置；-) 反复问自己一个问题：“这段代码可以由该目标符号的产生式生成吗？”；如果答案是“否”，则回溯到较短的匹配，直到可以，或者如果没有生产工作，则失败并出现语法错误。

 *1.  `return` **`(`**`value == null ? name.local ? attrNullNS : attrNull : typeof value === "function" ? name.local ? attrFunctionNS : attrFunction : name.local ? attrConstantNS : attrConstant`**`)`**`;`
2.  `return (value == null ?` **`(`**`name.local ? attrNullNS : attrNull` **`)`** `:` **`(`**`typeof value === "function" ? name.local ? attrFunctionNS : attrFunction : name.local ? attrConstantNS : attrConstant`**`)`**`);`
3.  `return (`**`(`**`value == null`**`)`** `? (name.local ? attrNullNS : attrNull) : (` **`(`**`typeof value === "function"`**`)`** `?` **`(`**`name.local ? attrFunctionNS : attrFunction`**`)`** `:` **`(`**`name.local ? attrConstantNS : attrConstant`**`)`**`));`

所以：

```
if (value == null)
{
  if (name.local)
  {
    return attrNullNS;
  }
  else
  {
    return attrNull;
  }
}
else
{
  if (typeof value === "function")
  {
    if (name.local)
    {
      return attrFunctionNS;
    }
    else
    {
      return attrFunction;
    }
  }
  else
  {
    if (name.local)
    {
      return attrConstantNS;
    }
    else
    {
      return attrConstant;
    }
  }
} 
```

（CMIIW。）这可以进一步简化为

```
if (value == null)
{
  if (name.local)
  {
    return attrNullNS;
  }

  return attrNull;
}

if (typeof value === "function")
{
  if (name.local)
  {
    return attrFunctionNS;
  }

  return attrFunction;
}

if (name.local)
{
  return attrConstantNS;
}

return attrConstant; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T20:05:17.493

三元运算符和无块 if-else 语句的语法（“分组”）非常相似，因此您可以先将 each 替换`… ?`为，将`if (…)`each`:`替换为`else`。然后将`return`每个语句包装起来，并使用自动缩进。也许您甚至可以通过自动替换仔细（逐步）完成其中一些任务。你最终会得到

```
if (value == null)
    if (name.local) 
        return attrNullNS;
    else
        return attrNull;
else if (typeof value === "function")
    if (name.local)
        return attrFunctionNS;
    else
        return attrFunction;
else if (name.local)
    return attrConstantNS;
else
    return attrConstant; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T18:46:48.643

只需替换三元运算符，这真的很快，但我猜它看起来很像这样：

```
if (value == null) {
    if (name.local) {
        return attrNullNS;
    }else{
        return attrNull;
    }
}else if (typeof value === "function") {
    if (name.local) {
        return attrFunctionNS;
    }else{
        return attrFunction;
    }
}else{
    if (name.local) {
        return attrConstantNS;
    }else{
        return attrConstant;
    }
} 
```**

# ruby-on-rails - 如何优化和检查 Rails 中的 N+1 DB 查询？

> ID：14693137
> 
> 赞同：-2
> 
> 时间：2013-02-04T18:30:44.610
> 
> 标签：ruby-on-rails, postgresql

我相信我有一个 N + 1 问题，但我想看看是否有人可以就如何优化这个问题提供任何建议，因为我的代码正在运行太多查询。

**控制器/profit_reports_controller.rb**

```
def weekly
 @sales = Sale.by_category(@category).this_week(@beg_of_week)
 @departments = Department.by_category(@category)
end 
```

**利润报告/weekly.html.erb**

```
<% @departments.each do |department| %>
  <% @stores.each do |store| %>
    <% @sale = @sales.by_store(store).by_department(department).sum(:amount) %> 
```

**模型/sale.rb**

```
#Associations
belongs_to :store
belongs_to :department

#Scopes
scope :by_category, lambda {|category| where(:category_id => category.id)}
scope :by_department, lambda {|department| where(:department_id => department.id)}
scope :by_store, lambda {|store| where(:store_id => store.id)}
scope :this_week, lambda {|beg_of_week| where(:date_of_sale =>  beg_of_week..beg_of_week + 6.days)} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:45:48.813

我强烈建议使用[Bullet](https://github.com/flyerhzm/bullet) gem。从回购：

> Bullet gem 旨在通过减少查询次数来帮助您提高应用程序的性能。它会在您开发应用程序时监视您的查询，并在您应该添加急切加载（N+1 个查询）、何时使用不必要的急切加载以及何时应该使用计数器缓存时通知您。

它还将告诉您如何修复它。玩得开心！

# ios - 按专辑排序 MPMediaItem

> ID：14693138
> 
> 赞同：1
> 
> 时间：2013-02-04T18:30:46.927
> 
> 标签：ios, objective-c, mpmediaitem

我有一个“歌曲” NSMutableArray，里面装满了设备上的所有歌曲：

```
 MPMediaQuery *everything = [MPMediaQuery songsQuery];   
    NSArray *songCollections = [everything collections];

    songs = [NSMutableArray array];
    for (MPMediaItemCollection *song in songCollections) {
        MPMediaItem *representativeItem = [song representativeItem];  
        [songs addObject:representativeItem];
    } 
```

有没有办法按专辑对它们进行排序？我注意到添加

```
 [everything setGroupingType:MPMediaGroupingAlbum]; 
```

产生一个奇怪的结果（它只是将每张专辑的第一首歌推入数组）

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:57:20.437

您可以获取专辑，然后遍历它们以填充歌曲数组，从而根据专辑对歌曲进行排序：

```
NSMutableArray *sortedSongs = [[NSMutableArray alloc] init];
MPMediaQuery *albums = [MPMediaQuery albumsQuery];
NSArray* albumObjects = [albums collections];
for(MPMediaItemCollection *album in albumObjects) {
    for(MPMediaItem *song in album.items) {
        [sortedSongs addObject:song];
    }
}

NSLog(@"sorted songs : %@", sortedSongs); 
```

希望这可以帮助

# asp.net-mvc - 防止在多对多关系中重复插入

> ID：14693139
> 
> 赞同：1
> 
> 时间：2013-02-04T18:30:48.233
> 
> 标签：asp.net-mvc, asp.net-mvc-4, ef-code-first

我使用 MVC 4 和 EF Code First 5，我对 post 和 tag 实体有一个多对多的关系，

```
public class Post : BaseEntity
{

    public int PostId { get; set; }
    public string Title { get; set; }
    public string Content { get; set; }

    public virtual ICollection<PostTag> Tags { get; set; }
}

public class PostTag : BaseEntity
{
    public int TagId { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Post> Posts { get; set; }
} 
```

在 post 实体中使用这个 Fluent 映射：

```
 HasMany(p => p.Tags)
        .WithMany(t => t.Posts)
        .Map(pt => pt.ToTable("PostTagsJunction")
            .MapLeftKey("PostId")
            .MapRightKey("TagId")); 
```

我添加新帖子的帖子服务：

```
public void Add(Post entity)
{
    _posts.Add(entity);
} 
```

我的问题是：当我添加带有此标签的新帖子实体时：[“A”，“B”，“C”]

在数据库中存在这个标签：[“B”，“H”，“E”]，

但是在标签实体中插入新的[“B”]记录，这是重复的！

我必须如何插入只插入 ["A","C"] 标签的新帖子？

我想变成这个（新帖子ID是3）：

帖子：

```
postid
1
2
3 
```

标签：

```
tagid   name
1       B
2       H
3       E
4       A
5       C 
```

PostTagsJunction：

```
postid   tagid
1        2
1        3
2        3
2        1
3        1
3        4
3        5 
```

# c# - C 到 C# 字节数组 + 十六进制

> ID：14693143
> 
> 赞同：1
> 
> 时间：2013-02-04T18:31:03.933
> 
> 标签：c#, c, bytearray

我目前正在尝试将此 C 代码转换为 C#。
由于我对 C 不是很熟悉，因此非常感谢您的帮助！

```
static unsigned char byte_table[2080] = {0}; 
```

首先，一些字节数组被声明但从未填充，我可以接受

```
BYTE* packet = //bytes come in here from a file
int unknownVal = 0;
int unknown_field0 = *(DWORD *)(packet + 0x08);
do
{
    *((BYTE *)packet + i) ^= byte_table[(i + unknownVal) & 0x7FF];
    ++i;
}
while (i <= packet[0]); 
```

但是在这里..我真的不知道如何将其转换为 C#
BYTE = byte[] 对吗？
DWORD = 双倍？
但是如何翻译 (packet + 0x08) 呢？如何将十六进制添加到字节数组？哦

，我会很高兴有任何帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:56:50.990

在 C 中`{0}`，如果我没记错的话，将任何一组内存设置为会将整个内存区域设置为零。

可以以更简单、对 C# 友好的方式重写该底部循环。

```
byte[] packet = arrayofcharsfromfile;
int field = packet[8]+(packet[9]<<8)+(packet[10]<<16)+(packet[11]<<24); //Assuming 32 bit little endian integer
int unknownval = 0;
int i = 0;

do //Why waste the newline? I don't know. Conventions are silly!
{
    packet[i] ^= byte_table[(i+unknownval) & 0x7FF];
} while( ++i <= packet[0] ); 
```

`field`通过获取包括索引 8 在内的四个字节并从它们生成一个 32 位 int 来设置。

在 C 中，您可以将指针转换为其他类型，就像在您提供的代码段中所做的那样。他们正在做的是获取一个字节数组（每个字节的大小为 DWORD 的 1/4）并将 8 添加到索引中，从而使指针前进 8 个字节（因为每个元素都是一个字节宽），然后处理该指针作为 DWORD 指针。简单来说，他们将字节数组转换为 DWORD 数组，然后将索引 2 设为`8/4=2`.

正如我在上面演示的那样，您可以通过将字节串在一起以及位移和加法以安全的方式模拟这种行为。它没有那么高效，也没有那么漂亮，但它完成了同样的事情，而且也是以与平台无关的方式。并非所有平台都是小端。

# android - 不能在不改变其大小的情况下定位 RelativeLayout 视图的子级

> ID：14693145
> 
> 赞同：1
> 
> 时间：2013-02-04T18:31:13.320
> 
> 标签：android, android-layout, android-relativelayout

如果我尝试设置 RelativeLayout 视图的子视图的顶部/左侧边距，以便子视图将部分显示在屏幕的右侧/底部之外，问题是视图的大小缩小并完全显示在屏幕上（满足上边距/左边距，但改变大小）。我不想改变大小。

我通过设置顶部和左侧边距以编程方式设置 RelativeLayout 视图的子视图的位置，如下所示：

```
RelativeLayout.LayoutParams childViewParams = new RelativeLayout.LayoutParams(250,250);
childView = new ImageView(this);    
relLayoutView.addView(childView);
childViewParams.leftMargin = somethingBigEnoughToPutOffRightHandSide;
childViewParams.topMargin = something;
childView.setLayoutParams(childViewParams); 
```

如果我设置顶部/左侧边距以使该子视图应部分显示在屏幕的左侧/顶部之外，则一切都按预期工作，大小没有变化，并且视图部分移出屏幕。

**如何指定视图的位置，以便视图的大小永远不会改变，无论位置如何，部分或完全不在屏幕上？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-31T02:41:20.410

所需要的只是将右边距和下边距设置为超出视图和屏幕可能大小的负值。像这样的东西：

```
RelativeLayout.MarginLayoutParams params = (RelativeLayout.MarginLayoutParams) someView.getLayoutParams();
params.setMargins(leftMargin,rightMargin,-1000,-1000);
someView.setLayoutParams(params); 
```

# generics - 通用二叉搜索树

> ID：14693146
> 
> 赞同：0
> 
> 时间：2013-02-04T18:31:15.643
> 
> 标签：generics, c++-cli, binary-search-tree

我正在开发一个二叉搜索树控制台应用程序，特别是一种列出两个目标节点之间最短路径的方法。我的方法是

1) 创建树中从根节点到目标的每个目标节点的值的 ArrayList（每个路径一个 ArrayList） 2) 比较两个 ArrayList，删除除最后一个之外的所有重复项（这将表示两个路径分支 3) 将剩余的两个 ArrayList 组合成一个数组并使用 for 循环打印到控制台

这是我正在使用的方法。我遇到的问题是我永远不会进入读取“if (list1[n] == list2[n])”的块，即使 ArrayLists 正在打印出 _pathArrayList1 的值 Contents: 5, 7 , 9 _pathArrayList2 的内容: 5, 7, 9, 10, 12, 11

我尝试了打字，但这没有帮助。

```
array<T>^ removeDuplicates(ArrayList^ list1, ArrayList^ list2)
{
    int forLoopCount;
    int i; // for loop iterator for this method
    Console::WriteLine(L"Contents of _pathArrayList1: ");
    for (i = 0; i < list1->Count; i++)
        Console::WriteLine(list1[i]);

    Console::WriteLine(L"Contents of _pathArrayList2"); 
    for (i = 0; i < list2->Count; i++)
        Console::WriteLine(list2[i]);

    // find out which array is the shortest; we need to use the shorter of the two
    if (list1->Count - list2->Count < 0)
        forLoopCount = list1->Count;
    else
        forLoopCount = list2->Count;
    Console::WriteLine("Value of forLoopCopunt is " + forLoopCount);
    array<T>^ combineArray = gcnew array<T>(forLoopCount);

    for (int n = 0; n < forLoopCount; n++)
    {
        Console::WriteLine(L"List1[n] = " + list1[n]);
        Console::WriteLine(L"list2[n] = " + list2[n]);

        if (list1[n] == list2[n])  // never entering this block of code
        {
            if (list2[n+1] == list1[n+1])
            {
                Console::WriteLine(L"Removing " + list1[n] + " and " + list2[n]);
                list1->RemoveAt(n);
                list2->RemoveAt(n);
                n --;
            }
            else
            {
                Console::WriteLine(L"Deleting " + list1[n]);
                list1->RemoveAt(n);
                //_pathArrayList1->Reverse();
                return combineArray = combineArrays(_pathArrayList1, _pathArrayList2);
            }
        }
    }
    return combineArray = combineArrays(_pathArrayList1, _pathArrayList2);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:47:50.917

请澄清“我试过打字，但没有帮助。”。

`ArrayList`不使用泛型，因此它将所有内容都作为对象处理。即使这两个对象是整数，当它们被键入为 Object 时，`==`也不会像您期望的那样比较整数值。

```
Object^ o1 = 1;
Object^ o2 = 1;

bool asObject = (o1 == o2); // false
bool asInt = ((int)o1 == (int)o2); // true 
```

如果您切换出`ArrayList`for `List<int>`，那么`==`将按您的预期工作，并具有类型安全的额外好处。

其他注意事项：

*   设置时使用[Math.Min](http://msdn.microsoft.com/en-us/library/h5sbzt2y.aspx)`forLoopCount`。如果其他人不得不停下来思考一下代码是否正确，那么对于这么简单的事情，请使用该函数。
*   在检查 if 之前`list2[n+1] == list1[n+1]`，请确保两个列表中都有一个额外的项目。`list1[n]`在您的示例数据（5-7-9 和 5-7-9-10-12-11）中，当9时，这会给您一个例外。
*   您可以删除`gcnew array<T>(forLoopCount)`，甚至`combineArray`完全删除。当您分配 combineArrays 的返回值时，该对象将被丢弃。

* * *

## 编辑

如果传递列表中的对象是项目本身（不是它们的节点地址，或者其他总是 的东西`int`），那么我建议添加`where T : IEquatable<T>`到通用定义中。这为您提供了一个[Equals(T)](http://msdn.microsoft.com/en-us/library/ms131190.aspx)方法，您可以使用它来代替`==`，它不是为所有类型定义的。（如果你在你的类型上实现这个，只要确保实现所有三个方法 Equals(T)、Equals(object) 和 GetHashCode()，这样一切都是一致的。）

为了帮助首先构建搜索树，您可能会发现它[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)很有用。使用 CompareTo 方法而不是比较运算符（例如，`<`）。

# java - Java中的float和int值减法

> ID：14693147
> 
> 赞同：0
> 
> 时间：2013-02-04T18:31:16.123
> 
> 标签：java, type-conversion

我认为跟随以某种方式与浮点值的精度有关，但我不确定如何以及为什么观察到完全跟随的行为。我在java中有以下代码：

```
class float_int
{
    void float_to_int(float val)
    {
        int int_val = (int)val;
        float remain_val = val - (float)int_val;
        System.out.println("val - " + val);
        System.out.println("int_val - " + (float)int_val);
        System.out.println("remain_val - " + remain_val);
    }

    public static void main(String args[])
    {
        float_int obj = new float_int();
        obj.float_to_int((float)12.345);
    }
} 
```

我得到以下输出：

```
val - 12.345
int_val - 12.0
remain_val - 0.34500027 
```

现在我不知道为什么我最后会为剩余值获得额外的“27”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:32:44.313

因为两者`12.345`都不`0.345`能用二进制浮点数精确表示。

[例如](http://ideone.com/OT8gLM)：

```
float f = 12.345f;
System.out.printf("%.15f\n", f);  // Displays 12.345000267028809 
```

在上面的代码中，12.345000267028809 是可以精确表示的最接近的**值**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:32:54.693

你是对的，这是因为浮点数不精确。

如果您希望正确表示您的浮点数，您可以使用这个人似乎采用的相同方法：http: [//floating-point-gui.de/languages/java/](http://floating-point-gui.de/languages/java/)

这是对浮点数进行四舍五入：

```
String.format("%.2f", 1.2399) // returns "1.24"
String.format("%.3f", 1.2399) // returns "1.240"
String.format("%.2f", 1.2) // returns "1.20" 
```

# .net - .NET 应用程序如何在 32 位和 64 位 Office 上运行？

> ID：14693149
> 
> 赞同：5
> 
> 时间：2013-02-04T18:31:21.070
> 
> 标签：.net, ms-office, 32bit-64bit, oledbconnection

我有一个 Windows 64 位系统和一个 C# 应用程序，它使用 OleDbConnection 通过 32 位版本的 AccessDatabaseEngine.exe 组件读取 Excel 数据，因为我安装了 Office 32 位（按照 MSFT 的建议），而 64 位版本的 AccessDatabaseEngine 将不起作用与 32 位办公室。

为了让我的 C# 应用程序正常工作，我必须在项目构建设置中设置“首选 32 位”。这将设置编译器 /platform anycpu32bitpreferred 标志。在英特尔平台上没有“首选”。

所以一切运行良好。在我的机器上。不在我老板的 64 位机器上，他安装了 64 位 Office。

我找不到任何 app.config 选项来强制 64 位。有吗？在 .NET 加载序列中理论上是否可能存在一个？

MSFT 没有考虑到这一点。我应该能够以某种方式构建一个可以与 32 位和 64 位版本的 Office 一起使用的应用程序。我可以以某种方式使用 OleDbConnection 吗？

我知道 CorFlags.exe /32bitpref- 标志，但这需要维护两个版本的二进制文件。

有任何想法吗？修复？App.Config 选项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T22:05:48.027

您需要下载[64 位版本](http://www.microsoft.com/en-us/download/details.aspx?id=13255)的 ODBC 驱动程序（它说的是访问，但它也确实是 excel 驱动程序）。

您可能会收到一条错误消息，提示您不能同时安装 32 位和 64 位，要解决此问题，您必须[使用 /passive 标志](http://blog.codefluententities.com/2011/01/20/microsoft-access-database-engine-2010-redistributable/)

> 在运行 Office 2010 64 位的机器上安装 Microsoft ACE OLEDB Provider 32 位：
> 
> *   AccessDatabaseEngine.exe /被动
> 
> 在运行 Office 2010 32 位的机器上安装 Microsoft ACE OLEDB Provider 64 位：
> 
> *   AccessDatabaseEngine_X64.exe /被动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T22:04:07.437

您可以使用 ODBC 而不是 AccessDatabaseEngine COM 对象与 Excel 对话。这将跳过 32/64 位问题。

# php - file_exists - PHP 返回动态 public_html 路径

> ID：14693151
> 
> 赞同：1
> 
> 时间：2013-02-04T18:31:31.447
> 
> 标签：php, linux, file-exists

我正在尝试查找服务器的 public_html 文件夹中是否存在文件。

第一次尝试：

```
if ( file_exists('./local-config.php')) { 
```

但这仅在调用上述 if 语句的 php 文件位于同一文件夹中时才有效……不好……

第二次尝试

```
if ( file_exists( $_SERVER['SERVER_NAME'].'/local-config.php' ) ) { 
```

不工作...

第三次尝试

```
if ( file_exists( 'http://'. $_SERVER['SERVER_NAME'].'/local-config.php' ) ) { 
```

也不行……

第四次尝试

```
$_SERVER['DOCUMENT_ROOT'] seems to fall short of my public_html folder! 
```

有任何想法吗？

如果我输入完整路径，我可以让它工作......例如

```
if ( file_exists( '/home/username/public_html/local-config.php' ) ) { 
```

但这对我没有好处，因为该脚本可以在多个服务器上使用，所以我需要一些通用的东西。

是否可以让 PHP 动态返回 public_html 路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:28:25.500

为此，我在我的应用程序中创建了一个全局变量。如同：

```
define('ROOT', dirname(__FILE__)); 
```

然后我将其与文件名一起使用，例如：

```
ROOT . '/my_file.php' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:06:47.913

尝试做这样的事情：

```
$path = dirname(__FILE__);
// or just __DIR__ - it should be the same thing 
```

这将返回被调用文件的完整路径。 `__FILE__`是 PHP 中的一个“[魔法常数](http://php.net/manual/en/language.constants.predefined.php)”。从帮助页面：

```
The full path and filename of the file. If used inside an include, the name of
the included file is returned. Since PHP 4.0.2, __FILE__ always contains an
absolute path with symlinks resolved whereas in older versions it contained
relative path under some circumstances. 
```

通过生成的路径，您应该能够弄清楚如何获得您想要的。

# c# - 如何分别使用由 .tt 文件生成的 .cs 文件？

> ID：14693152
> 
> 赞同：0
> 
> 时间：2013-02-04T18:31:41.237
> 
> 标签：c#, file, project, t4

我`.tt`在c#中使用了一个文件来生成一些`.cs`文件，如何在我的项目中单独使用这些生成的类，没有`.tt`文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:42:01.697

如果您以 xml 格式打开项目文件，或者通过在 VS 中卸载和编辑，或者通过在某些外部文本编辑器中打开，您可以手动删除 .tt 文件。在生成的 .cs 文件上，还会有一个 DependentUpon 标记，该标记引用也应删除的 .tt 文件。

# java - 使用 ThreadPool 和 JMS 时处理 JVM 崩溃

> ID：14693155
> 
> 赞同：1
> 
> 时间：2013-02-04T18:31:45.050
> 
> 标签：java, transactions, jms, jvm-crash

我有一个独立的 Java 进程，它从 JMS 持久主题中读取消息并将它们提交到线程池进行处理。出于明显的并发原因，我这样做是为了保持这些消息的处理顺序，我仍然将它们提交到单个线程池。现在这是我对 JVM 崩溃的担忧。

--Non Transactional
我没有在 Transactional 上下文中阅读和处理每条消息，我避免这样做，因为它减慢了我的进程。所以，我在线程池的阻塞队列中累积消息。但是，如果 JVM 在线程池中有 10 条消息等待处理时崩溃，我将丢失该数据。

--事务
我相信如果我阅读并处理事务中的每条消息，如果出现问题，该消息将在备份时重新传递给进程。

由于这是许多在低延迟系统中工作的人的常见问题，想知道有经验的人如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:55:16.630

彼得的 AFAIK 是正确的。解决此问题的一种方法是，如果该模式适用于您，则使用某种分界线来创建不同的队列以将消息分组到其中。也就是说，这个要求经常分解为“*一个帐户的所有消息必须按顺序处理*”之类的意思。所以如果你有类似的东西，你可以创建：

*   一个主题和多个订阅者，每个订阅者都使用专有选择器（或子主题模式）
*   多个主题，每个主题都有一个订阅者。

然后您的发布商必须确定：

*   已发布消息上的标头，以便为订阅者影响更正选择器，或
*   要发布的正确子主题，或
*   发布的正确主题

一种易于维护的模式是使用您的一个业务字段（例如，帐号）并在其上计算**mod(x)**，其中**x**是您希望分担工作负载的订阅者数量。希望您的业务密钥是数字的，并且会给您一个不错的分布，但您始终可以使用其他一些确定性算法通过反转密钥和/或散列它们的非数字值来生成此数字。

顺便说一句，您的大纲更像是点对点/JMS 队列，而不是 Pub-Sub/JMS 主题。您确定要使用主题吗？

如果您绝对不能丢失数据，那么您应该使用事务性消息。如果您使用事务性消息，则不能委托给线程池。JMS 消息的事务上下文（即会话）绑定到接收消息的线程，因此除非您启用一些“有趣的业务”来将此上下文传输到另一个线程.....

我什至不知道如何完成那句话。

*==== 更新 ====*

现在我想一想，如果您可以从并行处理消息中受益，您可以在一个事务中检索一批消息，并将它们全部委托给[ExecutorService.invokeAll](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ExecutorService.html#invokeAll%28java.util.Collection,%20long,%20java.util.concurrent.TimeUnit%29)调用，等待完成并在它们完成时提交事务'都完成了。如果 invokeAll 超时，或者其中一个任务引发异常，那么您将不得不回滚事务或采取某种补偿措施。

# c# - 这个 do...while 循环 C# 有什么问题？

> ID：14693159
> 
> 赞同：1
> 
> 时间：2013-02-04T18:31:58.250
> 
> 标签：c#, while-loop, char, do-while

我编写此代码是为了获取一组字符，直到读取特定字符。我知道有更好的方法，但只是出于好奇。它没有用。循环没完没了地继续。为什么是这样 ？？？

```
foreach (char myChar in monthYear)
{
    do
    {
        whichMonth = whichMonth + myChar;
    } while (myChar.ToString() == "-");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T18:35:16.223

这就是您要告诉编译器执行的操作...

```
foreach (char myChar in monthYear)
{

    do  // Execute this piece of code
    {
        whichMonth = whichMonth + myChar;
    } while (myChar.ToString() == "-"); // While myChar is '-'

    // Here, the foreach loop moves to the next character
} 
```

因此，给定 string `02-2013`，这是代码的执行路径。

*   **`foreach`我的性格`monthYear`**
    *   `myChar = '0'`
    *   **`do`**
        *   `whichMonth = whichMonth + '0'`
        *   **`while(myChar == '-')`** *是`false`，退出`while`循环*
    *   `myChar = '2'`
    *   **`do`**
        *   `whichMonth = whichMonth + '2'`
        *   **`while(myChar == '-')`** *是`false`，退出`while`循环*
    *   `myChar = '-'`
    *   **`do`**
        *   `whichMonth = whichMonth + '-'`
        *   **`while(myChar == '-')`** *是`true`，继续`while`循环*
        *   `whichMonth = whichMonth + '-'`
        *   **`while(myChar == '-')`** *是`true`，继续`while`循环*
        *   `whichMonth = whichMonth + '-'`
        *   **`while(myChar == '-')`** *是`true`，继续`while`循环*
        *   ***... 无限重复 ...***

由于您的 while 循环，当它碰到“-”时，它实际上永远不会转到下一个字符。相反，请使用以下`break`语句：

```
foreach (char myChar in monthYear)
{
    whichMonth = whichMonth + myChar;

    if(myChar == '-') break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:36:15.693

只是为了补充 Cedric 的答案，这将永远持续下去，因为您实际上从未真正更改`myChar`do..while 循环内部的值。相反，您要做的是在更改时退出`foreach`使用`break`关键字。`myChar`

另外我会做：

```
if(myChar == '-')
   break; 
```

`.ToString()`当您可以将其与您感兴趣的字符进行比较时，调用该字符并将其转换为字符串是没有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T18:34:38.550

在你`do ... while`循环中，`myChar`永远不会被修改。只需使用带有 a 的条件`break`即可退出循环。

```
foreach (char myChar in monthYear)
{
    whichMonth = whichMonth + myChar;

    if(myChar == '-')  // myChar.ToString() is not necessary, you can check the char directly (use '' to specify a char)
        break;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T18:35:49.617

因为如果您的 myChar 等于“-”，它将始终执行

```
whichMonth = whichMonth + myChar; 
```

您没有在执行期间更新 myChar

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T18:36:35.660

您正在编写一个 for each 循环，其中包含一个 while 循环。

foreach 将遍历字符串中的所有字符。

让我们假设 123-456

在第一次迭代中，您`myChar`的值为 1。

那么你的while循环将测试是否`myChar`等于“-”。但它永远不会获得新的价值。它将永远是 1。

# c# - 指定的演员表无效 #3

> ID：14693166
> 
> 赞同：1
> 
> 时间：2013-02-04T18:32:21.697
> 
> 标签：c#

我有这个问题，我在 Visual Studio 内的错误列表中收到“指定的演员表无效”没有错误。这个错误会来自我的 Access 数据库吗？

```
private void Submit_Click(object sender, EventArgs e)
{
    String desItem = desWork.Text;
    decimal partscost = Convert.ToDecimal(textBoxPartsCost.Text);
    decimal laborhours = Convert.ToDecimal(textBoxHours.Text);
    decimal laborrate = Convert.ToDecimal(textBoxRate.Text);
    decimal total = laborhours * laborrate + partscost;

    try
    {
        servicesTableAdapter.InsertServices((short?)comboBoxCustomer.SelectedValue, (DateTime?)dateTimePickerServiceDate.Value, desItem, partscost, laborhours, laborrate, total);
        MessageBox.Show("Services Inserted", "Succes!", MessageBoxButtons.OK, MessageBoxIcon.Information);
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
} 
```

我认为它可能来自`(short?)comboBoxCustomer.SelectedValue`因为在 Visual Studio 内部它告诉我我需要转换为一个短整数，但在 Access 内部我使用的是长整数。不知道为什么会这样。有人可以让我知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T18:37:19.520

你的猜想几乎肯定是正确的。

装箱的值类型只能拆箱为*它实际的类型*。如果你有一个`long`，你不能`short?`直接拆箱。您必须先将其拆箱为`long`（或`long?`），*然后*将其转换为`short?`.

这是一个非常常见的问题。有关详细说明，请参阅我关于该主题的文章。

[http://ericlippert.com/2009/03/03/representation-and-identity/](http://ericlippert.com/2009/03/03/representation-and-identity/)

# javascript - 根据值循环遍历 CSV 数据并将其分离到辅助数组中

> ID：14693168
> 
> 赞同：0
> 
> 时间：2013-02-04T18:32:33.320
> 
> 标签：javascript, arrays, loops, for-loop, while-loop

我正在开发一个在线工具来在有组织的仪表板界面中显示信息。我从 CSV 电子表格中提取数据，并根据整个 CSV 数据数组中的一个字段将它们分成另一个多维数组。

**这是我尝试过的：**

```
 // arr is the array that holds the entire CSV data
        // inds is where I need the entries separated by industry (arr[i][0])
        var indx = 0; // using to add new array to inds array
        for(var i = 1; i < arr.length-1; i++){ 
            if(arr[i][0] === arr[i-1][0]) {
                if(! inds[indx] ) {
                    inds[indx] = []
                } else {
                    inds[indx].push(arr[i]);
                }
            } else {
                indx++;
            }
        } 
```

**基本上这是做什么**
的：如果行业字段与之前的条目相同，则将其放入索引为 的 arr 数组中`indx`，否则`indx`为下一个行业添加一个。

**这个解决方案的问题：**
它跳过了行业的第一个条目，因为之前的行是不同的行业，所以`arr[i-1][0]`检查最后一个行业并跳过下一个行业的第一行。

**我怎样才能重新格式化这个脚本：**
我在想可能嵌套了/while，但不确定。我思考逻辑的方式是：
对于 csv 的每一行，而行业列是相同的，折腾到各自的`inds[index]`. 或者，从 arr 中提取具有相同值的行`arr[i][0]`。

我确信有一个更简单的解决方案，这就是我在这里的原因，所以我希望我能清楚地表达我的想法，我感谢任何和所有反馈。

如果您需要更多说明，请在评论中告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:41:25.260

下面的逻辑有效吗？

```
var indx = -1;
 // using to add new array to inds array
        for(var i = 1; i < arr.length-1; i++){ 
            if(arr[i][0] !== arr[i-1][0]) {
                indx++;
                inds[indx] = []
            }
            inds[indx].push(arr[i]);
        } 
```

更新。

# php - 禁用对 index.php 的直接访问，但将每个 URI 重定向到 index.php/URI

> ID：14693173
> 
> 赞同：1
> 
> 时间：2013-02-04T18:32:55.750
> 
> 标签：php, apache, url-rewriting

我想禁用直接访问`/index.php`但仍将其用作前端控制器（使用`$_SERVER['PATH_INFO']`）。意义：

```
URI                    EXPECTED ACTION
-----------------------------------------------
/index.php             raise 404
/                      use   /index.php/
/foo/bar               use   /index.php/foo/bar
/index.php/foo/bar     raise 404 
```

当时我使用以下`.htaccess`文件：

```
RewriteEngine On
RewriteRule ^ index.php [QSA,L] 
```

我不需要任何其他文件`index.php`（制作 API）。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:53:58.273

如果您禁用对任何文件的访问，apache 将对其进行限制，如果文件没有访问权限，则将被禁用。您可以使用 mod_rewrite 伪造一个 url 以在 URL 中显示 index.php，但您需要对其他文件执行其他操作。

```
index.php -- not access
index.php/foo/bar -- no access
test.php -- have access
test.php/foo/bar -- you can fake it in url throw mod_rewrite and result will looks like as index.php/foo/bar 
```

我希望有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T23:34:12.560

好吧，我不确定这是否可行，但值得一试吗？您可以为输入 /index.php 的任何人创建重写规则，并将其重写为服务器上不存在的 html 文件（foo.html 或其他）。这应该会在找不到文件时导致 404 错误，但在未指定文件名时仍允许服务器使用其默认行为加载 index.php。

# scala - 在 Slider 和 min/max TextField 之间的 BindDirectional 策略之后过滤 TextField 输入上的用户值

> ID：14693177
> 
> 赞同：0
> 
> 时间：2013-02-04T18:33:22.810
> 
> 标签：scala, data-binding, slider, javafx-2, javafx

使用两个`TextField`：`texMin`和`texMax`，我想限制我的 doubleSlider 控件的最小值和最大值（参见`DoubleSlider`此处的自定义 ui 控件：[http ://code.google.com/p/javafx-widgets/source/browse/#svn%2Ftrunk% 2FDoubleSlider%2Fsrc%2Fdouble_slider](http://code.google.com/p/javafx-widgets/source/browse/#svn%2Ftrunk%2FDoubleSlider%2Fsrc%2Fdouble_slider) )

带有 StringConverter 的 DoubleBinded（双精度字符串）完美地工作，但现在我不知道如何过滤以在按键`TextField`后仅获取用户在两者中输入的正确值。`ENTER`

我不知道`setOnKeyReleasedEvent`用户输入的值的过滤器是否可以与`bindBidirectional`on 属性一起使用。我认为`bindBidirectional`绕过我的过滤器（每次文本更改时触发一个事件），但我不确定。

```
 def sliderBlockFactory(slider: DoubleSlider): HBox = {
      val minText = new TextField()
      val maxText = new TextField()
      minText.setText(slider.getValue1().toString)
      maxText.setText(slider.getValue2().toString)

      slider.value1Property().addListener(
        new ChangeListener[Number]() {
          override def changed(ov: ObservableValue[_ <: Number], old_val: Number, new_val: Number) {
            if (new_val.doubleValue() == null) {
              minText.setText("")
            } else {
              minText.setText(new_val.doubleValue().toString())
            }
          }
        })

      slider.value2Property().addListener(
        new ChangeListener[Number]() {
          override def changed(ov: ObservableValue[_ <: Number], old_val: Number, new_val: Number) {
            if (new_val.doubleValue() == null) {
              maxText.setText("")
            } else {
              maxText.setText(new_val.doubleValue().toString())
            }
          }
        })

      minText.setPrefWidth(40)
      maxText.setPrefWidth(40)

      val converter: StringConverter[_ <: Number] = new DoubleStringConverter()

      Bindings.bindBidirectional(minText.textProperty(), slider.value1Property(), converter.asInstanceOf[StringConverter[Number]])
      Bindings.bindBidirectional(maxText.textProperty(), slider.value2Property(), converter.asInstanceOf[StringConverter[Number]])

      val uiSliderBlock = new HBox()
      uiSliderBlock.getChildren.addAll(minText, slider, maxText)
      uiSliderBlock
    }

    def doubleSliderFactory(min: Double, max: Double): DoubleSlider = {
      val slider = new DoubleSlider()

      slider.setMin(min)
      slider.setMax(max)
      slider.setShowTickLabels(true)
      slider.setShowTickMarks(true)
      slider.setMajorTickUnit(50)
      slider.setMinorTickCount(25)
      slider.setSnapToTicks(true)
      slider.setPrefWidth(100)
      slider.setBlockIncrement(10)

      slider
    }

val myDoubleSlider = sliderBlockFactory(doubleSliderFactory(0.0, 100.0)) 
```

**更新 1：**

感谢评论，我修改了我的代码源。我放弃了 DoubleStringConverter，因为我的用例太复杂了。我还将评论 url 中给出的 java 源代码翻译成 scala ：

```
class DoubleTextField(var minValue: Double, var maxValue: Double, val initialValue: Double) extends TextField {

  require(minValue < maxValue, "DoubleField min value " + minValue + " greater than max value " + maxValue)
  require(maxValue > minValue, "DoubleField max value " + minValue + " less than min value " + maxValue)
  //require(!((minValue <= initialValue) && (initialValue <= maxValue)), "DoubleField initialValue " + initialValue + " not between " + minValue + " and " + maxValue)

  val value: DoubleProperty = new SimpleDoubleProperty(initialValue)

  //scala parsing
  def parseDouble(s: String) = try {
    Some(s.toDouble)
  } catch {
    case _ ⇒ None
  }

  def getValue() = value.getValue()

  def setValue(newValue: Double) = value.setValue(newValue)

  def valueProperty(): DoubleProperty = value

  setText(initialValue.toString())

  val doubleField: DoubleTextField = this

  // make sure the value property is clamped to the required range
  // and update the field's text to be in sync with the value.
  value.addListener(new ChangeListener[Number]() {
    override def changed(observableValue: ObservableValue[_ <: Number], oldValue: Number, newValue: Number) {
      if (newValue == null) {
        doubleField.setText("")
      } else {
        if (newValue.doubleValue() < doubleField.minValue) {
          value.setValue(doubleField.minValue)
          return
        }

        if (newValue.doubleValue() > doubleField.maxValue) {
          value.setValue(doubleField.maxValue)
          return
        }

        if (newValue.doubleValue() == 0 && (textProperty().get() == null || "".equals(textProperty().get()))) {
          // no action required, text property is already blank, we don't need to set it to 0.
        } else {
          doubleField.setText(newValue.toString())
        }
      }
    }
  })

  // restrict key input to numerals.
  this.addEventFilter(KeyEvent.KEY_TYPED, new EventHandler[KeyEvent]() {
    override def handle(keyEvent: KeyEvent) {
      if (!"0123456789".contains(keyEvent.getCharacter())) {
        keyEvent.consume()
      }
    }
  })

  // i don't want a realtime change on my textfield,
  // so i prefer a validate method like focusedProperty (see below)
  /*this.textProperty().addListener(
    new ChangeListener[String]() {
      override def changed(observableValue: ObservableValue[_ <: String], oldValue: String, newValue: String) {
        if (newValue == null || "".equals(newValue)) {
          value.setValue(0)
          return
        }

        parseDouble(newValue) match {
          case Some(d: Double) ⇒
            if (doubleField.minValue > d || d > doubleField.maxValue) {
              textProperty().setValue(oldValue)
              value.set(oldValue.toDouble)
            } else {
              value.set(d)
            }
          case _ ⇒ oldValue //reset to old value
        }

      }
    })*/

  // Detect a change in focus on the text field.. If we lose the focus we take appropriate action
  // problem with boolean : https://stackoverflow.com/questions/11377350/scala-java-interop-class-type-not-converted
  this.focusedProperty().addListener(
    new ChangeListener[java.lang.Boolean]() { db ⇒
      override def changed(observable: ObservableValue[_ <: java.lang.Boolean], oldValue: java.lang.Boolean, newValue: java.lang.Boolean) {
        if (!newValue) {
          parseDouble(doubleField.textProperty().get()) match {
            case Some(d: Double) ⇒
              if (doubleField.minValue > d || d > doubleField.maxValue) {
                textProperty().setValue(doubleField.minValue.toString)
                value.set(textProperty().get().toDouble)
              } else {
                value.set(d)
              }
            case _ ⇒ println("error") //reset to old value
          }
        }
      }
    })

} 
```

`DoubleSlider`更新的更正代码源`DoubleTextField`：

```
// inspired by :
// https://gist.github.com/1962045
// https://stackoverflow.com/questions/14138082/java-fx-bidirectional-bindings-of-different-properties
// https://forums.oracle.com/forums/thread.jspa?threadID=2311243

def sliderBlockFactory(slider: DoubleSlider): HBox = {
  val minText = new DoubleTextField(slider.getMin, slider.getMax, slider.getMin)
  val maxText = new DoubleTextField(slider.getMin, slider.getMax, slider.getMax)

  slider.value1Property().addListener(
    new ChangeListener[Number]() {
      override def changed(ov: ObservableValue[_ <: Number], old_val: Number, new_val: Number) {
        if (new_val.doubleValue() == null) {
          minText.setText("")
        } else {
          //set new min value of maxText
          maxText.minValue = new_val.doubleValue()

        }
      }
    })

  slider.value2Property().addListener(
    new ChangeListener[Number]() {
      override def changed(ov: ObservableValue[_ <: Number], old_val: Number, new_val: Number) {
        if (new_val.doubleValue() == null) {
          maxText.setText("")
        } else {
          //set new max value of minText
          minText.maxValue = new_val.doubleValue()

        }
      }
    })

  minText.setPrefWidth(40)
  maxText.setPrefWidth(40)

  /*val converter: StringConverter[_ <: Number] = new DoubleStringConverter()
  Bindings.bindBidirectional(minText.textProperty(), slider.value1Property(), converter.asInstanceOf[StringConverter[Number]])
  Bindings.bindBidirectional(maxText.textProperty(), slider.value2Property(), converter.asInstanceOf[StringConverter[Number]])
  */

  minText.valueProperty().bindBidirectional(slider.value1Property())
  maxText.valueProperty().bindBidirectional(slider.value2Property())

  val uiSliderBlock = new HBox()
  uiSliderBlock.getChildren.addAll(minText, slider, maxText)
  uiSliderBlock
}

def doubleSliderFactory(min: Double, max: Double): DoubleSlider = {
  val slider = new DoubleSlider()

  slider.setMin(min)
  slider.setMax(max)
  slider.setShowTickLabels(true)
  slider.setShowTickMarks(true)
  slider.setMajorTickUnit(50)
  slider.setMinorTickCount(25)
  slider.setSnapToTicks(true)
  slider.setPrefWidth(100)
  slider.setBlockIncrement(10)

  slider
}

  val myDoubleSlider = sliderBlockFactory(doubleSliderFactory(0.0, 100.0)) 
```

结果 ：）

![在此处输入图像描述](../Images/919dd110c1960cf1c457cbacbb467879.png)

此代码有效，每个滑块控件的 min 和 max 值已正确更新，但如您所见，当焦点离开且值错误时，**我无法使用焦点事件检索旧值**。我的问题很简单，有没有办法在不使用`changeListener`on的情况下获取 textField 中的旧值`textProperty`？

**更新 2：**

我在这里找到了答案：

[在焦点丢失后基于值验证撤消文本字段值的行为](https://stackoverflow.com/questions/14707550/undo-behavior-on-textfield-value-based-on-value-verification-after-focus-lost)

# webdriver - ChromiumEmbedded 和 WebDriver

> ID：14693178
> 
> 赞同：2
> 
> 时间：2013-02-04T18:33:26.203
> 
> 标签：webdriver, google-chrome-devtools, chromium-embedded

我们的软件使用嵌入在 .NET 应用程序中的 ChromiumEmbedded。我想知道是否可以使用 WebDriver 对其进行自动化测试。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:42:50.613

您可能想在[https://sqa.stackexchange.com/](https://sqa.stackexchange.com/)上询问，但我已将[Selenium](http://seleniumhq.org/)用于此类事情。较新版本的 Selenium 在后台使用 WebDriver：http: [//seleniumhq.org/docs/03_webdriver.jsp](http://seleniumhq.org/docs/03_webdriver.jsp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T14:21:46.517

似乎 webdriver 还不支持 Chromium Embedded。谷歌代码上有一张票。

# facebook-graph-api - 如何通过“数据”属性获取 Facebook AppRequest

> ID：14693179
> 
> 赞同：0
> 
> 时间：2013-02-04T18:33:26.607
> 
> 标签：facebook-graph-api, facebook-c#-sdk, facebook-app-requests

我有一个应用程序，允许用户向朋友发送应用程序请求。在应用请求中，我在启动应用请求对话框时在“数据”属性中传入了一个自定义值。

```
FB.ui({
   method: 'apprequests',
   message: 'check this out!',
   data: 'ah6Jdh74Glc9dj'  //random, unique value stored in the app request
} 
```

当朋友从应用程序请求登陆我的网站时，当我知道请求 ID（Facebook 在应用程序请求 URL 的查询字符串中传递）时，我可以从 Facebook 的 Graph API 获取“数据”属性的值。我正在使用 Facebook C# SDK 执行此操作：

```
var client = new FacebookClient(myAppAccessToken);
var url = string.Format("/{0}", friendAppRequestID);
var appReq = client.Get(url) as IDictionary<string, object>;

var customData = appReq["data"].ToString(); 
```

我想知道的是，如何进行反向查找，从而从“数据”属性中获取请求 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:45:15.500

> 我想知道的是，我如何进行反向查找，从而我想从“数据”属性中获取请求 ID。

不在 Facebook 的数据库中。

发送请求后，您必须将该信息保存到您自己的数据库中，并且您会取回 id。

# java - 基于 OS 的 JNLP 主类参数

> ID：14693181
> 
> 赞同：1
> 
> 时间：2013-02-04T18:33:34.283
> 
> 标签：java, parameters, runtime, jnlp

我想将一个参数传递给通过 Java Webstart 运行的主类。我能够做到这一点的唯一方法是在 application-desc 元素中使用。遗憾的是，每个操作系统/架构组合都需要一个 jnlp 文件。

有没有办法从资源元素做同样的事情？我需要根据操作系统的体系结构使用不同的参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T09:01:53.973

该值可以定义为元素`property`中的a。`resources`有关详细信息，请参阅[JNLP 文件语法](http://docs.oracle.com/javase/7/docs/technotes/guides/javaws/developersguide/syntax.html)。

# opengl - 在opengl中为球体创建正确的纹理坐标

> ID：14693182
> 
> 赞同：1
> 
> 时间：2013-02-04T18:33:35.827
> 
> 标签：opengl, textures

我目前正在尝试渲染天穹。球体是使用 gluSphere 创建的，在顶点着色器中，我从每个顶点中提取球坐标。然后，我将球体坐标 theta 和 phi 都映射到 [0,1] 范围内，就像正常的纹理坐标一样。目前，片段着色器只考虑 phi。

如您所见，phi 似乎没有正确映射，因为梯度出现了两次，这意味着 phi 在 pi 旋转后被重置。

我在 VS 中计算 theta 和 phi，如下所示：

```
theta = acos(gl_Vertex.y/radius)/(pi);
phi = (atan(gl_Vertex.x/gl_Vertex.z)+pi)/(2*pi); 
```

FS中的颜色很简单：

```
gl_FragData[0].rgb = vec3(phi, phi, phi); 
```

![问题图片](../Images/6d1a247ed7d4f50bc8341f609a968136.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:38:44.730

没关系，我使用的是 atan(float x)，而不是本质上是 atan2 的 atan(float x, float y)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T03:46:36.933

如果您想在使用 gluSphere 创建的球体上映射纹理，则无需生成球坐标，您可以使用 gluQuadricTexture 在其上映射纹理。[您可以在此处](http://codeincodeblock.blogspot.com/2012/05/simple-method-for-texture-mapping-on.html)查看示例示例程序。

# c++ - 相对于静态变量为 const 的静态成员函数

> ID：14693186
> 
> 赞同：-2
> 
> 时间：2013-02-04T18:33:41.023
> 
> 标签：c++, constants, static-methods, static-members

在 C++ 中，如何将一个类的静态成员函数声明为`const`相对于该类的**静态**成员变量？

考虑以下简单示例。

myclass.h：

```
class myclass
{
    myclass()
    {
        myint = 0;
    }

    ~myclass() { }

    int myint;
    static int my_static_int;

    void foo(const int yourint) const;
    static void bar(const int newint );
}; 
```

我的类.cpp：

```
myclass::my_static_int = 0;

void myclass::foo(const int yourint) const
{
  if (yourint <= myint + my_static_int)
     std::cerr << "yourint  <= myint + my_static_int";
  else
      std::cerr << "yourint  >  myint + my_static_int";

  bar( yourint );
}

void myclass:bar(const int newint)
{
  my_static_int = newint;
} 
```

主文件

```
...
myclass A;
A.foo(4);
A.foo(4);
.. 
```

输出将是：

```
yourint  >  myint + my_static_int
yourint  <= myint + my_static_int 
```

显然，`bar`可以**在`const`成员函数**中使用来改变类的静态成员*变量*，从而改变**const**成员函数的结果`foo`。

你可以声明`bar`为 const`my_static_int`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:47:32.080

原始代码（我只整理了格式）：

```
class myclass
{
    myclass()
    {
        myint = 0;
    } 
    ~myclass()
    {}

    int myint;
    static int my_static_int;

    void foo(const int yourint) const;
    static void bar(const int newint );
}; 
```

在这个类中`private`，默认情况下一切都是**不可访问的：它是不可用的。**

这就是为什么发布*真实代码*如此重要的一个例子。

然后你问：

> “你能声明就`bar`？”`const``my_static_int`

是的，但没有直接的语法。

您将不得不使用现有的语言功能。

它们足以胜任这项任务。

```
class something
{
private:
    int my_int;
public:
    void bar( int const newint ) const;
    something();
};

class myclass
{
private:
    int myint;
    static something;
public:
    void foo( int const yourint ) const;
    ~myclass() {}
    myclass(): myint( 0 ) {}
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:42:23.990

> 您可以声明 bar 相对于 my_static_int 是静态的吗？

不，C++ 没有提供这样的机制。

> 这深深困扰着我，因为人们会假设多次调用 const 成员函数 foo 不会改变类中的任何内容

你不应该这样假设。const 方法可以修改静态变量，因为这些变量不是声明为 const的*实例的一部分。*

它还可以修改标记为 的变量`mutable`。或者用 . 移除了 const-ness 的成员`const_cast`。

并且`const`函数可以观察或修改类之外的变量，所以你永远不应该考虑一个`const`函数每次被调用时的行为方式都是一样的。例如，您可以有一个`const`函数返回`rand()`。

请参阅[此问题](https://stackoverflow.com/questions/455518/how-many-and-which-are-the-uses-of-const-in-c)以更好地理解`const`C++ 中的含义

# fedora - 用于签署 rpm 的 gpg 密钥应在多长时间内有效？

> ID：14693189
> 
> 赞同：0
> 
> 时间：2013-02-04T18:33:55.207
> 
> 标签：fedora, redhat, rpm, gnupg

red hat 和 fedora 在每个版本中都使用一个新密钥，并且似乎永远支持该密钥。我记得读过密钥应该过期，但这取决于它的用途。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T23:47:11.203

公钥的到期日期是可选的，尽管被认为是“最佳实践”（就像创建吊销证书一样）。是否设置到期日期完全取决于密钥的所有者。

对“gpg key expire”的网络搜索[发现这篇文章](http://www.g-loaded.eu/2010/11/01/change-expiration-date-gpg-key/)可能有助于回答其他问题。

# gwt - ios UIWebView 上的 SOP 违规，但 CORS 实施后没有 FF 桌面？

> ID：14693190
> 
> 赞同：0
> 
> 时间：2013-02-04T18:33:56.087
> 
> 标签：gwt, uiwebview, jetty

我正在从域 A 加载我的 GWT 项目，然后尝试从位于不同域 (B) 的另一台服务器中获取一些数据。所以我遇到了违反 SOP 的问题。为了解决这个问题，我在服务器 B 上实现了 CORS。现在通过 Firefox 桌面运行时，SOP 问题已经消失。然后我尝试在 ios 的 UIWebView 中运行相同的代码。不过，我似乎违反了 SOP：

```
public class MyRequestCallback implements RequestCallback {

    @Override
    public void onResponseReceived(Request request, Response response) {
        if (response != null) {
            if (response.getStatusCode() == 0) {
                // Is this a SOP violation?
            }
        }
    }
} 
```

我可以看到连接需要一些时间（所以看起来请求正在发出），但随后我得到的状态代码为零。

有没有人遇到过这样的事情？很难弄清楚在哪里发布这个，因为它涉及堆栈的几个不同部分。也许我需要设置 UIWebView 上的一个属性来告诉它可以使用 CORS？

为了在我的服务器上实现 CORS（我正在使用码头），我使用了： [http ://wiki.eclipse.org/Jetty/Feature/Cross_Origin_Filter](http://wiki.eclipse.org/Jetty/Feature/Cross_Origin_Filter)

谢谢

- - - 更新 - - -

这就是我的过滤器在 web.xml 中的定义方式：

```
<filter-mapping>
  <filter-name>cross-origin</filter-name>
  <url-pattern>/api/v1/*</url-pattern>
</filter-mapping> 
```

FF 客户端和 ios 客户端都在访问我的一个测试端点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:37:38.467

我改变了启动码头的方式，现在使用：

[http://wiki.eclipse.org/Jetty/Howto/Using_Jetty_Runner](http://wiki.eclipse.org/Jetty/Howto/Using_Jetty_Runner)

代替：

[http://wiki.eclipse.org/Jetty/Howto/Run_Jetty](http://wiki.eclipse.org/Jetty/Howto/Run_Jetty)

使用跑步者运行我的战争，跨源请求工作正常。对于我使用的 jetty 版本（v7.3）和由于这个问题而更新到的版本 v7.6.9 都是如此。所以我之前启动码头的方式可能有一些错误。

谢谢

# java - 将时间间隔转换为不同语言的文本？

> ID：14693195
> 
> 赞同：4
> 
> 时间：2013-02-04T18:34:10.840
> 
> 标签：java, date

有没有简单的方法将时间间隔（年龄）转换为文本？例如 - 年龄是 25.45 岁。我需要转换为“ **25 年 3 个月 1 天**”。问题不是关于数字 25,3,1，而是如何使用**正确的形式（复数，变格）将年/月/日翻译成不同的语言**。英语似乎很容易硬编码，但其他语言则不然，我更喜欢一些通用的解决方案。

number / English / Czech / ...
1 / day / den
2 / days / dny
5 / days / dnů
...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:38:05.813

Joda time 很容易做到这一点。

例如：

```
public static void main(String[] args) {
  PeriodFormatter daysHoursMinutes = new PeriodFormatterBuilder()
    .appendDays()
    .appendSuffix(" day", " days")
    .appendSeparator(" and ")
    .appendMinutes()
    .appendSuffix(" minute", " minutes")
    .appendSeparator(" and ")
    .appendSeconds()
    .appendSuffix(" second", " seconds")
    .toFormatter();

  Period period = new Period(72, 24, 12, 0);

  System.out.println(daysHoursMinutes.print(period));
  System.out.println(daysHoursMinutes.print(period.normalizedStandard()));
} 
```

将打印：

```
24 minutes and 12 seconds
3 days and 24 minutes and 12 seconds 
```

另请参阅：[句点到字符串](https://stackoverflow.com/questions/1440557/joda-time-period-to-string)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T18:37:17.503

JodaTime 可以用它的大多数格式化程序来做到这一点。 [以 javadoc`PeriodFormat`为例。](http://joda-time.sourceforge.net/apidocs/org/joda/time/format/PeriodFormatter.html)

它说：

```
Controls the printing and parsing of a time period to and from a string.

This class is the main API for printing and parsing used by most applications. Instances of this class are created via one of three factory classes:

PeriodFormat - formats by pattern and style
ISOPeriodFormat - ISO8601 formats
PeriodFormatterBuilder - complex formats created via method calls
An instance of this class holds a reference internally to one printer and one parser. It is possible that one of these may be null, in which case the formatter cannot print/parse. This can be checked via the isPrinter() and isParser() methods.

The underlying printer/parser can be altered to behave exactly as required by using a decorator modifier:

withLocale(Locale) - returns a new formatter that uses the specified locale
This returns a new formatter (instances of this class are immutable).
The main methods of the class are the printXxx and parseXxx methods. These are used as follows:

 // print using the default locale
 String periodStr = formatter.print(period);
 // print using the French locale
 String periodStr = formatter.withLocale(Locale.FRENCH).print(period);

 // parse using the French locale
 Period date = formatter.withLocale(Locale.FRENCH).parsePeriod(str); 
```

# php - 使用 preg_replace 或 pre_replace_callback 替换 bbcode 中的新行

> ID：14693196
> 
> 赞同：0
> 
> 时间：2013-02-04T18:34:18.243
> 
> 标签：php

我写了一个 bbcode 解析器，基本上是这样调用的：

```
echo nl2br(bb_parse($contents)); 
```

我正在通过使用 preg_replace_callback 而不是带有 e 修饰符的 preg_replace 来更新函数，以便为 PHP 5.4+ 做好准备。

```
function strip_newline($text) 
{ 
     return preg_replace("/(\r\n|\r|\n)/", "", $text); 
}

bb_parse($text)
{
    $text = preg_replace("/\[ul\](.*)\[\/ul\]/Usie", '"<ul class=\"forum_unordered\">".strip_newline("$1")."</ul>"', $text);
    return $text;
} 
```

我在使用 preg_replace_callback 来完成同样的事情时遇到了麻烦。

```
bb_parse($text)
{
    $text = preg_replace_callback("/\[ol\](.*)\[\/ol\]/Usi", create_function('$matches', 'return preg_replace("/(\r\n|\r|\n)/", "", $matches);'), $text);
    return $text;
} 
```

任何帮助将不胜感激。谢谢你。

**编辑**

我希望解析的 bbcode 代码是这样的：

```
[ol]
[li]One[/li]
[li]Two[/li]
[/ol] 
```

我的问题是我希望删除 [ol] 和 [/ol] 之间的三个换行符。在不删除换行符的情况下，输出变为：

```
1\. One

2\. Two 
```

代替：

```
1\. One
2\. Two 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:50:53.583

我认为问题在这里必须放**$matches[1]**

```
bb_parse($text)
{
  $text = preg_replace_callback("/\[ol\](.*)\[\/ol\]/Usi", function($matches){       
    return preg_replace("/(\r\n|\r|\n)/", "", $matches[1]);
   }, $text);
   return $text;
} 
```

# json - 画廊和灯箱模式

> ID：14693197
> 
> 赞同：0
> 
> 时间：2013-02-04T18:34:28.510
> 
> 标签：json, flickr, shadowbox

嗨，我在galleriffic 更改图像后无法加载阴影框的问题。

在这里发现了同样的问题：[Galleriffic with lightBox](https://stackoverflow.com/questions/1868968/galleriffic-with-lightbox/14689002#14689002)

看看我的一半工作示例：http: [//tgp2.1.timgodwinphotography.co.uk/gallery/albums/album0.php#gallery](http://tgp2.1.timgodwinphotography.co.uk/gallery/albums/album0.php#gallery)

您可以在底部看到链接的地方（查看大图）应该打开一个灯箱。它只适用于第一张图像，而不是在使用gallerific导航之后。

```
<div class="download" onmouseover="Shadowbox.init();">
<a href="http://#" rel="shadowbox[album]">View Large</a>    
</div> 
```

jquery 通过来自 flickr 的 json feed 拉入模态的源代码

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T16:48:43.710

所以我在影子盒论坛上找到了一个解决方案：

[http://shadowbox.1309102.n2.nabble.com/Shadowbox-in-Galleriffic-tp6158381.html](http://shadowbox.1309102.n2.nabble.com/Shadowbox-in-Galleriffic-tp6158381.html)

基本上将js添加到锚点以确保每次gallerific执行时都会重新加载阴影框：

```
<div class="download">
<a href="http://#" rel="shadowbox" onclick="Shadowbox.open(this, {type:'img', gallery:'gallery', displayCounter:'true', counterType:'skip', continuous:'true', title:'Redwood Press', content:'/getattachment/cdef7c0d-b0e9-4d64-91cd-95c894553d23/Redwood-Press.jpg'}); return false;">View Large</a>  
</div> 
```

全部归功于 QuickPaw

见 [http://tgp2.1.timgodwinphotography.co.uk/gallery/albums/album0.php](http://tgp2.1.timgodwinphotography.co.uk/gallery/albums/album0.php)

对于工作示例

# google-maps - Google Maps API v3，全局变量

> ID：14693202
> 
> 赞同：0
> 
> 时间：2013-02-04T18:34:35.083
> 
> 标签：google-maps, global-variables

谈到 javascript，我几乎是个菜鸟，但我想在我的网站上放置我所在位置的谷歌地图，并有一个简单的表单，访问者可以在其中输入他们的地址并显示路线。我的工作正常，但有人提到脚本创建的全局变量太多。全局变量如下：

`calcRoute`, `directionsDisplay`, `directionsService`, `google`, `initialize`,`map`

如果我尝试将这些全局变量中的任何一个改为本地，它会破坏脚本，并且地图不会显示。这是我写的js：

```
var initialize = function strict() {
    directionsDisplay = new google.maps.DirectionsRenderer();
    mapCenter = new google.maps.LatLng(53.503716, -1.12975);
    mapOptions = {
        zoom: 14,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
    center: mapCenter
    };
    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    directionsDisplay.setMap(map);
    directionsDisplay.setPanel(document.getElementById("directionsPanel"));
    locationPin = "images/location_pin.png";
    newMarker = new google.maps.Marker({ position: mapCenter,map: map,icon: locationPin});
    };

var calcRoute = function strict() {
    routeStart = document.getElementById("start").value;
    calculatedRoute = {origin: routeStart, destination: mapCenter, travelMode: google.maps.TravelMode.DRIVING};
    directionsService.route(calculatedRoute, function (routeStart, mapCenter) {
    directionsDisplay.setDirections(routeStart);
    calculatedRoute = routeStart.routes[0].legs[0];
    });
};
var directionsDisplay;
var directionsService = new google.maps.DirectionsService();
var map; 
```

据我所知，我提到的全局变量是 Google Maps API 所必需的，它们必须是全局变量。非常感谢您对此提出任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:44:59.330

你的代码没问题！

但是，如果您不希望此变量是全局变量，请在函数中插入代码，例如：

```
(function () { 
    //your code 
}()); 
```

使用它，变量将在一个范围内，但在你的情况下，它没有任何区别......

# c# - 无法使用 prnmngr.vbs 在远程计算机上设置默认打印机

> ID：14693209
> 
> 赞同：2
> 
> 时间：2013-02-04T18:35:22.323
> 
> 标签：c#, windows, wsh, printer-properties

我正在使用 WMI 作为域管理员连接到我的实验室机器。然后我运行这个命令行来创建一个打印机：

```
cscript C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs -a -p Test002 -m "Canon Inkjet iP100 series" -r FAKE002 
```

这很好用。

然后我运行此命令行将打印机设置为默认值：

```
cscript C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs -t -p Test002 
```

那根本行不通。

一些相关的细节：

*   两条命令行都是用同样的方法执行的
*   如果我通过具有本地范围的 WMI 运行第二个命令行，则它可以正常工作
*   我正在运行脚本的用户在机器上具有管理员权限，并且可以手动设置默认打印机
*   我正在创建远程范围的用户参数属于域管理员。
*   当我远程运行脚本时，它会报告成功。没有看到错误。

我完全不明白为什么使用远程 WMI 调用具有不同参数的相同脚本不起作用。我花了几个小时搜索并没有找到足够的答案。

这是我用来创建连接到远程机器的范围的方法：

```
public static ManagementScope CreateScope() {
        string nameSpace = @"\\" + Parameters.FQDN + @"\root\cimv2";

        ManagementPath path = new ManagementPath(nameSpace);
        ConnectionOptions Connection = new ConnectionOptions();
        Connection.Username = Parameters.User;  // Username value includes the domain
        Connection.Password = Parameters.Password;
        Connection.Impersonation = ImpersonationLevel.Impersonate;

        return new ManagementScope(path, Connection);

} 
```

谁能告诉我为什么第二个命令行没有将远程机器上的打印机设置为默认打印机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T08:50:55.080

希望这可以帮助。我建议您在运行时使用您的两个命令创建一个批处理文件并以这种方式创建一个进程。但是现在测试你遇到问题的最终命令，如下所示： -

```
string Command = @"cscript C:\Windows\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs -t -p Test002";

ManagemenConnectionOptions connOptions = new ConnectionOptions();
connOptions.Impersonation = ImpersonationLevel.Impersonate;
connOptions.EnablePrivileges = true;
tScope manScope = new ManagementScope
    (String.Format(@"\\{0}\ROOT\CIMV2", Parameters.FQDN), connOptions);
manScope.Connect();

ObjectGetOptions objectGetOptions = new ObjectGetOptions();
ManagementPath managementPath = new ManagementPath("Win32_Process");
ManagementClass processClass = new ManagementClass
    (manScope, managementPath, objectGetOptions);
ManagementBaseObject inParams = processClass.GetMethodParameters("Create");
inParams["CommandLine"] = Command; 

ManagementBaseObject outParams = processClass.InvokeMethod("Create", inParams, null);
Console.WriteLine("Creation of the process returned: " + outParams["returnValue"]);
Console.WriteLine("Process ID: " + outParams["processId"]); 
```

# mysql - 随机连接3个表中的记录

> ID：14693213
> 
> 赞同：0
> 
> 时间：2013-02-04T18:35:57.167
> 
> 标签：mysql, sql, relationship

我有三张桌子：

```
categories (id)
product_models(id, category_id)
products(id, product_id, category_id) 
```

每个表上都有记录（lorem ipsum 内容），我想连接数据。
我已经更改了 product_models，执行此查询：

```
 update product_models
    set category_id = (select id from categories order by RAND() limit 1) 
```

如何使用**单个查询**将所有产品映射到产品模型并更新类别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:45:16.803

您应该适当地添加对表的约束和引用，以便当您更新一个表时，其他表也将被更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:49:44.253

假设你的第三个表结构是（id，product_model_id，category_id），另一个假设是你有一个复合外键（product_model_id，category_id），那么你必须像下面这样更新第三个表

```
UPDATE products P
INNER JOIN (SELECT id, category_id from product_models ) M
ON P.product_id = M.id
SET P.category_id = M.category_id 
```

# c# - 只拦截最外层的装饰器

> ID：14693221
> 
> 赞同：2
> 
> 时间：2013-02-04T18:36:19.013
> 
> 标签：c#, castle-windsor

我正在开发一个使用 Castle Windsor 的项目，其中混合使用了装饰器和动态拦截来向根实现添加功能。

例如，假设我正在处理需要进行一些缓存以及通用错误日志记录的数据访问层的一部分，如下所示：

```
interface IRepository 
{ 
    /* . . . */ 
}

// base implementation
class SqlRepository : IRepository
{ 
    /* . . . */ 
}

// decorator to implement caching
class CachingRepository : IRepository
{ 
    private readonly IRepository _base;

    /* . . . */ 
}

// interceptor to implement generic logging
class LoggingInterceptor : IInterceptor
{ 
    /* . . . */ 
} 
```

到目前为止一切顺利，除了我不确定如何最好地实现切入点。我想确保拦截器不会应用于装饰器链中的每个对象。相反，它应该只应用于最外层的装饰器。在这种情况下，它应该被应用于`CachingRepository`而不是`SqlRepository`. 我在实际解决方案中有很多类，所以如果可能的话，我想使用拦截器选择器来完成它，以避免手动应用拦截器的大量重复代码。

这就是我卡住的地方。显然我不想将它硬编码到 中`IModelInterceptorsSelector`，因为每当装饰器的选择或应用它们的顺序发生变化时，需要提供拦截器的特定对象可能会有所不同。到那时，我相信坚持手动注册会容易得多。而且我想不出任何可以完成这项工作的约定。

那么，可以做到吗？还是我应该接受我的命运，`.Interceptors(InterceptorReference.ForType<. . .`进入我的剪贴板，然后开始使用一些 IWindsorInstaller？

# java - 如何在 Java 中使用 Graphviz 进行图形操作

> ID：14693224
> 
> 赞同：1
> 
> 时间：2013-02-04T18:36:35.070
> 
> 标签：java, graph, java-native-interface, swig, graphviz

我正在尝试使用 gv_java - 使用带有 Graphviz 的 java 进行图形操作。我根据需要下载了包含 java.Installed graphviz 中的 SWIG 类型文件的 java 包。

为了获得更简洁的解决方案，我尝试使用 graphviz 提供的 JNI，这是我的测试代码。

```
public class TestGraphvizLibrary {

    public final static native long graph__SWIG_0(String jarg1);
    public final static native long digraph(String jarg1);
    public final static native long strictgraph(String jarg1);
    public final static native long strictdigraph(String jarg1);
    public final static native long readstring(String jarg1);
    public final static native long read__SWIG_0(String jarg1);
    public final static native long read__SWIG_1(long jarg1);
    public final static native long graph__SWIG_1(long jarg1, String jarg2);
    public final static native long node(long jarg1, String jarg2);
    public final static native long edge__SWIG_0(long jarg1, long jarg2);
    public final static native long edge__SWIG_1(long jarg1, String jarg2);
    public final static native long edge__SWIG_2(String jarg1, long jarg2);
    public final static native long edge__SWIG_3(long jarg1, String jarg2, String jarg3);
    public final static native String setv__SWIG_0(long jarg1, String jarg2, String jarg3);
    public final static native String setv__SWIG_1(long jarg1, String jarg2, String jarg3);
    public final static native String setv__SWIG_2(long jarg1, String jarg2, String jarg3);
    public final static native String setv__SWIG_3(long jarg1, long jarg2, String jarg3);
    public final static native String setv__SWIG_4(long jarg1, long jarg2, String jarg3);
    public final static native String setv__SWIG_5(long jarg1, long jarg2, String jarg3);
    public final static native String getv__SWIG_0(long jarg1, String jarg2);
    public final static native String getv__SWIG_1(long jarg1, String jarg2);
    public final static native String getv__SWIG_2(long jarg1, String jarg2);
    public final static native String getv__SWIG_3(long jarg1, long jarg2);
    public final static native String getv__SWIG_4(long jarg1, long jarg2);
    public final static native String getv__SWIG_5(long jarg1, long jarg2);
    public final static native String nameof__SWIG_0(long jarg1);
    public final static native String nameof__SWIG_1(long jarg1);
    public final static native String nameof__SWIG_2(long jarg1);
    public final static native long findsubg(long jarg1, String jarg2);
    public final static native long findnode(long jarg1, String jarg2);
    public final static native long findedge(long jarg1, long jarg2);
    public final static native long findattr__SWIG_0(long jarg1, String jarg2);
    public final static native long findattr__SWIG_1(long jarg1, String jarg2);
    public final static native long findattr__SWIG_2(long jarg1, String jarg2);
    public final static native long headof(long jarg1);
    public final static native long tailof(long jarg1);
    public final static native long graphof__SWIG_0(long jarg1);
    public final static native long graphof__SWIG_1(long jarg1);
    public final static native long graphof__SWIG_2(long jarg1);
    public final static native long rootof(long jarg1);
    public final static native long protonode(long jarg1);
    public final static native long protoedge(long jarg1);
    public final static native boolean ok__SWIG_0(long jarg1);
    public final static native boolean ok__SWIG_1(long jarg1);
    public final static native boolean ok__SWIG_2(long jarg1);
    public final static native boolean ok__SWIG_3(long jarg1);
    public final static native long firstsubg(long jarg1);
    public final static native long nextsubg(long jarg1, long jarg2);
    public final static native long firstsupg(long jarg1);
    public final static native long nextsupg(long jarg1, long jarg2);
    public final static native long firstedge__SWIG_0(long jarg1);
    public final static native long nextedge__SWIG_0(long jarg1, long jarg2);
    public final static native long firstout__SWIG_0(long jarg1);
    public final static native long nextout__SWIG_0(long jarg1, long jarg2);
    public final static native long firstedge__SWIG_1(long jarg1);
    public final static native long nextedge__SWIG_1(long jarg1, long jarg2);
    public final static native long firstout__SWIG_1(long jarg1);
    public final static native long nextout__SWIG_1(long jarg1, long jarg2);
    public final static native long firsthead(long jarg1);
    public final static native long nexthead(long jarg1, long jarg2);
    public final static native long firstin__SWIG_0(long jarg1);
    public final static native long nextin__SWIG_0(long jarg1, long jarg2);
    public final static native long firstin__SWIG_1(long jarg1);
    public final static native long nextin__SWIG_1(long jarg1, long jarg2);
    public final static native long firsttail(long jarg1);
    public final static native long nexttail(long jarg1, long jarg2);
    public final static native long firstnode__SWIG_0(long jarg1);
    public final static native long nextnode__SWIG_0(long jarg1, long jarg2);
    public final static native long firstnode__SWIG_1(long jarg1);
    public final static native long nextnode__SWIG_1(long jarg1, long jarg2);
    public final static native long firstattr__SWIG_0(long jarg1);
    public final static native long nextattr__SWIG_0(long jarg1, long jarg2);
    public final static native long firstattr__SWIG_1(long jarg1);
    public final static native long nextattr__SWIG_1(long jarg1, long jarg2);
    public final static native long firstattr__SWIG_2(long jarg1);
    public final static native long nextattr__SWIG_2(long jarg1, long jarg2);
    public final static native boolean rm__SWIG_0(long jarg1);
    public final static native boolean rm__SWIG_1(long jarg1);
    public final static native boolean rm__SWIG_2(long jarg1);
    public final static native boolean layout(long jarg1, String jarg2);
    public final static native boolean render__SWIG_0(long jarg1);
    public final static native boolean render__SWIG_1(long jarg1, String jarg2);
    public final static native boolean render__SWIG_2(long jarg1, String jarg2, long jarg3);
    public final static native boolean render__SWIG_3(long jarg1, String jarg2, String jarg3);
    public final static native boolean renderchannel(long jarg1, String jarg2, String jarg3);
    public final static native void renderresult(long jarg1, String jarg2, String jarg3);
    public final static native String renderdata(long jarg1, String jarg2);
    public final static native boolean write__SWIG_0(long jarg1, String jarg2);
    public final static native boolean write__SWIG_1(long jarg1, long jarg2);

    public static SWIGTYPE_p_Agraph_t graph(String name) {
        long cPtr = gvJNI.graph__SWIG_0(name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t digraphh(String name) {
        long cPtr = digraph(name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t strictgraphh(String name) {
        long cPtr = gvJNI.strictgraph(name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t strictdigraphh(String name) {
        long cPtr = gvJNI.strictdigraph(name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t readstringg(String string) {
        long cPtr = gvJNI.readstring(string);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t read(String filename) {
        long cPtr = gvJNI.read__SWIG_0(filename);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t read(SWIGTYPE_p_FILE f) {
        long cPtr = gvJNI.read__SWIG_1(SWIGTYPE_p_FILE.getCPtr(f));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t graph(SWIGTYPE_p_Agraph_t g, String name) {
        long cPtr = gvJNI.graph__SWIG_1(SWIGTYPE_p_Agraph_t.getCPtr(g), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t node(SWIGTYPE_p_Agraph_t g, String name) {
        long cPtr = gvJNI.node(SWIGTYPE_p_Agraph_t.getCPtr(g), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t edge(SWIGTYPE_p_Agnode_t t, SWIGTYPE_p_Agnode_t h) {
        long cPtr = gvJNI.edge__SWIG_0(SWIGTYPE_p_Agnode_t.getCPtr(t), SWIGTYPE_p_Agnode_t.getCPtr(h));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t edge(SWIGTYPE_p_Agnode_t t, String hname) {
        long cPtr = gvJNI.edge__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(t), hname);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t edge(String tname, SWIGTYPE_p_Agnode_t h) {
        long cPtr = gvJNI.edge__SWIG_2(tname, SWIGTYPE_p_Agnode_t.getCPtr(h));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t edge(SWIGTYPE_p_Agraph_t g, String tname, String hname) {
        long cPtr = gvJNI.edge__SWIG_3(SWIGTYPE_p_Agraph_t.getCPtr(g), tname, hname);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static String setv(SWIGTYPE_p_Agraph_t g, String attr, String val) {
        return gvJNI.setv__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), attr, val);
      }

      public static String setv(SWIGTYPE_p_Agnode_t n, String attr, String val) {
        return gvJNI.setv__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n), attr, val);
      }

      public static String setv(SWIGTYPE_p_Agedge_t e, String attr, String val) {
        return gvJNI.setv__SWIG_2(SWIGTYPE_p_Agedge_t.getCPtr(e), attr, val);
      }

      public static String setv(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agsym_t a, String val) {
        return gvJNI.setv__SWIG_3(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agsym_t.getCPtr(a), val);
      }

      public static String setv(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agsym_t a, String val) {
        return gvJNI.setv__SWIG_4(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agsym_t.getCPtr(a), val);
      }

      public static String setv(SWIGTYPE_p_Agedge_t e, SWIGTYPE_p_Agsym_t a, String val) {
        return gvJNI.setv__SWIG_5(SWIGTYPE_p_Agedge_t.getCPtr(e), SWIGTYPE_p_Agsym_t.getCPtr(a), val);
      }

      public static String getv(SWIGTYPE_p_Agraph_t g, String attr) {
        return gvJNI.getv__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), attr);
      }

      public static String getv(SWIGTYPE_p_Agnode_t n, String attr) {
        return gvJNI.getv__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n), attr);
      }

      public static String getv(SWIGTYPE_p_Agedge_t e, String attr) {
        return gvJNI.getv__SWIG_2(SWIGTYPE_p_Agedge_t.getCPtr(e), attr);
      }

      public static String getv(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agsym_t a) {
        return gvJNI.getv__SWIG_3(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agsym_t.getCPtr(a));
      }

      public static String getv(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agsym_t a) {
        return gvJNI.getv__SWIG_4(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agsym_t.getCPtr(a));
      }

      public static String getv(SWIGTYPE_p_Agedge_t e, SWIGTYPE_p_Agsym_t a) {
        return gvJNI.getv__SWIG_5(SWIGTYPE_p_Agedge_t.getCPtr(e), SWIGTYPE_p_Agsym_t.getCPtr(a));
      }

      public static String nameof(SWIGTYPE_p_Agraph_t g) {
        return gvJNI.nameof__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
      }

      public static String nameof(SWIGTYPE_p_Agnode_t n) {
        return gvJNI.nameof__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n));
      }

      public static String nameof(SWIGTYPE_p_Agsym_t a) {
        return gvJNI.nameof__SWIG_2(SWIGTYPE_p_Agsym_t.getCPtr(a));
      }

      public static SWIGTYPE_p_Agraph_t findsubg(SWIGTYPE_p_Agraph_t g, String name) {
        long cPtr = gvJNI.findsubg(SWIGTYPE_p_Agraph_t.getCPtr(g), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t findnode(SWIGTYPE_p_Agraph_t g, String name) {
        long cPtr = gvJNI.findnode(SWIGTYPE_p_Agraph_t.getCPtr(g), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t findedge(SWIGTYPE_p_Agnode_t t, SWIGTYPE_p_Agnode_t h) {
        long cPtr = gvJNI.findedge(SWIGTYPE_p_Agnode_t.getCPtr(t), SWIGTYPE_p_Agnode_t.getCPtr(h));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t findattr(SWIGTYPE_p_Agraph_t g, String name) {
        long cPtr = gvJNI.findattr__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t findattr(SWIGTYPE_p_Agnode_t n, String name) {
        long cPtr = gvJNI.findattr__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t findattr(SWIGTYPE_p_Agedge_t e, String name) {
        long cPtr = gvJNI.findattr__SWIG_2(SWIGTYPE_p_Agedge_t.getCPtr(e), name);
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t headof(SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.headof(SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t tailof(SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.tailof(SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t graphof(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.graphof__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t graphof(SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.graphof__SWIG_1(SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t graphof(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.graphof__SWIG_2(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t rootof(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.rootof(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t protonode(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.protonode(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t protoedge(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.protoedge(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static boolean ok(SWIGTYPE_p_Agraph_t g) {
        return gvJNI.ok__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
      }

      public static boolean ok(SWIGTYPE_p_Agnode_t n) {
        return gvJNI.ok__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n));
      }

      public static boolean ok(SWIGTYPE_p_Agedge_t e) {
        return gvJNI.ok__SWIG_2(SWIGTYPE_p_Agedge_t.getCPtr(e));
      }

      public static boolean ok(SWIGTYPE_p_Agsym_t a) {
        return gvJNI.ok__SWIG_3(SWIGTYPE_p_Agsym_t.getCPtr(a));
      }

      public static SWIGTYPE_p_Agraph_t firstsubg(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstsubg(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t nextsubg(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agraph_t sg) {
        long cPtr = gvJNI.nextsubg(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agraph_t.getCPtr(sg));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t firstsupg(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstsupg(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agraph_t nextsupg(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agraph_t sg) {
        long cPtr = gvJNI.nextsupg(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agraph_t.getCPtr(sg));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agraph_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t firstedge(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstedge__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t nextedge(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.nextedge__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t firstout(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstout__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t nextout(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.nextout__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t firstedge(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.firstedge__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t nextedge(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.nextedge__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t firstout(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.firstout__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t nextout(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.nextout__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t firsthead(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.firsthead(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t nexthead(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agnode_t h) {
        long cPtr = gvJNI.nexthead(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agnode_t.getCPtr(h));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t firstin(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstin__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t nextin(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.nextin__SWIG_0(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t firstin(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.firstin__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agedge_t nextin(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.nextin__SWIG_1(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agedge_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t firsttail(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.firsttail(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t nexttail(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agnode_t t) {
        long cPtr = gvJNI.nexttail(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agnode_t.getCPtr(t));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t firstnode(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstnode__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t nextnode(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.nextnode__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t firstnode(SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.firstnode__SWIG_1(SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agnode_t nextnode(SWIGTYPE_p_Agedge_t e, SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.nextnode__SWIG_1(SWIGTYPE_p_Agedge_t.getCPtr(e), SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agnode_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t firstattr(SWIGTYPE_p_Agraph_t g) {
        long cPtr = gvJNI.firstattr__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t nextattr(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_Agsym_t a) {
        long cPtr = gvJNI.nextattr__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_Agsym_t.getCPtr(a));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t firstattr(SWIGTYPE_p_Agedge_t e) {
        long cPtr = gvJNI.firstattr__SWIG_1(SWIGTYPE_p_Agedge_t.getCPtr(e));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t nextattr(SWIGTYPE_p_Agedge_t e, SWIGTYPE_p_Agsym_t a) {
        long cPtr = gvJNI.nextattr__SWIG_1(SWIGTYPE_p_Agedge_t.getCPtr(e), SWIGTYPE_p_Agsym_t.getCPtr(a));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t firstattr(SWIGTYPE_p_Agnode_t n) {
        long cPtr = gvJNI.firstattr__SWIG_2(SWIGTYPE_p_Agnode_t.getCPtr(n));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static SWIGTYPE_p_Agsym_t nextattr(SWIGTYPE_p_Agnode_t n, SWIGTYPE_p_Agsym_t a) {
        long cPtr = gvJNI.nextattr__SWIG_2(SWIGTYPE_p_Agnode_t.getCPtr(n), SWIGTYPE_p_Agsym_t.getCPtr(a));
        return (cPtr == 0) ? null : new SWIGTYPE_p_Agsym_t(cPtr, false);
      }

      public static boolean rm(SWIGTYPE_p_Agraph_t g) {
        return gvJNI.rm__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
      }

      public static boolean rm(SWIGTYPE_p_Agnode_t n) {
        return gvJNI.rm__SWIG_1(SWIGTYPE_p_Agnode_t.getCPtr(n));
      }

      public static boolean rm(SWIGTYPE_p_Agedge_t e) {
        return gvJNI.rm__SWIG_2(SWIGTYPE_p_Agedge_t.getCPtr(e));
      }

      public static boolean layout(SWIGTYPE_p_Agraph_t g, String engine) {
        return gvJNI.layout(SWIGTYPE_p_Agraph_t.getCPtr(g), engine);
      }

      public static boolean render(SWIGTYPE_p_Agraph_t g) {
        return gvJNI.render__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g));
      }

      public static boolean render(SWIGTYPE_p_Agraph_t g, String format) {
        return gvJNI.render__SWIG_1(SWIGTYPE_p_Agraph_t.getCPtr(g), format);
      }

      public static boolean render(SWIGTYPE_p_Agraph_t g, String format, SWIGTYPE_p_FILE fout) {
        return gvJNI.render__SWIG_2(SWIGTYPE_p_Agraph_t.getCPtr(g), format, SWIGTYPE_p_FILE.getCPtr(fout));
      }

      public static boolean render(SWIGTYPE_p_Agraph_t g, String format, String filename) {
        return gvJNI.render__SWIG_3(SWIGTYPE_p_Agraph_t.getCPtr(g), format, filename);
      }

      public static boolean renderchannel(SWIGTYPE_p_Agraph_t g, String format, String channelname) {
        return gvJNI.renderchannel(SWIGTYPE_p_Agraph_t.getCPtr(g), format, channelname);
      }

      public static void renderresult(SWIGTYPE_p_Agraph_t g, String format, String outdata) {
        gvJNI.renderresult(SWIGTYPE_p_Agraph_t.getCPtr(g), format, outdata);
      }

      public static String renderdata(SWIGTYPE_p_Agraph_t g, String format) {
        return gvJNI.renderdata(SWIGTYPE_p_Agraph_t.getCPtr(g), format);
      }

      public static boolean write(SWIGTYPE_p_Agraph_t g, String filename) {
        return gvJNI.write__SWIG_0(SWIGTYPE_p_Agraph_t.getCPtr(g), filename);
      }

      public static boolean write(SWIGTYPE_p_Agraph_t g, SWIGTYPE_p_FILE f) {
        return gvJNI.write__SWIG_1(SWIGTYPE_p_Agraph_t.getCPtr(g), SWIGTYPE_p_FILE.getCPtr(f));
      }

    /**
     * @param args
     */
    public static void main(String[] args) {
        TestGraphvizLibrary gvt = new TestGraphvizLibrary();
        //create a new graph    
        SWIGTYPE_p_Agraph_t newGraph = TestGraphvizLibrary.graph("hello");
        SWIGTYPE_p_Agnode_t headNode =    TestGraphvizLibrary.node(newGraph, "First Node");
        SWIGTYPE_p_Agnode_t tailNode = TestGraphvizLibrary.node(newGraph, "second Node"); 

        //SWIGTYPE_p_Agedge_t firstEdge = gv.edge(tailNode, headNode);
        boolean file =gv.write(newGraph, "graph");
        System.out.println("file is success "+ file);
    }

    static {
        System.out.println("Loading library...");
        System.load("/usr/lib64/graphviz/java/libgv_java.so");
        System.out.println("Loaded library.");
    }

} 
```

系统能够加载库，但是当我调用本机方法时，我在方法调用行中得到 UnsatisfiedLinkError 而没有任何消息。

我做错了什么吗？我已经在 linux 机器上安装了 graphviz，库和所有的类都在适当的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:59:51.790

我检查了安装，一切正常，所以我认为我的 java 文件有问题。

I read various posts on the naming convention while using `JNI` methods,since for `Graphviz` all the java method names are generated by `SWIG` the next thing I checked was the package structure.

In my code above I initially had all the `GraphViz` native methods in my own package name rather than `org.graphviz` (as provided by them).

I moved them to the respective packages and it worked like a charm!

# php - 理解准备好的陈述；mysqli_real_escape_string 和 htmlspecialchars

> ID：14693230
> 
> 赞同：1
> 
> 时间：2013-02-04T18:37:11.680
> 
> 标签：php

我是编程新手，只知道程序 PHP。我一直在研究准备好的陈述和其他安全问题。我对下面的代码有几个问题：

我有一张鞋类尺码表，它们的尺码和 sizeid 相同（例如，SIZE：9.5 = sizeID：也是 9.5）。

我的处理文件检查然后从以前的 html 表单页面中检索选定的大小。

```
<?php
$link = mysqli_connect("servert", "user", "passW", "footwear");
        if(!$link){
            printf("Can't connect to the locatlhost. Errorcode: %d\n", mysqli_connect_errno());
        }
if (!mysqli_select_db($link, "footwear")) {
   printf("Can't connect to Database. Errorcode: %d\n", mysqli_connect_errno());
}      
$stmt = mysqli_stmt_init($link);
if($stmt=mysqli_prepare($link,"SELECT `sizeid`,`size` FROM `size` WHERE `sizeid`"))
{
mysqli_stmt_bind_param($stmt,"i", $sizeid);
mysqli_stmt_execute($stmt);
mysqli_stmt_bind_result($stmt,$sizeid, $size);
mysqli_stmt_fetch($stmt);
        if(!floatval($size)) {
        echo "Invalid size. Pick another one.";
        }
        else {          
        $size = mysqli_real_escape_string($link, $size);
        $sizeid= mysqli_real_escape_string($link, $sizeid);

        $size= htmlspecialchars($size, ENT_QUOTES, 'UTF-8');
        $sizeid= htmlspecialchars($sizeid, ENT_QUOTES, 'UTF-8'); 

        $size = sprintf('%01.1f', $size);
        $sizeid = sprintf('%01.1f', $sizeid);

echo " Size: $size";
}
}
?> 
```

该代码有效，但我想更好地了解它是如何工作的。

1.这条线（我遵循PHP.NET）是否必要/关键？：

```
$stmt = mysqli_stmt_init($link); 
```

显然，当我省略它并直接进入查询时，代码工作得很好：

```
$stmt=mysqli_prepare($link,"SELECT `sizeid`,`size` FROM `size` WHERE `sizeid`"); 
```

2.根据我的阅读，我的理解是问号（？）用作占位符，然后绑定在 mysqli_stmt_bind_param 中；但是当我尝试

```
if($stmt=mysqli_prepare($link,"SELECT `sizeid`,`size` FROM `size` WHERE `?`"))…
mysqli_stmt_bind_param($stmt,"i", $sizeid); 
```

这没用。不是“隐藏”变量的想法吗？

`mysqli_real_escape_string`3.和`htmlspecialchars`在一起好吗？如果不是为什么，如果没关系，是否应该在另一个之前叫出一个，如果这有什么不同吗？

4\. 我需要将尺码输出为浮点数，因为现实世界的鞋码是这样的（即 7.5、9.5 等）。我选择这样做的方法（floatval 和 sprint）有什么危险吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:51:00.653

`mysqli_stmt_init`创建一个准备好的语句对象。 `mysqli_prepare`为其分配一个查询。你应该传递`$stmt`给`mysqli_prepare` `mysqli_stmt_bind_param`用于传递值以`?`替换

```
$stmt = mysqli_stmt_init($link);
// $prepared will be a boolean
// the `?` are just for the values you want to pass
$prepared = mysqli_prepare($stmt, "SELECT `sizeid`,`size` FROM `size` WHERE `sizeid` = ?");

if($prepared){
    // Replace the `?` with a value in the WHERE clause
    mysqli_stmt_bind_param($stmt, "i", $sizeid);

    // run the query
    mysqli_stmt_execute($stmt);

    // assign result variables
    mysqli_stmt_bind_result($stmt, $result_sizeid, $result_size);

    // get results
    mysqli_stmt_fetch($stmt);

    echo htmlspecialchars("The sizeid is $result_sizeid and the size is $result_size");

    // close prepared statement
    mysqli_stmt_close($stmt);
}
else{
    die(mysqli_errno($link));
}

mysqli_close($link); 
```

PHP 文档：[http ://www.php.net/manual/en/mysqli-stmt.prepare.php](http://www.php.net/manual/en/mysqli-stmt.prepare.php)

`mysqli_real_escape_string`仅用于*在*将值插入数据库之前对其进行转义。您准备的语句为您执行此操作，因此`mysqli_real_escape_string`这里*根本不需要*。

`htmlspecialchars`用于在网页上显示 HTML 字符，它将它们转义，因此它们不会被浏览器解析。

# javascript - 如何将 mouseover 和 mouseleave 事件与 jquery 中的不同目标相关联？

> ID：14693241
> 
> 赞同：0
> 
> 时间：2013-02-04T18:37:37.620
> 
> 标签：javascript, jquery, html, mouseover, mouseleave

当您的鼠标进入按钮时，我正在使用 jquery .hover 函数来显示一个列表。但是，当我尝试将鼠标放入此列表并选择某个元素时，该列表会消失。我认为这是因为 .hover 函数与按钮而不是列表相关联。那么如何将 mouseover 事件与按钮相关联，将 mouseleave 事件与按钮和整个列表相关联呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:41:50.370

您不需要使用`.hover`而是将 mouseenter 和 mouseleave 绑定到所需的元素。

```
$(thelist).on("mouseleave",function(){
    // hide the list
});
$(thebutton).on("mouseenter",function(){
    // show the list
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:58:09.693

使用状态变量表示在将鼠标从按钮移动到列表后是否应该继续显示列表。

为鼠标悬停列表事件设置一些超时将起到作用：

**HTML**

```
<input type="button" id="buttonId" value="hover" />
<ul id="list">
    <li>item1</li>
    <li>item2</li>
</ul> 
```

**CSS**

```
#list {
    display: none;
} 
```

**JavaScript**

```
var keepshowingList = false;
$('#buttonId').mouseover(function () {
    $('#list').show();
});
$('#buttonId').mouseleave(function () {
    setTimeout(function () {
        if (!keepshowingList) {
            $('#list').hide();
        }
    }, 150);
});
$('#list').mouseover(function () {
    keepshowingList = true;
});
$('#list').mouseleave(function () {
    keepshowingList = false;
    $(this).hide();
}); 
```

See example on [jsfiddle](http://jsfiddle.net/pybpQ/)

# iphone - 使用 UIAppearance 为 UIBarButtonItem 设置后退按钮的文本颜色？

> ID：14693244
> 
> 赞同：10
> 
> 时间：2013-02-04T18:37:58.320
> 
> 标签：iphone, ios, ipad

我一直在使用 UIAppearance 自定义我的 UIBarButtonItems，但我不知道如何更改后退按钮的文本样式。这是怎么做到的？

我知道如何设置背景图片：

```
[[UIBarButtonItem appearance]
   setBackButtonBackgroundImage:[UIImage imageNamed:@"arrow-button-static.png"]
   forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];

  [[UIBarButtonItem appearance]
   setBackButtonBackgroundImage:[UIImage imageNamed:@"arrow-button-pressed.png"]
   forState:UIControlStateHighlighted barMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-25T02:52:09.390

您不能仅更改后退按钮的文本属性。（或者至少，您不能使用外观代理在全局范围内这样做。）Apple 显然打算使其文本与导航栏中其他按钮的文本匹配，只有其形状（背景图像）不同。

正如@DhruvGoel 所说，您可以这样设置文本属性：

```
NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:
                                       [UIColor redColor],UITextAttributeTextColor,
                                       nil];

[[UIBarButtonItem appearance] setTitleTextAttributes:attributes                   
                          forState:UIControlStateNormal]; 
```

或者，仅对于导航栏中的条形按钮：

```
 [[UIBarButtonItem appearanceWhenContainedIn:[UINavigationBar class], nil]
            setTitleTextAttributes:attributes                   
                          forState:UIControlStateNormal]; 
```

有关如何在视图/视图控制器层次结构的特定部分自定义外观的更多详细信息，请参阅[`UIAppearance`协议文档。](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)尽管正如我所说，这不会让您在全局范围内使后退按钮文本与同一导航栏中其他按钮的文本不同。（当你的视图控制器出现时，你可以直接改变每一个，但这可能不是一个好主意。）

哦，对弹劾那件事感到抱歉。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-04T18:47:59.400

要更改后退按钮项目文本颜色，您可以使用以下命令：

```
NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:
                                           [UIColor redColor],UITextAttributeTextColor,
                                           nil];

[[UIBarButtonItem appearance] setTitleTextAttributes:attributes                   
                              forState:UIControlStateNormal]; 
```

您可以使用在 UIStringDrawing.h 中找到的键，即 UITextAttributeFont、UITextAttributeTextColor、UITextAttributeTextShadowColor 和 UITextAttributeTextShadowOffset，为文本属性字典中的标题指定字体、文本颜色、文本阴影颜色和文本阴影偏移

请注意，这仅适用于 iOS 5.0 及更高版本

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-02T18:23:31.863

如果要更改文本和后退按钮的全局颜色，这里有一个简单的解决方案（在 Swift 3 中）：

```
UINavigationBar.appearance().tintColor = UIColor.blue 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-19T09:27:51.247

您可以使用 UIButton 自定义后退栏按钮项。

```
UIButton *backButton = [[UIButton alloc] initWithFrame:frame];
UIBarButtonItem *backBarButton = [[UIBarButtonItem alloc] initWithCustomView:backButton];
backButton.titleLabel.shadowColor = [UIColor blackColor];
backButton.titleLabel.shadowOffset = CGSizeMake(0, 1);
backButton.titleLabel.textColor = [UIColor whiteColor];

[self.navigationItem setLeftBarButtonItem:backBarButton]; 
```

# android - Android 是否在系统级别过滤加速度计传感器数据？

> ID：14693248
> 
> 赞同：1
> 
> 时间：2013-02-04T18:38:10.753
> 
> 标签：android, filter, accelerometer, sensors

我正在加速度计上做一些模式匹配工作。我注意到从 Android Sensor API 记录的加速度计数据 (@100) 在某种程度上比来自其他设备（具有相同类型的硬件）或从 C(NDK) 级别记录的那些“噪音更小”。我在徘徊在Android Java级别是否有任何过滤（最有可能是低通过滤）？如果是这样，我在哪里可以找到 Android 使用的算法/过滤器？它是否出现在 Android 源代码中的任何位置？

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:01:23.083

有很多事情可能会影响传感器的准确性。这是一个广泛的话题。从其校准数据（如果有）到传感器的精度设置。很多时候驱动程序（在 Android HAL 中也是如此）可以请求具有一定准确性的数据。所以有可能得到不同的结果。一般来说，我建议您查看[这些](http://androidxref.com/4.2_r1/xref/hardware/invensense/)来源，它可以让您深入了解原始传感器数据的操作。此外，内核级别的实用程序可以捕获原始数据。最好将这些数据从好的系统与坏的系统进行比较。

如果您正在编写一个应用程序并想自己过滤数据，那么您可以通过应用[此处提到的不同过滤机制来做到这一点](http://developer.android.com/guide/topics/sensors/sensors_motion.html#sensors-motion-accel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:49:33.407

我认为 Android 不会以某种方式过滤 Accelerometer 值，因为我在文档的某个地方看到了它是原始数据的声明。虽然现在找不到这个。无论如何，如果您正在为加速度计数据寻找某种低通滤波，您可以查看[这个答案](https://stackoverflow.com/a/14127590/1277362)以更好地了解如何实现低通。

希望这可以帮助

# ruby-on-rails - 尝试启动 Rails 服务器时出现 mocha 预期错误

> ID：14693252
> 
> 赞同：2
> 
> 时间：2013-02-04T18:38:23.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rvm, ruby-mocha

我有一个完美运行的 rails 项目，但是我不得不重新安装几个 gem 并在 rbenv 和 rvm 之间切换。我之前正在运行 rvm，然后我切换到 rbenv，开始出现一堆异常，尝试切换回 rvm 但仍然收到相同的错误。

我倾向于相信这不是 rvm/rbenv 问题，而是我的 gem 安装方式发生了变化。

这是完整的堆栈跟踪：

```
> rails s thin                                                                                                                                                                                                  kaush@Air-Kode
DEPRECATION WARNING: Yajl's JSON gem compatibility API is going to be removed in 2.0
~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha/expectation_error.rb:5:in `<module:Mocha>': superclass mismatch for class ExpectationError (TypeError)
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha/expectation_error.rb:3:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `block in load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha/expectation.rb:3:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `block in load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha/mock.rb:2:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `block in load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha/mockery.rb:2:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `block in load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha/api.rb:2:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `block in load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha_standalone.rb:1:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `block in load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:597:in `new_constants_in'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:225:in `load_dependency'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/activesupport-3.0.20/lib/active_support/dependencies.rb:242:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/mocha-0.10.0/lib/mocha.rb:2:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@global/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
    from ~/my_project/config/application.rb:7:in `<top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/railties-3.0.20/lib/rails/commands.rb:28:in `require'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/railties-3.0.20/lib/rails/commands.rb:28:in `block in <top (required)>'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/railties-3.0.20/lib/rails/commands.rb:27:in `tap'
    from ~/.rvm/gems/ruby-1.9.2-p180@my-gemset/gems/railties-3.0.20/lib/rails/commands.rb:27:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

我的宝石版本：

```
 gem 'rails', '3.0.20'
   gem 'mocha' 
```

在过去的 3 天里，这件事一直困扰着我，希望有任何帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T09:44:45.990

在从 rails-3.0.9 升级到 3.0.20 的情况下，我有一个类似的堆栈，但是在测试应用程序时（ rspec ）

## 测试

```
[sec] $ rm lib/mocha/setup.rb
[sec*]$ bundle exec rspec spec/
/Users/thenrio/.rbenv/versions/1.9.2-p290/lib/ruby/gems/1.9.1/gems/mocha-0.10.5/lib/mocha/expectation_error.rb:5:in `<module:Mocha>': superclass mismatch for class ExpectationError (TypeError) 
```

一个解决方案是

```
[sec*]$ git checkout -f
[sec]$ cat lib/mocha/setup.rb
# patching nightmare
#
# XXX remove when rails > 3.2.0
#
# https://github.com/freerange/mocha/issues/138
#

[sec]$ bundle exec rspec spec
Finished in 8.85 seconds
421 examples, 0 failures 
```

## 跑

mocha 不需要运行服务器

检查您的 Gemfile

`mocha`**在测试**组中占有一席之地( `group :test do; gem 'mocha', '~> 0.10.0', require: false; end`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:04:05.280

如果您的 RVM 设置以前可以正常工作，您应该：

1.  仅使用 RVM 环境打开一个新的控制台/ssh 会话
2.  rvm gemset 删除我的gemset
3.  rvm gemset 创建我的gemset
4.  cd（应该自动加载 .rvmrc 文件或 rvm gemset 使用 my-gemset）
5.  捆绑安装

这应该重建此应用程序的工作 gemset。

# asp.net-web-api - asp web api DateTime 模型绑定

> ID：14693255
> 
> 赞同：5
> 
> 时间：2013-02-04T18:38:36.110
> 
> 标签：asp.net-web-api

我在 web api 中绑定 DateTimes 时遇到了一些麻烦。这是情况。我有一个控制器，它返回一个具有 DateTime 属性的模型。我已经将我的 web api 设置为在 global.asax 中使用 IsoDateFormat 和 UTC 时间，如下所示：

```
 HttpConfiguration config = GlobalConfiguration.Configuration;
        config.Formatters.JsonFormatter.SerializerSettings.DateFormatHandling = Newtonsoft.Json.DateFormatHandling.IsoDateFormat;
        config.Formatters.JsonFormatter.SerializerSettings.DateTimeZoneHandling = Newtonsoft.Json.DateTimeZoneHandling.Utc; 
```

日期时间格式以这种格式返回给客户端：2013-02-04T11:24:48.91Z

在那方面一切都很好。但是，如果我以相同的格式将其发布回来，模型绑定器将无法识别该属性并将其保留为空。输入日期时间需要采用什么格式才能使默认的 DateTime 模型绑定起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:25:12.033

我已经按照您指定的方式配置了我的 Web API 服务，并且能够发布您指定格式的 DateTime。你有`[FromBody]`你的 DateTime 参数吗？原始类型是`[FromUri]`默认的。

```
public DateTime Post([FromBody]DateTime date)
{
    return date;
} 
```

要求：

```
POST http://localhost/api/values HTTP/1.1
content-type: application/json
Content-Length: 25

"2013-02-04T11:24:48.91Z" 
```

回复：

```
HTTP/1.1 200 OK
Content-Length: 25
Content-Type: application/json; charset=utf-8

"2013-02-04T11:24:48.91Z" 
```

# python - mod_wsgi 报告金字塔模块中的语法错误

> ID：14693256
> 
> 赞同：1
> 
> 时间：2013-02-04T18:38:42.003
> 
> 标签：python, apache, mod-wsgi, pyramid

我刚刚完成了 mod_wsgi 的安装，但我在启动 Pyramid 应用程序时遇到了问题。

我在 CentOS 5.8 上使用 python 2.7、Apache 2.2.3、mod_wsgi 3.4

这是我的 httpd.config 文件

```
WSGISocketPrefix run/wsgi

<VirtualHost *:80>
 ServerName  myapp.domain.com
 ServerAlias myapp
 WSGIApplicationGroup %{GLOBAL}
 WSGIPassAuthorization On
 WSGIDaemonProcess pyramid user=apache group=apache  processes=1 threads=4 \
   python-path=/var/wsgi_sites/site-packages
 WSGIScriptAlias / /var/wsgi_sites/myapp/apache.wsgi

<Directory /var/wsgi_sites/myapp>
  WSGIProcessGroup pyramid
  Order allow,deny
  Allow from all
</Directory>

  LogLevel debug
  ErrorLog /var/log/httpd/myapp_error
</VirtualHost> 
```

我已经给了 Apache 对 site-package、python-eggs 和 myapp 文件夹的所有权。

我用来创建 WSGI 应用程序 appache.wsgi 的模块包含以下代码

```
import os
os.environ['PYTHON_EGG_CACHE'] = '/var/wsgi_sites/python-eggs'

from pyramid.paster import get_app
application = get_app('/var/wsgi_sites/myapp/development.ini','main') 
```

当我重新启动 Apache 并尝试访问应用程序时，我收到以下错误

```
mod_wsgi (pid=14842, process='pyramid', application=''): Loading WSGI script '/var/wsgi_sites/myapp/apache.wsgi'.
mod_wsgi (pid=14842): Target WSGI script '/var/wsgi_sites/myapp/apache.wsgi' cannot be loaded as Python module.
mod_wsgi (pid=14842): Exception occurred processing WSGI script '/var/wsgi_sites/myapp/apache.wsgi'.
Traceback (most recent call last):
File "/var/wsgi_sites/myapp/apache.wsgi", line 4, in ?
from pyramid.paster import get_app
File "/var/wsgi_sites/site-packages/pyramid-1.3.2-py2.7.egg/pyramid/__init__.py", line 1, in ?
from pyramid.request import Request
File "/var/wsgi_sites/site-packages/pyramid-1.3.2-py2.7.egg/pyramid/request.py", line 
class Request(BaseRequest, DeprecatedRequestMethodsMixin, URLMethodsMixin,
    ^
SyntaxError: invalid syntax 
```

我尝试查看 request.py 文件，但没有语法错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T19:17:39.857

通常，当您遇到语法错误时，前一行是罪魁祸首。查看[Pyramid 源代码](https://github.com/Pylons/pyramid/blob/master/pyramid/request.py)，我们看到前一行是：

```
@implementer(IRequest) 
```

这是一个类装饰器。在 2.6 版中，类装饰器被添加到 Python 中。CentOS 5.8 上 Python 的默认版本是 2.4。

您的解决方案是：
1\. 使用具有更新版本 Python 的操作系统，或
2\. 确保您的 Pyramid 应用程序使用 2.7 版。这涉及到安装 Python 2.7**以及**系统的默认 Python 安装，该安装由其他应用程序使用并且必须单独放置。

如果您选择安装 2.7，您将执行以下操作：

```
$ wget http://www.python.org/ftp/python/2.7.3/Python-2.7.3.tar.bz2
$ tar xf Python-2.7.3.tar.bz2
$ cd Python-2.7.3
$ ./configure --prefix=/usr/local
$ 制作 && 制作 altinstall

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:20:08.947

我看到错误中提到了两个不同的 wsgi 文件

/var/wsgi_sites/project_name_api/apache.wsgi

和

/var/wsgi_sites/myapp/apache.wsgi

我在您粘贴的 httpd.conf 中看不到任何 project_name 路径引用。

你可能想先回顾一下。如果问题仍然存在，请发布其他信息以进一步帮助您。

# for-loop - “在回答中输入”测验 Actionscript

> ID：14693269
> 
> 赞同：0
> 
> 时间：2013-02-04T18:39:25.703
> 
> 标签：for-loop, actionscript, multidimensional-array, actionscript-2

这些问题是随机的，但它们显示了我的需要。正如您在 answer[0] 中看到的那样，我必须指定三个可能的答案。如果“bill”写在他们答案的任何地方，我希望能够说明答案是正确的。但这行不通

```
for (var i = 0; i < answer[index].length; i++)
{
    for (answer[index][i] in answer_input.text.toLowerCase())
    {
        correct = true;

    }

answer = new Array();
answer[0] =  ["your name is bill","bill's your name","your name's bill"]
answer[1] = ["john", "sean", "greg"]
question = new Array();
question[0] = "whats my name?"
question[1] = "whats not my name?"
index = 0;

onEnterFrame = function ()
{
    question_txt.text = question[index];
};

enter1.onRelease = function()
{
    question_txt.text = question[index];
    var correct = false;
    for (var i = 0; i < answer[index].length; i++)
    {
        if (answer[index][i] == answer_input.text.toLowerCase())
        {
            correct = true;

        }
    }

    if (correct)
    {
        index++;
        answer_input.text = "";
    }
    else
    {
        answer_input.text = "Incorrect";
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:25:53.280

如果您只想检查答案中是否写有“bill”，为什么不使用

```
answer_input.text.toLowerCase().indexOf( "bill", 0 ) 
```

如果“bill”在那里，该函数将返回它在答案中出现的索引。如果不存在，将返回 -1。

# vba - Excel VBA MultiPage - 获取页数

> ID：14693271
> 
> 赞同：2
> 
> 时间：2013-02-04T18:39:34.510
> 
> 标签：vba, excel

我在 excel vba 2010 中创建了一个多页表单。如何获取这个多页中的页数？

谢谢，敲诈

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:53:08.073

试试这个：

```
Dim mulpage as Control, pge as Page, counter as Integer
For Each mulPage In Me.Controls
       If TypeName(mulPage) = "MultiPage" Then
           For Each pge In mulPage.Pages
               counter = counter + 1
           Next pge
       End If
Next 
```

> **[我的代码是在 2003 年。所以对你来说，你需要引用`Form Page property`明确的 using `Dim pge As msforms.Page`而不是`Dim pge As Page`2007 年、2010 年......继续前进。](http://msdn.microsoft.com/en-us/library/office/gg264582.aspx)**

参考：

*   [http://support.microsoft.com/kb/155374](http://support.microsoft.com/kb/155374)

*   [http://www.ozgrid.com/Excel/free-training/ExcelVBA2/excelvba2lesson8.htm](http://www.ozgrid.com/Excel/free-training/ExcelVBA2/excelvba2lesson8.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-25T05:00:13.057

使用以下内容获取多页中的页数

```
msgbox Multipage1.Pages.Count 
```

# asp.net - 在 Visual Studio 2008 中生成数据库失败

> ID：14693272
> 
> 赞同：2
> 
> 时间：2013-02-04T18:39:34.217
> 
> 标签：asp.net, database, visual-studio-2008

我今天打开了一个项目并刷新了我连接的数据库，但是当我这样做时，我收到了这个错误：由于启动用户实例的进程失败，无法生成 SQL Server 的用户实例。连接将被关闭。

在此之前，我收到了有关兼容性问题的通知，并且可以选择在线获得帮助或无论如何运行，机器人选择导致我出现上述错误并且我的数据库仍然无法连接。

数据库以前运行良好，但我不确定为什么现在会出现此错误。对此问题的任何解决方案将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T02:20:03.907

我们之前多次遇到过这个问题。以下是您的选择：

**删除 SQLExpress 目录**，然后重新启动计算机

C:\Documents and Settings\用户名\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS 目录

*或者*

在 SQL Server 属性中选择**本地系统帐户选项**

*或者*

如果您使用成员资格提供程序，请将 web.config 中的 ConnectionString 名称替换为**LocalSqlServer**

此链接 [SQL Server Express 用户实例化和 ASP.net Web 应用程序项目的问题] ( [http://support.microsoft.com/kb/2002980](http://support.microsoft.com/kb/2002980) ) 将能够向您解释。

我希望它对你有帮助。

# css - li下的ul:hover在IE中不渲染，虽然出现了box shadow

> ID：14693276
> 
> 赞同：0
> 
> 时间：2013-02-04T18:39:50.093
> 
> 标签：css, internet-explorer

我有一个包含嵌套 ul li 元素的导航菜单。嵌套的 ul 应该仅在父 li 元素悬停时显示。

```
ul#menu_system ul {
width:200px;
display:none;
position:absolute;
left:0;
top:100%;
-moz-box-shadow:0 3.5px 12px #000000;
-webkit-box-shadow:0 3.5px 12px #000000;
box-shadow:0 3.5px 12px #000000;
background-color:#ececec;
border-width:0px;
padding:0 10px 10px;
}

ul#menu_system li:hover > ul
{
    display:block;
} 
```

在 firefox/chrome 中一切正常，只有 IE 只是在悬停时显示框阴影，没有别的。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T07:28:33.597

我把它修好了。`ul#menu_system li`我删除了应用于IE 元素的渐变过滤器。现在一切正常。

# android - Android MediaPlayer.snoop()：如何获取未来的音频数据？

> ID：14693279
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:05.790
> 
> 标签：android, audio, android-mediaplayer, visualizer, snoop

如果可能的话，如果没有奇怪的解决方法，我猜这是不可能的。然而，

***我将如何使用 snoop() （或类似的东西）提前大约 10 秒获取音频或在后台播放的整个音频文件的音频数据？***

我几乎不知道这将如何工作。但是，一个想法可能是录制 10 秒的音频 + 音频数据（以某种方式）并延迟播放，或者只是不允许它播放这 10 秒，然后在 10 秒后播放已经录制的音频内容。这听起来很不可能，因为我觉得您将无法停止或以其他方式使设备播放的音频静音。

我想将它用于玩家对他们在媒体播放器中播放的歌曲做出反应的游戏。这就是为什么在歌曲实际出现之前向用户展示音频数据的样子会很有用。

无论如何，我们将不胜感激，这将大大改善游戏！

在此先感谢，卡尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:43:11.367

它的实现非常依赖于设备！

理论上适用于所有设备和操作系统，但远不是真的！

我在 8 日的 7 设备测试中使用了 play() 不起作用！

希望能帮助到你！

# mysql - 如何在mysql中使用标题字母对行进行排序

> ID：14693281
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:07.847
> 
> 标签：mysql

我有一张桌子

```
 ---------
|   NAME  |
|---------|
|  arun   |
|  balu   |
|  sunny  |
|  binu   |
|  binoy  |
|  cinny  |
|  aiju   |
|  dolly  |
 --------- 
```

我写了一个查询来获取mysql中的排序列表

```
SELECT name FROM students ORDER BY name ASC 
```

我把所有的名字都排序了，但我不知道如何得到如下所示的输出

```
 ---------
|   NAME  |
|---------|
|    A    |
|  aiju   |
|  arun   |
|    B    |
|  balu   |
|  binoy  |
|  binu   |
|    C    |
|  cinny  |
|    D    |
|  dolly  |
|    S    |
|  sunny  |
 --------- 
```

谁能告诉我如何获得这个输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:45:01.310

如果您想在 SQL 中执行此操作，则可以使用`UNION ALL`查询。第一个查询将返回 the `name`，第二个查询将返回每个名称的第一个字母。然后你可以`ORDER BY`得到结果：

```
select name
from yourtable
union all
select distinct upper(left(name, 1))
from yourtable
order by name 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/be1316/4)

结果是：

```
|  NAME |
---------
|     A |
|  aiju |
|  arun |
|     B |
|  balu |
| binoy |
|  binu |
|     C |
| cinny |
|     D |
| dolly |
|     S |
| sunny | 
```

# html - Perl 到 MySQL html 文本

> ID：14693282
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:17.800
> 
> 标签：html, mysql, perl, unicode

我正在解析一些html：

```
use Modern::Perl;
use Mojo::DOM;
use strict;
use DBI;
use DBD::mysql;
use utf8::all;

my $dbh = DBI->connect("DBI:mysql:db_name", "db_username") or die ("Error:  
$DBI::errstr");

my $html = do { local $/; <DATA> };
my $dom = Mojo::DOM->new($html);
my $text = $dom->all_text;
say $text;

my ($var1, $var2, $var3);  #normally have values assigned, but not relevant to example

#write $text to MySQL database 
$dbh->do("INSERT INTO table_name VALUES (?,?,?,?)",
                            undef,
$var1, $var2, $var3, $text
);

__DATA__
<div class="field-content"><p>&nbsp;</p>
<p>Here is some data with a trademark html symbol SUPER PRODUCT&trade;, featuring curved
LCD screen.</p></div> 
```

将解析后的文本写入标准输出会产生以下结果：

```
Here is some data with a trademark html symbol SUPER PRODUCT™, featuring curved LCD 
screen. 
```

一切都很好，这是写入 MySQL 的。但是，在 MySQL 中以及从 MySQL 中提取数据时，我们会得到：

```
Here is some data with a trademark html symbol SUPER PRODUCTâ„¢, featuring curved LCD
screen. 
```

我怀疑这与 Unicode 有关，所以尝试更改 MySQL 状态设置，但仍然没有乐趣。如何正确解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:19:10.470

这个说法

```
#write $text to MySQL database 
```

掩盖了许多重要的细节，并且您没有包含描述如何从数据库中读取文本的代码，这也可能很难做到正确。

让我有根据地猜测您数据库中的文本是 UTF-8 编码的。然后，您将要解码来自该数据库列的所有内容：

```
use Encode;
$decoded_text = Encode::decode("utf-8", $raw_text);

# since you 'use utf8::all', this will get re-encoded to UTF-8 when you write
# it to standard output ...
print "decoded text is $decoded_text\n"; 
```

# php - 在页面关闭时运行命令？

> ID：14693285
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:34.057
> 
> 标签：php

如果窗口关闭，有没有办法可以运行 php 命令？

例如，我有一个脚本，用户可以使用该脚本将文件上传到服务器上的临时目录，以便用户决定是否要保留它们。但是，就目前而言，如果用户只是离开页面，文件就会保留在那里。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:44:08.307

您可以使用 onBeforeUnload 添加一个在离开页面之前警告用户的 javascript，可以在此处找到一些示例：

[JavaScript + onbeforeunload](https://stackoverflow.com/questions/1270395/javascript-onbeforeunload)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:44:10.953

您可能能够在 javascript 中拦截页面退出事件并将其传递给您的 php 应用程序：[拦截页面退出事件](https://stackoverflow.com/questions/1704533/intercept-page-exit-event)

这似乎会更好地实现为服务器上的 cron 作业，该作业将清理临时目录中的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T18:44:13.203

PHP 脚本必须由“某物”初始化。照这样说：

您可能会考虑一项`CRON`经常运行并为您运行`PHP`脚本的作业。例如，假设您想每半小时“清除”一次临时目录，CRON 作业将非常适合。- 原因`JavaScript`可能不是您最好的选择，就像您说的那样，如果用户关闭窗口，则`JavaScript`停止运行。

# php - 在 Moodle 课程上跟踪用户

> ID：14693286
> 
> 赞同：1
> 
> 时间：2013-02-04T18:40:34.693
> 
> 标签：php, moodle

谁能告诉我是否有一些插件可以跟踪课程中的用户？

我需要知道哪个用户在哪一点上或完成哪些测试才能知道他何时进行最终测试并获得某些课程的最终证书。这可能吗？怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T11:37:49.397

是的，它主要在 Moodle 菜单中访问。

要查看谁完成了哪个测试，请转到导航 > 报告 > 活动完成

（确保活动完成当然是打开的！）

如果不是，请告诉我。您可以在“设置”>“站点管理”>“启用活动完成”中打开它

您使用的是哪个版本的 Moodle？

# python - 我无法使用 urwid 教程示例

> ID：14693288
> 
> 赞同：2
> 
> 时间：2013-02-04T18:40:42.170
> 
> 标签：python, linux, console, urwid

作为 Python 和 urwid 的新手，我在这里尝试了教程示例[http://excess.org/urwid/docs/tutorial/](http://excess.org/urwid/docs/tutorial/)

然而，虽然第一个确实可以正常工作，但大多数后来的似乎都不起作用。例如，尝试运行这个特定的：

```
import urwid

choices = u'Chapman Cleese Gilliam Idle Jones Palin'.split()

def menu(title, choices):
    body = [urwid.Text(title), urwid.Divider()]
    for c in choices:
        button = urwid.Button(c)
        urwid.connect_signal(button, 'click', item_chosen, c)
        body.append(urwid.AttrMap(button, None, focus_map='reversed'))
    return urwid.ListBox(urwid.SimpleFocusListWalker(body))

def item_chosen(button, choice):
    response = urwid.Text([u'You chose ', choice, u'\n'])
    done = urwid.Button(u'Ok')
    urwid.connect_signal(done, 'click', exit_program)
    main.original_widget = urwid.Filler(urwid.Pile([response,
        urwid.AttrMap(done, None, focus_map='reversed')]))

def exit_program(button):
    raise urwid.ExitMainLoop()

main = urwid.Padding(menu(u'Pythons', choices), left=2, right=2)
top = urwid.Overlay(main, urwid.SolidFill(u'\N{MEDIUM SHADE}'),
    align='center', width=('relative', 60),
    valign='middle', height=('relative', 60),
    min_width=20, min_height=9)
urwid.MainLoop(top, palette=[('reversed', 'standout', '')]).run() 
```

向我显示以下错误：

```
Traceback (most recent call last):
  File "example.py", line 23, in <module>
    main = urwid.Padding(menu(u'Pythons', choices), left=2, right=2)
  File "example.py", line 11, in menu
    return urwid.ListBox(urwid.SimpleFocusListWalker(body))
AttributeError: 'module' object has no attribute 'SimpleFocusListWalker' 
```

难道我做错了什么？如果它有任何帮助，我正在运行 Ubuntu 12.10 64 位。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T21:23:53.793

我想通了，我自己回答这个问题，以防万一有人遇到同样的问题。

这个问题的根源在于教程示例使用了早期版本的 urwid 上不存在的调用，例如 Ubuntu 存储库中可用的调用。从源代码安装解决了这个问题。

如果从源代码安装时遇到问题，请确保安装了 python-dev 包。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-08-07T04:00:41.133

我已经安装了它`pip`。在终端中，您必须编写：

```
sudo pip install urwid 
```

# apache - XAMPP 访问禁止错误

> ID：14693290
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:46.707
> 
> 标签：apache, hosting, xampp

我试图从我的家用计算机托管一个简单的网站。我有静态 IP 并从 conf 文件设置它，但它给出了访问错误。

禁止访问！

新的 XAMPP 安全概念：

只能从本地网络访问请求的对象。

可以在文件“httpd-xampp.conf”中配置此设置。

如果您认为这是服务器错误，请联系网站管理员。错误 403

据我所知，它设法找到了该站点，但存在授权问题。我该怎么做才能使其向公众开放？它在 Windows 7 上运行。有大多数 Linux 的解决方案。我尝试过但没有工作 ：-（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-10T16:24:21.917

尝试以下操作（假设安装了 Windows 7 XAMPP）：

*   打开你的 XAMPP 控制面板
*   在 Apache 的行上单击“配置”
*   点击 Apache (httpd-xampp.conf) (或使用记事本定位 c:\xampp\apache\conf\extra\httpd-xampp.conf)
*   滚动到底部或直到您看到“#New XAMPP security concept”
*   如果您不关心安全性：将“全部拒绝”更改为“全部允许”
*   否则：
    *   找到“允许来自”部分的最后一行：（通常为 169.253.0.0./16）
    *   使用您的静态 IP 地址添加一个新条目，这是一个棘手的问题：您需要在此 IP 地址之后添加“/8”、“/12”或“/16”，具体取决于它是什么。如果是 192.168.xx 地址，则添加“/16”。如果是“10.xxx”地址添加“/8”。如果它是 ISP 提供给您的地址，则您必须进行试验。“/NNN”符号表示前面的位数，代表地址的网络部分。
*   保存文件
*   停止和启动 Apache

# java - Java 正则表达式删除虚拟时间戳

> ID：14693292
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:49.220
> 
> 标签：java, regex

我想知道正则表达式将最有效地实现以下目标：

在日期和时间戳字符串中，如果时间戳只是零，我想删除它。但问题是时间戳可以有多种格式。例如：

```
2013-02-04 00:00:00
2013-02-04 00:00:00.0
2013-02-04 00:00 AM
2013-02-04 00:00 PM 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:47:01.917

对于每一行：

```
line.replaceAll("(00:?)+(.0)?\s*([AP]M)", "");

(              // start time group
00             // strange timestamp symbol
:?             // allow ':'
)+             // strange group can be repeated more than one time
(.0)?          // if ms was specified
\s*            // allow spaces before AM,PM
(              // AM, PM group
[AP]           // A or P letter
M              // M
)?             // AP, PM group can not exists 
```

# jquery - slideToggle 附加文本交换

> ID：14693293
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:49.877
> 
> 标签：jquery, jquery-plugins

在 slideToggle 操作中使用以下代码将 + 更改为 - 有一点时间。

```
jQuery('.mean-nav ul ul').show();
if(meanToggleChildren){
    jQuery('.mean-nav ul ul').hide();
    if(jQuery('.mean-nav ul ul').length){
        jQuery('<span class="mm-open-close">+</span>').insertBefore(jQuery('.mean-nav ul ul'));
        jQuery('.mean-nav ul li').click(function(){
            jQuery(this).find('ul').slideToggle('fast', function(){
                $('.mm-open-close').text().toLowerCase().indexOf('-') != -1 ? $('.mm-open-close').text('+') : $('.mm-open-close').text('-');
            });
        });
    }
} 
```

它在正确的位置插入 +，但是，交换似乎无法正常工作，因为（根据下面的 html）它交换了两个 +

这是使用 jQuery 1.7.1 库、meanMenu 响应式导航插件和以下 HTML：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<style type="text/css">
/* hide the link until viewport size is reached */
a.meanmenu-reveal {
display: none;
}

/* when under viewport size, .mean-container is added to body */
.mean-container .mean-bar { 
float: left;
width: 100%;
position: relative;
background: #0c1923;
padding: 4px 0;
min-height: 33px;
z-index:9000;
}
.mean-container a.meanmenu-reveal {
width: 22px;
height: 22px;
padding: 10px 10px 8px 10px;
position: absolute;
top: 0;
right: 0;
cursor: pointer;
color: #fff;
text-decoration: none;
font-size: 16px;
text-indent: -9999em;
line-height: 22px;
font-size: 1px;
display: block;
font-family: Arial, Helvetica, sans-serif;
font-weight: 700;
}
.mean-container a.meanmenu-reveal span {
display: block;
background: #fff;
height: 3px;
margin-top: 3px;
}
.mean-container .mean-nav { 
float: left;
width: 100%;
background: #0c1923;
margin-top: 33px;
}
.mean-container .mean-nav ul {
width: 100%;
}
.mean-container .mean-nav ul li a {
display: block;
float: left;
width: 90%;
padding: .5em 5%;
margin: 0;
text-align: left;
color: #fff;
border-top: 1px solid #383838;
border-top: 1px solid rgba(255,255,255,0.5);
text-decoration: none;
text-transform: uppercase;
}
.mean-container .mean-nav ul li:first-child a { 
border: none; 
}
.mean-container .mean-nav ul li li a {
width: 80%;
padding: .5em 10%;
border-top: 1px solid #f1f1f1;
border-top: 1px solid rgba(255,255,255,0.25);
opacity: 0.75; 
filter: alpha(opacity=75);
text-shadow: none !important;
visibility: visible;
}
.mean-container .mean-nav ul li li li a {
width: 70%;
padding: .5em 15%;
}
.mean-container .mean-nav ul li li:first-child a {
border-top: 1px solid #f1f1f1;
border-top: 1px solid rgba(255,255,255,0.25);
}
.mean-container .mean-nav ul li a:hover { 
background: #252525;
background: rgba(255,255,255,0.1); 
}
.mean-container .mean-push { 
float: left;
width: 100%;
padding: 0;
margin: 0;
clear: both; 
}
.mm-open-close{color:#fff;float:left;}
</style>
</head>
<body>
<header>
<nav>
    <ul>
        <li><a>Test</a></li>
        <li><a>Test</a></li>
        <li><a>Test</a>
            <ul>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
            </ul>
        </li>
        <li><a>Test</a>         <ul>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
                <li><a>Test</a></li>
            </ul>
        </li>

        <li><a>Test</a></li>
        <li><a>Test</a></li>
    </ul>
</nav>
</header>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
<script type="text/javascript" src="/mean.menu.js"></script>
<script type="text/javascript">
    jQuery(document).ready(function($){
        $('header nav').meanmenu({
            meanScreenWidth:        800, 
            meanRevealPosition:     "left",
            meanShowChildren:       true,
            meanToggleChildren:     true
        });
    });
</script>
</body>
</html> 
```

当切换部分时，如何正确地将 + 换成 - ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:03:20.463

这就是我在插件本身中的做法（今天在[https://github.com/weare2ndfloor/meanMenu](https://github.com/weare2ndfloor/meanMenu)上发布的新版本）。

```
// hide sub nav
                   if(meanShowChildren) {
                        // allow expandable sub nav(s)
                       if(meanExpandableChildren){
                           jQuery('.mean-nav ul ul').each(function() {
                               if(jQuery(this).children().length){
                                   jQuery(this,'li:first').parent().append('<a class="mean-expand" href="#" style="font-size: '+ meanMenuCloseSize +'">'+ meanExpand +'</a>');                               
                               }
                           });
                           jQuery('.mean-expand').on("click",function(e){
                                e.preventDefault();
                               if (jQuery(this).hasClass("mean-clicked")) {
                                    jQuery(this).text(meanExpand);
                                    console.log("Been clicked");
                                   jQuery(this).prev('ul').slideUp(300, function(){

                                   });
                               } else {
                                    jQuery(this).text(meanContract);
                                    jQuery(this).prev('ul').slideDown(300, function(){
                                    });
                               }   
                               jQuery(this).toggleClass("mean-clicked"); 
                           });     
                       } else {
                           jQuery('.mean-nav ul ul').show();   
                       }
                   } else {
                       jQuery('.mean-nav ul ul').hide();
                   } 
```

显然，我的函数名称不同。与您的主要区别在于只有 + 是可点击的。

不过，您需要从上面的链接中获取新的 CSS 和插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T13:23:29.090

找到并修复它：

```
if(meanShowChildren) {
    if(meanToggleChildren){
        //check to make sure that there are children first off...
        if(jQuery('.mean-nav ul ul').length){
            jQuery('.mean-nav ul ul').prev().prepend('<span class="mm-open-close">+</span>');                               
            jQuery('.mean-nav ul li').click(function(){
                jQuery(this).find('ul').slideToggle('fast', function(){
                    var tObj = jQuery(this).prev().find('.mm-open-close');
                    tObj.text().toLowerCase().indexOf('-') != -1 ? tObj.text('+') : tObj.text('-');
                });
            });                             
        }
    } else {
        jQuery('.mean-nav ul ul').show();   
    }
} else {
    jQuery('.mean-nav ul ul').hide();
} 
```

# wcf - Windows Phone 中的 WCF 实践

> ID：14693294
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:55.863
> 
> 标签：wcf, windows-phone-7, windows-phone-8

我在我的 Windows Phone 应用程序中添加了一个非常基本的 WCF 服务。当点击 Windows Phone UI 上的按钮时，我正在调用`_service.AddTwoNumbersAsync(1, 2);`，它只是在`int`.

我有一个`AddTwoNumbersCompleted`活动，我只是做`MessageBox.Show(e.Result.ToString());`

这工作得很好，并返回了正确的答案。

我的问题是 - 就最佳实践而言，这是在服务中调用方法的最标准方式吗？我没有正确调用它吗？我需要做`OpenAsyn()`什么吗？这是调用服务的安全方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:19:27.477

您现在使用它的方式是正确的方式。您有一个服务客户端，调用异步方法并绑定到回调事件处理程序。除非您尝试修改客户端配置以同步使用它，否则实际上没有什么比这更多的了。

请注意，通过调用异步方法，您正在切换线程上下文 - 如果有的话，这应该是您的主要关注点。

# javascript - 通过指定应该应用 css 规则的时间点来加速 javascript 动画

> ID：14693295
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:58.393
> 
> 标签：javascript, animation

假设我在一个页面上有 10 个元素。

目前我正在循环中迭代它们，改变宽度和位置：

```
el[i].style.width = ....
el[i].style.left = .... 
```

我想知道如果我告诉浏览器在循环完成后只重新渲染所有元素一次，动画是否可以运行得更快

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:27:29.213

使用 CSS3 更快，您将不得不编写更少的代码，看看这个[Jsbin](http://jsbin.com/aconaj/3/)，我只做了两个示例，一个使用[过渡](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_transitions)(.anima2)，另一个使用[动画](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_animations)(.anima)。使用 JS，您只需要应用和删除类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:08:47.597

如果您将更改应用到共享类或加载包含所有更改的样式表，这将使所有更改同时应用，但不确定性能影响......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T08:38:23.640

由我调查（不完全跨浏览器，行为不同和变化，这需要大量的测试 abd 基准测试）：

一个）`requestAnimationFrame`

b) CSS`translate3d`和其他新的 CSS3 代替`left`GPU 优化

稍后回来，我会告诉结果

# sql - 向我显示 72 小时内因相同原因出院和重新入院的患者人数的查询

> ID：14693296
> 
> 赞同：2
> 
> 时间：2013-02-04T18:40:58.583
> 
> 标签：sql, sql-server, tsql

在 SQL Server 2005 中，我有一个存储医院传入和传出患者的表。

表数据存储为：患者全名、入院日期、出院日期、入院原因。

我需要的是一个查询，以显示在 72 小时内因相同原因出院和重新入院的患者人数。

表结构为：

```
CREATE TABLE hospital(
     patient   varchar(50),    
     in        datetime, 
     out       datetime, 
     reason_id int
 ); 
```

这是查询：

```
SELECT DISTINCT H1.PATIENT 
FROM HOSPITAL H1 
   INNER JOIN (SELECT * FROM HOSPITAL) H2 ON DATEDIFF(HOUR,H1.IN,H2.OUT) < 72 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:48:49.887

```
select distinct h1.patient
from   Hospital h1 join Hospital h2 on h1.patient = h2.patient
where  h1.[in] < h2.[in]
and    h2.[in] < dateadd(hour, 72, h1.[out])
and    h1.reason_id = h2.reason_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:29:42.860

一般来说，你会选择他们被录取至少72小时的记录，对吧？这样做；

```
SELECT Patient FROM 
(
SELECT Patient, DATEDIFF ("HH", In,Out)HOURDIFF FROM hospital
)temp 
WHERE HOURDIFF > 72 
```

当患者重新入院时，您将需要 reason_id 字段并将其添加到 Where 子句中，这样您就可以进一步过滤以获得相同的入院和重新入院原因 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:56:31.307

如果您真的想在 72 小时内查看*下一次*入场，那么最好的选择是使用`lag`. . . 假设你有 SQL Server 2012。否则，这个查询做同样的事情。

好吧，我将描述答案。您可以使用相关子查询来获取下一个原因和下一次。然后是`where`满足条件的子句：

```
where nextIn <= DATEADD(hh, 72, out) and
      nextReason = reason 
```

[上传问题的答案]

# php - mySQL 选择优先级 - 选择一行或另一行（选择默认或“后备”行）

> ID：14693297
> 
> 赞同：0
> 
> 时间：2013-02-04T18:40:59.050
> 
> 标签：php, mysql

这应该相当简单，但是在搜索时找到要使用的正确术语很棘手。

`WHERE lang='en'`在下面的查询中，我只需要选择不`WHERE lang='nl_NL'`返回任何内容。换句话说，我想查找所有记录`WHERE script='generic'`，优先级为`lang=nl_NL`

```
SELECT * FROM international WHERE script='generic' AND (lang = 'nl_NL' OR lang = 'en') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:49:09.853

```
SELECT * FROM international WHERE script = 'generic' AND lang = CASE
  WHEN EXISTS(
    SELECT 1
    FROM   international
    WHERE  script = 'generic'
       AND lang   = 'nl_NL'
    LIMIT  1
  ) THEN 'nl_NL'
  ELSE 'en'
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:51:02.227

这是获取指定结果集的一种方式的示例：

```
SELECT i.*
  FROM international i
 WHERE i.lang = 'nl_NL'
    OR (i.lang = 'en' 
        AND NOT EXISTS 
        (SELECT 1 FROM international d WHERE d.lang = 'nl_NL')
       ) 
```

当您希望应用“ `script='generic'`”谓词时，您的问题尚不清楚。

```
SELECT i.*
  FROM international i
 WHERE ( i.script = 'generic' AND i.lang = 'nl_NL')
    OR ( i.script = 'generic' AND i.lang = 'en'
         AND NOT EXISTS 
           ( SELECT 1
               FROM international d
              WHERE d.lang = 'nl_NL'
                AND d.script='generic'
           )
       ) 
```

# javascript - JS 检查有效的日期格式

> ID：14693298
> 
> 赞同：6
> 
> 时间：2013-02-04T18:41:00.623
> 
> 标签：javascript, validation, datetime

我有一个文本字段，用户在其中输入格式的日期时间：`dd/mm/YYYY hh:ii`. 我想检查这是否是使用 javascript 的有效日期时间。这应该包括 2 月 29 日和一切。我怎样才能做到这一点？由于特殊月份，正则表达式不会成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:15:42.360

有关检查时间的有用文章，请参见[http://internotredici.com/article/checkdateinjavascript/](http://internotredici.com/article/checkdateinjavascript/) - 正是您想要的！

以下为文章全文

检查日期在 2006 年 1 月 31 日发表在 Scripting Programmers 下的 javascript 文章中，经常需要验证插入到表单中的信息并检查它们的正确性，这对利用 javascript 很有用。本教程将解释如何使用 javascript 来验证日期是否有效。表单中的日期以两种不同的方式插入，第一种使用文本字段，其中用户按照不同的模式键入数据（在本教程中，我们假设日期为 dd-mm-yyyy 格式）；第二个使用下拉菜单。第一种解决方案执行起来更简单，但用户会犯更多错误（例如插入无效字符或以与计划不同的格式更频繁地键入日期）。

```
<form id="test_form" action="get" method="/checkdatejavascript" 
onsubmit="return(check_form(this)); return false;">
<input type="text" name="datefield" id="datefield" />
</form> 
```

为了检查插入数据的正确性，我们将使用 check_form 函数：

```
function check_form()
{
// Regular expression used to check if date is in correct format
var pattern = new RegExp([0-3][0-9]-(0|1)[0-9]-(19|20)[0-9]{2});
if(document.getElementById('datefield').value.match(pattern))
{
  var date_array = document.getElementById('datefield')
                   .value.split('-');
  var day = date_array[0];

  // Attention! Javascript consider months in the range 0 - 11
  var month = date_array[1] - 1;
  var year = date_array[2];

  // This instruction will create a date object
  source_date = new Date(year,month,day);

  if(year != source_date.getFullYear())
  {
     alert('Year is not valid!');
     return false;
  }

  if(month != source_date.getMonth())
  {
     alert('Month is not valid!');
     return false;
  }

  if(day != source_date.getDate())
  {
     alert('Day is not valid!');
     return false;
  }
}
else
{
  alert('Date format is not valid!');
  return false;
}

return true; 
```

正如我们所看到的，以蓝色显示的正则表达式用于控制插入日期是否遵循默认分配格式。如果模式有效，则函数继续下一步，否则会引发错误消息，并且不发送表单（正则表达式保证日期不能为空）。为了验证日期，我们将使用 javascript 提供的 Date 对象。（检查以红色显示的代码）。该算法非常简单。使用用户插入的信息，我们将创建一个 Date 对象，并使用 getFullYear、getMonth 和 getDate 方法，我们将生成三个值，分别代表与之关联的年、月和日。如果这些值等于用户插入的值，则日期正确。现在考虑以下示例：

用户在文本字段中插入字符串 09-01-1976 从字符串创建的日期对象为 09-01-1976 日期有效

用户在文本字段中插入字符串 31-02-2006 从字符串创建的日期对象是 03-03-2006 日期无效

程序员必须特别注意 javascript 处理日期的方式（检查以绿色显示的代码），因为假设 o 是 1 月，11 是 12 月，月份被认为在 0 到 11 的范围内。在使用下拉菜单插入日期的情况下，由于不需要正则表达式来验证日期格式，因此控件更加简单：

```
 <form id="test_form" action="get" method="/checkdatejavascript" 
   onsubmit="return(check_form(this)); return false;">
  <select name="dateday" id="dateday">
  <option value="1">1</option>
     […]
  </select>
  <select name="datemonth" id="datemonth">
  <option value="0">January</option>
     […]
   </select>
   <select name="dateyear" id="dateyear">
  <option value="2006">2006</option>
     […]
  </select>
  </form> 
```

控制日期正确性的 javascript 函数是

```
 function check_form()
{
 var day = document.getElementById('dateday').value;
 var month = document.getElementById('datemonth').value;
 var year = document.getElementById('dateyear').value;

 // This instruction will create a date object
 source_date = new Date(year,month,day);

 if(year != source_date.getFullYear())
{
   alert('Year is not valid!');
   return false;
}

if(month != source_date.getMonth())
{
  alert('Month is not valid!');
  return false;
}

if(day != source_date.getDate())
{
  alert('Day is not valid!');
  return false;
}

 return true;
} 
```

更新：我已经更新了代码，因为正则表达式存在问题。感谢亚历克斯的建议

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-28T04:15:40.743

如果使用 moment.js 没问题，您可以查看[http://momentjs.com/docs/#/parsing/string-format/](http://momentjs.com/docs/#/parsing/string-format/)了解日期时间解析实用程序。例如：

```
moment("29/02/2014 11:45", "DD/MM/YYYY hh:mm", true).isValid() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-28T03:44:42.213

如果您不想使用其他外部库，可以使用以下函数：

```
var validateDate = function(dateTime){
  var f_date = dateTime.split(" ")[0].split("/").reverse().join("/");
  var time = dateTime.split(" ")[1];

  var date = dateTime.split(" ")[0].split("/").map(function(c, i, a){
        return parseInt(c);
    });
  var daysInMonth = [31,28,31,30,31,30,31,31,30,31,30,31];
  if ( (!(date[2] % 4) && date[2] % 100) || !(date[2] % 400)) {
    console.log("inside");
    daysInMonth[1] = 29;
  }

  if(date[0] > 0 && (date[0] <= daysInMonth[(date[1]-1)]) && date[1] > 0 && date[1] <= 12){
    return new Date(f_date + " " + time) != "Invalid Date";
  }
  return false;
} 
```

这也将处理闰年的变化。此功能仅在输入格式为 时才有效`dd/mm/YYYY hh:ii`。您可以尝试一些示例输入，如下所示：

```
validateDate("29/2/2000 12:30"); // Should return true
validateDate("29/2/2001 12:30"); // Should return false
validateDate("32/8/2000 12:30"); // Should return false
validateDate("30/11/2000 12:30"); // Should return true
validateDate("31/4/2000 12:30"); // Should return false
validateDate("15/7/2000 12:77"); // Should return false 
```

# android - Cocos2d-x CCScrollview 上下滚动

> ID：14693302
> 
> 赞同：4
> 
> 时间：2013-02-04T18:41:05.713
> 
> 标签：android, c++, iphone, eclipse, cocos2d-x

问候 Stackoverflow，

我目前正在尝试在我正在开发的 cocos2d-x 游戏中实现滚动菜单。问题是这些项目正在向我想要的相反方向滚动。例如，如果我将手指从屏幕底部拖动​​到顶部，精灵将弹回其原始位置。

如果我将手指从顶部拖到底部，精灵将跟随我的手指（直到它到达边界）。

这是我的代码：

```
 /////////////////////
    //SCROLL VIEW + LAYER
    CCLayer *layer = CCLayer::create();
    layer->setContentSize( CCSizeMake( winSize.width, winSize.height ) );
    layer->addChild( menu );

    scrollView = CCScrollView::create();
    scrollView->retain();
    scrollView->setContentSize( CCSizeMake ( layer->getContentSize().width,  layer->getContentSize().height ) );
    scrollView->setDirection( CCScrollViewDirectionVertical );
    scrollView->setPosition( ccp( 0,0 ) );
    scrollView->setContainer( layer );

    this->addChild(scrollView);

    scrollView->setContentOffset( CCPointZero ); 
```

非常感谢任何建议或帮助。如果您有任何其他方法可以使用另一种方法创建滚动菜单，我很想听听。

谢谢！

最好的问候安德烈亚斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T14:04:17.403

参考：[cocos2dx/extensions/GUI/CCScrollView/CCScrollView.cpp](https://github.com/cocos2d/cocos2d-x/blob/master/extensions/GUI/CCScrollView/CCScrollView.cpp#L354)

具体[`CCScrollView::minContainerOffset`](https://github.com/cocos2d/cocos2d-x/blob/master/extensions/GUI/CCScrollView/CCScrollView.cpp#L359)和[`CCScrollView::maxContainerOffset`](https://github.com/cocos2d/cocos2d-x/blob/master/extensions/GUI/CCScrollView/CCScrollView.cpp#L354)

`CCScrollView`在*OpenGL 坐标*（相对于*窗口坐标*）中工作 - 值相对于（左、下），正 Y 轴向上。另外，请记住滚动视图的定位和*容器*被锚定（`CCNode::setAnchorPoint`）到（左，下）。

当您向下滚动（向上移动/拉动内容以查看剪切/剪辑下方的内容）时，您会看到屏幕底部边缘下方的内容，但在您松开触摸/拖动时它会弹回，因为`maxContainerOffset`返回`(0, 0)`并且您'刚刚尝试移动到积极的内容偏移量。

![CCScrollView 与容器的坐标](../Images/893b9f0dcbbf5c95c5408b13a4657ead.png)

该图显示了*滚动视图*和*容器*在创建/初始化时的状态。这是设置和定位*子元素*和*容器*时要“考虑”的状态或坐标。灰色矩形（左，下）显示滚动*容器*的有效区域。想象容器的锚点在其中移动。

要查看容器开始滚动到顶部（在*窗口坐标*中工作时您所期望的），请相应地设置内容偏移量（在设置后立即）。这将给出预期的结果/行为。

```
scrollView->setContentOffset(ccp(0.f, (scrollViewHeight-scrollContainerHeight)), false); 
```

下面编辑的代码中有一个更完整的示例。

1.  ~~允许在窗口坐标中滚动（正 Y 轴向下）的“修复”可能是调整扩展，这将需要您重建 cocos2dx 库并影响所有项目（甚至您可以尝试的其他示例代码）。~~

    ```
    /*
    // (StackOverflow Post Edit: This hack is not required.)
    CCPoint CCScrollView::maxContainerOffset()
    {
        // Default CCPointZero;
        return ccp(0.0f, m_pContainer->getContentSize().height*m_pContainer->getScaleY() - m_tViewSize.height);
    }
    CCPoint CCScrollView::minContainerOffset()
    {
        // Default Y = m_tViewSize.height - m_pContainer->getContentSize().height*m_pContainer->getScaleY();
        return ccp(m_tViewSize.width - m_pContainer->getContentSize().width*m_pContainer->getScaleX(), 
               0.f);
    }
    */ 
    ```

2.  ~~一个**不那么侵入性的** *技巧是将**ScrollView*实例缩放到-1，并将*容器节点的**子*节点也缩放到-1。您还必须考虑逆比例重新定位*子节点。*两个级别的缩放结果是内容（*子节点*）被直接查看（而不是翻转）。*将ScrollView*缩放到 -1 的结果是滚动发生在您预期的方向上。请注意，尽管此“修复”也会在 X 轴上翻转滚动，因此*仅*适用于您希望垂直滚动 ( ) 的情况。*****`CCScrollViewDirectionVertical`*****~~

     ***```
    CCSize winSize = CCDirector::sharedDirector()->getWinSize();
    CCLayer* scrollContainer = CCLayer::create(); // Container for the scroll view
    scrollContainer->setAnchorPoint(CCPointZero); // CCScrollView does this too when it's set as the container.

    // Content for the container
    CCSprite *tallContentA = CCSprite::create("TallContentA.png");
    tallContentA ->setPosition(ccp(winSize.width*0.5f, winSize.height*0.9f));
    CCSprite *tallContentB = CCSprite::create("TallContentB.png");
    tallContentB ->setPosition(ccp(winSize.width*0.5f, winSize.height*0.1f));
    scrollContainer->addChild(tallContentA, 2);
    scrollContainer->addChild(tallContentB, 2);

    float scrollContainerHeight = tallContentA->getContentSize().height + tallContentB->getContentSize().height;
    scrollContainer->setPosition(CCPointZero);
    scrollContainer->setContentSize(CCSizeMake(winSize.width, scrollContainerHeight*1.05f));

    // Set up scroll view
    CCScrollView* scrollView = CCScrollView::create(winSize, scrollContainer);
    scrollView->setPosition(CCPointZero);
    scrollView->setDirection(CCScrollViewDirectionVertical);
    // ScrollView initializes at the (left, bottom). The container also gets positioned relative to that and goes Y-up.
    // Pre-set it to the value CCScrollView::minContainerOffset will return when it's scrolled to the top
    // (note, this is a negative number, indicating the touch moving downwards, i.e. it's pre-scrolled such that the top of the content is visible when we begin)
    scrollView->setContentOffset(ccp(0.f, (winSize.height-scrollContainerHeight*1.05f)), false);
    /*
    // (StackOverflow Post Edit: This hack is not required.)
    // Hack: CCScrollView's maxContainerOffset is (0, 0) and minContainerOffset is (difference between view and content size which is negative)
    // It's designed to be (left, bottom) based and positive scrolling means showing stuff above the top of the screen.
    // Since we're using it in terms of Window coordinates ((left, top) based), we scale the scroll view
    // and it's container's children by -1 and position the children differently
    // (eg. Y position winSize.height*0.1f was changed to winSize.height*0.9f)
    // We can't just set the scroll view's Y scale to -1 because CCNode::getScale asserts that X and Y scale must be the same.
    scrollView->setScale(-1.f);
    tallContentA->setScale(-1.f);
    tallContentB->setScale(-1.f);
    */

    addChild(scrollView); 
    ```*** 

 ***~~还要注意上面提到的两个修复是*互斥的*，*不要**同时*应用。~~

现在也在 cocos2d-x 论坛上[回答。](http://www.cocos2d-x.org/boards/18/topics/17298?r=27221#message-27221)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-10T03:15:48.173

@Zennichimaro，

@PAT 的回答是正确的，本质上是一个简化版本

考虑到这一点，请注意 3 件事很重要：

1.  `CCScrollView::setViewSize()`- 您显然错过了这个，它必须是您的可视空间的宽度和高度（蓝色框，如果您想要全屏，我认为它是您的整个 windowSize）

2.  `CCScrollView::setContentSize()`- 这个和setContentOffset不一样，看来你把这个误认为是setContentOffset了，反正这个应该设置成整个容器的大小（红框，你的可能是`ccp(windowSize.width,2496.0f)`）

3.  `CCScrollView::setContentOffset()`- 如果您想定位它以便最初可见最顶部，则最小值和最大值由答案中的灰色小矩形框指定（灰色框，您的可能是`ccp(0.0f, windowSize.height-2496.0f)`）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-15T17:13:25.703

更简短的答案是：

```
scrollView->setContentOffset(scrollView->minContainerOffset()); 
```

由于锚点在左下角，所以初始偏移量不是零，而是一个负数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-03T17:39:29.123

如果有人想在 mmo 游戏聊天表中制作滚动视图（将消息添加到底部并自动滚动到底部），那么也许有人会发现这很有用：

我的 ChatTableView.h 的部分代码

```
//tableView dataSource is vector of strings
class ChatTableView :public Layer, public TableViewDataSource, public TableViewDelegate
{
public:
    vector<string> n_msglist;
    TableView* pTableView;
    void addMsg(string text);
private:

};

//part of the code of my ChatTableView.cpp
void Init(){
    pTableView = TableView::create(this, VisibleRect::getVisibleRect().size, NULL);
    pTableView->setDirection(ScrollView::Direction::VERTICAL);
    pTableView->setVerticalFillOrder(TableView::VerticalFillOrder::TOP_DOWN);
    pTableView->setDelegate(this);
    pTableView->setBounceable(false);

} 
void ChatTableView::addMsg(string text){

    n_msglist.push_back(text); //adds string to vector
    pTableView->reloadData(); //reloads data with newly updated vector and scroll back to top
    pTableView->setContentOffset(pTableView->maxContainerOffset()); //scrolls to bottom
} 
```***

# java - equals() 给了我空指针异常

> ID：14693306
> 
> 赞同：0
> 
> 时间：2013-02-04T18:41:24.447
> 
> 标签：java, nullpointerexception, package

这是我的平等方法：

```
public boolean equals(Car other)
{
if (other == null)
{
    return false;
}

if (this.genre.equals(other.genre))
{

    if (this.price == other.price && this.height == other.height && this.name == other.name && this.door = other.door)
    {
        return true;
    }
    else
    {
        return false;
    }

}
else
{
    return false;
}

} 
```

出于某种原因，这一行给了我一个空指针异常：this.genre.equals(other.genre)

流派是来自另一个包的变量；

所有变量都在 Car 类中声明。该程序编译良好。

这是 Car 的构造函数：

```
 public Car(double price, float height, String genre, String name, int door)
{
    super(price, height, genre);
            this.name = name;
            this.door = door;

} 
```

为什么我得到一个空指针异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:43:09.193

因为`this.genre`是空的？

```
if (this.genre != null && this.genre.equals(other.genre)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:46:11.433

开始使用在执行字符串比较时正确处理空值的库。

开始使用 apache commons lang。这是[StringUtils JavaDoc 页面](http://commons.apache.org/lang/api/org/apache/commons/lang3/StringUtils.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T18:46:24.797

`null`我怀疑您与 Car Object 中的String相等，`genre`这导致`NullPointerExcaption`.

```
if (this.genre!=null && this.genre.equals(other.genre)){...} 
```

还有一件事 -

```
...
if(...this.door = other.door){
           ^^^^ 
```

应该是`==`。

# android - 在我的 android Manager 中实现文件管理器

> ID：14693308
> 
> 赞同：1
> 
> 时间：2013-02-04T18:41:25.397
> 
> 标签：android, file-manager

我试图为我的 android 手机制作一个 FileManager，我是 Java 的新手......我找到了这个源，我想在我的源代码中实现它，并且我想在按下应用程序中的菜单按钮时控制一切。

```
import java.io.File;

public class FileUtils {

  public static boolean delete(String path) {
    final File deleteTarget = new File(path);
    return delete(deleteTarget);
  }

  public static boolean delete(File targetFile) {
    boolean deleted = true;
    try {
      deleted = targetFile.delete();
      if(!deleted && ! targetFile.isFile()) {
        throw new Exception(String.format("File could not be deleted. Path: %s", targetFile.getAbsolutePath()));
      }
      deleted = true;
    } catch (Exception e) {
      deleted = false;
    }

    return deleted;
  }

  public static boolean createDirectory(File directory) {
    boolean created = true;
    try {
      created = directory.mkdirs();
      if(!created && ! directory.isDirectory()) {
        throw new Exception(String.format("Directory could not be created. Path: %s", directory.getAbsolutePath()));
      }
      created = true;
    } catch (Exception e) {
      created = false;
    }

    return created;
  }
} 
```

# javascript - Uncaught TypeError: Object [object Object] has no method 'replace' 用backbone.js 和coffeescript

> ID：14693312
> 
> 赞同：0
> 
> 时间：2013-02-04T18:41:46.550
> 
> 标签：javascript, jquery, backbone.js, coffeescript

```
Person = Backbone.Model.extend(
  defaults: 
    name: 'Jony James'
    age: 30
    occupation:  'developer'

  validate: (attrs) ->
    if attrs.age < 0
      return 'Age must be positive, stupid.'
    if not attrs.name
      return 'A person must have a name! fool.'

  work: ->
    @get('name') + " is working." 
    )

PersonView = Backbone.View.extend({
    tagName: 'li'

    #template: _.template($('#personTemplate').html())
    template: "#personTemplate"

    initialize: ->
      @render()

    render: ->
      template = _.template($(@template))
      @$el.html(template)

    })

person = new Person
personView = new PersonView( model: person)
$(document.body).append personView.el 
```

在我的`index.html`

```
<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8">
  <title></title>
 </head>
 <body>
  <script id="personTemplate" type="text/template">
   <strong><%= name %></strong> (<%= age %>) - <%= occupation %> 
  </script>
  <script src="js/underscore.js"></script>
  <script src="js/jquery.js"></script>
  <script src="js/backbone.js"></script>
  <script src="js/main.js"></script>
 </body>
</html> 
```

和`template: _.template($('#personTemplate').html())`工作`@$el.html(@template(@model.toJSON()))`正常。

但是使用当前版本的`main.js`我在 google chrome 控制台中收到此错误：

```
Uncaught TypeError: Object [object Object] has no method 'replace' 
```

**错误在哪里？**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:46:33.513

错误在模板函数中。尝试传递 html 而不是 jQuery 对象：

`template = _.template($(@template).html(), @model.toJSON())`

# c# - 删除表并在代码中生成新表

> ID：14693315
> 
> 赞同：0
> 
> 时间：2013-02-04T18:41:53.147
> 
> 标签：c#, asp.net, asp.net-mvc, nuget-package

在一个新创建的 MVC4 Web 项目中，我在服务器资源管理器中删除了一个表（DataConnections .... 使用鼠标右键单击），然后在包管理器控制台（PMC）中运行

`update-database -verbose -force`

在同一个数据库中生成一个同名的新表。但是 PMC 只尝试“ALTER”命令，这不是我想要它做的，它输出一个错误

> 找不到对象“dbo.UserProfile”，因为它不存在或您没有权限。

它现在如何解决这个问题？

**更新**

这是 UserProfile 类的数据模型

```
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public string UserEmail { get; set; }
    [DefaultValue(false)]
    public bool IsActivated { get; set; }        
} 
```

这是在配置文件的 Seed 方法中初始化表的代码

```
 WebSecurity.CreateUserAndAccount("Administrator", "admin",
                new
                {                        
                    UserEmail = "admin@gmail.com",
                    IsActivated=true

                }                   
                ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:48:53.847

EF Migrations 期望您负责（您可以使用 -Script 选项让 Migrations 生成脚本而不是直接运行 DDL），或者由它负责。混合和匹配不起作用。

如果您知道 UserProfile 的结构（也许您保存了一个脚本？），您可以手动重新创建它，就像您更改之前一样，然后允许 EF Migrations 再次应用迁移。

如果您有适当的数据库备份，请还原该备份并重试。

如果没有，您可以删除并重新创建数据库，然后进行[初始迁移](https://stackoverflow.com/q/10097696/141172)。

就我个人而言，我总是让 EF Migrations 编写迁移脚本（-Script 选项）。然后我自己应用脚本。这样，我就拥有了在 QA 和 PROD 环境中进行受控迁移所需的一切。我只是对 EF Migrations 没有足够的信任，无法让它自动迁移生产数据（并不是说 Migrations 不好，但一个小错误可能会清除生产数据。我不愿意承担风险。）

# database - 以非交互方式指定 PostgreSQL 密码

> ID：14693317
> 
> 赞同：0
> 
> 时间：2013-02-04T18:41:58.967
> 
> 标签：database, postgresql, postgresql-8.4

有没有办法在环境变量中设置 PostgreSQL 服务器的私钥密码，或者在使用 pg_ctl 命令启动服务器时将其作为参数传递，而无需非交互方式？

`PGPASSWORD`仅用于指定服务器的密码，但不指定私钥的密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T23:04:16.847

不，我认为您不能（假设您正在谈论服务器私钥上的密码，因此它可以支持 SSL 连接）。

受密码短语保护的密钥的全部意义在于，该短语没有与密钥一起存储在服务器上。否则，您将无法从中获得任何安全感。

# delphi - 具有提升权限的 DllRegisterServer

> ID：14693321
> 
> 赞同：0
> 
> 时间：2013-02-04T18:42:14.347
> 
> 标签：delphi

我的程序当前有这条线

状态：= DllRegisterServer；

在 WIN7 且用户不是管理员的机器上失败。

是否可以通过提升权限以编程方式调用 DllRegisterServer？

或者有什么方法可以提示提升权限，然后使用该信息执行 DllRegisterServer。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:52:17.043

提升只能在流程创建时执行。因此，您需要一个新进程来执行此代码。您的主要选择：

1.  调用 ShellExecute 传递动词 runas 和一个 exe 文件。这将提升新流程。
2.  将 requireAdministrator 清单添加到可执行文件并运行它。
3.  使用进程外 COM 服务器并将其启动提升。

在这些选项中，数字 1 对您来说可能更简单。对于选项 1，您不需要单独的可执行文件。您可以传递命令行参数，这将导致对注册函数的调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:50:58.733

没有办法以编程方式提升程序的权限，只有用户才能这样做。您可以指示操作系统您的程序需要提升的权限，例如，通过包含清单

[如何将清单 <requestedPrivileges> 信息添加到 delphi 项目中](https://stackoverflow.com/questions/6226976/how-to-add-manifest-requestedprivileges-info-into-delphi-project)

您还可以决定允许您的程序在没有提升权限的情况下运行（通过不包括清单），然后禁用所有需要提升权限的操作，或者在非提升的进程（非常类似于任务管理器使用“显示所有用户的进程”按钮：

[Delphi：如何以提升的状态启动应用程序并等待它终止？](https://stackoverflow.com/questions/1717465/delphi-how-to-start-application-with-elevated-status-and-wait-for-it-to-termina)

# javascript - 将文本框从一帧复制到另一帧

> ID：14693328
> 
> 赞同：0
> 
> 时间：2013-02-04T18:42:58.107
> 
> 标签：javascript

我确信这很简单，但是我一直在寻找的所有内容都希望将其放入同一页面，而不是跨框架。

我试图通过能够在本地页面上键入所有内容，按下按钮（javascript）并填充 iframe 中的其他页面，从而使数据输入更容易。我无权访问服务器端编码，因为这将在桌面上运行。

```
<INPUT TYPE="text" NAME="name1" id="id1" VALUE="" MAXLENGTH="3" SIZE="3"> 
```

有没有办法在 iframe 1 中创建一个文本框，并允许按下按钮时 javascript 在 iframe2 中自动填充该字段？

谢谢大家。

编辑：只有像javascript这样的客户端编程才能工作。这基本上就像获取本地网页（在桌面上）上的信息，该网页也通过主页（www.domain.com）打开，并将信息传递过来。

因此，如果我在我的 .htm 文件中输入 John Smith，它会将其带到另一个带有 John Smith 的文本框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:19:06.290

目前尚不清楚您所面临的环境（是否具有相同的域）。我建议您可以使用 ajax 来发送和接收文本数据。以下是实施的步骤。

1.  创建两个服务器接口；例如，一个是“puttext”，另一个是“gettext”。
2.  您可以使用会话或哈希来识别用户。
3.  一旦用户单击发送按钮，它就会通过 Ajax 调用使用文本数据调用 puttext。
4.  接收者页面有一个计时器来检查是否有任何东西来。
5.  当“gettext”的结果不为空时，将其复制到文本框中。

但是，如果两个页面在同一个域中，通过调用父脚本会容易得多。

# jakarta-ee - 当值已经存在时，JPA 触发器替换插入的 ID

> ID：14693333
> 
> 赞同：0
> 
> 时间：2013-02-04T18:43:28.810
> 
> 标签：jakarta-ee, jpa, triggers

我有一个网络服务，每天从各种来源获取大约 9GB 的原始文本数据。其中绝大多数是相对较短（100-300）的字符串，这些字符串经常重复。我可能只有几千个独特的字符串

我通常不想预先优化，但我们的存储问题很快就会成为开发中的一个问题。

我有一个 JPA 实体，为了这篇文章，我会进行简化。这是映射到父表的字符串/id 对。

```
@Entity
public class DeduplicatedString implements Serializable {

private static final long serialVersionUID = 1L;

@Id
@GeneratedValue
private int id;

public int getId() {
    return id;
}

public void setId(int id) {
    this.id = id;
}

private String value;
public DeduplicatedString() {
    super();
}
public String getValue() {
    return value;
}
public void setValue(String value) {
    this.value = value;
} 
```

}

我想设置一个 JPA 侦听器（beforeInsert？）以在添加新字符串时检查现有数据，如果已经找到完全匹配，则返回现有记录。

我通常只是设置一个插入触发器，并且不太确定如何在 JPA 中执行此操作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:17:52.273

JPA 不直接支持您需要的功能。有一个`@PrePersist`注释（连同[其他几个](http://en.wikibooks.org/wiki/Java_Persistence/Advanced_Topics#Events)），但这些只能用于例如监控系统，或对实体进行最后一刻的更改。JPA 不知道在数据库中执行的任何触发器，并且目前没有将两者联系起来的机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:07:47.553

你说的指针是什么意思？你的意思是你不想插入记录？

通常，要在您的应用程序中执行此操作，您应该首先使用字符串查询对象，如果找不到，则仅保留一个新对象。

# .net - 使用 Windows Azure SDK 1.8 和 Windows Azure 工具打包云项目时出错 2012 年 10 月

> ID：14693336
> 
> 赞同：1
> 
> 时间：2013-02-04T18:43:39.427
> 
> 标签：.net, visual-studio-2010, azure

在 Visual Studio 2010 中，我已将云解决方案升级到 Windows Azure SDK 1.8 和 2012 年 10 月的 Windows Azure 工具（之前我使用的是 1.7 版和 2012 年 6 月的工具）。该解决方案由多个用于不同目的（调试、测试、部署...）的云项目组成：我首先更新了一个云项目，当我在计算模拟器中完成各种角色的测试后，我更新了剩余的项目。

然后我注意到，当我打包后面的项目时，我收到了错误

`The XPath provided is not valid 'csc:ServiceConfiguration/@osFamily'. Namespace prefix 'csc' is not defined.`

在文件中`C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Windows Azure Tools\1.8\Microsoft.WindowsAzure.targets`

相反，如果我打包第一个更新的项目，一切都很好。

我尝试了以下方法：

*   由于我将其更改`osFamily`为 3（Windows Server 2012），尽管它在某种程度上不兼容，但我将其恢复为 2（Windows Server 2008 R2）——但错误仍然存​​在；
*   我试图将其中一个失败的项目与正在运行的项目进行比较，但我没有发现任何相关的差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:46:09.193

我通过从头开始创建一个新的云项目并从旧项目（和文件中的项目引用部分）手动“导入”配置解决了`csdef`这个`cscfg`问题`ccproj`。从这个新项目中，包操作正确完成。

# class - 与字符类不匹配的 Grep 行

> ID：14693337
> 
> 赞同：-1
> 
> 时间：2013-02-04T18:43:40.733
> 
> 标签：class, grep, posix

我正在尝试编写一个简单的 grep 脚本，它将在文档中搜索不包含空格或制表符的行，但我遇到了困难。我不希望它使用 grep 的选项我只想用类本身来做，但我不确定如何做到这一点。

我最后一次失败的尝试是 grep '[^[:blank:]*]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:51:36.220

你想要 /^[^[:blank:]]*$/

用这个来测试：[http ://rubular.com/](http://rubular.com/)

尝试将“^[^[:blank:]]*$”放在“你的正则表达式：”下

并开始在下面的文本区域中输入。

这是一个例子：[http ://rubular.com/r/WfiXhl3jPV](http://rubular.com/r/WfiXhl3jPV)

# php - 从包含文件中检查会话变量 - PHP

> ID：14693348
> 
> 赞同：0
> 
> 时间：2013-02-04T18:44:24.347
> 
> 标签：php, session-variables

当用户登录到我的系统时，我有一个会话变量`$_SESSION['logged_in'] = 1;`，然后在每个页面上我检查变量以查看用户是否已登录，这可以正常工作：

```
session_start();
if (!$_SESSION['logged_in']) {
   header("location: https://mydomain.com/cpanel/login.php");
   exit();
} 
```

但是现在，为了便于维护，我想将此会话检查器添加到包含文件中，并将其包含在每个安全页面的顶部。但是，每次我登录它都会失败。

这是包含文件中的内容：

```
// start session
session_start();

// check login session
if (!$_SESSION['logged_in']) {
   header("location: https://mydomain.com/cpanel/login.php");
   exit();
} 
```

这就是我添加到每页标题的内容：

```
// load authentication file
include "../includes/authentication/check.php"; 
```

但它似乎`$_SESSION`是空的，即使我确实已经登录了。我尝试`session_start();`从包含文件中删除它，因为我认为这可能会以某种方式重新设置它 - 但事实并非如此。

你们中有人知道这里出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:56:21.473

使用**include_once**因为每次都包含 include **session_start** **();** 成为运行我认为问题是这个

# android - 找不到适合片段的 onCreate() 等效项

> ID：14693353
> 
> 赞同：1
> 
> 时间：2013-02-04T18:44:46.680
> 
> 标签：android, android-fragments

我已经读过这个：http: [//developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

我正在将一些活动代码移动到一个全新的片段，但发现之前在 onCreate() 中的代码存在问题。

*   使用片段的目的：标签。

*   每个选项卡开关上调用的代码：

    `FragmentManager fm = getSupportFragmentManager();`

    `FragmentTransaction ft = fm.beginTransaction();`

    `ft.replace(R.id.tabContent, fragment1);`

    `ft.commit();`

其中fragment1、fragment2等是activity的实例变量，在`onCreate`：

```
fragment1 = new Fragment1();
//etc. 
```

*   我希望它们如何工作：就像活动（！）一样，意味着：创建后 - 我在其中调用我的 web 服务，并且列表第一次被初始化，*没有更多的初始化*，所以当我切换选项卡时，列表仍然是如何我离开了它（滚动等），当我回来时没有视图初始化或 web 服务调用，它只是再次出现。就像在活动中一样，如果我启动另一个活动，然后回来 -`onCreate()`将不会被调用，只有`onResume()`. 而且由于我只在 中进行初始化`onCreate()`，所以很好。

我正在调用 onCreate() 一个网络服务来获取数据以填充列表。根据片段的生命周期，有几个候选者可以放置这段代码，但没有一个是完全有效的：

1.  onCreate()：在 onCreateView() 之前调用。所以视图层次结构还没有初始化，调用 web 服务是不安全的。

2.  onCreateView()：当我切换标签/运行显示的代码片段时，它总是被调用。

3.  onActivityCreated()：我以为*只有*在创建 Activity 之后才会调用它，但它*总是*在 Fragment.onCreateView() 之后调用

作为一个附带问题，您是否建议在片段中调用 Web 服务？在网上没有找到任何关于此的内容，但不知道为什么它不正确。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:07:32.480

使用装载机：

创建 AsyncLoader 的子类并在 Fragment 的 onActivityCreated 实现中启动/初始化这些加载器：

```
public abstract class MyLoader extends AsyncTaskLoader<String> {
public MyLoader(Context context) {
    super(context);
}

private String result;
protected String error;

@Override
public final String loadInBackground() {
    try {
        error = null;
        // Load your data from the server using HTTP and store result as string in 'result'.
        ...
        result = ...
        ...
        return result;
    }
    catch (Exception e) {
        Logger.e("ResourceLoader", "Loading resource failed.", e);
        error = e.getMessage();
    }
    return null;
}

@Override
protected void onStartLoading() {
    if (!TextUtils.isEmpty(error)) {
        deliverResult(result);
    }

    if (takeContentChanged()) {
        forceLoad();
    }
}

@Override
public void deliverResult(String data) {
    if (isReset()) {
        return;
    }

    result = data;

    if (isStarted()) {
        try {
            super.deliverResult(data);
        }
        catch(Exception e) { 
            Log.e("ResourceLoader", "Caught exception while delivering result.", e);
        }
    }
}

public String getError() {
    return error;
}
} 
```

在你的片段中，你可以初始化这个加载器：

```
public class Fragment1 extends Fragment implements LoaderCallbacks<String> {
....
....
String message;
TextView textView;

    @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setRetainInstance(true);
        ....
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View view = ....
    ...
    textView = (TextView)view.findViewById(R.id.....);
    textView.setMessage(message); // in case this Fragment1 survived an orientation change.
}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    getLoaderManager().initLoader(0, getArguments(), this); // Start loading data after activity has been created.
}

@Override
public Loader<String> onCreateLoader(int id, Bundle args) {
    return new MyLoader(getActivity()); // Load data using MyLoader
}

@Override
public void onLoadFinished(Loader<String> loader, String result) {
    // Here you have the result in 'result'.
    message = result;
    if (textView != null) {
        // Update UI according to result.
        textView.setText(message);
        ....
    }
    ...
}
....
} 
```

在 onLoadFinished 中，您将结果存储在“消息”中。如果一个简单的 String 结果不够用，您可以更改 MyLoader 和 LoaderCallbacks 以返回和处理更复杂的数据结构（例如 List<String>）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:55:44.553

对我来说，`onActivityCreated`似乎或多或少是匹配阶段（此时已经可以调用`findViewById`父活动并设置组件/在片段实例中分配字段/设置（而不是添加）侦听器。我`onActivityCreated`的运行它超过一次不会造成任何伤害，并且`Bundle`会考虑传递的参数。

说到网络服务，你可能可以从任何地方调用，但你不能从 GUI 线程调用（Android 不允许）——所以创建你自己的 therad。当对 Web 服务的某些调用处于挂起状态时，您可能不需要支持片段和活动之间的完全切换；如果您确实需要，请使用`savedInstanceState`捆绑包保存并在请求时恢复状态。

# multithreading - 在线程内的 Jmeter 中每分钟执行一个采样器

> ID：14693364
> 
> 赞同：1
> 
> 时间：2013-02-04T18:45:28.107
> 
> 标签：multithreading, jmeter

我有一个线程在里面调用不同的 http 采样器。由于它是按顺序调用的，因此每个样本都必须一个接一个地执行。

我已经搜索了一种在该线程内每分钟同时执行一个样本的方法，但没有成功。

我知道我可以启动另一个线程，但它不会这样做，因为每分钟传递的一些信息必须由它所在的线程提供。

我一定遗漏了一些明显的东西，但我没有在 Jmeter 网站上找到任何与此相关的信息。

# drupal - Drupal 7 在文章或博客上方添加作者简介

> ID：14693374
> 
> 赞同：0
> 
> 时间：2013-02-04T18:45:57.457
> 
> 标签：drupal

我正在尝试为博客作者和专栏作家在他们的博客或专栏顶部添加署名样式配置文件，就像在 rabble.ca 上一样。现在我尝试使用“作者窗格”，但它不允许我配置我想要的字段，即我不需要加入日期，或者现在在线，甚至最后一次看到。只是一个简单的“你是谁”。我想盒子和阴影会用一种风格来完成......任何帮助将不胜感激。提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T11:55:01.347

1.  Add the required fields to the user;
2.  Create the variables in your template.php file's preprocess function (check the node type).
3.  Modify the blog node template (copy node.tpl) and add the variables created in step 2\.
4.  Style up the page as you like

These are the steps. If you are not sure how to do all this, I can go into more details.

# objective-c - 从 NSMutableArray 获取数据

> ID：14693375
> 
> 赞同：-1
> 
> 时间：2013-02-04T18:46:06.790
> 
> 标签：objective-c, cocoa-touch

我正在填充`NSMutableArray`一些数据，如下面的代码所示

```
NSMutableArray *dates = [[NSMutableArray alloc] init];
Delivery *dm = [[Delivery alloc] init];
dm.str_Day = @"Monday";
dm.str_Date = @"05/02/2013";
dm.str_MNumber = @"MN255";
[dates addObject:dm];

Deliveryt *dm1 = [[Delivery alloc] init];
dm1.str_Day = @"Monday";
dm1.str_Date = @"05/02/2013";
dm1.str_MNumber = @"MN255";
[dates addObject:dm1]; 
```

我想在 tableview 中显示上述数据，`cellForRowAtIndexPath`那么如何从中提取数据`NSMutableArray`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:50:31.573

您正在尝试做的事情有两个主要部分：

1.  使您的`dates`数组在类中可见`cellForRowAtIndexPath`：它可以是该类的属性，例如，或者它可以属于模型类；局部变量不行；

2.  假设您决定将其实现`dates`为控制器/数据源的属性，您可以执行以下操作来检索各个交付元素：

    ```
    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath
    {
        ....
        Deliveryt* delivery = (id)[self.dates objectAtIndex:indexPath.row];
        .... 
    ```

# jquery - 知道一个元素的 id，如何找到位于同一张表中的另一个元素？

> ID：14693377
> 
> 赞同：0
> 
> 时间：2013-02-04T18:46:09.880
> 
> 标签：jquery

之前我问了[以下](https://stackoverflow.com/questions/14689138/jquery-select-an-html-table-that-contain-a-given-element)关于如何使用 JQuery 添加 HTML 表格行的问题，知道表格单元格内元素的 id。

因此，添加新行后，表格现在如下所示：

```
<table id = "mytable">
  <tr>
     <th>Hiring Manager</th>
     <td><textarea id = "textComments" cols = "15"/></td>
  </tr>
  <tr>
     <td></td>
     <td>
        <span class = "CharCounter">
           <span id="lblCharCounter">Label</span>
           characters (500 max)
        </span>
     </td>
 </tr> 
```

我想知道，知道第一个元素的 id（即**textComment**），我如何选择位于下一行的第二个元素（即**lblCharCounter**）？

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:53:01.783

我可能会选择：

```
$('#textComment').closest('table').find('.CharCounter') 
```

或（得到那个特定的子`span`）

```
$('#textComment').closest('table').find('.CharCounter').children() 
```

或类似的东西——如果你为你想要定位的元素分配一个唯一的类，除了 ID 之外，这是最简单的。

[http://api.jquery.com/closest](http://api.jquery.com/closest)

[http://api.jquery.com/find](http://api.jquery.com/find)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:51:07.747

```
var $area1 = $("#textComments"); 
```

然后使用：

```
$area1.parent().parent().next().find('#lblCharCounter") 
```

# jquery - jQuery Isotope：像 Beyonce 的网站这样的流体设置仅在调整窗口大小后才有效

> ID：14693381
> 
> 赞同：1
> 
> 时间：2013-02-04T18:46:18.557
> 
> 标签：jquery, jquery-isotope

尝试[像 Beyonce 的网站一样](http://metafizzy.co/blog/beyonce-seamless-fluid-image-masonry/)，但使用 Isotope 而不是 Masonry。

知道为什么默认情况下这不起作用，但只有在调整窗口大小之后？

[http://jsfiddle.net/RJZu6/](http://jsfiddle.net/RJZu6/)

```
var $container = $("ul");

$container.imagesLoaded(function() {
  $container.isotope({
    itemSelector: "li",
    animationEngine: "jquery",
    sortBy: "random",

    // http://isotope.metafizzy.co/demos/fluid-responsive.html

    resizable: false,
    masonry: { columnWidth: $container.width() / 3 }
  });
});

$(window).smartresize(function() {
  $container.isotope({
    masonry: { columnWidth: $container.width() / 3 }
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T22:07:28.333

[http://jsfiddle.net/RJZu6/1/](http://jsfiddle.net/RJZu6/1/)

```
var $container = $("ul");

var size = function () {
    console.log('wee!');
    $container.isotope({
        masonry: {
            columnWidth: $container.width() / 3
        }
    });
}

$container.imagesLoaded(function () {
    $container.isotope({
        itemSelector: "li",
        animationEngine: "jquery",
        sortBy: "random",
        resizable: false,
        masonry: {
            columnWidth: $container.width() / 3
        }
    });

    size();
});

$(window).smartresize(size);
// $(size); // this is an issue, because the images haven't yet loaded! 
```

# linux - 电子邮件中的所有行一起运行

> ID：14693382
> 
> 赞同：1
> 
> 时间：2013-02-04T18:46:20.757
> 
> 标签：linux, bash, email, echo

这应该相对简单，但我以前从未遇到过，现在我摸不着头脑。

简单的脚本：

```
echo `tail /var/log/qmailcheck.log` >> $EMAIL
cat $EMAIL | mail -s "Daily server report from server.ca" email@here.com 
```

（我知道我在`tail`cmd 周围缺少一组刻度，只是想让事情看起来正确）

问题是，虽然我要拖尾的日志文件为每个条目都有一个新行，但发送的电子邮件将所有内容都放在一行上，而不是这样：

`Mon Feb 4 11:05:01 MST 2013-- Check Completed Successfully
Mon Feb 4 11:10:01 MST 2013-- Check Completed Successfully
Mon Feb 4 11:15:01 MST 2013-- Check Completed Successfully
Mon Feb 4 11:20:01 MST 2013-- Check Completed Successfully
Mon Feb 4 11:25:01 MST 2013-- Check Completed Successfully`

我明白了：
`Mon Feb 4 11:05:01 MST 2013-- Check Completed Successfully Mon Feb 4 11:10:01 MST 2013-- Check Completed Successfully Mon Feb 4 11:15:01 MST 2013-- Check Completed Successfully Mon Feb 4 11:20:01 MST 2013-- Check Completed Successfully Mon Feb 4 11:25:01 MST 2013-- Check Completed Successfully`

该脚本还从许多其他命令中回显，它们似乎也遇到了一行，我以前做过，但从来没有遇到过问题，我错过了什么？

这是整个脚本：

```
ERROR=/tmp/errorlog
RECIP=$(cat /root/bin/emailrec)

echo Hi, this email to inform you of any potential issues with the server.bla qmail mail server > /tmp/demail

grep pls /var/log/qmailcheck.log > /tmp/errorlog

if [ ! -s $ERROR ] ; then
    echo There are no errors in the qmailcheck log file >> /tmp/demail
    echo Here are the last 10 lines of the current qmailcheck log file: >> /tmp/demail
    tail /var/log/qmailcheck.log >> /tmp/demail
else
    echo The log file for the qmail check script contains the following errors: >> /tmp/demail
    cat $ERROR >> /tmp/demail
    echo You should have also received an email which will better explain the error >> /tmp/demail
    echo Check the time of the error above to determine when the email was sent >> /tmp/demail
fi
MAIL=$(/var/qmail/bin/qmail-qstat | grep "queue:" | awk '{ print $4 }')
echo There are $MAIL messages in the mail queue >> /tmp/demail

echo File system usage is currently at `df -h |grep vzfs | awk '{ print $5}'` >> /tmp/demail

cat /tmp/demail | mail -s "Daily server report from server.bla" $RECIP 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:52:55.617

当您不需要其中任何一个时，这就是使用 echo*和命令替换所得到的。*

之间的唯一区别

```
echo `command args...` 
```

和

```
command args 
```

是换行符被折叠（并且代码更难阅读）。只需使用

```
tail /var/log/qmailcheck.log | mail -s .... 
```

（如果你想使用一个中间文件，那么你也可以使用它而不用`echo`反引号）。

请注意，命令替换还有另一种样式：`$(command...)`，它消除了嵌套引用的问题，并且通常更具可读性。每当您需要命令替换时，都可以使用这种样式而不是反引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:26:37.067

改变：

```
echo `tail /var/log/qmailcheck.log` >> $EMAIL 
```

至：

```
echo "`tail /var/log/qmailcheck.log`" >> $EMAIL 
```

用双引号包裹命令替换可防止字符串拆分，这是将换行符转换为空格的地方。

但是，我建议使用 Anton Kovalenko 的解决方案。这里根本不需要使用`echo`，直接将命令重定向到文件即可。

# php - 无法将超链接添加到重复表

> ID：14693385
> 
> 赞同：-3
> 
> 时间：2013-02-04T18:46:28.487
> 
> 标签：php

我有表名为`ipcam (camera id,camera name,camera model,IP address, Url, Port)`. 我能够成功地从 MySQL 数据库中检索数据。现在我打算做的是在表的末尾添加一个额外的字段`Delete`- 这是超链接并通过将 id 发送到页面来删除该行`deletecam.php`是代码：

```
<?php                               
$result = mysql_query("SELECT * from ipcam WHERE user_id = {$user_id}");
echo"<table border=5 colspan=6> <tr><th>IP CAMERA ID &nbsp;&nbsp;</th><th>IP CAMERA NAME &nbsp;&nbsp;</th><th>CAMERA MODEL&nbsp;&nbsp;</th> <th>IP ADDRESS&nbsp;&nbsp;</th> <th>URL&nbsp;&nbsp;</th> <th>PORT&nbsp;&nbsp;</th><th>DELETE&nbsp;&nbsp;</th></tr>";
while($row = mysql_fetch_array($result)){
    echo "<tr>
    <td>" . $row['id'] . "</td>
    <td>" . $row['name'] . "</td>
    <td>" . $row['model'] . "</td>
    <td>" . $row['ipaddress'] . "</td>
    <td>" . $row['url'] . "</td>
    <td>" . $row['port'] . "</td>      
    <td> echo"<html><h3>"; <a href="/deletecam.php?id= <?php echo urlencode($row['id']); ?> "> Delete </a>  echo"</h3></html>"; </td></tr>"; 

}
echo "</table>";
?> 
```

但是，当我运行此代码时遇到奇怪的问题，错误是：

```
Parse error: syntax error, unexpected '>' in C:\xampp\htdocs\IPCAM\cameralist.php on line 176 
```

当我尝试在代码中包含超链接时，删除错误。我是在语法上做错了什么，还是不可能做这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:52:35.810

试试这个，你不应该得到错误。你没有结束回声字符串。

```
 <?php 

    $result = mysql_query("SELECT * from ipcam WHERE user_id = {$user_id}");

    echo"<table border=5 colspan=6> <tr><th>IP CAMERA ID &nbsp;&nbsp;</th><th>IP CAMERA NAME &nbsp;&nbsp;</th><th>CAMERA MODEL&nbsp;&nbsp;</th> <th>IP ADDRESS&nbsp;&nbsp;</th> <th>URL&nbsp;&nbsp;</th> <th>PORT&nbsp;&nbsp;</th><th>DELETE&nbsp;&nbsp;</th></tr>";

    while($row = mysql_fetch_array($result))
    {

    echo "<tr>
    <td>" . $row['id'] . "</td>
    <td>" . $row['name'] . "</td>
    <td>" . $row['model'] . "</td>
    <td>" . $row['ipaddress'] . "</td>
    <td>" . $row['url'] . "</td>
    <td>" . $row['port'] . "</td>"  ; // i missed a " here
    ?>
    <td> <h3><a href="/deletecam.php?id= <?php echo urlencode($row['id']); ?> "> Delete </a>  </h3></td></tr> 

    <?php
            }

    echo "</table>";
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:20:08.023

将其更改为：

```
while ($row = mysql_fetch_array($result)) {
    echo "<tr>
    <td>" . $row['id'] . "</td>
    <td>" . $row['name'] . "</td>
    <td>" . $row['model'] . "</td>
    <td>" . $row['ipaddress'] . "</td>
    <td>" . $row['url'] . "</td>
    <td>" . $row['port'] . "</td>      
    <td> <h3> <a href='/deletecam.php?id=" . urlencode($row['id']) . "'> Delete </a> </h3> </td></tr>"; 
} 
```

你不应该`<html>`在桌子里面。而且您不能`<?php`在回显字符串中使用。

# c# - 使用带有事件处理程序的静态方法

> ID：14693387
> 
> 赞同：3
> 
> 时间：2013-02-04T18:46:34.983
> 
> 标签：c#, asynchronous

我继承了一个具有一堆静态方法的 C# (.NET 2.0) 应用程序。我需要将其中一种方法转换为基于事件的异步方法。当方法完成后，我想触发一个事件处理程序。我的问题是，我可以从静态方法中触发事件处理程序吗？如果是这样，怎么做？

当我谷歌时，我只找到 IAsyncResult 示例。但是，我希望能够执行以下操作：

```
EventHandler myEvent_Completed;
public void DoStuffAsync()
{
  // Asynchrously do stuff that may take a while
  if (myEvent_Completed != null)
    myEvent_Completed(this, EventArgs.Empty);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T18:48:43.097

过程完全相同，唯一的区别是没有真正的`this`参考。

```
static EventHandler myEvent_Completed;

public void DoStuffAsync()
{
    FireEvent();
} 

private static void FireEvent()
{
    EventHandler handler = myEvent_Completed;

    if (handler != null)
        handler(null, EventArgs.Empty);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T18:50:29.710

如果`DoStuffAsync`是静态的（它不在您的代码中），则事件`myEvent_Completed`也需要设为静态：

```
static EventHandler myEvent_Completed; // Event handler for all instances

public static void DoStuffAsync()
{
  // Asynchrously do stuff that may take a while
  if (myEvent_Completed != null)
    myEvent_Completed(null, EventArgs.Empty);
} 
```

否则，`DoStuffAsync`将需要获取您的类的实例来触发事件：

```
EventHandler myEvent_Completed; // Note: Can still be private

public static void DoStuffAsync(YourClass instance)
{
   // Asynchrously do stuff that may take a while
   if(instance.myEvent_Completed != null)
      instance.myEvent_Completed(instance, EventArgs.Empty);
} 
```

如果您需要类的不同实例来为该事件提供不同的事件处理程序，您会希望使用后一种路由并传入一个实例。

除此之外，从静态方法触发事件绝对没有错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T18:49:38.603

如果在`event`您正在操作的类型中声明了，您可以传入一个实例（或者如果它是一个单例，则恢复它）并`event`从那里访问该对象。因此，例如：

```
EventHandler myEvent_Completed;
public void DoStuffAsync(MyClass o)
{
    // Asynchrously do stuff that may take a while
    if (o.myEvent_Completed != null)
        o.myEvent_Completed(this, EventArgs.Empty);
} 
```

如果它是一个单例，那么您可以执行以下操作：

```
EventHandler myEvent_Completed;
public void DoStuffAsync(MyClass o)
{
    // Asynchrously do stuff that may take a while
    if (Instance.myEvent_Completed != null)
        Instance.myEvent_Completed(this, EventArgs.Empty);
} 
```

单例访问器在哪里`Instance`。

# c++ - 键绑定？(c)（将字符串转换为函数）

> ID：14693397
> 
> 赞同：1
> 
> 时间：2013-02-04T18:47:20.703
> 
> 标签：c++, windows, string, casting, keyboard

我正在为我的应用程序编写一个简单的键绑定。到目前为止，我有 2 个数组（布尔 m_keys[256]，字符串 m_functions）。

这是我的输入类（在 input.h 中）

```
class InputClass
{
public:

InputClass(){};
InputClass(const InputClass&){};
~InputClass(){};

void Initialize(){
    for(int i=0; i<256; i++)
    {
            m_keys[i] = false;
    functions[i] = "";
    }
}

bool AddFunc(unsigned int key, string func, bool overide)
{
      if((functions[key] == "") || (overide)){
      //overide is used to overide the current string (if there is one)
          functions[key] = func; 
          return true;
      } 
      return false;
    };

void KeyDown(unsigned int input){m_keys[input] = true;};

void KeyUp(unsigned int input){m_keys[input] = false;};

string IsKeyDown(unsigned int key){return m_keys[key] ? functions[key] : "";};

private:
    bool m_keys[256];
    string functions[256];
}; 
```

在我的 WinARM.cpp 中：

在我的初始化函数中

```
 INIT(m_Input, InputClass) //#define INIT(o,c) if(!(o = new c))return false;
    m_Input->Initialize();
    m_Input->AddFunc(VK_RETURN,"m_Graphics->ToggleWireFrame",true); 
```

在我的帧函数中（运行每一帧；）

```
short SystemClass::Frame()
{
string func;
func = m_Input->IsKeyDown(VK_RETURN); //checks to see if the enter key is down
if(func !="") (func as function)(); // <-- this is the code i need help with
if(m_Input->IsKeyDown(VK_F2)!="")m_Graphics->ToggleWireFrame();
if(!m_Graphics->Frame()) return -1;
return 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:16:12.937

如果我理解正确，您正在尝试从字符串中获取可调用函数。C++ 缺乏[反射](http://en.wikipedia.org/wiki/Reflection_%28computer_programming%29)，所以这样做确实不可行。您可以使用一些替代方案。

我的建议是让你的`InputClass::functions`数组包含函数指针，而不是字符串。然后，您可以将函数地址`AddFunc`而不是字符串传递给并相应地设置给定的数组成员。这对于非成员函数来说效果很好。如果您希望能够调用类实例的成员函数，我将创建`InputClass::functions`一个 s 数组并将由into[`std::function`](http://en.cppreference.com/w/cpp/utility/functional/function)返回的函子传递。[`std::bind`](http://en.cppreference.com/w/cpp/utility/functional/bind)`AddFunc`

# javascript - JQuery Accordion Anchor 功能

> ID：14693402
> 
> 赞同：1
> 
> 时间：2013-02-04T18:47:41.090
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-accordion

我正在尝试将以下行为添加到 JQuery Accordion：

1) 根据内部页面链接 ( `#section1`) 激活手风琴部分。`mypage.com/page.php#test`这意味着如果用户访问我将使用 JS 激活该手风琴部分的 URL 。

2) 使手风琴的每个部分的标题可复制链接到将激活手风琴的所述部分的 url。因此，如果用户右键单击手风琴的“部分标题”并复制链接位置，它将放在`mypage.com/page.php#test`用户的剪贴板上。

* * *

我已经 1) 弄清楚了，但这是我自己编写的代码。我在搞乱这个`navigation:true`选项，但没有任何运气。如果有人愿意为我指出正确的方向，我更愿意使用作者的代码而不是我自己的代码，但如果没有，那么这已经完成了，没什么大不了的。

2）是我不知所措的地方。似乎 JQuery 手风琴正在将代码绑定到手风琴部分标题中任何位置的单击事件。这似乎无法为用户提供我想要的复制链接位置功能。

我的 HTML：

```
<div id="accordion">
   <article class="std_page_content">
    <h3><a id="#test">Test</a></h3>
    <div>
       test
    </div>
   </article>
   .....additional accordion sections....
</div> 
```

我的Javascript：

```
$("#accordion").accordion({header : "h3", heightStyle : "content", /*Allows full collapse*/collapsible: true, /*collapses sections*/ active:false, navigation:true});

var theUrl = window.location.href;
var hashValue = theUrl.contains("#") ? theUrl.split('#')[1] : null;

if(hashValue != null)
{
    //open the corresponding accordion section
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:07:05.037

只需给你的锚标签一个 href 属性：

```
<h3><a id="#test" href="#test">Test</a></h3> 
```

更新：如果您希望链接覆盖整个手风琴标题，您可以将`<h3>`标签放在锚标签内，如下所示：http: [//jsfiddle.net/3tGYB/1/](http://jsfiddle.net/3tGYB/1/)

```
<div id="accordion">
  <article class="std_page_content">
    <a id="#test" href="#test" class="header"><h3>Test</h3></a>
    <div>
      test
    </div>
  </article>
</div> 
```

当然改变你的javascript：

```
$("#accordion").accordion({header : "a.header" /*plus other options*/}); 
```

# sql - 不能使用连接选择最大元素

> ID：14693409
> 
> 赞同：0
> 
> 时间：2013-02-04T18:48:23.063
> 
> 标签：sql, join, max

我在内部连接中遇到问题我想这样做

```
T1

id   (other atributes)
1
2
3

T2
id      t1_id  order    packat sent    package recievied  other attributes
1       1       0          date*            some date
2       1       1        some date          some date
3       1       2        some date          some date
4       1       3        some date            date**
5       2       0         date*             date**
6       2       0         date*             some date*
7       3       1        some date            date** 
```

结果

结果

```
T1               T2             T2    package sent  package recievied
atributes   order(0)        order(3)    date*         date**
atributes   order(0)        order(0)    date*         date**
atributes   order(0)        order(1)    date*         date** 
```

我尝试了不同的方法，但我无法得到这样的结果

```
select * from  table1 t1
INNER JOIN table2 t2part1 on(t2part1.t1_id = t1.id and t2part1.ordem =0)
INNER JOIN table t2part2 on (t2part2.t1_id = t1.id and max(t2part2.ordem)) 
```

我在另一个连接中使用 T1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:43:16.077

您可以使用嵌套来执行此操作`row_number()`：

```
select *
from  table1 t1 INNER JOIN
      table2 t2part1
      on t2part1.t1_id = t1.id and t2part1.ordem =0 INNER JOIN
      (select t2part2.*,
              ROW_NUMBER() over (partition by t2part2.id order by t2part2.ordem desc) as seqnum
       from table t2part2
      ) t2part2
      on t2part2.t1_id = t1.id and t2part2.seqnum = 1 
```

# javascript - 当页面导航离开时，Javascript 会发生什么？

> ID：14693415
> 
> 赞同：4
> 
> 时间：2013-02-04T18:48:40.913
> 
> 标签：javascript, onunload

当页面导航离开时，Javascript 会发生什么？我正在阅读的一本书正在指导清除“卸载”事件的内容。

但有什么意义呢？当页面在浏览器中移开时，不是所有内容都丢失并释放了吗？

谢谢，

肖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:53:56.493

唯一有用的情况是清除在 DOM 和 JS 引擎之间具有循环引用的事件处理程序（并不总是事件处理程序，但它是最常见的方式）并因此导致内存泄漏。卸载页面时，其他所有内容都会被垃圾收集

[卸载网页后，](https://stackoverflow.com/questions/1077840/javascript-memory-leaks-after-unloading-a-web-page/1886359#1886359)请参阅这篇文章Javascript 内存泄漏

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T18:56:18.120

*通常*浏览器会在页面导航后很好地清理内存。但是，您可以做一些事情来混淆浏览器并使其在页面转换之间挂起内存。当您将数据存储在 DOM 元素中或在 DOM 和脚本之间存在循环引用时尤其如此。

几年前，在较旧的浏览器中，这是一个更大的问题。当前的浏览器版本在页面转换之间的内存清理方面做得更好。

在页面卸载期间进行一些清理可能是有意义的，但最好修改您的设计以消除循环引用。不要将数据存储在 DOM 中。

这是一篇关于更多细节的[好文章](http://www.ibm.com/developerworks/web/library/wa-memleak/)。

[MDN 上的一篇](https://developer.mozilla.org/en-US/docs/Using_XPCOM_in_JavaScript_without_leaking)关于FireFox 中的 JavaScript 泄漏的文章。

这是包含 IE 特定详细信息的[Microsoft 知识库文章。](http://support.microsoft.com/kb/830555)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-04T18:51:06.500

当然。但是您可以通过卸载来释放浏览器中的一些内存（现在不是很有用，但在过去很有用）。或者您可以在卸载时执行一些操作（即询问用户确认、保存内容等）。

# php - PHP sprintf() 不能用参数交换代替

> ID：14693417
> 
> 赞同：1
> 
> 时间：2013-02-04T18:48:44.687
> 
> 标签：php

以下代码生成未定义变量 $s 而不是“第二个”

```
define("T1","one");
define("T2","two");

$test="number %2$s";

$test=sprintf($test, T1,T2);

echo $test; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T18:49:54.803

单引号解决您的问题。双引号导致 PHP 将您的 '$' 插入为变量。

```
<?php
define("T1","one");
define("T2","two");

$test='number %2$s';

$test=sprintf($test, T1,T2);

echo $test; 
```

[看到它工作](http://3v4l.org/IZ2Om)

# opencart - Opencart 很慢

> ID：14693418
> 
> 赞同：0
> 
> 时间：2013-02-04T18:48:45.903
> 
> 标签：opencart

我的电子商务有问题。我使用opencart 1.5.4，我的网站上有很多产品，大约30 000，我的eshop很慢。我尝试了不同的技巧，但都没有成功。这是我的商店[http://mycomp.sk/](http://mycomp.sk/)。感谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-17T15:44:04.727

我想您对每种产品也有很多类别。让我们试试这个

打开目录\控制器\模块\category.php

搜索 ：`$total = $this->model_catalog_product->getTotalProducts(array('filter_category_id' => $category['category_id']));`

用。。。来代替`$total = '';`

和

搜索 ：`$product_total = $this->model_catalog_product->getTotalProducts($data);`

用。。。来代替`$product_total = '';`

这是在类别名称旁边显示的小数字，显示该类别中有多少产品。这是一个很小的功能，我认为它不会增加用户体验，但它对页面速度的影响是相当高的。在每次页面加载时，它都会运行 getTotalProducts 大约 50 次

也许您需要尝试这个[模块（全页缓存）](http://www.opencart.com/index.php?route=extension/extension/info&extension_id=10464)并为所有外键添加索引或免费安装[https://github.com/atomixdesign/opencart-turbo](https://github.com/atomixdesign/opencart-turbo)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T09:48:29.577

我建议使用：PHP 文件的专用服务器。mySQL 的专用服务器，上面只有 phpMyAdmin。在 MySQL 和 PHP 上，您可以使用扩展库中的许多缓存插件。您可以使用 Memcache 或其他加速器。缓存是个好主意。作为奖励，我还会使用 CDN。

如果您说 30,000 种产品并获得大量订单 - 这是我见过的用于站点的设置：该站点在服务器上运行 5 个 opencart 商店和其他站点/应用程序。每天的总订单量约为 2800 份，有时邮寄和营销订单高达每天 4000 份。我们使用两个带有 Rackspace 的 PHP 服务器。我们使用单个 MySQL 数据库服务器（最初在集群和从属服务器中，但现在只是一个主服务器）这两个 PHP 服务器被克隆和同步。我们只是使用 Dns 和 Rackspace 对我们的 URL 进行负载平衡。使用 CDN 降低了我们的成本和加载时间。现在速度挺快的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-05T16:57:48.870

在这里查看我的帖子：[https](https://stackoverflow.com/a/18063515/2653932) ://stackoverflow.com/a/18063515/2653932 。如果您在您的网站上使用产品计数，您可能需要查看此补丁。不能确定它是否适用于 1.5.4，但如有必要，我很乐意帮助修改它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T19:33:49.627

网站速度取决于很多因素，主要是服务器过于拥挤和配置不佳。如果您无法支付高端服务器的费用，那么小型商店的最佳选择就是[这个 pagecache mod](http://www.opencart.com/index.php?route=extension/extension/info&extension_id=3477) - 特别是当您无权修改 apache 配置时

# android - wrap_content 在包装 @string 时留下额外的高度

> ID：14693419
> 
> 赞同：0
> 
> 时间：2013-02-04T18:48:47.887
> 
> 标签：android, textview

我有一个高度设置为 wrap_content 的 TextView - 但是，它在我的应用程序中留下了很多额外的空间。

textview 中的文本来自@+string，似乎 wrap_content 将其高度设置为字符串变量的高度，而不是插入的实际文本。

如果我更换

```
 android:text="@+string/introGetStarted" 
```

和

```
 android:text="Let&apos;s get started!" 
```

然后它似乎显示了正确的高度并只包装了文本。

我错过了什么吗？

我的完整TextView，供参考：

```
 <TextView
        android:id="@+id/textViewTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="@dimen/d15"
        android:layout_marginRight="@dimen/d30"
        android:layout_marginTop="@dimen/d25"
        android:lineSpacingExtra="-10sp"
        android:text="@string/introGetStarted"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="@dimen/d70" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:00:32.530

您引用的字符串资源错误。去掉加号

```
android:text="@string/introGetStarted" 
```

@+string/ 表示添加名称为“introGetStarted”的新字符串资源，而@string/introGetStarted 表示引用现有资源“introGetStarted”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:36:35.167

我实际上找到了答案，这是由于 strings.xml 文件本身出现了换行符。

# python - Python：树递归问题

> ID：14693424
> 
> 赞同：0
> 
> 时间：2013-02-04T18:48:54.380
> 
> 标签：python, recursion, tree

我在正确处理树时遇到问题。树很简单，只是一个节点和子列表

```
class Tree (object):
    __slots__ = "node","children"
    def __init__(self,node,children=[]):
        self.node = node
        self.children = children 
```

但是，使用线性化技术，我们应该检测给定分支结束了多少（子）树。例如，如果我们像这样构造一棵树：

```
t = Tree(1, [Tree(2, [Tree(5), Tree(3, [Tree(4)])])]) 
```

那么`t.linearize()`应该输出`1 2 5 NIL 3 4 NIL NIL NIL NIL`. 每个`NIL`代表 1 个（子）树正在结束。

我当前的版本只输出以下内容：`1 2 5 NIL 3 4 NIL`，没有多个`NIL`s。知道我遗漏了什么吗？

```
def linearize(self):
    print self.node,
    if self.children == []:
        print "NIL",
    for child in self.children:
        child.linearize() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:54:50.413

您真正想要的 IIUC：

```
def linearize(self):
    print self.node,
    for child in self.children:
        child.linearize()
    print "NIL", 
```

这使：

```
In [5]: t.linearize()
1 2 5 NIL 3 4 NIL NIL NIL NIL 
```

现在，`"NIL"`当有孩子时，您不会打印。（正如评论中所指出的，你真的想要`children=None`然后`self.children = children if children is not None else []`或其他东西。）

您可能也有兴趣对`yield`每个元素进行重新设计，而不仅仅是打印它们，但显然这取决于您。

# inno-setup - Inno Setup 的 ExpandConstant 是否支持 UTF-8？

> ID：14693425
> 
> 赞同：5
> 
> 时间：2013-02-04T18:48:55.073
> 
> 标签：inno-setup

我有一个使用 Pascal 脚本创建自定义向导页面的 Inno Setup 安装程序。安装程序似乎使用正确的模式来支持其他语言。但是，使用 创建的自定义向导页面在其中`CreateCustomPage()`显示垃圾字符，而不是目标语言（在本例中为俄语）中的字符串。

字符串存储在一个`[CustomMessages]`部分中，使用每种语言的包含文件。虽然我是 Inno Setup 的新手，但字符串的设置方式似乎与 Inno Setup 示例一致，并且我从互联网上的各种来源阅读了说明。

无论如何，自定义向导页面及其上的控件是使用以下代码创建的：

```
Page := CreateCustomPage(
  PreviousPageId,
  ExpandConstant('{cm:MyStringConstant}'),
  ExpandConstant('{cm:MyOtherStringConstant}')
); 
```

然后，在字符串包含文件中（同样，对于俄语），字符串定义为：

```
[CustomMessages]
ru.MyStringConstant=<Russian string>
ru.MyOtherStringConstant=<Russian string> 
```

但是当安装程序运行时，自定义向导页面上的字符串会出现乱码（好像 UTF-8 字符被解释为 Ansi），而不是正确的俄语文本。

安装程序中的其他页面（即那些不是用 创建的页面`CreateCustomPage()`）正确显示。

`ExpandConstant()`所以，我的问题是，在使用UTF-8 字符串时是否需要做一些特别的事情？或者是否有更好的函数用于从该`[CustomMessages]`部分检索 UTF-8 字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T10:49:55.363

只要您运行 Inno 编译器的 unicode 版本，主 ISS 文件就支持 UTF-8。您不能在 ISL 语言文件中使用 UTF-8 或任何 unicode 格式，因为它们必须是 ANSI 并指定了适当的代码页。

您还必须使用 unicode 字符文字来指定`[Code]`节中的 unicode 文本。

有关详细信息，请参阅[帮助文件中的 Unicode Inno 设置文章](http://www.jrsoftware.org/ishelp/topic_unicode.htm)。

# variables - XSLT 从变量创建节点名称

> ID：14693431
> 
> 赞同：4
> 
> 时间：2013-02-04T18:49:24.787
> 
> 标签：variables, xslt-1.0, node-set

当我有这两个变量时

```
<xsl:variable name="a" select="'Total'" />
<xsl:variable name="b" select="'500'" /> 
```

我想创建一个名为“a”的节点及其来自变量“b”的内容。我必须将 xsltproc 与 XSLT 1.0 和几个 EXSLT 扩展（其中的节点集）一起使用，所以我已经实现了其中的一部分：

```
<xsl:template match="/">
  <xsl:variable name="x" >
    &lt;<xsl:value-of  select="$a" />&gt;
        <xsl:value-of  select="$b" />
    &lt;/<xsl:value-of  select="$a" />&gt;
  </xsl:variable>
  <xsl:value-of disable-output-escaping="yes" select="$x" />
</xsl:template> 
```

确实提出了这一点（我暂时不关心空格）：

```
<?xml version="1.0"?>

    <Total>
        500
    </Total> 
```

**但是**：我想使用变量'x'作为节点集以便进一步操作它（当然我的现实生活中的例子更复杂）。我所做的是将其转换为节点集（使用 exslt.org/common），这似乎可行，但访问内容却不行。

```
 <xsl:variable name="nodes" select="common:node-set($x)" />
  <xsl:value-of select="$nodes/Total" /> 
```

一事无成。我本来期望 ' **500** ' 因为 $nodes/Total 应该是一个有效的 XPATH 1.0 表达式。显然我错过了一些东西。我想关键是节点名称的动态创建`&lt;...&gt;`并没有真正创建节点，而只是一些文本输出，所以我怎样才能在这里实现真正的节点创建？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-06T04:05:15.137

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:variable name="a" select="'Total'" />
 <xsl:variable name="b" select="'500'" />

 <xsl:template match="/*">
  <xsl:variable name="rtfX">
    <xsl:element name="{$a}">
      <xsl:value-of select="$b"/>
    </xsl:element>
  </xsl:variable>

  <xsl:value-of select="ext:node-set($rtfX)/Total"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于*任何*XML 文档（未使用）时，会产生所需的正确结果：**

```
500 
```

# java - 通过 java.lang.Object 检测数组

> ID：14693432
> 
> 赞同：7
> 
> 时间：2013-02-04T18:49:26.793
> 
> 标签：java, instrumentation

我目前正在开发一个平台，该平台通过 ASM 库大量使用动态字节码修改例程。除了数组类之外，我已经能够成功地检测所有必需的系统类。（即 String[]、int[] 等）这是因为数组类本身就是一个动态类型，因此据我所知，rt.jar 中实际上没有类文件可以检测。

但是，我确实想到，即使数组类型扩展了 java.lang.Object 所以虽然修改 Object 类并不理想，尤其是因为它会导致任何更改传播到所有子类，它可能允许我间接向数组类添加了一个额外的原始字段，顺便说一句，这就是我想要实现的全部目标。

除了我提到的明显警告之外，这会导致任何其他与平台相关的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:35:24.200

最简单的做法是用您选择的编译版本替换它，而不是检测 Object。假设这可行，您可以对其进行检测以使其更便携。

注意：我发现 JVM 不喜欢 Object 有额外的方法（如果你添加了多个方法，你会得到奇怪的错误）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T19:31:41.810

您可能难以获取和设置字段。

JVM 规范中对[`getfield`](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.getfield)and[`putfield`](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.putfield)指令的描述（如果我理解正确的话）声明它们不能用于数组。引用，对于`getfield`：

> objectref 的类型不能是数组类型。

和`putfield`：

> objectref 的类不能是数组。

但是，“如果在运行时不满足指令描述中的某些约束（“必须”或“不得”），则 Java 虚拟机的行为是未定义的，因此它可能会正常工作。

# syntax-highlighting - Xtext：语义突出意外行为

> ID：14693436
> 
> 赞同：0
> 
> 时间：2013-02-04T18:49:39.247
> 
> 标签：syntax-highlighting, default, semantics, xtext

我在 MySemanticHighlightingCalculator 中实现了以下代码，并且一个元素的颜色按预期更改。但是默认的默认突出显示，例如关键字的紫色不再起作用。

```
INode root = resource.getParseResult().getRootNode();
        BidiTreeIterator<INode> iterator = root.getAsTreeIterable().iterator();
        while (iterator.hasNext()) {
            INode node = iterator.next();
            if (node.getSemanticElement() instanceof ParameterDesc) {
                ParameterDesc paramdesc = (ParameterDesc) node
                        .getSemanticElement();
                if (paramdesc.isUnselected() == true) {
                    acceptor.addPosition(
                            node.getOffset(),
                            node.getLength(),
                            MySemanticHighlightingConfiguration.PARAMETER_DESCRIPTION);
                }
            }
        } 
```

* * *

```
public static final String PARAMETER_DESCRIPTION = "Parameter_Description";

public void configure(IHighlightingConfigurationAcceptor acceptor) {
    addType(acceptor, PARAMETER_DESCRIPTION, 255, 0, 0, TextAttribute.STRIKETHROUGH);
}

public void addType(IHighlightingConfigurationAcceptor acceptor, String s,
        int r, int g, int b, int style) {
    TextStyle textStyle = new TextStyle();
    textStyle.setColor(new RGB(r, g, b));
    textStyle.setStyle(style);
    acceptor.acceptDefaultHighlighting(s, s, textStyle);
} 
```

但是，当我从 MyDSLLUiModule 中删除 MySemanticHighlightingConfiguration 时，默认突出显示再次起作用：

```
public Class<? extends IHighlightingConfiguration> bindIHighlightingConfiguration() {
        return MySemanticHighlightingConfiguration.class;
    } 
```

我知道默认突出显示不会在偏移量和偏移量+长度之间应用，但我希望它用于文档的其余部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:11:49.710

您的突出显示配置必须扩展`DefaultHighlightingConfiguration`并且您必须调用`super.configure()`. 那会成功的。

请注意，`resource.getParseResult()`在极少数情况下可能为空。

# asp.net - 如何创建回发的普通 HTML 按钮？

> ID：14693437
> 
> 赞同：-3
> 
> 时间：2013-02-04T18:49:39.263
> 
> 标签：asp.net

我需要一个不同于普通服务器端的按钮，因为我可能需要隐藏或禁用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T03:29:29.977

只需检查您问题中的关键词并推断您可能会问什么，这个问题可能是相关的：[如何使用 __doPostBack()](https://stackoverflow.com/questions/3591634/how-to-use-dopostback)

如果你不想渲染

```
<asp:Button/> 
```

控件，或者如果您没有可用的控件，则可以`__doPostBack()`在 javascript 中调用该方法（前提是页面上至少有一个控件已呈现此方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:17:27.467

你的意思是你想要一个html按钮来提交你的表单？就像是：

```
<input type="submit" value="Save" /> 
```

如果是这样，输入 type="submit" 应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T02:07:03.727

虽然不清楚您真正想要什么，但以下内容可能会对您有所帮助：

```
<a href="javascript:document.location.reload();" ONMOUSEOVER="window.status='Refresh'; return true" ONMOUSEOUT="window.status='Page Reloading'"> RELOAD </a> 
```

或者

```
<a href="javascript:history.go(0)">Refresh the Page</a> 
```

或者

```
<input type="submit" value="Send" /> 
```

# sql - 使用 SQL Server 2005 Management Studio Express 管理 SQL Server 2005 Enterprise

> ID：14693449
> 
> 赞同：0
> 
> 时间：2013-02-04T18:50:30.523
> 
> 标签：sql, sql-server-2005

我可以使用 Management Studio Express 在 SQL Server Enterprise 2005 上执行查询、备份和缩小数据库等任务吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:56:06.960

有些任务您将无法完成；例如，您无法管理 SQL Server 代理作业、使用导入/导出向导、使用 SQL Server 运行跟踪或运行某些预设报告。

如果您必须管理的最低版本的 SQL Server 是 SQL Server 2005，我强烈建议放弃 2005 版本的 Management Studio Express 并获取最新的 2012 版本。它是 Express Edition 工具的第一个版本，实际上支持所有功能而不是子集。点击这里下载最新版本：

[https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms](https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms)

顺便说一句，你真的不应该收缩你的数据库，除非是为了响应一个异常事件。

# c# - 文件监控的队列实现并将它们发送到 Web 服务

> ID：14693451
> 
> 赞同：2
> 
> 时间：2013-02-04T18:50:34.237
> 
> 标签：c#, multithreading, thread-safety, queue, implementation

我需要编写一个应用程序来监视由第三方软件创建的新文件的特定文件夹，然后将它们复制到我的存储库并一个接一个地发送到 Web 服务。文件发送后，将从 repo 中删除。

我显然会使用 FileSystemWatcher 进行文件监控并将它们复制到我的仓库中。然后我会将复制的文件名排队到队列中。

我应该从这里做什么？发送文件时如何管理此队列和出列？另一个问题是如何使这个线程安全，因为队列是从不同的线程（FileSystemWatcher）访问的？

实现这一点的最佳和最安全的方法是什么？

谢谢你的回答，SkyFox

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T01:37:38.097

在一开始的时候：

```
BlockingCollection<string> q = new BlockingCollection<string>();
var bg = new BackgroundWorker();
bg.DoWork += (s,e) => SendFilesToServer();
bg.RunWorkerAsync(); 
```

在文件观察事件（文件创建）中：

```
q.Add(fileName); 
```

工人'：

```
void SendFilesToServer()
{
    string filename;
    try
    {
        while(true)
        {
            while (q.TryTake(out fileName))
            {
                // Send to the webservice
            }
            while(q.IsEmpty)
                Thread.Sleep(100);
        }
    }
    catch (InvalidOperationException)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:36:59.797

我认为您不需要多个文件观察者的多个线程。（也许我误解了你的说法。）另外，我不确定你为什么需要排队。

让您的应用程序主线程运行文件观察程序。当文件观察事件被触发时，您可以启动工作线程来处理每个文件操作以完成所涉及的实际工作（每个文件一个线程）。线程操作彼此独立，因此您无需担心线程安全。观察者应该处理文件系统通知事件的隔离，这样您就不会在同一个文件中遇到两个通知事件。

# .net - TPL 数据流线程本地数据

> ID：14693452
> 
> 赞同：0
> 
> 时间：2013-02-04T18:50:37.890
> 
> 标签：.net, task-parallel-library, tpl-dataflow, thread-local-storage

有没有一种将线程本地数据传递到 ActionBlock 的好方法，这样如果您在其 DataFlowExecutionOptions 中指定 MaxDegreeOfParallelization 为 > 1，那么执行该操作的每个任务都会有自己的线程本地数据？

这是我的一些代码，可能会阐明我想要做什么：

```
var options = new ExecutionDataflowBlockOptions() 
     {
        MaxDegreeOfParallelism = 12
     };

ActionBlock<int> actionBlock = new ActionBlock<int>(PerformAction, options);

List<int> resultsList = new List<int>();

void PerformAction(int i)
{
    // do some work

    // add them to resultsList 

    // i want to make sure that each thread that executes this method has its 
    // own copy of resultsList 
} 
```

我希望能够让 ActionBlock 调用我提供的线程本地初始化函数。像这样的东西：

```
new ActionBlock<int>(PerformAction, options, () => new List<int>()); 
```

并让它将我的线程本地数据传递给我的 Action 函数：

```
void PerformAction(int i, List<int> localUserData) {...} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T00:53:09.537

我仍然不明白为什么您需要数据流块中的线程本地列表。你是对的，TDF 没有对线程局部值的任何明确支持（方式`Parallel.ForEach()`确实如此）。但这并不意味着您不能使用线程本地值，您只需要手动执行所有操作，使用[`ThreadLocal`](http://msdn.microsoft.com/en-us/library/dd642243.aspx)(我认为`[ThreadStatic]`在这里效果不佳，因为它不允许您跟踪所有线程本地实例）。例如：

```
private static ThreadLocal<List<int>> threadLocalList;

private static void Main()
{
    threadLocalList = new ThreadLocal<List<int>>(() => new List<int>(), true);

    var block = new ActionBlock<int>(
        (Action<int>)PerformAction,
        new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 4 });

    for (int i = 0; i < 10; i++)
        block.Post(i);

    block.Complete();
    block.Completion.Wait();

    foreach (var list in threadLocalList.Values)
        Console.WriteLine(string.Join(", ", list));

    threadLocalList.Dispose();
}

private static void PerformAction(int i)
{
    threadLocalList.Value.Add(i * i);
} 
```

# android - Android 平板电脑开发 - 从 SQLite 数据库自动填充多个非列表视图？

> ID：14693453
> 
> 赞同：0
> 
> 时间：2013-02-04T18:50:39.583
> 
> 标签：android, android-layout, android-contentprovider, android-sqlite, xoom

我正在为 android 平板电脑开发，我有一个选项卡，它是一个片段，它有许多 ViewGroups (LinearLayouts)，其中包含许多彩色圆圈视图——它们有一些与之关联的数据对象。（见屏幕截图）

消息将从网络传入并更新与每个圆形视图关联的数据对象的数量。当他们进来时，我想将它们添加到 SQLite DB；并且当这种变化自动更新侦听 ViewGroups。然后它将更新与每个 CircleView 关联的数据对象的数量和内容。

我一直在研究内容提供者、适配器等。但这些似乎是针对占据整个屏幕的列表视图，例如在手机上。问题是如何根据数据库更改在我的片段中自动有效地更新这些视图？我将使用什么机制以及如何使用它们。我已经陷入了许多死胡同。（基于我有限的android dev exp）

任何见解都会很棒！谢谢

我设置视图的选项卡片段：

```
 public class TheoryFragment extends Fragment {

    private ViewGroup theoriesView;
    private HashMap<String, TheoryPlanetView> theoryViewsToAnchors = new HashMap<String, TheoryPlanetView>();
    private GestureDetector gestureDetector;    
    private SimpleCursorAdapter dataAdapter;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        theoriesView = (ViewGroup) inflater.inflate(R.layout.theories_activity_vertical,
                container, false);

        setupListeners();

        return theoriesView;
    }

    /**
     * Setups the listeners 
     */
    private void setupListeners() {
        //add listeners to all the draggable planetViews
        // get all the colors and the
        int childCount = theoriesView.getChildCount();
        for (int i = 0; i < childCount; i++) {
            View possibleView = theoriesView.getChildAt(i);
            if( possibleView instanceof TheoryPlanetView ) {
                TheoryPlanetView tv = (TheoryPlanetView) possibleView;
                tv.setOnDragListener(new TargetViewDragListener());

                theoryViewsToAnchors.put(tv.getAnchor(), tv);
            }
        }

        ViewGroup planetColorsView = (FrameLayout)             theoriesView.findViewById(R.id.colors_include);
        // get all the colors and the
        childCount = planetColorsView.getChildCount();
        for (int i = 0; i < childCount; i++) {
            View color = planetColorsView.getChildAt(i);
            color.setOnTouchListener(new CircleViewDefaultTouchListener());
        }
    }

} 
```

![截屏](../Images/e40a585f6b833f9397d646fe9f650651.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T00:54:17.920

在理解问题时遇到了一些麻烦，但我会使用异步任务 [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

基本上你想在后台线程上做网络或数据库的东西。任务完成后，android会自动运行一个方法

onPreexecute() -> 启动进度条等

doInBackground() -> 网络/数据库

onPostExecute() -> 更新你的 UI（当 doInBackground 完成时调用）

如果这还不够，您还可以查看观察者模式

# .net - VB.Net 文件传输：接收到的文件不完整

> ID：14693455
> 
> 赞同：0
> 
> 时间：2013-02-04T18:50:43.940
> 
> 标签：.net, vb.net, sockets, file-transfer

我在 VB.Net 中创建了一个文件共享程序，但是当我尝试发送文件时，接收部分没有正确接收文件。只有我发送的文件的一部分。比如说，我发送了一个 100 MB 的文件，只会收到 10 MB。有时 22 KB、39MB 等。接收到的文件的大小并不总是相同的。你认为是什么导致了这个问题？我应该怎么做才能正确接收整个文件？

**发送部分**

```
Sub Main()
    Dim ip As New IPEndPoint(IPAddress.Any, 8888)' Port Server
    Dim sock As New Sockets.Socket(AddressFamily.InterNetwork, SocketType.Stream,   ProtocolType.IP)' Protocol type
    sock.Bind(ip)
    sock.Listen(100)
    While True' Check Client Connection
        Try
           msg("Accept Client Connect")
           Dim csock As Sockets.Socket = sock.Accept
           Dim csend(1024 * 10000) As Byte
           Dim path As String = "C:\Users\IT\Desktop\test\" ' Location to save file
           Dim bLen As Integer = csock.Receive(csend) ' Byte Read Len
           Dim fileLen As Integer = BitConverter.ToInt32(csend, 0) ' File Len
           Dim fName As String = Encoding.ASCII.GetString(csend, 4, fileLen) ' File Name
           msg("Start Receive....." & fName)
           Dim bWrite As New BinaryWriter(File.Open(path + fName, FileMode.Append))
           bWrite.Write(csend, 4 + fileLen, bLen - 4 - fileLen)
           msg("File receiced and Save " & path)
           bWrite.Close()
           csock.Close()
       Catch ex As Exception
           msg(ex.Message)
       End Try
    End While
    Console.ReadLine()
End Sub

Sub msg(ByVal mesg As String)
mesg.Trim()
Console.WriteLine(" >> " + mesg)
End Sub 
```

**接收部分**

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)     Handles Button2.Click
    Dim ipServer As IPAddress() = Dns.GetHostAddresses("127.0.0.1") ' IP Server
    Dim ip As IPEndPoint = New IPEndPoint(ipServer(0), 8888)
    Dim csock As Socket = New Socket(AddressFamily.InterNetwork, SocketType.Stream,     ProtocolType.IP)
    Dim fName As String = TextBox1.Text
    Dim path As String = TextBox2.Text
    Dim fNameByte() As Byte = Encoding.ASCII.GetBytes(fName)
    Dim fData() As Byte = File.ReadAllBytes(path & "\" & fName)
    Dim cData(4 + fName.Length + fData.Length) As Byte
    Dim fDataLen() As Byte = BitConverter.GetBytes(fNameByte.Length)
    Try
       fDataLen.CopyTo(cData, 0)
       fNameByte.CopyTo(cData, 4)
       fData.CopyTo(cData, 4 + fNameByte.Length)
       csock.Connect(ip)
       csock.Send(cData)
       MsgBox("Success Send File ")
       csock.Close()
    Catch ex As Exception
       MsgBox(ex.Message)
    End Try
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)  Handles Button1.Click
    If OpenFileDialog1.ShowDialog = Windows.Forms.DialogResult.OK Then
    TextBox1.Text = System.IO.Path.GetFileName(OpenFileDialog1.FileName)
    TextBox2.Text = System.IO.Path.GetDirectoryName(OpenFileDialog1.FileName)
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-21T04:39:38.430

**错误 1，** 使用***Append***模式创建的二进制文件应该在***第 07 行******创建*****错误 2，** 应该使用嵌套循环来接收数据包。在这里我添加 do ~ 循环。***a if condition check weather is another packet is available or not by check it size , if size=0 然后在第 08 ~ 13 行***退出循环**错误 3，** 当收到第一个数据包时，它被写入文件减去元数据. 像 bWrite.Write(csend,4+fileLen,bLen-4-fileLen)。***在 06/10 号线*** *******这对于第一个数据包来说很好，但对于剩余的数据包则不然。因为元数据在开始时只发送一次，所以不应该从每个数据包中删除它。在这种情况下，剩余值应为 0，并且数据包的长度为 bLen。正如您在***第 12 行***看到的那样，我重置了这些值。*******

 ******```
 01,   Dim csock As Sockets.Socket = sock.Accept
         02,   Dim csend(1024 * 10000) As Byte
         03,   Dim bLen As Integer = csock.Receive(csend) ' Byte Read Len
         04,   Dim fileLen As Integer = BitConverter.ToInt32(csend, 0) ' File Len
         05,   Dim fName As String = Encoding.ASCII.GetString(csend, 4, fileLen) ' File Name
         06,   Dim strt As Integer = 4 + fileLen, ln As Integer = bLen - 4 - fileLen

         07,   Dim bWrite As New BinaryWriter(File.Open(path + fName, FileMode.Create))
         08,   Do
         09,       If bLen = 0 Then Exit Do
         10,       bWrite.Write(csend, strt, ln)
         11,       bLen = csock.Receive(csend) ' Byte Read Len
         12,       strt = 0 : ln = bLen
         13,   Loop 
```

对不起，我尽我所能解释它。******

# xcode - 防止项目在特定条件下编译成功

> ID：14693461
> 
> 赞同：1
> 
> 时间：2013-02-04T18:51:00.100
> 
> 标签：xcode, cocoa

有时我必须为项目打开某些功能，例如我不想在归档项目以将其提交给 Apple 时打开的某些标志或 iTunes 文件共享。

如果满足某些条件，有没有办法强制阻止项目正确编译并在 Xcode 上显示错误（我的意思是 Xcode 工具栏上的红色徽章图标）？

就像是

```
if (some condition)
  do not compile or cause a compile error 
```

我需要 xcode 来告诉我我忘记了一些不应该在最终版本中发布的内容。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:53:11.820

有一个预处理器指令`#error`应该适合您：

```
#if !FLAG_THAT_SHOULD_BE_SET
#error You should set FLAG_THAT_SHOULD_BE_SET
#endif 
```

来自 C 标准：

> **`#error`**除非它是条件包含跳过的组的一部分，否则实现不应成功翻译包含预处理指令的预处理翻译单元。

# php - 带有 sql 的多维数组

> ID：14693467
> 
> 赞同：1
> 
> 时间：2013-02-04T18:51:21.023
> 
> 标签：php, mysql, sql

我在一个名为 $ids 的变量中有一个数组，该数组如下所示：

```
Array
(
    [0] => Array
        (
            [id] => 1
        )

    [1] => Array
        (
            [id] => 7
        )

) etc 
```

我需要在 WHERE id IN ($ids); 中使用它 我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:55:31.400

您的问题陈述有点令人困惑。但是您似乎想知道您要做什么，除了您不知道如何编译 id 列表？如果是这种情况，试试这个：

```
$ids = array_map( function( $el ) {
    return $el['id'];
}, $array ); 
```

如果您的 PHP 版本低于 5.3，则不能使用匿名函数。请改用下面的代码。

```
function comb_arr( $el ) {
    return $el['id'];
}
$ids = array_map( 'comb_arr', $array ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:01:55.610

试试这个...........

```
$data = Array
 (
[0] => Array
    (
        [id] => 1
    )

[1] => Array
    (
        [id] => 7
    )

 )  
$ids = array();

    foreach($data as $key => $d) {

      array_push($ids,$d['$id']);

   }

   $sql = "select * from tablename where id IN(implode(',',$ids))"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:00:22.860

如果您的意思是您需要使用数组构建查询，我认为您基本上想要构建查询字符串，因此您可以使用 for 循环。从一个基本字符串开始，比如

```
$query = "SELECT whatevercolumns FROM whatevertables WHERE id=";

//then loop through your array

for($j = 0; $j < sizeof($array); $j++)
{
     $query .= array[$j]

     //if it's not the last id you want to add, add an OR to your sql query
     if($j < (sizeof($array) - 1))
     {
          $query .= " OR ";
     }
} 
```

不清楚你在问什么，你不能使用 sql 来查询你的 php 数组。我假设您想使用您的数组来填充 sql 查询。

# javascript - jQuery.each 是否在每次迭代中评估集合表达式？

> ID：14693469
> 
> 赞同：2
> 
> 时间：2013-02-04T18:51:36.463
> 
> 标签：javascript, jquery

我有一个像这样的代码：

```
$.each($.parseJSON(data).content,function(){}); 
```

我想知道是否`$.parseJSON(data).content`将在每次迭代中评估，还是只评估一次？这将显着影响性能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T18:55:33.023

函数调用的参数总是在函数被调用之前被评估。这不是 jQuery 特定的。见[规格](http://es5.github.com/#x11.2.3)：

> 3\. 令 argList 为**求`Arguments`**值的结果，生成参数值的内部列表（见 11.2.4）。
> 
> ...
> 
> 8\. 返回**调用 on 的 [[Call]] 内部方法的`func`**结果，提供`thisValue`this 值并提供列表`argList`作为参数值。

* * *

为清楚起见，循环中**不是**这种情况：`for`

```
for(var i = 0; i < $.parseJSON(data).content.length; i++) {

} 
```

在这里，每次都会评估第二个表达式。这是有道理的，因为在一个简单的循环中，您希望`i < length`在每次迭代时重新评估条件。但是您*不想*`$.parseJSON`在每次迭代时都运行。所以在`for`循环中，将表达式分解出来是有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:59:10.107

它只评估**一次**。

您可以在 javascript 控制台中自行测试：

```
 var ary = [1,2,3,4],
        getAry = function() { 
            console.log('ok'); 
            return ary; 
        };

$.each(getAry(), function(idx, val) {}); 
```

`"ok"`将打印一次。

# mono - MonoMac BeginSheet 问题

> ID：14693470
> 
> 赞同：0
> 
> 时间：2013-02-04T18:51:36.573
> 
> 标签：mono, monodevelop, monomac

我正在编写一个 MonoMac 应用程序，但我正在努力使用 BeginSheet。我有很多问题，并会列出它们，希望这是一个普遍存在的问题。

我已经设法让我的 BeginSheet 将我的登录窗口显示为工作表，但是如果我在应用程序的属性中将应用程序的主界面设置为 MainWindow，而不是 MainMenu，那么 BeginSheet 什么也不做。我的代表也永远不会在工作表关闭后运行。我通过调用 Close() 从 LoginDialogController 中关闭 LoginWindow。

这是我在 MainWindowController 上使用的代码：

```
public override void WindowDidLoad ()
{
    base.WindowDidLoad ();

    Dialogs.LoginDialogController loginDialog = new Dialogs.LoginDialogController();
    loginDialog.Window.IsVisible = false;

    NSApplication.SharedApplication.BeginSheet(loginDialog.Window, Window, delegate {
        // THIS NEVER RUNS
        mainTabView.SelectAt(1);
        mainToolbar.SelectedItemIdentifier = "hometoolbaritem";
    });
} 
```

在我的其他观点之一中，我使用了以下绝对无效的代码：

```
TypeDialogController typeDialog = new TypeDialogController();
typeDialog.Window.IsVisible = false;
// THIS CALL HAS NO EFFECT
NSApplication.SharedApplication.BeginSheet(typeDialog.Window, View.Window, delegate {
    // THIS WILL PROBABLY NOT RUN EITHER, EVEN IF THE SHEET SHOWS
}); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:23:29.290

将应用程序主界面切换到 MainWindow 时不会调用 WindowDidLoad() 方法，因为该方法是 MainWindowController 的一部分，而不是 MainWindow。

正常的事件顺序是这样的：

1.  MainMenu.xib 作为应用程序的主 UI 启动
2.  MainMenu.xib 实例化 AppDelegate
3.  AppDelegate FinishedLaunching(NSObject 通知) 委托方法被调用
4.  FinishedLaunching(NSObject notification) 构造一个新的 MainWindowController 实例，并用它来显示 MainWindow
5.  MainWindowController WindowDidLoad() 被调用，你的代码运行

当您将主界面更改为 MainWindow.xib 时，会发生这种情况

1.  MainWindow.xib 作为应用程序的主 UI 启动。也就是说，创建了 MainWindow 的一个实例，但没有创建控制器来管理它，也没有应用程序委托

我不清楚你想通过将主界面更改为 MainWindow.xib 来实现什么。也许如果你解释你想要达到的目标，有人可能会提供帮助。

关于您在使用工作表时遇到的问题，您似乎没有在 LoginDialogController 中正确关闭工作表。如您所见，仅调用 Window.Close() 是不够的，并且会阻止显示更多工作表。你需要做这样的事情：

```
NSApplication.SharedApplication.EndSheet(this.Window);
this.Window.OrderOut(sender);
this.Window.Close(); 
```

您总是需要平衡对 BeginSheet 的调用和对 EndSheet 的调用。

如果这不是您的问题，您需要展示如何在 LoginDialogController 中关闭工作表。

# xcode - XCode 多边形精灵问题

> ID：14693471
> 
> 赞同：0
> 
> 时间：2013-02-04T18:51:39.393
> 
> 标签：xcode, cocos2d-iphone

我正在使用下面的代码来尝试生成多边形形状的精灵。我遇到了代码问题，有人能发现它有什么问题吗？

```
 b2BodyDef woodBodyDef;
     woodBodyDef.position.Set(400/PTM_RATIO,100/PTM_RATIO);
     woodBodyDef.type = b2_dynamicBody;
     woodBodyDef.userData = _wood;
     _body = _world->CreateBody(&woodBodyDef);

     b2PolygonShape woodShape;

     int num = 4;
     b2Vec2 vertices[] = {
     b2Vec2(-137.0f/PTM_RATIO,-32.5f/PTM_RATIO),
     b2Vec2(-137.0f /PTM_RATIO,36.5f/PTM_RATIO),
     b2Vec2(137.0f /PTM_RATIO,36.5f/PTM_RATIO),
     b2Vec2(136.0f /PTM_RATIO, -32.5f/PTM_RATIO)
     };
     woodShape.Set(vertices, num);

     b2FixtureDef woodShapeDef;
     woodShapeDef.shape = &woodShape;
     woodShapeDef.density = 1.0f;
     woodShapeDef.friction = 1.0f;
     woodShapeDef.restitution = 0.5f;
     woodBodyDef.userData = _wood;
     _body = _world->CreateBody(&woodBodyDef); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:10:32.927

我最好的猜测是顶点的顺序很重要。您按顺时针顺序定义它们，Box2D 可能希望它们按逆时针顺序排列。这很容易验证，所以只需尝试一下，看看是否修复了断言（顺便说一句，多边形区域 <= 0）。

# soundcloud - 嵌入首先搜索用户集/播放列表的 soundcloud 播放器？

> ID：14693476
> 
> 赞同：1
> 
> 时间：2013-02-04T18:51:55.800
> 
> 标签：soundcloud

1.  任何人都知道如何在特定用户的播放列表（集）中制定曲目的搜索语法？
2.  一旦我有了它，我如何使用像 oembed 这样的东西来显示匹配的曲目？

* * *

*1 搜索语法*

[http://developers.soundcloud.com/docs/api/guide#search](http://developers.soundcloud.com/docs/api/guide#search)说：

> 可以使用我们的 API 搜索声音、用户、集合和组等资源。大多数端点将接受 aq 参数，您可以使用它来指定要在标题、用户名、描述等字段中搜索的关键字，具体取决于资源类型。

那么，究竟如何通过搜索词过滤给定用户集的播放器呢？

我认为[https://soundcloud.com/search/sounds?q=newchoir%20100%20years%20tenor&filter.user=newchoir](https://soundcloud.com/search/sounds?q=newchoir%20100%20years%20tenor&filter.user=newchoir)可能有效，但它没有。

具体来说，我有兴趣在我的网站上嵌入一个播放器（它顺便使用了 Atlassian Confluence，但我认为我们现在可以忽略它。）

我想显示的唯一曲目属于该用户：[https](https://soundcloud.com/newchoir) ://soundcloud.com/newchoir - 我明确需要排除任何其他用户。

我希望能够在这样的集合中搜索：[https ://soundcloud.com/newchoir/sets/tenor-rehearsal-tracks](https://soundcloud.com/newchoir/sets/tenor-rehearsal-tracks)

所以我想要的搜索是：

*   按“第 4 周”周
*   按标题“100 年”

我们将星期和歌曲名称作为文本放在标题字段中。

* * *

*2 嵌入式*

[http://developers.soundcloud.com/docs/oembed#introduction](http://developers.soundcloud.com/docs/oembed#introduction)展示了如何处理 Soundcloud URL 以返回包含包含该 URL 的可嵌入播放器的结构。

[http://oembed.com](http://oembed.com)继续说，对于许多类型，该结构在 JSON/XML 中包含一个“html”元素，然后可以通过 javascript 提取该元素。

[https://github.com/starfishmod/jquery-oembed-all](https://github.com/starfishmod/jquery-oembed-all)提供了一个支持 soundcloud 的 jquery 提取器。

但是，oEmbed 方法仅支持[http://soundcloud.com/](http://soundcloud.com/) URL，而不支持[http://api.soundcloud.com](http://api.soundcloud.com) URL。

* * *

所以，我读对了吗：

1.  我要写代码吗？不能只在我的网站中嵌入“iframe src=”吗？
2.  我需要使用 api.soundcloud + 客户端密钥吗？似乎矫枉过正
3.  无法在特定 Soundcloud 帐户中搜索给定的命名曲目并显示与这些术语匹配的播放器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T09:53:11.183

> 任何人都知道如何在特定用户的播放列表（集）中制定曲目的搜索语法？

我认为您必须执行 API 请求才能获取用户集 ( `http://api.soundcloud.com/users/USER_ID/playlists.json?client_id=YOUR_CLIENT_ID`)，然后搜索那里的曲目。

> 一旦我有了它，我如何使用像 oembed 这样的东西来显示匹配的曲目？

它实际上确实适用于 API URL `https://soundcloud.com/oembed.json?url=https%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F64492288`：. 但是您可以节省一个 HTTP 请求并使您的应用程序更快，通过`replace`对字符串的简单调用（例如，在 JavaScript 中）创建 HTML 代码：

```
var template = '<iframe width="100%" height="" scrolling="no" src="http://w.soundcloud.com/player/?url=API_URL" frameborder="0"></iframe>';
var html = template.replace('API_URL', 'https%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F64492288'); 
```

> … 我需要使用 api.soundcloud + 客户端密钥？似乎矫枉过正

不是，这正是 API 的用途，它可以让你对你正在做的事情有更大的灵活性。

# sql - SQL查询，努力提高效率（Oracle DBMS）

> ID：14693477
> 
> 赞同：2
> 
> 时间：2013-02-04T18:51:58.070
> 
> 标签：sql, performance, oracle, database

对于下表（我用**表示主键的部分）

```
Team (*tid*, name)
Game (*gid*, tid, name, year)
Member (*mid*, name)
MemberOf (*mid*, *tid*, startyear, endyear, position) 
```

我需要显示每个前锋的历史（位置） 如果 startyear 为 NULL，则使用该球队该球员最早比赛的年份 结果：前锋姓名、球队名称、开始年份、结束年份 按前锋姓名排序，然后开始年份

虽然我有一个解决方案，但我认为它不是很有效执行计划推断节点成本为 28。是否希望改进建议和解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:16:10.343

您可以通过一个查询来执行此操作，使用`left outer join`and `coalesce`（如果我的逻辑正确）：

```
SELECT Striker_Name, Team_Name, coalesce(MO.STARTYEAR, g.start_year), MO.ENDYEAR
FROM (SELECT NAME AS Striker_Name, MID
      FROM MEMBER
      ) ME JOIN
      (SELECT MID, TID, STARTYEAR AS Start_Year, ENDYEAR AS End_Year
       FROM MEMBEROF
       WHERE POSITION = 'striker'
      ) MO ON ME.MID = MO.MID left outer JOIN
      (SELECT NAME AS Team_Name, TID
       FROM TEAM
      ) T
      ON MO.TID = T.TID left outer JOIN
      (SELECT GID, MIN(GAME.YEAR) AS Start_Year FROM GAME GROUP BY TID
      ) G
      ON G.TID = MO.TID
ORDER BY Striker_Name, Start_Year 
```

您似乎从最早的游戏开始填写开始年份。只需进行连接并决定使用`select`哪一个。

# python - 在本地目录中找不到模块，存在于 sys.path

> ID：14693479
> 
> 赞同：0
> 
> 时间：2013-02-04T18:52:12.577
> 
> 标签：python

我很困惑。我认为这将是一个简单的错误，但我找不到我做错了什么。我正在运行 python 2.4.4。我已经编写了我的第一个由多个文件组成的 python 脚本。我已经阅读了当前工作目录中的 python 外观，以及用户添加模块的所有常用路径。我通过查看 sys.path 确认了这一点：

```
$ python
Python 2.4.4 (#1, Jan  8 2013, 09:29:21) 
[GCC 4.7.2 20120921 (Red Hat 4.7.2-2)] on linux3
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> print(sys.path)
['', '/usr/local/lib/python24.zip', '/usr/local/lib/python2.4',     '/usr/local/lib/python2.4/plat-linux3', '/usr/local/lib/python2.4/lib-tk',     '/usr/local/lib/python2.4/lib-dynload', '/usr/local/lib/python2.4/site-packages']
>>> 
```

第一个条目 '' 表示查看当前工作目录，但它似乎没有这样做。这是我的多文件 python 程序的内容。请注意，所有内容都在同一目录中：

```
$ ls
cherwellTicket.py  dsutils.py  emailMessage.py
$ 
```

这是 dsutils.py 的内容。该模块包含我想在其他类中使用的各种静态方法：

```
#!/usr/bin/python

import getpass
import socket

class DSUtils:
    # (I didn't paste the rest) 
```

这是 cherwellTicket.py 的内容。请注意，这是在同一目录中：

```
#!/usr/bin/python

import DSUtils 

class CherwellTicket:

    def __init():
        pass 
```

然而，当 python 尝试执行 cherwellTicket.py 时，会发生以下情况：

```
$ python cherwellTicket.py 
Traceback (most recent call last):
  File "cherwellTicket.py", line 3, in ?
    import DSUtils 
ImportError: No module named DSUtils
$ 
```

这两个文件都在同一个目录中，那么为什么`cherwellTicket`脚本现在可以导入 dsutils 类呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T18:54:08.970

`DSUtils`不同于`dsutils`. 我想你可能想要：

```
from dsutils import DSUtils 
```

*模块*是*文件*的名称（无`.py`扩展名）。在导入模块之前，Python 不会查看模块中的类。

或者，

```
 import dsutils
 class_you_want = dsutils.DSUtils 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:55:25.323

模块以文件名命名，而不是模块中的类尝试：

```
from dsutils import DSUtils 
```

# php - PHP回显中的链接

> ID：14693480
> 
> 赞同：-2
> 
> 时间：2013-02-04T18:52:15.420
> 
> 标签：php, mysql, hyperlink

您可能已经从我之前的问题中看到了，我对 PHP（和编码）是全新的，我对此感到困惑。

我已经创建了这段代码（尽量不要畏缩）：

```
<?php
$result = mysql_query("SELECT `user_id`, `username`, `email` FROM `users` WHERE `approved` = '0' ORDER BY `username`;");

    echo "<table>";
        while($row = mysql_fetch_array($result))
        {
        echo "<tr><td align=center>" . htmlspecialchars($row['username']) . "</td><td> | </td><td align=center>" . htmlspecialchars($row['email']) . " </td><td> | </td><td><a href=\"approve_user.php?phpuser_id=$row['user_id']\"><font color=\"green\">Approve</font></a> | </td><td><a href=\"deny_user.php?user_id=$row['user_id']\"><font color=\"red\">Delete</font></a></td>";
        }
    echo "</table>";
?> 
```

它连接到另一个文件中的数据库，成功返回所有结果等。但是，当我尝试添加“批准”和“删除”链接时，问题就来了。我希望批准链接转到`approve_user.php?user_id=$row['user_id']`，我希望删除链接转到`deny_user.php?user_id=$row['user_id']`.

我收到错误：

```
Parse error: syntax error, unexpected '' (T_ENCAPSED_AND_WHITESPACE), expecting identifier (T_STRING) or variable (T_VARIABLE) or number (T_NUM_STRING) in C:\xampp\htdocs\liste\approve.php on line 22 
```

第 22 行是 while 循环中的回声。我知道我在那条线上的某个地方搞砸了很多时间，但是对于我的一生，我无法弄清楚在哪里。帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:56:39.023

您必须将 {} 放在 PHP 字符串中的数组变量上：

```
$text = "Variable = {$_GET["user_input"]}\nSimple variable = $var"; 
```

意味着您的代码应该看起来像（我添加了换行符以使代码更具可读性）：

```
echo "<tr><td align=center>" . htmlspecialchars($row['username']) . "</td><td> | </td>\n";
echo "<td align=center>" . htmlspecialchars($row['email']) . " </td><td> | </td><td><a href=\"approve_user.php?phpuser_id={$row['user_id']}\"><font color=\"green\">Approve</font></a> | </td>\n";
echo "<td><a href=\"deny_user.php?user_id={$row['user_id']}\"><font color=\"red\">Delete</font></a></td></tr>\n\n"; 
```

你也曾**失踪`</tr>`**过。我在上面解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T18:57:01.567

一个快速的解决方法是连接你的变量：

```
echo "<tr><td align=center>" . htmlspecialchars($row['username']) . "</td><td> | </td><td align=center>" . htmlspecialchars($row['email']) . " </td><td> | </td><td><a href=\"approve_user.php?phpuser_id=" . $row['user_id'] . "\"><font color=\"green\">Approve</font></a> | </td><td><a href=\"deny_user.php?user_id=" . $row['user_id'] . "\"><font color=\"red\">Delete</font></a></td>"; 
```

但是，代码可以从使其更具可读性或使用模板系统中受益，或者至少考虑分离逻辑和表示。

* * *

旁注：该`mysql_*`库已弃用，建议升级到 PDO 或 MySQLi。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:00:53.687

将数组元素插入字符串时，有两种方法：

```
$string = "blah blah $array[key] blah blah"; 
```

或者：

```
$string = "blah blah {$array['key']} blah blah"; 
```

如果不使用 包围数组变量`{}`，则必须省略键周围的引号。键被自动假定为文字字符串。

**注意**：此假设*仅*在字符串插值中完成。你不能写：

$foo = $array[key];

在这种情况下，`key`被解释为常量的名称，而不是文字字符串。

第二种格式更通用，因为您可以将其他表达式放在键中。它也可以与对象引用一起使用。

其他方法是连接：

```
$string = "blah blah " . $array['key'] . " blah blah"; 
```

或`sprintf()`：

```
$string = sprintf("blah blah %s blah blah", $array['key']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T19:02:18.587

像这样尝试：

```
 <?php
  $result = mysql_query("SELECT `user_id`, `username`, `email` FROM `users` WHERE `approved` =  '0' ORDER BY `username`;");

  echo "<table>";
  while($row = mysql_fetch_array($result))
  {
        $username=$row['username'];
        $email = $row['email'];
        $userID = $row['user_id'];
        echo "<tr><td align=center>" . htmlspecialchars($username) . "</td><td> | </td><td align=center>" . htmlspecialchars($email) . " </td><td> | </td><td><a href=\"approve_user.php?phpuser_id=$userID\"><font color=\"green\">Approve</font></a> | </td><td><a href=\"deny_user.php?user_id=$userID\"><font color=\"red\">Delete</font></a></td>";
  }
  echo "</table>";
  ?> 
```

# c - 在 C 中检查数组的值时出现未处理的异常

> ID：14693486
> 
> 赞同：0
> 
> 时间：2013-02-04T18:52:39.320
> 
> 标签：c, arrays, recursion, unhandled-exception

我有一个任务要编写一个**递归**程序，该程序获取一个数组（我们称之为 arr1）、数组的大小（n）和一个值。程序将检查数组中是否有两个数字，以便它们的摘要为 s。例如，如果数组是 {1,3,2,0,5} 并且 s=7，那么函数将打印“yes”，因为 5+2=7。如果数组是 {1,3,2,0,5} 并且 s=9，则函数将打印“否”。没有任何一对的汇总等于 9。

我的算法是这样工作的：我计算数组中最后一个点的摘要 (arr1[n-1])，以及其他所有点。如果我发现一对夫妇的总和是 s，那太好了，打印 yes 并离开。如果我没有找到，那么我也会这样做，但我检查的是 arr1[n-2] 而不是 arr1[n-1]。我删除了最后一个位置。

这是我的代码：

```
#include <stdio.h>
#include <conio.h>
#include <stdlib.h>
void input_array_dyn(int* a, int n);
void rec(int* a,int n, int s);
void main()
{
    int n=0,s=0;
    int* a;
    printf("Enter value S\n");
    scanf("%d",&s);
    printf("Enter the size of the array\n");
    scanf("%d",&n);
    a=(int*)calloc(n,sizeof(int));
    printf("Enter %d values for the array\n",n);
    input_array_dyn(a,n);
    rec(a,n,s);
    free(a);
    getch();
}
void input_array_dyn(int* a,int n)
{
    int i=0;
    for(i=0;i<n;i++)
        scanf("%d",a[i]);
}
void rec(int* a,int n, int s)
{
    int i;
    if(n==1)
    {
        printf("There are no 2 number whos summary yields S\n"); 
        return;
    }
    for(i=0;i<n-1;i++)
    {
        if(a[n-1]+a[i]==s)
        {
            printf("There are two numbers that give s\n");
            return;
        }
    }
    rec(a,n-1,s);
} 
```

我收到一条错误消息：“Test.exe 中 0x5846e30e (msvcr100d.dll) 处的未处理异常：0xC0000005：访问冲突写入位置 0x00000000。”

另外：有没有人对算法有更好的想法来做到这一点？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:53:30.100

在`input_array_dyn()`：

```
scanf("%d", a[i]); 
```

你忘记了一个`&`.

# user-controls - 类型 UserControl 未定义

> ID：14693487
> 
> 赞同：0
> 
> 时间：2013-02-04T18:52:41.727
> 
> 标签：user-controls

我在项目中添加了一个用户控件并签入到 TFS。现在另一个用户获得了最新版本，她看不到我添加的新用户控件 (uc1)，并且她正在获取类型 UC1 未定义。但我没有收到类型 UC1 未定义错误，我可以看到我添加到项目中的新用户控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:55:09.333

对此的答案是检查包含用户控件而不仅仅是用户控件的项目。因此，当另一个用户从项目中获取最新信息时，他们可以看到添加的新用户控件。

# cocoa-touch - Xcode：保存一个 Int 值

> ID：14693490
> 
> 赞同：-1
> 
> 时间：2013-02-04T18:52:47.993
> 
> 标签：cocoa-touch, core-data, xcode4, int

我有一个简单的计数器应用程序，即用户按下一个按钮将其增加一个他们选择的值。我在单视图应用程序上开始了应用程序生产。我现在需要这样做，以便在关闭应用程序时保存计数器的最后一个值。然后，当应用重新打开时，它需要将计数器的值加载回原位。只需关闭和打开应用程序即可保存和重新加载该值，即无需按下任何按钮。

我的计数器变量是一个`Int`名为`counter`. 视图控制器被简单命名为`viewController.h/m`.

我不知道如何设置所有这些，我假设我需要 coreData 来执行此操作。如何设置 coreData？我是否在我的 viewController 代表中编码？如果这不是最好的方法，请提供一种更有效的方法！

非常感谢您的帮助，最重要的是简单的说明。我已经看过其他示例，但似乎没有一个提供我需要的东西或者足够简单易懂。请在此线程上提供答案！

休

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:59:35.383

简单地使用[NSUserDefaults](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsuserdefaults_Class/Reference/Reference.html)而不是 Core Data 是最简单的。

保存：

```
[[NSUserDefaults standardUserDefaults] setInteger:counter forKey:@"counter"] 
```

读书：

```
NSInteger counter = [[NSUserDefaults standardUserDefaults] integerForKey:@"counter"]; 
```

查看[UIApplicationDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)以找到您应该将代码放入的方法。它可能会在您的 AppDelegate 中的以下方法之一中：

在哪里加载值：

*   `-application:didFinishLaunchingWithOptions:`
*   `–applicationWillEnterForeground:`

保存值的位置：

*   `-applicationDidEnterBackground:`
*   `–applicationWillTerminate:`

确切的位置取决于您是否需要在用户切换到另一个应用程序时加载和保存该值，几乎可以肯定的是，当应用程序由于内存压力而处于冻结状态时可能会终止。在这种情况下，您需要确保在应用程序处于后台（用户切换到其他应用程序）时保存该值，并在应用程序成为前台应用程序（用户切换回您的应用程序）时恢复该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:05:34.823

您可以使用 NSUserDefaults。您可以存储一个创建 NSUserDefaults 变量的变量

```
NSUserDefaults * standardUserDefaults = [NSUserDefaults standardUserDefaults]; 
```

然后保存整数

```
[standardUserDefaults setInteger:1 forKey:@"integer"]; 
```

并同步所有`[standardUserDefaults synchronize];`

然后检索创建变量的整数：

```
NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults]; 
```

然后用

```
NSInteger myInt = [standardUserDefaults integerForKey:@"integer"]; 
```

# php - 使用 PHP 捕获自定义 PayPal 数据

> ID：14693491
> 
> 赞同：0
> 
> 时间：2013-02-04T18:52:49.277
> 
> 标签：php, paypal, paypal-ipn

我有一个定制商店，我在其中销售单一产品（作为礼物），我需要能够存储收件人地址（不同于贝宝用户）、礼物消息以及他们想要礼物的名称从（如果有的话）。

我真的很想在此页面上捕获数据：

[http://sendvalentinesflowers.co.uk/responsive-buy-rose.html](http://sendvalentinesflowers.co.uk/responsive-buy-rose.html)

似乎标准按钮不允许在交易旁边传递/存储这么多数据。我只是想知道如何使用 IPN 完成此操作？我正在寻找最简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T06:25:41.057

在将用户发送到 PayPal 进行付款之前，我会将您本地数据库中的所有信息保存为“待处理”。您可以在 PayPal 代码中包含 invoice 参数，并将值设置为本地记录的记录 ID。

此发票值将在 IPN 中返回，因此您可以将数据拉回并根据需要进行处理，并根据当前 IPN 更新现有记录的付款状态。

# sql - SQL Server 中的地理数据类型与几何数据类型

> ID：14693499
> 
> 赞同：3
> 
> 时间：2013-02-04T18:53:09.833
> 
> 标签：sql, geometry, geospatial, sql-server-2012, geography

环境：SQL Server 2012 我正在使用一个在线工具，这是迄今为止我能找到的唯一一个，在地球上绘制多边形和点。[http://www.birdtheme.org/useful/googletool.html](http://www.birdtheme.org/useful/googletool.html) 我有两张桌子。一个将“区域”存储为多边形，另一个表存储与我的问题无关的点。为简单起见，我将把我的场景简化为 sql 变量。

在下面的查询中，我将 geography 数据类型用于众所周知的兴趣点。我在罗本岛周围画了一个多边形，在罗本岛画了一个点，在恶魔岛画了一个点。

```
DECLARE @robben_island geography = ('POLYGON((18.351803 -33.788421,18.382788 -33.787494,18.386736 -33.820515,18.354464 -33.822369,18.351803 -33.788421))')
DECLARE @point_in_robben_island geography= ('POINT(18.369226 -33.80554)')
DECLARE @point_in_alcatraz geography= ('POINT(-122.423401 37.827006)')

SELECT @robben_island.STContains(@point_in_robben_island)   --returns 'False', but it's not what I expected
SELECT @robben_island.STContains(@point_in_alcatraz)        --returns 'True', but it's not what I expected 
```

如果我理解正确，上面的这个查询告诉我 my`@point_in_robben_island`不包含在 中`@robben_island`，而是我的 @point_in_alcatraz 存在于`@robben_island`其中，众所周知，这是不正确的。

现在，当我将数据类型从地理更改为几何时，一切正常，但我担心如果我继续使用几何数据类型，我可能会遇到一些问题。我只是想知道我是否不会受到几何学不能完全解释地球曲率这一事实的负面影响。摸木头。

```
DECLARE @robben_island geometry = ('POLYGON((18.351803 -33.788421,18.382788 -33.787494,18.386736 -33.820515,18.354464 -33.822369,18.351803 -33.788421))')
DECLARE @point_in_robben_island geometry= ('POINT(18.369226 -33.80554)')
DECLARE @point_in_alcatraz geometry= ('POINT(-122.423401 37.827006)')

SELECT @robben_island.STContains(@point_in_robben_island)   --returns 'True' as it should
SELECT @robben_island.STContains(@point_in_alcatraz)        --returns 'False' as it should 
```

现在我的问题是，为什么 geography 数据类型会返回意外的结果，而 geometry 按预期工作？非常感谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T08:52:15.640

地理类型比几何更严格一些。它不能跨越不同的半球，外圈必须逆时针绘制。

不幸的是（有些人认为这是一件好事），当您创建无效的地理位置时，SQL Server 2012 不再引发错误。您需要反转罗本岛几何中点的顺序，例如：

```
DECLARE @robben_island geography = ('POLYGON((18.351803 -33.788421, 18.354464 -33.822369,18.386736 -33.820515, 18.382788 -33.787494, 18.351803 -33.788421))')
DECLARE @point_in_robben_island geography= ('POINT(18.369226 -33.80554)')
DECLARE @point_in_alcatraz geography= ('POINT(-122.423401 37.827006)')

SELECT @robben_island.STContains(@point_in_robben_island)   --returns 'True'
SELECT @robben_island.STContains(@point_in_alcatraz)        --returns 'False' 
```

# .htaccess - 如果图像文件，RewriteRule 执行此操作，否则执行此操作

> ID：14693501
> 
> 赞同：0
> 
> 时间：2013-02-04T18:53:13.067
> 
> 标签：.htaccess, mod-rewrite, rewrite, yourls

我很难让它工作.. 我已经安装了 YOURLS，它是一个用于缩短 URL 的 PHP 脚本。为了工作，它需要有这个：

```
 RewriteEngine On
            RewriteBase /
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteRule ^(.*)$ /yourls-loader.php [L] 
```

这里没问题。但我也想使用与 PHP 脚本无关的图像托管目录。它会检查请求的 url 是否以 .jpg|.jpeg|.gif|.png 结尾，并且 RewriteRule 会重定向到 /imgshare/$1 我已经尝试了下面的代码，但是在访问 mysite.com/img 时出现服务器错误.jpg 但不适用于 url 重定向“mysite.com/y4Jd”：

```
 RewriteCond %{REQUEST_URI} !(\.jpg|\.jpeg|\.gif|\.png)$ [NC]
    RewriteRule ^(.*)$ /yourls-loader.php [L]
    RewriteCond %{REQUEST_URI} (\.jpg|\.jpeg|\.gif|\.png)$ [NC]
    RewriteRule ^(.*\.(jpeg|jpg|png|gif))$ /imgshare/$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:43:58.667

这不是问题，但请注意，您的第二个 RewriteCond 已经匹配具有图像结尾的文件，因此无需在 RewriteRule 中重复该匹配。或者，不需要 RewriteCond，因为它对 RewriteRule 是多余的。

然而，真正的问题可能是你在最终规则中有一个额外的斜线。$1 将包含与原始 URL 匹配的前导斜杠，因此您的规则当前`imgshare`在文件名和文件名之间添加两个斜杠。我会像这样执行规则：

```
RewriteCond %{REQUEST_URI} \.(jpg|jpeg|gif|png)$ [NC]
RewriteRule ^(.*)$ /imgshare$1 [L] 
```

# silverlight - 更改 Windows Phone 应用程序的 xaml 文件中的颜色分辨率

> ID：14693506
> 
> 赞同：0
> 
> 时间：2013-02-04T18:53:39.490
> 
> 标签：silverlight, windows-phone-7, xaml

在我的 WP7 应用程序中，我的一些图像上的渐变看起来很丑，我猜这是因为颜色分辨率低。如何在 XAML 中更改它？我知道XNA中有一种方法，但我不记得详细了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:06:55.723

如果您正在谈论的问题与渐变中可见的“带”有关，则需要调整`BitsPerPixel`应用清单中的属性。

详情[在这里](http://www.istartedsomething.com/20111113/death-to-banding-windows-phone-devs-please-upgrade-your-apps-to-32-bitsperpixel/)。[该设置在MSDN 官方文章](http://msdn.microsoft.com/en-us/library/ff769509%28v=VS.92%29)中也有提及。

# asp.net - 事件自动调用超类中的事件

> ID：14693507
> 
> 赞同：0
> 
> 时间：2013-02-04T18:53:50.587
> 
> 标签：asp.net, vb.net, events

如果在派生类型中调用事件，那么会自动调用基类型事件吗？例如，如果您在后面的代码中处理 .LOAD 事件，那么 Page.Load 是否会自动调用（来自 Page 类）？我通常会使用 Reflector 进行测试（通过单步执行代码），但试用期刚刚到期（我打算明天购买）。

# php - cakephp 2 自定义异常被忽略

> ID：14693508
> 
> 赞同：2
> 
> 时间：2013-02-04T18:53:52.427
> 
> 标签：php, exception-handling, selenium-webdriver, cakephp-2.1

我在我的 cake2 应用程序组件之一（[https://github.com/Nearsoft/PHP-SeleniumClient](https://github.com/Nearsoft/PHP-SeleniumClient)）中使用了出色的 PHP-SeleniumClient 类。当类抛出它自己的异常之一（例如找不到元素等）并且我想在 try/catch 块中捕获该执行时，将忽略 catch 语句。

相反，异常似乎被传递给 cake 自己的错误处理机制，该机制将异常呈现到视图中。有什么想法可以克服这个问题并确保 cake 的错误处理不处理第三方异常？

我已经在 cake 的 errorHandler.php 注释中找到了一些说明。例如，要创建自己的异常处理程序，请使用自定义渲染器或使用`AppController::appError();`. 但从那里我还是有点迷路。

非常感谢任何想法和解决方案。谢谢

# java - Java中括号的关键事件是什么？

> ID：14693512
> 
> 赞同：-3
> 
> 时间：2013-02-04T18:54:10.630
> 
> 标签：java, swing, key, awt

嗨，我怎样才能检测到**{**和**}**。我在[KeyEvent](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html)中没有找到它们的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:56:56.997

您正在寻找`VK_BRACELEFT`和`VK_BRACERIGHT`。

# google-app-engine - 使用java从谷歌云存储中读取文件

> ID：14693513
> 
> 赞同：2
> 
> 时间：2013-02-04T18:54:13.733
> 
> 标签：google-app-engine, gwt, servlets, google-cloud-storage

我是谷歌云存储 API 以及使用服务器的新手。我正在尝试使用 Eclipse 的 IDE 用 Ja​​va 编写一个 Web 应用程序，以读取存储在谷歌云存储中的文件。我有要在服务器端读取文件的代码，但不知道如何修改客户端的示例代码，以便它支持 httpServlet 而不是 RemoteServiceServlet。任何帮助或建议将不胜感激！

下面是我在服务器端的代码。

```
package com.google.gwt.sample.interfacecloud.server;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.nio.channels.Channels;
import java.util.ArrayList;

import javax.servlet.http.*;
import com.google.gwt.sample.interfacecloud.client.GreetingService;

import com.google.appengine.api.files.AppEngineFile;
import com.google.appengine.api.files.FileReadChannel;
import com.google.appengine.api.files.FileService;
import com.google.appengine.api.files.FileServiceFactory;
import com.google.appengine.api.files.FileWriteChannel;
import com.google.appengine.api.files.GSFileOptions.GSFileOptionsBuilder;

@SuppressWarnings("serial")
public class CloudInteraction extends HttpServlet implements GreetingService{
public static final String BUCKETNAME = "obd_data";
public static final String FILENAME = "data.txt";

@Override
public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException
{
    resp.setContentType("text/plain");

    String filename = "/gs/" + BUCKETNAME + "/" + FILENAME;
    FileService fileService = FileServiceFactory.getFileService();
    AppEngineFile readableFile = new AppEngineFile(filename);
    FileReadChannel readChannel =
            fileService.openReadChannel(readableFile, false);
    BufferedReader reader = 
            new BufferedReader(Channels.newReader(readChannel, "UTF8"));
    String line = reader.readLine();
    resp.getWriter().println("READ:"+line);
    System.out.println(line);
    readChannel.close();
}

@Override
public String greetServer(String name) throws IllegalArgumentException {
    // TODO Auto-generated method stub
    return null;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T05:57:01.520

您正在将 RPC 与普通 Servlet 混合和匹配。你不应该那样做。如果您打算使用纯 Servlet，请取消用于此类交互的 RPC 接口。在这种情况下，使用 RequestBuilder 会更好。注意-您的要求不是很清楚？

# erlang - 为什么需要使用enif_compare？

> ID：14693514
> 
> 赞同：2
> 
> 时间：2013-02-04T18:54:15.717
> 
> 标签：erlang

为什么

```
int enif_compare(ERL_NIF_TERM lhs, ERL_NIF_TERM rhs) 
```

需要使用而不仅仅是

```
if( lhs == rhs ) return 1; 
```

我相信我比较原子很重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:20:46.887

ERL_NIF_TERM 是一种不透明的数据类型，据我所知，它更类似于*指针*而不是值。事实上，这里是定义：（`typedef unsigned long ERL_NIF_TERM`技术上有一些变体，但它们都是整数*，与系统上的内存地址大小相同*）

因此，您必须使用 enif_compare，原因`str_cmp`与比较 C 字符串时必须使用的原因相同：引用的值可能相同，但您获得的值并不代表这一点。

考虑：

```
char a[] = "test";
char b[] = "test";
printf("%d\n", a == b); 
```

从逻辑上讲，您和我都知道字符串是相同的，但值`a`和`b`实际上是指向所包含值的指针。因此，当您进行常规比较 ( `==`) 时，它比较的是*指针*，而不是基础值。由于它们在函数中是不同的值，因此它们被分配到不同的内存地址，因此，`a != b`, 但是`str_cmp(a, b) == true`

# jira - Jira - JQL 报告显示 30 天内解决/创建的票证的平均数量

> ID：14693516
> 
> 赞同：1
> 
> 时间：2013-02-04T18:54:21.737
> 
> 标签：jira, jql

我试图弄清楚如何创建一个 JQL 查询，该查询将拉回过去 30 天内已解决票证的平均数量以及过去 30 天内创建的票证的平均数量......

我在 Jira 中使用了创建的已解决报告，这很棒，但现在我只需要计算平均值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:23:13.477

[我很确定使用开箱即用的 JQL](https://confluence.atlassian.com/display/JIRA/Advanced+Searching)无法实现这一点。

您可以使用 Jira 的[远程 API](https://developer.atlassian.com/display/JIRADEV/JIRA+Remote+API+Reference)轻松完成此操作，例如使用[jira-python ：](http://jira-python.readthedocs.org/en/latest/)

```
from jira.client import JIRA
jira = JIRA(basic_auth=('admin', 'admin'))    # a username/password tuple
props = jira.application_properties()
# Find all issues from the last month:
issuesResolved = jira.search_issues('resolved > startOfMonth()')
issuesCreated  = jira.search_issues('created > startOfMonth()')
# and so on... 
```

输出应该是什么？过去 30 天平均每天？平均每30个月？

无论如何，如果你需要帮助编码，让我知道......祝你好运！

# android - Android Facebook 3.0 SDK, Request Dialog, install, access to data 属性

> ID：14693519
> 
> 赞同：0
> 
> 时间：2013-02-04T18:54:40.637
> 
> 标签：android, facebook, dialog, request

Facebook 的 3.0 SDK 中的请求对话框创建了一个非常好的体验，用于从一个用户在应用程序内向可能已经或可能没有安装相同应用程序的另一个用户发送邀请。

该文档清楚地描述了如何通过该请求传递其他数据。在收件人已经安装了应用程序的情况下，看起来很容易读取这些数据。

我想知道的是，如果收件人必须先安装应用程序，是否有某种方法可以读取数据？我的直觉说不，用户必须再次单击通知才能在安装后启动应用程序。但也许有一些 Facebook 魔术酱来获取这些数据？有人知道吗？

我想要这些数据，以便为发件人提供安装信用。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:04:22.720

> 我想知道的是，如果收件人必须先安装应用程序，是否有某种方法可以读取数据？

不，确实没有，因为您需要请求 id 和用户 id 的组合来读取`data`值 - 如果用户尚未连接到您的应用程序，您不会获得用户 id。

# int - 动力学 AX 中的 bigint 等价物是什么？

> ID：14693520
> 
> 赞同：2
> 
> 时间：2013-02-04T18:54:45.327
> 
> 标签：int, x++, axapta, bigint

我需要使用一种数据类型来存储整数值，但我需要与 BigInt 等效的数据类型。Dynamics AX 中有吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T20:01:03.017

要在 X++ 中定义 64 位整数变量，请使用`int64`.

[整数 AX 2012](http://msdn.microsoft.com/EN-US/library/aa851966.aspx "整数")

[整数 AX 2009](http://msdn.microsoft.com/en-gb/library/aa851966%28v=ax.50%29.aspx)

# javascript - 在 Mongoose 中加载后更改模型值

> ID：14693523
> 
> 赞同：12
> 
> 时间：2013-02-04T18:54:58.607
> 
> 标签：javascript, node.js, mongoose

在我的猫鼬模型中，我有一些`stats`依赖于时间。我的想法是在模型加载后立即添加一个[中间件](http://mongoosejs.com/docs/middleware.html)来更改这些统计信息。

不幸的是，关于`post`-Hooks 的文档有点不够清晰。看来我可以使用这样的钩子：

```
schema.post('init', function(doc) {
    doc.foo = 'bar';
    return doc;
}); 
```

他们唯一的例子涉及`console.log`- 输出。它没有以任何方式解释是否`doc`必须返回或者根本不可能更改 post-Hook（因为它不是异步的，复杂的想法可能几乎没有用处）。

如果`pre`on`'init'`不是在加载时自动更新模型的正确方法，那是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-04T19:39:13.947

这就是我们如何在加载时更新模型，异步工作：

```
schema.pre('init', function(next, data) {
  data.property = data.property || 'someDefault';
  next();
}); 
```

Pre-init 比较特殊，其他钩子的签名略有不同，例如 pre-save：

```
schema.pre('save', function(next) {
  this.accessed_ts = Date.now();
  next();
}); 
```

# objective-c - 在第二个 NSOperation 尝试写入之后，NSOutputStream 总是在等待可用空间

> ID：14693524
> 
> 赞同：0
> 
> 时间：2013-02-04T18:54:59.617
> 
> 标签：objective-c, nsoperation, nsoperationqueue, nsoutputstream

我正在创建一个`NSOutputStream`并将其传递给一个`NSOperation`，我从一个调用它`NSOperationQueue`。在操作中，我正在轮询`hasSpaceAvailable`以便我可以写出到套接字。这在我第一次写入套接字时工作正常。然而，在操作返回后，我尝试再次写入套接字，写入永远不会完成，因为我无限地等待输出套接字中的空间可用。每次写入时我都尝试打开/关闭输出流，但遇到了同样的问题。

我在 init 函数中打开输出流（`NSOutputStream`从蓝牙创建`EASession`：

```
_commandSession = [[EASession alloc] initWithAccessory:self.selectedAccessory forProtocol:commandProtocolString];
_commandOutputStream = [_commandSession outputStream];
[_commandOutputStream open]; 
```

我还在 init 中创建了操作队列：

```
_senderOperationQueue = [[NSOperationQueue alloc] init];
_senderOperationQueue.name = @"Send Queue";
_senderOperationQueue.maxConcurrentOperationCount = 1; 
```

我有一个文本字段，其中包含要通过输出流发送的数据。每次单击发送按钮时都会调用此函数：

```
-(void)sendCommandData:(NSData *)buf
{
  _commandSendOperation =[[SenderOperation alloc] initWithStream:_commandOutputStream data:buf delegate:self];
  [_senderOperationQueue addOperation:_commandSendOperation];
} 
```

这是我的操作代码的样子：（`SenderOperation.h`）

```
#import <Foundation/Foundation.h>

@protocol SenderOperationDelegate;

@interface SenderOperation : NSOperation
{
    NSOutputStream *_stream;
    NSData *_sendData;
}

@property (nonatomic, assign) id <SenderOperationDelegate> delegate;
@property (nonatomic, retain) NSOutputStream *stream;
@property (nonatomic, retain) NSData *sendData;

- (id)initWithStream:(NSOutputStream *)stream data:(NSData *)buf delegate:(id<SenderOperationDelegate>)theDelegate;

@end

// Delegate to notify main thread the completion of a BT input buffer stream
@protocol SenderOperationDelegate <NSObject>
-(void)sendComplete:(SenderOperation *)sender;
@end 
```

( `SenderOperation.m`)

```
#import "SenderOperation.h"

@implementation SenderOperation

@synthesize delegate = _delegate;
@synthesize stream = _stream;
@synthesize sendData = _sendData;

- (id)initWithStream:(NSOutputStream *)stream data:(NSData *)buf delegate:(id<SenderOperationDelegate>)theDelegate
{
  if (self = [super init])
  {
    self.delegate = theDelegate;
    self.stream = stream;
    self.sendData = buf;
  }
  return self;
}

#define MAX_PACKET_SIZE 20

- (void)main
{
  if (self.isCancelled)
    return;

// total length of the data packet we need to send
int totalLength = [_sendData length];

// length of packet to send (given our upper bound)
int len = (totalLength <= MAX_PACKET_SIZE) ? totalLength:MAX_PACKET_SIZE;

// stream write response
int streamWriteResponse;

// bytes already written out to the output stream
int bytesWritten = 0;

while (1)
{
 if (!len) break;

 if ([self.stream hasSpaceAvailable])
 {
   streamWriteResponse = [self.stream write:[self.sendData bytes] maxLength:len];

   if (streamWriteResponse == -1)
   {
    break;
   }

  bytesWritten += streamWriteResponse;

  // update the data buffer with left over data that needs to be written
  if (totalLength - bytesWritten)
    self.sendData = [self.sendData subdataWithRange:NSMakeRange(bytesWritten, totalLength - bytesWritten)];

  // update length of next data packet write
  len = (totalLength - bytesWritten) >= MAX_PACKET_SIZE ? MAX_PACKET_SIZE : (totalLength - bytesWritten);
  }
}

[(NSObject *)self.delegate performSelectorOnMainThread:@selector(sendComplete:) withObject:self waitUntilDone:NO];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:35:52.097

您需要对流使用运行循环调度，而不是轮询。Quoth[的文档`-[EASession outputStream]`](http://developer.apple.com/library/ios/documentation/ExternalAccessory/Reference/EASession_class/Reference/Reference.html#//apple_ref/occ/instp/EASession/outputStream)：

> 此流由会话对象自动为您提供，但如果您想接收任何关联的流事件，则必须对其进行配置。为此，您可以将委托对象分配给实现`stream:handleEvent:`委托方法的流。然后，您必须在运行循环中安排流，以便它可以从您的应用程序线程之一异步发送数据。

# asp.net-mvc - ASP MVC，带有单个控制器的多个模型/带有 EF 的视图

> ID：14693525
> 
> 赞同：0
> 
> 时间：2013-02-04T18:55:03.440
> 
> 标签：asp.net-mvc, entity-framework

有人可以向我解释如何在单个视图中使用多个模型，其中每个模型代表一个数据库表吗？

我目前所做的是为每个模型创建一个模型文件。

示例模型：

```
[Table("Order")]
public class OrderModel
{
    [Key, Column(Order = 0)]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int OrderID { get; set; }

    [Key, Column(Order = 1)]
    public int UserID { get; set; }
    public UserProfile Account { get; set; }

    public DateTime Date { get; set; }
    public int ShipLocation { get; set; }
    public string PONumber { get; set; }

    public int StatusID { get; set; }
    public StatusModel Status { get; set; }
} 
```

这是包含在单个控制器/视图中使用的所有模型的另一个模型。

```
public class OrderPlacementModel
{
    public OrderModel OrderChild { get; set; }
    public OrderItemsModel OrderItemsChild { get; set; }
    public StatusModel StatusChild { get; set; }
    public MaterialsModel MaterialsChild { get; set; }
    public CategoryModel CategoryChild { get; set; }
    public PackModel PackChild { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:01:28.117

```
public ActionResult PlaceOrder()
{
  var viewModel = new OrderPlacementModel
  {
    OrderChild = new OrderModel(),//or fetch this object from your data source
    OrderItemsChild = new OrderItemsChild(),
    //...etcetera
  };
  return View(viewModel);
} 
```

**编辑**

或者，如果您将视图强输入到 a`List<OrderPlacementModel>`而不是单个实例，则可以执行类似以下操作：

```
public ActionResult PlaceOrder()
    {
      var viewModel = new List<OrderPlacementModel>();
      var model = new OrderPlacementModel
      {
        OrderChild = new OrderModel(),//or fetch this object from your data source
        OrderItemsChild = new OrderItemsChild(),
        //...etcetera
      };
      viewModel.Add(model);
      //lather, rinse, repeat for however many instances you need to send to your view.
      return View(viewModel);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T21:19:10.300

Ideally, you should create a **view model** for the view that encompasses the fields from each model that you need to expose via the view. You can then map these in your controller. I would keep your **mapping classes** completely ignorant of your **view models**. Keep your views independent of your data model.

```
public class OrderViewModel
{
    public int OrderId { get; set; }
    public int UserId { get; set; }
    public DateTime Date { get; set; }
    public int ShippingLocation { get; set; }

    public List<ItemViewModel> Items { get; set; }
}

public class ItemViewModel
{
    public int ItemId { get; set; }
    public int Title { get; set; }
} 
```

Note how I have created a view model for the order and - to allow the order have multiple items - have separated these out into a separate model class. Now, you can type your view to `OrderViewModel` and use as many instances of `ItemViewModel` as your require.

You can then map your viewmodels to database entities from your controller:

```
[HttpPost]
public ActionResult ConfirmOrder (OrderViewModel model)
{
    if (ModelState.IsValid)
    {
        foreach (ItemViewModel item in model.Items)
        {
            /* Create instance of OrderItemsModel (or whatever your
            DB mapping class is), populate with appropriate data
            from 'item' and commit to database. */
        }

        OrderModel order = new OrderModel();
        order.OrderId = model.OrderId;
        order.UserId = model.UserId;
        order.Date = model.Date;
        order.ShipLocation = model.ShippingLocation;

        /* TODO: Commit new order to database */

    }
} 
```

Doing things this way adds a little overhead to your initial development time but allows you a great deal more flexibility as you aren't forced to mould all of your views to the shape of your entity classes.

# mysql - 使 appharbor 与现有的 mysql 服务器一起工作

> ID：14693528
> 
> 赞同：0
> 
> 时间：2013-02-04T18:55:24.273
> 
> 标签：mysql, asp.net-mvc-3, appharbor

当我在上传之前处理我的项目（asp.net mvc 3）时，我需要让它引用一个已经存在的 mysql 数据库。没有/没有移动或克隆该数据库的选项，我必须在我的 C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\machine.config 文件中添加一段代码才能制作它兼容的。

如何在不移动数据库的情况下使其在 appharbor 上运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:56:46.810

您应该能够使用`mysqldump`将数据移动到在[AppHarbor MySQL 插件](https://appharbor.com/addons/mysql)上下文中运行的数据库。[这是一个指南](http://julianschrader.de/20090221-mysql-moving-databases-easily-with-mysqldump/)。

如果您当前的数据库是可公开访问的，那么如果您将 AppHarbor 应用程序配置为使用它，它也应该可以工作。如果您需要打开防火墙，您可以[在此处](http://support.appharbor.com/kb/tips-and-tricks/application-server-ips-ec2-configuration)找到 AppHarbor 应用服务器 IP 。

# r - 在 matlab 函数中处理 NaN

> ID：14693536
> 
> 赞同：3
> 
> 时间：2013-02-04T18:55:57.550
> 
> 标签：r, matlab, function, matrix, nan

我想知道matlab是否有内置的方法来处理`NaN`函数调用中的's。更具体地说，我试图取其中包含 a 的向量的平均值`NaN`。例如，在 R

```
> x = c(1,2,3,4,NA)
> mean(x)
[1] NA
> mean(x,na.rm=TRUE)
[1] 2.5 
```

在 Matlab 中是否有与此类似的东西在一行中（我不想编写自己的函数，也不想`NaN`在计算平均值之前循环查找 's ）。

此外，我无权访问统计工具箱，因此无法使用`nanmean()`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:10:49.620

你可以做类似的事情`mean(x(~isnan(x)))`。如果你愿意，你也可以像这样编写一堆包装器并将它们放在你的 startup.m 文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-06T23:06:21.007

从 MATLAB 2015a 开始，[`mean`支持额外参数`nanflag`](http://www.mathworks.com/help/releases/R2015a/matlab/ref/mean.html#inputarg_nanflag). 使用 JoErNanO 的答案中的示例，

```
A = [1 0 NaN; 0 3 4; 0 NaN 2];
mean(A, 'omitnan')
% = [0.333333333333333 1.5 3] 
```

该参数的默认值为`includenan`，它将返回`NaN`包含`NaN`s 的列/行。

`median`, `cov`, `min`, `max`, `sum`,`var`也`std`支持忽略`NaN`s。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T19:12:36.220

我认为这应该有效：

```
mean(x(isfinite(x))); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-06T15:22:40.573

## 矩阵呢？

正如 Karthik V 所建议的，

```
mean(x(~isnan(x))) 
```

将适用于向量。但是，如果您有一个 n×m 矩阵并希望计算行/列方式意味着丢弃偶尔的 NaN，您将不得不运行一个 for 循环。

## 示例场景

想象一个如下形式的数据矩阵：

```
A = [1 0 NaN; 0 3 4; 0 NaN 2]

A =
 1     0   NaN
 0     3     4
 0   NaN     2 
```

运行`mean(A(~isnan(A)))`产量：

```
ans =

1.4286 
```

这是因为逻辑索引有效地将矩阵“展平”为向量。

## 循环解决方案（按列均值）

假设您要计算按列的平均值，则循环解决方案将变为：

```
% Preallocate resulting mean vector
nCols = size(A, 2);
mu = zeros(1, nCols);

% Compute means
for col = 1:nCols
    mu(col) = mean(A(~isnan(A(:, col)), col));
end 
```

导致：

```
mu =

0.3333    1.5000    3.0000 
```

## 循环解决方案（逐行均值）

假设您要计算逐行平均值，则循环解决方案将变为：

```
% Preallocate resulting mean vector
nRows = size(A, 1);
mu = zeros(nRows, 1);

% Compute means
for row = 1:nRows
    mu(row) = mean(A(row, ~isnan(A(row, :))));
end 
```

导致：

```
mu =

0.5000
2.3333
1.0000 
```

# ruby-on-rails - 在 Heroku 上托管的 ROR 中，在具有不同前端但后端相同的 2 个站点上显示一个应用程序

> ID：14693542
> 
> 赞同：0
> 
> 时间：2013-02-04T18:56:22.293
> 
> 标签：ruby-on-rails, postgresql, heroku

我在 Rails 中有一个应用程序并托管在 Heroku 上。现在，我想要的是可以从 2 个不同的域访问应用程序，当从假设 a.com 访问应用程序时，它应该有一个特定的前端，当从 b.com 访问时，它应该显示其他一些前端。两者的后端应该相同。为了实现这一点，我想只有一种方法，那就是让两个不同的应用程序具有相同的支持代码和相同的数据库（我使用的是 PostgreSQL）。我需要一些关于如何实现这一点的帮助，如果没有，那么还有其他选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:00:47.867

如果对你来说更容易的话，你可以只为这两个应用程序提供一个应用程序。然后，我建议您配置 config/routes.rb 以根据域名做出不同的响应。

在这里查看另一个答案：[Rails routing to handle multiple domain on single application](https://stackoverflow.com/questions/4207657/rails-routing-to-handle-multiple-domains-on-single-application)

以及 Rails 中的高级约束：http: [//guides.rubyonrails.org/routing.html#advanced-constraints](http://guides.rubyonrails.org/routing.html#advanced-constraints)

# android - Android：保存上次打开的活动

> ID：14693543
> 
> 赞同：0
> 
> 时间：2013-02-04T18:56:25.157
> 
> 标签：android

我正在开发一个分阶段玩的游戏。现在这里是 xml 开始 > 阶段列表的流程。当我按下开始按钮时，我将被定向到包含 5 个按钮的阶段页面，该按钮名为阶段 1 到阶段 5，但阶段 2 到阶段 5 的按钮目前被禁用。如果用户完成第 1 阶段，它将启用。我想要做的是，如果我解锁第 2 阶段然后我终止应用程序，当我按下开始按钮后再次打开它时，我想看到第 2 阶段已经解锁。我怎样才能做到这一点？发生的事情是当我终止然后按下开始按钮后再次启动时，我完成的最后一个阶段仍然解锁。在用户解锁的每个阶段都应该保存，这样如果使用返回按钮或主页键关闭游戏，用户解锁的最后一个阶段仍然保存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:07:13.180

您可以使用 SharedPreferences 保存游戏进度（阶段）：http: [//developer.android.com/guide/topics/data/data-storage.html#pref](http://developer.android.com/guide/topics/data/data-storage.html#pref)。您可以在每次用户传递到下一个级别或内部`onPause`方法时保存进度（只有当用户离开您的应用程序时才会保存进度）。在您的`onCreate`方法中，您可以检索此值并以适当的进度开始游戏。

# python - 包含 self 时正好有 2 个参数（1 个给定）

> ID：14693545
> 
> 赞同：-1
> 
> 时间：2013-02-04T18:56:35.297
> 
> 标签：python, self

每次我调用我的函数时`def hello(self,value)`，我都会收到一个错误：`takes exactly 2 arguments (1 given)`那我该怎么办？

或者是否有另一种可能性来做到这一点：`self.statusitem.setImage_(self.iconsuccess)`？

编辑：

我的代码的简单表示

```
Class A:
   func_in_class_B(value)

Class B:
def finishLaunching(self):
   self.statusitem.setImage_(self.icon)
def func_in_class_B(self,value)
   self.statusitem.setImage_(self.iconsuccess) 
```

A类是后台线程，B类是我的主线程，我想操作`self.statusitem.setImage_(self.icon)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:01:00.010

听起来您没有正确调用 hello 函数。给定以下类定义：

```
class Widget(object):
    def hello(self, value):
        print("hello: " + str(value)) 
```

您可能将其称为静态函数，如下所示：

```
Widget.hello(10) 
```

这意味着没有小部件类的实例作为第一个参数传递。您需要将 hello 函数设置为静态：

```
class Widget(object):
    @staticmethod
    def hello(value):
        print("hello: " + str(value))

Widget.hello(10) 
```

或像这样在特定对象上调用它：

```
widget = Widget()
widget.hello(10) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:07:22.297

这很可能是因为您的 hello 函数不是类成员。在这种情况下，您不需要在方法声明中提供 self ......即，而不是 hello(self,value) 只需说 hello(value)

例如......这个片段工作得很好

```
def hello(value):
    print 'Say Hello to ' + value

hello('him') 
```

如果不是这种情况，请提供您的代码片段以进一步帮助您。

# mediaelement.js - Mediaelement.js Firefox Flash 插件 - 控件不加载

> ID：14693549
> 
> 赞同：3
> 
> 时间：2013-02-04T18:56:52.833
> 
> 标签：mediaelement.js

如果我只在音频元素上提供 mp3 文件，Firefox 应该回退到 Flash 插件（如 MediaElement.js 主页上）。但是在我的例子中，创建了 MediaElement 包装器，创建了嵌入插件，但没有添加任何控件（例如播放/暂停）。我花了很多时间尝试调试它，但我无法确定哪里出了问题。控制台中没有错误，也没有触发错误回调。任何关于我下一步可以尝试的想法将不胜感激！

更新 - 已解决：啊！flashmediaelement.swf 文件的路径存在问题。我必须使用绝对 URL。例如：

```
$('audio').mediaelementplayer({
        plugins:['flash'], pluginPath:'http://www.mysite.com/path/to/libs/mediaelement/'}); 
```

# fortran - Fortran 斐波那契问题

> ID：14693551
> 
> 赞同：2
> 
> 时间：2013-02-04T18:57:01.363
> 
> 标签：fortran

我正在研究 Metcalf、Reid 和 Cohen 的“现代 Fortran 解释”，在第四章中，它指定了一个斐波那契程序作为家庭作业问题。我下面的代码无法编译。我该如何纠正？

```
 !  Fibonacci here we go
    integer :: lim, i
    lim=0
    read *, lim

    integer, dimension(lim) :: fib

    if( lim >= 1 )
        fib(1) = 0
    end if

    if( lim >= 2 )
        fib(2) = 1
    end if

    if( lim >= 3 )
        fib(3) = 1
    end if

    do i=4, lim
        fib(i) = fib(i-2) + fib(i-1)
    end do

    do i=1, size(fib)
        print *, fib(i)
    end do

    end 
```

另外，这是我遇到的错误。我会尝试将其缩短为所需的内容，但我不确定在查看 Fortran 错误日志时需要什么。

```
Compiling the source code....
$/usr/bin/gfortran /tmp/135997827718658.f95 -o /tmp/135997827718658 2>&1
In file /tmp/135997827718658.f95:7

integer, dimension(lim) :: fib
1
Error: Unexpected data declaration statement at (1)
In file /tmp/135997827718658.f95:9

if( lim >= 1 )
1
Error: Unclassifiable statement in IF-clause at (1)
In file /tmp/135997827718658.f95:10

fib(1) = 0
1
Error: Unclassifiable statement at (1)
In file /tmp/135997827718658.f95:11

end if
1
Error: Expecting END PROGRAM statement at (1)
In file /tmp/135997827718658.f95:13

if( lim >= 2 )
1
Error: Unclassifiable statement in IF-clause at (1)
In file /tmp/135997827718658.f95:14

fib(2) = 1
1
Error: Unclassifiable statement at (1)
In file /tmp/135997827718658.f95:15

end if
1
Error: Expecting END PROGRAM statement at (1)
In file /tmp/135997827718658.f95:17

if( lim >= 3 )
1
Error: Unclassifiable statement in IF-clause at (1)
In file /tmp/135997827718658.f95:18

fib(3) = 1
1
Error: Unclassifiable statement at (1)
In file /tmp/135997827718658.f95:19

end if
1
Error: Expecting END PROGRAM statement at (1)
In file /tmp/135997827718658.f95:22

fib(i) = fib(i-2) + fib(i-1)
1
Error: Statement function at (1) is recursive
Error: Unexpected end of file in '/tmp/135997827718658.f95' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:15:59.380

随机修复....

如果块应该是

```
if (condition) then
  do something
endif 
```

不能省略“则”。

你不能去

```
read *, lim
integer, dimension(lim) :: fib 
```

所有声明都必须在可执行代码之前。所以改为使用可分配数组

```
integer, dimension(:), allocatable :: fib
read *, lim
allocate(fib(lim)) 
```

# java - javax.servlet.FilterChain 的目的是什么？

> ID：14693553
> 
> 赞同：5
> 
> 时间：2013-02-04T18:57:02.153
> 
> 标签：java, servlets, servlet-filters

我继承了一个 Struts 1 应用程序，该应用程序大量使用了 FilterChain，但我不明白这个极其混淆代码的好处。

“在 Servlet API 中，当您想要控制、预处理和/或后处理特定请求时，通常会使用 Servlet。但是当您想要根据特定条件过滤/修改常见请求和/或响应时，过滤器要多得多合适的。”

我的应用程序中的每个请求都基于特定条件，例如商家 ID 或搜索词。但似乎将一个请求放在一个完整的东西链中，完全隐藏了开发人员试图追踪错误原因的情况，这是疯了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T19:11:10.407

该[`FilterChain#doFilter()`](http://docs.oracle.com/javaee/6/api/javax/servlet/FilterChain.html#doFilter%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29)调用只是将 HTTP 请求*继续*到目的地，遵循与您一开始没有使用过滤器完全相同的路径。这通常是一个 servlet 类，甚至是一个 JSP 文件。因此，为了调试有问题的代码，最好在目标代码中放置一个断点，如果它不包含任何感兴趣的代码，则不要在过滤器中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-04T19:28:56.557

我的同事（未在 SO 上注册）解释说，这是为了将全局功能应用于您不想在每个控制器中执行的应用程序，例如检查用户是否已登录。

# sql-server - 将多个文本字段合并为一个文本字段

> ID：14693556
> 
> 赞同：1
> 
> 时间：2013-02-04T18:57:07.940
> 
> 标签：sql-server, sql-server-2000

我正在尝试将多个文本列合并到一个串联的文本列中。每个字段以前都用于各种描述，但根据新的要求，我需要将所有这些字段组合成一个。

我尝试先将它们转换为 varchar(max) 然后连接，但有些行在这些列中的值比最大值长，并且在结果中被截断。

有没有办法在 SQL Server 2000 中组合多个文本字段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T18:59:03.553

我对你最好的建议是

1.  在中间层或表示层中执行连接（或添加允许此操作的抽象层，包括通过更新版本的 SQL Server 路由查询，该版本在将链接服务器拉到 2000 后执行连接）；或者，
2.  **升级**。

您无法欺骗 SQL Server 2000 支持，而您遇到的限制只是数据类型被弃用`[n]varchar(max)`的众多原因之一。`[n]text`

# android - UnsatisfiedLinkError: n_Mat while using opencv2.4.3 with android 4.0

> ID：14693558
> 
> 赞同：8
> 
> 时间：2013-02-04T18:57:18.643
> 
> 标签：android, opencv, logcat, mat

我在android中使用opencv。但是当我在我的代码中添加 Mat() 时，我的应用程序在启动后意外停止。我的错误日志如下：

```
FATAL EXCEPTION: main
java.lang.UnsatisfiedLinkError: n_Mat
at org.opencv.core.Mat.n_Mat(Native Method)
at org.opencv.core.Mat.<init>(Mat.java:441)
at com.example.imagepro.MainActivity.onCreate(MainActivity.java:36)
at android.app.Activity.performCreate(Activity.java:4465)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
at android.app.ActivityThread.access$600(ActivityThread.java:123)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)     
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method)` 
```

我的代码是

```
import java.io.File;
import org.opencv.android.BaseLoaderCallback;
import org.opencv.android.LoaderCallbackInterface;
import org.opencv.android.OpenCVLoader;
import org.opencv.core.Mat;

import org.opencv.android.Utils;
import org.opencv.imgproc.Imgproc;

import android.os.Bundle;
import android.os.Environment;
import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.ImageView;

public class MainActivity extends Activity {

final String TAG = "Hello World";
Mat imgToProcess;

private BaseLoaderCallback mOpenCVCallBack = new BaseLoaderCallback(this) {
@Override
public void onManagerConnected(int status) {
   switch (status) {
       case LoaderCallbackInterface.SUCCESS:
       {
      Log.i(TAG, "OpenCV loaded successfully");
      // Create and set View
      setContentView(R.layout.activity_main);
       } break;
       default:
       {
      super.onManagerConnected(status);
       } break;
   }
    }
};

@Override
protected void onCreate(Bundle savedInstanceState) {

     Log.i(TAG, "onCreate");
        super.onCreate(savedInstanceState);

        Log.i(TAG, "Trying to load OpenCV library");
        if (!OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_2_4_3, this, mOpenCVCallBack))
        {
          Log.e(TAG, "Cannot connect to OpenCV Manager");
        }
        else{ Log.i(TAG, "opencv successfully added"); }

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    String path = Environment.getExternalStorageDirectory()+ "/Koala.jpg"; // get image from sd card

     File imgFile = new File(path);

     View v = null;
          if(imgFile.exists())
 {
          Bitmap myBitmap = BitmapFactory.decodeFile(path);                 
         ImageView myImage = (ImageView) findViewById(R.id.imageView);
         myImage.setImageBitmap(myBitmap);
         Log.i(TAG, "opencv successfull 1");
         Mat imgToProcess = new Mat();
         Mat newmat = new Mat();

         Utils.bitmapToMat(myBitmap, imgToProcess); 
         Imgproc.cvtColor(imgToProcess, newmat, Imgproc.COLOR_RGB2GRAY); 
 Bitmap outImage = Bitmap.createBitmap(newmat.rows(),newmat.cols(),Bitmap.Config.ARGB_8888);
         Utils.matToBitmap(newmat, outImage);

         myImage.setImageBitmap(outImage); 

   }

 } 
```

}

我尝试了 stackoverflow 上提供的其他解决方案，但没有一个对我有用。我已经将 libopencv_java.so 和 libopencv_info.so 从 F:\OpenCV-2.4.3.2-android-sdk\sdk\native\libs\armeabi-v7a 复制到我的 /libs 文件夹中，但是这个错误仍然存​​在。

请帮忙。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-28T08:26:10.510

有人提示我详细地发布我的答案，这很好。所以在这里我发布我的问题的解决方案：

```
private BaseLoaderCallback mOpenCVCallBack = new BaseLoaderCallback(this) {
     @Override
     public void onManagerConnected(int status) {
       switch (status) {
           case LoaderCallbackInterface.SUCCESS:
           {
              Log.i(TAG, "OpenCV loaded successfully");
              startDisplay();

           } break;

           default:
           {
               super.onManagerConnected(status);
           } break;
         }
      }
 };

    @Override
    protected void onCreate(Bundle savedInstanceState) {

         super.onCreate(savedInstanceState);
         Log.i(TAG, "Trying to load OpenCV library");
         if (!OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_2_4_3, this, mOpenCVCallBack))
         {
           Log.e(TAG, "Cannot connect to OpenCV Manager");
         }
         else{ Log.i(TAG, "opencv successfull"); 
         System.out.println(java.lang.Runtime.getRuntime().maxMemory()); }
         setContentView(R.layout.frameview);
    } 
```

这个错误背后的问题是我们在opencv初始化之前调用了opencv依赖函数（例如：Mat（）），所以它显示错误。因此，如果您将 opencv 函数放在 onManagerConnected() 中，则可以解决它，如下所示：

```
Log.i(TAG, "OpenCV loaded successfully");
startDisplay(); 
```

在这里， startDisplay() 包含我的 Mat() 初始化。问题是当我们启动一个应用程序时，oncreate() 函数首先执行，然后 opencv 被加载，所以如果你把你的 opencv 函数放在 oncreate() 中，那么它会显示错误，因为 opencv 尚未加载。

我希望这能解决你的问题。祝你好运... Stackoverflow 摇滚！！！:)

# c# - 我应该使用小数类型作为字典中的键吗？

> ID：14693561
> 
> 赞同：5
> 
> 时间：2013-02-04T18:57:23.487
> 
> 标签：c#, .net, dictionary, key, decimal

我即将创建一个字典，其中每个值都有一个数字键，通过实验计算获得。

我知道`double`任何其他浮点类型都不太适合用作键，因为很难比较两个浮点数的唯一性或相等性。

有谁知道在`Decimal`这方面是否是一个好的候选人？另一种方法是将双精度转换为具有给定精度的字符串，但这对我来说听起来像是一种不雅的解决方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T19:08:28.690

在字典中使用`float`或作为键没有太大区别。`decimal`两者都用指数表示数字 - 所以两者都遭受相同的比较问题，只是规模不同。

如果您需要按位相等，则 Dictionary 都可以，如果您需要“大约相同的值”的键，则需要将其设为自定义键，该键将以某种已知的方式舍入值以将相似的结果放在同一个存储桶中。 ..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:13:24.530

如果你正在使用`decimal`或者`double`因为`int`不够大，可以考虑`long`改用。

另外，我认为比较`decimal`s 或`double`s 应该没问题，只要没有小数/小数部分，并且只包含整数（-1,0,1,2,3 等）

（虽然我不建议在比较重要的地方使用`decimal`/`double`以避免将来出现任何意外错误）

如果您只处理 6 位精度，那么转换为`int`应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-18T17:20:41.417

我知道这是一个老问题，但我相信我的回答可以帮助某人。

我真的需要浮动键。

当然，我遇到了精度问题，而且我的字典比它需要的大得多（我希望它例如`1.0`并被`0.999998`视为相同）。使用固定数量的十进制数字并不是一个很好的解决方案（例如，按照 OP 的建议将其转换为字符串），因为它使用绝对误差进行比较，而相对误差更为普遍。

我最终写了以下方法：

```
float Quantize(float x)
{
    const float relMaxQuantError = 0.001f;

    float ret = Mathf.Log10(Mathf.Abs(x));
    float quantum = Mathf.Log10(1+relMaxQuantError); 
    ret = Mathf.Floor(ret/quantum) * quantum;
    ret = Mathf.Sign(x) * (Mathf.Pow(10, ret));

    return ret;
} 
```

在将浮点数存储在字典中之前，我使用此方法对浮点数进行量化。允许的最大相对误差可以由 const 控制（目前为 0.1 %）。

PS：`Mathf`是Unity的类。它可以很容易地调整以使用标准`Math`.

# vba - 宏：给定行 X 将该行中的特定单元格复制到新工作表

> ID：14693566
> 
> 赞同：0
> 
> 时间：2013-02-04T18:57:55.490
> 
> 标签：vba, excel

我正在研究一种基于给定列 (G) 中每一行的值生成列表的方法。目前该列表可以复制整行并完美运行。如果 G 列包含所需的文本（“卡片”），它将拉出所有行，并将它们放在另一个电子表格的列表中，没有间隙。

问题是我希望列表只包含来自每行中包含“卡”的几列的信息，而不是整行。

**有没有办法让我的代码从一行中拉出特定的单元格，而不是使用 .EntireRow 函数并复制整行？**

澄清一下，这个电子表格由多个不同的用户定期更新，因此信息不是静态的。行添加和更改频繁，偶尔删除。因此，我不能只将原始工作表中的单元格值复制到新列表中。

```
Sub AlonsoApprovedList()

  Dim cell As Range

  Dim NewRange As Range

  Dim MyCount As Long

  Dim ExistCount As Long

  ExistCount = 0

  MyCount = 1

'----For every cell in row G on the ESI Project Data sheet----'

  For Each cell In Worksheets("ESI Project Data").Range("G6:G5000")

  If cell.Value = "Card" Then

      ExistCount = ExistCount + 1

      If MyCount = 1 Then Set NewRange = cell.Offset(0, -1)

      '----Sets up a new range to copy all data from the row if column G in that row contains the value in question----'

      Set NewRange = Application.Union(NewRange, cell.EntireRow)

      MyCount = MyCount + 1

  End If

  Next cell

  If ExistCount > 0 Then

      NewRange.Copy Destination:=Worksheets("Alonso Approved List").Range("A3")

  End If

End Sub 
```

**附加信息：**

1.  G 列下拉数据验证列表，其中包含一项。完整列表位于不同的工作表中。用户进入每个行项目并从特定类别中进行选择。

2.  有问题的其他列包含行项目的名称、类别（与 G 列相同）、货币价值和日期。

3.  上面的代码循环遍历“ESI 项目数据”工作表中的列表，并通过单元格 G 中的值检测行。在此示例中，每次在单元格 G（“卡片”）中出现关键字时，它都会复制整行。我正在使用它来生成按该关键字分组的单个列表。我只希望它拉单个单元格，而不是像当前那样使用 .EntireRow 函数。我不知道该怎么做。

感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:28:29.837

未经测试...

```
Sub AlonsoApprovedList()

Dim cell As Range
Dim rngDest As Range
Dim i As Long
Dim arrColsToCopy

    arrColsToCopy = Array(1, 3, 4, 5)
    '----For every cell in row G on the ESI Project Data sheet----'
    Set rngDest = Worksheets("Alonso Approved List").Range("A3")

    Application.ScreenUpdating = False

    For Each cell In Worksheets("ESI Project Data").Range("G6:G5000").Cells

        If cell.Value = "Card" Then

            For i = LBound(arrColsToCopy) To UBound(arrColsToCopy)
                With cell.EntireRow
                    .Cells(arrColsToCopy(i)).Copy rngDest.Offset(0, i)
                End With
            Next i

            Set rngDest = rngDest.Offset(1, 0) 'next destination row

        End If

    Next cell

    Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T19:08:08.163

您好，是否有一个代码可用于通过单击按钮将特定单元格复制到另一个工作簿。

这就是我想要做的，

从工作簿 1 我需要从以下单元格复制信息 我在单元格 A40 到 A69 上有 B 列信息 我在单元格 b2、b3、b4、b8、9、10、11、12、13、14、15 上有 B 列信息和 b40 到 b69 我在单元格 b2 上有 D 列信息，我在单元格 b1、b2、b3、b4 上有列 G 信息

所有这些我需要将它发送到 workbook2，它具有分配给此特定信息的相同单元格。

希望我说清楚了。

# sql - 使用镜像的链接服务器

> ID：14693567
> 
> 赞同：1
> 
> 时间：2013-02-04T18:58:03.033
> 
> 标签：sql, sql-server-2008-r2, mirroring

我需要配置一个 SQL Server 2008R2 链接服务器，该服务器连接到一个主体数据库，并具有一个镜像故障转移数据库。例如，我在需要在服务器 B 中执行查询的服务器 A 中，如果发生故障转移到服务器 C。我创建了一个名为 MyLinkS 的链接服务器

我正在尝试使用此连接字符串配置链接服务器：

```
Server=B;Failover Partner=C;Initial Catalog=MyDatabase;Integrated Security=True; 
```

当我在服务器 A 中时，我正在执行以下查询：

```
Select Name from [MyLinkS].[MyDatabase].[dbo].[MyTable] where Name = 'Jhon' 
```

当服务器 B 为 Principal 时，查询有效，但当我更改为镜像时，它不起作用，它说“它正在恢复中”。

如何根据 B 是主体还是镜像来使用与使用一台或另一台服务器之前相同的查询？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:54:43.547

也许它会为你工作：

1.  `SYNONYM`在服务器 B 上为表创建。
2.  `SYNONYM`在服务器 C 上为表创建另一个。
3.  用于`TRY/CATCH`您的选择 - 从块中的 B 中`TRY`选择并从块中的 C 中选择`CATCH`。

# javascript - Jquery：获取数字数组中的最大值

> ID：14693568
> 
> 赞同：16
> 
> 时间：2013-02-04T18:58:06.160
> 
> 标签：javascript, jquery, arrays, numbers, highest

使用 jquery，如何获得数组或数字中的最大值？

例子：

```
var myArray = [1,4,7,3,12,0] 
```

预期输出：-

最大值 = 12

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-02-04T19:01:13.950

如果按最高数字表示最大值，则不需要 jQuery。你可以这样做：

```
var myArray = [9,4,2,93,6,2,4,61,1];
var maxValueInArray = Math.max.apply(Math, myArray); 
```

# jquery - 通过循环减小字体大小

> ID：14693572
> 
> 赞同：0
> 
> 时间：2013-02-04T18:58:24.173
> 
> 标签：jquery

我有一个容器，它的宽度可以改变。有了这个容器，我还有其他几个元素：

**HTML**

```
<div class="box">
    <div style="float:left" class="sub1">
        VARIABLE SIZE FONT
    </div>
    <div style="float:left" class="sub2">
        CONSTANT WIDTH
    </div>
</div>

<div class="box">
    <div style="float:left" class="sub1">
        VARIABLE SIZE FONT
    </div>
    <div style="float:left" class="sub2">
        CONSTANT WIDTH
    </div>
</div> 
```

在大多数情况下，我不需要对代码做任何事情，但有时 .box div 可能会更窄。在这些情况下，我需要调整 .sub1 容器的字体大小。

**JS**

```
 $('.sub2').each(function() {
    parentW = $('.sub2').parent().width(),
    sub_2 = $('.sub2').width() + 10,
    sub_1 = $('.sub1').width(),
    availSpace = parentW - sub_2;

    // below is where I need help 
    while (sub_1 > availSpace) {
       curFontSize = $('.sub_1').css('font-size');
       $('.sub_1').css('font-size', parseInt(curFontSize)-2);
    } 
 }); 
```

这似乎是正确的，但它似乎对我不起作用。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:03:52.810

你需要在`$(this)`里面使用`.each()`。此外，您需要访问和修改`sub1`每个 div `sub2`。

试试这个：

```
$(document).ready(function () {
    $('.sub2').each(function() {
        parentW = $(this).parent().width(),
        sub_2 = $(this).width() + 10,
        div1 = $(this).siblings('.sub1').first();
        sub_1 = div1.width(),
        availSpace = parentW - sub_2;

        if (sub_1 > availSpace) {
            curFontSize = div1.css('font-size');
            div1.css('font-size', parseInt(curFontSize)-2);
        } 
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:05:34.990

您是否尝试过像这样更改字体大小值：

```
 $('.sub_1').css('font-size', '-=2'); 
```

# r - 具有重叠点的绘图

> ID：14693576
> 
> 赞同：3
> 
> 时间：2013-02-04T18:58:34.420
> 
> 标签：r, plot

我在 R 中有重叠点的数据。

```
x = c(4,4,4,7,3,7,3,8,6,8,9,1,1,1,8)
y = c(5,5,5,2,1,2,5,2,2,2,3,5,5,5,2)
plot(x,y) 
```

如何绘制这些点，以便重叠的点按比例大于不重叠的点。例如，如果 3 个点位于 (4,5)，则 (4,5) 位置的点应该是只有一个点的点的三倍。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-04T19:14:17.680

这是一种使用方法`ggplot2`：

```
x = c(4,4,4,7,3,7,3,8,6,8,9,1,1,1,8)
y = c(5,5,5,2,1,2,5,2,2,2,3,5,5,5,2)
df <- data.frame(x = x,y = y)
ggplot(data = df,aes(x = x,y = y)) + stat_sum() 
```

![在此处输入图像描述](../Images/79b77eaba61109afbdc61ba379906bf3.png)

默认情况下，`stat_sum`使用实例的比例。您可以通过执行以下操作来使用原始计数：

```
ggplot(data = df,aes(x = x,y = y)) + stat_sum(aes(size = ..n..)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-04T19:18:57.960

这是一个更简单（我认为）的解决方案：

```
x <- c(4,4,4,7,3,7,3,8,6,8,9,1,1,1,8)
y <- c(5,5,5,2,1,2,5,2,2,2,3,5,5,5,2)
size <- sapply(1:length(x), function(i) { sum(x==x[i] & y==y[i]) })
plot(x,y, cex=size) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-04T19:14:17.227

```
## Tabulate the number of occurrences of each cooordinate
df <- data.frame(x, y)
df2 <- cbind(unique(df), value = with(df, tapply(x, paste(x,y), length)))

## Use cex to set point size to some function of coordinate count
## (By using sqrt(value), the _area_ of each point will be proportional
##  to the number of observations it represents)
plot(y ~ x, cex = sqrt(value), data = df2, pch = 16) 
```

![在此处输入图像描述](../Images/ccfb9dc2435b2c5bb121fd66276bb74b.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-04T19:18:40.947

您并没有真正要求这种方法，但 alpha 可能是解决此问题的另一种方法：

```
library(ggplot2)
ggplot(data.frame(x=x, y=y), aes(x, y)) + geom_point(alpha=.3, size = 3) 
```

![在此处输入图像描述](../Images/87d25573f5ba17098b7b0c1d97fafe66.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-04T19:19:45.107

您需要将参数添加`cex`到绘图函数中。首先，我要做的是使用该函数`as.data.frame`并将`table`您的数据减少为唯一的 (x,y) 对及其频率：

```
new.data = as.data.frame(table(x,y))
new.data = new.data[new.data$Freq != 0,] # Remove points with zero frequency 
```

唯一的缺点是它将数字数据转换为因子。所以转换回数字，然后绘图！

```
plot(as.numeric(new.data$x), as.numeric(new.data$y), cex = as.numeric(new.data$Freq)) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-07-15T10:30:02.780

您可能还想尝试一下`sunflowerplot`。

```
sunflowerplot(x,y) 
```

[![在此处输入图像描述](../Images/a7ffbccbe7deaaa4e42b748cb218eecf.png)](https://i.stack.imgur.com/yQLI7.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-04T19:20:21.567

让我提出调整点大小的替代方案。使用尺寸（半径？面积？）的缺点之一是读者对光斑尺寸与基础数值的评估是主观的。

所以，选项 1：用透明度绘制每个点 --- Tyler 的忍者！选项 2：用于`jitter`稍微推动您的数据，以便绘制的点不会重叠。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-04T23:47:39.833

使用`lattice`and的解决方案`table`（类似于@R_User，但不需要删除 0，因为 lattice 可以完成这项工作）

```
 dt <-  as.data.frame(table(x,y))
   xyplot(dt$y~dt$x, cex = dt$Freq^2, col =dt$Freq) 
```

![在此处输入图像描述](../Images/3960cc46963deca0d0922cfd0e7cd9ad.png)

# c# - 比较两个列表并将匹配的列保存到单独的列表中

> ID：14693578
> 
> 赞同：3
> 
> 时间：2013-02-04T18:58:41.143
> 
> 标签：c#, linq, list, lookup

我解析一个文件并将结果保存到 C# 中的列表中。然后我将数据库查询的所有结果解析到另一个列表。我想比较两个列表的匹配并将结果保存到另一个列表以写入输出文件。我认为比较这两个列表比每次为每个人对数据库运行查询更快更好，因为他们在文件中大约有 16k 条记录。

清单 1\. 清单文件清单包含以下数据类型：字符串 personName

清单 2\. 列出 DBresults 包含以下数据类型：字符串 personName、字符串地址、字符串 phoneNumber

尝试将列表 1 与列表 2 进行比较以查找匹配项，然后将结果发送到另一个列表以写入输出。它们可能是列表 2 中每个人的多个结果，因此我需要找到每个实例。

从这样的 LINQ 查询开始，但我不是 LINQ 的大师，所以我需要一些帮助。

```
var matches = fileList.Where(a=>a.personsName == DBResults.where(s=>s,personsName).toList(); 
```

如果您认为您可能有更快的方法，我也愿意接受其他建议。我知道 IDctionarys 和 Hashtables 是快速查找表，但我有三种数据类型，所以我不能做一个键值对。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T19:02:03.127

如果我正确理解您的问题，则解决方案是 LINQ[`Join`](http://msdn.microsoft.com/en-us/library/bb534675.aspx)方法。

```
var result = (from a in fileList
              join s in DBResults on a.personsName equals s.personsName
              select s).ToList(); 
```

或者使用扩展方法语法：

```
var result = fileList.Join(DBResults, a => a.personsName, s => s.personsName, (a, s) => s).ToList(); 
```

这种方法速度极快，内部使用 HashSet 来提高性能。

# android - Android中的日期选择器看起来不太好

> ID：14693581
> 
> 赞同：0
> 
> 时间：2013-02-04T18:58:50.877
> 
> 标签：android, datepicker

当我将日期选择器添加到我的活动时。它被正确添加。它的日期和月份部分是正确的，但是，年份部分显示的是日历。我也收到此错误-

```
The following classes could not be found:
- CalendarView (Change to android.widget.CalendarView, Fix Build Path, Edit XML)
- DatePicker (Change to android.widget.DatePicker, Fix Build Path, Edit XML) 
```

这是日期选择器代码 -

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<DatePicker
    android:id="@+id/datePicker1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true" /> 
```

这是我得到的输出（请忽略音量图像）。

![这是我得到的输出](../Images/f7f8b66ed1733fd5a97684e920f06502.png)

我想将它添加到我的应用程序中，以便我可以输入用户的出生日期。但由于年份部分（日历），它看起来不太好。

可能是什么问题？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:43:20.100

[CalendarView](https://developer.android.com/reference/android/widget/CalendarView.html)是在 API 11 中添加的，因此您不能在 API 8 的最低 SDK 中使用它。

DatePicker 自 API 1 以来一直存在，因此要么是 CalendarView 错误正在创建这个错误，要么是您的 XML 中存在其他错误。但是除非您发布它，否则我无法知道确切的问题...

* * *

**另外**
，我不记得以前在哪里看到过这个*确切的*错误，但现在我知道它来自哪里： ![截屏](../Images/029727ac9971251c530ce488df91285d.png)
这不会影响您的应用程序。该错误仅意味着 Eclipse 无法在您的布局中构建 DatePicker 或 CalendarView 的预览。该应用程序将运行良好（在 API 11+ 设备上）。

# ios - iOS：NSDecimalNumber：没有得到预期的结果

> ID：14693582
> 
> 赞同：0
> 
> 时间：2013-02-04T18:58:53.000
> 
> 标签：ios, nsdecimalnumber

假设我对这些 ivars 有以下值：

NSString* 百分比 = 35 NSString* 值 = 146

在下面的代码中，当我进行乘法 (146*.35) 时，我期望得到 51.1，但得到的是 100。

```
- (NSDecimalNumber*) getProductByPercentage : (NSArray*) itemsToMultiply : (float) annualPatients {

    //get items from array
    NSString* percentage = [itemsToMultiply objectAtIndex:0];
    NSString* value = [itemsToMultiply objectAtIndex:1];

    //init a number formatter
    NSNumberFormatter * f = [[NSNumberFormatter alloc] init];
    //set its formatting style
    [f setNumberStyle:NSNumberFormatterDecimalStyle];

    //convert to percentage
    float thisPercentage = [percentage floatValue]/100;

    //convert to NSDecimal
    NSDecimalNumber* decPercentage = [[NSDecimalNumber alloc] initWithString:[NSString stringWithFormat:@"%f",  thisPercentage]];
    NSDecimalNumber* decAvgReimbursement = [[NSDecimalNumber alloc] initWithString: value];
    NSDecimalNumber* decAnnualPatients = [[NSDecimalNumber alloc] initWithString:[NSString stringWithFormat:@"%f", annualPatients]];

    //set up handler
    NSDecimalNumberHandler *handler = [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:NSRoundPlain
            scale:-2
            raiseOnExactness:NO
            raiseOnOverflow:NO
            raiseOnUnderflow:NO
            raiseOnDivideByZero:NO
    ];

    //get our results
    NSDecimalNumber* decAvgCost = [decAvgReimbursement decimalNumberByMultiplyingBy:decPercentage
                                                                 withBehavior:handler];

    NSLog(@"%@::%@::%@", decAvgCost, decAvgReimbursement, decPercentage);

    return decAvgCost;
} 
```

这是我的日志输出

```
2013-02-04 13:57:46.960 EUS Calculator[34154:c07] 100::146::0.35 
```

我的处理程序有什么问题导致我得到错误的结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:06:42.327

```
scale:-2 
```

您将比例设置为四舍五入到小数点后 -2，即最接近的 100。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:05:14.440

你四舍五入到错误的比例。尝试将比例更改为 0（删除小数点），然后重试。如果您想要 1 个小数位，请使用 1；那么你应该得到 51.1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T19:05:54.783

改变这个：

```
float thisPercentage = [percentage floatValue]/100; 
```

对此：

```
float thisPercentage = [percentage floatValue]/100.0; 
```

如果您不输入 .0，那么编译器会将其解释为整数，并且在执行 float/int 时会将其转换为 int，从而将您预期的 0.35 转换为 0。

此外，您没有在任何地方使用 NSNumberFormatter，因此您甚至可以不创建它。

你为什么还要使用`NSDecimalNumbers`？

# arrays - SAS对齐数据集 - 使用数组？

> ID：14693586
> 
> 赞同：1
> 
> 时间：2013-02-04T18:59:06.710
> 
> 标签：arrays, sas, vertical-alignment

我有一个相当复杂的情况，并且是 SAS 的新手，我正在努力寻找解决方案。我有两个数据集（控制器、数据集），每个数据集中都有一个功率测量值。我需要将控制器数据与 daq 数据对齐。但是每个数据集中都有一个时间戳，他们没有费心将 daq 与控制器同步，因此两者之间存在不确定的时间增量。更复杂的是，两个系统都以不同的速率对数据进行采样......虽然控制器只在测试期间记录数据，但数据采集器的记录时间更长。因此，对于典型的测试运行，控制器有大约 1000 行数据，而 daq 在不同的采样率下有 30,000 行（这意味着绝对测量值可能不会完全匹配）。

我试图找出一种自动对齐数据的方法 - 即找出控制器数据的曲线与 daq 数据的曲线最接近的位置 - 给我们时间增量。

我目前的想法是遍历两个数组，从 controllerow[j] 中减去 daqrow[i]，然后将曲线的增量相加并找到最小增量：

```
 set work.daqPower work.controlPower
array pwr_daq{*} daqPwr;  /* daqPwr is name of power variable in work.daqPower */
array pwr_control{*} controlPwr;  /* controllPwr is name of power variable in work.controlPower */
do idaq=1 to (30000 - 1000);
    x = idaq;
    tmp = 0;
    do jcontrol=1 to 1000;
        tmp = tmp + ABS(pwr_daq[x] - pwr_control[jcontrol]);
        x = x + 1;
    end;
    output;
end; 
```

我显然不理解数组文档。我一直在网上搜索并浏览了很多示例，但我没有找到任何显示读取两个数据集并从中创建单独数组的示例。如果您有任何关于更好方法的想法，我将不胜感激任何类似示例的链接。

谢谢，

弗雷德

更新数据样本：

```
DateTime        daqPower
05JUL12:10:10:00    205.45687866211
05JUL12:10:10:00    204.33529663086
05JUL12:10:10:00    204.17504882813
05JUL12:10:10:00    203.53414916992
05JUL12:10:10:00    203.53414916992
05JUL12:10:10:00    204.81597900391
05JUL12:10:10:00    204.33529663086
05JUL12:10:10:00    205.13641357422
05JUL12:10:10:00    207.05914306641
05JUL12:10:10:00    206.73867797852
05JUL12:10:10:00    207.05914306641
05JUL12:10:10:00    208.50119018555
05JUL12:10:10:00    208.50119018555
05JUL12:10:10:00    207.53982543945
05JUL12:10:10:00    207.21936035156
05JUL12:10:10:00    206.73867797852
05JUL12:10:10:00    206.09777832031
05JUL12:10:10:00    205.77731323242
05JUL12:10:10:00    205.13641357422
05JUL12:10:10:00    205.45687866211

DateTime        controlPower
05JUL12:10:01:19    226.8705902
05JUL12:10:01:19    232.526886
05JUL12:10:01:19    236.9337006
05JUL12:10:01:19    242.3483887
05JUL12:10:01:19    246.9274292
05JUL12:10:01:19    246.3426819
05JUL12:10:01:19    244.3251495
05JUL12:10:01:19    242.6235352
05JUL12:10:01:20    243.5477753
05JUL12:10:01:20    240.9849854
05JUL12:10:01:20    230.8181458
05JUL12:10:01:20    225.579071
05JUL12:10:01:20    221.7199097
05JUL12:10:01:20    214.7053986
05JUL12:10:01:20    212.1452332
05JUL12:10:01:20    210.9714203
05JUL12:10:01:20    213.6631317
05JUL12:10:01:20    213.3510437
05JUL12:10:01:21    209.8970642
05JUL12:10:01:21    210.884964 
```

请记住，时间不匹配（我们“听说”时间戳可能彼此不同步大约 10 分钟+）。关键是控制器的曲线比 daq 的间隔要短得多，我们试图通过对齐控制器曲线与控制器曲线最接近的位置来确定时间差。我说曲线，因为最初只是想匹配最大值，但是虽然控制器数据中只有一个最大值，但 daq 数据会持续更长的时间，并且功率曲线多次穿过该值，所以它会很难仅基于此对齐数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:26:15.357

弗雷德，这里有一些你可以尝试的想法。我同意 IML 可能是你要走的路，但你必须使用你手头的东西。

首先，使用数组，您可以使用 PROC TRANSPOSE 或带有 RETAIN 语句的 DATA 步骤修改控制器数据集，以创建两个数组（一个用于时间，另一个用于测量）并在所有数组元素都具有后仅输出最终观察结果被填满。然后，您可以使用带有两个 SET 语句的单独 DATA 步骤（第一个设置 DAQ 数据集，然后是“IF *N*EQ 1 THEN SET <1 observation POWER dataset name>;"。您需要在这个新数据集中设置数组并再次使用 RETAIN 语句在整个处理过程中保留它们。然后您可以使用 DO 循环来处理数组，其中 DAQ 观察中的时间变量等于或介于时间数组中存储的 POWER 观察的日期之间。这是一种处理信息的相当混乱的方式，并且会导致一个相当大的矩阵，除非您使用一个 KEEP 或 DROP 语句来限制最终输出。但是，此方法将允许您通过多个观察之间的一些外推值来修改 CONTROLLER 观察。

相比之下，我认为我的第二个和第三个建议不会让您在两个值之间进行推断，但无论如何我都会建议它们。

第二个选项，使用 PROC FORMAT 从 CONTROLLER 数据集创建用户定义的格式，其值为时间，格式化值为 POWER 观察值。您需要将数据按时间排序，然后您可以使用 lag 函数定义 START 和 END 值以传递到格式中。创建格式后，您可以使用该格式根据 DAQ 时间变量的格式化值在您的 DAQ 数据集中创建一个新变量。如上所述，使用此过程在值之间进行推断是不可行的。

第三个选项是第二个选项的变体，但不使用格式，您可以使用 DATA Step 组件对象来创建一个哈希对象，您可以遍历该对象以检索您需要的值。我不经常使用这种方法，所以我不会费心去描述它，但你可以在 SAS 网站上找到它的文档。

还有第四个选项可能比其中任何一个都好，但您必须拥有 SAS/ETS 模块才能使用它。您可以使用 EXPAND 过程将 CONTROL 数据集中的 POWER 观测值外推为与 DAQ 数据集时间变量一致的时间频率，然后将此扩展数据集与 DAQ 数据集合并。这种方法可以让您对如何进行外推有相当多的控制，并且相当容易实现，但是再一次，您必须拥有 ETS 模块才能使用该过程。

我没有提供任何示例，因为我的回答过于冗长（本来应该是评论但太长了），但是如果您希望我尝试为所讨论的方法之一提供一些示例代码，请告诉我。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:58:42.077

由于您有 ETS，请参阅此示例以了解 PROC TIMESERIES，尤其是最后的互相关图：

[http://support.sas.com/documentation/cdl/en/etsug/63348/HTML/default/viewer.htm#etsug_timeseries_sect044.htm](http://support.sas.com/documentation/cdl/en/etsug/63348/HTML/default/viewer.htm#etsug_timeseries_sect044.htm)

互相关图将在最佳滞后处达到峰值。

您还可以使用 PROC TIMESERIES 来标准化采样率。

# svn - 我应该如何构建我的插件开发以及如何将补丁应用于 svn 中的补丁？

> ID：14693588
> 
> 赞同：0
> 
> 时间：2013-02-04T18:59:09.280
> 
> 标签：svn, branch, patch

我刚开始开发 redmine 插件和补丁，我正在使用 svn。我有下一个结构：

```
doc/
src/
src/branches/
src/plugins/
src/patches/
src/trunk/ 
```

我的想法是为我要开发的每个插件或补丁从主干创建一个分支。plugins 文件夹用于存储插件的不同版本，而 patchs 文件夹用于存储补丁的版本。

我现在面临下一个问题：我创建了一个分支 issue_x 来开发补丁。在第一个版本之后，我曾经`svn diff > patch.diff`得到补丁。然后我将它保存在补丁文件夹中，然后使用`patch -p0 < ../patch.diff`. 很酷，但是我必须对补丁进行一些修改，因为在生产中发现了一个错误。

我应该怎么办？

*   创建一个新补丁来修复错误？
*   修复错误，创建一个完整的补丁（包括所做的所有更改），恢复主干中的补丁，然后重新应用新补丁？
*   还要别的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T08:13:07.520

我不确定您为什么使用补丁而不是合并。这很奇怪。

（对我来说）最明显的事情是分支`issue_x`，修复错误，合并回`issue_x`然后合并`issue_x`回`trunk`.

在您的场景中，我建议您进行更改以修复中的错误`issue_x`，创建补丁并将其应用于`trunk`. 不过，您仍然应该从[SVN Book](http://svnbook.red-bean.com/en/1.7/)中了解[SVN 分支和合并](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T22:06:19.833

Subversion (and any SCM in common) way is "Merge changes" from different development lines.

I.e instead of diff-patch way you use svn internal technique - merge branch to trunk, re-merge after some changes added in branch while you don't get needed result

Read [SVN Book](http://svnbook.red-bean.com/en/1.7/svn.tour.html), it's useful thing

# jquery - 使用jquery在列表框中全选或取消全选？

> ID：14693593
> 
> 赞同：2
> 
> 时间：2013-02-04T18:59:23.030
> 
> 标签：jquery, asp.net

我有 asp.net 列表框。列表框的第一项是“--All--”。如果用户选择了列表的第一项，则自动选择所有项目。如果用户取消选择列表的第一项，则自动取消选择所有项目。我怎样才能使用 jquery 做到这一点？

```
 <asp:ListBox ID="lstDatabases" runat="server" Height="134px" Width="396px" SelectionMode="Multiple" >
</asp:ListBox> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:45:52.683

你可以尝试这样的事情：

```
$("#selectId").on('change', function() {
    if ($(this).val() == "all") {
        $("select > option").prop("selected", true);
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-03T17:05:42.223

jQuery：选择多选列表框中的所有选项

```
$("#multipleselect option").prop("selected",true); 
```

一个多选列表框，其中已经为您选择了所有内容！

来自： [http ://www.craiglotter.co.za/2010/02/26/jquery-select-all-options-in-a-multiple-select-listbox/](http://www.craiglotter.co.za/2010/02/26/jquery-select-all-options-in-a-multiple-select-listbox/)

# javascript - 如何使jqgrid treegrid第一行文本加粗

> ID：14693594
> 
> 赞同：2
> 
> 时间：2013-02-04T18:59:26.397
> 
> 标签：javascript, jquery, css, jquery-ui, jqgrid

jqgrid treegrid 是使用下面的代码定义的。第一级数据仅包含 jqgrid 第一行中显示的单个节点。如何使这个（treegrid第一行）文本加粗？

我试过

```
#tree-grid .cell-wrapper
{
    font-weight: bold;
} 
```

但这会使所有节点变粗。

如何仅使第一个节点（第一行）加粗？

树网格定义为

```
 var treegrid = $("#tree-grid");
        treegrid.jqGrid({
            loadComplete: function (data) {
                $('.tree-leaf', $(this)).css('width', '0px');
            },
            datatype: "json",
            mtype: "POST",
            height: "auto",
            loadui: "disable",
            treeGridModel: "adjacency",
            colModel: [
                    { name: "id", width: 1, hidden: true, key: true },
                    { name: "menu", classes: "treegrid-column" },
                    { name: "url", width: 1, hidden: true }
                ],
            autowidth: true,
            treeGrid: true,
            ExpandColumn: "menu",
            rowNum: 2000,
            ExpandColClick: true,
        }
                );
        treegrid.parents("div.ui-jqgrid-view").children("div.ui-jqgrid-hdiv").hide(); 
```

**更新**

我试过

```
#tree-grid .cell-wrapper :first-child
{
    font-weight: bold;
} 
```

但粗体字体不适用。

Firebug 显示该元素是

```
<span class="cell-wrapper" style="cursor: pointer;">Text which should be bold</span> 
```

看起来 :first-child 不应用这种风格。

文本（跨度元素）在第二个网格行内（在第二个元素内）。它的行以`<tr id="1" class="ui-widget-content ..`. 也许可以使用它进行选择。

来自 firebug 的完整 jqgrid 布局是

```
<div>
<div id="gbox_tree-grid" class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" dir="ltr" style="width: 188px;">
<div id="lui_tree-grid" class="ui-widget-overlay jqgrid-overlay"></div>
<div id="load_tree-grid" class="loading ui-state-default ui-state-active">Loen...</div>
<div id="gview_tree-grid" class="ui-jqgrid-view" style="width: 188px;">
<div class="ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix" style="display: none;">
<div class="ui-state-default ui-jqgrid-hdiv" style="width: 188px; display: none;">
<div class="ui-jqgrid-bdiv" style="height: auto; width: 188px;">
<div style="position:relative;">
<div></div>
<table id="tree-grid" class="ui-jqgrid-btable" cellspacing="0" cellpadding="0" border="0" tabindex="1" role="grid" aria-multiselectable="false" aria-labelledby="gbox_tree-grid" style="width: 188px;">
<tbody>
<tr class="jqgfirstrow" style="height:auto" role="row">
<tr id="1" class="ui-widget-content jqgrow ui-row-ltr" role="row" tabindex="-1">
<td aria-describedby="tree-grid_id" title="1" style="display:none;" role="gridcell">1</td>
<td class="treegrid-column" aria-describedby="tree-grid_menu" style="" role="gridcell">
<div class="tree-wrap tree-wrap-ltr" style="width:18px;">
<span class="cell-wrapper" style="cursor: pointer;">Text which should be bold</span>
</td>
... 
```

**更新2**

我通过添加尝试了 Oleg 答案

```
.first-row
{
    font-weight: bold;
} 
```

和

```
rowattr: function (rd) {
  alert('rowattr');
        return {"class": "first-row"};
}, 
```

不出现警告框。另外，如何仅将其应用于 treegrid 中的第一行？

**更新 3**

根据 Oleg 的回答，我升级到了 4.4.1（尝试了 4.4.4，但它不允许打开第​​一个节点）。文本仍然不是粗体。Firebug 表明

```
.ui-jqgrid tr.jqgrow td {
    font-weight: normal; 
```

应用于`after`第一行类，因此该类没有任何效果。

萤火虫输出是：

```
.ui-jqgrid tr.jqgrow td {
    font-weight: normal; /* this overrides my style !! */
    white-space: pre;
}
.treegrid-column {
    cursor: pointer;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.8);
}
.first-row {
    font-weight: bold;
} 
```

以下代码用于在加载时打开树：

```
 gridComplete: function () {
                setTimeout(function () {
          var rData2 = treegrid.getGridParam('data');
              treegrid.expandRow(rData2[0]);
              treegrid.expandNode(rData2[0]);
           },0);
          }, 
```

在 4.4.4 中它不打开树。在 4.4.1 中它可以工作。使第一个节点变粗并打开它的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:58:24.767

`rowattr`我认为如果你想让整行加粗，你可以通过使用来解决这个问题（见[答案](https://stackoverflow.com/a/10531680/315935)）。您可以在指定的行上分配附加`class`或属性。`style`或者，您可以使用`cellattr`仅在单元格上分配类或样式，例如仅在`"menu"`列中的单元格上（参见[答案](https://stackoverflow.com/a/6048865/315935)）。我在引用的答案中使用了标准网格，但您可以使用TreeGrids`rowattr`并`cellattr`以相同的方式使用。对列的访问`parent`，`level`以及`isLeaf`存在于 TreeGrid 中的内容可以帮助您实现。

**更新**：这是将所有没有的项目标记为粗体[的演示](http://www.ok-soft-gmbh.com/jqGrid/LocalAdjacencyTree14.htm)`parent`：

![在此处输入图像描述](../Images/22216c3dc2ceccc62230d980252f2b23.png)

[另一个演示](http://www.ok-soft-gmbh.com/jqGrid/LocalAdjacencyTree14_.htm)使用更具体的规则：

![在此处输入图像描述](../Images/30628e060b63b13d6b08424dc5294115.png)

在这两种情况下，我都使用了 CSS 规则

```
.ui-jqgrid tr.myMarking td { font-weight: bold; } 
```

的实现`rowattr`非常简单，例如如下

```
rowattr: function (rd) {
    if (rd.parent === "null" && rd.name === "Cash") {
        return {"class": "myMarking"};
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:16:45.047

```
#tree-grid .cell-wrapper:first-child
{
    font-weight: bold;
} 
```

您只需要确定 .css 声明的“第一个孩子”。

# c# - 调用一个类

> ID：14693597
> 
> 赞同：0
> 
> 时间：2013-02-04T18:59:29.047
> 
> 标签：c#, if-statement

我将如何在 if 语句中调用另一个类的函数。例如，我有一个菜单，我希望能够显示用户选择：

```
namespace _5049COMP_OO
{
class Interface
{

     public string menuChoice;

    //This creates the loadup menu.
    public void menu()
    {

        DrawLine();
        Console.Write("                       Welcome to BOSS eAuctions!                               ");
        DrawLine();
        Console.WriteLine("1\. Browse");
        Console.WriteLine("2\. Login");
        Console.WriteLine("3\. Register");
        Console.WriteLine(" ");
        Console.WriteLine(" ");
        Console.WriteLine(" ");
        Console.WriteLine("4\. Quit                                                                     ");

        DrawLine();
        Console.Write("Please select on of the options:");
        menuChoice = Console.ReadLine();
        DrawLine();

    }

    // Create the login menu
    public void LoginMenu(string username, string password)
    {

        DrawLine();
        Console.Write("                          Login!                                                 ");
        DrawLine();
        Console.WriteLine("Username:");
        Console.WriteLine("Password");
        username = Console.ReadLine();
        password = Console.ReadLine();
        DrawLine();
        DrawLine();
    } 
```

我想要“Public void Choice()

```
 namespace _5049COMP_OO
 { 
class Functions
{

    public void Choice()
    {
    }
   }
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:00:39.593

您需要一个类的实例，或者它需要是一个静态方法。

在接口文件的顶部，为 Functions 命名空间添加 using 语句。

如果您将 Choice() 设为静态方法，则可以执行

```
Functions.Choice(); 
```

否则你需要

```
var f = new Functions();
f.Choice(); 
```

# android - 使用phonegap构建后，地理定位不适用于android

> ID：14693606
> 
> 赞同：1
> 
> 时间：2013-02-04T18:59:52.550
> 
> 标签：android, html, cordova, geolocation

我正在开发将使用手表位置的 android 应用程序，但它不适用于 android 我现在没有问题，我正在从 phonegap.com 网站而不是 eclips 构建应用程序。这是我的代码

```
<!DOCTYPE html>
<html>
<head>
<title>Device Properties Example</title>

<script type="text/javascript" src="phonegap.js"></script>
<script type="text/javascript" charset="utf-8">

// Wait for Cordova to load
//
document.addEventListener("deviceready", onDeviceReady, false);

var watchID = null;

// Cordova is ready
//
function onDeviceReady() {
    // Get the most accurate position updates available on the
    // device.
    var options = { enableHighAccuracy: true };
    watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
}

// onSuccess Geolocation
//
function onSuccess(position) {
    var element = document.getElementById('geolocation');
    element.innerHTML = 'Latitude: '  + position.coords.latitude      + '<br />' +
                        'Longitude: ' + position.coords.longitude     + '<br />' +
                        '<hr />'      + element.innerHTML;
}

// clear the watch that was started earlier
// 
function clearWatch() {
    if (watchID != null) {
        navigator.geolocation.clearWatch(watchID);
        watchID = null;
    }
}

// onError Callback receives a PositionError object
//
function onError(error) {
  alert('code: '    + error.code    + '\n' +
        'message: ' + error.message + '\n');
}

</script>
</head>
<body>
<p id="geolocation">Watching geolocation...</p>
<button onclick="clearWatch();">Clear Watch</button>     
</body>
</html> 
```

这是我的配置文件 http://www.w3.org/ns/widgets" xmlns:gap = " [http://phonegap.com/ns/1.0](http://phonegap.com/ns/1.0) " id = "com.phonegap.hello-world" version = “2.2.0”> 马卡纳克

```
<description>
    Makanak is a location based application heple u to fin places in Egypt.
</description>

<author>
    Makanak Team
</author>

<feature name="http://api.phonegap.com/1.0/device" />

<preference name="phonegap-version" value="2.2.0" />
<preference name="orientation"      value="default" />
<preference name="target-device"    value="universal" />
<preference name="fullscreen"       value="false" />

<icon src="icon.png" />
<icon src="res/icon/android/icon-36-ldpi.png"   gap:platform="android"            gap:density="ldpi" />
<icon src="res/icon/android/icon-48-mdpi.png"   gap:platform="android"    gap:density="mdpi" />
<icon src="res/icon/android/icon-72-hdpi.png"   gap:platform="android"    gap:density="hdpi" />
<icon src="res/icon/android/icon-96-xhdpi.png"  gap:platform="android"    gap:density="xhdpi" />
<icon src="res/icon/blackberry/icon-80.png"     gap:platform="blackberry" />
<icon src="res/icon/blackberry/icon-80.png"     gap:platform="blackberry" gap:state="hover"/>
<icon src="res/icon/ios/icon-57.png"            gap:platform="ios"        width="57"    height="57" />
<icon src="res/icon/ios/icon-72.png"            gap:platform="ios"        width="72" height="72" />
<icon src="res/icon/ios/icon-57-2x.png"         gap:platform="ios"        width="114" height="114" />
<icon src="res/icon/ios/icon-72-2x.png"         gap:platform="ios"        width="144" height="144" />
<icon src="res/icon/webos/icon-64.png"          gap:platform="webos" />
<icon src="res/icon/windows-phone/icon-48.png"  gap:platform="winphone" />
<icon src="res/icon/windows-phone/icon-173.png" gap:platform="winphone"   gap:role="background" />

<gap:splash src="res/screen/android/screen-ldpi-portrait.png"  gap:platform="android" gap:density="ldpi" />
<gap:splash src="res/screen/android/screen-mdpi-portrait.png"  gap:platform="android" gap:density="mdpi" />
<gap:splash src="res/screen/android/screen-hdpi-portrait.png"  gap:platform="android" gap:density="hdpi" />
<gap:splash src="res/screen/android/screen-xhdpi-portrait.png" gap:platform="android" gap:density="xhdpi" />
<gap:splash src="res/screen/blackberry/screen-225.png"         gap:platform="blackberry" />
<gap:splash src="res/screen/ios/screen-iphone-portrait.png"    gap:platform="ios"     width="320" height="480" />
<gap:splash src="res/screen/ios/screen-iphone-portrait-2x.png" gap:platform="ios"     width="640" height="960" />
<gap:splash src="res/screen/ios/screen-ipad-portrait.png"      gap:platform="ios"     width="768" height="1024" />
<gap:splash src="res/screen/ios/screen-ipad-landscape.png"     gap:platform="ios"     width="1024" height="768" />
<gap:splash src="res/screen/windows-phone/screen-portrait.jpg" gap:platform="winphone" />
</widget> 
```

从phonegap网站构建时我必须写权限吗？！！！

安卓

应用程序/res/xml/config.xml

应用程序/AndroidManifest.xml

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:09:01.993

您必须添加地理位置功能：

```
<feature name="http://api.phonegap.com/1.0/geolocation"/> 
```

# javascript - Angularjs - 我在注射时做错了什么？

> ID：14693607
> 
> 赞同：0
> 
> 时间：2013-02-04T19:00:05.763
> 
> 标签：javascript, angularjs, dependency-injection

[在我之前的问题](https://stackoverflow.com/questions/14688290/inject-dependencies-in-run-method-of-the-module-in-angularjs/14688455#14688455)中，我得到了一个关于注入依赖项的热门答案，当我对其进行测试时，一切都运行良好。然后我重构了代码并想启动应用程序实现，但注入停止工作:( [http://jsbin.com/alemik/1/edit](http://jsbin.com/alemik/1/edit)

除了jsbin，这里是源：

```
var ABCS = angular.module("ABCS", []);
ABCS.Configuration = angular.module('ABCS.Configuration', []);
ABCS.Controllers = angular.module('ABCS.Controllers', []);
ABCS.Modules = angular.module("ABCS.Modules", []);
ABCS.Services = angular.module("ABCS.Services", []);

ABCS.run(["$rootScope", "$location", "ABCS.Services.LogService",
         function ($rootScope, $location, logger) {
             logger.log("app start");
         }]);

ABCS.Configuration.factory("Environment", function () {
    return {
        logOutputElementId: "output",
        hasConsole: console && console.log
    }
});

//Log service
ABCS.Services.LogService = function (config) {
    this.log = function (message) {
        if (typeof (config.Environment.logOutputElementId) === "string") {
            document.getElementById(config.Environment.logOutputElementId).innerHTML += message + "<br/>";
        }
        else if (config.Environment.hasConsole) {
            console.log(message);
        }
        else {
            alert(message);
        }
    };
};
ABCS.Services.LogService.$inject = ["ABCS.Configuration"];
ABCS.Services.factory("ABCS.Services.LogService", ABCS.Services.LogService); 
```

我想念什么？为什么不能在当前结构中注入 ABCS.Services.LogService。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:34:08.157

当您有多个模块时，您需要确保声明模块的依赖关系。这告诉依赖注入器在查找提供程序时查看这些模块。

```
var ABCS = angular.module("ABCS", [
    'ABCS.Services', 'ABCS.Configuration', 'ABCS.Controllers',
    'ABCS.Modules', 'ABCS.Services'
]); 
```

我必须进行一些调整才能使其正常工作：

*   依赖注入器不会注入整个模块，因此`ABCS.Services.LogService.$inject = ["ABCS.Configuration"];`无法正常工作。我已将其更改为`ABCS.Services.LogService.$inject = ["ABCS.Configuration.Environment"];`并调整了关联的工厂以符合您的命名约定。
*   `factory`接受一个函数，但不会将其作为构造函数调用，因此`this`在您的定义中使用`LogService`不会像您期望的那样起作用。我已更改您的工厂函数以定义构造函数，然后实例化并返回该构造函数。

在此处查看工作版本：http: [//jsbin.com/alemik/2/edit](http://jsbin.com/alemik/2/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:58:15.870

在我看来，这就是 angularJS 的做事方式（尽管我保留了所有 DI 定义）：

```
angular.module("ABCS", ['ABCS.Services', 'ABCS.Configuration', 'ABCS.Controllers', 'ABCS.Modules', 'ABCS.Services']);
angular.module('ABCS.Configuration', []);
angular.module('ABCS.Controllers', []);
angular.module("ABCS.Modules", []);
angular.module("ABCS.Services", []);

angular.module("ABCS").run(["$rootScope", "$location", "ABCS.Services.LogService",
         function ($rootScope, $location, logger) {
             logger.log("app start");
         }]);

angular.module('ABCS.Configuration').factory("ABCS.Configuration.Environment", function () {
    return {
        logOutputElementId: "output",
        hasConsole: console && console.log
    };
});

angular.module("ABCS.Services").factory("ABCS.Services.LogService",["ABCS.Configuration.Environment",function (environment) {
  function LogService() {
    this.log = function (message) {
        if (typeof (environment.logOutputElementId) === "string") {
            document.getElementById(environment.logOutputElementId).innerHTML += message + "<br/>";
        }
        else if (environment.hasConsole) {
            console.log(message);
        }
        else {
            alert(message);
        }
    }
  }

  return new LogService();
}]); 
```

angularJS 允许在多个文件中重新打开一个模块定义，并且 javascript 命名空间是完全不必要的，除非对象对 angularJS 应用程序不紧。

混合 javascript 命名空间和 DI 命名空间使代码更容易出错，而不是更易于维护。

# jquery - jQuery - 最新版本的奇怪切换行为

> ID：14693608
> 
> 赞同：0
> 
> 时间：2013-02-04T19:00:18.063
> 
> 标签：jquery, html, cdn

这个问题确实让我困惑了很长一段时间，最终解决方案是强制从 Google CDN 加载旧版本的 jQuery。

我用这种结构构建了一个菜单：

```
<ul>
<li class="top-nav">
<a href="#">Top Item One</a>
<ul class="sub-nav hidden">
<li>Sub Item One</li>
<li>Sub Item Two</li>
<li>Sub Item Three</li>
</ul>
</li>

<li class="top-nav">
<a href="#">Top Item Two</a>
<ul class="sub-nav hidden">
<li>Sub Item One</li>
<li>Sub Item Two</li>
<li>Sub Item Three</li>
</ul>
</li>

... etc ...

</ul> 
```

我有一个非常简单的切换功能，因此当单击“顶部导航”时，子导航会向下滑动并出现。

```
$('li.nav-top>a').toggle(function(){
    $(this).addClass('active');
    $(this).siblings('.nav-sub').slideDown(100);
}, function(){
    $(this).removeClass('active');
    $(this).siblings('.nav-sub').slideUp(100);
}); 
```

令人难以置信的令人困惑的是，在最新版本的 jQuery 中，这段代码会导致所有`top-nav`列表项折叠并消失，我不知道为什么，因为它只是一个切换，甚至没有针对顶级项目！

（网站是 www.sjofasting.no）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:07:07.730

选择器中的类和标记中的类不一样，`toggle()`已弃用，您可能应该阻止锚的默认操作以避免滚动到顶部？

```
$('li.top-nav > a').on('click', function(e){
    e.preventDefault();
    $(this).toggleClass('active')
           .next('.sub-nav').slideToggle(100);
}); 
```

# c - setrlimit() 不改变值

> ID：14693620
> 
> 赞同：1
> 
> 时间：2013-02-04T19:01:01.270
> 
> 标签：c

我的计算机每个进程接受 380 个线程。我尝试使用 settlimit () 增加到更大的数字，但我得到了预期的结果。

我怎样才能增加进程的数量？

以下代码无法正常工作：

```
 #include <stdio.h>
    #include <string.h>
    #include <pthread.h>
    #include <stdlib.h>
    #include <unistd.h>

    #include <sys/time.h>
    #include <sys/resource.h>
    #include <errno.h>

    void *doSomeThing()
    {
        pthread_detach(pthread_self());
        sleep(1);
        pthread_exit(NULL);
    }

    int main(void)
    {
        struct rlimit rlim;
        pthread_t tid;
        int i;

        if (getrlimit(RLIMIT_NPROC, &rlim) != 0) {
            printf("Can't call getrlimit(): [%s]\n", strerror(errno));
            exit(0);
        }

        rlim.rlim_cur = 1000;
        rlim.rlim_max = 1200;
        if (setrlimit64(RLIMIT_NPROC, &rlim) != 0) {
            printf("Error: getrlimit()\n");
            exit(0);
        }

        /* Create threads */
        for (i=0; i<385; i++)  {
            if (pthread_create(&tid, NULL, doSomeThing, NULL) != 0)
                printf("Can't create thread %d:[%s]\n", i, strerror(errno));
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:36:07.553

减小 pthread 堆栈的大小，这应该允许您在系统上安装更多线程。

```
pthread_attr_init(&attr);
assert(pthread_attr_setstacksize(&attr, 1<<16) == 0);
for (i=0; i<2048; i++) 
    assert(pthread_create(&tid, &attr, doSomeThing, NULL) == 0); 
```

或者，使用 setrlimit 减小堆栈大小

```
rlim.rlim_cur=4096;
rlim.rlim_max=4096;
setrlimit64(RLIMIT_NPROC, &rlim); 
```

# sql - 在 SQL Server 的 select 语句中返回 SP 的结果

> ID：14693630
> 
> 赞同：0
> 
> 时间：2013-02-04T19:01:39.100
> 
> 标签：sql, sql-server, tsql, stored-procedures

我想知道如何在 select 语句中返回 SP 的结果？我有多个报告需要使用我在 SP 中编写的相同代码，其中 SP 的内容可能每年更改 2-3 次。

选择语句将如下所示：

```
select Product, Cost, [Output from SP where input is Product Code] from table1 
```

我的存储过程旨在接受“产品代码”，然后返回存储桶类型：

```
ALTER PROCEDURE Product_Bucket_Type (@productcode nvarchar(4)= NULL, @bucket nvarchar(30) OUTPUT)

AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

Select
    @bucket = Case
    WHEN @productcode IN ('20','22', '26','27','28','2A','2B') THEN 'CA'
    WHEN @productcode IN ('30','32','33','34','35','36','37','38','3A','3B','3C','3R') THEN 'NU' 
    WHEN @productcode IN ('31','43') THEN 'Regulators' 
    WHEN @productcode IN ('40','41','43A','43B','47','48','4A','4B','4F')THEN 'WH'
    WHEN @productcode IN ('50','57','58','5A','5B')THEN 'SN' 
    WHEN @productcode IN ('90','97','98','99','9A','9B','9F') THEN 'QC'
    WHEN @productcode IN ('2J','B01','B02','B03','B04','B05','B06','B07','B08','B09','B10','B11','B12','B13','B14','B15','B16','B17','B23','B24','B25','B28','B29','B30') THEN 'BI' 
    WHEN @productcode IN ('2R','2S','2W','B00','2SA','2SB','2SC','2SD','2SE','2SF','2SG','2SH','2SI','2SJ','2SK','2SL','2SM','2SN','2SO','2SP','2SQ','2SR','2SS','2ST','2SU','2SV','2H','2HA','2T','2TA','2TB','24C','2M') THEN 'TU' 
    WHEN @productcode IN ('21','23','2G','2F','21A') THEN 'GA' 
    WHEN @productcode IN ('2XA','2XB','2XC','2XD','2XE','2XF','2XG','2XH','2XI','2XJ','2XK','2XL','2XM','2XN','2XO','2XP','2XQ','Y0') THEN 'OU' 
    WHEN @productcode IN ('Y7') THEN 'NC'       
    WHEN @productcode IN ('Y8') THEN 'CH' 
    WHEN @productcode IN ('Y9') THEN 'CU' 
    WHEN @productcode IN ('Y1') THEN 'OU'    
    WHEN @productcode IN ('4P') THEN 'PR'
    ELSE 'OTHER'
    END
    if @productcode < '20' SET @bucket = 'SW'
END
GO 
```

我是编写存储过程的新手，所以我假设我的输入和输出语法在 SP 中是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:59:51.480

我将把我的简短评论变成一个适合你的答案。要提供即时解决方案，您可以将存储过程更改为标量值函数：

```
CREATE FUNCTION [dbo].[Product_Bucket_Type] (
    @productcode nvarchar(4)= NULL
) RETURNS nvarchar(30)
AS BEGIN   
    DECLARE @bucket nvarchar(30)
    Select
         @bucket = Case
         WHEN @productcode IN ('20','22', '26','27','28','2A','2B') THEN 'CA'
         ...
    RETURN @bucket
END 
```

现在您可以将查询运行为`SELECT Product, Cost, dbo.Product_Bucket_Type(Product) AS whatever FROM ...`

更好的是，您遵循 Beth 和 Gordon 的建议，将您的代码分成 1 或 2 个您加入查询的表。如果不正确了解您的表目前的样子，这有点难以说 - 作为一个疯狂的猜测，我会将这个（伪结构）放在一起：

> 表 ProductCodes (ID, ProductCode)
> 1 '20'
> 2 '2XA'
> 3 '2XB'
> 等等
> 
> 表 BucketTypes (id, BucketType)
> 1 'CA'
> 2 'OU'

...（取决于 1:n、n:1 或 n:m 连接，这很难看到，您可能需要类似这样的 n:m 连接

> 表 ProductCodes_Link_BucketType (ProductCodes_ID, BucketTypes_ID)
> 1 1
> 2 2
> 3 2

不知道什么可能符合您的要求，所以我将保留它。希望能帮助到你。

# apple-push-notifications - 向多个设备（即超过 3000 个设备）发送 APNS 推送时出错

> ID：14693634
> 
> 赞同：1
> 
> 时间：2013-02-04T19:01:59.743
> 
> 标签：apple-push-notifications

```
[Tue Feb 05 00:16:13 2013] [error] [client 112.11.122.37] PHP Warning:  stream_socket_client(): unable to connect to ssl://17.149.38.141:2195 (Connection timed out) in /chroot/updateapp_push.php on line 72 
[Tue Feb 05 00:16:13 2013] [error] [client 112.11.122.37] PHP Warning:  fwrite() expects parameter 1 to be resource, boolean given in /chroot/updateapp_push.php on line 87
[Tue Feb 05 00:16:13 2013] [error] [client 112.11.122.37] PHP Warning:  fclose() expects parameter 1 to be resource, boolean given in /chroot/updateapp_push.php on line 90 
```

我在向超过 3000 台设备的多个设备发送推送通知时遇到了上述错误。有什么建议可以处理吗？

代币数量在循环中的代码：

// 私钥的密码（ck.pem 文件）

```
$pass = 'push'; 
```

// 从 http get 或命令行获取参数

```
 $message = 'Application(s) update available';
        //$badge = (int)$_GET['badge'] or $badge = (int)$argv[2];
        $badge = $count_update;
        //$sound = $_GET['sound'] or $sound = $argv[3]; 
```

// 构造通知负载

```
 $body = array();
                $body['aps'] = array('alert' => $message);
                if ($badge)
                    $body['aps']['badge'] = $badge;

                /* End of Configurable Items */

                $payload = json_encode($body);
                $ctx = stream_context_create();
                stream_context_set_option($ctx, 'ssl', 'local_cert', 'ckappmart.pem'); 
```

// 假设私钥密码被移除。

```
 stream_context_set_option($ctx, 'ssl', 'passphrase', $pass);
                $fp = stream_socket_client('ssl://17.172.238.221:2195', $err, $errstr, 60, STREAM_CLIENT_CONNECT, $ctx);

                if (!$fp) {
                    //print "Failed to connect $err $errstrn";
                }
                else {
                    //print "Connection OKn";
                }

                if($num_getNonMdmPushToken!=0) {
                    for($count=0;$count<1;$count++) {
                        $msg = chr(0) . pack("n",32) . pack('H*', str_replace(' ', '', $deviceToken[$count])) . pack("n",strlen($payload)) . $payload;
                        //print "sending message :" . $payload . "n";
                        fwrite($fp, $msg);
                    }
                }
                fclose($fp); 
```

# javascript - KineticJS Inside of Shape 和/或 Fill 未在 Windows 8 下的 Chrome 中呈现

> ID：14693636
> 
> 赞同：2
> 
> 时间：2013-02-04T19:02:08.657
> 
> 标签：javascript, html, cross-browser, cross-platform, kineticjs

我创建了一个简单的多人数学游戏，它在客户端使用 KineticJS。我在 Linux 中开发它，一切似乎都运行良好，所有的编码都很顺利。前几天我注意到，当在 OS X 10.8 (Mountain Lion) 上运行它时，我的提交按钮和输入事件将不起作用。它在安装了 10.7 (Lion) 的 iMac 上运行。今天我将我的笔记本电脑启动到我不经常这样做的 Windows 8 并尝试运行我的应用程序。

这是我的实时网络应用程序的链接：**[Get24](http://get24.jit.su)**

这是 Github 项目的链接：[**CoryG89/Get24**](http://github.com/CoryG89/Get24)

我还为此打开了一个[**Github 问题**](https://github.com/ericdrowell/KineticJS/issues/311)。

但是，当我尝试在 Windows 8 上的 Chrome 中运行我的应用程序时，页面的布局一团糟。按钮没有着色，并且鼠标悬停事件的目标区域没有与按钮对齐。游戏无法使用。控制台中没有错误。在 Windows 中使用 Firefox 可以得到与在 Linux 下运行的任何浏览器相似的结果，它可以完美运行。

谁能告诉我为什么我的应用程序似乎如此依赖操作系统/浏览器。难道我做错了什么？有没有其他人有过 KineticJS 在不同浏览器和操作系统下工作不一样的经验？

### 2013 年 3 月 6 日更新

* * *

在进一步弄乱了我的简单游戏之后，我注意到按钮上的`mouseover`和`click`事件仅在 Chrome Windows 8 中起作用。我创建了这个[**简单的 jsFiddle**](http://jsfiddle.net/CoryG89/kZBzH/)，当在我的计算机上的 Windows 8 上的 Chrome 中查看时，只会呈现填充矩形对象。底部的矩形显示，当使用`draggable`或`click`事件时，只有矩形的笔划会对鼠标做出反应。最后，我浏览了网络，这个[**官方教程 KineticJS 形状填充属性**](http://www.html5canvastutorials.com/kineticjs/html5-canvas-set-fill-with-kineticjs/)在 Windows 8 上的 Chrome 中查看时也有同样的问题。Firefox 渲染它就好了。

有没有人有办法让填充属性在 Chrome 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:29:48.507

好的，所以我觉得很愚蠢，因为当我发布这个问题时，新版本的 KineticJS 已经发布了。他们没有在更改日志中列出正在修复的这个错误，但是，从 v4.3.1 更新到 v4.3.3 为我修复了这个问题。我的网络应用程序现在可以在 Chrome Win8 中正常运行。从官方 KineticJS 页面链接到的教程仍在运行旧版本，并且在 Chrome Win8 中填充已损坏。如果将来有人遇到此问题，只需确保您使用的是最新版本的 Kinetic。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T11:11:12.243

版本之间的语法也有一些变化。从女巫版本中并没有真正意识到形状语法发生了变化，但是从 4.​​0.5 更新到 4.4.0 您需要进行以下更改才能使其工作

更新到 4.4.0 然后...

```
 var circle = new Kinetic.Shape({
  //4.0.5 returns context instead of canvas
      drawFunc: function(canvas) {
        /*set var context geting that from canvas, As i said the new drawFunc returns canvas instead of context*/
        var context = canvas.getContext();

        context.beginPath();
        context.moveTo(0, 0);
        context.arc(0, 0, (that.parameters.radius/2)-10, Math.PI*take_PI_from_o(angle.end.value), Math.PI*take_PI_from_o(angle.start.value), true);            
        context.closePath();

        //the following two commands are droped
        //this.fill(context); 
        //this.stroke(context);

        //and replaced with this one
        canvas.fillStroke(this);
      },
      fill: "#54CAFF",
      stroke: "#858585",
      strokeWidth: 4,
      rotationDeg:-90,
      x: angle.stage.getWidth() / 2,
      y: angle.stage.getHeight() / 2,

    }); 
```

# mysql - 如何通过包含空值来编写查询

> ID：14693637
> 
> 赞同：0
> 
> 时间：2013-02-04T19:02:17.603
> 
> 标签：mysql

我有一个查询

```
SELECT sum(cash)  from bought_cash WHERE uid=1 AND source NOT IN ('a', 'b') 
```

结果为`140`

和

```
 SELECT sum(cash)  from bought_cash WHERE uid=1 AND source  IN ('a', 'b') 
```

给`NULL`

和

```
SELECT sum(cash)  from bought_cash WHERE uid=1 
```

结果为`240`

和

```
SELECT sum(cash)  from bought_cash WHERE uid=1 and source is null 
```

结果为`100`

如何编写查询，以便第一个查询`240`通过包含空值来给出结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:09:48.937

您也可以尝试下一个：

```
select sum(cash) 
from bought_cash
where uid = 1 and (source is null or source not in ('a', 'b')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:06:33.883

你可以尝试这样的事情：

```
select sum(cash) from bought_cash 
    where uid=1 and isnull(source, 'c') not in ('a', 'b') 
```

这应该将空条目映射到值“c”，它不是“a”或“b”，因此应该包含在结果集中。

# android - Android：SlidingDrawer 就像 Android 主窗口中的一样

> ID：14693638
> 
> 赞同：0
> 
> 时间：2013-02-04T19:02:17.883
> 
> 标签：android, handle, slidingdrawer

我在我的应用程序中实现了一个 SlidingDrawer，到目前为止一切正常。

然后我做了一个不可见的句柄，就像 Android 主窗口中的那个。

现在我想要，只需将手指移到手柄上，就可以抓住手柄（并使其可见）。我的意思是与 Android 主窗口中的行为相同。

但我不知道如何处理。（目前它仅在您点击手柄时有效，如果您点击其他地方并将手指移到手柄上方则无效）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:12:23.247

听起来是个坏主意。将无法区分系统的抽屉和应用程序的抽屉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:50:49.760

您想要检测从顶部挡板开始的[滑动动作。](http://developer.android.com/design/patterns/gestures.html)

您想使用 MotionEvent 的[getEdgeFlags()](http://developer.android.com/reference/android/view/MotionEvent.html#getEdgeFlags%28%29)来检测是否在边框上开始滑动手势。

# php - SoundCloud oAuth 令牌 - 对初始“连接”后如何登录感到困惑

> ID：14693640
> 
> 赞同：1
> 
> 时间：2013-02-04T19:02:20.183
> 
> 标签：php, javascript, api, soundcloud

来自文档：

> 您现在应该将访问令牌存储在数据库中。将其与其所属的用户关联并从现在开始使用它，而不是通过授权流程发送用户。

在前端，我们正在使用 javascript 连接函数，但是我们希望 PHP 端将一些用户信息写入数据库。

我了解如何实际接收授权/令牌并实施。然后我将令牌存储在用户 ID（我们生成的）旁边的用户数据库中。没关系。

但是当用户重新访问我们的应用程序并登录到 Soundcloud 时，我该如何处理这个令牌？如上所述，我应该自动登录吗？这里的过程到底是什么？我对必须检查的内容感到困惑。

# php - PHP 守护进程并与之交互

> ID：14693642
> 
> 赞同：0
> 
> 时间：2013-02-04T19:02:56.790
> 
> 标签：php, daemon

> **可能重复：**
> [将 php 脚本作为守护进程运行](https://stackoverflow.com/questions/2036654/run-php-script-as-daemon-process)

我正在开发一个与 Twitter API 密切合作的网络应用程序。基本上每次用户单击特定按钮时，我都需要将此操作记录到我的数据库中（1）并通过 API（2）代表用户发布推文。由于这些动作以某种方式相互关联，因此它们必须“同时”发生，或者更准确地说，如果 (1) 成功，则发布推文 (2)。在本地数据库中添加一行 (1) 是一个瞬间，发生在 <1 毫秒或更短的时间内，但 twitter API 很慢，因此可能需要 600 毫秒以上才能成功，最终用户等待那么长时间是不可接受的，不是提到有时它可能会更慢甚至更糟，超时。

所以我在想是否有办法让 PHP 脚本像服务器一样接受请求并在它们到来时将它们排队。当然我可以每次都启动一个脚本，但想象一下同时启动 100 个脚本，这将导致巨大的内存使用和开销，从而在他们完成工作时杀死它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:07:14.967

这是 PHP 守护程序教程的“圣经”。

[http://kvz.io/blog/2009/01/09/create-daemons-in-php/](http://kvz.io/blog/2009/01/09/create-daemons-in-php/)

**当心，检查旧版警告**。

# linux - 为什么单声道下linux上的.net程序无法运行？

> ID：14693643
> 
> 赞同：2
> 
> 时间：2013-02-04T19:03:02.720
> 
> 标签：linux, mono, delphi-prism, oxygene

我在 Mono 下的 Linux 上运行了我的 Delphi-prism (.NET) 程序。它运行了一段时间并在终端上出现以下错误消息而崩溃。但同样的程序在 Windows 7 上运行得非常好

谁能告诉我为什么？

```
Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object
  at System.Windows.Forms.XEventQueue+PaintQueue.Dequeue () [0x00000] in <filename unknown>:0
  at System.Windows.Forms.XplatUIX11.GetMessage (System.Object queue_id, System.Windows.Forms.MSG& msg, IntPtr handle, Int32 wFilterMin, Int32 wFilterMax) [0x00000] in <filename unknown>:0
  at System.Windows.Forms.XplatUI.GetMessage (System.Object queue_id, System.Windows.Forms.MSG& msg, IntPtr hWnd, Int32 wFilterMin, Int32 wFilterMax) [0x00000] in <filename unknown>:0
  at System.Windows.Forms.Application.RunLoop (Boolean Modal, System.Windows.Forms.ApplicationContext context) [0x00000] in <filename unknown>:0
  at System.Windows.Forms.Application.Run (System.Windows.Forms.ApplicationContext context) [0x00000] in <filename unknown>:0
  at System.Windows.Forms.Application.Run (System.Windows.Forms.Form mainForm) [0x00000] in <filename unknown>:0
  at Millennia.Program.Main (System.String[] args) [0x00000] in <filename unknown>:0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T10:04:09.310

看起来您的程序正在使用 Windows 窗体。对 Windows 窗体的支持在单声道中并不是最好的。Mono 提供了运行时和库，但是如果你想制作一个跨平台的程序，你还需要考虑你使用的 UI 库。

**更新（2016 年）：**

我原来的答案可能是错误的。根据[this page](http://www.mono-project.com/docs/gui/winforms/)，对Windows Forms 2.0 的支持已经完成，但是可能还有一些bug，我没有尝试过。但是，如果您使用第三方 UI 库，例如 Infragistics，它们可能由于本机调用而无法工作。

查看[此页面](http://www.mono-project.com/docs/gui/winforms/porting-winforms-applications/)以获取有关移植 Winforms 应用程序的更多信息，包括可以提供帮助的工具 MoMA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-11T15:50:52.630

我有同样的问题（.net、Linux、Mono）。我的程序有一个提供者-订阅者模式。提供者在另一个线程上。主窗体订阅了提供者。当它被触发时：

```
 private void RefreshLabels(ParameterMap pm)
    {
        string StateValueKey = string.Empty;
        string svkValue = string.Empty;

        if (InvokeRequired)
        {
            BeginInvoke(new RefreshItemsDelegate(RefreshLabels), new object[] { pm });
        }
        else
        { 
```

.....它来自另一个线程并完成它的工作。

另一个订阅者也在主窗体上触发了一个事件。我忽略了这个事件，问题消失了。

# python - 使用 Python 写入 CSV 会添加空行

> ID：14693646
> 
> 赞同：76
> 
> 时间：2013-02-04T19:03:17.147
> 
> 标签：python, csv, python-3.3

我正在尝试写入 CSV 文件，但中间有空白行。如何删除空白行？

```
import csv
b = open('test.csv', 'w')
a = csv.writer(b)
data = [['Me', 'You'],\
        ['293', '219'],\
        ['54', '13']]
a.writerows(data)
b.close() 
```

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-02-04T19:15:43.720

在 Python 3 中，您使用`csv`模块的方式在几个方面[（文档）](http://docs.python.org/dev/library/csv.html#csv.writer)发生了变化，至少在您需要如何打开文件方面。无论如何，像

```
import csv
with open('test.csv', 'w', newline='') as fp:
    a = csv.writer(fp, delimiter=',')
    data = [['Me', 'You'],
            ['293', '219'],
            ['54', '13']]
    a.writerows(data) 
```

应该管用。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-02-04T19:05:36.027

如果您在 Windows 上使用 Python 2.x，则需要将您的行更改`open('test.csv', 'w')`为`open('test.csv', 'wb')`. 也就是说，您应该将文件作为[二进制文件打开](http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)。

但是，正如其他人所说，文件接口在 Python 3.x 中发生了变化。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-04T19:10:26.983

```
import csv

hello = [['Me','You'],['293', '219'],['13','15']]
length = len(hello[0])

with open('test1.csv', 'wb') as testfile:
    csv_writer = csv.writer(testfile)
    for y in range(length):
        csv_writer.writerow([x[y] for x in hello]) 
```

会产生这样的输出

```
Me You
293 219
13 15 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-04T19:06:57.773

您需要以二进制`b`模式打开文件以处理 Python 2 中的空白行。这在 Python 3 中不是必需的。

因此，更改`open('test.csv', 'w')`为`open('test.csv', 'wb')`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-23T12:59:18.560

[Pyexcel](http://pyexcel.readthedocs.org/en/latest/)在 Python2 和 Python3 上都能很好地工作，没有任何问题。

使用 pip 快速安装：

```
pip install pyexcel 
```

之后，只需要 3 行代码就完成了：

```
import pyexcel
data = [['Me', 'You'], ['293', '219'], ['54', '13']]
pyexcel.save_as(array = data, dest_file_name = 'csv_file_name.csv') 
```

# c# - 无法使用函数返回交换的整数

> ID：14693647
> 
> 赞同：0
> 
> 时间：2013-02-04T19:03:50.087
> 
> 标签：c#, function

我被要求“编写一个交换两个整数的函数（我不允许为此使用算术或布尔运算符）并返回结果”不幸的是我遇到了一个小问题。我想我已经设法使用建议的 XOR 算法交换整数，但我不确定如何返回值。我在编程方面很差，但我希望我已经充分解释了这一点。

这是到目前为止的代码：

```
static void Main(string[] args)
{
    //numberSwap?(int number1, int number2)
}

public int numberSwap(int number1, int number2)
{
    number1 ^= number2;
    number2 ^= number1;//I think this is correct
    number1 ^= number2;

    int result = number1, number2;
    return result;// I think I may have this wrong
} 
```

如上所述，我认为我可能有结果分配并返回错误以及被调用的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:07:12.247

数字没有被交换的原因是因为你传递了参数`by value`，你应该传递参数`by reference`

* * *

传递参数`By Value`：创建发送给参数的变量的副本。
传递参数`By Reference`会修改传递的参数，并且不会创建变量的任何副本。

* * *

您的功能逻辑是正确的，`tiny`您唯一错过的就是通过它`As Reference`

```
public void numberSwap(ref int number1, ref int number2)
{
    number1 ^= number2;
    number2 ^= number1;
    number1 ^= number2;
} 
```

并且对函数的调用必须是这样的：

```
static void Main(string[] args)
{
    int n1 = 5, n2 = 10;
    numberSwap(ref n1, ref n2)
} 
```

# vb.net - 检查文件名的一部分是否存在

> ID：14693651
> 
> 赞同：5
> 
> 时间：2013-02-04T19:03:55.557
> 
> 标签：vb.net, file-exists

所以我知道在下面的代码示例中，它会检查文件是否存在（完整文件名）......

```
If My.Computer.FileSystem.FileExists("C:\Temp\Test.cfg") Then
   MsgBox("File found.")
Else
   MsgBox("File not found.")
End If 
```

...但是如果 a 文件的一部分存在怎么办？文件没有标准命名约定，但它们始终具有 .cfg 扩展名。

所以我想检查 C:\Temp 是否包含 *.cfg 文件，如果它存在，请执行某些操作，否则执行其他操作。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-04T19:08:17.637

`*`char 可用于定义简单的过滤模式。例如，如果您使用`*abc*`它，它将查找名称中包含“abc”的文件。

```
Dim paths() As String = IO.Directory.GetFiles("C:\Temp\", "*.cfg")
If paths.Length > 0 Then 'if at least one file is found do something
    'do something
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:22:02.500

您可以使用带有通配符的 FileSystem.Dir 来查看是否有文件匹配。

来自[MSDN](http://msdn.microsoft.com/en-us/library/t4a2w9xx.aspx)

```
Dim MyFile, MyPath, MyName As String 
' Returns "WIN.INI" if it exists.
MyFile = Dir("C:\WINDOWS\WIN.INI")   

' Returns filename with specified extension. If more than one *.INI 
' file exists, the first file found is returned.
MyFile = Dir("C:\WINDOWS\*.INI")

' Call Dir again without arguments to return the next *.INI file in the 
' same directory.
MyFile = Dir()

' Return first *.TXT file, including files with a set hidden attribute.
MyFile = Dir("*.TXT", vbHidden)

' Display the names in C:\ that represent directories.
MyPath = "c:\"   ' Set the path.
MyName = Dir(MyPath, vbDirectory)   ' Retrieve the first entry.
Do While MyName <> ""   ' Start the loop.
      ' Use bitwise comparison to make sure MyName is a directory. 
      If (GetAttr(MyPath & MyName) And vbDirectory) = vbDirectory Then 
         ' Display entry only if it's a directory.
         MsgBox(MyName)
      End If   
   MyName = Dir()   ' Get next entry.
Loop 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-13T23:50:16.143

您可以使用 System.IO 中的 Path.GetExtension 来获取扩展名并测试它是否是您正在寻找的“.cfg”。如果没有扩展名，Path.GetExtension 返回一个空字符串。

来自[MSDN](https://msdn.microsoft.com/en-us/library/system.io.path.getextension(v=vs.110).aspx)

# actionscript-3 - 当 TextField 不是 DisplayContainer 的子级时出现在舞台上？

> ID：14693660
> 
> 赞同：0
> 
> 时间：2013-02-04T19:04:31.203
> 
> 标签：actionscript-3, textfield, children, stage, addchild

真的需要一些帮助来了解之后发生的事情

```
textFields[i].text = thisWord.charAt(i); 
```

我知道它会更新该特定索引处的值，但我无法弄清楚它为什么会影响：

```
textContainer.addChild(tempText);
textFields.push(tempText); 
```

发生变化的值出现在舞台上，但我不明白为什么，因为它从未作为 textContainer 的子项添加。

```
var loader:URLLoader;
var allWords:Array;
var thisWord:String;

var textContainer:MovieClip;

var textFields:Array;
var textStyle:TextFormat;
var underline:MovieClip;

function init():void
{
    loader = new URLLoader();
    allWords = new Array();

    textContainer = new MovieClip();
    textFields = new Array();

    textStyle = new TextFormat();
    textStyle.font = "Courier New";
    textStyle.size = 48;
    textStyle.bold = true;

    textContainer.y = stage.stageHeight / 2 - 50;
    addChild(textContainer);

    loader.load(new URLRequest("words.txt"));
    loader.addEventListener(Event.COMPLETE, textLoaded);
    guess_btn.addEventListener(MouseEvent.CLICK, guess);

}

function textLoaded(event:Event):void
{
    var tempText:TextField;

    var stringOfWords:String = event.target.data;
    allWords = stringOfWords.split(",");
    thisWord = allWords[Math.floor(Math.random() * allWords.length)];
    trace(thisWord);

    for (var i:uint = 0; i < thisWord.length; i++)
    {
        tempText = new TextField();
        tempText.defaultTextFormat = textStyle;
        tempText.name = "textField" + i;
        tempText.text = "1";//for restart

        tempText.width = 48;
        tempText.x = i * tempText.width;
        tempText.selectable = false;
        textContainer.addChild(tempText);

        textFields.push(tempText);

        if (thisWord.charAt(i) != " ")
        {
            underline = new Underline();
            underline.x = tempText.x + tempText.width / 3;
            underline.y = tempText.y + tempText.height / 2 + 5;
            //textContainer.addChild(underline);
        }
    }

    textContainer.x = stage.stageWidth / 2 - textContainer.width / 2;

}

function guess(event:MouseEvent):void
{
    if (guess_txt.text != "")
    {
        if (thisWord.indexOf(guess_txt.text) != -1)
        {
            for (var i:uint = 0; i < textFields.length; i++)
            {
                if (thisWord.charAt(i) == guess_txt.text)
                {
                    textFields[i].text = thisWord.charAt(i);
                    trace(textFields[i].text);
                }
            }

        }
        else if (guesses_txt.text == "")
        {
            guesses_txt.appendText(guess_txt.text);
        }
        else
        {
            guesses_txt.appendText("," + guess_txt.text);
        }
    }

    guess_txt.text = "";
    findch();
}

init(); 
```

我很确定有一条我遗漏或不理解的规则....

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:19:09.600

你在你的问题中指出它实际上*正在*被添加。您在该循环中创建的每个`tempText`对象都会添加到`textContainer`构造函数中已添加到阶段的对象。

```
textContainer.addChild(tempText); 
```

`textFields[i].text = thisWord.charAt(i);`只是在数组中的特定索引处更新 TextField 的文本。舞台上的文字没有理由*不在*这里更新。

# php - foreach($item) 按类别限制数量

> ID：14693662
> 
> 赞同：0
> 
> 时间：2013-02-04T19:04:38.537
> 
> 标签：php, foreach, limit

我正在尝试限制投资组合脚本中的项目数量。

```
 <?php
    $k = 1;     
    shuffle($items);
    foreach ($items as $item ){ 
    if($k==11) break; ?>
    <li data-id="id-<?php echo($k);  ?>" data-type="<?php echo( ereg_replace("[^A-Za-z0-9]", "", $item->item_category) ); ?>">
    ..........more item listings ....
    </li>
    <?php $k++; }   ?> 
```

我在代码中添加了 shuffle，所以我可以从不同的类别中得到不同的结果，并且我可以限制结果的总数。但是我怎么能限制每个类别的项目数量呢？就像从每个类别中获取 5 个项目然后将它们洗牌？

我无法更改整体功能，因为它是插件的一部分。然而，添加到代码中的一些更改是可能的。有任何想法吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:17:46.440

最好的方法是在重新组合和洗牌*之前获取每个项目的 5 个。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:19:58.980

如果您不能限制传入数据中每个类别的项目数，那么您需要一个数据结构来在输入时对它们进行计数：

```
<?php
$k = 1;
$max_per_category = 5;
$cat_tracker = array();

shuffle($items);

foreach ($items as $item ){ 
    if( $k >= 11 ) {
        break;
    }

    if( ! isset($cat_tracker[$item->item_category]) ) {
        $cat_tracker[$item->item_category] = 1;
    } else if( $cat_tracker[$item->item_category] >= $max_per_category ) {
        continue;
    } else {
        $cat_tracker[$item->item_category]++;
    }

    $frame = '<li data-id="id-%d" data-type="%s">';
    printf($frame, $k, ereg_replace("[^A-Za-z0-9]", "", $item->item_category));
    // more item listings?
    printf('</li>');

    $k++;
} 
```

我还用更干净的东西替换了你的输出代码。像这样进出 PHP 很难阅读和维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:37:32.060

使用 for 而不是 foreach

```
<?php
    $values = shuffle($items);
    for ($k=0 ;$items[k] && $k<11;$k++ ){ 
    >
    <li data-id="id-<?php echo($k);  ?>" data-type="<?php echo( ereg_replace("[^A-Za-z0-9]", "", $items[$k]->item_category) ); ?>">
    ..........more item listings ....
    </li>
    <?
}   

?> 
```

# c# - 将 OberservableCollection 分配给 ListBox 并排除一些条目

> ID：14693664
> 
> 赞同：0
> 
> 时间：2013-02-04T19:04:50.140
> 
> 标签：c#, listbox, observablecollection, inheritance

我从一个接口继承了不同的类，它们都被添加到 OberservableCollection 中。有人可以解释一下如何将 Observablecollection 的所有值分配给我的列表框，b 类除外。

假设（编辑）：

```
private void start()
{
    DP = new MyClass();
    this.ListBox.ItemsSource = new ObservableCollection<WInstance>(MyClass.Handler.Instances.OfType<WInstance>());
}

...
class Handler() : INotifyPropertyChanged
{
   public ObservableCollection<HandlerItem> Instances { get; private set; } 
 ...
}

class HandlerItem: INotifyPropertyChanged
{
    public Instance inst { get; private set; } //Instance could be WInstance or CInstance
} 
```

在运行时 MyClass 从远程计算机接收 WInstance 或 CInstance 的一些对象。如果我尝试使用 Instances.OfType() 解决它，似乎我的 ItemsSource 不会被更新

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:08:43.897

```
var list = new List<Instance>();

//.. add all items to your list here.

ObservableCollection<Instance> OCI = new ObservableCollection<Instance>(list.OfType<classa>());
// the above will generate a new ObservableCollection which contains all items of type classa from list. 
```

# spring - 服务层中的 Spring 事务管理

> ID：14693665
> 
> 赞同：2
> 
> 时间：2013-02-04T19:04:54.773
> 
> 标签：spring, transactions

我正在使用 tomcat 和 Spring 3.1 开发 Maven webapp。数据源在tomcat中定义为JNDI。我正在考虑使用@Transactional 注释。

如何在服务层实现事务？您能否指出我应该使用哪种事务管理的正确方向？JTA、JPA 还是其他？以及如何配置它？我需要哪些依赖项？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:07:32.967

除非那是您的实现，否则您不会使用 JPA。

您使用 JTA 的可能性要大得多。

[这](http://www.baeldung.com/2011/12/26/transaction-configuration-with-jpa-and-spring-3-1/)是一个 Spring 事务教程。

# eclipse - 未出现在 lauch 配置中 - Eclipse

> ID：14693672
> 
> 赞同：1
> 
> 时间：2013-02-04T19:05:19.767
> 
> 标签：eclipse

当我去`File -> Export -> Runnable JAR file`的时候，启动配置是空白的，没有选项可供选择。
我有一个主文件...我已经放置了公共无效的主要内容...它仍然没有出现。

![http://puu.sh/1XsuZ（图片）](../Images/edb5a864c33b63591f6120ec25bff02f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:37:14.003

仅一个`main`文件不足以创建“ [Java Launch 配置](http://wiki.eclipse.org/FAQ_What_is_a_launch_configuration?)”。

您至少需要运行一次“ `Run >Run As >Java Application`”，如“[创建 Java 应用程序启动配置](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.jdt.doc.user/tasks/tasks-java-local-configuration.htm)”中所述。

*然后*，“可运行的 JAR 文件”对话框应该包含一个非空的“Java 启动配置”供您选择。

# report - Report Studio：使用一份报告安排和提示

> ID：14693679
> 
> 赞同：0
> 
> 时间：2013-02-04T19:05:55.303
> 
> 标签：report, cognos

我有一个报告过滤带有日期的 sql 查询。我希望这份报告有两个版本。一个按计划进行（它使用实际月份），另一个提示输入要过滤的日期。

一个应该每月自行运行，另一个将用于几次手动运行。

我可以在没有超过一份报告的情况下执行此操作吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T04:13:05.527

使用两个可能的值创建一个名为 pPeriodType 的提示：“选择日期范围”或“当前月份”

然后在您的报告过滤器中执行以下操作：

```
 (
  ([YourDate] BETWEEN 
  ?pStartDate? AND ?pEndDate?) 
  AND ?pPeriodType? = 'Select Date Range'
  )
OR
  (
  [YourDate] BETWEEN 
  <expression evaluating to start of month based on current date>
  AND 
  <expression evaluating to end of month based on current date>
  AND ?pPeriodType? = 'Current Month'
  ) 
```

现在，当您选择“当前月份”时，无论您选择哪个日期，它都会显示当前月份。当您选择“选择日期范围”时，它将根据所选日期进行过滤。您只需要根据当前日期计算出开始日期和结束日期的表达式。你在什么数据库上运行这个？

# python - Django 多个数据库，Django 最初是否连接到所有数据库？

> ID：14693687
> 
> 赞同：5
> 
> 时间：2013-02-04T19:06:22.233
> 
> 标签：python, mysql, django

MySQL 的示例数据库配置：

```
DATABASES = {
    'auth_db': {
        'NAME': 'auth_db',
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'mysql_user',
        'PASSWORD': 'swordfish',
    },
    'master': {
        'NAME': 'master',
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'mysql_user',
        'PASSWORD': 'spam',
    },
    'slave1': {
        'NAME': 'slave1',
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'mysql_user',
        'PASSWORD': 'eggs',
    },
    'slave2': {
        'NAME': 'slave2',
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'mysql_user',
        'PASSWORD': 'bacon',
    },
} 
```

Django 最初是否会连接到所有这些数据库，即使某些数据库根本没有使用？例如。

对多个数据库使用原始游标

> 如果您使用多个数据库，您可以使用 django.db.connections 来获取特定数据库的连接（和游标）。django.db.connections 是一个类字典对象，允许您使用其别名检索特定连接：
> 
> 从 django.db 导入连接
> 
> 游标 = 连接['my_db_alias'].cursor()

所以在这里，1.连接对象包含已经建立的连接？还是在请求游标时连接？2\. 有没有办法改变这种默认行为并按需建立连接，（所有查询都是原始查询，所有数据库都是 MySQL）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T22:31:08.080

将在第一次访问时使用`django.db.connections`. 也就是说，仅在第一次使用时才对连接进行延迟评估和连接。相关代码在`django/db/__init__.py`类中`ConnectionHandler`。

查询后连接不会自动删除，但连接将一直保持到断开连接。如果存在`DATABASES`从未使用过的条目，则不会与这些数据库建立连接。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-04T19:31:51.683

当没有选择其他数据库时，Django 使用别名为 default 的数据库。如果您没有默认数据库，则需要注意始终指定要使用的数据库。在您的情况下，您不需要用户身份验证等的默认值或 auth_db 吗？

无论如何，连接应该是按需的，您可以连接到 MYSQL Explorer 并发出以下命令以查看活动连接，然后请求游标并再次检查命令结果并进行比较。命令如下...

```
SHOW PROCESSLIST 
```

[http://dev.mysql.com/doc/refman/5.1/en/show-processlist.html](http://dev.mysql.com/doc/refman/5.1/en/show-processlist.html)

请报告您的发现。

# java - 如何在java中将数字转换为布尔数组？

> ID：14693693
> 
> 赞同：0
> 
> 时间：2013-02-04T19:06:42.233
> 
> 标签：java, arrays, boolean, byte

> **可能重复：**
> [在 Java 中将一个字节转换为长度为 4 的布尔数组](https://stackoverflow.com/questions/3058157/convert-a-byte-into-a-boolean-array-of-length-4-in-java)

我目前正在学习java，并制作游戏。我遇到了需要为游戏制作一些**测试数据**的情况。

我使用二维数组（游戏地图）中的图块，每个图块需要**四个 bool-values**。因此，我不想使用 true 或 false 编写图块，而是想使用一个简单的**Byte**，**用****binary**编写。

示例：**“0b0110”**而不是**“假，真，真，假”**

所以我需要一种**将****二进制**写入的Bytes转换为**Boolean****数组**的方法。

 *** * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T19:13:10.990

你可以这样做：

```
byte b = 0b0110;
boolean [] flags = new boolean[4];
for (int i = 0; i < 4; ++i) {
    flags[i] = (b & (1 << i)) != 0;
} 
```

走另一条路：

```
boolean [] flags = {false, true, true, false};
byte b = 0;
for (int i = 0; i < 4; ++i) {
    if (flags[i]) b |= (1 << i);
} 
```

我建议使用`byte`和`boolean`原语，除非您需要将它们装箱`Byte`或`Boolean`出于其他原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:14:16.143

### 布尔到字节

用于将一个`boolean`变量转换为一个`byte`变量：

```
boolean vIn = true;
byte vOut = (byte) (vIn ? 1 : 0); 
```

用于将数组转换`boolean`为数组`bytes`：

```
 boolean[] allBooleans = new boolean[3];
        allBooleans[0] = true;
        allBooleans[1] = false;
        allBooleans[2] = true;
        byte allByte[] = new byte[allBooleans.length];
        for (int i = 0; i < allBooleans.length; i++) {
            allByte[i] = (byte) (allBooleans[i] ? 1 : 0);
        } 
```

### 字节到布尔值

用于将一个`byte`变量转换为一个`boolean`变量

```
byte vIn = 1;
boolean vOut = vIn != 0; 
```

用于将数组转换`bytes`为数组`booleans`

```
 byte[] allBytes = new byte[3];
    allBytes[0] = new Byte("1");
    allBytes[1] = new Byte("0");
    allBytes[2] = new Byte("1");
    boolean allBoolean[] = new boolean[allBytes.length];
    for (int i = 0; i < allBytes.length; i++) {
        allBoolean[i] = allBytes[i] != 0;
    } 
```**

# visual-studio-2012 - OpenCL VisualStudio 2012 错误设置

> ID：14693694
> 
> 赞同：0
> 
> 时间：2013-02-04T19:06:45.760
> 
> 标签：visual-studio-2012, opencl, nvidia

嗨，我正在学习 openCL 并遵循一本书的示例并尝试执行以下操作

```
//Obtain the GPU data (platform, device and context)
PlatformDevice gpu = retrieveDevice(CL_DEVICE_TYPE_GPU);
assert(gpu.allDat![enter image description here][1]aPresent());
const char * kernalSource = "__kernel void multiplication(__global float* GridA, __global float* GridB,__global float* val ){int igrid = get_global_id(0);float a = GridA[igrid];float b = GridB[igrid];val[igrid] = a * b;}";

//Create Program
cl_program program = clCreateProgramWithSource(gpu.context,1, (const char**) kernalSource,NULL,&err); 
```

当我到达最后一行时，它会产生以下错误

```
Unhandled exception at 0x53349301 (nvopencl.dll) in OpenCLPracticeSetup.exe: 0xC0000005: Access violation reading location 0x656B5F5F. 
```

我猜这是 Visual Studio 2012 的设置问题，但由于没有看到 nvopencl.dll 的错误，所以在网上找不到任何东西 这是我更改的属性

c/c++ General - 我的附加包含目录是：\NVIDIA GPU Computing Toolkit\CUDA\v4.2\include\CL Linker General - 我的附加库目录是：\NVIDIA GPU Computing Toolkit\CUDA\v4.2\lib\Win32输入 - OpenCL.lib;kernel32.lib;user32.lib;gdi32.lib;winspool.lib;comdlg32.lib;advapi32.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;odbc32.lib; odbccp32.lib;%（附加依赖项）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T18:37:17.120

我找到了我的问题的答案，我应该参考源代码。

谢谢

# verilog - Verilog Mealy FSM 带 1 个模块

> ID：14693696
> 
> 赞同：-2
> 
> 时间：2013-02-04T19:06:53.387
> 
> 标签：verilog, fsm

我必须为 1 mealy fsm 编写一个 verilog 程序。有很多技巧可以写出来。我会告诉你 1，我想知道它是否也有效（无需提及其他技术，只需说出是否有效以及为什么！）这里是：

```
module MealyFsm(out,in,clk,rst);
  output out;
  input in,clk,rst;

  reg [1:0] q;

  always @(posedge clk or negedge rst) begin
    if (~rst) 
      q<=2'b00;
    else
      begin
        q[0]<=~q[0] &  q[1] &  x | ~q[0] &    x | q[1] &  x;
        q[1]<= q[1] & ~q[0] & ~x | ~q[1] & q[0] | q[0] & ~x;
      end
  end

  assign y = ~x & q[0] & ~q[1];

endmodule 
```

PS。我只对这种技术感兴趣，如果它错了，请尝试告诉我出了什么问题以便修复它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:05:30.447

来自[维基百科](http://en.wikipedia.org/wiki/Mealy_machine)

> 在计算理论中，Mealy 机是一种有限状态机，其输出值由其当前状态和当前输入决定。

假设 input`in`已经像`x`代码中那样拼写错误，那么模块是否符合定义？

你有一些状态`q`。和一些输出`y`。您的输入`in or x`直接影响输出。所以这符合 Mealy Machine 的定义。

注意：逻辑很难理解，状态的功能和流程很难看到，有很多更好的方法来编写 FSM，其中大部分都是在单个模块中完成的。

# asp.net - ScriptManager.RegisterExpandoAttribute 不适用于 ajax

> ID：14693700
> 
> 赞同：1
> 
> 时间：2013-02-04T19:06:57.693
> 
> 标签：asp.net, ajax, servercontrols, partial-postback

我正在创建一个服务器控件，该控件具有我要添加为 expando 属性的属性。它适用于初始页面加载，但在部分回发后，它停止工作。我的 expando 属性消失了。

该类是从 Telerik RadButton 派生的类。

这就是我在重写的 PreRender 方法中所做的事情：

```
Dim radContextMenu As RadContextMenu = Parent.FindControl(ContextMenuID)
If radContextMenu IsNot Nothing Then
  'register the name of our context menu so we can access it from javascript
  ScriptManager.RegisterExpandoAttribute(Me, Me.ClientID, "ContextMenuClientID", radContextMenu.ClientID, False)
End If 
```

如您所见，我正在使用 ScriptManager，它应该在部分回发 senarios 中工作（它也适用于我的其他项目），但 RegisterExpandoAttribute 似乎在这里不起作用。此外，我还单步执行了代码，并确定 FindControl 确实找到了 radContextMenu。

任何关于我做错了什么的见解都会受到极大的赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T09:34:08.867

通过添加检查页面`ScriptManager.IsInAsyncPostBack`属性解决了类似问题。当它设置为`false`你应该使用`<control>.Page.ClientScript.RegisterExpandoAttribute`方法。

我最终得到了`Control`包含此逻辑的新扩展方法：

```
public static void RegisterExpandoAttribute(this Control control, HtmlTextWriter writer, string attributeName, string attributeValue, bool encode = false)
{
    var scriptManager = ScriptManager.GetCurrent(control.Page);
    if (scriptManager != null && scriptManager.IsInAsyncPostBack)
        ScriptManager.RegisterExpandoAttribute(control, control.ClientID, attributeName, attributeValue, encode);
    else
        control.Page.ClientScript.RegisterExpandoAttribute(control.ClientID, attributeName, attributeValue, encode);
} 
```

# python - 如何从 python 中的字符串中删除 ANSI 转义序列

> ID：14693701
> 
> 赞同：101
> 
> 时间：2013-02-04T19:07:04.900
> 
> 标签：python, string, escaping, ansi-escape

这是我的字符串：

```
'ls\r\n\x1b[00m\x1b[01;31mexamplefile.zip\x1b[00m\r\n\x1b[01;31m' 
```

我正在使用代码从 SSH 命令检索输出，并且我希望我的字符串仅包含“examplefile.zip”

我可以用什么来删除额外的转义序列？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2013-02-04T19:12:52.230

用正则表达式删除它们：

```
import re

# 7-bit C1 ANSI sequences
ansi_escape = re.compile(r'''
    \x1B  # ESC
    (?:   # 7-bit C1 Fe (except CSI)
        [@-Z\\-_]
    |     # or [ for CSI, followed by a control sequence
        \[
        [0-?]*  # Parameter bytes
        [ -/]*  # Intermediate bytes
        [@-~]   # Final byte
    )
''', re.VERBOSE)
result = ansi_escape.sub('', sometext) 
```

或者，没有`VERBOSE`标志，以浓缩形式：

```
ansi_escape = re.compile(r'\x1B(?:[@-Z\\-_]|\[[0-?]*[ -/]*[@-~])')
result = ansi_escape.sub('', sometext) 
```

演示：

```
>>> import re
>>> ansi_escape = re.compile(r'\x1B(?:[@-Z\\-_]|\[[0-?]*[ -/]*[@-~])')
>>> sometext = 'ls\r\n\x1b[00m\x1b[01;31mexamplefile.zip\x1b[00m\r\n\x1b[01;31m'
>>> ansi_escape.sub('', sometext)
'ls\r\nexamplefile.zip\r\n' 
```

上面的正则表达式涵盖了所有 7 位 ANSI C1 转义序列，但*不*包括 8 位 C1 转义序列开始符。后者在今天的 UTF-8 世界中从未使用过，相同的字节范围具有不同的含义。

如果您确实也需要覆盖 8 位代码（然后大概是使用`bytes`值），那么正则表达式将变成如下所示的字节模式：

```
# 7-bit and 8-bit C1 ANSI sequences
ansi_escape_8bit = re.compile(br'''
    (?: # either 7-bit C1, two bytes, ESC Fe (omitting CSI)
        \x1B
        [@-Z\\-_]
    |   # or a single 8-bit byte Fe (omitting CSI)
        [\x80-\x9A\x9C-\x9F]
    |   # or CSI + control codes
        (?: # 7-bit CSI, ESC [ 
            \x1B\[
        |   # 8-bit CSI, 9B
            \x9B
        )
        [0-?]*  # Parameter bytes
        [ -/]*  # Intermediate bytes
        [@-~]   # Final byte
    )
''', re.VERBOSE)
result = ansi_escape_8bit.sub(b'', somebytesvalue) 
```

可以浓缩为

```
# 7-bit and 8-bit C1 ANSI sequences
ansi_escape_8bit = re.compile(
    br'(?:\x1B[@-Z\\-_]|[\x80-\x9A\x9C-\x9F]|(?:\x1B\[|\x9B)[0-?]*[ -/]*[@-~])'
)
result = ansi_escape_8bit.sub(b'', somebytesvalue) 
```

有关更多信息，请参阅：

*   维基百科上的[ANSI 转义码概述](https://en.wikipedia.org/wiki/ANSI_escape_code)
*   [ECMA-48 标准，第 5 版](http://www.ecma-international.org/publications/standards/Ecma-048.htm)（特别是第 5.3 和 5.3 节）

您给出的示例包含 4 个 CSI（控制序列引入器）代码，由`\x1B[`或*ESC`[`*开始字节标记，每个都包含一个 SGR（选择图形再现）代码，因为它们每个都以`m`. 这些参数之间的参数（用`;`分号分隔）告诉您的终端要使用哪些图形再现属性。因此，对于每个`\x1B[....m`序列，使用的 3 个代码是：

*   0（或`00`在本例中）：*重置*，禁用所有属性
*   1（或`01`在示例中）：*粗体*
*   31：*红色*（前景）

然而，ANSI 不仅仅是 CSI SGR 代码。单独使用 CSI，您还可以控制光标、清除线条或整个显示或滚动（当然前提是终端支持）。除了 CSI，还有一些代码可以选择替代字体（`SS2`和`SS3`），发送“私人消息”（想想密码），与终端（`DCS`）、操作系统（`OSC`）或应用程序本身`APC`（将自定义控制代码捎带到通信流上），以及帮助定义字符串（`SOS`、字符串开始、`ST`字符串终止符）或将所有内容重置回基本状态（`RIS`）的更多代码。上面的正则表达式涵盖了所有这些。

请注意，上面的正则表达式仅删除了 ANSI C1 代码，但并未删除这些代码可能标记的任何其他数据（例如在 OSC 开启程序和终止 ST 代码之间发送的字符串）。删除这些将需要超出此答案范围的额外工作。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2015-11-25T20:02:03.867

这个问题的公认答案只考虑颜色和字体效果。有很多序列不以“m”结尾，例如光标定位、擦除和滚动区域。

控制序列（又名 ANSI 转义序列）的完整正则表达式是

```
/(\x9B|\x1B\[)[0-?]*[ -\/]*[@-~]/ 
```

请参阅[ECMA-48 第 5.4 节](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-048.pdf)和[ANSI 转义码](https://en.wikipedia.org/wiki/ANSI_escape_code#CSI_codes)

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2016-07-29T15:51:07.500

### 功能

基于[Martijn Pieters♦ 对](https://stackoverflow.com/q/14693701/802365#14693789)Jeff[的 regexp](https://stackoverflow.com/q/14693701/802365#33925425)的回答。

```
def escape_ansi(line):
    ansi_escape = re.compile(r'(?:\x1B[@-_]|[\x80-\x9F])[0-?]*[ -/]*[@-~]')
    return ansi_escape.sub('', line) 
```

### 测试

```
def test_remove_ansi_escape_sequence(self):
    line = '\t\u001b[0;35mBlabla\u001b[0m                                  \u001b[0;36m172.18.0.2\u001b[0m'

    escaped_line = escape_ansi(line)

    self.assertEqual(escaped_line, '\tBlabla                                  172.18.0.2') 
```

* * *

### 测试

如果您想自己运行它，请使用`python3`（更好的 unicode 支持，blablabla）。以下是测试文件的格式：

```
import unittest
import re

def escape_ansi(line):
    …

class TestStringMethods(unittest.TestCase):
    def test_remove_ansi_escape_sequence(self):
    …

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-08-01T21:47:25.530

建议的正则表达式对我没有用，所以我自己创建了一个。以下是我根据[此处找到的规范创建的 python 正则表达式](http://ascii-table.com/ansi-escape-sequences-vt-100.php)

```
ansi_regex = r'\x1b(' \
             r'(\[\??\d+[hl])|' \
             r'([=<>a-kzNM78])|' \
             r'([\(\)][a-b0-2])|' \
             r'(\[\d{0,2}[ma-dgkjqi])|' \
             r'(\[\d+;\d+[hfy]?)|' \
             r'(\[;?[hf])|' \
             r'(#[3-68])|' \
             r'([01356]n)|' \
             r'(O[mlnp-z]?)|' \
             r'(/Z)|' \
             r'(\d+)|' \
             r'(\[\?\d;\d0c)|' \
             r'(\d;\dR))'
ansi_escape = re.compile(ansi_regex, flags=re.IGNORECASE) 
```

我在以下代码段上测试了我的正则表达式（基本上是 ascii-table.com 页面的复制粘贴）

```
\x1b[20h    Set
\x1b[?1h    Set
\x1b[?3h    Set
\x1b[?4h    Set
\x1b[?5h    Set
\x1b[?6h    Set
\x1b[?7h    Set
\x1b[?8h    Set
\x1b[?9h    Set
\x1b[20l    Set
\x1b[?1l    Set
\x1b[?2l    Set
\x1b[?3l    Set
\x1b[?4l    Set
\x1b[?5l    Set
\x1b[?6l    Set
\x1b[?7l    Reset
\x1b[?8l    Reset
\x1b[?9l    Reset
\x1b=   Set
\x1b>   Set
\x1b(A  Set
\x1b)A  Set
\x1b(B  Set
\x1b)B  Set
\x1b(0  Set
\x1b)0  Set
\x1b(1  Set
\x1b)1  Set
\x1b(2  Set
\x1b)2  Set
\x1bN   Set
\x1bO   Set
\x1b[m  Turn
\x1b[0m Turn
\x1b[1m Turn
\x1b[2m Turn
\x1b[4m Turn
\x1b[5m Turn
\x1b[7m Turn
\x1b[8m Turn
\x1b[1;2    Set
\x1b[1A Move
\x1b[2B Move
\x1b[3C Move
\x1b[4D Move
\x1b[H  Move
\x1b[;H Move
\x1b[4;3H   Move
\x1b[f  Move
\x1b[;f Move
\x1b[1;2    Move
\x1bD   Move/scroll
\x1bM   Move/scroll
\x1bE   Move
\x1b7   Save
\x1b8   Restore
\x1bH   Set
\x1b[g  Clear
\x1b[0g Clear
\x1b[3g Clear
\x1b#3  Double-height
\x1b#4  Double-height
\x1b#5  Single
\x1b#6  Double
\x1b[K  Clear
\x1b[0K Clear
\x1b[1K Clear
\x1b[2K Clear
\x1b[J  Clear
\x1b[0J Clear
\x1b[1J Clear
\x1b[2J Clear
\x1b5n  Device
\x1b0n  Response:
\x1b3n  Response:
\x1b6n  Get
\x1b[c  Identify
\x1b[0c Identify
\x1b[?1;20c Response:
\x1bc   Reset
\x1b#8  Screen
\x1b[2;1y   Confidence
\x1b[2;2y   Confidence
\x1b[2;9y   Repeat
\x1b[2;10y  Repeat
\x1b[0q Turn
\x1b[1q Turn
\x1b[2q Turn
\x1b[3q Turn
\x1b[4q Turn
\x1b<   Enter/exit
\x1b=   Enter
\x1b>   Exit
\x1bF   Use
\x1bG   Use
\x1bA   Move
\x1bB   Move
\x1bC   Move
\x1bD   Move
\x1bH   Move
\x1b12  Move
\x1bI  
\x1bK  
\x1bJ  
\x1bZ  
\x1b/Z 
\x1bOP 
\x1bOQ 
\x1bOR 
\x1bOS 
\x1bA  
\x1bB  
\x1bC  
\x1bD  
\x1bOp 
\x1bOq 
\x1bOr 
\x1bOs 
\x1bOt 
\x1bOu 
\x1bOv 
\x1bOw 
\x1bOx 
\x1bOy 
\x1bOm 
\x1bOl 
\x1bOn 
\x1bOM 
\x1b[i 
\x1b[1i
\x1b[4i
\x1b[5i 
```

希望这对其他人有帮助:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-18T00:22:18.700

如果它对未来的 Stack Overflowers 有帮助，我会使用[蜡笔库](https://github.com/kennethreitz/crayons)为我的 Python 输出提供更多视觉冲击力，这在 Windows 和 Linux 平台上都可以使用，这是有利的。但是，我既要在屏幕上显示又要附加到日志文件，并且转义序列会影响日志文件的易读性，因此想将它们删除。但是蜡笔插入的转义序列产生了错误：

```
expected string or bytes-like object 
```

解决方案是将参数转换为字符串，因此只需对普遍接受的答案进行微小修改：

```
def escape_ansi(line):
    ansi_escape = re.compile(r'(\x9B|\x1B\[)[0-?]*[ -/]*[@-~]')
    return ansi_escape.sub('', str(line)) 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-09-18T13:14:09.707

如果要删除该`\r\n`位，可以通过此函数（[由 sarnold 编写](https://stackoverflow.com/a/8115378)）传递字符串：

```
def stripEscape(string):
    """ Removes all escape sequences from the input string """
    delete = ""
    i=1
    while (i<0x20):
        delete += chr(i)
        i += 1
    t = string.translate(None, delete)
    return t 
```

不过要小心，这会将转义序列前后的文本混在一起。所以，使用 Martijn 的过滤字符串`'ls\r\nexamplefile.zip\r\n'`，你会得到`lsexamplefile.zip`. 注意`ls`所需文件名前面的 。

我会首先使用 stripEscape 函数删除转义序列，然后将输出传递给 Martijn 的正则表达式，这样可以避免连接不需要的位。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2020-12-14T19:45:52.227

对于 2020 年的 python 3.5，它就像`string.encode().decode('ascii')`

```
ascii_string = 'ls\r\n\x1b[00m\x1b[01;31mexamplefile.zip\x1b[00m\r\n\x1b[01;31m'
decoded_string = ascii_string.encode().decode('ascii')
print(decoded_string) 

>ls
>examplefile.zip
> 
```

# xml - 写xml，菜鸟需要帮助

> ID：14693708
> 
> 赞同：-1
> 
> 时间：2013-02-04T19:07:15.863
> 
> 标签：xml

```
<?xml version='1.0' encoding='us-ascii'?> 

<download
title="T7Plus Download"
terminal="Hypercom"
model="T7Plus"
>
<instructions>
OLD HYPERCOM DOWNLOAD INSTRUCTIONS
1\.  UNPLUG POWER FROM THE BACK OF THE TERMINAL
2\.  HOLD DOWN THE TOP, MIDDLE, AND BOTTOM ORANGE KEYS AND PLUG TERMINAL BACK IN
3\.  HOLD TOP, MIDDLE, AND BOTTOM ORANGE KEYS UNTIL TERMINAL SAYS “PLEASE INITIALIZE OR CALL HELP”
4\.  PRESS FUNCTION 98 ENTER
    a.  CORRECT? YES OR NO – PRESS ENTER
5\.  PRESS FUNCTION 99 ENTER
6\.  PROGRAM FUNCTION – PRESS 9 ENTER
7\.  TYPE? – PRESS 6 ENTER
8\.  TYPE? – PRESS 2 ENTER (READING EPROM)
9\.  TYPE? – PRESS 1 ENTER
10\. PRESS CANCEL
11\. PRESS FUNCTION 2 ENTER
12\. TERMINAL ID:    (nine digit number)
13\. INIT PHONE NUMBER:      1-877-576-8399
14\. NMS PHONE NUMBER:   1-877-576-8399
15\. DIAL 0- TONE 1- PULSE
    a.  PRESS 0 ENTER
16\. PABX ACCESS CODE (IF MERCHANT NEEDS A 9 OR ANY OTHER PREFIX)
17\. EXIT PRESS CANCEL
    a.  PRESS CANCEL
18\. PRESS FUNCTION 92 ENTER
    a.  PROGRAM RUN – CORRECT? YES OR NO – PRESS ENTER
19\. WHEN THE PROGRAM LOAD IS COMPLETE, THE TERMINAL WILL DISPLAY “PLEASE INITIALIZE”
20\. PRESS INITIALIZE THEN ENTER
    ***ONCE INITIALIZED, THE PROGRAM LOAD IS COMPLETE***
    </instructions> 
</download> 
```

上面的示例是我第一次尝试编写自己的 XML。我正在尝试为我的工作创建指南，这是第一页。

从我所能收集到的信息来看，你必须创建自己的标签，我相信我做得对。我总是边做边学，从阅读说明中获益良多。

如果有人有几分钟的时间来指出我做对/错的事情，我将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:15:19.520

您已经生成了一些有效的 XML，但我认为中间的大量文本不是 XML 风格的。我建议使用 XML 来组织这些步骤。例如，您可以为标题使用属性：

```
<instructions title="OLD HYPERCOM DOWNLOAD INSTRUCTIONS"> 
```

然后可以为各个步骤赋予它们自己的节点：

```
<item text="UNPLUG POWER FROM THE BACK OF THE TERMINAL" />
<item text="HOLD DOWN THE TOP, MIDDLE, AND BOTTOM ORANGE KEYS AND PLUG TERMINAL BACK IN" /> 
```

如果步骤有子步骤，您可以在这些下面嵌套节点：

```
<item text="PRESS FUNCTION 98 ENTER">
  <subitem text="CORRECT? YES OR NO – PRESS ENTER" />
</item>
<item text="PRESS FUNCTION 99 ENTER" /> 
```

我认为这会让您走上制作更有条理的 XML 的道路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:13:56.417

您应该在 xml 声明中使用双引号而不是单引号：

```
<?xml version="1.0" encoding="us-ascii"?> 
```

# linux - linux中gacutil的权限被拒绝

> ID：14693710
> 
> 赞同：0
> 
> 时间：2013-02-04T19:07:18.700
> 
> 标签：linux, apache, mono, centos, gacutil

我有`Mono gacutil`一台 Linux 机器，CentOS 5.5，apache 2.2。我以 root 用户身份运行。我不断得到

> /usr/local/bin/gacutil：第 2 行：/usr/local/bin/mono：权限被拒绝

这适用于来自`gacutil`、like`-l`或的任何命令`-i`。将 sudo 放在前面会给出相同的信息。

有任何想法吗？

编辑： ls -l /usr/local/bin/mono 给了我这个：

> -rw-r--r-- 1 根根 8629697

编辑2：

> 该文件上没有设置可执行位。它给了你一个被拒绝的权限，因为它是不可执行的。

我想问题变成了这样：我认为 gacutil 正在为 GAC 寻找错误的地方。如何更改它查看的文件夹？

# node.js - 如何在 Mongoose 的 upsert 操作中设置更新时间戳？

> ID：14693715
> 
> 赞同：5
> 
> 时间：2013-02-04T19:07:38.557
> 
> 标签：node.js, mongodb, mongoose, upsert

我想设置更新时间戳仅用于在*upsert*操作中更新记录（并为新记录插入时间戳）。

```
self.model.update({Id: obj.Id}, obj, {upsert: true}, function(err){
    if (err) {
        return;
    }

    //...

}); 
```

有没有办法处理这个？

有一个我可以使用的*pre.save*中间件，但是有没有办法判断当前操作是插入还是更新？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-07T14:55:40.370

你不能自动完成。您可以`$set: { timestamp: Date.now() }`在 upsert 上使用它。

mongoose bugtracker 中有一个已解决的问题在这里讨论这个问题：[upsert 忽略默认值](https://github.com/LearnBoost/mongoose/issues/624)

有点晚了，但希望对某人有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-15T17:52:54.027

为此有一个猫鼬插件。（猫鼬时间戳插件）

这是 CoffeeScript 实现 - 如果需要，可以使用 js2coffe.com 转换为 js。

你可以在你的所有模型中使用它。

创建如下函数

```
# * Mongoose Timestamps Plugin
# * Copyright(c) 2012 Nicholas Penree <nick@penree.com>
# * Original work Copyright(c) 2012 Brian Noguchi
# * Modified from Fino 2014
# * MIT Licensed
#
timestamps = (schema, options) ->
  updated_at = "updated_at"
  created_at = "created_at"
  updatedAtType = Date
  createdAtType = Date
  if typeof options is "object"
    if typeof options.updated_at is "string"
      updated_at = options.updated_at
    else if typeof options.updated_at is "object"
      updated_at = options.updated_at.name or updated_at
      updatedAtType = options.updated_at.type or updatedAtType
    if typeof options.created_at is "string"
      created_at = options.created_at
    else if typeof options.created_at is "object"
      created_at = options.created_at.name or created_at
      createdAtType = options.created_at.type or createdAtType
  dataObj = {}
  dataObj[updated_at] = updatedAtType
  if schema.path("created_at")
    schema.add dataObj
    schema.virtual(created_at).get ->
      this["_" + created_at]  if this["_" + created_at]
      return this["_" + created_at] = @_id.getTimestamp()

    schema.pre "save", (next) ->
      if @isNew
        this[updated_at] = this[created_at]
      else
        this[updated_at] = new Date
      next()
      return

  else
    dataObj[created_at] = createdAtType
    schema.add dataObj
    schema.pre "save", (next) ->
      unless this[created_at]
        this[created_at] = this[updated_at] = new Date
      else
        this[updated_at] = new Date
      next()
      return

  return 
```

然后在您的 Mongoose 模型中执行以下操作

userSchema.plugin 时间戳

而已！

当您继续使用“model.save()”时，这将添加 created_at 并保持 update_at 更新

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T20:13:10.537

您可以使用预保存挂钩，您可以使用许多标志，例如 .isNew 或 .isModified。

```
self.schema.pre('save', function (next) {

  if (this.isNew) {
    this.updated = Date.now();
  }
  return next();
} 
```

对于创建日期，可以从 ObjectId 中提取时间戳

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-04T07:34:47.343

用于插入

```
db.test.insert({ts:new Date()}) 
```

用于插入

```
db.test.update({"_id" : ObjectId("540815fa802a63ddca867bc0")},{$set:{ts:new Date()}},{upsert:1}) 
```

# python - 如何使用 argparse 解析带有前导减号（负数）的位置参数

> ID：14693718
> 
> 赞同：19
> 
> 时间：2013-02-04T19:07:51.690
> 
> 标签：python, command-line-arguments, argparse

我想解析一个必需的位置参数，其中包含一个以逗号分隔的整数列表。如果第一个整数包含前导减号 ('-')，则 argparse 会抱怨：

```
import argparse
parser = argparse.ArgumentParser()
parser.add_argument('positional')
parser.add_argument('-t', '--test', action='store_true')
opts = parser.parse_args()
print opts

$ python example.py --test 1,2,3,4
Namespace(positional='1,2,3,4', test=True)

$ python example.py --test -1,2,3,4
usage: example.py [-h] [-t] positional
example.py: error: too few arguments

$ python example.py --test "-1,2,3,4"
usage: example.py [-h] [-t] positional
example.py: error: too few arguments 
```

我见过人们建议使用除`-`标志字符之外的其他字符，但我宁愿不这样做。是否有另一种方法来配置 argparse 以允许同时`--test`作为`-1,2,3,4`有效参数？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-04T19:09:49.523

您需要在`--`命令行参数中插入 a：

```
$ python example.py --test -- -1,2,3,4
Namespace(positional='-1,2,3,4', test=True) 
```

双破折号停止 argparse 寻找更多可选开关；这是为命令行工具准确处理此用例的事实上的标准方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-04T19:11:19.787

从[文档](http://docs.python.org/dev/library/argparse.html#arguments-containing)中：

> parse_args() 方法试图在用户明显犯错时给出错误，但有些情况本质上是模棱两可的。例如，命令行参数 -1 可能是尝试指定选项或尝试提供位置参数。parse_args() 方法在这里很谨慎：位置参数只能以 - 开头，如果它们看起来像负数并且解析器中没有看起来像负数的选项：

由于`-1,2,3,4`看起来*不像*负数，因此您必须使用`--`大多数 *nix 系统中的“转义”它。

另一种解决方案是使用`nargs`位置并将数字作为空格分隔传递：

```
#test.py
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('positional', nargs='*') #'+' for one or more numbers

print parser.parse_args() 
```

输出：

```
$ python test.py -1 2 3 -4 5 6
Namespace(positional=['-1', '2', '3', '-4', '5', '6']) 
```

获得所需内容的第三种方法是使用`parse_known_args`而不是`parse_args`. 您不要将位置参数添加到解析器并手动解析它：

```
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('--test', action='store_true')

parsed, args = parser.parse_known_args()
print parsed
print args 
```

结果：

```
$ python test.py  --test -1,2,3,4                                            
Namespace(test=True)
['-1,2,3,4'] 
```

这样做的缺点是帮助文本信息量较少。

# c++ - 这是指针的问题吗？

> ID：14693721
> 
> 赞同：3
> 
> 时间：2013-02-04T19:08:05.563
> 
> 标签：c++, pointers

试图自学 C++（我通常使用 Python）并编写了这段代码。

```
#include <iostream>
using namespace std;

class TreeNode {
    public:
        TreeNode *left;
        TreeNode *right;
        int value;

        TreeNode(int _value);
        void add_node(TreeNode node);
};

TreeNode::TreeNode(int _value) {
    left = 0;
    right = 0;
    value = _value;
    cout << "Creating node with value: " << value << endl;
}

void TreeNode::add_node(TreeNode node) {
    cout << "Adding " << node.value << " to " << value << endl;
    if (node.value < value) {
        cout << node.value << " < " << value << endl;
        if (left) {
            cout << "Left node of " << value << " exists " << left->value << endl;
            left->add_node(node);
        } else {
            cout << "Left node of " << value << " does not exist" << endl;
            left = &node;
        }
    }
    if (node.value > value) {
        cout << node.value << " > " << value << endl;
        if (right) {
            cout << "Right node of " << value << " exists " << right->value << endl;
            right->add_node(node);
        } else {
            cout << "Right node of " << value << " does not exist" << endl;
            right = &node;
        }
    }
}

int main ()
{
    TreeNode root(25);
    TreeNode n1(15);
    TreeNode n2(30);
    TreeNode n3(20);

    root.add_node(n1);
    root.add_node(n2);
    root.add_node(n3);

    cout << root.left->value << endl;
    cout << root.right->value << endl;

    return 0;
} 
```

该程序编译但运行结果我不明白。

```
Creating node with value: 25
Creating node with value: 15
Creating node with value: 30
Creating node with value: 20
Adding 15 to 25
15 < 25
Left node of 25 does not exist
Adding 30 to 25
30 > 25
Right node of 25 does not exist
Adding 20 to 25
20 < 25
Left node of 25 exists 20
Adding 20 to 20
20
20 
```

我期待最后一点会有所不同。

```
Adding 20 to 25
20 < 25
Left node of 25 exists 15
Adding 20 to 15
20 > 15
Right node of 15 does not exist
15
30 
```

有人可以解释这里发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:16:05.800

您正在复制 TreeNode 副本的地址，而不是 main 中 TreeNode 的地址。
请注意注释掉的函数调用，并阅读以下内容： [如何将对象传递给 C++ 中的函数？](https://stackoverflow.com/questions/2139224/how-to-pass-objects-to-functions-in-c)

```
//Output with TreeNode node as arg
//Creating node with value: 25
//Creating node with value: 15
//Creating node with value: 30
//Creating node with value: 20
//Adding 15 to 25
//15 < 25
//Left node of 25 does not exist
//Adding 30 to 25
//30 > 25
//Right node of 25 does not exist
//Adding 20 to 25
//20 < 25
//Left node of 25 exists 20
//Adding 20 to 20
//20
//20

//Output with TreeNode & node as arg
//Creating node with value: 25
//Creating node with value: 15
//Creating node with value: 30
//Creating node with value: 20
//Adding 15 to 25
//15 < 25
//Left node of 25 does not exist
//Adding 30 to 25
//30 > 25
//Right node of 25 does not exist
//Adding 20 to 25
//20 < 25
//Left node of 25 exists 15
//Adding 20 to 15
//20 > 15
//Right node of 15 does not exist
//15
//30

#include <iostream>
using namespace std;

class TreeNode {
    public:
        TreeNode *left;
        TreeNode *right;
        int value;

        TreeNode(int _value);
        //void add_node(TreeNode  node);
        void add_node(TreeNode & node);
};

TreeNode::TreeNode(int _value) {
    left = 0;
    right = 0;
    value = _value;
    cout << "Creating node with value: " << value << endl;
}

//void TreeNode::add_node(TreeNode node) {
void TreeNode::add_node(TreeNode & node) {
    cout << "Adding " << node.value << " to " << value << endl;
    if (node.value < value) {
        cout << node.value << " < " << value << endl;
        if (left) {
            cout << "Left node of " << value << " exists " << left->value << endl;
            left->add_node(node);
        } else {
            cout << "Left node of " << value << " does not exist" << endl;
            left = &node;
        }
    }
    if (node.value > value) {
        cout << node.value << " > " << value << endl;
        if (right) {
            cout << "Right node of " << value << " exists " << right->value << endl;
            right->add_node(node);
        } else {
            cout << "Right node of " << value << " does not exist" << endl;
            right = &node;
        }
    }
}

int main ()
{
    TreeNode root(25);
    TreeNode n1(15);
    TreeNode n2(30);
    TreeNode n3(20);

    root.add_node(n1);
    root.add_node(n2);
    root.add_node(n3);

    cout << root.left->value << endl;
    cout << root.right->value << endl;

    return 0;
} 
```

# c++ - 如何在 Mac 插件中使用 ioctl() 设置 RTS？

> ID：14693724
> 
> 赞同：16
> 
> 时间：2013-02-04T19:08:16.333
> 
> 标签：c++, macos, plugins, serial-port, ioctl

我可以在一个小型终端应用程序中使用 ioctl 设置 RTS，但不能在我的 Mac 插件代码中设置，尽管两者都运行相同的代码。在插件中，我只能“获取”串行端口标志/引脚，但不能“设置”它们。在终端应用程序中，我既可以“获取”也可以“设置”它们。我得到了 ENODEV 的 errno。错误号是 19，消息是“设备不支持操作”。

如果这是一个安全问题（在浏览器的上下文中），是否有办法获得使用 ioctl 修改标志的权限？我有一个连接到 USB 端口的串行设备。我正在使用 FTDI vcp（虚拟 com 端口）驱动程序。Windows 端的一切都很顺利。顺便说一句，我使用 Safari 和 Firefox 得到了相同的结果。下面是我的代码：

```
int disableRTS ()
{
    char fd, ret, flags;

    // open device
    if ((fd = open("/dev/cu.mydevice", O_RDWR | O_NDELAY)) < 0)
    {
        fprintf(stderr, "failed to open device");
        return -1;
    }

    // Get the current state of the bits
    ioctl(fd, TIOCMGET, &flags);
    fprintf(stderr, "Flags are %x.\n", flags);    

    flags &= ~TIOCM_RTS;  // Disable the RTS bit
    ret = ioctl(fd, TIOCMSET, &flags);

    if (ret == -1)
        fprintf(stderr, "TIOCMSET failed\n");
    else
        fprintf(stderr, "TIOCMSET succeeded. flags: %x.\n", flags);

    return 0;
} 
```

=========

# 更新

如果我刷新浏览器页面，强制再次执行代码，ioctl()返回0，表示成功。不幸的是，我需要它第一次工作。即使我使用 usleep() 方法编写一个循环并暂时暂停，并进行后续尝试，它也会失败。但是，当我刷新它成功时。我还在 Mozilla 提供的第二个专门的 NPAPI 项目“BasicPlugin.xcodeproj”中复制了这个问题。我的第一个插件项目是 Firebreath 项目。他们都首先失败，然后在页面重新加载时成功。我还有 2 个独立的 Mac 应用程序可以正常工作。一个是 SerialTools，它使用与我的终端应用程序和插件完全相同的方法来设置 RTS 开启（和 DTR 关闭）。

========

# 更新 2

我已经能够在这方面获得代码级别的 Apple 支持，因此*可能*会出现解决方案。这位工程师表示，代码在插件中的运行方式与在插件之外的运行方式不同是“奇怪的”，并且正在与 Safari 插件工程师交谈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T13:44:25.903

您可以制作一个 AppleScript 插件，该插件将在特定时间或登录期间自动运行，或在后台连续运行。

AppleScript 可以运行终端代码。因此，您可以轻松地让它自动运行您当前在终端中运行的获取/设置代码。

AppleScript 插件的代码将是这样的::

```
tell application "Finder"
    display dialog explanation buttons {"GET", "SET"} default button "GET"
    if result = {button returned:"GET"} then
        tell application "Terminal"
                 set status to (do shell script "terminal code for getting the RTS here")
            end tell
    else if result = {button returned:"SET"} then
            tell application "Terminal"
                 set status to (do shell script "terminal code for setting the RTS here")
            end tell
    end if
end tell 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-29T20:30:31.070

答案是，每当在调用 ioctl() 时使用 TIOCMSET 或 TIOCMGET 时，第三个参数必须是 int。我正在使用一个字符。呃。不敢相信我错过了这个。TIOCMSET 和 TIOCMGET 定义如下：

```
 #define   TIOCMSET    _IOW('t', 109, int) /* set all modem bits */
  …
  #define   TIOCMGET    _IOR('t', 106, int) /* get all modem bits */ 
```

因此不难想象，使用 char 作为我的“标志”变量的类型可能会导致不可预知的行为。

# magento - 在 Magento 1.7 中购买至少 75 美元的免费产品如何设置优惠券？

> ID：14693726
> 
> 赞同：0
> 
> 时间：2013-02-04T19:08:17.490
> 
> 标签：magento, coupon

我们正在努力做到这一点，以便客户在完成以下操作后可以获得产品 100% 的折扣（SKU 是 1PR）：

*   将其放入他们的购物车
*   在他们的购物车中输入了至少价值 75 美元的产品

*   输入促销代码“peonia”</li>

我们已经复制了在 12 月对我们有用的促销代码设置（请参阅我们在尝试下方的购物车条件下的“操作”选项卡中输入的内容）。目前，这不起作用，客户在单击“应用优惠券”后会看到错误消息（“优惠券代码“peonia”无效”）。

有任何想法吗？

如果您对设置有一个想法，以便客户获得免费产品而无需将其包含在他们的购物车中，那么作为我们问题的替代解决方案将受到欢迎。

以下是我们在“行动”中没有工作的内容（但它在 12 月有效）：

*   折扣金额为 100*   如果所有这些条件都为真*   购物车中的价格等于或大于 75*   SKU 是 1PR

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T08:08:45.510

在行动中，您需要做：

类型 : % 数量 : 100 最多 1 个产品 条件 SKU 是 1PR

在“条件”选项卡中，您有：

如果所有这些条件都为真 产品总金额的子选择 >= 75 对于具有所有这些条件的子选择 SKU 不是 1PR

如果您的 1PR 以外的所有费用均超过 75 美元，则您在 1PR 上享有 100% 折扣

# ios - 从文件中重新加载 NSStrings 的 NSArray

> ID：14693734
> 
> 赞同：0
> 
> 时间：2013-02-04T19:08:45.440
> 
> 标签：ios, nsstring, nsarray, loading, writetofile

我有一个 NSString 的 NSArray，我将其保存到文件中，然后在重新启动应用程序时从文件中重新加载。奇怪的是，重新加载后，字符串周围有括号。

我通过以下方式保存：writeToFile：原子：

我通过以下方式加载数组：arrayWithContentsOfFile：

问题是当 NSString 进入时，它可能看起来像这样：

**I_am_the_good_old_string**

但是从文件重新加载数组后，它看起来像这样：

***(***

**I_am_the_good_old_string**

***)***

我不明白为什么他们现在有括号。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:13:32.847

我猜您要打印的第二个对象是包含一个字符串的 NSArray，而不是 NSString 对象本身。尝试调用此方法以查看对象类的名称。

```
NSLog(@"%@",[possibleStringObject class]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:18:32.640

括号是一个数组对象，如果你打印出一个数组，它会调用 [myarray description] 看起来像你描述的那样。

```
(obj1,
obj2,
obj3) 
```

您可能正在打印字符串，然后打印数组。重新加载数组后尝试打印字符串..

```
NSLog(@"myString:%@", [myArray objectAtIndex:0]); 
```

# php - Silverstripe DropdownField 未使用 loadDataFrom() 加载

> ID：14693735
> 
> 赞同：2
> 
> 时间：2013-02-04T19:08:45.477
> 
> 标签：php, silverstripe

我有一个用于更新数据库行的自定义表单。我使用 预填充字段值`$form->loadDataFrom( $data )`，其中 $data 是字段值的关联数组。

这对除了 DropdownField 之外的所有应用都非常有用；没有设置为“选定”。

相关代码：

在表单子类上：

```
$fields = FieldList::create( 
... 
DropdownField::create('subscribed')->setSource(array('1' => 'Yes', '0' => 'No'))->setAttribute('class', 'default') 
); 
```

在控制器中：

```
$form->loadDataFrom($data); 
```

我已经验证 $data 是一个格式正确的关联数组（毕竟，每个其他字段都会获得适当的值）。

下拉字段不会设置选定的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T05:13:10.903

您需要对源数组键使用 true 和 false：

```
DropdownField::create('subscribed')->setSource(array(
  true  => 'Yes',
  false => 'No'
)) 
```

# wordpress - 在 Wordpress 中恢复插件

> ID：14693737
> 
> 赞同：2
> 
> 时间：2013-02-04T19:08:51.383
> 
> 标签：wordpress, plugins, backup, database-backups

备份我的 Wordpress 安装（通过 phpMyAdmin 备份 MySQL 数据库，通过 FTP 备份整个前端网站）后，我更新了一些插件，这导致网站的一个重要方面失败。

我认为负责的插件是“高级自定义字段”，从 2.0.5 更新到 3.5.8.1。当我更新这个插件时，我收到了通知：

“高级自定义字段 v3.5.8.1 需要升级数据库（为什么？）。请备份您的数据库，然后单击升级数据库。” 这已成功完成。

由于我无法解决问题，我希望从备份中恢复我的 Wordpress 安装。我的问题是这样做需要什么？我是否需要从 FTP 备份以及各种 mySQL 数据库中恢复文件？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:37:31.090

Wordpress 有关于如何从备份中恢复的说明。[在这里](http://codex.wordpress.org/Restoring_Your_Database_From_Backup)看到他们。

以与备份主题相同的方式通过 FTP 加载主题（您称其为前端网站）。

至于插件，您可以尝试从开发者那里下载以前的版本。但是请记住，如果有任何创建表，我假设这些表应该在第一步中恢复。据我所知，插件不会像您所说的那样创建数据库，它们可能会在当前的 wordpress 安装中创建表。

您是否偶然下载了 FTP 中主题文件夹之外的任何内容？我想您可以将文件放回那里，因为在执行上述第一步时应该恢复表。

这就是我将如何处理它，还没有这样做，所以尝试你自己的风险。

另一个想法是与您的主机合作以获取文件。我的至少每周对磁带进行备份，他们收取 15 美元的恢复费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:54:20.367

如果您备份了所有文件和数据库（只有一个），那么将其恢复到原来的位置应该没有问题，然后只升级能够升级的插件。

您可以通过在开发服务器上部署站点副本并在那里解决它来找到高级自定义字段问题的解决方案。

这当然取决于您所说的“前端网站”是什么意思。主题、wp-content 目录还是所有文件？您是否备份了插件目录？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T19:19:21.280

谢谢你们的反馈。我通过 FTP 完全删除插件并使用开发人员 Wordpress 插件页面下载以前的版本来解决此问题。安装后，一切都恢复原状。我没有做任何事情来恢复数据库（尽管这显然正在更新），而且一切似乎都正常工作。

干杯

# .htaccess - 在 .htaccess 中强制使用 SSL 和 WWW

> ID：14693739
> 
> 赞同：1
> 
> 时间：2013-02-04T19:09:18.940
> 
> 标签：.htaccess, mod-rewrite, ssl, web

我一直在寻找一种强制 SSL 和 www 的方法。但我发现的许多解决方案都没有奏效。目前我正在尝试这个：

```
RewriteCond %{HTTP_HOST} ^domain\.co\.uk$ [OR]
RewriteCond %{HTTPS} !on
RewriteRule ^(.*)$ https://www.domain.co.uk/$1 [R,L] 
```

*   domain.co.uk -> https://www.domain.co.uk
*   www.domain.co.uk -> https://domain.co.uk
*   https://domain.co.uk -> https://domain.co.uk 有 SSL 错误

（这些空间是因为我太新而不能发布超过 2 个链接）。

有没有办法做到这一点？在尝试了至少 10 个不同的示例之后，我很惊讶他们最终都在最后一个失败了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:16:58.437

您的问题是您在条件中指定了 HTTP 主机但缺少 HTTPS 主机。像这样：

```
RewriteCond %{HTTP_HOST} ^domain\.co\.uk$ [OR]
RewriteCond %{HTTPS_HOST} ^domain\.co\.uk$ [OR]
RewriteCond %{HTTPS} !on
RewriteRule ^(.*)$ https://www.domain.co.uk/$1 [R,L] 
```

那应该这样做。

# ms-access - 在 Access 中，如何根据失败的搜索条件创建新记录？

> ID：14693740
> 
> 赞同：1
> 
> 时间：2013-02-04T19:09:30.273
> 
> 标签：ms-access

我的主要问题是，如果我在 Access 中搜索记录，有没有办法让它在我的搜索未找到记录时提示我根据该搜索条件创建新记录？

例如，如果我正在搜索姓氏 Burge 以确保 Burge 不在我的记录中，但我发现它不在，然后让 Access 提示我是否要基于该名称创建记录？

截至目前，我只是使用 Access 中的搜索按钮。我什么也没做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T20:15:27.333

我怀疑你需要覆盖这个“搜索”栏并实现你自己的。将您自己的未绑定文本控件放在表单的页眉（或页脚）部分。接下来，禁用导航按钮以强制用户使用您的控件。在用于搜索的文本框的更新后事件中，您将 Form.Filter 属性设置为文本框控件。像

```
 Me.Filter = "LastName = """ & Me.txtLastFilter & """ 
```

然后您将检查是否未找到该记录。默认情况下，如果不满足过滤条件，过滤器将打开一条新记录。然后，您可以将新记录的姓氏值设置为您的过滤器框值，例如

```
 if me.newrecord = true then
    me.LastName = me.txtlastFilter 
```

这只是执行此操作的众多方法之一。

# core-data - 使用 CHCSVParser（作者 Dave DeLong）通过邮件编写器将核心数据导出到 csv

> ID：14693741
> 
> 赞同：2
> 
> 时间：2013-02-04T19:09:32.340
> 
> 标签：core-data, csv

我正在使用 CHCSVParser（由 Dave DeLong 编写）通过邮件编写器将核心数据导出到 csv 中，但问题是它采用的是核心数据表名称而不是行值。

另外，我希望它们按特定顺序排列。例如“下水道编号”、“沙井 1”、“沙井 2”

这是我正在使用的编码：

//从核心数据中获取数据

```
NSManagedObjectContext *moc = [self managedObjectContext];
NSEntityDescription *entityDescription = [NSEntityDescription
                                          entityForName:@"Input_Details" inManagedObjectContext:moc];
NSFetchRequest *request = [[NSFetchRequest alloc] init];

request.predicate = [NSPredicate predicateWithFormat:@"rs_Input_project.name = %@", self.projectObject.name];

[request setEntity:entityDescription];
request.resultType = NSDictionaryResultType;

NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"sewer_No" ascending:YES];
[request setSortDescriptors:@[sortDescriptor]];

NSError *error;

NSArray *fetchedObjects = [moc executeFetchRequest:request error:&error];

 //creating a csv CHCSVWriter
NSOutputStream *output = [NSOutputStream outputStreamToMemory];
CHCSVWriter *writer = [[CHCSVWriter alloc] initWithOutputStream:output encoding:NSUTF8StringEncoding delimiter:','];

for (id object in fetchedObjects)
{
    if ([object conformsToProtocol:@protocol(NSFastEnumeration)])
    {
        [writer writeLineOfFields:object];

    }
}

[writer closeStream];

NSData *buffer = [output propertyForKey:NSStreamDataWrittenToMemoryStreamKey];

NSString *string = [[NSString alloc] initWithData:buffer encoding:NSUTF8StringEncoding];

NSLog(@"Length of Buffer:%d Error:%@",[buffer length],[error localizedDescription]);

if ( [MFMailComposeViewController canSendMail] )
{

    MFMailComposeViewController *mailComposer = [[MFMailComposeViewController alloc] init];
    mailComposer.mailComposeDelegate = self;

    NSData *myData = [string dataUsingEncoding:NSUTF8StringEncoding];
    NSLog(@"myData csv:%@",myData);
     NSLog(@"string csv:%@",string);

// Fill out the email body text
    NSString *emailBody = @"Sewer_Output";
    [mailComposer setMessageBody:emailBody isHTML:NO];

    //attaching the data and naming it Sewer_Output
    [mailComposer addAttachmentData:myData  mimeType:@"text/cvs" fileName:@"Sewer_Output.csv"];

[self presentModalViewController:mailComposer animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:28:12.957

```
//creating a csv CHCSVWriter
NSOutputStream *output = [NSOutputStream outputStreamToMemory];
CHCSVWriter *writer = [[CHCSVWriter alloc] initWithOutputStream:output encoding:NSUTF8StringEncoding delimiter:','];
//wrting header name for csv file
[writer writeField:@"Line No"];
[writer writeField:@"Sewer No"];
[writer writeField:@"Manhole Up"];
[writer writeField:@"Manhole Down"];

[writer finishLine];

for (NSManagedObject *object in fetchedObjects)
{
    //getting the data from core data

    int line_no = [[object valueForKey:@"line_no"] intValue];
    int sewer_No = [[object valueForKey:@"sewer_No"] intValue];
    NSString *mh_Up=[object valueForKey:@"mh_Up"];
    NSString *mh_down=[object valueForKey:@"mh_down"];

        //writing that data to writer for csv file

        [writer writeField:[NSString stringWithFormat:@"%i",line_no]];
        [writer writeField:[NSString stringWithFormat:@"%i",sewer_No]];
        [writer writeField:[NSString stringWithFormat:@"%@",mh_Up]];
        [writer writeField:[NSString stringWithFormat:@"%@",mh_down]];

        [writer finishLine]; //finishing the writing of first row

}

[writer closeStream];

NSData *buffer = [output propertyForKey:NSStreamDataWrittenToMemoryStreamKey];

NSString *string = [[NSString alloc] initWithData:buffer encoding:NSUTF8StringEncoding];
//NSLog(@"string = %@",string); 
```

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T12:39:06.397

```
for (ObjectClass *object in fetchedObjects)
{
    if ([object conformsToProtocol:@protocol(NSFastEnumeration)])
    {
        [writer writeField:object.text];
        [writer writeField:[NSString stringWithFormat:@"%i",object.sewer_No.intValue]];
        [writer finishLine];
    }
} 
```

# delphi - 如何在delphi中获取堆栈跟踪或至少错误行？

> ID：14693742
> 
> 赞同：1
> 
> 时间：2013-02-04T19:09:42.580
> 
> 标签：delphi, debugging, delphi-2009

我正在遭受 Delphi 2009 的折磨 :)

我必须在一个用 Delphi 编写的非常古老的、成熟的软件中找到一些错误。当我在调试器中启动应用程序时，我只收到一条错误消息：“地址 xy 的访问冲突”。但是我没有得到任何关于导致错误的代码行的提示。我真的不敢相信 Delphi 不能像 Java 那样显示这些信息。我确定我在这里做错了什么。

我在链接器页面（在 Projekt 选项中）激活了调试信息，但没有成功。

请给我一些提示如何正确设置 Delphi 以显示虚线。如果有 Java 中已知的调用堆栈跟踪，那就更好了。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T19:13:45.717

您应该将异常日志记录添加到您的应用程序中。例如 EurekaLog 或 madExcept。我个人使用后者，不能高度推荐它。

一旦您将异常记录工具添加到您的项目中，任何未处理的异常都将导致一个全面的错误报告，包括您的线程的堆栈跟踪。

# c++ - 字符串作为参数？

> ID：14693745
> 
> 赞同：7
> 
> 时间：2013-02-04T19:10:09.773
> 
> 标签：c++, string, parameters, reference

**如果我不打算修改字符串，那么第一个选项更好还是两者都相同**-（我只想遍历字符串，但由于字符串大小很大，我不希望制作本地副本。）

```
int getString(string& str1) {
    //code
}

int getString (string str1) {
    //code
} 
```

**如果我确实打算改变字符串，那么两者之间有什么区别吗？是因为字符串在 C++ 中是不可变的吗？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-04T19:11:49.370

为什么不通过 const 引用传递？这样既不会复制，也不会被调用的函数能够修改字符串。

```
int getString(string const &str1)
{
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-04T19:11:52.507

字符串文字是不可变的，`std::string`s 不是。

第一个是通过引用传递。如果您不打算修改字符串，请通过`const`引用传递它。

第二个是按值传递——如果你修改函数内部的字符串，你只会修改一个副本，所以它没有实际意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T19:12:30.787

是的，会有区别。

第二个变体（没有`&`）将按值将字符串**复制**到`getString`函数的范围内。这意味着您所做的任何更新都将影响本地副本，而不是调用者的副本。这是通过使用旧值 ( `std::string(std::string& val)`) 调用类的复制构造函数来完成的。

另一方面，第一个变体（带有`&`）通过引用传递，因此更改局部变量将更改调用者的变量，除非引用被标记为 const（在这种情况下，您不能更改值）。这*应该*更快，因为如果您不更改字符串，则不需要进行复制操作。

# javascript - javascript中~~和+的区别？

> ID：14693753
> 
> 赞同：2
> 
> 时间：2013-02-04T19:10:32.890
> 
> 标签：javascript, variables, nan

它们似乎都输出相同的结果并将字符串转换为数字。有我不知道的区别吗？我似乎找不到任何有关 ~~ 运算符的文档。

```
var hey = true
hey = +hey //hey = 1

var hey = true 
hey = ~~hey //hey = 1

var num = "1231"
num = ~~num //num = 1231

var num = "1231"
num = +num //num = 1231 
```

我发现了一个不同之处，那就是 ~~ 总是会尝试输出一个数字，而在某些情况下 + 会简单地返回 NaN

```
num = "omfg"
num = ~~num //num = 0

num = "omfg"
num = +num //num = NaN

num = {}
num = ~~num //num = 0

num = {}
num = +num //num = NaN 
```

任何澄清都会很棒:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T19:14:00.583

两者都会将操作数隐式转换为数字，因为运算符只能用于数字。

不同的是，`~`操作符是位操作符，所以它也会把数字变成32位整数。（结果仍然是类型`Number`，即双精度浮点数。）

两者都不是将值转换为数字的描述性方式，因为它们都使用了实际操作的副作用。通常你会使用类似`parseInt`or的函数`parseFloat`将字符串转换为数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T19:11:59.260

是，有一点不同。试试`~~"3.4"`。

就像`+`, 一样，`~~`尽可能将后面的内容转换为数字，但与`+`它不同的是，它使其成为整数。

在 javascript 中，位运算符总是将数字减少为 32 位整数。而这个“反转其操作数的位”（这意味着整数部分不会因双重执行而改变）。

来自[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators)：

> 所有按位运算符的操作数都以大端顺序和二进制补码格式转换为有符号的 32 位整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T19:13:38.267

`+num`会将字符串转换为数字，但不会将十进制数字转换为整数。对于包含字符和数字的字符串，`NaN`返回。

`~~num`会将字符串转换为数字并去掉任何小数（不四舍五入）。对于包含字符和数字的字符串，`0`返回。

# javascript - 将表单数据传递到另一个 HTML 页面

> ID：14693758
> 
> 赞同：60
> 
> 时间：2013-02-04T19:10:55.860
> 
> 标签：javascript, html, forms

我有两个 HTML 页面：form.html 和 display.html。在form.html中，有一个表单：

```
<form action="display.html">
    <input type="text" name="serialNumber" />
    <input type="submit" value="Submit" />
</form> 
```

表单数据被发送到 display.html。我想`serialNumber`在display.html中显示和使用表单数据，如下图：

```
<body>
    <div id="write">
        <p>The serial number is: </p>
    </div>
    <script>
    function show() {
        document.getElementById("write").innerHTML = serialNumber;
    }
    </script>
</body> 
```

那么如何将`serialNumber`变量从 form.html 传递给 display.html 以便 display.html 中的上述代码将显示序列号并且 JavaScript 函数 show()`serialNumber`从第一个 HTML 中获取？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-04T19:17:07.143

如果您无法选择使用服务器端编程，例如 PHP，您可以使用查询字符串或 GET 参数。

在表单中，添加一个`method="GET"`属性：

```
<form action="display.html" method="GET">
    <input type="text" name="serialNumber" />
    <input type="submit" value="Submit" />
</form> 
```

当他们提交此表单时，用户将被定向到包含该`serialNumber`值作为参数的地址。就像是：

```
http://www.example.com/display.html?serialNumber=XYZ 
```

然后，您应该能够`serialNumber`使用以下值从 JavaScript 解析查询字符串（将包含参数值）`window.location.search`：

```
// from display.html
document.getElementById("write").innerHTML = window.location.search; // you will have to parse
                                                                     // the query string to extract the
                                                                     // parameter you need 
```

另请参阅[JavaScript 查询字符串](https://stackoverflow.com/questions/647259/javascript-query-string)。

* * *

`display.html`另一种方法是在提交表单时将值存储在 cookie 中，并在页面加载后再次从 cookie 中读取它们。

另请参阅[如何使用 JavaScript 在另一个页面上填写表单](https://stackoverflow.com/questions/12183572/how-to-use-javascript-to-fill-a-form-on-another-page/12183659#12183659)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-04T19:20:57.813

您需要从查询字符串中获取值（因为您没有设置方法，默认情况下使用 GET）

使用以下教程。

[http://papermashup.com/read-url-get-variables-withjavascript/](http://papermashup.com/read-url-get-variables-withjavascript/)

```
function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    return vars;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-09-01T12:46:13.980

```
<form action="display.html" method="get">
    <input type="text" name="serialNumber" />
    <input type="submit" value="Submit" />
</form>
```

在 display.html 中，您应该添加以下代码。

```
<script>
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, '\\$&');
    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
}

var sn = getParameterByName('serialNumber');

document.getElementById("write").innerHTML = sn;

</script> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-02-06T22:21:53.170

另一种选择是使用“localStorage”。您可以轻松地在另一个页面中使用 javascript 请求该值。

在第一页上，您使用以下 javascript 代码片段来设置 localStorage：

```
<script>    
   localStorage.setItem("serialNumber", "abc123def456");
</script> 
```

在第二页上，您可以使用以下 javascript 代码片段检索该值：

```
<script>    
   console.log(localStorage.getItem("serialNumber"));
</script> 
```

在 Google Chrome 上您可以按 F12 > 应用程序 > 本地存储对值进行可视化。

来源： [https ://www.w3schools.com/jsref/prop_win_localstorage.asp](https://www.w3schools.com/jsref/prop_win_localstorage.asp)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-28T05:03:58.970

使用“Get”方法通过浏览器发送特定字段的值：

```
<form action="display.html" method="GET">
    <input type="text" name="serialNumber" />
    <input type="submit" value="Submit" />
</form> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-07-18T09:40:56.783

使用纯 JavaScript。使用本地存储非常容易。
第一页表格：

```
function getData()
{
    //gettting the values
    var email = document.getElementById("email").value;
    var password= document.getElementById("password").value; 
    var telephone= document.getElementById("telephone").value; 
    var mobile= document.getElementById("mobile").value; 
    //saving the values in local storage
    localStorage.setItem("txtValue", email);
    localStorage.setItem("txtValue1", password);
    localStorage.setItem("txtValue2", mobile);
    localStorage.setItem("txtValue3", telephone);   
}
```

```
 input{
    font-size: 25px;
  }
  label{
    color: rgb(16, 8, 46);
    font-weight: bolder;
  }
  #data{

  }
```

```
 <fieldset style="width: fit-content; margin: 0 auto; font-size: 30px;">
        <form action="action.html">
        <legend>Sign Up Form</legend>
        <label>Email:<br />
        <input type="text" name="email" id="email"/></label><br />
        <label>Password<br />
        <input type="text" name="password" id="password"/></label><br>
        <label>Mobile:<br />
        <input type="text" name="mobile" id="mobile"/></label><br />
        <label>Telephone:<br />
        <input type="text" name="telephone" id="telephone"/></label><br> 
        <input type="submit" value="Submit" onclick="getData()">
    </form>
    </fieldset>
```

这是第二页：

```
//displaying the value from local storage to another page by their respective Ids
document.getElementById("data").innerHTML=localStorage.getItem("txtValue");
document.getElementById("data1").innerHTML=localStorage.getItem("txtValue1");
document.getElementById("data2").innerHTML=localStorage.getItem("txtValue2");
document.getElementById("data3").innerHTML=localStorage.getItem("txtValue3");
```

```
 <div style=" font-size: 30px;  color: rgb(32, 7, 63); text-align: center;">
    <div style="font-size: 40px; color: red; margin: 0 auto;">
        Here's Your data
    </div>
    The Email is equal to: <span id="data"> Email</span><br> 
    The Password is equal to <span id="data1"> Password</span><br>
    The Mobile is equal to <span id="data2"> Mobile</span><br>
    The Telephone is equal to <span id="data3"> Telephone</span><br>
    </div>
```

# 重要的提示：

请不要忘记为第二个 html 文件命名为“action.html”以使代码正常工作。我不能在一个片段中使用多个页面，这就是为什么它不能在这里工作在你的编辑器的浏览器中尝试它肯定会工作的原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-12T06:32:28.743

如果您的情况与描述的一样；您必须从单个表单向不同的 serverlet 发送操作，并且您有两个提交按钮，并且您希望将每个提交按钮发送到不同的页面，那么您最简单的答案就在这里。

要将数据发送到两个servelet，将一个按钮作为提交，另一个作为按钮。在第一个按钮上，您的表单标记中的发送操作正常，但在另一个按钮上调用JavaScript函数，您必须提交具有相同字段的表单，但到不同的servlet，然后在第一次关闭后编写另一个表单标签。在那里声明相同的文本框但具有隐藏属性。现在当您以第一个表单插入数据时，然后使用一些javascript代码将其插入另一个隐藏表单中。为提交的第二个按钮编写一个函数第二种形式。然后，当您单击提交按钮时，它将在第一个表单中执行操作，如果您单击按钮，它将调用函数以提交第二个表单及其操作。现在您的第二个表单将被调用到第二个 servlet。

在这里，您可以使用一些混合的 javascript 代码从同一个 html 或 jsp 页面调用两个服务器

第二种隐藏形式的**示例**

```
<form class="form-horizontal" method="post" action="IPDBILLING" id="MyForm" role="form">
    <input type="hidden" class="form-control" name="admno" id="ipdId" value="">
</form>
<script type="text/javascript">
    function Print() {
        document.getElementById("MyForm").submit();
    }
</script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-20T07:23:50.907

```
*first html page*

<form action="display.jsp" >
    <input type="text" name="serialNumber" />
    <input type="submit" value="Submit" />
</form>

*Second html page*
<body>
<p>The serial number is:<%=request.getParameter("serialNumber") %></p>
</body>

you will get the value of the textbox on another page. 
```

# c# - 在 C# 中创建 .htpasswd 文件

> ID：14693759
> 
> 赞同：0
> 
> 时间：2013-02-04T19:11:05.543
> 
> 标签：c#, .htaccess, web, .htpasswd

对于自动化网站部署的小工具，我想生成 .htaccess 和 .htpasswd 文件。如何在我的代码中为密码创建哈希？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T21:12:50.010

[根据此处](http://httpd.apache.org/docs/2.2/misc/password_encryptions.html)有关 .htpasswd 散列方法的文档，以下内容应使用 SHA1 作为散列算法生成可插入到 .htpasswd 文件中的合适输出行：

```
public static string CreateUser(string username, string password)
{
    using (var sha1 = SHA1.Create())
    {
        var hash = sha1.ComputeHash(Encoding.UTF8.GetBytes(password));
        return string.Format("{0}:{{SHA}}{1}", username, Convert.ToBase64String(hash));
    }
} 
```

例子：

```
Console.WriteLine(CreateUser("TestUser", "TestPassword")); 
```

将输出：

`TestUser:{SHA}YlBiWyJt9ihwriOvjT+sB2DXFYg=`

使用此方法构造有效的 .htaccess 文件应该很简单。

# javascript - 在 Node 中为 module.exports 使用包装匿名函数是不好的做法吗？

> ID：14693763
> 
> 赞同：1
> 
> 时间：2013-02-04T19:11:21.180
> 
> 标签：javascript, node.js, express

我最近开始在我的 NodeJS express 模块中使用包装匿名函数，因为它以某种方式帮助我编写更清晰的代码。

但是我不确定这在 Node 环境中是否被认为是不好/好的做法（可能是一些调试/优化问题？），Coffeescript 广泛使用它，所以我想它一定没问题，是吗？

*快速控制器示例：*

```
module.exports = (function() {

  function LinksController() {}

  var moment = require('moment'),
      _ = require('underscore'),
      Q = require('q');

  LinksController.edit = function edit(req, res, next) {
        ...
  }

  return LinksController;

})(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T19:36:32.123

这样做在技术上没有任何问题，但完全没有必要。

# c++ - 将方法作为参数传递给另一个方法的可能性

> ID：14693764
> 
> 赞同：0
> 
> 时间：2013-02-04T19:11:28.187
> 
> 标签：c++

我正在学习 c++，我想知道是否可以将一个方法作为参数传递给另一个方法？

我想要做的大致轮廓是这样的：

```
void insertionSort() {
   //perform sort
}

int timeOfOperation(methodInQuestion) {
    // time 1
    methodInQuestion;
    //time 2
    return time2-time;
}

int main() {
   cout << timeOfOperation(insertionSort());
   return 0;
} 
```

有没有办法做这样的事情？

编辑：

我很欣赏这些回复。不过我还有一个问题。在我的实际代码中，这一切都发生在一个名为 dataStructure 的类中，我正在其他地方创建它的一个实例并调用这些方法。

```
dataStructure ds();
ds.timeOperation(ds.insertionSort()); 
```

当我尝试实施发布的一些解决方案时，我收到此错误：

```
IntelliSense: no instance of function template
"dataStructure::timeOperation" matches the argument list argument
types are: (void) object type is: dataStructure 
```

我真的不明白为什么创建实例会影响这一点。谁能解释一下？

==================================================== ===========

编辑2：

我将或多或少地发布这部分的确切代码：

```
//main.cpp

#include "arrayList.h"
#include "arrayListStructure.h"
#include "Person.h"

using namespace std;

int main() {

    arrayList<Person> *al = new arrayList<Person>(length);
    arrayListStructure als(al);
    //als.fillStructure(data);
    als.timeOperation(als.insertionSort());

return 0;
}

//arrayListStructure.cpp

#include "arrayListStructure.h"
#include <functional>

double arrayListStructure::timeOperation(std::function<void()> operation) {...}
void arrayListStructure::insertionSort() {...}

arrayListStructure::arrayListStructure(arrayList<Person> *al)
{
this -> al = al;
} 
```

还有更多，但我认为这就是与问题有关的全部

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:22:21.500

是的，例如：

```
#include <functional>
#include <ctime>
#include <iostream>

void insertionSort() { /*...*/ }

std::clock_t timeOfOperation( std::function<void()> operation ) 
{
    const std::clock_t start = std::clock();
    operation();
    return std::clock() - start;
}

int main() 
{
    std::cout << timeOfOperation(insertionSort) << '\n';
} 
```

由于您可能不想要全局数据（像插入排序这样的无参数函数需要），您可能会执行以下操作：

```
template<class Container>
void insertionSort( Container& c ) 
{ 
   /*sort the contents of c*/ 
} 
```

现在您必须传递要排序的数据。您可以使用 std::bind 或更好的 C++11 lambda 来执行此操作。然后，正如 Yakk 的回答中所指出的，我们可以模板化计时器函数，以便它本机接受 std::functions、lambdas、仿函数（具有 operator() 重载的类）或函数指针：

```
template<class Operation>
std::clock_t timeOfOperation( Operation&& operation ) 
{/*...*/ } 
```

这是完整的程序：

```
#include <functional>
#include <iostream>
#include <iterator>
#include <vector>
#include <algorithm> // for generate
#include <ctime> // for clock
#include <cstdlib> // for rand

template<class Container>
void insertionSort( Container& c ) 
{ 
   /*sort the contents of c*/ 
}

template<class Operation>
std::clock_t timeOfOperation( Operation&& operation ) // or just timeOfOperation( Operation&& operation )
{
    const std::clock_t start = std::clock();
    operation();
    return std::clock() - start;
}

int main() 
{
    std::vector<int> v( 100 );
    std::generate( v.begin(), v.end(), std::rand );
    auto op = [&]() { insertionSort( v ); };
    std::cout << timeOfOperation( op ) << '\n';
} 
```

像这样组合最后两行（使用 C++11 lambda）：

```
std::cout << timeOfOperation( [&]() { insertionSort( v ); } ) << '\n'; 
```

但是，当然，在非家庭作业代码中，您应该使用内置的排序函数，而不是自己滚动。

* * *

关于您的更新：第一行实际上是函数定义，而不是类的实例化：

```
dataStructure ds(); // function, not an instance!
ds.timeOperation(ds.insertionSort()); // insertionSort returns void. 
// Can't convert void to a template param that can be called with the () operator 
```

在 C++ 中，规则是，如果某些东西可以被解释为函数原型，那么它就是。放下括号，你会没事的：

```
dataStructure ds; // <-- note
ds.timeOperation(ds.insertionSort()); 
```

* * *

在回答您的评论时，只要它不能被解释为原型，您就很好。考虑：

```
struct S {};

struct dataStructure
{
   dataStructure() {}
   dataStructure(int) {}
   dataStructure(S) {}
   void go() {}
};

int main()
{
    dataStructure ds1 = dataStructure();
    dataStructure ds2(10);
    dataStructure ds3( S() ); 
    dataStructure ds4( (S()) ); // Extra parens clarify for the compiler

    ds1.go(); // Ok  
    ds2.go(); // Ok  
    ds3.go(); // Doh! ds3 is a function prototype
    ds4.go(); // Ok  
} 
```

* * *

为您的编辑 2 更新：

更改此行：

```
als.timeOperation(als.insertionSort()); 
```

到：

```
als.timeOperation([&](){als.insertionSort()}); 
```

或（不太喜欢，但如果你没有 lambdas）：

```
als.timeOperation( std::bind( &arrayListStruction::insertionSort, als ) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T19:27:21.850

演示如何使用函数指针

* * *

### 演示：

```
#include <iostream>
using namespace std;

void insertionSort() {
   cout<<"insertion"<<endl;
}

int timeOfOperation(void(*sortFunc)(void)) {
   sortFunc();
   return 1;
}

int main() {
   cout << timeOfOperation(insertionSort);
   return 0;
} 
```

请参阅**[此演示](http://ideone.com/b4WiEM)**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T19:30:21.340

当您对操作进行计时时，您希望尽可能少的开销。

```
#include <functional>
#include <ctime>
#include <iostream>

void insertionSort() { /*...*/ }

template<typename F>
std::clock_t timeOfOperation( F&& operation ) {
  const std::clock_t start = std::clock();
  // time 1
  operation();
  //time 2
  return std::clock() - start;
}

int main() {
  std::cout << timeOfOperation(insertionSort) << '\n';
} 
```

这是@metal 的解决方案，除了模板。通过 调用函数的开销适中`std::function`。不利的一面是，这意味着我们必须将实现`timeOfOperation`放入头文件中。

顺便说一句，如果您的编译器不支持 C++11，`&&`请将签名中的 放到 中`timeOfOperation`，这是一个不需要的 C++ 功能。

如果你想用状态来计时多行代码，你可以这样做：

```
void sort( int* buff, size_t count ) { /* ... */ }

int main() {
  enum { size_of_data = 10 };
  int data[size_of_data] = {1,2,3,4,5,6,-1,0};
  std::cout << timeOfOperation([&](){
    sort( &data[0], size_of_data );
  }) << '\n';
} 
```

同样`timeOfOperation`——我在那里写的 lambda 作为模板化仿函数传入，然后在几乎`timeOfOperation`没有开销的情况下在其中调用。

# objective-c - 将字典数组绑定到 nstableview

> ID：14693766
> 
> 赞同：-1
> 
> 时间：2013-02-04T19:11:38.183
> 
> 标签：objective-c, xcode, cocoa, nsdictionary, nstableview

----已编辑----

我的情况：我有一个基于单元格的`NSTableView`. 在这个表格视图中有 3 个`NSColums`，1 个是图像框，一个是文本框，第三个是复选框。我有一个数组控制器，它正在填充以下代码：

```
 [imgArrayController addObject:[NSMutableDictionary dictionaryWithObjectsAndKeys:[NSImage imageNamed:[NSString stringWithFormat:@"%@" ,fileName]], @"image", [NSString stringWithFormat:@"%@" ,fileName], @"filename", [NSNumber numberWithBool: YES], @"check1", nil]]; 
```

但是这段代码不能正常工作。我从各种测试中知道这段代码不起作用，它添加了行，但它们是空的。它的 4 天我现在正在寻找这个解决方案，但没有任何运气。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:04:49.507

不确定您的图像部分是否正确..试试这个：

```
NSMutableDictionary *imgdtl = [[NSMutableDictionary alloc] init];

    NSImage *myimage = [[NSImage alloc] initWithContentsOfFile:[NSString stringWithFormat:@"%@" ,fileName]];        
    [imgdtl setObject: myimage forKey: @"image"];
    [imgdtl setObject:[NSString stringWithFormat:@"%@" ,fileName] forKey: @"filename"];
    [imgdtl setObject:[NSNumber numberWithBool: YES] forKey: @"check1"];
    [imgArrayController addObject:[imgdtl copy]]; 
```

# c# - 似乎无法得到这个正则表达式

> ID：14693767
> 
> 赞同：0
> 
> 时间：2013-02-04T19:11:38.420
> 
> 标签：c#, asp.net, regex

我有一个字符串：

```
<a href="mailto:me@company.com">Joel Werner</a> 
```

我需要除掉我的名字以外的所有东西

我现在的表情，差不多就是这样。

```
var pattern = new System.Text.RegularExpressions.Regex(">(?<name>.+?)<"); 
```

但是当我匹配他们时，我得到

```
>Joel Werner< 
```

我错过了什么，因为我不太喜欢正则表达式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:16:26.380

如果您不喜欢正则表达式，请不要在这种情况下使用它们。使用正则表达式解析 HTML 通常非常糟糕。请参阅[此答案以了解原因](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。

使用[CsQuery](https://github.com/jamietre/CsQuery)：

```
Console.WriteLine(CQ.Create("<a href=\"mailto:me@company.com\">Joel Werner</a>"). //create the selector
Attr("href"). //get the href attribute
Split(new char[]{':','@'})[1]); //split it by : and @ and take the second group (after the mailto) 
```

使用内置 LINQ to XML：

```
 XDocument doc = XDocument.Parse("<a href=\"mailto:me@company.com\">Joel Werner</a>");
 Console.WriteLine(doc.Element("a").Attribute("href").ToString().Split(new char[] {':', '@'})[1]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:13:54.960

使用组来获取匹配的名称：

```
var name = pattern.Match(input).Groups["name"].Value; 
```

您还可以`Success`在引用组之前验证匹配：

```
var match = pattern.Match(input);
if (match.Success)
    name = match.Groups["name"].Value; 
```

您也可以按索引引用组`Groups[1]`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:14:25.453

使用这个正则表达式

```
<([A-Z][A-Z0-9]*)\b[^>]*>(.*?)</\1> 
```

然后使用第二个匹配，第一个匹配是标签类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T20:26:56.567

```
var input = "<a href=\"mailto:me@company.com\">Joel Werner</a>";
var pattern = new System.Text.RegularExpressions.Regex(@"<a\shref=""(?<url>.*?)"">(?<name>.*?)</a>");
var match = pattern.Match(input);
var name = match.Groups["name"].Value; 
```

# xpath - HtmlAgilityPack，使用 XPath 包含方法和谓词

> ID：14693773
> 
> 赞同：6
> 
> 时间：2013-02-04T19:12:00.617
> 
> 标签：xpath, html-agility-pack, contains

HtmlAgilityPack，使用 XPath 包含方法

我正在使用 HtmlAgilityPack，我需要知道类属性是否包含特定单词，现在我有这个页面：

```
<div class="yom-mod yom-art-content "><div class="bd">
<p class="first"> ....................
  </p>
</div>
</div> 
```

我正在这样做：

```
HtmlDocument doc2 = ...;
List<string> paragraphs = doc2.DocumentNode.SelectNodes("//div[@class = 'yom-mod yom-art-content ']//p").Select(paragraphNode => paragraphNode.InnerHtml).ToList(); 
```

但它太具体了，我需要的是这样的：

```
List<string> paragraphs = doc2.DocumentNode.SelectNodes("//div[contains(@class, 'yom-art-content']//p").Select(paragraphNode => paragraphNode.InnerHtml).ToList(); 
```

但它不起作用，请帮助我..

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-04T19:51:24.470

也许问题只是您缺少 contains() 函数的右括号：

```
//div[contains(@class, 'yom-art-content']//p
                                        v
//div[contains(@class, 'yom-art-content')]//p

List<string> paragraphs = 
        doc2.DocumentNode.SelectNodes("//div[contains(@class, 'yom-art-content')]//p")
            .Select(paragraphNode => paragraphNode.InnerHtml).ToList(); 
```

作为一般建议，请解释您说“它不起作用”之类的意思。我怀疑您收到可能有助于追查问题的错误消息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:16:17.800

不要为此使用 HAP，而是查看提供 jQuery 样式选择器的[CsQuery 。](https://github.com/jamietre/CsQuery)

它看起来特别适合您正在尝试做的事情。

> CsQuery 是 .NET 4 的 jQuery 端口。它实现了所有 CSS2 和 CSS3 选择器、jQuery 的所有 DOM 操作方法以及一些实用方法。大多数 jQuery 测试套件（从 1.6.2 开始）已移植到 C#。

# c# - 您什么时候需要 SimpleInjector 混合注册？（如何在没有 HttpContext 的情况下调用 IIS 中托管的对象？）

> ID：14693774
> 
> 赞同：1
> 
> 时间：2013-02-04T19:12:13.550
> 
> 标签：c#, iis, dependency-injection, simple-injector

继[我最近关于 SimpleInjector 和混合 Web 请求/线程生活方式的问题](https://stackoverflow.com/questions/14687475/simpleinjector-mixed-lifestyle-for-per-web-request-and-lifetime-scope/14692613#14692613)之后，我似乎没有完全理解技术要求，并且一直在做一些我实际上不需要做的事情。

使用此代码

```
interface IUnitOfWork { }
interface IWebUnitOfWork : IUnitOfWork { }
interface IThreadUnitOfWork : IUnitOfWork { }
class UnitOfWork : IWebUnitOfWork, IThreadUnitOfWork { }

container.RegisterPerWebRequest<IWebUnitOfWork, UnitOfWork>();
container.RegisterLifetimeScope<IThreadUnitOfWork, UnitOfWork>();
container.Register<IUnitOfWork>(() => container.GetInstance<UnitOfWork>());

// Register as hybrid PerWebRequest / PerLifetimeScope.
container.Register<UnitOfWork>(() =>
{
    if (HttpContext.Current != null)
        return container.GetInstance<IWebUnitOfWork>() as UnitOfWork;
    else
        return container.GetInstance<IThreadUnitOfWork>() as UnitOfWork;
}); 
```

我的理解是，对于在 IIS 中运行的 AppDomain，`IWebUnitOfWork`将返回，否则会出现错误，除非我明确声明 LifetimeScope 的实例来包装对容器的调用（它将返回`IThreadUnitOfWork`）。

以下陈述让我意识到我并不完全理解我一直在做什么！

> 但是，您似乎不需要混合生活方式。混合生活方式是一种可以动态切换的生活方式（在每次调用 GetInstance 和每次注入时），而您似乎只需要在启动期间进行切换。

我的问题是：在什么情况下可以在不存在 HttpContext 的情况下调用在 IIS 中运行的 AppDomain 中加载的容器（或任何其他类），无论是静态的还是实例的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T09:04:43.010

正如 Steven 在评论中概述的那样，当 Web 请求可以在另一个线程上启动进程时，通常需要混合注册。在这种情况下，可以要求容器为 Web 请求和线程请求提供服务。

# sql - 具有多个结果的子查询，SQL Server

> ID：14693775
> 
> 赞同：2
> 
> 时间：2013-02-04T19:12:20.460
> 
> 标签：sql, sql-server, tsql

我有一个看起来像这样的查询：

```
SELECT * 
FROM dbo.document_library_file_attributes 
WHERE my_file_id=
(SELECT my_file_id 
 FROM dbo.document_library_file_attributes 
 WHERE attribute_name='Directory/Key' AND attribute_value LIKE @directory+'%') 
```

我希望子查询能够返回多个结果，这意味着`my_file_id`可以等于“directoryA”、“directoryB”，并且我想要所有这些的结果。我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T19:13:18.400

使用[`IN`](http://msdn.microsoft.com/en-gb/library/ms177682.aspx)而不是`=`结果集：

```
SELECT * 
FROM dbo.document_library_file_attributes 
WHERE my_file_id IN
(SELECT my_file_id 
 FROM dbo.document_library_file_attributes 
 WHERE attribute_name='Directory/Key' AND attribute_value LIKE @directory+'%') 
```

它：

> 确定指定值是否与子查询或列表中的任何值匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T19:15:56.550

我认为 a`JOIN`是表达你想要做的事情的更好方式：

```
SELECT DISTINCT lfa2.* 
FROM 
    dbo.document_library_file_attributes lfa
    JOIN dbo.document_library_file_attributes lfa2
        ON lfa.my_file_id = lfa2.my_file_id 
WHERE 
    lfa.attribute_name='Directory/Key' 
    AND lfa.attribute_value LIKE @directory+'%' 
```

# xml - 输出几个 XSL 变量值的最佳方法是什么？

> ID：14693787
> 
> 赞同：1
> 
> 时间：2013-02-04T19:12:48.640
> 
> 标签：xml, variables, xslt, iterator, value-of

如果您有一个 XSL 转换，其代码看起来或多或少如下所示：

```
<xsl:variable name="a0" select="some expression"/>
<xsl:variable name="a1" select="some expression"/>
<xsl:variable name="a2" select="some expression"/>
...
<xsl:variable name="an" select="some expression"/> 
```

...并且您想打印与每个变量关联的文本值，有没有比以下任何方法更优雅和简洁的方法？

1.

```
<xsl:value-of select="$a0"/>
<xsl:value-of select="$a1"/>
<xsl:value-of select="$a2"/>
 ...
<xsl:value-of select="$an"/> 
```

2.

```
<xsl:foreach select="$a0 | $a1 | $a2 | ... | $an>
  <xsl:value-of select="."/>
</xsl:foreach> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:21:44.700

是的，只需使用以下`concat()`功能：

```
<xsl:value-of select="concat($a0, $a1, $a2, ..., $an)" /> 
```

# c# - 如何使用c#在数据库中查找文本

> ID：14693788
> 
> 赞同：0
> 
> 时间：2013-02-04T19:12:50.950
> 
> 标签：c#, c#-4.0, c#-3.0, c#-2.0

> **可能重复：**
> [如何在 C# 中搜索数据库中的字符串](https://stackoverflow.com/questions/14695282/how-to-make-search-of-a-string-in-a-data-base-in-c-sharp)

我想详细搜索一个名字..这就是搜索按钮的代码

```
private void button1_Click(object sender, EventArgs e)
{
    string connectionString = Tyres.Properties.Settings.Default.Database1ConnectionString;
    SqlConnection conn = new SqlConnection(connectionString);
    DataTable dt = new DataTable();
    SqlDataAdapter SDA = new SqlDataAdapter("SELECT * FROM table1 where Details like" + textBox1.Text, conn);
    SDA.Fill(dt);
    dataGridView1.DataSource = dt;
} 
```

和我的应用程序的这个例子 [![点击这里查看图片](../Images/6c31ab20604b0ede952b1b3fd3adf78d.png)](https://i.stack.imgur.com/byAba.jpg)

我收到错误消息：

```
An unhandled exception of type 'System.Data.SqlClient.SqlException' occurred in System.Data.dll 
```

附加信息：在预期条件的上下文中指定的非布尔类型表达式，靠近“likeelie”。

我已经尝试过这段代码来搜索一个整数（如 Quantity），它对我很有效：

```
private void button1_Click(object sender, EventArgs e)
{
    string connectionString = Tyres.Properties.Settings.Default.Database1ConnectionString;
    SqlConnection conn = new SqlConnection(connectionString);
    DataTable dt = new DataTable();
    SqlDataAdapter SDA = new SqlDataAdapter("SELECT * FROM table1 where Quantity like" + int.parse(textBox1.Text), conn);
    SDA.Fill(dt);
    dataGridView1.DataSource = dt;
} 
```

所以我需要第一个代码的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T19:15:08.973

看起来您需要在 SQL 语句中添加一个空格，您只是在`textBox1.Text`没有空格的情况下附加了 of 的值，因此 of 的值`textBox.Text`变成了一个带有`like`.

```
SqlDataAdapter SDA = new SqlDataAdapter("SELECT * FROM table1 where Details like " + textBox1.Text, conn); 
```

# tridion - 如何在 Tridion 受众经理联系人中更新 null ExtendedDetail？

> ID：14693791
> 
> 赞同：4
> 
> 时间：2013-02-04T19:12:58.033
> 
> 标签：tridion, tridion-2011

我有一些代码可以通过 Tridion.AudienceManagement.API 与联系人一起使用。与现有联系人一起工作时，其中一些联系人的`ExtendedDetail`s 与其他联系人不同。当我想填充一个还没有值的值时，我遇到了麻烦

```
var extendedDetail = contact.ExtendedDetails[fieldName];
if (extendedDetail == null)
{
  // What do I do here?
} 
```

问题是当给定的 ExtendedDetail 为空时，我无法设置它的值。文档中的代码示例没有涵盖此示例，API 文档也没有解释 null ExtendedDetail 的含义，更不用说如何创建和适当地填充它了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:30:48.397

您需要使用 获取/设置 ExtendedDetails 的值`.Value`。

```
var extendedDetail = contact.ExtendedDetails[fieldName].Value;
if (extendedDetail == null)
{
  contact.ExtendedDetails[fieldName].Value = "VALUE"
} 
```

供您参考，请查看文档“Audience Manager .NET API”（chm）并查看“ExtendedDetail”类以获取一些示例。

更新：我还没有看到 ExtendedDetails 为空的情况。我使用以下最低限度数据进行了测试，以创建联系人，然后获取扩展数据详细信息。当您创建联系人时，您需要拥有`IDENTIFICATION_KEY`并且`IDENTIFICATION_SOURCE`是强制性的并且是 的一部分`ExtendedDetails`，因此您永远不应该遇到这种情况。

```
//Create a Contact with basic data..
Contact contact = new Contact();
contact.EmailAddress = "abc@123.com";
contact.SubscriptionStatus = SubscriptionStatus.Subscribed;
contact.ExtendedDetails["IDENTIFICATION_KEY"].Value = "abc@123.com";
contact.ExtendedDetails["IDENTIFICATION_SOURCE"].Value = "Website";
contact.Save();

// UPDATE the User Profile ..
ContactId = new string [] { "abc@123.com", "Website" };
Contact contact = Contact.GetFromContactIdentificatonKeys(ContactId);
contact.ExtendedDetails["NAME"].Value = "NAME"; 
```

您能否发布有关如何创建联系人的代码？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T10:05:12.070

如果您的扩展详细信息为空，可能是因为您试图指定一个实际上不存在的字段。也许您拼错了它，或者您的数据库表尚未更新，或者您对数据库所做的最近更改尚未被拾取（扩展详细信息集合由于明显的原因被大量缓存）。

简而言之，如果在数据库中定义了扩展详细信息，它将在该集合中可用——因此它不会为空。

# javascript - 使用 jquery 拉取并显示 YQL 财务数据并使用 .html() 显示

> ID：14693792
> 
> 赞同：0
> 
> 时间：2013-02-04T19:12:59.400
> 
> 标签：javascript, html, json, yql

我遇到了 .html() 函数和 YQL 提取数据的问题。数据正在拉取（使用 YQL 控制台可以看到数据），但没有显示或显示任何结果。

这是代码：

HTML

```
<ul id="TECO-container">
    <li class="high">High: </li>
    <li class="low">Low: </li>
    <li class="close">Closing: </li>
    <li class="volume">Volume: </li>
</ul> 
```

JS

```
// initialise plugins
jQuery(function () {
    tecoGetQuote('TECO');
});

//The above function is on a different .js than the below script.

var tecoGetQuote = function (symbol) {
    var yqlURL = "http://query.yahooapis.com/v1/public/yql?q=";
    var dataFormat = "&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys";
    var realtimeQ = yqlURL + "select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22" + symbol + "%22)%0A%09%09&" + dataFormat;
    $(function () {
        $.getJSON(realtimeQ, function (json) { //YQL Request
            //console.log(json.query.results.quote);
            //<li class="high">High: -</li><li class="low">Low: -</li><li class="close">Closing: -</li><li class="volume">Volume: -</li>
            $('#TECO-container .high').html('High: <span style="font-weight: bold; color:#FFBB00">' + json.query.results.quote.DaysHigh + '</span>');
            $('#TECO-container .low').html('Low: <span style="font-weight: bold; color:#FFBB00">' + json.query.results.quote.DaysLow + '</span>');
            $('#TECO-container .close').html('Closing: <span style="font-weight: bold; color:#FFBB00">' + json.query.results.quote.PreviousClose + '</span>');
            $('#TECO-container .volume').html('Volume: <span style="font-weight: bold; color:#FFBB00">' + addCommas(json.query.results.quote.Volume) + '</span>');
        });
    });
}; 
```

这是 JSFiddle：http: [//jsfiddle.net/Darthfuzzy/cPFKE/4/](http://jsfiddle.net/Darthfuzzy/cPFKE/4/)

根据 JSFiddle，HTML/JS 是完全有效的。所有迹象都表明它也应该运行。结果应该只显示当前的市场数据，我之前在网站上看到过类似的功能。我只是无法弄清楚JS没有在哪里运行。

脚本应该相当简单：股票代码是“TECO”（定义为 tecoGetQuote）。然后，该函数从 YQL JSON 中提取财务数据，然后打印数据。然而由于某种原因，无论我如何更改这些内容，它都不会显示。

有人可以通过指出问题所在来帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:21:25.660

如果有人想知道，编码没有问题，而是回调=？未添加到 JS 中导致访问控制允许来源问题。

[XmlHttpRequest 错误：Access-Control-Allow-Origin 不允许 Origin null](https://stackoverflow.com/questions/3595515/xmlhttprequest-error-origin-null-is-not-allowed-by-access-control-allow-origin)

将 var 数据格式行更改为：

```
var dataFormat ="&callback=&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys"; 
```

解决了这个问题。

# assembly - 在 HLA 中添加变量？

> ID：14693794
> 
> 赞同：1
> 
> 时间：2013-02-04T19:13:02.970
> 
> 标签：assembly, hla

所以，我正在尝试添加变量，但它不想工作。我有一个非常简单的程序。

```
program tested;

var
    i: int8;
    x: int8;

begin tested;
    mov(10, i);
    mov(5, x);
    add(i, x);
    stdout.put(x);

end tested; 
```

我收到以下错误：“第 11 行的文件 'tested.hla' 中的错误 [errid:129712/hlaparse.c]：语法错误，意外 ')'，期待 '('。近：<<) >>”

mov 应该将数字移动到变量中..add 应该添加两件事。为什么它不起作用？

我不太了解 hla 所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-11-06T22:47:02.617

```
add( source, destination ); 
```

万一你不是私人的，目标和源操作数都不能是内存位置。这就是为什么它不起作用。

源可以是寄存器、常量或内存
目标可以是寄存器或内存
两者都不能是内存
两者的大小必须相同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-01T10:04:17.517

注意 5 和 10 是“常数”，不能改变 5 或 10 的值。记住`mov(dest, source);` 例如： `mov(x,i);`复制 i 的值并将其放在 x 的地址中

# ios5 - Apple LLVM Compiler 3 上出现错误，但 4.1 上没有错误

> ID：14693798
> 
> 赞同：1
> 
> 时间：2013-02-04T19:13:12.503
> 
> 标签：ios5, ios6, xcode4.2, xcode4.5, llvm

我使用 LLVM 4.1 在 xcode 4.5 上创建了一个项目，但是当我将其发送给我的朋友时，他遇到了很多错误，例如声明方法错误和其他错误，但是我的项目在我的 macbook 上完美运行，当然任何资源和框架都没有输了。我想知道，有没有办法在 xcode 4.5 上安装 LLVM 3.0 编译器，因为我的朋友无法更新他的 xcode 以获取更新大小。

# php - PHP 绝对根路径和根 url

> ID：14693805
> 
> 赞同：1
> 
> 时间：2013-02-04T19:13:26.450
> 
> 标签：php

我试图定义我的应用程序的绝对根路径和根 url。我试过[这个](https://stackoverflow.com/questions/176712/how-can-i-find-an-applications-base-url#answer-185725)，但是我还不能理解一些东西。

我`config.inc.php`在`root`文件夹中创建了答案中的代码。我也有我包含的文件`index.php`，并且常量很好。但是我还有另一个文件，其中我也包含，但根 url 最后包含示例文件夹。`root``config.inc.php``${ROOT}/example/file.php``config.inc.php`

应用程序结构是：

```
config.inc.php
index.php
example/file.php 
```

我怎样才能始终拥有我的应用程序的绝对根路径和根 url？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T19:19:12.140

绝对根路径：

```
$_SERVER['DOCUMENT_ROOT'] 
```

根文件夹的路径：

```
dirname($_SERVER['PHP_SELF']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:21:10.030

您可以在配置文件中手动输入绝对和根 url，当包含它时，他会为您提供一个具有绝对和根 url 的变量。对于根目录，您可以使用`$_SERVER['DOCUMENT_ROOT']`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:37:35.943

我一直在我的 php 应用程序中使用以下代码：

** config.php **

```
$base = str_replace(
    $_SERVER['DOCUMENT_ROOT'],
    '',
    realpath(dirname(__FILE__)));

$base = ($base == '') ? '/' : ''; 
```

您可以从任何地方包含此文件，它将提供文件夹的基本 uri `config.php`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-22T09:16:31.767

如果您在 Windows 上处理文件，那么您可能需要同时使用两者

```
$full_path = $_SERVER['DOCUMENT_ROOT'].dirname($_SERVER['PHP_SELF']); 
```

# firefox - 我的 Greasemonkey 脚本在更新后停止工作

> ID：14693806
> 
> 赞同：1
> 
> 时间：2013-02-04T19:13:27.510
> 
> 标签：firefox, greasemonkey, cdata, e4x, scriptish

我为*StumbleUpon*制作了一个 Greasemonkey 脚本，并且成功了。但突然间，也许在 Mozilla 或 Scriptish 更新之后，它停止了所有协议的工作。

请检查[我的脚本](http://userscripts.org/scripts/show/126614 "为方便起见添加了链接； 下面是相同的代码。")是否有错误。我是脚本新手

脚本：

```
// ==UserScript==
// @name            [udit]add stumblethru image-flip button[w/o container] on all websites
// @namespace       testing-for-that-script
// @description     
// @include         http://facebook.com/*
// @include         http://*
// @include         https://*
// @include         *
// @exclude         file:///*
// ==/UserScript==

if (window.top != window.self)  //don't run on frames or iframes
{
    //Optional: GM_log ('In frame');
    return;
}

/*--- Create a button in a container div.  It will be styled and positioned with CSS.
*/
var zNode       = document.createElement ('input');
zNode.setAttribute ('id', 'suButton');
zNode.setAttribute( 'type', 'image' );
zNode.setAttribute( 'src', 'http://www.creativeadornments.com/nephco/doraemon/icons/doraemon_18a.gif' );
document.body.appendChild (zNode);

function tiddu1()
{
document.getElementById("suButton").src ="http://www.creativeadornments.com/nephco/doraemon/icons/doraemon_07.gif";
}

function tiddu2()
{
document.getElementById("suButton").src ="http://www.creativeadornments.com/nephco/doraemon/icons/doraemon_18a.gif";
}

function tiddu3()
{
document.getElementById("suButton").src ="http://www.creativeadornments.com/nephco/doraemon/icons/dorami_01a.gif";
}

function tiddu4()
{
document.getElementById("suButton").src ="http://t1.gstatic.com/images?q=tbn:ANd9GcSI_hx0nLvnO-Em6elAxyMnoBFGw8IMD3Yrpep4XY2I51GylSRf3jHiabAyiw";
}

//--- Activate the newly added button and add rollover image handling.
var zNode = document.getElementById ("suButton");
zNode.addEventListener ("click",        ButtonClickAction,  true);
zNode.addEventListener ("mouseover",    tiddu1,          true);
zNode.addEventListener ("mouseout",     tiddu2,           true);
zNode.addEventListener ("mousedown",     tiddu3,           true);
zNode.addEventListener ("click",     tiddu4,           true);

function ButtonClickAction (zEvent)
{
    //--- For our dummy action, we'll just add a line of text to the top of the screen.
    var button  = document.createElement ('a');
    location.href='http://www.stumbleupon.com/to/stumble/stumblethru:'+location.href.replace("http://","").replace("https://","").replace("ftp://","").split('/',4)[0];
}

//--- Style our newly added elements using CSS.
GM_addStyle ( (<><![CDATA[
    #suButton {
        position:               fixed;
        bottom:                 0px;
        left:                   0px;
        margin:                 0px 0px 50px 0px;
        opacity:                0.8;
        cursor:                 url(C:\buttercup_06.cur),url(http://www.creativeadornments.com/nephco/powerpuffgirls/cursors/ppg_01anim.gif),url(myBall.cur),pointer;
        border:                 0px outset red;
        z-index:                222;
        padding:                5px 5px;
    }
]]></>).toString () ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T23:26:45.597

在 Firefox 版本 17 中，[Firefox 放弃了对 E4X 的支持](https://developer.mozilla.org/en-US/docs/E4X)。E4X 使我们能够使用该`(<><![CDATA[ ... ]]></>).toString ()`结构来制作简单、健壮的多行字符串。

现在不再支持 E4X，我们必须重构使用的每一段代码`CDATA`，以使用 javascript 字符串转义 ( `\`)。因此，您需要将该`GM_addStyle`调用更改为：

```
GM_addStyle ( "                                             \
    #suButton {                                             \
        position:       fixed;                              \
        bottom:         0px;                                \
        left:           0px;                                \
        margin:         0px 0px 50px 0px;                   \
        opacity:        0.8;                                \
        cursor:         url(C:\buttercup_06.cur),url(http://www.creativeadornments.com/nephco/powerpuffgirls/cursors/ppg_01anim.gif),url(myBall.cur),pointer; \
        border:         0px outset red;                     \
        z-index:        222;                                \
        padding:        5px 5px;                            \
    }                                                       \
" ); 
```

注意你如何混合`'`和`"`引用。

* * *

* * *

此外，由于您使用的是`GM_addStyle`，请添加[`// @grant GM_addStyle`](http://wiki.greasespot.net/@grant)到脚本的元数据块中，以便脚本继续与 Greasemonkey 和 Scriptish 的未来版本一起使用。

# django - Django FormWizard as_view() 方法 AttributeError

> ID：14693811
> 
> 赞同：1
> 
> 时间：2013-02-04T19:13:34.997
> 
> 标签：django, forms, session, wizard

我想合并一个 FormWizard 来处理长表格。经过研究，似乎[django-merlin](https://github.com/supercodepoet/django-merlin)是最好的选择，因为它通过会话管理表单向导。但是，尝试合并它（如[django 向导文档](https://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/)中所述）会导致`AttributeError: type object 'CreateWizard' has no attribute 'as_view'`.

这是它的样子：

```
from merlin.wizards.session import SessionWizard

class StepOneForm(forms.Form):
    year = forms.ChoiceField(choices=YEAR_CHOICES)
    ...

class StepTwoForm(forms.Form):
    main_image = forms.ImageField()
    ...

class StepThreeForm(forms.Form):
    condition = forms.ChoiceField(choices=CONDITION)
    ...

class CreateWizard(SessionWizard):
    def done(self, form_list, **kwargs):
        return HttpResponseRedirect(reverse('wizard-done')) 
```

网址：

```
url(r'^wizard/(?P<slug>[A-Za-z0-9_-]+)/$', CreateWizard.as_view([StepOneForm, StepTwoForm, StepThreeForm])), 
```

由于 merlin 文档有点稀疏，我选择使用`as_view()`原始 django 表单向导文档中描述的方法，但结果是`AttributeError`. 我应该如何在我的 urlconf 中加入 merlin 向导？谢谢你的想法！

* * *

这是我根据@mVChr 的回答更新后得到的错误和回溯，并定义如下步骤：

```
step_one = Step('step_one', StepOneForm()) 
```

错误和回溯：

```
TypeError at / issubclass() arg 1 must be a class

Traceback:
File /lib/python2.7/django/core/handlers/base.py" in get_response
  89\.                     response = middleware_method(request)
File "/lib/python2.7/django/utils/importlib.py" in import_module
  35\.     __import__(name)
File "/myproject/myproject/urls.py" in <module>
  7\. from myapp.forms import step_one, step_two, step_three, CreateWizard
File "/myproject/myapp/forms.py" in <module>
  16\. step_one = Step('step_one', StepOneForm())
File "/lib/python2.7/merlin/wizards/utils.py" in __init__
  36\.         if not issubclass(form, (forms.Form, forms.ModelForm,)):

Exception Type: TypeError at /
Exception Value: issubclass() arg 1 must be a class 
```

尽管我仍然遇到错误，但感谢@mVChr，我感觉更接近解决方案。非常感谢有关如何解决此错误的任何想法！感谢您的任何想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:53:43.367

注意：我不知道这是否可行，我只是想帮助 Nick B 用一个具体的例子翻译文档，让他更接近正确的解决方案。请让我知道这是否按原样工作，我将删除此评论。

从阅读[文档](http://packages.python.org/django-merlin/)看来，您需要将`Step`对象列表直接传递给您的`SessionWizard`子类实例化，如下所示：

```
from merlin.wizards.session import SessionWizard
from merlin.wizards.utils import Step

class StepOneForm(forms.Form):
    year = forms.ChoiceField(choices=YEAR_CHOICES)
    ...
step_one = Step('step-one', StepOneForm())

class StepTwoForm(forms.Form):
    main_image = forms.ImageField()
    ...
step_two = Step('step-two', StepTwoForm())

class StepThreeForm(forms.Form):
    condition = forms.ChoiceField(choices=CONDITION)
    ...
step_three = Step('step-three', StepThreeForm())

class CreateWizard(SessionWizard):
    def done(self, form_list, **kwargs):
        return HttpResponseRedirect(reverse('wizard-done')) 
```

然后在你的`urls.py`：

```
url(r'^wizard/(?P<slug>[A-Za-z0-9_-]+)/$',
    CreateWizard([step_one, step_two, step_three])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-18T08:29:35.010

想要引起您的注意，您在创建 Step 的对象时使用了错误的语法。这个

```
step_one = Step('step-one', StepOneForm()) 
```

应该像

```
step_one = Step('step-one', StepOneForm) 
```

您必须在所有步骤对象中更正它。

# angularjs - 如何以编程方式从服务器重新加载/刷新模型数据？

> ID：14693815
> 
> 赞同：63
> 
> 时间：2013-02-04T19:13:39.017
> 
> 标签：angularjs

# 背景

我有最基本的“新手”AngularJS 问题，请原谅我的无知：如何通过代码刷新模型？我确定它在某个地方被多次回答，但我根本找不到它。我在这里观看了一些很棒的视频[http://egghead.io](http://egghead.io)并快速浏览了教程，但我仍然觉得我错过了一些非常基本的东西。

[我在这里](http://docs.angularjs.org/api/ng.%24route#reload)找到了一个相关示例( `$route.reload()`) 但我不确定我是否理解如何在下面的示例中使用它

# 这是设置

## 控制器.js

```
function PersonListCtrl($scope, $http) {
  $http.get('/persons').success(function(data) {
    $scope.persons = data;
  });
} 
```

## 索引.html

```
...
<div>
    <ul ng-controller="PersonListCtrl">
        <li ng-repeat="person in persons">
            Name: {{person.name}}, Age {{person.age}}
        </li>
    </ul>
</div>
... 
```

这一切都非常好，每次重新加载页面时，我都会按预期看到人员列表

# 问题

1.  假设我想实现一个刷新按钮，我如何告诉模型以编程方式重新加载？
2.  如何访问模型？看来 Angular 正在神奇地实例化我的控制器的一个实例，但我该如何掌握它呢？
3.  **EDIT**添加了第三个问题，与 #1 相同，但如何仅通过 JavaScript 完成？

我确定我错过了一些基本的东西，但是在花了一个小时试图弄清楚之后，我认为它值得一个问题。请让我知道它是否重复，我将关闭 + 链接。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-02-04T19:22:54.787

你自己已经成功了一半。要实现刷新，您只需将已有的内容包装在范围内的函数中：

```
function PersonListCtrl($scope, $http) {
  $scope.loadData = function () {
     $http.get('/persons').success(function(data) {
       $scope.persons = data;
     });
  };

  //initial load
  $scope.loadData();
} 
```

然后在你的标记中

```
<div ng-controller="PersonListCtrl">
    <ul>
        <li ng-repeat="person in persons">
            Name: {{person.name}}, Age {{person.age}}
        </li>
    </ul>
   <button ng-click="loadData()">Refresh</button>
</div> 
```

至于“访问您的模型”，您需要做的就是访问控制器中的 $scope.persons 数组：

例如（只是 puedo 代码）在您的控制器中：

```
$scope.addPerson = function() {
     $scope.persons.push({ name: 'Test Monkey' });
}; 
```

然后你可以在你的视图中使用它或者你想做的任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-31T16:52:42.897

在我向您展示如何以编程方式从服务器重新加载/刷新模型数据之前？我必须为您解释**数据绑定**的概念。这是一个非常强大的概念，将真正彻底改变您的开发方式。因此，您可能必须从此[链接](https://docs.angularjs.org/guide/databinding)或第二个[链接](http://openclassrooms.com/courses/developpez-vos-applications-web-avec-angularjs/la-notion-de-data-binding)中阅读有关此概念的信息，以了解 AngularjS 的工作原理。

现在我将向您展示一个示例，说明如何从服务器更新您的模型。

HTML 代码：

```
<div ng-controller="PersonListCtrl">
    <ul>
        <li ng-repeat="person in persons">
            Name: {{person.name}}, Age {{person.age}}
        </li>
    </ul>
   <button ng-click="updateData()">Refresh Data</button>
</div> 
```

所以我们的控制器命名为：**PersonListCtrl**，我们的模型命名为：**persons**。转到您的 Controller js 以开发名为：的函数，当我们需要更新和刷新我们的模型**people**`updateData()`时将调用该函数。

 **Javascript代码：

```
app.controller('adsController', function($log,$scope,...){

.....

$scope.updateData = function(){
$http.get('/persons').success(function(data) {
       $scope.persons = data;// Update Model-- Line X
     });
}

}); 
```

现在我为您解释它是如何工作的：当用户单击按钮**Refresh Data**时，服务器将调用函数**updateData()**并且在此函数中，我们将通过该函数调用我们的 Web 服务`$http.get()`，当我们从 ws 获得结果时，我们将将它影响到我们的模型（第 X 行）。影响我们模型结果的骰子，我们对该列表的视图将使用新数据进行更改。**

# java - Java 字符串匹配表达式 String Array

> ID：14693821
> 
> 赞同：0
> 
> 时间：2013-02-04T19:14:06.297
> 
> 标签：java, string

我正在使用 Java，我需要您对如何为以下任务编写更好的代码提出意见。

我有以下字符串值

```
String testStr = "INCLUDES(ABC) EXCLUDES(ABC) EXCLUDES(ABC) INCLUDES(ABC) INCLUDES(ABC)" 
```

我想操作字符串并希望将所有 INCLUDES 语句组合成一个 INCLUDES，结果应该类似于以下内容：

```
INCLUDES(ABC,ABC, ABC) EXCLUDES(ABC, ABC) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:24:00.023

我会使用这个类将初始字符串分解为新字符串：http: [//docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html) 并将它们放在一个数组中

开始一个新字符串，然后使用标记器将括号内的部分拆分（您可以将其设置为使用 ( 和 ) 作为分隔符）并循环遍历数组并将它们连接到新字符串中。

请注意，任何错误放置的空格（如 INCLUDES(abc)）都会搞砸

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:25:41.990

这似乎是一种合理的方法：

1.  拆分`testStr`使用`StringUtils.split`方法；使用 " " 或 null 作为标记。
2.  创建一个`Map<String, List<String>>`. 我将其称为`theMap`
3.  对于返回数组中的每个字符串，执行以下操作：

    1.  使用“()”作为标记拆分字符串。
    2.  返回的数组应该有 2 个元素。第一个元素（索引 0）是键，`theMap`第二个元素（索引 1）是要添加到列表中的值。

完成从 split 返回的数组后`testStr`，通过使用键值 in`theMap`并将关联列表中的元素附加到字符串中来构建一个新字符串。

[Apache StringUtils](http://commons.apache.org/lang/api/org/apache/commons/lang3/StringUtils.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:47:44.903

我为这个问题写了一段代码，但我不知道它是否好用

*   根据您的格式，您可以使用**""拆分****testStr**，输出将如下所示：**INCLUDES(ABC)**

*****   检查此字符串是否包含**INCLUDES**或**EXCLUDES**

    *   然后使用**( )拆分它****** 

 ****像这样 ：

```
 String testStr = "INCLUDES(ABC) EXCLUDES(C) EXCLUDES(ABC) INCLUDES(AC) INCLUDES(AB)";
    String s[] = testStr.split(" ");
    String INCLUDES = "INCLUDES( ";
    String EXCLUDES = "EXCLUDES ( ";
    for (int i = 0; i < s.length; i++) {
        if (s[i].contains("INCLUDES")) {
            INCLUDES += (s[i].substring(s[i].indexOf("(") + 1, s[i].indexOf(")"))) + "  ";
        }

        else if (s[i].contains("EXCLUDES")) {
            EXCLUDES += (s[i].substring(s[i].indexOf("(") + 1, s[i].indexOf(")"))) + "  ";
        }
    }
    INCLUDES = INCLUDES + ")";
    EXCLUDES = EXCLUDES + ")";
    System.out.println(INCLUDES);
    System.out.println(EXCLUDES); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T15:04:49.077

我写下了如下的小实用程序结果

```
if text = "EXCLUDES(ABC) EXCLUDES(ABC) INCLUDES(BMG) INCLUDES(EFG) INCLUDES(IJK)";

output = EXCLUDES(ABC) EXCLUDES(ABC) INCLUDES(BMG & EFG & IJK) 
```

以下是我的java代码，请看一下，如果有人可以改进它，请随意。

```
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import com.sun.xml.internal.ws.util.StringUtils;

/**
 * Created by IntelliJ IDEA.
 * User: fkhan
 * Date: Aug 31, 2012
 * Time: 1:36:45 PM
 * To change this template use File | Settings | File Templates.
 */

public class TestClass {

    public static void main(String args[]) throws Exception {

        //String text = "INCLUDES(ABC) EXCLUDES(ABC) EXCLUDES(ABC) INCLUDES(EFG) INCLUDES(IJK)";
        String text = "EXCLUDES(ABC) EXCLUDES(ABC) INCLUDES(BMG) INCLUDES(EFG) INCLUDES(IJK)";
        List<String> matchedList = findMatchPhrase("INCLUDES", text);
        String query = combinePhrase(text, "INCLUDES", matchedList);
        System.out.println(query);

    }

    /**
     * This method takes query combine and & multiple phrases
     * @param expression
     * @param keyword
     * @param matchedItemList
     * @return
     */
    private static String combinePhrase(String expression, String keyword, List<String> matchedItemList) {

        //if only one phrase found return value
        if(matchedItemList.isEmpty() || matchedItemList.size() ==1){
            return expression;
        }

        //do not remove first match
        String matchedItem = null;
        for (int index = 1; index < matchedItemList.size(); index++) {

            matchedItem = matchedItemList.get(index);

            //remove match items from string other then first match
            expression = expression.replace(matchedItem, "");
        }

        StringBuffer textBuffer = new StringBuffer(expression);

        //combine other matched strings in first matched item
        StringBuffer combineStrBuf = new StringBuffer();
        if (matchedItemList.size() > 1) {

            for (int index = 1; index < matchedItemList.size(); index++) {
                String str = matchedItemList.get(index);
                combineStrBuf.append((parseValue(keyword, str)));
                combineStrBuf.append(" & ");

            }
            combineStrBuf.delete(combineStrBuf.lastIndexOf(" & "), combineStrBuf.length());
        }

        // Inject created phrase into first phrase
        //append in existing phrase
        return injectInPhrase(keyword, textBuffer, combineStrBuf.toString());
    }

    /**
     *
     * @param keyword
     * @param textBuffer
     * @param injectStr
     */
    private static String injectInPhrase(String keyword, StringBuffer textBuffer, String injectStr) {
        Matcher matcher = getMatcher(textBuffer.toString());
        while (matcher.find()) {

            String subStr = matcher.group();
            if (subStr.startsWith(keyword)) {
                textBuffer.insert(matcher.end()-1, " & ".concat(injectStr));
                break;
            }

        }

       return textBuffer.toString();
    }

    /**
     * @param expression
     * @param keyword
     * @return
     */
    private static String parseValue(String keyword, String expression) {

        String parsStr = "";
        if (expression.indexOf(keyword) > -1) {
            parsStr = expression.replace(keyword, "").replace("(", "").replace(")", "");
        }

        return parsStr;
    }

    /**
     * This method creates matcher object
     * and return for further processing
     * @param expression
     * @return
     */
    private static Matcher getMatcher(String expression){
        String patternString = "(\\w+)\\((.*?)\\)";
        Pattern pattern = Pattern.compile(patternString);
        return pattern.matcher(expression);
    }
    /**
     * This method find find matched items by keyword
     * and return as list
     * @param keyword
     * @param expression
     * @return
     */
    private static List<String> findMatchPhrase(String keyword, String expression) {
        List<String> matchList = new ArrayList<String>(3);

        keyword = StringUtils.capitalize(keyword);
        Matcher matcher = getMatcher(expression);

        while (matcher.find()) {

            String subStr = matcher.group();
            if (subStr.startsWith(keyword)) {
                matchList.add(subStr);
            }
        }

        return matchList;
    }

} 
```****

# php - 我应该在模型中使用“加入”还是调用其他模型

> ID：14693822
> 
> 赞同：1
> 
> 时间：2013-02-04T19:14:06.177
> 
> 标签：php, join, domain-object

我正在学习 OOPHP，我正在寻找一些“最佳实践”的建议。

对于关系数据库，许多表中显然存在外键。当我为我的站点创建模型时，我试图确定在模型中进行 JOIN 查询是否更好，或者让一个模型调用另一个模型？

调用其他模型似乎使代码更加模块化。无论是在另一个表上还是在另一个模型上，这两种方式似乎都会产生依赖关系。

如果我采用“调用其他模型”的方法，我似乎遇到了另一个问题：无限循环。这是我遇到的例子。我有 2 张桌子，`person`并且`school`. 每个`person`人都有一个最喜欢的学校，用 . 表示`schoolId`。每个`school`都有一个`principal`，那就是一个`personId`。

`person`行映射到的对象在其构造函数中接受对象`school`，但`school`学校行映射到的`person`对象在其构造函数中接受对象。

根据我的发现，延迟加载似乎是解决方案，但是（我可能是错的）如果我这样做，我似乎不能使用 PHP 的类型提示。

（我猜很多人会向我推荐像 Doctrine 这样的 ORM 工具，这是我将来肯定会研究的东西。我现在正在避免它，因为它被认为是陡峭的学习曲线，而且因为我觉得我更了解这些工具以后如果我自己尝试一次）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:23:28.113

好问题！我有/有同样的想法。而且我认为在查看框架之前开始自己编写代码是一个非常好的主意:)

当我编写模型生成器时，我曾决定不使用 JOINS 并使用“延迟加载”。意思是我有这样的类（只是伪代码）：

```
class Person extends Model_Resource {

    /**
     *
     */
    protected $name;

    /**
     * @var Address <-- external reference
     */
    protected $address;

    /**
     * @return Person
     */
    public static function select($filter) {
        return DB::instance(filter_query('SELECT * FROM `person`', $filter));
    }

    /**
     * @return Address
     */
    public function getAddress() {
        // lazy loading :
        if(is_null($this->address)) {
            $this->address = Address::select(new Filter('p_id', $this->id));
        }
        return $this->address;
    }

} 
```

多年来，这对我来说在中等规模的应用程序中效果很好。当我真的需要加快速度或使用有点不规则的查询时，我可以自由地覆盖自动生成的方法并使用 JOINS、UNION 等......

我很好奇别人会怎么说。

# android - 如何从谷歌地图应用程序获取用户当前的 GPS 位置？

> ID：14693823
> 
> 赞同：2
> 
> 时间：2013-02-04T19:14:09.537
> 
> 标签：android, google-maps, android-maps, google-maps-mobile

经过长时间的尝试......我在获取用户当前的 GPS 位置修复方面面临[问题。](https://stackoverflow.com/questions/14692202/unable-to-get-current-gps-location-co-ordinates)

所以，我想如果我们能以某种方式使用预装的谷歌地图应用程序的修复程序以编程方式获得位置修复`Current Location`？

如果我能够在后台获取位置坐标……这可能吗？
那么，是否有可能通过使用意图或广播接收器以某种方式获取当前位置坐标？（假设地图应用正在广播它......？）

**更新#2：**终于..我让它工作了..

**更新：**我的早期代码在[这里](http://pastebin.com/Wm6h9VFV)（PasteBin 链接）

欢迎任何建议.. 谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:44:23.370

好的密码破解器，这是我实现位置提取器的方式：

```
// the listener to listen to the locations
private LocationListener listener = null;
// a location manager
private LocationManager lm  = null;
// locations instances to GPS and NETWORk
private Location myLocationGPS, myLocationNetwork;

// instantiates fields
lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
myLocationNetwork = lm.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
myLocationGPS = lm.getLastKnownLocation(LocationManager.GPS_PROVIDER);
listener = new myLocationListener();

// the listener that gonna notify the activity about location changes
public class myLocationListener implements LocationListener {
    @Override
    public void onLocationChanged(Location location) {
        // "location" is the RECEIVED locations and its here that you should proccess it

        // check if the incoming position has been received from GPS or network
        if (lm.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
            lm.removeUpdates(this);
        } else {
            lm.removeUpdates(listener);
        }
    }
    @Override
    public void onProviderDisabled(String provider) {
        lm.removeUpdates(this);
        lm.removeUpdates(listener);         
    }
    @Override
    public void onProviderEnabled(String provider) {
    }
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
} 
```

正如你所看到的，没有那么多棘手的问题。在您实例化侦听器时，您应该会在 Android 设备的顶部看到 GPS 图标。此外，每当您的位置发生变化时（即当您带着设备走路时），都会调用 OnLocationChanged 方法。

此外，有趣的是，如果您只想获取位置，有几种方法可以做到，所有这些方法都具有不同的返回速度和不同的精度。请同时检查 GoogleGLM（对[http://www.google.com/glm/mmap](http://www.google.com/glm/mmap)的请求，返回带有您的位置的 json 编码字符串）服务、三角测量和网络位置。在上面的片段中，我展示了如何通过 GPS 和网络获取位置。希望对您有所帮助... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:27:31.090

您可以使用被动位置提供程序，但这并不明确意味着它将从 GoogleMaps 获取位置。此外，GoogleMaps 应该正在运行以便接收更新。要从 GoogleMaps 接收位置更新，您还必须具有 ACCES_FINE_LOCATION 权限。此外，您无法启动 GoogleMaps 并强制它在没有用户交互的情况下更新位置。如果您需要精确的用户位置，除了使用 GPS_PROVIDER 之外别无他法。

[http://developer.android.com/reference/android/location/LocationManager.html#PASSIVE_PROVIDER](http://developer.android.com/reference/android/location/LocationManager.html#PASSIVE_PROVIDER)

您也可能想阅读 [http://developer.android.com/guide/topics/location/strategies.html](http://developer.android.com/guide/topics/location/strategies.html) [http://developerlife.com/tutorials/?p=1375](http://developerlife.com/tutorials/?p=1375)

# jsp - jstl循环不显示包含对象的数组列表的输出

> ID：14693830
> 
> 赞同：0
> 
> 时间：2013-02-04T19:14:23.687
> 
> 标签：jsp, foreach, jstl

这是我的程序，用于从 servlet 获取包含 bean-object 的 ArrayList 并使用 jstl tag 在 jsp 中显示其内容。我运行程序后没有显示结果。请查看我的代码并帮助我找到错误。我是jstl的新手。

## 小服务程序代码

```
package com.servlet;

import java.io.IOException;
import java.util.ArrayList;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.servlet.mybean;
@WebServlet("/Bean")
public class Bean extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public Bean() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        mybean mybean_obj = new mybean();
        ArrayList<mybean> obj=new ArrayList<mybean>();

        mybean_obj.id=100;
        mybean_obj.name="vishal";
        mybean_obj.roll=1225;

        mybean mybean_obj1 = new mybean();

        mybean_obj1.id=101;
        mybean_obj1.name="anand";
        mybean_obj1.roll=1226;

        mybean mybean_obj2 = new mybean();

        mybean_obj2.id=102;
        mybean_obj2.name="google";
        mybean_obj2.roll=1557;

        mybean mybean_obj3 = new mybean();

        mybean_obj3.id=103;
        mybean_obj3.name="yahoo";
        mybean_obj3.roll=1558;

        obj.add(mybean_obj);
        obj.add(mybean_obj1);
        obj.add(mybean_obj2);
        obj.add(mybean_obj3);
        HttpSession session = request.getSession();
        session.setAttribute("mybean", obj);
        request.setAttribute("mybean", obj);
        RequestDispatcher fwd = request.getRequestDispatcher("encodeUrl.jsp");
        fwd.forward(request, response);

    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
    }

} 
```

## jsp页面

```
 <%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
        <%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Encode URL </title>
</head>
<body>
 <c:forEach var="start" items="${sessionScope.mybean}">
      ${sessionScope.start.id}<br/>${sessionScope.start.roll }<br/>${sessiontScope.start.name }<hr/>
  </c:forEach>
</body>
</html> 
```

我从主页调用 servlet，从 servlet 请求被转发到上面代码的最终 jsp 页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:37:31.683

像这样重写你的代码：

```
<c:forEach var="start" items="${sessionScope.mybean}">
      ${start.id}<br/>${start.roll }<br/>${start.name }<hr/>
  </c:forEach> 
```

var="start" 创建一个名为**start**的局部变量，表示当前项。您可以在 forEach 语句中使用它。（不需要在它前面加上 sessionScope，因为没有基于 sessionScope 的 bean 称为 start）

您的代码的其他一些提示：

```
MyBean bean = new MyBean(); // classes start with an uppercase and use CamelCasing.
List<mybean> beans=new ArrayList<MyBean>(); // program against the list interface.
bean.setId(100); // use accessor methods instead of accessing variables directly. 
```

# jsf - PrimeFaces commandButton & UIBlock

> ID：14693832
> 
> 赞同：0
> 
> 时间：2013-02-04T19:14:28.007
> 
> 标签：jsf, primefaces, commandbutton

我在注册表单中有以下代码。基本上，按钮调用一个动作（一个 Ejb 方法和一个作为实用方法的动作侦听器）。当用户提交注册表时，应该会出现一个 primefaces 对话框，告诉用户正在处理注册。提交表单后，相同的对话框就会消失。这可以通过**Primefaces UIBlock**来实现；但是，它要求 commandButton 启用 ajax。

我考虑过使用：onstart = 显示一些模式对话框和 onsuccess 或 on complete = 隐藏此对话框（`<p:dialog widgetVar="dialog" ...`），但此解决方案需要为 primefaces commandButton 启用 ajax。

关于如何在 PrimeFaces commandButton 中将 ajax 设置为 false 时如何实现这一点的任何线索？

谢谢

```
<h:form id="form_register">
            <p:panel id="panel_register">
<div align="center" style="padding: 5px;">
                    <p:commandButton id="register" ajax="true"
                        actionListener="#{mailBean.deliverEmail(newMember.email,newMember.name, newMember.username, newMember.password, newMember.isadmin)}"
                        action="#{memberController.register}" value="Register"
                        label="Register">
                        <f:setPropertyActionListener target="#{requestScope.wait}"
                            value="#{true}" />
                    </p:commandButton>
                </div>

<p:blockUI block="panel_register" trigger="register">
                    <h:outputText value="Please wait..." />
                    <br />
                    <p:graphicImage value="#{resource['gfx/gif.gif']}" />
                </p:blockUI> 
```

**编辑：谢谢大家。我误用了命令按钮中的更新属性。现在一切正常。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:18:32.720

您应该使用 onstart 和 oncomplete 操作来显示/隐藏对话框。

```
<p:commandButton id="register" onstart="dlg.show()" oncomplete="dlg.hide()" /> 
```

# python - Python 机械化防止连接：关闭

> ID：14693836
> 
> 赞同：1
> 
> 时间：2013-02-04T19:14:39.560
> 
> 标签：python, mechanize

我正在尝试使用 mechanize 从网页获取信息。它基本上成功地获取了第一条信息，但是网页包含一个“下一步”按钮以获取更多信息。我不知道如何以编程方式获取附加信息。

通过使用 Live HTTP Headers，我可以看到在浏览器中单击下一步按钮时生成的 http 请求。似乎我可以使用 mechanize 发出相同的请求，但在后一种情况下，我没有获得下一页，而是被重定向到网站的主页。

显然，mechanize 所做的事情与我的浏览器不同，但我不知道是什么。在比较标题时，我确实发现了一个区别，那就是使用的浏览器

连接：保持活动

使用机械化时

连接：关闭

我不知道这是否是罪魁祸首，但是当我尝试添加标题（'Connection'，'keep-alive'）时，它没有改变任何东西。

[更新]当我在 Firefox 中单击“第 2 页”按钮时，生成的 http 是（根据 Live HTTP Headers）：

```
GET /statistics/movies/ww_load/the-fast-and-the-furious-6-2012?authenticity_token=ItU38334Qxh%2FRUW%2BhKoWk2qsPLwYKDfiNRoSuifo4ns%3D&facebook_fans_page=2&tbl=facebook_fans&authenticity_token=ItU38334Qxh%2FRUW%2BhKoWk2qsPLwYKDfiNRoSuifo4ns%3D HTTP/1.1
Host: www.boxoffice.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0
Accept: text/javascript, text/html, application/xml, text/xml, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
X-Prototype-Version: 1.6.0.3
Referer: http://www.boxoffice.com/statistics/movies/the-fast-and-the-furious-6-2012
Cookie: __utma=179025207.1680379428.1359475480.1360001752.1360005948.13; __utmz=179025207.1359475480.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __qca=P0-668235205-1359475480409; zip=13421; country_code=US; _boxoffice_session=2202c6a47fc5eb92cd0ba57ef6fbd2c8; __utmc=179025207; user_credentials=d3adbc6ecf16c038fcbff11779ad16f528db8ebd470befeba69c38b8a107c38e9003c7977e32c28bfe3955909ddbf4034b9cc396dac4615a719eb47f49cc9eac%3A%3A15212; __utmb=179025207.2.10.1360005948
Connection: keep-alive 
```

当我尝试在 mechanize 中请求相同的 url 时，它看起来像这样：

```
GET /statistics/movies/ww_load/the-fast-and-the-furious-6-2012?facebook_fans_page=2&tbl=facebook_fans&authenticity_token=ZYcZzBHD3JPlupj%2F%2FYf4dQ42Kx9ZBW1gDCBuJ0xX8X4%3D HTTP/1.1
Accept-Encoding: identity
Host: www.boxoffice.com
Accept: text/javascript, text/html, application/xml, text/xml, */*
Keep-Alive: 115
Connection: close
Cookie: _boxoffice_session=ced53a0ca10caa9757fd56cd89f9983e; country_code=US; zip=13421; user_credentials=d3adbc6ecf16c038fcbff11779ad16f528db8ebd470befeba69c38b8a107c38e9003c7977e32c28bfe3955909ddbf4034b9cc396dac4615a719eb47f49cc9eac%3A%3A15212
Referer: http://www.boxoffice.com/statistics/movies/the-fast-and-the-furious-6-2012
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1 
```

——达里尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:03:23.160

服务器正在检查`X-Requested-With`和/或`X-Prototype-Version`，因此将这两个标头添加到机械化请求中修复了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-05T12:51:52.387

答案可能有点晚了，但我通过在 _urllib2_forked.py 中添加一行来解决这个问题

在第 1098 行有一行：`headers["Connection"] = "Close"`

将其更改为：

`if not 'Connection' in headers: headers["Connection"] = "Close"` 并确保您在脚本中设置了标题，它会起作用。

格。挥霍

# html - 用于 unicode 的元字符集

> ID：14693838
> 
> 赞同：0
> 
> 时间：2013-02-04T19:14:56.560
> 
> 标签：html, unicode, utf-8

我正在使用 Jekyll，它对 UTF-8 文件有[**一些问题**](http://github.com/mojombo/jekyll/issues/188)。我可以通过将文件保存为 Unicode (UTF-16 LE) 来解决这个问题。

然而它是一个 HTML 文档，直到现在我一直在使用

```
<meta charset="utf-8"> 
```

文件中的行。这个字符集仍然正确还是我应该使用另一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T01:27:11.990

我 从万维网联盟找到了一些[**信息。**](http://w3.org/International/questions/qa-html-encoding-declarations)

```
HTML5 with UTF-16
Ensure that there is a byte-order mark 
at the beginning of the file. 

The HTML Working Group is currently discussing whether 
you can use a meta element declaration in the head 
element when the encoding is UTF-16\. For now, don't. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T20:09:16.773

如果将文件保存为 UTF-16 LE，则必须更新`<meta>`标签以匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T20:30:41.510

引用的文档涉及“不正确的 UTF-8 字符”，无论这意味着什么。只是不要使用不正确的 UTF-8 字符。

将 HTML 文件保存为 UTF-16 通常是没有意义的，因为 UTF-16 在 Web 上不起作用。当然，`meta`标签应该描述真正的编码，但这不是重点，HTTP 标头中的字符集声明将覆盖任何`meta`标签。

所以继续使用 UTF-8，并用你的字符数据来解决问题，而不是创建一个新的、严重的问题。

# visual-studio-2010 - DTE.Solution.SolutionBuild.Build 在 VS 2010 中不再工作

> ID：14693842
> 
> 赞同：1
> 
> 时间：2013-02-04T19:15:02.937
> 
> 标签：visual-studio-2010, envdte, visual-studio-macros

我有一个多年来一直使用的 VS 宏来自动构建我的项目。我目前正在试用 VS 2010，看看我是否喜欢它（我的常规版本是 2005 年），并且宏的一部分在 2010 年不起作用。好吧，相反，它会在给定的一天工作一次，然后每个在那之后我运行它时，它失败了。这是代码：

```
 With DTE.Solution
            'Set the Build to "Release"
            .SolutionBuild.SolutionConfigurations.Item("Release").Activate()
            'Build solution
            .SolutionBuild.Build(True)
            'Set Build back to Debug
            .SolutionBuild.SolutionConfigurations.Item("Debug").Activate()
        End With 
```

失败的行是“.SolutionBuild.Build(True)”。它根本不构建解决方案。没有错误。没有迹象表明有什么问题。代码将运行，但实际上并没有执行构建。

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T05:55:07.627

我的经验是它确实可以构建..如果需要。

尝试清洁...如果您想每次都重建。

DTE.Solution().SolutionBuild().Clean(True)

# c# - 为什么托管模块比 C# 中的非托管模块快

> ID：14693845
> 
> 赞同：1
> 
> 时间：2013-02-04T19:15:35.213
> 
> 标签：c#, performance, compiler-construction, il

我在本书作者中读了一本书（CLR via c#），谈到了 IL 和托管模块，托管模块在本机 cpu 代码中编译，然后在本书作者中执行说托管模块比非托管模块快。我的问题是为什么托管模块比非托管模块更快，但在托管模块中首先编译为 IL，然后在本机 cpu 中编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:30:14.463

（我下面写的不是我的，是从一本书上复制粘贴的[`CLR via C#, Page No 14`](https://rads.stackoverflow.com/amzn/click/com/0735627045)：）

* * *

### 托管代码的性能优于非托管代码的原因有很多

> 当 JIT 编译器在运行时将 IL 代码编译为本机机器代码时，编译器对执行环境的了解比非托管编译器要多。

托管代码可以胜过非托管代码的一些方法

*   JIT 编译器可以确定应用程序是否在 Intel Pentium 4 CPU 上运行，并生成利用 CPU 提供的任何特殊指令的本机代码。通常，非托管应用程序针对 CPU 的最小公分母进行编译，并避免使用会提高应用程序性能的特殊指令。
*   JIT 编译器可以确定某个测试在运行它的机器上何时总是失败。考虑这个例子

    ```
    if (num_of_cpu > 1)
    {        
    } 
    ```

如果机器只有一个 CPU，此代码会导致 JIT 不生成任何 CPU 指令。

*   CLR 可以分析代码的执行情况，并在应用程序运行时将 IL 重新编译为本机代码。根据观察到的执行模式，将重新组织重新编译的代码以减少不正确的分支预测。当前版本的 C# 不这样做，但未来版本可能会。

# wpf - 如何显示 WPF 绑定集合中的前 3 个项目？

> ID：14693846
> 
> 赞同：1
> 
> 时间：2013-02-04T19:15:37.617
> 
> 标签：wpf

我正在创建一个显示数据摘要的控件。在此页面上，我将控件绑定到包含许多项目的 ObservableColection。我创建了一个按时间对项目进行排序的 CollectionView，但在这个控件中我只想显示前 3 个项目。我尝试创建一个转换器来完成此操作，但我尝试过滤列表的所有方式都返回一个“新”列表，并且当将新项目添加到主 ObservableCollection 时，控件不再更新。

有没有一种干净的方法可以做到这一点？我将不得不为我的几个系列做类似的事情，所以我想做一些通用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T20:17:45.597

如果您使用的是 ViewModel 模式，那么***干净的方法***是使用另一个包含前 N 个项目的 ObservableCollection。这样绑定是直接的，您只需更改模型即可将 3 更改为您想要的任何 N。

```
public class MyViewModel
{
    private ObservableCollection<string> myList;

    public ObservableCollection<string> MyList 
    { 
        get { return myList; }
        set { return myList; }
    }

    public Collection<string> MyListTop3 
    {
        get { return new Collection<string>(MyList.Take(3).ToList()); }
    }

    public MyViewModel() 
    {
        myList = new ObservableCollection<string>();

        myList.CollectionChanged += (sender, args) =>
        { 
            RaisePropertyChanged("MyListTop3");
        }; 
    } 
} 
```

如果您只想通过 XAML 来处理它（**不是*cleaneast 方式***）：

```
<ListBox>

    <ListBox.Resources>
        <ContentPresenter x:Key="value0" Content="{Binding MyList[0]}"/>
        <ContentPresenter x:Key="value1" Content="{Binding MyList[1]}"/>
        <ContentPresenter x:Key="value2" Content="{Binding MyList[2]}"/>
    </ListBox.Resources>

    <ListBoxItem Content="{DynamicResource value0}"/>
    <ListBoxItem Content="{DynamicResource value1}"/>
    <ListBoxItem Content="{DynamicResource value2}"/>

</ListBox> 
```

此示例显示了一个*ListBox*，但您可以在任何其他控件上使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T20:19:26.500

您可以使用 CollectionView 的内置过滤来执行此操作。在 Filter 谓词中，您可以使用原始集合并按照与视图排序和检查索引相同的方式对其进行排序。

```
FilteredList = new ObservableCollection<string> { "One", "Two", "Three", "Four", "Five" };

_defaultView = CollectionViewSource.GetDefaultView(FilteredList);
_defaultView.SortDescriptions.Add(new System.ComponentModel.SortDescription(".", System.ComponentModel.ListSortDirection.Ascending));
_defaultView.Filter = o =>
{
    int index = FilteredList.OrderBy(s => s).ToList().IndexOf(o as string);
    return index >= 0 && index < 3;
}; 
```

您还需要确保在添加项目时刷新视图 - 通过将其包含在执行添加的代码中或在 CollectionChanged 事件的处理程序中。

```
FilteredList.Add(newItem);
_defaultView.Refresh(); 
```

# html - CSS保护文本与图像的重叠

> ID：14693849
> 
> 赞同：0
> 
> 时间：2013-02-04T19:15:44.353
> 
> 标签：html, css

我创建了一个带有一些文本的图像，如图所示。

```
<span class="productname ">Excusite Beauty</span>
<img src="xy.jpg" data-attr="productimg" class="productimg " /> 
```

我的CSS是

```
.productimg
{
float:right;
margin-top:15px;
height:120px;
margin-right:2%;
border:2px double  #0ff;
width:150px;
right:0px;
position:absolute;
}
.productname
{
font-size:1.2em;
display:block;
float:left;
} 
```

![在此处输入图像描述](../Images/e649454f91493b7d099cf22abfe703f0.png)

如果文本很长，我如何保护文本的重叠并将文本放在下一行。如何使用 css...请帮助

![在此处输入图像描述](../Images/0d784c71985ebec4671c9fa8316e9078.png) 删除位置和右=0后

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:17:49.740

您绝对是在定位产品形象。这会使其脱离文档的正常“流程”，并会导致这种重叠。

Remove `position: absolute`from `.productimg`(you can go ahead and remove `right:0px;`as well)，文本应该正确环绕图像。要允许文本在图像周围浮动，您可以将其移动到之前`.productname`或浮动`.productname`并给它一个宽度。

**[密码笔](http://codepen.io/NickTomlin/pen/KtFDs)**

**HTML**

```
<div class="product">
  <img src="xy.jpg" data-attr="productimg" class="productimg " />
  <span class="productname ">Excusite Beauty</span>
</div> 
```

**CSS**

```
.productimg {
  float:right;
  /* margin-top:15px; */
  height:120px;
  border:2px double  #0ff;
  width:150px;
}
.productname {
  font-size:1.2em;
  display:block;
   width:150px
}
.product {
  width:300px;
} 
```

# apache - 如何在弹性豆茎上强制 https？

> ID：14693852
> 
> 赞同：88
> 
> 时间：2013-02-04T19:15:50.080
> 
> 标签：apache, mod-rewrite, https, amazon-web-services, amazon-elastic-beanstalk

我似乎无法在弹性豆茎的免费使用层上强制使用 https。

我在[如何在亚马逊弹性豆茎上强制 https 而不通过健康检查时尝试了以下建议](https://stackoverflow.com/questions/6858492/how-to-force-https-on-amazon-elastic-beanstalk-without-failing-the-health-check)

使用这个 Apache 重写规则

```
RewriteEngine On
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteCond %{REQUEST_URI} !^/status$ 
RewriteCond %{REQUEST_URI} !^/version$ 
RewriteCond %{REQUEST_URI} !^/_hostmanager/ 
RewriteRule . https://%{SERVER_NAME}%{REQUEST_URI} [L,R] 
```

当我尝试这样做时，http 请求不会按照我的意愿重定向到 https。相反，http 页面正常加载。我也尝试使用 X-Forwarded-Port 标头，结果相同。

我也尝试过以下重写规则

```
RewriteCond %{SERVER_PORT} 80
RewriteRule . https://%{SERVER_NAME}%{REQUEST_URI} [L,R] 
```

此规则会导致重定向循环。因此，似乎 apache 重写规则不会选择 Elastic Load Balancer 标头 X-Forwarded-Port 和 X-Forwarded-Proto，但重定向循环也不是我想要的。

请帮忙。我是 AWS、Elastic Beanstalk 的新手，对 Apache 规则不是很熟悉。我不太确定从这里去哪里。谢谢。

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2016-08-03T19:05:13.740

此答案假定您已在负载均衡器安全组中启用 https，将 SSL 证书添加到负载均衡器，负载均衡器转发端口 80 和 443，并将您的域名指向具有 Route 53 的 Elastic Beanstalk 环境（或等效的 DNS 服务）。

# 选项 1：使用 Apache 进行重定向

仅当您位于使用 Apache 的 Elastic Beanstalk 环境中时，这才有可能（可以将基于 AWS Linux 2 的部署配置为使用 Apache）。它可能不适用于基于 docker 的部署。

## 亚马逊 Linux 2

大多数基于 AWS Linux 版本 2 的平台都可以选择 Apache 作为您的代理主机。这可以通过转到“配置”>“软件”>“容器选项”并将“代理服务器”设置为“Apache”来完成，或者将以下内容添加到您的`.config`文件之一`.ebextensions`：

```
option_settings:
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: apache 
```

完成后，添加一个名为`.platform/httpd/conf.d/ssl_rewrite.conf`您的代码库（[相关 AWS 文档](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/platforms-linux-extend.html)）的配置文件，其中包含以下内容：

```
RewriteEngine On
<If "-n '%{HTTP:X-Forwarded-Proto}' && %{HTTP:X-Forwarded-Proto} != 'https'">
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
</If> 
```

## 亚马逊 Linux 1

您需要做的就是将以下内容添加到[项目目录中的一个](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/ebextensions.html)[`.config`文件中`.ebextensions`](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/ebextensions.html)：

```
files:
    "/etc/httpd/conf.d/ssl_rewrite.conf":
        mode: "000644"
        owner: root
        group: root
        content: |
            RewriteEngine On
            <If "-n '%{HTTP:X-Forwarded-Proto}' && %{HTTP:X-Forwarded-Proto} != 'https'">
            RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
            </If> 
```

## 解释

这在 Elastic Beanstalk 之外是相当直接的。通常会添加一个 Apache 重写规则，如下所示：

```
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

或者，如果在负载均衡器后面，就像我们在这种情况下一样：

```
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

但是，这些配置仅在一个`<VirtualHost>`块内起作用。将 更改`RewriteCond`为`<If>`块允许它在块之外正常工作`<VirtualHost>`，允许我们放入独立的 Apache 配置文件中。请注意，CentOS 上的标准 Apache 设置（包括 ElasticBeanstalk 上的设置）包含所有`/etc/httpd/conf.d/*.conf`匹配的文件，它与我们存储此文件的文件路径匹配。

如果您不在负载均衡器后面，则条件的`-n '%{HTTP:X-Forwarded-Proto}'`一部分会阻止它重定向，从而允许您在具有负载均衡器和 https 的生产环境与单实例且没有 https 的暂存环境之间共享配置。如果您在所有环境中都使用负载均衡器和 https，则这不是必需的，但拥有它并没有什么坏处。

# 选项 2：使用 ALB 进行重定向

这仅在您使用 Application Load Balancer 时才有可能。亚马逊在此处提供了有关如何执行此操作的说明：[https ://docs.aws.amazon.com/elasticbeanstalk/latest/dg/configuring-https-httpredirect.html](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/configuring-https-httpredirect.html)

您需要做的就是将以下内容添加到[项目目录中的一个](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/ebextensions.html)[`.config`文件中，`.ebextensions`](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/ebextensions.html)以将 http 侦听器替换为重定向：

```
Resources:
 AWSEBV2LoadBalancerListener:
  Type: AWS::ElasticLoadBalancingV2::Listener
  Properties:
    LoadBalancerArn:
      Ref: AWSEBV2LoadBalancer
    Port: 80
    Protocol: HTTP
    DefaultActions:
      - Type: redirect
        RedirectConfig:
          Host: "#{host}"
          Path: "/#{path}"
          Port: "443"
          Protocol: "HTTPS"
          Query: "#{query}"
          StatusCode: "HTTP_301" 
```

# 我见过的糟糕的解决方案

我已经看到了很多关于这个问题的糟糕解决方案，值得通过它们来理解为什么这个解决方案是必要的。

1.  **使用 Cloudfront：** 有人建议在 Elastic Beanstalk 前面使用非缓存 Cloudfront 设置来执行 HTTP 到 HTTPS 的重定向。这增加了一个不完全合适的全新服务（从而增加了复杂性）（Cloudfront 是一个 CDN；它不是在固有动态内容上强制使用 HTTPS 的正确工具）。Apache config 是这个问题的常规解决方案，而 Elastic Beanstalk 使用 Apache，所以我们应该这样做。

2.  **SSH 进入服务器并...：**这与 Elastic Beanstalk 的观点完全相反，并且存在很多问题。通过自动缩放创建的任何新实例都不会具有修改后的配置。任何克隆的环境都没有配置。任何数量的合理环境更改都将清除配置。这真是个坏主意。

3.  **使用新文件覆盖 Apache 配置：**这进入了正确的解决方案领域，但如果 Elastic Beanstalk 更改了服务器设置的各个方面（他们很可能会这样做），那么您将面临维护噩梦。另请参阅下一项中的问题。

4.  **动态编辑 Apache 配置文件以添加几行：**这是一个不错的主意。这样做的问题是，如果 Elastic Beanstalk 更改其默认 Apache 配置文件的名称，它将无法正常工作，并且该文件可能会在您最不期望的时候被覆盖：[https ://forums.aws.amazon.com/thread .jspa?threadID=163369](https://forums.aws.amazon.com/thread.jspa?threadID=163369)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-03-20T16:54:24.030

> **编辑：虽然我喜欢这个答案，但它现在已经*很老*了。**AWS 提出了新的服务（如[Certificate Manager](https://aws.amazon.com/certificate-manager)），使该答案的一部分过时了。此外，将`.ebextensions`文件夹与 Apache 一起使用是一种更简洁的方式来处理上述重定向。

如果您在 S3 上托管您的网站，则此答案的部分内容可能对您仍然有用。

* * *

这对我有用：

1.  [`aws`](http://aws.amazon.com/cli)使用控制台命令将证书上传到 AWS 。命令结构如下：

    ```
    aws iam upload-server-certificate --server-certificate-name CERTIFICATE_NAME --certificate-body "file://PATH_TO_CERTIFICATE.crt" --private-key "file://YOUR_PRIVATE_KEY.pem" --certificate-chain "file://YOUR_CERTIFICATE_CHAIN.ca-bundle" --path /cloudfront/ 
    ```

2.  在您的 Elastic Beanstalk 应用程序中，转到**配置**->**网络层**->**负载平衡**，然后单击**齿轮图标**。

3.  选择**Secure listener port**作为**443**。选择**协议**作为**HTTPS**。`CERTIFICATE_NAME`从**步骤 2**中选择SSL**证书 ID**。保存配置。

4.  转到您的**控制台**。单击**EC2 实例**。单击**负载均衡器**。单击负载均衡器。单击**实例**并向下滚动以查看分配给该负载均衡器的 EC2 实例。如果 EC2 实例与您的应用程序 URL 具有相同的名称（或类似名称），请记下负载均衡器的**DNS 名称**。它应该是格式`awseb-e-...`

5.  返回到您的**控制台**。单击**CloudFront**。单击**创建分配**。选择一个**Web**分发。

6.  设置分布。将您的**Origin Domain Name**设置为您在**步骤 5**中找到的负载均衡器 DNS 名称。将**查看器协议策略**设置为**将 HTTP 重定向到 HTTPS**。将**转发查询字符串**设置为**Yes**。将**备用域名 (CNAME)**设置为您要用于应用程序的 URL。将**SSL 证书**设置为您在**步骤 2**`CERTIFICATE_NAME`中上传的证书。创建您的发行版。

***   在 CloudFront 中单击您的分配名称。单击**Origins**，选择您的来源，然后单击**Edit**。确保您的**Origin Protocol Policy**是**Match Viewer**。回去。单击**Behaviors**，选择您的来源，然后单击**Edit**。**将Forward Headers**更改为**Whitelist**并添加**Host**。节省。** 

 ****注意：** [我也写了一个更长的指南](https://stackoverflow.com/questions/19967788/laravel-redirect-all-requests-to-https/29171680#29171680)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-07-02T18:56:54.327

使用新的应用程序负载均衡器，您现在可以相当简单地做到这一点......

确保在设置 EB 环境时设置其中之一（我相信仍然默认为经典负载均衡器）。创建环境后，您无法更改类型，因此请重新创建它

完成后，转到您的 EC2 设置 -> 负载均衡器。单击您为 EB 环境创建的负载均衡器。您必须确保在执行此任务之前已设置 HTTPS 侦听器，因此请确保您使用 SSL 证书侦听 HTTPS 443，并使用 80 上的 HTTP 将流量转发到您的实例。

然后添加一个侦听 HTTP 的新侦听器并添加默认操作“重定向到：”。确保将 HTTPS 设置为协议，将 443 设置为端口，将“原始主机、路径、查询”设置为选项，最后将 301 设置为 HTTP 响应代码。

添加此侦听器后，请确保您更新 EC2 负载均衡器安全组以接受 HTTPS 和 HTTP 连接，您将在侦听器上看到小警告标志以提醒您！

克里斯

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-11-18T05:37:31.990

最赞成的对我不起作用.. <If> 指令仅适用于 Apache 2.4+，但[ElasticBeanstalk](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/concepts.platforms.html#concepts.platforms.java)的版本为 2.2.x。

因此，遵循与上述相同的建议。创建一个名为 .ebextensions/https_rewrite.config 的文件，其内容如下

```
files:
    "/etc/httpd/conf.d/ssl_rewrite.conf":
        mode: "000644"
        owner: root
        group: root
        content: |
            LoadModule rewrite_module modules/mod_rewrite.so
            RewriteEngine On
            # This will enable the Rewrite capabilities
            RewriteCond %{HTTPS} !=on
            # This checks to make sure the connection is not already HTTPS
            RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L] 
```

这似乎对我有用。

关于如何将此文件构建到您的 WAR 文件中，请参阅此[答案](https://stackoverflow.com/questions/18423932/where-to-add-ebextensions-in-a-war)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-01-31T17:31:57.347

我正在尝试在 2018 年使用负载均衡器重定向弹性 beantalk。以上答案均不适用于我的环境。我遇到的几个问题：

1.  我正在尝试投票最多的答案，但我的 tomcat 是 2.7 版。它不支持 .

2.  我正在使用 container_commands 并复制 00_applications 设置。AWS 只是忽略了它。

所以最后我通过阅读这篇文章让它工作了： [https ://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-tomcat-proxy.html](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-tomcat-proxy.html)

这是我所做的：

我重新创建了文件夹结构：

```
.ebextensions 
 - httpd
  -conf.d
   -ssl.conf 
```

然后这是 ssl.conf 的内容

```
<VirtualHost *:80>
  RewriteEngine on
  RewriteCond %{HTTP:X-Forwarded-Proto} =http
  RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
  <Proxy *>
    Order Allow,Deny
    Allow from all
  </Proxy>
  ProxyPass / http://localhost:8080/ retry=0
  ProxyPassReverse / http://localhost:8080/
  ProxyPreserveHost on

  ErrorLog /var/log/httpd/elasticbeanstalk-error_log
</VirtualHost> 
```

希望这会有所帮助。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-06-23T23:50:14.407

编辑：[Zags 解决方案](https://stackoverflow.com/a/38751749/877676)更加通用和正确。我推荐它而不是我的（这是特定于 python 环境的）

这是我想出的一个干净快速的解决方案，可以避免破解 wsgi.conf 或使用 CloudFront

在您的 .ebextensions/some_file.config 中：

```
# Redirect HTTP to HTTPS
  "/etc/httpd/conf.d/https_redirect.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      <Directory /opt/python/current/app/>
      RewriteEngine on
      RewriteCond %{HTTP:X-Forwarded-Proto} ^http$
      RewriteRule .* https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
      </Directory> 
```

我觉得这太容易了，但似乎工作正常。

另请注意，我明确重定向 HTTP 而不是“非 HTTPS”。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-05-11T08:22:02.480

下一个命令对我有用：

```
RewriteCond %{HTTP:X-Forwarded-Port} !=443 
```

并且没有 https 检查：

```
RewriteCond %{HTTP:X-Forwarded-Proto} !https 
```

看起来 ELB 将 X-Forwarded-Proto 的值更改为 http（即使在 TCP 协议上）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-01-09T14:50:31.770

以上答案都没有对我有用，但有些答案帮助我找出了对我有用的答案我还找到了以下网址，它帮助了 [http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-tomcat -platform.html](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-tomcat-platform.html)

我创建了上面 url 中提到的文件结构来更改 2 个文件 httpd.conf 00_application.conf

从您的实例中复制整个 httpd.conf 并将其放在上述链接中提到的文件夹结构下的 .ebextention 下的代码中。然后只需将以下行添加到项目中的该文件

```
LoadModule rewrite_module modules/mod_rewrite.so 
```

对 00_application.conf 执行相同操作，从您的实例中复制它并将其放置在 httpd/conf.d/elasticbeanstalk/00_application.conf 下的 .ebextention 下的代码库中 现在编辑此文件并在 VirtualHost 之间添加以下内容

```
RewriteEngine on
RewriteCond %{HTTP:X-Forwarded-Proto} =http
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

现在部署您的代码它应该可以工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-02-04T00:14:04.970

我很难弄清楚这一点，所以在我想出一个解决方案后，我[写了一个关于我的解决方案的详细解释，](http://mattsommer.io/spring-eb-apache-https-redirect)希望能帮助别人。这特定于 Tomcat 8、Apache2 和 Spring Boot 应用程序。AWS 实验室 github 中有非常有用[的 ebextension 示例](https://github.com/awslabs/elastic-beanstalk-docs/tree/master/.ebextensions/aws_provided/security%20configuration)。

对我有用的总结：

1.  在 /src/main/webapp/.ebextensions/httpd/conf.d/elasticbeanstalk.conf 创建一个文件
2.  添加重写条件/规则，小心包含“LoadModule rewrite_module modules/mod_rewrite.so”
3.  部署到 AWS EBS

这是一个[示例 Spring Boot 应用程序](https://github.com/matthewsommer/spring-elasticbeanstalk-loadbalancer-https-redirect)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-03-26T07:12:07.647

在弹性 beanstalk 上，您只需添加您的 on 配置，以便 AWS 覆盖它们，它将允许您覆盖 Web 服务器配置并提交您自己的配置。

只需在路径下添加以下文件：.ebextensions\httpd\conf.d

文件内容：

```
<VirtualHost *:80>
   LoadModule rewrite_module modules/mod_rewrite.so

   RewriteEngine On
   RewriteCond %{HTTP:X-Forwarded-Proto} !https
   RewriteCond %{HTTP_USER_AGENT} !ELB-HealthChecker
   RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

   <Proxy *>
     Order deny,allow
     Allow from all
   </Proxy>

   ProxyPass / http://localhost:8080/ retry=0
   ProxyPassReverse / http://localhost:8080/
   ProxyPreserveHost on

   ErrorLog /var/log/httpd/elasticbeanstalk-error_log

</VirtualHost> 
```

'.ebextensions' 是 AWS 中的标准配置文件夹，其余的只是指向您希望覆盖的文件和文件夹。如果文件或文件夹不存在，只需创建它们。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-07T14:44:57.947

# 通过环境变量启用 HTTPS

我只需要对我们的生产环境强制实施 HTTPS，而不是对也在 Elastic Beanstalk 上但不使用负载均衡器（因此不能直接分配证书）的开发和暂存环境强制实施 HTTPS。

我使用环境变量`USE_HTTPS`。`ssl_rewrite.conf`当且仅当`USE_HTTPS`设置为时，我们才复制文件`true`。

**.ebextensions/files/ssl_rewrite.conf**

```
RewriteEngine On
<If "-n '%{HTTP:X-Forwarded-Proto}' && %{HTTP:X-Forwarded-Proto} != 'https'">
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
</If> 
```

**.ebextensions/https.config**

```
files:
  "/home/ec2-user/https_setup.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash

      echo "USE_HTTPS env var: ${USE_HTTPS,,}"
      outfile=/etc/httpd/conf.d/ssl_rewrite.conf
      if [ "${USE_HTTPS,,}" == "true" ]; then
        echo "Configure SSL rewrite"
        cp .ebextensions/files/ssl_rewrite.conf $outfile
        chmod 644 $outfile
        chown root:root $outfile
      else
        [ -f $outfile ] && rm $outfile
        echo "Do not use SSL"
        exit 0
      fi

container_commands:
  01_https_setup:
    command: "/home/ec2-user/https_setup.sh" 
```

请注意，如果您更改了`USE_HTTPS`，则需要重新部署您的应用程序才能使更改生效。如果您愿意，也可以删除文件中的`echo`命令。`https.config`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-10-11T09:46:45.540

AWS 也有这方面的一些[文档](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/configuring-https-httpredirect.html)。

如果您使用的是应用程序负载均衡器，请将文件添加`http-to-https.config`到您的`.ebextensions`文件夹，然后添加以下配置（**不要忘记放入您的 https 证书的 ARN**）：

*注意：请确保您尚未通过 EB 控制台在端口 443 上添加侦听器。如果这样做，请在添加 .config 文件之前删除侦听器。*

```
Resources:
  AWSEBV2LoadBalancerListener:
    Type: 'AWS::ElasticLoadBalancingV2::Listener'
    Properties:
      DefaultActions:
        - Type: redirect
          RedirectConfig:
            Protocol: HTTPS
            Port: '443'
            Host: '#{host}'
            Path: '/#{path}'
            Query: '#{query}'
            StatusCode: HTTP_301
      LoadBalancerArn:
        Ref: AWSEBV2LoadBalancer
      Port: 80
      Protocol: HTTP
  AWSEBV2LoadBalancerListenerHTTPS:
    Type: 'AWS::ElasticLoadBalancingV2::Listener'
    Properties:
      Certificates:
        - CertificateArn: Replace with Certificate ARN
      DefaultActions:
        - Type: forward
          TargetGroupArn:
            Ref: AWSEBV2LoadBalancerTargetGroup
      LoadBalancerArn:
        Ref: AWSEBV2LoadBalancer
      Port: 443
      Protocol: HTTPS 
```

为此使用 LB 的优势在于，您的配置将与您使用的服务器无关，例如 nginx、apache 等。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-12-23T20:17:33.133

我有以下弹性 beanstalk 配置（运行 Tomcat 8 Java 8 的 64 位 Amazon Linux 2016.09 v2.3.1）。我创建了一个目录 .ebextensions 并添加了一个带有重写条件的 .config YAML 文件

上面描述的Zagas[解决方案](https://stackoverflow.com/a/38751749 "解决方案")（非常复杂）对我不起作用。

1.  因为“如果”条件未知
2.  由于 Apache 2.2，我的 httpd.conf 文件中没有包含 mod_rewrite.so

[这个解决方案](https://stackoverflow.com/a/40670047)对我来说更有意义，但这也不起作用。什么也没有发生，我在“conf.d”目录下看不到文件“ssl_rewrite.conf”。

第三个尝试的解决方案是在“.ebextendsion”目录下添加“run.config”和“ssl_rewrite.conf”文件。

run_config 包含

```
container_commands:
copy-config:
command: "cp .ebextensions/ssl_rewrite.conf /etc/httpd/conf.d" 
```

ssl_rewrite.conf 包含

```
LoadModule rewrite_module modules/mod_rewrite.so
RewriteEngine On
RewriteCond %{HTTP:X-Forwarded-Proto} =http
RewriteRule . https://%{HTTP:Host}%{REQUEST_URI} [L,R=permanent] 
```

ssl_rewrite.conf 是在“conf.d”目录下创建的，但从 http 重定向到 https 不起作用。

对我来说唯一可行的解​​决方案是在“/etc/httpd/conf.d/elasticbeanstalk/00_application.conf”中添加以下行

```
<VirtualHost *:80>
......
RewriteEngine on
RewriteCond %{HTTP:X-Forwarded-Proto} =http
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
......
</VirtualHost> 
```

但这是一个临时解决方案，如果更换机器，我的 https 重定向就消失了。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-10-04T07:49:57.807

以防万一有人还在苦苦挣扎：

我挣扎了一段时间，最后，我找到了一个包含所有 AWS 配置的 GitHub（来自 AWS 团队），下面的示例适用于 Apache 2.2 的 HTTP>HTTPS 重定向。（有关 Apache 2.4 和 Nginx 的配置，请参阅下面的链接）。

**阿帕奇 2.2**

1.  在应用程序的根目录中创建一个文件： **YOUR_PROJECT_ROOT/.ebextensions/httpd/conf.d/elasticbeanstalk.conf** （如果使用 IntelliJ/Java，请确保将其添加到最终的 .WAR 工件中）

2.  添加以下行以在虚拟主机中启用重定向：

    ```
    <VirtualHost *:80>
        LoadModule rewrite_module modules/mod_rewrite.so
        RewriteEngine On
        RewriteCond %{HTTP:X-Forwarded-Proto} !https
        RewriteCond %{HTTP_USER_AGENT} !ELB-HealthChecker
        RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

        <Proxy *>
            Order deny,allow
            Allow from all
        </Proxy>

        ProxyPass / http://localhost:8080/ retry=0
        ProxyPassReverse / http://localhost:8080/
        ProxyPreserveHost on

        ErrorLog /var/log/httpd/elasticbeanstalk-error_log
    </VirtualHost> 
    ```

有关 Apache 2.4 和 Nginx 的更多示例，请访问此 GitHub 存储库：

[https://github.com/awsdocs/elastic-beanstalk-samples/tree/master/configuration-files/aws-provided/security-configuration/https-redirect/java-tomcat](https://github.com/awsdocs/elastic-beanstalk-samples/tree/master/configuration-files/aws-provided/security-configuration/https-redirect/java-tomcat)

此外，还有更多有用的配置和示例可用。

问候

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-01-06T17:02:44.017

[我从这里](https://forums.aws.amazon.com/thread.jspa?threadID=61851)找到了一个很有帮助的答案。

我所做的只是创建健康检查路径`/index.php`，而不是`/`在应用程序负载均衡器默认进程中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-12-19T13:06:41.217

我们已经通过`X-Forwarded-Proto`正确处理在后端解决了它。

这是我们的 Grails 配置，但它会帮助您实现这个想法：

```
 grails.plugin.springsecurity.secureChannel.useHeaderCheckChannelSecurity = true
    grails.plugin.springsecurity.portMapper.httpPort = 80
    grails.plugin.springsecurity.portMapper.httpsPort = 443
    grails.plugin.springsecurity.secureChannel.secureHeaderName = 'X-Forwarded-Proto'
    grails.plugin.springsecurity.secureChannel.secureHeaderValue = 'http'
    grails.plugin.springsecurity.secureChannel.insecureHeaderName = 'X-Forwarded-Proto'
    grails.plugin.springsecurity.secureChannel.insecureHeaderValue = 'https'
    grails.plugin.springsecurity.secureChannel.definition = [
        [pattern: '/**', access: 'REQUIRES_SECURE_CHANNEL']
    ] 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-01-10T09:51:45.713

要扩展此问题的另外两个答案[https://stackoverflow.com/a/43026082/8775205](https://stackoverflow.com/a/43026082/8775205)，[https://stackoverflow.com/a/42035023/8775205](https://stackoverflow.com/a/42035023/8775205)。对于使用 ELB 在 AWS 上部署服务并需要分步指南的 Spring Boot 用户，您可以在项目中的 src/main/webapp/.ebextensions/httpd/conf.d/ 下添加一个 ****.conf 文件.

```
src
--main
----java
----resources
----webapps
------.ebextensions
--------httpd
----------confd
------------****.conf 
```

****.conf 如下所示。注意到我的测试站点只有一个实例，所以我添加了一个条件来排除它。

```
<VirtualHost *:80>
   LoadModule rewrite_module modules/mod_rewrite.so

   RewriteEngine On
   RewriteCond %{HTTP:X-Forwarded-Proto} !https
   RewriteCond %{HTTP_USER_AGENT} !ELB-HealthChecker 
   RewriteCond %{HTTP_HOST} !testexample.com #excludes test site
   RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

   <Proxy *>
     Order deny,allow
     Allow from all
   </Proxy>

   ProxyPass / http://localhost:8080/ retry=0
   ProxyPassReverse / http://localhost:8080/
   ProxyPreserveHost on

   ErrorLog /var/log/httpd/elasticbeanstalk-error_log

</VirtualHost> 
```

在此之后，请记住在 pom.xml 中的 maven-war-plugin 下添加一个“资源”，以便获取上述配置。

```
<plugin>
     <groupId>org.apache.maven.plugins</groupId>  
     <artifactId>maven-war-plugin</artifactId>  
     <configuration>  
         <webResources>
             <resource>  
               <!-- some other resource configured by yourself-->
             </resource> 
             <resource>
                <directory>src/main/webapps/.ebextensions</directory>
                 <targetPath>.ebextensions</targetPath>
                 <filtering>true</filtering>
             </resource> 
         </webResources>  
     </configuration>  
     <version>2.1.1</version>
 </plugin> 
```

最后提交并推送您的代码，等待 AWS codebuild 和 codepipeline 从您的存储库中获取您的代码并部署到 beanstalk 环境，或者只是将您的项目打包到一个 war 文件中并将其上传到您的 AWS beanstalk 环境

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-06-24T08:50:58.147

为什么不简单地将 .htaccess 文件放在根文件夹中？这样您就可以简单地测试和调试它。如果您将其包含在 .zip 中，它将再次自动部署在所有实例上。

只需使用`.htaccess`：

```
RewriteEngine on
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-09-04T23:31:32.843

请注意，投票最多的答案现在有点老了。A Paul的答案实际上是正确的答案。他的答案中提供的链接是 AWS 提供的（因此，在 Elastic Beanstalk 上运行应用程序时，建议覆盖您的 Apache 配置以进行从 HTTP 到 HTTPS 的重定向）。

有一件非常重要的事情需要注意。如果您要部署超过 1 个 Web 应用程序，那么在您的一个 Web 应用程序中添加 .ebextensions 文件夹将不起作用。您会注意到您指定的配置中没有一个正在编写或创建。如果您在 Elastic Beanstalk 环境中部署多个 Web 应用程序，则需要阅读 AWS [Java Tomcat 的这篇文章 Deploy Multiple WAR files on Elastic Beanstalk](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-tomcat-multiple-war-files.html)

通常，在对它发出 eb 命令以部署 WAR 文件之前，您需要具有以下结构：

```
MyApplication.zip
├── .ebextensions
├── foo.war
├── bar.war
└── ROOT.war 
```

如果 .ebextentions 文件夹存在于每个 WAR 文件中，那么您会注意到它被完全忽略并且不会执行任何配置更改。

希望这对其他人有帮助。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-01-14T18:16:32.003

以上所有答案在 2022 年都已过时，因为 AWS 在没有正确更新文档的情况下对 ElasticBeanstalk 进行了静默更改。

但是，使用负载均衡器时，从 AWS 控制台执行此操作变得非常简单。创建 https 侦听器（环境 -> 配置 -> 负载均衡器）后，您只需禁用 80 端口 (http) 上的侦听器。就是这样。[![禁用http](../Images/ccb8448a093b38387aeff9a3c281aac8.png)](https://i.stack.imgur.com/6hXsJ.png)

健康检查不再有问题，因为它们直接在实例上执行，而不是在负载均衡器上。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-07-23T14:25:15.850

AWS 不接受 headers 中的 unsercores (_)，而我们可以使用 (-)，因此从 header 变量中删除下划线，例如：- **header_var_val = "some value"**将其替换为**headervarval = "some value"**。这个对我有用。

* * *

## 回答 #22

> 赞同：-4
> 
> 时间：2014-02-20T02:43:10.590

* * *

## 回答 #23

> 赞同：-4
> 
> 时间：2013-10-11T15:33:39.553

如果您使用负载平衡环境，则可以按照[为您的 AWS Elastic Beanstalk 环境配置 HTTPS](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/configuring-https.html)的说明进行操作，最后禁用 HTTP 端口。

请注意，目前[AWS 免费使用套餐](http://aws.amazon.com/free)包含的 Elastic Load Balancing (ELB) 小时数与 EC2 微实例的小时数相同。**

# java - JPQL - 一对多中的左连接数

> ID：14693855
> 
> 赞同：1
> 
> 时间：2013-02-04T19:16:01.267
> 
> 标签：java, count, left-join, jpql, spring-data

花了大约 2 个小时试图理解为什么 JPQL 查询没有返回我期望的结果。请考虑代码：

```
 System.out.println("JPQL ----------------------------");
    Query q = em.createQuery(
            "select u.userName, count(p.id) from User u " + 
            "left join u.posts p group by u.userName");
    List x = q.getResultList();     
    for(Object o : x) {
        Object[] y = (Object[])o;
        System.out.printf("%s %s\n", y[0], y[1]);
    }

    System.out.println("Spring Data JPA -----------------");
    for(User user : userRepository.findAll()) {
        List<Post> posts = postRepository.findAllByAuthor(user);
        System.out.printf("%s %s\n", user.getUserName(), posts.size());
    } 
```

输出是：

```
JPQL ----------------------------
user1 0
user2 0
Spring Data JPA -----------------
user1 3
user2 10 
```

我希望 JPQL 方法与存储库方法的打印方式相同。哪里错了？

**更新**

这是 SQL 跟踪的内容：

```
select 
  user0_.userName as col_0_0_, 
  count(post2_.id) as col_1_0_ 
from User user0_ 
left outer join User_Post posts1_ 
  on user0_.id=posts1_.User_id 
left outer join Post post2_ 
  on posts1_.posts_id=post2_.id 
group 
  by user0_.userName 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T05:35:13.847

查询正确，但关系定义存在问题。这是我所拥有的：

```
@Entity
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    ...         
    @OneToMany
    private List<Post> posts;
    ...
}

@Entity
public class Post {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    ...
    @ManyToOne
    private User author;
    ...
} 
```

看来我必须像这样指定`User`和之间的关系`Post`：

```
 @OneToMany(mappedBy = "author")
    private List<Post> posts; 
```

# wpf - 为什么在等待语句后我的代码没有被访问？

> ID：14693861
> 
> 赞同：2
> 
> 时间：2013-02-04T19:16:24.610
> 
> 标签：wpf, asynchronous

由于某种原因，我无法弄清楚，我`await`在以下代码中的语句之外的代码永远不会到达。为什么？

```
public class FileSystemUpdateSource : IUpdateSource
{
    private ObservableCollection<UpdatePackage> _packages = new ObservableCollection<UpdatePackage>();
    private readonly DirectoryInfo _importDirectory = null;

    public FileSystemUpdateSource(DirectoryInfo a_importDirectory)
    {
        #region Argument Validation

        if (a_importDirectory == null)
            throw new ArgumentNullException("a_importDirectory");

        #endregion

        _importDirectory = a_importDirectory;

        Refresh();
    }

    public ObservableCollection<UpdatePackage> Packages
    {
        get { return _packages; }
    }

    public async void RefreshAsync()
    {
        var task = new Task<IEnumerable<UpdatePackage>>(CreatePackages);

        var packages = await task;

        // *** Code not reached ***

        Packages.Clear();
        Packages.AddRange(packages);

    }

    public void Refresh()
    {
        var packages = CreatePackages();

        Packages.Clear();
        Packages.AddRange(packages);
    }

    private IEnumerable<UpdatePackage> CreatePackages()
    {
        var packageFiles = from packageFile in _importDirectory.EnumerateFiles().AsParallel()
                           where FileIsZip(packageFile)
                           select new UpdatePackage(packageFile);

        return packageFiles;
    }

    private bool FileIsZip(FileInfo a_file)
    {
        using (var fin = a_file.OpenRead())
        {
            byte[] firstBytes = new byte[5];
            fin.Read(firstBytes, 0, 5);

            if (firstBytes[0] == 80 && firstBytes[1] == 75 && firstBytes[2] == 3 && firstBytes[3] == 4 && firstBytes[4] == 20)
                return true;
            else
                return false;
        }
    }
}

    protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);

        var importRoot = ApplicationSettings.Current.GetValue("ImportRoot") as System.IO.DirectoryInfo;

        IUpdateSource updateSource = new FileSystemUpdateSource(importRoot);

        updateSource.RefreshAsync();

        // *** Code IS reached here. ***
    } 
```

**编辑**

答案要归功于`task.Start()`在类似之前添加到我的代码中`await`（感谢 Reed Copsey 的回答）：

```
 /// <summary>
    /// Refresh the list of available update packages (asynchronously).
    /// </summary>
    public async Task RefreshAsync()
    {
        var task = new Task<IEnumerable<UpdatePackage>>(CreatePackages);
        task.Start();

        var packages = await task;

        Packages.Clear();
        Packages.AddRange(packages);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:20:09.713

您正在`Task`错误地创建您的。

当您调用 时`new Task`，它不会启动任务。您应该`Task.Run`改用：

```
var task = Task.Run(CreatePackages); 
```

这可以简化为：

```
public async void RefreshAsync()
{
    var packages = await Task.Run(CreatePackages); 
```

# c# - 在编译代码或外部文件中嵌入大量常量

> ID：14693865
> 
> 赞同：2
> 
> 时间：2013-02-04T19:16:35.747
> 
> 标签：c#, .net, constants, chemistry

我正在开发需要访问元素周期表的科学软件。由一`Element`组`Isotopes`具有一些只读属性（例如质量、丰度、原子序数等）的集合组成。有超过 100 种元素，当考虑到它们的同位素时，有超过 1000 种同位素。为了在运行时填充所有这些对象，我目前有一个 XML 文件（构建操作：内容）*，其中包含我在`Element`类的静态构造函数期间解析的所有元素数据：

```
public class Element {

    private static readonly Dictionary<string, Element> _elements;

    static Element()
    {
        _elements = new Dictionary<string, Element>();            
        LoadElements("Resources/Elements.xml");  // 461 KB file    
    }

    static LoadElements(string resource) {
         // code for construction of elements objects and population of the 
         // _elements dictionary.
    }      

    private Element(blah) { \\ instance constructor }

} 
```

这行得通，但是在文件中解析会产生开销，并且我在设计`Element`类时失去了一些灵活性。`Isotope`另一种方法是将每个都硬编码`Element`到静态构造函数中。后者的优点是我可以为每个添加静态只读属性`Element`（一个有用的功能）：

```
 public class Element {

    private static readonly Dictionary<string, Element> _elements;

    public static readonly Element Carbon = {get; private set;}
    public static readonly Element Hydrogen = {get; private set;}

    static Element()
    {
        _elements = new Dictionary<string, Element>();  

        Carbon = AddElement("Carbon", 6);  
        Carbon.AddIsotope(12, 12.0000000, 0.9893);
        Carbon.AddIsotope(13, 13.0033548378, 0.0107);

        Hydrogen = AddElement("Hydrogen", 1);
        //Repeat this pattern for all the elements...
    }

    static Element AddElement(string name, double atomicNumber) 
    {
          Element element = new Element(name, atomicNumber);
          _elements.Add(name, element);
          return element;
    }

    private Element(string name, double atomicNumber) {
         // Not Important, just setting readonly properties
    }

    private void AddIsotope(int massNumber, double mass, double abundance) {
         // Not Important;
    }

} 
```

但是，这似乎是要包含在 class.cs 文件中的大量硬编码数据。所以我很伤心，一方面在数据管理级别上将元素数据存储在读入的外部文件中是有意义的。但另一方面，因为所有数据实际上都是一堆常量/静态只读对象，这个额外的解析工作似乎是及时的，没有成果的，并且限制了 API 设计。创建所有这些对象的正确方法是什么？

*注意：如果客户端出于任何原因想要修改元素的值，则构建操作设置为内容。这不是必需的，可以更改为嵌入式资源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:25:51.417

我会考虑将这些值放在一个嵌入式文件中，但*可能*有一个元素的枚举。（可能不是同位素，但提供了一种从元素中指定同位素的简单方法。）

那样：

*   您仍然可以拥有强类型的 API，而不是依赖用户代码中的魔术字符串等
*   如果您真的希望，您仍然可以在以后轻松更改数据（并且*可能*提供一种从外部源读取数据的方法）
*   您可能更容易使用数据本身，作为 XML 文件而不是 C#

不要担心解析工作 - 鉴于您只需要执行*一次*，我发现很难相信它在性能方面会很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:57:35.180

查看托管在 sourceforge 上的蓝色方尖碑项目——我想你会在那里找到一些有用的东西，甚至可能正是你正在寻找的东西。

# html - css没有显示内联

> ID：14693867
> 
> 赞同：-2
> 
> 时间：2013-02-04T19:16:47.047
> 
> 标签：html, css

我喜欢我的代码显示的方式是

```
Name1      
Name2 Jim 
```

它现在的做法是：

```
Name1 Name2  Jim 
```

我怎样才能改变它，使它看起来像我想要的那样？

CSS

```
.display-left {
     float: left; 
     width: 200px; 
     text-align: left; 
     font-weight:bold   
}

.display-right {
     text-align: left;
} 
```

HTML

```
<div class="display-left">Name1:   </div>
  <div class="display-right" > </div>
</div>
<div>
  <div class="display-left">Name2: </div>
  <div class="display-right">Jim </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:20:33.347

`clear:left;`最简单的方法是在您的课程中添加一个`.display-left`。还有一个`float:left;`你的显示权类

[http://jsfiddle.net/f5cUx/3/](http://jsfiddle.net/f5cUx/3/)

```
.display-left {
    float: left;
    width: 200px;
    text-align: left;
    font-weight:bold;
    clear:left;
}

.display-right {
    text-align: left;
    float:left; 
} 
```

“ [clear”属性](http://www.w3.org/wiki/CSS/Properties/clear)指定在哪些边上不允许其他浮动元素。

我还刚刚注意到您已将每个“行”包装在一个 div 中。在这种情况下，您可以在那些清除浮动的“包装器” div 上放置一个新类。

[http://jsfiddle.net/f5cUx/4/](http://jsfiddle.net/f5cUx/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:24:51.840

如果添加：显示：块；到你的 .display-left 类，它可能会起作用。试试！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:24:53.180

添加`display:block`到`.display-right;`. 这告诉 HTML 说“请占用整行”。您可以使用`<br>`标签，但这仅适用于一个示例。之后就是浪费代码

您也可以尝试添加`clear:both;`到`display-right` 这告诉 HTML 说“跳出浮动并始终保持在浮动下方”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-04T19:19:36.857

在 name1 之后但在 name2 之前将 a`<br>`在您的 html 中，这应该做您想要的或尝试`<p></p`

# javascript - jQuery .is() :first 显示与 :last 不同的行为

> ID：14693877
> 
> 赞同：2
> 
> 时间：2013-02-04T19:17:36.543
> 
> 标签：javascript, jquery, selector

谁能向我解释一下 jQuery .is() 函数到底发生了什么？

我有一种情况，我正在检查一个元素是否是我选择的一组元素中的第一个。

```
<div>
   <ul>
      <li>first</li>
      <li>second</li>
      <li>third</li>
      <li>last</li>
   </ul>
</div>

$('div > ul > li').first().is(':first') or
$('div > ul').find('li:first').is('li:first') 
```

返回 false....这是怎么回事？

```
$('div > ul > li').last().is(':last') or
$('div > ul').find('li:last').is('li:last') 
```

返回真

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T19:22:04.127

选择器`:first`只是从页面上的所有元素中选择第一个元素。那就是`<html>`，试试跑步`$(":first")`。`:last`适用于您的情况，因为最后一个`<li>`也恰好是整个页面上的最后一个元素。

您可能想要`:first-of-type`或`:first-child`相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:26:55.057

看[http://jsfiddle.net/MvWcv/1/](http://jsfiddle.net/MvWcv/1/) 当你选择':first'时，意味着你选择了整个文档的第一个节点。':last' 也指向整个文档的最后一个节点，即“last”。

因此应该是

`$('div > ul > li').first().is('div > ul > li:first')`

和

`$('div > ul > li').last().is('div > ul > li:last')`

# mysql - 在程序上规范化 mySQL 中的表数据

> ID：14693882
> 
> 赞同：0
> 
> 时间：2013-02-04T19:17:46.680
> 
> 标签：mysql, normalization

我有一个非规范化格式的大型数据集。以下是列名的示例：

foreign_key_ID, P1, P2, P3, P4, P5.... D1, D2, D3.... 等等..

这些字段都包含相似类型的数据。

我需要将其规范化为我现有的表结构：

```
insert into new_table (id, name, index)
select foreign_key_id, P1, 1
from denormalized_table; 
```

但这意味着我需要为我的非规范化表中的每个字段运行单独的查询，只需更改一些内容：

```
insert into new_table (id, name, index)
select foreign_key_id, P2, 2
from denormalized_table; 
```

考虑到我有多少这些领域，这变得越来越乏味。

有没有一种方法可以将其自动化到单个操作中？即：遍历字段（我不介意在某处创建一次合格字段的列表），拉出该字段名称的最后一位（即“P1”中的“1”和“P2”中的“2”）在子选择中使用字段名称和提取的索引#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:22:10.580

您正在寻找的是动态 SQL。您可以在此处执行可以以编程方式组合的 SQL 语句。只要您在存储过程中，就可以运行字符串中的任意 SQL 代码。请参阅此链接：[如何在 MySQL 存储过程中使用动态 SQL](https://stackoverflow.com/questions/190776/how-to-have-dynamic-sql-in-mysql-stored-procedure)

基本上，您可以使用 mySQL 语句通过迭代一组列来构建字符串。您可以使用 SHOW COLUMNS 语法（请参阅[http://dev.mysql.com/doc/refman/5.0/en/show-columns.html](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html)）返回一个集合，然后遍历该结果集并构建您的动态查询字符串并执行那样。

```
SHOW COLUMNS FROM myTable WHERE Field NOT IN (pkey, otherFieldIDontWantToInclude) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:25:37.140

这是一个开始：

```
SELECT column_name, substr(column_name,2) AS `index`
  FROM information_schema.columns
 WHERE table_schema = 'mydatabasename'
   AND table_name = 'denormalized_table'
   AND column_name REGEXP '^[PD][0-9]+$'
 ORDER BY column_name 
```

您可以修改该语句中的选择列表，让 MySQL 为您生成语句：

```
SELECT CONCAT('INSERT INTO new_table (id, name, `index`) SELECT foreign_key_id, '
         ,column_name,', ',substr(column_name,2)
         ,' FROM denormalized_table ;') AS stmt
  FROM information_schema.columns
 WHERE table_schema = 'mydatabasename'
   AND table_name = 'denormalized_table'
   AND column_name REGEXP '^[PD][0-9]+$'
 ORDER BY column_name 
```

其输出将是一组 MySQL INSERT 语句，然后您可以执行这些语句。

* * *

如果要插入的数据的行数和总大小不是太大，您可以并且希望在“一次操作”中完成整个转换，那么您可以生成单个 INSERT INTO ... SELECT 语句，使用 UNION ALL 运算符。我会得到这样的大部分陈述：

```
SELECT CONCAT('UNION ALL SELECT foreign_key_id, '
         ,column_name,', ',substr(column_name,2)
         ,' FROM denormalized_table ') AS stmt
  FROM information_schema.columns
 WHERE table_schema = 'mydatabasename'
   AND table_name = 'denormalized_table'
   AND column_name REGEXP '^[PD][0-9]+$'
 ORDER BY column_name 
```

我会从中获取输出，并将第一个替换`UNION ALL`为`INSERT INTO ...`. 这将给我一个运行语句来完成整个转换。

# wcf - WCF 超时 - 线程是被杀死还是允许完成

> ID：14693886
> 
> 赞同：2
> 
> 时间：2013-02-04T19:18:03.793
> 
> 标签：wcf, timeout

假设我的 WCF 服务中有以下执行链：

ServiceMethod 调用并等待 Method1，然后调用并等待 Method2，后者调用并等待 Method3。最后 ServiceMethod 在返回之前调用并等待 Method4。

如果在执行方法 3（或任何这些方法）期间遇到服务配置的超时，会发生什么情况？执行 ServiceMethod 的线程是否会立即终止？没有进一步执行？或者进程是否允许线程继续到最后，而不返回任何结果？

我关心的是知道在遇到超时之前处理进行了多长时间。如果允许线程完成，则可以知道无论如何都已完成（即使没有返回结果）。但是，如果线程立即终止，则必须设计 ServiceMethod 以便可以跟踪它走了多远，然后从那里再试一次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:57:16.530

允许该操作在服务器上运行完成 - 超时的是 WCF 通道。事实上，有些人在这里要求一种方法来强制服务器端处理在发生超时时中止，并且普遍认为干净地这样做会很困难：

[为什么 WCF 不支持服务端超时？](https://stackoverflow.com/questions/4974640/why-doesnt-wcf-support-service-side-timeouts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T20:07:26.260

主机创建服务实例后，它将继续运行，直到任一进程终止，您的逻辑完成并退出入口点（操作）或抛出未捕获的异常。您关心的超时是在客户端和主机之间。

客户端将在通道上收到异常信号，将超时作为通道故障。这告诉客户端通道不安全，必须重新创建。

关于调用链的小评论。您最好将逐步逻辑封装在单个工作流或管理器中，这可以帮助您满足可重新启动或补偿逻辑的要求。在您的服务中有一个入口点，然后可以执行工作流。

关于为什么 WCF 不支持来自“500 内部服务器”的服务端超时的答案 +1

# c# - Silverlight(lightswitch) 的 DotnetZip 问题

> ID：14693887
> 
> 赞同：0
> 
> 时间：2013-02-04T19:18:05.813
> 
> 标签：c#, silverlight, visual-studio-lightswitch, dotnetzip

所以我遇到了这个我目前无法弄清楚的问题。[我已经从“ http://dotnetzip.codeplex.com/workitem/14049](http://dotnetzip.codeplex.com/workitem/14049) ”获取了修补过的 Ionic.zip 。

我使用 ionic.zip 在一个非silverlight项目上测试了我的代码，用于常规 c# 及其工作。但是在修改 silverlight(lightswitch) 的代码时，我不断收到“IBM437”错误。

这是我的代码的样子

```
void selectFileWindow_Closed(object sender, EventArgs e)
{
    SelectFileWindow selectFileWindow = (SelectFileWindow)sender;
    string selectFileStream = sender.ToString();
    var parsedString = selectFileStream.Split(',');

    if (selectFileWindow.DialogResult == true && (selectFileWindow.myStream != null))
    {
        foreach (FileStream myZippedStream in selectFileWindow.myStream)
        {
            string zippedLocation = myZippedStream.Name;
            var parsedLocation = zippedLocation.Split('\\');
            string fileName = parsedLocation[parsedLocation.Length - 1];
            //filename is equal to something like "myfile.zip"
            // We want to turn that to "myfile.txt)
            fileName = (fileName.Substring(0, fileName.Length - 3)) + "txt";

            using (FileStream fs = File.Create("c:\\temp\\gftTempFile.txt"))
            {
                using (var ms = new MemoryStream())
                {
                    //ReadOptions myOptions = new ReadOptions();
                    //myOptions.Encoding = System.Text.Encoding.UTF8;
                    //using (ZipFile myZip = ZipFile.Read(myZippedStream, myOptions))
                    // I have tried using the commentted code but it gives the same error
                    using (ZipFile myZip = ZipFile.Read(myZippedStream))
                    {
                        ZipEntry myEntry = myZip[fileName];
                        myEntry.Extract(ms);

                        ms.WriteTo(fs);
                        fs.Close();

                        ImportGift.importGift(fs, this.DataWorkspace);

                        try
                        {
                            fs.Close();
                            fs.Dispose();
                            ms.Close();
                            ms.Dispose();
                            File.Delete("c:\\temp\\gftTempFile.txt");
                        }
                        catch { }
                    }
                }
            }
        }
        doneLoading = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:03:14.003

我不确定“IBM437”是错误的，或者您的代码中发生的位置，但我知道 SilverLight 不允许您在不先显示 SelectFileWindow 的情况下从代码访问文件系统。

换句话说：如果没有提升的权限，您的具有硬编码“c:\temp\gftTempFile.txt”的行肯定不会在 SL 应用程序中工作。

# android - 我们可以像在 android 中一样在 windows 中创建 XMPP 聊天客户端代码吗？

> ID：14693895
> 
> 赞同：-1
> 
> 时间：2013-02-04T19:18:44.950
> 
> 标签：android, python, google-app-engine, windows-xp, xmpp

我需要我的 android 手机和我的 PC (win-xp-sp3) 能够相互通信。

我通过 SL4a/python 在我的 android 手机中成功运行了 xmpp 代码，它可以发送和接收通信。现在我的手机发送的通信我想通过代码在我的电脑上接收。（目前我正在接收我的gtalk客户端）

我的问题是：我该怎么做？是否有任何预先存在的代码、脚本、链接可以参考？或者我可以劫持gtalk在我的电脑中收到的消息吗？

我试图通过删除代码的 android 部分来使用相同的 android 代码来监听来自 PC 的聊天，但我在 xmpp 模块不存在时遇到错误。所以我将 xmpp.py 文件从谷歌开发者网站复制到我的 lib 文件夹中。但现在如果我尝试运行它，我会收到错误“没有名为 google.appengine.api 的模块”。

所以我做了一些功课，从谷歌开发者网站下载了 gdata-2.0.17.zip。

我的问题是：我在正确的道路上吗？接下来我该怎么做？是否有任何文件/链接与您知道的相同？

我知道这个问题很长，但我试图具体到我正在寻找的内容。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:36:52.623

有各种各样的[XMPP 客户端库](http://xmpp.org/xmpp-software/libraries/)可用，它们几乎可以在 Windows 上以您想要使用的任何语言运行。选择一个并简单地编写一个连接到 gtalk 服务器的应用程序。你不需要任何谷歌特定的东西来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T20:50:08.840

Google App Engine 是 Google 的云计算服务。如果您不使用它创建 Web 应用程序，则需要为 Python 找到一个不依赖于 Google App Engine 的 XMPP 模块。

[https://stackoverflow.com/questions/1081634/which-is-the-most-mature-python-xmpp-library-for-a-gchat-c​​lient](https://stackoverflow.com/questions/1081634/which-is-the-most-mature-python-xmpp-library-for-a-gchat-client)似乎与这个问题有关。

# jquery - 单击按钮时未打开 jQuery 对话框 - asp.net 网页

> ID：14693897
> 
> 赞同：0
> 
> 时间：2013-02-04T19:18:53.583
> 
> 标签：jquery, asp.net, button, dialog

我是 jQuery 新手，当用户单击页面提交按钮时，我正在努力打开一个 jQuery 对话框；任何帮助将不胜感激！

我搜索了其他帖子，谷歌等，但显然还是不太明白。我在下面包含代码的相关部分。仅供参考，我正在使用 Telerik 控件，提交按钮位于表格中。这是一个相当大的 asp.net/vb.net Web 应用程序中的一个页面，它确实使用了母版页。

最终，我想为用户提供一个是、否、取消对话框，但此时我只是想让一个对话框简单地打开。

```
<script type="text/javascript">
function confirmSubmit2(sender, args) {
    var rblNextStep = document.getElementById("<%= cbNextStep.ClientID %>");
    var radioButtons = rblNextStep.getElementsByTagName('input');
    var selectedButton = radioButtons.length - 1;

    if (radioButtons[selectedButton].checked) {
        var hasItems = document.getElementById('<% =hfHasItems.ClientId %>').value

        if (parseInt(hasItems) != 0)
            jQuery("#dialog").dialog('open');
    }
}

    $(function () {
        $("#dialog").dialog({
            resizable: false,
            height: 140,
            modal: true,
            buttons: {
                "Delete all items": function () {
                    $(this).dialog("close");
                },
                Cancel: function () {
                    $(this).dialog("close");
                }
            }
        });
    }); 
```

```
<td style="font-family: Times New Roman; font-size: medium; width: 33%; text-align: left;">
    <div id="dialog">
     <asp:Panel ID="btnSubmitWrapper" runat="server">
        <telerik:RadButton ID="btnSelSubmit" runat="server" Skin="Sunset" Text="Submit"
            ValidationGroup="Review" Width="98%" OnClientClicked="confirmSubmit2"
            SingleClick="true" SingleClickText="Submitting..." DisabledButtonCssClass="btnDisable">
        </telerik:RadButton>
    </asp:Panel>
    </div>
</td> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:00:17.067

看起来您并没有真正正确地调用对话框插件。

要打开对话框，为什么不使用 jquery 并执行类似的操作来连接 click 事件。

```
$("#<%=btnSelSubmit.ClientID %>").click(function () {
    var dlg = $("#Dialog").dialog({
        title: "Something here",
        autoOpen: true,
        width: 600,
        modal: true
        }
    }); 
```

# asp.net-mvc - 调用 RedirectToAction 时对象未设置为实例

> ID：14693905
> 
> 赞同：0
> 
> 时间：2013-02-04T19:19:12.750
> 
> 标签：asp.net-mvc, asp.net-mvc-4

IIS 抛出：

> 你调用的对象是空的。

当它应该将经过身份验证的用户重定向到 /Home/Index

我已经调查了它可能发生的原因，但找不到原因

这条线是：

```
return RedirectToAction("Index", "Home"); 
```

stacktrace：（这是我得到的唯一信息）

```
[NullReferenceException: Object reference not set to an instance of an object.]
   System.Web.Mvc.AuthorizeAttribute.AuthorizeCore(HttpContextBase httpContext) +30
   System.Web.Mvc.AuthorizeAttribute.OnAuthorization(AuthorizationContext filterContext) +160
   System.Web.Mvc.ControllerActionInvoker.InvokeAuthorizationFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor) +97
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__1e(AsyncCallback asyncCallback, Object asyncState) +445
   System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +129
   System.Web.Mvc.Async.AsyncControllerActionInvoker.BeginInvokeAction(ControllerContext controllerContext, String actionName, AsyncCallback callback, Object state) +287
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__17(AsyncCallback asyncCallback, Object asyncState) +30
   System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +129
   System.Web.Mvc.Controller.BeginExecuteCore(AsyncCallback callback, Object state) +338
   System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +129
   System.Web.Mvc.Controller.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state) +282
   System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state) +15
   System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__2(AsyncCallback asyncCallback, Object asyncState) +71
   System.Web.Mvc.Async.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) +129
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state) +236
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state) +48
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData) +16
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +301
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155 
```

**编辑 1：** 该应用程序在我的计算机上本地运行。我正在处理所有文件夹并发送到服务器。然后，我尝试在服务器中本地访问，我得到了这个。服务器上的 IIS 对应用程序池具有相同的配置，我相信它的配置是正确的，至少像我一样在本地使用。我试图让它在服务器本地工作，然后我将配置为远程使用。

**编辑2：**

这是/首页/索引：

```
namespace gedaiapp.Controllers
{
    [Authorize]
    public class HomeController : Controller
    {
        public ActionResult Index()
        {   
            return PartialView();
        }
    }
} 
```

和 /Index/Login （类有授权属性，只有这个特定的方法有`[AllowAnonymous]`）所以尚未通过身份验证的用户可以登录

```
[HttpPost]
[AllowAnonymous]
[ValidateAntiForgeryToken]
public ActionResult Login(LoginModel model, FormCollection form)
{
    try
    {
        //Verifica se logon será feito utilizando certificado digital ou não
        string isDigitalCertified = form["hasDigital"];

        if (!string.IsNullOrEmpty(isDigitalCertified))
        {
            string[] isDCArr = isDigitalCertified.Split(',');

            if (!string.IsNullOrEmpty(isDCArr[0]))
            {
                string isDC = isDCArr[0];

                //Se login for utilizando certificado digital
                if (isDC == "true")
                {
                    //Resgata subject do certificado digital
                    string certDadosStr = "";
                    do
                    {
                        certDadosStr = Request.ClientCertificate.Subject;
                    } while (certDadosStr == "");

                    //Resgata cpf ou cnpj do certificado digital
                    string[] certDadosArr = certDadosStr.Split(',');
                    int Count = certDadosArr.Count();
                    //Razão social é sempre o último elemento no padrão ICP-Brasil
                    string razaoSocial = certDadosArr[Count - 1];
                    string[] razaoSocialArr = razaoSocial.Split(':');
                    Count = razaoSocialArr.Count();
                    string key = razaoSocialArr[Count - 1];
                    //Resgata Guid do usuário
                    MembershipUser user = Membership.GetUser(model.UserName);
                    Guid userID = (Guid)user.ProviderUserKey;

                    //Verifica se (cpf ou cnpj) do usuário efetuando o login é o mesmo do cadastrado no sistema
                    using (gedaiappEntities context = new gedaiappEntities())
                    {
                        var keyNumberObj = from a in context.sistema_UsersCertified
                                           where a.userID == userID
                                           select a.keyNumber;
                        string keyNumber = keyNumberObj.First();

                        //Se autenticidade for positiva (redireciona)
                        if (keyNumber == key)
                        {
                            FormsAuthentication.SetAuthCookie(model.UserName, false);
                            return RedirectToAction("Index", "Home");
                        }
                        else
                        {
                            return RedirectToAction("Login", "Account");
                        }
                    }
                }//Caso login seja sem certificado digital
                else
                {
                    MembershipProvider mp = Membership.Provider;
                    if (mp.ValidateUser(model.UserName, model.Password))
                    {
                        FormsAuthentication.SetAuthCookie(model.UserName, false);
                        try
                        {
                            return RedirectToAction("Index", "Home");
                        }
                        catch (Exception e)
                        {
                            return Content("Erro: " + e);
                        }

                    }
                    return RedirectToAction("Login", "Account");
                }
            }
            else
            {
                //return Content("Erro Catastrófico: Não foi possivel identificar se login é com certificado digital ou não.");
                return RedirectToAction("Login", "Account");
            }
        }
        else
        {
            //return Content("Erro Catastrófico: Valor do checkbox hasDigital não foi enviado.");
            return RedirectToAction("Login", "Account");
        }
    }
    catch (Exception e)
    {
        return Content("Erro: " + e);
    }
} 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T10:10:37.577

解决了添加问题

`<modules runAllManagedModulesForAllRequests="true"/>`

在 web.config 中

PS 这不是正确的做法，因为它会在每次请求时加载所有模块。虽然找不到未加载的内容。

# php - ios Safari 正在从 $_SERVER['HTTP_HOST'] 中删除“www”，这怎么可能

> ID：14693909
> 
> 赞同：0
> 
> 时间：2013-02-04T19:19:29.380
> 
> 标签：php, ios, safari, hostname, lightopenid

在子域上有一个单独的移动站点，其名称`m.domain`而不是`domain`：

当我尝试使用 openid 在 ios 设备上登录时，我从谷歌收到一个错误页面，但如果我从桌面使用该网站，则不会。

chrome mobile 没问题，就是 safari。我认为这些服务器变量无论如何都会保持不变？

有人可以解释一下吗？

**编辑：** 除了 openid 需要在其授权请求中包含“www”，因为我比较了字符串，实际上并没有以错误的形式输出太多内容。它在由 lightopenid 库中的“SERVER ['HTTP_HOST']”设置的“领域”变量中出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:22:42.343

它可能与您的登录表单结构有关，而不是`$_SERVER`与服务器提供的变量有关，并且由于您尝试登录同一服务器，因此无论您使用什么设备，所有结果都应该相同。

# silverlight - Silverlight 5 身份验证

> ID：14693926
> 
> 赞同：0
> 
> 时间：2013-02-04T19:20:44.157
> 
> 标签：silverlight, membership

我正在使用 Visual Studio 2012 和 Silverlight 5。我创建了一个 Business Silverlight 应用程序。我正在将我的 asp.net 应用程序转换为 Silverlight。我正在使用与 asp.net 应用程序相同的 sql server 数据库。两者都使用表单身份验证。成员资格表在我的数据库中，前缀为 aspnet_。asp.net 应用程序运行良好。但是，默认情况下，Silverlight 应用程序似乎希望以不同的方式命名这些表。aspnet_Users 现在是用户。我已经有一个名为 Users 的表，它的结构与 aspnet_Users 不同。当我尝试使用提供的登录框架登录时，一切都失败了，因为缺少它需要的列；像用户 ID。如何使身份验证使用 aspnet_* 表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T06:51:44.747

我不知道为什么架构如此不同，可能是您将目标更改为.Net 4.5？

解决此问题的一种简单方法是实现[自定义成员资格提供程序](http://msdn.microsoft.com/en-us/library/f1kyba5e%28v=vs.100%29.aspx)。然后你可以映射到你喜欢的任何模式。

实现有点冗长，但非常简单。

# ruby - Ruby：如何检测/智能猜测 CSV 文件中使用的分隔符？

> ID：14693929
> 
> 赞同：8
> 
> 时间：2013-02-04T19:21:04.267
> 
> 标签：ruby, delimiter, csv

我需要能够确定在我的 Ruby 项目中的 csv 文件（逗号、空格或分号）中使用了哪个分隔符。我知道，在 Python 中的 csv 模块中有一个 Sniffer 类，可用于猜测给定文件的分隔符。Ruby中是否有类似的东西？非常感谢任何形式的帮助或想法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-04T20:47:23.290

看起来 py 实现只检查一些方言：excel 或 excel_tab。所以，一个简单的实现只是检查`","`or`"\t"`是：

```
COMMON_DELIMITERS = ['","',"\"\t\""].freeze

def sniff(path)
  first_line = File.open(path).first
  return unless first_line

  snif = {}
  COMMON_DELIMITERS.each do |delim| 
    snif[delim] = first_line.count(delim)
  end
  snif = snif.sort { |a,b| b[1]<=>a[1] }

  snif[0][0] if snif.size > 0
end 
```

注意：这将返回它找到的完整分隔符，例如`","`，因此`,`您可以`snif[0][0]`将`snif[0][0][1]`.

另外，我正在使用`count(delim)`它是因为它更快一些，但是如果您添加了一个由两个（或更多）相同类型的字符组成的分隔符`--`，那么在权衡类型时它可能会每次出现两次（或更多） ，所以在这种情况下，最好使用`scan(delim).length`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-10-08T09:17:40.850

这是[Gary S. Weaver](https://stackoverflow.com/users/178651/gary-s-weaver)的回答，因为我们在生产中使用它。很好的解决方案，效果很好。

```
class ColSepSniffer
  NoColumnSeparatorFound = Class.new(StandardError)
  EmptyFile = Class.new(StandardError)

  COMMON_DELIMITERS = [
    '","',
    '"|"',
    '";"'
  ].freeze

  def initialize(path:)
    @path = path
  end

  def self.find(path)
    new(path: path).find
  end

  def find
    fail EmptyFile unless first

    if valid?
      delimiters[0][0][1]
    else
      fail NoColumnSeparatorFound
    end
  end

  private

  def valid?
    !delimiters.collect(&:last).reduce(:+).zero?
  end

  # delimiters #=> [["\"|\"", 54], ["\",\"", 0], ["\";\"", 0]]
  # delimiters[0] #=> ["\";\"", 54]
  # delimiters[0][0] #=> "\",\""
  # delimiters[0][0][1] #=> ";"
  def delimiters
    @delimiters ||= COMMON_DELIMITERS.inject({}, &count).sort(&most_found)
  end

  def most_found
    ->(a, b) { b[1] <=> a[1] }
  end

  def count
    ->(hash, delimiter) { hash[delimiter] = first.count(delimiter); hash }
  end

  def first
    @first ||= file.first
  end

  def file
    @file ||= File.open(@path)
  end
end 
```

规格

```
require "spec_helper"

describe ColSepSniffer do
  describe ".find" do
    subject(:find) { described_class.find(path) }

    let(:path) { "./spec/fixtures/google/products.csv" }

    context "when , delimiter" do
      it "returns separator" do
        expect(find).to eq(',')
      end
    end

    context "when ; delimiter" do
      let(:path) { "./spec/fixtures/google/products_with_semi_colon_seperator.csv" }

      it "returns separator" do
        expect(find).to eq(';')
      end
    end

    context "when | delimiter" do
      let(:path) { "./spec/fixtures/google/products_with_bar_seperator.csv" }

      it "returns separator" do
        expect(find).to eq('|')
      end
    end

    context "when empty file" do
      it "raises error" do
        expect(File).to receive(:open) { [] }
        expect { find }.to raise_error(described_class::EmptyFile)
      end
    end

    context "when no column separator is found" do
      it "raises error" do
        expect(File).to receive(:open) { [''] }
        expect { find }.to raise_error(described_class::NoColumnSeparatorFound)
      end
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T20:18:35.533

我不知道 Ruby 1.9 中包含的 CSV 库中有任何嗅探器实现。它将尝试自动发现行分隔符，但默认情况下假定列分隔符为逗号。

一个想法是尝试使用每个可能的分隔符解析样本行数（可能是总数的 5%？）。无论哪个分隔符最一致地导致相同的列数，都可能是正确的分隔符。

# windows-services - 声纳作为 Windows 8 32 位上的服务

> ID：14693930
> 
> 赞同：0
> 
> 时间：2013-02-04T19:21:07.633
> 
> 标签：windows-services, sonarqube

我已经在 Windows 8 32bit 上成功运行了声纳。我试图让它作为 Windows 服务工作，但我得到了 503。从我在谷歌上找到的东西中，我将它作为“网络服务”运行，但仍然没有运气。另外，我不知道如何查看正在发生的事情的任何日志记录，一旦服务启动，C:\Program Files\sonar-3.4.1\logs 就不会显示任何内容。任何帮助将不胜感激，我是如此接近！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T09:03:32.540

为 Sonar 服务创建一个专用的 windows (administraton) 用户（即 sonar / sonar）并使用该用户启动该服务。

# php - 按下登录按钮时，重定向页面上没有显示任何内容

> ID：14693931
> 
> 赞同：1
> 
> 时间：2013-02-04T19:21:08.413
> 
> 标签：php, mysql

这是我的表单页面。按下登录时，它被重定向到 checkLogin 页面，但它是空的。没有回声工作。

```
<html>
    <title>User Login Form</title>
    <head></head>
    <body>

    <form name="form1" method="post" action="checkLogin.php">
    <td>
    <table width="100%" border="0" cellpadding="3" cellspacing="1" 
                bgcolor="#FFFFFF">        
    <tr>
    <td width="80">Username</td>
    <td width="6">:</td>
    <td width="300"><input name="myusername" type="text" id="myusername"></td>
    </tr>
    <tr>
    <td>Password</td>
    <td width="6">:</td>
    <td><input name="mypassword" type="text" id="mypassword"></td>
    </tr>
    <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td><input type="submit" name="Submit" value="Login"></td>
    </tr>
    </table>
    </td>
    </form>

    </td>
    </tr>
    </body>
</html> 
```

这是 checkLogin 页面 这没有显示任何内容。我尝试了 mysql_error 但仍然没有显示。请帮忙

```
<?php
    include("config.php");
    echo "Check Login";
    $myusername=$_POST['myusername'];
    $mypassword=$_POST['mypassword'];        
    $myusername=stripslashes($myusername);
    $mypassword=stripslashes($mypassword);
    $myusername=mysql_real_escape_string($myusername);
    $mypassword=mysql_real_escape_string($mypassword);
    $sql="select j.jobid from jobs j,rcuser r where r.userName='$myusername'and r.password='$mypassword'";        
    echo "Hey".$myusername." ";
    $result=mysql_query($sql);
    while($col=mysql_fetch_array($result)){
            echo "<tr><th>Job Id</th>"</tr>;
            echo "<tr><td>" . $col['jobid'] . "</td><tr>";        
    }
    $count=mysql_num_rows($result);
    echo $count;
    if($count==1){
       session_register("myusername");
       session_register("mypassword");
       session_start();
       if(!session_is_registered($myusername){
            echo "Session expired";        
       }
       echo "is it???";        
    }
    else{
       echo "Invalid Username or Password";
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:24:44.180

这是问题所在，请注意：`Id</th>"</tr>;`您没有以正确的方式构建 HTML 并回显。检查以下内容，您的错误在哪里。

```
echo "<tr><th>Job Id</th>"</tr>;
echo "<tr><td>" . $col['jobid'] . "</td><tr>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:03:49.427

请先检查此脚本，并告诉我结果，因为您构建编码的方式不够清晰。

`

```
$myusername=stripslashes(mysql_real_escape_string($_POST['myusername']));
$mypassword=stripslashes(mysql_real_escape_string($_POST['mypassword']));

$sql=" SELECT j.jobid 
            FROM jobs j,rcuser r 
            WHERE r.userName='$myusername' AND r.password='$mypassword' ";        

$result=mysql_query($sql) or die(mysql_error());

if(mysql_num_rows($result) === 1) {
echo "Username and Password is found";
}else {
echo "Error! No results found.";
} 
```

?>`

# c++ - 访问冲突读取 - 指向字符串向量中值的字符串指针向量

> ID：14693934
> 
> 赞同：1
> 
> 时间：2013-02-04T19:21:37.337
> 
> 标签：c++

我在 C++ 方面不是很有经验的程序员，我有一个我无法解决的问题。我正在从事的项目很大，所以我不能在这里发布所有代码。这是太多的代码和太多的解释。我只写了一小部分代码，这部分给我带来了问题，所以我希望它就足够了。很抱歉我的问题很长，但我想解释所有发布的代码。也许这部分代码不足以解决问题，但我想尝试一下。

首先，我有一个名为“record”的结构：

```
struct record {
    vector<string> dataRow;
    vector<string *> keys;
    vector<string *> values;

    void setDataRow(vector<string> r) {
         dataRow = r;
    }
} 
```

一些字符串数据被标记为键，而另一些则被标记为值。我的下一个处理最好将所有字符串数据放在一个向量中，这就是我没有两个字符串向量（向量键、向量值）的原因。

然后我有这个：

```
vector< vector<record> > resultSet; 
```

矢量就像数据表 - 带有字符串数据的行集。我需要这些表的具体计数，因此需要记录向量的向量。表格的数量是可选的，所以当我设置表格数量时，我通过保留功能准备表格：

```
resultSet.reserve(count);
for(unsigned int i = 0; i < count; i++) {
    vector<record> vec;
    resultSet.push_back(vec);
} 
```

当我想向 resultSet 添加新记录时，我知道我需要插入记录的表的数量。在 resultSet[number].push_back(rec) 之后，我需要在向量“keys”和“values”中更改指针，因为 push_back() 在其他内存地址中使用“dataRow”值创建“rec”的新副本，对吧？所以我有这个函数可以执行 push_back 并更新指针：

```
void insert(int part, vector<string> & dataRow) {
    record r;
    r.setDataRow(dataRow);

    resultSet[part].push_back(r);
    int pos = resultSet.size() - 1; // position of last record
    resultSet[part].at(pos).values.clear();
    resultSet[part].at(pos).keys.clear();

    for(unsigned int i = 0; i < dataRow.size(); i++) {
        record * newRec = &resultSet[part].at(pos);
        if(isValue(dataRow[i])) {
            newRec->values.push_back(&(newRec->dataRow.at(i)));
            // control cout...
        } else {
            newRec->keys.push_back(&(newRec->dataRow.at(i)));
            // control cout...
        }
    }
} 
```

这是有效的。在 newRec 中的 push_back 之后，我确实控制了插入指针及其引用值的 cout，一切正常。

但！在一些插入之后，我调用函数 processData(resultSet)，它必须处理 resultSet 中的所有数据。在实现处理 od 数据之前，我只想打印所有用于控制的键，以确定一切是否正常。这段代码：

```
for(unsigned int i = 0; i < resultSet.size(); i++) {
    for(unsigned int j = 0; j < resultSet[i].size(); j++) {
        cout << "keys: ";
        for(unsigned int k = 0; k < resultSet[i].at(j).keys.size(); k++) {
            cout << *resultSet[i].at(j).keys.at(k) << ", ";
        }
        cout << endl;
    }
} 
```

不好（打印记录的值向量也有同样的问题）。它抛出访问冲突读取异常。我知道当我想读取不可访问的内存时会抛出这个异常，对吧？请告诉我上面写的代码有错误，因为我真的不知道为什么它不起作用。在处理 resultSet 之前，除了一些插入计数之外，我对 resultSet 什么都不做。

感谢您的阅读和可能的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T19:41:20.230

当您向 a 添加条目时`std::vector`，指向该向量中元素的所有现有指针都应视为无效。

这是出错的代码。

```
vector<string> dataRow;
vector<string *> keys;
vector<string *> values; 
```

如果`keys`和`values`指向的字符串在它们增长`dataRow`时将变为无效。`dataRow`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-04T19:54:11.200

如果我正确理解了您的问题，那么这一切的原因是对[向量行为方式](http://www.cplusplus.com/reference/vector/vector/)的基本误解。

您的代码将指针存储在一个向量中，该向量指向另一个向量分配的内存位置。*如果向量没有改变，*那会很好。

这样做的原因是 std::vector 是一个容器，它可以保证 - 它包含的所有数据都将分配在一个连续的内存块中。

现在，如果将元素插入向量中，它*可能会*移动内存位置。因此，您应该知道的一件事是，当向量发生变化时，*迭代器需要被视为无效。*迭代器是一种通用指针。换句话说，指向向量内元素位置的指针也变得无效。

现在，假设当涉及的任何向量发生变化时，您在任何地方都更新了所有指针。那你就没事了。但是，您现在面临着一场艰苦的战斗。

正如您在评论中所说，您使用指针是因为您想要效率。您的结构本质上是三个字符串的集合。不要使用您自己的结构，而是键入 3 个 std::strings 的[std::tuple](http://en.cppreference.com/w/cpp/utility/tuple)（您将需要 C++11 编译器）。

最后，当您需要访问其中的数据时，请通过 const reference 和 const_iterator 进行访问，除非您需要修改其中的任何内容。这将确保

1.  您没有重复数据
2.  您正在最大限度地利用 STL，从而最大限度地减少您自己的代码和可能的错误
3.  您依赖于已经非常高效的算法和容器
4.  您正在以应有的方式使用 STL。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T19:41:54.867

一个可能的问题可能是实例的*副本*`record`。

```
struct record 
{
    vector<string> dataRow;
    vector<string *> keys;
    vector<string *> values;
}; 
```

事实上，默认的复制构造函数和复制`operator=`是按*成员复制*的。这对于`dataRow`字段（它是 a `vector<string>`）是可以的，但这对于键和`values`字段是不好的（因为这些是*原始指针*的向量，它们的值被复制，但它们指向错误的地方）。

我会重新考虑您的设计，例如使用`vector<int>`而不是`vector<string *>`for`keys`和`values`字段。存储的`int`s 将是`dataRow`向量中的索引。

另一个注意事项（与您的问题没有直接关系）。在 C++11 中，当您想要复制某些内容时，您可能希望按值传递，并从值移动：

```
void setDataRow(vector<string> r) 
{
     dataRow = std::move(r);
} 
```

或者只是使用通过 const ref 传递的旧 C++98/03 风格：

```
void setDataRow(const vector<string>& r) 
{
     dataRow = r;
} 
```

# c# - Windows服务，获取安装路径的正确方法

> ID：14693937
> 
> 赞同：1
> 
> 时间：2013-02-04T19:21:53.523
> 
> 标签：c#, windows-services

我有一个将部署在几个系统上的 Windows 服务。我想获取用户安装服务的安装路径。我正在尝试获取安装路径，以便我知道从哪里读取自定义配置文件。这样做的正确方法是什么？我尝试使用`Assembly.GetExecutingAssembly().Location`但返回了完整路径和可执行文件。

任何建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:26:51.097

从程序集的位置提取目录名称：

```
System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) 
```

# mysql - mysql：每天获取新用户，每天累计用户总数

> ID：14693941
> 
> 赞同：2
> 
> 时间：2013-02-04T19:22:04.497
> 
> 标签：mysql

假设我有一个 mysql 表 t：

```
DateTime timestamp;
int userid; 
```

我想知道随着时间的推移我有多少用户。我有这个：

```
2012-12-04 102
2012-12-05 101
2012-12-05 102
2012-12-05 103
2012-12-07 101
2012-12-08 104 
```

所以第一次看到 101 是 12/5，第一次看到 104 是 12/7，以此类推。所以我想要这个，对于按日期见过的总用户：

```
2012-12-04 1
2012-12-05 3
2012-12-07 3
2012-12-08 4 
```

（我不在乎那里是否有额外的日期而没有新条目。）

我能得到的最接近的是每天的新用户数量：

```
select distinct date, count(*) from 
 (select MIN(DATE(timestamp)) date from t group by userid order by date) t1 \
GROUP BY date; 
```

这似乎有效；子查询为每个用户 ID 提供最早的时间戳，外部查询按日期组合。但是我怎样才能把它卷起来得到曾经见过的总数呢？

哦，是的，我查看了[MySQL 查询 - 每天查找“新”用户，](https://stackoverflow.com/questions/4422827/mysql-query-find-new-users-per-day)但它似乎没有达到我想要的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:51:01.217

```
SELECT x.timestamp
     , COUNT(DISTINCT y.userid)
  FROM t x
  JOIN t y
    ON y.timestamp <= x.timestamp
 GROUP
    BY timestamp; 
```

GaryO，要了解为什么会这样，只需以这种方式重写它......

```
SELECT DISTINCT x.timestamp, y.userid
  FROM t x
  JOIN t y
    ON y.timestamp <= x.timestamp
 ORDER
    BY x.timestamp
     , y.userid; 
```

使用 sgeddes 的 sqlfiddle，这给了我们以下中间结果：

```
+---------------------+--------+
| timestamp           | userid |
+---------------------+--------+
| 2012-12-04 00:00:00 |    102 |
| 2012-12-05 00:00:00 |    101 |
| 2012-12-05 00:00:00 |    102 |
| 2012-12-05 00:00:00 |    103 |
| 2012-12-07 00:00:00 |    101 |
| 2012-12-07 00:00:00 |    102 |
| 2012-12-07 00:00:00 |    103 |
| 2012-12-08 00:00:00 |    101 |
| 2012-12-08 00:00:00 |    102 |
| 2012-12-08 00:00:00 |    103 |
| 2012-12-08 00:00:00 |    104 |
+---------------------+--------+ 
```

所以在最后的查询中，我们所做的就是在按日期分组时对这个结果进行计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:27:24.487

假设我了解您的要求，您是否希望返回他们首次出现的日期和用户数量？

```
SELECT TimeStamp, COUNT(*) 
FROM T JOIN (
   SELECT MIN(TimeStamp) minDate, UserId
   FROM t 
   GROUP BY UserId) T2 ON T.TimeStamp = T2.minDate AnD T.UserId = T2.UserId
GROUP BY T.TimeStamp 
```

还有小提琴：[http ://sqlfiddle.com/#!2/c1f5a/9](http://sqlfiddle.com/#!2/c1f5a/9)

祝你好运。

# qt - PyQt QWebkit Javascript Function.bind 不存在（ECMAScript 5 缺少函数）

> ID：14693946
> 
> 赞同：3
> 
> 时间：2013-02-04T19:22:17.867
> 
> 标签：qt, pyqt, qtwebkit, ecmascript-5, qwebkit

Web 应用程序中的 Javascript 运行以下循环：

```
 for (var name in this) {
        if(typeof(this[name]) == "function") {
            if((/^on_|^do_/).test(name)) {
        console.debug("Adding ", name, " to ", this, "(", this[name], ")");
                f = this[name].bind;
        console.debug(f);
                this[name] = this[name].bind(this);
            }
        }
    } 
```

在 Chrome 24.0.1312.56 下，该行`f = this[name].bind`正确地将 f 设置为 native code `function.bind()`，而在我的 QWebKit Qt 应用程序中，它将 f 设置为“未定义”。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)

知道我如何能够说服 QtWebkit 在这里表现正确吗？

* * *

显然，Function.prototype.bind 是 ECMAScript 5 的一部分。它在 webkit 中的实现应包含在（已修复的错误）：[https ://bugs.webkit.org/show_bug.cgi?id=26382](https://bugs.webkit.org/show_bug.cgi?id=26382)

也许有一种模式可以启用我缺少的 ECMAScript 5？

* * *

显然我正在为 QtWebkit 使用 534.34 版本：

(Pdb) str(QtWebKit.qWebKitVersion()) '534.34'

根据这个： [https ://trac.webkit.org/changeset/85696/trunk/Source/WebKit/mac/Configurations/Version.xcconfig](https://trac.webkit.org/changeset/85696/trunk/Source/WebKit/mac/Configurations/Version.xcconfig)

对应于修订版 85696。结合上述错误中的评论（“在 r95751 中修复”），似乎我需要一个更新的版本，特别是比 535.5 更好的版本。现在要查找 PyQt 使用哪个版本...

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T20:13:55.140

似乎最新版本的 PyQt (4.9.6-1) 是针对 wekbit 版本 534.34 编译的。支持 Function.prototype.bind 的 webkit 的第一个版本是 535.5。

此外，PySite 1.2.2 和 PyQt 4.9.6-1 似乎都报告了 webkit 版本 535.34，并且没有 Function.prototype.bind。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-04T19:42:26.673

尝试使用以下代码强制您使用`Function.prototype.bind`

```
this[name] = Function.prototype.bind.call(this[name], this) 
```

在 IE 中，一些宿主对象的方法（函数）上没有绑定方法......可能是相关的。

# ruby - 通过合并数组创建嵌套数组 (2D)

> ID：14693952
> 
> 赞同：-2
> 
> 时间：2013-02-04T19:22:48.260
> 
> 标签：ruby, arrays, nested

> **可能重复：**
> [Ruby 中两个数组的组合](https://stackoverflow.com/questions/1543614/combination-of-two-arrays-in-ruby)

```
Faces = "Two Three Four Five Six Seven Eight Nine Ten Jack Queen King Ace"
Suits = "Spades Clubs Hearts Diamonds"
Face = []
Face = Faces.split * 4
Suits.split 
```

我正在寻求将`suits.split` `array`每件西装放入并输入 13 次`Face`以创建一个看起来像的 2D 数组`[["Two", "Spades"],["Three", "Spades"]... ["Ace", "Diamonds"]]`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T19:30:48.267

正如 Sunny 链接的问题中所发布的那样，您正在寻找`product`：

```
Faces.product Suits 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:32:07.607

通常，变量的形式应为`snake_case`和 中的常量`SCREAMING_SNAKE_CASE`。很难说你是想创建常量还是变量。

您还可以使用更简单的方式实例化您的数组`%w{elements here}`。

浏览[文档](http://www.ruby-doc.org/core-1.9.3/Array.html)以了解这里发生了什么。

```
faces = %w{Two Three Four Five Six Seven Eight Nine Ten Jack Queen King Ace}
 => ["Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Jack", "Queen", "King", "Ace"] 
suites = %w{Spades Clubs Hearts Diamonds}
 => ["Spades", "Clubs", "Hearts", "Diamonds"] 
 faces.product(suites)
 => [["Two", "Spades"], ["Two", "Clubs"], ["Two", "Hearts"], ["Two", "Diamonds"], ["Three", "Spades"], ["Three", "Clubs"], ["Three", "Hearts"], ["Three", "Diamonds"], ["Four", "Spades"], ["Four", "Clubs"], ["Four", "Hearts"], ["Four", "Diamonds"], ["Five", "Spades"], ["Five", "Clubs"], ["Five", "Hearts"], ["Five", "Diamonds"], ["Six", "Spades"], ["Six", "Clubs"], ["Six", "Hearts"], ["Six", "Diamonds"], ["Seven", "Spades"], ["Seven", "Clubs"], ["Seven", "Hearts"], ["Seven", "Diamonds"], ["Eight", "Spades"], ["Eight", "Clubs"], ["Eight", "Hearts"], ["Eight", "Diamonds"], ["Nine", "Spades"], ["Nine", "Clubs"], ["Nine", "Hearts"], ["Nine", "Diamonds"], ["Ten", "Spades"], ["Ten", "Clubs"], ["Ten", "Hearts"], ["Ten", "Diamonds"], ["Jack", "Spades"], ["Jack", "Clubs"], ["Jack", "Hearts"], ["Jack", "Diamonds"], ["Queen", "Spades"], ["Queen", "Clubs"], ["Queen", "Hearts"], ["Queen", "Diamonds"], ["King", "Spades"], ["King", "Clubs"], ["King", "Hearts"], ["King", "Diamonds"], ["Ace", "Spades"], ["Ace", "Clubs"], ["Ace", "Hearts"], ["Ace", "Diamonds"]] 
```

请记住，产品仅在 Ruby 1.9 >= 中可用。

# asp.net - 删除在运行时填充的 ASP.Net asp:Table 的所有标题和行

> ID：14693954
> 
> 赞同：1
> 
> 时间：2013-02-04T19:22:56.803
> 
> 标签：asp.net, vb.net, code-behind

我们想删除在运行时填充的 ASP.Net asp:Table 的所有标题和行，现在正在 Web 表单上显示。

这可以做到吗？

如果可以，请显示将执行此操作的代码隐藏编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:26:25.277

你在找[`TableRowCollection.Clear`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.tablerowcollection.clear.aspx)吗？

```
table.Rows.Clear() 
```

这将从表中删除所有`TableRow`s（包括[`TableHeaderRow`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.tableheaderrow%28v=vs.110%29.aspx)和[`TableFooterRow`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.tablefooterrow%28v=vs.80%29.aspx)）。

# vim - vim-powerline：自定义状态行以在缓冲区中有修改的文件时显示指示器

> ID：14693955
> 
> 赞同：1
> 
> 时间：2013-02-04T19:22:59.580
> 
> 标签：vim, vim-powerline

我使用[vim-powerline](https://github.com/Lokaltog/vim-powerline)插件来自定义 vim 状态行。到目前为止，`+`当当前缓冲区被修改时，状态行会显示一个。当我切换到未修改的缓冲区时，我无法再判断项目中是否有修改的缓冲区。目前，我使用`:files`or`:buffers`命令来定位修改后的缓冲区。

是否可以自定义状态行以在缓冲区中有修改的文件时显示指示器（即使缓冲区不是当前的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T10:49:31.040

这是一个好主意，实施起来应该不会太难。我建议您切换到[新的 Powerline 项目](https://github.com/Lokaltog/powerline)，并在那里的问题跟踪器中提交问题。我不跟进其他地方发布的问题，所以请使用官方问题跟踪器。

# r - 随着数据框变大，如何防止 rbind() 变得非常慢？

> ID：14693956
> 
> 赞同：11
> 
> 时间：2013-02-04T19:22:59.850
> 
> 标签：r, performance, dataframe, append, rbind

我有一个只有 1 行的数据框。为此，我开始使用 rbind 添加行

```
df #mydataframe with only one row
for (i in 1:20000)
{
    df<- rbind(df, newrow)

} 
```

随着我的成长，这变得非常缓慢。这是为什么？以及如何使这种类型的代码更快？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-04T19:32:38.970

您处于[地狱的第二圈](http://www.burns-stat.com/pages/Tutor/R_inferno.pdf)，即未能预先分配数据结构。

以这种方式增长对象在 R 中是一件非常非常糟糕的事情。预分配和插入：

```
df <- data.frame(x = rep(NA,20000),y = rep(NA,20000)) 
```

或重组您的代码以避免这种增量添加行。正如我在引用的链接中所讨论的那样，速度缓慢的原因是每次添加一行时，R 都需要找到一个新的连续内存块来适应数据框。大量复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T22:22:40.403

我尝试了一个例子。对于它的价值，它同意用户的断言，即在数据框中插入行也很慢。我不太明白发生了什么，因为我预计分配问题会超过复制速度。任何人都可以复制这个，或者解释为什么下面的结果（rbind < appending < insert）通常是正确的，或者解释为什么这不是一个有代表性的例子（例如数据框太小）？

**编辑**：我第一次忘记将对象初始化`hell2fun`为数据帧，因此代码执行矩阵运算而不是数据帧运算，这*要快得多*。如果有机会，我会将比较扩展到数据框与矩阵。但是，第一段中的定性断言仍然成立。

```
N <- 1000
set.seed(101)
r <- matrix(runif(2*N),ncol=2)

## second circle of hell
hell2fun <- function() {
    df <- as.data.frame(rbind(r[1,])) ## initialize
    for (i in 2:N) {
        df <- rbind(df,r[i,])
    }
}

insertfun <- function() {
    df <- data.frame(x=rep(NA,N),y=rep(NA,N))
    for (i in 1:N) {
        df[i,] <- r[i,]
    }
}

rsplit <- as.list(as.data.frame(t(r)))
rbindfun <-  function() {
    do.call(rbind,rsplit)
}

library(rbenchmark)
benchmark(hell2fun(),insertfun(),rbindfun())

##          test replications elapsed relative user.self 
## 1  hell2fun()          100  32.439  484.164    31.778 
## 2 insertfun()          100  45.486  678.896    42.978 
## 3  rbindfun()          100   0.067    1.000     0.076 
```

# javascript - Soundcloud 是否有一个 Javascript 监听器，用于加载新数据？

> ID：14693958
> 
> 赞同：0
> 
> 时间：2013-02-04T19:23:16.820
> 
> 标签：javascript, listener, soundcloud

无论如何，当 Soundcloud API 请求更多信息时，是否可以创建一个 Javascript 侦听器。我有一个框架，我在其中使用标准 Soundcloud 页面（如流），并且想知道是否有任何方法可以创建 Javascript 侦听器以在将更多信息加载到框架中时侦听 GET 请求。当框架中加载新信息时，我想在主页中触发一个偶数。

我已经尝试过标准的 XMLHttpRequest 覆盖技术，但这似乎不适用于框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:28:04.827

如果您可以在 SC 文档上添加事件侦听器，请尝试： `document.addEventListener("DOMNodeInserted", callback);`

# c# - XMLWorker 只生成一页

> ID：14693959
> 
> 赞同：1
> 
> 时间：2013-02-04T19:23:17.983
> 
> 标签：c#, asp.net, itext

我正在使用 iTextSharp 5.3.0.0、XmlWorker 1.1.4.0 和 Asp.Net C# 3.5 从带有 ListView 和其他基本控件的 UserControl 呈现的 HTML 生成 PDF。

我已经有一个 PDF 文件，但它只呈现第一页，即使内容需要更多。

有什么建议么？

```
public void GeneratePdf()
{
    ////reset response
    HttpContext.Current.Response.Clear();
    HttpContext.Current.Response.ContentType = "application/pdf";

    ////define pdf filename
    string strFileName = "newFile.pdf";
    HttpContext.Current.Response.AddHeader("content-disposition", "attachment; filename=" + strFileName);

    //get html
    string outXml = [A HTML from a UserControl];

    //Generate PDF
    using (Document document = new Document(PageSize.A4, 30, 30, 30, 30))
    {
        //define output control HTML
        MemoryStream memStream = new MemoryStream();
        TextReader xmlString = new StringReader(outXml);

        PdfWriter writer = PdfWriter.GetInstance(document, memStream);

        //open doc
        document.Open();

        HtmlPipelineContext htmlContext = new HtmlPipelineContext(null);
        htmlContext.SetTagFactory(Tags.GetHtmlTagProcessorFactory());
        htmlContext.SetImageProvider(new ImageProvider());

        ICSSResolver cssResolver = XMLWorkerHelper.GetInstance().GetDefaultCssResolver(false);
        cssResolver.AddCssFile(Server.MapPath("~/css/style.css"), true);

        IPipeline pipeline = new CssResolverPipeline(cssResolver, new HtmlPipeline(htmlContext, new PdfWriterPipeline(document, writer)));
        XMLWorker worker = new XMLWorker(pipeline, true);
        XMLParser xmlParse = new XMLParser(true, worker);
        xmlParse.Parse(xmlString);
        xmlParse.Flush();

        document.Close();
        document.Dispose();

        HttpContext.Current.Response.BinaryWrite(memStream.ToArray());
    }

    HttpContext.Current.Response.End();
    HttpContext.Current.Response.Flush();
}

/// <summary>
/// Custom ImageProvider
/// </summary>
public class ImageProvider : AbstractImageProvider
{
    public ImageProvider() { }
    public override string GetImageRootPath()
    {
        return "/";
    }
} 
```

# javascript - Javascript XML 文档正则表达式

> ID：14693960
> 
> 赞同：0
> 
> 时间：2013-02-04T19:23:23.960
> 
> 标签：javascript, xml, regex

我正在创建一个小型库，用于解析 Javascript 文件中的 XML 文档，格式如下：

```
/// <doc type="function" name="parse">
///     <summary>Parses javascript documentation</summary>
///     <param name="js" type="string">Javascript input</param>
/// </doc>
var parse = function(js) { ... };

/// <doc type="string">
///   <summary>Holding the version of our library</summary>
/// </doc>
var VERSION = '0.0.1'; 
```

我必须创建一个正则表达式来返回 and 标记之间的内容。我尝试了以下正则表达式，但失败了：

```
var xmlComments = js.match(/ \/\/\/(\s)<doc(.*)>(.*)<\/doc>/gi /); 
```

但是匹配不起作用，我希望有人可以帮助我解决这个正则表达式，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T23:03:31.717

如果您试图获取开始标签和结束`doc`标签之间的内容，您可以使用

```
/<doc[^>]*>([\s\S]+?)<\/doc>/gi 
```

`[\s\S]`包括换行符在内的任何字符在哪里（`.`将不匹配换行符）。

例如

```
var xmlComments = [],
    regex = /<doc[^>]*>([\s\S]+?)<\/doc>/gi,
    match = regex.exec( js );

while ( match != null ) {
    xmlComments.push( match[1] );
    match = regex.exec( js );
} 
```

`js`作为字符串的文件在哪里。

# php - Symfony 2：从命令内部访问更新的配置

> ID：14693963
> 
> 赞同：7
> 
> 时间：2013-02-04T19:23:26.823
> 
> 标签：php, symfony, doctrine-orm, symfony-2.1

我们正在创建一个命令，该命令依赖于其他命令来生成新数据库并构建其架构。到目前为止，我们已经成功地让它读取 config.yml 文件，添加我们的新连接信息，并将文件写回。在同一个命令中，我们尝试运行 symfony 命令来创建数据库和 schema:update。这就是我们遇到问题的地方。我们收到以下错误：

> [InvalidArgumentException] 名为“mynewdatabase”的 Doctrine ORM 管理器不存在。

如果我们再次运行该命令，则不会出现错误，因为更新的配置文件是新加载到应用程序中的。如果我们在写入 config.yml 文件后手动运行学说命令，它也可以正常工作。

我们认为，在我们运行数据库创建和更新命令的命令中，它仍在使用存储在内存中的当前内核版本的 config.yml/database.yml。我们尝试了许多不同的方法来重新初始化应用程序/内核配置（调用 shutdown()、boot() 等），但都没有成功。这是代码：

```
namespace Test\MyBundle\Command;

use Symfony\Bundle\FrameworkBundle\Command\ContainerAwareCommand;
use Symfony\Component\Console\Input\InputArgument;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Input\InputOption;
use Symfony\Component\Console\Input\ArrayInput;
use Symfony\Component\Console\Output\OutputInterface;
use Symfony\Component\Yaml\Yaml;

class GeneratorCommand extends ContainerAwareCommand
{
    protected function configure()
    {
        $this
           ->setName('generate')
           ->setDescription('Create a new database.')
           ->addArgument('dbname', InputArgument::REQUIRED, 'The db name')
        ;
    }

   /*
      example: php app/console generate mynewdatabase
   */
   protected function execute(InputInterface $input, OutputInterface $output)
   {
      //Without this, the doctrine commands will prematurely end execution
      $this->getApplication()->setAutoExit(false);

      //Open up app/config/config.yml
      $yaml = Yaml::parse(file_get_contents($this->getContainer()->get('kernel')->getRootDir() .'/config/config.yml'));

      //Take input dbname and use it to name the database
      $db_name = $input->getArgument('dbname');

      //Add that connection to app/config/config.yml
      $yaml['doctrine']['dbal']['connections'][$site_name] = Array('driver' => '%database_driver%', 'host' => '%database_host%', 'port' => '%database_port%', 'dbname' => $site_name, 'user' => '%database_user%', 'password' => '%database_password%', 'charset' => 'UTF8');
      $yaml['doctrine']['orm']['entity_managers'][$site_name] = Array('connection' => $site_name, 'mappings' => Array('MyCustomerBundle' => null));

      //Now put it back
      $new_yaml = Yaml::dump($yaml, 5);
      file_put_contents($this->getContainer()->get('kernel')->getRootDir() .'/config/config.yml', $new_yaml);

      /* http://symfony.com/doc/current/components/console/introduction.html#calling-an-existing-command */

      //Set up our db create script arguments
      $args = array(
         'command'      => 'doctrine:database:create',
         '--connection'   => $site_name,
      );
      $db_create_input = new ArrayInput($args);

      //Run the symfony database create arguments
      $this->getApplication()->run($db_create_input, $output);

      //Set up our schema update script arguments
      $args = array(
         'command'   => 'doctrine:schema:update',
         '--em'      => $site_name,
         '--force'   => true
      );
      $update_schema_input = new ArrayInput($args);

      //Run the symfony database create command
      $this->getApplication()->run($update_schema_input, $output);
   }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T23:07:11.010

这不起作用的原因是因为 DIC 经历了一个编译过程，然后被写入一个 PHP 文件，然后该文件被包含到当前运行的进程中。你可以在这里看到：

[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpKernel/Kernel.php#L562](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpKernel/Kernel.php#L562)

如果您更改服务定义，然后尝试“重新启动”内核以编译这些更改，它将不会再次包含已编译的文件 (require_once)，它只会创建已包含的 DIC 类的另一个实例与旧编译服务定义。

我能想到的最简单的解决方法是创建一个空的 Kernel 类来简单地扩展您的 AppKernel。像这样：

```
<?php

namespace Test\MyBundle\Command;

class FakeKernel extends \AppKernel
{
} 
```

然后在您的命令中，您可以在保存新服务定义后启动此内核，它将使用“FakeKernel”名称作为文件名的一部分重新编译一个新的 DIC 类，这意味着它将**被**包含在内。像这样：

```
$kernel = new \Test\MyBundle\Command\FakeKernel($input->getOption('env'), true);
$application = new \Symfony\Bundle\FrameworkBundle\Console\Application($kernel); 
```

然后，您针对将与新 DIC 一起运行的新应用程序运行您的子命令：

```
$application->run($db_create_input, $output); 
```

*免责声明：这感觉很hacky。我愿意听取其他解决方案/解决方法。*

# php - 使用 UTF-8 编码的文本

> ID：14693965
> 
> 赞同：0
> 
> 时间：2013-02-04T19:23:28.097
> 
> 标签：php, utf-8, utf-16

我有个问题。我需要从我的文本文件中找到一些 utf-8 字符并输出它们，但它不输出字母，而是输出“？”，问号......

```
ini_set( 'default_charset', 'UTF-8' );
$homepage = file_get_contents('t1.txt');
echo $homepage;
echo "\t";
echo "\t!!!!!!!!!!!!"; 
echo $homepage[14]; 
```

所以，这很奇怪，如果我使用现有索引它什么都不输出，但是如果我把

```
echo $homepage[35]; 
```

它输出“？”，但我的 $homepage 字符串只有 30 个字符长，怎么了？

很奇怪，它正确地从文件中获取字符串，并正确输出，但是当我按索引调用字符时，它不起作用..这是我的文本文件中的内容： **advhasgdvgv олыолоываи ouhh**

并且它正确输出它，当我只是调用 $homepage 时，但是当 $homepage[14] 它不起作用。这里是输出：

**advhasgdvgv олыолоываи ouhh !!!!!!!!!!!!**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:11:10.330

PHP 并不真正支持字符串中的 UTF-8，这意味着访问 text[n] 将获得第 n 个字节而不是第 n 个字符。UTF-8 字符中可能有 1-4 个字节，这意味着您根本无法使用 PHP 通过索引访问它们，因为您不知道字符从哪个索引开始。此外，您显然无法使用 text[n] 检索字符，因为它可能需要多个字节。

根据您的需要，您可以使用 utf8_decode() 将字符串转换为 ISO 8859，或者使用一些 UTF-8 感知机制从头开始遍历字符串并提取您想要/需要的字节。

请注意，Linux 和 Windows 版本的 PHP 可能会在某些转换时产生不同的输出，例如 mb_strtoupper()，并且并非所有正则表达式函数都支持 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:29:58.070

试试看`mb_convert_encoding`，看看能不能解决问题。

[http://www.php.net/manual/en/function.mb-convert-encoding.php](http://www.php.net/manual/en/function.mb-convert-encoding.php)

`string mb_convert_encoding ( string $str , string $to_encoding [, mixed $from_encoding ] )`

```
$homepage = mb_convert_encoding(
    file_get_contents('t1.txt'),
    "UTF-8"
); 
```

您还应该检查 PHP 文件和那里的文本文件的编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T20:04:23.760

Unicode 字符的每个字母超过 1 个字节，因此您必须执行以下操作才能访问它们：

```
echo $homepage[30] . $homepage[31];
> и 
```

但这是假设字符只有 2 个字节，但可能还有更多；所以更通用的解决方案是：

```
function charAt($str, $pos, $encoding = "UTF-8")
{
    return mb_substr($str, $pos, 1, $encoding);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T19:53:14.587

我使用这种方法来处理 UTF-8：

```
<?php
$string = 'ئاکام';//my name
mb_internal_encoding("UTF-8");
$mystring = mb_substr($string,0,1);ئ
//without mb_internal_encoding the return was Ø
echo $mystring;
?> 
```

我还保存了所有文件（编码为 UTF-8）

# java - 短信接收器 - 每次收到短信时强制关闭

> ID：14693966
> 
> 赞同：0
> 
> 时间：2013-02-04T19:23:28.133
> 
> 标签：java, android, gps, sms

我正在尝试使用 SMS 作为激活器来创建手机定位器，但是当我向手机发送短信时，应用程序总是崩溃（强制关闭）：

这是我的课程代码：

```
public class SMSReceiver extends BroadcastReceiver{
        private static final String FAR_MODE_KEY = "farmode";
        private String FarModeKeyword;

        @Override
        public void onReceive(Context context, Intent intent) {

            prefs = getSharedPreferences(Keywords, MODE_PRIVATE);
            FarModeKeyword = prefs.getString(FAR_MODE_KEY, "");

            //---get the SMS message passed in---
            Bundle bundle = intent.getExtras();
            SmsMessage[] msgs = null;
            String message = "";
            String number = "";
            if (bundle != null)
            {
                //---retrieve the SMS message received---
                Object[] pdus = (Object[]) bundle.get("pdus");
                msgs = new SmsMessage[pdus.length];
                for (int i=0; i<msgs.length; i++)
                {
                    msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);
                    message += msgs[i].getMessageBody().toString();
                }

                for (int i=0; i<msgs.length; i++)
                {
                    msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);
                    number += msgs[i].getOriginatingAddress();
                }

            }

            if (message == FarModeKeyword)
            {
                Toast.makeText(getBaseContext(),
                        message,
                        Toast.LENGTH_SHORT).show();
                String loc = "";
                loc = getLocation();
                Toast.makeText(getBaseContext(),
                        loc,
                        Toast.LENGTH_SHORT).show();
                sendSMS(number, loc);
            }

        }

        private void sendSMS(String phoneNumber, String message)
        {
            SmsManager sms = SmsManager.getDefault();
            sms.sendTextMessage(phoneNumber, null, message, null, null);
        }

        private String getLocation ()
        {
            // Get the location manager
            LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
            Criteria criteria = new Criteria ();
            String bestProvider = locationManager.getBestProvider(criteria, false);
            Location location = locationManager.getLastKnownLocation(bestProvider);

            LocationListener MyLocListener = new loc_listener();
            locationManager.requestLocationUpdates(bestProvider, 1000, 1, MyLocListener); 

            String add = "";

            Geocoder geoCoder = new Geocoder(getBaseContext(), Locale.getDefault());
            try 
            {
                List<Address> addresses = geoCoder.getFromLocation(lat,lon, 1);

                if (addresses.size() > 0)
                {
                    for (int i=0; i<addresses.get(0).getMaxAddressLineIndex();i++)
                    add += addresses.get(0).getAddressLine(i) + "\n";
                }

            }
            catch (IOException e) 
            {
                e.printStackTrace();
            }

            locationManager.removeUpdates(MyLocListener);
            return add;

        }

        public class loc_listener implements LocationListener
        {     
              public void onLocationChanged(Location l) {
                  lat = l.getLatitude();
                  lon = l.getLongitude();         
              }
              public void onProviderEnabled(String p) {
              }

              public void onProviderDisabled(String p) {
              }

              public void onStatusChanged(String p, int status, Bundle extras){
              }      
        }
    } 
```

这是清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="locateodroid.james"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <uses-feature
      android:glEsVersion="0x00020000"
      android:required="true"/>

    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="android.permission.SEND_SMS" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    <uses-permission android:name="android.permission.READ_SMS" />
    <uses-permission android:name="locateodroid.james.permission.MAPS_RECEIVE"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="AIzaSyBBo4h4fDksXasHd7iCgIg0A5wTriToW8w"/>

     <permission
          android:name="locateodroid.james.permission.MAPS_RECEIVE"
          android:protectionLevel="signature"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

        <activity
            android:name="locateodroid.james.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <receiver
            android:name=".receiver.StartMyServiceAtBootReceiver"
            android:enabled="true"
            android:exported="true"
            class="locateodroid.james.receiver.StartMyServiceAtBootReceiver"
            android:label="StartMyServiceAtBootReceiver">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED" />
            </intent-filter>
        </receiver>

        <receiver android:name="locateodroid.james.sms.SMSReceiver"
            class="locateodroid.james.sms.SmsReceiver"
            android:label="SMSReceiver">
            <intent-filter android:priority="2147483647">
                <action android:name="android.provider.Telephony.SMS_RECEIVED" />
            </intent-filter>
        </receiver>

    </application>

</manifest> 
```

这是错误的logcat：

```
 02-05 04:03:25.169: E/AndroidRuntime(430): FATAL EXCEPTION: main
02-05 04:03:25.169: E/AndroidRuntime(430): java.lang.RuntimeException: Unable to instantiate receiver locateodroid.james.sms.SMSReceiver: java.lang.ClassNotFoundException: locateodroid.james.sms.SMSReceiver in loader dalvik.system.PathClassLoader[/data/app/locateodroid.james-1.apk]
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.app.ActivityThread.handleReceiver(ActivityThread.java:1773)
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.app.ActivityThread.access$2400(ActivityThread.java:117)
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:981)
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.os.Looper.loop(Looper.java:123)
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.app.ActivityThread.main(ActivityThread.java:3683)
02-05 04:03:25.169: E/AndroidRuntime(430):  at java.lang.reflect.Method.invokeNative(Native Method)
02-05 04:03:25.169: E/AndroidRuntime(430):  at java.lang.reflect.Method.invoke(Method.java:507)
02-05 04:03:25.169: E/AndroidRuntime(430):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-05 04:03:25.169: E/AndroidRuntime(430):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-05 04:03:25.169: E/AndroidRuntime(430):  at dalvik.system.NativeStart.main(Native Method)
02-05 04:03:25.169: E/AndroidRuntime(430): Caused by: java.lang.ClassNotFoundException: locateodroid.james.sms.SMSReceiver in loader dalvik.system.PathClassLoader[/data/app/locateodroid.james-1.apk]
02-05 04:03:25.169: E/AndroidRuntime(430):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
02-05 04:03:25.169: E/AndroidRuntime(430):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
02-05 04:03:25.169: E/AndroidRuntime(430):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
02-05 04:03:25.169: E/AndroidRuntime(430):  at android.app.ActivityThread.handleReceiver(ActivityThread.java:1764)
02-05 04:03:25.169: E/AndroidRuntime(430):  ... 10 more 
```

我在这个错误上工作了将近 2 天，但我仍然没有答案，有人可以帮我解决这个问题吗？提前致谢！

**更新**

第一个问题现在已经解决了，但是另一个错误是，当我收到一条短信时抛出了 NullPointerException

```
package locateodroid.james;

import java.io.IOException;
import java.util.List;
import java.util.Locale;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.location.Address;
import android.location.Criteria;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.telephony.SmsMessage;
import android.widget.EditText;
import android.widget.Toast;

public class SMSReceiver extends BroadcastReceiver{

    public SharedPreferences prefs;
    private String FarModeKeyword;
    private String Keywords = "prefmode";
    private Double lat;
    private Double lon;
    private static final String FAR_MODE_KEY = "farmode";
    private Context con;

    @Override
    public void onReceive(Context context, Intent intent) {

        Toast.makeText(context,
                "test",
                Toast.LENGTH_SHORT).show();
        con = context;
        prefs = getSharedPreferences(Keywords, Context.MODE_PRIVATE);
        FarModeKeyword = prefs.getString(FAR_MODE_KEY, "");

        //---get the SMS message passed in---
        Bundle bundle = intent.getExtras();
        SmsMessage[] msgs = null;
        String message = "";
        String number = "";
        if (bundle != null)
        {
            //---retrieve the SMS message received---
            Object[] pdus = (Object[]) bundle.get("pdus");
            msgs = new SmsMessage[pdus.length];
            for (int i=0; i<msgs.length; i++)
            {
                msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);
                message += msgs[i].getMessageBody().toString();
            }

            for (int i=0; i<msgs.length; i++)
            {
                msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);
                number += msgs[i].getOriginatingAddress();
            }

        }

        if (message == FarModeKeyword)
        {
            Toast.makeText(context,
                    message,
                    Toast.LENGTH_SHORT).show();
            String loc = "";
            loc = getLocation();
            Toast.makeText(context,
                    loc,
                    Toast.LENGTH_SHORT).show();
            sendSMS(number, loc);
        }

    }

    private SharedPreferences getSharedPreferences(String keywords2,
            int modePrivate) {
        // TODO Auto-generated method stub
        return null;
    }

    private void sendSMS(String phoneNumber, String message)
    {
        SmsManager sms = SmsManager.getDefault();
        sms.sendTextMessage(phoneNumber, null, message, null, null);
    }

    private String getLocation ()
    {
        // Get the location manager
        LocationManager locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        Criteria criteria = new Criteria ();
        String bestProvider = locationManager.getBestProvider(criteria, false);
        Location location = locationManager.getLastKnownLocation(bestProvider);

        LocationListener MyLocListener = new loc_listener();
        locationManager.requestLocationUpdates(bestProvider, 1000, 1, MyLocListener); 

        String add = "";

        Geocoder geoCoder = new Geocoder(con, Locale.getDefault());
        try 
        {
            List<Address> addresses = geoCoder.getFromLocation(lat,lon, 1);

            if (addresses.size() > 0)
            {
                for (int i=0; i<addresses.get(0).getMaxAddressLineIndex();i++)
                add += addresses.get(0).getAddressLine(i) + "\n";
            }

        }
        catch (IOException e) 
        {
            e.printStackTrace();
        }

        locationManager.removeUpdates(MyLocListener);
        return add;

    }

    private LocationManager getSystemService(String locationService) {
        // TODO Auto-generated method stub
        return null;
    }

    public class loc_listener implements LocationListener
    {     
          public void onLocationChanged(Location l) {
              lat = l.getLatitude();
              lon = l.getLongitude();         
          }
          public void onProviderEnabled(String p) {
          }

          public void onProviderDisabled(String p) {
          }

          public void onStatusChanged(String p, int status, Bundle extras) {
          }      
    }
} 
```

该类现在返回 NullPointerException 错误:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:12:22.883

它无法找到类：

```
Caused by: java.lang.ClassNotFoundException: locateodroid.james.sms.SMSReceiver 
```

你确定包参考吗？

这很可能来自您的接收者的班级行：

```
class="locateodroid.james.sms.SmsReceiver" 
```

## 更新

您不能使用这些上下文属性的原因是因为它们是**STATIC**常量

这意味着您从基类中获取它们（不需要实例），如下所示：

```
Context.MODE_PRIVATE 
```

# actionscript-3 - Flash 中的多人游戏开发

> ID：14693968
> 
> 赞同：1
> 
> 时间：2013-02-04T19:23:36.990
> 
> 标签：actionscript-3, flash, red5, multiplayer

在你说它是这个问题的转贴之前 -[多人游戏开发的 Flash Media Server 的替代品](https://stackoverflow.com/questions/190802/alternatives-to-flash-media-server-for-multiplayer-game-development)，它略有不同，因为我问的是利弊。

我想知道我应该为我的特定 Flash 游戏使用哪个服务器。我正在制作一个名为 mathlympics 的游戏。这个想法是玩家必须回答简​​单的算术问题。他回答问题的速度越快，他的运动员跑得越快。我正在使用 away3d 引擎为 flash 制作游戏 3d。[可以在此处看到类似的 2d](http://www.youtube.com/watch?v=CIgIinS8hB8)示例

我想把我的游戏做成多人游戏，这样不同的玩家就可以同时进行现场对战。

现在我想知道不同引擎的优缺点。

*   红5
*   播放器.io
*   amfPHP（在这个问题上建议 - [AS3:Multiplayer Game by using AS3 with PHP?](https://stackoverflow.com/questions/14691784/as3multiplayer-game-by-using-as3-with-php)）
*   斯波格
*   联盟

我不知道哪个最好。各有什么优缺点。哪一个最容易使用，哪一个最适合我的游戏？如果有任何其他引擎可能与我更相关，那么请随意建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:01:28.233

查看我最近对您上面提到的问题的帖子。它是在几分钟前添加的。它可能有一些很好的见解..

[AS3：使用 AS3 和 PHP 的多人游戏？](https://stackoverflow.com/questions/14691784/as3multiplayer-game-by-using-as3-with-php/14694337#14694337)

# sql-server - 子查询错误信息

> ID：14693973
> 
> 赞同：-1
> 
> 时间：2013-02-04T19:23:56.427
> 
> 标签：sql-server

执行查询时遇到以下错误消息。一位成员建议我检查子查询的别名。我做到了，他们似乎在排队。

各位大神能不能给点思路？谢谢你。

**在预期条件的上下文中指定的非布尔类型的表达式，靠近 ')'。**

```
Select CLINIC_ID,SUMMARY_CATGRY,ENTRY_TYPE,
SUM(case when EntryMonth = 1 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Jan12],
SUM(case when EntryMonth = 2 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Feb12],
SUM(case when EntryMonth = 3 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Mar12],
SUM(case when EntryMonth = 4 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Apr12],
SUM(case when EntryMonth = 5 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [May12],
SUM(case when EntryMonth = 6 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Jun12],
SUM(case when EntryMonth = 7 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Jul12],
SUM(case when EntryMonth = 8 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Aug12],
SUM(case when EntryMonth = 9 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Sep12],
SUM(case when EntryMonth = 10 and EntryYear = 2012 then [sumofentry_amount] else 0 end)[Oct12],
SUM(case when EntryMonth = 11 and EntryYear = 2012 then [sumofentry_amount] else 0 end)[Nov12],
SUM(case when EntryMonth = 12 and EntryYear = 2012 then [sumofentry_amount] else 0 end)[Dec12],
SUM(case when EntryYear = 2012 then [sumofentry_amount] else 0 end) [2012YTD],
SUM(case when EntryYear = 2011 then [sumofentry_amount] else 0 end) [2011YTD]
From
(
    SELECT [Non_Recurring_Clinic_Step1].CLINIC_ID, 
        dbo_HR_FINAN_CLASS.SUMMARY_CATGRY, 
        [TABLE_LAYOUT].ENTRY_TYPE, 
        datepart(month,[entry_date]) EntryMonth,
        datepart(year,[entry_date]) EntryYear,
        [sumofentry_amount]

 FROM [TABLE_LAYOUT]
 Inner Join

(
SELECT [GROUPING_OF_CLINIC_ID].CLINIC_ID, OUTPAT_ACCT_REC.CHARGE_CLASS,[GROUPING_OF_CLINIC_ID].PATIENT_NUMBER, [GROUPING_OF_CLINIC_ID].REGISTRATION_CD, OUTPAT_REGISTER.PRIMARY_FINAN,   Replace(CONVERT(VARCHAR(10),OUTPAT_ACCT_REC.ENTRY_DATE,101), '/', '') AS ENTRY_DATE, SUM(ENTRY_AMOUNT) AS ENTRY_AMOUNT 

FROM
OUTPAT_REGISTER
Left JOIN
OUTPAT_BILL_REF
ON(OUTPAT_REGISTER.PATIENT_NUMBER = OUTPAT_BILL_REF.PATIENT_NUMBER)
AND(OUTPAT_REGISTER.REGISTRATION_CD = OUTPAT_BILL_REF.REGISTRATION_CD)

Left JOIN
OUTPAT_ACCT_REC
ON(OUTPAT_BILL_REF.PATIENT_NUMBER = OUTPAT_ACCT_REC.PATIENT_NUMBER)
AND(OUTPAT_BILL_REF.BILL_REFERENCE = OUTPAT_ACCT_REC.REFERENCE_NUM)

Left JOIN
    (
SELECT CLINIC_ID, PATIENT_NUMBER, REGISTRATION_CD
FROM OP_VISIT_HISTRY
GROUP BY CLINIC_ID, PATIENT_NUMBER, REGISTRATION_CD
--ORDER BY CLINIC_ID
)AS [GROUPING_OF_CLINIC_ID]

ON(OUTPAT_REGISTER.PATIENT_NUMBER = [GROUPING_OF_CLINIC_ID].PATIENT_NUMBER)
AND(OUTPAT_REGISTER.REGISTRATION_CD =[GROUPING_OF_CLINIC_ID].REGISTRATION_CD)

GROUP BY [GROUPING_OF_CLINIC_ID].CLINIC_ID,OUTPAT_ACCT_REC.CHARGE_CLASS,[GROUPING_OF_CLINIC_ID].PATIENT_NUMBER,[GROUPING_OF_CLINIC_ID].REGISTRATION_CD,
OUTPAT_ACCT_REC.ENTRY_DATE,OUTPAT_REGISTER.PRIMARY_FINAN

HAVING OUTPAT_ACCT_REC.ENTRY_DATE >'12/31/2010'
)AS [Non_Recurring_Clinic_Step1]

On([TABLE_LAYOUT].ENTRY_CLASS = [Non_Recurring_Clinic_Step1].CHARGE_CLASS)

Inner Join
OUTPAT_REGISTER

On([Non_Recurring_Clinic_Step1].PATIENT_NUMBER = OUTPAT_REGISTER.PATIENT_NUMBER)
And([Non_Recurring_Clinic_Step1].REGISTRATION_CD = OUTPAT_REGISTER.REGISTRATION_CD)

Inner Join
OUTPAT_AREA_CDS
On(OUTPAT_REGISTER.REGISTER_AREA = OUTPAT_AREA_CDS.REGISTER_AREA)

Inner Join
HR_FINAN_CLASS.FINAN_CLASS_CD
On(OUTPAT_REGISTER.PRIMARY_FINAN = HR_FINAN_CLASS.FINAN_CLASS_CD)

Where dbo_OUTPAT_AREA_CDS.REG_AREA_TYPE)<>'RE'
        and datepart(year,[entry_date]) in (2011, 2012)
) src
group by CLINIC_ID, SUMMARY_CATGRY, ENTRY_TYPE 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T19:34:59.230

看起来你在这一行有一个额外的括号：

```
Where dbo_OUTPAT_AREA_CDS.REG_AREA_TYPE)<>'RE'  -- there is a closing but no opening
                                       ^ -- this is extra 
```

我通过格式化代码以找到匹配的括号找到了这一点。

因此，您的完整查询将是：

```
Select CLINIC_ID,
    SUMMARY_CATGRY,
    ENTRY_TYPE,
    SUM(case when EntryMonth = 1 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Jan12],
    SUM(case when EntryMonth = 2 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Feb12],
    SUM(case when EntryMonth = 3 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Mar12],
    SUM(case when EntryMonth = 4 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Apr12],
    SUM(case when EntryMonth = 5 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [May12],
    SUM(case when EntryMonth = 6 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Jun12],
    SUM(case when EntryMonth = 7 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Jul12],
    SUM(case when EntryMonth = 8 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Aug12],
    SUM(case when EntryMonth = 9 and EntryYear = 2012 then [sumofentry_amount] else 0 end) [Sep12],
    SUM(case when EntryMonth = 10 and EntryYear = 2012 then [sumofentry_amount] else 0 end)[Oct12],
    SUM(case when EntryMonth = 11 and EntryYear = 2012 then [sumofentry_amount] else 0 end)[Nov12],
    SUM(case when EntryMonth = 12 and EntryYear = 2012 then [sumofentry_amount] else 0 end)[Dec12],
    SUM(case when EntryYear = 2012 then [sumofentry_amount] else 0 end) [2012YTD],
    SUM(case when EntryYear = 2011 then [sumofentry_amount] else 0 end) [2011YTD]
From
(
    SELECT [Non_Recurring_Clinic_Step1].CLINIC_ID, 
        dbo_HR_FINAN_CLASS.SUMMARY_CATGRY, 
        [TABLE_LAYOUT].ENTRY_TYPE, 
        datepart(month,[entry_date]) EntryMonth,
        datepart(year,[entry_date]) EntryYear,
        ENTRY_AMOUNT as [sumofentry_amount]
    FROM [TABLE_LAYOUT]
    Inner Join
    (
        SELECT [GROUPING_OF_CLINIC_ID].CLINIC_ID, 
            OUTPAT_ACCT_REC.CHARGE_CLASS,
            [GROUPING_OF_CLINIC_ID].PATIENT_NUMBER, 
            [GROUPING_OF_CLINIC_ID].REGISTRATION_CD, 
            OUTPAT_REGISTER.PRIMARY_FINAN,   
            Replace(CONVERT(VARCHAR(10),OUTPAT_ACCT_REC.ENTRY_DATE,101), '/', '') AS ENTRY_DATE, 
            SUM(ENTRY_AMOUNT) AS ENTRY_AMOUNT 
        FROM OUTPAT_REGISTER
        Left JOIN OUTPAT_BILL_REF
            ON OUTPAT_REGISTER.PATIENT_NUMBER = OUTPAT_BILL_REF.PATIENT_NUMBER
            AND OUTPAT_REGISTER.REGISTRATION_CD = OUTPAT_BILL_REF.REGISTRATION_CD
        Left JOIN OUTPAT_ACCT_REC
            ON OUTPAT_BILL_REF.PATIENT_NUMBER = OUTPAT_ACCT_REC.PATIENT_NUMBER
            AND OUTPAT_BILL_REF.BILL_REFERENCE = OUTPAT_ACCT_REC.REFERENCE_NUM
        Left JOIN
        (
            SELECT CLINIC_ID, PATIENT_NUMBER, REGISTRATION_CD
            FROM OP_VISIT_HISTRY
            GROUP BY CLINIC_ID, PATIENT_NUMBER, REGISTRATION_CD
        )AS [GROUPING_OF_CLINIC_ID]
            ON OUTPAT_REGISTER.PATIENT_NUMBER = [GROUPING_OF_CLINIC_ID].PATIENT_NUMBER
            AND OUTPAT_REGISTER.REGISTRATION_CD =[GROUPING_OF_CLINIC_ID].REGISTRATION_CD
        WHERE OUTPAT_ACCT_REC.ENTRY_DATE >'12/31/2010'
        GROUP BY [GROUPING_OF_CLINIC_ID].CLINIC_ID,
            OUTPAT_ACCT_REC.CHARGE_CLASS,
            [GROUPING_OF_CLINIC_ID].PATIENT_NUMBER,
            [GROUPING_OF_CLINIC_ID].REGISTRATION_CD,
            OUTPAT_ACCT_REC.ENTRY_DATE,
            OUTPAT_REGISTER.PRIMARY_FINAN
    )AS [Non_Recurring_Clinic_Step1]
        On [TABLE_LAYOUT].ENTRY_CLASS = [Non_Recurring_Clinic_Step1].CHARGE_CLASS
    Inner Join OUTPAT_REGISTER
        On [Non_Recurring_Clinic_Step1].PATIENT_NUMBER = OUTPAT_REGISTER.PATIENT_NUMBER
        And [Non_Recurring_Clinic_Step1].REGISTRATION_CD = OUTPAT_REGISTER.REGISTRATION_CD
    Inner Join OUTPAT_AREA_CDS
        On OUTPAT_REGISTER.REGISTER_AREA = OUTPAT_AREA_CDS.REGISTER_AREA
    Inner Join HR_FINAN_CLASS.FINAN_CLASS_CD
        On OUTPAT_REGISTER.PRIMARY_FINAN = HR_FINAN_CLASS.FINAN_CLASS_CD
    Where dbo_OUTPAT_AREA_CDS.REG_AREA_TYPE<>'RE'
        and datepart(year,[entry_date]) in (2011, 2012)
) src
group by CLINIC_ID, SUMMARY_CATGRY, ENTRY_TYPE 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T19:34:51.363

我看到的一个问题在以下部分：

```
Where dbo_OUTPAT_AREA_CDS.REG_AREA_TYPE)<>'RE'
        and datepart(year,[entry_date]) in (2011, 2012)
) src 
```

看起来您在`dbo_OUTPAT_AREA_CDS.REG_AREA_TYPE)<>'RE'`... 有一个额外的、无与伦比的括号，这应该是：

```
Where dbo_OUTPAT_AREA_CDS.REG_AREA_TYPE<>'RE'
        and datepart(year,[entry_date]) in (2011, 2012)
) src 
```

# jquery - 响应式 Twitter Bootstrap 与 jCarouselLite 不兼容

> ID：14693974
> 
> 赞同：1
> 
> 时间：2013-02-04T19:23:59.410
> 
> 标签：jquery, twitter-bootstrap, responsive-design, jcarousellite

我在使用带有 Bootstrap 响应式的 jCarouselLite 时遇到了一个问题。

插件初始化是基本的：

```
$("#slider").jCarouselLite({
    auto: 800,
    speed: 1000,
    visible: 4
}); 
```

我在[这里](http://jsfiddle.net/Starx/BcqXE/4/show/)创建了一个演示，一切都运行良好，但是当您将浏览器调整到网格列跨越整个宽度的点时，您会注意到 jCarouselLite 元素开始表现得很有趣。

> **元素宽度超大。**

也可以从[jsfiddle](http://jsfiddle.net/Starx/BcqXE/4/)版本中查看。

我附上了一张显示尺寸的图片： ![超大的 jCarousel 元素](../Images/32bad3e30ab9dadae0c7dc7065ef949f.png)

有什么修复吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T13:29:31.587

由于 jCarouselLite 并不是真正打算用作响应式滑块，因此您最好的选择是尝试更具体地为响应式布局设置的替代方案（并将检测并响应视口变化）。

有一个[专门为 Twitter Bootstrap 设计](http://twitter.github.io/bootstrap/javascript.html#carousel)的可能很适合吗？

保存它，我倾向于使用的替代方案是：

*   [RoyalSlider](http://dimsemenov.com/plugins/royal-slider/) - 付费但功能强大！
*   [bxSlider](http://bxslider.com/) - 免费并在[WTFPL 许可](http://www.wtfpl.net/)下发布，这是我现在最常用的一个。它比 RoyalSlider 稍微复杂一点，但非常适合在商业应用中使用并且非常易于扩展。

# matlab - 散点非方阵

> ID：14693976
> 
> 赞同：1
> 
> 时间：2013-02-04T19:24:22.183
> 
> 标签：matlab

我想分散任何维度（高度、宽度、深度）的矩阵。问题是 scatter 采用相同维度的矩阵。有没有其他方法可以实现这一目标？

我正在考虑将我的矩阵补充为一个平方，然后最小化那些“虚拟”点的大小和颜色，但我正在努力寻找更好的解决方案。任何人都可以帮忙吗？

这是我打算这样做的方式：

```
[x,y,z] = meshgrid(1:height, 1:widht, 1:depth);
scatter3(x(:), y(:), z(:), size, data_matrix(:)); 
```

显示此代码的目的：假设我在一个存储在矩阵中的房间内有温度。我想在 3D 图中绘制温度。如果有更好的方法来实现这一点然后分散（这似乎适用于[等尺寸情况](http://snag.gy/yaSJb.jpg)），将不胜感激知道它：D

# hibernate - OpenJPA 与 Hibernate：EntityManager.merge 之间的显着差异

> ID：14693980
> 
> 赞同：0
> 
> 时间：2013-02-04T19:24:29.073
> 
> 标签：hibernate, jpa, merge, openjpa, entitymanager

因此，我发现 OpenJPA (2.1.1) 和 Hibernate (3.3.1) 与 EntityManager.merge 的行为存在重大差异。考虑以下类：

```
@Entity(name = "ChoiceHolder")
@Table(name = "CHOICEHOLDER")
@Inheritance(strategy = InheritanceType.JOINED)
public class ChoiceHolder
    implements Equals, HashCode
{

    protected int id;
    protected String choice3;
    protected String choice4;

    @Id
    @Column(name = "ID", scale = 0)
    public int getId() {
        return id;
    }

    public void setId(int value) {
        this.id = value;
    }

    @Basic
    @Column(name = "CHOICE3", length = 255)
    public String getChoice3() {
        return choice3;
    }

    public void setChoice3(String value) {
        this.choice3 = value;
    }

    @Basic
    @Column(name = "CHOICE4", length = 255)
    public String getChoice4() {
        return choice4;
    }
} 
```

并考虑以下客户端代码（这只是一个 SSCCE - 在我的实际用例中，使用相同 ID 合并的两个调用反映了从两个单独的客户端操作接收到的数据，其中 id 在两个操作之间是相同的):

```
ChoiceHolder holder1a = new ChoiceHolder();
holder1a.setId(1);
holder1a.setChoice3("foo");
ChoiceHolder holder1b = new ChoiceHolder();
holder1b.setId(1);
holder1b.setChoice4("bar");

EntityManager em1 = factory.createEntityManager();
em1.merge(holder1a);
em1.close();
EntityManager em2 = factory.createEntityManager();
em2.merge(holder1b);
em2.close();
EntityManager em1Find = factory.createEntityManager();
ChoiceHolder holder1result = em1Find.find(ChoiceHolder.class, 1);
em1find.close();

ChoiceHolder holder2a = new ChoiceHolder();
holder2a.setId(2);
holder2a.setChoice3("foo2");
ChoiceHolder holder2b = new ChoiceHolder();
holder2b.setId(2);
holder2b.setChoice4("bar2");

EntityManager em3 = factory.createEntityManager();
em3.merge(holder2a);
em3.merge(holder2b);
em3.close();
EntityManager em2Find = factory.createEntityManager();
ChoiceHolder holder2result = em2Find.find(ChoiceHolder.class, 2);
em2Find.close(); 
```

当我使用 Hibernate 运行上述代码时，`holder1result`choice3 为 null，choice4 为“bar”。同样，`holder2result`choice3 为 null，choice4 为 "bar2"。但是，当我使用 openJPA 运行相同的代码时，我得到了一些非常不同的东西：`holder1result`同时设置了choice3 和choice4，并且调用会`em3.merge(holder2b)`因 ReportingSQLException 而爆炸，因为它尝试执行的 INSERT 违反了对choiceholder ID 的主键约束。

如果重要的话，以下是我用来配置 Hibernate 的属性文件中的相关位：

```
hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
hibernate.connection.driver_class=org.postgresql.Driver
hibernate.hbm2ddl.auto=create-drop
hibernate.cache.provider_class=org.hibernate.cache.HashtableCacheProvider
hibernate.jdbc.batch_size=0 
```

这是我的 persistence.xml 中用于配置 openJPA 的相应位：

```
<property name="openjpa.jdbc.SynchronizeMappings" value="buildSchema"/>
<property name="openjpa.jdbc.DBDictionary" value="postgres"/>
<property name="openjpa.ConnectionDriverName" value="org.postgresql.Driver"/>
<property name="openjpa.jdbc.MappingDefaults" value="DeferConstraints=true,ForeignKeyDeleteAction=restrict,JoinForeignKeyDeleteAction=restrict"/> 
```

在我的特殊情况下，我想要的是我在 Hibernate 中看到的行为；但是，我的环境（在 Karaf 内部）要求我改用 OpenJPA。是否可以在 OpenJPA 上设置标志来更改其行为以匹配我正在寻找的内容？

这是对 JPA 的可怕滥用吗？如果是，我应该使用其他一些技术/调用序列吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T14:17:57.137

好吧，我想出了一些部分答案 - 但我不确定是否有任何我需要关注的副作用。

对于问题 #1，其中`choice3`没有正确清除，我必须在我的 persistence.xml 文件 中设置`openjpa.DetachState`为。`all`

对于问题 #2，在调用`EntityManager.flush`之间添加调用以`merge`解决问题。奇怪的是，在第一次调用之前添加调用`merge`也可以解决问题，这让我怀疑这`flush`是在 EntityManager 上设置一些状态，但我不确定为什么会这样。

# php - PHP 不能回显每个数组

> ID：14693981
> 
> 赞同：0
> 
> 时间：2013-02-04T19:24:36.863
> 
> 标签：php, arrays, wordpress

我无法回显每个数组。不知道我做错了什么。回显每个数组的方法是什么？尝试了以下一些方法来回显，但没有成功。

```
function simple_social_sharing( $attr_twitter = null, $attr_items = null ) {

    // parse variables
    $twitter_account = $attr_twitter;
    $item_toggles = $attr_items;

    // get post content and urlencode it
    global $post;
    $browser_title_encoded = urlencode( trim( wp_title( '', false, 'right' ) ) );
    $page_title_encoded = urlencode( get_the_title() );
    $page_url_encoded = urlencode( get_permalink($post->ID) );

    // create share items array
    $share_items = array ();

    // set each item
    $item_facebook = array(
        "class" => "facebook",
        "href" => "http://www.facebook.com/sharer.php?u={$page_url_encoded}&amp;t={$browser_title_encoded}",
        "text" => "Share on Facebook"
    );
    $item_twitter = array(
        "class" => "twitter",
        "href" => "http://twitter.com/share?text={$page_title_encoded}&amp;url={$page_url_encoded}&amp;via={$twitter_account}",
        "text" => "Share on Twitter"
    );
    $item_google = array(
        "class" => "google",
        "href" => "http://plus.google.com/share?url={$page_url_encoded}",
        "text" => "Share on Google+"
    );

    // test whether to display each item
    if($item_toggles) {
        // explode into array
        $item_toggles_array = explode( ",", $item_toggles );
        // set each item on or off
        $show_facebook = $item_toggles_array['0'];
        $show_twitter = $item_toggles_array['1'];
        $show_google = $item_toggles_array['2'];
    }
    else {
        $display_all_items = 1;
    }

    // form array of items set to 1
    if( $show_facebook==1 || $display_all_items ) {
        array_push( $share_items, $item_facebook );
    }
    if( $show_twitter==1 || $display_all_items) {
        array_push( $share_items, $item_twitter );
    }
    if( $show_google==1 || $display_all_items) {
        array_push( $share_items, $item_google );
    }

    // if one or more items
    if ( ! empty( $share_items ) ) {
        // create output
        $share_output = "<ul class=\"ss-share\">\n";
        foreach ( $share_items as $share_item ) {
            $share_output .= "<li class=\"ss-share-item\">\n";  
            $share_output .= "<a class=\"ss-share-link ico-{$share_item['class']}\" href=\"{$share_item["href"]}\" rel=\"nofollow\" target=\"_blank\">{$share_item['text']}</a>\n"; 
            $share_output .= "</li>\n"; 
        }
        $share_output .= "</ul>";
        // echo output
        echo $share_output;
    }
}

// add shortcode to output buttons
function simple_social_sharing_shortcode( $atts, $content = null ) {
    // parse variables / set defaults
    extract( shortcode_atts( array(
        'twitter' => '',
        'display' => '1,1,1',
    ), $atts ) );
    // output buttons
    ob_start();
    simple_social_sharing( $twitter, $display );
    $output_string = ob_get_contents();
    ob_end_clean();
    return force_balance_tags( $output_string );
} 
```

开发人员调用功能也不起作用

```
<?php simple_social_sharing('twitteraccount', '1,1,1'); ?> 
```

我试图通过这种方式调用每个数组，但这是错误的。

```
<?php simple_social_sharing([1]); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:33:43.940

向下到底部，您的 foreach 块中有此代码段：
... href=\"{$share_item["href"]}\" ...

href 周围的双引号会给您带来问题。

您需要将其设置为
... href=\"{$share_item['href']}\" ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:42:05.790

函数应该返回值并且不回显它..

而不是`echo $share_output;`，你应该拥有它`return $share_output;`

回显函数的返回值（如果是数组，则返回`print_r`）`echo`以查看输出

```
<?php echo simple_social_sharing('twitteraccount', '1,1,1'); //NOTE THE 'echo' HERE.. ?> 
```

# java - 在这种情况下，我怎样才能最好地应用 Hibernate-Search？

> ID：14693982
> 
> 赞同：0
> 
> 时间：2013-02-04T19:24:40.103
> 
> 标签：java, database, database-design, lucene, hibernate-search

我有一个`Product`实体和表，并且希望数据库设计允许通过其名称顶部的不同关键字查找产品，也就是说，就像使用同义词库一样，例如产品名称“HDR-TD20V”也应该通过关键字“摄像机”找到, "camera", "video camera" 等。请注意，同样的机制可用于从不同的输入语言中定位相同的记录，例如寻找“camara de video”（西班牙语）或“videokamera”（德语）也应该找到相同的记录。

假设我使用的是 Hibernate-search 即 Lucene，我有以下两种设计选择：

1.  **非规范化方法**：`Product`表有一个`keywords`包含该产品的逗号分隔关键字的列。这显然违反了[第一范式](http://en.wikipedia.org/wiki/First_normal_form)“......每个属性的值仅包含来自该域的单个值。”。但是，这将与 Hibernate-search 很好地集成。
2.  **规范化方法**：定义一个`Keyword`实体表`Keyword(id,keyword,languageId)`，即多对多关联`ProductKeyword(productId,keywordId)`，但与 Hibernate-Search 的集成不再那么直观......除非我创建一个物化视图，即`select * from Product p, Keyword k, ProductKeyword pk where p.id=pk.productId and k.id=pk.keywordId`并索引这个物化视图。

我当然更喜欢选择 2，但我不确定 Hibernate-search 如何以最佳方式覆盖这个用例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T12:03:38.477

像这样的东西应该工作：

```
@Indexed
public class Product {
    @Id
    private long id;

    @ManyToMany
    @IndexedEmbedded
    Set<Keyword> keywords;

    // ...
}

public class Keyword {

    @Id
    private long id;

    // only needed if you want a bidirectional relation
    @ManyToMany
    @ContainedIn
    Set<Product> products;

    // ...
} 
```

我省略了延迟加载等选项。JPA 映射的确切外观取决于用户案例

# vb.net - += 在 Visual Basic 中是什么意思？

> ID：14693984
> 
> 赞同：4
> 
> 时间：2013-02-04T19:24:43.300
> 
> 标签：vb.net, operators

我试图用谷歌搜索这个答案，但找不到。我在 VB.Net 上工作。我想知道 VB.Net 中的运算符 += 是什么意思？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-04T19:26:22.547

这意味着您要将值添加到变量的现有值中。因此，例如：

```
Dim x As Integer = 1
x += 2  ' x now equals 3 
```

换句话说，它和这样做是一样的：

```
Dim x As Integer = 1
x = x + 2  ' x now equals 3 
```

为了将来参考，您可以在[MSDN](http://msdn.microsoft.com/en-us/library/f15ea9k8.aspx)上查看 VB.NET 运算符的完整列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-04T19:26:36.093

```
a += b 
```

相当于

```
a = a + b 
```

换句话说，它增加了当前值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T19:44:25.150

它是加等于。它所做的是采用相同的变量，将其与右手数字相加（使用 + 运算符），然后将其分配回变量。例如，

```
Dim a As Integer
Dim x As Integer
x = 1
a = 1
x += 2
a = a + 2
if x = a then
MsgBox("This will print!")
endif 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-04T19:40:20.780

这 2 行编译产生相同的 IL 代码：

`x += 1`

和

`x = x + 1`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-09T23:02:37.077

只是让代码更高效 -

```
Dim x as integer = 3 
```

`x += 1`

'x = 4

是相同的

`x = x + 1`

'x = 4

它也可以与 (-) 一起使用：

```
x -= 1 
```

' x = 2

是相同的

```
x = x - 1 
```

'x = 2

# html - 双宽度网站

> ID：14693990
> 
> 赞同：-3
> 
> 时间：2013-02-04T19:25:10.047
> 
> 标签：html, css, web2py

我不明白为什么我们的网站有这么大的宽度。这是它的链接：`https://85.25.242.165/lunatic/default/index`

如您所见，底部有一个滚动条，整个宽度大约是网站大小的两倍。我试过通过 Firebug 找到一个如此宽的项目，但没有运气。一切都在网站的原始宽度内。

我们正在使用 Web2py 框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T19:35:42.827

有你的问题

```
#cssmenu ul ul ul {
    top: 0;
    left: auto;
    right: -99.5%;
} 
```

添加

```
body {
    overflow-x: hidden;
} 
```

一切都应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-12T17:37:38.610

当我添加此代码时，我遇到了仅在 Firefox Mac 中发生的类似问题：

```
body {
  transform: translateZ(0); // This enables hardware acceleration for smoother animations. 
} 
```

正如评论所说，它应该平滑动画，但最终毁了我在 FFv24 Mac 上的网站。

# java - 带有自定义 TextView 的 WheelView 不会突出显示 currentItem

> ID：14693997
> 
> 赞同：0
> 
> 时间：2013-02-04T19:25:32.000
> 
> 标签：java, android, textview

[作为对这个问题](https://stackoverflow.com/questions/14690393/change-textview-of-wheelview)的跟进，我已经成功实现了带有自定义 TextView 的 WheelView（它具有用于翻译目的的自定义字体）。

```
adapter.setItemResource(R.layout.layout_item);
adapter.setItemTextResource(R.id.text); 
```

现在的问题是车轮视图没有像它应该那样突出显示当前项目。

适配器代码：

```
/**
* Adapter for string based wheel. Highlights the current value.
*/
private class DateArrayAdapter extends ArrayWheelAdapter<String> {
   // Index of current item
   int currentItem;
   // Index of item to be highlighted
   int currentValue;

   /**
    * Constructor
    */
   public DateArrayAdapter(Context context, String[] items, int current) {
       super(context, items);
       this.currentValue = current;
       setTextSize(16);
   }

   @Override
   protected void configureTextView(TextView view) {
       super.configureTextView(view);
       if (currentItem == currentValue) {
           view.setTextColor(getResources().getColor(R.color.holo_blue));
       }
       view.setTypeface(Typeface.SANS_SERIF);
       view.setTextSize(18);
   }

   @Override
   public View getItem(int index, View cachedView, ViewGroup parent) {
       currentItem = index;
       return super.getItem(index, cachedView, parent);
   }
} 
```

在上面的代码中，它根本没有去`configureTextView`突出显示该项目。

[WheelView 的原始来源](http://code.google.com/p/android-wheel/source/browse/trunk/wheel/src/kankan/wheel/widget/adapters/AbstractWheelTextAdapter.java)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:24:30.533

好吧，我想通了。如果它对其他人有帮助，这里是代码：

```
/**
* Adapter for string based wheel. Highlights the current value.
*/
private class DateArrayAdapter extends ArrayWheelAdapter<String> {
    // Index of current item
    int currentItem;
    // Index of item to be highlighted
    int currentValue;

    /**
    * Constructor
    */
    public DateArrayAdapter(Context context, String[] items, int current) {
        super(context, items);
        this.currentValue = current;
        setItemResource(R.layout.wheelview_textview);
        setItemTextResource(R.id.wheelview_date);
        setTextSize(16);
    }

    protected void configureTextView(CustomTextView view) {
        super.configureTextView(view);
        if (currentItem == currentValue) {
            view.setTextColor(getResources().getColor(R.color.holo_blue));
        }

    }

    @Override
    public View getItem(int index, View cachedView, ViewGroup parent) {
        currentItem = index;
        View view = super.getItem(index, cachedView, parent);
        CustomTextView date = (CustomTextView) view.findViewById(R.id.wheelview_date);
        configureTextView(date);
        return view;
        //return super.getItem(index, cachedView, parent);
    }
} 
```