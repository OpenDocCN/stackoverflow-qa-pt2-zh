# StackOverflow 问答 13407000-13407999

# svn - 在 XNA 中找不到纹理

> ID：13407004
> 
> 赞同：0
> 
> 时间：2012-11-15T22:01:36.783
> 
> 标签：svn, xna

我一直在和他家使用乌龟 SVN 的朋友一起开发这款游戏。我把我的电脑搬回了家并将其导出，因此它不再连接到存储库，从那时起，当我运行程序时，我的任何纹理都不会加载。我检查了我的文件，它们指向了正确的位置。即使将它们删除并重新添加到我的游戏内容中，我仍然会得到同样的结果。

我的问题的屏幕截图... [http://i.imgur.com/lHhx8.jpg](http://i.imgur.com/lHhx8.jpg)

您可以清楚地看到路径是正确的，并且我正确地调用它，否则它不会在我运行它的其他一百次时起作用。希望有人可以提供帮助。我什至不确定它是否与SVN有关。

# android - Android：“托管多个应用程序的进程的类加载器可能会失败”

> ID：13407006
> 
> 赞同：21
> 
> 时间：2012-11-15T22:01:46.533
> 
> 标签：android, multithreading, classloader

Eclipse 的 Android 的 logcat 中的这条消息是什么意思？

```
W/ActivityThread: ClassLoader.getResources: The class loader returned by Thread.getContextClassLoader() may fail for processes that host multiple applications. You should explicitly specify a context class loader. For example: Thread.setContextClassLoader(getClass().getClassLoader()); 
```

不幸的是，没有给出关于这个警告的上下文，所以我不知道是什么导致了这个问题以及如何解决它。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-19T13:48:53.140

## 背景资料

该消息意味着 Android 已经设置了一个 dummy `ClassLoader`，`Thread.currentThread().setContextClassLoader()`并且尝试使用该虚拟类加载器。*事情*可以是很多事情，很难从给出的信息中准确地说出什么。不过，您可以尝试一个技巧，请参见下文。无论如何，当进程可能包含来自多个 APK 的代码的风险时，Android 会设置虚拟类加载器。更具体地说，如果您使用过，Android 会查看您的清单`android:sharedUserId`：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    ...
    android:sharedUserId="triggers.dummy.loader" > 
```

或者如果您在非标准环境中运行`android:process`

```
 <application android:process="triggers.dummy.loader"> 
```

## 如何摆脱警告

您可以做两件事来消除警告：

1.  不要使用`android:sharedUserId`或`android:process`
2.  `ClassLoader`在运行任何其他代码之前明确设置要使用的 APK

要使用解决方案 2，您需要一些关键的见解。首先，对于`AnyClass`APK 中的任何类，`AnyClass.class.getClassLoader()`都将返回相同的`ClassLoader`. 第二，

```
AnyClass obj = new AnyClass();
Thread.currentThread().setContextClassLoader(obj.getClass().getClassLoader()) 
```

是相同的

```
Thread.currentThread().setContextClassLoader(AnyClass.class.getClassLoader()) 
```

第三，您需要在`Thread.currentThread().setContextClassLoader(getClass().getClassLoader())`调用`Thread.currentThread().getContextClassLoader()`. 第四，当涉及到多个APK时，需要在加载完最后一个APK`Thread.setContextClassLoader(getClass().getClassLoader())` *后*调用（否则加载最后一个APK会覆盖你手动设置的内容）。因此，最好使用下面的调试技巧找出谁在使用上下文类加载器。然后，在此之前，您`Thread.setContextClassLoader(getClass().getClassLoader())`从所需的 APK 调用一个类，通常是首先加载的 APK（或者，在仅涉及一个 APK 的情况下，该 APK ;）。第五，上下文类加载器是*每个线程*的，如果您的应用程序是多线程的，您需要记住这一点。

## 调试技巧

如果您想找出调用 ClassLoader.getResources() 的代码，应该可以：

```
Thread.currentThread().setContextClassLoader(new ClassLoader() {
    @Override
    public Enumeration<URL> getResources(String resName) throws IOException {
        Log.i("Debug", "Stack trace of who uses " +
                "Thread.currentThread().getContextClassLoader()." +
                "getResources(String resName):", new Exception());
        return super.getResources(resName);
    }
}); 
```

如果您足够早地这样做，您应该在 logcat 中看到一个堆栈跟踪，该堆栈跟踪可以追溯到调用`getResources()`虚拟类加载器的任何人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-30T11:08:50.473

我收到此警告，但在我的清单中没有 android:sharedUserId 或 android:process...

发现它只在模拟器上呈现...

设备未显示警告消息。在智能手机 KitKat 4.4 API 19 和平板电脑 5.0.1 API 21 上测试。

# django - Django 空获取变量

> ID：13407008
> 
> 赞同：0
> 
> 时间：2012-11-15T22:01:55.970
> 
> 标签：django, django-models, django-views

嗨，我有一个 ajax 调用，它与一个小视图相关联：

```
def get_spans(snow_load, wind_speed, module_length):
    spans = Spans.objects.values_list('span').filter(
        snow=snow_load,
        wind=wind_speed,
        module_length__gte=module_length,
    ).order_by('span')
    try:
        max_span = max(spans)
    except ValueError:
        max_span = 0
    return max_span

def GetSpans(request):
    # get variables from ajax request
    snow_load = request.GET.get('snow_load', None)
    wind_speed = request.GET.get('wind_speed', None)
    module_length = request.GET.get('module_length', None)
    # call get_spans()
    max_span = get_spans(snow_load, wind_speed, module_length)
    # json encode it
    max_span = simplejson.dumps(max_span, cls=DjangoJSONEncoder)
    return HttpResponse(
        max_span,
        mimetype='application/json'
    ) 
```

问题是这些 get 变量中的任何一个都可能是`''`小数。我的问题是处理这些问题的最佳方法是什么？如果变量是`''`我得到`invalid literal for int() with base 10:`错误。`None`我应该用例如替换所有空字符串吗？我应该将所有值转换为`float`吗？

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:21:43.917

在您的函数`get_spans`中，您可以排除空或无字段：

```
def get_spans(*args, **kwargs):
   my_dict = {}
   for key in kwargs:
      if kwargs[key]:
         my_dict[key] = kwargs[key]
    spans = Spans.objects.values_list('span') \
                         .filter(**my_dict) \
                         .order_by('span')
    #rest of code 
```

将您的`get_spans`函数称为：

```
get_spans(snow=snow_load, wind=wind_speed, module_length__gte=module_length) 
```

**更优雅**

`Requires python2.7+`

```
def get_spans(*args, **kwargs):
    my_dict = {key:val for (key, val) in kwargs.iteritems() if val}
    spans = Spans.objects.values_list('span') \
                         .filter(**my_dict) \
                         .order_by('span')
    #rest of code 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:37:57.410

django 中的过滤器可以链接，所以你可以这样做：

```
spans = Spans.objects.values_list('span')
if snow_load:
   spans.filter(snow=snow_load)
if wind_speed:
    spans.filter(wind=wind_speed)
if module_length:
    spans.filter(module_length__gte=module_length)

return max(spans.order_by('span')) 
```

# algorithm - 随机数发生器的变化间隔

> ID：13407010
> 
> 赞同：1
> 
> 时间：2012-11-15T22:02:08.693
> 
> 标签：algorithm, random

给定一个随机数生成器，它在具有均匀密度的区间（即for和其他地方`r()`）中生成（伪）随机数，创建一个随机数生成器，它在密度为的区间中生成 a 。`double``[0,1]``p(x) = 1``0 <= x <= 1``p(x) = 0``r(a,b)``double``[a,b]``p(x) = 1/(b-a)``a <= x <= b`

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-15T22:02:08.693

我相信（并且已经测试过）这会产生均匀的分布。

```
r(a,b) = ((r * b) mod (b-a)) + a 
```

但是还有另一种更明显的方法吗？

是的：

```
r(a, b) = r*(b-a) + a 
```

# c - 文件多线程

> ID：13407014
> 
> 赞同：1
> 
> 时间：2012-11-15T22:02:11.897
> 
> 标签：c, multithreading, file

所以假设我有以下代码，我在其中打开一个文件，逐行读取内容，然后将每一行用于其他地方的函数，然后当我完成后倒回文件。

```
FILE *file = Open_File();
char line[max];
while (!EndofFile()) 
{
    int length = GetLength(line);
    if (length > 0) 
    {
       DoStuffToLine(line)
    }
}
rewind(file); 
```

我想知道是否有一种方法可以在这里使用线程来添加并发性。因为我只是在阅读文件而不是写入文件，所以我觉得我不必担心比赛条件。但是我不确定如何处理 while 循环中的代码，因为如果一个线程正在循环文件而另一个线程同时循环文件，它们是否会导致彼此跳过行，使其他错误等？解决这个问题的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:06:55.193

如果您尝试这样做以提高读取性能，您可能会感到失望，因为这几乎肯定会受到磁盘 I/O 的限制。添加更多线程不会帮助操作系统和磁盘控制器更快地获取数据。

但是，如果您只是尝试并行处理数据，那就另当别论了。在这种情况下，我会将整个文件读入某个内存缓冲区，然后让您的线程并行处理它。这样，您就不必担心倒带文件指针或任何其他类似的烦人问题的线程安全性。

当然，您可能仍需要对多线程部分使用其他锁定机制，具体取决于您正在做什么，但您不必担心开始访问文件时标准库会做什么有多个线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:12:57.767

并发增加了一些竞争条件问题：

**1.** EndofFile() 函数在循环开始时被求值，这个函数可能总是对两个线程返回true，然后一个线程到达文件末尾，另一个线程尝试读取文件。你永远不知道当一个线程可能正在执行时；
**2**、GetLength函数同样有效：当一个线程有长度信息时，长度可能会改变，因为另一个线程可能读取另一行；
**3**、你是按顺序读取一个文件，即使你倒带它，也可能总是出现IO指针的当前位置被其他线程改变的情况。

此外，正如 Telgin 所指出的，读取文件不是 CPU 限制的，而是 I/O 限制的，系统读取文件也是如此。您无法提高性能，因为您需要一些锁，而锁定只是为了保证线程安全引入开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:08:08.763

我不确定这是最好的方法。但是，您可以读取该文件。然后将其存储在两个单独的对象中并读取对象而不是文件。只要确保之后进行清理。

# intellij-idea - JavaFX 源代码未显示

> ID：13407017
> 
> 赞同：12
> 
> 时间：2012-11-15T22:02:37.367
> 
> 标签：intellij-idea, javafx

[我从http://hg.openjdk.java.net/openjfx/2.2/master/rt/summary](http://hg.openjdk.java.net/openjfx/2.2/master/rt/summary)下载了 JavaFx 源代码。

zip 文件中的文件夹名称是`re-e71070b0e0c0`.

我解压缩并在项目结构 - Idea 中的全局库下添加了文件夹，但是它不起作用。当我尝试打开一个类时，它只显示字段名称和`/* compiled code */`. 我在手册中找不到任何东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-16T01:27:14.060

这个答案中的大部分信息现在已经过时了。

有关在 IntelliJ Idea 中将 JavaFX 与 Java 11+ 结合使用的更多最新信息，请访问：

*   [openjfx.io](https://openjfx.io/openjfx-docs/)在标题为“JavaFX 和 IntelliJ”的部分中。

不过，上面链接的文章更侧重于在 IntelliJ 中使用 JavaFX，而不是在 IntelliJ 中查看 JavaFX 库源代码。

* * *

*这些说明仅对 JavaFX 2.x 分支是必需的，并且在 JDK 8 发布后将被淘汰。*

下载源 zip 并解压缩后，打开 Idea 并按照以下说明操作：

1.  修改 1.7 SDK 的源代码结构：

    `File | Project Structure | SDKs | Sourcepath`

对于解压缩的 zip 中的每个子项目，键入`Alt+Insert`并添加相应的源目录。例如`rt-e71070b0e0c0\javafx-ui-charts\src`，`rt-e71070b0e0c0\javafx-ui-common\src`等。目前并非所有 JavaFX 2.x 源代码都是开源的，因此这里只会添加开源部分。

2.  设置文档查找路径：

    `File | Project Structure | SDKs | Documentation Paths`

指定`Alt+S`文档的 url：http: [//docs.oracle.com/javafx/2/api/](http://docs.oracle.com/javafx/2/api/)

3.  在您的 JavaFX 应用程序源中，将光标放在 JavaFX 类用法上，例如 LineChart：

4.  按下`Ctrl+B`以从您下载的 zip 文件中打开源代码文件 LineChart.java。

5.  按下`Shift+F1`可在浏览器中打开折线图上的文档。

6.  按下`Ctrl+Q`可从 IDE 中快速访问文档。

**2013 年 10 月 16 日更新**

[JDK 8](https://jdk8.java.net/download.html)现在包括 JavaFX 源文件。

告诉 Idea JavaFX 来源在哪里：

1.  修改 1.8 SDK 的源代码结构：

    `File | Project Structure | SDKs | Sourcepath`

按`Alt+S`添加文件`javafx-src.zip`，该文件位于 JDK 8 发行版的根目录中。

2.  设置文档查找路径：

    `File | Project Structure | SDKs | Documentation Paths`

指定`Alt+S`文档的 url：http: [//download.java.net/jdk8/jfxdocs](http://download.java.net/jdk8/jfxdocs)。

当 JDK 8 达到通用发布阶段时，JDK 8 JavaFX 文档 url 可能会发生变化。

上面的第 3 步提供了快速访问项目中的 JavaFX 源代码和文档的键盘快捷键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-13T11:35:32.260

*（由于这是“javafx 源代码”的谷歌热门之一，我也会在这里转储这个答案）：*

引用[这个答案](https://stackoverflow.com/a/13553814/39334)：对于 Java 8，**JavaFX 的公共部分的源实际上是作为 src.zip 的同级安装在 JDK 安装中的*：javafx-src.zip* -*在****您的正常 JDK Java 8 安装的根目录上.*

 *默认情况下，当您添加 JRE（或者它自己发现它）时，Eclipse 不会将它们链接起来——显然是一个错误——所以你必须自己做，通过点击*Preferences* -> *Installed JREs*。找到你的*JDK 8*，点击*Edit*按钮。在*JRE 系统库*列表中，展开*jfxrt.jar*节点，并链接到*javafx-src.zip*文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-25T18:23:08.937

我在带有 JavaFX 8（`open-jfx`包）的 Ubuntu 16.04 上遇到了这个问题。修复方法是安装缺少的源包：

```
sudo apt install openjfx-source 
```

IntellJ 在命令执行完成后的第二秒开始显示 JavaFX 源代码。*

# jquery - $(this) 是否查询 dom？

> ID：13407021
> 
> 赞同：10
> 
> 时间：2012-11-15T22:02:50.263
> 
> 标签：jquery, dom, this

我想知道是否将它传递给 jQuery 函数实际上会导致它在 DOM 中搜索它。这个问题有一个特定的上下文。

假设我有：

```
$('#foo').click(function(){
  var id = $(this).attr('id');
  var someVal = $(this).data('someVal');
} 
```

jQuery 会查询 DOM 以提供其功能，还是从 JavaScript 对象 this 读取和获取所有信息？

并且在以下方面是否存在性能差异：

```
$('#foo').click(function(){
  var elem = $(this);
  var id = elem.attr('id');
  var someVal = elem.data('someVal');
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-15T22:03:55.820

在这种情况下，它不会查询 DOM。 `$()`用 jQuery 包装器对象包装`this`（或您在其中的任何其他内容）。

通过缓存它：

```
var $this = $(this);
 // you will see code have a $ before or after a variable ( $this, this$, etc )
 // signifying it is a jQuery wrapped object 
```

您只需使用 jQuery 包装一次即可节省性能。而不是让它进入 jQuery 并一遍又一遍地包装它。缓存它是一种很好的编码习惯。

**注意：**当然，如果你有`$('#whatever')`它会查询 DOM，因为你已经为它提供了一个选择器来检索它，然后它用 jQuery 包装它。因此，如果您将一遍又一遍地重用它，那么保存它也是有意义的！`var $whatever = $('#whatever');`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-15T22:04:05.590

如果在 中有一个 DOM 元素`this`，`$(this)`则不查询 DOM。它只是在那个 DOM 元素周围放置了一个 jQuery 包装器对象。

这不是一项昂贵的操作，但您希望避免*不必要地*执行此操作。例如，你有时会看到这样的代码：

```
$("some_selector_here").mousemove(function() {
   if ($(this).hasClass('foo')) {
       $(this).doSomething();
   }
   else {
       $(this).doSomethingElse();
   }
}); 
```

只是没有理由这样做。反而：

```
$("some_selector_here").mousemove(function() {
   var $this = $(this);
   if ($this.hasClass('foo')) {
       $this.doSomething();
   }
   else {
       $this.doSomethingElse();
   }
}); 
```

几乎可以肯定，它在处理程序中无关紧要`click`，尽管我仍然会说它的形式很差。但是在经常被调用的事情中，比如`mousemove`，好吧，避免不必要的函数调用和内存分配。:-)

# python - 多次迭代的性能

> ID：13407022
> 
> 赞同：4
> 
> 时间：2012-11-15T22:02:50.590
> 
> 标签：python, performance, iteration

想知道进行一次迭代与多次迭代对性能的影响。我在 Python 中工作——我不确定这是否会影响答案。

考虑尝试对列表中的每个项目执行一系列数据转换。

```
def one_pass(my_list):
    for i in xrange(0, len(my_list)):
        my_list[i] = first_transformation(my_list[i])
        my_list[i] = second_transformation(my_list[i])
        my_list[i] = third_transformation(my_list[i])
    return my_list

def multi_pass(my_list):
    range_end = len(my_list)
    for i in xrange(0, range_end):
       my_list[i] = first_transformation(my_list[i])

    for i in xrange(0, range_end):
       my_list[i] = second_transformation(my_list[i])

    for i in xrange(0, range_end):
       my_list[i] = third_transformation(my_list[i])

    return my_list 
```

现在，除了可读性问题，严格在性能方面，one_pass 是否比 multi_pass 有真正的优势？假设大部分工作都发生在转换函数本身中，那么 multi_pass 中的每次迭代不会只花费大约 1/3 的时间吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T22:11:41.673

不同之处在于您读取的值和代码在[CPU 缓存](http://en.wikipedia.org/wiki/CPU_cache)中的频率。

如果元素`my_list`很大，但适合 CPU 缓存，则第一个版本可能是有益的。另一方面，如果转换的（字节）代码很大，缓存*操作*可能比缓存数据更好。

两个版本都可能比可读性更慢：

```
def simple(my_list):
    return [third_transformation(second_transformation(first_transformation(e)))
            for e in my_list] 
```

[计时它会](http://ideone.com/tA57u2)产生：

```
one_pass: 0.839533090591
multi_pass: 0.840938806534
simple: 0.569097995758 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T23:30:51.687

假设您正在考虑一个程序，它可以很容易地成为一个具有多个操作的循环，或者多个循环每个执行一个操作，那么它永远不会改变计算复杂度（例如，O(n) 算法仍然是 O(n) 两种方式）。

单程方法的一个优点是您可以节省循环的“簿记”。无论迭代机制是递增和比较计数器，还是检索“下一个”指针并检查是否为空，或者其他任何事情，当你一次完成所有事情时，你做的事情就会减少。假设您的操作完成了任何大量工作（并且您的循环机制简单明了，而不是循环通过昂贵的生成器或其他东西），那么这种“簿记”工作将与您的实际工作相形见绌操作，这绝对是一个你不应该做的微优化，除非你知道你的程序太慢并且你已经用尽了所有更重要的可用优化。

另一个优点是，在进行下一个迭代之前将所有操作应用于迭代的每个元素往往会更好地从 CPU 缓存中受益，因为在对同一项目的后续操作中，每个项目仍然可以在缓存中，而使用多次传递几乎不可能（除非您的整个集合适合缓存）。Python 通过字典进行了如此多的间接操作，尽管每个单独的操作通过读取散布在内存空间中的哈希桶来溢出缓存可能并不难。所以这仍然是一个微观优化，但这种分析给了它更多的机会（尽管仍然不确定）产生显着的差异。

多通道的一个优点是，如果您需要在循环迭代之间保持状态，单通道方法会迫使您保持所有操作的状态。这可能会损害 CPU 缓存（可能每个操作的状态单独适合整个传递的缓存，但不是所有操作的状态放在一起）。在极端情况下，这种影响理论上可能会在程序适合内存和不适合内存之间产生差异（我曾经在一个正在咀嚼大量数据的程序中遇到过这种情况）。但是在极端情况下你**知道**你需要把事情分开，非极端情况又是不值得提前做的微优化。

因此，性能通常在微不足道的程度上偏爱单通道，但在某些情况下可能会非常偏爱单通道或多通道。您可以从中得出的结论与适用于所有编程的一般建议相同：首先以最清晰和可维护且仍能充分解决您的程序的任何方式编写代码。仅当您的程序基本完成并且**结果**“不够快”时，才*可以测量*代码各个部分的性能影响，以找出值得花时间的地方。

出于性能原因而担心是编写单遍还是多遍算法所花费的时间几乎总是被浪费掉了。因此，除非您有无限的开发时间可供您使用，否则您将从您的全部开发工作（其中最好包括性能）中获得“最佳”结果，无需预先担心这一点，并根据需要解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:05:31.137

与另一个版本相比，您可能会在任一版本中减少缓存未命中。这取决于这些转换函数实际上做了什么。

如果这些函数有很多代码并且对不同的数据集（除了输入和输出）进行操作，那么多通道可能会更好。否则，单次通过可能会更好，因为当前列表元素可能会保持缓存状态，并且循环操作只执行一次而不是三次。

在这种情况下，比较实际运行时间将非常有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T22:06:37.923

就个人而言，我无疑更喜欢 one_pass 选项。它肯定表现更好。您可能是对的，差异不会很大。Python 已经很好地优化了 xrange 迭代器，但是您仍然需要进行 3 倍于所需的迭代。

# django - 获取 django stripe 付款以返回用户历史记录

> ID：13407023
> 
> 赞同：1
> 
> 时间：2012-11-15T22:03:01.743
> 
> 标签：django, stripe-payments

我正在尝试配置[django-stripe-payments](https://github.com/eldarion/django-stripe-payments)以使其正常工作。我正在使用以下内容：

*   pinax-project-account(https://github.com/pinax/pinax-project-account)

*   引导-ajax (https://github.com/eldarion/bootstrap-ajax)

问题是 django-stripe-payments 没有在模板中显示我的信息，例如我的付款历史，或者我的订阅是否有效，即使它是有效的。

Stripe 确实在接受付款和客户创作。

有没有人可以给我一些建议？

我知道这个问题很模糊，我只是不知道问题出在哪里。

[问题的图像](http://i.stack.imgur.com/fT7Xr.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T05:12:47.703

您需要设置 webhook：

1.  在 Stripe 仪表板中，转到您的帐户，然后转到 Webhooks
2.  将 URL 添加到您正在测试的可公开访问的 URL（如果运行本地开发运行服务器，我发现[localtunnel](http://progrium.com/localtunnel/)非常有用）
3.  现在，当您进行购买时，您应该会在几秒钟内看到数据。

django-stripe-payments 是围绕处理从 webhook 发送的事件数据而设计的。

# sql - oracle函数类似于decode，但更简单

> ID：13407024
> 
> 赞同：1
> 
> 时间：2012-11-15T22:03:03.070
> 
> 标签：sql, oracle, function

在 oracle 中，我可以`decode`以“if, then else”的方式使用该函数。

例如：

> 解码（XXXX，'TEST'，NULL，XXXX）。

所以上面说的是“如果 XXXX = 'TEST'，则为 NULL，否则为 XXXX”。

现在得到了我想要的结果，但是有没有更短的方法（也许是一个 nativefunction）可以这样写：

```
DECODE(XXXX,'TEST',NULL) 
```

所以基本上，如果第一个参数 = 'TEST'，则输出 NULL，否则输出第一个参数。

有点像 NVL，如果 NVL 不为空，NVL 将返回第一个参数。

我只是好奇，因为我的一些语句很长，在一个函数中两次获得所需的输出似乎很浪费。

我知道我可以制作一个自定义功能，但只是好奇是否已经有一个。

希望这是有道理的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:11:41.597

在这种特殊情况下，您可以使用[NULLIF()](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions102.htm)

```
SQL> ed
Wrote file afiedt.buf

  1  with x as (
  2    select 1 id, 'foo' str from dual union all
  3    select 2, 'TEST' from dual
  4  )
  5  select id,
  6         nullif( str, 'TEST' )
  7*   from x
SQL> /

        ID NULL
---------- ----
         1 foo
         2 
```

不过，就我个人而言，我更倾向于使用更冗长的函数`CASE`，`DECODE`而不是使用一些更深奥的内置函数，因为将来必须维护代码的人更有可能更容易遵循代码应该在做。

# flash - Red5 无法用于严肃的流媒体？

> ID：13407028
> 
> 赞同：1
> 
> 时间：2012-11-15T22:03:15.697
> 
> 标签：flash, video-streaming, red5

我正在运行 Red5 V1 RC2，带有 oflaDemo 应用程序和我创建的在 VideoPlayer 组件中显示视频的简单应用程序。我发现播放任何长度合适的视频（超过几分钟）时，Red5 的声音和视频都不同步。

oflaDemo 应用程序附带的演示视频可以毫无问题地播放。他们是同步的。当您尝试播放更长的视频时，就会出现问题。在我的应用程序中，我尝试流式传输长度超过 45 分钟的 mp4 视频，并且看到声音显然在视频之前就开始了，并且比视频信息提前了近一分钟。我所做的一切似乎都无法使声音与视频同步。

考虑到我的代码可能有问题，我使用 oflaDemo 播放了视频。它有同样的问题。

在任何媒体播放器（Windows、Linux 或 Mac）上播放时，声音和视频可以毫无问题地同步。视频信息没有问题。

出于某种原因，显然在 Red5 上，声音信息是在视频信息之前加载的，而服务器没有做任何事情来保持这两个部分的同步。

这是一个严重的问题，似乎是 Red5 流媒体中的一个错误。

有没有其他人看到这个问题？如果是这样，有没有人想出一个解决方法？有谁知道 Red5 的人是否正在解决这个问题？如果不是，为什么不呢？有没有办法让 Red5 视频中的声音和视频同步？有没有可以解决这个问题的杂物？

有人请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:08:13.023

自从我参与任何 Red5 编码以来已经有一段时间了，但我相信这与缺乏正确同步的元数据有关。您是否尝试过将该 mp4 转换为 FLV 文件？Red5 将自动处理 FLV 的元数据创建，而不是 mp4。

另外，我知道用户群和irc频道有点薄，但如果你潜伏的时间足够长，你应该能够从马口中得到更多的细节。

# matlab - "Desort" 一个向量（撤消排序）

> ID：13407030
> 
> 赞同：6
> 
> 时间：2012-11-15T22:03:21.990
> 
> 标签：matlab, sorting, vectorization

在 Matlab 中，`sort`返回排序后的向量和一个索引向量，显示哪个向量元素被移动到哪里：

```
[v, ix] = sort(u); 
```

这里，`v`是一个向量，包含 的所有元素`u`，但已排序。是一个向量，表示in`ix`的每个元素的原始位置。使用 Matlab 的语法，.`v``u``u(ix) == v`

**我的问题：**我如何`u`从`v`和获得`ix`？

当然，我可以简单地使用：

```
w = zero(size(v));

for i = 1:length(v)
    w(ix(i)) = v(i)
end

if nnz(w == u) == length(u)
    print('Success!');
else
    print('Failed!');
end 
```

但我有一种舌尖上的感觉，即有一种更优雅、单一语句、矢量化的方式来做这件事。

* * *

*如果您想知道为什么需要这样做而不是仅仅使用`u`*：我正在尝试实现 Benjamini-Hochberg 过程，该过程在排序后根据向量的位置调整向量的每个元素，但在调整后恢复原始顺序对于我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T22:03:21.990

解决方案是：

```
w(ix) = v; 
```

这是一个有效的 Matlab 操作，只要它`w`至少与 一样大`v`，或者尚未声明。

例子：

```
>> u = [4 8 10 6 2];
>> [v, ix] = sort(u)

    v = 2 4 6 8 10        
    ix = 5 1 4 2 3

>> u(ix)

    ans = 2 4 6 8 10

>> w(ix) = v

    w = 4 8 10 6 2 
```

（为微不足道的问题答案道歉，但我在输入问题时意识到了解决方案，并认为它可能对某人有用。）

# php - 将文件从 Rackspace CloudSite 传输到云文件

> ID：13407033
> 
> 赞同：0
> 
> 时间：2012-11-15T22:03:26.100
> 
> 标签：php, rackspace-cloud, rackspace

只是想知道是否有人知道用于将文件从机架空间云站点传输到机架空间云文件的预先编写的 php 脚本。

Rackspace 确实提供了将文件*备份*到云但不*传输*的脚本。（我才意识到花了几个小时才终于让脚本正常工作）。

[http://www.rackspace.com/knowledge_center/article/how-to-use-cron-to-backup-cloudsites-to-cloudfiles](http://www.rackspace.com/knowledge_center/article/how-to-use-cron-to-backup-cloudsites-to-cloudfiles)

我不知道 PHP（这是 Rackspace cron 作业所必需的），所以如果有一个脚本可以帮助我解决这个问题，那就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-13T16:37:45.513

下面是我备份到 rackspace 时使用的脚本。它使用来自 racker labs 的 php 云文件主库。我将它设置为一个简单的 cron。只需更换电子邮件

```
php 'path/to/backup.php' 
```

* * *

```
<?

require_once('php-cloudfiles-master/cloudfiles.php');

$server_name = 'YOUR_SERVER_NAME'; //Name of the Current Server
$curr_date_time = date("Y-m-d--H:i:s"); //DON' CHANGE - Date
$curr_day = date("Yd"); //DON' CHANGE - Date
$sites = array("ENTERDATABASES HERE IN ARRAY FORMAT"); //Array of Databases to be Backed up
$site_root = "/var/www/";
$temp_dir = "/bak/mysql/"; //temp directory
$site_temp_dir = "/bak/site/"; //temp directory
$rscfUsername = 'YOUR RACKSPACE USERNAME'; // the username for your rackspace account
$rscfApiKey = 'YOUR RACKSPACE API KEY'; // the api key for your account
$rscfContainer = 'YOUR RACKSPACE CONTAINER'; //rackspace containr
foreach($sites as $site) {

try{

 exec("tar -czpf {$site_temp_dir}{$site}{$curr_date_time}_site.tar.gz {$site_root}{$site}");
 // check if the file is created
 if(file_exists("{$site_temp_dir}{$site}{$curr_date_time}_site.tar.gz")) {

 $auth = new CF_Authentication($rscfUsername, $rscfApiKey);
 $auth->ssl_use_cabundle();
 $auth->authenticate();
 $conn = new CF_Connection($auth);
 $conn->ssl_use_cabundle();

 // I allready created a container with this name otherwise user create_container
 $container = $conn->get_container($rscfContainer);

 // make a unique name with date in it so you know when it was created
 $objectName = $site.$curr_date_time.'.tar.gz';
 $store = $container->create_object($objectName);
 $store->load_from_filename("{$site_temp_dir}{$site}{$curr_date_time}_site.tar.gz"); // send to rackspace

 }

 } catch (Exception $e) {
     print_r($e, true);
 }

}

?> 
```

# mysql - MYSQL 导入（不同版本）

> ID：13407034
> 
> 赞同：1
> 
> 时间：2012-11-15T22:03:31.970
> 
> 标签：mysql, linux, phpmyadmin, centos, corruption

我有一个用户数据库，我在硬件故障后设法恢复，但是当我尝试将其导入 PHPMyAdmin 中的新 MYSQL 数据库时，它说它无法读取它，因为它是另一个版本的 MYSQL。我不知道我的旧损坏服务器是哪个版本的 MYSQL？

我不得不让我的客户手动重新注册，然后我再次手动设置所有内容，这需要几个小时。

我拥有的文件是“users.MYD”。有什么方法可以导入忽略兼容性问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:07:58.033

我的建议是安装与您以前拥有的相同版本的 MySQL，将 MYD 文件（和其他文件）粘贴到其中，启动 MySQL，mysqldump 出数据，然后将其插入到新的 MySQL 数据库中。

[附加]

经过大量搜索，这里的问题似乎是旧数据库是 MySQL 4.1 数据库（或更早版本），并且您无法将 MYD/frm 文件从 4.1 db 安装到 MySQL 5.0 数据库 - 方式要做到这一点，就是 mysqldump 数据并将其导入新数据库。因此，这里的挑战是找到一个 MySQL 4.1 数据库，这可能涉及安装一个非常旧的操作系统。

# typescript - 带有构造签名的接口如何工作？

> ID：13407036
> 
> 赞同：192
> 
> 时间：2012-11-15T22:03:36.570
> 
> 标签：typescript, constructor, interface

我在弄清楚接口中定义构造函数的工作方式时遇到了一些麻烦。我可能完全误解了一些东西。但是我已经搜索了很长一段时间的答案，但找不到与此相关的任何内容。

如何在 TypeScript 类中实现以下接口：

```
interface MyInterface {
    new ( ... ) : MyInterface;
} 
```

Anders Hejlsberg 在此[视频](http://media.ch9.ms/ch9/c3e5/e5e02f2e-5962-48db-9ddd-85e27a4fc3e5/IntroducingTSAndersH_mid.mp4)中创建了一个包含类似内容的界面（大约 14 分钟）。但是对于我的一生，我无法在课堂上实现这一点。

我可能误解了一些东西，我没有得到什么？

编辑：

澄清。对于“新（...）”，我的意思是“任何东西”。我的问题是我什至无法获得这个工作的最基本版本：

```
interface MyInterface {
    new () : MyInterface;
}

class test implements MyInterface {
    constructor () { }
} 
```

这不是为我编译我在尝试编译时得到“类'test'声明接口'MyInterface'但没有实现它：类型'MyInterface'需要构造签名，但类型'test'缺少一个”。

编辑：

因此，在给出反馈后，对此进行了更多研究。

```
interface MyInterface {
    new () : MyInterface;
}

class test implements MyInterface {
    constructor () => test { return this; }
} 
```

不是有效的 TypeScript，这并不能解决问题。你不能定义构造函数的返回类型。它将返回“测试”。以下内容的签名： class test { constructor () { } } 似乎是“new () => test”（通过在在线编辑器中将鼠标悬停在“class”上并仅粘贴该代码获得）。这就是我们想要的，也是我认为的。

任何人都可以提供一个实际编译的例子或类似的例子吗？

编辑（再次...）：

所以我可能想出了一个想法，为什么可以在接口中定义它，但不能在 TypeScript 类中实现。以下工作：

```
var MyClass = (function () {
    function MyClass() { }
    return MyClass;
})();

interface MyInterface {
    new () : MyInterface;
}

var testFunction = (foo: MyInterface) : void =>  { }
var bar = new MyClass();
testFunction(bar); 
```

那么，这只是 TypeScript 的一个功能，可以让您与 javascript 交互吗？或者是否可以在 TypeScript 中实现它而无需使用 javascript 实现类？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2012-11-15T23:26:41.107

接口中的构造签名不能在类中实现；它们仅用于定义定义“新”功能的现有 JS API。这是一个涉及确实有效的接口`new`签名的示例：

```
interface ComesFromString {
    name: string;
}

interface StringConstructable {
    new(n: string): ComesFromString;
}

class MadeFromString implements ComesFromString {
    constructor (public name: string) {
        console.log('ctor invoked');
    }
}

function makeObj(n: StringConstructable) {
    return new n('hello!');
}

console.log(makeObj(MadeFromString).name); 
```

这为您可以调用的内容创建了一个实际的约束`makeObj`：

```
class Other implements ComesFromString {
    constructor (public name: string, count: number) {
    }
}

makeObj(Other); // Error! Other's constructor doesn't match StringConstructable 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2012-12-04T10:35:41.650

在搜索完全相同的问题时，我去寻找 TypeScript 团队是如何做到的......

他们声明一个接口，然后声明一个名称与接口名称完全匹配的变量。这也是输入静态函数的方法。

示例来自`lib.d.ts`：

```
interface Object {
    toString(): string;
    toLocaleString(): string;
    // ... rest ...
}
declare var Object: {
    new (value?: any): Object;
    (): any;
    (value: any): any;
    // ... rest ...
} 
```

我试过了，它就像魅力一样。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-03-18T11:38:03.213

好吧，具有构造签名的接口并不意味着由任何类实现（乍一看，这对于像我这样具有 C#/Java 背景的人来说可能看起来很奇怪，但给它一个机会）。略有不同。

暂时把它想象成一个带有调用签名的接口（就像Java世界中的@FunctionalInterface）。它的目的是描述一个函数类型..种类。所描述的签名应该由函数对象满足......但不仅仅是任何高级函数或方法。它应该是一个知道如何构造对象的函数，一个在`new`使用关键字时被调用的函数。

因此，带有构造签名的接口定义了构造函数的签名！应符合接口中定义的签名的类的构造函数（将其视为构造函数实现接口）。它就像一个工厂！

下面是一小段代码，试图演示最常见的用法：

```
interface ClassicInterface { // old school interface like in C#/Java
    method1();
    ...
    methodN();
}

interface Factory { //knows how to construct an object
    // NOTE: pay attention to the return type
    new (myNumberParam: number, myStringParam: string): ClassicInterface
}

class MyImplementation implements ClassicInterface {
    // The constructor looks like the signature described in Factory
    constructor(num: number, s: string) { } // obviously returns an instance of ClassicInterface
    method1() {}
    ...
    methodN() {}
}

class MyOtherImplementation implements ClassicInterface {
    // The constructor looks like the signature described in Factory
    constructor(n: number, s: string) { } // obviously returns an instance of ClassicInterface
    method1() {}
    ...
    methodN() {}
}

// And here is the polymorphism of construction
function instantiateClassicInterface(ctor: Factory, myNumberParam: number, myStringParam: string): ClassicInterface {
    return new ctor(myNumberParam, myStringParam);
}

// And this is how we do it
let iWantTheFirstImpl = instantiateClassicInterface(MyImplementation, 3.14, "smile");
let iWantTheSecondImpl = instantiateClassicInterface(MyOtherImplementation, 42, "vafli"); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-05-24T15:57:25.983

来自官方[**文档**](https://www.typescriptlang.org/docs/handbook/interfaces.html)

> 这是因为当一个类实现一个接口时，只检查类的实例端。由于构造函数位于静态端，因此它不包含在此检查中。
> 
> 相反，您需要直接使用类的静态部分。在本例中，我们定义了两个接口，ClockConstructor 用于构造函数，ClockInterface 用于实例方法。然后，为方便起见，我们定义了一个构造函数 createClock 来创建传递给它的类型的实例：

```
interface ClockConstructor {
  new (hour: number, minute: number): ClockInterface;
}

interface ClockInterface {
  tick(): void;
}

function createClock(
  ctor: ClockConstructor,
  hour: number,
  minute: number
): ClockInterface {
  return new ctor(hour, minute);
}

class DigitalClock implements ClockInterface {
  constructor(h: number, m: number) {}
  tick() {
    console.log("beep beep");
  }
}

class AnalogClock implements ClockInterface {
  constructor(h: number, m: number) {}
  tick() {
    console.log("tick tock");
  }
}

let digital = createClock(DigitalClock, 12, 17);
let analog = createClock(AnalogClock, 7, 32); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-15T23:15:31.957

从设计的角度来看，在接口中指定构造函数要求并不常见。接口应该描述您可以对对象执行的操作。如果需要，应该允许实现接口的不同类需要不同的构造函数参数。

例如，如果我有一个接口：

```
interface ISimplePersistence {
    load(id: number) : string;
    save(id: number, data: string): void;
} 
```

我可能有将数据存储为 cookie 的实现，它不需要构造函数参数，以及将数据存储在数据库中的版本，它需要一个连接字符串作为构造函数参数。

如果您仍然想在接口中定义构造函数，有一种肮脏的方法可以做到这一点，我曾经回答过这个问题：

[具有构造签名而不是类型检查的接口](https://stackoverflow.com/questions/12952248/interfaces-with-construct-signatures-not-type-checking)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-21T21:09:00.230

为了实现预期的行为，您可以使用[Decorators](https://www.typescriptlang.org/docs/handbook/decorators.html)，即使这可能不是它们应该用于的用途。

这

```
interface MyInterface {
    new ();
}

function MyInterfaceDecorator(constructor: MyInterface) {
}

@MyInterfaceDecorator
class TestClass {
    constructor () { }
} 
```

编译没有问题。相比之下，下面的 TestClass 定义

```
// error TS2345: Argument of type 'typeof TestClass' is not assignable to parameter of type 'MyInterface'.
@MyInterfaceDecorator
class TestClass {
    constructor (arg: string) { }
} 
```

不会编译。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-21T08:20:03.483

要扩展[Nils](https://stackoverflow.com/users/180156/nils)的[答案](https://stackoverflow.com/a/13700960/435004)，您还可以`new`使用相同的技术制作一个通用的 -able 函数：

```
interface MyArrayConstructor {
    <T>(...elements: Array<T>): MyArrayInstance<T>
    new <T> (...elements: Array<T>): MyArrayInstance<T>
}

// “Typecast” not the function itself, but another symbol,
// so that the body of myArray will also benefit from
// type-checking:
export const MyArray = myArray as MyArrayConstructor

interface MyArrayInstance<T> {
    push(...args: Array<T>): number
    slice(from?: number, to?:number): Array<T>
}

function myArray(...elements: Array<T>): MyArrayInstance<T> {
  return {
    push(...args) { ... },
    slice(from?: number, to?: number) { ... }
  }
} 
```

# c# - 解析 CSV 文件

> ID：13407037
> 
> 赞同：3
> 
> 时间：2012-11-15T22:03:42.697
> 
> 标签：c#, csv

我们与另一个依赖于来回传递 CSV 文件的系统集成（真的很老派）。

结构一般为：

```
ID, Name, PhoneNumber, comments, fathersname
1, tom, 555-1234, just some random text, bill
2, jill smith, 555-4234, other random text, richard 
```

我们经常看到这样的：

```
3, jacked up, 999-1231, here  
be dragons  
amongst us, ted 
```

我关心的主要问题是检测到`\n`在记录中间出现的换行符 ( ) 是记录终止符。

无论如何我可以预处理它以可靠地修复它吗？

请注意，我们对其他系统发出的内容的**控制为零。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:16:25.737

所以你应该能够或多或少地做这样的事情：

```
for (int i = 0; i < lines.Count; i++)
{
    var fields = lines[i].Split(',').ToList();
    while (fields.Count < numFields)//here be dragons amonst us
    {
        i++;//include next line in this line
        //check to make sure we haven't run out of lines.

        //combine end of previous field with start of the next one, 
        //and add the line break back in.
        var innerFields = lines[i].Split(',');
        fields[fields.Count - 1] += "\n" + innerFields[0];

        fields.AddRange(innerFields.Skip(1));
    }

    //we now know we have a "real" full line
    processFields(fields);
} 
```

（为简单起见，我假设所有行都在开始时被读入；我假设您可以将其更改为足够轻松地懒惰地获取每一行。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:21:15.883

让我开始说您示例中的 CSV 文件无效。如果字符串中出现换行符，则应使用双引号字符将其包裹起来。

现在寻找答案 - 为了解析这种无效的 csv 格式，您必须做几个假设。在这种情况下，我做了 2 个假设：1）ID 列必须是数字 2）评论字段不能包含数字。

基于这些假设，您可以检查换行符之后的第一个字符。如果它是数字，则假设它是一个新记录。如果不是，您应该将其视为注释字段的继续值。

我不知道第二个假设是否成立，如果不成立，您可以增强逻辑，使其涵盖系统的业务规则。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:26:26.173

首先，我建议使用一个工具来管理读取和写入您的 csv 文件，我使用了很棒的[FileHelpers 库](http://filehelpers.sourceforge.net "文件助手")。

您基本上可以输入您的记录，它会为您完成所有验证等。值得努力。

对于您的问题，也许您可​​以对文件进行一些预处理并使用正则表达式将任何换行符替换为空格？

我做了类似的事情（不是文件而是）尝试

```
line.Replace(Environment.NewLine, " "); 
```

使用 FileHelpers，您可以编写一个自定义转换器来在处理期间执行此操作，或者挂钩到 BeforeRead 事件。

# asp.net-mvc-3 - AutoMapper 不会将计算字段映射到标量

> ID：13407044
> 
> 赞同：3
> 
> 时间：2012-11-15T22:04:13.523
> 
> 标签：asp.net-mvc-3, automapper

我正在尝试将我的 MVC3 项目分成适当的 DAL/Domain/ViewModel 架构，但我遇到了 AutoMapper 的问题，并将计算字段从我的域映射到我的视图模型。

这是我正在尝试做的一个例子：

**界面**

```
public interface IRequirement
{
    int Id { get; set; }
    ... bunch of others
    public decimal PlanOct { get; set; }
    public decimal PlanNov { get; set; }
    public decimal PlanDec { get; set; }
    ... and so on
    decimal PlanQ1 { get; }
    ... etc
    decimal PlanYear { get; }
    ... repeat for ActualOct, ActualNov ... ActualQ1 ... ActualYear...
} 
```

**领域模型**

```
public class Requirement : IRequirement
{
    public int Id { get; set; }
    ... bunch of others
    public decimal PlanOct { get; set; }
    public decimal PlanNov { get; set; }
    public decimal PlanDec { get; set; }
    ... and so on
    public decimal PlanQ1 { get { return PlanOct + PlanNov + PlanDec; } }
    ... etc
    public decimal PlanYear { get { return PlanQ1 + PlanQ2 + PlanQ3 + PlanQ4; } }
    ... repeat for ActualOct, ActualNov ... ActualQ1 ... ActualYear...
} 
```

还有 VarianceX 属性，即 VarianceOct 计算为 (PlanOct - ActualOct) 等。

我的视图模型看起来几乎完全相同，除了它具有默认的 getter/setter 语法而不是计算字段，例如：

```
public decimal PlanQ1 { get; set; } 
```

我在 Global.asax 中的 AutoMapper 配置如下所示：

```
Mapper.CreateMap<Domain.Abstract.IRequirement, Models.Requirement.Details>(); 
```

这适用于*除计算属性之外的所有属性*。我的计算字段（即 *Q1、*Q2、*Q3、*Q4、*Year 和所有 Variance* 字段）都没有实际映射——它们都显示为默认值 0.00。

我对此感到很困惑，而且我也是这个和 AutoMapper 的新手，所以也许我错过了一些东西。我的直觉是，由于属性签名不相同（即域对象只有一个非默认的 getter 和没有 setter，而视图模型有默认的 getter 和 setter），所以 AutoMapper 没有选择它。但我也这样做了：

```
Mapper.CreateMap<Domain.Abstract.IRequirement, Models.Requirement.Details>()
            .ForMember(dest => dest.PlanQ1, opt => opt.MapFrom(src => src.PlanQ1); 
```

它仍然解析为 0。我也在调试器中确认了这一点。

我究竟做错了什么？

提前致谢。

**编辑 1**

在听从 Wal 的建议后，我运行了测试并且它成功了，所以我开始一步一步地向后工作，首先将 Field1/Field2/Field3 部分粘贴到接口/域/视图模型类中，并验证它在我的控制器中是否有效，然后一次改变一件事。我发现，由于我处理的是十进制类型，如果我在整数或双精度值中硬编码，那么我得到零，但如果我转换为十进制或使用十进制文字，那么它就可以工作。但前提是我手动设置它们，而不是从数据库中提取值。

换句话说，这有效（即 PlanQ1 = 6）：

```
var D = new Requirement { PlanOct = (decimal) 1.0, PlanNov = (decimal) 2.0, PlanDec = (decimal) 3.0 };
var V = Mapper.Map<IRequirement, Details>(D); 
```

这有效：

```
var D = new Requirement { PlanOct = 1M, PlanNov = 2M, PlanDec = 3M };
var V = Mapper.Map<IRequirement, Details>(D); 
```

但这不会（从存储库对象中提取单个域对象，然后使用实体框架从 SQL Server 中提取）：

```
var D = requirementRepository.Requirement(5);
var V = Mapper.Map<IRequirement, Details>(D); 
```

综上所述，我得到的 PlanQ1 和 PlanYear 都是 0。我验证了域对象 (D) 中的 PlanOct = 1、PlanNov = 2 和 PlanDec = 3。我还验证了所有对象中的类型，包括EF生成的对象，都是十进制的，SQL Server的类型是十进制的。我什至尝试映射到创建的视图模型，只是为了排除这种情况，我仍然得到 PlanQ1 和 PlanYear 的 0：

```
var D = requirementRepository.Requirement(5);
var V = new Details();
Mapper.Map<IRequirement, Details>(D, V); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:29:58.933

是`PlanQ1`成员`IRequirement`？你已经暗示它是你的最后一个代码片段，但如果不是，那么你将得到与你描述的完全一样的行为。

考虑一个您正在做的简单示例：

```
public interface IFoo
{
    string Field1 { get; set; }
    string Field2 { get; set; }
    //string Field3 { get; }
}

public class Foo1 : IFoo
{
    public string Field1 { get; set; }
    public string Field2 { get; set; }
    public string Field3 { get { return Field1 + Field2; } }
}
public class Foo2
{
    public string Field1 { get; set; }
    public string Field2 { get; set; }
    public string Field3 { get; set; }
} 
```

请注意，在这种情况下，我`Field3`从界面中省略了；现在当我运行以下映射*失败*

```
[TestMethod]
public void Map()
{
    Mapper.CreateMap<IFoo, Foo2>();
    var foo1 = new Foo1() { Field1 = "field1", Field2 = "field2" };
    var foo2 = new Foo2();
    Mapper.Map(foo1, foo2);
    Assert.AreEqual("field1field2", foo2.Field3);//fails, not mapped
} 
```

所以，如果我`Field3`从`IFoo`一切工作中再次发表评论。用您的代码检查这个简化的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T01:46:14.997

考虑@Wal 帖子，试试这张地图，

```
Mapper.CreateMap<IFoo, Foo2>()
    .ForMember(destination => destination.Field3, options => options.MapFrom(source => source.Field1 + source.Field2)); 
```

和

```
[TestMethod]
public void Map()
{
    Mapper.CreateMap<IFoo, Foo2>()
        .ForMember(destination => destination.Field3, options => options.MapFrom(source => source.Field1 + source.Field2));
    var foo1 = new Foo1() { Field1 = "field1", Field2 = "field2" };
    var foo2 = new Foo2();
    Mapper.Map(foo1, foo2);
    Assert.AreEqual("field1field2", foo2.Field3); // True
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T15:37:17.380

刚刚意识到这个问题没有得到答复，所以我想关闭它。从技术上讲，这是没有答案的，因为由于某种原因，我无法让 Automapper 在这种情况下发挥出色。我最终要做的是返回并在我的存储库中创建几个映射方法，一个将 DAL 对象的单个实例映射到 IRequirement 对象，另一个映射一个集合。然后在存储库中而不是调用 Mapper.Map 我只是调用我的自定义映射方法，它工作得很好。

我仍然不明白为什么这不起作用，但是我遇到了 Automapper 刚刚抛出的其他一些类，我必须手动映射至少一两个字段，尽管 Automapper 确实会处理其余的那些案例。

我敢肯定，我还没有看到一些关于它的东西。但无论如何，回退到部分或完全手动映射是我的解决方法。

# android - Android MQTT 无法创建客户端

> ID：13407045
> 
> 赞同：2
> 
> 时间：2012-11-15T22:04:15.817
> 
> 标签：android, mqtt

我正在尝试使用 paho 客户端库在我的 android 服务中创建一个 mqtt 客户端。mosquitto 代理正在我的本地机器上运行。当我尝试创建 MQTTClient 的新实例时，我收到了 MqttPersistenceException 异常。

//创建客户端端口=1883 mqttConnSpec="tcp://"+ipaddressOflocalMachine+":"+端口 mqttClient = new MqttClient(mqttConnSpec, mqttClientId)

例外没有给出任何理由。我能够成功地使用 java 控制台应用程序进行通信。在android模拟器中运行它时是否需要额外的东西。任何帮助深表感谢

谢谢本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T10:24:09.727

你能分享更多你的代码吗——你是在设置一个持久性类吗？

有许多很好的资源可以讨论 Android 上的 Java/Paho MQTT 客户端。基本的事情是您确实需要实现一个持久性类或指定提供的内存或文件。这在[另一个 StackOverflow 答案](https://stackoverflow.com/questions/10065624/how-to-send-ping-using-ecipse-paho-mqtt-client)中进行了讨论。另请参阅[此“错误”](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384083)，它解释了您需要确保设置 user.dir 或使用不同的持久性方法。MQTT wiki 上有一个[附加资源列表](http://mqtt.org/wiki/doku.php/mqtt_on_the_android_platform)。

# java - C#/dot Net 和 Java 之间的 GZIP 输出和大小

> ID：13407047
> 
> 赞同：2
> 
> 时间：2012-11-15T22:04:21.963
> 
> 标签：java, .net, gzip

我正在测试在 Java 和 C# 之间压缩一些消息传递的可行性。
使用的消息传递范围从小字符串（40 字节）到大字符串（4K）。

我发现 Java GZIP 实现与 dot Net GZIP 实现的输出存在差异。

我猜 dot Net 的标头更大，导致开销很大。我更喜欢 Java 实现，因为它在小字符串上效果更好，并且希望 dot Net 能够实现类似的结果。

输出，Java 版本 1.6.0_10

```
Text:EncodeDecode
Bytes:(12 bytes)RW5jb2RlRGVjb2Rl  <- Base64
Compressed:(29)H4sIAAAAAAAAAHPNS85PSXVJBZEAd9jYdgwAAAA=
Decompressed:(12)RW5jb2RlRGVjb2Rl
Converted:EncodeDecode

Text:EncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecode
Bytes:(120)RW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2Rl
Compressed:(33)H4sIAAAAAAAAAHPNS85PSXVJBZGudGQDAOcKnrd4AAAA
Decompressed:(120)RW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2Rl
Converted:EncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecode 
```

输出，点网 2.0.50727

```
Text:EncodeDecode
Bytes:(12)RW5jb2RlRGVjb2Rl
Compressed:(128)H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ik6X02qWP83x7/8Dd9jYdgwAAAA=
Decompressed:(12)RW5jb2RlRGVjb2Rl
Text:EncodeDecode

Text:EncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecode
Bytes:(120)RW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2Rl
Compressed:(131)H4sIAAAAAAAEAO29B2AcSZYlJi9tynt/SvVK1+B0oQiAYBMk2JBAEOzBiM3mkuwdaUcjKasqgcplVmVdZhZAzO2dvPfee++999577733ujudTif33/8/XGZkAWz2zkrayZ4hgKrIHz9+fB8/Ik6X02qWP83x7w/z9/8H5wqet3gAAAA=
Decompressed:(120)RW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2RlRW5jb2RlRGVjb2Rl
Text:EncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecodeEncodeDecode 
```

如何在 dot Net 端实现更小尺寸的编码？

注意，
Java 实现可以解码 dot Net 实现，而
dot Net 实现可以解码 Java 实现。

Java 代码

```
@Test
public void testEncodeDecode()
{
    final String strTitle = "EncodeDecode";
    try
    {
        debug( "Text:" + strTitle );

        byte[] ba = strTitle.getBytes( "UTF-8" );
        debug( "Bytes:" + toString( ba ) );

        byte[] eba = encode_GZIP( ba );
        debug( "Encoded:" + toString( eba ) );

        byte[] ba2 = decode_GZIP( eba );
        debug( "Decoded:" + toString( ba2 ) );

        debug( "Converted:" + new String( ba2, "UTF-8" ) );
    }
    catch( Exception ex ) { fail( ex ); }
}
@Test
public void testEncodeDecode2()
{
    final String strTitle = "EncodeDecode";
    try
    {
        StringBuilder sb = new StringBuilder();
        for( int i = 0 ; i < 10 ; i++ ) sb.append( strTitle );

        debug( "Text:" + sb.toString() );

        byte[] ba = sb.toString().getBytes( ENCODING );
        debug( "Bytes:" + toString( ba ) );

        byte[] eba = encode_GZIP( ba );
        debug( "Encoded:" + toString( eba ) );

        byte[] ba2 = decode_GZIP( eba );
        debug( "Decoded:" + toString( ba2 ) );

        debug( "Converted:" + new String( ba2, ENCODING ) );
    }
    catch( Exception ex ) { fail( ex ); }
}
private String toString( byte[] ba )
{
    return "("+ba.length+")"+Base64.byteArrayToBase64( ba );
}
protected static byte[] encode_GZIP( byte[] baData ) throws IOException
{
    ByteArrayOutputStream baos = new ByteArrayOutputStream();

    ByteArrayInputStream bais = new ByteArrayInputStream( baData );
    GZIPOutputStream zos = new GZIPOutputStream( baos );

    byte[] baBuf = new byte[ 1024 ];
    int nSize;
    while( -1 != ( nSize = bais.read( baBuf ) ) )
    {
        zos.write( baBuf, 0, nSize );
        zos.flush();
    }
    Utilities.closeQuietly( zos );
    Utilities.closeQuietly( bais );
    return baos.toByteArray();
}
protected static byte[] decode_GZIP( byte[] baData ) throws IOException
{
    ByteArrayOutputStream baos = new ByteArrayOutputStream();

    ByteArrayInputStream bais = new ByteArrayInputStream( baData );
    GZIPInputStream zis = new GZIPInputStream( bais );

    byte[] baBuf = new byte[ 1024 ];
    int nSize;
    while( -1 != ( nSize = zis.read( baBuf ) ) )
    {
        baos.write( baBuf, 0, nSize );
        baos.flush();
    }
    Utilities.closeQuietly( zis );
    Utilities.closeQuietly( bais );

    return baos.toByteArray();
}

private void debug( Object o ) { System.out.println( o ); }
private void fail( Exception ex )
{
    ex.printStackTrace();
    Assert.fail( ex.getMessage() );
} 
```

点网代码

```
 [Test]
    public void TestJava6()
    {
        string strData = "EncodeDecode";
        Console.WriteLine("Text:" + strData);

        byte[] baData = Encoding.UTF8.GetBytes(strData);
        Console.WriteLine("Bytes:" + toString(baData));

        byte[] ebaData2 = encode_GZIP(baData);
        Console.WriteLine("Encoded:" + toString(ebaData2));

        byte[] baData2 = decode_GZIP(ebaData2);
        Console.WriteLine("Decoded:" + toString(baData2));

        Console.WriteLine("Text:" + Encoding.UTF8.GetString(baData2));
    }
    [Test]
    public void TestJava7()
    {
        string strData = "EncodeDecode";

        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < 10; i++) sb.Append(strData);

        Console.WriteLine("Text:" + sb.ToString());

        byte[] baData = Encoding.UTF8.GetBytes(sb.ToString());
        Console.WriteLine("Bytes:" + toString(baData));

        byte[] ebaData2 = encode_GZIP(baData);
        Console.WriteLine("Encoded:" + toString(ebaData2));

        byte[] baData2 = decode_GZIP(ebaData2);
        Console.WriteLine("Decoded:" + toString(baData2));

        Console.WriteLine("Text:" + Encoding.UTF8.GetString(baData2));
    }
    public string toString(byte[] ba)
    {
        return "(" + ba.Length + ")" + Convert.ToBase64String(ba);
    }
    protected static byte[] decode_GZIP(byte[] ba)
    {
        MemoryStream writer = new MemoryStream();
        using (GZipStream zis = new GZipStream(new MemoryStream(ba), CompressionMode.Decompress))
        {
            Utilities.CopyStream(zis, writer);
        }
        return writer.ToArray();
    }
    protected static byte[] encode_GZIP(byte[] ba)
    {
        using (MemoryStream reader = new MemoryStream(ba))
        {
            MemoryStream writer = new MemoryStream();
            using (GZipStream zos = new GZipStream(writer, CompressionMode.Compress))
            {
                Utilities.CopyStream(reader, zos);
            }
            return writer.ToArray();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T01:57:20.673

这是 .NET gzip 代码中的几个错误之一。应该避免该代码。请改用[DotNetZip](http://dotnetzip.codeplex.com/)。在此处查看答案：[为什么我的 C# gzip 生成的文件比 Fiddler 或 PHP 更大？](https://stackoverflow.com/questions/11435200/why-does-my-c-sharp-gzip-produce-a-larger-file-than-fiddler-or-php/11435898#11435898).

# javascript - Javascript：如果句子逻辑，我做错了什么？

> ID：13407048
> 
> 赞同：0
> 
> 时间：2012-11-15T22:04:23.763
> 
> 标签：javascript, conditional-statements

我目前的解决方案不计算增加的​​运输成本。我的情况不起作用，我已经能够用函数做类似的问题，但我想知道我哪里出错了。

```
<html>
<script type="text/javascript">
var numOrdered = 0;
var priceItem = 0;
var shipCost = 0;
var amtDue = 0;
numOrdered = prompt("Enter the number ordered ",0);
priceItem = prompt("Enter the price of the item ",0);
amtDue = numOrdered * priceItem;
if (amtDue > 1000)
   {
    shipCost = 0;
   }
else
   {
    shipCost = amtDue * .1;
   }
amtDue = amtDue + shipCost;
document.write("You owe ", amtDue);
</script>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:08:50.057

我会查看 Chrome 或 Firefox 中的开发人员工具，并使用 console.log 或设置一些断点来帮助您了解什么是有效的，什么是无效的。通过这种方式，您可以查看是您的 javascript 还是您的 html 文档失败了。

话虽如此，您是在比较字符串而不是数字，因此您需要对从提示符返回的值使用 parseInt。

```
priceItem = parseInt(priceItem, 10);

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:09:03.567

这个对我有用。我把你的代码放在这里：http: [//jsfiddle.net/XVzKb/](http://jsfiddle.net/XVzKb/)

没有变化——如果我输入 5，然后当再次提示 10 时，页面中显示的总数为 55，即 5 * 10 * 1.1 = 55。请注意，如果您的输入包含非数字字符，例如`$`or`,`那么您将需要像这样解析它：

```
number = parseInt(response.replace(/[^0-9]/g, ''), 10) 
```

# c# - LINQ for XML，在读取不同出现的多个元素时遇到问题

> ID：13407050
> 
> 赞同：1
> 
> 时间：2012-11-15T22:04:32.617
> 
> 标签：c#, .net, xml, linq

假设我在下面有以下 XML 文件。我的问题是，如何在使用 LINQ 进行查询时考虑不同数量的名称元素（环境元素的子元素）。当名称元素数量相同时（例如，它们都有 3 个），我可以读取文件甚至查询。我的目标是使用 XML 文件中的名称填充具有列表调用环境的对象。任何帮助，将不胜感激。

```
 <database type="prod">
    <name>DB1</name>
    <server>
        <name>prodserver.net</name>
    </server>
    <connection>
        <name>u1</name>
        <password>b1</password>
    </connection>
    <environment>
        <name>test1</name>
        <name>test2</name>
        <name>test3</name>
    </environment>
</database>
      <database type="dev">
    <name>DB2</name>
    <server>
        <name>devserver.net</name>
    </server>
    <connection>
        <name>u11</name>
        <password>b11</password>
    </connection>
    <environment>
        <name>test1</name>
        <name>test2</name>
        <name>test3</name>
                          <name>test4</name>
                          <name>test5</name>
    </environment>
</database> 
```

或者也许为了让它更容易，假设我有以下

```
 <student name="A" class="1">
<classes>
  Math
</classes>
</student>  
<student name="B" class="2">
  <classes>
   Programming
  </classes>
</student> 
```

我运行以下代码：

```
var students = doc.Root
                          .Elements("student")
                          .Select(x => new Student
                          {
                              Name = (string)x.Attribute("name"),
                              Class = (string)x.Attribute("class"),
                              Type = (string)x.Elements("classes").Single().Value
                          })
                          .ToList(); 
```

它工作正常，但是当我再添加一个类元素时，它会中断：

```
 <student name="A" class="1">
<classes>
  Math
</classes>
<classes>
  Java
</classes>
</student>  
<student name="B" class="2">
  <classes>
    Programming
  </classes>
</student> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:07:47.020

你的意思不是很清楚......假设你有（比如说）一个`Environment`类型，其构造函数接受 a`List<string>`作为名称，你会使用：

```
// If element is the <environment> element
Environment = new Environment(element.Elements("name")
                                     .Select(x => x.Value)
                                     .ToList()); 
```

# jquery - 使用 AJAX 和 Rails 刷新部分时出现问题

> ID：13407052
> 
> 赞同：1
> 
> 时间：2012-11-15T22:04:33.650
> 
> 标签：jquery, ruby-on-rails, ajax

我是 web 开发的新手，我目前正在为 Rails 开发一个简单的项目。现在，我有一个数据库，其中的条目都有一个条目日期，我有一个索引页面，显示本周的所有条目，效果很好。

下一步是实现一个方法让用户选择一周（当前使用 jQuery UI 日期选择器）然后单击一个按钮，该按钮会自动刷新索引页面上的部分以显示该周的条目。

这是我到目前为止所拥有的：

在 /app/views/reports/index.html.erb

```
<script>$(function() {
  $("#datepicker").datepicker();
  $("#datepicker").val($.datepicker.formatDate('mm/dd/yy', new Date()));
});</script>
<% require 'date' %>
<h1>Listing reports</h1>

<input type="datetime" id="datepicker" /> <%= button_to "Select Date", :action =>     'showEntries', :remote => 'true' %>

<div id="displayReports">
<%= render 'display', :date => Date.today %>
</div>

<br />

<%= link_to 'New Report', new_report_path %>
<%= link_to 'Send Weekly Email', weekly_email_reports_path %> 
```

在 /app/views/reports/_display.html.erb

```
<% require 'date' %>
<table>
  <tr>
   <th>App</th>
    <th>Week</th>
    <th>Completed</th>
    <th>Planned</th>
    <th>Releases</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @reports.each do |report| %>
<% if report.entrydate.strftime('%U') == date.strftime('%U') %>
  <tr>
    <td><%= report.app %></td>
    <td><%= report.entrydate %></td>
    <td><%= report.completed %></td>
    <td><%= report.planned %></td>
    <td><%= report.releases %></td>
    <td><%= link_to 'Show', report %></td>
    <td><%= link_to 'Edit', edit_report_path(report) %></td>
    <td><%= link_to 'Destroy', report, :method => :delete, :data => { :confirm => 'Are you sure?' } %></td>
  </tr>
<% end %>
<% end %>
</table> 
```

在 /app/controllers/reports/showEntries.js.erb

```
var selectDate = $("#datepicker").val();
$("#displayReports").html("<%= escape_javascript(render(:partial => 'display', :locals => { :date => " + selectDate + " })).html_safe %>"); 
```

在 /config/routes.rb

```
Summary::Application.routes.draw do
  resources :reports do
    collection do
      get 'weekly_email'
      post 'showEntries'
    end
  end

  get "home/index"
end 
```

当我尝试运行该页面时，出现错误：

```
No route matches {:action=>"showEntries", :remote=>"true", :controller=>"reports"} 
```

很多类似于这个问题的问题并没有真正帮助我。如果你能指出我做错了什么或者一个网站可以阅读 Rails AJAX 调用，那就太好了。谢谢。<3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:43:22.853

您应该将动作 showEntries 的名称更改为 show_entries。我猜你的控制器中有一个动作 show_entries 并且在路由中拼错了它。

# multithreading - 以 100 毫秒延迟运行一个函数后另一个函数（多线程 - VB6 - excel）

> ID：13407053
> 
> 赞同：0
> 
> 时间：2012-11-15T22:04:35.083
> 
> 标签：multithreading, vb6, excel-2007

是否可以在单独的线程中以 100 毫秒的延迟在另一个函数之后运行一个函数。我想创建一个函数来更改 excel 中的一个单元格，并通过 Visual Basic 6 tnx 中的单独线程以 100ms 延迟运行另一个函数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T11:36:44.303

您可以使用 API

在您的声明部分添加以下内容：

**Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)**

要使用它：

**sleep 100' 休眠 0.1 秒**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T03:12:15.260

ActiveX DLL 实例也在它们自己的线程上运行，但都在一个进程中。因此，您不需要进程间通信的额外开销。当然，Excel 无论如何都会在单独的进程中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:20:36.783

可以通过创建 ActiveX exe 来实现。在此处查看 wqw 的答案，[在 vb6 中使用线程编程](https://stackoverflow.com/questions/383162/to-use-thread-in-programming-in-vb6)。100ms 秒延迟将是 ~100ms 延迟。根据您希望延迟的准确程度，您可以使用精确到 10 毫秒左右的本机 VB 计时器，或者为了获得更高的分辨率，您可以使用多媒体计时器（使其难以调试），或者获得一个实现高分辨率计时器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T22:42:04.343

使用 ActiveX exe 在 VB6 中执行多线程是可能的。这些是“进程外”，因此可以加载并立即返回。我这样做已经很多年了，但我想我可能已经使用了一个计时器来让我加载类并立即返回，然后让类在其过程中继续工作。

不过，这种方法很可怕——以任何明智的方式管理它都是一场噩梦。

对您来说更好的选择是在 VB.Net 中编写您想要的内容（我认为您应该可以在 Express 版本中执行此操作），并将程序集设置为与 COM 兼容。然后您可以在您的 VBA 或其他任何内容中引用此功能。

# oauth - 行为改变：如果指定别名地址，GetUser 现在返回真实用户

> ID：13407057
> 
> 赞同：1
> 
> 时间：2012-11-15T22:04:51.760
> 
> 标签：oauth, alias, provisioning, google-provisioning-api

在获取用户帐户时，Provisioning API 最近似乎发生了一些变化： [https ://developers.google.com/google-apps/provisioning/#retrieving_users_experimental](https://developers.google.com/google-apps/provisioning/#retrieving_users_experimental)

以前，如果您指定的地址是别名/昵称，而不是用户，则会收到 1301 错误。现在它为主要用户返回结果。这是 GAM 显示的内容：

验证 admin2@ 是 admin 的别名：

```
C:\gam>gam info alias admin2
send: 'GET https://apps-apis.google.com/a/feeds/alias/2.0/jay.powerposters.org/a
dmin2@jay.powerposters.org HTTP/1.1\r\nAccept-Encoding: identity\r\nHost: apps-a
pis.google.com\r\nContent-Type: application/atom+xml\r\nAuthorization: OAuth rea
lm="", oauth_nonce="xxx", oauth_timestamp="xxx", oauth_consumer_key=
"xxxx", oauth_signature_method="HMAC-SHA1", oa
uth_version="1.0", oauth_token="xxx"
, oauth_signature="xxx"\r\nUser-Agent: Google App
s Manager 2.54 / jay@ditoweb.com (Jay Lee) / Python 2.7.3 final / Windows-7-6.1.
7601-SP1 AMD64 / GData-Python 2.0.14+20110902+custom_mods\r\n\r\n'
reply: 'HTTP/1.1 200 OK\r\n'
header: Content-Type: application/atom+xml; charset=UTF-8
header: Expires: Thu, 15 Nov 2012 21:57:50 GMT
header: Date: Thu, 15 Nov 2012 21:57:50 GMT
header: Cache-Control: private, max-age=0, must-revalidate, no-transform
header: Vary: Accept, X-GData-Authorization, GData-Version
    header: GData-Version: 1.0
    header: Last-Modified: Thu, 15 Nov 2012 21:57:50 GMT
header: X-Content-Type-Options: nosniff
header: X-Frame-Options: SAMEORIGIN
header: X-XSS-Protection: 1; mode=block
header: Server: GSE
header: Transfer-Encoding: chunked
 Alias Email: admin2@jay.powerposters.org
 User Email: admin@jay.powerposters.org 
```

获取“用户”别名2：

```
C:\gam>gam info user admin2
send: 'GET https://apps-apis.google.com/a/feeds/user/2.0/jay.powerposters.org/ad
min2@jay.powerposters.org HTTP/1.1\r\nAccept-Encoding: identity\r\nHost: apps-ap
is.google.com\r\nContent-Type: application/atom+xml\r\nAuthorization: OAuth real
m="", oauth_nonce="xxx", oauth_timestamp="xxx", oauth_consumer_key="
xxx", oauth_signature_method="HMAC-SHA1", oau
th_version="1.0", oauth_token="xxx",
 oauth_signature="xxx"\r\nUser-Agent: Google Apps Man
ager 2.54 / jay@ditoweb.com (Jay Lee) / Python 2.7.3 final / Windows-7-6.1.7601-
SP1 AMD64 / GData-Python 2.0.14+20110902+custom_mods\r\n\r\n'
reply: 'HTTP/1.1 200 OK\r\n'
header: Content-Type: application/atom+xml; charset=UTF-8
header: Expires: Thu, 15 Nov 2012 21:59:32 GMT
header: Date: Thu, 15 Nov 2012 21:59:32 GMT
header: Cache-Control: private, max-age=0, must-revalidate, no-transform
header: Vary: Accept, X-GData-Authorization, GData-Version
header: GData-Version: 1.0
header: Last-Modified: Thu, 15 Nov 2012 21:59:32 GMT
header: X-Content-Type-Options: nosniff
header: X-Frame-Options: SAMEORIGIN
header: X-XSS-Protection: 1; mode=block
header: Server: GSE
header: Transfer-Encoding: chunked
User: admin2@jay.powerposters.org
First Name: Admin+
Last Name: USER
Is an admin: true
Has agreed to terms: true
IP Whitelisted: false
Account Suspended: false
Must Change Password: false 
```

这种新行为破坏了诸如“gam whatis”之类的 GAM 命令，因为该命令在尝试以用户身份访问地址时依赖于获取 1301。我可以想象其他功能类似的应用程序也坏了。

周杰伦

# python - 使用换行符和复选框格式化 Jinja2 中的列表

> ID：13407059
> 
> 赞同：0
> 
> 时间：2012-11-15T22:04:54.590
> 
> 标签：python, jinja2

我使用以下代码获取文件列表并返回每个项目之间带有换行符的列表。我想要做的是为每个项目添加一个复选框，但`string.join`只允许 2 个参数。

这是我尝试过的产生错误的方法`TypeError: join() takes at most 2 arguments (3 given)`：

```
listfiles = os.listdir('my_path')
col_list = string.join('<input type="checkbox" />', listfiles, '</br>') 
```

我应该如何格式化我的文件列表，以便每一行都有一个复选框和一个换行符？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:09:27.577

这是关于阅读错误消息的课程。有些是神秘的，很难理解。这一点很清楚：您将三个参数传递给一个只需要两个参数的函数。[您始终可以在Python 文档](http://docs.python.org/2/index.html)中查看标准库函数和方法的文档，或者在命令提示符处使用`help()`任何对象上的函数。例如`help(string.join)`.

但是，不要`string`为此使用该模块，因为该用法已被弃用。字符串有一个内置的`.join()`方法。

您正在寻找

```
col_list = '<br />'.join('<input type="checkbox" name="..." />%s' % filename
                         for filename in listfiles) 
```

# c++ - 无法返回节点指针

> ID：13407061
> 
> 赞同：1
> 
> 时间：2012-11-15T22:04:58.080
> 
> 标签：c++

我正在编写一个 C++ 链表类。我已经实现并测试了插入和打印。但是，我似乎无法返回用于删除的节点指针。尝试删除时出现以下错误：

```
 Node.h:11: error: expected unqualified-id before "delete"
    Node.h:11: error: abstract declarator `Node*' used as declaration
    Node.h:11: error: expected `;' before "delete"

    Node.cpp:21: error: expected unqualified-id before "delete"
    Node.cpp:21: error: expected init-declarator before "delete"
    Node.cpp:21: error: expected `,' or `;' before "delete"

    make.exe: *** [Node.o] Error 1

    Execution terminated 
```

这是我的代码：

节点.h

```
 #ifndef Node_H
    #define Node_H

    class Node{
          int data;
          Node* next;

    public:
           Node(int data);       
           void insert(int d);
           Node* delete(int d);
           void printOut(void);
    };

    #endif 
```

节点.cpp

```
 #include <stdio.h>
    #include "Node.h"

    Node::Node(int d){
          data = d;
          next = NULL;
          }

    void Node::insert(int d){

          Node* n = this;
          Node* current = new Node(d);

          while(n->next != NULL){
                  n = n->next;                   
                  }

          n->next = current;
          }

    Node* Node::delete(int d){

          Node* head = this;
          Node* n = this;

          if (n->data = null){
             return n;
             }

          if (n->data == d){
             return n->next;
             }

          while(n->next != NULL){

          if (n->next->data == d){
             n->next = n->next->next;
             return head;
             }

          n = n->next;

          }

        return head;

        }

    void Node::printOut(void){

         Node* n = this;

         while(n->next != NULL){
                      printf("%d ->", n->data);
                       n = n->next;                   
                       }

         printf("%d \n", n->data);

         } 
```

主要的：

```
 #include <iostream>
    #include <stdio.h>
    #include <cstdlib>

    #include "Node.h"
    using namespace std;

    int main (void){
        int i = 0;

        Node* root = new Node(111);
        Node* result;

        for (i = 0; i < 9; i++){
            root->insert(i);
            } 

        root->printOut();

        result = root->delete(5);

        result->printOut();

        printf("Hello j \n");

        getchar();
        delete[] root; 
        return 0;   
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:08:17.920

`delete`是 c++ 关键字，您不能将其用作函数名`Node* Node::delete(int d)` ，您可以将函数名更改为`Node* Node::remove(int d)`

[http://en.cppreference.com/w/cpp/keyword](http://en.cppreference.com/w/cpp/keyword)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T22:17:22.643

以前的海报已经告诉你这个问题 - 这`delete`是一个保留的 C++ 关键字，你不能将它用作你的函数名。

我想指出您的代码的其他一些问题：

1.  首先，你打电话`delete[] root;`但那是错误的......`root`不是由`new[]`but with分配的`new`，所以必须用`delete`and not解除分配`delete[]`。
2.  其次，您不会删除列表中的任何节点。这对于这个小程序来说可能没问题（当你的程序退出时，内存将返回给 O/S）你仍然在泄漏内存。你分配的每个指针都`new`必须被释放，`delete`你分配的每个指针都`new[]`必须被释放`delete[]`。请记住，`new`并且`delete`必须成对出现。
3.  最后但同样重要的是：看看当您尝试在仅由单个根组成的列表上调用“printOut”时会发生什么。你会看到没有任何东西被打印出来。有关为什么会发生这种情况的提示，请查看 printOut() 中的代码，然后对自己说出代码的逻辑，就好像您是一台执行它的计算机一样。

祝你好运。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-15T22:06:30.987

标记`delete`是[C++ 中的保留关键字](http://en.cppreference.com/w/cpp/keyword)。为函数选择一个不同的名称（如`remove`）。

# php - 防止多次刷新依靠统计脚本

> ID：13407062
> 
> 赞同：0
> 
> 时间：2012-11-15T22:05:03.753
> 
> 标签：php

我正在做一个项目，我们的 Web 应用程序之一将以某种方式使用 JavaScript 代码来收集**有关访问者的统计信息**但据我所知，在服务器端 PHP 应用程序上，我应该以某种方式处理代码，即多次刷新不计算在内，并且基于 IP 的计数不是一个好主意，因为许多用户可能具有相同的 IP、cookie 或会话也容易受到这个问题的影响，因为 cookie 管理器可以清除与站点相关的所有 cookie，因此 PHP 不会识别用户并将其计数为新用户，时间框架作业和所有其他解决此问题的方法也一样我知道基于 cookie 或会话或 ip 或 ip/referrer 和来自标头的所有其他可用数据的混合，我如何处理它并从用户那里获得更可靠的数据，并且不允许他们创建虚假统计信息。因为我相信一定有办法（我希望如此）......！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:11:17.920

我认为 cookie 是解决这类问题的理想选择，但如果你不想使用它，那么你自己就有了一个坚韧的 cookie。不幸的是，由于 HTTP 是无状态的，因此您没有很多其他选择。

在这种情况下，我会使用会话变量，因为用户无法干预保存在那里的数据。然而，存在会话劫持的风险，但如果您的站点对该漏洞持开放态度，则您需要在更全局的层面上保护站点，而不仅仅是命中计数器。session 变量绑定到您的站点，因为其中的数据保存在服务器上而不是用户浏览器中。并且绑定到您的用户，因为它在用户浏览器中保存一个带有密钥的 cookie，以从服务器请求数据。

这是一个示例，说明如何实现这一点，而不必担心删除站点上的其他会话。

```
<?php
function hit_counter() {
    if(isset($_SESSION['hit_counter'])) { // Check if the user has the hit_counter session
        if(isset($_SESSION['hit_counter']['time']) && isset($_SESSION['hit_counter']['page'])) { // Check if the user has the time and the page set from the last visit
            $last_time = $_SESSION['hit_counter']['time'];
            $last_page = $_SESSION['hit_counter']['page'];

            $now = time(); // The current UNIX time stamp in seconds
            $current_page = $_SERVER['REQUEST_URI']; // The page name

            /*
                If the users hasn't requested this page
                in the last 10 seconds or if the user 
                comes from another page increment the 
                hit counter
            */
            if(($now - $last_time) > 10 || $last_page != $current_page) {
                /* INCREMENT YOUR HIT COUNTER HERE */
            }
        }

        unset($_SESSION['hit_counter']); // Delete this hit counter session
    }

    // And create a new hit counter session
    $_SESSION['hit_counter'] = array();
    $_SESSION['hit_counter']['time'] = time();
    $_SESSION['hit_counter']['page'] = $_SERVER['REQUEST_URI'];
}
?> 
```

您将永远不会触及任何其他会话变量，因为您只是在`unset()`输入命中计数器变量。不需要你处理`session_destroy()`，但你需要确保`session_start()`在你想使用函数的每个页面的开头都有一个。

如果您只想在用户来自您网站上的另一个页面时计算点击次数，您可以编辑脚本以不考虑时间。

据我所知，这是一个对大多数站点具有合理安全级别的计数器。或者至少是一个好的开始。

有关[PHP 会话](http://www.php.net/manual/en/intro.session.php)的更多信息。

# java - 为什么 Struts 2 没有提供更简单的方法来检索请求参数？

> ID：13407065
> 
> 赞同：2
> 
> 时间：2012-11-15T22:05:14.470
> 
> 标签：java, servlets, struts2

我将应用程序从 servlet 重写为 Struts 2。

以前为了获取参数值，我可以写：

```
request.getParameter("name"); 
```

现在我应该这样做：

```
public class MyAction implements ParameterAware {
  private Map<String, String[]> parameters;

  @Override
  public void setParameters(Map<String, String[]> parameters) {
    this.parameters = parameters;
  }

  public String getParameterValue(String name){
    return parameters.get(name)[0];
  }

  // get this parameter 
```

当我使用 servlet 时，这要容易得多！

为了使代码 DRYer，我可以创建类 CustomActionSupport 扩展 ActionSupport 并将此代码放在那里。但是为什么 Struts 不为我做呢？我怎样才能让我的生活更轻松？

[我使用 ParameterAware 作为文档[说这是一种首选方式](http://struts.apache.org/2.x/docs/how-can-we-access-request-parameters-passed-into-an-action.html)。]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T22:09:54.003

Struts2 的正常用例是拥有与参数对应的动作属性，并让[参数拦截器](https://struts.apache.org/core-developers/parameters-interceptor.html)在执行动作之前为您设置这些属性。

Struts2 试图隐藏您的操作作为 HTTP 请求的结果被调用的事实。尝试直接使用参数正在与这种范式作斗争。

* * *

这是一个依赖参数拦截器[的小例子。](http://struts.apache.org/2.3.4.1/docs/coding-struts-2-actions.html)首先，定义一个值对象。

```
public class Name {

  private String firstName;
  private String surname;

  public void setFirstName(String s) {
    this.firstName = s;
  }

  public void setSurname(String s) {
    this.surname = s;
  }

  /* Some interesting operations on Name... */

} 
```

定义要使用的 Struts2 动作`Name`。name 的属性将在`execute()`调用之前使用 HTTP 参数设置。

```
public class NameAction extends Action {

  private final Name name = new Name();

  public Name getName() {
    return name;
  }

  public String execute() {
    /* Use "name" to do something interesting; its properties are set. */
  }

} 
```

现在创建一个使用您的操作的表单：

```
<s:form action="name">
  <s:textfield name="name.firstName" label="First name" />
  <s:textfield name="name.surname" label="Last name" />
  <s:submit/>
</s:form> 
```

现在，`Name`当表单提交到`NameAction`.

您可以设置框架做更多的事情，例如验证参数、使用 IoC 容器向您的操作注入对象等。

# css - 多个流体图像

> ID：13407068
> 
> 赞同：0
> 
> 时间：2012-11-15T22:05:27.373
> 
> 标签：css, html, responsive-design, fluid-layout

我有一个简单的容器，里面有一张图片。

```
<div class="container" style="width:800px;">
     <img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg">
</div> 
```

如果我设置 img 样式`max-width: 100%;`，容器可以更改宽度并缩放其中的图像。完美的。

但是，如果容器内有一些图像怎么办？像这样。

```
<div class="container" style="width:800px; background:red;">
    <img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg">
    <img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg">
    <img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg">
</div> 
```

上面的代码不会执行任何缩放并溢出到下一行 - 扩展容器高度。

如何使用纯 CSS 使图像均匀缩放以适应固定宽度？甚至可能吗？

沙盒： http: [//tinkerbin.com/ijy5zgH3](http://tinkerbin.com/ijy5zgH3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:23:48.940

如果您愿意更改 HTML 结构，这将起作用。

HTML：

```
<ul class="container" style="width:800px;">
    <li><img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg"></li>
    <li><img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg"></li>
    <li><img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg"></li>
</ul> 
```

CSS：

```
img {max-width: 100%; }
li { display: table-cell; } 
```

[​演示](http://jsfiddle.net/XStVp/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:28:53.867

不理想，但在这种情况下，您可以保留`img {max-width: 100%;}`但诉诸`<table>`

```
<table class="container" style="width:800px;">
    <tr>
        <td><img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg"></td>
        <td><img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg"></td>
        <td><img src="http://www.lovehkfilm.com/panasia/aj6293/gu_gu_the_cat.jpg"></td>
    </tr>
</table> 
```

# kendo-ui - 如何使用 MVC 的服务器端包装器设置剑道图表的高度？

> ID：13407078
> 
> 赞同：9
> 
> 时间：2012-11-15T22:06:10.997
> 
> 标签：kendo-ui

如何设置以下代码生成的图表的高度？

```
@(Html.Kendo().Chart()
.Name("Chart")
.Title("Wear")
.Series(series => { series.Column(new[]
                            {
                                measure1, measure2, measure3, measure4, measure5
                            }).Color("#585858"); })
.Tooltip(tooltip => tooltip.Visible(true).Format("{0}"))
 ) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T00:21:54.717

您好，您可以尝试使用 HtmlAttributes 方法来指定具有所需宽度的样式。

例如

```
@(Html.Kendo().Chart()
   .HtmlAttributes(new {style="width:200px;"})
 //... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-12T11:23:55.023

You can try the following;

```
@(Html.Kendo().Chart()
   .Name("Chart")
   .Title("Wear")
   .Series(series => { series.Column(new[]
                      {
                       measure1, measure2, measure3, measure4, measure5
                      }).Color("#585858"); })
   .Tooltip(tooltip => tooltip.Visible(true).Format("{0}"))

   .ChartArea(x => x.Height(350))
 ) 
```

# ios - 如何关闭 UIPopoverController 并选择表格单元格？

> ID：13407079
> 
> 赞同：1
> 
> 时间：2012-11-15T22:06:12.100
> 
> 标签：ios, uitableview, uipopovercontroller, uitapgesturerecognizer

选择表格视图单元格时，我会显示一个弹出框。但是，如果用户选择另一个表格单元格，我想立即在弹出窗口中显示新内容（而不是等待弹出窗口关闭，然后用户再次点击以显示新内容）。

我尝试将 UITapGestureRecognizer 添加到视图中，以便我可以检测到表点击或视图外的点击。但是，由于仍显示弹出框，因此不会调用点击手势。

我知道 UIPopoverControllerDelegate 方法： – popoverControllerShouldDismissPopover： – popoverControllerDidDismissPopover：

但是从 popoverControllerShouldDismissPopover 返回 YES 或 NO 不允许调用点击手势。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:13:33.857

看一眼：

```
@property (nonatomic, copy) NSArray *passthroughViews 
```

> 弹出框可见时用户可以与之交互的一组视图。

这样，当您在弹出框外点击时，您的弹出框不会被关闭。

# html - 将 div 设置为表格，可以接受吗？

> ID：13407080
> 
> 赞同：1
> 
> 时间：2012-11-15T22:06:15.480
> 
> 标签：html, css

我正在开发一个模板，并且我知道使用 CSS 比使用 HTML 表格进行定位更好......但是，在我的 div 上获得两全其美并使用类似表格的样式是否可以接受？例如：

```
display: table; 
```

这不仅可以帮助我解决粘页脚问题，还可以避免与浮动相关的痛苦。不确定这是否会被视为丑陋的黑客或雄辩的解决方案。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:22:49.550

*丑陋的黑客...您可以使用clearfix*方法处理浮动，并且有大量的粘性页脚技术（例如[这个](http://ryanfait.com/sticky-footer/)）可以使用。

如果这是一个问题，`display: table` [IE7 及以下版本也不支持。](http://caniuse.com/#search=%20table)

您应该继续为您的布局使用更新的语义元素 - *header*，*section*，*footer*等，并在您只想显示一些表格数据时使用*table -s。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:30:00.100

我个人认为使用`display: table`. 我不建议广泛使用它，但有时它对于以您想要的方式显示某些内容非常有用，而无需添加一堆额外的 HTML 或处理繁琐的 CSS 规则以使某些内容看起来像您想要它。

如果它适用于您在开发中针对的客户端浏览器，并且可以在其他领域为您节省痛苦或复杂性，那么请随意使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:54:25.093

没有理由害怕或厌恶`display: table`。是的，值是`table`，但它是公平的游戏并且完全有效的 CSS 2.1。

表格在标记中是“不好的”，因为它们被滥用和应用的方式没有反映其预期的语义目的，即呈现表格数据。如果您有表格数据，那么不使用表格与使用表格进行布局一样大。

让我们回到主题。在 IE < 8 中支持`display: table`有点不稳定，在 Android < 2.1 和 iOS < 3.2 中不存在。如果您需要支持这些，请使用`float`.

此属性最简单的用途是应用于`display: table`父元素、子元素`display: table-row`和孙子元素`display: table-cell`。如果您在任何级别偏离这一点，结果可能会有点奇怪。（我对此有个人经验。）如果您遇到困难，请查看 CSS 表格模型的 W3C 规范。

**来源：**
[http ://caniuse.com/css-table](http://caniuse.com/css-table)
[http://www.w3.org/TR/CSS21/tables.html#table-display](http://www.w3.org/TR/CSS21/tables.html#table-display)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T22:15:46.667

这取决于。虽然 CSS div 是 HTML 中任何事物的最佳解决方案（除非您需要 IE6 支持...），并且表格（就标记而言）正在成为一项古老的技术，但一方面它可能会想出最曾经做过的关于 CSS 的残障和愚蠢的解决方案，另一方面，您可以在没有单个 div 的情况下创建 HTML 杰作。

因此，如果您认为自己的 CSS 足够好，请使用它。如果您不确定，或者您是真正的表格大师，表格应该可以完成工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T22:17:58.670

我个人从未使用过`display: table`，但这个链接似乎非常精通语法。

[http://www.onenaught.com/posts/201/use-css-displaytable-for-layout](http://www.onenaught.com/posts/201/use-css-displaytable-for-layout)

我通常坚持使用花车，在阅读完这篇文章后，可能会给`display: table`一个机会。当我使用浮点数时，我必须使用某种`clear: both`div 来跟进它。`display: table`似乎是解决该问题的更有效和可接受的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-15T23:05:59.103

如前所述，表格非常适合表格数据。当您获取大量动态数据时，我也喜欢使用表格。对于模板开发，我会坚持使用 CSS。

# php - 你如何使用 PHP 用 FPDF 制作这样的表格？

> ID：13407085
> 
> 赞同：8
> 
> 时间：2012-11-15T22:06:39.597
> 
> 标签：php, pdf-generation, tcpdf, fpdf

你如何使用 PHP 用 FPDF 制作这样的表格？

我似乎无法弄清楚如何使用`$this->Cell`.

![桌子](../Images/57be8dc5c2f369b6234d53462381420f.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-16T06:12:26.603

FPDF 无法识别`rowspan`或`colspan`. 这是您可以尝试的解决方法，使用空单元格`border`和[`Cell`](http://www.fpdf.org/en/doc/cell.htm).

```
$pdf->Cell(40,5,' ','LTR',0,'L',0);   // empty cell with left,top, and right borders
$pdf->Cell(50,5,'Words Here',1,0,'L',0);
$pdf->Cell(50,5,'Words Here',1,0,'L',0);
$pdf->Cell(40,5,'Words Here','LR',1,'C',0);  // cell with left and right borders
$pdf->Cell(50,5,'[ x ] abc',1,0,'L',0);
$pdf->Cell(50,5,'[ x ] checkbox1',1,0,'L',0);
$pdf->Cell(40,5,'','LBR',1,'L',0);   // empty cell with left,bottom, and right borders
$pdf->Cell(50,5,'[ x ] def',1,0,'L',0);
$pdf->Cell(50,5,'[ x ] checkbox2',1,0,'L',0); 
```

结果将是- ![fpdf 表格示例](../Images/43363c1951732f81de81eb49e99b9d53.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-04-15T20:15:06.200

我想我找到了其他解决方案，这是我不需要空单元格的解决方案。

```
$pdf->Cell(40,18,'Words Here', 1,0, 'C');
$x = $pdf->GetX();
$pdf->Cell(40,6,'Words Here', 1,0);
$pdf->Cell(40,6,'Words Here', 1,1);
$pdf->SetX($x);
$pdf->Cell(40,6,'[x] abc', 1,0);
$pdf->Cell(40,6,'[x] Checkbox 1', 1,1);
$pdf->SetX($x);
$pdf->Cell(40,6,'[x] def', 1,0);
$pdf->Cell(40,6,'[x] Checkbox 1', 1,1); 
```

结果如下：

[![结果](../Images/d19375734ab171dbce6836d5c6592cd9.png)](https://i.stack.imgur.com/T9bWk.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T14:17:03.983

谢谢，这有帮助，这对我有用：

```
$this->Cell(40,5,' ','LTR',0,'L',0);   // empty cell with left,top, and right borders
$this->Cell(50,5,'111 Here',1,0,'L',0);
$this->Cell(50,5,'222 Here',1,0,'L',0);

                $this->Ln();

$this->Cell(40,5,'Solid Here','LR',0,'C',0);  // cell with left and right borders
$this->Cell(50,5,'[ o ] che1','LR',0,'L',0);
$this->Cell(50,5,'[ x ] che2','LR',0,'L',0);

                $this->Ln();

$this->Cell(40,5,'','LBR',0,'L',0);   // empty cell with left,bottom, and right borders
$this->Cell(50,5,'[ x ] def3','LRB',0,'L',0);
$this->Cell(50,5,'[ o ] def4','LRB',0,'L',0);

                $this->Ln();
                $this->Ln();
                $this->Ln(); 
```

# android - android getlastknown location在三星galaxy s3中崩溃

> ID：13407090
> 
> 赞同：2
> 
> 时间：2012-11-15T22:07:08.913
> 
> 标签：android, google-maps

当我尝试在三星 Galaxy s3 上获取我的位置时，我的应用程序崩溃了。它在我测试过的其他 3 部手机上完美运行。我在三星 Galaxy s3 上只有远程测试人员，所以我无法收到错误消息。这是我的代码：

```
 Location finalLocation = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    locationManager.removeUpdates(locationListenerGps);
    locationManager.removeUpdates(locationListenerNetwork);

    Location net_loc=null, gps_loc=null;
    if(locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER))
        gps_loc=locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    if(locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER))
        net_loc=locationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);

    //if there are both values use the latest one
    if(gps_loc!=null && net_loc!=null){
        if(gps_loc.getTime()>net_loc.getTime())
            finalLocation = gps_loc;
        else
            finalLocation = net_loc;
    }

    if(gps_loc!=null){
        finalLocation = gps_loc;

    }
    if(net_loc!=null){
        finalLocation = net_loc;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:46:30.477

我认为这是 4.0.4 版本的“功能”，检查[(getLastKnownLocation 在三星 Galaxy S3 4.0.4 上不起作用)](https://stackoverflow.com/questions/13017219/getlastknownlocation-does-not-work-on-samsung-galaxy-s3-4-0-4?rq=1)。

我有同样的问题，当我升级到 4.1 时它就消失了。

您可能必须抓住两者都为空的情况，我发现 PASSIVE_PROVIDER 有效。

```
 if ( gps_loc == null && net_loc == null ) { // only S3 gets this....
      finalLocation=  locationManager.getLastKnownLocation(LocationManager.PASSIVE_PROVIDER);
   }
   if ( finalLocation == null ) panic.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T08:02:52.687

如果没有 logcat，很难说出确切的问题，但 getLastKnownLocation 在某些情况下可能会返回 null（不太可能但可能）。如果是这种情况，很容易看出这会导致崩溃。也许尝试添加一些代码来检查 getLastKnownLocation 是否返回了一个值，如果没有，请使用虚拟值或“暂停”您的操作并自己获取位置。

[http://developer.android.com/reference/android/location/LocationManager.html#getLastKnownLocation(java.lang.String](http://developer.android.com/reference/android/location/LocationManager.html#getLastKnownLocation(java.lang.String) )

# saml-2.0 - 添加受信任的提供者 (SAML 2.0) 时遇到问题：无法解析我的服务提供者元数据

> ID：13407094
> 
> 赞同：2
> 
> 时间：2012-11-15T22:07:29.563
> 
> 标签：saml-2.0

我在 Novell iManager 中收到错误消息“ *XML 格式错误。cvc-complex-type.2.4.a: 发现以元素“md:EncryptionMethod”开头的无效内容。“{”之一 http://www.w3 .org/2000/09/xmldsig#":KeyInfo}' 是预期的。* " 添加此服务提供者元数据时：

```
<?xml version="1.0" encoding="UTF-8"?>
  <md:EntityDescriptor entityID="https://.../" xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata">
    <md:SPSSODescriptor protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol" WantAssertionsSigned="true" AuthnRequestsSigned="true"> 
      <md:KeyDescriptor use="encryption"> 
        <md:EncryptionMethod xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/> 
        <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#"> 
          <X509Data><X509Certificate>...</X509Certificate></X509Data>
       </KeyInfo> 
      </md:KeyDescriptor> 
      <md:AssertionConsumerService isDefault="true" index="0" Location="https://.." Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"/>
  </md:SPSSODescriptor> 
  <md:Organization>...</md:Organization> 
   ...
</md:EntityDescriptor> 
```

我在 Novell iManager 中所做的事情：IdentityServers -> AH DMZ Identity Server -> New Trusted Provider -> Service Provider -> Source: Metadata Text

奇怪的是，它抱怨缺少**KeyInfo**元素，而它在这里具有正确的命名空间。知道为什么会这样吗？

如果我从这里指定第三方元数据：[https](https://federation.njedge.net/metadata/njedge-fed-metadata.xml) ://federation.njedge.net/metadata/njedge-fed-metadata.xml它说

“ *XML 格式错误。cvc-complex-type.2.4.a：发现以元素“组织”开头的无效内容。“{”之一 http://www.w3.org/2000/09/xmldsig#”： Signature, "urn:oasis:names:tc:SAML:2.0:metadata":Extensions, "urn:oasis:names:tc:SAML:2.0:metadata":RoleDescriptor, "urn:oasis:names:tc:SAML:2.0 :metadata":IDPSSODescriptor, "urn:oasis:names:tc:SAML:2.0:metadata":SPSSODescriptor, "urn:oasis:names:tc:SAML:2.0:metadata":AuthnAuthorityDescriptor, "urn:oasis:names:tc :SAML:2.0:metadata":AttributeAuthorityDescriptor, "urn:oasis:names:tc:SAML:2.0:metadata":PDPDescriptor, "urn:oasis:names:tc:SAML:2.0:metadata":AffiliationDescriptor}' 是预期的。* "

看起来它需要一些服务提供商特定的元数据文件格式，不幸的是我无法找到有关不同格式的 SAML 2.0 元数据的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T19:58:05.883

好像有 2 个问题：1）Novell 需要严格的元素顺序 2）它不识别默认命名空间，例如`<KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">`使用`<somenamespace:KeyInfo xmlns:somenamespace="http://www.w3.org/2000/09/xmldsig#">`

诡异的 ：）

# c# - 使用 async await c# 轮询电子邮件

> ID：13407095
> 
> 赞同：4
> 
> 时间：2012-11-15T22:07:34.897
> 
> 标签：c#

我正在创建一个控制台应用程序，它将：

1.  调用一个方法来检查一个电子邮件帐户（我已经完成了这一步）
2.  将附件转换为pdf（我已完成此步骤）
3.  然后一旦转换完成等待30秒
4.  不断重复前面3个步骤

我已经完成了方法中的步骤 1) 和 2) `ProcessMailMessages()`。以下代码有效，但我想知道我是否走在正确的轨道上，还是有更好的方法来轮询电子邮件客户端？

```
 private static int secondsToWait = 30 * 1000;

    static void Main(string[] args)
    {
        bool run = true;
        do
        {
            try
            {
                Task theTask = ProcessEmailTaskAsync();
                theTask.Wait();
            }
            catch (Exception e)
            {
                Debug.WriteLine("<p>Error in Client</p> <p>Exception</p> <p>" + e.Message + "</p><p>" + e.StackTrace + "</p> ");
            }
            GC.Collect();

        } while (run);

    }

    static async Task ProcessEmailTaskAsync()
    {
        var result = await EmailTaskAsync();
    }

    static async Task<int> EmailTaskAsync()
    {
        await ProcessMailMessages();
        await Task.Delay(secondsToWait);
        return 1;
    }

    static async Task ProcessMailMessages()
    {
        ...............................................................................
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:51:17.827

您可以使用计时器，而不是在 main 中循环。主要是，您将设置计时器，然后您可以等待 Console.Readline() 以防止控制台关闭。

**编辑——这是一个例子**

```
 using System;

namespace ConsoleApplication1
{
    class Program
    {
        private const int MilliSecondsToWait = 30000;
        private static System.Timers.Timer EmailTimer;

        static void Main(string[] args)
        {
            EmailTimer = new System.Timers.Timer(MilliSecondsToWait);
            EmailTimer.Elapsed += EmailTimer_Elapsed;
            EmailTimer.Start();

            Console.WriteLine("Press Enter to quit.");
            Console.ReadLine();
            // if you hit enter, the app will exit.  It is possible for the user to exit the app while a mail download is occurring.  
            // I'll leave it to you to add some flags to control that situation (just trying to keep the example simple)
        }

        private static void EmailTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
        {
            // stop the timer to prevent overlapping email downloads if the current download takes longer than MilliSecondsToWait
            EmailTimer.Stop();
            try
            {
                Console.WriteLine("Email Download in progress.");
                // get your email.
            }
            catch (System.Exception ex)
            {
                // handle any errors -- if you let an exception rise beyond this point, the app will be terminated.
            }
            finally
            {
                // start the next poll
                EmailTimer.Start();
            }

        }

    }
} 

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T15:54:15.197

您的代码运行良好，它避免使用计时器！并且还使您的代码与 async/await (TPL) 异步。你在正确的轨道上！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T21:08:46.563

这是对 async/await 的无偿使用，因为它是一个控制台应用程序，而您只是阻塞，直到调用完成为止。不妨从你的 do/while 循环中调用 ProcessMailMessages() 并完成它。

# php - PHP imagick安装错误

> ID：13407096
> 
> 赞同：3
> 
> 时间：2012-11-15T22:07:37.417
> 
> 标签：php, macos, imagick

我已经安装了 imagick php 模块，还使用 ​​Brew 安装了 Image Magick。在 php.ini 中安装并添加到我的扩展后，当 Apache (XAMPP) 启动时，我会收到此错误。

```
dyld: lazy symbol binding failed: Symbol not found: _MagickWandGenesis
Referenced from: /usr/lib/php/extensions/no-debug-non-zts-20090626/imagick.so
Expected in: flat namespace 
```

谷歌一直没有帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-18T13:18:00.590

看起来你必须手动编译它，如下所示：

```
$ cd /usr/local/src/
$ wget http://pecl.php.net/get/imagick-3.0.1.tgz
$ tar -xzvf imagick-3.0.1.tgz 
$ cd imagick-3.0.1
$ phpize
$ MACOSX_DEPLOYMENT_TARGET=10.6
$ CFLAGS="-arch i386 -arch x86_64 -g -Os -pipe -no-cpp-precomp"
$ CCFLAGS="-arch i386 -arch x86_64 -g -Os -pipe"
$ CXXFLAGS="-arch i386 -arch x86_64 -g -Os -pipe"
$ LDFLAGS="-arch i386 -arch x86_64 -bind_at_load"
$ export CFLAGS CXXFLAGS LDFLAGS CCFLAGS MACOSX_DEPLOYMENT_TARGET
$ echo $CFLAGS
$ ./configure --with-imagick=/usr/local//Cellar/imagemagick/6.8.0-10
$ make
$ sudo make install
$ sudo vim /etc/php.ini
$ sudo apachectl restart 
```

这是这篇文章的摘录： http: [//charles.lescampeurs.org/2013/06/18/add-c-header-include-path-pecl](http://charles.lescampeurs.org/2013/06/18/add-c-header-include-path-pecl)

但也许更简单的解决方案是使用 josegonzalez 的 PHP 水龙头进行 brew 并删除 XAMMP，我使用它并且工作完美： [https ://github.com/josegonzalez/homebrew-php](https://github.com/josegonzalez/homebrew-php)

此选项卡包含最稳定的包和最新的 PHP 包

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-18T18:31:15.603

我对 AMPPS 也有同样的问题。我用自制软件安装了 ImageMagick 和 imagick，试图让它在 AMPPS 上运行。当我最终编译它时 - 我记得从涉及的 AMPPS 文件夹中指向正确二进制文件的符号链接 - 我收到了这个错误。

事实证明并非所有正确链接的库。我认为这是我用来检查另一台计算机上的工作 imagick.so 文件与无法加载的文件之间差异的“nm”命令。无论如何，我现在已经解决了编译问题和不兼容问题，并将自己从头开始重新安装所有内容以解决它。

# ruby - 匹配 在ruby中用正则表达式标记

> ID：13407097
> 
> 赞同：0
> 
> 时间：2012-11-15T22:07:40.013
> 
> 标签：ruby, regex, html

谁能告诉我如何使用 Ruby 中的正则表达式将标记的开头与`<div>`标记的结尾相匹配？`</div>`

例如，假设我有一个：

```
<div>
<p>test content</p>
</div> 
```

到目前为止，我有这个：

```
< div [^>]* > [^<]*<\/div> 
```

但它似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:55:04.947

Nokogiri 很棒，但是恕我直言，有些情况下它不能使用。

对于您的情况，您可以使用它：

```
puts str.scan(/<div>(.*)<\/div>/im).flatten.first

<p>test content</p> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:21:46.687

要匹配`<div>`全部在一行上的时间，请使用：

```
/<div[^>]*>/ 
```

但是，这将在标签内带有换行符的任何标记上中断。`<`如果and之间有空格，它也会中断`div`，这可能是。

最终，在对可能的标签编写方式添加了所有额外检查之后，您将需要考虑一种更好的方式，即使用解析器，例如 Nokogiri，它可以使 HTML 和 XML 的工作变得更加频繁更轻松。

例如，由于您试图拆分 HTML：

```
<div>
<p>test content</p>
</div> 
```

很容易猜到你真的想要“测试内容”。如果 HTML 更改为：

```
<div><p>test content</p></div> 
```

或更糟：

```
<div
><p>
test
content
</div> 
```

浏览器不会关心，一个好的解析器也不会关心，但是正则表达式会变得不安并需要返工。

```
require 'nokogiri'
require 'pp'

doc = Nokogiri.HTML(<<EOT)
    <div
    ><p>
    test
    content
    </div>
EOT
pp doc.at('p').text.strip.gsub(/\s+/, ' ')
# => "test content" 
```

这就是我们推荐解析器的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:21:35.790

正如 PinnyM 所指出的那样，像[Nokogiri](http://www.nokogiri.org)这样的 HTML 解析器可能比使用 a 更好。`Regex`

[这](http://nokogiri.org/tutorials/searching_a_xml_html_document.html)是 Nokogiri 页面上的教程，描述了如何搜索 HTML/XML 文档。

这个[stackoverflow 问题](https://stackoverflow.com/questions/4232345/get-div-nested-in-div-element-using-nokogiri)演示了类似于您想要使用 CSS 选择器完成的任务。也许这样的东西对你有用。

# c# - 排序后如何使 DataGrid 上的 RadioButtons 保持可用？

> ID：13407100
> 
> 赞同：0
> 
> 时间：2012-11-15T22:07:56.580
> 
> 标签：c#, wpf, sorting, datagrid, radio-button

我有一个从代码创建和填充的**DataGrid 。**当网格第一次显示**RadioButton**列时，“Include”似乎工作得很好。问题是在我更改排序后 RadioButton**不再**正常工作。你可以点击它，点击窗口外然后回来，或者事件只是等待，它最终会起作用，但显然它不是真的可用。这是一个简单的例子：

```
using System.Data;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;
using System.Windows.Data;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();
            InitializeDataGrid();
        }

        private void InitializeDataGrid()
        {
            var table = GetTestTable();

            var newGrid = new DataGrid
                              {
                                  CanUserAddRows = false,
                                  CanUserSortColumns = true,
                                  AutoGenerateColumns = true,
                                  ItemsSource = table.AsDataView(),
                                  DataContext = table
                              };
            newGrid.AutoGeneratingColumn += dataGrid_AutoGeneratingColumn;

            UxRootGrid.Children.Add(newGrid);
        }

        private static DataTable GetTestTable()
        {
            DataTable table = new DataTable("name");
            table.Columns.Add("Include", typeof (bool));
            table.Columns.Add("Number", typeof (int));

            for (int i = 0; i < 5; i++)
            {
                var row = table.NewRow();
                row[0] = false;
                row[1] = i;
                table.Rows.Add(row);
            }
            return table;
        }

        void dataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
        {
            if (e.PropertyName != "Include")
            {
                return;
            }

            DataTemplate template = GetDataTemplate();
            DataGridTemplateColumn templateColumn = new DataGridTemplateColumn
                                                        {
                                                            Header = "Include",
                                                            CellTemplate = template,
                                                            CellEditingTemplate = template,
                                                        };
            e.Column = templateColumn;
        }

        private static DataTemplate GetDataTemplate()
        {
            var elementFactory = new FrameworkElementFactory(typeof (RadioButton));

            var binding = new Binding("Include")
                              {
                                  Mode = BindingMode.TwoWay,
                                  UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged
                              };

            elementFactory.SetBinding(ToggleButton.IsCheckedProperty, binding);
            elementFactory.SetValue(RadioButton.GroupNameProperty, "BindingGroup");

            return new DataTemplate {VisualTree = elementFactory};
        }
    }
} 
```

这是 Xaml：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel Name="UxRootGrid">
    </StackPanel>
</Window> 
```

因此，要查看问题：
1\. 启动应用程序
2\. 单击数字 1 旁边的 RadioButton。
3\. 单击“数字”标题两次（按降序排序）。
4\. 现在单击 Number 4 旁边的
RadioButton。 5\. 注意 Number 1 旁边的 RadioButton 现在被取消选择，但 Number 4 旁边的 RadioButton 没有被选中。
6\. 单击数字 4 旁边的 RadioButton 几次。最终它会被选中。

更新：我让我的另一个同事在他的机器上尝试了这个，他花了一两个时间排序/选择单选按钮才能看到问题发生，但最终他和我的位置相同。

我对 WPF 很陌生，所以我希望这只是我的一个简单错误。在获得解决方法或其他设置方法方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T18:21:44.423

我能够通过使用 Peter Staev 的*RadioButtonExtended*类来解决问题，该类位于：http: [//pstaev.blogspot.com/2008/10/binding-ischecked-property-of.html](http://pstaev.blogspot.com/2008/10/binding-ischecked-property-of.html)

正如他在帖子中所建议的那样，我只是用 RadioButtonExtended 替换了 RadioButton 的用法，然后*绑定**到*IsCheckedReal*而*不是*IsChecked*。

# java - 独一无二的物品

> ID：13407110
> 
> 赞同：0
> 
> 时间：2012-11-15T22:08:23.147
> 
> 标签：java

我想为某些属性创建一个独一无二的对象：

```
import java.util.HashMap;

public class SourceLanguage {
    private  final String name;
    private static HashMap<String,SourceLanguage> existing;

    private SourceLanguage(String name){
        this.name = name;
    }

    public String getName(){
        return name;
    }

    public static SourceLanguage get(String name){
        if(existing==null){
            existing = new HashMap<>();
            SourceLanguage sl = new SourceLanguage(name);
            existing.put(name.toLowerCase(),sl);
            return sl;
        }
        SourceLanguage check = existing.get(name);
        if(check==null){
            SourceLanguage sl = new SourceLanguage(name);
            existing.put(name.toLowerCase(),sl);
            return sl;
        }else {
            return check;
        }
    }
} 
```

我想将此类的对象用作另一个地图中的键。

我觉得有点矫枉过正。有没有更简单的方法来实现目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:13:48.553

您可以考虑使用[注册表模式](http://martinfowler.com/eaaCatalog/registry.html)。这样，`SourceLanguage`对象的行为可以与强制其唯一性的行为分开。它们也可能变得更复杂，彼此独立；注册表可以处理注释中描述的内存泄漏，而不会使您的`SourceLanguage`课程混乱。

将`SourceLanguage`和 Registry 类放在同一个包中，但是使`SourceLanguage`类包可见（或给它一个`protected`构造函数），然后外部组件将无法`SourceLanguage`直接实例化，并且必须通过 Registry。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:27:58.703

我强烈建议您避免对缓存进行强引用。如果这将是线程安全的，您还需要一些同步。

```
public class SourceLanguage {
    private final String name;
    private final static Map<String, SoftReference<SourceLanguage>> cache
        = new HashMap<String, SoftReference<SourceLanguage>>();

    private SourceLanguage(String name){
        this.name = name;
    }

    public String getName(){
        return name;
    }

    public static SourceLanguage get(String name){
        final String key = name.toLowerCase();
        SourceLanguage lang = null;
        synchronized (cache) {
            SoftReference<SourceLanguage> ref = cache.get(key);
            if (ref != null) {
                lang = ref.get();
            }
            if (lang == null) {
                SourceLanguage sl = new SourceLanguage(name);
                cache.put(key, new SoftReference<SourceLanguage>(sl);
            }
        }
        return lang;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:15:48.500

除非我遗漏了什么，否则我认为你可以做到这一点。

```
public class SourceLanguage {
    private  final String name;
    private static HashMap<String,SourceLanguage> existing = new HashMap<String, SourceLanguage>();

    private SourceLanguage(String name){
        this.name = name;
    }

    public String getName(){
        return name;
    }

    public static SourceLanguage get(String name){
        SourceLanguage ret = existing.get(name.toLowerCase());
        if(ret == null) {
            ret = new SourceLanguage(name);
            existing.put(name.toLowerCase(),ret);
        }
        return ret;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T22:29:16.307

您正在尝试的内容属于*实习*的一般概念。一般来说，它很容易出现内存泄漏，但我怀疑这对你来说会是一个问题，因为不会有*那么*多语言。

使这个线程安全的建议是使用`ConcurrentHashMap`：

```
private static final ConcurrentMap<String, SourceLanguage> existing = 
  new ConcurrentHashMap<>();

public static SourceLanguage get(String name) {
  name = name.toLowerCase();
  final SourceLanguage old = existing.get(name);
  if (old != null) return old;
  final SourceLanguage 
    created = new SourceLanguage(name),
    justPut = existing.putIfAbsent(name, created);
  return justPut != null? justPut : created;
} 
```

# python - python - 使用命名列（和数据类型）初始化一个空数组

> ID：13407111
> 
> 赞同：2
> 
> 时间：2012-11-15T22:08:22.810
> 
> 标签：python, multidimensional-array, numpy, named-constructor

我有三个约束，而且，像往常一样，我只能弄清楚如何同时满足其中任何两个：

1.  多维数组
2.  命名列
3.  不同的列包含不同的数据类型（因此 col 1 中的所有内容都是字符串，但 col 2 都是 Decimal 等）

我目前正在使用 numpy ndarrays 在每列中存储不同类型的数据。我已经初始化了数组，以便它可以存储多种数据类型：

```
norm = numpy.empty((79, len(header)), dtype=numpy.object) 
```

我一直在使用标题（字符串名称列表）作为列名的代理（然后在标题中查找值的索引），但这看起来很笨拙。

我环顾四周，但据我所知，当您使用列名（和类型）初始化数组时，您必须在这样做时用值填充数组，如：[Store NumPy Row and Column Headers](https://stackoverflow.com/questions/5795748/store-numpy-row-and-column-headers)

因为当我尝试这样的事情时：

```
n=numpy.empty((5,2), dtype=[("sub", "str"), ("words", Decimal)])
n[0] = ['06', Decimal(10)] 
```

我收到此错误：

```
Traceback (most recent call last):
File "<string>", line 1, in <fragment>
ValueError: Setting void-array with object members using buffer. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:02:33.747

尝试这个：

```
>>> n = numpy.empty((5,2), dtype=[("sub", "S10"), ("words", Decimal)])
>>> n[0] = ('06', Decimal(10))
>>> print n
[[('06', Decimal('10')) ('06', Decimal('10'))]
 [('', None) ('', None)]
 [('', None) ('', None)]
 [('', None) ('', None)]
 [('', None) ('', None)]] 
```

正如@seberg 提到的，你想设置一个元组而不是一个列表。您还需要指定要存储在“sub”中的字符串的长度。Numpy 结构化数组不存储任意长度的字符串，您需要选择一个最大长度。如果您真的无法选择最大长度，请使用`object`而不是`str`.

# xml - 在 XML 方案中使用唯一元素

> ID：13407113
> 
> 赞同：1
> 
> 时间：2012-11-15T22:08:24.263
> 
> 标签：xml, xsd, unique-key

我正在尝试使用唯一元素来确保其中一个属性的唯一性。我想要唯一的元素*stav*的属性 *cisloStavu对于它的两个实例具有相同的值，但*[验证器](http://www.xmlvalidation.com/)说没关系。我已经阅读了很多关于这方面的指南，现在我很困惑，因为看起来我做对了。

 *这是我的 XML 文件（重要的行已注释）：

```
<?xml version="1.0" encoding="UTF-8"?>
<Automat nazevKrizovatky="" xmlns="urn:x-fido:schemata:automat-severka" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:x-fido:schemata:automat-severka automat.xsd ">
  <stav cisloStavu="0" interval="0">                    <-- first occurence of cisloStavu="0" -->
    <nasledujiciStav>0</nasledujiciStav>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
  </stav>
  <stav cisloStavu="0" interval="0">               <-- second occurence of cisloStavu="0" -->
    <nasledujiciStav>0</nasledujiciStav>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semafor cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
    <semaforProChodce cisloSemaforu="0" stavSemaforu="zelena"/>
  </stav>
</Automat> 
```

这是计划：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema  targetNamespace="urn:x-fido:schemata:automat-severka" 
            elementFormDefault="qualified" 
            xmlns:xs="http://www.w3.org/2001/XMLSchema" 
            xmlns="urn:x-fido:schemata:automat-severka">

    <xs:simpleType name="intervalType">
        <xs:restriction base="xs:nonNegativeInteger"></xs:restriction>
    </xs:simpleType>

    <xs:simpleType name="cisloStavuType">
        <xs:restriction base="xs:nonNegativeInteger"></xs:restriction></xs:simpleType>

    <xs:simpleType name="nasledujiciStavType">
        <xs:restriction base="xs:nonNegativeInteger"></xs:restriction>
    </xs:simpleType>

    <xs:complexType name="StavType">
        <xs:sequence>
            <xs:element name="nasledujiciStav" type="nasledujiciStavType" minOccurs="1" maxOccurs="unbounded">
            </xs:element>
            <xs:element name="semafor" type="semaforType" minOccurs="8" maxOccurs="8">
            </xs:element>
            <xs:element name="semaforProChodce" type="semaforProChodceType" minOccurs="8" maxOccurs="8"></xs:element>
        </xs:sequence>
        <xs:attribute name="cisloStavu" type="cisloStavuType" use="required"></xs:attribute>
        <xs:attribute name="interval" type="intervalType" use="required"></xs:attribute>
    </xs:complexType>

    <xs:complexType name="AutomatType">
        <xs:sequence>
            <xs:element name="stav" type="StavType" maxOccurs="unbounded"></xs:element>
        </xs:sequence>
        <xs:attribute name="nazevKrizovatky" type="nazevKrizovatkyType" use="required"></xs:attribute>
    </xs:complexType>

    <xs:element name="Automat" type="AutomatType">
        <xs:unique name="unikatni_stav">            <-- unique element -->
            <xs:selector xpath="stav" />
            <xs:field xpath="@cisloStavu" />
        </xs:unique>
    </xs:element>

    <xs:simpleType name="nazevKrizovatkyType">
        <xs:restriction base="xs:string"></xs:restriction>
    </xs:simpleType>

    <xs:simpleType name="cisloSemaforuType">
        <xs:restriction base="xs:nonNegativeInteger"></xs:restriction></xs:simpleType>

    <xs:simpleType name="stavSemaforuType">
        <xs:restriction base="xs:string">
            <xs:enumeration value="zelena"></xs:enumeration>
            <xs:enumeration value="červena"></xs:enumeration>
            <xs:enumeration value="pozorZelena"></xs:enumeration>
            <xs:enumeration value="pozorČervena"></xs:enumeration>
            <xs:enumeration value="zelenaVprvavo"></xs:enumeration>
        </xs:restriction>
    </xs:simpleType>

    <xs:complexType name="semaforType">
        <xs:attribute name="cisloSemaforu" type="cisloSemaforuType" use="required"></xs:attribute>
        <xs:attribute name="stavSemaforu" type="stavSemaforuType" use="required"></xs:attribute>
    </xs:complexType>

    <xs:complexType name="semaforProChodceType">
        <xs:attribute name="cisloSemaforu" type="cisloSemaforuType" use="required"></xs:attribute>
        <xs:attribute name="stavSemaforu" type="stavSemaforuProChodceType" use="required"></xs:attribute>
    </xs:complexType>

    <xs:simpleType name="stavSemaforuProChodceType">
        <xs:restriction base="xs:string">
            <xs:enumeration value="zelena"></xs:enumeration>
            <xs:enumeration value="červena"></xs:enumeration>
        </xs:restriction>
    </xs:simpleType>
</xs:schema> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:09:43.163

最后我发现了问题。我使用了默认命名空间（**不要与 no namespace 混淆**），我忘记了 xpath 表达式（在唯一元素中）忽略默认命名空间。换句话说，xpath 表达式无法访问默认命名空间元素。

我将前缀添加到 XML 中的命名空间以及唯一元素中的 xpath 表达式，现在它可以正常工作了！*

# c# - 在通过接口公开的方法上使用动态返回类型在架构上是否错误？

> ID：13407116
> 
> 赞同：2
> 
> 时间：2012-11-15T22:08:36.260
> 
> 标签：c#, dynamic, architecture

我有一个使用业务逻辑层中的接口公开的方法。如下：

```
 public interface IMyWorkingClass
  {
       IEnumerable<dynamic> GetSomeList(); 
  }

  public class MyWorkingClass : IMyWorkingClass
  {
      public IEnumerable<dynamic> GetSomeList()
      {  
           dynamic foos = new List<dynamic>();

           dynamic item = new ExpandoObject();

           item.PropOne = (new Foo()).FooPropertyOne;

           item.PropTwo = (new Bar()).BarPropertyOne;

           foos.Add(item);

           return foos;

      }
  }  

  public class Foo
  {
      public int FooId{get;set;}
      public string FooPropertyOne{get;set;}
      public string FooPropertyTwo{get;set;}

  }

  public class Bar 
  {
      public int BarId{get;set;}
      public string BarPropertyOne{get;set;}
      public string BarPropertyTwo{get;set;}

  } 
```

关于动态本身有很多不同的意见/偏好。我觉得它们很有用。我的一位朋友说动态很好，但上面的使用方式却不是。提出的论点是编译器不会捕获动态对象上更改的内容。我认为单元测试将能够捕捉到这些。所以我不同意。你的专家意见是什么？提前致谢 ：）

**更新**

这是更清晰（希望）的代码：

```
public interface IMyWorkingClass
{
    IEnumerable<dynamic> GetListOfClassesForStudentDynamicReturn();
    IEnumerable<StudentClassInfo> GetListOfClassesForStudentStaticReturn();

}

public class MyWorkingClass : IMyWorkingClass
{
    public IEnumerable<dynamic> GetListOfClassesForStudentDynamicReturn(Student student)
    {
        dynamic listOfClasses = new List<dynamic>();

         // repository pattern is used in DAL  
        var datafromDB = (StudentCollegeClassRepo.GetQueryable(x=>x.StudentId==student.StudentId)
                          .select(item => new {
                              item.CollegeClassId
                              ,item.CollegeClass.CollegeClassName
                              ,item.IsEnabledForStudent
                          }).ToList();

        foreach (var item in datafromDB)
        {
            dynamic classWithStudent = new ExpandoObject();
            classWithStudent.CollegeClassId = item.CollegeClassId;
            classWithStudent.CollegeClassName = item.CollegeClassName;
            classWithStudent.IsEnabledForStudent = item.IsEnabledForStudent;
            listOfClasses.Add(studentWithClass);
        }

        return listOfClasses;

    }

    public IEnumerable<StudentClassInfo> GetListOfClassesForStudentStaticReturn(Student student)
    {
         // repository pattern is used in DAL  
        var datafromDB = (StudentCollegeClassRepo.GetQueryable(x=>x.StudentId==student.StudentId)
                          .select(item => new StudentClassInfo {
                              CollegeClassId = item.CollegeClassId
                              ,CollegeClassName = item.CollegeClass.CollegeClassName
                              ,IsEnabledForStudent = item.IsEnabledForStudent
                          }).ToList();

        return datafromDB;

    }
}
// this class is like a viewmodel
public class StudentClassInfo
{
    public int CollegeClassId { get; set; }
    public string CollegeClassName { get; set; }
    public bool IsEnabledForStudent { get; set; }
}

public class Student
{
    public int StudentId { get; set; }
    public string StudentName { get; set; }
}

public class StudentCollegeClass
{
    public int StudentId { get; set; }
    public int CollegeClassId { get; set; }
    public bool IsEnabledForStudent { get; set; }
}

public class CollegeClass
{
    public int CollegeClassId { get; set; }
    public string CollegeClassName { get; set; }

} 
```

希望我现在让事情变得更清楚了。那么，动态返回的方法是可以的还是创建一个静态类型并返回它呢？我也在学习如何在这里正确提问。谢谢你的耐心和很棒的回复:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T22:28:17.510

那么，您想创建一个接口来公开一个返回未知的方法`IEnumerable`吗？在这种情况下，除了保存一些强制转换/测试/重载之外，如果您想在方法返回后使用这些对象，那么在这种情况下使用通用版本是否有直接的优势`IEnumerble`？

虽然我不会争辩这`dynamic`在某些情况下会很有用。在我看来，它经常显示出设计缺陷。每次来用的时候，其实我都坐下来想是不是真的需要它。大多数时候，我得出的结论是，通过一些简单的更改，我可以消除它并做出更简洁的设计。

在这种情况下，您真的需要具有动态的泛型类型吗？我的第一个快速猜测是，您可能可以使用非通用`IEnumerable`.

或者，如果你想节省一些演员表，并且你有不同的元素，你可以找到所有元素的共同点。我现在看到，你所有的财产都是字符串。或者如果你想返回元素的组合，你可以使用一些`Tuple<>`

如果您真的最终返回了许多不同对象的完全未知类型，您可以使用`IEnumerable<object>`，但我会质疑该接口实现存在的原因。我不记得曾经创建过一个接口，它会在不同实现之间，甚至在单个实现中返回具有绝对任何共同点的对象。它可以控制、数字、组件、实体……但它们倾向于共享一些东西。如果是属性，你甚至可以打包一些`PropertyInfo`！

TL：博士；除非您能提供一个非常明确的案例，说明此设计模式将服务于任何其他方式都无法避免的非常特定的目的，否则我建议您不要使用它。我`IEnumerable`的 2 美分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T22:45:57.653

尽管 Skeet 说了什么 :) 我会在这里添加一些想法。

如果你开始使用 Dynamics，你**必须**转变你的想法。你不知道你的对象**是**什么，你只关心**它能做什么**。

你发现自己很快就不需要接口了——然后你问自己“我到底在做什么？”。这总是一个很好的问题。

然后，当您开始编写更多测试以掩盖编译器检查的损失时，发生了转变——您开始更清楚地编写方法。您开始依赖工厂和其他类在这些无定形的动态粘液上施加逻辑。

如果你考虑到精神上的转变，那真是令人难以置信的自由。例如，您有一个在 Foo/Bar 之上执行某些操作的“MyWorkingClass”。如果那是一个名为“Warehouse”的实现类，它有一些名为“CheckInvetoryOf(dynamic item)”的方法——事情就开始变得更有意义了。

**在现实世界中，您将在此处发送一个接口（可能是 ITrackable 或其他东西），它公开了可以使用**的非常小的子集。它会起作用，但如果您稍后改变方法并希望 Warehouse 运送数字商品——比如下载，该怎么办？

您的 Warehouse 课程可能是仿照实体店设计的 - 并且正在转向发送数字下载……哦，不！

但是，如果您使用动态 - 这很容易。您可以简单地询问该项目是否是 IDigitalGood（例如）并很好地处理它。

所以 - 你写的代码是，是的，令人困惑。如果你花一些时间在动态语言上，它会给你精神上的转变，让它不那么混乱。

哦 - 就“架构上的错误”而言，做你所做的......谁知道呢。如果它令人困惑，那就不好了。如果它使测试变得困难 - 那是三倍不好。如果你被嘲笑，你可能是在正确的轨道上:)

# php - 如何使用 IIS 上自然运行的 asp 或其他脚本将文件保存到本地硬盘

> ID：13407120
> 
> 赞同：0
> 
> 时间：2012-11-15T22:08:57.733
> 
> 标签：php, javascript, asp.net, dojo

我正在编写具有 dojo 增强型数据网格的 Dojo Web 应用程序。在 datagid 填充数据后，我可以选择将文件保存到用户的机器上。为此，我使用 Dojo csv[导出](https://dojotoolkit.org/reference-guide/1.8/dojox/grid/EnhancedGrid/plugins/Exporter.html)器从数据网格中以 CSV 格式创建字符串。在下面的代码中，我将该字符串传递给 csv.php 脚本，该脚本允许我将字符串保存为 csv 文件。

使用 dojo 导出器的代码：

```
var g = dijit.byId("grid");
g.exportGrid("csv", {
    writerArgs: {
        separator: ","
    }
}, function(str){
       debugger;
     //the code below is used if the user prefers to have call to the php script on a php enabled server
     var form = document.createElement('form');
     dojo.attr(form, 'method', 'POST');
     document.body.appendChild(form);
     dojo.io.iframe.send({
     url: "csv.php",
     form: form,
     method: "POST",
     content: {exp: str},
     timeout: 15000
     });

     document.body.removeChild(form);
}); 
```

csv.php 的 php 代码：

```
<?
$time = time();
header("Pragma: public");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=\"grid_$time.csv\"");
$exportedData = $_POST['exp'];
echo stripslashes($exportedData);
exit;
?> 
```

所以我遇到的问题是我正在使用 php 并且需要使用启用 php 的服务器。如果部署应用程序的人有这样的服务器，那么代码可以正常工作。但是，如果他使用 IIS 安装 php 并且需要在 IIS 中进行特定设置。我想编写无需额外设置即可在 II 上运行的代码。我在想 ASP 是要走的路，但我愿意接受任何建议和帮助。我如何在 asp 中重写 csv.php 代码。

谢谢

如果我的问题有问题，请不要删除它，但请告诉我要更改的内容。

更新：

这是我在 ashx 页面中的代码，但现在我得到“500 内部服务器错误”。我在 IIS 上安装了 asp.net，所以这不是问题。在 js 文件中，我只将 scv.php 更改为 csv.ashx。我必须使用不同的代码来调用 ashx 吗？

```
 <%

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.IO;

namespace WebApplication2
{

    public class Handler1 : IHttpHandler
    {

        public void ProcessRequest(HttpContext context)
        {
         context.Request.Files(0);
            Dim reader = new IO.StreamReader(context.Request.InputStream);
            Dim string = reader.ReadToEnd();
            context.Response.ContentType = "application/csv";
            context.Response.AddHeader("Content-Disposition", "attachment; filename=Whatever.csv");
            context.Response.AddHeader("content-length", context.Request.ContentLength.ToString());

            Response.Write("something");
            if( context.Response.IsClientConnected )
                context.Response.Flush();
        }

        public bool IsReusable
        {
            get
            {
                return false;
            }
        }
    }
}
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:31:39.983

我无法在 php 方面提供帮助，但对于 asp.net，您可以编写一个通用处理程序 .ashx 页面。将您现有的页面发布到该页面，然后从那里您可以像您的 php 示例一样操纵响应。

```
context.Response.ContentType = "application/csv"
context.Response.AddHeader("Content-Disposition", "attachment; filename=Whatever.csv")
context.Response.AddHeader ("content-length", YourPostedData.Length)
context.Response.Write(YourPostedData)
If context.Response.IsClientConnected Then
    context.Response.Flush()
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:22:48.887

我个人会使用 .Net 4.5 并创建一个简单的网络应用程序。我不喜欢php。

[C# .Net 4.5 版本](http://msdn.microsoft.com/en-us/library/sfezx97z.aspx)

[经典 ASP 版本](http://www.4guysfromrolla.com/webtech/faq/FileSystemObject/faq3.shtml)

这应该让你很好地了解如何做同样的事情。出于开发速度的原因，用经典的 ASP 编写它可能对您来说更值得......虽然，这已经过时了。

# ruby-on-rails-3 - Rails 实例变量在本地工作但不在 Heroku 上

> ID：13407123
> 
> 赞同：0
> 
> 时间：2012-11-15T22:09:05.470
> 
> 标签：ruby-on-rails-3, heroku

所以我在我的rails 3.1控制器中设置了一些实例变量，当我尝试在heroku的视图中调用它们时它们根本不存在（它们在本地工作正常）。

使用具有类似数据结构和相同实例变量的类似其他模型，它可以正常工作 - 这使得它变得更加奇怪。还有一些实例变量可以通过 - 所以我正在努力找出导致这个问题的原因。

这是一个简单的例子

```
class PointsController < ApplicationController
  def show
    @point = Point.find(params[:id]) 
    @area = @point.area  
    @zoom = 15
    @ff = 0
    @ff = params[:ff].to_i if params[:ff] and params[:ff].to_i
  end
end 
```

在我看来，如果我输入： <%= @point.name %> 或 <%= @ff %> - 它们在本地和 heroku 环境中都可以工作，并且如果我输入，则返回值：

<%= @zoom %> 和 <%= @area %> 这些在本地工作，但在 heroku 环境中不返回任何内容。这完全是随机的。

有任何想法吗？

谢谢！

# javascript - 使用 createDocumentFragment() 将 Ajax 附加到元素；而不是创建元素

> ID：13407133
> 
> 赞同：0
> 
> 时间：2012-11-15T22:10:00.820
> 
> 标签：javascript, ajax, dom, createelement

这篇文章最有助于理解 createDocumentFragment() 而不是 createElement() [我应该使用 document.createDocumentFragment 还是 document.createElement](https://stackoverflow.com/questions/3397161/should-i-use-document-createdocumentfragment-or-document-createelement)

我已经明白，出于性能原因，使用片段将有助于大数据集，所以我想转换我的函数。

这就是我现在使用的，它可以按需要工作=>使用 ajax 从 php 文件中获取内容，然后将此内容附加到新的现有**内容的****顶部**（即 XMLHTTP /ACTIVE OBJECT）`div#wrapper`**`div.feedBox``r`**

 **```
r.onreadystatechange=function(){
    if(r.readyState==4 && r.status==200){

        //Want to convert this to createDocumentFrangment --START
        var n = document.createElement("div");
        n.className = "feedBox";
        n.innerHTML = r.responseText;
        document.getElementById("wrapper").insertBefore(n, document.getElementById("wrapper").firstChild);
        //Want to convert this to createDocumentFrangment --END
    }
} 
```

这是我尝试过的，但发生的情况是添加了内容但没有 div.feedBox

```
var n = document.createElement("div");
n.className = "feedBox";
n.innerHTML = r.responseText;
var f = document.createDocumentFragment();
while (n.firstChild) { f.appendChild(n.firstChild); }
document.getElementById("wrapper").insertBefore(f, document.getElementById("wrapper").firstChild); 
```

我错过了什么？你能解释一下为什么以及如何让它发挥作用吗？这真的是一种更有效的方法吗？

PS：请不要使用jquery。我很了解它，我在其他项目中广泛使用它，但我希望它尽可能小/精简/高效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:15:55.423

这条线不应该

```
while (n.firstChild) { f.appendChild(n.firstChild); 
```

是

```
f.appendChild(n); 
```

我还看到您没有将`div.feedBox`DOM 附加到任何地方..

如果`while condition fails`.. 您没有将任何内容附加到您的`DOM`..会发生什么

我假设这会起作用..虽然没有测试

```
f.appendChild(n)
document.getElementById("wrapper").appendChild(f,        
                                 document.getElementById("wrapper").firstChild); 
```

也更好用

`.appendChild(f,` **代替** `.insertBefore(f,`

**[检查小提琴](http://jsfiddle.net/sushanth009/9vxG8/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:56:00.037

这是完整的工作功能，任何人都可以随意使用它：

```
function ajax_fragment(php_file){
    if (window.XMLHttpRequest){
        r=new XMLHttpRequest(); 
    } else{ 
        r=new ActiveXObject("Microsoft.XMLHTTP"); 
    }

    r.onreadystatechange=function(){
        if(r.readyState==4 && r.status==200){
            var n = document.createElement("div");       //Create a div to hold the content
            n.className = "feedBox";                     //Give a class 'feddBox' to the div
            n.innerHTML = r.responseText;                //Put the response in the div
            var f = document.createDocumentFragment();   //Create the fragment
            f.appendChild(n);                            //Add the div to the fragment

            //Append the fragment's content to the TOP of wrapper div.
            document.getElementById("wrapper").insertBefore(f, document.getElementById("wrapper").firstChild);
        }
    }
    r.open("GET",php_file,true); 
    r.send();
} 
```**

# c++ - 如何将 QString 转换为 char*

> ID：13407135
> 
> 赞同：1
> 
> 时间：2012-11-15T22:10:16.903
> 
> 标签：c++, qt, char, qstring

我有一个 QString，我想将其转换为 char* 而不是 QChar*，因为我会将它传递给一个采用 char* 的方法，但是如果没有 const char*，我将无法转换它。例如我试过：

```
QString name = "name";
QByteArray byteArray = name.toUtf8();
myMailboxName = byteArray.constData(); 
```

和

```
QString name = "name";
QByteArray byteArray = name.toUtf8();
myMailboxName = byteArray.data(); 
```

其中 myMailboxName 是我班级中的私人 char* 。但是我收到一个错误，因为它返回一个 const char* 并且无法将其分配给 char*。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:13:52.897

这是因为data()返回的是字节数组中缓冲区的地址，可以读，但显然不应该写。您在字节数组之外有自己的缓冲区。如果你想要数据，你应该将 bytearray 的缓冲区复制到 myMailBoName 中。

使用 memcpy 函数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T13:12:52.350

试试这个代码片段

```
const char *myMailboxName = name.toLatin1().data(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T04:16:56.313

使用 strdup。它同时进行分配和复制。完成后请记住释放它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T14:31:45.053

正如 Mike 建议的那样，你真的可以使用`strdup`（[关于它的 stackoverflow 问题](https://stackoverflow.com/questions/252782/strdup-what-does-it-do-in-c)），但你也可以这样做：

```
// copy QString to char*
QString filename = "C:\dev\file.xml";
char* cstr;
string fname = filename.toStdString();
cstr = new char [fname.size()+1];
strcpy( cstr, fname.c_str() ); 
```

到了那里：[stackoverflow 类似的问题](https://stackoverflow.com/a/3408319/867349)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T12:23:29.153

我使用类似这样的包装器：

```
template<typename T, typename Y>
void CharPasser(std::function<T(char *)> funcToExecute,  const Y& str)
{
    char* c = 0;
    c = qstrdup(c, str.c_str());
    funcToExecute(c);
    delete[] c;
}

int SomeFunc(char* ){} 
```

然后像这样使用它：

```
CharPasser<int, std::string>(SomeFunc, QString("test").tostdString()) 
```

至少这可以节省一些打字... :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-18T19:15:14.603

考虑下面的例子
`QString str = "BlahBlah;"`

试试这个
`char* mychar = strdup(qPrintable(str));`

或这个
`char* mychr = str.toStdString().c_str();`

或这个
`char* mychar = strdup(str.ascii());`

每个语法都对我有用；）

# javascript - Google API 地图 - 添加样式地图时内容消失

> ID：13407141
> 
> 赞同：0
> 
> 时间：2012-11-15T22:11:24.987
> 
> 标签：javascript, google-maps-api-3

我一直在运行 Google Maps javascript 示例 (v3)，并且实际上已经能够使用多个标记（带有 infoWindow 链接和信息）和一些链接出来的多个但简单的多边形形状和自定义标记来创建地图。

然而，当我开始添加样式化地图设置时，我开始只获得部分地图信息。就javascript而言，我是一个菜鸟，但到目前为止，我已经能够通过做一些研究来弄清楚我遇到的所有其他事情——但我似乎无法弄清楚这一点。

工作版本如下所示： http: [//www.conleym.com/map/example.html](http://www.conleym.com/map/example.html) 它很粗糙，但可以工作。

当我添加样式地图信息时，我得到了这个： http: [//www.conleym.com/map/styled.html](http://www.conleym.com/map/styled.html)

出于空间的考虑，我不会发布代码，但如有必要会发布。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:41:35.747

查看您的 javascript 错误（在大多数浏览器的 Javascript 控制台中，单击 IE 中的小黄色三角形）：

```
Error: styledMap is not defined
Source File: http://www.conleym.com/map/styled.html
Line: 167 
```

然后你的“mc”变量和你的风格地图有额外的错误。

[工作示例](http://www.geocodezip.com/v3_conleym_com_map_styled.html)

# python - Matplotlib：当同一类中的不同函数调用绘图例程时，在同一个绘图上绘制多个图？

> ID：13407144
> 
> 赞同：1
> 
> 时间：2012-11-15T22:11:36.193
> 
> 标签：python

所以，假设我在 Pendulum 类中有一个函数 plot(self) 调用 plot. 然后我在同一个类 Pendulum 中有另一个函数 plot2(self)，它也调用 plot。我将如何设置 pyplot 以便两个函数在同一个图形上调用 plot ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:36:14.467

在每个绘图函数中：图（x）

在调用地块之前，这会使地块落在同一个图形句柄上。

```
figure(1)
plot1(self)

figure(1)
plot2(self) 
```

编辑：这在我们的外部函数内部起作用。

# wordpress - 创建独特且可编辑的配置文件

> ID：13407148
> 
> 赞同：2
> 
> 时间：2012-11-15T22:11:53.170
> 
> 标签：wordpress, user-accounts

我正在从事一个需要为大约 3-4,000 家公司保存记录的 Web 开发项目。如果可能的话，我想使用一个 wordpress 插件，使用户能够创建一个唯一的用户帐户/个人资料，并在以后用他们的最新信息更新他们的个人资料。我测试了配置文件生成器，但它不会让非管理员启动一个新帐户（我不想做 4,000 次）。

信息还需要可搜索（收入范围、位置等）。这不一定会破坏交易，因为我可以开发第二个应用程序来搜索数据库。

现在我正在尝试在构建一个用户可以创建帐户并与 UI 交互的应用程序之间进行选择（耗时）。我讨厌问这样愚蠢的问题，但我运气不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T23:40:43.773

近似线框：

*   启用用户注册并发送 4000 封邀请开户的电子邮件。
*   默认的用户配置文件系统保持原样，只是基本的用户信息（很容易从该页面中删除内容并赋予其漂亮的样式）。
*   为具有此提供的所有可搜索功能的*大型配置文件*创建自定义帖子类型。
*   [将用户可以管理的帖子数量限制为 One](https://wordpress.stackexchange.com/q/36416/12615)。
*   在出现具体情况时[提出新问题。](https://wordpress.stackexchange.com/questions/ask)

# sorting - 汇编中的选择排序过程

> ID：13407151
> 
> 赞同：2
> 
> 时间：2012-11-15T22:12:11.687
> 
> 标签：sorting, assembly, x86, masm, irvine32

我认为我的交换有问题，以及我如何访问数组中的元素。现在，所有代码都运行了，但排序后列表没有改变。他是我正在尝试实现的高级排序

```
for(k=0; k<request-1; k++) {
    i = k;
    for(j=k+1; j<request; j++) {
        if(array[j] > array[i])
        i = j;
    }
    exchange(array[k], array[i]);
} 
```

这是汇编代码。注意：分配是关于在堆栈上/从堆栈上推入和弹出元素，所以我不能更改参数。

```
;this is a library with macros for things like printing numbers and strings    
INCLUDE Irvine32.inc

    MIN = 10            ;lower range limit
    MAX = 200           ;upper range limit
    LRANGE = 100        
    HRANGE = 999        

.data

;title, intro, and prompts
    title_1     BYTE    "PROGRAMMING ASSIGNMENT 5: RANDOM GEN/SORT", 0dh, 0ah, 0

    intro_1     BYTE    "This program generates random numbers in the range (100 - 999),", 0dh, 0ah
        BYTE    "displays the original list, sorts the list, and calculates the median value.", 0dh, 0ah
        BYTE    "Finally, it displays the sorted list in descending order.", 0dh, 0ah, 0

    prompt_1    BYTE    "How many numbers should be generated? (10 - 200): ", 0 

    error_1     BYTE    "Out of range.", 0dh, 0ah, 0

    display_1   BYTE    "List of random numbers: ", 0dh, 0ah, 0
    display_2   BYTE    "The median is: ", 0
    display_3   BYTE    "The sorted list: ", 0dh, 0ah, 0

;placeholders for user entries and calculated data
    randArray   DWORD   MAX DUP(?)
    userNum     DWORD   ?           ;integer to be entered by user

;strings for posting results
    goodBye_1   BYTE    "Thank you for using the Gen/sort-ulator! Good-bye!", 0

.code
main PROC
    call    Randomize

;Title Screen
    push    OFFSET  title_1
    push    OFFSET  intro_1
    call    Intro

;Get and validate user numbers
    push    OFFSET  error_1
    push    OFFSET  prompt_1
    push    OFFSET  userNum
    call    GetData

;Fill Array with random numbers
    push    OFFSET  randArray
    push    userNum
    call    FillArray

;display unsorted results
    push    OFFSET  randArray
    push    userNum
    push    OFFSET  display_1
    call    DisplayList

;sort the results
    push    OFFSET  randArray
    push    userNum
    call    SortList

;display the median
    push    OFFSET  randArray
    push    userNum
    push    OFFSET  display_2
    call    median

;display sorted results
    push    OFFSET  randArray
    push    userNum
    push    OFFSET  display_3
    call    DisplayList

;Say "goodbye"
    push    OFFSET  goodBye_1
    call    Goodbye

    exit        ; exit to operating system
main ENDP

;-------------------------------------------------------
;Gives an Intro to the program
; Receives parameters on the system stack (in the order pushed):
;       Address of the title
;       Address of the intro
;post: intro displayed
;registers: none
;-------------------------------------------------------
Intro PROC
    pushad
    mov     ebp, esp
    mov     edx, [ebp+40]
    call    writeString
    call    CrLf
    mov     edx, [ebp+36]
    call    writeString
    call    CrLf
    popad
    ret     8
Intro   ENDP

;-------------------------------------------------------
;Prompts user for an integer, int stores in userNum
; Receives parameters on the system stack (in the order pushed):
;       Address of the error message
;       Address of the prompt
;       Address of return value
;Post: userNum
;registers: none
;-------------------------------------------------------
GetData PROC
    pushad

;setup stack and prompt for entry   
    mov     ebp, esp
reenter:
    mov     edx, [ebp+40]
    mov     ebx, [ebp+36]
    call    WriteString
    call    ReadInt

;validate entry
    cmp     eax, MIN            ;if eax < LOWER
    jl      badEntry            ;jump to summary 
    cmp     eax, MAX            ;if eax > UPPER
    jg      badEntry            ;reprompt 
    jmp     goodEntry           ;else jump to end, we have a good value

;bad entry reprompt
badEntry:
    mov     edx, [ebp+44]
    call    WriteString
    jmp     reenter

goodEntry:
    call    CrLf
    mov     [ebx], eax
    popad
    ret     12
GetData ENDP

;-------------------------------------------------------
;Fills array with a number of random integers within RANGE
;Recieves parameters on the system stack (in order pushed)
;       array
;       userNum
;Post: array is filled with userNum number of randoms
;Registers used: none
;-------------------------------------------------------
FillArray   PROC
    pushad
    mov     ebp, esp    
    mov     ecx, [ebp+36]           ;initialize loop counter with user entry
    mov     edi, [ebp+40]           ;setup array offset
    fillLoop:
    call    nextRand
    add     edi, 4  
    loop    fillLoop
    popad
    ret     8
FillArray   ENDP

;-------------------------------------------------------
; Procedure nextRand
; adapted from check lecture 20 solutions
; Procedure to get the next random number in the range specified by the user.
; Preconditions:  LRANGE < HRANGE
; Registers used:  eax, edi
;-------------------------------------------------------
nextRand    PROC            
    mov     eax, HRANGE
    sub     eax, LRANGE
    inc     eax                 ;add 1 to get the number of integers in range
    call    RandomRange 
    add     eax, LRANGE         ;eax has value in [LOW - HIGH]
    mov     [edi],eax       
    ret                     
nextRand    ENDP

;-------------------------------------------------------
;Sorts the contents of an integer array
; Receives parameters on the system stack (in order pushed)
;           Array
;           Array Size
;registers: none
;-------------------------------------------------------
sortList    PROC
    pushad
    mov     ebp, esp
    mov     ecx, [ebp+36]
    mov     edi, [ebp+40]
    dec     ecx                 ;ecx < request-1
    mov     ebx, 0              ;ebx=k

;for(k=0; k<request-1; k++)
outerLoop:
    mov     eax, ebx            ;eax=i=k
    mov     edx, eax
    inc     edx                 ;edx=j=k+1
    push    ecx
    mov     ecx, [ebp+36]       ;ecx < request

;for(j=k+1; j<request; j++)
innerLoop:
    mov     esi, [edi+edx*4]
    cmp     esi, [edi+eax*4]
    jle     skip
    mov     eax, edx
skip:
    inc     edx
    loop    innerLoop

;swap elements
    lea     esi, [edi+ebx*4]
    push    esi
    lea     esi, [edi+eax*4]
    push    esi
    call    exchange
    pop     ecx
    inc     ebx
    loop    outerLoop

    popad
    ret     8
sortList    ENDP

;-------------------------------------------------------
; Exchange k and i
; Receives parameters on the system stack (in order pushed)
;           array[k]
;           array[i]
;registers: none
;-------------------------------------------------------
Exchange    PROC
    pushad
    mov     ebp,esp
    mov     eax, [ebp+40]       ;array[k] low number
    mov     ecx, [eax]
    mov     ebx, [ebp+36]       ;array[i] high number
    mov     edx, [ebx]
    mov     [eax], edx
    mov     [ebx], ecx
    popad       
    ret 8
Exchange    ENDP

;-------------------------------------------------------
;Displays the median of an integer array
; Receives parameters on the system stack (in order pushed)
;           Array
;           Array Size
;           display string
;registers: none
;-------------------------------------------------------
Median PROC
    pushad
    mov     ebp, esp
    mov     edi, [ebp+44]
;display string
    mov     edx, [ebp+36]
    call    writeString

;calculate median element
    mov     eax, [ebp+40]
    cdq
    mov     ebx, 2
    div     ebx
    shl     eax, 2
    add     edi, eax
    cmp     edx, 0
    je      isEven
;Array size is odd, so display the middle value         
    mov     eax, [edi]
    call    writeDec
    call    CrLf
    call    CrLf
    jmp     endMedian
isEven:
;Array size is even so average the two middle values
    mov     eax, [edi]
    add     eax, [edi-4]
    cdq     
    mov     ebx, 2
    div     ebx
    call    WriteDec
    call    CrLf
    call    CrLf
endMedian:
    popad
    ret 12
Median ENDP

;-------------------------------------------------------
;Displays the contents of an integer array, 10 per row
; Receives parameters on the system stack (in order pushed)
;           Array
;           Array Size
;           display string
;registers: none
;-------------------------------------------------------
DisplayList PROC
    pushad
    mov     ebp, esp

;display string
    mov     edx, [ebp+36]
    call    writeString
    call    CrLf
    mov     ecx, [ebp+40]
    mov     edi, [ebp+44]
    mov     ebx, 0

;display array contents
listloop:
    inc     ebx             ;counter for 10 items per row
    mov     eax, [edi]      
    call    writeDec
    add     edi, 4
    cmp     ebx, 10
    jne     noReturn        ;jump if 10 items are not yet printed
    call    CrLf
    mov     ebx, 0
    jmp     noTab           ;this skips adding a tab on a new row
noReturn:
    mov     al, TAB
    call    writeChar
noTab:
    loop listloop
    call    CrLf
    popad
    ret 12
DisplayList ENDP

;-------------------------------------------------------
;Says good-bye to the user
; Receives parameters on the system stack:
;       Address of string
;registers: none
;-------------------------------------------------------
Goodbye PROC
    pushad
    mov     ebp, esp
    mov     edx, [ebp+36]
    call    writeString
    call    CrLf
    popad
    ret     4
Goodbye ENDP

END main 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:41:10.723

为了交换元素，您应该传递它们的地址（换句话说，指向每个元素的指针）。您所做的只是交换作为参数传递的值，这些值也立即被释放。您的代码相当于这个 C 函数：

```
void Exchange(int x, int y)
{
    int eax = x;
    int ebx = y;
    x = ebx;
    y = eax;
} 
```

你需要类似的东西：

```
void Exchange(int* x, int* y)
{
    int eax = *x;
    int ebx = *y;
    *x = ebx;
    *y = eax;
} 
```

在 asm 中，这可能看起来像：

```
Exchange    PROC
    pushad
    mov     eax, [esp+40]
    mov     ecx, [eax]
    mov     ebx, [esp+36]       
    mov     edx, [ebx]
    mov     [eax], edx
    mov     [ebx], ecx
    popad       
    ret 8
Exchange    ENDP 
```

要调用此函数，您将使用以下命令：

```
 lea     esi, [edi+ebx*4]
    push    esi
    lea     esi, [edi+eax*4]
    push    esi
    call    Exchange 
```

请注意，您的函数有一条我无法理解`Exchange`的指令。`mov eax, [edi]`

**更新：**是的，您可以`LEA`通过手动计算来模拟 的功能。例如，`lea esi, [edi+ebx*4]`变为：

```
 mov esi, ebx
    shl esi, 2    ; esi=ebx*4
    add esi, edi  ; esi=edi+ebx*4 
```

# c++ - OpenGL程序给出一个段错误

> ID：13407154
> 
> 赞同：0
> 
> 时间：2012-11-15T22:12:18.350
> 
> 标签：c++, opengl, glew, glfw

我正在学习 OpenGL，由于某种原因，我绘制三角形的程序无法正常工作。这是代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <GL/glew.h>
#include <GL/glfw.h>
#include <glm/glm.hpp>

using namespace glm;

int main()
{
    if(!glfwInit())
    {
        fprintf(stderr, "Failed to initialize GLFW\n");
        return -1;
    }

    glfwOpenWindowHint(GLFW_FSAA_SAMPLES, 4);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);

    if(!glfwOpenWindow(1080, 720, 0, 0, 0, 0, 32, 0, GLFW_WINDOW))
    {
        fprintf(stderr, "Failed to open GLFW window\n");
        glfwTerminate();
        return -1;
    }

    if(glewInit() != GLEW_OK)
    {
        fprintf(stderr, "Failed to initialize GLEW\n");
        return -1;
    }

    GLuint VertexArrayID;
    glGenVertexArrays(1, &VertexArrayID);
    glBindVertexArray(VertexArrayID);

    static const GLfloat g_vertex_buffer_data[] = {
        -1.0f, -1.0f, 0.0f,
        1.0f, -1.0f, 0.0f,
        0.0f, 1.0f, 0.0f,
    };

    GLuint vertexBuffer;
    glGenBuffers(1, &vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);

    glfwSetWindowTitle("Tutorial 01");

    glfwEnable(GLFW_STICKY_KEYS);

    do
    {
        glEnableVertexAttribArray(0);
        glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer);
        glVertexAttribPointer(
            0,
            3,
            GL_FLOAT,
            GL_FALSE,
            0,
            (void*)0
        );

        glDrawArrays(GL_TRIANGLES, 0, 3);

        glDisableVertexAttribArray(0);

        glfwSwapBuffers();
    }

    while(glfwGetKey(GLFW_KEY_ESC) != GLFW_PRESS &&
          glfwGetWindowParam(GLFW_OPENED));
} 
```

调试日志：

```
Debugger name and version: GNU gdb (GDB) 7.5
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:11
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:17
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:18
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:19
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:20
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:22
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:29
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:36
Program received signal SIGSEGV, Segmentation fault.
In ?? () ()
At /home/mike/Programming/OpenGL Tutorials/Opening a window/main.cpp:36
Debugger finished with status 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:28:30.517

之后进行明确的版本检查`glewInit()`：

```
if( !GLEW_VERSION_3_3 )
{
    fprintf(stderr, "Insuffcient GL version!\n");
    return -1;
} 
```

# c# - How to Consume a WebService using WSDL files in C#

> ID：13407156
> 
> 赞同：2
> 
> 时间：2012-11-15T22:12:31.997
> 
> 标签：c#, xml, visual-studio-2010, web-services, wsdl

So I have two [wsdl files](http://www.w3schools.com/wsdl/wsdl_intro.asp) (xml based) and I need to use them to consume a web service. Not sure where to start? I'm trying to add them in my Visual Studio Project Solution by clicking on "Add Service Reference" but I need an URL.

Should I add them to a Virtual Directory? If so, how?

Thanks in advance

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:19:12.657

You already found the solution. Use the "Add Service Reference" dialog and make sure your service is accessible by a URL. To do this either request the URL by the people offering the service or deploy the service in IIS.

Personally I would forget about svcutil.exe. If you have Visual Studio, it is much easier to add and update the service reference using the excellent integration of web services in Visual Studio.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:15:47.583

You can use the wsdl.exe tool which comes with Visual Studio (in there you can specify a local file path to your wsdl file) -

[http://msdn.microsoft.com/en-us/library/d2s8y7bs(VS.100).aspx](http://msdn.microsoft.com/en-us/library/d2s8y7bs(VS.100).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-06T08:19:51.860

Add your .wsdl address in address and click Go button.your service is add in your project.

[![enter image description here](../Images/0066057ac44ad4c2856b0bea9d8d1f3a.png)](https://i.stack.imgur.com/utUIS.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T22:16:09.697

You can add a service reference by using the path to the wsdl files.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-15T22:17:36.597

You can use [svcutil.exe](http://msdn.microsoft.com/en-us/library/aa347733.aspx) as such:

svcutil.exe /language:cs /out:MyServiceProxy.cs /config:app.config c:\path\to\my.wsdl

# c++ - 对象的默认比较运算符是什么？

> ID：13407157
> 
> 赞同：8
> 
> 时间：2012-11-15T22:12:37.193
> 
> 标签：c++, comparison, comparison-operators

我在我的代码中发现了一个错误，我在对结构容器进行排序时忘记使用自定义比较器。这让我想知道它用作小于运算符是什么，因为我没有为结构定义任何内容。

当未定义这些运算符时，对象如何比较 <、> 和 ==？是通过内存地址吗？是否在标准中定义？我在 Google 上找不到任何此类信息。

编辑：

这是我正在使用的课程：

```
using namespace std;

typedef unsigned id;

class LogEntry {
    id master_id;
    string timestamp;
    string category;
    string message;
    string str_rep;

public:
    LogEntry(id id, string t, string c, string m) :
            master_id(id), timestamp(t), category(c), message(m) {
    }

    string get_timestamp() const {
        return timestamp;
    }

    string get_category() const {
        return category;
    }

    string get_message() const {
        return message;
    }

    string to_string() {
        ostringstream ss;
        ss << master_id << "|" << timestamp << "|" << category << "|"
                << message;
        return ss.str();
    }

    id get_id() const {
        return master_id;
    }
}; 
```

编辑2：

我意识到我犯了一个愚蠢的错误。我正在存储一个指向对象的指针向量。因此，指针很可能通过地址进行比较。如果我没有存储指针，我认为它不会编译。

EDIT3：KerrekSB 在他的答案的评论中发布了一个相关的有趣链接：[如何完全订购指针？](https://stackoverflow.com/questions/13380063/how-can-pointers-be-totally-ordered)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T22:16:21.433

默认比较器是标准模板`std::less<T>`，它只`x < y`用于两个对象`x`和`y`类型`T`。有很多方法可以工作：

*   `T`是一种算术基本类型，并且使用了内置运算符。

*   `T`是一个类类型并且有一个成员`operator<`。

*   有免费功能`operator<(T const &, T const &)`。

*   您的用户定义类型具有到内置类型的隐式转换函数，该函数为调用内置类型提供了唯一路径`<`。

此外，可以专门`std::less`针对您的用户定义类型`T`。

# drools - 在 Drools Guvnor 中维护 drl（技术）规则

> ID：13407158
> 
> 赞同：4
> 
> 时间：2012-11-15T22:12:46.797
> 
> 标签：drools, rule-engine, drools-guvnor

我是业务规则领域的新手，但我想我已经理解 Drools Expert 和 Drools Guvnor 的概念，但与 Expert 相比，我仍然有点困惑如何/何时/为什么使用 Guvnor。而且，他们是否相互排斥或有能力甚至更喜欢并肩工作。以下是一些令人困惑的突出主题和我的担忧背后的一些解释，主要集中在应用程序的可维护性上。

**Guvnor 是否具有 Expert 中可用的所有功能以及更多功能？**

我知道 Guvnor 是业务规则管理系统 (BRMS)，它控制存储（包括版本控制）规则并将服务公开给其他应用程序使用。Guvnor 包含用于生成规则的 UI（文本和图形）和用于运行它们的引擎，因此从这个意义上说，我猜它包含专家系统的所有功能。根据我的要求，我很确定 Guvnor 是我所需要的，但是在那之后我需要 Drools Expert 吗？

或者换句话说，Drools Expert 是否提供了 Guvnor 中没有的东西？

**Guvnor 中的测试规则**

我看到的许多 Drools 教程都是从 TDD 示例开始的，其中使用简单的 jUnit 测试来测试规则。一旦规则被导入到 Guvnor（或只是在那里生成），有没有办法为它使用/编写单元测试？

测试是否应该仅通过公开接口 (REST) 进行？

如果系统的用户要制定自己的规则，我不希望他们编写任何测试。主要对“核心”规则及其可维护性感兴趣。

如果是“核心”规则，它们是否应该存储在版本控制系统中并在整个系统的预定更新时导入到 Guvnor？在这种情况下，可以为这些规则编写单元测试，并作为构建周期的一部分自动执行。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-14T10:54:51.480

根据您的一个问题，我应该先澄清一些事情。在本质上：

*   Expert 是一个规则引擎运行时。
*   Guvnor 是用于编写和存储规则的工具，随后将在 Expert 中执行。

Guvnor 不为您的规则提供运行时，除了测试工具所需的运行时。您的运行时环境将始终需要 Expert。Guvnor 使您能够管理规则并存储它们。它还提供了一些方便的 GUI 工具，例如引导式编辑器和 Web 决策表。但是，您也可以在 IDE（例如 Eclipse）中编辑规则，并使用 Guvnor WebDav Eclipse 插件将它们推送到 Guvnor。

通常，您将在一台服务器上拥有一个 Guvnor Web 应用程序，而在其他地方拥有您的应用程序。您可以从 Guvnor 下载已编译的规则到您的应用程序构建中，并将它们与您的应用程序一起部署。或者，您可以在代码中定义一个 URL 资源来创建您的知识库，指向 Guvnor 包 URL。在这种情况下，您的应用程序可以在启动时加载知识库并在运行时重新加载它。

例如，以下代码将下载一个名为“Approved”的包快照作为构建知识库的资源。

```
UrlResource urlResource = 
    (UrlResource) ResourceFactory.newUrlResource(
        "http://my.guvnor.local/.../package/mypackage/Approved");
urlResource.setBasicAuthentication("enabled");
urlResource.setUsername("myusername");
urlResource.setPassword("mypassword");
KnowledgeBuilder builder = KnowledgeBuilderFactory.newKnowledgeBuilder();
builder.add(urlResource, resource.getType()); 
```

**编辑**- 如果您希望在 Guvnor 中更改规则时在运行时重新加载规则，请查看 KnowledgeAgent。

我使用 Guvnor 的主要原因是让非技术用户能够使用决策表和基于 DSL 的引导式编辑器来编写规则。

我喜欢在 Eclipse 中编辑技术规则，在那里我可以轻松地围绕它们编写单元测试并评估它们的行为是否符合我的预期。我发现这比 Guvnor 中的测试功能要容易得多。尽管 Guvnor 提供了一些版本控制，但我更喜欢 Subversion/Git 作为我的技术规则的版本控制。

我还在 Eclipse 中编写 DSL，然后将其部署到 Guvnor。这使得非技术用户更容易使用指导规则。

**测试规则**

关于测试，有几种选择。Guvnor 中有测试功能，可让您根据各种输入编写期望。但是，我个人觉得这种方式过于笨重且使用受限。我更喜欢用 Java/JUnit 编写测试。

首先，您可以编写简单的单元测试，加载一两个技术规则，用 DRL 编写并评估它们是否在您认为应该激活时激活，并在适当的情况下生成推断事实。

对于更复杂的测试，我编写测试，使用 Guvnor 中的包创建知识库，插入事实和触发规则，以评估包作为一个整体是否正常工作，包括那些已在引导编辑器中构建的规则或决策表。

**Guvnor 的其他用途**

值得注意的是，Guvnor 编辑器功能正在变得更加丰富，它正在成为不仅仅是规则的编辑器和存储库。例如，有丰富的 BPM 流程工具，很快就会比在 Eclipse 等 IDE 中获得的工具更好。

**概括**

如果您的所有规则都是由您自己和其他开发人员在 DRL 中编写的，那么使用 Guvnor 几乎没有什么好处。事实上，我会发现这是一个障碍。但是，如果您希望利用引导式编辑器或决策表，或者希望让“业务”用户管理一些规则，那么您应该更深入地了解 Guvnor。

# r - 随机森林错误 - 我内存不足吗？

> ID：13407159
> 
> 赞同：0
> 
> 时间：2012-11-15T22:12:53.190
> 
> 标签：r, random-forest

我正在运行这条线：

```
 Frest <- randomForest(x = BFrame(,'Prediction'), y = BFrame[,which(colnames(BFrame) != 'Prediction')]) 
```

它给出了错误：

> randomForest(x = BFrame(, "Prediction"), y = BFrame[, which(colnames(BFrame) != : 找不到函数 "BFrame") 中的错误

`BFrame`是一个`data.frame`

我非常困惑，因为我之前有效地使用过类似的代码。然而，这一次，BFrame 很大——18 个变量的 130000 个观察值。这个错误是我内存不足的结果吗？来源是否在其他地方？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:24:16.790

解析器正在读取`BFrame(, 'Prediction')`作为要调用的函数，没有/缺少第一个参数，第二个参数设置为`'Prediction'`. 我有理由确定您的意思是使用括号`[ ]`而不是括号`( )`：

```
BFrame[, 'Prediction'] 
```

# java - 无法使用桌面链接访问 java web start，而使用 web url 可以访问它

> ID：13407167
> 
> 赞同：0
> 
> 时间：2012-11-15T22:13:33.000
> 
> 标签：java, jakarta-ee, jnlp

我无法使用桌面快捷方式访问 Java Web Start 应用程序，但我可以使用 Web URL 访问它。

```
com.sun.deploy.net.FailedDownloadException: Cannot download resource. System is offline.
at com.sun.deploy.cache.ResourceProviderImpl.checkUpdateAvailable(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.isUpdateAvailable(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResourceCacheEntry(Unknown Source) 
```

和

```
network: Connecting socket://127.0.0.1:4063 with proxy=DIRECT
#### Java Web Start Error:
#### Could not load file/URL specified: http://sample.com/sample.jnlp 
```

我不知道如何为我的 java web start 配置代理。我已经检查了所有 jar 文件和 jnlp 文件的权限，一切似乎都很完美任何建议。

# jquery - Xcode 4.5.1, Cordova 2.2, jquery mobile

> ID：13407170
> 
> 赞同：2
> 
> 时间：2012-11-15T22:13:37.633
> 
> 标签：jquery, ios, xcode, cordova

我第一次尝试让 JQuery mobile (1.2.0) 与 Xcode 和 Phonegap (2.2.0) 一起使用。Xcode/Phonegap 安装工作 - 它已根据

[https://web.archive.org/web/20200806105755/http://docs.phonegap.com/en/2.2.0/guide_getting-started_ios_index.md.html](https://web.archive.org/web/20200806105755/http://docs.phonegap.com/en/2.2.0/guide_getting-started_ios_index.md.html)

然后，我将 jquery mobile css 和 js 添加到该项目的 www/js ad www/css 中，并得到了一个简单的 index.html

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.2.0.css"/>
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.2.0.css"/>

        <title>Test of jquery mobile</title>
    </head>
    <script type="text/javascript" src="cordova-2.2.0.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/jquery.mobile-1.2.0.js"></script>
    <script type="text/javascript" src="js/jquery-1.8.2.js"></script>

       <body>
            <div data-role="page" id="liveListPage">
                <div data-role="header" data-position="fixed" data-theme="a" >
                    <h1>Header</h1>
                </div>

                <div data-role="footer"  data-position="fixed" data-theme="a"  >
                    <h1>Footer</h1>
                </div>
            </div>

        </body>
    </html> 
```

但是当推动运行时 - 它构建得很好，但 jquery mobile 似乎根本没有采取行动 - 我只是得到没有固定位置和主题的 h1 'Header' 和 'Footer' 。我的方案是 <我的应用程序>/iPhone 6.0 模拟器。

我究竟做错了什么？日志窗口中没有错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T06:02:39.967

更改脚本文件的顺序。我还注意到您没有使用 jqm 加载 css 文件。因此，您可以先尝试从 jquery 网站加载。加载 js 和 css 文件的顺序非常重要。

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script type="text/javascript" src="js/jquery-1.8.2.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.2.0.js"></script>
<script type="text/javascript" src="cordova-2.2.0.js"></script>
<script type="text/javascript" src="js/index.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:41:53.517

我不太确定这是否是问题，但我注意到您的脚本不是**头部**或**正文**，它们应该在任何一个中，所以我总是将它们放在头脑中。所以这就是我要做的

```
 <!DOCTYPE html>
    <html>
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            <meta name="format-detection" content="telephone=no" />
            <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
            <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.2.0.css"/>
            <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.2.0.css"/>

            <title>Test of jquery mobile</title>

            <script type="text/javascript" src="cordova-2.2.0.js"></script>               
           <script type="text/javascript" src="js/jquery.mobile-1.2.0.js"></script>
           <script type="text/javascript" src="js/jquery-1.8.2.js"></script>
           <script type="text/javascript" src="js/index.js"></script> <!--your script-->

        </head>
           <body>
                <div data-role="page" id="liveListPage">
                    <div data-role="header" data-position="fixed" data-theme="a" >
                        <h1>Header</h1>
                    </div>

                    <div data-role="footer"  data-position="fixed" data-theme="a"  >
                        <h1>Footer</h1>
                    </div>
                </div>

            </body>
        </html> 
```

**编辑::**在有人指出您的脚本文件位于 jQuery 文件之上，因此我也注意到它不会注册 jQuery 库，因此我会将您的`index.js`文件向下移动一点，使其位于 jquery 库文件之下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T01:57:25.343

这里有两种可能性：

*   构建实际上并不是最新的——xcode 并不总是检测到对 web 文件的更改，因此当您在设备上运行时，您会看到旧版本。清洁通常会解决这个问题。

*   该链接略有错误 - 通常是大小写问题，因为与桌面操作系统不同，iOS 区分大小写。如果您将 Safari 网络检查器附加到您的应用程序，您可以查看哪些文件没有加载。

*   该链接完全错误 - 在桌面浏览器中打开 html 是否有效？

# python - 3D 数组乘法

> ID：13407174
> 
> 赞同：2
> 
> 时间：2012-11-15T22:13:48.660
> 
> 标签：python, arrays, numpy

我有数组`A`和`B`两个维度 MxNxH。

我想定义一个二元运算符来“相乘”，这样结果就是 MxN 维度。

等效的操作是：

```
C = A[:,:,0] * B[:,:,0] + A[:,:,1] * B[:,:,1] + .... + A[:,:,H] * B[:,:,H] 
```

有没有办法以更有效的方式执行此操作？
例如，在 numpy 中使用内置函数？

*我试过[`tensordot`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.tensordot.html)了，但这给出了不同的结果。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:45:30.657

最简单的是：

```
C = numpy.sum(A * B, -1) 
```

我认为这也可能有效：

```
C = numpy.einsum("...i,...i->...", A, B) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T00:28:25.403

试试这个：numpy.sum(A*B,axis=2)

这类似于其他建议，但可能更清楚（轴从 0 开始编号，因此轴 = 2 是第 3 轴或 MxNxH 中的 H）

# r - 多维求解器

> ID：13407178
> 
> 赞同：1
> 
> 时间：2012-11-15T22:14:01.660
> 
> 标签：r, multidimensional-array, integer, solver

我正在尝试编写一个解决方案来查找`B={b1, b2..b10}`10 维空间中的完整向量列表，使得 (a) 每个`b1..b10`都是 0 到 30 之间的整数；(b) 的值`t(B) %*% M %*% B`介于两个标量值`0.98*K`和之间`K`，其中`M`a 是给定的`10x10`矩阵。

如下所述的蛮力方法耗尽了这种大小的数组的空间。

`M<- array(dim=c(30, 10))`

`d <- do.call(expand.grid,lapply(dim(M),seq))` ETC...

是否有人对（a）我可以使用的求解器或（b）解决计算空间问题的非求解器方法有想法？

# scala - 运算符#:: 是什么意思？

> ID：13407180
> 
> 赞同：6
> 
> 时间：2012-11-15T22:14:10.823
> 
> 标签：scala

我意识到这可能是一个简单的问题，但在下面的代码行中实现的 '#::' 是什么。它是一个特殊的缺点吗？

```
def from(n: Int): Stream[Int] = n #:: from(n + 1) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-15T22:16:56.937

此运算符用于构造[流](http://www.scala-lang.org/api/current/scala/collection/immutable/Stream.html)而不是列表。考虑具有简单缺点的相同代码片段：

```
def from(n: Int): List[Int] = n :: from(n + 1) 
```

运行此方法将导致`StackOverflowError`. 但是`Stream[Int]`只有在需要时才对 tail 进行延迟评估（并且记住已经计算的值）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T22:15:49.587

它等同于`::`for Lists，但与 Streams 一起使用

也就是说，`n`成为流的**头部**`from(n+1)`，**尾部**在哪里

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:31:28.370

这意味着创建一个 Stream 对象。

它与`cons`for List 相同——而不是`::`总是创建一个 List，而是`#::`总是创建一个 Stream。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T12:07:05.763

有点晚了，但是有[http://scalex.org/](http://scalex.org/)可以很好地锁定这些东西（谷歌对任何非字母数字的东西真的一团糟）！祝你好运！**

# python - 机械化随机用户代理

> ID：13407183
> 
> 赞同：0
> 
> 时间：2012-11-15T22:14:35.750
> 
> 标签：python, python-2.7

每次我开始打开 ​​URL 时，我都试图让 Mechanize 使用随机的用户代理。有人可以指出我需要采取的正确方向吗？- 我到处搜索，找不到参考。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:23:10.163

此[链接](http://user-agents.my-addr.com/user_agent_request/user_agent_examples-and-user_agent_types.php)为您提供了一个示例用户代理参考。演示它的示例代码：

```
from random import choice
user_agents = ['Mozilla/5.0 (X11; U; Linux; i686; en-US; rv:1.6) Gecko Debian/1.6-7','Konqueror/3.0-rc4; (Konqueror/3.0-rc4; i686 Linux;;datecode)','Opera/9.52 (X11; Linux i686; U; en)']
random_user_agent = choice(user_agents) 
```

您可以将上述链接中任意数量的 user_agents 包含到变量 user_agents 中。

现在只需`random_user_agent`在初始化期间通过在其中添加标头将其放入 Mechanize 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T00:04:51.227

我在做网络爬虫时遇到了同样的问题，这是我使用的解决方案：

```
class URLOpener():      
    def opener(self,user_agent):
        cj=cookielib.CookieJar()
        #Process Hadlers
        opener=urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
        opener.addheaders=[
                        ('User-Agent', user_agent),
                        ('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'),
                        ('Accept-Language', 'en-gb,en;q=0.5'),
                        ('Accept-Charset', 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'),
                        ('Keep-Alive', '115'),
                        ('Connection', 'keep-alive'),
                        ('Cache-Control', 'max-age=0'),
                    ]
        return opener

    #Openers with different User-Agents
    def opener_list(self,f_path):
        #f_path is a path to the file that contains browsers
        f=open(f_path, 'r+')
        count=0
        user_agent_list=list()
        for line in f.xreadlines():
            count+=1
            user_agent_list.append(line[:-1])
        openers=[self.opener(user_agent) for user_agent in user_agent_list]
        return openers 
```

我创建的文件也类似于：

```
Mozilla/5.0 (Linux; U; Android 4.0.3; ko-kr; LG-L160L Build/IML74K) AppleWebkit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30
Mozilla/5.0 (Linux; U; Android 4.0.3; de-ch; HTC Sensation Build/IML74K) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30
Mozilla/5.0 (Linux; U; Android 2.3; en-us) AppleWebKit/999+ (KHTML, like Gecko) Safari/999.9
Mozilla/5.0 (Linux; U; Android 2.3.5; zh-cn; HTC_IncredibleS_S710e Build/GRJ90) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1
Mozilla/5.0 (Linux; U; Android 2.3.5; en-us; HTC Vision Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1
Mozilla/5.0 (Linux; U; Android 2.3.4; fr-fr; HTC Desire Build/GRJ22) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1
Mozilla/5.0 (Linux; U; Android 2.3.4; en-us; T-Mobile myTouch 3G Slide Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1
Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC_Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1
Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC_Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari
Mozilla/5.0 (Linux; U; Android 2.3.3; zh-tw; HTC Pyramid Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 
```

# android - Last Harka 显示在 Android 上阿拉伯语 Reshaper 中该行的第一个字符之前

> ID：13407184
> 
> 赞同：8
> 
> 时间：2012-11-15T22:14:44.057
> 
> 标签：android, arabic, right-to-left

我正在为我的应用程序使用这个[Amazing Arabic Reshaper](https://github.com/agawish/Better-Arabic-Reshaper)`Android`，一切正常，但它有一个小问题，它总是在 Android 中行的第一个字符之前显示最后一个 Harka (Harki)，我也尝试过`gravity right`等

它适用于高于 2.3.3 的 Android 版本，因为这是一种从右到左的语言我不明白为什么它在低于 2.3.3 的 Android 版本上不能正常工作，您可以查看下图以更好地理解。![在此处输入图像描述](../Images/cc01eba30c2afc257749efe2e9395c5d.png)

我还尝试将最后一个 Harka 移动到该行的第一个字符，它仅适用于第一行但在同样的问题出现之后。请帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:14:31.373

看来这是[Bidi规则](http://www.w3.org/TR/i18n-html-tech-bidi/)的原因；当您混合字母和符号时，最后一个符号不遵循句子方向，除非它位于两个字母之间。这就是为什么您只能通过最后一个 Haraka 获得它。

对于原生支持双向的 Android 版本，您不应**使用**阿拉伯语 reshaper 库。仅用于无法正确连接阿拉伯字母的 Android 版本。您可以在应用程序中添加一个选项，让用户决定天气或阿拉伯字母是否正确显示。

或者，您可以在您的应用程序中提供详尽的 Android 版本和天气列表，或者它是否原生支持 Bidi，因此您可以自动决定何时使用阿拉伯语整形器。

# c++ - 无法使用 Eclipse CDT 构建 C++ 项目

> ID：13407185
> 
> 赞同：1
> 
> 时间：2012-11-15T22:14:44.693
> 
> 标签：c++, cmake, eclipse-cdt

我有一个使用 CMake 的 C++ 项目，我想尝试将 Eclipse CDT 与 mingw 一起使用（该项目已经编译并使用 MSVC、code::blocks 等运行）

使用 Eclipse CDT，我选择了一个目标，然后右键单击以构建目标，但我收到以下消息：

> 22:59:13 **** 构建项目 OgreProcedural-RelWithDebInfo@ogreprocedural_eclipse **** “e:\MinGW\bin\mingw32-make.exe”-CE:/Prog/Builds/ogreprocedural_eclipse OgreProcedural 无法运行程序“e:\MinGW\bin\mingw32-make.exe”：目录无效。错误：在 PATH=[E:\Prog\ImageMagick;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program 中找不到程序“e:\MinGW\bin\mingw32-make.exe”文件 (x86)\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem ;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\TortoiseSVN\bin;C:\Program Files (x86)\Windows Live\Shared;C:\Program Files (x86)\Graphviz2。 26.3\bin;C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\;C:\Program Files\Microsoft SQL Server\110\Tools\Binn\;C:\Program文件 (x86)\QuickTime\QTSystem\;C:

...但 mingw\bin 目录在路径中，而 mingw32-make 在其中。

我错过了什么吗？

**编辑：** 最后，我能够构建项目，但是在 CMake 生成的众多构建目标中，有些构建良好，有些则没有。

# c# - 如何使用 XAML/C# 创建透明的“热点”

> ID：13407186
> 
> 赞同：2
> 
> 时间：2012-11-15T22:14:48.010
> 
> 标签：c#, xaml, windows-8

我对编码完全陌生（就像过去一个月刚刚学习一样），所以如果这是一个令人讨厌的简单问题，请耐心等待。我正在使用 XAML/C# 编写一个 Windows 8 应用程序。我想在页面上创建可操作的透明按钮。如果您想知道，这个想法是一个小孩可以通过玩耍来意外地发现一个动作。我不想要任何“热点”存在的视觉线索。我创建了透明的按钮。但是，当页面加载时，按钮暂时显示为灰色，然后变为透明。我已经对此进行了相当多的研究，但没有运气。我认为这是一个如此明显和简单的答案，没有人会费心去问它:) 任何建议都会非常受欢迎！谢谢！

```
 <!-- Back button and page title -->
    <Grid x:Name="LandingPage1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Button x:Name="backButton" Click="GoBack" IsEnabled="{Binding Frame.CanGoBack, ElementName=pageRoot}" Style="{StaticResource BackButtonStyle}"/>
        <TextBlock x:Name="pageTitle" Grid.Column="1" Style="{StaticResource PageHeaderTextStyle}">
            <Run Text="talk to "/>
            <Run Foreground="#FF0770A2" Text="me"/>
        </TextBlock>
    </Grid>
    <StackPanel HorizontalAlignment="Left" Height="526" VerticalAlignment="Top" Width="607" Margin="73,31,0,0" Grid.Row="1">
        <Image Height="382" Source="Assets/TTMBabyCrying.jpg" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="38,0,10,0"/>
        <Image x:Name="btnNeedPageNav" Height="150" Source="Assets/TMMneed.png" HorizontalAlignment="Center" VerticalAlignment="Bottom" PointerPressed="btnNeedPageNav_PointerPressed"/>
    </StackPanel>
    <StackPanel Height="526" Margin="715,31,0,0" Grid.Row="1" Width="607" HorizontalAlignment="Left" VerticalAlignment="Top">
        <Image Height="379" Margin="0" Source="Assets/TTMBoyBall.jpg" Stretch="Fill" VerticalAlignment="Center" Width="474" HorizontalAlignment="Left"/>
        <Image x:Name="btnWantPageNav" Height="150" Margin="0" Source="Assets/TTMwant.png" Stretch="Fill" Width="320" HorizontalAlignment="Center" VerticalAlignment="Bottom" PointerPressed="btnWantPageNav_PointerPressed"/>
    </StackPanel>
    <Button x:Name="btnBabyCrying" Content="" HorizontalAlignment="Left" Margin="329,127,0,0" Grid.Row="1" VerticalAlignment="Top" Height="116" Width="121" PointerPressed="btnBabyCrying_PointerPressed" Click="btnBabyCrying_Click" DragOver="btnBabyCrying_DragOver" Holding="btnBabyCrying_Holding" Opacity="0.0"/>
    <Button x:Name="btnNeedPageNav1" Content="" HorizontalAlignment="Left" Margin="30,261,0,0" Grid.Row="1" VerticalAlignment="Top" Height="357" Width="650" ClickMode="Press" Click="btnNeedPageNav1_Click" Opacity="0"/>
    <Button x:Name="btnWantPageNav1" Content="" HorizontalAlignment="Left" Margin="715,410,0,0" Grid.Row="1" VerticalAlignment="Top" Height="208" Width="641" Opacity="0.0"/>
    <Ellipse x:Name="BlueBall" Fill="#FF5AA2D8" HorizontalAlignment="Left" Height="150" Stroke="#FF5AA2D8" VerticalAlignment="Top" Width="150" Margin="878,261,0,0" Grid.Row="1" Opacity="0.7" RenderTransformOrigin="0.5,0.5" PointerPressed="BlueBall_PointerPressed">
        <Ellipse.RenderTransform>
            <CompositeTransform/>
        </Ellipse.RenderTransform>
    </Ellipse> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:56:46.990

听起来像一个整洁的项目。有多种方法可以做到这一点。我的建议是采用默认的按钮样式模板并根据您的需要对其进行处理，然后将其调用到实例中，所以像这样（请记住，我在这里留下了很多额外的混乱以供参考，或者如果您想添加任何东西。）注意你的设置器，我将 ContentPresenter 设置为 Visibility="Collapsed"

```
<Style x:Key="TransparentButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="FontFamily" Value="{StaticResource ContentFontFamily}" />
        <Setter Property="FontSize" Value="{StaticResource ContentFontSize}" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Padding" Value="3" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid x:Name="grid">
                        <Grid.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform />
                                <SkewTransform />
                                <RotateTransform />
                                <TranslateTransform />
                            </TransformGroup>
                        </Grid.RenderTransform>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates"/>
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Pressed"/>
                                <VisualState x:Name="Disabled"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <!-- In case you need it later -->
                        <ContentControl x:Name="contentPresenter" Visibility="Collapsed"
                                        Margin="{TemplateBinding Padding}"
                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                        Content="{TemplateBinding Content}"
                                        ContentTemplate="{TemplateBinding ContentTemplate}"
                                        Foreground="{TemplateBinding Foreground}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

您可以将此模板放在您的资源字典或您的 Object.Resources 等中。然后只需在视图中为您需要的实例调用它，例如；

```
<Button Style="{StaticResource TransparentButtonStyle}" Height="50" Width="50"/> 
```

希望这会有所帮助，如果您需要任何解释，请告诉我们，玩得开心！:)

# file - 在 webpy 中提供不是来自 /static 的静态文件

> ID：13407187
> 
> 赞同：1
> 
> 时间：2012-11-15T22:14:51.263
> 
> 标签：file, static, web.py, serving

有没有办法从 webpy 的 /static 文件夹中提供静态文件（图像）？我想做的是显示分散在各个目录中的图像，并且将它们全部移动到 /static 确实不是一种选择。如果在 webpy 中不可行，是否还有其他 python web 框架可以做到这一点？

谢谢，

v923z

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T08:53:39.080

在不同的网络服务器下部署您的 web.app 时，您可以轻松地做到这一点。但是如果你想在 web.py 开发服务器中设置静态路径，那么你必须修补 webpy 的静态中间件或编写你自己的。请在此处查看我对同一问题的回答：[Changing the static directory path in webpy](https://stackoverflow.com/questions/6960295/changing-the-static-directory-path-in-webpy?rq=1)

# postsharp - PostSharp 和未初始化的对象

> ID：13407188
> 
> 赞同：5
> 
> 时间：2012-11-15T22:15:04.477
> 
> 标签：postsharp

假设我有一个方面实现`IInstanceScopedAspect`并且我将此方面应用于类型中的方法。创建对象时如何初始化方面`FormatterServices.GetUninitializedObject`？构造函数没有被执行，因此`NullReferenceException`当我执行应用方面的方法时我得到一个。

是否有可用于初始化对象方面的 PostSharp API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:01:02.507

有一种`InitializeCurrentAspects`方法可用于这种情况，如此处所述；[http://doc.sharpcrafters.com/postsharp-2.0/Default.aspx##PostSharp-2.0.chm/html/M_PostSharp_Aspects_AspectUtilities_InitializeCurrentAspects.htm](http://doc.sharpcrafters.com/postsharp-2.0/Default.aspx##PostSharp-2.0.chm/html/M_PostSharp_Aspects_AspectUtilities_InitializeCurrentAspects.htm)

# parsing - PowerShell：使用 $ExecutionContext.InvokeCommand.ExpandString($var) 的双引号

> ID：13407189
> 
> 赞同：2
> 
> 时间：2012-11-15T22:15:07.753
> 
> 标签：parsing, variables, powershell

好的，我已经编写了一个在 Windows 8 中完美运行的脚本。我切换到 Windows 7 并获得了各种血液。经过一番调试，我发现了问题所在。Win 8 使用 PowerShell 3.0 和 Win 7 使用 PowerShell 2.0 并且 PowerShell 3.0 允许您在使用时使用双引号：

```
$ExecutionContext.InvokeCommand.ExpandString($var) 
```

由于我的代码严重依赖于此，其中许多字符串使用双引号，因此我正在尝试寻找解决方案。

Here-Strings 不起作用，因为我的一些字符串是这样的：

```
$var = 'this is a "sample" of $one of my strings' 
```

here-string 解决方法仅在我输出到文本文件时才有效，因为我在函数中大量使用此代码，所以我不希望这样做。

我在微软的网站上发现了一个与此相关的错误。它在 PowerShell 3.0 中的工作方式是它最初的工作方式。此外，将 Windows 7 升级到 PowerShell 3.0 也是不可能的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T23:12:25.003

您可以测试小于 3 的 PowerShell 版本，然后转义任何双引号，如下所示：

```
C:\PS> if ($PSVersionTable.PSVersion.Major -lt 3) { $var = $var -replace '"','`"' }

C:\PS> $ExecutionContext.InvokeCommand.ExpandString($var)
this is a "sample" of one baby of my strings 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T15:10:57.060

用双引号将 $var 括起来怎么样？

# php - 如何将外部存储库导入共享 Web 服务器文件夹

> ID：13407190
> 
> 赞同：0
> 
> 时间：2012-11-15T22:15:08.313
> 
> 标签：php, git

我是一个新的 git 用户。

我在 bitbucket 上有一个存储库，我想将它导入到我在实时共享主机 Web 服务器（我安装了 git）上创建的 .git 文件夹中。我可以通过 SSH 发出命令。我正在尝试创建[http://joemaller.com/990/a-web-focused-git-workflow/中列出的 PRIME 目录](http://joemaller.com/990/a-web-focused-git-workflow/)

关于特定 git 命令的任何想法。目前我的 .git 目标文件夹是空的。

提前致谢，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:26:41.780

从 HUB 的主分支中提取的非裸存储库中的 PRIME 似乎。因此，每隔一段时间从 HUB 拉出 PRIME 就可以了。

# python - 使用reg解析python中的html标签不起作用

> ID：13407193
> 
> 赞同：0
> 
> 时间：2012-11-15T22:15:28.367
> 
> 标签：python, html-parsing

我对这段代码有点麻烦，因为它没有按照我的意图工作。我知道正则表达式不是解决这个问题的最佳方法，但我不知道如何使用 html 解析器来做到这一点，而且漂亮的汤不是一种选择。这就是我想要做的事情。我有一个 html 文件，我需要提取两者之间的值

```
<div class="e_mail"> and </div> 
```

当我使用以下代码时，它会返回电子邮件地址：

```
['returned@email.com'] 
```

我怎样才能得到没有括号和引号的电子邮件地址？我宁愿使用比 reg 更干净的东西，但正如我所说，无法弄清楚 html 解析器。

```
f=urllib.urlopen('results.html')
s = str(f.read())
return re.compile('<div class="e_mail">(.*?)</div>', re.DOTALL).findall(s) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:32:14.213

做

```
return re.compile(expr, re.DOTALL).findall(s)[0] 
```

或者：

```
return re.findall(r'<div class="e_mail">(.*?)</div>', s, re.DOTALL)[0] 
```

请注意，如果没有结果，您将得到一个`IndexError`因为`re.findall`将简单地返回一个空列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:31:20.663

这可能对您有用：

```
f=urllib.urlopen('results.html')
s = str(f.read())
email = re.compile('<div class="e_mail">(.*?)</div>', re.DOTALL).findall(s)
return email[0] 
```

在返回之前还要确保它不是一个空列表。

# ios - 在 UITableView 中设置多个部分

> ID：13407194
> 
> 赞同：8
> 
> 时间：2012-11-15T22:15:29.140
> 
> 标签：ios, uitableview, tableview

我已经设置了一个带有自定义单元格的 uitableview。

我想把这些分成带标题的部分。查看下面的照片，我正在寻找以下布局：

部分 - 我的个人资料自定义单元格 - wwwwwwwwwwwwww...
部分 - 应用程序
自定义单元格 - 游戏
自定义单元格 - 共享
自定义单元格 - 评分
自定义单元格 - 设置
自定义单元格 - 帮助
自定义单元格 - 注销

我可以看到如何添加一个部分并控制一个部分中的行，但这会将单元格复制到多个部分中，我不知道如何让一个部分有一行，而另一个部分有 6 行。我还想为这些部分设置样式以显示，有点像 Facebook 菜单样式。

我应该为实际部分创建自定义单元格并且对部分（单元格）选择没有任何操作吗？

这是 UITableView 的代码

```
static NSString *CellIdentifier = @"Cell";
LeftMenuTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {

    NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"LeftMenuTableViewCell" owner:nil options:nil];

    for (UIView *view in views) {
        if([view isKindOfClass:[UITableViewCell class]]) {
            cell = (LeftMenuTableViewCell*)view;

        }
    }
} 
```

![在此处输入图像描述](../Images/1ab92599ce824f3e3d083ff43b87041d.png)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-15T22:25:47.977

您可以在其中定义节数和行数，如下所示：

```
- (UIView *) tableview:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
{
    UIView view;
    if(section == 0) {
         // Initialise view for section 1
    } else {
         // Initialise view for section 2
    }
}

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 2;
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    return ((section == 0) ? 1 : 6);
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    // return appropriate cell(s) based on section
    if(indexPath.section == 0) 
    {
        // Return 1 cell
    }
    else if(indexPath.section == 1) 
    {
        switch(indexPath.row) {
            case 0: // Initialize cell 1
                    break;
            case 1: // Initialize cell 2
                    break;
            ...
        }
    }
    return cell;
} 
```

# java - 选择另一个微调器后更新微调器

> ID：13407199
> 
> 赞同：1
> 
> 时间：2012-11-15T22:15:52.480
> 
> 标签：java, android, spinner

嘿伙计们，我几天前刚开始制作 Android 应用程序，我试图用另一个微调器更新一个微调器信息。在您开始讨厌之前，我已经检查了其他答案并尝试了所有答案，但由于某种原因没有任何效果！它应该从一个 xml 字符串文件中获取一个数组并用我不知道我是否在我的代码中犯了错误或其他什么东西填充微调器，但它似乎不起作用。这是不起作用的代码部分：

```
public class NextBusesActivity extends Activity {

private Spinner spinnerRoutes;
private Spinner spinnerStops;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_next_buses);

    spinnerStops = (Spinner)findViewById(R.id.nextBusStopsSpinner);
    spinnerRoutes = (Spinner)findViewById(R.id.nextBusRoutesSpinner);

    spinnerRoutes.setOnItemSelectedListener(spinnerBusRouteHandler);
}

private OnItemSelectedListener spinnerBusRouteHandler= new OnItemSelectedListener(){

    public void onItemSelected(AdapterView<?> parent, View view, int pos,
            long id) {
        Log.d(MainActivity.DEBUGTAG, "Made it into the listener");

        //if (parent.getItemAtPosition(pos).toString().contains("Trent")){

            Log.d(MainActivity.DEBUGTAG, "Made it to Trent west bank     choice");
            ArrayAdapter<CharSequence> adapter =     ArrayAdapter.createFromResource(getApplicationContext(), 
                    R.array.westbank_stops,     android.R.layout.simple_spinner_item);
                     adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

            spinnerStops.setAdapter(adapter);

            Log.d(MainActivity.DEBUGTAG, "Spinner refill worked     westbank");
        //}

    }

    public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub

    }

};

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_next_buses, menu);
    return true;
}
} 
```

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-12T02:59:23.747

您的问题不在上面的代码中。您可能正在尝试在 onCreate 中手动设置第一个微调器的选择，并期望 ItemSelectListener 能够完成它的工作。好吧，事实并非如此。监听器只有在 onCreate 代码完全执行后才会激活。

所以如果你这样做：

```
@Override
public void onCreate(Bundle savedInstanceState) {
...
spinnerRoutes.setOnItemSelectedListener(spinnerBusRouteHandler);
spinnerRoutes.setSelected(someSpinnerPosition, true);

// some other code that involves the second spinner

} 
```

当您执行 setSelected 时，不要期望监听器会被完全触发，因为它不会。它将执行所有 onCreate 代码，甚至是“// 一些涉及第二个微调器的其他代码”，只有在此之后，侦听器才会激活并被触发。

我自己遇到了这个问题，我必须找到解决方法。非常烦人。

# c++ - 调用非成员而不是成员函数

> ID：13407205
> 
> 赞同：14
> 
> 时间：2012-11-15T22:16:13.447
> 
> 标签：c++

我有一个非常简单的问题：某处有一个函数

```
int size (const C & c) 
```

至少可以通过与参数相关的名称查找来找到它。现在的问题：

```
struct B
{
    int size () { /* ... */ }

    void doSomething (const C & c)
    {
       int x = size (c); // <----------- problem!
       // ...
    }
} 
```

这不起作用，因为名称查找在找到成员函数后停止。

我必须在指示的行中写什么，以便*不*尝试调用成员函数，而是编译器会在成员函数不存在的情况下执行它会做什么？

请注意，解决方案*不是*write `::size`，因为这会阻止[依赖于参数的名称查找](http://en.wikipedia.org/wiki/Argument-dependent_name_lookup)，并且仅在我知道`size`声明的位置时才有效。

**进一步的并发症：**

我知道对于`T`我使用以下模板化成员函数的每种相关类型`B::doSomething`，某处都会有一个函数

```
int size (const T & t) 
```

至少可以通过与参数相关的名称查找来找到它。`B`如下所示：

```
struct B
{
    int size () { /* ... */ }

    template<class T>
    void doSomething (const T & t)
    {
       int x = size (t); // <----------- problem!
       // ...
    }
} 
```

我希望调用非成员函数（我确信它存在，但我不能确定它在哪里）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-08-19T09:15:25.430

这是一个众所周知的问题，它的解决方案同样众所周知。我很惊讶它还没有被提及。如果您有一个非成员函数，例如：

```
class C;
size_t size( C const &c ); 
```

您可以使名称查找优先于具有`using`声明的成员函数找到它：

```
struct B {
  size_t size();

  void foo( C const &c ) {
    using ::size;
    size_t sz = size(c);
  }
}; 
```

当编译器看到对 的调用时`size(c)`，它会从最里面的范围开始并向外搜索名为 的东西`size`。如果没有`using`声明，编译器会在全局命名空间中的非成员之前在类范围内找到成员函数，但`using`声明会改变这一点。最里面的作用域是函数本身，使用声明在成员函数之前。

这样做的好处是您仍然可以获得参数相关查找（ADL），因为实际调用`size(c)`是不合格的。这意味着您可以在模板中使用它：

```
template <class T>
void foo( T const &c ) {
  using ::size;
  size_t sz = size(c);
} 
```

...即使正确的`size`函数位于另一个命名空间中，ADL 也会找到它。`using`声明只需要引用*一些* `size`函数，不一定是你真正想要的。在某个地方有一个可能调用该成员的默认实现是正常的。下一个版本的 C++ 标准 (C++17) 几乎肯定会有一个`std::size`功能可以做到这一点。一旦它被广泛使用，您将能够编写

```
using std::size;
size_t sz = size(c); 
```

目前，您可以提供自己的默认实现，例如：

```
template <class C>
constexpr auto size( C const &c ) -> decltype(c.size()) {
  return c.size();
} 
```

...或者您可以继续参考 的版本`C`，并依靠 ADL 找到正确的版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T22:19:07.027

如果你不能重命名你自己的成员函数，你可以使用一个肮脏的把戏：

```
static inline int dirty_trick(C const & c)
{
    return size(c);
}

void B::doSomething(C const & c)
{
    int x = dirty_trick(c);

    // ...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-20T19:50:57.683

为了完整起见，并补充理查德史密斯接受的答案：

我的解决方案现在如下所示：

```
namespace adl {
   // This declaration's only purpose is the possibility to refer to
   // a non-member function named "size" in a using declaration.
   //
   // The signature does not matter, so we choose the easiest possible one.
   void size ();
}

struct B
{
    int size () { /* ... */ }

    template<class T>
    void doSomething (const T & t)
    {
       using adl::size;
       int x = size (t); // <----------- no problem anymore
       // ...
    }
}; 
```

这样我就不必包含任何可能实际上不需要的标题。

# html - 如何自定义 HTML5 表单所需的验证消息？

> ID：13407207
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:16:20.183
> 
> 标签：html, html5-validation

> **可能重复：**
> [HTML5 表单必需属性。设置自定义验证消息？](https://stackoverflow.com/questions/5272433/html5-form-required-attribute-set-custom-validation-message)

我有一个输入如下的表格：

```
<input id="username" name="username" required> 
```

是否可以为必填字段设置自定义验证消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:22:51.387

这个问题已经在[这里回答了](https://stackoverflow.com/questions/5272433/html5-form-required-attribute-set-custom-validation-message)

* * *

使用 setCustomValidity：

```
$(document).ready(function() {
    var elements = document.getElementsByTagName("INPUT");
    for (var i = 0; i < elements.length; i++) {
        elements[i].oninvalid = function(e) {
            e.target.setCustomValidity("");
            if (!e.target.validity.valid) {
                e.target.setCustomValidity("This field cannot be left blank");
            }
        };
        elements[i].oninput = function(e) {
            e.target.setCustomValidity("");
        };
    }
}) 
```

# java - 将对象命名为与类名相同的名称是否违反 Java 约定？

> ID：13407209
> 
> 赞同：4
> 
> 时间：2012-11-15T22:16:36.960
> 
> 标签：java, conventions

如果我有一个对象`Mode`，根据通用/标准约定，调用变量是否可以接受`mode`？当我在 CS 课上（高中）提出一个假设的情况时，我的老师打断了我，问我为什么要称一个与班级同名的对象，而不用大写？（这在很大程度上脱离了上下文，但我假设的情况与此无关。）

另外，我已经明白，如果我的老师说这样的话，我通常应该这样做以符合她想要的惯例。我只是想知道一般情况下是否可以接受。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-15T22:19:04.747

**我认为这完全没问题。**这是正常的做法。类实例大部分时间命名相同，但以小写字母开头。

一般的命名模式是用很少的描述性名称来命名类和变量，以增加可读性和可维护性。只要命名是不言自明的，就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T22:18:09.353

我会说这遵循流行的惯例。这个想法是，如果您必须将变量命名为与类名不同的名称，那么您可能应该更改类名。

使用良好的描述性名称可以使代码具有可读性和可维护性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-15T22:19:55.297

据我所知，它是可以接受的，但请注意，它可能会造成混淆，尤其是当您使用该类的多个对象时。

# javascript - JavaScript 隐藏和显示切换，隐藏 DIV

> ID：13407216
> 
> 赞同：1
> 
> 时间：2012-11-15T22:17:01.480
> 
> 标签：javascript, jquery, toggle

对于以下示例，我将如何通过隐藏当前默认显示的“divToToggle”DIV 来启动页面？我不想使用“显示：无；” 出于可访问性原因，在脚本之外。如何在启动时隐藏脚本中的“divToToggle”？谢谢。

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
            <html>
            <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
            <title>JavaScript hide and show toggle</title>
            <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
            </head>
            <body>
            <script>
            function toggleAndChangeText() {
                 $('#divToToggle').toggle();
                 if ($('#divToToggle').css('display') == 'none') {
                      $('#aTag').html('[+] Show text');
                 }
                 else {
                      $('#aTag').html('[-] Hide text');
                 }
            }
            </script>
            <br>
            <a id="aTag" href="javascript:toggleAndChangeText();">[-] Hide text</A> 
            <div id="divToToggle">Content that will be shown or hidden.</div>
            </body>
            </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:19:09.490

只需使用 jQuery，因为您已经在使用它（并且这种方式不会阻止非 JS 用户看到该元素）：

```
function toggleAndChangeText() {
     $('#divToToggle').toggle();
     if ($('#divToToggle').css('display') == 'none') {
          $('#aTag').html('[+] Show text');
     }
     else {
          $('#aTag').html('[-] Hide text');
     }
}

$('#divToToggle').hide();
// the rest of your script(s)... 
```

此外，您的切换功能的小更新：

```
function toggleAndChangeText() {
    // because you're accessing this element more than once,
    // it should be cached to save future DOM look-ups
    var divToToggle = $('#divToToggle');
    divToToggle.toggle();
    // You're not changing the HTML, just the text, so use the
    // appropriate method (though it's a *minor* change)
    $('#aTag').text(function() {
        // if the element is visible change the text to
        // '...hide...'; if not, change the text to '...show...'
        return divToToggle.is(':visible') ? '[-] Hide text' : '[+] Show Text';
    });
} 
```

参考：

*   [`hide()`](http://api.jquery.com/hide/).
*   [`is()`](http://api.jquery.com/is/).
*   [`text()`](http://api.jquery.com/text/).
*   [`:visible`选择器](http://api.jquery.com/visible-selector/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:19:10.757

只需在 document.ready 函数中使用 hide 函数

```
$(function(){
     $('#divToToggle').hide();
}); 
```

# c# - C#函数执行批处理文件的Git pull问题

> ID：13407220
> 
> 赞同：2
> 
> 时间：2012-11-15T22:17:15.173
> 
> 标签：c#, git, command-line

我有一个简单的批处理文件：

```
cd <path to my git repository>
git pull 
```

我尝试使用以下 C# 函数执行它：

```
private NuGetBO.ShellCommandReturn ExecuteCommand(string path)
{
    ProcessStartInfo processInfo;
    Process process;

    processInfo = new ProcessStartInfo(path);
    processInfo.CreateNoWindow = true;
    processInfo.UseShellExecute = false;

    // *** Redirect the output ***
    processInfo.RedirectStandardError = true;
    processInfo.RedirectStandardOutput = true;

    process = Process.Start(processInfo);
    process.WaitForExit(5000);

    // *** Read the streams ***
    string output = process.StandardOutput.ReadToEnd();
    string error = process.StandardError.ReadToEnd();

    int exitCode = process.ExitCode;
    process.Close();
    return new NuGetBO.ShellCommandReturn { Error = error, ExitCode = exitCode, Output = output };
} 
```

但我收到以下错误：

```
"Access is denied.\r\nfatal: Not a git repository (or any of the parent directories): .git\n" 
```

换句话说，我试图从 C# 执行我的批处理文件几个小时都没有成功，但是，如果我在命令行中执行它，我的批处理文件可以正常工作。

我怎样才能让我的 C# 函数工作，我应该在我的批处理文件或 C# 函数中更改什么？谢谢

编辑：

我已将批处理文件的内容更改为以下内容：

```
cd <path to my git repository> && git pull 
```

但我收到以下错误：

```
Access is denied. 
```

编辑2：

我已经添加了对该文件夹的访问权限，现在我收到了一个新错误：

```
fatal: Not a git repository: "../.git/modules/myProject\n" 
```

编辑3：

我已授予 EDIT2 中提到的文件夹的访问权限，但现在我收到以下错误：

```
"error: unable to create directory for C:/myFolder/.git/modules/myProject/ORIG_HEAD\nfatal: Cannot lock the ref 'ORIG_HEAD'.\n" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:19:12.610

您需要设置`processInfo.WorkingDirectory`到 git repo 的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T09:59:33.483

如果您有兴趣集成整个库，也许它可以帮助[这个](https://github.com/libgit2/libgit2sharp/wiki/LibGit2Sharp-Hitchhiker%27s-Guide-to-Git)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T12:49:49.247

现在可以了。为了避免我遇到同样令人伤脑筋的问题，任何必须这样做的人都应该检查以下内容：有一个运行 C# 代码的用户，我们称他/她为`User`.

```
1\. User must have privileges to the folder where the git pull should be running.
2\. User must have privileges to the folder where the git repository is located (its path is described in the .git file located in the folder described at 1.) 
```

# php - mysql和PDO同时连接

> ID：13407224
> 
> 赞同：1
> 
> 时间：2012-11-15T22:17:39.793
> 
> 标签：php, mysql

如果我有一个 mysql 和 PDO 数据库连接，它们都连接到同一个数据库，同时打开所有相同的用户/密码信息。`SHOW PROCESSLIST`在 sql 命令行中运行时我应该看到两个连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:31:41.857

是的，当然，因为 PDO 和 mysql 使用不同的驱动程序，并且每个驱动程序在连接到 MySQL 数据库时都有自己独特的会话。

# php - 无法在 cakePHP 中对数据进行排序和分页

> ID：13407225
> 
> 赞同：3
> 
> 时间：2012-11-15T22:17:44.537
> 
> 标签：php, cakephp, sorting, paginator

首先让我知道我是 cakePHP 的一个完整的初学者。我在 cakePHP 中创建了一个名为 students 的表，我只想拥有可排序的标题，所以我使用了分页器帮助类。不幸的是，我收到以下警告，我只是不明白为什么，而且排序不起作用。

```
Warning (2)
: array_filter() expects parameter 1 to be array, null given       
[CORE\Cake\View\Helper\PaginatorHelper.php, line 395]

Warning (2)
: array_merge() [
function.array-merge
]: Argument #1 is not an array [CORE\Cake\View\Helper\PaginatorHelper.php, line 395] 
```

这是我的控制器

```
enter code here
<?php
class StudentsController extends AppController{
    public $helpers = array('Html', 'Form', 'Session', 'Paginator');
    public $components = array('Session', 'Paginator');

    public function index(){
        $this->set('students', $this->Student->find('all'));
    }

    public function view($id = NULL){
        $this->Student->id = $id;
        $this->set('student', $this->Student->read());
    }

    public function add(){
        if($this->request->is('post')){
            $this->Student->create();
            if($this->Student->save($this->request->data)){
                $this->Session->setFlash('The student has been added.');
                $this->redirect(array('action' => 'index'));
            }else{
                $this->Session->setFlash('Unable to add the student');
            }
        }
    }

    public function edit($id = NULL){
        $this->Student->id = $id;
        if($this->request->is('get')){
            $this->request->data = $this->Student->read();
        }else{
            if($this->Student->save($this->request->data)){
                $this->Session->setFlash('The student has been edited');
                $this->redirect(array('action' => 'index'));
            }else{
                $this->Session->setFlash('Unable to edit the student');
            }
        }
    }

    public function delete($id = NULL){
        if($this->request->is('get')){
            throw new MethodNotAllowedException;
        }else{
            if($this->Student->delete($id)){
                $this->Session->setFlash('The Student has been succesfully deleted');
                $this->redirect(array('action' => 'index'));
            }
        }
    }
} 
```

?>

这是我的观点实际上是我的索引

```
<h1>Welcome to the Students Page</h1>

<?php   echo $this->Html->link('Add Student', array('controller' => 'students', 'action' => 'add')); ?>

    <table>
        <tr>
            <th><?php echo $this->Paginator->sort('id', 'Matriculation Number'); ?></th>
            <th>Last Name</th>
            <th>First Name</th>
            <th>Course Of Studies</th>
            <th>Email</th>
            <th>Remark</th>
        </tr>
        <?php
            foreach($students as $student):
        ?>
        <tr>
            <td><?php echo $student['Student']['id']?></td>
            <td><?php echo $student['Student']['last_name']?></td>
            <td><?php echo $student['Student']['first_name']?></td>
            <td><?php echo $student['Student']['course_of_studies']?></td>
            <td><?php echo $student['Student']['email']?></td>
            <td><?php echo $student['Student']['remark']?></td>
            <td><?php echo $this->Html->link($student['Student']['id'], array('controller' => 'students', 'action' => 'view', $student['Student']['id'])); ?>
            <td><?php echo $this->Html->link('Edit', array('controller' => 'students', 'action' => 'edit', $student['Student']['id']));?></td>
            <td><?php echo $this->Form->postLink('Delete', array('controller' => 'students', 'action' => 'delete', $student['Student']['id']), array('confirm' => 'Are you sure ?')); ?></td>
        </tr>
        <?php endforeach; ?>
            <?php unset($student); ?>
    </table> 
```

我也使用了以下

```
<?php echo $this->Paginator->sort('id', 'Matriculation Number', array('model' => 'Student')); ?>
<?php echo $this->Paginator->sort('Student.id', 'Matriculation Number'); ?> 
```

我仍然得到同样的错误。我在这里错过了一些非常简单的东西吗？？？因为我已经在谷歌上搜索了几个小时没有运气....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:25:14.540

您实际上并没有使用 Paginator 组件，因此它没有设置助手使用的所需请求数据。改变你的索引功能看起来像

```
public function index(){
    $this->set('students', $this->paginate());
    // or $this->set('students', $this->Paginator->paginate());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-24T11:09:29.850

有两种方法可以做到这一点。

方法一：不使用 Paginatior

```
class StudentsController extends AppController  {

    public $paginate = array();

    public function index() {       
        ...
        $this->paginate['order'] = array('Student.created' => 'desc');
        $this->paginate['conditions'] = array('Student.active' => 1);
        $this->paginate['limit'] = 10;
        $this->set('students', $this->paginate());

        ...
    }
} 
```

方法二：使用分页器

```
class StudentsController extends AppController  {

    public $helpers = array('Paginator');
    public $components = array('Paginator');
    public $paginate = array(
        'limit' => 25,
        'order' => array(
            'Student.created' => 'desc'
        )
    );

    public function index() {       
        ...
        $this->Paginator->settings = $this->paginate;
        $this->set('students', $this->Paginator->paginate());       
        ...
    }
} 
```

# mpi - 在 MPI/OpenMP 的混合代码中计时单个函数

> ID：13407234
> 
> 赞同：4
> 
> 时间：2012-11-15T22:18:11.157
> 
> 标签：mpi, openmp

我有一个 MPI/OpenMP 的混合代码。我想知道每个 MPI 进程花费在特定功能上的时间是多少，比如说 A。该函数在 OpenMP do/for 循环内也被各种函数以非常复杂的方式调用（例如，一些其他函数，比如 B 和 C 可能正在调用 A，它也可能在 OpenMP do/for 循环内） . 我打算这样做如下：

```
double A()
{
 time1 = MPI_Wtime();
 //compute result...
 //Note: inside this function there is no OpenMP or MPI calls...
 //      just pure computation of results...
 time2 = MPI_Wtime();
 printf("myRank=%d timeSpent=%f\n", myRank, (time2-time1));
 return result;
} 
```

每个 MPI 进程的所有时间总和会是该 MPI 进程为此功能花费的总时间吗？如果不是，请告诉我如何正确获取它，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:29:16.340

我们不想重新发明轮子，也不想重新发明 MPI 分析器。那会很难。

许多集群系统的制造商都提供了非常强大的工具。例如 Cray 机器通常带有 CrayPat ，它会[吐出魔法](http://www.nersc.gov/users/software/debugging-and-profiling/craypat/)。

此外还有免费软件，例如[http://mpip.sourceforge.net/](http://mpip.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:27:03.667

我建议不要重新发明轮子，而是使用一些已经为分析而构建的专业级软件，例如[TAU](https://nesccdocs.rdhpcs.noaa.gov/wiki/index.php/Profiling_Codes)、[MPIP](http://mpip.sourceforge.net)或[Gprof](https://computing.llnl.gov/tutorials/performance_tools/exercise.html#6.%20gprof) ...

这是一个体面的[演示](http://www.chpc.utah.edu/docs/presentations/vampir/TAU06.pdf)，让你开始

# r - 从 ggplot2 图表中删除图层

> ID：13407236
> 
> 赞同：34
> 
> 时间：2012-11-15T22:18:30.010
> 
> 标签：r, ggplot2

我想从 ggplot2 创建的网格对象中删除一个`layer`（在这种情况下是 的结果）。`geom_ribbon`一旦它已经是对象的一部分，有没有办法可以将其删除？

```
library(ggplot2)
dat <- data.frame(x=1:3, y=1:3, ymin=0:2, ymax=2:4)
p <- ggplot(dat, aes(x=x, y=y)) + geom_ribbon(aes(ymin=ymin, ymax=ymax), alpha=0.3) 
     + geom_line()

# This has the geom_ribbon
p

# This overlays another ribbon on top
p + geom_ribbon(aes(ymin=ymin, ymax=ymax, fill=NA)) 
```

我希望这个功能允许我在不太复杂的情节之上构建更复杂的情节。我正在使用返回网格对象的函数，然后在完全组装后打印出最终图。基图有一条线，`geom_ribbon`周围有一个相应的误差线 ( )。更复杂的情节将有几条线，并且多个重叠的`geom_ribbon`对象会分散注意力。我想将它们从多行的图中删除。此外，我将能够使用构面或其他 ggplot2 功能快速创建替代版本。

* * *

*编辑：*接受@mnel's answer as it works。现在我需要确定如何动态访问该`geom_ribbon`层，这在[此处](https://stackoverflow.com/questions/13457562/how-to-determine-the-geom-type-of-each-layer-of-a-ggplot2-object)的 SO 问题中被捕获。

* * *

*编辑2：*为了完整起见，这是我为解决这个问题而创建的函数：

```
remove_geom <- function(ggplot2_object, geom_type) {
  layers <- lapply(ggplot2_object$layers, function(x) if(x$geom$objname == geom_type) NULL else x)
  layers <- layers[!sapply(layers, is.null)]

  ggplot2_object$layers <- layers
  ggplot2_object
} 
```

* * *

*编辑 3：*有关最新版本的 ggplot (>=2.xy)，请参阅下面接受的答案

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-15T22:31:51.873

如果你看

```
p$layers
[[1]]
mapping: ymin = ymin, ymax = ymax 
geom_ribbon: na.rm = FALSE, alpha = 0.3 
stat_identity:  
position_identity: (width = NULL, height = NULL)

[[2]]
geom_line:  
stat_identity:  
position_identity: (width = NULL, height = NULL) 
```

您将看到要删除第一层

您可以通过将图层重新定义为列表中的第二个组件来完成此操作。

```
p$layer <- p$layer[2] 
```

现在构建和绘图`p`

```
p 
```

* * *

请注意，这`p$layer[[1]] <- NULL`也可以。我同意@Andrie 和@Joran 关于在某些情况下这可能有用的评论，并且不认为这一定是可靠的。 ![在此处输入图像描述](../Images/3a383486d831886608d3d5d3b7775d78.png)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-09-14T13:55:14.433

对于 ggplot2 2.2.1 版，我不得不`remove_geom`像这样修改提议的函数：

```
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
} 
```

以下是如何使用它的示例：

```
library(ggplot2)

set.seed(3000)
d <- data.frame(
  x = runif(10),
  y = runif(10),
  label = sprintf("label%s", 1:10)
)

p <- ggplot(d, aes(x, y, label = label)) + geom_point() + geom_text() 
```

让我们显示原始情节：

```
p 
```

[![带有文本标签的绘图](../Images/899fc6e5d0ce63e0568fcf7fe0b7f3db.png)](https://i.stack.imgur.com/Z3VGD.png)

现在让我们删除标签并再次显示绘图：

```
p <- remove_geom(p, "GeomText")
p 
```

[![没有文本标签的绘图](../Images/df10add9d40f6336566451bc99b45a47.png)](https://i.stack.imgur.com/sYqAm.png)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-10-05T17:08:01.717

由于这个问题看起来很有趣，我已经扩展了我的 'ggpmisc' 包，其中包含一些函数来操作 ggplot 对象中的图层（目前在​​包 'gginnards' 中）。这些函数是我之前对同一问题的回答中示例的更完善的版本。但是，请注意，在大多数情况下，这不是最好的工作方式，因为它违反了图形语法。在大多数情况下，可以使用 operator 以正常方式组装同一图形的不同变体`+`，可能将层组“打包”到列表中以具有组合构建块，从而可以简化复杂图形的组装。在特殊情况下，我们可能想要*编辑*现有绘图或更高级别函数的绘图输出，我们无法修改其定义。在这种情况下，这些图层操作功能可能很有用。上面的例子变成了。

```
library(gginnards)
p1 <- delete_layers(p, match_type = "GeomText") 
```

有关其他示例，请参阅包的文档，以及有关可用于修改层顺序和在任意位置插入新层的伴随函数的信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-09-14T22:36:31.750

@Kamil Slowikowski 谢谢！很有用。然而，我无法阻止自己在同一主题上创建一个新的变体......希望比原始帖子或 Kamil 的更新版本更容易理解，同时也避免了一些作业。

```
remove_geoms <- function(x, geom_type) {
  # Find layers that match the requested type.
  selector <- sapply(x$layers,
                     function(y) {
                       class(y$geom)[1] == geom_type
                     })
  # Delete the layers.
  x$layers[selector] <- NULL
  x
} 
```

这个版本在功能上与Kamil的功能相同，所以上面的使用示例在此不再赘述。

顺便说一句，这个函数可以很容易地适应基于 stat 的类而不是 geom 的类来选择层。

```
remove_stats <- function(x, stat_type) {
  # Find layers that match the requested type.
  selector <- sapply(x$layers,
                     function(y) {
                       class(y$stat)[1] == stat_type
                     })
  # Delete the layers.
  x$layers[selector] <- NULL
  x
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-07-31T11:17:44.730

@Kamil 和@Pedro 非常感谢！对于那些感兴趣的人，还可以增加 Pedro 的函数以仅选择特定层，如下所示，带有一个`last_only`参数：

```
remove_geoms <- function(x, geom_type, last_only = T) {
  # Find layers that match the requested type.
  selector <- sapply(x$layers,
                     function(y) {
                       class(y$geom)[1] == geom_type
                     })
  if(last_only) 
    selector <- max(which(selector))
  # Delete the layers.
  x$layers[selector] <- NULL
  x
} 
```

回到@Kamil 的示例情节：

```
set.seed(3000)
d <- data.frame(
  x = runif(10),
  y = runif(10),
  label = sprintf("label%s", 1:10)
)

p <- ggplot(d, aes(x, y, label = label)) + geom_point() + geom_point(color = "green") + geom_point(size = 5, color = "red")

p 
```

[![在此处输入图像描述](../Images/c9ee9b07281cbfcff5c412bbc9c02322.png)](https://i.stack.imgur.com/o5zC0.png)

```
p %>% remove_geoms("GeomPoint") 
```

[![在此处输入图像描述](../Images/a157cd1654038ed2e99d62cda720ed01.png)](https://i.stack.imgur.com/82HhE.png)

```
p %>% remove_geoms("GeomPoint")  %>% remove_geoms("GeomPoint") 
```

[![在此处输入图像描述](../Images/2c8ed87fb4a1ff76d4984e94cd9f6983.png)](https://i.stack.imgur.com/6PLzy.png)

# javascript - 计算另一个类中一个类的元素

> ID：13407237
> 
> 赞同：1
> 
> 时间：2012-11-15T22:18:31.563
> 
> 标签：javascript, jquery

在另一个元素中计算特定类的元素的最佳方法是什么？

我有父元素的类，但该类还有其他元素。因此，例如，如果我有一个我喜欢这样的元素：

```
$(document).on('click', '.countButton', function(){

    var parent = $(this).parents('parentDiv');

}); 
```

如何将该元素放入选择器中以像这样计算它：

`$('.parentDiv > .childDivs').length;`

有没有办法将元素转换为选择器，或者指向该元素的东西？如果这有意义..

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:26:05.323

所以在`var parent = $(this).parents('parentDiv');`你有了你想要的元素之后，你只想要它的子元素和某个类？如果是这样

```
parent.children('.childDivs').length; 
```

对于直系后代或：

```
parent.find('.childDivs').length; 
```

在任何深度查找具有“childDivs”类的元素`parent`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:31:29.400

是的，您可以使用父元素作为搜索的上下文：

```
$('.childDivs', parent).length 
```

这与以下内容相同：

```
parent.find('.childDivs').length 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:26:42.807

你可以使用：

`document.querySelectorAll('.parentDiv > .childDivs').length`?

# image - 使用 Flex Builder 在 Actionscript 中定位组中的所有图像

> ID：13407239
> 
> 赞同：0
> 
> 时间：2012-11-15T22:18:41.397
> 
> 标签：image, apache-flex, actionscript

所以我基本上有这个代码：

```
<s:Group>
  <sImage source="assets/image1.gif"/>
  <sImage source="assets/image2.gif"/>
  <sImage source="assets/image3.gif"/>
  <sImage source="assets/image4.gif"/>
</s:Group> 
```

现在我需要在 actionscript 中针对它们中的每一个来执行 colorTransform，我该怎么做？

# php - 在 Zend 中创建一个新库？

> ID：13407240
> 
> 赞同：0
> 
> 时间：2012-11-15T22:18:43.673
> 
> 标签：php, zend-framework

> **可能重复：**
> [如何指示我的自定义类所在的 zend 框架](https://stackoverflow.com/questions/2495606/how-to-indicate-zend-framework-where-my-custom-classes-are)

我正在尝试在 Zend 中创建一个新库。我的新库目录 (/library/my-lib) 中有一些类

当我尝试从新库中的类创建对象时，我发现“找不到类”。

我需要在我的 application.ini 中进行设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:23:21.943

要添加自定义类（或自定义库），可以使用 zend 框架的自动加载器命名空间。

在 application.ini 文件中添加以下行

```
autoloaderNamespaces.custom = "Custom_" 
```

或者

```
autoloaderNamespaces[] = "Custom_" 
```

即使这样：

```
autoloaderNamespaces.extension[] = "Custom_" 
```

据说可以工作。

然后它应该找到你的库。顺便说一句，这是[这个问题的副本](https://stackoverflow.com/questions/2495606/how-to-indicate-zend-framework-where-my-custom-classes-are)

就像 Zdenek Machek 所说的那样，将名称更改为更标准的 zf 命名方式。即：MyLib 是一个比 my-lib 更好的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:25:24.293

是的，添加到 application.ini

> autoloaderNamespaces.extension[] = "MyLib_"

我建议还将 my-lib 更改为 MyLib 和类名，然后以 MyLib_ 开头

# python - 如何使列表成为字典中的键值？

> ID：13407253
> 
> 赞同：0
> 
> 时间：2012-11-15T22:19:51.890
> 
> 标签：python, list, dictionary, tuples

我需要制作一本字典，您可以在其中引用 [[1,2],[3,4]] --> ([1,2]:0, [2,3]:0) 我尝试了不同的方法，但是我不能使用字典中的列表。所以我尝试使用元组，但它仍然是一样的。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:21:53.840

您需要使用元组：

```
dict.fromkeys((tuple(i) for i in [[1,2],[3,4]]), 0) 
```

或（对于 python2.7+）

```
{tuple(i): 0 for i in [[1,2], [3,4]]} 
```

编辑：

阅读评论，OP可能想要计算列表的出现次数：

```
>>> collections.Counter(tuple(i) for i in [[1,2], [1,2], [3,4]])
Counter({(1, 2): 2, (3, 4): 1}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T22:22:54.803

列表不能用作字典键，因为它们不可散列（可能是因为它们可以变异，因此不可能提出合理的散列函数）。 `tuple`但是没有问题：

```
d = {(1,2):0, (3,4):0} 
```

请注意，在您的示例中，您似乎暗示您正在尝试构建这样的字典：

```
((1,2):0, (3,4):0) 
```

那是行不通的。您需要大括号来制作字典。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:24:53.950

`([1,2]:0, [2,3]:0)`不是字典。我认为您打算使用：`{(1,2):0, (2,3):1}`

# fancybox - fancybox 和 onfocus

> ID：13407256
> 
> 赞同：0
> 
> 时间：2012-11-15T22:20:00.653
> 
> 标签：fancybox, textarea

当我点击 textarea 时，我需要用里面的 php 文件加载 fancybox。

我的代码：

```
<script type="text/javascript">
    $("#mypop").click(function() {
        $.fancybox({
        'href'                  : 'file.php',
        'transitionIn'      : 'none',
        'transitionOut'     : 'none',
        'titleShow' : false,
        'overlayColor'  :   '#fff',
        'overlayOpacity':   0.8 }); });</script>

<textarea rows="4" cols="50" onfocus="#mypop" ></textarea> 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:24:24.800

您需要更改您的 textarea 标签：删除`onfocus="#mypop"`和添加`id="mypop"`. 函数调用将`$("#mypop")`搜索带有 的元素`id="mypop"`，并且该`click(function(){...})`函数将添加事件侦听器。此函数调用也使 -属性变得`onfocus=`不必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T17:11:35.910

`<script type="text/javascript">`
    `$("#mypop").click(function() {`
       `$.fancybox("<iframe src='file.php' frameborder='0'></iframe>",`{
          `maxWidth : 700,`
          `maxHeight : 600,`
          `fitToView : false,`
          `width : '50%',`
          `height : '50%',`
          `autoSize : true,`
          `closeClick: false`
      `});`
    `});`
`</script>`
`<textarea rows="4" cols="50" id="mypop" ></textarea>`

作者：何塞·阿尔弗雷多 Cocom Chan

# iis - 在 EC2 上测试私有 SaaS？

> ID：13407265
> 
> 赞同：0
> 
> 时间：2012-11-15T22:20:47.673
> 
> 标签：iis, amazon-ec2, saas

我想开始在我们的 EC2 实例上对我们的 SaaS 应用程序进行一些测试，并且对如何在我们的本地开发环境之外进行测试有一些疑问。

我有哪些选项可以在 EC2 中将其设为私有以在不使站点生效的情况下全面测试通配符子域？

这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T05:42:30.787

您可以使用 VPN 将 EC2 子网作为您的私有网络的一部分，请参阅 amazon 文档。然后可能需要一个本地 DNS 来映射通配符子域或简单地编辑您的主机文件。

另一个建议是只向您办公室的 ip 开放服务，将请求从其他 IP 重定向到 404 等。

# django-grappelli - 部署后无法删除注册表项

> ID：13407274
> 
> 赞同：0
> 
> 时间：2012-11-15T22:21:14.170
> 
> 标签：django-grappelli

我有一个使用 mod_wsgi 3.3 作为中间件在 Apache 2.2 上运行的 django-grappelli 站点。我有两个问题

当我尝试删除一个注册表项时，它只是不做任何事情......此外，弹出窗口没有打开。它在同一页面上打开。有人可以帮助我吗？

这些问题仅发生在生产站点上（部署在 Apache 上）

我使用的配置如下：

*   操作系统：Windows 7 专业版
*   阿帕奇版本：2.2
*   Django 版本：1.4.2
*   Grappelli 版本：2.4.2
*   Python版本：2.7
*   WSGI vversion：python 2.7 的 3.3 win32

    # ===========================================

    httpd.conf：

    WSGIScriptAlias / "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/OdontoWeb/default.wsgi"

    命令拒绝，允许所有人允许

    别名 /grappelli "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/OdontoWeb/grappelli"

    命令允许，拒绝所有人允许

    SetHandler 无

    # ===========================================

    .ht 访问：

    RewriteEngine On RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^(.*)$ /site.wsgi/$1 [QSA,PT,L]

    # ===========================================

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T19:33:10.883

我解决问题。

原因：部署项目时，我将文件夹“admin”、“Grappelli”和“templates”放在项目根目录中，并在源“settings.py”上设置变量 STATIC_URL，值为“/”。

然后一些javascripts无法访问。

解决方案：为了解决这个问题，我将变量 STATIC_URL 设置为“/static/”，并将三个文件夹放在生产版本中名为 static 的文件夹中。因此，所有功能开始运行。:D

PS：我还使用这些配置编辑了 httpd.conf：

```
Alias /static "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/OdontoWeb/static"

<Directory "C:/Program Files/Apache Software Foundation/Apache2.2/htdocs/OdontoWeb/static">
    Order allow,deny
    Allow from all
</Directory>

<Location "/static">
    SetHandler None
</Location> 
```

# jsf - 如何将 action 或 actionListener 关联到 Primefaces 子菜单？

> ID：13407277
> 
> 赞同：0
> 
> 时间：2012-11-15T22:21:23.210
> 
> 标签：jsf, primefaces

我想问一下，当动态构建使用**Primefaces**菜单（或 tieredMenu 或 panelMenu 等）的 MenuModel时，是否可以将**action/actionListener**附加到 menuItem而不是**submenu 。**

 **我在www中没有找到任何东西

谢谢！**

# mips - 我不断收到错误的地址异常，知道为什么吗？

> ID：13407280
> 
> 赞同：1
> 
> 时间：2012-11-15T22:21:41.337
> 
> 标签：mips

我正在尝试做一个简单的程序来计算字符串中的字符数。似乎我遵循了结构，但我不断收到同样的错误地址错误，有人知道为什么吗？

```
 .data
array:  .space 100
prompt1: .asciiz " Enter the string that you would like to reverse and calculate character: "
prompt2: .asciiz " "

    .text
main:
    la  $a1, array  # allocate the array space      
ask:        
    li  $v0, 4      # print String
    la  $a0, prompt1    # load prompt1
    syscall
    li  $v0, 8      # read the string
    syscall
    move    $a1, $v0    # move input to $a1
    li  $t0 ,0      # $t0 will hold the actual numbers of character in the string        
loopCount:        
    lbu $t1, 0($a1)     # load the next character into t1
    beqz    $t1, print  # check for the null character
    addi    $a1, $a1, 1     # increment the string pointer
    addi    $t0, $t0, 1     # increment the count
    b   loopCount   # return to the top of the loop
print:    
    li  $v0, 1
    move    $a0, $t0
    syscall 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T10:38:51.667

您应该在系统调用之前加载缓冲区的地址和缓冲区`$a0`的大小以读取字符串。`$a1`

# c++ - 类中的 C++ 迭代器

> ID：13407309
> 
> 赞同：4
> 
> 时间：2012-11-15T22:24:27.160
> 
> 标签：c++, iterator

我有以下课程：

```
 class list {
      private:
        struct node {
          node() { data=T(); prev=next=this; }
          ˜node() {}
          T data;
          node *prev;
          node *next;
        };
      public:
        class iterator {
        public:
          iterator() : p(NULL) {}
          T & operator*() { return p->data; }
          iterator & operator++()
            { p = p->next; return *this; }
          iterator & operator++(int)
            { iterator tmp = *this; ++*this; return *tmp; }
          bool operator==(const iterator & rhs) const
            { return p == rhs.p; }
          bool operator!=(const iterator & rhs) const
            { return p != rhs.p; }
        private:
          friend class list<T>;
          iterator(node *p) : p(p) {}
          node *p;
        };
        iterator begin() { return iterator(head->next); }
        iterator end() { return iterator(head); }
        list();
        ˜list();
        etc ...
      private:
        int N;
        node *head;
        node *findnode(int);
    }; 
```

我看到 begin() 函数返回迭代器类的构造函数。这是否意味着在调用它时会创建一个新的迭代器？如果是这样，在分配给这个迭代器的变量超出范围后，内存是否会被回收？我有点困惑，因为迭代器构造函数没有返回类型。如果有人能对我的问题有所了解，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T22:29:54.430

是的，调用 begin 时会创建一个新的迭代器。在高层次上，是的，迭代器占用的内存将在超出范围后被回收。

构造函数没有返回类型，因为它们在要初始化的内存上被调用。

在较低级别上，在堆栈上声明的变量在超出范围时调用其析构函数，这是“回收”的一个方面。它们占用的内存在堆栈上而不是在堆中（就像调用 new 时那样），因此在执行删除或垃圾收集的意义上它不会被释放。相反，变量占用的内存可能会闲置一段时间或立即被覆盖，具体取决于堆栈帧是否在超出范围后立即被删除或添加（即函数正在返回堆栈或正在进行新调用） .

# php - 在 cms 中发帖时执行 PHP 代码

> ID：13407310
> 
> 赞同：1
> 
> 时间：2012-11-15T22:24:30.427
> 
> 标签：php

抱歉标题含糊不清，但很难用几句话来描述我的意思。

我制作了自己的 cms，并将其用于我所有的个人项目。在某些页面上，我想在内容区域中包含一个 php 脚本。我只是通过回显保存内容的变量来加载内容。

模板文件如下所示：

```
<div id="content">
echo $content;
</div> 
```

在我的 CRUD 中，我发布了一个包含 php 片段的帖子。

```
<?php echo "My name is ".$var.""; ?>; 
```

然后我保存它并加载页面，这就是发生的事情：

```
<div id="content">
echo <?php echo "My name is ".$var.""; ?>;
</div> 
```

但我想要的是执行 php 代码而不是得到回显。类似于 Wordpress 插件 Exec-PHP。谁能向我解释如何实现这一目标？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:31:10.050

您可以使用[PHP eval() 函数](http://php.net/manual/en/function.eval.php)来执行 PHP 代码。但是请注意，如果您曾经允许用户插入可能在某些时候被贯穿的文本`eval()`，您最终可能会遇到一些严重的问题。

php网站说：

> eval() 语言结构非常危险，因为它允许执行任意 PHP 代码。因此不鼓励使用它。如果您已仔细验证除了使用此构造之外别无选择，请特别注意不要将任何用户提供的数据传入其中，而无需事先正确验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:31:28.703

你可以试试 php [eval()](http://php.net/manual/en/function.eval.php)函数。但它被认为是邪恶的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:34:04.950

与其用PHP指令，不如输出成HTML，用Javascript来执行显示的内容？这样对您的服务器没有危险。其他人已经警告过`eval()`PHP 的危险。

# domain-driven-design - 领域驱动设计（DDD）中的 POCO

> ID：13407311
> 
> 赞同：0
> 
> 时间：2012-11-15T22:24:30.887
> 
> 标签：domain-driven-design, poco

POCO类在领域驱动设计中有`Validate()`方法等行为，是真的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T22:31:12.637

是的——“实体”封装了对象的数据和行为——所以它不再是一个普通的旧合约对象，它是一个域对象。

一种思考方式是想象您的其他代码都无法看到对象的属性，因此它们不能...

```
if (myDomainObject.Name != null) ... 
```

他们必须打电话

```
if (myDomainObject.IsValid()) ... 
```

当您更改有关使其有效的规则时，只需在域对象中进行更改，因为您已阻止逻辑从外部泄漏到使用它的代码中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T22:27:55.207

是的，领域驱动设计中的领域模型类应该关注行为，如果这就是你的意思的话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T10:04:50.523

不，他们没有像`Validate()`.

DDD 实体应始终处于有效状态。这就是为什么我们在类上使用行为（方法）而不是公共属性设置器。

> 这种方法是否会导致 POCO 具有依赖性？

不，通常一切都取决于 DDD 模型，反之亦然。

# objective-c - 适用于 iOS 的 Dropbox SDK：如何确定您使用的是哪个版本？

> ID：13407314
> 
> 赞同：1
> 
> 时间：2012-11-15T22:24:45.083
> 
> 标签：objective-c, ios, api, dropbox, dropbox-api

我正在使用 Dropbox SDK，但很久以前我将它安装在我的 iOS 应用程序中。确定 SDK 版本的最佳方法是什么？我似乎在任何头文件中都找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:42:17.193

SDK 版本在 DBSession 的 kDBSDKVersion 中声明。

# c++ - 可能是堆损坏，但它可能是别的东西吗？

> ID：13407316
> 
> 赞同：0
> 
> 时间：2012-11-15T22:24:59.467
> 
> 标签：c++, casting, crash-dumps, heap-corruption

我在多线程环境中运行以下 c++ 代码：

`A* a = (A*) (_x->b); a->DoStuff();`

`A`是一个具体的类，`_x`是`A`（比如说 type `X*`）的成员，并且`b`是一个`void *`.

此外，`this`它也是一个`A*`，它具有不同的内存位置，但与转储显示的数据相似`_x->b`。

我在取消引用时遇到了莫名其妙的崩溃。生成的转储文件非常详细，它显示`_x`状态良好并`_x->b`指向有效的非零内存地址。转储还显示，在第二个语句中，`a`为 0，这就是崩溃首先发生的原因。

我的问题：这次崩溃的原因是明确的堆损坏，还是更根本的原因？我计划使用 gflags 或 valgrind 等堆跟踪工具对此进行调试，但我很好奇是否有任何其他原因导致看似有效的指针在 c 样式转换后会以某种方式变为空。

# php - 插入代码不插入php

> ID：13407318
> 
> 赞同：0
> 
> 时间：2012-11-15T22:25:08.350
> 
> 标签：php

我有一个类似戳的应用程序，它似乎没有插入到“戳”表中。

尽管我的代码看起来和看起来都很好，但它似乎没有显示任何迹象？有任何想法吗？

```
if (@$_POST['poke']) {
  $check_if_poked = mysql_query("SELECT * FROM pokes WHERE user_to='$username' AND user_from='$added_by'");
$num_poke_found = mysql_num_rows($check_if_poked);
if ($num_poke_found == 1) {
 echo "Come on! Give the guy a chance!";
  }
 else
 if ($username == $cookie) {
 echo "You cannot Jab yourself.";
 }
 else
  { $poke_user = mysql_query("INSERT INTO pokes VALUES ('', '$cookie', '$username')") or trigger_error(mysql_error());
 echo "$username has been jabbed.";
  } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:27:08.387

在 MySQL 中，您将使用`AND`而不是`&&`.

```
SELECT * FROM pokes WHERE user_to='$username' AND user_from='$added_by' 
```

对于插入，您需要指定要添加的列

```
INSERT INTO pokes (ColumnA, ColumnB) VALUES ('A', 'B') 
```

要进一步调试，请尝试[检查错误](http://php.net/manual/en/function.mysql-query.php)...

```
$result = mysql_query('SELECT * WHERE 1=1');
if (!$result) {
    die('Invalid query: ' . mysql_error());
} 
```

# java - 开发主要通过Spring和Struts调用存储过程的应用程序的最佳方法

> ID：13407319
> 
> 赞同：1
> 
> 时间：2012-11-15T22:25:11.120
> 
> 标签：java, spring, hibernate, struts, mybatis

在我找不到我想要的东西之后，我在 stackoverflow 上的第一篇文章。

我正在开发一个应用程序，它主要只是从用户那里获取输入参数并将它们传递给 Oracle 存储过程。没有任何存储过程返回任何内容，因为它们的目的只是维护运行一堆 ODI 的计划。应用程序真正从数据库中获取和返回数据的唯一时间是显示当前计划。我在 Eclipse 中使用 Java 1.7。肯定使用 Struts 2 和 Spring，但不能决定是否应该使用 Spring JDBC、Hibernate 或 myBatis 作为数据层。当 90% 的数据库操作只运行不返回任何内容的存储过程时，哪种组合效果最好？我必须从头开始学习其中一个，所以学习曲线不那么陡峭的那个会更好。

谢谢。

ps 根据我目前所学到的，myBatis 可能是最好的方法，但找不到像 Hibernate 那样多的集成和运行存储过程的好例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:50:37.513

把事情简单化。使用直接 JDBC。

[http://docs.oracle.com/javase/7/docs/api/java/sql/CallableStatement.html](http://docs.oracle.com/javase/7/docs/api/java/sql/CallableStatement.html)

# android - 如何删除 CCPointArray 中的所有点

> ID：13407321
> 
> 赞同：2
> 
> 时间：2012-11-15T22:25:20.470
> 
> 标签：android, arrays, cocos2d-x

有没有一种简单的方法来擦除 CCPointArray 中的每个点？我能找到的只是使用 for 循环并调用 removeControlPointAtIndex。即便如此，那也没用，我也无法删除我的积分。有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T16:29:31.277

如果使用`CCARRAY_FOREACH`, 并擦除元素使用循环，则循环将无法正常工作。您不能使用它擦除元素。将气泡更改为：

```
 while (myArray.count != 0) 
```

用于删除元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-17T17:11:16.540

派珀曼应该是正确的。遍历每个索引并删除该特定节点，直到计数降至 0

# php - PHP 表单未在 process.php 中处理

> ID：13407326
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:25:27.617
> 
> 标签：php, forms, processing

我很难弄清楚为什么我的 PHP 表单正在 process.php 上处理，但没有返回到带有适当 $messages 的表单页面。我错过了一行代码吗？我自己写了这一切，这是第一次。

这是我的html：

```
<!DOCTYPE html>
<html lang="en">
<head>
<title>Test Contact Form - jQuery</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script type="text/javascript" src="js/main.js"></script>

</head>
<body>    
    <h3>Contact Us</h3>
    <?php echo $contact_message; ?>
    <form id="myForm" method="post" action="process.php">
        <input name="name" type="text" value="<?php echo $_POST[name]; ?>" placeholder="Name" required/>
        <br>
        <input name="email" type="email" value="<?php echo $_POST[email]; ?>" placeholder="you@yourmail.com" required/>
        <br>
        <textarea name="message" class="message" placeholder="We can answer your questions." required>
            <?php echo $_POST[message]; ?>
        </textarea>
        <br>
        <button type="submit" name="submit" class="btn send">
            <img src="img/send.png">
        </button>
        <br>
        <?php echo $contact_success_message; ?>
    </form>
    <!--close contact form-->    
</body>
</html> 
```

这是我的`process.php`

```
<?php

//checks for valid email
function is_valid_email($email) {
    $result = true;
    $pattern = '/^([a-z0-9])(([-a-z0-9._])*([a-z0-9]))*\@([a-z0-9])(([a-z0-9-])*([a-z0-9]))+(\.([a-z0-9])([-a-z0-9_-])?([a-z0-9])+)+$/i';
    if(!preg_match($pattern, $email)) {
        $result = false;
    }
    return $result;
}

//when send is pressed, validate fields
if(isset($_POST['submit'])) {
    $valid = true;
    $contact_message = '';
    if ( $_POST['name'] == "" ) {
        $contact_message .= "You forgot to tell us your name. ";
        $valid = false; 
    }
    if ( !is_valid_email($_POST['email']) ) {
        $contact_message .= "A valid email is required, don't worry we don't share it with anyone. "; 
        $valid = false; 
    }
    if ( $_POST['message'] == "" ) {
        $contact_message .= "What did you want to ask us? ";
        $valid = false; 
    }
    //if everything checks out, send the message! 
    if ( $valid == true ) {
        $safe_email = str_replace("\r\n","",$_POST[email]);
        $mail = "From: $_POST[name]\n";
        $mail .= "Email: $_POST[email]\n";
        $mail .= "$_POST[message]\n";
        mail('ME@MYEMAIL.COM','New Contact from RN+',$mail,"From: $safe_email\r\n");
        $contact_success_message = 'Brilliant I say! We will be in contact with you shortly.';
        //clear form when submission is successful
        unset($_POST);
    }
}
?> 
```

我本可以发誓我以前用过这个，但这次它没有返回到联系页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T00:22:12.157

看起来您打算使用这样的代码：

表单.php

```
<?php include 'process.php'; ?>
<!DOCTYPE html>
<html lang="en">
<head>
<title>Test Contact Form - jQuery</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script type="text/javascript" src="js/main.js"></script>

</head>
<body>

<h3>Contact Us</h3>
            <?php echo $contact_message; ?>
            <form id="myForm" method="post" action="process.php">
                <input name="name" type="text" value="<?php echo $_POST[name]; ?>" placeholder="Name" required/><br>
                <input name="email" type="email" value="<?php echo $_POST[email]; ?>" placeholder="you@yourmail.com" required/><br>
                <textarea name="message" class="message" placeholder="We can answer your questions." required><?php echo $_POST[message]; ?></textarea><br>
                <button type="submit" name="submit" class="btn send"><img src="img/se
__
formnd.png"></button><br>
                <?php echo $contact_success_message; ?>
            </form><!--close contact form-->

</body>
</html> 
```

表单处理器将设置您在 HTML 代码中输出的适当变量。由于 process.php 会检查方法是否为 POST，因此您不必在表单页面中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:35:11.610

如果您希望 process.php 重定向回您的表单，您需要添加一个 PHP 标头代码，例如：`header('Location: http://www.example.com/form.php');`

如果您想将任何数据带回原始页面，请将其作为 GET 变量包含在 URL 中：`header('Location: http://www.example.com/form.php?message='.$messagetext);`然后您可以通过使用 GET 在表单页面上检索它：`echo $contact_success_message = $_GET['message'];`

不要忘记`exit(); or die();`在重定向之后！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:18:39.317

如果您没有任何理由排除单个 PHP 页面，您可以将两者（表单和流程）合并到一个 php 页面中。

```
<?php
//checks for valid email function
...
if(isset($_POST['submit'])) {
...
}
?>
...your HTML goes here... 
```

如果没有提交数据，这将只显示表单，如果提交了表单，将“重新加载”页面，执行操作，并显示适当的消息。将表单操作更改为，`action=""`以便文件将发布到自身。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-15T22:36:07.643

我建议使用 jQuery 验证。它更容易，并且有助于解决您在返回消息时可能遇到的任何问题。

[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

像这样的东西...

```
$("#myForm").validate({
rules: {
    name: { required: true; }
},
messages: {
name: "You forgot to tell us your name.",
} 
```

});

您可以对电子邮件字段和整个表单执行此操作。你可以在网上找到很多例子。

只需包括您的其他字段。如果您这样做，验证是客户端的，表单将处理，然后您转发到感谢您联系我们页面。

# c# - 从网站 asp.net 转移到 android 和从 android 转移到网站 aps.net？

> ID：13407327
> 
> 赞同：1
> 
> 时间：2012-11-15T22:25:34.650
> 
> 标签：c#, java, android, asp.net

如何将数据从网站 asp.net 传输到 android 应用程序和移动设备到网站。EX：我想在应用程序中将每个学生从网站转移到设备学生。请：给我例子或教程，什么是技术用途？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:42:48.103

您可以将 ASP.NET Web 服务用于服务器端，[将 ksoap2-android](http://code.google.com/p/ksoap2-android/)用于客户端 android 应用程序。

通过这种方式，您可以通过调用 Web 服务（Web 方法）将数据发送到您的网站或更新您的数据库。

这是一个关于如何使用 ksoap2 的不错的教程：[http ://www.itcsolutions.eu/2011/03/03/how-to-consume-web-services-from-android-applications-using-ksoap2/](http://www.itcsolutions.eu/2011/03/03/how-to-consume-web-services-from-android-applications-using-ksoap2/)

以及如何创建 .NET Web 服务的教程：http: [//www.codeproject.com/Articles/863/Your-first-C-Web-Service](http://www.codeproject.com/Articles/863/Your-first-C-Web-Service)

# r - R中的情节从边缘出来？

> ID：13407331
> 
> 赞同：0
> 
> 时间：2012-11-15T22:25:44.327
> 
> 标签：r, plot

我在 R 中有一个绘图，由于某种原因，当我放大轴字体时，绘图窗口也不会变大。这使得轴的文本被剪切。任何想法如何解决这个问题？

我在这里谈论的是 Y 轴。

我在 Mac OS X 上使用 R。

# jquery - jQuery单页网站滚动/哈希问题

> ID：13407338
> 
> 赞同：2
> 
> 时间：2012-11-15T22:26:11.187
> 
> 标签：jquery, hash, scroll

我想创建一个包含所有子页面的多个（html5）部分的单页网站。有固定的导航。这里有几个要求：

*   单击导航链接时（例如#home，#about-me），我希望它平滑滚动到该部分
*   我想在 URL 中使用哈希，例如 domain.com/#about-me
*   我希望用户能够从他们的浏览器中使用后退/前进按钮，并且在使用时可以平滑滚动到该部分
*   当 URL domain.com/#about-me 立即加载时，我希望它从顶部平滑滚动到 #about-me 部分。

这几天我一直在想办法解决这个问题。我尝试从头开始这样做，并使用大量不同的插件，如 BBQ 插件。我想不通。但我学到了一点，所以我决定从头开始。我更喜欢在没有插件的情况下自己编写它，因为它很轻量级。但是，如果自己编写插件太麻烦的话，我完全可以使用插件。

现在我有这个 HTML，一个简单的导航：

```
<nav>
    <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#about-me">About me</a></li>
        <li><a href="#portfolio">Portfolio</a></li>
        <li><a href="#contact">Contact</a></li>
    </ul>
</nav> 
```

和部分：

```
<div id="content-wrapper">
    <section id="home">
        <div>content...</div>
    </section>
    <section id="about-me">
        <div>content...</div>
    </section>
    etc...
</div> 
```

现在对于 jQuery 部分：

```
// Function to check if section exists
function isSection(section){
    if($('section'+section).length > 0){
        return true;
    }
    else{
        return false;
    }
}

// Scroll function
function scrollToSection(section){
    var offset = $(section).offset().top;
    $('html, body').stop().animate({
        scrollTop: offset
    }, 600);
}

// The Click() function
$('nav ul a').click(function(){
    var section = $(this).attr('href');
    if(isSection(section)){
        scrollToSection(section);
    }
}) 
```

马上我就遇到了一个问题。哈希值发生了变化，但它会立即跳转到该部分，并且在一瞬间之后它仍然会执行滚动动画（从它之前的起始位置开始）。我可以使用 preventDefault() （这会导致完美的平滑动画），但哈希不会改变。很高兴它改变了哈希，所以浏览器历史记录工作，但是当历史记录按钮被按下时不会发生滚动。

我将如何从这里开始牢记最高要求？有什么建议和最好的例子吗？

我听说[BBQ hashchange](http://benalman.com/projects/jquery-hashchange-plugin/)插件非常适合这一切？我将如何实现这一点？该文档没有完全考虑我的要求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:31:17.240

动画完成后，您可以手动使用 set location.hash 更改 url。首先，您将使用 preventDefault 让它动画。滚动到您想去的地方后，您可以使用位置。

```
// Scroll function
function scrollToSection(section){
    var offset = $(section).offset().top;
    $('html, body').stop().animate({
        scrollTop: offset
    }, 600, function(){
       window.location.hash = section;
    });
}

// The Click() function
$('nav ul a').click(function(event){
    event.preventDefault();
    var section = $(this).attr('href');
    if(isSection(section)){
        scrollToSection(section);
    }
    return false;
})​ 
```

见[http://jsfiddle.net/adamzr/p5L57/](http://jsfiddle.net/adamzr/p5L57/)

另一种方法是让链接像往常一样更改哈希值。但是，我们可以使用 onhashchange 事件在哈希更改时进行滚动。

将您的点击处理程序替换为：

```
function locationHashChanged(event) {
    event.preventDefault();
    var section = location.hash;
    if(isSection(section)){
        scrollToSection(section);
    }
}

window.onhashchange = locationHashChanged; 
```

见[http://jsfiddle.net/adamzr/XDWuS](http://jsfiddle.net/adamzr/XDWuS)

这种方法更好，但我在 jsfiddle 散列中使用它的方式在使用 nav 转到部分之外不起作用。如果您在页面上有其他哈希值并且您也希望滚动为它们工作，您只需删除部分特定代码即可。

此外，它仅适用于支持 onhashchange 事件的浏览器。http://caniuse.com/hashchange

# android - Android - XML - 图像 - 检索

> ID：13407340
> 
> 赞同：1
> 
> 时间：2012-11-15T22:26:36.350
> 
> 标签：android, xml, image, xml-parsing, drawable

您好，我正在尝试解析一个 xml 文件，从而检索以下文件：

```
<questions>      
   <question
        number="3"
        text="Have you ever milked a cow?"
        imageUrl="http://www.google.com/quiz/Questions/q3.png" />
</questions> 
```

我从 xml 文件中获取必要的数据没有问题。现在我面临的问题是我想从 xml 文件本身加载图像，但现在不是远程获取它，而是从可绘制文件夹中获取它。

我尝试使用以下代码，但它似乎不起作用。也许我应该使用另一个命令而不是 imagesrc 从可绘制文件夹中获取图像。我一直在尝试的代码如下：

```
<questions>
    <question
        number="1"
        text="This shows the turn left sign"
        imagesrc="R.drawable.quizicon" />
</questions> 
```

感谢您的宝贵帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:33:33.970

```
@Override
public void startElement(String namespaceURI, String localName, String qName, 
        Attributes atts) throws SAXException {
    if (localName.equals("question")) {
          System.out.println("The value of attribute 'imageUrl' is: " + atts.getValue("imageUrl"));
    }   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:41:36.627

您可以使用[`getIdentifier`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29).

其他替代方法是在应用程序中使用查找表，或者使用`assets/`文件夹而不是捆绑的可绘制对象。

# javascript - 表格 cellIndex 和 rowIndex 与 colspan/rowspan

> ID：13407348
> 
> 赞同：14
> 
> 时间：2012-11-15T22:27:11.863
> 
> 标签：javascript, jquery, html-table

我正在使用以下提供的答案：

[如何使用 jQuery 找到每个表格单元格的“视觉位置”？](https://stackoverflow.com/questions/10966687/how-can-i-find-each-table-cells-visual-location-using-jquery/10967488#10967488)

但在这种情况下似乎不起作用：http: [//jsfiddle.net/TRr6C/9/](http://jsfiddle.net/TRr6C/9/)

注意 1,3 1,4 和 2,4 应该是 1,4 1,5 和 2,5

有人看到有什么问题吗？

或者，考虑到 colspan 和 rowspan，有没有更好的解决方案从表格单元格中获取 cellIndex 和 rowIndex？

这是代码：

```
function getCellLocation(cell) {

    var cols = cell.closest("tr").children("td").index(cell);
    var rows = cell.closest("tbody").children("tr").index(cell.closest("tr"));
    var coltemp = cols;
    var rowtemp = rows;

    cell.prevAll("td").each(function() {
        cols += ($(this).attr("colspan")) ? parseInt($(this).attr("colspan")) - 1 : 0;
    });

    cell.parent("tr").prevAll("tr").each(function() {
        //get row index for search cells
        var rowindex = cell.closest("tbody").children("tr").index($(this));
        // assign the row to a variable for later use
        var row = $(this);
        row.children("td").each(function() {
            // fetch all cells of this row
            var colindex = row.children("td").index($(this));
            //check if this cell comes before our cell
            if (cell.offset().left > $(this).offset().left) {
                // check if it has both rowspan and colspan, because the single ones are handled before
                var colspn = parseInt($(this).attr("colspan"));
                var rowspn = parseInt($(this).attr("rowspan"));
                if (colspn && rowspn) {
                    if(rowindex + rowspn > rows)
                    cols += colspn;                    
                }
            }

        });
    });

    return {
        rows: rows,
        cols: cols
    };
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-17T01:33:08.070

我的解决方案是 jQuery 插件的形式，因为我可以想象拥有这些信息的目的不止一个。它可以用于：

```
$("table tbody td").each(function(){ 
    $(this).text( $(this).cellPos().top +","+ $(this).cellPos().left );
}); 
```

该位置的形式为`{ top: rows, left: cols }`。在第一次调用时，表格被扫描，`TD`元素获取`data`带有缓存位置的项目。（可以通过使用参数调用来重建缓存`true`）。所有进一步的调用仅返回该缓存值。

希望这可以帮助！

[jsfiddle](http://jsfiddle.net/TRr6C/17/)

完整来源：

```
/*  cellPos jQuery plugin
    ---------------------
    Get visual position of cell in HTML table (or its block like thead).
    Return value is object with "top" and "left" properties set to row and column index of top-left cell corner.
    Example of use:
        $("#myTable tbody td").each(function(){ 
            $(this).text( $(this).cellPos().top +", "+ $(this).cellPos().left );
        });
*/
(function($){
    /* scan individual table and set "cellPos" data in the form { left: x-coord, top: y-coord } */
    function scanTable( $table ) {
        var m = [];
        $table.children( "tr" ).each( function( y, row ) {
            $( row ).children( "td, th" ).each( function( x, cell ) {
                var $cell = $( cell ),
                    cspan = $cell.attr( "colspan" ) | 0,
                    rspan = $cell.attr( "rowspan" ) | 0,
                    tx, ty;
                cspan = cspan ? cspan : 1;
                rspan = rspan ? rspan : 1;
                for( ; m[y] && m[y][x]; ++x );  //skip already occupied cells in current row
                for( tx = x; tx < x + cspan; ++tx ) {  //mark matrix elements occupied by current cell with true
                    for( ty = y; ty < y + rspan; ++ty ) {
                        if( !m[ty] ) {  //fill missing rows
                            m[ty] = [];
                        }
                        m[ty][tx] = true;
                    }
                }
                var pos = { top: y, left: x };
                $cell.data( "cellPos", pos );
            } );
        } );
    };

    /* plugin */
    $.fn.cellPos = function( rescan ) {
        var $cell = this.first(),
            pos = $cell.data( "cellPos" );
        if( !pos || rescan ) {
            var $table = $cell.closest( "table, thead, tbody, tfoot" );
            scanTable( $table );
        }
        pos = $cell.data( "cellPos" );
        return pos;
    }
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-09-10T18:51:59.687

@nrodic 的 scanTable() 的 vanilla js 版本

```
function scanTable(table)
{
    var m = [];
    for(var y=0; y<table.rows.length; y++)
    {
        var row = table.rows[y];

        for(var x=0;x<row.cells.length;x++)
        {
            var cell = row.cells[x], xx = x, tx, ty;

            for(; m[y] && m[y][xx]; ++xx);                        // skip already occupied cells in current row

            for(tx = xx; tx < xx + cell.colSpan; ++tx)            // mark matrix elements occupied by current cell with true
            {
                for(ty = y; ty < y + cell.rowSpan; ++ty)
                {
                    if( !m[ty] ) m[ty] = [];                    // fill missing rows
                    m[ty][tx] = true;
                }
            }

            // do here whatever you want with
            // xx: the horizontal offset of the cell
            // y: the vertical offset of the cell

        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-07-22T19:23:22.393

我改进了 user652649 的答案，以便函数根据给定的坐标返回单元格，并且不会错过 col/rowspan 的单元格，[这里是要点](https://gist.github.com/ZitRos/a96c8e7f8c0fe4e16a31)，或者只是一个代码：

```
/**
 * Returns the cell of the table by given (x;y) coordinates considering colSpan and rowSpan of the cells.
 * @param {HTMLElement} table - HTML table
 * @param {number} x - X position in table matrix
 * @param {number} y - Y position in table matrix
 * @returns {HTMLElement|null}
 */
var getTableCell = function (table, x, y) {
    var m = [], row, cell, xx, tx, ty, xxx, yyy;
    for(yyy = 0; yyy < table.rows.length; yyy++) {
        row = table.rows[yyy];
        for(xxx = 0; xxx < row.cells.length; xxx++) {
            cell = row.cells[xxx];
            xx = xxx;
            for(; m[yyy] && m[yyy][xx]; ++xx) {}
            for(tx = xx; tx < xx + cell.colSpan; ++tx) {
                for(ty = yyy; ty < yyy + cell.rowSpan; ++ty) {
                    if (!m[ty])
                        m[ty] = [];
                    m[ty][tx] = true;
                }
            }
            if (xx <= x && x < xx + cell.colSpan && yyy <= y && y < yyy + cell.rowSpan)
                return cell;
        }
    }
    return null;
}; 
```

# c# - 如何处理 InputScope="Number" 数据 (XAML)？

> ID：13407355
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:27:42.690
> 
> 标签：c#, windows-phone-7, xaml, inputscope

我创建了 3 个文本框，输入范围 =“数字”，一个用于当天，一个用于安装，一个用于年度 - 我还想验证输入是否正确，我该怎么做？我从 c# 想象...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T02:07:28.810

首先可以参考 Microsoft.Phone.Controls.Toolkit 的 DatePick 的代码

其次，如果您只想以简单的方式处理此问题，+ textChanged 事件

并检查您的 textbox 的值

# vb.net - 显示选择了哪个单选按钮

> ID：13407360
> 
> 赞同：0
> 
> 时间：2012-11-15T22:27:59.093
> 
> 标签：vb.net, button, radio-button

我在 1 个标签中显示 3 个单选按钮时遇到了一些问题，在该标签上选择了单选按钮，所以我有 3 个单选按钮，

单选按钮名称：

```
Single
Season
Flex 
```

因此，如果选择的单选按钮 1 显示在 lblReceiptAns.Text = "Option: " 中，

```
Select Case True
  Case radSingle.Checked
    Pricez = CDbl(txtTickets.Text) * SINGLETICKETS
    TotalPricce = Pricez
  Case radSeason.Checked
    Pricez = CDbl(txtTickets.Text) * SEASONTICKCETS
    TotalPricce = Pricez
  Case radFlexPack.Checked
    Pricez = CDbl(txtTickets.Text) * FLEXPACK
    TotalPricce = Pricez
End Select

If txtVenue.Text = "STADIUM" Then
  lblReceiptAns.Visible = True
  lblReceiptAns.Text = "Option: " & 
Else 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:35:41.373

我会创建一个新的模块级字符串变量 - Say ，然后在模块`RadioButtonSelected`中设置它的值。`RadioButton_CheckChanged`

然后，您只需：

```
lblReceiptAns.Text = "Option: " & RadioButtonSelected 
```

# r - 在 R w/ PLYR 中提取组回归系数

> ID：13407361
> 
> 赞同：3
> 
> 时间：2012-11-15T22:28:01.090
> 
> 标签：r, plyr

我正在尝试对数据集中的每个邮政编码运行回归并将系数保存到数据框中，但我遇到了麻烦。

每当我运行下面的代码时，我都会得到一个名为“coefficients”的数据框，其中包含每个邮政编码，但每个邮政编码的截距和系数等于简单回归的结果`lm(Sealed$hhincome ~ Sealed$square_footage)`。

当我运行下面链接中 Ranmath 示例中所示的代码时，一切都按预期工作。在使用 STATA 多年后，我是 R 新手，因此将不胜感激任何帮助:)

[R通过lapply命令从乘法回归中提取回归系数](https://stackoverflow.com/questions/9014308/r-extract-regression-coefficients-from-multiply-regression-via-lapply-command)

```
library(plyr)
Sealed <- read.csv("~/Desktop/SEALED.csv")

x <- function(df) {
      lm(Sealed$hhincome ~ Sealed$square_footage)
}

regressions <- dlply(Sealed, .(Sealed$zipcode), x)
coefficients <- ldply(regressions, coef) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T02:41:13.497

因为`dlply`接受一个`...`允许将其他参数传递给函数的参数，所以您可以使事情变得更简单：

```
dlply(Sealed,.(zipcode),lm,formula=hhincome~square_footage) 
```

的前两个参数`lm`是`formula`和`data`。由于`formula`在此处指定，`lm`将选取它给出的下一个参数（相关的邮政编码特定块`Sealed`）作为`data`参数...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:45:37.577

您正在应用该功能：

```
x <- function(df) {
      lm(Sealed$hhincome ~ Sealed$square_footage)
} 
```

到您的数据的每个子集，所以我们不应该对每次输出完全正确感到惊讶

```
lm(Sealed$hhincome ~ Sealed$square_footage) 
```

正确的？尝试在你的函数内部`Sealed`替换。`df`这样，您指的是传递给函数的每个单独片段中的变量，而不是 data frame 中的整个变量`Sealed`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T23:27:44.993

问题不`plyr`在于函数的定义，而在于函数的定义。您正在调用一个函数，但没有对变量做任何事情。

打个比方，

```
 myFun <- function(x) {
    3 * 7
  }

    >  myFun(2)
    [1] 21
    >  myFun(578)
    [1] 21 
```

如果你在不同的 x 值上运行这个函数，它仍然会给你 21，不管 x 是什么。也就是说，函数中没有对 x 的引用。在我这个愚蠢的例子中，修正是显而易见的；在您上面的功能中，混淆是可以理解的。和`$hhincome`应该`$square_footage`可以作为变量。

但是您希望您的x***在***`$`. 正如@Joran 正确指出的那样，`sealed$hhincome`与`df$hhincome`（和相同的`$squ..`）交换，这将有所帮助。

# javascript - 为什么 jQuery.cookie 为单个字符串值返回“[object Object]”

> ID：13407368
> 
> 赞同：1
> 
> 时间：2012-11-15T22:28:44.077
> 
> 标签：javascript, jquery, ruby-on-rails

我像这样在 Rails 上设置了一个 cookie，

```
cookies[:account] = { :value => @account.to_s, :expires => 3.month.from_now } 
```

这似乎工作正常，一个简单的`debug @account`节目

```
--- myvalue
… 
```

但是当使用 jQuery.Cookie 调用 cookie 时，它​​会返回 a `"[object Object]"`。

```
> $.cookie('account');
"[object Object]" 
```

知道为什么会发生这种情况以及如何解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-02T14:52:31.580

我知道我在这里的答案很晚，但只是想我也会在这个问题上发布我的解决方案。我与这个返回 [object Object] 的 jQuery Cookie 问题斗争了几个小时，并发现了一些可能导致这种情况的情况：-

*   相同的 cookie 名称但在不同的路径
*   我发现传递了 path/expiry 的参数，插件有时将其视为我正在设置一个值，并且它试图设置一个类似 JSON 的对象，其中 path 和 expiry 作为值。
*   使用加载时运行的 cookie 集代码加载脚本两次
*   AJAX 加载的内容刷新脚本可能会导致发生此问题。

最后，我决定使用 localStorage 选项，因为我存储的数据非常小，不值得浪费时间尝试让 jQuery cookie 工作。

我希望这对其他人有所帮助，并将他们从我所经历的沮丧中解救出来！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-28T19:23:13.493

对于遇到此问题的任何其他人，请检查以确保您没有多个同名 cookie（具有不同的路径或到期时间）。这可能导致 $.cookie() 返回`[object Object]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:40:07.160

`[object Object]`是 的返回值`Object.toString()`，因此这意味着 $.cookie('account') 正在返回一个非数字、非字符串对象。

开始弄清楚返回值中的内容（以帮助您确定返回的对象中的内容）的方法是遍历属性以找出答案。

所以，像这样：

```
var obj = $.cookie('account');
var msg = [];
for(var i in obj)  msg.push( i +" = " + obj[i]);
alert(msg.join("\n")); // or console.log(msg.join("\n")); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-09T20:53:14.877

您可以使用[Mozilla 库](https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie)。您将能够设置和获取这样的 cookie

```
docCookies.setItem(name, value);
docCookies.getItem(name); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-27T07:15:19.530

Cookie 的最大大小仅为 4kb。这可能是原因之一。

至于我的情况。单看数据，它肯定超过 4kb。

我的替代方案是使用 localStorage。

# ruby-on-rails-3 - 尽管测试功能正常，但 rspec 测试失败

> ID：13407371
> 
> 赞同：1
> 
> 时间：2012-11-15T22:29:10.997
> 
> 标签：ruby-on-rails-3, rspec

我对简单的标签进行了一些测试，或者结果是正确的，但是 rspec 测试失败了。我可以使用验证输出是否正确，`save_and_open_page`但我不明白为什么 rspec 测试不将其视为有效输出！？

你能看出哪里不对吗？谢谢！

**规格代码**

```
 it { save_and_open_page; should have_selector('title', text: "CredSimple - Sign in") } 
```

**产生的失败消息**

```
Failure/Error: it { save_and_open_page should have_selector('title', text: "CredSimple - Sign in") }
     expected css "title" with text "CredSimple - Sign in" to return something 
```

save_and_open_page 确认页面具有测试正在寻找的标题：

```
<title>CredSimple - Sign in</title> 
```

# button - 我应该使用 Button 还是 TextBlock？

> ID：13407378
> 
> 赞同：0
> 
> 时间：2012-11-15T22:29:27.843
> 
> 标签：button, windows-8, onclick, winrt-xaml, textblock

我有两个选择。我需要 48 个特定类型的控件；它需要响应点击和点击（对于触摸设备）。

我可以使用按钮、TextButtonStyle 和 Click 事件。或者我可以使用带有 Tapped 事件的 TextBlock。

我认为按钮的创建可能更“昂贵”。OTOH，虽然我相信当用户单击组件时也会调用“Tapped”，但我想这让我有点紧张，因为它的命名法。

另一个区别是按钮只占用必要的宽度，而 TextBlock 占用一切。而且我希望底层的 Grid 是可点击的，所以 TextBlock 就是这样一个问题。是否有一个属性可以使它像按钮一样更谦虚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T08:13:03.533

[在http://msdn.microsoft.com/en-US/library/windows/apps/hh465470](http://msdn.microsoft.com/en-US/library/windows/apps/hh465470)上有关于何时以及如何使用按钮的 Windows 应用商店应用程序设计指南。根据您的描述和本指南，听起来按钮是可行的方法。响应点击事件是它们的目的，TextBlocks 添加了您描述的额外问题。

# jquery - 如何停止功能或动画滞后/错误的事情？

> ID：13407380
> 
> 赞同：0
> 
> 时间：2012-11-15T22:29:52.517
> 
> 标签：jquery

我不确定我的标题是否正确，但我想做的是停止 fadeToggle();

当我单击一次它fadeIn 和第二次单击fadeOut 我的覆盖但是当我像疯狂的疯子一样快速单击按钮时它fadeIn 和fadeOut 真的很慢而且有问题......

我想要做的是防止这看起来有问题，因为我正在学习基础知识，我不知道怎么做，但是......所以请谁能告诉我？

这是示例：

```
$('#overlay-trigger, div#overlay').on('click', function() {
    $('div#overlay').fadeToggle();
}); 
```

[JS 小提琴示例](http://jsfiddle.net/uTtYA/)

所以值得注意的是，我有一个名为#overlay-trigger 的按钮。单击该按钮时，覆盖 fadeIn();

之后点击覆盖隐藏它的自我......

因此，如果您只是继续快速单击，您会发现它有什么问题...它卡住，缓慢，滞后，我不知道正确的短语...

请帮助我，并提前感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:31:42.777

使用停止像：

```
$('div#overlay').stop().fadeToggle(); 
```

更多信息：[http ://api.jquery.com/stop/](http://api.jquery.com/stop/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:31:54.123

您需要对动画使用 jQuery 的[.stop()](http://api.jquery.com/stop/)方法，并传入所需的参数 ex。等`.stop(true)`_`.stop(true,true)`

```
$('#overlay-trigger, div#overlay').on('click', function() {
    $('div#overlay').stop().fadeToggle();
});​ 
```

[http://jsfiddle.net/nPShy/](http://jsfiddle.net/nPShy/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T22:33:48.577

您可以使用**[：动画](http://api.jquery.com/animated-selector/)**选择器..

```
$('#overlay-trigger, div#overlay').on('click', function() {
    var $overlay = $('div#overlay');
    if( !$overlay.is(':animated')){
        $overlay.fadeToggle();
    }
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/uTtYA/2/)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T22:31:23.680

使用[.one()](http://api.jquery.com/one/) **可能会**解决您的问题。来自 jQuery API 文档：

> 将处理程序附加到元素的事件。每个元素最多执行一次处理程序。

该`one()`函数通过在第一次调用后取消绑定单击事件来工作。要从您的代码中修改尽可能少的部分，只需像下面这样使用它：

```
$('#overlay-trigger, div#overlay').one('click', function() {
    $('div#overlay').fadeToggle();
}); 
```

我希望它有所帮助。干杯

# django - Django 在模板中找不到静态图片

> ID：13407383
> 
> 赞同：2
> 
> 时间：2012-11-15T22:30:07.417
> 
> 标签：django, django-staticfiles

我在这里和文档中查看了几乎所有示例，但它根本不起作用

所以在我的**settings.py**文件中

```
STATIC_ROOT = '/mattr/static/'
STATIC_URL = '/mattr/public/'

STATICFILES_FINDERS = (
'django.contrib.staticfiles.finders.FileSystemFinder',
'django.contrib.staticfiles.finders.AppDirectoriesFinder',)

TEMPLATE_CONTEXT_PROCESSORS = ('django.core.context_processors.static',)

TEMPLATE_DIRS = ('mattr/public', ) 
```

基本上处理静态文件所需的一切。

在**urls.py**我有页面的正常模式（模板加载得很好）并有这个额外的行

```
urlpatterns += staticfiles_urlpatterns() 
```

在**views.py**我有（这是主页）：

```
def home(request):
    t = get_template('index.html');
    html = t.render(RequestContext(request))
    return HttpResponse(html) 
```

在模板文件**index.html**我有这一行

```
<img src="{{ STATIC_URL }}media/images/Mattr1.png"> 
```

然而它从不显示图像。即使我尝试直接在*http://127.0.0.1:8000/mattr/public/media/images/Mattr1.png*访问图像文件，它也会给我一个 Page Not Found 错误。我有点困惑路径从哪里开始但是因为我的模板页面加载我认为我的路径是正确的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T04:04:55.933

当您谈论静态文件时，请执行以下操作：

```
STATIC_URL = '/static/' #or whatever you want

STATICFILES_DIRS = (
    '/path/to/static/root/directory/',
) 
```

不要忘记昏迷或 django 的管理员不会有它的 css。大功告成，无需更改任何内容`urls.py`

如果您在谈论媒体，请执行以下操作：

```
MEDIA_ROOT = '/media/' # or whatever you want

MEDIA_URL = '/path/to/media/root/directory' 
```

并将其放在底部`myproject.urls`：

```
import settings
urlpatterns += patterns('', url(r'^media/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT,}),) 
```

完毕！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:41:46.810

在你的 settings.py 中试试这个：

```
import os
DIRNAME = os.path.dirname(__file__)

STATIC_ROOT = os.path.join(DIRNAME, 'static')

STATIC_URL = '/static/' 
```

在您的模板中：

```
{{STATIC_URL}}css/etc... 
```

你也在覆盖你的`TEMPLATE_CONTEXT_PROCESSORS`而不是这样做：在你的 settings.py

```
import django.conf.global_settings as DEFAULT_SETTINGS

TEMPLATE_CONTEXT_PROCESSORS = DEFAULT_SETTINGS.TEMPLATE_CONTEXT_PROCESSORS + (
"whatever_your_adding",
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:44:57.523

在路径前面使用“/”表示您是从根目录引用的，我猜不是这样。尝试这样做。

```
STATIC_ROOT = 'mattr/static/' 
```

# ios6 - 在 UITextView 中的字符下添加虚线红线

> ID：13407384
> 
> 赞同：1
> 
> 时间：2012-11-15T22:30:06.790
> 
> 标签：ios6, uitextview, spell-checking

我正在尝试为 UITextView 创建自定义拼写检查器。

为了显示一个单词拼写错误，我需要在拼写错误的单词下方添加“红色虚线”。为此，这是我认为可行的方法-

我创建了一个字典，其中包含 key 的值`NSUnderlineStyleAttributeName`。然而，它的作用是，它确实在字符下划线，但它没有点图案。此外，设置 strokeColorAttribute 似乎也没有任何效果。

这是我的代码 -

```
 NSMutableDictionary *misspelledAttributes = [NSMutableDictionary dictionary];
    [misspelledAttributes setObject:[NSNumber numberWithInt:kCTUnderlineStyleThick|kCTUnderlinePatternDot] forKey:NSUnderlineStyleAttributeName];
    [misspelledAttributes setObject:[UIColor redColor] forKey:NSStrokeColorAttributeName]; 
```

要将属性设置为特定范围的属性字符串 -

```
NSMutableAttributedString *attrString = [self.textView.attributedText mutableCopy];
[attrString addAttributes:misspelledAttributes range:wordRange]; 
```

如果有人可以帮助我并指出我缺少/做错了什么，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:01:03.097

我认为您将不得不找到 NSAttributedString 以外的方法。

据我所知，您在 iOS 中为[NSUnderlineStyleAttributeName](https://developer.apple.com/documentation/uikit/nsunderlinestyleattributename)选择的唯一值是 NSUnderlineStyleNone 或 NSUnderlineStyleSingle，它们代表数字。

[NSUnderlineColorAttributeName](https://developer.apple.com/documentation/uikit/nsunderlinecolorattributename)支持 iOS 7.0+。

# java - Shiro 的 SecurityUtils 内部结构

> ID：13407385
> 
> 赞同：0
> 
> 时间：2012-11-15T22:30:15.697
> 
> 标签：java, multithreading, jax-rs, shiro

这实际上是一个常见的问题，而不是 Shiro 特定的问题。我想了解的是如何`org.apache.shiro.SecurityUtils#getSubject`工作。`SecurityUtils`我已经检查了and的必要部分，`ThreadContext`现在我完全困惑了。我理解的基本`Shiro's` `SecurityUtils.getSubject()`工作方式是它返回绑定到当前执行线程的主题。实际上，我期待类似于 RequestLocal 而不是 ThreadLocal 的东西。

我的问题：

1.  如何`Shiro`确保应用程序的随机点具有与主题创建者线程相同的线程以提供相同的主题？（也许它与 Servlet 规范有关。将是很好的指点必要部分）特别是我对`JAX-RS`.

2.  这是整个主题中最令人困惑的部分。在多个请求绑定到单个线程的情况下如何`Shiro`工作？`Servlet 3 Container`

有人可以阐明这些问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:35:07.820

[在这个邮件列表线程](http://mail-archives.apache.org/mod_mbox/shiro-user/201211.mbox/%3CCAAtvD4WLA_Gu_1qOFJBLoo7UbYOLmSSA2yRxCH-5Tq-yZut0ZA@mail.gmail.com%3E "maling list thread")中详细回答

# php - PDO 分页不显示错误也不输出

> ID：13407387
> 
> 赞同：0
> 
> 时间：2012-11-15T22:30:28.053
> 
> 标签：php, mysql, pdo

我对 PDO 很陌生，我试图对我的结果进行分页。

只有当我将它上传到我的服务器时，我才有以下内容，我的浏览器窗口是白色的，什么也没有，甚至没有错误输出到窗口...

```
$resultPerPage = 6;
    $count = 0;
    $sql = "SELECT * FROM direcroty ORDER BY id DESC";
    $result_set = $database->query($sql);
    $noPage = 1;

    while ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
        echo ' span3"><span class="name">' . $row['First_Name'] . ' ' . $row['Surname'] . "</span>";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:32:36.840

*白页*通常意味着 PHP 错误。

从它的外观来看，您可能会收到该行的*非对象引用*错误：

```
$row = $sth->fetch(PDO::FETCH_ASSOC) 
```

`$sth`未在您提供的代码中定义，因此不是`PDOStatement`对象。那可能应该是：

```
$row = $result_set->fetch(PDO::FETCH_ASSOC) 
```

检查您的错误日志以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:34:59.160

可能你在 PDO 调用中有一个错误，我不排除这里有一个错字：

```
$sql = "SELECT * FROM direcroty ORDER BY id DESC"; 
```

...因为我认为应该调用该表`directory`。

添加错误检查 ( `error_reporting(E_ALL)`) 并验证服务器日志。

# c# - 如何使用 C# 更改我的声卡设置

> ID：13407390
> 
> 赞同：0
> 
> 时间：2012-11-15T22:30:41.703
> 
> 标签：c#, audio

我有一个播放 wav 文件的简单 c# 控制台应用程序。我想在我的应用程序中将 C# 中的声卡设置更改为 24 位/48Khz。我如何以编程方式做到这一点？

```
 static void Main(string[] args)
    {
        SoundPlayer simpleSound = new SoundPlayer(MyProg.Properties.Resources.BOOTLOAD48000);
        simpleSound.Play();

     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:45:55.813

采样率、位深度、通道和其他任何内容都嵌入在 wav 文件的标题中。

重新采样的直接方法是使用第 3 方 SA NAudio。搜索 stackoverflow 以找到更详细的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:57:49.203

音频播放子系统并不像您想象的那么简单。至少，您的播放不会直接进入声卡：它会在某个舒适的地方排队，以便在后台将数据与来自其他应用程序的音频（如果有）混合，然后将其转发到设备。

我不知道你为什么想要甚至需要在硬件上让它有点准确，但是如果这是你真正需要的，那么你需要利用低级别的独占访问 API 来与音频渲染硬件建立密切联系并交付绕过通常在途中发生的任何混合，直接进入播放缓冲区的数据。这些 API 很可能是本机的，在您设法将原始数据从文件中取出后，您肯定需要交付原始数据。这不会像`SoundPlayer.Play`.

然而，好消息是，如果硬件真的能够播放这种格式，那么您就有很好的机会进行上述操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T10:42:41.257

要强制 Windows 使用特定的采样率，您需要在独占模式下使用 WASAPI。否则，您将与其他应用程序共享声卡，他们可能需要它具有不同的采样率。NAudio 允许您执行此操作。您需要`AudioClientShareMode.Exclusive`将`WasapiOut`.

请注意，WASAPI 只能在 Windows Vista 及更高版本上使用。

# c++ - 无法从 HSL 转换为 RGB

> ID：13407393
> 
> 赞同：2
> 
> 时间：2012-11-15T22:31:01.260
> 
> 标签：c++, colors, rgb, hsl

我在将颜色从 HSL 转换为 RGB 时遇到问题。我写了以下函数：

```
struct RGB {
    float r, g, b;
};
RGB hslToRgb( float hue, float saturation, float lightness ) {

    RGB rgb1, rgbResult;

    float chroma = ( 1.0 - (float) abs( 2.0 * lightness - 1.0 ) ) * saturation;
    float h1 = hue / 60.0;
    float x = chroma * ( 1.0 - (float) abs( (float) ( (int) h1 % 2 ) - 1.0 ) );

    if ( ( 0 <= h1 ) && ( h1 < 1 ) ) {

        rgb1.r = chroma;
        rgb1.g = x;
        rgb1.b = 0.0;

    } else if ( ( 1 <= h1 ) && ( h1 < 2 ) ) {

        rgb1.r = x;
        rgb1.g = chroma;
        rgb1.b = 0.0;

    } else if ( ( 2 <= h1 ) && ( h1 < 3 ) ) {

        rgb1.r = 0.0;
        rgb1.g = chroma;
        rgb1.b = x;

    } else if ( ( 3 <= h1 ) && ( h1 < 4 ) ) {

        rgb1.r = 0.0;
        rgb1.g = x;
        rgb1.b = chroma;

    } else if ( ( 4 <= h1 ) && ( h1 < 5 ) ) {

        rgb1.r = x;
        rgb1.g = 0.0;
        rgb1.b = chroma;

    } else if ( ( 5 <= h1 ) && ( h1 < 6 ) ) {

        rgb1.r = chroma;
        rgb1.g = 0;
        rgb1.b = x;

    } else {

        rgb1.r = 0.0;
        rgb1.g = 0.0;
        rgb1.b = 0.0;

    }

    float m = lightness - 0.5 * chroma;

    rgbResult.r = rgb1.r + m;
    rgbResult.g = rgb1.g + m;
    rgbResult.b = rgb1.b + m;

    return rgbResult;

} 
```

这是它的测试：

```
float cHue = 0.0;
while ( cHue < 360 ) {
    RGB rgb1 = hslToRgb( (int) cHue, 1.0, 0.5 ); // max on saturation and a middle value for lightness
    printf( "r = %f, g = %f, b = %f\n", rgb1.r, rgb1.g, rgb1.b );
    cHue += 1.0;
} 
```

但是当我需要得到这个“整数”之间的所有范围时，我只得到 1.0 和 0.0 。

```
r = 1.000000, g = 0.000000, b = 1.000000
r = 1.000000, g = 0.000000, b = 1.000000
r = 1.000000, g = 0.000000, b = 1.000000
r = 1.000000, g = 0.000000, b = 0.000000
r = 1.000000, g = 0.000000, b = 0.000000
r = 1.000000, g = 0.000000, b = 0.000000 
```

任何人都可以帮我处理这段代码吗？公式来自：[http ://en.wikipedia.org/wiki/HSL_and_HSV](http://en.wikipedia.org/wiki/HSL_and_HSV)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:47:12.613

使用浮点模数`fmodf`为：

```
float x = chroma * ( 1.0 - (float) abs( fmodf(h1, 2.0) - 1.0 )); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:47:10.163

停止在 C++ 代码中使用 C 风格的强制转换（如`(int)`和）。当您需要浮点绝对函数时`(float)`使用。`fabs`将复杂的公式分解为许多步骤，在一行中完成所有操作不会获得任何效率。

每行进行 1 次计算。将结果存储在您认为需要的类型的变量中，并使用描述性名称。看看你是否可以避免使用 an `int`，除非你应该明确地四舍五入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:49:05.930

您的色度值似乎关闭了。你有它作为

```
float chroma = ( 1.0 - (float) abs( 2.0 * lightness - 1.0 ) ) * saturation; 
```

但我认为应该是

```
float chroma = saturation * lightness; 
```

因为维基百科说，

```
From HSV

Given a color with hue H ∈ [0°, 360°), saturation SHSV ∈ [0, 1], and value V ∈ [0, 1],
we first find chroma:

C = V \times S_{HSV} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-15T22:50:27.000

在你的线上：

```
float x = chroma * ( 1.0 - (float) abs( (float) ( (int) h1 % 2 ) - 1.0 ) ); 
```

您`(int)`对模数的转换会导致它删除浮点数的所有小数。从而使其成为二元函数。

[您需要像Michael Sh 描述](https://stackoverflow.com/a/13407604/356218)的浮点模数函数。

# java - switch 语句中使用的字符数组

> ID：13407405
> 
> 赞同：3
> 
> 时间：2012-11-15T22:31:39.040
> 
> 标签：java, expression, constants, java-7, primitive

当我说：

```
final static char [] BASES = new char[]{'A', 'T', 'C', 'G'};
.
.
       char c= in.charAt(i);
            switch(c){
                case BASES[0] : break;
                case BASES[1] : packed =(char) (packed | 1); break;
                .
                .
                .
            } 
```

但如果我说：

```
final static char a ='A';
final static char t ='T';
         switch(c){
                case a : break;
                ... 
```

快乐吗？我觉得我在这里很厚。：-/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:35:37.283

a 的参数`case`必须是常量，即原始/字符串常量或文字或枚举常量。你的数组是不变的，但不是它的内容......

在您的情况下，将指示一个枚举，下面的代码是您如何编写它的示例。它将所有与基础链接的逻辑放在枚举中，您现在可以在需要的地方重用这些逻辑 - 您也可以添加方法。主要代码现在干净且易于阅读。

主要代码：

```
public static void main(String[] args) {
    String input = "ATC";
    char packed = 0;
    for (char c : input.toCharArray()) {
        Base base = Base.valueOf(String.valueOf(c));
        packed = base.getPacked(packed);
    }
} 
```

你的枚举看起来像：

```
public enum Base {

    A {
        public char getPacked(char packed) {
            return packed;
        }
    }, T {
        public char getPacked(char packed) {
            return (char) (packed | 1);
        }
    }, C {
        public char getPacked(char packed) {
            return packed;
        }
    }, G {
        public char getPacked(char packed) {
            return packed;
        }
    };

    public abstract char getPacked(char packed);
} 
```

# c++ - 为什么 Qt Creator 不能链接到我自己的代码？

> ID：13407409
> 
> 赞同：1
> 
> 时间：2012-11-15T22:31:45.150
> 
> 标签：c++, linker, g++, qt-creator

尝试在 Qt Creator 2.4.1 中编译我的项目时出现异常错误。它编译得很好，直到它需要链接我的代码并且它说“未定义对'XXX'的引用”其中“XXX”是一个它编译得很好的文件，我写了所以我知道它似乎无法使用的功能发现存在。这是一个示例（以防我刚才描述的内容没有意义）：未定义对 `ESanity NSane::CSane::ArgumentCheck(int)' 的引用

这是我编写和编译的代码：

声明（在课堂上）

```
template<typename Type> ESanity ArgumentCheck(Type aObj); 
```

定义（来源）

```
template<typename Type>
ESanity CSane::ArgumentCheck(Type aObj)
{
    assert(aObj != NULL);

    return aObj != NULL ? ESanity_Sane : ESanity_Insane;
} 
```

Qt Creator（我猜它在技术上是 g++，Qt Creator 只是一个 IDE）说它无法链接到它自己的编译源，它还说当我在错误窗口中双击错误时，文件丢失即使它打开并且我可以看到它。

请注意：我正在使用 g++ 4.6.3 在带有 Qt Creator 2.4.1 的 Xubuntu 12.04 LTS 上进行编译

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:42:00.407

它是模板代码，你不能将定义分成.cpp，你必须将所有代码放在一个文件中

# c# - 此 Icomparer 中导致空引用的不一致在哪里？

> ID：13407412
> 
> 赞同：8
> 
> 时间：2012-11-15T22:31:52.810
> 
> 标签：c#, .net, compare, icomparable, icomparer

我在我的自定义 IComparer 实现中收到一个空对象，尽管它所应用的集合中没有空条目。我的理解是这可能是由 IComparer 实现中的不一致引起的。我无法在以下代码中发现这可能发生的位置。

作为参考，目的是这些首先按“正确”属性排序，然后如果它们相同，则根据“tiebreakerDelta”属性进行排序，该属性最接近零排序而不会超过。

```
 public int Compare(IFoolsSortable a, IFoolsSortable b)
    {
        int value1 = a.correct;
        int value2 = b.correct;

        // compare the total correct first
        if (value1 < value2) return 1;
        if (value1 > value2) return -1;

        // total correct is the same, sort on deltas (closest without going over)
        value1 = a.tiebreakerDelta;
        value2 = b.tiebreakerDelta;

        // returning -1 says "put value1 higher in the list than value2" 
        // (higher means closer to the 0 element of the sorted array) 
        if (value1 == 0) return -1; // a zero is higher than anything! 
        if (value2 == 0) return 1; // ditto, for the other arg, if val1 isn't zero 
        if (value1 == value2) return 0; // after that, if they are the same, say so 
        // if both are negative, then the larger one goes higher 
        if (value1 < 0 && value2 < 0) return (value1 > value2) ? -1 : 1;
        // if only one is negative, it goes higher 
        if (value1 < 0) return -1;
        if (value2 < 0) return 1;
        // finally, if both are postitive, lower one goes higher 
        return (value1 > value2) ? 1 : -1;
    } 
```

感谢您提供的任何帮助！

**编辑**：我确定这不是一个真正的空引用，它是由一些不一致引起的。此外，有时会显示此错误文本以确认 -

```
Unable to sort because the IComparer.Compare() method returns inconsistent results. Either a value does not compare equal to itself, or one value repeatedly compared to another value yields different results. x: '',  x's type: 'ResultsLineViewModel', 
```

不幸的是，断点对我没有帮助。

**编辑：**这是一个简短的示例，其中 ResultsLineViewModel 实现了 IFoolsSortable 接口：

```
List<ResultsLineViewModel> ls = new List<ResultsLineViewModel>();
        ResultsLineViewModel line1 = new ResultsLineViewModel();
        line1.correct = 10;
        line1.tiebreakerDelta = 0;
        ls.Add(line1);

        ResultsLineViewModel line2 = new ResultsLineViewModel();
        line2.correct = 10;
        line2.tiebreakerDelta = 2;
        ls.Add(line2);

        ResultsLineViewModel line3 = new ResultsLineViewModel();
        line3.correct = 10;
        line3.tiebreakerDelta = -3;
        ls.Add(line3);

        ResultsLineViewModel line4 = new ResultsLineViewModel();
        line4.correct = 9;
        line4.tiebreakerDelta = 0;
        ls.Add(line4);

        ls.Sort(new FoolsSort()); 
```

正确的排序是： Line1, line3, line2, line4

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-15T22:45:04.247

如果`a`大于`b`则`Compare(a,b)`应该返回 1 并且`Compare(b,a)`应该返回 -1。如果你有`a.correct = b.correct`, and both `a.tiebreakerDelta = 0`and`b.tiebreakerDelta = 0`那么这将与`Compare`方法不一致，因为你想保留操作的顺序。

据我所知，你应该先这样做

```
if (value1 == value2) return 0; // after that, if they are the same, say so 
```

然后这个：

```
if (value1 == 0) return -1; // a zero is higher than anything! 
if (value2 == 0) return 1; // ditto, for the other arg, if val1 isn't zero 
```

另请注意，您的逻辑是相反的，如果第一个大于第二个，您应该返回 1，而不是 -1。检查例如这个[链接](http://support.microsoft.com/kb/320727)

# java - 线程和jtable

> ID：13407418
> 
> 赞同：0
> 
> 时间：2012-11-15T22:32:23.403
> 
> 标签：java, multithreading, swing, jtable, event-dispatching

我有 jtable 的问题。

我有许多线程，每个线程都必须向 jTable 添加一行，但表仍然是空的。我正在使用 netbeans，图形与逻辑完全分开。有人能帮助我吗？

* * *

这是我用来添加一行的代码

**MainGui.java**

```
public void addToTable(String from, String to, int request, int response, String timeElapsed) {
    Object [][] temp = new Object [data.length + 1][5];

    for (int i = 0; i < data.length; i++) {
        for (int j = 0; j < 5; j++) {
            temp[i][j] = data[i][j];
        }
    }

    temp[data.length][0] = from;
    temp[data.length][1] = to;
    temp[data.length][2] = request;
    temp[data.length][3] = response;
    temp[data.length][4] = timeElapsed;

    data = temp;
    table.setModel(new DefaultTableModel(data, columnName));
} 
```

**MyThread.java**

```
public void run() {
    try {
        MainGui mg = new MainGui();
        mg.addtotable("null", "null", 0, 0, "null");
    } catch (Exception e) {
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T22:40:46.543

Swing 的第一条规则 -***不要从除事件调度线程之外的任何线程修改 UI***

首先，确保您的更新调用是同步的，使用`SwingUtilities#invokeLater`或者如果更新对代码路径至关重要`SwingUtilities#invokeAndWait`

向表模型添加行时，您负责触发通知视图模型已更改所需的更新事件。

如果您使用的是 a`DefaultTableModel`那么这将为您完成，如果您使用的是 an`AbstractTableModel`或您拥有`TableModel`，那么您将需要自己执行此操作。

最简单的方法是编写一个从 add 方法扩展`AbstractTableModel`和调用的实现[`AbstractTableModel#fireTableRowsInserted(int, int)`](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/AbstractTableModel.html#fireTableRowsInserted%28int,%20int%29)，这将告诉`JTable`模型已添加行并将导致表相应地更新自身。

不要被愚弄，在向表模型添加行时，使用`fireTableRowsInserted`通常比使用更快`fireTableDataChanged`，因为不需要重新绘制整个表。如果您对表进行了重大更改（添加/删除/更新了很多行），那么`fireTableDataChanged`将比一系列单独的插入/删除/更新调用更快。

查看[如何在 Swing 中使用表](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)和[并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)获取更多信息

**更新**

看起来我可能没有说清楚。模型负责触发事件。这意味着，在您的 add 方法中，您应该调用`fireTableRowsInserted`. 您应该避免从外部源调用这些方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T15:26:25.627

```
public class TM extends AbstractTableModel {
final List<Integer>ids;

public TM() {
    ids = new ArrayList();
}

@Override
public int getRowCount() {
    return ids.size();
}

@Override
public int getColumnCount() {
    return 1;
}

@Override
public String getColumnName(int column) {
    if(column == 0) {
        return "ID";
    } else {
        return "UNDEF";
    }
}

@Override
public Object getValueAt(int rowIndex, int columnIndex) {
    if(columnIndex == 0) {
        return ids.get(rowIndex);
    } else {
        return "NaN";
    }
}

public void addId(final int id) {
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            insertNewRow(id);
        }
    });
}

private void insertNewRow(int id) {
    ids.add(id);
    int rowIndex = ids.size();
    fireTableRowsInserted(rowIndex, rowIndex);
}

}

//Somewhere in your code
TM myModel = new TM();
myTable = new JTable(myModel);

//Somewhere from thread:
myModel.addId(123);

//Somewhere from another thread:
myModel.addInd(455); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:42:31.577

Swing 不是线程安全的。如果需要从 AWT 事件调度线程以外的线程修改 Swing 组件，请使用

```
SwingUtilities.invokeLater(new Runnable(){public void run() {
 // your code
}}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-27T03:27:31.537

此外，在尝试更新 的模型时`JTable`，在更新模型之前删除任何内容也很重要`tableModelListener`。`model.addColumn()`我用and看到了这个观察结果`table.moveColumn()`。确保在`tableModelListener`对模型进行任何更改之后添加。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T22:44:32.743

您能否澄清一下如何添加行？希望使用模型，对吗？添加新行后，您必须调用模型的方法 fireTableDataChanged/*不是最好的选择*/或 fireTableRowsInserted/*更好*/不要忘记使用 SwingUtilities.invokeLater 来避免问题 Swing

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-15T22:41:10.290

我希望你知道 Swing 不是线程安全的（除了少数例外）。您需要在代码中处理好这一点。

# sql-server-2008 - 返回给定日期的正确数据。

> ID：13407419
> 
> 赞同：3
> 
> 时间：2012-11-15T22:32:29.890
> 
> 标签：sql-server-2008

全部，

我有两张表，一张叫员工，另一张叫目标比率。它们通过 FK EmployeeID 关联

```
tblEmployee
EmployeeID FirstName LastName
1              John     Doe

tblTargetRatio
TargetRatioID EmployeeID EffectiveDate Ratio
      1            1        1/1/2012     8
      2            1        6/1/2012     5
      3            1        9/1/2012     7 
```

我的问题是如何查询 tblTargetRatio 表以返回以下情况的正确记录：

```
1 EmployeeID = 1 and Date = 03/12/2012 (Expecting Ratio = 8)
2 EmployeeID = 1 and Date = 10/10/2012 (Expecting Ratio = 7)
3 EmployeeID = 1 and Date = 08/12/2012 (Expecting Ratio = 5) 
```

谢谢，艾伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:39:07.713

您似乎正在寻找最近的生效日期。您可以通过查找小于正在搜索的值的最大值来做到这一点（正在搜索`@Date`的日期在哪里）：

```
select top 1 * from tblTargetRatio
where employeeid = 1 and effectivedate < @Date
order by effectivedate desc 
```

演示：[http ://www.sqlfiddle.com/#!3/f6d4b/2](http://www.sqlfiddle.com/#!3/f6d4b/2)

# jsf-2 - JSF2 的属性占位符 Spring 等效项

> ID：13407420
> 
> 赞同：1
> 
> 时间：2012-11-15T22:32:33.037
> 
> 标签：jsf-2

我有一个高度可配置的 JSf2 Web 应用程序。我需要能够将位于配置文件（类路径中的 config.properties）中的属性传递给使用 XML 配置声明的 jsf 2.0 托管 beabs。这是一个例子：

```
<managed-bean>
    <managed-bean-name>myBean</managed-bean-name>
    <managed-bean-class>${config.myBean.class}</managed-bean-class>
    <managed-bean-scope>application</managed-bean-scope>
    <managed-property>
        <property-name>property1</property-name>
        <value>#{config.myBean.property1}</value>
    </managed-property>
            <managed-property>
        <property-name>property2</property-name>
        <value>#{config.myBean.property2}</value>
    </managed-property>
</managed-bean> 
```

我的问题是如何从 config.properties 访问这些值并让 JSF 正确创建 bean。我知道我可以在春天使用属性占位符来做到这一点。

```
<context:property-placeholder location="classpath:/config/config.properties" /> 
```

有没有办法在 JSF 2.0 中做到这一点？是否有另一种解决方案来做我想做的事情？

请帮忙 ！！.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T04:17:11.613

JSF 提供了一个非常健壮的属性文件管理机制，它只比 spring 提供的设置稍微多一些。加载属性文件（或在 JSF 中调用的资源包）

1.  在 a 中的元素`<resource-bundle/>`下定义a`<application/>``faces-config.xml`

    ```
    <application>
        <resource-bundle>
           <base-name>
              com.me.resources.messages
           </base-name>
           <var>
               msg
           </var>
       </resource-bundle>
    </application> 
    ```

    Where`<base-name>`指的是您拥有属性文件的包/目录结构，并`<var>`指的是您将用于访问应用程序中文件中的属性的引用变量。确保您可以在 Web 应用程序中访问该目录结构。我的建议是将其存储在常规的 java 包中并与您的应用程序捆绑在一起。

2.  您现在可以在托管 bean 中引用您的属性

    ```
    <h:outputText value="#{msg['messages.error']}" /> 
    ```

    在您的托管 bean 中

    ```
     ResourceBundle securityBundle = ResourceBundle.getBundle("com.me.resources.messages");
     String errorMessage = securityBundle.getString("messages.error"); 
    ```

# rsync - rsync，将符号链接复制为其原始目录

> ID：13407425
> 
> 赞同：3
> 
> 时间：2012-11-15T22:33:13.903
> 
> 标签：rsync

我希望 rsync 将我的符号链接原始目录名称复制到新目标。我想复制我在一个目录中的链接，并使用这些链接仅复制它们链接到的目录及其原始名称。

**源码目录：**
default@ -> v1.2
previous@ -> v1.1
v1.0/
v1.1/
v1.2/

**我在目标目录中想要什么：（**我为复制默认链接和以前的链接做了其他事情）
default@ -> v1.2
previous@ -> v1.1
v1.1/
v1.2/

我目前正在使用这个：（一个选项是大写 i，而不是小写 L，因为它与这种字体一起出现）
**rsync -cIvrtRL /vol1/ALL/./dir1/dir2/dir3/default /vol2/new/ALL**

我在目标目录中实际得到的是：（
在使用 -l 复制符号链接默认值和以前的符号链接后，我得到了这个）
default/
previous@ -> v1.1

我不确定我在这里做错了什么，或者是否有其他东西破坏了这一点。

感谢您的任何帮助！

# php - PHP XMLReader 解析行 2 次

> ID：13407430
> 
> 赞同：3
> 
> 时间：2012-11-15T22:33:22.837
> 
> 标签：php, xml, xmlreader, output

我正在解析一个 xml 文件。例如，当我输出一个属性时，我总是得到 2 次结果。

这是我所做的一些简化代码：

```
 $xml = new XMLReader();

    $xml->open($file);

    while ($xml->read()) {
        if ($xml->name == 'file')
            echo $xml->getAttribute ('Product_ID') . '<br />';
    }

    // close stream
    $xml->close(); 
```

这就是我得到的：

> 1980 1980 37444 37444 45287 45287 65438 65438 76916 76916 101158 101158 271287 271287

XML结构如下：

```
<file path="export/freexml.int/DE/15986140.xml" Product_ID="15986140" Updated="20121114141132" Quality="ICECAT" Supplier_id="728" Prod_ID="RBBD2MZ" Catid="2282" On_Market="0" Model_Name="ThinkCentre Edge 92z" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15916192-2729.jpg" HighPicSize="12635" HighPicWidth="337" HighPicHeight="294" Date_Added="20121114000000"></file>
<file path="export/freexml.int/DE/15986142.xml" Product_ID="15986142" Updated="20121114143018" Quality="ICECAT" Supplier_id="24" Prod_ID="NX.C0ZEB.002" Catid="151" On_Market="0" Model_Name="TE11HC-32376G50Mnks" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15986142-574.jpg" HighPicSize="179174" HighPicWidth="786" HighPicHeight="621" Date_Added="20121114000000"></file>
<file path="export/freexml.int/DE/15986149.xml" Product_ID="15986149" Updated="20121114144736" Quality="ICECAT" Supplier_id="24" Prod_ID="NX.C1UEB.001" Catid="151" On_Market="0" Model_Name="LE11-BZ-E1124G50Mn" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15986149-2702.jpg" HighPicSize="205805" HighPicWidth="786" HighPicHeight="621" Date_Added="20121114000000"></file>
<file path="export/freexml.int/DE/15986153.xml" Product_ID="15986153" Updated="20121114200420" Quality="ICECAT" Supplier_id="1935" Prod_ID="50203" Catid="194" On_Market="0" Model_Name="Arma" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15986153-3865.jpg" HighPicSize="1928713" HighPicWidth="2751" HighPicHeight="1897" Date_Added="20121114000000"></file>
<file path="export/freexml.int/DE/15986154.xml" Product_ID="15986154" Updated="20121114200048" Quality="ICECAT" Supplier_id="1935" Prod_ID="ARMAKB" Catid="194" On_Market="0" Model_Name="Arma" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15986154-7619.jpg" HighPicSize="1928713" HighPicWidth="2751" HighPicHeight="1897" Date_Added="20121114000000"></file>
<file path="export/freexml.int/DE/15986155.xml" Product_ID="15986155" Updated="20121114194744" Quality="ICECAT" Supplier_id="1935" Prod_ID="ARMAM" Catid="195" On_Market="0" Model_Name="Arma" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15986155-4238.jpg" HighPicSize="639005" HighPicWidth="2201" HighPicHeight="3265" Date_Added="20121114000000"></file>
<file path="export/freexml.int/DE/15986156.xml" Product_ID="15986156" Updated="20121114194735" Quality="ICECAT" Supplier_id="1935" Prod_ID="54577" Catid="195" On_Market="0" Model_Name="Arma" Product_View="0" HighPic="http://images.icecat.biz/img/norm/high/15986156-7292.jpg" HighPicSize="639005" HighPicWidth="2201" HighPicHeight="3265" Date_Added="20121114000000"></file> 
```

如您所见，每个数字都显示两次。我不明白这个问题-.-。我究竟做错了什么？

非常感谢你们的帮助！

// 编辑

好的，我这样修复它：

```
if ($xml->name == 'file' && $xml->nodeType == XMLReader::ELEMENT) 
```

谢谢您的帮助 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:41:01.390

在文档的评论中找到了这一点：

> 可能很明显，但不是每个人 ;-) ...从具有子节点的节点读取属性（并从该节点创建输出）时，输出将发出两次，一次在标签上，一次在结束标签。为避免这种情况，您可以测试您正在使用属性 nodeType 的节点的哪个部分。元素为 1，结束元素为 15。

[http://www.php.net/manual/en/xmlreader.getattribute.php](http://www.php.net/manual/en/xmlreader.getattribute.php)

您可以应用上述建议的解决方案或使用另一种算法来遍历节点，如下所示：http: [//www.w3schools.com/php/php_xml_simplexml.asp](http://www.w3schools.com/php/php_xml_simplexml.asp)

```
<?php
$xml = simplexml_load_file("test.xml");

echo $xml->getName() . "<br />";

foreach($xml->children() as $child)
  {
  echo $child->getName() . ": " . $child . "<br />";
  }
?> 
```

**更新** 使用评论中建议的解决方案修改了您的代码。

```
$xml = new XMLReader();

$xml->open($file);

while ($xml->read()) {
    if ($xml->name == 'file' && $xml->nodeType==XMLReader::ELEMENT)
        echo $xml->getAttribute ('Product_ID') . '<br />';
}

// close stream
$xml->close(); 
```

# twitter - 如何在推特上搜索关键词

> ID：13407431
> 
> 赞同：3
> 
> 时间：2012-11-15T22:33:25.407
> 
> 标签：twitter

我正在尝试构建一个服务，在持续监控的基础上为 Twitter 中的多个用户执行关键字搜索。似乎有 5 种不同的方法可以实现这一点——都有各自的缺点。我浏览了 Twitter 和 twitter4j 文档，找不到任何其他方法。

1.  使用 Twitter REST API 执行搜索 (https://dev.twitter.com/docs/api/1/get/search)。这个 API 是结果有限的：要求太多，你会受到限制。我确实必须跟踪阅读的最后一条推文，以免重复结果。需要一个计时器来轮询流。如果有多个搜索词，则进行多次调用很简单。

2.  搜索公共流方法 (https://dev.twitter.com/docs/streaming-apis/streams/public)。虽然这对于持续搜索非常有用，但 Twitter 仅允许每个帐户一个连接，并且可以将多少个术语传递到 Twitter。对于我的用例来说绝对不可能

3.  尝试使用用户流进行过滤。我这样做了，但发现很难快速确定一条推文是来自搜索还是来自用户流。此外，Twitter 表示他们将限制每个 IP 地址的用户流数量，因此这种方法无法扩展。（Twitter 一直在谈论一个叫做 SiteStreams 的东西，但它是一个非常有限的测试版，没有任何文档，所以我不能考虑）。

4.  转到从 Twitter 购买整个 firehose 的第三方（例如 Datasift）并在那里搜索 twitter 流。这变得昂贵 - 基本计划每月 3000 美元。24/7 全天候搜索单个单词的费用约为 45 美元/月）

我对社区的问题是“我是否已经用尽了所有可能性”？如果是，那么在我看来#1——使用带有计时器的 REST API 并跟踪最后一次找到的方法是正确的方法。有人不同意吗？如果是这样，您能否指出可以帮助我解决此问题的文档（或库）。

谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T13:19:19.913

我整理了一个很好的 JS fiddle，它可以回答你在处理 Twitter API 时的所有问题。该网络应用程序抓取热门地区，并允许您深入了解热门话题，然后查看其中的推文。

我还包括了一个标准的 Twitter 搜索提交框，所以以一种奇怪的方式，这是一个准系统 Tweetdeck 客户端供您检查。此外，为了推动新的 Jquery 库的适应，我使用了 1.91，它使用了新的 live.bind 点击事件语法。

享受

[http://jsfiddle.net/jdrefahl/5M3Gn/](http://jsfiddle.net/jdrefahl/5M3Gn/)

```
function searchTwitter(query) {
$.ajax({
    url: 'http://search.twitter.com/search.json?' + jQuery.param(query),
    dataType: 'jsonp',
    success: function (data) {
        var tweets = $('#tweets');
        tweets.html('');
        for (res in data['results']) {
            tweets.append('<div>' + data['results'][res]['from_user'] + ' wrote: <p>' + data['results'][res]['text'] + '</p></div><br />');
        }
    }
});
}

$(document).ready(function () {

function getTrendsByID(id) {
    $.ajax({
        url: 'http://api.twitter.com/1/trends/' + id + '.json',
        dataType: 'jsonp',
        success: function (data) {
            $.each(data[0].trends, function (i) {
            });
        }
    });
};

function getLocales() {
    $.ajax({
        url: 'https://api.twitter.com/1/trends/available.json',
        dataType: 'jsonp',
        success: function (data) {
            var locales = $('ul#locales');
            locales.html('');
            $.each(data, function (i) {
                localeID[i] = data[i].woeid;
                $('ul#locales').append('<li>' + data[i].name + '</li>');
            });
        }
    });

};

function getTrends(id) {
    $.ajax({
        url: 'https://api.twitter.com/1/trends/' + id + '.json',
        dataType: 'jsonp',
        success: function (data) {
            var trends = $('ul#currentTrends');
            trends.html('');
            $.each(data[0].trends, function (i) {
                $('ul#currentTrends').append('<li>' + data[0].trends[i].name + '</li>');
            });
        }
    });
};

// Event Handlers
$(document).on("click", "#locales li", function () {
    var $this = $(this);
    var localesHdr = $('#currentTrendsCont h3');
    var tweets = $('#tweets');
    var trendsHdr = $('#tweetsCont h3');
    trendsHdr.html('');
    tweets.html('');
    localesHdr.html('');
    $('#currentTrendsCont h3').html($this.text());
    getTrends(localeID[$this.index()]);
});

$(document).on("click", "#currentTrends li", function () {
    var $this = $(this);
    var trendsHdr = $('#tweetsCont h3');
    trendsHdr.html('');
    $('#tweetsCont h3').html($this.text());
    var params = {
        q: $this.text(),
        rpp: 10
    };
    searchTwitter(params);
});

$('#submit').click(function () {
    var trendsHdr = $('#tweetsCont h3');
    var trends = $('#currentTrends');
    var local = $('#currentTrendsCont h3');
    local.html('');
    trendsHdr.html('');
    trends.html('');
    $('#tweetsCont h3').html('search query: '+$('#query').val());
    var params = {
        q: $('#query').val(),
        rpp: 10
    };
    searchTwitter(params);
});

// Globals
var localeID = new Array();

// Init!
getLocales();

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T12:20:46.850

您希望搜索 twitter 的频率如何，可能的搜索量是多少（即有多少用户，每个用户有多少关键字）？

您是否还考虑过使用浏览器抓取工具？即让浏览器在与搜索结果保持同步的服务器上运行，并为该浏览器开发一个简单的插件来捕获数据并将其发布到您的数据库/将其发送到某个地方进行处理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T02:07:54.227

Twitter 的回应是使用#4——从 Datasift 等供应商处购买访问权限。

# linux - Matplotlib 在 linux 与 mswindows 中的绘图

> ID：13407432
> 
> 赞同：0
> 
> 时间：2012-11-15T22:33:28.210
> 
> 标签：linux, windows, plot, matplotlib

我试图在循环中生成一个图，每次迭代都会更新自己。在使用 python 2.6.6 的 linux 环境中工作我可以正常工作，但是当我在 Windows XP 中使用 python 2.7.3 运行相同的代码时，它会失败。为我产生此错误的最少代码是：

```
import matplotlib.pyplot as plt

plt.ion()
plt.figure(1)

for i in range(10):
   plt.clf()
   plt.plot(i,i**2,'bo')
   plt.axis([-1,10, -1, 90])
   plt.draw() 
```

在 linux 中，我看到一个沿着抛物线移动的蓝点。在 MSwindows 中，我首先得到一个空窗口，然后出现一个点在 (9,81) 的图。这看起来很简单，但也许我错过了一些小东西。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T17:25:52.727

我在这里找到了答案：[https ://stackoverflow.com/a/13601492/1738884](https://stackoverflow.com/a/13601492/1738884)

事实证明，在 Windows 中，我所需要的只是在`plt.pause(.01)`之后添加一个，`plt.draw()`并且我的情节根据需要更新了每次迭代。所以简化的工作代码如下所示：

```
import matplotlib.pyplot as plt

plt.ion()
plt.figure(1)

for i in range(10):
    plt.clf()
    plt.plot(i,i**2,'bo')
    plt.axis([-1,10, -1, 90])
    plt.draw()
    plt.pause(.01) 
```

# javascript - 使用 Javascript 操作传递变量

> ID：13407441
> 
> 赞同：0
> 
> 时间：2012-11-15T22:34:27.803
> 
> 标签：javascript, html, forms

如果有人可以提供帮助，将不胜感激！

我有一个 HTML 表单，其中包含您所在状态的下拉列表。

然后我有一个 JavaScript 函数来确定选择的状态，并相应地重定向用户。

```
 function pickstate()
{
        if(document.drop_list.State.value == "AR" ){
            document.drop_list.action = "www.theurl.com";
            document.drop_list.submit();
        }
} 
```

我的问题是：我可以使用此方法（如果可以，如何）将状态传递给下一个表单，以便当用户被重定向时，下拉菜单会显示他们选择的状态。

我知道如何使用 PHP 和 POST 来做到这一点，但这不是发布，它只是根据状态重定向到正确的 URL，并且由于 20 个左右的状态将使用相同的形式，我不想让用户再次选择他们的状态。

我使用这种方法的原因不是每个人都会被重定向——许多状态会停留在第一次显示的表单上。这就是我不能使用 POST 的原因。

帮助！谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:55:28.487

您可以将哈希添加到 URL

```
function pickstate()
{
    var stateVal = document.drop_list.State.value;
    switch(stateVal) {
      case "AR"
        document.drop_list.action = "www.theurl.com/#"+stateVal;
      break;
      case "IT"
        document.drop_list.action = "www.theurl.com/#"+stateVal;
      break;
    }

    document.drop_list.submit();
} 
```

然后下一个表单可以通过使用传递的哈希来选择状态

```
window.location.hash; // eg. will be equal to #AR or #IT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:44:54.257

您可以将值存储在本地存储中。

```
function pickState() {
    if (document.drop_list.State.value == "AR") {
        document.drop_list.action = "www.theurl.com";
        localStorage.setItem('selectedState', 'AR');
        document.drop_list.submit();
    }
} 
```

然后添加另一个设置值的函数。

```
function setState() {
    var storedSelectedState = localStorage.getItem('selectedState');

    if (storedSelectedState) {
        document.drop_list.State.value = storedSelectedState;
    }
} 
```

# batch-file - 带有批处理脚本的循环的变量问题

> ID：13407442
> 
> 赞同：0
> 
> 时间：2012-11-15T22:34:29.033
> 
> 标签：batch-file

使用移植的 Linux 命令 date，您可以从当前日期减去 X 天得到日期。我正在尝试循环 1-30 天来生成日期，然后在 findstr 中使用这些日期。似乎这些循环自己工作，但是当组合内部 for 循环不使用值 X 并且 date 不设置时。有谁知道我做错了什么？？？！

```
 for /L %%x in (1,1,%SEARCHDAYS%) DO (
    set date1=
    for /f "delims=" %%a in ('date.exe --date "Now -%%x days" +%%-m/%%-d/') do @set date1=%%a
    echo "%date1%"

    findstr /c:"%date1%" file.txt
    )
    ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:40:17.077

您是否尝试过 SETLOCAL ENABLEDELAYEDEXPANSION，然后使用“！” 围绕变量而不是“％”？

# grails - Grails 自动创建的表中的列大小

> ID：13407445
> 
> 赞同：0
> 
> 时间：2012-11-15T22:34:42.927
> 
> 标签：grails

如果已经回答了这个问题，我很抱歉没有看，因为我做了一些搜索但在这里找不到答案..

我今天刚开始阅读“Grails in Action”一书，并且正在测试第 1 章中的 Quote 应用程序。在某些时候，我们向域类添加约束以使内容列的大小为 1000（如果我理解正确的话）喜欢：

```
static constraints = {

    author(blank : false)
    **content(maxsize:1000, blank:false)**
} 
```

这是否意味着，该列将自动从 VARCHAR(255) 更改为 VARCHAR(1000)？如果是这样，是否会在重新启动应用程序后发生？因为对我来说似乎不是这样。请帮助我理解并感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:49:59.230

是的，maxSize 应该更改表的模式定义（注意：并非所有约束都这样做）。

尝试更改 DataSource.groovy 文件中的 dbCreate 属性。也许它被设置为更新并且 Grails 无法更改表，所以它必须完全重新创建它，因为你可以尝试使用`create`，但请记住，表将被删除，以便它可以拥有新的模式。

# iphone - 如何触发像相机应用程序一样的明亮闪光灯？

> ID：13407446
> 
> 赞同：2
> 
> 时间：2012-11-15T22:34:52.507
> 
> 标签：iphone, ios, flash, avcapturedevice, avcapture

我试图做一个闪光的方式是这样的：

1) 打电话

```
[device setTorchMode:AVCaptureTorchModeOn];
[device setFlashMode:AVCaptureFlashModeOn]; 
```

2）0.1秒后我打电话

```
[device setTorchMode:AVCaptureTorchModeOff];
[device setFlashMode:AVCaptureFlashModeOff]; 
```

问题是，当它发生时，闪光灯比相机应用程序中的闪光灯要暗得多。我不能让那个 LED 发光。有没有其他方法可以让这个闪光灯尽可能亮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T01:33:09.350

你可能想试试`setTorchModeOnWithLevel:error:`。将第一个参数设置为 1 应该可以为您提供最亮的闪光灯。

进一步的文档可以在[这里](http://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVCaptureDevice_Class/Reference/Reference.html#//apple_ref/occ/instm/AVCaptureDevice/setTorchModeOnWithLevel%3aerror%3a)找到。

# css - 无法正确将导航大小调整为 100% 高度

> ID：13407449
> 
> 赞同：1
> 
> 时间：2012-11-15T22:35:03.163
> 
> 标签：css, magento, height

我正在尝试使我的 magento 左侧导航与主容器的高度相同。

我已经进行了大量研究，但找不到适合我的解决方案。我有

*   将所有父 div 设置为 100%，但我最终会遇到一个损坏的主题并且不知道为什么。
*   将 html、body、wrapper、main... 设置为 100% 并且可以让导航正确拉伸，但它会将我的页脚向下推得很远。
*   尝试按照这篇[文章](https://stackoverflow.com/questions/10198604/left-navigation-wont-expand-to-100-magento)中的说明进行操作，但也无法让它为我工作，但它提出了一些问题。

这个人是如何在不将 html 设置为 100% 的情况下实现这一目标的？身体达到 100%，我认为这是必需的。

一些帮助和解释将不胜感激。网站是[www.theimagecollective.com](http://theimagecollective.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:51:42.197

我好奇

1.  你只是想把订阅块放在底部吗？
2.  从主容器的顶部到底部均匀分布导航？

左侧容器是该容器中显示内容的 100%。即使您扩展到主容器的相同 px 高度，它看起来也一样，除非您对左侧容器中的块的 css 执行某些操作。

# mongodb - 这是什么英文的mongodb行

> ID：13407452
> 
> 赞同：0
> 
> 时间：2012-11-15T22:35:17.880
> 
> 标签：mongodb

我是一个尝试学习mongodb的mongodb菜鸟......

我只是想了解这条线用英语说的是什么......

```
{ $project : { _id : { $substr : ["$_id",0,1] } } } 
```

有人可以翻译吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:40:47.963

它表示，在对通过此表达式投影的查询的响应中`_id`，每个对象的字段应该只替换为其实际值的第一个字符。它是聚合框架的一部分，在[此处](http://docs.mongodb.org/manual/reference/aggregation/#_S_project)记录。

# c++ - WIN32 多窗口

> ID：13407455
> 
> 赞同：2
> 
> 时间：2012-11-15T22:35:34.180
> 
> 标签：c++, winapi

我正在尝试显示 3 个窗口，但是它无法创建我不知道为什么的窗口 2。它创建了第一个窗口，我对其他两个窗口也做了同样的事情。

这是代码：

```
#include <Windows.h>

// Store handles to the main window and application instance globally.
HWND      ghMainWnd = 0;
HWND      ghSecdWnd = 0;
HWND      ghThrdWnd = 0;
HINSTANCE ghAppInst = 0;

//========================================================================================
// WINDOW 1
// Step 1: Define and implement the window procedure.
LRESULT CALLBACK
WndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{

    switch( msg )
    {
    // Handle left mouse button click message.
    case WM_LBUTTONDOWN:
        MessageBox(hWnd, "Left Mouse Button Click", "Message", MB_OK);
        return 0;

    // Handle key down message.
    case WM_KEYDOWN:
        if( wParam == VK_ESCAPE )
            if( MessageBox(hWnd, "Are you sure?", "Quit", MB_YESNO) == IDYES )
                DestroyWindow(ghMainWnd);
        return 0;

    // Handle destroy window message.
    case WM_DESTROY:
        PostQuitMessage(0);
        return 0;
    }

    // Forward any other messages we didn't handle to the default window procedure.
    return DefWindowProc(hWnd, msg, wParam, lParam);

}
//========================================================================================
// WINDOW 2
//========================================================================================
LRESULT CALLBACK
WndProc2(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{

    switch( msg )
    {
    // Handle down arrow pressed.
    case WM_KEYDOWN:
        if( wParam == VK_DOWN )
            MessageBox(hWnd, "Down arrow pressed 2.", "Information", MB_OK);
        return 0;
    case WM_LBUTTONDOWN:
        MessageBox(hWnd, "Window 2", "Window 2", MB_OK);
        return 0;
    case WM_DESTROY:
        PostQuitMessage(0);
        return 0;
    }

    return DefWindowProc(hWnd, msg, wParam, lParam);
}
//========================================================================================
// WINDOW 3
//========================================================================================
LRESULT CALLBACK
WndProc3(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{

    switch( msg )
    {
    // Handle down arrow pressed.
    case WM_KEYDOWN:
        if( wParam == VK_DOWN )
            MessageBox(hWnd, "Down arrow pressed 3.", "Information", MB_OK);
        return 0;
    case WM_LBUTTONDOWN:
        MessageBox(hWnd, "Window 3", "Window 3", MB_OK);
        return 0;
    case WM_DESTROY:
        PostQuitMessage(0);
        return 0;
    }

    return DefWindowProc(hWnd, msg, wParam, lParam);
}

// WinMain: Entry point for windows application.
int WINAPI
    WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, PSTR cmdLine, int showCmd)
{

    // Save handle to application instance.
    ghAppInst = hInstance;

    // Step 2: Fill out a WNDCLASS instance.
    WNDCLASS wc;
    wc.style         = CS_HREDRAW | CS_VREDRAW;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = ghAppInst;
    wc.hIcon         = ::LoadIcon(0, IDI_APPLICATION);
    wc.hCursor       = ::LoadCursor(0, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)::GetStockObject(WHITE_BRUSH);
    wc.lpszMenuName  = 0;
    wc.lpszClassName = "MyWndClassName";

    // Window 2
    WNDCLASS wc2;
    wc2.style         = CS_HREDRAW | CS_VREDRAW;
    wc2.lpfnWndProc   = WndProc2;
    wc2.cbClsExtra    = 0;
    wc2.cbWndExtra    = 0;
    wc2.hInstance     = ghAppInst;
    wc.hIcon          = ::LoadIcon(0, IDI_APPLICATION);
    wc2.hCursor       = ::LoadCursor(0, IDC_ARROW);
    wc2.hbrBackground = (HBRUSH)::GetStockObject(WHITE_BRUSH);
    wc2.lpszMenuName  = 0;
    wc2.lpszClassName = "MyWndClassTwo";

    // Window 3
    WNDCLASS wc3;
    wc3.style         = CS_HREDRAW | CS_VREDRAW;
    wc3.lpfnWndProc   = WndProc3;
    wc3.cbClsExtra    = 0;
    wc3.cbWndExtra    = 0;
    wc3.hInstance     = ghAppInst;
    wc3.hIcon         = ::LoadIcon(0, IDI_APPLICATION);
    wc3.hCursor       = ::LoadCursor(0, IDC_ARROW);
    wc3.lpszMenuName  = 0;
    wc3.lpszClassName = "MyWndClassThree";

    // Step 3: Register with WNDCLASS instance with windows.
    RegisterClass( &wc );
    RegisterClass( &wc2 );
    RegisterClass( &wc3 );

    // Step 4: Create the window, and save the handle in global window handle variable ghMainWnd.
    ghMainWnd = ::CreateWindow("MyWndClassName",  "Window 1", WS_OVERLAPPEDWINDOW | WS_HSCROLL | WS_VSCROLL, 0,   0,   500, 500, 0, 0, ghAppInst, 0);
    ghSecdWnd = ::CreateWindow("MyWndClassTwo",   "Window 2", WS_OVERLAPPEDWINDOW | WS_HSCROLL | WS_VSCROLL, 510, 0,   500, 500, 0, 0, ghAppInst, 0);
    ghThrdWnd = ::CreateWindow("MyWndClassThree", "Window 3", WS_OVERLAPPEDWINDOW | WS_HSCROLL | WS_VSCROLL, 0,   510, 500, 500, 0, 0, ghAppInst, 0);

    if( ghMainWnd == 0 )
    {
        ::MessageBox(0, "Create Window 1 - Failed", 0, 0);
        return false;
    }

    if( ghSecdWnd == 0 )
    {
        ::MessageBox(0, "Create Window 2 - Failed", 0, 0);
        return false;
    }

    if( ghThrdWnd == 0 )
    {
        ::MessageBox(0, "Create Window 3 - Failed", 0, 0);
        return false;
    }

    // Step 5: Show and update the window.
    ShowWindow(ghMainWnd, showCmd);
    UpdateWindow(ghMainWnd);

    ShowWindow(ghSecdWnd, showCmd);
    UpdateWindow(ghSecdWnd);

    ShowWindow(ghThrdWnd, showCmd);
    UpdateWindow(ghThrdWnd);

    // Step 6: Enter the message loop and don't quit until a WM_QUIT message is received.
    MSG msg;
    ZeroMemory(&msg, sizeof(MSG));

    while( GetMessage(&msg, 0, 0, 0) )
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }

    // Return exit code back to operating system.
    return (int)msg.wParam;

} 
```

它不会引发任何错误，但在 ghSecdWnd == 0 上会显示该错误消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T22:50:58.667

有两个问题：一个是您遇到的问题，另一个是窗口 3。

在创建第二个窗口之后（但在创建第三个窗口之前）调用`GetLastError()`会导致`"Cannot find the window class."`. 查看类设置，您已完成以下操作：

```
wc.hIcon = ::LoadIcon(0, IDI_APPLICATION); 
```

你真正需要的是设置`wc2`. 即使在注册第二个类时检查返回值也会`RegisterClass`导致错误`"The parameter is incorrect."`，表明`wc2`. 它也是代码中捕获错误的较早位置，这总是一件好事。

* * *

其次，第三个窗口有问题。你还没有设置背景画笔。将此行添加到`wc3`设置中：

```
wc3.hbrBackground = (HBRUSH)::GetStockObject(WHITE_BRUSH); 
```

* * *

您应该始终检查文档以了解功能失败时的功能并采取适当的措施。例如，如果`CreateWindow`失败，则返回值为`NULL`，您可以调用`GetLastError`以获取更多信息。您应该在每个功能的基础上执行此操作。这是 Window 2 的两个主要功能的示例。请记住，其他功能，例如`GetStockObject`，也可能会失败。

```
if (!RegisterClass(&wc2)) { //returns 0 if failed
    std::cout << "Failed to register class: ";
    std::cout << GetLastError() << '\n'; //or however you want to show it
}

if (!(ghSecdWnd = CreateWindow( /*...*/)) { //or ghSecdWnd = ...; if (!ghSecdWnd)
    std::cout << "Failed to create window: ";
    std::cout << GetLastError() << '\n'; //look at FormatMessage for a message
} 
```

首先，查看[`RegisterClass`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633586%28v=vs.85%29.aspx)，您会在**Return value**下看到它在失败时返回 0 并声明您可以调用`GetLastError()`扩展错误信息，因此我将其输出。[`CreateWindow`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632679%28v=vs.85%29.aspx)说的一样，但它是`NULL`因为`HWND`是一个指针。您可以获取获得的错误代码并对照 MSDN[**系统错误代码**](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681381%28v=vs.85%29.aspx)文章检查它们，或使用[`FormatMessage`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679351%28v=vs.85%29.aspx)with`FORMAT_MESSAGE_FROM_SYSTEM`为您执行此操作。

# css - 如果我不在我的自定义模板中使用标准的 joomla CSS 怎么办？

> ID：13407460
> 
> 赞同：1
> 
> 时间：2012-11-15T22:35:58.453
> 
> 标签：css, joomla, template-engine, templating

我想知道我应该使用这些代码行来包含标准的 Joomla CSS 规则吗？

```
<link rel="stylesheet" href="<?php echo $this->baseurl ?>/templates/system/css/system.css" type="text/css" />
<link rel="stylesheet" href="<?php echo $this->baseurl ?>/templates/system/css/general.css" type="text/css" /> 
```

我们知道，在这些行之后，我们当然会使用我们自己的模板特定 CSS 文件来覆盖一些规则，如下所示：

```
<link rel="stylesheet" href="<?php echo $this->baseurl ?>/templates/<?php echo $this->template; ?>/css/template.css" type="text/css" /> 
```

**重要提示：**假设我不想为每个人发布模板，我只会在我的特殊需要时使用它。**所以我会在需要的地方定义必要的规则。**

有了这个假设，我还应该包括前两个 CSS 吗？为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:40:57.623

如果您不需要样式，则没有理由包含样式表。可能发生的最糟糕的情况是您会看到一些损坏的格式，并且您必须在自己的 css 中修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:41:10.167

要为您的模板添加一个 css 文件，您可以将您提供的代码添加到模板文件夹中的 index.php 中，也可以使用 Joomla 嵌入 css 文件的方法，如下所示：

```
$doc = JFactory::getDocument();
$doc->addStyleSheet($this->baseurl.'/templates/yourtemplate/css/system.css');
$doc->addStyleSheet($this->baseurl.'/templates/yourtemplate/css/general.css'); 
```

# javascript - 如何在 jquery 动画中设置最大边距顶部？

> ID：13407465
> 
> 赞同：1
> 
> 时间：2012-11-15T22:36:10.613
> 
> 标签：javascript, jquery

我在 jQuery 中有以下代码，它为 div marginTop 设置动画。

如何设置它，以便一旦边距顶部等于 900px，禁用点击事件？

```
$("#tmbUp").click(function(){ 
$("#tmbHolder").animate({"marginTop": "-=100px"}, "slow");
});

$("#tmbDown").click(function(){
$("#tmbHolder").animate({"marginTop": "+=100px"}, "slow");
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:40:13.300

在调用该`animate`函数之前，只需检查上边距的当前值。如果是 900（或更少），请不要设置动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:43:01.017

该`animate`方法可以选择采用回调函数。

你想要做的是这样的：

```
$("#tmbDown").click (function (){ 
  $("#tmbHolder").animate (
    {"marginTop": "+=100px"}, 
    "slow",
    "swing",
    // The callback function
    function () {
      if ($(this).css ('marginTop') >= "900px") {
        $("#tmbDown").unbind ('click');
      }
    }
  );
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:51:29.263

我假设您只想在 marginTop >= 900 时禁用单击事件，并在/如果用户减少 marginTop 时再次启用它。我建议利用内置在 animate 函数中的回调函数。

```
$("#tmbUp").click(function(){ 
    $("#tmbHolder").animate({"marginTop": "-=100px"}, "slow", 
        function() {
            // if tmbHolder's marginTop < 900px, enable #tmbDown
        }
    );
});

$("#tmbDown").click(function(){
    $("#tmbHolder").animate({"marginTop": "+=100px"}, "slow", 
        function() {
            // if tmbHolder's marginTop >= 900px, disable #tmbDown
        }
    );
}); 
```

希望这对你有用。

# google-api - 如何使用 GTFS 列出与路线关联的所有站点？

> ID：13407468
> 
> 赞同：19
> 
> 时间：2012-11-15T22:36:16.817
> 
> 标签：google-api, gtfs

我正在处理一些[GTFS](https://developers.google.com/transit/gtfs/)数据，并希望能够创建与路线相关的所有站点的列表。我真的不明白如何处理 GTFS 数据。

Trips.txt 的格式如下：

`route_id,service_id,trip_id,trip_headsign,direction_id,block_id,shape_id 1,A20120610WKD,A20120610WKD_000800_1..S03R,SOUTH FERRY,1,,1..S03R 1,A20120610WKD,A20120610WKD_002700_1..S03R,SOUTH FERRY,1,,1..S03R 1,A20120610WKD,A20120610WKD_004700_1..S03R,SOUTH FERRY,1,,1..S03R 1,A20120610WKD,A20120610WKD_006700_1..S03R,SOUTH FERRY,1,,1..S03R 1,A20120610WKD,A20120610WKD_008700_1..S03R,SOUTH FERRY,1,,1..S03R`

我尝试使用 shape_id 读取匹配的形状，然后寻找具有匹配纬度和经度的停靠点，但这似乎并不可靠。有人知道怎么做这个吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-30T18:38:50.407

正如您所注意到的，GTFS 中的路线和停靠点之间没有直接关系。相反，停靠点与*行程*相关联，其中每次行程代表车辆沿特定路线的一次“运行”。这反映了这样一个事实，即一条路线不一定始终服务于它的每个站点——例如，在周末它可能会跳过高中以外的站点。

因此，获取路线服务的每个站点的列表需要结合几个模型：

*   `routes.txt`为您提供您感兴趣的路线的路线 ID。
*   `trips.txt`为您提供该路线的一组行程 ID。
*   `stop_times.txt`为您提供一组停靠点 ID，用于在每次旅行中服务的停靠点。
*   `stops.txt`为您提供有关每个站点的信息。

假设您使用 SQL 数据库来存储 GTFS 数据，您可能会使用这样的查询（一旦您获得了路由 ID）：

```
SELECT stop_id, stop_name FROM stops WHERE stop_id IN (
  SELECT DISTINCT stop_id FROM stop_times WHERE trip_id IN (
    SELECT trip_id FROM trips WHERE route_id = <route_id>)); 
```

但是请记住，这将为该路线*曾经*服务的每个站点输出一条记录。如果您正在为骑手生成时间表信息，您可能希望将查询限制为仅在今天运行的行程，并且仅在接下来的 30 分钟内出发的停止时间。

* * *

**更新：**我按照我的方式编写了上面的 SQL 查询，因为我觉得它最简单地说明了 GTFS 模型之间的关系，但是 btse 是正确的（在他下面的回答中），这样的查询实际上永远不会在生产中使用。它太慢了。您将改为使用表连接和索引来保持合理的查询时间。

这是一个等效的查询，以更适合复制和粘贴到实际应用程序的方式编写：

```
SELECT DISTINCT stops.stop_id, stops.stop_name
  FROM trips
  INNER JOIN stop_times ON stop_times.trip_id = trips.trip_id
  INNER JOIN stops ON stops.stop_id = stop_times.stop_id
  WHERE route_id = <route_id>; 
```

通常，您还会为`JOIN`or`WHERE`子句中使用的每一列创建一个索引，在这种情况下，这意味着：

```
CREATE INDEX stop_times_trip_id_index ON stop_times(trip_id);

CREATE INDEX trips_route_id_index ON trips(route_id); 
```

（请注意，RDBMS 通常通过主键自动为每个表建立索引，因此无需显式创建索引`stops.stop_id`。）

许多进一步的优化是可能的，这取决于所使用的特定 DBMS 以及您为性能牺牲磁盘空间的意愿。但是这些命令几乎可以在任何 RDBMS 上产生良好的性能，而不会不必要地牺牲清晰度。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-05T16:53:32.497

我在谷歌搜索中看到了这篇文章，我想我会用更好的答案更新它，以防其他人偶然发现它。Simon 给出的答案是 100% 正确的，但是，对于大型 GTFS 提要，他提供的查询相当慢。这是一个执行相同操作但执行速度***明显***更快的查询。

只是为了给你一些轶事证据，对于大约 50mb 的 GTFS 提要，Simon 的查询需要 10-25 秒才能完成。下面的语句始终花费 < 0.2 秒。

```
SELECT T3.stop_id, T3.stop_name 
FROM trips AS T1
JOIN
stop_times AS T2
ON T1.trip_id=T2.trip_id AND route_id = <routeid>
JOIN stops AS T3
ON T2.stop_id=T3.stop_id
GROUP BY T3.stop_id, T3.stop_name 
```

**更新：**

我意识到我之前没有提到这一点，但当然你会希望在每个表被连接的地方都有索引。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-15T20:51:58.467

如果您`GROUP BY shape_id`在从中选择时`trips`可以使查询更快。

使用@btse 的查询获取两条路线的唯一停靠点需要 1.147 秒。

我的等效查询需要 0.4 秒。

```
SELECT unique_stops.route_id, unique_stops.stop_id, stop_name, stop_desc, stop_lat, stop_lon
FROM
  stops,
  (SELECT stop_id, route_id
   FROM
     stop_times,
     (SELECT trip_id, route_id
      FROM trips
      WHERE route_id IN (801, 803)
      GROUP BY shape_id
     ) AS unique_trips
   WHERE stop_times.trip_id = unique_trips.trip_id
   GROUP BY stop_id) AS unique_stops
WHERE stops.stop_id = unique_stops.stop_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-23T00:34:31.447

如果您在 R 中工作，您可以执行此操作来查找停靠在目标目的地 X 的路线：

```
require(dplyr)

routesX <- routes %>%
  left_join(trips %>% select(trip_id, route_id, shape_id)) %>%
  left_join(stop_times %>% select(trip_id, stop_id)) %>%
  semi_join(stops %>% filter(grepl('X', stop_name, ignore.case = T)), by = c('stop_id' = 'stop_code')) %>%
  select(names(routes), shape_id) %>%
  unique 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-22T06:43:56.033

如果需要停止的方向，则应更改 Lukmaan 的答案：

```
SELECT unique_stops.route_id, unique_stops.stop_id, stop_name, stop_desc, stop_lat, stop_lon, unique_stops.direction_id
FROM
  stops,
  (SELECT stop_id, route_id, direction_id
   FROM
     stop_times,
     (SELECT trip_id, route_id, direction_id
      FROM trips
      WHERE route_id IN (801, 803)
      GROUP BY direction_id
     ) AS unique_trips
   WHERE stop_times.trip_id = unique_trips.id
   GROUP BY stop_id, direction_id) AS unique_stops
WHERE stops.stop_id = unique_stops.stop_id 
```

如果您也`stop_times.stop_sequence`以相同的方式添加，并按方向和 stop_sequence 排序，则停靠点将按照行程中的顺序进行排序。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-09-12T14:30:05.953

如果你使用“onebusaway”，有一种快速的方法可以做到这一点，而无需接触 GTFS

假设您想知道纽约市曼哈顿巴士路线“M1”的巴士站

[http://bustime.mta.info/api/where/stops-for-route/MTA%20NYCT_M1.json?key=yourapikey&includePolylines=false&version=2](http://bustime.mta.info/api/where/stops-for-route/MTA%20NYCT_M1.json?key=yourapikey&includePolylines=false&version=2)

将为您提供 json 提要，然后您可以提取路线 M1 上双向的巴士站。

# image-processing - 我怎样才能得到一个完整的中间轴线，它的垂直线穿过它？

> ID：13407470
> 
> 赞同：2
> 
> 时间：2012-11-15T22:36:27.830
> 
> 标签：image-processing, opencv, computer-vision, scipy, scikit-image

我有一个图像，我想获得穿过其中轴的像素。我尝试使用*骨架*化和*中轴*方法来获取它们，但是这两种方法都返回比相应对象短的一维线。

这是带有示例图像的代码：-

```
>>> import skimage.filter  
>>> import skimage.morphology  
>>> import numpy as np  
>>> import scipy.misc
>>> im=scipy.misc.imread('img.jpg')   
>>> thr=skimage.filter.threshold_otsu(im)  
>>> im=im > thr # Threshold the image  
>>> im_sk=skimage.morphology.skeletonize(im)  
>>> mask=np.where(im_sk==1)     # pixels of skeleton  
>>> im[mask]= 0                 # this will color the skeleton with black 
```

原文>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 结果
[or_im http://imageshack.us/a/img23/9035/testwus .jpg](http://imageshack.us/a/img23/9035/testwus.jpg) [sk_im http://imageshack.us/a/img585/1910/imgskx.jpg](http://imageshack.us/a/img585/1910/imgskx.jpg)

如您所见，黑线未连接到形状的尖端。
(1) 如何获得代表图像中形状长度的全连接一维中轴线。
（2）如何获得垂直于中轴的像素（因为我想从一侧到另一侧绘制垂直线穿过形状的中轴）

*   我需要任何可以做这些事情的python库。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:57:07.060

我认为你的问题有点不当。你有两个问题，但我会回答第二个问题。

您想绘制垂直于中轴的线。问题在于中轴不一定是一条线，它通常是弯曲的。

您最好的选择是从中间轴上取 2 个彼此靠近的样本点。这两点定义了一条线。然后，您可以计算这两个点的垂直平分线。

# ios - 身份 iPhone 开发者不匹配任何有效的、未过期的证书

> ID：13407472
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:36:43.653
> 
> 标签：ios, ipad, certificate, bundle, provisioning

当我尝试为 iPad 构建时，我遇到了上述错误。还有另一个错误。我有我的个人 mac 和办公室 mac。当我尝试做这个项目时，我开始在我的个人机器上做它。所以我的代码运行顺畅，为 iPad 构建。我可以看到应用程序在 ipad 上运行。因此，我创建了一个开发人员临时证书，并针对上述情况在 ipad 上进行了测试。现在 2 天后，我也创建了一个分发证书。我将我的项目从我的个人 Mac 复制到办公室 Mac 并连接了同一个 ipad。所以我现在进入 Xcode->Organizer->Provisioning 配置文件并查看状态“未找到有效签名身份”。当我第一次连接时，它只有一个具有该状态的临时证书。我刷新了配置文件并要求提供我的凭据。我这样做了。然后它将我今天早上创建的分发配置文件添加到列表中。这也具有“未找到有效签名身份”的状态。然后我收到此错误消息“没有为参数'appIdName'提供值。我是应用程序开发的新手。这实际上是我的第一个应用程序。也在构建时iPad的项目我得到了标题中提到的错误。我在.plist文件中更改了“捆绑标识符”以完全匹配它在我的项目中所说的。没有错字问题，我交叉检查了。在同一个.plist中文件中要设置的“捆绑显示名称”、“可执行名称”和“捆绑名称”是什么？现在我在我的两个 Mac 上都将它们视为 ${product..} 等。我必须注意它，我可以将应用程序从我的办公室机器和个人机器加载到 ipad 上。我必须获得两个证书吗？下载它们，为两台不同的机器安装它们？如果有人能详细解释一下，那就太好了。谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:09:16.407

如果您希望在不更改配置的情况下将 iOS 项目复制到第二台 Mac，您还需要从第一台 Mac 上的钥匙串中复制所有证书及其私钥，然后使用复制或重新下载任何配置文件您在第一台 Mac 上使用的相同开发者帐户。将开发人员/分发证书重新下载到第二台 Mac 通常不会起作用，因为私钥会丢失。因此，您必须从原始 Mac 复制它们。

# spring - 按需加载 Spring 上下文

> ID：13407476
> 
> 赞同：0
> 
> 时间：2012-11-15T22:37:00.633
> 
> 标签：spring, jakarta-ee

是否可以仅按需加载弹簧应用程序上下文？场景如下：我有一个带有设置页面的 Web 应用程序，供用户输入数据库属性。这些存储在属性文件中，并在设置后重新启动时与弹簧 PropertyPlaceHolderConfigurer 一起加载到 application-context.xml 中。

但是，如果我没有初始的有效数据库信息，spring 将无法启动。因此，设置页面不会显示。有什么干净的方法可以防止上下文被加载吗？

我想到的一个解决方案是删除 web.xml 中的上下文侦听器并在设置后将其写回，但是这与其说是一个干净的解决方案，不如说是一个令人讨厌的 hack。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:45:48.260

只是...不要启动它。我猜你是从`web.xml`. 不要放在`ContextLoaderListener`那里（或者放一些最小的上下文来勉强显示设置页面）。

不幸的是，一旦设置结束，您就可以开始（和停止）Spring 上下文了。这很简单，您可以从代码中启动 Spring，例如使用[`ClassPathXmlApplicationContext`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/context/support/ClassPathXmlApplicationContext.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:18:26.950

在考虑了一段时间之后，我将采用以下方法：

不理会 web.xml，只需将 spring 类替换为委托给它们的客户端。所以在我的情况下，这将是一个

```
protected class OnDemandContextLoaderListener extends ContextLoaderListener {
  @Override
  public void contextInitialized(ServletContextEvent event) {
      // some logic to find out if properly setup
      // if so:
      super.contextInitialized(event):
  }
...
} 
```

也应该与 DispatcherServlet 一起使用。

# php - ODBC 和 SQL Server 2008：不能使用准备好的语句？

> ID：13407477
> 
> 赞同：1
> 
> 时间：2012-11-15T22:37:19.877
> 
> 标签：php, sql-server-2008, pdo, odbc

好的，所以我**不能**让它工作（或者）：

```
$stmt = odbc_prepare($conn, "SELECT * FROM Users WHERE username=?");
odbc_execute($stmt, array($username));
$user = odbc_fetch_object($stmt);

$stmt = $pdo->prepare("SELECT * FROM Users WHERE username=?");
$stmt->execut(array($username));
$user = $stmt->fetchObject(); 
```

两者都返回相同的错误：

> 警告：odbc_execute(): SQL 错误：无法获取错误消息，SQL 状态 HY000 在 user.php 中的 SQLExecute 中的第 24 行

任何人都知道是否有可能解决这个问题，或者是否准备好声明？如果是这样，应该如何防范 SQL 注入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:18:34.010

我从不使用 fetchObject 方法，但是这个怎么样：

```
$stmt = $pdo->prepare("SELECT * FROM Users WHERE username=?");
$stmt->bindValue(1, $username);
try{
    $stmt->execute();
    while ($row = $stmt->fetch()){
       // Do whatever.
    }
}catch(PDOException $e){
    echo($e->getMessage());
} 
```

我还注意到你的问号（'？'）周围的单引号，它们不应该在那里。

为了使用 try/catch 的东西，你需要在创建 PDO 连接时包含它：

```
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

您可能还想添加以下内容：

```
$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE); // Try to use the driver's native prepared statements. 
```

# build-system - 将大型软件项目移植到 tup 构建系统的技巧

> ID：13407478
> 
> 赞同：3
> 
> 时间：2012-11-15T22:37:42.900
> 
> 标签：build-system, tup

将具有数千个 .cpp 文件和相关标头的软件项目移植到 tup 构建系统的最佳方式是什么？

如果树看起来像：

```
colors/                                                                            
 primaries/
  red.cpp 
  green.cpp
  blue.cpp
 fruity/
  orange.cpp
  grape.cpp
 grayscale/
  white.cpp
  gray.cpp
  black.cpp
some/annoying/nesting/animals/
    horse.cpp
    bear.cpp 
```

对于每个类别中包含数十个目标文件的数十个类别，编写一次性使用 shell 脚本来转储每个目录中的 Tupfile 确实似乎是一个相当不雅的解决方案，即使由于共享 Tuprules.tup 它们大部分相似. 什么是正确的，“最佳实践”，希望可移植的方式来使用 tup 构建这样的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-14T11:57:05.170

随着最近添加的（仍然没有很好地记录）LUA 解析器，您可以避免每个目录有一个 Tupfile。看看这里[http://gittup.org/tup/lua_parser.html](http://gittup.org/tup/lua_parser.html)了解 Tupdefault.lua

此外 - 通过最近允许在不同文件夹中输出文件的更改，您可以进一步简化它。您可以在“某处”编译文件，将它们添加到全局组，然后 - 当您需要它时，将它们全部链接/存档。

简单的 Tuprules.tup：

```
TOP = $(TUP_CWD)
!cc = |> gcc $(CFLAGS) -c %f -o %o |> %B.o $(TOP)/<objects> 
```

仅用于编译的简单 Tupfile（通用的，无需修改标志或某事）：

```
include_rules

: foreach *.c |> !cc |> 
```

用于编译和最终链接的简单 Tupfile（如上注释）：

```
include_rules

: foreach *.c |> !cc |>
: $(TOP)/<objects> |> gcc %<objects> -o %o |> application.exe 
```

不幸的是，我（还）不知道如何将这个特定功能（全局组）与 LUA 解析器一起使用。我什至在 tup-users 邮件列表上问过这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:43:45.400

在 tup 手册页中，tup 支持运行外部 shell 脚本：

```
 run ./script args
          Runs an external script with the given arguments to generate
          :-rules. This is an advanced feature that can be used when the
          standard Tupfile syntax is too simplistic for a complex program.
          The script is expected to write the :-rules to stdout. No other
          Tupfile commands are allowed - for example, the script cannot
          create $-variables or !-macros, but it can output :-rules that use
          those features. As a simple example, consider if a command must be
          executed 5 times, but there are no input files to use tup's
          foreach keyword. An external script called 'build.sh' could be
          written as follows: 
```

您可以触发一个脚本来生成必要的 tup 规则，但我认为这不是可移植的，因为您依赖于 shell。

# linux - 重建 yum 仓库

> ID：13407481
> 
> 赞同：5
> 
> 时间：2012-11-15T22:38:08.823
> 
> 标签：linux, amazon-s3, yum

我们在 Amazon S3 上有一个私有仓库。我没有设置所以我不知道它是如何完成的。现在我需要向它添加一些新包，但它们没有被识别。我假设这是因为 repo 将文件列表保留在 repodata 文件夹中。我该如何重建它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:50:01.963

使用该`createrepo`命令构建和/或更新存储库元数据。

# youtube - 尽管 API 元数据另有说明，但 YouTube 嵌入会出现“限制在某些网站上播放”错误

> ID：13407482
> 
> 赞同：12
> 
> 时间：2012-11-15T22:38:11.153
> 
> 标签：youtube, youtube-api

我试图让我的客户端应用程序过滤掉不允许嵌入的视频。我的理解是没有办法限制提要（即 format=5 是不够的）来做到这一点，我必须自己检查条目的属性，`<yt:accessControl>`标签和`<app:control>`and`<yt:state>`标签。

这对我不起作用。

例如这个视频： [https ://www.youtube.com/watch?v=waxat-_tRH8](https://www.youtube.com/watch?v=waxat-_tRH8)

不嵌入： https: [//www.youtube.com/embed/waxat-_tRH8](https://www.youtube.com/embed/waxat-_tRH8)

即使 API 返回的数据表明（据我所知）它应该能够嵌入： [https ://gdata.youtube.com/feeds/api/videos/waxat-_tRH8?v=2](https://gdata.youtube.com/feeds/api/videos/waxat-_tRH8?v=2)

该条目不包含任何`<yt:noembed>`标签[（请参阅先前的问题）](https://stackoverflow.com/questions/3899387/how-do-i-use-the-youtube-api-to-check-if-a-video-is-embeddable)，并且`<media:restriction type='country' relationship='deny'>ME DE RS</media:restriction>`由于我在美国[（请参阅先前的问题）](https://stackoverflow.com/questions/6605664/from-a-youtube-data-api-search-result-feed-how-can-i-determine-if-a-video-will) [（请](https://stackoverflow.com/questions/5184003/youtube-api-api-says-it-is-embeddable-and-not-blocked-but-when-it-is-embedded-i)参阅先前的问题），因此无法解释这一点。

我在这里想念什么？

编辑：上面的嵌入链接在我的网络浏览器中有效，但在我的客户端应用程序的 WebView 中无效......！？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T22:15:41.613

某些视频应用了域级白名单或黑名单。这是由内容所有者自行决定的。

如果存在白名单或黑名单，并且无法确定嵌入站点的域（可能是因为在您的本机应用程序中没有真正的引用域），则默认行为是阻止播放。

这篇博文也有更多细节：http: [//youtube-eng.blogspot.co.uk/2011/12/understanding-playback-restrictions_28.html](http://youtube-eng.blogspot.co.uk/2011/12/understanding-playback-restrictions_28.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-09-22T22:56:03.653

正如[Jeff Posnick 指出的那样](https://stackoverflow.com/a/13463245/4976373)，一些视频有黑名单。如果您尝试从应用程序而不是网页请求带有黑名单的视频，您将看到以下错误消息：

> “此视频包含来自 ___ 的内容。它被限制在某些网站上播放。”

很可能您的应用没有被列入黑名单，并且您被错误地列入黑名单。要解决这个问题，您需要为您的 Youtube API 请求提供一个来源（正如[atulkhatri 指出的那样](https://stackoverflow.com/a/36384403/4976373)）。

**在 Youtube 视频的请求标头中，设置`Referer`为您打算从中拨打电话**的域，（例如，您的应用对应网站的域）。如果您没有域，则可以轻松编写其他域，这也可能有效。

*   [对于 Android (Java)，您可以在此处](https://stackoverflow.com/a/36952048/4976373)查看示例。

*   对于 iOS，[请看上面](https://stackoverflow.com/a/35568163/4976373)

*   对于 React Native，您可以`origin`将组件上的 prop 用于您的域（在文档`origin`中[提到](https://github.com/inProgress-team/react-native-youtube)但没有告诉您太多相关信息）。

*   [这是浏览器中相同问题的另一个示例](https://www.davidtan.org/embedded-youtube-videos-restricted-playback-on-certain-sites-when-no-http-referrer-sent/)，当时扩展程序阻止了`Referer`标头的发送。

这个答案适用于 Youtube 的 V3 API。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-23T03:17:55.970

实际上，如果您在此处嵌入视频：

[http://www.w3schools.com/html/tryit.asp?filename=tryhtml_default](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_default)

像这样：

```
<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
</head>
<body>
<iframe width="420" height="315" src="https://www.youtube.com/embed/waxat-_tRH8" frameborder="0" allowfullscreen></iframe>
</body>
</html> 
```

其实是可以玩的。所以问题实际上又回到了为什么它可以在网站上运行而不是在 iOS 移动应用上运行？

然后我发现了这个帖子：

[http://support.metacn.com/hc/en-us/articles/204513985-Video-Player-Embed-Restriction](http://support.metacdn.com/hc/en-us/articles/204513985-Video-Player-Embed-Restriction)

它解释说，由于缺少 HTTP 标头“Referer”字段，嵌入可能会受到限制。

所以在设置了refer字段后，这个视频将在iOS应用程序中播放：

```
let youtubeURL = NSURL(string: "https://www.youtube.com/embed/YQHsXMglC9A?autoplay=1") 
let youtubeRequest = NSMutableURLRequest(URL: youtubeURL!) 
youtubeRequest.setValue("https://www.youtube.com", forHTTPHeaderField: "Referer") 
webView.loadRequest(youtubeRequest) 
```

瓦拉，它现在可以工作了！

你快乐吗？因为我很开心。:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-03T10:38:35.430

你可以使用这个答案。这在我的情况下非常有效 -

添加为`origin`_`player vars``https://www.youtube.com`

[看到这个答案](https://stackoverflow.com/a/36384383/2082569)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-03T22:57:24.123

对于那些在 Android 上的 webView 中遇到同样问题的人。我通过添加与@RainCast 在她的回答中所做的类似的引用标题字段来解决此问题。

```
 Map<String, String> extraHeaders = new HashMap<>();
 extraHeaders.put("Referer", "http://youtube.com");
 String url = "https://www.youtube.com/embed/dQw4w9WgXcQ";

 webView.loadUrl(url, extraHeaders); 
```

它适用于纯 URL，但我不知道如何在 webView 中注入 iFrame 时传递这些参数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-31T11:14:38.490

在初始化 youtube sdk 时添加播放器变量：

```
NSDictionary *playerVars = @{
                             @"origin" : @"http://www.youtube.com",
                             };
[self.playerView loadWithVideoId:@"videoid" playerVars:playerVars]; 
```

享受！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-11-30T05:30:58.990

试试这样

```
<iframe width="300" height="200" src="www.youtube.com/embed/<video-id>?enablejsapi=1" frameborder="0" allowfullscreen></iframe> 
```

# javascript - 画布中的 textBaseline 是如何工作的？

> ID：13407483
> 
> 赞同：0
> 
> 时间：2012-11-15T22:38:15.927
> 
> 标签：javascript, html, text, canvas

我有这个简单的代码：[http](http://codepen.io/hypertornado/pen/rIbsH) ://codepen.io/hypertornado/pen/rIbsH在画布上绘制了两行文本。怎么可能，顶部画布边框和第一行的第一个字母 (█) 之间有一个空白空间，而每行的第一个字母之间没有空白空间？

```
canvas = window.document.getElementById("canvas")
context = canvas.getContext('2d')
context.fillStyle = "rgba(100,150, 0,1)"
context.textBaseline = 'alphabetic'
context.font = "30px Arial"
context.fillText("█hello", 0, 30)
context.fillText("█hello", 0, 60) 
```

在 Mac OS X 上的 Google Chrome 上测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:44:38.937

尝试将 textBaseline 更改为底部

```
context.textBaseline = 'bottom' 
```

更多信息在这里：

[https://developer.mozilla.org/en/docs/Drawing_text_using_a_canvas](https://developer.mozilla.org/en/docs/Drawing_text_using_a_canvas)

# python - Python - 将函数调用拆分为函数和参数

> ID：13407484
> 
> 赞同：1
> 
> 时间：2012-11-15T22:38:25.880
> 
> 标签：python, arguments, function-call

在 Python 中是否可以将函数调用拆分为函数及其参数列表？例如，`func(1,4,True)`把它变成`[func, 1, 4, True]`或类似的东西。理想情况下，我想为任意函数执行此操作。

编辑：我是编程课程的助教，目的是检查学生在他们的代码中包含哪些测试用例。我想看看学生用什么值来调用他们的代码，以确保他们正确地测试它。我们让学生在编写测试时使用比较函数（他们从模块中导入），所以我希望编辑比较函数以检查他们包含了哪些测试用例。

我对如何实现相同的最终结果有一些其他想法（例如以文本形式读取代码或将学生代码复制到具有不同定义的新文件中`func`），但两者都涉及更多工作并且需要更多比重新定义比较函数更容易出现问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:42:45.403

您的问题的直接答案是*否定*的，因为函数*调用*不是一个对象，而是一个语句。

要获取有关任何函数的信息，例如其名称、参数等，您可以使用附加到每个函数的一些属性和方法：

```
>>> def foo(a,b):
...    print a,b
... 
>>> foo.func_name
'foo'
>>> foo.func_code.co_varnames
('a', 'b') 
```

打字`dir(funcname)`会给你更多的东西去探索。

如果您想知道一个函数是如何工作的，在调用时如何分配参数，以及其他此类调查性故障排除 - 有[`inspect`模块](http://docs.python.org/2/library/inspect.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T23:33:47.100

如何定义一个装饰器：

```
def func_call_decorator(func):
    def _wrapper(*args, **kwargs):
        ret = func(*args, **kwargs)
        return [func]+list(args)+kwargs.items() + [ret]
    return _wrapper

@func_call_decorator
def foo(a,b):
    return a+b

print foo(2,3) 
```

产生：

```
[<function foo at 0x10045f5f0>, 2, 3, 5] 
```

我还附加了给定参数的函数返回值作为列表的最后一个元素。

我想知道你的用例是什么...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:44:10.857

```
call = [func, 1, 4, True]
f,args = call[0],call[1:]
result = f(*args) 
```

# asp.net - 无法制作 Facebook C# SDK for ASP.NET 入门教程

> ID：13407488
> 
> 赞同：1
> 
> 时间：2012-11-15T22:38:48.577
> 
> 标签：asp.net, facebook, login, facebook-c#-sdk

我正在尝试运行本教程[http://csharpsdk.org/docs/web/getting-started](http://csharpsdk.org/docs/web/getting-started) 并尝试在我的网站上进行 facebook 登录，但我无法运行教程中的最后一步，它给了我：系统。 NullReferenceException：对象引用未设置为对象的实例。for var accessToken = Session["AccessToken"].ToString(); 这是我所有的javascript

```
 window.fbAsyncInit = function () {
        FB.init({
            appId: '112249508938212', // App ID
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            xfbml: true  // parse XFBML
        });

        // Additional initialization code here
        FB.Event.subscribe('auth.authResponseChange', function (response) {
            if (response.status === 'connected') {
                // the user is logged in and has authenticated your
                // app, and response.authResponse supplies
                // the user's ID, a valid access token, a signed
                // request, and the time the access token 
                // and signed request each expire
                var uid = response.authResponse.userID;
                var accessToken = response.authResponse.accessToken;

                // TODO: Handle the access token
                // Do a post to the server to finish the logon
                // This is a form post since we don't want to use AJAX
                var form = document.createElement("form");
                form.setAttribute("method", 'post');
                form.setAttribute("action", '/FacebookLogin.ashx');

                var field = document.createElement("input");
                field.setAttribute("type", "hidden");
                field.setAttribute("name", 'accessToken');
                field.setAttribute("value", accessToken);
                form.appendChild(field);

                document.body.appendChild(form);
                form.submit();
            } else if (response.status === 'not_authorized') {
                // the user is logged in to Facebook, 
                // but has not authenticated your app
            } else {
                // the user isn't logged in to Facebook.
            }
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    }(document)); 
```

我也有 FacebookLogin.ashx 文件，其中包含网站提供的内容。

# ruby-on-rails - 如何将参数传递给 LEFT JOIN？

> ID：13407489
> 
> 赞同：13
> 
> 时间：2012-11-15T22:38:59.813
> 
> 标签：ruby-on-rails, ruby

** 为更好理解而编辑 **

** 编辑重命名为 Document **

我想获取给定用户的所有带有投票记录的用户文档记录，如果该用户没有为某些文档记录投票，我仍然希望获得所有没有投票的文档记录。例如：

```
+------------+--------------+------+
|document.par1|document.par2| vote |
+------------+--------------+------+
|    2       | z            | y    |
|    3       | w            | NULL |
|    4       | x            | NULL |
+------------+--------------+------+ 
```

如果我尝试这个，在 Ruby on Rails 上：

一、首先尝试：

```
Document.
   joins("LEFT JOIN `votes` ON `votes`.`v_id` = `document`.`id` AND `votes`.`giver_id` = ?", user_id).
   where('document.creator_id = ?', user_id, .....).
   select('votes.*', `document.param1') 
```

我收到了这个错误：

```
RuntimeError in UserDocumentsController#show

unknown class: Fixnum 
```

二、第二次尝试：

```
Document.
   joins("LEFT JOIN `votes` ON `votes`.`v_id` = `document`.`id`").
   where('document.creator_id = ? AND `votes`.`giver_id` = ?', user_id, user_id, .....).
   select('votes.*', `document.param1') 
```

仅返回有投票的记录：

```
+-------------+-------------+------+
|document.par1|document.par2| vote |
+-------------+-------------+------+
|    2        | z           | y    |
+-------------+-------------+------+ 
```

**所以缺少2条记录..**

** 已更新，此解决方案有效 **

三、我的第三次尝试，感谢Mischa的帮助：

```
Document.
   joins("LEFT JOIN `votes` ON `votes`.`v_id` = `document`.`id`").
   where('document.creator_id = ? AND (`votes`.`giver_id` = ? OR  `votes`.`giver_id` IS NULL)', user_id, user_id).
   select('votes.*', `document.param1')

+-------------+-------------+------+
|document.par1|document.par2| vote |
+-------------+-------------+------+
|    2        | z           | y    |
|    3        | w           | NULL |
|    4        | x           | NULL |
+-------------+-------------+------+ 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-16T09:31:42.680

这将为您提供所需的结果集：

```
Document.
   joins("LEFT JOIN `votes` ON `votes`.`v_id` = `document`.`id`").
   where('document.creator_id = ? AND (`votes`.`giver_id` = ? OR  `votes`.`giver_id` IS NULL)', user_id, user_id).
   select('votes.*', `document.param1') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:31:52.550

条件子句不应出现在`joins`.

这应该有效：

```
Myclass.
  joins("LEFT JOIN `votes` ON `votes`.`v_id` = `myclass`.`id`").
  where('myclass.creator_id = ? AND `votes`.`giver_id` = ?', user_id, user_id, .....).
  select('votes.*', `myclass.param1') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-08T17:43:57.583

我遇到了同样的问题，但它似乎不起作用，我找到了一种解决此问题的方法，方法是声明一个字符串变量并将“ON”条件传递给该字符串并在 SQL 命令中引用它。

例如：`on_condition = "(votes.giver_id ="+user_id+")"`

命令是：

`Myclass.joins("LEFT JOIN votes).on(on_condition).where('myclass.creator_id = ?', user_id).select('votes.*', myclass.param1)`

# perl - perl 用户登录然后打印他们的薪水数据

> ID：13407491
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:39:14.177
> 
> 标签：perl, login, payment, accounting

我正在处理一项任务，如果他们成功登录，我必须让用户登录（检查他们的用户名/密码对文件），然后我需要打印他们的薪水数据，该数据存储在另一个名为 IN-accounting.data 的文件中。我设法让用户登录部分工作，但我无法打印“薪水”部分，因为它现在将打印会计文件中的每个人我可以使用一些帮助来弄清楚如何只打印数据用户登录有什么建议吗？这些文件和代码中的所有 ssn、电话号码、地址和人员都是假的，它们只是为完成任务而提供的数据

* * *

11-6-12 更新以反映建议的更改，它现在以我最初想要的方式运行

* * *

```
#!/usr/bin/perl
use warnings;
use strict;
use Digest::MD5 'md5_hex';

open (PSWD, '<', 'password.passwd');
#getting username and password
#converting username to lowercase if username is entered in CAPS
print "Please enter your username: ";
chomp(my $userN = <STDIN>);
my $username = lc($userN);
############################################
print "Please enter your password: ";
chomp(my $password = <STDIN>);
my $passwd=md5_hex($password);
###############################################
my $matchCount = 0;#used later to make sure username and password match file
#reading password.passwd and assigning values
while (my $lines = <PSWD>){
my($user,$pswd,$userID,$groupID,$info,$home,$shell) = split ':', $lines;

#checking username entered vs that in the passwd file
if ($username eq $user){
print "Checking username... MATCH\n";
$username=$info;
#keeps track if username matches or not
$matchCount+=1;

#checking password entered vs that in the passwd file
if ($passwd eq $pswd){
    print "Checking password... MATCH\n";
        my ($first,$last)=split(" ", $info);
        accounting($first,$last);
}
else{
        print "Password does not match!\n";
    }
    last;

}
}

# if matchcount did not change, username did not match killing the program
if ($matchCount == 0){
    die ("\"$username\" does not match any users in our database!\n");
}

sub accounting{
   my $first_name=shift;
   my $last_name=shift;
   open(my $fh, '<', 'IN-accounting.data') or die "cannot open accounting file $!";
    while (my $lines = <$fh>){
    chomp $lines;
        my @fields = split(/\|/, $lines);

        push @data2, \@fields;

    my($Lname,$Fname,$ssn,$address)=($fields[0],$fields[1],$fields[2],$fields[3]);
        my($city,$state,$zip,$payDate)=($fields[4],$fields[5],$fields[6],$fields[7]);
        my($hours,$rate,$taxes,$deductions,$notes)= ($fields[8],$fields[9],$fields[10],$fields[11],$fields[12]);

        next if $Lname ne $last_name and $Fname ne $first_name;

    my ($Gpay)= eval($hours)*eval($rate);#gross pay
    my ($Tpay)=$Gpay-($taxes+$deductions);#total pay
    my $Essn=substr($ssn,+-4);#edited ssn
    print "$Fname $Lname\n";
    print "$address\n";
    print "$city $state $zip\n";
    print "SSN: xxx-xx-$Essn\n";
    print"\n";
    print "Pay Date: $payDate";
    print"\n";
    print"You had $hours hours at \$$rate/hour\n";
    print"Gross Pay: $Gpay\n";
    print"Taxes:\$-$taxes\n";
    print"Deductions:\$-$deductions\n";
    print"Total Pay: $Tpay\n";
    print"\n";
    print"Notes:$notes\n\n";

}
print"press enter to quit: ";
       my $quit=<>;     
       if ($quit){ exit;}
} 
```

密码.passwd

amon9640：4cb9c8a8048fd02294477fcb1a41191a：500：25：亚历山大周一：/首页/工资：/斌/工资iart1373：4cb9c8a8048fd02294477fcb1a41191a：501：25：伊尼戈Arterbury：/首页/工资：/斌/工资wher0210：4cb9c8a8048fd02294477fcb1a41191a：502：25：沃德尔赫尔曼:/home/payroll:/bin/payroll

会计档案

Monday|Alexander|815-19-9640|4662 Dewy Subdivision|Owltown|Oregon|97434-8480|1/18/1998|19|21.68|60.28|2.24|工资单正在审核帐户，报告即将到期。

Arterbury|Inigo|037-30-1373|987 Rocky Island Byway|Christmas City|New Mexico|88023-3889|4/1/1993|9|7.02|17.75|12.71|审核完成。发现不足。

Herman|Wardell|114-29-0210|5555 Cinder Forest Wynd|White Eyes Town|Washington|98707-5628|10/0/2003|37|3.07|41.90|20.89|审核完成。发现不足。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:50:23.020

哇，您的方法存在一些严重的安全问题。我会尝试在评论中指出一些。

要专注于您的特定问题，您需要某种方式将用户链接到会计数据，然后按用户过滤。理想情况下，您会将原始数据摄取到具有关系约束的数据库中，以使这更容易。但是对于当前的方法，您可以执行以下操作：

```
next unless "$Fname $Lname" eq $username; 
```

将其放置在将变量名称映射到返回的正则表达式字段之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T02:09:45.160

我将跳过*安全问题*。让我们看几件事：

你的`accounting`子程序应该做什么？打印用户的薪水？您没有将任何数据传递给子例程。子程序如何知道要打印哪个用户的薪水？

为什么不做这样的事情？

```
 accounting($Fname, $Lname); 

sub accounting {
   my $first_name = shift;
   my $last_name = shift;

   if (not $first_name or not $last_name) {
      die "You need a first name and a last name...)
   } 
```

现在，您可以逐行遍历您的*会计文件*`$first_name`，查找和`$last_name`匹配的行。

```
while (my $lines = <$fh>){
    chomp $lines;

    my ( $Lname, $Fname, $ssn,  $address,
        $city,  $state, $zip,  $payDatek,
        $hours, $rate,  $taxes,$deductions, $notes) = split /\|/, $lines;

        #Skip over non matching lines
        next if $Lname ne $last_name and $Fname ne $first_name; 
```

您的代码中有一些虚假错误。我注意到一些快速的：

*   `push @data2, \@fields;`您正在将数组的*引用*推送到数组中。
*   `my ( $Lname, $Fname, ... $notes) = %fields;`字段是一个数组，而不是哈希。

我很惊讶你的程序编译了这些问题。

并且，请在代码中使用空格。它使阅读和遵循变得更加容易。

# html - 如何创建代表精灵图像的 CSS？

> ID：13407493
> 
> 赞同：1
> 
> 时间：2012-11-15T22:39:48.450
> 
> 标签：html, css, sprite, css-sprites

给定一个精灵图像，一个文件中包含所有图像，我想生成代表每个字符的 CSS。我已经查看了一些精灵创建工具，它们都假设您有一个图像目录，您希望将这些图像组合成一个精灵并同时生成 CSS。

这样的工具存在吗？我有几十个这样的精灵图像需要处理。手动操作是不可能的。

谢谢！干杯!

[http://imgur.com/1GHow](http://imgur.com/1GHow)喜欢这张图片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:51:10.903

鉴于 sprite sheet 被安排在一个规则的网格中，Sass 将很容易做到这一点：

**萨斯**

```
$sprite-sheet-width: 384;
$sprite-sheet-height: 384;
$sprite-cols: 12;
$sprite-rows: 8;

$sprite-width: $sprite-sheet-width/$sprite-cols;
$sprite-height: $sprite-sheet-height/$sprite-rows;

@for $i from 0 to $sprite-rows {

    @for $j from 0 to $sprite-cols {
        .sprite-#{$i}-#{$j} {
            $top: $i * $sprite-height;
            $left: $j * $sprite-width;
            background-position: $top $left;
        }
    }

} 
```

**编译的 CSS**

```
.sprite-0-0 {
  background-position: 0 0; }

.sprite-0-1 {
  background-position: 0 32; }

.sprite-0-2 {
  background-position: 0 64; }

.sprite-0-3 {
  background-position: 0 96; }

.sprite-0-4 {
  background-position: 0 128; }

.sprite-0-5 {
  background-position: 0 160; }

.sprite-0-6 {
  background-position: 0 192; }

.sprite-0-7 {
  background-position: 0 224; }

.sprite-0-8 {
  background-position: 0 256; }

.sprite-0-9 {
  background-position: 0 288; }

.sprite-0-10 {
  background-position: 0 320; }

.sprite-0-11 {
  background-position: 0 352; }

[...]

.sprite-7-0 {
  background-position: 336 0; }

.sprite-7-1 {
  background-position: 336 32; }

.sprite-7-2 {
  background-position: 336 64; }

.sprite-7-3 {
  background-position: 336 96; }

.sprite-7-4 {
  background-position: 336 128; }

.sprite-7-5 {
  background-position: 336 160; }

.sprite-7-6 {
  background-position: 336 192; }

.sprite-7-7 {
  background-position: 336 224; }

.sprite-7-8 {
  background-position: 336 256; }

.sprite-7-9 {
  background-position: 336 288; }

.sprite-7-10 {
  background-position: 336 320; }

.sprite-7-11 {
  background-position: 336 352; } 
```

[您可以使用在线编译器](http://sass-lang.com/try.html)尝试一下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:46:50.337

[http://cssspritegenerator.net/howto.php](http://cssspritegenerator.net/howto.php)

首先创建一个帐户。如果您已经准备好图像并很快想要使用 CSS Sprite Generator 而无需创建一个很好的帐户，只需使用“跳过登录”替代方法。如果您选择此方法，您的帐户将在 24 小时后被删除，如果您想向您的精灵添加更多图像，您将无法取回密码以供进一步使用。

# c++ - 关于 getadrrinfo() C++？

> ID：13407495
> 
> 赞同：1
> 
> 时间：2012-11-15T22:40:03.140
> 
> 标签：c++, visual-studio-2010, visual-studio, visual-studio-2012, winsock

我正在阅读这本书，名为*beej 的网络编程指南，*书中有一部分提供了一个示例代码来说明 getaddrinfo() 的使用；该书指出，下面的代码***“将打印您在命令行上指定的任何主机的 IP 地址”*** ——beej 的网络编程指南。

现在我很好奇，想尝试一下并运行代码，但我猜代码是在 UNIX 环境中开发的，我使用的是 Visual Studio 2012 Windows 7 OS，并且大多数标题不受支持所以我做了一个一点研究，发现我需要包含 windows 的 winsock.h 和 ws2_32.lib，它才能开始工作，幸运的是一切编译没有错误，但是当我使用调试器运行它并放入'www.google. com' 作为命令参数我很失望它没有打印任何 ipaddress，我从控制台得到的输出是“ **getaddrinfo: E** ”

*   字母E是什么意思？
*   我需要从调试器中配置一些东西吗？

*   有趣的是，我将命令参数留空，输出
    更改为***“用法：showip 主机名”***

任何帮助，将不胜感激。

```
#ifdef _WIN32
#endif

#include <sys/types.h>
#include <winsock2.h>
#include <ws2tcpip.h>
#include <iostream>

using namespace std;

#include <stdio.h>
#include <string.h>
#include <sys/types.h>
#include <winsock.h>

#pragma comment(lib,  "ws2_32.lib")

int main(int argc, char *argv[])
{
    struct addrinfo hints, *res, *p;
    int status;
    char ipstr[INET6_ADDRSTRLEN];
    if (argc != 2) {
        fprintf(stderr,"usage: showip hostname\n");
        system("PAUSE");
        return 1;
    }
    memset(&hints, 0, sizeof hints);
    hints.ai_family = AF_UNSPEC; // AF_INET or AF_INET6 to force version
    hints.ai_socktype = SOCK_STREAM;
    if ((status = getaddrinfo(argv[1], NULL, &hints, &res)) != 0) {
        fprintf(stderr, "getaddrinfo: %s\n", gai_strerror(status));
        system("PAUSE");
        return 2;
    }
    printf("IP addresses for %s:\n\n", argv[1]);
    for(p = res;p != NULL; p = p->ai_next) {
        void *addr;
        char *ipver;
        // get the pointer to the address itself,
        // different fields in IPv4 and IPv6:
        if (p->ai_family == AF_INET) { // IPv4
            struct sockaddr_in *ipv4 = (struct sockaddr_in *)p->ai_addr;
            addr = &(ipv4->sin_addr);
            ipver = "IPv4";
        } else { // IPv6
            struct sockaddr_in6 *ipv6 = (struct sockaddr_in6 *)p->ai_addr;
            addr = &(ipv6->sin6_addr);
            ipver = "IPv6";
        }
        // convert the IP to a string and print it:
        inet_ntop(p->ai_family, addr, ipstr, sizeof ipstr);
        printf(" %s: %s\n", ipver, ipstr);
    }
    freeaddrinfo(res); // free the linked list

    system("PAUSE");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:01:25.553

您忽略了初始化 Windows 套接字层，这是在 Windows 下使用套接字 API 时的要求。使用该[`WSAStartup()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms742213%28v=vs.85%29.aspx)功能来执行此操作。

```
int main(int argc, char *argv[]) 
{
    WORD wVersionRequested;
    WSADATA wsaData;
    int err;

    /* Use the MAKEWORD(lowbyte, highbyte) macro declared in Windef.h */
    wVersionRequested = MAKEWORD(2, 2);

    err = WSAStartup(wVersionRequested, &wsaData);
    if (err != 0) {
        /* Tell the user that we could not find a usable */
        /* Winsock DLL.                                  */
        printf("WSAStartup failed with error: %d\n", err);
        return 1;
    }

   ... your code here...

    WSACleanup();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:00:27.393

也许你得到“getaddrinfo: E”是因为你不知何故得到了一个 16 位 unicode 版本的 gai_strerror 并尝试在 8 位 printf 中使用它。因此，字符“E”由一个“E”字节和一个零字节组成，当解释为 8 位字符串时，它会终止该字符串。

不确定。当我在这里看到[http://msdn.microsoft.com/en-us/library/windows/desktop/ms738514(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms738514(v=vs.85).aspx)时，我才知道还有一个 ANSI 版本。

# php - 在 PHP 中从 if 语句或数组中获取值更快？

> ID：13407501
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:40:17.507
> 
> 标签：php, optimization, benchmarking

也许这是一个愚蠢的问题，但什么更快？

```
<?php

function getCss1 ($id = 0) {
    if ($id == 1) {
        return 'red';
    } else if ($id == 2) {
        return 'yellow';
    } else if ($id == 3) {
        return 'green';
    } else if ($id == 4) {
        return 'blue';
    } else if ($id == 5) {
        return 'orange';
    } else {
        return 'grey';
    }
}

function getCss2 ($id = 0) {
    $css[] = 'grey';
    $css[] = 'red';
    $css[] = 'yellow';
    $css[] = 'green';
    $css[] = 'blue';
    $css[] = 'orange';
    return $css[$id];
}

echo getCss1(3);
echo getCss2(3);
?> 
```

我怀疑 if 语句更快，但我更喜欢问！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T22:46:05.597

`getCss1`（if 语句）大约是我的基准测试的两倍`getCss2`（数组访问）。

结果来自`microtime()`：

```
getCss1 called 10,000 times in 0.016569852828979 seconds
getCss2 called 10,000 times in 0.037255048751831 seconds 
```

根据评论，我同意使用*翻译*数组的可维护性。`$css`考虑到函数开销和数组重新声明的消除，直接访问速度明显更快。

```
getCss1 called 10,000 times in 0.016607999801636 seconds
$css accessed 10,000 times in 0.0026898384094238 seconds 
```

**注意：**在 Mac OS X 10.8 上运行 PHP 5.3.15。我还改变了调用顺序`$id`来测试执行路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T22:55:32.380

我用它计时：

```
$t = microtime(true);
for($i = 0; $i < 10000000; $i++){
    getCss1(3);
}
echo "getCss1: ".(microtime(true) - $t)."\n";

$t = microtime(true);
for($i = 0; $i < 10000000; $i++){
    getCss2(3);
}
echo "getCss2: ".(microtime(true) - $t)."\n"; 
```

如果在 getCss2 函数之外定义 $css，并使用全局 $css，该函数仍然比 getCss1 慢，但比之前的版本快很多：

```
$css[] = 'grey';
$css[] = 'red';
$css[] = 'yellow';
$css[] = 'green';
$css[] = 'blue';
$css[] = 'orange';
function getCss3 ($id = 0) {
    global $css;
    return $css[$id];
}

$t = microtime(true);
for($i = 0; $i < 10000000; $i++){
    getCss3(3);
}
echo "getCss3: ".(microtime(true) - $t)."\n"; 
```

结果（Windows 7，AMD Phenom II：3.6Ghz，PHP 5.3.3）：

```
getCss1: 3.7735629081726
getCss2: 14.683212995529
getCss3: 4.2553169727325 
```

使用不同的 $id：

$id = 6：

```
getCss1: 4.2732820510864
getCss2: 32.388185024261
getCss3: 20.429337024689 
```

$id = 0：

```
getCss1: 4.3480041027069
getCss2: 14.638042926788
getCss3: 4.2784569263458 
```

因此，if 的速度似乎与值的位置完全无关，而在访问“低”键时，数组访问要快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:47:57.723

以下是如何计时！

将这两个函数保存在一个文件中。定义函数后，在一个上启动计时器，然后在另一个上启动。例子：

```
// Run function 1
$time_start1 = microtime();
getCss1 (2);
$time_end1 = microtime();
$time1 = $time_end1 - $time_start1;

echo "getCss1 function executed in $time1 seconds\n";

// Run function 2
$time_start2 = microtime();
getCss2 (2);
$time_end2 = microtime();
$time2 = $time_end2 - $time_start2;

echo "getCss2 function executed in $time2 seconds\n"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T22:54:07.380

第二个函数可能较慢的唯一原因是访问内存需要时间。但是，数组可以存储在处理器的缓存中，这样时间会大大减少。此外，第二个函数在调用堆栈中的跳转次数更少。

理论上没有办法说，因为它取决于当前的机器配置和处理器架构。

如果您进行速度测试，请务必进行多次测试并比较平均速度值...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-15T23:21:00.157

不要忘记 getCss1(3) 总是要检查 3 个条件。getCss(3) 必须在位置 3 处获取数组的值...

明确地：访问数组更快..

这是我的测试应用程序：

```
function getCss1($id = 0) {
  if ($id == 1) {
    return 'red';
  } else if ($id == 2) {
    return 'yellow';
  } else if ($id == 3) {
    return 'green';
  } else if ($id == 4) {
    return 'blue';
  } else if ($id == 5) {
    return 'orange';
  } else {
    return 'grey';
  }
}

function getCss2($id = 0) {
  static $css;
  if ($css === null) {
    $css[] = 'grey';
    $css[] = 'red';
    $css[] = 'yellow';
    $css[] = 'green';
    $css[] = 'blue';
    $css[] = 'orange';
  }
  return $css[$id];
}

$start = microtime(true);
for ($i = 0; $i < 10000; $i++) {
  $x = getCss1($i%6);
}
$end = microtime(true);
echo 'getCss1: ' . ($end-$start) . "\n";

$start = microtime(true);
for ($i = 0; $i < 10000; $i++) {
  $x = getCss2($i%6);
}
$end = microtime(true);
echo 'getCss2: ' . ($end-$start) . "\n"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-15T22:50:50.650

速度应该取决于 的值，`$id`因为如果它是 6，它将遍历所有 if 语句，而从数组中获取索引值可能会更快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-15T22:51:37.690

首先：if/switch 语句并不是真正动态的，而数组是因为它们占用内存（是的，我知道 if 语句可能会这样做，但它太小了）。

if 语句不必将变量保存在内存中，因为除了返回值之外，您没有为服务器的 ram（也称为变量）分配任何东西。

相对

该数组中的每个项目都将首先存储在内存中，然后可以在键值方法中使用。

这真的太小了，但我已经用完内存很多次了，从试图做各种大事情的数据库创建动态键 => 值数组。我建议你对这种事情使用 switch 语句。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-15T22:53:35.837

你是对的。如果语句更快，因为它比较了最有价值情况下的所有变体。当您使用数组时，它需要时间和内存来在每种情况下创建所有变体。但！带有数组的变体更具可读性和可用性，如果数组不大并且他的值是恒定的（不是函数的结果！），最好使用数组方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-05T19:51:44.797

您也可以使用 switch 代替 if 。Switch 比 if 语句快

```
switch ($id){
case 1: return "red";
break;
case 2: return "yellow";
break;
case 3: return "green";
...
} 
```

# java - Java、JPA、Glassfish、无效资源：jdbc/__default__pm

> ID：13407505
> 
> 赞同：30
> 
> 时间：2012-11-15T22:40:46.373
> 
> 标签：java, jpa, deployment, glassfish

我使用 Glassfish 3.1.2.2 (build 5)、JPA、EclipseLink、MySQL

我通过 Glassfish 管理面板创建了 MySQL 池。从 GF 管理面板 Ping 到 MySQL 没问题。

我用 persistence.xml 创建了应用程序：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence" version="2.0">
<persistence-unit name="myUnit">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <properties>
        <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/myDBName"/>
        <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"/>
        <property name="javax.persistence.jdbc.user" value="root"/>
        <property name="javax.persistence.jdbc.password" value="myPass"/>
        <property name="javax.persistence.ddl-generation" value="drop-and-create-tables"/>
    </properties>
</persistence-unit> 
```

我尝试部署它并收到错误：

```
Invalid resource : jdbc/__default__pm

[#|2012-11-16T02:20:59.480+0400|SEVERE|glassfish3.1.2|javax.enterprise.system.core.com.sun.enterprise.v3.server|_ThreadID=43;_ThreadName=Thread-2;|Invalid resource : jdbc/__default__pm
java.lang.RuntimeException: Invalid resource : jdbc/__default__pm 
```

GF 日志中的 Stacktrace 非常庞大。开始于

```
at com.sun.enterprise.connectors.ConnectorRuntime.lookupDataSourceInDAS(ConnectorRuntime.java:540)
at com.sun.enterprise.connectors.ConnectorRuntime.lookupPMResource(ConnectorRuntime.java:469)
at org.glassfish.persistence.common.PersistenceHelper.lookupPMResource(PersistenceHelper.java:63)
at org.glassfish.persistence.jpa.ProviderContainerContractInfoBase.lookupDataSource(ProviderContainerContractInfoBase.java:71)
.... 
```

有谁知道发生了什么以及该怎么做？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-16T01:19:16.333

如果只创建了 MySQL 连接池，还必须创建 JDBC 资源。这可以从用于创建连接池的菜单上方的上下文菜单中创建。

![示例 Glassfish jdbc 资源设置](../Images/1d3549c45319567f6e14e90b3026f1b3.png)

在我的 JDBC 资源 Glassfish 中，jdbc/__default 正在使用连接池 mysql_lemon。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-08-20T11:32:48.823

__nontx 和 __pm 是池的扩展。文档：[https](https://docs.oracle.com/cd/E19798-01/821-1752/beamr/index.html) ://docs.oracle.com/cd/E19798-01/821-1752/beamr/index.html （其他地方[http://docs.oracle.com/cd/E26576_01/doc.312/e24930/ jdbc.htm#GSDVG00185](http://docs.oracle.com/cd/E26576_01/doc.312/e24930/jdbc.htm#GSDVG00185)和[http://docs.oracle.com/cd/E26576_01/doc.312/e24930/transaction-service.htm#GSDVG00512](http://docs.oracle.com/cd/E26576_01/doc.312/e24930/transaction-service.htm#GSDVG00512)）

第一个**下午**

来自[https://docs.oracle.com/cd/E19798-01/821-1752/gavro/index.html](https://docs.oracle.com/cd/E19798-01/821-1752/gavro/index.html)

> 允许非组件调用者
> 
> 您可以允许非 Java-EE 组件（例如 servlet 过滤器、生命周期模块和第三方持久性管理器）使用此 JDBC 连接池。返回的连接自动与从事务管理器获得的事务上下文一起登记。标准 Java EE 组件也可以使用此类池。非组件调用者获得的连接不会在事务结束时由容器自动关闭。它们必须由调用者显式关闭。
> 
> 您可以通过以下方式启用非组件调用者：
> 
> 选中管理控制台中编辑连接池高级属性页面上的允许非组件调用者框。默认值为假。有关详细信息，请单击管理控制台中的帮助按钮。
> 
> 在 asadmin create-jdbc-connection-pool 命令中指定 ----allownoncomponentcallers 选项。有关详细信息，请参阅 Oracle GlassFish Server 3.0.1 参考手册。
> 
> 在 asadmin set 命令中指定 allow-non-component-callers 选项。例如：
> 
> asadmin 设置 domain1.resources.jdbc-connection-pool.DerbyPool.allow-non-component-callers=true
> 
> 有关详细信息，请参阅 Oracle GlassFish Server 3.0.1 参考手册。
> 
> 创建一个带有 __pm 后缀的 JDBC 资源。

和**__nontx**

来自[https://docs.oracle.com/cd/E19798-01/821-1752/beamu/index.html](https://docs.oracle.com/cd/E19798-01/821-1752/beamu/index.html)

> 使用非事务连接
> 
> 您可以通过以下任何方式指定非事务性数据库连接：
> 
> 选中管理控制台中新建 JDBC 连接池或编辑连接池页面上的非事务连接框。默认为未选中。有关详细信息，请单击管理控制台中的帮助按钮。
> 
> 在 asadmin create-jdbc-connection-pool 命令中指定 ----nontransactionalconnections 选项。有关详细信息，请参阅 Oracle GlassFish Server 3.0.1 参考手册。
> 
> 在 asadmin set 命令中指定 non-transactional-connections 选项。例如：
> 
> asadmin 设置 domain1.resources.jdbc-connection-pool.DerbyPool.non-transactional-connections=true
> 
> 有关详细信息，请参阅 Oracle GlassFish Server 3.0.1 参考手册。
> 
> 使用 GlassFish Server 中的 DataSource 实现，它提供了一个 getNonTxConnection 方法。此方法检索不在任何事务范围内的 JDBC 连接。有两种变体。
> 
> 公共 java.sql.Connection getNonTxConnection() 抛出 java.sql.SQLException
> 
> public java.sql.Connection getNonTxConnection(String user, String password) 抛出 java.sql.SQLException
> 
> 创建一个 JNDI 名称以 __nontx 结尾的资源。这会强制使用此资源查找的所有连接都是非事务性的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-15T23:17:54.123

（我的同一篇文章，但现在有正确的帐户）：

使用您的设置配置持久性时，您只需在 persistence.xml 中设置 JDBC 池的 JNDI 名称。可选，您可以设置目标数据库名称。

```
<persistence-unit name="foo" transaction-type="JTA">
    <jta-data-source>jdbc/mysql</jta-data-source>
    <!--optional-->
    <property name="eclipselink.target-database" value="MySQL4"/>
</persistence-unit> 
```

我还鼓励将“drop-and-create-table”更改为“create-tables”，这样您就不会丢失数据，这应该以以下方式提供 EclipseLink 的属性：

```
<property name="eclipselink.ddl-generation" value="create-tables"/> 
```

也很方便

```
<property name="eclipselink.ddl-generation.output-mode" value="both"/> 
```

这将创建模式和 sql 脚本。

欲了解更多信息，请访问：[http](http://wiki.eclipse.org/EclipseLink/Examples/JPA/DDL) ://wiki.eclipse.org/EclipseLink/Examples/JPA/DDL 或[http://docs.oracle.com/cd/E19798-01/821-1752/gbwmj/index.html](http://docs.oracle.com/cd/E19798-01/821-1752/gbwmj/index.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-15T23:20:11.853

我有同样的问题。

解决方案（对于仍然有此问题的任何人）：

1.  如果您将 NetBeans IDE 8.1 与 Glassfish 4.1.1 一起使用，我建议您将其更改为 Glassfish 4.1

2.  转到 NetBeans 中的左侧面板。

单击`services > server > glassfish`然后右键单击（在 Glassfish 服务器中）并选择查看域管理控制台，应该会显示一个网页。

向左选择`resources > JDBC`和`JDBC connection pool`。

通过单击添加新的连接池`new`，输入池的名称。

接下来，选择`javax.sql.ConnectionPoolDataSource`和`datadriver`（在我的例子中是 MySQL），然后单击下一步。

之后，您应该输入数据库所需的所有信息。

3.  回到`Resources > JDBC`. 这一次，`JDBC Resources`创建一个新的 JDBC 资源（对我来说，我将它命名为`jdbc/test`）。不要忘记将它与您已经创建的连接池链接。

4.  在 NetBeans 中，转到您的`ejb`项目并修改`persistence.xml`文件。更改`datasource`为数据库资源（在我的情况下`jdbc/test`）并保存所有。

那应该行得通。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-08T19:03:23.053

当我在由 netbeans 安装向导创建的服务器上运行/部署应用程序时，我遇到了同样的问题。

为了解决这个问题，我从官方网站下载了最后一个 glassfish 版本，然后转到：Netbeans > “Service's Tab” > “Servers” > “Add Server...”。

请记住更改您的项目配置以使用新的 glassfish 服务器实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-23T08:51:43.193

我遇到了这个问题。我在管理控制台中设置了 jdbc 连接池和 jdbc 资源。但我没有在 persistence.xml 中设置数据源。

```
 <persistence-unit name="OnlinePrintService-warPU" transaction-type="JTA">
    <jta-data-source>jdbc/your-name</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties>
      <property name="javax.persistence.schema-generation.database.action" value="create"/>
    </properties>
  </persistence-unit> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-07T12:12:06.593

这可能是由于[他们说他们已经修复](https://netbeans.org/bugzilla/show_bug.cgi?id=233481)但似乎没有修复的 NetBeans 错误。作为一种解决方案，我最终`glassfish-resources.xml`完全删除了（因为我无法`persistence.xml`使用任何变通方法来获取它）并改用`@DataSourceDefinition`注释。

我的配置使用单独的`DataSourceBean.java`文件`@DataSourceDefinition`：

```
@Singleton
@Startup
@DataSourceDefinition(name="java:global/jdbc/myDataSource",
    className="com.microsoft.sqlserver.jdbc.SQLServerDataSource",
    url="jdbc:sqlserver://127.0.0.1:1433;databaseName=myDB",
    user="myuser",
    password="mypassword"
)
public class DataSourceBean {
} 
```

`persistence.xml`看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://xmlns.jcp.org/xml/ns/persistence"
             xmlns:xsi=" http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"
             version="2.1">
    <persistence-unit name="myUnit" transaction-type="JTA">
        <jta-data-source>java:global/jdbc/myDataSource</jta-data-source>
        <properties>
            <property name="eclipselink.ddl-generation" value="drop-and-create-tables"/>
        </properties>
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-05-17T12:32:27.607

我有同样的问题，我坚信这是由一些剩余缓存引起的。

就在我完成之后

```
asadmin remove-domain domain1
asadmin create-domain domain1 
firefox http://localhost:4848 
```

Now`__pm`不再附加到 JDBC 资源中。

如果这没有帮助，那么我假设您正在使用

```
@PersistenceContext
EntityManager em; 
```

这应该替换为例如

```
em=Persistence.createEntityManagerFactory("DefaultPU(PUT_PERSISTANCE_UNIT_NAME_HERE").createEntityManager();
String ret="Hello " + txt + ", "+ em.createNamedQuery("Usertable.findAll").getResultList().get(0).toString() +" !" ;
em.close(); 
```

# javascript - 如何使我的下拉菜单键盘可访问？

> ID：13407507
> 
> 赞同：0
> 
> 时间：2012-11-15T22:40:49.253
> 
> 标签：javascript, jquery, drop-down-menu, accessibility

我有一个下拉菜单，我需要我可以通过键盘访问，但不知道该怎么做。在我的 css 中，我将 a:focus 放在所有链接上。我假设在 javascript/jquery 中使用 onfocus 是最好的，而不是将 tab 键硬编码到 javascript 中，对吗？如果是这样，我将如何处理代码以使用焦点选择器？当有人进入菜单时，菜单需要放下，然后当他们关闭菜单时（或者他们可以按退出键，因为有超过 40 个链接）它需要关闭（需要就像鼠标悬停/鼠标悬停时一样）。 [示例菜单](http://okfocused.com/cu)

```
if (ie === "1") {
if ($(window).width() > 949) {

$.fn.pause=function(a){$(this).stop().animate({dummy:1},a);return this};
function mouseleft(){$("#buttonbar").triggerHandler("mouseleave")}
$(document).ready(function()
  {$("#buttonbar").mouseenter(function(){$(this).stop().pause(160).animate({height:"12.7em"},400,"easeOutQuart")}).mouseleave(function(){$(this).stop().pause(160).animate({height:"2.2em"},400,"easeOutQuart")});});$(function(){$("#accordion").accordion({fillSpace:!0,icons:{header:"accordion-header",headerSelected:"accordion-headerselected"}})});
if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i)) || (navigator.userAgent.match(/iPad/i))) {
    $("#buttonbar li").bind('touchstart', function(){
        console.log("touch started");
    });
$("#buttonbar li").bind('touchend', function(){
        console.log("touch ended");
    });
}
else {
 $("#accordion").accordion({active:false});
}
}

function showElement(d){
  var s=document.getElementById(d).style;
  if ($(window).width() < 950) {
    if (s.display != "block" ) { s.display = "block"; } else { s.display = "none"; }
  if ($(window).width() > 949) {
    if (s.display != "block" ) { s.display = "block"; } 
  }
}
}
function showHide() {
  var s=document.getElementById("buttonbar").style;
  if ($(window).width() > 949) {
    s.display = "block";
    document.getElementById("prospective-links").style.display = "block";
    document.getElementById("current-links").style.display = "block";
    document.getElementById("academic-links").style.display = "block";
    document.getElementById("facstaff-links").style.display = "block";
    document.getElementById("parent-links").style.display = "block";
    document.getElementById("alumni-links").style.display = "block";
    document.getElementById("visitor-links").style.display = "block";
$("#accordion").accordion('destroy');
    $("#buttonbar").unbind('mouseenter');
    $("#buttonbar").unbind('mouseleave');
$.fn.pause=function(a){$(this).stop().animate({dummy:1},a);return this};
function mouseleft(){$("#buttonbar").triggerHandler("mouseleave")}
$(document).ready(function()
  {$("#buttonbar").mouseenter(function(){$(this).stop().pause(160).animate({height:"12.7em"},400,"easeOutQuart")}).mouseleave(function(){$(this).stop().pause(160).animate({height:"2.2em"},400,"easeOutQuart")});});$(function(){$("#accordion").accordion({fillSpace:!0,icons:{header:"accordion-header",headerSelected:"accordion-headerselected"}})});
if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i)) || (navigator.userAgent.match(/iPad/i))) {
    $("#buttonbar li").bind('touchstart', function(){
        console.log("touch started");
    });
$("#buttonbar li").bind('touchend', function(){
        console.log("touch ended");
    });
}

  }
  else {
    /*$("#accordion").accordion({active:false});*/
    $("#accordion").accordion('destroy');
    $("#buttonbar").unbind('mouseenter');
    $("#buttonbar").unbind('mouseleave');
    $("#buttonbar li").unbind('touchstart');
    $("#buttonbar li").unbind('touchend');

    s.display = "none";
    document.getElementById("prospective-links").style.display = "none";
    document.getElementById("current-links").style.display = "none";
    document.getElementById("academic-links").style.display = "none";
    document.getElementById("facstaff-links").style.display = "none";
    document.getElementById("parent-links").style.display = "none";
    document.getElementById("alumni-links").style.display = "none";
    document.getElementById("visitor-links").style.display = "none";
    /*$("#buttonbar").accordion('destroy');*/

  }

}
$(window).resize(showHide); //Run when resized

jQuery(function($) {
  var path = location.pathname.substring(1);
  $('#nav a[href$="' + path + '"]').addClass('active');
});

// This section makes the skip to anchor links such as the skip to content link work in webkit browsers like Chrome and Safari
(function(linkList,i,URI) {
   if (!!(URI = document.documentURI)) {
        URI = URI.split('#')[0];
      document.addEventListener("DOMContentLoaded", function() {
         document.removeEventListener("DOMContentLoaded", arguments.callee, false);
         linkList = document.links;
         for (i in linkList) {
            if (!!linkList[i].hash) {
               if (linkList[i].hash.match(/^#./)) {
                  if ((URI+linkList[i].hash)==linkList[i].href){
                     linkList[i].addEventListener("click", function(e,f,g) {
                        f = document.getElementById(this.hash.slice(1));
                        if (!(g = f.getAttribute('tabIndex'))) f.setAttribute('tabIndex',-1);
                        f.focus();
                        if (!g) f.removeAttribute('tabIndex');
                     }, false);
                  }
               }
            }
         }
      }, false);
   }
   return true;
})();
}
else {
function showElement(d){
  var s=document.getElementById(d).style;
  if (s.display != "block" ) { s.display = "block"; } else { s.display = "none"; }
};

}; 
```

html如下：

```
 <div id="buttonbar">
    <ul id="bar">
  <li id="prospective" class="rightborder"><a>Future Students</a>
    <ul id="prospective-links">
      <li><a href="/admissions">Undergraduate Admissions</a></li>
      <li><a href="/graduate">Graduate Admissions</a></li>
      <li><a href="/admissions/international">International Admissions</a></li>
      <li><a href="/transfer">Transfer Admissions</a></li>
      <li><a href="/advising-center">Academic Advising Center</a></li>
      <li><a href="/financial_aid">Financial Assistance</a></li>
      <li><a href="/info/schedules/tuition">Tuition and Fees</a></li>
      <li><a href="#">Test Item 8</a></li>
      <li class="last-item"><a href="/prospective">Go to Future Students</a></li>
    </ul></li>
      <li id="students" class="rightborder"><a href="/current">Current Students</a>
         <ul id="current-links">
            <li><a href="/info/calendars/academic">Academic Calendar</a></li>
            <li><a href="/info/schedules">Enrollment Schedule</a></li>
            <li><a href="/studentservices">Student Life</a></li>
            <li><a href="/housing">Housing</a></li>
            <li><a href="/financial_aid/workstudy.html">On-Campus Jobs</a></li>
            <li><a href="#">Bookstore</a></li>
            <li><a href="#">Athletics</A></li>
            <li class="fill"><a name="hold">&nbsp;</a></li>
            <li class="last-item"><a href="/current">Go to Current Students</a></li>
         </ul></li>
    </ul>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:44:43.393

尝试对链接使用[tabIndex](http://reference.sitepoint.com/html/a/tabindex)。（但正如 steveaz 指出的那样，它们应该已经可以聚焦了）

```
$('#buttonbar a').attr('tabIndex', 0); 
```

对于菜单，您必须添加一个事件以及`tabIndex`. `$menu`是您的菜单的选择器，我不确定那是什么，请根据您的需要进行调整：

```
$('#bar').attr('tabIndex', 0)
  .focus(function() { $menu.show(); })
  .keydown(function(e) { e.which == 27 && $menu.hide(); }) // ESC
  .blur(function() { $menu.hide(); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:50:53.523

我会尝试类似...给你的按钮栏一个标签索引然后绑定焦点/模糊功能来显示和隐藏按钮栏菜单

```
$(document).load(function(){

    $('#buttonbar').attr('tabIndex', 0).on({
       focus: function(){
          $("#buttonbar").triggerHandler("mouseenter");
       },
       blur: function(){
          $("#buttonbar").triggerHandler("mouseleave");
       }
    });

}); 
```

# database-design - 标签的数据库表会是什么样子？

> ID：13407509
> 
> 赞同：1
> 
> 时间：2012-11-15T22:40:55.467
> 
> 标签：database-design

我必须通过标签来定义书的​​属性，我正在考虑创建表格

```
Table Books
Book_Id INT, PK
Book_Name varchar

Table Tags
Tag_Id INT, PK
Tag_Name varchar 
```

一本书可以有多个标签，如恐怖、有趣、黑暗等。我如何定义一本书与其所有标签之间的一对多关系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:42:58.230

您需要在书籍和标签之间创建一个连接表，如下所示：

```
Books_Tags Table
Book_id int   -- will be PK
Tag_ig int    -- will be PK 
```

连接表的主键将包含两个字段 (`book_id`和`tag_id`)，它们也将是其他表的外键。

然后，当您要查询数据时，您的查询将类似于以下内容：

```
select *
from books b
left join books_tags bt
  on b.book_id = bt.bookid
left join tags t
  on bt.tag_id = t.tag_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T00:52:17.863

考虑使用自然键（而不是代理“标签 ID”）来避免在搜索标签时可能需要的 JOIN 之一（这可能是合理大小的数据库上的性能关键路径）。

例如：

```
CREATE TABLE BOOK (
    BOOK_ID INT PRIMARY KEY
    -- Other fields...
);

CREATE TABLE BOOK_TAG (
    TAG_NAME VARCHAR(30),
    BOOK_ID INT,
    PRIMARY KEY (TAG_NAME, BOOK_ID),
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE
);

-- For enforcing and cascading the FK and for GROUP BY (in the query below).
CREATE INDEX BOOK_TAG_IE1 ON BOOK_TAG (BOOK_ID, TAG_NAME);

CREATE TABLE TAG (
    TAG_NAME VARCHAR(30) PRIMARY KEY,
    -- Other fields...
); 
```

您现在可以获得具有**任何**给定标签的书籍，如下所示：

```
SELECT *
FROM BOOK
WHERE BOOK_ID IN (
    SELECT BOOK_ID
    FROM BOOK_TAG
    WHERE
        TAG_NAME = 'tag1'
        OR TAG_NAME = 'tag2'
        -- Etc...
); 
```

以及具有**所有**给定标签的书籍，如下所示：

```
SELECT *
FROM BOOK
WHERE BOOK_ID IN (
    SELECT BOOK_ID
    FROM BOOK_TAG
    WHERE
        TAG_NAME = 'tag1'
        OR TAG_NAME = 'tag2'
        -- Etc...
    GROUP BY BOOK_ID
    HAVING COUNT(TAG_NAME) = 2
); 
```

[[工作 SQL Fiddle 示例]](http://sqlfiddle.com/#!4/09ee7/1)

如您所见，只有一个 JOIN（这里写为 IN）。搜索书籍（或仅显示标签名称 - 此处未显示）时，根本不需要加入 TAG 表。

进行第二次 JOIN 的唯一原因是如果/何时需要从 TAG 表中获取这些“其他字段”。

## 注意事项：

*   如果您不需要为每个标签存储任何附加信息（即您没有标签描述等），您可以完全省略 TAG 表。
*   如果您的 DBMS 支持它，请考虑[集群](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)BOOK_TAG。[无论如何，您只能通过索引](http://use-the-index-luke.com/sql/glossary/covering-index)访问它，因此您可以删除“不必要的”表堆。
*   同样，如果您的 DBMS 支持它，请[压缩](http://richardfoote.wordpress.com/2008/02/17/index-compression-part-i-low/)索引的前沿（BOOK_TAG PK 和 BOOK_TAG_IE1），以节省重复值的空间，更重要的是，提高缓存效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:44:30.863

我会制作第三张桌子并使 Book > Tags 成为多对多关系。

所以：

表 Book_Id INT、PK Book_Name varchar

表标签 Tag_Id INT、PK Tag_Name varchar

表 BookTags Id INT、PK Book_Id INT Tag_Id Int

# excel - 显示用户窗体时 Excel 2010 VBA 代码卡住

> ID：13407514
> 
> 赞同：1
> 
> 时间：2012-11-15T22:41:08.270
> 
> 标签：excel, vba

我创建了一个用户窗体作为进度指示器，而 Web 查询（使用 InternetExplorer 对象）在后台运行。代码被触发，如下所示。进度指示器表格称为“Progerss”。

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Row = Range("B2").Row And Target.Column = Range("B2").Column Then
        Progress.Show vbModeless
        Range("A4:A65535").ClearContents
        GetWebData (Range("B2").Value)
        Progress.Hide
    End If
End Sub 
```

我在这段代码中看到的是，当单元格 B2 更改时，进度指示器表单会弹出。我还看到 A 列中的单元格范围被清除，这告诉我 vbModeless 正在做我想做的事。但是，在 GetWebData() 过程中的某个地方，事情就挂了。一旦我手动销毁进度指示器表单，GetWebData() 例程就会完成，我会看到正确的结果。但是，如果我让进度指示器可见，事情就会无限期地卡住。

下面的代码显示了 GetWebData() 正在做什么。

```
Private Sub GetWebData(ByVal Symbol As String)
     Dim IE As New InternetExplorer
    'IE.Visible = True
    IE.navigate MyURL
    Do
        DoEvents
    Loop Until IE.readyState = READYSTATE_COMPLETE
    Dim Doc As HTMLDocument
    Set Doc = IE.document
    Dim Rows As IHTMLElementCollection
    Set Rows = Doc.getElementsByClassName("financialTable").Item(0).all.tags("tr")

    Dim r As Long
    r = 0
    For Each Row In Rows
        Sheet1.Range("A4").Offset(r, 0).Value = Row.Children.Item(0).innerText
        r = r + 1
    Next

End Sub 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-06T16:12:37.350

如果您不习惯使用 Excel Web Query，并且只希望在加载数据时显示进度条，则可以尝试将 URL 作为单独的工作簿打开。如果您这样做，Excel 会免费为您提供一个进度条。

请参阅我对这个问题的回答：[查询完成后，如何对 Excel Web 查询中的数据进行后处理？](https://stackoverflow.com/questions/32974553/how-can-i-post-process-the-data-from-an-excel-web-query-when-the-query-is-comple/32974554#32974554)

这种方法的权衡是您必须自己管理处理您取回的数据 - Excel 不会为您将其放入给定的目的地。

在我们尝试了与您似乎一直在做的非常相似的事情之后，我们最终选择了这条路线。

# version-control - Demo and live systems - code versioning strategy

> ID：13407520
> 
> 赞同：1
> 
> 时间：2012-11-15T22:41:31.270
> 
> 标签：version-control, architecture

Our company has a client/server product which we want to give the client out to customers to try out, against a test server with dummy data where all users default to a single dummy account.

To summarize the product, in a real world situation the server would be deployed on the customer's hosting environment, and the client app would be given out to the customer's own users. The client app uses SOAP web services to communicate with the server and we use mercurial for version control of both client and server codebases.

My interests as a developer are preserving maintainability of both codebases. I also believe the behavior of the client should be identical whether it receives dummy or live data. I need to be able to push bugfixes from the live back into the demo system. However I need the demo version to have specific behavior (for example, using a dummy account on the server that is populated with dummy data).

In order to try to reconcile these interests have branched the server codebase with hardcoded settings to show only dummy data and to force all logins to use the dummy account. The demo server is deployed to the cloud. We then have a client that is configured in the installer to point to this cloud server instance, and this is available for download to prospective customers to try out.

I am not sure if this is the best approach. Some have suggested I should hardcode the demo functionality into the live server code, and have it configurable with a hidden flag - this would avoid the need for a branched codebase altogether.

The reasoning behind my approach is that adding hard-coded demo behavior in to the live codebase just for a single deployment seems to me like a code smell. The branched server allows us to continue developing the server platform on the "live" branch and pushing bug fixes into the "demo server" branch, and the web service contract and client codebase remain unchanged.

To me this seems like a good separation because the at a high level, I believe the behavior of the client should be identical regardless of whether it is receiving live or dummy data from the server.

**My question is whether the wider dev community sees a problem with this approach or has a better strategy. Is my reasoning valid? What is best practice for managing the codebase for a demo system (with a dummy account/data) alongside a live system?**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T12:50:37.767

There are no valuable advantages there, only extra merging effort. If the difference between demo and live is not critical, I'd suggest maintaining a single codebase.

In order to customize demo behavior I'd suggest the following:

*   conditional code inclusion: `#ifdef DEMO ... #endif`. You have single codebase, you have "hardcoded" strings, but they wouldn't compile for live version.

*   runtime plugins, when you have somewhat interface `IDataProvider` and configure demo to use `DemoDataProvider`. You have single codebase, pluggable demo code, which you can exclude from live distribution.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:50:44.270

I unsderstand your point of view but branching will force you to merge branches to integrate changes in your demo. In my company we have several products using the same code base, a the beginning to save time we forked the codebases, but now we have trouble integrating evolutions and backporting evolutions in branches so instead we use compile time differenciation of the same code or runtime. So my advice (I m not the community :) ) is to not branch

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-21T16:44:40.290

I'm not sure what technology you are using, but in PHP we have the environment flag (testing, development, production). Using the env flag you can then have different runtime variables set to reflect the behavior of the system. You could tie a sub domain (say demo.yourdomain.com) to the env, set it and define how you want your system to behave (get data from a dummy database, for instance).

[http://php.net/manual/en/reserved.variables.environment.php](http://php.net/manual/en/reserved.variables.environment.php)

Hope it helps.

# regex-negation - 正则表达式 - 否定字符串

> ID：13407521
> 
> 赞同：0
> 
> 时间：2012-11-15T22:41:31.957
> 
> 标签：regex-negation

我有以下格式的文件

AAA
BBB
联赛="NFL"
联赛="CFB"
联赛="NBA"
联赛="CBK"
CCC
DDD

我只想列出包含 League 但不包含 NFL 或 NBA 的行。所以从上面，我只想要：

联赛="CFB"
联赛="CBK"

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T18:20:15.947

最后两个将被解释为 /League="[^NFLBA]"/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:49:03.320

你必须使用正则表达式吗？（是为了作业吗？）

如果没有，您可以读取文件并像这样过滤它：

```
BufferedReader in = new BufferedReader(new FileReader("filePath"));

String line = in.readLine();
List<String> myList = newArrayList<String>();

while(line != null){
    if ((line.startsWith("League")) && 
        (!line.contains("NFL")) && 
        (!line.contains("NBA"))){

           myList.add(line)

        }
 } 
```

填充包含文件中所有以 League 开头但不包含 NFL 或 NBA 的字符串的字符串列表。

在一行上使用正则表达式匹配这样做会很丑陋。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:44:26.503

像这样的东西应该工作：

```
/League="[^(NFL)|(NBA)]"/ 
```

# objective-c - 如何导入objective-c++文件

> ID：13407534
> 
> 赞同：0
> 
> 时间：2012-11-15T22:42:25.167
> 
> 标签：objective-c, objective-c++

我在可可项目中包含 .mm 文件时遇到问题。.mm 文件#includes .cpp 文件。如果我不#import 项目构建良好。但是，我需要#import .mm 文件，但是当我这样做时，我找不到“字符串”文件。如何使用 mm 文件而不出现该错误？

[这是该项目的链接](https://github.com/saltzmanjoelh/ObjCPPTest/tree/master/ObjCPPTest)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:48:14.310

不要将#import 与 .mm 文件一起使用。将其公共接口移动到 .h 文件中，然后将其导入**您**需要的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:02:10.503

原来我需要将定义 cpp ivar 的接口部分移动到实现文件 CPPWrapper.mm

```
@interface CPPWrapper ()
@property (nonatomic, readwrite, assign) Cpp *cpp;
@end

@implementation CPPWrapper
@synthesize cpp = _cpp;
//do stuff with cpp ivar here
@end 
```

# php - 从 php 解析结果中删除箭头和括号

> ID：13407536
> 
> 赞同：1
> 
> 时间：2012-11-15T22:42:30.783
> 
> 标签：php, regex

我正在尝试从输出中删除所有数组垃圾：

[http://freebesttickets.info/spinner.php](http://freebesttickets.info/spinner.php)

这样我就得到了一个带有一个 ID perline 的干净列表，而不是一堆混合了 ID 的箭头和括号

我的第一次尝试

```
<?php
$f = fopen ('http://fanpagelist.com/category/top_users/view/list/sort/fans/page1', 'r');
$page = '';
while ($line = fgets($f)) {
  $page .= $line;
}
fclose ($f);
preg_match_all('#(?:(?<=\bhref="/like_box\.php\?id=)|' .
                '(?<=\bsrc="https://graph\.facebook\.com/))\d+#i',
                $page, $result, PREG_PATTERN_ORDER);

print_r ($result);

?> 
```

我还尝试获取输出并将其粘贴到第二个文件中，并使用 reg 表达式删除括号之间的所有内容，但没有成功

```
<?php
$string = "[0] => Array 0] => 20531316728 [1] => 20531316728 [2] => 56531631380 [3] => 56531631380 [4] => 7270241753 [5] => 7270241753 [6] => 10092511675 [7] => 10092511675 [8] => 45309870078 [9] => 45309870078 [10] =>";

echo preg_replace("/\([^)]+\)/","",$string); // 'ABC '

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:52:13.780

或者更简单：

```
print implode("\n", $result[0]); 
```

代替[`print_r`](http://php.net/print_r).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:47:41.520

您最好的选择是遍历数组并以这种方式输出所有内容：

```
for($i=0;$i<$result.length,$i++){
    echo $result[$i];
    echo "<br/>";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:51:25.220

而不是通过它使用 print_r( $result ) 循环

```
foreach ( $result[0] as $id ) {
    echo $id . "\n";
} 
```

将为您提供每行一个 id 的干净列表（如果您在浏览器中打开它，请查看浏览器输出的源代码）

# c - C 错误预期标识符

> ID：13407537
> 
> 赞同：0
> 
> 时间：2012-11-15T22:42:37.927
> 
> 标签：c, compiler-errors

到目前为止，我一直在尝试测试我的代码，并且在编译测试运行时出现错误。

这是我的代码：

mips_op.h 文件

```
#ifndef MIPS_OP_H
#define MIPS_OP_H

typedef enum {
    R, I, J
} op_type;

typedef struct op_instr {
    op_type op_t; // instruction type {R, I, J}
    int opcode : 6; // instruction opcode - 6-bit integer

    // if the instruction type is J
    #if op_t == J

    int address : 26; // address to jump to - 26-bit integer

    #else // if the instruction type is R or I

    int rs : 5; // the output - 5-bit integer
    int rt : 5; // the first operand - 5-bit integer

        #if op_t == R // if instruction type is R

        int rd : 5; // the second operand - 5-bit integer
        int shamt : 5; // the shift amount field - 5-bit integer
        int funct : 6; // the function field

        #endif

        #if op_t == I // if instruction type is R

        int immediate : 16; // the immediate field - 16-bit integer

        #endif

    #endif
};

#endif 
```

这是 main.c 文件

```
#include <stdio.h>
#include "mips_op.h"

int main (void) {
    printf("Before instr\n");

    op_instr add;

    printf("After instr\n");

    return 0;
} 
```

这是我得到的错误

```
In file included from main.c:2:0:
mips_op.h:9:10: error: expected ')' before 'op_t'
main.c: In function 'main':
main.c:7:2: error: unknown type name 'op_instr' 
```

我的代码有什么问题？为什么我会收到此错误？

谢谢

编辑：将括号固定为大括号

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:46:26.687

我认为您使用 ( 而不是 { 围绕您的结构。还是我错了？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:46:38.200

将结构定义中的“（”替换为“{”

```
typedef struct op_instr
**{**
   ...
**}** 
```

编辑：你可能有这个[问题](http://softsolder.com/2009/10/06/arduino-be-careful-with-the-preprocessor/)

“基本上，普通 C 预处理器指令、普通 C 语言元素以及 Arduino IDE 和编译器链的高深莫测的内部结构之间存在复杂的交互。

据我所知，您可以将 #if 包装在简单的声明和大多数可执行代码周围而不受惩罚，但是在条件句中放置比这更复杂的东西，比如简单的 typedef 结构会导致奇怪的问题。

事实上，仅仅 typedef 就会导致问题，尤其是当您尝试在函数声明中使用随后的标记时。甚至不要考虑这些方面的任何事情：”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:48:37.763

您的直接问题是您使用 () 而不是 {} 作为结构范围。

正如 Paul R 所说，您似乎还有其他一些问题。

# linux - Linux 上真的没有异步块 I/O 吗？

> ID：13407542
> 
> 赞同：47
> 
> 时间：2012-11-15T22:43:04.837
> 
> 标签：linux, asynchronous, posix, overlapped-io, io-uring

考虑一个受 CPU 限制但也具有高性能 I/O 要求的应用程序。

我正在将 Linux 文件 I/O 与 Windows 进行比较，我根本看不出 epoll 将如何帮助 Linux 程序。内核会告诉我文件描述符“准备好读取”，但我仍然必须调用阻塞 read() 来获取我的数据，如果我想读取兆字节，很明显这会阻塞。

在 Windows 上，我可以创建一个设置了 OVERLAPPED 的文件句柄，然后使用非阻塞 I/O，并在 I/O 完成时收到通知，并使用该完成函数中的数据。我不需要花费应用程序级的挂钟时间来等待数据，这意味着我可以将线程数精确调整到我的内核数，并获得 100% 的有效 CPU 利用率。

如果我必须在 Linux 上模拟异步 I/O，那么我必须分配一些线程来执行此操作，而这些线程将花费一些时间来处理 CPU 的事情，并且会花费大量时间阻塞 I/O，另外，与这些线程之间的消息传递也会产生开销。因此，我将过度订阅或未充分利用我的 CPU 内核。

我将 mmap() + madvise() (WILLNEED) 视为“穷人的异步 I/O”，但它仍然没有到达那里，因为完成后我无法收到通知——我有“猜”，如果我猜“错”了，我最终会阻塞内存访问，等待数据来自磁盘。

Linux 似乎在 io_submit 中有异步 I/O 的开始，而且它似乎也有一个用户空间 POSIX aio 实现，但是这种方式已经有一段时间了，我知道没有人会为这些系统的关键性担保, 高性能应用。

Windows 模型的工作原理大致如下：

1.  发出异步操作。
2.  将异步操作绑定到特定的 I/O 完成端口。
3.  等待该端口上的操作完成
4.  当 I/O 完成时，等待端口的线程解除阻塞，并返回对挂起的 I/O 操作的引用。

步骤 1/2 通常作为一件事情完成。步骤 3/4 通常使用工作线程池完成，而不是（必然）与发出 I/O 的线程相同。这个模型有点类似于 boost::asio 提供的模型，除了 boost::asio 实际上并没有给你异步的基于块的（磁盘）I/O。

与 Linux 中的 epoll 不同的是，在第 4 步中，还没有发生任何 I/O——它将第 1 步提升到第 4 步之后，如果您已经确切知道自己需要什么，那么这是“倒退”。

在编写了大量嵌入式、桌面和服务器操作系统之后，我可以说这种异步 I/O 模型对于某些类型的程序来说是非常自然的。它也是非常高吞吐量和低开销的。我认为这是 Linux I/O 模型在 API 级别上剩下的真正缺点之一。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2019-08-11T16:04:07.737

(2020) 如果您使用的是[5.1 或更高版本的 Linux 内核](https://kernelnewbies.org/Linux_5.1#High-performance_asynchronous_I.2FO_with_io_uring)，您可以使用该[`io_uring`接口](https://lwn.net/Articles/776703/)进行类文件 I/O 并获得出色的异步操作。

与现有的`libaio`/KAIO接口相比，`io_uring`具有以下优点：

*   在执行缓冲 I/O 时保留异步行为（而不仅仅是在执行直接 I/O 时）
*   更易于使用（尤其是在使用[`liburing`](https://github.com/axboe/liburing)辅助库时）
*   可以选择以轮询方式工作（但您需要更高的权限才能启用此模式）
*   减少每个 I/O 的簿记空间开销
*   由于更少的用户空间/内核系统调用模式切换（由于[幽灵/熔毁缓解的影响，](http://www.brendangregg.com/blog/2018-02-09/kpti-kaiser-meltdown-performance.html)这些天很重要） ，从而降低了 CPU 开销
*   可以预先注册文件描述符和缓冲区以节省映射/取消映射时间
*   更快（可以实现更高的总吞吐量，I/O 具有更低的延迟）
*   “链接模式”可以表达 I/O 之间的依赖关系（>=5.3 内核）
*   可以使用基于套接字的 I/O（从 >=5.3 开始支持[`recvmsg()`](https://github.com/torvalds/linux/commit/aa1fa28fc73ea6b740ee7b62bf3b07141883dbb8)/ ，请参阅[io_uring.c 的 git 历史](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/fs/io_uring.c)中提到支持一词的消息）[`sendmsg()`](https://github.com/torvalds/linux/commit/0fa03c624d8fc9932d0f27c39a9deca6a37e0e17)
*   支持尝试取消排队的 I/O (>=5.5)
*   当内联提交路径触发阻塞时，可以请求*始终*从异步上下文执行 I/O，而不是仅退回到将 I/O 插入异步上下文的默认设置（>=5.6 内核）
*   越来越多[地支持执行超出`read`/`write`](https://github.com/torvalds/linux/blob/v5.8/include/uapi/linux/io_uring.h#L98)的异步操作（例如`fsync`(>=5.1)、`fallocate`(>=5.6)、`splice`(>=5.7) 等等）
*   更高的发展动力
*   [每次星星不完全对齐时都不会阻塞](https://stackoverflow.com/a/46377629/2732969)

与 glibc 的 POSIX AIO 相比，`io_uring`具有以下优点：

*   **更快，更高效（上面的较低开销优势在这里更适用**）****
***   接口由内核支持，不使用用户空间线程池*   执行缓冲 I/O 时生成的数据副本较少*   不要[与信号搏斗](http://davmac.org/davpage/linux/async-io.html#posixaio)*   [Glibc 的 POSIX AIO 不能在单个文件描述符上运行多个 I/O，](https://github.com/bminor/glibc/blob/glibc-2.30/sysdeps/pthread/aio_misc.c#L360)而`io_uring`大多数情况下可以！**

 **[Efficient IO with io_uring](http://kernel.dk/io_uring.pdf)文档更详细地介绍了IO的`io_uring`好处和用法。[What's new with io_uring](https://kernel.dk/io_uring-whatsnew.pdf)文档描述了`io_uring`自成立以来添加的新功能，而io_uring [LWN 的快速增长文章](https://lwn.net/Articles/810414/)描述了 5.1 - 5.5 内核中的每个内核中可用的功能，并展望了 5.6 中的内容（也请参阅[LWN 的 io_uring](https://lwn.net/Kernel/Index/#io_uring)文章列表）。还有作者 Jens Axboe从 2019 年底开始的[“通过 io_uring 实现更快的 IO”视频演示](https://youtu.be/-5T4Cjw46ys)（[幻灯片）。](https://www.slideshare.net/ennael/kernel-recipes-2019-faster-io-through-iouring)`io_uring`最后，[io_uring教程之主对](https://unixism.net/loti/index.html)用法进行了介绍`io_uring`。

`io_uring`可以通过 io_uring 邮件列表访问社区，[io_uring](http://vger.kernel.org/vger-lists.html#io-uring)邮件[列表存档](https://lore.kernel.org/io-uring/)显示 2021 年初的每日流量。

`recv()`重新“支持vs意义上的部分 I/O `read()`”：一个[补丁进入 5.3 内核，将自动重试`io_uring`短读取](https://github.com/torvalds/linux/commit/9d93a3f5a0c0d0f79aebc597d47c7cedc852aeb5)，进一步提交进入 5.4 内核，调整行为以[仅在工作时自动处理短读取在未设置`REQ_F_NOWAIT`标志的请求上使用“常规”文件](https://github.com/torvalds/linux/commit/491381ce07ca57f68c49c79a8a43da5b60749e32)（看起来您可以`REQ_F_NOWAIT`通过`IOCB_NOWAIT`或通过打开文件来请求`O_NONBLOCK`）。因此，您也可以从中获得`recv()`风格 - “短” I/O 行为`io_uring`。

### 软件/项目使用`io_uring`

尽管界面还很年轻（它的第一个版本于 2019 年 5 月问世），但一些开源软件正在`io_uring`“在野外”使用：

*   [fio](https://github.com/axboe/fio)（也由 Jens Axboe 编写）有一个[io_uring ioengine](https://fio.readthedocs.io/en/latest/fio_man.html#i-o-engine)后端（实际上它是从 2019 年 2 月开始在 fio-3.13 中引入的！）。两位英特尔工程师在“[使用新的 Linux 内核 I/O 接口 SNIA 演示文稿提高存储性能](https://www.youtube.com/watch?v=vjudg0lCEhQ)”（[幻灯片](https://www.snia.org/sites/default/files/SDC/2019/presentations/Storage_Performance/Kariuki_John_Verma_Vishal_Improved_Storage_Performance_Using_the_New_Linux_Kernel_I.O_Interface.pdf)）中指出，他们能够在一个工作负载上获得双倍的 IOPS，而在队列深度为 1 时，平均延迟不到一半。将 ioengine与 Optane 设备上的`io_uring`ioengine进行比较时的另一个工作负载。`libaio`
*   [SPDK 项目在其 v19.04 版本中添加了对使用 io_uring](https://github.com/spdk/spdk/commit/dfb60590c9f869d5911018ff948a53657a9f2f2c) (!) 进行块设备访问的支持（但显然这不是您通常将 SPDK 用于基准测试之外的后端）。最近，他们似乎还增加了对在 v20.04 中将[其与套接字一起使用的支持......](https://github.com/spdk/spdk/commit/dfb60590c9f869d5911018ff948a53657a9f2f2c)
*   [Ceph 在 2019 年 12 月提交了一个 io_uring 后端](https://github.com/ceph/ceph/commit/2268be9ff9d2035c942f6a19779e254f317347ba)，这是其 15.1.0 版本的一部分。提交作者发布了一条 github 评论，显示一些[io_uring 后端与 libaio 后端相比](https://github.com/ceph/ceph/pull/27392#issuecomment-536675114)（在 IOPS、带宽和延迟方面）根据工作负载而有所不同。
*   [RocksDB 于 2019 年 12 月提交了`io_uring`MultiRead 的后端，](https://github.com/facebook/rocksdb/commit/e3a82bb9345220c85894aaa67ccf95bd9eadd4a2)并且是其[6.7.3 版本](https://github.com/facebook/rocksdb/releases/tag/v6.7.3)的一部分。Jens 状态[`io_uring`有助于显着减少延迟](https://twitter.com/axboe/status/1173962426783453184)。
*   [libev 于 2019 年 12 月发布了带有初始`io_uring`后端](http://lists.schmorp.de/pipermail/libev/2019q4/002841.html)的 4.31。虽然作者的一些原始观点已在较新的内核中得到解决，但在撰写本文时（2021 年年中），[libev 的作者对`io_uring`' 的成熟度](http://lists.schmorp.de/pipermail/libev/2021q2/002905.html)有一些选择，并且正在等待- 在实施进一步改进之前查看方法。
*   [QEMU 在 2020 年 1 月提交了一个 io_uring 后端](https://github.com/qemu/qemu/search?o=asc&q=io_uring&s=committer-date&type=Commits)，并且是[QEMU 5.0 版本](https://wiki.qemu.org/ChangeLog/5.0)的一部分。在“ [QEMU 中的 io_uring：Linux 的高性能磁盘 IO](https://fosdem.org/2020/schedule/event/vai_io_uring_in_qemu/attachments/slides/4145/export/events/attachments/vai_io_uring_in_qemu/slides/4145/io_uring_fosdem.pdf) ”PDF 演示文稿中，Julia Suvorova 展示了后端在一个随机 16K 块的工作负载上的`io_uring`性能优于`threads`和后端。`aio`
*   [Samba 于 2020 年 2 月合并了一个`io_uring`VFS 后端](https://gitlab.com/samba-team/samba/-/commit/195e88cea34c983afc02cfb521a60cdd1edbe9e1)，并且是[Samba 4.12 版本](https://wiki.samba.org/index.php/Samba_4.12_Features_added/changed#.27io_uring.27_vfs_module)的一部分。在[“Linux io_uring VFS 后端”中。](https://lists.samba.org/archive/samba-technical/2020-February/134809.html)Samba 邮件列表线程 Stefan Metzmacher（提交作者）表示，该`io_uring`模块在综合测试中能够将吞吐量提高大约 19%（与某些未指定的后端相比）。您还可以阅读 Stefan 的[“Async VFS Future”](https://www.snia.org/sites/default/files/SDC/2019/presentations/SMB/Metzmacher_Stefan_Samba_Async_VFS_Future.pdf) PDF 演示文稿，了解更改背后的一些动机。
*   [Facebook 的实验性 C++ libunifex](https://github.com/facebookexperimental/libunifex)使用它（但您还需要 5.6+ 内核）
*   rust 的人一直在编写包装器以使`io_uring`纯 rust 更容易访问。[rio](https://github.com/spacejam/rio)是一个被讨论过的库，作者说[与使用包裹在线程中的同步调用相比，它们实现了更高的吞吐量](https://twitter.com/sadisticsystems/status/1213216307358961671)。作者在 FOSDEM 2020[上介绍了他的数据库和库](https://fosdem.org/2020/schedule/event/rust_techniques_sled/)，其中包括颂扬`io_uring`.
*   rust库[glommio](https://github.com/DataDog/glommio)专门使用`io_uring`. 作者 (Glauber Costa) 发表了一篇名为[Modern storage is enough fast 的文档。糟糕的 API 表明](https://itnext.io/modern-storage-is-plenty-fast-it-is-the-apis-that-are-bad-6a68319fbc1a)`io_uring`，在 Optane 设备上执行顺序 I/O 时，通过仔细调整 glommio 可以获得超过常规（非）系统调用的 2.5 倍以上的性能。
*   [Gluster 于 2020 年 10 月合并了一个 io_uring posix xlator](https://github.com/gluster/glusterfs/commit/4b9f95b6993b606b2f97d55694910c2cbe3107a2)，并且是[Gluster 9.0 版本](https://docs.gluster.org/en/latest/release-notes/9.0/)的一部分。提交作者提到性能“并不比常规的 pwrite/pread 系统调用差”。

### 软件调查使用`io_uring`

*   PostgreSQL 开发人员 Andres Freund 一直是`io_uring`改进背后的驱动力之一（例如[，减少文件系统 inode 争用的解决方法](https://lore.kernel.org/linux-block/20190910164245.14625-1-axboe@kernel.dk/T/)）。有一个演示文稿[“Asynchronous IO for PostgreSQL”](https://anarazel.de/talks/2020-05-28-pgcon-aio/2020-05-28-pgcon-aio-x264.mp4)（请注意视频在 5 分钟之前被破坏）（[PDF](https://anarazel.de/talks/2020-05-28-pgcon-aio/2020-05-28-pgcon-aio.pdf)）激发了对 PostgreSQL 更改的需求并展示了一些实验结果。他表示[希望将他的可选`io_uring`支持纳入 PostgreSQL 14](https://news.ycombinator.com/item?id=22512952)，并且似乎敏锐地意识到甚至在内核级别上什么可以工作，什么不能工作。2020 年 12 月，[Andres 进一步讨论了他的 PostgreSQL`io_uring`工作](https://www.postgresql.org/message-id/flat/20201208040227.7rlzpfpdxoau4pvd%40alap3.anarazel.de#b8ea4a3b7f37e88ddfe121c4b3075e7b)在“阻塞 I/O、异步 I/O 和 io_uring”pgsql-hackers 邮件列表线程中，提到正在进行的工作可以在[https://github.com/anarazel/postgres/tree/aio](https://github.com/anarazel/postgres/tree/aio)中看到。
*   [Netty 项目有一个孵化器仓库，`io_uring`](https://github.com/netty/netty-incubator-transport-io_uring)它需要一个 5.9 内核的[支持](https://github.com/netty/netty-incubator-transport-io_uring)
*   [libuv 有一个拉取请求，反对它增加`io_uring`支持](https://github.com/libuv/libuv/pull/2322)，但它在项目中的进展一直很慢
*   [SwiftNIO 在 2020 年 4 月增加`io_uring`了对事件](https://github.com/apple/swift-nio/commit/8ea0afb4c43cc671e306b011f425defb69629760)（但不包括系统调用）和[Linux：full io_uring I/O](https://github.com/apple/swift-nio/issues/1831)问题的支持，概述了进一步集成它的计划
*   Tokio Rust 项目开发了一个概念证明[tokio-uring](https://github.com/tokio-rs/tokio-uring)

## Linux 发行版支持`io_uring`

*   （2020 年末）Ubuntu 18.04 的最新 HWE 启用内核是 5.4，因此`io_uring`可以使用系统调用。此发行版没有预先打包`liburing`帮助程序库，但您可以自己构建它。
*   Ubuntu 20.04 的初始内核是 5.4，因此`io_uring`可以使用系统调用。如上所述，发行版没有预先打包`liburing`.
*   Fedora 32 的初始内核是 5.6 **，**它有一个打包好的`liburing`可用`io_uring`的。
*   [SLES 15 SP2 具有 5.3 内核](https://www.suse.com/support/kb/doc/?id=000019587)，因此`io_uring`可以使用系统调用。此发行版没有预先打包`liburing`帮助程序库，但您可以自己构建它。
*   （2021 年中）RHEL 8 的默认内核**不**支持`io_uring`（此答案的先前版本错误地表示支持）。根据[添加 io_uring 支持 Red Hat 知识库文章](https://access.redhat.com/solutions/4723221)（内容在订阅者付费墙后面）正在向后移植 `io_uring` 到默认的 RHEL 8 内核。

* * *

希望`io_uring`能为 Linux 带来更好的异步文件式 I/O 故事。

（为了给这个答案增加一层可信度，在过去的某个时候，Jens Axboe（Linux 内核块层维护者和发明者`io_uring`）[认为这个答案可能值得支持](https://twitter.com/Urhengula5/status/1252847692197228546):-)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-02-20T17:39:41.023

Peter Teoh 间接指出的真正答案是基于 io_setup() 和 io_submit()。具体来说，Peter 指出的“aio_”函数是基于线程的 glibc 用户级仿真的一部分，这不是一个高效的实现。真正的答案在：

```
io_submit(2)
io_setup(2)
io_cancel(2)
io_destroy(2)
io_getevents(2) 
```

请注意，日期为 2012-08 的手册页说，此实现尚未成熟到可以取代 glibc 用户空间仿真的程度：

[http://man7.org/linux/man-pages/man7/aio.7.html](http://man7.org/linux/man-pages/man7/aio.7.html)

> 这个实现还没有成熟到可以使用内核系统调用完全重新实现 POSIX AIO 实现的程度。

因此，根据我能找到的最新内核文档，Linux 还没有成熟的、基于内核的异步 I/O 模型。而且，如果我假设文档模型实际上已经成熟，它仍然不支持 recv() 与 read() 意义上的部分 I/O。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-17T04:24:53.933

如中所述：

[http://code.google.com/p/kernel/wiki/AIOUserGuide](http://code.google.com/p/kernel/wiki/AIOUserGuide)

和这里：

[http://www.ibm.com/developerworks/library/l-async/](http://www.ibm.com/developerworks/library/l-async/)

Linux 确实在内核级别提供了异步块 I/O，API 如下：

```
aio_read    Request an asynchronous read operation
aio_error   Check the status of an asynchronous request
aio_return  Get the return status of a completed asynchronous request
aio_write   Request an asynchronous operation
aio_suspend Suspend the calling process until one or more asynchronous requests have completed (or failed)
aio_cancel  Cancel an asynchronous I/O request
lio_listio  Initiate a list of I/O operations 
```

如果你问谁是这些 API 的用户，那就是内核本身——这里只显示了一小部分：

```
./drivers/net/tun.c (for network tunnelling):
static ssize_t tun_chr_aio_read(struct kiocb *iocb, const struct iovec *iv,

./drivers/usb/gadget/inode.c:
ep_aio_read(struct kiocb *iocb, const struct iovec *iov,

./net/socket.c (general socket programming):
static ssize_t sock_aio_read(struct kiocb *iocb, const struct iovec *iov,

./mm/filemap.c (mmap of files):
generic_file_aio_read(struct kiocb *iocb, const struct iovec *iov,

./mm/shmem.c:
static ssize_t shmem_file_aio_read(struct kiocb *iocb, 
```

等等

在用户空间级别，还有 io_submit() 等 API（来自 glibc），但以下文章提供了使用 glibc 的替代方法：

[http://www.fsl.cs.sunysb.edu/~vass/linux-aio.txt](http://www.fsl.cs.sunysb.edu/~vass/linux-aio.txt)

它直接将 io_setup() 等函数的 API 实现为直接系统调用（绕过 glibc 依赖项），应该存在通过相同“__NR_io_setup”签名的内核映射。在以下位置搜索内核源代码时：

[http://lxr.free-electrons.com/source/include/linux/syscalls.h#L474](http://lxr.free-electrons.com/source/include/linux/syscalls.h#L474) （URL 适用于最新版本 3.13）您会看到这些 io_*() API 在内核中的直接实现：

```
474 asmlinkage long sys_io_setup(unsigned nr_reqs, aio_context_t __user *ctx);
475 asmlinkage long sys_io_destroy(aio_context_t ctx);
476 asmlinkage long sys_io_getevents(aio_context_t ctx_id,
481 asmlinkage long sys_io_submit(aio_context_t, long,
483 asmlinkage long sys_io_cancel(aio_context_t ctx_id, struct iocb __user *iocb, 
```

更高版本的 glibc 应该使这些使用“syscall()”来调用 sys_io_setup() 变得不必要，但是如果没有最新版本的 glibc，如果您使用具有“sys_io_setup”这些功能的更高版本的内核，您始终可以自己进行这些调用()”。

当然，还有其他用于异步 I/O 的用户空间选项（例如，使用信号？）：

[http://personal.denison.edu/~bressoud/cs375-s13/supplements/linux_altIO.pdf](http://personal.denison.edu/~bressoud/cs375-s13/supplements/linux_altIO.pdf)

或者也许：

[POSIX 异步 I/O (AIO) 的现状如何？](https://stackoverflow.com/questions/87892/what-is-the-status-of-posix-asynchronous-i-o-aio?rq=1)

“io_submit”和朋友在 glibc 中仍然不可用（请参阅 io_submit 手册页），我已经在我的 Ubuntu 14.04 中验证了这一点，但这个 API 是特定于 linux 的。

其他像 libuv、libev 和 libevent 也是异步 API：

[http://nikhilm.github.io/uvbook/filesystem.html#reading-writing-files](http://nikhilm.github.io/uvbook/filesystem.html#reading-writing-files)

[http://software.schmorp.de/pkg/libev.html](http://software.schmorp.de/pkg/libev.html)

[http://libevent.org/](http://libevent.org/)

所有这些 API 旨在跨 BSD、Linux、MacOSX 甚至 Windows 移植。

在性能方面我没有看到任何数字，但怀疑 libuv 可能是最快的，因为它的轻量级？

[https://ghc.haskell.org/trac/ghc/ticket/8400](https://ghc.haskell.org/trac/ghc/ticket/8400)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T01:41:28.293

对于网络套接字 i/o，当它“准备好”时，它不会阻塞。这就是`O_NONBLOCK`“准备好”的意思。

对于磁盘 i/o，我们有[posix aio](http://www.kernel.org/doc/man-pages/online/pages/man7/aio.7.html)、[linux aio](http://www.kernel.org/doc/man-pages/online/pages/man2/io_submit.2.html)、[sendfile](http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html)和朋友。**

# c# - 为树设置边界（数据结构）

> ID：13407543
> 
> 赞同：0
> 
> 时间：2012-11-15T22:43:08.573
> 
> 标签：c#, wpf, algorithm

我们正在处理一个项目，该项目涉及一些基于树/森林算法的编码工作。

考虑在 2D 图形环境中，您正在绘制一组线 AB、BC 和 CD。这三个线段在 B 点和 C 点连接。

![在此处输入图像描述](../Images/6dec653b3889e63ae0518d20fa92e599.png)

让我们想象一下，AB 和 BC 是水平的，而 CD 是垂直的。

现在，如果我将 AB 旋转 90 度（逆时针），其余的线必须遵循相同的旋转度数。现在在我们的代码中 AB 和 BC 工作正常，但是当涉及到 CD 时，它并没有遵循其余的行。

所以期待一些东西：

![在此处输入图像描述](../Images/79d291c38499064749f3685b451a128c.png)

似乎我们需要一种递归方法，但不确定我们必须在这里考虑什么样的边界，因为 CD 可能最终会在其末尾获得另一行，例如 DE，因此添加一个布尔标志作为“bLastLine”在这里无济于事。

那么我们如何才能知道一行何时结束呢？事实上，我需要知道如何为树分配边界。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:15:00.393

好的，所以我要在这里冒险了。您有节点（A、B、C、D），并且它们之间有线段。这可以被认为是一个 Graph(V,E)，它可能比树更适合你。

现在对于 WPF：

您的 Vertex 类将具有 ObservableCollection 类型的 Edges 属性 您的 Vertex 类将具有 Point 类型的 Point 属性。您的 Edge 类将具有 ObservableCollection 类型的 Vertices 属性，该属性将为 2。

您的 ViewModel 将包含您将绑定到的所有边和所有顶点的列表。

您的视图会将您的边缘数据模板化为一条线。在 DataTemplate 中，您将钻入边缘上的两个顶点以获得线的任一端。（你可以为你的顶点使用一个小椭圆。）

现在为数学：

```
private static Point[] Translate(Point[] points, double tX, double tY)
{
    return points.Select(p => new Point(p.X + tX, p.Y + tY)).ToArray();
}

private static Point[] Rotate(Point[] points, double theta)
{
    return points.Select(p =>
                        new Point(p.X * Math.Cos(theta) - p.Y * Math.Sin(theta),
                                    p.X * Math.Sin(theta) + p.Y * Math.Cos(theta)))
                    .ToArray();
}

public Point[] RotatePointsAroundPoint(Point[] points, Point origin, double theta)
{
    var tPoints = Translate(points, -origin.X, -origin.Y);
    tPoints = Rotate(tPoints, theta);
    return Translate(tPoints, origin.X, origin.Y);
}

public void RotateGraph(Vertex[] vertices, Point origin, double theta)
{
    var points = vertices.Select(v => v.Point).ToArray();

    var tPoints = RotatePointsAroundPoint(points, origin, theta);

    for(var i = 0; i < vertices.Length; i++)
        vertices[i].Point = tPoints[i]; 
} 
```

有了这个，您只需要确定原点和旋转度数。一旦你调用了 setter `Vertex.Point`，`NotifyPropertyChanged`事件就会更新`View`.

# javascript - 为什么 JavaScript 中的 null 大于 -1，小于 1，但不等于（==）0？那究竟是什么？

> ID：13407544
> 
> 赞同：59
> 
> 时间：2012-11-15T22:43:10.450
> 
> 标签：javascript

从谷歌浏览器控制台：

```
var x = null;
undefined
x > 0
false
x < 0
false
x > -1
true
x < 1
true
x == 1
false
x === 1
false 
```

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-11-15T22:45:58.857

当您将 null 的相等性与 0 进行比较时，结果为 false。如果您强制`null`在数字上下文中进行解释，则将其视为 0 并且结果为真。

`+`您可以通过放在前面或使用数字运算符（如`<`、`<=`、`>`和）来强制它为数字`>=`。注意如何`null >= 0`和`null <= 0`都是真的。

```
> null == 0
false
> +null == 0
true
> null >= 0
true
> null <= 0
true 
```

* * *

[ECMAScript 语言规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)定义了何时执行所谓的“ToNumber”转换。如果是，则 null 和 false 都转换为 0。

> ### [§9.1 类型转换和测试](http://interglacial.com/javascript_spec/a-9.html#a-9.3)：
> 
> 表 14 - 编号转换
> 
> ```
> 参数类型结果
> ------------- ------
> 未定义返回 NaN
> 空              返回 +0
> Boolean 如果参数为真，则返回 1。如果参数为假，则返回 +0。
> Number 返回参数（无转换）。
> 字符串 请参阅下面的语法和注释。
> 
> ```

知道何时应用 ToNumber 转换取决于所讨论的运算符。对于关系运算符`<`、`<=`、`>`和，`>=`请参阅：

> ### [§11.8.5 抽象关系比较算法](http://interglacial.com/javascript_spec/a-11.html#a-11.8.5)：
> 
> 比较`x < y`，其中 x 和 y 是值，产生**true**、**false**或**undefined**（这表明至少一个操作数是**NaN**）。如下进行这样的比较：
> 
> 1.  调用 ToPrimitive(x, 提示号)。
>     
>     
> 2.  调用 ToPrimitive(y, 提示号)。
>     
>     
> 3.  如果 Type(Result(1)) 是 String 并且 Type(Result(2)) 是 String，则转到步骤 16。（请注意，此步骤与加法运算符 + 算法中的步骤 7 不同，它使用 and 而不是 or。 )
>     
>     
> 4.  呼叫号码（结果（1））。
>     
>     
> 5.  呼叫号码（结果（2））。

`==`运营商不一样。其类型转换如下所述。注意 null 和 false 如何遵循不同的规则。

> ### [§11.9.3 抽象等式比较算法](http://interglacial.com/javascript_spec/a-11.html#a-11.9.3)
> 
> 比较 x == y，其中 x 和 y 是值，产生**true**或 **false**。如下进行这样的比较：
> 
> 1\. 如果 Type(x) 与 Type(y) 不同，则执行第 14 步。
> 
> ...
> 
> 14\. 如果 x 为**null**且 y**未定义**，则返回**true**。
> 
> 15\. 如果 x**未定义**且 y 为**null**，则返回**true**。
> 
> 16.如果Type(x)是Number，Type(y)是String，返回比较结果x == ToNumber(y)。
> 
> 17\. 如果 Type(x) 是 String，Type(y) 是 Number，返回比较结果 ToNumber(x) == y。
> 
> 18\. 如果 Type(x) 是 Boolean，则返回比较结果 ToNumber(x) == y。
> 
> 19\. 如果 Type(y) 为 Boolean，则返回比较结果 x == ToNumber(y)。
> 
> 20\. 如果 Type(x) 是 String 或 Number 且 Type(y) 是 Object，则返回比较结果 x == ToPrimitive(y)。
> 
> 21\. 如果 Type(x) 是 Object 并且 Type(y) 是 String 或 Number，则返回比较结果 ToPrimitive(x) == y。
> 
> 22.返回**假**。

如果你仔细阅读，你就会明白为什么`false == 0`是真的但是`null == 0`假的。

*   对于`false == 0`，Type(x) 是布尔值。这意味着应用了 Step 18 的类型转换，并将 false 转换为数字。ToNumber(false) 为 0，`0 == 0`为真，所以比较成功。

*   对于`null == 0`，Type(x) 为 Null。没有任何类型检查匹配，因此比较进入第 22 步，该步骤返回 false。比较失败。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-15T22:46:51.007

null 作为数字转换为 0：`(+null)`为 0。 > 和 < 将 null 转换为该值，因此与数字相比，它充当零。`==`不会将 null 转换为数字，因此`null == 0`为 false。

# php - 来自 PHP 提交/发布的 PERL 参数

> ID：13407546
> 
> 赞同：2
> 
> 时间：2012-11-15T22:43:34.137
> 
> 标签：php, perl, apache

> **可能重复：**
> [HTML 表单 POST 到 python 脚本？](https://stackoverflow.com/questions/3862788/html-form-post-to-a-python-script)

所以我有一个使用命令行参数的 perl 脚本，例如：

./gen_cards_md5.pl --num_cards=1000 --num_seeds=10

我正在尝试构建一个 php 网页来调用上述脚本并将其传递给表单上的参数输入并提交，这大致是我所拥有的：

```
echo <<<_END
<html>
    <head>
        <title>Generate Card Numbers Test</title>
    </head>
    <body>
    Number of Cards: $num_cards<br />
    Number of Seeds: $num_seeds<br />
    <form method="post" action="gen_cards_md5.pl">
        Enter number of Cards to generate: <input type="text" name="num_cards" /> <br />
        Enter Number of Seeds: <input type="text" name="num_seeds" /> <br />
        <input type="submit" name="params" value="params"/>
    </form>
    </body>
</html>
_END; 
```

所以你可能会猜到我要去哪里，php正在调用perl，但它没有传递命令行参数。有没有一种简单的方法来查看什么（如果有任何东西被传递），或者有人足够了解告诉我我需要如何“格式化”帖子以将其放入 Perl 脚本？请注意，我只是在学习 Python，实际上我什至不是 php 和 perl 的黑客，所以我真的很想知道如何查看正在发生的事情并能够回答我自己的问题，但是为了节省时间，我只需要使用这个大的 honkin 'perl 脚本并让它从输入通过我的 HTML 页面运行。既然我已经说过了，我在想自己是否需要将其设为 .php？我只是通过不将 HTML 直接转换为 Perl 使事情变得更复杂吗？我离题了，重申一下；给定一个接受命令行参数的工作 perl 脚本，我如何通过 Web 界面传递它在命令行中所期望的参数？蒂亚！J.P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:06:26.837

```
<form method="post" action="somephpfile.php"> 
```

.

```
if (count($_POST) > 0){
     $num_cards = (isset($_POST['num_cards'])) ? (int)$_POST['num_cards'] : false;
     $num_seeds = (isset($_POST['num_seeds'])) ? (int)$_POST['num_seeds'] : false;
     if($num_cards !== false && $num_seeds !== false){
        exec("./gen_cards_md5.pl --num_cards={$num_cards} --num_seeds={$num_seeds}", $outputArray);
     }else{
         die('Number of cards or number of seeds not provided.');
     }
} 
```

# javascript - 如何检测浏览器模式是否在 IE9 的“Internet Explorer 9 兼容性视图”中？

> ID：13407552
> 
> 赞同：3
> 
> 时间：2012-11-15T22:44:00.203
> 
> 标签：javascript, internet-explorer-9

我使用 javascript 脚本使用偏移量对齐某些元素。偏移量的计算取决于浏览器类型，因为它们的行为不同。在 IE9 中，获取 DOM 中的子元素或计算某些偏移量，如果 IE9 处于 IE9 浏览器模式或 IE9 兼容视图浏览器模式，则行为会有所不同。

如何检测浏览器模式是否处于“Internet Explorer 9 兼容性视图”中？此模式由用户在开发者工具 (F12) 浏览器模式菜单选项中设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:55:07.993

可以肯定的是，我正在运行 Linux，而我的虚拟映像刚刚损坏：

```
if (document.all && document.documentMode === 8 && !document.addEventListener) {
    // IE9/IE10 in compatibility mode as IE8
} 
```

在 UA 上：

[https://stackoverflow.com/a/12183662/887539](https://stackoverflow.com/a/12183662/887539)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:47:45.540

我不记得我从哪里得到这个代码，但基本上 IE8 及更高版本在文档上有一个名为“documentMode”的属性。如果存在，但您将 IE7 视为浏览器，则可以放心地假定您处于兼容模式。

[文档模式说明](http://msdn.microsoft.com/en-us/library/ie/cc196988%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:50:27.110

在 IE7 兼容模式下运行时，IE9 的用户代理字符串可能会有所不同，因此这将是找出不同 IE 版本之间差异的最佳方法之一。

您可以在此处阅读有关此内容的更多信息：http: [//blogs.msdn.com/b/ie/archive/2010/03/23/introducing-ie9-s-user-agent-string.aspx](http://blogs.msdn.com/b/ie/archive/2010/03/23/introducing-ie9-s-user-agent-string.aspx)

# java - 正则表达式java如何加2值？

> ID：13407553
> 
> 赞同：0
> 
> 时间：2012-11-15T22:44:01.980
> 
> 标签：java, regex

如何解析和添加两个值？我使用这种模式：

```
String s = "6 + 7 ="; 
```

包括间距，我需要得到“13”

可以使用正则表达式，还是有其他方法可以轻松做到这一点？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:50:22.277

如果你想使用正则表达式，你可以这样做：

```
Pattern pattern = Pattern.compile("(\\d+)\\s*\\+\\s*(\\d+)\\s*=");
Matcher matcher = pattern.matcher("6 + 7 =");
if (matcher.matches()) {
    System.out.println(Integer.valueOf(matcher.group(1)) + Integer.valueOf(matcher.group(2)));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:52:29.210

它必须是正则表达式吗？如果没有，您可以使用 JavaScript 引擎（自 Java 1.6 起）从 String 进行计算，例如：

```
ScriptEngineManager factory = new ScriptEngineManager();
// create a JavaScript engine
ScriptEngine engine = factory.getEngineByName("JavaScript");

Double d=(Double)engine.eval("1 + 2 * 3");
System.out.println(d); 
```

# python - 如何在亚马逊 EC2 上调试 python 网站？

> ID：13407554
> 
> 赞同：3
> 
> 时间：2012-11-15T22:44:03.187
> 
> 标签：python, django, amazon-s3, amazon-web-services, amazon-ec2

我是网络开发的新手。这可能是一个愚蠢的问题，但我找不到可以帮助我的确切答案或教程。我工作的公司的站点（内置于 python django 中）托管在亚马逊 EC2 上。我想知道我可以从哪里开始调试这个生产站点并检查存储在那里的日志和数据库。我有帐户信息，但无论如何我可以使用命令行（如 ubuntu shell）或相同的教程访问所有内容吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T22:52:05.250

您只需要找出您的代码在服务器上的位置。SSH 到其中一个实例，然后您可以使用 python 交互式 shell 运行 django 代码进行调试，使用 manage.py 命令进行数据库调试、测试等。

连接到实例后，它只是一个操作系统。

# performance - PostgreSQL 查询耗时过长

> ID：13407555
> 
> 赞同：8
> 
> 时间：2012-11-15T22:44:10.797
> 
> 标签：performance, postgresql, postgresql-performance

我有几亿行的数据库。我正在运行以下查询：

```
select * from "Payments" as p
inner join "PaymentOrders" as po
on po."Id" = p."PaymentOrderId"
inner join "Users" as u
On u."Id" = po."UserId"
INNER JOIN "Roles" as r
on u."RoleId" = r."Id"
Where r."Name" = 'Moses'
LIMIT 1000 
```

当 where 子句在数据库中找到匹配项时，我会在几毫秒内得到结果，但如果我修改查询并`r."Name"`在 where 子句中指定一个不存在的，则需要花费太多时间才能完成。我猜 PostgreSQL 正在对`Payments`表（包含最多行）进行顺序扫描，逐行比较每一行。

postgresql 不够聪明，无法首先检查`Roles`表是否包含任何行`Name` `'Moses'`吗？

Roles 表仅包含 15 行，而 Payments 包含约 3.5 亿行。

我正在运行 PostgreSQL 9.2.1。

顺便说一句，在 MS SQL Server 上完成对相同架构/数据的相同查询需要 0.024 毫秒。

我将在几个小时内更新问题并发布 EXPLAIN ANALYZE 数据。

* * *

Here'e解释分析结果：[http ://explain.depesz.com/s/7e7](http://explain.depesz.com/s/7e7)

* * *

这是服务器配置：

```
version PostgreSQL 9.2.1, compiled by Visual C++ build 1600, 64-bit
client_encoding UNICODE
effective_cache_size    4500MB
fsync   on
lc_collate  English_United States.1252
lc_ctype    English_United States.1252
listen_addresses    *
log_destination stderr
log_line_prefix %t 
logging_collector   on
max_connections 100
max_stack_depth 2MB
port    5432
search_path dbo, "$user", public
server_encoding UTF8
shared_buffers  1500MB
TimeZone    Asia/Tbilisi
wal_buffers 16MB
work_mem    10MB 
```

我在 i5 cpu（4 核，3.3 GHz）、8 GB RAM 和 Crucial m4 SSD 128GB 上运行 postgresql

* * *

**更新** 这看起来像是查询计划器中的一个错误。在 Erwin Brandstetter 的推荐下，我将它报告给了[Postgresql 错误邮件列表](http://archives.postgresql.org/pgsql-bugs/2012-11/msg00089.php)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T18:09:14.313

正如 PostgreSQL 社区性能列表上的线程多次建议的那样，您可以通过使用 CTE 强制优化障碍来解决此问题，如下所示：

```
WITH x AS
(
SELECT *
  FROM "Payments" AS p
  JOIN "PaymentOrders" AS po ON po."Id" = p."PaymentOrderId"
  JOIN "Users" as u ON u."Id" = po."UserId"
  JOIN "Roles" as r ON u."RoleId" = r."Id"
  WHERE r."Name" = 'Moses'
)
SELECT * FROM x
  LIMIT 1000; 
```

如果您为“Roles”.“Name”设置更高的统计目标，然后为 ANALYZE，您还可以为您的原始查询制定一个好的计划。例如：

```
ALTER TABLE "Roles"
  ALTER COLUMN "Name" SET STATISTICS 1000;
ANALYZE "Roles"; 
```

如果它期望表中存在更少的匹配行，就像它可能使用更细粒度的统计信息一样，它将假设它需要读取更高百分比的表才能在顺序扫描中找到它们。这可能会导致它更喜欢使用索引而不是顺序扫描表。

您还可以通过调整计划器的一些成本常数和缓存假设来为原始查询获得更好的计划。您可以在单个会话中尝试使用以下`SET`命令：

*   减少`random_page_cost`。这主要取决于缓存数据的严重程度。给定一个包含数亿行的表，您可能不想低于 2；尽管如果您的数据库中的活动数据集被大量缓存，您可以将其一直减少到 的设置`seq_page_cost`，并且您可能希望将它们都减少一个数量级。

*   确保有效缓存大小设置为`shared_buffers`操作系统缓存的总和。这不会分配任何内存；它只是告诉优化器在大量访问期间索引页保留在缓存中的可能性有多大。与顺序扫描相比，较高的设置会使索引看起来更好。

*   增加到0.03`cpu_tuple_cost`到 0.05 范围内的某个位置。我发现默认值 0.01 太低了。我经常通过增加它来获得更好的计划，并且从未见过我建议的范围内的值导致选择更差的计划。

*   确保您的`work_mem`设置是合理的。在我运行 PostgreSQL 的大多数环境中，大小在 16MB 到 64MB 之间。这将允许更好地使用哈希表、位图索引扫描、排序等，并且可以完全改变您的计划；几乎总是变得更好。如果您有大量连接，请注意将其设置为产生良好计划的级别 - 您应该考虑到每个连接都可以为它正在运行的查询的每个节点分配这么多内存的事实。“经验法则”是计算您将在此设置时间附近达到峰值`max_connections`。这是明智地使用连接池限制数据库连接的实际数量的原因之一。

如果您找到这些设置的良好组合，您可能希望对`postgresql.conf`文件进行这些更改。如果您这样做，请密切监视性能回归，并准备调整设置以获得整体负载的最佳性能。

我同意我们需要做一些事情来让优化器远离“有风险的”计划，即使它们看起来平均运行得更快；但是如果调整您的配置以便优化器更好地模拟每个替代方案的实际成本不会导致它使用有效的计划，我会有点惊讶。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-16T11:47:07.977

### 终于成功尝试

我的另一个想法 - 根据评论：
如果您删除**`LIMIT`**未找到角色的情况下的条款会发生什么？我怀疑它会导致快速计划 -`LIMIT`在这里成为罪魁祸首。

~~您可以通过将查询下推到**子查询**中并将`LIMIT`only 应用于外部查询（未经测试）来解决您的问题：~~

 ~~```
SELECT *
FROM  (
   SELECT *
   FROM   "Roles"         AS r  
   JOIN   "Users"         AS u  ON u."RoleId" = r."Id"
   JOIN   "PaymentOrders" AS po ON po."UserId" = u."Id"
   JOIN   "Payments"      AS p  ON p."PaymentOrderId" = po."Id"
   WHERE  r."Name" = 'Moses'
  ) x
LIMIT  1000; 
```~~ 

~~根据评论：@Davita 测试并排除了这种解决方法。[@Kevin 的回答](https://stackoverflow.com/a/13479410/939860)后来澄清了解决方法失败的原因：使用**CTE**而不是子查询。
或者在使用大查询消除坏情况之前检查角色的存在。~~

 ~~这给 PostgreSQL 留下了关于使用`LIMIT`.

最近有许多[关于查询计划的错误报告`LIMIT`](http://www.postgresql.org/search/?m=1&q=LIMIT&l=8&d=365&s=r)。[我在这里](http://archives.postgresql.org/pgsql-bugs/2012-10/msg00240.php)引用 Simon Riggs 对其中一份报告的评论：

> 使用 LIMIT 的非常糟糕的计划很常见。这对我们不利，因为添加 LIMIT 通常/应该使查询更快，而不是更慢。
> 
> 我们需要做点什么。

### 第一次尝试没有成功

我错过了评论中已经提到`join_collapse_limit`的@Craig。所以这是有限的用途：

重新排序`JOIN`条款是否有任何影响？

```
SELECT *
FROM   "Roles"         AS r  
JOIN   "Users"         AS u  ON u."RoleId" = r."Id"
JOIN   "PaymentOrders" AS po ON po."UserId" = u."Id"
JOIN   "Payments"      AS p  ON p."PaymentOrderId" = po."Id"
WHERE  r."Name" = 'Moses'
LIMIT  1000 
```

相关：您没有偶然弄乱[`join_collapse_limit`](http://www.postgresql.org/docs/current/interactive/runtime-config-query.html#GUC-JOIN-COLLAPSE-LIMIT)or的设置[`geqo_threshold`](http://www.postgresql.org/docs/current/interactive/runtime-config-query.html#GUC-GEQO-THRESHOLD)？非常低的设置可能会阻止计划者重新排序您的`JOIN`条款，这可能会解释您的问题。

如果这不能解决问题，我会尝试在`"Roles"(Name)`. 并不是说这仅对 15 行有任何意义，但我会尝试消除无效统计或成本参数（甚至是错误）使规划者认为对“角色”进行顺序扫描比实际更昂贵的怀疑。~~

# python - Python使用递归反转整数

> ID：13407560
> 
> 赞同：1
> 
> 时间：2012-11-15T22:44:27.427
> 
> 标签：python, recursion

我正在解决一个需要在不使用列表或字符串的情况下反转整数输入的问题。但我的程序只返回第一个和最后一个数字。

```
def reverseDisplay(number):
   if number<10:
      return number 
   else:
      return reverseDisplay(number//10)
def main():
    number=int(input("Enter a number:"))
    print(number%10,end='')
    print(reverseDisplay(number))
main() 
```

似乎反向功能只工作了一次。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-15T23:07:31.813

这应该有效：

```
from math import log10
def rev(num):
    if num < 10:
        return num
    else:
        ones = num % 10
        rest = num // 10
        #print ones, rest, int(log10(rest) + 1), ones * 10 ** int(log10(rest) + 1)
        return ones * 10 ** int(log10(rest) + 1) + rev(rest)
print rev(9000), rev(1234), rev(1234567890123456789) 
```

您还可以`log10`通过使用嵌套递归函数来减少调用次数和数学运算次数：

```
def rev(num):
    def rec(num, tens):
        if num < 10:
            return num        
        else:
            return num % 10 * tens + rec(num // 10, tens // 10)
    return rec(num, 10 ** int(log10(num))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:00:37.387

它运行了多次，但它只返回最左边的数字。`if`如果你考虑在什么情况下会是真的，很容易看出这种情况。

为了完成这项工作，您需要添加在退出递归时跳过的数字。以下通过简单地将传递的数字添加到先前结果的左侧来工作。我宁愿在没有字符串转换的情况下这样做，但我想不出一种优雅的方式来做到这一点......

```
def reverseDisplay(number):
   if number<10:
      return number 
   else:
      return int(str(number%10) + str(reverseDisplay(number//10)))
def main():
    number=int(input("Enter a number:"))
    print(number%10,end='')
    print(reverseDisplay(number))
main() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T23:27:43.257

**编辑：**这是一个可行的解决方案。

```
def rev(x, prod=0):
    if x < 10:
        return prod + x
    else:
        prod = prod * 10 + x%10 * 10
        return rev(x / 10, prod) 
```

结果：

```
>>> rev(123)
321
>>> rev(12345)
54321
>>> rev(72823780029)
92008732827L
>>> rev(1)
1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-24T05:21:19.733

**这应该有效：在 Python3 上检查**

```
# reverse a number
def reverseNum(n, rem=0):
   if n == 0:
      return (rem)//10
   else:
      return reverseNum(n//10, (rem+(n%10))*10)

print(reverseNum(7165))
print(reverseNum(123456789)) 
```

**小修改版：**

```
def reverseNum(n, rem=0):
    if n == 0:
        return rem
    elif n<10:
        return reverseNum(n//10, (rem+(n%10)))
    else:
        return reverseNum(n//10, (rem+(n%10))*10)

print(reverseNum(7165))
print(reverseNum(123456789)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T23:03:58.527

在这种假设下，递归不是必需的（如果可能的话，通过迭代替换它总是一个好主意），我建议使用下面的代码。为了清楚起见，我更改了函数名称，同时也避免了在其他建议中过度使用求幂和对数运算。

```
def reverseNumber(n):
   assert isinstance(n, int) and n >= 0
   base = 10
   result = 0
   while n != 0:
      n, remainder = divmod(n, base)
      result = result*base + remainder
   return result 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-15T23:26:55.410

您可以通过保持一个额外的计数来跟踪已经处理了多少位来做到这一点。

这可以使用包装函数来完成：

```
def reverseRecursion(number, i):
    if number < 10:
        return number 
    else:
        return reverseRecursion(number//10, i+1) + (number % 10)*(10**i)

def reverseDisplay(number):
    return reverseRecursion(number, 1)

def main():
    number = 1234
    print(reverseDisplay(number))

main() 
```

这个想法是使用计数器来跟踪有多少尾随零添加到当前数字以使加法工作。

跟踪这将是：

```
number = 1234

ans(123) + 40
ans(12) + 300 + 40
ans(1) + 2000 + 300 + 40
1 + 2000 + 300 + 40
=> 2341 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-25T11:58:35.243

```
def inverte_digitos(n):
        def inverte_aux(n, n_novo):
                if n == 0:
                        return n_novo
                else:
                        return inverte_aux(n//10, n_novo*10+n%10)
        return inverte_aux(n, 0) 
```

这就是我所做的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-15T22:59:38.670

```
def reverseDisplay(number):
    if number<10:     
        return number                      #1 
    first_digit = number % 10              #2
    the_rest = reverseDisplay(number//10)
    ex = 0
    while 1:                               #3
        ex = ex + 1
        if number//(pow(10,ex)) == 0:
            break
    ex = ex - 1
    return first_digit*pow(10,ex) + the_rest #4 
```

这是它的工作原理......（我已经标记了我在这里指的行）

*   第 1 行：退出条件。但你知道这一点
*   第 2 行：获取最后一位数字。% 表示找到除法的余数
*   第 3 行：假设我们传入 123。此时我们有 first_digit=3 和 the_rest=21。我们希望结果是 321 = 300 + 21。所以我们需要知道我们需要多少次将 first_digit 乘以 10 才能工作
*   第4行：嗯，好吃

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-17T07:26:37.257

```
def reverse_num_RECUR(num):

    if num<10:
        return num
    else:
        # print(str(num%10))
        return  (str(num%10)+str(reverse_num_RECUR(num//10)))

print('see Reverse ',reverse_num_RECUR(410010699900012066)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-14T09:54:38.053

```
def reverseDisplay(number,k):
    if number >0:
        i=(k)*10+number%10
        j = number//10
        return reverseDisplay(j,i)
    else:
        return k

def main():
    number = 1234567
    print(reverseDisplay(number,0))

main() 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-11-27T18:58:17.250

```
def reverseDisplay(variable):

        if variable // 10  == 0  : #base case
                print (variable, end='')
                return
        else:
                first = variable % 10
                every_dig_after = variable // 10 
                return reverseDisplay (variable % 10 )   ,  reverseDisplay(every_dig_after) 

def main():
        number = int (input ( "Enterr a number:"))
        reverseDisplay(number)

main() 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-05-02T16:36:38.057

```
#Recursive function body
def reverse(n, s):
    if n > 0:
        s = s*10 + n%10
        reverse(n//10, s)
    else:
        print(s)
#Block of the main program
n = int(input("Enter number"))
d = reverse(n, 0) 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2012-11-15T22:47:22.660

```
def reverseDisplay(number):
   if number<10:
      return number 
   else:
      return reverseDisplay(number//10) + number # you forgot add me 
```

# java - 比较两个字符串中的字符时输出错误

> ID：13407568
> 
> 赞同：0
> 
> 时间：2012-11-15T22:44:42.853
> 
> 标签：java, string, debugging, character

我被我正在创建的一段代码所困扰。我的 IDE 是 Eclipse，当我使用它的调试功能来跟踪每一行发生的事情时，它会完美地输出。但是，当我单击“运行”项目时，它只会输出一个空白屏幕：

```
public static void compareInterests(Client[] clientDetails)
{
    int interests = 0;

    for (int p = 0; p < numberOfClients; p++)
    {
        for (int q = 0; q < numberOfClients; q++)
        {
            String a = clientDetails[p].getClientInterests();
            String b = clientDetails[q].getClientInterests();

            int count = 0;
            while (count < a.length())
            {
                if (a.charAt(count) == b.charAt(count))
                    interests++;
                count++;
            }

            if ((interests >= 3) && (clientDetails[p].getClientName() != clientDetails[q].getClientName()))
                System.out.print (clientDetails[p].getClientName() + " is compatible with " + clientDetails[q].getClientName());
            interests = 0;
        }
    }
} 
```

该代码旨在导入一个对象数组，其中包含有关客户姓名和客户兴趣的信息。客户的兴趣以“01010”格式存储，其中每个 1 表示他们对该活动感兴趣，每个 0 表示不感兴趣。

我的代码将每个客户字符串的每个字符与每个其他客户的字符串进行比较，并为所有不具有相同名称且具有三个或更多共同兴趣的客户输出结果。

当我通过 Java 的调试器运行此代码时，它输出正常 - 但是当我单击运行项目或编译时，我只是得到一个空白屏幕。

有任何想法吗？

编辑：我改变了部分

```
clientDetails[p].getClientName() != clientDetails[q].getClientName() 
```

到

```
clientDetails[p].getClientName().equals(clientDetails[q].getClientName() 
```

正如以下答案中的人们所建议的那样。但是，我仍然得到空白输出。任何其他想法（还有，为什么 Eclipse 的调试器会忽略这一点并正确输出所有内容？）

示例输入如下所示：

```
 Sophia Candappa     F 23 00011
 Jade Clarke         F 25 00011 
```

忽略性别和年龄（F 和 23/25），因为我在其他部分已经处理过了。

编辑2：

好吧，现在更陌生了！如果我在兴趣 = 0 之后添加此代码，如下所示：

```
 interests = 0;
    System.out.println(""); 
```

我从中得到输出（可怕的格式化输出，因为我可能会得到一个结果，新行，结果，然后是四个新行，然后是结果，这取决于谁与循环语句中的谁匹配。我真的不明白为什么行给出输出。有人吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:49:34.557

使用`String.equals`代替`==`运算符来比较`String`内容：

```
if ((interests >= 3) && (!clientDetails[p].getClientName().equals(clientDetails[q].getClientName())) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:02:06.410

Java不是javascript...

与 javascript 不同，在 java 中，`==`运算符测试两个对象是否是相同的确切实例 - 即两个变量是否引用该对象。

比较对象的*值*时，使用`.equals()`方法。请注意， （在类中）
的默认实现实际上与比较相同，但是覆盖它的类（如）会比较它们的状态（值）。`.equals()``Object``==``String`

这是 Java 新手最常犯的错误之一。

你想要的是：

```
!clientDetails[p].getClientName().equals(clientDetails[q].getClientName()) 
```

也许

```
!clientDetails[p].getClientName().equalsIgnoreCase(clientDetails[q].getClientName()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T00:03:42.480

这是您缺少的[javadocs](http://docs.oracle.com/javase/6/docs/api/java/io/PrintStream.html)中的相关片段：

> 可选地，可以创建一个 PrintStream 以便自动刷新；这意味着在写入字节数组、调用 println 方法之一或写入换行符或字节 ('\n') 后会自动调用 flush 方法

您的函数中唯一的输出是 System.out.print() 调用。因此，没有什么会强制刷新 System.out 的缓冲区，并且不能保证您会看到该输出。调试器（可以）更积极地刷新输出缓冲区，这就是您从调试器中看到输出的原因。上面引用的文本解释了为什么添加空的 println() 调用可以解决您的问题 - println() 会强制写出缓冲区。

# android - Eclipse、Android ndk、源文件、库项目依赖

> ID：13407576
> 
> 赞同：0
> 
> 时间：2012-11-15T22:45:37.097
> 
> 标签：android, android-ndk, library-project

在 Microsoft Visual Studio 2010 中，可以创建具有多个项目的解决方案并设置项目之间的依赖关系。我试图弄清楚是否可以通过 NDK 使用 Eclipse 来完成同样的事情。更具体地说，我想知道是否可以在普通的Android项目中创建可以引用Android库项目中的C头文件的C源文件。

例如：

```
Android library project: Sockets
Ordinary Android project: Socket_Server 

Sockets contains all the C header/source files that are needed to do socket I/O.
Socket_Server contains test code that makes calls to the functions that are defined in Sockets library project.  This test code requires a header file that contains the function declaration of all API calls. 
```

我已经通过以下方式设置了项目之间的库依赖项：

```
Properties > Android > Library > Add 
```

在 Socket_Server 中有一个名为 SocketTestServer.cpp 的文件。它包含测试代码，但对库项目 Sockets 进行 API 调用，并通过 #include "Nv_Socket.h" 进行调用，这不是 Socket_Server 的一部分：

```
jni/SocketTestServer.cpp:1:23: fatal error: Nv_Socket.h: No such file or directory
compilation terminated. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T02:41:23.343

请参阅[http://www.kandroid.org/ndk/docs/IMPORT-MODULE.html](http://www.kandroid.org/ndk/docs/IMPORT-MODULE.html)和[http://www.kandroid.org/ndk/docs/PREBUILTS.html](http://www.kandroid.org/ndk/docs/PREBUILTS.html)。诀窍是不必将二进制文件从一个项目复制到另一个项目！此外，使用`LOCAL_EXPORT_C_INCLUDES`您可以保证使用最新版本

```
#include "Nv_Socket.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T00:00:38.250

我想我解决了。如果你制作一个 .so 文件，将它放在 /jni 文件夹中，然后在你的 .mk 文件中引用它，编译应该没有问题。

.mk 文件：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

# Turn on C++ Exception handling
LOCAL_CPP_FEATURES += exceptions
LOCAL_CPPFLAGS += -fexceptions

# Load LogCat utility
LOCAL_LDLIBS := -llog

# C flags
LOCAL_CFLAGS    += -Wno-psabi -fpermissive

# Module name                  
LOCAL_MODULE    := ServerSockets

# C Header includes
LOCAL_C_INCLUDES := $(LOCAL_PATH)

# Source files
LOCAL_SRC_FILES := libSockets.so 

include $(PREBUILT_SHARED_LIBRARY) 
```

# python - 有人可以解释以下功能之间的速度差异吗？

> ID：13407581
> 
> 赞同：1
> 
> 时间：2012-11-15T22:45:45.893
> 
> 标签：python

第一个函数是一个简单的二进制搜索实现，用于查找数字的平方根：

```
def sqrt1(x):
    if x < 0:
        raise ValueError(x)
    if x > 0:
        if x < 1:
            root = 1
            while root ** 2 > x:
                root /= 2
            half = root
            while root ** 2 != x:
                half /= 2
                diff = root + half
                if diff == root:
                    return root
                if diff ** 2 <= x:
                    root = diff
            return root
        if x > 1:
            root = 1
            while root ** 2 < x:
                root *= 2
            half = root / 2
            while root ** 2 != x:
                half /= 2
                diff = root - half
                if diff == root:
                    return root
                if diff ** 2 >= x:
                    root = diff
            return root
        return 1
    return 0 
```

第二个函数做同样的事情，但比第一个更简单，速度快 15 倍：

```
def sqrt2(z):
    assert z > 0
    x, y = z, None
    while x != y:
        y = x
        x = (x + z / x) / 2
    return x 
```

1.  为什么`sqrt2`比 快那么多`sqrt1`？
2.  可以`sqrt1`做成表演更喜欢`sqrt2`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T01:16:48.070

## 二进制搜索

算法 1 进行二进制搜索。因此，如果您正在寻找 2 的平方根，您将在每次迭代后得到以下结果：

```
1.0
1.0
1.25
1.375
1.375
1.40625
1.40625
1.4140625
1.4140625
1.4140625
1.4140625
1.4140625
1.4140625
1.4141845703125
1.4141845703125
1.4141845703125
1.4141998291015625
1.41420745849609375

```

我们已经运行了 17 次迭代，我们有 6 个正确的数字：1.41421。在另外 17 次迭代之后，我们可能会得到大约 12 个正确的数字。在第 34 次迭代中，我们得到：

```
1.4142135623260401189327239990234375 
```

这里正确的数字是1.414213562，所以只有10位。

## 牛顿法

第二种方法是牛顿法，它具有二次收敛性。这意味着每次迭代你得到两倍的数字，所以你会得到：

```
0 2.0
1 1.5
2 1.4166666666666666666666666666666666666666666666666666666667
5 1.41421568627450980392156862745098039215686274509803921568627
12 1.414213562374689910626295578​​89013491011655962211574404458491
24 1.41421356237309504880168962350253024361498192577619742849829
49 1.41421356237309504880168872420969807856967187537723400156101
60+ 1.41421356237309504880168872420969807856967187537694807317668

```

左列显示正确数字的数量——注意它是如何呈指数增长的。我在这里截断了输出，因为经过7次迭代，结果对我选择的精度是正确的。（这实际上是使用比 Python 更高的精度数据类型运行的`float`，它永远不能给你 60 位的精度。）

## 是否有可能使二进制搜索更快？

不，如果你让它更快，它就不可能再被称为二分搜索了。

# mongodb - How to construct an MongoDB Linq Any() query by comparing a sub-field

> ID：13407588
> 
> 赞同：3
> 
> 时间：2012-11-15T22:46:06.497
> 
> 标签：mongodb, mongodb-.net-driver

I'm trying to construct the following nested query such that it will run on my entities in C# but be properly translated through the C# Driver to a MongoDB Query;

```
lpn = new List<PN> { new PN("/standard"), new PN("/my") };n
Collection.AsQueryable<T>
    (o => o.pns.Any(pf => lpn.Any(pn => pn.n == pf.n)) 
```

So that's valid C#. I'm trying to match an array of values against an array of values, but I get this error in the driver stack;

```
Result Message: 
Test method MyLib.Tests.Models.ProjectTest.DBImportExcelProject threw exception: 
System.NotSupportedException: Unable to determine the serialization information for the expression: System.Collections.Generic.List`1[MyLib.DomainModels.lpn].
Result StackTrace:  
at MongoDB.Driver.Linq.Utils.BsonSerializationInfoFinder.GetSerializationInfo(Expression node, Dictionary`2 serializationInfoCache) in d:\vs11Projects\ThirdParty\mongo-csharp-driver\Driver\Linq\Utils\BsonSerializationInfoFinder.cs:line 64
   at MongoDB.Driver.Linq.Utils.BsonSerializationInfoHelper.GetSerializationInfo(Expression node) in d:\vs11Projects\ThirdParty\mongo-csharp-driver\Driver\Linq\Utils\BsonSerializationInfoHelper.cs:line 48
   at MongoDB.Driver.Linq.PredicateTranslator.BuildAnyQuery(MethodCallExpression methodCallExpression) in d:\vs11Projects\ThirdParty\mongo-csharp-driver\Driver\Linq\Translators\PredicateTranslator.cs:line 133
   at MongoDB.Driver.Linq.PredicateTranslator.BuildMethodCallQuery(MethodCallExpression methodCallExpression) in d:\vs11Projects\ThirdParty\mongo-csharp-driver\Driver\Linq\Translators\PredicateTranslator.cs:line 735
   at MongoDB.Driver.Linq.PredicateTranslator.BuildQuery(Expression expression) in d:\vs11Projects\ThirdParty\mongo-csharp-driver\Driver\Linq\Translators\PredicateTranslator.cs:line 73
... 
```

Which I can appreciate since it's trying to put an `$in:[]` query into another query.

This is what an object in the collection looks like;

```
 {
            "_id" : ObjectId("50a5633292c3d22270ac2256"),
            "pns" : [
                    {
                            "n" : "/standard",
                            "ns" : {
                                    "v" : "standard"
                            }
                    }
            ]
    } 
```

So `pns` is an array of `PN` types, so I can't simply use `Contains()` because I don't want to match the whole `PN` structure, just the `n` field. I've tried various other constructions.

This is the closest thing I've been able to come up with in the shell;

```
db.collection.find({
    "pns": {
        "$elemMatch": {
            "n": "/standard",
        }
    }
}).count(); 
```

But I can't even find a way to convert that to a Linq expression.

**Question** Is it possible to build a linq query that matches any array member of `lpn` within `pns` but only matching against the `n` field? Or am I going to have to build these queries by hand?

**Update**

I think I almost have it. I figure I need to convert to a string array before I can do anything sensible with the query, and I don't think I can do that in Linq. So this works;

```
var strArray = new[] { "/standard", "/my" };
Collection.AsQueryable<T>(o => o.pns.Any(pn => pn.n.In(strArray))); 
```

which gives me;

```
{
    "pns": {
        "$elemMatch": {
            "n": {
                "$in": [
                  "/standard",
                  "/my"
                ]
            }
        }
    }
} 
```

But unfortunately, the Driver isn't smart enough to accept this;

```
Collection.AsQueryable<T>(o => o.pns.Any(pn => pn.n.In(lpn.Select(pfn => pfn.n)))); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:28:41.543

You need to use the Contains linq method...

```
var strArray = new[] { "/standard", "/my" };
Collection.AsQueryable<T>(o => o.pns.Any(pn => strArray.Contains(pn.n))); 
```

Note, you can do this with a `List<string>` as well in your case. Anything that implements `IEnumerable<T>`...

# search-engine - 使用 NEST 库进行索引时出现 RoutingMissingException

> ID：13407589
> 
> 赞同：0
> 
> 时间：2012-11-15T22:46:09.803
> 
> 标签：search-engine, elasticsearch, nest

我已经使用 TypeMapping 在我的代码中指定了文档映射，在索引时我开始看到以下异常

{"error":"RoutingMissingException[[search2]/[ImageDocument]/[2039810546]]需要路由","status":500}

而且在指定类型映射时，我没有找到任何方法来使用 NEST 指定路由！任何线索我们在索引时或映射时在哪里指定路由参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:00:39.563

我们可以在索引时使用 IndexParameters 参数并指定路由

```
 IndexParameters indexParams = new IndexParameters() { Routing = "id" };
        var resp = ConnectedClient.Index(doc, "IndexName", "typeName", id, indexParams); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-19T13:52:47.350

在 NEST v2.4 中，您可以使用 selector 参数来指定路由。

```
public IIndexResponse Index<T>(T @object, Func<IndexDescriptor<T>, IIndexRequest> selector = null) where T : class; 
```

并像这样使用它：

```
var routingId = 1;
var resp = client.Index(doc, r => r.Routing(routingId)); 
```

# asp.net - 将模型绑定到asp.net mvc 4中的列表

> ID：13407593
> 
> 赞同：0
> 
> 时间：2012-11-15T22:46:26.890
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

我们如何将模型绑定到 mvc 4 中的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T19:43:28.363

创建一个 MVC 项目，将所有内容保留为默认值，并使用以下（非常简单的）代码在您的模型文件夹中添加产品：

```
namespace BlogPost.Models
{
public class Product
{
    public string Name { get; set; }
}
} 
```

然后使用以下代码添加 ProductsController（在 Controllers 文件夹中）：

```
using System.Collections.Generic;
using System.Web.Mvc;
using BlogPost.Models;

namespace BlogPost.Controllers
{
public class ProductsController : Controller
{
    public ActionResult Add()
    {
        return this.View();
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Add(IList<Product> products)
    {
        return this.View();
    }
 }
} 
```

资料来源：http: [//kristofmattei.be/2009/10/19/asp-net-mvc-model-binding-to-a-list/](http://kristofmattei.be/2009/10/19/asp-net-mvc-model-binding-to-a-list/)

# google-maps - 谷歌地图和融合表 api - 鼠标悬停在 2 层

> ID：13407596
> 
> 赞同：0
> 
> 时间：2012-11-15T22:46:44.937
> 
> 标签：google-maps, google-fusion-tables

我有一个 2 层的融合地图，即代表美国城镇的点。2 层有相似的数据，但城镇不同。我在两个图层上都启用了鼠标悬停效果。有时，当 2 个城镇彼此重叠显示时（在大比例尺地图上），会触发 2 个鼠标悬停事件并同时显示 2 个标签，一个在另一个之上。有没有办法一次只触发 1 个鼠标悬停事件？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T01:22:47.650

在鼠标悬停事件处理程序中编写代码，以防止一次触发多个事件。

# java - 向 SQLite Table Android 添加数百个条目

> ID：13407602
> 
> 赞同：0
> 
> 时间：2012-11-15T22:47:10.820
> 
> 标签：java, android, sql, performance, sqlite

> **可能重复：**
> [Android 设备上的批量插入](https://stackoverflow.com/questions/3860008/bulk-insertion-on-android-device)

所以我想为我的 android 应用程序在 sqlite 数据库表中添加大约 300 个条目。我想快速有效地做到这一点，而不会给用户带来明显的延迟。我手头有一个要添加的项目列表（此列表不会动态更改）。我应该创建一个 arryalist，然后遍历该列表以添加条目，还是应该为我要添加的每个条目字符串运行这样的方法？：

```
public long creatSQLEntry(String name){
    ContentValues cv = new ContentValues();
    cv.put(COLUMN_STUFF, name);
    return myDatabase.insert(MY_Table, null, cv);
} 
```

我认为上面的代码不是最有效的方法。有人知道怎么做吗？一些示例代码会很棒，但不是必须的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:47:58.260

[编译语句](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#compileStatement%28java.lang.String%29)并使用[事务](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#beginTransaction%28%29)以编程方式插入所有行。我为静态数据库执行此操作，速度非常快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:11:55.360

您可以在桌面上准备数据库，然后在初始加载时将数据库复制到私有数据库文件夹。

[http://zaman91.wordpress.com/2010/09/22/android-how-to-use-own-sqlite-database/](http://zaman91.wordpress.com/2010/09/22/android-how-to-use-own-sqlite-database/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:26:38.020

如果这个数据列表是不变的，我会再看看数据库设计。

# python - 非二进制线性反馈移位寄存器

> ID：13407605
> 
> 赞同：0
> 
> 时间：2012-11-15T22:47:19.753
> 
> 标签：python, math, language-agnostic

我使用[Wikipedia](http://en.wikipedia.org/wiki/Linear_feedback_shift_register#Galois_LFSRs)上的说明在 Python 中编写了一个伽罗瓦线性反馈移位寄存器：

```
def lfsr(coefficients, state):
    while 1:
        lsb = state.pop()
        state.insert(0, 0)
        if lsb:
            state = app(coefficients, state)

        yield lsb

def app(coefficients, state):
    return [ (coefficients[i]^state[i]) for i in range(len(state)) ]

L = lfsr([1,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1], [0]*15+[1])
seq = [ str(L.next()) for i in range(2**16+16) ] 
```

这工作正常。我现在想做的是编写一个通用版本，可以处理 GF(2) 以外的 Galois 字段，但我不明白关于[non-binary LFSRs](http://en.wikipedia.org/wiki/Linear_feedback_shift_register#Non-binary_Galois_LFSR)的部分。这部分对我来说没有意义：“反馈位（输出位）乘以（模 q）乘以 q 进制值，该值对于每个特定的抽头点都是恒定的。” 如何将单个输出位乘以每个抽头点的值？

这是我想出的，但不是给出循环序列，而是输出迅速恶化为全 0：

```
# Multiplication table for GF(4)
mult_4 = [[0, 0, 0, 0],
          [0, 1, 2, 3],
          [0, 2, 3, 1],
          [0, 3, 1, 2]]

def lfsr(coefficients, state):
    while 1:
        lsb = state.pop()
        state.insert(0, 0)
        state = app(coefficients, state)

        yield lsb

def app(coefficients, state):
    return [ mult_4[coefficients[i]][state[i]] for i in range(len(state)) ]

L = lfsr([ 1, 0, 0, 0, 1, 2, 3 ], [1]*6)
seq = [ str(L.next()) for i in range(4**6+6) ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T06:25:05.500

我建议您熟悉[多项式环](http://en.wikipedia.org/wiki/Polynomial_ring)的概念（尽管 Wikipedia 的那篇文章技术性太强，无法做出最好的介绍）。您似乎遇到的最基本的问题是您试图过于接近地模仿二进制移位寄存器，当您将其视为离散动态系统而不是电路时，无法完全理解正在发生的事情。

二进制移位寄存器是一个巧妙的电路，它计算`X^N`除以 时的余数`f(X)`，其中的所有系数`f`都在环`Z/2Z`中，环仅包含 0 和 1。这些余数是使用欧几里德算法计算的，就像计算整数的余数一样。该模型中 LFSR 的状态是某个次数小于 的次数的多项式`f`。LFSR 的第一个状态是`1`，第二个是`X`。LFSR 中的每个循环都等价于乘以`X`一个长除法，然后是一个长除法。移位操作是乘法，抽头是长除法。分裂确实是这里的核心。

[除此之外：您可以使用任意环作为此构造的系数，但是零除数作为除数多项式的主要系数的问题使事情变得复杂。由于无论如何您都在使用字段，因此我将仅将字段作为系数来讨论。]

如果您使用的是除位以外的系数环，则需要考虑长除法的一步是什么样的。如果除数多项式`f`看起来像`a_k X^k + ...`，新状态`g`看起来像`b_k X^k + ...`，那么长除法的第一步就是计算`b_k / a_k`。对于一个字段（正如我假设的那样），这是一些 number `c`。所以余数是`g - cf`，它是一个度数为 的多项式`k-1`。剩下的就是你的新状态。

（表达式`cf`是理解 Wikipedia 文章中让您感到困惑的部分的关键。您可能想说服自己，您可以将多项式除`f`以其前导系数`a_k`得到另一个多项式，该多项式生成的序列只是第一的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:51:04.193

您可以在 math.stackoverflow.com 上询问有关 Galois 字段下的乘法，但其要点是，每个“位”不是“位”，其中每个位是 0 或 1 (GF_2)，每个“位”实际上是一个数字符号数——确切的数字取决于字段的大小。

要从二进制 LFSR 到 Galois LFSR，您必须概括“位”和“乘法”的概念，以便在该领域有意义。~~字段中的乘法运算~~Addition 也代替了`app()`函数中的 XOR。

在二进制版本中，乘法是隐式的；输出位乘以 0 或 1，具体取决于是否存在抽头。在一般字段中，抽头本身可以具有与之关联的任何字段元素，然后将其乘以输出。

# c# - 获取一周中的所有日期到 datagridview 列

> ID：13407606
> 
> 赞同：0
> 
> 时间：2012-11-15T22:47:20.033
> 
> 标签：c#, datetime, datagridview

我使用以下代码获取一周中的所有日期，以在两个日期之间依次显示它们并将它们添加到 datagridview 列中：

```
for (int i = 0; i < dataGridView1.Columns.Count; i++)
{
  for (int j = 0; j < dtEnd.Subtract(dtStart).Days; j++)
  {
     TimeSpan counter = new TimeSpan(j, 0, 0, 0);
     dataGridView1.Columns[j].HeaderText += (dtStart + counter).DayOfWeek.ToString();
  }    
} 
```

但是这条线

```
dataGridView1.Columns[j].HeaderText += (dtStart + counter).DayOfWeek.ToString(); 
```

导致错误。它说 ：

> 指数超出范围。必须是非负数且小于集合的大小。参数名称：索引

我该如何解决这个问题？

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:49:00.030

```
 ↓
dataGridView1.Columns[i].HeaderText += (dtStart + counter).DayOfWeek.ToString(); 
```

在上面的代码行中应该有一个 i 而不是 aj。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:49:10.207

您可能打算`i`用作列的索引：

```
dataGridView1.Columns[i].HeaderText += (dtStart + counter).DayOfWeek.ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:50:01.993

大概是这条线引发了异常；

```
dataGridView1.Columns[j].HeaderText += ... 
```

您正在使用计数器变量“i”来迭代您的网格列，但使用计数器“j”来设置值。如果您的天数多于列，您将收到此异常。您可能需要在这里重新考虑您的设计。为每一天添加列，或使用行。我不知道你的意图是什么，所以除此之外，很难提出建议。

# actionscript-3 - Object类型和Dictionary类型中的映射对象有什么区别

> ID：13407613
> 
> 赞同：3
> 
> 时间：2012-11-15T22:47:56.723
> 
> 标签：actionscript-3

```
public var obj:Object;
public var dictionary:Dictionary;

public function MyClass(){

    obj = new Object();
    dictionary = new Dictionary();

    obj["1"] = 1;
    obj["2"] = 2;

    dictionary["3"] = 3;
    dictionary["4"] = 4;
}

public function returnFromObject(parameter:String):int{

     return obj[parameter];
}

public function returnFromDictionary(parameter:String):int{

     return dictionary[parameter];
} 
```

他们可以为我服务。除非使用我不知道的其中任何一个对性能有明显影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:53:03.023

不同之处在于在字典的情况下能够使用对象作为键而不是字符串。除此之外，我不知道有任何重大差异（但不记得曾经在这些方面看到过任何真正的基准，所以如果有人更聪明，请告诉我们）。

[http://gskinner.com/blog/archives/2006/07/as3_dictionary_.html](http://gskinner.com/blog/archives/2006/07/as3_dictionary_.html)

评论中仅提及页面上的性能是一个简短的参考，一般来说，因为他们说我发现这些是空想的，并且依赖于应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:55:47.650

根据以下内容，似乎 Dictionary 比对象和数组快得多：

[http://www.zombieflambe.com/actionscript-3/as3-dictionary-class-array-object-benchmark/](http://www.zombieflambe.com/actionscript-3/as3-dictionary-class-array-object-benchmark/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:54:30.533

虽然可能有比这更多的差异，但我的第一个想法是变量声明，以及循环对象的能力。

```
var obj:Object = new Object();
obj.a = "test1";
obj.b = "test2";
obj.c = "test3";

for each (var prop in obj) trace(prop); //traces "test1, test2, test3" 
```

更多信息在这里：[http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Dictionary.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Dictionary.html)

# html - HTML 中的 VB 脚本

> ID：13407621
> 
> 赞同：0
> 
> 时间：2012-11-15T22:48:30.547
> 
> 标签：html, sql, outlook

我有一个应用程序，它创建显示 DTS 包结果的 html 代码，然后将其发送给用户。在 DTS 包中，我有一个 ActiveX 脚本，它将文件移动到存档文件夹中，但我希望当用户单击该电子邮件中发送的链接时运行该代码。换句话说，用户会收到一封带有结果的电子邮件；如果用户喜欢结果，则单击链接，然后将文件移动到存档文件夹中。这是可能吗？

所有用户都使用 Outlook。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:00:12.987

您需要做的是在 IIS 服务器上创建一个页面，该页面拦截电子邮件中的 URL，并可以使用查询字符串识别要移动的文件。

基于此，您可以执行一条 SQL 语句，该语句触发一个存储过程，该存储过程又执行另一个将移动文件的 DTS 包。

如何执行此操作取决于您要使用的服务器端语言。

我已经 10 多年没有做过这种事情了，所以细节有点模糊，但希望这能给你一个开始。

请参阅：[存储过程经典 asp](https://stackoverflow.com/questions/6424515/stored-procedures-classic-asp)

# python - 向现有 XMLFile Python 添加条目

> ID：13407623
> 
> 赞同：1
> 
> 时间：2012-11-15T22:48:51.127
> 
> 标签：python, xml, scripting, web

小心！菜鸟问题。

我对python真的很陌生，（C是我的主要），我正在寻找一些用于管理我的网络服务器的后端脚本。为了更新 RSS 提要，我需要将条目附加到 XML 文件中。

我有一个如下所示的 XML 文件：

```
<listofentries>
    <entry>
        <title>SampleTitle</title>
        <pubdate>10/12/12</pubdate>
    </entry>
</listofentries> 
```

我希望它看起来像这样：

```
<listofentries>
    <entry>
        <title>SampleTitle</title>
        <pubdate>10/12/12</pubdate>
    </entry>
    <entry>
        <title>SampleTitle2</title>
        <pubdate>11/5/12</pubdate>
    </entry>
</listofentries> 
```

我需要在条目列表中添加另一个条目。我知道我可以使用基本的文件 I/O 来做到这一点，但这是一件难事。

我知道 XML 解析器是为此而构建的，但是我还没有找到一个像样的教程来使用它们来添加新条目而不仅仅是新属性。

欢迎任何和所有建议。另外请告诉我我所做的是否聪明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:08:45.260

查看[ElementTree API](http://docs.python.org/2/library/xml.etree.elementtree.html#modifying-an-xml-file)及其 Element.append 方法。在该文档中，您可以了解如何将 xml 解析为树对象，然后将新子元素附加到现有父元素。

# java - http会话在request.sendRedirect后丢失属性

> ID：13407624
> 
> 赞同：3
> 
> 时间：2012-11-15T22:48:52.573
> 
> 标签：java

在过滤器内部，我试图为当前的 http 会话设置一个属性。然后我使用 response.sendRedirect() 重定向到另一个资源。资源将请求发送回过滤器。第二次会话丢失会话属性。

请提供一些指针。

第一个请求如下：

```
HttpSession objSession = request.getSession(true);
objSession.setAttribute("wasRequestURL", completeURL); 
```

第二个请求如下：

```
if (null != objSession.getAttribute("wasRequestURL") && 
    !"".equals(objSession.getAttribute("wasRequestURL").toString().trim())) {

    requestedURL = objSession.getAttribute("wasRequestURL").toString();

    logger.info("The session value for wasRequestURL is :::"+requestedURL);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:06:15.373

1.  检查您的会话到期时间。它可能设置得太低。
2.  您是在使用像 Web 浏览器这样的 cookie 感知客户端，还是可能不存储 cookie 的更低级别的客户端？
3.  当您说“重定向到另一个资源”时，您是指另一个 Web 容器/服务器吗？如果是这样，除非您启用了复制，否则第二次请求时会话将不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:02:28.970

**您很可能在两者之间丢失了第一个会话对象。**这可以通过使用来验证

```
HttpSession objSession=request.getSession(false);//don't create session when absent 
```

在您的第二个请求中。我几乎可以肯定，由于您的第一个会话丢失，它将返回 null。如果是这样，请调查您围绕会话创建的机制/配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-15T00:22:15.267

I had the same issue and [tore my hair out looking for the best solution](https://stackoverflow.com/q/70343060/12654533). Try putting `sessionCookiePath="/"` attribute into your context.xml root node:

`<Context ... sessionCookiePath="/" > ... </Context>`

This will set the path of your session cookie to the root of your app so that it will be passed on redirect. This simple fix worked for me, hope it works for anyone else having this issue years later.

# directx - 如何在白色的地方用透明渲染 ID2D1Bitmap

> ID：13407631
> 
> 赞同：0
> 
> 时间：2012-11-15T22:49:24.240
> 
> 标签：directx, transparent, jpeg, direct2d

你好，我正在写类似文件阅读器的东西。此功能之一是读取图像。一些图像是 JPG 格式。这些图像在应该透明的区域是白色的（因为 jpg 不支持 alpha 通道）。换句话说，我需要以一种有白色的地方应该是透明的方式来渲染 Direct2d 图像。有什么建议么？谢谢普热梅克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T15:16:36.750

两个最明显的选择：

*   读取 .jpg 文件后，手动将其转换为带有 alpha 层的 32 位，然后启用*alpha 测试*以丢弃这些像素。
*   使用一个像素着色器，`discard`为每个白色像素做一个

# prolog - prolog 程序检查给定的输入是数字还是大写还是小写

> ID：13407636
> 
> 赞同：1
> 
> 时间：2012-11-15T22:49:49.857
> 
> 标签：prolog, swi-prolog, iso-prolog

我已经为上述程序使用了以下逻辑，但它给出了错误显示`>=/2: Arithmetic: 'a/0' is not a function`。我应该怎么做才能更正程序？

```
digit(X):- X>=0,X<10,write('input is digit').
uppercase(X):- X>='A',X<'[',write('input is uppercase').
lowercase(X):- X>='a',X<'{',write('input is lowercase'). 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:00:19.753

如果您只想对 ISO Prolog 中的 ASCII 字符进行分类，可以通过多种方式进行：

**作为**表示为长度为 1 的原子的字符。要比较它们，您可以使用通用术语 compare `(@>=)/2`，`(@>)/2`...在您的示例中，这将是：

```
digit_char(X) :- atom_length(X,1), X @>= '0', X @=< '9'.
... 
```

**作为表示***整理序列整数*的纯整数的字符代码（听起来令人印象深刻？它只是 ASCII 代码）。

```
digit_code(X) :- integer(X), X >= 0'0, X =< 0'9.
... 
```

如果您需要在两者之间进行转换，则有`char_code/2`.

对于 Unicode，事情尚未普遍可用并达成一致。在 SWI 中，有[`char_type/2`](http://www.swi-prolog.org/pldoc/search?for=char_type/2&in=all&match=summary)和`code_type/2`。请注意，这些事情仍在发展中...

有关字符和代码的更多信息，请参阅 [Prolog 中的 ' 和 " 有什么区别？](https://stackoverflow.com/questions/8264699/what-is-the-difference-between-and-in-prolog/8269897#8269897)

# php - 使用 xml 标头加载 php 文件

> ID：13407637
> 
> 赞同：0
> 
> 时间：2012-11-15T22:49:51.547
> 
> 标签：php, xml

我有一个带有 xml 标头和 xml 代码的 php 文件，名为 test.php。

```
 <?php
header('Content-type: text/xml');

$file = file_get_contents('http://api.tradedoubler.com/1.0/vouchers.xml?token=removed');
echo $file;

?> 
```

API 中的 xml 如下所示：

```
<voucherList>
  <voucher>
    <id>115</id>
    <programId>111</programId>
    <programName>Program 111</programName>
    <code>AF30C5</code>
    <updateDate>1332422674941</updateDate>
    <startDate>1332370800000</startDate>
    <endDate>1363906800000</endDate>
    <title>Voucher number one</title>
    <shortDescription>Short description of the voucher.</shortDescription>
    <description>This is a long version of the voucher description.</description>
    <voucherTypeId>1</voucherTypeId>
    <defaultTrackUri>http://clk.tradedoubler.com/click?a(222)p(111)ttid(13)</defaultTrackUri>
    <siteSpecific>True</siteSpecific>
  </voucher>
  <voucher>
    <id>116</id>
    <programId>111</programId>
    <programName>Program 111</programName>
    <code>F90Z4F</code>
    <updateDate>1332423212631</updateDate>
    <startDate>1332370800000</startDate>
    <endDate>1363906800000</endDate>
    <title>The second voucher</title>
    <shortDescription>Short description of the voucher.</shortDescription>
    <description>This is a long version of the voucher description.</description>
    <voucherTypeId>1</voucherTypeId>
    <defaultTrackUri>http://clk.tradedoubler.com/click?a(222)p(111)ttid(13)url(http://www.example.com/product?id=123)</defaultTrackUri>
    <siteSpecific>False</siteSpecific>
    <landingUrl>http://www.example.com/product?id=123</landingUrl>
  </voucher>
</voucherList> 
```

如何将此文件加载为 xml？

以下不起作用：

```
$xml = simplexml_load_file('test.php');
echo $xml; 
```

我只是得到一个白页。

测试文件保存为 php，因为它是动态的。它正在从 tradedoubler api 加载数据。

也许这是加载api数据的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:58:04.150

simplexml_load_file() 将 xml 文件作为对象加载。如果你回显一个对象，它应该在输出中说“对象”。如果您得到一个白页，则很有可能出现问题（即：检查错误日志）。

您可以`print_r($xml);`查看 XML 对象的内容（如果设置正确）。

如果您从 print_r 语句获得输出，则可以开始访问特定节点和元素：

```
echo $xml->node[index]->element; 
```

等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:00:24.063

我刚刚尝试了您的示例源文件，`print_r($xml);`
我真的得到了输出。

所以请尝试`print_r($xml)`；

我可以通过（例如，为我工作）访问您的 XML

```
$xml->voucher[0]->id; 
```

那是因为 $xml 是一个对象，在这个对象里面有数组（比如凭证），在这个数组里面又有对象。

**编辑：**你改变了你的OP，所以：

我用 x.php 尝试了您的原始示例：

```
<?php

    header('Content-type: text/xml');

    $file = simplexml_load_file('test.php');
    echo $file->voucher[0]->id;

?> 
```

在 test.php 我痛风你的 xml：

```
 <voucherList>
  <voucher>
    <id>115</id>
    <programId>111</programId>
    <programName>Program 111</programName>
    <code>AF30C5</code>
    <updateDate>1332422674941</updateDate>
    <startDate>1332370800000</startDate>
    <endDate>1363906800000</endDate>
    <title>Voucher number one</title>
    <shortDescription>Short description of the voucher.</shortDescription>
    <description>This is a long version of the voucher description.</description>
    <voucherTypeId>1</voucherTypeId>
    <defaultTrackUri>http://clk.tradedoubler.com/click?a(222)p(111)ttid(13)</defaultTrackUri>
    <siteSpecific>True</siteSpecific>
  </voucher>
  <voucher>
    <id>116</id>
    <programId>111</programId>
    <programName>Program 111</programName>
    <code>F90Z4F</code>
    <updateDate>1332423212631</updateDate>
    <startDate>1332370800000</startDate>
    <endDate>1363906800000</endDate>
    <title>The second voucher</title>
    <shortDescription>Short description of the voucher.</shortDescription>
    <description>This is a long version of the voucher description.</description>
    <voucherTypeId>1</voucherTypeId>
    <defaultTrackUri>http://clk.tradedoubler.com/click?a(222)p(111)ttid(13)url(http://www.example.com/product?id=123)</defaultTrackUri>
    <siteSpecific>False</siteSpecific>
    <landingUrl>http://www.example.com/product?id=123</landingUrl>
  </voucher>
</voucherList> 
```

它仍然对我有用。因此，如果您仍然有空白页，则错误必须在其他地方。你`error_reporting(E_ALL);`开启了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:05:48.010

xml 文件加载正常，输出不为空，而只是一些新行。

尝试

```
echo $xml->asXML(); 
```

编辑：也许您的 php 配置阻止了外部 url 的 file_get_contents (allow_url_fopen = Off)。尝试使用 curl 或像这样的直接请求来获取它：

```
$xml = '';
$fp = fsockopen('api.tradedoubler.com', 80, $errno, $errstr, 30);
if (!$fp) {
    echo "$errstr ($errno)<br />\n";
} else {
    $out = "GET /1.0/vouchers.xml?token=removed HTTP/1.1\r\n"
         . "Host: api.tradedoubler.com\r\n"
         . "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    while (!feof($fp)) {
        $xml .= fgets($fp, 128);
    }
    fclose($fp);
}

if ($xml != '') {
    $xmlObject = simplexml_load_string($xml);
    if ($xmlObject) {
        // do something nasty! or just echo $xml->asXML();
    }
} 
```

# php - WP：如何刷新/重置/提交 wordpress 查询

> ID：13407638
> 
> 赞同：0
> 
> 时间：2012-11-15T22:49:52.177
> 
> 标签：php, mysql, database, wordpress

我有一个非常奇怪的问题。

我在 wordpress 中使用 wp_insert_category() 来创建一个类别并检索新的 id。然后我调用另一个 wp_insert_category 并将此 id 作为`category_parent`参数传递以创建子类别。

然而，这样做真的很奇怪。类别树在整个站点的类别选择字段中可见，但在类别列表中不可见 - 只有父猫在那里可见。此外，使用 get_posts 等函数时，我似乎无法正确检索孩子。

我尝试创建类别并回显 id，然后再次运行相同的脚本，但仅创建具有此 id 硬编码的子类别 - 它成功了！

对我来说唯一合乎逻辑的解释是，wordpress 会以某种方式缓存查询，并且不会在第一次插入时立即执行，因此在关系方面会搞砸。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:05:54.140

我在这里找到了一个很长的讨论[http://core.trac.wordpress.org/ticket/14485](http://core.trac.wordpress.org/ticket/14485)

然而，它并没有帮助。我在这里找到了一个可行的解决方案[https://wordpress.stackexchange.com/questions/49634/weird-behaviour-when-adding-terms-term-taxonomies-programmatically](https://wordpress.stackexchange.com/questions/49634/weird-behaviour-when-adding-terms-term-taxonomies-programmatically)

只需`delete_option('taxonomy-slug_children');`在父类别和子类别的创建之间调用。

# apache-pig - hadoop pig 脚本 - 与条件联合

> ID：13407642
> 
> 赞同：1
> 
> 时间：2012-11-15T22:50:15.130
> 
> 标签：apache-pig, hadoop-streaming

我对猪完全陌生。我想使用 iid 字段合并两个文件 A 和 B，但我不希望输出包含 A 没有的任何 iid（来自 B）。这似乎很简单，但我无法弄清楚如何正确地做到这一点。

这是我的示例代码，只有联合：

```
a = load '$input' as (iid:int, field:chararray, v1:chararray, v2:chararray, v3:chararray);
b = load '$data' as (iid:int, field:chararray, v1:chararray, v2:chararray, v3:chararray);
out = union onschema a,b;
singled = distinct out;
ordered = order singled by iid;
store ordered into '$output'; 
```

下面是只有 3 列的示例数据来描述我的期望。请注意，字段实际上是制表符分隔的。

样本数据A：

```
1  Name   Tom Linkon
1  Title  Professor
2  Name   Whatever
2  Title  Worker 
```

样本数据 B：

```
1  City  New York
2  City  Columbus
3  City  Fake fake
4  City  Blah Bla 
```

样本输出

```
1  Name   Tom Linkon
1  Title  Professor
1  City   New York
2  Name   Whatever
2  Title  Worker
2  City   Columbus 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T14:12:37.920

使用 a`COGROUP`来组织具有相同键的记录，但避免`JOIN`' 的不良叉积。然后`FILTER`根据包含 的记录的包是否`b`为空，拆分回两个关系，然后执行`UNION`：

```
a = load '$input' as (iid:int, field:chararray, v1:chararray, v2:chararray, v3:chararray);
b = load '$data' as (iid:int, field:chararray, v1:chararray, v2:chararray, v3:chararray);
c = COGROUP a BY iid, b BY iid;
c_filt = FILTER c BY NOT IsEmpty(b);
a_new = FOREACH c_filt GENERATE group AS iid, FLATTEN(a);
b_new = FOREACH c_filt GENERATE group AS iid, FLATTEN(b);
out = UNION ONSCHEMA a_new, b_new;
singled = DISTINCT out;
STORE (ORDER singled BY iid) INTO '$output'; 
```

但是，我不喜欢这个解决方案——对于这样一个简单的操作来说，它有太多的行和新的关系。真正需要的是一种将两个袋子合二为一的方法。Pig 显然没有提供这个（如果有，请回答[这个 SO question](https://stackoverflow.com/questions/10661389/how-to-combine-concat-two-bags-in-pig-latin)）。不过，您可以编写一个简单的 UDF 来执行此操作：

```
public class MERGE extends EvalFunc<DataBag> {
    public DataBag exec(Tuple input) throws IOException {
        DataBag b = new DefaultDataBag();
        try {
            if (input != null)
                for (int i = 0; i < input.size(); i++)
                    b.addAll((DataBag) input.get(i));
        } catch (Exception e) { return null; }
        return b;
    }
} 
```

有了这个 UDF，解决方案就变成了：

```
a = load '$input' as (iid:int, field:chararray, v1:chararray, v2:chararray, v3:chararray);
b = load '$data' as (iid:int, field:chararray, v1:chararray, v2:chararray, v3:chararray);
c = FOREACH (COGROUP a BY iid, b BY iid) GENERATE group AS iid, MERGE(a,b) AS bag;
out = FOREACH c {
    uniq = DISTINCT bag;
    GENERATE iid, FLATTEN(bag);
};
STORE (ORDER out BY iid) INTO '$output'; 
```

这种方法的另一个优点是，如果您有多个输入，则不需要`FOREACH`在`COGROUP`. 只需添加更多参数`MERGE`：

```
c = FOREACH (COGROUP a BY iid, b BY iid, ..., z BY iid)
    GENERATE group AS iid, MERGE(a,b,...,z) AS bag; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T09:32:40.477

这里的这个应该可以解决您的问题：

```
f1 = LOAD '/user/hadoop/f1' USING PigStorage('\t') AS (id_f1:int, key_f1:chararray, value_f1:chararray);
f2 = LOAD '/user/hadoop/f2' USING PigStorage('\t') AS (id_f2:int, key_f2:chararray, value_f2:chararray);
f3 = JOIN f1 by id_f1 LEFT OUTER, f2 BY id_f2;
f4 = FOREACH f3 GENERATE id_f1, key_f1, value_f1;
f5 = FOREACH f3 GENERATE id_f2, key_f2, value_f2;
f6 = UNION f4, f5;
f7 = DISTINCT f6;
f8 = ORDER f7 BY $0;
DUMP f8; 
```

# java - JFrame 需要三分钟多的时间来创建

> ID：13407643
> 
> 赞同：1
> 
> 时间：2012-11-15T22:50:17.643
> 
> 标签：java, jframe

就在最近，我回到了一个我有一段时间没做过的项目。我第一次在这个新的编程会话中运行它时，加载需要三分钟。我不知道从现在到我最后一次工作（大约三个月前）之间会发生什么变化，但我知道代码没有改变。

我将问题追溯到 JFrame 构造函数。我找到了这篇文章：

[在 Swing 应用程序启动期间首次调用 JFrame 构造函数需要很长时间（因为 java.awt.Window()）](https://stackoverflow.com/questions/6978017/first-call-to-jframe-constructor-takes-a-long-time-during-swing-application-star)

然而，这似乎确实相关，因为他的问题只花了几百毫秒。我确实使用他的代码进行了简单的测试，我的输出如下：

```
第一个 JFrame 为 202720。
0 表示第二个 JFrame。

```

我正在使用 jdk-7u7-windows-x64。我完全不知道是什么原因造成的，因此我们将不胜感激。

谢谢你。

编辑这是我从链接帖子中复制的代码：

```
import javax.swing.*;
public class Main {
public static void main(String[] args) {
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            long start;

            start = System.currentTimeMillis();
            JFrame frame1 = new JFrame("Frame1");
            System.out.println((System.currentTimeMillis() - start) + " for first JFrame.");

            start = System.currentTimeMillis();
            JFrame frame2 = new JFrame("Frame2");
            System.out.println((System.currentTimeMillis() - start) + " for second JFrame.");

            frame1.setVisible(true);
            frame2.setVisible(true);
        }
    });     
}
} 
```

编辑我已经完成了所有通常的猜测工作

```
+ 重启 Eclipse
+重新启动的Windows
+重新安装Java
+ 导出到 Jar（结果相同）

```

# c# - C# 在没有菜单栏的情况下创建 MDI 子项

> ID：13407650
> 
> 赞同：-2
> 
> 时间：2012-11-15T22:50:39.293
> 
> 标签：c#, .net, mdichild, mdiparent, vb.net-to-c#

我刚刚从使用 .NET 和 VB 切换到使用 C#，我很难创建一个自动加载它的父级的 MDI 子级。所以我有一个父表单（IsMdiContainer = True）。我还有另一个 Windows 窗体，我想将其作为子级分配给主父级，并在初始加载父级时加载它。在 VB 中，这非常简单。在 Mdiparent 中，您只需说 form1.mdiParent = Me（或多或少）和 form1.Show() 以使其与父级一起加载。有没有办法在 C# 中做到这一点？我查看的每个帮助页面都需要使用菜单栏动态创建子项，这不是我想做的事情。有什么帮助吗？抱歉，如果以前有人问过这个问题；在问之前我搜索了高低。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T20:15:33.623

所以在弄明白这个之前，我搞砸了很长时间。显然，我必须首先声明该对象的一个​​实例。
这就是我现在所拥有的：
private void mainParent_Load(object sender, EventArgs e) {
leftPanel LP = new leftPanel(); LP.MdiParent = 这个；LP.Show();
我
希望这可以帮助遇到同样问题的其他人。括号中的第一行确实是我缺少的钱。

# python - Getting an Error Trying to Create an Object in Python

> ID：13407655
> 
> 赞同：1
> 
> 时间：2012-11-15T22:50:50.763
> 
> 标签：python, object, pygame

I am trying to create an object from a class in python but I am getting an Error, "e_tank = EnemyTank() TypeError: 'Group' object is not callable"

I am not sure what this means, I have tried Google but I couldn't get a clear answer on what is causing this error. Does anyone understand why I am unable to create an object from my EnemyTank Class?

Here is my code:

```
#Image Variables
bg = 'bg.jpg'
bunk = 'bunker.png'
enemytank = 'enemy-tank.png'

#Import Pygame Modules
import pygame, sys
from pygame.locals import *

#Initializing the Screen
pygame.init()
screen = pygame.display.set_mode((640,360), 0, 32)

background = pygame.image.load(bg).convert()

bunker_x, bunker_y = (160,0)

class EnemyTank(pygame.sprite.Sprite):
    e_tank = pygame.image.load(enemytank).convert_alpha()
    def __init__(self, startpos):
        pygame.sprite.Sprite.__init__(self, self.groups)
        self.pos = startpos
        self.image = EnemyTank.image
        self.rect = self.image.get_rect()
    def update(self):
        self.rect.center = self.pos

class Bunker(pygame.sprite.Sprite):
    bunker = pygame.image.load(bunk).convert_alpha()
    def __init__(self, startpos):
        pygame.spriter.Sprite.__init__(self, self.groups)
        self.pos = startpos
        self.image = Bunker.image
        self.rect = self.image.get_rect()
    def getCollisionObjects(self, EnemyTank):
        if (EnemyTank not in self._allgroup, False):
            return False
        self._allgroup.remove(EnemyTank)
        result = pygame.sprite.spritecollide(EnemyTank, self._allgroup, False)
        self._allgroup.add(EnemyTank)
    def update(self):
        self.rect.center = self.pos

#Setting Up The Animation
x = 0
clock = pygame.time.Clock()
speed = 250

allgroup = pygame.sprite.Group()
EnemyTank = allgroup
Bunker = allgroup

e_tank = EnemyTank()
bunker = Bunker()5

#Main Loop
while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()

    screen.blit(background, (0,0))
    screen.blit(bunker, (bunker_x, bunker_y))
    screen.blit(e_tank, (x, 0))
    pygame.display.flip()

    #Animation
    milli = clock.tick()
    seconds = milli/1000.
    dm = seconds*speed
    x += dm

    if x>640:
        x=0

    #Update the Screen
    pygame.display.update() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:55:45.210

You've declared a class called **EnemyTank** and then you've overwritten it with this line:

```
EnemyTank = allgroup 
```

EnemyTank after this point is not a class, but a group, and no longer callable. What you want to do is:

```
allgroup pygame.sprite.Group()
e_tank = EnemyTank()
allgroup.add(e_tank)
# Or..
e_tank.add(allgroup) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:56:47.533

Here is your problem :

You instantiate the Group *class* :

```
allgroup = pygame.sprite.Group() : 
```

Then you put the **object** in a EnemyTank variable

```
EnemyTank = allgroup 
```

Then you try to call the EnemyTank **object** :

```
e_tank = EnemyTank() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:57:11.557

Looks like you've instantiated a Group class:

```
allgroup = pygame.sprite.Group() 
```

And then you try to call the object:

```
EnemyTank = allgroup
e_tank = EnemyTank() 
```

I guess pygame.sprite.Group class does not define a `__call__()` method so it cannot be called

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T23:13:29.380

In addition to the already mentioned, I should also add that you are very close in another instance to repeating variable names, and you should really not do that. Here's every instance of something like `EnemyTank` I can see.

```
enemytank = 'enemy-tank.png'
class EnemyTank(pygame.sprite.Sprite):
EnemyTank = allgroup 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T01:47:47.100

You define a class `EnemyTank` but then create a new variable with the same name. `EnemyTank`

> bunker = Bunker()5 # this is also invalid

To use the spritegroups, you do something like

```
player = PlayerTank()
tanks = [ Tank() for x in range(5) ]
tanks.append( player ) 
```

then: drawing

```
tank.draw(screen) 
```

collision: spritecollide or any of the other collision functions in : [http://www.pygame.org/docs/ref/sprite.html](http://www.pygame.org/docs/ref/sprite.html)

see also: [http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group](http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group)

# sharepoint-2007 - MOSS 2007 网站主页上的自定义 Web 部件

> ID：13407657
> 
> 赞同：1
> 
> 时间：2012-11-15T22:50:56.393
> 
> 标签：sharepoint-2007

如何操作自定义 webpart 的权限？我想让自定义 Web 部件对主页上的少数其他用户可见。但我没有找到像 OOB webpart 这样可以使用“目标受众”控制权限的编辑（修改共享 webpart）。

我在 webparts 库中搜索过，我根本没有找到 webpart，因为我单击并检查了库中所有 webparts 的预览。

能否请您帮助如何查找“主页中的自定义 Web 部件是什么？” ?

此自定义 Web 部件显示的超链接很少，仅此而已。

请建议。

# c++ - 如何使用 boost bcp？

> ID：13407664
> 
> 赞同：6
> 
> 时间：2012-11-15T22:51:21.413
> 
> 标签：c++, sql-server, boost, bcp, path-variables

我有 bcp 工具，它是使用 boost 安装程序预先构建的。我想从 boost 中提取我需要的依赖项到一个较小的文件中，因为我希望能够在学校构建这个项目。我正在尝试使用 bcp，但我不明白如何使用它，尽管有这些说明： http: [//www.boost.org/doc/libs/1_52_0/tools/bcp/doc/html/index.html #bcp.syntax](http://www.boost.org/doc/libs/1_52_0/tools/bcp/doc/html/index.html#bcp.syntax)

我尝试在命令提示符下输入：bcp boost/thread.hpp /"E:\documents\Dropbox\School\Comp 445\Comp445_Assign2_v2\boost2"，从我的 boost 文件夹：C:\Program Files (x86)\升压\升压_1_51

它只是吐出一个“使用”指南： bcp {dbtable | 查询} {在 | 出| 查询 | 格式}数据文件

我也试过：bcp timed_mutex /, bcp mutex / 无济于事。

我觉得这真的很令人困惑；它看起来一点也不像他们在 boost 文档中所说的那样，而且我不确定这在任何情况下意味着什么。我发现了很多人们推荐 bcp 的线程，但我很难找到人们询问如何使用它的任何地方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-01T14:14:55.947

正如@Rup 在评论中指出的那样，可能的错误是您的系统上存在 SQL Server 的批量复制程序。该程序也被命名`bcp.exe`并且很可能存在于您的`PATH`环境变量中。Boost`bcp`或者不存在于您的 中`PATH`，或者前面有 SQL `bcp`（一旦找到匹配项，Windows 将停止搜索其他程序）。

要调用 Boost bcp，您应该

1.  将其重命名为其他名称（例如`boost-bcp`）并[**更新您的`PATH`变量**](http://support.microsoft.com/kb/310519)以反映这一点，并确保没有其他冲突名称。然后使用“boost-bcp”--YOUR_OPTIONS 调用。
2.  `bcp`使用当前位置的完整路径调用 Boost ，例如 "C:\Boost\bcp.exe" --YOUR_OPTIONS

# performance - Core Data 导入大量数据

> ID：13407667
> 
> 赞同：1
> 
> 时间：2012-11-15T22:51:30.263
> 
> 标签：performance, core-data, import

当我的 iOS 应用程序首次运行时，我插入了大量实体。我想知道在保存之前我可以在上下文中插入多少项目？我从网络调用中获取了一个大型 JSON 对象。我从 JSON 中提取大量实体并插入它们。

我应该如何处理大量的插入？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:05:12.253

我认为你在保存之前不会有关于上下文大小的问题，但你绝对应该在后台线程上执行它，因为它很可能会冻结应用程序一段时间。如果这仅在您第一次启动应用程序时发生，您可以在主线程上放置进度指示器或其他东西，同时将上下文保存在后台线程上。

有关核心数据的并发上下文保存的详细信息，请参阅[此问题](https://stackoverflow.com/questions/10438218/best-practice-for-a-long-running-foreground-operation-that-uses-core-data)的第一个答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T14:14:24.357

祖宗，

将大量项目导入 Core Data 时需要担心很多问题。

第一个也是最重要的问题是管理内存。大型 JSON 文档会解析成大量的小项目。这些迫使您的驻留 VM 足迹不可逆转地增长。这种驻留足迹是应用程序被操作系统杀死的第一大原因。您可以分配较小的内存，但由于驻留足迹的大小仍然会被杀死。

因此，大型文档应该分阶段进行处理，并进行积极的中间内存清理操作。在操作之间使用带有重置的并发 MOC 是可行的方法。然后我实现了一个尾随修剪模式来清理我的主线程 MOC 中保留的任何多余内存。

安德鲁

# c# - 如何使用数组成员？

> ID：13407669
> 
> 赞同：0
> 
> 时间：2012-11-15T22:51:35.600
> 
> 标签：c#, arrays, struct

为什么在**struct中使用****struct array**时会出错？

 **```
public struct Tables
{
    public string name;
}

public struct Schema
{
    public string name;
    public Tables[] tables; //Declarate struct array in struct
} 
```

我在这段代码中使用了 struct：

```
Schema schema;

private void Form1_Load(object sender, EventArgs e)
{
    schema.name = "schemaName";
    schema.tables[0].name = "tables1Name"; // Error in here: Object reference not set to an instance of an object
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:53:10.167

你需要初始化你的数组：

```
schema.name = "schemaName";
schema.tables = new Tables[10];
schema.tables[0].name = "tables1"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:54:11.297

这是因为`schema.tables`从未初始化，因此为空

尝试

```
private void Form1_Load(object sender, EventArgs e)
{
    schema.name = "schemaName";
    schema.tables = new Tables[5];
    schema.tables[0].name = "tables1"; // Error ini here: Object reference not set to an instance of an object
} 
```**

# mongodb - Mongoose将Number插入为Int32或double，如何强制始终使用double，就像shell一样

> ID：13407671
> 
> 赞同：5
> 
> 时间：2012-11-15T22:51:39.540
> 
> 标签：mongodb, mongoose

当字段为 Number 类型时，mongoose 将根据实际值将其插入为 Int32 或 double：

5 -> Int32 5.3 -> 双倍

实际上，相同的字段具有不同的类型，具体取决于插入的实体。

这不是从 javascript 读取/写入的问题，因为两者都转换为数字。但是，如果您同时使用具有两种类型的强类型语言（如 C#）的驱动程序，这将成为一个问题。

是否可以将 mongoose 配置为始终将数字插入两倍，就像 mongo shell 一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:17:38.933

为此使用[mongoose-double](https://github.com/aheckmann/mongoose-double)类型。

# html - rails触发控制器点击mailto按钮？

> ID：13407672
> 
> 赞同：0
> 
> 时间：2012-11-15T22:51:40.963
> 
> 标签：html, ruby-on-rails, ruby-on-rails-3

在rails中，我希望用户点击mailto按钮，然后在控制器'home'中调用方法'mail'，你是怎么做到的？

这是我的代码，它似乎不能很好地工作......

```
= mail_to boss.email :subject=>boss.subj,    
:body=>"hi boss", :action=>'home#mail' 
```

有没有办法让mail_to为我的邮箱打开一个新窗口？
现在当我点击mail_to然后选择gmail（firefox ubuntu）时，我直接进入gmail......我希望它在新窗口中打开......无论如何要在rails中进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:34:30.530

请准确阅读[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-mail_to 。](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-mail_to)提供是没有意义的

```
:action => 'home#mail' 
```

到 mail_to 方法。这将打开您的默认电子邮件客户端并填写主题、电子邮件地址和正文的值。如果要在控制器中调用动作，则必须使用 link_to。并考虑使用[ActionMailer](http://guides.rubyonrails.org/action_mailer_basics.html)来完成这项任务......

# php - Cron 和 PHP 5.2 - 处理 JSON 的内存问题

> ID：13407675
> 
> 赞同：0
> 
> 时间：2012-11-15T22:51:56.570
> 
> 标签：php, json, memory, loops, cron

我的项目的每个用户都有一个 Cron，每 5 分钟执行一个 php 脚本，执行大约需要 4 分钟。我找不到“更轻松”的方式来做到这一点！

但是现在我面临内存问题，因为有时文件会在同一个“时间空间”中执行，这会使我的虚拟内存增加！

我试图让我的循环更轻，但它们仍然为每个文件消耗 25MB！

如果你们有任何好的解决方案，我将不胜感激:)。这里是

```
for($x = 0; $x <= 14; $x++)
{

    $r = rand(0,7);
    $jsonData = $this->getsomejson($value[$r]);
    if ($this->meta->code == 400){continue;}

    foreach ((array)$jsonData->data as $key=>$value)
    {
        $result = doSomething($value->id,$Token[$x]);
        if ($result==200){$L++;}
        $i++;
        unset($value);
    }      

    unset($r,$jsonData,$value);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:00:06.883

因为我不知道“getsomejson”和“doSomething”背后的代码是什么，所以很难说这里的瓶颈是什么。

如果这些是 2 个非常简单的函数，我猜问题是您必须加载一个巨大的 json 文件，并且您可能会尝试压缩该文件。

否则，您应该提供有关“getsomejson”和“doSomething”功能的更多详细信息，看看是否可以优化这些功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T00:08:27.710

我们可以在cron作业开始时设置一个信号或标记，然后我们检查这个信号或标记以查看是否有作业在运行，如果是，则停止启动新作业，否则，启动它。

我们可以将此信号或标记存储在文件或数据库表中

```
$signal = get_it_from_file(); 
if ($signal < max) {
  //start to do our job
   ..............
   $signal = $signal+1;
   store_it_to_file();
} else {
      //skip it
} 
```

我们可以调整 max 来控制同时运行的作业数量

# sql - SSIS 和 MS SQL Server：从文件名解析文本

> ID：13407677
> 
> 赞同：0
> 
> 时间：2012-11-15T22:52:10.740
> 
> 标签：sql, sql-server, ssis, sql-server-2008-r2

现有流程的快速介绍：SSIS foreach 循环通过在入口路径文件夹中查找任何文本文件将平面文件导入 SQL Server 表，导入后，它将平面文件转储到存档文件夹中。总共有四个平面文件会发生这种情况，因为它只查找任何文本文件，所以没有问题。

然而，提出的新想法是，SSIS 应该运行一个进程，该进程首先从文本文件中捕获日期和状态（从文件名，而不是文件内部），然后将数据与状态一起插入 SQL Server，然后捕获的日期，然后归档文件。这背后的想法是，如果日期晚或早一个月，SSIS 不会导入该文件（或者如果年份错误，它不会导入它）。

所以现在 - SSIS 首先需要检查是否存在四个文件。- 如果存在四个文件，那么它将进入 foreach 循环（至少，我猜这将是解决此问题的最佳方法）。- 在每个循环中，进程需要从文件名中解析日期和状态，并且需要将数据导入 SQL Server，将解析的日期和状态添加到相应的列中。- 然后它需要存档该文件并继续下一个。

我从来没有做过任何解析，我尝试使用表达式和连接字符串来搜索当前的月份和年份，但没有运气。

（最后，我对 C# 知之甚少，所以脚本任务超出了我的范围）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T02:30:11.173

如果没有脚本组件，我看不到这种情况发生。如果是这样，解决方案将是一堆凌乱的表达。

您可以在 vb.net 或 c# 中执行脚本组件。熟悉 system.IO 命名空间。Directory.GetFiles() 方法将返回给定目录中的所有文件。您可以执行 For Each 循环并解析每个文件名。

如果你对 SSIS 很认真，你需要熟悉脚本组件（包括读取和写入变量）、system.io 命名空间，以及如何单步执行组件代码来探索属性。我很少创建不涉及以编程方式访问文件系统的包，无论是解析文件名、读取文件、移动文件还是删除文件。这一切都可以通过 sys.io 完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T02:24:25.703

SSIS 表达式可能不是这项工作的正确工具。

我会考虑一个脚本任务——我一直坚持使用 VB，我发现它更具可读性并达到了相同的结果。这解锁了漂亮的 Try .. Catch 块和非常丰富的 .NET 库，例如正则表达式。你永远不会回头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T15:25:57.993

忘记发布我的解决方案：在不使用任何 C# 或 VB 的情况下，我找到了一种将文件名插入表中并使用 TSQL 解析文件名的方法。使用“执行 SQL 任务”，您可以使用下面的 SQL 语句：

```
INSERT INTO Table VALUES (?) 
```

将项目的字符串变量设置为当前文件的名称，您将在“参数映射”下进行设置。从那里，您将在 SQL 表中获得完整的文件名并可以对其进行解析。

# visual-studio-2010 - 来自客户端对象模型的 ListItem 更新未触发 OnWorkflowItemChanged 活动

> ID：13407679
> 
> 赞同：1
> 
> 时间：2012-11-15T22:52:23.123
> 
> 标签：visual-studio-2010, sharepoint-2010, sharepoint-workflow, workflow-activity, sharepoint-clientobject

我在使用客户端对象模型在文档库中创建文件时遇到困难。我的自定义 Visual Studio 2010 工作流未检测到我在创建文件列表项后对其进行的更新。

我想给出一个基础设施的想法来回答一些可能的问题：

*   将文档上传到 Web 服务，该服务负责将文档实际插入到库中并配置其列表列的值
*   Web 服务正在使用客户端对象模型执行此操作
*   Web 服务使用为商业智能自动化创建的帐户对 SharePoint 站点进行身份验证，该帐户在与 SharePoint 交互时不作为系统帐户运行；但是，它是 SharePoint 所有者的成员
*   自定义工作流程中的操作取决于文件的列表项列被填充，然后才能继续将任务分配给其中两个列中的用户；出于这个原因，我创建了一个 While 活动来监视列表项中的更改，直到这两列不再为空

以下是 Web 服务正在执行的操作的示例。它以商业智能用户身份在 IIS 中运行。我添加了一些评论，说明我预期工作流会适当响应哪些操作。

```
Using client As New ClientContext(My.Settings.SharePointSiteURL)

    // Pre-processing to determine appropriate user ID values for columns

    Dim fci As New FileCreationInformation() With {
        .Content = IO.File.ReadAllBytes(storagePath),
        .Overwrite = True,
        .Url = String.Format("{0}/{1}", theList.RootFolder.ServerRelativeUrl, theFileName)
    }

    Dim theFile As Microsoft.SharePoint.Client.File = theList.RootFolder.Files.Add(fci)

    // Expecting the workflow to be activated here
    client.ExecuteQuery()

    theFile.ListItemAllFields("Project_x0020_Manager") = pmId
    theFile.ListItemAllFields("Project_x0020_Accountant") = paId
    theFile.ListItemAllFields.Update()

    // Expecting the onWorkflowItemChanged activity to be invoked here
    client.ExecuteQuery()
End Using 
```

当文件上传并继续等待来自 SharePoint 的更改事件时，工作流会激活，但该事件永远不会作为 Web 服务操作的直接结果到达。我能够手动修改该项目并成功继续。

使用可能会阻止这些事件正常触发的客户端对象模型时是否有考虑？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T13:18:06.087

Seems like some weird race condition. I was able to partially reproduce your problem with some sample code:

```
using (var client = new ClientContext(ConfigurationManager.AppSettings["Site"]))
{
    client.Load(client.Site);
    client.Load(client.Site.RootWeb);
    var list = client.Site.RootWeb.Lists.GetByTitle("Shared Documents");
    client.Load(list);
    client.Load(list.RootFolder);
    client.ExecuteQuery();
    var fci = new FileCreationInformation()
              {
                  Content = File.ReadAllBytes(ConfigurationManager.AppSettings["File"]),
                  Overwrite = true,
                  Url = list.RootFolder.ServerRelativeUrl + "/" + "file.xml"
               };
    var file = list.RootFolder.Files.Add(fci);
    client.ExecuteQuery();

    //If following 3 lines are commented out, problem you described may or may not occur. I wasn't able to run into problems, when i loaded file and list item before.
    //client.Load(file);
    //client.Load(file.ListItemAllFields);
    //client.ExecuteQuery();

    //Problem also doesn't occur, when i put here
    //System.Threading.Thread.Sleep(1000); 

    //If code just runs here without delay, sometimes i run into issue you described. 
    var itm = file.ListItemAllFields;
    itm["SampleColumn"] = "Test content!";
    itm.Update();
    client.ExecuteQuery();
} 
```

and workflow:

```
public Workflow1()
{
    InitializeComponent();
}

public Guid workflowId = default(System.Guid);
public SPWorkflowActivationProperties workflowProperties = new SPWorkflowActivationProperties();

private void onWorkflowActivated1_Invoked(object sender, ExternalDataEventArgs e)
{
    var comment = "Workflow started!, item SampleColumn is: " +
    workflowProperties.Item["SampleColumn"];
    SPWorkflow.CreateHistoryEvent(workflowProperties.Web, WorkflowInstanceId, 0, workflowProperties.Web.CurrentUser, new TimeSpan(), "Update", comment, string.Empty);
}

private void onWorkflowItemChanged1_Invoked(object sender, ExternalDataEventArgs e)
{
    var comment = "Workflow continous!, item Title is: " +                           workflowProperties.Item["SampleColumn"];
    SPWorkflow.CreateHistoryEvent(workflowProperties.Web, WorkflowInstanceId, 0, workflowProperties.Web.CurrentUser, new TimeSpan(), "Update", comment, string.Empty);
 } 
```

And workflow itself

![Workflow screenshot](../Images/287b2cc1a71b70c15c05a99001d3364e.png)

If you had something different, please let me know. I had myself some problems with declarative workflows which were running on SharePoint library and most of the time i was not able to find nice solution.

# perl - 在 Perl 中调试段错误

> ID：13407681
> 
> 赞同：3
> 
> 时间：2012-11-15T22:52:45.463
> 
> 标签：perl, segmentation-fault, perl-module

我正在尝试调试从 Perl 获得的段错误。

我在用着：

*   Perl 5.8.8
*   网络::SSH2 0.45
*   Libssh2 1.4.2
*   Openssl 0.9.8x（但我对 1.0.1c 也有同样的问题）

当我打电话时会出现问题：

```
my $ssh = Net::SSH2->new(); 
```

我已经用 Perl 调试器`perl -d`（

```
my $self = $class->_new; 
```

段错误后的输出没有帮助：

```
zsh: segmentation fault  perl -d ./test.pl 
```

运行`strace`结束于：

```
open("<snip>/perl/lib/perl5.8/Linux-2.6c2.5-x86_64-64int/Net/SSH2/Listener.pm", O_RDONLY) = 4
ioctl(4, SNDCTL_TMR_TIMEBASE or TCGETS, 0x7fffb9cdc920) = -1 ENOTTY (Inappropriate ioctl for device)
lseek(4, 0, SEEK_CUR)                   = 0
read(4, "package Net::SSH2::Listener;\n\nus"..., 4096) = 804
lseek(4, 90, SEEK_SET)                  = 90
lseek(4, 0, SEEK_CUR)                   = 90
close(4)                                = 0
read(3, "", 4096)                       = 0
close(3)                                = 0
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++ 
```

现在我被困住了。接下来我该怎么做？我如何深入挖掘以找出问题所在？

我唯一不能改变的是我必须使用 Perl 5.8.8（我在这件事上别无选择）。

* * *

`gdb`PSIAlt 建议的方法的输出：

```
Program received signal SIGSEGV, Segmentation fault.
0x000000379ea141dc in __longjmp () from /lib64/ld-linux-x86-64.so.2
(gdb) bt
#0  0x000000379ea141dc in __longjmp () from /lib64/ld-linux-x86-64.so.2
#1  0x0101f58e4fc7bacc in ?? ()
Cannot access memory at address 0x101f58e475b223b
(gdb) 
```

所以，帮不上什么忙...

同样，我真正的问题是“下一步是什么？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T13:47:18.623

它适用于 Ubuntu 12.10 x86_64、perl 5.8.8（由 perlbrew 编译）、libssh2 1.4.2、openssl 1.0.1c 和 Net::SSH2 0.46。

在 Unix/Linux 下，[Net::OpenSSH](https://metacpan.org/module/Net%3a%3aOpenSSH)可能是更好的选择。[它甚至可以通过Net::OpenSSH::Compat](https://metacpan.org/module/Net%3a%3aOpenSSH%3a%3aCompat)模拟大部分 Net::SSH2 API 。

# c# - 会话过期时 401 重定向不起作用

> ID：13407685
> 
> 赞同：0
> 
> 时间：2012-11-15T22:52:51.203
> 
> 标签：c#, jquery, ajax, vb.net, webmethod

还有其他人有这个问题吗？当我谷歌时，互联网只是给了我 401s 上的电话簿。

我已将我的 jQuery ajax 设置为在 web 方法返回 401 时重定向回我的登录页面。

如果有人没有登录并尝试，这很好用，但如果会话过期，它就不起作用。它只是坐在那里。还有其他人有这个问题吗？

提前致谢！

**明晰**

它返回 401，比如说，我在启动后打开浏览器，我的页面仍然被缓存，并且我尝试 ajax 一个 webmethod。发生这种情况时，我对 401 代码的 jQuery 错误处理会重定向到登录页面，就像我告诉它的那样。

**但是**，如果我的会话过期，它看起来会发送 401，但 401 代码的 jQuery ajax 错误处理不会触发。

如果这有帮助，在我较旧的服务器端页面上，当会话到期并且我尝试做某事时，我会得到“用户名和密码不能为空”页面，该页面也无法像往常一样重定向到登录页面。

会话到期的 401 是否与根本没有会话的 401 不同？

感谢大家的贡献！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:58:13.317

这是关于“如何搜索”的答案 - 您要查找的是“http 状态代码 401”，即“未经授权”（RFC2616 即[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) )

当服务器由于某种原因无法验证用户的授权时，返回此错误是非常有意义的。所以我认为没有人对此有任何问题。

# python - Matplotlib：当同一类中的不同函数调用绘图例程时，将多个图绘制为同一图上的子图？

> ID：13407689
> 
> 赞同：1
> 
> 时间：2012-11-15T22:53:04.803
> 
> 标签：python

所以，假设我在 Pendulum 类中有一个函数 plot(self) 调用 plot. 然后我在同一个类 Pendulum 中有另一个函数 plot2(self)，它也调用 plot。我将如何设置 pyplot 以便两个函数将多个图形设置为同一图形上的单独子图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T01:48:01.483

试试这个：

```
import numpy as np
import matplotlib.pyplot as plt

class Pendulum:

    def __init__(self):
        self.fig = plt.figure()

    def plot1(self):
        ax = self.fig.add_subplot(211)
        ax.plot([1,2],[3,4])

    def plot2(self):
        ax = self.fig.add_subplot(212)
        ax.plot([1,2],[4,3])

p = Pendulum()
p.plot1()
p.plot2()
plt.show() 
```

# contacts - Windows Phone 8 自定义联系人存储和扩展属性

> ID：13407695
> 
> 赞同：2
> 
> 时间：2012-11-15T22:54:14.067
> 
> 标签：contacts, windows-phone-8

文档中没有任何关于属性名称的文字可以使用户能够从 withing people hub 启动我们的自定义应用程序 - 就像它与 Skype 一样。

假设我想为 Google Talk 开发自定义 IM 应用程序，并且我想将联系人存储在自定义联系人存储中。我还想允许用户直接从人员中心开始与特定用户的聊天会话。

Skype 做到了这一点。我不明白为什么微软没有公开这个 API/功能，尤其是当我们现在能够通过自定义 Uris 在应用程序之间进行通信时。

有人知道它可以实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:16:28.487

允许通过公共 API 将您自己的联系人添加到人员中心，但不支持在 3rd 方应用程序中添加平板，例如联系人卡片中的*Skype（聊天、音频、视频）平板。*

这是一种受限的合作伙伴能力。

*（免责声明：我在 Skype for Windows Phone 团队工作）*

# javascript - 将 JS 脚本用于“下雨图像”。似乎无法隐藏预加载的图像

> ID：13407703
> 
> 赞同：0
> 
> 时间：2012-11-15T22:54:24.477
> 
> 标签：javascript

我正在尝试在页面上预加载的脚本中隐藏图像。

下面的脚本使图像在点击屏幕时“下雨”。它运行良好，但在单击按钮之前它会在页面上显示预加载的图像本身。我试图隐藏图像，直到按下按钮。

如果有人对如何在功能dispenseMittens() 运行之前隐藏图像有任何见解，我将永远感激不尽:)

谢谢！

```
<script language="javascript">
var pictureSrc = 'mitten.gif'; //the location of the mittens
var pictureWidth = 40;            //the width of the mittens
var pictureHeight = 46;           //the height of the  mittens
var numFlakes = 10;               //the number of  mittens
var downSpeed = 0.01;          
var lrFlakes = 10;         
var EmergencyMittens = false; 

//safety checks. Browsers will hang if this is wrong. If other values are wrong there will just be errors
if( typeof( numFlakes ) != 'number' || Math.round( numFlakes ) != numFlakes || numFlakes < 1 ) { numFlakes = 10; }

//draw the snowflakes
for( var x = 0; x < numFlakes; x++ ) {
    if( document.layers ) { //releave NS4 bug
        document.write('<layer id="snFlkDiv'+x+'"><img src="'+pictureSrc+'" height="'+pictureHeight+'" width="'+pictureWidth+'" alt="*" border="0"></layer>');
    } else {
        document.write('<div style="position:absolute;" id="snFlkDiv'+x+'"><img src="'+pictureSrc+'" height="'+pictureHeight+'" width="'+pictureWidth+'" alt="*" border="0"></div>');
    }
}

//calculate initial positions (in portions of browser window size)
var xcoords = new Array(), ycoords = new Array(), snFlkTemp;
for( var x = 0; x < numFlakes; x++ ) {
    xcoords[x] = ( x + 1 ) / ( numFlakes + 1 );
    do { snFlkTemp = Math.round( ( numFlakes - 1 ) * Math.random() );
    } while( typeof( ycoords[snFlkTemp] ) == 'number' );
    ycoords[snFlkTemp] = x / numFlakes;
}

//now animate
function mittensFall() {
    if( !getRefToDivNest('snFlkDiv0') ) { return; }
    var scrWidth = 0, scrHeight = 0, scrollHeight = 0, scrollWidth = 0;
    //find screen settings for all variations. doing this every time allows for resizing and scrolling
    if( typeof( window.innerWidth ) == 'number' ) { scrWidth = window.innerWidth; scrHeight = window.innerHeight; } else {
        if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
            scrWidth = document.documentElement.clientWidth; scrHeight = document.documentElement.clientHeight; } else {
            if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                scrWidth = document.body.clientWidth; scrHeight = document.body.clientHeight; } } }
    if( typeof( window.pageYOffset ) == 'number' ) { scrollHeight = pageYOffset; scrollWidth = pageXOffset; } else {
        if( document.body && ( document.body.scrollLeft || document.body.scrollTop ) ) { scrollHeight = document.body.scrollTop; scrollWidth = document.body.scrollLeft; } else {
            if( document.documentElement && ( document.documentElement.scrollLeft || document.documentElement.scrollTop ) ) { scrollHeight = document.documentElement.scrollTop; scrollWidth = document.documentElement.scrollLeft; } }
    }
    //move the snowflakes to their new position
    for( var x = 0; x < numFlakes; x++ ) {
        if( ycoords[x] * scrHeight > scrHeight - pictureHeight ) { ycoords[x] = 0; }
        var divRef = getRefToDivNest('snFlkDiv'+x); if( !divRef ) { return; }
        if( divRef.style ) { divRef = divRef.style; } var oPix = document.childNodes ? 'px' : 0;
        divRef.top = ( Math.round( ycoords[x] * scrHeight ) + scrollHeight ) + oPix;
        divRef.left = ( Math.round( ( ( xcoords[x] * scrWidth ) - ( pictureWidth / 2 ) ) + ( ( scrWidth / ( ( numFlakes + 1 ) * 4 ) ) * ( Math.sin( lrFlakes * ycoords[x] ) - Math.sin( 3 * lrFlakes * ycoords[x] ) ) ) ) + scrollWidth ) + oPix;
        ycoords[x] += downSpeed;
    }
}

//DHTML handlers
function getRefToDivNest(divName) {
    if( document.layers ) { return document.layers[divName]; } //NS4
    if( document[divName] ) { return document[divName]; } //NS4 also
    if( document.getElementById ) { return document.getElementById(divName); } //DOM (IE5+, NS6+, Mozilla0.9+, Opera)
    if( document.all ) { return document.all[divName]; } //Proprietary DOM - IE4
    return false;
}

function dispenseMittens() {
if (EmergencyMittens) {
 window.clearInterval(EmergencyMittens);

} else {
EmergencyMittens = window.setInterval('mittensFall();',100);
}
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:56:29.080

为什么不将图像的样式设置为`display: 'none'`直到单击按钮，然后您可以将样式设置回`display: 'inline-block'`下雨之前？

# maven - 为什么我不能在 Glassfish 上展开我的耳朵

> ID：13407705
> 
> 赞同：0
> 
> 时间：2012-11-15T22:54:59.367
> 
> 标签：maven, dependency-injection, java-ee-6, glassfish-3, cdi

我在 netbeans（netbeans 的企业应用程序）中有标准的 maven 项目，它有 1 个 war、1 个 ejb 和 1 个 ear 模块。我想使用@Inject 将我的@Stateless 从ejb 注入到war（REST 类）中，使用它的接口。我已经在项目中正确文件夹中添加了一些beans.xml文件，但是我仍然得到这个：

*部署期间发生错误：加载应用程序时出现异常：WELD-001409 在注入点 [[field] @Inject private pl.edu.amu.wmi.kino.rk.rest 带有限定符 [@Default] 的类型 [LogicBean] 的不明确依赖项.ReportRest.bean]。可能的依赖项 [[会话 bean [class pl.edu.amu.wmi.kino.rk.data.impl.LogicBeanImpl 与限定符 [@Any @Default]; 本地接口是 [LogicBean]，会话 bean [class pl.edu.amu.wmi.kino.rk.data.impl.LogicBeanImpl 带有限定符 [@Any @Default]；本地接口是 [LogicBean]]]。有关详细信息，请参阅 server.log。*

我究竟做错了什么？我已经搜索了整个互联网，但找不到解决方案。我知道这是可能的，因为我和这样的员工一起参与了一个项目。感谢您的帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T06:29:24.273

您正在对接口进行编码，这很好，但是您有两个具有相同限定符的接口实现（在这种情况下是默认的）。如果不使用限定符来消除您想要注入的内容的歧义，CDI 不知道该给您哪个。

我建议创建一个 @Rest 限定符（或 EJB 限定符）并注释类，并使用您想要的实例注释注入点。

# objective-c - 未找到在 10.7 上编译的预期读取数组的方法

> ID：13407706
> 
> 赞同：1
> 
> 时间：2012-11-15T22:55:02.097
> 
> 标签：objective-c, ios, xcode

我有一个我在 10.8 上开发的应用程序，现在我正在尝试在 10.7 上执行代码（据我所知，这是一个 OSX 问题）。不幸的是，以下代码已停止工作：

```
dataViewController.dataObject = self.pageData[index]; 
```

它是数据视图控制器中的一个对象，加载了当前页面数据。这似乎是生成代码的一部分（如果我没记错的话）。我不知道如何解决这个问题；您将如何在旧版本上解决这个问题？抱歉有点含糊...任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:09:30.747

您使用的括号语法是一个新的编译器功能；它解释`array[idx]`为方法调用`'[array objectAtIndexedSubscript:idx]`。

不幸的是，该方法`- objectAtIndexedSubscript:`本身仅包含在较新版本的 SDK 中，因此会导致运行时“对象不响应选择器”错误。

`NSArray`要修复，请为（类似地，为和其他）创建一个类别`NSDictionary`，并添加方法

```
- (id)objectAtIndexedSubscript:(NSUInteger)idx {
  return [self objectAtIndex:idx];
} 
```

# graph - 创建新集并添加到 ArrayList 时出现 NullPointerException

> ID：13407710
> 
> 赞同：0
> 
> 时间：2012-11-15T22:55:19.283
> 
> 标签：graph, arraylist, set, traversal

我不得不遍历一个图表来完成 uni 的作业，并且在使用 Set 时遇到了问题。我已经编写了算法，但由于某种原因，这似乎阻止了它。目前，我在以下第一行收到 NullPointerException（根据 BlueJ）：

```
Set<String> neighboursNames = map.getNeighboursNames(v);
List<String> reachable = new ArrayList<String>(neighboursNames); 
```

当 getNeighboursNames() 方法返回一组字符串作为相邻节点的名称时。我被告知这是正确的使用方法，变量 v 指的是当前节点的当前名称。

有人可以指出我可能出错的地方，因为我真的看不到它，或者让我知道这部分是否没有问题，问题必须出在代码的其他地方。

对此的任何帮助表示赞赏，到目前为止我已经尝试了几件事但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:02:17.590

当您调用“map.getNeighborsNames(v)”时，您的“地图”很可能为空，如果您发布堆栈跟踪，我会更容易提供帮助。

调试模式将非常有助于找到这样的东西:)。

# functional-programming - DrScheme 中的快速排序

> ID：13407715
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:55:53.073
> 
> 标签：functional-programming, lisp, scheme, racket, quicksort

我目前正在学习 Lisp 和 DrScheme 等函数式语言，但有人要求我在 DrScheme 中编写 Quicksort 算法的变体。但是，我有点不知道从哪里开始。

有人可以给我一些关于使用哪些函数和数据类型的指示吗？我显然知道列表、汽车、cdr 和 append 将在做什么方面发挥重要作用。

顺便说一句，我只是在寻找一般的想法来启动。我不一定想要完整的答案。有点毁了它的冒险和乐趣！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T01:40:15.027

快速排序是以函数式风格实现的最简单的排序算法之一。使用此伪代码作为对数字列表进行升序排序的起点，注意您需要的唯一数据结构是标准 Lisp 列表：

```
quicksort(lst)
    if lst is empty
        return empty list
    return quicksort([all the elements < first element in lst])
           + [first element in lst] +
           quicksort([all the elements >= first element in lst]) 
```

“棘手”部分，即获取列表中小于（或大于或等于）第一个元素的所有元素，可以很容易地用[`filter`](http://docs.racket-lang.org/reference/pairs.html#%28part._.List_.Filtering%29)过程来表示。如果您不被允许使用它，那么从头开始实现它的基本功能就很容易了。

另请注意，`+`我的伪代码中的运算符表示`append`三个列表中的一个：小于列表中第一个元素的元素列表、具有列表中第一个元素（枢轴）的单例列表以及大于或等于的元素列表到列表中的第一个元素。

在快速排序的实际实现中，在选择适当的枢轴元素时会更加小心，但对于这个简单的示例来说，就足以取第一个元素了。

# python - Python图像库（PIL），如何将图像压缩成所需的文件大小？

> ID：13407717
> 
> 赞同：11
> 
> 时间：2012-11-15T22:56:01.770
> 
> 标签：python, image, compression

我需要压缩任何上载的图像小于500kb的文件大小，我已经在Google上进行了搜索，而我所能看到的是：

```
 >>> foo = foo.resize((160,300),Image.ANTIALIAS)
 >>> foo.save("path\\to\\save\\image_scaled.jpg",quality=95) 
```

如果我采用这种方法，我将不得不检查压缩后图像是否小于 500kb，如果不是，则选择较低的质量和大小。

有更好的方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-15T23:08:59.520

JPEG 压缩是不可预测的。你描述的方法，压缩&测量&重试，是我知道的唯一方法。

您可以尝试使用不同质量设置压缩一些典型图像，以了解最佳起点，以及猜测设置更改将如何影响大小的方法。这将使您在没有太多迭代的情况下将最佳尺寸归零。

您还可以将类似文件的对象传递给`save`不需要写入磁盘的函数，只需计算字节数。确定最佳设置后，您可以再次将其保存到实际文件中。

编辑：这是一个合适的字节计数文件对象的实现。保存后检查`size`即可。

```
class file_counter(object):
    def __init__(self):
        self.position = self.size = 0

    def seek(self, offset, whence=0):
        if whence == 1:
            offset += self.position
        elif whence == 2:
            offset += self.size
        self.position = min(offset, self.size)

    def tell(self):
        return self.position

    def write(self, string):
        self.position += len(string)
        self.size = max(self.size, self.position) 
```

编辑 2：这是使用上述方法进行的二进制搜索，以`quality`在最少的尝试次数中获得最佳结果。

```
def smaller_than(im, size, guess=70, subsampling=1, low=1, high=100):
    while low < high:
        counter = file_counter()
        im.save(counter, format='JPEG', subsampling=subsampling, quality=guess)
        if counter.size < size:
            low = guess
        else:
            high = guess - 1
        guess = (low + high + 1) // 2
    return low 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T23:49:23.487

我想我会在这里提供我的代码，这样可能会对遇到同样问题的人有所帮助

```
class PhotoField(forms.FileField, object):

    def __init__(self, *args, **kwargs):
        super(PhotoField, self).__init__(*args, **kwargs)
        self.help_text = "Images over 500kb will be resized to keep under 500kb limit, which may result in some loss of quality"

    def validate(self,image):
        if not str(image).split('.')[-1].lower() in ["jpg","jpeg","png","gif"]:
            raise ValidationError("File format not supported, please try again and upload a JPG/PNG/GIF file")

    def to_python(self, image):
        limit = 500000
        img = Image.open(image.file)
        width, height = img.size
        ratio = float(width) / float(height)
        quality = 100
        while len(image.file.read()) > limit:
            width -= 100
            quality -= 10
            height = int(width / ratio)
            img.resize((width, height), Image.ANTIALIAS)
            img.save(image.file.name, "JPEG", quality=quality)
            image.file = open(image.file.name)
            # reset the file pointer to the beginning so the while loop can read properly
            image.file.seek(0)
        return image 
```

[http://james.lin.net.nz/2012/11/19/django-snippet-reduce-image-size-during-upload/](http://james.lin.net.nz/2012/11/19/django-snippet-reduce-image-size-during-upload/)

# jquery - onclick 用于文件名的 div id

> ID：13407719
> 
> 赞同：0
> 
> 时间：2012-11-15T22:56:14.773
> 
> 标签：jquery

我想获取 div 的 id 并用它来调用文件名，但我不知道该怎么做。

例如元素是

```
<p id="smith_janis" class="name">Janis Smith</p> 
```

所以像

```
$(".name").click(function() {
  $(this).get the element's id and turn it into variale maybe?

  $("#text").load(the name of the element +".txt"); or $("#text").load("smith_janis.txt");

}); 
```

我不确定该怎么做，有人可以帮我吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:59:45.563

关闭，你会使用这样的东西：

```
$(".name").click(function() {
  var id = $(this).attr('id');
  $("#text").load(id +".txt");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:59:57.827

采用`.attr()`

```
$(".name").click(function() {
    var id = $(this).attr('id') ;  $(this) is a -- jQuery Object 
             **OR**
    var id = this.id ;   this is a -- DOM Object 
    $("#text").load(id + '.txt');

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T23:00:05.190

看看[`jQuery.attr()`](http://api.jquery.com/attr/)。暗示：

```
var id = $(this).attr('id'); 
```

# php - 无论如何将php中的值转发到第二页？

> ID：13407724
> 
> 赞同：0
> 
> 时间：2012-11-15T22:56:48.927
> 
> 标签：php, mysql, sql, database

我创建了一个 php 站点，以前它只列出具有定义值的产品。我现在已将其更改为包含一系列产品，例如所有产品 WHERE id = "spotlights"

这很好用，所以这意味着我可以将新产品添加到数据库中，但我仍然需要手动添加第二页。例如，从主页上的产品 div 到 www.example.com/spotlight_1.php

PHP 中是否有将我的 index.php 中的数据（例如 ID）传送到下一页？这样我就可以有一个模板 product.php 页面，并且可以使用数据库拉取来回显所需的产品信息。

因此，在 index.php 上，我单击 ID="1" 的产品，然后在 product.php 页面上加载产品 1 的相关数据。

我可以自己编写 php SQL/mySQL 调用，它只是从上一页中携带一个我不理解的值的方法

问候

亨利

**ps** 所有的 ID 和事物已经作为 1 到 3 位的值存储在数据库中，例如 3 或 93 或 254

非常感谢任何建议

问候

亨利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:15:26.270

我不确定我是否正确理解了这一点，但您可以使用 GET 变量将变量从一个页面传递到另一个页面，或者换句话说，使用 URL 中的查询字符串。

因此，在 index.php 中，您将拥有如下链接：

```
<a href="product.php?p=1">Product 1</a> 
```

在第二页 (product.php) 中，您可以使用以下代码获取此变量：

```
$product_id = $_GET['p']; 
```

然后像这样查询你的数据库：

```
$query  = "SELECT * FROM products WHERE id = '" . $product_id . "'";
$result = mysql_query($query); 
```

参考：[http ://www.w3schools.com/php/php_get.asp](http://www.w3schools.com/php/php_get.asp)

注意：请注意查询数据库的方式，前面的代码只是演示如何检索信息，但不是一个安全的解决方案。我建议您检查 PDO (http://php.net/manual/es/book.pdo.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:07:07.883

如果您不关心其他用户查看您的变量，您可以使用 GET，或者您可以使用 POST 不让用户知道您的变量是什么（对于密码提交很有用）

需要提到的一件事是，如果使用 GET (url?key=value)，则需要使用 PHP 的 utf8 enconde 函数对值进行编码，如果使用 POST，则不必担心这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:00:37.097

有很多方法。您可以将数据放入会话变量中，您可以将数据发布到第二页或通过 GET 作为 URL 参数传递数据，甚至可以将数据保存在浏览器 cookie 中。

您可能使用哪种方法可能取决于数据的安全要求以及您是否希望能够严格通过 URL 访问该数据（如果是 URL 参数）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T23:01:12.073

您可以在请求范围内继续传递值，直到您不再需要它（通常在 url ?var=value 中传递），或者如果它需要比请求范围更长时间，您也可以使用会话。

# mysql - 从此 MySQL select+join+group by 中删除“使用临时；使用文件排序”

> ID：13407725
> 
> 赞同：0
> 
> 时间：2012-11-15T22:56:49.107
> 
> 标签：mysql, sql, postgresql

我有以下查询：

```
select 
    t.Chunk as LeftChunk,
    t.ChunkHash as LeftChunkHash,
    q.Chunk as RightChunk,
    q.ChunkHash as RightChunkHash,
    count(t.ChunkHash) as ChunkCount
from
    chunks as t
    join
    chunks as q
    on
        t.ID = q.ID
group by LeftChunkHash, RightChunkHash 
```

以及下面的解释表：

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  t   ALL IDIndex NULL    NULL    NULL    17796190    "Using temporary; Using filesort"
1   SIMPLE  q   ref IDIndex IDIndex 4   sotero.t.Id 12 
```

注意“使用临时；使用文件排序”。

运行此查询时，我很快用完了 RAM（可能是临时表的 b/c），然后 HDD 启动，查询速度减慢到停止。

我认为这可能是一个索引问题，所以我开始添加一些有意义的内容：

```
Table   Non_unique  Key_name    Seq_in_index    Column_name Collation   Cardinality Sub_part    Packed  Null    Index_type  Comment Index_comment
chunks  0   PRIMARY 1   ChunkId A   17796190    NULL    NULL        BTREE       
chunks  1   ChunkHashIndex  1   ChunkHash   A   243783  NULL    NULL        BTREE       
chunks  1   IDIndex 1   Id  A   1483015 NULL    NULL        BTREE       
chunks  1   ChunkIndex  1   Chunk   A   243783  NULL    NULL        BTREE       
chunks  1   ChunkTypeIndex  1   ChunkType   A   2   NULL    NULL        BTREE       
chunks  1   chunkHashByChunkIDIndex 1   ChunkHash   A   243783  NULL    NULL        BTREE       
chunks  1   chunkHashByChunkIDIndex 2   ChunkId A   17796190    NULL    NULL        BTREE       
chunks  1   chunkHashByChunkTypeIndex   1   ChunkHash   A   243783  NULL    NULL        BTREE       
chunks  1   chunkHashByChunkTypeIndex   2   ChunkType   A   261708  NULL    NULL        BTREE       
chunks  1   chunkHashByIDIndex  1   ChunkHash   A   243783  NULL    NULL        BTREE       
chunks  1   chunkHashByIDIndex  2   Id  A   17796190    NULL    NULL        BTREE 
```

但仍然使用临时表。

数据库引擎是 MyISAM。

我怎样才能摆脱使用临时的；在此查询中使用文件排序？

Just changing to InnoDB w/o explaining the underlying cause is not a particularly satisfying answer. Besides, if the solution is to just add the proper index, then that's much easier than migrating to another db engine.

I am new to relational databases. So I'm hoping that the solution is something obvious to the experts.

EDIT1:

ID is not the primary key. ChunkID is. There are approximately 40 ChunkIDs for each ID. So adding an additional ID to the table adds about 40 rows. Each unique chunk has a unique chunkHash associated with it.

EDIT2:

Here's the schema:

```
Field   Type    Null    Key Default Extra
ChunkId int(11) NO  PRI NULL    
ChunkHash   int(11) NO  MUL NULL    
Id  int(11) NO  MUL NULL    
Chunk   varchar(255)    NO  MUL NULL    
ChunkType   varchar(255)    NO  MUL NULL 
```

EDIT 3:

查询的最终目标是创建一个跨文档的单词共现表。ChunkID 是单词实例。每个实例都是与特定文档 (ID) 相关联的单词。每个文档大约有 40 个单词。大约 100 万份文件。因此，与（显然）正在创建的完整交叉产品临时表相比，生成的共现表被高度压缩。也就是说，完整的叉积临时表是 1 百万 * 40 * 40 = 16 亿行。压缩后的结果表估计大约有 4000 万行。

编辑4：

添加 postgresql 标记以查看是否有任何 postgresql 用户可以在该 SQL 实现上获得更好的执行计划。既然如此，那我就换了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T00:16:43.597

使用产生相同结果的查询进行更新。不过也不会更快。

```
Create Index IX_ID On Chunks (ID);

Select
  LeftChunk,
  LeftChunkHash,
  RightChunk,
  RightChunkHash,
  Sum(ChunkCount)
From (
  Select 
    t.Chunk as LeftChunk,
    t.ChunkHash as LeftChunkHash,
    q.Chunk as RightChunk,
    q.ChunkHash as RightChunkHash,
    count(t.ChunkHash) as ChunkCount
  From
    chunks as t
      inner join
    chunks as q
      on t.ID = q.ID
  Group By
    t.ID,
    t.ChunkHash,
    q.ChunkHash 
  ) x
Group By
  LeftChunk,
  LeftChunkHash,
  RightChunk,
  RightChunkHash 
```

摆弄示例测试数据 [http://sqlfiddle.com/#!3/ea1a5/2](http://sqlfiddle.com/#!3/ea1a5/2)

最新的小提琴，将问题重新表述为文字和文档：[http ://sqlfiddle.com/#!3/f5aef/12](http://sqlfiddle.com/#!3/f5aef/12)

将问题重新表述为文档和单词，您有多少文档，多少单词，以及多少文档单词？

另外，使用文档和单词类比，您是否会说您的查询是“对于一起出现在文档中的所有单词对，它们在任何文档中一起出现的频率。如果单词 A`n`在文档中出现次数，单词 B出现`m`次数在同一个文件中，那么这算作`n * m`总次数。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T00:20:27.753

在联接之前汇总表怎么样？

总结可能是：

```
 select count(*) count,
        Chunk,
        ChunkHash
   from chunks
  group by Chunk, ChunkHash 
```

然后加入将是：

```
Select r.Chunk as RightChunk,
       r.ChunkHash as RightChunkHash,
       l.Chunk as LeftChunk,
       l.ChunkHash as LeftChunkHash
       sum (l.Count) + sum(r.Count) as Count
  from (
        select count(*) count,
               Chunk,
               ChunkHash
          from chunks
      group by Chunk, ChunkHash
       ) l
  join (
        select count(*) count,
               Chunk,
               ChunkHash
          from chunks
      group by Chunk, ChunkHash
       ) r on l.Chunk = r.Chunk
 group by r.Chunk, r.ChunkHash, l.Chunk, l.ChunkHash 
```

我不确定的是你在数什么，确切地说。所以我的 SUM() + SUM() 是一个猜测。您可能需要 SUM() * SUM()。

另外，我假设当且仅当 ChunkHash 值相等时，两个 Chunk 值才相等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T22:50:13.143

我从 MySQL 迁移到 PostgreSQL，查询执行时间从 ~1.5 天到 ~10 分钟。

这是 PostgreSQL 查询执行计划：

![在此处输入图像描述](../Images/11bb8873e2033e1589fdc409207d4961.png)

我不再使用 MySQL。

# javascript - javascript 根据键值过滤嵌套对象

> ID：13407728
> 
> 赞同：3
> 
> 时间：2012-11-15T22:57:21.907
> 
> 标签：javascript, filter, nested

我希望通过“step”键的值过滤嵌套的 javascript 对象：

```
var data = {
"name": "Root",
"step": 1,
"id": "0.0",   
"children": [
    {
    "name": "first level child 1",
    "id": "0.1",
    "step":2,
    "children": [
        {
        "name": "second level child 1",
        "id": "0.1.1",
        "step": 3,
        "children": [
            {
            "name": "third level child 1",
            "id": "0.1.1.1",
            "step": 4,
            "children": []},
        {
            "name": "third level child 2",
            "id": "0.1.1.2",
            "step": 5,
            "children": []}

        ]},
                ]}
] 
```

};

```
var subdata = data.children.filter(function (d) {
        return (d.step <= 2)}); 
```

这只是返回未修改的嵌套对象，即使我将过滤器的值设置为 1。.filter 是否适用于嵌套对象，或者我是否需要在此处滚动我自己的函数，建议并更正代码。cjm

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-13T04:51:05.600

递归过滤器函数很容易创建。这是一个示例，它剥离了所有已定义项的 JS 对象`["depth","x","x0","y","y0","parent","size"]`：

```
function filter(data) {
  for(var i in data){
    if(["depth","x","x0","y","y0","parent","size"].indexOf(i) != -1){
       delete data[i]; 
    } else if (i === "children") {
      for (var j in data.children) {
        data.children[j] = filter(data.children[j])
      }
    }  
  }
  return data;
} 
```

如果您想通过其他方式进行过滤，只需使用您选择的过滤功能更新第二行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-25T17:53:19.397

这是过滤嵌套数组的函数：

```
const filter = arr => condition => {
    const res = [];
    for (const item of arr) {
        if (condition(item)) {
            if (!item.children) {
                res.push({ ...item });
            } else {
                const children = filter(item.children)(condition);
                res.push({ ...item, children })
            }
        }
    }
    return res;
} 
```

您唯一需要做的就是将根对象包装到一个数组中以达到自相似性。通常，您的输入数组应如下所示：

```
data = [
    { <...>, children: [
        { <...>, children: [...] },
        ...
    ] },
    ...
] 
```

其中 <...> 代表一些属性（在您的情况下是“名称”、“步骤”和“id”），而“孩子”是可选的服务属性。现在您可以将包装的对象与条件回调一起传递给过滤器函数：

```
filter(data)(item => item.step <= 2) 
```

你会得到你的结构过滤。这里还有一些函数可以处理我刚刚编写的有趣的结构：

```
const map = arr => f => {
    const res = [];
    for (const item of arr) {
        if (!item.children) {
            res.push({ ...f({ ...item }) });
        } else {
            res.push({ ...f({ ...item }), children: map(item.children)(f) });
        }
    }
    return res;
}

const reduce = arr => g => init => {
    if (!arr) return undefined;
    let res = init;
    for (const item of arr) {
        if (!item.children) {
            res = g(res)({ ...item });
        } else {
            res = g(res)({ ...item });
            res = reduce(item.children)(g)(res);
        }
    }
    return res;
} 
```

使用示例：

```
map(data)(item => ({ step: item.step }))
reduce(data)($ => item => $ + item.step)(0) 
```

可能，代码示例并不理想，但可能会将某人推向正确的方向。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-15T23:15:31.180

是的，[`filter`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)适用于*一个*数组（列表），就像一个节点的孩子一样。你有一棵树，如果你想搜索整棵树，你需要使用[树遍历算法](http://en.wikipedia.org/wiki/Tree_traversal)，或者你首先将所有节点放入一个可以过滤的数组中。我相信您可以自己编写代码。

# php - PHP Preg_replace 在具有条件的特定数量的字符之后

> ID：13407731
> 
> 赞同：-1
> 
> 时间：2012-11-15T22:57:35.127
> 
> 标签：php, regex, preg-replace

我已经为此工作了一段时间，但我的正则表达式很弱。

我需要检查一个数字是否为整数（一位数），如果是，则在其上附加一个“.001”。问题是，它位于一行的中间，其中的值用逗号分隔。

材料,1,1,9999;1 4PL1 PB_Mel,, **1** ,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1

**需要是**

材料,1,1,9999;1 4PL1 PB_Mel,, **1.001** ,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1

1.  该行必须以“材料”开头。
2.  有多个 MATERIALS 行。
3.  该值将始终在 5 个逗号之后。

我正在尝试这样的事情来替换数字，但我认为这种方法不太正确：

```
$stripped = preg_replace('/(MATERIALS)(,.*?){4}(,\d+?),/', '\2,', $stripped); 
```

我尝试通过 preg_match_all > for > if 进程，至少让条件工作，但我仍然需要替换这些行。

编辑：我忘记了`preg_match_all`进行循环的那一行。

```
preg_match_all('/MATERIALS.*/', $stripped, $materialsLines);
for($i=0;$i<sizeof($materialsLines[0]);$i++) {
            $section = explode(",",$materialsLines[0][$i]);
            if (strlen($section[5]) == 1) {
                $section[5] .= ".001";
            }
            $materialsLines[0][$i] = implode(",",$section);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T00:11:56.423

这很简单：

```
$str = preg_replace('/^(MATERIALS,(?:[^,]*,){4}\d+)(?=,)/m', "$1.001", $str); 
```

请参阅**[此演示](http://ideone.com/je7Gbi)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:22:00.953

这可以工作：（但idk你的字符串的整个结构）

```
$pattern = '#(MATERIALS,[0-9]{1},[0-9]{1},[0-9]{4};[^,]*,,[^,]),#';
$replacement = '${1}.001,'; // where ${1} references to pattern matches
$string = 'your string'
$matches  = preg_replace($pattern, $replacement, $string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:26:56.437

为什么使用正则表达式？您可以简单地用逗号分解字符串，检查 [5] 中的值，修复它并将字符串重新连接在一起。

```
$str = 'MATERIALS,1,1,9999;1 4PL1 PB_Mel,,1,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1';
$line = explode(',',$str);
if(strpos($line[5],'.')===false){
    $line[5] .= '.001';
}
$str = implode(',', $line); 
```

[http://codepad.org/g4r3pLpS](http://codepad.org/g4r3pLpS)

如果从文件中读取多行：

```
$file = file("someFile.txt");
foreach($file as $key=>$line){
    $line = explode(',', $line);
    if($line[0] == 'MATERIALS'){
        if(strpos($line[5],'.')!==false){
            $line[5] .= '.001';
            $file[$key] = implode(',', $line);
        }
    }
}
file_put_contents("someFile2.txt", implode('',$file)); 
```

如果由于某种原因您必须使用正则表达式，这对我有用：

```
$str = 'MATERIALS,1,1,9999;1 4PL1 PB_Mel,,1,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1
MATERIALS,1,1,9999;1 4PL1 PB_Mel,,1.101,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1
FOO,1,1,9999;1 4PL1 PB_Mel,,1.1,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1
BLAH,1,1,9999;1 4PL1 PB_Mel,,1,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1
MATERIALS,1,1,9999;1 4PL1 PB_Mel,,567,6,0.173,0.173,0.375,0,0.375,0,0,0,0,2,0,1,1';

$str = preg_replace('/^(MATERIALS(,[^,]*){4},)(\d+),/m', '$1$3.001,', $str);
echo $str; 
```

[http://codepad.org/l7FfJlDe](http://codepad.org/l7FfJlDe)

# c++ - 为什么这个 boost::spirit::qi 规则不起作用？

> ID：13407732
> 
> 赞同：1
> 
> 时间：2012-11-15T22:57:36.990
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi, boost-spirit-lex

我有一个定义以下规则的语法：

```
constantValue = qi::token(ID_FLOAT) | qi::token(ID_INTEGER);

postfixExpression = primaryExpression | 
        (postfixExpression >> qi::token(ID_OPENBRACKET) >> qi::token(ID_INTEGER) >> qi::token(ID_CLOSEBRACKET)) |
        (postfixExpression >> qi::token(ID_DOT) >> qi::token(ID_IDENTIFIER));

primaryExpression = qi::token(ID_IDENTIFIER) | 
        constantValue | 
        (qi::token(ID_OPENPAREN) >> primaryExpression >> qi::token(ID_CLOSEPAREN));

ges = postfixExpression >> qi::eoi; 
```

我希望它匹配以下字符串：

> 测试[1] testident.ident

它不应该匹配

> 测试[1.2] testident.5

但它无法匹配前 2 个字符串。

词法分析器构造函数如下：

```
custom_lexer()
    : identifier("[a-zA-Z_][a-zA-Z0-9_]*")
    , white_space("[ \\t\\n]+")
    , integer_value("[1-9][0-9]*")
    , hex_value("0[xX][0-9a-fA-F]+")
    , float_value("[0-9]*\\.[0-9]+([eE][+-]?[0-9]+)?")
    , float_value2("[0-9]+\\.([eE][+-]?[0-9]+)?")
    , punctuator("&>|\\*\\*|\\*|\\+|-|~|!|\\/|%|<<|>>|<|>|<=|>=|==|!=|\\^|&|\\||\\^\\^|&&|\\|\\||\\?|:|,")// [ ] ( ) . &> ** * + - ~ ! / % << >> < > <= >= == != ^ & | ^^ && || ? : ,
{
    using boost::spirit::lex::_start;
    using boost::spirit::lex::_end;

    this->self.add
        (identifier, ID_IDENTIFIER) 
        /*(white_space, ID_WHITESPACE)*/ 
        (integer_value, ID_INTEGER)
        (hex_value, ID_INTEGER)
        (float_value, ID_FLOAT)
        (float_value2, ID_FLOAT)
        ("\\(", ID_OPENPAREN)
        ("\\)", ID_CLOSEPAREN)
        ("\\[", ID_OPENBRACKET)
        ("\\]", ID_CLOSEBRACKET)
        ("\\.", ID_DOT)
        (punctuator, ID_PUNCTUATOR)
        ;

    this->self("WS") = white_space;
} 
```

为什么我找不到上述字符串的匹配项？

谢谢托比亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:11:59.090

我找到了原因——我不得不重新表述规则：

```
postfixExpression = primaryExpression >> *((qi::token(ID_OPENBRACKET) >> qi::token(ID_INTEGER) >> qi::token(ID_CLOSEBRACKET)) | (qi::token(ID_DOT) >> qi::token(ID_IDENTIFIER))); 
```

我不知道为什么它是必要的，但现在它似乎工作了。

# javascript - 获取所有嵌入/对象元素，包括 iframe 中的元素（js/python）

> ID：13407735
> 
> 赞同：0
> 
> 时间：2012-11-15T22:57:39.847
> 
> 标签：javascript, python, html, getelementsbytagname

尝试在给定页面上查找所有 flash 对象实例，包括 iframe 元素内的那些实例。

javascript 中是否有一种方法可以解释 iframe 中的内容，而不仅仅是

```
document.getElementsByTagName("embed")
document.getElementsByTagName("objects") 
```

我也在使用 python 并且可以获取页面的完整源代码，这可以为它提供一个途径吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:36:24.247

正如 Sibi 建议的那样，根据您的目标，使用 jQuery 可能是最简单的。但是，如果您可以访问 Python，则可以使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)。如果您希望以任何方式获取这些链接背后的数据，这将特别有用。

如果这是您希望追求的路线，您可以执行以下操作：

```
from bs4 import BeautifulSoup
soup = BeautifulSoup(page_source)

objects = []
objects.extend(soup.find_all('object'))
objects.extend(soup.find_all('embed')) 
```

如果错过了 iframe 中的对象，您可以添加：

```
iframes = soup.find_all('iframe')
for iframe in iframes:
    objects.extend(iframe.find_all('object'))
    objects.extend(iframe.find_all('embed')) 
```

# jquery - 禁用其他链接的 JQuery Toggle

> ID：13407736
> 
> 赞同：1
> 
> 时间：2012-11-15T22:57:40.877
> 
> 标签：jquery

有没有办法禁用另一个链接，使用切换功能重新启用它们。

到目前为止，这是我的脚本。我想在单击“娱乐”时禁用“军事”，但在切换返回时重新启用链接。

```
$("[href='#Entertainment']").click(function () {
$("#Entertainment").toggle("slow");

});

$("[href='#Military']").click(function () {
$("#Military").toggle("slow");

}); 
```

反正有这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:08:13.323

好吧，我想通了...

这是一个工作示例[**FIDDLE**](http://jsfiddle.net/videsignz/nY2et/)

像这样设置你的html，给链接一个ID

```
<a id='Elink' href='#Entertainment'>Entertainment</a>
<a id='Mlink' href='#Military'>Military</a>
<div id='Entertainment'>EntertainmentContent</div>
<div id='Military'>Military Content</div> 
```

然后在点击时，切换发生后，回调函数会检查相应的分隔符是否可见，如果是，则禁用其他链接，如果不可见，则启用其他链接

```
$("#Elink").on('click', eclick);    
$("#Mlink").on('click', mclick);

function mclick() {

        $("#Military").toggle("slow", function() {
            if ($("#Military").is(':visible')) {
                $("#Elink").attr('href', 'javascript:void(0);').off('click');
            } else {
                $("#Elink").attr('href', '#Entertainment').on('click', eclick);
            }
        });
}

function eclick() {
        $("#Entertainment").toggle("slow", function() {
            if ($("#Entertainment").is(':visible')) {
                $("#Mlink").attr('href', 'javascript:void(0);').off('click');
            } else {
                $("#Mlink").attr('href', '#Military').on('click', mclick);
            }
        });
} 
```

# c++ - 易失性数据成员是否可以轻松复制？

> ID：13407737
> 
> 赞同：10
> 
> 时间：2012-11-15T22:57:42.163
> 
> 标签：c++, c++11, volatile, language-lawyer

在写[这个答案](https://stackoverflow.com/a/13407454/560648)时，我意识到我对我的结论并不像我通常在点击之前所确保的那样有信心`Post Your Answer`。

我可以找到一些相当有说服力的引文来说明数据成员的琐碎可复制性`volatile`要么是实现定义的，要么是完全不允许的：

*   [https://groups.google.com/forum/?fromgroups=#!topic/comp.std.c++/5cWxmw71ktI](https://groups.google.com/forum/?fromgroups=#!topic/comp.std.c++/5cWxmw71ktI)
*   [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48118](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48118)
*   [http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#496](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#496)

但我无法在标准¹本身中支持这一点。特别“令人担忧”的是，在实际标准的最终措辞中，没有迹象表明提议的措辞与 n3159 问题列表相比有所改变。

**那么，什么给了？`volatile`数据成员是否可以轻松复制？**

* * *

¹   C++11

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T06:00:16.367

我看到以下“可简单复制”的定义（C++11 §3.9，第 9 段）：

> ...标量类型、可平凡复制的类类型、此类类型的数组以及这些类型的**cv *限定*版本**统称为*可平凡复制*类型...。

*cv-qualified*根据定义包括`const` *和/或* `volatile`（§3.9.3）。因此`volatile`，如果非限定类型是可平凡复制的（标量或可平凡复制的类类型，或其数组），那么值似乎是显式可平凡复制的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-02-17T13:08:54.057

缺陷报告[CWG496](https://wg21.link/cwg496)和[CWG2094](https://wg21.link/cwg2094)改变了答案。后者 DR 恢复前者。

现在，对于 volatile 非静态数据成员，

*   但是，如果成员是标量类型或可能是其中的多维数组，则不会使该类不可复制
*   如果 的成员是类类型或可能是其中的多维数组，则包含类的隐式声明的复制/移动函数都将被删除，这使得类不可复制（自[CWG1734](https://wg21.link/cwg1734)起）。

# jquery - 在 Jquery Mobile 中检测滚动

> ID：13407738
> 
> 赞同：0
> 
> 时间：2012-11-15T22:57:45.243
> 
> 标签：jquery, jquery-mobile, iscroll

我无法使用 jquery mobile 检测页面是否滚动。`Scrolltop`在任何情况下总是返回 0。

```
 <script>

        var interval = setInterval(function() {

                                   alert($("#articlecontent").scrollTop());
                                   //alert($(window).scrollTop());
                                   //alert($("#maindiv").scrollTop());

                                   }
                                   }, 3000);

    </script>

    <div data-role="page" id="maindiv">
        <div  class="ui-bar ui-bar-b">

        </div>

        <div id='articlecontent' data-role="content" data-iscroll>

          sldfjlkjsl lksjd kls df hjks djkh sdjfkh sjkf 
          jksd jkhsdf jkhsd hjwiuhhfg skd jkshd fkj fkjsg kjhsdkjf 

          sldfjlkjsl lksjd kls df hjks djkh sdjfkh sjkf 
          jksd jkhsdf jkhsd hjwiuhhfg skd jkshd fkj fkjsg kjhsdkjf 

          sldfjlkjsl lksjd kls df hjks djkh sdjfkh sjkf 
          jksd jkhsdf jkhsd hjwiuhhfg skd jkshd fkj fkjsg kjhsdkjf 

        </div>
        <div data-role="footer" data-id="foo1">

        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T03:18:12.927

scrollTop() 仅当该元素有滚动条时才返回大于零的值。在这种情况下，您可以通过将文章 div 的高度设置为小于内容并强制它显示滚动条来进行测试。之后尝试下面的代码并滚动以查看滚动时值的变化。

```
$("#articlecontent").scroll(function(){ console.log($(this).scrollTop()); }); 
```

# php - 如何从 imap_fetchbody 解析日文字符（utf8？）？

> ID：13407739
> 
> 赞同：0
> 
> 时间：2012-11-15T22:57:55.890
> 
> 标签：php, utf-8, imap

我正在拉下一封电子邮件，其中包含英文、中文和日文。我正在使用 PHP/EZComponents 来执行此操作，但是某个日语字符没有通过，所以我正在切换到 php imap_* funcs 以查看它们是否可以工作。

这就是我下面的内容，以及我得到的输出。我需要以某种方式对此进行解码......我知道这已经在整个网络上得到了很好的（阅读：过度/混乱）记录，但我现在没有时间在这方面获得博士学位。任何帮助是极大的赞赏。

```
$hn='{imap.gmail.com:993/imap/ssl}INBOX';
$inbox = imap_open($hn,$username,$password,CL_EXPUNGE);

foreach($emails as $email_number) {
        $ov = imap_fetch_overview($inbox,$email_number,0);
        $msg = imap_fetchbody($inbox,$email_number,2);
       var_dump($msg);

  // doesnt work... .. but right idea?
  // var_dump( utf8_decode($msg) ); 

} 
```

部分输出：

```
<font face=3D"Arial"><span lang=3D"EN-US" style=3D"font-size:10.5pt"><br></=
span></font><font color=3D"navy" face=3D"MS Gothic"><span lang=3D"JA" style=
=3D"font-size:10.5pt">=CC=EC=9A=DD=A4=AC=A4=A4=A4=A4=A4=AB=A4=E9=A1=A2</spa=
n></font></p><p style=3D"margin-right:0pt;margin-bottom:12pt;margin-left:0p=
t">

<font color=3D"navy" face=3D"MS Gothic"><span lang=3D"JA" style=3D"font-siz=
e:10.5pt"><br></span></font></p><p style=3D"margin-right:0pt;margin-bottom:=
12pt;margin-left:0pt"><font color=3D"navy" face=3D"MS Gothic"><span lang=3D=
"JA" style=3D"font-size:10.5pt">xxend</span></font></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-24T07:23:55.240

我也遇到了这个问题，使用**imap_fetchbody**函数来获取邮件正文。

我发现从 imap_fetchbody 获取的字符串已自动转换为[带引号的可打印](https://en.wikipedia.org/wiki/Quoted-printable)字符串。

我通过使用**imap_qprint**函数将获取的字符串正文转换为正确的字符串解决了这个问题。

# python - excel如何找到默认的文件扩展名

> ID：13407744
> 
> 赞同：3
> 
> 时间：2012-11-15T22:58:31.130
> 
> 标签：python, excel, pywin32

我正在尝试使用 python 和 pywin32 编写和创建 excel 文件的应用程序，并且我想使用用户使用的任何版本的 excel 的默认格式和扩展名保存文件。根据他们使用的 excel 版本，默认格式可能是使用“.xlsx”扩展名的“Open XML Workbook”。其他时候，它可能是基本的 excel 格式和“.xls”扩展名。另外，用户可以配置 excel 以使用其他一些默认格式。

我知道如何找到默认格式 (Application.DefaultSaveFormat) - 但我不知道如何确定该格式的默认扩展名。部分问题是我的文件名甚至在扩展名之前往往包含句点：
基本文件名是“filename.BOM”，所以实际文件名应该是“filename.BOM.xls”或“filename.BOM.xlsx”取决于默认格式。

如果我在文件名中没有双句点，一切都会好起来的。因此，如果默认格式为“Open XML Workbook”，Workbook.SaveAs(“filename”) 将创建一个名为“filename.xlsx”的文件。但是 Workbook.SaveAs("filename.BOM") 会创建一个名为“filename.BOM”的文件。当 Excel 在文件名中看到句点时，它不会添加默认扩展名。

我唯一能想到的是保存一个临时文件，从中获取扩展名，然后删除临时文件 - 但这似乎真的很笨拙。有人有更好的解决方案吗？

```
from tempfile import mktemp
from os import path
from os import remove as delfile
class excel:
    def __init__( self):
        self.app = DispatchEx( "Excel.Application" )
    def saveas_default_ext_format( self, workbook, filename):
        # filename - file name with path but without extension

        tmpname = mktemp()

        alerts = self.app.DisplayAlerts
        self.app.DisplayAlerts = False
        workbook.SaveAs( tmpname)
        self.app.DisplayAlerts = alerts

        tmpname = self.app.ActiveWorkbook.FullName
        x, ext = path.splitext( tmpname)
        fullname = filename + ext
        workbook.SaveAs( fullname)

        delfile( tmpname)

        return fullname 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T21:20:56.117

由于很难在一个地方找到包含枚举、值和扩展的列表，所以我就是这样做的。棘手的部分是让枚举工作（参见代码）

```
import win32com
from os.path import splitext

XlFileFormats = [ 
    'xlAddIn'                      , # Microsoft Excel 97-2003 Add-In
    'xlAddIn8'                     , # Microsoft Excel 97-2003 Add-In
    'xlCSV'                        , # CSV
    'xlCSVMac'                     , # Macintosh CSV
    'xlCSVMSDOS'                   , # MSDOS CSV
    'xlCSVWindows'                 , # Windows CSV
    'xlCurrentPlatformText'        , # Current Platform Text
    'xlDBF2'                       , # DBF2
    'xlDBF3'                       , # DBF3
    'xlDBF4'                       , # DBF4
    'xlDIF'                        , # DIF
    'xlExcel12'                    , # Excel12
    'xlExcel2'                     , # Excel2
    'xlExcel2FarEast'              , # Excel2 FarEast
    'xlExcel3'                     , # Excel3
    'xlExcel4'                     , # Excel4
    'xlExcel4Workbook'             , # Excel4 Workbook
    'xlExcel5'                     , # Excel5
    'xlExcel7'                     , # Excel7
    'xlExcel8'                     , # Excel8
    'xlExcel9795'                  , # Excel9795
    'xlHtml'                       , # HTML format
    'xlIntlAddIn'                  , # International Add-In
    'xlIntlMacro'                  , # International Macro
    'xlOpenDocumentSpreadsheet'    , # OpenDocument Spreadsheet
    'xlOpenXMLAddIn'               , # Open XML Add-In
    'xlOpenXMLTemplate'            , # Open XML Template
    'xlOpenXMLTemplateMacroEnabled', # Open XML Template Macro Enabled
    'xlOpenXMLWorkbook'            , # Open XML Workbook
    'xlOpenXMLWorkbookMacroEnabled', # Open XML Workbook Macro Enabled
    'xlSYLK'                       , # SYLK
    'xlTemplate'                   , # Template
    'xlTemplate8'                  , # Template 8
    'xlTextMac'                    , # Macintosh Text
    'xlTextMSDOS'                  , # MSDOS Text
    'xlTextPrinter'                , # Printer Text
    'xlTextWindows'                , # Windows Text
    'xlUnicodeText'                , # Unicode Text
    'xlWebArchive'                 , # Web Archive
    'xlWJ2WD1'                     , # WJ2WD1
    'xlWJ3'                        , # WJ3
    'xlWJ3FJ3'                     , # WJ3FJ3
    'xlWK1'                        , # WK1
    'xlWK1ALL'                     , # WK1ALL
    'xlWK1FMT'                     , # WK1FMT
    'xlWK3'                        , # WK3
    'xlWK3FM3'                     , # WK3FM3
    'xlWK4'                        , # WK4
    'xlWKS'                        , # Worksheet
    'xlWorkbookDefault'            , # Workbook default
    'xlWorkbookNormal'             , # Workbook normal
    'xlWorks2FarEast'              , # Works2 FarEast
    'xlWQ1'                        , # WQ1
    'xlXMLSpreadsheet'             , # XML Spreadsheet
    ]

xl = win32com.client.gencache.EnsureDispatch( "Excel.Application")
'''if you use Dispatch( 'Excel.Application') without having run makepy first,
    the constants from XlFileFormats will not be available.
    See
    http://docs.activestate.com/activepython/2.4/pywin32/html/com/win32com/HTML/GeneratedSupport.html
    http://docs.activestate.com/activepython/2.4/pywin32/html/com/win32com/HTML/QuickStartClientCom.html
    '''
app = xl.Application
app.Visible = 1
book = app.Workbooks.Add(); book.Activate()
print 'DefaultSaveFormat:', app.DefaultSaveFormat

# you cannot access the constants until AFTER you have dispatched excel
constants = win32com.client.constants

print
app.DisplayAlerts = False
for formatName in XlFileFormats:
    formatNum = getattr( constants, formatName)
    print '%-35s: %5d,' % ( formatName, formatNum),
    try: book.SaveAs( r'C:\excel_file_formats\xlbook', formatNum)
    except Exception: print 'could not save this format'
    else:
        wbname, wbext = splitext( book.Name)
        print '"%s"' % ( wbext)
        del wbname, wbext
    #~ raw_input( '    paused')

app.Quit() 
```

这是输出：

```
DefaultSaveFormat: 51

xlAddIn                            :    18, ".xls"
xlAddIn8                           :    18, ".xls"
xlCSV                              :     6, ".csv"
xlCSVMac                           :    22, ".csv"
xlCSVMSDOS                         :    24, ".csv"
xlCSVWindows                       :    23, ".csv"
xlCurrentPlatformText              : -4158, ".txt"
xlDBF2                             :     7, could not save this format
xlDBF3                             :     8, could not save this format
xlDBF4                             :    11, could not save this format
xlDIF                              :     9, ".dif"
xlExcel12                          :    50, ".xlsb"
xlExcel2                           :    16, could not save this format
xlExcel2FarEast                    :    27, could not save this format
xlExcel3                           :    29, could not save this format
xlExcel4                           :    33, could not save this format
xlExcel4Workbook                   :    35, could not save this format
xlExcel5                           :    39, ".xls"
xlExcel7                           :    39, ".xls"
xlExcel8                           :    56, ".xls"
xlExcel9795                        :    43, could not save this format
xlHtml                             :    44, ".htm"
xlIntlAddIn                        :    26, could not save this format
xlIntlMacro                        :    25, could not save this format
xlOpenDocumentSpreadsheet          :    60, ".ods"
xlOpenXMLAddIn                     :    55, ".ods" !!! this one is not right !!!
xlOpenXMLTemplate                  :    54, ".xltx"
xlOpenXMLTemplateMacroEnabled      :    53, ".xltm"
xlOpenXMLWorkbook                  :    51, ".xlsx"
xlOpenXMLWorkbookMacroEnabled      :    52, ".xlsm"
xlSYLK                             :     2, ".slk"
xlTemplate                         :    17, ".xlt"
xlTemplate8                        :    17, ".xlt"
xlTextMac                          :    19, ".txt"
xlTextMSDOS                        :    21, ".txt"
xlTextPrinter                      :    36, ".prn"
xlTextWindows                      :    20, ".txt"
xlUnicodeText                      :    42, ""
xlWebArchive                       :    45, ".mht"
xlWJ2WD1                           :    14, could not save this format
xlWJ3                              :    40, could not save this format
xlWJ3FJ3                           :    41, could not save this format
xlWK1                              :     5, could not save this format
xlWK1ALL                           :    31, could not save this format
xlWK1FMT                           :    30, could not save this format
xlWK3                              :    15, could not save this format
xlWK3FM3                           :    32, could not save this format
xlWK4                              :    38, could not save this format
xlWKS                              :     4, could not save this format
xlWorkbookDefault                  :    51, ".xlsx"
xlWorkbookNormal                   : -4143, ".xls"
xlWorks2FarEast                    :    28, could not save this format
xlWQ1                              :    34, could not save this format
xlXMLSpreadsheet                   :    46, ".xml" 
```

我不知道为什么它无法保存某些格式；但它们似乎不是非常常见或有用的。

此外，xlOpenXMLAddIn 格式也很奇怪。它报告和扩展“.ods”——但这并不是它实际保存的内容。如果您删除已创建的任何文件，则将代码更改为使用 xlOpenXMLAddIn 格式仅运行一次

```
import win32com
from os.path import splitext
from time import sleep

xl = win32com.client.gencache.EnsureDispatch( "Excel.Application")
app = xl.Application
app.Visible = 1
book = app.Workbooks.Add(); book.Activate()
constants = win32com.client.constants

formatName = 'xlOpenXMLAddIn'
formatNum = getattr( constants, formatName)
print 'test_file_format: %s > %s' % ( formatName, formatNum)

app.DisplayAlerts = False
try: book.SaveAs( r'C:\excel_file_formats\xlbook', formatNum)
except Exception: print 'could not save this format'
else:
    wbname, wbext = splitext( book.Name)
    print '"%s" > "%s"' % ( wbname, wbext) 
```

你得到这个：

```
test_file_format: xlOpenXMLAddIn > 55
"Book1" > "" 
```

它创建的文件将命名为“xlbook.xlam”；但 excel 的标题栏显示“Book1 - Microsoft Excel”。所以我不确定这是怎么回事。无论如何，这似乎不是一种非常有用的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:50:12.577

为什么不制作 xlfileformats:extensions 的字典并使用它进行查找：

```
from tempfile import mktemp
from os import path
from os import remove as delfile
class excel:
    def __init__( self):
        self.app = DispatchEx( "Excel.Application" )
        self.dct =     {51:'xlsx',
                        52:'xlsm',
                        50:'xlsb',
                        56:'xls'
                        }

    def saveas_default_ext_format( self, workbook, filename):
        # filename - file name with path but without extension

        fullname = '.'.join((filename, self.dct[self.app.DefaultSaveFormat]))
        workbook.SaveAs( fullname)

        return fullname 
```

我只在示例字典中包含了最常见的格式，但您可以从网络上的许多资源中充实它，例如[这里](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlfileformat)。我没有放入 KeyError 异常处理程序，但您可能需要一个。

祝你好运，迈克

# actionscript-3 - 在 Flash 中，尽管发布为“在第 2 帧中导出”，但许多类似乎在第 1 帧中，为什么？

> ID：13407746
> 
> 赞同：0
> 
> 时间：2012-11-15T22:58:36.137
> 
> 标签：actionscript-3, flash, preloader

我决定添加一个预加载器，因此我将第 1 帧的内容包装在一个对象中并将其全部移动到第 2 帧。我将文档类分配给库中的新对象，并有效地从发布设置中清除了文档类将文档类与主时间线分离。

我进入 Actionscript Settings 并将“Export classes in frame:”选项设置为“2”。如果您查看库，每个符号的“在第 1 帧中导出”选项现在都显示“在第 2 帧中导出”，所以我必须假设它的意思是它所说的。

尽管第 1 帧为空，并且尽管 ActionScript 设置为在第 2 帧中导出类...。生成的大小报告仍报告大多数类在第 1 帧中导出。

我引用了一个 SWC 文件，该文件设置为“合并到代码中”，但不应该在第 2 帧中定义该数据吗？同样，大小报告显示了在第 1 帧中定义的大多数导入定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:31:30.203

我很快就明白了这一点。

问题似乎是在第 2 帧上有一个主文档类的实例。通过简单地在那里有一个实例，它在主时间轴上创建该类型的变量，因此它需要加载该定义以实例化主时间轴帧 1。

解决方案是确保***整个****主时间线*不会以任何方式引用您不想在第一帧中加载的任何类，尤其是您的文档类。相反，使用“getDefinitionByName”实用函数*通过第 2 帧上的代码*实例化您的主文档类。

# jquery - jquery animate 在移动设备上不起作用，但 jquery css 可以，为什么？

> ID：13407748
> 
> 赞同：2
> 
> 时间：2012-11-15T22:58:41.137
> 
> 标签：jquery, mobile, jquery-animate

我正在我正在开发的网站上微调移动设备。但是，我在 jquery 中遇到了一个奇怪的动画问题。这有效：

```
$('.'+myElement).css({'height':topParentH+'px','width':topParentW+'px'}); 
```

但是，这不会：

```
$('.'+myElement).animate({'height':topParentH+'px','width':topParentW+'px'}); 
```

两者都是在“点击”时触发的（在这种情况下是触摸）。

我现在在我的 nexus 7 上使用 chrome 进行测试，所以这是一个基于 webkit 的移动浏览器。

- - - 编辑 - - -

这可能只是因为我使用的是新操作系统（Android 4.2）和测试版浏览器吗？我在 kindle fire 上测试了它（我现在可以拿到的唯一一款基于 Android 的平板电脑），它运行良好。

# java - MVC 模式：当存在包含两个或多个模型数据的视图时会发生什么？

> ID：13407752
> 
> 赞同：1
> 
> 时间：2012-11-15T22:58:48.493
> 
> 标签：java, model-view-controller, web-applications

我尝试了解 Java Web App 的架构 MVC，我正在做一个尝试实现它的项目。但我有一个疑问。我有一个 HTML 表单（视图），用户可以在其中输入一些数据。此表单必须发送到更新 Java Bean（模型）的 servlet（控制器）。在这里一切都好。但是，当表单输入数据影响两个或多个模型时会发生什么？控制器必须如何负责管理这些模型？

因为我认为只能存在 1 个控制器 - 用于 - 1 个模型 ¿ 那是什么模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:04:19.473

控制器将解析表单并相应地更新任意数量的模型。控制器和模型之间没有严格的一对一关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:03:08.950

我会做相反的事情：

1 个视图有 1 个控制器，可以与一个或多个模型对话。这对我来说很有意义，因为模型寿命很长，视图可以很容易地替换，但是当你替换视图时，你必须替换它对应的控制器。

在您的特定情况下，这意味着您`HTML`可以发布到`servlet`可以处理 http 的`POST`，并将其传达给不同的模型。

# javascript - 使用jQuery复制元素伪：悬停样式

> ID：13407753
> 
> 赞同：1
> 
> 时间：2012-11-15T22:58:58.967
> 
> 标签：javascript, jquery, css, hover, pseudo-class

我正在使用 Twitter Bootstrap 和 uploadify 库。

我有按钮 uploadify 创建使用样式，`buttonClass: 'btn btn-primary'`并使用以下方法调整对象的大小（它本身不考虑填充等）：

```
var uploader = $('#document_upload_'+variant_id);
var button = $('.uploadify-button', uploader);
var swfobject = $('object', uploader);

swfobject.css({
    height: button.outerHeight(),
    width: button.outerWidth()
}); 
```

这一切都很好，唯一的问题是我们失去了按钮上的悬停样式。）所以，当对象悬停在上面时，我们需要使用它的悬停样式设置按钮的样式。

我知道以下内容不起作用：

```
swfobject.hover(
    function(){button.mouseover();}, 
    function(){button.mouseleave()}
); 
```

但是由于这是在一般设置中使用的，所有站点都使用引导程序，但它们的样式不同（我无法修改核心引导程序文件）我不能简单地应用另一个类，它与悬停伪类相同.

那么，jQuery 中有没有办法复制元素“悬停样式”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:54:50.827

**jQuery中有没有办法复制元素“悬停样式”？**

不容易。您可以收听[`jQuery.hover()`](http://api.jquery.com/hover/)并使用[`jQuery.css()`](http://api.jquery.com/css/)来获取自定义 CSS，迭代样式，`document.styleSheets`或者您可以尝试像[jss](https://github.com/Box9/jss)这样的库：

```
jss('.button:hover').get()['color'] 
```

JSS JSFiddle：http: [//jsfiddle.net/7kEJ9/2/](http://jsfiddle.net/7kEJ9/2/)

# ios - iOS - UIView 描述框架与调试器 recursiveDescription 框架不匹配

> ID：13407754
> 
> 赞同：1
> 
> 时间：2012-11-15T22:59:11.307
> 
> 标签：ios, xcode, uiview, uiscrollview

`scrollView`我在调试为什么我不会滚动时遇到了这个问题。对于上下文，我的布局结构是：

```
-ScrollView
  - View
     - labels, images, buttons 
```

更新`scrollView.contentSize`以匹配（子）视图不起作用，所以我放入了一些调试语句。结果是视图的框架大小为 0，当我`NSLog`描述它时为 0，但如果我运行调试器`recursiveDescription`，它会显示不同。

知道为什么，这是否会影响我的滚动不起作用的原因？

从`NSLog(@"%@", [self.view description])`

> 2012-11-15 17:16:46.707 Comparo[65731:11303] 开始：<UIView: **0x7144590** ; 帧 = (0 0; **0 0** ); 自动调整大小 = TM+BM；层 = <CALayer: 0x714b4f0>>
> 
> 2012-11-15 17:16:46.708 比较 [65731:11303] 1: <UIView: 0x7144590; 帧 = (0 0; 0 0); 自动调整大小 = TM+BM；层 = <CALayer: 0x714b4f0>>
> 
> 2012-11-15 17:16:46.771 比较 [65731:11303] 2: <UIView: 0x7144590; 帧 = (0 0; 0 0); 自动调整大小 = TM+BM；层 = <CALayer: 0x714b4f0>>
> 
> 2012-11-15 17:16:46.771 比较 [65731:11303] 3: <UIView: 0x7144590; 帧 = (0 0; 0 0); 自动调整大小 = TM+BM；层 = <CALayer: 0x714b4f0>>
> 
> 2012-11-15 17:16:46.772 比较 [65731:11303] 4: <UIView: 0x7144590; 帧 = (0 0; 0 0); 自动调整大小 = TM+BM；层 = <CALayer: 0x714b4f0>>

调试器输出：`(lldb) po [[UIApp keyWindow] recursiveDescription]`

> ...
> 
> | | | | <UIScrollView: 0x71494d0; 帧 = (0 0; 320 504); clipsToBounds = YES; 自动调整大小 = TM+BM；手势识别器 = <NSArray: 0x75d3bb0>; 层 = <CALayer: 0x71f9ed0>; 内容偏移：{0, 0}>
> 
> | | | | | <UIView: **0x7144590** ; 帧=（0 0；**320 523**）；自动调整大小 = TM+BM；层 = <CALayer: 0x714b4f0>>

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:03:30.617

谢谢罗伯！

您认为这是一个时间问题是正确的，并且无法保证帧将在 viewDidLoad （我有我的 NSLog 语句）中完成。我将语句移动到 viewDidAppear:，这是用户首先能够与它们交互并滚动的地方，现在数字匹配了。

奖励：也解决了我的滚动问题。

# php - 分页不显示 PHP PDO

> ID：13407763
> 
> 赞同：0
> 
> 时间：2012-11-15T23:00:06.277
> 
> 标签：php, mysql, pdo

我试图对我的查询进行分页，但没有输出任何内容，任何人都可以看到我哪里出错了吗？我对 PHP/PDO 很陌生

```
else {
try
    {
    $per_page = '3';
    $result = $conn->prepare("SELECT * FROM directory WHERE user_active != ''");
    $rows = $result ->fetchAll();
    $total_records = count($rows);
    $pages = ceil($total_records / $per_page); 
    $page  = (isset ($_GET['page']))  ? (int) $_GET['page'] : 1 ;
    $start = ($page - 1) *  $per_page; 
    $query = $conn->prepare("SELECT * FROM directory WHERE user_active != ''");
    while($row = $query->fetch(PDO::FETCH_ASSOC)){
    echo '<br>' . $row['id'] . '<br>' . $row['First_Name'] . '<br>' . $row['Surname'] . '<br>';
    } ?>
    <br><br>
    <?php
    if ($pages >=  1 && $page <= $pages){
    //if ($page>1 && $page <= $pages){$previous=($page -1); echo '<a href="?page=' .$previous. '">Previous</a>';}
    for($x=1; $x<=$pages; $x++){ echo ($x == $page) ? ' <strong><a href="?page='.$x.'">'.$x.'</a></strong> ' : ' <a href="?page='.$x.'">'.$x.'</a> ';}
    //if ($page>1  && $page <= $pages){ $next=($page+1) ; echo '<a href="?page=' .$next. '">Next</a>';}
    }
    ####################### Close Database #######################
    $db = NULL;
    }
    catch(PDOException $e)
    {
    print 'Exception : '.$e->getMessage();
    } 
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:02:45.927

您永远不会[执行](http://www.php.net/manual/en/pdostatement.execute.php)查询。

```
$result->execute();
$rows = $result ->fetchAll();

$query->execute();
while($row = $query->fetch(PDO::FETCH_ASSOC)){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:22:06.700

此外，最好`LIMIT`在您的查询中使用。像这样的东西：

```
//to get need page
$per_page = 3;
$page  = (isset ($_GET['page']))  ? (int) $_GET['page'] : 1 ;
$result = $conn->prepare(
    "SELECT * FROM directory 
     WHERE user_active != '' 
     LIMIT ".(($page - 1) *  $per_page).", ".$per_page
);
$result->execute();
$rows = $result ->fetchAll();

//to get count of pages
$result = $conn->prepare(
    "SELECT COUNT(*) FROM directory 
     WHERE user_active != ''"
);
$result->execute();
$total-pages = reset($result->fetch(PDO::FETCH_NUM)); 
```

# java - SolrJ 是否支持 MoreLikeThisHandler？

> ID：13407776
> 
> 赞同：0
> 
> 时间：2012-11-15T23:00:43.327
> 
> 标签：java, solr, solrj

是否有任何版本的 SolrJ（Java 的 Solr 客户端）支持 MoreLikeThisHandler 查询？

我指的是 /mlt 处理程序而不是 /select 处理程序，例如：

```
http://someserver:8080/myindex/mlt?fq=PrivacyLevel:0&q=id:62db612065d549b49892a855f85e2aaf&start=0&rows=5&mlt.minwl=3&mlt.mindf=1&mlt.mintf=1&mlt.fl=Name 
```

这里的参考是 MoreLikeThisHandler 文档：[http ://wiki.apache.org/solr/MoreLikeThisHandler](http://wiki.apache.org/solr/MoreLikeThisHandler)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T03:53:13.240

可能想试用补丁@ [SOLR-1085](https://issues.apache.org/jira/browse/SOLR-1085)

# c# - C# 网格分页和 ExtJS 4.1

> ID：13407781
> 
> 赞同：0
> 
> 时间：2012-11-15T23:01:52.220
> 
> 标签：c#, sql-server-2008, grid, paging, extjs4.1

我正在尝试使用 c# 后端在 extjs 网格 pangel 上实现分页工具栏...我该如何开始呢...我尝试使用 start 和 limit 但我不确定它是如何工作的。有人可以帮助我如何在网格中每页发送大约 20 条记录，因为我的网格正在获取所有 500 条数据，这也降低了我的应用程序的速度，下面是我的控制器将 json 发送到我的商店。请帮助

```
 public JsonResult getData(int start, int limit)
 {
   List<MyItem> items = new List<MyItem>();
   using (SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["ApplicationServices1"].ConnectionString))
   {
     SqlCommand cmd = con.CreateCommand();
     cmd.CommandText = "SELECT State, Capital FROM MYDBTABLE";
     con.Open();
     SqlDataReader reader = cmd.ExecuteReader();
     while (reader.Read())
     {
       MyItem item = new MyItem();
       item.State = reader[0].ToString(); 
       item.Capital = reader[1].ToString(); 
       items.Add(item);
     }
     con.Close();

     return Json(new {  myTable = items }, JsonRequestBehavior.AllowGet);
   }
} 
```

这是我的商店

```
this.store = Ext.create('Ext.data.JsonStore', {
        autoLoad: true,
        storeId: 'mystore1',
        pageSize: 20,
        fields: [
    { name: 'State' },
    { name: 'Capital' } 
    ],
        sorters: [
            {
                property: 'State',
                direct: 'ASC'
            }],
        scope: this,
        proxy: {
            type: 'ajax',
            scope: this,
            url: 'StateC/getData',
            autoLoad: { params: {
                start: 0,
                limit: 20
            }
            },
            reader: {
                type: 'json',
                root: 'myTable'
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T00:05:13.310

我目前正在使用 MySQL 和 PHP，所以肯定会错误检查我的语法，但一般逻辑是相似的，但是在 MsSQL 中查询的语法有点模糊。对于 MsSQL 推荐语法的入门，我建议使用此链接：

[http://www.codeguru.com/csharp/.net/net_data/article.php/c19611/Paging-in-SQL-Server-2005.htm](http://www.codeguru.com/csharp/.net/net_data/article.php/c19611/Paging-in-SQL-Server-2005.htm)

首先，您需要获取 extjs 在 ajax 调用中传递的参数：

```
int limit = Request.QueryString["limit"];
int page= Request.QueryString["page"];
int upperBound = limit * page;
int lowerBound = limit * (page - 1) + 1; 
```

我认为您的查询也应该是这样的：

```
SELECT * FROM (
        SELECT 
            ROW_NUMBER() OVER(ORDER BY person) AS rownum, 
            MYDBTABLE.State, 
            MYDBTABLE.Capital 
        FROM MYDBTABLE
    ) AS States
WHERE  States.rownum >= {lowerBound} AND States.rownum <= {upperBound} 
```

# svn - SVNAdmin 创建存储库 URL 不起作用

> ID：13407784
> 
> 赞同：1
> 
> 时间：2012-11-15T23:02:10.310
> 
> 标签：svn, tortoisesvn

我通过 ssh 登录并执行了以下命令：

```
-bash-3.00$ svnadmin create /code/svn/Projects/myproject
-bash-3.00$ chmod -R g+w /code/svn/Projects/myproject
-bash-3.00$ chown -R :eng /code/svn/Projects/myproject 
```

但是我无法连接到存储库 url：

```
 svn+ssh://hostname.com/code/svn/Projects/myproject 
```

我可以很好地连接到 Projects 下的所有其他存储库。

我还做了 mkdir trunk 并在 trunk 下放了一个虚拟文件。

我是否错过了使该存储库可访问的一些步骤？

```
 org.apache.subversion.javahl.ClientException: The system cannot find the file
  specified.

   svn: Unable to connect to a repository at URL 'svn+ssh://thehost.com/code/svn/Proj  ects/myproject'

  svn: Can't create tunnel: The system cannot find the file specified. 
```

# php - php不需要属性？

> ID：13407787
> 
> 赞同：2
> 
> 时间：2012-11-15T23:02:17.487
> 
> 标签：php, arrays, attributes

通常使用java。我今天看到了这样的片段

```
$oStrategie = new Strategie();

foreach($aData as $key=>$value) {
        $oStrategie[$key] = $value;
}

$oStrategie->doSomething() 
```

Strategie 是一个自制的 php 类，没有什么特别之处。简单的构造函数什么都不做，等等。

在 Strategie 类中，方法 doSomething() 访问 $aData 的 ArrayValues

```
$this['array_index_1'] 
```

为什么即使 Strategie 类没有定义任何属性并且没有覆盖 setter 或类似的东西，我也可以访问那里的数组？谁能解释一下那里发生了什么？php中的类中不需要有属性？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:10:10.457

你的类实现了[`ArrayAccess`](http://php.net/arrayaccess)接口。这意味着它实现了以下方法：

```
ArrayAccess {
    abstract public boolean offsetExists ( mixed $offset )
    abstract public mixed offsetGet ( mixed $offset )
    abstract public void offsetSet ( mixed $offset , mixed $value )
    abstract public void offsetUnset ( mixed $offset )
} 
```

这允许您对此类的实例使用数组访问`$var[$offset]`。这是一个像这样的类的标准实现，使用`$container`数组来保存属性：

```
class Strategie implements ArrayAccess {

    private $container = array();

    public function __construct() {
        $this->container = array(
            "something"   => 1,
        );
    }
    public function offsetSet($offset, $value) {
        if (is_null($offset)) {
            $this->container[] = $value;
        } else {
            $this->container[$offset] = $value;
        }
    }

    public function offsetExists($offset) {
        return isset($this->container[$offset]);
    }

    public function offsetUnset($offset) {
        unset($this->container[$offset]);
    }

    public function offsetGet($offset) {
        return isset($this->container[$offset]) ? $this->container[$offset] : null;
    }
} 
```

如果不查看它的实际实现`Strategie`或派生它的类，很难判断它实际在做什么。

但是使用它，您可以控制类的行为，例如，在访问不存在的偏移量时。假设我们替换`offsetGet($offset)`为：

```
public function offsetGet($offset) {
    if (isset($this->container[$offset])) {
        return $this->container[$offset];
    } else {
        Logger.log('Tried to access: ' + $offset);
        return $this->default;
    }
} 
```

现在，每当我们尝试访问一个不存在的偏移量时，它将返回一个默认值（例如：）`$this->default`并记录一个错误，例如。

请注意，您可以使用魔术方法[`__set()`](http://www.php.net/manual/en/language.oop5.overloading.php#object.set)、[`__get()`](http://www.php.net/manual/en/language.oop5.overloading.php#object.get)和来完成类似[`__isset()`](http://www.php.net/manual/en/language.oop5.overloading.php#object.isset)的行为[`__unset()`](http://www.php.net/manual/en/language.oop5.overloading.php#object.unset)。我刚刚列出的魔术方法之间的区别在于`ArrayAccess`您将通过`$obj->property`而不是访问属性`$obj[offset]`

# c# - 具有两个不同子集合的自定义配置部分

> ID：13407789
> 
> 赞同：2
> 
> 时间：2012-11-15T23:02:20.797
> 
> 标签：c#, .net, configuration-files, custom-configuration, configsection

我无法找到/弄清楚如何映射以下自定义配置部分：

```
<section>
    <collection1>
        <subitem1 ... />
        <subitem1 ... />
    </collection1>
    <collection2>
        <subitem2 ... />
        <subitem2 ... />
    </collection2>
</section> 
```

对于单个子集合，以下可能会起作用：

```
public class Section : ConfigurationSection
{
    [ConfigurationProperty("", IsRequired = true, IsDefaultCollection = true)]
    [ConfigurationCollection(typeof(SubItem1Collection), AddItemName = "collection1")]
    public SubItem1Collection Collection1
    {
        get { return (SubItem1Collection)this[string.Empty]; }
        set { this[string.Empty] = value; }
    }
} 
```

当我尝试添加第二个集合时，它不会运行。

```
public class Section : ConfigurationSection
{
    [ConfigurationProperty("", IsRequired = true, IsDefaultCollection = true)]
    [ConfigurationCollection(typeof(TemplateCollection), AddItemName = "collection1")]
    public SubItem1Collection Collection1
    {
        get { return (SubItem1Collection)this[string.Empty]; }
        set { this[string.Empty] = value; }
    }

    [ConfigurationProperty("", IsRequired = true, IsDefaultCollection = true)]
    [ConfigurationCollection(typeof(SubItem2Collection), AddItemName = "collection2")]
    public SubItem2Collection Collection2
    {
        get { return (SubItem2Collection)this[string.Empty]; }
        set { this[string.Empty] = value; }
    }
} 
```

错误是：

> 无法将“SubItem1Collection”类型的对象转换为“SubItem2Collection”类型。

错误显然在 indexer 中`this[string.Empty];`。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:21:27.127

您不能有两个默认集合。要使配置类与您的 xml 示例匹配，您必须分别分配名称“collection1”和“collection2”而不仅仅是“”，并在 ConfigurationProperty 属性中将 IsDefaultCollection 设置为 false，并将 AddItemName 设置为“subitem1”和“subitem2” " 用于 ConfigurationCollection 属性。还要修复@thymine 指出的关于第二个集合类型的内容。

# caching - 在 Symfony 2 中，有没有使用 read() 和 write() 方法与应用程序/缓存缓存交互的好方法？

> ID：13407790
> 
> 赞同：8
> 
> 时间：2012-11-15T23:02:24.867
> 
> 标签：caching, symfony

我想将数据保存到 Symfony 的文件缓存中。有没有使用 read() 和 write() 方法与应用程序/缓存缓存交互的好方法？

编辑

出色的[winzou CacheBundle](https://github.com/winzou/CacheBundle)正是我所需要的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T04:49:03.793

您可以从控制器执行此操作：

```
use Symfony\Component\Filesystem\Filesystem;
use Symfony\Component\Filesystem\Exception\IOException;

//Define your file path based on the cache one
$filename = $this->container->getParameter('kernel.cache_dir') . '/yourapp/filename.txt';

//Create your own folder in the cache directory
$fs = new Filesystem();
try {
    $fs->mkdir(dirname($filename));
} catch (IOException $e) {
    echo "An error occured while creating your directory";
}

//Write your file
file_put_contents($filename, 'Text content');

//Read the content of your file    
echo file_get_contents($filename); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-22T22:28:39.923

请注意，现在推荐使用[DoctrineCacheBundle 。](https://github.com/doctrine/DoctrineCacheBundle)不要被 Doctrine 品牌所误导——这与 ORM 和 DBAL 等不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:43:38.293

不太确定您要实现什么，但您可以查看配置组件文档，特别是 ConfigCache 类：

[http://symfony.com/doc/current/components/config/index.html](http://symfony.com/doc/current/components/config/index.html)

[http://symfony.com/doc/current/components/config/caching.html](http://symfony.com/doc/current/components/config/caching.html)

# razor - 从 Razor 块返回字符串的最紧凑的语法是什么？

> ID：13407797
> 
> 赞同：1
> 
> 时间：2012-11-15T23:03:16.020
> 
> 标签：razor, syntax, return-value

返回字符串的最短语法是什么？可以解决如下代码的问题（只是一个示例，请不要通过说--使用 CSS 类来“解决”这个问题）：

```
<p style="@{ if (foo.isBar) { <text>font-weight:bolder</text> } }">... 
```

*可能是我有史以来最短的问题。*

**更新：**适用于 MVC 3 的剃刀。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:31:48.337

也许是这样的：

```
<p style="@(foo.isBar ? "font-weight:bolder" : "")"> 
```

或者

```
<p style="@(foo.isBar ? "font-weight:bolder" : "font-weight:bold" )"> 
```

# python - 如何使用 Cython 运行 pybench

> ID：13407799
> 
> 赞同：0
> 
> 时间：2012-11-15T23:03:24.970
> 
> 标签：python, benchmarking, cython

我刚刚在 Windows 2008 服务器上安装了 Python 2.7，并成功执行了名为 PYBENCH 的基准测试。

现在，我安装了 Cython（通过现有的 Python 安装）并且我想运行相同的基准测试。我的问题是：如何在 Cython 而不是 Python 上运行基准测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T08:21:08.333

你需要：**Cython、Python 和一个 C 编译器**和一个“ *file.py* ”

编译、链接并运行：

```
$ cython --embed file.py   # <- embed a main() function

$ gcc $CFLAGS -I/usr/include/python2.6 -o out_name file.c -lpython2.6 -lpthread -lm -lutil -ldl

$ ./out_name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T01:08:48.647

Cython 不是 Python 的替代品。它是一种在语法上接近 Python 的不同语言。一般来说，它不能开箱即用地运行现有的 Python 程序。

如果您想要更快地替代 Python，请尝试 PyPy。不过不要对 PyBench 感到困惑 --- 你会看到一个巨大的加速（至少 1000 倍？），但这是因为 PyPy 优化掉了大部分基准测试，它没有做任何事情. 有关更合理的基准，请参阅[http://speed.pypy.org/](http://speed.pypy.org)。

# php - PHP + Facebook：如何将照片上传到墙上？

> ID：13407800
> 
> 赞同：2
> 
> 时间：2012-11-15T23:03:29.940
> 
> 标签：php, facebook, facebook-graph-api, photo, facebook-page

我在页面墙上发布消息的通常方式是：

```
 $args = array(
            'access_token'  => $page_access_token,
            'message'       => $title,
            'link'          => $link,
            'name'          => 'This is title',
            'description'   => 'This is a testing of the posting on page',
            //'picture'     => 'http://www.example.com/directory/images/30.jpg'
        );

        $post_id = $facebook->api("/$pageId/feed","post",$args); 
```

但是我怎样才能将图像发布到我的墙上 - 替代方法：单击上传按钮，选择图像 -> 并上传，图像在墙上。

我的 FTP 上有一些图像，这些图像我想上传到我的墙上。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T23:06:57.747

[https://developers.facebook.com/blog/post/498/](https://developers.facebook.com/blog/post/498/)这个链接可以帮助你...

以下是使用 Graph API 上传照片的一些不同方法。这些示例假设您已经实例化了 $facebook 对象并拥有一个有效的会话。

1 - 当前用户的默认应用相册 此示例将照片上传到当前用户的默认应用相册。如果相册尚不存在，则会创建该相册。

`$facebook->setFileUploadSupport(true); $args = array('message' => 'Photo Caption'); $args['image'] = '@' . realpath($FILE_PATH);`

`$data = $facebook->api('/me/photos', 'post', $args);` `print_r($data);` 2 - 目标相册` 此示例将照片上传到特定相册。

`$facebook->setFileUploadSupport(true); $args = array('message' => 'Photo Caption'); $args['image'] = '@' . realpath($FILE_PATH);`

`$data = $facebook->api('/'. $ALBUM_ID . '/photos', 'post', $args); print_r($data);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T23:33:58.450

我没有使用 Facebook API 包括，所以我试图将 Facebook 的东西只使用 curl 请求直接集成到 Graph API URL。

因此，要在用户墙上发布图像，我发现最简单的方法就是指明图像 URL。

```
<?php
$url = "https://graph.facebook.com/me/photos?access_token=" . $FacebookToken;
$url = $url . "&url=" . urlencode("http://www.url.to/the/image.jpg");
$url = $url . "&message=" . urlencode($Description);
$url = $url . "&method=POST";

$data = file_get_contents($url); // Can change to curl if
                                 // file_get_contents is blocked on your host
?> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-30T01:04:38.833

这是一个简短的示例，从我的代码中恢复：

```
$fbPost = curl_init();
curl_setopt($fbPost, CURLOPT_RETURNTRANSFER, true);
curl_setopt($fbPost, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($fbPost, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($fbPost, CURLOPT_POST, true);
curl_setopt($fbPost, CURLOPT_ENCODING, 'gzip');

$photoInfo = array(
    'access_token' => <USER_ACCESS_TOKEN>,
    'name' => <IMAGE_DESCRIPTION>,
    'url' => <ABSOLUTE_URL>/images/photo.jpg',
);

curl_setopt($fbPost, CURLOPT_URL, 'https://graph.facebook.com/<USER_ID>/photos');
curl_setopt($fbPost, CURLOPT_POSTFIELDS, $photoInfo);
$result = json_decode(curl_exec($fbPost), true);
curl_close($fbPost); 
```

# azure - Azure 上 NServicebus 的 ReturnToSourceQueue.exe

> ID：13407806
> 
> 赞同：0
> 
> 时间：2012-11-15T23:03:59.407
> 
> 标签：azure, nservicebus

将已移至错误队列的消息移回具有 Azure 传输配置的 nservicebus 处理队列的最佳策略是什么？

ReturnToSourceQueue.exe 仅适用于 MSMQ。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:19:40.820

我为此使用[Cerebrata Cloud Storage Studio](http://www.cerebrata.com/products/cloud-storage-studio/introduction) ……但任何存储资源管理器工具都可以。

如果您有很多消息要移动，或者有很多不同的队列。恐怕您必须创建自己的 ReturnToSourceQueue.exe 版本。

亲切的问候，伊夫

# c# - 如何解决查询中的 NotMapped 属性？

> ID：13407807
> 
> 赞同：1
> 
> 时间：2012-11-15T23:04:04.080
> 
> 标签：c#, entity-framework, entity-framework-5

我有看起来像这样的方法：

```
 private static IEnumerable<OrganizationViewModel> GetOrganizations()
    {
        var db = new GroveDbContext();

        var results = db.Organizations.Select(org => new OrganizationViewModel
        {
            Id = org.OrgID,
            Name = org.OrgName,
            SiteCount = org.Sites.Count(),
            DbSecureFileCount = 0,
            DbFileCount = 0
        });

        return results;
    } 
```

这是非常迅速地返回结果。

但是，您会注意到 OrganizationViewModel 必须具有设置为“0”的属性。我通过部分类添加并用 [NotMapped] 修饰的组织模型中有一些属性：UnsecureFileCount 和 SecureFileCount。

如果我将那些 0 更改为有用的东西...

```
 DbSecureFileCount = org.SecureFileCount,
   DbFileCount = org.UnsecureFileCount 
```

...我得到“仅支持初始化程序、实体成员和实体导航属性”异常。我觉得这有点令人困惑，因为我不觉得我在向数据库询问它们，我只是在设置视图模型的属性。

但是，由于 EF 没有听我的论点，我尝试了一种不同的方法：

```
 private static IEnumerable<OrganizationViewModel> GetOrganizations()
    {
        var db = new GroveDbContext();

        var results = new List<OrganizationViewModel>();
        foreach (var org in db.Organizations)
        {
            results.Add(new OrganizationViewModel
            {
                Id = org.OrgID,
                Name = org.OrgName,
                DbSecureFileCount = org.SecureFileCount,
                DbFileCount = org.UnsecureFileCount,
                SiteCount = org.Sites.Count()
            });
        }

        return results;
    } 
```

从技术上讲，这毫无例外地给了我正确的结果，但这需要很长时间。（“永远”是指超过 60 秒，而第一个版本在一秒钟内提供结果。）

有没有办法优化第二种方法？或者有没有办法让第一种方法发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:30:48.043

另一种选择是将值作为匿名类型加载回来，并通过这些循环加载您的视图模型（n+1 很可能是速度缓慢的原因）。

例如：

```
var results = db.Organizations.Select(org => new
        {
            Id = org.OrgID,
            Name = org.OrgName,
            DbSecureFileCount = org.SecureFileCount,
            DbFileCount = org.UnsecureFileCount,
            SiteCount = org.Sites.Count()
        }).ToList();

var viewmodels = results.Select( x=> new OrganizationViewModel
{
    Id = x.Id,
        Name = x.Name,
        DbSecureFileCount = x.DbSecureFileCount,
        DbFileCount = x.DbFileCount,
        SiteCount = x.SiteCount
}); 
```

抱歉格式化；我在手机上打字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T21:29:51.620

您基本上是在循环的每次迭代中延迟加载每个对象，从而导致 n+1 个查询。

您应该做的是将整个集合带入内存，然后从那里使用它。

示例代码：

```
var organizationList = db.Organizations.Load();
foreach (var org in organizationList.Local)
    {
       //Here you are free to do whatever you want
    } 
```

# iphone - 应用程序在 Debug 上运行良好，但在 AdHoc 上运行良好

> ID：13407812
> 
> 赞同：1
> 
> 时间：2012-11-15T23:04:32.863
> 
> 标签：iphone, objective-c, xcode, crash, adhoc

我有一个可以在调试（设备和模拟器）上完美运行的应用程序，但是一旦我为 AdHoc 存档它，它就会崩溃。

即使选择了分发配置文件 y clic 播放并且工作正常。

现在，如果我通过 AdHoc 制作一个 .ipa ......它会加载并崩溃...... 1seg ......甚至没有打开。

我想也许出了点问题，但是如果有的话，我到底怎么能找到错误呢？我没有任何日志消息，它是一个很大的应用程序。

任何想法？

谢谢。

* * *

```
 By the way, this is what I get:

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libobjc.A.dylib                 0x38af35d0 objc_msgSend + 16
1   CoreFoundation                  0x39a0d4e8 CFURLCopyScheme + 144
2   CoreGraphics                    0x318e6e28 CGDataProviderCreateWithURL + 44
3   CoreGraphics                    0x318ffc5c CGPDFDocumentCreateWithURL + 4
4   READERSoft                      0x000e10f0 CGPDFDocumentCreateX (CGPDFDocument.m:42)
5   READERSoft                      0x000aeab4 -[ContentViewController viewDidLoad] (ContentViewController.m:56)
6   UIKit                           0x332ce544 -[UIViewController loadViewIfRequired] + 360
7   UIKit                           0x3330ed2c -[UIWindow addRootViewControllerViewIfPossible] + 60
8   UIKit                           0x3330aac8 -[UIWindow _setHidden:forced:] + 360
9   UIKit                           0x3334c19c -[UIWindow makeKeyAndVisible] + 56
10  READERSoft                      0x000b618a -[AppDelegate application:didFinishLaunchingWithOptions:] (AppDelegate.m:44)
11  UIKit                           0x3330fa74 -[UIApplication _handleDelegateCallbacksWithOptions:isSuspended:restoreState:] + 248
12  UIKit                           0x3330f5f8 -[UIApplication _callInitializationDelegatesForURL:payload:suspended:] + 1164
13  UIKit                           0x33307806 -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 694
14  UIKit                           0x332afcea -[UIApplication handleEvent:withNewEvent:] + 1006
15  UIKit                           0x332af778 -[UIApplication sendEvent:] + 68
16  UIKit                           0x332af1ba _UIApplicationHandleEvent + 6194
17  GraphicsServices                0x39b435f4 _PurpleEventCallback + 588
18  GraphicsServices                0x39b43222 PurpleEventCallback + 30
19  CoreFoundation                  0x39a743e4 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 32
20  CoreFoundation                  0x39a74386 __CFRunLoopDoSource1 + 134
21  CoreFoundation                  0x39a7320a __CFRunLoopRun + 1378
22  CoreFoundation                  0x399e6238 CFRunLoopRunSpecific + 352
23  CoreFoundation                  0x399e60c4 CFRunLoopRunInMode + 100
24  UIKit                           0x33306440 -[UIApplication _run] + 664
25  UIKit                           0x3330328c UIApplicationMain + 1116
26  READERSoft                      0x000b5f5a main (main.m:9)
27  READERSoft                      0x000ae89c start + 36 
```

# regex - 使用 grep 拆分字符串的 Shell 脚本

> ID：13407813
> 
> 赞同：8
> 
> 时间：2012-11-15T23:04:32.553
> 
> 标签：regex, string, shell, scripting, grep

我的 shell 脚本中有一个变量，形式为

```
myVAR = "firstWord###secondWord" 
```

我想使用 grep 或其他一些工具将其分成两个变量，以便最终结果是：

```
myFIRST = "firstWord"
mySECOND = "secondWord" 
```

我该怎么做呢？#{3} 是我想要拆分的内容。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-15T23:09:11.683

使用替换`sed`：

```
echo $myVAR | sed -E  's/(.*)#{3}(.*)/\1/'
>>> firstword

echo $myVAR | sed -E  's/(.*)#{3}(.*)/\2/'
>>> secondword

# saving to variables
myFIRST=$(echo $myVAR | sed -E  's/(.*)#{3}(.*)/\1/')

mySECOND=$(echo $myVAR | sed -E  's/(.*)#{3}(.*)/\2/') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T23:06:31.517

最好的工具是[sed](/questions/tagged/sed "显示标记为“sed”的问题")：

```
$ echo "firstWord###secondWord" | sed 's@###@\
@'
firstWord
secondWord 
```

一个完整的例子：

```
$ read myFIRST mySECOND < <(echo "$myvar" | sed 's@###@ @')

$ echo $myFIRST 
firstWord

$ echo $mySECOND 
secondWord 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T23:38:34.530

```
$ STR='firstWord###secondWord'
$ eval $(echo $STR | sed 's:^:V1=":; /###/ s::";V2=": ;s:$:":')
$ echo $V1
firstWord
$ echo $V2
secondWord 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-16T09:02:21.940

这就是我使用 zsh 的方式：

```
myVAR="firstWord###secondWord"
<<<$myvar sed 's/###/ /' | read myFIRST mySECOND 
```

# regex - ios NSRegularExpression 麻烦

> ID：13407820
> 
> 赞同：1
> 
> 时间：2012-11-15T23:05:32.300
> 
> 标签：regex, cocoa, nsregularexpression

我正在尝试在 xcode 中做一个基本的正则表达式并且它不合作。

```
NSString *urlString = @"http://www.youtube.com/v/3uyaO745g0s?fs=1&amp;hl=en_US";

NSError *error = nil;
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"/.*?v=(.*)&.*/" options:NSRegularExpressionCaseInsensitive error:&error];
NSTextCheckingResult *fmis = [regex firstMatchInString:urlString options:0 range:NSMakeRange(0, [urlString length])];

if(fmis) {
    NSRange match = [fmis range];
    NSLog(@"%i", match.location);
} 
```

本质上，我只是想吸`3uyaO745g0s`出 urlString。我认为正则表达式是最好的方法？感谢您查看我的问题。

** 编辑 **

有时 url 看起来像这样：`http://www.youtube.com/watch?v=3uya0746g0s`我也必须从中捕获 vid。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:27:50.987

`NSURL`我认为创建一个对象并让它为你发挥它的魔力要容易得多：

```
NSString *urlString = @"http://www.youtube.com/v/3uyaO745g0s?fs=1&amp;hl=en_US";
NSURL *url = [NSURL URLWithString:urlString];

// Since you're targeting the last component of the url
NSString *myMatch = [url lastPathComponent]; //=> 3uyaO745g0s 
```

[您可以在此处](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html#//apple_ref/doc/uid/20000301-SW21)找到有关如何访问`NSURL`对象各个部分的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:43:15.070

Youtube URL 有多种类型。也许你可以试试这个

```
NSString *urlString = @"http://www.youtube.com/v/3uyaO745g0s?fs=1&amp;hl=en_US";
NSString *regEx = @"[a-zA-Z0-9\\-\\_]{11}";
NSRange idRange = [urlString rangeOfString:regEx options:NSRegularExpressionSearch];
NSString *youtubeID = [urlString substringWithRange:idRange]; 
```

[我在这里](https://stackoverflow.com/a/8389216)找到了这个正则表达式。而且您不必`NSRegularExpression`用于简单的搜索:)

我认为这是一个很好的解决方案，但是如果您想要更可靠的结果，请在该答案中尝试另一个正则表达式。

# php - 将csv导入mysql

> ID：13407821
> 
> 赞同：0
> 
> 时间：2012-11-15T23:05:38.477
> 
> 标签：php, mysql, csv, import

我已经看到了关于这个问题的几个问题，但没有一个能够帮助我。

这是我正在使用的脚本。

```
<?php  

//connect to the database 
$connect = mysql_connect("localhost","username","password"); 
mysql_select_db("mydatabase",$connect); //select the table 
// 

if ($_FILES[csv][size] > 0) { 

    //get the csv file 
    $file = $_FILES[csv][tmp_name]; 
    $handle = fopen($file,"r"); 

    //loop through the csv file and insert into database 
    do { 
        if ($data[0]) { 
            mysql_query("INSERT INTO contacts (contact_first, contact_last, contact_email) VALUES 
                ( 
                    '".addslashes($data[0])."', 
                    '".addslashes($data[1])."', 
                    '".addslashes($data[2])."' 
                ) 
            "); 
        } 
    } while ($data = fgetcsv($handle,1000,",","'")); 
    // 

    //redirect 
    header('Location: import.php?success=1'); die; 

} 

?> 

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<title>Import a CSV File with PHP & MySQL</title> 
</head> 

<body> 

<?php if (!empty($_GET[success])) { echo "<b>Your file has been imported.</b><br><br>"; } //generic success notice ?> 

<form action="" method="post" enctype="multipart/form-data" name="form1" id="form1"> 
  Choose your file: <br /> 
  <input name="csv" type="file" id="csv" /> 
  <input type="submit" name="Submit" value="Submit" /> 
</form> 

</body> 
</html> 
```

它可以正常工作，但您不能定义标题行。

如果可能的话，我想要做的是从第一行获取每一列并使用它来定义将项目放置在数据库中的列。

所以我想拆分`$data[0]`成 csv 文件中定义的每一列。我尝试过使用`LOAD DATA LOCAL INFILE`，但由于某种原因它对我不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:32:56.633

您可能想先抓取第一行并从中创建列列表字符串：

```
<?php

if ($_FILES[csv][size] > 0) { 

    //get the csv file 
    $file = $_FILES[csv][tmp_name]; 
    $handle = fopen($file,"r"); 

    // get headers
    $columns = fgetcsv($handle,1000,",","'");
    $column_list = implode(",",$columns);

    //loop through the csv file and insert into database 
    while ($data = fgetcsv($handle,1000,",","'")) { 
        if ($data[0]) { 
        for ($i=0;$i<count($columns);$i++){
            $data[$i]="'".mysql_real_escape_string($data[$i])."'";
        }
        $values = implode(",",$data);

        $query = "INSERT INTO contacts ($column_list) ($values)";

        mysql_query($query);

        } 
    }

    //redirect 
    header('Location: import.php?success=1'); die; 

} 
```

# addition - 在texboxes中添加数字

> ID：13407827
> 
> 赞同：0
> 
> 时间：2012-11-15T23:06:02.360
> 
> 标签：addition

我有 7 个文本框。我想添加 7 的值并将总数插入另一个文本框。我如何在没有回发的情况下实现这一目标。我也尝试过更新面板，但它不起作用。我的代码如下。在这方面的任何建议都会非常明显

If Page.IsPostBack Then

```
 Dim A1 As Double
        A1 = A_SAtxt.Text
        Dim A2 As Double
        A2 = A_SStxt.Text
        Dim A3 As Double
        A3 = A_RAtxt.Text
        Dim A4 As Double
        A4 = A_CAtxt.Text
        Dim A5 As Double
        A5 = A_OItxt.Text
        Dim A6 As Double
        A6 = A_ICtxt.Text
        Dim A7 As Double
        A7 = A_Otxt.Text

        Dim ATotal = A1 + A2 + A3 + A4 + A5 + A6 + A7 
```

万一

我使用 VB 在 asp.net 中工作。asp.net中的文本框代码如下

```
 <table width="100%">
                            <tr>
                                <td align="left" style="border:1px solid #cccccc; text-        align: right; background-color: #F0F0F0;" 
                                    valign="top" class="style7" width = "400px">
                                    <asp:Label ID="Label154" runat="server" Text="Savings account $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">

                                    <asp:TextBox ID="A_SAtxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label155" runat="server" Text="Stock and securities $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">

                                    <asp:TextBox ID="A_SStxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label156" runat="server" Text="Retirement accounts $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:TextBox ID="A_RAtxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label157" runat="server" Text="Checking account $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:TextBox ID="A_CAtxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label158" runat="server" Text="Other investments $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:TextBox ID="A_OItxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label159" runat="server" Text="Insurace cash-in-value $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:TextBox ID="A_ICtxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label160" runat="server" Text="Other $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:TextBox ID="A_Otxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="30"></asp:TextBox>
                                    <asp:Label ID="Label188" runat="server" Text="specify:" Font-Italic="true"></asp:Label>
                                    <asp:TextBox ID="A_OStxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" Width="250px" MaxLength="100"></asp:TextBox>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: right; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:Label ID="Label161" runat="server" Text="Total assets $"></asp:Label>
                                </td>
                                <td align="center" class="style7" 
                                    style="border:1px solid #cccccc; text-align: left; background-color: #F0F0F0;" 
                                    valign="top">
                                    <asp:TextBox ID="A_TAtxt" runat="server" CssClass="DrpItems10" 
                                        style="text-align: left" MaxLength="25"></asp:TextBox>
                                </td>
                            </tr>
                        </table>
                         </ContentTemplate>
                                </asp:UpdatePanel> 
```

我什至尝试过这样做，但它似乎不起作用

```
 Dim sb As New System.Text.StringBuilder()
        sb.Append("<script type = 'text/javascript'>")
        sb.Append(" $(document).ready(function() {")
        sb.Append(" var numberInput = $('#A_SAtxt, #A_SStxt, #A_RAtxt, #A_CAtxt,                 

                #A_OItxt, #A_ICtxt, #A_Otxt');")
        sb.Append("  numberInput.on('change', function() {")
        sb.Append(" var total = 0;")
        sb.Append("else{")
        sb.Append(" numberInput.each(function() {")
        sb.Append("  if ($(this).val() !== '') {")
        sb.Append("  total += parseFloat($(this).val());")
        sb.Append(" }")
        sb.Append(" });")
        sb.Append(" $('#A_TAtxt').val(total);")
        sb.Append("  });")
        sb.Append(" });​")

        sb.Append("}};</script>")
        ClientScript.RegisterClientScriptBlock(Me.GetType(), "function", sb.ToString()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T11:28:30.220

您可以使用 jQuery 或 javascript 计算 7 个输入框的总和，并将该值插入到客户端的另一个输入中。

**JAVASCRIPT**

```
var total = 0;

$('#A_SAtxt, #A_SStxt, #A_RAtxt, #A_CAtxt, #A_OItxt, #A_ICtxt, #A_Otxt').each(function() {
    if ($(this).val() !== '') {
        total += parseFloat($(this).val());
    }
});

$('#A_TAtxt').val(total); 
```

**演示**

这是此代码的示例：http:
[//jsfiddle.net/AWGsw/2/](http://jsfiddle.net/AWGsw/2/)

****编辑 1* ***

要在页面加载时调用此函数并立即在输入模糊上添加值，请执行以下操作：

**JAVASCRIPT**

```
$(document).ready(function() {

    var numberInput = $('#A_SAtxt, #A_SStxt, #A_RAtxt, #A_CAtxt, #A_OItxt, #A_ICtxt, #A_Otxt');

    numberInput.on('change', function() {
        var total = 0;

        numberInput.each(function() {
            if ($(this).val() !== '') {
                total += parseFloat($(this).val());
            }
        });

        $('#A_TAtxt').val(total);
    });

}); 
```

**演示**

[http://jsfiddle.net/AWGsw/4/](http://jsfiddle.net/AWGsw/4/)

# python - 动态模块 Python

> ID：13407829
> 
> 赞同：0
> 
> 时间：2012-11-15T23:06:07.553
> 
> 标签：python, module

我有一个程序可以使用文件操作创建一个名为“cool”的模块。我后来说`import cool`，然后使用`cool`创建的模块。

这是我的目录

```
project/
    main.py
    modules/
        maker.py
        cool/          #this folder and its contents was made by maker.py
            __init__.py 
            coolm.py 
```

如果我想把我的程序做成`.exe`格式，这个策略就行不通了。有谁知道另一种技术？

注意：我不能`exec`使用该`cool`模块..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:12:00.897

在需要时导入模块，如下所示：

```
coolmod = __import__('coolm')
coolm.someproperty 
```

或者，您可以尝试：

```
import importlib
coolmod = importlib.import_module('coolm', 'cool') 
```

这允许您将包名称指定为第二个参数。

# xamarin.ios - 自定义绘图 MT.D 边框

> ID：13407831
> 
> 赞同：1
> 
> 时间：2012-11-15T23:06:16.840
> 
> 标签：xamarin.ios, monotouch.dialog

我一直在玩 MT.D，并且喜欢这一切的简单性。

我现在一直在研究一个完全由所有者绘制的单元格，它使用 UIView 来完成所有绘图，并使用一个允许我将其与 MT.D 一起使用的元素。

现在我似乎唯一缺少的是控制如何绘制（或不绘制）边界的能力。如果我将模式设置为 Grouped，那么我会得到缩进和圆形边框，而 Plain 我会得到简单的水平边框。

但是假设我想为我的边框使用图像或更厚的边框，我该如何自定义呢？

# php - 使用锚指定链接加载位置

> ID：13407832
> 
> 赞同：0
> 
> 时间：2012-11-15T23:06:17.493
> 
> 标签：php, javascript, jquery, html

我有一个重新加载当前页面的简单链接。如下所示：

```
echo '<a href="#" id ="mybutton"></a>'; 
```

当我单击链接时，它会将我带到页面顶部。

**请问如何修改它以将我带回链接所在的位置？**

**我还想给它一个偏移量，这样位置就不会一直在顶部，但会有一点填充**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:09:03.703

尝试给`<a>`标签一个`name`字段？然后修改`href`直接回到它 - 即：

`<a name="thisPosition" href="#thisPosition" id="mybutton">...</a>;`

编辑：为了反映评论，这里是一个附录 - 'name' 字段不是严格要求的，现在大多数（如果不是全部）浏览器可以简单地识别 'id' 属性，因此可以修改 href：，`href="#mybutton"`放弃“名称”属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:12:48.327

也许您想使用这个 Javascript，它会刷新页面，就像按 F5 或单击刷新按钮一样。浏览器会记住这个位置。

```
<a href="javascript:location.reload()">Refresh</a> 
```

# ruby-on-rails - 用于在 RoR 上使用图像进行调查的宝石

> ID：13407833
> 
> 赞同：1
> 
> 时间：2012-11-15T23:06:20.847
> 
> 标签：ruby-on-rails, ruby, image, survey

我是 RoR 的新手，我正在寻找可以创建调查和支持图像的 GEM。我已经尝试过 Surveyor，它似乎非常适合纯文本调查（我肯定会再次使用它进行调查）。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:16:56.250

最简单的方法是使用该 gem 生成 HTML，然后使用生成的 HTML 并将其放入`html.erb`并使用图像更新它。

您可以在浏览器上使用开发人员工具查看生成的 HTML。

否则，您将不得不自己编写或向该 gem 添加新方法。

# javascript - 自定义用户创建的谷歌地图？

> ID：13407837
> 
> 赞同：0
> 
> 时间：2012-11-15T23:06:36.650
> 
> 标签：javascript, google-maps

我想知道是否可以将在 google.com 上创建的地图（带有一些行）插入使用 v3 api 的 javascript 中。我试图阅读它/谷歌它，但我找不到任何东西所以我猜这是不可能的？

如果是， - 如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:14:57.800

我认为 ImageMapType 对你有好处。 [https://developers.google.com/maps/documentation/javascript/reference#ImageMapType](https://developers.google.com/maps/documentation/javascript/reference#ImageMapType)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:21:01.227

如果您谈论的是在[maps.google.com](http://maps.google.com)上的“我的地点”中创建的地图，这些地图可以作为 KML 访问，可以使用[KmlLayer在 Google Maps API v3 地图上显示](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)

[在“我的地点”中创建的地图](https://maps.google.com/maps/ms?msid=215141252881397372270.0004ce6eeb9cf1a94e100&msa=0)

[使用 KmlLayer 在 Google Maps API v3 地图上显示的相同 KML](http://www.geocodezip.com/v3_GoogleEx_layer-kml_linkto.html?filename=https%3A%2F%2Fmaps.google.com%2Fmaps%2Fms%3Fauthuser%3D0%26vps%3D2%26hl%3Den%26ie%3DUTF8%26msa%3D0%26output%3Dkml%26msid%3D215141252881397372270.0004ce6eeb9cf1a94e100)

要在评论中回答您的其他问题，最简单的方法是[从文档中获取示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/layer-kml)并将 URL 替换为您的 URL。所以是的，您只需将初始化函数第一行中的文件名 URL 更改为您的 KML 的 URL：

```
function initialize() {
  filename = 'http://gmaps-samples.googlecode.com/svn/trunk/ggeoxml/cta.kml'; 
```

# vb.net - 在 SSIS 的脚本任务中使用变量

> ID：13407840
> 
> 赞同：1
> 
> 时间：2012-11-15T23:06:55.530
> 
> 标签：vb.net, ssis

我正在使用带有连接到脚本任务的执行 SQL 任务的 SSIS 包。来自执行 SQL 任务的值存储在一个变量中，在脚本任务中，我使用以下代码提供 XML 文件。

```
Public Sub Main()
    If My.Computer.FileSystem.FileExists("C:\SAMPLE.xml") Then
        Dts.TaskResult = ScriptResults.Failure
    Else
        My.Computer.FileSystem.WriteAllText("C:\SAMPLE.xml", Dts.Variables(0).Value.ToString, False)
        Dts.TaskResult = ScriptResults.Success
        ''
    End If
End Sub 
```

我不想硬编码 XML 的路径。因此，我创建了两个新变量 FileName 和 FilePath，以包为范围。如何编辑我的 VB.Net 代码以实际使用这两个变量。我试过这个但没有奏效：

```
 Sub Main()
    If My.Computer.FileSystem.FileExists(Dts.Variables("FileDest").Value.ToString())        Else
        My.Computer.FileSystem.WriteAllText(Dts.Variables("FileDest").Value.ToString(), Dts.Variables(0).Value.ToString, False)Dts.TaskResult = ScriptResults.Success
   ''
    End If
End Sub 
```

理想情况下，我想使用两个变量，一个用于名称，一个用于路径，但是当我尝试使用结合了两者的单个变量时，它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T23:41:54.123

我怀疑您的部分问题是在`Variables`集合中使用数字索引。添加`FileDest`变量后，无法保证用于存储执行 SQL 任务结果的任何变量仍然是集合中的第 0 个变量。

假设带有 Execute SQL Task 结果的变量是命名`XmlQueryResults`的，下面应该可以解决问题：

```
Public Sub Main()
    Dim filePath As String = Dts.Variables("FileDest").Value
    Dim xmlToWrite As String = Dts.Variables("XmlQueryResults").Value
    If My.Computer.FileSystem.FileExists(filePath) Then
        Dts.TaskResult = ScriptResults.Failure
    Else
        My.Computer.FileSystem.WriteAllText(filePath, xmlToWrite, False)
        Dts.TaskResult = ScriptResults.Success
    End If
End Sub 
```

（不要忘记将`FileDest`变量添加到脚本任务编辑器脚本选项卡中的 ReadOnlyVariables。）

# api - 现有 url 上的 pushState，刷新导致历史记录中的双 url

> ID：13407843
> 
> 赞同：1
> 
> 时间：2012-11-15T23:07:11.167
> 
> 标签：api, refresh, double, history, pushstate

我有问题。明显地。

首先，对不起我的英语不好。然后...

我在 HTML5 中将 History.js 用于 pushState 和 History API 的其他功能。但这不是重点。

例子：

我有这个 url，用 pushState 生成，www.mysite.it/picture/2，它显示了一个带有图片的灯箱。当我通过按键或单击加载更多图像时，pushState 将 url 更改为下一个（或上一个）url（例如 www.mysite.it/picture/3）。

问题是这样的：当我刷新页面时，该站点指向 www.mysite.it/picture/2 的真实页面，这没关系，但是，当我单击“返回”按钮时，我在历史记录中有相同的 url (www.mysite.it/picture/2) 第二次。我认为这是因为当我刷新时我创建了一个新的历史记录行。

...我不知道如何解决这个问题。请帮忙 ：）

**问题解决了**

我已经在 if 之外编写了 pushState 函数来确定用户按下了什么键。因此，当按下 cntrl+r 进行刷新时，历史记录中又添加了一行。xD

# facebook - 对象调试器返回 503 错误

> ID：13407849
> 
> 赞同：1
> 
> 时间：2012-11-15T23:08:03.740
> 
> 标签：facebook, webserver

在我正在处理的网站上，我从对象调试器中得到了很多 503 错误：

[http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.yoganonymous.com%2Fthe-traveling-yogi-how-to-stay-cool-as-a-黄瓜跨时区%2F](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.yoganonymous.com%2Fthe-traveling-yogi-how-to-stay-cool-as-a-cucumber-across-time-zones%2F)

在使用帖子上的共享按钮时（大约 50% 的时间使用它），我也丢失了缩略图，我认为这是相关的。一个示例帖子：

[http://www.yoganonymous.com/featured-teacher/dan-wilf/](http://www.yoganonymous.com/featured-teacher/dan-wilf/)

所有正确的开放图元标记都在那里。我现在对如何解决这个问题几乎没有想法。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:14:35.167

缺少元标记`<meta property="og:image" content="SRC HERE" />`

阅读此[https://developers.facebook.com/bugs/214401762018741](https://developers.facebook.com/bugs/214401762018741)

# c# - 将 UserControl(s) 绑定到 ListView

> ID：13407851
> 
> 赞同：0
> 
> 时间：2012-11-15T23:08:13.293
> 
> 标签：c#, wpf, xaml

我在 C# 和 VS2010 中有以下内容：

```
- a MainWindow.xaml with a ListView
- a MainViewModel with an ObservableCollection of objects of type, UnitData
- a UnitDataDisplay.xaml with a bunch of labels tied to members of UnitData 
```

我需要在我的 ListView 中显示可变数量的 UnitDataDisplay，这应该基于 MainViewModel 的 ObservableCollection 的 UnitData。XAML 中将 ListView 项绑定到多个 UserControl 对象而不破坏 MVVM 关注点分离的语法到底应该是什么？我的意思是我可以很容易地让我的 ObservableCollection 包含一堆 UnitDataDisplay 对象，但这会迫使我的 MainViewModel 了解视图详细信息。

我的 MainWindow XAML 文件如下所示：

```
<Window x:Class="ListViewTest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="350">
    <Grid>
        <ListView Height="234" HorizontalAlignment="Left" Margin="12,28,0,0" Name="listView1" VerticalAlignment="Top" Width="304" ItemsSource="{Binding Path=UnitDataDisplay}"/>
    </Grid>
</Window> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:27:16.410

一种常见的方法是使用基于模型类型 ( ) 的隐式[数据模板](http://msdn.microsoft.com/en-us/library/ms742521.aspx)`UnitData`：

```
<Window.Resources>
   <DataTemplate DataType="{x:Type local:UnitData}">
      <local:UnitDataDisplay />
   </DataTemplate>
</Window.Resources> 
```

然后，如果您不希望列表中的每个项目都是可选的，我会将您更改`ListView`为 a`ListBox`或a 。`ItemsControl`

我还会认真考虑[使用 MVVM 框架](http://www.lhotka.net/weblog/UsingTheMVVMPatternRequiresAFramework.aspx)而不是上述方法，例如[Caliburn.Micro](http://caliburnmicro.codeplex.com/)，它使这样的视图组合变得更加容易，以及许多其他优点。

# c++ - 安全复制对象的替代方法

> ID：13407852
> 
> 赞同：0
> 
> 时间：2012-11-15T23:08:17.363
> 
> 标签：c++, memory-management, memory-leaks, copy-constructor

我发现很难找到关于安全复制新类对象而不处理复制构造函数的在线参考。我正在为一个名为“CLabel”的子类开发一个构造函数方法，教授对这个特定构造函数的逻辑（这是 3 个中的第一个）的评论如下：

“这个构造函数安全地复制了一个 CLabel，以保证没有内存泄漏。”

函数头如下：

```
CLabel::CLabel(const CLabel& L) 
```

现在看看类本身的上下文，它的声明中没有明确的数据成员。所以我现在的问题是如何制作一个通过不包含数据成员的引用传递的类实例的深层副本。

到目前为止，这是我的破解 - 它可以编译，但 Visual Studio 发现了一个异常 - “t1.exe 中 0x770F380B (ntdll.dll) 处的未处理异常：0xC0000374：堆已损坏（参数：0x7710CDD8）。”：

```
*this = L;
 int l = L.width();
 this->_data = new char[l+1];
 int i = 0;
 for(; i < l; i++)
    ((char*)_data)[i] = ((char*)L._data)[i];
 ((char*)_data)[i] = '\0'; 
```

异常在测试文件的这一行被捕获：

```
int mesIndx = D.add(new CLabel(7, 5, 40)); 
```

对于此特定作业的尽可能多的上下文，API 的文档位于[http://zenit.senecac.on.ca/wiki/index.php/The_CUI_Framework_-_OOP344_20132#CLabel](http://zenit.senecac.on.ca/wiki/index.php/The_CUI_Framework_-_OOP344_20132#CLabel)

感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:16:57.657

我认为老师的评论是关于如果你必须创建一个缓冲区来复制CLabel的内容，那么你必须确保它最终会被销毁。

例如：如果你的 CLabel 有一个像 'char *' 这样的成员和一个大小你将不得不创建一个新的缓冲区（malloc）并且不要忘记删除。

更简单的解决方案是使用 std::string 成员设计 CLabel 类，该成员将自动管理缓冲区并分配释放内存，避免任何内存泄漏

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:31:21.850

该标头描述了一个复制构造函数，因此如果分配是要实现它，那么您需要查看您在复制构造函数上找到的文档。一般来说，它们是在 C++ 中复制对象的正确方法。

至于他所说的防止内存泄漏是什么意思，我必须更多地了解这项任务。复制构造函数的目的通常是防止与内存泄漏相反的情况，即双重删除/悬空指针。

# c++ - 对具有指针的结构向量进行排序

> ID：13407853
> 
> 赞同：0
> 
> 时间：2012-11-15T23:08:18.913
> 
> 标签：c++, c

下面是我的代码：

```
typedef struct
{
  unsigned page;
  unsigned slot; 
} RID;

//Below struct has the Key on which I want to apply the sorting
struct LeafDataEntry
{
    void *key;
    RID rid;
};

//This is the sorting function I am using
bool leadNode_Key_asc( const LeafDataEntry &a, const LeafDataEntry &b){

    return strcoll((char *)a.key, (char *)b.key) > 0;
            //(strcmp((char *)a.key, (char *)b.key) > 0);
}

int main(){

    vector<LeafDataEntry> lde;

    char a[4] = {'D', 'B', 'C', 'D'};
    RID aRID = {0,0};
    char b[4] = {'A', 'C', 'B', 'A'};
    RID bRID = {0,1};

    unsigned size = sizeof(unsigned);

    lde.resize(2);
    char *tempPtr = (char *)malloc(8 + sizeof(RID));

    memcpy(tempPtr, &size, 4);
    tempPtr += 4;
memcpy(tempPtr, a, 4);

    tempPtr -= 4;
    lde[0].key = malloc(8);
    memcpy(lde[0].key, tempPtr, 8);
    memcpy(&lde[0].rid, &aRID, sizeof(RID));

    memcpy(tempPtr, &size, 4);
    tempPtr += 4;
    memcpy(tempPtr, b, 4);

    tempPtr -= 4;
    lde[1].key = malloc(8);
    memcpy(lde[1].key, tempPtr, 8);
    memcpy(&lde[1].rid, &bRID, sizeof(RID));

    std::sort(lde.begin(), lde.end(), leadNode_Key_asc);

    cout << "Sorted Data :: " << endl;
    for(int j=0; j<2; j++){
        cout << "KEY :: " << (char *)(lde[j].key);
        cout << ", RID ::" << "{" << lde[j].rid.pageNum << ", " <<        
    lde[j].rid.slotNum << "}";
  }
return 0;
} 
```

我想根据 *key 值对上面的 lde 向量进行排序。它不适用于上面给出的方式。

注意：我无法更改上面列出的任何结构的数据类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:24:57.713

> 我想根据 *key 值对上面的 lde 向量进行排序。请给我一些建议...它>不适用于上面给出的方式。

您的代码在您编写时工作，但它是无效的。您的关键点是 char[8]，它由 size_t 和 char[4] 组成。

但随后调用 return strcoll((char *)a.key, (char *)b.key) > 0; 和 cout << "KEY ::" << (char *)(lde[j].key);.

但是key不指向字符串，它指向size_t，如果你在key的and处添加'\0'，并使用((char *)key) + 4，一切都应该按预期工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:29:15.393

好吧，您的代码中有两个问题：

首先，您将 LeafDataEntry 的键中的字符串保存为 [4 bytes for the size of the string] + [the string] 但 strcoll 接受以 '\0' 结尾且没有大小引导它们的字符串，正如您所说的那样想要对您的数据类型进行任何更改，这将解决您的问题：

```
bool leadNode_Key_asc( const LeafDataEntry &a, const LeafDataEntry &b){
    size_t size1 = *(unsigned*)(a.key), size2 = *(unsigned*)(b.key);
    string a1 = string((char*)a.key + 4, size1), a2 = string((char*)b.key + 4, size2);
    return a1 < a2;
} 
```

其次，这两行：

```
 cout << ", RID ::" << "{" << lde[j].rid.pageNum << ", " <<        
    lde[j].rid.slotNum << "}"; 
```

应替换为：

```
 cout << ", RID ::" << "{" << lde[j].rid.page << ", " <<        
    lde[j].rid.slot << "}"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T03:42:59.040

```
typedef struct
{
  unsigned page;
  unsigned slot; 
} RID;

struct KeyStruct
{
    unsigned size;
    char     szKey[4];
    KeyStruct(unsigned s, char *k) : size(s) { memcpy(szKey, k, sizeof(szKey)); }
};

//Below struct has the Key on which I want to apply the sorting
struct LeafDataEntry
{
    KeyStruct key;
    RID rid;    
    bool operator<(const LeafDataEntry& lde)
    {
        for (int i = 0; i < sizeof(key.szKey); ++i)
        {
            if (key.szKey[i] != lde.key.szKey[i]) return key.szKey[i] < lde.key.szKey[i];
        }
        return false;
    }
};

//This is the sorting function I am using
bool leadNode_Key_asc( const LeafDataEntry &a, const LeafDataEntry &b)
{
return true;

}

int main()
{

    vector<LeafDataEntry> lde;

    char a[4] = {'D', 'B', 'C', 'D'};
    RID aRID = {0,0};
    char b[4] = {'A', 'C', 'B', 'A'};
    RID bRID = {0,1};

    unsigned size = sizeof(unsigned);

    lde.reserve(2);

    LeafDataEntry lde_a = { KeyStruct(size, a), aRID };    
    lde.push_back(lde_a);

    LeafDataEntry lde_b = { KeyStruct(size, b), bRID };    
    lde.push_back(lde_b);

    std::sort(lde.begin(), lde.end());

    std::cout << "Sorted Data :: " << std::endl;
    for(int j=0; j<2; j++)
    {
        std::cout << "KEY :: " << lde[j].key.size << ":" << lde[j].key.szKey;
        std::cout << ", RID ::" << "{" << lde[j].rid.page << ", " << lde[j].rid.slot << "}" << std::endl;
    }
    return 0;
} 
```

# unix - 使用 Symfony 将更新值写入控制台

> ID：13407855
> 
> 赞同：2
> 
> 时间：2012-11-15T23:08:29.360
> 
> 标签：unix, symfony

诸如此类的实用程序`wget`可以将其下载百分比写入控制台并不断更新它而无需编写新行。这个功能叫什么，Symfony 的控制台组件可以实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:33:35.423

我使用 1ed 的答案来查看 Symfony 如何使用 2.2 中提供的进度助手来完成它。十六进制字符代码“\x08”（ANSI 退格字符）将删除单个字符。如果跟踪最后一行的长度，并使用 str_repeat，就可以达到预期的效果。

概念证明：

```
<?php
$lastLineSize = 0;

for ($i = 0; $i <= 50; $i++) {
    echo str_repeat("\x08", $lastLineSize);
    echo "Iteration {$i} of 50";
    $lastLineSize = strlen("Iteration {$i} of 50");
    usleep(100000);
}

echo " - Done\n"; 
```

输出：

```
[root@dev /home/myuser] > php test.php
Iteration 50 of 50 - Done
[root@dev /home/myuser] > 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T23:34:25.203

如果您在 master 分支上，则可以使用[进度助手](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Console/Helper/ProgressHelper.php)（[docs](http://symfony.com/doc/master/components/console/introduction.html#displaying-a-progress-bar)）。

# python - 有没有办法在pygame中控制网络摄像头的焦点？

> ID：13407859
> 
> 赞同：7
> 
> 时间：2012-11-15T23:08:44.477
> 
> 标签：python, webcam, pygame

我有两个我想用来拍照的网络摄像头。以下代码实现了这一点：

```
import pygame
import pygame.camera
from datetime import datetime
import Image
import threading
import time

class Camera (threading.Thread):
    def __init__(self, camera):
        self.camera = pygame.camera.Camera(camera,(2304,1536))
        self.stop = False
        threading.Thread.__init__(self)

    def run(self):
        self.camera.start()
        srf = self.camera.get_image()
        img = pygame.image.tostring(srf, 'RGB')
        img = Image.fromstring('RGB', srf.get_size(), img)

        img.save('%s.png'%datetime.now(), 'PNG')

s = datetime.now()

pygame.init()
pygame.camera.init()

cam1 = Camera("/dev/video0")
cam2 = Camera("/dev/video1")

cam1.start()
cam2.start()

cam1.join()
cam2.join()

print datetime.now() - s 
```

但我需要设定焦点。

我找到了这些命令行：

```
apt-get install uvcdynctrl
uvcdynctrl --device=/dev/video1 --clist
uvcdynctrl --device=/dev/video1 --get='Focus, Auto'
uvcdynctrl --device=/dev/video1 --set='Focus, Auto' 0
uvcdynctrl --device=/dev/video1 --set='Focus (absolute)' 20 
```

我虽然可以使用以下内容：

```
import os
os.system('command to set the focus') 
```

但是在我的（罗技）相机上它不起作用，我从命令行（Ubuntu 12.04，python 2.7）得到这个输出：

```
uvcdynctrl --device=/dev/video1 --set='Focus, Auto' 0

[libwebcam] Unsupported V4L2_CID_EXPOSURE_AUTO control with a non-contiguous 
  range of choice IDs found
[libwebcam] Invalid or unsupported V4L2 control encountered: ctrl_id = 0x009A0901, name = 'Exposure, Auto'
[libwebcam] Unsupported V4L2_CID_EXPOSURE_AUTO control with a non-contiguous 
  range of choice IDs found
[libwebcam] Invalid or unsupported V4L2 control encountered: ctrl_id = 0x009A0901, name = 'Exposure, Auto' 
```

**编辑：**

相机正在`Logitech HD Pro Webcam C920`运行：

```
uvcdynctrl --device=/dev/video1 --clist 
```

给出输出：

```
[libwebcam] Unsupported V4L2_CID_EXPOSURE_AUTO control with a non-contiguous 
  range of choice IDs found
[libwebcam] Invalid or unsupported V4L2 control encountered: ctrl_id = 0x009A0901, name = 'Exposure, Auto'
[libwebcam] Unsupported V4L2_CID_EXPOSURE_AUTO control with a non-contiguous 
  range of choice IDs found
[libwebcam] Invalid or unsupported V4L2 control encountered: ctrl_id = 0x009A0901, name = 'Exposure, Auto'
Listing available controls for device /dev/video1:
  Brightness
  Contrast
  Saturation
  White Balance Temperature, Auto
  Gain
  Power Line Frequency
  White Balance Temperature
  Sharpness
  Backlight Compensation
  Exposure (Absolute)
  Exposure, Auto Priority
  Pan (Absolute)
  Tilt (Absolute)
  Focus (absolute)
  Focus, Auto
  Zoom, Absolute 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T16:32:00.510

执行这个

```
sudo apt-get install v4l-utils 
```

在python中

```
os.system('v4l2-ctl -d 0 -c focus_auto=0')
os.system('v4l2-ctl -d 0 -c focus_absolute=250') 
```

# magento - Magento admin - 更改默认配置菜单

> ID：13407870
> 
> 赞同：1
> 
> 时间：2012-11-15T23:09:49.717
> 
> 标签：magento

当我登录 admin 并导航到**System >> Configuration**时，我有一个已打开的 Incho Featured Products 菜单。我希望它默认为**General >> General**。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T15:48:34.697

尝试

转到 /app/code/local/[companyName]/[moduleName]/etc/system.xml

```
<config>
    ......
    <sections>
        <xyz translate="label" module="xyz">
             .....
             <sort_order>1</sort_order> 
```

更改`<sort_order>1</sort_order>`为更大的数字，例如`<sort_order>96</sort_order>`

（这是其他模块的做法，不确定他们是否使用相同的方法）

# java - 如何从参数Java解析字符串？

> ID：13407871
> 
> 赞同：0
> 
> 时间：2012-11-15T23:09:48.530
> 
> 标签：java, string, parsing, arguments

我一直在尝试从参数中解析一个字符串，我试过了

```
String.parseString(args[0]); 
```

我到底做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:13:48.177

`args[0]`如果它来自命令行，则应该已经是一个字符串。

如果没有，请使用`String.valueOf(args[0])`.

请参阅[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T23:12:13.177

由于方法中的`args`参数`main`已经是一个`String`数组，您可以使用`args[0]`.

顺便说一句，没有这样的方法`String.parseString()`。

# c - 密码溢出

> ID：13407879
> 
> 赞同：5
> 
> 时间：2012-11-15T23:10:32.740
> 
> 标签：c

我正在加密如下，但不知道如何防止大写字母超出范围时进入其他符号，同样小写字母超出小写字母的范围。我怎样才能让它们转一圈并停止溢出？谢谢

```
 int size = strlen(plain_text);
int arrayelement = 0;
for(arrayelement = 0; arrayelement < size; arrayelement++)
{
    if (islower(plain_text[arrayelement]))
    {
        ciphered_text[arrayelement] = (int)(plain_text[arrayelement] + shiftkey);
    }
    else if (isupper(plain_text[arrayelement]))
    {
        ciphered_text[arrayelement] = (int)(plain_text[arrayelement] + shiftkey);
    }
}

ciphered_text[size] = '\0';
printf("%s", ciphered_text); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:20:03.970

我猜你使用像 char 这样的类型，所以一个不溢出的简单解决方案是

```
int tmp_ciphered = (my_char + shift) % 0xff;
char ciphered = (char)(tmp_ciphered); 
```

然后你转身不要溢出，这是一个戒指

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:20:29.120

这复制了（几乎完全一样）[c++ simple Caesar cipher algorithm](https://stackoverflow.com/questions/12761720/c-simple-ceasar-cipher-algorithm/12761815#12761815)。

请注意，我不同意该帖子中接受的答案。基本上，您必须使用 ((c-'a'+shift) % 26) + 'a' 之类的东西将字符映射回范围。然而，假设你的角色在'a'..'z'中。使用 c >= 'a' && c <= 'z' 而不是 islower 可能更安全，因为我不确定语言环境将如何在非英语系统上发挥作用。isupper 和其他范围类似。最后，当 char 不在任一范围内时，您需要一个 else 子句来处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T07:44:25.063

唯一真正可移植的方法是为输入域构建一个查找表，并基于非线性假设手动构建字符。

即使对于 的受限域`['a'..'z','A'..'Z']`，假设 'A'..'Z' 是连续的，语言标准也**没有**定义，并且可证明并非总是如此。对于任何持不同看法的反对者，我会[在此链接](http://en.wikipedia.org/wiki/EBCDIC)中引导您查看图表中字符的序数位置，并密切注意假设序列中间的死区。如果您认为“没有人再使用 EBCDIC”，让我向您保证 AS/400 和 OS/390 都还不错（并且可能现在正在处理您的美国税收，因为 IRS 是 IBM 最大的客户之一）。

事实上，C 标准对此非常明确：

> **C99-5.2.1.3**在源和执行基本字符集中，上述十进制数字列表中 0 之后的每个字符的值都应比前一个字符的值大一。

甚至在字符集的任何其他部分都没有提到定义的顺序甚至*隐含的顺序。*事实上，`'0'..'9'`它还有一个独特的属性：它们是唯一保证不受语言环境更改影响的字符。

因此，与其假设字符存在线性延续，同时对标准的可疑沉默嗤之以鼻，让我们定义我们自己的**硬**地图。我不会像往常一样在这里内联代码；如果你仍然和我在一起，你真的有兴趣了解并且可能会阅读和批评下面的代码。但我将总结一下它是如何工作的：

1.  静态声明两个字母，长度加倍 (A..ZA..Z,a..za..z)。
2.  声明两个足够大的数组（加密和解密）以容纳`(1<<CHAR_BIT)`条目。
3.  使用与其索引对应的值完全初始化两个数组。例如：`a[0]=0`, `a[1]=1`,...
4.  用与移位宽度 Ex 对应的适当值填充加密数组中的每个位置，这些位置是我们从 (1) 开始的字母表的一部分。`a['a'] = 'g'`对于ROT5。
5.  通过从字母表的尾部向后应用相反的移位方向来镜像 (4)。例如：`a['g'] = 'a';

您现在可以使用加密数组作为一个简单的表来将输入文本转换为密文：

```
enc-char = encrypt[ dec-char ];
dec-char = decrypt[ enc-char ]; 
```

如果您认为仅仅为了获得源级平台独立性似乎需要大量工作，那么您是完全正确的。但是你会*惊讶*于人们试图冒充“多平台”的#ifdef #endif**地狱。**平台无关代码的核心目标不仅是定义**公共**源代码，还要定义*行为*。不管是什么平台，上面的概念都会起作用。（而不是看到#ifdef）。

感谢您花时间阅读这个惨败。这么看似简单的问题……

* * *

**示例 main.cpp**

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <string.h>

// global tables for encoding. must call init_tables() before using
static char xlat_enc[1 << CHAR_BIT];
static char xlat_dec[1 << CHAR_BIT];

void init_tables(unsigned shift)
{
    // our rotation alphabets
    static char ucase[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZABCDEFGHIJKLMNOPQRSTUVWXYZ";
    static char lcase[] = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz";
    int i=0;

    // ensure shift is below our maximum shift
    shift %= 26;

    // prime our table
    for (;i<(1 << CHAR_BIT);i++)
        xlat_enc[i] = xlat_dec[i] = i;

    // apply shift to our xlat tables, both enc and dec.
    for (i=0;i<(sizeof(ucase)+1)/2;i++)
    {
        xlat_enc[ lcase[i] ] = lcase[i+shift];
        xlat_enc[ ucase[i] ] = ucase[i+shift];
        xlat_dec[ lcase[sizeof(lcase) - i - 1] ] = lcase[sizeof(lcase) - i - 1 - shift];
        xlat_dec[ ucase[sizeof(ucase) - i - 1] ] = ucase[sizeof(ucase) - i - 1 - shift];
    }
}

// main entrypoint
int main(int argc, char *argv[])
{
    // using a shift of 13 for our sample
    const int shift = 13;

    // initialize the tables
    init_tables(shift);

    // now  drop the messsage to the console
    char plain[] = "The quick brown fox jumps over the lazy dog.";
    char *p = plain;
    for (;*p; fputc(xlat_enc[*p++], stdout));
    fputc('\n', stdout);

    char cipher[] = "Gur dhvpx oebja sbk whzcf bire gur ynml qbt.";
    p = cipher;
    for (;*p; fputc(xlat_dec[*p++], stdout));
    fputc('\n', stdout);

    return EXIT_SUCCESS;
} 
```

**输出**

```
Gur dhvpx oebja sbk whzcf bire gur ynml qbt.
The quick brown fox jumps over the lazy dog. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T13:48:19.010

您可以从字面上实现它：

“如果它们超出范围”：

```
if (ciphered_text[arrayelement] > 'z') 
```

“让他们转一圈，停止溢出”：

```
ciphered_text[arrayelement] -= 26; 
```

在您的上下文中：

```
if (plain_text[arrayelement] >= 'a' && plain_text[arrayelement] <= 'z')
{
    ciphered_text[arrayelement] = (int)(plain_text[arrayelement] + shiftkey);
    if (ciphered_text[arrayelement] > 'z')
        ciphered_text[arrayelement] -= 26;
} 
```

（假设您使用 ACSII 编码的英文文本，并且`shiftkey`在 1...25 范围内，就像它应该的那样）

# c++ - 在 C++ 中对整数的链表进行排序

> ID：13407880
> 
> 赞同：-1
> 
> 时间：2012-11-15T23:10:40.103
> 
> 标签：c++, algorithm, sorting, linked-list

我必须创建一种以从最小到最大的顺序存储整数的链表。如果您有或知道如何为链表创建排序功能，请在此处显示是否关闭和/或教我如何用 C++ 编写代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:36:14.847

我经常通过索引指针列表对链表进行排序。要构建一个，需要分配相当于节点数 (N) * 节点指针大小的内存。这个概念很简单。

注意：这个算法在 C 中，因为我不完全确定 OP 是否打算将其归类为 C++ 问题（谁在 C *++*中使用链表和标准容器供您使用？？）

1.  确定列表中的节点数（N）
2.  为 N 节点**指针**分配一个指针数组。
3.  使用列表中的每个节点指针加载指针数组。即遍历列表，并在指针数组的每个插槽中放置一个指针，随着您的进行递增。
4.  将此节点指针数组发送到您的排序算法（我喜欢运行时库`qsort()`，因为它是标准配备的）。
5.  排序后，遍历整个指针数组（少一个），设置每个节点的“下一个”指针指向后面的那个。最后一个将其“下一个”指针设置为 NULL。
6.  将头指针设置为指针数组中的第一个指针[0]。
7.  释放指针数组的内存

您的链接列表已排序。

* * *

假设您的节点是这样的：

```
struct node
{
   ..data fields..
   int keyField;  // << determines sort order
   struct node *next;
}; 
```

确定列表中的节点数。我假设你有一个可以做到这一点的 proc，这很简单：

```
size_t list_count(struct node* head)
{
   size_t count = 0;
   while (head)
   {
      ++count;
      head = head->next;
   }
   return count;
} 
```

分配一个列表大小的指针数组，其中 nItems 是大于 1 的列表节点计数（与长度为 0 或 1 的列表无关）：

```
struct node **ptrs = malloc(sizeof(*ptrs)*nItems); 
```

用列表中的所有项目填充指针数组：

```
struct node *ptr = head;
size_t i=0;
for (;i<nItems;++i,ptr = ptr->next)
    ptrs[i] = ptr; 
```

现在`qsort()`使用适当的比较功能将其发送到。下面是一个基于`keyField`我们结构中的排序的示例比较函数：

```
int compare_node_ptrs(const void* left, const void* right)
{
    struct node *l = *(struct node**)left;
    struct node *r = *(struct node**)right;
    return l->keyField - r->keyField;
} 
```

调用 qsort() 看起来像这样：

```
qsort(ptrs, nItems, sizeof(*ptrs), compare_node_ptrs); 
```

现在遍历整个列表。重新布线“下一个”指针：

```
for (i=0;i<(nItems-2);++i)
    ptrs[i]->next = ptrs[i+1];
ptrs[nItems-1] = NULL; 
```

重新连接头指针。

```
head = ptrs[0]; 
```

最后，释放指针数组。

```
free(ptrs); 
```

您的链接列表已排序。

* * *

**侧边栏**合并排序是我所知道的唯一一种 O(nlogn) 算法，它可以对链表进行排序而无需增加空间要求。以下原型的通用解决方案将是 nutz：

```
mergesort_list(void **head, size_t offset_ptr, int(*comp)(void*,void*))

head: address of the head pointer.
offset_ptr: offset in bytes from a node ptr where the 'link' pointer can be found.
comp: comparison function. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T23:23:47.523

如果我们只是向您展示代码，我们将对您造成极大的伤害。相反，我会给你两种不同的方法，你可以实现你喜欢的一种。

第一种方法是在插入时进行“排序”：当您插入一个值（例如 7）时，您按照此过程从列表中的第一个条目开始，直到用完节点：

如果您正在检查的节点的值大于 7，则在您正在检查的节点之前插入一个新节点并返回。否则，您将查看下一个节点。如果没有下一个节点，则。您在列表末尾插入一个新节点，因为这意味着 7 大于列表中的所有其他条目并返回。

第二种选择是使用许多排序算法之一对整个列表进行排序。我建议您使用 BubbleSort，因为它易于理解和实现。您可以在 Wikipedia 上阅读有关冒泡排序（以及许多其他排序算法）的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T23:40:47.613

好的旧[快速排序](http://en.wikipedia.org/wiki/Quicksort)可以解决问题（C++03 友好）：

```
#include <algorithm>
#include <functional>
#include <iostream>
#include <iterator>
#include <list>

using namespace std;

void qsort(list<int>::iterator first, list<int>::iterator last)
{
    if (distance(first, last) < 2)
        return;
    int pivot = *first;

    list<int>::iterator it = partition(first, last, bind2nd(less<int>(), pivot));

    qsort(first, it);
    qsort(it, last);
}

int main()
{
    std::list<int> l;
    l.push_back(5);
    l.push_back(4);
    l.push_back(1);
    l.push_back(10);
    l.push_back(3);
    l.push_back(6);
    l.push_back(7);

    cout << "List:";
    copy(l.begin(), l.end(), std::ostream_iterator<int>(std::cout, " "));
    cout << endl;

    qsort(l.begin(), l.end());

    cout << "Sorted list:";
    copy(l.begin(), l.end(), std::ostream_iterator<int>(std::cout, " "));
    cout << endl;
    return 0;
} 
```

检查：http: [//ideone.com/OOGXSp](http://ideone.com/OOGXSp)

# php - 如何在 php 中将数字符号 (#) 附加到 URL

> ID：13407881
> 
> 赞同：-3
> 
> 时间：2012-11-15T23:10:50.137
> 
> 标签：php

我在 php 文件中有这一行。它创建 URL 路径：

```
$output = l($image, "article/{$article->aid}", $options); 
```

输出很好，但我想在它后面加上一个“#”符号。例如：

```
/articles/example#comments 
```

我尝试了不同的组合，但没有找到合适的组合。我希望加号组合会起作用，但它总是指向根：

```
$output = l($image, "article/{$article->aid}"+"#comments", $options);

Result is "/" 
```

有人知道该怎么做吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:14:13.183

你不能用“+”连接一个字符串所以而不是

```
$output = l($image, "article/{$article->aid}"+"#comments", $options); 
```

这将是

```
$output = l($image, "article/{$article->aid}"."#comments", $options); 
```

# javascript - 将函数绑定到新创建的元素

> ID：13407884
> 
> 赞同：0
> 
> 时间：2012-11-15T23:11:23.457
> 
> 标签：javascript, jquery

谢谢你的帮助。

我有一个功能。在这个函数中，我创建了两个按钮并分配了两个 id。

```
var content =

'<div>

'<div id="stationPopUpbtn">' +
        '<button id="createWave_updateStation" onclick="updateStationContent('+feature+')">Änderungen speichern</button>'+
        '<button id="createWave_deleteStation" onclick="deleteFeature('+feature+')">Station löschen</button>'+
    '</div>'+

'</div>'; 
```

稍后在我想做的同一功能中：

```
$('#_updateStation').bind('click', function(){ // stuff }); 
```

但它不起作用。内容作为弹出窗口 (OpenLayers) 的一部分添加，作为回报，该弹出窗口将添加到地图中。

```
 var popup = new OpenLayers.Popup.FramedCloud(
                feature.id+"_popup",
                feature.geometry.getBounds().getCenterLonLat(),
                new OpenLayers.Size(250, 100),
                content,
                null,   // anchor
                true,   // closeBox exists
                //closeBoxCallback
                function(){
                    feature.style.pointRadius = 20;
                    map.removePopup(feature.popup);
                }
            ); 
```

编辑：

```
$(document).append(content);
//map.addControl(selectControl);
//selectControl.activate();
$(document).on('click', '#createWave_updateStation' ,function(){
    console.log("TES");
});
    $('#create_stationPopup').popup('open'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:12:08.933

**将事件委托**给静态父容器。这样做将在匹配子节点后附加事件侦听器..

```
$(document).on('click', '#_updateStation',function(){ // stuff }); version >= 1.7 
```

我将它委托给文档，因为我不确定您的 HTML 结构..

所以最好用`Static Container..`

同样从 jQuery 版本**1.7** `.on()`开始 是首选方法`.bind()`

如果您使用的版本低于**1.7**版本，您可以使用`.delegate`附加事件

```
$(document).delegate('#_updateStation' ,'click',function(){ // stuff }); 
// version < 1.7 
```

# facebook - 喜欢按钮认为我的域是其他域.. google.ru

> ID：13407885
> 
> 赞同：0
> 
> 时间：2012-11-15T23:11:29.370
> 
> 标签：facebook, facebook-like, canonical-link

在我的页面标题中，我发送`og`参数。但是like按钮的计数器显示了一个接近17000的数字。当我使用Facebook开发人员调试时，我看到规范的url不是我的url，它是google.ru，例如：

[http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fseo-top-news.com.ua%2Fgoogle-vlojit-v-startapy-1-5-milliarda% 2F](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fseo-top-news.com.ua%2Fgoogle-vlojit-v-startapy-1-5-milliarda%2F)

我真的对谷歌有很高的评价，但我不想在我所有的文章上都有一个谷歌的按钮 :)
你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T00:29:48.970

在您链接到的调试器结果页面上，您可以看到重定向路径：

原文： [http](http://seo-top-news.com.ua/google-vlojit-v-startapy-1-5-milliarda/) : //seo-top-news.com.ua/google-vlojit-v-startapy-1-5-milliarda/ 302：http: [//dietrussia.ru/](http://dietrussia.ru/) 302： [http ://webhitexpress.ru/ in.cgi?2](http://webhitexpress.ru/in.cgi?2) 302: [http://www.google.ru/](http://www.google.ru/)

Facebook 抓取工具正在发送给 Google。

这是因为用户代理。如果我在没有用户代理的情况下卷曲您的网站，我也会被重定向：

```
curl http://seo-top-news.com.ua/google-vlojit-v-startapy-1-5-milliarda/ 
```

但是如果我用一个真正的浏览器用户代理来卷曲它，我会得到正确的页面：

```
curl --user-agent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1309.0 Safari/537.17" http://seo-top-news.com.ua/google-vlojit-v-startapy-1-5-milliarda/ 
```

Facebook 抓取工具使用用户代理“facebookexternalhit”，因此只需确保返回的是完整页面内容，而不是 302。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T00:21:00.740

您的网站可能已被恶意重定向攻击——如果您查看“重定向路径”部分，Facebook 的爬虫将被重定向到一系列超级粗略的网站。

检查您`.htaccess`的任何不应该存在的东西（这是一个非常常见的攻击媒介），更改您的 FTP 密码，并升级您的 WordPress 安装（和插件）。

# java - Weblogic Log4j Loggging Server Logging Bridge 启动时抛出 ClassCastException

> ID：13407886
> 
> 赞同：3
> 
> 时间：2012-11-15T23:11:38.840
> 
> 标签：java, oracle, log4j, weblogic

使用 Weblogic 11g，我做了以下事情：

1 创建了 log4j.xml 文件，我在其中创建了一个新的附加程序：

> ```
>  <appender name="WEBLOGIC" class="weblogic.logging.log4j.ServerLoggingAppender">
>   <param name="Threshold" value="ERROR"/>
>    </appender>
>    
>    <root>
>      <priority value="WARN"/>
>      <appender-ref ref="CONSOLE"/>
>      <appender-ref ref="FILE"/>
>      <appender-ref ref="WEBLOGIC"/>
>    </root> 
> ```

2 使用以下更改更新了 ${DOMAIN_HOME}/bin/setDomainEnv.sh 脚本：

> ```
> LOG4J_CONFIG_FILE="${DOMAIN_HOME}/config/log4j.xml"
> if [ "${LOG4J_CONFIG_FILE}" != "" ] ; then
>   JAVA_PROPERTIES="${JAVA_PROPERTIES} Dlog4j.configuration=file:${LOG4J_CONFIG_FILE}"
>   export JAVA_PROPERTIES
> fi
> 
> JAVA_OPTIONS="${JAVA_OPTIONS} ${JAVA_PROPERTIES} -Dweblogic.log.Log4jLoggingEnabled=true -Dwlw.iterativeDev=${iterativeDevFlag} -Dwlw.testConsole=${testConsoleFlag} -Dwlw.logErrorsToConsole=${logErrorsToConsoleFlag}" 
> ```

3 将 log4j jar 复制到 domain/lib

> cp ./wlserver_10.3/server/lib/wllog4j.jar user_projects/domains/my_domain/lib/
> 
> cp ./wlserver_10.3/server/lib/consoleapp/APP-INF/lib/log4j-1.2.8.jar user_projects/domains/my_domain/lib/

4 启动 AdminServer，但出现此错误：

> java.lang.ClassCastException：weblogic.logging.log4j.ServerLoggingAppender 不能转换为 org.apache.log4j.Appender

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-25T12:47:50.123

您必须看到的是，尽管收到了警告，但 ServerLogging 是否有效地无法在您的域上的应用程序上运行。可能甚至不存在，因为您只是将 log4j 复制到 domain/lib 文件夹而不是 wllog4j.jar。所以你的设置看起来在任何情况下都注定行不通。

在我看来，您正在经历 Class Loader Vodoo Messup。

(1) 您为整个应用服务器设置了一个全局 log4j 属性文件。

(2) 看起来 weblogic 控制台应用程序本身就是一个耳朵，它捆绑了自己的 LOG4J 实现库，您正在将其复制到您的域中。

当控制台应用程序运行时，它必须确保使用 Log4j，并且加载 Log4j Appender 定义的类加载器很可能比知道 ServerLoggin 桥适配器的类加载器低一个级别。我敢打赌，weblogic 将在未来的产品中摆脱 LOG4j。他们有太多的类加载器问题——JUL 记录你在核心类后面有 APP 类加载器——例如处理程序/适配器。

反正。

(3) 当 weblogic 运行时，namley 在引导控制台时可能会运行某种类加载器，该类加载器为捆绑在应用程序中的库提供一定程度的隔离，它会看到：哦！太好了，LOG4j 在这里，让我们初始化它。

其次，LOG4j 引导并点击您的 log4j.properties，您将服务器日志记录附加程序放在那里 - 对每个人（包括 weblogic 应用程序控制台）都是交叉的。他去寻找这个图书馆，它在哪里找到它？

其中之一是他在 weblogic 通用容器库中的某处找到的 wllog4j.jar。在 Log4j 的基本核心类中，他发现域配置或控制台应用程序的 EAR 配置中的级别较低。情况不妙。

尝试以下操作：(a) 进入 weblogic 控制台应用程序，进入 Meta Inf 文件夹并重新编写 weblogi-application.xml

它将有一个看起来像这样的首选应用程序包：org.apache.log4j.*</package-name--> <---- 这里我已经评论了这一行。

如果您注释上述行，应用程序类加载器将在知道这些类的最高父级中搜索 log4j 库。所以如果你把你的 ServerLogger 放在同一个级别，你应该没问题。

(b) 将 log4j 实现库与 wllog4j.jar 所在的级别相同。

检查您是否仍然遇到强制转换异常。

在进行服务器范围的横切配置时要非常小心。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-27T21:02:48.177

在`setDomainEnv.xml`文件中，请添加如下设置的`log4j.xml`位置：

```
set LOG4J_CONFIG_FILE=C:\bea\user_projects\domains\dev\lib\log4j.xml

if NOT "%LOG4J_CONFIG_FILE%"=="" (
    set JAVA_PROPERTIES=%JAVA_PROPERTIES% -Dlog4j.configuration=file:%LOG4J_CONFIG_FILE%
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T05:49:06.283

保留步骤 1 并删除在其他步骤中所做的更改。

现在将 log4j.xml 复制到 $DOMAIN_HOME/lib 文件夹。这会将您的 log4j.xml 保留在服务器的类路径中，并且服务器将使用此 log4j.xml 作为其 log4j 配置。不需要额外的更改。

# fancybox - fancybox 隐藏加载动画

> ID：13407894
> 
> 赞同：0
> 
> 时间：2012-11-15T23:12:15.720
> 
> 标签：fancybox

我正在使用 fancybox 并想禁用加载动画。

我的代码：

```
$(document).ready(function() {

    $("#mypop").fancybox({
     'onStart ': function(){ $.fancybox.hideActivity },
'onComplete' : function(){ $.fancybox.hideActivity }, 
    'href'                  : 'file.php',
    'transitionIn'      : 'none',
    'transitionOut'     : 'none',
    'titleShow' : false,
    'overlayColor'  :   '#fff',
    'overlayOpacity':   0.8,
        }); 
    }); 
```

而且加载动画仍然有效我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:33:51.623

如果这对您有任何好处，文档会说 v2 的 $.fancybox.hideLoading()。 [http://fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)

编辑-@user1139767

您在 $.fancybox.hideActivity() 调用末尾缺少 ()。

这篇文章 (http://stackoverflow.com/a/3673152/1791606) 提到加载动画没有出现，因为使用 iframe 作为意外实现您似乎想要做的类型的类型。

# android - 将相机中的图像存储到私有应用程序缓存目录中

> ID：13407899
> 
> 赞同：9
> 
> 时间：2012-11-15T23:12:33.390
> 
> 标签：android, permissions, camera

我想从相机捕获图像并将其保存到私有应用程序缓存目录。我意识到我必须授予相机应用程序写入我的私人目录的权限，所以我添加了`FLAG_GRANT_WRITE_URI_PERMISSION`标志。

发生的事情是，相机应用程序打开，我可以拍照，但是当我单击“确定”按钮时，什么也没有发生。相机应用程序保持打开状态。没有日志输出。我猜是因为权限问题。

```
private void getCameraImage() {
    try {
        mTmpFile = File.createTempFile("tmp", ".jpg", getCacheDir());
        Uri imgUri = Uri.fromFile(mTmpFile);
        Intent i = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        i.putExtra(MediaStore.EXTRA_OUTPUT, imgUri);
        i.addFlags(Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
        // i.setData(imgUri); // if uncommented, i get an ActivityNotFound Exception
        startActivityForResult(i, REQUEST_CAMERA);
    } catch (IOException e) {
        Log.e(TAG, "getCameraImage()", e);
        Toast.makeText(this, "Something went wrong", Toast.LENGTH_SHORT).show();
    }
} 
```

任何见解，关于我该如何纠正？

**编辑：**

当我将目录更改为公共 SD 卡时，它工作正常。

```
mTmpFile = File.createTempFile("tmp", ".jpg", Environment.getExternalStorageDirectory()); 
```

谢谢西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-19T15:16:08.660

[您可以使用http://developer.android.com/reference/android/hardware/Camera.html#takePicture(android.hardware.Camera.ShutterCallback](http://developer.android.com/reference/android/hardware/Camera.html#takePicture(android.hardware.Camera.ShutterCallback) , android.hardware.Camera.PictureCallback,而不是传递 Uri 来存储图片， android.hardware.Camera.PictureCallback, android.hardware.Camera.PictureCallback)

并在您的应用程序内存中获取内容。从那里你将能够做任何你想做的事情。

不要忘记相机应用程序也在使用画廊，并且画廊应用程序不允许检查您的私人目录。

# php - 在更新查询中排除 where 子句是不好的还是有害的做法？

> ID：13407907
> 
> 赞同：-1
> 
> 时间：2012-11-15T23:13:25.370
> 
> 标签：php, codeigniter

我正在使用 codeigniter 来构建我的网站，但在更新查询中看不到我的子句 where 部分的原因。

它可以正常工作，但是可以这样做吗？如果不是，与之相关的陷阱是什么？

提前致谢？

```
public function reset_password()
    {
        $salt = $this->_salt();
        $this->load->library('encrypt');

        $data = array(
                       'password' => $this->encrypt->sha1($salt . $this->encrypt->sha1($this->input->post('password'))),
                       'salt' => $salt
                    );

        $this->db->update('users', $data);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T23:16:58.590

执行更新时，如果不包含 where 子句，它将更新表中的所有值。

所以在这种情况下，每个人的密码和盐都会被设置为这个新值。

# javascript - 我怎么知道我继承了哪个对象

> ID：13407914
> 
> 赞同：2
> 
> 时间：2012-11-15T23:14:02.403
> 
> 标签：javascript, oop

在 javascript 中，我怎么知道我 inehrit 哪个对象？例如

```
function a() {
    this.c = 1;
}

function b() {
    this.d = 2;
}
b.prototype = new a();​ 
```

如何检查 b 是否从 a 继承？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:21:30.937

使用[`instanceof`运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/instanceof)：

```
//capital letters indicate function should be used as a constructor
function A() {...}
function B() {...}
B.prototype = new A();
var a,
    b;
a = new A();
b = new B();

console.log(a instanceof A); //true
console.log(a instanceof B); //false
console.log(b instanceof A); //true
console.log(b instanceof B); //true
console.log(B.prototype instanceof A); //true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:18:09.040

试试这个

```
 b.prototype.constructor.name 
```

工作示例：http: [//jsfiddle.net/psrcK/](http://jsfiddle.net/psrcK/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T23:20:06.590

使用 的构造函数属性`b.prototype`或任何实例`b`。

```
function a(){
  this.c=1;
}

function b(){
  this.d=2;
}

b.prototype=new a();

x = new b()

if(x.constructor == a){
    // x (instance of b) is inherited from a
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T23:25:08.893

你们中的人可能想要[instanceOf](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/instanceof)。

```
if (b instanceOf a) {
    console.log("b is instance a")
} 
```

这还具有遍历整个原型链的优势，因此无论它是父母，祖父母等

# google-app-engine - App Engine 全文搜索文档索引在 Unicode ½ 上失败

> ID：13407915
> 
> 赞同：1
> 
> 时间：2012-11-15T23:14:04.633
> 
> 标签：google-app-engine, full-text-search

字段 (TextField) 包含 unicode 字符 U+00BD (VULGAR FRACTION ONE HALF) 的文档无法添加到全文搜索索引中。

我可以创建文档，但尝试添加到索引时`search.Index(name = "test").put(d)`会引发搜索。消息出现错误异常`"Error: one or more put document operations failed: Failed to index"`

还有其他人在索引 unicode 字符串时遇到问题吗？有什么建议么？

下面的例子对我来说失败了。更改`c`为不同的字符串（即使是非 ascii unicode 字符串也可以。）

```
from google.appengine.api import search

c = u'½'  # This fails but c=u'©' works

doc = search.Document(
    doc_id   = "1",
    fields   =  [search.TextField(name = "field1", value = c)],
    language = 'en'
  )

search.Index(name = "test").put(doc) 
```

问候理查德

# c# - 需要关于使用的线程数量的建议

> ID：13407920
> 
> 赞同：0
> 
> 时间：2012-11-15T23:14:57.817
> 
> 标签：c#, .net, multithreading

嘿，我希望有人可以向我解释一些事情。我是编程新手，到目前为止，在我编写的程序中，我还没有对线程做任何事情，但是当我查看 Windows 7 中的资源监视器时，它显示我的程序有 18 个线程。

此时我的程序不到 1MB，平均使用大约 10,000kb 的私有内存，很少达到我 CPU 使用率的 1%。该程序仍然运行良好，但我有点困惑，想对此有所了解。

这甚至应该是我应该关心的事情，如果是这样，我应该看什么可能导致使用这么多线程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T23:19:38.217

您看到的线程很可能不是您自己的线程，它们将归 clr 所有，并将处理诸如垃圾收集之类的事情。

我建议您不必担心线程管理。如果您需要对同时发生的多个任务进行编程，请查看[Task Parallel Library (TPL)](http://msdn.microsoft.com/en-us/library/dd460717.aspx)。多线程编程很难，只有在真正需要的时候才能学习。

# c - 如何在不添加 printfs 的情况下在调用函数时打印函数的名称？

> ID：13407931
> 
> 赞同：0
> 
> 时间：2012-11-15T23:15:51.067
> 
> 标签：c, list, function, call, store

我正在寻找一种在调用**任何函数**时打印（存储）名称的方法。

我不想在所有功能中添加痕迹或打印。

我正在寻找一些可以从顶部启用的方法，它会打印/存储/列出调用的函数名称。

我使用的编程语言是 C。

它可能不是标准功能，如果我必须在某处添加黑客以使其工作，我可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:31:39.337

您可能想查看`gcc` `-pg`选项和`gprof`探查器工具。

[http://sourceware.org/binutils/docs/gprof/](http://sourceware.org/binutils/docs/gprof/)

# ruby-on-rails - 通过标签而不是位置在 Instagram 上查找最近的媒体

> ID：13407936
> 
> 赞同：0
> 
> 时间：2012-11-15T23:16:32.967
> 
> 标签：ruby-on-rails, ruby, instagram

我如何在 Instagram 中搜索与标签相关联的所有照片，而不是经纬度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:18:32.523

该[api](http://instagram.com/developer/endpoints/tags/)有这方面的文档，应该非常简单。

编辑：Instagram 有自己的[gem](https://github.com/Instagram/instagram-ruby-gem)，只需要在你的应用程序中实现它。至于使用它按标签搜索，该[`Client::Tags`](http://www.rubydoc.info/github/Instagram/instagram-ruby-gem/master/Instagram/Client/Tags#tag_search-instance_method)模块有供您执行此操作的方法。

# sql-server - LINQ to SQL Data Context logs don't show the WHERE clause

> ID：13407939
> 
> 赞同：5
> 
> 时间：2012-11-15T23:16:51.353
> 
> 标签：sql-server, linq, linq-to-sql, linq-to-objects

The following is the C# code and generated SQL in a LINQ to SQL query for two cases.

## Case 1

```
using (JulianDataContext dc = new JulianDataContext(this.CurrentConnectionString))
{
#if DEBUG
    dc.Log = new DebugTextWriter();
#endif

    IEnumerable<UserNewsfeedDeliveryTime> temp = dc.UserNewsfeedDeliveryTimes.Where(u => u.NewsfeedEmailPeriodicity > 0 && DateTime.Today >= u.NextNewsfeedDelivery.Value.Date);

    ids = temp.Select(p => p.Id).ToList();
}

SELECT [t0].[Id], [t0].[NewsfeedEmailPeriodicity], [t0].[LastSentNewsfeedEmail], [t0].[NextNewsfeedDelivery]
FROM [dbo].[UserNewsfeedDeliveryTimes] AS [t0]
WHERE ([t0].[NewsfeedEmailPeriodicity] > @p0) AND (@p1 >= CONVERT(DATE, [t0].[NextNewsfeedDelivery]))
-- @p0: Input Int (Size = -1; Prec = 0; Scale = 0) [0]
-- @p1: Input DateTime (Size = -1; Prec = 0; Scale = 0) [15-11-2012 00:00:00] 
```

## Case 2

```
using (JulianDataContext dc = new JulianDataContext(this.CurrentConnectionString))
{
#if DEBUG
            dc.Log = new DebugTextWriter();
#endif
    IEnumerable<UserNewsfeedDeliveryTime> temp = dc.GetTable<UserNewsfeedDeliveryTime>();

    temp = temp.Where(u => u.NewsfeedEmailPeriodicity > 0 && DateTime.Today >= u.NextNewsfeedDelivery.Value.Date);

    ids = temp.Select(p => p.Id).ToList();
}
SELECT [t0].[Id], [t0].[NewsfeedEmailPeriodicity], [t0].[LastSentNewsfeedEmail], [t0].[NextNewsfeedDelivery]
FROM [dbo].[UserNewsfeedDeliveryTimes] AS [t0] 
```

## The difference

The difference between these two linq queries:

dc.UserNewsfeedDeliveryTimes

and

dc.GetTable<UserNewsfeedDeliveryTime>()

Why? Could it be that, in case 2, LINQ to SQL is retrieving all data from database and finish the query by filtering all objects in memory?

If so, how can we make keep this generic and still force all the T-SQL to be generated?

## Solution

Both answers, are correct but I had to pick one, sorry! I think also it is interesting to add that in this case, since I changed to work with an IQueryable (inherits from IEnumerable), in this line:

temp = temp.Where(u => u.NewsfeedEmailPeriodicity > 0 && DateTime.Today >= u.NextNewsfeedDelivery.Value.Date);

I had two overload methods, one from the IQueryable interface and another to the IEnumerable interface.

```
public static IQueryable<TSource> Where<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate);
public static IEnumerable<TSource> Where<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate); 
```

So I had to convert my predicate explicitly to Expression> predicate, otherwise the IEnumerable interface method would have been picked up at compile time and, if I am not mistaken, I would get some dynamic sql exception saying the T-SQL could not have been generated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T11:18:55.393

Try using **IQueryable** instead of **IEnumerable**.

Weird, because on my examples I get the opposite results from you, ie with IEnumerable, case 1 works fast and case 2 retrieves all the data. But using IQueryable fixes the issue.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T18:48:40.200

From my understanding, `IEnumerable` does not transform the original query information that `IQueryable` holds. It's almost as if the cast freezes any changes to the `IQueryable` query at the point of casting. If you look at MSDN, it turns out that `IQueryable` inherits `IEnumerable`:

[http://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx)

Hence, you see this behaviour. It is important with LINQ-SQL to work with `IQueryable` unless you want the query *frozen* at the point it is turned to an `IEnumerable`.

In your first example, the `where` is inclusive of the original query. The `select` is not hence the query generated.

In your second example, you capture the table itself into an `IEnumerable`. Any changes on top of this are done in memory on top of the original query.

When you think, the `IEnumerable` version of `where` will not be able to transform the original data of the `IQueryable` due to the cast and how inheritance works.

When you also consider deferred loading, and how LINQ works, this seems to make sense. To me it is a big annoyance, as it can lead you into generating some terrible performing code.

# html - 直到关闭并再次打开 CSS 规则后元素才会对齐

> ID：13407945
> 
> 赞同：0
> 
> 时间：2012-11-15T23:17:26.687
> 
> 标签：html, css

我有一个使用 CSS display:table（内联、行、单元格等）构建的布局。我正在使用 apache 对其进行本地开发，当我刷新页面时，两个 div 容器排列不正确。但是，如果我取消选中并重新选中 display:table-row，它们会自行更正，并且页面会正确显示。

[http://jsfiddle.net/fNNKT/](http://jsfiddle.net/fNNKT/)

您可以在上面的 jsFiddle 中看到 HTML 和 CSS。它实际上也不在那里工作，所以也许我做错了什么，并且可以使用帮助。

```
 <div class="cabinet-container">
                <div class="mode-bar">
                    <div class="mode-bar-left">
                        <div class="mode-bar-item">logo</div>
                        <div class="mode-bar-item active">Dispense</div>
                        <div class="mode-bar-item">Inventory</div>
                    </div>
                    <div class="mode-bar-right schedule">
                        <div class="mode-bar-item">Sign-Out</div>
                    </div>
                </div>
                    <div class="table"></div>
                    <div class="left-container"></div>
                    <div class="center-container">
                        <div class="search-container">
                            <div class="table-cell">
                                <div class="search-field"></div>
                            </div>
                        </div>
                        <div class="nav-button-center-container">
                            <div class="table-cell">
                            </div>
                        </div>
                        <div class="list">
                            <div class="table-cell">
                                <div class="list-item-center-container"></div>
                                <div class="list-item-center-container"></div>
                                <div class="list-item-center-container-partial"></div>
                            </div>
                        </div>
                        <div class="nav-button-center-container-down-active">
                            <div class="table-cell"></div>
                        </div>
                    </div>
                    <div class="footer">
                        <div class="button-group table-border-5">
                            <div class="button-secondary">Dispense Non-Drug</div>
                            <div class="button-secondary">Sort By: Last Name</div>
                        </div>
                        <div class="button-group-right table-border-5">
                            <div class="button-primary">New Clinical Order</div>
                        </div>
                    </div>
            </div>​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:19:58.917

你在使用任何 javascript/jQuery 吗？在我自己最近的一个项目中，我遇到了类似的问题，我所要做的就是将我的自定义灯箱脚本从标签之前的右侧移动，它似乎解决了这个问题。有时javascript可能会像那样不稳定。我不明白为什么，但就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T00:45:56.257

您的问题是否与两行相关`.mode-bar-left`并包含在内？`.mode-bar-right`如果是这样，则问题与空白有关。想想两个并排显示的图像。如果代码中的标签之间有空格，浏览器中就会显示空格。

**解决方案#1：**
将你的逻辑在 DOM 中提升一个层次。`display`将两个 mode-bar 元素的值更改为`table-cell`（而不是 current `inline-table`）。然后将`.mode-bar-item`元素更改为`display: inline-block`（而不是`table-cell`）。

**解决方案 #2：**
一个更快、不太优雅的解决方案是添加`float: left`到`.mode-bar-left`.

关于优雅的主题，我*强烈*建议您考虑一些语义上更有意义的标签，而不仅仅是`div`. 例如，`.mode-bar-left`显然是一个列表（`ul`也许？），而`.mode-bar-item`元素显然是列表项（`li`）。

# php - 根据社交引擎播放列表标题检查文件是否存在于扩展名为 .css 的目录中

> ID：13407946
> 
> 赞同：0
> 
> 时间：2012-11-15T23:17:39.247
> 
> 标签：php, zend-framework, socialengine

我正在努力解决一些我正在使用基于社交引擎的网站的代码。我想要完成的基本工作是检查每个扩展名为 .css 的播放列表标题是否存在名为 /customcss/ 的文件夹中的文件。`$playlist->getTitle`用于获取播放列表标题。

有人可以指出我正确的方向吗？我已经为此苦苦挣扎了几个小时，而且由于 SE 不是开源的，因此网络上的信息很少。

到目前为止，这是我的代码，它没有产生任何错误，但也没有工作......

```
<?php
$filename = '/customcss/$playlist->getTitle.css';
if (file_exists($filename)) {
echo 'official';
} else {
echo 'not official';
}
?> 
```

最好的，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:20:50.133

```
$filename = '/customcss/'.$playlist->getTitle.'.css'; 
```

或者

```
$filename = "/customcss/{$playlist->getTitle}.css"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:49:49.300

$filename = '/customcss/$playlist->getTitle.css'; 会从根上挑选

请使用绝对路径

像

$文件名 = **_*目录*_**。'/customcss/$playlist->getTitle.css';

维姬·比斯瓦斯

# eclipse - stm32f3 发现 gcc-arm eclipse

> ID：13407947
> 
> 赞同：2
> 
> 时间：2012-11-15T23:17:51.567
> 
> 标签：eclipse, gcc, stm32, stm32f4discovery

有人有 STM32 F3 探索板的工作开源环境吗？有没有人有可以轻松从STM32 F4/F0移植到F3发现的教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T09:18:49.067

我用免费工具（Eclipse、OpenOCD 和 Codesourcery 工具链）创建了一个教程。 [http://www.engineering-diy.blogspot.ro/2012/11/stm32f3-discovery-eclipse-openocd.html](http://www.engineering-diy.blogspot.ro/2012/11/stm32f3-discovery-eclipse-openocd.html)

问候， 安德烈

# jquery-ui - 单击后添加新图像

> ID：13407949
> 
> 赞同：0
> 
> 时间：2012-11-15T23:17:55.400
> 
> 标签：jquery-ui, jquery, jquery-plugins, jqgrid

当我单击 z pass 按钮时，我正在尝试添加新图像我的这部分代码不起作用

[http://jsfiddle.net/UjJEJ/24/](http://jsfiddle.net/UjJEJ/24/)

```
$(".ctaSpecialOne").click(function(){                    
                         alert("clicked");  

$(this).parent().unbind("mouseenter").children("img").attr("src", "http://www.onlinegrocerystore.co.uk/images/goodfood.jpg");                

                 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:29:16.613

您需要遍历兄弟姐妹`a`，因为那是您的图像所在的位置

```
$(this).parent().unbind("mouseenter").siblings('a').children("img").attr("src", "http://www.onlinegrocerystore.co.uk/images/goodfood.jpg"); 
```

[http://jsfiddle.net/WAvVw/](http://jsfiddle.net/WAvVw/)

**编辑**

您需要遍历以获取绑定悬停到的元素

```
$(this)
   .closest('.specialHoverOne') // get element you bound hover to
   .unbind("mouseenter") // unbind event
   .end() // start over at this
   .parent()  // get parent
   .siblings('a') //find a sibling
   .children("img") // get children img
   .attr("src", "http://www.onlinegrocerystore.co.uk/images/goodfood.jpg"); // change src 
```

[http://jsfiddle.net/mwPeb/](http://jsfiddle.net/mwPeb/)

我确定有更好的穿越方式，但我现在时间不多了

# ios - Facebook iOS SDK 3.1 请求读取和发布权限

> ID：13407952
> 
> 赞同：15
> 
> 时间：2012-11-15T23:18:13.300
> 
> 标签：ios, facebook

在新的 3.1 iOS SDK 中，我们不再允许同时请求读取和发布权限，我们必须在请求发布权限之前请求读取权限。在我的应用程序中，完成活动后有一个分享按钮。当用户按下此按钮时，我想请求他们发布许可，然后将故事发布到他们的提要中。但是，用户此时可能没有授予应用程序读取权限。

此时用户已表示他们想通过 facebook 分享，但我不能要求他们只提供发布权限，我不能同时要求阅读和发布权限，我不能要求他们提供阅读权限和然后背靠背发布权限（根据文档）。我不想在用户登录或启动应用程序时提示他们读取权限，因为他们很有可能永远不会使用这些功能，而且我不想不必要地打扰用户。

即使文档说不允许，我也可以背靠背请求这两种类型的权限，但这会导致两个弹出框一个接一个，中间有延迟。这感觉像是一种黑客行为，可能会使用户感到困惑。

这真的是新的期望行为吗？我想要做的事情是不可能的，还是有什么我不理解的？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T00:48:45.697

您是正确的，我们强烈建议您不要使用背靠背权限，如果您这样做，您的应用程序不太可能获得批准。

也许抓住机会提前询问基本信息。即使是为了一些简单的个性化（例如头像和姓名），您也可以在发布操作之前建立信任 - 并总体上增加社交体验。

（此外，无论如何，人们不太可能有信心让您从“冷开始”代表他们发布。）

# java - 在java中将一个链表添加到另一个链表

> ID：13407954
> 
> 赞同：0
> 
> 时间：2012-11-15T23:18:18.913
> 
> 标签：java, linked-list

我正在尝试使用 MyLinkedList 类中名为 addList 的方法将链接列表添加到另一个链接列表。我坚持的是如何实现该方法，以便我可以将链表添加到我选择的索引位置的另一个链表中。

这是我在 MyLinkedList 中的内容：

```
public void addList(int index, E e){
    if(index == 0){
        addFirst(e);
    } else if (index >= size){
        addLast(e);
    }
    else{
        Node<E> current = head;
        for(int i = 1; i < index; i++){
            current = current.next;
        }
        Node<E> temp = current.next;
        current.next = new Node<E>(e);
        (current.next).next = temp;
        size++;
    }
} 
```

我知道这个方法行不通，我试过了。在我的程序本身中，我有这些：

```
public class linkedlistwork {

    public static void main(String[] args) {
        MyLinkedList<String> alpha = new MyLinkedList<String>();
        alpha.add("hello");
        alpha.add("world");
        alpha.add("this");

        System.out.println(alpha);

        MyLinkedList<String> beta = new MyLinkedList<String>();
        beta.add("is");
        beta.add("java");
        beta.add("rocks");

        System.out.println(beta);

        alpha.addList(1, beta);
        System.out.println(alpha);
    }
} 
```

正确的输出类似于：

```
OUTPUT:
[hello, is, java, rocks, world, this] 
```

我的程序无法运行，这一行出现错误

```
alpha.addList(1, beta); 
```

在“测试版”部分，它说：

MyLinkedList 类中的方法 addList 不能应用于给定类型；必需：int，String 找到：int，MyLinkedList 原因：实际参数 MyLinkedList 无法通过方法调用转换为 String 其中 E 是类型变量：E 扩展类 MyLinkedList 中声明的 Object

我将如何修复我的方法以便我可以正确使用它？提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:22:50.667

在我看来，您的 addList 方法签名是问题所在。它应该看起来像：

```
public void addList(int index, List<E> list) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:23:01.027

您需要有一种添加方法`MyLinkedList<String>`。这样的事情会做

```
public void addList(int index, MyLinkedList<E> beta){
//Somehow loop through the MyLinkedList, and do this.
   add(index+i,beta(i));
} 
```

# .net-4.0 - 枚举类型未映射到数据库表

> ID：13407957
> 
> 赞同：1
> 
> 时间：2012-11-15T23:18:32.437
> 
> 标签：.net-4.0, entity-framework-5

我在 .NET 4 库中使用 EF 5.0 Code First。试图将一个类成员设置为一个`Enum`类型，但是它没有被持久化到数据库中，并且EF基于代码创建数据库时没有出现运行时异常。

当然，当我尝试查询该枚举时：

```
var departments = db.Departments
                    .Where(dep => dep.Name == DepartmentNames.English); 
```

我得到一个例外说：

```
The specified type member 'Name' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported. 
```

我正在使用 Microsoft 的枚举使用示例：http: [//msdn.microsoft.com/en-us/data/hh859576.aspx](http://msdn.microsoft.com/en-us/data/hh859576.aspx)

尚不支持枚举成员吗？EF 5.0 在由 .NET 4 环境托管时是否与由 .NET 5 环境托管时有所不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T19:08:07.063

在 .NET Framework 4.5 (System.Data.Entity.dll) 中的 EF 5 组件中首次引入的枚举。如果您使用的是 EF5，但目标是 .NET Framework 4，则不支持枚举，因为它们不受 .NET Framework 4 一部分的 System.Data.Entity.dll 的支持。因此，.NET Framework 4 上的 EF5 是与 .NET Framework 4.5 上的 EF5 相比，范围缩小了。面向 .NET Framework 4.5 时可用但面向 .NET Framework 4 时不可用的其他一些功能包括空间类型、表值函数、返回多个结果集的存储过程等等。另一种方法是迁移到不依赖 System.Data.Entity.dll 的 EF6（几周前发布的 Alpha 版本），因此支持 .NET Framework 4.5 和 .NET Framework 4 上的 EF5 中提供的所有功能以及一些更多（例如 .NET Framework 4.5 上的异步）。EF6 是 Microsoft 的一个开源项目，您可以在此处找到所有详细信息：[http://entityframework.codeplex.com/](http://entityframework.codeplex.com/)

# ruby - sinatra 应用程序是否可以使用 2 个数据库？

> ID：13407959
> 
> 赞同：0
> 
> 时间：2012-11-15T23:18:49.947
> 
> 标签：ruby, database, api, heroku, sinatra

我们在 Sinatra 中有一个 API，它同时服务于暂存环境和生产环境。如果请求来自登台服务器，API 应该与登台数据库对话。如果请求来自生产服务器，它应该与生产数据库对话。

所有应用程序都部署在 Heroku 上。

我们可以使用`env['HTTP_HOST']`来确定请求是来自暂存还是生产，然后设置`db_url`.

但是，问题是运行以连接到数据库的 ActiveRecord 初始化代码：

```
db = URI.parse db_url
ActiveRecord::Base.establish_connection(
  :adapter  => db.scheme == 'postgres' ? 'postgresql' : db.scheme,
  :host     => db.host,
  :port     => db.port,
  :username => db.user,
  :password => db.password,
  :database => db.path[1..-1],
  :encoding => 'utf8'
) 
```

在每个请求之前运行此代码是否有意义？那可能会很慢...

另一种解决方案是运行 API 的两个实例。但是我们需要部署两次相同的代码......

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T23:24:09.457

标准实践和常识表明您应该将生产应用程序与暂存应用程序分开。我不确定您对部署两个不同的应用程序有何反对，但这是确保暂存问题不会影响您的生产应用程序的唯一方法。

# javascript - jQuery 的 click() 函数怎么会比 addEventListener() 快这么多？

> ID：13407960
> 
> 赞同：11
> 
> 时间：2012-11-15T23:18:53.457
> 
> 标签：javascript, jquery, event-handling, jquery-events

我相信我们都看过[**vanilla-js**](http://vanilla-js.com/)（最快的 JavaScript 框架）的网站；D 我只是好奇，在为点击添加事件处理程序时，纯 JavaScript 到底比 jQuery 快多少。所以我前往 jsPerf 进行测试，[**结果让我感到非常惊讶**](http://jsperf.com/click-vs-addeventlistener/5)。

jQuery 的性能比普通的 JavaScript 高出**2500% 以上**。

我的测试代码：

```
//jQuery
$('#test').click(function(){
  console.log('hi');
});

//Plain JavaScript
document.getElementById('test').addEventListener('click', function(){
  console.log('hi');
}); 
```

我只是无法理解这是如何发生的，因为看起来 jQuery 最终将不得不使用与普通 JavaScript 使用的完全相同的函数。**有人可以解释为什么这会发生在我身上吗？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-15T23:31:13.877

正如您在 jQuery.event.add 的这段代码片段中看到的那样，它只创建一次 eventHandle。
查看更多：http: [//james.padolsey.com/jquery/#v=1.7.2&fn=jQuery.event.add](http://james.padolsey.com/jquery/#v=1.7.2&fn=jQuery.event.add)

```
 // Init the element's event structure and main handler, if this is the first
events = elemData.events;
if (!events) {
    elemData.events = events = {};
}
eventHandle = elemData.handle;
if (!eventHandle) {
    elemData.handle = eventHandle = function (e) {
        // Discard the second event of a jQuery.event.trigger() and
        // when an event is called after a page has unloaded
        return typeof jQuery !== "undefined" && (!e || jQuery.event.triggered !== e.type) ? jQuery.event.dispatch.apply(eventHandle.elem, arguments) : undefined;
    };
    // Add elem as a property of the handle fn to prevent a memory leak with IE non-native events
    eventHandle.elem = elem;
} 
```

这里我们有 addEventListener：

```
 // Init the event handler queue if we're the first
    handlers = events[type];
    if (!handlers) {
        handlers = events[type] = [];
        handlers.delegateCount = 0;

        // Only use addEventListener/attachEvent if the special events handler returns false
        if (!special.setup || special.setup.call(elem, data, namespaces, eventHandle) === false) {
            // Bind the global event handler to the element
            if (elem.addEventListener) {
                elem.addEventListener(type, eventHandle, false);

            } else if (elem.attachEvent) {
                elem.attachEvent("on" + type, eventHandle);
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-15T23:21:29.297

我认为这是因为内部 jQuery 真的只需要调用`addEventListener()` **一次**，用于它自己的内部处理程序。设置完成后，只需将您的回调添加到一个简单的列表中。因此，大多数电话`.click()`只是做一些簿记和a `.push()`（或类似的东西）。

# php - 从服务器自动删除文件？

> ID：13407964
> 
> 赞同：0
> 
> 时间：2012-11-15T23:19:25.137
> 
> 标签：php, file, timestamp, delete-file

我想知道是否有一种使用脚本或其他选项的方法，我可以在某个日期自动从我的服务器中删除文件。

我创建了一个 AS3 eCard 应用程序，其中一个 php 脚本将一个 *.txt 文件写入一个包含消息等相关详细信息的文件夹，并且想知道是否有可能以某种方式自动删除超过 'n' 天的文件避免网站混乱？

**PHP 修正：**

```
 <?php

if ($handle = opendir('/myFolder/holdingFolder')) {

while (false !== ($file = readdir($handle))) { 
    $filelastmodified = filemtime($file);

    if((time() - $filelastmodified) > 14*24*3600)
    {
       unlink($file);
    }

}

closedir($handle); 
}
?> 
```

我仍在学习 php，如果有更多经验的人可以查看此内容以指出正确的方向，如果这是在创建 14 天后删除文件夹中文件的正确方法，我将不胜感激？

如果是这样，我的服务器是 windows/Plesk，我需要任何特殊的命令来运行它吗？你建议多久运行一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:23:26.500

根据您所说的，我认为您最容易开始使用的是 cron 作业和 php 脚本。

编写一个 PHP 脚本来循环检查创建日期的文件并删除旧文件。然后在 cron 作业上设置 PHP 脚本，该作业可以按您想要的任何时间表运行。

当然有 1000 种方法可以解决这个问题，但听起来您已经了解 PHP，并且 cron 在任何 *nix 系统上都可用。

[这是一个指向 Crontab 信息和使用情况的随机 Google 结果的链接。](http://www.pantz.org/software/cron/croninfo.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:41:38.547

尝试：

```
<?php
$dir = '/path/to/files/';
$days = 3600 * 24 * 7; // 7 days
if($handle = opendir($dir)) {

    /* This is the correct way to loop over the directory. */
    while (false !== ($file = readdir($handle))) {
        if ( filemtime($dir.$file) <= time()-$days) {
           unlink($dir.$file);
        }
    }

    closedir($handle);
} 
```

然后通过 cron 运行这个脚本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T00:13:35.220

如果您可以访问 cron，那么您就不需要 PHP - 例如，每天一次...。

```
23 4 * * * find /your/directory -iname \*.txt -mtime +3 -exec rm -f {} \; 
```

如果您无权访问 cron，则将其作为垃圾收集作为关闭功能运行。例如（公然窃取凯尔哈德森的代码，尽管我注意到他甚至[从这里](http://php.net/manual/en/function.readdir.php)复制了评论；）

```
function gc_txt_files()
{
   $dir = '/path/to/files/';
   $days = 3600 * 24 * 7; // 7 days
   if($handle = opendir($dir)) {
        /* This is the correct way to loop over the directory. */
        while (false !== ($file = readdir($handle))) {
           if ( filemtime($dir.$file) <= time()-$days) {
              unlink($dir.$file);
           }
        }
        closedir($handle);
    }
}
if (17==rand(0,200)) { // adjust 200 depending on how frequently you want to clear out
    register_shutdown_function('gc_txt_files');
} 
```

# android - 如何远程调用设备管理策略？

> ID：13407965
> 
> 赞同：1
> 
> 时间：2012-11-15T23:19:26.917
> 
> 标签：android, broadcastreceiver, device-admin

我想要做的是，有一个 [BroadcastReceiver] 来监听任何传入的 SMS，当传入的 SMS 具有某个关键字时，它将传递给设备管理员并调用所需的策略。

我创建了一个 BroadcastReceiver 来收听 SMS 并弹出一个 toast，它工作正常。然后我按照本指南创建了一个设备管理应用程序：http: [//marakana.com/s/post/1291/android_device_policy_administration_tutorial](http://marakana.com/s/post/1291/android_device_policy_administration_tutorial)，它应该可以正常工作。但是，当我将该 SMS 接收器与设备管理员一起包含时，只要有短信进来，它就会崩溃。此外，我无法将要使用的字符串从 SMS 接收器传递到我的设备管理应用程序以调用所需的政策。

这是我的设备管理员

```
public class AppPolicyActivity extends Activity implements OnCheckedChangeListener {

static final int ACTIVATION_REQUEST = 47;
DevicePolicyManager mDPM;
ComponentName appPolicy;
ToggleButton toggleBtn;

@Override
public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main_activity_layout);

    toggleBtn = (ToggleButton) findViewById(R.id.toggleBtn);
    toggleBtn.setOnCheckedChangeListener(this);

    mDPM = (DevicePolicyManager) getSystemService(Context.DEVICE_POLICY_SERVICE);
    appPolicy = new ComponentName(this, AppPolicyReceiver.class);

// The commented code below made my app crash during installation
/*      Intent intent;
    try {
        if (getIntent() != null) {
            intent = getIntent();
            String keyword = intent.getStringExtra("keyword");
            if (keyword.equals("LOCK")) {
                receivedSMS(keyword);
            } else if (keyword.equals("WIPE")) {
                receivedSMS(keyword);
            }
            keyword = "";
            intent = null;
            finish();
        } 
    } catch (Exception e) {} */
}

public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
    // TODO Auto-generated method stub
    if (isChecked) {
        Intent intent = new Intent(DevicePolicyManager.ACTION_ADD_DEVICE_ADMIN);
        intent.putExtra(DevicePolicyManager.EXTRA_DEVICE_ADMIN, appPolicy);
        intent.putExtra(DevicePolicyManager.EXTRA_ADD_EXPLANATION, "Activate the application to use its features");
        startActivityForResult(intent, ACTIVATION_REQUEST);
    } else {
        mDPM.removeActiveAdmin(appPolicy);
    }
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    switch (requestCode) {
    case ACTIVATION_REQUEST:
        if (resultCode == Activity.RESULT_OK) {
            toggleBtn.setChecked(true);
        } else {
            toggleBtn.setChecked(false);
        }
        return;
    }
    super.onActivityResult(requestCode, resultCode, data);
}

public void receivedSMS(String keyword) {
    // Lock
    if (keyword.equals("LOCK")) {
        mDPM.lockNow();
    } 
    // Wipe/delete
    else if (keyword.equals("WIPE")) {
        mDPM.wipeData(ACTIVATION_REQUEST);
    }
}
} 
```

这是设备管理员接收器类

```
public class AppPolicyReceiver extends DeviceAdminReceiver {

@Override
public void onDisabled(Context context, Intent intent) {
    // TODO Auto-generated method stub
    Toast.makeText(context, R.string.disabletext, Toast.LENGTH_SHORT).show();
    super.onDisabled(context, intent);
}

@Override
public void onEnabled(Context context, Intent intent) {
    // TODO Auto-generated method stub
    Toast.makeText(context, R.string.enabletext, Toast.LENGTH_SHORT).show();
    super.onEnabled(context, intent);
}
} 
```

这是我的清单

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.fyp.mobilesecurity"
android:versionCode="1"
android:versionName="1.0">

<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

<uses-permission android:name="android.permission.RECEIVE_SMS"/>
<uses-permission android:name="android.permission.SEND_SMS"/>

<application android:label="@string/app_name"
    android:icon="@drawable/ic_launcher"
    android:theme="@style/AppTheme">

    <activity android:name="AppPolicyActivity" 
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>
    </activity>

    <!-- appPolicyReceiver -->
    <receiver android:permission="android.permission.BIND_DEVICE_ADMIN" android:name="AppPolicyReceiver">
        <intent-filter>
            <action android:name="android.app.action.DEVICE_ADMIN_ENABLED"/>
            <action android:name="android.app.action.DEVICE_ADMIN_DISABLED"/>
        </intent-filter>
        <meta-data android:resource="@xml/app_admin" 
            android:name="android.app.device_admin"/>
    </receiver>

    <!-- SMSReceiver -->
    <receiver android:enabled="true" android:name="SMSReceiver" android:exported="true">
        <intent-filter>
            <action android:name="android.provider.Telephony.SMS_RECEIVED" />
        </intent-filter>
    </receiver>

</application>

</manifest> 
```

这是来自日志，你可以看到我的接收器甚至没有启动。

```
11-17 21:06:52.300: E/AndroidRuntime(375): java.lang.RuntimeException: Unable to start receiver com.fyp.mobilesecurity.SMSReceiver: java.lang.NullPointerException 
```

我只是意识到它返回了一个异常，所以我将我的接收器封闭在 try/catch 块中，现在它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T08:10:53.917

您需要查看导致 SMSReceiver 中 NullPointerException 的原因。堆栈跟踪将具有行号。

# json - 返回并显示一个 JSON 对象，它是 Windows 8 应用程序中的关联数组

> ID：13407969
> 
> 赞同：0
> 
> 时间：2012-11-15T23:19:45.283
> 
> 标签：json, web-services, windows-8

我正在使用在线教程来学习如何创建 Web 服务、生成 JSON 对象、将其发送回我的 Win 8 应用程序并显示它。Web 服务正在运行，但是我正在努力将值返回给 APP。我在应用程序中的代码是：

```
 WinJS.xhr({                         
         url: 'http://localhost/filmgloss/web-service.php?termID=1&format=JSON'
     })
         .done(
            function complete(result) {

                // terms is the key of the object
                for (var terms in result) {

                    for (var term in terms) {

                        if (result.hasOwnProperty(term)) {
                            //here you have to acess to
                            var termName = result[term].termName;
                            var def = result[term].definition;
                        }
                        //Show Terms                 
                        testDef.innerText = definition;
                    }
                }
            }, 
```

他在我的网络服务中的代码是：

```
if($format == 'json') {
   header('Content-type: application/json');
   echo json_encode(array('terms'=>$terms));
}else... 
```

JSON 输出本身如下所示：

```
 {"terms":[{"term":{ "termName":"Focus","definition":"A Focus..."}}]} 
```

我正在使用一个`for..in`但我可以查看内部`terms' I can't work out how to look in`术语

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:30:04.053

我通常构建自己的数据结构来表示 JSON 结构。
在你的情况下，它会是这样的：

```
public class TermsList
{
    public List<Term> terms { get; set; } 
}

public class Term
{
    public string termName { get; set }
    public definition termName { get; set }
    ...
} 
```

然后你可以将你的字符串反序列化到你的对象中。有不同的方法可以做到这一点。我会使用 Json.Net。
这是一种方法：
[在 C# 中解析 JSON](https://stackoverflow.com/questions/1212344/parse-json-in-c-sharp)

```
public static T Deserialise<T>(string json)
{
    T obj = Activator.CreateInstance<T>();
    using (MemoryStream ms = new MemoryStream(Encoding.Unicode.GetBytes(json)))
    {
        DataContractJsonSerializer serializer = new DataContractJsonSerializer(obj.GetType());
        obj = (T)serializer.ReadObject(ms); // <== Your missing line
        return obj;
    } 
} 
```

如果你想让它保持动态，那也应该工作：

[http://www.drowningintechnicaldebt.com/ShawnWeisfeld/archive/2010/08/22/using-c-4.0-and-dynamic-to-parse-json.aspx](http://www.drowningintechnicaldebt.com/ShawnWeisfeld/archive/2010/08/22/using-c-4.0-and-dynamic-to-parse-json.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T11:26:17.963

在开发人员朋友的帮助下，我设法解决了我的问题。我的问题是我没有意识到结果`WinHS.xhr`还不是 JSON 数组。尽管我的 Web 服务在通过它使用时输出一个 JSON 数组，但`WinHS.xhr`它似乎是作为一个`XMLHttpRequest`对象返回的。

因此，解决方案是使用以下方法处理结果：

`JSON.parse(result.responseText)`

然后我可以按预期使用`For...In`循环：

```
 for (terms in responseTerms) {

             //terms will find key "terms"
             var termName = responseTerms.terms[0].term.termName;
             var termdefinition = responseTerms.terms[0].term.definition;

             testTerm.innerText = termName;
             testDef.innerText = termdefinition;

         } 
```

感谢所有评论的人，如果他们开始使用 Win 8 应用程序开发，希望这可以帮助其他人。

# php - 没有插入我期望的地方

> ID：13407975
> 
> 赞同：0
> 
> 时间：2012-11-15T23:20:19.207
> 
> 标签：php, mysql

在 mysql 表中，我有 3 个字段。user_to、user_from 和 id。变量都是正确的，应该插入正确的数据。

当单击一个名为“poke”的按钮时，它应该插入一个 cookie，该 cookie 存储了执行此操作的人和被戳的人的会话。它似乎没有插入，我被卡住了:(

```
 $cookie = $_SESSION['user_login'];
 //Poke code
 if (@$_POST['poke']) {
 $check_if_poked = mysql_query("SELECT * FROM pokes WHERE user_to='$username' && user_from='$added_by'");
 $num_poke_found = mysql_num_rows($check_if_poked);

 if ($num_poke_found == 1) {
 echo "Come on! Give the guy a chance!";
 }
 else
 if ($username == $cookie) {
 echo "You cannot Jab yourself.";
 }
 else
 { $poke_user = mysql_query("INSERT INTO `pokes` ('user_from', 'user_to') VALUES ('$cookie', '$username')") or trigger_error(mysql_error());
  echo "$username has been jabbed.";
 }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:27:38.183

您在 MySQL 查询中对字段使用了错误的引号。

```
//your wrong variant
"INSERT INTO `pokes` ('user_from', 'user_to') VALUES ('$cookie', '$username')"

//right variant
"INSERT INTO `pokes` (`user_from`, `user_to`) VALUES ('$cookie', '$username')" 
```

SQL 语法中的“平均值”之类的引号和 ` 平均值字段之类的引号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:38:24.373

```
<?php
if ($_POST['poke']) {
 #ref to the current user
 $from = $_SESSION['user_login'];
 #ref to the (poked user)
 $to = $_POST['poked_user_id'];

 if($from == $to){
    echo "you cant poke yourself!";
 }
 else{
    #ADVICE: USE PDO OR MYSQLI INSTEAD OF MYSQL

    $check_if_poked = mysql_query("SELECT * FROM pokes WHERE user_to='$to' AND user_from='$from'");
    if(mysql_num_rows($check_if_poked)){
        echo "Come on! Give the guy a chance!";
    }
    else{
        if(mysql_query("INSERT INTO `pokes` (`user_from`, `user_to`) VALUES ('$from', '$to')")){
            echo "$to has been jabbed.";
        }
        else{
        trigger_error(mysql_error());
        }
    }
 }
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T00:03:29.283

这开始是作为评论 - 但它太长了，无法适应。

会话与用户名不同 - 您的帖子非常混乱。

撇开错误的引号（这就是为什么你的代码没有按照你的期望做的）......

> 在 mysql 表中，我有 3 个字段。user_to、user_from 和 id

...在这种情况下，您不需要检查该行是否已经存在 - 并且不需要创建重复项。然后设置唯一索引...

```
if (@$_POST['poke'] && ($_SESSION['user_login']!===$username)) {
   $qry = "INSERT INTO `pokes` (`user_from`, `user_to`) 
          VALUES (".mysql_real_escape_string($_SESSION['user_login'])
          .", '" . mysql_real_escape_string($username) . "')"
   if (mysql_query($qry)){
      echo "$username has been jabbed.";
   } else if (stristr(mysql_error(), 'duplicate')) {
      echo "Come on! Give the guy a chance!";
   } else {
      echo "It's all gone Pete Tong!";
   }
 } else if ($_SESSION['user_login']!===$username) {
    echo "You cannot Jab yourself.";
 } 
```

虽然 PHP 处理的工作量大致相同，但数据库工作量要少得多。此代码还可以防止一些 SQL 注入攻击，并具有错误处理功能。我假设 $username 已在其他地方创建，并且您没有启用 register_globals。

# browser - access_token 未显示在 SWT 浏览器的 url 中

> ID：13407978
> 
> 赞同：1
> 
> 时间：2012-11-15T23:20:41.703
> 
> 标签：browser, swt, access-token

我正在开发一个 Eclipse 插件，用户需要在 SWT 浏览器中登录他们的 Facebook 帐户。我正在使用[此处](http://developers.facebook.com/docs/reference/dialogs/oauth/)描述的方式尝试从 url 获取访问令牌。直到今天它一直运作良好。问题是重定向的 uri 不再跟随“access_token = ...”。然后我手动尝试从真实浏览器中的 url 获取访问令牌。它适用于 Chrome 和 FireFox，不适用于 IE。在我的程序中，SWT 浏览器定义如下：

```
Browser browser = new Browser(container, SWT.NONE); 
```

我猜它一定是在后台使用了 IE，并且 IE 出于某种原因从 url 中隐藏了 access_token。有什么想法可以取消隐藏访问令牌吗？

非常感谢任何输入！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T09:10:39.317

以下答案仅涉及您问题的 SWT 部分。

`org.eclipse.swt.browser.Browser`正在为其支持的每个平台使用[本机渲染器。](http://www.eclipse.org/swt/faq.php#browserplatforms)

对于 Windows，默认值恰好是 IE。

根据您的用例（即您需要支持的操作系统、Eclipse 版本），您可以[强制小部件使用不同的本机渲染器](http://www.eclipse.org/swt/faq.php#browserspecifydefault)。

# java - 命令行的javac“找不到符号”错误

> ID：13407983
> 
> 赞同：13
> 
> 时间：2012-11-15T23:21:05.407
> 
> 标签：java, javac

我有两个类 Owning 和 OwningAccessor。这些文件位于同一目录中。

```
public class Owning {
    String _name = "";
    public void printBanner()
    {
    }
    public void printOwning(double amount)
    {
        printBanner();

        //print details
        System.out.println("name:" + _name);
        System.out.println("amount:" + amount);
    }
}

public class OwningAccessor {
    public void access()
    {
        Owning o = new Owning();
        o.printOwning(500);
    }
} 
```

当我尝试用 编译`OwningAccessor`时`javac -cp . OwningAccessor.java`，出现编译错误。

```
symbol  : class Owning
location: class smcho.OwningAccessor
        Owning o = new Owning();
        ^
OwningAccessor.java:6: cannot find symbol
symbol  : class Owning
location: class smcho.OwningAccessor
        Owning o = new Owning();
                   ^ 
```

这有什么问题？该代码在 Eclipse IDE 下编译良好。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-15T23:58:26.990

好的，假设您将代码分布在文件中，如下所示

```
myproject
├── out
└── src
    ├── OwningAccessor.java
    └── Owning.java 
```

转到您的命令提示符，并将目录更改为`myproject`. 在那里发出以下命令：

```
javac -d out -sourcepath src src/OwningAccessor.java 
```

我刚刚测试了它，它工作得很好。您编译的类将位于`out`文件夹中：

```
.
├── out
│   ├── OwningAccessor.class
│   └── Owning.class
└── src
    ├── OwningAccessor.java
    └── Owning.java 
```

编译一个类将触发所有其他依赖类的编译。编译器将自动在`src`文件夹中查找它们。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-15T23:23:49.287

确保同时编译 Owning.java 和 OwningAccessor.java，如下所示：

`javac -cp . Owning.java OwningAccessor.java`

Eclipse 为您编译所有必要的文件，这就是为什么在那里工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-29T20:37:50.537

尝试制作正确的源路径示例：

```
javac -d temp -sourcepath c:\awork\JavaProjects\singleton\src\ c:\JavaProjects\singleton\src\com\company\MySingleton.java

javac -d temp -sourcepath c:\awork\JavaProjects\singleton\src\ c:\JavaProjects\singleton\src\com\company\Main.java

```

在“temp”中，我们分配资源并使用**-sourcepath**指示 .java 文件的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-08T13:03:52.560

因此，在名为 D:\Automation 的目录中有一个文件 Demo.java 抛出此错误，在 cmd 中，当您在 D:\Automation 中时，您需要： - 1) cd.. // 将您从 Automation 中拉出来目录。在 D:> 2) javac Automation\Demo.java

这将编译您的文件 - Demo.java

# android - 安卓前置摄像头

> ID：13407991
> 
> 赞同：1
> 
> 时间：2012-11-15T23:21:55.547
> 
> 标签：android, camera

我正在制作一个应用程序，用户可以在其中通过定制的相机录制视频。用户还可以通过前置摄像头录制视频。它录制得很好，但是当我们在普通媒体播放器中播放它时，它只是在 180 度播放。我不知道这怎么可能以及如何解决？请向我建议任何有关相同的解决方案。

**代码：**

```
package com.irantapps.cameraApplication;

import java.io.File;
import java.io.IOException;

import android.annotation.SuppressLint;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.hardware.Camera;
import android.media.ExifInterface;
import android.media.MediaPlayer;
import android.media.MediaRecorder;
import android.media.MediaRecorder.VideoEncoder;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.os.SystemClock;
import android.provider.MediaStore;
import android.util.Log;
import android.view.KeyEvent;
import android.view.Surface;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.Window;
import android.view.animation.AlphaAnimation;
import android.view.animation.Animation;
import android.view.animation.LinearInterpolator;
import android.widget.Button;
import android.widget.Chronometer;
import android.widget.ImageButton;
import android.widget.LinearLayout;
import android.widget.Toast;

import com.irantapps.AfterLoginHome;
import com.irantapps.BaseActivity;
import com.irantapps.CameraPlay_New;
import com.irantapps.R;
import com.irantapps.utility.DateAndLength;
import com.irantapps.utility.VideoDetailsCollection;

/***
 * TODO: 1\. sound on/off 2\. resolution change
 * 
 * @author roman10
 * 
 */

public class VideoCapture_New extends BaseActivity implements
        SurfaceHolder.Callback {
    private SurfaceView prSurfaceView;
    private ImageButton prStartBtn, prFrontBackCamera;
    private Button prSettingsBtn;
    private ImageButton btn_Gallery;
    public String TAG = "IRANT";
    private boolean prRecordInProcess;
    private SurfaceHolder prSurfaceHolder;
    private Camera prCamera;
    private final String cVideoFilePath = "/sdcard/";
    Chronometer cm_VideoCapture;
    private Context prContext;
    public static boolean frontCamera = false;
    int mRotation;
    LinearLayout linearLayoutRedbtn;
    ImageButton btn;
    Animation animation;
    ImageButton btn_Cancel;
    DateAndLength findDateandLength;
    private VideoDetailsCollection videoDetails = VideoDetailsCollection.getSingletonObject();
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        prContext = this.getApplicationContext();
        setContentView(R.layout.videocapture_new);
        Utils.createDirIfNotExist(cVideoFilePath);
        findDateandLength=DateAndLength.getSingletonObject();
        animation = new AlphaAnimation(1, 0); // Change alpha from fully visible
                                                // to invisible
        animation.setDuration(500); // duration - half a second
        animation.setInterpolator(new LinearInterpolator()); // do not alter
                                                                // animation
                                                                // rate
        animation.setRepeatCount(Animation.INFINITE); // Repeat animation
                                                        // infinitely
        animation.setRepeatMode(Animation.REVERSE); // Reverse animation at the
                                                    // end so the button will
                                                    // fade back in
        btn = (ImageButton) findViewById(R.id.main_btn1);
        btn_Cancel = (ImageButton)findViewById(R.id.btn_wrongTick);
        btn_Gallery = (ImageButton)findViewById(R.id.btn_gallerySelector);
        linearLayoutRedbtn = (LinearLayout) findViewById(R.id.linear_btn1);

        linearLayoutRedbtn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                if (prRecordInProcess == false) {
                    cm_VideoCapture.setBase(SystemClock.elapsedRealtime());
                    //cm_VideoCapture.clearComposingText();

                    cm_VideoCapture.start();
                    try {
                        startRecording();
                    } catch (NoSuchMethodException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    linearLayoutRedbtn.startAnimation(animation);
                } else {
                    stopRecording();
                    linearLayoutRedbtn.clearAnimation();
                    cm_VideoCapture.stop();
                    findDateandLength.setTimeLengthOfVideo(cm_VideoCapture.getText().toString());
            //Toast.makeText(getApplicationContext(), "hello..."+cm_VideoCapture.getText(), Toast.LENGTH_LONG).show();      
                    cm_VideoCapture.clearComposingText();
                    Intent intent = new Intent(VideoCapture_New.this,
                            CameraPlay_New.class);
                    startActivity(intent);
                }

            }
        });
        btn_Gallery.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                  Intent intent = new Intent();
                  intent.setType("video/*");
                  intent.setAction(Intent.ACTION_GET_CONTENT);
                  startActivityForResult(Intent.createChooser(intent,"Select Video"), 2);
            }
        });
        cm_VideoCapture = (Chronometer) findViewById(R.id.cm_VideoCapture);
        prSurfaceView = (SurfaceView) findViewById(R.id.surface_camera);
        prStartBtn = (ImageButton) findViewById(R.id.main_btn1);
        prFrontBackCamera = (ImageButton) findViewById(R.id.btn_frontBackCamera);

        //cm_VideoCapture.start();

        cm_VideoCapture.clearComposingText();
        // prSettingsBtn = (Button) findViewById(R.id.main_btn2);
        prRecordInProcess = false;
        prStartBtn.setOnClickListener(new View.OnClickListener() {
            // @Override
            public void onClick(View v) {
                if (prRecordInProcess == false) {
                    cm_VideoCapture.setBase(SystemClock.elapsedRealtime());
                    //cm_VideoCapture.clearComposingText();

                    cm_VideoCapture.start();
                    try {
                        startRecording();
                    } catch (NoSuchMethodException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                } else {
                    stopRecording();
                    btn.clearAnimation();
                    cm_VideoCapture.stop();
                    cm_VideoCapture.clearComposingText();
                    Intent intent = new Intent(VideoCapture_New.this,
                            CameraPlay_New.class);
                    startActivity(intent);
                }
            }
        });

        prFrontBackCamera.setOnClickListener(new View.OnClickListener() {

            @SuppressLint("NewApi")
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                // prCamera = openFrontFacingCameraGingerbread();
                try {
                    if (Camera.getNumberOfCameras() == 2) {
                        if (frontCamera) {
                            frontCamera = false;
                            prCamera.stopPreview();
                            prMediaRecorder.release();
                            prMediaRecorder = null;
                            prCamera.release();
                            prCamera = null;
                        } else {

                            frontCamera = true;
                            prCamera.stopPreview();
                            prMediaRecorder.release();
                            prMediaRecorder = null;
                            prCamera.release();
                            prCamera = null;
                        }
                        Intent intent = new Intent(VideoCapture_New.this,
                                VideoCapture_New.class);
                        startActivity(intent);
                    } else {
                        Toast.makeText(VideoCapture_New.this,
                                "Your device doesn't contain Front Camera.",
                                Toast.LENGTH_SHORT).show();
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                    Toast.makeText(VideoCapture_New.this,
                            "Your device is not compatible for Front Camera.",
                            Toast.LENGTH_SHORT).show();

                }

            }
        });

        prSurfaceHolder = prSurfaceView.getHolder();
        prSurfaceHolder.addCallback(this);
        prSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        // prCamera.setDisplayOrientation(90);
        prMediaRecorder = new MediaRecorder();

        btn_Cancel.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                finish();
            }
        });
    }

    @Override
    public void surfaceChanged(SurfaceHolder _holder, int _format, int _width,
            int _height) {
        Camera.Parameters lParam = prCamera.getParameters();

        prCamera.setParameters(lParam);
        try {
            prCamera.setPreviewDisplay(_holder);
            prCamera.startPreview();
            // prPreviewRunning = true;
        } catch (IOException _le) {
            _le.printStackTrace();
        }
    }

    @SuppressLint({ "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi", "NewApi" })
    @Override
    public void surfaceCreated(SurfaceHolder arg0) {
        if (frontCamera == false && prCamera== null) {
            /*prCamera = Camera.open();
            if (prCamera == null) {
                Toast.makeText(this.getApplicationContext(),
                        "Camera is not available!", Toast.LENGTH_SHORT).show();
                finish();
            }*/
            prCamera = Camera.open();
            try {
                prCamera.setPreviewDisplay(arg0);

                // TODO test how much setPreviewCallbackWithBuffer is faster
                //prCamera.setPreviewCallback(VideoCapture_New.this);
            } catch (IOException e) {
                prCamera.release();
                prCamera = null;
            }

            if (prCamera == null) {
                Toast.makeText(this.getApplicationContext(),
                        "Camera is not available!", Toast.LENGTH_SHORT).show();
                finish();
            }
        } 
        /*else if (prCamera == null) {
            prCamera = Camera.open();
            try {
                prCamera.setPreviewDisplay(arg0);

                // TODO test how much setPreviewCallbackWithBuffer is faster
                //prCamera.setPreviewCallback(VideoCapture_New.this);
            } catch (IOException e) {
                prCamera.release();
                prCamera = null;
            }

            if (prCamera == null) {
                Toast.makeText(this.getApplicationContext(),
                        "Camera is not available!", Toast.LENGTH_SHORT).show();
                finish();
            }
        }*/else if (prCamera!=null){
            prCamera.stopPreview();
            prCamera.release();
            prCamera=null;
    }

        else if (frontCamera == true) {
            try {
                int cameraCount = 0;
                Camera.CameraInfo cameraInfo = new Camera.CameraInfo();
                cameraCount = Camera.getNumberOfCameras();
                for (int camIdx = 0; camIdx < cameraCount; camIdx++) {
                    Camera.getCameraInfo(camIdx, cameraInfo);
                    if (cameraInfo.facing == Camera.CameraInfo.CAMERA_FACING_FRONT) {
                        try {
                            prCamera = Camera.open(camIdx);
                        } catch (RuntimeException e) {
                            Log.i("Camera failed to open: ",
                                    e.getLocalizedMessage());
                        }
                    }
                }
            } catch (Exception e) {
                Toast.makeText(VideoCapture_New.this,
                        "Your Device doesn't compatible for Fron Camera.",
                        Toast.LENGTH_SHORT).show();
            }
        }
        try {
            Camera.CameraInfo info = new android.hardware.Camera.CameraInfo();
            Camera.getCameraInfo(0, info);
            int rotation = getWindowManager().getDefaultDisplay().getRotation();
            int degrees = 0;
            switch (rotation) {
            case Surface.ROTATION_0:
                degrees = 0;
                break;
            case Surface.ROTATION_90:
                degrees = 90;
                break;
            case Surface.ROTATION_180:
                degrees = 180;
                break;
            case Surface.ROTATION_270:
                degrees = 270;
                break;
            }
            int result;
            if (info.facing == Camera.CameraInfo.CAMERA_FACING_FRONT) {
                result = (info.orientation + degrees) % 180;
                result = (360 - result) % 360; // compensate the mirror
            } else { // back-facing
                result = (info.orientation - degrees + 360) % 360;
            }
            this.mRotation = result;
            prCamera.setDisplayOrientation(result);
        } catch (NoClassDefFoundError e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            prCamera.setDisplayOrientation(90);
            Toast.makeText(VideoCapture_New.this,
                    "There is no Front Camera Facility.", Toast.LENGTH_SHORT)
                    .show();
        }
    }

     @Override
     public void surfaceDestroyed(SurfaceHolder holder) {
         if (prCamera != null) {
             prCamera.stopPreview();
             prCamera.setPreviewCallback(null);
             prCamera.release();
             prCamera = null;
         }
     }

    /*@Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
        try {
            if (prRecordInProcess) {
                stopRecording();
            } else {
                prCamera.stopPreview();
            }
            prMediaRecorder.release();
            prMediaRecorder = null;
            prCamera.release();
            prCamera = null;
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }*/

    private MediaRecorder prMediaRecorder;
    private final int cMaxRecordDurationInMs = 30000;
    private final long cMaxFileSizeInBytes = 5000000;
    private final int cFrameRate = 20;
    private File prRecordedFile;

    private void updateEncodingOptions() {
        if (prRecordInProcess) {
            stopRecording();
            try {
                startRecording();
            } catch (NoSuchMethodException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            Toast.makeText(prContext, "Recording restarted with new options!",
                    Toast.LENGTH_SHORT).show();
        } else {
            Toast.makeText(prContext, "Recording options updated!",
                    Toast.LENGTH_SHORT).show();
        }
    }

    @SuppressLint("NewApi")
    private boolean startRecording() throws NoSuchMethodException {
        prCamera.stopPreview();
        try {
            prCamera.unlock();
            prMediaRecorder.setCamera(prCamera);

            prMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
            prMediaRecorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);
            String lVideoFileFullPath = ".mov";

            prMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
            String lDisplayMsg = "Current container format: ";
            prMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
            prMediaRecorder.setVideoEncoder(VideoEncoder.H263);
            prMediaRecorder.setOrientationHint(90);

            lDisplayMsg += "Current encoding format: ";

            lVideoFileFullPath = Environment.getExternalStorageDirectory() + "/myvideo.mp4";
            // prMediaRecorder.setOrientationHint(360);
            //prMediaRecorder.setVideoSize(176, 144);
            //prMediaRecorder.setVideoFrameRate(12);
            prRecordedFile = new File(lVideoFileFullPath);
            prMediaRecorder.setOutputFile(prRecordedFile.getPath());

            //prMediaRecorder.setVideoFrameRate(cFrameRate);
            prMediaRecorder.setPreviewDisplay(prSurfaceHolder.getSurface());
            //prMediaRecorder.setMaxDuration(cMaxRecordDurationInMs);
            //prMediaRecorder.setMaxFileSize(cMaxFileSizeInBytes);
            // prepare for capturing
            // state: DataSourceConfigured => prepared
            prMediaRecorder.prepare();
            // start recording
            // state: prepared => recording
            prMediaRecorder.start();
            // prStartBtn.setText("Stop");
            prRecordInProcess = true;
            ExifInterface exif_Video = new ExifInterface(lVideoFileFullPath);     //Since API Level 5
            String exifOrientation_video = exif_Video.getAttribute(ExifInterface.TAG_ORIENTATION);
            return true;
        } catch (IOException _le) {
            _le.printStackTrace();
            return false;
        }
    }

    private void stopRecording() {
        prMediaRecorder.stop();
        prMediaRecorder.reset();
        try {
            prCamera.reconnect();
        } catch (IOException e) {
            e.printStackTrace();
        }
        // prStartBtn.setText("Start");
        prRecordInProcess = false;
        prCamera.startPreview();
    }

    private static final int REQUEST_DECODING_OPTIONS = 0;

    @Override
    protected void onActivityResult(int requestCode, int resultCode,
            Intent intent) {
        super.onActivityResult(requestCode, resultCode, intent);
        switch (requestCode) {
        case REQUEST_DECODING_OPTIONS:
            if (resultCode == RESULT_OK) {
                updateEncodingOptions();
            }
            break;
        case 2:
            if (resultCode == RESULT_OK) {
                //updateEncodingOptions();
                if(requestCode == 2)
                {
                  Uri selectedImageUri = intent.getData();
                   String  selectedImagePath = getPath(selectedImageUri);
                    System.out.println("Image Path : " + selectedImagePath);
                    File file_Video = new File(selectedImagePath);
                    MediaPlayer mp = new MediaPlayer();
                    try {
                        mp.setDataSource(file_Video.getAbsolutePath());
                        videoDetails.setVideoPath(file_Video.getAbsolutePath());
                        if(mp.getDuration()<=3)
                        {
                        Intent intentGallery = new Intent(VideoCapture_New.this, CameraPlay_New.class);
                        startActivity(intentGallery);
                        }
                        else
                        {
                            AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                                    this);

                            // set title

                            alertDialogBuilder
                            .setTitle("Info");
                            // set dialog message
                            alertDialogBuilder
                            .setMessage("Video can't be larger than 3 mins.")
                            .setCancelable(false)
                            .setPositiveButton("OK",new DialogInterface.OnClickListener() {
                                public void onClick(DialogInterface dialog,int id) {
                                    // if this button is clicked, close
                                    // current activity
                                    dialog.cancel();

                                }
                            });

                            // create alert dialog
                            AlertDialog alertDialog = alertDialogBuilder.create();

                            // show it
                            alertDialog.show();
                        }
                    } catch (IllegalArgumentException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (IllegalStateException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    System.out.println("Video Length:"+mp.getDuration());

                }
                    //img.setImageURI(selectedImageUri);
            }
            break;
        }
    }
     public String getPath(Uri uri) {
            String[] projection = { MediaStore.Video.Media.DATA };
            Cursor cursor = managedQuery(uri, projection, null, null, null);
            int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
            cursor.moveToFirst();
            return cursor.getString(column_index);
        }
    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {

            /*
             * if(collapse==true||collapse_cat==true||collapse_FuelEconomy==true||
             * collapse_LatestNews
             * ==true||collapse_price==true||collapse_RecentlyViwed==true){
             * Intent restartResearchActivity = new
             * Intent(ResearchListNew.this,ResearchListNew.class);
             * restartResearchActivity.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
             * startActivity(restartResearchActivity);
             * 
             * } else { finish(); }
             */
            if (prRecordInProcess == false)
            {
                prCamera.lock();
            }
            else
            {
                stopRecording();
                prCamera.lock();
            }

            Intent intent = new Intent(VideoCapture_New.this,
                    AfterLoginHome.class);
            intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(intent);
            return true;
        } else {

            return super.onKeyDown(keyCode, event);
        }

    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-13T12:09:01.467

```
new Camera().setDisplayOrientation(90); 
```

# javascript - 在 IE 中播放 Windows Media 对象时未触发双击事件

> ID：13407995
> 
> 赞同：0
> 
> 时间：2012-11-15T23:22:37.237
> 
> 标签：javascript, html, internet-explorer, activex, windows-media-player

我正在使用 Windows Media ActiveX 对象播放视频的媒体播放器，我需要知道视频何时全屏显示。我找不到全屏事件，所以我必须找到解决方法。作为解决方法的一部分，我需要能够获取（最好拦截）使媒体播放器全屏显示的双击事件，但是当播放器开始播放时我无法获取该事件，大概是因为玩家需要它才能知道何时进入全屏。

我已经尝试了许多不同的方法来获得该事件，而它正在播放：

```
activeXElement.attachEvent('ondblclick',function(){alert('Double Click')});
activeXElement.attachEvent('dblclick',function(){alert('Double Click')});
activeXElement.attachEvent('ondoubleclick',function(){alert('Double Click')});
activeXElement.attachEvent('doubleclick',function(){alert('Double Click')});
activeXElement.attachEvent('DoubleClick',function(){alert('Double Click')});
activeXElement.attachEvent('onDoubleClick',function(){alert('Double Click')});
activeXElement.attachEvent('OnDoubleClick',function(){alert('Double Click')});
activeXElement.ondblclick=function(){alert('Double Click')};
activeXElement.dblclick=function(){alert('Double Click')};
activeXElement.ondoubleclick=function(){alert('Double Click')};
activeXElement.doubleclick=function(){alert('Double Click')};
activeXElement.DoubleClick=function(){alert('Double Click')};
activeXElement.onDoubleClick=function(){alert('Double Click')};
activeXElement.OnDoubleClick=function(){alert('Double Click')}; 
```

当它还没有开始播放时，以下两个工作：

```
activeXElement.attachEvent('doubleclick',function(){alert('Double Click')});
activeXElement.attachEvent('DoubleClick',function(){alert('Double Click')}); 
```

播放时它们都没有工作。有人对如何在播放 ActiveX 对象时获得双击事件有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:53:16.183

我最终为这个问题创建了一个解决方法。我在这里为可能遇到此问题的其他人发布它。

我监听点击事件，当元素被点击时，像我想要的那样在全屏时隐藏控件。然后，稍后（给时间双击），检查它是否是全屏的，如果不是再次隐藏控件。我不得不暂时显示控件，因为一旦全屏我就无法隐藏或显示控件。

这是我使用的代码：

```
activeXElement.attachEvent('click',
    function(nButton){
        if(nButton!=1)return;// Not  left click

        // I can't set uiMode when full screen.
        // Set it now and set it back later if needed.
        activeXElement.uiMode='full';
        setTimeout(
            function(){
                if(activeXElement.fullScreen){
                    // It went full screen.
                    // Do some stuff...
                }
                else activeXElement.uiMode='none';
            }
        ,750);
    }
); 
```