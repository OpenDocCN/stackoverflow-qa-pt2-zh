# StackOverflow 问答 14310000-14310999

# php - 拒绝直接访问但允许 fopen

> ID：14310006
> 
> 赞同：2
> 
> 时间：2013-01-14T00:44:03.730
> 
> 标签：php, .htaccess, fopen

我正在尝试使用从我的网络主机读取 txt 文件

```
echo file_get_contents("http://domain/text.txt"); 
```

或者

```
$fh =  fopen("http://domain/text.txt", "r");
while (!feof($fh)) {
   $line = fgets($fh);
   echo $line;
} 
```

但我想保护这个文本文件不被直接访问

使用 .htaccess

```
deny from all 
```

但是在拒绝直接访问后我无法再读取文本文件了:(

我也不想使用所有来自 ip

所以我问是否有任何解决方案可以使用 php 读取文本文件并拒绝直接访问该文件

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T00:46:01.810

最安全的方法是将您想要保留的文件放在 Web 根目录之外。这是因为 web 服务器遵循本地文件系统权限，而不是它自己的权限。

# image - UICollectionView 之上的 UIImageView

> ID：14310008
> 
> 赞同：1
> 
> 时间：2013-01-14T00:44:47.490
> 
> 标签：image, uitableview, uiimageview, uiimage, uicollectionview

我怎么能把图像放在我现有的集合视图控制器上。

如此处所示：

[http://i.stack.imgur.com/fyK8t.jpg](http://i.stack.imgur.com/fyK8t.jpg)

我需要它不影响滚动或与 uicollectionview 的交互，但我也需要能够与之交互。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:07:46.923

在界面生成器中，确保 UIScrollView 和您的其他 UIView（包括 UIButtons、UIImageViews）是同一级别的两个不同实体，例如不相互嵌套。

给第二个 UIView 一个 z 顺序，以便它出现在 UIScrollView 上。

# java - SpringMVC项目配置

> ID：14310012
> 
> 赞同：1
> 
> 时间：2013-01-14T00:45:20.330
> 
> 标签：java, spring-mvc, flash

我有一个**Spring MVC**项目，我有一些资源，例如应用程序调用的图像和图片。我在请求资源时收到**404 Not Found 错误。**例如，我有一个 swf 文件，他应该加载一个页面，但它一直在**firebug**中给出 404 消息。

我有这个文件位于**WEB-INF**目录之外的一个名为 swf 的目录中。这是以前工作的，由于某种原因它停止了。有人可以帮助我了解应用程序调用的资源的配置详细信息和位置。我知道**Spring**容器请求的文件可以位于**WEB-INF**目录中，而所有其他文件必须位于外部（我将对此进行更正）。

**文件结构：**

```
-app
 -src
 -test
 -db
 -war
  -images
  -swf
  -WEB-INF
   -classes
   -css
   -js
   -jsp
   -lib
   -photos
   -tld 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:19:35.507

你的文件结构确实有问题。您在 WEB-INF 文件夹下有 JS 和 CSS。这些文件将无法从 Web 访问。静态内容不能放在 WEB-INF 文件夹下。

像这样构造你的文件：-

```
-app
    -src
    -test
    -db
    -war
        - resources
            -images
            -css
            -js
            -swf
    -WEB-INF
        -classes
        -jsp
        -lib 
```

将此行添加到您的`spring-servlet.xml`：-

```
<mvc:resources location="/resources/" mapping="/resources/**" /> 
```

这样，您所有静态内容的基本 URL 将变为`/<context-root>/resources/`，例如：`/myapp/resources/images/test.jpg`。

此外，您的应用程序服务器可能未配置为提供 SWF 文件。因此，如果图像文件工作正常但 SWF 文件不工作，您可能需要将以下 mime 类型添加到您的 web.xml：-

```
<mime-mapping>
    <extension>swf</extension>
    <mime-type>application/x-shockwave-flash</mime-type>
</mime-mapping> 
```

**编辑**

解决这个问题的方法是编写一个小 servlet 来提供 SWF 文件。

*   如果您使用的是 Tomcat，则需要编写一个小 servlet 来提供静态内容...请参阅：[Servlet for serving static content](https://stackoverflow.com/questions/132052/servlet-for-serving-static-content)
*   如果您使用的是 Websphere，WAS 提供了一个内置的 servlet 来做同样的事情……请参阅：[Allowing audio files in Spring MVC 3.0?](https://stackoverflow.com/questions/4786602/allowing-audio-files-in-spring-mvc-3-0)

# xcode - 在视图控制器之间移动而不使用 segue

> ID：14310014
> 
> 赞同：0
> 
> 时间：2013-01-14T00:45:46.197
> 
> 标签：xcode, ipad, ios6

我知道应该很简单，但是如何在不使用 segue 的情况下在 iPad 上的视图控制器之间移动？我有一个主菜单视图控制器，上面有一个按钮，它调用 newViewButton 操作。我想打开名为 MonitorMenu 的视图控制器。

```
- (IBAction)newViewButton:(id)sender {

    [self.navigationController pushViewController:MonitorMenu  animated:NO];

} 
```

它说 MonitorMenu 是一个未知的接口。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:18:35.273

如果您使用的是故事板，则可以执行以下操作：

**1）**通过单击实际视图下方栏中的小黄球，选择要在情节提要上推送的视图控制器（MonitorMenu）。

![在此处输入图像描述](../Images/5022ba00e97f69bd16aec57b8edb2193.png)

**2）**然后在“Identity Inspector”选项卡中为其设置一个“Storyboard ID”。（在你的情况下，我会使用“monitorMenuView”或类似的东西）

![在此处输入图像描述](../Images/44d8be10d997ff38a9e9550f38a81045.png)

**3)在***要从*中“推送”它的视图控制器的 .h 文件中，导入要推送的类的 .h ：

```
#import "MonitorMenu.h" 
```

**4）**然后，在您的 IBAction 中：

```
- (IBAction)newViewButton:(id)sender {

    MonitorMenu *monitorMenuViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"monitorMenuView"];
    [self.navigationController pushViewController:monitorMenuViewController animated:NO];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:00:54.177

这是我所指的关于声明 MonitorMenu 对象的内容：

在当前 ViewController 的 .h 文件中：

```
 MonitorMenu *_menu; 
```

在当前 ViewController 的 .m 文件中：

```
 //declaring your Monitor Menu object for use
           //then pushing that view onto the stack.
           _menu = [[MonitorMenu alloc] initWithNibName:@"MonitorMenu" bundle:nil];
          [self.navigationController pushViewController:_menu NO]; 
```

# c++ - 如何检测由于磁盘已满而导致的未处理异常？

> ID：14310019
> 
> 赞同：1
> 
> 时间：2013-01-14T00:46:10.233
> 
> 标签：c++, unhandled-exception, clog

我的应用程序遇到了磁盘已满错误，不知何故，由于磁盘已满，引发了未处理的异常，导致`set_terminate()`处理程序被调用。

通常，我会在我的日志文件中获得某种堆栈跟踪，这样我就可以看到出了什么问题，但是，在这种情况下，由于磁盘已满，没有记录堆栈跟踪，并且不清楚程序是否由于以下原因而终止磁盘空间不足。

从最后写入磁盘的内容中读取我可以读取的内容，它似乎`std::clog`正在被写入，已设置为进入磁盘（已满的那个）。

我想知道使用`operator<<`to write to`clog`是否会导致抛出异常，如果是这样，可能会抛出什么异常？

此外，我对如何改进我的应用程序的想法很感兴趣，如果这种情况在未来再次发生，我可能会更新我的应用程序，以便更好地跟踪到底出了什么问题，这样我就可以知道磁盘已满并且不是应用程序的其他缺点。

然而，关键问题是检测故障，没有它，如何缓解的想法是没有用的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T00:52:38.990

在 Linux 中，您可以使用文件名 [在一个特殊的目录中？] 来创建您所在位置的踪迹 - 因为文件只使用通常有很多的“i-node 空间”。

另一种选择是创建一个大（ish）文件作为“紧急日志存储” - 如果磁盘已满，则打开您的紧急日志存储，并写入该文件。让它变成几兆字节，在现代磁盘上没有人会注意到，但它为您提供了足够的空间来转储您所在位置的上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T00:53:03.497

我不知道代码本身会发生什么的细节，但我想解决如何处理这种异常的问题。

从本质上讲，这种问题需要更多的日志记录。但是，您必须考虑日志记录机制是否是这里的问题。您需要有一个不依赖于磁盘的替代日志/报告系统。

您可以继续添加冗余层，但在我看来，在异常情况下失败的主数据库，再加上在更多异常情况下失败的备份对于大多数应用程序来说已经足够了。如果数据弹性是最重要的，那么您当然会监控您的资源并在处理应用程序时进行缓解（发出操作员警告或您选择作为后备机制的任何东西 - 例如备份假脱机空间等）。

一般来说，`all ways up`比较的成本`nearly always up`在成本和开发时间上也遵循 80/20 规则。

# python - 动态 django 表单的问题

> ID：14310020
> 
> 赞同：0
> 
> 时间：2013-01-14T00:46:33.450
> 
> 标签：python, django, django-models, django-forms

我正在编写一个程序来管理电子元件的数据库。用户需要能够将组件组织成组。每组都有一组不同的字段（电阻器不同于电容器等），尽管有些是常见的。我还希望用户能够创建新组并为该组指定特定字段。而不是处理真正的动态字段，这就是我想出的：

以下是相关型号：

```
class ComponentGroup(models.Model):
   name = models.CharField(max_length=200)
   code = models.CharField(max_length=3, unique=True)

class GroupField(models.Model):
   name = models.CharField(max_length=200)
   group = models.ForeignKey(ComponentGroup, related_name='fields')

class Part(models.Model):
   group = models.ForeignKey(ComponentGroup)
   fields = models.ManyToManyField(GroupField, through='Parameter')
   # ... some "static" fields

class Parameter(models.Model):
   field = models.ForeignKey(GroupField)
   part = models.ForeignKey(Part)

   value = models.CharField(max_length=200)

class ParameterForm(forms.ModelForm):
   class Meta:
      model = Parameter
      fields = ('value',)

class PartForm(forms.ModelForm):
   class Meta:
      model = Part
      exclude = ('fields', 'group') 
```

所以任何给定的组都有一组`GroupField`s，每个s都有一个名字。A`Parameter`指定一个特定值，该特定值`Part`对应于`GroupField`中的`ComponentGroup`a`Part`是其成员。

我正在尝试为用户创建一种`Part`从给定组创建新的方法。我*认为*解决这个问题的“django 方式”是使用表单集。那正确吗？处理这个问题的“正确”方法是什么？

编辑

这是我为“静态”字段生成表单和为`ComponentGroup`. 我不确定如何解决它们。有什么建议吗？

```
def part_add(request, code):
   thisgroup = get_object_or_404(ComponentGroup, code=code)
   thispart = Part()
   thispart.group = thisgroup
   thispart.save() ### don't want to do this here, but sort of need to to generate ID
                   # creates the problem that if form is not submitted, now have a 
                   # completely blank Part 

   for field in thisgroup.fields.all():
      p = Parameter()
      p.field = field
      p.part = thispart
      p.save() # would like to save the parameters at the same time as the Part is saved,
               # when the form is submitted but if they're not saved, they will not show 
               # up on the formset

   ParametersInlineFormset = inlineformset_factory(CEIPart, Parameter, form=ParameterForm, extra=0, can_delete=False)

   if request.POST:
      form = PartForm(request.POST, group=thisgroup, instance=thispart)
      formset = ParametersInlineFormset(request.POST, request.FILES, instance=thispart)
      if form.is_valid():
         form.save()
      if formset.is_valid():
         formset.save()

      return HttpResponseRedirect(reverse('ceiparts.views.part_detail', args = (thispart.CEIPN,)))
   else:
      form = PartForm(group=thisgroup, instance=thispart)
      formset = ParametersInlineFormset(instance=thispart)

   return render(request, 'ceiparts/ceiparts_add.html',
 { 'form' : form,
    'formset' : formset,
    'ceipart' : thispart,
    'componentgroup' : thisgroup }
 ) 
```

# binding - 淘汰赛js无法绑定级联下拉菜单

> ID：14310023
> 
> 赞同：1
> 
> 时间：2013-01-14T00:46:48.490
> 
> 标签：binding, knockout.js, html-select, cascading

我是淘汰赛的新手，并试图根据第一个选择来创建如何填充第二个下拉列表。我的代码一直基于rpn 在此[对话中提供的第一个](https://groups.google.com/forum/?fromgroups=#!searchin/knockoutjs/complex%2420viewmodel/knockoutjs/PkCErq6eWT0/lJXIPdiH4sEJ)[小提琴](http://jsfiddle.net/rniemeyer/35MUY/)。

这是我的标记

```
<div data-bind="visible: selectedDate">
  <span data-bind="text: selectedDate() ? selectedDate().logDate : 'unknown'"></span>
</div>
<br />

<div data-bind="visible: selectedDate">
    <select data-bind="options: filenames,
                       optionsText: name
                       value: selectedFiles"
            multiple="true"></select>
</div> 
```

和 javascript

```
var modelData = {Id:1,
                 DownloadFiles: [
                  {LogDate:"01/12/2012",
                   Filenames: [
                     "File.000", "File.001"]},
                  {LogDate:"02/12/2012",
                   Filenames: [
                     "File.000", "File.001", "File.002"]},
                  {LogDate:"03/12/2012",
                   Filenames: [
                     "File.000", "File.001", "File.002", "File.003"]},
                  {LogDate:"04/12/2012",
                   Filenames: [
                     "File.000", "File.001", "File.002", "File.003"]}
                 ]};

function AvailableDate(date, filenames) {
    var self = this;
    self.logDate = ko.observable(date);
    this.filenames = ko.observableArray(ko.utils.arrayMap(filenames || [], function(filename) {
        return new Filename(filename.name);
    }));
}

function Filename(name) {
    this.name = ko.observable(name);    
}
var viewModel = {
    downloadFiles : ko.observableArray(),
    selectedDate : ko.observable(), // Nothing selected by default
    selectedFiles : ko.observableArray() // Nothing selected by default
};

ko.utils.arrayForEach(modelData.DownloadFiles, function(availableDate) {
   viewModel.downloadFiles.push(new AvailableDate(availableDate.LogDate, availableDate.filenames));
});

ko.applyBindings(viewModel); 
```

我只是看不到绑定到第二个下拉列表的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T05:24:06.167

非常感谢 nemesv 提供的解决方案。

这是标记：

```
<select data-bind="options: downloadFiles,
                   optionsText: 'logDate', 
                   value: selectedDate, 
                   optionsCaption: 'Select Date'"></select>

<div data-bind="visible: selectedDate">
  <span data-bind="text: selectedDate() ? selectedDate().logDate : 'unknown'">
  </span>
</div>
<br />

<div data-bind="visible: selectedDate">
  <!-- ko with: selectedDate -->
    <select data-bind="options: filenames,
                       optionsText: 'name',
                       selectedOptions: $root.selectedFiles"
            multiple="true"></select>
  <!-- /ko -->
  <span data-bind="text: ko.toJSON(selectedFiles())"></span>
</div> 
```

和 javascript

```
var modelData = {Id:1,
             DownloadFiles: [
              {LogDate:"01/12/2012",
               Filenames: [
                 "File.000", "File.001"]},
              {LogDate:"02/12/2012",
               Filenames: [
                 "File.000", "File.001", "File.002"]},
              {LogDate:"03/12/2012",
               Filenames: [
                 "File.000", "File.001", "File.002", "File.003"]},
              {LogDate:"04/12/2012",
               Filenames: [
                 "File.000", "File.001", "File.002", "File.003"]}
             ]};

function AvailableDate(date, filenames) {
    var self = this;
    self.logDate = ko.observable(date);
    this.filenames = ko.observableArray(ko.utils.arrayMap(filenames || [], function(filename) {
        return new Filename(filename);
    }));
}

function Filename(name) {
    this.name = ko.observable(name);    
}
var viewModel = {
    downloadFiles : ko.observableArray(),
    selectedDate : ko.observable(), // Nothing selected by default
    selectedFiles : ko.observableArray() // Nothing selected by default
};

ko.utils.arrayForEach(modelData.DownloadFiles, function(availableDate) {
   viewModel.downloadFiles.push(new AvailableDate(availableDate.LogDate, availableDate.Filenames));
});

ko.applyBindings(viewModel); 
```

并感谢您的及时 delixfe。我理解为什么只将解决方案留在 jsfiddle 上是一个坏主意。

# c - 如何计算while循环执行的次数

> ID：14310031
> 
> 赞同：-6
> 
> 时间：2013-01-14T00:47:22.890
> 
> 标签：c, while-loop

在 C 中，如何计算`while`循环执行的次数？

在 Python 中，我只需在开头创建一个空列表，并在`while`每次执行循环时附加循环中的值。`while`然后我会找到该列表的长度以了解该循环执行了多少次。C中有类似的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-14T00:48:01.057

将变量初始化为 0，并在每次迭代时将其递增？

```
int num = 0;

while (something) {
    num++;

    ...
}

printf("number of iterations: %d\n", num); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T00:48:34.807

启动`i = 0`，然后`i++`在每个循环通过...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T01:05:30.093

（对不起，这是 C++ 方式，不是 C...）如果你真的想去填充列表，可以这样做：

```
#include <list>
#include <iostream>

using namespace std;

...

   list<int> my_list;
   int num = 0; 
   while( ... ) {
      ...
      ++num;
      my_list.push_back(num);
   }
   cout << "List size: " << my_list.size() << endl; 
```

如果要打印列表值：

```
#include <list>
#include <iostream>
#include <algorithm>

using namespace std;

...

   list<int> my_list;
   int num = 0; 
   while( ... ) {
      ...
      ++num;
      my_list.push_back(num);
   }
   cout << "List contens: " << endl;
   // this line actually copies the list contents to the standard output
   copy( my_list.begin(), my_list.end(), iostream_iterator<int>(cout, ",") ); 
```

# delphi - SetCursorPos 故障？

> ID：14310040
> 
> 赞同：3
> 
> 时间：2013-01-14T00:48:49.697
> 
> 标签：delphi, winapi, cursor, cursor-position

我想在delphi中编写一个程序来模拟具有特定速度的移动鼠标指针（类似于AutoIT MouseMove函数）。要么我的代码错误，要么 SetCursorPos 在被调用太多次后出现故障。这是我拥有的功能：

```
procedure MoveMouse ( X, Y, Speed : Integer);
var
  P     : TPoint;
  NewX  : Integer;
  NewY  : Integer;
begin
  if X < 0 then exit;
  if Y < 0 then exit;
  if X > Screen.Height then exit;
  if Y > Screen.Width then Exit;
  repeat
    GetCursorPos(P);
    NewX := P.X;
    NewY := P.Y;
    if P.X <> X then begin
      if P.X > X then begin
        NewX := P.X - 1;
      end else begin
        NewX := P.X + 1;
      end;
    end;
    if P.Y <> Y then begin
      if P.Y > Y then begin
        NewY := P.Y - 1;
      end else begin
        NewY := P.Y + 1;
      end;
    end;
    sleep (Speed);
    SetCursorPos(NewX, NewY);
  until (P.X = X) and (P.Y = Y);
end; 
```

我这样使用它：

```
procedure TForm1.btn1Click(Sender: TObject);
var
  X : Integer;
  Y : Integer;
begin
  for X := 0 to Screen.Width do begin
    for Y := 0 to Screen.Height do begin
      MouseClick (X, Y, 1);
    end;
  end;
end; 
```

由于某种原因，鼠标指针卡在某个 X 点，然后跳回 0,0，但这是为什么呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T01:20:14.287

你的代码被卡住了，因为在重复循环中，条件

```
until (P.X = X) and (P.Y = Y); 
```

当您传递值 X=0 和 Y=Screen.Height 时永远不会满足，因此您必须修改循环以仅传递有效的屏幕坐标值

```
 for X := 0 to Screen.Width-1 do
    for Y := 0 to Screen.Height-1 do
      MoveMouse (X, Y, 1); 
```

您还可以改进检查[`GetCursorPos`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648390%28v=vs.85%29.aspx)and[`SetCursorPos`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648394%28v=vs.85%29.aspx)函数结果的方法。

```
procedure MoveMouse ( X, Y, Speed : Word);
var
  P     : TPoint;
  NewX  : Integer;
  NewY  : Integer;
begin
  if X > Screen.Width-1  then Exit;
  if Y > Screen.Height-1 then Exit;
  repeat
    if not GetCursorPos(P) then RaiseLastOSError;
    NewX := P.X;
    NewY := P.Y;
    if P.X <> X then
    begin
      if P.X > X then
        NewX := P.X - 1
      else
        NewX := P.X + 1;
    end;

    if P.Y <> Y then
    begin
      if P.Y > Y then
        NewY := P.Y - 1
      else
        NewY := P.Y + 1
    end;
    Sleep (Speed);
    if not SetCursorPos(NewX, NewY) then RaiseLastOSError;
  until (P.X = X) and (P.Y = Y);
end; 
```

# php - 使用jquery从php文件中检索值

> ID：14310045
> 
> 赞同：0
> 
> 时间：2013-01-14T00:49:30.967
> 
> 标签：php, jquery, html

我只是在玩弄一些 php 和 jquery。我的测试站点让用户在表单中输入数字，然后当他们单击提交时，信息将发送到该 php 文件，进行一些计算，然后以`<div>`我指定的形式打印结果，而无需重新加载页面。我只想知道有没有办法检索 php 文件在 jquery 变量中返回的值？

代码：

```
$(document).ready(function(){
    $("#results").hide();
    $("#myform").validate({
        debug: false,
        rules: {

        },
        messages: {

        },
        submitHandler: function(form) {
            // do other stuff for a valid form
            $.post('process.php', $("#myform").serialize(), function(data) {
                $('#results').show();
                $('#results').html(data) ;

            });

        }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T00:51:13.673

您的 PHP 值已被重新调整为`data`.

要在处理程序之外使用它，请将其分配给全局变量。

```
var phpData = '';

$(document).ready(function(){
    $("#results").hide();
    $("#myform").validate({
        debug: false,
        rules: {

        },
        messages: {

        },
        submitHandler: function(form) {
            // do other stuff for a valid form
            $.post('process.php', $("#myform").serialize(), function(data) {
                $('#results').html(data).show(); // you can chain for efficiency
                phpData = data;
            });

        }
    });
}); 
```

如需更多功能，您可以将 PHP 中的数据作为 JSON 对象发送。

```
$data = array('success' => true,
              'message' => 'Your message',
              'otherNum' => 25);

echo json_encode($data); 
```

然后在您的 Javascript 中，您可以按如下方式访问它。

```
data.success = true
data.message = 'Your message'
data.otherNum = 25 
```

# python - 来自日志文件的实时进度

> ID：14310047
> 
> 赞同：1
> 
> 时间：2013-01-14T00:49:46.610
> 
> 标签：python

我正在向 iTunes 传送视频项目。当我运行命令时，我得到类似于以下内容的输出：

```
$ command
[2013-01-09 11:02:14 PST] <main> DBG-X:   1% 
[2013-01-09 11:02:15 PST] <main> DBG-X:   2% 
[2013-01-09 11:02:16 PST] <main> DBG-X:   3%
...etc... 
```

我将如何更新我的应用程序中的数据库字段以显示此交付的进度？我想我会使用类似 `stdout=subprocess.PIPE, stderr=subprocess.PIPE`.

但是我怎么能实时得到这个来更新数据库呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:14:11.927

我会这样做（可能还有其他更好的方法）：

1.  每秒钟检查一次文件`n`并记住该文件中的最后一行。
2.  如果最后一行发生了变化，则意味着自上次检查以来已经取得了一些进展。
3.  一旦您检测到这样的进度，您应该能够触发写入数据库的函数。

请注意，这**几乎**是实时的，因为您仅每秒钟检查一次`n`文件

**代码**：

```
progress = 0
lastLine = ''
n = 5 # seconds
while progress < 100:
    with open('path/to/logfile') as logfile:
        for newLine in logfile:
            pass
        if newLine.strip() != lastLine:
            lastLine = newLine.strip()
            writeToDatabase(lastLine)
    time.sleep(n) 
```

希望这可以帮助

# commonsware-cwac - cwac locpoll 演示崩溃

> ID：14310048
> 
> 赞同：0
> 
> 时间：2013-01-14T00:49:50.593
> 
> 标签：commonsware-cwac

对不起，我的英语不好。

我正在尝试使用您的演示 cwac locpoll，但我的总是崩溃，然后很难看到您的 jar 工作。

告诉我这个：01-14 01:47:19.880: E/AndroidRuntime(399): FATAL EXCEPTION: main 01-14 01:47:19.880: E/AndroidRuntime(399): java.lang.NoClassDefFoundError: com.commonsware。 cwac.locpoll.LocationPoller 01-14 01:47:19.880: E/AndroidRuntime(399): at com.commonsware.cwac.locpoll.demo.LocationPollerDemo.onCreate(LocationPollerDemo.java:42) 01-14 01:47:19.880 : E/AndroidRuntime(399): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 01-14 01:47:19.880: E/AndroidRuntime(399): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread. java:2627) 01-14 01:47:19.880: E/AndroidRuntime(399): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679) 01-14 01:47:19.880: E/AndroidRuntime(399) : 在 android.app.ActivityThread.access$2300(ActivityThread.java:125) 01-14 01:47:19.880: E/AndroidRuntime(399):在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033) 01-14 01:47:19.880: E/AndroidRuntime(399): 在 android.os.Handler.dispatchMessage(Handler.java:99) 01- 14 01:47:19.880: E/AndroidRuntime(399): 在 android.os.Looper.loop(Looper.java:123) 01-14 01:47:19.880: E/AndroidRuntime(399): 在 android.app。 ActivityThread.main(ActivityThread.java:4627) 01-14 01:47:19.880: E/AndroidRuntime(399): at java.lang.reflect.Method.invokeNative(Native Method) 01-14 01:47:19.880: E /AndroidRuntime(399): 在 java.lang.reflect.Method.invoke(Method.java:521) 01-14 01:47:19.880: E/AndroidRuntime(399): 在 com.android.internal.os.ZygoteInit$ MethodAndArgsCaller.run(ZygoteInit.java:868) 01-14 01:47:19.880: E/AndroidRuntime(399): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 01-14 01: 47：19.880：E/AndroidRuntime(399)：在 dalvik.system。NativeStart.main（本机方法）

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T11:43:09.880

即兴发挥，感觉就像您的项目配置错误。该`demo/`项目需要：

*   将父项目作为库项目引用，或
*   在其目录中有`LocationPoller`JAR的副本`libs/`

您的错误感觉就像您没有做这些，而是​​手动弄乱了构建路径或将`LocationPoller`类放入其中的东西，并且通常这些方法仅在编译时起作用。

# python - 当我创建一个 dict 对象时，对象没有正确形成

> ID：14310053
> 
> 赞同：1
> 
> 时间：2013-01-14T00:50:12.783
> 
> 标签：python, list, dictionary, python-2.7

我有一个 Python 函数的一部分，如下所示：

```
for item in passedList:
    tempDict = {}
    tempDict ["first"] = item[0]
    tempDict ["second"] = item[1]
    tempDict ["third"] = item[2] 
```

我期待回来的是：

```
{'first': 'item1', 'second': 'item2', 'third': 'item3'} 
```

但是，我得到：

```
{'second': 'item2', 'first': 'item1', 'third': 'item3'} 
```

这可能是一个非常简单的疏忽，但对为什么会发生这种情况有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T00:52:38.237

这是因为[dict](http://docs.python.org/library/stdtypes.html#dict)在 Python 中的实现是一个 hashmap 或 hash table，它不会按顺序存储元素。

您可以使用[OrderedDict](http://docs.python.org/library/collections.html#collections.OrderedDict)来解决这个问题。

# node.js - 如何在 Jade 模板中包含服务器端脚本？

> ID：14310056
> 
> 赞同：15
> 
> 时间：2013-01-14T00:50:28.010
> 
> 标签：node.js, express, pug

我刚刚安装了[moment.js](http://momentjs.com/)；现在我想访问`moment`我的 Jade 模板。例子：

```
.main-content
    .container
        .access-details.clearfix
            .left
                div Logged in: <b>#{user.name}</b>
                div Access Lvl: #{user.accessLevel}
            .right
                div= moment().format("dddd, MMMM Do YYYY, h:mm:ss a") 
```

需要明确的是，我希望在服务器端格式化日期，然后作为呈现的字符串发送到客户端。

那么如何在 Jade 模板中提供 JavaScript 库呢？

* * *

我可能应该注意到我将它与 Express 一起使用：

```
var server = express.createServer();
server.configure(function () {
    server.set('view engine', 'jade'); 
```

是否有一些我必须以某种方式传递的选项来告诉它要包含哪些库？

* * *

我突然想到这与传入局部变量完全没有区别。例如，

```
server.get('/', function (req, res) {
    res.render('index', {
        locals: {
            moment: require('moment')
        }
    });
}); 
```

但我不想将它传递给每个视图；如果我忘记了它，我的应用程序会在主布局中使用时中断。那么如何确保它始终可用呢？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-05-13T10:29:28.307

Helpers are removed from Express 3 or 4.

Kindly use [`app.locals`](http://expressjs.com/4x/api.html)

```
app.locals.moment = require('moment'); 
```

The `app.locals` object is a JavaScript Object. The properties added to it will be exposed as local variables within the application.

So you can use `app.locals` in any view files, `Jade` or `EJS`;

```
moment().format('YYYY-MM-DD h:mm:ss'); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-14T01:18:02.197

`dynamicHelpers`尽管有关文档似乎已从 Express 文档中神秘消失，但[这个答案](https://stackoverflow.com/a/7244152/65387)让我指出了正确的方向。

另外，我不需要*动态*助手，只需要静态助手（无法访问请求/响应）。所以我在黑暗中刺了一下它的名字：

```
server.helpers({
    moment: require('moment')
}); 
```

奇迹般有效！`moment`现在在我的所有视图中都可用。

# firebase - 尝试使用 Firebase 创建实时饼图时使用哪个库？

> ID：14310060
> 
> 赞同：1
> 
> 时间：2013-01-14T00:51:38.150
> 
> 标签：firebase

是否可以使用 Firebase 创建更新饼图？有点像[http://bl.ocks.org/d/1346410/](http://bl.ocks.org/d/1346410/)？我可以使用什么库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T03:40:11.713

我对[Highcharts 和 Highstock](http://www.highcharts.com)很幸运。这是一个[实时更新图表](http://www.highcharts.com/demo/dynamic-update)的例子。

这个想法很简单：

*   监控 Firebase 的变化：`ref.on('value|child_added', ... )`
*   调用[Series](http://api.highcharts.com/highcharts#Series) .setData() 来修改数据（可能是你想要的馅饼）
*   或调用 Series.addPoint() 向数据添加新点

# c++ - 具有向量成员的全局结构

> ID：14310063
> 
> 赞同：5
> 
> 时间：2013-01-14T00:52:20.787
> 
> 标签：c++, vector, struct

为什么这个简单的代码块无法编译

```
//using namespace std;
struct test {
    std::vector<int> vec;
};
test mytest;

void foo {
    mytest.vec.push_back(3);
}

int main(int argc, char** argv) {
   cout << "Vector Element" << mytest.vec[0] << endl;
   return 0;
} 
```

我收到以下错误：

```
vectorScope.cpp:6:5: error: ‘vector’ in namespace ‘std’ does not name a type

vectorScope.cpp:11:6: error: variable or field ‘foo’ declared void

vectorScope.cpp:11:6: warning: extended initializer lists only available with -std=c++0x or -std=gnu++0x [enabled by default]

vectorScope.cpp:12:12: error: ‘struct test’ has no member named ‘vec’

vectorScope.cpp:12:28: error: expected ‘}’ before ‘;’ token

vectorScope.cpp:13:1: error: expected declaration before ‘}’ token 
```

谢谢，

穆斯塔法

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T00:53:00.377

您需要包含矢量头文件

```
#include <vector>
#include <iostream>

struct test {
    std::vector<int> vec;
};
test mytest;

void foo() {
    mytest.vec.push_back(3);
}

int main(int argc, char** argv) 
{
   foo();  
   if (!mytest.vec.empty())  // it's always good to test container is empty or not
   {
     std::cout << "Vector Element" << mytest.vec[0] << std::endl;
   }
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-14T01:06:31.370

如果您的代码示例完整，则您没有包含矢量标头或 iostream 标头。此外，您的 foo 函数在没有 () 参数的情况下被错误地声明：

```
#include <vector>
#include <iostream>

using namespace std;
struct test {
    std::vector<int> vec;
};
test mytest;

void foo()  {
    mytest.vec.push_back(3);
}

int main(int argc, char** argv) {
   cout << "Vector Element" << mytest.vec[0] << endl;
   return 0;
} 
```

此外，您在索引 0 处下标一个空向量，这是未定义的行为。你可能想在这样做之前先调用 foo() ？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-14T00:53:36.260

您缺少`<vector>`标题。

```
#include <vector> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T00:53:16.320

请记住包含适当的文件：

```
#include <vector> 
```

# linux - 使用 awk 或 sed 打印第一列和电子邮件

> ID：14310070
> 
> 赞同：0
> 
> 时间：2013-01-14T00:52:55.020
> 
> 标签：linux, bash, awk, spam, mail-server

在以下情况下如何使用 AWK？

示例输入：

```
17  mary@mysite.co.uk
9   Limited <office@domain.com>
8  "Fishing Forum" <dra.78@gmail.com> 
```

期望的输出：

```
17  mary@mysite.co.uk
9   office@domain.com
8   dra.78@gmail.com 
```

我想用每行的电子邮件地址打印 $1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T10:15:52.610

为了处理所有可能的电子邮件选项（请参阅三重注释），您需要将电子邮件与正则表达式匹配：

```
gawk --re-interval '{match($0,/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z]{2,4}/);print $1 " " substr($0,RSTART,RLENGTH)}' 
```

它取自这里的正则表达式：[http](http://www.regular-expressions.info/email.html) ://www.regular-expressions.info/email.html 。您应该对其进行测试以验证它是否涵盖所有合法电子邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T02:30:39.640

如果你的数据真的像你展示的那样简单，你可以使用 awk`sub()`函数来解决你不想要的东西，即

```
 awk '{
      # inside the implied awk process-all-lines-of-input-loop
      email=$0
      if (email ~ /<\.*>/) {
        sub(/^.*</,"", email)
        sub(/>.*$/,"", email)
      } 
      else { email=$2 }
      printf("%s\t%s\n", $1, email)
      }' mailFile > newMailFile

cat newMailFile
17      17  mary@mysite.co.uk
9       office@domain.com
8       dra.78@gmail.com 
```

请注意，我们已将完整的行 ( `$0`) 复制到变量`email`中，然后删除了从左侧开始的所有字符，直到第一个字符，然后删除了从结束字符开始的变量`<`末尾的任何内容。请注意，对于极端情况，电子邮件地址的解析可能相当复杂，因此这种技术可能会遗漏某些情况，但鉴于它的简单性，它应该已经足够好了。`email``>`

此外，如果您不习惯 awk 和 shell 编程，请注意，您不能使用相同的输出文件名覆盖输入文件“不要尝试类似`awk '....' file > file`. 它基本上会清除 `file`.

printf 是一种打印数据的奇特方式，`\t`它在两个字段之间为您提供了一个制表符字符。你也可以更简单地使用`print $1 "\t" email`.

IHTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T03:41:32.477

```
$ cat stack 
17  mary@mysite.co.uk
9   Limited <office@domain.com>
8  "Fishing Forum" <dra.78@gmail.com>

$ cat stack | awk '{ print $1" "$NF }' | sed 's/<//g; s/>//g'
17 mary@mysite.co.uk
9 office@domain.com
8 dra.78@gmail.com 
```

如果您想要`tab`输出的第一列之间，请使用如下：

```
$ cat stack | awk '{ print $1"\t"$NF }' | sed 's/<//g; s/>//g'
17  mary@mysite.co.uk
9   office@domain.com
8   dra.78@gmail.com 
```

如果您只需要电子邮件地址：

```
$ cat stack | awk '{ print $NF }' | sed 's/<//g; s/>//g'
mary@mysite.co.uk
office@domain.com
dra.78@gmail.com 
```

**仅供参考：** `NF`为您提供一行中的字段总数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T11:41:26.970

您可以为此使用“sed”

```
$ ./test.sh | sed -r -e 's/<//g' -e 's/>//g' -e 's/^([0-9]+).* (.+)$/\1 \2/'
17 mary@mysite.co.uk
9 office@domain.com
8 dra.78@gmail.com 
```

# mysql - SQL在表中查找位置

> ID：14310080
> 
> 赞同：6
> 
> 时间：2013-01-14T00:53:52.473
> 
> 标签：mysql, sql

我在 mySql 中有一个表，其中包含用户 ID 和分数。

我想做的是按分数组织表格（简单），然后找到某个用户 ID 在表格中的位置。

到目前为止，我会：

```
SELECT * FROM table_score
ORDER BY Score DESC 
```

我如何找到在哪里`userID = '1234'`（即第 10 条，共 12 条）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T00:57:20.967

以下查询将为您提供一个新列`UserRank`，它指定用户等级：

```
SELECT 
  UserID, 
  Score, 
  (@rownum := @rownum + 1) UserRank 
FROM table_score, (SELECT @rownum := 0) t 
ORDER BY Score DESC; 
```

[**SQL 小提琴演示**](http://sqlfiddle.com/#!2/bc9b5/5)

这会给你类似的东西：

```
| USERID | SCORE | USERRANK |
-----------------------------
|      4 |   100 |        1 |
|     10 |    70 |        2 |
|      2 |    55 |        3 |
|   1234 |    50 |        4 |
|      1 |    36 |        5 |
|     20 |    33 |        6 |
|      8 |    25 |        7 | 
```

然后，您可以将此查询放在子查询中并使用 a 进行过滤`userId`以获取该用户排名。就像是：

```
SELECT
  t.UserRank
FROM
(
   SELECT *, (@rownum := @rownum + 1) UserRank 
   FROM table_score, (SELECT @rownum := 0) t 
   ORDER BY Score DESC
) t
WHERE userID = '1234'; 
```

[**SQL 小提琴演示**](http://sqlfiddle.com/#!2/bc9b5/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T01:25:12.773

对于给定的用户 ID，您可以通过一个简单的查询来做到这一点：

```
select sum(case when ts.score >= thescore.score then 1 else 0 end) as NumAbove,
       count(*) as Total
from table_score ts cross join
     (select ts.score from table_score ts where userId = '1234') thescore 
```

如果你有关于 score 和 userid 的索引，这将非常有效。

# jquery - 如何以可配置的速度自动滚动 div？

> ID：14310081
> 
> 赞同：0
> 
> 时间：2013-01-14T00:53:53.800
> 
> 标签：jquery, html

我正在构建一个需要用户配置滚动速度的滚动应用程序。

这是我当前的代码：

```
function scroll() {
        var overlay = document.getElementById('overlay');
        overlay.scrollTop = overlay.scrollTop + 2;
    }

    function togglescrolling() {
        if (goscrolling == false) {
            window.clearInterval(scrollinterval);
            scrollinterval = window.setInterval(scroll, 0);
            goscrolling = true;
        } else {
            goscrolling = false;
            window.clearInterval(scrollinterval);
        }
    } 
```

此代码有效，它按计划自动滚动到页面底部，但滚动速度非常快，我想配置这个速度。

我过去使用过 jQuery Animate，但不确定它是否真的有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:06:52.853

使用 jQuery 动画页面滚动：

```
$('html,body').animate({scrollTop: /* numeric pixel value here*/}, duration); 
```

可以通过获取该元素来获取滚动到特定元素所需的距离`offset().top`

```
var myDivTop= $('#myDiv').offset().top;
$('html,body').animate({scrollTop:myDivTop}, duration); 
```

# css - CSS 菜单问题：当父菜单项处于活动状态（当前）页面时，子菜单显示为活动状态

> ID：14310083
> 
> 赞同：1
> 
> 时间：2013-01-14T00:54:17.840
> 
> 标签：css, drop-down-menu, submenu

我很困惑！这是我正在开发的网站：[癌症支持网站](http://www.webau.net/CSFF/)

我似乎有两个问题......我花了几个小时试图找出解决方案......所以我真的希望有人能提供帮助。

**问题 1**：如果它是正在显示的当前页面，我使用 ID=navactive 来保持父菜单项处于活动状态。这样可行。但是，按照我编写 CSS 的方式，当子菜单项首次出现在 ID=navactive 父级的鼠标悬停时，它会导致子菜单项显示为活动状态，从而引入了错误。相反，子菜单项最初应该显示为非活动状态，直到它们实际被鼠标悬停。在网站上，您可以看到“主页”页面是父菜单上的活动页面。如果您将鼠标悬停在它上面，则会出现两个子子菜单......但它们显示为活动的。它们应该显示为非活动状态 - 与将鼠标悬停在“我们的工作”父菜单项上时子菜单的显示方式相同。

**问题 2**：我的孙子菜单项都没有出现。在“家”和“我们的工作”父菜单项下，我有以下配置：

```
Top level menu (parent)
    Submenu 1 (child 1)
        Submenu 2 (grandchild 1)
    Submenu 3 (child 2) 
```

相反，它出现在这样的页面上，孙子 1 变为子 2，并且没有孙子可见（并且原始子 2 [子菜单 3] 丢失）：

```
Top level menu (parent)
    Submenu 1 (child 1)
    Submenu 2 (child 2) 
```

任何建议将不胜感激！！！谢谢！

为了您的方便..这是我导航菜单部分的css代码：

```
#navcontainer 
{
    width: 711px;
    height: 25px;
    text-align: center;
    margin: 0px auto; /*Center container on page*/
    clear: both;
    background-color: #129F9F;
    border: 3px solid #FFFFFF;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    -o-border-radius: 5px;
    -ms-border-radius: 5px;
    border-radius: 5px; 

    /* IE10 Consumer Preview */ 
    background-image: -ms-linear-gradient(top, #16ACAC 0%, #0D6F6F 100%);

    /* Mozilla Firefox */ 
    background-image: -moz-linear-gradient(top, #16ACAC 0%, #0D6F6F 100%);

    /* Opera */ 
    background-image: -o-linear-gradient(top, #16ACAC 0%, #0D6F6F 100%);

    /* Webkit (Safari/Chrome 10) */ 
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #16ACAC), color-stop(1, #0D6F6F));

    /* Webkit (Chrome 11+) */ 
    background-image: -webkit-linear-gradient(top, #16ACAC 0%, #0D6F6F 100%);

    /* W3C Markup, IE10 Release Preview */ 
    background-image: linear-gradient(to bottom, #16ACAC 0%, #0D6F6F 100%); 
}
.main_menu
{
    height: 24px;
    line-height: 24px;
    font-size: 12px;
    position: relative;
}
.main_menu ul
{
    padding: 0px 0px 0px 35px;  /* padding on left to get nav menu to center.. since it has a float left to make it display properly*/
    list-style: none;
}
.main_menu ul li
{
    padding: 0;
    margin: 0;
    border-right: 2px solid #129F9F;
    float: left;
}
.main_menu ul li.navcontact  /* to stop right border at end of nav line */
{
    padding: 0;
    margin: 0;
    border-right: none;
    float: left;
}
.main_menu ul li a
{
    color: #FFF;
    display: block;
    text-decoration: none;
    padding: 0 15px;
}
.main_menu ul > li:hover > a, #navactive a:link, #navactive a:visited, #navactive > ul > li > a:hover 
{
    text-decoration: none;
    color: #EAA339;
    /* IE10 Consumer Preview */ 
    background-image: -ms-linear-gradient(top, #0D6F6F 0%, #16ACAC 100%);

    /* Mozilla Firefox */ 
    background-image: -moz-linear-gradient(top, #0D6F6F 0%, #16ACAC 100%);

    /* Opera */ 
    background-image: -o-linear-gradient(top, #0D6F6F 0%, #16ACAC 100%);

    /* Webkit (Safari/Chrome 10) */ 
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #0D6F6F), color-stop(1, #16ACAC));

    /* Webkit (Chrome 11+) */ 
    background-image: -webkit-linear-gradient(top, #0D6F6F 0%, #16ACAC 100%);

    /* W3C Markup, IE10 Release Preview */ 
    background-image: linear-gradient(to bottom, #0D6F6F 0%, #16ACAC 100%); 
}
.main_menu ul li ul
{
    display: none;
    width: auto;
    position: absolute;
    padding: 0px;
    margin: 0px;
}
.main_menu ul li:hover ul
{
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
}
.main_menu ul li:hover li
{
    float: none;
    list-style: none;
    margin: 0px;
}
.main_menu ul li:hover li
{
    font-size: 12px;
    height: 24px;
    background: #54C4C4;
    /* border-top: 1px solid #129F9F; */ 
    border: 1px solid #FFFFFF;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    -o-border-radius: 5px;
    -ms-border-radius: 5px;
    border-radius: 5px; 
}
.main_menu ul li:hover li a
{
    font-size: 11px;
    color: #fff;
    padding: 0px;
    display: block;
    width: 150px;
}
.main_menu ul li li a:hover
{
    font-size: 11px;
    height: 24px;
    color:#EAA339;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    -o-border-radius: 5px;
    -ms-border-radius: 5px;
    border-radius: 5px; 
} 
```

这是 HTML 代码：

```
 <div id="navcontainer">
  <div class="main_menu">  
      <ul>
        <li id="navactive"><a href="index.asp" title="Cancer Support for Families Foundation is a community funded, community focused cancer charity.">Home</a>
          <ul>
            <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 1</a>
              <ul>
                <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 2</a></li>
              </ul>
            </li>
            <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 3</a></li>
          </ul>
        </li>
        <li><a href="what_is_csff.asp" title="Supporting families in financial need who are living with cancer.">What is CSFF</a>
          <ul>
            <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 4</a></li>
          </ul>
        </li>
        <li><a href="make_a_donation.asp" title="CSFF supporters can fund the charitable support programs, community experiences and fundraising events.">Make a Donation</a></li>
        <li><a href="our_work.asp" title="Individuals and families battling cancer need more financial support. CSFF can help.">Our Work</a>
          <ul>
            <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 5</a>
              <ul>
                <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 6</a></li>
              </ul>
            </li>
            <li><a href="CSFF_presentation.pdf" title="Presentation about CSS in PDF format">submenu 7</a></li>
          </ul>
        </li>
        <li><a href="our_events.asp" title="Local communities come together in a relaxed family friendly environment to support those living with cancer.">Events Outline</a></li>
        <li class="navcontact"><a href="contact_csff.asp" title="Contact CSFF to help those in need.">Contact Us</a></li>
      </ul>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:29:52.860

您遇到此问题的原因是您的 CSS 和您构建 HTML 代码的方式。这是你的问题 -

```
.main_menu ul > li:hover > a, #navactive a:link, #navactive a:visited, #navactive > ul > li > a:hover 
{
 STYLES
} 
```

只需将上面 CSS 代码的“#navactive a:link”部分更改为处理活动链接的单独类。目前，“navactive” div 中的任何链接都将继承此类中给出的样式，这就是子菜单文本显示为黄色而不是白色的原因。所以就像我说的将上面的 CSS 代码更改为一个单独的类，例如 - “#navactive .current”

然后将您的 HTML 代码更改为如下所示：

```
<div id="navcontainer">
 <div class="main_menu">  
  <ul>
    <li id="navactive"><a class="current" href="index.asp" title="Cancer Support for
Families Foundation is a community funded, community focused cancer charity.">Home</a> 
```

这应该够了吧！显然我无法对其进行测试，但是如果您有任何问题，请告诉我。也只是一个提示 - 在遇到此类问题时，使用 Chrome 的“检查元素”功能非常有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:34:54.643

css中的问题1：

```
.main_menu ul > li:hover > a, #navactive a:link, #navactive a:visited, #navactive > ul > li > a:hover 
```

您应该在 #navactive a:visited 和 #navactive a: 链接中添加一个 >，使其看起来像这样：

```
.main_menu ul > li:hover > a, #navactive > a:link, #navactive > a:visited, #navactive > ul > li > a:hover 
```

">" 表示您只引导子元素

# ruby-on-rails - 无法在 ROR 中生成模型

> ID：14310089
> 
> 赞同：1
> 
> 时间：2013-01-14T00:55:22.473
> 
> 标签：ruby-on-rails

我是 ROR 的新手。我已经安装了 mySql、Ruby、Rubygems 和 Rails，以及 MacPorts。我有一个名为 demo 的项目，我正在尝试为其生成模型名称 Movie。我还创建了一个名为 Movies 的数据库。

这是我尝试从终端（Mac Lion）生成模型时收到的以下错误。

```
rails 生成模型 Movie
/Library/Ruby/Gems/1.8/gems/bundler-1.2.3/lib/bundler/rubygems_integration.rb:187:in `stub_source_index170': 没有要加载的文件——rubygems/source_index (LoadError)
    来自 /Library/Ruby/Gems/1.8/gems/bundler-1.2.3/lib/bundler/rubygems_integration.rb:353:in `stub_rubygems'
    来自 /Library/Ruby/Gems/1.8/gems/bundler-1.2.3/lib/bundler/rubygems_integration.rb:250:in `replace_entrypoints'
    来自 /Library/Ruby/Gems/1.8/gems/bundler-1.2.3/lib/bundler/runtime.rb:14:in `setup'
    来自 /Library/Ruby/Gems/1.8/gems/bundler-1.2.3/lib/bundler.rb:116:in `setup'
    来自 /Library/Ruby/Gems/1.8/gems/bundler-1.2.3/lib/bundler/setup.rb:7
    来自 /Library/Ruby/Site/1.8/rubygems/custom_require.rb:60:in `gem_original_require'
    来自 /Library/Ruby/Site/1.8/rubygems/custom_require.rb:60:in `require'
    来自 /Users/josephcarlson/demo/config/boot.rb:6
    来自脚本/rails:5:in `require'
    来自脚本/rails:5

```

这是我的宝石清单

***当地宝石***

actionmailer (3.2.11, 3.2.10) actionpack (3.2.11, 3.2.10) activemodel (3.2.11, 3.2.10) activerecord (3.2.11, 3.2.10) activeresource (3.2.11, 3.2.10) activesupport (3.2.11, 3.2.10) akami (1.2.0) arel (3.0.2) builder (3.0.4) bundler (1.2.3) coffee-rails (3.2.2) coffee-script (2.2.0)咖啡脚本源 (1.4.0) erubis (2.7.0) execjs (1.4.0) gyoku (1.0.0) 远足 (1.2.1) httparty (0.9.0) httpi (2.0.0) i18n (0.6\. 1) Journey (1.0.4) jquery-rails (2.1.4) json (1.7.6) mail (2.4.4) mime-types (1.19) multi_json (1.5.0) multi_xml (0.5.1) mysql2 (0.3\. 11) nokogiri (1.5.6) nori (2.0.0) polyglot (0.3.3) rack (1.4.4, 1.4.3) rack-cache (1.2) rack-ssl (1.3.2) rack-test (0.6\. 2) rails (3.2.11, 3.2.10) railties (3.2.11, 3.2.10) rake (10.0.3) rdoc (3.12) sass (3.2.5) sass-rails (3.2.5) savon (2.0\. 2）链轮（2.2.2）sqlite3（1.3.7）雷神（0.16.0）倾斜（1.3.3）树顶（1.4.12) tzinfo (0.3.35) uglifier (1.3.0) 芥末 (3.0.0)

这是宝石环境

RubyGems 环境： - RUBYGEMS 版本：1.8.24 - RUBY 版本：1.8.7（2012-02-08 补丁级别 358）[universal-darwin11.0] - 安装目录：/Library/Ruby/Gems/1.8 - RUBY 可执行文件：/ System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby - 可执行目录：/usr/bin - RUBYGEMS 平台： - ruby​​ - Universal-darwin-11 - GEM PATHS： - /Library/Ruby/Gems /1.8 - /Users/josephcarlson/.gem/ruby/1.8 - /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/gems/1.8 - GEM 配置： - :update_sources => true - :verbose => true - :benchmark => false - :backtrace => false - :bulk_threshold => 1000 - 远程资源: - [http://rubygems.org/](http://rubygems.org/)

## 更新

该问题源于 database.yml 文件中的无效行。见下文。

开发：适配器：mysql2 编码：utf=8 数据库：测试池：5 主机：localhost 用户名：xxxx 密码：xxxxxx socket /tmp/mysql.sock

所以你可以看到编码线和套接字线不正确。我通过删除“utf = 8”中的=并将“：”添加到套接字行来更正这些行。一旦修复，我就能够生成模型、控制器和/或脚手架。

# .net - 如何通过 NuGet 安装 SignalR，无法添加 Microsoft.Web.Infrastructure？

> ID：14310092
> 
> 赞同：3
> 
> 时间：2013-01-14T00:56:35.090
> 
> 标签：.net, nuget, signalr, nuget-package

我正在尝试使用以下方法安装 SignalR：

```
Install-Package Microsoft.AspNet.SignalR -pre 
```

我收到一条错误消息，指出 Nuget 无法添加`Microsfot.Web.Infrastructure`引用。有人知道为什么会这样吗？下面是完整的输出：

```
PM> Install-Package Microsoft.AspNet.SignalR -pre
Attempting to resolve dependency 'Microsoft.AspNet.SignalR.JS (≥ 1.0.0-rc1)'.
Attempting to resolve dependency 'jQuery (≥ 1.6.4)'.
Attempting to resolve dependency 'Microsoft.AspNet.SignalR.SystemWeb (≥ 1.0.0-rc1)'.
Attempting to resolve dependency 'Microsoft.AspNet.SignalR.Owin (≥ 1.0.0-rc1)'.
Attempting to resolve dependency 'Microsoft.AspNet.SignalR.Core (≥ 1.0.0-rc1)'.
Attempting to resolve dependency 'Newtonsoft.Json (≥ 4.5.4)'.
Attempting to resolve dependency 'Owin (≥ 1.0)'.
Attempting to resolve dependency 'Microsoft.Owin.Host.SystemWeb (≥ 1.0.0-rc1)'.
Attempting to resolve dependency 'Microsoft.Web.Infrastructure (≥ 1.0.0.0)'.
You are downloading Microsoft.AspNet.SignalR.Core from Microsoft, the license agreement to which is available at http://www.microsoft.com/web/webpi/eula/aspnet_and_web_tools_2012_EULA_ENU.htm. Check the package for additional dependencies, which may come with their own license agreement(s). Your use of the package and dependencies constitutes your acceptance of their license agreements. If you do not accept the license agreement(s), then delete the relevant components from your device.
Successfully installed 'Microsoft.AspNet.SignalR.Core 1.0.0-rc1'.
Successfully installed 'Owin 1.0'.
You are downloading Microsoft.AspNet.SignalR.Owin from Microsoft, the license agreement to which is available at http://www.microsoft.com/web/webpi/eula/aspnet_and_web_tools_2012_EULA_ENU.htm. Check the package for additional dependencies, which may come with their own license agreement(s). Your use of the package and dependencies constitutes your acceptance of their license agreements. If you do not accept the license agreement(s), then delete the relevant components from your device.
Successfully installed 'Microsoft.AspNet.SignalR.Owin 1.0.0-rc1'.
Successfully installed 'Microsoft.Web.Infrastructure 1.0.0.0'.
Successfully added 'Microsoft.AspNet.SignalR.Core 1.0.0-rc1' to OProject.
Successfully added 'Owin 1.0' to OProject.
Successfully added 'Microsoft.AspNet.SignalR.Owin 1.0.0-rc1' to OProject.
Value does not fall within the expected range.
Successfully uninstalled 'Microsoft.Web.Infrastructure 1.0.0.0'.
Successfully uninstalled 'Microsoft.AspNet.SignalR.Owin 1.0.0-rc1'.
Successfully uninstalled 'Owin 1.0'.
Successfully uninstalled 'Microsoft.AspNet.SignalR.Core 1.0.0-rc1'.
Install failed. Rolling back...
Install-Package : Failed to add reference to 'Microsoft.Web.Infrastructure'.
At line:1 char:16
+ Install-Package <<<<  Microsoft.AspNet.SignalR -pre
    + CategoryInfo          : NotSpecified: (:) [Install-Package], InvalidOperationException
    + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:33:22.213

我遇到过同样的问题。对我来说，似乎我已经有了包的目录，但里面没有 DLL 文件。这是我解决它的方法：

1.  **删除 Microsoft.Web.Infrastructure 的本地目录**，例如：

c:\MySolution\packages\Microsoft.Web.Infrastructure.1.0.0.0

1.  **重新运行 NuGet 包**（例如 SignalR）的安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T22:52:41.277

确保您也在运行最新的 Nuget。你是用VS2012还是VS2010

# c# - 当我有现有的 POCO 类和具有复杂/自定义映射 ping 的现有表时，如何使用 EF4？

> ID：14310096
> 
> 赞同：1
> 
> 时间：2013-01-14T00:57:53.793
> 
> 标签：c#, orm, entity-framework-4, mapping

我有一组基于 ado.net 的现有（遗留）业务对象（类）。他们有从 SQL 服务器加载自己的方法和保存自己的方法。这在 EF 或 linq2sql 之前就已经存在很久了。

我想使用 EF 以及它提供的所有好处。问题是我的类实现了加载自己的逻辑，使用将 ado.net 值映射到其属性的自定义逻辑。例如，他们可以使用“T”和“F”字符映射到布尔值，或者可以提取映射到集合的 CSV 值，或者可以将 varchar 值映射到枚举。这在它的 .Load() 方法中没有问题，因为所有的逻辑都已经写好了。这个应用程序很旧。

例如，我现有的客户类对应于客户表，但无法自动映射其值。

理想情况下，我想达到一个可以使用数据上下文并获得 IQueryable 结果的地步，这样我就可以使用 linq 查询数据库并保存更改，但是当行从数据库中出来时，我需要运行一些自定义逻辑来得到创建的类。

那么，如何以最不痛苦的方式将 EF4 与现有模型和需要自定义逻辑以将 SQL 值映射到属性（即其现有 .Load() 和 .Save() 方法）的现有 poco 类一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T04:19:15.523

假设您的所有实体类都有一个`Initialize`方法，您可以在 EF 实现实体时加载属性。

```
 public class YourContext : DbContext
 {
    protected ObjectContext ObjectContext
    {
        get
        {
            return ((IObjectContextAdapter)this).ObjectContext;
        }
    }

    public YourContext(string connectionString):base(connectionString)
    {
        ObjectContext.ObjectMaterialized += ObjectMaterialized;
    }

    void ObjectMaterialized(object sender, ObjectMaterializedEventArgs e)
    {
        dynamic entity = e.Entity;
        entity.Initialize();
    }
 } 
```

# java - 在循环中设置多个不同 JButton 的属性

> ID：14310097
> 
> 赞同：0
> 
> 时间：2013-01-14T00:58:30.920
> 
> 标签：java, swing, loops, jbutton, subclassing

```
String[] objectName = {  //these are all names for JButtons
            "firstBtn",
            "secondBtn",
            "thirdBtn",
            "coin1",
            "coin5",
            "coin25",
            "coin100"
    };    

for (int k=0;k<objectName.length;k++){
    objectName[o].setOpaque(false);
    objectName[o].setContentAreaFilled(false);
    objectName[o].setBorderPainted(false);
} 
```

我试图以这种方式缩短代码，因为我认为它会更容易。但是它不起作用。有没有办法让这段代码工作，或者我必须为每个 JButton 一次又一次地写同样的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:02:53.103

您可以子类`JButton`化并执行以下操作，

```
public class MyButton extends JButton{
    public MyButton(){
        setOpaque(false);
        setContentAreaFilled(false);
        setBorderPainted(false);
    }
} 
```

然后创建实例，

```
JButton firstBtn = new MyButton();
.
. 
```

# objective-c - 字符串上的排序描述符返回不需要的结果

> ID：14310098
> 
> 赞同：1
> 
> 时间：2013-01-14T00:58:59.820
> 
> 标签：objective-c, nssortdescriptor

我使用这个排序描述符

```
NSArray *sortedObjects = [self.array sortedArrayUsingDescriptors:[NSArray arrayWithObjects:[NSSortDescriptor sortDescriptorWithKey:@"index" ascending:YES], nil]]; 
```

结果是 10 和 11 与 1 一起排序并放在 2 之前。

```
index is 1/12
index is 10/12
index is 11/12  
index is 2/12  
index is 3/12
index is 4/12
index is 5/12
index is 8/12
index is 9/12 
```

如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:08:45.393

使用您自己的比较

```
- (NSArray *)sortedArrayWithOptions:(NSSortOptions)opts usingComparator:(NSComparator)cmptr 
```

或
其他允许自定义比较器的类型。

然后拆分日期并比较月份和日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:26:00.420

我不知道那个类是你正在打印的项目，大概是字符串。发生这种情况是因为“/”字符的值高于“0”。

您必须使用自定义方法或块进行比较。所以还要初始化选择器，而不仅仅是键：

```
NSSortDescriptor* sd= [[NSSortDescriptor alloc]initWithKey: @"index" ascending: YES selector: @selector(customCompare:)];
NSArray *sortedObjects = [self.array sortedArrayUsingDescriptors: @[ sd ] ]; 
```

在您的 customCompare: 方法中，您应该比较对象。

# ios - 抽象解析对象？

> ID：14310099
> 
> 赞同：11
> 
> 时间：2013-01-14T00:59:06.763
> 
> 标签：ios, parsing, model, abstraction

我想在我的应用程序中使用 Parse (parse.com)。Parse 使用 PFObject 模型。我想在我的代码中使用我自己的模型（这样它不依赖于解析）。如果可能的话，我想设计我的应用程序，以便我可以尽可能无缝地将 parse 替换为另一个云服务。

这是一个好主意吗？抽象模型存储以使我的应用程序中没有（或最少）Parse 代码痕迹的最佳方法是什么？

也许使用适配器设计模式将解析对象映射到我自己的对象？这应该是一个独立的类还是模型逻辑的一部分？

如果有人尝试过这样的事情，我想听听你的想法。我应该直接在我的代码中使用解析模型吗？或者也许是一个基于解析对象生成我的模型的单例工厂？

任何提示/想法/评论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T20:09:00.213

我找到了相对干净的方法来管理这个。

基本上，我创建了一个协议，称为`NPDictionaryRepresenting`哪些类可以遵循，以指定如何将它们转换为字典或从字典初始化。

```
@protocol NPDictionaryRepresenting <NSObject>
- (NSDictionary *)dictionaryRepresentation;
+ (id)objectWithDictionaryRepresentation:(NSDictionary *)dictionary;
@end 
```

我需要存储在 Parse 中的每个模型都将符合这一点并实现自己的自定义行为。该协议是通过使用字典抽象出来的，因此它不以任何方式依赖 Parse。

然后我实现了一个 NPNetworkAdapter 基类来处理所有网络存储。我还实现了一个继承自 NPNetworkAdapter 的 NPParseNetworkAdapter 类。这是唯一了解 Parse 的类。它的接口处理符合 NPDictionaryRepresenting 的对象。解析网络适配器能够通过提取我的对象的字典表示来创建 PFObjects。相反，它能够获取 PFObjects 并通过使用字典实例化它们来返回我自己的模型。

这种实现的缺点是它不能很好地处理对象关系（但我正在研究它）。

如果有人对这种方法有任何意见，我很想听听他们的意见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-15T19:14:21.103

我意识到这是一个老问题，但我正忙于一个提出完全相同问题的项目，所以我想我会发表评论。首先，我认为您很好地识别了这一点，并尝试避免将您的代码与 Parse 耦合得太紧。

我决定采取的路线是`Protocols`为我的模型类使用（接口），底层实现是 Parse 对象 - 使用[Parse 子类化功能](http://blog.parse.com/2013/03/22/stay-classy-objective-c-introducing-native-subclasses-for-parse-objects/)；我将其与工厂类的使用结合起来，将对象创建和实现细节与我的大多数应用程序代码分离。这可能看起来有点矫枉过正，并且确实需要一些额外的代码，但是，我相信它会通过测试和改变我访问后端服务的方式来获得回报。

对我来说，另一种选择是使用刚刚包装 PFObjects 的包装类。然而，就我而言，包装类只是愚蠢的委托类，没有`Protocols`为测试提供额外的好处，所以我坚持使用这种`Protocols`方法。

# c++ - 我可以使用全局系统挂钩来捕获单击了哪个文件吗？

> ID：14310106
> 
> 赞同：2
> 
> 时间：2013-01-14T00:59:57.160
> 
> 标签：c++, windows, winapi

我是 Windows 编程新手，主要完成 Java（Java SE、Java ME、Android、Java EE），所以要详细而温和。

我想捕获“在 Windows 中单击的文件/路径的名称，例如单击桌面上的文件”？

进一步研究[http://www.codeproject.com/Articles/6362/Global-System-Hooks-in-NET](http://www.codeproject.com/Articles/6362/Global-System-Hooks-in-NET)，这是一个小的 c#/c++ 不错的应用程序，它使用 Global System Hooks 来捕获坐标、点击等鼠标事件，ETC。

那么捕获文件图标事件的正确 API 或全局系统挂钩是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T22:24:56.160

没有单一的 API 可以提供这种详细程度。

的`WH_MOUSE`和`WH_MOUSE_LL`钩子`SetWindowsHookEx()`，或者由`WM_INPUT`传递的消息`RegisterRawInputDevices()`，可以告诉你鼠标何时被交互，该`GetCursorPos()`函数可以告诉你点击时鼠标光标在屏幕上的位置，但它不能告诉你它在点击什么上。你必须手动弄清楚。

例如，Desktop 是作为 ListView 控件实现的，因此可以使用`WindowFromPoint()`and`GetDesktopWindow()`函数来检查鼠标是否位于与桌面窗口本身而不是应用程序窗口对应的坐标处，如果是，则使用`LVM_HITTEST`and`LVM_GETITEM`消息来确定单击桌面上的哪个图标并提取其显示文本。然后使用`SHGetDesktopFolder()`函数和`IShellFolder`接口或`SHParseDisplayName()`函数来解析该文本并查看它是否返回`PIDL`表示路径/文件的 a，如果是，则使用`SHGetPathFromIDList()`获取实际路径/文件名。

如果你想用 Windows Explorer 应用程序做同样的事情，它会变得有点复杂。使用`WindowFromPoint()`、`GetWindowThreadProcessId()`、`OpenProcess()`和`EnumProcessModules()`确定鼠标是否位于 Windows 资源管理器应用程序上。但是，它的 UI 从 Windows 版本更改为下一个版本，但要点是您必须通过`AttachThreadInput()`and手动定位焦点控件`GetActiveWindow()`，检查它是否是 TreeView/ListView 控件，如果是，则使用特定于控件的消息来获取有关鼠标光标坐标下方的项目/图标的信息，并`IShellFolder`再次用于确定该项目/图标的文本实际代表什么。

Shell 编程是一个非常复杂的系统，不适合虚心进行交互。所以你需要问自己，为什么你首先需要这些信息？

# c# - 使用 Texture2D.SaveAsPng 连续保存许多屏幕截图会导致内存不足异常

> ID：14310108
> 
> 赞同：0
> 
> 时间：2013-01-14T01:00:09.500
> 
> 标签：c#, xna, out-of-memory

当我在我的 XNA 游戏中制作屏幕截图时，每张都会`texture.SaveAsPng`消耗一些内存，并且似乎不会回到游戏中。所以最终我的内存不足。我尝试将纹理数据保存到`FileStream`and`MemoryStream`中，希望可以从那里保存为`Bitmap`，但结果是一样的。有没有办法强制释放此内存或一些解决方法，让我获取图像数据并以其他方式保存它而不会遇到内存不足异常？

```
sw = GraphicsDevice.Viewport.Width;
sh = GraphicsDevice.Viewport.Height;

int[] backBuffer = new int[sw * sh];
GraphicsDevice.GetBackBufferData(backBuffer);
using(Texture2D texture = new Texture2D(GraphicsDevice, sw, sh, false,
  GraphicsDevice.PresentationParameters.BackBufferFormat))
{
    texture.SetData(backBuffer);
    using(var fs = new FileStream("screenshot.png", FileMode.Create))        
        texture.SaveAsPng(fs, sw, sh);  // ← this line causes memory leak      
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:27:53.057

您也许可以直接从纹理字节创建位图并绕过内部方法来检查是否`SaveAsPng`泄漏或其他原因。

试试这个扩展方法（不幸的是我无法测试（没有 xna 在工作）但它**应该可以**工作。）

```
public static class TextureExtensions
{
    public static void TextureToPng(this Texture2D texture, int width, int height, ImageFormat imageFormat, string filename)
    {
        using (Bitmap bitmap = new Bitmap(width, height, PixelFormat.Format32bppArgb))
        {
            byte blue;
            IntPtr safePtr;
            BitmapData bitmapData;
            Rectangle rect = new Rectangle(0, 0, width, height);
            byte[] textureData = new byte[4 * width * height];

            texture.GetData<byte>(textureData);
            for (int i = 0; i < textureData.Length; i += 4)
            {
                blue = textureData[i];
                textureData[i] = textureData[i + 2];
                textureData[i + 2] = blue;
            }
            bitmapData = bitmap.LockBits(rect, ImageLockMode.WriteOnly, PixelFormat.Format32bppArgb);
            safePtr = bitmapData.Scan0;
            Marshal.Copy(textureData, 0, safePtr, textureData.Length);
            bitmap.UnlockBits(bitmapData);
            bitmap.Save(filename, imageFormat);
        }
    }
} 
```

它有点粗糙，但你可以清理它（如果它甚至可以工作）。

最后但并非最不重要的一点（如果所有其他尝试都失败了）你可以打电话给`GarbageCollection`自己，但不建议这样做，因为它是非常糟糕的做法。

```
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

上面的代码应该是最后的手段。

祝你好运。

# android - 不理解 AIDL 文件中的编译错误

> ID：14310111
> 
> 赞同：2
> 
> 时间：2013-01-14T01:00:41.823
> 
> 标签：android, aidl

我第一次涉足 Android 服务时遇到了 AIDL 文件中的编译错误问题。我正在使用 Eclipse（带有 Android 开发工具）和 Android 4.1。我有以下 AIDL 文件：

***天气.aidl***

```
package ws.hamacher.weatherservice.service;

parcelable ws.hamacher.weatherservice.dto.Weather; 
```

在此文件中，我得到“接口 ws.hamacher.weatherservice.dto.Weather 应在名为 ws\hamacher\weatherservice\service\ws.aidl 的文件中声明。” 在 parcelable 线上，但这是指我的 Java 类！

***IWeatherService.aidl***

```
package ws.hamacher.weatherservice.service;

import ws.hamacher.weatherservice.service.Weather;

interface IWeatherService {
    void addToWeatherService(in Weather weather);
    void deleteFromWeatherService(in Weather weather);
    List<Weather> getLocations();
} 
```

在这里，import 语句再次给出了类似的错误“接口 ws.hamacher.weatherservice.dto.Weather 应在名为 ws\hamacher\weatherservice\service\ws.aidl 的文件中声明。” 这应该是指上面的第一个文件吧？

除此之外，方法声明都有错误，与“未知类型的天气”有关。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T07:53:40.673

如果要发送自定义对象，例如 Weather 类，您应该创建一个包：ws.hamacher.weatherservice.dto

写 ：

天气.java

在包中：ws.hamacher.weatherservice.dto 像这样：

```
 public class Weather implements Parcelable {
....
} 
```

然后，编写 Weather.aidl：

```
package ws.hamacher.weatherservice.dto;

parcelable Weather; 
```

实际代码请参见[AndroidMusicPlayer](https://github.com/herbertdai/Android-Music-Player)和 AndroidMusicPlayerClient。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T00:31:37.827

解决了。我的 Weather.aidl 必须与我的 parcelable Weather 类位于同一目录中。

# java - 制作 PHP 服务器以读取基于 java 的客户端

> ID：14310124
> 
> 赞同：0
> 
> 时间：2013-01-14T01:02:27.097
> 
> 标签：java, php, sockets, connection

```
public class Client {
/**
 * @param args the command line arguments
 */
public static void main(String[] args) throws IOException {
    Socket sock = new Socket();
    sock.connect(new InetSocketAddress(InetAddress.getLocalHost(), 43594));

    DataOutputStream out = new DataOutputStream(sock.getOutputStream());
    DataInputStream in = new DataInputStream(sock.getInputStream());

    out.writeByte(255);
    out.writeLong(133713371337L);

    System.out.println("Response: " + in.readByte() + ", " + in.readLong());

    sock.close();
} 
```

和 PHP 服务器意味着读取和写回 java 客户端：

```
<?php
require 'Stream.php';
$stream = new Stream();

$address = '127.0.0.1';
$port = 43594;
$sock = socket_create(AF_INET, SOCK_STREAM, 0);
socket_bind($sock, 0, $port) or die('Could not bind to address');
socket_listen($sock);
echo "Server listening on port " . $port . "...";
$client = socket_accept($sock);

$data = socket_read($client, 1, PHP_BINARY_READ);
$byte_array = unpack('C*', $data);
$stream->setStream($byte_array);
$b2 = $stream->readUnsignedByte();

$l1 = socket_read($client, $stream->readQWord());
echo $b1 . " " . $l1;
socket_write($client, 0);
socket_write($client, $stream->writeQWord(2148000000)); 
```

正在使用的流类：http: [//pastebin.com/p1vc9aPG](http://pastebin.com/p1vc9aPG)

我正在尝试用java编写一个客户端，它可以与服务器联系、发送和读取数据。服务器用 PHP 编写并通过 cli 运行，而客户端用 java 编写。如果可以，请帮助，可能没有多少人可以帮助解决这个问题。

该协议已经建立，我只是想在 PHP 中实现它。我似乎无法从 PHP 页面读/写回 Java 客户端。

Java 中的客户端定义了我想要的样子。我正在寻找的是 PHP 中的等效服务器，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:11:57.943

我实际上是用另一种方式编写的，客户端是 PHP Web 应用程序，服务器是 jsvc 下的 Java 守护程序。

首先要考虑的是定义传输协议，因为这两种语言的类型和对象表示不同，并且它们可能在具有不同数字表示的硬件上运行。我推荐 JSON 或 XML。

之后，您的服务器可能需要能够处理多个连接，因此需要线程或非阻塞套接字 I/O。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:06:08.207

首先，您应该`.flush()`在 Java 代码中写入套接字之后调用。否则数据不会被发送到服务器。

然后，网络端点之间的通信只是关于所使用协议的协议。这里没有特定的语言...

# azure - 为 Windows 服务总线命名空间 DNSEntry 配置 DNS

> ID：14310127
> 
> 赞同：0
> 
> 时间：2013-01-14T01:03:13.367
> 
> 标签：azure, servicebus, azureservicebus

Windows 服务总线 1.0 支持使用`New-SbNamespace -AddressingScheme DNSRegistered`.

[新 SbNamespace 命令](http://msdn.microsoft.com/en-us/library/windowsazure/jj248744%28v=azure.10%29.aspx)

我的场景：

1.  同一域上的所有机器 (cromwell.local)
2.  2 个计算节点
3.  单独服务器上的 1 个 SQL 节点
4.  2 个命名空间（例如 NamespaceA 和 NamespaceB）

DNS 条目（我倾向于 CName - 不是 DNS 专家）是否每个都指向一个计算节点？这似乎与整个网关/重定向情况无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T01:31:41.190

只要您有一个映射到一个 IP（或一组 IP，如果您使用的是集群安装）的主机名，什么样的条目都没有关系。主机名可以是简单的名称（例如 my-server）或完全限定的域名（例如 my-server.mydomain.com）。重要的是名称可以由双方解析，并且在创建命名空间时将相同的主机名传递给服务器。

要考虑的一件重要事情是，您使用的主机名必须与服务器 ssl 证书的 CN 名称匹配，以避免身份验证问题（由于 CN 名称匹配）。如果您在已加入域的计算机上使用默认安装，则应使用具有相同域名的主机名（因为在域上默认安装时，服务器使用 *.yourdomain 证书）。对于所有其他场景（工作组机器、与域不匹配的主机名），您需要提供自己的证书。此决定将影响您将能够在服务器上拥有的名称空间（因为所有名称空间都需要以某种方式匹配证书 CN），因此请权衡您的选择。

* * *

根据您描述的场景，我建议您执行以下操作：

*   您的 DNS 名称应该指向两个计算节点的 IP（我假设这些是运行服务总线服务器的机器。除了 DNS 重定向之外，这还将为您提供基于 DNS 的负载平衡

*   每个 DNS 名称只能有一个命名空间，因此在创建命名空间 A 时，您需要传递您在第一步中创建的 CNAME。如果您需要更多命名空间，则需要创建更多 CNAME（这可能是您的证书有问题，具体取决于您选择的主机名/域名）

PS。服务总线服务器并不真正支持 2 节点配置。为简单起见，您应该转到一个节点，或者如果您想要一个高可用性服务器，则应该转到三个。

# mysql - MySQL 搜索不处理小字符串

> ID：14310132
> 
> 赞同：0
> 
> 时间：2013-01-14T01:04:16.000
> 
> 标签：mysql

好的，我有一张这样的表：http: [//i.imgur.com/IPUSe.png](https://i.imgur.com/IPUSe.png)

![在此处输入图像描述](../Images/0315fb9b55aecdd4a2d67eded9ab2126.png)

我试图在`combined_names`MySQL 搜索查询的列中找到匹配项。

我用它来使用这个查询进行搜索：`SELECT * FROM players WHERE match(combined_names) against('Lin')`

在 phpmyadmin 中运行查询后，我得到以下信息：`MySQL returned an empty result set (i.e. zero rows). ( Query took 0.0005 sec )`

嗯...让我们尝试不同的行！`SELECT * FROM players WHERE match(combined_names) against('Dejan')`给了我`Showing rows 0 - 0 ( 1 total, Query took 0.0007 sec) [id: 1 - 1]`所以它有效！

好吧，让我们尝试`Lin`同时更改`combined_names`和`forename`到 ...`Tester`所以我们这样做：`SELECT * FROM players WHERE match(combined_names) against('Tester')`

我得到了它？我得到：`Showing rows 0 - 0 ( 1 total, Query took 0.0006 sec) [id: 3 - 3]`

奇怪的。更改`Lin`为后`Tester`，它可以工作...为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:10:27.880

您需要设置[ft_min_word_len](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_ft_min_word_len) =3，重新启动 mysql 服务器并重建索引。

ft_min_word_len 默认为 4

用于`REPAIR TABLE tbl_name QUICK`重建全文索引。

# c# - 只允许文本框中的数字不起作用？C＃

> ID：14310137
> 
> 赞同：0
> 
> 时间：2013-01-14T01:06:09.377
> 
> 标签：c#, textbox

我有一个关于我正在做的小型练习计划的问题。我几乎没有使用 C# 的经验，并且对 Visual Basic 有一点经验。我遇到的问题与仅允许文本框中的数字有关。我在另一个程序中成功地这样做了，但由于某种原因，它不能使用相对相同的代码。这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void btnCalculate_Click(object sender, EventArgs e)
        {
            Double TextBoxValue;
            TextBoxValue = Convert.ToDouble(txtMinutes.Text);
            TextBoxValue = Double.Parse(txtMinutes.Text);

            {
                Double Answer;
                if (TextBoxValue > 59.99)
                {
                    Answer = TextBoxValue / 60;
                }
                else
                {
                    Answer = 0;
                }
                {
                    lblAnswer.Text = Answer.ToString();
                }
            }

        }

        private void txtHours_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (char.IsNumber (e.KeyChar) && Char.IsControl(e.KeyChar))
            {
                e.Handled = true;
            }
        }
    }
} 
```

如果我的代码中还有其他错误，这里的任何人都可以纠正我，我也很感激。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T01:10:00.470

你已经把支票倒过来了。如果新字符是数字并且如果它是控制字符，您的代码所做的是取消输入。

```
if (!char.IsNumber(e.KeyChar) && !Char.IsControl(e.KeyChar))
    e.Handled = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:14:48.633

```
 private void txtHours_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (!char.IsControl(e.KeyChar)
                && !char.IsDigit(e.KeyChar)
                && e.KeyChar != '.')
                e.Handled = true;

            // only allow one decimal point
            if (e.KeyChar == '.'
                && (txtHours).Text.IndexOf('.') > -1)
                e.Handled = true;
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T01:10:30.880

你的逻辑不正确。它声明“如果按下的键是一个数字和一个控制字符......那么我已经处理了它”。你想要的是“如果按下的键**不是**数字，我已经处理过了”。

```
if (!char.IsNumber(e.KeyChar)) {
    // ... 
```

# c - 如何在mac上编写自定义内核？

> ID：14310138
> 
> 赞同：4
> 
> 时间：2013-01-14T01:06:10.077
> 
> 标签：c, macos, assembly, kernel, nasm

我一直在按照[“Mike OS 指南”](http://mikeos.berlios.de/write-your-own-os.html)制作我自己的内核，并且我得到了它的工作。但后来我查阅了互联网上的许多指南，用于制作从编译对象`NASM`加载函数的引导扇区。我尝试编译和链接各种 GCC 安装：`main``C`

```
x86_64-pc-linux-
arm-uclinux-elf-
arm-agb-elf-
arm-elf-
arm-apple-darwin10-
powerpc-apple-darwin10-
i686-apple-darwin10-
i586-pc-linux-
i386-elf- 
```

一旦我像使用`MikeOS`引导程序一样将它们放到软盘上，它们都会失败。我在[http://www.osdever.net/](http://www.osdever.net/)上尝试过各种教程，就像[这里](http://www.osdever.net/tutorials/view/writing-a-simple-c-kernel)的教程一样，我也尝试过[http://wiki.osdev.org/Bare_Bones](http://wiki.osdev.org/Bare_Bones)，但是在 Mac 上编译时没有任何效果，但是我还没有厌倦真正的 Linux 机器。但我想知道如何在组装调用`C`函数时获得引导程序，并将它们放在一个工作内核文件中，然后将其加载到软盘文件上，然后像`MikeOS`教程中一样加载到 ISO 上。或者我应该只制作`kernel.bin`并加载它`syslinux`? 谁能给我一个关于如何使这一切在 Mac 开发环境中工作的提示？我通过 macports 和 homebrew 收费，所以这会有所帮助。有人先后做过吗？

**编辑** 到目前为止，[这是我的引导区。](http://trevorrudolph.com/myfirst.asm)

我只想知道如何从 跳转到一个`extern`函数`C`并链接它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T02:11:18.567

这有一些问题。首先，您提到的所有编译器都输出 32 位或 64 位代码。这很好，但是当引导扇区启动时，它以 16 位实模式运行。如果您希望能够运行该 32 位或 64 位代码，您需要首先切换到适当的模式（32 位保护模式适用于 32 位，长模式适用于 64 位）。

然后，一旦切换到适当的模式，您甚至没有那么多空间用于代码：引导扇区是 512 字节；两个字节是为可引导签名保留的，您需要一些字节用于切换到适当模式的代码。如果您希望能够使用该磁盘或 FAT 文件系统上的分区，请带走更多可用字节。除了最琐碎的程序之外，您根本没有足够的空间来存放所有程序。

那么真正的操作系统如何处理呢？真正的操作系统倾向于使用引导扇区从磁盘加载更大的引导加载程序。然后那个更大的引导加载程序可以加载实际的内核并切换到适当的模式（尽管这可能是加载的内核的责任——这取决于）。

**编写引导加载程序可能需要做很多工作，因此您可能希望使用 GRUB**并让您的内核符合 Multiboot 标准，而不是自己编写引导加载程序。GRUB 是一个引导加载程序，它能够从磁盘加载内核（可能是 ELF 格式）并以 32 位保护模式跳转到入口点。有帮助，对吧？

**但是，这并不能让您免于学习汇编**：内核的入口点必须是汇编。通常，它所做的只是设置一个小堆栈并将适当的寄存器传递给具有正确调用约定的 C 函数。

你可能认为你可以复制而不是自己写，你是对的，但它并没有就此结束。您还需要（至少）组装：

*   加载一个新的全局描述符表。
*   处理中断。
*   Using non-memory-mapped I/O ports.

…and so on, not to mention that **if you have to debug, you may not have a nice debugger; instead, you'll have to look at disassemblies, register values, and memory dumps**. Even if your code is compiled from C, you'll have to know what the underlying assembly does or you won't be able to debug it.

**In summary, your main problem is not knowing assembly.** As stated before, assembly is essential for operating system development. Once you know assembly thoroughly, then you may be able to start writing an operating system.

# android - 构建简单的 UI 课程示例

> ID：14310142
> 
> 赞同：0
> 
> 时间：2013-01-14T01:06:39.387
> 
> 标签：android

好的，我一直在关注 Android 开发者网站上的课程示例，代码如下：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal">
<EditText android:id="@+id/edit_message"
    android:layout_weight="1"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:hint="@string/edit_message" />
<Button
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/button_send" />
</LinearLayout> 
```

显然，代码应该没问题，在担心我输入错误之后，我最终直接复制了它，但控制台告诉我：

描述错误：错误：找不到与给定名称匹配的资源（在“提示”处，值为“@string/edit_message”）。

描述错误：错误：未找到与给定名称匹配的资源（在“文本”处，值为“@string/button_send”）。

现在这些值在 strings.xml 文件中定义。所以我不知道为什么我会收到这些错误。

对于任何可以在这里提供帮助的人，提前非常感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:11:01.257

在 eclipse project>clean 中尝试。有时日食会给你这样的错误。或者重启eclipse。您是否还确保在您的 strings.xml 中有类似的内容？
`<string name="edit_message">Your intresting string.</string>`有时，如果您使用“gui 资源添加器”，它会出错。检查你的xml。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:21:59.627

确保 res 内的任何文件中都没有大写字符或下划线。此外， res 和 src 的文件中不得有任何错误 .. 之后，您必须按照前面的答案中所述清理项目。实际上，这些错误会阻止更新 R 文件，这是访问 res 文件中的资源所必需的。

# r - 创建包含多个面板的 R 图，其中每个面板保存为 .png/.pdf

> ID：14310143
> 
> 赞同：1
> 
> 时间：2013-01-14T01:06:44.707
> 
> 标签：r, plot

我想创建一个大图，其中包含由 plot() 函数制作的四个子图。所有子图都保存为 png/pdf 文件格式。R中有没有办法将这些图导入R然后创建一个包含所有子图的大图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:14:40.350

'grImport' 包具有读取 pdf 文件、转换为 RGML 然后导入以在网格图形框架中使用的功能。

'png' 包有一个`readPNG`功能。

并且正如 thelatemail 所建议的，如果您同时拥有创建这些图的数据和代码，您可能希望查看该`layout`函数或使用`par`参数 mfrow、mfcol 或 mfg。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:21:23.860

通过创建每个图，将它们放在一起然后将它们保存为一个文件，从源头上解决问题不是更容易吗？据我所知，`grid`布局功能应该与基本功能一起使用。`plot`这是一个使用`ggplot2`. 如果您使用`ggplot`，您也许还可以使用方面功能。代码跟在图像之后。

![截屏](../Images/90a9f22c188771016a70307820e61ac5.png)

```
library(ggplot2)
library(grid)

set.seed(23456)
mydf <- data.frame(mydate = seq(as.Date('2012-01-01'), as.Date('2012-12-01'), by = '1 month'),
                   run1 = runif(12, 100, 200),
                   run2 = runif(12, 300, 400),
                   run3 = runif(12, 1000, 2000),
                   run4 = runif(12, 2000, 3000))

p1 <- ggplot(data = mydf) +
         geom_line(aes(x = mydate, y = run1))

p2 <- ggplot(data = mydf) +
         geom_line(aes(x = mydate, y = run2))

p3 <- ggplot(data = mydf) +
         geom_line(aes(x = mydate, y = run3))

p4 <- ggplot(data = mydf) +
         geom_line(aes(x = mydate, y = run4))

png(filename = paste("multipleplot.png", sep = ""), width = 600, height = 600, units = "px", res = NA)
grid.newpage()
pushViewport(viewport(layout = grid.layout(2, 2, widths = c(300, 300))))

vplayout <- function(x, y)
    viewport(layout.pos.row = x, layout.pos.col = y)

print(p1, vp = vplayout(1,1))
print(p2, vp = vplayout(1,2))
print(p3, vp = vplayout(2,1))
print(p4, vp = vplayout(2,2))
dev.off() 
```

# .net - 将企业库缓存从 3.1 升级到 5.0

> ID：14310144
> 
> 赞同：0
> 
> 时间：2013-01-14T01:06:49.873
> 
> 标签：.net, enterprise-library

尝试将 EntLib 从 3.1 升级到 5.0，但我遇到了一个奇怪的缓存问题。我们所有与缓存相关的单元测试都在抛出：

`failed: System.ArgumentException : Type does not provide a constructor taking a single parameter type of NameValueCollection`

我们使用的是 EntLib 附带的默认 CacheManger，可以在 v3 上正常工作，但是当我查看`Microsoft.Practices.EnterpriseLibrary.Caching.CacheManager`该类时，我在 3.1 或 5.0 版本中都看不到任何相关的构造函数？

```
[ConfigurationNameMapper(typeof(CacheManagerDataRetriever)), CustomFactory(typeof(CacheManagerCustomFactory))]
public class CacheManager : IDisposable
{
    // Methods
    internal CacheManager(Cache realCache, BackgroundScheduler scheduler, ExpirationPollTimer pollTimer)
    {
        this.realCache = realCache;
        this.scheduler = scheduler;
        this.pollTimer = pollTimer;
    } 
```

这是我从 EntLib 配置工具创建的配置：

```
<cachingConfiguration defaultCacheManager="Whatever">
  <cacheManagers>
     <add name="Whatever" type="Microsoft.Practices.EnterpriseLibrary.Caching.CacheManager, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        expirationPollFrequencyInSeconds="60" maximumElementsInCacheBeforeScavenging="1000"
        numberToRemoveWhenScavenging="10" backingStoreName="Null Storage" />
</cacheManagers> 
```

我查看了迁移指南，但没有显示任何内容。

我们现在是否希望为 CacheManager 创建自己的包装器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:09:21.523

仔细检查堆栈跟踪发现不是缓存管理器抛出异常，而是我们的自定义`IAuthorizationProvider`.

一旦我添加了必要的构造函数，我们的大多数单元测试都通过了。一些仍然失败，但这似乎是由于配置和异常/错误处理方面的差异。

# hibernate - 用于搜索的 HQL 查询（一对多关系）

> ID：14310146
> 
> 赞同：3
> 
> 时间：2013-01-14T01:07:38.203
> 
> 标签：hibernate, entity, hql, one-to-many

我有两个实体，书和作者。

```
@Entity
@Table(name="book") 
class Book {
    private int id;
    private Map<Integer, Author> authors = new HashMap<Integer, Author>();

    @Id
    @GeneratedValue
    @Column(name="id_book")
    public int getId() {
        return this.id;
    }

    @OneToMany(fetch=FetchType.EAGER)
    @JoinTable(name="book_author", joinColumns= {@JoinColumn(name="id_book")},
            inverseJoinColumns = {@JoinColumn(name="id_author", table="author")})
    @MapKeyColumn(name="order")
    public Map<Integer, Author> getAuthors() {
        return authors;
    }

}

@Entity
@Table(name="author")
class Author {

    private int id;
    private String lastname;
    private String firstname;

    @Id
    @Column(name="id_author")
    @GeneratedValue
    public int getId() {
        return id;
    }

    public String getLastname() {
        return lastname;
    }

    public String getFirstname() {
        return firstname;
    }

} 
```

一本书有许多按特定顺序列出的作者。现在我正在尝试创建一个 HQL，以便我可以从具有特定名字或姓氏或两者的特定作者那里获取书籍列表。我对如何在两个实体之间使用连接感到困惑。任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T11:24:01.983

第一：书籍和作者之间存在一对多的关系。一本书可以有很多作者，但一个作者只能写一本书。如果一个真实的人写了很多书，那么他需要在表 author 中使用很多行，每一行对应他的书。这可能不是您想要的，但您已经定义了这样的关系。

一对多关系在数据库端使用表作者中的书的 id 工作。通过`getBookID()`在`Author`. 然后您可以使用 HQL 语句

```
from Book b inner join Author a 
   where b.id  = a.bookId
      and a.lastname = :ln
      and a.firstname = :fn 
```

或者

```
from Book b where b.id in (select bookId from Author a
                              where a.lastname = :ln
                              and a.firstname = :fn) 
```

第二：现在你可能更喜欢一个作者可以有很多本书。然后你有一个多对多的关系。为此，建议引入包含多对多关系的交叉表。这个交叉表只包含两列，book id 和 author id，并且 Book 和 Author 都有一对多的关系（并且 Author 不再有 bookId）。HQL 语句与第一种情况类似，只是它们遍历三个表。

编辑：使用您的 Book_Author 表：对于您的选择，您必须创建一个映射到该表的 BookAuthor 类。然后您可以使用 HQL 语句

```
from Book b inner join BookAuthor ba inner join Author a 
   where b.id  = ba.bookId
      and ba.authorId = a.id
      and a.lastname = :ln
      and a.firstname = :fn 
```

或者

```
from Book b where b.id in (select ba.bookId from BookAuthor ba, Author a
                              where ba.authorId = a.id
                                 and a.lastname = :ln
                                 and a.firstname = :fn) 
```

# c++ - 使用 boost::phoenix::bind 和 boost::spirit::qi::symbols::add

> ID：14310152
> 
> 赞同：2
> 
> 时间：2013-01-14T01:09:07.863
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi, boost-phoenix

我想解析文本文件中的浮点数并将其插入符号表中；解析器和符号表由 Spirit::qi 提供。

这是我的代码：

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>

#include <stdint.h>
#include <iostream>
#include <string>
template<typename VTYPE>
struct VTable : boost::spirit::qi::symbols<char, VTYPE> {
    VTable() {} // empty
};

int main() {
using boost::spirit::qi::_1;
using boost::spirit::qi::eps;
using boost::spirit::qi::rule;
using boost::spirit::qi::ascii::space;
using boost::spirit::qi::space_type;
using boost::spirit::qi::real_parser;
using boost::spirit::qi::int_parser;
using boost::spirit::qi::strict_real_policies;
    VTable<double> floatDecs;
    floatDecs.add("hallo", 15.26)("duDa", 18.5);

const std::string some = "some";
    rule<std::string::iterator, double> value = real_parser<double, strict_real_policies<double>>() [ boost::phoenix::bind(&VTable<double>::add, floatDecs, boost::phoenix::cref(some), _1) ];

    std::cout << boost::spirit::qi::phrase_parse(test.begin(), test.end(), value, space);
    return 0;
} 
```

这里的问题在于 boost::phoenix::bind，但我不知道如何解决这个问题（我对这个库相当陌生）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T10:13:40.587

这是一个工作版本。之后，我会列出你的问题所在。

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>

#include <stdint.h>
#include <iostream>
#include <string>
template<typename VTYPE>
struct VTable : boost::spirit::qi::symbols<char, VTYPE> {
    VTable() {} // empty
};

int main() {
using boost::spirit::qi::_1;
using boost::spirit::qi::eps;
using boost::spirit::qi::rule;
using boost::spirit::qi::ascii::space;
using boost::spirit::qi::space_type;
using boost::spirit::qi::real_parser;
using boost::spirit::qi::int_parser;
using boost::spirit::qi::strict_real_policies;

    VTable<double> floatDecs;
    floatDecs.add("hallo", 15.26)("duDa", 18.5);

    const char some[] = "some";

    rule<std::string::iterator, double()> value =
            real_parser<double, strict_real_policies<double> >()
            [ boost::phoenix::bind(floatDecs.add, boost::phoenix::val(some), _1) ];

    std::string test("10.6");

    std::string::iterator b(test.begin()), e(test.end());

    std::cout << boost::spirit::qi::phrase_parse(b, e, value, space);

    return 0;
} 
```

首先，需要修复要用作 add() 参数的变量。

```
const char some[] = "some"; 
```

接下来，您需要修复规则模板参数中的语法：

```
rule<std::string::iterator, double()> 
```

注意括号，使双精度函数声明而不是普通双精度，以进行惰性求值。

接下来，您需要将上述语法用于您的语义操作。

```
[ boost::phoenix::bind(floatDecs.add, boost::phoenix::val(some), _1) ]; 
```

老实说，我不确定为什么这会起作用，因为我不是凤凰专家，但上面“sehe”评论中的链接提供了答案。此外，您使用 来查找错误的树`cref`，从 ' 的声明中没有任何迹象表明`add()`需要引用。`val`是将`some`变量变成凤凰快乐的懒惰参数所需要的。

最后，您只需要提供一些合理的测试数据。

上面的代码现在应该适合你了。

# html - 如何使用 CSS 为文本宽度而不是整个元素的宽度设置背景颜色？

> ID：14310154
> 
> 赞同：182
> 
> 时间：2013-01-14T01:09:31.587
> 
> 标签：html, css

我想要的是将绿色背景放在文本后面，而不是 100% 的页面宽度。这是我当前的代码：

```
h1 { 
    text-align: center; 
    background-color: green; 
}
```

```
<h1>The Last Will and Testament of Eric Jones</h1> 
```

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2013-01-14T01:12:26.747

将文本放入[内联元素](http://www.htmlhelp.com/reference/html40/inline.html)中，例如`<span>`.

```
<h1><span>The Last Will and Testament of Eric Jones</span></h1> 
```

然后在内联元素上应用背景颜色。

```
h1 {
    text-align: center; 
}
h1 span { 
    background-color: green; 
} 
```

内联元素与其内容一样大，因此应该为您完成。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2015-10-03T06:17:29.340

# 选项1

**`display: table;`**

*   不需要父母

```
h1 {
    display: table; /* keep the background color wrapped tight */
    margin: 0px auto 0px auto; /* keep the table centered */
    padding:5px;font-size:20px;background-color:green;color:#ffffff;
}
```

```
<h1>The Last Will and Testament of Eric Jones</h1>
```

**小提琴**

[http://jsfiddle.net/J7VBV/293/](http://jsfiddle.net/J7VBV/293/)

**更多的**

`display: table`告诉元素表现得像一个普通的 HTML 表格。

在[w3schools](http://www.w3schools.com/cssref/pr_class_display.asp)、[CSS Tricks](https://css-tricks.com/almanac/properties/d/display/#display-table)和[这里了解更多信息](http://www.mattboldt.com/kicking-ass-with-display-table/)

* * *

# 选项 2

**`display: inline-flex;`**

*   需要`text-align: center;`父母

```
.container {
    text-align: center; /* center the child */
}
h1 {
    display: inline-flex; /* keep the background color wrapped tight */
    padding:5px;font-size:20px;background-color:green;color:#ffffff;
}
```

```
<div class="container">
  <h1>The Last Will and Testament of Eric Jones</h1>
</div>
```

* * *

# 选项 3

**`display: flex;`**

*   需要一个弹性父容器

```
.container {
  display: flex;
  justify-content: center; /* center the child */
}
h1 {
    display: flex;
    /* margin: 0 auto; or use auto left/right margin instead of justify-content center */
    padding:5px;font-size:20px;background-color:green;color:#ffffff;
}
```

```
 <div class="container">
      <h1>The Last Will and Testament of Eric Jones</h1>
    </div>
```

**关于**

可能最流行的 Flexbox 指南和我经常参考的指南是[CSS Tricks](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

* * *

# 选项 4

**`display: block;`**

*   需要一个弹性父容器

```
.container {
  display: flex;
  justify-content: center; /* centers child */
}
h1 {
    display: block;
    padding:5px;font-size:20px;background-color:green;color:#ffffff;
}
```

```
<div class="container">
  <h1>The Last Will and Testament of Eric Jones</h1>
</div>
```

* * *

# 选项 5

**`::before`**

*   需要在 css 文件中输入单词（不是很实用）

```
h1 {
    display: flex; /* set a flex box */
    justify-content: center; /* so you can center the content like this */
}

h1::before {
    content:'The Last Will and Testament of Eric Jones'; /* the content */
    padding: 5px;font-size: 20px;background-color: green;color: #ffffff;
}
```

```
<h1></h1>
```

**小提琴**

[http://jsfiddle.net/J7VBV/457/](http://jsfiddle.net/J7VBV/457/)

**关于**

更多关于 css 伪元素 ::before 和 ::after 在[CSS Tricks](https://css-tricks.com/almanac/selectors/a/after-and-before/)和伪元素在[w3schools](http://www.w3schools.com/css/css_pseudo_elements.asp)

* * *

# 选项 6

**`display: inline-block;`**

*   `position: absolute`以和为中心`translateX`

*   需要`position: relative`父母

```
.container {
  position: relative; /* required for absolute positioned child */
}
h1 {
  display: inline-block; /* keeps container wrapped tight to content */
  position: absolute; /* to absolutely position element */
  top: 0;
  left: 50%; /* part1 of centering with translateX/Y */
  transform: translateX(-50%); /* part2 of centering with translateX/Y */
  white-space: nowrap; /* text lines will collapse without this */
  padding:5px;font-size:20px;background-color:green;color:#ffffff;
}
```

```
 <h1>The Last Will and Testament of Eric Jones</h1>
```

**关于**

[在这篇 CSS 技巧文章](https://css-tricks.com/centering-css-complete-guide/#both-unknown)中更多关于居中`transform: translate();`（和一般居中）

* * *

# 选项 7

**`text-shadow:`和`box-shadow:`**

*   不是 OP 想要的，但可能有助于其他人在这里找到自己的方式。

```
h1, h2, h3, h4, h5 {display: table;margin: 10px auto;padding: 5px;font-size: 20px;color: #ffffff;overflow:hidden;}
h1 {
    text-shadow: 0 0 5px green,0 0 5px green,
                 0 0 5px green,0 0 5px green,
                 0 0 5px green,0 0 5px green,
                 0 0 5px green,0 0 5px green;
}
h2 {
    text-shadow: -5px -5px 5px green,-5px 5px 5px green,
                  5px -5px 5px green,5px 5px 5px green;
}
h3 {
    color: hsla(0, 0%, 100%, 0.8);
    text-shadow: 0 0 10px hsla(120, 100%, 25%, 0.5),
                 0 0 10px hsla(120, 100%, 25%, 0.5),
                 0 0 10px hsla(120, 100%, 25%, 0.5),
                 0 0 5px hsla(120, 100%, 25%, 1),
                 0 0 5px hsla(120, 100%, 25%, 1),
                 0 0 5px hsla(120, 100%, 25%, 1);
}
h4 { /* overflow:hidden is the key to this one */
    text-shadow: 0px 0px 35px green,0px 0px 35px green,
                 0px 0px 35px green,0px 0px 35px green;
}
h5 { /* set the spread value to something larger than you'll need to use as I don't believe percentage values are accepted */
  box-shadow: inset 0px 0px 0px 1000px green;
}
```

```
<h1>The First Will and Testament of Eric Jones</h1>
<h2>The 2nd Will and Testament of Eric Jones</h2>
<h3>The 3rd Will and Testament of Eric Jones</h3>
<h4>The Last Will and Testament of Eric Jones</h4>
<h5>The Last Box and Shadow of Eric Jones</h5>
```

**小提琴**

[https://jsfiddle.net/Hastig/t8L9Ly8o/](https://jsfiddle.net/Hastig/t8L9Ly8o/)

# 更多的选择

通过结合上述不同的显示选项和居中方法，还有其他一些方法可以解决此问题。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2013-11-28T03:47:29.700

游戏有点晚了，但我想我会加我的 2 美分......

为避免添加内部跨度的额外标记，您可以将`<h1>`显示属性从更改`block`为`inline`（注意，您必须确保`<h1>`块元素之后的元素。

**HTML**

```
<h1>  
The Last Will and Testament of
Eric Jones</h1> 
<p>Some other text</p> 
```

**CSS**

```
h1{
    display:inline;
    background-color:green;
    color:#fff;
} 
```

**结果**
![在此处输入图像描述](../Images/1d62af5075c9040bb641fdd3746454c9.png)
JSFIDDLE [http://jsfiddle.net/J7VBV/](http://jsfiddle.net/J7VBV/)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-12-03T16:54:56.987

正如其他答案所指出的，您可以在文本周围添加 a`background-color`以使其正常工作。`<span>`

在你有的情况下`line-height`，你会看到差距。要解决此问题，您可以`box-shadow`在跨度中添加一点点增长。您还希望`box-decoration-break: clone;`FireFox 能够正确渲染它。

编辑：如果您在 IE11 中遇到 box-shadow 问题，请尝试`outline: 1px solid [color];`仅为 IE 添加一个。

这是它的实际效果：

[![css技术的例子](../Images/4c288668e4b416206b0023e42aacedba.png)](https://i.stack.imgur.com/dGsob.png)

```
.container {
  margin: 0 auto;
  width: 400px;
  padding: 10px;
  border: 1px solid black;
}

h2 {
  margin: 0;
  padding: 0;
  font-family: Verdana, sans-serif;
  text-transform: uppercase;
  line-height: 1.5;
  text-align: center;
  font-size: 40px;
}

h2 > span {
  background-color: #D32;
  color: #FFF;
  box-shadow: -10px 0px 0 7px #D32,
    10px 0px 0 7px #D32,
    0 0 0 7px #D32;
  box-decoration-break: clone;
}
```

```
<div class="container">
    <h2><span>A HEADLINE WITH BACKGROUND-COLOR PLUS BOX-SHADOW :3</span></h2>
</div>
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-01-14T01:12:51.513

这样做的一个非常简单的技巧是添加`<span>`标签并为其添加背景颜色。它看起来就像你想要的那样。

```
<h1>  
    <span>The Last Will and Testament of Eric Jones</span>
</h1> 
```

和 CSS

```
h1 { text-align: center; }
h1 span { background-color: green; } 
```

### **为什么？**

`<span>`内联元素标签中的标签，因此它只会跨越伪造效果的内容。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-09-08T00:10:56.263

# 编辑：下面的答案适用于大多数情况。然而，OP 后来提到他们无法编辑 CSS 文件以外的任何内容。但是会把它留在这里，这样它可能对其他人有用。

[![在此处输入图像描述](../Images/7e0f4f36affa929e05f1b0e5725295a0.png)](https://i.stack.imgur.com/BPjWz.png)

其他人忽略的主要考虑因素是 OP 已经声明他们不能修改 HTML。

您可以在 DOM 中定位您需要的内容，然后使用 javascript 动态添加类。然后根据需要设计样式。

在我制作的一个示例中，我`<p>`使用 jQuery 定位所有元素，并用带有“colored”类的 div 包装它

```
$( "p" ).wrap( "<div class='colored'></div>" ); 
```

然后在我的 CSS 中，我定位到`<p>`并给它背景颜色并更改为`display: inline`

```
.colored p {
    display: inline;
    background: green;
} 
```

通过将显示设置为内联，您会丢失一些通常会继承的样式。因此，请确保您针对最具体的元素并设置容器样式以适应您设计的其余部分。这只是作为一个工作起点。小心使用。[CodePen](https://codepen.io/anon/pen/mMZwWG)上的工作演示

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-01-14T01:14:30.750

h1 是块级元素。您将需要使用像 span 这样的东西，因为它是一个内联级元素（即：它不跨越整行）。

在你的情况下，我建议如下：

样式.css

```
.highlight 
{
   background-color: green;
} 
```

html

```
<span class="highlight">only the text will be highlighted</span> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-01-14T01:12:42.013

尝试删除文本对齐中心并将文本居中`<h1>`或`<div>`文本所在的中心。

```
h1 {
    background-color:green;
    margin: 0 auto;
    width: 200px;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-05-05T10:04:03.863

可以在段落和标题标签中使用 html5**标记**标签。

```
<p>lorem ipsum <mark>Highlighted Text</mark> dolor sit.</p>
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-11-27T00:48:57.763

您可以使用 HTML5`<mark>`标记。

**HTML：**

```
<h1><mark>The Last Will and Testament of Eric Jones</mark></h1> 
```

**CSS：**

```
mark
{
    background-color: green;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-12-21T14:45:11.973

## 容易地 ：

```
<p>lorem ibsum....</p> 
```

风格：

```
p{
    background-color: #eee;
    display: inline;
} 
```

* * *

背景设置为元素的整个大小；[从这里](https://developer.mozilla.org/en-US/docs/Web/HTML/Inline_elements)修改内联元素和块元素之间的差异

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-03-17T05:25:46.007

试试这个：

```
h1 {
    text-align: center;
    background-color: green;
    visibility: hidden;
}

h1:after {
    content:'The Last Will and Testament of Eric Jones';
    visibility: visible;
    display: block;
    position: absolute;
    background-color: inherit;
    padding: 5px;
    top: 10px;
    left: calc(30% - 5px);
} 
```

请注意，**calc**并非与所有浏览器都兼容 :) 只是想与原始帖子中的对齐方式保持一致。

[https://jsfiddle.net/richardferaro/ssyc04o4/](https://jsfiddle.net/richardferaro/ssyc04o4/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-12T05:41:19.647

你必须提到h1标签的宽度..

你的CSS会是这样的

```
h1 {
text-align: center;
background-color: green;
width: 600px;
 } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-01-23T15:02:20.183

**HTML**

```
<h1>
  <span>
    inline text<br>
      background padding<br>
      with box-shadow
  </span>
</h1> 
```

**CSS**

```
h1{
  font-size: 50px;
  padding: 13px; //Padding on the sides so as not to stick.

  span {  
    background: #111; // background color
    color: #fff;
    line-height: 1.3; //The height of indents between lines.
    box-shadow: 13px 0 0 #111, -13px 0 0 #111; // Indents for each line on the sides.
  }
} 
```

[在 codepen 上演示](https://codepen.io/tiigrus/pen/wNBLgN)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-24T23:17:54.987

HTML

```
<h1 class="green-background"> Whatever text you want. </h1> 
```

CSS

```
.green-background { 
    text-align: center;
    padding: 5px; /*Optional (Padding is just for a better style.)*/
    background-color: green; 
} 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2019-12-04T12:17:38.413

```
<h1 style="display:inline-block;text-align: center;background : red;">The Last Will and Testament of Eric Jones</h1>
```

# haskell - System.Plugins 加载器似乎在看到一次失败后假设失败

> ID：14310155
> 
> 赞同：6
> 
> 时间：2013-01-14T01:09:50.390
> 
> 标签：haskell, compiler-construction, interpreter, dynamic-compilation

我目前正在开发一个 haskell 程序，该程序从文本框中获取用户输入，然后使用[System.Plugins](http://hackage.haskell.org/package/plugins-1.5.1.4)库编译和加载它，以便提取图片以绘制到屏幕上。用户可以在文本框中编辑代码，然后通过单击编译按钮重新加载他们的新图像。这是单击编译按钮时触发的代码：

```
compileText :: SourceView -> SOE.Window -> IO ()
compileText tview w = do 
    txtBuff <- textViewGetBuffer tview
    startIt <- textBufferGetStartIter txtBuff
    endIt <- textBufferGetEndIter txtBuff
    compTime <- getClockTime
    srcString <- textBufferGetByteString txtBuff startIt endIt False

    BS.writeFile "Test.hs" srcString
    mkStat <- make "Test.hs" []
    case mkStat of
        MakeSuccess cd fp -> print fp
        MakeFailure (er1:er2:errs) -> error er2

    loadResult <- getModule
    case loadResult of
        Right (md, pic) -> do
                runGraphics $ do
                    draw3 "gtk test" pic w
                unload md
        Left errors -> print errors
    return ()

getModule :: IO (Either [String] (Module, Picture))
getModule = do 
               mv <- load "Test.o" ["."] [] "pic"
               case mv of
                    LoadFailure messages -> return (Left messages)
                    LoadSuccess x y -> return (Right (x, y)) 
```

这是用户在文本框中输入的一些示例代码：

```
module Test where
    import Picture

    r1,r2,r3,r4 :: Region
    r1 = Shape(Rectangle 2 1)
    r2 = Shape(Ellipse 2 1.5)
    r3 = Shape(RtTriangle 3 2)
    r4 = Shape(Polygon [(-2.5, 2.5), (-3.0,0), (-1.7,-1.0), (-1.1,0.2),(-1.5,2.0)])

    p1,p2,p3,p4 :: Picture
    p1 = Region Red r1
    p2 = Region Green r2
    p3 = Region Blue r3
    p4 = Region Yellow r4

    pics :: Picture
    pics = foldl Over EmptyPic [p1,p2,p3,p4] 
```

如果用户编写的代码每次都能正确编译和加载，这一切都按预期工作。但是，当用户编写一段无法加载的代码时（我一直在玩的示例是将 'pic' 更改为 'pics'，因此它无法找到要加载的 pic 函数）预期的行为是程序将打印加载错误到屏幕，以便用户可能更正他们的代码并尝试再次单击编译按钮。

然而，实际发生的情况是，一旦程序遇到一次 LoadFailure，所有后续点击编译按钮的尝试都会导致加载失败消息，无论代码是否正确！

我不太确定这里到底发生了什么，但似乎该程序保留了从评估到评估的先前结果的一些记忆。如何获得我正在寻找的行为？

**编辑：**我试图通过编写一个小测试用例来隔离问题，该用例说明了我在不使用 gtk 的情况下遇到的问题

```
import Control.Monad
import System.Time
import System.IO
import qualified Data.ByteString as BS
import qualified Data.ByteString.Char8 as BSC

import System.Plugins.Make
import System.Plugins.Load
import System.Eval.Haskell

testCaseCorrect :: String
testCaseCorrect = "module Test where\n printGreeting :: String -> IO ()\n printGreeting greeting = print greeting"

-- This should cause load to fail as it will not be able to find the
-- printGreeting function
testCaseIncorrect :: String
testCaseIncorrect = "module Test where\n printGurting :: String -> IO ()\n printGurting greeting = print greeting"

main :: IO ()
main = do
    BS.writeFile "Test.hs" (BSC.pack testCaseCorrect)
    mkStat <- make "Test.hs" []

    case mkStat of
        MakeSuccess cd fp -> print fp
        MakeFailure (er1:er2:errs) -> error er2

    loadResult <- getModule
    case loadResult of
        Right (md, greeter) -> do
                greeter "Hi there"
                unload md
        Left errors -> print errors

    BS.writeFile "Test.hs" (BSC.pack testCaseIncorrect)

    mkStat2 <- make "Test.hs" []

    case mkStat2 of
        MakeSuccess cd fp -> print fp
        MakeFailure (er1:er2:errs) -> error er2

    loadResult2 <- getModule
    case loadResult2 of
        Right (md, greeter) -> do
                greeter "Hi there"
                unload md
        Left errors -> print errors

    BS.writeFile "Test.hs" (BSC.pack testCaseCorrect)
    mkStat3 <- make "Test.hs" []

    case mkStat3 of
        MakeSuccess cd fp -> print fp
        MakeFailure (er1:er2:errs) -> error er2

    loadResult3 <- getModule
    case loadResult3 of
        Right (md, greeter) -> do
                greeter "Hi there"
                unload md
        Left errors -> print errors

getModule :: IO (Either [String] (Module, String -> IO()))
getModule = do 
               mv <- load "Test.o" ["."] [] "printGreeting"
               case mv of
                    LoadFailure messages -> return (Left messages)
                    LoadSuccess x y -> return (Right (x, y)) 
```

此代码产生结果：

```
"Test.o"
"Hi there"
"Test.o"
["load: couldn't find symbol <<printGreeting>>"]
"Test.o"
["load: couldn't find symbol <<printGreeting>>"] 
```

即它设法复制错误

**编辑2：**似乎在一些完全相同的代码运行它也会产生输出：

```
"Test.o"
"Hi there"
"Test.o"
"Hi there"
"Test.o"
"Hi there" 
```

但我认为这可能是由于连续编译一起运行得如此之快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-31T15:08:36.900

我使用[更新版本的插件库](https://github.com/Changaco/haskell-plugins)复制了该问题，并隔离了三个原因。

首先，用于检查模块是否需要重新编译的[getModificationTime 函数精度不足（秒）。](http://hackage.haskell.org/packages/archive/directory/latest/doc/html/System-Directory.html#v%3agetModificationTime)

其次，GHC 似乎也犯了同样的错误。

第三，正如 Don Stewart 所说，模块需要卸载，这并不容易，因为 API 没有给你直接引用它。

我通过在符号查找失败时自动卸载模块来解决我的存储库中的第三个问题。修复其他两个的正确方法可能是修补上游。

# infopath - infopath：如果所有选项都被过滤掉，则隐藏控件

> ID：14310159
> 
> 赞同：0
> 
> 时间：2013-01-14T01:10:14.707
> 
> 标签：infopath, infopath-2007

在 infopath 中，我有一个选择框，可以从经过过滤的辅助数据源中选择值。

如果没有与过滤器匹配的内容，如何使控件隐藏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T03:50:40.993

您可以使用 count 函数将字段设置为过滤器的计数值，然后如果该字段读取为 0，则隐藏控件。

# css - 使用精灵图像背景时将链接文本断开到底部

> ID：14310162
> 
> 赞同：0
> 
> 时间：2013-01-14T01:10:37.663
> 
> 标签：css

这是我的导航：

```
<ul>
    <li class="home"><a href="">Home</a></li>
    <li class="projects"><a href="">Projects</a></li>
    <li class="about"><a href="">About</a></li>
</ul> 
```

我使用一个精灵图像，每个链接都有简单的悬停形状。

```
ul li a {
    background-repeat: no-repeat;
    background-image: url(../images/sprite.png);
    display: inline-block;
    outline: none;
    text-decoration: none;
    width: 51px;
    height: 51px;
    color: #a5a4a4;
}
ul li.home a {
    background-position: 0px 0px;
}
ul li.home a:hover  {
    background-position: 0px -51px;
} 
```

**我想将链接文本断开到每个`51x51`像素方块的底部。也许它需要增加`a`标签的高度，但是精灵图像的另一部分不应该显示。**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:15:00.063

在那里设置`padding-top: 51px;`和放置背景。如果精灵的其他部分正在显示，那么您应该使图像更加分离。

# c++ - std::cbrt 的舍入错误？

> ID：14310163
> 
> 赞同：0
> 
> 时间：2013-01-14T01:10:42.607
> 
> 标签：c++, c++11, standards-compliance, rounding-error, cmath

我想知道是否应该将以下内容报告为标准库的 gcc 实现中的错误。

对于所有无符号整数`i`，如果我们与整数`int(std::sqrt(i))`的实际平方根进行比较，转换总是会给出好的结果。如果我们对它做同样的`std::cbrt`事情，情况并非如此：

```
// Problem of rounding of std::cbrt for i from 0 to 100 million
// i, exact cbrt(i), result of int(std::cbrt(i))
2197, 13, 12
17576, 26, 25
24389, 29, 28
140608, 52, 51
185193, 57, 56
195112, 58, 57
226981, 61, 60
1092727, 103, 102
1124864, 104, 103
1442897, 113, 112
1481544, 114, 113
1560896, 116, 115
1685159, 119, 118
1815848, 122, 121
8741816, 206, 205
8869743, 207, 206
8998912, 208, 207
9393931, 211, 210
9938375, 215, 214
11543176, 226, 225
11852352, 228, 227
12487168, 232, 231
12649337, 233, 232
13481272, 238, 237
13651919, 239, 238
14348907, 243, 242
14526784, 244, 243
14706125, 245, 244
69426531, 411, 410
69934528, 412, 411
70957944, 414, 413
71991296, 416, 415
72511713, 417, 416
73560059, 419, 418
74618461, 421, 420
75151448, 422, 421
79507000, 430, 429
88121125, 445, 444
89314623, 447, 446
91733851, 451, 450
92345408, 452, 451
92959677, 453, 452
94818816, 456, 455
99897344, 464, 463 
```

您认为应该将其报告为缺陷吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:42:19.843

`std::cbrt`返回浮点类型（float、double 等），但您将其转换为`int`. 此类转换会截断而不是舍入，例如 0.9999 变为 0。尽管 2197 的立方根是整数似乎合乎逻辑，但由于浮点类型以二进制形式存储，因此并不总是可以完美地表示十进制数，并且这种不准确性可能会在`std::cbrt`执行的计算过程中传播。例如，如果`std::cbrt(2197) == 12.99999`（我的编译器不支持它，所以我无法检查实际值），那么通过将其转换为 an`int`您会将值截断为 12。

要更正您的代码，请`std::cbrt(i)`在将其转换为`int`. 有关如何做到这一点的想法，请参阅 [此问题。](https://stackoverflow.com/questions/485525/round-for-float-in-c)

# java - PriorityQueue addAll() 的复杂性

> ID：14310164
> 
> 赞同：8
> 
> 时间：2013-01-14T01:10:57.360
> 
> 标签：java, data-structures, heap, big-o, priority-queue

PriorityQueue 的 addAll 方法的复杂度是多少。它是一次添加一个元素导致 O(n log n) 还是使用构建堆过程在 O(n) 时间内从无序元素中创建一个堆？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-14T01:15:44.050

[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/PriorityQueue.html)似乎暗示它是从**[AbstractQueue](http://docs.oracle.com/javase/6/docs/api/java/util/AbstractQueue.html#addAll%28java.util.Collection%29)****`addAll`继承的**，它是**作为一个序列实现的**。

这使我相信**复杂性在于`O(mlogn)`**m 是插入集合的大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T01:17:34.897

从[优先队列](http://docs.oracle.com/javase/6/docs/api/java/util/PriorityQueue.html)

> ...此实现为入队和出队方法提供 O(log(n)) 时间...

所以你只能假设`n log(n)`。

然而——显然——这只是你可以假设的。根据您计划使用的具体实现，您可能会发现一些可以为您改善问题的技巧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T01:16:12.323

查看 OpenJDK，看起来 PriorityQueue 从 AbstractQueue 继承了 addAll 实现，它遍历集合并在每个元素上调用 add。

[资源](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/PriorityQueue.java)

# asp.net - 将 ASP.NET 网站预编译为 HTML、CSS、javascript 等静态文件

> ID：14310168
> 
> 赞同：0
> 
> 时间：2013-01-14T01:11:08.680
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2010, html

有没有办法将一个简单的 ASP.NET 网站（不使用 asp webform 或任何 .net 控件）预编译成静态文件，如 HTML、CSS、javascripts？

我之所以这样问，是因为我想利用母版页功能和一些 Visual Studio IDE 智能感知，同时又不放弃将输出部署到 Linux 和 Window 服务器的灵活性。

我在这里找到了一个手动解决方案，但很想知道是否有其他工具可以帮助做到这一点 - [http://www.c-sharpcorner.com/UploadFile/sd_patel/OutputASPtoHTML11242005063740AM/OutputASPtoHTML.aspx](http://www.c-sharpcorner.com/UploadFile/sd_patel/OutputASPtoHTML11242005063740AM/OutputASPtoHTML.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T03:47:32.800

如果您只想将您的 ASP.Net 站点转换为静态文件，有许多“网站下载器”实用程序可以获取 URL 并在本地下载站点的所有资源。我使用的是[HTTrack](http://www.httrack.com/page/2/)。

您将从 Visual Studio 运行您的网站，从浏览器复制 url，然后将该 url 提供给 HTTrack 进行下载。（请注意，HTTrack 会对下载的 HTML 进行一些更改，以便可以将其保存在本地。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T03:31:03.397

您可以（据称）在 Linux 上运行 .net。[请参阅 Mono](http://www.mono-project.com/Main_Page)或更具体地说，[http://www.mono-project.com/Start](http://www.mono-project.com/Start)。它不完全是您正在寻找的东西，但可能会实现相同的目标。

# php - 如果 php 自动为您执行此操作，是否需要将类中的属性初始化为 null？

> ID：14310171
> 
> 赞同：4
> 
> 时间：2013-01-14T01:11:16.537
> 
> 标签：php

对来自两个类中的任何一个的对象执行 var_dump 会产生相同的结果

```
Class Node{
    public $parent = null;
    public $right = null;
    public $left = null;        
    function __construct($data){
        $this->data = $data;                    
    }
}

Class Node{
    public $parent;
    public $right;
    public $left;        
    function __construct($data){
        $this->data = $data;                    
    }
} 
```

例如

```
$a = new Node(2);
var_dump($a); 
```

为上述任一类返回以下内容

```
object(Node)#1 (4) {
  ["parent"]=>
  NULL
  ["right"]=>
  NULL
  ["left"]=>
  NULL
  ["data"]=>
  int(2)
} 
```

这似乎不是变量的情况。

```
$b;
var_dump($b); 
```

如果您打算让该属性的值为 ，`null`是否需要显式编写，因为 php 似乎会自动为您执行此操作？

另外 - 根据这个答案[https://stackoverflow.com/a/6033090/784637](https://stackoverflow.com/a/6033090/784637)，如果您尝试获取未初始化变量的值，C++ 会给出未定义的行为。如果该属性未初始化为值，C++ 是否会自动将类中属性的值设置为`null`php 的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:14:17.537

不，不需要将它们初始化为`null`——PHP 会自动执行此操作，并且您自己执行不会产生任何明显的差异。

C++ 不会将类字段的值设置为`null`（C++ 中实际上没有“真实”`null`值，除非您[`nullptr`](https://stackoverflow.com/questions/1282295/what-exactly-is-nullptr)在 C++ 11 中计算）；它对它们*进行零初始化*或*值初始化*，这是不一样的。[您可以在此处](https://stackoverflow.com/questions/14259602/default-values-in-c-initializer-lists/14259765#14259765)阅读有关零初始化和值初始化的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T01:59:22.400

为自己节省击键；无需将属性的初始值设置为 null。在 PHP 内部 AFAIK 中，如果您没有明确设置属性，则属性已经分配为 null；你的 var_dump 证明了这一点。类属性与 PHP 中的原始变量不同，因此您的 var_dump 结果会有所不同。

但是，这样做似乎并没有什么害处。我曾经在我的 Doctrine 实体类中将它们设置为 null，它在实体生命周期的任何阶段都没有区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T01:14:27.613

不，在 PHP 中没有 undefined 之类的东西，所以如果你不使用 null 初始化也是一样的。有些人已经习惯了其他编程语言，或者只是为了确保而编写它，但没有区别。

C++ 非常不同，但我没有足够的知识来给你一个答案。

# python - Python：将信息从 xml 提取到字典

> ID：14310172
> 
> 赞同：0
> 
> 时间：2013-01-14T01:11:20.833
> 
> 标签：python, xml, list, dictionary, extract

我需要从 xml 文件中提取信息，将其与前后的 xml 标签隔离，将信息存储在字典中，然后循环遍历字典以打印列表。我是一个绝对的初学者，所以我想让它尽可能简单，如果我描述的我想做的事情没有多大意义，我深表歉意。

这是我到目前为止所拥有的。

```
for line in open("/people.xml"):
if "name" in line:
    print (line)
if "age" in line:
    print(line) 
```

电流输出：

```
 <name>John</name>

  <age>14</age>

    <name>Kevin</name>

  <age>10</age>

    <name>Billy</name>

  <age>12</age> 
```

期望的输出

```
Name          Age
John          14
Kevin         10
Billy         12 
```

编辑 - 所以使用下面的代码我可以得到输出：

```
{'Billy': '12', 'John': '14', 'Kevin': '10'} 
```

有谁知道如何从这个得到一个带有我想要的输出标题的图表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T05:19:57.280

尝试[xmldict](https://github.com/thoughtnirvana/xmldict)（将 xml 转换为 python 字典，反之亦然。）：

```
>>> xmldict.xml_to_dict('''
... <root>
...   <persons>
...     <person>
...       <name first="foo" last="bar" />
...     </person>
...     <person>
...       <name first="baz" last="bar" />
...     </person>
...   </persons>
... </root>
... ''')
{'root': {'persons': {'person': [{'name': {'last': 'bar', 'first': 'foo'}}, {'name': {'last': 'bar', 'first': 'baz'}}]}}}

# Converting dictionary to xml 
>>> xmldict.dict_to_xml({'root': {'persons': {'person': [{'name': {'last': 'bar', 'first': 'foo'}}, {'name': {'last': 'bar', 'first': 'baz'}}]}}})
'<root><persons><person><name><last>bar</last><first>foo</first></name></person><person><name><last>bar</last><first>baz</first></name></person></persons></root>' 
```

或尝试[xmlmapper](https://github.com/namitkewat/xmlmapper)（具有父子关系的 python 字典列表）：

```
 >>> myxml='''<?xml version='1.0' encoding='us-ascii'?>
          <slideshow title="Sample Slide Show" date="2012-12-31" author="Yours Truly" >
          <slide type="all">
              <title>Overview</title>
              <item>Why
                  <em>WonderWidgets</em>
                     are great
                  </item>
                  <item/>
                  <item>Who
                  <em>buys</em>
                  WonderWidgets1
              </item>
          </slide>
          </slideshow>'''
  >>> x=xml_to_dict(myxml)
  >>> for s in x:
          print s
  >>>
  {'text': '', 'tail': None, 'tag': 'slideshow', 'xmlinfo': {'ownid': 1, 'parentid': 0}, 'xmlattb': {'date': '2012-12-31', 'author': 'Yours Truly', 'title': 'Sample Slide Show'}}
  {'text': '', 'tail': '', 'tag': 'slide', 'xmlinfo': {'ownid': 2, 'parentid': 1}, 'xmlattb': {'type': 'all'}}
  {'text': 'Overview', 'tail': '', 'tag': 'title', 'xmlinfo': {'ownid': 3, 'parentid': 2}, 'xmlattb': {}}
  {'text': 'Why', 'tail': '', 'tag': 'item', 'xmlinfo': {'ownid': 4, 'parentid': 2}, 'xmlattb': {}}
  {'text': 'WonderWidgets', 'tail': 'are great', 'tag': 'em', 'xmlinfo': {'ownid': 5, 'parentid': 4}, 'xmlattb': {}}
  {'text': None, 'tail': '', 'tag': 'item', 'xmlinfo': {'ownid': 6, 'parentid': 2}, 'xmlattb': {}}
  {'text': 'Who', 'tail': '', 'tag': 'item', 'xmlinfo': {'ownid': 7, 'parentid': 2}, 'xmlattb': {}}
  {'text': 'buys', 'tail': 'WonderWidgets1', 'tag': 'em', 'xmlinfo': {'ownid': 8, 'parentid': 7}, 'xmlattb': {}} 
```

上面的代码将给出生成器。当你迭代它时；您将获得`dict`密钥中的信息；像`tag`, `text`,和`xmlattb`中`tail`的附加信息`xmlinfo`。这里`root`元素的`parentid`信息为`0`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:38:20.450

为此使用[XML 解析器](http://docs.python.org/2/library/xml.etree.elementtree.html#parsing-xml)。例如，

```
import xml.etree.ElementTree as ET
doc = ET.parse('people.xml')
names = [name.text for name in doc.findall('.//name')]
ages = [age.text for age in doc.findall('.//age')]
people = dict(zip(names,ages))
print(people)
# {'Billy': '12', 'John': '14', 'Kevin': '10'} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T05:14:22.767

在我看来，这是一个学习如何手动解析 XML 的练习，而不是简单地从包里拿出一个库来为您解析。如果我错了，我建议观看 Steve Huffman 的 udacity 视频，可以在这里找到：[http](http://www.udacity.com/view#Course/cs253/CourseRev/apr2012/Unit/362001/Nugget/365002) ://www.udacity.com/view#Course/cs253/CourseRev/apr2012/Unit/362001/Nugget/365002 。他解释了如何使用 minidom 模块来解析诸如此类的轻量级 xml 文件。

现在，我想在回答中提出的第一点是，您不想创建一个 python 字典来打印所有这些值。python 字典只是一组与值相对应的键。它们没有顺序，因此按它们在文件中出现的顺序遍历是一件很痛苦的事。您正在尝试打印出所有姓名及其相应的年龄，因此像元组列表这样的数据结构可能更适合整理您的数据。

似乎您的 xml 文件的结构是这样的，每个名称标签后面都有一个与之对应的年龄标签。每行似乎也只有一个名称标签。这使事情变得相当简单。我不会为这个问题写出最有效或最通用的解决方案，而是尽量让代码尽可能简单易懂。

所以让我们首先创建一个列表来存储数据：

然后让我们创建一个列表来存储数据：a_list = []

现在打开你的文件，初始化几个变量来保存每个名字和年龄：

```
from __future__ import with_statement

with open("/people.xml") as f:
    name, age = None, None #initialize a name and an age variable to be used during traversals.
    for line in f:
        name = extract_name(line,name) # This function will be defined later.
        age = extract_age(line) # So will this one.
        if age: #We know that if age is defined, we can add a person to our list and reset our variables
            a_list.append( (name,age) ) # and now we can re-initialize our variables.
            name,age = None , None # otherwise simply read the next line until age is defined. 
```

现在对于文件中的每一行，我们想确定它是否包含用户。如果是这样，我们想提取名称。让我们创建一个用于执行此操作的函数：

```
def extract_name(a_line,name): #we pass in the line as well as the name value that that we defined before beginning our traversal.
    if name: # if the name is predefined, we simply want to keep the name at its current value. (we can clear it upon encountering the corresponding age.)
        return name
    if not "<name>" in a_line: #if no "<name>" in a_line, return. otherwise, extract new name.
        return
    name_pos = a_line.find("<name>")+6
    end_pos = a_line.find("</name>")
    return a_line[name_pos:end_pos] 
```

现在，我们必须创建一个函数来解析用户年龄的行。我们可以用与前面的函数类似的方式来做这件事，但是我们知道一旦我们有了一个年龄，它就会立即被添加到列表中。因此，我们永远不需要关心年龄的先前值。因此，该函数可能如下所示：

```
def extract_age(a_line):
    if not "<age>" in a_line: #if no "<age>" in a_line:
        return
    age_pos = a_line.find("<age>")+5 # else extract age from line and return it.
    end_pos = a_line.find("</age>")
    return a_line[age_pos:end_pos] 
```

最后，您要打印列表。你可以这样做：

```
for item in a_list:
    print '\t'.join(item) 
```

希望这有帮助。我还没有测试我的代码，所以它可能仍然有点错误。不过，这些概念就在那里。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-15T19:10:10.207

*这是使用lxml*库的另一种方式：

```
from lxml import objectify

def xml_to_dict(xml_str):
    """ Convert xml to dict, using lxml v3.4.2 xml processing library, see http://lxml.de/ """
    def xml_to_dict_recursion(xml_object):
        dict_object = xml_object.__dict__
        if not dict_object:  # if empty dict returned
            return xml_object
        for key, value in dict_object.items():
            dict_object[key] = xml_to_dict_recursion(value)
        return dict_object
    return xml_to_dict_recursion(objectify.fromstring(xml_str))

xml_string = """<?xml version="1.0" encoding="UTF-8"?><Response><NewOrderResp>
<IndustryType>Test</IndustryType><SomeData><SomeNestedData1>1234</SomeNestedData1>
<SomeNestedData2>3455</SomeNestedData2></SomeData></NewOrderResp></Response>"""

print xml_to_dict(xml_string) 
```

要保留父节点，请改用：

```
def xml_to_dict(xml_str):
    """ Convert xml to dict, using lxml v3.4.2 xml processing library, see http://lxml.de/ """
    def xml_to_dict_recursion(xml_object):
        dict_object = xml_object.__dict__
        if not dict_object:  # if empty dict returned
            return xml_object
        for key, value in dict_object.items():
            dict_object[key] = xml_to_dict_recursion(value)
        return dict_object
    xml_obj = objectify.fromstring(xml_str)
    return {xml_obj.tag: xml_to_dict_recursion(xml_obj)} 
```

如果您只想返回一个子树并将其转换为 dict，您可以使用*Element.find()*：

```
xml_obj.find('.//')  # lxml.objectify.ObjectifiedElement instance 
```

请参阅[lxml 文档](http://lxml.de/)。

# c# - Sqlclient 与 EntityClient

> ID：14310183
> 
> 赞同：18
> 
> 时间：2013-01-14T01:12:49.377
> 
> 标签：c#, .net, entity-framework-4, ado.net

任何人都可以说出 sqlclient 与 entityclient（sys.data.sqlclient 与 sys.data.entityclient）之间的确切区别吗？

# asp.net-mvc - 为什么在 MVC4 中有些人使用 ViewModels？

> ID：14310189
> 
> 赞同：0
> 
> 时间：2013-01-14T01:13:30.030
> 
> 标签：asp.net-mvc, asp.net-mvc-4, radio-button

我来自使用 MVVM 进行 WPF 编程，所以这是我在 ASP.NET 中使用 MVC 的第一次体验

我试图做的是展示这个模型：

```
public class MultipleChoiceQuestion : Question
{
    public string QuestionText
    public List<MultipleChoiceAnswer> PossibleAnswers { get; set; }
}

public class MultipleChoiceAnswer
{
    public string Text { get; set; }
    public string UrlImage { get; set; }
    public bool IsCorrect { get; set; }
} 
```

如您所见，我有一个`List<T>`，这里是我试图在 RadioButtons 中显示的地方。我在这个网站上搜索了一些数据，发现主要在 radioButtons 中使用 ViewModels。

[有没有人为 ASP.NET MVC 实现 RadioButtonListFor<T> ？](https://stackoverflow.com/questions/2512809/has-anyone-implement-radiobuttonlistfort-for-asp-net-mvc)

在这里使用 ViewModel 的目的是什么？以及如何在单选按钮中显示我的列表？这只是有点令人困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T01:34:09.340

关于人们为什么使用 ViewModel有很多[答案](https://stackoverflow.com/questions/664205/viewmodel-best-practices)。最直接的原因通常是您的视图所需的数据与您的业务模型中的数据不同。例如：

假设您的应用程序允许用户上传图像，然后将其保存到一些云存储中，例如[Azure Blob Storage](http://www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/)。存储在 blob 存储中的文件可通过以下形式的 URL 访问：`https://account.blob.core.windows.net/filename.png`

您的数据库模型可能类似于：

```
public class Image
{ 
    public int Id { get; set; }
    public string FileName { get; set; }
} 
```

在这里，您要保存图像的文件名。保存完整的 URL 会浪费空间，而且会将数据移动到其他位置非常困难。

然而，在显示图像时，您的视图需要完整的 URL。这就是 ViewModel 变得有用的地方。（请参阅下面有关如何避免在 ViewModel 中硬编码 URL 的注释）。

```
public class ImageViewModel
{
    public int Id { get; set; }
    public string FileName { get; set; }

    public string Url 
    {
        get { return "https://account.blob.core.windows.net/" + FileName; }
    }
} 
```

通过将此传递给视图，它现在拥有正确显示此图像所需的一切：

```
<h3>@Model.FileName</h3>
<img src="@Model.Url" alt="@Model.FileName"/> 
```

如果您曾经移动存储提供商，例如 Amazon S3 ( [https://account.s3.amazonaws.com/filename.png](https://account.s3.amazonaws.com/filename.png) )，您只需在一个地方更新 URL，您的视图完全不受影响

作为旁注，您可能希望将[AutoMapper](https://github.com/AutoMapper/AutoMapper)视为一种进一步简化事情的方法，并避免在 ViewModel 中硬编码 URL。AutoMapper 允许您定义映射模型 -> 视图模型的规则，包括设置默认值、展平对象等。

# node.js - 在 node.js 上使用 mongoose 以字符串为键的多对多关系

> ID：14310193
> 
> 赞同：1
> 
> 时间：2013-01-14T01:13:57.990
> 
> 标签：node.js, mongodb, reference, many-to-many, mongoose

我可以描述我所追求的最好方法是从一个简化的演示`page`文档开始：

```
{
    name: "Page Name"
    blocks: {
        "top-content": 50f0ded99561a3b211000001,
        "bottom-content": 50f0ded99561a3b211000002
    }
} 
```

有没有办法可以定义这种与猫鼬的多对多关系，以便我可以通过字符串键（如`top-content`and ）查找它们`bottom-content`？与此等效的关系类似于在多对多连接表中包含一个字符串。

重要的：

*   我不想嵌入我引用的块，因为它们可以被多个页面引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T14:20:45.683

Mongoose 的[查询填充](http://mongoosejs.com/docs/populate.html)功能支持这一点，但需要是 ObjectIds 而不是字符串（无论如何这更有效）`top-content`。`bottom-content`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T14:50:20.673

在 Freenode 上的#node.js 中聊天后，似乎我可以将其设置为一个数组并放置包含我想要的引用的任意键/值对。

到那时，我将自己取消引用。

```
{ //PAGE 1
  name:"Sticks",
  blocks:[
    "top":[OID(5),OID(6)],
    "bottom":[OID(7),OID(8)]
  ]
};
{ //PAGE 2
  name:"Poopsicles",
  blocks:[top:[OID(7)]]
};

//BLOCKS
{
  OID:5,
  name:"top"
};
{
  OID:7,
  name:"bottom rocker"
};

//QUERYING
page.findOne({name:"Sticks"}, function(e,d) {
  var a = [];
  for(l in d.blocks) {
    a.append(d.blocks[l]);
  }
  blocks.find({oid:a},function (e,b) {
    //do your stuff with the blocks and page here;
  });
}); 
```

# python - 如何在python中将二维位图转换为具有xy坐标的点 - 并且快速

> ID：14310195
> 
> 赞同：-1
> 
> 时间：2013-01-14T01:13:59.400
> 
> 标签：python, opencv, numpy, scipy

我正在使用 opencv/python 进行运动检测项目。我已经达到了创建图像位图/数组的地步，其中检测到的运动由数组中的 1 表示，0 表示没有运动（通过在短暂的延迟后从视频馈送中减去一张图片）。我希望通过使用 Numpy 的（或 opencv 的）kmeans 算法来确定我的移动目标（可能超过 1 个）。但是，这些算法需要输入要使用的 x,y 坐标数组。将二维图像位图数组转换为 xy 坐标数组的最快和最有效的方法是什么？（即我们在这里谈论图像处理，因此不希望使用慢速 Python 代码）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:16:59.197

Numpy[`nonzero`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.nonzero.html)会这样做：

这是文档中的一个示例：

```
>>> x = np.eye(3)
>>> x
array([[ 1.,  0.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]])
>>> np.nonzero(x)
(array([0, 1, 2]), array([0, 1, 2])) 
```

也就是说，输出是数组中非零元素的索引。

# j# - 编译错误

> ID：14310203
> 
> 赞同：0
> 
> 时间：2013-01-14T01:14:54.313
> 
> 标签：j#

```
private void Form1_Date (Object sender, System.EventArgs e)
{
System.TimeDate Date = System.DateTime.Get_Today();
} 
```

我有编译错误，没有具体说明实际问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:15:40.693

```
System.DateTime Date = System.DateTime.Get_Today(); 
```

# jquery - 禁用手风琴的锁定图标

> ID：14310204
> 
> 赞同：1
> 
> 时间：2013-01-14T01:14:59.693
> 
> 标签：jquery, jquery-ui, accordion

我禁用了特定的手风琴，并希望将它们的图标更改为 ui-icon-locked。

我有：

```
$(document).ready(function() {

   $(function() {
    $( "#accordion" ).accordion();

     $("#accordion").accordion("option", "icons",
        { 'header': 'ui-icon-circle-plus', 'headerSelected': 'ui-icon-circle-minus' });
        $( ".disabled" ).addClass("ui-state-disabled");
}); 
```

和：

```
 <h6 class="disabled">Bacteriology in practice: interactive modules</h6>
      <div>
        <p class="text"> Nam enim risus, molestie et, porta ac, aliquam ac, risus. Quisque lobortis.
          Phasellus pellentesque purus in massa. Aenean in pede. Phasellus ac libero
          ac tellus pellentesque semper. Sed ac felis. Sed commodo, magna quis
          lacinia ornare, quam ante aliquam nisi, eu iaculis leo purus venenatis dui. </p> 
```

我在css中尝试过：

```
.ui-accordion-header.disabled .ui-icon {
    ui-icon-locked;
} 
```

但这不起作用。

这也不起作用：

```
 $(function() {
    $( "#accordion" ).accordion();

     $("#accordion").accordion("option", "icons",
        { 'header': 'ui-icon-circle-plus', 'headerSelected': 'ui-icon-circle-minus' });
        $( ".disabled" ).addClass("ui-state-disabled");

 $(".disabled").accordion("option", "icons",
        { 'header': 'ui-icon-locked', 'headerSelected': 'ui-icon-locked' });
        $( ".disabled" ).addClass("ui-state-disabled");
}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:57:38.127

只需将 css 从复制`.ui-icon-locked`到`.ui-accordion-header.disabled .ui-icon`.

jQuery UI CSS 使用精灵表，因此您只需更改`background-position`即可将新图标显示在视图中。

# javascript - 在 Titanium 中从数据库创建多个按钮

> ID：14310207
> 
> 赞同：0
> 
> 时间：2013-01-14T01:15:07.707
> 
> 标签：javascript, titanium

我想要做的是为在我的 SQLite 数据库中找到的每一行创建一组按钮。我正在 iPad 模拟器上对此进行测试。使用钛 SDK 2.1.4

这是我所拥有的：

```
var currentWin = Ti.UI.currentWindow;

var db = Ti.Database.install('../databasename.sqlite', 'table'); //Install SQLite Database
var rows = db.execute('SELECT DISTINCT row FROM table');

var brandView = Ti.UI.createView({   //Primary view for buttons
        title: 'Hello',
        width: '100%',
        height: '100%'
});
currentWin.add(brandView);

for(var j = 0; j < rows.length; j++) {   //Pull DB Info
var buttonCount = new Array(rows.length);   //Create Button names
for(var i = 0; i < buttonCount.length; i++) {
    buttonCount[i] = Ti.UI.createButton({
        title: rows[j].name,
        width: 100,
        height: 100
    });
    brandView.add(buttonCount[i]);
}
} 
```

它加载没有任何错误，并加载窗口和我正在调用的视图但没有按钮。如何根据检索到的数据库信息创建一组按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:41:51.710

我不太了解您对 buttonCount 数组或两个 for 循环的使用。这行得通吗？

```
for(var j = 0; j < rows.length; j++) {
    var btn = Ti.UI.createButton({
        title: rows[j].name,
        width: 100,
        height: 100,
        top: j * 105 // space the buttons at 105
    });
    brandView.add(btn);
} 
```

# javascript - CKEditor TextArea 刷新和销毁

> ID：14310213
> 
> 赞同：0
> 
> 时间：2013-01-14T01:16:02.450
> 
> 标签：javascript, jquery, textarea, ckeditor

我遇到了一个问题，我的页面上有一个带有 CKEditor 的按钮。按下按钮时，我想将文本附加到编辑器。

我使用了以下代码：

```
$('#mtxDescription').append($(this).data('key'));
CKEDITOR.instances['mtxDescription'].updateElement(); 
```

但是，这不起作用。编辑没有反映更改。但是，当我检查编辑器时，我发现 textarea 确实显示了附加的适当文本，只是编辑器没有显示它。有谁知道解决这个问题的方法。另外，以防万一有人想知道，我的页面中确实引用了 jquery CKEditor 适配器脚本。

此外，如果一个有点相关但单独的问题。

我有一个下拉列表，允许用户在页面上显示的文本区域（CKEditor WIZIWIG）和再次返回正常文本区域之间切换。但是，如果不从字面上刷新页面，我似乎无法做到这一点，我想通过 javascript/jquery 来做到这一点，这样我就不必在更改下拉选择时刷新页面。我已经尝试过内置的销毁方法。它似乎没有在视觉上做任何事情，编辑器不会恢复到简单的文本区域。

以防万一您要询问更多代码，这是我的 HTML 页面的样子：

```
<textarea id="mtxDescription" name="mtxDescription"></textarea> 
```

这是我初始化编辑器的方式

```
CKEDITOR.replace('mtxDescription', {
    sharedSpaces: { top: 'ed-top'}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T16:58:16.983

我能够通过使用以下代码而不是使用 jQuery CKEDITOR.instances.mtxDescription.insertHtml($(this).data('key')) 来解决这个问题我仍然需要一种在运行时删除编辑器的方法。

# php - URL 中的随机字符串有助于对抗“中间人攻击”？

> ID：14310216
> 
> 赞同：1
> 
> 时间：2013-01-14T01:16:19.920
> 
> 标签：php, security, ssl, man-in-the-middle

这是场景：

在每个非购物车页面上都会生成一个新的 md5(rand()) 会话变量。然后将此变量插入到购物车链接的 url 中。单击购物车链接将是用户从 http 转移到 https 的点，因此我知道这是一项确保安全的关键交易，以防止中间人将自己注入服务器和用户之间。

为了访问购物车，当前会话变量必须匹配 url 中的字符串（例如“/shopping_car_url/{random_string}/”），否则会发送 404 错误。

1.  只要会话不受影响，这是否应该有效？
2.  使用 POST 变量（或在会话和帖子中使用相同或不同的随机字符串）是否会同样有效或更有效（或无效）？
3.  如果这是有效的，那么通过其余的购物车编辑/结帐过程做同样的事情是否有任何好处，或者这是否毫无意义，因为此时用户已经连接到 SSL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:20:44.313

不要打扰它。保持您的 URL 简单明了；您的客户会更开心。如果您正确使用 SSL，那么您就可以免受绝大多数传输层中间人攻击。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T03:24:28.253

您在这里试图保护自己免受的是[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)（跨站点请求伪造）而不是 MITM。

一旦切换到 https，MITM 攻击几乎是不可能的，并且将商品添加到购物车通常不需要 CSRF 保护（与支付操作本身不同）。确保还阅读[XSS 和 CSRF：验证后漏洞的实用探索](https://www.htbridge.com/publication/practical_exploitation_of_post_authentication_vulnerabilities_web.pdf)。

但是，如果恶意人员在您切换到 https 之前设法将自己置于用户和您的网站之间，他们也可以重写您的商店链接，但无需使用 https；然后，您的用户需要对地址栏中的锁定图标保持警惕。

# sql - Sql 多个连接到同一个表，包括和独占

> ID：14310219
> 
> 赞同：2
> 
> 时间：2013-01-14T01:16:30.687
> 
> 标签：sql, sql-server, sql-server-2008

我有一张桌子 Foo

```
FOO
-------
id
name

BAR
-------
id
name

FOO_BAR_XREF
-------
foo_id
bar_id 
```

我需要选择所有 FOO 实例，其中 foo.id 在 foo_bar_xref 中有一个 bar_id 为 1 的记录，并从 foo 中排除记录，其中 foo.id 有一个记录 n foo_bar_xref 的 bar_id 为 2

foo -> foo_bar_xref 是一对多 *强调文本*foo_bar_xref 可能包含每个 foo_id 的多个 bar_id

这是否可能只使用连接，还是我需要在 where 子句中使用 not exists 语句？

到目前为止我有

```
select f.name from FOO f
inner join FOO_BAR_XREF fb_1 on fb_1.foo_id = f.id
inner join FOO_BAR_XREF fb_2 on fb_2.foo_id = f.id

where fb_1.bar_id = 1 and fb_2.bar_id <> 2
group by f.name -- remove dupes - running on sql server and is paged with sql servers hackish over keyword where distinct doesn't work so well. 
```

那不是过滤掉 bar 为 2 的 foo

这似乎有效，但我不确定它是最有效的

```
select f.name from FOO f
inner join FOO_BAR_XREF fb_1 on fb_1.foo_id = f.id and fb_1.bar_id = 1
left outer join FOO_BAR_XREF fb_2 on fb_2.foo_id = f.id and fb_2.bar_id = 2

where fb_2.bar_id is null
group by f.name -- remove dupes 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:32:19.483

重申我的评论，我认为 OP 有最好的解决方案。对于这些场景，我一直更喜欢使用左连接。

```
select f.name 
from FOO f 
inner join FOO_BAR_XREF fb_1 
  on fb_1.foo_id = f.id and fb_1.bar_id = 1 
left outer join FOO_BAR_XREF fb_2 
  on fb_2.foo_id = f.id 
  and fb_2.bar_id = 2
where fb_2.bar_id is null
group by f.name 
```

还有[SQL 小提琴](http://sqlfiddle.com/#!3/4cbb7/1)。

顺便说一句，我认为这是关于表扫描的最有效的解决方案。检查你的执行计划，看看你在做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T01:23:30.690

> 我需要选择所有 FOO 实例，其中 foo.id 在 foo_bar_xref 中有一个 bar_id 为 1 的记录，并从 foo 中排除记录，其中 foo.id 有一个记录 n foo_bar_xref 的 bar_id 为 2

由于您使用的是 SQL Server，`EXCEPT`因此您可以使用 set 操作来执行此操作：

```
SELECT f.id, f.name 
FROM FOO f
INNER JOIN FOO_BAR_XREF fb_1 ON fb_1.foo_id = f.id
WHERE fb_1.bar_id = 1
EXCEPT 
SELECT f.id, f.name from FOO f
INNER JOIN FOO_BAR_XREF fb_1 ON fb_1.foo_id = f.id
WHERE fb_1.bar_id = 2; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T01:21:58.953

以下是执行此操作的一种方法。它总结了外部参照表以获取 bar=1 但不是 bar=2 的 foo。一般来说，我更喜欢对这种类型的查询使用聚合。

```
select f.*
from foo f join
     (select f.foo_id
      from foo_bar_xref
      group by f.foo_id
      having max(case when bar_id = 1 then 1 else 0 end) > 0 and -- has 1 bar
             max(case when bar_id = 2 then 1 else 0 end) = 0     -- no 2 bar
    ) fbx
    on f.id = fbx.foo_id 
```

注意：此 SQL 未经测试，因此可能存在语法错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T06:41:20.477

```
select * from foo join (
select foo_id from FOO_BAR_XREF where bar_id =1
except
select foo_id from FOO_BAR_XREF where bar_id =2
) X on id=foo_id 
```

# java - 从文件中添加一行数字并将平均值存储到双向量中

> ID：14310220
> 
> 赞同：-4
> 
> 时间：2013-01-14T01:16:32.310
> 
> 标签：java, string, file, vector, double

我需要使用双向量来存储学生的平均值。

我从中读取的文件是这样设置的：

```
2  //num of students
60   //total possible score
John   //name
4 16 9 7 10  //scores 
```

所以我需要将字符串转换为双精度，将行中的所有整数相加，除以平均值，然后将平均值存储到双精度向量中。

我到目前为止的代码是：

```
public static String line;
public static Scanner in = new Scanner(System.in);
public static void main(String[] args) {

    System.out.println("enter the name of your file");
    String filename = in.next();
    FileIn file = new FileIn(filename);

    String firstLine; // String to hold first line which is number of students total in file.
    String secondLine; //String to hold second line which is number of points available 

    ArrayList<String> students = new ArrayList<String>();  // holds the students names

    //reads first line of the file. sets that number as the number of students
    firstLine = file.read();
    int numStu = Integer.parseInt(firstLine);
    // Just to test that number is being read correctly.
    System.out.println(numStu + " Number of students");

    //reads the second line of the file. sets that number as the total possible points in a semester
    secondLine = file.read();
    int totalPoints = Integer.parseInt(secondLine);
    // Just to test that number is being read correctly.
    System.out.println(totalPoints + " Total possible points");

    double avg = 0;
    double[]vector = new double [numStu]; 

    readFile(students,numStu,file,vector, avg);

    System.out.println(students);
    System.out.println(vector);
}

//puts the names into an arraylist and scores into a double vector
public static void readFile(ArrayList<String> students,int numStu, FileIn file, double[]vector, double avg)
{
    for(int k=0; k<(numStu*2); k++)
    {
                    //odd numbers are the students
        if (k % 2 == 0)
            students.add(file.read());

        else
        {
            //code to read and add the numbers from one line together, and storing the added and averaged score
        }
    }
} 
```

}

如您所见，我缺少将文件元素分配到双向量的底部

我的 FileIn 类如下所示：

```
private String myFileName;
private BufferedReader myFile;
public FileIn(String filename)
{
    myFileName = filename;
    try
    {
        myFile = new BufferedReader(new FileReader(myFileName));
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
    finally{}
}

public String read()
{
    String myLine = new String();
    try
    {
        myLine = myFile.readLine();
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
    finally{}
    return myLine;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:10:45.423

*第一*！请在您的问题下阅读我的评论。学习如何以更聪明的方式提问，并学会分而治之。

这不是您问题的直接答案，因为我认为程序员应该能够自己解决它并学习它以用于您的问题。

完成以下一段代码，完成后您将知道自己问题的答案。

```
public class Foo {
  public static int main(String[] args) {
    String input = "10 15 20.5 70 40";

    // write code to convert the input string to doubles and sum them up
    double sum = ......;

    // answer should equals to 155.5
  }
} 
```

提示：`String.split()`and `Double.parseDouble()`, and 使用 for 循环

# google-apps-script - 如何确保 GAS（复制范围）功能正确更新了谷歌电子表格？

> ID：14310223
> 
> 赞同：0
> 
> 时间：2013-01-14T01:17:03.103
> 
> 标签：google-apps-script, google-sheets, google-spreadsheet-api

我正在尝试使用这行代码将一系列单元格从一个地方复制到另一个地方：

`cell.offset(1, 0, 1, sheet.getLastColumn()).copyTo(cell.offset(nextRow, 0));`

要复制的范围始终相同；唯一改变的是`nextRow`，即要复制到的行。

原始范围包含带有值和公式的单元格。

一切似乎都很好，但是由于未知原因，复制过程的行为异常：

*   有一次，一切都按预期进行；
*   另一次，它不复制其中一个单元格；
*   还有一次，它不复制公式，只复制值；
*   还有一次，它混合了上面的不一致。

从 UI 复制很好。

我在运行函数时打开了电子表格的事实与它有关吗？

最大的问题：**有没有办法确保正确复制范围？**

更新：

更多代码以使其更清晰：

```
var ss = SpreadsheetApp.openById(ScriptProperties.getProperty('SpreadSheetId'));
var sheet = ss.getSheetByName("Matches");
var nextRow = sheet.getLastRow();
var cell = sheet.getRange('a1');
cell.offset(1, 0, 1, sheet.getLastColumn()).copyTo(cell.offset(nextRow, 0)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:56:19.027

Looks like I've got something acceptable.
The code below didn't throw any error so far, and I'm sticking with it till something better comes up.
Thank you guys, anyway.

```
var ss = SpreadsheetApp.openById(ScriptProperties.getProperty('SpreadSheetId'));
var sheet = ss.getSheetByName("Matches");
var lastRow = sheet.getLastRow();
var lastCol = sheet.getLastColumn();
var cell = sheet.getRange('a1');
var formulasToCheck = [1,17,18,19,20,21,22,23,24]; //cells 2 to 16 are being set in another place
var formulasOk = true;
var loopCount = 0;
do {
    formulasOk = true;
    cell.offset(1, 0, 1, lastCol).copyTo(cell.offset(lastRow, 0));
    var formulas = cell.offset(lastRow, 0, 1, lastCol).getFormulas()[0];
    loopCount++;
    for (var i = 0; i < formulasToCheck.length; i++) {
        if (formulas[formulasToCheck[i]].slice(0,1) != "=") {
            formulasOk = false;
            break;
        }
    }
} while (!formulasOk && loopCount<5); 
```

Maybe a `flush()` would suffice. But, this way, I'm very sure the values/formulas are being set properly.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T07:18:57.403

我会用一些简单的东西进行测试，例如硬编码你的手机位置。我已经多次使用该功能，并且每次都对我有用。

另外......没有测试它，但这看起来不对：cell.offset（**lastRow**，0）

# java - java liferay 项目中的内存泄漏

> ID：14310227
> 
> 赞同：0
> 
> 时间：2013-01-14T01:18:00.730
> 
> 标签：java, postgresql, memory-leaks, liferay-6

当我尝试重新部署我的项目时，有时它会耗尽内存并抛出 perGemSpace 错误（只需重新部署 2-3 次）我知道我的项目有一些内存泄漏问题但无法弄清楚，有人可以解释我请。:-?

```
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/qlbc-portlet] registered the JDBC driver [net.sf.log4jdbc.DriverSpy] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/qlbc-portlet] registered the JDBC driver [org.postgresql.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/qlbc-portlet] appears to have started a thread named [Thread-43] but has failed to stop it. This is very likely to create a memory leak.
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/qlbc-portlet] appears to have started a thread named [Timer-4] but has failed to stop it. This is very likely to create a memory leak.
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/qlbc-portlet] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0] but has failed to stop it. This is very likely to create a memory leak.
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/qlbc-portlet] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1] but has failed to stop it. This is very likely to create a memory leak.
Jan 14, 2013 1:12:21 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/qlbc-portlet] appears to have started a thread named [com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2] but has failed to stop it. This is very likely to create a memory leak. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:19:41.910

看起来您没有取消注册驱动程序或停止线程。

如果你没有很好地管理这些项目，你很可能会出现内存泄漏，比如这个。

# servlets - 在 Apache2 中使用 Restlet

> ID：14310231
> 
> 赞同：0
> 
> 时间：2013-01-14T01:18:11.480
> 
> 标签：servlets, apache2, port, restlet-2.0, apache2-module

我是这里的新手..我正在尝试构建一个简单的单页 Web 应用程序

现在我正在使用 apache 2 http 服务器来服务前端的东西（html/js/css/imgs..），并使用一个在端口 8015 上使用 Restlet2.0 的 jar 来为来自前端的 Ajax 调用提供 APIS

现在因为 Apache 使用端口 80 而 Restlet 使用端口 8015，我必须在我的 ajax 调用中使用绝对地址，所有跨域地狱中断都会丢失

我想知道如何使 Apache 2 与 Restlet 一起工作？我一直在谷歌搜索，但没有很多有用的结果。如何将所有 API 调用转发到 Restlet，并仍然利用 apache 2 的出色功能

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T09:39:10.897

您可能希望使用 Apache HTTPd（推荐）设置反向 HTTP 代理。

另一种方法是使用 AJP 协议，因为 Restlet 通过其 Jetty 扩展支持它。 [http://httpd.apache.org/docs/2.2/mod/mod_proxy_ajp.html](http://httpd.apache.org/docs/2.2/mod/mod_proxy_ajp.html)

# vb.net - 重新打开表单时不播放声音

> ID：14310236
> 
> 赞同：0
> 
> 时间：2013-01-14T01:19:20.703
> 
> 标签：vb.net, audio

大家好，我有一个用 vb.net 制作的宾果游戏。我的 D: 文件夹中录制了声音。我每次绘制一个数字和字母时都会播放它，但是每当我关闭游戏表格然后从菜单中重新开始一个新游戏时，声音就不再播放了。该程序确实通过了我制作的声音功能但它不播放声音。这是我的代码：

```
Sub sound()
    If lblletter.Text <> "" And lblNumber.Text <> "" And lbllang.Text = "English" Then
        Dim sound As String = "D:\BINGO BONANZA\ENGLISH\" + lblletter.Text + " " + lblNumber.Text + ".wav"
        If My.Computer.FileSystem.FileExists(sound) Then
            My.Computer.Audio.Play(sound, AudioPlayMode.Background)
        Else
            MsgBox("No sound file for this")
        End If
    ElseIf lblletter.Text <> "" And lblNumber.Text <> "" And lbllang.Text = "English" Then
        Dim sound As String = "D:\BINGO BONANZA\FILIPINO\" + lblletter.Text + " " + lblNumber.Text + ".wav"
        If My.Computer.FileSystem.FileExists(sound) Then
            My.Computer.Audio.Play(sound, AudioPlayMode.Background)
        Else
            MsgBox("No sound file for this")
        End If
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T07:30:01.003

我已经解决了我的问题。它不需要对我的代码做任何事情。传递的语言有时没有价值。无论如何，谢谢你的时间.. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T05:38:01.733

我看到了一些您可以解决的问题...您的 lbllang.Text 对于两个语句都是相同的。我想你第一个是“英语”，最后一个是“菲律宾语”。我已经提供了一些你可以做的改变......我看不出你会如何从中得到任何东西，因为这两个陈述都是正确的，你说如果它等于这个做这个并且 elseif 做同样的事情...... ?

```
 Private Sub sound()
   If lblletter.Text <> "" And lblNumber.Text <> "" And lbllang.Text = "English" Then
    Dim sound As String = "D:\BINGO BONANZA\ENGLISH\" + lblletter.Text + " " + lblNumber.Text + ".wav"
    If My.Computer.FileSystem.FileExists(sound) Then
        My.Computer.Audio.Play(sound, AudioPlayMode.Background)
    Else
        MsgBox("No sound file for this")
    End If
  Else
    Dim sound As String = "D:\BINGO BONANZA\FILIPINO\" + lblletter.Text + " " + lblNumber.Text + ".wav"
    If My.Computer.FileSystem.FileExists(sound) Then
        My.Computer.Audio.Play(sound, AudioPlayMode.Background)
    Else
        MsgBox("No sound file for this")
    End If
   End If
 End Sub 
```

如果不满足第一个条件，它将执行 else... 试一试，让我知道它是否适合您。还要在“Private Sub sound”上设置一个断点，然后按“F11”逐步检查您的条件......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T05:54:15.557

您现在知道出了什么问题，为了您的方便，这里有一种更简洁和正统的编码方式：

```
Private Sub PlaySound()

 If (string.IsNullOrEmpty(lblletter.Text) Or string.IsNullOrEmpty(lblNumber.Text)) Then return

 Dim soundFile As String = String.Format("D:\BINGO BONANZA\{0}\{1} {2}.wav",lbllang.Text, lblletter.Text, lblNumber.Text)

 If My.Computer.FileSystem.FileExists(soundFile) Then
    My.Computer.Audio.Play(soundFile, AudioPlayMode.Background)
 Else
    MessageBox.Show("No sound found for file: " & soundFile)
 End If
End Sub 
```

# java - 我写了下面的代码来检查数组的元素

> ID：14310243
> 
> 赞同：0
> 
> 时间：2013-01-14T01:20:25.807
> 
> 标签：java

我编写了下面的代码来检查数组的元素。我得到了所需的答案。我只想知道我应该做些什么改变，这样它才能给我输出`1, 2, 3, 4, 5.`

此外，当我写`a[]`而不是`b[]`，代码给了我错误`a is already defined in main(java.lang.String[])`。请你帮助我好吗？

```
class ArrayDemo15
{
    public static void main(String a[])
    {
        int b[]=new int[5];
        for(int i=0;i<5;i++)
        {
            System.out.println(b[i]+""+);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:22:23.313

你可以试试

```
System.out.println(Arrays.toString(b)); 
```

并查看您的 main 方法的参数 - 它被称为`a`，因此您不能更改 to 的名称，`b`因为`a`这将导致两个具有相同名称的变量。也许您应该将其更改为类似`main(String[] args)`.

* * *

**相关文件**

*   [`Arrays.toString(int[])`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28int%5B%5D%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:42:58.577

```
int b[] = new int[5]; 
```

您的代码行只是创建一个新的 int 数组，其中包含 5 个空白元素。

```
int b[] = {1,2,3,4,5}; 
```

这一行将为您提供一个名为 b 的数组，其中包含元素 1、2、3、4、5。

至于第二个问题，您`a[]`的主要参数中有变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T02:20:48.403

*“我只想知道我应该做些什么改变，这样它才能给我输出`1, 2, 3, 4, 5`“*

如果您只想打印这些数字，那么您根本不需要数组。只需使用 for 循环

```
int counter=1;
for (counter=1; counter<=4; counter++)
    System.out.print(counter+", ");
//after loop print last element without comma
System.out.println(counter); 
```

* * *

但是，如果您坚持改进代码并使用数组，请继续阅读此答案...

现在你的代码给出了编译错误，`System.out.println(b[i]+""+);`因为`+`在这种情况下是两个参数运算符，你只给它一个参数。将其更改为类似

```
System.out.print(b[i]+", "); 
```

我`print`改用了`println`，因为你不想在数字之间有新的换行符。

目前您的数组也填充了零，因为所有新数组都填充了一些默认值：
- 对于*原始数字类型*（int、byte、double 等）的数组，默认值为 0，
-对于*原始布尔值*，它是 false，
- 对于*对象*（如字符串），它为空。

所以你需要先用你的值填充你的数组。为此，您有两种选择

1.  遍历数组并设置每个元素

    ```
    for (int index = 0; index < b.length; index++) {
        b[index] = index + 1;
    } 
    ```

2.  在创建数组时提供所有值，例如
    *   `int[] b1 = { 1, 2, 3, 4, 5 };`此版本仅供参考
    *   `int[] b2 = new int[]{ 1, 2, 3, 4, 5 };`这个版本不需要参考，可以在任何地方使用，例如作为一些接受 int 数组的方法的参数`Arrays.sort(new int[]{ 5, 3, 1, 4, 2 })`

当数组的所有元素都设置为正确的值时，您需要打印它。[您可以使用ARS 指出](https://stackoverflow.com/a/14310255/1393766) 的内置实用程序`System.out.println(java.util.Arrays.toString(b))`执行此操作，也可以使用循环自己执行此操作

```
for (int i = 0; i < b.length - 1; i++) {// b.length - 1 I don't want to
    // print last element here since I don't want to add comma
    // after it
    System.out.print(b[i] + ", ");
}
// now it is time for last element of array
System.out.println(b[b.length - 1]);
//since b[]={1,2,3,4,5} b.length=5 so it will print b[4] -> 5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T03:54:08.120

如果您在未指定初始值的情况下初始化数组，Java 会根据其类型将数组中的每个元素设置为默认值；int 的默认值是 0。如果您希望 [1,2,3,4,5] 作为数组而不是 [0,0,0,0,0]，您可以在初始化时设置数组的内容，即`int b[] = {1,2,3,4,5};`。您还可以通过在调用之前添加一行来在 for 循环中设置数组`println`。

```
for(int i = 0; i < 5; i++){
   b[i] = i+1;
   System.out.println(b[i]);
} 
```

您收到该错误的原因是您无法重新声明变量的类型，只能重新分配它。例如，

```
int a = 4;
int a = 5; 
```

不允许，但是

```
int a = 4;
a = 5; 
```

is allowed. In the main method, the array `a` is declared as a `String[]`, and cannot be redeclared as an `int[]`.

# windows - 使用系统命令下载 XML 文件

> ID：14310252
> 
> 赞同：1
> 
> 时间：2013-01-14T01:22:10.170
> 
> 标签：windows, shell, system, command-prompt

我正在为一个名为 12d Model 的 CAD 程序编写扩展程序。我编写这些扩展所用的语言简称为宏语言，它的 API 非常有限。因此它无法在 Windows 上查找文件、列出目录中的所有文件或下载文件。

为了克服这个问题，我使用简单的 ShellExecute 和系统调用。例如，要列出目录中的所有文件，我使用系统调用“dir C:\ /B > C:\MyCurrentFolder\outfile.txt”。我的需求之一是下载和解析 XML 文件，但 API 没有下载功能。

**是否有从 URL 下载文件的系统调用？**有一些本地方法可以做到这一点吗？也许有一个 Windows 应用程序，如 regedit.exe 或我可以用来下载文件的东西？

如果没有，您认为可以通过批处理脚本来完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T19:33:54.553

是的，有一种本地方法可以做到这一点。使用 msxsl.exe 解析器下载 xml 文件并将其保存到您想要的任何位置。您可以从命令提示符或批处理文件执行此操作。请注意，您需要使用一个不会更改 xml 文件的 xsl 文件。该命令看起来像这样......

c:\msxsl.exe c:\myXML.xml c:\myXSLT.xsl > c:\myXML.xml

请注意，位于 c:\myXSLT.xsl 的文件无法更改源文件 c:\myXML.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T05:47:56.010

Windows 确实具有内置的 FTP 支持，使用`ftp.exe`. 因此，如果您可以找到该文件的 FTP 镜像，或者自己将其上传到镜像中，那可能会奏效。

# algorithm - 两个圆形列表之间的最小编辑距离？

> ID：14310259
> 
> 赞同：2
> 
> 时间：2013-01-14T01:23:13.337
> 
> 标签：algorithm, circular-list

给定两个循环列表，是否有一种有效的方法来计算两个列表之间的最佳对齐方式？例如，给定循环列表：

```
a b b c
b c a 
```

最佳对齐是

```
a b b c
a b _ c 
```

因为此对齐具有最小的编辑距离（注意：此最佳对齐不是且不必是唯一的）。

一种方法是计算第一个列表和第二个列表的每个循环排列之间的编辑距离，将最小编辑距离作为最佳对齐。有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T07:00:03.583

假设 S1="abbc", S2="bca"

现在让 S2'=strcat(S2,S2)="bcabca"，然后计算 S1 和 S2' 之间的编辑距离，你会得到

```
--abbc-
bcab-ca 
```

只是一个提示，应该考虑更多细节

# java - 我的 java 小程序不会显示任何内容，也不会出现语法错误

> ID：14310262
> 
> 赞同：0
> 
> 时间：2013-01-14T01:25:10.560
> 
> 标签：java, applet, type-conversion

明天我有一个计算机科学的期末项目，它作为一个应用程序工作，但不会显示任何作为我们需要的小程序的东西。（它被编码为应用程序，然后转换为小程序）

我不明白整个发布代码在这个网站上是如何工作的，所以我把它放在 pastebin.com [http://pastebin.com/kiFmzbfp](http://pastebin.com/kiFmzbfp)

有没有我可以使用小程序运行 jar 的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T08:51:46.737

> 有没有我可以使用小程序运行 jar 的地方？

是的。虽然这不是从小程序显示 GUI 的最佳方式。

将 Jar 添加到小程序的编译时和运行时类路径（int`archive`属性）。在小程序`init()`中，删除`start();`和添加当前`main(String[])`. 可见。

```
UserInterface runner = new UserInterface();
runner.Interface();

MainCode run = new MainCode();
run.Change_InterFace(); 
```

最好在 EDT（事件调度线程）上调用该代码。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

但是该代码作为小程序会出现问题，因为它试图通过`File`而不是`URL`. 这已在过去 24 小时内[讨论过。](https://stackoverflow.com/q/14309301/418556)

* * *

注意到粘贴箱中有 443 行代码转储，这是我准备调查的。距离截止日期还有 .. 大约 17 个小时，所以你最好开始行动。

# excel - 如何在Excel中的if语句中指定第一个包含数据的单元格

> ID：14310263
> 
> 赞同：2
> 
> 时间：2013-01-14T01:25:11.293
> 
> 标签：excel, excel-2010, worksheet-function

我在 2 周内保持 Excel 中孩子的平均成绩。我现在拥有代码的方式

```
AVERAGE(OFFSET('1'!E4,COUNTA('1'!D:D)-29,):OFFSET('1'!E4,COUNTA('1'!D:D),)) 
```

如果我没有 2 周的数据，它会返回错误。我通过这样做找到了解决方法

```
=IFERROR(AVERAGE(OFFSET('1'!E4,COUNTA('1'!D:D)-29,):OFFSET('1'!E4,COUNTA('1'!D:D),)),IFERROR(AVERAGE(OFFSET('1'!E4,COUNTA('1'!D:D)-28,):OFFSET('1'!E4,COUNTA('1'!D:D),)),IFERROR(AVERAGE(OFFSET('1'!E4,COUNTA('1'!D:D)-27,.... 
```

我确定有更好的方法可以做到这一点，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:51:12.580

正如评论中指出的那样——如果没有更多的知识，很难给出明确的答案——例如，很难说出数字数据从哪里开始（E4 或 E5）？

首先，您可以简化您的原始公式，该公式显示为平均最后 30 行数据（不确定 30 行如何等同于 2 周的数据） - 您可以这样做：

`=AVERAGE(OFFSET('1'!E4,COUNTA('1'!D:D)-29,0,30))`

现在我假设错误发生在 COUNTA('1'!D:D) < 29 时，因此您可以简单地添加一个 If 函数，如果该函数返回的数字 < 29，则平均所有数据，即

`=IF(COUNTA('1'!D:D)<29,AVERAGE('1'!E4:E33),AVERAGE(OFFSET('1'!E4,COUNTA('1'!D:D)-29,0,30)))`

该公式可能需要一些小的调整来满足您的布局的具体情况，但一般方法是有效的

# jquery - 在大结果上使用 phonegap 自动完成 jQuery

> ID：14310269
> 
> 赞同：4
> 
> 时间：2013-01-14T01:25:59.780
> 
> 标签：jquery, html, sqlite, cordova, autocomplete

我需要使用 phonegap 在我的应用程序中的输入字段中添加自动完成功能。我知道 jquery 具有的自动完成小部件，我也想在我的应用程序中使用它。我需要的是让自动完成功能根据我在平板电脑上安装的 sqlite db 中的查询来查找字符串。

```
$("#searchInput").autocomplete({
     source: "script_that_queries_the_db.php"
}); 
```

从另一个线程我得到了这个，但是由于phonegap不使用php，我们是否允许类似地调用一个JS文件并使该查询成为一个函数，例如

```
function getSitenames () { 
   //stuff in here to build an array to use by autocomplete 
} 
```

任何帮助将不胜感激。

编辑：我将从数据库中获取的 JSON/Array 一次将包含大约 1900 个条目。由于自动完成总是会回忆起源代码，我希望做类似的事情

```
SELECT name FROM sitenames WHERE name LIKE ? 
```

`response.text`并每次解析并像这样构建数组。（因为 sitesnames 表包含 1900 多个条目）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:50:48.773

所以 jQM 不支持正确的自动完成，我不得不使用这个，[https://github.com/commadelimited/autoComplete.js](https://github.com/commadelimited/autoComplete.js)进行替换。它基本上工作相同，我使用的地方：

`source: function (text) { var arrayClients = findCleints(text); callback(arrayClients) },`

# arrays - 如何在 Visual Basic 中从数组中选择一个随机元素

> ID：14310272
> 
> 赞同：1
> 
> 时间：2013-01-14T01:26:04.367
> 
> 标签：arrays, visual-studio-2008, vba, random

我创建了一个整数数组，并想从中选择一个随机元素。我怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T01:30:29.087

```
YourArray(New Random().Next(0,YourArray.Length-1)) 
```

或者为了更清楚而分开：

```
Dim Rand as New Random()
Dim Index as Integer = Rand.Next(0, YourArray.Length - 1)

Dim SelectedValue = YourArray(Index) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:30:02.730

`0`在 到 的范围内生成一个随机整数`Len-1`，其中`Len`是数组的长度。要生成随机整数，请使用`Random`该类的实例。

```
DIM rand As New Random
DIM idx as rand.Next(0, Len)
REM Now you can pick an element idx from the array
REM to get a random element.
DIM res as myArray(index) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T01:35:53.940

Rnd可以得到[0,1)，然后再多倍你的arraylength，你可以得到[0,YourArrayLength)之间的数字

```
Randomize
Int(array.length* Rnd) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-16T00:51:41.920

只想说接受的答案是不正确的。

这是正确的

```
Dim Rand as New Random()
Dim Index as Integer = Rand.Next(0, YourArray.Length)

Dim SelectedValue = YourArray(Index) 
```

为什么？

因为最大值是排他的。因此，如果您不想在 3 个元素中进行选择，例如，最大值应该是 3，而不是 2。

```
 '
    ' Summary:
    '     Returns a non-negative random integer.
    '
    ' Returns:
    '     A 32-bit signed integer that is greater than or equal to 0 and less than System.Int32.MaxValue.
    Public Overridable Function [Next]() As Integer
    '
    ' Summary:
    '     Returns a random integer that is within a specified range.
    '
    ' Parameters:
    '   minValue:
    '     The inclusive lower bound of the random number returned.
    '
    '   maxValue:
    '     The **exclusive** upper bound of the random number returned. maxValue must be greater
    '     than or equal to minValue.
    '
    ' Returns:
    '     A 32-bit signed integer greater than or equal to minValue and **less than** maxValue;
    '     that is, the range of return values includes minValue but not maxValue. If minValue
    '     equals maxValue, minValue is returned.
    '
    ' Exceptions:
    '   T:System.ArgumentOutOfRangeException:
    '     minValue is greater than maxValue. 
```

我也试过。我尝试从 3 个元素中选择一个，并注意到只有前 2 个元素被选中。永远不会选择第三个元素 [![在此处输入图像描述](../Images/b48fd2b0e5d56fa35a1eef17b3d44d1a.png)](https://i.stack.imgur.com/laSO1.png)

# javascript - Javascript 警报不包括 var

> ID：14310274
> 
> 赞同：-4
> 
> 时间：2013-01-14T01:27:09.217
> 
> 标签：javascript

因此，如果我在一个框中输入：

打开 google.com

我希望 javascript 在我输入“open google.com”时识别它，并希望它提醒我。但我不知道如何让它在没有“打开”的情况下提醒 google.com。

```
var varopen = "open";
if (result.match(varopen)) {
    alert(result);
} 
```

我想显示“结果”而不显示“varopen”。

基本上我希望 alert(result - varopen) 工作，但这不起作用。PS我对javascript一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:29:50.680

`varopen`从字符串中删除第一个实例：

```
alert(result.replace(varopen, '')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:29:33.480

像这样。只需使用字符串结果的 replace 方法将 varopen 替换为空即可。

```
var result = ""
var varopen = "open ";
result = result.replace(varopen,""); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T01:32:13.140

用这个：

```
var varopen = "open";
if (result.match(varopen)) {
    alert(result.replace("open ", ""));
} 
```

# android - 如何将 Google Maps Android API v2 Marker 链接到对象

> ID：14310280
> 
> 赞同：1
> 
> 时间：2013-01-14T01:28:38.663
> 
> 标签：android, google-maps-android-api-2

我在地图中动态添加非固定数量的标记，每个标记都与我的 POCO 类的一个实例相关。

我需要链接它们，因此当用户单击其中一个标记时，我会在自定义信息窗口中显示其余数据。

你有什么建议？

PS：每次用户平移或缩放地图时，我都会添加新标记，我担心应用程序过载。不可见的标记是否已处理？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T18:07:46.803

我建议使用 HashMap 或类似的东西。当您遍历对象列表并为它们创建标记时，还要将标记添加到列表中，使用对象的 ID 作为键，标记作为值：

```
private HashMap<Integer, Marker> markerMap = new HashMap<Integer, Marker>(); 
```

...

```
for(MarkerObject obj : this.markerObjects)
{
     //If the marker isn't already being displayed
     if(!markerMap.containsKey(obj.getId()))
     {
         //Add the Marker to the Map and keep track of it 
         this.markerMap.put(obj.getId(), this.mMap.addMarker(getMarkerForObject(obj)));
     }
} 
```

然后，您可以使用 OnInfoWindowClickListener 在地图中查找点击标记的对象 ID，并对相应的数据执行某些操作，例如打开一个包含详细信息的新活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-22T20:04:58.467

我知道这篇文章很旧，但是如果您在 Android Studio 中使用预制地图 Activity

在设置地图中

```
 private void setUpMap() {

    Map<String,someObject>markerInfoList = new HashMap<String,someObject>();

  // get the marker Id as String
       String id =  mMap.addMarker(new MarkerOptions().position(new LatLng(/*set Latitude*/,  /*setLongitude*/).title("Marker")).getId();
       //add the marker ID to Map this way you are not holding on to  GoogleMap object
        markerInfoList.put(id,mapppedHouses.get(i));     
} 
```

然后在：

```
 private void setUpMapIfNeeded() {
  ///...
 if (mMap != null) {
   //if a marker is clicked
   mMap.setOnInfoWindowClickListener(new GoogleMap.OnInfoWindowClickListener() {
                @Override
                public void onInfoWindowClick(Marker marker) {
                    someObject = markerInfoList.get(marker.getId());
                }
            });
  }
 } 
```

# php - 使用 PHP 会话更改更改 html 菜单项

> ID：14310282
> 
> 赞同：0
> 
> 时间：2013-01-14T01:29:13.077
> 
> 标签：php

我正在尝试在用户登录后创建一个会话，以便在他们登录期间“登录”菜单项更改为“注销”。登录后，我的 success.php 文件将运行，这只是

```
<?php
    session_start();
    $_SESSION['loggedin'] = 1;
?> 
```

现在在我的菜单下

```
<?php
if($_SESSION['loggedin']=1)
echo '<a href="logout.php">Logout</a>';
else
echo '<a href="login.html">Login</a>';
?> 
```

我也有一个注销页面，它只是

```
<?php
    session_start();
    session_destroy();
?> 
```

但这里发生的情况是，默认情况下，即使用户尚未登录以创建会话，也会显示注销选项而不是登录。

我不确定这是否是处理此问题的正确方法，但非常感谢一些建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:30:32.637

```
if($_SESSION['loggedin']=1) 
```

应该：

```
if($_SESSION['loggedin']===1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:31:00.937

登录：

```
if username and password is ok {

session_start();
$_SESSION['loggedin'] = "something";

} 
```

对于菜单

```
 if(isset($_SESSION['loggedin'])) {
    echo "<a href="logout.php"> logout </a>";
    } else {

    echo "<a href="login.php"> login </a>";
    } 
```

好的，为了在您更改页面时记住会话，您应该创建一个名为`session.php`并存储以下代码的文件。

```
<?php 

    session_start();

     if(isset($_SESSION['loggedin']) && !empty($_SESSION['loggedin'])) {

     return true;
     }else {
     return false;
     }
     }

 ?> 
```

现在，将此页面包含在您的每个 .php 页面中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-01T16:36:27.367

对于菜单你可以这样做

```
if(isset($_SESSION['user_email']))
            {
            print "<span class=\"userg1\"><strong>".$user."</strong></span>&nbsp";
            print "<form method=\"link\" action=\"logout.php\">
            <input type=\"submit\" name=\"Log Out\" value=\"Log Out\" class=\"f1\"/>&nbsp;
            </form>";
            }
            else
            {
            print "<form method=\"link\" action=\"formvu.php\">
            <input type=\"submit\" name=\"log In\" value=\"Register\" class=\"f1\"/>&nbsp;
            </form><form method=\"link\" action=\"login2.php\">
                <input type=\"submit\" name=\"log In\" value=\"Log In\" class=\"f1\"/>&nbsp;
                </form>";
            } 
```

但是在页面的开头加载整个页面之前请检查会话

# php - Page.php 不会显示添加的内容

> ID：14310288
> 
> 赞同：0
> 
> 时间：2013-01-14T01:30:08.460
> 
> 标签：php, html, wordpress

我在 WP 中的 index.php 上有一组徽标，它们出现在底部，就在我想要的位置。

但是它们不会出现在所有页面上，如果我在 page.php 中的确切位置添加确切的代码，它不会显示在我网站的任何页面上，并且我需要徽标出现在所有页面上。我是否在正确的文件中插入代码？

Index.php 和 Page.php 的结尾完全相同，所以这都是我的代码的结尾：

```
<?php 

    lets_make_carousel();

?>

    <div id="footerlogos">
    <div id="logotonal"><a href="#" target="_blank">
    <img src="/new/wp-content/themes/music/images/footerlogos/tonal.png" /></a></div>

    <div id="logoah"><a href="#">
    <img src="/new/wp-content/themes/music/images/footerlogos/ah.png" /></a></div>

    <div id="logotranceil"><a href="#" target="_blank">
    <img src="/new/wp-content/themes/music/images/footerlogos/tranceil.png" /></a></div>

    <div id="logobpm"><a href="#" target="_blank">
    <img src="/new/wp-content/themes/music/images/footerlogos/bpm.png" /></a></div>

    <div id="logoakum"><a href="#" target="_blank">
    <img src="/new/wp-content/themes/music/images/footerlogos/akum.png" /></a></div>
    </div>

    <?php get_footer(); ?> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:32:39.620

把它放在footer.php 中。=]

看看它是如何在底部调用 get_footer() 的？如果我没记错的话，那就是从 footer.php 获取页脚。

无论哪种方式，它都属于那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T13:47:26.380

它可能会退回到您不知道的另一个模板（也许这是退回到父级的子主题？）。尝试回显您当前正在测试的页面模板...

```
<div><strong>Current template:</strong> <?php get_current_template( true ); ?></div> 
```

这篇文章的更多信息：[https ://wordpress.stackexchange.com/questions/37292/how-do-you-find-out-which-template-page-is-serving-the-current-page](https://wordpress.stackexchange.com/questions/37292/how-do-you-find-out-which-template-page-is-serving-the-current-page)

# php - 将 MCrypt 代码从 PHP 转换为 Python：这些代码块在哪里不等价

> ID：14310292
> 
> 赞同：0
> 
> 时间：2013-01-14T01:30:31.317
> 
> 标签：php, python, mcrypt

我继承了一些需要切换到 Python 的旧 PHP 代码。给定纯 ascii 中的加密密钥，它应该从文件中读取加密数据并吐出解密版本。出于某种原因，PHP 代码有效，但 Python 代码无效。我错过了什么？

两个系统上的块大小报告为 32。PHP 中的密钥大小报告为 24。

## PHP

```
<?php
$key = 'asdf';
$enc = fopen('encrypted.txt', 'r');
$message = fread($enc, 1024*1024);
$td = mcrypt_module_open('rijndael-256', '', 'cfb', '');
$iv = substr($message,0,mcrypt_enc_get_iv_size($td));
$message = substr($message, mcrypt_enc_get_iv_size($td));
mcrypt_generic_init($td, $key, $iv);
$message = mdecrypt_generic($td, $message);
print substr($message, 0, 32); 
```

## Python

```
import mcrypt
key = 'asdf'
KEY_SIZE = 24
inp = open('encrypted.txt')
encrypted_data = inp.read()
mc = mcrypt.MCRYPT('rijndael-256', 'cfb')
iv = encrypted_data[0:mc.get_iv_size()]
encrypted_data = encrypted_data[mc.get_iv_size():]
mc.init(key.ljust(KEY_SIZE, '\0'), iv)
output = mc.decrypt(encrypted_data)
print output[0:32] 
```

# c++ - 对 boost::asio 管理的线程池使用 std::mutex

> ID：14310294
> 
> 赞同：3
> 
> 时间：2013-01-14T01:30:36.447
> 
> 标签：c++, multithreading, boost, c++11, boost-asio

[不知何故，这个问题](https://stackoverflow.com/q/14265676/991425)的后续行动。我只是想知道是否可以使用`std::mutex`由 a 处理的 in 函数`boost::asio:io_service`？股线的使用有点不切实际。根据我在[boost 参考](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/overview/core/threads.html)中找到的内容，我会说没关系。既然它指出

> 异步完成处理程序只会从当前正在调用 io_service::run() 的线程中调用。

所以 boost 创建的其他线程不应该干扰。我做对了吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-14T14:59:53.517

正如其他人所指出的，`std::mutex`其他锁定机制可以在处理程序中使用。但是，两者之间存在根本区别：

*   处理程序中的外部锁定机制用于保护资源免受竞争条件的影响。
*   A`strand`用于消除处理程序之间的争用，从而消除处理程序之间的竞争条件。

如果整个处理程序是由于与其他处理程序的潜在竞争条件而同步的，而不是线程池外部的线程，那么我想强调外部机制和`boost::asio::strand`.

考虑以下场景：

*   Boost.Asio 实现了 2 个线程的线程池。
*   处理程序`A`和`B`将在同一个互斥锁上同步。
*   处理程序`C`不需要同步。
*   处理程序`A`,`B`和`C`发布到`io_service`.

`A`并被`B`调用。由于外部同步，线程池现在已耗尽，因为两个线程都在使用。不幸的是，其中一个线程在资源上被阻塞，导致不需要同步的处理程序，例如`C`，坐在队列中。

If a strand is used for synchronization in this scenario, then this instance of starvation would not have occurred. A `strand` maintains its own handler queue, and guarantees that only one of its handlers is in the `io_service`, resulting in handlers being synchronized before being placed into the `io_service`. In the scenario, if `A` and `B` are posted into the `strand`, then the `strand` will post `A` into the `io_service`. This would result in `A` and `C` being in the `io_service`, allowing `C` to run concurrently while `B` remains in the `strand`'s queue waiting for `A` to complete.

Also, there are use cases where both of these forms of synchronization can be used together. For example, consider the case where resources are shared with a thread running outside of the threadpool. A mutex would still be required by threads internal and external to the threadpool. However, a `strand` could be used to remove the contention for the mutex between threads internal to the threadpool.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-14T01:44:40.163

是的，使用`std::mutex`处理程序的内部非常好。`strand`毕竟，A只是一个带有互斥锁的队列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T01:45:38.040

`boost`只是从它的角度调用回调。这个回调与 没有关系`boost`，所以`boost`不在乎你在回调中做了什么。因此，锁定（使用您想要的任何锁定库）非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-28T01:44:09.130

Mutex inside completion handler can block thread execution. In that case you need more `io_service` threads than `boost::thread::hardware_concurrency()` to load CPU for 100%. It increases thread switching overhead.

# python - Python：pprint的模块错误，打印没有错误

> ID：14310298
> 
> 赞同：18
> 
> 时间：2013-01-14T01:31:11.400
> 
> 标签：python, python-3.x

所以我有这个函数，它创建一个名为`a()`并接受参数的字典`params`。我想打印那个字典，所以我使用了 pprint：

```
dict=a(params)
pprint(dict) 
```

pprint 给了我这个错误：

```
TypeError: 'module' object is not callable 
```

但打印效果很好！

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-14T01:35:06.663

你是怎么导入的`pprint`？如果您没有指定要导入的内容，`pprint`则需要在调用时使用模块名称。

```
import pprint
pprint.pprint(...) 
```

或者您可以导入特定方法。

```
from pprint import pprint
pprint(...) 
```

# android - 检查视图是否被按下的好方法

> ID：14310299
> 
> 赞同：2
> 
> 时间：2013-01-14T01:31:11.580
> 
> 标签：android, optimization, multi-touch

我正在尝试管理一个可与许多按钮一起使用的多任务应用程序。

为此，我做了这个功能：

```
public boolean isTouched(View view, MotionEvent event) {
    boolean touched = false;
    int count = event.getPointerCount();

    int[] location = { 0, 0 };
    view.getLocationOnScreen(location);
    Point min = new Point(location[0], location[1]);
    Point max = new Point(min.x + view.getWidth(), min.y + view.getHeight());

    for (int i = 0; i < count; i++) {

        int rawX = (int) event.getX(i);
        int rawY = (int) event.getY(i);
        if(rawX>=min.x && rawX<=max.x && rawY>=min.y && rawY<=max.y){
            //Log.d("mylog", "***Found a view: " + v.getId());
            touched = true;
            if (event.getAction() == MotionEvent.ACTION_UP) touched = false;
        }
    }
    return touched;
    } 
```

以及拦截onTouchEvent和管理两个ImageView的activity的函数override

```
@Override
public boolean onTouchEvent (MotionEvent event) {

    if (isTouched(button1,event)) {
        // it is pressed
        if ((Integer)button1.getTag() == 0) {  // but before wasn't pressed
            mp1.start();
            button1.setBackgroundResource(R.drawable.happy_on);
            button1.setTag(1);

            // start music 1
        }
    } else {
        // it isn't pressed
        if ((Integer)button1.getTag() == 1) {   // and before it was pressed
            mp1.stop();
            try {
                mp1.prepare();
            } catch (IOException e) {
                e.printStackTrace(); 
            }  catch (IllegalStateException e) {
                Log.e("hb","illegal state exception mp2") ;
                mp1= MediaPlayer.create(getBaseContext(), R.raw.female01) ;

            }

            button1.setBackgroundResource(R.drawable.happy_off);
            button1.setTag(0);
            // stop music 1
        }
    }

         if (isTouched(button2,event)) {
             // it is pressed
             if ((Integer)button2.getTag() == 0) {  // but before wasn't pressed
                 mp2.start();

                 button2.setBackgroundResource(R.drawable.to_on);
                 button2.setTag(1);
                 // start music 2
             }

         } else {
             // it isn't pressed
             if ((Integer)button2.getTag() == 1) {   // and before it was pressed
                 mp2.stop();
                 try {
                     mp2.prepare();
                 } catch (IOException e) {
                     e.printStackTrace(); 
                 } catch (IllegalStateException e) {
                     Log.e("hb","illegal state exception mp2") ;
                     mp2= MediaPlayer.create(getBaseContext(), R.raw.female02) ;                     }

                 button2.setBackgroundResource(R.drawable.to_off);
                 button2.setTag(0);
                 // stop music 1
             }
         }

    return false;

    } 
```

按钮（我使用 imageview）像钢琴键盘一样被按下：你可以用一根、两根手指将它传递过来，当指针进入视图时，异步操作就会开始。在 event_up 或指针离开按钮时，动作停止。

它有效，但它是一种非常缓慢的方法：它被许多 action_move 事件淹没。

任何人都可以知道一种优化这种多点触控管理方式的方法吗？

编辑：mp1 和 mp2 是 mp3 媒体播放器对象。当我在不释放指针的情况下从一个按钮传递到另一个按钮时，它可以工作，但是会有几毫秒的间隙使旋律跳跃。我要做的效果就像钢琴的键盘，没有间隙。

我认为差距是为函数isTouched的权重产生的。我怎样才能减少这个重量？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:45:48.277

您可能应该使用`Button`具有多个状态可绘制对象的常规 s，而不是`ImageView`然后在 XML 中使用`setOnClickListener(...)`或定义。`android:onclick`我认为您目前面临的问题只是您做出的有缺陷的设计决策的第一个方面。

# django - 为什么使用旧版本的 Django？

> ID：14310301
> 
> 赞同：0
> 
> 时间：2013-01-14T01:31:36.687
> 
> 标签：django

我创建了一个没有站点包的虚拟环境，激活了环境并安装了 django 1.4.3。但是，当我执行 'django-admin.py --version' 时，它显示 1.3。我在使用 Python 2.7 的 Windows XP 上。我所有的其他项目都使用 Django 1.3 并且没有使用虚拟环境。

谢谢

# ruby-on-rails-3 - 无法在控制器中创建 belongs_to 关联

> ID：14310304
> 
> 赞同：3
> 
> 时间：2013-01-14T01:32:03.857
> 
> 标签：ruby-on-rails-3, activerecord, rails-models

我有 2 个模型用户和公司。（我正在为用户使用设计）

*   用户属于公司。
*   公司有很多用户。

我的用户模型包括一个 client_id 列。

目前，用户注册并被定向到我想在其中创建关系的 new_company_path。（我宁愿分两步进行）。

我知道我的代码在**Companies_controller.rb**中是错误的——但这就是我所在的位置

```
 def create
    @user = current_user
    @company = @user.Company.new(params[:company])

    respond_to do |format|
      if @company.save
        format.html { redirect_to root_path, notice: 'Company was successfully created.' }
        format.json { render json: @company, status: :created, location: @company }
      else
        format.html { render action: "new" }
          format.json { render json: @company.errors, status: :unprocessable_entity }
      end
    end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T01:50:43.750

你的问题出在这条线上

```
@company = @user.Company.new(params[:company]) 
```

从用户到公司的关联不应使用大写字母访问。要让公司与用户关联，您应该这样称呼它：

```
@user.company 
```

但是，如果没有关联的公司，那么该方法将返回 nil，并且您不能调用`.new`nil，因此您需要调用 Rails 为您创建的另一个方法，`build_company`如下所示：

```
@company = @user.build_company(params[:company]) 
```

最后一个问题是，由于是属于公司的用户，因此需要使用新创建的 company_id 更新 User 实例，如果只保存公司，则不会发生这种情况。但是当您使用 build_company 方法时，它会将公司实例存储在来自 User 的关联中，因此如果您对用户而不是公司调用 save ，它将创建公司并将其链接到用户，如下所示：

```
def create
  @user = current_user
  @user.build_company(params[:company])

  respond_to do |format|
    if @user.save
      format.html { redirect_to root_path, notice: 'Company was successfully created.' }
      format.json { render json: @user.company, status: :created, location: @user.company }
    else
      format.html { render action: "new" }
      format.json { render json: @user.company.errors, status: :unprocessable_entity }
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:34:44.010

您的`User`模型需要一`company_id`列。然后，您可以制作一个表格，在您喜欢的任何地方（即`new_company_path`页面上）记录该值。

# python - Python ctypes：如何修改现有的 char* 数组

> ID：14310310
> 
> 赞同：9
> 
> 时间：2013-01-14T01:32:27.687
> 
> 标签：python, pointers, function-pointers, ctypes

我正在开发一个使用 C 库 libupnp 的 Python 应用程序。我正在使用 CTypes 来使用非常简单的库。我遇到的问题是当我为读取请求注册回调函数时。该函数具有以下形式的原型：

```
int read_callback(void *pFileHandle, char *pBuf, long nBufLength); 
```

pFileHandle 只是一些文件句柄类型。pBuf 是一个可写的内存缓冲区。这是输出数据的地方。nBufLength 是从文件中读取的字节数。返回状态码。

我有一个 Python 函数指针。这很容易做到，但是当我定义一个 Python 函数来处理这个回调时，我发现 pBuf 没有被写入，因为 Python 字符串是不可变的，并且当你分配或修改它们时，它们会创建新实例。这带来了一个大问题，因为当函数完成请求的文件数据时，C 库期望返回 char 指针。尽管由于 Python 字符串的方式，缓冲区最终每次都是空的。有没有办法在不修改 C 库的情况下解决这个问题？

处理程序应该修改给定的缓冲区参数，这是我的问题。

所以我想要发生的是调用 Python 函数来读取某个文件（可能在内存中、文件系统句柄或介于两者之间的任何文件中）。pBuf 参数由流的读取填充（同样在 Python 中）。然后回调返回到写入 pBuf 的 C 代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T02:59:31.097

使用 pBuf 和 nBufLength 调用回调。pBuf 已经分配了可写内存，但是如果您要求 pBuf.value，它会转换为不可变的 python 字符串。

而是将 pBuf 转换为可以直接修改的对象：

```
## If pBuf is c_char_p, then convert to writable object
c = ctypes.cast(pBuf, ctypes.POINTER(ctypes.c_char))
## At this point, you can set individual bytes
## with c[i] = x, but this is dangerous and there's a safer way:

## get address of string
addr = ctypes.addressof(c.contents)

## convert to char[] for safe writing
c2 = (c_char*nBufLength).from_address(addr)

## see how many bytes to write
nb = min(len(msg), nBufLength-1)

c2[:nb] = msg[:nb]
c2[nb+1] = '\0' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T02:57:53.610

ctypes 可以分配一个缓冲区对象，您的 C 库应该能够写入：

```
import ctypes
init_size = 256
pBuf = ctypes.create_string_buffer(init_size) 
```

请参阅：[http ://docs.python.org/2/library/ctypes.html#ctypes.create_string_buffer](http://docs.python.org/2/library/ctypes.html#ctypes.create_string_buffer)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T06:32:00.000

不要将 pBuf 声明为`c_char_p`. `ctypes`将该类型转换为不可变的 Python 字符串，您将无法访问 C 指针地址。您需要将其声明为`POINTER(c_char)`，然后可以使用`ctypes.memmove`将数据复制到其中。窗口示例：

DLL 代码（在 MSVC 上编译为`cl /LD test.c`）

```
#ifdef _WIN32
#   define API __declspec(dllexport)
#else
#   define API
#endif

typedef int (*CALLBACK)(void *pFileHandle, char *pBuf, long nBufLength);
char g_buf[10] = "012345678";
CALLBACK g_callback;

API void set_callback(CALLBACK callback) {
    g_callback = callback;
}

API int call_callback() {
    return g_callback(0, g_buf, 10);
}

API const char* get_buf() {
    return g_buf;
} 
```

Python 3 代码：

```
import ctypes as ct

# Declare the callback type, argument types and return types
CALLBACK = ct.CFUNCTYPE(ct.c_int,ct.c_void_p,ct.POINTER(ct.c_char),ct.c_long)
dll = ct.CDLL('./test')
dll.set_callback.argtypes = CALLBACK,
dll.set_callback.restype = None
dll.call_callback.argtypes = ()
dll.call_callback.restype = ct.c_int
dll.get_buf.argtypes = ()
dll.get_buf.restype = ct.c_char_p

# Decorating a Python function as a callback
#  makes it usable as a ctypes parameter.
@CALLBACK
def callback(handle, buf, length):
    data = b'ABCD\0'
    if length < len(data):
        return 0
    ct.memmove(buf,data,len(data))
    return 1

dll.set_callback(callback)
print(dll.call_callback())
print(dll.get_buf()) 
```

输出。请注意，它`get_buf`返回 a`c_char_p`并且它是一个字节字符串。`const char*`价值丢失。

```
1
b'ABCD' 
```

# jquery - 将数组对象拆分为单独的视图

> ID：14310314
> 
> 赞同：0
> 
> 时间：2013-01-14T01:33:44.647
> 
> 标签：jquery, ajax, split, each

我正在创建一个简单的股票代码，其中符号最终将通过 cms 输入。到目前为止，我已经成功地正确获取了 ajax 数据，我试图弄清楚如何将每个符号及其对应的数据拆分为单独的项目、列表项目或其他任何内容。我尝试使用 .each 但没有运气。

这是我的js：

```
(function(){
var getStocks = (function(){

    var initialize = function(){
        _setListeners();
    };

    var _setListeners = function(){

            var symbol = ["GOOG", "AAPL", "A", "AA", "ABT"];

        $.ajax({
            url: "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20csv%20where%20url%3D'http%3A%2F%2Fdownload.finance.yahoo.com%2Fd%2Fquotes.csv%3Fs%3D"+symbol+"%26f%3Dnsl1d1t1c1ohgv%26e%3D.csv'%20and%20columns%3D'name%2Csymbol%2Clast_trade_price%2Cdate%2Ctime%2Cchange%2Ccol1%2Chigh%2Clow%2Ccol2'&format=json",
            dataType: 'json',
        success: function(data) { 
            console.log(data);
            var name = data.query.results.row.name;
            var last_trade = data.query.results.row.last_trade_price;
            var last_trade_size = data.query.results.row.time;
            var change = data.query.results.row.low;

            $.each(data, function(index, value) {
                $("#stock").append('Name:'+name+ 'Symbol:' +symbol+ 'Last Trade:' +last_trade+ 'Last Trade Size:' +last_trade_size+ 'Change:'+change);
            });

    },
        error: function() {
            $("#stock").html('<p>Something has gone terribly wrong.</p>');
        }
    });

};
    //call initialize
    return {init: initialize};
}());
//call headerNav
this.getStocks = getStocks;
}).call(this); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:56:01.603

你想`data.query.results.row`在你的`each`

```
var symbol = ["GOOG", "AAPL", "A", "AA", "ABT"];

$.ajax({
  url: "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20csv%20where%20url%3D'http%3A%2F%2Fdownload.finance.yahoo.com%2Fd%2Fquotes.csv%3Fs%3D" + symbol + "%26f%3Dnsl1d1t1c1ohgv%26e%3D.csv'%20and%20columns%3D'name%2Csymbol%2Clast_trade_price%2Cdate%2Ctime%2Cchange%2Ccol1%2Chigh%2Clow%2Ccol2'&format=json",
  dataType: 'json',
  success: function (data) {
    console.log(data);

    $.each(data.query.results.row, function (index, item) {
      $("body").append('Name:' + item.name + 'Symbol:' +item. symbol + 'Last Trade:' + item.last_trade_price + 'Last Trade Size:' + item.last_trade_size + 'Change:' + item.change+'<br><br><br>');
    });

  },
  error: function () {
    $("#stock").html('<p>Something has gone terribly wrong.</p>');
  }
}); 
```

演示：http: [//jsfiddle.net/2LkLb/](http://jsfiddle.net/2LkLb/)

我会先检查它是否`data.query.results.row`存在。我记得如果由于某种原因未获取数据，YQL 也会返回错误消息。

在浏览器控制台中可以检查数据对象，可能是其中的一个属性，类似于`status`. YQL 文档也会有所帮助

# c# - 发现 WCF 服务无法连接

> ID：14310315
> 
> 赞同：1
> 
> 时间：2013-01-14T01:33:52.950
> 
> 标签：c#, wcf, .net-4.5

我有一个 WCF 服务，用于公开数据源（通过 EF 模型连接）。由于某种原因，我的端点刚刚停止响应。

直到我最后一次更改之前，我只是在我的应用程序启动时提取数据。我现在正在努力在此基础上添加一个订阅/发布模型，这样我就可以在 WCF 服务遇到导致数据更改的事件时引发事件（可以在客户端执行此操作，但我不会捕获其他用户变化）。

我一直在关注 Microsoft 的示例：http: [//msdn.microsoft.com/en-us/library/ms752254.aspx](http://msdn.microsoft.com/en-us/library/ms752254.aspx)并为我的服务接口和实现添加了适当的装饰，并添加了订阅/取消订阅 OperationContract 等。我而不是尝试启动服务并且无法连接。

然后我从我的客户那里删除了服务参考并尝试重新附加。这是奇怪的事情：

1) WCF 服务在开发者主机中构建和启动。2) 未触及 Web.Config 文件。3）vs 2012 中添加服务参考中的“发现服务”选项可以看到该服务，但是当我尝试实际接受发现的服务时，它会抛出一个错误，提示“从地址下载元数据时出错。

我不明白它如何发现服务，然后无法将其添加为参考。我可以看看我是否自己添加了信息，但它找到了。

作为添加发布功能的一部分，我将 SessionMode.Required 标记添加到界面中，我不太确定 WCF 如何处理会话，也不必在我的编码中的其他任何地方处理会话（通常从源中提取数据而不是在本地处理它是我过去需要制作的工具类型，因此不需要在服务器端保留任何状态）。

有任何想法吗？

我的服务 web.config：

> ```
> <connectionStrings>
>   <add name="TaskModelContainer" connectionString="metadata=res://*/TaskModel.csdl|res://*/TaskModel.ssdl|res://*/TaskModel.msl;provider=System.Data.SqlClient;provider 
> ```
> 
> 连接字符串="数据源=winhacker\sqlexpress；初始目录=TaskDB；集成安全=True；MultipleActiveResultSets=True；App=EntityFramework"" providerName="System.Data.EntityClient"/>

注意：请注意，确保大多数文件的格式化不会显示在预览中，但足以说明它是自动生成的样板文件，而不是我添加了一个 connectionStrings 部分来喜欢我的 EF 数据点。如果您想查看文件，单击“编辑”似乎会显示我复制的源代码，尽管格式有点奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T01:43:12.020

在我遇到此错误的绝大多数情况下，问题是服务器端的序列化问题；WCF 在元数据发现阶段会抛出一个关于这个的异常，但是 VS 不会显示这个异常。

为了解决这个问题，您需要添加一个诊断部分以`web.config`将 WCF 信息捕获到一个`svclog`文件中，然后使用 Microsoft 的[服务跟踪查看器](http://msdn.microsoft.com/en-us/library/ms732023.aspx)检查日志并发现实际抛出的异常。

该`web.config`部分应如下所示：

```
 <system.diagnostics>
    <sources>
      <source name="System.ServiceModel"
              switchValue="Information, ActivityTracing"
              propagateActivity="true">
        <listeners>
          <add name="traceListener"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData="c:\log\WebTrace.svclog"  />
        </listeners>
      </source>
    </sources>
  </system.diagnostics> 
```

并在`<configuration>`级别添加。

添加配置并确保指定目录存在后，再次尝试添加服务引用。这应该会导致生成指定的 svclog 文件。

如果您在那台机器上安装了 VS，您应该能够在 Windows 资源管理器中双击该文件并在该工具中自动打开日志。

打开日志后，查看左侧窗格中的活动列表，然后单击红色的第一个。然后，在右上角的窗格中，选择第一个红色的（或显示异常，我忘记了）。然后，您可以单击它以查看详细信息，包括右下窗格中的异常信息。

# java - 流音频幅度的有源阵列

> ID：14310316
> 
> 赞同：0
> 
> 时间：2013-01-14T01:34:07.800
> 
> 标签：java, android, audio, streaming

我想知道是否有人知道如何将 Android 设备麦克风的连续输入转换为字节数组或时间幅度坐标。我想要做的是获取一组数据，以便

> 数组[时间]=幅度

这必须是活动的，这是我前进道路上的主要障碍之一，因为大多数音频波形绘制者都依赖于封闭的文件。谁能指导我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T06:38:15.447

你对`time`应该是什么有什么特殊要求吗？PCM 流（这是您在使用`AudioRecord`该类时得到的）根据定义是定期采样的输入信号幅度的数字表示。

因此，如果您以 48 kHz 单声道录制，您从 AudioRecord 读取的 PCM 数据数组中的每个样本都将代表音频信号在时间 N*20.83 us 处的幅度。

# php - php中用于数组的foreach控制结构

> ID：14310318
> 
> 赞同：0
> 
> 时间：2013-01-14T01:34:14.507
> 
> 标签：php, arrays, foreach, iteration

```
$myarray = array("Jim", "Jane", "Tom");
foreach($myarray as $value)
{
    $a = 0;
    echo $a;
    $a++;
} 
```

输出 000。为什么 $a 变量在每次迭代时不加 1。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T01:35:31.287

将 $a 移出循环，因为 $a 始终声明为 0

```
$a = 0;
$myarray = array("Jim", "Jane", "Tom");
foreach($myarray as $value)
{
    echo $a;
    $a++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:54:16.320

类的答案涵盖了当前的问题，但它也可能对您有用，因为您知道您可以首先对索引采取更简单的方法，例如：

```
$myarray = array("Jim", "Jane", "Tom");
foreach(array_keys($myarray) as $i)
{
    echo $i;
    echo $myarray[$i];
} 
```

# javascript - 对复杂的 JavaScript 数组进行排序

> ID：14310319
> 
> 赞同：1
> 
> 时间：2013-01-14T01:34:26.350
> 
> 标签：javascript

> **可能重复：**
> [如何对 javascript 对象数组进行排序？](https://stackoverflow.com/questions/979256/how-to-sort-an-array-of-javascript-objects)

我正在尝试将一些旧的 ActionScript 2.0 代码转换为 JavaScript。一切正常，但我无法按分数对数组进行数字排序。

在我使用的原始 ActionScript 代码中：

```
// Sort the capitals array so that the capitals with the lowest score will be at the top
capitalsList.sortOn("score", Array.NUMERIC); 
```

这工作正常，但在 JavaScript 中不起作用。我将其更改为：

```
capitalsList.sort("score", Array.NUMERIC); 
```

但是阿拉巴马州仍然被输出（康涅狄格州应该被输出，因为它的分数是-1）。我错过了什么？

我在 JS Bin 上的脚本：http: [//jsbin.com/ibitez/1/edit](http://jsbin.com/ibitez/1/edit)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<script>
window.onload = function() {

    function capitalsConstructor(capitalName, stateName, score) {
        this.capitalName = capitalName;
        this.stateName = stateName;
        this.score = score;
    }

    // Create state capitals array
    var capitalsList = new Array();

    // All 50 capitals are loaded into the array with a score of 0
    // Sample limited to 10 capitals
    capitalsList[0] = new capitalsConstructor("Montgomery", "Alabama", 0);
    capitalsList[1] = new capitalsConstructor("Juneau", "Alaska", 0);
    capitalsList[2] = new capitalsConstructor("Phoenix", "Arizona", 0);
    capitalsList[3] = new capitalsConstructor("Little Rock", "Arkansas", 0);
    capitalsList[4] = new capitalsConstructor("Sacramento", "California", 0);
    capitalsList[5] = new capitalsConstructor("Denver", "Colorado", 0);
    capitalsList[6] = new capitalsConstructor("Hartford", "Connecticut", -1);
    capitalsList[7] = new capitalsConstructor("Dover", "Delaware", 0);
    capitalsList[8] = new capitalsConstructor("Tallahassee", "Florida", 0);
    capitalsList[9] = new capitalsConstructor("Atlanta", "Georgia", 0);

    capitalsList.sort("score", Array.NUMERIC);

    solution = capitalsList[0].stateName;

    document.getElementById("divSolution").innerText = solution;
}
</script>
</head>

<body>
<div id="divSolution"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T01:36:11.090

您必须为该[方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort#Examples)[提供回调`sort`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort#Examples)：

```
capitalsList = capitalsList.sort(function (a, b) {
    return a.score - b.score;
}); 
```

这是小提琴：http: [//jsfiddle.net/g2CQG/](http://jsfiddle.net/g2CQG/)

# javascript - 使用 javascript 在前端进行访问控制

> ID：14310321
> 
> 赞同：0
> 
> 时间：2013-01-14T01:34:39.513
> 
> 标签：javascript, access-control

这是场景。我正在开发一个单页应用程序：

*   大部分操作都是通过ajax来实现的。
*   页面应该在不同的用户登录状态下显示不同的组件（管理员、普通用户、访问者......）
*   页面中有很多动画。

是否意味着每次点击按钮都需要检查用户是否登录（有些按钮可以展开为菜单，其组件根据登录状态部分显示）？

有没有更好的可能解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:09:42.163

根据用户权限使用 UI 对象（例如菜单选项）可能是一个好主意。您的服务器端代码可以返回一些 JSON，其中仅包含当前用户可以看到的菜单选项，并且您使用该对象为该用户构建前端。因此，如果用户单击按钮以展开菜单，您无需检查任何内容，只需显示最初从服务器返回的内容。

每次有人在系统中执行“有意义的”操作（例如重命名对象或请求某些数据或删除某些内容）时，您都应该检查权限。这个检查可以很容易地内置到你的后端 API 中......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T01:51:02.533

是的你应该。只有服务器知道谁应该和不应该做某些动作。必须在服务器端进行检查。永远不要相信客户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T01:54:14.630

是的，为了安全起见，您需要让服务器权威地决定客户端可以做什么和不能做什么。因为 javascript 是在客户端运行的，所以任何人都可以修改它并让它按照自己的意愿运行。服务器由您控制，您必须使用它来确保客户端的任何请求都是有效的，然后相应地执行或拒绝它们。

服务器应该几乎总是以这种方式具有权威性。

# vba - Excel VBA - 'IF' 'OR' 公式导致编译错误：语法错误

> ID：14310322
> 
> 赞同：1
> 
> 时间：2013-01-14T01:34:43.397
> 
> 标签：vba, if-statement, excel, excel-formula

我在 excel 中编写了一个简单的 'IF' 'OR' 公式，用于检查单元格值是否等于六字符产品代码；'IF' 测试简单地询问单元格 A5 = “[产品代码]”。如果是，则公式返回“是”，否则返回“否”。

我试图编写一个简单的宏来为我输入公式。我似乎收到了一个错误，其中统计信息：

> **“编译错误：语法错误”**

我的公式稍微缩短的是：

```
=IF(OR($A5="OIASLS",$A5="BMA003",$A5="CBRNSR",$A5="DTAPCO", [I have shorted the formula from here].................Yes","No"). 
```

我的 VBA 代码是：

```
Sub LevelTwoCourse()
'Formula to test if Product is a level 2 product. If Product code matches any code listed below formula returns "yes"
    Range("AF5").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(OR(RC1=""OIASLS"",RC1=""BMA003"",RC1=""CBRNSR"",RC1=""DTAPCO"",RC1=""DTAPMC"",RC1=""DTAPMD"",RC1=""DTBFDR"",RC1=""DTBFFL"",RC1=""DTBLAS"",RC1=""DTDVFL"",RC1=""DTDVFR"",RC1=""DTDVVF"",RC1=""DTHLDR"",RC1=""DTHVCR"",RC1=""DTHVDR"",RC1=""DTHVHO"",RC1=""DTHVHR"",RC1=""DTLG3D"",RC1=""DTLG7D"",RC1=""DTLGAF"",RC1=""DTLGAS"",RC1=""DTLGEF"",RC1=""DTLGEX"",RC1=""DTLGFR"",R"& _
        "GHP"",RC1=""DTLGMC"",RC1=""DTMPOP"",RC1=""DTMPRF"",RC1=""DTOSMD"",RC1=""DTOTLD"",RC1=""DTRSDE"",RC1=""DTRSHP"",RC1=""DTRSRA"",RC1=""DTRSRC"",RC1=""DTRSRE"",RC1=""DTRSSP"",RC1=""DTRSSS"",RC1=""DTRSST"",RC1=""DTRSVH"",RC1=""DTRSYT"",RC1=""DTSCS1"",RC1=""DTTLMC"",RC1=""DTTLMD"",RC1=""FCFSHE"",RC1=""FCFSHS"",RC1=""FSCHVR"",RC1=""FSRU08"",RC1=""HRDRPM"",RC1=""IMASCM"",RC"& _
        "M"",RC1=""IMTHCM"",RC1=""IMTHWM"",RC1=""INPDMR"",RC1=""OBATTP"",RC1=""OIBACF"",RC1=""OIBAE2"",RC1=""OIBAEC"",RC1=""OIBAER"",RC1=""OIBAEY"",RC1=""OIBAM3"",RC1=""OIBAMT"",RC1=""OIBRFC"",RC1=""OIBRFR"",RC1=""OIFA4N"",RC1=""OIFBTF"",RC1=""OIHMSC"",RC1=""OIIE3D"",RC1=""OIIE5D"",RC1=""OIIEDA"",RC1=""OILOL2"",RC1=""OILOMA"",RC1=""OIRTOD"",RC1=""OISKFM"",RC1=""OISKFN"",RC1="& _
        "",RC1=""OISKIA"",RC1=""OISKIB"",RC1=""OISKPB"",RC1=""OISKPR"",RC1=""OISKSW"",RC1=""OISKTR"",RC1=""OISKWR"",RC1=""OISPLR"",RC1=""OISRTR"",RC1=""OIUKRO"",RC1=""OIWSBA"",RC1=""OIWSBB"",RC1=""OIWSBC"",RC1=""OIWSBD"",RC1=""OIWSBE"",RC1=""OIWSBF"",RC1=""OIWSBG"",RC1=""DTEXE1"",RC1=""FSRWMM"",RC1=""OIAPPP"",RC1=""OIAPPR"",RC1=""OIASLR"",RC1=""BMA001"",RC1=""BMA002"",RC1="""& _
        "RC1=""CBRNB2"",RC1=""CBRNBR"",RC1=""CBRNGI"",RC1=""CBRNGR"",RC1=""CBRNLO"",RC1=""CBRNSI"",RC1=""DTAPCR"",RC1=""DTAWDM"",RC1=""DTBFFR"",RC1=""DTBFIR"",RC1=""DTDVCB"",RC1=""DTDVCR"",RC1=""DTLGBR"",RC1=""DTOTHD"",RC1=""DTRSCE"",RC1=""DTRSCP"",RC1=""DTUSD1"",RC1=""FCFSDT"",RC1=""FCFSHR"",RC1=""FCSKRT"",RC1=""FSENG1"",RC1=""FSENG2"",RC1=""FSENG3"",RC1=""FSENG4"",RC1=""FS"& _
        "1=""FSRU02"",RC1=""FSRU03"",RC1=""FSRU04"",RC1=""FSRU05"",RC1=""FSRU06"",RC1=""FSRU07"",RC1=""FSRU09"",RC1=""FSRU10"",RC1=""FSRU11"",RC1=""FSRU12"",RC1=""FSRU15"",RC1=""FSRU16"",RC1=""FSRU17"",RC1=""FSRU18"",RC1=""FSRV01"",RC1=""FSRV02"",RC1=""FSRV03"",RC1=""FSRV04"",RC1=""FSRV05"",RC1=""FSRV06"",RC1=""FSRV07"",RC1=""FSRV08"",RC1=""FSRV09"",RC1=""FSRV10"",RC1=""FSRV"& _
        """FSRV12"",RC1=""FSRV15"",RC1=""FSRV16"",RC1=""FSRV17"",RC1=""FSRV18"",RC1=""HSSKPT"",RC1=""HSSLFT"",RC1=""INPLRF"",RC1=""OBATTW"",RC1=""OIBABI"",RC1=""OIBAR2"",RC1=""OIBASA"",RC1=""OIFA2N"",RC1=""OIFBCE"",RC1=""OIFBTE"",RC1=""OIFBTI"",RC1=""OIFHCO"",RC1=""OIFSUR"",RC1=""OIHCHM"",RC1=""OIHRPS"",RC1=""OIHSTD"",RC1=""OILOHC"",RC1=""OIRTIN"",RC1=""OISKEX"",RC1=""OISKHA"& _
        "OISKHF"",RC1=""OISKII"",RC1=""OISKMT"",RC1=""OISKSS"",RC1=""OISKUH"",RC1=""OISLEI"",RC1=""OIUKEC"",RC1=""OIUSCH"",RC1=""OIUSCR"",RC1=""OIUSLA""),""Yes"",""No"")"
End Sub 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T05:13:37.497

我同意查夫！与其编写如此庞大的公式，为什么不将该列表保存在单独的列中，然后检查相关单元格是否与该值匹配？

例如，假设我们维护一个列表（见下面`Col A`的`Sheet2`截图）

所以一个简单的公式`B1`来`Sheet1`检查是否`A1`有这个词将完全解决你的问题。另一个**好处**是您可以在**不**修改公式的情况下**增加/减少**您的列表`Col A``Sheet2`

 **```
=IF(COUNTIF(Sheet2!A:A,Sheet1!A1)>0,"Yes","No") 
```

上述的 VBA 代码将是

```
Range("B1").Formula = "=IF(COUNTIF(Sheet2!A:A,Sheet1!A1)>0,""Yes"",""No"")" 
```

您现在可以修改上述公式/代码以满足您的需要:)

**截屏**

![在此处输入图像描述](../Images/ab2c1cea2755578bec437d62a249b56a.png)**

# python - MySQL 上 Django 中的列数据太长

> ID：14310326
> 
> 赞同：1
> 
> 时间：2013-01-14T01:35:02.413
> 
> 标签：python, mysql, django, textfield

对于模型中声明为并且在数据库中是 LONGTEXT 的列，我收到此错误`TextField`，并且我尝试插入的值只有 3KB 长。AFAIK LONGTEXT 理论限制是 2GB，所以我不知道为什么会有限制或如何绕过它。有任何想法吗？

我得到的具体例外是：

```
 File "C:\Projetos\iapyx\servers\itese2\views\documents.py", line 46, in create
    self._saveItem(item)

  File "C:\Projetos\iapyx\servers\itese2\views\documents.py", line 59, in _saveItem
    doc.save()

  File "C:\Python27\lib\site-packages\django\db\models\base.py", line 460, in save
    self.save_base(using=using, force_insert=force_insert, force_update=force_update)

  File "C:\Python27\lib\site-packages\django\db\models\base.py", line 553, in save_base
    result = manager._insert(values, return_id=update_pk, using=using)

  File "C:\Python27\lib\site-packages\django\db\models\manager.py", line 195, in _insert
    return insert_query(self.model, values, **kwargs)

  File "C:\Python27\lib\site-packages\django\db\models\query.py", line 1436, in insert_query
    return query.get_compiler(using=using).execute_sql(return_id)

  File "C:\Python27\lib\site-packages\django\db\models\sql\compiler.py", line 791, in execute_sql
    cursor = super(SQLInsertCompiler, self).execute_sql(None)

  File "C:\Python27\lib\site-packages\django\db\models\sql\compiler.py", line 735, in execute_sql
    cursor.execute(sql, params)

  File "C:\Python27\lib\site-packages\django\db\backends\util.py", line 34, in execute
    return self.cursor.execute(sql, params)

  File "C:\Python27\lib\site-packages\django\db\backends\mysql\base.py", line 89, in execute
    return self.cursor.execute(query, args)

  File "C:\Python27\lib\site-packages\MySQLdb\cursors.py", line 174, in execute
    self.errorhandler(self, exc, value)

  File "C:\Python27\lib\site-packages\MySQLdb\connections.py", line 36, in defaulterrorhandler
    raise errorclass, errorvalue 

   DatabaseError: (1406, "Data too long for column 'text' at row 1") 
```

这是导致错误的内容示例：

```
But is this the case across nations? Does increasing creativity necessarily lead to increased economic inequality? To get at this, we examine the relationship between the GCI and a standard measure of income inequality—the Gini Index. Exhibit 19 shows the relationships between income inequality and the GCI overall as well as each of the 3 T indices that comprise it. While this may come as a surprise for those familiar with the case of the United States, we find that the GCI is in fact systematically associated with lower levels of socio-economic inequality—and hence greater equality—across the nations of the world. Each and every one of the correlations between the GCI and the Gini is negative. The correlation between inequality and the overall GCI is −0.43\. The Gini is also quite negatively associated with Technology (− 0.47) and Talent (−0.52) but much less so with Tolerance (− 0.06 and not statistically significant). This last is a bit surprising as one might expect more tolerant societies to be more equal on balance. That said, we believe the overall finding of a negative association between creativity and inequality to be an important one, for it implies that the general trajectory of economic development is associated with lower levels of inequality. Exhibit 20 is a scatter-graph which plots the association between the Gini measure of income inequality and the GCI for the nations of the world. The fit is not especially good and there are lots of countries above and below the line. This suggests that there are two distinctive paths for high creativity countries. On the one hand, there are countries like the United States, the United Kingdom, Singapore, and to a lesser extent, Australia and New Zealand, where high levels of creativity, productivity and economic competitiveness go hand in hand with higher levels of inequality. But there are also a substantial number of countries where high levels of creativity, competitiveness and productivity combine with much lower low levels of inequality. These are largely Scandinavian and Northern

European countries, including Sweden, Denmark, Finland, Norway, the Netherlands, and Germany. Japan is represented as well. Among the less developed nations, we find high levels of inequality in South American nations like Paraguay, Bolivia, Panama, Brazil, Honduras, Ecuador, and Argentina. Of the BRIC nations, China, Russia and particularily Brazil all exhibit much higher levels of inequality than their GCI scores would predict. There appears to be two distinct paths available to high creative development: for every high-creativity, high-inequality nation there is a high-creativity, low-inequality counterpart. This is a likely reflection of these countries’ differing levels of social welfare. Though more systematic study is needed before we can draw any firm conclusions, this finding gives us reason for optimism; at the same time, it suggests that sustainable, long-term prosperity requires a significant investment in education and skill development. This is the topic to which we now turn.

The GCI and Human Development
What is the connection between creativity and human development? To get at this, we explore the association between the GCI and the United Nations’ Human Development Index [27]. “People often value achievements that do not show up at all, or not immediately,

The GCI and inequality (correlations)

Exhibit 19

Talent

Tolerance

Technology

Global Creativity Index

−0.6

−0.4

−0.2

0.0

Correlation with Income Inequality

22 | Creativity and Prosperity: The 2010 Global Creativity Index 
```

注意出现在某些数字之前的“-”实际上是 +- 特殊字符，以 UTF-8 编码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T12:49:31.143

确保您的数据实际上是 UTF8 编码的。真的是专栏`utf8`吗？

如果不是，MySQL 可能会引发此错误。您可以通过执行`INSERT IGNORE`语句并查看插入数据库的内容来测试这一点（除其他外）。

您可以检查`information_schema`表[、列和数据库](https://stackoverflow.com/a/1049958/1901658)，看看是否是这种情况。

# java - 单击时获取 JButton 的名称

> ID：14310331
> 
> 赞同：2
> 
> 时间：2013-01-14T01:35:41.043
> 
> 标签：java, swing, jbutton, output, actionevent

```
 @Override
  public void actionPerformed(ActionEvent e) {
      if (e.getSource() == thirdBtn) {
          //System.out.println("Third Button Click");
          System.out.println(e.getSource()+" Click");
      }
  } 
```

在上面的代码中，我想知道是否不这样做：

```
//System.out.println("Third Button Click"); 
```

如果我能做这样的事情：

```
System.out.println(e.getSource()+" Click"); 
```

但是代码输出：

```
BlackJack.OverBoard$BlackJackButton[,440,395,100x25,alignmentX=0.0,alignmentY=0.5,
    border=javax.swing.plaf.BorderUIResource$CompoundBorderUIResource@7a3d8738,
    flags=16777504,maximumSize=,minimumSize=,preferredSize=,
    defaultIcon=,disabledIcon=,disabledSelectedIcon=,
    margin=javax.swing.plaf.InsetsUIResource[top=2,left=14,bottom=2,right=14],
    paintBorder=false,paintFocus=true,
    pressedIcon=,rolloverEnabled=true,rolloverIcon=,rolloverSelectedIcon=,selectedIcon=,
    text=Change,defaultCapable=true] Click 
```

我不想要这个，我想知道如何获取`JButton`名称并在点击时输出。

***编辑：***

有些人很困惑。当我说“名字”时（也许这是错误的词），我的意思是说你初始化一个`JButton`

```
JButton btnExample = new JButton(); 
```

我想要它，以便当您单击按钮时，它会`btnExample`在控制台中输出。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T01:40:49.593

如果您知道只有 JComponents 将是`e.getSource()`我`JComponent`用作强制转换的返回值，则可以强制转换为 JComponent，因为它提供了更大的灵活性。如果您只使用`JButtons`，则可以安全地转换为 a `JButton`。

```
 @Override
            public void actionPerformed(ActionEvent e) {
                if (e.getSource() == thirdBtn) {
                    //System.out.println("Third Button Click");
                    System.out.println(((JComponent) e.getSource()).getName()+" Click");
                }
            } 
```

随意替换`getName()`为`getText()`，具体取决于您的具体需要。

此外，该`==`运算符仅应用于比较对象引用，因此请考虑从头开始转换为 JComponent 并`.equals()`在名称或文本上使用。

**编辑** 您不能输出*变量*的名称，但您可以设置 JComponent 的名称/文本。例如

```
JButton btnExample = new JButton();
btnExample.setName("btnExample"); 
```

或者，如果您希望“btnExample”实际显示在按钮上：

```
JButton btnExample = new JButton();
btnExample.setText("btnExample"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-14T01:39:51.170

```
System.out.println(((JButton) e.getSource()).getName() + " Click"); 
```

# ios - 如何在 UIScrollView 中实现 scrollViewDidScroll

> ID：14310332
> 
> 赞同：5
> 
> 时间：2013-01-14T01:35:43.837
> 
> 标签：ios, objective-c, uikit

我遇到了一个问题，当我`scrollViewDidScroll`在我的子类中调用该方法时`UIScrollView`没有任何反应。这是我的代码：

**AppDelegate.m**

```
#import "ScrollView.h"

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    CGRect screenRect = [[self window] bounds];

    ScrollView *scrollView = [[ScrollView alloc] initWithFrame:screenRect];
    [[self window] addSubview:scrollView];
    [scrollView setContentSize:screenRect.size];

    self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];
    return YES;
} 
```

**滚动视图.m**

```
#import "AppDelegate.h"
#import "ScrollView.h"

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        NSString *imageString = [NSString stringWithFormat:@"image"];
        UIImage *image = [UIImage imageNamed:imageString];
        UIImageView *imageView = [[UIImageView alloc] initWithImage:image];

        [super addSubview:imageView];
    }
    return self;
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    NSLog(@"%f", scrollView.contentOffset.y);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T01:56:00.370

在

```
- (id)initWithFrame:(CGRect)frame 
```

添加

```
self.delegate = self; 
```

或在 AppDelegate.m 中，滚动视图启动后，添加此代码

```
scrollview.delegate = self; 
```

当然，你必须实现委托方法

```
scrollViewDidScroll: 
```

并且不要忘记在 AppDelegate.h 中添加以下代码

```
@interface AppDelegate : UIResponder <UIApplicationDelegate,UIScrollViewDelegate> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-11-20T12:31:59.363

> 对于 iOS10，SWift 3.0 在 UIScrollView 上实现 scrollViewDidScroll

```
class ViewController: UIViewController, UIScrollViewDelegate{

//In viewDidLoad Set delegate method to self.

@IBOutlet var mainScrollView: UIScrollView!

override func viewDidLoad() {
    super.viewDidLoad()

    self.mainScrollView.delegate = self

}
//And finally you implement the methods you want your class to get.
func scrollViewDidScroll(_ scrollView: UIScrollView!) {
    // This will be called every time the user scrolls the scroll view with their finger
    // so each time this is called, contentOffset should be different.

    print(self.mainScrollView.contentOffset.y)

    //Additional workaround here.
}
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-11T08:40:50.980

第 1 步：为 UIViewController 类创建委托：

```
 @interface ViewController : UIViewController <UIScrollViewDelegate> 
```

`UIScrollView`第 2 步：然后为您的对象添加委托：

```
 scrollview.delegate = self; 
```

第 3 步：实现 Delegate 方法如下：

```
 - (void)scrollViewDidScroll:(UIScrollView *)scrollView {
     // Do your stuff here...
     // You can also track the direction of UIScrollView here....
     // to check the y position use scrollView.contentOffset.y
 } 
```

干得好。借助以上 3 个步骤，您可以将`ScrollViewDidScroll`方法集成到我们的`Objective-C`类中。

# perl - 在这种情况下，Perl 会拿什么来比较？

> ID：14310335
> 
> 赞同：1
> 
> 时间：2013-01-14T01:37:15.597
> 
> 标签：perl, operators

只是对这种比较感兴趣，有什么线索吗？

假设有两个变量如下：

```
$p1 = "2013-01-11/2013-01-04";
$p2 = "2013-01-12/2012-01-05"; 
```

如果像下面的 Perl 代码，

```
if $p1 lt $p2 
```

Perl 将拿什么来比较以及如何比较？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T01:45:17.350

`lt`是字符串比较运算符，它在字面意义上比较两个操作数。

在你的情况下，两个字符串

```
2013-01-11/2013-01-04
||||||||||
2013-01-12/2012-01-05 
```

将按照图示的方式进行比较，并停在第 9 位（第 1 位字符不同，还要注意字符串索引从 0 开始），即`1`in`$p1`和`2`in `$p2`。而且也`1`比`2`字面意思要少。也是如此`$p1 lt $2`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-14T01:53:00.633

分解你的任务：

*   将您的字符串分成 (start_stringtime, end_stringtime) 字符串对
*   将字符串对中的每个字符串转换为日期时间
    （为此有[大量模块](http://www.perl.com/pub/2003/03/13/datetime.html)，请选择适合您任务的模块）
*   计算每对的时间段
*   以数字方式比较时间段 -`if $p1 < $p2`

这个问题：
[将字符串“20-May-07”转换为日期和操作](https://stackoverflow.com/questions/12199284/convert-string-20-may-07-to-date-and-manipulate)

会给你一些线索

# mongodb - 是否可以从 MongoDB 中提取多个子数组？

> ID：14310338
> 
> 赞同：1
> 
> 时间：2013-01-14T01:38:36.503
> 
> 标签：mongodb

采取以下措施。`_id = 1`我可以通过执行以下操作来提取匹配“1967”的记录。是否可以打印与 1967 年匹配的奖项和与“Penn”匹配的学校名称？

```
db.bios.find({_id:1, "awards.year" : 1967},{"awards.$":1}).pretty()

db.bios.insert(
    {
        _id: 1,
        awards: [
            {
                award: 'W.W. McDowell Award',
                year: 1967,
                by: 'IEEE Computer Society'
            },
            {
                award: 'National Medal of Science',
                year: 1975,
                by: 'National Science Foundation'
            },
         ],
         "schools" : [
             {
                name : "Harvard",
                year : 1945
             },
             {
                name : "Penn",
                year : 1950
             }
         ]
    }
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:26:14.327

从 v2.2.2 开始，每个查询只能使用一个`$`位置运算符，但可以[`$elemMatch`](http://docs.mongodb.org/manual/reference/projection/elemMatch/)多次使用投影运算符来执行此操作：

```
db.bios.find({_id:1}, {
    awards: {$elemMatch: {year: 1967}}, 
    schools: {$elemMatch: {name: "Penn"}}
}).pretty() 
```

输出：

```
{
  "_id": 1,
  "awards": [
    {
      "award": "W.W. McDowell Award",
      "year": 1967,
      "by": "IEEE Computer Society"
    }
  ],
  "schools": [
    {
      "name": "Penn",
      "year": 1950
    }
  ]
} 
```

# phpstorm - 在 phpstorm 中使用远程服务器

> ID：14310339
> 
> 赞同：11
> 
> 时间：2013-01-14T01:38:39.347
> 
> 标签：phpstorm, remote-server

我目前使用 Komodo 并直接在远程服务器上工作。我刚刚发现了 phpstorm，我想开始尝试一下。

我的问题是，我怎样才能像 Komodo 那样在远程服务器上工作？我真的不明白该怎么做！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-26T18:39:41.210

**PhpStorm（从 7.1 开始）不支持直接在远程服务器上工作**。

正如@CrazyCoder 提到的那样，您应该[在这里投票支持该功能。](http://youtrack.jetbrains.net/issue/WI-1398)

* * *

# SFTP 的临时替代方案

您可以使用 SSHFS 挂载直接处理远程服务器上的文件。这并不理想，但我发现它工作正常。

我使用以下命令和设置（在 Mac 上）。

安装：

`sshfs -o IdentityFile=~/.ssh/id_rsa root@xxx.xxx.xxx.xxx:/ ~/sshfs_mounts/example -oauto_cache,reconnect,defer_permissions,noappledouble,volname=example`

卸载：

`umount ~/sshfs_mounts/example`

有关更多信息，请参阅[http://benohead.com/mac-os-x-use-sshfs-to-mount-a-remote-directory-as-a-volume/](http://benohead.com/mac-os-x-use-sshfs-to-mount-a-remote-directory-as-a-volume/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-24T08:02:47.260

正如@LazyOne 评论的那样，现在不可能。您可以[为相关的功能请求投票](http://youtrack.jetbrains.net/issue/WI-1398)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-04T13:42:52.243

phpstorm 有两个非常有用的特性来处理远程服务器。

1.  当您提交时，它可以自动部署/上传到远程位置（sftp、ftp）。
2.  当您提交时，您还可以推送到远程位置 git 或其他 vcs。

如前所述，它是正确的，phpstorm 也需要代码的本地副本。

# c - 为什么我需要 C 头文件？

> ID：14310341
> 
> 赞同：5
> 
> 时间：2013-01-14T01:39:03.887
> 
> 标签：c, compiler-construction, header, makefile

这是一个愚蠢的问题，我承认。代码会更好地解释它。得到这些文件：

你好ç：

```
#include <stdio.h>

void hello(char * s)
{
    printf("hello, %s\n", s);
} 
```

主.c：

```
int main()
{
    hello("world!");
    return 0;
} 
```

生成文件：

```
test : main.o hello.o
    gcc -o test main.o hello.o

main.o : main.c
    gcc -c main.c

hello.o : hello.c
    gcc -c hello.c

.PHONY : clean
clean :
    -rm test
    -rm main.o
    -rm hello.o 
```

我可以“制作”和“./test”它并且它可以工作。我不应该在 main.c 中包含类似 hello.h 的内容，以便编译器知道函数原型吗？

我什至没有在任何地方包含 hello.c，它就可以工作！main.c 怎么知道 hello 函数？

如果可行，我什么时候需要 .h 文件？我是 C 编程的新手，但我认为这个概念很容易掌握，现在我完全糊涂了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-14T01:41:24.880

如果您使用该`-Wall`标志（并且应该*始终*使用它，以及`-Werror -Wextra`），那么您将收到以下消息：

```
main.c: In function 'main':
main.c:3: warning: implicit declaration of function 'hello' 
```

并且编译器有效地“猜测”了要做什么，这在许多情况下可能会导致灾难。

正确使用头文件可以避免这种警告。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-14T01:43:57.420

你不需要头文件；相反，您的函数需要*原型*。当您调用`hello`传递它时`"world"`，C 会发现您正在调用一个单参数函数 take `char*`，并且一切正常。`int`但是，如果该函数采用浮点数，并且您决定将其设置为 as （尝试一下，它非常有启发性），则这将不起作用 。出于向后兼容的原因，C 将允许您在没有原型的情况下调用函数，但这很危险。例如，在您调用 的情况下`hello`，编译器认为您正在调用一个返回`int`. 从技术上讲，您正在调用未定义的行为，因此您的程序会意外运行。

标头恰好提供了提供原型的最方便的方法，但您可以在代码本身中提供它们，如下所示：

```
void hello(char*);

int main()
{
    hello("world!");
    return 0;
} 
```

# iphone - 具有不同 API 的多个 OpenGL 上下文

> ID：14310343
> 
> 赞同：0
> 
> 时间：2013-01-14T01:39:25.530
> 
> 标签：iphone, ipad, opengl-es, opengl-es-2.0

我试图在[我的应用程序](https://itunes.apple.com/us/app/exoplanet/id327702034?mt=8)中同时使用多个 OpenGL 上下文。这是一个相当混乱的设置，在三个 UITableViewCells 中有三个 OpenGL 上下文。UITableView 本身显示在全屏 GLKView 上方的 UIPopoverView 中（见下文）。背景中的上下文使用 OpenGL ES 2.0，顶部的较小上下文使用 OpenGL ES 1.1。较小的上下文是同一共享组的成员。背景中的那个不是。

也许令人惊讶的是，这实际上按预期工作！并且非常可靠。我只对其中一种情况有问题，而且很少见。如果我删除这一上下文，一切正常。但是，在极少数情况下，我在调用`[context presentRenderbuffer:GL_RENDERBUFFER_OES];`.

我的问题有点宽泛，但我想知道在这种情况下我应该注意什么？是否有其他人同时成功使用 OpenGL ES 1.1 和 2.0？

（我查看了 OpenGL ES Analyzer 工具，但找不到任何看起来很严重的东西。）

![Exoplanet 应用程序的屏幕截图](../Images/0b0c2aa41c18616622aa0611ba95b72d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T23:47:54.997

Ben Zotto 是对的，这只是确保在每个子程序中设置正确的上下文。因为有多种上下文，所以更难发现错误。进行非法操作（设置了错误的上下文）的 OpenGL 视图不是崩溃的那个。

# php - PHP Like Wildcard 不起作用

> ID：14310344
> 
> 赞同：-1
> 
> 时间：2013-01-14T01:39:30.083
> 
> 标签：php, sql, phpmyadmin

我试图从 x 中选择 *，其中名称 LIKE y 我非常熟悉下面的代码。

```
SELECT * FROM ` arm` WHERE `u_fname` LIKE 'k%' 
```

但是，我试图在服务器脚本上运行它，但我不确定将“%”放在哪里会导致错误。这是服务器代码的一部分，此代码与“=”一样工作，但当我使用 LIKE 时出错，因为我不确定如何在此处使用“%”

```
 elseif(empty($_POST["f_name"]) &&  !empty($_POST["l_name"])) 
{ 

 $l_name=$_POST["l_name"];
$stmt = $this->db->prepare('SELECT id, image, l_name, f_name, status  FROM table1  WHERE l_name =?');
           $stmt->bind_param("s",$l_name);
         $stmt->execute();
         $stmt->bind_result($id,$image,$l_name,$f_name,$status); 
```

我试过 SELECT id, image, l_name, f_name, status FROM table1 WHERE l_name =?% 我也试过把 $l_name=$_POST["l_name%"]; 但它们似乎都不起作用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:46:33.713

您的代码未使用 'LIKE' 您的代码是：SELECT id, image, l_name, f_name, status FROM table1 WHERE l_name =? 尝试

```
$stmt = $this->db->prepare('SELECT id, image, l_name, f_name, status  FROM table1
WHERE l_name LIKE ?'); 
$stmt->bind_param("s",$l_name.'%'); 
```

或者试试

```
$stmt = $this->db->prepare('SELECT id, image, l_name, f_name, status  FROM table1
WHERE l_name LIKE CONCAT(?, "%")');
$stmt->bind_param("s",$l_name); 
```

# azure - 从 TFS 部署时将 Azure Web 角色设置为具有 RDP

> ID：14310345
> 
> 赞同：0
> 
> 时间：2013-01-14T01:39:34.883
> 
> 标签：azure, azure-web-roles

是否可以设置从配置了 RDP 的托管 TFS 部署的 Azure Web 角色？我知道如果我手动发布角色可以做到这一点，但是当您从 TFS 自动部署时可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T04:05:50.200

是 - RDP 设置保存在部署 ServiceConfiguration.cscfg 文件中。确保您已经创建了一个证书，将证书上传到您的网络角色，并且至少创建了一次“发布”设置，这将在配置文件中创建所需的值。

# android - 设备方向的陀螺仪问题

> ID：14310347
> 
> 赞同：8
> 
> 时间：2013-01-14T01:39:56.160
> 
> 标签：android, accelerometer, android-sensors, gyroscope

我正在使用本教程从设备的陀螺仪获取俯仰和滚动数据：[http ://www.thousand-thoughts.com/2012/03/android-sensor-fusion-tutorial/](http://www.thousand-thoughts.com/2012/03/android-sensor-fusion-tutorial/)

所有读数都非常准确（本教程中的代码应用了一个过滤器以消除陀螺仪漂移）。不幸的是，该代码仅在我的设备平放在与地面平行的表面上时才有效。我的应用程序工作的最理想位置是设备的顶部笔直向上（即设备垂直于地面，屏幕面向用户）。每当我将设备定位在这个位置时，俯仰值都会变为 +90 度（如预期的那样）。我想要做的是将此位置设置为我的设备的 0 度点（或初始位置），以便当我的设备直立（纵向模式）且屏幕面向用户时，俯仰读数为 0 度。

我就这个问题向本教程的作者寻求帮助，他回答说：

“如果您想将直立位置作为初始位置，则必须相应地旋转参考系。最简单的方法是将生成的旋转矩阵围绕 x 轴旋转 -90 度。但您必须小心在算法中的哪个点应用这个旋转。永远记住，旋转不是交换操作。更具体地说，我必须再次查看代码，因为我已经有一段时间没有使用它了现在。”

对于如何旋转我的参考系，我真的很困惑和困惑。我想底线是我不知道如何将矩阵围绕 x 轴旋转 -90 度。如果有人可以帮助我完成这部分，那就太棒了。这是我的代码，以防有人想参考它：

```
public class AttitudeDisplayIndicator extends SherlockActivity implements SensorEventListener {

private SensorManager mSensorManager = null;

// angular speeds from gyro
private float[] gyro = new float[3];

// rotation matrix from gyro data
private float[] gyroMatrix = new float[9];

// orientation angles from gyro matrix
private float[] gyroOrientation = new float[3];

// magnetic field vector
private float[] magnet = new float[3];

// accelerometer vector
private float[] accel = new float[3];

// orientation angles from accel and magnet
private float[] accMagOrientation = new float[3];

// final orientation angles from sensor fusion
private float[] fusedOrientation = new float[3];

// accelerometer and magnetometer based rotation matrix
private float[] rotationMatrix = new float[9];

public static final float EPSILON = 0.000000001f;
private static final float NS2S = 1.0f / 1000000000.0f;
private float timestamp;
private boolean initState = true;

public static final int TIME_CONSTANT = 30;
public static final float FILTER_COEFFICIENT = 0.98f;
private Timer fuseTimer = new Timer();

// The following members are only for displaying the sensor output.
public Handler mHandler;
DecimalFormat d = new DecimalFormat("#.##");

//ADI background image.
private ImageView adiBackground;

//ADI axes.
private ImageView adiAxes;

//ADI frame.
private ImageView adiFrame;

//Layout.
private RelativeLayout layout;

//Pitch and Roll TextViews.
private TextView pitchAngleText;
private TextView bankAngleText;

//Instantaneous output values from sensors as the device moves.
public static double pitch;
public static double roll;

//Matrix for rotating the ADI (roll).
Matrix mMatrix = new Matrix();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_attitude_display_indicator);

    gyroOrientation[0] = 0.0f;
    gyroOrientation[1] = 0.0f;
    gyroOrientation[2] = 0.0f;

    // initialise gyroMatrix with identity matrix
    gyroMatrix[0] = 1.0f; gyroMatrix[1] = 0.0f; gyroMatrix[2] = 0.0f;
    gyroMatrix[3] = 0.0f; gyroMatrix[4] = 1.0f; gyroMatrix[5] = 0.0f;
    gyroMatrix[6] = 0.0f; gyroMatrix[7] = 0.0f; gyroMatrix[8] = 1.0f;

    // get sensorManager and initialise sensor listeners
    mSensorManager = (SensorManager) this.getSystemService(SENSOR_SERVICE);
    initListeners();

    // wait for one second until gyroscope and magnetometer/accelerometer
    // data is initialised then scedule the complementary filter task
    fuseTimer.scheduleAtFixedRate(new calculateFusedOrientationTask(),
                                  1000, TIME_CONSTANT);

    mHandler = new Handler();
    adiBackground = (ImageView) findViewById(R.id.adi_background);
    adiFrame = (ImageView) findViewById(R.id.adi_frame);
    adiAxes = (ImageView) findViewById(R.id.adi_axes);

    layout = (RelativeLayout) findViewById(R.id.adi_layout);
    new Color();
    layout.setBackgroundColor(Color.rgb(150, 150, 150));

    pitchAngleText = (TextView) findViewById(R.id.pitch_angle_text);
    bankAngleText = (TextView) findViewById(R.id.bank_angle_text);

}

// This function registers sensor listeners for the accelerometer, magnetometer and gyroscope.
public void initListeners(){
    mSensorManager.registerListener(this,
        mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
        SensorManager.SENSOR_DELAY_FASTEST);

    mSensorManager.registerListener(this,
        mSensorManager.getDefaultSensor(Sensor.TYPE_GYROSCOPE),
        SensorManager.SENSOR_DELAY_FASTEST);

    mSensorManager.registerListener(this,
        mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD),
        SensorManager.SENSOR_DELAY_FASTEST);
}

//@Override
public void onAccuracyChanged(Sensor sensor, int accuracy) {    

}

//@Override
public void onSensorChanged(SensorEvent event) {
    switch(event.sensor.getType()) {
    case Sensor.TYPE_ACCELEROMETER:
        // copy new accelerometer data into accel array and calculate orientation
        System.arraycopy(event.values, 0, accel, 0, 3);
        calculateAccMagOrientation();
        break;

    case Sensor.TYPE_GYROSCOPE:
        // process gyro data
        gyroFunction(event);
        break;

    case Sensor.TYPE_MAGNETIC_FIELD:
        // copy new magnetometer data into magnet array
        System.arraycopy(event.values, 0, magnet, 0, 3);
        break;
    }
}

// calculates orientation angles from accelerometer and magnetometer output
    public void calculateAccMagOrientation() {
        if(SensorManager.getRotationMatrix(rotationMatrix, null, accel, magnet)) {
            SensorManager.getOrientation(rotationMatrix, accMagOrientation);
        }
    }

    // This function is borrowed from the Android reference
    // at http://developer.android.com/reference/android/hardware/SensorEvent.html#values
    // It calculates a rotation vector from the gyroscope angular speed values.
    private void getRotationVectorFromGyro(float[] gyroValues,
            float[] deltaRotationVector,
            float timeFactor)
    {
        float[] normValues = new float[3];

        // Calculate the angular speed of the sample
        float omegaMagnitude =
        (float)Math.sqrt(gyroValues[0] * gyroValues[0] +
        gyroValues[1] * gyroValues[1] +
        gyroValues[2] * gyroValues[2]);

        // Normalize the rotation vector if it's big enough to get the axis
        if(omegaMagnitude > EPSILON) {
        normValues[0] = gyroValues[0] / omegaMagnitude;
        normValues[1] = gyroValues[1] / omegaMagnitude;
        normValues[2] = gyroValues[2] / omegaMagnitude;
        }

        // Integrate around this axis with the angular speed by the timestep
        // in order to get a delta rotation from this sample over the timestep
        // We will convert this axis-angle representation of the delta rotation
        // into a quaternion before turning it into the rotation matrix.
        float thetaOverTwo = omegaMagnitude * timeFactor;
        float sinThetaOverTwo = (float)Math.sin(thetaOverTwo);
        float cosThetaOverTwo = (float)Math.cos(thetaOverTwo);
        deltaRotationVector[0] = sinThetaOverTwo * normValues[0];
        deltaRotationVector[1] = sinThetaOverTwo * normValues[1];
        deltaRotationVector[2] = sinThetaOverTwo * normValues[2];
        deltaRotationVector[3] = cosThetaOverTwo;
    }

    // This function performs the integration of the gyroscope data.
    // It writes the gyroscope based orientation into gyroOrientation.
    public void gyroFunction(SensorEvent event) {
        // don't start until first accelerometer/magnetometer orientation has been acquired
        if (accMagOrientation == null)
            return;

        // initialisation of the gyroscope based rotation matrix
        if(initState) {
            float[] initMatrix = new float[9];
            initMatrix = getRotationMatrixFromOrientation(accMagOrientation);
            float[] test = new float[3];
            SensorManager.getOrientation(initMatrix, test);
            gyroMatrix = matrixMultiplication(gyroMatrix, initMatrix);
            initState = false;
        }

        // copy the new gyro values into the gyro array
        // convert the raw gyro data into a rotation vector
        float[] deltaVector = new float[4];
        if(timestamp != 0) {
            final float dT = (event.timestamp - timestamp) * NS2S;
        System.arraycopy(event.values, 0, gyro, 0, 3);
        getRotationVectorFromGyro(gyro, deltaVector, dT / 2.0f);
        }

        // measurement done, save current time for next interval
        timestamp = event.timestamp;

        // convert rotation vector into rotation matrix
        float[] deltaMatrix = new float[9];
        SensorManager.getRotationMatrixFromVector(deltaMatrix, deltaVector);

        // apply the new rotation interval on the gyroscope based rotation matrix
        gyroMatrix = matrixMultiplication(gyroMatrix, deltaMatrix);

        // get the gyroscope based orientation from the rotation matrix
        SensorManager.getOrientation(gyroMatrix, gyroOrientation);
    }

    private float[] getRotationMatrixFromOrientation(float[] o) {
        float[] xM = new float[9];
        float[] yM = new float[9];
        float[] zM = new float[9];

        float sinX = (float)Math.sin(o[1]);
        float cosX = (float)Math.cos(o[1]);
        float sinY = (float)Math.sin(o[2]);
        float cosY = (float)Math.cos(o[2]);
        float sinZ = (float)Math.sin(o[0]);
        float cosZ = (float)Math.cos(o[0]);

        // rotation about x-axis (pitch)
        xM[0] = 1.0f; xM[1] = 0.0f; xM[2] = 0.0f;
        xM[3] = 0.0f; xM[4] = cosX; xM[5] = sinX;
        xM[6] = 0.0f; xM[7] = -sinX; xM[8] = cosX;

        // rotation about y-axis (roll)
        yM[0] = cosY; yM[1] = 0.0f; yM[2] = sinY;
        yM[3] = 0.0f; yM[4] = 1.0f; yM[5] = 0.0f;
        yM[6] = -sinY; yM[7] = 0.0f; yM[8] = cosY;

        // rotation about z-axis (azimuth)
        zM[0] = cosZ; zM[1] = sinZ; zM[2] = 0.0f;
        zM[3] = -sinZ; zM[4] = cosZ; zM[5] = 0.0f;
        zM[6] = 0.0f; zM[7] = 0.0f; zM[8] = 1.0f;

        // rotation order is y, x, z (roll, pitch, azimuth)
        float[] resultMatrix = matrixMultiplication(xM, yM);
        resultMatrix = matrixMultiplication(zM, resultMatrix);
        return resultMatrix;
    }

    private float[] matrixMultiplication(float[] A, float[] B) {
        float[] result = new float[9];

        result[0] = A[0] * B[0] + A[1] * B[3] + A[2] * B[6];
        result[1] = A[0] * B[1] + A[1] * B[4] + A[2] * B[7];
        result[2] = A[0] * B[2] + A[1] * B[5] + A[2] * B[8];

        result[3] = A[3] * B[0] + A[4] * B[3] + A[5] * B[6];
        result[4] = A[3] * B[1] + A[4] * B[4] + A[5] * B[7];
        result[5] = A[3] * B[2] + A[4] * B[5] + A[5] * B[8];

        result[6] = A[6] * B[0] + A[7] * B[3] + A[8] * B[6];
        result[7] = A[6] * B[1] + A[7] * B[4] + A[8] * B[7];
        result[8] = A[6] * B[2] + A[7] * B[5] + A[8] * B[8];

        return result;
    }

    class calculateFusedOrientationTask extends TimerTask {
        public void run() {
            float oneMinusCoeff = 1.0f - FILTER_COEFFICIENT;

            /*
             * Fix for 179° <--> -179° transition problem:
             * Check whether one of the two orientation angles (gyro or accMag) is negative while the other one is positive.
             * If so, add 360° (2 * math.PI) to the negative value, perform the sensor fusion, and remove the 360° from the result
             * if it is greater than 180°. This stabilizes the output in positive-to-negative-transition cases.
             */

            // azimuth
            if (gyroOrientation[0] < -0.5 * Math.PI && accMagOrientation[0] > 0.0) {
                fusedOrientation[0] = (float) (FILTER_COEFFICIENT * (gyroOrientation[0] + 2.0 * Math.PI) + oneMinusCoeff * accMagOrientation[0]);
                fusedOrientation[0] -= (fusedOrientation[0] > Math.PI) ? 2.0 * Math.PI : 0;
            }
            else if (accMagOrientation[0] < -0.5 * Math.PI && gyroOrientation[0] > 0.0) {
                fusedOrientation[0] = (float) (FILTER_COEFFICIENT * gyroOrientation[0] + oneMinusCoeff * (accMagOrientation[0] + 2.0 * Math.PI));
                fusedOrientation[0] -= (fusedOrientation[0] > Math.PI)? 2.0 * Math.PI : 0;
            }
            else {
                fusedOrientation[0] = FILTER_COEFFICIENT * gyroOrientation[0] + oneMinusCoeff * accMagOrientation[0];
            }

            // pitch
            if (gyroOrientation[1] < -0.5 * Math.PI && accMagOrientation[1] > 0.0) {
                fusedOrientation[1] = (float) (FILTER_COEFFICIENT * (gyroOrientation[1] + 2.0 * Math.PI) + oneMinusCoeff * accMagOrientation[1]);
                fusedOrientation[1] -= (fusedOrientation[1] > Math.PI) ? 2.0 * Math.PI : 0;
            }
            else if (accMagOrientation[1] < -0.5 * Math.PI && gyroOrientation[1] > 0.0) {
                fusedOrientation[1] = (float) (FILTER_COEFFICIENT * gyroOrientation[1] + oneMinusCoeff * (accMagOrientation[1] + 2.0 * Math.PI));
                fusedOrientation[1] -= (fusedOrientation[1] > Math.PI)? 2.0 * Math.PI : 0;
            }
            else {
                fusedOrientation[1] = FILTER_COEFFICIENT * gyroOrientation[1] + oneMinusCoeff * accMagOrientation[1];
            }

            // roll
            if (gyroOrientation[2] < -0.5 * Math.PI && accMagOrientation[2] > 0.0) {
                fusedOrientation[2] = (float) (FILTER_COEFFICIENT * (gyroOrientation[2] + 2.0 * Math.PI) + oneMinusCoeff * accMagOrientation[2]);
                fusedOrientation[2] -= (fusedOrientation[2] > Math.PI) ? 2.0 * Math.PI : 0;
            }
            else if (accMagOrientation[2] < -0.5 * Math.PI && gyroOrientation[2] > 0.0) {
                fusedOrientation[2] = (float) (FILTER_COEFFICIENT * gyroOrientation[2] + oneMinusCoeff * (accMagOrientation[2] + 2.0 * Math.PI));
                fusedOrientation[2] -= (fusedOrientation[2] > Math.PI)? 2.0 * Math.PI : 0;
            }
            else {
                fusedOrientation[2] = FILTER_COEFFICIENT * gyroOrientation[2] + oneMinusCoeff * accMagOrientation[2];
            }

            // overwrite gyro matrix and orientation with fused orientation
            // to comensate gyro drift
            gyroMatrix = getRotationMatrixFromOrientation(fusedOrientation);
            System.arraycopy(fusedOrientation, 0, gyroOrientation, 0, 3);

            // update sensor output in GUI
            mHandler.post(updateOrientationDisplayTask);
        }
    } 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T03:00:03.030

**理论...**

我不太确定“参考系”矩阵的表示格式，但通常旋转是通过矩阵乘法完成的。

基本上，您将使用“参考矩阵框架”并将其乘以 90 度旋转矩阵。

这样的矩阵可以在维基百科上找到： [三维旋转矩阵](http://en.wikipedia.org/wiki/Rotation_matrix#In_three_dimensions)

由于您的角度是 90 度，因此您的正弦和余弦将解析为 1 或 0，您可以将其直接插入矩阵而不是计算正弦和余弦。例如，一个绕 x 轴逆时针旋转 90 度的矩阵如下所示：

```
1   0   0
0   0   1
0  -1   0 
```

另外，请不要像这样的矩阵对 xyz 坐标的行向量进行操作。因此，例如，如果您有一个位于 (2,5,7) 的空间点，并且您想使用上述矩阵对其进行旋转，则必须执行以下操作：

```
|2 5 7| |1  0  0|
        |0  0  1|
        |0 -1  0| 
```

这给出了 [2 -7 5]

**...应用于您的代码**

我快速浏览了您的代码，您需要进行的修改似乎涉及calculateAccMagOrientation() 的输出，因为它用于初始化设备的方向。

```
1: public void calculateAccMagOrientation() {
2:     if(SensorManager.getRotationMatrix(rotationMatrix, null, accel, magnet)) {
3:         SensorManager.getOrientation(rotationMatrix, accMagOrientation);
4:     }
5: } 
```

上面代码片段的第 2 行是您获得初始旋转矩阵的位置。在第 3 行调用 getOrientation 之前，尝试将rotationMatrix 乘以手工制作的 90 度旋转矩阵。我认为这将有效地重新对齐您的参考方向：

```
public void calculateAccMagOrientation() {
    if(SensorManager.getRotationMatrix(rotationMatrix, null, accel, magnet)) {
        rotationMatrix = matrixMultiplication(rotationMatrix, my90DegRotationMatrix);
        SensorManager.getOrientation(rotationMatrix, accMagOrientation);
    }
} 
```

请注意，根据角度在 Android 中的工作方式，您可能需要使用 90 度顺时针旋转矩阵而不是逆时针旋转矩阵。

**替代解决方案**

我突然想到，也许您也可以在显示之前从最终音高结果中简单地减去 90？

# templates - 如何将当前请求参数传递给 Symfony2 路由

> ID：14310348
> 
> 赞同：0
> 
> 时间：2013-01-14T01:40:03.960
> 
> 标签：templates, symfony, routing, twig, params

我正在尝试使用 Symfony2 和 twig 创建语言/区域设置切换 url，这将允许在不重置 url 的情况下切换路由语言：

```
http://example.com/en/cat/test
http://example.com/it/cat/test
http://example.com/sp/cat/test 
```

... 等等

这是我的树枝模板的相关部分：

```
<a href="{{ path(app.request.attributes.get('_route'),{'_locale':'en'})}}">English</a> 
```

我的问题是，例如使用类别 url(http://example.com/en/cat/test) 给了我例外：

```
The "_category" route has some missing mandatory parameters ("category"). 
```

这一切都可以理解，因为对于切换器 url，我只传递了 _locale 参数。

如何传递所有当前的 url 参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T05:43:29.417

您可以从 app.request 获取所有请求属性并覆盖其中的一部分。

```
<a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')|merge({'_locale':'en'}))}}"> 
```

# c - valgrind 报告“大小为 8 的无效写入”

> ID：14310349
> 
> 赞同：4
> 
> 时间：2013-01-14T01:40:14.517
> 
> 标签：c, sqlite, valgrind

我正在追查内存分配的分段错误，因此我决定使用 valgrind 运行我的应用程序。在一个意想不到的位置（但可能是相关的）我遇到了“无效写入大小 8”。但是，我看不出代码有什么问题。我会欣赏另一组的眼睛。

我不确定提供多少，所以这里是有问题的功能。

```
43 static int sql_callback(void *sql_record, int argc, char **argv, char **azColName){
44   int i;
45   SQL_INFO *sql_info;
46   void *sql_temp;
47   sql_info = (SQL_INFO *)sql_record;
48
49
50   sql_info->num_cols=argc;
51
52  sql_info->sql_data=(SQL_DATA**)realloc(sql_info->sql_data,(sql_info->num_rows+1)*sizeof(SQL_DATA *));
53   sql_info->sql_data[sql_info->num_rows]=calloc(1,sizeof(SQL_DATA *));
54
55   sql_info->sql_data[sql_info->num_rows]->col_name=calloc(1,sizeof(*azColName)*argc);
56   sql_info->sql_data[sql_info->num_rows]->data=calloc(1,sizeof(*argv)*argc);
57
58   for(i=0; i<argc; i++){
59      sql_info->sql_data[sql_info->num_rows]->col_name[i]=strdup(azColName[i]);
60      sql_info->sql_data[sql_info->num_rows]->data[i]=strdup(argv[i]);
61   }
62   sql_info->num_rows++;
63   return 0;
64 } 
```

Valgrind 有两个有趣的信息点：

```
==31925== Invalid write of size 8
==31925==    at 0x405EC2: sql_callback (sql.c:56)
==31925==    by 0x5310FF5: sqlite3_exec (in /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
==31925==    by 0x4060D6: sql_query (sql.c:87)
==31925==    by 0x405121: send_trip_record (ssl_main.c:573)
==31925==    by 0x404579: do_work (ssl_main.c:380)
==31925==  Address 0x70f0fc8 is 0 bytes after a block of size 8 alloc'd
==31925==    at 0x4C29DB4: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==31925==    by 0x405E8D: sql_callback (sql.c:53)
==31925==    by 0x5310FF5: sqlite3_exec (in /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
==31925==    by 0x4060D6: sql_query (sql.c:87)
==31925==    by 0x405121: send_trip_record (ssl_main.c:573)
==31925==    by 0x404579: do_work (ssl_main.c:380)
==31925== 
```

所以，我正在使用 sqlite3 库，这个回调函数正在构建一个记录集的数组。在数组里面，如果有数据，就是一个数组，那就是'data'变量。我正在使用 col_name 做类似的事情，但 valgrind 对此表示满意，并且不会抱怨。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T01:54:26.513

在这一行：

```
53   sql_info->sql_data[sql_info->num_rows]=calloc(1,sizeof(SQL_DATA *)); 
```

您应该`sizeof(SQL_DATA)`改为分配。

因为在接下来的语句中，您开始像访问对象`sql_info->sql_data[sql_info->num_rows]`一样访问它`SQL_DATA`：

```
55   sql_info->sql_data[sql_info->num_rows]->col_name=calloc(1,sizeof(*azColName)*argc);
56   sql_info->sql_data[sql_info->num_rows]->data=calloc(1,sizeof(*argv)*argc); 
```

# java - Hashtable：为什么 get 方法是同步的？

> ID：14310350
> 
> 赞同：6
> 
> 时间：2013-01-14T01:40:19.080
> 
> 标签：java, hashtable, synchronize

我知道 a`Hashtable`是同步的，但为什么它的`get()`方法是同步的？

它只是一种读取方法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-14T02:54:54.737

如果读取不同步，则可以在读取执行期间修改 Hashtable。可能会添加新元素，底层数组可能会变得太小而被更大的数组替换，等等。如果没有顺序执行，很难处理这些情况。

但是，即使`get`Hashtable 被另一个线程修改时不会崩溃，`synchronized`关键字还有另一个重要方面，即缓存同步。让我们使用一个简化的例子：

```
class Flag {
  bool value;

  bool get() { return value; } // WARNING: not synchronized
  synchronized void set(bool value) { this->value = value; }
} 
```

`set`是同步的，但`get`不是。如果两个线程 A 和 B 同时读写这个类会发生什么？

```
1\. A calls read
2\.                 B calls set
3\. A calls read 
```

是否保证在步骤 3 A 看到线程 B 的修改？

不，它不是，因为 A 可能在不同的核心上运行，它使用一个单独的缓存，旧值仍然存在。因此，我们必须强制 B 将内存与其他内核通信，并强制 A 获取新数据。

我们如何执行它？每次，一个线程进入和离开一个同步块，都会执行一个隐式[内存屏障](http://www.infoq.com/articles/memory_barriers_jvm_concurrency)。内存屏障强制更新缓存。但是，要求写入者和读取者都必须执行内存屏障。否则，信息无法正确传达。

在我们的示例中，线程 B 已经使用了同步方法`set`，因此它的数据修改在方法结束时进行通信。但是，A 看不到修改后的数据。解决办法是`get`同步，所以强制获取更新的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T02:32:40.847

查看 Hashtable 源代码，您会想到许多可能导致未同步`get()`.

（我正在阅读JDK6源代码）

例如， a`rehash()`将创建一个空数组，并将其分配给实例 var `table`，并将旧表中的条目放入新表中。因此，如果您`get`发生在空数组分配之后，但在实际将条目放入其中之前，即使它在表中，您也无法找到您的键。

另一个例子是，有一个循环遍历表索引处的链表，如果在你的迭代中间，就会发生 rehash。即使它存在于哈希表中，您也可能无法找到该条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T02:12:03.913

`Hashtable`是同步的，意味着整个类是线程安全的

在 内部`Hashtable`，不仅 get() 方法是同步的，许多其他方法也是同步的。尤其是 put() 方法是同步的，就像汤姆说的那样。

读取方法必须与写入方法同步，因为它将确保变量的可见性和一致性。

# vb.net - 访问数据库中的排序 ID

> ID：14310354
> 
> 赞同：0
> 
> 时间：2013-01-14T01:40:54.037
> 
> 标签：vb.net, ms-access

我编写了一个使用 MS Access 数据库的 VB 程序。在其中一个表中，我设置了一个名为`sampleID`Text 类型的列。将值插入数据库后，它看起来像这样（未正确排序）。

```
BK130101
BK1301010
BK1301011
BK130108
BK130109 
```

我希望它像这样排序：

```
BK130101
BK130108
BK130109
BK1301010
BK1301011 
```

知道如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:45:29.343

也许是这样的：

```
SELECT TableX.ID
FROM TableX
ORDER BY Left([ID],6), CInt(Mid([ID],7)); 
```

# php - 在内存中生成 (.zip) 附件（带密码）

> ID：14310355
> 
> 赞同：1
> 
> 时间：2013-01-14T01:41:09.310
> 
> 标签：php, zip, attachment, password-protection, in-memory

以下问题：

我想**在内存**中为业务应用程序生成一个带有 php 的附件。附件也必须受**密码保护**。之后我想用电子邮件发送这个。

我用 php 对 .zip 附件做了一些研究。如果不使用 exec() 等命令行包装器，这种类型的附件似乎是不可能的。我宁愿避免使用 pdf（仍然对 pdf 安全性不满意）。

有什么建议我可以通过某种软件包实现这一目标吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T06:53:37.870

如果您可以使用“系统”功能执行命令，这很容易。

```
<?php 
echo system('zip -P pass file.zip file.txt'); 
?> 
```

但是您已经提到您对命令不感兴趣。

这是一个生成 zip 文件的好库：http: [//www.devco.net/code/zipfile.inc.txt](http://www.devco.net/code/zipfile.inc.txt)。但它错过了添加密码的能力。

另一种选择是[DotnetZip](http://dotnetzip.codeplex.com/)。它支持带密码的AES加密！**但它只在 Windows 上运行**。不确定您使用的是哪个平台。这是一个**示例代码**。[http://code.google.com/p/earlgrey/source/browse/trunk/vendor/DotNetZipLib-DevKit-v1.9/Examples/PHP/CreateZip-DotNetZip.php?r=571](http://code.google.com/p/earlgrey/source/browse/trunk/vendor/DotNetZipLib-DevKit-v1.9/Examples/PHP/CreateZip-DotNetZip.php?r=571)

# html - 应用 onmouseover 更改文本

> ID：14310360
> 
> 赞同：0
> 
> 时间：2013-01-14T01:41:53.663
> 
> 标签：html, css

我正在尝试将 onmouseover 应用于 Angeline Jolie（示例图片），以更改上面显示“您的 Contrabang 每日剂量”的元素的文本（不要问）。实现这一点的最佳方法是什么？预先感谢您的帮助。可以参考JSFIDDLE [http://jsfiddle.net/cntra/VSCXy/](http://jsfiddle.net/cntra/VSCXy/)或者代码，如下：

```
<div class="columa">
 <div id="text-display">
  <span>Your Daily Dose of Contrabang</span>
   </div>

<div class="morphing-tinting">
<span class="image-wrap" 
 style="position:relative; 
  left: 0px; top:0; 
   display:inline-block; 
    background:url
    (http://www.howmuchdotheyweigh.com/wp-content/uploads/2011/02/angelina-jolie.jpg)
     no-repeat center center; 
      width: 250px; 
      height: 250px;"> 
```

CSS：

```
 #text-display{
   top:; position: relative;
   display:inline-block; padding:5px 10px; 
   font-family: sans-serif; font-weight:bold; font-size:50px; 
   color: white; text-align: center; line-height: 1.2em; margin:0px;      
   background-color:#E94F78;}

.morphing-tinting .image-wrap {
 position: absolute;
-webkit-transition: 1s;
-moz-transition: 1s;
transition: 1s;

-webkit-border-radius: 30em;
-moz-border-radius: 30em;
border-radius: 30em;}

.morphing-tinting .image-wrap:hover {
-webkit-border-radius: 30em;
-moz-border-radius: 30em;
border-radius: 30em;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T02:07:37.733

我会使用 jQuery，它可以简化事情。增加了一点开销，但如果您使用 CDN（例如[https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js)），它可能无论如何都在您的用户缓存中。

我删除了您在其中的两个功能并将其放入：

```
$('.changeTextClass').hover(function(){
     $('#'+$(this).attr('rel')).text('Howdy.');
}); 
```

我还稍微更改了您的 HTML。我将类“changeTextClass”添加到链接中，并将要更改的目标元素作为“rel”属性：

```
<a href="#" class="changeTextClass" rel="targetElm"> 
```

现在您只需将“targetElm”作为 ID 添加到要更改为具有“changeTextClass”类的任何元素的元素中：

```
<span id="targetElm">Your Daily Dose of Contrabang</span> 
```

**在这里测试它：http: [//jsfiddle.net/VSCXy/1/](http://jsfiddle.net/VSCXy/1/)**

通过这种方式，您可以将此功能扩展到其他元素。您也可以将文本添加到 rel 属性以使其可扩展。

该html看起来像这样：

```
<a href="#" class="changeTextClass" rel="targetElm|some sample text"> 
```

以及新功能：

```
$('.changeTextClass').hover(function(){
    var elmData = $(this).attr('rel').split('|');
    $('#'+elmData[0]).text(elmData[1]);
}); 
```

如果你想恢复元素内的原始文本，你可以使用这个函数：

```
 var elmData,origText;
$('.changeTextClass').hover(function(){
    elmData = $(this).attr('rel').split('|');
    origText = $('#'+elmData[0]).text();
    $('#'+elmData[0]).text(elmData[1]);
 }, function(){
    $('#'+elmData[0]).text(origText);
}); 
```

希望有帮助。

# vim - Common Lisp 的彩色 REPL

> ID：14310361
> 
> 赞同：1
> 
> 时间：2013-01-14T01:42:04.833
> 
> 标签：vim, common-lisp, read-eval-print-loop, colorize

我想知道是否有办法为 Common Lisp REPL 着色。尽管 terminfo 似乎为此奠定了一些基础，但我还没有找到一个真正使用它进​​行着色的库。有人已经做过了吗？欢迎使用 Vim 插件和特定于实现的库（例如 SBCL 的 linedit）。

PS：我知道 Emacs，如果解决方案必须包含在编辑器中，我更喜欢 Vim 替代方案。另一方面，我对 SBCL 对 CLISP 的偏好并不那么重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T05:24:56.133

到目前为止，wvxvw 提醒的 slimv + vim 就可以了。寻找独立的 CL 库正在等待中。

[http://www.vim.org/scripts/script.php?script_id=2531](http://www.vim.org/scripts/script.php?script_id=2531)

# java - 如何在 JTidy 中设置 XML prolog 的编码属性？

> ID：14310362
> 
> 赞同：3
> 
> 时间：2013-01-14T01:42:06.810
> 
> 标签：java, xml, encoding, jtidy

我需要使用 JTidy 从 HTML 文件生成 XML。源的编码是GB2312，所以我需要将生成的XML的编码也设置为GB2312。

当前的 XML 序言：

```
<?xml version="1.0"?> 
```

我需要的：

```
<?xml version="1.0" encoding="gb2312"?> 
```

我怎样才能做到这一点？

# android - Android SSL httpGet 错误 500 服务器拒绝 URL

> ID：14310366
> 
> 赞同：0
> 
> 时间：2013-01-14T01:42:22.613
> 
> 标签：android, ssl, webview, httpclient

我正在尝试与 Microsoft Exchange Server Web 访问门户建立连接。这个想法是我的程序最初打开一个 Web 视图，然后使用 BroadcastReceiver 不断刷新页面。我知道通常情况下，交换基于 Web 的电子邮件访问可以通过协议完成，但无论如何我都在尝试。刷新的时间很好，但问题是虽然我使用 WebView 打开连接，但我正在使用 HttpClient 进行刷新。成功从 WebView 登录到 HttpClient 后，我​​正在传递 cookie，并打开 SSL 连接，但 Web 服务器正在启动。这在浏览器中运行良好，所以我有点迷路了。

编辑：好的，这是一个更基本的 HTTP 请求问题。所有处理 httpGet 的代码都在构造函数中设置。我什至没有制作新的 HttpClient。现在，这是一个广播接收器，它每 60 秒左右响应一条定时消息以发出请求，但每次代码完成时，线程似乎都死了，每次定时器关闭时，都会调用空白构造函数. 在编写这样的 http GET 请求时，我是否需要每次都重新创建 HttpClient？还是我使用保持其值的静态变量是一种可行的方法？URL 和 cookie 从一个调用到下一个调用仍然存在。我还缺少什么？对这个东西的第一次调用似乎也不起作用，所以我仍然认为我做错了 SSL。同样，这个网站在网络浏览器中工作得很好，所以我'

这是构造函数代码：

```
 StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();

    StrictMode.setThreadPolicy(policy);

     // RESTORE THE COOKIES!!!

    cookieJar = new BasicCookieStore();
    localContext = new BasicHttpContext();
    localContext.setAttribute(ClientContext.COOKIE_STORE, cookieJar);

    cookie = extras.getString("cookies");
    String[] cookieCutter = cookie.split(";");
    for (int i=0; i < cookieCutter.length; i++)
    {
        String[] values = cookieCutter[i].split("=");
        BasicClientCookie c = new BasicClientCookie(values[0], values[1]);
        c.setDomain(MAIL_WEB_SERVER);
        cookieJar.addCookie((Cookie)c);
    }
    HostnameVerifier hostnameVerifier = org.apache.http.conn.ssl.SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER;

    // Create local HTTP context

    SchemeRegistry registry = new SchemeRegistry();
    SSLSocketFactory socketFactory = SSLSocketFactory.getSocketFactory();
    socketFactory.setHostnameVerifier((X509HostnameVerifier) hostnameVerifier);
    registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
    registry.register(new Scheme("https", socketFactory, 443));
    HttpParams params = new BasicHttpParams();
    HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
    HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);
    ThreadSafeClientConnManager mgr = new ThreadSafeClientConnManager(params, registry);

    httpClient = new DefaultHttpClient(mgr, params);
    httpClient.setCookieStore(cookieJar);

    // Set verifier     
    HttpsURLConnection.setDefaultHostnameVerifier(hostnameVerifier); 
```

这是刷新代码：

```
 BasicCookieStore cookies = (BasicCookieStore)localContext.getAttribute(ClientContext.COOKIE_STORE);
    HttpGet httpGet = new HttpGet(url);
    HttpResponse response = httpClient.execute(httpGet, localContext); 
```

那么，这让我何去何从？我收到错误代码：500 内部服务器错误。服务器拒绝了指定的统一资源定位符 (URL)。请联系服务器管理员。(12202)

我正在移动 cookie，并接受所有证书……浏览器会话中是否还有其他内容需要通过 SSL 连接和登录来传递 httpGet 请求？

# desire2learn - D2L 可以用作 LTI 工具提供者和工具消费者吗

> ID：14310368
> 
> 赞同：0
> 
> 时间：2013-01-14T01:42:26.427
> 
> 标签：desire2learn

我可以将 D2L 用作工具提供者和工具消费者吗？基本上，如果我想从一个 D2L 实例访问一些学习对象到另一个 D2L 实例 - 这可能吗？

苏布拉塔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T14:03:11.980

目前不是，不是：D2L 不能充当 LTI 工具提供者。您可以通过在两个 D2L 实例之间运行的服务应用程序来实现您所描述的内容，使用 Valence API 从一个 LMS 读取内容对象，并写入另一个 LMS；但是，在这种情况下，您需要该服务在两种情况下都拥有用户的用户凭据。

# django - Django服务器无法运行，为什么？

> ID：14310373
> 
> 赞同：3
> 
> 时间：2013-01-14T01:43:11.027
> 
> 标签：django

E:\pythonwebproject\pythonweb>python manage.py runserver 验证模型...

```
Unhandled exception in thread started by <function wrapper at 0x01DE69F0> 

Traceback (most recent call last): 

  File "C:\Python26\Lib\site-packages\django\utils\autoreload.py", line 93, in wrapper 
    fn(*args, **kwargs) 

  File "C:\Python26\Lib\site-packages\django\core\management\commands\runserver.py", line 92, in inner_r 

    self.validate(display_num_errors=True) 

  File "C:\Python26\Lib\site-packages\django\core\management\base.py", line 277, in validate 

    num_errors = get_validation_errors(s, app)

  File "C:\Python26\Lib\site-packages\django\core\management\validation.py", line 35, in get_validation_ 

    for (app_name, error) in get_app_errors().items(): 

  File "C:\Python26\Lib\site-packages\django\db\models\loading.py", line 166, in get_app_errors 

    self._populate() 

  File "C:\Python26\Lib\site-packages\django\db\models\loading.py", line 72, in _populate 
    self.load_app(app_name, True) 

  File "C:\Python26\Lib\site-packages\django\db\models\loading.py", line 96, in load_app 
    models = import_module('.models', app_name) 

  File "C:\Python26\Lib\site-packages\django\utils\importlib.py", line 35, in import_module 
    __import__(name) 

  File "C:\Python26\Lib\site-packages\django\contrib\auth\models.py", line 21, in <module> 
    from django.contrib.contenttypes.models import ContentType 

  File "C:\Python26\Lib\site-packages\django\contrib\contenttypes\models.py", line 127, in <module> 
    class ContentType(models.Model): 

  File "C:\Python26\Lib\site-packages\django\db\models\base.py", line 88, in __new__ 
    new_class.add_to_class('_meta', Options(meta, **kwargs)) 

TypeError: Error when calling the metaclass bases 
    __init__() keywords must be strings 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T02:02:38.993

[这个错误报告](https://code.djangoproject.com/ticket/18961)是我能找到的具有类似症状的唯一资源。你用的是 django 1.5 吗？尝试将您的 python 安装升级到 2.7，看看是否可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T08:05:14.047

您正在使用带有 Python 2.6 的 Django 开发版（即将发布 1.5）。它仅适用于 2.7 和 3.3。您应该升级您的 Python 版本，或者使用已发布的 Django 版本 1.4。

# php - 绝对没有响应 php 退出技术？

> ID：14310376
> 
> 赞同：0
> 
> 时间：2013-01-14T01:43:20.437
> 
> 标签：php, httpresponse, exit, bandwidth

我阅读的文档在这个问题上似乎并不清楚。

不带参数调用`exit()`时，服务器是否仍将某些内容发送回客户端？

如果是这样，是否有替代方法或方法可以防止在退出时将任何内容发送给客户？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T01:50:50.153

`exit`与到达文件末尾基本相同。任何已经发送的内容都将被浏览器接收，任何输出缓冲区都将被处理并发送。

`ob_start()`您可以通过包含作为第一行代码并使用此函数来强制一个空响应：

```
function exitEmpty() {
    while(ob_get_level()) ob_end_clean();
    exit;
} 
```

但是，标题仍将被发送。这只是清空响应正文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:45:48.277

`exit()`如果尚未发送标头，仍将发送标头，否则将不发送任何其他内容。

# jquery-masonry - 带有链接到当前文档的数据库和锚标记的砌体无限滚动

> ID：14310380
> 
> 赞同：1
> 
> 时间：2013-01-14T01:44:02.297
> 
> 标签：jquery-masonry, infinite-scroll

我是 PHP、Javascript 和 HTML 的新手。所以也许我遗漏了一些明显的东西，但是我一辈子都无法弄清楚我的代码出了什么问题。我正在尝试将 Paul Irish 的 Infinite Scroll 与一个 PHP 文件一起使用，该文件具有一个锚点，该锚点使用不同的 GET 值链接回自身。问题是我所做的任何事情都会给我这个错误：

> **抱歉，我们无法解析您的下一篇（上一篇文章）网址。验证您的 css 选择器指向正确的 A 标记。**

我束手无策，迫切需要别人的帮助，因为我需要在 1 月 20 日之前完成这项工作。这将是我认识的人的生日礼物。

这是我的代码：

**index.php（代码片段）**

```
<div id="content-container" class="container-fluid" style="padding:0px;overflow:hidden;">     
    <div class="row-fluid full">
        <div class="span12 full" style="overflow:scroll;position:relative;">
            <div id="media-palette">
                <?php       
                    include('content.php');         
                ?>
            </div>
        </div>
    </div>
</div> 
```

**script.js（代码片段）**

```
$("#media-palette").infinitescroll({
    navSelector:"#next",
    nextSelector:"#media-palette a#next:last",
    itemSelector:".media-content",
    bufferPx:50,
    debug: true,
}, function(newElements) {
    $("#media-palette").masonry('append', newElements,true);
}); 
```

**内容.php**

（值得注意的是，在这个文件中找到的图像用于测试目的，最终的 PHP 文件将从数据库中加载图像。）

```
<?php

    require('dbconnect.php');

    $startIndex = $_GET['start'];
    $endIndex = $_GET['end'];

    $nextStartIndex = $endIndex-1;
    $nextEndIndex = $endIndex-10;
?>

<head>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>    

<body>
    <?php
    $files = scandir("images");
        if ($files) {
            $length = count($files);
            static $allowedExts = array("jpg", "jpeg", "gif", "png");
            for ($i = 0; $i < $length; $i++) {
                $extension = end(explode(".", $files[$i]));
                $extension = strtolower($extension);
                if (in_array($extension,$allowedExts)) {
                    $rand = rand(0,10);
                    if (!$rand) echo "<img class='media-content medium' src='images/".$files[$i]."'/>";
                    else echo "<img class='media-content small' src='images/".$files[$i]."'/>";
                }
            }
        }
        echo '<a id="next" href="content.php?start='.$nextStartIndex.'&end='.$nextEndIndex.'"></a>';
    ?>
</body> 
```

# node.js - 当循环中调用了异步函数时，Node.JS 将如何处理循环控制？

> ID：14310382
> 
> 赞同：2
> 
> 时间：2013-01-14T01:44:17.170
> 
> 标签：node.js, loops, asynchronous

我的情况如下：有一个IP地址数组。我将测试每个 IP 以连接到远程服务器。如果一个 IP 连接，其余 IP 将被忽略并且不会连接。

我使用以下 Node.JS 代码来完成这项工作，但它似乎不起作用。请给出一些提示。谢谢！

```
// serverip is a var of string splitted by ";", e.g. "ip1;ip2;ip3"
var aryServerIP = serverip.split(";");
console.log(aryServerIP);

var ipcnt = aryServerIP.length; // ipcnt = 3, for example
for (ip in aryServerIP)
{
    console.log("to process: " + ipcnt); // error here: always print 3
    var net = require('net');
    var client = new net.Socket();
    var rdpport = 3389;
    client.connect(rdpport, aryServerIP[ip], function(){
        console.log("socket connected to " + aryServerIP[ip] + ":" + rdpport);
        client.destroy();
        if (0 != ipcnt)
        {
            // do some real connection work about aryServerIP[ip].
            ipcnt--;
        }
    });
    client.on('error', function(){
        console.log("fail to connect to " + aryServerIP[ip] + ":" + rdpport);
        ipcnt--;
    });
} 
```

我知道使用 ipcnt count 来控制循环是不好的，但是当循环中调用了异步函数时，我不知道如何控制 Node.JS 循环......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T05:03:18.473

因为你的`connect`和`error`回调都是异步的，所以它们都将在 for 循环完全完成后运行。

您需要做的是设置一组回调。例如，不要使用`for`循环，而是将整个循环体包装在一个函数中。如果连接成功，那么就照常做，如果`error`回调被调用，则再次执行包装函数。像这样的东西：

```
var async = require('async');
var net = require('net');
var rdpport = 3389;

function tryConnections(aryServerIP, callback){
  function connect(i){
    if (i === aryServerIP.length) return callback();

    var client = new net.Socket();
    client.connect(rdpport, aryServerIP[i], function(){
      callback(client);
    });
    client.on('error', function(){
      connect(i + 1)
    });
  }
  connect(0)
}

tryConnections(serverip.split(";"), function(client){
  if (client) // Successfully connected to something
  else // all ips failed
}); 
```

另一种解决方案是使用[Async](https://github.com/caolan/async)库。

```
function tryConnections(aryServerIP, callback){
  async.detectSeries(aryServerIP, function(ip, cb){
    var client = new net.Socket();
    client.connect(rdpport, ip, function(){
      cb(client);
    });
    client.on('error', function(){
      cb();
    });
  }, callback);
} 
```

# asp.net-mvc-3 - 如何让 IIS Express 在 Windows 8 中工作？

> ID：14310383
> 
> 赞同：0
> 
> 时间：2013-01-14T01:44:24.223
> 
> 标签：asp.net-mvc-3, visual-studio-2010, windows-8, iis-express

所以我已经在这方面工作了大约 2 天，基本上已经走到了死胡同。我想首先要知道的是，IIS Express 可以与 Visual Studio 2010 和 Windows 8 结合使用吗？

我刚拿到这台新笔记本电脑，预装了 Windows 8。我安装了 Visual Studio 2010 Ultimate、SP1 和 MVC 3。我必须自己启用 .NET Framework 4.0...

我有一个项目从我的旧计算机（Windows 7）转移到这台计算机上。它被设置为在 IIS Express 上运行。所以当我打开项目时，VS2010 说我缺少一些组件并询问我是否要安装它们——所以它为我安装了 IIS Express。当我尝试运行我的项目时，我在 IE 中看到“无法显示此页面”页面。在提琴手中，我得到
- 302 HTTP localhost:16683 /
- 502 HTTP Tunnel to localhost:443

项目的 SSL URL 是项目`https://localhost:44300/`
的 URL`http://localhost:16683/`

如果我转到系统托盘中的 IISExpress 并在那里选择 https 链接，它会很好地打开网站。如果我在那里选择 http 链接，它会再次在提琴手中获得“502 HTTP Tunnel to localhost:443”行......为什么它试图通过隧道连接到 localhost:443？

需要注意的另一件事是，我决定从头开始创建一个测试 MVC 3 项目，以查看 IIS Express 会做什么。我将项目设置为在 IIS 上运行而不启用 SSL。当我运行项目时，启动就好了。当我单击登录链接时，它会尝试重定向到端口为 44300 的 https 链接......但它不应该这样做。我在我的 Windows 7 机器上创建了一个用于相同目的的测试项目，但该项目没有这样做。

最后要注意的是，在通过 IIS Express 托盘图标转到我的初始项目的 https 链接后，如果我单击测试项目的登录链接，现在它会将我带到我的初始项目的 https 链接......就像如果项目相互交叉...

# c++ - 在 C++ 中切换类实现的使用

> ID：14310386
> 
> 赞同：0
> 
> 时间：2013-01-14T01:44:46.873
> 
> 标签：c++, oop

我有一个 C++ 程序 A.cpp，我包括两个头文件 Xh 和 Yh 这个程序（A.cpp）有一个类 'foo' 和该类所有成员的原型。这个类的实现是在 Xh 和 Yh 中完成的，它们都包含不同的成员函数定义。但是在程序中使用#ifdef 有条件地包含这些文件之一。因此，如果满足某个条件，则 Xh 是#include-ed，否则 Yh 是 #include-ed。他们两个永远不会被包含在一起。这是问题所在：我需要将此编译时切换更改为运行时切换。我知道在运行时不能包含头文件，那么有什么方法可以在不使用命名空间的情况下“选择”我想要的实现？排除了重载，因为函数的原型是相同的。

非常感谢。（对不起，如果这很愚蠢。我是 C++ 的新手）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:46:44.223

如果您在运行时想要两种不同的行为，那么听起来您正在描述*polymorphism*。考虑编写两个不同的类，它们继承自具有虚函数的公共基类。然后在运行时你可以做这样的事情：

```
Animal &a = (x == 3) ? Dog() : Cat();

a.talk(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:47:42.210

也许您想考虑静态[工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern)？您可以有一个方法将您选择的实例返回给调用者。您需要按照 OliCharlesworth 的建议进行子类化，然后这将使其对调用代码透明。

在伪代码中。

```
class baseclass{
...
static baseclass *GimmeImpl(){
    if(aImpl){
       return A();
    }else{
       return B();
    }

}

};

class A:public baseclass {...};
class B:public baseclass {...}; 
```

# ruby-on-rails - 在 Rails 中使用测试数据库

> ID：14310389
> 
> 赞同：2
> 
> 时间：2013-01-14T01:45:23.743
> 
> 标签：ruby-on-rails, testing, rspec, tdd

我正在尝试填充我的 rails Test 数据库并遇到问题。

我有一个脚本，我用它来休息、生成和填充我的开发数据库，​​它可以正常工作。基本上像

```
namespace :db do
  desc "Fill database with sample data"
    task populate: :environment do
      Rake::Task['db:reset'].invoke
      --Create all my dummy data here---
    end
  end
 end 
```

然后我运行命令：

```
bundle exec rake db:populate
bundle exec rake db:test:prepare 
```

第一个命令使用上述 rake 任务重置并填充我的数据库，但第二个命令仅重新创建我的数据结构而不填充数据。

我这样做是为了让一些 RSPec 测试可以访问 - 但我想知道我是否错误地处理了这个问题？我的 TDD 测试数据库中是否应该没有任何测试数据（仅结构）？一切都应该总是从 Fixtures 中运行吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T03:02:35.107

根据我的经验，不依赖于运行 rake 任务或使用任何其他外部进程来填充测试数据是一种很好的做法。您应该在测试本身中进行任何数据加载，并`spec/support`在必要时创建帮助程序以避免重复。

我见过各种加载测试数据的策略：自定义种子类放在 .fixture 中`lib`（尽管在某些情况下，fixture 可能很脆弱并且很痛苦），以及更重量级的解决方案，例如 factory_girl_rails 和facture gems，仅举几例很少。

至于`db:test:prepare`，根据 Rails 指南，它只是“检查待处理的迁移并加载测试模式”；没有加载实际数据。

[http://guides.rubyonrails.org/testing.html#preparing-your-application-for-testing](http://guides.rubyonrails.org/testing.html#preparing-your-application-for-testing)

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T03:08:18.113

> 但我想知道我是否错误地接近这个？我的 TDD 测试数据库中是否应该没有任何测试数据（仅结构）？一切都应该总是从 Fixtures 中运行吗？

一般来说，是的，您的测试数据库应该是空的 - 如果您的测试数据库已填充，并且没有在测试之间清理，您可能会根据测试运行的顺序获得不同的测试结果。

您可以使用固定装置，或者现在更常用的工厂，在运行之前为每个测试填充数据。夹具将从您的夹具文件填充整个数据库，因此对于每个测试，您将填充大量不必要的数据。对于工厂，您可以指定要在测试本身中填充的数据（特定数据和相关记录由您的工厂定义处理）。

几个受欢迎的工厂是 factory_girl：[https](https://github.com/thoughtbot/factory_girl) ://github.com/thoughtbot/factory_girl和机械师：[https ://github.com/notahat/machinist](https://github.com/notahat/machinist)

您还需要类似 database_cleaner 的东西：[https](https://github.com/bmabey/database_cleaner) ://github.com/bmabey/database_cleaner - database_cleaner 负责在每次测试之间擦除您的数据库，因此您可以从头开始测试。

这里有一个 railscast：[http](http://railscasts.com/episodes/158-factories-not-fixtures) ://railscasts.com/episodes/158-factories-not-fixtures与工厂合作的基础知识

# c# - 当图标本身没有时，为什么这个可执行文件图标看起来很糟糕？

> ID：14310390
> 
> 赞同：6
> 
> 时间：2013-01-14T01:45:27.657
> 
> 标签：c#, .net, icons

> **可能重复：**
> [我的 Windows 应用程序的图标应包括哪些图标大小？](https://stackoverflow.com/questions/3236115/which-icon-sizes-should-my-windows-applications-icon-include)

我正在开发一个 C# 程序。我通过项目属性-> 应用程序-> 图标和清单设置应用程序图标。

当在桌面上创建可执行文件的快捷方式时，该图标看起来非常糟糕，但如果我为项目目录中相同的 .ico 文件创建快捷方式，它看起来很好。

![在此处输入图像描述](../Images/8e8c2f436e93c5915c51e8acf64111ef.png)

任何想法为什么会发生这种情况以及我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:55:02.200

如果您在 Win 环境下工作，您必须知道 Windows XP 使用 16x16、32x32、48x48 图标大小，而 Windows Vista 及更高版本也使用 256x256 图标。通常会忽略所有其他尺寸，您应该使用 Photoshop 之类的程序（具有适当的 Ico 扩展格式）在每个可能使用的尺寸上构建图标。可能，它看起来很糟糕，因为操作系统没有在 Ico 文件中找到更高的分辨率，或者严重调整了更大的文件的大小。

欲了解更多信息：[这里](http://msdn.microsoft.com/en-us/library/aa511280.aspx#size)！

# ios - 通用应用程序不在 iPad 上旋转，但在 iPhone 上旋转

> ID：14310399
> 
> 赞同：3
> 
> 时间：2013-01-14T01:46:36.563
> 
> 标签：ios, ipad, rotation, ios-universal-app

我刚刚完成了一个通用应用程序的构建，它可以在我的 iPhone 上完美旋转，但在 iPad 上它只是静止不动。

*类似于[这个](https://stackoverflow.com/questions/6456807/converting-to-universal-app-views-wont-rotate)问题，但这并不能解决我的问题。*

支持的界面方向都设置为允许旋转，我什至在我的应用程序委托中设置了这个：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}
- (NSUInteger)supportedInterfaceOrientations
{ 
    return UIInterfaceOrientationMaskAll; 
} 
```

iPhone 仍然可以正常旋转，但 iPad 不会从纵向移动。

什么可能导致这种情况，或者更确切地说我该如何解决？

### [更新]

*   侧面的开关没有上锁。
*   PList 中的方向设置正确。
*   项目设置（通过按钮选择它）设置正确。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-07-17T00:56:09.383

@adam-s 是对的，除了 Xcode 7.x 之外，“设备”选择器下方没有按钮。

使用 Xcode 7，您需要将“通用”更改为“iPad”，从而改变方向选择器以反映仅限 iPad 的设置。然后您可以将选择器改回“通用”。

令人困惑！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-11-11T14:19:27.860

不要忘记更改 iPhone*和*iPad 的目标的旋转设置 - 请注意，iPhone 右侧有一个 iPad 按钮（有些人，比如我自己，乍一看可能会错过）：

[![在此处输入图像描述](../Images/8535793f45257c0583f8cd9851f36e36.png)](https://i.stack.imgur.com/VyFXh.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T09:31:24.747

我通过将这段代码添加到我的每个 ViewController 来解决这个问题：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}
- (NSUInteger)supportedInterfaceOrientations
{ 
    return UIInterfaceOrientationMaskAll; 
} 
```

看来[这个问题的答案](https://stackoverflow.com/questions/6456807/converting-to-universal-app-views-wont-rotate)毕竟是正确的。我只是认为这不是因为我检查了所有的 ViewController 并没有发现任何限制它转动的东西。

# windows - 调用 MoveMemory() 后源数据保持不变？

> ID：14310402
> 
> 赞同：0
> 
> 时间：2013-01-14T01:47:12.627
> 
> 标签：windows, mfc

Windows 上的 MoveMemory 功能显示“将一块内存从一个位置移动到另一个位置”。（[http://msdn.microsoft.com/ko-kr/library/windows/desktop/aa366788%28v=vs.85%29.aspx](http://msdn.microsoft.com/ko-kr/library/windows/desktop/aa366788%28v=vs.85%29.aspx)）

那么，调用 MoveMemory 的源代码呢？我想知道即使调用 MoveMemory 后源数据是否保持不变。

我可以在调用 movememory 后访问源，还是必须访问目标？

# php - Mysql查询重新索引项目

> ID：14310403
> 
> 赞同：2
> 
> 时间：2013-01-14T01:47:17.450
> 
> 标签：php, mysql

我有一个如下表，它有一个 ID 和项目名称、订单和类型。

```
 +--------+----------------+-----------+---------+
  |  ID    |  ITEM          |   ORDER   |  TYPE   |
  +--------+----------------+-----------+---------+
  |  1     |  Banana        |    2      |  Fruit  |
  +--------+----------------+-----------+---------+
  |  2     |  Apple         |    1      |  Fruit  |
  +--------+----------------+-----------+---------+
  |  3     |  Orange        |    4      |  Fruit  |
  +--------+----------------+-----------+---------+
  |  4     |  Lemon         |    3      |  Fruit  |
  +--------+----------------+-----------+---------+ 
```

如果我要删除`Lemon`，那`ORDER`就是 1,2,4。有没有一种方法可以重新索引剩余项目以获得以下结果？

```
 +--------+----------------+-----------+---------+
  |  ID    |  ITEM          |   ORDER   |  TYPE   |
  +--------+----------------+-----------+---------+
  |  1     |  Banana        |    2      |  Fruit  |
  +--------+----------------+-----------+---------+
  |  2     |  Apple         |    1      |  Fruit  |
  +--------+----------------+-----------+---------+
  |  3     |  Orange        |    3      |  Fruit  |
  +--------+----------------+-----------+---------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:50:53.413

没有办法完全自动地做到这一点，但它会相当简单。假设这`ORDER`不是唯一的，那就更容易了，但如果是，你必须先检索`ORDER`“柠檬”。然后，只需执行以下操作：

```
UPDATE Fruit SET ORDER = ORDER - 1 WHERE ORDER > ? 
```

`?`柠檬店在哪里`ORDER`。

假设`ORDER`不是唯一的，那么您可以事先进行此查询，但您将加入`Fruit`选择 Lemon's order to replace `?`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T01:51:00.627

在您删除该`Lemon`行之前 - 检查它的`ORDER`列值是什么。

之后执行

```
UPDATE tbl SET `ORDER` = `ORDER` - 1 WHERE `ORDER` > value_lemon_had 
```

# google-app-engine - 如何与父级传递 ndb 密钥并使用它来获取实体

> ID：14310410
> 
> 赞同：1
> 
> 时间：2013-01-14T01:48:34.037
> 
> 标签：google-app-engine, python-2.7, key, app-engine-ndb, ancestor

我将带有父级的 NDB Key() 传递给延迟函数。在这个函数中，我再次检索实体。但我不能使用传递的密钥直接获取实体。我必须更改 ndb.Key() 中的密钥顺序配对。

```
deferred.defer(my_deferred.a_function, entity.key) 
```

entity.key() 看起来像：

```
Key('Parents', 'my_parent', 'Childs', 'my_child')    # the first pair is the parent? 
```

my_deferred.py ：

```
def a_function(key) :

    entity = ndb.Key(key)  # the pass entity.key does not work !!!!! 
```

给出异常：ValueError：Key() 必须有偶数个位置参数。

```
 entity = ndb.Key('Childs', key.id(), parent = key.parent()).get() # this one works fine 
```

我不明白为什么 entity.key() 方法没有给我一个可以直接使用的密钥？或者是否有另一种方法来获取实体，而无需“更改”密钥。而且我不明白 ValueError 异常。

**更新**：感谢格雷戈里

```
 entity = key.get()    # works fine 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T02:13:46.607

首先，回答您的代码特定问题，正确传递密钥，它不是可调用的：

`deferred.defer(my_deferred.a_function, entity.key)`

接下来，在代码本身的实际设计上，还有一些需要调整的地方。

*   deferred api 序列化您的代码，因此实际上不需要从数据存储区重新查询实体。如果您坚持这一点，将 传递`entity.key`给 deferred 方法，它已经是 的实例`ndb.Key`，因此无需构造新的 Key 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:08:23.380

我现在无法对此进行测试，但是如何：

```
entity = ndb.Key(*key.flat()) 
```

构造`Key`函数接受几种不同类型的输入，并且由于`flat()` [返回扁平类型和 id 值的元组（kind1，id1，kind2，id2，...）。](https://developers.google.com/appengine/docs/python/ndb/keyclass#Constructors)，解包元组应该传入必要的输入。根据同一个链接，这也应该有效：

```
entity = ndb.Key(pairs=key.pairs()) 
```

# knockout.js - KnockoutJS - 仅在初始化后触发订阅

> ID：14310411
> 
> 赞同：3
> 
> 时间：2013-01-14T01:48:45.500
> 
> 标签：knockout.js

我有一种情况，我想在 observable 发生变化时执行任务，所以我设置了订阅 - 但是我不希望在创建项目时立即触发。

[http://jsfiddle.net/ciel/EeZjH/](http://jsfiddle.net/ciel/EeZjH/)

基本上，当每个项目从控制器进来时，已经为每个项目设置了“绑定”——所以我还不想发布更改。只有当它们从初始化值改变时。这合理吗？

```
function Item(data) {
  this.Binding = ko.observable(data);

  this.Binding.subscribe(function (newValue) {
    console.log("The Binding is Now " + newValue);
  });
}

var viewModel = {
  Options: ko.observableArray([{
    "Value": "1",
      "Name": "One"
  }, {
    "Value": "2",
      "Name": "Two"
  }, {
    "Value": "3",
      "Name": "Three"
  }]),
  Items: ko.observableArray([])
};

viewModel.Items.push(new Item("1"));
viewModel.Items.push(new Item("2"));
viewModel.Items.push(new Item("3"));

viewModel.output = ko.computed(function () {
  return JSON.stringify(
  viewModel.Items().map(

  function (i) {
    return i.Binding();
  }));
});

ko.applyBindings(viewModel); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T14:46:15.090

```
ko.observable.fn.beforeAndAfterSubscribe = function (callback, target) {
 var _oldValue;
 this.subscribe(function (oldValue) {
     _oldValue = oldValue;
 }, null, 'beforeChange');
   this.subscribe(function (newValue) {
     callback.call(target, _oldValue, newValue);
 });
}; 
```

*   查看更多信息：http: [//ideone.com/NPpNcB#sthash.xU5GK0Kc.dpuf](http://ideone.com/NPpNcB#sthash.xU5GK0Kc.dpuf)

# python - Unix Python - 超时后无需按回车即可获取终端输入

> ID：14310412
> 
> 赞同：1
> 
> 时间：2013-01-14T01:48:47.390
> 
> 标签：python, unix, input, terminal, timeout

我想在终端上得到输入，只给几秒钟的时间来响应。当达到超时时，我想读取在接受中输入的任何内容作为给定的输入。可选地，我希望用户能够按“输入”以尽早提交他们的答案。

我有下面的代码可以正常工作，但需要用户按“输入”来提交。它有一个错误：输入文本然后等待超时将文本保留在“缓冲区”中。然后，当您再次收到提示时，您输入不同的文本，按回车键，然后打印两个字符串（见输出）。当达到超时时，我想接受输入的任何内容作为“答案”。我希望用户仍然能够通过按“输入”更快地提交答案。

有没有办法实现所需的行为？

注意：我使用的是 Mac OS X

```
import sys
from select import select

def getResponse(timeout):
   print "Enter something:"
   rlist, wlist, xlist = select([sys.stdin], [], [], timeout)
   if rlist:
      result = sys.stdin.readline()
      return result
   else:
      return ''

while True:
   response = getResponse(3)
   print "Your input is:", response 
```

输出：

```
Enter something:
pythonYour input is: 
Enter something:
dangit
Your input is: pythondangit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T04:01:35.357

您希望以非阻塞方式从终端读取用户输入，并且还能够使读取超时，然后无需按 Enter 即可获取已写入的内容。至少这是有问题的，不会有一个简单的答案。作为起点，您可以考虑使用以下 ncurses 代码。用户最好不要删除他的输入！可以调整代码以处理字符删除和许多其他“花哨”功能，最终您可能会以迷你终端结束。

您所要求的通常是使用事件循环完成的，包括阅读部分（其中 raw_input 是一个糟糕的选择）。GUI 工具包可以更轻松、更健壮地解决这个问题（当然，它背后有几千行）。

```
import time
import curses

ENTER_KEY = (curses.KEY_ENTER, ord('\n'), ord('\r'))

def run(win, timeout=3): # timeout in seconds
    curses.echo()
    win.timeout(0) # Non-block read.

    line = 0
    while True:
        win.addstr(line, 0, "Enter something: ")
        s = []
        start = time.time()
        run = True
        while run:
            c = win.getch()
            time_taken = time.time() - start

            if c < 0:
                pass
            elif c in ENTER_KEY:
                break
            else:
                s.append(chr(c))

            if time_taken >= timeout:
                # Out of time.
                s.append(-1)
                run = False

        if len(s) == 0:
            break
        if s[-1] == -1:
            s.pop()
        answer = ''.join(s)
        win.addstr(line + 1, 0, "Your input was: %s" % answer)
        line += 2

curses.wrapper(run) 
```

要优雅地结束，请按 Enter 键而不输入任何内容。如果时间用完，它会继续请求输入。我根本没有测试这段代码，我只是知道它有很多限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:52:47.453

这不是正常的控制台行为，但这里有一篇讨论几个选项的帖子：

[Python中超时的键盘输入](https://stackoverflow.com/questions/1335507/keyboard-input-with-timeout-in-python)

# android - StickyListHeaders 和 MergeAdapter

> ID：14310417
> 
> 赞同：2
> 
> 时间：2013-01-14T01:49:07.393
> 
> 标签：android, android-layout, android-listview

我有一个我正在尝试设置的布局，它由三种不同的布局合并为一个。我有两个 RelativeLayouts 作为前两项，一个列表适配器作为第三项。使用 MergeAdapter 的原因是因为我希望整个页面滚动，但我希望整个布局中的第二个总项（第二个 RelativeLayout）粘在顶部。所以我正在尝试使用[StickyListHeaders 库](https://github.com/emilsjolander/StickyListHeaders)来完成它。

它似乎还没有被广泛使用，尽管它的想法很棒。无论如何，我必须在我的列表适配器中覆盖两种方法，在这种情况下是 MergeAdapter。我不断收到 NullPointerException，但它并没有告诉我它在我的代码中发生的位置。因此，如果有人有使用该库的经验，更具体地说是使用 MergeAdapter 的库，你能告诉我我做错了什么吗？这是我的 MergeAdapter 的代码。

```
private class ProfileMergeAdapter extends MergeAdapter implements StickyListHeadersAdapter{

    @Override
    public View getHeaderView(int position, View convertView, ViewGroup parent) {

        LayoutInflater nameInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = (RelativeLayout) nameInflater.inflate(R.layout.name_line, null);
        profilePhotoBottom = (ImageView) convertView.findViewById(R.id.profile_pic_bottom);
        TextView userName = (TextView) convertView.findViewById(R.id.userName);
        userName.setText(Utility.userName);
        return convertView;
    }

    @Override
    public long getHeaderId(int position) {
        return 1;
    }

} 
```

这是logcat：

```
01-13 20:39:21.237: W/dalvikvm(4917): threadid=1: thread exiting with uncaught exception (group=0x40de5930)
01-13 20:39:21.245: E/AndroidRuntime(4917): FATAL EXCEPTION: main
01-13 20:39:21.245: E/AndroidRuntime(4917): java.lang.NullPointerException
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:523)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.View.measure(View.java:15513)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at com.emilsjolander.components.stickylistheaders.StickyListHeadersListView.measureHeader(StickyListHeadersListView.java:242)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at com.emilsjolander.components.stickylistheaders.StickyListHeadersListView.scrollChanged(StickyListHeadersListView.java:284)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at com.emilsjolander.components.stickylistheaders.StickyListHeadersListView.onScroll(StickyListHeadersListView.java:269)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.AbsListView.invokeOnItemScrollListener(AbsListView.java:1340)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.ListView.layoutChildren(ListView.java:1753)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.AbsListView.onLayout(AbsListView.java:1994)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.View.layout(View.java:14003)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.ViewGroup.layout(ViewGroup.java:4375)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.FrameLayout.onLayout(FrameLayout.java:448)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.View.layout(View.java:14003)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.ViewGroup.layout(ViewGroup.java:4375)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.FrameLayout.onLayout(FrameLayout.java:448)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.View.layout(View.java:14003)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.ViewGroup.layout(ViewGroup.java:4375)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.widget.FrameLayout.onLayout(FrameLayout.java:448)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.View.layout(View.java:14003)
01-13 20:39:21.245: E/AndroidRuntime(4917):     at android.view.ViewGroup.layout(ViewGroup.java:4375) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:23:34.023

谢谢马克的回复。我想通了，有点。我想我的 xml 中的 layout_width 和 layout_height 对于其中一个列表项有问题，并且更改它们不起作用。所以我在代码中使用 LayoutParams 更改了项目的高度和宽度。

# android - API 级别 16 中的高级新增功能是什么意思？

> ID：14310421
> 
> 赞同：0
> 
> 时间：2013-01-14T01:50:03.193
> 
> 标签：android, launcher

API 级别 16 中的高级新增功能是什么意思？以及如何在 Advanceable Api 中使用这两种方法？我在 Launcher 源代码中看到了这个接口。我不清楚 android docs.Thanks 中的规范。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:51:16.180

这意味着只有 api 级别 16 或更高的设备知道/可以使用该方法/类。如果将代码放在 api 级别 15 或更低的设备下，将无法运行。

# java - 在不受支持的 Java 版本上运行 Java 包

> ID：14310429
> 
> 赞同：0
> 
> 时间：2013-01-14T01:51:25.370
> 
> 标签：java, macos

我有一个 PowerMac，它在一些 .jar 上给了我错误的版本号。我想让它看起来像是在运行 Java 6。我将如何欺骗该版本？我还要说我正在运行**PowerPC 和 Leopard**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:10:35.423

最可能的问题是您有 Java 6 JAR 文件并且您正试图在旧的 Java 安装上运行它们。

> 我将如何欺骗版本？

你的问题的答案是你不能。运行 Java 6 特定 JAR 文件的方式是使用 Java 6（或更高版本）JRE 或 JDK。

问题是 Java 类文件的格式发生了变化，而您的安装无法应对新的格式。这不是你可以假装不存在的无端改变。Java 6（实际上是 Java 5）支持泛型类型、枚举、注释和其他东西。假设 JAR 包含使用这些新语言特性的代码，那么旧的 JRE 根本不知道如何处理它们。

有两种解决方案：

*   在所有机器上将您的 Java 安装升级到所需的级别。这是最好的解决方案……如果可以选择的话……因为这意味着您的用户将受益于安全性和错误修复以及性能增强。（并且您的项目进度不会受到支持旧平台的限制。）

*   编译所有代码以与您仍然必须使用的最旧版本的 Java 兼容。要么在相应的旧 JDK 上编译，要么在更新的 JDK 上使用适当的 -source / -target / -Xbootclasspath 选项编译......如`javac`手册页所述。

第二种解决方案的问题是，如果相关 JAR 文件的源代码使用最近添加的 Java 语言功能或 API，那么为旧平台重新编译将失败。要解决此问题，您将需要重写代码以用古老的东西替换漂亮的现代东西。不是一个好的解决方案，IMO。

* * *

另一种可能性是您看到损坏的 JAR 文件。这不太可能发生，但如果您使用的是 applet 或 webstart，并且服务器正在传递错误页面而不是 JAR 文件，则可能会发生这种情况。

* * *

第三种可能性是您根本没有正确配置 Mac 的 Java 安装。将 Java 7 设为默认*应该*允许您在没有类版本问题的情况下运行所有​​内容。（感谢@paulsm4）请注意，我无法帮助您……因为我不在 Mac 上使用 Java。

# r - 为矩阵的对角线条目赋值

> ID：14310430
> 
> 赞同：12
> 
> 时间：2013-01-14T01:51:32.437
> 
> 标签：r, matrix, assign

我需要在 for 循环中访问和分配 m*n 矩阵的单个插槽。到目前为止的代码：

```
rowCount <- 9
similMatrix = matrix(nrow = rowCount - 1, ncol = rowCount)
show(similMatrix)
for(i in (rowCount - 1)){
  for (j in rowCount)
    if (i == j){
      similMatrix[i == j] <- 0;
    }
}
show(similMatrix) 
```

因此，如果 i = j，则矩阵中的 NA 值需要替换为 0。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-01-14T02:02:04.737

你想要的功能`diag<-`

```
m <- matrix(1:12, nrow=3)
m
     [,1] [,2] [,3] [,4]
[1,]    1    4    7   10
[2,]    2    5    8   11
[3,]    3    6    9   12

diag(m) <- 0
m
     [,1] [,2] [,3] [,4]
[1,]    0    4    7   10
[2,]    2    0    8   11
[3,]    3    6    0   12 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-14T02:24:49.577

为了将“对角线”元素设置为零，您已经得到了答案，但我想知道您是否希望得到更一般的东西。该代码未能成功的原因有两个：索引的构建有缺陷，索引错误。这将成功：

```
for(i in 1:(rowCount - 1)){  # need an expression that retruns a sequence
  for (j in 1:rowCount)      # ditto
    if (i == j){
      similMatrix[i,j] <- 0;  # need to index the matrix with two element if using i,j
    }
}
#----------
> show(similMatrix)
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
[1,]    0   NA   NA   NA   NA   NA   NA   NA   NA
[2,]   NA    0   NA   NA   NA   NA   NA   NA   NA
[3,]   NA   NA    0   NA   NA   NA   NA   NA   NA
[4,]   NA   NA   NA    0   NA   NA   NA   NA   NA
[5,]   NA   NA   NA   NA    0   NA   NA   NA   NA
[6,]   NA   NA   NA   NA   NA    0   NA   NA   NA
[7,]   NA   NA   NA   NA   NA   NA    0   NA   NA
[8,]   NA   NA   NA   NA   NA   NA   NA    0   NA 
```

但是在 R 中使用循环通常被认为是最后的手段（有时是出于错误的原因。）有一种更紧凑的方式来执行相同的“循环”操作，并且它比仅设置对角线更广泛地推广。

```
similMatrix[ row(similMatrix) == col(similMatrix) ] <- 0
> similMatrix
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
[1,]    0   NA   NA   NA   NA   NA   NA   NA   NA
[2,]   NA    0   NA   NA   NA   NA   NA   NA   NA
[3,]   NA   NA    0   NA   NA   NA   NA   NA   NA
[4,]   NA   NA   NA    0   NA   NA   NA   NA   NA
[5,]   NA   NA   NA   NA    0   NA   NA   NA   NA
[6,]   NA   NA   NA   NA   NA    0   NA   NA   NA
[7,]   NA   NA   NA   NA   NA   NA    0   NA   NA
[8,]   NA   NA   NA   NA   NA   NA   NA    0   NA 
```

如果您想将下对角线设置为零，您可以使用：

```
similMatrix[ row(similMatrix)-1 == col(similMatrix) ] <- 0 
```

您可以使用以下方法避免生成额外的行和列矩阵：

```
 mind <- min( dim(similMatrix) )
 # avoid going outside dimensions if not symmetric
 similMatrix[ cbind( seq(maxd),seq(maxd) ) <- 0 
```

# android - android图像旋转，导入错误

> ID：14310435
> 
> 赞同：3
> 
> 时间：2013-01-14T01:52:49.560
> 
> 标签：android, image, rotation, import

大家好。

我在进口方面遇到问题。它向我显示导入错误，如果我删除它们`JpegImageMetadata`， , `Sanselan`, `ImageReadException`, `TiffImageMetadata`,`ExifTagConstants`将无法解析为类型。

我正在使用 Android 2.3.3 并且也尝试了 Android 3.2，但仍然遇到同样的问题。以下是进口：

```
import org.apache.sanselan.ImageReadException;
import org.apache.sanselan.Sanselan;
import org.apache.sanselan.formats.jpeg.JpegImageMetadata;
import org.apache.sanselan.formats.tiff.TiffImageMetadata;
import org.apache.sanselan.formats.tiff.constants.ExifTagConstants; 
```

这是显示错误的代码的另一部分（如果需要，我可以发布整个代码）：

```
private int degreeRotated(String filePath) {
        try {
            JpegImageMetadata meta = ((JpegImageMetadata) Sanselan.getMetadata(new File(filePath)));
            TiffImageMetadata data = null;
            if (meta != null) {
                data = meta.getExif();
            }
            int orientation = 0;
            if (data != null) {
                orientation = data.findField(ExifTagConstants.EXIF_TAG_ORIENTATION).getIntValue();
            } else {
                String[] projection = { Images.ImageColumns.ORIENTATION };
                Cursor c = getContentResolver().query(Uri.fromFile(new File(filePath)), projection, null, null, null);

                if (c != null && c.moveToFirst()) {
                    orientation = c.getInt(0);
                }
            }
            switch (orientation) {
                case 6:
                    return 90;
                case 8:
                    return 270;
                default:
                    return 0;

            }
            /*
             * } catch (JpegProcessingException e1) { e1.printStackTrace(); }
             * catch (MetadataException e) { e.printStackTrace(); }
             */} catch (ImageReadException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return 0;
    } 
```

这是错误日志：

```
Description   Resource   Path   Location   Type
ImageReadException cannot be resolved to a type   Viewer.java   /Main/src/com/owleyes/moustache   line 687   Java Problem
ExifTagConstants cannot be resolved to a variable   Viewer.java   /Main/src/com/owleyes/moustache   line 666   Java Problem
TiffImageMetadata cannot be resolved to a type   Viewer.java   /Main/src/com/owleyes/moustache   line 660   Java Problem
Sanselan cannot be resolved   Viewer.java   /Main/src/com/owleyes/moustache   line 659   Java Problem
JpegImageMetadata cannot be resolved to a type   Viewer.java   /Main/src/com/owleyes/moustache   line 659   Java Problem
JpegImageMetadata cannot be resolved to a type   Viewer.java   /Main/src/com/owleyes/moustache   line 659   Java Problem
The import org.apache.sanselan cannot be resolved   Viewer.java   /Main/src/com/owleyes/moustache   line 11   Java Problem
The import org.apache.sanselan cannot be resolved   Viewer.java   /Main/src/com/owleyes/moustache   line 10   Java Problem
The import org.apache.sanselan cannot be resolved   Viewer.java   /Main/src/com/owleyes/moustache   line 9   Java Problem
The import org.apache.sanselan cannot be resolved   Viewer.java   /Main/src/com/owleyes/moustache   line 8   Java Problem
The import org.apache.sanselan cannot be resolved   Viewer.java   /Main/src/com/owleyes/moustache   line 7   Java Problem 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:58:08.547

显然您没有所需的库：[Apache Sanselan](http://commons.apache.org/imaging/)。

在此处下载二进制文件：http: [//commons.apache.org/imaging/download_sanselan.cgi](http://commons.apache.org/imaging/download_sanselan.cgi)，然后解压缩存档。把它`sanselan-{version}.jar`放在你的项目`libs`目录中。重新编译，错误应该消失了。

Remember - Android doesn't have Sanselan library included out of the box.

# java - Java 数据建模 - 将关系数据保存为可互操作的格式

> ID：14310437
> 
> 赞同：1
> 
> 时间：2013-01-14T01:53:05.173
> 
> 标签：java, jakarta-ee, jaxb, data-modeling

我正在开发一个带有一些 POJO 类的 J2SE 桌面应用程序，这些 POJO 类使用 ArrayLists 表示数据和它们之间的一对多/多对多关系。我没有使用 ORM，只是使用 Collections 管理数据并使用 Java 的 PropertyChangeListener 来触发模型事件以保持模型解耦（来自 Python 背景，DAO 模式所需的重复量和样板代码似乎很难编写和维护）。

所以为了在这个应用程序中保存文件，我最初使用了序列化。这当然是一个糟糕的决定，因为对软件域对象的更新破坏了与以前保存的文件的向后兼容性。

然后我决定转移到 JAX-B，但看看这个虚构的输出：

```
<Person>
  <Todo>
    <title>Task 1</title>
  </Todo>
</Person>

<Category>
  <title>Category 1</title>
  <Todo>
    <title>Task 1</title>
  </Todo>
</Category> 
```

我现在无法发现`Todo`来自 Person 的 Todo 与来自 Category 的 Todo 相同。我想我可以添加一个`id`字段并跟踪最大 id 作为模型上的静态变量，但这似乎是很多样板文件，并且可以通过按 ID 搜索来填充集合。

是否有解决此类问题的标准方法，以及 Java 社区中最广泛的解决方案是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:22:14.043

没有“标准”的方式来做到这一点。但是您可能要考虑的一个选项是将您的对象序列化为 JSON。然后，您可以将 JSON 存储到文件中，或者存储到 Redis 等小型键值存储中。JSON的一些优点？

*   相当紧凑的格式，特别是在保存之前压缩时。
*   易于解析，具有大量可用的现有库来完成这项工作
*   相当容易转发因素（例如，在您的域模型发生变化的情况下）
*   人类可读。

并且一些 JSON 库（如 Jackson 2+）可以跟踪对象身份，使数据重复成为非因素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:02:15.967

您可以在 XML 中添加 3 行来定义关系。

```
<Person>
  <title>Person 1</title>
  <Todo>
    <title>Task 1
      <category>Category 1</category
    </title>
  </Todo>
</Person>

<Category>
  <title>Category 1</title>
  <Todo>
    <title>Task 1
      <person>Person 1</person>
    </title>
  </Todo>
</Category> 
```

# css - 为什么我的锚定链接没有到达正确的位置？

> ID：14310438
> 
> 赞同：0
> 
> 时间：2013-01-14T01:53:29.213
> 
> 标签：css, html, position

我的导航栏正确链接到我的“工作”部分，但如果我在导航栏上单击“关于”，它会下降到“关于”h2 上方约 300 像素。我觉得这可能与位置，显示器有关？如果我添加，我可以让 ABOUT 锚定链接正确转到 about 部分

```
#about{
    margin-top: 360px
} 
```

尽管对于我的构造中的一个更大问题，这似乎是一个糟糕的补丁。我尝试过做很多不同的事情，但最后我的工作、关于和联系部分开始相互重叠，我也无法理解。div 似乎没有正确堆叠或其他东西。任何帮助是极大的赞赏。

[http://wrobbins.me](http://wrobbins.me)是网站。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:20:48.380

该链接将您准确带到`about`元素所在的位置，只是元素中的文本被上面块中的元素下推`job`。

问题是`jobwrap`元素。它里面的浮动元素不会影响它的大小，所以它的高度为零。

添加`overflow:hidden`到`#jobwrap`样式中，它将包含它的子元素，并且`about`元素将从它下面开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:12:52.420

当你使用浮动时，你应该“清除”它的父级或你想要在下面的块。现在您的#jobwrap 块的高度为零，并且#about 位置存在问题。`#about{cloar:both;}`用作修补程序并阅读有关浮动和 clearfix 的更多信息。

# c# - linq to entity：整形子查询错误

> ID：14310439
> 
> 赞同：0
> 
> 时间：2013-01-14T01:53:31.737
> 
> 标签：c#, entity-framework, entity-framework-5

我正在尝试使用 VS2012 和 EF5 将结果塑造成“FullList”：

```
public class FullList {
    public int ListID {get; set;}
    public string ListName {get; set;}
    public List<ListItems> ListItems {get; set;}
}

public class ListItems {
    public int ItemID {get; set;}
    public string ItemName {get; set;}
} 
```

这是我的查询，它生成了“LINQ to Entities 无法识别该方法......blahblahblah......并且此方法无法转换为商店表达式”的恼人错误。

```
List<FullList> x = (from l in entities.Lists
                   select new FullList
                   {
                       ListID = l.ListID,
                       ListName = l.ListName,
                       ListItems = l.ListItems.Select(li => new ListItems
                                   {
                                       ItemID = li.ItemID,
                                       ItemName = li.ItemName
                                   }).ToList()
                    }).ToList(); 
```

它编译得很好，对我来说，它看起来应该可以工作，但没有骰子......有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:03:44.797

遗憾的是，EF 不支持你修改块选择范围内的值。所以你可以创建你的查询，执行它并以映射对象的列表格式获取结果，然后执行到你的 ViewModel、DTO 等的转换......试试这样的事情：

```
List<FullList> x = (from l in entities.Lists
                   select l) // create your query
                   .ToList() // execute query and get the List<Entity>
                   .Select(l => new FullList // customize your result (convert to List<FullList>)
                                {
                                  ListID = l.ListID,
                                  ListName = l.ListName,
                                  ListItems = l.ListItems.Select(li => new ListItems
                                       {
                                           ItemID = li.ItemID,
                                           ItemName = li.ItemName
                                       }).ToList()
                                }).ToList(); 
```

# javascript - 监控 JavaScript 事件

> ID：14310440
> 
> 赞同：7
> 
> 时间：2013-01-14T01:53:54.473
> 
> 标签：javascript, firebug

是否可以监视浏览器中的所有 JavaScript 事件？
比如调用了哪些函数，在哪个js-file中传递了哪些参数？

就我而言，我有一些混淆的代码，需要找出在执行操作时调用了哪些函数。

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T21:15:28.027

[TraceGL](https://trace.gl/)代码流可视化器可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:23:49.747

您想监控 javascript 事件，可能是您想要的：

[http://www.sprymedia.co.uk/article/Visual+Event](http://www.sprymedia.co.uk/article/Visual+Event)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T19:17:24.847

也许我误解了这个问题，但我认为 Firebug 的[分析器](http://getfirebug.com/wiki/index.php/Profiler)和[调试器](https://getfirebug.com/wiki/index.php/Script_Debugging)会给你你正在寻找的信息。

# javascript - 如何在three.js中查看两侧的自定义2D形状

> ID：14310447
> 
> 赞同：0
> 
> 时间：2013-01-14T01:54:18.110
> 
> 标签：javascript, three.js, custom-object

我是three.js和一般3d编程的新手，我用three.js绘制了一个扇区，我可以在一个方向上看到对象，但我在相反的方向上看不到它，似乎是三个。[这里](http://mrdoob.github.com/three.js/examples/webgl_geometry_shapes.html)的js例子有同样的现象，我怎么能看到两个dretions中的对象？

```
var squareShape = new THREE.Shape();
var arc = 1/6*Math.PI
var len = 20
squareShape.moveTo( 0,0 );
squareShape.absarc( 0, 0, 20, 4/3*Math.PI, 5/3*Math.PI, false );
squareShape.moveTo( 0, 0 );
var geometry = new THREE.ExtrudeGeometry( squareShape,  {amount:0.1} );
var mesh = THREE.SceneUtils.createMultiMaterialObject( geometry, [ new THREE.MeshLambertMaterial( { color: 0xff0000 ,opacity: 1.0} ), new THREE.MeshBasicMaterial( { color: 0xff0000, wireframe: true, transparent: true ,opacity: 1.0} ) ] );
mesh.position.set( 10, 10, 10  );
mesh.rotation.set( Math.PI/2, 0, Math.PI/2 );
scene.add( mesh ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:59:27.137

在你的情况下，这将是

```
new THREE.MeshLambertMaterial( { color: 0xff0000, opacity: 1.0, side: THREE.DoubleSide } ) 
```

# asp.net - 在 GridView 编辑模式下关闭验证

> ID：14310448
> 
> 赞同：4
> 
> 时间：2013-01-14T01:54:18.950
> 
> 标签：asp.net, visual-studio-2010, validation, gridview

我有一个页面，顶部包含一个表单，用于将新记录添加到 table1 中，下面是一个 GridView，它显示 table1 中的记录并具有编辑能力。

现在上面的表格只是一个文本框，允许您在 table1 中输入名称，这个文本框有一个必填字段验证器。验证器会导致问题，但是当 gridview 处于编辑模式时，因为当用户按下“更新”时，不会保存任何内容，因为验证器是触发器（因为上面的表单中没有任何内容）

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-09-14T18:22:25.110

你必须把 CausesValidation="False" 在 GridView

```
<Columns>
<asp:CommandField ShowDeleteButton="True" ShowEditButton="True" CausesValidation="False"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T02:00:59.790

您可以设置RequiredFieldValidator 控件和Add 按钮具有相同的ValidationGroup 名称。像这样的东西：

```
<asp:Button ID="btnAdd" runat="server" OnClick="btnAdd_Click" ValidationGroup="addValidation" />
<asp:RequiredFieldValidator ID="nameRequired" ControlToValidate="txtName" runat="server" ValidationGroup="addValidation"></asp:RequiredFieldValidator>
...
<asp:Button ID="btnUpdate" runat="server" OnClick="btnUpdate_Click" /> 
```

因此，更新按钮不会受到影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T04:42:48.200

在 gridview 按钮中使用[原因验证为 false。](http://msdn.microsoft.com/en-in/library/system.web.ui.webcontrols.button.causesvalidation.aspx)

```
<asp:Button ID="Button2" runat="server" 
     CausesValidation="False" 
     Text="Cancel - Will Not Validate!" /> 
```

这是一个例子：

[http://www.java2s.com/Code/ASP/Asp-Control/CausesValidationFalse.htm](http://www.java2s.com/Code/ASP/Asp-Control/CausesValidationFalse.htm)

# javascript - 正则表达式 - 如何排除“%”和“_”？

> ID：14310459
> 
> 赞同：6
> 
> 时间：2013-01-14T01:56:30.180
> 
> 标签：javascript, jquery, regex

`%`我允许数字、字母和特殊字符`_`在我的 html 文本框中除外。我有模式`/[a-zA-Z0-9!@#$^&*()-+=]/`。我认为这不是最好的方法，因为我必须列出除了提到的两个之外的所有特殊字符。有没有一种方法可以让我不必列出所有特殊字符并且不包括提到的两个？顺便说一句，我使用 javascript 正则表达式。

有关演示，请参阅[http://jsfiddle.net/ce8Th/](http://jsfiddle.net/ce8Th/)

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:58:47.733

不需要那个复杂的循环。只需`replace`直接调用整个字符串：

```
$(this).val(function (i, v) {
    return v.replace(/%|_/g, '');
}); 
```

这是你的小提琴：http: [//jsfiddle.net/ce8Th/1/](http://jsfiddle.net/ce8Th/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T02:00:02.290

你可以反过来做：

```
/[%_]/

if (pattern.test( .... 
```

如果您不需要，不使用正则表达式也很好，并不是说在这种情况下它有很大的不同：

```
if ("%_".split().indexOf(text.charAt(i)) > -1) { 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T02:02:30.553

白名单总是最好的。除了添加长度修饰符以及开始和结束字符之外，我建议保留您所拥有的内容：

```
/^[a-zA-Z0-9!@#$^&*()-+=]+$/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T02:02:44.007

我是否会碰巧猜测您正在将此用户输入用于涉及`LIKE`搜索部分匹配的 MySQL 查询？

如果是这样，请不要排除字符。相反，在服务器端转义它们。例如：

```
$output = str_replace(Array("%","_"),Array("\\%","\\_"),$input); 
```

# firefox - 对抗 Fuckip IP 匿名 FireFox 插件

> ID：14310463
> 
> 赞同：2
> 
> 时间：2013-01-14T01:57:48.757
> 
> 标签：firefox, nginx, firefox-addon

[http://ipfuck.paulds.fr/](http://ipfuck.paulds.fr/)

我们最近受到这个 Firefox 插件的打击。它在标头中发送一个假 IP，因此当我们的 nginx Web 服务器获取 IP 时，它是一个假 IP。

有没有办法获取真实的 IP 地址或阻止安装了此插件的请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T13:14:56.393

在任何 HTTP 标头中实际上都没有客户端 IP 条目。只有一些非官方的代理头被添加到请求中，以便代理服务器可以告诉您连接客户端的真实 IP（因为 tcp 套接字只会显示代理服务器的 IP 地址）。

您链接到的插件添加这些代理标头，通过向请求添加`X-Real-IP: 1.2.3.4`或`X-Forwarded-For: 1.2.3.4`标头来“伪造”代理请求。但是没有人强迫你使用那个 IP 地址（可能是假的，就像`1.2.3.4`这里的例子），你总是可以使用发起连接的套接字的 IP 地址——如果他使用提到的，这将是客户端的真实 IP 地址插入。

在`location`nginx 配置部分中，您可以通过`$remote_addr`变量获取套接字 IP 地址。要检索“假”IP 地址，您可以使用`$http_x_forwarded_for`或`$http_x_real_ip`变量。

如果您使用任何应用程序/cgi 后端，您通常可以检查完整的标头和套接字 IP 地址（即在 PHP 中您应该检查`$_REQUEST`和`$_HEADERS`变量）

# ruby-on-rails - Ruby on Rails：如何在 form_tag 中实现取消按钮

> ID：14310468
> 
> 赞同：15
> 
> 时间：2013-01-14T01:58:17.543
> 
> 标签：ruby-on-rails, ruby, forms

我有一个使用 form_tag 助手工作正常的基本表单，但我想添加一个取消按钮，这样做的语法是什么？我希望取消按钮显示为按钮，而不是链接，然后将用户带到不同的 URL（表明他们不想提交表单）。

泰，弗雷德

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-14T02:54:03.937

如果您指的是重置按钮，请将以下内容粘贴到您的表单中：

```
<%= button_tag "Reset", type: :reset %> 
```

测试它，它工作正常并重置表单中的所有字段。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-01-14T05:22:48.603

如果您想清除/重置表单字段，请按照 weltschmerz 的建议进行操作。

但是，我通常希望取消按钮不会清除表单，而是让我远离表单，这意味着我不打算提交它。

如果您想要后者，我只需在您取消后要转到的页面上创建一个链接（或按钮），例如：

```
=link_to 'Cancel', my_page_path 
```

或者如果你想要一个按钮：

```
= button_tag "Cancel", :type => 'button' 
```

然后将其添加到您的控制器：

```
# before_filter for Rails 4.x and prior
before_action :check_for_cancel, :only => [:create, :update]

def check_for_cancel
  if params[:commit] == "Cancel"
    redirect_to my_page_path
  end
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-06T16:11:05.327

我建议使用标签而不是提交标签`<button>`，因为参数`:commit`可能是本地化的，因此在控制器中进行评估会很痛苦。

A`button_tag`可以像任何其他字段一样具有名称/值，因此您基本上可以使用它创建一个标志。

以下代码是我将使用的：

**在视图中：**

```
<%= button_tag t('buttons.cancel'), type: "submit", name: "cancel", value: true %> 
```

**在控制器中：**

```
before_filter :redirect_cancel, only: [:create, :update]

private

def redirect_cancel
  redirect_to my_page_path if params[:cancel]
end 
```

更清洁恕我直言，因为您依赖于标志而不是（可能）本地化的显示值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-08T08:24:08.603

[`button_to`](http://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to)似乎是实现相同的简单方法，但它必须放在表单本身之外，但这可以很容易地用 css 修复。

此外，为了以更通用的方式解决此问题（也适用于在尚未持久化的资源上编辑嵌套资源），您可以为取消创建一个单独的表单，其中包含所有原始值作为隐藏字段。

# tomcat - tomcat 会创建无限数量的处理线程吗？

> ID：14310474
> 
> 赞同：1
> 
> 时间：2013-01-14T01:58:50.040
> 
> 标签：tomcat, threadpool

系统管理员最近通知我有关由 tomcat 实例创建的大量系统线程。性能图显示，从特定时间点开始，线程数开始不断增长，最终停止在 2500 左右。

我检查了web应用程序，没有明显的线程泄漏，所以线程必须由tomcat或数据库连接池创建。

然后我在代码中发现了一个死锁，这将阻止线程返回到线程池，但我仍然不确定tomcat如何能够首先创建这么多线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T10:40:21.023

通常，有限制... [http://tomcat.apache.org/tomcat-7.0-doc/config/executor.html](http://tomcat.apache.org/tomcat-7.0-doc/config/executor.html)（默认为 200）

创建什么样的线程？等待 HTTP 请求的线程？

您应该尝试在调试中连接到服务器并进行线程转储，以了解线程卡在哪里以及创建了哪种线程。

HIH

# php - PHP 显示图像（SSL 代理）

> ID：14310475
> 
> 赞同：1
> 
> 时间：2013-01-14T01:58:54.440
> 
> 标签：php, ssl, proxy

我正在尝试制作一个接受 URL 并显示它的 PHP 脚本（试图在我的项目中保留 SSL）

但是，我的脚本无法输出任何内容。没有显示错误，我不知所措。我没看到什么？

```
<?php

//if parameter is empty
if((!isset($_GET['img'])) or ($_GET['img'] == '') or (!isset($per['scheme'])))
{
    exit;
}

$per = parse_url($_GET['img']);
print_r ($per);
$imgurl = $_GET['img'];
print_r ($imgurl);
$imgurl = str_replace(' ', "%20", $imgurl);

$aFile = getimagesize($imgurl);
print_r ($aFile);

//check file extension
if($aFile == 'jpg' or $aFile == 'jpeg'){
        header('Content-Type: image/jpeg');
        imagejpeg(getimg($file));
} elseif($aFile == 'png') {
        header('Content-Type: image/png');
        imagepng(getimg($file));
} elseif($aFile == 'gif') {
        header('Content-Type: image/gif');
        imagegif(getimg($file));
} else {
        die('not supported');
}

$imgurl = $_GET['img'];
$imgurl = str_replace(' ', "%20", $imgurl);

function getimg($imageurl) {
    $cache_expire = 60*60*24*365;
    $headers[] = 'Accept: image/gif, image/x-bitmap, image/jpeg, image/pjpeg, image/png';
    $headers[] = 'Cache-Control: maxage=. $cache_expire';
    $headers[] = 'Pragma: public';
    $headers[] = 'Accept-Encoding: None';
    $headers[] = 'Content-type: application/x-www-form-urlencoded;charset=UTF-8';
    $user_agent = 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6';
    $process = curl_init($imageurl);
    curl_setopt($process, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($process, CURLOPT_REFERER, $_GET['img']);
    curl_setopt($process, CURLOPT_HEADER, 0);
    curl_setopt($process, CURLOPT_HTTPGET, true);
    curl_setopt($process, CURLOPT_USERAGENT, $user_agent);
    curl_setopt($process, CURLOPT_TIMEOUT, 30);
    curl_setopt($process, CURLOPT_RETURNTRANSFER, 1);
    $return = curl_exec($process);
    curl_close($process);
    return $return;
}
exit;
?> 
```

这是我使用 readfile 时输出乱码文本的脚本的编辑版本：

```
<?php
error_reporting(E_ALL);
ini_set('display_errors', '1');

//if parameter is empty
if((!isset($_GET['img'])) or ($_GET['img'] == ''))
{
    exit;
}

$per = parse_url($_GET['img']);
$imgurl = $_GET['img'];
$imgurl = str_replace(' ', "%20", $imgurl);

$aFile = getimagesize($imgurl);

//check file extension
$checkmime = getimagesize($imgurl);

if($checkmime['mime'] != 'image/png' && $checkmime['mime'] != 'image/gif' && $checkmime['mime'] != 'image/jpeg') {
    die('not supported');
} else {
    readfile("$imgurl");
}

function getimg($imageurl) {
    $cache_expire = 60*60*24*365;
    $headers[] = 'Accept: image/gif, image/x-bitmap, image/jpeg, image/pjpeg, image/png';
    $headers[] = 'Cache-Control: maxage=. $cache_expire';
    $headers[] = 'Pragma: public';
    $headers[] = 'Accept-Encoding: None';
    $headers[] = 'Content-type: application/x-www-form-urlencoded;charset=UTF-8';
    $user_agent = 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6';
    $process = curl_init($imageurl);
    curl_setopt($process, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($process, CURLOPT_REFERER, $_GET['img']);
    curl_setopt($process, CURLOPT_HEADER, 0);
    curl_setopt($process, CURLOPT_HTTPGET, true);
    curl_setopt($process, CURLOPT_USERAGENT, $user_agent);
    curl_setopt($process, CURLOPT_TIMEOUT, 30);
    curl_setopt($process, CURLOPT_RETURNTRANSFER, 1);
    $return = curl_exec($process);
    curl_close($process);
    return $return;
}
exit;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:11:48.467

如果这确实是您的整个脚本，那么您的问题首先在于`$per['scheme']`未设置，因此它将触发第一个`if()`语句并拥有脚本`exit`。

您检查它是否未在此处设置：`!isset($per['scheme'])`因此它将生成表达式`TRUE`并因此结束脚本，即使来自`print_r();`

改用这个：

```
if (empty($_GET['img'])) // Check if $_GET['img'] is not set AND is = '' (empty)
{
    exit;
} 
```

采用：

```
} else {
    header('Content-Type: ' . $checkmime['mime']);
    readfile($imgurl);
} 
```

# iphone - ios 测试宏错误“预期标识符”

> ID：14310478
> 
> 赞同：0
> 
> 时间：2013-01-14T01:59:10.773
> 
> 标签：iphone, ios, testing, ipa

我正在尝试创建一个简单的测试宏，但在以下几行中出现错误。你们中的任何人都知道为什么或如何修复它们吗？

```
#define test(condition) do{\
    if (condition)
    {\        //// <-----Expected identifier or (
        NSlog @"passed: " %@ #condtion); \

    }
    else
    {\
        NSLog(@"failed: " @ #condition); \

    }
}   //// <-----extraneous closing brace ( "}") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T02:20:56.887

您需要在多行宏的每一行末尾添加一个反斜杠（最后一行除外）。

```
#define test(condition) do{\
    if (condition) \
    {\
        NSlog @"passed: " %@ #condtion); \
    } \
    else \
    { \
        NSLog(@"failed: " @ #condition); \
    } \
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:20:35.297

你可以简化很多。这里：

```
#define test(condition) NSLog("%s: %s\n", condition ? "Passed" : "Failed", #condition); 
```

像这样调用：

```
int i = 6;
test(i > 8);
test(i < 8); 
```

输出：

```
Failed: i > 8
Passed: i < 8 
```

# ios - 使用 3.0 SDK 的 Facebook 应用程序

> ID：14310480
> 
> 赞同：0
> 
> 时间：2013-01-14T01:59:23.770
> 
> 标签：ios, facebook, facebook-ios-sdk, facebook-app-requests

我正在使用 Facebook iOS SDK 3.1.1 并且已经成功集成了很多 Facebook 功能。坚持3.1.1，我登录使用

```
 [FBSession openActiveSessionWithPermissions:permission
                                       allowLoginUI:bAllowLoginUI
                                  completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {
                                  [self sessionStateChanged:session state:state error:error];
        }]; 
```

然后我需要发送“apprequests”，并且在 SDK 3.1 中没有新的方法可以实现，所以我必须使用 Facebook 对象和 FBDialog 回退到已弃用的 API。

但是，调用已弃用的对话框函数：

```
[m_pFacebook dialog:@"apprequests"
           andParams:params
         andDelegate:delegate]; 
```

导致弹出 FBDialog 并提示用户通过对话框再次登录。我需要直接进入 apprequests 对话框，而不需要用户再次输入他们的凭据，我确信有一种方法可以做到这一点，因为我已经看到它在 Diamond Dash 和其他游戏中实现。

我尝试使用 FBSession.activeSession.accessToken 设置 m_pFacebook.accessToken，并且我还确保 m_pFacebook.session 填充了 FBSession 的登录会话

以前有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T06:16:07.083

经过一番调试，发现 Facebook *m_pFacebook 对象的 expireDate 没有更新，因此 _lastAccessTokenUpdate 仍在 [NSDate distinctPast] 中。解决方法是调用

```
[m_pFacebook fbDialogLogin:session.accessToken expirationDate:session.expirationDate]; 
```

当 sessionStateChanged 为 FBSessionStateOpen

```
- (void) sessionStateChanged:(FBSession*)session state:(FBSessionState)state error:(NSError*)error {
    switch ( state ) {
        case FBSessionStateOpen:
            [m_pFacebook fbDialogLogin:session.accessToken expirationDate:session.expirationDate];
        break;
    }
} 
```

# php - 未定义索引：使用 html5 提交

> ID：14310482
> 
> 赞同：0
> 
> 时间：2013-01-14T01:59:43.440
> 
> 标签：php, javascript, mysql

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:03:38.280

要修复未定义的错误，请更改此：

```
<? echo $_POST['sample']?> 
```

对此：

```
<? if (isset($_POST['sample'])) {echo $_POST['sample'];} ?> 
```

# sql - 我如何正确地构图这个整理？

> ID：14310485
> 
> 赞同：2
> 
> 时间：2013-01-14T02:00:33.913
> 
> 标签：sql, sql-server-2008, tsql, collate

以下代码：

```
SELECT  *
FROM    portal.workflow AS w
        INNER JOIN portal.workflow_type AS wt
            ON w.workflow_type_id = wt.workflow_type_id
WHERE   wt.doc_type IN ('CentreEV', 'Expenditure Voucher')
        AND w.varchar_1 NOT IN (    select f1.BAT_NAME as 'DocumentFile'
                                    from openquery(QICRE_F1, 'select * 
                                                            from dbo.IO_GLF_BAT_CTL_VW 
                                                            where bat_stat = ''S'' ') f1
                                    where f1.USAGE_STAT = 'A'   ) 
```

抛出以下错误：

> 消息 468，级别 16，状态 9，第 1 行无法解决等于操作中“Latin1_General_CI_AS”和“Latin1_General_CS_AS”之间的排序规则冲突。

我尝试使用以下方法解决此问题，但收到语法错误。我不知所措（即使在查看文档之后）在这种情况下应该如何完成：

```
SELECT  *
FROM    portal.workflow AS w
        INNER JOIN portal.workflow_type AS wt
            ON w.workflow_type_id = wt.workflow_type_id
WHERE   wt.doc_type IN ('CentreEV', 'Expenditure Voucher')
        AND COLLATE Latin1_General_CI_AS w.varchar_1 NOT IN 
                                (   select f1.BAT_NAME as 'DocumentFile'
                                    from openquery(QICRE_F1, 'select * 
                                                            from dbo.IO_GLF_BAT_CTL_VW 
                                                            where bat_stat = ''S'' ') f1
                                    where f1.USAGE_STAT = 'A'   ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:17:11.587

您的查询可能有 2 个问题。尝试这样的事情

```
...
WHERE ...
   AND w.varchar_1 COLLATE Latin1_General_CI_AS IN  
... 
```

您可能需要将相同的语法添加到您的 openquery 命令。这是我不确定它是否会起作用的地方，因为您可能需要使用linkedserver.database.schema.table 语法——只需要测试它。但是这样的事情：

```
from openquery(QICRE_F1, 'select bat_name COLLATE Latin1_General_CI_AS  
   from dbo.IO_GLF_BAT_CTL_VW 
   where bat_stat = ''S'' ') f1 
```

祝你好运。

# image - 用谷歌检查图像

> ID：14310489
> 
> 赞同：0
> 
> 时间：2013-01-14T02:00:57.387
> 
> 标签：image, libcurl

我正在制作一个网站，ppl 将在其中上传图片，我希望能够对照谷歌检查它们，看看它们是原创的还是从某处从网络上删除的。我正在考虑通过分析使用谷歌图片时发出的请求（上传图片的搜索类型，谷歌找到它的来源）并使用 libcurl 复制它。有没有人对这样做的好方法有任何想法？谷歌似乎没有为此提供api

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:22:33.933

您真正在谈论的是“反向图像搜索”，它有望为您提供更多的杠杆作用，以进一步搜索以查找所需的信息。我打算简要地写一下我对这个过程的模糊理解，但在我完成之前，我发现了一些与你类似的以前的问题，这些问题比我做得好得多：

[无论大小如何，都可以使用什么算法来识别图像是否“相同”或相似？](https://stackoverflow.com/questions/1005115/what-algorithm-could-be-used-to-identify-if-images-are-the-same-or-similar-re)

[我想知道像 tineye.com 这样的反向图像搜索服务是如何工作的......？](https://stackoverflow.com/questions/5314375/i-wonder-how-reverse-image-search-services-like-tineye-com-work)

# javascript - 单击的表行返回 NaN

> ID：14310491
> 
> 赞同：0
> 
> 时间：2013-01-14T02:01:05.757
> 
> 标签：javascript, dom

我正在尝试确定用户单击的行号并提醒他们。我想免除表头的计数，所以我故意使用了 this.rowIndex - 1 但是当我单击任何行时，警报框会返回一个 NaN 值。

你如何解决这个问题？

```
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
#mstrTable {
     border: 1px solid black
}
#mstrTable td, th {
     border: 1px solid black
}

#mstrTable tr.normal td {
    color: black;
    background-color: white;
}
#mstrTable tr.highlighted td {
    color: white;
    background-color: gray;
}
</style>
</head>
<body>
  <table id="mstrTable">
     <thead>
      <tr> 
        <th>File Number</th>
        <th>Date1</th>
        <th>Date2</th>
        <th>Status</th>
        <th>Num.</th>
      </tr>
    </thead>
    <tbody>
      <tr> 
        <td>KABC</td>
        <td>09/12/2002</td>
        <td>09/12/2002</td>
        <td>Submitted</td>
        <td>0</td>

      </tr>
      <tr> 
        <td>KCBS</td>
        <td>09/11/2002</td>
        <td>09/11/2002</td>
        <td>Approved</td>
        <td>1&nbsp;</td>
      </tr>

      <tr> 
        <td>WFLA</td>
        <td>09/11/2002</td>
        <td>09/11/2002</td>
        <td>Submitted</td>
        <td>2</td>
      </tr>
      <tr> 
        <td>WTSP</td>
        <td>09/15/2002</td>
        <td>09/15/2002</td>
        <td>In-Progress</td>
        <td>3</td>
      </tr>
    </tbody>
  </table>

<script type="text/javascript">
(
  function( )
  {
      var trows = document.getElementById("mstrTable").rows;

      for ( var t = 1; t < trows.length; ++t )
      {
          trow = trows[t];
          trow.className = "normal";
          trow.onclick = highlightRow;
      }

      function highlightRow(e)
      {
      alert('Row is ' + this.rowIndex-1)
          for ( var t = 1; t < trows.length; ++t )
          {
              trow = trows[t];
              trow.className = ( trow == this && trow.className != "highlighted") ? "highlighted" : "normal";
          }
      }
  }
)();
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:03:23.787

将括号放在数学运算周围，以便它们优先于字符串连接。

```
alert('Row is ' + (this.rowIndex-1)) 
```

[**小提琴**](http://jsfiddle.net/ecXLk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:06:09.060

将其更改为 this.rowIndex 而不是 this.rowIndex-1。

# java - 不确定如何在 Java Slick 游戏中实现子弹系统？

> ID：14310492
> 
> 赞同：0
> 
> 时间：2013-01-14T02:01:07.783
> 
> 标签：java, slick2d, bullet

因此，我一直在关注 Slick API 2D Game Java 教程的教程，并且掌握了如何使用 API 的基础知识。但是，当我在玩游戏并尝试制作游戏时。我试图在我的 2D 太空射击游戏中实现子弹/射击系统。而且我似乎找不到办法做到这一点！

我试过在 Google 和 YouTube 上四处寻找，但根本没有帮助......！我现在所做的所有游戏就是从右向左移动一艘船。我希望能够做到每次按下空格键时都会发射子弹状物体。我只是不知道该怎么做...我希望有人可以简单地向新程序员解释一下！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T02:06:49.910

我对 Slick 了解不多，但“子弹系统”背后的想法还不错。

除非你想在他们开火时立即命中，你似乎没有这样做，否则你需要做的事情背后的一般想法是这样的。

首先，听空格键按下。发生这种情况时，创建一个新的“子弹”对象。

给这个物体一个运动方向和速度，然后逐渐向那个方向移动。

在移动它时，还要检测它是否与敌人交叉。如果是这样，则移除子弹并杀死敌人。

这是你应该做什么的一个非常基本的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T05:42:54.353

假设您使用轮询输入，您需要`update`在空格键的方法中添加一个检查。如果按下空格键，则将 的新实例添加`Bullet`到项目符号数组中，并在构造函数中传递初始`x`的 ,和 。`y``velocity`

您的`Bullet`课程可能类似于：

```
public class Bullet
{
    public static float VELOCITY;
    private Vector2f position;

    public Bullet(float x, float y, float velocity)
    {
        position = new Vector2f(x, y);

        VELOCITY = velocity;
    }

    public void update(float delta, boolean vertical)
    {
        if(vertical)
        {
            y += VELOCITY * delta;
        }
        else
        {
            x += VELOCITY * delta;
        }
    }
} 
```

您还需要在方法中为项目符号调用更新`update`方法。使用以下方法执行此操作：

```
for(Bullet bullet : bullets)
{
    bullet.update(delta, true);
} 
```

# java - STS tcServer - Restful Web 服务配置

> ID：14310496
> 
> 赞同：0
> 
> 时间：2013-01-14T02:01:22.113
> 
> 标签：java, jersey, spring-tool-suite, tcserver

我正在尝试创建一个 hello world restful(jersey) 网络服务。我正在使用 Spring 工具套件和本机 vFabric tcServer。

以下是 URL：/localhost:8080/example/rest/hello，它给出 404。

我已确保所有 jar 都存在于`WEB-INF/lib`IDE 的文件夹中。

我阅读了各种论坛，其中提到所有 jar 都应该存在于 WEB-INF 目录中。我已经解决了关于同一主题的各种 SO 问题，但我仍然无法解决此错误的原因。

我是否需要专门导航到工作区中的 tcServer 安装来添加这些 jar？有任何想法吗？

启动 tcServer 时出现以下错误：

```
Jan 13, 2013 7:19:23 PM org.apache.catalina.core.ApplicationContext log

INFO: Marking servlet jersey as unavailable
Jan 13, 2013 7:19:23 PM org.apache.catalina.core.StandardContext loadOnStartup
SEVERE: Servlet  threw load() exception
java.lang.ClassNotFoundException: com.sun.jersey.spi.container.servlet.ServletContainer
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:532)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:514)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:133)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1136) 
```

以下是`web.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" 
xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
  <display-name>example</display-name>
  <servlet>
    <servlet-name>jersey</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
      <param-name>com.sun.jersey.config.property.packages</param-name>
      <param-value>com.example.service</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>jersey</servlet-name>
    <url-pattern>/rest/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

和相应的网络服务类：

```
package com.example.service;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("/hello")
public class HelloWorldService {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String sayHello() {
        return "whats up";
    }

    @GET
    @Produces(MediaType.TEXT_XML)
    public String sayHelloXmlVersion() {
        return "<?xml version=\"1.0\"?>" + "<hello> Hello Jersey" + "</hello>";
    }

    @GET
    @Produces(MediaType.TEXT_HTML)
    public String sayHelloHTMLVersion() {
        return "<html> " + "<title>" + "Hello Jersey" + "</title>"
                + "<body><h1>" + "Hello Jersey" + "</body></h1>" + "</html> ";
    }
} 
```

项目中所有jar文件的列表：

```
asm-3.1.jar
jackson-core-asl-1.9.2.jar
jackson-jaxrs-1.9.2.jar
jackson-mapper-asl-1.9.2.jar
jackson-xc-1.9.2.jar
jersey-client-1.16.jar
jersey-core-1.16.jar
jersey-json-1.16.jar
jersey-server-1.16.jar
jersey-servlet-1.16.jar
jettison-1.1.jar
jsr311-api-1.1.1.jar
jsr311-api-1.1.1-javadoc.jar 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:27:18.333

搞定了。不得不参考 web.xml 中的 web 项目名称：

```
 .....
 <display-name>SampleWebService</display-name>
  ....... 
```

以及对应的网址：

```
/localhost:8080/SampleWebService/rest/hello 
```

# android - 安卓，2 个微调器

> ID：14310510
> 
> 赞同：1
> 
> 时间：2013-01-14T02:03:33.087
> 
> 标签：android, android-intent, android-spinner

我是 android 编程的新手，我觉得我正在敲一堵砖墙。

我正在尝试设置两个微调器，因此当在微调器一中选择该项目时，它会在微调器二中显示一个新的项目列表，但问题是微调器有 4 个项目，每个项目我想提出不同关于第二个微调器的信息，如果在选择第二个微调器中的项目时这还不够，我希望它喜欢另一组信息。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:10:36.123

让您的活动实现 onItemSelectedListener，并将微调器绑定到它，如下所示：

```
spinner1.setOnItemSelectedListener(this);
spinner2.setOnItemSelectedListener(this); 
```

然后，您需要使用 onItemSelected 方法更改第二个微调器的数据集，如下所示：

```
public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
   if( parent == spinner1 ) {
          if( pos == 0 ) {
             ArrayAdapter<String> newAdapter = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, newDataSet1);
             newAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
             spinner2.setAdapter(newAdapter);
          } else if( pos == 1 ) {
              //etc
          }
   }
} 
```

您可以在外部 if 中添加第二个子句，检查 parent 是否等于 spinner2，并用其他数据集替换第三个类似的 spinner。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:31:57.647

在我看来，一个更简洁的解决方案是内联定义您的侦听器或将它们定义为您的`Activity`.

例子：

***`layout.xml`***

```
<Spinner
    android:id="@+id/spinner_1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<Spinner
    android:id="@+id/spinner_2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" /> 
```

**`MyActivity.java`**

```
public class MyActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Spinner spinnerOne = (Spinner) findViewById(R.id.spinner_1);
        Spinner spinnerTwo = (Spinner) findViewById(R.id.spinner_2);
        spinnerOne.setOnItemClickListener(new OnItemClickListener() {

            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {

                spinnerTwo.setAdapter(/*set new information in spinner 2 here*/);
            }
        });
    }
} 
```

# objective-c - 网络存储设计模式

> ID：14310511
> 
> 赞同：3
> 
> 时间：2013-01-14T02:03:37.637
> 
> 标签：objective-c, oop, design-patterns, networking

假设我有几个控制器。每个控制器都可以在某些时候创建需要存储在服务器上的新对象。例如，我可以有一个管理表单的 RecipeCreationViewController。提交此表单时，会创建一个新的 Recipe 对象，并需要将其保存在服务器上。

设计类以最小化复杂性和耦合同时保持代码尽可能干净和可读的最佳方法是什么？

**辛格尔顿**

通常我会创建一个单例网络适配器，每个控制器都可以直接访问它以保存对象。

例子：

```
[[[NetworkAdapter] sharedAdapter] saveObject:myRecipe]; 
```

但是我已经意识到，让类自己调用单例会导致难以调试的耦合代码，因为对单例的访问隐藏在实现中，并且从接口中并不明显。

**直接参考**

另一种方法是让每个控制器都持有对 NetworkAdapter 的引用，并由创建控制器的类传入。

例如：

```
[self.networkAdapter saveObject:myRecipe]; 
```

**代表团**

想到的另一种方法是委托。NetworkAdapter 可以实现“RemoteStorageDelegate”协议，并且每个控制器都可以有一个 remoteStorageDelegate，它可以调用诸如 saveObject: on 之类的方法。优点是控制器不知道 NetworkAdapter 的细节，只有实现协议的对象知道如何保存对象。

例如：

```
[self.remoteStorageDelegate saveObject:myRecipe]; 
```

**直接在模型中**

另一种方法是让模型直接处理保存到网络。我不确定这是否是个好主意。

例如：

```
[myRecipe save]; 
```

你怎么看这些？还有其他更有意义的模式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:41:22.040

在您的情况下，我也会坚持使用依赖注入。如果您想阅读有关内容，您会很容易在网络上找到好文章，例如在[Wikipedia](http://en.wikipedia.org/wiki/Dependency_injection)上。在 Objective C 中也有指向 DI 框架的链接。

基本上，如果您有两个或更多组件，则可以使用 DI，它们必须交互但不应该直接在代码中相互了解。我会稍微详细说明您的示例，但使用 C#/Java 风格，因为我不知道 Objective C 语法。假设你有

```
class NetworkAdapter implements NetworkAdapterInterface {
  void save(object o) { ... }
} 
```

与界面

```
interface NetworkAdapterInterface {
  void save(object o);
} 
```

现在您想在控制器中调用该适配器，例如

```
class Controller {
  NetworkAdapterInterface networkAdapter;

  Controller() {
  }

  void setAdapter(NetworkAdapterInterface adapter) {
    this.networkAdapter = adapter;
  }

  void work() {
    this.networkAdapter.save(new object());
  }
} 
```

调用 Setter 是现在 DI 的神奇之处（称为*Setter Injection*；还有例如*Constructor Injection*）。这意味着您没有一个代码行可以自己调用 Setter，而是让它执行 DI 框架。非常松耦合！

现在它是如何工作的？通常使用通用 DI 框架，您可以在中央代码位置或 XML 文件中定义组件之间的实际映射。你有的图片

```
<DI>
  <component="NetworkAdapterInterface" class="NetworkAdapter" lifecycle="singleton" />
</DI> 
```

这可以告诉 DI 框架为它在代码中找到的`NetworkAdapter`每个 Setter自动注入一个。`NetworkAdapterInterface`为此，它将首先为您创建正确的对象。如果它为每次注入构建一个新对象，或者为所有注入只构建一个对象（*Singleton*），或者例如每个*工作单元*一个对象（如果您使用这种模式），则可以为每种类型配置。

作为旁注：如果您正在对代码进行单元测试，您还可以使用 DI 框架来定义完全适合您的测试场景的其他绑定。注入一些模拟的简单方法！

# asp.net - 接收“此操作需要 IIS 集成管道模式。” 将 httpModule 添加到 VS Web 项目时出错

> ID：14310515
> 
> 赞同：1
> 
> 时间：2013-01-14T02:04:13.100
> 
> 标签：asp.net

有人可以阐明发生了什么吗？我有一个使用 VS 2010 创建的网站。添加 httpModule 时，VS 默认添加以下代码。当我通过 Cassen 运行应用程序时，突出显示的行抛出错误“此操作需要 IIS 集成管道模式”。

```
public void Init(HttpApplication context)
    {
        // Below is an example of how you can handle LogRequest event and provide 
        // custom logging implementation for it
       **context.LogRequest += new EventHandler(OnLogRequest);**
    }

    #endregion

    public void OnLogRequest(Object source, EventArgs e)
    {
        //custom logging logic can go here
    } 
```

我的 web.config 文件已更新为：

```
<configuration>  
<system.web>
    <compilation debug="true" targetFramework="4.0" />

  <httpModules>
    <add name="GlobalModule" type="MyApp.Global.GlobalModule, EduCarePro"/>
  </httpModules>

</system.web>

<system.webServer>
<modules>
  <remove name="GlobalModule"/>
  <add name="GlobalModule" type="MyApp.Global.GlobalModule, EduCarePro" preCondition="managedHandler"/>
</modules>
</system.webServer> 
```

是否必须在 Web.Config 中配置其他内容以防止此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T10:06:01.737

这个问题的答案是 Visual Studio 的开发 web 服务器不支持这个功能。您必须在运行 IIS 的机器上运行此代码。

**取自（也为我工作，因为我有同样的问题）**

[关联](http://forums.asp.net/t/1816608.aspx/1)

# mfc - 在 64 位应用程序中使用 32 位 .lib 库

> ID：14310518
> 
> 赞同：2
> 
> 时间：2013-01-14T02:04:48.110
> 
> 标签：mfc, 32bit-64bit, libraries

我是一名初级程序员，我无法解决我现在遇到的问题。

在 MFC 中，我有一个`.lib`没有源的二进制文件。我需要制作一个使用上述库文件的 64 位应用程序。

我考虑过制作 32 位控制台程序并从另一个程序运行一个程序，例如使用 IPC `WM_COPY~`（或类似的东西），但`.lib`文件需要很多属性，如数组、结构、指针......

有没有更简单的方法可以在我的 64 位应用程序中使用该 32 位库？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:34:34.233

您没有其他选择；您无法在 64 位程序中加载 32 位程序集，因此您需要创建一个 32 位应用程序，您的 64 位应用程序可以以某种方式与之通信。进行 IPC 的方法有很多，因此请找到适合您的方法。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-14T02:46:44.267

嗯，很奇怪，你根本不能在家里的冰箱里放一只大大象，但你仍然可以在里面放一只大鸡。如果你不能用你的 32 位 lib 文件做类似的事情，请告诉我为什么你的任何 32 位应用程序仍然可以在 64 位系统中工作？（：D）那是什么类型的库？

# powershell - 强制等待/暂停，直到虚拟应用启动器实例关闭以继续 Powershell 脚本

> ID：14310519
> 
> 赞同：0
> 
> 时间：2013-01-14T02:04:56.563
> 
> 标签：powershell, powershell-2.0

我有一个 Powershell 脚本，它使用 VAppLauncher 程序在整个代码中启动 WinSCP 三次，以将文件从 Windows 移动到 Unix。

我想知道是否有**命令等待/暂停 Powershell 脚本，直到虚拟 WinSCP 控制台完成并且窗口关闭**。目前，代码只是通过这些步骤而不是等待它完成。

对应用程序的调用：

```
C:\Windows\SysWOW64\CCM\VAppLauncher.exe /launch "WinSCP 4.0.6.358" /console /script=$aScript /log=$aLog 
```

完整代码：

```
Try {
    C:\Windows\SysWOW64\CCM\VAppLauncher.exe /launch "WinSCP 4.0.6.358" /console /script=$aScript /log=$aLog
}
Catch [Exception] {
    Add-Content $tempLog "$a - System exception running $putScript:"
    Add-Content $tempLog $_.Exception.Message
}
Finally {
    Add-Content $tempLog "$a - WinSCP ran $putScript successfully"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T05:25:49.287

最简单的方法是将 WinSCP 的实例通过管道传输到 Out-Null，这将停止脚本直到 WinSCP 关闭。

```
Try 
{
    C:\Windows\SysWOW64\CCM\VAppLauncher.exe /launch "WinSCP 4.0.6.358" /console /script=$aScript /log=$aLog | Out-Null
}
Catch [Exception] 
{
    Add-Content $tempLog "$a - System exception running $putScript:"
    Add-Content $tempLog $_.Exception.Message
}
Finally 
{
    Add-Content $tempLog "$a - WinSCP ran $putScript successfully"
} 
```

注意`Out-Null`try 块末尾的 。如果您愿意，也可以使用后台作业。

# html - 如何清除绝对定位的元素？

> ID：14310520
> 
> 赞同：0
> 
> 时间：2013-01-14T02:05:25.307
> 
> 标签：html, css, less

[小提琴](http://jsfiddle.net/rUQ2z/)

![](../Images/d5bf3218e70a3baeeb9203c449670b1a.png)

标题出现在它上面的内容之上。

将 Twitter 添加`.clearfix`到容器中似乎并不能解决问题。我不知道如何将我的标题栏向下推到它上面的内容之下。

建议？

* * *

`.clearfix`参考（来自 Twitter Bootstrap）——写在`less`：

```
.clearfix {
  *zoom: 1;
  &:before,
  &:after {
    display: table;
    content: "";
    // Fixes Opera/contenteditable bug:
    // http://nicolasgallagher.com/micro-clearfix-hack/#comment-36952
    line-height: 0;
  }
  &:after {
    clear: both;
  }
} 
```

并使用如下：

```
.title-tabs {
  .clearfix;           /* HERE */
  border-bottom: 1px solid #91b6eb;
  position: relative;
  h3 {
    float: left;
    margin: 0;
    display: block;
    position: absolute;
    left: 0;
    bottom: 0;
  }
  /* etc... */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:17:30.977

这可能是您正在寻找的

[http://jsfiddle.net/rUQ2z/2/](http://jsfiddle.net/rUQ2z/2/)

```
 <div class="main-content">
  <div class="container">
    <div class="access-details">
      <div class="pull-left">
        <div>Logged in: <b>John Doe</b>
        </div>
        <div>Access Lvl: Noob</div>
      </div>
      <div class="pull-right">
        <div>Sunday, January 13th, 2013</div>
      </div>
    </div>
    <div class="title-tabs clearfix">
      <h3>Client Details</h3>
      <ul class="nav">
        <li class="active"><a href="#">Details</a>
        </li>
        <li><a href="#">Program</a>
        </li>
        <li><a href="#">Special</a>
        </li>
        <li><a href="#">Docs</a>
        </li>
        <li><a href="#">Notes</a>
        </li>
      </ul>
    </div>
    <p>Welcome to Client Details</p>
  </div>
</div>

h3 {
  font-size: 36px;
}
.clearfix {
  *zoom: 1;
  &:before, &:after {
    display: table;
    content:"";
    // Fixes Opera/contenteditable bug: // http://nicolasgallagher.com/micro-clearfix-hack/#comment-36952 line-height: 0;
  }
  &:after {
    clear: both;
  }
}
.title-tabs {
  .clearfix;
  border-bottom: 1px solid #91b6eb;
  position: relative;
  h3 {
    float: left;
    margin: 0;
    display: block;
    left: 0;
    bottom: 0;
  }
  ul {
    float: right;
    margin: 0;
    display: block;
    right: 0;
    bottom: 0;
    li {
      float: left;
      a {
        display: block;
        padding: 3px 5px;
        background-color: #f9fafe;
        .border-radius(5px, 0, 0, 5px);
        border-color: #91b6eb;
        border-width: 2px 2px 0 2px;
        border-style: solid;
        text-transform: uppercase;
        font-weight: bold;
      }
    }
    li + li {
      margin-left: -2px;
    }
  }
} 
```

不需要 position: absolute 在使用 float 的同一类上。您要么使用浮点数，要么使用相对/绝对位置。

您想将 clearfix 应用于包含浮动的容器，这将更新容器的高度，从而使 clearfix 下面的内容不会与上面的内容重叠。

**编辑**

如果您正在寻找处理动态内容的替代答案，您希望菜单项向右浮动并对齐底部，那么表格是一种方法。

看看下面的代码。我将容器设为表格，将标题选项卡设为标题行，并添加了 ul-container，以便可以将菜单项包含在表格单元格中。

[http://jsfiddle.net/rUQ2z/11/](http://jsfiddle.net/rUQ2z/11/)

```
<div class="main-content">
  <div class="container">
    <div class="access-details">
      <div class="pull-left">
        <div>Logged in: <b>John Doe</b>
        </div>
        <div>Access Lvl: Noob</div>
      </div>
      <div class="pull-right">
        <div>Sunday, January 13th, 2013</div>
      </div>
    </div>
    <div class="title-tabs">
      <h3>Client Details</h3>
      <div class="ul-container">
      <ul class="nav">
        <li class="active"><a href="#">Details</a>
        </li>
        <li><a href="#">Program</a>
        </li>
        <li><a href="#">Special</a>
        </li>
        <li><a href="#">Docs</a>
        </li>
        <li><a href="#">Notes</a>
        </li>
      </ul>
      </div>
    </div>
    <p>Welcome to Client Details</p>
  </div>
</div>

h3 {
  font-size: 36px;
}
.clearfix {
  *zoom: 1;
  &:before, &:after {
    display: table;
    content:"";
    // Fixes Opera/contenteditable bug: // http://nicolasgallagher.com/micro-clearfix-hack/#comment-36952 line-height: 0;
  }
  &:after {
    clear: both;
  }
}
.container {
  display: table;
  width: 100%;
}

.title-tabs {
  .clearfix;
  display: table-row;
  border-bottom: 1px solid #91b6eb;
  position: relative;
  h3 {
    margin: 0;
    vertical-align: bottom;
    display: table-cell;
    left: 0;
    bottom: 0;
  }
  .ul-container {
     display: table-cell;
    text-align: right;
    vertical-align: bottom;
  }

  ul {
    margin: 0;
    display: inline-block;
    right: 0;
    bottom: 0;
    li {
      float: left;
      a {
        display: block;
        padding: 3px 5px;
        background-color: #f9fafe;
        .border-radius(5px, 0, 0, 5px);
        border-color: #91b6eb;
        border-width: 2px 2px 0 2px;
        border-style: solid;
        text-transform: uppercase;
        font-weight: bold;
      }
    }
    li + li {
      margin-left: -2px;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T04:27:03.607

发生的事情是您的 .title-tabs 设置为相对，而 h3 设置为绝对和底部，因为您的 .title-tabs 没有高度，所以 h3 元素将占据最后一个底部并超出 .标题标签行。从 h3 css 中删除底部。

# django - 在 Django 中的模板之间传递数据？

> ID：14310522
> 
> 赞同：0
> 
> 时间：2013-01-14T02:05:38.390
> 
> 标签：django, django-forms, django-registration

我正在创建一个网站，它使用类似于 twitter 的注册方式，其中有一个预注册表格，可以引导另一个完整的注册表格。最初，我使用 POST 进行了尝试，它有效，但我意识到可以通过我不想要的代理查看第一个表单中的数据。

然后我在 Twitter 的网站上做了一个代理，他们使用 GET 而不是 POST。我在想也许我可以使用会话变量做一些事情，但不确定如何去做，或者我是否可以用 GET 来做。使用 django 执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:12:29.200

会话是一个很好的方法来做到这一点。在处理第一个表单时，将数据放入会话中，并在处理 get 时检索它。这是有关 Django 会话的文档：[https ://docs.djangoproject.com/en/1.4/topics/http/sessions/](https://docs.djangoproject.com/en/1.4/topics/http/sessions/)

# javascript - Javascript OnSubmit 不会更改表单的操作

> ID：14310532
> 
> 赞同：0
> 
> 时间：2013-01-14T02:07:43.427
> 
> 标签：javascript, html, javascript-events

编辑：已解决。我没有加引号！

我正在尝试根据使用 Javascript 的选择框中的值更新表单的操作。

到目前为止，我有：

```
<form name="newStudent" method="POST" onsubmit=newStudent.action = document.newStudent.proceed.value> 
```

并在我的代码中进一步向下：

```
<select name="proceed">
<option value="newSchedule.php">add student's schedule</option>
<option value="newStudent.php">add another student</option>
<option value="staff.php">staff page</option>; 
```

按下提交按钮时没有任何反应。我究竟做错了什么？当前页面是 newStudent.php，因此表单**应该**重定向到 newSchedule.php，因为它已被选中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T02:09:33.830

属性值包含空格，因此您需要将其括起来：

```
<form name="newStudent" method="POST" onsubmit="newStudent.action = document.newStudent.proceed.value"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:13:06.757

尝试这个：

```
<form name="newStudent" method="POST" onsubmit="this.action = document.newStudent.proceed.value"> 
```

# objective-c - 我找不到 -(IBAction) 的错误。它说有一个预期的表达

> ID：14310535
> 
> 赞同：-1
> 
> 时间：2013-01-14T02:08:08.247
> 
> 标签：objective-c, xcode, ibaction

```
 `-(IBAction)saveData
    {
        //get paths from root directory
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,        /*   */  NSUserDomainMask, YES);

//get documents path
        NSString *documentsPath = [paths objectAtIndex:0];

//get the path to our Data/plist file
    NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"Data.plist"];

//set the variables to the values in the text fields
        self.personName = nameEntered.text;
        self.phoneNumbers = [[NSMutableArray alloc] initWithCapacity:3];
        [phoneNumbers addObject:myPhone.text];
        [phoneNumbers addObject:momPhone.text];
        [phoneNumbers addObject:dadPhone.text];

        //create dictionary with values in UITextFields
        NSDictionary *plistDict = [NSDictionary dictionaryWithObjects: 
[NSArray arrayWithObjects: personName, phoneNumbers, nil] forKeys:
[NSArray arrayWithObjects: @"Name", @"Phones", nil]];

        NSString *error = nil;
        //create NSData from dictionary
        NSData *plistData = [NSPropertyListSerialization dataFromPropertyList: plistDict             /* */   format: NSPropertyListXMLFormat_v1_0 errorDescription: &error];

    //check if plist data exists
    if (plistData)
    {
        //write plistData to our Data.plist file
        [plistData writeToFile:plistPath atomically: YES];            
    }
    else
    {
        NSLog(@"Error in saveData: %@", error);
        [error release];
    }
}` 
```

我找不到 -(IBAction) 的错误。它说有一个预期的表达。任何帮助将不胜感激！我是编码新手，所以我不太了解。

我修好了，谢谢大家的帮助。这是我犯的一个大菜鸟错误......我把我的行动放在 viewdidload 中:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:24:03.033

这：

```
 [plistData writeToFile:plistPath automatically: YES]; 
```

应该是这样的：

```
 [plistData writeToFile:plistPath atomically: YES]; 
```

（请注意，这不会给您“预期表达式”错误，您应该看到“NSData 没有接口声明选择器...”类型错误...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:29:01.627

对于初学者，方法名称不正确
错误：

```
[plistData writetoFile:plistPath automatically: YES]; 
```

正确的：

```
[plistData writeToFile:plistPath atomically:YES]; 
```

来自苹果文档：

```
- (BOOL)writeToFile:(NSString *)path atomically:(BOOL)flag 
```

# java - 动态加载代码的安全管理

> ID：14310539
> 
> 赞同：0
> 
> 时间：2013-01-14T02:09:11.833
> 
> 标签：java, security, class, dynamic, securitymanager

我目前正在开发支持动态加载类的客户端/服务器应用程序。

这些类是不能访问某些方法的插件。

我的第一个想法是一个 SecurityManager，它检查堆栈跟踪中的类名，但这似乎不是解决这个问题的理想方法。

如何将这种限制应用于特定类别？

是否有（可实现的）方法从类文件内容中读取每个引用的类？

# c++ - 垃圾内存？

> ID：14310543
> 
> 赞同：2
> 
> 时间：2013-01-14T02:09:43.110
> 
> 标签：c++, pointers, garbage-collection

我刚刚浏览了一篇解释 Wild 指针的文章。对于垃圾内存，它表示当一个指向内存对象的指针丢失时，即表示该内存项继续退出，但指向它的指针丢失了；当内存没有明确释放时会发生这种情况。我试图通过一个例子来理解这一点。这是我写的

```
#include <iostream>

using namespace std;
int q =12;
int point()
{
   int *p;
   p = &q;
   //delete p;
}
int main()
{
   point();
   return 0;
} 
```

因此，在上面的示例中，内存项 (q) 继续存在，但指向它的指针丢失了。我可能完全误解了它，但如果我理解正确，那么这个例子是否解决了上面给出的“垃圾内存”定义？如果是，那么我应该使用 delete p，对吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-14T02:11:28.267

C ++没有您理解的垃圾收集方式。但是您所展示的**不是“内存泄漏”**，这就是我认为您的意思。

在这种情况下，您指向的内存位置**不是动态分配**的，并且在程序运行期间可以从函数外部访问。

* * *

```
int point()
{
   int *p = new int();
   //delete p;
} 
```

这现在是**内存泄漏**，因为内存仍然被分配，但没有人可以再访问它了。如果这是 Java 或任何其他支持 GC 的语言，则该**内存现在将排队等待垃圾收集**。

* * *

C++中***推荐的风格***是尽可能使用称为**[资源获取即初始化 (RAII)](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)****的概念使所有分配的内存自动释放**，使用如下**智能指针**。

 **```
int point()
{
   std::unique_ptr<int> p(new int());
   //delete p;  // not needed.
} 
```

当变量 p 被销毁时，在其作用域结束时，它将自动调用`delete`分配的内存，因此您不必这样做。通过让东西自己清理，我们启用了以下功能。

> C++ 是我最喜欢的垃圾收集语言，因为它产生的垃圾很少
> 
> > Bjarne Stroustrup 的常见问题解答：你真的这么说吗？检索于 2007 年 11 月 15 日。 [http://en.wikiquote.org/wiki/Bjarne_Stroustrup](http://en.wikiquote.org/wiki/Bjarne_Stroustrup)**

# android - Box2D distanceJoint 在 AndEngine 中不保持形状

> ID：14310544
> 
> 赞同：1
> 
> 时间：2013-01-14T02:10:01.193
> 
> 标签：android, box2d, andengine

我正在使用 Box2D distanceJoint 和 AndEngine 来保持形状。但是形状没有保持，碎片只是掉到了地板上。它应该保持圆形/椭圆形。你能告诉我我做错了什么吗？在这里，我与邻居保持距离。我应该与其他成员保持距离吗？

```
 for (int i=1; i<nBodies; ++i) {
        FIXTURE_DEF = PhysicsFactory.createFixtureDef(25f, 0.0f, 1f);

        float angle = map(i, 0, nBodies, 0, 2*3.1415f);
        float x = cx + rx * (float)Math.sin(angle);
        float y = cy + ry * (float)Math.cos(angle);
        // Add plate    
        float x1 = (x + 10) * 30;
        float y1 = y * 20;
        centers[i][0] = x1;
        centers[i][1] = y1;

          Vector2 v1 = new Vector2(x1,y1);

          circle = new AnimatedSprite(x1, y1, this.mCircleFaceTextureRegion, this.getVertexBufferObjectManager());
          circleBody[i] = PhysicsFactory.createCircleBody(this.mPhysicsWorld, circle, BodyType.DynamicBody, FIXTURE_DEF);
          this.mPhysicsWorld.registerPhysicsConnector(new PhysicsConnector(circle, circleBody[i], true, true));

          this.mScene.attachChild(circle);

    }

    for(int i= 1;i < nBodies -1; i++)  {

        Vector2 v1 = new Vector2(centers[i][0]/PIXEL_TO_METER_RATIO_DEFAULT,centers[i][1]/PIXEL_TO_METER_RATIO_DEFAULT);
        Vector2 v2 = new Vector2(centers[i+1][0]/PIXEL_TO_METER_RATIO_DEFAULT,centers[i+1][1]/PIXEL_TO_METER_RATIO_DEFAULT);
        Log.d("Vals","vals x:" + centers[i][0] + "y:" + centers[i][1] + "x:" +centers[i+1][0] + "y:" + centers[i+1%19][1]);
        int j = i+1;
        Log.d("i","i" + i + "   " + j);
        distanceJoint.initialize(circleBody[i], circleBody[(i+1)], v1, v2);
        distanceJoint.collideConnected = true;
        distanceJoint.dampingRatio = 10.0f;
        distanceJoint.frequencyHz = 1.0f;
        this.mPhysicsWorld.createJoint(distanceJoint);
    }

    Vector2 v1 = new Vector2(centers[1][0]/PIXEL_TO_METER_RATIO_DEFAULT,centers[1][1]/PIXEL_TO_METER_RATIO_DEFAULT);
    Vector2 v2 = new Vector2(centers[19][0]/PIXEL_TO_METER_RATIO_DEFAULT,centers[19][1]/PIXEL_TO_METER_RATIO_DEFAULT);
    distanceJoint.initialize(circleBody[1], circleBody[19], v1, v2);
    distanceJoint.collideConnected = true;
    distanceJoint.dampingRatio = 10.0f;
    distanceJoint.frequencyHz = 1.0f;
    this.mPhysicsWorld.createJoint(distanceJoint); 
```

我错过了什么吗？请让我知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:34:14.117

我想我已经通过保持每个身体之间的距离关节来解决它。我试图在[http://www.jbox2d.org/](http://www.jbox2d.org/)中重新创建 Blob 演示。这个演示使用了一个 ConstantVolumeJoint。我已经能够通过每个身体之间的距离关节重新创建它，如下所示

```
 for(int i= 0;i < nBodies-1; i++)  {

       for(int j=i+1; j< nBodies ; j++){
           Vector2 v1 = new Vector2(centers[i][0]/PIXEL_TO_METER_RATIO_DEFAULT,centers[i][1]/PIXEL_TO_METER_RATIO_DEFAULT);
           Vector2 v2 = new Vector2(centers[j][0]/PIXEL_TO_METER_RATIO_DEFAULT,centers[j][1]/PIXEL_TO_METER_RATIO_DEFAULT);
           Log.d("Vals","vals x:" + centers[i][0] + "y:" + centers[i][1] + "x:" +centers[j][0] + "y:" + centers[j][1]);

           Log.d("i","i:" + i + " j:" + j);
           distanceJoint.initialize(circleBody[i], circleBody[(j)], v1, v2);

           distanceJoint.collideConnected = true;
           distanceJoint.dampingRatio = 10.0f;
           distanceJoint.frequencyHz = 0.5f;
           this.mPhysicsWorld.createJoint(distanceJoint);
       }
    } 
```

我现在需要在身体之间建立一条连接线。否则，斑点确实会从掉落在其上的物体反弹。

请让我知道如何在整个形状移动时保持连接的相邻物体之间画一条连接线？

# python - BeautifulSoup 只返回 head 标签内的内容

> ID：14310550
> 
> 赞同：4
> 
> 时间：2013-01-14T02:10:47.867
> 
> 标签：python, url, web-crawler, beautifulsoup

我正在与 BeautifulSoup 合作，我发现了一个错误或错误。在我的示例中，我抓取了纽约时报的一个子版块网站......

```
import urllib2
from bs4 import BeautifulSoup
website = "http://www.nytimes.com/pages/politics/index.html"
data = BeautifulSoup(urllib2.urlopen(website).read())
print data 
```

当我运行代码时，我会返回 head 标签及其里面的内容。但是，它不会抓取正文标签内的内容。如果我将网站 url 更改为`http://www.nytimes.com`然后 BS 返回完整页面源。这是怎么回事，为什么我爬的时候没有得到身体标签`http://www.nytimes.com/pages/politics/index.html`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T07:29:53.027

这不是 BeautifulSoup 中的错误。问题实际上在于 bs4 使用内置的 HTMLParser，它对格式错误的 HTML 不是很宽容，并且[W3C 标记验证服务](http://tinyurl.com/azgex7z)显示 HTML 确实格式错误，并且几乎没有未封闭、杂散和放错位置的 TAGS 导致 HTMLParser 和随后的 BeautifulSoup 停止突然解析。

此问题已在针对 BeautifulSoup 提交的以下错误中进行了解释

[BS4 在格式错误的标签后停止解析](https://bugs.launchpad.net/beautifulsoup/+bug/972524)

# freebase - 在 freebase 中获取 wiki 摘要

> ID：14310558
> 
> 赞同：1
> 
> 时间：2013-01-14T02:12:10.880
> 
> 标签：freebase

这是一个电视节目查询。如何获得提取 wiki 摘要的请求？

```
[{
  "id" : "/m/0d68qy",
  "name": null
}]​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:49:25.260

主题摘要通过 /common/topic/article 属性链接到一个主题。[您可以使用新的Topic API](https://developers.google.com/freebase/v1/topic-overview)在一个 API 调用中检索此数据，如下所示：

[https://www.googleapis.com/freebase/v1/topic/m/0d68qy?filter=/common/topic/article](https://www.googleapis.com/freebase/v1/topic/m/0d68qy?filter=/common/topic/article)

# ember.js - 如何使用 mailto href 和 bindAttr 创建一个“a”标签到属性？

> ID：14310559
> 
> 赞同：8
> 
> 时间：2013-01-14T02:12:18.380
> 
> 标签：ember.js, handlebars.js

我有一个模型，具有属性“contact_email”。我想用 mailto: href 创建一个链接。

我已经尝试过稍微明显`<a {{bindAttr href="contact_email"}}>Email</a>`的操作，但当然这没有 mailto: 位。

如何将 mailto: 与属性 contact_email 结合使用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-14T07:46:24.930

目前，唯一可行的方法是使用计算属性（如您在评论中所述）。

如果您发现自己经常这样做，可能会使这更容易忍受的一件事是创建一个计算属性“宏”：

```
App.computed.mailto = function(property) {
  return function() {
    return "mailto:" + this.get(property);
  }.property(property);
}; 
```

然后你可以在你的控制器中这样做：

```
var mailto = App.computed.mailto;

App.UserController = Ember.ObjectController.extend({
  mailtoContactEmail: mailto('contactEmail')
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-05T15:28:51.880

注册一个简单的有界 Ember Handlebars 助手 ( `Em.Handlebars.registerBoundHelper`)

```
Em.Handlebars.registerBoundHelper('mailTo', function (emailAddress, label) {
    emailAddress = Em.Handlebars.Utils.escapeExpression(emailAddress);
    label = (arguments.length == 2) ? emailAddress : Em.Handlebars.Utils.escapeExpression(label);

    var link = '<a href="mailto:' + emailAddress + '">' + label + '</a>';
    return new Em.Handlebars.SafeString(link);
}); 
```

并像这样使用它：

```
simple mailto link:
{{mailTo emailAddress}} 
(output: <a href="mailto:foobar@example.com">foobar@example.com</a>)

mailto link with alternate label
{{mailTo emailAddress username}}
(output: <a href="mailto:foobar@example.com">foobar</a>) 
```

使用的型号：

```
App.User = DS.Model.extend({
    username: DS.attr('string'),
    emailAddress: DS.attr('string')
}); 
```

这两个值（电子邮件地址以及可选的备用标签）都绑定到模型，并且会在模型更改时更改。

创建了一个 JSFiddle 来演示不断变化的模型：http: [//jsfiddle.net/We6B9/](http://jsfiddle.net/We6B9/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-23T06:23:35.733

在最新版本的[ember cli](http://iamstef.net/ember-cli/)中，您可以这样做：

在您看来：

```
export default Ember.View.extend({
    layoutName: 'layouts/legal',
    templateName: 'views/legal/tou',
    tagName: 'main',
    classNames: 'view-legal-wrapper',
    varViewTitle: 'Terms and Conditions',
    varCompanySupportEmail: 'test@gmail.com'
}); 
```

在您的车把模板中：

```
<a href="mailto:{{unbound view.varCompanySupportEmail}}?subject=Support%20Request">{{view.varCompanySupportEmail}}</a> 
```

发这篇文章时的当前设置：

```
DEBUG: ------------------------------- 
DEBUG: Ember      : 1.5.1 
DEBUG: Ember Data : 1.0.0-beta.7+canary.b45e23ba 
DEBUG: Handlebars : 1.3.0 
DEBUG: jQuery     : 2.1.1 
DEBUG: ------------------------------- 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T11:08:56.337

对于所有此类用例，使用 Handlebar Helper 可以是解决问题的通用解决方案

检查小提琴[http://jsfiddle.net/devilankur18/YgLRb/1/](http://jsfiddle.net/devilankur18/YgLRb/1/)

```
 var getBindingValue = function(context, options, path) {

  var normalized = Ember.Handlebars.normalizePath(null, path, options.data),
      thisContext;

  if (normalized.isKeyword) {
    thisContext = normalized.root;
  } else if (!Ember.isGlobalPath(path)) {
    thisContext = context;
  } else {
    thisContext = null;
  }

  return Em.Handlebars.get(thisContext, normalized.path);

};

Handlebars.registerHelper('mail_to', function(context, options) {
      var value = getBindingValue(this, options, context);

          return 'href=mailto:' + value 

});

var App = Ember.Application.create();
App.ApplicationController = Ember.Controller.extend({ email: "test@somthing.com" });

App.Router = Ember.Router.extend({
  enableLogging: true,
  root: Ember.Route.extend({
    index: Ember.Route.extend({
      route: '/'
    })
  })
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-22T10:56:10.910

我只是设法使用标志做到这一点，如下所示：

```
a href="mailto:{{unbound email}}" Email 
```

这意味着您应该能够执行以下操作：

```
<a href="mailto:{{unbound email}}">Email</a> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-20T22:30:43.287

试试`concat`帮手：

`<a href={{concat "mailto:" model.emailAddress}}>{{model.emailAddress}}</a>`

# python - 在线程中调用 map_async 不起作用

> ID：14310560
> 
> 赞同：0
> 
> 时间：2013-01-14T02:12:26.560
> 
> 标签：python, multiprocessing

在python中使用多处理池这就是我想要做的：

```
def do_task(data):
   print "Executing: " + data
   return data

def do_something(data):
   print "Starting do_something"
   result2 = pool.map_async(do_task, ["AA","BB"])  
   print "before get"
   result2.get()
   print "after get"
   return data

def main():
    pool = Pool(processes=4)             
    result = pool.apply_async(do_something, "A")  
    print result.get() 
```

但它在这里的输出不起作用：

```
Starting do_something
before get 
```

它停留在这里并且 do_task 永远不会被调用。有人能解释一下为什么吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T09:55:06.663

是错字吗？不应该是 result2.get()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T10:44:22.717

@Johny19该代码（通过删除papachino指出的错字很好，我认为您在代码中的某个地方忘记了或在错误的时间调用了 .close() 属性...

# windows-store-apps - 如何在 WinJS 中触发事件（相当于 jQuery 中的 .trigger("")）

> ID：14310566
> 
> 赞同：1
> 
> 时间：2013-01-14T02:13:33.427
> 
> 标签：windows-store-apps, winjs

我想知道如何从代码中触发事件。在 jQuery 中触发“onchange”事件你只需 $("selector").trigger("change")。有没有办法使用 WinJS 做同样的事情。

[所有包含 jQuery 的建议都将被丢弃]

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:52:26.213

[`fireEvent`](http://msdn.microsoft.com/en-us/library/ie/ms536423%28v=vs.85%29.aspx)可能是你想要的。

> 在对象上触发指定事件。

鉴于该标记

```
<p>
    <button 
        id="oButton" 
        onclick="this.innerText='I have been clicked!'">Button
    </button>
</p> 
```

你可以做

```
oButton.fireEvent("onclick"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-15T14:28:08.630

要触发和响应自定义事件，请执行此操作。

触发事件

```
WinJS.Application.queueEvent({type: 'ev_login_completed'}) 
```

响应自定义事件

```
WinJS.Application.addEventListener('ev_login_completed', function (e) {
             // do stuff  }) 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T16:31:14.630

您可以使用`event.initUIEvent`：

```
var button = document.getElementById('button');
var еvent = document.createEvent("UIEvents");
еvent .initUIEvent("click", false, false, window, 1);
button.dispatchEvent(еvent ); 
```

更多信息可以在[这里找到](https://developer.mozilla.org/en-US/docs/DOM/event.initUIEvent)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T14:44:37.927

在您的准备功能中：

```
WinJS.Utilities.query("#yourSelector").listen("change", this.customClicked, false) 
```

然后定义customClicked函数（可以命名任何东西）

```
customClicked: function(eventInfo){
   <!--do stuff -->
} 
```

# php - 将对象实例化为具有命名空间的类

> ID：14310568
> 
> 赞同：2
> 
> 时间：2013-01-14T02:14:34.597
> 
> 标签：php, class, namespaces, instance

我不知道如何解释，但我会尽力而为。好的，我有这三个文件：

*   主题.php

    ```
    path: /shared/models/Theme.php
    class: Theme
    namespace: namespace models; 
    ```

*   自定义.php

    ```
    path: /themes/default/Custom.php
    class: Custom
    namespace: this class does not use namespace 
    ```

*   设置.php

    ```
    path: /controllers/Settings.php
    class: Settings
    namespace: this class does not use namespace 
    ```

在我`Settings.php`看来：

```
<?php
class Settings
{
    public function apply()
    {
        $theme = new \models\Theme();
        $theme->customize(); // in this method the error is triggered
    }
} 
```

现在，看`Theme`下面的类：

```
<?php
namespace models;

class Theme
{
    public function customize()
    {
        $ext = "/themes/default/Custom.php";
        if (file_exists($ext))
        {
            include $ext;
            if (class_exists('Custom'))
            {            
                $custom = new Custom(); 
                //Here, $custom var in null, why???
            }
        }
    }
} 
```

当我执行代码时，我收到以下错误：

```
Message: require(/shared/models/Custom.php) [function.require]: failed to open stream: No such file or directory
Line Number: 64 
```

为什么解释器试图`Custom`从另一个目录加载类而不是用`$ext`var 指定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:35:57.353

`new Custom()`在命名空间中的类内部调用时，`\models`您实际上是在尝试实例化`\models\Custom`. 既然你说你的`Custom`班级“没有命名空间”，那就试试吧`new \Custom()`。

您得到的错误似乎来自一些试图要求类文件`\models\Custom`并失败的类自动加载器。

# php - 如果三个字段都为“是”，则 SQL 隐藏结果

> ID：14310571
> 
> 赞同：1
> 
> 时间：2013-01-14T02:15:39.297
> 
> 标签：php, mysql

我有一个带有 4 个字段的 MySQL 数据库：

```
id | planchanged | dataremoved | rolloverenabled |
1  | Yes         | Yes         | Yes             |
2  | NULL        |             |                 |
3  |             | Yes         |                 |
4  | Yes         |             | Yes             |
5  |             |             | NULL            | 
```

如何查询此数据库以仅显示在这三个字段上没有全部“是”的记录。还请考虑到某些字段可能是*Null*。因此，基于该示例，我的结果应显示记录 2、3、4 和 5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T02:21:48.043

你可以这样做

```
SELECT * FROM TableName 
WHERE coalesce(planchanged,'-') <> 'Yes' OR 
coalesce(dataremoved,'-') <> 'Yes' OR
coalesce(rolloverenabled,'-') <>'Yes' 
```

SQL[小提琴演示](http://sqlfiddle.com/#!2/4fb95/3)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-14T02:27:37.777

```
SELECT * 
FROM yourTableName 
WHERE planchanged IS NULL OR planchanged <> 'Yes' 
OR dataremoved IS NULL OR dataremoved <> 'Yes' 
OR rolloverenabled IS NULL OR rolloverenabled <> 'Yes' 
```

[SQL小提琴](http://www.sqlfiddle.com/#!2/2fdf4/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T02:20:12.383

```
SELECT * 
FROM  yourTableName 
WHERE planchanged IS NULL 
  OR  dataremoved IS NULL 
  OR  rolloverenabled IS NULL 
  OR  planchanged <> 'Yes' 
  OR  dataremoved <> 'Yes' 
  OR  rolloverenabled <> 'Yes' 
```

# c++ - 在 C++ 中使用抽象库

> ID：14310574
> 
> 赞同：0
> 
> 时间：2013-01-14T02:16:33.087
> 
> 标签：c++, cmake, abstract-class

我有一个抽象的库，基本上看起来像这样：

啊

```
namespace N {
    class A
} 
```

溴化氢

```
#pragma once
#ifndef B
#define B
#include "A.h" 
namespace N {
    class B: Public A
}
#endif 
```

该库在 CMakelists.txt 中被引用，如下所示：

```
global_add_library(libN A.cpp B.cpp)
target_link_libraries(libN someLibraries) 
```

现在我有一个`main`看起来像这样的文件：

```
#include <libN/A.h>
#include <libN/B.h>

N::A a* = new A();
N::B b* = new B(); 
```

它`CMakelists.txt`看起来像这样：

```
global_add_exectubale(application somemainccpfiles.cpp)
target_link_libraries(application libN) 
```

我得到的是一个错误说

```
error: ISO C++ forbids deceleration of 'B' with no type. 
```

所以我认为 Bh 文件没有正确包含？但是为什么减速的时候`A`就好了？

有任何想法吗？

编辑：所以我发现了最初的问题是什么，`pragma once`以及它的组合`ifndef`意味着它没有正确编译。当我在修复后删除了编译指示。但现在的问题是为什么会这样？它不应该对两者都有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T02:26:37.293

```
#include "A.h" 
namespace N {
    class B: Public A
} 
```

您包含的“Ah”，但在其他文件中是“libN/Ah”

# python - 尝试在 Python 中构建 OrderedDict 对象以最终通过 simplejson 转换为 JSON

> ID：14310579
> 
> 赞同：0
> 
> 时间：2013-01-14T02:17:41.053
> 
> 标签：python, json, list, dictionary, ordereddictionary

输入将类似于：

```
List1 - a python list of any size of conditions to be ANDed
List2 - a python list of any size of conditions to be ORed 
```

最终，我想生成如下所示的 JSON 输出：

> {“view”：{“ANDS”：[ {“status”：“status_field”，“operator”：“operator_field”，“value”：“value_field}，...]，“ORS”：[{“status” : "status_field", "operator": "operator_field", "value": "value_field}, ... ]}}

我的计划是利用[simplejson](https://github.com/simplejson/simplejson)库最终编写如下内容：

```
import simplejson as json
json.dumps(OrderedDictObject) 
```

我理解应该处理转换。

我的问题，没有很多使用 OrderedDict 对象的经验，是如何编写一个函数来构建这样一个对象，经过解析`List1`并`List2`生成要传递给的对象`json.dumps()`

这里有什么最佳实践吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:45:00.303

如果您有两个 Python 列表：

> List1 - 要进行与运算的任意大小条件的 Python 列表 List2 - 要进行或运算的任意大小条件的 Python 列表

然后你可以做这样的事情：

```
mydict = { 'views': { 'ANDS': List1, 'ORS': List2 } } 
```

您会注意到它与您发布的 JSON 示例的结构完全一致。鉴于：

```
List1 = [ { "status": "status_field", "operator": "operator_field", "value": "value_field"} ]
List2 = [ { "status": "status_field", "operator": "operator_field", "value": "value_field"} ] 
```

这将为您提供如下 JSON 输出：

```
>>> import json
>>> print json.dumps(mydict, indent=True)
{
 "views": {
  "ORS": [
   {
    "status": "status_field", 
    "operator": "operator_field", 
    "value": "value_field"
   }
  ], 
  "ANDS": [
   {
    "status": "status_field", 
    "operator": "operator_field", 
    "value": "value_field"
   }
  ]
 }
} 
```