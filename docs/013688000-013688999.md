# StackOverflow 问答 13688000-13688999

# java - 运行 Boggle Solver 需要一个多小时才能运行。我的代码有什么问题？

> ID：13688000
> 
> 赞同：0
> 
> 时间：2012-12-03T16:54:59.373
> 
> 标签：java, performance, solver, boggle

所以我在 NetBeans IDE 上用 java 运行 Boggle Solver。当我运行它时，我必须在 10 分钟左右后退出，因为它最终需要大约 2 小时才能完全运行。我的代码是否有问题，或者一种方法会更快？

```
public void findWords(String word, int iLoc, int jLoc, ArrayList<JLabel> labelsUsed){

    if(iLoc < 0 || iLoc >= 4 || jLoc < 0 || jLoc >= 4){
        return;
    }

    if(labelsUsed.contains(jLabels[iLoc][jLoc])){
        return;
    }

    word += jLabels[iLoc][jLoc].getText();
    labelsUsed.add(jLabels[iLoc][jLoc]);

    if(word.length() >= 3 && wordsPossible.contains(word)){
        wordsMade.add(word);
    }

    findWords(word, iLoc-1, jLoc, labelsUsed);
    findWords(word, iLoc+1, jLoc, labelsUsed);
    findWords(word, iLoc, jLoc-1, labelsUsed);
    findWords(word, iLoc, jLoc+1, labelsUsed);
    findWords(word, iLoc-1, jLoc+1, labelsUsed);
    findWords(word, iLoc-1, jLoc-1, labelsUsed);
    findWords(word, iLoc+1, jLoc-1, labelsUsed);
    findWords(word, iLoc+1, jLoc+1, labelsUsed);

    labelsUsed.remove(jLabels[iLoc][jLoc]);
} 
```

这是我从以下位置调用此方法的地方：

```
public void findWords(){
    ArrayList <JLabel> labelsUsed = new ArrayList<JLabel>();
    for(int i=0; i<jLabels.length; i++){
        for(int j=0; j<jLabels[i].length; j++){
            findWords(jLabels[i][j].getText(), i, j, labelsUsed);
            //System.out.println("Done");
        }
    }
} 
```

编辑：顺便说一句，我使用的是 GUI，板上的字母是使用 JLabel 显示的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T16:57:01.457

好吧，对于初学者来说，你运行`ArrayList.contains()`( `labelsUsed.contains(..)`) 很多次，每次都是`O(n)`- 你应该考虑使用更有效的数据结构 -[`Set`](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html)如果可能的话（没有重复元素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:02:30.200

您正在混合迭代和递归方法，因此该`findWords`方法被称为时间而不是*时间* 。`n^n``n`

要么删除该方法的八`findWords...`行，要么删除你的.`findWords``for``main`

# extjs - tabIndex 如何为 ExtJS 字段工作（确认）？

> ID：13688002
> 
> 赞同：2
> 
> 时间：2012-12-03T16:55:10.123
> 
> 标签：extjs, tabindex

我一直对 ExtJS 的 Ext.form.field.Base 的 tabIndex 配置感到困惑（换句话说，通用字段）。我在文档中没有找到太多信息（但也许我看错了地方），所以我反复试验，这就是我现在的理解方式。

*   使用严格大于 0 的整数值显式设置 tabIndex 的字段按 tabIndex 升序排序。如果多个字段已设置为相同的 tabIndex 值，则它们按创建顺序排列：创建的第一个字段在前，依此类推。
*   tabIndex 显式设置为 0 的字段，或 tabIndex 未显式设置的字段，下一个，通过创建具有相同的子顺序。
*   使用严格小于 0 的整数值显式设置 tabIndex 的字段是乱序的：您无法使用 Tab 访问它们。

（我承认我没有尝试使用非整数值设置 tabIndex。）

有人可以确认这是它的工作方式，或者更好的是，请指出上面的错误或遗漏？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T08:25:46.707

sencha 的好人已经证实了这一点：[http ://www.sencha.com/forum/showthread.php?250586-Can-someone-please-confirm-tabIndex-behavior-with-Ext.form.field.Base&p=918558 #post918558](http://www.sencha.com/forum/showthread.php?250586-Can-someone-please-confirm-tabIndex-behavior-with-Ext.form.field.Base&p=918558#post918558)

他们还指出，在 HTML 中也是如此，这是完全正确的，但我对此一无所知。傻我。好吧，我希望其他人会发现这很有用。

# functional-programming - 这个 OCaml 函数组合运算符定义/表达式是否正确？

> ID：13688004
> 
> 赞同：4
> 
> 时间：2012-12-03T16:55:21.650
> 
> 标签：functional-programming, ocaml, function-composition

```
let (++) f g x = f (g x) in
    let f x = x + 1 in
    let g x = x * 2 in
    (f++g) 1;; 
```

1.  **上面的表述正确吗？**
2.  在我看来，上面的代码应该就像定义`f++g x = 2 * x + 1`. 我对么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:38:48.437

您对函数组合的实现是正确的，因为：

> (g ∘ f)(x) = g(f(x)) 对于 X 中的所有 x

根据[维基百科](http://en.wikipedia.org/wiki/Function_composition)

我得到：

```
- : int = 3 
```

在 ocamlktop

# jquery - JQuery Mobile 持久页脚在内部页面上重复

> ID：13688018
> 
> 赞同：1
> 
> 时间：2012-12-03T16:56:11.663
> 
> 标签：jquery, mobile, footer, persistent

我正在建立一个虚拟博物馆，用户可以通过使用位于持久页脚中的两个按钮（data-position="fixed"、data-fullscreen="true" 和所有页面上的相同 data-id）来逐步浏览房间（页面） . 我希望页脚在过渡期间保持固定，这似乎运行良好。但是，当我在页面中来回导航时，有时页脚似乎重复了。当我降低页脚不透明度时，它变得很明显。奇怪的是，这些重复项在 DOM 中的 data-role="page" 元素之外一个接一个地排列。

我找到了这个链接 [http://forum.jquery.com/topic/jquery-mobile-footer-multiplying-on-internal-pages](http://forum.jquery.com/topic/jquery-mobile-footer-multiplying-on-internal-pages)

但没有找到一种方法来选择多个页脚并将它们分配给 class="ui-footer-duplicate"

也许我应该补充一点，我对所有房间都使用相同的文件，并且我会动态更改内容和按钮上的链接。

有谁知道这里的问题是什么？

谢谢你的帮助！

# dojo - Dojo：在 BorderContainer 内不可见区域“顶部”中的 TabContainer

> ID：13688019
> 
> 赞同：0
> 
> 时间：2012-12-03T16:56:13.503
> 
> 标签：dojo, dijit.layout

我想将 a`TabContainer`放在 a 的顶部区域内，`BorderContainer`如下所示：

```
<div id="appLayout" data-dojo-type="dijit/layout/BorderContainer">
    <div data-dojo-type="dijit/layout/TabContainer" data-dojo-props="region: 'top'">
        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="title:'Tab 1'">tab 1</div>
        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="title:'Tab 2'">tab 2</div>
    </div>
    <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region: 'center'">center</div>
</div>​ 
```

当我尝试这个时，它`TabContainer`是不可见的。`TabContainer`当我将 放置在 的中心区域时，一切正常`BorderContainer`：

```
<div id="appLayout" data-dojo-type="dijit/layout/BorderContainer">
    <div data-dojo-type="dijit/layout/TabContainer" data-dojo-props="region: 'center'">
        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="title:'Tab 1'">tab 1</div>
        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="title:'Tab 2'">tab 2</div>
    </div>
    <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region: 'bottom'">bottom</div>
</div>​ 
```

为什么`TabContainer`顶部区域不可见？我可以让它可见吗？

编辑： 的内容`TabContainer`具有可变高度，所以我不想手动设置高度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:27:17.047

设置 TabContainer div 的高度 css 属性，例如：

```
<div data-dojo-type="dijit/layout/TabContainer" data-dojo-props="region: 'top'" style="height: 100px;">
    ...
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-07T14:58:27.240

尝试调整根 BorderContainer 的大小。

它看起来像一些黑客，但它适用于我：

```
<div data-dojo-type="dijit.layout.BorderContainer" data-dojo-attach-point="rootContainerWidget">
   <!-- content panes, tab containers etc -->
</div> 
```

并在小部件代码中添加公共**调整大小**方法：

```
resize: function () {
    // resize hack
    this.rootContainerWidget.resize();
} 
```

# jquery - 单击锚点jQuery Cycle时导航到滑动

> ID：13688020
> 
> 赞同：0
> 
> 时间：2012-12-03T16:56:15.087
> 
> 标签：jquery, jquery-cycle

我正在使用 jQuery 循环在单个页面站点上的 div 之间滚动。

里面的每个 div`slides` `div`都有一个`id`我希望使用哈希从`nav`. 位于`nav`循环所连接的 div 之外。

标记看起来像这样；

```
<nav>    
    <ul>
            <li>Our challenges
                <ul>
                    <li><a href="#explore">Government Current &amp; Emerging Policy</a></li>
                    <li><a href="#industry">Industry Challenges</a></li>
                    <li><a href="#bis">BIS Objectives</a></li>
                    <li><a href="#activities">Activities</a></li>
                </ul>
            </li>
        </ul>
</nav>

<div class="slides">
    //divs with id's for navigation
</div 
```

如果我点击行业锚点，什么都不会发生，所以我想知道循环选项中是否有任何东西可以用来连接到我的导航块？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T11:55:25.280

使用这个[http://jquery.malsup.com/cycle/pager6.html](http://jquery.malsup.com/cycle/pager6.html)作为指导和编辑 pagerAnchorBuilder 函数以匹配我的标记已经给了我我需要的东西。

# vim - 加括号的原因是什么 地图名称？

> ID：13688022
> 
> 赞同：18
> 
> 时间：2012-12-03T16:56:24.133
> 
> 标签：vim, vim-plugin

许多插件使他们的公共地图界面可以通过[`<Plug>`](http://vimdoc.sourceforge.net/htmldoc/usr_41.html#using-%3CPlug%3E)地图访问。然后，用户可以将这些映射用作他们自己映射的挂钩，例如`:nmap <Leader>fu <Plug>fooPluginUnlinkRootDir`.

最近我遇到了一些将地图名称放在括号中的插件，例如

*   `<Plug>(textobj-indent-a)`在[textobj-indent](https://github.com/kana/vim-textobj-indent)插件中，
*   `<Plug>(LineJugglerBlankUp)`在[LineJuggler](http://www.vim.org/scripts/script.php?script_id=4140)插件中。

这个语法没有记录在帮助文件的任何地方，也没有任何捆绑的 Vim 运行时文件使用它。尽管如此，这些插件还是可以很好地完成它们的工作。

括号的动机是什么？使用它们有什么好处吗？是否应该鼓励插件作者遵循这种做法（作为最佳做法）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-04T08:10:31.437

谢谢ZyX；您的回答已经涵盖了基础知识，所以让我补充一下我采用该`<Plug>(PluginNameAndMore)`符号的原因。（我想我是在夏野假名的插件中第一次看到它的。）

两个原因：

1.  当用其他东西包装映射时，更容易直观地解析各个映射目标，如下所示：

    `imap <C-x><C-c> <Plug>(CompleteStart)<Plug>(CamelCaseComplete)<SID>(CamelCaseCompleteModifyUndo)<Plug>(CamelCasePostComplete)<Plug>(CompleteoptLongestSelect)`

2.  在为一个插件定义多个映射时，必须注意其中一个的 LHS 不包含在另一个映射中。否则，触发映射时会有延迟，因为 Vim 需要等待额外的击键才能解决歧义。右括号可防止任何此类歧义。

```
BAD                 GOOD
<Plug>MyFunc        <Plug>MyFuncNext, <Plug>(MyFunc)
<Plug>MyFuncReverse <Plug>MyFuncPrev, <Plug>(MyFuncReverse) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-03T17:32:22.887

`{lhs}`映射命令和映射命令中的字节序列都是`{rhs}`可以包含任意数据（NUL 字节除外）的字节序列，只要它具有自然字节数（`{rhs}`也允许字节数为零）。从这个角度来看，`(…)`实践与另一种相比没有优势。

特别是`(textobj-…)`有一个小优势：您可以选择`{lhs}`不`<Plug>`带`a)`运动部分的整体，并且在单词之间有更多可读的破折号。我不知道为什么要这样做，因为`{lhs}`可以使用`aW`( *with* `<Plug>` part) 选择整体。

我看不出 LineJuggler 版本有什么原因。

你最好向作者询问这一点。@IngoKarkat 在[这里，在 stackoverflow 上](https://stackoverflow.com/users/813602/ingo-karkat)，可能很快就会阅读这个问题。我不知道如何联系夏野假名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-03T09:55:35.843

`<Plug>`当调用之后的映射中还有其他击键时，Parens 使（对人类）更清楚。例如我有这个映射：

```
nmap ]c <Plug>GitGutterNextHunkzv 
```

这使得`]c`跳转到下一个 Git 块，然后在`zv`那里打开任何折叠。但由于`<Plug>`名称是任意的，因此*可以*调用该命令`GitGutterNextHunkzv`。一般来说，使用`<Plug>`映射读取文件的人无法知道整个内容是名称还是后面有其他字符。

如果 GitGutter 插件在`<Plug>`名称中使用了括号 for，那么会更清楚地看到发生了什么：

```
nmap ]c <Plug>(GitGutterNextHunk)zv 
```

# php - PHP如何使用谷歌API获取完整的经度和纬度

> ID：13688023
> 
> 赞同：2
> 
> 时间：2012-12-03T16:56:24.697
> 
> 标签：php, geolocation, google-api

请我制作了这段代码来获取经度和纬度：

```
$addresss = "France+mande-lieu-la-napol";
$region   = "Alpes-Maritimes";
$urll      = "http://maps.google.com/maps/api/geocode/json?address=$addresss&sensor=false&region=$region";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $urll);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_PROXYPORT, 3128);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
$response = curl_exec($ch);
curl_close($ch);
$response_a = json_decode($response);

var_dump ($response_a->results[0]->geometry->location->lat );

var_dump ( $response_a->results[0]->geometry->location->lng ); 
```

这段代码给了我结果：

```
float(43.546232) float(6.938309) 
```

但实际上它必须给我

```
float(43.546232) float(6.938309000000004) 
```

请问我应该怎么做才能获得完整的经度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T18:53:04.680

您应该使用`json_decode($json, true, 512, JSON_BIGINT_AS_STRING)`这样 lat 和 long 将作为字符串而不是浮点数返回。

# php - 警告：复制（..）：无法打开流：中没有这样的文件或目录

> ID：13688024
> 
> 赞同：3
> 
> 时间：2012-12-03T16:56:27.647
> 
> 标签：php, file-upload, upload, stream, copy

我对 PHP 还很陌生，正在尝试创建一个简单的 PHP 文件上传系统。

我遵循了（[http://www.phpeasystep.com/phptu/2.html](http://www.phpeasystep.com/phptu/2.html)）的教程。我只更改了`$HTTP_POST_FILES`，因为它给了我错误，并且从我读到的内容来看，它在 PHP 中是旧的。

我收到的错误消息较少，但在`copy()`函数中出现错误，并带有以下给定的错误消息：

```
Warning: copy(Task2/uploads/anonymous.jpg): failed to open stream: No such file or directory in C:\xampp\htdocs\Task2\upload.php on line 13

Warning: copy(Task2/uploads/DSCF4639.JPG): failed to open stream: No such file or directory in C:\xampp\htdocs\Task2\upload.php on line 14

Warning: copy(Task2/uploads/jien maroon.jpg): failed to open stream: No such file or directory in C:\xampp\htdocs\Task2\upload.php on line 15 
```

我认为这是权限问题（Windows 7 中的读/写权限），但从快速的谷歌搜索来看，XAMPP 似乎默认设置为处理 Win 7 上的权限。

这是代码：

```
<?php

//set where you want to store files
//in this example we keep file in folder upload
//$_FILES['ufile']['name']; = upload file name
//for example upload file name cartoon.gif . $path will be upload/cartoon.gif

$path1= "Task2/uploads/".$_FILES['ufile']['name'][0];
$path2= "Task2/uploads/".$_FILES['ufile']['name'][1];
$path3= "Task2/uploads/".$_FILES['ufile']['name'][2];

//copy file to where you want to store file
copy($_FILES['ufile']['tmp_name'][0], $path1);
copy($_FILES['ufile']['tmp_name'][1], $path2);
copy($_FILES['ufile']['tmp_name'][2], $path3);

//$_FILES['ufile']['name'] = file name
//$_FILES['ufile']['size'] = file size
//$_FILES['ufile']['type'] = type of file
echo "File Name :".$_FILES['ufile']['name'][0]."<BR/>";
echo "File Size :".$_FILES['ufile']['size'][0]."<BR/>";
echo "File Type :".$_FILES['ufile']['type'][0]."<BR/>";
echo "<img src=\"$path1\" width=\"150\" height=\"150\">";
echo "<P>";

echo "File Name :".$_FILES['ufile']['name'][1]."<BR/>";
echo "File Size :".$_FILES['ufile']['size'][1]."<BR/>";
echo "File Type :".$_FILES['ufile']['type'][1]."<BR/>";
echo "<img src=\"$path2\" width=\"150\" height=\"150\">";
echo "<P>";

echo "File Name :".$_FILES['ufile']['name'][2]."<BR/>";
echo "File Size :".$_FILES['ufile']['size'][2]."<BR/>";
echo "File Type :".$_FILES['ufile']['type'][2]."<BR/>";
echo "<img src=\"$path3\" width=\"150\" height=\"150\">";

///////////////////////////////////////////////////////

// Use this code to display the error or success.

$filesize1=$_FILES['ufile']['size'][0];
$filesize2=$_FILES['ufile']['size'][1];
$filesize3=$_FILES['ufile']['size'][2];

if($filesize1 && $filesize2 && $filesize3 != 0)
{
echo "We have recieved your files";
}

else {
echo "ERROR.....";
}

//////////////////////////////////////////////

// What files that have a problem? (if found)

if($filesize1==0) {
echo "There're something error in your first file";
echo "<BR />";
}

if($filesize2==0) {
echo "There're something error in your second file";
echo "<BR />";
}

if($filesize3==0) {
echo "There're something error in your third file";
echo "<BR />";
}
?> 
```

任何帮助，将不胜感激 ！

谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-10-08T07:03:47.383

确保目标目录存在，复制不会为您创建目录。

第二个参数是文件权限，对安全很重要，阅读更多：[https ://wiki.archlinux.org/index.php/File_permissions_and_attributes](https://wiki.archlinux.org/index.php/File_permissions_and_attributes)

第三个参数也将创建递归目录。

```
if (!is_dir($directory)) {
    mkdir($directory, 0777, true);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T16:58:11.300

不**使用**`copy`，使用[`move_uploaded_file(...)`](http://php.net/manual/en/function.move-uploaded-file.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:16:51.590

解决了问题！

问题在于路径 .. 而不是`Task2/uploads/`我必须放`../Task2/uploads/`.

谢谢！

# html - HTML 特殊字符 ▼

> ID：13688026
> 
> 赞同：1
> 
> 时间：2012-12-03T16:56:29.380
> 
> 标签：html, special-characters, html-entities

是否有特殊字符 ▼ 的 HTML 实体？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T16:58:17.900

将该字符输入到[fileformat.info 的搜索中](http://www.fileformat.info/info/unicode/char/search.htm)，您将获得[Unicode Character 'BLACK DOWN-POINTING TRIANGLE' (U+25BC) 页面](http://www.fileformat.info/info/unicode/char/25bc/index.htm)，其中包含以下内容：

> HTML 实体（十进制）`&#9660;`

* * *

**与具体问题无关**，如果您只是将 HTML 源文件保存为 UTF-8 并将HTTP标头的属性也设置为，那么*直接*在 HTML 源中使用该字符应该没有问题。这样您就不需要摆弄 HTML 实体。`charset``Content-Type``UTF-8`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T17:01:13.023

如果您有兴趣，这是整个 HTML 集：

> ▲ = ▲
> 
> ▼ = ▼
> 
> ◄ = ◄
> 
> ► = ►

# git - 需要 GITOLITE 的密码提示

> ID：13688028
> 
> 赞同：0
> 
> 时间：2012-12-03T16:56:37.107
> 
> 标签：git, ssh, passwords, gitolite, required

我们想在阅读文档后使用 gitolite 以进行更好的访问管理。

我们需要对提示用户输入密码的位置有特殊要求。我不知道这是否可行，但我们需要它，因为有可能在没有任何提示的情况下推送他们不需要的更改。至少用户将有机会在密码提示期间推送时中止更改，并且如果他/她试图在当前分支上错误地提取一些其他分支代码，也可以选择中止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:11:33.473

正如 Gitolite 文档中提到的，[Gitolite 是一个**授权层**，*而不是*一个身份验证层](http://sitaramc.github.com/gitolite/auth.html)。

请参阅“ [gitolite 之类的程序如何工作？](https://stackoverflow.com/questions/13318715/how-do-programs-like-gitolite-work/13320256#13320256) ”：Gitolite 利用您将通过[ssh](https://stackoverflow.com/questions/10906633/users-are-asked-for-password-while-using-gitolite/10909791#10909791)或 http 传递的任何 id。
对于 http 示例，请参阅“[`git-http-backend`返回错误 502](https://stackoverflow.com/questions/12117942/git-http-backend-returns-error-502/12118131#12118131) ”。

因此，如果您设置：

*   使用受密码保护的私有 ssh 密钥（并且没有 ssh 代理）的 ssh 访问，或
*   https 访问，需要身份验证 ( `Require valid-user`)，

`ssh`那么您的用户将必须为他们的每个 git 操作（推/拉/克隆）输入密码，以与您的进程守护进程后面的远程存储库进行交互`httpd`。

# .net - System.DirectoryServices.DirectoryServicesCOMException：发生操作错误

> ID：13688031
> 
> 赞同：43
> 
> 时间：2012-12-03T16:56:39.823
> 
> 标签：.net, iis, active-directory, directoryservices

我有相同的网络应用程序在其他三台服务器上工作。任何人都知道为什么不在第四台服务器上工作？查看错误和堆栈跟踪：

> *发生操作错误。*
> 
> *说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。*
> 
> *异常详细信息：
> System.DirectoryServices.DirectoryServicesCOMException：发生操作错误。*
> 
> *源错误：*
> 
> *在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。*
> 
> *堆栈跟踪：*
> 
> *[DirectoryServicesCOMException (0x80072020)：发生操作错误。] System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail) +454 System.DirectoryServices.DirectoryEntry.Bind() +36 System.DirectoryServices.DirectoryEntry.get_AdsObject() +31 System.DirectoryServices.PropertyValueCollection.PopulateList() +22
> System.DirectoryServices .PropertyValueCollection..ctor(DirectoryEntry entry, String propertyName) +96
> System.DirectoryServices.PropertyCollection.get_Item(String propertyName) +142 System.DirectoryServices.AccountManagement.PrincipalContext.DoLDAPDirectoryInitNoContainer() +1134 System.DirectoryServices.AccountManagement.PrincipalContext.DoDomainInit() +37 System.DirectoryServices.AccountManagement.PrincipalContext.Initialize() +124 System.DirectoryServices.AccountManagement.PrincipalContext.get_QueryCtx() +31 System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithTypeHelper（PrincipalContext 上下文，类型 principalType，Nullable'1 identityType，字符串 identityValue，DateTime refDate）+14
> System.DirectoryServices.AccountManagement。 Principal.FindByIdentityWithType(PrincipalContext context, Type principalType, String identityValue) +73
> System.DirectoryServices.AccountManagement.UserPrincipal.FindByIdentity(PrincipalContext context, String identityValue) +25
> Infraero.TINE3.STTEnterprise.Web.Common.Seguranca.ServicoAutenticacao.EfetuarLogin(AcessoUsuario acessoUsuario, String senha) 在 D:\SVN\STT\trunk\4-0_CodigoFonte_Enterprise\4-4_SRC\Infraero.TINE3.STTEnterprise.Web\Common\ Segranca\ServicoAutenticacao.cs:34 Infraero.TINE3.STTEnterprise.Web.Controllers.LoginController.ValidarUsuarioAD(String matricula, String senha, AcessoUsuario acessoUsuario) 在 D:\SVN\STT\trunk\4-0_CodigoFonte_Enterprise\4-4_SRC\Infraero. TINE3.STTEnterprise.Web\Controllers\LoginController.cs:92 Infraero.TINE3.STTEnterprise.Web.Controllers.LoginController.ValidarUsuario(String matricula, String senha) 在 D:\SVN\STT\trunk\4-0_CodigoFonte_Enterprise\4-4_SRC \Infraero.TINE3.STTEnterprise.Web\Controllers\LoginController.cs:80 Infraero.TINE3.STTEnterprise.Web.Controllers.LoginController。D:\SVN\STT\trunk\4-0_CodigoFonte_Enterprise\4-4_SRC\Infraero.TINE3.STTEnterprise.Web\Controllers\LoginController.cs:54 lambda_method(Closure, ControllerBase, Object[]) 中的索引(LoginViewModel loginViewModel) +108
> System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase 控制器, Object[] 参数) +17
> System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary'2 参数) +208
> System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod( ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary'2 参数) +27
> System.Web.Mvc.<>c__DisplayClass15.b__12() +55 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func'1 延续) + 263
> System.Web.Mvc.<>c__DisplayClass17.b__14() +19 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList'1 过滤器, ActionDescriptor actionDescriptor, IDictionary`2 参数) +191
> System.Web.Mvc.ControllerActionInvoker .InvokeAction(ControllerContext controllerContext, String actionName) +343
> System.Web.Mvc.Controller.ExecuteCore() +116
> System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97 System.Web.Mvc.ControllerBase.System.Web .Mvc.IController.Execute(RequestContext requestContext) +10
> System.Web.Mvc.<>c__DisplayClassb.b__5() +37
> System.Web.Mvc.Async.<>c__DisplayClass1.b__0() +21
> System.Web.Mvc.Async.<>c__DisplayClass8'1.b__7(IAsyncResult _) +12 System.Web.Mvc.Async.WrappedAsyncResult'1.End() +62 System.Web.Mvc.<>c__DisplayClasse.b__d( ）+50
> System.Web.Mvc.SecurityUtil.b__0（动作 f）+7 System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust（动作动作）+22 System.Web.Mvc.MvcHandler.EndProcessRequest（IAsyncResult asyncResult）+60
> 系统。 Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult 结果) +9
> System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8963149 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&同步完成）+184*

EfetuarLogin 方法：

```
public static bool EfetuarLogin(User user, string password)
{
    bool isValid = false;

    if (user != null)
    {
        PrincipalContext context = new PrincipalContext(ContextType.Domain);

        using (context)
        {
            isValid = context.ValidateCredentials(user.Login, password);

            if (isValid)
            {
                UserPrincipal userAD = UserPrincipal.FindByIdentity(context, user.Login);

                MySession.CurrentUser = new MyUserSession()
                {
                    Id = user.Id,
                    ProfileId = user.ProfileId ,
                    Login = user.Login ,
                    Name = userAD.Name
                };
            }
        }
    }

    return isValid;
} 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-02-21T11:43:13.680

我遇到了完全相同的错误，并通过将站点的应用程序池更改为在网络服务下运行来修复它。

在 IIS 中：

*   选择您网站的应用程序池
*   选择右侧的高级设置
*   在 Advanced Settings 弹出窗口中，向下滚动到 Process Model 组
*   将名为 Identity 的第一个选项更改为 NetworkService（我的设置为默认的 ApplicationPoolIdentity）。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-05-23T15:06:53.953

我知道这个话题很老，但只是为了将来会寻找这个问题的人使用这个方法来执行具有提升权限的代码

```
using (HostingEnvironment.Impersonate()) {
    // This code runs as the application pool user
    } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-03T19:48:15.260

在这种情况下没有`InnerException`，它只是包装了一个 COM 错误。

几乎可以肯定这是因为您的**应用程序池身份没有访问 Active Directory 的权限**。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-30T20:25:34.333

在我的情况下，在应用程序池中从 ApplicationPoolItentity 切换到 NetworkService 确实有效，**但**它不是首选“因为作为网络服务运行的服务可以篡改以相同身份运行的其他服务”，每个链接如下：（[http://www. iis.net/learn/manage/configuring-security/application-pool-identities](http://www.iis.net/learn/manage/configuring-security/application-pool-identities)）。

我在服务器上运行了修补程序（[KB2545850](http://support.microsoft.com/kb/2545850)）并根据这个答案重新启动：（[DirectoryServicesCOMException 80072020 From IIS 7.5 Site Running Under ApplicationPoolIdentity](https://stackoverflow.com/questions/13070856/directoryservicescomexception-80072020-from-iis-7-5-site-running-under-applicati)）

它现在似乎运作良好。

我的任务背景：将应用程序从 Server 2003 上的 .net framework 2.0 升级到 Server 2008 R2 上的 .net framework 4.0。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-05-08T10:35:12.200

我的经验与此错误略有不同。我不得不将本地应用程序移动到 Azure，LDAP 调用是从本地进行的，但即使在打开所需的防火墙之后也不能从 Azure 调用。

我尝试了上面提到的所有解决方案，但没有一个有帮助。Azure VM 上已选择网络服务。

经过大量的尝试和研究。我修好了它。

解决方案：本地服务器有权访问 LDAP，并且不需要任何用户名和密码。但在 Azure 上，您需要专门使用用户名和密码进行 LDAP 调用。下面是有帮助的代码。

```
 var directoryEntry= new DirectoryEntry(adspath, Username, Password) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-15T14:14:30.003

1 - 更改应用程序池以在网络服务下运行。
2 - 单击身份验证并禁用 ASP.Net 模拟。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-12-03T19:17:57.540

因此，如果您在该行上放置一个断点：

```
UserPrincipal userAD = UserPrincipal.FindByIdentity(context, user.Login); 
```

并单步执行它，它会生成上面没有任何 InnerExceptions 的异常？

根据堆栈跟踪，该行是问题的开始。返回的异常**应该**至少包含一些其他信息，说明它被抛出的原因。

# 内部异常连接器

以下方法采用顶级异常并以字符串形式返回内部异常的制表符和换行符格式的细分。

```
 private static string InnerExceptionConcatenator(Exception ex, int tabTracker = 0)
    {
        string retVal = "";
        if (ex.InnerException != null)
        {
            tabTracker ++;
            retVal = string.Format( "{0}\r\n{1}{2}", ex.Message, new String('\t', tabTracker), InnerExceptionConcatenator(ex.InnerException));
        }
        else
        {
            retVal = ex.Message;
        }
        return retVal;
    } 
```

你可以这样称呼它：

```
try
{

}
catch(ex Exception)
{
    var exceptionString = InnerExceptionConcatenator(ex);
    var path = @"c:\temp\exception.txt";
    if (!File.Exists(path)) 
    {
        using (StreamWriter sw = File.CreateText(path)) 
        {
            sw.WriteLine(exceptionString);
        }   
    }
    else
    {
        using (StreamWriter sw = File.AppendText(path)) 
        {
            sw.WriteLine(exceptionString);
        }
    }
} 
```

# r - 使用ggplot2时如何使绘图比例相同？

> ID：13688034
> 
> 赞同：0
> 
> 时间：2012-12-03T16:56:56.820
> 
> 标签：r, ggplot2

我正在使用 ggplot2 绘制回归线。我还想用置信区间绘制平均点，以显示它是否显着。例如：

```
library("ggplot2")
library("gridExtra")
library("epicalc")
options(digits=2)

subset1 <- subset(na.omit(iris), Species == "setosa")
subset2 <- subset(na.omit(iris), Species == "versicolor")
subset3 <- subset(na.omit(iris), Species == "virginica")

meanx <- c(ci(subset1$Sepal.Length)$mean,
               ci(subset2$Sepal.Length)$mean,
               ci(subset3$Sepal.Length)$mean)

meany <- c(ci(subset1$Sepal.Width)$mean,
           ci(subset2$Sepal.Width)$mean,
           ci(subset3$Sepal.Width)$mean)

Species <- factor(c("setosa", "versicolor", "virginica"))
meanmatrix <- as.data.frame(cbind(Species, meanx, meany))

lowerx <- c(ci(subset1$Sepal.Length)$lower95ci,
            ci(subset2$Sepal.Length)$lower95ci,
            ci(subset3$Sepal.Length)$lower95ci)

upperx <- c(ci(subset1$Sepal.Length)$upper95ci,
            ci(subset2$Sepal.Length)$upper95ci,
            ci(subset3$Sepal.Length)$upper95ci)

lowery <- c(ci(subset1$Sepal.Width)$lower95ci,
            ci(subset2$Sepal.Width)$lower95ci,
            ci(subset3$Sepal.Width)$lower95ci)

uppery <- c(ci(subset1$Sepal.Width)$upper95ci,
            ci(subset2$Sepal.Width)$upper95ci,
            ci(subset3$Sepal.Width)$upper95ci)

px <- ggplot(data = meanmatrix, geom = 'blank',
             aes(y = meanx, x = meany,color = factor(Species)))
pbx <- px + 
  geom_point(size = 5) +
  geom_errorbar(aes(ymin=lowerx, ymax=upperx), colour="black", width=.1) +
  scale_color_manual(values = c("#00FFFF", "#FFFF00", "#00FF00")) +
  theme(panel.background = element_rect(fill='white', colour='red'),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none") +
  coord_flip()

py <- ggplot(data = meanmatrix, geom = 'blank',
             aes(y = meany, x = meany,color = factor(Species)))
pby <- py + 
  geom_point(size = 5) +
  geom_errorbar(aes(ymin=lowery, ymax=uppery), colour="black", width=.1) +
  scale_color_manual(values = c("#00FFFF", "#FFFF00", "#00FF00")) +
  theme(panel.background = element_rect(fill='white', colour='red'),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")

p <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width,
                    color = factor(Species)))

p0 <- p + 
  scale_color_manual(values = c("#00FFFF", "#FFFF00", "#00FF00")) +
  scale_linetype_manual(breaks = c("0","1"), values = c(1,2), labels = c("male", "female")) +
  geom_smooth(method = "lm",se = FALSE, size = 1.2) +
  theme(panel.background = element_rect(fill='white', colour='red'),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")

grid.newpage() 
pushViewport(viewport(layout = grid.layout(nrow=3, ncol=3)))
print(p0,vp = viewport(layout.pos.row = 1:2, layout.pos.col = 2:3))
print(pby,vp = viewport(layout.pos.row = 1:2, layout.pos.col = 1))    
print(pbx,vp = viewport(layout.pos.row = 3, layout.pos.col = 2:3)) 
```

三个地块的尺度是不同的。我怎样才能使它们通用，以便我可以比较它们？谢谢。![在此处输入图像描述](../Images/d93b2dd2f52568279430cb7f773b0bda.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:40:56.750

`scale_x_continuous`就像 Ernest A. 评论的那样，您可以使用和手动更改 x 和 y 轴的比例`scale_y_continuous`。只需将`breaks`参数设置为相同的值。

在绘图本身中绘制不确定性条，或绘制包括 95% 置信区间的回归线也可能更容易。

# iphone - 检测自定义按钮的 UIAppearance 代理中的更改

> ID：13688036
> 
> 赞同：2
> 
> 时间：2012-12-03T16:57:01.830
> 
> 标签：iphone, objective-c, ios, uibutton, uiappearance

我正在创建一个自定义按钮，它有几个标记为`UI_APPEARANCE_SELECTOR`. 如何通过外观代理检测属性何时更改？不调用属性设置器。

该属性确实发生了更改，因为它在 中具有正确的值`drawRect:`，但我仍然需要检测它何时更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T15:25:17.670

您可以使用 KVO（键值观察器）来完成。我没有在这里放任何代码，因为在使用之前阅读文档并理解概念非常重要。来自 Apple 的 Key-Value Observing Programming Guide：

> 键值观察提供了一种机制，允许对象在其他对象的特定属性发生更改时得到通知。

[这是 Apple 官方文档的链接。](https://developer.apple.com/library/mac/#documentation/cocoa/conceptual/KeyValueObserving/KeyValueObserving.html)

# ios - 工作区中的 RestKit

> ID：13688037
> 
> 赞同：0
> 
> 时间：2012-12-03T16:57:02.833
> 
> 标签：ios, rest, static-libraries, restkit

我在 Xcode 中设置了一个工作区。它包含一些我在主项目中链接到的静态库项目。

链接到这些项目的过程比应有的要长得多。但对我来说，让它工作的关键是从我的构建设置中删除 -ObjC 链接器标志。当我在多个地方使用库时，这使我不会得到重复的文件。

但这在尝试将 RestKit 包含在我的项目中时给了我一个问题，因为文档说 -ObjC 链接器标志是必要的，我发现是这种情况。

有没有办法将 RestKit 包含在这样的工作区中并像任何其他静态库一样链接到它？无需使用 -ObjC 链接器标志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:29:11.943

如果您计划将您的应用程序定位到 IOS 5 及更高版本，那么您可以尝试使用内置的 NSURLConnection 以及 NSJSONSerialization 类（如果您返回 JSON 响应）。

# box-api - box.com 是否有可用的文件选择器？

> ID：13688040
> 
> 赞同：4
> 
> 时间：2012-12-03T16:57:11.070
> 
> 标签：box-api

类似于[dropbox 的文件选择器，](https://www.dropbox.com/developers/chooser)是否有 box.com 的文件选择器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-12T23:26:06.260

Box 现在有它自己的文件选择器。请参阅[https://box-content.readme.io/docs/the-box-file-picker](https://box-content.readme.io/docs/the-box-file-picker)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-01-24T17:50:40.820

您还可以通过[Kloudless File Picker](https://github.com/kloudless/file-picker/)为 Dropbox、Box、Google Drive、SharePoint、OneDrive 等使用单个文件选择器。（我在 Kloudless 工作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:02:42.927

Box 目前不维护自己的“文件选择器”；然而，有一个很棒的服务叫做 filepicker.io，它充当几乎所有云服务的“文件选择器”，包括 Box。你可以在这里找到他们的文档：[https ://developers.filepicker.io/docs/](https://developers.filepicker.io/docs/)

# javascript - SimpleModal 基本模式窗口在选择时显示无效页面

> ID：13688044
> 
> 赞同：1
> 
> 时间：2012-12-03T16:57:24.987
> 
> 标签：javascript, jquery, html, modal-dialog

我正在使用 SimpleModal 基本模态对话框，当我尝试在更改跳转菜单时实现模态窗口弹出窗口时，对话框打开，但我很快被重定向到一个不存在的 url。

我该如何防止这种情况发生？

这是跳转菜单的 HTML：

```
<select name="fieldname" size="1" onChange="go()" class="select" >
              <option selected="selected"><em>Questions Bulk Edit Options...</em></option>
              <option value="http://74.39.250.15/questions_listing.asp?categoryState=1">Change Category Assignments</option>
              <option class="basicConfirmapprove" href="#">Change Status to Approved</option>
              <option value="http://74.39.250.15/questions_listing.asp?categoryState=2">Move to Another Folder</option>
            </select> 
```

这是我的页面JavaScript：

```
<script type="text/javascript">
<!--
function go(){
location=
document.Category.fieldname.
options[document.Category.fieldname.selectedIndex].value
}
//-->
</script> 
```

这是我的模态窗口的 HTML：

```
<div id="basic-modal-confirmapprove">
            <%  
'Page Preferences
PageName = ""
%>

<!--#include file="header_modal.asp"-->
<div><center>Are you sure you want to approve all the selected items?</center></div> 
  <br />
<div align="center"><a href="#" class="button simplemodal-close">Cancel</a>&nbsp;&nbsp;<a href="#" class="keybutton simplemodal-close">OK</a></div>
<!--#include file="footer_modal.asp"--> 
```

这是我的模态窗口的JavaScript：

```
// Load dialog on click
$('#basic-modal .basicConfirmapprove').click(function (event){
    $('#basic-modal-confirmapprove').modal();

    return false;
}); 
```

如何防止跳转到“....com/Change Status to Approved”网址？显然它不存在。如果我单击返回，它将完美地显示带有模态窗口的前一个窗口。

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:17:58.053

因为您已经连接了 onchange="go()" 事件处理程序，所以该代码将在下拉值更改时立即执行。如果您不想重定向，则需要输入以下内容：

```
var redirectValue =  document.Category.fieldname.options[document.Category.fieldname.selectedIndex].value;

if (redirectValue.substring(0,4) == "http")
{
    window.location = redirectValue;
} 
```

这样重定向只会在值以“http”开头时发生，所以如果他们选择 basicConfirmapprove 那么你应该是安全的

希望这可以帮助。

# moodle - 试图控制课程内容对 Moodle 组的可见性

> ID：13688045
> 
> 赞同：0
> 
> 时间：2012-12-03T16:57:26.840
> 
> 标签：moodle

我正在使用moodle 2.2.4。

我有来自 1 区和 2 区的课程的学生。我要求为 2 区的学生分配课程顾问。顾问只能查看 2 区学生的数据。

这就是我试图满足请求的方式。

```
I created a new role called advisor based on the student role.
I created a new group in the course called group1.
I created a new account called group2_advisor 
I enrolled group2_advisor in the role of advisor into group1 in the course. 
I moved the student into group1\. 
```

当我登录 group2_advisor 时，我只能看到 1 区的学生（这很棒），但是，当我点击论坛或测验活动时，我仍然看到 1 区的数据。

我最初的顾问角色是基于非编辑老师的角色，但即使在我完成了步骤 1-4 之后，这仍然显示了两个地区。当我将顾问角色建立在学生角色上时，我只能看到第 2 区的数据（这就是我所追求的）。

非常感谢任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T09:53:20.663

查看 Moodle 组默认功能[组内容可见性](http://docs.moodle.org/20/en/Available_for_group_members_only)。

# database - 数据库连接期间未发现 GWT 文件故障

> ID：13688047
> 
> 赞同：2
> 
> 时间：2012-12-03T16:57:27.640
> 
> 标签：database, gwt, servlets, connection, web.xml

我正在尝试创建一个 GWT 应用程序，并且正在使用本地 postgreSQL 数据库。我在 eclipse Juno 上使用 GWT 2.4。我以这种方式实现了服务器端实现（TaskServiceImpl）：

```
public class TaskServiceImpl extends ServiceImpl implements TaskService {

@Override
public List<Task> getAllTasks() {
    em = this.getEntityManager();
    Query q = em.createQuery("SELECT x FROM Task x");
    List<Task> list = createList(q.getResultList().toArray(),
            new ArrayList<Task>(), em);
    em.close();
    return list;
} 
```

这是客户端的数据库连接类：

```
public class DatabaseConnection {
public static final TaskServiceAsync taskService;

static {
    taskService = GWT.create(TaskService.class);
} 
```

}

我现在尝试以这种方式运行 getAllTask​​()

```
public void onModuleLoad() {
    DatabaseConnection.taskService.getAllTasks(new AsyncCallback<List<Task>>() {

        @Override
        public void onSuccess(List<Task> result) {
            System.out.println("Success!");
        }

        @Override
        public void onFailure(Throwable caught) {
            System.out.println("Fail!");
        }
    });
} 
```

并且总是返回“失败！” 并给我这个错误：

> com.google.appengine.tools.development.LocalResourceFileServlet doGet 警告：找不到文件：/fantapgl/task

这是我的 web.xml

```
<servlet>
    <servlet-name>taskServiceImpl</servlet-name>
    <servlet-class>fieldProject.server.service.TaskServiceImpl</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>taskServiceImpl</servlet-name>
    <url-pattern>/fantaPGL/task</url-pattern>
  </servlet-mapping> 
```

要打开与数据库的连接，我在 persistence.xml 中有以下代码：

```
<properties> 
  <property name="openjpa.jdbc.DBDictionary" value="postgres" /> 
  <property name="openjpa.jdbc.SynchronizeMappings" value="buildSchema()"/> 
  <property name="openjpa.ConnectionDriverName" value="org.postgresql.Driver"/> 
  <property name="openjpa.ConnectionURL" value="jdbc:postgresql://localhost:5432/db" />
  <property name="openjpa.ConnectionUserName" value="postgres" /> 
  <property name="openjpa.ConnectionPassword" value="password" />
</properties> 
```

我不明白我错在哪里。有人可以帮助我吗！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:59:33.553

我不确定问题是什么。但错误消息似乎表明您启用了 google appengine。这没有任何意义，因为只有在您想在 Google 应用引擎上部署时才需要它，而且您显然是在为其他东西开发，因为您无法在 Google 应用引擎上运行 PostgreSql。

此外，确保通过将 close 放在 finally 语句中来关闭数据库连接，并且更喜欢返回特定的数据类型；即 ArrayList 而不是 List。否则编译器将为 List 的所有子类生成代码，因为在编译时编译器无法知道将使用哪个子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T17:20:11.643

您需要在 serviceImpl 类的开头添加 @RemoteServiceRelativePath 注释。

请参考[https://developers.google.com/web-toolkit/doc/latest/tutorial/RPC](https://developers.google.com/web-toolkit/doc/latest/tutorial/RPC) 或者如果你已经安装了 google eclipse 插件，使用示例代码创建一个新项目，你也可以参考示例代码.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:18:11.600

在执行查询之前：

1）使用jdbc驱动

```
try {
       Class.forName("org.postgresql.Driver");
     } catch (ClassNotFoundException e) {

        System.out.println("Your PostgreSQL JDBC Driver is missing! "
                + "Include in your library path!");
     e.printStackTrace();
    return "error";

     } 
```

2) 连接数据库

```
Connection connection = null;
connection = 
    DriverManager.getConnection( "jdbc:postgresql://127.0.0.1:5432/"YourDB", 
                                 "admin", 
                                 "pass" ); 
```

3）然后执行查询

if (connection != null) { //你的查询 }

# c# - C#/.NET 内置接口列表

> ID：13688051
> 
> 赞同：-2
> 
> 时间：2012-12-03T16:57:46.633
> 
> 标签：c#, .net, interface

我正在寻找完整的 C# 标准接口列表。我几乎可以肯定这样的主题发布在 MSDN 上的某个地方，但我找不到。有没有人有参考？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:10:11.687

对不起，但这样的文档不存在...

看，msdn 文档是由“命名空间”组织的，所以...您可以看到这样的文档不适合任何地方...
顺便说一句，您为什么想要那个？！？如果您在基础 dll 中编译每个接口的文档（系统、文本、system.data、linq 等...），您将拥有一个相当大的文档，它会比“去混淆”引起更多的混淆，因为在不同的命名空间接口可能具有相同的名称...

# node.js - 在 Amazon EC2 上新安装后运行应用程序出错

> ID：13688052
> 
> 赞同：0
> 
> 时间：2012-12-03T16:57:47.400
> 
> 标签：node.js, amazon-ec2, npm

第一次尝试使用 Amazon EC2 安装 node.js 服务器。按照[这篇文章](http://iconof.com/blog/how-to-install-setup-node-js-on-amazon-aws-ec2-complete-guide/)做。安装 node.js，然后是 npm，然后是所有其他模块。都没有错误。但是由于某种原因，我的服务器没有启动。你能告诉我在哪里找到错误吗？

```
[ec2-user@domU-12-31-39-07-62-87 ~]$ node server.js

module.js:340
    throw err;
          ^
Error: Cannot find module 'socket.io'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/home/ec2-user/server.js:3:10)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10)
[ec2-user@domU-12-31-39-07-62-87 ~]$ cd node
[ec2-user@domU-12-31-39-07-62-87 node]$ node server.js

module.js:340
    throw err;
          ^
Error: Cannot find module '/home/ec2-user/node/server.js'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.runMain (module.js:492:10)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:29:29.613

看起来它只是找不到socket.io。尝试这个：

```
cd /home/ec2-user
npm install socket.io
node server.js 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T19:42:03.060

我同意“The Reddest”，但是，文章说安装 express 应该安装 socket.io 作为依赖项。您是否运行了文章中的最后两个 npm 命令？

```
sudo npm install express -g
sudo npm install forever -g 
```

更好的是，创建一个 package.json 文件并将其依赖项安装到应用程序本地而不是全局。在此处阅读更多相关信息.. [http://docs.nodejitsu.com/articles/getting-started/npm/what-is-the-file-package-json](http://docs.nodejitsu.com/articles/getting-started/npm/what-is-the-file-package-json)

# php - 在 PHP 中对复杂数组进行多重排序

> ID：13688053
> 
> 赞同：1
> 
> 时间：2012-12-03T16:57:49.303
> 
> 标签：php, arrays, sorting

我在 PHP 中有一个相对复杂的数组，需要以特定方式排序，但过滤器和排序的数量有点复杂，一个简单的解决方案似乎让我无法理解。

**问题：**我们的订单中的产品需要根据以下标准过滤到“发货”组中：产品可以发货的日期，产品是否可以与其他产品分组，以及在哪个仓库中产品可以发货。如果 2 个产品具有相同的日期、仓库和允许分组，则它们将一起放置在同一个“shipto”中。

**当前解决方案（未完全实现）**

当我提取订单时，我会遍历其中的项目并使用以下信息构建一个数组（仅供参考，这可能包含比我解决此问题所需的更多信息）

```
$allProducts = array();
$today = date("Ymd");

/* If the product is being shipped now, put in the Today ShipTo dated 00000000 */
if (($today > $start) && ($today < $end)) {
    array_push($allProducts, array('ship' => '00000000', 'defaultwarehouse' => $defaultwarehouse, 'warehouse' => $warehouse, 'group' => $group,'product' => $product, 'start_month' => $start_month, 'start_day' => $start_day, 'end_month' => $end_month, 'end_day' => $end_day, 'description' => $description, 'qty_ordered' => $qty_ordered, 'row_total' => $row_total, 'price' => $price, 'tax_amount' => $tax_amount, 'shipping_group' => $shippingGroup, 'today' => $today, 'end' => $end, 'start' => $start ) );
} else {
    /* If the product is not being shipped today, put in a Group that matches the starts date for the ShipTo */
    array_push($allProducts, array('ship' => $start, 'defaultwarehouse' => $defaultwarehouse, 'warehouse' => $warehouse, 'group' => $group, 'product' => $product, 'start_month' => $start_month, 'start_day' => $start_day, 'end_month' => $end_month, 'end_day' => $end_day, 'description' => $description, 'qty_ordered' => $qty_ordered, 'row_total' => $row_total, 'price' => $price, 'tax_amount' => $tax_amount, 'shipping_group' => $shippingGroup, 'today' => $today, 'end' => $end, 'start' => $start  ));
}
endif; 
```

其中 $defaultwarehouse 是代表默认仓库的数字（即 1），$warehouse 是产品可以在的所有可能的仓库（即 1,2），$start 是产品可以首次发货的日期（即 20121201 2012 年 12 月 1 日；Ymd, 00000000 代表今天，因此可以对它们进行数字排序），$group 是一个布尔值，表示产品是否可以与其他物品一起发货（即 1 表示是，0 表示否）

我最初的想法是根据组对数组进行排序，然后是仓库，然后是开始日期。然后我会遍历数组来构建“shipto”，当数组的某些组件发生变化（如仓库或开始）时，我会关闭前一个 shipto 并开始一个新的。如果我将 Group 和 Multiple Warehouses 排除在外，我可以让这个逻辑发挥作用。但是我的任务需要我把它们放进去，所以我遇到了以下并发症。

首先，在按 Group 排序后，我真的想对其余的过滤器进行 Group=Yes 和 Group=No 的 2 个子排序。这让我想到，也许我应该将数组分成 2 个数组，并以类似但分开的方式对它们进行排序。这样做似乎效率低下，但我不确定。

其次，由于仓库可以是逗号分隔值，我如何过滤它并获得正确的匹配。即，如果我有 3 种产品，它们的仓库价值为 1:1,2:3，这应该分为 2 个shiptos。一个用于 1:1,2，另一个用于 3。

**对问题的思考**

我的感觉是我正在考虑将项目过滤到可遍历数组中的问题的方式可能不是解决它的最佳方法。可能我需要将订单项目单独推送到一个新的“发货”数组中，该数组检查每个项目与所有当前的“发货”。但我也不确定这将如何工作。或者可能有一种不同的方式我根本没有考虑如何实现这一点。

**示例数组数据**（为简单起见删除了额外数据）：

```
[0]=> 
 'ship' => 00000000
 'defaultwarehouse' => 1
 'warehouse' => 1
 'group' => 1
 'sku' => 'ABC123'
[1]=>
 'ship' => 00000000
 'defaultwarehouse' => 1
 'warehouse' => 1,2
 'group' => 1
 'sku' => 'DEF234'
[2]=>
 'ship' => 00000000
 'defaultwarehouse' => 2
 'warehouse' => 1,2
 'group' => 1
 'sku' => 'GHI567'
[3]=>
 'ship' => 20121220
 'defaultwarehouse' => 1
 'warehouse' => 1,2
 'group' => 1
 'sku' => 'JKL890'
[4]=>
 'ship' => 20121220
 'defaultwarehouse' => 1
 'warehouse' => 1,2
 'group' => 1
 'sku' => 'MNO123'
[5]=>
 'ship' => 20130401
 'defaultwarehouse' => 1
 'warehouse' => 1
 'group' => 1
 'sku' => 'PQR456'
[6]=>
 'ship' => 20130401
 'defaultwarehouse' => 1
 'warehouse' => 1
 'group' => 0
 'sku' => 'STU789' 
```

这应该会产生 5 个“shipto”组：

```
shipto[1] => ABC123, DEF234 (Base "group" for all other comparisons)
shipto[2] => GHI567 (Default warehouse does not match, previous shiptos)
shipto[3] => JKL890, MNO123 (Different shipping date)
shipto[4] => PRQ456 (Different shipping date from all others)
shipto[5] => STU789 (Can not be grouped with other shipments) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:58:08.977

您是否可以将数据存储在数据库或类似的地方？听起来您的数据非常复杂，将其存储在数据库中将使您希望进行的排序变得更加容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T14:45:45.820

最后，这个问题变得更加复杂，我通常抛弃了能够进行逻辑排序并将子排序应用于单个数组或 SQL 查询的概念。业务逻辑发生了如此大的变化，以至于在一个维度上保持一切正常毫无意义。

最终的逻辑应用了 4 级过滤，所以我所做的就是隔离逻辑的每一步，并将前一个数组过滤成一个新数组，其中的订单位于适当的位置。这不是处理这个问题的最有效方法，但它非常易读，让我可以清楚地看到每个订单在流程的每个步骤中是如何排序的。“排序”数组有 4 层深，但允许我挑选每批货物以进行正确显示。

# python - 试图解开递归 Python 程序

> ID：13688056
> 
> 赞同：0
> 
> 时间：2012-12-03T16:58:07.103
> 
> 标签：python, recursion, loops

我正在编写一个简单的密码求解器，并且无法“展开”递归函数。我必须出于其他原因展开它，否则我会让它递归。

想法是这样的：我有可变数量的列表，每个列表中都有单词。该函数的工作是遍历每个列表，并在检查单词是否适合当前的字母表设置后，找到它的分数。因此，如果您有以下列表：

```
LIST1: [the, and, can,...]
LIST2: [kids, cars, knee,...]
LIST3: [talks, walks, music,...]
... 
```

并且该函数需要遍历每个列表（按顺序）并尝试找到最佳句子。（我有一个评分算法，它调用它来比较。）它从第一个列表中的第一个单词开始，然后迭代第二个列表直到找到一个有效的单词，然后开始迭代第三个列表直到它找到那个单词列出有效的单词等。一旦用尽了第三个列表中的单词，它应该返回到第二个并找到下一个有效的单词，继续该过程直到完成。

我尝试使用 Product 功能，但这并不能以正确的方式工作……这只是给了我所有可能的组合，并且在技术上有效，但效率不高。

```
def find_sentence():
cycle through first list:
cycle through second list:
if word works:
start cycling through third word list.
else: 
keep cycling through 2nd word list.
... 
```

继续前进，直到我们浏览完所有单词列表，找到高于阈值的分数..

有什么帮助吗？

来自 Bakuriu 的回复：感谢您的快速回复！我在 Python 方面不是那么好，但我认为这不是我需要的方式。您的解决方案类似于 Product 方法，因为它的目标是找到所有有效（或符合分数）的单词。我需要使用的方法是： 1\. 从第一个列表中的第一个单词开始。2\. 开始迭代下一个单词列表。3\. 一旦其中一个词起作用，就开始浏览第三个列表，等等。 4\. 当你到达最后（到最后一个词列表）并找到候选人时，你现在有了一个解决方案，因为你在每个有效的列表中都有一个单词。5\. 如果说，列表 3 中的一个词不适合，您必须返回列表 2 并继续搜索该列表，找到下一个有效的词，继续从列表 3 重新开始，并继续直到没有任何工作或者您' 已经到了尽头。我希望这很清楚。如果我能澄清任何事情，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:06:35.050

实际上，您实际上根本不需要递归。

```
def find_sentence(*variable_number_of_lists):
    out = []
    for eachlist in variable_number_of_lists:
        for word in eachlist:
           if scoreword(out, word) > threshhold:
               # presumably, your 'scoreword' function would take in the current
               # list of okayed words in order to find the most recent one for use
               # in your scoring, if I've understood the problem correctly
               out.append(word)
               break

    return out 
```

# java - 数据控件中的 Java ADF 存储值在下次运行之前不会显示

> ID：13688060
> 
> 赞同：0
> 
> 时间：2012-12-03T16:58:08.510
> 
> 标签：java, jdeveloper, oracle-adf

基本上，我有一个 JSF 页面，其中包含许多组件，包括一个 ADF 表，其中填充了从我的数据控件类中的 getData() 方法返回的数据列表。在表格上方，我试图从显示的数据中显示一些计算值 - 但字段值未正确显示。

（我使用的是 JDev 11.1.1.5）

数据控件类称为RecentDeals，getData() 方法返回一个包含许多字段（日期、值、名称等）的Deal 对象列表。

RecentDeals 类还包含私有变量，用于存储要显示在表格上方的计算（平均值）值（例如，avgSize、avgTerm、avgRent 等）。在同一个 getData() 方法中，在遍历交易列表以执行所需的计算（并在此过程中存储相应的值）之后，变量会在返回填充表的交易对象列表之前使用计算的平均值进行更新。

以下是代码的摘录以供参考：

```
public class RecentDealsDC {

    private Double avgSize;
    private Double avgTerm;
    private Double avgRent;
    ...

    public RecentDealsDC() {
        super();
        avgSize = 0.0;
        avgTerm = 0.0;
        avgRent = 0.0;
        ...
    }

    public List<DealDTO> getData(List<String> businessUnits){
        List<TransactionDTO> transactions = new ArrayList<TransactionDTO>();
        List<DealDTO> deals = new ArrayList<DealDTO>();
        TransactionSessionBean transBean = lookupTransactionSessionBean();

        Double size = 0.0;
        Double term = 0.0;
        Double totalBaseRent = 0.0;
        ...
        Integer recordCount = 0;

        if (businessUnits != null && !businessUnits.isEmpty()){
            transactions = transBean.getDealsData(SystemUtil.getCurrentUser(), businessUnits);

            recordCount = transactions.size();

            if( recordCount > 0 ){
                for (int i=0; i < recordCount; i++){
                    TransactionDTO transObj = new TransactionDTO();
                    DealDTO dealObj = new DealDTO();

                    transObj = transactions.get(i);

                    // process transaction, execute logic, store deal values

                    size = size + transObj.getRentableArea();
                    term = term + transObj.getLeaseTerm();
                    totalBaseRent = totalBaseRent + (transObj.getRentableArea() * transObj.getBaseRent());
                    ...

                    deals.add(dealObj);
                }
            }

            avgSize = size / recordCount;
            avgTerm = term / recordCount;
            avgRent = totalBaseRent / size;
            ...

        }

        return deals;
    }
} 
```

当我运行我的 JSF 页面时，它正确显示了来自 Deal 对象列表的数据，但计算的字段只显示为零。当用户选择下一个“标准”来填充表格时（从标题中的下拉列表中），计算的字段随后将使用先前存储的值进行更新。因此，换句话说，标题字段显示与前一组数据有关的平均值，并且对于每个后续用户选择，循环似乎都会继续 - 因此用户被迫选择另一个值以获得所需的平均值，这显然是不可接受的.

我已在调试模式下确认计算正在正确执行，并且在返回 List 之前将正确的值存储在私有变量中。

不确定我在这里缺少什么，但我想我需要以某种方式“刷新” outputText 组件以立即显示预期值。这就是我正在研究的，但现在有些茫然。

任何建议/方向/想法将不胜感激。

编辑：当我折叠并重新展开它们包含在其中的 panelBox 时，看起来 outputText 字段也会更新。所以我想知道是否有某种方法可以让我手动执行相同的更新......

谢谢，卡里姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T14:55:34.767

我得出的解决方案如下：

修改了 DC 类 getData 方法以返回一个新的 DTO，其中包含原始 List 结果集和我需要显示的 4 个变量。然后，我将返回的 DTO 下方的结果集和变量绑定到相同的相应组件（ADF 表中的结果集，结果集表上方标题中的 4 个 outputText 字段中的变量）。然后我为属性绑定添加了一个 Refresh="IfNeeded" 属性到迭代器。

现在我的 outputText 字段在 resultSet 更改的同时按预期刷新！

卡里姆

# regex - Delphi PCRE/regex 实现和堆栈溢出

> ID：13688064
> 
> 赞同：3
> 
> 时间：2012-12-03T16:58:29.730
> 
> 标签：regex, delphi, stack-overflow, pcre

我发现了一个案例，例如在正则表达式中使用 \w 时，带有空格的 500 个字母/数字会使 PCRE 爆炸。我已经尝试过 boh`TPerlRegEx`和 Delphi XE2 pcre/obj 实现。两者都一样。

然后我试着打电话

```
pcre_config(PCRE_CONFIG_MATCH_LIMIT, @vSysStrRegex_MatchLimit_Value); 
```

但是设置匹配限制似乎没有任何效果。我使用它的方式是为每个线程调用一次。（注意：其他人已经设置了这个以*获得*不*设置*这样的设置）

我真的需要正则表达式库退出解析而不是继续直到它溢出堆栈。（似乎几乎不可能从中恢复线程/程序。）

在这种情况下如何防止堆栈溢出？我无法控制解析的内容或正则表达式。因此，我专门寻找通过设置或类似设置避免 PCRE 陷入堆栈溢出的方法。

通过编辑 TPerlRegEx 代码的解决方案：

```
function TPerlRegEx.Match(AStartOffset: Integer = 0): Boolean;
...
if FHints <> nil then // set by "study" call
  begin
    PPCREExtra(FHints)^.flags := PPCREExtra(FHints)^.flags or PCRE_EXTRA_MATCH_LIMIT_RECURSION;
    PPCREExtra(FHints)^.match_limit_recursion := 750 // 1000 too much in tests
  end
;
OffsetCount := pcre_exec(FPattern, FHints, ...) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:24:44.530

您引用[了一些 PCRE 文档](http://www.pcre.org/pcre.txt)，这些文档描述了*在编译时*使用`--with-match-limit-recursion`配置选项设置递归限制。如果您自己构建 PCRE 库，则可以使用该选项。如果您在同一文档的其他地方阅读，您会发现传递给`match_limit_recursion`的块字段的描述：`pcre_extra``pcre_exec`

> `match_limit_recursion`构建PCRE时可以设置默认值；默认默认值与 的默认值相同`match_limit`。 您可以通过提供一个在其中设置和在 字段中设置`pcre_exec()` 的 `pcre_extra` 块 来覆盖默认值。如果超出限制，则返回。`match_limit_recursion``PCRE_EXTRA_MATCH_LIMIT_RECURSION``flags``pcre_exec()``PCRE_ERROR_RECURSIONLIMIT`

因此，将递归限制设置为低于默认值。默认值显然比您实际可用的堆栈空间还要高；如果它较低，那么您*已经*收到`PCRE_ERROR_RECURSIONLIMIT`错误而不是操作系统引发的堆栈溢出异常。

Delphi 特定的包装器如何表示这个设置，我不知道。

# svn - 如何从 eclipse juno 签出 maven mutlitmodule 项目

> ID：13688065
> 
> 赞同：0
> 
> 时间：2012-12-03T16:58:32.923
> 
> 标签：svn, maven, subclipse, eclipse-juno, multi-module

如果可能的话，我一直试图直接回答这个问题。我目前正在使用 Eclipse Juno / Subclipse / Sonaytype m2eclipse。我可以做什么（如果有的话）从 SVN 签出一个多模块项目，以便该项目在 Eclipse 中显示为单个项目？我注意到“支持映射到单个 Eclipse 工作区项目的多个 Maven 模块”选项在 Window->Preferences->Maven 选项列表中不再可用。现在，当我签出一个项目时，我将模块视为多个项目。或者在结帐后我应该做些什么来在一个项目视图下统一这些。

感谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:29:23.300

我在 juno/m2e/subclipse 支持中没有遇到过该选项。

如果是大型多模块，我会在外部进行结帐。仅导入要编辑/调试的项目。

如果它是一个简单的多模块，我 subclipse 的“Checkout As”选项。

# c# - 如何从数据库中提取gridview的headertext？

> ID：13688066
> 
> 赞同：1
> 
> 时间：2012-12-03T16:58:33.277
> 
> 标签：c#, asp.net, gridview, .net-2.0, headertext

所以这里是场景。我需要为我的gridview 从数据库中提取headertext。我将给出我想要从数据库中获得的给定字段的列名，因为我不需要显示从数据库到 gridview 的所有列。这是我到目前为止所得到的。这是aspx代码。

```
 <asp:GridView ID="gvCustProfile" runat="server" AllowPaging="True" DataKeyNames="custname" AutoGenerateColumns="False"
            BorderStyle="None" GridLines="Horizontal" HeaderStyle-HorizontalAlign="Left"
            ShowFooter="True" Width="125%"  AllowSorting="True"> 
```

这是我在CS文件中得到的。

```
gvCustProfile.Columns["ACTIVE_YN"].HeaderText = GetColNameFromDictionary(inputColName, profileTable); 
```

有什么方法可以从数据库中指定我想要的列名并获取它的文本值，因为我根本不想对其进行硬编码。我的代码将传递“ACTIVE_YN”之类的值，并将在字典中匹配（在数据库中），并向我返回对我传递的值的用户友好描述。

# android - Android Eclipse FC java.lang.NullPointerException？

> ID：13688067
> 
> 赞同：1
> 
> 时间：2012-12-03T16:58:38.147
> 
> 标签：android, eclipse

我对 Android 很陌生。我按照教程使用 PHP 和 MySQL 创建了一个登录屏幕......它在几天前工作......现在当我尝试运行该应用程序时，它给了我一个强制关闭错误和一个 Java.lang.NullPointerException.. .我猜这意味着一些不应该是空的东西？有人可以帮我吗？

这是我的 LogCat：

```
12-03 11:48:06.089: D/AndroidRuntime(13538): Shutting down VM
12-03 11:48:06.099: W/dalvikvm(13538): threadid=1: thread exiting with uncaught exception (group=0x2aac8560)
12-03 11:48:06.099: E/AndroidRuntime(13538): FATAL EXCEPTION: main
12-03 11:48:06.099: E/AndroidRuntime(13538): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.groupone.the.health.effect/com.groupone.the.health.effect.AndroidDashboardDesignActivity}: java.lang.NullPointerException
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1659)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1675)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.ActivityThread.access$1500(ActivityThread.java:121)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:943)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.os.Looper.loop(Looper.java:123)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.ActivityThread.main(ActivityThread.java:3701)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at java.lang.reflect.Method.invokeNative(Native Method)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at java.lang.reflect.Method.invoke(Method.java:507)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:862)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:620)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at dalvik.system.NativeStart.main(Native Method)
12-03 11:48:06.099: E/AndroidRuntime(13538): Caused by: java.lang.NullPointerException
12-03 11:48:06.099: E/AndroidRuntime(13538):    at com.groupone.the.health.effect.AndroidDashboardDesignActivity.onCreate(AndroidDashboardDesignActivity.java:92)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-03 11:48:06.099: E/AndroidRuntime(13538):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1623)
12-03 11:48:06.099: E/AndroidRuntime(13538):    ... 11 more 
```

这是我的 .AndroidDashboardDesignActivity：

```
package com.groupone.test;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class AndroidDashboardDesignActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.dashboard_layout);

        /**
         * Creating all buttons instances
         * */
        // Dash board News feed button
        Button btn_newsfeed = (Button) findViewById(R.id.btn_news_feed);

        // Dash board Friends button
        Button btn_friends = (Button) findViewById(R.id.btn_friends);

        // Dash board Messages button
        Button btn_messages = (Button) findViewById(R.id.btn_messages);

        // Dash board Places button
        Button btn_places = (Button) findViewById(R.id.btn_places);

        // Dash board Events button
        Button btn_events = (Button) findViewById(R.id.btn_events);

        // Dash board Photos button
        Button btn_photos = (Button) findViewById(R.id.btn_photos);

        /**
         * Handling all button click events
         * */

        // Listening to News Feed button click
        btn_newsfeed.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // Launching News Feed Screen
                Intent i = new Intent(getApplicationContext(), NewsFeedActivity.class);
                startActivity(i);
            }
        });

       // Listening Friends button click
        btn_friends.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // Launching News Feed Screen
                Intent i = new Intent(getApplicationContext(), AndroidFacebookConnectActivity.class);
                startActivity(i);
            }
        });

        // Listening Messages button click
        btn_messages.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // Launching News Feed Screen
                Intent i = new Intent(getApplicationContext(), MessagesActivity.class);
                startActivity(i);
            }
        });

        // Listening to Places button click
        btn_places.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // Launching News Feed Screen
                Intent i = new Intent(getApplicationContext(), MessagesActivity.class);
                startActivity(i);
            }
        });

        // Listening to Events button click
        btn_events.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // Launching News Feed Screen
                Intent i = new Intent(getApplicationContext(), MessagesActivity.class);
                startActivity(i);
            }
        });

        // Listening to Photos button click
        btn_photos.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // Launching News Feed Screen
                Intent i = new Intent(getApplicationContext(), PhotosActivity.class);
                startActivity(i);
            }
        });
    }
} 
```

这是我的布局：

```
!-- Your package folder -->
<com.groupone.the.health.effect.DashboardLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="1"
    android:background="#3b3b3b" >
    <!--  News Feed Button -->
    <Button
        android:id="@+id/btn_news_feed"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/healthbook"
        android:text="Activities" />

    <Button
        android:id="@+id/btn_messages"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/mental"
        android:text="Mental Input" />

    <!--  Events Button -->
    <Button
        android:id="@+id/btn_events"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/graph"
        android:text="Results" />

    <!--  Photos Button -->

    <!--  Friends Button -->
    <Button
        android:id="@+id/btn_friends"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/btn_facebook"
        android:text="Facebook" />

    <!--  Messages Button -->

    <!--  Places Button -->
    <Button
        android:id="@+id/btn_places"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/twitter_logo"
        android:text="Health Tweets" />

    <Button 
        android:id="@+id/btnLogout"
        style="@style/DashboardButton"
        android:drawableTop="@drawable/logout"
        android:text="Log Out"/>

</com.groupone.the.health.effect.DashboardLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:05:00.673

```
Button btn_photos = (Button) findViewById(R.id.btn_photos); 
```

此行导致问题，因为`R.id.btn_photos`当前布局 xml 中不存在按钮 ID。所以请确保您在 Activity 中使用正确的布局`setContentView(R.layout.dashboard_layout);`

# php - 多维会话数组

> ID：13688071
> 
> 赞同：2
> 
> 时间：2012-12-03T16:58:43.240
> 
> 标签：php, session, multidimensional-array, increment

我正在使用一种将数据从两个 MySQL 数据库中提取到单个动态页面中的表单。当用户单击添加到购物车时，我想将该数据存储在多维会话数组中，以便稍后在他们单击查看购物车时调用。我想知道当从添加到购物车表单添加新项目时如何自动增加项目的子集标识符（数组键？）。这是我到目前为止所拥有的：

```
$newitem = array ($row_getimages['icon'],$row_getimages['title'],$row_getshoppingcart['medium'],$row_getshoppingcart['size'],$row_getshoppingcart['price'],$row_getshoppingcart['shipping']);

session_start();

if(isset($_SESSION['item'][1]))
$_SESSION['item'][1] = $_SESSION['item'][1]+ 1;
else
$_SESSION['item'][1] = 1; 
```

以后调用数据的任何帮助也将不胜感激。由于用户可能在会话中存储了 1 或 20 个项目，因此我不确定如何确保所有项目都会得到回显，无论它们添加了多少。

这是我第一次参加多维数组和会议。显然，因为图像页面是动态的，并且购买价格取决于几个因素，所以像我过去那样只使用 MySQL 数据库是不可能的。

提前感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:01:39.263

如果数字顺序不重要，您可以使用：

```
$_SESSION['item'][] = array('a','b','c','d','e','f'); 
```

使用`[]`只会在数组末尾添加一个新元素。

但是，我可能会使用产品 ID 作为密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:05:30.147

```
$newitem = array ('id' => $row_getshoppingcart['id'] , 'icon' => $row_getimages['icon'],'title' => $row_getimages['title'],'medium' => $row_getshoppingcart['medium'],'size' => $row_getshoppingcart['size'],'price' => $row_getshoppingcart['price'],'shipping' => $row_getshoppingcart['shipping']);

session_start();

$_SESSION['item'][] = $newitem; 
```

如果我正确理解您的系统，这就是您所要做的。

**更新**

我更新了`$newitem`数组以包含数组键。您可以使用如下数组引用新项目信息：

> $_SESSION['item'][(num)]['id']

或者您可以像这样遍历结果：

```
foreach ( $_SESSION['item'] AS $item ) 
{  
 echo 'id: ' . $item['id'] . '<br />'; 
 echo 'title: ' . $item['title'];  
 // and so on 
} 
```

# mysql - 如何使用同一张表的子查询更新mysql中的表

> ID：13688072
> 
> 赞同：0
> 
> 时间：2012-12-03T16:58:43.003
> 
> 标签：mysql, ruby-on-rails

我有一个名为**my_data**的表，如下所示：

```
 +-------+-------+--------+
 | attr1 | attr2 | att3   |
 +-------+-------+--------+
 |   3   |   1   |    1   |
 |   4   |   2   |    1   |
 |   5   |   3   |    1   |
 |   3   |   6   |    1   |
 |   3   |   7   |    1   |
 |   3   |   8   |    1   |
 |   8   |   8   |    1   |
 |   9   |   7   |    1   |
 |   3   |   9   |    1   |
 +-------+-------+--------+ 
```

我需要这样做：

```
UPDATE my_data 
SET 
    attr3 = 0 
WHERE (attr1, attr2) IN (SELECT attr1, attr2 FROM my_data GROUP BY attr1); 
```

在 mysql 中，更新不适用于其中的 select 语句。还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:10:58.863

您可以使用内部查询加入 my_data 并更新 attr3，如下所示：

```
UPDATE my_data a
JOIN (SELECT attr1, attr2 FROM my_data GROUP BY attr1) b
ON a.attr1 = b.attr1 AND a.attr2 = b.attr1
SET a.attr3 = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:41:44.870

盯着上面的数据，我猜你想为任何有多个值的更新`attr3`为 0 。`attr1``attr2`

如果是这种情况，查询应该计算有多少`attr2`：

```
UPDATE
    (SELECT attr1,COUNT(attr2) attr2count FROM my_data
    GROUP BY attr1 HAVING COUNT(attr2) > 1) A
    INNER JOIN my_data B USING (attr1)
SET B.attr3 = 0; 
```

我之所以选择`SELECT ... GROUP BY ... HAVING`是因为它更稳定，因为它`SELECT attr1, attr2 FROM my_data GROUP BY attr1`只是被复制`attr2`的数字之一。`attr1`

根据 MySQL 文档`GROUP BY`，[不能保证 mysql 在使用时选择哪个值`GROUP BY`](http://dev.mysql.com/doc/refman/5.5/en/group-by-extensions.html)。

[**我在 DBA StackExchange 中回答了一个关于这种有争议的对`GROUP BY`.**](https://dba.stackexchange.com/a/29321/877)

如果您确定您希望`attr1=3`最小的行将`attr2`attr3 设置为 0，那么您的问题的答案将是：

```
UPDATE
    (SELECT attr1,MIN(attr2) attr2 FROM my_data
    GROUP BY attr1 HAVING COUNT(attr2) > 1) A
    INNER JOIN my_data B USING (attr1,attr2)
SET B.attr3 = 0; 
```

让我们测试它们：

# 测试第一个查询

首先是示例数据：

```
drop database if exists clickit;
create database clickit;
use clickit
create table my_data (attr1 INT,attr2 INT,attr3 INT);
insert into my_data values
(3,1,1),(4,2,1),(5,3,1),
(3,6,1),(3,7,1),(3,8,1),
(8,8,1),(9,7,1),(3,9,1); 
```

这是加载的示例数据：

```
mysql> drop database if exists clickit;
Query OK, 1 row affected (0.12 sec)

mysql> create database clickit;
Query OK, 1 row affected (0.00 sec)

mysql> use clickit
Database changed
mysql> create table my_data (attr1 INT,attr2 INT,attr3 INT);
Query OK, 0 rows affected (0.07 sec)

mysql> insert into my_data values
    -> (3,1,1),(4,2,1),(5,3,1),
    -> (3,6,1),(3,7,1),(3,8,1),
    -> (8,8,1),(9,7,1),(3,9,1);
Query OK, 9 rows affected (0.05 sec)
Records: 9  Duplicates: 0  Warnings: 0

mysql> select * from my_data;
+-------+-------+-------+
| attr1 | attr2 | attr3 |
+-------+-------+-------+
|     3 |     1 |     1 |
|     4 |     2 |     1 |
|     5 |     3 |     1 |
|     3 |     6 |     1 |
|     3 |     7 |     1 |
|     3 |     8 |     1 |
|     8 |     8 |     1 |
|     9 |     7 |     1 |
|     3 |     9 |     1 |
+-------+-------+-------+
9 rows in set (0.00 sec)

mysql> 
```

这是我建议的第一个查询：

```
mysql>     UPDATE
    ->         (SELECT attr1,COUNT(attr2) attr2count FROM my_data
    ->         GROUP BY attr1 HAVING COUNT(attr2) > 1) A
    ->         INNER JOIN my_data B USING (attr1)
    ->     SET B.attr3 = 0;
Query OK, 5 rows affected (0.10 sec)
Rows matched: 5  Changed: 5  Warnings: 0

mysql>     select * from my_data;
+-------+-------+-------+
| attr1 | attr2 | attr3 |
+-------+-------+-------+
|     3 |     1 |     0 |
|     4 |     2 |     1 |
|     5 |     3 |     1 |
|     3 |     6 |     0 |
|     3 |     7 |     0 |
|     3 |     8 |     0 |
|     8 |     8 |     1 |
|     9 |     7 |     1 |
|     3 |     9 |     0 |
+-------+-------+-------+
9 rows in set (0.00 sec)

mysql> 
```

对于具有多行的 attr1，第一个将 attr3 更改为 0

# 测试第二个查询

让我们重新加载示例并运行第二个查询：

```
mysql> drop database if exists clickit;
Query OK, 1 row affected (0.04 sec)

mysql> create database clickit;
Query OK, 1 row affected (0.00 sec)

mysql> use clickit
Database changed
mysql> create table my_data (attr1 INT,attr2 INT,attr3 INT
Query OK, 0 rows affected (0.07 sec)

mysql> insert into my_data values
    -> (3,1,1),(4,2,1),(5,3,1),
    -> (3,6,1),(3,7,1),(3,8,1),
    -> (8,8,1),(9,7,1),(3,9,1);
Query OK, 9 rows affected (0.05 sec)
Records: 9  Duplicates: 0  Warnings: 0

mysql> select * from my_data;
+-------+-------+-------+
| attr1 | attr2 | attr3 |
+-------+-------+-------+
|     3 |     1 |     1 |
|     4 |     2 |     1 |
|     5 |     3 |     1 |
|     3 |     6 |     1 |
|     3 |     7 |     1 |
|     3 |     8 |     1 |
|     8 |     8 |     1 |
|     9 |     7 |     1 |
|     3 |     9 |     1 |
+-------+-------+-------+
9 rows in set (0.00 sec)

mysql>     UPDATE
    ->         (SELECT attr1,MIN(attr2) attr2 FROM my_data
    ->         GROUP BY attr1 HAVING COUNT(attr2) > 1) A
    ->         INNER JOIN my_data B USING (attr1,attr2)
    ->     SET B.attr3 = 0;
Query OK, 1 row affected (0.06 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from my_data;
+-------+-------+-------+
| attr1 | attr2 | attr3 |
+-------+-------+-------+
|     3 |     1 |     0 |
|     4 |     2 |     1 |
|     5 |     3 |     1 |
|     3 |     6 |     1 |
|     3 |     7 |     1 |
|     3 |     8 |     1 |
|     8 |     8 |     1 |
|     9 |     7 |     1 |
|     3 |     9 |     1 |
+-------+-------+-------+
9 rows in set (0.00 sec)

mysql> 
```

试试看 ！！！

# asp.net - 如何撤消 Windows Workflow Foundation 中的上一步？

> ID：13688076
> 
> 赞同：0
> 
> 时间：2012-12-03T16:58:47.777
> 
> 标签：asp.net, sql-server-2008, workflow-foundation-4

我有一个使用 Windows 工作流的项目，并且我在 SQL Server 2008 中有一个带有工作流表的数据库。

我想在项目中编辑记录，所以想无条件返回到以前的活动，并更新数据库中的工作流实例。

如何撤消 Windows Workflow Foundation 中的上一步？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T18:23:20.657

并不真地。有一点如果 hack 虽然这可能有用。当您使用工作流实例存储并告诉工作流在发生未处理的异常时放弃其状态时，实例存储中最后保存的状态保持不变。因此，您可以从该状态重新加载工作流并继续，就好像下一个活动从未执行过一样。问题在于控制工作流程何时持续存在。在大多数情况下，您可以控制它，但在某些情况下，工作流将始终持续存在。

# c# - SendAsync 运行，但数据并未真正发送

> ID：13688078
> 
> 赞同：2
> 
> 时间：2012-12-03T16:58:51.647
> 
> 标签：c#, asyncsocket, sendasync

[我有一个使用 *Async 方法（如SendAsync](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.sendasync.aspx) ）通过套接字进行通信的应用程序。我在执行 SendAsync 但未通过网络发送数据时遇到这种奇怪的行为。

我已启用网络跟踪并获得以下日志：

```
System.Net.Sockets Verbose: 0 : [4300] Socket#5024928::SendAsync()
System.Net.Sockets Verbose: 0 : [4300] Socket#5024928::SendAsync(Boolean#1)
System.Net.Sockets Verbose: 0 : [7320] Data from Socket#5024928::FinishOperation(SendAsync)
System.Net.Sockets Verbose: 0 : [7320] 00000E8C : 01 99 27 00 00 00 01 00-00 00 00 00 00 00 00 00 : ..'.............
System.Net.Sockets Verbose: 0 : [7320] 00000E9C : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 : ................
System.Net.Sockets Verbose: 0 : [7320] 00000EAC : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 : ................
System.Net.Sockets Verbose: 0 : [7320] 00000EBC : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 : ................
System.Net.Sockets Verbose: 0 : [7320] 00000ECC : 00 00 B3 F4                                     : ....
System.Net.Sockets Verbose: 0 : [7320] Socket#5024928::ReceiveAsync()
System.Net.Sockets Verbose: 0 : [7320] Exiting Socket#5024928::ReceiveAsync()   -> Boolean#1
System.Net.Sockets Error: 0 : [7320] Socket#5024928::UpdateStatusAfterSocketError() - TimedOut 
```

尽管跟踪显示数据已发送（并且发生了接收超时），但数据并未真正发送。我已经检查了 Microsoft 的网络监视器，并且没有发送此数据的日志。

send 方法非常简单：

```
 public void Send(AsyncClientState state, byte[] data) {
            var socket = state.Socket;
            var dataTransferredEventArgs = new DataTransferredEventArgs(data, _maxBytes) { State = state };
            state.Events.RaiseBeforeSend(dataTransferredEventArgs);
            byte[] bytesToSend = dataTransferredEventArgs.Bytes.ToArray();
            SocketAsyncEventArgs args = GetSocketAsyncEventArgsArgs(socket, bytesToSend.Length);
            if (args == null) {
                state.Events.RaiseTimeout(Operation.Send);
                return;
            }
            args.Completed += SendCompleted;
            args.UserToken = state;
            Buffer.BlockCopy(bytesToSend, 0, args.Buffer, args.Offset, bytesToSend.Length);
            bool sendAsync = socket.SendAsync(args);
            if (!sendAsync) {
                SendCompleted(this, args);
            }
        }

        private void SendCompleted(object sender, SocketAsyncEventArgs e) {
            var state = (AsyncClientState) e.UserToken;
            var events = state.Events;
            try {
                if (e.SocketError != SocketError.Success) {
                    events.RaiseError(new ErrorEventArgs("(SendSocketError)" + e.SocketError));
                    return;
                }
                if (e.LastOperation == SocketAsyncOperation.Send) {
                    e.Completed -= SendCompleted;
                    _asyncEventArgsPool.PutBack(e);
                    events.RaiseAfterSend(new StateEventArgs(state));
                }
            }
            catch (ObjectDisposedException) { }
            catch (SocketException ex) {
                events.RaiseError(new ErrorEventArgs(string.Format("{0}: {1}", ex.SocketErrorCode, ex.Message)));
            }
        } 
```

我在这里错过了什么吗？网络追踪真的可靠吗？

**更新**

我尝试使用 Begin/End*，但仍然是同样的问题。这是跟踪：

```
System.Net.Sockets Verbose: 0 : [6632] Socket#29357909::BeginSend()
System.Net.Sockets Verbose: 0 : [6632] Exiting Socket#29357909::BeginSend()     -> OverlappedAsyncResult#30136159
System.Net.Sockets Verbose: 0 : [6500] Data from Socket#29357909::PostCompletion
System.Net.Sockets Verbose: 0 : [6500] 00000000 : 01 99 27 00 00 00 01 00-00 00 00 00 00 00 00 00 : ..'.............
System.Net.Sockets Verbose: 0 : [6500] 00000010 : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 : ................
System.Net.Sockets Verbose: 0 : [6500] 00000020 : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 : ................
System.Net.Sockets Verbose: 0 : [6500] 00000030 : 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 : ................
System.Net.Sockets Verbose: 0 : [6500] 00000040 : 00 00 B3 F4                                     : ....
System.Net.Sockets Verbose: 0 : [6500] Socket#29357909::EndSend(OverlappedAsyncResult#30136159)
System.Net.Sockets Verbose: 0 : [6500] Exiting Socket#29357909::EndSend()   -> Int32#68
System.Net.Sockets Verbose: 0 : [6500] Socket#29357909::BeginReceive()
System.Net.Sockets Verbose: 0 : [6500] Exiting Socket#29357909::BeginReceive()  -> OverlappedAsyncResult#63504289
System.Net.Sockets Verbose: 0 : [6500] Socket#29357909::EndReceive(OverlappedAsyncResult#63504289)
System.Net.Sockets Error: 0 : [6500] Socket#29357909::UpdateStatusAfterSocketError() - TimedOut
System.Net.Sockets Error: 0 : [6500] Exception in Socket#29357909::EndReceive - A connection attempt failed because the connected party did not properly respond after a period of time or established connection failed because connected host has failed to respond.
System.Net.Sockets Verbose: 0 : [6500] Exiting Socket#29357909::EndReceive()    -> Int32#0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T12:09:55.983

在与我们的网络管理员交谈后，我们发现问题是网络配置错误。我没有“进入”网络，但问题与我正在通信的设备进入我们的 DMZ 的事实有关。

# javascript - 日期验证 mvc3 导致问题

> ID：13688079
> 
> 赞同：1
> 
> 时间：2012-12-03T16:58:55.920
> 
> 标签：javascript, asp.net-mvc

我希望能够验证输入的生日是否为 18 岁或以上。我已经搜索并找到了许多关于此的帖子。然而，我不明白

1）为什么 MS 没有像其他验证（如字符串、电子邮件、密码等）一样将其构建到 MVC3 中。 2）为什么当我使用 javascript 来正确验证日期时，其他不引人注目的 js 不起作用不再。

我想在提交之前进行客户端验证，日期似乎不适用于此。其余的都可以。

我错过了什么吗？

我在模型中尝试过的一些代码

```
 #1)    [Display(Name = "Date of Birth (must be at least 18) ")]
    public DateTime Birthdate
    {
        get
        {
            if ((SelectedBMonth != "0") && (SelectedBday != "0") && (SelectedBYear != "0"))
                return DateTime.Parse(SelectedBMonth + "/" + SelectedBday + "/" + SelectedBYear);
            else 
                return DateTime.MinValue;
        }
    }

    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        if (Birthdate.Date > DateTime.Today.AddYears(-18)) 
            yield return new ValidationResult("You must be at least 18 years old to register", new[] { "Birthdate" });
    }
#2)
         [Required]        
    [CustomValidation(typeof(RegisterModel), "ValidateDOBDate")] 
    [DataType(DataType.Date)]
    [Display(Name = "Date of Birth")]        
    public DateTime DateOfBirth { get; set; }

    public static ValidationResult ValidateDOBDate(DateTime DateOfBirthtovalidate) { if (DateOfBirthtovalidate.Date > DateTime.Now.AddYears(-18)) { return new ValidationResult("User should be atleast 18 years old."); } if (DateOfBirthtovalidate.Date < DateTime.Now.AddYears(-150)) { return new ValidationResult("Please put a valid date"); } return ValidationResult.Success; } 

#3)
       public class DateofBirthAttribute : ValidationAttribute, IClientValidatable
    {
        public override bool IsValid(object value)
        {
            if (value == null || (DateTime)value < DateTime.Today.AddYears(-18))
                return false;

            return true;
        }

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
        {
            yield return new ModelClientValidationRule
            {
                ErrorMessage = this.ErrorMessage,
                ValidationType = "dateofbirth"
            };
        }
    }

    [Required]
    [Display(Name = "Date of Birth")]
    [DateofBirth(ErrorMessage = "User must be at least 18")]
    public DateTime Birthdate { get; set; }

View : 

 <div class="editor-label">
            @Html.LabelFor(m => m.Birthdate)
        </div>
        <div class="editor-field">                
        @Html.TextBoxFor(x => x.Birthdate)
@Html.ValidationMessageFor(x => x.Birthdate)
</div>

Top of view before beginform:
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript">    </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"    type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/MyScripts.js")" type="text/javascript"></script>
<script type="text/javascript">
// we add a custom jquery validation method
jQuery.validator.addMethod('greaterThan', function (value, element, params) {
    if (!/Invalid|NaN/.test(new Date(value))) {
        return new Date(value) > new Date($(params).val());
    }
    return isNaN(value) && isNaN($(params).val()) || (parseFloat(value) > parseFloat($(params).val()));
}, '');

// and an unobtrusive adapter
jQuery.validator.unobtrusive.adapters.add('dateofbirth', {}, function (options) {
    options.rules['greaterThan'] = true;
    options.messages['greaterThan'] = options.message;
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:51:58.267

这是一个取决于当前日期的动态验证，并且在默认验证选项中不可用。

您可以轻松实现它，但不会生成客户端验证。

您还必须实现客户端 javascript 验证。

有关向 ASP.NET MVC 添加新验证的更多信息，请查看此[ASP .Net MVC 3 unobtrusive custom client validation](https://stackoverflow.com/questions/4833280/asp-net-mvc-3-unobtrusive-custom-client-validation)。

# jquery - Infragistics Jquery Grid onLoad

> ID：13688080
> 
> 赞同：1
> 
> 时间：2012-12-03T16:58:57.387
> 
> 标签：jquery, infragistics, ignite-ui, iggrid

我正在加载一个 Infragistics 网格。加载时，我有一个模板列需要检查数据集中的另一个值，然后才知道要加载什么。看起来 Infragistics 不会让我这样做，所以我需要在加载网格后在网格上运行查询以隐藏/显示某些信息。

例如：

我的网格：

```
 $("#divGrid").igGrid({
            columns: [
                {
                    headerText: "",
                    width: "70px",
                    key: "Division",
                    template: ProperRights.GetTemplate("${Division}")
                }
            ],
            primaryKey: "EmployeeNumber",
            autoGenerateColumns: false,
            dataSource: AccountAdministrationGrid.GetGridData()
        }); 
```

我的 js 模板逻辑：

```
 var ProperRights = new function () {
    this.GetTemplate = function(division) {
        if (division === 'DIV1') {
            return 'Special Stuff';
        } else {
            return "Boring Stuff";
        }
    };
}; 
```

这就是我想做的，但 ProperRights.GetTemplate 只返回 ${Division} 而不是网格行值。

所以我的下一个方法是在网格的末尾添加一个 .ready() 。然后遍历每个 td 并从行中提取值并手动更改第一列中的值，如下所示：

```
.ready(function () {
    $("td").each(function () {
        var id = $(this).text();
        console.log(id);
    });
}); 
```

但这也不起作用，它会不断回来，因为发现 0 td 就像网格尚未加载一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T09:29:59.750

在这种情况下，我建议使用 Infragistics 的模板引擎来为您的列创建条件模板。一些有用的资源提供了 igGrid 的模板引擎和条件行模板的概述，特别是可以在以下位置找到：

[http://help.infragistics.com/Help/NetAdvantage/jQuery/2012.2/CLR4.0/html/Creating_Conditional_Template_Containing_Default%20Statement.html](http://help.infragistics.com/Help/NetAdvantage/jQuery/2012.2/CLR4.0/html/Creating_Conditional_Template_Containing_Default%20Statement.html)

[http://www.infragistics.com/products/jquery/sample/template-engine/conditional-row-template](http://www.infragistics.com/products/jquery/sample/templating-engine/conditional-row-template)

在您的特定情况下，您可以尝试类似的操作：

```
 var ProperRightsTemplate = '{{if ${Division} == "Div1" }} <span> Some Value </span>';
        ProperRightsTemplate += '{{else}} <span> Some boring stuff </span> {{/if}}'; 
```

希望这可以帮助。

# regex - 带有空格的电话号码的正则表达式

> ID：13688082
> 
> 赞同：0
> 
> 时间：2012-12-03T16:59:04.487
> 
> 标签：regex

> **可能重复：**
> [用于电话号码验证的综合正则表达式](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)

我正在尝试为电话号码整理一些正则表达式模式，但是我的正则表达式经验几乎为零。

首先，这里是我的家庭电话号码

```
^0[12]\d{8,9}$ 
```

效果很好，但我想做的是允许空格（最多 2 个）。

那里有正则表达式大师吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:05:53.423

我建议您**通过剥离非数字来验证电话号码**。并**通过以短信形式发送确认码进行验证**。[我使用twilio](http://twilio.com)验证订户电话号码。我向该号码发送了一个代码，用户必须输入它来验证。这就是验证过程。在将其插入数据库之前，我使用以下代码。

```
$dnum = preg_replace('/\D+/','', $num);
if(preg_match('/^[\d()\s-]+$/', $num) 
    && in_array(strlen($dnum), array(7,10,11,13)){
// valid phone number
}else{
// invalid phone number
} 
```

这段代码的作用是，

1.  去除所有非数字字符
2.  检查允许的字符。只`()-`允许作为非数字字符。
3.  剥线后检查长度。它应该是 7 或 10 或 11 或 13。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:05:38.120

PHP 中的示例，其中剩余的字符串仅由数字和空格字符组成。（对于美国）

```
$output = preg_replace('/[^\d\s]/', '', $str); 
```

# python - 为什么那个版本的归并排序更快

> ID：13688084
> 
> 赞同：7
> 
> 时间：2012-12-03T16:59:14.467
> 
> 标签：python, mergesort

基于[这个答案](https://stackoverflow.com/a/7064487/381130)，这里有两个版本的用于合并排序的合并函数。你能帮我理解为什么第二个更快。我已经测试了它的 50000 列表，第二个快 8 倍（[要点](https://gist.github.com/4196181)）。

```
def merge1(left, right):
    i = j = inv = 0
    merged = []
    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            merged.append(left[i])
            i += 1
        else:
            merged.append(right[j])
            j += 1
            inv += len(left[i:])

    merged += left[i:]
    merged += right[j:]
    return merged, inv 
```

.

```
def merge2(array1, array2):
    inv = 0
    merged_array = []
    while array1 or array2:
        if not array1:
            merged_array.append(array2.pop())
        elif (not array2) or array1[-1] > array2[-1]:
            merged_array.append(array1.pop())
            inv += len(array2)
        else:
            merged_array.append(array2.pop())
    merged_array.reverse()
    return merged_array, inv 
```

这是排序功能：

```
def _merge_sort(list, merge):
    len_list = len(list)
    if len_list < 2:
        return list, 0
    middle = len_list / 2
    left, left_inv   = _merge_sort(list[:middle], merge)
    right, right_inv = _merge_sort(list[middle:], merge)
    l, merge_inv = merge(left, right)
    inv = left_inv + right_inv + merge_inv
    return l, inv 
```

.

```
import numpy.random as nprnd
test_list = nprnd.randint(1000, size=50000).tolist()

test_list_tmp = list(test_list) 
merge_sort(test_list_tmp, merge1)

test_list_tmp = list(test_list) 
merge_sort(test_list_tmp, merge2) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T17:56:45.830

[与上述kreativitea](https://stackoverflow.com/a/13688540/432913)类似的答案，但有更多信息（我认为！）

所以剖析实际的合并函数，用于合并两个 50K 数组，

### 合并 1

```
 311748 function calls in 15.363 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001   15.363   15.363 <string>:1(<module>)
        1   15.322   15.322   15.362   15.362 merge.py:3(merge1)
   221309    0.030    0.000    0.030    0.000 {len}
    90436    0.010    0.000    0.010    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

### 合并2

```
 250004 function calls in 0.104 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001    0.104    0.104 <string>:1(<module>)
        1    0.074    0.074    0.103    0.103 merge.py:20(merge2)
    50000    0.005    0.000    0.005    0.000 {len}
   100000    0.010    0.000    0.010    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
   100000    0.014    0.000    0.014    0.000 {method 'pop' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'reverse' of 'list' objects} 
```

所以对于 merge1，它是 221309 `len`、 90436 `append`，需要 15.363 秒。所以对于 merge2，它是 50000 `len`、 100000`append`和 100000`pop`并且需要 0.104 秒。

`len`并且`append` `pop`都是 O(1)（更多信息[在这里](http://wiki.python.org/moin/TimeComplexity)），所以这些配置文件并没有显示实际花费的时间，因为只是这样，它应该更快，但只有 ~20%。

## 好吧，如果您只是阅读代码，原因实际上是相当明显的：

在第一种方法中，有这一行：

```
inv += len(left[i:]) 
```

所以每次调用时，它都必须重建一个数组。如果您注释掉这一行（或者只是将其替换为`inv += 1`或其他内容），那么它会比其他方法更快。这是导致时间增加的单行。

注意到这是原因后，可以通过改进代码来解决问题；将其更改为此以加快速度。这样做之后，它会比`merge2`

```
inv += len(left) - i 
```

### 将其更新为：

```
def merge3(left, right):
    i = j = inv = 0
    merged = []
    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            merged.append(left[i])
            i += 1
        else:
            merged.append(right[j])
            j += 1
            inv += len(left) - i

    merged += left[i:]
    merged += right[j:]
    return merged, inv 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T17:27:28.923

您可以使用出色的 cProfile 模块来帮助您解决此类问题。

```
>>> import cProfile
>>> a = range(1,20000,2)
>>> b = range(0,20000,2)
>>> cProfile.run('merge1(a, b)')
         70002 function calls in 0.195 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.184    0.184    0.195    0.195 <pyshell#7>:1(merge1)
        1    0.000    0.000    0.195    0.195 <string>:1(<module>)
    50000    0.008    0.000    0.008    0.000 {len}
    19999    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

>>> cProfile.run('merge2(a, b)')
         50004 function calls in 0.026 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.016    0.016    0.026    0.026 <pyshell#12>:1(merge2)
        1    0.000    0.000    0.026    0.026 <string>:1(<module>)
    10000    0.002    0.000    0.002    0.000 {len}
    20000    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
    20000    0.005    0.000    0.005    0.000 {method 'pop' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'reverse' of 'list' objects} 
```

稍微看了一下信息，看起来评论者是正确的——它不是 len 函数——它是字符串模块。比较事物的长度时会调用字符串模块，如下所示：

```
>>> cProfile.run('0 < len(c)')
         3 function calls in 0.000 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 {len}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

切片列表时也会调用它，但这是一个*非常*快速的操作。

```
>>> len(c)
20000000
>>> cProfile.run('c[3:2000000]')
         2 function calls in 0.011 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.011    0.011    0.011    0.011 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

**TL;DR：字符串模块中的某些内容在您的第一个函数中花费了 0.195 秒，在您的第二个函数中花费了 0.026 秒。**：显然，在`inv += len(left[i:])`这一行中重建数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:55:40.240

如果我不得不猜测，我会说这可能与从列表中删除元素的成本有关，从末尾删除（pop）比从开头删除要快。第二个有利于从列表末尾删除元素。

请参阅性能说明： [http ://effbot.org/zone/python-list.htm](http://effbot.org/zone/python-list.htm)

“移除一个项目所需的时间与在同一位置插入一个项目所需的时间大致相同；最后移除项目快，开头移除项目慢。”

# java - 在不使用 If 或 Break 的情况下中断 while 循环

> ID：13688085
> 
> 赞同：1
> 
> 时间：2012-12-03T16:59:20.460
> 
> 标签：java, if-statement, while-loop, break

我需要创建一个使用 while 来查找圆柱体体积的程序。如果用户输入高度的负值，我需要中断 while 循环。我的代码如下所示：

```
double sentinel=1, h=1, v=0, r, count=0; // declares all variables needed
    final double PI=3.14159;
    boolean NotNegative=true;

while(NotNegative){// && count==0){ // while both the height is positive AND the total times run is 0
        System.out.print("Enter height (Use negative to exit): "); // has the user input the height
        h=Double.parseDouble(br.readLine());
        sentinel=h; // save sentinel as the inputted height

        while(sentinel>0){

           System.out.print("Enter radius: "); // have the user input the radius
           r=Double.parseDouble(br.readLine());
           v=PI*(r*r)*h; // find the volume
           System.out.println("The volume is " + v); // print out the volume
           count++; // increase the count each time this runs
           NotNegative=true;
           sentinel=-1;
        }
    } 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:01:52.207

您可以抛出您捕获并忽略的异常。这是个坏主意，因为

*   if 和/或 break 更高效、更简单。
*   很慢
*   这令人困惑。

但是，由于您使用的是 while 循环，就像使用 if & break 一样，您可以执行以下操作。

```
NotNegative = h >= 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:10:38.660

`while(NotNegative){`读取输入后，在中添加以下代码。

```
NotNegative = h >= 0; 
```

# dynamics-crm-2011 - 向 Outlook CRM 2011 功能区添加导航按钮

> ID：13688086
> 
> 赞同：0
> 
> 时间：2012-12-03T16:59:24.970
> 
> 标签：dynamics-crm-2011, dynamics-crm

我目前正在使用适用于 CRM 2011 的可视功能区编辑器，并且我正在尝试向 Outlook 客户端功能区（不是 Web 客户端）添加一个按钮，以加载 CRM 的“帐户”部分（不是模式，而是它通常如何加载主窗格中的帐户）Outlook 中的选项卡式部分如下图所示。

我不必使用编辑器，并且可以使用解决方案，但我不确定我需要什么样的命令来更新主窗格以及使用可视化工具或手动解决方案。

![帐户选项卡式界面](../Images/d0de3902d01cfd8c092ab29d4b749146.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T16:17:01.507

更新 HomePageGrid 功能区 XML。
Gareth Tucker 写了一个很棒的教程来向表单功能区添加一个按钮
（只需将它说的 Mscrm.Form 修改为 Mscrm.HomePageGrid）：
[http ://garethtuckercrm.com/2011/01/18/how-to-view-功能区定义-crm-2011-3/](http://garethtuckercrm.com/2011/01/18/how-to-view-ribbon-definitions-in-crm-2011-3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T07:40:30.493

不确定它是否在主题上，所以请随意丢弃它。我不会难过的。

有一个很棒的工具叫做[Ribbon Workbech](http://www.develop1.net/public/page/Ribbon-Workbench-for-Dynamics-CRM-2011.aspx)。他们甚至有一段视频展示了如何做事，这对于一个复杂的软件和懒惰的人来说是完美的……hrmp……忙碌的人。

[这里](http://ribbonworkbench.uservoice.com/knowledgebase/articles/71374-1-getting-started-with-the-ribbon-workbench)还有更多信息。看一看。

# javascript - 使用 sencha 应用程序在 Iphone 中的连接状态

> ID：13688088
> 
> 赞同：1
> 
> 时间：2012-12-03T16:59:24.610
> 
> 标签：javascript, ios, sencha-touch

我是sencha的新手，使用sencha touch 2.0开发了一个兼容IOS的app。有一个功能，比如在手机中使用应用程序时，没有连接时我需要显示警报。我尝试使用 window.navigator.onLine。但它在浏览器中工作而不是在 Iphone 中。请让我知道还有其他方法可以使用 sencha 的库来实现吗？甚至`navigator.network.isReachable("http://www.google.com", reachableCallback, {});`不工作。

你能帮忙吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-28T04:38:53.600

在 Sencha touch 2.2 中，我尝试了 Ext.device.Connection.isOnline()，但它总是在离线/在线时返回 true。所以我尝试了这个

```
navigator.onLine 
```

它在我的 ipad 中为我工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T17:32:50.187

您可能可以使用

```
Ext.device.Connection.isOnline() 
```

更多信息在这里[http://docs.sencha.com/touch/2-0/#!/api/Ext.device.Connection](http://docs.sencha.com/touch/2-0/#!/api/Ext.device.Connection)

# java - 休眠实体中的自关系与关系上的属性

> ID：13688089
> 
> 赞同：0
> 
> 时间：2012-12-03T16:59:38.540
> 
> 标签：java, hibernate

我有一个 A 类。每个 A 像 a1 都与其他 A 像 a2 相似，具有相似性 s1_2 所以我设计了一个这样的类：

```
class A{
    // some properties + id

    Map<A,double> semilars;

} 
```

我如何在 semilars 属性上放置休眠注释来构建这样的表：

```
|       table A       |
-----------------------
|id| other properties | 
```

和

```
|  similarity   table    |
--------------------------
| id1 | id2 | similarity | 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-03T19:56:46.547

我找到了 ！！！

只需 @ElementCollection 即可解决问题！快乐编码。

# .net - 如何使用 UI 自动化库计算按钮单击时 UIElement/FrameworkElement 的加载时间？

> ID：13688096
> 
> 赞同：1
> 
> 时间：2012-12-03T17:00:08.447
> 
> 标签：.net, wpf, ui-automation, uielement, frameworkelement

我的应用程序有一个按钮，可以即时创建`UIElement`/ `FrameworkElement`。

我想使用 UI 自动化库单击按钮以显示元素。我的问题我想计算`UIElement`/`FrameworkElement`显示或创建所需的时间。

这是否可以使用 Microsoft 提供的 UI 自动化库，我该如何实现？

我知道使用编码的 UI 测试我可以使用 WaitForControlReady() 但是有没有办法使用 UI 自动化库来做到这一点？编码 UI 测试不适用于所有自定义控件。

# javascript - objectjquery ajaxUPD 成功返回未定义

> ID：13688097
> 
> 赞同：1
> 
> 时间：2012-12-03T17:00:11.540
> 
> 标签：javascript, jquery, ajax

我创建了一个名为**save**的函数，当我调用**save**函数时，我得到了 undefined 或 object Object 的成功

更新：更新以获取 ajax 返回的 jqxhr 对象的值

```
function save() {
 return   $.ajax({
        type: "POST",
        url: "foo.json",
        data: json_data,
        contentType: 'application/json',
        success: function (data, textStatus, xhr) {

            $('<div id="loading">Loading...</div>').insertBefore('#form');

        },

        error: function (jqXHR, textStatus, errorThrown) {

        }
    });

}

$(document).ready(function () {

$(function () {
 $("#save").click(function () {
     var jqxhr = save();
     alert("success " + jqxhr.success);
     alert("status " + jqxhr.status);
     alert("status " + jqxhr.readyState);
 });
});

 }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T17:01:07.750

第十次。

ajax 是异步的。

使用回调函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:02:34.313

*Ninja 由 OP 编辑*
~~​​ 首先，`return`您的函数中没有语句`save`，因此它通过返回`undefined`值按预期工作。~~

其次，它不会那样工作。您需要返回`$.ajax`调用（它本身返回一个`jqXHR object`，您可以在其中挂钩并设置不同事件的代码。毕竟，默认情况下，*Ajax 请求*运行*asyncronously*。

**在保存（）**

```
return $.ajax({ ... 
```

**然后...**

```
save().done(function( retValue ) {
    alert('success ' + retValue);
}); 
```

[在此处](http://api.jquery.com/category/ajax/)和[此处](http://api.jquery.com/category/deferred-object/)了解有关*jQuerys Ajax*和*Deferred 对象* 的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:14:44.420

可能这是导致问题的原因，因为我看到您有 2 个文档就绪处理程序一个接一个。

```
/***/
 $(function () { // <--------------------I think this doesn't has to be here, 
                 //                      so remove it and try if this solves 
                 //                      the issue
     $("#save").click(function () {

         var success = save();
         alert("success " + success);

     });
 }); // <-------------------------------and this one too 
```

# android - 使用 DPAD 在编辑窗口中选择文本

> ID：13688104
> 
> 赞同：1
> 
> 时间：2012-12-03T17:00:32.483
> 
> 标签：android

我正在使用 DPAD 控件突出显示 android text-widget 中的文本。

我想知道当我突出显示文本时是否有任何方法，它也会选择它。现在，当我突出显示并尝试带上上下文菜单时，我得到的第一个上下文菜单是具有选择单词、全选等选项的上下文菜单，当我选择单词时，它会选择突出显示的整个区域（没关系，但我希望它在突出显示时选择）以便我可以直接获取剪切/复制和粘贴上下文菜单。

# xcode - 获取单选按钮值xcode 4 applescript

> ID：13688106
> 
> 赞同：0
> 
> 时间：2012-12-03T17:00:39.323
> 
> 标签：xcode, xcode4, applescript, osx-mountain-lion

所有，当单击“安装”按钮时，我有一个运行 shell 命令（根据用户输入设置主机名）的 cocoa-applescript 应用程序：

```
on InstallButton_(sender)
    set hostName to ""
    set hostName to textField's stringValue as string
    do shell script ("/usr/sbin/scutil --set HostName " & hostName) with administrator privileges
    do shell script ("/usr/sbin/scutil --set ComputerName " & hostName) with administrator privileges
end InstallButton_ 
```

我想通过添加 3 个单选按钮来扩展程序。如果在按下“安装”按钮时选择了任何或所有这些单选按钮（列表），我想执行与每个单选按钮相关的命令。因此，如果只选择了 1st 2 单选按钮，则只执行这 2 个命令。

如何获取单选按钮矩阵的选定值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:19:33.170

我无法使用单选按钮（列表）找到解决方案，但我能够找出如何使用复选框获得确切结果。

```
property checkBox : missing value 
set checkBoxValue to "" 
set checkBoxValue to checkBox's integerValue as string 
#display dialog checkBoxValue 
if checkBoxValue = 1 
  #run policy 
end 
```

如果复选框被选中，则 checkBoxValue 参数 = 1，如果未选中，则值为 0。

# matlab - 使用 IT++ 的 MEX 比 MATLAB 慢？

> ID：13688111
> 
> 赞同：1
> 
> 时间：2012-12-03T17:00:54.313
> 
> 标签：matlab, mex

我已经使用 mex 和 it++ 在 C 中重写了我的 MATLAB 函数，但是我的 mex 实现比我的 MATLAB 函数慢很多。我想知道是否有人可以告诉我我做错了什么。MATLAB

```
for idx = 1:length(eps_r)
    if (idx == 1) || (eps_r(idx) ~= eps_r(idx-1))
        v_p     = c/sqrt(eps_r(idx)); % m/s - Propogation Velocity
        dz      = v_p*dt/2;
        k       = 2*w/v_p; % rad/m
        z_shift = exp(1i*dz*sqrt((repmat(k,1,size(data,2))).^2-(repmat(kx,size(data,1),1)).^2));
    end

    fk_data(idx,:) = ifft(mean(data))*exp(-1i*2*pi*freq(1)*time(idx));
    data    = data.*z_shift;
end 
```

墨西哥与 IT++

```
 for(int idx = 0; idx < eps_r.size();  idx++ )
 {
     if ( (idx == 1) || (eps_r(idx) != eps_r(idx-1) ) )
     {
         v_p =  2.9979e+08 / sqrt(eps_r(0));

         dz = v_p * time(0)/2;
         k = 2 * w / v_p;

         for(int y = 0 ; y < z_shift.size(); y++) 
             z_shift(y) = exp(dz * i * sqrt(pow(z_shift_pt1(y),2) - pow(z_shift_pt2(y),2)));
     }

     fk_data =  ifft(complex_mean(data)) * exp(-i * 2 * itpp::pi * freq(0) * time(idx));
     data = elem_mult(data,z_shift);

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:55:48.530

IFFT有多大？如果这是代码花费大部分时间的地方，那么您不能期望移植到 C++ 会显着提升。[IT++ FFT 函数](http://itpp.sourceforge.net/devel/group__fft.html)本身的文档指出库的内存管理不是最佳的，直接调用 FFTW 可能会更快。另一方面，在调用此类基本函数时，Matlab 进行了高度优化。

Matlab 的最新版本基于即时 (JIT) 编译，并且可能比简单的 C++ 实现更好。

[最后，我相信 IT++ 并不是最快的 C++ 矩阵库。根据您的用例，您可能会更快地找到犰狳或 Eigen]。

# android - 将图像从固定路径拖放到固定位置

> ID：13688113
> 
> 赞同：0
> 
> 时间：2012-12-03T17:00:56.653
> 
> 标签：android, image

我试图允许用户将图像从一个位置拖放到另一个位置。画面布局如下：

1 2 3

4 5 6

7 8 9

我希望用户抓取图像 2、4、6 或 8 并将其拖动到图像 5。拖动到图像 5 后，我想加载一个片段。用户只能将图像从当前位置直线拖动到 5 的位置。即图像2只能向下拖动，直到它超过图像5，图像4只能向右拖动直到超过5，等等。

非常感谢任何有关如何做到这一点的见解。

谢谢， 曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:27:36.960

所以我想出了一个让它工作的方法。非常hacky，但我基本上使用图像位置并通过我想要的直接从它的中心的边距转换它，直到它到达所需的位置。

我创建了一个临时图像 (mTempImage) 并隐藏了我的主图像，因为该图像在布局中设置了参数，迫使它保持在布局中的特定项目之上，并且不会让它的边距小于该项目的高度。

这是我的 onTouchListener 的示例

```
int eventX = (int)event.getX();
                    int eventY = (int)event.getY();

                    int movingViewHeight = view.getHeight();
                    int movingViewWidth = view.getWidth();

                    int destinationTileTop = mTileHere.getTop();
                    int destinationTileLeft = mTileHere.getLeft();

                    // Transparent 'Tile Here' image (1)
                    // Transitional 'Tile Here' image (0 - 1)
                    // Opaque 'Tile Here' image (0)
                    float alphaMultiplier = 0;

                    switch(view.getId()) {
                    case R.id.item_position_2:  
                        // Only allow sliding down from center of object (positive eventY)
                        if (eventY > movingViewHeight / 2) {
                            // Calculate the amount that the image has moved from it's center point
                            int posFromImgCenter = (eventY - movingViewHeight / 2);
                            // Check if the image has reached the center point and stop it's motion any farther
                            if (posFromImgCenter >= destinationTileTop) {
                                params.setMargins(view.getLeft(), destinationTileTop, 0, 0);
                                alphaMultiplier = 1;
                            }
                            // Slide the image with the positioning of the persons finger
                            else {
                                params.setMargins(view.getLeft(), posFromImgCenter, 0, 0);
                                alphaMultiplier = ((float)posFromImgCenter / (float)destinationTileTop);
                            }

                        }
                        // Attempting to slide in an invalid direction leave the image where it is
                        else 
                            params.setMargins(view.getLeft(), view.getTop(), 0, 0);

... MORE CODE HERE FOR OTHER ITEM POSITIONS

// AFTER SWITCH STATEMENT COMPLETE UPDATE VIEW ITEMS ACCORDINGLY

// default 0 if not set with valid movement
                    mTileHere.setAlpha((int)(255 - (255 * alphaMultiplier)));
                    mTempImage.setLayoutParams(params);
                    mTempImage.invalidate(); 
```

谢谢， 曼

# ruby-on-rails - 查找 rails 进程服务器 ID debian

> ID：13688123
> 
> 赞同：0
> 
> 时间：2012-12-03T17:01:45.643
> 
> 标签：ruby-on-rails, process, webserver, webrick

好，朋友们，

所以我设法在服务器上安装了 ruby​​ 和 rails 以及所有必要的 gem，（如果有人看到我的最后一个问题，防火墙阻止了各种包和 gem 的下载，所以它们被破坏了），我启动了 rails 服务器，效果很好，但我用 -d 调用它，现在不知道如何结束它..

我已经研究过了，显然你必须使用 kill 命令，这一切都很好，但我找不到 rails 服务器的进程 ID ......我什至不确定要寻找什么......在某些情况下我在它告诉我查看之前找到的帖子我认为是 usr/lib/tmp，但我那里没有 tmp..

那么，有人对我有更好的答案吗？

ps它是一个debian服务器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:10:12.040

您可以通过运行 : 列出所有 ruby​​ 进程`ps aux |grep ruby`。

第二列包含进程 ID，您只需使用`kill PROCESS_ID`（替换`PROCESS_ID`为您的进程号）来终止服务器进程。

# javascript - 来自单独文件的函数，FireBug：SyntaxError document.getElementsByClassName

> ID：13688125
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:01:46.587
> 
> 标签：javascript, firebug

在页面的头部我包含 .js 文件

```
<script src="ajax.js" language="javascript" type="text/javascript"></script> 
```

html文件中调用函数的按钮

```
<button type='button' id="submit" onclick="javascript:Action(2,0,10)" >Search</button> 
```

js函数

```
function Action(var a,var jump,var number)

var texts = document.getElementsByClassName("textField"); 
```

当网站午餐萤火虫显示错误

```
SyntaxError: syntax error
var texts = document.getElementsByClassName("textField"); 
```

当我尝试从网站 firebug 调用该函数时显示此消息

```
ReferenceError: Action is not defined
Action(2, 0, 10); 
```

问题是什么？是因为我试图从不同的文件中调用文档吗？如果是我该如何解决？

...将功能更改为此并不能解决问题：

```
function Action(a,jump,number) 
```

ajax.js

```
<script>
function Action(a,jump,number)
{
var texts = document.getElementsByClassName("textField");
var value = "FirstName="+texts[0].value+"&LastName="+texts[1].value+"&Id="+texts[2].value+"&DateBirth="+texts[3].value+"&CellPhone="+texts[4].value+"&Text="+texts[5].value+"&ImageSource="+texts[6].value;
var insert = "?"+value;
var get = "?Jump="+jump+"&NumberToGet="+number+"&"+value;
if (a == 1){
   loadXMLDoc("get.php"+get,"view");
}else if (a == 0){
   loadXMLDoc("insert.php"+insert,"view");
}
} 
```

... loadXMLDoc() = 简单的 ajax 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:03:56.647

`var`通过删除关键字来更改 Action 函数的签名。

```
function Action(a,jump,number) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:04:24.430

问题是线路

```
function Action(var a,var jump,var number) 
```

不知道为什么 FireBug 显示下一行的语法错误。查看[函数语句](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/function)以了解正确的语法：

```
function action (a, jump, number) {
    var texts = document.getElementsByClassName("textField");
    …
} 
```

小写的名字不是必须的，但大写的通常只用于常量和构造函数。

此外，您不应`javascript:`在事件处理程序属性中使用该方案。`onclick="action(2,0,10)"`足够的。

# php - 在后台执行 PHP 文件

> ID：13688134
> 
> 赞同：0
> 
> 时间：2012-12-03T17:02:01.380
> 
> 标签：php, multithreading

我有一些 php 代码，可以执行很长时间。

我需要实现下一个方案：

1.  用户在某个页面上输入（第 1 页）
2.  此页面开始在后台执行我的大型 PHP 脚本。（每次更改都写入数据库）
3.  我们每 N 秒向数据库发送一次查询以获取当前执行状态。

我不想使用 exec 命令，因为 1000 个用户会产生 1000 个 php 进程。这对我来说不是办法...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:05:11.923

在脚本中结合 phps`ignore_client_abort()`函数使用对本地 http 服务器的 http 请求。

这样，您可以将负载保持在 http 服务器工作进程内，具有自然限制，并且请求排队是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:07:23.003

所以你基本上想要一个队列（可能存储在数据库中）和一个由 cron 运行的命令行脚本来处理排队的项目。

**澄清**：我不确定我的回答有什么不清楚的地方，但这符合问题提出的两个要求：

1.  客户端不能中止脚本
2.  您在 1,000 个客户之间共享一个进程

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:11:07.163

您可以使用[CLI](http://www.php-cli.com/)执行多个 PHP 脚本

或者

您可以尝试[在 PHP 中轻松并行处理](http://phplens.com/phpeverywhere/?q=node/view/254)

# http - Postgres 的 HTTP 触发器

> ID：13688135
> 
> 赞同：0
> 
> 时间：2012-12-03T17:02:03.873
> 
> 标签：http, postgresql, triggers

我正在尝试编写一个 Postgres 触发器，以便在更新配置表时通知后端组件并可以处理更改。我知道 Oracle 有 web/HTTP 触发器的概念，您可以在其中执行从 Oracle 实例本身到 URL 的 HTTP GET，然后可以在应用层处理请求。我想知道 Postgres ( `v. 9.0.5`) 是否具有相同的功能，或者具有类似的功能（以及随后如何设置/配置它）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:08:27.453

[您可以从触发器中使用PL/Python](http://www.postgresql.org/docs/9.2/interactive/plpython-funcs.html)调用 Python 存储过程，并使用 Python 的标准库发出 http get 请求。

# android - 为什么使用 Intent.URI_INTENT_SCHEME

> ID：13688138
> 
> 赞同：6
> 
> 时间：2012-12-03T17:02:15.947
> 
> 标签：android, android-intent

在阅读有关 Widgets 的 Android 文档时，我偶然发现了这段代码，其目的是启动一项服务来检索 StackView 项目的工厂。

```
// Set up the intent that starts the StackViewService, which will
// provide the views for this collection.
Intent intent = new Intent(context, StackWidgetService.class);
// Add the app widget ID to the intent extras.
intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetIds[i]);
intent.setData(Uri.parse(intent.toUri(Intent.URI_INTENT_SCHEME)));
// Instantiate the RemoteViews object for the App Widget layout.
RemoteViews rv = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
// Set up the RemoteViews object to use a RemoteViews adapter. 
// This adapter connects
// to a RemoteViewsService  through the specified intent.
// This is how you populate the data.
rv.setRemoteAdapter(appWidgetIds[i], R.id.stack_view, intent); 
```

你可以在[这里找到](http://developer.android.com/guide/topics/appwidgets/index.html#AppWidgetProvider-collections)

我无法理解您为什么需要致电

```
intent.setData(Uri.parse(intent.toUri(Intent.URI_INTENT_SCHEME))); 
```

我知道它给 URI 一个前缀*intent://*，但这里有必要吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-08-30T08:03:57.517

这很容易。

简介：如果不使用：如果您不使用 setData，它将为小部件的所有实例显示相同的 id。

# c# - 将 windows 窗体保存为 xml 文档

> ID：13688145
> 
> 赞同：0
> 
> 时间：2012-12-03T17:03:17.183
> 
> 标签：c#, xml

> **可能重复：**
> [Windows 窗体保存到 XML](https://stackoverflow.com/questions/10334949/windows-form-save-to-xml)

我想通过单击按钮将简单的 windows 窗体的结构保存到 XML 文档中。我还需要保存控件的主要属性，例如文本、名称、大小、位置...

关于如何处理这项任务的任何想法？也许一些有用的链接？

# sql - VBS确定SQL表中的记录数

> ID：13688148
> 
> 赞同：-3
> 
> 时间：2012-12-03T17:03:20.640
> 
> 标签：sql, vbscript

如何确定 SQL 表中的记录数，然后将该值保存在变量中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:17:25.610

使用[ADO](http://msdn.microsoft.com/en-us/library/windows/desktop/ms677516%28v=vs.85%29.aspx)访问数据库：

1.  执行一个简单的`SELECT count(0) FROM myTable`查询。
2.  访问结果集（如果不为空）并读取返回值。

未测试代码：

```
Dim conn, rs, recordsCount
recordsCount = -1

'initialize the connection
set conn = ...

'run the query and retrieve the results
set rs = conn.execute("SELECT count(0) as cnt FROM myTable")
if not rs.EOF then
  recordsCount = cint(rs("cnt"))
end if

'cleanup
rs.close
conn.close

set rs = nothing
set conn = nothing 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:42:59.880

获取查询记录集/结果大小的三种方法：

```
Option Explicit

' simple way to get a connection
Dim oDb : Set oDb = CreateObject("ADODB.Connection")
oDb.Open "dsn=NWIND"

' execute & !obtain result! of "SELECT COUNT()" query
WScript.Echo "Select Count(*):", oDb.Execute("SELECT COUNT(*) FROM Products").Fields(0).Value

' trying to use recordcount (fails, because non-static rs)
WScript.Echo "RecordCount (A):", oDb.Execute("SELECT * FROM Products").RecordCount

' use recordcount with static rs
Const adOpenStatic = 3
Dim oRs : Set oRS = CreateObject("ADODB.Recordset")
oRS.Open "SELECT * FROM Products", oDb, adOpenStatic
WScript.Echo "RecordCount (B):", oRs.RecordCount

' get rows from query and use UBound()
Dim aData : aData = oDb.Execute("SELECT * FROM Products").GetRows()
WScript.Echo "GetRows():", UBound(aData, 2) + 1

oDb.Close 
```

输出：

```
cscript 04.vbs
Select Count(*): 77
RecordCount (A): -1
RecordCount (B): 77
GetRows(): 77 
```

使用[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms676539%28v=vs.85%29.aspx)了解有关这些策略的更多信息。

# mysql - 数据类型类似于数组，Mysql

> ID：13688149
> 
> 赞同：0
> 
> 时间：2012-12-03T17:03:25.590
> 
> 标签：mysql

我正在制作一个需要允许用户字段的表，但 mysql 中没有“数组”数据类型。是否有类似的数据类型可以以列表方式存储我的用户？我听说过 BLOB，但我不太确定这是否是我正在寻找的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:12:26.427

这是一个相当简单的设计：

```
folder
======
folder_id
folder_name

user
====
user_id
user_name

grant
=====
folder_id
user_id 
```

至于[BLOB](http://dev.mysql.com/doc/refman/5.5/en/blob.html)：

> BLOB 是一个二进制大对象，可以保存可变数量的数据 [...] BLOB 值被视为二进制字符串（字节字符串）。它们没有字符集，排序和比较基于列值中字节的数值。

二进制列不是存储文本的好选择。

# c# - 我应该在我的控制器中打开数据库连接吗？

> ID：13688154
> 
> 赞同：1
> 
> 时间：2012-12-03T17:03:49.930
> 
> 标签：c#, asp.net, asp.net-mvc

我的控制器需要获取传递回视图的数据。我应该在哪里打开连接以传递到存储库？这是一个例子。这是我的一个控制器的一部分。

```
using (var connection = this.GetActiveConnection())
{
    var repository = new RefRepository(connection);
    var codes = repository.GetPoACodes();    
} 
```

在控制器中打开连接是不好的做法吗？如果我不通过控制器传递它，我应该在哪里传递到存储库的连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:07:50.893

实际上存储库必须自己处理连接，它不应该是控制器的关注点。控制器类必须保持纤细，如果它变胖，那将是代码异味。

如果您可以使用依赖注入框架（如 Ninject、StructureMap 等）来连接这些依赖项、处理 DbContext 或 Session 和 SessionFactory（EF 或 NHibernate）、事务或即工作单元模式，那将是一个非常好的做法，如果您想到目前为止，异常处理和日志记录。

如果您使用的是 Visual Studio，那么在项目模板中还有一个创建存储库的选项，您可以创建示例项目、阅读代码并了解代码的组织方式。

在[本文中](http://net.tutsplus.com/tutorials/building-an-asp-net-mvc4-application-with-ef-and-webapi/)，在 Web API 标头下，您可以了解如何执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:21:22.213

不，您不应该在控制器上打开数据库连接。

控制器应该与您的“域模型”对话，这与您的数据库模式不同。

在您的情况下，也许您的存储库必须处理它。

甚至更多，例如，如果您使用 Entity Framework 或 NHibernate，最好让他们处理这件事。

# html - 何时使用 对比

> ID：13688158
> 
> 赞同：72
> 
> 时间：2012-12-03T17:03:58.620
> 
> 标签：html

关于何时应该使用另一个`<p>...</p>`而不是`<br />`标签的判断是什么？这种事情的最佳做法是什么？

我环顾四周寻找这个问题，但大部分文章似乎有点旧，所以我不确定关于这个主题的意见是否已经演变。

编辑：为了澄清这个问题，这是我正在处理的情况。您会对以下内容使用`<br>`'s 还是`<p>`'s（想象一下它包含在主页上的 div 中）：

* * *

欢迎来到主页。

看看我们的东西。

你真的应该。

* * *

现在，这些行在技术上并不是“段落”。那么，您是否会通过将整个块包围在`<p>`标签中并在其间使用 's 来标记这一点，或者对每一行`<br>`使用单独的 's？`<p>`

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-12-03T17:06:26.690

它们有两种不同的功能。

`<p>`(paragraph) 是一个块元素，用于保存文本。用于在元素`<br />`内强制换行。`<p>`

**例子**

```
<p>Suspendisse sodales odio in felis sagittis hendrerit. Donec tempus laoreet
est bibendum sollicitudin. Etiam tristique convallis<br />rutrum. Phasellus 
id mi neque. Vivamus gravida aliquam condimentum.</p> 
```

**结果**

Suspendisse sodales odio in felis sagittis hendrerit。Donec tempus laoreet est bibendum sollicitudin。Etiam tristique convallis
rut​​rum。Phasellus id mi neque。Vivamus gravida aliquam 调味品。

**更新**

根据新的要求，我个人会使用`<p>`来实现间距以及允许样式。如果将来您希望为这些部分之一设置样式，那么在块级别这样做会容易得多。

```
<p>Welcome to the home page.</p>

<p style="border: 1px solid #00ff00;">Check out our stuff.</p>

<p>You really should.</p> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-03T17:08:52.767

`<p>`当您需要将两个信息流分解为单独的想法时，您希望使用该标签。

```
<p> Now is the time for all good men to come to the aid of their country. </p>

<p>The quick brown fox jumped over the lazy sleeping dog.</p> 
```

该`<br/>`标签用作网页文本流中的强制换行符。当您希望文本在下一行继续时使用它，例如诗歌。

```
<p>  Now is the time for all good men to come to the aid of their country. <br/>
The quick brown fox jumped over the lazy sleeping dog. </p> 
```

[来源](http://webdesign.about.com/od/htmltags/a/aabg092299a.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-29T14:41:45.103

在这个帖子中回答问题时，我可能违反了礼仪规则——因为到目前为止，大多数答案都很好——但这是我处理这个论点的方式：

虽然我同意“p”是用于保存文本的元素，而“br”标签用于中断文本，但在许多情况下，人们可能想要操作它们之间具有实际行间距的文本“块”；

例如：
[我的文本块]
Hello World！
--------这是一个空白行------
你是如此充满活力！
[/我的文本块]

现在很多人会争辩说你可以在一个 'div' 中放置两个 'p' 元素，然后操纵那个 'div'，但是我觉得这更耗时（也就是我很懒），因此我坚持使用双'br' 方法——让我只操作那个 'p.'

我的非正统方法的问题是，如果对行高应用了特定的样式，那么双“br”与“p”创建的行空间之间肯定会有明显的差异。

我想在决定采用哪种技术时，请考虑：

*   代码可读性
*   最佳实践
*   时间
*   快捷方式对其余代码的影响

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T17:10:03.710

`<p>`当你想分隔两个段落时，你应该使用。来自维基百科：

> 段落（来自希腊语paragraphos，“写在旁边”或“写在旁边”）是处理特定观点或想法的书面话语的独立单元。

`<br>`当您想在段落中强制换行时，请使用该标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T17:07:44.037

`<p>`除非您打算将内容放入其中，否则我不会使用。当然，这只是一种意见（我认为大多数答案都是如此）。

但是，为标签设置样式可能更容易`<p>`（至少有更多选项），这可能有助于更频繁地使用。我唯一的问题是这不是很容易阅读（在阅读代码时），我觉得这些样式可以应用于其他地方（可能应用于标签周围的`<p>`标签。

此外，正如其他人所说，`<br />`应该使用标签来分隔块元素（例如`<p>`标签）中的内容。如果您正在使用以下内容：

```
<p class="a">some content...</p>
<p class="break"></p>
<p class="b">some other content...</p> 
```

然后我会争辩说，您应该在标签周围的一个或两个标签上使用样式`p.break`来执行所需的任何*间距*。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-03T19:41:10.967

标签是块级元素，`p`主要用于添加内容，而`br`标签用于在元素内强制换行。也就是说，如果您要遵循语义。现在很多人都这样做是为了给标签和诸如此类的东西添加特定的含义。我希望这会有所帮助。不过，祝你好运。=)

# c# - 如何像这个程序一样覆盖 Windows 中的最大 32x32 鼠标大小

> ID：13688159
> 
> 赞同：17
> 
> 时间：2012-12-03T17:03:57.963
> 
> 标签：c#, registry, mouse, accessibility

我希望我的程序能够覆盖最大施加的鼠标大小 32x32，就像附图中的程序一样，图中的光标是 72x72。这是`ProcMon`显示光标更改时发生的情况的捕获。

但是，如果我尝试自己更改光标文件的注册表值，然后使用推送更改

`SystemParametersInfo(SPI.SPI_SETCURSORS, 0, IntPtr.Zero, SPIF.SPIF_SENDCHANGE);`

然后光标会改变，但它仍然限制在 32x32 的最大尺寸。这个程序是如何绕过这个限制的？此外，光标在程序结束后仍然存在，因此它不能是它在运行时正在做的事情，但必须覆盖某处的设置。

![在此处输入图像描述](../Images/45e23d1029bf3f98fc9700dee3685788.png)

感谢您的帮助，我一直无法在网上找到这样的任何东西，所以我什至不知道是否有人会给出答案。

编辑：我看到一些对名为`C:\Windows\SysWOW64\Imageres.dll`. 它们只是读取，但也许这些游标存储在这里，或者他们以某种方式修改了这个文件。但我认为这可能会让比我更有经验的人走上正轨。

编辑 2：我相信大小由 SM_CXCURSOR 和 SM_CYCURSOR 变量决定。如果我能找到一种方法来设置这些，我可能会做生意。打算编写一个快速程序，让我在程序运行和巨大的鼠标光标的情况下在 PC 上获取这些值，然后看看它返回什么......

编辑3：没有运气；带有大光标的 PC 为 SM_CXCURSOR 和 SM_CYCURSOR 返回 32x32。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-22T17:43:06.907

使用`SetSystemCursor`它可以将光标设置为比标准光标大得多的图像。

这是我用于调整系统光标大小的类：

```
using System;
using System.Drawing;
using System.Reflection;
using System.Runtime.InteropServices;

namespace WindowsFormsApplication1
{
    class SystemCursors
    {
        [DllImport("user32.dll")]
        static extern bool SetSystemCursor(IntPtr hcur, uint id);

        enum CursorShift
        {
            Centered,
            LowerRight,
        }

        public static void SetSystemCursorsSize(int newSize)
        {
            ResizeCursor(System.Windows.Forms.Cursors.AppStarting, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.Arrow, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.Cross, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.Hand, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.Help, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.HSplit, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.IBeam, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.No, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.NoMove2D, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.NoMoveHoriz, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.NoMoveVert, newSize, CursorShift.LowerRight);
            ResizeCursor(System.Windows.Forms.Cursors.PanEast, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanNE, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanNorth, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanNW, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanSE, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanSouth, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanSW, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.PanWest, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.SizeAll, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.SizeNESW, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.SizeNS, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.SizeNWSE, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.SizeWE, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.UpArrow, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.VSplit, newSize, CursorShift.Centered);
            ResizeCursor(System.Windows.Forms.Cursors.WaitCursor, newSize, CursorShift.LowerRight);
        }

        private static void ResizeCursor(System.Windows.Forms.Cursor cursor, 
            int newSize, CursorShift cursorShift)
        {
            Bitmap cursorImage = GetSystemCursorBitmap(cursor);
            cursorImage = ResizeCursorBitmap(cursorImage, new Size(newSize, newSize), cursorShift);
            SetCursor(cursorImage, getResourceId(cursor));
        }

        public static Bitmap GetSystemCursorBitmap(System.Windows.Forms.Cursor cursor)
        {
            Bitmap bitmap = new Bitmap(
                cursor.Size.Width, cursor.Size.Height,
                System.Drawing.Imaging.PixelFormat.Format32bppArgb);

            Graphics graphics = Graphics.FromImage(bitmap);

            cursor.Draw(graphics,
                new Rectangle(new Point(0, 0), cursor.Size));

            bitmap = Crop(bitmap);

            return bitmap;
        }

        private static Bitmap Crop(Bitmap bmp)
        {
            //code from http://stackoverflow.com/a/10392379/935052

            int w = bmp.Width;
            int h = bmp.Height;

            Func<int, bool> allWhiteRow = row =>
            {
                for (int i = 0; i < w; ++i)
                    if (bmp.GetPixel(i, row).A != 0)
                        return false;
                return true;
            };

            Func<int, bool> allWhiteColumn = col =>
            {
                for (int i = 0; i < h; ++i)
                    if (bmp.GetPixel(col, i).A != 0)
                        return false;
                return true;
            };

            int topmost = 0;
            for (int row = 0; row < h; ++row)
            {
                if (allWhiteRow(row))
                    topmost = row;
                else break;
            }

            int bottommost = 0;
            for (int row = h - 1; row >= 0; --row)
            {
                if (allWhiteRow(row))
                    bottommost = row;
                else break;
            }

            int leftmost = 0, rightmost = 0;
            for (int col = 0; col < w; ++col)
            {
                if (allWhiteColumn(col))
                    leftmost = col;
                else
                    break;
            }

            for (int col = w - 1; col >= 0; --col)
            {
                if (allWhiteColumn(col))
                    rightmost = col;
                else
                    break;
            }

            if (rightmost == 0) rightmost = w; // As reached left
            if (bottommost == 0) bottommost = h; // As reached top.

            int croppedWidth = rightmost - leftmost;
            int croppedHeight = bottommost - topmost;

            if (croppedWidth == 0) // No border on left or right
            {
                leftmost = 0;
                croppedWidth = w;
            }

            if (croppedHeight == 0) // No border on top or bottom
            {
                topmost = 0;
                croppedHeight = h;
            }

            try
            {
                var target = new Bitmap(croppedWidth, croppedHeight);
                using (Graphics g = Graphics.FromImage(target))
                {
                    g.DrawImage(bmp,
                      new RectangleF(0, 0, croppedWidth, croppedHeight),
                      new RectangleF(leftmost, topmost, croppedWidth, croppedHeight),
                      GraphicsUnit.Pixel);
                }
                return target;
            }
            catch (Exception ex)
            {
                throw new Exception(
                  string.Format("Values are topmost={0} btm={1} left={2} right={3} croppedWidth={4} croppedHeight={5}", topmost, bottommost, leftmost, rightmost, croppedWidth, croppedHeight),
                  ex);
            }
        }

        private static Bitmap ResizeCursorBitmap(Bitmap bitmap, Size size, CursorShift cursorShift)
        {
            if (size.Width > 32)
            {
                //shifting must occur
                Bitmap intermediateBitmap = new Bitmap(64, 64);
                Graphics intermediateGraphics = Graphics.FromImage(intermediateBitmap);
                if (cursorShift == CursorShift.LowerRight)
                    //place the mouse cursor in the lower right hand quadrant of the bitmap
                    intermediateGraphics.DrawImage(bitmap,
                        intermediateBitmap.Width / 2, intermediateBitmap.Height / 2);
                else if (cursorShift == CursorShift.Centered)
                    intermediateGraphics.DrawImage(bitmap,
                        intermediateBitmap.Width / 2 - bitmap.Width / 2,
                        intermediateBitmap.Height / 2 - bitmap.Height / 2);

                //now we have a shifted bitmap; use it to draw the resized cursor
                //Bitmap finalBitmap = new Bitmap(intermediateBitmap, size);    //normal quality
                Bitmap finalBitmap = new Bitmap(size.Width, size.Height);
                Graphics finalGraphics = Graphics.FromImage(finalBitmap);
                finalGraphics.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;
                finalGraphics.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;
                finalGraphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
                finalGraphics.DrawImage(intermediateBitmap, 0, 0, finalBitmap.Width, finalBitmap.Height);
                return finalBitmap;
            }
            else
            {
                Bitmap newBitmap = new Bitmap(bitmap, size);
                return newBitmap;
            }
        }

        private static uint getResourceId(System.Windows.Forms.Cursor cursor)
        {
            FieldInfo fi = typeof(System.Windows.Forms.Cursor).GetField(
                "resourceId", BindingFlags.NonPublic | BindingFlags.Instance);
            object obj = fi.GetValue(cursor);
            return Convert.ToUInt32((int)obj);
        }

        private static void SetCursor(Bitmap bitmap, uint whichCursor)
        {
            IntPtr ptr = bitmap.GetHicon();
            bool retval = SetSystemCursor(ptr, whichCursor);
        }

    }
} 
```

它的工作原理是获取提供的当前系统光标`System.Windows.Forms.Cursors`并使用`Cursor.Draw`. 然后将图像调整为所需的大小。这需要将光标图像移动到右下角（如箭头指针）或将光标图像置于较大图像内的中心（如 Cross 和 IBeam）。

如果需要，您可以使用自己的图像作为光标，绕过所有调整大小的代码。只需将位图提供给`SetCursor`.

一旦新的光标图像准备好，最后需要的数据就是我们要替换的光标的 ID。每个`System.Windows.Forms.Cursor`都包含此信息，但在私有变量中，因此使用反射来获取值。如果您希望避免反射，则可以构建这些值的表。有关值的列表，请参阅[MSDN SetSystemCursor 。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648395%28v=vs.85%29.aspx)

要使用该类，只需调用

```
SystemCursors.SetSystemCursorsSize(128); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-03T17:48:50.420

如果您正在使用 WPF，您可以创建自己的鼠标光标并分配它。但这不是系统范围的鼠标光标更改。这是一些可以解决问题的代码。在下面的代码中，我创建了一个 50x50 像素的光标。您可以将自己的形状绘制到`RenderTargetBitmap`

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        Mouse.OverrideCursor = CreateCursor(50,50, Brushes.Gold, null);
    }

    Cursor CreateCursor(double rx, double ry, SolidColorBrush brush, Pen pen)
    {
        var vis = new DrawingVisual();
        using (var dc = vis.RenderOpen())
        {
            dc.DrawRectangle(brush, new Pen(Brushes.Black, 0.1), new Rect(0, 0, rx, ry));
            dc.Close();
        }
        var rtb = new RenderTargetBitmap(64, 64, 96, 96, PixelFormats.Pbgra32);
        rtb.Render(vis);

        using (var ms1 = new MemoryStream())
        {
            var penc = new PngBitmapEncoder();
            penc.Frames.Add(BitmapFrame.Create(rtb));
            penc.Save(ms1);

            var pngBytes = ms1.ToArray();
            var size = pngBytes.GetLength(0);

            //.cur format spec http://en.wikipedia.org/wiki/ICO_(file_format)
            using (var ms = new MemoryStream())
            {
                {//ICONDIR Structure
                    ms.Write(BitConverter.GetBytes((Int16)0), 0, 2);//Reserved must be zero; 2 bytes
                    ms.Write(BitConverter.GetBytes((Int16)2), 0, 2);//image type 1 = ico 2 = cur; 2 bytes
                    ms.Write(BitConverter.GetBytes((Int16)1), 0, 2);//number of images; 2 bytes
                }

                {//ICONDIRENTRY structure
                    ms.WriteByte(32); //image width in pixels
                    ms.WriteByte(32); //image height in pixels

                    ms.WriteByte(0); //Number of Colors in the color palette. Should be 0 if the image doesn't use a color palette
                    ms.WriteByte(0); //reserved must be 0

                    ms.Write(BitConverter.GetBytes((Int16)(rx / 2.0)), 0, 2);//2 bytes. In CUR format: Specifies the horizontal coordinates of the hotspot in number of pixels from the left.
                    ms.Write(BitConverter.GetBytes((Int16)(ry / 2.0)), 0, 2);//2 bytes. In CUR format: Specifies the vertical coordinates of the hotspot in number of pixels from the top.

                    ms.Write(BitConverter.GetBytes(size), 0, 4);//Specifies the size of the image's data in bytes
                    ms.Write(BitConverter.GetBytes((Int32)22), 0, 4);//Specifies the offset of BMP or PNG data from the beginning of the ICO/CUR file
                }

                ms.Write(pngBytes, 0, size);//write the png data.
                ms.Seek(0, SeekOrigin.Begin);
                return new Cursor(ms);
            }
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-10T00:10:35.727

将这些导入添加到您的类中：

```
[DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
static extern IntPtr LoadImage(IntPtr hinst, string lpszName, uint uType, int cxDesired, int cyDesired, uint fuLoad);

[DllImport("user32.dll")]
static extern bool SetSystemCursor(IntPtr hcur, uint id); 
```

阅读有关[LoadImage](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648045)和[SetSystemCursor](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648395)的 msdn 文章，尤其是有关它们使用的参数的文章。

然后在您的代码中使用函数：

```
// "cursor.cur" - cursor image of any size you want
// 2 == IMAGE_CURSOR (from Winuser.h)
// cxDesired = 0 and cyDesired = 0, using original image size
// 0x8010 == LR_DEFAULTCOLOR | LR_SHARED | LR_LOADFROMFILE (from Winuser.h)
var ptr = LoadImage(IntPtr.Zero, "cursor.cur", 2, 0, 0, 0x8010);
if(ptr != IntPtr.Zero)
{
    SetSystemCursor(ptr, 32512); // 32512 == OCR_NORMAL (from Winuser.h)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-12T07:22:33.563

我通过使用intruder的方式解决了这个问题。补充，API LoadImage不能Load.png。使用 System.drawing.BitMap. 像这样：`Bitmap bmp = new Bitmap(str, true); IntPtr p = bmp.GetHicon(); SetSystemCursor(p, OCR_NORMAL);`

# c++ - 将函数输出分配给变量

> ID：13688160
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:04:02.050
> 
> 标签：c++, visual-c++

我有这个：

```
#include "stdafx.h"
#include <iostream>
#include <Windows.h>
#include <Iphlpapi.h>
#include <Assert.h>
#include <sstream>

#pragma comment(lib, "iphlpapi.lib")

using namespace std;

// Prints the MAC address stored in a 6 byte array to stdout
static void PrintMACaddress(unsigned char MACData[])
{

    printf("%02X-%02X-%02X-%02X-%02X-%02X", 
        MACData[0], MACData[1], MACData[2], MACData[3], MACData[4], MACData[5]);

}

// Fetches the MAC address and prints it
static void GetMACaddress(void)
{
    IP_ADAPTER_INFO AdapterInfo[16];            // Allocate information for up to 16 NICs
    DWORD dwBufLen = sizeof(AdapterInfo);       // Save the memory size of buffer

    DWORD dwStatus = GetAdaptersInfo(           // Call GetAdapterInfo
        AdapterInfo,                            // [out] buffer to receive data
        &dwBufLen);                             // [in] size of receive data buffer
    assert(dwStatus == ERROR_SUCCESS);          // Verify return value is valid, no buffer overflow

    PIP_ADAPTER_INFO pAdapterInfo = AdapterInfo;// Contains pointer to current adapter info
    do {
        PrintMACaddress(pAdapterInfo->Address); // Print MAC address
        pAdapterInfo = pAdapterInfo->Next;      // Progress through linked list
    }
    while(pAdapterInfo);                        // Terminate if last adapter
}

    int _tmain(int argc, _TCHAR* argv[])
    {
    char mac[100];

        GetMACaddress(); // output is 00-19-D7-53-2D-14

    std::stringstream buffer;
    buffer << "Text" << std::endl;
    cout << buffer.str();
        return 0;
    } 
```

我的问题是如何将函数`GetMACaddress();`输出分配给变量。这：`mac = GetMACaddress(); // output is 00-19-D7-53-2D-14`不工作。请帮帮我。谢谢你。

返回 MAC 地址的数据类型为`unsigned char`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:10:32.120

您需要将`stdout`缓冲区重定向到字符串流，如下所示：

```
stringstream ss;
streambuf* old = std::cout.rdbuf(ss.rdbuf()); // redirect stdout, and also save the old one

GetMACAddress();

string theStr = ss.str();
cout << theStr << endl;

// when you are done, redirect back to the "real" stdout
cout.rdbuf(old); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:15:01.750

您的函数`PrintMACaddress`打印 MAC 地址；您需要一个类似的函数来接收`unsigned char MACData[]`但返回 MAC 地址而不是打印它。

```
// Converts the MAC address stored in a 6 byte array to a string
std::string ConvertMACaddressToString(unsigned char MACData[])
{
    ...
} 
```

要实现它，首先替换`printf`为`sprintf`：

```
char result[18]; // 18 bytes are just enough to hold the MAC address
sprintf(result, "%02X-%02X-%02X-%02X-%02X-%02X", 
    MACData[0], MACData[1], MACData[2], MACData[3], MACData[4], MACData[5]); 
```

然后从函数返回值：

```
return result; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:06:39.053

如果返回mac地址的数据类型是`unsigned char`，可以存储在里面。

```
unsigned char output = GetMACaddress() ; 
```

如果它是一串字符，则用于`std::string`存储返回的 mac 地址，如果您说的是 pattern 的输出`00-19-D7-53-2D-14`。

```
std::string output = GetMACaddress() ; 
```

如果是其他类型，您可以让编译器在运行时决定。如果您使用的是 C++11，则可以使用`auto`或`decltype`.

```
auto return_val = GetMACaddress() ; 
```

# jquery - 将对话框定位在窗口的右侧

> ID：13688163
> 
> 赞同：0
> 
> 时间：2012-12-03T17:04:12.287
> 
> 标签：jquery

我喜欢在单击链接时创建一个对话框，如下例所示。到目前为止它可以工作，但对话框总是出现在中心窗口上。我喜欢更改它并将其放置在窗口的右侧。有什么想法可以解决这个问题吗？

```
<script type="text/javascript"> 

          $(function() {
          $("#lin").click(function(){
            $( "#dialog" ).dialog();
           });
      });
}); 
```

html:

```
<li><a id="lin" href="#">link</a></li>

    <div id="dialog" class="def" title="title" style="display:none;">
       <p>thi is the text in the dialog</p>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:07:13.610

[jquery ui 文档](http://docs.jquery.com/UI/API/1.8/Dialog#option-position)指定了一个位置属性，您可以添加该属性来定位它：

1.  表示视口内位置的单个字符串：'center'、'left'、'right'、'top'、'bottom'。
2.  一个数组，包含一个 x,y 坐标对，像素偏移距视口的左上角（例如 [350,100]）
3.  一个包含 x,y 位置字符串值的数组（例如右上角的 ['right','top']）。

    `$( "#dialog" ).dialog({position:'right'});`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:08:25.493

使用`position:`选项：

```
position: { my: "right", at: "right", of: window } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:09:29.380

有时阅读 jquery UI 文档可能会有所帮助：

```
$( "#dialog" ).dialog({position:'right'}); 
```

# ajax - 使用 _escaped_fragment= 可抓取 Ajax 并具有 HTML5 历史记录

> ID：13688164
> 
> 赞同：1
> 
> 时间：2012-12-03T17:04:17.100
> 
> 标签：ajax, seo

我试图了解 Google/Bing 如何索引 Ajax 内容。我认为使用 hashbang URL 时我的想法很清楚，但是当您使用 HTML5 PushState API 时它是如何工作的？

例如，以下网址 www.exemple.com/foo 被 Google “翻译”为 www.exemple.com/foo?_escaped_fragment=。但是具有 GET 参数的 URL 怎么样，例如 www.exemple.com/foo?page=4 ？是否翻译为 www.exemple.com/foo?page=4&_escaped_fragment= ？

谢谢 ：）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T03:14:20.387

是的 _escaped_fragment 始终作为最后一个参数添加。在此处查看来自谷歌的规范[https://developers.google.com/webmasters/ajax-crawling/docs/specification](https://developers.google.com/webmasters/ajax-crawling/docs/specification)

> 此外，URL中必须只有一个_escaped_fragment_，并且必须是最后一个查询参数

在这种情况下，HTML5 和 Hashbang 之间没有区别，因为在这两种情况下您都可以获取参数。

使用 hashbang _escaped_fragment 时的唯一区别将包含路径，而使用 html5 时它将为空。

备注：使用 html5，您需要将以下代码放入您的 html 页面，因为搜索引擎机器人不会在您的 url 中看到任何 hashbang：

```
<meta name="fragment" content="!"> 
```

# scala - Scala：对类的字段施加约束

> ID：13688167
> 
> 赞同：0
> 
> 时间：2012-12-03T17:04:27.397
> 
> 标签：scala, constraints, field

在 Scala 中，如何对类的字段进行约束？在一个包中，我有模型的域，在另一个包中，我有 dsl 来实例化我的模型。该模型的基本形式是这样的：

```
abstract class Element {
  var name: String
  var description: String
  var types : Set[Type]  
}

class SAComponent (var name :String,
        var description : String,
        var properties : Set[Property] = Set(),
        var types : Set[Type] = Set(),
        ) extends Component 
```

元素是我模型的根。我想对 Element 的字段施加约束，以便每个继承名称和描述以及 Element 类型的类都尊重这些约束。换句话说**，我需要为这些字段定义我得到的。**正确的？我应该怎么做？

我试过了，但没有遵守约束：

```
abstract class Element {    
  def name: String
  def name_= (value: String): Unit = {if (isBadValue(value)throw new IllegalArgumentException
  name = value
  }
  var description : String,
  var types : Set[Type] = Set }

  class Component (override var name : String, var description: String) extends Element 
```

问题是某些必须遵守约束的字段，在具体类的构造函数中必须初始化为空值。所以“*要求*”对我来说不是一个好的解决方案。谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T15:58:32.720

在初始化时检查对您不起作用，因为您需要有状态的对象，这可以通过使用案例类来避免。`copy(field=value)`您可能希望使用为案例类自动生成的来创建新对象，而不是改变对象的状态。

如果您仍然想使用有状态的对象，我想您想要类似的东西

```
abstract class Element {    
  private var _name: String = null
  def name_= (value: String) {
    require(!isBadValue(value),"Bad Value")
    _name = value
  }
  def name = _name
  def isBadValue(value: String): Boolean
}
class Component (initialName : String) extends Element {
  name = initialName
  def isBadValue(value: String) = value=="name"
}
val c = new Component(null)  // works
c.name = "name"              // exception 
```

需要指出的另一件事：`override var name`代码中生成的 setter 会覆盖您`name_=`可能已经知道的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:46:58.243

抽象值：

```
trait Init {
  val name: String
  require(!isBadName(name))
  def isBadName(name: String) = true
} 
```

创建：

```
new { val name = "init" } with Init 
```

# image - 在不影响清晰度的情况下放大图像

> ID：13688169
> 
> 赞同：1
> 
> 时间：2012-12-03T17:04:36.077
> 
> 标签：image, image-resizing

我需要在不影响其清晰度的情况下放大下载的图像。但是当调整大小时，它的清晰度已经消失了。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:31:15.670

鉴于上下文，为了清楚起见，我假设您的意思是视觉外观。你想要你的放大图像，我相信你正在处理放大而不是缩小（在你的问题中没有指定），看起来视觉上很好。我们实际上可以神奇地创造细节，但可能不是完美的。有专门处理像素化图像的技术，例如[hqx](http://en.wikipedia.org/wiki/Hqx)或[http://research.microsoft.com/en-us/um/people/kopf/pixelart/paper/pixel.pdf](http://research.microsoft.com/en-us/um/people/kopf/pixelart/paper/pixel.pdf)。由于从您的描述中也不清楚，我只是假设您有任何类型的图像。

考虑到这些因素，您还没有描述您尝试过的内容。让我猜你尝试了最近邻插值，所以你得到了类似的东西：

![在此处输入图像描述](../Images/9650d013f1bc5e79f932b4e537b50c3e.png) ![在此处输入图像描述](../Images/a93270de8dc757a16700a330fc5d3a53.png)

还有其他常见的插值类型。像[bicubic](http://en.wikipedia.org/wiki/Bicubic_interpolation)、[Lanczos](http://en.wikipedia.org/wiki/Lanczos_resampling)或更现代的东西，如[ICBI](http://www.andreagiachetti.it/icbi/)或[http://www.cs.huji.ac.il/~raananf/projects/lss_upscale/paper.pdf](http://www.cs.huji.ac.il/~raananf/projects/lss_upscale/paper.pdf)。考虑其中的前三个，我们得到各自的结果：

![在此处输入图像描述](../Images/2081597afac4f27490487a685455234f.png) ![在此处输入图像描述](../Images/d252db89b75e52fcb8e138b7840beb3c.png) ![在此处输入图像描述](../Images/2e169c0f5a6a07e75f0c3c67f02547c9.png)

可能有点难以想象最后三个之间的差异，但是如果您放大实际图像，您将能够注意到它们。在这种情况下，ICBI 给出了最锐利的边缘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:06:23.987

除非您下载了矢量图形图像，否则调整图像大小总是会影响清晰度。查看图像是否具有矢量图形格式，如果是，请下载该格式。

如果做不到这一点，您可以尝试查看是否有更大的图像尺寸可用，因为通常缩小对图像质量的伤害小于增加。

# sql - 优化不入左外连接

> ID：13688171
> 
> 赞同：0
> 
> 时间：2012-12-03T17:04:39.147
> 
> 标签：sql, ruby-on-rails, postgresql

我想获取用户没有看到的前 10 个问题。为此，我需要将该用户看到的问题存储到名为 user_questions 的表中

所以，我的查询现在是：

`SELECT * from questions WHERE questions.id NOT IN (select question_id from user_questions where user_id=1) LIMIT 0, 10`

据我所知，与类似的联接查询相比，此查询应该更慢。如何构建产生相同结果的连接查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:07:43.720

等效的连接查询是：

```
select q.*
from questions q left outer join
     user_questions uq
     on uq.question_id = q.id and
        uq.user_id = 1
where uq.user_id is null
limit 0, 30 
```

但需要注意的是，结果不会是随机顺序的。通常使用`limit`子句，您还可以指定`order by`.

# java - Android TableLayout以编程方式匹配列高

> ID：13688176
> 
> 赞同：0
> 
> 时间：2012-12-03T17:04:50.570
> 
> 标签：java, android, android-layout

我正在从java动态创建一个表。我的列是固定宽度的，对于边框，我使用了提供边距和设置列视图背景颜色的技巧。问题是，当 TextView 变为多行时，它会改变整行的高度，在这种情况下，单行的 TextViews 将背景保留为一行并导致空白。我怎样才能使所有视图的列高与最大相同。Matach_Parent 不工作。为了更好地理解，下面是我的表格的图像，空格是我如何填充它们以使我的边框看起来很好且均匀的问题。![在此处输入图像描述](../Images/c003354cfdf56a99b6b293f7cad8b0e8.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T02:57:03.530

只需硬编码每个文本视图的最大行数。在 TextView 类中有一些使用 Java 的方法。

TextView tv = new TextView(context);
tv.setMaxLines(2);

# linux - 为 mediawiki 创建 wiki 文件的 Linux 脚本

> ID：13688178
> 
> 赞同：0
> 
> 时间：2012-12-03T17:04:56.820
> 
> 标签：linux, bash, scripting, mediawiki

嗨，我想创建一个脚本，将附加到现有文件：这是文件的外观：

```
{| border="1" cellspacing="5" cellpadding="2" style="text-align: center;"
|-
! DataStore-1:
! 11/14/12
! 11/16/12
! 11/30/12
|-
| Total ios
| [[File:datastore-1-Tios-11-14-2012.png| 100px]]
| [[File:datastore-1-Tios-11-16-2012.png| 100px]]
| [[File:datastore-1-Tios-11-30-2012.png| 100px]]
|-
| Read % 
| [[File:datastore-1-readp-11-14-2012.png| 100px]]
| [[File:datastore-1-readp-11-16-2012.png| 100px]]
| [[File:datastore-1-readp-11-30-2012.png| 100px]]
|-
| Cache Hit %
| [[File:datastore-1-cachep-11-14-2012.png| 100px]]
| [[File:datastore-1-cachep-11-16-2012.png| 100px]]
| [[File:datastore-1-cachep-11-30-2012.png| 100px]]
|-
| Current kB/sec
| [[File:datastore-1-ckbsec-11-14-2012.png| 100px]]
|  [[File:datastore-1-ckbsec-11-16-2012.png| 100px]]
|  [[File:datastore-1-ckbsec-11-30-2012.png| 100px]]
|-
| Maximum kB/sec 
| [[File:datastore-1-mkbsec-11-14-2012.png| 100px]]
| [[File:datastore-1-mkbsec-11-16-2012.png| 100px]]
| [[File:datastore-1-mkbsec-11-30-2012.png| 100px]]
|-
| Current IO/sec
| [[File:datastore-1-ciosec-11-14-2012.png| 100px]]
| [[File:datastore-1-ciosec-11-16-2012.png| 100px]]
| [[File:datastore-1-ciosec-11-30-2012.png| 100px]]
|-
| Max IO/sec
| [[File:datastore-1-miosec-11-14-2012.png| 100px]]
| [[File:datastore-1-miosec-11-16-2012.png| 100px]]
| [[File:datastore-1-miosec-11-30-2012.png| 100px]]
|-
|} 
```

基本上我希望能够在 DataStore-1 字段下为“日期”添加一个条目，例如：

```
|-
! DataStore-1:
! 11/14/12
! 11/16/12
! 11/30/12
! 12/03/12
|- 
```

一旦我这样做了，我还想为使用相同可变日期的每个其他字段添加一个附加条目，例如：

```
| -
| Total ios
| [[File:datastore-1-Tios-11-14-2012.png| 100px]]
| [[File:datastore-1-Tios-11-16-2012.png| 100px]]
| [[File:datastore-1-Tios-11-30-2012.png| 100px]]
| [[File:datastore-1-Tios-12-03-2012.png| 100px]]  
|-
[...] 
```

我正在考虑为文件的每个部分创建一个函数，但我的逻辑已经足够了......

```
writedates ()
{
        SOURCEFILE=/mnt/bacchuscore-logger/netmon/wikipages/sourcefile.wk
        DATASTORENUM=`head -1 $SOURCEFILE|cut -d '=' -f2`
        DATESECTION=dates.sec
        DATEOUTPUT=newdates.sec
        i=0
        while read; do
                VAR[$i]=$REPLY
                DSN=$(echo ${VAR[0]}|cut -d '=' -f2)
                DSF=$(echo ${VAR[1]}|cut -d '=' -f2)
                DE=$(echo ${VAR[2]}|cut -d '=' -f2)
                echo "! $DSF-$DSN"
                echo "! $DE"
                echo "|-"
                ((i++))
        done < $SOURCEFILE
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T13:15:33.557

这些脚本行在您的文件中插入附加条目，假设变量`date`包含新日期（例如`date=12/03/12`）并且文件名为`datastore`：

```
set ${date//// }; datex=$1-$2-20$3.png
sed -f-<<EOF -i datastore
/^! DataStore-1:/,/^|-/s,^|-,! $date\n&,
/^| Total ios/,/^|-/s,^|-,| [[File:datastore-1-Tios-$datex| 100px]]\n&,
/^| Read %/,/^|-/s,^|-,| [[File:datastore-1-readp-$datex| 100px]]\n&,
/^| Cache Hit %/,/^|-/s,^|-,| [[File:datastore-1-cachep-$datex| 100px]]\n&,
/^| Current kB\/sec/,/^|-/s,^|-,| [[File:datastore-1-ckbsec-$datex| 100px]]\n&,
/^| Maximum kB\/sec/,/^|-/s,^|-,| [[File:datastore-1-mkbsec-$datex| 100px]]\n&,
/^| Current IO\/sec/,/^|-/s,^|-,| [[File:datastore-1-ciosec-$datex| 100px]]\n&,
/^| Max IO\/sec/,/^|-/s,^|-,| [[File:datastore-1-miosec-$datex| 100px]]\n&,
EOF 
```

# shell - Linux Shell 中的嵌套 HashMap？

> ID：13688180
> 
> 赞同：0
> 
> 时间：2012-12-03T17:05:03.003
> 
> 标签：shell, hashmap

我可以在 Linux Shell 中嵌套关联映射吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:15:30.973

是的！

看看`man bash`吧！

（搜索*关联*）

但是如果你想将数组分配给数组，你必须为自己声明子对象，使用他自己的处理程序，而不是你可以将此处理程序作为字符串分配给上层数组：

```
declare -A x
declare -A x_foo
x_foo=([a]=1 [b]=3)
x['foo']=x_foo; 
```

所以

```
echo ${!x[@]}
foo

echo ${x[foo]}
x_foo

eval echo \${${x[foo]}[a]}
1

eval echo \${${x[foo]}[b]}
3

eval echo \${!${x[foo]}[@]}
a b

eval echo \${${x[foo]}[@]}
1 3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T17:39:56.133

不，bash 数组只是一维的。你应该能够构造你的数组键来伪造多维。例如，如果您想要 JSON 对象

```
x = {'foo': {'a': 1, 'b': 2}, 'bar': {'c': 3, 'd', 4}} 
```

在 bash 中，您必须执行类似的操作

```
declare -A x
x[foo,a]=1
x[foo,b]=2
x[bar,c]=3
x[bar,d]=4 
```

并参考，例如

```
i=foo
j=b
echo "${x[$i,$j]}" 
```

# c++ - Callgrind：分析我的代码的特定部分

> ID：13688185
> 
> 赞同：16
> 
> 时间：2012-12-03T17:05:27.627
> 
> 标签：c++, profiling, valgrind, callgrind

我正在尝试通过消除我不关心的噪声和计算来分析（使用 Callgrind）我的代码的特定部分。这是我想做的一个例子：

```
for (int i=0; i<maxSample; ++i) {
    //Prepare data to be processed...
    //Method to be profiled with these data
    //Post operation on the data
} 
```

我的用例是回归测试，我想确保所讨论的方法仍然足够快（自上次实施以来，额外指令不到 10%）。这就是为什么我想要更清晰的输出形式 Callgrind。（我需要一个 for 循环来处理大量数据，以便对我想要分析的方法的行为有一个很好的估计）

我的第一次尝试是将代码更改为：

```
for (int i=0; i<maxSample; ++i) {
    //Prepare data to be processed...
    CALLGRIND_START_INSTRUMENTATION;
    //Method to be profiled with these data
    CALLGRIND_STOP_INSTRUMENTATION;
    //Post operation on the data
}
CALLGRIND_DUMP_STATS; 
```

添加 Callgrind 宏来控制检测。我还添加了 --instr-atstart=no 选项，以确保我只分析我想要的代码部分......

不幸的是，当我开始使用 callgrind 启动我的可执行文件时，使用这种配置，它永远不会结束......这不是缓慢的问题，因为完整的仪器运行持续不到一分钟。

我也试过

```
for (int i=0; i<maxSample; ++i) {
    //Prepare data to be processed...
    CALLGRIND_TOGGLE_COLLECT;
    //Method to be profiled with these data
    CALLGRIND_TOGGLE_COLLECT;
    //Post operation on the data
}
CALLGRIND_DUMP_STATS; 
```

（或 --toggle-collect="myMethod" 选项）但是 Callgrind 没有任何调用就返回给我一个日志（KCachegrind 像雪一样白：（并且说零指令......）

我是否正确使用了宏/选项？知道我需要改变什么才能获得预期的结果吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-04T10:27:45.873

我终于设法解决了这个问题......这是一个配置问题：

我保留了代码

```
for (int i=0; i<maxSample; ++i) {
    //Prepare data to be processed...
    CALLGRIND_TOGGLE_COLLECT;
    //Method to be profiled with these data
    CALLGRIND_TOGGLE_COLLECT;
    //Post operation on the data
}
CALLGRIND_DUMP_STATS; 
```

但是使用**--collect-atstart=no**（并且没有 --instr-atstart=no !!!）运行 callgrind 并且它在合理的时间内（约 1 分钟）完美地工作。

START/STOP 检测的问题是 callgrind 在每次迭代（每次 STOP）时转储一个文件（callgrind.out.#number），因此它真的很慢......（5分钟后，我只有 5000 次运行 300 000 次迭代基准...不适合回归测试）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-08-01T18:29:50.577

在指定用作触发器的方法时，**toggle-collect选项非常挑剔。**您实际上还需要指定它的参数列表，甚至空格也需要匹配！使用与 callgrind 输出中显示的方法名称完全相同的方法名称。例如，我正在使用这个调用：

```
$ valgrind 
    --tool=callgrind 
    --collect-atstart=no 
    "--toggle-collect=ctrl_simulate(float, int)"
    ./swaag 
```

请注意：

*   选项周围的双引号。
*   包括括号的参数列表。
*   逗号字符后的空格。

# python - Django objects.dates('date', 'month') 查询关闭了一个月

> ID：13688191
> 
> 赞同：4
> 
> 时间：2012-12-03T17:05:51.353
> 
> 标签：python, django, datetime

我正在 Django 中建立一个计费系统，但我遇到了一个奇怪的问题。在我的 views.py 中，我进行查询以提取付款的唯一月份。然后，我遍历这个月份列表，以确定每个月支付了多少。

查询有效，它计算的数字是正确的，但是当我通过模板显示它时，它已经关闭了一个月。因此，当我进行查询时，我得到了 6 月的总数，但最终在模板中将月份显示为 5 月。我知道做一个快速破解来完成这项工作很容易，但我想了解为什么会发生这种情况。

下面的代码：

```
# views.py

def reports_index(request):
    payment_months = Payment.objects.dates('date', 'month')
    payments_by_month = []
    for p in payment_months:
         monthly_payment = Payment.objects.filter(date__year=p.year, date__month=p.month).aggregate(Sum('amount'))['amount__sum']
         yearly_payment = monthly_payment * 12
         payments_by_month.append([p, monthly_payment, yearly_payment])

    return render_to_response('reports.html', locals(), context_instance=RequestContext(request))

# reports.html

{% load humanize %}

<table cellpadding="0" cellspacing="0" width="100%" class="tableStatic resize">
        <thead>
            <tr>
                <th>Month</th>
                <th>Monthly Payments Recieved</th>
                <th>Yearly Payment Estimate</th>
            </tr>
        </thead>
        <tbody>
            {% for p in payments_by_month %}
                <tr class="gradeC">
                    <td>{{ p.0|date:"M Y" }}</td>
                    <td style="text-align:center;">${{ p.1|intcomma }}</td>
                    <td style="text-align:center;">${{ p.2|intcomma }}</td>
                </tr>
            {% endfor %}

        </tbody>
     </table> 
```

有没有人见过这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T04:31:45.837

冷酷的！在一些帮助下，看起来我找到了自己问题的答案。

@esauro 建议我检查 {{ p.0.month }} 而不是 {{ p.0|date:"MY" }}，所以这一切都是受到他的启发。

{{ p.0.month }} = 6

{{ p.0|date:"MY" }} = 2012 年 5 月

差异的原因是我的 settings.py 使用时区信息，而我在美国——这使我比格林威治标准时间晚了几个小时并进入前一天。因此是 2012 年 5 月，当我期待 2012 年 6 月时。默认的 Django 设置是这样的：

```
# If you set this to False, Django will not use timezone-aware datetimes.
USE_TZ = True 
```

如果你设置：

```
USE_TZ = False 
```

然后你就没有时区感知的日期时间。问一个后续问题，这是否只发生在 sqlite 上？我只是在运行一个开发服务器，我没有意识到这可能会在开发和生产之间发生变化。

这是我直到现在才真正意识到的事情。DB 有自己的日期和时间结构。Django ORM 有映射，但这取决于你的 Django 设置。TZ 设置的微小变化会在很大程度上影响您以前认为是一成不变的东西。

希望这可以帮助。

# iphone - 从 sip 标头或 msg 正文中获取文本消息

> ID：13688194
> 
> 赞同：1
> 
> 时间：2012-12-03T17:05:55.387
> 
> 标签：iphone, pjsip

我正在尝试获取拨号后发送的服务器文本响应

我得到这样的日志

> 来自：;tag=as121b5ca6
> 
> 收件人：“我”；tag=FP0KRz3fkxBtR6q19Er1ykMXhHCqtqOU
> 
> 呼叫 ID：ltPywl5Qkt5JwdG47.U0K2J.R.YZN0my
> 
> CSeq: 103 消息
> 
> 用户代理：Asterisk PBX 1.6.2.18
> 
> 内容类型：text/plain;charset=UTF-8
> 
> 内容长度：137
> 
> 结果头=STARS1STARSText=STARS 2764 6053 2778 7089 7541 7156 4997 3457 4438 3666 2246 1307 3666 2246 300 4838 7230 4577 4216 3811 STARS

我想获取'ResultHead'

知道我收到很多这样的消息..是否有任何功能（我确定有，但我看不到）仅获取此消息或至少将标头作为字符串获取..

我想我需要使用这个功能，但我不知道怎么用！！

```
static pjsip_rx_data *get_rx_data(pjsip_event *e)
{
  if (e->type == PJSIP_EVENT_RX_MSG)
     return e->body.rx_msg.rdata;

  if (e->type == PJSIP_EVENT_TSX_STATE && e->body.tsx_state.type == PJSIP_EVENT_RX_MSG)
  return e->body.tsx_state.src.rdata;

 // There's no rdata on this eevnt
  return NULL;
 } 
```

*我在 Pjsip ..thnx 上使用 siphon 我希望我的问题很清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T19:38:50.097

看来我最终回答了我的问题

因为至少对我来说很难找到答案..我会发布它，希望有人会利用它..

首先你需要创建新模块并注册它，

首先创建 pjsip_module

```
pj_bool_t logging_on_rx_msg(pjsip_rx_data *rdata);

static pj_status_t logging_on_tx_msg(pjsip_tx_data *tdata);

static pjsip_module my_pjsua_msg_logger = 
```

{

```
 NULL, NULL,                /* prev, next.      */
{ "my_mod-pjsua-log", 13 },     /* Name.        */
-1,                 /* Id           */
PJSIP_MOD_PRIORITY_TRANSPORT_LAYER-1,/* Priority            */
NULL,               /* load()       */
NULL,               /* start()      */
NULL,               /* stop()       */
NULL,               /* unload()     */
&logging_on_rx_msg,         /* on_rx_request()  */
&logging_on_rx_msg,         /* on_rx_response() */
&logging_on_tx_msg,         /* on_tx_request.   */
&logging_on_tx_msg,         /* on_tx_response() */

NULL,               /* on_tsx_state()   */

}; 
```

在 sip_connect 函数中使用

```
 pjsip_endpt_register_module(pjsua_get_pjsip_endpt(), &my_pjsua_msg_logger); 
```

现在执行接收者功能

```
static pj_status_t logging_on_tx_msg(pjsip_tx_data *tdata)
{

/* Important note:
 *  tp_info field is only valid after outgoing messages has passed
 *  transport layer. So don't try to access tp_info when the module
 *  has lower priority than transport layer.
 */

/* Always return success, otherwise message will not get sent! */
return PJ_SUCCESS;
}

pj_bool_t logging_on_rx_msg(pjsip_rx_data *rdata)

{

NSLog(@"\n recieving rx msg %s--end my joy",rdata->msg_info.msg_buf);

if (rdata->msg_info.msg->type == PJSIP_RESPONSE_MSG)

{

   do something 

}

return PJ_FALSE;

} 
```

# c - 是什么导致调用 inb_p() 时出现分段错误？

> ID：13688196
> 
> 赞同：2
> 
> 时间：2012-12-03T14:23:46.713
> 
> 标签：c, linux, io, segmentation-fault, debian

尝试使用 inb_p() 读取端口时出现分段错误。我在英特尔 D525 双核系统（Advantech PCM 9389 SBC）上运行 2.6.6 内核的 D​​ebian 系统上编译它。这是一个说明段错误的示例程序。

可能的原因是什么？我该如何解决？

目前，我没有连接任何设备。这会导致段错误吗？我本来希望得到一个零或一些随机字节，但不是段错误。

我尝试过的其他事情：1）将输入变量声明为int而不是char。2) 使用 iopl() 代替 ioperm()

```
/*
 * ioexample.c: very simple ioexample of port I/O
 * very simple port i/o
 * Compile with `gcc -O2 -o ioexample ioexample.c',
 * and run as root with `./ioexample'.
 */
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/io.h>

#define BASEPORT 0x0100 /* iobase for sample system */
#define FLIPC 0x01
#define FLIPST 0x0
#define DIPSWITCH 0x25

int main()
{
char cinput;

  cinput = 0xff;
  setuid(0);
  printf("begin\n");
  /* Get access to the ports */
  if (ioperm(BASEPORT+DIPSWITCH, 10, 1)) 
  {
     perror("ioperm");
     exit(EXIT_FAILURE);
  }

  printf("read the dipswitch with pause\n");
  cinput = inb_p(BASEPORT+DIPSWITCH); // <=====SEGFAULT HERE

  /* We don't need the ports anymore */
  if (ioperm(BASEPORT+DIPSWITCH, 10, 0))
  {
     perror("ioperm");
     exit(EXIT_FAILURE);
  }

  printf("Dipswitch setting: 0x%X", cinput); 
  exit(EXIT_SUCCESS);
}

/* end of ioexample.c */ 
```

输出：

```
root@debian:/home/howard/sources# ./ioexample
begin
read the dipswitch with pause
Segmentation fault 
```

编辑：/proc/ioports 没有列出地址 0x100 的任何内容，因此我尝试了列出的其他几个端口地址，结果相同。然后我决定尝试*输出*到已知的并行端口位置（0x0378），并且 outb 没有导致段错误。但是，尝试读取 0x378 或 0x379*确实*会导致段错误。我开始怀疑问题与硬件有关。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T17:15:59.823

我发现了问题。除了要读取的端口之外，对 inb_p() 的调用还需要访问端口 0x80。

显然，当我尝试 iopl() 时，我没有正确调用它，因为这应该有效。

以下代码消除了段错误：

```
 /* Get access to the ports */
  if (ioperm(0x80, 1, 1)) 
  {
     perror("ioperm");
     exit(EXIT_FAILURE);
  }
  if (ioperm(BASEPORT+DIPSWITCH, 10, 1)) 
  {
     perror("ioperm");
     exit(EXIT_FAILURE);
  } 
```

# javascript - 谷歌图表图表区域不透明度？

> ID：13688208
> 
> 赞同：1
> 
> 时间：2012-12-03T17:06:42.540
> 
> 标签：javascript, google-visualization

如何设置 chartArea 不透明度？这是我的一段代码......任何想法都会有所帮助。谢谢！

```
 // Column Chart
              function drawVisualization() {
    // Create and populate the data table.
    var data = google.visualization.arrayToDataTable([
      ['Year', 'In Millions'],
      ['2010',  178.7],
      ['2011',  211.693],
      ['2012',  199.3]
    ]);

    // Create and draw the visualization.
    new google.visualization.ColumnChart(document.getElementById('visualization')).
        draw(data,
             {title:"",
              width:400, height:400,
              colors:['#89a7bf', '#b19237', '#698322', '#bf855d', '#196364', '#CCCCCC', '#D64646', '#8E468E'],
              legend: {position: 'bottom', width:"250", textStyle: {fontSize: 10}},
              hAxis: {title: "Year"}}
        );
  }

  google.setOnLoadCallback(drawVisualization); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:58:34.140

抱歉，该选项`areaOpacity`仅在以下图表中可用：

> 可视化：地理图表
> 
> 可视化：面积图
> 
> 可视化：组合图
> 
> 可视化：气泡图
> 
> 可视化：动态图表
> 
> 可视化：阶梯面积图

对于上面的图表，谷歌说：

> 面积图系列下彩色区域的默认不透明度，其中 0.0 表示完全透明，1.0 表示完全不透明。要为单个系列指定不透明度，请在系列属性中设置 areaOpacity 值。

# html - HTML5 地理位置将纬度和经度传递给 PHP 页面

> ID：13688211
> 
> 赞同：1
> 
> 时间：2012-12-03T17:06:51.397
> 
> 标签：html, geolocation

我有一小段代码，我想收集纬度和经度坐标，然后将它们传递给 php 页面。

但是代码似乎没有将变量传递给 php 页面。

以下是代码，任何建议将不胜感激。

```
 if(navigator.geolocation)
  {
  navigator.geolocation.getCurrentPosition(function(position)
   {
  var lat = position.coords.latitude;
  var lon = position.coords.longitude;
   document.location = "test1.php?lat=" + latitude + "&lon=" + 
                   longitude;

    });
 } 
```

谢谢

李

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:14:12.593

看起来有一个简单的变量名不匹配。您定义`lat`and`lon`但在下一行使用`latitude`and 。`longitude`尝试将它们更改为同一对。

# html - 这些特殊的元标记应用于哪里？

> ID：13688213
> 
> 赞同：0
> 
> 时间：2012-12-03T17:06:56.340
> 
> 标签：html, seo

在 Windows 8 网站上，当我查看他们编写的代码时，我发现了一些我认为不常用的元标记。

[http://windows.microsoft.com/en-US/windows/cougar-mountain-zoo-download-theme](http://windows.microsoft.com/en-US/windows/cougar-mountain-zoo-download-theme)

那种代码是在公司内部使用还是应用到每个人的网站上？

```
<meta name="MS.PageId" content="839880" />
<meta name="MS.PageVer" content="49" />
<meta name="MS.Nav.Level" content="3" />
<meta name="MS.Nav.Channel" content="Download-Shop" />
<meta name="MS.Culture" content="en-US" />
<meta name="Search.os" content="Windows" />
<meta name="Search.Product" content="eADQiWindows 7XVcnh" />
<meta name="Search.Product" content="eADQiWindows 8XVcnh" />
<meta name="Search.Product" content="eADQiWindows RTXVcnh" />
<meta name="Search.SupportedOS" content="eADQiWindows 7XVcnh" />
<meta name="Search.SupportedOS" content="eADQiWindows 8XVcnh" />
<meta name="Search.SupportedOS" content="eADQiWindows RTXVcnh" />
<meta name="Search.AppliesTo" content="WOL" />
<meta name="Search.PageTitle" content="Cougar Mountain Zoo theme" />
<meta name="Description" content="Enjoy the menagerie in this free theme for Windows featuring the inhabitants of Cougar Mountain Zoo." />
<meta name="Search.Culture" content="eADQien-USXVcnh" />
<meta name="msapplication-TileImage" content="http://res1.windows.microsoft.com/Resources/3.6/WOL/shared/images/Win8_Logo_144x144.png" />
<meta name="msapplication-TileColor" content="#1A1A1A" />
<meta name="MS.BIAuthStateLoggingDisabled" content="true" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T14:46:05.910

外部**描述**，这些都没有被谷歌考虑，而且大多数看起来都非常特定于微软和他们自己的系统。他们的名字中有“ms”或乱码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:10:19.030

这些主要用于搜索引擎优化 SEO。它们不会向用户界面添加任何内容，而是可解析的文本。

这些也用于指定作者和关键字信息。

# javascript - ExtJS：容器默认样式从何而来？

> ID：13688223
> 
> 赞同：0
> 
> 时间：2012-12-03T17:07:20.633
> 
> 标签：javascript, css, extjs, extjs4, extjs4.1

这就是我在 JavaScript 中指定“空白”容器的方式：

> Ext.create('Ext.container.Container');

以下屏幕截图显示了`style`我的容器默认具有的属性（`div`选择了有问题的属性）：

![在此处输入图像描述](../Images/743885d9b1f1a5d177934e9b2605c916.png)

如您所见，它具有：

```
style="left: 0px; top: 9px; margin: 0px;" 
```

1.  这是从哪里来的？
2.  *默认情况下*，我如何“清理”它以使其完全*没有*样式？我没有在容器上指定，所以我不知道这是从哪里来的。*`style`*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:11:12.120

此设置来自布局。如果你想摆脱它，你可以`layout: auto`在容器配置中指定。

示例：http: [//jsfiddle.net/rr2Vx/](http://jsfiddle.net/rr2Vx/)*

# android - 检查 ads:testdevice 是否正常工作？

> ID：13688225
> 
> 赞同：0
> 
> 时间：2012-12-03T17:07:24.033
> 
> 标签：android, admob

我把它放在我的 LinearLayout

```
 <com.google.ads.AdView
        android:id="@+id/adView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        ads:adSize="BANNER"
        ads:adUnitId="d7fd8f9ghf042k4"
        ads:loadAdOnCreate="true"
        ads:testDevices="34HF70000000G501" /> 
```

我仍在测试我的应用程序，但是当我检查我的 AdMob 帐户时，我发现了这一点：

![在此处输入图像描述](../Images/b7518a9af721a83acebe68009c354984.png)

我不明白，这是怎么回事？我可以通过点击自己的广告获得收入吗？`ads:testDevices="34HF70000000G501"`如果是，当我在 XML 布局中提到这一行时，怎么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T05:36:08.943

您放入的 ID`ads:testDevices`需要是在设备上加载广告请求时在 LogCat 中输出的哈希设备 ID。如果您使用您的实际设备 ID，它将不起作用。

# ajax - 过滤太快问题

> ID：13688226
> 
> 赞同：0
> 
> 时间：2012-12-03T17:07:26.370
> 
> 标签：ajax, extjs, filter, loading, onchange

在 ExtJS 4.1.3 中，我们在文本字段上设置了一个过滤器来运行文本字段的“onchange”。这是 onchange 函数：

```
var store = this.getStore();
value = field.getValue();

if (value.length > 0) {
    // Param name is ignored here since we use custom encoding in the proxy.
    // id is used by the Store to replace any previous filter
    store.filter({
        id: 'query',
        property: 'query',
        value: 'LegalName|#|#|' + value
    });

} else {
    store.clearFilter();
} 
```

现在，我们遇到了一个问题，当我在文本字段中输入内容太快时，我会收到错误并卡在加载屏幕上。当我慢慢输入相同的内容时，它会起作用。考虑慢慢输入它会使其工作，但快速使其失败并且从服务器返回的数据在两种情况下都是相同的，我假设这是 ExtJS 的问题。有没有人见过这样的问题？什么是潜在的问题和修复。我无法弄清楚它为什么会破裂。这是我得到的线索：

```
Uncaught TypeError: Cannot convert null to object ext-all-debug.js:51752
    Ext.define.cancelAllPrefetches ext-all-debug.js:51752
    Ext.util.Event.Ext.extend.fire ext-all-debug.js:8638
    Ext.define.continueFireEvent ext-all-debug.js:25117
    Ext.define.fireEvent ext-all-debug.js:25095
    Ext.define.clear ext-all-debug.js:44718
    Base.implement.callParent ext-all-debug.js:3735
    Ext.define.clear ext-all-debug.js:47485
    Base.implement.callParent ext-all-debug.js:3735
    PageMap.Ext.Class.clear ext-all-debug.js:52358
    Ext.define.filter ext-all-debug.js:51377
    Ext.define.onTextfieldChange /TEST/app/view/ContractGrid.js?_dc=1354553533935:447
    Ext.util.Event.Ext.extend.fire ext-all-debug.js:8638
    Ext.define.continueFireEvent ext-all-debug.js:25117
    Ext.define.fireEvent ext-all-debug.js:25095
    Ext.override.fireEvent ext-all-debug.js:58382
    Ext.define.checkChange ext-all-debug.js:30310
    call ext-all-debug.js:8426 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:11:38.943

我能够通过更改商店中的缓冲区设置来解决此问题。看起来我在商店中将 'buffered' 设置为 true ，一旦我删除它，问题就消失了。

# iphone - iOS / Core Data - 从 NSSet 关系返回数组的最佳方式？

> ID：13688231
> 
> 赞同：1
> 
> 时间：2012-12-03T17:07:43.737
> 
> 标签：iphone, ios, ipad, core-data, nsset

我正在创建一个应用程序并使用核心数据存储数据。它工作正常，但我想知道从 set 返回排序数组的最佳方法是什么？

例如，我有一个实体 A（按钮），其中包含实体 B（图像）的列表。众所周知，核心数据使用 NSSet 存储多对多关系。但我想跟踪最初的订单，所以我为此添加了一个属性“订单”。问题是在我的代码中我需要排序的图像列表，所以在一个类别文件（按钮+创建）中我创建了一个像这样的方法：

```
- (NSArray*)imagesArray
{
    return [self.images sortedArrayUsingDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDeacriptorWithKey:@"order" ascending:YES]]];
} 
```

但我认为这不是最好的方法，因为如果需要从我的代码中的多个区域（不同的类）访问这个列表，那么我需要对集​​合进行 x 次排序......有没有办法添加一个数组（属性）在我的类别中排序一次然后只检索属性？

你对此有什么看法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:44:42.417

您可以将属性添加到类别：http: [//developer.apple.com/library/ios/#documentation/cocoa/Conceptual/ObjectiveC/Chapters/ocAssociativeReferences.html](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/ObjectiveC/Chapters/ocAssociativeReferences.html)

这是另一个例子：

[如何通过类别扩展向 NSMutableArray 添加属性？](https://stackoverflow.com/questions/4071500/how-to-add-properties-to-nsmutablearray-via-category-extension)

**但**

请注意，您将负责观察初始 coredata NSSet 属性的更改（例如通过 KVO）。
因此，如果发生更改，您必须正确“重新计算”您的属性......
如果您的目标是 iOS 5.0 或更高版本，我建议使用有序集，但由于您不是，我可以想象使用描述的方式在上面的链接中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:15:43.203

我认为您使用 order 属性的方法是正确的。我宁愿在我的模型中创建一个类似 -(NSArray *)sortedItems 的方法，它会有一个带有适当排序描述符的 NSFetchRequest。如果您愿意，可以缓存结果 - 将此数组保存在内存中。您的 NSManagedObject 也可以具有不存储在数据库中的属性，只是在内存中。但考虑到 Core Data 的速度和性能，我真的认为这没有必要。

# asp.net - 如何将字典对象添加到 IEnumerable

> ID：13688232
> 
> 赞同：0
> 
> 时间：2012-12-03T17:07:44.187
> 
> 标签：asp.net, vb.net, list, ienumerable

我目前正在尝试将字典（字符串，字符串）添加到 Ienumerable（字典（字符串，字符串））

看起来很简单，但我找不到答案...如果您需要更好的解释，这是我的代码

```
Dim actualList As IEnumerable(Of Dictionary(Of String, String))

Dim addRows As New Dictionary(Of String, String)
        addRows.Add("LinkTitle", "Ultimate Test Item") 
```

我想就在这里，我会尝试将 addrows 放入实际列表中，但是我在这样做时遇到了麻烦......

```
'this sends our custom dictionary to sharepoint
        Dim updateOutput = ListServiceUtility.UpdateListItems(Test_Sharepointsite_url, myCred, Test_List_Name, Nothing, addRows.AsEnumerable, 1) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:21:55.530

IEnumerable 没有您正在寻找的 .Add 功能，请尝试使用 List 代替：

```
 Dim actualList As New List(Of Dictionary(Of String, String))

    Dim addRows As New Dictionary(Of String, String)
    addRows.Add("LinkTitle", "Ultimate Test Item")

    Dim addRows2 As New Dictionary(Of String, String)
    addRows2.Add("LinkTitle2", "Ultimate Test Item2")

    actualList.Add(addRows)
    actualList.Add(addRows2) 
```

进一步阅读：[IEnumerable 和 Array、IList 和 List 有什么区别？](https://stackoverflow.com/a/764756/771928)

# entity-framework - 如何将 URL 列表映射到 JSON 字符串

> ID：13688236
> 
> 赞同：0
> 
> 时间：2012-12-03T17:08:00.080
> 
> 标签：entity-framework

我有一个存储 URL 列表的 POCO 对象，我想将它存储在序列化版本的字符串列中。如何首先使用 EF 代码实现这一点？

```
class MyProfile {
    public int Id {get; set; }
    public IList<Url> Images {get; set}
} 
```

我希望能够将它存储在一个表中：

```
1,["http1", "http2"]
2,["http3", "http4", "http5"]
etc. 
```

# javascript - JavaScript style.display="none" 还是 jQuery .hide() 更高效？

> ID：13688238
> 
> 赞同：81
> 
> 时间：2012-12-03T17:08:06.733
> 
> 标签：javascript, jquery, css, performance

```
document.getElementById("elementId").style.display="none" 
```

在 JavaScript 中用于隐藏元素。但是在 jQuery 中，

```
$("#elementId").hide(); 
```

用于相同目的。哪种方式更有效？我已经看到了两个 jQuery 函数`.hide()`和`.css("display","none")` [这里](https://stackoverflow.com/q/4396983/1774964)的比较。

但我的问题是纯 JavaScript 是否比 jQuery 更高效？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2012-12-03T17:09:38.433

谈效率：

```
document.getElementById( 'elemtId' ).style.display = 'none'; 
```

* * *

jQuery 使用其`.show()`和`.hide()`方法所做的是，它会记住元素的*最后状态*。这有时会派上用场，但既然你问到效率，这里并不重要。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-12-03T17:14:13.630

```
a = 2; 
```

对比

```
a(2);
function a(nb) {
    lot;
    of = cross;
    browser();
    return handling(nb);
} 
```

在**您**看来，您认为最快的是什么？

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-12-03T17:10:43.903

在 99.999999% 的情况下，效率对于这样的事情并不重要。做任何更容易阅读和/或维护的事情。

在我的应用程序中，我通常依靠类来提供隐藏和显示功能，例如`.addClass('isHidden')/.removeClass('isHidden')`，如果我愿意，我可以使用 CSS3 为事物制作动画。它提供了更大的灵活性。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-03T17:09:13.773

是的。

是的。

[Vanilla JS](http://vanilla-js.com/)总是更高效。

# c# - 忽略 C# 中的接口方法实现

> ID：13688243
> 
> 赞同：4
> 
> 时间：2012-12-03T17:08:32.593
> 
> 标签：c#, oop

假设一个接口`I`有两个方法。例如`Method1()`和`Method2()`。

一个类`A`实现一个接口`I`。

类是否可以`A`仅实现`Method1()`并忽略`Method2()`？

我知道根据规则类`A`必须编写这两种方法的实现。我想问有没有办法违反这个规则？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T17:11:26.763

您可以避免实现它（一个有效的场景），但不能完全忽略它（一个有问题的场景）。

```
public interface IFoo
{
    void A();
    void B();
}

// This abstract class doesn't know what to do with B(), so it puts
// the onus on subclasses to perform the implementation.
public abstract class Bar : IFoo
{
    public void A() { }
    public abstract void B();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-03T17:10:47.660

不，可选接口成员的 C# 中没有这样的概念。如果`A`implements `I`，那么它必须为所有`I`的成员提供一些实现，即使实现什么也不做或只抛出一个异常。

```
public class A : I
{
    public void Method1()
    {
        // Do nothing.
    }

    public void Method2()
    {
        throw new NotImplementedException();
    }
} 
```

从设计的角度来看，为什么要在静态类型语言中这样做呢？此外，为什么不只有两个接口？

```
public interface I1 { void Method1(); }

public interface I2 { void Method2(); } 
```

使用这样编码的接口，您可以拥有实现一个接口或另一个接口，或两者兼有，或两者都不实现的类。对我来说，无论如何这更有意义。

* * *

**更新 2018-06-13**

C# lang Git Hub正在对默认接口方法[提出建议](https://github.com/dotnet/csharplang/blob/master/proposals/default-interface-methods.md)。简而言之，接口开发人员将能够在接口本身中为一个或多个方法提供实现，并且在其类或结构上使用接口的开发人员不必显式地实现这些方法。不完全是 OP 所要求的，但可能有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-03T17:11:38.773

您必须实现类继承的接口的所有方法。没有办法解决这个问题。但是您可以使用显式接口实现来隐藏该方法。

这样，用户就不会看到以类为类型的变量上的方法，但是当他转换为接口时，他可以调用该方法。

```
class A : I
{
  void I.Method2()
  {
    throw new NotSupportedException();
  }
} 
```

然后

```
A a;
a.Method2(); //doesn't compile
I i = a;
i.Method2(); //works 
```

如果类`A`只是抽象基类，也可以用`abstract`方法实现接口，具体实现留给派生类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-03T17:11:19.547

不，没有。

但是你可以编码：

```
public void Method2(){
    throw new NotImplementedException();
} 
```

这将通知应用程序无法从此实例调用此方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-03T17:11:42.190

是的，如果我是一个类，但不是，如果它是一个接口。

# python - 集合计数器未对总值求和

> ID：13688249
> 
> 赞同：0
> 
> 时间：2012-12-03T17:08:51.833
> 
> 标签：python, python-2.7

我正在尝试使用 collections.counter 方法来计算每个键的值的数量。因此，当我遍历我的数据库时，我希望它保持对找到值的次数的计数。相反，它每次出现在数据库中时都会打印一个值。这是我使用的函数的代码：

```
def clusters(tweetLocation):
    cityCount=None
    cities = {"London":[51.50722, -0.12750], "New York":[-74.006605 ,40.714623]}
    for k,v in cities.items():
        if distance.distance(v, tweetLocation).miles < 50:
            cityCount=k
        else:
            pass 
    return cityCount 
```

脚本的代码：

```
city_counter=[]
while cursor.alive:#cursor reads all relevant values from the DB
    try:
        doc = cursor.next()
        if not doc['coordinates']:         
            placeName = doc['place']['full_name']
            loc = g.geocode(placeName)
            time.sleep(0.15)
            city_counter=Counter([clusters([loc])])                        
        else: 
            places = doc['coordinates']['coordinates']            
            city_counter=Counter([clusters([places])])
    except (ValueError, geocoders.google.GQueryError):
        pass
    except StopIteration:
        break
print city_counter 
```

所以宁愿返回类似的东西：

```
Counter({New York: 25, London: 15}) 
```

我得到：

```
Counter({None: 1})
Counter({None: 1})
Counter({New York: 1})
Counter({None: 1})
...... 
```

我以前从未使用过 collections.counter，但我认为它会返回值的总和。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:16:57.857

当您调用时，`Counter()`您会创建一个计数器对象。要添加它，请使用它的`update()`方法。看起来您可能想要创建一个存储在中的 Counter 对象`city_counter`，然后在您的循环调用中`city_counter.update([clusters([loc])])`

有关更多信息，请参阅[文档](http://docs.python.org/2/library/collections.html#collections.Counter)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:17:47.173

问题是您每次都在创建一个新的`Counter`，因此每次都会返回一个新的。您在这里有三个选择：

### 一次获取所有值，然后创建`Counter`

基本上，这将涉及您一次获取整个城市列表，然后将其推入`Counter`.

```
cities = []
while cursor.alive:
    try:
       cities.append(cursor.next())
    except StopIteration:
       break
print collections.Counter(cities.keys()) 
```

### 更新`Counter`每个新的`doc`

为此，您所要做的就是确保您`Counter`首先创建了一个，然后使用该`update`方法。

```
city_counter = collections.Counter()
while cursor.alive:
     city_counter.update([clusters[places]])
     # etc. 
```

### 用一个`defaultdict`

对于您的情况，这可能是最佳选择。

```
city_counter = collections.defaultdict(int)
while cursor.alive:
    city_counter[clusters[places]] += 1
    # etc. 
```

# eclipse - 有没有办法让包资源管理器在 Eclipse 中显示具有 TODO 的程序集？

> ID：13688253
> 
> 赞同：1
> 
> 时间：2012-12-03T17:08:53.523
> 
> 标签：eclipse

在任务视图中，我可以看到我所有的 TODO。这很好，除了我继承了很多遗留代码，这些代码有很多永远不会完成的 TODO。我认为如果有任何待办事项，则不应将项目视为已完成（这是针对我的团队的，我不是在这里提倡哲学）。所以我想在不查看遗留代码的情况下查看我的 TODO。

有没有一种方法可以让包资源管理器像警告和图标那样为我的 TODO 项目的图标添加注释？然后我可以使用它来快速查看我需要处理哪些项目，而不是通过任务列表进行挖掘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:35:39.653

您可以创建自定义**任务标签**，并使用它代替`TODO`标签。

从 Preferences 搜索**Task Tags**，选择您感兴趣的类别（例如**Java** --> **Compiler** --> **Task Tags**）并添加一个具有您选择的名称的新标签。

然后，您可以从任务列表的**视图菜单**（任务列表右上角的箭头）控制任务列表中显示的内容，选择**配置内容**并添加**描述文本**等于您的自定义标签名称的**新**配置。选择新配置并取消选择，带有自定义标签注释的任务将出现在任务列表中。**`TODOs`**

 **您可以随时为您的自定义标签添加**模板**以便于访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-15T08:17:47.187

如果这对某人仍然很有趣：

[有一个名为Task Tag Decorator](https://marketplace.eclipse.org/content/task-tag-decorator)的插件。

目前唯一的缺点是它不支持最新的 Eclipse 版本（最后一次支持是 2018-09 (4.9)）。希望尽快添加对当前版本的支持。**

# java - Displaytag / Spring MVC 分页

> ID：13688260
> 
> 赞同：0
> 
> 时间：2012-12-03T17:09:20.047
> 
> 标签：java, jsp, displaytag

我有一个基于 Spring MVC 的 JSP 页面，它使用 Displaytag 来显示一组数据。在页面上的表单中，用户可以选择两个复选框中的一个或两个，以显示他们想要查看的数据子集（设置“O”、设置“Q”或“B”两者。）

表单和显示在第一页上工作正常，但表格底部的 Displaytag 分页链接包含格式错误的 URL。结果是，当用户单击链接以显示不同的页面时，复选框被重置并且用户总是看到“O 和 Q”，即使他们只想看到“Q”（例如）。

我已将此参数添加到 Displaytag 用于生成这些 URL 的表单中（根据 Displaytag 文档），但生成的 URL 中的值不会改变。

表单条目（type="o"）：

```
<input type="hidden" id="type" name="type" value="o"> 
```

分页 URL（两者的 type="b"）：

```
http://localhost:8080/searchmain.html?d-443691-p=3&endDate=&_stateQuote=on&type=b&stateOrder=true 
```

任何人都可以对此有所了解吗？

有谁知道 URL 参数是如何生成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T14:45:52.970

找到了答案 - 将其发布在这里，希望对其他人有所帮助。

Displaytag 使用初始 HTTP 请求中的参数而不是响应中的参数为其分页生成 URL 参数。因此，如果您依赖一些返回的更新参数（如本例所示），那么您的分页将产生不正确的结果。在这种情况下，页面上的两个复选框被用来更新隐藏的“类型”字段，然后在响应中传回。不幸的是，分页 URL 已使用 REQUEST 中的“type”字段更新，该字段仍包含先前未更新的值（例如“B”），而不是新的更新值“O”。

无论您希望在 URL 中找到什么值，都必须在您传入的 HTTP REQUEST 中，您不能指望利用 RESPONSE 中的任何内容。

有道理，只是花了一段时间才找到它。

如果您想查看实际代码，它位于[Displaytag](http://sourceforge.net/projects/displaytag/)源中 TableTag.java 中的此例程中：

```
protected void initHref(RequestHelper requestHelper) 
```

# android - 调用旧启动器（Android HOME）

> ID：13688261
> 
> 赞同：0
> 
> 时间：2012-12-03T17:09:23.370
> 
> 标签：android

我有一个应用程序被复选框标记为默认...

在清单中使用这些设置：

`<category android:name="android.intent.category.HOME" /> <category android:name="android.intent.category.DEFAULT" /> <category android:name="android.intent.category.LAUNCHER" />`

从我的应用程序中，我需要调用 Android 之家，**而不是**我的默认应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:18:36.160

您可以使用其包和类名而不是类别来启动活动，但这里的技巧是您需要知道要启动哪个包/类。您不能安全地假设在通用设备上启动什么包/类，但是您可以使用 PackageManager 枚举设备所具有的所有内容；只需使用 android.intent.category.HOME 类别查找其他内容并启动它。如果有不止一种选择，您需要决定如何进行。

# cloudcontrol - 对多个应用程序使用相同的 cloudControl MySQLd 插件

> ID：13688264
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:09:25.583
> 
> 标签：cloudcontrol

我不清楚 cloudControl MySQLd 插件是如何工作的。我对 MySQLd 的理解是它是一个 MySQL 服务器，可以/将与无限的应用程序一起工作。

但由于所有插件都仅基于应用程序，这也可能意味着我不能在多个应用程序上使用相同的 MySQLd 服务器。

谁能帮助我了解一个 MySQLd 实例是否可以与 cloudControl 上托管的多个应用程序一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:47:46.743

cloudControl PaaS 有两个概念。应用程序和部署。应用程序基本上只是将开发人员和部署组合在一起。每个部署都是应用程序的不同运行版本，来自与部署名称匹配的分支。有关这方面的更多详细信息，请参阅[应用程序、用户和部署文档](https://www.cloudcontrol.com/dev-center/Platform%20Documentation#apps-users-and-deployments)。

所有附加组件始终按部署进行。我们这样做是因为这样我们可以提供所有凭据作为运行时环境的一部分。这意味着您不必在版本控制文件中拥有凭据。在分支之间合并时，这是一个巨大的好处，因为您不会冒着意外与开发部署中的实时数据库交谈的风险。此外，附加凭据可以随时根据附加提供商的判断进行更改。

出于这个原因，部署之间的分离很有意义。例如，通常您的开发部署也不需要与生产部署相同的数据库功能。因此，您可以轻松地使用较小的计划甚至共享数据库（例如 MySQL）进行开发。[您可以在附加组件文档](https://www.cloudcontrol.com/dev-center/Platform%20Documentation#add-ons)中阅读有关如何在代码中使用此功能的更多信息。

同样如前所述，附加凭据始终作为运行时环境的一部分提供。现在，凭据可以随时根据附加提供商的判断进行更改。这些更改会自动在环境中提供，并且应用程序进程会重新启动。如果您按照第二个应用程序的要求对凭据进行了硬编码，这意味着该应用程序可能会遇到停机时间。

最后但同样重要的是，从不同存储库中的两个不同代码库连接到同一个数据库通常是非常糟糕的做法，这将是拥有第二个应用程序的原因。这会导致各种潜在的冲突和依赖关系，使代码更改和数据库迁移随着时间的推移极难维护。推荐的方法是让数据只属于一个代码库，并提供一个 API 来从第二个代码库访问该数据。

尽管如此，技术上可以将多个部署甚至应用程序连接到同一个附加组件（数据库或其他任何东西），但强烈建议不要这样做。

如果您有充分的理由将两个应用程序/部署连接到同一个数据库，我建议您在 Amazon 手动启动一个 RDS 实例（MySQLd 基于 RDS），并通过自定义配置插件为您的两个应用程序提供凭据应用程序/部署。

我希望这能回答你的问题并解释原因。

# apache - Apache 日志格式添加引号和反斜杠

> ID：13688270
> 
> 赞同：0
> 
> 时间：2012-12-03T17:09:38.547
> 
> 标签：apache, logging

在`httpd.conf`我将 LogFormat 设置为：

```
LogFormat "%t %{client-ip}i \"%{X-Forwarded-For}i\" %l %u \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" sessid=%{SESSID}C **guid=%{guid}C** req_guid=%{X-Hcom-Info}o" netscaler 
```

问题在于 guid cookie 值的记录方式： `guid=\"357ceacc-d2fb-458d-bc53-c6d1384d47dd:1107014198\"`

它在 guid 周围添加了 \" \" - 可能是因为 :1107014198 部分。

我如何让 apache 将 guid 记录为： `guid=357ceacc-d2fb-458d-bc53-c6d1384d47dd:1107014198` 即没有 \" \"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-31T16:25:16.707

添加 \"\" 字符的可能不是 Apache。guid 变量可能已经有了这些。您需要弄清楚 guid 变量的设置位置，并确保当时没有引用它。

# javascript - 如何启动弹出灯箱 onLoad？

> ID：13688271
> 
> 赞同：0
> 
> 时间：2012-12-03T17:09:42.233
> 
> 标签：javascript, jquery, html

我想做一个灯箱弹出窗口。我希望它在网页加载时弹出并在他们单击灯箱弹出窗口时关闭它。我怎样才能做到这一点？

这是我到目前为止所拥有的，但它不起作用。

文件：

```
<!doctype html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<title>Lightbox 2</title>
<meta name="description" lang="en" content="testing" />
<meta name="author" content="Lokesh Dhakar">
<meta name="viewport" content="width=device-width">
<link rel="shortcut icon" type="image/ico" href="images/favicon.gif" /> 
<link rel="stylesheet" href="css/screen.css" type="text/css" media="screen" />
<link rel="stylesheet" href="css/lightbox.css" type="text/css" 
    media="screen" />
<link 
    href='http://fonts.googleapis.com/css?family=Fredoka+One|Open+Sans:400,700'
    rel='stylesheet' type='text/css'>

</head>
<body>
<a href="images/examples/image-1.jpg" rel="lightbox">
    <img src="images/examples/thumb-1.jpg" alt="" /></a>
<a href="images/examples/image-2.jpg" rel="lightbox" 
    title="Optional caption."><img src="images/examples/thumb-2.jpg" 
    alt="" /></a>
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/lightbox.js"></script>
</body>
</html> 
```

JS文件：

```
(function() {
  var $, Lightbox, LightboxOptions;

  $ = jQuery;

  LightboxOptions = (function() {

function LightboxOptions() {
  this.fileLoadingImage = 'images/loading.gif';
  this.fileCloseImage = 'images/close.png';
  this.resizeDuration = 700;
  this.fadeDuration = 500;
  this.labelImage = "Image";
  this.labelOf = "of";
}

return LightboxOptions;

  })();

  Lightbox = (function() {

function Lightbox(options) {
  this.options = options;
  this.album = [];
  this.currentImageIndex = void 0;
  this.init();
}

Lightbox.prototype.init = function() {
  this.enable();
  return this.build();
};

Lightbox.prototype.enable = function() {
  var _this = this;
  return $('body').on('click', 'a[rel^=lightbox], area[rel^=lightbox]', function(e) {
    _this.start($(e.currentTarget));
    return false;
  });
};

Lightbox.prototype.build = function() {
  var $lightbox,
    _this = this;
  $("<div>", {
    id: 'lightboxOverlay'
  }).after($('<div/>', {
    id: 'lightbox'
  }).append($('<div/>', {
    "class": 'lb-outerContainer'
  }).append($('<div/>', {
    "class": 'lb-container'
  }).append($('<img/>', {
    "class": 'lb-image'
  }), $('<div/>', {
    "class": 'lb-nav'
  }).append($('<a/>', {
    "class": 'lb-prev'
  }), $('<a/>', {
    "class": 'lb-next'
  })), $('<div/>', {
    "class": 'lb-loader'
  }).append($('<a/>', {
    "class": 'lb-cancel'
  }).append($('<img/>', {
    src: this.options.fileLoadingImage
  }))))), $('<div/>', {
    "class": 'lb-dataContainer'
  }).append($('<div/>', {
    "class": 'lb-data'
  }).append($('<div/>', {
    "class": 'lb-details'
  }).append($('<span/>', {
    "class": 'lb-caption'
  }), $('<span/>', {
    "class": 'lb-number'
  })), $('<div/>', {
    "class": 'lb-closeContainer'
  }).append($('<a/>', {
    "class": 'lb-close'
  }).append($('<img/>', {
    src: this.options.fileCloseImage
  }))))))).appendTo($('body'));
  $('#lightboxOverlay').hide().on('click', function(e) {
    _this.end();
    return false;
  });
  $lightbox = $('#lightbox');
  $lightbox.hide().on('click', function(e) {
    if ($(e.target).attr('id') === 'lightbox') _this.end();
    return false;
  });
  $lightbox.find('.lb-outerContainer').on('click', function(e) {
    if ($(e.target).attr('id') === 'lightbox') _this.end();
    return false;
  });
  $lightbox.find('.lb-prev').on('click', function(e) {
    _this.changeImage(_this.currentImageIndex - 1);
    return false;
  });
  $lightbox.find('.lb-next').on('click', function(e) {
    _this.changeImage(_this.currentImageIndex + 1);
    return false;
  });
  $lightbox.find('.lb-loader, .lb-close').on('click', function(e) {
    _this.end();
    return false;
  });
};

Lightbox.prototype.start = function($link) {
  var $lightbox, $window, a, i, imageNumber, left, top, _len, _ref;
  $(window).on("resize", this.sizeOverlay);
  $('select, object, embed').css({
    visibility: "hidden"
  });
          $('#lightboxOverlay').width($(document).width()).height($(document).height()).fadeIn(this.options.fadeDuration);
  this.album = [];
  imageNumber = 0;
  if ($link.attr('rel') === 'lightbox') {
    this.album.push({
      link: $link.attr('href'),
      title: $link.attr('title')
    });
  } else {
    _ref = $($link.prop("tagName") + '[rel="' + $link.attr('rel') + '"]');
    for (i = 0, _len = _ref.length; i < _len; i++) {
      a = _ref[i];
      this.album.push({
        link: $(a).attr('href'),
        title: $(a).attr('title')
      });
      if ($(a).attr('href') === $link.attr('href')) imageNumber = i;
    }
  }
  $window = $(window);
  top = $window.scrollTop() + $window.height() / 10;
  left = $window.scrollLeft();
  $lightbox = $('#lightbox');
  $lightbox.css({
    top: top + 'px',
    left: left + 'px'
  }).fadeIn(this.options.fadeDuration);
  this.changeImage(imageNumber);
};

Lightbox.prototype.changeImage = function(imageNumber) {
  var $image, $lightbox, preloader,
    _this = this;
  this.disableKeyboardNav();
  $lightbox = $('#lightbox');
  $image = $lightbox.find('.lb-image');
  this.sizeOverlay();
  $('#lightboxOverlay').fadeIn(this.options.fadeDuration);
  $('.loader').fadeIn('slow');
  $lightbox.find('.lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-    numbers, .lb-caption').hide();
  $lightbox.find('.lb-outerContainer').addClass('animating');
  preloader = new Image;
  preloader.onload = function() {
    $image.attr('src', _this.album[imageNumber].link);
    $image.width = preloader.width;
    $image.height = preloader.height;
    return _this.sizeContainer(preloader.width, preloader.height);
  };
  preloader.src = this.album[imageNumber].link;
  this.currentImageIndex = imageNumber;
};

Lightbox.prototype.sizeOverlay = function() {
  return $('#lightboxOverlay').width($(document).width()).height($(document).height());
};

Lightbox.prototype.sizeContainer = function(imageWidth, imageHeight) {
  var $container, $lightbox, $outerContainer, containerBottomPadding,     containerLeftPadding, containerRightPadding, containerTopPadding, newHeight, newWidth, oldHeight, oldWidth,
    _this = this;
  $lightbox = $('#lightbox');
  $outerContainer = $lightbox.find('.lb-outerContainer');
  oldWidth = $outerContainer.outerWidth();
  oldHeight = $outerContainer.outerHeight();
  $container = $lightbox.find('.lb-container');
  containerTopPadding = parseInt($container.css('padding-top'), 10);
  containerRightPadding = parseInt($container.css('padding-right'), 10);
  containerBottomPadding = parseInt($container.css('padding-bottom'), 10);
  containerLeftPadding = parseInt($container.css('padding-left'), 10);
  newWidth = imageWidth + containerLeftPadding + containerRightPadding;
  newHeight = imageHeight + containerTopPadding + containerBottomPadding;
  if (newWidth !== oldWidth && newHeight !== oldHeight) {
    $outerContainer.animate({
      width: newWidth,
      height: newHeight
    }, this.options.resizeDuration, 'swing');
  } else if (newWidth !== oldWidth) {
    $outerContainer.animate({
      width: newWidth
    }, this.options.resizeDuration, 'swing');
  } else if (newHeight !== oldHeight) {
    $outerContainer.animate({
      height: newHeight
    }, this.options.resizeDuration, 'swing');
  }
  setTimeout(function() {
    $lightbox.find('.lb-dataContainer').width(newWidth);
    $lightbox.find('.lb-prevLink').height(newHeight);
    $lightbox.find('.lb-nextLink').height(newHeight);
    _this.showImage();
  }, this.options.resizeDuration);
};

Lightbox.prototype.showImage = function() {
  var $lightbox;
  $lightbox = $('#lightbox');
  $lightbox.find('.lb-loader').hide();
  $lightbox.find('.lb-image').fadeIn('slow');
  this.updateNav();
  this.updateDetails();
  this.preloadNeighboringImages();
  this.enableKeyboardNav();
};

Lightbox.prototype.updateNav = function() {
  var $lightbox;
  $lightbox = $('#lightbox');
  $lightbox.find('.lb-nav').show();
  if (this.currentImageIndex > 0) $lightbox.find('.lb-prev').show();
  if (this.currentImageIndex < this.album.length - 1) {
    $lightbox.find('.lb-next').show();
  }
};

Lightbox.prototype.updateDetails = function() {
  var $lightbox,
    _this = this;
  $lightbox = $('#lightbox');
  if (typeof this.album[this.currentImageIndex].title !== 'undefined' &&     this.album[this.currentImageIndex].title !== "") {
    $lightbox.find('.lb-caption').html(this.album[this.currentImageIndex].title).fadeIn('fast');
  }
  if (this.album.length > 1) {
    $lightbox.find('.lb-number').html(this.options.labelImage + ' ' + (this.currentImageIndex + 1) + ' ' + this.options.labelOf + '  ' + this.album.length).fadeIn('fast');
  } else {
    $lightbox.find('.lb-number').hide();
  }
  $lightbox.find('.lb-outerContainer').removeClass('animating');
  $lightbox.find('.lb-dataContainer').fadeIn(this.resizeDuration, function() {
    return _this.sizeOverlay();
  });
};

Lightbox.prototype.preloadNeighboringImages = function() {
  var preloadNext, preloadPrev;
  if (this.album.length > this.currentImageIndex + 1) {
    preloadNext = new Image;
    preloadNext.src = this.album[this.currentImageIndex + 1].link;
  }
  if (this.currentImageIndex > 0) {
    preloadPrev = new Image;
    preloadPrev.src = this.album[this.currentImageIndex - 1].link;
  }
};

Lightbox.prototype.enableKeyboardNav = function() {
  $(document).on('keyup.keyboard', $.proxy(this.keyboardAction, this));
};

Lightbox.prototype.disableKeyboardNav = function() {
  $(document).off('.keyboard');
};

Lightbox.prototype.keyboardAction = function(event) {
  var KEYCODE_ESC, KEYCODE_LEFTARROW, KEYCODE_RIGHTARROW, key, keycode;
  KEYCODE_ESC = 27;
  KEYCODE_LEFTARROW = 37;
  KEYCODE_RIGHTARROW = 39;
  keycode = event.keyCode;
  key = String.fromCharCode(keycode).toLowerCase();
  if (keycode === KEYCODE_ESC || key.match(/x|o|c/)) {
    this.end();
  } else if (key === 'p' || keycode === KEYCODE_LEFTARROW) {
    if (this.currentImageIndex !== 0) {
      this.changeImage(this.currentImageIndex - 1);
    }
  } else if (key === 'n' || keycode === KEYCODE_RIGHTARROW) {
    if (this.currentImageIndex !== this.album.length - 1) {
      this.changeImage(this.currentImageIndex + 1);
    }
  }
};

Lightbox.prototype.end = function() {
  this.disableKeyboardNav();
  $(window).off("resize", this.sizeOverlay);
  $('#lightbox').fadeOut(this.options.fadeDuration);
  $('#lightboxOverlay').fadeOut(this.options.fadeDuration);
  return $('select, object, embed').css({
    visibility: "visible"
  });
};

return Lightbox;

  })();

  $(function() {
var lightbox, options;
options = new LightboxOptions;
return lightbox = new Lightbox(options);
  });

}).call(this); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T17:39:26.930

如果您使用 jquery，您可以按照说明创建链接元素，然后使用以下内容：

例如

HTML：

```
<a id ="ele_id" href="images/image-1.jpg" rel="lightbox" title="my caption">image #1</a> 
```

JS：

```
$('document').ready(function(){
    $('#ele_id').trigger('click');
}); 
```

**更新**

如果您愿意，您可以使用 cookie 来检查它是否是第一次访问该网站的用户，如果是这种情况，则只运行灯箱。

使用 jquery cookie 插件：[https ://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

```
$('document').ready(function(){
     if ($.cookie('has_visited') != TRUE){
        $('#ele_id').trigger('click');
        $.cookie('has_visited', TRUE, { expires: 1 }); //this will set the cookie to expire after one day but you could make it longer
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-20T09:18:56.257

```
<!DOCTYPE html>
<html>
<head>
<Style>
#fade{
display: none;
position: fixed;
top: 0%;
left: 0%;
width: 100%;
height: 100%;
background-color: #000;
z-index:1001;
-moz-opacity: 0.7;
opacity:.70;
filter: alpha(opacity=70);
}
#light{
display: none;
position: absolute;
top: 5%;
left: 45%;
width: 640px;
height: 453px;
margin-left: -250px;
margin-top: 100px;                 
background: #CCC;
z-index:1002;
overflow:visible;
}
</style>
<script>
window.document.onkeydown = function (e)
{
if (!e){
    e = event;
}
if (e.keyCode == 27){
    lightbox_close();
}
}
function lightbox_open(){
window.scrollTo(0,0);
document.getElementById('light').style.display='block';
document.getElementById('fade').style.display='block';  
}
function lightbox_close(){
document.getElementById('light').style.display='none';
document.getElementById('fade').style.display='none';
}
</script>
<head>
<body onload="lightbox_open()";>
<div class="light" onClick="lightbox_close();" id="light"><img src="your_img.jpg"></div>
<div id="fade" onClick="lightbox_close();"></div>
</body>
</html> 
```

# java - 未聚焦时更新 ListView 片段

> ID：13688272
> 
> 赞同：3
> 
> 时间：2012-12-03T17:09:43.810
> 
> 标签：java, android, android-fragments, android-listfragment

我正在开发一个平板电脑应用程序，左侧有一个 ListView 片段，右侧有一些其他视图，包括 SearchView（本质上是一个 TextView）。当 SearchView 聚焦时，我想更新 listview 的数据，但我不能。如果我在 UI 线程上**notifyDataSetChanged ，则不会发生任何事情。**如果我在列表视图上再次调用**setAdapter()**，列表视图将变为空白。

只有当我再次触摸列表视图（它再次获得临时焦点或导致在适配器上调用 getView() 的东西）时，它才会更新。

有人知道如何解决这个问题吗？

Min-Sdk 和 Target 是 4.0.3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T09:40:51.997

您是否尝试使用 调用*刷新*例程`runOnUiThread()`？

改革您的对象列表，绑定到适配器的*新实例*，然后在*刷新*`notifyDataSetChanged()`例程中调用并`setAdapter()`再次工作。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T10:35:35.890

现在对我有用的是更新底层适配器中的数据，然后在该适配器上调用**notifyDataSetChanged**，所有这些都来自 UI 线程。

我不需要在 listView 上再次调用**setAdapter**。

当然，在提出问题之前我已经尝试过所有这些，所以不确定是什么让它突然开始工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-12T07:11:09.437

我认为您必须使用**ViewHolder**来处理 ListView 中的更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-12T22:00:37.007

在 runOnUiThread 方法中调用它。还将新对象添加到其中的适配器。

像那样：

```
runOnUiThread(new Runnable() {
    @Override
    public void run() {
        chatListAdapter.add(message);
        chatListAdapter.notifyDataSetChanged();
    }
}); 
```*

# c# - ASP.NET 如何使用 C# 代码中的类将文本添加到 gridview 中的标签？

> ID：13688275
> 
> 赞同：0
> 
> 时间：2012-12-03T17:09:49.290
> 
> 标签：c#, asp.net, class, gridview, itemtemplate

我需要知道如何使用类来获取字符串并将其添加到 agridview 中的 itemtemplate 内的标签中...

我之前发布过这个问题： [Add text from c# code to a gridview label](https://stackoverflow.com/questions/13663668/add-text-from-c-sharp-code-to-a-gridview-label)

我得到了一个答案，我注意到我从一个cs文件中的一个类中获取了字符串......更具体地说，这是我的类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;

namespace ClientesPagos
{
    public class Funciones
    {
        public static string GetFormatoMoneda(decimal decCantidad)
        {
            DataRow dr = ConexionBD.GetInstanciaConexionBD().GetTipoDeMonedaPrincipal((int)HttpContext.Current.Session["Grupo"]);
            return dr["Signo"] + Math.Round(decCantidad, 2).ToString("C").Substring(1) + " " + dr["Abreviatura"];
        }
    }
} 
```

从其中一个建议中，我尝试使用它：

```
Text='<%#Funciones.GetFormatoMoneda(Eval("Total"))%>' 
```

不工作...

然后我尝试了一些我不想做的事情，但只是为了测试我尝试了它。我的 gridview 在一个名为 Ventas.aspx 的文件中......所以我在 Ventas.aspx.cs 上添加了相同的类，然后我将文本切换为：

```
Text='<%#GetFormatoMoneda(Eval("Total"))%>' 
```

另外，我尝试将 GetFormatoMoneda(decimal decCantidad) 切换到 GetFormatoMoneda(object objCantidad)，但完全没有成功...

你知道解决这个问题的方法吗？或者您是否可以对上面链接中的另一个问题提供不同的答案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:41:53.080

您可以在后面的代码中使用[gridview.rowdatabound 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)来操作网格行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:34:15.613

它应该是：

```
 Text='<%# Eval(Funciones.GetFormatoMoneda(1.0))%>' 
```

只需替换`1.0`我在函数调用中编写的`GetFormatoMoneda`。

# r - 如何在 ggplot2 中添加几何图例？

> ID：13688280
> 
> 赞同：1
> 
> 时间：2012-12-03T17:10:15.053
> 
> 标签：r, graphics, ggplot2

假设我有一组数据，我想为每个绘制它的几何图形添加一个图例。例如：

```
x <- rnorm(100, 1)
qplot(x = x, y = 1:100, geom = c("point", "smooth")) 
```

它看起来像这样：

![在此处输入图像描述](../Images/224c037416b6ba638457f73be2f97928.png)

现在，我想添加一个图例，这样它会说：

```
Legend title
*   points [in black]
--- smoothed [in blue] 
```

我在其中指定“图例标题”、“点”和“平滑”名称。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:55:31.607

添加额外信息的最简单方法是使用注释而不是图例。

（我知道这是一个玩具示例，但是当只有一种点和一种线时，ggplot 不包括图例是明智的。你可以制作一个图例，但默认情况下它会占用更多的空间和墨水必须做更多的工作。当只有一种点时，它的含义应该从 x 和 y 轴上的标签和图的一般上下文中清楚。缺乏其他信息，读者会推断该线是将某些函数拟合到点的结果。他们唯一不知道的是具体的函数和灰色错误区域的含义。可以是简单的标题、注释或绘图之外的文本。）

```
#Sample data in a dataframe since that works best with ggplot
set.seed(13013)
testdf <- data.frame(x <- rnorm(100, 1),y <- 1:100) 
```

一个选项是标题：

```
ggplot(testdf , aes(x = x, y = y)) + geom_point()+
   stat_smooth(method="loess")+
   xlab("buckshot hole distance(from sign edge)")+
   ylab("speed of car (mph)")+
   ggtitle("Individual Points fit with LOESS (± 1 SD)") 
```

![带有标题的示例 ggplot](../Images/d839089ff91edb9cfee08670dcc0760e.png)

另一种选择是注释层。在这里，我使用 mean 和 max 函数来猜测文本的合理位置，但是可以使用真实数据做得更好，并且可能使用诸如`size=3`使文本大小更小的参数。

```
ggplot(testdf , aes(x = x, y = y)) + geom_point()+
   stat_smooth(method="loess")+
   xlab("buckshot hole distance (from sign edge)")+
   ylab("speed of car (mph)")+
   annotate("text", x = max(testdf$x)-1, y = mean(testdf$y), 
   label = "LOESS fit with 68% CI region", colour="blue") 
```

![带有注释的示例 ggplot](../Images/9c9124be8c4a604936d36e923f914b80.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:56:47.227

注释 ggplot 图的一种快速方法是使用**geom_text**

```
x <- rnorm(100, 1)
y = 1:100
library(ggplot2)
dat <- data.frame(x=x,y=y)
bp <-  ggplot(data =dat,aes(x = x, y = y))+
       geom_point()+ geom_smooth(group=1)

bp  <- bp +geom_text(x = -1, y = 3, label = "*   points  ", parse=F)
bp  <- bp +geom_text(x = -1, y = -1, label = "--- smoothed   ", parse=F,color='blue')
bp 
```

![在此处输入图像描述](../Images/7f230473e75c422893919632fdfc44bf.png)

# iphone - 在 iOS 上使用 Avian 的 Scala

> ID：13688283
> 
> 赞同：60
> 
> 时间：2012-12-03T17:10:23.060
> 
> 标签：iphone, ios, scala, jvm, avian

有一个相对较新的轻量级 JVM，称为[Avian](http://oss.readytalk.com/avian/)，可以为 iOS 目标生成可执行文件。

网站上没有太多文档（用 Google 搜索也找不到太多文档）。我想知道是否有人知道有关如何使用[Avian](http://oss.readytalk.com/avian/)在 iOS 上运行基本 Scala 程序的分步教程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-30T02:04:16.730

iOS 编译器的另一个替代 JVM 是[RoboVM](http://www.robovm.org)。尽管它处于早期阶段，但看起来很有希望，并提供了有关如何为 iOS 编译 Scala 的示例。

**编辑**这是一个旧答案，当时有效，但是，正如@JamesMoore 指出的那样，RoboVM 已不复存在。现在看起来很有希望，并且很可能在不久的将来在 iOS 中运行 Scala 代码的方式是[Scala Native](http://www.scala-native.org)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T22:15:33.000

编译的 Scala 源代码是完全标准的类文件。您应该能够按照网站上的[说明](http://oss.readytalk.com/avian/building.html)（查找“嵌入”）而无需进行大的更改，只需将`scala-library.jar`其视为您的代码的依赖项。

几天前，我设法引导了完整的编译器和在 Avian 上运行的标准库。

某些部分的边缘可能仍然有些粗糙，例如，有[一个强制修复](https://issues.scala-lang.org/browse/SI-6969)将成为 Scala 下一版本 (2.10.1) 的一部分，但不在 2.10.0 中。如果您想立即使用它，则需要使用每晚构建，直到 2.10.1 发布。

如果您遇到任何其他问题，请报告！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-11T22:54:22.727

我可能不再需要它了，现在[Oracle 正在 iOS 和 Android 上开源 JavaFX](http://fxexperience.com/2013/02/february-open-source-update/)！

编辑：Oracle 更新了这篇文章，宣布他们不会发布 JVM，所以看起来 JavaFX+Avian 可能是要走的路。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T16:34:01.483

在 iOS（非 root）上运行 Java 字节码不仅仅是运行那个或那些 JVM。据我了解，iOS 内存管理不允许可执行内存页面在用户模式下可写。这基本上禁止任何 JIT 编译。因此，即使可以在特定的 Java VM 上运行一些已编译的（来自 Java 或 Scala）类，我也会仔细检查该 VM 如何支持 Ahead-Of-Time 编译，以便在 iOS 上运行。正如我所见，Avian AOT 在桌面上运行良好。对于 iOS，您必须自己检查它，尽管该项目在 AOT 领域看起来很有希望。

# c# - 字符串中有多个引号的问题

> ID：13688284
> 
> 赞同：0
> 
> 时间：2012-12-03T17:10:25.510
> 
> 标签：c#, string

我在 c# 代码中有以下字符串。

```
 string home = "<img src='/images/Home.png' 
                     onclick='javascript:document.location.href=/Home/Index' />"; 
```

当我将此字符串发送到客户端时，图像上的单击事件不起作用，在控制台中出现以下错误：

```
Uncaught SyntaxError: Invalid flags supplied to RegExp constructor 'Index' 
page_home (1):1 onclick 
```

我感觉字符串中的引号有问题，但我没有明白。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:25:42.770

问题是您没有将位置封装在 javascript 中的引号中，因此它将其作为正则表达式处理。

这应该可以解决您的问题。

```
string home = "<img src=\"/images/Home.png\" onclick=\"javascript:document.location.href='/Home/Index'\" />"; 
```

你也可以这样做：

```
string home = @"<img src=""/images/Home.png"" onclick=""javascript:document.location.href='/Home/Index'"" />"; 
```

# calendar - 运行 Tapku 演示项目时出错

> ID：13688289
> 
> 赞同：1
> 
> 时间：2012-12-03T17:10:35.697
> 
> 标签：calendar, simulator, demo, tapku

我正在尝试运行从以下网址下载的 TapKu iOS 演示项目： [https ://github.com/devinross/tapkulibrary/branches](https://github.com/devinross/tapkulibrary/branches)

我构建没有错误，但是当它安装在模拟器上时，我收到以下错误消息：

```
[AppDelegate_iPhone window]: unrecognized selector sent to instance 0x9b7ad90
2012-12-03 17:05:13.478 unviersaldemo[94132:13d03] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[AppDelegate_iPhone window]: unrecognized selector sent to instance 0x9b7ad90'
*** First throw call stack:
(0x1a44012 0x1429e7e 0x1acf4bd 0x143d7ea 0x1a33cf9 0x1a3394e 0x3da78 0x2bcc 0x4807b7 0x480da7 0x481fab 0x493315 0x49424b 0x485cf8 0x237fdf9 0x237fad0 0x19b9bf5 0x19b9962 0x19eabb6 0x19e9f44 0x19e9e1b 0x4817da 0x48365c 0x2b36 0x2925 0x1)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T01:23:03.307

我刚刚补充说：

```
@interface AppDelegate_iPhone : TKAppDelegate <UIApplicationDelegate> {   
    UIWindow *window;
}

@property (nonatomic, retain) UIWindow *window; 
```

在 AppDelegate_iPhone.h 文件中

和

```
@synthesize window; 
```

在 AppDelegate_iPhone.m 文件中。为我工作。

# c# - 正在卸载具有单独 DLL 中的逻辑的 .NET Web 项目

> ID：13688292
> 
> 赞同：4
> 
> 时间：2012-12-03T17:10:44.973
> 
> 标签：c#, asp.net, static

我有一个 .NET Web 应用程序，它为许多非 UI 代码使用单独的类库。在这个库中有一个静态类，用于站点范围的配置信息。它在`Application_Start`事件期间被初始化。

我遇到了一个问题，因为这个关键的静态对象似乎间歇性地失去了它的状态——我认为是因为 DLL 出于某种原因正在被卸载。它可能几天都不会发生，也可能一天发生几次。但是，这种情况*在*应用程序没有重新启动的情况下发生，因此结果是所有初始化的数据`Application_Start`都丢失了，导致各种问题。回收应用程序池或以其他方式重新启动应用程序可以修复它。

在我弄清楚发生了什么之后，我更改了代码，以便类库中的配置对象使用静态构造函数初始化自身，而不是在应用程序启动阶段。这引入了一些其他不值得讨论的复杂性，但我可以让它工作——我只是认为这是一个糟糕的架构，不应该是必要的。

`Application_Start`在应用程序的生命周期内保持其状态期间，我是否应该能够依赖加载的外部 DLL 中的静态对象？显然我不能 - 而且我不太清楚为什么 - 但我想知道我是否应该寻找 DLL 正在卸载的原因，或者只是接受它可以并且从不编写依赖于外部静态对象的代码主应用程序 DLL 保持其值。

这是 Application_Start 的样子。

```
Application_Start() {

    // asp.net routing
    ConfigureRoutes();

    // LF is the static config object in an outside dll
    // the LFFactory object implements session & database stuff that's context-specific
    // (e.g. this is initialized with a different implementation when testing).

    LF.Initialize(new SiteEnvironment.Web.LFFactory());

    // add custom view engine...
    ViewEngines.Engines.Clear();
    ... blah blah 

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:46:03.250

不确定它是否解决了您的问题，但在 Web 应用程序中使用静态类特别困难。具有静态方法的类（静态或基于实例）很好，但静态属性和字段会造成严重破坏。您的数据将在 IIS 内的线程之间共享，并且数据将以看似随机的顺序被覆盖。

如果您尝试共享静态数据，请将这些数据放在您的 web.config 中或将其缓存在服务器上。如果数据是读/写的，则将其放入基于实例的对象中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:14:30.813

如果您主要将其用于配置数据，我建议您将该配置数据放入站点的 Web.config 文件中。您可以（应该？）然后将其包装在与您现在所拥有的类似的类中。然后该类可以包含一些访问器，它们读取配置文件并将结果存储到静态内存中。如果由于某种原因，数据丢失了，那么访问者应该不会有任何问题，只需从配置文件中重新加载即可。

我希望这就是你要找的。我不完全确定您正在加载什么类型的*配置数据*以及它是否可以表示/存储在 XML 配置文件中。

我会想象这个类看起来像下面这样：

```
public static class MyConfig
{
  static MyConfig() { LoadConfigData(); }

  public static string ConnectionString
  {
    get
    {
      if (_connectionString == null) { LoadConfigData(); } //assignment of static data done here
        return _connectionString;
    }
  }
  private static string _connectionString = null;

  // repeat for other config-settings...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:45:17.147

在回答我上面的问题之前，或者知道你的静态成员是什么样子之前，我会在黑暗中拍摄并说当引用计数达到 0 时，静态对象同样容易消失，就像任何其他对象一样。

一个潜在的解决方案是维护对该对象的“保证”应用程序持久引用，即使您不通过该引用访问该对象：

```
// for each static property we need to keep in memory
Application.Add("MyClass.property", MyClass.property); 
```

检索对象的两种方式之一：

```
// our object should always be accessible like this
Object a = Application["MyClass.property"];

// and because we've created an application-persistent reference to the property,
// it should also be accessible like this
Object b = MyClass.property; 
```

只是一个假设的，在黑暗中拍摄的建议！

**附录：** 如果不能期望 Application_Start 知道它需要跟踪的每个静态对象，我建议使用反射迭代你的类的属性，随时添加每个静态属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T19:11:42.443

你的方法是正确的。问题可能是应用程序池正在回收。这将丢失共享内存。您可以调整应用程序池何时以及是否回收。

# c++ - 将字符串转换为 int (C++)

> ID：13688298
> 
> 赞同：1
> 
> 时间：2012-12-03T17:11:11.160
> 
> 标签：c++, string, int, atoi

我到处找，找不到这个特定问题的答案:(

我有一个字符串日期，其中包含删除所有特殊字符的日期。（即：yyyymmddhhmm 或 201212031204）。

我正在尝试将此字符串转换为 int 以便稍后对其进行排序。我尝试了atoi，没有工作，因为该功能的价值太高了。我尝试了流，但它总是返回 -858993460，我怀疑这是因为字符串太大了。我尝试了 atol 和 atoll ，但他们仍然没有给出正确的答案。

我宁愿不使用 boost，因为这是作业，我不认为我会被允许。

我没有将大字符串转换为 int 的选项吗？谢谢！

我想做的事：

```
int dateToInt(string date)
{
date = date.substr(6,4) + date.substr(3,2) + date.substr(0,2) + date.substr(11,2) + date.substr(14,2);
int d;
d = atoi(date.c_str());
return d;

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T17:13:47.090

你得到负数 `201212031204`是因为太大而无法适应`int`。考虑使用`long long`s

顺便说一句，您也可以对字符串进行排序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:22:41.533

你在正确的轨道上，价值太大，但不仅仅是那些功能。它对于一般来说太大了`int`。`int`s 最多只能保存 32 位，或最大值 2147483647（如果无符号则为 4294967295）。A`long long`保证对于您使用的数字足够大。如果您碰巧在 64 位系统上，a`long`也将如此。

现在，如果您使用这些较大的整数之一，则流应该可以正确转换。或者，如果您想使用函数来执行此操作，请查看`atoll`for a`long long`或`atol`for a `long`。（虽然为了更好的错误检查，你真的应该考虑`strtoll`or `strtol`。）

完全或者，您也可以使用`time_t`. 它们是底层的整数类型，因此您可以对它们进行比较和排序。并且有一些不错的功能`<ctime>`（请查看[http://www.cplusplus.com/reference/ctime/](http://www.cplusplus.com/reference/ctime/)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:17:26.233

```
typedef long long S64;

S64 dateToInt(char * s) {
    S64 retval = 0;
    while (*s) {
         retval = retval * 10 + (*s - '0');
         ++s;
    }
    return retval;
} 
```

请注意，如前所述，您使用的数字不适合 32 位。

# actionscript - AS3 - 尝试调整 BitmapData 但 Matrix 没有改变任何东西

> ID：13688302
> 
> 赞同：0
> 
> 时间：2012-12-03T17:11:27.693
> 
> 标签：actionscript, matrix, resize, bitmapdata

情况如下：在我的舞台上，我有一个引用 BitmapData 对象的 Bitmap 对象。我的位图对象是全屏的，所以是 1366x768。

另一方面，我有一个函数（来自一个库，所以我不能编辑它），它返回一个带有新图片的 BitmapData。那张图片是 640x480，并且该函数每秒调用一次。

这就是问题所在：我找不到将返回的图片缩放到全屏的方法。我尝试使用 Matrix 和 .draw 方法，但什么也没做。

这是一些代码：

```
var mat:Matrix = new Matrix();
mat.scale(0.52, 0.52); // I tried with other values such as 2 but the picture stays the same
// scr_bmp is the BitmapData attached to the displayed Bitmap
// capt.bmp is the BitmapData returned by the function
// I tried without the new Rectangle but that doesn't change anything
scr_bmp.draw(capt.bmp, mat, null, null,new Rectangle(0, 0, 640, 480), true); 
```

使用此代码，新图片可以正确显示，但其原始尺寸为：640x480，屏幕的其余部分为空白。

在此先感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:00:56.043

嗯……

```
mat.scale(scr_bmp.width/capt.bmp.width,scr_bmp.height/capt.bmp.height);
var smallBitmap:Bitmap=new Bitmap(capt.bmp);
scr_bmp.fillRect(scr_bmp.rect,0x00808080);
scr_bmp.draw(smallBitmap,mat); 
```

只是尝试了不同的尺寸，但它对我有用。但我使用的是 AS3，而不是 AS2。

# php - 如何更新完整日历

> ID：13688303
> 
> 赞同：-2
> 
> 时间：2012-12-03T17:11:28.693
> 
> 标签：php, jquery, fullcalendar

我是 php 和 fullcalendar 的初学者。我需要使用用户输入值 ($('#name')) 更新日历。但它不起作用。

我有这个代码。

```
$(document).ready(function() {
    var UsrAux;
     $('#name').blur(function(){                    
        UsrAux = $('#name').val()      // <-- This is the input
      });                 

    $('#calendar').fullCalendar({
        draggable: true, 
        height: 400,    
        cache: true, 
        eventSources: [
    // your event source
        {
            url: 'CalendarServer.php',
            type: 'POST',
            data: {                     
                    uno: 'Something',   
                    UsrCdg: UsrAux                                          
            },
            error: function() {
                alert('error!');
            },
            color: '#e2ebef',   // a non-ajax option
            textColor: 'black' // a non-ajax option
        }
        ]       
      });

}); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:06:12.947

嗨，这是解决方案。

```
$(document).ready(function(){

        var UsrAux;     
        UsrAux=$('#name').val();                  
         $('#name').blur(function(){    
            UsrAux=$('#name').val();                        
            var source =   {
                    url: 'CalendarServer.php',
                    type: 'POST',
                    data: {                         // Parms
                            uno: 'Somenthing',  
                            UsrCdg: UsrAux                                          
                    },
                    error: function() {
                        alert('error!');
                    },
                    color: '#e2ebef',   // a non-ajax option
                    textColor: 'black' // a non-ajax option
            };                               
            $('#calendar').fullCalendar('removeEvents');
            $('#calendar').fullCalendar('addEventSource', source);
            });  

        $('#calendar').fullCalendar({
            draggable: true, 
            height: 400,    
            cache: true, 
            eventSources: [
        // your event source
            {
                url: 'CalendarServer.php',
                type: 'POST',
                data: {                         // Parms
                        uno: 'something',   
                        UsrCdg: $('#name').val()                                            
                },
                error: function() {
                    alert('error!');
                },
                color: '#e2ebef',   // a non-ajax option
                textColor: 'black' // a non-ajax option
            }
            ]       
          });

          }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:43:51.237

`blur`事件函数应在获取所需数据（用户输入）之前定义`fullCalendar`。

# normalization - 如何用推力标准化矢量？

> ID：13688307
> 
> 赞同：2
> 
> 时间：2012-12-03T17:11:38.073
> 
> 标签：normalization, thrust

我现在正在学习推力。我有一个问题：如何用推力正常化？我有一个有效的代码，但我想知道这是否是最佳方法。

```
struct square
{
__host__ __device__
float operator() (float x)
{
    return x * x;
}
};

thrust::device_vector<float> d_x(2);
thrust::device_vector<float> d_y(2);
thrust::device_vector<float> d_z(2);
d_x[0] = 3;
d_x[1] = 4;
square<float>        unary_op;
thrust::plus<float> binary_op;
 float init = 0;

// compute norm
float norm = std::sqrt( thrust::transform_reduce(d_x.begin(), d_x.end(), unary_op, init, binary_op) );
thrust::fill(d_y.begin(), d_y.end(), 1/norm);
thrust::transform(d_x.begin(), d_x.end(), d_y.begin(), d_z.begin(), thrust::multiplies<float>()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:44:56.077

这应该更有效，因为它不需要为 or 使用存储或`d_y`带宽`d_z`：

```
#include <thrust/device_vector.h>
#include <thrust/inner_product.h>
#include <thrust/transform.h>
#include <thrust/functional.h>
#include <cmath>

int main()
{
  thrust::device_vector<float> d_x(2);
  d_x[0] = 3;
  d_x[1] = 4;

  float norm = std::sqrt(thrust::inner_product(d_x.begin(), d_x.end()));

  using namespace thrust::placeholders;
  thrust::transform(d_x.begin(), d_x.end(), d_x.begin(), _1 /= norm);

  return 0;
} 
```

当然，您需要将问题规模扩大几个数量级。

# php - mysql 到 mysqli 的转换

> ID：13688310
> 
> 赞同：1
> 
> 时间：2012-12-03T17:11:42.420
> 
> 标签：php, mysql, mysqli

嗨嗨我正在将我的 MySQL 代码转换为 MySQLi，因为它更安全，但 AFAIK MySQLi 本身并不更安全。

我在所选答案中使用了转换器这个主题： [从 MYSQL 更新到 MYSQLI](https://stackoverflow.com/questions/12020227/updating-from-mysql-to-mysqli)

并且代码正在运行，但现在我不知道该怎么做，我知道我必须准备查询，但我不知道在哪里以及如何准备...

例如，如果我有一个带有 5 个或更多 php 变量的 INSERT 查询，可以吗？我该怎么办？我找到的所有示例都带有一个变量......我是否在查询前立即准备好？

我是不是太混乱了？如果这是非常基本的东西，我很抱歉，但我对此完全不熟悉，我想要的只是一些指导方针......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:13:35.060

下面是一个带有多个参数的 INSERT 查询示例。

```
/* create a prepared statement */
if ($stmt = $mysqli->prepare("INSERT INTO mytable (field1, field2, field3) VALUES(?, ?, ?)")) {

    /* bind parameters for markers */
    $stmt->bind_param("sss", $field1, $field2, $field3);

    /* execute query */
    $stmt->execute();

    /* close statement */
    $stmt->close();
} 
```

如您所见`$field1`，`$field2`, 和`$field3`将被绑定为字符串（注意三个`s`）并将替换`?`查询中的 。

[绑定参数类型](http://php.net/manual/en/mysqli-stmt.bind-param.php)：

> i - 对应变量的类型为整数
> d - 对应的变量的类型为 double
> s - 对应的变量的类型为字符串
> b - 对应的变量是一个 blob，将在数据包中发送

# knockout.js - 具有两个列表和一个过滤数组的淘汰赛可排序

> ID：13688312
> 
> 赞同：0
> 
> 时间：2012-12-03T17:11:55.150
> 
> 标签：knockout.js, jquery-ui-sortable

我正在尝试使用敲除可排序插件来处理两个 html 列表，该列表基于过滤成两个数组的一个敲除数组。我不断收到错误，我相信这可能与我返回“computed”而不是“observableArray”对象的事实有关，但我无法找到解决方案。

[http://jsfiddle.net/thebassix/Eg2DG/4/](http://jsfiddle.net/thebassix/Eg2DG/4/)

我相信我的主要问题是：

```
hiddenSeries = ko.computed(function() {
    {
        var seriesArray = self.series();
        return ko.utils.arrayFilter(seriesArray, function(item) {
            return item.Hidden();
        });
    }
});

unhiddenSeries = ko.computed(function() {
    {
        var seriesArray = self.series();
        return ko.utils.arrayFilter(seriesArray, function(item) {
            return !(item.Hidden());
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:53:42.743

sortable 插件需要一个 observableArray 来操作，以便它可以将项目放回正确的位置。

您最好的选择可能是将数据拆分为两个 observableArrays，然后创建一个计算来表示组合集（如果您需要将其发送回服务器）。

也许是这样的：

```
var data = ko.mapping.fromJSON('[{"__type":"mediacenter+Series","ID":1,"Name":"seriesname232","Hidden":true,"MediaCenterID":1,"_destroy":false},{"__type":"mediacenter+Series","ID":2,"Name":"kjhkuhkuh","Hidden":false,"MediaCenterID":1,"_destroy":false},{"__type":"mediacenter+Series","ID":3,"Name":"trrde","Hidden":false,"MediaCenterID":1,"_destroy":false},{"__type":"mediacenter+Series","ID":4,"Name":"1","Hidden":true,"MediaCenterID":1,"_destroy":false}]', mappingOptions);

//take one pass through the records and put them in the appropriate bucket
var hidden = [], 
    unhidden = [];

ko.utils.arrayForEach(data(), function(item) {
    if (item.Hidden()) {
       hidden.push(item);   
    }
    else {
       unhidden.push(item);   
    }
});

self.hiddenSeries = ko.observableArray(hidden);
self.unhiddenSeries = ko.observableArray(unhidden);

//define series as the two lists together
self.series = ko.computed(function() {
   return self.hiddenSeries().concat(self.unhiddenSeries()); 
}); 
```

示例：http: [//jsfiddle.net/rniemeyer/NhUEm/](http://jsfiddle.net/rniemeyer/NhUEm/)

# kendo-ui - 使用“kendo.data.Model.define”的剑道用户界面

> ID：13688314
> 
> 赞同：2
> 
> 时间：2012-12-03T17:11:55.917
> 
> 标签：kendo-ui

我正在尝试定义一个类似这样的数据模型：

```
var MyDataModel = kendo.data.Model.define({
    id: "id",
    fields: {
        name: {
            type: "string"
        },
        myListOfThings: {
            defaultValue: []
        },
        numberOfThings: {
            type: "number",
        }
    }
}); 
```

我想要的还有更多。我想知道是否有办法在模型类型中定义“派生属性”。更具体地说，我希望 numberOfThings 始终计算为数组 myListOfThings 的长度。那就是我希望能够创建对象，例如：

```
var o = new MyDataModel({ name: "a name", myListOfThings: ['a','b','c']}); 
```

然后有一个剑道小部件，其列绑定到 numberOfThings 显示 3。你知道如何完成这个吗？

**编辑：** 谢谢阿塔纳斯，你的答案有效。

我能够将 jsbin 代码编辑为适合我的声明性绑定表单。

我还没有想到，因为在我的解决方案代码中，我在 kendo.all.js 的第 269 行收到了一个 javscript 错误，内容为

```
return new Function(argumentName, functionBody); 
```

错误信息是

> “ReferenceError：未定义计数”

我试图找出我的代码与 jsbin 代码的不同之处。..但是如果您知道可能是什么问题，我会全力以赴。如果没有，不用担心，谢谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:29:36.990

使用将返回项目数的函数。这是一个例子：http: [//jsbin.com/ategub/1/edit](http://jsbin.com/ategub/1/edit)

# java - 将 String 转换为 int 数组 bluej

> ID：13688315
> 
> 赞同：0
> 
> 时间：2012-12-03T17:11:56.647
> 
> 标签：java, multidimensional-array, bluej

如何将 String 输入转换为 [][] 的 int 数组

例如，如果我有一个 3a 的输入，那么它应该返回到 [2][0] 的索引，如果它有 5e，那么它应该回到 [4][4] 的索引

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:20:16.937

像这样：

```
public static void main(String[] args) {
    int[][] array;

    array = createArray("3a");
    System.out.println(array.length + "," + array[0].length);

    array = createArray("5e");
    System.out.println(array.length + "," + array[0].length);

    array = createArray("9g");
    System.out.println(array.length + "," + array[0].length);
}

private static int[][] createArray(String input) {
    int a = Integer.parseInt(input.substring(0, 1)) - 1;
    int b = input.charAt(1) - 97;
    return new int[a][b];
} 
```

这输出：

```
2,0
4,4
8,6

```

还要确保在将输入传递到`createArray`. 一个简单的正则表达式模式可以解决这个问题：`[0-9][a-z]`.

# facebook-oauth - “设备登录”和/或offline_access 的替代方案+ 一次登录的时间表

> ID：13688319
> 
> 赞同：58
> 
> 时间：2012-12-03T17:12:12.983
> 
> 标签：facebook-oauth, command-line-interface, offlineapps, app-offline.htm, facebook-app-center

我有一个用于 facebook 的小型恐龙时代命令行界面 (CLI) 应用程序。没有庞大的用户群，但它有它的利基市场。它最无私的用法是那些部分失明并依赖其他基于文本的命令行界面的人。

它确实是一个“桌面应用程序”，没有浏览器界面，也无法在应用程序中嵌入浏览器。它是使用 PHP CLI 用 PHP 编写的，它托管在[github 上。](https://github.com/dtompkins/fbcmd)[获取更新信息的 beta 分支]。

我显然有点担心删除`offline_access`.

我将希望寄托在待处理的“设备登录”上，并且真的希望在他们翻转开关以删除之前它已经准备好，`offline_access`但情况似乎并非如此。我在 facebook 上找不到任何信息表明何时可以使用“设备登录”。我暗暗希望 FB 开发团队中的某个人能看到这一点，并将我作为早期采用者。

目前我将用户发送到非常旧的“一次性登录”页面：`www.facebook.com/code_gen.php?v=1.0&api_key=XXX`它为用户提供了一个临时授权码，我可以用它来获取旧的会话密钥——然后我可以使用 graph.facebook.com/oauth/exchange_sessions获取新的 OAuth 会话。

因此，我希望 Facebook 的某个人能够阐明“设备登录”何时会出现，或者我是否应该使用更好的方法。

现在，我最好的解决方案是托管一些页面，向用户显示他们的 oauth 会话信息是什么，然后让用户将其作为命令行参数剪切并粘贴到我的应用程序中。我想避免这种方法——尤其是因为现在看起来他们必须定期（每 60 天）这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-26T04:42:13.053

As someone also commented, Facebook has offered alternatives. [https://developers.facebook.com/docs/roadmap/completed-changes/offline-access-removal](https://developers.facebook.com/docs/roadmap/completed-changes/offline-access-removal)

# xml - 线性布局中的 MvxBindableGridView 不绑定到任何项目

> ID：13688325
> 
> 赞同：1
> 
> 时间：2012-12-03T17:12:43.667
> 
> 标签：xml, xamarin.android, mvvmcross

我在相对布局中使用了 MvxBindableGridView，它运行良好。然后我意识到我需要为我的屏幕使用 LinearLayouts 才能在不同的设备上正确缩放。当我更改为 LinearLayout 并运行应用程序时，GridView 为空，调试输出显示一些绑定错误

```
12-03 16:55:38.363 I/MvxBind ( 2689):  14.25 Failed to create target binding for from ClickCommand to ClickItemSquare
MvxBind:Warning: 14.25 Failed to create target binding for from ClickCommand to ClickItemSquare
12-03 16:55:38.363 I/mono-stdout( 2689): MvxBind:Warning: 14.25 Failed to create target binding for from ClickCommand to ClickItemSquare 
```

有谁知道当它在RelativeLayout中完美运行时为什么会失败？

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:local="http://schemas.android.com/apk/res/xxxxx"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<RelativeLayout
    android:id="@+id/layoutresults"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">
    <TextView
        android:id="@+id/textscore"
        local:MvxBind="{'Text':{'Path':'Score'}}"
        android:layout_width="50dp"
        android:layout_height="wrap_content"
        android:text="0000"
        android:textColor="#ff60350f"
        android:textSize="20dp"
        android:layout_x="25dp"
        android:layout_y="45dp"
        android:textStyle="bold"
        android:gravity="center"
        android:layout_marginTop="53dp"
        android:layout_marginLeft="25dp" />
    <TextView
        android:id="@+id/layoutstartnewgame"
        android:layout_width="100dp"
        android:layout_height="65dp"
        android:layout_x="109dp"
        android:layout_y="23dp"
        android:textStyle="bold"
        local:MvxBind="{'Click':{'Path':'StartNewGame'}}"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="27dp" />
    <TextView
        android:id="@+id/texttime"
        local:MvxBind="{'Text':{'Path':'Time'}}"
        android:text="00:00"
        android:textColor="#ff60350f"
        android:textSize="20dp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_x="245dp"
        android:layout_y="45dp"
        android:textStyle="bold"
        android:layout_marginTop="53dp"
        android:layout_alignParentRight="true"
        android:layout_marginRight="23dp" />
</RelativeLayout>
<cirrious.mvvmcross.binding.android.views.MvxBindableGridView
    android:layout_below="@+id/layoutresults"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:numColumns="4"
    android:gravity="center"
    android:listSelector="#00000000"
    local:MvxItemTemplate="@layout/itemimage"
    local:MvxBind="{'ItemsSource':{'Path':'Squares'}, 'ClickItemSquare':{'Path':'ClickCommand'}}"
    android:layout_marginTop="8dp" />
</RelativeLayout> 
```

改为线性

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:local="http://schemas.android.com/apk/res/xxxxx"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/TabletGameScreen">
<LinearLayout
    android:layout_width="fill_parent"
    android:orientation="vertical"
    android:layout_weight=".1"
    android:gravity="center" />
<LinearLayout
    android:id="@+id/layoutresults"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight=".1">
    <TextView
        android:id="@+id/textscore"
        local:MvxBind="{&apos;Text&apos;:{&apos;Path&apos;:&apos;Score&apos;}}"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="0000"
        android:textColor="#ff60350f"
        android:textSize="20dp"
        android:textStyle="bold"
        android:gravity="center_horizontal"
        android:layout_gravity="center_vertical" />
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:textStyle="bold"
        local:MvxBind="{&apos;Click&apos;:{&apos;Path&apos;:&apos;StartNewGame&apos;}}"
        android:layout_centerHorizontal="true"
        android:layout_gravity="center_vertical" />
    <TextView
        android:id="@+id/texttime"
        local:MvxBind="{&apos;Text&apos;:{&apos;Path&apos;:&apos;Time&apos;}}"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="00:00"
        android:textColor="#ff60350f"
        android:textSize="20dp"
        android:textStyle="bold"
        android:layout_gravity="center_vertical"
        android:gravity="center_horizontal" />
</LinearLayout>
<cirrious.mvvmcross.binding.android.views.MvxBindableGridView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight=".8"
    android:numColumns="4"
    android:gravity="center"
    android:listSelector="#00000000"
    local:MvxItemTemplate="@layout/itemimage"
    local:MvxBind="{&apos;ItemsSource&apos;:{&apos;Path&apos;:&apos;Squares&apos;}, &apos;ClickItemSquare&apos;:{&apos;Path&apos;:&apos;ClickCommand&apos;}}" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T08:20:25.163

ClickItemSquare 警告告诉您某些绑定正在发生，但 ClickCommand 不起作用。

根据您的问题中的少量信息...

*   看看 ClickCommand 是如何实现的——我猜它是基于[当我点击项目 GridView 时的 Return ImageView 实例](https://stackoverflow.com/questions/13146942/return-imageview-instance-when-i-click-on-the-item-gridview)——但这是你的代码，所以没有其他人可以帮助你（除非你发布它）
*   尝试将绑定跟踪级别设置为 Verbose/Diagnostic 以获取更多信息（查看 MvxBindingTrace 了解如何执行此操作 - 需要设置一个静态变量值）
*   检查您的 LinearLayout 是否有 android:orientation='vertical'
*   尝试单步执行代码 - 是否调用了 ViewModel 列表项上的属性值？如果是，那么您知道绑定正在工作
*   尝试恢复到网格代码 - 您是否看到相同的 ClickItemSquare 警告
*   尝试发布有关更改的更多详细信息的问题（例如代码之前和之后的一些问题）

# video - 列出网络摄像机的 RTSP 流

> ID：13688328
> 
> 赞同：2
> 
> 时间：2012-12-03T17:12:50.003
> 
> 标签：video, rtsp, ip-camera

我刚刚购买了 Micronet SP5319 高清 IP 摄像机，文档中没有关于流路径的信息。我只找到了类似 rtsp://ip/mpeg4 但最后它不起作用。我尝试了许多不同的路径，使用了许多不同的客户端，例如 VLC 和 QuickTime。没有成功。

我对流进行了有线共享，它看起来像：

```
OPTIONS rtsp://192.168.1.90:554/h264 RTSP/1.0
CSeq: 2
User-Agent: LibVLC/2.0.4 (LIVE555 Streaming Media v2012.09.13)

RTSP/1.0 200 OK
CSeq: 2
Date: Tue, Dec 04 2012 01:12:36 GMT
Public: OPTIONS, DESCRIBE, SETUP, TEARDOWN, PLAY, PAUSE, GET_PARAMETER, SET_PARAMETER

DESCRIBE rtsp://192.168.1.90:554/h264 RTSP/1.0
CSeq: 3
User-Agent: LibVLC/2.0.4 (LIVE555 Streaming Media v2012.09.13)
Accept: application/sdp

RTSP/1.0 404 Stream Not Found
CSeq: 3
Date: Tue, Dec 04 2012 01:12:36 GMT 
```

查看最后一个响应：找不到流。最后，如何获得可用流的列表？我应该使用哪个软件？我也尝试过使用 ONVIF，但没有成功。

最好的祝福，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-05-07T19:47:50.917

有同样的问题，在阅读了大量的博客之后，我发现了一些有趣的资源：

1)[这里](https://security.world/rtsp/)有大量特定品牌的 rstp 已知 URL 列表。不幸的是，我的不在那儿（品牌是 kolke，如果您想知道的话……）

2)[此表](https://www.ispyconnect.com/man.aspx?n=china)显示其他相机型号的不同 URL。我尝试了其中的几个，但没有成功。用 VLC 来做这件事很费时间，因为我必须一个一个地写，所以我写了一个小的 python 脚本来用 opencv 测试每个脚本并在 jupyter notebook 上运行它：

```
import cv2

# need to know those before hand. I got IP with Nmap
usr = 'myuser'
pwd = 'mypassword'
ip = '192.168.1.1'

# I took the url patterns and also included some variations, just to be sure...
urls = [f'rtsp://{usr}:{pwd}@{ip}:554/cam/realmonitor?channel=1&subtype=0',
        f'rtsp://{ip}:554/live=2.2&username={usr}&password={pwd}',
        f'rtsp://{usr}:{pwd}@{ip}:554/1',
        f'rtsp://{usr}:{pwd}@{ip}:554/stream1',
        f'rtsp://{usr}:{pwd}@{ip}:554/Stream1',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp?',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp',
        f'rtsp://{ip}:554/videostream.asf?user={usr}&pwd={pwd}',
        f'rtsp://{ip}:554/ucast/11',
        f'rtsp://{ip}:554/11',
        f'rtsp://{ip}:554/12',
        f'rtsp://{ip}:554/live0.264',
        f'rtsp://{ip}:554/mpeg4cif',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp?',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp',
        f'rtsp://{ip}:554/live1.264',
        f'rtsp://{ip}:554/cam1/h264',
        f'rtsp://{ip}:554/mpeg4cif',
        f'rtsp://{ip}:554/ucast/11',
        f'rtsp://{ip}:554/ROH/channel/11',
        f'rtsp://{ip}:554/user={usr}_password={pwd}_channel=1_stream=0.sdp',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp?',
        f'rtsp://{ip}:554/user={usr}_password={pwd}_channel=1_stream=0.sdp',
        f'rtsp://{ip}:554/user={usr}_password={pwd}_channel=1_stream=0.sdp?',
        f'rtsp://{ip}:554/cam1/mpeg4?user={usr}&pwd={pwd}',
        f'rtsp://{ip}:554/h264_stream',
        f'rtsp://{ip}:554/live/ch0',
        f'rtsp://{ip}:554/live/ch1',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp?',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=1.sdp?',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=0&stream=1.sdp?',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=0&stream=0.sdp?',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=0.sdp',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=1&stream=1.sdp',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=0&stream=1.sdp',
        f'rtsp://{ip}:554/user={usr}&password={pwd}&channel=0&stream=0.sdp',
        f'rtsp://{usr}:{pwd}@{ip}:554/ucast/11',
        f'rtsp://{usr}:{pwd}@{ip}:554/11',
        f'rtsp://{usr}:{pwd}@{ip}:554/12',
        f'rtsp://{usr}:{pwd}@{ip}:554/live0.264',
        f'rtsp://{usr}:{pwd}@{ip}:554/mpeg4cif',
        f'rtsp://{usr}:{pwd}@{ip}:554/live1.264',
        f'rtsp://{usr}:{pwd}@{ip}:554/cam1/h264',
        f'rtsp://{usr}:{pwd}@{ip}:554/mpeg4cif',
        f'rtsp://{usr}:{pwd}@{ip}:554/ucast/11',
        f'rtsp://{usr}:{pwd}@{ip}:554/ROH/channel/11',
        f'rtsp://{usr}:{pwd}@{ip}:554/h264_stream',
        f'rtsp://{usr}:{pwd}@{ip}:554/live/ch0',
        f'rtsp://{usr}:{pwd}@{ip}:554/live/ch1',
       ]

def test_url(url):
    # try to open the stream
    cap = cv2.VideoCapture(url)
    ret = cap.isOpened()  # if it was succesfully opened, that's the URL you need
    cap.release()
    return ret

# then you just need to check those URLs
for url in urls:
    if test_url(url):
        print(url) 
```

然后我得到了我一直在寻找的东西：

```
rtsp://192.168.1.1:554/user=myuser&password=mypassword&channel=1&stream=0.sdp? 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T06:45:17.320

这台相机可能在 SDK 上工作。但是您可以尝试执行以下操作：

*   打开 Wireshark 并为相机的 IP 设置过滤器；
*   打开相机的网络界面并获取视频；
*   查看 Wireshark 会话 - 可能，有 RTSP 会话。

[http://yummy.micronet.tw/marcom/enews/071312/071312.htm](http://yummy.micronet.tw/marcom/enews/071312/071312.htm) - 在这里我可以看到相机支持 ONVIF，所以，它必须支持 RTSP 在这里[http://yummy.micronet.tw/marcom/enews /point/SP5319-catalog.pdf](http://yummy.micronet.tw/marcom/enews/point/SP5319-catalog.pdf) - 我也可以看到支持的协议 - 包括 RTSP。

因此，如果 Web 界面对您没有帮助，您可以通过 ONVIF 测试工具测试您的相机，您可以在此处找到 RTSP 地址。

请检查 Web 界面中的 RTSP 端口 - 真的是 554 吗？

# unit-testing - 基于内置 Grails taglib 对 Grails 自定义 taglib 进行单元测试

> ID：13688329
> 
> 赞同：0
> 
> 时间：2012-12-03T17:12:51.827
> 
> 标签：unit-testing, grails

我有一个基于 Grails 1.3.7 的应用程序。具体来说，我需要为基于内置 taglib 的自定义 taglib 编写单元测试`<g:select />`。

[我在之前的 SO 帖子](https://stackoverflow.com/questions/6176930/unit-testing-grails-tag)中查看了解决方案，但所述解决方案在我的情况下不起作用（某些属性没有被正确模拟）。

我发现的另一个解决方案是[this](http://www.viaboxxsystems.de/mastering-grails-taglibs)。使用这种方法，我得到了模拟的大部分属性，`FormTagLib`除了需要的`grailsApplication`属性`select`。我得到的实际错误是`Cannot invoke method getArtefact() on null object`.

在这种情况下如何正确编写单元测试？

**编辑**
这是我的[测试类](http://pastebin.com/icaALLfe)和[完整的堆栈跟踪](http://pastebin.com/cTrE6zTM)。stacktrace 上的第 45 行是`g.select`从我的自定义 taglib 调用。我的自定义标签库类似于

```
def clientSpecificQueues = {attrs->
    def queueList = taskService.getClientSpecificQueues(session.clientName)
    def queueLabel = "Some String"

    if (queueList.size() > 0){
        out << queueLabel
    else
        out << g.select(name:'queueId', from: queueList, optionKey: 'id', optionValue: 'name')

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:48:58.253

我相信`grailsApplication`永远不会被默认嘲笑，它有太多的责任。我会尝试通过做类似的事情`grailsApplication`来残酷地嘲笑`setUp()`

```
tagLib.grailsApplication = [getArtefact: { -> return something suitable }] 
```

# android - android：在不使用 MapActivity 的情况下在 Fragments 中显示 GoogleMap

> ID：13688330
> 
> 赞同：0
> 
> 时间：2012-12-03T17:12:58.090
> 
> 标签：android, google-maps

我查看并搜索，但没有看到答案，但看到了许多商业 Android 应用程序，它们可以在片段中显示 Google 地图以及其他片段，以显示项目列表和其他 UI 片段。

我不知道我是否需要为整个应用程序使用 MapActivity，因为除了想要在其中一个片段中显示谷歌地图之外，我还有混合片段。

就像这样：

片段 1：显示用户设置摘要片段 2：显示用户位置的谷歌地图片段 3：显示与用户相关的项目列表

我正在使用类似 Facebook 的菜单 UI 在片段之间导航。我想知道这里是.... 我可以在不使用 MapsActivity 的情况下将这些片段混合在一起吗？如果我确实需要使用 MapsActivity，如何与其他显示不使用 MapsActivity 功能的 UI 元素的片段一起使用它。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:45:36.013

新的 Android 版 Google Maps API V2 刚刚发布，其中包含一个 MapFragment 类，看一下：

[https://developers.google.com/maps/documentation/android/](https://developers.google.com/maps/documentation/android/)

# android - Android 库项目库依赖项

> ID：13688333
> 
> 赞同：1
> 
> 时间：2012-12-03T17:13:02.953
> 
> 标签：android, library-project, android-support-library

我目前正在开发一个使用多个库的项目。多个库使用 android 支持库，所以当我想编译我的应用程序时，Eclipse 会用 Dalvik 错误来抱怨它。我已经发现我的项目中应该只使用支持库 1 次。但是，这破坏了导致我无法再编译的库项目。

我应该如何正确处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:22:28.400

如果您使用 v4 等支持库，并且您的项目包含其他库项目，则应仅保留一个版本的 v4 库。选择一个库文件（例如最大的那个），删除所有重复项，然后将此 v4 复制到每个使用它的项目库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:14:40.337

检查您的任何库是否已经包含支持库。也许它失败了，因为它已经包含在内。

# javascript - 是否有一种 jQuery 方法仅迭代对象自己的属性？

> ID：13688337
> 
> 赞同：4
> 
> 时间：2012-12-03T17:13:08.380
> 
> 标签：javascript, jquery, iteration, for-in-loop, hasownproperty

我正在制作一个类似 jQuery 的小型库，让我感到奇怪的是[`$.each`](http://api.jquery.com/jQuery.each/).

在 javascript 中，我们有一个[`for...in`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)循环：

```
for (var key in obj) {
    console.log(key + ': ' + obj[key]);
} 
```

这样做的问题是，它也会遍历*继承*的属性，即来自对象构造函数原型的属性。

[`hasOwnProperty`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)例如，使用 可以知道这一点。而 jQuery*可以*做到这一点。

但是，当您将对象传递给 时`$.each`，它的行为与 a*完全*一样`for...in`，也会迭代继承的属性。它也应该稍微慢一些，并且需要输入更多字符。

检查[此小提琴](http://jsfiddle.net/mpTkA/)以查看它的实际效果并[在此处](http://james.padolsey.com/jquery/#v=git&fn=jQuery.each)查找`$.each`.

所以我的问题是，jQuery 中是否有只包含自己属性的*对象迭代方法？*如果不是，图书馆应该像这样吗？

**编辑：**由于 jQuery 不这样做，你也可以回答这是否有用。我的意思是，我看不到自己想要迭代原型属性，但也许我错过了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:35:20.083

jQuery 行为是有意义的，因为您始终可以选择在循环中添加 hasOwnProperty 检查 - 或不添加。

我可以看到循环继承的属性在某些情况下（克隆或子类或任何你称之为的）可能很有用。

# python - “ImportError: cannot import name urandom”，virtualenv 未安装

> ID：13688342
> 
> 赞同：1
> 
> 时间：2012-12-03T17:13:30.867
> 
> 标签：python, ubuntu, python-2.7, virtualenv

我正在使用 python 2.7.2 运行 ubuntu 11.10。当我导入随机模块时出现错误

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/random.py", line 47, in <module>
    from os import urandom as _urandom
ImportError: cannot import name urandom 
```

谷歌搜索表明，这似乎是使用 virtualenv 的人的常见问题。通常提出的解决方案是简单地在您遇到问题的目录上重新运行 virtualenv。但是，我没有安装 virtualenv。任何人都可以为我提供任何指导吗？

我看过[ImportError: cannot import name "urandom"](https://stackoverflow.com/questions/13194308/importerror-cannot-import-name-urandom)；它没有帮助，因为我没有安装 virtualenv（我的 $ENV 是空的，以防万一有人好奇）。

我也看过[Python ImportError cannot import urandom since Ubuntu 12.04 upgrade](https://stackoverflow.com/questions/10366821/python-importerror-cannot-import-urandom-since-ubuntu-12-04-upgrade)；它也没有帮助，因为我没有使用 virtualenv。

提前致谢！

# matlab - 通过向量中的索引寻址多个范围

> ID：13688345
> 
> 赞同：1
> 
> 时间：2012-12-03T17:13:36.823
> 
> 标签：matlab

首先，这个问题很容易用 for 循环解决。但是，我试图强迫/教自己以矢量方式思考，以利用 Matlab 最擅长的东西。

简化，这里是问题解释：

*   我有一个包含数据的向量。
*   我有一个 2xN 的开始/停止索引数组，代表向量中有趣数据的范围。
*   我想对这些范围中的每一个执行计算，得到一个数字（N 个结果，对应于每个开始/停止范围。）

在代码中，这是我希望最后拥有的伪示例：

```
A = 1:10000;
startIndicies = [5 100 1000];
stopIndicies = [10 200 5000];
...
calculatedResults = [func(A(5:10)) func(A(100:200)) func(A(1000:5000))] 
```

A 的长度和开始/停止索引数组的长度是可变的。

就像我说的，我可以用 for 循环轻松解决这个问题。但是，由于可以与大型数据集一起使用，我想知道是否有没有 for 循环的好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:33:13.200

这是一种可能的解决方案，不过，我不会将其称为*完全矢量化*的解决方案，而是*单线*解决方案。

```
 out = cellfun(@(i,j) fun(A(i:j)), num2cell(startIndicies), num2cell(stopIndicies) ); 
```

或者，如果您计划有同质的输出，

```
 out = arrayfun(@(i,j) fun(A(i:j)), startIndicies, stopIndicies); 
```

# android - Android MediaPlayer On Stop Event 或类似事件是否存在？

> ID：13688348
> 
> 赞同：0
> 
> 时间：2012-12-03T17:13:41.530
> 
> 标签：android, events, callback, media-player

我有几个使用多种音频功能的活动。为此，我在单例 java 类中有一个 MediaPlayer，因此活动与该类交互并且只存在于媒体播放器上。

其中一项功能是在 X 分钟后自动停止媒体播放器。所以我在单例类中创建了一个计时器，并完美地停止了无线电流。问题是正在运行的活动没有反馈或回调。有一个播放/停止按钮必须更改图像，我不知道如何捕获该 onStop 事件或其他什么......或者可以从当前正在运行的活动类的单个 java 类中调用，所以我可以调用活动的功能以更改图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:18:41.937

您可能想为此使用广播接收器。

从执行停止的 singlton 类中，当您的计时器停止音乐时，调用此方法：

```
public void broadcastMusicPaused(View v){
    Intent broadcast = new Intent();
    broadcast.setAction("MUSIC_STOPPED");
    sendBroadcast(broadcast);
} 
```

然后，从您的控制活动中，像这样设置您的接收器：

```
private BroadcastReceiver receiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub
        Toast.makeText(getApplicationContext(), "Music Paused", Toast.LENGTH_SHORT).show();
        displayMusicStopped();       //switches images
    }
};

@Override
protected void onResume() {
    IntentFilter filter = new IntentFilter();
    filter.addAction("MUSIC_STOPPED");
    registerReceiver(receiver, filter);

    super.onResume();
}

@Override
protected void onPause() {
    unregisterReceiver(receiver);
    super.onPause();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T14:55:10.663

首先，感谢 jameo 的回答，听起来不错，但我不知道我是否有时间尝试，我保证我会在本周或下一次有类似问题的情况下尝试。

最后我这样做了：

1 - 使用方法 onStopMediaPlayer() 创建一个接口；//例如调用MediaPlayerStopInterface

```
public interface MediaPlayerStopInterface {
    /**
     * Called when the player timer ends 
     */
  public void onStopMediaPlayer();
} 
```

2 - 我的活动类实现了界面切换图像。

```
public class PortadaActivity extends Activity implements MediaPlayerStopInterface{
    public void onStopMediaPlayer(){
        //Switch images or whatever
    }
} 
```

3 - 我的单例类有一个接口类型为 MediaPlayerStopInterface 的对象

```
public class AudioControllerClass {   //The Singletton Java Class
    private MediaPlayerStopInterface currentActivity;

    public void setCurrentActivity(MediaPlayerStopInterface mpsi){
    currentActivity=mpsi;
}
} 
```

4 - 我在 onResume() 中的活动类执行 Singlettonclass.setStoppedPlayerInterface(this)，所以我总是有正在运行的活动的参考。

```
public class PortadaActivity extends Activity implements MediaPlayerStopInterface{
    public void onResume() {
        AudioControllerClass.getInstance(getApplicationContext()).setCurrentActivity(this); //In every resume the singletton class knows who was the last one in being active
    }
} 
```

5 - 当计时器执行时，因为我有活动类引用，我只是调用 object_StoppedPlayerInterface.stoppedPlayer();

```
public class AudioControllerClass {   //The Singletton Java Class
    class TimerRadio extends TimerTask {
        public void run() {
            if(whatever==true){
                currentActivity.onStopMediaPlayer();
            }
        }
    }
} 
```

最后，我没有编写代码，但活动中对 onStopMediaplayer 的回调必须使用处理程序完成，如果您不想要“只有 UI 线程可以触摸他的视图”异常：P

它完美地工作:)。但我不知道这是一个非常糟糕的做法还是不是那么可怕 xD

无论如何，感谢 Jameo。你的听起来更优雅：P

# c++ - 如何一致地重播事件列表

> ID：13688354
> 
> 赞同：1
> 
> 时间：2012-12-03T17:14:16.810
> 
> 标签：c++, python, windows

我有一个文件，其中包含间隔一段时间的事件列表。这是一个例子：

```
0, Hello World
0.5, Say Hi
2, Say Bye 
```

我希望能够重播这一系列事件。第一列是两个连续事件之间的增量（第一个立即开始，第二个在 0.5 秒后发生，第三个在 2 秒后发生，...）

我怎么能在 Windows 上做到这一点。有什么可以确保我的时间非常准确吗？我们的想法是尽可能接近听音乐时所听到的，您不希望音频事件发生在正确的时间，而是准时发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:22:07.793

这可以通过使用模块中的`sleep`函数轻松完成`time`。确切的代码应该像这样工作：

```
import time

# Change data.txt to the name of your file
data_file = open("data.txt", "r")

# Get rid of blank lines (often the last line of the file)
vals = [i for i in data_file.read().split('\n') if i]

data_file.close()

for i in vals:
    i = i.split(',')
    i[1] = i[1][1:]
    time.sleep(float(i[0]))

    print i[1] 
```

这是一个不完美的算法，但它应该让您了解如何做到这一点。我们读取文件，将其拆分为换行符分隔列表，然后遍历每个以逗号分隔的对联休眠指定的秒数，并打印指定的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:25:15.087

你[`time.sleep(...)`](http://docs.python.org/2/library/time.html#time.sleep)在 Python 中寻找。

如果将该文件作为列表加载，然后打印值，

```
import time

with open("datafile.txt", "r") as infile:
   lines = infile.read().split('\n')

   for line in lines:
      wait, response = line.split(',')
      time.sleep(float(wait))
      print response 
```

# ios - 运行 CCGrid3DAction 时视网膜图像质量不佳

> ID：13688356
> 
> 赞同：3
> 
> 时间：2012-12-03T17:14:23.230
> 
> 标签：ios, cocos2d-iphone, kobold2d

添加 CCGrid3DAction 例如 CCLiquid 后，我的图像质量非常差

```
CCLiquid *liquid = [CCLiquid actionWithWaves:2 amplitude:5 grid:ccg(100, 100) duration:5];
[self runAction:[CCRepeatForever actionWithAction:liquid]]; 
```

![之前](../Images/86ed83584dddc6ffdfc58809d544171f.png)

![后](../Images/47b35b243abdf0f8760cb5cbd817f219.png)

抓取屏幕后看起来像低分辨率图像或纹理具有一半分辨率，即使幅度为0。

这只发生在视网膜图像和“EnableRetinaDisplaySupport = YES;”上

以下设置没有帮助

```
[[CCDirector sharedDirector] setProjection:kCCDirectorProjection3D];

-- config.lua ( i've set this hi-settings just for testing, )
DefaultTexturePixelFormat = TexturePixelFormat.RGBA8888,
GLViewColorFormat = GLViewColorFormat.RGBA8888,
GLViewDepthFormat = GLViewDepthFormat.Depth24Bit,
GLViewMultiSampling = YES,
GLViewNumberOfSamples = 4, 
```

有任何想法吗？

我正在使用 Kobold2d 2.0.4

更新：用 cocos2d 2.1-beta4 对其进行了测试，但遇到了同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T21:19:37.173

看来这是一个基于与视网膜显示器的这种确切类型问题相关的先前错误的错误。提交错误报告。您遇到的行为不是预期的行为，因此即使您找到了解决方法，仍应报告此问题。[http://cocos2d-central.com/topic/513-read-me-how-to-report-issues-or-request-features/](http://cocos2d-central.com/topic/513-read-me-how-to-report-issues-or-request-features/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:09:57.750

我能想到的一件事是投影模式。默认情况下 cocos2d 2.0 使用 2D 投影，但对于 3D 动作，您必须使用 3D 投影。通过调用 CCDirector 的 setProjection 方法在 AppDelegate 中更改它。

# c# - 使用 javascript 将 .00 添加到 int 数

> ID：13688358
> 
> 赞同：2
> 
> 时间：2012-12-03T17:14:33.093
> 
> 标签：c#, javascript, asp.net

是否可以说一个人在 a 中输入一个整数值 5`Textbox`并在最后自动添加一个 .00 说**5.00**

```
<asp:TextBox ID="txtAmountTransfer" runat="server" Width="55%" CssClass="right"></asp:TextBox> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T17:16:46.583

您可以使用`.toFixed(2)`which 将添加零

看到这个例子[js Fiddle](http://jsfiddle.net/ncRGp/1/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-03T17:58:19.887

@CR41G14 是正确的。.toFixed(2) 就是您所需要的。

至于在哪里以及如何，我建议在输入框上使用更改事件，因为它对用户的干扰最小。（模糊事件也不是不合理的）

由于文本字段的值将是一个字符串，因此您需要像@Snuffleupagus 指出的那样对其进行解析。在您的情况下，我建议使用 parseFloat，因为这样您的字段可能会处理输入 5.2 的用户，这可能会变成 5.20。（使用 parseInt 你最终会得到 5.00）。

另一个注意事项是认识到，如果用户在字段中键入非数字字符（或实际上任何不会解析的值），它将导致显示 NaN，这在您的情况下实际上似乎相当合理。

使用 jQuery：

```
$('#txtAmountTransfer').change(function(){
    $(this).val(parseFloat($(this).val()).toFixed(2))
}); 
```

使用本机代码的类似示例：

```
var textField = document.getElementById('txtAmountTransfer');
    textField.onchange = function(){
        this.value = parseFloat(this.value).toFixed(2);     
    } 
```

# android - 向右或向左移动视图时如何执行操作？像滑动锁定按钮

> ID：13688363
> 
> 赞同：2
> 
> 时间：2012-12-03T17:14:50.987
> 
> 标签：android, slide

这是我的布局。它有两个视图，我通过另一个移动一个。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/time_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <RelativeLayout
        android:id="@+id/slide_layout"
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:layout_margin="20dp"
        android:layout_alignParentBottom="true" >

        <View
            android:id="@+id/slide_to_pause_backgound"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:background="#0000FF" />

        <View
            android:id="@+id/slide_to_pause"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_alignLeft="@+id/slide_to_pause_backgound"
            android:layout_alignParentBottom="true"
            android:background="#00FFFF" />
    </RelativeLayout> 
```

这就是我在活动类中设置要移动的视图的方式：

```
slideView = ((View) findViewById(R.id.slide_to_pause));
slideView.setOnTouchListener(this); 
```

这就是我移动视图的方式：

```
@Override
public boolean onTouch(View view, MotionEvent event) {
    final int X = (int) event.getRawX();
    final int Y = (int) event.getRawY();

    switch (event.getAction() & MotionEvent.ACTION_MASK) {

    case MotionEvent.ACTION_DOWN:
        RelativeLayout.LayoutParams lParams = (RelativeLayout.LayoutParams) view.getLayoutParams();
        viewLeftMargin = X - lParams.leftMargin;
        viewTopMargin = lParams.topMargin;  
        viewBottomMargin = lParams.bottomMargin;
        viewRightMargin = X - lParams.rightMargin;
        break;

    case MotionEvent.ACTION_MOVE:
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) view.getLayoutParams();
        layoutParams.rightMargin = X - viewRightMargin;
        layoutParams.leftMargin = X - viewLeftMargin;           
        layoutParams.topMargin = viewTopMargin;
        layoutParams.bottomMargin = viewBottomMargin;
        view.setLayoutParams(layoutParams);         

        break;
    }
    return true;
    }
} 
```

我想在它向右时做一个动作，在它向左时做另一个动作。

我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:01:40.557

尝试这个：

```
package com.example.motionevent;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.widget.RelativeLayout;

public class MainActivity extends Activity implements OnTouchListener {

    private int viewLeftMargin;
    private int viewTopMargin;
    private int viewBottomMargin;
    private int viewRightMargin;
    private int lastMarginLeft;
    private int lastMarginRight;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        View slideView = (View) findViewById(R.id.slide_to_pause);
        slideView.setOnTouchListener(this);
        RelativeLayout.LayoutParams lParams = (RelativeLayout.LayoutParams) slideView
                .getLayoutParams();
        lastMarginLeft = lParams.leftMargin;
        lastMarginRight = lParams.rightMargin;
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public boolean onTouch(View view, MotionEvent event) {
        // TODO Auto-generated method stub
        final int X = (int) event.getRawX();
        final int Y = (int) event.getRawY();

        switch (event.getAction() & MotionEvent.ACTION_MASK) {

        case MotionEvent.ACTION_DOWN:
            RelativeLayout.LayoutParams lParams = (RelativeLayout.LayoutParams) view
                    .getLayoutParams();
            viewLeftMargin = X - lParams.leftMargin;
            viewTopMargin = lParams.topMargin;
            viewBottomMargin = lParams.bottomMargin;
            viewRightMargin = X - lParams.rightMargin;
            break;

        case MotionEvent.ACTION_MOVE:
            RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) view
                    .getLayoutParams();
            layoutParams.rightMargin = X - viewRightMargin;
            layoutParams.leftMargin = X - viewLeftMargin;
            layoutParams.topMargin = viewTopMargin;
            layoutParams.bottomMargin = viewBottomMargin;
            view.setLayoutParams(layoutParams);
            if (layoutParams.leftMargin > lastMarginLeft) {
                Log.d("ON_TOUCH", "Moving to right!");
                lastMarginLeft = layoutParams.leftMargin;
                                lastMarginRight = layoutParams.rightMargin; // Here
            } else {
                Log.d("ON_TOUCH", "Moving to left!");
                lastMarginRight = layoutParams.rightMargin;
                lastMarginLeft = layoutParams.leftMargin; // and here
            }
            break;
        }
        return true;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:02:29.323

尝试记住视图上第一次触摸的 X 位置，并在移动操作中通过检查该点与当前位置之间的差异来确定用户是向左还是向右移动（可能考虑到向左/向右滑动默认值距离）：

```
public static final int MOVE_SIZE = 30;
public int mStartingX = -1000;

@Override
public boolean onTouch(View view, MotionEvent event) {
    final int X = (int) event.getX();
    final int Y = (int) event.getY();

    switch (event.getAction() & MotionEvent.ACTION_MASK) {

    case MotionEvent.ACTION_DOWN:
        mStartingX = X;
        RelativeLayout.LayoutParams lParams = (RelativeLayout.LayoutParams) view.getLayoutParams();
        viewLeftMargin = X - lParams.leftMargin;
        viewTopMargin = lParams.topMargin;  
        viewBottomMargin = lParams.bottomMargin;
        viewRightMargin = X - lParams.rightMargin;
        break;

    case MotionEvent.ACTION_MOVE:
        RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) view.getLayoutParams();
        layoutParams.rightMargin = X - viewRightMargin;
        layoutParams.leftMargin = X - viewLeftMargin;           
        layoutParams.topMargin = viewTopMargin;
        layoutParams.bottomMargin = viewBottomMargin;
        view.setLayoutParams(layoutParams);         
        if (mStartingX != -1000 && X >= mCurrentX + MOVE_SIZE) {
            doActionRight(); 
        } else if (mStartingtX != -1000 && X < mStartingX - MOVE_SIZE) {
            doActionLeft();
        }
        break;
    case MotionEvent.ACTION_UP:
        mStartingX = -1000;
        break; 
```

# mysql - 触发器 - 语法错误 #1064 新/旧

> ID：13688364
> 
> 赞同：3
> 
> 时间：2012-12-03T17:14:55.883
> 
> 标签：mysql

我在这里犯了什么错误？

```
CREATE TRIGGER total BEFORE UPDATE ON `current` FOR EACH ROW
BEGIN
if new.`new_pay_date` <> old.`new_pay_date`
  SET new.`total_cash` = new.`curr_cash` + new.`total_cash`;
end if;
END;
$$ 
```

错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET new.`total_cash` = new.`curr_cash` + new.`total_cash`; end if;' at line 4 
```

这在没有

```
if new.`new_pay_date` <> old.`new_pay_date`
end if; 
```

但我需要检查这一点，并且只更新日期更改。

当前表：

```
curr_cash
new_pay_date
id_person
id_thing
total_cash 
```

任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:34:02.337

尝试`THEN`在 if 语句的末尾添加：

```
IF new.`new_pay_date` <> old.`new_pay_date` THEN
    SET new.`total_cash` = new.`curr_cash` + new.`total_cash`;
END IF; 
```

# javascript - 我可以在谷歌地图 v3 api 中为一个标记定义多个类别吗？

> ID：13688366
> 
> 赞同：-3
> 
> 时间：2012-12-03T17:15:12.370
> 
> 标签：javascript, google-maps-api-3, google-maps-markers

我想在我的谷歌地图网页中提供两种过滤。每种都基于不同的逻辑：

*   第一种是基于位置类型“房屋、建筑、购物中心……”
*   第二个是基于“用户访问此地点的时间”的时间戳。

我现在能做的是根据位置类型显示或隐藏标记（使用复选框）。

我的问题是：

1-如何根据时间戳显示或隐藏标记？使用时间线或类似的东西。

2- 我可以为一个标记定义两个类别吗？像这样我可以使用复选框来显示和隐藏标记，比如位置类型？

例如，这是我用来根据位置类型显示和隐藏标记的函数：

```
// == shows all markers of a particular location type, and ensures the checkbox is checked ==
function show(category)
{
    var markers = oms.getMarkers();

    for (var i=0; i<markers.length; i++) 
    {
        if (markers[i].mycategory == category)
              markers[i].setVisible(true);
        else
            markers[i].setVisible(false);
    }
    // == check the checkbox ==
    document.getElementById(category+"Box").checked = true;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:37:36.087

`markers[i].mytimestamp`向标记添加属性

添加使用它来执行您想要的操作的显示/隐藏功能。

# html - IE 条件语句不起作用（语法错误？）

> ID：13688369
> 
> 赞同：0
> 
> 时间：2012-12-03T17:15:30.990
> 
> 标签：html, internet-explorer

假设以下代码：

```
<div class="content">
<div style="background:url(swoosh.jpg) no-repeat; background-size:100% 100%;" class="top">
<div style="height:42px; align:center;" id="logo"> 
```

我的目标是让背景为 swoosh.jpg 的 div 成为一个 class=top 的简单 div

我已经尝试让条件自己工作，但是由于某种原因（语法？）它不能正常工作。

以下是我尝试过的

```
<div class="content">
<!--[if !IE]>
<div class="top">
<![endif]-->
<!--[if IE]>
<div style="background:url(swoosh.jpg) no-repeat; background-size:100% 100%;" class="top">
<![endif]--> 
```

我应该提到，除了内联 CSS 之外，我不能为这个应用程序使用任何东西——并且无法访问标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:23:09.367

我认为这是如何做你想做的事，但如前所述，如果你有其他选择，这不是最好的做事方式（在 IE9 中测试 - IE10 不适用于条件语句）：

```
<![if !IE]>
<div class="top">
<![endif]>
<!--[if IE]>
<div style="background:url(swoosh.jpg) no-repeat; background-size:100% 100%;" class="top">
<![endif]--> 
```

[http://jsfiddle.net/APFZh/2/](http://jsfiddle.net/APFZh/2/)

IE 10 定位需要一点 JS：

```
<![if !IE]><!--<script>  
if (/*@cc_on!@*/false) {  
    document.documentElement.className+=' ie10';  
}  
</script><!--<![endif]--> 
```

这会将“ie10”类附加到 html 元素，但您可以在文档中写入任何您想要的内容

[http://www.impressivewebs.com/ie10-css-hacks/](http://www.impressivewebs.com/ie10-css-hacks/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:19:54.263

尝试添加

```
<!--[if lt IE 7]><html class="ie6"><![endif]-->
<!--[if IE 7]><html class="ie7"><![endif]-->
<!--[if IE 8]><html class="ie8"><![endif]-->
<!--[if gt IE 8]><!--><html><!--<![endif]--> 
```

到 HTML 文档的顶部。然后像这样使用CSS

```
.content {
      color:red;
    }
.ie6 .content {
      color:blue;
    }
.ie7 .content {
      color:green;
    } 
```

这样，您可以将所有 CSS 保存在一个文件中，并将 IE 类放在非 IE 类旁边。

查看Paul Irish的这份[文档](http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:17:24.273

更好的做法是让 div 带有 class="top" 但在单独的 IE 样式表中为其设置不同的样式，因为不建议使用内联 CSS。

将其放在页面的 HEAD 中：

```
<!--[if IE]>
<link rel="stylesheet" type="text/css" href="ie.css">
<![endif]--> 
```

至于它不起作用，我建议确保您在页面顶部有一个有效的 DOCTYPE，因为 IE 对此非常挑剔。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-18T04:51:07.373

更新如果有人仍然访问此页面，想知道为什么 ie 定位在最近的 IE 浏览器中不起作用。IE 10 及更高版本不再支持条件注释。来自微软官方网站：

> Internet Explorer 10 标准和怪癖模式已删除对条件注释的支持，以提高互操作性和与 HTML5 的合规性。

请在此处查看更多详细信息：http: [//msdn.microsoft.com/en-us/library/ie/hh801214 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/hh801214(v=vs.85).aspx)

如果您迫切需要以 ie 为目标，您可以使用此 jquery 代码添加一个 ie 类，然后在您的 css 中使用 .ie 类来定位 ie 浏览器。

```
if ($.browser.msie) {
 $("html").addClass("ie");
} 
```

# algorithm - 最小化二叉搜索树的高度

> ID：13688370
> 
> 赞同：0
> 
> 时间：2012-12-03T17:15:34.010
> 
> 标签：algorithm, language-agnostic, binary-tree

如果我试图最小化二叉搜索树的高度，这些是正确的步骤吗？：

1) 从树中生成一个排序数组 2) 通过将排序后的元素按顺序添加到树中来重构树

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:20:27.847

将已排序的列表添加到简单的非平衡二叉搜索树将为二叉搜索树构建理论上的最坏情况。最低值的节点是根，每个节点都被添加到列表中紧接在它前面的节点的“右侧”，并且您创建一个最大深度的树，在 O(n) 时间内搜索而不是 O(lg n ）。您实际上只是在构建一个过于复杂的链表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:46:34.437

对元素进行排序后，通过将中间元素定义为根节点来重建树，然后分别从中间元素之前和之后的元素递归地构建左子树和右子树。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:24:32.267

我认为如果您在尝试通过 插入排序元素之前重建树结构，那么`inorder`您提供的解决方案将是正确的。

1.  重建树。就像一堆。
2.  通过 inorder 插入已排序的元素

例如，如果原始树是这样的：

```
 (5)
           (3)         (6)
      (2)      (4)
  (1) 
```

1.  像这样重建树：

    ```
     ()
        ()            ()
    ()      ()   () 
    ```

2.  `inorder`通过1、2、3、4、5、6插入已排序的元素

    ```
     (4)
         (2)             (6)
    (1)      (3)    (5) 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T17:32:54.707

我想您可以访问树并且可以“手动”更改它。我认为您的平衡问题可以这样解决（伪代码）：

```
depth(node)
{
    if node is null, return 0;
    l = depth(left child);
    r = depth(right child);
    diff = (r - l);
    if (diff < -1) rotate right (as often as you need);
    else if (diff > 1) rotate left (as often as you need);
    return the new maximum depth of both subtrees +1;
} 
```

我必须承认，我对此不太确定，但想法是您不需要临时数组，因为遍历树并应用正确的旋转应该可以。

# ios - iOS bbc iPlayer 风格滚轮

> ID：13688371
> 
> 赞同：2
> 
> 时间：2012-12-03T17:15:35.353
> 
> 标签：ios

有谁知道如何创建像 BBC iPlayer 上使用的轮子来滚动/滑动屏幕上的频道？就像下面的链接：http: [//gogetcreative.co.uk/blog/ui/bbc-releases-radio-iplayer-website-and-app](http://gogetcreative.co.uk/blog/ui/bbc-releases-radio-iplayer-website-and-app)

它是一个gui元素，一种视图，有什么想法吗？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:28:01.293

到发布的时间，我猜他们使用了新`UICollectionView`的 with `UICollectionViewFlowLayout`. 查看有关 CollectionView 的 WWDC 2012 视频和有关该问题的高级讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:36:11.207

它是一个带有自己的 drawRect 方法的“自编程视图”。在 drawRect 中，您自己绘制圆圈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:58:10.917

[您也许可以使用iCarousel](https://github.com/nicklockwood/iCarousel)做类似的事情

# javascript - 不会拖

> ID：13688372
> 
> 赞同：-2
> 
> 时间：2012-12-03T17:15:38.087
> 
> 标签：javascript, html

我在屏幕上动态定位图像。每个图像都有一个 +/- 按钮来修改其大小（在 div 鼠标悬停时显示在 img 的顶部）。每个图像必须是可拖动的。

如果我将 img 设置为，我的 javascript 工作正常，`class="drag"`但它不适用于 div - 显然我希望按钮也可以拖动。这是 html 片段（位于`div`with内`position:relative`）：

```
<div class="drag" onmouseover="showDIVChild(this)" onmouseout="hideDIVChild(this)">
  <img id="my_img_1" style="width:100; height:100;" src="http://www.whatever.com/images/whatever.jpg"/>
  <button id="but_A_1" style="display:none; width:10;height:15; position:absolute; left:5px; top:5px;" onClick="upSizeIMG('my_img_1')">+</button>
  <button id="but_B_1" style="display:none; width:10;height:15; position:absolute; left:20px; top:5px;" onClick="downSizeIMG('my_img_1')">-</button>
</div> 
```

我正在使用[Luke Breuer](http://luke.breuer.com/tutorial/javascript-drag-and-drop-tutorial.aspx)提供的 Javascript 。注意 'drag' 类已`position:absolute`在 CSS 中设置。

为什么不`div`拖？（所有其他功能都在工作）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:37:38.453

最后我找到了答案。我在 onMOuseDown 函数中调整了 Luke 的代码如下。注意我不是说他的代码有什么问题——这正是我在 div 中有一个 img 时所需要的；因为 img 得到 'drag' 事件而不是 div。

前：

```
var target = e.target != null ? e.target : e.srcElement; 
```

后：

```
var target = e.target != null ? e.target.parentNode : e.srcElement.parentNode; 
```

# ffmpeg - FFMpeg 批量图像 + 多个音频到视频

> ID：13688374
> 
> 赞同：2
> 
> 时间：2012-12-03T17:15:55.213
> 
> 标签：ffmpeg

我尝试使用 FFMpeg 执行以下操作我想用一张图片和不同的音频文件（音乐专辑）创建多个视频。这些是我自己的专辑，所以在你问之前我有权这样做。我有 100 多个音频文件可以放在 youtube 上。

有没有办法可以批量创建它，这样我就可以加载一个图像（专辑封面）和多个音频文件（专辑曲目）并自动获取视频到曲目长度？

感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-15T08:21:00.353

我使用这部分代码为我的 YouTube 视频进行转换：

```
for %%a in ("*.*")
do
"C:\ffmpeg\bin\ffmpeg" -loop 1 -i  "C:\ffmpg\bin\input.jpg" -i  "%%a" -c:v libx264 -preset veryslow -tune stillimage -crf 18 -pix_fmt yuv420p -vf scale=854:480 -c:a aac -shortest -strict experimental -b:a 192k -shortest "C:\mp4\%%~na.mp4"
pause 
```

*   "C:\ffmpeg\bin\ffmpeg" 编解码器文件夹
*   "C:\ffmpg\bin\input.jpg" 图片路径
*   "C:\mp4\%%~na.mp4" 输出文件夹
*   -vf scale=854:480 您可以为 youtube 视频指定视频 16:9 的分辨率
*   -c:a aac -shortest 使用 aac 编解码器，通过指定 -shortest 视频长度将匹配音频长度

如果出现错误，请使用 libvo_aacenc 而不是 aac 编解码器，如下所示：

```
-c:a libvo_aacenc -shortest -strict experimental 
```

我希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-22T22:04:09.620

我在尝试几乎同样的事情，看看我是怎么做的：

```
@echo off
set /P format="Type the Video Format: "

        for  %i in (*.%format)   <<<< geting not a reconiezed by CMD 

        do @echo file '%i' > Lista-%format%.txt  

    mylist=Lista-%format%.txt

    ffmpeg.exe -i %mylist% -vf scale=480:320 output-%mylist%.%format% 
```

# c++ - 使用 CGI C++ 下载文件

> ID：13688375
> 
> 赞同：4
> 
> 时间：2012-12-03T17:15:56.897
> 
> 标签：c++, cgi, download, save-as

我有一页显示链接，我有一些文本数据。如何使用 C++ CGI，通过单击超链接“另存为”对话框将出现，并且我的一定数量的文本将以用户定义的路径和名称保存到用户文件系统上的文件。

实际上，主要问题是如何显示“另存为”对话框。之后，我想，一切都会变得容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:19:32.907

只需设置适当的内容类型标头，然后输出文件。

浏览器负责其余的工作。它无法识别的任何文件类型都会导致`Save as`显示对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:54:31.990

它们强制使用浏览器可以显示的 MIME 类型的“另存为”对话框的关键是[Content-Disposition 标头](http://support.microsoft.com/kb/260519)。

# java - 缓冲短 I/O

> ID：13688377
> 
> 赞同：0
> 
> 时间：2012-12-03T17:16:02.207
> 
> 标签：java, buffer, java-io, short

如何在短缓冲区中读/写？

我正在尝试为短值实现 BufferedReader 和 Writer。每次将传递一个短 [] 并将读取一个短 []。

但是java API没有这个接口，只有byte[]。

实现此功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:27:12.533

您可以使用长度为 2 的 ByteBuffer 读取/写入字节并将两组转换为短裤：

```
ByteBuffer put() to put the bytes into or putShort() when going the other way.   
ByteBuffer.getShort() to convert back into shorts. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:36:07.430

好吧，对于您的 BufferedInputStream （不是阅读器），您可以尝试同时读取 2 个字节：

```
public synchronized int read(short[] s, int off, int len) throws IOException {
    byte[] b = new byte[s.length * 2];
    int read = read(b, off * 2, len * 2);
    for (int i = 0; i < read; i+=2) {
        int b1 = b[i];
        int b2 = b[i+1];
        s[i/2] = (short) ((b1 << 8) | b2);
    }
    return read / 2;
} 
```

对于您的 BufferedOutputStream（不是 writer），您可以尝试反向操作同时写入 2 个字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:22:37.713

您可以实现[Reader 接口](http://download.java.net/jdk7/archive/b123/docs/api/java/io/Reader.html)，然后扩展[writer 类](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/Writer.html)以实现除 short[] 之外的 writer。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T22:20:25.473

Just wrap a DataOutputStream around a BufferedOutputStream, and implement a method writeShortArray(short[]) that calls writeShort() iteratively over the array argument. Similarly for input.

# .net - 从两个（不同的）Excel 文件 .NET 中选择

> ID：13688378
> 
> 赞同：1
> 
> 时间：2012-12-03T17:16:09.097
> 
> 标签：.net, excel, oledb

任何人都可以帮我解决这个问题。我想做这样的事情。

```
strSQL = SELECT  [filename1].[" & xlSheet.Name & "$].Col1
, [filename1].[" & xlSheet.Name & "$].Col2
FROM [filename1].[" & xlSheet.Name & "$]
UNION ALL
SELECT [filename2].[" & xlSheet2.Name & "$].Col1
, [filename2].[" & xlSheet2.Name & "$].Col2
FROM  [Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + filename2+ ";Extended Properties=Excel 12.0;HDR=Yes].[" & xlSheet2.Name & "$]
WHERE [filename1].[" & xlSheet.Name & "$].Col1= [filename2].[" & xlSheet2.Name & "$].Col1

Using conExcel As New OleDb.OleDbConnection()
conExcel.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + filename1 + ";Extended Properties=Excel 12.0;HDR=Yes"
conExcel.Open()
cmdSelect.CommandText = strSQL
cmdSelect.Connection = conExcel
intRowsCount = cmdSelect.ExecuteNonQuery() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:08:05.657

您不能使用一个 OleDb 连接来处理两个不同的文件。您需要为第二个文件创建另一个连接并以这种方式提取数据。

下面是我通常如何编写一个方法来从工作表中检索所有数据：

```
private DataTable RetrieveData(string filename, string sheetName)
{
    string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + filename + ";Extended Properties=\"Excel 12.0;HDR=YES\"";
    string query = "SELECT * from [" + sheetName + "$]";
    DataTable dt = new DataTable();

    using (OleDbConnection conn = new OleDbConnection(connectionString))
    {
        conn.Open();

        using (OleDbDataAdapter dataAdapter = new OleDbDataAdapter(query, conn))
        {
            dataAdapter.Fill(dt);
        }

        conn.Close();
    }

    return dt;
} 
```

然后你可以用你的每个文件调用它：

```
DataTable dt1 = RetrieveData("filename1.xlsx", "Sheet1");
DataTable dt2 = RetrieveData("filename2.xlsx", "Sheet1"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T11:17:11.820

您正在尝试在 OleDb 查询中使用 OleDb 的提供程序语法。在查询中连接到外部 Excel 文件的语法不同。

此外，SQL 没有文件的概念，只有表的概念。您不能通过文件名（例如`filename1`，`filename2`）来引用特定文件中的字段。但是，您可以将 UNION 的 FROM 子句中的第二个文件定义为第二个表。

```
var strSQL = String.Format(@"
    SELECT [{0}$].Col1,
        [{0}$].Col2,
    FROM [{0}$]

    UNION ALL
    SELECT [{1}$].Col1,
        [{1}$].Col1
    FROM [{1}$] IN ""{2}"" ""Excel 12.0;""

    WHERE [{0}$].Col1 = [{1}$].Col1
", xlSheet.Name, xlSheet2.Name, @"C:\path\to\exce\file"); 
```

如果您尝试`JOIN`使用表格，请使用 a`JOIN`而不是`UNION`+ `WHERE`。

链接：

*   [IN 条款](http://msdn.microsoft.com/en-us/library/office/bb177907%28v=office.12%29.aspx)
*   [内部联接](http://msdn.microsoft.com/en-us/library/office/bb208854%28v=office.12%29.aspx)

# amazon-s3 - S3：将所有文件从子目录移动到公共目录

> ID：13688380
> 
> 赞同：0
> 
> 时间：2012-12-03T17:16:14.907
> 
> 标签：amazon-s3

我在 S3 上有很多包含大量图像（数百万）的子目录。将文件放在这些子目录中很麻烦，而且由于所有文件名实际上都是唯一的，因此没有理由将它们放在子目录中。所以我需要找到一种快速且可扩展的方法将所有文件从子目录移动到一个公共目录中，或者在不删除文件的情况下删除子目录。

有没有办法做到这一点？

我在使用红宝石，但对几乎任何东西都持开放态度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:15:43.010

我已对您的其他问题添加了评论，解释了为什么 S3 没有文件夹，而是文件名前缀（请参阅[Amazon AWS IOS SDK：如何列出文件夹中的所有文件名](https://stackoverflow.com/questions/9329234/amazon-aws-ios-sdk-how-to-list-all-file-names-in-a-folder/9330600#9330600)）。

考虑到这一点，您可能需要结合使用两个 S3 API 调用来实现您想要的：将文件复制到新文件（从文件名中删除前缀）并删除原始文件。也许有一个 Ruby S3 SDK 或框架公开了重命名功能，但在底层它可能是一个复制/删除。

相关问题：[Amazon S3 boto：如何重命名存储桶中的文件？](https://stackoverflow.com/questions/2481685/amazon-s3-boto-how-to-rename-a-file-in-a-bucket)

# android - Android使用cocos2d设置背景以适应屏幕大小

> ID：13688381
> 
> 赞同：0
> 
> 时间：2012-12-03T17:16:16.690
> 
> 标签：android, glsurfaceview, cocos2d-android

我正在使用 cocos2d 开发我的 android 游戏。我正在使用以下代码设置屏幕背景。

```
 CGSize winSize = CCDirector.sharedDirector().displaySize();
    CCSprite player = CCSprite.sprite("map_image.png");
    player.setScaleX(winSize.getWidth()/player.getTexture().getWidth());
    player.setScaleY(winSize.getHeight()/player.getTexture().getHeight());
    player.setPosition(CGPoint.make(winSize.width/2, winSize.height/2));
    addChild(player); 
```

我正在缩放背景以适应屏幕尺寸。但它正在拉伸背景。请提出任何其他选择。我应该如何拍摄图像以适应不同尺寸的背景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T13:14:35.487

为不同的分辨率使用不同的图像，为您提供最佳的图形效果。您可以检查屏幕尺寸并根据该尺寸为该分辨率定义精灵图像。

```
CCSprite player;
    if(size=...)
{
player = CCSprite.sprite("map_image_ldpi.png");
}else if(size=...)
{
player = CCSprite.sprite("map_image_mdpi.png");
}
.
.
. 
```

[cocos2d android中的图像处理？](https://stackoverflow.com/questions/15024927/images-handling-in-cocos2d-android/15085820#15085820)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:27:14.227

我通常做的是使用比任何屏幕尺寸都大的图片（不使用拉伸），并且在某些屏幕上边缘是不可见的

# jquery - 不能在 jquery ui 可排序事件中的 $.each 函数中使用 $(this)

> ID：13688385
> 
> 赞同：1
> 
> 时间：2012-12-03T17:16:37.383
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, each

我无法从每个内部获取 $(this)。我正在尝试在移动一行后重置表格的 css。“#newTaskBody”是 tbody 的 id。“.newProjectTask”是 s 的类。

```
// make the table sortable;
$("#newTaskBody").sortable({
    stop: function() {
        var counter = 0;
        $.each(".newProjectTask", function() {
            console.log(this.id);
            if(counter == 0)
            {
                $(this).removeClass("even odd");
                $(this).addClass("even");
                counter = 1;
            }
            else
            {
                $(this).removeClass("even odd");
                $(this).addClass("odd");
                counter = 0;
            }
        });
    }
}); 
```

控制台.log(this.id); 尽管我正在测试 4 行，但返回 undefined 15 次。我尝试过“停止”、“更新”和“更改”事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:19:06.487

您将`string`ie传递`".newProjectTask"`给每个函数，而不是具有类 newProjectTask 的元素。每次迭代都会给出`you character of the string`，要查看发生了什么，请查看此[**演示**](http://jsfiddle.net/rajaadil/j5Z4x/)

改变

```
$.each(".newProjectTask", function() { 
```

至

```
$.each($(".newProjectTask"), function() { 
```

这就是您将如何获取每个元素的方式

**[现场演示](http://jsfiddle.net/rajaadil/j5Z4x/1/)**

```
<div id="div1" class="newProjectTask" > div1 </div>
<div id="div1"  class="newProjectTask" > div2 </div>
<div id="div1"  class="newProjectTask" > div3 </div>

​$.each($(".newProjectTask"), function() {
    alert(this.id)
}) 
```

**最好使用每个**ie的其他版本，`$('.newProjectTask').each(`而不是在您使用的一个上。</p>

```
$(".newProjectTask").each( function() {
    alert(this.id)
}) 
```

# java - 将 GUI 设计器 JPanel 添加到 JFrame

> ID：13688393
> 
> 赞同：1
> 
> 时间：2012-12-03T17:17:02.917
> 
> 标签：java, swing, netbeans, jframe, jpanel

我有一个`JPanel`在 NetBeans 中扩展的类。该类正在使用“表单设计器”，您可以在其中将 GUI 元素拖放到屏幕上。我有另一个扩展类，`JFrame`它正在创建此类的一个实例并将其添加到其内容框架中。

`JPanel`班级：

```
/**
 * Creates new form OpenPanel
 */
public OpenPanel() {
    initComponents();
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    jPanel1 = new javax.swing.JPanel();
    jLabel2 = new javax.swing.JLabel();

    jLabel2.setFont(new java.awt.Font("Arial", 0, 48)); // NOI18N
    jLabel2.setText("Jungle Tracks");

    javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
    jPanel1.setLayout(jPanel1Layout);
    jPanel1Layout.setHorizontalGroup(
        jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
            .addContainerGap(87, Short.MAX_VALUE)
            .addComponent(jLabel2)
            .addGap(86, 86, 86))
    );
    jPanel1Layout.setVerticalGroup(
        jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
            .addContainerGap(21, Short.MAX_VALUE)
            .addComponent(jLabel2)
            .addGap(20, 20, 20))
    );

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
    this.setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGap(0, 225, Short.MAX_VALUE))
    );
}// </editor-fold>

// Variables declaration - do not modify
private javax.swing.JLabel jLabel2;
private javax.swing.JPanel jPanel1;
// End of variables declaration
} 
```

主`JFrame`类（我试图将 JPanel 添加到其中）如下：

```
public class MainClass extends JFrame {

static final int WIDTH = 800;
static final int HEIGHT = 600;

public MainClass() throws FileNotFoundException, IOException, UnsupportedAudioFileException, LineUnavailableException, BackingStoreException {
    super("MainClass");

    setSize(WIDTH, HEIGHT);
    setBackground(Color.WHITE);

    OpenPanel open = new OpenPanel();
    ((OpenPanel)open).setFocusable(true);

            getContentPane().add(open);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);              
    setVisible(true);
}

public static void main(String[] args) throws FileNotFoundException, IOException, UnsupportedAudioFileException, LineUnavailableException, BackingStoreException {
    MainClass mc = new MainClass();
}

} 
```

但是没有显示在 NetBean 的设计视图中创建的 JPanel 及其 UI 元素，或者据我所知——甚至添加到`JFrame`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:10:56.647

我猜您的`paint(...)`方法没有调用其中的`super.paint(...)`方法，因此 JPanel 没有很好地绘制自己的组件。如果是这样，那么我建议：

*   不要覆盖`paint(...)`，因为这很少需要，如果完成，必须小心完成，因为此方法不仅负责绘制组件，还负责绘制其边框*及其子组件*——您似乎遇到的正是这个问题。
*   取而代之的是覆盖`paintComponent(...)`，但一定要`super.paintComponent(...)`在这个方法中调用，通常作为方法的第一行。

# objective-c - 调用创建当前类的类中的方法？

> ID：13688394
> 
> 赞同：0
> 
> 时间：2012-12-03T17:17:05.617
> 
> 标签：objective-c, ios, class, methods, parent-child

这个更难解释：我有`ClassA`which has `MethodA`，它对 中的一些对象做了一些事情`ClassA`，假设它设置了几个标签。

ClassA 还创建了一个 的实例`ClassB`，它是一个侧边栏视图。我需要 ClassB 对 ClassA 中的对象执行与 MethodA 相同的操作，更新 ClassA 实例中的那些标签。

我需要 ClassB 才能调用 MethodA，但让它作用于创建 ClassB 实例的 ClassA 的特定实例。

这些类（至少目前）不会相互继承，因为它们实际上还没有共享任何东西。我将 ClassA 中的一些数据填充到 ClassB 的标签中，现在我需要做相反的事情。

我不能`[super MethodA]`从 ClassB 中调用，因为它们不继承。我需要的是类似于 a 的东西`[parent methodA]`，它将在创建此 ClassB 对象的类中调用该方法，并让它作用于 ClassA 的特定实例。

这样的事情存在吗？道歉，乱七八糟的帖子，我不确定要搜索什么来寻找这样一个模糊的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:20:45.337

您需要自己创建它。一般模式是在您的子类中创建一个监听器分配，并且“父级”（更一般地，想要接收通知的对象）调用您建立的方法来分配一个监听器。如果您愿意，您可以让您的孩子保持多个听众，或者只保留一个听众。侦听器应该实现一些适合您计划如何传递数据的协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:21:35.623

不，如果您正在使用组合，那么您需要一种外部方式来引用包含客户端的类。

更简单的方法是在实例化对象时传递父对象：

```
@interface ClassB {
  ClassA *parent;
}

-(id)initWithA:(ClassA*)parent;

@property (readonly, retain) ClassA *parent;

@end

@implementation ClassB

-(id)initWithA:(ClassA*)parent {
  if ((self = [super init])) {
    self.parent = parent;
  }

  return self;
}

@end 
```

这样您就可以拥有`ClassB`：

```
-(void)method {
  [parent updateThings:params];
} 
```

请注意，在这种情况下，由于两个类声明都是交叉引用的，因此您需要`@class ClassA`在头文件中进行前向声明（例如 ）才能使其编译。

# javascript - 为单独的 div 创建 onmouseover 函数

> ID：13688395
> 
> 赞同：3
> 
> 时间：2012-12-03T17:17:10.670
> 
> 标签：javascript, jquery, html, function, onmouseover

好吧，我会尽量把这点说清楚。善良，我对 JavaScript 很陌生。

我有一个名为 nav 的 div 容器，它包含五个导航按钮，它们都并排浮动。在那个容器下，我有一个名为 underbar 的 div 容器，它只是每个导航元素下的一个纯色条。当有人将鼠标悬停在导航 div 上时，该元素下栏的颜色会发生变化。现在，我有你在下面看到的，它工作正常。

```
<div id="container">
<div id="nav">
<div id="one" onmouseover="document.getElementById('ubone').style.background='gray'" onmouseout="document.getElementById('ubone').style.background='white';"><a href="one.html">One</a>    </div><!-- end of first nav -->
<div id="two" onmouseover="document.getElementById('ubtwo').style.background='gray'" onmouseout="document.getElementById('ubtwo').style.background='white';"><a href="two.html">Two</div><!-- end of second nav -->
<div id="three" onmouseover="document.getElementById('ubthree').style.background='gray'" onmouseout="document.getElementById('ubthree').style.background='white';"><a href="three.html">Three</div><!-- end of third nav -->
<div id="four" onmouseover="document.getElementById('ubfour').style.background='gray'" onmouseout="document.getElementById('ubfour').style.background='white';"><a href="four.html">Four</div><!-- end of fourth nav -->
<div id="five" onmouseover="document.getElementById('ubfive').style.background='gray'" onmouseout="document.getElementById('ubfive').style.background='white';"><a href="five.html">Five</div><!-- end of fifth nav -->
</div><!-- end of nav div -->

<div id="underbar">
<div id="ubone"></div><!-- end of first nav -->
<div id="ubtwo"></div><!-- end of second nav -->
<div id="ubthree"></div><!-- end of third nav -->
<div id="ubfour"></div><!-- end of fourth nav -->
<div id="ubfive"></div><!-- end of fifth nav -->
</div><!-- end of underbar div -->

</div><!-- end of container div--> 
```

这很好用，是的。但是，我绝对讨厌不得不一一编辑这些的想法。使用 javascript 函数/jquery（最好）同时能够为多个 div id 进行简化的最简单方法是什么？想法/意见？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:24:37.477

这针对作为元素`div`的直接子`#nav`元素的 's。

```
$(document).ready(function(){
    $('#nav > div').mouseover(function(){

        $('#ub' + this.id).css('backgroundColor', 'grey');

    }).mouseout(function(){

        $('#ub' + this.id).css('backgroundColor', 'white');

    });
}); 
```

如果你想要一个纯 Javascript 解决方案，那么试试这个：

```
window.onload = function(){

    var elements = document.querySelectorAll('#nav > div');

    for(var i=0; i<elements.length; i++)
    {
        elements[i].onmouseover = function(){
            document.querySelector('#ub' + this.id).style.backgroundColor = 'grey';
        };
        elements[i].onmouseout = function(){
            document.querySelector('#ub' + this.id).style.backgroundColor = 'white';
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:53:59.243

**[这是一个有效的 DEMO](http://jsfiddle.net/AVk6k/1/)答案：**

[http://jsfiddle.net/AVk6k/1/](http://jsfiddle.net/AVk6k/1/)

并改用[jQuery`.hover()`](http://api.jquery.com/hover/)。 `.hover()`就像一个速记，结合`.mouseenter()`并`.mouseleave()`成为一个处理程序。

恕我直言，`mouseenter`并且`mouseleave`比`mouseover`和更可靠`mouseout`，后者往往会闪烁。

**jQuery：**

```
$(document).ready(function() {
    $('#nav div').hover(
    function() {
        $('#ub' + this.id).css('background-color', 'grey');
    }, function() {
        $('#ub' + this.id).css('background-color', 'white');
    });
});​ 
```

您还缺少一些`</a>`标签。

**HTML：**

```
<div id="container">
    <div id="nav">
        <div id="one"><a href="one.html">One</a></div><!-- end of first nav -->
        <div id="two"><a href="two.html">Two</a></div><!-- end of second nav -->
        <div id="three"><a href="three.html">Three</a></div><!-- end of third nav -->
        <div id="four"><a href="four.html">Four</a></div><!-- end of fourth nav -->
        <div id="five"><a href="five.html">Five</a></div><!-- end of fifth nav -->
    </div><!-- end of nav div -->
    <div id="underbar"> 
        <div id="ubone"></div><!-- end of first nav -->
        <div id="ubtwo"></div><!-- end of second nav -->
        <div id="ubthree"></div><!-- end of third nav -->
        <div id="ubfour"></div><!-- end of fourth nav -->
        <div id="ubfive"></div><!-- end of fifth nav -->   
    </div><!-- end of underbar div -->   
</div><!-- end of container div-->​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T17:26:12.930

```
$(".myClass").mouseover(function() {
    $('#ub' + this.id).css('background-color', 'gray');
  }).mouseout(function(){
     $('#ub' + this.id).css('background-color', 'white');
  }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T17:31:33.760

提供的所有解决方案都使用 jQuery 来实现您想要的。使用纯 Javascript（速度更快），使用以下方法：

```
<script type="text/javascript">
function hoverMenu(elem)
{
    document.getElementById('ub' + elem.id).style.background='gray';
}

function blurMenu(elem)
{
    document.getElementById('ub' + elem.id).style.background='white';
}
</script>

<div id="container">
    <div id="nav">
        <div id="one" onmouseover="hoverMenu(this);" onmouseout="blurMenu(this);"><a href="one.html">One</a>    </div><!-- end of first nav -->
        <div id="two" onmouseover="hoverMenu(this);" onmouseout="blurMenu(this);"><a href="two.html">Two</div><!-- end of second nav -->
        <div id="three" onmouseover="hoverMenu(this);" onmouseout="blurMenu(this);"><a href="three.html">Three</div><!-- end of third nav -->
        <div id="four" onmouseover="hoverMenu(this);" onmouseout="blurMenu(this);"><a href="four.html">Four</div><!-- end of fourth nav -->
        <div id="five" onmouseover="hoverMenu(this);" onmouseout="blurMenu(this);"><a href="five.html">Five</div><!-- end of fifth nav -->
    </div><!-- end of nav div -->

    <div id="underbar">
        <div id="ubone"></div><!-- end of first nav -->
        <div id="ubtwo"></div><!-- end of second nav -->
        <div id="ubthree"></div><!-- end of third nav -->
        <div id="ubfour"></div><!-- end of fourth nav -->
        <div id="ubfive"></div><!-- end of fifth nav -->
    </div><!-- end of underbar div -->
</div><!-- end of container div--> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T17:26:29.197

```
$("#nav").on("mouseover", "div", function() {
    $('#ub' + this.id).css('backgroundColor', 'gray');
}).on("mouseout", "div", function() {
    $('#ub' + this.id).css('backgroundColor', 'white');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-03T17:29:32.703

**编辑：误读了这个问题。这是我修改后的答案。**

我会建议一个语义上更正确的标记。由于您的导航实际上是一个链接列表，因此通常将其设置为这样的标准做法：

```
<ul id="nav">
  <li rel="#ubone"><a href="mypage1.html">One</a><li>
  <li rel="#ubtwo"><a href="mypage2.html">Two</a><li>
  <li rel="#ubthree"><a href="mypage3.html">Three</a><li>
  <li rel="#ubfour"><a href="mypage4.html">Four</a><li>
</ul> 
```

这确实需要一些额外的样式来删除默认列表样式，但会导致导航对 Google 网络爬虫更有意义，并遵循良好的编码实践。如果有疑问，这里是 css 的开始：

```
#nav {margin:0; padding:0;}
#nav li {list-style:none; float:left; padding:5px 10px; background:#FFF;}
#nav a {color:#000; text-decoration:none;} 
```

要回答您的原始问题，您可以使用 jQuery 添加行为，如下所示：

```
$(document).ready(function(){
  // The document ready waits for the document to load before adding JS to the elements
  // We use the css selector for our element to select it, then use the hover function to apply a behaviour
  $('#nav li').hover(function(){
    // This function executes when the mouse hovers over the li
    var target = $(this).attr('rel');
    $(target).css({
      'background' : '#ccc'
    });
  }, function(){
    // This function executes when the mouse leaves the li
    var target = $(this).attr('rel');
    $(target).css({
      'background' : '#fff'
    });        
  });
}); 
```

如果您需要更多关于 jQuery 的帮助，请访问[http://api.jquery.com/](http://api.jquery.com/)，那里有一些优秀的深度文档。

**注意**- 没有看到你应用的实际样式我不能确定，但​​听起来你的下划线也可以通过添加底部边框然后使用 ":hover" css 伪类更改悬停颜色来完成.

# wcf - 使用直接队列而不是 net.msmq 配置 customDeadLetterQueue

> ID：13688400
> 
> 赞同：1
> 
> 时间：2012-12-03T17:17:23.780
> 
> 标签：wcf, msmq

所以我在我的 WCF 服务上设置了 MSMQ。我正在使用 msmqIntegrationBinding 将电子邮件直接转储到本地队列中，然后我的服务会抓取它们并处理它们，一切正常，但我正在尝试添加一个自定义死信队列，尽管它似乎可以工作，即它没有我的服务处于故障状态，我定义的自定义队列永远不会包含任何内容。我认为问题在于我正在尝试使用直接队列而不是 net.msmq 值作为我的 customDeadLetterQueue 值。

让我通过一些例子来更清楚地说明。我见过的所有样本看起来都是这样的。

```
 <binding name = "CustomDLQ"
       deadLetterQueue = "Custom"
       customDeadLetterQueue = "net.msmq://localhost/private/MyCustomDLQ">
   </binding> 
```

我的配置看起来像这样。

```
 <msmqIntegrationBinding>
    <binding name="EmailProcessorBinding" 
             deadLetterQueue="Custom" 
             customDeadLetterQueue="msmq.formatname:DIRECT=OS:.\private$\failedmessages" 
             durable="true" 
             receiveRetryCount="2"
             receiveErrorHandling="Move" 
             maxRetryCycles="3"  >
      <security mode="None" />
    </binding>
  </msmqIntegrationBinding> 
```

注意到 customDeadLetterQueue 了吗？那是行不通的吗？还是我在其他地方犯了错误？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T15:10:40.237

显然，由于缺乏经验，我错过了这一点，但我不需要明确告诉它我想使用的队列，这最终是我最终配置绑定的方式。

```
<msmqIntegrationBinding>
 <binding name="EmailProcessorBinding" 
                     durable="true" 
                     receiveRetryCount="0"
                     receiveErrorHandling="Move" 
                     retryCycleDelay="00:20:00" 
                     maxRetryCycles="3" >
  <security mode="None" />
 </binding>
</msmqIntegrationBinding> 
```

请注意，我不需要告诉它如何处理失败的消息。当它失败时，它将简单地将它们放入一个称为毒物的子队列中，无需配置。

![带有毒消息的子队列](../Images/a53d8e6627b0d1b8738f7996febb5b28.png)

# android - 如何获得共享意图的结果？

> ID：13688402
> 
> 赞同：4
> 
> 时间：2012-12-03T17:17:31.153
> 
> 标签：android

我正在使用下一个代码进行共享：

```
Intent sendIntent = new Intent(Intent.ACTION_SEND); 
sendIntent.putExtra(Intent.EXTRA_TEXT, getString(R.string.share_text));
sendIntent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(file));
sendIntent.setType("image/png");
startActivityForResult(Intent.createChooser(sendIntent,
    getResources().getString(R.string.share_via)), REQUEST_SHARE_RESULT); 
```

我想在我的`onActivityResult()`函数中检查这个意图的结果。但它总是返回`Activity.RESULT_CANCELED`。连分享都成功了。为什么？？？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-03T17:21:46.680

在您的孩子活动中，您必须先打电话，`setResult()`然后再打电话`finish()`；这就是孩子如何将其结果返回给父母的`onActivityResult()`方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T18:06:44.040

试试这个例子的 startActivityForResult()。 [http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_31.html，http://android.rahulblogs.com/android-startactivityforresult-example/](http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_31.html) _ [_](http://android.rahulblogs.com/android-startactivityforresult-example/)

# scala - 如何在（akka）Actor 中处理多个 Promise？

> ID：13688408
> 
> 赞同：5
> 
> 时间：2012-12-03T17:18:17.563
> 
> 标签：scala, akka, actor

我有一个负责处理 http 调用的 Akka 演员。我使用 scala dispatch 通过 API 发送多个 HTTP 请求：

```
urls.foreach { u
  val service = url(u)
  val promise = Http(service OK as.String).either
  for(p <- promise)
  {
     p match
     {
       case Left(error) =>
         faultHandler(error)
       case Right(result) =>
         resultHandler(result)
     }
  } 
```

在`resultHandler`函数中，我增加一个实例变量`nbOfResults`并与我完成的调用次数进行比较。

```
def resultHandler(result:String)
{
  this.nbOfResults++
  ...
  if(nbOfResults == nbOfCalls)
    // Do something
} 
```

安全吗？`nbOfResults`如果两个调用同时返回结果，是否可以同时访问该变量？

目前，我认为actor或多或少相当于一个线程，因此回调函数不会同时执行。这是正确的吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:21:16.290

这是仅使用 dispatch 的 Alexey Romanov 响应的变体：

```
//Promises will be of type Array[Promise[Either[Throwable, String]]]
val promises = urls.map { u =>
    val service = url(u)

    Http(service OK as.String).either
}

//Http.promise.all transform an Iterable[Promise[A]] into Promise[Iterable[A]]
//So listPromise is now of type Promise[Array[Either[Throwable, String]]]
val listPromise = Http.promise.all(promises)

for (results <- listPromise) {
    //Here results is of type Array[Either[Throwable, String]]

    results foreach { result =>
        result match {
            Left(error) => //Handle error
            Right(response) => //Handle response
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:35:07.603

有一个更好的方法：

```
val promises = urls.map {u =>
  val service = url(u)
  val promise = Http(service OK as.String).either
}

val listPromise = Future.sequence(promises)

listPromise.onComplete { whatever } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T17:44:06.050

我同意 Alexey Romanov 的回答。无论您选择以何种方式同步您的 http 请求，请注意您处理承诺完成的方式。您的直觉是正确的，因为并发访问可能会出现在参与者的状态上。处理此问题的更好方法是执行以下操作：

```
def resultHandler(result: String) {
    //on completion we are sending the result to the actor who triggered the call
    //as a message
    self ! HttpComplete(result)
} 
```

在演员的接收功能中：

```
def receive = {
    //PROCESS OTHER MESSAGES HERE
    case HttpComplete(result) => //do something with the result
} 
```

这样，您可以确保处理 http 结果不会从外部违反参与者的状态，而是从参与者的接收循环，这是正确的方法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T17:57:06.570

```
val nbOfResults = new java.util.concurrent.atomic.AtomicInteger(nbOfCalls)

// After particular call was ended    
if (nbOfResults.decrementAndGet <= 0) {
  // Do something
} 
```

[编辑] 使用 AtomicReference CAS 删除旧答案 - while(true)、compareAndSet 等

# html - HTML 表格，如 LaTeX 制表符；每行的最后一列应该跨越整个表格

> ID：13688409
> 
> 赞同：3
> 
> 时间：2012-12-03T17:18:19.403
> 
> 标签：html, css, latex

我想要一个看起来像这样的 HTML 表格：

```
C1  Some text right here
    C2  Some text here too
        C3  And maybe some text here
    C4  Basically like a text written with tabbing
C5  You get the point? 
```

我知道我可能可以在这里使用一个列表，但我希望列（每行的最后一个除外）具有固定的宽度。在 LaTeX 中，这会起作用：

```
\newenvironment{mytable}
{\begin{tabbing}
xxxxxxxxx\=xxxxxxxxx\=xxxxxxxxx\=xxxxxxxxx\=xxxxxxxxx\=xxxxxxxxx\=\kill}
{\end{tabbing} }%

mytable{
C1 \> Some text right here \+\\
  C2 \> Some text here too \+\\
    C3 \> And maybe some text here \-\\
  C4 \> Basically like a text written with tabbing \-\\
C5 \> You get the point?
} 
```

我尝试在 HTML/CSS 中执行此操作，但结果如下所示：

```
C1  Some text right here
                          C2  Some text here too
                                                  C3  etc... 
```

有小费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:25:34.853

**首先，这是对表格的非常糟糕的滥用，应该真正避免。**（加粗是因为我对此感觉非常强烈）。:)

其次，您遇到的问题是您需要 colspanning 才能正确完成。您实际上并没有显示您使用的 html，但该示例看起来您只是将空表格单元格放在事物前面，但由于表格的工作方式，这意味着下一个单元格在所有内容结束后开始第一个单元格。

因此，这样做的方法是像这样构造你的表：

```
<table>
<tr><td colspan="3">First line</td></tr>
<tr><td></td><td colspan="2">second line</td></tr>
<tr><td></td><td></td><td>third line</td></tr>
</table> 
```

带有一些样式的示例：http: [//jsfiddle.net/Sd4Mx/](http://jsfiddle.net/Sd4Mx/) 这个想法是第一行跨越整个表格。第二行有一个表格单元格，然后该行的其余部分跨越整个表格，等等。

对于更多行，您的表中需要更多列，但这是一个粗略的想法。

最后一个更好的缩进方法是只使用`div`带边距的元素。

```
<style>
div.indent
{
    margin-left: 50px;
}
</style>

<div>
First line
    <div class="indent">Second line
        <div class="indent">Third line</div>
    </div>
</div> 
```

同一个小提琴的例子：http: [//jsfiddle.net/Sd4Mx/](http://jsfiddle.net/Sd4Mx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T15:25:00.850

我尝试了这个解决方案，这似乎可以解决问题。这是CSS：

```
div.start
{
    display: inline-block;
    vertical-align: top;
    width: 60px;
}
ul.tabbing
{
    list-style-type: none;
    margin: 0;
    padding: 0;
}
ul.tabbing li ul
{
    list-style-type: none;
    margin: 0;
    padding: 0;
    margin-left: 60px;
} 
```

这是HTML：

```
<ul class="tabbing">
  <li><div class="start">C1</div>Some text right here
  <ul>
    <li><div class="start">C2</div>Some text here too
    <ul>
      <li><div class="start">C3</div>And maybe some text here</li>
    </ul></li>
    <li><div class="start">C4</div>Basically like a text written with tabbing</li>
  </ul></li>
  <li><div class="start">C5</div>You get the point?</li>
</ul> 
```

它与问题中的解释不完全一样（虽然很接近），但解决了我遇到的指定问题。

# python - Pydot中决策树的字典对象

> ID：13688410
> 
> 赞同：8
> 
> 时间：2012-12-03T17:18:31.150
> 
> 标签：python, dictionary, machine-learning, decision-tree, pydot

我有一个字典对象：

```
menu = {'dinner':{'chicken':'good','beef':'average','vegetarian':{'tofu':'good','salad':{'caeser':'bad','italian':'average'}},'pork':'bad'}} 
```

[我正在尝试使用带有“菜单”数据的](http://pythonhaven.wordpress.com/2009/12/09/generating_graphs_with_pydot)pydot 创建一个图形（决策树）。

'Dinner' 将是顶部节点，其值（鸡肉、牛肉等）位于其下方。参考链接，graph函数有两个参数；一个源和一个节点。

它看起来像[这样](http://pythonhaven.files.wordpress.com/2009/12/example1_graph.png)：

除了“king”是“dinner”，“lord”是“chicken”、“beef”等。

我的问题是：如何访问值中的键？要从这些数据中创建一棵树，我觉得我需要创建一个循环来检查特定键是否存在值并绘制它。我不确定如何调用任何字典对象的值（如果它不一定称为“晚餐”或具有尽可能多的元素。）。

关于如何绘制它的任何建议？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-03T19:32:44.397

## 使用递归函数

您可能需要考虑使用**递归**函数（就像`visit`下面我的代码中的那样，以便您能够处理一般的嵌套字典。在此函数中，您希望传递一个`parent`参数来跟踪谁是您的传入节点。另外请注意，您用于`isinstance`检查键的字典值是否是它自己的字典，在这种情况下，您需要`visit`递归调用您的字典。

```
import pydot

menu = {'dinner':
            {'chicken':'good',
             'beef':'average',
             'vegetarian':{
                   'tofu':'good',
                   'salad':{
                            'caeser':'bad',
                            'italian':'average'}
                   },
             'pork':'bad'}
        }

def draw(parent_name, child_name):
    edge = pydot.Edge(parent_name, child_name)
    graph.add_edge(edge)

def visit(node, parent=None):
    for k,v in node.iteritems():
        if isinstance(v, dict):
            # We start with the root node whose parent is None
            # we don't want to graph the None node
            if parent:
                draw(parent, k)
            visit(v, k)
        else:
            draw(parent, k)
            # drawing the label using a distinct name
            draw(k, k+'_'+v)

graph = pydot.Dot(graph_type='graph')
visit(menu)
graph.write_png('example1_graph.png') 
```

## 生成的树结构

![在此处输入图像描述](../Images/fc8886dce6dc6503331d93e91779fd1a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:28:14.790

您的问题对我来说并不完全清楚，但是在 Python 中访问字典键值的方法很简单：

```
dictionary[key] 
```

这将返回给您该键的值。如果该键不在字典中，它将返回 a `KeyError`，因此，如果您正在使用字典并且不确定您请求的键是否在字典中，您有两个选择。

If 语句（首选）：

```
if key in dictionary:
    return dictionary[key] 
```

试着抓：

```
try:
    return dictionary[key]
except KeyError:
    pass 
```

如果您不知道字典中的键并且需要获取它们，您可以简单地调用`dictionary.keys()`它，它将返回字典中所有键的列表。

获取字典键的值将返回一个对象，该对象甚至可能是另一个对象。因此，例如，要找出 的值`"tofu"`，我们将执行以下操作：

```
menu['dinner']['vegetarian']['tofu']
# returns value 'good' 
```

# javascript - jQuery在提交时替换文本

> ID：13688416
> 
> 赞同：0
> 
> 时间：2012-12-03T17:19:08.150
> 
> 标签：javascript, jquery

我在网站上有一个文件上传表单，我想在文件上传时用文本“上传...”替换表单。到目前为止，我有：

```
$( document ).ready(function(){
    $(form).submit(function(){
        $('#key').html("Uploading...");
    });
}); 
```

提交部分有效，因为我让它在提交时发出警报，而 .html 部分有效，因为当它不在提交功能中时它会更改 html。表单位于 id 为“key”的 div 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:24:36.377

```
<form id="someForm"></form>
<div id="key" style="display:none">Uploading...</div>

$( document ).ready(function(){
    $('#someForm').submit(function(){
        $('#key').show();
        $('#someForm').hide();
    });
}); 
```

# wpf - MEF 中的本地化：导出属性不支持资源 (WPF - C#)

> ID：13688418
> 
> 赞同：1
> 
> 时间：2012-12-03T17:19:19.433
> 
> 标签：wpf, plugins, localization, mef

我有一个使用 MEF 的插件架构的应用程序。对于每个导出的部件，都有一个带有部件名称的属性，我希望翻译名称，因为我使用这些字符串来显示 ListBoxes（或类似）中的可用部件。

因此，我尝试在 [Export] 注释中设置“Name = Strings.SomeText”，但出现以下错误：

“属性参数必须是属性参数类型的常量表达式、typeof 表达式或数组创建表达式”

有针对这个的解决方法吗？我发现元数据的使用非常有用（我做延迟加载），我不想为了翻译一些文本而重新设计所有内容。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:57:54.163

不幸的是，您不能直接将翻译后的文本提供给属性，因为属性只能包含[编译时](http://msdn.microsoft.com/en-us/library/aa664615%28v=vs.71%29.aspx)已知的数据。因此，您需要提供一些编译时间常数值，以便以后用于查找翻译后的测试。

一种解决方案是将资源名称传递给属性。然后，当您要显示翻译后的文本时，您可以获取资源名称，在资源中查找文本并显示结果。

例如，您的属性可能类似于：

```
[Export(Name = "SomeText")]
public class MyExport
{
} 
```

然后，当您想要显示字符串时，您从定义导出的程序集中加载资源，并从加载的资源中提取实际文本。例如像这样（从[另一个答案](https://stackoverflow.com/a/3827643/539846)借来的）：

```
var assembly = typeof(MyExport).Assembly;

// Resource file.. namespace.ClassName
var rm = new ResourceManager("MyAssembly.Strings", assembly);

// exportName contains the text provided to the Name property 
// of the Export attribute
var text = rm.GetString(exportName); 
```

此解决方案的一个明显缺点是您失去了使用 Strings.SomeText 属性获得的类型安全性。

- - - - - 编辑 - - - - -

为了更容易获得翻译文本，您可以创建一个派生词，`ExportAttribute`它需要足够的信息来提取翻译文本。例如，自定义`ExportAttribute`可能看起来像这样

```
public sealed class NamedExportAttribute : ExportAttribute
{
    public NamedExportAttribute()
        : base()
    { 
    }

    public string ResourceName
    {
        get;
        set;
    }

    public Type ResourceType
    {
        get;
        set;
    }

    public string ResourceText()
    {
        var rm = new ResourceManager(ResourceType);
        return rm.GetString(ResourceName);
    }
} 
```

使用此属性，您可以像这样应用它

```
[NamedExport(
    ResourceName = "SomeText", 
    ResourceType = typeof(MyNamespace.Properties.Resources))]
public sealed class MyClass
{ 
} 
```

最后，当您需要获取翻译文本时，您可以这样做

```
var attribute = typeof(MyClass).GetCustomAttribute<NamedExportAttribute>();
var text = attribute.ResourceText(); 
```

另一种选择是使用[DisplayAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.displayattribute.aspx)

# jquery - 如何在 symfony2 的 ajax 对话框中修复登录表单

> ID：13688423
> 
> 赞同：0
> 
> 时间：2012-12-03T17:19:34.490
> 
> 标签：jquery, ajax, symfony, login, fosuserbundle

我正在 symfony2 中为我的登录表单实现一个对话框，它运行良好，除了我想用更多逻辑处理返回，现在我不知道该怎么做，因为防火墙配置会接收登录提交。

发生的情况是，如果登录失败，我的对话框的 html 将被登录控制器返回的新 html 替换，这一切都很好。但是如果成功登录尝试，我的登录对话框的 html 将替换为我的整个站点（因为成功的 symfony2 登录将重定向到起始页......）。

在平面 PHP 中，我会将其添加到登录控制器

```
if (login_successful) {
  return "success";
} 
```

并在我的对话功能中放

```
if (returned_data == "success") {
  refresh_page(); // or location.href('something')
}
else
{
  // replace dialog_html with the returned html
} 
```

但是，当我查看处理登录表单提交 i FOS 用户捆绑包的操作时，这就是我发现的

```
public function checkAction()
{
    throw new \RuntimeException('You must configure the check path to be handled by the firewall using form_login in your security firewall configuration.');
} 
```

所以我意识到这一切都是在 symfony2 的幕后处理的，那我能做到吗？

实际示例代码（JS）...

```
function submitFormWithAjax(form) {
  form = $(form);
  $.ajax({
    url: form.attr('action'),
    data: form.serialize(),
    type: (form.attr('method')),
    dataType: 'html',
    success: function(data) {
        if (data == 'success') {
            //Success-token is passed, so reload page (will close dialog and load the logged-in start screen since user is now fully authenticated
            location.reload();
        }
        else {
            //Form is returned, probably with errors, so let user try again...
            $('#formDialog').html(data);
        }
      }
  });
  return false;
} 
```

和形式...

```
<form action="{{ path("fos_user_security_check") }}" method="post" id="login-form">
    <input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />

    <TABLE>
        <TR>
            <TD><label for="username">Login</label></TD>
            <TD><input type="text" placeholder="användare" id="username" name="_username" value="{{ last_username }}" /></TD>
        </TR>
        <TR>
            <TD><label for="password">Lösenord</label></TD>
            <TD><input type="password" placeholder="lösenord" id="password" name="_password" /></TD>
        </TR>
        <TR>
            <TD><label for="remember_me">Kom ihåg mig</label></TD>
            <TD><input type="checkbox" id="remember_me" name="_remember_me" value="on" /></TD>
        </TR>
        <!--
        <TR>
            <TD></TD>
            <TD align="right"><input type="submit" id="_submit" name="_submit" value="Logga in" /></TD>
        </TR>
        -->
    </TABLE>

</form> 
```

* * *

根据下面的 m2mdas 建议，我现在设置了这些：

配置.yml

```
#My services
services:
    my.authentication.success_handler:
        class:     Hemekonomi\UserBundle\AuthenticationSuccessHandler
        parent:    security.authentication.success_handler 
```

我的 userbundle 现在有这个类

```
<?php
namespace MyApp\UserBundle;

use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Security\Http\Authentication\DefaultAuthenticationSuccessHandler;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;

class AuthenticationSuccessHandler extends DefaultAuthenticationSuccessHandler
{
   public function onAuthenticationSuccess(Request $request, TokenInterface $token)
    {
        if(true === $request->isXmlHttpRequest()) {
            return new Response("success");
        }

        //default redirect operation.
        return parent::onAuthenticationSuccess($request, $token);
    }

} 
```

...而security.yml具有...

```
firewalls:
    main:
        pattern: ^/
        form_login:
            provider: fos_userbundle
            csrf_provider: form.csrf_provider
            success_handler: my.authentication.success_handler
        logout:       true
        anonymous:    true 
```

我得到的错误是这个

```
RuntimeException: The parent definition "security.authentication.success_handler" defined for definition "my.authentication.success_handler" does not exist. 
```

它可能与格式有关，它在 xml/yml 中是否不同？我也不是这方面的专家，所以......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:02:45.803

您可以使用防火墙配置`success_handler`的`failure_handler`选项。例如

成功处理程序类，

```
namespace Your\NameSpace;

use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Security\Http\Authentication\DefaultAuthenticationSuccessHandler;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;

class AuthenticationSuccessHandler extends DefaultAuthenticationSuccessHandler
{
   public function onAuthenticationSuccess(Request $request, TokenInterface $token)
    {
        if(true === $request->isXmlHttpRequest()) {
            return new Response("success");
        }

        //default redirect operation.
        return parent::onAuthenticationSuccess($request, $token);
    }

} 
```

故障处理程序类，

```
namespace Your\NameSpace;

use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Security\Http\Authentication\DefaultAuthenticationFailureHandler;
use Symfony\Component\Security\Core\Exception\AuthenticationException;

class AuthenticationFailureHandler extends DefaultAuthenticationFailureHandler
{
    public function onAuthenticationFailure(Request $request, AuthenticationException $exception)
    {
        if(true === $request->isXmlHttpRequest()) {
            return new Response("failure");
        }

        //default redirect operation.
        return parent::onAuthenticationFailure($request, $exception);

    }
} 
```

服务定义（xml）

```
 <service id="my.authentication.success_handler" class="Your\NameSpace\AuthenticationSuccessHandler" parent="security.authentication.success_handler"/>

    <service id="my.authentication.failure_handler" class="Your\NameSpace\AuthenticationFailureHandler" parent="security.authentication.failure_handler"/> 
```

或者，yml 服务定义，

```
my.authentication.success_handler:
    class: Your\NameSpace\AuthenticationSuccessHandler
    parent: security.authentication.success_handler

my.authentication.failure_handler:
    class: Your\NameSpace\AuthenticationFailureHandler
    parent: security.authentication.failure_handler 
```

最后在`security.yml`,

```
security:
    firewall:
        your_firewall:
            #...
            form_login:
                #...
                success_handler: my.authentication.success_handler
                failure_handler: my.authentication.failure_handler 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T11:07:08.497

我最终使用了这个解决方案（感谢 m2mdas 和[http://blog.alterphp.com/2011/10/set-up-authenticationsuccesshandler.html](http://blog.alterphp.com/2011/10/set-up-authenticationsuccesshandler.html)）

配置.yml

```
#My services
parameters:
    security.authentication.success_handler.class: MyApp\UserBundle\Resources\AuthenticationSuccessHandler

services:
    security.authentication.success_handler:
        class: %security.authentication.success_handler.class%
        public: false
        arguments:  ['@router', '@security.user.entity_manager'] 
```

安全.wml

```
firewalls:
    main:
        pattern: ^/
        form_login:
            provider: fos_userbundle
            csrf_provider: form.csrf_provider
            success_handler: security.authentication.success_handler
        logout:       true
        anonymous:    true 
```

successhandler（包括比我要求的功能稍多的功能，以后可能会使用它）：

```
<?php

namespace MyApp\UserBundle\Resources;

use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Security\Http\Authentication\AuthenticationSuccessHandlerInterface;
use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\Routing\RouterInterface;
use Doctrine\ORM\EntityManager;

/**
 * Custom authentication success handler
 */
class AuthenticationSuccessHandler implements AuthenticationSuccessHandlerInterface
{

   private $router;
   private $em;

   /**
    * Constructor
    * @param RouterInterface   $router
    * @param EntityManager     $em
    */
   public function __construct(RouterInterface $router, EntityManager $em)
   {
      $this->router = $router;
      $this->em = $em;
   }

   function onAuthenticationSuccess(Request $request, TokenInterface $token)
   {

        if(true === $request->isXmlHttpRequest()) {
            return new Response("success");
        }

        //default redirect operation.
        $uri = $this->router->generate('MyAppSkrivbordBundle_homepage');
        return new RedirectResponse($uri);

   }
} 
```

# wpf - WPF 样式层次结构

> ID：13688424
> 
> 赞同：0
> 
> 时间：2012-12-03T17:19:42.040
> 
> 标签：wpf, xaml, wpf-controls

我创建了一个自定义控件 ColorToggleButton，它继承了 ToggleButton。在相应的 .xaml 文件中，ColorToggleButton 的一个特定于 TargetType 和 BasedOn ToggleButton。

```
<Style TargetType="ctl:ColorToggleButton" BasedOn="{StaticResource {x:Type ToggleButton}}"> 
```

这很好用，但是如果我使用 x:Key 在窗口中应用另一种样式，如

```
<Style x:Key="SameContent"><Setter Property="Content" Value="Same Content" /></Style>
<ctl:ColorToggleButton Style={StaticResource SameContent} /> 
```

旧样式似乎完全消失了，取而代之的是新样式。我可以通过使用 BasedOn 来规避这个问题

```
<Style x:Key="SameContent" BasedOn="{StaticResource {x:Type ctl:ColorToggleButton}}"><Setter Property="Content" Value="Same Content" /></Style>
<ctl:ColorToggleButton Style={StaticResource MyKey} /> 
```

但这对我来说似乎违反直觉，因为如果我将样式应用于普通的 ToggleButton 或其他一些默认控件，我不会使用 BasedOn 属性。这是实施您自己的控制的标准方式吗？我做错了什么可怕的事情吗？

编辑：ColorToggleButton 的静态构造函数如下：

```
static ColorToggleButton()
{
    DefaultStyleKeyProperty.OverrideMetadata(typeof(ColorToggleButton), new FrameworkPropertyMetadata(typeof(ColorToggleButton)));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:29:12.670

在您的控件中，您是否提供了具有[DefaultStyleKeyProperty](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.defaultstylekey.aspx)覆盖的静态构造函数？

```
static ColorToggleButton()
{
            DefaultStyleKeyProperty.OverrideMetadata(typeof(ColorToggleButton), new FrameworkPropertyMetadata(typeof(ColorToggleButton)));
} 
```

# android - 从原生代码在android平台上初始化OpenGL

> ID：13688428
> 
> 赞同：1
> 
> 时间：2012-12-03T17:20:02.183
> 
> 标签：android, c++, opengl-es, android-ndk

我想从本机代码初始化 Android 平台上的 OpenGL ES。

我只是想利用活动的某些部分，例如，在面板上或像这样的smth。
在 Windows 平台中，我使用 HWND 处理程序来指定要绘制的表单的“部分”......

在***NDK/samples/native-activity***我找到了一些例子。在这个例子中，使用了***ANativeWindow***（就像 Windows 中的 HWND（据我所知））。

但是如何将 ANativeWindow 指针传递给本机代码呢？

# jquery - 如何定义使用 jquery Quicksearch 搜索的上下文？

> ID：13688431
> 
> 赞同：2
> 
> 时间：2012-12-03T17:20:15.670
> 
> 标签：jquery, quick-search

我在定义要搜索的插件的上下文时遇到问题。

问题是，我有多个输入文本（用户可以从一个按钮添加越来越多），我正在做这样的事情：

`$('.inp_txt').quicksearch('ul.myList li');`

对于每个输入文本，我都有一个列表，如选择框，在键入时显示结果。问题是，当用户开始输入第一个输入时，插件会显示所有其他输入中的所有 .myList。我需要它只显示用户所在输入文本中的列表。

我认为我不能为每个列表使用不同的类并专门为每个列表调用插件，因为在导航时可以通过 JS 添加更多输入。

无论如何我可以定义上下文，使用`$(this)`或其他东西，所以插件知道它只在那个特定的列表中搜索？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:56:10.557

您遇到的问题是您的语法将*单个插件实例*应用于选择器中的*所有项目。*

`$('.inp_txt').quicksearch(...)`就像调用`('.inp_txt').click(...)`- 您将获得一个处理程序，用于每个匹配的元素。

要解决此问题，您需要执行以下操作：

```
$('.inp_txt').each(function (index, value) {
    var $input = $(value);

    // Get a reference to the list you want for this input...
    var $quickSearch = $('ul.myList li');

    $input.quicksearch($quicksearch);
}); 
```

此代码将遍历每个`.inp_txt`项目并为每个项目应用一个唯一的处理程序。

在您的场景中，听起来您只有一个`ul.myList`- 这可能是您总是看到相同列表的另一个原因。如果是这种情况，您可能会考虑类似...

```
<div>
  <input type="text" class="inp_txt" />
  <ul class="myList">
   <li>...</li>
  </ul>
</div> 
```

然后您可以将上面的代码调整为：

```
$('.inp_txt').each(function (index, value) {
    var $input = $(value);
    var $quickSearch = $input.siblings('ul.myList');

    $input.quicksearch($quicksearch);
}); 
```

这样，您将获得每个文本框的唯一列表。显然，我不知道你的场景的其余部分是否知道这在你的应用程序的逻辑中是否可能 - 但也许。

最后 - 当您添加新控件时，您需要调整创建它们的代码，以便您也将新的处理程序附加到它们。就像是：

```
function addInput(/*... params ...*/) {
    /* Do your logic to create the control */
    $newInput.quicksearch($newList);
} 
```

显然，在上面的代码中，假设您将创建一个`$newInput`新元素`<input type="text" />`- 和一个新列表，您将调用`$newList`.

我希望这会有所帮助 - 如果没有，请随时发表一些评论并澄清，我会尝试调整我的答案。

# java - 项目不继承的 Eclipse/Java 工作区设置（即使禁用“项目特定”）

> ID：13688438
> 
> 赞同：0
> 
> 时间：2012-12-03T17:20:42.607
> 
> 标签：java, eclipse

我最近分配到的项目使用 Eclipse 作为构建工具被卡住了。（我可以让它显示或报告的唯一版本是“Indigo”。如果有与之相关的实际版本号，它已经被很好地隐藏了。一旦你已经是 Eclipse 专家，可能真的很明显。）

我们已将工作区设置配置为大部分默认设置，并在此处和那里增加了编译器警告级别。

现在，在导入各种项目之后，开发人员发现了大量的 Java 构建错误，因为合规级别显示为 1.4，而不是最近的；这会导致有趣的错误，例如“断言无法解析为类型”。我们已经浏览了“Java 编译器”设置中的每一个菜单和子菜单，并且对所有这些设置都**禁用**了“项目特定设置” 。工作区配置为使用 1.7，但项目实际上并未继承这些设置。

目前，我们已启用项目特定设置，并将所有工作区设置复制（叹息）到每个项目。这似乎完全违背了首先进行工作区设置的意义！除了禁用项目特定的东西之外，每个项目中是否有一些隐藏的设置需要重置？

</沮丧>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:45:22.963

你可以尝试两件事：

*   进入“配置构建路径”对话框，然后单击“库”选项卡。查看项目使用了哪个 JRE。有时，JRE 被设置为项目上次在其中工作的上一个工作区中使用的内容。您可以删除“系统库”或 JRE 条目。如果你留下这样的东西，我相信 JRE 和设置将默认为工作区默认值。最坏的情况是您必须进入并“添加库”以选择正确的 JRE。

*   如果失败，您可以在项目根目录的 .settings 文件夹中四处寻找。这是所有工具存储其设置的地方（除了 .classpath 文件）。当危急时刻需要采取危急措施时，您可以删除此目录中的某些文件，甚至删除整个目录。请注意，文件或文件夹名称中的缩写 JDT 表示该文件或文件夹与 java 工具有关。另请注意，名称以“。”开头的所有文件和文件夹。默认是隐藏的。您需要转到导航器视图才能看到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T15:36:43.390

在 Window->Preferences->Java->Compiler 中，我将合规级别更改为任意值，然后将其更改回我真正想要的。这为我修好了！

# jakarta-ee - JavaEE：'SELECT FOR UPDATE NOWAIT' 失败时没有将 JTA 事务标记为回滚？

> ID：13688447
> 
> 赞同：3
> 
> 时间：2012-12-03T17:21:41.787
> 
> 标签：jakarta-ee, jpa, locking, jta

我正在尝试在 JavaEE 中使用“SELECT FOR UPDATE NOWAIT”（使用 JPA）。我就是这样做的：

```
props.put("javax.persistence.lock.timeout", 0);
em.find(MyEntity.class, id, LockModeType.PESSIMISTIC_READ, props); 
```

这很顺利，除了一件事：如果失败（无法获取锁），则抛出 PessimisticLockException 而不是 LockTimeoutException（如果设置了任何其他正超时则抛出），这会导致事务（JTA 事务）标记为回滚。

我已经尝试使用本机查询，但它产生了相同的结果。
我正在使用带有 EclipseLink 的 Weblogic 12.1（也尝试过 TopLink，没有区别）。

当执行失败时，是否有任何方法可以执行“SELECT FOR UPDATE NOWAIT”而不会在 JavaEE 中将 JTA 事务标记为回滚？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T15:12:21.947

请记录一个错误并为它投票。

您可以通过创建自己的 OraclePlatform 子类并覆盖 isLockTimeoutException() 来修复它。

您还可以将查询作为 DatabaseQuery 执行以避免回滚。

```
em.unwrap(Session.class).executeQuery(((JpaQuery)query).getDatabaseQuery()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-14T08:12:21.927

使用下面的代码跳过锁定的行。这是

> select * from student where student id = n for update nowait

如果行已被锁定， findStudnt 方法将引发错误。如果没有错误调用 updateStudent 方法来更新学生实体，则记录错误以供审核。

```
@Override
public Student findStudent(final Long studentId) {
    TypedQuery<Student> query = getEntityManager().createNamedQuery("from Student s where s.studentId =:studentId", Student.class);
    query.setParameter("studentId", studentId);
    query.setLockMode(LockModeType.PESSIMISTIC_WRITE);
    query.setHint(JAVAX_PERSISTENCE_LOCK_TIMEOUT, ZERO_NUMBER);
    return query.getSingleResult();
}

@Override
@Transactional(readOnly = false, propagation = Propagation.REQUIRED)
public void updateStudent(Student student) {
    makePersistent(student);
    getEntityManager().flush();
} 
```

# sql - SQL Server：存储过程可以很好地执行，但最后出现错误“找不到对象”

> ID：13688450
> 
> 赞同：3
> 
> 时间：2012-12-03T17:21:53.300
> 
> 标签：sql, sql-server

全部：

关于我遇到的问题，我已经搜索了几个小时。谷歌和这里有类似的问题，但没有一个是相同的。

我有一个简单的存储过程 A，正确授予我的登录权限。它基本上用数据填充一些表。它与我的登录用户在同一架构中。我可以成功执行它，这意味着所有数据都按预期填充。但是，在执行结束时，消息窗口显示：

**消息 15151，级别 16，状态 1，程序 A，第 xxx 行找不到对象“A”，因为它不存在或您没有权限。**

行号指向 SP 定义的结尾。我不知道为什么会出现此错误消息，而 SP 在执行结果方面似乎完全没有问题。

编辑：

SP代码如下：

```
IF EXISTS (SELECT * FROM SysObjects WHERE id = OBJECT_ID('dbo.spA') AND type = 'P')
    DROP PROCEDURE dbo.spA
GO

CREATE PROCEDURE dbo.spA
    @ReportCCY as char(3) = 'GBP',
    @Date as date = null                  /* for regression testing */
AS
BEGIN

    if (@Date is null)
        select @Date = convert(varchar(20), max(VDate), 112) from JB H (nolock)

    declare @dbname as varchar(50)
    select @dbname = DB_NAME()
    exec DBA_admin.App.p_usr_Truncate @DB=@dbname, @Schema='dbo', @Table='ATable'

    insert into dbo.ATable
    select r.Value, I.id
    from Rates r
    join Inst I (nolock) on I.idCCyBase = r.idHold and r.ccyinto = @ReportCcy and r.dtDate = @Date
END

GRANT EXECUTE ON dbo.spA TO UserGrp
GO 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T17:50:15.073

你在“END”之后忘记了“GO”。现在“GRANT EXECUTE”是您程序的一部分。

# sql - SQL if 语句返回错误

> ID：13688453
> 
> 赞同：0
> 
> 时间：2012-12-03T17:21:56.983
> 
> 标签：sql, sql-server, stored-procedures, if-statement

所以我有一个正在工作的存储过程，除了它如何计算某个字段。在使用的表上是一个名为的字段，它的格式`DeliveryYearMonth`只是简单的。`YYYYMM`我尝试将当前月份的信息与上个月的信息进行比较，因此我创建了以下两个变量。

```
DECLARE @CURDate VARCHAR(50) -- Current time (YYYYMM)
DECLARE @MAGDate VARCHAR(50) -- YearAgo Time (YYYYMM)

SET @CURDate = cast((select max(DeliveryYearMonth) from dbo.datatable) as  varchar)
SET @MAGDate = cast((substring(@CURDate,1,4)) as varchar) --For current year
         + cast((substring(@CURDate,5,2) - 1) as varchar) -- To get previous month 
```

除非月份是一月，否则这一切都很好，花花公子，因此月份将变为 00，而年份将保持不变。

因此，我尝试使用 if 语句来澄清这一点。

```
if(substring(@MAGDate,5,2)) = '00'-- If current Month is January
begin
Set @MAGDate = cast((substring(@CURDate,1,4) - 1) as varchar) --For previous year
         + '12' -- December
end 
```

`(@MAGDate)`即使`IF`陈述不正确，这总是会破坏 Month Ago Date 。我不知道为什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:28:11.107

要获取先前版本的字符串，您可以执行以下操作：

```
select replace(convert(varchar(7), dateadd(month, -1, CAST(@CURDate+'01' as DATE)), 121), '-', '') 
```

不过，正如评论所建议的那样，假设您使用的是 SQL Server 2008 或更新版本，您实际上应该将其存储为日期。

# asp.net - 使用状态服务器在 asp.net 中获取会话数据成本

> ID：13688457
> 
> 赞同：1
> 
> 时间：2012-12-03T17:22:03.423
> 
> 标签：asp.net, session

我正在为我的一个网站使用 ASP.NET 会话状态服务器。我将一个用户对象放在会话中，因为它被使用了很多。

考虑以下代码片段：

```
DoSomething(SessionUser.Me.UserID)
DoSomeMore(SessionUser.Me.UserName) 
```

SessionUser.Me 是一个静态属性，它的作用类似于：

```
return (SessionUser)Session["currentuser"]; 
```

现在因为我访问 SessionUser.Me 2 次（DoSomething 和 DoSomeMore）是 .NET 足够聪明，不会对 stateserver 进行 2 次往返并反序列化 2 次？

换句话说，如果我只是这样做，它的性能是否相同：

```
var user = SessionUser.Me;
DoSomething(user.UserID)
DoSomeMore(user.UserName) 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:23:26.353

Session 在请求管道的早期从状态服务器反序列化（参见[HttpApplication.AcquireRequestState](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.acquirerequeststate.aspx)，并在页面执行完成时写回状态服务器（参见[HttpApplication.ReleaseRequestState](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.releaserequeststate.aspx)）。

因此，您不应因重复访问而导致性能下降。

# solr - SOLR 词频

> ID：13688459
> 
> 赞同：2
> 
> 时间：2012-12-03T17:22:05.240
> 
> 标签：solr, frequency, term

我正在使用 solr，到目前为止一切都很好。当我进行搜索时，我想返回搜索“词”在每个文档中出现的次数，以及文档本身。我找到了很多信息，但是经过它之后，我仍然不明白我该如何做到这一点。有那么难吗？

谁能帮我吗？

尽管我确实得到了结果，但 fl 字段始终为 0

```
http://localhost:8983/solr/collection1/select?q=text:*mySearchTerm*&fl=*,fl:termfreq(text,*mySearchTerm*) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T12:29:23.673

好的，我发现 termfreq 不适用于 MultiValues 字段。所以我使用了一个复制字段并添加了 termVectors="true" termPositions="true" termOffsets="true"。现在它可以工作了

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-03T20:12:57.737

您可能想查看[http://wiki.apache.org/solr/LukeRequestHandler](http://wiki.apache.org/solr/LukeRequestHandler) - 您应该在返回的 xml 中看到标签“numTerms”，以便您根据需要的每个字段使用。

# android - Android OpenGL ES 渲染 compex 对象不正确

> ID：13688461
> 
> 赞同：2
> 
> 时间：2012-12-03T17:22:15.530
> 
> 标签：android, opengl-es, culling

我正在尝试编写绘制复杂非凸对象的程序。但我有问题 - 有些面孔似乎是透明的。我通过添加部分解决了这个问题 `GLES20.glEnable(GLES20.GL_CULL_FACE);`

但是在那之后我发现如果有两个面的法线方向相同并且一个放在另一个后面，它就不起作用。在这种情况下，Open GL 渲染不正确。我也尝试添加 `GLES20.glEnable(GLES20.GL_DEPTH_TEST)`

但我没有达到目的。而且，一半的物体消失了。你能解释一下，我哪里错了吗？

PS 为了获得对象顶点，我使用了 Blender（我将其数据导出到 obj 文件中）。我还检查了这些数据 - 顶点顺序正确（CCW）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-24T15:27:59.343

我遇到了同样的问题。问题是您没有在 configAttribslist 中为深度和模板分配缓冲区的大小。因此，即使您指定 DepthTest，它也不会计算深度。

解决方案：将以下行添加到 eglChooseConfig 属性列表中。EGL10.EGL_DEPTH_SIZE, 8, EGL10.EGL_STENCIL_SIZE, 8，这解决了我的问题。

代码：

```
private static int[] s_configAttribs2 = { 
   EGL10.EGL_RED_SIZE, 4, 
   EGL10.EGL_GREEN_SIZE, 4, 
   EGL10.EGL_BLUE_SIZE, 4, 
   EGL10.EGL_DEPTH_SIZE, 8, 
   EGL10.EGL_STENCIL_SIZE, 8, 
   EGL10.EGL_SAMPLE_BUFFERS, 1,
   EGL10.EGL_RENDERABLE_TYPE, 
   EGL_OPENGL_ES2_BIT, 
   EGL10.EGL_NONE 

};

egl.eglChooseConfig(display, s_configAttribs2, configs, numConfigs, num_config); 
```

# ads - 循环批处理请求（每个 50 次调用）以进行到达时间 api 调用

> ID：13688462
> 
> 赞同：1
> 
> 时间：2012-12-03T17:22:17.293
> 
> 标签：ads, facebook-ads-api

我正在尝试针对特定定位进行大规模覆盖估计调用，并且每个 api 调用搜索不同的关键字以返回该关键字的覆盖估计。有一次我为 300 个关键字执行此操作，每个批处理请求限制为 50 个，我执行此操作 6 次（循环），而且速度非常慢。有没有人对如何在没有循环的情况下更快地做到这一点有任何建议？

# asp.net - 弹出日历似乎没有弹出文本框焦点

> ID：13688466
> 
> 赞同：0
> 
> 时间：2012-12-03T17:22:46.823
> 
> 标签：asp.net, ajaxcontroltoolkit

我创建了一个简单的弹出日历，它似乎不会在我的文本框的焦点上打开，我不知道问题是什么：

```
<asp:TableRow>
        <asp:TableCell>
            <asp:Label ID="Label3" runat="server" Text="Start Date"></asp:Label> 
        </asp:TableCell>
        <asp:TableCell>  
            <asp:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server"></asp:ToolkitScriptManager>
            <asp:TextBox ID="txtStartDate" runat="server"></asp:TextBox>
            <asp:CalendarExtender ID="CalendarExtender1" TargetControlID="txtStartDate" runat="server" />
        </asp:TableCell>
    </asp:TableRow> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:32:31.167

在 web.config 文件中添加：

```
<add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
<add verb="GET" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler" validate="false"/> 
```

在我的项目引用中添加了 System.Web.Extensions

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T15:19:10.413

代码很好。完全没有问题，但**建议将 ToolkitScriptManager 放在表单标签的下方。** 另外，我想问题不在于代码，而在于您项目中添加的工具包的引用。

**怎么解决：**

1）右键单击您的网站名称并选择**“添加参考”**。浏览到 AjaxControlToolkit.dll 所在的路径，然后按确定。

2）如果您已经在项目中设置了引用，**请将其删除，然后重新添加**引用。

3)**请确保项目中添加的引用与您的 Visual Studio 工具箱中的工具包版本相同。**否则可能会导致严重的问题。

# php - PHP PDO dblib 不工作

> ID：13688468
> 
> 赞同：3
> 
> 时间：2012-12-03T17:22:56.607
> 
> 标签：php, sql-server, pdo

我正在尝试连接到托管在另一组服务器上的 MS SQL 数据库。我可以连接旧方式。

```
$myServer = "server name";
$myUser = "username";
$myPass = "pword";
$myDB = "dbname"; 

if (is_callable('mssql_connect')) {
    $link = mssql_connect($myServer, $myUser, $myPass);

    if (!$link) {
        die('connection failed');
    }   
} else {
    echo 'mssql_connect() is not supported on this environment';
}

//connection to the database
$dbhandle = mssql_connect($myServer, $myUser, $myPass);

//select a database to work with
$selected = mssql_select_db($myDB, $dbhandle)
  or die("Couldn't open database $myDB"); 
```

这可以很好地连接到 ms sql 服务器。当我尝试使用 PDO dblib 时，我收到以下错误“SQLSTATE[01002] Adaptive Server 连接失败（严重性 9）”

这是我为此使用的代码，我已经检查并安装了 pdo 和 dblib 作为使用的选项。凭据都完全相同。

```
$myServer = "server name";
$myUser = "username";
$myPass = "pword";
$myDB = "dbname"; 

try {
  # MS SQL Server and Sybase with PDO_DBLIB
  $DBH = new PDO("dblib:host=$myServer;dbname=$myDB, $myUser, $myPass");
}
catch(PDOException $e) {
    echo $e->getMessage();
} 
```

任何帮助将不胜感激，因为我计划在 php 中创建一个新的应用程序以连接到这个 MS SQL 数据库，但将来计划在所有旧的经典 asp 都重建为 php 后将 db 迁移到 Mysql。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T17:25:04.277

PDO 连接语法应该是这样的，

```
$DBH = new PDO("dblib:host=$myServer;dbname=$myDB", $myUser, $myPass); //wrongly placed quotes 
```

[手动的](http://php.net/manual/en/pdo.connections.php)

# python - 在 Python 中使用 utf-8 字符的 API 下载 YouTube 字幕

> ID：13688470
> 
> 赞同：2
> 
> 时间：2012-12-03T17:23:00.207
> 
> 标签：python, youtube-api

我正在使用[Jeff 的演示代码](http://gdata-samples.googlecode.com/svn/trunk/gdata/captions_demo.py)来使用 YouTube API 和 Python 与我的视频的字幕进行交互。而且我的英语视频效果很好。不幸的是，当我尝试将它与具有西班牙语自动转录的视频一起使用时，其中包含 á¡ 等字符，我收到编码错误：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 25: ordinal not in range(128) 
```

我的 Python 脚本`# -*- coding: utf-8 -*-`位于顶部，我已将其更改 `CAPTIONS_LANGUAGE_CODE`为`'es'`，但该脚本似乎仍在将其下载的 .srt 文件解释为`ascii`而不是`utf-8`. 它下载 .srt 文件的行是：

```
if response_headers["status"] == "200":
  self.srt_captions = SubRipFile.from_string(body) 
```

如何让 Python 考虑 srt 文件，`utf-8`以便它不会引发编码错误？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T07:38:18.323

看起来这根本不是 Youtube API 问题，而是 Python 问题。请注意，您的错误不是编码错误，而是解码错误；您偶然发现了 Python 的工作方式（无论好坏）。Python 中的很多很多函数会将 unicode 数据转换为 8 位字符串而不是原生 unicode 对象，使用带有十六进制数字的 \x 来表示大于 127 的字符。（一种这样的方法是 SubRipFile 对象的“from_string”方法） '正在使用。）因此数据仍然是 unicode，但对象是字符串。因此，当您随后强制转换为 unicode 对象（通过在您提供的示例代码中使用 unicode 对象的 'join' 方法触发）时，Python 将采用 ascii 编解码器（8 位字符串的默认值） ,

有几种解决方案。

1) 你可以明确地告诉 Python，当你运行你的 join 方法时不要假设一个 ascii 编解码器，但我总是很难做到这一点（并且在每种情况下都这样做）。所以我不会尝试一些示例代码。

2）您可以放弃本机 unicode 对象，而只使用 8 位字符串来处理您的 unicode 数据；这只需要您更改此行：

```
body = u'\n'.join(lines[2:]) 
```

对此：

```
body = '\n'.join(lines[2:]) 
```

但是，这种方法有潜在的缺点——同样，您必须确保在每种情况下都这样做；您也不会利用 Python 原生的 unicode 对象（这可能会或可能不会在您的代码中成为问题）。

3）您可以使用低级“编解码器”模块来确保从一开始就将数据转换为本机 unicode 对象，而不是使用 8 位字符串。通常，您以这种方式完成这样的任务：

```
import codecs
f=codecs.open('captions.srt',encoding='utf-8')
l=f.readlines()
f.close()
type(l[0]) # will be unicode object rather than string object 
```

当然，您有使用返回字符串的 SubRipFile 对象的复杂性，但是您可以通过使用编解码器通过 StringIO 对象发送它（因此编解码器模块可以将翻录的数据视为文件）来解决这个问题。 encode() 方法等。Python 文档对所有这些都有很好的部分。

祝你好运。

# windows - 在PE的导入表中添加一个条目

> ID：13688471
> 
> 赞同：2
> 
> 时间：2012-12-03T17:23:03.847
> 
> 标签：windows, dll, automation, portable-executable

我正在寻找一个命令行程序来向 PE 文件的导入表中添加一个条目。我的目标是将来自外部 DLL 的新导入函数添加到我的 EXE 中，然后使用 ollydbg 使用代码洞穴插入新代码。新代码将使用新导入的函数。

Acctualy 我已经实现了我的目标，但是为了向导入表中添加一个新条目，我使用[了 Stud_PE](http://www.cgsoftlabs.ro/studpe.html)，它是一个 GUI 应用程序，我想自动化这部分过程。

我会考虑以编程方式解决方案，但我担心 PE 结构太复杂，我无法在我拥有的时间范围内学习和探索。此外，如果一个实现已经存在，不使用它将是一种耻辱。:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T19:47:42.540

找到了正在寻找的东西。

**c++**的 m-PEFile ：http:** [//forum.exetools.com/showpost.php? s=17e7516356489bb9dd17e294e147ef96&p=60183&postcount=3](http://forum.exetools.com/showpost.php?s=17e7516356489bb9dd17e294e147ef96&p=60183&postcount=3)**

 **还可以查看 python 的**pefile**：[http ://code.google.com/p/pefile/](http://code.google.com/p/pefile/)

以及用于 Java 的**PE/COFF 4J ：http:** [//pecoff4j.sourceforge.net/](http://pecoff4j.sourceforge.net/)

在我看来，PE/COFF 4J 的功能有限，但也许你会发现它很有帮助。

代码：`PEFile.h`

```
/*******************************************************************************
********************************   Team AT4RE   ********************************
********************************************************************************
*******************  PLEASE DON'T CHANGE/REMOVE THIS HEADER  *******************
********************************************************************************
**                                                                            **
**  Title:      PEFile class.                                                 **
**  Desc:       A handy class to manipulate pe files.                         **
**  Author:     MohammadHi [ in4matics at hotmail dot com ]                   **
**  WwW:        AT4RE      [ http://www.at4re.com ]                           **
**  Date:       2008-01-28                                                    **
**                                                                            **
********************************************************************************
*******************************************************************************/

/*
[  PE File Format   ]
---------------------
|    DOS Header     |
---------------------
|     DOS Stub      |
---------------------
|     PE Header     |
---------------------
|   Section Table   |
---------------------
|      Padding      |
---------------------
|     Section 1     |
---------------------
|     Section 2     |
---------------------
|        ...        |
---------------------
|     Section n     |
---------------------*/

//==============================================================================
#pragma once
#pragma pack(1)
//==============================================================================
#include <windows.h>
//==============================================================================
#define MAX_SECTION_COUNT       64
#define SECTION_IMPORT          "@.import"
#define SECTION_RESERV          "@.reserv"
//==============================================================================
struct PE_DOS_HEADER {
    WORD   Signature;
    WORD   LastPageBytes;
    WORD   NumberOfPages;
    WORD   Relocations;
    WORD   HeaderSize;
    WORD   MinMemory;
    WORD   MaxMemory;
    WORD   InitialSS;
    WORD   InitialSP;
    WORD   Checksum;
    WORD   InitialIP;
    WORD   InitialCS;
    WORD   RelocTableOffset;
    WORD   Overlay;
    WORD   Reserved1[4];
    WORD   OemId;
    WORD   OemInfo;
    WORD   Reserved2[10];
    LONG   PEHeaderOffset;
};
struct PE_DOS_STUB {
    char*   RawData;
    DWORD   Size;
};
struct PE_SECTION_DATA {
    DWORD   Offset;
    char*   RawData;
    DWORD   Size;
};
struct PE_IMPORT_FUNCTION {
    char*               FunctionName;
    int                 FunctionId;
    PE_IMPORT_FUNCTION* Next;
};
struct PE_IMPORT_DLL {
    char*               DllName;
    PE_IMPORT_FUNCTION* Functions;
    PE_IMPORT_DLL*  Next;
};
//==============================================================================
typedef IMAGE_NT_HEADERS PE_NT_HEADERS;
typedef IMAGE_SECTION_HEADER PE_SECTION_HEADER;
//==============================================================================
class PEFile {
public:
    PE_DOS_HEADER       dosHeader;
    PE_DOS_STUB         dosStub;
    PE_NT_HEADERS       peHeaders;
    PE_SECTION_HEADER   sectionTable[MAX_SECTION_COUNT];
    PE_SECTION_DATA     reservedData;
    PE_SECTION_DATA     sections[MAX_SECTION_COUNT];
    PE_IMPORT_DLL       importTable;
    PE_IMPORT_DLL       newImports;

    PEFile();
    PEFile(char* filePath);
    ~PEFile();
    bool                loadFromFile(char* filePath);
    bool                loadFromMemory(char* memoryAddress);
    bool                saveToFile(char* filePath);
    int                 addSection(char* name, DWORD size, bool isExecutable);
    void                addImport(char* dllName, char** functions, int functionCount);
    void                commit();

private:
    char*               peMemory;

    void                init();
    bool                readFileData(char* filePath);
    bool                checkValidity();
    bool                readHeaders();
    bool                readBody();
    bool                readImportTable();
    bool                writePadding(HANDLE fileHandle, long paddingSize);
    void                unloadFile();

    void                buildImportTable();
    char*               buildNewImports(DWORD baseRVA);
    DWORD               calcNewImportsSize(DWORD &sizeDlls, DWORD &sizeFunctions, DWORD &sizeStrings);

    DWORD               alignNumber(DWORD number, DWORD alignment);
    DWORD               rvaToOffset(DWORD rva);
    DWORD               offsetToRVA(DWORD offset);

    void                fixReservedData();
    void                fixHeaders();
    void                fixSectionTable();

};
//============================================================================== 
```

代码：`PEFile.cpp`

```
/*******************************************************************************
********************************   Team AT4RE   ********************************
********************************************************************************
*******************  PLEASE DON'T CHANGE/REMOVE THIS HEADER  *******************
********************************************************************************
**                                                                            **
**  Title:      PEFile class.                                                 **
**  Desc:       A handy class to manipulate pe files.                         **
**  Author:     MohammadHi [ in4matics at hotmail dot com ]                   **
**  WwW:        AT4RE      [ http://www.at4re.com ]                           **
**  Date:       2008-01-28                                                    **
**                                                                            **
********************************************************************************
*******************************************************************************/

#include "PEFile.h"
#include <math.h>
//==============================================================================
#define DEBUG_ENABLED true;
#ifdef DEBUG_ENABLED
    #define echo(x)         MessageBox(0, x, "DEBUG", MB_ICONERROR);
    #define echo2(x, y)     { char v[256]; strcpy_s(v, 256, x); strcat_s(v, 256, y); echo(v); }
    #define echo3(x, y, z)  { char w[256]; strcpy_s(w, 256, x); strcat_s(w, 256, y); echo2(w, z); }
#else
    #define echo(x) ;
    #define echo2(x, y) ;
    #define echo3(x, y, z) ;
#endif
//==============================================================================
PEFile::PEFile() {
    init();
}
//==============================================================================
PEFile::PEFile(char* filePath) {
    init();
    loadFromFile(filePath);
}
//==============================================================================
PEFile::~PEFile() {
    unloadFile();
}
//==============================================================================
void PEFile::init() {
    peMemory = NULL;
    ZeroMemory(&newImports, sizeof(PE_IMPORT_DLL));
}
//==============================================================================
bool PEFile::readFileData(char* filePath) {
    // open the file for read
    HANDLE fileHandle = CreateFile(filePath, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    if (fileHandle == INVALID_HANDLE_VALUE) {
        echo3("Couldn't open file : [", filePath, "]");
        return false;
    }

    // get the file size
    DWORD fileSize = GetFileSize(fileHandle, 0);
    if (fileSize == 0) {
        CloseHandle(fileHandle);
        echo3("File size is ZeR0! : [", filePath, "]");
        return false;
    }

    // allocate memory to read the pe file (note that we used VirtualAlloc not GlobalAlloc!)
    peMemory = (char*)VirtualAlloc(NULL, fileSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    if (peMemory == NULL) {
        CloseHandle(fileHandle);
        echo("Couldn't allocate memory!");
        return false;
    }

    DWORD bytesRead;
    // read whole file data
    if (!ReadFile(fileHandle, peMemory, fileSize, &bytesRead, NULL) || bytesRead != fileSize) {
        CloseHandle(fileHandle);
        echo3("Couldn't read file! : [", filePath, "]");
        return false;
    }

    // close the file
    CloseHandle(fileHandle);

    return true;
}
//==============================================================================
bool PEFile::checkValidity() {
    // 'dosHeader.Signature' must be "MZ" && 'peHeaders.Signature' must be "PE\0\0"
    if (dosHeader.Signature != IMAGE_DOS_SIGNATURE || peHeaders.Signature != IMAGE_NT_SIGNATURE) {
        unloadFile();
        echo("Invalid PE file!");
        return false;
    }

    if (peHeaders.FileHeader.NumberOfSections > MAX_SECTION_COUNT) {
        unloadFile();
        echo("Number of sections > MAX_SECTION_COUNT !");
        return false;
    }

    return true;
}
//==============================================================================
bool PEFile::readHeaders() {
    // read dos/pe headers
    CopyMemory(&dosHeader, peMemory, sizeof(PE_DOS_HEADER));
    dosStub.RawData = peMemory + sizeof(PE_DOS_HEADER);
    dosStub.Size = dosHeader.PEHeaderOffset - sizeof(PE_DOS_HEADER);
    CopyMemory(&peHeaders, peMemory + dosHeader.PEHeaderOffset, sizeof(PE_NT_HEADERS));

    // check validity of the file to ensure that we loaded a "PE File" not another thing!
    if (!checkValidity()) {
        return false;
    }

    // read section table
    ZeroMemory(sectionTable, sizeof(sectionTable));
    CopyMemory(sectionTable, peMemory + dosHeader.PEHeaderOffset + sizeof(PE_NT_HEADERS), 
        peHeaders.FileHeader.NumberOfSections * sizeof(PE_SECTION_HEADER));

    return true;
}
//==============================================================================
bool PEFile::readBody() {
    // read reserved data
    DWORD reservedDataOffset = dosHeader.PEHeaderOffset + sizeof(PE_NT_HEADERS) + 
        peHeaders.FileHeader.NumberOfSections * sizeof(PE_SECTION_HEADER);

    reservedData.Offset = reservedDataOffset;
    reservedData.RawData = peMemory + reservedDataOffset;
    /*reservedData.Size = peHeaders.OptionalHeader.SizeOfHeaders - reservedDataOffset;*/
    if (sectionTable[0].PointerToRawData > 0) {
        reservedData.Size = sectionTable[0].PointerToRawData - reservedDataOffset;
    } else {
        reservedData.Size = sectionTable[0].VirtualAddress - reservedDataOffset;
    }

    // read sections
    for (int i = 0; i < peHeaders.FileHeader.NumberOfSections; i++) {
        sections[i].Offset = sectionTable[i].PointerToRawData;
        sections[i].RawData = peMemory + sectionTable[i].PointerToRawData;
        sections[i].Size = sectionTable[i].SizeOfRawData;
    }

    return true;
}
//==============================================================================
bool PEFile::readImportTable() {
    DWORD tableRVA = peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress;
    DWORD tableOffset = rvaToOffset(tableRVA);
    if (tableOffset == 0) {
        return false;
    }

    ZeroMemory(&importTable, sizeof(PE_IMPORT_DLL));

    IMAGE_IMPORT_DESCRIPTOR* importDesc = (IMAGE_IMPORT_DESCRIPTOR*)(peMemory + tableOffset);
    IMAGE_THUNK_DATA* importThunk;
    PE_IMPORT_DLL* importDll = &this->importTable;
    PE_IMPORT_FUNCTION* importFunction;

    while (true) {
        importDll->DllName = (char*)(peMemory + rvaToOffset(importDesc->Name));
        if (importDesc->OriginalFirstThunk > 0) {
            importThunk = (IMAGE_THUNK_DATA*)(peMemory + rvaToOffset(importDesc->OriginalFirstThunk));
        } else {
            importThunk = (IMAGE_THUNK_DATA*)(peMemory + rvaToOffset(importDesc->FirstThunk));
        }

        importDll->Functions = new PE_IMPORT_FUNCTION();
        ZeroMemory(importDll->Functions, sizeof(PE_IMPORT_FUNCTION));
        importFunction = importDll->Functions;
        while (true) {
            if ((importThunk->u1.Ordinal & IMAGE_ORDINAL_FLAG32) == IMAGE_ORDINAL_FLAG32) {
                importFunction->FunctionId = IMAGE_ORDINAL32(importThunk->u1.Ordinal);
            } else {
                DWORD nameOffset = rvaToOffset(importThunk->u1.AddressOfData);
                importFunction->FunctionName = (char*)(peMemory + nameOffset + 2);
            }

            importThunk = (IMAGE_THUNK_DATA*)((char*)importThunk + sizeof(IMAGE_THUNK_DATA));
            if (importThunk->u1.AddressOfData == 0) {
                break;
            }
            importFunction->Next = new PE_IMPORT_FUNCTION();
            ZeroMemory(importFunction->Next, sizeof(PE_IMPORT_FUNCTION));
            importFunction = importFunction->Next;
        }

        importDesc = (IMAGE_IMPORT_DESCRIPTOR*)((char*)importDesc + sizeof(IMAGE_IMPORT_DESCRIPTOR));
        if (importDesc->Name == 0) {
            break;
        }
        importDll->Next = new PE_IMPORT_DLL();
        ZeroMemory(importDll->Next, sizeof(PE_IMPORT_DLL));
        importDll = importDll->Next;
    }

    return true;
}
//==============================================================================
bool PEFile::loadFromFile(char* filePath) {
    unloadFile();

    return readFileData(filePath) &&
           readHeaders() &&
           readBody() &&
           readImportTable();
}
//==============================================================================
bool PEFile::loadFromMemory(char* memoryAddress) {
    unloadFile();

    peMemory = memoryAddress;

    return readHeaders()/* &&
           readBody() &&
           readImportTable()*/;
}
//==============================================================================
bool PEFile::saveToFile(char* filePath) {
    commit();
    buildImportTable();

    // create the output file
    HANDLE fileHandle = CreateFile(filePath, GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
    if (fileHandle == INVALID_HANDLE_VALUE) {
        echo("Couldn't create file");
        return false;
    }

    DWORD bytesWritten;

    WriteFile(fileHandle, &dosHeader, sizeof(PE_DOS_HEADER), &bytesWritten, NULL);
    WriteFile(fileHandle, dosStub.RawData, dosStub.Size, &bytesWritten, NULL);
    writePadding(fileHandle, dosHeader.PEHeaderOffset - sizeof(PE_DOS_HEADER) - dosStub.Size);
    WriteFile(fileHandle, &peHeaders, sizeof(PE_NT_HEADERS), &bytesWritten, NULL);
    WriteFile(fileHandle, &sectionTable, peHeaders.FileHeader.NumberOfSections * sizeof(PE_SECTION_HEADER), &bytesWritten, NULL);
    WriteFile(fileHandle, reservedData.RawData, reservedData.Size, &bytesWritten, NULL);

    for (int i = 0; i < peHeaders.FileHeader.NumberOfSections; i++) {
        writePadding(fileHandle, sectionTable[i].PointerToRawData - GetFileSize(fileHandle, NULL));
        WriteFile(fileHandle, sections[i].RawData, sections[i].Size, &bytesWritten, NULL);
    }

    CloseHandle(fileHandle);

    return true;
}
//==============================================================================
bool PEFile::writePadding(HANDLE fileHandle, long paddingSize) {
    if (paddingSize <= 0)
        return false;

    DWORD bytesWritten;
    char* padding = new char[paddingSize];
    memset(padding, 0, paddingSize);
    WriteFile(fileHandle, padding, paddingSize, &bytesWritten, NULL);
    delete padding;

    return (bytesWritten == paddingSize);
}
//==============================================================================
void PEFile::unloadFile() {
    if (peMemory != NULL) {
        VirtualFree(peMemory, 0, MEM_RELEASE);
        peMemory = NULL;
    }
}
//==============================================================================
void PEFile::buildImportTable() {
    DWORD sizeDlls = 0;
    DWORD sizeFunctions = 0;
    DWORD sizeStrings = 0;
    DWORD newImportsSize = calcNewImportsSize(sizeDlls, sizeFunctions, sizeStrings);

    // we'll move the old dll list to the new import table, so we'll calc its size
    DWORD oldImportDllsSize = 0;
    PE_IMPORT_DLL* importDll = &this->importTable;
    while (importDll != NULL) {
        oldImportDllsSize += sizeof(IMAGE_IMPORT_DESCRIPTOR);
        importDll = importDll->Next;
    }

    // add a new section to handle the new import table
    int index = addSection(SECTION_IMPORT, oldImportDllsSize + newImportsSize, false);

    // copy old import dll list
    DWORD oldImportTableRVA = peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress;
    DWORD oldImportTableOffset = rvaToOffset(oldImportTableRVA);
    CopyMemory(sections[index].RawData, peMemory + oldImportTableOffset, oldImportDllsSize);

    // copy new imports
    char* newImportsData = buildNewImports(sectionTable[index].VirtualAddress + oldImportDllsSize);
    CopyMemory(sections[index].RawData + oldImportDllsSize, newImportsData, newImportsSize);

    peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress = sectionTable[index].VirtualAddress;
    peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].Size = sectionTable[index].SizeOfRawData;
    peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IAT].VirtualAddress = 0;
    peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IAT].Size = 0;
}
//==============================================================================
char* PEFile::buildNewImports(DWORD baseRVA) {
    commit();

    IMAGE_IMPORT_DESCRIPTOR importDesc;
    IMAGE_THUNK_DATA importThunk;
    PE_IMPORT_DLL* importDll;
    PE_IMPORT_FUNCTION* importFunction;

    DWORD sizeDlls = 0;
    DWORD sizeFunctions = 0;
    DWORD sizeStrings = 0;
    DWORD newImportsSize = calcNewImportsSize(sizeDlls, sizeFunctions, sizeStrings);
    DWORD offsetDlls = 0;
    DWORD offsetFunctions = sizeDlls;
    DWORD offsetStrings = sizeDlls + 2 * sizeFunctions;

    char* buffer = new char[newImportsSize];
    ZeroMemory(buffer, newImportsSize);

    importDll = &newImports;
    while (importDll != NULL) {
        ZeroMemory(&importDesc, sizeof(IMAGE_IMPORT_DESCRIPTOR));
        importDesc.OriginalFirstThunk = baseRVA + offsetFunctions;
        importDesc.FirstThunk = baseRVA + offsetFunctions + sizeFunctions;
        importDesc.Name = baseRVA + offsetStrings;
        CopyMemory(buffer + offsetStrings, importDll->DllName, strlen(importDll->DllName));     
        offsetStrings += alignNumber((DWORD)strlen(importDll->DllName) + 1, 2);

        CopyMemory(buffer + offsetDlls, &importDesc, sizeof(IMAGE_IMPORT_DESCRIPTOR));
        offsetDlls += sizeof(IMAGE_IMPORT_DESCRIPTOR);

        importFunction = importDll->Functions;
        while (importFunction != NULL) {
            ZeroMemory(&importThunk, sizeof(IMAGE_THUNK_DATA));
            if (importFunction->FunctionId != 0) {
                importThunk.u1.Ordinal = importFunction->FunctionId | IMAGE_ORDINAL_FLAG32;
            } else {
                importThunk.u1.AddressOfData = baseRVA + offsetStrings;
                CopyMemory(buffer + offsetStrings + 2, importFunction->FunctionName, strlen(importFunction->FunctionName));     
                offsetStrings += 2 + alignNumber((DWORD)strlen(importFunction->FunctionName) + 1, 2);
            }

            CopyMemory(buffer + offsetFunctions, &importThunk, sizeof(IMAGE_THUNK_DATA));
            CopyMemory(buffer + offsetFunctions + sizeFunctions, &importThunk, sizeof(IMAGE_THUNK_DATA));
            offsetFunctions += sizeof(IMAGE_THUNK_DATA);

            importFunction = importFunction->Next;
        }
        offsetFunctions += sizeof(IMAGE_THUNK_DATA);

        importDll = importDll->Next;
    }

    return buffer;
}
//==============================================================================
DWORD PEFile::calcNewImportsSize(DWORD &sizeDlls, DWORD &sizeFunctions, DWORD &sizeStrings) {
    PE_IMPORT_DLL* importDll = &this->newImports;
    PE_IMPORT_FUNCTION* importFunction;

    // calc added imports size
    while (importDll != NULL) {
        sizeDlls += sizeof(IMAGE_IMPORT_DESCRIPTOR);
        sizeStrings += alignNumber((DWORD)strlen(importDll->DllName) + 1, 2);
        importFunction = importDll->Functions;
        while (importFunction != NULL) {
            sizeFunctions += sizeof(IMAGE_THUNK_DATA);
            if (importFunction->FunctionId == 0) {
                sizeStrings += 2 + alignNumber((DWORD)strlen(importFunction->FunctionName) + 1, 2);
            }
            importFunction = importFunction->Next;
        }
        sizeFunctions += sizeof(IMAGE_THUNK_DATA); // for the terminator thunk data
        importDll = importDll->Next;
    }
    sizeDlls += sizeof(IMAGE_IMPORT_DESCRIPTOR); // for the terminator import descriptor

    return sizeDlls + 2 * sizeFunctions + sizeStrings;
}
//==============================================================================
int PEFile::addSection(char* name, DWORD size, bool isExecutable) {
    if (peHeaders.FileHeader.NumberOfSections == MAX_SECTION_COUNT) {
        return -1;
    }

    PE_SECTION_DATA &newSection = sections[peHeaders.FileHeader.NumberOfSections];
    PE_SECTION_HEADER &newSectionHeader = sectionTable[peHeaders.FileHeader.NumberOfSections];
    PE_SECTION_HEADER &lastSectionHeader = sectionTable[peHeaders.FileHeader.NumberOfSections - 1];

    DWORD sectionSize = alignNumber(size, peHeaders.OptionalHeader.FileAlignment);
    DWORD virtualSize = alignNumber(sectionSize, peHeaders.OptionalHeader.SectionAlignment);

    DWORD sectionOffset = alignNumber(lastSectionHeader.PointerToRawData + lastSectionHeader.SizeOfRawData, peHeaders.OptionalHeader.FileAlignment);
    DWORD virtualOffset = alignNumber(lastSectionHeader.VirtualAddress + lastSectionHeader.Misc.VirtualSize, peHeaders.OptionalHeader.SectionAlignment);

    ZeroMemory(&newSectionHeader, sizeof(IMAGE_SECTION_HEADER));
    CopyMemory(newSectionHeader.Name, name, (strlen(name) > 8 ? 8 : strlen(name)));

    newSectionHeader.PointerToRawData = sectionOffset;
    newSectionHeader.VirtualAddress = virtualOffset;
    newSectionHeader.SizeOfRawData = sectionSize;
    newSectionHeader.Misc.VirtualSize = virtualSize;
    newSectionHeader.Characteristics = //0xC0000040; 
        IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_CNT_INITIALIZED_DATA;

    if (isExecutable) {
        newSectionHeader.Characteristics |= IMAGE_SCN_CNT_CODE | IMAGE_SCN_MEM_EXECUTE;
    }

    newSection.RawData = (char*)GlobalAlloc(GMEM_FIXED | GMEM_ZEROINIT, sectionSize);
    newSection.Size = sectionSize;

    peHeaders.FileHeader.NumberOfSections++;
    if (reservedData.Size > 0) {
        reservedData.Size -= sizeof(IMAGE_SECTION_HEADER);
    }

    // return new section index
    return peHeaders.FileHeader.NumberOfSections - 1;
}
//==============================================================================
void PEFile::addImport(char* dllName, char** functions, int functionCount) {
    PE_IMPORT_DLL* importDll = &this->newImports;
    PE_IMPORT_FUNCTION* importFunction;

    if (newImports.DllName != NULL) {
        while (importDll->Next != NULL) {
            importDll = importDll->Next;
        }
        importDll->Next = new PE_IMPORT_DLL();
        importDll = importDll->Next;
    }
    importDll->DllName = dllName;
    importDll->Functions = new PE_IMPORT_FUNCTION();
    importDll->Next = NULL;

    importFunction = importDll->Functions;
    importFunction->FunctionName = functions[0];
    for (int i = 1; i < functionCount; i++) {
        importFunction->Next = new PE_IMPORT_FUNCTION();
        importFunction = importFunction->Next;
        importFunction->FunctionName = functions[i];
    }
    importFunction->Next = NULL;
}
//==============================================================================
DWORD PEFile::alignNumber(DWORD number, DWORD alignment) {
    return (DWORD)(ceil(number / (alignment + 0.0)) * alignment);
}
//==============================================================================
DWORD PEFile::rvaToOffset(DWORD rva) {
    for (int i = 0; i < peHeaders.FileHeader.NumberOfSections; i++) {
        if (rva >= sectionTable[i].VirtualAddress &&
            rva < sectionTable[i].VirtualAddress + sectionTable[i].Misc.VirtualSize) {
            return sectionTable[i].PointerToRawData + (rva - sectionTable[i].VirtualAddress);
        }
    }
    return 0;
}
//==============================================================================
DWORD PEFile::offsetToRVA(DWORD offset) {
    for (int i = 0; i < peHeaders.FileHeader.NumberOfSections; i++) {
        if (offset >= sectionTable[i].PointerToRawData &&
            offset < sectionTable[i].PointerToRawData + sectionTable[i].SizeOfRawData) {
            return sectionTable[i].VirtualAddress + (offset - sectionTable[i].PointerToRawData);
        }
    }
    return 0;
}
//==============================================================================
void PEFile::commit() {
    fixReservedData();
    fixHeaders();
    fixSectionTable();
}
//==============================================================================
void PEFile::fixReservedData() {
    DWORD dirIndex = 0;
    for (dirIndex = 0; dirIndex < peHeaders.OptionalHeader.NumberOfRvaAndSizes; dirIndex++) {
        if (peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress > 0 && 
            peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress >= reservedData.Offset &&
            peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress < reservedData.Size) {
            break;
        }
    }

    if (dirIndex == peHeaders.OptionalHeader.NumberOfRvaAndSizes) {
        return;
    }

    int sectionIndex = addSection(SECTION_RESERV, reservedData.Size, false);
    CopyMemory(sections[sectionIndex].RawData, reservedData.RawData, reservedData.Size);

    for (dirIndex = 0; dirIndex < peHeaders.OptionalHeader.NumberOfRvaAndSizes; dirIndex++) {
        if (peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress > 0 &&
            peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress >= reservedData.Offset &&
            peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress < reservedData.Size) {
            peHeaders.OptionalHeader.DataDirectory[dirIndex].VirtualAddress += 
                sectionTable[sectionIndex].VirtualAddress - reservedData.Offset;
        }
    }

    reservedData.Size = 0;
}
//==============================================================================
void PEFile::fixHeaders() {
    peHeaders.OptionalHeader.SizeOfHeaders = alignNumber(dosHeader.PEHeaderOffset + peHeaders.FileHeader.SizeOfOptionalHeader +
        peHeaders.FileHeader.NumberOfSections * sizeof(PE_SECTION_HEADER), peHeaders.OptionalHeader.FileAlignment);

    DWORD imageSize = peHeaders.OptionalHeader.SizeOfHeaders;
    for (int i = 0; i < peHeaders.FileHeader.NumberOfSections; i++) {
        imageSize += alignNumber(sectionTable[i].Misc.VirtualSize, peHeaders.OptionalHeader.SectionAlignment);
    }
    peHeaders.OptionalHeader.SizeOfImage = alignNumber(imageSize, peHeaders.OptionalHeader.SectionAlignment);

    peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT].VirtualAddress = 0;
    peHeaders.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT].Size = 0;
}
//==============================================================================
void PEFile::fixSectionTable() {
    DWORD offset = peHeaders.OptionalHeader.SizeOfHeaders;
    for (int i = 0; i < peHeaders.FileHeader.NumberOfSections; i++) {
        sectionTable[i].Characteristics |= IMAGE_SCN_MEM_WRITE;
        offset = alignNumber(offset, peHeaders.OptionalHeader.FileAlignment);
        sectionTable[i].PointerToRawData = offset;
        //sectionTable[i].SizeOfRawData = alignNumber(offset + sectionTable[i].Misc.VirtualSize, peHeaders.OptionalHeader.FileAlignment);
        offset += sectionTable[i].SizeOfRawData;
    }
}
//============================================================================== 
```

```
#include "PEFile.h"

int main(int argc, char* argv[]) {
    // Open the input file
    PEFile pe("1.exe");

    // Add "MessageBoxA" & "ShowWindow" functions to the import table
    char* functions[] = { "MessageBoxA", "ShowWindow" };
    pe.addImport("user32.dll", functions, 2);

    // Add a new section named ".at4re" with size "0x1000" byte
    pe.addSection(".at4re", 0x1000, false);

    // Save the modified file
    pe.saveToFile("1+.exe");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-06-05T13:32:59.807

您可以使用[PeNet](https://github.com/secana/PeNet)库添加新的导入，只需一行代码。有关示例，请参见此处：[添加导入](http://secana.github.io/PeNet/articles/imports.html)

```
var peFile = new PeFile("myapp.exe");
peFile.AddImport("gdi32.dll", "StartPage"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T17:26:36.060

我自己也在寻找这样的程序。我也失败了。但这很容易手工完成。如果您需要自动化它，那么您可以制作自己的程序。访问[http://www.unknowncheats.me/forum/](http://www.unknowncheats.me/forum/)或[http://www.rohitab.com](http://www.rohitab.com) 那里的人将能够帮助您编写自己的程序。**

# java - 缓慢的文件上传：我可以即时从多部分 POST 数据中删除文件附件并仅提交表单文本字段吗？

> ID：13688474
> 
> 赞同：1
> 
> 时间：2012-12-03T17:23:14.533
> 
> 标签：java, javascript, servlets, upload, websphere

我有一个常规的 JSP/Servlet/Java Web 应用程序，用于从移动设备上传图片。我正在使用 Apache Commons 库进行上传。应用程序托管在 WebSphere Application Server 7.0 上。

一切正常，如果用户有非常好的/强信号/连接或良好的 WiFi，他可以上传几张总计 8MB 或更多的图像。

当用户位于 3G/4G 信号/连接不佳的位置时，就会出现问题。他收到诸如“非法状态异常”或一些超时错误之类的错误，在某些情况下，移动浏览器只是停留在提交页面上，进度条不再移动。

关于如何“优雅地”处理这个问题的任何建议？就像有没有办法在设定的时间后进行干预并让用户选择提交没有文件附件的表单（即只提交表单文本字段）？也欢迎任何其他建议。

**更新：**下面的 setTimeout 解决方案对我有用。另一个缺失的部分是我必须发出“浏览器停止”命令来停止正在进行的原始提交，然后才能发出重新提交。否则，我的重新提交命令将被浏览器忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:16:00.007

此处的用例很简单 - 如果上传未在 N 分钟内完成，请使用 javascript 删除/清除该字段并重新发送表单。

您不需要在基本实现中控制上传，只需安全地假设如果您设置了超时重新发送，那么如果第一次尝试成功并且页面重新加载，则不会发生这种情况。

jQuery伪代码：

```
setTimeout(function(){
  $imageFieldNode.remove();
  $form.trigger('submit');
},30000);//after 30 seconds 
```

更高级的方法是使用现成的解决方案进行受控上传。他们是这样工作的：

1.  上传开始
2.  Node.js 以 GET 查询间隔提示服务器以获取已接收内容的大小。
3.  每次它获取信息时 - 它都会报告进度。

您可以使用这些库做很多事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:15:45.193

您可以考虑流行的网络邮件客户端中使用的方法（将文件附加到邮件时）：

这些文件是在表单提交之前独立上传的（即之前），使用 javascript。每个文件都存储在一个临时目录中，上传成功后用户可以继续操作。上传状态会显示给用户，如果失败，主要操作（表单填写/提交）不会被中断。

# assembly - 使用方括号解决内存错误汇编

> ID：13688476
> 
> 赞同：1
> 
> 时间：2012-12-03T17:23:19.590
> 
> 标签：assembly, addressing-mode

我在 Assembly 中编写了一个程序，它应该反转一个字符串，比如“我看到的是一只老鼠吗？” 但我似乎无法弄清楚错误的含义：“使用方括号来寻址内存，ADDR 或 OFFSET 来获取地址：- 移动句柄，[dest + ebx]。” 知道这意味着什么吗？谢谢！

```
.Data

hInst   DD      NULL
src     DB      "Was it a rat I saw?         ", 0DH, 0AH
ssize   DD      ($ - src)
dest    DB      "...................         ", 0DH, 0AH
handle  DD      NULL

.Code

start:
    Invoke GetModuleHandle, NULL
    Invoke GetStdHandle, STD_OUTPUT_HANDLE
    Mov [hInst], Eax
    Call Main
    Invoke ExitProcess, Eax

Main:

    Xor Eax, Eax
    Ret

L1:
    Mov Ecx, [ssize]
    Mov Ebx, 0

L2:
    Mov Al, [src + Ebx]
    Mov [dest + Ebx], Al
    Mov handle, [dest + Ebx]
    Invoke WriteConsole, [handle]
    Inc Ebx
    Loop L2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:29:11.923

您不能在一条指令中将数据从一个内存位置移动到另一个内存位置。CPU的地址模式不允许这样做。

而是尝试

```
mov EAX, [dest + EBX]
mov [handle], EAX 
```

# cassandra - Cassandra Pig 示例在启用宽行输入时失败

> ID：13688479
> 
> 赞同：0
> 
> 时间：2012-12-03T17:23:25.807
> 
> 标签：cassandra, apache-pig

使用 Cassandra 1.1.6、Pig 0.10.0 和 Hadoop 1.1.0，我可以成功运行 examples/pig 中 cassandra 提供的 pig_cassandra 示例脚本。

但是当我改变

```
rows = LOAD 'cassandra://PigTest/SomeApp' USING CassandraStorage(); 
```

至：

```
rows = LOAD 'cassandra://PigTest/SomeApp?widerows=true' USING CassandraStorage(); 
```

我收到以下错误：

```
java.lang.IndexOutOfBoundsException: Index: 8, Size: 2
    at java.util.ArrayList.rangeCheck(ArrayList.java:604)
    at java.util.ArrayList.get(ArrayList.java:382)
    at org.apache.pig.data.DefaultTuple.get(DefaultTuple.java:156)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject.processInputBag(POProject.java:579)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject.getNext(POProject.java:248)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.getNext(PhysicalOperator.java:316)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POForEach.processPlan(POForEach.java:332)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POForEach.getNext(POForEach.java:284)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:290)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POForEach.getNext(POForEach.java:233)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:290)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPreCombinerLocalRearrange.getNext(POPreCombinerLocalRearrange.java:126)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:290)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POForEach.getNext(POForEach.java:233)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:290)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLocalRearrange.getNext(POLocalRearrange.java:256)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.runPipeline(PigGenericMapBase.java:271)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.map(PigGenericMapBase.java:266)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.map(PigGenericMapBase.java:64)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:764)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:370)                                                                                                                                                                                                                                                                                                           
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:212) 
```

在本地和 mapreduce 模式下运行时，或者如果我设置 PIG_WIDEROW_INPUT=true，就会发生这种情况。

以下 Pig Latin 脚本将因“widerows=true”参数而失败。

```
rows = LOAD 'cassandra://PigTest/SomeApp?widerows=true' USING CassandraStorage();
cols = FOREACH rows GENERATE flatten(columns.name);
DUMP cols; 
```

我似乎无法超越这一点，在使用宽行输入时不读取 SomeApp 列族中的静态列。其他列族也存在同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T20:39:15.193

我有一个类似的问题。这可能是因为 get_paged_slices 中的错误已在以后的 1.1.x 版本中修复。解决方案是将 Cassandra 升级到~~1.1.8~~ 1.1.9

看：

*   [CASSANDRA-4919](https://issues.apache.org/jira/browse/CASSANDRA-4919)：StorageProxy.getRangeSlice 有时会返回不正确的列数
*   [CASSANDRA-4816](https://issues.apache.org/jira/browse/CASSANDRA-4816)：损坏的 get_paged_slice
*   [CASSANDRA-5098](https://issues.apache.org/jira/browse/CASSANDRA-5098) : CassandraStorage 在widerow 模式下不解码名称

# javascript - Facebook 样式固定页眉

> ID：13688481
> 
> 赞同：1
> 
> 时间：2012-12-03T17:23:38.780
> 
> 标签：javascript, html, ios, css

在我的网站[http://www.merkato.hu](http://www.merkato.hu)上，标题的位置是固定的。在桌面浏览器上，这很好用 - 但在移动设备上，缩放页面会使标题由于固定位置而无法使用。

我尝试了一种方法，使高度和 html 绝对定位到标题和内容，并将溢出设置为滚动 - 但有些脚本需要正文可滚动。

为移动设备完成固定标头的最佳方法是什么？对于 iDevices，我发现的一切似乎都不值得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:34:05.210

这是一个难题。大多数移动设备对定位的支持`fixed`已损坏或缺失。第一个支持今年左右生产的设备的移动浏览器。

我记得[jQuery Mobile](http://jquerymobile.com)团队在很长一段时间内都在为固定页眉和页脚而苦苦挣扎。

他们让它工作了，所以我建议要么使用 jQuery Mobile（或其他一些显然可以做到这一点的框架），要么深入研究他们的 JS 和 CSS 来了解它是如何工作的。

无论如何，如果没有大约 20 种不同的测试设备，您将无法确定它是否有效。因此，除非您有可观的预算，否则您必须坚持使用经过充分测试的开源解决方案。

# javascript - 页面完全加载时的窗口滚动位置

> ID：13688486
> 
> 赞同：2
> 
> 时间：2012-12-03T17:24:09.537
> 
> 标签：javascript, jquery

我想知道页面完全加载时的窗口滚动位置。

当我单击带有 id 的链接时，页面会根据具有此 id 的元素加载。加载页面时，我想知道窗口位置。

**索引.html**

```
<a href="page.html#2012_8">link</a> 
```

**page.html**

```
<script>
$(window).load(function(){
    console.log($(window).scrollTop());
});
</script>

<p id="2012_8">This is some text in a paragraph.</p> 
```

当我点击链接时，控制台日志得到 0。当我刷新 page.html 时，控制台日志得到正确的窗口滚动位置。为什么？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:42:46.800

尝试使用

`console.log($(document).scrollTop());`

我在萤火虫中测试过，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:28:09.983

更改窗口哈希时不会触发“加载”事件。要触发事件，您应该挂钩 hashchange 事件。

```
$(window).on('hashchange',function() {
    console.log($(window).scrollTop());
});

$(document).ready(function() {
    $(window).trigger('hashchange');
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T17:29:21.210

您可以使用

```
$(document).ready(function(){
console.log($(document).prop('scrollHeight'));
}) 
```

或者您可以为此使用 attr

```
$(document).ready(function(){
console.log($(document).attr('scrollHeight'));
}) 
```

# c# - 具有多态性和异常处理的 XML 反序列化

> ID：13688489
> 
> 赞同：5
> 
> 时间：2012-12-03T17:24:17.727
> 
> 标签：c#, xml, deserialization

我正在使用具有以下要求的 Microsoft ASP.NET Web API 创建服务：

1.  输入必须是 XML（无 json）
2.  XML 将遵循标准（不能将自定义元素名称/属性添加到输入 xml）
3.  在反序列化中遇到异常（即数据值格式错误）时，必须将它们记录为警告，并且必须继续解析输入 xml
4.  XML 将包含元素的集合，其中的元素需要反序列化为从基本类型派生的类型

要求 1 和 2 只是定义了我的输入。我开始使用内置`System.Xml.Serialization.XmlSerializer`类来开发我的解决方案，但不得不放弃它，因为它无法处理需求 #3。

或者，我发现[YAXLib](http://www.codeproject.com/Articles/34045/Yet-Another-XML-Serialization-Library-for-the-NET)提供了一种非常[有用的方法](http://www.codeproject.com/Articles/34045/Yet-Another-XML-Serialization-Library-for-the-NET#deser)来处理需求 #3。

YAXLib 也处理需求 #4，但仅通过使用 XML 中的自定义属性：

```
 <ListOfObjects>
    <Object yaxlib:realtype="System.Int32">7</Object>
    <Object yaxlib:realtype="System.Double">3.14</Object>
    <Object yaxlib:realtype="System.String">Congrats</Object>
    <Object yaxlib:realtype="System.StringSplitOptions">RemoveEmptyEntries</Object>
  </ListOfObjects> 
```

由于要求 #2，我不能使用这种方法。我需要类似的东西，`System.Xml.Serialization.XmlElementAttribute`所以我可以在代码中指示序列化程序，而不是在数据中。**是否有现有的解决方案可以处理所有这些要求？**

## 例子：

**输入**

```
<DEALS>
    <DEAL>
        <COLLATERALS>
            <COLLATERAL>xyz</COLLATERAL>
            <COLLATERAL>1.2</COLLATERAL>
            <COLLATERAL>4.5</COLLATERAL>
        </COLLATERALS>
        <LOANS>
            <LOAN>
                <CLOSING_INFORMATION />
            </LOAN>
        </LOANS>
    </DEAL>
</DEALS> 
```

**C# 类**

```
public class DEAL
{
    [System.Xml.Serialization.XmlElementAttribute("COLLATERALS", typeof(COLLATERALS))]
    [System.Xml.Serialization.XmlElementAttribute("LOANS", typeof(LOANS))]
    [YAXCollection(YAXCollectionSerializationTypes.RecursiveWithNoContainingElement)]
    public object[] Items
    {
        get
        {
            return this.itemsField;
        }
        set
        {
            this.itemsField = value;
        }
    }

    // Remaining implementation details omitted..
}

public class COLLATERALS { /* details omitted.. */ }
public class LOANS { /* details omitted.. */ }

public class COLLATERAL
{
    [System.Xml.Serialization.XmlTextAttribute()]
    public decimal Value { get; set; }
} 
```

**预期产出**

类的 Items 集合中的对象`DEALS`应反序列化为它们各自的类型：`COLLATERALS`和`LOANS`. 此外，值为“xyz”的第一个抵押品不会被反序列化（因为类型为`decimal`），但剩余的有效`COLLATERAL`项目将被反序列化。应该以某种方式记录将“xyz”解析为十进制的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T20:09:14.710

您可以使用 XML Schema（一个 XSD 文件）来定义 XML 文件的有效格式是什么。现有的工具可以验证特定文件是否符合模式。

通过公开提供此模式，您将能够允许您的客户验证他们自己的请求，而无需实际与您的 Web 服务交互。这将使他们能够查看他们的输入是否有效，以及他们是否需要对具体需要更改的内容进行复杂的分析以符合他们将能够自己做到这一点。

# jpa - 未注入 OSGI 服务 JPA PersistenceContext

> ID：13688492
> 
> 赞同：3
> 
> 时间：2012-12-03T17:24:24.030
> 
> 标签：jpa, osgi, apache-karaf, blueprint-osgi

我有一个核心库，它有一个接口，我想在 Fuse ESB（Apache ServiceMix 和 Karaf）中将其公开为 OSGI 服务。目标是允许其他捆绑包使用它。该服务使用 JPA (OpenJPA) 和 Spring。下面是界面：

```
public interface PatientService {
    public Patient find(Integer id);
} 
```

和班级：

```
@Repository
public class PatientServiceJpaImpl implements PatientService {
    @PersistenceContext(unitName="psu")
    private EntityManager entityManager;

    @Override
    public Patient find(Integer id) {
        return entityManager.find(Patient.class, id);
    }
} 
```

以下是缩写`META-INF/spring/beans.xml`：

```
<beans xmlns="http://www.springframework.org/schema/beans" ...>
    <context:annotation-config />
    <context:component-scan base-package="..." />

    <bean id="txManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="emf" />
    </bean>

    <bean id="emf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="persistenceUnitName" value="psu" />
        <property name="jpaVendorAdapter" ref="jpaAdapter" />
        <property name="dataSource" ref="dataSource" />
    </bean>

    <bean id="jpaAdapter" class="org.springframework.orm.jpa.vendor.OpenJpaVendorAdapter" />

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${database.driver}" />
        <property name="url" value="${database.url}" />
        <property name="username" value="${database.username}" />
        <property name="password" value="${database.password}" />
    </bean>

    <bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/>
    <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />
</beans> 
```

和`META-INF/persistence.xml`（也缩写）：

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence" ...>
    <persistence-unit name="psu" transaction-type="RESOURCE_LOCAL">
        <class>...</class>
</persistence> 
```

在非 OSGi 环境中，一切正常。它使用 felix maven-bundle-plugin，所以为了创建 OSGi 服务，我添加了以下内容`OSGI-INF/blueprint/osgi-context.xml`：

```
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0
    http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

    <bean id="patientService" class="com.test.service.PatientServiceJpaImpl" />
    <service id="osgiPatientService" ref="patientService" interface="com.test.service.PatientService" />

</blueprint> 
```

捆绑包部署成功并注册了服务。问题是当`PatientService`从另一个包中引用时，实体管理器还没有被注入，因此`NullPointerException`在`find(Integer id)`方法中抛出了一个。以下是消费者的片段`META-INF/spring/consumer-context.xml`：

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:jaxws="http://cxf.apache.org/jaxws"
xmlns:osgi="http://www.springframework.org/schema/osgi"
xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context.xsd
    http://cxf.apache.org/jaxws
    http://cxf.apache.org/schemas/jaxws.xsd
    http://www.springframework.org/schema/osgi
    http://www.springframework.org/schema/osgi/spring-osgi.xsd">

    <bean id="patientServiceImpl" class="com.test.ws.PatientWebServiceImpl" >
        <property name="patientService">
            <osgi:reference interface="com.test.service.PatientService"/>
        </property>
    </bean>

    ...

</beans> 
```

为了清楚起见，`PatientService`被注入到消费者包中，但实体管理器没有被注入到提供者包中。此外，由于在启动原始服务时出现以下日志输出，因此持久性单元似乎不是问题：

```
125  psu  TRACE  [SpringOsgiExtenderThread-14] openjpa.Runtime - org.apache.openjpa.persistence.PersistenceProviderImpl@24a5031d creating container org.apache.openjpa.persistence.EntityManagerFactoryImpl@4d6f77b6 for PU psu. 
```

为了了解发生了什么，我在`PatientServiceJpaImpl`类的构造函数中记录了对象内存引用和堆栈跟踪。构造函数被调用了两次（创建了两个不同的对象）：

1.  第一个输出似乎源自 osgi 容器，从 开始，`org.apache.felix`或多或少以`org.apache.aries.blueprint`.

2.  第二个输出似乎起源于 spring 框架，从 开始，`org.springframework.osgi`或多或少以`org.springframework.beans.BeanUtils`.

当调用消费者服务时，它的引用是对蓝图实例化对象的引用，该对象没有注入的实体管理器。同样从日志中，持久化单元在对象的蓝图实例化之后被实例化`PatientServiceJpaImpl`。

我已经搜索并修补了这个问题很长一段时间，但我已经没有想法了。具有讽刺意味的是，它实际上在某一时刻有效，但我做了很多改变才能让它发挥作用，以至于它是一个我无法成功退出的老鼠窝。

为什么蓝图托管对象中没有注入持久化上下文？任何想法将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T22:18:51.117

我不确定这是否可行，因为您正在将弹簧与蓝图混合在一起。我有一个仅基于蓝图的工作应用程序，我很高兴。对于您的用例，我建议至少为您的 JPA 部分使用蓝图。您仍然可以使用 spring-dm 将 jpa 类用作服务。

```
<blueprint default-activation="eager"
xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:jpa="http://aries.apache.org/xmlns/jpa/v1.0.0" xmlns:tx="http://aries.apache.org/xmlns/transactions/v1.0.0">

<bean id="patientService" class="com.test.service.PatientServiceJpaImpl" >
    <jpa:context property="em" unitname="dn1" />
<tx:transaction method="*" value="Required" />
</bean>
<service id="osgiPatientService" ref="patientService" interface="com.test.service.PatientService" />
</blueprint> 
```

您的`PatientServiceJPAImpl`I 将更改为不包含任何注释。

```
public class PatientServiceJpaImpl implements PatientService {
    protected EntityManager em;

    @Override
    public Patient find(Integer id) {
        return em.find(Patient.class, id);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-20T04:42:01.133

处理这个问题的一个好方法是使用[Gemini JPA](http://wiki.eclipse.org/Gemini/JPA/Documentation)。使用 Gemini JPA，您的 JPA 包将根据您的 persistence.xml 中的配置自动公开一个 EntityManagerFactory OSGi 服务。因此，在 JPA 客户端包中，蓝图只需要使用指定持久性单元名称的过滤条件导入此服务。

这是这些行的一个小实现：[mvc-osgi](https://github.com/aritratony/mvc-osgi)

如果 EMF 服务不适合您，您可以使用 Gemini JPA 包公开的 EntityManagerFactoryBuilder 服务来手动创建 EMF。这将需要调用“createEntityManagerFactory”。

# opengl - 如何在OpenGL中确定一个全窗口矩形

> ID：13688493
> 
> 赞同：1
> 
> 时间：2012-12-03T17:24:27.150
> 
> 标签：opengl

那是问题：我目前在 OpenGL 眼睛空间中，现在我想制作一个黑色矩形来覆盖所有窗口区域。我怎样才能确定一个确切的 X、Y、Z 位置来做到这一点？

**更新** 或者有人可以告诉我当我们有 Z 值时如何确定窗口的 X、Y（左上角）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:03:36.437

您可以尝试计算一个完全适合相机的矩形，然后从那里开始。为此，您需要考虑投影矩阵并计算逆矩阵。

但是，有一个更简单的方法。您所要做的就是临时更改相机，以便您确切知道如何绘制矩形。一个足够简单的相机是默认的正交相机，具有简单的限制（从 -1 到 1）。以下是这样做的：

```
glMatrixMode(GL_PROJECTION);
glPushMatrix();
glLoadIdentity();

glMatrixMode(GL_MODELVIEW);
glPushMatrix();
glLoadIdendity();

glBegin(GL_QUAD);
glVertex2f(-1.f, -1.f);
glVertex2f(1.f, -1.f);
glVertex2f(1.f, 1.f);
glVertex2f(-1.f, 1.f);
glEnd();

glPopMatrix();
glMatrixMode(GL_PROJECTION);
glPopMatrix();
glMatrixMode(GL_MODELVIEW); 
```

# java - 找不到 glassfish 的 javadb 客户端 jar 文件

> ID：13688494
> 
> 赞同：1
> 
> 时间：2012-12-03T17:24:31.120
> 
> 标签：java, glassfish, ejb

我编写了一个简单的 EJB 应用程序，并打算通过一个 java 应用程序客户端对其进行测试。为此，我正在如下获取 bean，

```
Properties props = new Properties();
props.put(Context.INITIAL_CONTEXT_FACTORY,
        "com.sun.enterprise.naming.SerialInitContextFactory");
props.setProperty("org.omg.CORBA.ORBInitialHost", "localhost");
// glassfish default port value will be 3700,
props.setProperty("org.omg.CORBA.ORBInitialPort", "3700");
initialContext = new InitialContext(props);
helloWorld = (HelloWorldBean) initialContext
    .lookup("HelloWorldBean/remote"); 
```

但是我遇到了异常，然后是许多其他空指针，

> 2012 年 12 月 3 日 22:37:37 com.sun.enterprise.v3.server.CommonClassLoaderServiceImpl findDerbyClient 信息：找不到 javadb 客户端 jar 文件，默认情况下，derby jdbc 驱动程序不可用。java.lang.RuntimeException：Orb 初始化错误在 org.glassfish.enterprise.iiop.api.GlassFishORBHelper.getORB（GlassFishORBHelper.java:148）

我什至将这个 jar 添加到构建路径中，但仍然发生异常。即使我可以在 glassfish\javadb\lib 下找到 derbyclient jar

我还需要验证我是否正确运行此客户端？

它只是在部署应用程序后，右键单击客户端类并作为 java 应用程序运行，对吗？

# sql - 内部连接一个表

> ID：13688497
> 
> 赞同：5
> 
> 时间：2012-12-03T17:24:36.453
> 
> 标签：sql, sql-server, sql-server-2008

我有一个使用两个标识列的表，我们称它们为 id 和 userid。ID 在每条记录中都是唯一的，而 userid 对用户来说是唯一的，但在许多记录中都是唯一的。

我需要做的是通过用户 ID 获取用户的记录，然后将该记录加入我们为用户拥有的第一条记录。查询逻辑如下：

```
SELECT v1.id, MIN(v2.id) AS entryid, v1.userid
FROM views v1
INNER JOIN views v2
  ON v1.userid = v2.userid 
```

我希望我不必将表加入处理 min() 代码片段的子查询，因为这似乎很慢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-03T17:39:08.100

我猜（尚不完全清楚）您想为每个用户找到具有 minimum 的表的行`id`，因此每个用户一行。

在这种情况下，您可以使用子查询（派生表）并将其连接到表中：

```
SELECT v.*
FROM views AS v
  JOIN
    ( SELECT userid, MIN(id) AS entryid
      FROM views
      GROUP BY userid
    ) AS vm
    ON  vm.userid = v.userid 
    AND vm.entryid = v.id ; 
```

如果您喜欢，也可以使用**[Common Table Expression (CTE)编写上述内容：](http://msdn.microsoft.com/en-us/library/ms190766(v=sql.100).aspx)**

```
; WITH vm AS
    ( SELECT userid, MIN(id) AS entryid
      FROM views
      GROUP BY userid
    )
  SELECT v.*
  FROM views AS v
    JOIN vm
      ON  vm.userid = v.userid 
      AND vm.entryid = v.id ; 
```

两者都将在索引上非常有效`(userid, id)`。

使用 SQL-Server，您可以使用**[`ROW_NUMBER()`](http://msdn.microsoft.com/en-us/library/ms186734(v=sql.100).aspx)**窗口函数编写此代码：

```
; WITH viewsRN AS
    ( SELECT *
           , ROW_NUMBER() OVER (PARTITION BY userid ORDER BY id) AS rn
      FROM views
    ) 
  SELECT *                      --- skipping the "rn" column
  FROM viewsRN
  WHERE rn = 1 ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:32:22.200

好吧，要将`MIN`函数与非聚合列一起使用，您必须对语句进行分组。这可以通过您的查询来实现......（根据附加信息进行编辑）

```
SELECT MIN(v2.id) AS entryid, v1.id, v1.userid
FROM views v1
INNER JOIN views v2
  ON v1.userid = v2.userid      
GROUP BY v1.id, v1.userid 
```

...但是，如果这只是一个简单的示例，并且您希望通过此查询提取更多数据，那么它很快就会成为一个不可行的解决方案。

您似乎想要的是此视图中所有用户数据的列表，每行上都有一个链接，指向同一用户存在的“第一条”记录。上面的查询会得到你想要的，但是有更简单的方法来确定每个用户的第一条记录：

```
SELECT v1.id, v1.userid
FROM views v1
ORDER BY v1.userid, v1.id 
```

每个唯一用户的第一条记录是您的“入口点”。我想我理解您为什么要按照您指定的方式进行操作，并且我给出的第一个查询将具有合理的性能，但是您必须考虑不必使用 order by 子句来获得正确答案是否值得.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-03T17:39:37.140

**edit-1：**正如评论中所指出的，该解决方案还使用子查询。但是，它不使用聚合函数，这（取决于数据库）可能会对性能产生巨大影响。

* * *

无需子查询即可实现（见下文）。显然，一个索引对`views.userid`性能具有巨大的价值。

```
SELECT      v1.*
FROM        views v1
WHERE       v1.id = (
        SELECT  TOP 1 v2.id
        FROM    views v2
        WHERE   v2.userid = v1.userid
        ORDER BY v2.id ASC
    ) 
```

# php - 仅在使用 javascript 刷新时更改背景

> ID：13688499
> 
> 赞同：0
> 
> 时间：2012-12-03T17:24:38.787
> 
> 标签：php, javascript, refresh, background-image

我正在使用 PHP 动态加载页面，如下所示：

```
<div id="content">
<div id="fadein">   

<?php
    /// load page content
    $pages_dir = 'content';

    if(!empty($_GET['p'])) {

        $pages = scandir($pages_dir, 0);
        //delete . and ..
        unset($pages[0], $pages[1]);

        $p = $_GET['p'];

        // only files that are in the array can be loaded
        if (in_array($p. '.php', $pages)) {
            include($pages_dir. '/'.$p. '.php');    

        } else {
            echo 'Helaas deze pagina bestaat niet';
        }
    } else {
        include($pages_dir. '/index.php');
    }

?>  

</div>
</div> 
```

如果您使用我网站顶部的导航，PHP 会加载相关内容。

我在页面底部得到了这个脚本来更改背景图像：

```
 function preload(arrayOfImages) {
    $(arrayOfImages).each(function(){
        $('<img/>')[0].src = this;
        // Alternatively you could use:
        // (new Image()).src = this;
    });
}

// Usage:
preload([
    '../public/background/test2/1.jpg',
    '../public/background/test2/2.jpg',
    '../public/background/test2/3.jpg',
    '../public/background/test2/4.jpg',
    '../public/background/test2/5.jpg',
    '../public/background/test2/6.jpg'

]);

var totalCount = 6;
function changeBackground()
{
    var num = Math.ceil( Math.random() * totalCount );
    backgroundUrl = '../public/background/test2/'+num+'.jpg';

    $('body').css('background-image', 'url('  +backgroundUrl+  ')');
}

changeBackground(); 
```

但是每次加载不同的内容时，都会执行脚本......我不希望那样。我只想在用户刷新页面时更改背景。当用户浏览网站时加载不同的内容时不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:42:08.413

就像现在一样（根据您的评论），当您真的只想加载新内容时，您正在重新加载整个页面。

为了能够获得您想要的效果，您应该在点击导航链接时使用 ajax（结合 php 和 javascript）只刷新页面的一部分。

您可以做的是（使用 jQuery 轻松介绍 ajax ...）：

*   将您的 php 脚本与 html 分开，以便您可以单独调用它并将其包含在初始 html 中；
*   将事件处理程序附加到您的导航链接，取消默认操作（*撤消*单击）并使用 jQuery 的[`load`](http://api.jquery.com/load/)方法将您的内容替换为新内容（使用正确的参数调用您的 php 脚本）。

由于 javascript 位于主 html 文件中，它只会在初始页面加载或页面刷新时执行您的后台脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:32:13.840

如果您尝试仅通过 JavaScript 进行管理，那么您可以创建一个包含页面访问数组的 Cookie，然后在页面加载时您可以参考该数组来确定用户是否已经访问过该页面。

# objective-c - IOS Facebook SDK登录后无法获取用户信息

> ID：13688501
> 
> 赞同：5
> 
> 时间：2012-12-03T17:24:40.620
> 
> 标签：objective-c, facebook, facebook-ios-sdk

好吧，我从 Facebook IOS SDK (3.1.1) 获取一些基本的用户信息时遇到了麻烦。在使用其他平台完成 FB 开发后，我非常确信我的问题与 FB 应用程序的设置有关，而不是与我的代码有关。顺便说一句，我在 iTunes 中并为 iPhone 设置了 iTunes ID。我还仔细检查并四次检查了应用程序设置中的捆绑 ID 与我的捆绑 ID。

现在我可以通过测试用户进行身份验证并获取所有详细信息等。它工作得很好。当我以像我这样的真实用户身份登录时（并且我是该项目的开发人员），我得到了一个 Auth 令牌，但是让用户失败的调用失败，我不确定我做错了什么（如果它适用于一个测试用户，它应该适用于所有人）。

我只需要从用户那里得到，顺便说一句，就是他们的名字、姓氏、FB 用户 ID 和电子邮件地址（可选，但需要）。

目前在使用我正在使用[游戏教程](https://developers.facebook.com/docs/tutorials/ios-sdk-games/authenticate/)进行身份验证后。登录后，我将执行以下操作（尽管我已经完成了许多其他具有相同结果的操作）：

```
 - (void)fbDidLogin
 {
    // removed the setup for the class level Facebook var that I am currently not using

    // get information about the currently logged in user

    NSString *fql = @"select uid, first_name, last_name, email  from user where uid = me()";
    NSDictionary *queryParam = [NSDictionary dictionaryWithObjectsAndKeys:fql, @"q", nil];

    [FBRequestConnection startWithGraphPath:@"/fql"
                      parameters:queryParam
                      HTTPMethod: @"GET"
                      completionHandler:^(FBRequestConnection *connection,
                                          id result,
                                          NSError *error) {
                        [self meRequestResult:result WithError:error];
                      }];
 } 
```

meRequestResult 例程开始如下：

```
- (void)meRequestResult:(id)result WithError:(NSError *)error
{
 if ([result isKindOfClass:[NSDictionary class]])
 {
    NSDictionary *dictionary;
    if([result objectForKey:@"data"])
        dictionary = (NSDictionary *)[(NSArray *)[result objectForKey:@"data"] objectAtIndex:0];
    else
        dictionary = (NSDictionary *)result;

    [fbUserData release];
    fbUserData = [dictionary retain];

    NSString *facebookId = [dictionary objectForKey:@"id"];
    if(!facebookId)
        facebookId = [dictionary objectForKey:@"uid"];
 // and more follows that is not pertinent 
```

当我在 FB IOS SDK 中打开请求日志记录时。我看到同样的事情，在任何地方都找不到任何描述这些是什么意思。

这是日志中的最后 10 行左右：

```
 2012-12-03 11:52:12.394 mTender[6572:1cd03] Reachability Flag Status: -R -----l- networkStatusForFlags
 2012-12-03 11:52:12.395 mTender[6572:1cd03] The internet is working via WIFI.
 2012-12-03 11:52:12.396 mTender[6572:1cd03] Reachability Flag Status: -R ------- networkStatusForFlags
 2012-12-03 11:52:12.396 mTender[6572:1cd03] A gateway to the host server is working via WIFI.
 2012-12-03 11:52:35.093 mTender[6572:1cd03] FBSDKLog: Request <#1111>:
      URL:  https://graph.facebook.com//fql?sdk=ios&access_token=ACCESS_TOKEN_REMOVED&q=select%20uid%2C%20first_name%2C%20last_name%2C%20email%20%20from%20user%20where%20uid%20%3D%20me%28%29&migration_bundle=fbsdk%3A20121003&format=json
      Method:   GET
      UserAgent:    FBiOSSDK.3.1.1
      MIME: multipart/form-data; boundary=3i2ndDfv2rTHiSisAbouNdArYfORhtTPEefj3q2f

 2012-12-03 11:52:37.194 mTender[6572:1cd03] Error: HTTP status code: 500
 2012-12-03 11:52:37.196 mTender[6572:1cd03] FBSDKLog: Response <#1111> <Error>:
     The operation couldn’t be completed. (com.facebook.sdk error 5.) 
```

希望有人能解决这个问题。这是这个项目的最后一步..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T13:27:05.453

我认为您必须看到替代方式，因为 REST API 已被弃用。要进行 FQL 查询，您必须使用 Graph API 调用。

```
 http://developers.facebook.com/docs/reference/rest/fql.query/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:26:07.197

我正在做与你非常相似的事情。我正在使用 facebook 登录，这样我就不必担心存储密码等等。

我遵循[了这套](http://developers.facebook.com/docs/howtos/login-with-facebook-using-ios-sdk/)说明。Facebook 网站的布局方式似乎很糟糕，到处都是过时的东西。

您可以使用本机 facebook 或基于 Web 的用户身份验证（SDK 将管理所有这些），因此它可以在旧版本的 iOS 上以及未登录本机 facebook 时使用。

您将设置一个处理程序，该处理程序将为您提供一个“NSDictionary *user”，其中包含您需要的所有内容。无需在 iphone 客户端上使用图形 api。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T16:20:46.373

好的，我要关闭这个了。

我在 2011 年 11 月恢复到 SDK。起初它似乎没有工作，然后它才开始工作。我怀疑 Facebook 端的一个错误导致了这种情况。我还没有更新到最新的尝试，但这是我对发生了什么的唯一猜测。

如果你做过任何冗长的 Facebook 开发，你就会知道有时他们的错误确实让事情变得困难。也就是说，不知道这是否是实际答案，因为我真的没有对原始代码进行任何编码更改。

我知道我故意将捆绑 ID 排除在 FB 应用程序设置之外。

# powerbuilder - 如何在 PowerBuilder 中获取活动工作表菜单？

> ID：13688506
> 
> 赞同：5
> 
> 时间：2012-12-03T17:25:03.397
> 
> 标签：powerbuilder

如何在 PowerBuilder 中获取活动工作表菜单。如果我禁用菜单，它会禁用最后打开的工作表菜单而不是活动工作表菜单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-10-05T15:02:42.780

> Waseem Kiyani 于 2012 年 12 月 4 日在 14:28 回答了这个问题

实际上我没有得到菜单 ID。相反，我直接禁用了菜单

```
m_sheet.file.enabled = false 
```

感谢 Maximus，我使用菜单 ID 禁用了菜单项。

*例子：*

```
m_sheet lm_setupMenu
lm_setupMenu = This.menuID
lm_setupMenu.m_new.enabled = False 
```

# java - 在 Google App Engine 上运行小程序时出现 InvocationTargetException

> ID：13688508
> 
> 赞同：1
> 
> 时间：2012-12-03T17:25:07.120
> 
> 标签：java, security, google-app-engine, japplet, accesscontrolexception

我试图在我的谷歌应用引擎项目上运行一个小程序。我为我的小程序创建了一个项目，它正在工作。然后我从这个项目制作了一个 jar 文件，以便在我的谷歌应用引擎项目中使用这个小程序。我将 jar 文件放入 /war 目录。我尝试运行代码并且它有效。顺便说一句，我在小程序的 jar 文件中使用了其他一些 jar 文件。无论如何，我将它们正确添加到我的项目中。一切都很好，直到这里。我可以在我的项目上显示小程序。后来，我在我的小程序项目（dom4j 解析器）中添加了一个新的 jar 文件，我再次为我的小程序创建了一个 jar 文件。我遵循了同样的指示。现在我得到了这个 InvocationTargetException。我想补充一点，我也在为我的 GAE 项目使用 dom4j 解析器，所以 dom4j 的 jar 文件也在 WEB-INF/lib 中。也许正因为如此，它给出了一个例外，但我

```
 java.lang.reflect.InvocationTargetException
    at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.runOnEDT(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
    Caused by: java.security.AccessControlException: access denied (java.io.FilePermission file.xml read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.dom4j.io.SAXReader.read(SAXReader.java:247)
    at saxParser3.getDrug(saxParser3.java:14)
    at VertexCollapseDemoWithLayouts.<init>(VertexCollapseDemoWithLayouts.java:131)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$400(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
    Exception: java.lang.reflect.InvocationTargetException
java.lang.reflect.InvocationTargetException
    at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.runOnEDT(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
    Caused by: java.security.AccessControlException: access denied (java.io.FilePermission file.xml read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.dom4j.io.SAXReader.read(SAXReader.java:247)
    at saxParser3.getDrug(saxParser3.java:14)
    at VertexCollapseDemoWithLayouts.<init>(VertexCollapseDemoWithLayouts.java:131)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$400(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception: java.lang.reflect.InvocationTargetException
java.lang.reflect.InvocationTargetException
    at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.runOnEDT(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.security.AccessControlException: access denied (java.io.FilePermission file.xml read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.dom4j.io.SAXReader.read(SAXReader.java:247)
    at saxParser3.getDrug(saxParser3.java:14)
    at VertexCollapseDemoWithLayouts.<init>(VertexCollapseDemoWithLayouts.java:131)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$400(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception: java.lang.reflect.InvocationTargetException
java.lang.reflect.InvocationTargetException
    at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.runOnEDT(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.security.AccessControlException: access denied (java.io.FilePermission file.xml read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.dom4j.io.SAXReader.read(SAXReader.java:247)
    at saxParser3.getDrug(saxParser3.java:14)
    at VertexCollapseDemoWithLayouts.<init>(VertexCollapseDemoWithLayouts.java:131)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$400(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception: java.lang.reflect.InvocationTargetException
java.lang.reflect.InvocationTargetException
    at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.runOnEDT(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.security.AccessControlException: access denied (java.io.FilePermission file.xml read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.dom4j.io.SAXReader.read(SAXReader.java:247)
    at saxParser3.getDrug(saxParser3.java:14)
    at VertexCollapseDemoWithLayouts.<init>(VertexCollapseDemoWithLayouts.java:131)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$400(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception: java.lang.reflect.InvocationTargetException
java.lang.reflect.InvocationTargetException
    at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.runOnEDT(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.security.AccessControlException: access denied (java.io.FilePermission file.xml read)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkRead(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at org.dom4j.io.SAXReader.read(SAXReader.java:247)
    at saxParser3.getDrug(saxParser3.java:14)
    at VertexCollapseDemoWithLayouts.<init>(VertexCollapseDemoWithLayouts.java:131)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at java.lang.Class.newInstance0(Unknown Source)
    at java.lang.Class.newInstance(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$12.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$400(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.awt.EventQueue$2.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception: java.lang.reflect.InvocationTargetException 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:33:29.420

您能否指出堆栈跟踪的哪些部分（如果有）对应于您自己的代码？

这是让我印象深刻的部分：

```
Caused by: java.security.AccessControlException: access denied
  (java.io.FilePermission file.xml read)
  at java.security.AccessControlContext.checkPermission(Unknown Source) 
```

您的程序是否有可能正在读取一些配置数据（或其他东西）并且配置文件没有设置读取权限？

# jquery-autocomplete - 如何在 SlickGrid 中失去对单元格的关注

> ID：13688511
> 
> 赞同：1
> 
> 时间：2012-12-03T17:25:18.077
> 
> 标签：jquery-autocomplete, slickgrid

[我的问题与这个问题](https://stackoverflow.com/questions/12842946/select-focus-cell-using-slickgrid)完全相反。所以我正在尝试的是在用户从该单元格中的自动完成组合框中选择一个项目后，我试图找到一种方法来失去对单元格的关注。

```
 $input.autocomplete({
                delay: 0,
                minLength: 0, 
                source: args.column.options,
                select: function (event, ui) {
                    $input.val(ui.item.label);
                   grid.getEditController().commitCurrentEdit();
              return false;
                }
            }); 
```

完成编辑后，我使用此代码间接失去焦点。它工作正常，但是，单元格以某种方式保持选中状态。

```
grid.getEditController().commitCurrentEdit(); 
```

我还尝试了下面的代码来失去焦点，但是每次运行代码时都会抛出错误。

```
grid.setActiveCell();
grid.setSelectedRows(-1); 
```

从自动完成组合框中选择一个项目后，我希望网格失去焦点并且在网格的视口上不选择任何内容。

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:05:20.210

尝试调用`grid.resetActiveCell()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:38:21.563

上周向主分支提交了一个可能解决您的问题的提交：[修复当单元格具有可选项卡元素时键盘焦点被困的问题。](https://github.com/mleibman/SlickGrid/commit/86ce1e1c9d42ba5e10f8f335876e9a8ad03a5f2c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-19T09:27:32.640

您可以按如下方式实现，

```
            如果（grid.getActiveCell（））{
            var row = grid.getActiveCell().row;
            var cell = grid.getActiveCell().cell;
            grid.gotoCell（行，单元格，假）；
        }

```

# wcf - WCF 流 - MessageContract 请求不会在所有引用的程序集中重用类型

> ID：13688513
> 
> 赞同：2
> 
> 时间：2012-12-03T17:25:28.147
> 
> 标签：wcf, parameters, messagecontract

我已经修改了 Microsoft 提供的 WCF“流”示例应用程序，以使用在共享程序集中设置并用`MessageContract`属性修饰的请求对象。然后应该将其传递给`UploadStreamRequest()`服务的方法。

问题是当我向客户端添加服务引用并尝试调用该方法时，`MessageContract`对象的每个属性都刚刚转换为单独的参数。

我还在高级设置中尝试了“始终生成消息合同”选项，尽管这会更改方法以便将其传递给请求对象，但它已经重新生成了自己的对象代理表示（即使我有“重用所有引用程序集中的类型都打勾）。

任何人都可以解释我在这里缺少什么吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T22:52:48.010

我遇到了这个问题，我已经修复了它，勾选了“始终生成消息合同”复选框。当我添加服务参考时。

希望这可以帮助。

# c++ - delete[] 会释放整个内存块吗？

> ID：13688516
> 
> 赞同：6
> 
> 时间：2012-12-03T17:25:32.160
> 
> 标签：c++, arrays, char, delete-operator

考虑以下：

```
char* msg = new char[20]; 
msg[4] = '\0'; 
delete[] msg; 
```

1.  是取消分配分配给的所有 20 个字符还是仅`delete[] msg`分配给 的那些？`msg``\0`
2.  如果它只释放到`\0`，我怎么能强制它删除整个内存块？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T17:26:46.093

您问题中的原始代码具有未定义的行为，因为您使用的是`delete`with `new[]`。

我注意到您已通过将其替换`delete`为`delete[]`：

```
delete[] msg; 
```

这是正确的，并且将释放所有已分配的内存`new[]`。

没有“删除直到`\0`”或任何其他此类“部分”删除的概念。只有用/分配的*完整*块才能被删除，所以你的代码很好。`new``new[]`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T17:28:15.783

操作员删除整个`delete[]`内存块。您不能释放部分内存块 - 您只能释放整个块。

对于`new/delete`和也是如此`malloc/free`。释放函数只能释放整个内存块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T17:27:38.650

您应该使用`delete[]`释放数组。这是您可以告诉程序查找数组信息并能够释放整个数组的唯一方法。

在正常情况`delete`下，编译器可能会认为您只想释放一个指针，但事实并非如此。有关数组大小的额外信息以及不会被查找的任何内容，并且不会释放额外的内存。

您在数组中设置一个 char 的事实`\0` 没有任何区别，当释放数组时，只考虑数组的已知大小。否则任何类似于

```
Class *array = new Class[50];
array[0] = NULL;
delete[] array; 
```

只会泄漏内存。

# wcf - 来自客户端的 wcf 类库中的 WCF 数据服务

> ID：13688521
> 
> 赞同：4
> 
> 时间：2012-12-03T17:26:01.257
> 
> 标签：wcf, wcf-data-services

我创建了一个 WCF 数据服务并使用 Postman（Chrome 扩展）进行了测试，效果很好。然后我添加了指向我的客户端 C# 库中的 WCF 数据服务的服务引用。

当我在 DataService 上调用 Transactions DbSet 时，我得到了正确的事务数，但是列表中的所有项目都被列表中的最后一项覆盖。即，如果我在数据库中有 10 个事务，我会在我的列表中得到 10 个，但所有项目中的数据都是相同的，这是数据库中的最后一个项目。

我正在使用简单的 LINQ 来获取数据，如下所示

```
List<Transaction>() tempList = new List<Transaction>(); 
tempList = GetContext().Transactions.ToList(); 
```

奇怪的是，当我使用 Fiddler 捕获在数据库上运行的查询时，数据库的输出很好，这意味着我的客户端发生了一些事情，并用最后一项覆盖了列表中的所有项目。任何人都可以指出我如何调试这个或者我怎样才能捕捉到谁在覆盖我的列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:05:18.487

明白了..发现表上没有唯一键，所以从客户端反序列化后将最后找到的项目添加到列表中

# python - 仅处理非空行

> ID：13688522
> 
> 赞同：6
> 
> 时间：2012-12-03T17:26:05.523
> 
> 标签：python

我有以下代码片段

```
def send(self, queue, fd):
    for line in fd:
        data = line.strip()
        if data:
            queue.write(json.loads(data)) 
```

哪个当然工作得很好，但我有时想知道是否有一种“更好”的方式来编写你只在非空白行上操作的构造。

挑战在于这应该使用“fd”读取的迭代特性，并且能够处理 100+ MB 范围内的文件。

更新 - 在您急于获得这个问题的分数时，您忽略了一个导入部分，即内存使用情况。例如表达式：

```
 non_blank_lines = (line.strip() for line in fd if line.strip()) 
```

将整个文件缓冲到内存中，更不用说执行两次 strip() 操作了。这适用于小文件，但当您有 100+MB 的数据（或偶尔 100GB）时会失败。

部分挑战是以下作品，但阅读起来很困难：

```
for line in ifilter(lambda l: l, imap(lambda l: l.strip(), fd)):
    queue.write(json.loads(line)) 
```

寻找魔术师！

最终更新：[PEP-289](http://www.python.org/dev/peps/pep-0289/)对我自己更好地理解 [] 和 () 与迭代器之间的区别非常有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:35:18.350

编写的代码没有任何问题，它可读且高效。

另一种方法是将其编写为生成器理解：

```
def send(self, queue, fd):
    non_blank_lines = (line.strip() for line in fd if line.strip())
    for line in non_blank_lines:
        queue.write(json.loads(data)) 
```

如果您正在应用可以采用迭代器的函数，这种方法可能是有益的（更简洁）：例如 python3 print

```
non_blank_lines = (line.strip() for line in fd if line.strip())
print(*non_blank_lines, file='foo') 
```

为了消除对 strip() 的多次调用，将生成器理解链接在一起

```
stripped_lines = (line.strip() for line in fd)
non_blank_lines = (line for line in stripped_lines if line) 
```

请注意，生成器表达式不会对内存产生不利影响，如本[pep](http://www.python.org/dev/peps/pep-0289/)中所述。

要更深入地了解这种方法和一些性能基准，请查看这组[注释](http://www.dabeaz.com/generators/Generators.pdf)。

最后请注意，如果您不需要 strip() 的完整行为，则 rstrip() 将优于 strip()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:19:46.560

根本没有比您的“更好”的方式，它按预期的方式工作，易于阅读等。但是，如果您确实将速度归类为“更好”，则可以肯定地进行一些小调整。

我对 Python 上的这种速度的东西不太熟悉，但这里有一些建议，它们只在某些条件下有效。我希望其他人会想出更好的东西，也许这个答案会对他们有所帮助。

如果文件不包含诸如

```
 \n 
```

但只有`\n`, 那么这种方式会明显更快：

```
def send(self, queue, fd):
    for line in fd:
        if line != '\n':
            queue.write(json.loads(line.strip())) 
```

时间值：

```
using: strip() :: 1.8722578811916337
using: line != '\n' :: 1.0126976271093881
using: line != '\n' and line != ' \n' :: 1.2862439244170275 
```

但是请注意，这实际上可能会变得更慢，如果文件没有一行`\n`，我将它与 fd 一起计时`["string", "\n", "test string", "\n", "moreeee", "\n", "An other element"]`

`\n`但是，您可能不知道这些线路`.strip()`是否很慢，因此可能有更多更好的方法。

# networking - 在每个客户端上同时启动计时器

> ID：13688523
> 
> 赞同：2
> 
> 时间：2012-12-03T17:26:08.640
> 
> 标签：networking, client-server, unity3d

我正在 Unity3D 中开发多人游戏，我需要一些同步方面的帮助。其中一个玩家充当服务器，其他人都是客户端。在游戏的某个时间点，所有玩家都有 10 秒的时间来回答问题，然后才能进入游戏的下一步。他们回答问题所用的时间被记录下来并用于找出最快的答案，因此所有客户同时启动他们的计时器是非常关键的。

就消息传递而言，构建此结构的最佳方法是什么？这些消息将包含哪些信息？

我尝试过/想过的事情：

*   服务器启动计时器并告诉每个人都这样做。问题：如果任何客户端滞后，问题会在不同时间弹出。
*   服务器启动计时器并告诉每个人计时器启动的日期时间。问题：如果客户滞后，他会立即跳到特定时间而不是开始。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:33:02.553

根据您为谁开发游戏，您总是可以让客户处理时间安排。让服务器向客户端发出信号以显示问题并启动计时器，然后等待响应。然后，每个客户端都可以为用户计时，并将时间连同用户的回答一起提供给服务器。只要服务器为客户端提供几秒钟的“缓冲”，它就应该以准确的时间接收所有答案，无论有多少延迟。

唯一的问题是，同样取决于您的受众，用户可能会篡改发送的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T18:59:41.600

您可以让服务器发出启动计时器的信号以及日期时间。与其在消息发送的同时启动计时器，不如给客户端一个在消息发送几秒后发生的 DateTime。这样一来，客户就不会在收到消息后立即启动计时器，从而让那些有滞后的人“赶上”。（例如，信号在上午 7:00:00 发送，包含时间 7:00:05。当客户端收到消息时，他们等待启动计时器直到 7:00:05，因此所有计时器都可以在同时。）

# windows-phone-7 - Wp7 Mango中的TextBlock如何阴影

> ID：13688529
> 
> 赞同：0
> 
> 时间：2012-12-03T17:26:35.437
> 
> 标签：windows-phone-7, shadow

在 windows phone mango 中，如何在 TextBlock 上设置阴影？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:01:59.687

`DropShadowEffect`恐怕没有。

你可以尝试这样的事情：

使用图像，您可以简单地在 Photoshop/Gimp 等中创建阴影（对我来说效果很好）并将其保存为 .png。

使用 TextBlock 有点困难。例如，创建一个带有阴影的半透明图像，并将 TextBlock 和 Image 都放在 Canvas 内。更改 Canvas.ZIndex="integer" 附加属性以将它们按特定顺序放置 - 图像必须位于下方。阴影也应该模糊。

缺点是：

阴影是静态的。不太适合 Metro UX。

# jquery - 选择另一个第一层元素的所有第一层元素

> ID：13688531
> 
> 赞同：0
> 
> 时间：2012-12-03T17:26:40.907
> 
> 标签：jquery

`<dt>`有没有比我展示的更优雅的方法来选择所有第一层。我在想类似的东西，`$('#myDiv').children('dl>dt')`但它不起作用。谢谢

```
$('#myDiv dl').children('dt');
$('#myDiv').children('dl').children('dt');

    <div id="myDiv">
        <dl>
            <dt>good</dt>
            <dd>good
            <dl><dt>Bad</dt><dd>Bad</dd></dl>
            </dd>
            <dt>good</dt><dd>good</dd>
        </dl>
    </div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:28:58.960

```
$('#myDiv>dl>dt') 
```

那是*黑* **魔法**！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:31:19.810

学习 CSS 选择器。它们在使用 jQuery 时非常方便。

获取直接子级的 CSS 选择器是：`>`

所以：

```
$('#myDiv > dl > dt') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:47:48.523

这个如何：

```
$('#myDiv dl dt') 
```

# php - php析构函数被调用两次

> ID：13688533
> 
> 赞同：0
> 
> 时间：2012-12-03T17:26:53.803
> 
> 标签：php, destructor

有人可以解释为什么父类析构函数被调用两次吗？我的印象是子类只能通过使用来调用父类的析构函数： parent::__destruct()

```
class test {

    public $test1 = "this is a test of a pulic property";
    private $test2 = "this is a test of a private property";
    protected $test3 = "this is a test of a protected property";
    const hello = 900000;

    function __construct($h){
        //echo 'this is the constructor test '.$h;
    }

    function x($x2){
        echo ' this is fn x'.$x2;
    }
    function y(){
        print "this is fn y";
    }

    function __destruct(){
        echo '<br>now calling the destructor<br>';
    }
}

class hey extends test {

    function hey(){
        $this->x('<br>from the host with the most');
        echo ' <br>from hey class'.$this->test3;
    }
}

$obj = new test("this is an \"arg\" sent to instance of test");
$obj2 = new hey();
echo $obj2::hello;
/*
 the result:
 this is fn x
 from the host with the most 
 from hey classthis is a test of a protected property900000
 now calling the destructor

 now calling the destructor
 */ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:37:15.420

```
$obj = new test("this is an \"arg\" sent to instance of test");
$obj2 = new hey(); 
```

您在这里创建了两个对象。两者都将在脚本结束时破坏。

由于类`hey`没有定义破坏方法，因此它调用父类进行破坏。如果您在子类中定义一个 destruct 并运行您的代码，您会注意到它不再命中父类。

但是您仍然看到`test`破坏，因为您`test`在 line 中创建了一个类型的对象`$obj = new test("this is an \"arg\" sent to instance of test");`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T17:32:26.163

这仅适用于`__destruct`方法在子项中被覆盖的情况。例如：

```
//parent
public function __destruct() {
   echo 'goodbye from parent';
}
//child
public function __destruct() {
   echo 'goodbye from child';
} 
```

...将输出：

```
goodbye from parentgoodbye from child 
```

然而，这：

```
//child
public function __destruct() {
   echo parent::__destruct() . "\n";
   echo 'goodbye from child';
} 
```

将输出：

```
goodbye from parent
goodbye from child 
```

如果不覆盖，它会隐式调用父析构函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T17:38:25.767

它只是一个印象....

[关于析构函数的 PHP 文档](http://php.net/manual/en/language.oop5.decon.php)

> 与构造函数一样，父析构函数不会被**引擎隐式调用**。为了运行父析构函数，必须在析构函数体中显式调用 parent::__destruct()。
> 
> 即使使用 exit() 停止脚本执行，也会调用析构函数。在析构函数中调用 exit() 将阻止执行剩余的关闭例程。

如果你不这样做，那么你需要覆盖它

例子

```
class test {
    function __destruct() {
        var_dump(__CLASS__);
    }
}
class hey extends test {

    function __destruct() {   // <------ over write it 
    }
}
$obj = new test();
$obj2 = new hey(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T17:32:37.973

您的类从其父`hey`类继承方法。`__destruct`所以，当`test`对象被销毁时，它被调用，当`hey`对象被销毁时，它被再次调用。

考虑这个变化：

```
class hey extends test{
    function hey(){
        $this->x('<br>from the host with the most');
        echo ' <br>from hey class'.$this->test3;
    }

    function __destruct(){
    }
} 
```

然后，您的破坏消息将只输出一次。

示例（您的代码）：[http ://codepad.org/3QnRCFsf](http://codepad.org/3QnRCFsf)

示例（更改代码）：[http ://codepad.org/fj3M1IuO](http://codepad.org/fj3M1IuO)

# c++ - 在不使用 cout、printf 或 puts() 的情况下打印内容

> ID：13688534
> 
> 赞同：4
> 
> 时间：2012-12-03T17:26:55.420
> 
> 标签：c++, c

我已经了解到

```
inline ostream & _Cdecl ostream::operator<< (const signed char * _s) {
    outstr(_s, (const signed char *)0);
    return *this;
} 
```

是如何在 iostream.h 头文件中声明（重载）插入运算符 (<<)。我可以使用相同的函数在屏幕上打印字符串值吗？

我试过了

```
#include<iostream.h>
int main() {
    outstr("Hello world!", (const signed char *)0);
    return 0;
} 
```

结果出错了。我想使用这样的东西来看看是否有一些可能的方法来回答这个在屏幕上打印某些东西的查询，而不使用 printf、cout 或 puts()。

更新：如果您有任何建议，我会很欢迎

```
#include<stdlib.h>
void main() {
    system("echo /"Hello world!/"");
} 
```

注意：如果您可以提供无需 printf()、cout 或 puts() 即可打印的 C 等效代码，我没有任何限制

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:30:50.967

是的，您可以直接调用该函数，但是您这样做的理由是有缺陷的。与执行实际功能所花费的时间相比，通过消除对操作员的子程序调用所节省的时间可以忽略不计；这就像在活动车顶关闭时关闭车窗以减少雨水一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T18:08:17.973

如果您希望在所有符合标准的 C++ 实现中具有可移植性，您可以通过以下方式将字符串打印到标准输出

```
const char * str = "Hello World\n";
fprintf(stdout, str);
fputs(str, stdout);
for (int i=0; str[i]!=0; ++i)
    putchar(str[i]);
for (int i=0; str[i]!=0; ++i)
    putc(str[i], stdout);
for (int i=0; str[i]!=0; ++i)
    fputc(str[i], stdout);
fwrite(str, sizeof(*str), strlen(str), stdout); 
```

此外，您可以使用`std::cerr`和`std::clog`。他们写信`stderr`而不是`stdout`，但从用户的角度来看，这通常是同一个地方：

```
std::cerr << str;
std::clog << str; 
```

从效率的角度来看，我怀疑这些中的任何一个都会对您有所帮助。为此，您可能希望查看一些更特定于平台的东西。对于 POSIX 系统，请参阅[Dave S](https://stackoverflow.com/a/13689312/440119)给出的答案。对于 Windows，请参阅[此链接](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683497%28v=vs.85%29.aspx)。

你不应该做的是打开你的头文件并模仿他们使用的东西。至少，不是在中间级别，他们在自己的实现中使用不同的各种晦涩功能。这些功能在下一个版本中可能不存在。但是，如果您深入到最深层次，您会发现操作系统特定的调用，就像我上面提供的链接中的调用一样。只要您使用相同的操作系统，甚至在操作系统版本之间，这些都应该是安全的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T17:32:43.157

进行函数调用所需的时间比打印字符串所需的时间*要*少*得多。*您可以（通常应该）忽略您的方法可能节省的时间。

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-03T18:20:55.867

在 UNIX 类型系统上，您可以执行以下操作。

```
#include <unistd.h>
#include <stdio.h>

int main()
  {
  const char x[] = "Hello World!";
  write(STDOUT_FILENO, x, strlen(x)); // Feel free to check the return value.
  return 0;
  } 
```

我很好奇你这样做的动机是什么。在信号处理程序之外，我不愿意像这样进行较低级别的调用。I/O 的性能将是时间的主要驱动因素，而不是通常经过大量优化/内联的中间函数调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T18:06:52.433

您可以直接使用系统调用。

[http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html](http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html)

例如，这个页面解释了 linux 系统调用。您可以从我复制的链接开始，并使用汇编来使用许多方法，或者换句话说，不调用它的函数来做某事。

但我猜这是一个棘手的问题，如果我有一家公司，我永远不会雇佣一个使用系统调用而不是函数的人。

这是将 sys_write(4) 与标准输出 (1) 结合使用的示例。您可以将汇编代码内联到您的 C/C++ 代码中。 [http://docs.cs.up.ac.za/programming/asm/derick_tut/#helloworld](http://docs.cs.up.ac.za/programming/asm/derick_tut/#helloworld)*

# nuget - 如何在 NuGet 中根据目标框架指定条件依赖项？

> ID：13688536
> 
> 赞同：15
> 
> 时间：2012-12-03T17:26:59.613
> 
> 标签：nuget, nuspec

我正在构建一个引用 Microsoft CommonServiceLocator 程序集的 NuGet 包。

Microsoft CommonServiceLocator 有两个版本：

*   [CommonServiceLocator](http://nuget.org/packages/CommonServiceLocator) - 面向完整的 .NET 框架，并被 Microsoft EnterpriseLibrary 组件引用。
*   [Portable.CommonServiceLocator](http://nuget.org/packages/Portable.CommonServiceLocator) - 包含 CommonServiceLocator 的完整版本和[最近发布的可移植类库版本](http://commonservicelocator.codeplex.com/releases/view/17694)。

我的项目是一个可移植类库，但是因为它有时与企业库一起使用，所以我需要“有条件地”引用可移植版本，这样就不会有冲突。

*   如果目标框架是完整的 .NET 4.0/4.5，请使用原始 CommonServiceLocator 包，这样人们也可以使用企业库位（也引用 CommonServiceLocator 包）。
*   如果目标框架是可移植的（或其他任何东西），请使用 Portable.CommonServiceLocator 包。

[我在 NuGet 文档中看到了新的“组”功能，显示了如何在 .nuspec 文件中指定依赖项](http://docs.nuget.org/docs/reference/nuspec-reference#Specifying_Dependencies)，我认为这可以满足我的要求，但我不确定如何测试它。

**这是我*认为*我需要做的事情，我希望有人可以验证我的方法或为我指明正确的方向：**

```
<dependencies>
  <group>
    <!-- Always include regardless of target framework -->
    <dependency id="Autofac" />
  </group>
  <group targetFramework="net40">
    <!-- Also include the full CSL if it's full framework -->
    <dependency id="CommonServiceLocator" />
  </group>
  <group targetFramework="portable-win+sl50+wp8">
    <!-- Otherwise include the Portable CSL -->
    <dependency id="Portable.CommonServiceLocator" />
  </group>
</dependencies> 
```

具体来说...

*   **我的`targetFramework`语法对吗？**我找不到任何例子，所以我不知道`+`分隔机制是否正确，或者是否应该用逗号分隔。
*   **默认组会起作用吗？**具有未指定目标框架的那个组 - 是否会始终包含在内，还是我需要在每个组中复制/粘贴它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:37:55.673

是的，这非常正确。可在此处找到有关可移植框架名称的详细信息[http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package#Framework_Names](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package#Framework_Names)

我还发现了一件事，因为默认情况下 win+sl50+wp8 包含 net45 您可能想要包含它以便安装此依赖组。

# mysql - 私人消息的数据库模式

> ID：13688537
> 
> 赞同：2
> 
> 时间：2012-12-03T17:27:02.033
> 
> 标签：mysql, sql, database-design, database-schema

我正在尝试在 Rails 中实现一个私人消息传递系统，我需要数据库设计方面的帮助。我已经阅读并提出了许多有效的替代方案，但我想知道是否有人知道这种最终可以扩展的模式。我感谢任何帮助或链接。

编辑：数据库模式基本上有两件事

1.主题

2.消息

我正在考虑实现两个表

## 留言

主题文本

发件人ID

接收者 ID

has_many 文本

## 文本

内容文本

我对数据库架构一点也不擅长，但我很感激在我学习时的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T20:04:39.900

一个非常简单直接的设计将是..

```
User
----------------
userID
userName
...
...
...

Messages
---------------
messageID
title
body

User_Messages
----------------
senderID (userID of sender)
recieverID (userID of reciever)
messageID (messageID of relative message) 
```

这种设计也将简化您的搜索。您可以根据需要添加或删除列。

# git - 使用 Git 在部署时压缩 JS/CSS 文件

> ID：13688541
> 
> 赞同：6
> 
> 时间：2012-12-03T17:27:31.360
> 
> 标签：git, deployment, githooks, minify

我对 git 有点陌生。此外，这是我的第一个项目，我正在自动化部署过程。到目前为止，能够`git push dev`上传文件、复制配置文件等已经很幸福了。

现在我想在推送到我的开发服务器时缩小 JS/CSS 文件。我正在考虑在服务器上安装一些命令行工具，用于在接收后的 git 挂钩上压缩和保存某个文件夹上的每个 js/css 文件、压缩和保存。

这是一个好方法吗？（因为我读过关于将压缩文件添加到 repo 和其他我不太相信的想法）

如果是这样，哪些工具最适合这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T15:47:04.150

[http://git-scm.com/book/ch7-2.html](http://git-scm.com/book/ch7-2.html)

我假设您**永远不会**在服务器上进行提交，即服务器将仅用于**检出**更新的主服务器并且永远不会更新它。这个技巧将在结帐时自动缩小任何 *.css 文件：

```
# within repo
$ echo '*.css filter=minify' >> .git/info/attributes
$ git config filter.minify.clean  cat
$ git config filter.minify.smudge minify-command 
```

minify-command 应该是缩小 *.css 文件的命令，即

```
$ cat foo.css | minify-command > foo-minified.css 
```

它接近你想要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T17:31:32.630

也许您正在寻找添加结帐后挂钩（或者根据您的部署系统，它可能是另一个挂钩），然后使用将缩小文件的脚本启动。

您还可以在执行此操作之前使用钩子检查相关文件的修改日期

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T03:25:10.337

通过在 dev 上重写文件并且在本地存储库中没有缩小文件，这两个存储库将始终彼此不同步。

您可能想要重新考虑将站点部署到 dev 的方式，而不是推送到 dev，例如，您可能希望从 prestine 存储库中提取 dev。

# python - 对特定用户的用户身份验证

> ID：13688545
> 
> 赞同：1
> 
> 时间：2012-12-03T17:27:51.553
> 
> 标签：python, django

您好，我使用@login_required 来限制对某些为用户存储书签的页面的访问，但在某些情况下，我希望用户仅访问他的书签，并且如果他尝试输入编辑属于另一个用户的书签的 URL，则必须停止访问. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:34:55.153

`@login_required`可以帮助您确保用户已登录以访问视图。

访问视图后，您可以检查以确保允许用户访问书签，并且仅获取允许他们访问的书签

例如，如果您的网址看起来像

`/bookmarks/`并且对应于函数`bookmarks`

```
@loggin_required
def bookmarks():
  # only fetch book makrs for this user
  bookmarks = Bookmarks.objects.filter(user=request.user) 
```

这将确保用户已登录以访问该 url，并且书签仅对正在查看该页面的用户显示。如果某些用户可以查看其他用户的书签，您可以添加某种权限系统

如果此视图要显示用户的所有书签，并且您想提供一个 url 来编辑书签或类似的东西

`bookmarks/{{ bookmark_id }}/edit`映射到`edit_bookmark`

```
@login_required
def edit_bookmark(bookmark_id):
   # user is guarenteed to be logged in so request.user is available
   # your permission system will depend on how you authenticate whether a user can edit
   # a bookmark or not
   # CHECK if user has permission to edit bookmark
   pass 
```

# c# - 正则表达式捕获大写和小写字母

> ID：13688546
> 
> 赞同：4
> 
> 时间：2012-12-03T17:28:03.597
> 
> 标签：c#, regex

我正在创建一个简单的 C# 应用程序，其中有一个条件来捕获字母的大写和小写。

这是我的条件：

```
if( txtChord.Text == "A" || txtChord.Text == "a" && cbKeys.SelectedIndex == 6 ){
                txtAnswer.Text = "B";
            } 
```

我想使用正则表达式更有效地做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T17:31:13.250

使用[`String.Compare(String, String, Boolean)`](http://msdn.microsoft.com/en-us/library/zkcaxw5y.aspx)方法并为最后一个参数提供 true 以忽略大小写。

上面的方法返回负数、0 或正数。

如果你只想要`bool`价值，你可以使用[`String.Equals(String, String, StringComparison)`](http://msdn.microsoft.com/en-us/library/t4411bks.aspx)with[`StringComparison.OrdinalIgnoreCase`](http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx)选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T17:31:57.940

通常忽略大小写的做法是这样的：

```
if( txtChord.Text.ToLower() == "a" && cbKeys.SelectedIndex == 6 ) 
```

但请注意，在您的`if`声明中，这两个检查不是“等效的”，因为优先[级](http://msdn.microsoft.com/en-us/library/aa691323%28v=vs.71%29.aspx)`&&`高于. 你的相当于：`||`

```
if( txtChord.Text == "A" || (txtChord.Text == "a" && cbKeys.SelectedIndex == 6)) 
```

不能用一张支票代替。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T17:31:35.677

您不需要正则表达式来执行此操作。你可以简单地做：

```
if(txtChord.Text.ToLower() == "a" && cbKeys.SelectedIndex ==6)
{
     txtAnswer.Text = "B";
} 
```

这`ToLower()`将使`txtChord`文本框中的任何文本变为小写，然后您可以对其进行检查。或者你可以使用`ToUpper()`. 它是一样的，但大写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T17:32:50.670

Regex.Match(txtChord.Text,"a",RegexOptions.IgnoreCase)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T17:34:38.070

这里有很多很好的信息：[http ://www.regular-expressions.info/](http://www.regular-expressions.info/)

要捕捉字母的大写或小写，您可以使用 '[Aa]' 或可能还带有标志。

# linq - 检索包含 id 的数据

> ID：13688548
> 
> 赞同：0
> 
> 时间：2012-12-03T17:28:08.153
> 
> 标签：linq, ravendb

Raven DB 给了我这条信息

> 不支持的方法：包含

对于此代码：

```
 using (var d = DataLayer.RavenDB.d.OpenSession())
    {
      foos = d.Query<Foo>().Where(foo => ids.Contains(foo.Id)).Skip(i * 10).Take(10).ToList();
    } 
```

我怎样才能找回我的清单`foos`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:36:00.303

看起来您正在尝试按 id 查询多个文档。在 Raven 中不建议按 ID 查询。而是加载它们。有一个需要多个 Id 的重载。

```
foos = session.Load<Foo>(ids); 
```

如果这是一些其他属性而不是 Id，您将使用`item.In(list)`而不是`list.Contains(item)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T15:51:43.997

如果您想根据 ID 列表加载文档，请使用 Matt 建议的解决方案，性能方面的 Load() 是最好的方法。

但是如果您仍然想使用查询（使用一些 where contiions）来获取它，请像这样更改代码

```
using (var d = DataLayer.RavenDB.d.OpenSession())
    {
         foos = d.Query<Foo>()
                 .Where(foo => foo.Id.In<string>(ids))
                 .Skip(i * 10)
                 .Take(10).ToList();
    } 
```

# jquery - select2 插件和 json 格式 rails 3

> ID：13688551
> 
> 赞同：0
> 
> 时间：2012-12-03T17:28:12.760
> 
> 标签：jquery, ruby-on-rails, ruby, ruby-on-rails-3, jquery-select2

我正在将此 gem 用于自动完成功能：

[https://github.com/argerim/select2-rails](https://github.com/argerim/select2-rails)和 select2。

这是我的行动：

```
def autocomplete_subject
   @messages = Message.where(:by_the_system => nil).page(params[:page]).per(params[:page_limit])
    messages = Array.new
    @messages.each do |m|
      element = Hash.new
      element[:id] = m.id
      element[:text] = [m.subject].join(' ')
      messages << element
    end
   results = Hash.new
   results[:results] = messages
   respond_to do |format| 
     format.json { 
      render :json => {
        :results => results,
        :total => @messages.count,
     } 
    }
  end
 end 
```

这是我的 JavaScript：

```
function messageFormatSelection(message) {
  return message.subject;
}

$("#search_boxes #subject").select2({
        minimumInputLength: 3,
        multiple: true,
        width: "300px;",
        ajax: {
            url: "/admin/messages/autocomplete_subject_nil.json",
            dataType: 'json',
            quietMillis: 100,
            data: function (term, page) { // page is the one-based page number tracked by Select2
                return {
                    subject: term, //search term
                    page_limit: 5, // page size
                    page: page, // page number
                };
            },
            results: function (data, page) {
            var more = (page * 5) < data.total;                
              return {results: data.results, more: more};
            }
        },
        formatSelection: messageFormatSelection // omitted for brevity, see the source of this page
   }); 
```

这是我的 json 视图：

```
{"results":{"results":[{"id":"50b4f5c01d41c811fb000014","text":"Microfunc con id: 50ae41011d41c86ad8000004"},{"id":"50b4f8d31d41c811fb000026","text":"Re: Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4fcf61d41c811fb00002e","text":"Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4fe531d41c811fb000032","text":"Re: Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4ff431d41c811fb000038","text":"Re: Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4f5d71d41c811fb000017","text":"Re: Microfunc con id: 50ae41011d41c86ad8000004"},{"id":"50b4f8231d41c811fb000024","text":"Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4fa921d41c811fb000028","text":"Re: Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4fee41d41c811fb000034","text":"Re: Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4ff291d41c811fb000036","text":"Pedido con id: 50b4f6041d41c811fb000018"},{"id":"50b4ffd71d41c811fb00003a","text":"mira os poneis deacuerdo o que"},{"id":"50b5013d1d41c811fb00004b","text":"Re: Microfunc con id: 50ae41011d41c86ad8000004"},{"id":"50b51ccb1d41c811fb000061","text":"mensaje enviado desde el panel de administraci\u00f3n"},{"id":"50b51e0c1d41c811fb000063","text":"Re: mensaje enviado desde el panel de administraci\u00f3n"},{"id":"50b51e461d41c811fb000065","text":"Microfunc con id: 50ae3b321d41c849c500000b"},{"id":"50b51e611d41c811fb000068","text":"Re: Microfunc con id: 50ae3b321d41c849c500000b"},{"id":"50b61b831d41c80b5d000004","text":"Re: mira os poneis deacuerdo o que"},{"id":"50b897a41d41c83613000034","text":"Microfunc con id: 50ae3b321d41c849c500000b"}]},"total":18} 
```

**我想获得按搜索排序的结果并使用无限滚动功能，但它无法正常工作。**

**我究竟做错了什么？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:09:54.903

排序需要在服务器端完成，而不是在客户端，因为客户端在加载时无法访问所有元素。从您的代码看来，这`text`等同于您的 Message `subject`。如果是这样，您可以简单地修改这一行：

```
@messages = Message.where(:by_the_system => nil).
  page(params[:page]).per(params[:page_limit]) 
```

包括排序顺序：

```
@messages = Message.where(:by_the_system => nil).
  order(:subject).
  page(params[:page]).per(params[:page_limit]) 
```

您的回复应包括当前页面，以及这是否是最后一页：

```
respond_to do |format| 
 format.json { 
  render :json => {
    :results => results,
    :total => @messages.count,
    :page => params[:page].to_i,
    :last_page => @messages.last_page
 } 
} 
```

您还需要修改您的 ajax 请求以更新*页面*变量而不是未使用的“更多”偏移量：

```
results: function (data, page) {
          page = data.page + 1;
          if (data.last_page == data.page){ 
            // do something to disable searching as list is now exhausted
          }
          return {results: data.results};
        } 
```

# coldfusion - Coldfusion 8计划任务未运行？

> ID：13688554
> 
> 赞同：4
> 
> 时间：2012-12-03T17:28:21.233
> 
> 标签：coldfusion, scheduled-tasks

几个月前，我在一家公司开始了 Web 开发人员的工作，负责管理一堆 Coldfusion 应用程序等。显然，一个计划任务是多年前设置的，并且运行良好，直到几年前它停止在以前的一位 Web 开发人员手下工作。没有人知道它为什么停止工作，但现在我的工作是修复它。这是我作为 Web 开发人员的第一份工作，当我开始工作时我并不知道 CF（几乎不知道它的存在），而且我今天早上才开始学习计划任务，所以只知道我是一个完全的新手。

该文件是一个基本文件——它只是更新数据库中的一个表。如果您在浏览器中运行 URL（这是他们过去几年一直在做的事情），它运行良好，并且所有内容都会更新。设置为每晚运行的计划任务尚未更新文件。我尝试在 CF Admin 中打开日志，将其设置为在今天早上的不同时间运行，也只是告诉它手动运行，根据日志，它正在执行（没有错误），但文件是没有被更新。我尝试注释掉大部分文件，只是告诉它发送一封基本的电子邮件，没有变量或任何东西，但我得到了相同的结果。

有任何想法吗？我不知道从这里尝试什么。我尝试在网上寻找解决方案，但我发现与我的情况类似的唯一帖子是这样的，人们似乎在暗示问题可能是调度程序无法使用的变量：

[Coldfusion计划任务不发送电子邮件](https://stackoverflow.com/questions/7154701/coldfusion-scheduled-task-not-sending-emails)

不过，我的页面上现在没有变量。根据该页面上的建议，我尝试通过 CFSCHEDULE 运行任务，但得到的结果与以前相同。其他一些建议（服务器监视器/FusionReactor/cflog）我只是不知道该怎么做，所以我没有尝试过。

编辑：现在，这是页面中唯一没有被注释掉的代码：

```
<cfmail 
    to="[e-mail address]"
    from="[e-mail address]"
    Subject="is it running at all?">
    Is it running?
</cfmail> 
```

编辑2：好的，现在我在电子邮件代码之前和之后都有这样的东西：

```
<cflog 
text = "before e-mail"
application = "yes"
log = "Scheduler"
type = "information"> 
```

如果我实际访问文件的 URL（并且电子邮件也已发送），我会看到日志消息，但如果我告诉它从 CF 管理员运行计划任务则不会。因为我在浏览器中打开文件时会发送电子邮件，所以我认为这不是邮件服务器的问题。

编辑 3：是的，电子邮件地址是普通的硬编码字符串。不过，我不确定 Application.cfm 文件“覆盖”是什么意思。在站点的顶层有一个 Application.cfm 文件，但不在这个特定的子目录中。有许多应用程序范围变量，但没有一个像现在这样在文件中使用。

编辑4：感谢您的解释。正如我所说，就 CF 而言，总共 n00b，所以我很感激帮助。此应用程序的 Application.cfm 页面检查您是否已登录，如果未登录，则将您重定向到登录页面。这可能是问题吗？

编辑5：耶！这似乎是问题所在。谢谢你，谢谢你，谢谢你！Leigh，请提交它作为答案，以便我选择它。你是我的英雄！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T22:14:56.423

（来自评论）

远射，但您的计划任务是否位于[Application.cfm/Application.cfc](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-7d39.html)文件所涵盖的目录中？询问的原因是父`Application.cfm`文件中的代码在您的 .cfm 脚本之前首先执行。Application.cfm 文件中是否有任何代码中止请求或重定向（例如权限检查）？

# java - 基于 Spring 的 SOA 在 Tomcat 上使用多个 WAR，实现 URL 映射的最佳方法是什么？

> ID：13688555
> 
> 赞同：0
> 
> 时间：2012-12-03T17:28:33.520
> 
> 标签：java, spring, tomcat, spring-mvc

我正在迁移基于 Java 的旧模型 1 网站，以使用正在开发的 restful-api（长期目标是提供*PaaS*和我能找到的任何其他流行语）。

我想为不同的功能模块使用多个不同的 WAR 文件。我知道该怎么做

```
www.myLegacy.com/myWarFile/myFirstMethod
www.myLegacy.com/myWarFile/mySecondMethod
www.myLegacy.com/mySecondWarFile/ThirdMethod (in different war file, and consequently diff url) 
```

但是我希望能够将多个war文件部署到同一个url，例如：

```
www.myLegacy.com/myRest/myFirstMethod
www.myLegacy.com/myRest/mySecondMethod
www.myLegacy.com/myRest/ThirdMethod (this is in different war file to other methods) 
```

这将使用完整的弹簧堆栈（inc spring-mvc）和tomcat。

请问有什么指点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:23:01.370

您可以使用 Apache httpd、nginx 等，并相应地路由 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:51:08.503

我认为这是不可能的，因为 Tomcat 在不同的上下文路径中启动了不同的战争文件。我唯一能想到的就是部署 myRest.war 和 mySecondWarFile.war 并`/ThirdMethod`在 myRest 应用程序本身中添加一个映射并将请求路由到`/mySecondWar/ThirdMethod`.

# sql - 两个数据库合并到 Solr - 如何为条目保留 uniqueID？

> ID：13688557
> 
> 赞同：0
> 
> 时间：2012-12-03T17:28:47.597
> 
> 标签：sql, database, postgresql, solr

我有两个数据库（不幸的是它们必须分开），它们被导入到 Solr 中。

每个数据库每次都有一个主键，但我担心在将这两个导入 SOLR 时，会有多个具有相同 ID 的项目（每个 DB 一个）。

因此，为了保持两个具有两个不同 uniqueID 的独立数据库，我想知道我有什么样的选择。

我应该在一个数据库的主键上附加一个字母吗？这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T09:53:41.100

如果你想确保你没有 ID 冲突，你可以创建一个新的 ID 作为 Solr 的唯一键。

DIH sqls 可以配置为：-

例如

```
SELECT 'TABLE1' || ID AS PRIMARY_ID ... FROM TABLE1
SELECT 'TABLE2' || ID AS PRIMARY_ID ... FROM TABLE2 
```

在 Solr 中，唯一键是 PRIMARY_ID 而不是表 ID。
这将确保即使表的 Id 冲突，您也将始终拥有唯一键。

# ios - 动态改变部分卷页高度

> ID：13688558
> 
> 赞同：1
> 
> 时间：2012-12-03T17:28:52.037
> 
> 标签：ios, iphone, modalviewcontroller, page-curl

我们可以改变部分卷页的高度吗？

例如，我在页面上有一些文本字段元素，我希望能够将视图卷曲到一半以显示它们。

然后，当用户单击文本字段并出现键盘时 - 我想将页面进一步向上卷曲以显示文本字段，然后在键盘清除时再次卷曲。

这有可能吗？还是我必须在底部留下一个键盘大小的间隙（有点毫无意义）。

谢谢

# ember.js - Ember 数据和#each

> ID：13688559
> 
> 赞同：0
> 
> 时间：2012-12-03T17:28:55.207
> 
> 标签：ember.js, ember-data

我正在尝试遵循 Ember 指南中的示例，但使用 ember-data。这是我的路由器：

```
App.Router = Ember.Router.extend({
  enableLogging: true,
  root: Ember.Route.extend({
    index: Ember.Route.extend({
      route: '/',
      redirectsTo: 'orders'
    }),
    orders: Ember.Route.extend({
      route: '/orders',
      connectOutlets: function(router) {
        router.get('applicationController').connectOutlet('orders', App.store.findAll(App.Order));
      }
    }),
    order: Ember.Route.extend({
      route: '/orders/:ord_id'
    })
  })
}); 
```

在我的模板中：

```
{{#each order in controller}}
...
{{/each}} 
```

我收到此错误：TypeError: 'undefined' is not an object (evalating 'c.split')

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-03T18:01:15.827

它使用 ArrayController 工作。我改变了这个：

App.OrdersController = Ember.Controller.extend();

对此：

App.OrdersController = Ember.Controller.extend();

# image - 在播放 2 中处理动态创建的文件

> ID：13688567
> 
> 赞同：3
> 
> 时间：2012-12-03T17:29:11.540
> 
> 标签：image, file, playframework-2.0

我写了一个小应用程序，用 play 2.0 创建可下载的 pdf 文件

我想为公众服务。在我的开发环境中，我在 /assets/ 文件夹中创建了一个文件夹，一切正常。

现在，当切换到生产环境时，我发现 play 总是在我背后部署这些文件。

我真的必须编写一个自己的控制器来提供这些文件还是这里的方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T08:08:34.793

我在尝试提供使用资产控制器动态创建的文件时也遇到了问题。我不知道它是否用于某种缓存，但我最终编写了自己的控制器，现在它完美无缺。

我的意思是，我将 Assets 控制器用于常规公共文件，而对于动态生成的文件，我使用这个：

```
public class FileService extends Controller {
       static String path = "/public/dynamicfiles/";
       public static Result getFile(String file){
              File myfile = new File (System.getenv("PWD")+path+file);
              return ok(myfile);
       }
} 
```

路线是这样的：

```
GET     /files/:file           controllers.FileService.getFile(file: String)
GET     /assets/*file               controllers.Assets.at(path="/public", file) 
```

这对我很有效

# certificate - Windows Phone 8 上是否有证书存储或钥匙串之类的东西？

> ID：13688573
> 
> 赞同：1
> 
> 时间：2012-12-03T17:29:36.437
> 
> 标签：certificate, keychain, windows-phone-8

是否有一些关于证书如何存储在 WP8 上的文档？（是否像在 Android 上一样为它们提供特殊存储，或者它们的管理方式不同？）我找不到任何有关证书的文档。我是 WP8 开发的新手，并且一直坚持这个问题。

如果不是证书存储，可能有类似于 iOS Keychain 的东西可以保存信息，并且在 Keychain 访问组中其他应用程序可以访问它？

读到有可能加密/解密数据，但据我所知，我只能从一个应用程序解密它们，但我也需要从其他应用程序访问它们。基于： http: [//msdn.microsoft.com/en-US/library/windowsphone/develop/ff402533](http://msdn.microsoft.com/en-US/library/windowsphone/develop/ff402533(v=vs.105).aspx) (v=vs.105).aspx和 [http://msdn.microsoft.com/en-US/library/ windowsphone/develop/hh487164(v=vs.105).aspx](http://msdn.microsoft.com/en-US/library/windowsphone/develop/hh487164(v=vs.105).aspx)

我的目标是使用多个应用程序安全地管理数据（密码、证书）。（多个应用程序可以访问相同的密码等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:07:27.763

第 3 方 WP8 应用程序无法与其他第 3 方应用程序持续共享数据。没有在应用程序之间共享的共享数据库、Cookie 容器或读写文件存储。如果这是您希望在未来版本中看到的功能，请随时在[WP8 uservoice](http://wpdev.uservoice.com)上这样说。

关于证书问题，可以从文件存储、电子邮件或应用程序在 WP8 上安装自定义证书。我在相关问题[@TLS connection: override certificate validation中写了一个关于如何在 WP8 上安装自定义证书的示例](https://stackoverflow.com/questions/13601799/tls-connection-override-certificate-validation/13617876#13617876)

# css - 无法围绕 css 浮动（div 浮动到/围绕图像） -

> ID：13688578
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:30:25.627
> 
> 标签：css, image, html, css-float

图像被拉进来，然后是帖子。我希望帖子漂浮在图像旁边并填充右侧的空间。我已经尝试了图像浮动/左、帖子浮动/左或右、显示：inline-block 的各种组合（我也拉了 h3 只是为了弄乱它，没关系）。

我有一种感觉，这与帖子 div 的宽度有关，因为当我的第一篇帖子只有很少的文字时，它会浮动到缩略图的垂直版本（已加载），但如果帖子有完整的一大段文字，算了。

所以我错过了什么。:) 丹克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:00:14.267

你是对的，它确实与你的`homeFloat`div 的宽度有关。

默认情况下，块级元素将使其自身与容器一样宽。当它们漂浮时，这会将它们推到其他容器下方。为了使它们漂浮在其他项目旁边，您需要指定 a `width`（或 a `max-width`），使得 homeFloat + image + padding 等于或小于容器的宽度。

*编辑：*另外，请确保所有内容都正确包装在元素中。`<p>`标签会像你正在寻找的那样环绕浮动图像，所以它应该可以通过对你的 HTML 进行一些修改来实现。

# asp.net-mvc-3 - Jquery 数据选择器不工作

> ID：13688579
> 
> 赞同：0
> 
> 时间：2012-12-03T17:30:30.847
> 
> 标签：asp.net-mvc-3

我对此相当陌生，所以请耐心等待...我正在使用教程@ [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/index.html](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/index.html) 允许用户从中选择日期日历

但是我似乎无法让它工作，如果我以错误的方式处理这个问题，请有人告诉我......

'jquery.datePicker.js & datePicker.css' 可以在页面顶部附近下载... [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/index.html](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/index.html)

1.  在我的视图中复制我的标签内的“•jquery.datePicker.js”中的代码
2.  将 datePicker.css 代码复制到我的 css 文件中
3.  将以下内容粘贴到我的视图页面顶部：

    ```
    <!-- jQuery -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

    <!-- required plugins -->
    <script type="text/javascript" src="scripts/date.js"></script>
    <!--[if IE]><script type="text/javascript" src="scripts/jquery.bgiframe.js"></script><![endif]-->

    <!-- jquery.datePicker.js -->
    <script type="text/javascript" src="scripts/jquery.datePicker.js"></script> 
    ```

这不起作用...iv尝试进行第一个演示并使用替换我的`<script>`标签中的.js数据

```
 $(function()
    {
        $('.date-pick').datePicker();
    });

and then adding the following to .css

    /* located in demo.css and creates a little calendar icon
     * instead of a text link for "Choose date"
     */
    a.dp-choose-date {
        float: left;
        width: 16px;
        height: 16px;
        padding: 0;
        margin: 5px 3px 0;
        display: block;
        text-indent: -2000px;
        overflow: hidden;
        background: url(calendar.png) no-repeat; 
    }
    a.dp-choose-date.dp-disabled {
        background-position: 0 -20px;
        cursor: default;
    }
    /* makes the input field shorter once the date picker code
     * has run (to allow space for the calendar icon
     */
    input.dp-applied {
        width: 140px;
        float: left;
    } 
```

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:51:28.130

要添加的资源

> [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js) [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/jquery.datePicker .js](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/jquery.datePicker.js) http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/datePicker.css [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/demo .css](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/demo.css)

```
<form name="chooseDateForm" id="chooseDateForm" action="#">
<fieldset>
<legend>Test date picker form</legend>
<ol>
<li>
<label for="date1">Date 1:</label>
<input name="date1" id="date1" class="date-pick" /></li>
<li>
<label for="date2">Date 2:</label>
<input name="date2" id="date2" class="date-pick" />
</li>
<li>
<label for="test-select">Test select:</label>
<select name="test-select" id="test-select" style="width: 170px">
<option value="1">Test SELECT </option>
<option value="2">Doesn't shine through</option>
<option value="3">Even in IE</option>
<option value="4">Yay!</option>
</select>
</li>
</ol>
</fieldset>
</form> ​ 
```

Javascript

```
$('.date-pick').datePicker(); 
```

CSS

```
 a.dp-choose-date {
     float: left;
     width: 16px;
     height: 16px;
     padding: 0;
     margin: 5px 3px 0;
     display: block;
     text-indent: -2000px;
     overflow: hidden;
     background: url(http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/images/calendar.png)
 no-repeat;  }4 a.dp-choose-date.dp-disabled {
     background-position: 0 -20px;
     cursor: default; } /* makes the input field shorter once the date picker code  * has run (to allow space for the calendar icon  */
 input.dp-applied {
     width: 140px;
     float: left; }​ 
```

检查我在那里设置演示的提琴手还记得检查我添加的资源

> [http://jsfiddle.net/imranpk/DNFuB/4/](http://jsfiddle.net/imranpk/DNFuB/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T13:07:31.077

感谢您的回复，我必须...将以下内容添加到我的布局页面

```
<script src="@Url.Content("http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js")" type="text/javascript"></script>
    <script src="@Url.Content("http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/jquery.datePicker.js")" type="text/javascript"></script>

    <link href="@Url.Content("http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/datePicker.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/demo.css")" rel="stylesheet" type="text/css" /> 
```

* * *

然后在我的 .cshtml 文件中，我在 ref 的编辑器之后添加（如下）。

```
<script>
            $("#HolidayDate").addClass('date-pick');
            $('.date-pick').datePicker();
</script> 
```

# iphone - 将解析字符串显示为标签问题

> ID：13688580
> 
> 赞同：0
> 
> 时间：2012-12-03T17:30:38.243
> 
> 标签：iphone, ios, parsing, uilabel

我有一个显示在子视图中的标签。我在解析时从 NSString 获得了标签的文本。但是，我尝试显示文本，但它似乎不起作用。没有显示文本。

这是我的代码。如果您知道如何解决此问题，请告诉我：

```
PFQuery *query = [PFQuery queryWithClassName:@"myapp"];
[query getObjectInBackgroundWithId:@"myId"
                             block:^(PFObject *textu, NSError *error) {
                                 if (!error) {

                                     CGRect infoLabelRect = CGRectMake(10, 250, 260, 350);
                                     UILabel *infoLabel = [[UILabel alloc] initWithFrame:infoLabelRect];

                                     NSString *text = [textu objectForKey:@"newstext"];
                                     UIFont *font = nil;
                                     CGFloat points = 17;
                                     CGFloat maxHeight = infoLabel.frame.size.height;
                                     CGFloat textHeight;
                                     do {
                                         font = [UIFont systemFontOfSize:points];
                                         CGSize size = CGSizeMake(infoLabelRect.size.width, 100000);
                                         CGSize textSize = [text sizeWithFont:font constrainedToSize:size lineBreakMode: NSLineBreakByWordWrapping];
                                         textHeight = textSize.height;
                                         points -= 1;
                                     } while (textHeight > maxHeight);
                                     infoLabel.font = font;
                                     infoLabel.numberOfLines = 9;

                                     infoLabel.textColor = [UIColor whiteColor];
                                     infoLabel.textAlignment = NSTextAlignmentCenter;
                                     infoLabel.backgroundColor = [UIColor clearColor];
                                     infoLabel.shadowColor = [UIColor blackColor];
                                     infoLabel.shadowOffset = CGSizeMake(0, 1);

                                     [infoLabel sizeToFit];
                                     [contentView addSubview:infoLabel];

                                 } else {
                                     // Log details of our failure
                                     CGRect infoLabelRect = CGRectMake(10, 250, 260, 350);
                                     UILabel *infoLabel = [[UILabel alloc] initWithFrame:infoLabelRect];

                                     infoLabel.text = @"Connection error!";

                                 }
                             }]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:37:33.457

您的第一部分代码不包含对文本的分配

```
infoLabel.text = text; // or @"Some text" for testing 
```

您的最后一部分代码仅创建 UILabel，但不会将其添加为子视图

```
UILabel *infoLabel = [[UILabel alloc] initWithFrame:infoLabelRect];
infoLabel.text = @"Connection error!";
[contentView addSubview:infoLabel]; 
```

# c# - 如何在 Windows Phone 7 中设置或确认电子邮件帐户以从我的发送邮件应用程序发送电子邮件

> ID：13688581
> 
> 赞同：0
> 
> 时间：2012-12-03T17:30:42.733
> 
> 标签：c#, .net, windows-phone-7, email

如何在 Windows Phone 7 中设置或确认电子邮件帐户以从我的发送邮件应用程序发送电子邮件

我在 Windows Phone 7 中创建了简单的电子邮件发送应用程序，但是当我单击发送按钮时，我收到了这条消息：-" `Make sure you've set-up an account and try again`"

这是我的应用程序代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using Microsoft.Phone.Controls;
using Microsoft.Phone.Tasks;
namespace SendingMail
{
    public partial class MainPage : PhoneApplicationPage
    {
        EmailAddressChooserTask emailAddresstask;

        // Constructor
        public MainPage()
        {
            InitializeComponent();
            this.emailAddresstask = new EmailAddressChooserTask();
            this.emailAddresstask.Completed += new EventHandler<EmailResult>(emailAddresstask_Completed);
        }
        #region Events

        //Open Contact button click
        private void btnOpenContact_Click(object sender, RoutedEventArgs e)
        {
            emailAddresstask.Show();
        }

        //Email Address Chooser Task Completed
        private void emailAddresstask_Completed(object sender, EmailResult e)
        {
            if (e.TaskResult == TaskResult.OK)
            {
                txtTo.Text = e.Email;
            }
        }

        //Send mail button click
        private void btnMail_Click(object sender, RoutedEventArgs e)
        {
            EmailComposeTask Myemail_Composetask = new EmailComposeTask();
            Myemail_Composetask.To = txtTo.Text;
            Myemail_Composetask.Cc = txtCC.Text;
            Myemail_Composetask.Subject = txtSbj.Text;
            Myemail_Composetask.Body = txtbd.Text;
            Myemail_Composetask.Show();
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:23:11.913

您不能在 Windows Phone 7 模拟器中设置电子邮件帐户。您需要在 Windows Phone 7 设备上对此进行测试，或者使用 Windows Phone 8 SDK 和 Windows Phone 8 模拟器为您的 Windows Phone 7 应用程序测试此方案。

从设备或 Windows Phone 8 模拟器，转到“设置”并选择“电子邮件+帐户”并添加帐户。

# mysql - MySql ODBC Windows XP 到 Windows 7

> ID：13688582
> 
> 赞同：2
> 
> 时间：2012-12-03T17:30:44.453
> 
> 标签：mysql, windows, vb.net, odbc

我正在尝试将大型应用程序从 Windows XP 移植到 Windows 7。此应用程序必须在两个平台上并排工作，因为我有 22 台客户端计算机，它们目前都是 Windows XP，但随着时间的推移会一一转换到 Windows 7 .

我有一个在 XP 中运行良好的 MySql 数据库，并且已经使用了几年。在我的第一台 Windows 7 机器上，当我运行代码行打开与数据库的连接时它失败了：

MyOdbcConnection.Open()

错误是“ERROR [IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified”。

为了尝试修复它，我从 MySql 下载了最新的 ODBC 5.2 驱动程序。我下载了 32 位和 64 位的。我进入了 32 位和 64 位的 ODBC 数据源管理器，并为用户 DSN、系统 DSN 和文件 DSN 成功添加了我的数据源。我还可以从 MySql 工作台成功连接到数据库。

这是我的连接字符串。它与另一台工作机器相同，只是使用的是 5.1 驱动程序。

```
Dim MySqlConString As String = "DRIVER={MySQL ODBC 5.2 Driver};" & _ "SERVER=myserver;" & _ "DATABASE=mydb;" & _ "UID=root;" & _ "PASSWORD=mypw;" & _ "OPTION=3" – Jason Shoulders 3 hours ago 
```

尽管能够添加数据源并通过工作台连接到数据库，但我在运行我的 exe 时仍然出现错误。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:34:49.607

显然我需要：

```
DRIVER={MySQL ODBC 5.2w Driver} 
```

看起来很蹩脚。我不确定“w”是从哪里来的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T06:46:55.693

我在 32 位的 Windows XP Pro SP3 下使用 Visual Fox Pro 9.0

我遇到了同样的问题，但 id 不适用于：

Driver={MySQL ODBC 5.2a Driver} 或使用 Driver={MySQL ODBC 5.2w Driver}

有效！！！和：

Driver={MySQL ODBC 5.2 ANSI Driver} 或使用 Driver={MySQL ODBC 5.2 UNICODE Driver}

试试看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T11:27:35.423

您的 32 位程序将找不到 64 位 odbc 驱动程序。尝试在命令窗口中使用以下命令设置 32 位驱动程序

```
%WINDIR%\syswow64\odbcad32.exe 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T08:51:34.390

添加用户、系统和文件 DSN 没有什么意义，因为您的代码没有使用它们中的任何一个。您正在使用通常称为“无 DSN”的连接。如果您使用任何您创建的 DSN，您的连接字符串将是“DSN=my_created_dsn”或 FILEDSN=path_to_file。当您使用“DRIVER={xxx}”时，您所做的只是告诉 ODBC 驱动程序管理器要加载哪个驱动程序，连接字符串中的其他属性告诉驱动程序要连接到哪个 mysql 数据库。您用于 xxx 的名称必须与 odbc 驱动程序选项卡中显示的驱动程序名称完全相同。如果您要继续这样连接，您可以删除所有 DSN。

# android - Robotium 在最新的 4.2 Jelly-bean 上抛出 NullPointerException

> ID：13688586
> 
> 赞同：1
> 
> 时间：2012-12-03T17:31:06.610
> 
> 标签：android, robotium, android-4.2-jelly-bean

在最近的果冻豆更新之后，我开始在我的 Robotium 测试中看到 java.lang.RuntimeException: java.lang.NullPointerException at com.jayway.android.robotium.solo.Searcher.searchFor(Searcher.java:107)填写用户名文本字段并登录到应用程序。相同的测试在 4.0.2 和模拟器上运行良好（未修改）。我在这里询问是否有其他人遇到问题或有任何解决方法。我正在运行 Robotium 3.5.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:37:54.163

我刚刚更新到最新的 Robtium 3.6，它似乎解决了这个问题。

# null - 如何正确比较可空字段是否相等？

> ID：13688587
> 
> 赞同：1
> 
> 时间：2012-12-03T17:31:07.337
> 
> 标签：null, nullable, teradata, coalesce

`coalesce()`在任何数据库中，比较可空字段是否相等似乎是一种常见做法。例如，如果您要比较两个可为空的字符串字段，您可以使用`where coalesce(tbl1.stringfield,'') = coalesce(tbl2.stringfield,'')`. 这是有效的，因为转换的空字符串在`''`上下文中可以很好地转换为`null`.

但是，如果您正在处理没有“空”等价物的日期或数字等数据类型怎么办？在 Teradata 中，如果您尝试`where coalesce(tbl1.numberfield,'') = coalesce(tbl2.numberfield,'')`，如果其中一个字段不为空，则会收到数据类型不匹配错误。这是因为它试图将数字与空字符串进行比较。要让它工作，你必须使用`where coalesce(tbl1.numberfield,0) = coalesce(tbl2.numberfield,0)`. 但是，如果 tbl1.numberfield 为 null 而 tbl2.numberfield 实际上包含 0 的值怎么办？WHERE 条件将返回 true，而实际上它应该返回 false，因为一个值为 null，另一个为 0。我能看到的唯一解决方法是这个非常笨拙的案例逻辑：

```
where case
    when 
        (tbl1.numberfield is null and tbl2.numberfield is null) or
        (tbl1.numberfield is not null and tbl2.numberfield is not null) or
        tbl1.numberfield <> tbl2.numberfield
    then 1
    else 0
end = 1 
```

并且认为如果允许将两个空值与一个简单的等号进行比较，那么所有这些都可以避免。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:34:47.050

为什么不只是

```
SELECT * FROM TABLE A, TABLE2 B WHERE A.a = B.a or ( A.a is NULL and b.A is NULL) 
```

这是检查我熟悉的可空字段的公平性的标准，它应该适用于所有情况。它对读者来说更直接，应该运行得更快。

# python - 从文本文件中提取数据

> ID：13688598
> 
> 赞同：-2
> 
> 时间：2012-12-03T17:31:23.367
> 
> 标签：python, string, text-processing

Python新手，有一个非常基本的问题：

我有一个文本文件，其格式类似于以下示例（第一个数字是日期，第二个数字是与之相关的值）：

```
4.12\. -11
5.12\. 24
6.12\. 192
7.12\. -34
8.12\. 921 
```

我需要一种从文本文件中找到“值”以供进一步使用的方法。这些值几乎可以是任何东西——只要它们是数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:40:24.887

要在文件中逐行循环，请尝试：

```
with open('filename') as fin:
    for line in fin:
        print line 
```

然后，这是一个从字符串中获取值的示例：

```
>>> s = '4.12\. -11'
>>> s.rsplit(' ', 1)
['4.12.', '-11'] # two elements 
```

然后是索引：

```
value = s.rsplit(' ', 1)[1]
# '-11' 
```

但这给出了一个字符串，所以这里是一个整数的转换：

```
myval = int(value)
# -11 
```

那是拼图的碎片，把它们放在一起并不难......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:50:03.883

如果您只有一个由空格数分隔的值（准确地说是空格字符）：

```
data = {}

with open('filename') as f:
    for line in f:
        row = line.split()
        data[row[0]] = row[1] 
```

假设：第一列中的键是唯一的。

现在您可以访问`data[value]`以获取值，例如：

```
>>> print data['8.12.']
921 
```

如果每个键/日期可以有多个值，则：

```
from collections import defaultdict

data = defaultdict(list)

with open('filename') as f:
    for line in f:
        row = line.split()
        data[row[0]].append(row[1]) 
```

现在数据将是一个字典，值将是在文件中找到的所有值的列表。因此对于文件：

```
1.1\. 10
2.1\. 11
1.1\. 12 
```

将`data['1.1']`是`["10", "12"]`

您可能必须添加字符串到数字的转换才能完全满足您的要求：

```
data[row[0]] = int(row[1]) 
```

或者：

```
data[row[0]] = float(row[1]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:43:09.643

使用[正则表达式](http://docs.python.org/2/library/re.html)应该让你开始......

```
#!/usr/bin/env python

import re
lines = ["4.12\. -11",
    "5.12\. 24",
    "6.12\. 192",
    "7.12\. -34",
    "8.12\. 921"]

regexp=re.compile("^(?P<day>\d+)\.(?P<month>\d+)\.\s+(?P<val>-*\d+(\.\d+)*)")

if __name__ == "__main__":
    for line in lines:
        matcher = regexp.match(line)
        if regexp.match(line):
            print "%s-%s:%s" % (matcher.group("day"), matcher.group("month"), matcher.group("val")) 
```

# scheme - 跟踪棋盘游戏中的动作

> ID：13688606
> 
> 赞同：0
> 
> 时间：2012-12-03T17:31:53.017
> 
> 标签：scheme, mit-scheme

我正在 MIT Sceheme 中创建一个国际象棋游戏。我想创建一个程序来跟踪所有部分的移动。

这是一个例子。我让车上移 5 格。我的下一回合我希望它向后移动 5 个空格。问题是，我不知道如何跟踪我在前一回合中向前移动的棋子——因此我不知道如何将它向后移动。我目前能做的就是拿下整个棋盘的状态。我假设我需要使用某种类型的突变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:41:04.877

尝试跟踪列表中所有先前的移动——就`cons`在你最近的移动（以及告诉你哪一块执行移动的符号）到移动日志列表中，并将它与你的程序一起传递。如果由于某种原因您需要查找最近的移动，则可以简单地向后搜索列表几步，如果您想跟踪游戏，这将为您提供一些附加功能。

如果您想分享您的一些代码，我将编辑此答案，并提供更具体的实施细节。

# cookies - 自 2011 年 5 月 26 日起实施的新 cookie 政策是否得到执行？

> ID：13688608
> 
> 赞同：1
> 
> 时间：2012-12-03T17:32:07.517
> 
> 标签：cookies, enforcement

我知道有人提出了新的 cookie 法（请参见[此处](http://www.ico.gov.uk/for_organisations/privacy_and_electronic_communications/the_guide/cookies.aspx)）。但它曾经成为必需品吗？不遵守的处罚是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-25T18:43:18.033

> 我们在您的计算机上放置了 cookie，以帮助使本网站变得更好。您可以随时更改您的 cookie 设置。否则，我们将假定您可以继续。

ICO 的网站现在显示用户必须选择退出，而不是选择加入。上面的引用显示了他们如何在他们的网站上实施它。

这意味着最好的主意可能是在您的网站顶部放置一个横幅，显示与他们的相似的信息。如果用户不想使用 cookie，他们可以自己在浏览器中禁用它们。看来，实施 cookie 删除策略并不取决于网站所有者。

# vb.net - 排序结果（查找方法）不起作用

> ID：13688609
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:32:10.517
> 
> 标签：vb.net, geolocation, arcgis

我正在使用 ArcGIS。我试图在找到数据后手动对数据进行排序。我创建了一个属性类并循环遍历一个 Tlist 以清理不需要的数据。然而，在它绑定到数据网格之前，我收到了一个转换错误。我认为有些东西会返回空值。我错过了什么吗？

```
 Public Class temp
    Public Sub New()
    End Sub
    Public Property DisplayFieldName As String
    Public Property Feature As ESRI.ArcGIS.Client.Graphic
    Public Property FoundFieldName As String
    Public Property LayerId As Integer
    Public Property LayerName As String
    Public Property Value As Object
End Class

Public Class templst
    Public Sub New()
        Dim findresult = New List(Of temp)
    End Sub
    Private _findresult = findresult
    Public Property findresult() As List(Of temp)
        Get
            Return _findresult
        End Get
        Set(ByVal value As List(Of temp))
            _findresult = value
        End Set
    End Property
End Class

Private Sub FindTask_Complete(ByVal sender As Object, ByVal args As FindEventArgs) 
        Dim newargs As New templst() 'puts Tlist (temp) into property
        Dim templistNUMONLY As New List(Of temp) 'Tlist of temp
            For Each r In args.FindResults 'class in compiled dll.
                 If Regex.Match(r.Value.ToString, "[0-9]").Success Then
                templistNUMONLY.Add(New temp() With {.LayerId = r.LayerId,
                                              .LayerName = r.LayerName,
                                              .Value = r.Value,
                                              .FoundFieldName = r.FoundFieldName,
                                              .DisplayFieldName = r.DisplayFieldName,
                                              .Feature = r.Feature})
                 End If
            Next

        newargs.findresult = templistNUMONLY

            Dim sortableView As New PagedCollectionView(newargs.findresult)
            FindDetailsDataGrid.ItemsSource = sortableView 'populate lists here
        End Sub 
```

在此处绑定到网格：（此处错误）

```
Private Sub FindDetails_SelectionChanged(ByVal sender As Object, ByVal e As SelectionChangedEventArgs)
        ' Highlight the graphic feature associated with the selected row
          Dim dataGrid As DataGrid = TryCast(sender, DataGrid)

          Dim selectedIndex As Integer = dataGrid.SelectedIndex
           If selectedIndex > -1 Then
          '''''''''''''''''CAST ERROR HERE:
           Dim findResult As FindResult = CType(FindDetailsDataGrid.SelectedItem, FindResult) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:49:50.530

您填充`FindDetailsDataGrid`了 type 的对象`temp`，但您尝试将其强制转换为 type `FindResult`。你应该做：

```
Dim selectedTemp As temp = CType(FindDetailsDataGrid.SelectedItem, temp)
'*Create find result from selected temp object here* 
```

# r - 如何将两个变量函数的输出存储为矩阵

> ID：13688621
> 
> 赞同：1
> 
> 时间：2012-12-03T17:32:28.440
> 
> 标签：r

我在 R 中构造了一个两个变量整数值函数`f(x,y)`，该函数仅针对单个条目进行了明确定义（例如，不是`f(1,1:5)`）。我正在有效地寻找一个整数值函数`F(x,y,z,w)`，它会给出输出：

`f(x,y),f(x,y+1),...,f(x,w),f(x+1,y),f(x+1,y+1),...,f(x+1,w),...,f(z,y),f(z,y+1),...,f(z,w)`

作为`(z-x+1) by (w-y+1)`矩阵。为任何帮助干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:34:32.027

`outer`似乎是你在这里寻找的东西。

```
# make a simple function
f <- function(x, y){x+y}
x <- 3
z <- 5
y <- 2
w <- 7
outer(x:z, y:w, f)
#     [,1] [,2] [,3] [,4] [,5] [,6]
#[1,]    5    6    7    8    9   10
#[2,]    6    7    8    9   10   11
#[3,]    7    8    9   10   11   12 
```

如果您的函数确实只能将标量作为输入，那么您可能需要使用它`Vectorize`来使这种方法起作用

```
# Function that can only takes scalars...
f <- function(x, y){if(length(x) > 1 | length(y) > 1) stop('blah'); x + y}
outer(x:z, y:w, f)
#Error in FUN(X, Y, ...) : blah
myvectorizedfun <- Vectorize(f)
outer(x:z, y:w, myvectorizedfun)
#     [,1] [,2] [,3] [,4] [,5] [,6]
#[1,]    5    6    7    8    9   10
#[2,]    6    7    8    9   10   11
#[3,]    7    8    9   10   11   12 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T18:23:15.710

我发现`for`循环是处理这样的矩阵创建的最直接的方法。这是您要执行的操作的基本大纲：

```
F <- function(x,y,z,w) {
    Matrix <- matrix(nrow=z-x, ncol=w-y) # Set dimensions of your matrix
    for(i in 1:(z-x)){                       # Summing over all x
        for (j in 1:(w-y)){                  # Summing over all y
            Matrix[i,j] <- f(i+x,j+y)        # Evaluate and store in matrix
            }}
    Matrix <<- Matrix                    # Assign Matrix outside the function F
    } 
```

# objective-c - 如何为 LLVM 声明打包结构（无填充）？

> ID：13688625
> 
> 赞同：20
> 
> 时间：2012-12-03T17:32:43.937
> 
> 标签：objective-c, c, struct

可以告诉 GCC 它不应该对结构使用填充。这是使用`__attribute__((packed))`.

```
typedef struct {

  uint8_t startSymbol;
  uint8_t packetType;
  uint32_t deviceId;
  uint16_t packetCRC;

} PacketData __attribute__((packed)); 
```

但是，最新的 Xcode 使用 LLVM 并且不识别该属性。如何为 LLVM 定义打包结构？

问题的完整描述可以在[这里找到](https://stackoverflow.com/questions/13687981/union-struct-printing-struct-member-of-type-uint32-t-skips-two-bytes-and-prints/13688246#13688246)

**更新** 我正在使用适用于 iOS 的 Xcode 4.5.1，它使用 Apple LLVM 4.1 编译器。在上面的代码示例中，我在 Xcode 中收到“'packed' attribute ignored”警告。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-03T17:38:30.900

你真的试过了吗？我刚刚在我的机器上对其进行了测试，并`__attribute__((packed))`使用`clang`.

**编辑：**我收到了相同的警告（“警告：未使用的打包属性”）

```
typedef struct {
    int a;
    char c;
} mystruct __attribute__((packed)); 
```

在这种情况下`sizeof(mystruct)`是8。

然而，

```
typedef struct __attribute__((packed)) {
    int a;
    char c;
} mystruct; 
```

工作得很好，`sizeof(mystruct)`是5。

结论：似乎该属性需要在结构标签之前才能使其正常工作。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-08-27T16:58:00.793

您可以使用预处理器指令为结构指定字节对齐，因此编译器不会进行填充：

```
#pragma pack(1)

typedef struct {
char        t1;
long long   t2;
char        t3;
} struct_size_test;

#pragma options align=reset 
```

在 stackoverflow 上查看[这个](https://stackoverflow.com/questions/22955132/structure-padding-compile-flag/25516440#25516440)问题的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-20T20:36:40.570

Linux 上的 clang 3.5 -

```
typedef struct __attribute__((packed)) thing1 { int blah; } 东西一;
```

工作。

# sharepoint - 获取网络分析

> ID：13688627
> 
> 赞同：3
> 
> 时间：2012-12-03T17:32:49.583
> 
> 标签：sharepoint, powershell, sharepoint-2010, powershell-2.0

有什么方法可以使用 Powershell 在 SharePoint 2010 中导出 Web 分析？

以下链接显示了我想在（Web 集合和站点集合）级别检索的数据示例。

[http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?List=56f96349%2D3bb6%2D4087%2D94f4%2D7f95ff4ca81f&ID=250&Web=48e6fdd1%2D17db%2D4543%2Db2f9%2D6fc7185484fc](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?List=56f96349-3bb6-4087-94f4-7f95ff4ca81f&ID=250&Web=48e6fdd1-17db-4543-b2f9-6fc7185484fc)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T02:16:22.897

您可能可以从 Analytics Reporting[数据库](http://technet.microsoft.com/en-us/library/cc678868.aspx)中导出。

默认数据库名称 =“Search_Service_Application_AnalyticsReportingStoreDB_[GUID]”

# database - 在 linq 搜索中过滤掉空值

> ID：13688631
> 
> 赞同：-1
> 
> 时间：2012-12-03T17:33:05.137
> 
> 标签：database, linq, linq-to-sql

我正在建立一个处理书籍和期刊的图书馆。我有一个 winform，用户可以在其中输入一些参数以在库数据库上进行搜索。我不知道他选择插入哪个值。

例如：

```
public abstract class Item : IComparer, IEnumerable
{
    public string Name { get; set; }
    public string Publisher { get; set; }
    public double Price { get; set; }
    public double Discount { get; set; }
    public DateTime ReleaseDate { get; set; }
} 
```

这是我的基类。当用户可以插入按名称搜索时（翻译成书名）。UI 有许多可供搜索的选项，并且基本上包括一本书包含的几乎所有字段。

我需要做的是只过滤掉用户插入的字段，将它们传递给我的 DAL，以便他可以使用 LINQ 查询对实体框架映射的数据库执行搜索。

这是我到目前为止的搜索：

```
public List<Books> SelectBookFromDB(Item itemType)
{
    BookVO book = itemType as BookVO;
    var result = myEntities.Books.Where(x =>
                                        x.Author == book.Author &&
                                        x.Discount == book.Discount &&
                                        x.Name == book.Name &&
                                        x.Publisher == book.Publisher).ToList();              
    return result;
} 
```

问题是，我正在搜索一些可能为空的值。这样，我的搜索总是空的:(我不知道如何继续。希望得到一些帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:38:08.123

使用不止一个步骤来生成查询：

```
var result = myEntities.Books;

if(string.IsNullOrWhiteSpace(book.Author) == false)
{
  result = result.Where(x => x.Author == book.Author);
}

if(string.IsNullOrWhiteSpace(book.Name) == false)
{
  result = result.Where(x => x.Name == book.Name);
}

...And so on.

return result; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:52:57.637

更改您的 Item 类，以便每种类型都可以正确地为空：

```
public abstract class Item : IComparer, IEnumerable
{
    public string Name { get; set; }
    public string Publisher { get; set; }
    public double? Price { get; set; }
    public double? Discount { get; set; }
    public DateTime? ReleaseDate { get; set; }
} 
```

这允许每个属性清楚地划分何时具有值和何时不具有值。如果有人想搜索所有正常价格的书籍（意味着折扣 == 0）怎么办？

然后，您可以简单地在结果查询中添加空检查：

```
var result = myEntities.Books.Where(x =>
   (book.Author == null || x.Author == book.Author) &&
   (book.Discount == null || x.Discount == book.Discount) &&
   (book.Name == null || x.Name == book.Name) &&
   (book.Publisher == null || x.Publisher == book.Publisher)).ToList(); 
```

# polynomial-math - 解释二次多项式方程的项

> ID：13688635
> 
> 赞同：0
> 
> 时间：2012-12-03T17:33:46.667
> 
> 标签：polynomial-math

这是一个非常基本的问题，但我以前从未以这种方式考虑过多项式。我想比较从原始数据生成的 C0 + C1x + C2x^2 形式的不同多项式。我不是数学家，所以我以前从来没有解释过多项式背后的理论。例如，如果我生成的 5 个多项式方程中只有 1 个的 c1 为负值（原始数据属于同一类型，但来自 5 个不同的来源），我该如何解释呢？C1 是否受所有数据平均值的影响更大，还是总范围对其影响更大等等。我想要一种方法来解释每个术语（C0、C1、C2）受什么影响最大。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:41:41.967

我以前也从未以这种方式考虑过多项式。对于特定的公式可能会有更好的解释。但我不认为，有一个普遍的解释。这可能有帮助吗？

`f(x) = C0 + C1*x + C2*x*x`

*   `C0`: 常数项。`f(0) = C0`
*   `C1`: 线性项。`f(x)`大约`C0+C1*x`是小`x`
*   `C2`: 二次项。`f(x)`大约`C2*x*x`是大`x`

# xml - KML 文档有效，但以编程方式编写时，编码错误？

> ID：13688641
> 
> 赞同：0
> 
> 时间：2012-12-03T17:34:12.703
> 
> 标签：xml, kml, google-earth

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
<Document>
    <name>cwvtrial.kml</name>
    <Placemark>
        <name>PawneeNationalGrasslandBirdingLoop</name>
        <Point>
            <coordinates>-104.336274,40.642254,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>PawneeButtes</name>
        <Point>
            <coordinates>-104.00072,40.814517,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>TamarackRanchStateWildlifeArea</name>
        <Point>
            <coordinates>-102.804758,40.822466,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>RedLionJumboReservoirStateWildlifeArea</name>
        <Point>
            <coordinates>-102.669417,40.896904,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>PrewittReservoirStateWildlifeArea</name>
        <Point>
            <coordinates>-103.328779,40.430521,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>JacksonLake</name>
        <Point>
            <coordinates>-104.096527,40.391156,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>SouthPlatteRiverEagleDrivingTour</name>
        <Point>
            <coordinates>-103.826038,40.266986,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>GreaterPrairieChickenLeks</name>
        <Point>
            <coordinates>-102.219793,40.238643,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>BonnyLakeStateParkSouthRepublicanSWA</name>
        <Point>
            <coordinates>-102.255351,39.620417,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>FlaglerReservoirStateWildlifeArea</name>
        <Point>
            <coordinates>-102.994292,39.293958,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>LimonWetland</name>
        <Point>
            <coordinates>-103.677844,39.258691,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>SimlaPronghornLoop</name>
        <Point>
            <coordinates>-104.033625,39.160838,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>KinneyStateWildlifeArea</name>
        <Point>
            <coordinates>-103.43689,38.906778,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>FountainCreekRegionalPark</name>
        <Point>
            <coordinates>-104.726281,38.722361,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>ChicoBasin</name>
        <Point>
            <coordinates>-104.345359,38.651998,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>RockyFordStateWildlifeArea</name>
        <Point>
            <coordinates>-103.682054,38.065433,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>AdobeCreekReservoirStateWildlifeArea</name>
        <Point>
            <coordinates>-103.268029,38.256757,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>QueensStateWildlifeArea</name>
        <Point>
            <coordinates>-102.722507,38.334479,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>WillowCreekPark</name>
        <Point>
            <coordinates>-102.61408,38.077685,0</coordinates>
        </Point>
    </Placemark>
    <Placemark>
        <name>JohnMartinReservoirStateWildlifeArea</name>
        <Point>
            <coordinates>-102.988342,38.034914,0</coordinates>
        </Point>
    </Placemark>
</Document>
</kml> 
```

所以当我取出文档标签下的第一个名字标签时，我得到了这个工作。当我尝试使用另一个文件（对我来说看起来完全一样）时，真正的问题出现了，该文件是通过用 Java 程序解析 xml 文档来创建的。我可以加载在记事本中创建的文件，但是当我尝试加载程序生成的文件时会出现格式不正确的错误。与我的编码有关吗？但我不知道如何改变它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:39:16.687

将文件重命名为 xml，然后在 Internet 浏览器或任何其他 Xml 编辑器中打开。然后你看看你是否有不匹配的打开关闭标签的问题。

我检查了你的文件，它有效！

黄色标记，美国地标。一切都好。检查您的 Google 地球安装。

请注意：要在谷歌地图上显示 km lfile，该文件必须位于公共可访问的 URL 上。谷歌地球没有这个限制

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:47:05.480

我发现了问题。这是不匹配的标签。让你感觉很笨，但似乎在编程中经常发生。容易错过的小事。所以一定要检查好标签。根本不是编码。

# java - 如何验证配置的ip是否在配置的ip范围内

> ID：13688642
> 
> 赞同：0
> 
> 时间：2012-12-03T17:34:12.657
> 
> 标签：java

```
Range of Ip = 10.18.2.0 to 10.18.54.42
Configured Ip = 10.18.54.40 
```

我应该检查 ip`10.18.54.40`介于`10.18.2.0`to `10.18.54.42` Code 应该返回 true 因为我的 ip 介于范围之间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:54:00.443

您还没有在示例中提到 IP 地址是如何存储的，如果它已经是一个整数，您可以直接比较：

```
if(lowIP <= currentIP && currentIP <= highIP) { .... } 
```

如果它保存在`String`变量中，则必须将其拆分为整数部分并将它们组合成一个 4 字节整数。

```
String ip_addr  = .... ;
int[] ip_parts  = new int[4]; 
int index = 0;

for(String s : ip_addr.split(".")) {
   ip_parts[index++] = Integer.parseInt(s);
}

int final_ip = ip_parts[0] << 24 | ip_parts[1] << 16 | ip_parts[2] << 8 | ip_parts[3] 
```

例子：

```
ip    = "192.168.0.1"
parts = [192,      168,       0, 1]               (base 10)
      = [1100000,  10100000,  00000000, 00000001] (base 2)

final_ip = 1100000 10100000 00000000 00000001 (base 2)
         = 3231711232                         (base 10) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:41:42.403

步骤 1)`byte[]`使用获取所有 IP 地址`InetAddress`

步骤 2) 将所有 byte[] 转换为`long`

步骤 3) ip1 < 已配置 < ip2

给你...

# android - 不要更改android应用程序中的布局

> ID：13688644
> 
> 赞同：0
> 
> 时间：2012-12-03T17:34:18.677
> 
> 标签：android

我更改了布局的eclipse背景并添加了新视图（按钮）。

我启动了我的应用程序，但在模拟器中没有任何改变！

我能做什么？也许这是一个 Eclipse 错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:44:35.973

我从网上下载了这个项目。最初它有黑色背景。我添加了新视图 - 一切正常。但是在我开始改变背景之后 - 并出现了这个错误

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:color/white"
    android:orientation="vertical" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <EditText
        android:id="@+id/txtInd"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10" >

        <requestFocus />
    </EditText>

 <ListView 
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    </ListView>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:48:36.500

每当您想再次测试应用程序时，请勿在模拟器中单击应用程序的图标。但是，选择您的项目，然后单击![在此处输入图像描述](../Images/3c06e3d3d94e40923b770419746c9a69.png)

如果这不起作用。尝试从以下位置清理您的项目：`Project`>>>`Clean`

# java - 使用改进命名策略创建表时出错

> ID：13688645
> 
> 赞同：0
> 
> 时间：2012-12-03T17:34:20.207
> 
> 标签：java, spring, hibernate, postgresql, spring-mvc

我的 pojo 看起来像这样：

```
@Entity
@Table(name = "USERS")
public class User { 
```

当我将名称保留在那里时，一切正常，休眠 sql 日志：

```
 create table users (id int8 not null, username varchar(255), primary key (id)) 
```

当我删除注释时，我得到：

```
Hibernate: create table user (id int8 not null, username varchar(255), primary key (id))
19:24:43 [localhost-startStop-23] ERROR o.h.tool.hbm2ddl.SchemaExport - HHH000389: Unsuccessful: create table user (id int8 not null, username varchar(255), primary key (id))
19:24:43 [localhost-startStop-23] ERROR o.h.tool.hbm2ddl.SchemaExport - ERROR: syntax error at or near "user" Position: 14 
```

我正在尝试使用它，因为它在我的 xml 中定义：

```
<property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy" /> 
```

任何建议，为什么命名策略不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T17:53:42.940

默认表名`USER`是保留关键字。在这种情况下，您必须`name`明确指定才能为其添加必要的转义：

```
@Entity
@Table(name = "`USER`")
public class User { ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:52:23.033

PostgreSQL 关键字列表：

[http://www.postgresql.org/docs/9.1/static/sql-keywords-appendix.html](http://www.postgresql.org/docs/9.1/static/sql-keywords-appendix.html)

> 标记为“保留”的是那些不允许作为列名或表名的标记。

还有你的表名：

> 用户保留

实际上是保留的。

所以你不能创建`user`在 PostgreSQL 中命名的表。这就是为什么使用注解一切正常，因为注解指定了 name `users`。没有这样的关键字。

# javascript - Backbone：模型 id 的集合到一个数组

> ID：13688648
> 
> 赞同：2
> 
> 时间：2012-12-03T17:34:35.573
> 
> 标签：javascript, backbone.js

它是主干中的一种方法，它将采用模型集合并在模型中创建模型 ID 或任何其他指定属性的数组？

我可以在 console.log 中列出模型的 is，但不确定如何从中创建数组

```
for (var i=0; i<collection.models.length; i++){ 
   console.log(collections.models[i].id) 
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T17:38:13.240

您可以为此使用下划线方法[`pluck`](http://backbonejs.org/#Collection-pluck)：

```
collection.pluck("id"); 
```

[http://jsfiddle.net/upqqL/](http://jsfiddle.net/upqqL/)

* * *

`pluck`UnderscoreJS[文档](http://underscorejs.org/#pluck)的描述：

> map 最常见用例的一个方便版本：提取属性值列表。

# javascript - 如何在 ember + jasmine 中模拟路由器状态

> ID：13688650
> 
> 赞同：1
> 
> 时间：2012-12-03T17:34:39.880
> 
> 标签：javascript, ember.js, jasmine

在我的 jasmine 测试套件中，我想将我的路由器导航到正确的状态。像这样的东西：

```
 describe("The Router", function(){
        beforeEach(function(){
            router = App.Router.create();
            router.transitionTo('foo.bar');
        }
    }); 
```

但如果我这样做，我会得到一个`Cannot call method 'disconnectOutlet' of undefined`错误。发生这种情况是因为我在打电话

```
 bar: Ember.Route.extend({      
        connectOutlets: function(router, context){
          router.get('applicationController').connectOutlet('bla', 'blub');
        }
      }), 
```

在这个路由器过渡。我试图以某种方式初始化我的 applicationController

```
applicationController = App.ApplicationController.create(); 
```

但它不会改变错误。那么我怎样才能模拟到正确的路由器状态呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T15:18:22.623

你今天如何用茉莉花测试这个？您是要浏览每个更改还是尝试使用 jasmine-phantom-node / jasmine-node 之类的命令行运行它？

一个示例可能如下所示。在下面的设置中，我正在测试一个视图，但相同的模拟/间谍想法适用于您上面的路由器示例。

```
require('static/script/vendor/filtersortpage.js');
require('static/script/app/person.js');

describe ("PersonApp.PersonView Tests", function(){

  var sut, router, controller;

  beforeEach(function(){
    sut = PersonApp.PersonView.create();
    router = new Object({send:function(){}});
    controller = PersonApp.PersonController.create({});
    controller.set("target", router);
    sut.set("controller", controller);
  });

  it ("does not invoke send on router when username does not exist", function(){
    var event = {'context': {'username':'', 'set': function(){}}};
    var sendSpy = spyOn(router, 'send');
    sut.addPerson(event);
    expect(sendSpy).not.toHaveBeenCalledWith('addPerson', jasmine.any(String));
  });

  it ("invokes send on router with username when exists", function(){
    var event = {'context': {'username':'foo', 'set': function(){}}};
    var sendSpy = spyOn(router, 'send');
    sut.addPerson(event);
    expect(sendSpy).toHaveBeenCalledWith('addPerson', 'foo');
  });

  it ("does not invoke set context when username does not exist", function(){
    var event = {'context': {'username':'', 'set': function(){}}};
    var setSpy = spyOn(event.context, 'set');
    sut.addPerson(event);
    expect(setSpy).not.toHaveBeenCalledWith('username', jasmine.any(String));
  });

  it ("invokes set context to empty string when username exists", function(){
    var event = {'context': {'username':'foo', 'set': function(){}}};
    var setSpy = spyOn(event.context, 'set');
    sut.addPerson(event);
    expect(setSpy).toHaveBeenCalledWith('username', '');
  });
}); 
```

如果您想在某些上下文中查看它，[这里是一个真实项目中的茉莉花测试](https://github.com/toranb/ember-django-rest/blob/master/ember/static/script/tests/people.spec.js)

这是被测视图（帮助理解上述茉莉花测试）

```
PersonApp.PersonView = Ember.View.extend({
  templateName: 'person',
  addPerson: function(event) {
    var username = event.context.username;
    if (username) {
      this.get('controller.target').send('addPerson', username);
      event.context.set('username', '');
    }
  }
}); 
```

# makefile - Makefile 的良好实践

> ID：13688651
> 
> 赞同：7
> 
> 时间：2012-12-03T17:34:41.063
> 
> 标签：makefile

我的项目中有以下目录结构：

```
bin/
dist/
include/
├── module_a/
└── module_b/
Makefile
src/
├── module_a/
└── module_b/ 
```

文件夹`include/`包含`*.hpp`'s while `*.cpp`'s are in `src/`。我想将所有源代码编译到`bin/`，然后将它们链接到`dist/`. 对我来说似乎是一个非常合理的愿望。

我想知道这种情况下 Makefile 的最佳实践。我只能找到`%.o: %.cpp`目标，但这并没有真正起作用，因为不同的源和二进制文件夹。

我试图使用这样的东西：

```
D_SRC = src
D_BIN=bin

F_CPP   :=  $(shell find $(D_SRC) -iname '*.cpp' -type f)
F_OBJ   :=  $(shell echo $(F_CPP) | sed s:\ :\\n:g | sed s:$(D_SRC):$(D_BIN): | sed 's:^\(.*\)\.cpp$$:\1\.o:')

$(F_OBJ): $(F_SRC)                                                                  
    $(foreach file, $(F_SRC), \                                                     
        $(GXX) $(CXXFLAGS) -c $(file)\                                              
    ) 
```

这个目标不起作用，因为`$(F_OBJ)`路径以 , 开头`bin/`，同时`foreach`将源编译到当前工作目录。我可以让它编译成`bin/`，但这只会发生在更多`sed`的表达式上，而且它已经够丑了。

这对我来说可能很困难，因为我不是很了解`make`，但我不能成为唯一一个拥有这个项目设置的人。在我看来，这一定是一个很常见的问题。我知道我可以`Makefile`为每个模块单独编写一个，但这真的是最好的选择吗？

编辑：我现在想知道使用几个 Makefile 可以实现什么。如果一个在根，另一个在根，`src/module_a`后者怎么知道`bin/`？如果你用 执行它`make -f src/module_a/Makefile`，它与从根目录执行它是一样的，因为它的工作目录是根目录。我猜另一种方法是在执行之前更改目录，例如：`make -C include/module_a`，但在这种情况下，它会如何找到`bin/`？我不想`D_BIN = ../../bin`在 Makefile 中有类似的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T19:55:34.087

我通常做的是在 src 目录中有一个 Makefile（如果你愿意，可以从顶层 Makefile 调用它），然后使用如下规则：

```
D_BIN = ../bin
$(D_BIN)/%.o: %.cpp 
```

您还可以在顶级目录中仅使用 makefile 进行试验，并使用如下所示的规则：

```
D_BIN = bin
D_SRC = src
$(D_BIN)/%.o: $(D_SRC)/%.cpp 
```

但我没有使用过这样的规则，所以我不知道我通常这样做的利弊。我通常这样做的方式很好，我什至有建立的规则取决于这样：

```
$(D_BIN)/%.d: %.cpp 
```

链接规则如下：

```
../dist/outexe: $(F_OBJ) 
```

使用 foreach 通常是不受欢迎的，因为它没有利用内置在正常 makefile 规则中的所有功能（即，没有基于每个文件的依赖检查，要么构建所有内容，要么什么都不构建），因此 foreach 应该只用作最后的手段，但在这种情况下，您将能够在没有 foreach 的情况下使其工作。

除此之外，还有更简单的方法来构建您的文件列表，您不需要使用 shell 或 sed。

```
F_CPP = $(wildcard *.cpp)
F_OBJ = $(F_CPP:.cpp=.o) 
```

更新：这就是我通常发出递归的方式：

```
SUBDIRS = src
.PHONY: $(SUBDIRS)
all: $(SUBDIRS)

$(SUBDIRS):
    @echo "Building $@..."
    $(MAKE) -C $@ $(MFLAGS) 
```

然后确实在您的子制作中，您将需要使用 ../bin 例如。

但是，对于像您这样简单的项目，您最好只在根级别拥有一个 makefile 并使用如下规则：

```
D_BIN = bin
D_SRC = src
$(D_BIN)/%.o: $(D_SRC)/%.cpp 
```

如果您有一个非常复杂的目录结构，那么递归生成文件是可以的（可以但不是很好），随着时间的推移，您将在其中添加/删除/修改新的目录树。但是对于一个简单的项目，您只想为代码和 obj 提供单独的目录，这可能是矫枉过正。

# html - 奇怪的白色间隙和水平滚动问题

> ID：13688652
> 
> 赞同：1
> 
> 时间：2012-12-03T17:34:41.720
> 
> 标签：html, css, z-index, gaps-in-visuals

看来我正在处理的设计有问题。我正在使用 kickstart HTML 框架，但有几个问题。

首先是我的页面顶部（徽标，导航栏）和文本之间有一个非常大的白色间隙。

其次，我尝试使用 z-index 将徽标覆盖在导航栏上。但是，它会导致负水平滚动。我试图通过隐藏 overflow-x 来隐藏它，但它似乎并不是最好的解决方案。

[您可以在http://jkr.me.uk/problem.html](http://jkr.me.uk/problem.html)查看问题

谢谢，

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:38:17.543

在徽标上使用 position: relative 会占用您要引用的空间。

相反，使用 float:right 或使用 position: absolute; 定位它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:11:55.883

白色间隙的问题是图像。如果禁用该`position:relative`属性，图像底部将接触第一个标题标签的上边距。对此的肮脏修复将类似于`margin-top: -200px`第一个标题或`margin-bottom: -200px`徽标图像。您也可以使用上一个回答者的方法。

至于覆盖导航栏的徽标图像，它在 Chrome 和 IE 9 中都适用。

# android - AlertDialog 中的随机崩溃

> ID：13688653
> 
> 赞同：1
> 
> 时间：2012-12-03T17:34:43.483
> 
> 标签：android, android-layout, exception

我的 Android 应用程序有一些奇怪的问题。我正在创建`AlertDialog`两个`EditText`控件和一些按钮（编辑现有对象）。

```
@Override
public void onClick(View arg0) {
    AlertDialog.Builder alert = new AlertDialog.Builder(mContext);

    final View dialogLayout = mInflater.inflate(R.layout.event_edit, null);
    alert.setView(dialogLayout);

    ((EditText)dialogLayout.findViewById(R.id.txtCompany)).setText(cEvent.getCompany());
    ((EditText)dialogLayout.findViewById(R.id.txtCity)).setText(cEvent.getCity());

    alert.setTitle(R.string.DialogEditEventTitle);
    alert.setPositiveButton(R.string.DialogEditEventDelete,
            new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int id) {
            // Delete action
        }
    });

    alert.setNeutralButton(R.string.DialogEditEventSave,
            new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int id) {
            // Save
        }
    });

    alert.setNegativeButton(R.string.DialogEditEventCancel,
            new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int id) {
            // Cancel action
        }
    });
    AlertDialog dialog = alert.show();
    dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);

} 
```

如果我尝试改变焦点或放置一些东西来编辑文本字段，那么我会得到异常：

```
12-03 14:32:25.663 E/AndroidRuntime( 5074): FATAL EXCEPTION: main
12-03 14:32:25.663 E/AndroidRuntime( 5074): java.lang.IllegalArgumentException: parameter must be a descendant of this view
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.view.ViewGroup.offsetRectBetweenParentAndChild(ViewGroup.java:2627)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.view.ViewGroup.offsetDescendantRectToMyCoords(ViewGroup.java:2564)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.view.ViewRoot.scrollToRectOrFocus(ViewRoot.java:1508)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.view.ViewRoot.draw(ViewRoot.java:1249)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1163)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1727)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.os.Looper.loop(Looper.java:123)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at android.app.ActivityThread.main(ActivityThread.java:4627)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at java.lang.reflect.Method.invokeNative(Native Method)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at java.lang.reflect.Method.invoke(Method.java:521)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:871)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:629)
12-03 14:32:25.663 E/AndroidRuntime( 5074):     at dalvik.system.NativeStart.main(Native Method) 
```

此异常的原因是什么，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:28:55.210

Please try;

```
//first create, set soft input mode and then show//

AlertDialog dialog = alert.create();     
dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);
dialog.show(); 
```

# powershell - 文档操作：powershell

> ID：13688661
> 
> 赞同：0
> 
> 时间：2012-12-03T17:35:08.430
> 
> 标签：powershell, vbscript, ms-word

我正在尝试获取一个大文档，搜索“^m”（分页符）并为我找到的每个分页符创建一个新的文本文件。

使用：

```
$SearchText = "^m"
$word = new-object -ComObject "word.application"
$path = "C:\Users\me\Documents\Test.doc"
$doc = $word.documents.open("$path")
$doc.content.find.execute("$SearchText") 
```

我能够找到文本，但是如何在分页符之前将文本保存到新文件中？在 VBScript 中，我只会做一个 readline 并将其保存到缓冲区，但 powershell 有很大不同。

编辑：

```
$text = $word.Selection.MoveUntil (cset:="^m") 
```

返回错误：

```
Missing ')' in method call. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T17:34:32.747

我认为我的解决方案有点愚蠢，但这是我自己的解决方案（请帮我找到更好的解决方案）：

```
Param(
[string]$file
)
#$file = "C:\scripts\docSplit\test.docx"

$word = New-Object -ComObject "word.application"
$doc=$word.documents.open($file)
$txtPageBreak = "<!--PAGE BREAK--!>"
$fileInfo = Get-ChildItem $file
$folder = $fileInfo.directoryName
$fileName = $fileInfo.name
$newFileName = $fileName.replace(".", "")

#$findtext = "^m"
#$replaceText = $txtPageBreak

function Replace-Word ([string]$Document,[string]$FindText,[string]$ReplaceText) {

    #Variables used to Match And Replace

    $ReplaceAll = 2
    $FindContinue = 1

    $MatchCase = $False
    $MatchWholeWord = $True
    $MatchWildcards = $False
    $MatchSoundsLike = $False
    $MatchAllWordForms = $False
    $Forward = $True
    $Wrap = $FindContinue
    $Format = $False

    $Selection = $Word.Selection

    $Selection.Find.Execute(
        $FindText,
        $MatchCase,
        $MatchWholeWord,
        $MatchWildcards,
        $MatchSoundsLike,
        $MatchAllWordForms,
        $Forward,
        $Wrap,
        $Format,
        $ReplaceText,
        $ReplaceAll
    )

    $newFileName = "$folder\$newFileName.txt"
    $Doc.saveAs([ref]"$newFileName",[ref]2)
    $doc.close()
}

Replace-Word($file, "^m", $txtPageBreak)

$word.quit()
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($word)
Remove-Variable word

#begin txt file manipulation

#add end of file marker
$eof = "`n<!--END OF FILE!-->"
Add-Content $newfileName $eof

$masterTextFile = Get-Content $newFileName
$buffer = ""
foreach($line in $masterTextFile){
    if($line.compareto($eof) -eq 0){
        #end of file, save buffer to new file, be done
    }
    else {
        $found = $line.CompareTo($txtPageBreak)

        if ($found -eq 1) {
            $buffer = "$buffer $line `n"
        }

        else {
            #save the buffer to a new file (still have to write this part)
        }
    }
} 
```

# java - 表单值在播放框架中的发布请求中为空

> ID：13688668
> 
> 赞同：2
> 
> 时间：2012-12-03T17:35:28.360
> 
> 标签：java, forms, jsp, playframework, playframework-2.0

我有 html 来发回一个表单，如下所示：

```
@(message: String)

@main("Contact") {
<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/contact.css")">
<div id="pageContainer">
    <div id="form">
        <div id="topText">
            <p>Have a question or need some assistance? Let us know and we'll get back to you ASAP.</p>
        </div>
        <br/>
        <form method="POST" action="@routes.Home.contact()">

            <div id="contactInfo">
                <label class="contactLabel">First Name:</label><input type="text" name="firstName" id="firstName" class="contactInput" /> <br />
                <label class="contactLabel">Last Name:</label><input type="text" name="lastName" id="lastName" class="contactInput" /> <br />
                <label class="contactLabel">Email:</label><input type="text" name="email" id="email" firstName" class="contactInput" /> <br />
                <label class="contactLabel">Company:</label><input type="text" id="company" name="company" class="contactInput" /> <br />
                <input type="hidden" id="hidden" name = "hidden"></input>
                <p id="crap">@message</p>
            </div>
            <br/>
            <div id="message">
                <label class="contactLabel">Message:</label><textarea cols="50" rows="10"></textarea>
            </div>
            <input type="submit" name="submit" id="submit" value="Submit"></input>
            </form>
    </div>

</div>

} 
```

回到控制器，它看起来像这样：

```
public static Result contact()
{

    //Map<String,String[]> values = request().body();
    DynamicForm form = form().bindFromRequest();
    String first = "";
    if(form.data().get("firstName") != null)
    first = form.data().get("firstName").toString();

    return ok(views.html.contact.render(first));
} 
```

但是当我查看 的结果时`form().bindFromRequest()`，它总是空的。我错过了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T21:24:46.900

这是我将如何做到的：

**模板**

```
@(message: String, contactForm: Form[Contact])

@import helper._

@main("Contact") {
<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/contact.css")">
<div id="pageContainer">
    <div id="form">
        <div id="topText">
            <p>Have a question or need some assistance? Let us know and we'll get back to you ASAP.</p>
        </div>
        <br/>
        @form(routes.Home.contact()) {
            <div id="contactInfo">
                <label class="contactLabel">First Name:</label> @inputText(contactForm("firstName"), 'class -> "contactInput"') <br />
                <label class="contactLabel">Last Name:</label> @inputText(contactForm("lastName"), 'class -> "contactInput"') <br />
                <label class="contactLabel">Email:</label> @inputText(contactForm("email"), 'class -> "contactInput"') <br />
                <label class="contactLabel">Company:</label> @inputText(contactForm("company"), 'class -> "contactInput"') <br />
                <input type="hidden" id="hidden" name="hidden"></input>
                <p id="crap">@message</p>
            </div>
            <br/>
            <div id="message">
                <label class="contactLabel">Message:</label><textarea cols="50" rows="10"></textarea>
            </div>
            <input type="submit" value="Submit" />
        }
    </div>
</div>
} 
```

**班级联系方式**

```
public class Contact {
    public String firstName;
    public String lastName;
    public String email;
    public String company;
    // other stuff
} 
```

**控制器**

```
public static Result contact() {
    Form<Contact> contactForm = form(Contact.class).bindFromRequest();
    if (contactForm.hasErrors()) {
        // process
    } else {
        // contactForm.get().firstName should be filled with the correct data
        return ok(views.html.contact.render("message", contactForm)); 
    }
} 
```

对你起作用吗 ？您应该查看有关这些主题的 Play2 文档：

1.  [JavaForms](http://www.playframework.org/documentation/2.0.1/JavaForms)
2.  [JavaForm 助手](http://www.playframework.org/documentation/2.0.1/JavaFormHelpers)

**编辑**

> 如果你能解释为什么我以前的*做法*行不通

我不确定，但是我可以在您的代码中看到一个问题，您不必调用`data()`动态表单，直接使用`DynamicForm.get()`就足够了，`first = form.get("firstName")`就足够了。

此外，您可以从[DynamicForm Javadoc中看到](http://www.playframework.org/documentation/api/2.0/java/play/data/DynamicForm.html#get%28java.lang.String%29)

> 获取（java.lang.String 键）
> 
> **如果提交成功，则**获取具体值。

`DynamicForm`如果没有错误，则后面的内部映射具有值，因此您可以`hasErrors`在实际从字段中获取具体值之前进行检查。

从我的角度来看，使用`form(Contact.class).bindFromRequest()`填充 class 实例的样式会更好、更容易`Contact`，这不用说可以使用 Java 注释来验证字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-26T18:17:39.757

您必须提供一个`Request`to`bindFromRequest()`方法。例如

```
 DynamicForm form = form().bindFromRequest(request()); 
```

该`request`函数提供`Request`当前动作的电流。似乎`bindFromRequest`不会自动绑定当前请求

我遇到了同样的问题，谷歌把我带到了这里，希望对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-15T13:22:02.900

也许不是完全相同的问题，但在我开发 Play 2.6 应用程序的 Windows 上，我遇到了类似的问题。绑定不起作用。我的意思是表单的数据字段具有正确的值，但模型的值是空的。这导致没有这样的元素异常：没有值存在。我花了很长时间研究这个。解决这个问题的是清理项目，重新编译并再次运行它。嗯。

# android - seekBar 设置进度抛出空指针异常

> ID：13688672
> 
> 赞同：0
> 
> 时间：2012-12-03T17:35:46.370
> 
> 标签：android

我正在使用 seekBar 对自定义相机应用程序进行缩放控制。我的应用程序有时会删除 cameraPreview 并在重新添加 cameraPreview 时我想重置我的搜索栏的进度。

```
public void restartCam() {

        //zoomCtrl.setVerticalScrollbarPosition(0x00000000);
        camPreview = new CamSurfaceView(this.getApplicationContext(), camFace);
        frame.addView(camPreview);
        zoomCtrl.setProgress(0);
    } 
```

但我得到一个空指针：

```
12-03 12:18:54.319: E/AndroidRuntime(15805): FATAL EXCEPTION: main
12-03 12:18:54.319: E/AndroidRuntime(15805): java.lang.NullPointerException
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.sapientnitro.lcinstore2.view.CamSurfaceView.zoomTo(CamSurfaceView.java:120)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.sapientnitro.lcinstore2.activities.CustomCamera.onProgressChanged(CustomCamera.java:643)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.widget.SeekBar.onProgressRefresh(SeekBar.java:89)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.widget.ProgressBar.doRefreshProgress(ProgressBar.java:609)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.widget.ProgressBar.refreshProgress(ProgressBar.java:621)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.widget.ProgressBar.setProgress(ProgressBar.java:670)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.widget.ProgressBar.setProgress(ProgressBar.java:651)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.sapientnitro.lcinstore2.activities.CustomCamera.restartCam(CustomCamera.java:568)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.sapientnitro.lcinstore2.activities.CustomCamera.cameraOn(CustomCamera.java:435)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.sapientnitro.lcinstore2.activities.CustomCamera$5.onClick(CustomCamera.java:317)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.view.View.performClick(View.java:3558)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.view.View$PerformClick.run(View.java:14157)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.os.Handler.handleCallback(Handler.java:605)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.os.Handler.dispatchMessage(Handler.java:92)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.os.Looper.loop(Looper.java:137)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at android.app.ActivityThread.main(ActivityThread.java:4514)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at java.lang.reflect.Method.invokeNative(Native Method)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at java.lang.reflect.Method.invoke(Method.java:511)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
12-03 12:18:54.319: E/AndroidRuntime(15805):    at dalvik.system.NativeStart.main(Native Method) 
```

我的进度变化：

```
@Override
    public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {

        // TODO Auto-generated method stub
        if (mode.equals("camera")) {
            camPreview.zoomTo(progress);
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-05T07:34:39.017

```
 Please, try this.

    if (zoomCtrl!= null) {
        zoomCtrl.setProgress(0);
    } 
```

# c# - 如何在 MVC 视图中迭代分组的 LINQ 数据

> ID：13688676
> 
> 赞同：2
> 
> 时间：2012-12-03T17:36:06.497
> 
> 标签：c#, asp.net-mvc, linq

我有两张桌子。一个表称为 Occurrence，其中包含以下内容：

```
OccurrenceID | EmployeeID | OccurrenceDate | Points | Comment
-------------------------------------------------------------
1            |1           |2012-01-01      |5       |yada    
2            |1           |2012-02-01      |3       |blah    
3            |2           |2012-03-01      |2       |yada 
```

另一个表称为 Employee 并包含以下内容：

```
EmployeeID | EmployeeName
-------------------------
 1         |Jack
 2         |Jill 
```

我正在尝试将这两个表组合在一起，并最终为每个员工提供一行，这将在我的 MVC 4 项目的视图中显示总点数。所以对于上面的例子，我的输出应该是：

```
Name    | Points
----------------
Jack    |8
Jill    |2 
```

这是我在控制器中尝试过的 LINQ 查询：

```
 var groupedOccurrences = from o in db.Occurrences.Include(o => o.Employee)
                                 where o.OccurrenceDate >= beginDate
                                    && o.OccurrenceDate <= endDate
                                 group o by new {o.EmployeeID, o.Points} into g
                                 select new {
                                     Name = g.Key.EmployeeID,
                                     Total = g.Sum(o => o.Points)
                                 };

        return View(groupedOccurrences); 
```

这是我的观点：

```
@model IEnumerable<PtoTracker.Occurrence>

<table>
    <tr>
        <th>
            Employee
        </th>
        <th>
            Total Pts.
        </th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Employee.EmployeeName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Points)
        </td>
    </tr>
}
</table> 
```

当我导航到此视图时，我收到此错误：

> 传入字典的模型项的类型为“System.Data.Entity.Infrastructure.DbQuery `1[<>f__AnonymousType3`2[System.Int32,System.Int32]]”，但此字典需要类型为“System.Collections.Generic.IEnumerable”的模型项`1[PtoTracker.Occurrence]'。

有人可以帮助我了解我应该做些什么不同的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:39:30.057

您需要新建视图预期类的实例

```
var groupedOccurrences = 
   (from o in db.Occurrences.Include(o => o.Employee)
    where o.OccurrenceDate >= beginDate && o.OccurrenceDate <= endDate
    group o by new {o.EmployeeID, o.Points} into g
    select new { Name = g.Key.EmployeeID, Total = g.Sum(o => o.Points)}
   ).AsEnumerable();

var model = groupedOccurrences.Select(item => new PtoTracker.Occurrence { 
                         Name = item.Name,
                         Total = item.Total }); 
```

您的观点是预期`IEnumerable`的，`PtoTracker.Occurrence`但您发送的`IQuerable`是匿名类型的。

# android - Android SQLite 错误：“没有这样的列：名称……”

> ID：13688680
> 
> 赞同：0
> 
> 时间：2012-12-03T17:36:28.150
> 
> 标签：android, database, sqlite, android-sqlite

我的数据库有问题。我有两列，我的应用程序运行良好，但是当我尝试添加一个新列时，遇到了一个问题：

> 12-03 21:04:33.716: I/SqliteDatabaseCpp(726): sqlite 返回: 错误代码 = 1, msg = 没有这样的列: Content3, db=/data/data/com.example.pp/databases/MY_DATABASE

```
public class SQLiteAdapter {

public static final String MYDATABASE_NAME = "MY_DATABASE";
public static final String MYDATABASE_TABLE = "MY_TABLE";
public static final int MYDATABASE_VERSION = 1;
public static final String KEY_ID = "_id";
public static final String KEY_CONTENT1 = "Content1";
public static final String KEY_CONTENT2 = "Content2";
public static final String KEY_CONTENT3 = "Content3";

//create table MY_DATABASE (ID integer primary key, Content text not null);
private static final String SCRIPT_CREATE_DATABASE =
    "create table " + MYDATABASE_TABLE + " ("
    + KEY_ID + " integer primary key autoincrement, "
    + KEY_CONTENT1 + " text, "
    + KEY_CONTENT2 + " text, "
    + KEY_CONTENT3 + " text);"; 
```

这是一个插入函数

```
public long insert(String content1, String content2, String content3){

    ContentValues contentValues = new ContentValues();
    contentValues.put(KEY_CONTENT1, content1);
    contentValues.put(KEY_CONTENT2, content2);
    contentValues.put(KEY_CONTENT3, content3);
    return sqLiteDatabase.insert(MYDATABASE_TABLE, null, contentValues);
} 
```

这是一个光标

```
public Cursor queueAll(){
    String[] columns = new String[]{KEY_ID, KEY_CONTENT1, KEY_CONTENT2, KEY_CONTENT3};
    Cursor cursor = sqLiteDatabase.query(MYDATABASE_TABLE, columns, 
            null, null, null, null, null);

    return cursor;
} 
```

请帮我确定我的问题。对 Android 开发初学者的帮助 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:34:16.390

如果您在创建时填充表格，或者不需要将表格内容*从*版本 1 保留到下一个版本，则如上所述自动增加表格版本号并将以下内容添加到您的`SQLiteAdapter`：

```
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    if (oldVersion >= newVersion)
        return;
    db.execSQL("DROP TABLE IF EXISTS " + MYDATABASE_TABLE);
    onCreate(db);
} 
```

请注意，这将删除表并重新创建。如果内容必须保留，那么您将不得不编写一个`ALTER TABLE`适合您更改的脚本。

如果表格必须保留，请查看[此 StackOverflow Q&A](https://stackoverflow.com/a/5688175/1134705)以了解如何完成`Alter Table`in `onUpgrade()`。同样，您必须进行修改以满足您对已更改内容的需求，并且下次对数据库进行更改时，您将再次必须增加 DB 版本号并重写以匹配您所做的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:11:33.963

当您更新列或表时，您甚至需要更新数据库版本。如果您的数据库中有多个表，则需要确保文件中数据库的版本号相同。如果版本号存在冲突，则表不会同时更新。

# xml - XSLT 排序日期和数字

> ID：13688683
> 
> 赞同：0
> 
> 时间：2012-12-03T17:36:56.700
> 
> 标签：xml, xslt

如何使用 xslt 对具有数字和日期时间的 xml 数据进行排序，我的 xml 如下所示。我需要来自“日期”节点的最大日期和来自节点“总计”的最大总计我尝试使用下面的片段

**XSLT：**

```
<xsl:for-each select="/Report/Total/DailyPeakDmds/DailyPeakDmd">
    <xsl:sort select="number(Demand1/Total)" data-type="number" order="descending"/>
    <xsl:if test="position() = 1">
        <xsl:value-of select="Demand1/Total"/>
    </xsl:if>
</xsl:for-each> 
```

**XML:**

```
 <DailyPeakDmds>
        <DailyPeakDmd>
          <Date>03-12-11 (NB)</Date>
          <Demand1>
            <Total>0.037</Total>
            <Time>01:19</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.002</Total>
            <Time>01:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-13-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.036</RateB>
            <RateBTime>03:03</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.002</RateB>
            <RateBTime>03:02</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-14-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-15-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-16-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-17-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-18-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
        <DailyPeakDmd>
          <Date>03-19-11 (NB)</Date>
          <Demand1>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand1>
          <Demand2>
            <Total>0.000</Total>
            <Time>00:00</Time>
            <RateA>0.000</RateA>
            <RateATime>00:00</RateATime>
            <RateB>0.000</RateB>
            <RateBTime>00:00</RateBTime>
          </Demand2>
        </DailyPeakDmd>
      </DailyPeakDmds> 
```

**输出：**

```
 <table>
<tr>
          <td class="subsection" >
            Max date          </td>
          <td  class="datavalue">
            <xsl:for-each select="/Report/Total/DailyPeakDmds/DailyPeakDmd">
              <xsl:sort select="Date" data-type="number" order="descending"/>
              <xsl:if test="position() = 1">
                <xsl:value-of select="Date"/>
              </xsl:if>
            </xsl:for-each>
          </td>
        </tr>
<tr>
          <td class="subsection" >
            Max value          </td>
          <td  class="datavalue">
            <xsl:for-each select="/Report/Total/DailyPeakDmds/DailyPeakDmd">
              <xsl:sort select="number(Demand1/Total)" data-type="number" order="descending"/>
              <xsl:if test="position() = 1">
                <xsl:value-of select="Demand1/Total"/>
              </xsl:if>
            </xsl:for-each>
          </td>
        </tr>
</table> 
```

谢谢， 穆拉利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:25:01.677

尝试这个

```
<xsl:for-each select="/Report/Total/DailyPeakDmds/DailyPeakDmd">
  <xsl:sort select="normalize-space(substring(Date,7,2))" order="descending" />
  <xsl:sort select="normalize-space(substring(Date,4,2))" order="descending" />
  <xsl:sort select="normalize-space(substring(Date,0,2))" order="descending" />
  <xsl:if test="position() = 1">
   <xsl:value-of select="Date"/>
   </xsl:if>
</xsl:for-each> 
```

如果 xml 生成是您的，您可以将 xml 编写为

```
 <Date val="20111203">03-12-11 (NB)</Date> 
```

然后可以排序

```
 <xsl:sort select="xs:date(Date/@value)" order="descending" /> 
```

# android - Android 4.0 使用 JSON 登录和注册

> ID：13688689
> 
> 赞同：0
> 
> 时间：2012-12-03T17:37:25.403
> 
> 标签：android, json, android-asynctask

我正在尝试在 Android 4.0 设备上进行登录和重新注册。所以我不得不更新我的代码以使用 Asynctask 并且我遇到了错误并且不知道如何修复它们。任何帮助将不胜感激！

```
public class RegisterActivity extends Activity {
Button btnRegister;
Button btnLinkToLogin;
EditText inputFullName;
EditText inputEmail;
EditText inputPassword;
TextView registerErrorMsg;

//JSON Response node names
private static String KEY_SUCCESS = "success";
private static String KEY_UID = "uid";
private static String KEY_NAME = "name";
private static String KEY_EMAIL = "email";
private static String KEY_CREATED_AT = "created_at";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_register);

    // Importing all assets like buttons, text fields
    inputFullName = (EditText) findViewById(R.id.registerName);
    inputEmail = (EditText) findViewById(R.id.registerEmail);
    inputPassword = (EditText) findViewById(R.id.registerPassword);
    btnRegister = (Button) findViewById(R.id.btnRegister);
    btnLinkToLogin = (Button) findViewById(R.id.btnLinkToLoginScreen);
    registerErrorMsg = (TextView) findViewById(R.id.register_error);

    // Register Button Click event
    btnRegister.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {

            new RegisterTask().execute();
        }
    });

    // Link to Login Screen
    btnLinkToLogin.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {
            Intent i = new Intent(getApplicationContext(),
                    LoginActivity.class);
            startActivity(i);
            // Close Registration View
            finish();
        }
    });
}

class RegisterTask extends AsyncTask<String, String, String> {
int success;
String email;
String password;
String name;

@Override
protected void onPreExecute() {
    super.onPreExecute();
    email = inputEmail.getText().toString();
    password = inputPassword.getText().toString();
    name = inputFullName.getText().toString();
}

@Override
protected String doInBackground(String... args) {
    UserFunctions userFunction = new UserFunctions();
    JSONObject json = userFunction.registerUser(name, email, password);

    Log.d("Create Response", json.toString());

    try {
        int success = json.getInt(KEY_SUCCESS);
        if (success == 1) {
            // DATABASE HANDLER
            // user successfully logged in
            // Store user details in SQLite Database
            DatabaseHandler db = new DatabaseHandler(
                    getApplicationContext());
            JSONObject json_user = json.getJSONObject("user");

            // Clear all previous data in database
            userFunction.logoutUser(getApplicationContext());

            db.addUser(json_user.getString(KEY_NAME),
                    json_user.getString(KEY_EMAIL),
                    json_user.getString(KEY_UID),
                    json_user.getString(KEY_CREATED_AT));

        }
    } catch (JSONException e) {
        e.printStackTrace();
    }
    return null;
}

protected void onPostExecute(String file_url) {
if (success == 1) {
        Intent dashboard = new Intent(getApplicationContext(), LoginActivity.class);
        dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(dashboard);
        finish();
}else{
    //tvLError.setText("Incorrect username/password");

 }
}
}
} 
```

我得到的错误日志......

12-02 20:45:23.140：E/JSON 解析器（28208）：解析数据时出错 org.json.JSONException：值

```
<br of type java.lang.String cannot be converted to JSONObject
12-02 20:45:23.140: W/dalvikvm(28208): threadid=13: thread exiting with uncaught exception (group=0x415e62a0)
12-02 20:45:23.140: E/AndroidRuntime(28208): FATAL EXCEPTION: AsyncTask #1
12-02 20:45:23.140: E/AndroidRuntime(28208): java.lang.RuntimeException: An error occured while executing doInBackground()
12-02 20:45:23.140: E/AndroidRuntime(28208): at android.os.AsyncTask$3.done(AsyncTask.java:299)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.FutureTask.run(FutureTask.java:137)
12-02 20:45:23.140: E/AndroidRuntime(28208): at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.lang.Thread.run(Thread.java:856)
12-02 20:45:23.140: E/AndroidRuntime(28208): Caused by: java.lang.NullPointerException
12-02 20:45:23.140: E/AndroidRuntime(28208): at com.example.cs309.gotoclass.RegisterActivity$RegisterTask.doInBackground(RegisterActivity.java:89)
12-02 20:45:23.140: E/AndroidRuntime(28208): at com.example.cs309.gotoclass.RegisterActivity$RegisterTask.doInBackground(RegisterActivity.java:1)
12-02 20:45:23.140: E/AndroidRuntime(28208): at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-02 20:45:23.140: E/AndroidRuntime(28208): at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
12-02 20:45:23.140: E/AndroidRuntime(28208): ... 5 more 
```

注册用户

```
public JSONObject registerUser(String name, String email, String password){
    // Building Parameters
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", register_tag));
    params.add(new BasicNameValuePair("name", name));
    params.add(new BasicNameValuePair("email", email));
    params.add(new BasicNameValuePair("password", password));

    // getting JSON Object
    JSONObject json = jsonParser.getJSONFromUrl(registerURL, params);
    // return json
    return json;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-24T06:37:58.840

Its hard to figure out without prper source code. But check Line#89 in RegisterActivity.java which is getting called from doInBackground(). Put a break point and check which item is coming as NULL (because of that you are getting NullPointerException). Once you fix that it will work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T12:15:09.960

确保验证您的登录详细信息是否为空值，然后仅调用 AsychTask 和调用 registerUser() 方法。

# cloudbees - 如何为我的 cloudbees jenkins maven 构建提供更多 PermGen 空间？

> ID：13688693
> 
> 赞同：3
> 
> 时间：2012-12-03T17:37:49.150
> 
> 标签：cloudbees

我[的构建](https://gedcom.ci.cloudbees.com/job/gedcomx-snapshot/)一直因“OOM：PermGen”空间错误而失败。我试图用预构建`export`命令调整我的 MAVEN_OPTS 无济于事。我还可以做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T14:38:13.870

我为此写了一篇 wiki 文章：[https ://wiki.jenkins-ci.org/display/JENKINS/Builds+failing+with+OutOfMemoryErrors](https://wiki.jenkins-ci.org/display/JENKINS/Builds+failing+with+OutOfMemoryErrors)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T06:49:14.870

在预构建 shell 脚本上设置 MAVEN_OPTS 将仅适用于该 shell 脚本。在 maven 构建步骤高级选项中使用 MAVEN_OPTS 选项，或使用全局 MAVEN_OPTS 应用于所有作业[http://JENKINS.INSTANCE/configure](http://JENKINS.INSTANCE/configure)

# nginx - 从子域重定向到 Dotcloud 上的文件夹

> ID：13688694
> 
> 赞同：0
> 
> 时间：2012-12-03T17:37:52.193
> 
> 标签：nginx, dotcloud

是否可以使用 Dotcloud 上的应用程序 nginx.conf 从子域重定向到文件夹？

我想将[http://blog.domain.com](http://blog.domain.com)重定向到[http://www.domain.com/blog](http://www.domain.com/blog)

我可能错了，但据我了解，应用程序级别 nginx.conf 的内容被插入到主 nginx.conf 的服务器块中。

我在 nginx.conf 中尝试了以下指令，但它不起作用：

```
rewrite http://blog.domain.com http://www.domain.com/blog/ permanent; 
```

有没有其他人设法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T19:53:04.660

好的，所以我想通了。虽然 Ifs 在 nginx 中被认为是邪恶的，但这是我能做的最好的事情：

```
if ($http_host = "blog.domain.com") {
    rewrite ^/(.*)$ http://www.domain.com/blog/$1?$args;
} 
```

# fortran - 两个变量的 mpi_gather

> ID：13688696
> 
> 赞同：1
> 
> 时间：2012-12-03T17:38:02.410
> 
> 标签：fortran, mpi

我是使用 Fortran 进行 MPI 编程的新手。我想绘制一个二维图。我试图让每个处理器计算一个图形点并将其发送到根以将其写入文件。有人可以告诉我如何发送两个变量，即：`x`和`f(x)`with `mpi_gather`。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T10:51:56.637

就像 Hristo 所说的和“[将未分配的数组传递给没有显式接口的例程有什么问题吗？](https://stackoverflow.com/questions/13496510/is-there-anything-wrong-with-passing-an-unallocated-array-to-a-routine-without-a/13496808#13496808) ”这两个例子，你可以这样做

```
Program gather

  Use mpi

  Implicit None

  Integer, Dimension( :, : ), Allocatable :: result

  Integer, Dimension( 1:2 ) :: buffer

  Integer :: me, nprocs, error
  Integer :: x, fx

  Call mpi_init( error )

  Call mpi_comm_rank( mpi_comm_world, me    , error )
  Call mpi_comm_size( mpi_comm_world, nprocs, error )

  If( me == 0 ) Then
     Allocate( result( 1:2, 1:nprocs ) ) !Naughty - should check stat
  Else
     Allocate( result( 1:0, 1:0 ) )      !Naughty - should check stat
  End If

  x  = me
  fx = x * x

  buffer( 1 ) = x
  buffer( 2 ) = fx

  Call mpi_gather( buffer, 2, mpi_integer, &
                   result, 2, mpi_integer, &
                   0, mpi_comm_world, error )

  If( me == 0 ) Then
     Write( *, '( 99999( i3, 1x ) )' ) result( 1, : ) 
     Write( *, '( 99999( i3, 1x ) )' ) result( 2, : ) 
  End If

  Call mpi_finalize( error )

End Program gather
Wot now? mpif90 gather.f90
Wot now? mpirun -np 7 ./a.out
  0   1   2   3   4   5   6
  0   1   4   9  16  25  36 
```

# java - 对 volatile 的写入是 Java 中的内存屏障吗

> ID：13688697
> 
> 赞同：25
> 
> 时间：2012-12-03T17:38:04.703
> 
> 标签：java, concurrency, volatile, jls

我最近在一次演讲中听说，对 volatile 的写入会触发线程写入的每个变量的内存屏障。这真的正确吗？从 JLS 来看，似乎只有相关变量被清除，而其他变量则没有。有人知道什么是正确的吗？可以指出我在 JLS 中的具体位置吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-03T17:45:19.130

是的，它会引发障碍。[你可以在这里](http://gee.cs.oswego.edu/dl/jmm/cookbook.html)阅读更多。有4种类型，LoadLoad LoadStore StoreStore StoreLoad。

至于你的问题

> 从 JLS 来看，似乎只有相关变量被清除，而其他变量则没有。有人知道什么是正确的吗？

任何其他线程都可以看到在 volatile 存储之前发生的所有写入，前提是其他线程加载此新存储。但是，如果其他线程未加载新值，则在 volatile 加载之前发生的写入可能会或可能不会被其他线程看到。

举一个实际的例子

```
volatile int a =0;
int b = 0;

Thread-1
b = 10;
a = 3;

Thread-2
if(a == 0){
  // b can b 10 or 0
} 
if(a == 3){
   // b is guaranteed to be 10 (according to the JMM)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T07:48:33.830

对[可变变量和其他变量](https://stackoverflow.com/questions/12438464/volatile-variables-and-other-variables)的引用是正确的。我没有意识到happens-before的传递性是必须由VM实现的，而不是从定义中得出的。我仍然感到困惑，为什么没有明确说明具有如此深远影响的事物，而实际上是某种定义的推论。总结一下：假设您有 4 个这样的操作：

```
thread1        thread2
a1
a2
                a3
                a4 
```

其中 a2 是对 volatile 变量 v 的写入，a3 是从同一个 volatile 变量 v 中读取。它遵循happens-before (hb) 的定义，即 hb(a1,a2) 和 hb(a3,a4)。此外，对于挥发物，我们有 hb(a2,a3)。现在从 hb 所需的传递性得出 hb(a1,a3)。因此，对 volatile 变量 v 的写入和后续读取起到了内存屏障的作用。

# wsdl - TIBCO - 动态生成 W SDL

> ID：13688700
> 
> 赞同：0
> 
> 时间：2012-12-03T17:38:10.617
> 
> 标签：wsdl, tibco

我有一个 WebService，它是一个服务调度程序，它有一个类型为 anyType 的 Body，所以我只有一个 Web 服务，我的客户只需要知道为他正在调用的特定服务放入 Body 中的模式。

现在的问题是，每次我创建新服务或修改现有服务时，我都需要为它们发送新模式。我需要一种方法，这样我就可以生成 WSDL，并将主体替换为所需服务的模式，这样我就不必在每次更改时重新发送模式。

提前致谢！

顺便说一句，如果重要的话，我正在使用 Tibco Designer：P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T19:39:35.813

创建一个期望通用 WSDL 作为输入并将模式路径作为参数的 XSLT。使用 XSLT 为您的消费者生成您想要的 WSDL。

# android - Android 模拟器无法正常工作

> ID：13688706
> 
> 赞同：-3
> 
> 时间：2012-12-03T17:38:19.280
> 
> 标签：android, avd

我已经安装了 Android 开发工具。并尝试启动简单的 android 应用程序，但 android 模拟器有问题。

1.起初有一个错误“Android emulator failed to allocate memory 8”，但我修复了它，将内存大小减少到 512MB，现在当模拟器启动需要很长时间，android 标签闪烁时需要两三分钟。所有的工作都太慢了。

2.第二个问题——模拟器屏幕几乎占据了整个屏幕。复选框“将显示尺寸缩放为实际尺寸”没有帮助。

3.成功运行模拟器后第三次关闭它，之后我无法再次运行模拟器。我点击开始按钮，什么也没发生！

我该如何解决所有这些错误？如何提高模拟器性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:44:47.640

`Android Virtual Device Manager`>>> `New`>>> ![在此处输入图像描述](../Images/5cd349de02f1f8b6b6cb4d9ff9aaf66d.png)

然后，创建 AVD。

加载应用程序需要时间，所以请耐心等待。顺便说一句，每当你想继续测试应用程序时，不要关闭模拟器，保持打开状态。然后每当您调试时，应用程序将自动关闭并重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:46:13.087

使用带有 VM 加速的 Intel Atom 处理器。

创建一个新的 VM，然后选择 API 15 和 CPU Intel Atom x86。

由于激活 Intel HAXM，您应该运行 Intel Hardware Accelerated Execution Manager

```
<sdk>/extras/intel/Hardware_Accelerated_Execution_Manager/IntelHAXM.exe. 
```

更多信息：[http ://docs.xamarin.com/Android/Guides/Deployment,_Testing,_and_Metrics/Configuring_the_x86_Emulator](http://docs.xamarin.com/Android/Guides/Deployment,_Testing,_and_Metrics/Configuring_the_x86_Emulator)

在这里：http: [//developer.android.com/tools/devices/emulator.html#accel-vm](http://developer.android.com/tools/devices/emulator.html#accel-vm)

# python - 如何编辑python包含路径

> ID：13688707
> 
> 赞同：0
> 
> 时间：2012-12-03T17:38:19.397
> 
> 标签：python, path, include, python-3.2

我试图让 python-connect-mysql 模块运行，但是当我`python setup.py install`在我的命令 shell 上执行时，我收到以下错误：

[Errno 13] Permission denied: '/Library/Python/2.7/site-packages/test -easy-install-2259.write-test'

```
The installation directory you specified (via --install-dir, --prefix, or
the distutils default setting) was:

    /Library/Python/2.7/site-packages/ 
```

我已经安装了 Python 3.2，需要安装到 /Library/Python/3.2/site-packages/
我查看了很多解决方案，但对命令 shell 不太了解。我尝试了以下方法来编辑我的 bash_profile 并收到一条错误消息，指出该文件不存在：
`sudo /Applications/TextEdit.app/Contents/MacOS/TextEdit ~/.bash_profile`
然后我尝试了：`touch ~/.bash_profile`但我到达那里后不知道该怎么做——我阅读的博客有非常粗略的说明——所以我点击退出，它让我退出了。
这似乎是我下载第三方软件包的最大障碍。我`sudo /Applications/TextEdit.app...`再次尝试了该方法，以查看终端是否允许我打开 bash_profile，因为我已触摸它并收到一条错误消息，提示我无权打开文件。有人可以帮忙吗？我快疯了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:42:58.763

尝试使用具有提升权限的 Python **3可执行文件：**

```
sudo python3 setup.py install 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:47:03.893

路径**/Library/Python/***用于存储全局可用于所有系统的 python 模块，并且这些目录是从**root**用户创建的，这就是为什么您会收到“权限被拒绝”错误的原因。只需使用 sudo。

```
sudo python setup.py install 
```

你也可以看看[virtualenv](http://www.virtualenv.org/en/latest/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:50:48.393

虽然使用`sudo`是可能的，但您应该始终使用[virtualenv](http://pypi.python.org/pypi/virtualenv)来管理您的 python 模块，以防有人决定`setup.py`用某种恶意代码替换（严重的是，每次安装新模块时都会查看 setup.py 的代码）执行的 root 权限不会完全有利于您的系统。

# neo4j - NEO4J 服务器：更新节点

> ID：13688709
> 
> 赞同：2
> 
> 时间：2012-12-03T17:38:24.990
> 
> 标签：neo4j

我正在使用 neo4j 服务器 1.8 版。我的应用程序的当前要求是创建和/或更新多个节点并将它们添加到特定索引（全部在一个请求中）。我们有几个索引，一个节点可以在其中一些。这些节点有一个 ID 属性（对我们的应用程序很重要）。如果已经有一个具有该 ID 的节点，我们只需要覆盖它的属性。我们现在要做的是首先检查这些节点中的哪些存在（通过包含所有节点的索引中的 GET）并存储在数据结构中。然后我发出批处理请求来创建或更新节点。如果ID在数据结构中不存在，我们必须创建一个节点。否则，只有我们必须更新它的属性。这很慢，最好只发出一个批处理请求，而不是两个。我尝试使用 UNIQUE INDEXES，但该节点可以位于多个索引中。你建议我做什么？

# hibernate - JPA、Hibernate、DB2：JPQL-Query 和 char 列

> ID：13688710
> 
> 赞同：1
> 
> 时间：2012-12-03T17:38:25.240
> 
> 标签：hibernate, char, db2, jpql, dialect

我正在将 JPA 与休眠一起使用，并且在使用以下 JPQL 查询时遇到了一些问题**：**

```
final Query query = getEntityManager().createQuery(
            "select u from User u where u.username = :username")
query.setParameter("username", "a"); 
```

使用 DB2 V9.7 数据库时，即使存在用户名为“a”的用户，查询也会导致 NoResultException。仅当具有用户名的列的类型为 char 时才会出现此问题。如果我将列类型更改为 varchar，就像 hibernate 会自己生成它一样，查询工作正常。

有任何想法吗？

附上一些配置信息：

*   休眠版本：3.6.10.Final
*   jdbc 驱动程序：db2jcc 3.61.65
*   方言：org.hibernate.dialect.DB2Dialect
*   字段声明：

```
     @Column(name = "USER_NAME", 长度 = 50)
     @NotNull
     @大小（最大值 = 50）
     私人字符串用户名；

```

*   用户类型声明 `@TypeDef(name = "trimmedString", defaultForType = String.class, typeClass = TrimmedStringUserType.class)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T10:16:11.857

Hibernate 将 String 映射到 VARCHAR 类型。这在这里解释

[http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/types.html](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/types.html)

要确保它映射到 char，您需要在自定义 db2 方言中指定，如此处所述。

[JPA/Hibernate DDL 生成；CHAR 与 VARCHAR](https://stackoverflow.com/questions/2290727/jpa-hibernate-ddl-generation-char-vs-varchar)

# python - Python中的SSLSocket密码/密码

> ID：13688713
> 
> 赞同：5
> 
> 时间：2012-12-03T17:38:35.693
> 
> 标签：python, ios, ssl, python-2.7, push-notification

我最近一直在考虑为我的一个应用程序制作 iOS 推送通知服务。它有一个 Python 2.7 后端，所以我想用 Python 而不是 PHP（或其他任何东西）来做。

我有发送通知的代码并且设备接收它，但是每次我运行代码时，它都会要求我手动输入 PEM 文件的“密码短语”。

这并不理想，因为我希望这在服务器上全部自动化，当它需要发送通知时，它应该发送它。我在 Python 2.7 的文档中找不到任何允许我在连接时自动从变量设置密码的内容。

如果有人知道如何在 Python 2.7 或任何其他想法中做到这一点，我将不胜感激。

这是一段代码：

```
certfile = 'devPEM.pem'
apns_address = ('gateway.sandbox.push.apple.com', 2195)

s = socket.socket()
sock = ssl.wrap_socket(s, ssl_version=ssl.PROTOCOL_SSLv3, certfile=certfile)
sock.connect(apns_address) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-03T22:13:45.200

所以 BorrajaX 建议的答案是在提示时不要为密钥设置密码。但是这是不可能的，因为（至少在我的 Mac 上）希望密码至少为 4 个字符。

解决此问题的步骤是：

1.  在开发人员门户中创建证书。
2.  在 Keychain Access 中本地下载并打开证书
3.  从 Keychain Access 将证书的私钥导出为 .p12 文件（我将其命名为 aps_key.p12）。
4.  在 .p12 键上运行以下命令：
    `openssl pkcs12 -nocerts -out aps_key.pem -in aps_key.p12`
5.  输入密码（我们将在一分钟内删除）。
6.  运行以下命令来去除密码：
    `openssl rsa -in aps_key.pem -out new_aps_key.pem`
7.  将从开发者中心下载的 .cer 转换为 .pem 文件：
    `openssl x509 -in aps.cer -inform der -out aps.pem`
8.  将密钥和证书 .pem 文件与以下内容合并：
    `cat aps.pem new_aps_key.pem > final_aps.pem`
9.  您现在可以删除所有其他文件，除了`final_aps.pem`.

然后该`final_aps.pem`文件与上面的代码一起使用，而不会提示输入密码/密码短语。

这是一个有用的网站，我在其中找到了从 .pem 文件中删除密码的代码：[http ://www.sslshopper.com/article-most-common-openssl-commands.html](http://www.sslshopper.com/article-most-common-openssl-commands.html)

编辑：如果您不需要同一文件中的证书和密钥，您可以忽略第 8 步并使用`aps.pem`和`new_aps_key.pem`文件。

# jquery - Flexslider 在 Fancybox 2 ajax 窗口中不起作用

> ID：13688714
> 
> 赞同：0
> 
> 时间：2012-12-03T17:38:36.733
> 
> 标签：jquery, fancybox, fancybox-2, flexslider

嗨遇到了以下问题。我尝试在 Fancybox v.2.1.3 ajax 窗口中使用 Flexslider v.2.1。ajax 窗口弹出，但显示的三个图像缺少方向导航图标，并且根本无法浏览图像。

相关的 html 位如下所示：

```
<ul class="moodlegrid sectionwrap">
            <li><a class="ajax1" href="projekt1.html"><img title="Projekte1" src="img/projekteblur.jpg" alt="Projekte1" /><img title="Projekte1" src="img/projekte.jpg" alt="Projekte1" /><span class="spiceup">Zum Projekt</span></a></li>
        </ul> 
```

在 index.html 页面的底部，jQuery 部分如下所示：

```
<script type='text/javascript' src="./js/jquery-1.8.3.min.js"></script>
<script type='text/javascript' src="./js/jquery.fancybox.js"></script>
<script type='text/javascript' src="./js/jquery.flexslider-2.1.min.js"></script>

<script type='text/javascript'>
$(document).ready(function(){
    $(".ajax1").fancybox({
        type: 'ajax',
        fitToView   : false,
        openOpacity : false,
        width       : '70%',
        height      : '97%',
        autoSize    : false,
        closeClick  : false,
        openEffect  : 'none',
        closeEffect : 'none',
        afterLoad: function() {
            $('.flexslider').flexslider({
                animation: "slide",
                animationLoop: true,
                controlNav: false,
                directionNav: true,
                slideshow: false
            });}        
    });
}); 
```

加载到 ajax 窗口中的 html 的 Flexslider 相关部分如下所示：

```
<div class="flexslider">
    <ul class="slides">
        <li><img src="img/projekteblur.JPG" alt='Bild' width='530px' height='307px'/></li>
        <li><img src="img/projekte.JPG" alt='Bild' width='530px' height='307px' /></li>
        <li><img src="img/projekteblur.JPG" alt='Bild' width='530px' height='307px' /></li>
    </ul>
</div> 
```

在控制台内部根本没有任何错误。如果有人知道如何解决该问题，那就太好了。在此先感谢 r。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T14:10:14.567

我只是遇到了同样的问题。问题是需要在加载 ajax 之后重新加载 dom，然后才能触发 flexslider。

我是一名前端开发人员，所以为了简单和速度，我将 flexslider 调用放在 ajax 负载中。像这样：

```
<div class="flexslider">
    <ul class="slides">
        <li><img src="img/projekteblur.JPG" alt='Bild' width='530px' height='307px'/></li>
        <li><img src="img/projekte.JPG" alt='Bild' width='530px' height='307px' /></li>
        <li><img src="img/projekteblur.JPG" alt='Bild' width='530px' height='307px' /></li>
    </ul>
</div>

$("flexslider ul.slides").flexslider(); 
```

这对我有用..

# ruby - 如何修复 # 的“未定义的方法长度” 我安装了这个 gem - https://github.com/pluskid/rmmseg-cpp。 （文档： 问问题

> ID：13688715
> 
> 赞同：0
> 
> 时间：2012-12-03T17:38:36.937
> 
> 标签：ruby

我安装了这个 gem - [https://github.com/pluskid/rmmseg-cpp](https://github.com/pluskid/rmmseg-cpp)。

（文档：[http](http://rmmseg-cpp.rubyforge.org/) ://rmmseg-cpp.rubyforge.org/ ）

当我尝试运行此示例命令时：`$echo "我们都喜欢用 Ruby" | rmmseg`

我得到：

```
/Users/webmagnets/.rvm/gems/ruby-1.9.3-p327@blt/gems/rmmseg-0.1.6/lib/rmmseg/algorithm.rb:24:in `next_token': undefined method `length' for #<Enumerator: "我们都喜欢用 Ruby\n":each_char> (NoMethodError)
    from /Users/webmagnets/.rvm/gems/ruby-1.9.3-p327@blt/gems/rmmseg-0.1.6/lib/rmmseg/algorithm.rb:44:in `segment'
    from /Users/webmagnets/.rvm/gems/ruby-1.9.3-p327@blt/gems/rmmseg-0.1.6/lib/rmmseg.rb:12:in `segment'
    from /Users/webmagnets/.rvm/gems/ruby-1.9.3-p327@blt/gems/rmmseg-0.1.6/bin/rmmseg:65:in `<top (required)>'
    from /Users/webmagnets/.rvm/gems/ruby-1.9.3-p327@blt/bin/rmmseg:23:in `load'
    from /Users/webmagnets/.rvm/gems/ruby-1.9.3-p327@blt/bin/rmmseg:23:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:50:59.113

我想到了。我使用的是 rmmseg 而不是 rmmseg-cpp。

# perl - Perl IO::Socket::UNIX Connect with Timeout 给出 EAGAIN/EWOULDBLOCK

> ID：13688716
> 
> 赞同：2
> 
> 时间：2012-12-03T17:38:39.533
> 
> 标签：perl, sockets, nonblocking, unix-socket

Ubuntu Linux，2.6.32-45 内核，64b，Perl 5.10.1

我将许多新的 IO::Socket::UNIX 流套接字连接到服务器，并且大多数情况下它们工作正常。但有时在更快的处理器上的重线程环境中，它们会返回“资源暂时不可用”（EAGAIN/EWOULDBLOCK）。我在 Connect 上使用了超时，因此这会导致套接字在连接期间进入非阻塞模式。但是我的超时时间没有发生 - 它不会等待任何明显的时间，它会很快返回。

我看到在 IO::Socket 内部，它尝试连接，如果它因 EINPROGRESS 或 EAGAIN/EWOULDBLOCK 失败，它会进行选择以等待设置写入位。到目前为止，这似乎很正常。在我的情况下，选择很快成功，这意味着写入位已设置，然后代码尝试重新连接。（我猜这是试图通过错误滑动来获取任何错误？）无论如何，重新连接再次失败并使用 EAGAIN/EWOULDBLOCK。

在我的代码中，这很容易通过重试循环来解决。但我不明白为什么当套接字变为可写时，套接字不可重新连接。我认为选择保护对于非阻塞连接总是足够的。显然不是; 所以我的问题是：

*   What conditions cause the connect to fail when the select works (the write bit gets set)?
*   有没有比旋转和重试更好的方法来等待连接成功？纺纱浪费循环。相反，我希望它阻止诸如选择/轮询之类的事情，但我仍然需要超时。

谢谢，

——史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:39:40.760

> 但我不明白为什么当套接字变为可写时，套接字不可重新连接。

我想这是因为在您能够再次连接之前，任何需要的资源都变得免费了。用旋转循环替换`select`无济于事。

# asp.net-mvc - ASP.NET MVC JQuery UI TAB - 如何在每个选项卡单击时进行回发。如何使它对 SEO 友好？

> ID：13688717
> 
> 赞同：0
> 
> 时间：2012-12-03T17:38:40.263
> 
> 标签：asp.net-mvc, jquery-ui, tabs, seo, postback

我正在使用 jquery 选项卡，如下所示。单击每个选项卡，它会根据其 href url 进行 AJAX 调用。问题是 AJAX 调用对 SEO 不友好。我怎样才能使它对 SEO 友好？如何在每个选项卡单击时进行回发，并在回发后保持当前选项卡处于选中状态。另外如何更新每个选项卡上的 url 点击我的意思是如果用户点击 [SPECIFICATION] 选项卡，回发 url 后应该看起来像 www.domnainname/cardetails/specification

我正在使用 ASP.NET MVC 4.0。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.0/jquery-ui.min.js"></script>

<script type="text/javascript">
    $(function ($) {
        $('#example').tabs();
    });
</script>

<div id="example"  class="tabs"  style="width: 698px;">
                <ul style="list-style: none;">
                    <li><a href="/Details/Overview" title="tabs-1">Overview</a></li>
                    <li><a href="/Version/Details?ID=@ViewBag.versionId&grpId=5" title="tabs-2">Specifications</a></li>
                    <li><a href="/Version/Details?ID=@ViewBag.versionId&grpId=1" title="tabs-3">Exterior</a></li>
                    <li><a href="/Version/Details?ID=@ViewBag.versionId&grpId=2" title="tabs-4" >Interior</a></li>
                    <li><a href="/Version/Details?ID=@ViewBag.versionId&grpId=3" title="tabs-5">Dimensions</a></li>
                    <li><a href="/Version/Details?ID=@ViewBag.versionId&grpId=4" title="tabs-6">Feature</a></li>
                    <li><a href="/Version/Details?versionID=@ViewBag.versionId&grpId=6" title="tabs-7">Instrument Panel</a></li>
                </ul>
                <div id="tabs-1" style="width: 698px;">
                    This is Tab one
                </div>
                <div id="tabs-2">
                </div>
                <div id="tabs-3">
                </div>
                <div id="tabs-4">
                </div>
                <div id="tabs-5">
                </div>
                <div id="tabs-6">
                </div>
                <div id="tabs-7">
                </div>
            </div> 
```

谢谢，

@保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:53:33.037

根据您要执行的操作，我建议以下内容：

*   将 href="/Your/links/address" 替换为 href="#corresponding-panel"
*   添加一个“数据链接”属性来存放您的网址
*   订阅标签的选择事件

    $(".tabs").tabs({select:function(ui, event){

    ```
    if(!$(event.panel).hasClass('loaded')){
        var linkURL = $(ui.currentTarget).attr('data-link');
        //Ajax load has happend
        if(linkURL != undefined){
            //USE the 'linkURL' variable in place of '/echo/json'
            $.ajax({
                url: "/echo/json" ,
                success:function(data){
                    $(event.panel).addClass('loaded').html("<h1>Some ajax content loaded from " + $(ui.currentTarget).attr('data-link') );
                }            
            });
        }
    } }});​ 
    ```

[这是 JSFiddle 示例](http://jsfiddle.net/TNCodeMonkey/yKyu2/1/)

# python - 遍历子文档

> ID：13688718
> 
> 赞同：0
> 
> 时间：2012-12-03T17:38:44.617
> 
> 标签：python, mongodb

我有这种类型的 JSON 文档：

```
{ 
  name : 'John',
  age : 30,
  counts : [
    {day : monday, pay : 75, extra : 33} ,
    {day : tuesday, pay : 69, extra : 12} ,
    {day : sunday, pay : 42, extra : 0}  ]
 } 
```

我想遍历它们并执行操作。我创建了一个变量“a”作为迭代的尝试：

```
x = [2, 67, 53, 21, 5, ... ... ]

for i in db.docs.find():
    a = 0
    while a <= len(i['counts']):
        ...
        x.append(i['counts'][a]['extra']) 
        ...
        total = ...
        ...
        a = a + 1
        db.docs.update({'id': i['id']}, {'$set':{"counts.a.total":total}}) 
```

如何让 Python 接受“a”作为列表索引？感谢您的帮助。

这是错误消息：

```
Traceback (most recent call last):
    x.append(i['counts'][a]['extra'])
IndexError: list index out of range 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:50:54.787

你可以只使用一个 for 循环：

```
for element in i['counts']:
    ...
    x.append(element['extra']) 
```

如果必须使用 while 循环，请确保索引严格低于长度。

```
while a < len(i['counts']): 
```

# sql - 查找计算列的表达式的系统函数？

> ID：13688720
> 
> 赞同：1
> 
> 时间：2012-12-03T17:38:54.463
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我正在寻找类似的东西

```
exec sp_helptext 'dbo.StoredProcName' 
```

（这将返回组成存储过程的 SQL 代码）但对于计算列。除了使用 SSMS 查找之外，是否存在这样的功能？我正在寻找用于计算计算列的表达式的文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:42:02.847

尝试这个：

```
SELECT 
    name, definition
FROM sys.computed_columns 
```

当然 - 该目录视图还在其其他列中包含**更多有用的信息！**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:42:34.077

以下是`sp_helptext`的语法：

> sp_helptext [ @objname = ] 'name' [ , [ @columnname = ] computed_column_name ]

所以你可以做这样的事情：

```
 exec sp_helptext @objname = N'AdventureWorks2012.Sales.SalesOrderHeader', @columnname = TotalDue 
```

来源：[MSDN 库](http://msdn.microsoft.com/en-us/library/ms176112.aspx)

# matlab - 生成具有特定秩的随机矩阵

> ID：13688721
> 
> 赞同：7
> 
> 时间：2012-12-03T17:38:57.753
> 
> 标签：matlab, matrix

我想知道如何在 Matlab 中生成具有特定等级（枢轴列数）的 nxn 矩阵。我知道您可以使用该命令`randi(IMAX, m, n)`生成一个 mxn 矩阵，其中随机条目介于 1 和 IMAX 之间，但是是否有可能生成一个 4 x 4 矩阵，其中包含随机条目但只有 2 个枢轴列？提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T17:48:10.403

我意识到，因为`randi(IMAX, m, n)`形成了一个具有尽可能多的枢轴列的 mxn 矩阵，所以可以使用以下代码形成一个具有 k 个枢轴列和 1 到 IMAX 之间的随机条目的 nxn 矩阵 A：

```
A = randi(IMAX, n, k)*randi(IMAX, k, n) 
```

因为每个`randi(IMAX, n, k)`并且`randi(IMAX, k, n)`只有`k`枢轴列，所以他们的产品也只有 k 枢轴列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:04:57.630

一种（诚然效率低下）方法可能是生成完整矩阵（在您的示例中为 4x4），然后使用 SVD 分解将其分离并将一些奇异值归零（在您的情况下为 2 个条目）。我相信重组后的矩阵将具有所需的等级。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T22:58:14.527

或者，如果您对控制生成矩阵的奇异值感兴趣，可以使用测试矩阵库中的 randSVD 函数：（[链接）](http://www.mathworks.com/help/matlab/ref/gallery.html#f84-1000189)

# gwt - 如何在 GXT 中使用 ComboBoxCell 制作内联编辑列并在 GridEditing 上处理他的事件？

> ID：13688726
> 
> 赞同：1
> 
> 时间：2012-12-03T17:39:16.533
> 
> 标签：gwt, extjs, gxt

我是 GXT 新手，我正在尝试在 3.0.1 版本上执行此操作：

我有一个基于[展示示例](http://www.sencha.com/examples/#ExamplePlace:inlineeditablegrid)的可编辑网格，我已经修改了使用**SimpleComboBox**的列的代码，因为我需要处理一个要显示的值和一个 id，就像在普通 HTML 中一样，我找不到这样做的方法这与 SimpleComboBox。

现在我使用**ComboBoxCell**和**ComboBox**来实现这一点，但我有两个问题。

## 问题#1

当表格显示时，组合列不会像内联编辑列那样呈现（如示例中的列）。下面是创建列的代码：（ObjectDTO 只有 id 和 value 属性）

```
public class MyGrid implements IsWidget {

private GridEditing<MyGridDTO> columnEditing;
//another variables needed to create and handle the grid

    public MyGrid(){

        List<ColumnConfig<MyGridDTO, ?>> listColumns = new ArrayList<ColumnConfig<MyGridDTO, ?>>();
        sm.setSelectionMode(SelectionMode.SINGLE);

        //...

        ColumnConfig<MyGridDTO, ObjectDTO> colsomeProperty = new ColumnConfig<MyGridDTO, ObjectDTO>(
                        properties.someProperty(),170,cons.gbsomePropertyTitle());  

        //...               

        ComboBoxCell<ObjectDTO> somePropertyCell = new ComboBoxCell<ObjectDTO>(somePropertysStore,new LabelProvider<ObjectDTO>() {
            public String getLabel(ObjectDTO item) {                
                return item.getDescripcion();
            }

        });

        listColumns.add(colSomeProperty);

        colSomeProperty.setCell(somePropertyCell); 

        final ComboBox<ObjectDTO> combo = new ComboBox<ObjectDTO>(somePropertyCell);

        columnEditing.addEditor(colSomeProperty,combo);
        columnEditing.addBeforeStartEditHandler(new BeforeStartEditHandler<MyGridDTO>() {

                public void onBeforeStartEdit(BeforeStartEditEvent<MyGridDTO> event) {

                    //handle whether or not to allow column editing
                }
            });
    }

} 
```

在我遇到问题 #2 之前，这没什么大不了的

## 问题#2

我必须根据我要编辑的行将网格中的某些列设为只读。我通过在 MyGridDTO 中拥有一个属性来做到这一点，该属性是布尔值，并确定我是否可以编辑此对象。问题是：编辑组合框列时，没有任何 gridEditingevents 上升，我认为这种行为是因为 ComboBox 已经可见并且没有“隐藏”在内联编辑属性后面。我的意思是，因为它已经可见，所以 GridEting 不再应该处理编辑事件。那可能吗？

在这一点上，我不知道该怎么做，因为我找不到解决方法。如果关于此的信息很少，或者我以错误的方式进行研究（很可能），我不确定

有什么线索吗？

PD：请为我的英语道歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:53:11.273

有三种方法可以设置 GXT 网格以允许可编辑行。您似乎同时使用了这三种方法中的两种，这可能是问题 1 的根源。

[允许用户在网格](http://www.sencha.com/examples/#ExamplePlace%3ainlineeditablegrid)中编辑行的主要两种方式是行内编辑和基于[行](http://www.sencha.com/examples/#ExamplePlace%3aroweditablegrid)的编辑。有描述如何设置这些的具体示例 - 本质上，您告诉网格如何绘制数据，然后指示 *GridEditing 对象如何让用户操作数据。这两个工具都提供了额外的工作流程细节（描述开始/完成/取消编辑的事件），并在修改行/单元格时更改其样式。

第三种选择是直接将单元格添加到网格中。这会跳过任何样式或工作流程更改，只允许用户按原样编辑数据（查看[cellgrid 示例](http://www.sencha.com/examples/#ExamplePlace%3acellgrid)以了解其外观的详细信息）。

您似乎同时使用了第一个和第三个选项 - 您正在创建一个 GridInlineEditing 对象并对其进行设置，然后将一个 ComboBoxCell 添加到 ColumnConfig，从而要求 Grid 始终在每个单元格中绘制一个 ComboBox，甚至不编辑的时候。

相反，您可能只需要默认行为（无单元格），将值绘制为字符串，或自定义 AbstractCell 子类，为您的用例进行一些特定的绘制。

# spring - 使用 tomcat 池和 Spring 在 postgres 中自动重新连接

> ID：13688730
> 
> 赞同：5
> 
> 时间：2012-12-03T17:39:33.530
> 
> 标签：spring, postgresql, connection-pooling

据我了解，“testOnBorrow”和“validationQuery”参数就在我的小巷里，但它们似乎没有按预期工作。

我启动应用程序，运行一些查询，一切顺利。然后我重新启动 postgres 服务器 - 不重新启动 tomcat - 以测试 DataSource 可以处理重新连接，我得到的只是：

```
 This connection has been closed.; nested exception is org.postgresql.util.PSQLException: This connection has been closed.
    at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:104)
        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)
        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)
        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:603)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:637)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:666)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:674)
    at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:729)

...

Caused by: org.postgresql.util.PSQLException: This connection has been closed.
    at org.postgresql.jdbc2.AbstractJdbc2Connection.checkClosed(AbstractJdbc2Connection.java:822)
    at org.postgresql.jdbc3.AbstractJdbc3Connection.prepareStatement(AbstractJdbc3Connection.java:273)
    at org.postgresql.jdbc2.AbstractJdbc2Connection.prepareStatement(AbstractJdbc2Connection.java:301)
    at sun.reflect.GeneratedMethodAccessor38.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.jdbc.pool.ProxyConnection.invoke(ProxyConnection.java:126)
    at org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:99)
    at org.apache.tomcat.jdbc.pool.interceptor.AbstractCreateStatementInterceptor.invoke(AbstractCreateStatementInterceptor.java:67)
    at org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:99)
    at org.apache.tomcat.jdbc.pool.interceptor.ConnectionState.invoke(ConnectionState.java:153)
    at org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:99)
    at org.apache.tomcat.jdbc.pool.TrapException.invoke(TrapException.java:41)
    at org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:99)
    at org.apache.tomcat.jdbc.pool.DisposableConnectionFacade.invoke(DisposableConnectionFacade.java:63)
    at $Proxy35.prepareStatement(Unknown Source)
    at org.springframework.jdbc.core.JdbcTemplate$SimplePreparedStatementCreator.createPreparedStatement(JdbcTemplate.java:1436) 
```

我在用：

*   春天 3.1
*   PostgreSQL 9.2.1
*   连接池：org.apache.tomcat.jdbc.pool 7.0.25

我的 Spring bean 配置如下：

```
public DataSource dataSource() {
    org.apache.tomcat.jdbc.pool.DataSource dataSource = new org.apache.tomcat.jdbc.pool.DataSource();
    // from properties file
    dataSource.setDriverClassName(environment
            .getProperty("datasource.driver"));
    dataSource.setUrl(environment.getProperty("datasource.url"));
    dataSource.setUsername(environment.getProperty("datasource.username"));
    dataSource.setPassword(environment.getProperty("datasource.password"));
    // other configurations
    dataSource.setInitialSize(10);
    dataSource.setMinIdle(10);
    dataSource.setMaxIdle(100);
    dataSource.setMaxActive(100);
    dataSource.setDefaultAutoCommit(true);
    dataSource.setMaxWait(6000);
    dataSource.setJmxEnabled(true);
    dataSource
            .setJdbcInterceptors("....ConnectionState;.....StatementFinalizer");
    dataSource.setRemoveAbandoned(true);
    dataSource.setRemoveAbandonedTimeout(10);
    dataSource.setLogAbandoned(true);
    dataSource.setTestOnBorrow(true);
    dataSource.setTestOnReturn(false);
    dataSource.setTestWhileIdle(false);
    dataSource.setUseEquals(false);
    dataSource.setFairQueue(false);
    dataSource.setTimeBetweenEvictionRunsMillis(30000);
    dataSource.setMinEvictableIdleTimeMillis(30000);
    dataSource.setValidationInterval(1800000);
    dataSource.setValidationQuery("SELECT 1");

    return dataSource;
} 
```

任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:03:06.657

仅在最初从池中借用连接时才进行连接验证。即使在每次查询之前都进行了检查，在检查和查询之间仍然会有一段时间连接可能会丢失。所有查询都应该有某种形式的异常处理来处理查询失败——通常，处理坏的连接句柄，获取一个新的句柄，然后重试查询（如果可能的话）。

在 JDBC 标准中，有一个“connectionErrorOccurred”的回调方法应该在发生这种情况时被调用，但我对 JDBC 和 Java 的工作原理还不够熟悉，不知道如何使用它（或者即使它涵盖了这个）案子）。

在任何情况下，您可以知道连接是好是坏的唯一时间是您尝试使用它并且没有连接池可以自动克服该问题而不使用自定义调用来执行和重试查询，这会中断JDBC“契约”到标准接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-24T01:22:45.787

我最近遇到了同样的问题，想在网络掉线时自动重新连接 Tomcat JDBC 连接池。和你一样，我也发现 testOnBorrow 和 validationInterval 不适合我。

我最终在 JdbcTemplate 上创建了一个 Around Advice（我们使用 Spring 的 org.springframework.jdbc.core.JdbcTemplate）并在 Advice 内部进行重试。

Spring 配置如下所示：

```
<bean id="jdbcRetryOnFailureAdvice" class="my.jdbc.adapter.JdbcRetryOnFailureAdvice">
    <property name="maxRetriesOnConnDrop" value="5"/>
    <property name="retryWaitInMillis" value="5000"/>
    <property name="sqlStatesToRetry" value="08003 08001 57P01"/>
</bean>

<aop:config proxy-target-class="true">
    <aop:aspect id="jdbcRetryOnUpdate" ref="jdbcRetryOnFailureAdvice">
        <aop:pointcut id="retryUpdatePointCut"
                      expression="execution(* 
                      org.springframework.jdbc.core.JdbcTemplate.update(..))"/>
        <aop:around   pointcut-ref="retryUpdatePointCut"
                      method="retryOnFailure"/>
    </aop:aspect>
</aop:config> 
```

my.jdbc.adapter.JdbcRetryOnFailureAdvice 类如下所示：

```
public class JdbcRetryOnFailureAdvice {

    private int maxRetriesOnConnDrop = 0;

    private long retryWaitInMillis = 1000;

    public Object retryOnFailure(ProceedingJoinPoint jp) throws Throwable {
        Object result = null;
        int retryCount = 0;
        do {
            try {
                Object[] args = jp.getArgs();
                if ( args != null && args.length > 0 )
                    result = jp.proceed(jp.getArgs());
                else
                    result = jp.proceed();
                break;
            } catch (DataAccessResourceFailureException ex) {
                if ( retryCount < maxRetriesOnConnDrop ) {
                    LOG.warn("Retrying...(retryCount=" + retryCount + ")");
                    sleep(retryWaitInMillis);
                } else {
                    throw ex;
                }
            }
            retryCount++;
        } while ( retryCount <= maxRetriesOnConnDrop );
        return result;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-07T11:22:58.457

我有类似的问题。我使用 Postgres 9.4。Spring 4 和 Tomcat 8。我用 Spring 配置解决了问题

```
<bean id="dataSource" class="org.apache.tomcat.jdbc.pool.DataSource" destroy-method="close">
    <property name="initialSize" value="10" />
    <property name="maxActive" value="25" />
    <property name="maxIdle" value="20" />
    <property name="minIdle" value="10" />
    <property name="driverClassName" value="org.postgresql.Driver" />
    <property name="url" value="${database.url}" /> 
    <property name="username" value="${database.username}" />
    <property name="password" value="${database.password}" />   
    <property name="testOnBorrow" value="true" />
    <property name="validationQuery" value="SELECT 1" />
 </bean> 
```

我已经测试过了。它运作良好！我关闭了 Postgres，所以我有这样的日志：

```
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method) 
```

但是当我启动 postgres 时，一切都很好！为了重新连接到数据库，这两行做了所有事情：

```
<property name="testOnBorrow" value="true" />
<property name="validationQuery" value="SELECT 1" /> 
```

# internet-explorer - 在现有网站上执行 Visual Basic

> ID：13688731
> 
> 赞同：1
> 
> 时间：2012-12-03T17:39:36.430
> 
> 标签：internet-explorer

我试图弄清楚如何在已经打开的网页上操作表单字段（文本框和按钮），而不必打开 Internet Explorer 的新实例，也不必先导航到特定的 URL。

我目前有以下代码可以打开 google，填写搜索字段，然后单击 Google Search 按钮：

```
 Sub Main

    Dim objIE
    Dim UserN
    Dim url As String

    url = "http://www.google.com"

    Set objIE = CreateObject("InternetExplorer.Application")

    objIE.Visible = True
    objIE.navigate url

    WaitForLoad (objIE)
    ' runs the sub "Wait for Load" that waits until the page is fully loaded before continuing the script
    MsgBox "It Loaded"
    Set UserN = objIE.document.getElementsByName("q")
    If Not UserN Is Nothing Then
' fill in first element named "q", assumed to be the login name field
        UserN(0).value = "Dragon NaturallySpeaking"
    End If
    Wait 2
    Dim f
    Set f = objIE.document.getElementsByName("btnK")
    f(0).click
    End Sub
    Sub WaitForLoad (objIE)
      Do While objIE.Busy
        Wait .1
      Loop
    End Sub 
```

我目前的问题是我希望能够填写搜索字段并单击 Google 搜索按钮，而不必先导航到 www.google.com。例如，我已经打开浏览器并访问了 www.google.com，但现在我想执行填写文本字段并单击按钮的脚本。不幸的是，我找不到这样做的方法。我尝试使用 Set objIE = GetObject("InternetExplorer.Application") - 而不是 CreateObject - 并删除 objIE.Visible=True 和 ObjIE.Navigate url，但这只会返回错误。

# r - 我可以将单个变量的任意函数的参数拟合到数据中吗？

> ID：13688734
> 
> 赞同：3
> 
> 时间：2012-12-03T17:39:46.133
> 
> 标签：r, parameters, prediction, estimation, nls

我在 R 工作。我有一个函数 (F)，将一个变量 (X) 与另一个变量 (Y) 关联起来。(F) 有 3 个可变参数 (A, B, C)，使得 Y == F(X) == G(X, A, B, C)。我想将此函数拟合到一个数据集，该数据集通过找到最佳 (A, B, C) 来给出 N (X, Y) 对。

(X) 和 (Y) 之间的关系既不是多项式，也不是某种概率分布。我很好奇是否有办法对上面定义的任意 (F) 执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:14:04.730

是的， `?nls`。R有许多非线性回归包；`nls`有点基本功能。如果您从未`formulas`在 R 中使用过，您应该在帮助文件中阅读一下它们。但是，与任何其他计算机语言一样，您需要为您的 coefficients 提供一些初始“猜测”值`A,B,C`。

例如， `nls(Y ~ I(A*sin(x) + B*exp(x/C)),data=x, start=list(A=1,B=.5,C=3))`

# java - Java Synth：制作测试音

> ID：13688742
> 
> 赞同：0
> 
> 时间：2012-12-03T17:40:11.663
> 
> 标签：java, javasound, synthesizer, tone-generator

我一直在研究人们的 Java 合成器，但不知道如何生成他们程序的简单版本。我的目标是在 java 中创建一个简单的测试音，用户可以通过按下某些键来改变它。例如按“r”将提高幅度，或“f”将增加频率。我只想知道：从哪里开始创建这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T01:17:43.540

有关[`Beeper`](https://stackoverflow.com/a/7782749/418556)生成音调的示例，请参见。

![](../Images/a06ecb4595d22ac3d78a160199d00102.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T07:51:46.070

我有一个通过 Java 运行的 Theremin：

[http://www.adonax.com/blog/?p=187](http://www.adonax.com/blog/?p=187) http://www.hexara.com/VSL/JTheremin.htm

由于我使用波表来生成数据，因此音高由光标在表中前进的速率决定。当光标落在表格元素之间时，我使用线性插值。因此，如果一个 1024 个元素的表描述了一个正弦波，一次通过一个元素是一种速度，一次通过 1.2 个元素（使用线性插值获得中间值）会更快一些沥青。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:45:32.267

好吧，这会*令人不快*，但最简单的方法是创建一个方波。

根据您创建的文件是有符号还是无符号幅度，您需要确定是否在`0`和`amplitude`、 或`-amplitude`和之间振荡`+amplitude`。

频率将决定在切换之前在每个值处创建多少样本。

如果没有更多关于您尝试创建的输出格式等的详细信息，很难做出更多说明 - 但这可能会帮助您开始。创建一个正弦波以获得更好的音调:)

# encryption - 加密配置文件时出现 log4net 错误

> ID：13688744
> 
> 赞同：0
> 
> 时间：2012-12-03T17:40:15.837
> 
> 标签：encryption, log4net, config

我有一个 WCF 独立服务，它在我的 app.config 文件中使用 log4net 及其所有配置，并且我在第一次运行服务时加密配置文件。我目前将此设置为作为控制台应用程序运行，但是当我启动它时，在保存加密的配置文件后，服​​务会打印出来

> log4net：错误 XmlHierarchyConfigurator：找不到属性 [EncryptedData] 在 [log4net.Repository.Hierarchy.Hierarchy] 上设置对象

这让我感到困惑，因为在新加密的配置文件的 log4net 部分中有一个 EncryptedData 部分。

我正在使用以下方法加密配置文件部分：

```
section.SectionInformation.ProtectSection("DataProtectionConfigurationProvider"); 
```

我的 log4net 配置文件部分看起来像这样（之前）：

```
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" restartOnExternalChanges="false" />
  </configSections>

  <log4net>
    <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender" >
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
      </layout>
    </appender>
    <root>
      <appender-ref ref="ConsoleAppender" />
    </root>
  </log4net> 
```

之后：

```
 <log4net configProtectionProvider="DataProtectionConfigurationProvider">
    <EncryptedData>
      <CipherData>
        <CipherValue>AQAAANCMnd8BFdERjHoAw <etc> </CipherValue>
      </CipherData>
    </EncryptedData>
  </log4net> 
```

Log4net 仍然适用于加密配置（编辑：这是在调试中；当作为服务发布时（但权限打开）它无法记录任何内容）

那么，谁能告诉我这个错误是什么以及如何修复我的代码以阻止它被抛出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T16:17:17.483

回答我自己的：

诀窍是不要使用 AssemblyInfo.cs 中的条目来加载 log4net，而是将此代码放在 main 方法中

```
XmlConfigurator.Configure(); 
```

这会在 .NET 完成它的工作并解密配置文件后加载 log4net 配置。使用更常用的方式将这一行放入 assemblyinfo 显然会使 log4net 在发生这种情况之前尝试加载和读取其配置。

# jquery - javascript代码，用户在阿拉伯语中使用标题

> ID：13688746
> 
> 赞同：1
> 
> 时间：2012-12-03T17:40:21.873
> 
> 标签：jquery, filter

我有一个 javascript 代码，但用户无法使用它，所以我提供了帮助并访​​问了他的网站。发现`title="-arabic-"`我的代码在`title="Male"`这里非常有问题，如果我使用标题的复制和粘贴并将其放置在我的 javascript 中，它实际上会搜索阿拉伯语版本还是我需要做一些额外的事情？

```
$(document).ready(function() { 
var $postBG = $('.post .poster-profile img'); 
$postBG.filter('[title="ذك"]').closest('td').addClass('male').children('td').removeClass('row1').removeClass('row2');
$postBG.filter('[title="انثى"]').closest('td').addClass('female').children('td').removeClass('row1').removeClass('row2');
 }); 
```

那是我开始使用的代码，您可以在标题位置看到阿拉伯语。

IMG 来源：男性

```
<img src="http://i49.servimg.com/u/f49/14/49/52/30/male210.gif" alt="ذكر" title="ذكر"> 
```

女性

```
<img src="http://i49.servimg.com/u/f49/14/49/52/30/female11.gif" alt="انثى" title="انثى"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T19:50:22.000

```
$(document).ready(function() { 
var $postBG = $('.post #profil_body img'); 
$postBG.filter('[title="ذك"]').closest('td').removeClass('row1').removeClass('row2').find('#profil_body').removeAttr('id').addClass('male');
$postBG.filter('[title="انثى"]').closest('td').removeClass('row1').removeClass('row2').find('#profil_body').removeAttr('id').addClass('female');
 }); 
```

首先，我切换了查看位置，`.post .poster-profile img`似乎还可以，但我想打开搜索，所以我将其切换为`.post #profil_body img`更快地找到图像。

我首先要做的是，如果在最接近`td`删除类的地方发现了男性和女性的阿拉伯文案例`row1` `row2`

然后`.find`包围img的div，`removeAttr('id')`因为那个id干扰了其他所有东西，所以有一个背景图像。

完成后，我们将相应的类添加到`td`

现在 javascript`.filter`可以正常运行我需要做的事情了！

感谢大家的好建议和想法，帮助我获得了思路！

# matomo - Piwik 本地主机跟踪

> ID：13688749
> 
> 赞同：6
> 
> 时间：2012-12-03T17:40:43.947
> 
> 标签：matomo

在 piwik 上，我使用 localhost 作为测试网站。当我从我的计算机输入 localhost 时，piwik 会正确更新其统计信息，但是当同一 LAN 中的另一个人（同事）输入我的 IP 地址时，它会显示网页，但 piwik 不会更新访问次数/浏览量。我想知道这是为什么？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-16T12:31:54.707

您需要将 IP 添加到`trusted_hosts[]`配置中。如果您在 localhost 下安装 Piwik，它只会接受以该名称调用的跟踪请求。

补充`config.ini.php`：

```
[General]
trusted_hosts[] = localhost
trusted_hosts[] = 192.168.1.12 
```

`192.168.1.12`您在 LAN 中的 IP 地址在哪里：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-03T17:41:33.060

这个配置 `[General] trusted_hosts[] = localhost`

说您可以在哪个地址访问 Piwik，它的管理面板。如果你想跟踪局域网页面，你必须修改它的跟踪代码。为您提供正确的跟踪代码（如果您的网络中有动态 IP，它将不起作用）：

*   添加到`trusted_hosts`您在 LAN 中的 IP 地址
*   不是通过您的 LAN 地址而是通过您的 LAN 地址进入 Piwik 管理面板，`localhost`例如。`192.168.1.12`
*   现在，所有跟踪代码都将您的 IP 作为服务器地址，并将向您安装 Piwik 的计算机发出请求。

解释：

这一切都会发生，因为当您从您的`localhost`所有跟踪代码进入 Piwik 管理面板时`localhost`，您的 Piwik 地址都将具有。因此，如果有人使用跟踪代码进入网页，浏览器将尝试与用户进行通信，`localhost`即：他的计算机。可能他没有你的 Piwik。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-28T13:28:35.443

正如@halfdan 所说，我将这些添加到 config.ini.php 中。

```
[General]
trusted_hosts[] = localhost
trusted_hosts[] = 192.168.1.12 
```

还要更改（本地主机）网站 URL 映射。
单击设置图标**->**网站**->**管理
单击期望网站编辑图标（在我的情况下为本地主机）
将URL字段从本地主机更改为192.168.1.12

# c# - 实体框架和领域驱动设计

> ID：13688750
> 
> 赞同：1
> 
> 时间：2012-12-03T17:40:51.110
> 
> 标签：c#, entity-framework, domain-driven-design

在花了几天时间尝试使用 EF 和 DDD 设置一个简单的应用程序之后，我不得不说我感到非常沮丧，并认为我最好还是使用 Linq-to-SQL 并忘记所有关于 DDD 和 EF 的事情。

英孚

a) 你不能有正确的只读集合

b）当您从一组子项中删除某些内容时，您经常会收到*无法更改关系，因为一个或多个外键属性是不可为空的*消息

c) 没有简单的方法可以删除父项的所有子项并重新插入它们

鉴于我发现的变通方法看起来很讨厌，所有这些对我来说几乎都是阻碍。是否有人设法组建了一个简单的存储库来解决这些问题？

如果是的话，你会愿意分享一些代码吗？！？

另外，我知道这是一个大话题，是否有人亲身体验过大型 Web 应用程序中的任何 DDD 优势？我们都知道这个理论，但如果它真的值得麻烦，那么有一个想法会很好！

* * *

好的，到目前为止，我可以做的最好的事情是在查询某些内容时使用 AsNoTracking() ，而不必做各种疯狂的解决方法。这样我就可以得到我的信息，而 EF 就不用管它在我背后做的任何事情。我现在可以从集合中删除，并且我也可以删除（谁会认为 id 必须为此返回 sql！）有谁知道使用 AsNoTracking 的任何陷阱？至于我可以根据我的对象生成 SQL 并填充它们或更新/删除它们，我很好。整个跟踪的事情还是走得太远了？

* * *

```
namespace EShop.Models.Repositories
{
public class CustomerRepository : BaseRepository, IRepository<Customer, Int32>
{
    public CustomerRepository() : base(new EShopData()) { }

    #region CoreMethods

    public void InsertOrUpdate(Customer customer)
    {
        if (customer.CustomerId > 0)
        {
            // you cannot use remove, if you do you ll attach and then you ll have issues with the address/cards below
            // dbContext.Entry<CustomerAddress>(address).State = EntityState.Added; will fail
            dbContext.Database.ExecuteSqlCommand("DELETE FROM CustomerAddress WHERE CustomerId = @CustomerId", new SqlParameter("CustomerId", customer.CustomerId));
            dbContext.Database.ExecuteSqlCommand("DELETE FROM CreditCard WHERE CustomerId = @CustomerId", new SqlParameter("CustomerId", customer.CustomerId));

            foreach (var address in customer.Addresses)
                dbContext.Entry<CustomerAddress>(address).State = EntityState.Added;
            foreach (var card in customer.CreditCards)
                dbContext.Entry<CreditCard>(card).State = EntityState.Added;

            dbContext.Entry<Customer>(customer).State = EntityState.Modified;
        }
        else
        {
            dbContext.Entry<Customer>(customer).State = EntityState.Added;
            foreach (var card in customer.CreditCards)
                dbContext.Entry<CreditCard>(card).State = EntityState.Added;
            foreach (var address in customer.Addresses)
                dbContext.Entry<CustomerAddress>(address).State = EntityState.Added;
        }
    }

    public void Delete(int customerId)
    {
        var existingCustomer = dbContext.Customers.Find(customerId);

        if (existingCustomer != null)
        {
            //delete cards
            var creditCards = dbContext.CreditCards.Where(c => c.CustomerId == customerId);
            foreach (var card in creditCards)
                dbContext.Entry<CreditCard>(card).State = EntityState.Deleted;

            //delete addresses
            var addresses = dbContext.CustomerAddresses.Where(c => c.CustomerId == customerId);
            foreach (var address in addresses)
                dbContext.Entry<CustomerAddress>(address).State = EntityState.Deleted;

            //delete basket
            dbContext.Entry<Customer>(existingCustomer).State = EntityState.Deleted;
        }
    }

    public Customer GetById(int customerId)
    {
        return dbContext.Customers.Include("Addresses").AsNoTracking().SingleOrDefault(c => c.CustomerId == customerId);
    }

    public IList<Customer> GetPagedAndSorted(int pageNumber, int pageSize, string sortBy, SortDirection sortDirection)
    {
        return null;
    }

    public void Save()
    {
        dbContext.SaveChanges();
    }

    #endregion CoreMethods

    #region AdditionalMethods

    #endregion AdditionalMethods

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T19:32:37.190

对 b 的响应：当您创建数据库时，您必须要么级联删除（即数据库也删除所有相关的子记录），要么使外键可以为空。然后你不会得到那个错误。这不是 EF 的责任，而是关系数据库处理约束的方式。您可以在您的 EDMX、您的代码中配置它，或者在数据库端使用 DDL。根据您的决定，您是如何设置项目的。

对 c 的回应：更一般的感觉，但删除所有子项并重新插入听起来很容易出错并且有“气味”。至少只有在绝对需要时我才会这样做。从性能的角度来看，更新可能更快。也许您可以重新思考为什么选择删除并重新插入的问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T21:32:44.360

好的，我认为我现在已经受够了，所以我将总结一下我相当消极的经历

a）这是可能的，但由于这是第 5 版，我希望会有更好的结果。可能最简单的解决方法可以在这里找到 [http://edo-van-asseldonk.blogspot.co.uk/2012/03/readonly-collections-with-entity.html](http://edo-van-asseldonk.blogspot.co.uk/2012/03/readonly-collections-with-entity.html) 或者我想你甚至可以想出你自己的特定于当前问题的只读集合，例如 BasketProductsReadOnlyCollection 如果您有一个购物篮及其产品的集合。

b) 无论如何，我们可能不必担心 a。鉴于这里的问题，微软在“天才之举”中几乎不可能编写正确的 DDD 代码。如果您的 Products 表中有一个 Basket 和 Products 的 BasketId 不可为空，那么如果您执行 Basket.RemoveProduct(product)，您就会遇到麻烦。删除这样的东西意味着删除“关系”而不是记录。所以 EF 会尝试将 BasketId 设置为 null，如果它不能设置它会抛出异常（不，我不想让它为 null 只是为了适应 EF，即使我想要如果我与一个没有的 DBA 一起工作怎么办？）你是什么需要做的是调用 dbContext.Products.Remove(product) 以确保它被删除。这基本上意味着您的业务逻辑代码需要了解 dbContext

c) 我不能再被打扰了！在 StackOverflow 上再次有关于此的响应，您可能会启动并运行某些东西，但它不应该那么困难和反直觉。

至于更大的图景，我查看了与“分离”实体一起使用的 N 层建议。我读了 Julia Lerman 的一本书，她似乎是这方面的权威，但我没有留下深刻的印象。整个附加对象图的工作方式和推荐的处理方式再次非常违反直觉。她推荐的让事情变得“简单”的方法是让每个对象在您的业务代码中记录其状态！不适合我。

我不认为自己是一个建筑天才或什么，也许我错过了一些东西（或很多），但对我来说，EF 的努力似乎是错位的。他们花了很多时间和金钱来实施整个跟踪系统，该系统应该为您做所有事情（典型的 MS，他们认为我们太愚蠢或无法照顾自己的东西），而不是专注于其他可以让这个产品变得更好的事情更容易使用。

我想要从我的 ORM 中为我提供对象中的数据，然后让我一个人以我想要的任何方式处理它们，然后我想将我的对象或对象图传递回 ORM 并自由地告诉它是我想从对象图中添加/删除/更新的内容，以及如何在没有当前 EF 的恶作剧的情况下。

底线：我想我会在这方面再给 MS 几年时间，他们最终可能会做对，但这还不适合我。MS 最终会在他们的网站上放置一些适当的文档/教程吗？我记得几年前在 NHibernate 上阅读了 30 万页的 PDF 教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T09:48:39.903

万一其他人为此苦苦挣扎，这是我能想到的最佳实现，请查看 RemoveFromBasket、AddToBasket 方法，虽然不理想，但至少您可以启动并运行

```
 using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Web;
 using System.Web.Helpers;
 using EShop.Models.DomainModel;
 using System.Data;
 using EShop.Models.DataAccess;
 using System.Data.Objects;
 using System.Data.Entity.Infrastructure;

namespace EShop.Models.Repositories
{
public class BasketRepository : BaseRepository, IRepository<Basket, Int32>
{
    public BasketRepository() : base(new EShopData()) { }

    #region CoreMethods

    public void InsertOrUpdate(Basket basket)
    {
        var basketInDB = dbContext.Baskets.SingleOrDefault(b => b.BasketId == basket.BasketId);
        if (basketInDB == null)
            dbContext.Baskets.Add(basket);
    }

    public void Delete(int basketId)
    {
        var basket = this.GetById(basketId);
        if (basket != null)
        {
            foreach (var product in basket.BasketProducts.ToList())
            {
                basket.BasketProducts.Remove(product); //delete relationship
                dbContext.BasketProducts.Remove(product); //delete from DB
            }
            dbContext.Baskets.Remove(basket);
        }
    }

    public Basket GetById(int basketId)
    {
        // eager-load product info
        var basket = dbContext.Baskets.Include("BasketProducts")
                                      .Include("BasketProducts.Product.Brand").SingleOrDefault(b => b.BasketId == basketId);
        return basket;
    }

    public IList<Basket> GetPagedAndSorted(int pageNumber, int pageSize, string sortBy, SortDirection sortDirection)
    {
        throw new NotImplementedException();
    }

    public void Save()
    {
        dbContext.SaveChanges();
    }

    #endregion CoreMethods

    #region AdditionalMethods
    public void AddToBasket(Basket basket, Product product, int quantity)
    {
        var existingProductInBasket = dbContext.BasketProducts.Find(basket.BasketId, product.ProductId);
        if (existingProductInBasket == null)
        {
            var basketProduct = new BasketProduct()
            {
                BasketId = basket.BasketId,
                ProductId = product.ProductId,
                Quantity = quantity
            };
            basket.BasketProducts.Add(basketProduct);   
        }
        else
        {
            existingProductInBasket.Quantity = quantity;
        }
    }

    public void RemoveFromBasket(Basket basket, Product product)
    {
        var existingProductInBasket = dbContext.BasketProducts.Find(basket.BasketId, product.ProductId);
        if (existingProductInBasket != null)
        {
            basket.BasketProducts.Remove(existingProductInBasket); //delete relationship
            dbContext.BasketProducts.Remove(existingProductInBasket); //delete from DB
        }
    }

    public void RemoveFromBasket(BasketProduct basketProduct)
    {
        var basket = dbContext.Baskets.Find(basketProduct.BasketId);
        var existingProductInBasket = dbContext.BasketProducts.Find(basketProduct.BasketId, basketProduct.ProductId);
        if (basket != null && existingProductInBasket != null)
        {
            basket.BasketProducts.Remove(existingProductInBasket); //delete relationship
            dbContext.BasketProducts.Remove(existingProductInBasket); //delete from DB
        }
    }

    public void ClearBasket(Basket basket)
    {
        foreach (var product in basket.BasketProducts.ToList())
            basket.BasketProducts.Remove(product);
    }

    #endregion AdditionalMethods

} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T12:16:48.980

好的，看起来我已经设法让一切都以我想要的方式或多或少地使用 EF 5。问题 b 似乎对 EF5 没问题。我认为我现在有一个适当的 DDD 篮子类和一个适当的存储库，对此我感到非常满意，也许我毕竟对 EF 过于苛刻是不公平的！

```
public partial class Basket
{
    public Basket()
    {
        this.BasketProducts = new List<BasketProduct>();
    }

    public int BasketId { get; set; }
    public int? CustomerId { get; set; }
    public decimal TotalValue { get; set; }
    public DateTime Created { get; set; }
    public DateTime Modified { get; set; }

    public ICollection<BasketProduct> BasketProducts { get; private set; }

    public void AddToBasket(Product product, int quantity)
    {
        //BUSINESS LOGIC HERE
        var productInBasket = BasketProducts.SingleOrDefault(b => b.BasketId == this.BasketId &&  b.ProductId == product.ProductId);
        if (productInBasket == null)
        {
            BasketProducts.Add(new BasketProduct
            {
                BasketId = this.BasketId,
                ProductId = product.ProductId,
                Quantity = quantity
            });
        }
        else
        {
            productInBasket.Quantity = quantity;
        }
    }

    public void RemoveFromBasket(Product product)
    {
        //BUSINESS LOGIC HERE
        var prodToRemove = BasketProducts.SingleOrDefault(b => b.BasketId == this.BasketId && b.ProductId == product.ProductId);
        BasketProducts.Remove(prodToRemove);
    }
} 
```

}

```
public class BasketRepository : BaseRepository, IRepository<Basket, Int32>
{
    public BasketRepository() : base(new EShopData()) { }

    #region CoreMethods
    //public void InsertOrUpdate(Basket basket, bool persistNow = true) { }

    public void Save(Basket basket, bool persistNow = true)
    {
        var basketInDB = dbContext.Baskets.SingleOrDefault(b => b.BasketId == basket.BasketId);
        if (basketInDB == null)
            dbContext.Baskets.Add(basket);

        if (persistNow)
            dbContext.SaveChanges();
    }

    public void Delete(int basketId, bool persistNow = true)
    {
        var basket = this.GetById(basketId);
        if (basket != null)
        {
            foreach (var product in basket.BasketProducts.ToList())
            {
                basket.BasketProducts.Remove(product); //delete relationship
                dbContext.BasketProducts.Remove(product); //delete from DB
            }
            dbContext.Baskets.Remove(basket);
        }
        if (persistNow)
            dbContext.SaveChanges();
    }

    public Basket GetById(int basketId)
    {
        // eager-load product info
        var basket = dbContext.Baskets.Include("BasketProducts")
                                      .Include("BasketProducts.Product.Brand").SingleOrDefault(b => b.BasketId == basketId);
        return basket;
    }

    public IList<Basket> GetPagedAndSorted(int pageNumber, int pageSize, string sortBy, SortDirection sortDirection)
    {
        throw new NotImplementedException();
    }

    public void SaveForUnitOfWork()
    {
        dbContext.SaveChanges();
    } 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T13:18:44.937

a) 你一开始想做什么？您不能将集合设为私有并仅公开对其进行快照的公共财产吗？

b) 要从数据库中删除子实体，请使用`dbcontext.ThatEntitySet.Remove(child)`，而不是`parent.Children.Remove(child)`。

或者，您可以通过将子项中的外键作为主键的一部分来建立识别关系。然后`parent.Children.Remove(child)`将从数据库中删除一行。

c) 似乎你在做一些愚蠢的事情。如果您提供详细信息，我会提出不同的解决方案。

大话题：你的领域够复杂吗？或者您只是想应用...在简单的 CRUD 应用程序中强制使用 DDD 模式？你有什么商业规则？不变量？您的实体有哪些方法？有什么政策吗？

为什么你需要一个 InsertOrUpdate 方法？我想您发明它是因为您使用相同的表单来创建和更新实体。这是一个强烈的信号，表明你只是在做一个 CRUD 应用程序。

# asp.net-mvc - Kendo：DropDownList 未绑定到 model.string 属性

> ID：13688755
> 
> 赞同：1
> 
> 时间：2012-12-03T17:41:13.170
> 
> 标签：asp.net-mvc, kendo-ui

我在**MVC4**上使用**KendoUI**。

我有一个**DropDownList**绑定到一个空字符串的**模型**属性：

```
 @(Html.Kendo().DropDownListFor(model => model.AppUserStatus)
                                      .Name("userStatusDropDownList")
                                      .DataTextField("Text")
                                      .HtmlAttributes(new {style = "width:100%;"})
                                      .DataValueField("Value")
                                      .BindTo(@ViewBag.StatusList)) 
```

**model.AppUserStatus**是一个默认为空的字符串。

在用户选择一个新项目，或将所选项目保留为默认项目（索引 0）并返回表单后，model.AppUserStatus 仍然为空，即使所有其他字段都正确绑定：

```
 [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult Update(EditUserViewModel model)
    {
        model.AppUserStatus ***** IS Null always, all other fields are good
        return View("EditUser", model);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T19:20:22.370

您不需要为控制设置 Name("userStatusDropDownList") 属性。

删除它，名称将自动正确生成 - 即**#AppUserStatus**。

此 Name 方法还通过发布到服务器的值控制名称 - 发布的输入元素的名称属性。

# debugging - 如何将 ASM 源代码注释放在 OllyDbg 的注释窗口中？

> ID：13688757
> 
> 赞同：1
> 
> 时间：2012-12-03T17:41:24.837
> 
> 标签：debugging, assembly, x86, ollydbg

我有一个汇编语言程序的源代码，它的每一行都有注释，我想在 OllyDbg 的反汇编的注释栏中看到这些注释，因为它调试。如果不编写一个完整的插件，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:12:24.997

注释不会进入最终的 exe。我什至不认为注释会进入 pdb 文件以进行调试构建。

如果你在exe的目录中有包含注释的源代码，在olly中打开exe，点击查看菜单，然后点击源，这将打开包含你的注释和所有的源文件。

99% 的情况下，您在源文件中写入的内容就是 olly 显示的内容，除非您使用了大量的宏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T20:53:55.917

经过一些更多的经验，我发现基本上有3种方法：

1.  修改 OllyDbg 用来直接存储评论的 .udd 文件。
2.  使用标签插件（不幸的是我发现的那个在 2.01 上不起作用）
3.  以 OllyDbg 理解的格式创建调试文件（我认为是 DWARF）

由于 3 相当复杂，我最好的选择可能是 1。

# asp.net - Azure 中的 ASP.NET MVC 4 和 Web API - 未找到 HTTP 资源

> ID：13688759
> 
> 赞同：2
> 
> 时间：2012-12-03T17:41:36.370
> 
> 标签：asp.net, azure, asp.net-mvc-4, asp.net-web-api

使用 Visual Studio 2012，我创建了一个简单的 Windows Azure 项目（云项目），其中包含一个 ASP.NET MVC 4 网站。我没有对模板进行任何更改，我只是尝试使用[Azure Website](https://www.windowsazure.com/en-us/home/scenarios/web-sites/)来部署它。我将 Windows Azure 仪表板中的“发布配置文件”导入到我的项目中并进行了部署（使用 Visual Studio）。

在部署过程的最后，我收到以下消息：“无法打开 'http://mysite.azurewebsite.net'。异常：类未注册”。我只能在该对话框上单击“确定”。知道为什么我会看到此消息吗？

当我查看输出窗口时，我看到部署成功。我去一个 Web API url，我得到“没有找到与请求 URI 'http://mysite.azurewebsites.net/api/values'匹配的 HTTP 资源”。令我困惑的是，我可以在本地环境中访问相同的 url。

我错过了什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T19:53:46.217

确保您在项目中引用了最新版本的 WindowsAzure 相关程序集。

```
Microsoft.WindowsAzure.Diagnostics 2.0 (and not 1.8)
Microsoft.WindowsAzure.ServiceRuntime 2.0 (and not 1.8) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:59:14.833

我可以使用 ASP.NET Web API 访问我的 Azure 网站。如果您使用默认的 MVC4 Web API 模板，请访问“http://[yoursite].azurewebsites.net/api/Values/”。

我的环境如下。- Visual Studio 2012 - ASP.NET MVC4

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:01:36.750

无需创建云项目即可使用 Azure 网站。您可以简单地创建一个 MVC 应用程序，然后使用 git deploy 甚至 FTP 将站点推送到 Azure

# php - INSERT 查询不起作用，空数组？

> ID：13688765
> 
> 赞同：0
> 
> 时间：2012-12-03T17:41:56.067
> 
> 标签：php, methods, insert, pdo

```
<?php
    class Worker extends Core {
        public $name;
        public $surname;
        public $dob;
        public $skills;
        public $postcode;
        public $street;
        public $email;
        public $tel;
        public $ern;
        public $result;

        public function __construct () {
            $this->name = 'name';
            $this->surname = 'surname';
            $this->dob = 'dob';
            $this->skills = 'skills';
            $this->postcode = 'postcode';
            $this->street = 'street';
            $this->email = 'email';
            $this->tel = 'tel';
            $this->ern = 'ern';
        }

        //Saving worker data to database, need provide group name (table name)
        public function saveWorker($group) {
            if(!(isset($this->conn))) parent::__construct();
                try
                {
                    $this->conn ->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); //catch exceptions
                    $q = 'INSERT INTO :group (name, surname, dob, skills, postcode, street, email, tel, erefnumber) VALUES (
                    :name,
                    :surname,
                    :dob,
                    :skills,
                    :postcode,
                    :street,
                    :email,
                    :tel,
                    :erefnumber)'; //sql query with group name
                    $stmt = $this->conn->prepare($q);
                    $stmt -> bindValue(':group', $group, PDO::PARAM_STR);
                    $stmt -> bindValue(':name', $this->name, PDO::PARAM_STR);
                    $stmt -> bindValue(':surname', $this->surname, PDO::PARAM_STR);
                    $stmt -> bindValue(':dob', $this->dob, PDO::PARAM_STR);
                    $stmt -> bindValue(':skills', $this->skills, PDO::PARAM_STR);
                    $stmt -> bindValue(':postcode', $this->postcode, PDO::PARAM_STR);
                    $stmt -> bindValue(':street', $this->street, PDO::PARAM_STR);
                    $stmt -> bindValue(':email', $this->email, PDO::PARAM_STR);
                    $stmt -> bindValue(':tel', $this->tel, PDO::PARAM_STR);
                    $stmt -> bindValue(':erefnumber', $this->erefnumber, PDO::PARAM_STR);

                    $results = $stmt->execute();
                    if($results > 0)
                    {
                              return 'Dodano: '.$ilosc.' rekordow';
                    }
                    else
                    {
                              return 'Wystapil blad podczas dodawania rekordow!';
                    }
                }
                catch(PDOException $e) 
                {
                  return 'There was some error: ' . $e->getMessage();
                }
                unset($stmt);
        }

            //no exceptions

    public function getWorker()
    {
        $workerData = array (
            "name" => $this->name,
            "surname" => $this->surname,
            "dob" => $this->dob,
            "skills" => $this->skills,
            "postcode" => $this->postcode,
            "street" => $this->street,
            "email" => $this->email,
            "tel" => $this->tel,
            "tel" => $this->erefnumber
        );

        return $workerData;
    } // end getWorker();  

    public function searchWorker($name, $surname, $dob, $skills, $postcode, $street, $email, $tel, $erefnumber) {

    }
    function deleteWorker() {

    }
    function getEmployer() {}
    public function __sleep () {
        parent::__sleep();
    }
} // end Person;

//DB connection

    class Core {
        public $conn;
        public function __construct() {
            $this->dbConnect();
        }
        public function dbConnect() {

            $host = 'localhost';
            $port = '3307';
            $username = 'modium_test';
            $password = 'test';
            $database ='modium_test';   
            try{
                    $this->conn = new PDO('mysql:host='.$host.';dbname='.$database.';port='.$port, $username, $password );
                    echo 'Connection successful!';
                    echo var_dump($this->conn);
            }
            catch(PDOException $e){
                    echo 'Error: ' . $e->getMessage();
            }   
        }

        public function __sleep () {
            unset($this->conn);
        }
    }

    } 
```

查询只是不起作用。以前的每个函数都有效，但是当我尝试通过 sql 查询插入表时，什么也没发生。

Worker 是一个创建得很好的对象，然后我得到一些分配给它的 POST 数组，它也可以正常工作，然后我尝试 saveWorker 但它什么也没提供。

调用行：

```
 var_dump($worker);
 if (isset($worker)) echo 'worker is set';
 if (isset($worker->conn)) echo 'thers connection is set';
 $worker->saveWorker('workers'); 
```

添加行：

```
 echo "\nPDO::errorInfo():\n";
 print_r($stmt->errorInfo());
 print_r($this->conn->errorInfo());
 echo "end of error info"; 
```

它给了我：

```
PDO::errorInfo(): 
Array ( [0] => ) Array ( [0] => 00000 )
end of error info 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:49:37.837

`$stmt->execute()`返回一个`boolean`值[（手动）](http://php.net/manual/en/pdostatement.execute.php)。尝试，

```
$results = $stmt->execute();
if($results !== FALSE)  {
 return 'Dodano: '.$ilosc.' rekordow';
} else {
 return 'Wystapil blad podczas dodawania rekordow!';
 } 
```

此外，您不能绑定`tablename`.

# c# - WPF 转换器中的属性？

> ID：13688768
> 
> 赞同：0
> 
> 时间：2012-12-03T17:42:12.417
> 
> 标签：c#, wpf, xaml, datagrid, converter

我有一个网格。在网格中有超链接。如关联、未关联、完成。这些超链接是通过课程状态填充的。例如，如果课程状态为已完成并已删除。则启用关联链接。我为此使用了转换器. 有组合框。如果组合框有一个项目，那么我需要隐藏超链接关联。我想我需要在模型中创建一个属性，我可以访问转换器中的属性。如果是，那么如何？

我可以在这里使用模型属性和额外的检查吗？

```
 switch (input)
        {
            case "Associate":
                if (Course.status=="Completede" && Course.status=="Dropped")
                    return Visibility.Visible;
                else
                    return Visibility.Collapsed; 
```

请为此提供最佳解决方案？？？？

XAML

```
<DataGridTemplateColumn Header="Required" Width="100">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Path=IsRequired, Converter={StaticResource BoolToStringConverter}, ConverterParameter=Associated}"> 
                                       VerticalAlignment="Center"
                                           </TextBlock>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:07:06.053

你不能。您可以使用`ConverterParameter`，但它不是依赖属性，因此无法绑定。

如果您希望多个属性影响转换器，您应该使用[MultiBinding](http://msdn.microsoft.com/ru-ru/library/system.windows.data.multibinding.aspx)

# objective-c - 检查从 NSURLConnection 填充的自定义对象的 NSMutableArray 中是否完成

> ID：13688770
> 
> 赞同：3
> 
> 时间：2012-12-03T17:42:27.677
> 
> 标签：objective-c, nsarray, nspredicate

首先，非常感谢 SO 社区。我学到了很多东西。但是，我仍然是 Objective C 的极端新手，因此有一个问题。如果这是一个无知的问题，请提前道歉。

我已经子类化以从我的 Web API`NSURLConnection`中获取我的自定义对象 ( )。`myObject`每个对象需要 2 次调用 API 才能完成。第一个调用是从我的对象列表中获取一个 id 属性。第二个调用是使用该 id 来构造不同的 URL 并填充其余`myObject`属性。一切运行良好，但我对重新加载`tableViewsection based on a completion of all of the`myObject `objects within an`NSMutableArray 的方法的正确性有疑问。

这是我在成功实例化并获取所有不完整`myObjects`并将它们添加到`NSMutableArray`. `messageString`是一个属性`myObject`，仅在 . 的每个实例的第二次网络调用中可用/设置`myObject`。因此，我想我会用它来检查完整性。`arrayOfMyObjects`是可变的并且包含所有不完整的`myObjects`. `MyStoreClass`就是这样。处理子类创建的商店`NSURLConnections`。

```
- (void)fetchDetails {

void (^completionBlock)(myObject *obj, NSError *err, int statusCode) = ^(myObject *obj, NSError *err, int statusCode) {

    if (!err && statusCode == 200) {

        NSArray *completionCheckArray = [arrayOfMyObjects filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"messageString = %@", [NSNull null]]];

        if ([completionCheckArray count] == 0) {
            [[self tableView] reloadSections:[NSIndexSet indexSetWithIndex:1] withRowAnimation:UITableViewRowAnimationAutomatic];
        }

    } else if (!err && statusCode != 200) {
        [self statusCodeError:statusCode];
    } else {
        [self generalError:err];
    }
};

    for (myObject *mobj in arrayOfMyObjects) {
    [[MyStoreClass sharedStore] fetchDetails:mobj withCompletion:completionBlock];
    }
} 
```

虽然这可行，但对我来说，必须通过完成块为每个`myObjects`. 如果是这样，检查所有完成情况的替代方法是`myObjects`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:39:38.510

一种可能且可行的方法是使用 KVO（Key Value Observing）。查看相应的[Key-Value Observing Programming Guide](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/KeyValueObserving/Articles/KVOCompliance.html)。

例如：如果您知道从给定的服务调用中期望有多少对象（即对象计数），您可以将观察者连接到保存您的对象的数组对象上，并在添加元素时收到通知等。请参阅[观察一个NSMutableArray 用于插入/删除](https://stackoverflow.com/questions/302365/observing-an-nsmutablearray-for-insertion-removal)。

# spring - 在春季使用代理的自定义范围

> ID：13688771
> 
> 赞同：0
> 
> 时间：2012-12-03T17:42:28.177
> 
> 标签：spring, scope

通常说，当您创建自己的范围并在您的类中自动装配一个范围对象时，

它将注入代理对象，代理对象将调用目标bean上的方法。

所以这意味着spring存储了一个对象列表，并且基于代理的调用它会给我们想要的

目的。我对吗？请解释

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T08:31:21.100

我不知道这是在哪里说的。默认情况下，Spring 不会为作用域 bean 创建代理（您必须要求它，例如 with ）。一旦创建了代理，它与作用域 bean 没有什么不同 - 应用程序上下文是从 bean 名称到 bean 实例的映射，并且一些 bean 是代理。

# java - Java - 每次调用方法时将 int 大小方法的值增加 1

> ID：13688777
> 
> 赞同：0
> 
> 时间：2012-12-03T17:42:51.183
> 
> 标签：java, arrays, count, field, add

我被困在这个我无法理解的问题上。我需要编写一种方法来将特定“行为”的“投票”数量增加一，然后打印出该特定行为的更新投票数。我在这里也使用 ArrayLists 来指出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:48:59.720

这是您要遵循的逻辑：

1：遍历 'acts' 的 ArrayList

2：检查指定的“行为”

3：如果 'act' 等于指定的 'act'，则将 1 添加到您的计数器变量（votes++）

这是我将在没有代码的情况下提供的尽可能多的信息，以显示您已尝试过的内容！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:50:46.090

一个更有效的投票计数器。

```
class VoteCounter<T> {
   final Map<T, AtomicInteger> actToCounterMap = new HashMap<>();

   public void raiseVoteForAct(T id) {
       AtomicInteger ai = actToCounterMap.get(id);
       if (ai == null)
          actToCounterMap.put(id, ai = new AtmoicInteger());
       ai.incrementAndGet();
   }
} 
```

而不是`AtomicInteger`你可以使用`new int[1]`，但它相对难看。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:57:27.333

您可以在 java 中打印出整个对象，例如

```
System.out.println("Array list contains: " + arrayListName); 
```

它将打印数组的内容而不遍历每个值，尽管它可能有奇怪的语法。至于“行为”，我假设你的意思是对象，如果你想将投票数迭代一个，你可以有一个这样的类：

```
public class Act{
    int votes = 0;

    public void increaseVote(){
        votes ++;
        //You can also do votes = votes + 1, or votes += 1, but this is the fastest.
    }

    //While were at it, let's add a print method!
    pubic void printValue(){
        System.out.println("Votes for class " + this.getClass().getName() + " = " + votes + ".");
    }
} 
```

最后，对于带有 arrayList 的类：

```
class classWithTheArrayList {
    private ArrayList<Act> list = new ArrayList<Act>();

    public static void main(String[] args){
        Act example1 = new Act();

        list.add(example1); 
        //ArrayLists store a value but can't be changed 
        //when in the arraylist, so, after updating the value like this:

        Act example2 = new Act();
        example2.increaseVote();
        //we need to replace the object with the updated one
        replaceObject(example1, example2);
    }

    public void replaceObject(Object objToBeRemoved, Object objToReplaceWith){
        list.add(objToReplaceWith, list.indexOf(objToBeRemoved); //Add object to the same position old object is at
        list.remove(objToBeRemoved); //Remove old object
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T17:48:42.567

您可以使用地图：

```
Class VoteCounter {

   Map<Integer, Integer> actToCounterMap = new HashMap<Integer, Integer>();

   public void raiseVoteForAct(int actId) {
       if (actToCounterMap.contains(actId) {
         int curVote = actToCounterMap.get(actId);
         curVote++;
          actToCounterMap.put(actId, curVote);
       } else {
          // init to 1
          actToCounterMap.put(actId, 1);
       }
   }

} 
```

# java - 枚举Java中正则表达式的可能匹配项

> ID：13688778
> 
> 赞同：9
> 
> 时间：2012-12-03T17:42:53.140
> 
> 标签：java, regex, enumeration

我想枚举 Java 中有限正则表达式的所有可能值以进行测试。

在某些情况下，我有一个正则表达式，用于匹配单词中允许的颜色值。以下是它的缩短版本作为示例：

```
(white|black)|((light|dark) )?(red|green|blue|gray) 
```

我想创建一个单元测试，它将枚举所有这些值并将它们中的每一个传递给我的实用程序类，该类`Color`从这些生成一个对象，这样如果我更改正则表达式，如果发生错误，我的单元测试将失败（即不支持新的颜色值）。

当然，我知道枚举是可能的（[请参阅这个问题](https://stackoverflow.com/questions/6643730/producing-all-possible-matches-of-a-regular-expression)），但是是否有一个现有的 Java 库可以枚举正则表达式的所有可能匹配项？

**编辑：**我已经实现了一个这样做的库。请参阅下面的链接以获取我的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T13:08:12.670

你是对的，在网上也没有找到这样的工具，但你可以试试谷歌的[Xeger](http://code.google.com/p/xeger/)

它可以从正则表达式创建一个随机匹配的字符串，并且通过一些代码调整可能会做你想要的。生成随机匹配：

```
String regex = "[ab]{4,6}c";
Xeger generator = new Xeger(regex);
String result = generator.generate();
assert result.matches(regex); 
```

Xeger 代码非常简单，它由 2 个文件组成，其中包含 5 个方法。
它使用 dk.brics.automaton 将正则表达式转换为自动机，然后在每个节点中进行随机选择的自动机转换。

主要功能是生成：

```
 private void generate(StringBuilder builder, State state) {
    List<Transition> transitions = state.getSortedTransitions(true);
    if (transitions.size() == 0) {
        assert state.isAccept();
        return;
    }
    int nroptions = state.isAccept() ? transitions.size() : transitions.size() - 1;
    int option = XegerUtils.getRandomInt(0, nroptions, random);
    if (state.isAccept() && option == 0) {          // 0 is considered stop
        return;
    }
    // Moving on to next transition
    Transition transition = transitions.get(option - (state.isAccept() ? 1 : 0));
    appendChoice(builder, transition);
    generate(builder, transition.getDest());
} 
```

您可以看到，为了更改它以便获得所有可能的匹配项，您需要遍历每个可能节点中的所有可能组合（例如增加多位计数器），您将需要一个哈希来防止循环，但这不应该花费超过 5 秒的时间来编写代码..

我还建议首先检查正则表达式是否真的是确定的，通过检查它是否没有 *、+ 和其他使此操作不可能的符号（只是为了使它成为一个完整的重用工具）...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-12T22:03:19.773

对于将来遇到这个问题的浏览器，我编写了一个使用 dk.brics.automaton 的库，使用[与](https://github.com/bluezio/xeger)[Xeger](http://www.brics.dk/automaton/)类似的方法从接受的答案中发布并发布。你可以找到它：

*   在[GitHub 上](https://github.com/bsaltz/greex)
*   在[项目现场](http://greex.navigamez.com/)
*   在[Maven 中心](http://mvnrepository.com/artifact/com.navigamez/greex/)

要将其添加为依赖项：

### 马文

```
<dependency>
    <groupId>com.navigamez</groupId>
    <artifactId>greex</artifactId>
    <version>1.0</version>
</dependency> 
```

### 摇篮

```
compile 'com.navigamez:greex:1.0' 
```

### 示例代码

以这个问题为例：

```
GreexGenerator generator = new GreexGenerator("(white|black)|((light|dark) )?(red|green|blue|gray)");
List<String> matches = generator.generateAll();
System.out.println(matches.size()); // "14" 
```

# c# - 强制 PrincipalContext 连接到特定服务器

> ID：13688779
> 
> 赞同：11
> 
> 时间：2012-12-03T17:42:55.200
> 
> 标签：c#, asp.net, active-directory

有没有办法强制 PrincipalContext 连接到特定的域控制器？我正在枚举我的应用程序的锁定帐户列表，我希望能够查询多个服务器并从所有 DC 返回列表。

目前，我得到了我的 PrincipalContext 碰巧连接到的 DC，而且我的列表对于被锁定的帐户并不总是完全正确的。

我已经进行了一些挖掘，但没有看到任何方法来引用对 PrincipalContext 的调用连接到哪个域控制器。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-04-04T10:10:45.590

是的，您可以连接到特定的域控制器。

`new PrincipalContext(ContextType.Domain, name, container, username, password);`

此主体上下文的`name`一部分可以设置为域控制器的 IP 地址。我假设您谈论不同的活动目录，否则您可能会遇到域控制器如何分发信息的问题。

此外，请确保 和`container`是正确`OC=...`的`DC=...`。

希望能帮助到你！

# powershell - PowerShell 文件排序

> ID：13688783
> 
> 赞同：1
> 
> 时间：2012-12-03T17:43:05.633
> 
> 标签：powershell

所以我觉得 PS 将是这个项目的最佳解决方案，但我一生都无法弄清楚从哪里开始使用它，这是文件布局..

我有一个文件夹，里面装满了我们自动化系统生成的文件夹，它们被标记为： foobarXXXXXXXXXXXXXXX 文件夹的最后 15 个字符是我需要抓取的，然后在另一个文件夹中搜索包含这 15 个字符的任何文件，然后将找到的任何文件移动到各自的文件夹中。

如果这还不够，我可以提供更多细节。只需要一点就可以开始了。

如果 PowerShell 的版本值得关注，我正在运行 Windows 7。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:59:49.593

理想情况下，您需要 Powershell 3，但您也可以在 Powershell 2 中完成此任务。

我将首先查看[Select-String cmdlet。](http://technet.microsoft.com/en-us/library/hh849903.aspx)也可以在[technet 上找到。](http://technet.microsoft.com/en-us/library/ee176956.aspx)

使用 SubString 函数进行 .NET 字符串操作也是完全合法的。

```
$filePattern = $string.Substring(1,15) 
```

要获取文件的集合，您应该使用 Get-ChildItem。在“@(Get-ChildItem)”中使用“@”会生成一个显式数组。

```
$files = @(Get-ChildItem -Path $path -Recurse) 
```

由于您的问题没有具体细节，因此没有具体答案。

此外，我并排运行带有 Powershell 2 和 3 的 Windows 7。Powershell 3 真是太棒了。

# python - Python 加速 np.unique

> ID：13688784
> 
> 赞同：5
> 
> 时间：2012-12-03T17:43:06.430
> 
> 标签：python, performance, numpy

我希望加快以下代码的速度：

```
NNlist=[np.unique(i) for i in NNlist] 
```

其中 NNlist 是具有重复条目的 np.arrays 列表。

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T17:59:05.133

`numpy.unique`已经非常优化，除非您对基础数据有所了解，否则您不太可能获得比现有数据更快的速度。例如，如果数据都是您可以使用的小整数，`numpy.bincount`或者如果每个数组中的唯一值基本相同，则可以对整个数组列表进行一些优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-06-05T08:14:53.777

`pandas.unique()`比 快得多`numpy.unique()`。Pandas 版本不对结果进行排序，但您可以自己进行排序，如果结果比输入小得多（即有很多重复值），它仍然会快得多：

```
np.sort(pd.unique(arr)) 
```

时间：

```
In [1]: x = np.random.randint(10, 20, 50000000)

In [2]: %timeit np.sort(pd.unique(x))
201 ms ± 9.32 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)

In [3]: %timeit np.unique(x)
1.49 s ± 27.3 ms per loop (mean ± std. dev. of 7 runs, 1 loop each) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-23T18:23:09.397

我还查看`list(set())`了列表中的和字符串，介于熊猫系列和 python 列表之间。

```
data = np.random.randint(0,10,100)
data_hex = [str(hex(n)) for n in data] # just some simple strings

sample1 = pd.Series(data, name='data')
sample2 = data.tolist()

sample3 = pd.Series(data_hex, name='data')
sample4 = data_hex 
```

然后是基准：

```
%timeit np.unique(sample1) # 16.4 µs ± 464 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
%timeit np.unique(sample2) # 15.9 µs ± 743 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
%timeit np.unique(sample3) # 45.8 µs ± 5.88 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
%timeit np.unique(sample4) # 20.6 µs ± 680 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)

%timeit pd.unique(sample1) # 60.3 µs ± 5.39 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
%timeit pd.unique(sample2) # 196 µs ± 18.7 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
%timeit pd.unique(sample3) # 79.7 µs ± 3.98 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
%timeit pd.unique(sample4) # 214 µs ± 61 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each

%timeit list(set(sample1)) # 16.3 µs ± 1.63 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)
%timeit list(set(sample2)) # 1.64 µs ± 83.7 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
%timeit list(set(sample3)) # 17.8 µs ± 1.96 µs per loop (mean ± std. dev. of 7 runs, 100000 loops each)
%timeit list(set(sample4)) # 2.48 µs ± 439 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each) 
```

要点是：

*   从带有整数的 Pandas 系列开始？要么选择`np.unique()`要么`list(set())`

*   从带字符串的 Pandas 系列开始？一起去`list(set())`

*   从整数列表开始？一起去`list(set())`

*   从字符串列表开始？一起去`list(set())`

但是，如果 N=1,000,000 而不是，结果会有所不同。

```
%timeit np.unique(sample1) # 26.5 ms ± 616 µs per loop (mean ± std. dev. of 7 runs, 1 loop each)
%timeit np.unique(sample2) # 98.1 ms ± 3.64 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
%timeit np.unique(sample3) # 1.31 s ± 78.3 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
%timeit np.unique(sample4) # 174 ms ± 2.57 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)

%timeit pd.unique(sample1) # 10.5 ms ± 472 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
%timeit pd.unique(sample2) # 99.3 ms ± 5.24 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
%timeit pd.unique(sample3) # 46.4 ms ± 4.73 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
%timeit pd.unique(sample4) # 113 ms ± 11.7 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)

%timeit list(set(sample1)) # 25.9 ms ± 2.11 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
%timeit list(set(sample2)) # 11.2 ms ± 496 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
%timeit list(set(sample3)) # 37.1 ms ± 1.28 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
%timeit list(set(sample4)) # 20.2 ms ± 843 µs per loop (mean ± std. dev. of 7 runs, 100 loops each) 
```

*   从带有整数的 Pandas 系列开始？一起去`pd.unique()`

*   从带字符串的 Pandas 系列开始？一起去`list(set())`

*   从整数列表开始？一起去`list(set())`

*   从字符串列表开始？一起去`list(set())`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T20:32:44.643

以下是一些基准：

```
In [72]: ar_list = [np.random.randint(0, 100, 1000) for _ in range(100)]

In [73]: %timeit map(np.unique, ar_list)
100 loops, best of 3: 4.9 ms per loop

In [74]: %timeit [np.unique(ar) for ar in ar_list]
100 loops, best of 3: 4.9 ms per loop

In [75]: %timeit [pd.unique(ar) for ar in ar_list] # using pandas
100 loops, best of 3: 2.25 ms per loop 
```

所以`pandas.unique`似乎比`numpy.unique`. 然而，文档字符串提到这些值“不一定是排序的”，这（部分）解释了它更快。在此示例中使用列表推导或`map`没有区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-29T17:19:32.753

`numpy.unique()`是基于排序（`quicksort`），而是`pandas.unique()`基于哈希表。通常，根据我的基准，后者更快。它们已经非常优化。对于一些特殊情况，可以继续优化性能。例如，如果数据已经排序，则可以跳过排序方法：

```
# ar is already sorted
# this segment is from source code of numpy
mask = np.empty(ar.shape, dtype=np.bool_)
mask[:1] = True
mask[1:] = ar[1:] != ar[:-1]
ret = ar[mask] 
```

我遇到了和你类似的问题。我写了我的`unique`函数供我使用。因为`pandas.unique`不支持`return_counts`选项。这是快速实施。但我的实现只支持整数数组。[您可以在此处](https://github.com/lhprojects/blog/blob/master/JupyterNotebooks/HashUnique.ipynb)查看源代码。

# vb.net - 未找到数据源名称

> ID：13688786
> 
> 赞同：0
> 
> 时间：2012-12-03T17:43:17.687
> 
> 标签：vb.net, postgresql, odbc

在 vb.net 控制台应用程序（x64）上使用 odbc 连接器（x64）连接到 postgresql 数据库时出现问题，错误， [http://www.sumarlidason.com/tmp/120312/odbc_capture1.png](http://www.sumarlidason.com/tmp/120312/odbc_capture1.png)

```
 Dim ConnectionString = "Driver={PostgreSQL UNICODE};Server=myPGSrv;Port=5432;Database=dbDefault;Uid=postgres;Pwd=pw;"
    'Dim ConnectionString = "ODBC;dsn=PostgreSQL35W"
    conn = New OdbcConnection(ConnectionString)

    'Open connection to an instance of the PostgreSQL database.
    Try
        conn.Open()
    Catch Ex As Exception
        MsgBox(Ex.Message)
    End Try

    Dim commonOdbcCommand = New OdbcCommand
    commonOdbcCommand.Connection = conn
    conn.Close() 
```

另外，我在控制面板中配置了数据库，见这里.. [http://sumarlidason.com/tmp/120312/odbc_capture.png](http://sumarlidason.com/tmp/120312/odbc_capture.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:20:06.577

正确的连接字符串：

```
Dim conn As New OdbcConnection("DSN=PostgreSQL35W") 
```

# javascript - Javascript regex：测试文本是否仅包含一组字符

> ID：13688789
> 
> 赞同：2
> 
> 时间：2012-12-03T17:43:29.820
> 
> 标签：javascript, regex

如何更好地检查（测试）文本是否仅包含集合中的字符（例如，如果文本仅包含标点符号）

```
var regex = /[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g

res = text.replace(regex, '')

if (res) return false 
```

所以我用replace做了它可以用regex.test做吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T17:46:54.687

是的。有两种可能性。一种是，您使用[锚点](http://www.regular-expressions.info/anchors.html)来断言完整的字符串是由这些组成的：

```
var regex = /^[\.,-\/#!$%\^&\*;:{}=\-_`~()]+$/;
if(regex.test(text)) 
```

或者，您可以使用否定字符类并查看它是否匹配，然后再次否定结果

```
var regex = /[^\.,-\/#!$%\^&\*;:{}=\-_`~()]/;
if(!regex.test(text)) 
```

请注意，这`,-\/`是一个包含`,-./`. 这是多余的，如果字符类发生更改，可能会成为错误源。您可能希望将您的角色类简化为：

```
[.,\/#!$%^&*;:{}=_`~()-] 
```

（或否定版本，取决于您选择的方法。）

# sql - 获取 2 个自定义 varchar 日期值之间的记录

> ID：13688791
> 
> 赞同：1
> 
> 时间：2012-12-03T17:43:35.307
> 
> 标签：sql, tsql, sql-server-2005

在我的一个表中有一个列“month_year”（varchar（10）），我有这个查询

```
select *
from costs 
where month_year>='06/2011'
and month_year<='10/2012' 
```

我想显示在这两个月之间具有月_年值的行，但查询似乎忽略了年部分，并给了我这两个月之间的所有行，这个查询在一个接收 @min_month_year 的存储过程中和@max_month_year 参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:50:25.050

在列中存储`date`值不是很好的设计 但是你可以做这样的事情`varchar`

```
select *
from costs 
where
    convert(datetime, '01/' + month_year, 103) >='20110601' and
    convert(datetime, '01/' + month_year, 103) < '20121101' 
```

但是您month_year 列上的索引将不起作用。
如果您真的想存储`month_year`为`varchar`，我建议您将其存储为-`YYYYMM`和`'201106'`（`'201210'`如果您真的喜欢）。在这种情况下，您可以在不转换的情况下进行比较。`'2011/06'``'2012/10'``'/'`

# state-machine - 这是 Prolog 中循环的良好实现吗？

> ID：13688792
> 
> 赞同：3
> 
> 时间：2012-12-03T17:05:55.740
> 
> 标签：state-machine, prolog

首先，我告诉你，这恰好是我第一次在这里问东西，所以如果不是正确的地方，请原谅我。

我正在开发一个相当复杂的软件，它有一个实现 FSM 的 Prolog 核心。因为我不希望它停止（永远），所以我正在尝试编写一个很好的类似循环的谓词，它可以使用 Prolog 的递归来工作。经过几次不成功的尝试（主要是因为堆栈问题），我最终得到了类似的东西：

```
/* Finite State Transition Network */
transition(st0,evnt0,st1).
transition(st1,evnt1,st2).
transition(st2,evnt2,st0).

fsm_state(state(st0),system(Energy,ActivePayloads),[]) :-
    /* ... */
    transition(st0,evnt0,NextState),
    !,
    fsm_state(state(NextState),system(Energy,ActivePayloads),[]).

fsm_state(state(st1),system(Energy,ActivePayloads),[]) :-
    /* ... */
    transition(st1,evnt1,NextState),
    !,
    fsm_state(state(NextState),system(Energy,ActivePayloads),[0,1,2]).

fsm_state(state(st2),system(Energy,ActivePayloads),[P|Params]) :-
    /* ... */
    transition(st2,evnt2,NextState),
    !,
    fsm_state(state(NextState),system(Energy,ActivePayloads),[]).

start :- 
    Sys = system(10,[]),
    fsm_state(state(s0),Sys,[]). 
```

这是一个好方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:11:15.840

首先是一般性评论：您这样做的方式是一种非常自然的 Prolog 方法，以声明方式（好吧，或多或少，如果不是因为许多 !/0 阻止您在所有方向上使用谓词）描述关系连续状态之间。这种关系自然是用递归谓词实现的。

令我感到奇怪的是，您需要这么多从本质上看起来都相同的子句。为什么不能使用单个子句，例如：

```
fsm(State0, System0, Params0) :-
    /* ... */
    transition(State0, Event, State),
    /* ... */
    fsm(State, System, Params). 
```

其中可能有一些额外的目标将 Params0 与 Params、System0 与 System 以及其他一些实体相关联。一般的方法通常是在计算的单个“步骤”之前和之后的状态之间建立关系，以及描述一系列连续状态的另一个关系（由上面的单个子句组成）。

# shell - 你如何编写一个简单的 linux 脚本来执行一个充满文件的手的安全副本并一次输入用户名和密码？

> ID：13688793
> 
> 赞同：1
> 
> 时间：2012-12-03T17:43:41.940
> 
> 标签：shell, scp

我的本地文件系统上有大约 10 个文件，需要定期复制到特定位置的另一台服务器。

通常我会做类似的事情：

```
scp myfile1.txt username@XXX.XXX.XXX.XXX:/path/on/server/for/myfile1.txt
<enter password>

scp randommyfile2.txt username@XXX.XXX.XXX.XXX:different/path/on/server/for/randommyfile2.txt
<enter password>

scp anotherrandmyfile13.txt username@XXX.XXX.XXX.XXX:another/different/path/on/remote/server/for/anotherrandmyfile13.txt
<enter password>

scp myfile4.txt username@XXX.XXX.XXX.XXX:/path/on/server/for/myfile4.txt
<enter password> 
```

我必须对所有 10 个文件执行此操作。我想知道是否可以编写一个记住我的用户名和密码的 shell 脚本，这样我就不必一直输入密码了？

如果有人能指出我使用 ssh 密钥对的正确方向，我也将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:17:35.550

你为什么不使用 ssh 密钥对？

如果目标路径相同，则

```
scp myfile{1..10}.txt username@XXX.XXX.XXX.XXX:/path/on/server/for/ 
```

我可以设计一个期望的解决方案，因此您只需输入一次密码，但这远非最佳答案。

# java - 使用 jesery 将图像作为 Blob 文件保存到谷歌应用引擎

> ID：13688794
> 
> 赞同：0
> 
> 时间：2012-12-03T17:43:48.553
> 
> 标签：java, google-app-engine, jersey, google-cloud-datastore, blob

我想将图像另存为数据存储中的 blob 文件。我已经使用 JPA 为该对象编写了一个模块类：

```
@XmlRootElement
@Entity
public class PotholeMedia {

@Id
@GeneratedValue (strategy = GenerationType.IDENTITY)
private Long pothole_media_id;
private int pothole_Id;
private Blob image;

//Default constructor
public PotholeMedia (){}

//Overloaded constructor
public PotholeMedia(Long pothole_media_id, int pothole_Id, Blob image) 
{
    super();
    this.pothole_media_id = pothole_media_id;
    this.pothole_Id = pothole_Id;
    this.image = image;
}//end constructor

/**
 * Gets pothole_media_id attribute
 * @return Long
 */
public Long getPotholeMediaId() 
{
    return pothole_media_id;
}//end getPotholeId method

/**
 * Sets pothole_media_id attribute
 * @param pothole_media_id
 */
public void setPotholeMediaId(Long pothole_media_id) 
{
    this.pothole_media_id = pothole_media_id;
}//end getPotholeMedia method

/**
 * Get pothole_id attribute 
 * @return
 */
public int getPotholeId() 
{
    return pothole_Id;
}//end getPotholeId method

/**
 * Set pothole_id attribute
 * @param pothole_Id
 */
public void setPotholeId(int pothole_Id) 
{
    this.pothole_Id = pothole_Id;
}//end setPotholeId method

/**
 * Get image attribute
 * @return Blob
 */
public Blob getImage()
{
    return image;
}//end getImage method

/**
 * Set image attribute
 * @param image
 */
public void setImage(Blob image) 
{
    this.image = image;
}//end setImage method

 }//end PotholeMedia class 
```

我的问题是我不知道如何使用球衣保存它，这是我迄今为止尝试过的。

```
 @POST
@Path ("/save/image")
@Consumes (MediaType.MULTIPART_FORM_DATA)
public Response saveImg (@FormParam ("file") PotholeMedia media)
{
    try
    {
        EntityManager manager = EMF.getInstance().createEntityManager();
        manager.getTransaction().begin();
        manager.persist(media);
        manager.getTransaction().commit();

        return Response.status(Status.OK).build ();
    }
    catch (Exception e)
    {
        return Response.status(Status.INTERNAL_SERVER_ERROR).build ();
    }
}//end saveImg method 
```

这是保存对象的正确方法吗？如果不是，我应该怎么做。

# 2d - WP8 带像素着色器的图像处理

> ID：13688801
> 
> 赞同：0
> 
> 时间：2012-12-03T17:44:11.047
> 
> 标签：2d, windows-phone-8, pixel-shader

有没有办法在 XAML 应用程序中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:02:11.293

这是一个复杂的答案，它取决于您的 WP8 应用程序是为哪个平台编写的，以及您想要完成的具体目标。

1.  不，您不能像在 Silverlight 上那样在 WP8 上将 XAML 与 HLSL 像素着色器一起使用。WP7/WP8 不支持此功能。

2.  是的，您可以在 D3D WP8 应用程序上使用 HLSL 像素着色器。它们必须在市场提交之前编译，而不是在运行时编译。请参阅有关此的完整详细信息，请参阅 MSDN @ [http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj714072(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj714072(v=vs.105).aspx)

3.  此外，您可以编写自己的自定义 C++ 图像处理代码作为从 C# 调用的 Windows Phone 运行时组件。您还可以通过使用 SIMD\Neon 指令集优化该代码以在 WP8 中真正快速地工作。我们正在诺基亚积极开发一个端到端的 Wp8 样本，用于演示[相机输入的图像处理](http://projects.developer.nokia.com/NativeFilterDemo)。同时，有一个工作演示展示了如何从[C#调用](http://projects.developer.nokia.com/NativeFilterDemo/browser/NativeFilterDemo/CameraStreamSource.cs)[SIMD\NEON 优化的 C++ 代码](http://projects.developer.nokia.com/NativeFilterDemo/browser/NativeComponent/NativeComponent.cpp)。

# vb.net - 获取下一个工作日（跳过周末）的日期以在 HTML 中显示数据

> ID：13688802
> 
> 赞同：2
> 
> 时间：2012-12-03T17:44:11.260
> 
> 标签：vb.net, datetime

我有以下代码：

```
Public Shared Function DPLoadData() As String
    Dim s As StringBuilder = New StringBuilder("<head><meta http-equiv=""content-type"" content=""text/html;charset=utf-8"" /><META HTTP-EQUIV=""REFRESH"" CONTENT=""900"">")
    s.Append("<style type=""text/css"" media=""all""> body{font-family: Arial;}h4{font-size: 10pt;font-weight: bold;white-space: nowrap;margin-top: 0; margin-bottom: 10px;}")
    s.Append("th{font-size: 9pt;font-weight: normal;text-align: center;white-space: nowrap;}td{font-size: 9pt;}.content td{border: solid 1px #dadada;}")
    s.Append(".content th {border: solid 1px #dadada;background-image: url(""tbl_header_row_bg.gif""); background-repeat: repeat-x; white-space: nowrap;}</style></head>")
    s.Append("<h3>" & "Daily Plan" & "</h3>")
    Dim strCurrDay As String = ""
    s.Append("<h5>" & strCurrDay & "</h5>")

    Dim CurrDateFirstDay As Date = DateAdd(DateInterval.Day, 1, Now)
    strCurrDay = FormatDateTime(CurrDateFirstDay, DateFormat.LongDate)

    s.Append("<h5>" & strCurrDay & "</h5>")
    s.Append(LoadDataGroupByDate(CurrDateFirstDay))
    Return s.ToString()
End Function 
```

该函数生成一个带有表格的 HTML 文件，并用预订填充它。目前，HTML 文件显示明天的预订（例如，如果今天是星期一，它会显示星期二的预订）。到现在为止还挺好。我想要的是，如果今天是星期五，HTML 文件应该显示星期一的预订，而不是星期六。那可能吗？

我的解决方案：

```
 If value.DayOfWeek = DayOfWeek.Friday Then

            Dim CurrDateFirstDay As Date = DateAdd(DateInterval.Day, 3, Now)

            strCurrDay = FormatDateTime(CurrDateFirstDay, DateFormat.LongDate)
            s.Append("<h5>" & strCurrDay & "</h5>")
            s.Append(LoadDataGroupByDate(CurrDateFirstDay))
        Else
            Dim CurrDateFirstDay As Date = DateAdd(DateInterval.Day, 1, Now)

            strCurrDay = FormatDateTime(CurrDateFirstDay, DateFormat.LongDate)
            s.Append("<h5>" & strCurrDay & "</h5>")
            s.Append(LoadDataGroupByDate(CurrDateFirstDay))

        End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:00:31.227

如果您创建这样的方法：

```
Public Function GetNextWeekDay() As Date
    Dim value As Date = Date.Now
    Do
        value = value.AddDays(1)
    Loop While (value.DayOfWeek = DayOfWeek.Saturday) Or (value.DayOfWeek = DayOfWeek.Sunday)
    Return value
End Function 
```

然后你可以像这样设置你的变量：

```
Dim CurrDateFirstDay As Date = GetNextWeekDay() 
```

# c# - 如何在 Windows 8 应用程序的文本框中添加滚动？

> ID：13688803
> 
> 赞同：4
> 
> 时间：2012-12-03T17:44:21.387
> 
> 标签：c#, windows-8

我想在 Windows 8 应用程序的文本框中添加滚动查看器。这样用户就可以滚动浏览他的长文本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:48:46.297

将滚动查看器添加到 XAML。然后通过剪切和粘贴文本框的边距来设置滚动查看器的边距，并将文本框的高度和宽度设置为`auto`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-16T01:25:25.350

我只是重写了 Harshit 解释的内容并添加了一些图片和代码。

1.  将滚动查看器添加到 XAML
2.  在 Scrollviewer 中选择 Margin（最佳方法：单击 XAML 中的 TestViewer-Code 以选择它）
3.  将边距值设置为自动
4.  粘贴（在 XAML 中）文本框并将其粘贴到 Scrollviewer-Tag
5.  将文本框的高度和宽度设置为自动
6.  完毕！

XAML：

```
<Page
x:Class="testapp.MainPage"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:newcalapp_winrt"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" Margin="0,4,0,-4">
    <Button Click="showText" Content="ShowText" x:Name="btn" Width="200" Height="56" Margin="1037,620,0,92"></Button>

    <ScrollViewer x:Name="outputTextBoxScrollViewer" Margin="57,200,700,400">
        <TextBox x:Name="outputTextBox" AcceptsReturn="True"/>
    </ScrollViewer>
    <ScrollViewer x:Name="outputTextBlockScrollViewer" Margin="57,450,700,169">
        <TextBlock x:Name="outputTextBlock"/>
    </ScrollViewer>
</Grid>
</Page> 
```

C＃：

```
namespace testapp
{
    public sealed partial class MainPage : Page
    {
        public MainPage()
        {
            this.InitializeComponent();
        }
        void showText(object sender, RoutedEventArgs args)
        {
            //OutputString
            String outputString;

            //Random number
            Random randomizer = new Random();
            int randomNumber = randomizer.Next(0,100000);

            //Some magic with Dates :) Not important!
            ...

            outputTextBox.Text = outputString;
            outputTextBlock.Text = outputString;
        }
    }
} 
```

![ScrollViewer 示例](../Images/7ff58f8202d93461f4d5bbfb59803809.png)

http://i.stack.imgur.com/2qDyJ.png">

# filesystems - fat16中如何区分目录和文件入口？

> ID：13688807
> 
> 赞同：1
> 
> 时间：2012-12-03T17:44:36.907
> 
> 标签：filesystems, fat, fat16

如果在 fat16 系统中，我对区分子目录和文件感到很困惑。子目录和文件结构相似，如何区分目录和文件，如何遍历目录到达文件？

我最初认为所有目录条目都将以“0x2e”作为 fat16 中 8.3 命名约定的第一个字节。但实际上我找不到所有以 0x2e 开头的目录，而是直接找到目录的名称。那么，如何区分 fat16 中的目录和文件呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:41:28.557

目录在属性字段中设置了 0x10 位；文件没有。第一个字节是“。” (0x2E) 用于自身和父目录，如果存在（它们不在根目录中）。

目录“文件”的内容是目录条目数组。

忽略长文件名，您搜索文件的方式是：

1.  搜索目录 = 根
2.  从剩余路径解析 8.3 名称
3.  DirectoryEntry = 在 SearchDirectory 中查找 8.3 名称
4.  如果剩余路径为空，则 DirectoryEntry 是请求的实体
5.  如果 Directory.Attribute & 0x10 == 0 则 ERROR（期望目录）
6.  SearchDirectory = DirectoryEntry.contents
7.  转到 2

# html - 使用单个按钮上传文件

> ID：13688814
> 
> 赞同：2
> 
> 时间：2012-12-03T17:44:51.213
> 
> 标签：html, file-upload

到目前为止，我发现的所有使用 PHP 上传文件的示例都包括：

1.  选择文件
2.  按提交按钮上传（使用帖子）。

这里有一些： [示例 1](http://www.w3schools.com/php/php_file_upload.asp) [示例 2](https://stackoverflow.com/questions/3245345/uploading-a-file)。

有没有办法在选择文件后立即提交文件，这样用户就不必单击“上传”按钮？我知道这是可能的。查看 Dropbox 的网站或 Google Drive。不过，我不确定他们是否使用 PHP。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:17:19.380

你有两种方式：

1.  用户 jquery：

> ```
> <form  id="frm" action="upload_file.php" method="post"
> enctype="multipart/form-data">
> <label for="file">Filename:</label>
> <input type="file" name="file" id="file" /><br/>
> </form>
> 
> <script type="text/javascript">
> <!--
>   $(document).ready(function(){
>      $('#file').change(function(){
>            $('#frm').submit();
>      });
>   })
> -->
> </script> 
> ```

1.  使用 Flash 上传器。

我希望能帮助你...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:49:49.853

出于安全原因，HTML 文件上传按钮不可编写脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:52:45.090

您想要的是作为 HTML5 [http://www.w3.org/TR/FileAPI/](http://www.w3.org/TR/FileAPI/)一部分的文件 API，它包含通过 AJAX 请求等上传数据的功能。

不幸的是，浏览器支持仍然参差不齐，所以虽然您可以在 Chrome 或 Firefox 上实现像 Dropbox 这样的拖放 UI。你需要有一个 IE 的后备。

[http://www.html5rocks.com/en/features/file_access](http://www.html5rocks.com/en/features/file_access)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-27T06:49:45.747

**无论浏览器不兼容，下面的代码都将解决您的问题。我经常使用这个。**

```
function startUpload() {
    var file_button = document.createElement('input');
    file_button.type = "file";
    file_button.id = "file_button1";
    file_button.style.display = "none";
    file_button.style.position = "absolute";
    file_button.onchange = function() {
        var form_data = new FormData();
        var file = jQuery(this).get(0).files[0];
        form_data.append('file', file);
        form_data.append('type', type);
        form_data.append('name', 'fileToUpload');
        setTimeout(function() {
            jQuery.ajax({
                url: "/uploadfile.php",
                type: "POST",
                cache: false,
                contentType: false,
                processData: false,
                data: form_data,
                xhr: function() {
                    var myXhr = jQuery.ajaxSettings.xhr();
                    if (myXhr.upload) {
                        myXhr.upload.addEventListener('progress', custom_progress, false);
                    }
                    return myXhr;
                },
                success: function(response) {
                    console.log(response);
                }
            });
        }, 1000);
    };
    jQuery(document.body).append(file_button);
    file_button.click();
    jQuery("#file_button1").remove();
}
function custom_progress(e) {
    if (e.lengthComputable) {
        var x = (e.loaded / e.total) * 100;
        jQuery("#progress").html(x + "%");
    }
} 
```

**您的服务器端代码看起来像这样**

```
<?php

$target_dir = "uploads/";
$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
$uploadOk = 1;
$imageFileType = pathinfo($target_file, PATHINFO_EXTENSION);
// Check if image file is a actual image or fake image
$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
if ($check !== false) {
    echo "File is an image - " . $check["mime"] . ".";
    $uploadOk = 1;
} else {
    echo "File is not an image.";
    $uploadOk = 0;
} 
```

[在Ajax 文件上传和进度](http://javascriptsolution.com/ajax-file-upload-and-progress/)处找到此解决方案

# python - 使用 UPX 压缩已编译的 wxPython 程序

> ID：13688815
> 
> 赞同：0
> 
> 时间：2012-12-03T17:45:03.137
> 
> 标签：python, wxpython, inno-setup, pyinstaller, upx

我正在使用 wxPython 创建 guis，然后使用 pyInstaller 编译它们，最后使用 inno 来设置它们。

看到我对这一切都很陌生，我想知道，我是否需要使用 UPX 来压缩最终编译的 exe？还是exe需要运行的所有东西？

谢谢，对不起，我是菜鸟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:05:21.143

我认为您不能在 exe 之前压缩文件，否则您会遇到 Python 无法读取 zip 文件的问题。您可能可以在这里使用鸡蛋，但我不相信鸡蛋是压缩的。我只是尝试用 UPX 压缩 exe，看看效果如何。

我个人并不担心。exe通常为20-40 MB，硬盘空间便宜且充足。

# debugging - 使用 gdb 或类似工具在 bsd 上调试

> ID：13688816
> 
> 赞同：0
> 
> 时间：2012-12-03T17:45:07.893
> 
> 标签：debugging, gdb, remote-debugging, freebsd, bsd

最近开始使用freebsd，发现gdb不支持远程调试。每当我尝试使用 gdbserver 进行远程调试时，都会遇到 SIGSEGV 崩溃和错误消息说找不到“r_debug_state”的定义。有没有人经历过并解决它？可以使用 gdbserver 编译静态编译的单线程程序。然而，除此之外，它大多看起来很难使用。

让我知道是否有人知道任何其他工具可以在 bsd 上进行远程应用程序调试或如何解决该问题。

（我在 x64 freebsd 9 上）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:57:53.583

你用的是系统自带的gdb吗？如果是这样，您可能会考虑安装端口中的 gdb `devel/gdb`，.

# tomcat - 如何在 webapp 中读取文件而不将其放在 Tomcat 的 /bin 文件夹中

> ID：13688819
> 
> 赞同：0
> 
> 时间：2012-12-03T17:45:21.643
> 
> 标签：tomcat, servlets, file-io

我正在尝试使用文件描述符在 doGet 方法上从 Tomcat 容器中读取文件。该程序在执行时会在 tomcat bin 文件夹下查找“sample.txt”。我不希望我的资源文件成为 Tomcat bin 的一部分。我如何以更好的方法读取文件，这使我可以灵活地定义我的资源目录。我还尝试从部署为 Tomcat 中的辅助类的 POJO 中读取文件。我还可以在 tomcat 中配置类路径以在不同目录中查找文件吗？任何指针都会有很大帮助。

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    PrintWriter out = response.getWriter();
    out.print("Sample Text");
    RSAPublicCertificate rsa = new RSAPublicCertificate();
    out.print(rsa.getCertificate());
    File file = new File("sample.txt");
    out.print(file.getAbsolutePath());
    FileInputStream in = new FileInputStream(file);

}

D:\apache-tomcat-6.0.20\bin\sample.txt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:32:04.563

您确实应该避免使用`new File()`and`new FileInputStream()`相对路径。有关背景信息，另请参阅[getResourceAsStream() 与 FileInputStream](https://stackoverflow.com/questions/2308188/getresourceasstream-vs-fileinputstream/2308388#2308388)。

只需使用绝对路径，例如

```
File file = new File("/absolute/path/to/sample.txt");
// ... 
```

或将给定路径添加到类路径作为`shared.loader`属性 `/conf/catalina.propeties`

```
shared.loader = /absolute/path/to 
```

这样您就可以从类路径中获取它，如下所示

```
InputStream input = Thread.currentThread().getContextClassLoader().getResourceAsStream("sample.txt");
// ... 
```

# facebook - Facebook Graph API 以用户身份发表评论

> ID：13688828
> 
> 赞同：3
> 
> 时间：2012-12-03T17:46:09.547
> 
> 标签：facebook, facebook-graph-api, post, facebook-javascript-sdk, facebook-comments

我正在尝试在没有 Facebook 评论插件的网站内构建评论方法。

它是网站的图片库部分，所有照片实际上都托管在业务页面上，我这样做是为了利用 FB 上传、调整大小/旋转等，而不必自己构建。

作为一个快乐的副产品，我想我可以将网站上的评论与 FB 上的评论联系起来，并有一个同步的评论系统，因此发布在任一站点（我的网站或 FB）上的评论将同样显示在任一站点上。

所以，我已经想出了如何发布评论，但它总是作为商业页面发布，而不是登录用户。

此代码发布评论，变量`obj`是 Facebook 上照片的 ID。`msg`显然是评论文本。我有设置方法来在需要的地方获得正确的权限，如果帖子的响应表明需要这样做，则会调用这些方法。

```
FB.api('/' + obj + '/comments',
     'post',
     { "message": msg,
       "access_token": accessToken,
       "from": uid
     }, // do the post
     function (response) { // check the response
                if (!response || response.error) { // if there's an error
          // DO STUFF WITH ERRORS/REQUEST PERMS ETC
     } else {
       alert("Msg posted id: " + response.id);
    };
}); 
```

上面的一切都有效，但是当评论出现时，它总是显示`from: my Page ID`不是，我需要的是`from: my user id`

`accessToken`并按`UID`如下方式检索：

```
FB.getLoginStatus(function (response) {
    if (response.status === 'connected') {
        uid = response.authResponse.userID;
        accessToken = response.authResponse.accessToken;
     }
 }); 
```

第一个函数中的 para`from`发布的是用户 ID，而不是页面 ID，但无论该 para 是否存在，它总是将评论发布为页面。

到目前为止，这让我很沮丧，因为这很容易实现！

# c - C读写中的二进制文件

> ID：13688832
> 
> 赞同：0
> 
> 时间：2012-12-03T17:46:12.403
> 
> 标签：c

我很想在 C 中使用带有二进制文件的结构。我读了一个人的结构文件。每个人都有一个属性 is_a_winner，is_runner_up 如果 is_a_winner 为 true 我应该在 Prize 字段中添加 Gold，如果 is_runner_up 为 true，则添加 Silver，否则添加铜牌。它适用于某些结构，但不适用于其他结构。我认为这可能与文件中“光标”的定位有关。

```
struct prizelist{
    char name[10];
    int is_a_winner;
    int is_runner_up;
    int age;
    char prize[20];
};

void addPrize() {
    FILE *fp;
    if ((fp = fopen("prize.out", "rb+"))!=NULL) {
        size_t itemSize = sizeof(struct prizelist);
        struct prizelist item;
        fread(&item,1,itemSize, fp);
        while (!feof(fp)) {
            if (item.is_a_winner) {
                strcpy( item.prize, "Gold" );   
            } else if (item.is_runner_up) { 
                strcpy( item.prize, "Silver" );         
            } else {
                strcpy( item.prize, "Bronze" );             
            }
            fseek(fp, itemSize, SEEK_CUR);
            fwrite(&item, itemSize, 1, fp);
            fread(&item,1,itemSize, fp);
        }
        fclose(fp);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:11:05.227

您提供的代码可以归结为：

```
fread(&item,1,itemSize, fp);
while (!finished) {
  fseek(fp, itemSize, SEEK_CUR);
  fwrite(&item, itemSize, 1, fp);
  fread(&item,1,itemSize, fp); 
```

问题出在您的 fseek() 调用中；您正在从文件中的当前 ( `SEEK_CUR`) 位置*向前*进行相对搜索，然后写入文件...如果我理解您打算更新刚刚阅读的记录，那么您的搜索方向是错误的。如果您的第一条记录是记录 0，则读取后您的位置在记录 1，然后您寻求记录 2，然后您写入。哎呀！相反，寻找：`fseek(fp, -itemSize, SEEK_CUR);`向后移动。

# python - Python切片操作

> ID：13688834
> 
> 赞同：-3
> 
> 时间：2012-12-03T17:46:17.067
> 
> 标签：python

有人可以解释为什么下面的切片有效吗？

```
>>> S='SPAM'
>>> S[1:1]
   '' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:46:47.207

因为选择一个空切片是合法的。

您甚至可以选择无意义的切片：

```
>>> 'foo'[1:0]
'' 
```

# tortoisesvn - svn更新无法正常工作

> ID：13688836
> 
> 赞同：0
> 
> 时间：2012-12-03T17:46:18.727
> 
> 标签：tortoisesvn

Svn 更新不完全工作。一些更新即将到来，然后发生一些错误。像 403 禁止错误。现在我需要进入每个文件夹并必须单独更新。谁能告诉我可能是什么问题以及我有什么去做？我正在使用乌龟 svn。

svn 本身也会提示执行清理。但是当我尝试清理时。清理无法正常工作的消息正在显示..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T13:11:21.350

svn 升级到下一个版本时问题已修复

# performance - 是什么导致我经过的时间比用户时间长得多？

> ID：13688840
> 
> 赞同：11
> 
> 时间：2012-12-03T17:46:38.860
> 
> 标签：performance, r

我正在对一些 R 语句进行基准测试（请参阅[此处](https://stackoverflow.com/questions/13685295/descending-sort-in-data-table-and-speed)的详细信息），发现我经过的时间比我的用户时间长得多。

```
 user  system elapsed 
  7.910   7.750  53.916 
```

有人可以帮助我了解哪些因素（R 或硬件）决定了用户时间和经过时间之间的差异，以及如何改进它？如果它有帮助：我正在使用 4GB RAM 的 Macbook Air 1.7Ghz i5 上运行 data.table 数据操作。

更新：我粗略的理解是，用户时间是我的 CPU 处理我的工作所花费的时间。经过时间是从我提交作业到我取回数据的时间。我的电脑在处理 8 秒后还需要做什么？

更新：正如评论中所建议的，我在两个 data.table 上运行了几次：Y，有 104 列（对不起，随着时间的推移，我添加了更多列），X 作为 Y 的子集，只有 3 个键。以下是更新。请注意，我连续运行了这两个程序，因此内存状态应该相似。

```
 X<- Y[, list(Year, MemberID, Month)]

 system.time(
   {X[ , Month:= -Month]
   setkey(X,Year, MemberID, Month)
   X[,Month:=-Month]}
  )
   user  system elapsed 
  3.490   0.031   3.519 

 system.time(
 {Y[ , Month:= -Month]
  setkey(Y,Year, MemberID, Month)
  Y[,Month:=-Month]}
 )
   user  system elapsed 
  8.444   5.564  36.284 
```

这是我的工作区中仅有的两个对象的大小（添加了逗号）。：

```
object.size(X)
83,237,624 bytes

 object.size(Y)
2,449,521,080 bytes 
```

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-06T21:23:24.627

用户时间是计算机用于计算的秒数。系统时间是操作系统响应程序请求所花费的时间。经过的时间是这两者的总和，加上你的程序和/或操作系统必须做的任何“等待”。需要注意的是，这些数字是所花费时间的总和。您的程序可能会计算 1 秒，然后在操作系统上等待 1 秒，然后在磁盘上等待 3 秒，并在运行时重复此循环多次。

基于您的程序占用的系统时间与用户时间一样多的事实，这是一个非常 IO 密集型的事情。从磁盘读取很多或写入磁盘很多。RAM 非常快，通常为几百纳秒。因此，如果一切都适合 RAM，则经过的时间通常比用户时间长一点。但是磁盘可能需要几毫秒的时间来寻找，甚至更长的时间来回复数据。这慢了一百万倍。

我们已经确定您的处理器“工作”了 ~8 + ~8 = ~ 16 秒。另一个 ~54 - ~16 = ~38 秒是做什么的？等待硬盘驱动器将其要求的数据发送给它。

更新1：

马修提出了一些很好的观点，我做出了一些我可能不应该做出的假设。亚当，如果您愿意发布表中所有行的列表（我们只需要数据类型），我们可以更好地了解正在发生的事情。

我刚刚编写了一个什么都不做的程序来验证我的假设，即没有花在用户空间和内核空间的时间很可能花在等待 IO 上。

```
#include <stdio.h>
int main()
{
    int i;
    for(i = 0; i < 1000000000; i++)
    {
        int j, k, l, m;
        j = 10;
        k = i;
        l = j + k;
        m = j + k - i + l;
    }
    return 0;
} 
```

当我运行生成的程序并对其计时时，我会看到如下内容：

```
mike@computer:~$ time ./waste_user
real    0m4.670s
user    0m4.660s
sys 0m0.000s
mike@computer:~$ 
```

正如您通过检查看到的那样，该程序没有真正的工作，因此它不会要求内核做任何事情，只是将其加载到 RAM 中并开始运行。所以几乎所有的“真实”时间都花在了“用户”时间上。

现在是一个内核重的无操作程序（减少了一些迭代以保持时间合理）：

```
#include <stdio.h>
int main()
{
    FILE * random;
    random = fopen("/dev/urandom", "r");
    int i;
    for(i = 0; i < 10000000; i++)
    {
        fgetc(random);
    }
    return 0;
} 
```

当我运行那个时，我看到更像这样的东西：

```
mike@computer:~$ time ./waste_sys
real    0m1.138s
user    0m0.090s
sys     0m1.040s
mike@computer:~$ 
```

再次通过检查很容易看出，程序只是要求内核给它随机字节。/dev/urandom 是一个非阻塞的熵源。这意味着什么？内核使用伪随机数生成器为我们的小测试程序快速生成“随机”值。这意味着内核必须进行一些计算，但它可以很快返回。所以这个程序主要是等待内核为它计算，我们可以看到这反映在几乎所有时间都花在 sys.sys 上。

现在我们要做一点改变。我们不会从非阻塞的 /dev/urandom 读取，而是从阻塞的 /dev/random 读取。这意味着什么？它不会做太多的计算，而是等待内核开发人员根据经验确定是随机的事情发生在您的计算机上。（我们也将做更少的迭代，因为这些东西需要更长的时间）

```
#include <stdio.h>
int main()
{
    FILE * random;
    random = fopen("/dev/random", "r");
    int i;
    for(i = 0; i < 100; i++)
    {
        fgetc(random);
    }
    return 0;
} 
```

当我运行和计时这个版本的程序时，我看到的是：

```
mike@computer:~$ time ./waste_io
real    0m41.451s
user    0m0.000s
sys     0m0.000s
mike@computer:~$ 
```

运行时间为 41 秒，但在用户和真实用户上花费的时间非常少。这是为什么？所有时间都花在内核中，但没有进行主动计算。内核只是在等待事情发生。一旦收集到足够的熵，内核就会重新唤醒并将数据发送回程序。（请注意，根据发生的情况，在您的计算机上运行可能需要更少或更多的时间）。我认为 user+sys 和 real 之间的时间差异是 IO。

那么，这意味着什么？这并不能证明我的回答是正确的，因为可能还有其他解释可以解释为什么您会看到自己的行为。但它确实展示了用户计算时间、内核计算时间和我所说的花在 IO 上的时间之间的差异。

这是我/dev/urandom和/dev/random之间区别的来源： [http ://en.wikipedia.org/wiki//dev/random](http://en.wikipedia.org/wiki//dev/random)

更新2：

我想我会尝试解决 Matthew 的建议，即 L2 缓存未命中可能是问题的根源。Core i7 有一个 64 字节的高速缓存行。我不知道您对缓存了解多少，所以我将提供一些详细信息。当你从内存中请求一个值时，CPU 不会只得到那个值，它会得到它周围的所有 64 个字节。这意味着如果您以非常可预测的模式访问内存——比如数组[0]、数组[1]、数组[2]等——需要一段时间才能获得值 0，然后是 1、2， 3, 4... 快得多。直到你到达下一个缓存行，就是这样。如果这是一个整数数组，0 会很慢，1..15 会很快，16 会很慢，17..31 会很快，等等。

[http://software.intel.com/en-us/forums/topic/296674](http://software.intel.com/en-us/forums/topic/296674)

为了测试这一点，我制作了两个程序。它们都有一个结构数组，其中包含 1024*1024 个元素。在一种情况下，结构中有一个双精度，在另一种情况下，它有 8 个双精度。double 的长度为 8 个字节，因此在第二个程序中，我们以最糟糕的方式访问内存以获取缓存。第一个将很好地使用缓存。

```
#include <stdio.h>
#include <stdlib.h>
#define MANY_MEGS 1048576
typedef struct {
    double a;
} PartialLine;
int main()
{
    int i, j;
    PartialLine* many_lines;
    int total_bytes = MANY_MEGS * sizeof(PartialLine);
    printf("Striding through %d total bytes, %d bytes at a time\n", total_bytes, sizeof(PartialLine));
    many_lines = (PartialLine*) malloc(total_bytes);
    PartialLine line;
    double x;
    for(i = 0; i < 300; i++)
    {
        for(j = 0; j < MANY_MEGS; j++)
        {
            line = many_lines[j];
            x = line.a;
        }
    }
    return 0;
} 
```

当我运行这个程序时，我看到了这个输出：

```
mike@computer:~$ time ./cache_hits
Striding through 8388608 total bytes, 8 bytes at a time
real    0m3.194s
user    0m3.140s
sys     0m0.016s
mike@computer:~$ 
```

这是具有大结构的程序，它们每个占用 64 个字节的内存，而不是 8 个。

```
#include <stdio.h>
#include <stdlib.h>
#define MANY_MEGS 1048576
typedef struct {
    double a, b, c, d, e, f, g, h;
} WholeLine;
int main()
{
    int i, j;
    WholeLine* many_lines;
    int total_bytes = MANY_MEGS * sizeof(WholeLine);
    printf("Striding through %d total bytes, %d bytes at a time\n", total_bytes, sizeof(WholeLine));
    many_lines = (WholeLine*) malloc(total_bytes);
    WholeLine line;
    double x;
    for(i = 0; i < 300; i++)
    {
        for(j = 0; j < MANY_MEGS; j++)
        {
            line = many_lines[j];
            x = line.a;
        }
    }
    return 0;
} 
```

当我运行它时，我看到了这个：

```
mike@computer:~$ time ./cache_misses
Striding through 67108864 total bytes, 64 bytes at a time
real    0m14.367s
user    0m14.245s
sys     0m0.088s
mike@computer:~$ 
```

第二个程序——设计用于缓存未命中的程序——运行相同数量的内存访问需要五倍的时间。

另外值得注意的是，在这两种情况下，所有花费的时间都花在了 user 上，而不是 sys 上。这意味着操作系统正在计算您的程序必须等待针对您的程序而不是针对操作系统的数据的时间。鉴于这两个示例，我认为缓存未命中不太可能导致您的经过时间大大长于您的用户时间。

更新3：

我刚刚看到你的更新，真正瘦身的桌子比普通尺寸的桌子快大约 10 倍。这也将向我表明（正如另一个 Matthew 也说过）你的 RAM 用完了。

一旦您的程序尝试使用比计算机实际安装更多的内存，它就会开始交换到磁盘。这比您的程序崩溃要好，但它比 RAM 慢得多，并且可能导致显着减速。

明天我将尝试整理一个显示交换问题的示例。

更新4：

好的，这是一个与上一个非常相似的示例程序。但是现在结构是 4096 字节，而不是 8 字节。该程序总共将使用 2GB 内存而不是 64MB。我还做了一些改动，并确保我随机访问事物而不是逐个元素地访问，这样内核就无法变得聪明并开始预测我的程序需求。缓存由硬件驱动（仅由简单的启发式驱动），但kswapd（内核交换守护进程）完全有可能比缓存更智能。

```
#include <stdio.h>
#include <stdlib.h>
typedef struct {
    double numbers[512];
} WholePage;
int main()
{
    int memory_ops = 1024*1024;
    int total_memory = memory_ops / 2;
    int num_chunks = 8;
    int chunk_bytes = total_memory / num_chunks * sizeof(WholePage);
    int i, j, k, l;
    printf("Bouncing through %u MB, %d bytes at a time\n", chunk_bytes/1024*num_chunks/1024, sizeof(WholePage));
    WholePage* many_pages[num_chunks];
    for(i = 0; i < num_chunks; i++)
    {
        many_pages[i] = (WholePage*) malloc(chunk_bytes);
        if(many_pages[i] == 0){ exit(1); }
    }
    WholePage* page_list;
    WholePage* page;
    double x;
    for(i = 0; i < 300*memory_ops; i++)
    {
        j = rand() % num_chunks;
        k = rand() % (total_memory / num_chunks);
        l = rand() % 512;
        page_list = many_pages[j];
        page = page_list + k;
        x = page->numbers[l];
    }
    return 0;
} 
```

从我调用 cache_hits 到 cache_misses 的程序，我们看到内存大小增加了 8 倍，执行时间增加了 5 倍。当我们运行这个程序时，你希望看到什么？它使用的内存是 cache_misses 的 32 倍，但内存访问次数相同。

```
mike@computer:~$ time ./page_misses
Bouncing through 2048 MB, 4096 bytes at a time
real    2m1.327s
user    1m56.483s
sys     0m0.588s
mike@computer:~$ 
```

它花费了 cache_misses 的 8 倍和 cache_hits 的 40 倍。这是在具有 4GB RAM 的计算机上。我在这个程序中使用了 50% 的 RAM，而 cache_misses 使用了 1.5%，cache_hits 使用了 0.2%。即使它没有用完我计算机的所有 RAM，它也变得非常慢。这已经足够重要了。

我希望这是一本关于如何诊断程序运行缓慢的问题的不错的入门读物。

# javascript - Facebook 通过应用程序发布 swf

> ID：13688844
> 
> 赞同：2
> 
> 时间：2012-12-03T17:47:01.000
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk

我有点卡住了。

我有一个 Joomla 网站，我的应用程序可以正常工作，任何应用程序用户都可以使用 FBui 将某些页面上的视频发布到他们的墙上——但我真正想要的是能够将视频发布到任何地方，我看了使用 og 标签，我已经添加了它们，但视频没有显示 - 我猜我在某个地方遇到了问题或冲突。示例页面：

专辑页面 - [http://fnoob.com/archives/P/34-alex-paterson/468-chewy-choosedays-vol-91-100](http://fnoob.com/archives/P/34-alex-paterson/468-chewy-choosedays-vol-91-100)

这是相关的标题部分（我已取出链接+ appid - 我知道它们有效）：

```
 <html xmlns:fb="http://www.facebook.com/2008/fbml" xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#" xml:lang="en-gb" lang="en-gb" slick-uniqueid="3">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# video: http://ogp.me/ns/video#"><meta property="fb:app_id" content="my_app_id">
        <meta property="og:type" content="video.other" >
        <meta property="og:url" content="path_to_swf" >
        <meta property="og:image" content="path_to_image" > 
```

再往下，我们有 post to wall 功能，它的工作原理是：

```
<div id='fb-root'></div>
                <script> 
                var APP_ID='137867843030139';

                window.fbAsyncInit = initFacebook;

                function initFacebook()
                {
                    FB.init({
                        appId  : APP_ID,
                        status : true, // check login status
                        cookie : false, // enable cookies to allow the server to access the session
                        xfbml  : true  // parse XFBML
                        });

                FB.getLoginStatus(onFacebookLoginStatus);
                };

                (function() {
                var e = document.createElement('script');
                e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
                e.async = true;
                document.getElementById('fb-root').appendChild(e);

                }());

    function facebookLogout()
    {
        FB.logout();
        var loginButtonDiv=document.getElementById("fb-login-button-div");
        loginButtonDiv.style.display="block";   
        var logoutButtonDiv=document.getElementById("fb-logout-button-div");
        logoutButtonDiv.style.display="none";   
        var contentDiv=document.getElementById("user-is-authenticated-div");
        contentDiv.style.display="none";            
    }

    function facebookLogin()
    {
        var loginUrl='http://www.facebook.com/dialog/oauth/?'+
            'scope=publish_stream,manage_pages&'+
            'client_id='+APP_ID+'&'+
            'redirect_uri='+document.location.href+'&'+
            'response_type=token';      
        window.location=loginUrl;
    }

    /*
    * Callback function for FB.login
    */

    function onFacebookLoginStatus(response)
    {
        if (response.status=='connected' && response.authResponse)
        {
            var loginButtonDiv=document.getElementById("fb-login-button-div");
            loginButtonDiv.style.display="none";
            var logoutButtonDiv=document.getElementById("fb-logout-button-div");
            logoutButtonDiv.style.display="none";
            var contentDiv=document.getElementById("user-is-authenticated-div");
            contentDiv.style.display="block";

        }
        else
        {
            var loginButtonDiv=document.getElementById("fb-login-button-div");
            loginButtonDiv.style.display="block";   
            var contentDiv=document.getElementById("user-is-authenticated-div");
            contentDiv.style.display="none";            
        }

    }  

    function postToWallUsingFBUi()
    {   
        var data=
        {
            method: 'feed',  
            message: '',
            display: 'iframe',
            caption: '<? echo $this->album->artist_name; ?> Click to Listen',
            name: '<? echo $this->album->name; ?>',
            picture: 'http://fnoob.com/images/albums/<? echo $this->album->image; ?>',   
            source: link_to_file',  
            link: '<? echo $album_link ?>',  // Go here if user click the picture
            description: 'By artist  <? echo $this->album->artist_name; ?> on <? echo $this->album->format_name; ?> and powered by FNOOB.com ',
            actions: [{ name: 'fnoob.com', link: '<? echo $album_link ?>' }],           
        }
        FB.ui(data, onPostToWallCompleted);
    }

    function onPostToWallCompleted(response)
    {
        if (response)
        {
            //console.log(response);
            if (response.error)
            {
                alert(response.error.message);
            }
            else
            {
                if (response.id)
                    alert('Posted.... carry on!');                      
                else if (response.post_id)
                    alert('Posted.... carry on!');
                else
                    alert('Crap... something went wrong');
            }
        }
        // user cancelled
    }

    </script> 
```

所以我想要的基本上是每次在 facebook 上共享此页面（页面、提要等）时，图像和视频会加载，如果单击它会播放并链接到网站上的页面。任何帮助都非常感谢 - 尝试了一天左右的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T13:39:20.613

添加这个标签

```
<meta property="og:video:width" content="640" />
<meta property="og:video:height" content="360" />
<meta property="og:video:type" content="application/x-shockwave-flash" />
<meta property="og:video" content="DIRECT_VIDEO_FILE_URL" />
<meta property="og:video:secure_url" content="DIRECT_VIDEO_FILE_URL_SSL" /> 
<meta property="og:image" content="Image_you_want_to_use_as_thumbnail" /> 
<meta property="og:image:secure_url" content="Image_you_want_to_use_as_thumbnail_SSL" /> 
```

视频文件将以 mp4 和 swf 格式工作。
让这个工作的重要部分是你从**SSL** / **HTTPS**源传递文件

图像将是播放按钮后面的缩略图

# c# - 尝试安装时 C# 服务中的 System.TypeInitializationException

> ID：13688846
> 
> 赞同：0
> 
> 时间：2012-12-03T17:47:33.087
> 
> 标签：c#, asp.net-mvc, service

该程序在调试模式下构建并运行良好。我可以使用 vs 命令提示符 installutil 手动安装它，但是当我发布程序并尝试使用 setup.exe 在另一台机器上安装它时，我收到此错误并且不知道为什么。

我应该寻找什么样的东西会导致 System.TypeInitializationException？什么场景会导致这个异常？

让我进一步澄清一下。程序不是我写的，这是我接手的一个项目，所以不知道去哪里找这种类型的异常。installer.cs 文件没有任何静态变量或构造函数。这会导致问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:50:15.173

这意味着无法初始化类型，因为在静态初始化程序或静态构造函数中发生异常。

```
class MyClass
{
    static Monkey monkey = new ThrowingErrorMonkey(); //here
    static MyClass()
    {
        throw new Exception(); //or here
    }
} 
```

# android - Android - 移除状态栏

> ID：13688850
> 
> 赞同：0
> 
> 时间：2012-12-03T17:47:49.563
> 
> 标签：android

为 ICS (4.0.3) 构建一个全屏应用程序，我需要完全删除状态栏。

我开始使用 Eclipse 模板（全屏活动）构建我的应用程序，但我发现当我单击应用程序时，状态栏会重新出现！- 我不要这个！

我现在通过构建一个空白活动并将状态栏设置为新的透明活动（使用 3 个灯按钮）得到它

```
getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN | View.SYSTEM_UI_FLAG_LOW_PROFILE); 
```

这是我用来实现这一点的代码，有什么方法可以完全删除它？或者编辑全屏模板，这样当你点击或触摸它时它就不会重新出现？

干杯理查德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T17:58:52.043

在 ICS 上，需要考虑两个栏：导航栏（在底部）和状态栏在顶部。状态栏删除是使用应用程序主题完成的。（也可以在代码中完成）。

导航栏的行为在 ICS 平板电脑和 ICS 手机之间有所不同。在 ICS 平板电脑上，导航栏无法移除——只能进入低调模式。在手机上，可以移除 NAV 栏。您发布的代码应该可以做到。

操作栏是第三种选择。我确实相信状态栏与某些示例中的操作栏显示/隐藏相关联。搜索出现的 WindowManager.LayoutParams.FLAG_FULLSCREEN（用于显示和隐藏代码中的状态栏）并相应地编辑您找到的代码。

编辑：哎呀。3.0 设备上的时间过多... API 16 中的新功能：SYSTEM_UI_FLAG_FULLSCREEN。看起来像你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:52:16.170

尝试将以下主题添加到 AndroidManifest.xml 上的活动声明中

对于轻主题

```
<activity ...
     android:theme="@android:style/Theme.Holo.Light.NoActionBar.Fullscreen">
</activity> 
```

对于深色主题

```
<activity ...
     android:theme="@android:style/Theme.Holo.NoActionBar.Fullscreen">
</activity> 
```

如果您已经有一个主题，您可能需要扩展相应的主题。

# javascript - AngularJs 指令中的数据绑定

> ID：13688852
> 
> 赞同：7
> 
> 时间：2012-12-03T17:48:07.223
> 
> 标签：javascript, angularjs

当我创建指令时，我很难弄清楚如何确保我保持双向数据绑定。这是我正在使用的东西和小提琴：

[http://jsfiddle.net/dkrotts/ksb3j/6/](http://jsfiddle.net/dkrotts/ksb3j/6/)

HTML：

```
<textarea my-maxlength="20" ng-model="bar"></textarea>
<h1>{{bar}}</h1> 
```

指示：

```
myApp.directive('myMaxlength', ['$compile', function($compile) {
return {
    restrict: 'A',
    scope: {},
    link: function (scope, element, attrs, controller) {
        element = $(element);

        var counterElement = $compile(angular.element('<span>Characters remaining: {{charsRemaining}}</span>'))(scope);

        element.after(counterElement);

        scope.charsRemaining = parseInt(attrs.myMaxlength);

        scope.onEdit = function() {
            var maxLength = parseInt(attrs.myMaxlength),
                currentLength = parseInt(element.val().length);

            if (currentLength >= maxLength) {
                element.val(element.val().substr(0, maxLength));
                scope.charsRemaining = 0;
            } else {
                scope.charsRemaining = maxLength - currentLength;
            }

            scope.$apply(scope.charsRemaining);
        }

        element.keyup(scope.onEdit)
            .keydown(scope.onEdit)
            .focus(scope.onEdit)
            .live('input paste', scope.onEdit);
        element.on('ngChange', scope.onEdit);
    }
}
}]); 
```

当我在文本区域中输入时，模型并没有像我需要的那样更新。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T19:26:18.183

好吧，双向数据绑定不起作用有两个原因。首先，您需要在本地范围属性和父范围属性之间创建双向绑定：

```
scope: { bar: "=ngModel" } 
```

否则，您将创建一个隔离范围（请参阅[http://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)）。

另一个原因是您必须用父级的追加替换后插入指令（因为您只是在 dom.ready 上引导角度）：

```
element.parent().append(counterElement); 
```

更新 jsfiddle：http: [//jsfiddle.net/andregoncalves/ksb3j/9/](http://jsfiddle.net/andregoncalves/ksb3j/9/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T18:58:02.387

你真的需要自定义指令吗？AngularJS 附带了一个`ngMaxlength`指令，它`ngChange`可能会帮助你。

例如，如果您有以下 HTML

```
<body ng-controller="foo">
    <form name="myForm">
        <textarea name = "mytextarea"
                  ng-maxlength="20" 
                  ng-change="change()"
                  ng-model="bar"></textarea>
         <span class="error" ng-show="myForm.mytextarea.$error.maxlength">
             Too long!
         </span>
        <span> {{left}} </span>
        <h1>{{bar}}</h1>
    </form>                 
</body> 
```

然后你只需要这个到你的控制器中

```
function foo($scope) {  
    $scope.change = function(){
        if($scope.bar){
           $scope.left = 20 - $scope.bar.length;            
        }else{
           $scope.left = "";
        }      
    };
    $scope.bar = 'Hello';
    $scope.change();
} 
```

让 angular 尽可能多地处理 dom。

这是更新的 jsfiddle：http: [//jsfiddle.net/jaimem/ksb3j/7/](http://jsfiddle.net/jaimem/ksb3j/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T17:57:39.217

我不完全确定，但我认为你想要的是一个过滤器，看看这个 url，也许这是重新考虑你的问题的好方法。

[http://docs.angularjs.org/api/ng.filter:limitTo](http://docs.angularjs.org/api/ng.filter:limitTo)

# html - 元框中的分数输入

> ID：13688856
> 
> 赞同：0
> 
> 时间：2012-12-03T17:48:12.080
> 
> 标签：html, wordpress, user-input

我正在为我的元框使用输入类型 =“数字”，当您输入新项目并发布但返回同一个帖子并尝试更新任何内容时，它工作正常，它不允许它并显示“无效输入” ' 下一个分数。我不知道这不被支持以为类型数字意味着所有数字，包括分数，但令人困惑的是为什么浏览器允许发布但不更新，因为值已经存在？修补此问题的最佳方法是什么，将其改为文本输入？

![尝试保存分数时 HTML5 数字输入无效值](../Images/b00558ab9b8f6650fecb1bdd61707dfb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T19:29:46.570

Ok after some digging around I found the answer to my question, use steps to declare incremental values, worked as expected. More info here: [http://www.w3.org/TR/html-markup/datatypes.html#common.data.float.positive](http://www.w3.org/TR/html-markup/datatypes.html#common.data.float.positive)

# r - R中时间范围的Ifelse条件

> ID：13688868
> 
> 赞同：0
> 
> 时间：2012-12-03T17:49:07.933
> 
> 标签：r, date, if-statement

我有一些棘手的问题要解决，但不知何故我想不出任何答案。

我有以毫米为单位的阵雨日期和值。所以我需要做的是找出，如果连续 3 天内超过了 150 毫米的降雨量。我拥有的 data.frame ("rain") 看起来像这样。

```
 date amount
1\. 1965-07-15     38.85315
2\. 1968-08-02     33.22356
3\. 1972-08-15     30.90391
4\. 1978-08-07     33.34613
5\. 1987-08-18     37.85918
6\. 1989-07-24     38.23495
7\. 1995-07-22     52.46519
8\. 1995-07-23     70.29935
9\. 1995-07-24     45.11350 
```

最后，我只想得到满足条件的日期。在这种情况下，结果应该是。

```
7\. 1995-07-22     52.46519
8\. 1995-07-23     70.29935
9\. 1995-07-24     45.11350 
```

现在我试图想一些 if.condition 来解决这个问题。不幸的是，我想不出 R 中有任何可以帮助我的函数。如果有人对如何解决此案有任何想法，我将不胜感激？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T22:52:53.680

您的样本数据：

```
x <- read.table(header=T,
                colClasses=c(date='Date','numeric'),
text="date amount
1965-07-15     38.85315
1968-08-02     33.22356
1972-08-15     30.90391
1978-08-07     33.34613
1987-08-18     37.85918
1989-07-24     38.23495
1995-07-22     52.46519
1995-07-23     70.29935
1995-07-24     45.11350"
                ) 
```

求每个三元组的日期分布和总和：

```
library(zoo)
delta <- rollapply(x$date, 3, FUN=function(x) range(x)[2]-range(x)[1])
sums  <- rollapply(x$amount, 3, FUN=sum) 
```

这些是您想要的行的（起始位置）：

```
delta <= 2 & sums >= 150
## [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE 
```

这是请求的数据子集：

```
w <- which(delta <= 2 & sums >= 150)
x[c(w,w+1,w+2),]
##         date   amount
## 7 1995-07-22 52.46519
## 8 1995-07-23 70.29935
## 9 1995-07-24 45.11350 
```

# jquery - 使用 textShadow css3 制作 JQUERY 动画

> ID：13688880
> 
> 赞同：0
> 
> 时间：2012-12-03T17:50:04.473
> 
> 标签：jquery, css

我尝试在这里基于模糊的 ex 制作 css3 动画：[http ://www.alexpeattie.com/projects/animate-textshadow/](http://www.alexpeattie.com/projects/animate-textshadow/)

但我不能让它工作：

```
$(function(){

  $(".t").hover(function() { 
    $(this).animate({textShadow: "#fff 0 0 10px"});
}, function() { 
    $(this).animate({textShadow: "#fff 0 0 0px"});
});

}); 
```

任何的想法 ？

在线结果在这里：[http ://sowuz.com/index.php](http://sowuz.com/index.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:58:17.593

项目页面上有很多评论说`jquery.animate-textshadow.js`不适用于 jQuery 1.8.x。从网站：

> 不适用于 jQuery 1.8，需要更改哪些内容才能正常工作？
> 
> 不适用于 jQuery 1.8

[这](http://jsfiddle.net/wCE3j/1/)是一个使用 jQuery 1.7.2 的代码示例，但它不适用于 jQuery 1.8.2。

# inno-setup - Inno Setup - FileCopy 在路径名中使用通配符

> ID：13688882
> 
> 赞同：2
> 
> 时间：2012-12-03T17:50:13.947
> 
> 标签：inno-setup, wildcard, pascal, file-copying, delphi

我正在尝试将所有数据库文件从以前的安装复制到具有新路径名的新安装。问题是安装程序不知道数据库文件的名称，所以我尝试使用通配符。

我尝试使用 TFileStream.Create()，但这是在搜索单个文件，例如“*.mdb”，并且一直收到错误消息，提示找不到该文件。我也尝试过使用 FileCopy()，但它似乎只是失败并继续前进。我什至尝试使用[`Exec()`](https://www.jrsoftware.org/ishelp/topic_isxfunc_exec.htm)通过命令行运行它，但它只会冻结安装。

我在网上搜索了很长时间的答案并阅读了很多文档。我只需要知道如何使用通配符来复制名称未知的文件。以下是我尝试过的示例。

TFileStream.Create()

```
 OldDBs := 'C:\Users\seang\Desktop\Old\*.mdb';
    NewDBs := 'C:\Users\seang\Desktop\New\*.mdb';
    SourceDB:= TFileStream.Create(OldDBs, fmOpenRead);
    DestDB:= TFileStream.Create(NewDBs, fmCreate);
    DestDB.CopyFrom(SourceDB, SourceDB.Size);
    SourceDB.Free;
    DestDB.Free; 
```

文件复制（）

```
 FileCopy('C:\Users\seang\Desktop\Old\*.mdb', 'C:\Users\seang\Desktop\New\*.mdb', True); 
```

命令行

```
 Exec('cmd.exe', 'COPY "C:\Users\seang\Desktop\Old\*.mdb" "C:\Users\seang\Desktop\New\*.mdb"', '', SW_HIDE, ewWaitUntilTerminated, ErrorCode); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T18:01:44.977

您需要使用`FindFirst`、`FindNext`和`FindClose`来遍历文件夹。您获取每个数据库名称，然后单独复制它。可以在[此处](https://stackoverflow.com/q/5991040/62576)找到在 Pascal (Delphi) 中执行此操作的示例。InnoSetup 帮助文件中还有一个使用它们的示例，位于以下`Support Functions Reference`部分`File System Functions`：

```
// This example counts all of the files (not folders) in the System directory.
var
  FilesFound: Integer;
  FindRec: TFindRec;
begin
  FilesFound := 0;
  if FindFirst(ExpandConstant('{sys}\*'), FindRec) then begin
    try
      repeat
        // Don't count directories
        if FindRec.Attributes and FILE_ATTRIBUTE_DIRECTORY = 0 then
          FilesFound := FilesFound + 1;
      until not FindNext(FindRec);
    finally
      FindClose(FindRec);
    end;
  end;
  MsgBox(IntToStr(FilesFound) + ' files found in the System directory.',
    mbInformation, MB_OK);
end; 
```

您可以更改上面的循环以查找每个`*.mdb` （在`FindFirst`调用中）的正确旧文件夹，并将计数的行更改为将找到的每个文件复制到新文件夹中的块（使用`FileCopy`或者 a `TFileStream`，无论您喜欢哪个）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-06T06:48:46.813

如果您稍微修改一下，您的命令行尝试就可以工作：

```
Exec('cmd.exe', '/c COPY "C:\Users\seang\Desktop\Old\*.mdb" "C:\Users\seang\Desktop\New"', '', SW_HIDE, ewWaitUntilTerminated, ErrorCode); 
```

# unix - （如何）我可以确定我机器上的 c99 编译器的版本吗？

> ID：13688888
> 
> 赞同：0
> 
> 时间：2012-12-03T17:50:29.297
> 
> 标签：unix, c99

是否有命令行标志或类似的东西，我可以`c99`用来打印它的版本？

我正在寻找类似于`gcc`'s `-v`flag 的输出，这给了我：

```
Using built-in specs.
Target: i686-apple-darwin11
Configured with: /private/var/tmp/llvmgcc42/llvmgcc42-2336.11~28/src/configure --disable-checking --enable-werror --prefix=/Applications/Xcode.app/Contents/Developer/usr/llvm-gcc-4.2 --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-prefix=llvm- --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin11 --enable-llvm=/private/var/tmp/llvmgcc42/llvmgcc42-2336.11~28/dst-llvmCore/Developer/usr/local --program-prefix=i686-apple-darwin11- --host=x86_64-apple-darwin11 --target=i686-apple-darwin11 --with-gxx-include-dir=/usr/include/c++/4.2.1
Thread model: posix
gcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00) 
```

我真的只关心 Target: 行和最后一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:55:01.040

c99 --版本

```
~$c99 --version
gcc (Debian 4.4.5-8) 4.4.5 
```

也试试 c99 --help

```
~$ c99 --help
Usage: gcc [options] file...
Options:
  -pass-exit-codes         Exit with highest error code from a phase
  --help                   Display this information
  --target-help            Display target specific command line options
  --help={target|optimizers|warnings|params|[^]{joined|separate|undocumented}}[,...]
                           Display specific types of command line options
  (Use '-v --help' to display command line options of sub-processes)
  --version                Display compiler version information
  -dumpspecs               Display all of the built in spec strings
  -dumpversion             Display the version of the compiler
  -dumpmachine             Display the compiler's target processor
  -print-search-dirs       Display the directories in the compiler's search path
  -print-libgcc-file-name  Display the name of the compiler's companion library
  -print-file-name=<lib>   Display the full path to library <lib>
  -print-prog-name=<prog>  Display the full path to compiler component <prog>
  -print-multi-directory   Display the root directory for versions of libgcc
  -print-multi-lib         Display the mapping between command line options and
                           multiple library search directories
  -print-multi-os-directory Display the relative path to OS libraries
  -print-sysroot           Display the target libraries directory
  -print-sysroot-headers-suffix Display the sysroot suffix used to find headers
  -Wa,<options>            Pass comma-separated <options> on to the assembler
  -Wp,<options>            Pass comma-separated <options> on to the preprocessor
  -Wl,<options>            Pass comma-separated <options> on to the linker
  -Xassembler <arg>        Pass <arg> on to the assembler
  -Xpreprocessor <arg>     Pass <arg> on to the preprocessor
  -Xlinker <arg>           Pass <arg> on to the linker
  -combine                 Pass multiple source files to compiler at once
  -save-temps              Do not delete intermediate files
  -pipe                    Use pipes rather than intermediate files
  -time                    Time the execution of each subprocess
  -specs=<file>            Override built-in specs with the contents of <file>
  -std=<standard>          Assume that the input sources are for <standard>
  --sysroot=<directory>    Use <directory> as the root directory for headers
                           and libraries
  -B <directory>           Add <directory> to the compiler's search paths
  -b <machine>             Run gcc for target <machine>, if installed
  -V <version>             Run gcc version number <version>, if installed
  -v                       Display the programs invoked by the compiler
  -###                     Like -v but options quoted and commands not executed
  -E                       Preprocess only; do not compile, assemble or link
  -S                       Compile only; do not assemble or link
  -c                       Compile and assemble, but do not link
  -o <file>                Place the output into <file>
  -x <language>            Specify the language of the following input files
                           Permissible languages include: c c++ assembler none
                           'none' means revert to the default behavior of
                           guessing the language based on the file's extension

Options starting with -g, -f, -m, -O, -W, or --param are automatically
 passed on to the various sub-processes invoked by gcc.  In order to pass
 other options on to these processes the -W<letter> options must be used. 
```

# sql - 如何制作包含分组字段的oracle where子句？

> ID：13688890
> 
> 赞同：1
> 
> 时间：2012-12-03T17:50:49.003
> 
> 标签：sql, oracle, where

我有一个如何在 Oracle 中执行此操作？

```
select a.field1 || '_' || 
       b.field2 || '_' || 
       sum(c.field3)
  from table1 a, 
       table2 b, 
       table3 c
 where a.field1 || '_' || 
       b.field2 || '_' || 
       sum(c.field3) not in (select d.field1 || '_' || 
                                    e.field2 || '_' || 
                                    sum(f.field3)  
                               from table4 d, 
                                    table5 e, 
                                    table6 f
                              where conditional_info_to_join_the_tables 
                              group by d.field1, e.field2)
   and conditional_info_to_join_the_tables  
 group by a.field1, b.field2 
```

我得到的错误是我不能在 where 子句中使用 sum

我试过使用

```
select a.field1 || '_' || 
       b.field2 || '_' || 
       sum(c.field3), 
       sum(c.field2) foo
  from table1 a, 
       table2 b, 
       table3 c
 where a.field1 || '_' || 
       b.field2 || '_' || 
       foo not in (select d.field1 || '_' || 
                          e.field2 || '_' || 
                          sum(f.field3)  
                     from table4 d, 
                          table5 e, 
                          table6 f
                    where conditional_info_to_join_the_tables 
                    group by d.field1, e.field2)
   and conditional_info_to_join_the_tables 
 group by a.field1, b.field2 
```

但是那个 foo 不是一个已识别的变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:55:35.853

仅仅给出`sum`和别名 ( `foo`) 并没有帮助，因为聚合发生在过滤之后 (`where`子句.

该[`having`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#SQLRF20040)子句就像在聚合之后应用的过滤器：

```
select a.field1 || '_' || b.field2 || '_' || sum(c.field3)
from table1 a, table2 b, table3 c
where conditional_info_to_join_the_tables
group by a.field1, b.field2
having a.field1 || '_' || b.field2 || '_' || sum(c.field3)
           not in ( select d.field1 || '_' || e.field2 || '_' || sum(f.field3) 
                    from table4 d, table5 e, table6 f
                    where conditional_info_to_join_the_tables 
                    group by d.field1, e.field2 ) 
```

您仍然需要完整地写出聚合而不是别名 - 这背后的原因不太明显，并且在 dba.se 上的这个答案中进行了讨论：[https ://dba.stackexchange.com/a/21982/ 1396](https://dba.stackexchange.com/a/21982/1396) .

当然，您可以使用子查询来实现相同的目的：

```
select foo
from( select a.field1 || '_' || b.field2 || '_' || sum(c.field3) as foo
      from table1 a, table2 b, table3 c
      where conditional_info_to_join_the_tables
      group by a.field1, b.field2 )
where foo not in ( select d.field1 || '_' || e.field2 || '_' || sum(f.field3) 
                   from table4 d, table5 e, table6 f
                   where conditional_info_to_join_the_tables 
                   group by d.field1, e.field2 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:58:43.340

您可以在没有所有连接的情况下执行此操作：

```
select abc.field1 || '_' || abc.field2 || '_' || sumf, 
       sum(c.field2) foo
from (select a.field1, b.field2, sum(c.field3) as sumf
      from a, b, c
      where conditional_info_to_join_the_tables
      group by a.field1, b.field2
     ) abc left outer join
     (select d.field1, e.field2, sum(f.field3) as sumf
      from d, e, f
      where conditional_info_to_join_the_tables
      group by d.field1, 3.field2
     ) def
     on abc.field1 = def.field1 and
        abc.field2 = def.field2 and
        abc.sumf = def.sumf
where def.field1 = NULL 
```

一般来说，您应该使用更现代的`join`语法。这是一个`left outer join`非常合适的情况。

# ruby-on-rails - 如何修复此创建功能？

> ID：13688896
> 
> 赞同：2
> 
> 时间：2012-12-03T17:51:03.117
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个函数可以将嵌套属性拆分为一个数组，以便检查它们的唯一性，然后保存它们。问题是，我收到一个`Can't mass-assign protected attributes: _destroy`错误，因为`nested_form gem`插入了一个 hidden_​​field 以突出显示应该删除哪些属性。

这是 *Posts_Contoller.rb* 创建函数：

```
def create
   location_set = params[:post].delete(:locations_attributes) unless params[:post][:locations_attributes].blank?

   @post = current_blogger.blog_posts.new(params[:post])

   @post.locations = Location.find_or_initialize_location_set(location_set) unless location_set.nil?

 if @post.save
    redirect_to @post, notice: 'Blog post was successfully created.'
  else
    render action: "new"
  end
end 
```

*这是location.rb*中的函数：

```
def self.find_or_initialize_location_set(location_set)
  #create a locations array
   locations = []
         locations = locations.delete_if { |elem| elem.flatten.empty? }

   location_set.each do |key, location|
       locations << find_or_initialize_by_name(location)
   end

 locations

 end 
```

这是日志：

```
 Started POST "/blog/posts" for 127.0.0.1 at 2012-12-03 17:31:54 +0000
 Processing by Blogit::PostsController#create as HTML Parameters: {"utf8"=>"✓", "authenticity_token"=>"r74iCzC4tJgVI6FiCEH7XzfiTmaqKihF5JSs7Ow3MSI=", "post"=>{"title"=>"This
 is a post about Paris", "body"=>"This is a post about ParisThis is a post about Paris
 This is a post about ParisThis is a post about Paris", "tag_list"=>"", 
 "locations_attributes"=>{"0"=>{"_destroy"=>"false", "name"=>"Paris", "longitude"=>"2.3522219", "latitude"=>"48.856614"}, "1354555760002"=>{"_destroy"=>"false", "name"=>"Los Angeles", "longitude"=>"-118.5155901", "latitude"=>"3
 4.03563310000001"}}}, "_wysihtml5_mode"=>"1", "name"=>"losds", "legname"=>"Los Angeles",    "longitude"=>"-118.5155901", "latitud
 e"=>"34.03563310000001", "commit"=>"Submit"}

 User Load (0.1ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
 ActsAsTaggableOn::Tag Load (0.1ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON  "tags"."id" = "taggings"."tag_id" W
 HERE "taggings"."taggable_id" IS NULL AND "taggings"."taggable_type" = 'Blogit::Post' AND  (taggings.context = 'tags' AND taggings.tagger_id IS NULL)

 Location Load (0.1ms)  SELECT "locations".* FROM "locations" WHERE "locations"."name" = 'Paris' LIMIT 1
 LOGGER LOCATIONS ARE[#<Location id: 768, name: "Paris", latitude: #<BigDecimal:7f86aadf6230,'0.48856614E2',18(45)>, longitude:
 #<BigDecimal:7f86aadf5f60,'0.23522219E1',18(45)>, post_id: nil, created_at: "2012-12-01 17:27:33", updated_at: "2012-12-01 17
 :27:33", notes: nil>]
 Location Load (0.2ms)  SELECT "locations".* FROM "locations" WHERE "locations"."name" = 'Los Angeles' LIMIT 1
 Completed 500 Internal Server Error in 97ms

  ActiveModel::MassAssignmentSecurity::Error (Can't mass-assign protected attributes: _destroy):
  app/models/location.rb:23:in `block in find_or_initialize_location_set'
  app/models/location.rb:21:in `each'
  app/models/location.rb:21:in `find_or_initialize_location_set'
  app/controllers/blogit/posts_controller.rb:79:in `create' 
```

关于如何调整它以像以前一样在参数中包含删除功能的任何建议，但我没有得到`Can't mass-assign protected attributes: _destroy`错误？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T17:54:08.233

您可以通过将其添加到您的位置模型来消除此错误：

```
# NOT PERSISTENT
attr_accessor :_destroy
# ... 
attr_accessible :_destroy 
```

如果没有这个`_destroy`属性，则可以防止[大量赋值](http://guides.rubyonrails.org/security.html#mass-assignment)，并且当您尝试为其赋值时，无论如何都会引发异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:33:25.300

您可以执行以下操作：

```
def self.find_or_initialize_location_set(location_set)
  #create a locations array
  locations = []
  locations = locations.delete_if { |elem| elem.flatten.empty? }

  location_set.each do |key, location|
    if location.delete(:_destroy) == "1"
      locations.delete_if {|elem| elem[:name] == location[:name]}
    else
      locations << find_or_initialize_by_name(location)   
    end
  end 

  locations 
end 
```

调用`delete`关联的散列将修改散列并返回您要删除的值（或者`nil`如果不存在）。

或者，如果您需要在初始化位置删除，您可以在那里执行：

```
def find_or_initialize_by_name_with_delete(location)
  if location.delete(:_destroy)
    do_delete
  end

  find_or_initialize_by_name(location)
end 
```

# android - 检测 Imageview 内的 Image 是否与 Textview 重叠

> ID：13688901
> 
> 赞同：0
> 
> 时间：2012-12-03T17:51:23.637
> 
> 标签：android, android-imageview, textview, overlap

我有以下布局：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<com.myapp.imagezoom.ImageViewTouch
    android:id="@+id/image"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />

<TextView
    android:id="@+id/txtTitle"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|center"
    android:layout_marginBottom="3dp"
    android:gravity="center"
    android:maxLines="2"/>

<ProgressBar
    android:id="@+id/loading"
    style="?android:attr/progressBarStyleLarge"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:visibility="gone" /> 
```

如您所见，有一个可缩放的 ImageView。只要不缩放，TextView 就会显示在 ImageView 下方。如果用户放大 ImageView，它就在它上面。如何检测显示的 ImageView 是否与 TextView 重叠以向 TextView 显示背景？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:18:56.137

您应该在您的`ImageViewTouch`类中添加一个名为的属性`isZoomed`，然后在自定义覆盖方法或[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)中验证是真还是假，并设置 TextView 的背景或您想要的任何内容。

要了解有关创建自定义覆盖方法的更多信息，我建议您阅读[此](https://stackoverflow.com/questions/13105189/start-dialog-for-result)内容，它只是解释了如何执行此操作。

# visual-studio-2010 - 将 VS2010 调试器附加到从 MSBuild 运行的 GTest

> ID：13688902
> 
> 赞同：0
> 
> 时间：2012-12-03T17:51:25.233
> 
> 标签：visual-studio-2010, msbuild, msbuild-task, googletest

我使用自己的配置编译我的 GTest：

```
<ProjectConfiguration Include="Test|Win32">
  <Configuration>Debug</Configuration>
  <Platform>Win32</Platform>
</ProjectConfiguration> 
```

我使用定制的目标运行我的 GTest

```
 <Target Name="RunTests">
    <Message Text="Configuration: $(Configuration)" Importance="High" />
    <Exec Command="..\$(Configuration)\@(BuildProjectFile->'%(Filename)').exe" />
  </Target> 
```

我想使用 VS2010 运行我的 GTest，而不是将其作为自己的可执行文件运行。我想要使​​用 VS2010 调试器来调试我的测试的优势。

是否有正确的任务来启动我的编译以便调试器将其拾取，或者我是否必须将某些内容返回到 VS2010 以便它开始自行执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T18:19:56.337

通过使用`Returns="@(ManagedTargetPath)"`VS 得到可执行文件应该开始。

而不是通过`Exec`任务启动测试，目标应该只是启用调试的构建，并且目标路径应该返回给 VS 执行。

以下示例重定向传入的构建调用以执行单元测试，并使用 VS2010 的内置机制启动它们。

（我目前不明白为什么会忽略 *.cc 文件中的断点，而不会忽略 *.c 文件中的断点 - 可能是巧合）

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="main.c" />
    <ClCompile Include="Source\A.c" />
    <ClCompile Include="Source\A_unittest.cc" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="main.h" />
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{7506F0B9-7FA3-4E1E-8EB5-A1819E232C59}</ProjectGuid>
    <RootNamespace>STACKOVERFLOW</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <CharacterSet>MultiByte</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>MultiByte</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>Disabled</Optimization>
    </ClCompile>
    <Link>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>MaxSpeed</Optimization>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
    </ClCompile>
    <Link>
      <GenerateDebugInformation>true</GenerateDebugInformation>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
    </Link>
  </ItemDefinitionGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
  <Target 
    Name="NormalBuild" 
    Condition=" '$(_InvalidConfigurationWarning)' != 'true' " 
    DependsOnTargets="_DetermineManagedStateFromCL;CustomBeforeBuild;$(BuildDependsOn)" 
    Returns="@(ManagedTargetPath)">
    <ItemGroup>
      <ManagedTargetPath Include="$(TargetPath)" Condition="'$(ManagedAssembly)' == 'true'" />
    </ItemGroup>
  </Target>

  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Test|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
  </ItemGroup>

  <Target Name="Build"
    Returns="@(ManagedTargetPath)">
    <MSBuild Projects="STACKOVERFLOW.vcxproj" Targets="NormalBuild" Properties="Configuration=Test" />
  </Target>

  <Target Name="CustomBeforeBuild">
    <ItemGroup Condition="'$(Configuration)' == 'Test'">
      <ClCompile Remove="*main.c*" />
      <ClCompile Include="c:/gtest/*.c*" />
    </ItemGroup>
  </Target>

</Project> 
```

# android - 将 AutoCompleteTextView 限制为仅一个结果

> ID：13688904
> 
> 赞同：2
> 
> 时间：2012-12-03T17:51:28.170
> 
> 标签：android, autocompletetextview

我正在使用 AutoCompleteTextView 和适配器的自定义布局。问题是我不知道如何一次只限制一个结果，就像在默认布局中一样。我读到它可能会限制高度，但不适用于所有屏幕。感谢您的关注。

我的 activity_main 布局上有这个。

```
<AutoCompleteTextView android:id="@+id/autotext" 
android:layout_width="0dp" 
android:layout_height="wrap_content"
android:minWidth="480dp" 
android:layout_weight="1" 
android:maxLength="23" 
android:maxLines="1" 
android:textColor="#000000" /> 
```

这是适配器的布局。

```
<TextView android:id="@+id/textpop" 
android:layout_width="wrap_content" 
android:layout_height="wrap_content"
android:textColor="#000000"
android:textSize="17sp"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:44:15.277

看看[这段代码](https://github.com/luksprog/DroidPlayground/blob/master/src/com/luksprog/dp/adapter/FilterWithSpaceAdapter.java)。它基本上是 SDK`ArrayAdapter`类的代码，稍作修改（不算）。如果您只想在 中显示一个建议，`AutoCompleteTextView`那么您可以从链接对类进行小修改，`performFiltering()`方法如下：

```
// ... the rest of that method
if (newValues.size() > 1) { // if we have more than an item in the list
    // get the first suggestion
    T oneItem = newValues.get(0);
    // empty the suggestion list
    newValues.clear();
    // add the only suggestion.
    newValues.add(oneItem);
}
results.values = newValues;
results.count = newValues.size(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-02T10:22:25.940

我发现上面的答案不令人满意，链接已失效。

对于最简单的方法，创建一个自定义适配器并简单地将计数强制为 1

```
class SingleArrayAdapter extends ArrayAdapter<String> {

        public SingleArrayAdapter(Context context, int resource, String[] objects) {
            super(context, resource, objects);
        }

        @Override
        public int getCount() {
            return 1;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-30T15:49:38.163

您可以创建自己的实现 Filterable 接口的 AutoCompleteTextView 适配器，或者扩展现有的适配器，但覆盖 getFilter() 方法，创建自己的过滤器实现，然后您可以自定义过滤器逻辑并返回您喜欢的任意数量的结果。

您可以参考 ArrayAdpater 中的 ArrayFilter 实现以供参考。

# c++ - 缓存的不可变值：避免锁定

> ID：13688906
> 
> 赞同：0
> 
> 时间：2012-12-03T17:51:31.020
> 
> 标签：c++, multithreading, caching

假设我有以下代码：

```
struct Obj {
    mutable bool valueIsCached_;
    mutable int value_;
    const int parameter_;

    Obj (int parameter) : valueIsCached_ (false), parameter_ (parameter) {
    }

    int getValue () const {
        if (!valueIsCached) {
            value_ = calculateValue ();  // #1
            valueIsCached_ = true;       // #2
        }
        return value_;
    }

 private:
    int calculateValue () {
        /* calculate value based on parameter and return it;
           return value only depends on value of parameter_
           (no side effects; no dependence on global state)
        */
    }
 }; 
```

如果编译器不对标记为#1 和#2 的行重新排序，那么这段代码显然是线程安全的。可能发生的最糟糕的事情是多次计算`value_`. 但是，一旦我们不能保证 #2 在 #1 之后发生，代码就会变得线程不安全。

1.  我们怎样才能避免这种情况？
2.  `value_`如果类型是，例如 a ，事情会变得更糟`struct`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:08:10.267

您需要插入一个屏障。下面是 VC++ 的代码：

```
int getValue () const {
    if (!valueIsCached_) {
        value_ = calculateValue ();  // #1
        _WriteBarrier();             // force value_ to be written first.
        valueIsCached_ = true;       // #2
    }
    return value_;
} 
```

请注意，这是假设`calculateValue`是线程安全的，因为它可以被多个线程调用，并且多次写入`value_`是`valueIsCached_`安全的。

# mysql - 选择具有单个别名的多个列

> ID：13688907
> 
> 赞同：3
> 
> 时间：2012-12-03T17:51:35.960
> 
> 标签：mysql, mysql-5.5

什么是替代品

```
select table_name.* as colAlias from table_name 
```

我假设这曾经在 5.5 MySQL 之前工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T17:58:48.840

```
SELECT CONCAT(col1,', ',col2,', ',col3) AS cols
    FROM table_name ORDER BY cols; 
```

或者也

```
SELECT CONCAT(col1,' ',col2,' ',col3) AS cols
    FROM table_name ORDER BY cols; 
```

# sql-server - 从组中选择最近的日期

> ID：13688908
> 
> 赞同：0
> 
> 时间：2012-12-03T17:51:36.507
> 
> 标签：sql-server, tsql

我有一个 T-SQL 查询，旨在清除某个产品培训的重复条目，只抓取具有最新 DateTaken 的条目。例如，如果某人参加了某个培训课程 3 次，我们只想显示一行，该行包含最近的 DateTaken。这是我到目前为止所拥有的，但是我收到以下错误：

> *在预期条件的上下文中指定的非布尔类型表达式，靠近“ORDER”。*

ORDER BY 是必要的，因为我们希望按到期日期对查询的所有结果进行分组。以下是完整的查询：

```
SELECT DISTINCT 
   p.ProductDescription as ProductDesc, 
   c.CourseDescription as CourseDesc, 
   c.Partner, a.DateTaken, a.DateExpired, p.Status 
FROM 
   sNumberToAgentId u, AgentProductTraining a, Course c, Product p 
WHERE 
    @agentId = u.AgentId 
    and u.sNumber = a.sNumber 
    and a.CourseCode = c.CourseCode 
    and (a.DateExpired >= @date or a.DateExpired IS NULL) 
    and a.ProductCode  = p.ProductCode 
    and (p.status != 'D' or p.status IS NULL)
GROUP BY
    (p.ProductDescription) 
HAVING 
    MIN(a.DateTaken)
ORDER BY 
    DateExpired ASC 
```

编辑

我对 GROUP BY 和 HAVING 子句进行了以下更改，但是我仍然收到错误：

```
GROUP BY
    (p.ProductDescription, c.CourseDescription) 
HAVING 
    MIN(a.DateTaken) > GETUTCDATE() 
```

在 SQL Management Studio 中，红线错误标记出现在 p.ProductDescription 之后的 ',' 下方，c.CourseDescription 之后的 ')'，a.DateTaken 中的 'a' 和 GETUTCDATE() 的右括号 ')' . 如果我只是让 GROUP BY 语句只包含 p.ProductDescription 我会收到以下错误消息：

> *选择列表中的“Product.ProductDescription”列无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。*

我对 SQL 比较陌生，有人可以解释发生了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T21:03:13.533

由于您使用的是 sql server，因此我的建议是通过 and 来实现和`row_number()`分区。这将进入子查询，然后您应用过滤器以仅返回行号等于一个或最新记录的那些：`ProductDescription``CourseDescription`

```
select *
from
(
    SELECT   p.ProductDescription as ProductDesc, 
       c.CourseDescription as CourseDesc, 
       c.Partner, a.DateTaken, a.DateExpired, p.Status 
       row_number() over(partition by p.ProductDescription, c.CourseDescription order by a.DateTaken desc) rn
    FROM sNumberToAgentId u
    INNER JOIN AgentProductTraining a
        ON u.sNumber = a.sNumber 
        AND (a.DateExpired >= @date or a.DateExpired IS NULL) 
    INNER JOIN Course c
        ON a.CourseCode = c.CourseCode 
    INNER JOIN Product p 
        ON a.ProductCode  = p.ProductCode 
        AND (p.status != 'D' or p.status IS NULL)
    WHERE  u.AgentId = @agentId
) src
where rn = 1
order by DateExpired 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T17:54:00.457

它的这条线

```
HAVING MIN(a.DateTaken) 
```

应该是布尔类型，例如

```
 HAVING MIN(a.DateTaken) > GETUTCDATE() 
```

必须返回 True 或 False（布尔值）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T16:55:23.713

这是我最终使用的最后一个查询。它类似于上面的建议：

```
SELECT ProductDesc, CourseDesc, Partner, DateTaken, DateExpired, Status
FROM(
    SELECT  
       p.ProductDescription as ProductDesc, 
       c.CourseDescription as CourseDesc, 
       c.Partner, a.DateTaken, a.DateExpired, p.Status,
       row_number() OVER (PARTITION BY p.ProductDescription, c.CourseDescription ORDER BY abs(datediff(dd, DateTaken, GETDATE()))) as Ranking
    FROM 
        sNumberToAgentId u, AgentProductTraining a, Course c, Product p 
    WHERE 
        @agentId = u.AgentId 
        and u.sNumber = a.sNumber 
        and a.CourseCode = c.CourseCode 
        and (a.DateExpired >= @date or a.DateExpired IS NULL) 
        and a.ProductCode  = p.ProductCode 
        and (p.status != 'D' or p.status IS NULL)
    ) aa
WHERE Ranking = '1' 
```

# actionscript-3 - 粒子以特定角度之间的随机角度射出

> ID：13688909
> 
> 赞同：2
> 
> 时间：2012-12-03T17:51:36.330
> 
> 标签：actionscript-3, flash, math, angle

**大家**好，

我正在创建一个游戏，其中在两个对象之间发生碰撞后会创建一些粒子。然后给粒子一个随机的 x 和 y 速度，它们向各个方向射出。我一直在尝试改变粒子射出的方式，使其类似于**图 1**，其中粒子以 330 到 30 和 150 到 210 之间的随机角度射出（为了便于理解，我用度数而不是弧度来写角度）。**图 1**中的红色区域是粒子不应该射出的地方，蓝色是它们应该射出的地方。但是，我无法达到预期的效果。我想知道是否有人可以提供指向有用阅读或代码示例的链接。我一直在搜索谷歌，但找不到一个像样的例子。

[![粒子生成角度，蓝色可以生成，红色不能生成。](../Images/f006aa7810dd8a20e605e6464aaca0c3.png)](https://i.stack.imgur.com/Kl5sb.png) **图1**

**笔记：**

`Math.pi/180`

**图 1**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:18:51.550

```
var speed:Number = minSpeed + Math.random() * (maxSpeed - minSpeed);
var angle:Number = Math.random() * 120 - 30;
if (angle > 30) angle += 120;
angle *= Math.PI/180;

var speedX = Math.cos(angle) * speed;
var speedY = Math.sin(angle) * speed; 
```

# gwt - GWT RPC 在 IDN 的 Opera 中不起作用

> ID：13688917
> 
> 赞同：2
> 
> 时间：2012-12-03T17:51:58.057
> 
> 标签：gwt, opera, gwt-rpc, idn

当站点具有国际域名时，GWT RPC 请求在 Opera 中失败。

错误信息如下：

> 无法发起异步服务调用（GreetingService_Proxy.getDate）——检查网络连接
> 
> (DOMException) code: 12 INDEX_SIZE_ERR: 1 DOMSTRING_SIZE_ERR: 2 HIERARCHY_REQUEST_ERR: 3 WRONG_DOCUMENT_ERR: 4 INVALID_CHARACTER_ERR: 5 NO_DATA_ALLOWED_ERR: 6 NO_MODIFICATION_ALLOWED_ERR: 7 NOT_FOUND_ERR: 8 NOT_SUPPORTED_ERR: 9 INUSE_ATTRIBUTE_ERR: 10 INVALID_STATE_ERR: 11 SYNTAX_ERR: 12 INVALID_MODIFICATION_ERR: 13 NAMESPACE_ERR: 14 INVALID_ACCESS_ERR: 15 VALIDATION_ERR: 16 TYPE_MISMATCH_ERR: 17 SECURITY_ERR: 18 NETWORK_ERR: 19 ABORT_ERR: 20 URL_MISMATCH_ERR: 21 QUOTA_EXCEEDED_ERR: 22 TIMEOUT_ERR: 23 INVALID_NODE_TYPE_ERR: 24 DATA_CLONE_ERR: 25: SYNTAX

这怎么可能解决？

# javascript - 多选：预期对象。Jquery 在 IE 中不起作用。在 Firefox 中运行良好

> ID：13688918
> 
> 赞同：1
> 
> 时间：2012-12-03T17:51:58.967
> 
> 标签：javascript, jquery

以下 Jquery 代码在 Firefox 中运行良好，但在 IE 中抛出异常。请帮忙。以下代码将呈现一个多选框，您可以在其中将值从一个框拖放到另一个框。在 IE 中运行的代码会引发对象预期异常。因为它在一个大页面里面，所以无法识别错误的实际位置。

```
$(document).ready(function() {

    //adding combo box
    $(".combo").each(function() {

        var name = "to" + $(this).attr('name');
        var $sel = $("<select>").addClass("multi_select");
        $sel.addClass("combo2");
        $sel.attr('id', $(this).attr('id') + "_rec");
        $(this).after($sel);
    });

    $(".multi_select").hide();

    var $tab;
    var i = 0;
    var temp = 0;
    //creating different div's to accomodate different elements
    $(".multi_select").each(function() {
        var $cont = $("#container");
        var $input;
        if ($(this).hasClass("combo") || $(this).hasClass("combo2")) {

            var $col = null;
            if ($(this).hasClass("combo")) {
                $tab = $("<table>");
                $cont = ($tab).appendTo($cont);
                var idT = $(this).attr('id');
                var $row = $("<tr id='" + idT + "_row1'>").appendTo($tab);
                $col = $("<td id='" + idT + "_col1'>").appendTo($row);
                $input = $("<input class='searchOpt'></input><img src='images/add.png' class='arrow1'/> ");
                $("<div>").addClass('ip_outer_container combo').attr('id', $(this).attr('id') + "out_div").append("<h3 class='header_select'>Tasks</h3>").appendTo($col);
                ($row).after("<tr><td></td><td><textarea name='" + $(this).attr("name") + "Text' id='" + $(this).attr("id") + "Text'></textarea> </td></tr>");

                $cont = $tab;
            } else {
                var idTm = $(this).attr('id');
                var $row2 = $("<tr id='" + idTm + "_row2'>").appendTo($tab);
                var $col2 = $("<td id='" + idTm + "_col2'>").appendTo($row2);
                $input = $("<input class='searchOpt'></input>");

                $("<div>").addClass('ip_outer_container combo2').attr('id', $(this).attr('id') + "out_div").append("<h3 class='header_select'>Tasks</h3>").appendTo($col2);

            }

        } else {
            $("<div>").addClass('ip_outer_container' + classSelect).attr('id', $(this).attr('id') + "out_div").append("<h3 class='header_select'>Tasks</h3>").appendTo($cont);
        }

        $("<div>").addClass('outer_container').attr('id', $(this).attr('id') + "_div").appendTo('#' + $(this).attr('id') + "out_div");
        $($input).appendTo("#" + $(this).attr('id') + "out_div");

    });

    //adding options from select box to accomodate different //elements
    $(".multi_select option").each(function() {
        $(this).attr('id', $(this).parent().attr('id') + "option_" + i);

        var val = $(this).val().replace("#comment#", "");
        var $d = $("<div class='multi_select_div'>" + val + "</div>").attr('id', $(this).parent().attr('id') + 'option_div_' + i);
        $d.appendTo("#" + $(this).parent().attr('id') + "_div");
        i++;
    });

    //delete function
    $(".delete").click(function() {
        $(this).parent().remove();
    });
    //input
    $(".searchOpt").keyup(function() {
        $(this).prev().children().show();
        var val = $(this).val();
        if (val != "") {
            var selId = $(this).prev().attr('id');
            selId = selId.replace("_div", "option_div");
            $(this).prev().children().not("div[id^=" + selId + "]:contains(" + val + ")").hide();
            //var $d=$('div[id^="multi_select_senoption_div"]');
            //$('div[id^="multi_select_senoption_div"]').not('div[id^="multi_select_senoption_div"]:contains("xls")').hide();
        }
    });
    var optionId = 0;
    $(".arrow1").click(function() {
        var divId = $(this).parent().attr("id");
        divId = divId.replace("out_div", "");
        var textValue = "#comment#" + $("#" + divId + "Text").val();

        var selToId = divId + "_rec";
        $("#" + divId + " option[selected='selected']").each(function() {
            var idOpt = $("#" + selToId).attr("id") + "option_" + optionId;

            $opt = $("<option>");
            $opt.attr("id", idOpt).attr("value", $(this).val() + textValue);
            $("#" + selToId).append($opt);
            var value = $(this).val().replace("#comment#", "");
            var divId = $("#" + selToId).attr('id') + 'option_div_' + optionId;
            var $de = $("<div class='multi_select_div'><img class='delete' src='images/delete.png'></img>" + value + "</div>").attr('id', divId);
            $de.appendTo("#" + $("#" + selToId).attr('id') + "_div");
            $("#" + divId).bind("click", handler);
            var optId = divToOption($(this).attr("id"));
            var optValue = $(optId).val();
            var comment = optValue.substring(optValue.indexOf("#comment#") + 9);
            $("#" + divId).attr("title", textValue.replace("#comment#", ""));
            //$("#"+divId).bind("mouseenter",handler2);
            //$("#"+divId).bind("mouseleave",handler3);
            $(".delete").bind("click", handler1);

            optionId++;
        });
        // function code
        //
    });

    $(".multi_select_div").click(function() {
        var id = divToOption($(this).attr('id'));
        var selected = $(id + "[selected]");

        if (selected.length > 0) {
            $(id).attr('selected', false);
            var cssObj = {
                'background-color': 'black'
            };
            $(this).css(cssObj);

        }
        else {
            $(id).attr('selected', 'selected');
            var cssObj = {
                'background-color': 'orange'
            };
            $(this).css(cssObj);

        }
    });

    function handler(event) {
        var id = divToOption($(this).attr('id'));
        var selected = $(id + "[selected]");

        if (selected.length > 0) {
            $(id).attr('selected', false);
            var cssObj = {
                'background-color': 'black'
            };
            $(this).css(cssObj);

        }
        else {
            $(id).attr('selected', 'selected');
            var cssObj = {
                'background-color': 'orange'
            };
            $(this).css(cssObj);

        }
    }

    function handler1(event) {
        $(this).parent().remove();

    }

    function handler2(event) {

        var optId = divToOption($(this).attr("id"));
        var optValue = $(optId).val();
        var comment = optValue.substring(optValue.indexOf("#comment#") + 9);
        var pos = $(this).position();
        var cssObj = {
            top: pos.top - 100,
            left: pos.left + 200
        };

        var $divImg = $("<td>");
        var $divCl = $("<div class='comment'>" + comment + "</div>").css(cssObj);
        $divImg.append($divCl);
        $(this).parent().parent().parent().parent().append($divImg);

    }

    function handler3(event) {
        $(".comment").remove();
    }

});

function optionToDiv(option) {
    var id_div = option.replace('option_', 'option_div_');
    id_div = "#" + id_div;
    return id_div;

}

function divToOption(div) {
    var id_opt = div.replace('div_', '');
    id_opt = "#" + id_opt;
    return id_opt;

}​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:34:40.283

IE 浏览器不支持数组的 indexOf，这会导致 javascript 出现问题。

在页面顶部添加以下 javascript，它可能会解决您的问题：

```
 //
    // IE browsers do not support indexOf method for an Array. Hence 
    // we add it below after performing the check on the existence of
    // the same.
    //
    if (!Array.prototype.indexOf)
    {
        Array.prototype.indexOf = function (obj, start)
        {
            for (var i = (start || 0), j = this.length; i < j; i++)
            {
                if (this[i] === obj)
                {
                    return i;
                }
            }
            return -1;
        };
    } 
```

# youtube-api - 在 Flexslider 幻灯片中播放 YouTube 视频并暂停幻灯片

> ID：13688919
> 
> 赞同：4
> 
> 时间：2012-12-03T17:52:00.097
> 
> 标签：youtube-api, flexslider

我在一个网站上使用[flexslider](http://www.woothemes.com/flexslider/)，并将 youtube 视频放在某些幻灯片中。但是，我需要滑块在视频播放时停止动画，并在视频结束时恢复。我了解开发人员已经使用 vimeo API 为这个确切的问题提供了[解决方案。](http://flexslider.woothemes.com/video.html)是否有使用 youtube API 的实现示例？可能吗？我（显然）不是 javascript 专家，并且发现我通过示例/教程学习得最好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T20:42:35.987

[https://developers.google.com/youtube/iframe_api_reference#Getting_Started](https://developers.google.com/youtube/iframe_api_reference#Getting_Started)有一个示例，用于在页面上嵌入 iframe YouTube 播放器并响应特定事件。我认为您应该能够对其进行调整以满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T07:30:02.437

这是我对 Youtube 和 Vimeo 的选择，希望对您有所帮助:)

[https://github.com/woothemes/FlexSlider/issues/346#issuecomment-13826530](https://github.com/woothemes/FlexSlider/issues/346#issuecomment-13826530)

# iphone - 如何更改我的图表 ShinobiCharts 上使用的 XAxis

> ID：13688920
> 
> 赞同：3
> 
> 时间：2012-12-03T17:52:07.840
> 
> 标签：iphone, objective-c, ios, charts

我想让我的图表的 xAxis 看起来像这样：

一月，二月，三月，四月，.....十一月，十二月

现在它遵循默认设置，根据数据点的数量对 xAxis 进行编号。

我怎样才能实现对这个轴的这种改变？

我尝试使用 Category Axis 并将包含这些字符串（“Jan”、“Feb”...）的 NSMutableArray 设置为类别，并且 numberRange 从 1 到 12，但它不起作用。

```
chart = [[ShinobiChart alloc] initWithFrame:chartEmbaixo.frame withPrimaryXAxisType:SChartAxisTypeCategory withPrimaryYAxisType:SChartAxisTypeNumber];

NSMutableArray * monthNames = [[NSMutableArray alloc] initWithObjects:@"Jan", @"Fev", @"Mar", @"Abr", @"Mai", @"Jun", @"Jul", @"Ago", @"Set", @"Out", @"Nov", @"Dez", nil];

SChartNumberRange * numberRange = [[SChartNumberRange alloc] initWithMinimum:[NSNumber numberWithInt:1]andMaximum:[NSNumber numberWithInt:12]];
SChartCategoryAxis *xAxis = [[SChartCategoryAxis alloc] initWithRange:numberRange];
xAxis.categories = monthNames;

chart.xAxis = xAxis; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:05:22.657

首先我用作我的 x 轴

**编辑**我如何制作我的 x 轴：

```
SChartNumberRange *r1 = [[SChartNumberRange alloc] initWithMinimum:[NSNumber numberWithInt:0] andMaximum:[NSNumber numberWithInt:2]];
SChartCategoryAxis *xAxis = [[SChartCategoryAxis alloc] initWithRange:r1];
xAxis.title = @"";
//xAxis.enableGesturePanning = YES;
xAxis.enableGesturePanning = YES;
xAxis.style.gridStripeStyle.showGridStripes = NO;
xAxis.style.majorGridLineStyle.showMajorGridLines = NO; 
```

当你制作数据点时，它应该使用 xValue 作为 x 轴点。像这样：

```
dp.yValue = 1000;
dp.xValue = @"Jan"; 
```

xValue 应设置为该特定数据点的 x 点。这应该可行，但如果它不可行，或者你想做更复杂的事情，你可以从 `SChartDelegate`协议扩展这个方法：

```
-(void)sChart:(ShinobiChart *)chart alterTickMark:(SChartTickMark *)tickMark beforeAddingToAxis:(SChartAxis *)axis 
```

在这种方法中，您拥有的`tickMark.tickLabel`是可以进行编辑的给定点的轴标签。不要忘记验证您在哪个轴上。

希望这可以帮助。如果不是明天，我可以从我的项目中向您发布一些代码（目前我无法从我所在的位置访问它）

**编辑：**目前我有这个代码：

```
- (void)sChart:(ShinobiChart *)chart alterTickMark:(SChartTickMark *)tickMark beforeAddingToAxis:(SChartAxis *)axis {
    if (chart.yAxis == axis ) return;
    for (UIView *i in tickMark.tickMarkView.subviews)
        [i removeFromSuperview];

    tickMark.tickMarkView.frame = CGRectMake(0, 0, 170, 75);
    //center the marker at the right place because the size was changed
    tickMark.tickMarkX = tickMark.tickMarkX - (tickMark.tickMarkView.frame.size.width/2) ;
    tickMark.tickMarkY = 10;

    //img
    UIImageView *img = [[UIImageView alloc] initWithImage:[UIImage imageNamed: @"graph_bar_tag_2@2x.png"]];
    img.frame = CGRectMake( 0, 0, tickMark.tickMarkView.frame.size.width, tickMark.tickMarkView.frame.size.height);
    [tickMark.tickMarkView addSubview:img];

    //label with the markView's size with 7px padding on the left and on the right
    UILabel *label = [[UILabel alloc] initWithFrame: CGRectMake( 7, 5, tickMark.tickMarkView.frame.size.width-14, 15)];
    label.backgroundColor = [UIColor clearColor];
    //tikMark.tickLabel has an pair of indexes so that i can easily find the data for this particular data point and series.
    label.text = [_dataSource getNameFor: tickMark.tickLabel.text];
    label.textAlignment = UITextAlignmentCenter;
    //color_other_light is a UIColor var
    [label setTextColor: color_other_light];

    [tickMark.tickMarkView addSubview:label];
...
} 
```

# arduino - RGB 系列问题

> ID：13688926
> 
> 赞同：1
> 
> 时间：2012-12-03T17:52:29.223
> 
> 标签：arduino

我正在尝试制作一个 Arduino 程序，它接收来自串行监视器的信号，然后相应地点亮 LED，我将其设置为 RGB。但我有一个问题，所有三个 LED 的灯都像蓝色的一样。这是我的代码：

```
#define SENSOR 0   
#define R_LED 11
#define G_LED 10
#define B_LED 9
#define BUTTON 12
int val = 0;
int times = 0;
int btn = LOW;
int old_btn = LOW;
int state = 0;
int r = 0;
int g = 0;
int b = 0;
byte inByte = 0;
char buffer[5];
void setup() {
  Serial.begin(9600);
  pinMode(BUTTON, INPUT);
}
void loop() {
  val = analogRead(SENSOR);
  Serial.println(val);
  if (Serial.available() > 0) {
    inByte = Serial.read();
    if (inByte == '#') {
      r = Serial.read() + 1;
      r = r * 25;
      g = Serial.read() + 1;
      g = g * 25;
      b = Serial.read() + 1;
      b = b * 25;
    }
  }   
  btn = digitalRead(BUTTON);
  if ((btn == HIGH) && (old_btn == LOW)){
    state = 1 - state;
  }
  old_btn = btn;
  if (state == 1){
    analogWrite(R_LED, r);
    analogWrite(G_LED, g);
    analogWrite(B_LED, b);
  }else{
    analogWrite(R_LED, 0);
    analogWrite(G_LED, 0);
    analogWrite(B_LED, 0);
  }
  delay(100);
} 
```

注意：我确信这是一个编码问题，而不是机械问题，供您参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:20:07.660

如果我理解您的操作正确，`#987`则每次您希望更改颜色时都会在串行监视器上发送一些代码，对吗？在这种情况下，问题是当您这样做时`r = Serial.read() + 1;`（and 也是如此`b`）`g`，将返回从(48 - 57)`Serial.read()`开始的字符的 ASCII 码。试试这个：`'0'``'9'`

```
 r = Serial.read() - '0' + 1;
  r = r * 25;
  g = Serial.read() - '0' + 1;
  g = g * 25;
  b = Serial.read() - '0' + 1;
  b = b * 25; 
```

这将`'0'`首先减去 ASCII 码，因此数字将在正确的 0-9 范围内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:07:51.623

在您的代码中，您对所有三个灯执行相同的操作。

为什么你会期望蓝色表现不同？

```
analogWrite(R_LED, r);
analogWrite(G_LED, g);
analogWrite(B_LED, b); 
```

# java - Java中基于瓦片的RPG的最佳数据结构

> ID：13688927
> 
> 赞同：0
> 
> 时间：2012-12-03T17:52:29.390
> 
> 标签：java

游戏是基于瓷砖的，但瓷砖实际上仅用于地形和寻路目的。Sprite 的移动是自由形式的（即，玩家可以穿过瓷砖的一半）。

这个游戏中的地图非常大。正常缩放时，图块为 32*32 像素，地图大小可以达到 2000x2000 或更大（400 万图块！）。目前，地图是瓦片数组，瓦片对象如下所示：

```
public class Tile {

    public byte groundType;
    public byte featureType;
    public ArrayList<Sprite> entities;

    public Tile () {
        groundType = -1;
        featureType = -1;
        entities = null;
    }
} 
```

其中groundType 是纹理，featureType 是占据整个图块（如树，或大石头）的地图对象。这些类型的功能非常常见，因此我选择将它们设为自己的变量，而不是将它们存储在实体中，实体是图块上的对象列表（项目、生物等）。出于性能原因，实体被保存到磁贴中。

我遇到的问题是，如果实体未初始化为 null，Java 就会用完堆空间。但是在我看来，将其设置为 null 并且仅在某些东西移入磁贴时才进行初始化似乎是一个糟糕的解决方案。如果一个生物在其他空的瓷砖上移动，则需要不断地初始化列表并将其设置回 null。这不是糟糕的内存管理吗？什么是更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:05:01.213

*   拥有一个包含所有精灵的单一结构（以 ArrayList 开头）。
*   如果您正在运行一个游戏循环并在 sprite 列表中循环，例如，每隔 30-50 秒一次，并且最多有 200 个 sprite，那么这种结构本身不应该对性能造成影响。
*   稍后，为了其他目的，例如碰撞检测，您可能需要修改单个 ArrayList 的结构。我建议从简单的、点头的解决方案开始整理你的游戏逻辑，然后根据需要进行优化。
*   对于您的图块，如果空间是一个问题，那么与其拥有一个特殊的“图块”对象，不如考虑将每个图块的信息打包成一个字节、短或整数，如果实际上每个图块不需要太多特定信息的话。请记住，您创建的每个 Java 对象都有一些开销（为了论证，假设每个对象大约 24-32 个字节，具体取决于 VM 和 32 位还是 64 位处理器）。400 万字节的数组“仅”4MB，400 万整数“仅”16MB。
*   如果每个图块需要 16 个字节的数据，则另一个图块数据的解决方案是，如果将图块的规范打包到单个基元中不切实际，则声明一个大的 ByteBuffer，每个图块的数据存储在索引（例如）tileNo * 16 处。
*   您可以考虑不将所有图块实际存储在内存中。这是否合适将取决于您的游戏。如果每个单独的图块不需要太多数据，我会说 2000x2000 仍然在您可以明智地将整个数据保存在内存中的范围内。

如果您认为最后几点打败了面向对象语言的全部要点，那么是的，您是对的。因此，您需要权衡在什么时候选择“极端”解决方案来节省堆空间，或者您是否可以“摆脱”使用更多内存以获得更好的编程范例。每个图块有一个对象可能会使用（比如说）几百兆字节的数量。在某些环境中，这将是荒谬的。在其他几个千兆字节可用的情况下，这可能是完全合理的。

# android - 视图不显示可见性更改

> ID：13688928
> 
> 赞同：1
> 
> 时间：2012-12-03T17:52:34.013
> 
> 标签：android, android-widget, android-animation

我为几个视图的 alpha 通道设置了一个属性动画，但我认为它不能正常工作。本质上，我有 3 个`TextView`导数，一个`TextView`和两个`Views`，我想最初隐藏，在数据进入时设置它们的数据，然后为它们设置动画。我用布局中的其他几个视图执行此操作，偶尔它们会遇到相同的问题，尽管它是非常罕见。大多数情况下，即使根据其 Logcat 输出的数据是有效的，简单的`TextView`和其中之一也不会出现。它总是相同的两个视图，它们很少出现，但不是我能够找到的任何可预测的方式。布局文件的部分和所有动画代码如下。请注意，根据[这个问题](https://stackoverflow.com/questions/11386953/alphaanimation-does-not-work)`Views``TextView`，我已在布局中将可见性设置为不可见，并在开始动画之前将其设置为可见。

**编辑**

在有问题的视图上调用 `View.bringToFront() 没有明显的效果。此外，不执行动画而只是将视图的可见性从不可见更改为可见并不会显示它们。从布局中删除可见性更改代码和 android:visibility="invisible" 标记也不会使视图显示。

**布局**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:qwerjk="http://schemas.android.com/apk/res/tenkiv.app"
    android:id="@+id/container"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:paddingBottom="8dp"
    android:paddingLeft="8dp"
    android:paddingRight="8dp" >

    <tenkiv.view.widget.MagicTextView
        android:id="@+id/hourMinuteValueTv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toLeftOf="@+id/secondValueTv"
        android:lines="1"
        android:textSize="77sp"
        android:visibility="invisible"
        qwerjk:strokeColor="@color/light_text_outline"
        qwerjk:strokeJoinStyle="miter"
        qwerjk:strokeWidth="1.8" />

    <tenkiv.view.widget.MagicTextView
        android:id="@+id/secondValueTv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/hourMinuteValueTv"
        android:layout_toLeftOf="@+id/amPmValueTv"
        android:textSize="39sp"
        android:visibility="invisible"
        qwerjk:strokeColor="@color/light_text_outline"
        qwerjk:strokeJoinStyle="round"
        qwerjk:strokeWidth="1.3" />

    <tenkiv.view.widget.MagicTextView
        android:id="@+id/amPmValueTv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/hourMinuteValueTv"
        android:layout_alignParentRight="true"
        android:textSize="31sp"
        android:visibility="invisible"
        qwerjk:strokeColor="@color/light_text_outline"
        qwerjk:strokeJoinStyle="round"
        qwerjk:strokeWidth="1.3" />

    <tenkiv.view.widget.MagicTextView
        android:id="@+id/dateValueTv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/hourMinuteValueTv"
        android:textSize="19sp"
        android:visibility="invisible"
        qwerjk:strokeColor="@color/light_text_outline"
        qwerjk:strokeJoinStyle="round"
        qwerjk:strokeWidth="0.9" />

    <View
        android:id="@+id/lineTimeConditionSepView"
        android:layout_width="290dp"
        android:layout_height="3dp"
        android:layout_alignParentRight="true"
        android:layout_below="@id/dateValueTv"
        android:layout_marginTop="4dp"
        android:background="@color/holo_text"
        android:visibility="invisible" />

    <View
        android:id="@+id/lineTimeConditionSepViewOutline2"
        android:layout_width="290dp"
        android:layout_height="1dp"
        android:layout_alignBottom="@id/lineTimeConditionSepView"
        android:layout_alignLeft="@id/lineTimeConditionSepView"
        android:layout_marginTop="0.5dp"
        android:background="@color/location_area_dark_green"
        android:visibility="invisible" />

---THE REST OF THE LAYOUT--- 
```

**在我的片段中设置动画的方法**

```
public void onUpdateClock(final String time, final String seconds, final String ampm, final String date) {
    Activity activity = getActivity(); //Used to make sure we dont update the clock with the activity dead
    if (activity != null) {
        if (mHourMinuteValue == null) { //These are all used together so this should be safe
            mHourMinuteValue = (MagicTextView) activity.findViewById(R.id.hourMinuteValueTv);
            mSecondValue = (MagicTextView) activity.findViewById(R.id.secondValueTv);
            mAmPmValue = (MagicTextView) activity.findViewById(R.id.amPmValueTv);
            mDateValue = (TextView) activity.findViewById(R.id.dateValueTv);
            mTimeConditionsLine = activity.findViewById(R.id.lineTimeConditionSepView);
            mTimeConditionsOutline2 = activity.findViewById(R.id.lineTimeConditionSepViewOutline2);
            mTimeInAnim = createAnimation(CLOCK_IN);
        }
    }
    if (mHourMinuteValue == null) {
        Log.e(TAG, "Clock text views were null!");
        return;
    }
    uiHandler.post(new Runnable() {
        public void run() {
            mHourMinuteValue.setText(time);
            mSecondValue.setText(seconds);
            if (ampm != null) {
                mAmPmValue.setText(ampm);
            } else {
                mAmPmValue.setText(ClockUICallbacks.EMPTY_AMPM);
            }
            mDateValue.setText(date);
            mDateValue.bringToFront();
            if (mFadeInClock) {
                setClockVisibility(true);
                mTimeInAnim.start();
                mFadeInClock = false;
            }
        }
    });

private void setClockVisibility(boolean visible) {
        int flag;
        if (visible) {
            flag = View.VISIBLE;
        } else {
            flag = View.INVISIBLE;
        }
        mHourMinuteValue.setVisibility(flag);
        mSecondValue.setVisibility(flag);
        mAmPmValue.setVisibility(flag);
        mDateValue.setVisibility(flag);
        mTimeConditionsLine.setVisibility(flag);
        mTimeConditionsOutline2.setVisibility(flag);
    }

private AnimatorSet createAnimation(int type) {
        AnimatorSet set = new AnimatorSet();
        switch (type) {
        case CLOCK_IN:
            ValueAnimator hourMinInAnim = ObjectAnimator.ofFloat(mHourMinuteValue, "alpha", INVISIBLE, OPAQUE);
            hourMinInAnim.setDuration(FADE_IN_DURATION);
            ValueAnimator secondInAnim = ObjectAnimator.ofFloat(mSecondValue, "alpha", INVISIBLE, OPAQUE);
            secondInAnim.setDuration(FADE_IN_DURATION);
            ValueAnimator amPmInAnim = ObjectAnimator.ofFloat(mAmPmValue, "alpha", INVISIBLE, OPAQUE);
            amPmInAnim.setDuration(FADE_IN_DURATION);
            ValueAnimator dateInAnim = ObjectAnimator.ofFloat(mDateValue, "alpha", INVISIBLE, OPAQUE);
            dateInAnim.setDuration(FADE_IN_DURATION);
            ValueAnimator timeLine1InAnim = ObjectAnimator.ofFloat(mTimeConditionsLine, "alpha", INVISIBLE, OPAQUE);
            timeLine1InAnim.setDuration(FADE_IN_DURATION);
            ValueAnimator timeLine2InAnim = ObjectAnimator.ofFloat(mTimeConditionsOutline2, "alpha", INVISIBLE, OPAQUE);
            timeLine2InAnim.setDuration(FADE_IN_DURATION);
            set.playTogether(hourMinInAnim, secondInAnim, amPmInAnim, dateInAnim, timeLine1InAnim, timeLine2InAnim);
            return set;
        /*SOME OTHER ANIMATIONS*/
        }
        return null;
    } 
```

任何其他可能需要的信息请告诉我。

谢谢，贾里德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:26:18.300

事实证明，这是由于在 Activity 中为两个不同的片段创建布局时出现错误造成的。如果您查看布局，则有一个`MagicTextView`id 为 dateValueTv。好吧，相同的 id 存在于活动中的另一个布局中，并且由于两者都使用活动`findViewById()`方法来获取引用，因此有时他们找到了正确的视图，有时却没有。我发现了这一点，因为我在另一个片段中的文本视图有这个问题文本视图应该有的数据。我所要做的就是改变他们的身份证。我知道我可以基于`getView().findViewById()`. 如果这是最佳实践，我很想听听对此的评论，但要检查活动是否为空`getActivity()`并从那里获取视图我有一种方便的方法来确保如果活动不存在（例如在旋转期间），我的后台线程不会将消息发布到 ui 处理程序。

# sql - SQL / Apex - 变量号/字符混淆

> ID：13688934
> 
> 赞同：2
> 
> 时间：2012-12-03T17:53:00.520
> 
> 标签：sql, oracle, plsql

我有一个程序需要输入一个数字才能生成一些缩略图。

每次插入新行时，我都会尝试自动更新值，但我遇到了代码问题。

```
DECLARE

varInt NUMBER :='SELECT MAX(IMAGE_ID) FROM IMAGES';

begin
create_blob_thumbnail(varInt);
end; 
```

我收到错误*“ORA-06502: PL/SQL: numeric or value error: character to number conversion error”*

如果我运行查询**SELECT MAX(IMAGE_ID) FROM IMAGES**，它将返回我创建的最后一行 ID。

如果我手动输入一个数字，create_blob_thumbnail(varInt) 过程就可以正常工作**。**

搜索了很多年，尝试了很多不同的东西，有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:06:15.623

解决了！

```
DECLARE

varInt NUMBER;

BEGIN

SELECT MAX(IMAGE_ID) into varInt FROM IMAGES;
create_blob_thumbnail(varInt);

END; 
```

# java - 使用 WLAN 建立从 Android 到 Eclipse 程序的数据通信的最简单方法

> ID：13688936
> 
> 赞同：0
> 
> 时间：2012-12-03T17:53:00.700
> 
> 标签：java, android, exchange-server, wifi

现在，我在这里遇到了一些问题：

我在谷歌等上看了好几次，但我找不到一个“简单”的方法来完成这件事。目前有偏头痛......没有帮助我......虽然

我有一个 java eclipse 程序（Swing 应用程序是生产机器的“控制器”）。

我需要设计一个 Android 应用程序，它需要从无线网络中的 eclipse 程序中获取数据（并将它们发送回来）。

刚刚找到了 JPARSON 之类的解决方案或设置了一个真实的服务器，但这太复杂了……我不需要？！（或想要 :D ）用 php 或其他东西建立一个完整的网站......

你们中有人可以帮我找到更好的解决方案吗？它不需要特定于代码，我只想为这些机器交换 10 个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:00:18.453

如果你想交换数据，你需要一个通信媒介。最简单的方法是通过 TCP/IP 协议套件。如果您决定使用服务器-客户端架构，则您的服务器必须倾听电话所说的内容。他可以通过侦听指定端口来做到这一点，而您必须处理“协议”，或者您可以使用更简单的方法，即编写 php 脚本或 Java Servlet。PHP 脚本更容易，因为那里有大量的 php 托管服务提供商，而且价格便宜。如果您想编写自己的服务器，您将需要某种虚拟专用服务器，并在那里部署您的应用程序。另外，如果您多解释一下您的环境以及您想要实现的目标，那将会很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:14:21.863

内置 httpserver [http://docs.oracle.com/javase/6/docs/jre/api/net/httpserver/spec/index.html](http://docs.oracle.com/javase/6/docs/jre/api/net/httpserver/spec/index.html) ，因此您可以轻松地在独立 java 中实现简单的 web 服务。然后只需使用来自 android 的 URLConnection 来发布/获取数据，可能是 json 或您自己的格式。

# jquery - 折叠 Jquery 手风琴

> ID：13688937
> 
> 赞同：0
> 
> 时间：2012-12-03T17:53:05.170
> 
> 标签：jquery, accordion, jquery-ui-accordion, collapse

我正在为 jquery 手风琴使用以下脚本：

```
(function($) {

  var allPanels = $('.accordion > dd').hide();

  $('.accordion > dt > a').click(function() {
    allPanels.slideUp();
    $(this).parent().next().slideDown();
    return false;
  }); 
```

但是，当我单击标题以将其关闭时，它会关闭然后立即再次打开。可以在这里看到脚本：[http ://www.one-event.org.uk/wordpress/#!/programme](http://www.one-event.org.uk/wordpress/#!/programme)

所以我的问题是，当我再次单击它时，如何使活动面板关闭，而不是立即关闭和打开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:57:54.123

它会立即再次打开，因为这就是您的代码要执行的操作

```
allPanels.slideUp(); // Hide the panel
$(this).parent().next().slideDown(); //Show it again 
```

将这些行替换为

```
allPanels.not(this).slideUp(); //hide only ones that aint this one.
$(this).parent().next().slideToggle(); //show or hide based on current display 
```

# jquery - BxSlider4 第一个“下一个”滑动箭头

> ID：13688938
> 
> 赞同：0
> 
> 时间：2012-12-03T17:53:07.163
> 
> 标签：jquery, next, bxslider

如果还没有其他幻灯片，我有一个关于如何在第一张幻灯片中隐藏下一个箭头的问题。我的幻灯片是动态生成的，一切都很好。如果只有一张幻灯片，我想要实现的只是将类“禁用”添加到控件中的下一个箭头。

谢谢

这是我使用的，但 id 没有做这项工作:(

```
$(document).ready(function(){

$('.bxslider').bxSlider({
  minSlides: 1,
  maxSlides: 1,
  slideWidth: 214,
  slideMargin: 5,
  infiniteLoop: false,
  hideControlOnEnd: true,
  pager: false  
}); 

if(slider.getSlideCount() < 0){
        slider.controls.next.addClass('disabled');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:10:04.120

你有没有尝试过：

```
if($('ul.bxslider li').length == 1){
    $('.bx-next').addClass('disabled');
} 
```

如果您在 ul li 中有滑块，则检查 li 的长度，如果是一个，则禁用下一个 btn。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:56:57.227

或者，您可以使用 CSS

```
.bxslider li:only-child .bx-next {
    // disabled rules
} 
```

# internet-explorer-9 - IE9 无法正确显示表格

> ID：13688941
> 
> 赞同：0
> 
> 时间：2012-12-03T17:53:25.160
> 
> 标签：internet-explorer-9

我在以下页面[http://www.ltgear.com](http://www.ltgear.com)添加了一个菜单。它在 Firefox 和 Chrome 中正确显示，但在 IE9 中不正确。图像不对齐。而它在兼容模式下正确显示。我进行了很多搜索，但找不到导致此问题的原因。有人可以帮我解决问题吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T08:29:44.460

也许是标签之间有空格的 IE9 错误？更多详细信息：[MSDN 线程](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/e6f49d52-ec3f-47c5-802e-b80d1a58ed39/)或： [SO 线程](https://stackoverflow.com/questions/7267014/ie9-table-has-random-rows-which-are-offset-at-random-columns)

# shell - shell脚本中管道的简单映射

> ID：13688942
> 
> 赞同：0
> 
> 时间：2012-12-03T17:53:27.243
> 
> 标签：shell, map, pipeline

我正在处理主要由 shell 和 Perl 文件组成的管道，所有这些文件都将参数（路径）传递给下一个。我决定使用单个文件来存储所有路径并为每个文件调用它会更好。问题是我使用 awk 来抓取每个文件开头的文件，结果证明是很多重复。

我的问题是：我不知道是否有办法将键值对存储在文件中，以便 shell 可以原生地对键执行操作并返回值？它需要访问外部文件，因为管道使用许多脚本，并且特定文件中的映射会导致参数被传递到任何地方。是否有一些我不知道的小怪癖在外部文件上执行地图功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:10:53.543

在 bash 中，有[`mapfile`](http://www.gnu.org/software/bash/manual/bashref.html#index-mapfile), 但这会将文件的行读入数字索引数组。要将空格分隔的文件读入关联数组，我会

```
declare -A map
while read key value; do
  map[$key]=$value
done < filename 
```

然而，这听起来像是一个[XY 问题](https://meta.stackexchange.com/q/66377)。你能给我们一个你实际在做什么的例子（用代码）吗？当我看到 grep|awk|sed 的长管道时，通常有一种简化的方法。例如，通过参数传递数据是否比通过 stdout|stdin 传递更好？

换句话说，我质疑你的说法“我认为它会更好......”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T00:44:37.970

您可以制作一个环境变量分配文件并根据需要获取该文件，即。

```
$ cat myEnvFile
path1=/x/y/z
path2=/w/xy
path3=/r/s/t
otherOpt1="-x" 
```

在您的脚本中，您可以使用`. myEnvFile`相同功能的任何一个或更详细的版本`sourc myEnvFile`（假设 bash shell），即

```
$cat myScript
#!/bin/bash
. /path/to/myEnvFile
# main logic below
 ....
# references to defined var
if [[ -d $path2 ]] ; then
     cd $path2
else
     echo "no pa4h2=$path2 found, can't continue" 1>&1
     exit 1
fi 
```

根据您描述问题的方式，这应该可以正常工作，并为您的所有变量设置提供一站式服务。

IHTH

# mysql - Nodejs + db-mysql 分段错误

> ID：13688949
> 
> 赞同：0
> 
> 时间：2012-12-03T17:54:00.287
> 
> 标签：mysql, node.js

我不知道是什么原因造成的，但我有一个不断崩溃的 Node 应用程序。控制台显示分段错误，它看起来像是在实例化两个 Mysql 对象时发生（使用 db-mysql 模块），这在 10 多个用户使用我的网站时变得非常常见（我不发布到应用程序的链接，因为我担心负载会使它崩溃；）如果它有用，我会发布它）。

你们有什么线索吗？我的包裹是最新的。您是否有更好的包与 Mysql 一起使用（假设它是问题所在）？你是否也遇到过使用 Nodejs 的 Segfault 问题（我猜不是，bcs 稳定性是 Node 的主要优势之一）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T09:55:23.020

我 [认为] 我肯定做错了什么：每次我有请求时都创建一个新的 MySQL 对象并连接到数据库。相反，我存储了 MySQL 对象并为每个...查询运行一个查询。到目前为止工作正常。

# ruby-on-rails - 缓存特定的部分轨道 3.0.x

> ID：13688968
> 
> 赞同：6
> 
> 时间：2012-12-03T17:55:39.100
> 
> 标签：ruby-on-rails, ruby, caching

我有一个主页，它在整个页面上呈现了一些部分。它也有会话标题（登录）。部分包含分页的书籍集。现在我想缓存这个部分，因为它每周更新一次。

*   问题 1：如何缓存特定的部分（不打 db）？
*   问题 2：当我更新图书模型时，如何删除（过期）缓存内容？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T18:22:10.510

您在这里寻找[片段缓存](http://guides.rubyonrails.org/caching_with_rails.html#fragment-caching)，它发生在视图层上。片段缓存和存储内容的过期非常容易做到。你有一个书籍清单，所以假设你的视图看起来有点像这样：

```
<ul>
  <% @books.each do |book| %>
    <li><%= book.name %></li>
  <% end %>
</ul> 
```

要为这一位启用缓存，只需将其包装在`cache`：

```
<% cache do %>
  <ul>
    <% @books.each do |book| %>
      <li><%= book.name %></li>
    <% end %>
  </ul>
<% end %> 
```

当然，这并没有为缓存命名或对它做任何特别的事情……虽然 Rails 会为这个缓存片段自动选择一个唯一的名称，但它并没有真正的帮助。我们可以做得更好。让我们使用 DHH 的[基于键的缓存过期](http://37signals.com/svn/posts/3113-how-key-based-cache-expiration-works)技术，并给缓存一个与其内容相关的名称。

```
<% cache ['book-list', *@books] do %>
  <ul>
    <% @books.each do |book| %>
      <li><%= book.name %></li>
    <% end %>
  </ul>
<% end %> 
```

将参数传递到缓存中会根据提供的参数构建缓存键。字符串是直接传入的——所以，在这里，缓存总是以“book-list”开头。这是为了防止与您可能​​正在缓存相同内容但具有不同视图的其他地方发生缓存冲突。对于@books 数组的每个成员，Rails 将调用`cache_key`: 对于 ActiveRecord 对象，这会产生一个由其模型、ID 以及最重要的是对象上次更新时间组成的字符串。

这意味着当你更新对象时，这个片段的缓存键将会改变。换句话说，它会自动过期——当一本书更新时，这个缓存语句将搜索一个不存在的键，断定它不存在，并用新的内容填充它。旧的、陈旧的内容将在您的缓存存储中徘徊，直到被内存或年龄限制驱逐（memcached 会自动执行此操作）。

我在许多生产应用程序中使用了这种技术，并且效果很好。有关更多信息，请查看[37signals 帖子](http://37signals.com/svn/posts/3113-how-key-based-cache-expiration-works)，有关 Rails 中的一般缓存信息，请参阅[Ruby on Rails 缓存指南](http://guides.rubyonrails.org/caching_with_rails.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T18:32:42.863

> “计算机科学只有两个难题：缓存失效和命名事物。”
> ——菲尔·卡尔顿

**缓存**

* * *

[Rails 缓存指南](http://guides.rubyonrails.org/caching_with_rails.html)可能始终是Rails必须提供的内置缓存策略的一个很好的切入点。无论如何，这是我非常简单的缓存方法

```
# _partial.html.erb
<% cache(some_key, :expires_in => 1.week) do %>
   <%# ... content %>
<% end %> 
```

现在 some`some_key`可以是任何字符串，只要它是唯一的。但话又说回来，让我们尝试更聪明一点，让密钥以某种方式依赖于书籍列表。假设您实际上传入了`books`一些返回的查询数组，然后 rails 调用`cache_key`它的每个条目并最终为该集合构造一个唯一键。因此，当集合更改时，键会更改。那是因为在所有模型`cache_key`中实现`ActiveRecord::Base`并因此可用。而且，如果可用，它甚至会使用时间戳。

但话又说回来，每次发出请求时，**这都会击中数据库。**代码相同：

```
# controller_method
@weekly_books = Books.where 'condition'

# _partial.html.erb
<% cache(@weekly_books) do %>
   <%# ... content %>
<% end %> 
```

为了避免经常访问数据库，您还可以通过包装调用来缓存查询本身：

```
# Book.rb
def self.weeklies
  Rails.cache.fetch("book_weeklies", :expires_in => 1.day) do
    Books.where 'condition'
  end
end

# controller_method
@weekly_books = Books.weeklies

# _partial.html.erb
<% cache(@weekly_books) do %>
   <%# ... content %>
<% end %> 
```

# macos - 带有 NSTabView 键盘事件的 Mac OS X NSPanel：如何使用 NSTabViewDelegate 显示 TabItem 的视图以进行键盘导航？

> ID：13688972
> 
> 赞同：0
> 
> 时间：2012-12-03T17:55:57.150
> 
> 标签：macos, nstabview

Mac OS X NSTabView：如何显示 TabItem 的键盘导航视图？

我有一个与鼠标配合得很好的 TabView。我想让 NSTabView 支持键盘导航。

使用箭头键在各种 TabItems 之间移动，但不会导致 TabItem 视图出现。我需要单击选项卡才能显示选项卡的视图。

使用箭头键时，NSTabViewDelegate 方法

```
tabView:shouldSelectTabViewItem: 
```

被调用并返回 YES。没有调用其他 NSTabViewDelegate 方法，因此不显示其视图。

使用键盘到达 TabItem 时触发鼠标单击（显示视图）操作的最佳/推荐方法是什么？这可以在 Xcode 中修复还是我必须涉及子类化和/或通知？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T04:27:03.480

在 MyAppController (mainWindow) 中，应用程序最初使用此代码来放置 editRecipeController 的窗口，一个 NSPanel

// 将 EditWindow 作为工作表启动的原始代码

```
 [NSApp beginSheet:[editController window] modalForWindow:[self window] modalDelegate:nil didEndSelector:nil contextInfo:nil];
    [NSApp runModalForWindow:[editController window]];
    // sheet is up here...
    [NSApp endSheet: [editController window]];
    [[editController window] orderOut:nil];
    [[editController window] close]; 
```

在 Window 内部，一个 NSPanel，有一个 NSTabView。使用鼠标，面板功能齐全。它有一个五个选项卡 NSTabView。一个 Tab 有一个 NSTextField，三个 Tab 有一个 NSTextView。第五个有一个 NSTableView。

我遇到的问题如下，当用户使用箭头键从一个选项卡导航到另一个选项卡时，正确的选项卡被突出显示，但没有被“选中”，也就是说，它的视图没有显示。使视图出现的唯一方法是用鼠标单击选项卡。

```
My goal is to have full keyboard support for the NSTabView 
```

我能够通过以下方式获得 NSTabView 的正确行为： Hillegass' Book , Chapter 25, "Sheets.

```
 // MyAppController.m  - WindowController for mainWindow

    - (IBAction) editRecipeAction:(id)sender {
        // setup the edit sheet controller if one hasn't been setup already
        if (editRecipeController == nil){
            editRecipeController = [[EditRecipeController alloc] initWithWindowNibName:@"EditRecipe"];
            //[editRecipeController setMyAppController:self];
        }

        [[NSApplication sharedApplication] beginSheet:editRecipeController.window
                     modalForWindow:self.window
                      modalDelegate:editRecipeController
                     didEndSelector:@selector(sheetDidEnd:returnCode:contextInfo:)
                         contextInfo:nil];
    } 
```

//结束MyAppController.m

// 编辑配方控制器.m

```
 - (IBAction)cancel:(id)sender
    {

        [NSApp endSheet:self.window returnCode:0 ] ;
        [self.window orderOut:self];
    }

- (void) sheetDidEnd:(NSWindow *) sheet returnCode:(int)returnCode contextInfo:(void *) contextInfo {

   DLog(@"sheet=%@",sheet);

} 
```

如果您的目标是对此类 NSTabView 的完整键盘支持，我认为您将需要类似以下使用 NSTabViewDelegate 方法的内容：

```
 - (void)tabView:(NSTabView *)aTabView didSelectTabViewItem:(NSTabViewItem *)tabViewItem{

        NSNumberFormatter * f = [[NSNumberFormatter alloc] init];
        [f setNumberStyle:NSNumberFormatterDecimalStyle ];
        NSNumber *tabNumber =
        [f numberFromString:tabViewItem.identifier];
        [f release];

        switch (tabNumber.integerValue) {
            case 1:
                editRecipeController.tabView.nextKeyView = editRecipeController.textViewIngredients;
                editRecipeController.textViewIngredients.nextKeyView = editRecipeController.cancelButton;
                editRecipeController.cancelButton.nextKeyView = editRecipeController.doneButton;
                editRecipeController.doneButton.nextKeyView = editRecipeController.tabView;
                break;
            case 2:
                editRecipeController.tabView.nextKeyView = editRecipeController.textViewDirections;
                editRecipeController.textViewDirections.nextKeyView = editRecipeController.cancelButton;
                editRecipeController.cancelButton.nextKeyView = editRecipeController.doneButton;
                editRecipeController.doneButton.nextKeyView = editRecipeController.tabView;
                break;
            case 3:
                editRecipeController.tabView.nextKeyView = editRecipeController.textViewDirections;
                editRecipeController.textViewDirections.nextKeyView = editRecipeController.cancelButton;
                editRecipeController.cancelButton.nextKeyView = editRecipeController.doneButton;
                editRecipeController.doneButton.nextKeyView = editRecipeController.tabView;
                break;
            case 4: // Comments
                editRecipeController.tabView.nextKeyView = editRecipeController.textViewComments;
                editRecipeController.textViewComments.nextKeyView = editRecipeController.cancelButton;
                editRecipeController.cancelButton.nextKeyView = editRecipeController.doneButton;
                editRecipeController.doneButton.nextKeyView = editRecipeController.tabView;
                break;
            case 5: //Categories - Table can not be edited 
                editRecipeController.tabView.nextKeyView = editRecipeController.cancelButton;
                editRecipeController.cancelButton.nextKeyView = editRecipeController.doneButton;
                editRecipeController.doneButton.nextKeyView = editRecipeController.tabView;
                break;
            default:
                DLog(@"switch value error");
                break;
        }// end switch

    } 
```

# javascript - requirejs r.js 在主库上优化了组件构建

> ID：13688973
> 
> 赞同：1
> 
> 时间：2012-12-03T17:56:10.007
> 
> 标签：javascript, gwt, requirejs, js-amd, r.js

我想获得一些关于将子模块组合成更大项目的最佳实践建议。在开发模式下，它可以正常工作，因为 require 可以即时解析所有 deps - 但是现在需要为 GWT 应用程序生成它，因为它显然很难通过回调来消耗异步内容。

结构如下（这可以单独构建并根据需要创建文件）：

*   main（构建所有共享库资源等）
    *   组件 A（需要 main 存在但在自己的构建中排除）
    *   ... 成分 N

要在这样加载的应用程序中使用：

```
<script src='require.js'></script>
<script src='main-lib-min.js'></script>
<script src='component-a-min.js'></script>
<script src='component-n-min.js'></script>

<!-- client to all these files is a single app to kick off: -->
<script src='app.js'></script> 
```

main 被定义为一个需要包装并在完成时触发一个事件。组件是`define()`包装中的模块集合。

问题是，`app.js`在解决所有引用之前不应引用任何内容。并且`component-A`可能有对导出的引用，`main-lib`因此不应在加载前一个脚本之前对其进行评估。

在 chrome 中，我们看到并行下载和引用错误。需要阻止它。由于`r.js`构建已经预先打包了所有内容，因此工厂应该能够返回上面定义的任何模块。

即做：

`var foo = require('foo');`应该没问题。

如果 app.js 创建为：

```
require(['foo'], function(foo){

}); 
```

然后它工作。

有没有人有生产这种组件构建/模块模式的经验？您是否会包含 main-lib 构建配置中的所有模块，`modules: []`以便它们相互等待？如果您希望客户端（即 html 文件）成为添加模块的那个人怎么办？

你会改变加载吗？是否有更适合确保类似同步行为的 GWT 加载器？性能不是问题。

# javascript - Javascript 中的防欺骗时间

> ID：13688975
> 
> 赞同：3
> 
> 时间：2012-12-03T17:56:10.143
> 
> 标签：javascript, time

我正在开发一个必须测量用户需要做某事的时间的网络应用程序。我不能简单地使用 javascript time 对象，因为用户可能会更改系统时间来欺骗和欺骗应用程序。我需要一些方法来防止这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T17:59:09.283

**在服务器**端计算时间。

客户端用户不能这样做（至少他们不应该这样做）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T17:59:32.143

我会让网络应用程序将心跳或任何其他形式的信号发送回服务器端。然后你可以构建一些指标，比如`duration = end - start`

考虑到往返客户端-服务器通信，这显然不适合 ms 分辨率测量。

**注意：**将时间从“受信任的”Web 服务读取到您的客户端应用程序中并不是一个好主意，您不能真正保证应用程序不会对其进行调整。（客户端交易的基本规则之一是不信任其输入，例如，对于验证，您仍然需要在顶部进行服务器端验证）。但是，如果您只是向服务器发送信号，使用服务器的时钟记录其时间戳，您会更安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T17:59:03.553

然后你必须在**服务器端**进行。客户端上发生的一切都是可操作的。
一种方法是进行 ajax 调用并在 php 或其他服务器端脚本中测量时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T18:59:17.660

这在很大程度上取决于您需要什么时间测量精度。

如果您要测量很长时间（一分钟或更长时间）并且只需要在一分钟内精确，那么使用 ajax 调用来获取远程服务器时间显然是比任何客户端时钟测量更简单的方法。

如果您想在一分钟内测量更短的时间，那么您将需要使用本地时钟来达到任何精度。为此，您可以使用以下类型算法检查本地计算机的时钟是否被弄乱：

1.  向服务器发送远程请求以获取当前时间。这可以是公开可用的时间资源，也可以是您自己的服务器。
2.  获取本地计算机上的当前时间。
3.  计算这两次之间的偏移量。您正在寻找的是偏移量没有显着变化。
4.  使用本地计算机时间，标记本地操作的开始
5.  用户执行他们的操作。
6.  获取本地计算机上的当前时间以标记本地操作的结束
7.  再次获得远程时间。
8.  获取本地计算机上的当前时间
9.  计算本地时间和服务器时间之间的偏移量。允许检索远程时间所花费的时间量有微小差异，看看该差异是否与先前计算的差异相对相同。如果这个差异不一样，那么本地时钟已经被弄乱了。

请注意，因为您无法立即获得远程时间（检索它时总是存在不确定的延迟时间），因此在验证本地时钟是否没有被打乱时存在几秒钟的内在误差。不准确之处不在于测量本地操作，而在于验证本地时钟没有被弄乱。

所以......这种技术最适合检测超过几秒的时钟操作，而不是更小的操作。

# mysql - 只有当我有一个不同的 ID 时，我才如何求和？

> ID：13688976
> 
> 赞同：1
> 
> 时间：2012-12-03T17:56:22.810
> 
> 标签：mysql, group-by, sum

我有一些连接将我的结果乘以 select 语句，如下所示：

```
SELECT
  SUM(so.total_value)
FROM 
  sugarcrm2.so_order so 
LEFT JOIN 
  sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
LEFT JOIN
  reporting.backblaze_sales_orders bb on so.id = bb.id 
LEFT JOIN
  reporting.territories_copy_copy tc on TRIM(so.technical_address_state) = tc.state
WHERE 
  so.id = "106f3ff1-56df-8d66-3f9b-4fec87aa12fd"
ORDER BY 
 id 
```

如果我执行此查询，我会两次获得相同的 id。

```
SELECT
  so.id
FROM 
  sugarcrm2.so_order so 
LEFT JOIN 
  sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
LEFT JOIN
  reporting.backblaze_sales_orders bb on so.id = bb.id 
LEFT JOIN
  reporting.territories_copy_copy tc on TRIM(so.technical_address_state) = tc.state
ORDER BY 
 id 
```

如何对 total_value 求和，但前提是 id 不同？

我正在寻求解决上述问题，以便可以消除以下查询中的重复：

```
SELECT
    IF(so.technical_address_country = 'USA' OR so.technical_address_country = 'Canada',1,0) as home,
  IF(so.technical_address_country = 'USA' OR so.technical_address_country = 'Canada', tc.territory, null) as territory,
  so.technical_address_country,
  IF(so.technical_address_country = 'USA' OR so.technical_address_country = 'Canada', TRIM(so.technical_address_state), null) as state,
  /* ALL JOBs */
  COUNT(distinct so.id) as all_sales,
  COUNT(mf.id) as all_jobs,
  SUM(so.total_value) as all_value,
  count(distinct case when so.check_if_new_customer=1 then so.id else null end) as sales_order_new,
    SUM(IF(so.check_if_new_customer=1 AND mf.id IS NOT NULL,1,0)) as jobs_new,
  SUM(IF(so.check_if_new_customer=1,so.total_value,0)) as total_value_new,
  count(distinct case when so.check_if_new_customer=0 then so.id else null end) as sales_order_existing,
    SUM(IF(so.check_if_new_customer=0 AND mf.id IS NOT NULL,1,0)) as jobs_existing,
  SUM(IF(so.check_if_new_customer = 0,so.total_value,0)) as total_value_existing,
    /* BACKBLAZES */
  count(distinct case when bb.id is not null then so.id else null end) as all_sales_back_blaze,
  SUM(IF(bb.id IS NOT NULL and mf.id is not null,1,0)) as all_jobs_back_blaze,
  SUM(IF(bb.id IS NOT NULL,so.total_value, 0)) as all_value_back_blaze,
  count(distinct case when bb.id is not null AND so.check_if_new_customer = 1 then so.id else null end) as sales_order_new_back_blaze,
    SUM(IF(so.check_if_new_customer=1 AND  mf.id IS NOT NULL AND bb.id IS NOT NULL,1,0)) as jobs_new_back_blaze,
  SUM(IF(so.check_if_new_customer = 1 AND bb.id IS NOT NULL,so.total_value,0)) as total_value_new_back_blaze,
  count(distinct case when bb.id is not null AND so.check_if_new_customer = 0 then so.id else null end) as sales_order_existing_back_blaze,
    SUM(IF(so.check_if_new_customer=0 AND mf.id IS NOT NULL AND bb.id IS NOT NULL,1,0)) as jobs_existing_back_blaze,
  SUM(IF(so.check_if_new_customer = 0 AND bb.id IS NOT NULL,so.total_value,0)) as total_value_existing_back_blaze,

  /* NOT BACKBLAZES */
  SUM(IF(bb.id IS NULL,1,0)) as all_sales_non_back_blaze,
  SUM(IF(bb.id IS NULL and mf.id is not null,1,0)) as all_jobs_non_back_blaze,
  SUM(IF(bb.id IS NULL,so.total_value, 0)) as all_value_non_back_blaze,
    SUM(IF(so.check_if_new_customer=1 AND bb.id IS NULL ,1,0)) as sales_order_new_non_back_blaze,
    SUM(IF(so.check_if_new_customer=1 AND  mf.id IS NULL AND bb.id IS NOT NULL,1,0)) as jobs_new_non_back_blaze,
  SUM(IF(so.check_if_new_customer = 1 AND bb.id IS NULL,so.total_value,0)) as total_value_new_non_back_blaze,
    SUM(IF(so.check_if_new_customer=0 AND bb.id IS NULL,1,0)) as sales_order_existing_non_back_blaze,
        SUM(IF(so.check_if_new_customer=0 AND mf.id IS NULL AND bb.id IS NULL,1,0)) as jobs_existing_non_back_blaze,
  SUM(IF(so.check_if_new_customer = 0 AND bb.id IS NULL,so.total_value,0)) as total_value_existing_non_back_blaze

FROM 
  sugarcrm2.so_order so 
LEFT JOIN 
  sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
LEFT JOIN
  reporting.backblaze_sales_orders bb on so.id = bb.id 
LEFT JOIN
  reporting.territories_copy_copy tc on TRIM(so.technical_address_state) = tc.state
WHERE 
  so.date_entered >= "2011-10-30" AND so.date_entered <="2012-10-30" AND
    so.technical_address_country IS NOT NULL AND  
  so.technical_address_state IS NOT NULL AND 
  so.deleted = 0 AND 
  so.has_been_promoted = 1 AND
  mf.deleted = 0
GROUP BY 
  UPPER(TRIM(so.technical_address_country)), 
  UPPER(TRIM(state))
ORDER BY 
  home DESC,
    so.technical_address_country ASC,
    state  ASC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:10:26.973

那么，你为什么离开？

```
SELECT
  SUM(so.total_value)
FROM 
  sugarcrm2.so_order so 
-- LEFT JOIN 
--   sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
-- LEFT JOIN
--   reporting.backblaze_sales_orders bb on so.id = bb.id 
-- LEFT JOIN
--  reporting.territories_copy_copy tc on TRIM(so.technical_address_state) = tc.state
WHERE 
  so.id = "106f3ff1-56df-8d66-3f9b-4fec87aa12fd"
-- ORDER BY 
--   id 
```

**编辑**：好吧，在这种情况下，这有效：

```
SELECT *, subq.sumfield                -- or fewer fields
FROM 
  sugarcrm2.so_order so 
-- stuff
LEFT JOIN 
  sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
LEFT JOIN
  reporting.backblaze_sales_orders bb on so.id = bb.id 
LEFT JOIN
  reporting.territories_copy_copy tc on TRIM(so.technical_address_state) = tc.state
-- stuff end
LEFT JOIN (
  SELECT id, SUM(total_value) as sumfield 
  FROM sugarcrm2 
  -- joins?   I think not, but you should know
  GROUP BY id
  ) as subq on so.id = subq.id
WHERE 
  so.id = "106f3ff1-56df-8d66-3f9b-4fec87aa12fd"
ORDER BY 
 so.id 
```

最后的：

```
SELECT * FROM

--  this subquery is **only** sugarcrm2 based.
(SELECT 
  technical_address_country                 as oby
  UPPER(TRIM(so.technical_address_country)) as F1,
  UPPER(TRIM(state))                        as F2,

  IF(so.technical_address_country = 'USA' OR so.technical_address_country = 'Canada',1,0) as home,
  IF(so.technical_address_country = 'USA' OR so.technical_address_country = 'Canada', tc.territory, null) as territory,
  so.technical_address_country,
  IF(so.technical_address_country = 'USA' OR so.technical_address_country = 'Canada', TRIM(so.technical_address_state), null) as state,
  /* ALL JOBs */
  COUNT(/*distinct*/ so.id) as all_sales,
  SUM(so.total_value) as all_value,
  count(/*distinct*/ case when so.check_if_new_customer=1 then so.id else null end) as sales_order_new,
  SUM(IF(so.check_if_new_customer=1,so.total_value,0)) as total_value_new,
  count(/*distinct*/ case when so.check_if_new_customer=0 then so.id else null end) as sales_order_existing,
  SUM(IF(so.check_if_new_customer = 0,so.total_value,0)) as total_value_existing,
FROM 
  sugarcrm2.so_order so 
LEFT JOIN    -- check this please for duplicating records
  reporting.territories_copy_copy tc on TRIM(so.technical_address_state) = tc.state
GROUP BY 
  UPPER(TRIM(so.technical_address_country)),   --  trim?? upper??  can they be without functions?
  UPPER(TRIM(state))
) AS Q1 LEFT JOIN 

--  To be sure about this subquery is necesary to understud the schema.  it is a copy of your original query.
(SELECT
  UPPER(TRIM(so.technical_address_country)) as F1,
  UPPER(TRIM(state))                        as F2,

  COUNT(mf.id) as all_jobs,
    SUM(IF(so.check_if_new_customer=1 AND mf.id IS NOT NULL,1,0)) as jobs_new,
    SUM(IF(so.check_if_new_customer=0 AND mf.id IS NOT NULL,1,0)) as jobs_existing,
    /* BACKBLAZES */
  count(distinct case when bb.id is not null then so.id else null end) as all_sales_back_blaze,
  SUM(IF(bb.id IS NOT NULL and mf.id is not null,1,0)) as all_jobs_back_blaze,
  SUM(IF(bb.id IS NOT NULL,so.total_value, 0)) as all_value_back_blaze,
  count(distinct case when bb.id is not null AND so.check_if_new_customer = 1 then so.id else null end) as sales_order_new_back_blaze,
    SUM(IF(so.check_if_new_customer=1 AND  mf.id IS NOT NULL AND bb.id IS NOT NULL,1,0)) as jobs_new_back_blaze,
  SUM(IF(so.check_if_new_customer = 1 AND bb.id IS NOT NULL,so.total_value,0)) as total_value_new_back_blaze,
  count(distinct case when bb.id is not null AND so.check_if_new_customer = 0 then so.id else null end) as sales_order_existing_back_blaze,
    SUM(IF(so.check_if_new_customer=0 AND mf.id IS NOT NULL AND bb.id IS NOT NULL,1,0)) as jobs_existing_back_blaze,
  SUM(IF(so.check_if_new_customer = 0 AND bb.id IS NOT NULL,so.total_value,0)) as total_value_existing_back_blaze,

  /* NOT BACKBLAZES */
  SUM(IF(bb.id IS NULL,1,0)) as all_sales_non_back_blaze,
  SUM(IF(bb.id IS NULL and mf.id is not null,1,0)) as all_jobs_non_back_blaze,
  SUM(IF(bb.id IS NULL,so.total_value, 0)) as all_value_non_back_blaze,
    SUM(IF(so.check_if_new_customer=1 AND bb.id IS NULL ,1,0)) as sales_order_new_non_back_blaze,
    SUM(IF(so.check_if_new_customer=1 AND  mf.id IS NULL AND bb.id IS NOT NULL,1,0)) as jobs_new_non_back_blaze,
  SUM(IF(so.check_if_new_customer = 1 AND bb.id IS NULL,so.total_value,0)) as total_value_new_non_back_blaze,
    SUM(IF(so.check_if_new_customer=0 AND bb.id IS NULL,1,0)) as sales_order_existing_non_back_blaze,
        SUM(IF(so.check_if_new_customer=0 AND mf.id IS NULL AND bb.id IS NULL,1,0)) as jobs_existing_non_back_blaze,
  SUM(IF(so.check_if_new_customer = 0 AND bb.id IS NULL,so.total_value,0)) as total_value_existing_non_back_blaze

FROM 
  sugarcrm2.so_order so 
LEFT JOIN 
  sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
LEFT JOIN
  reporting.backblaze_sales_orders bb on so.id = bb.id 
WHERE 
  so.date_entered >= "2011-10-30" AND so.date_entered <="2012-10-30" AND
    so.technical_address_country IS NOT NULL AND  
  so.technical_address_state IS NOT NULL AND 
  so.deleted = 0 AND 
  so.has_been_promoted = 1 AND
  mf.deleted = 0
GROUP BY 
  UPPER(TRIM(so.technical_address_country)), 
  UPPER(TRIM(state))
) AS Q2 on Q1.F1 = Q2.F1 and Q1.F2 = Q2.F2

ORDER BY 
  home  DESC,
  oby   ASC,   -- oby is similar but not F2, you can change
  F2    ASC 
```

# jquery - JQuery addClass不适用于动态添加的项目

> ID：13688978
> 
> 赞同：0
> 
> 时间：2012-12-03T17:56:46.920
> 
> 标签：jquery, json

当我单击动态添加的项目时，我正在尝试更改 css 类。我确实在 doStuffWithThisItem 方法中有该项目，但似乎更改没有保存回 dom 树。但我无法让它工作。你能发现我做错了什么吗？

```
 <style type="text/css">
        .selectedItem {
            background-color: red;
        }
    </style>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script type="text/javascript">

        jQuery(document).ready(function () {

            function doStuffWithThisItem(item) {
                alert(item.id);
                jQuery(item.id).addClass('selectedItem');
            }

            function parseNodes(nodes, level) {

                var ol = document.createElement("ul");
                for (var i = 0; i < nodes.length; i++) {
                    ol.appendChild(parseChildNode(nodes[i], level));
                }

                return ol;
            }

            function parseChildNode(child, level) {

                var li = document.createElement('li');
                jQuery(li).html(child.title)
                    .attr("id", child.id)
                    .click(function () {

                        if (level == 1) {
                            doStuffWithThisItem(this);
                        }

                    });

                return li;
            }

            window.jsonData = [{
                    "title": "Item 1",
                    "id": "item1",
                    "description": "Item 1 description"
                },
                {
                    "title": "Item 2",
                    "id": "item2",
                    "description": "item 2 description"
                }];

            jQuery("#someDiv").html(parseNodes(jsonData, 1));
        });

    </script>

<div id="someDiv"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:02:14.597

请更换 ：

```
jQuery(item.id).addClass('selectedItem'); 
```

到：

```
jQuery("#"+item.id).addClass('selectedItem'); 
```

您在选择器中有错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:00:35.197

你已经有了 html 元素，`doStuffWithThisItem`所以你不需要用它来获取它`id`，因为你做得不好。

试试这个：

```
function doStuffWithThisItem(item) {
     alert(item.id);
     jQuery(item).addClass('selectedItem');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T18:01:09.017

您是否尝试过使用 .on 和 .live 处理程序：

```
jQuery(li).html(child.title)
                .attr("id", child.id)
                .on('click',function () {

                    if (level == 1) {
                        doStuffWithThisItem(this);
                    }

                }); 
```

或者

```
jQuery(li).html(child.title)
                .attr("id", child.id)
                .live('click',function () {

                    if (level == 1) {
                        doStuffWithThisItem(this);
                    }

                }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T18:01:55.350

我认为这与动态添加的项目有关。我之前遇到过这种情况，并且不得不使用该`.on()`方法将事件附加到动态添加的项目上。

另外，我认为您的**选择器**应该只是**item**，而不是`item.id`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T18:04:11.947

```
jQuery(item.id).addClass('selectedItem'); 
```

应该是

```
jQuery('#' + item.id).addClass('selectedItem'); //  OR   jQuery(item) 
```

缺少#ID**选择**器..

**[检查小提琴](http://jsfiddle.net/sushanth009/yXq6Z/)**

# matlab - 编写乘法 MATLAB 风格

> ID：13688980
> 
> 赞同：1
> 
> 时间：2012-12-03T17:57:01.660
> 
> 标签：matlab

MATLAB 的语法与传统的 DO 循环“逻辑”有些不同，后者一次迭代一个索引。考虑到这一点，编写以下内容的更合适的方法是什么，所以它运行得更快一些，但对于不太熟悉 MATLAB 的人来说仍然相对清楚。

```
KT = 0.;
for i=1:37
   dKT = KTc(i,1) *const2^KTc(i,2) *const3^KTc(i,3) *const4^KTc(i,4) *const5^KTc(i,5);
   KT = KT + dKT;
end
sprintf('KT = %f10.8', KT); 
```

KTc 是一个 37x5 矩阵（如果有帮助，只有 (i,1) 值是 REAL 值，其余的是 INTEGER）

所有常量都是 REAL 标量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:37:13.023

您的台词（在原始问题中）正确：

```
KT = 0.;
for i=1:37
   dKT = KTc(i,1) *const2^KTc(i,2) *const3^KTc(i,3) *const4^KTc(i,4) *const5^KTc(i,5);
   KT = KT + dKT;
end
sprintf('KT = %f10.8', KT); 
```

另一方面，我建议

```
KT = repmat([1; const2; const3; const4; const5], 1, n) .^ KTc;
KT(1,:) = KTc(1,:);
KT = sum(KT(:)); 
```

在真正的 matlab 风格的程序中很少使用循环。这样做的原因是，虽然我的第二个解决方案执行了更多操作，但实际上它更快，因为处理器处的缓存更优化、并行化以及其他可能的优化在后台静默完成。

更新：（关于repmat的解释）

我认为 repmat 是“复制矩阵”的缩写。它的真正作用最好用两个典型的例子来解释：

```
v_row=[1 2 3];
repmat(v_row, 2, 1);
%result:
[1 2 3
 1 2 3]

v_col=[1;2;3];      % I could also write v_col=v_row';
repmat(v_col, 1, 2);
[1 1
 2 2
 3 3] 
```

一般来说，repmat 会这样做：

```
repmat(m, 2, 3);
[m m m
 m m m] 
% if m=[1 2; 3 4] was the value of m, then
 [1     2     1     2     1     2
  3     4     3     4     3     4
  1     2     1     2     1     2
  3     4     3     4     3     4] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:09:04.977

尝试 ...

```
KT = KT_coeff(1,1:37) .* const1.^KT_coeff(2,1:37) .* const2.^KT_coeff(3,1:37) .* const3.^KT_coeff(4,1:37) .*  const4.^KT_coeff(5,1:37); 
```

鉴于您知道每个 KT_coeff 在第二维中的大小为 37，您可以通过替换`1:37`为`:`上面的内容来进一步简化这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T19:25:28.473

我会避免所有这些指数，先取一个日志，然后再取一个 exp。

```
 % // way cheaper to evaluate
  log_KT = log([c1 c2 c3 c4])*KT_coeff(2:end,:); 
    % // Final exp
  KT = KT_coeff(1,:) .* exp(log_KT);  

 KT = sum(KT); 
```

# jsf-2 - 如果路径中有空格，JSF2.1.x 将不起作用。错误：索引 22 处的不透明部分中存在非法字符

> ID：13688981
> 
> 赞同：1
> 
> 时间：2012-12-03T17:57:03.203
> 
> 标签：jsf-2, websphere, ibm-rad

我的应用程序最近从 JSF 1.2 升级到了 JSF 2.1.3。我正在使用 Mojarra。

我的应用程序通过 RAD8 中的 WAS7 管理控制台安装为 EAR。

索引 22 指的是“程序文件”中的空间。

当服务器在这里启动时，我得到的重要错误是：

```
Caused by: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at java.net.URI$Parser.fail(URI.java:2809)
    at java.net.URI$Parser.checkChars(URI.java:2982)
    at java.net.URI$Parser.parse(URI.java:3019)
    at java.net.URI.<init>(URI.java:578)
    at com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.loadURLs(MetaInfFacesConfigResourceProvider.java:160)
    ... 30 more 
```

这是完整的堆栈跟踪：

```
[12/3/12 11:26:02:659 CST] 00000009 webapp        E com.ibm.ws.webcontainer.webapp.WebApp notifyServletContextCreated SRVE0283E: Exception caught while initializing context: {0}
                                 java.lang.RuntimeException: com.sun.faces.config.ConfigurationException: java.util.concurrent.ExecutionException: javax.faces.FacesException: java.io.IOException: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:290)
    at com.ibm.ws.webcontainer.webapp.WebApp.notifyServletContextCreated(WebApp.java:1708)
    at com.ibm.ws.webcontainer.webapp.WebApp.commonInitializationFinish(WebApp.java:381)
    at com.ibm.ws.webcontainer.webapp.WebAppImpl.initialize(WebAppImpl.java:299)
    at com.ibm.ws.webcontainer.webapp.WebGroupImpl.addWebApplication(WebGroupImpl.java:100)
    at com.ibm.ws.webcontainer.VirtualHostImpl.addWebApplication(VirtualHostImpl.java:166)
    at com.ibm.ws.webcontainer.WSWebContainer.addWebApp(WSWebContainer.java:732)
    at com.ibm.ws.webcontainer.WSWebContainer.addWebApplication(WSWebContainer.java:617)
    at com.ibm.ws.webcontainer.component.WebContainerImpl.install(WebContainerImpl.java:376)
    at com.ibm.ws.webcontainer.component.WebContainerImpl.start(WebContainerImpl.java:668)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1127)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1319)
    at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:610)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:944)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:740)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2051)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:385)
    at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:123)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:328)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.access$300(CompositionUnitMgrImpl.java:113)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl$CUInitializer.run(CompositionUnitMgrImpl.java:895)
    at com.ibm.wsspi.runtime.component.WsComponentImpl$_AsynchInitializer.run(WsComponentImpl.java:349)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1613)
Caused by: com.sun.faces.config.ConfigurationException: java.util.concurrent.ExecutionException: javax.faces.FacesException: java.io.IOException: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at com.sun.faces.config.ConfigManager.getConfigDocuments(ConfigManager.java:663)
    at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:323)
    at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:223)
    ... 22 more
Caused by: java.util.concurrent.ExecutionException: javax.faces.FacesException: java.io.IOException: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)
    at java.util.concurrent.FutureTask.get(FutureTask.java:83)
    at com.sun.faces.config.ConfigManager.getConfigDocuments(ConfigManager.java:649)
    ... 24 more
Caused by: javax.faces.FacesException: java.io.IOException: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.getResources(MetaInfFacesConfigResourceProvider.java:135)
    at com.sun.faces.config.ConfigManager$URITask.call(ConfigManager.java:1179)
    at com.sun.faces.config.ConfigManager$URITask.call(ConfigManager.java:1148)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at com.sun.faces.config.ConfigManager.getConfigDocuments(ConfigManager.java:639)
    ... 24 more
Caused by: java.io.IOException: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.loadURLs(MetaInfFacesConfigResourceProvider.java:177)
    at com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.getResources(MetaInfFacesConfigResourceProvider.java:108)
    ... 29 more
Caused by: java.net.URISyntaxException: Illegal character in opaque part at index 22: wsjar:file:/C:/Program Files/IBM/SDP/runtimes/base_v7/profiles/IndSalesUtilsAppSrv02/installedApps/R8CMY8NW7LNode03Cell/IndUserServices.ear/IndUserServicesWeb.war/WEB-INF/lib/ind-jsf-v1.6.0.jar!/META-INF/faces-config.xml
    at java.net.URI$Parser.fail(URI.java:2809)
    at java.net.URI$Parser.checkChars(URI.java:2982)
    at java.net.URI$Parser.parse(URI.java:3019)
    at java.net.URI.<init>(URI.java:578)
    at com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.loadURLs(MetaInfFacesConfigResourceProvider.java:160)
    ... 30 more 
```

我尝试过但没有奏效的事情：

1.  更新到 JSF 2.1.14（查看 MetaInfFacesConfigResourceProvider 的源代码，我发现它没有从 2.1.3 更改为 2.1.14，所以它不起作用是有道理的。）
2.  获取源代码 将应用程序作为项目导入（如果项目路径没有空格则有效，如果项目路径中有空格则无效）
3.  将服务器上的“运行时环境”从“C:\Program Files\IBM\SDP\runtimes\base_v7”更改为“C:\Progra~1\IBM\SDP\runtimes\base_v7”（似乎没有做任何事情)

我很确定它与[这个](http://java.net/jira/browse/JAVASERVERFACES-2057)问题有关，似乎永远不会得到解决

如果这是 IBM 的问题，我不会感到惊讶。但是我需要在没有 IBM 修复的情况下以某种方式完成这项工作。

目前不能选择在不包含空格的新位置重新安装 RAD8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T15:17:44.613

这似乎已在 2.1.16 和 2.2 主干中修复。

[http://java.net/jira/browse/JAVASERVERFACES-2628](http://java.net/jira/browse/JAVASERVERFACES-2628)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T14:36:52.643

试试这个：

```
File f = new File("C:/Program Files/I...[rest of filepath]");
URI u = f.toURI(); 
```

获取您的 URI。空格在文件名中有效，但在 URI 中无效，这将正确转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T14:54:16.230

**当我部署一个战争应用程序**（在耳朵内）并且战争应用程序的名称中**包含空格**时，这个问题总是出现在 IBM WAS 7/8 上。

我的解决方案是**删除“战争”文件名中的每个空格**。

# maven - Maven 模块与独立 Maven POM 作为依赖项

> ID：13688988
> 
> 赞同：1
> 
> 时间：2012-12-03T17:57:27.950
> 
> 标签：maven, pom.xml, parent-pom

我目前正在从事一个包含大约十几个子项目的项目。

每个子项目都包含一个单独构建依赖关系的 POM。

上游子项目包含下游子项目作为依赖项，就像您包含对 log4j 之类的依赖项一样：

```
 <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.16</version>
    </dependency> 
```

我们将这些依赖项保存在本地 Nexus 存储库中。

这似乎对我们有用。

然而，经过 11 个月的开发，我今天决定重新审视这十几个 POM 文件，并考虑到重构。

我随后发现了`<parent>`and`<module>`标签，并开始质疑我的 Maven 项目策略是否“正确”。

重构我的 POM 以将最上层的 POM（Web WAR 项目）更改为列出模块而不是上面的一系列依赖项的父 POM 会有什么好处？

我希望这十几个子项目中的大多数都拥有自己的生命周期，这样它们就可以在公司的 Nexus 存储库中作为其他公司项目的代码库使用。

例如，是否使用多模块方法来分解和组织项目子组件的组合？或者是否会使用一个模块来表示项目的整个组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T13:29:57.067

到目前为止，感谢大家的意见-我意识到这个问题是主观的。

过了一会儿，在我看来，这个问题的“正确”答案将由另一个问题决定：每个子项目是否都有自己的生命周期？

我想我们可以使用 UML 类聚合和组合作为隐喻。如果一个子项目（从@yorkw 借用一个术语的叶节点）不能单独存在或在父项目范围之外有自己的生命周期（无论是WAR、EAR 等等），那么恕我直言该结构将保证在父 POM 中使用模块。

否则，由于该项目可以独立存在，我会说（再次恕我直言）该结构将保证将该项目包含为对其父项目的依赖。

# ffmpeg - ffmpeg升级后解码器崩溃

> ID：13688992
> 
> 赞同：4
> 
> 时间：2012-12-03T17:57:45.447
> 
> 标签：ffmpeg, libavcodec

最近我将 ffmpeg 从 0.9 升级到 1.0（在 Win7x64 和 iOS 上测试），现在是`avcodec_decode_video2`seagfaults。长话短说：每次视频尺寸发生变化时都会发生崩溃（例如，从 320x240 变为 160x120，反之亦然）。

我从一些专有来源接收 mpeg4 视频流并像这样解码它：

```
// once, during initialization:
AVCodec *codec_ = avcodec_find_decoder(CODEC_ID_MPEG4);
AVCodecContext ctx_ = avcodec_alloc_context3(codec_);
avcodec_open2(ctx_, codec_, 0);
AVPacket packet_;
av_init_packet(&packet_);
AVFrame picture_ = avcodec_alloc_frame();

// on every frame:
int got_picture;
packet_.size = size;
packet_.data = (uint8_t *)buffer;
avcodec_decode_video2(ctx_, picture_, &got_picture, &packet_); 
```

同样，在我升级到 1.0 之前，上述所有操作都完美无缺。现在每次框架尺寸发生变化时 -`avcodec_decode_video2`崩溃。请注意，我没有在 AVCodecContext 中分配宽度/高度 - 无论是在开始时，还是在流更改时 - 这可能是原因吗？

我会很感激任何想法！

**更新：**设置 ctx_.width 和 ctx_.height 没有帮助。

**Update2：**就在崩溃之前，我收到以下日志消息：

> mpeg4，第 24 级：“找到 2 个未释放的缓冲区！”。级别 8：“断言 i < avci->buffer_count 在 libavcodec/utils.c:603 失败”

**Update3**升级到 1.1.2 修复了这个崩溃。解码器能够再次处理动态的尺寸变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:48:03.573

您可以尝试填写`AVPacket::side_data`. 如果您更改帧大小，编解码器会从中接收信息（请参阅`libavcodec/utils.c apply_param_change function`）

这个结构可以填充如下：

```
int my_ff_add_param_change(AVPacket *pkt, int32_t width, int32_t height)
{
    uint32_t flags = 0;
    int size = 4 * 3;
    uint8_t *data;
    if (!pkt)
        return AVERROR(EINVAL);

    flags = AV_SIDE_DATA_PARAM_CHANGE_DIMENSIONS;
    data = av_packet_new_side_data(pkt, AV_PKT_DATA_PARAM_CHANGE, size);

    if (!data)
        return AVERROR(ENOMEM);

    ((uint32_t*)data)[0] = flags;
    ((uint32_t*)data)[1] = width;
    ((uint32_t*)data)[2] = height;
    return 0;
} 
```

每次大小更改时都需要调用此函数。

我认为这个功能最近出现了。直到我查看了新的 ffmpeg 资源，我才知道它。

**UPD**

在您编写时，解决问题的最简单方法是执行编解码器重新启动。只需致电`avcodec_close`/`avcodec_open2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-05T17:28:47.253

当我的框架动态改变大小时，我遇到了同样的问题。但是，调用 avcodec_close/avcodec_open2 是多余的。更简洁的方法是在调用 avcodec_decode_video2 之前重置您的 AVPacket 数据结构。这是代码：

`av_init_packet(&packet_)`

这里的关键是此方法将 AVPacket 的所有值重置为默认值。检查[文档](http://www.ffmpeg.org/doxygen/trunk/group__lavc__packet.html#gac9cb9756175b96e7441575803757fb73)以获取更多信息。

# ios - Iphone Adhoc 分发配置文件更新

> ID：13688997
> 
> 赞同：0
> 
> 时间：2012-12-03T17:57:57.650
> 
> 标签：ios, ad-hoc-distribution

我有一个 AdHoc 配置文件，现在我想为该配置文件添加设备，我还需要更新证书吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T18:00:56.073

不，你没有。只需将设备添加到列表中，单击编辑配置文件，选择新添加的设备并单击保存。几秒钟后，您的个人资料将可供下载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T17:59:33.617

不，您只需将设备添加到临时配置文件。