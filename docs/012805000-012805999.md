# StackOverflow 问答 12805000-12805999

# java - 如何在二维数组上正确使用格式化程序？

> ID：12805001
> 
> 赞同：1
> 
> 时间：2012-10-09T17:11:01.447
> 
> 标签：java, multidimensional-array, formatter

我必须将一列中二维数组的行之和添加到右侧。但是，当我运行代码时，它会添加每列中所有行的总和，直到它到达末尾。像这样： http: [//i.imgur.com/7CCPu.png](http://i.imgur.com/7CCPu.png)总和是正确的，但假设每行只有一次。

```
 public static void main(String[] args) throws IOException
{
    // TODO code application logic here
    File election = new File("voting_2008.txt");
    Scanner sc = new Scanner(election);

    String[] states = new String[51];
    int[][]votes = new int[51][4];
    int[] Totalbystate = new int[votes.length];

    for (int s=0; s < 51; s++)
    {
        states[s] = sc.nextLine();
    }

    for(int c=0; c < 3; c++)
    {
        for(int s=0; s < 51; s++)
        {
            votes[s][c] = sc.nextInt();

        }

    }
    Formatter fmt = new Formatter();
    fmt.format("%20s%12s%12s%12s%21s", "State", "Obama", "McCain", "Other", "Total by state");
    System.out.println(fmt);
    for (int s=0; s < 51; s++)
    {
       fmt = new Formatter();
       fmt.format("%20s", states[s]);
       System.out.print(fmt);
       for(int c=0; c < 3; c++)
       {
           fmt = new Formatter();
           fmt.format("%12d", votes[s][c]);
           System.out.print(fmt);

       }

       for(int row=0; row < votes.length; row++)
       {   
            int sum =0;
           for (int col=0; col < votes[row].length; col++)
           {
              sum = sum + votes[row][col];

           }
          fmt = new Formatter();
            fmt.format("%21d", sum);
            System.out.print(fmt);  
       }

       System.out.println();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:17:55.687

```
 for(int row=0; row < votes.length; row++)
   {   
        int sum =0;
        for (int col=0; col < votes[row].length; col++)
         {
          sum = sum + votes[row][col];

        }
        fmt = new Formatter();
        fmt.format("%21d", sum);  
        System.out.print(fmt); // You are not printing newline after each vote..
   } 
```

尝试使用 : -`System.out.println(fmt);`代替注释代码..

**更新**：- **不要进行上述更改**.. 将不起作用.. 确实进行以下更改。

这就是问题所在..您正在打印`total no of votes`, 51 * 51 次..您将这个循环放在另一个循环中，该循环已经运行了 51 次..

所以，**要解决你的问题**..从上面的代码中删除外循环，并保持这样： -

```
 //for(int row=0; row < votes.length; row++) // Remove this loop
   //{ // Remove this

        int sum =0;
        for (int col=0; col < votes[s].length; col++)
         {
          sum = sum + votes[s][col];

        }
        fmt = new Formatter();
        fmt.format("%21d", sum);  
        System.out.print(fmt);
   //} // Remove this also.. 
```

你的价值`s`来自最外层的循环..

**更新**：-**如果您想要所有选票的总和..对于所有列..**

```
int totalSum = 0;    // Declare a variable outside it..
for (int s=0; s < 51; s++)   // This is the place where the loop started
{
   fmt = new Formatter();
   fmt.format("%20s", states[s]);
   System.out.print(fmt);

   // Other inner loops

    int sum =0;   // Your innerloop that calculates sum of each state..
    for (int col=0; col < votes[s].length; col++)
     {
      sum = sum + votes[s][col];

    }

    totalSum += sum;   // Add sum to `totalSum`
    fmt = new Formatter();
    fmt.format("%21d", sum);  
    System.out.print(fmt);

    // Continue with the outer loop
} 
```

# iphone - UIRefreshControl 问题

> ID：12805003
> 
> 赞同：6
> 
> 时间：2012-10-09T17:11:13.270
> 
> 标签：iphone, objective-c, ios, uirefreshcontrol

我正在尝试`UIRefreshControl`在我的应用程序中实现。我有一个 xib 文件，我`UITableViewController`在空的 nib 文件中添加了一个，并将刷新属性设置为“启用”。我还向`viewDidLoad`自定义刷新方法添加了代码。问题是我有一个错误，我找不到任何信息......在我的`viewDidLoad`我得到“`refreshControl`在类型的对象上找不到属性`ViewController`”

```
- (void)viewDidLoad{

[super viewDidLoad];

self.myTableView =
[[UITableView alloc] initWithFrame:self.view.bounds
                           style:UITableViewStyleGrouped];

self.myTableView.autoresizingMask = UIViewAutoresizingFlexibleWidth |
                                  UIViewAutoresizingFlexibleHeight;

self.myTableView.delegate = self;
self.myTableView.dataSource = self;

[self.view addSubview:self.myTableView];

UIRefreshControl *refresh = [[UIRefreshControl alloc] init];

refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Pull to Refresh"];
[refresh addTarget:self action:@selector(refreshView:) forControlEvents:UIControlEventValueChanged];

self.refreshControl = refresh;

}

-(void)refreshView:(UIRefreshControl *)refresh {

refresh.attributedTitle = [[NSAttributedString alloc] initWithString:@"Refreshing data..."];

// custom refresh logic would be placed here...

NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"MMM d, h:mm a"];
NSString *lastUpdated = [NSString stringWithFormat:@"Last updated on %@",
                                [formatter stringFromDate:[NSDate date]]];

refresh.attributedTitle = [[NSAttributedString alloc] initWithString:lastUpdated];
[refresh endRefreshing];

} 
```

我不知道为什么该属性不可用....我错过了什么？

看起来我需要从`UITableViewController`我的`ViewController.h`文件中继承。如果我已经在`UITableView`那里，我如何从两者继承？如果我将代码从 更改为`ViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>`， `ViewController : UITableViewController <UITableViewDelegate, UITableViewDataSource>`则会出现错误：

```
 error: NSInternalInconsistencyException', 
    reason: '-[UITableViewController loadView] loaded the "ViewController_iPhone" nib but didn't get a UITableView.' 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-09T18:25:54.793

您可以将`UIRefreshControl`其作为子视图添加到您的`UITableView`.

```
UIRefreshControl *refreshControl = [[UIRefreshControl alloc] init];
[refreshControl addTarget:self action:@selector(handleRefresh:) forControlEvents:UIControlEventValueChanged];
[self.myTableView addSubview:refreshControl]; 
```

根据 Dave 的评论，这可能会在未来版本的 iOS 中中断。因此，在使用它时请小心，并尝试[向苹果提出错误报告](https://bugreport.apple.com/)。

**更新：** 更好的方法是添加`UITableViewController`为 a `ChildViewController`，`self`然后添加`tableViewController.tableView`为`self.view`. 你不必做任何黑客来使它以这种方式工作。

```
[self addChildViewController:tableViewController];
[self.view addSubview:tableViewController.tableView]; 
```

您可以相应地定义框架`tableView`。使用这种方法，`UIRefreshControl`它的工作方式应该与它的工作方式相同`UITableViewController`。`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-15T07:36:53.130

要记住的事情：

*   `UIRefreshControl`只为`UITableViewController`，所以你的类应该是的子类`UITableViewController`。

*   `UITableViewController`有一个属性`refreshControl`，您应该分配一个`UIRefreshControl` 并将其设置为该属性。

前任：

```
UITableViewController *tableViewController = [[UITableViewController alloc] initWithStyle:UITableViewStylePlain];

UIRefreshControl *refreshControl = [[UIRefreshControl alloc] init];

[refreshControl addTarget:self action:@selector(refreshControlAction:) forControlEvents:UIControlEventValueChanged];

tableViewController.refreshControl = refreshControl; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-13T15:34:25.893

所有这些都是做简单事情的复杂方法。

你不需要添加一个刷新控件，或者在你的 viewController 中声明一个。添加下拉刷新是一个两步过程。
第 1 步：在您的故事板中，转到您的 tableViewController，并在显示“刷新”的位置选择“启用”。
第 2 步：将以下代码添加到 tableViewController.m 文件的 viewDidLoad 中：

```
[self.refreshControl addTarget:self
                            action:@selector(refresh)
                  forControlEvents:UIControlEventValueChanged]; 
```

这就是整个过程，除了在你的 -refresh 方法中做一些事情。当您希望它停止刷新时，请调用`[self.refreshControl endRefreshing];`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T18:32:11.610

您的`ViewController`类必须是的子类`UITableViewController`才能访问该`refreshControl`属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T21:28:33.673

我建议您为 myTableView 创建单独的 UITableViewController 子类。然后使用 addChildviewController 或 iOS6 ContainerView 在原始 ViewController 中添加该类。这样即使在 View 部分，也可以使用 UIRefreshControl。

接受的答案不是官方的方式，所以它可能会在未来的版本中打破，正如评论所说......

# git - Git cherry-pick 创建blob而不是提交？

> ID：12805004
> 
> 赞同：2
> 
> 时间：2012-10-09T17:11:36.837
> 
> 标签：git, tags, diff

几个月前添加的功能出现了回归。该功能是在三个单独的提交中引入的。为了恢复我想要`git cherry-pick`的三个提交到分支（rel060）上的功能，该分支是从提交合并到生产之前创建的最后一个标签（release-0.6.0）创建的，由`git describe`.

这完成了，我想将这个操作的结果与当前生产头上的一个文件的内容进行比较。

```
git co -b rel060 release-0.6.0
git cherry-pick ead47f2
  [rel060 f28fed4] Corrects non-display of subtabs. (SITE-657)
  1 files changed, 5 insertions(+), 8 deletions(-)
git cherry-pick b22c4d4
  [rel060 b0014f1] Correct subtab bug in Firefox/IE. (SITE-657)
  1 files changed, 18 insertions(+), 24 deletions(-)
git cherry-pick ae5a321
  [rel060 5b41410] Corrects bug with subtab line collapse. (SITE-657)
  1 files changed, 5 insertions(+), 1 deletions(-)
git diff rel060:./cron_lp_functions.php..production:./cron_db_lpgenerate.php
  error: Object 2ce3dd45e32e1bef6da0b22a9ee7208c63e203d2 is a blob, not a commit
  error: Object f41574b41b82aba51876b5f7aba0d3ff9c6677c5 is a blob, not a commit
  fatal: Invalid revision range rel060:./cron_lp_functions.php..production:./cron_db_lpgenerate.php 
```

对于它的价值，尝试在 cron_lp_... 上标记自动完成功能：`Not a valid object name rel060:.`

该`functions`文件是一个文件，其内容后来被滚动到`lpgenerate`.

现在，我意识到有一百万种更简单的选择可以做我想做的事情（将三个提交视为一个差异，将释放功能的标签与相关行的当前状态进行差异）。

我想知道的是：为什么我会得到特定的错误？事实证明，摘樱桃似乎与这个问题无关。在从标签创建分支后尝试 diff 会产生相同的错误。我错过了 git 中的一些基本内容吗？从发布中创建一个分支似乎是无害的……有一些我没有注意到的无害的陷阱吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T21:18:00.947

这样做的原因`git diff <commit>..<commit>`只是为了保持向后兼容性并且在语法上是“错误的”。

> git diff A..B" 一开始就是一个不合逻辑的事情。它只是偶然发生的历史事故，并且出于“它从一开始就这样工作，不要破坏向后兼容性”的原因，我们一直在工作。
> 
> 但是，当您作为新用户学习 git 时，最好不要学习它以保持理智。
> 
> 点符号是关于一个范围的。A..B 谈论作为 B 的祖先但不是 A 的祖先的提交集。
> 
> ```
> $ git log A..B 
> ```
> 
> 展示这样的范围是非常有意义的。
> 
> 但是“差异”是关于“比较两个端点”。这种比较没有任何“范围”。当你比较 A 和 B 的状态时，你甚至没有看中间的任何东西。这就是为什么说它的规范方式是
> 
> ```
> $ git diff A B 
> ```
> 
> 并不是
> 
> ```
> $ git diff A..B ;# WRONG. DO NOT DO THIS. 
> ```
> 
> 和 : 是一种在记录在树中命名实体的方法。通常，您使用此语法命名一个 blob，而不是表示子目录的树。
> 
> 现在，B1..B2，当 B1 和 B2 是 blob（或任何不提交的东西）时，即使作为一个范围也没有意义，并且这样的请求在句法级别被检测为错误（即甚至没有开始“比较”）。
> 
> ```
> $ git diff HEAD:Makefile..HEAD~4:Makefile ;# WRONG. DO NOT DO THIS. 
> ```
> 
> 如果要比较两个 blob，可以使用规范的“比较两个事物”语法来实现。
> 
> ```
> $ git diff HEAD:Makefile HEAD~4:Makefile 
> ```

Junio C. Hamano 的回答，来自 git@vger.kernel.org

# jquery - 无法在嵌套列表中选择 ul 和 li 元素

> ID：12805007
> 
> 赞同：1
> 
> 时间：2012-10-09T17:11:42.773
> 
> 标签：jquery, nested, html-lists

我有这个由 jQuery 生成的代码，并且可以是 ul 和 n-list 项的 n 级

```
<ul id="criteria">
<li>
    Goal
    <img id="add_criterion" class="add_criterion" src="../images/icons/add-icon.png">
    <ul id="1" class="criteria">
        <li id="1">
        criteria 1
            <ul id="2" class="criteria">
                <li id="2"> criteria 1
                    <ul id="3" class="criteria">
                       <li id="3">criteria 1</li>
                       <li id="4">criteria 2</li>
                    </ul>
                </li>
                <li id="3"> criteria 2</li>
            </ul>
        </li>
        <li id="2"> criteria 2</li>
    </ul>
</li>
</ul> 
```

我想删除对应于它的id和level的li，我写了这个函数，其中level是ul的id，i是li的id

```
function removeElementLi(i,level){
// if one list item in un order list

if($("ul#criteria ul#"+level+" li").length ==1){
    $("ul#criteria ul#"+level).remove();
}else{
    $("ul#criteria ul#"+level+" li#"+i).remove();
}   
} 
```

但它没有用，我很感激任何帮助。

我将功能更改为

```
if($("ul[id="+level+"][class=criteria] li").length ==1){
    $("ul[id="+level+"][class=criteria]").remove();
}else{
    $("ul[id="+level+"][class=criteria] li#"+i).remove();
} 
```

但是对于这个 html 代码

```
 <ul id="criteria">
    <li>Goal
    <img id="add_criterion" class="add_criterion" src="../images/icons/add-icon.png">
        <ul id="1" class="criteria">
            <li id="1">criteria 1</li>
            <li id="2">criteria 2</li>
        </ul>
    </li>
 </ul> 
```

当我开始删除第二个 li 时，它可以工作，但是当我开始删除第一个 li 时，它不起作用。我提醒 jQuery 语句

```
ul[id=1][class=criteria] li#1 
```

在这种情况下长度为 2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:13:35.930

**注意**：ID 必须是**唯一的**

问题是你正在使用`ul#criteria`它应该是`ul.criteria`因为它`criteria`是一个类

请检查[jquery id 选择器](http://api.jquery.com/id-selector/)和[类选择器](http://api.jquery.com/class-selector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:16:06.467

当您`multiple elements`在页面上有相同的 id 并使用`ID`选择器选择一个元素时，选择器引擎只会选择遇到的第一个 id。

尝试使用 a`class`而不是`id`

# mysql - 使用 asp.net 和 c# 将图像存储到 byte[] 到 Mysql

> ID：12805015
> 
> 赞同：0
> 
> 时间：2012-10-09T17:12:19.543
> 
> 标签：mysql, image, bytearray, blob, store

我正在使用`Asp.net with C#`和后端`MySql`继续`Images as byte[] array`使用`BLOB datatype`

`TABLE : ImageLog`

```
ImgID                 int (auto increment)
ImageLogo             blob 
```

我正在使用以下`function to convert image to array...`

```
private byte[] ConvertImageToByteArray(FileUpload fuImgToByte)
    {
        byte[] ImageByteArray;
        try
        {
            MemoryStream ms = new MemoryStream(fuImgToByte.FileBytes);
            ImageByteArray = ms.ToArray();
            return ImageByteArray;
        }
        catch (Exception ex)
        {
            return null;
        }
    } 
```

这是创建`byte[] bt`插入的调用方法`MySql`

```
Byte[] bt = null;
bt = ConvertImageToByteArray(FileUploader1); --> Passing File Uploader ControlID 
```

像...插入

`INSERT INTO IMAGELOG (ImageLogo) VALUES ('"+bt+"')`;

现在，程序运行完美，没有任何错误，但是当图像存储到 MySql 中时，`it stored like System.Byte[] not into byte[] array`. 结果是这样的……

```
ImgID      ImageLogo
________________________________
  1        System.Byte[]    13K ( Length )  < ----- > not storing byte[] in proper format
  2        System.Byte[]    13K ( Length ) 
```

请告诉我它的格式是否正确？? 或不 ？？欢迎提出任何建议。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T13:34:52.117

在遇到很多困难后解决了问题......只需添加参数，`?`而不是直接在插入查询中传递字节数组`bt`......像这样：

`INSERT INTO IMAGELOG (ImageLogo) VALUES (?p1)`并传递类似这样的值

cmd.Parameters.Add("?p1", bt); <-- 此处添加参数p1值

注意：如果您使用`MySql`作为数据库端，那么我建议使用`?`代替`@`符号。

`OUTPUT:`

```
ImgID      ImageLogo
________________________________
  1        Binary Image    73K ( Length ) < ----- > You can see the difference...
  2        Binary Image    69K ( Length ) 
```

希望对大家有所帮助，Cears。！！

# html - 不会显示 Sprite 图像？

> ID：12805016
> 
> 赞同：1
> 
> 时间：2012-10-09T17:12:27.827
> 
> 标签：html, css, menu

为什么这不会将我的精灵图像显示为黄色边框框的背景？
这里有一个例子：

如果有人能提供一些关于我应该改变什么的例子，那就太好了。

这是我的代码：

html:

```
<div class="repeat">
    <div style='width:100%;'>
        <div style='float:left;margin-top:107px;margin-left:50px;width:80px;height:100px;border:1px solid yellow;'>
            <div class="menu">
                <ul id='nav'>
                    <li class='front'><a href='?p=front'>Front</a></li>
                </ul>
            </div>
        </div>
        <div style='float:left;margin-top:107px;margin-left:10px;width:80px;height:100px;border:1px solid yellow;'></div>
        <div style='clear:both;'></div>
    </div>
</div> 
```

CSS：

```
.repeat {
    float:left;
    width: 884px;
    height: auto;
    min-height:700px;
    background: url(images/repeat.png) repeat-y;
    z-index:2;
}

.menu {
    width:80px;
    height:100px;
    position:relative;
    }
    ul#nav {
        list-style: none inside;
        }
        ul#nav li {
            display: inline;
            }
            ul#nav li a {
                display: block;
                height: 40px;
                float: left;
                }
                ul#nav li.front  a{
                    width:80px;
                    background: url(images/menu/p1.png) top center no-repeat;
                    }               
                    ul#nav li a:hover {
                        background-position: bottom center;
                    }
                ul#nav li.front2  a{
                    width:80px;
                    background: url(images/menu/p1.png) bottom center no-repeat;
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:30:33.223

你的 Sprite 显示得很好......
只是它在整体设置中不可见。尝试将 height: 80px 添加到您的“ul#nav li.front a”选择器中，您将看到哪里出错了。
从那里尝试自己。

提示：使用您的浏览器开发工具（我更喜欢 Chrome）并将鼠标悬停在每个元素上以查看它们占据的区域。在您的情况下，请检查“div menu”和“li a”元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:31:49.230

显示`background-image`正常，除了 spritemap ( `center top`) 的一部分是空的，并且它设置为`no-repeat`. 此外，您还没有重置列表，这使得子元素奇怪地偏移。

修订：

```
ul#nav { padding: 0; }

ul#nav li.front a {
      background: url("images/menu/p1.png") repeat-y center bottom transparent;
      width: 80px;
      height: 87px;
} 
```

这可能无法解决您的所有问题。从您的标记和 CSS 中看不出您想要实现的目标。锚标签的绝对定位可能会更好……或者只是进行一些清理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:33:05.437

应该这样做 - 没有针对您想要样式的框的规则。而且，如果您不想要跨越两者之间间隙的单个红色图像，则需要删除“ul#nav li.front a”选择器的规则。

```
.yellowBox
{
    float: left;
    margin-top: 107px;
    width: 80px;
    height: 100px;
    border: 1px solid yellow;
    background-image: url(images/menu/p1.png);
}

#box1
{
    margin-left: 50px;
}

#box2
{
    margin-left: 10px;
}

<div class="repeat">
    <div style="width:100%;">
        <div class='yellowBox' id='box1'>
            <div class="menu">
                <ul id="nav">
                    <li class="front"><a href="?p=front">Front</a></li>
                </ul>
            </div>
        </div>
        <div class='yellowBox' id='box2'></div>
        <div style="clear:both;"></div>
    </div>
</div> 
```

# c# - 通过对内置类型 .net 2.0 的反射调用运算符

> ID：12805017
> 
> 赞同：0
> 
> 时间：2012-10-09T17:12:38.887
> 
> 标签：c#, reflection, operators, clr

全部，

是否可以通过对 .net 2.0 中的内置类型的反射来调用运算符（例如 +、++）？看来，你不能！当我尝试访问 int32 上的 op_Increment 时，未定义运算符。我读到内置类型的运算符由编译器处理，并没有在实际类型上定义......请确认。

否则，有没有别的办法？我知道 C# 的更高版本有动态关键字，我有什么选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:19:06.297

不，你不能。例如，在内置类型（bool、byte、short、int、long、float、double）上，操作`+`和`++`映射到 IL 指令并且没有相应的`op_Increment`方法。

`decimal`确实允许你这样做，即使它看起来像一个内置类型。`string`是一个有趣的调用`+`被映射到`String.Concat`及其变体。

看看这篇[通用运算符](http://www.yoda.arachsys.com/csharp/genericoperators.html)文章，它可能会有所帮助（由 Jon Skeet 和 Marc Gravell 撰写）

# jquery - Jquery在正常和垂直之间更改文本

> ID：12805019
> 
> 赞同：0
> 
> 时间：2012-10-09T17:12:43.690
> 
> 标签：jquery, css

我正在创建一个自定义毕业偷配置器。在此配置器中，客户可以输入一行文本，例如“Class of 2004”。我需要一个按钮来更改两种格式之间的文本...

1.  标准方向就是：2004 级

2.  垂直方向，这将是：

C

l

一种

s

s

○

F

2

0

0

4

在两个方向之间来回交换的最佳方法是什么？我的想法是将原始方向保存在隐藏的 div 中的某个位置，以便我可以随时调用它，然后当他们单击垂直文本按钮时，将空格转换为“ ”，然后在每个字符之间

添加一个。
这听起来像是一种hacky方式，所以我试图弄清楚其他人会如何做到这一点。也需要它与 IE8+ 一起工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:17:57.843

一种方法是使用 jQuery 插件[lettering.js](http://letteringjs.com/)。这个插件将每个字母（或单词）包装在一个跨度中，并允许您通过单个单词或字母来操作文本......

所以，你可以这样做，只需使用 jquery 来切换 clear:both，或者每个字母上的一些类似的东西。

[这是一个jsfiddle示例](http://jsfiddle.net/hcBD9/)

# android - ViewPager + FragmentPagerAdapter + 每个选项卡多个片段

> ID：12805021
> 
> 赞同：2
> 
> 时间：2012-10-09T17:12:44.877
> 
> 标签：android, android-fragments, android-support-library

首先，我阅读了一些其他线程谈论这个，像这样： [Replace Fragment inside a ViewPager](https://stackoverflow.com/questions/7723964/replace-fragment-inside-a-viewpager/11974777#11974777)

我有一个自定义的 FragmentStackAdapter 来管理我的应用程序的所有片段，客户端的最终请求是显示所有应用程序中的选项卡，所以我决定实现 SherlockActionBar + tabs + viewpager（用于幻灯片）。

我有 FragmentStackAdapter 的下一个实现：

```
public class FragmentStackAdapter extends FragmentPagerAdapter {

/**
 * Logging tag
 */
private final static String TAG = "FragmentStackAdapter";

/**
 * Fragment Manager
 */
private FragmentManager fm;

/**
 * Container of this adapter
 */
private ViewPager pager;

/**
 * Current tab position (SET THIS in the TAB LISTENER)
 */
private Integer currentTabPosition;

/**
 * Array of stacks to get fragment stack list.
 */
private SparseArray<LinkedList<Fragment>> stackFragments = new SparseArray<LinkedList<Fragment>>();

/**
 * Default constructor
 * @param fm FragmentManager
 */
public FragmentStackAdapter(FragmentManager fm, ViewPager pager) {

    super(fm);
    this.fm = fm;
    this.pager = pager;
}

public void addRootFragmentAtPosition(int tabPos, Fragment rootFragment) {

    if (tabPos > stackFragments.size() - 1) {
        stackFragments.put(tabPos, new LinkedList<Fragment>());
    }

    LinkedList<Fragment> stack = stackFragments.get(tabPos);
    stack.add(0, rootFragment);

}

public Fragment getRootFragment(int tabPos) {

    return stackFragments.get(tabPos).get(0);

}

public void addFragment(Fragment f) {

    startUpdate(pager);

    Tools.logLine(TAG, "addFragment(): Fragment:" + f + ", in position: " + currentTabPosition);
    LinkedList<Fragment> stack = stackFragments.get(currentTabPosition);
    Fragment last = stack.getLast();
    stack.addLast(f);

    fm.beginTransaction()
        .setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN)
        .remove(last)
        .add(pager.getId(), f)
        .commit();

    finishUpdate(pager);
    notifyDataSetChanged();

}

/**
 * Goes back in the current selected tab.
 * @return true if it goes back, false if cannot cause the stack is in the last element. Util for handle super.onPressback().
 */
public boolean back() {

    LinkedList<Fragment> stack = stackFragments.get(currentTabPosition);

    if (stack.size() > 1) {

        startUpdate(pager);

        Fragment currentFragment = stack.getLast();
        stack.removeLast();
        fm.beginTransaction()
            .setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN)
            .remove(currentFragment)
            .add(pager.getId(), stack.getLast())
        .commit();

        notifyDataSetChanged();
        finishUpdate(pager);

        return true;

    }

    return false;
}

@Override
public int getCount() {
    return stackFragments.size();
}

@Override
public Fragment getItem(int pos) {

    LinkedList<Fragment> stack = stackFragments.get(pos);

    Fragment last = stack.getLast();

    Tools.logLine(TAG, "getItem() pos: " + pos + ", fragment:" + last.toString() + ", isV:" + last.isVisible() + ", isD:" + last.isDetached());
    return last;

}

@Override
public int getItemPosition(Object object) {

    int size = stackFragments.size();
    for (int i = 0 ; i < size ; i++) {

        int key = stackFragments.keyAt(i);
        LinkedList<Fragment> stack = stackFragments.get(key);

        if (stack.contains(object)) {

            int indexOf = stack.indexOf(object);

            // is root activity and is the current selected tab
            if (key == currentTabPosition && indexOf == 0) {

                return POSITION_NONE; // force reload this fragment

            } else if (indexOf == 0) { // if root and other, no changes

                return POSITION_UNCHANGED;

            }

            Tools.logLine(TAG, "getItemPos:, indexOf: " + indexOf + ", Object:" + object.toString());
            return indexOf; // return the pos of the activity

        }

    }

    Tools.logLine(TAG, "getItemPos: RETURN DEFAULTTTTT POSITION_NONE, " + object.toString()); 

    return POSITION_NONE; // the current item is not in the stack, so probabilly we removed it pressing back. Reload this tab will get another getItem and return the new corresponding item

}

@Override
public CharSequence getPageTitle(int position) {

    return "Near";

}

@Override
public long getItemId(int position) {

    LinkedList<Fragment> stack = stackFragments.get(position);
    Fragment f = stack.getLast();

    int rtnid = f.hashCode();

    Tools.logLine(TAG, "getItemId() for pos: " + position + ", Fragment: "+ f  +", rtnId: " + rtnid + ", hex: " + Integer.toString(rtnid, 16));

    return rtnid;

}

public void setCurrentTabPostion(int currentTabPosition) {
    this.currentTabPosition = currentTabPosition;
}
    } 
```

这就是我从 MainActivity 初始化的方式：

> // 分配 ui fieds viewPager = (ViewPager)findViewById(R.id.pager);

```
 // Configure the StackAdapter
    fragmentAdapter = new FragmentStackAdapter(getSupportFragmentManager(), viewPager);
    fragmentAdapter.addRootFragmentAtPosition(TIMELINE_TAG, new TimelineActivity());
    fragmentAdapter.addRootFragmentAtPosition(NEAR_TAG, new NearFragment()); 
```

我认为当我调用 fragmentAdapter.addFragment() 时它工作正常它在先前加载的片段中显示新片段，但是当我处理显示此堆栈跟踪的“back()”方法时它失败：

```
 did=1: thread exiting with uncaught exception (group=0x400205a0)
         FATAL EXCEPTION: main
         java.lang.IllegalStateException: The specified child already has a parent. You must call removeView() on the child's parent first.
            at android.view.ViewGroup.addViewInner(ViewGroup.java:2062)
            at android.view.ViewGroup.addView(ViewGroup.java:1957)
            at android.view.ViewGroup.addView(ViewGroup.java:1914)
            at android.view.ViewGroup.addView(ViewGroup.java:1894)
            at android.support.v4.app.NoSaveStateFrameLayout.wrap(NoSaveStateFrameLayout.java:40)
            at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:875)
            at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
            at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
            at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
            at android.support.v4.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:431)
            at com.bbva.tweetmeter.ui.FragmentStackAdapter.getItemPosition(FragmentStackAdapter.java:311)
            at android.support.v4.view.ViewPager.dataSetChanged(ViewPager.java:712)
            at android.support.v4.view.ViewPager$PagerObserver.onChanged(ViewPager.java:2519)
            at android.database.DataSetObservable.notifyChanged(DataSetObservable.java:31)
            at android.support.v4.view.PagerAdapter.notifyDataSetChanged(PagerAdapter.java:276)
            at com.bbva.tweetmeter.ui.FragmentStackAdapter.back(FragmentStackAdapter.java:154)
            at com.bbva.tweetmeter.ui.MainActivity.onBackPressed(MainActivity.java:210)
            at android.app.Activity.onKeyUp(Activity.java:1985)
            at android.view.KeyEvent.dispatch(KeyEvent.java:1513)
            at android.app.Activity.dispatchKeyEvent(Activity.java:2210)
            at com.actionbarsherlock.app.SherlockFragmentActivity.dispatchKeyEvent(SherlockFragmentActivity.java:122)
            at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1769)
            at android.view.ViewRoot.deliverKeyEventToViewHierarchy(ViewRoot.java:2716)
            at android.view.ViewRoot.handleFinishedEvent(ViewRoot.java:2688)
            at android.view.ViewRoot.handleMessage(ViewRoot.java:1969)
            at android.os.Handler.dispatchMessage(Handler.java:99)
            at android.os.Looper.loop(Looper.java:143)
            at android.app.ActivityThread.main(ActivityThread.java:4293)
            at java.lang.reflect.Method.invokeNative(Native Method)
            at java.lang.reflect.Method.invoke(Method.java:507)
            at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
            at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
            at dalvik.system.NativeStart.main(Native Method) 
```

如果我替换前一个片段为什么会显示此跟踪为什么附加了父级？有什么办法处理这个吗？

随意问我是否解释不正确

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T16:19:09.603

我使用的时候遇到了同样的问题

```
View res = inflater.inflate(R.layout.fragment_guide_search, container); 
```

在 Fragment.onCreateView(...

你必须打电话

```
View res = inflater.inflate(R.layout.fragment_guide_search, container, false); 
```

或者

```
View res = inflater.inflate(R.layout.fragment_guide_search, null); 
```

**请注意最后一个选项。**要了解究竟发生了什么，请阅读这篇精彩的文章： http: [//www.doubleencore.com/2013/05/layout-inflation-as-intended/](http://www.doubleencore.com/2013/05/layout-inflation-as-intended/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T06:28:53.457

这是片段的 onCreateView 实现的问题。我总是返回保存在实例变量中的相同视图，然后当片段重新附加时，它会再次调用 onCreateView 但返回相同的视图，因此该视图已经有一个父视图。正确的实现是重新创建其他视图，而不是在实例变量中保存前一个视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-17T06:27:15.953

我在使用 FragmentPagerAdapter 时遇到了同样的问题，如果您正在使用 FragmentPagerAdapter，那么只需在 FragmentPagerAdapter 中使用 destroyItem 方法。

```
@Override
public void destroyItem(ViewGroup container, int position, Object object) 
{
        FragmentTransaction ft=fm.beginTransaction();
        ft.remove((Fragment) object);
        ft.commit();
} 
```

setOffscreenPageLimit(int limit) 消耗更多内存，在某些情况下它不能完美运行。它在任一侧的保留状态见描述。**setOffscreenPageLimit(int limit) - 设置在空闲状态下应保留到视图层次结构中当前页面任一侧的页面数。**

# java - 本机操作系统的外观和感觉 Netbeans 不适用于 UIManager.setLookAndFeel(nativeLF);

> ID：12805022
> 
> 赞同：0
> 
> 时间：2012-10-09T17:12:46.243
> 
> 标签：java, windows, user-interface, look-and-feel, netbeans-7.1

我一直在浏览互联网（当然是 StackOverflow :) ）以解决以下问题。Netbeans 提供了“很棒”的默认外观和感觉，所以我想将其更改为原生外观。我的意思是，**正在运行的程序看起来并不等于设计的 GUI**。因此，当您在 Windows pc 上进行设计时，该程序看起来像 Windows，对于 Mac 等也是如此。

所以，我在这个网站上搜索，发现了很多次这样的示例代码：

```
private void setLookAndFeel() {
    // Get the native look and feel class name
    String nativeLF = UIManager.getSystemLookAndFeelClassName();
    try {
        UIManager.setLookAndFeel(nativeLF);
    } catch (ClassNotFoundException | InstantiationException | 
IllegalAccessException | UnsupportedLookAndFeelException ex) {
        Logger.getLogger(GUI.class.getName()).log(Level.SEVERE, null, ex);
    }
}

source: http://www.exampledepot.com/egs/javax.swing/LookFeelNative.html 
```

但是……它对我不起作用。

我会得到一个空指针异常，它很长（584 行）。

我希望有一个人可以帮助我。

提前致谢！

戴夫

*背景*信息： - Netbeans 7.1.2 - Windows 7 - 不会像这样工作：[http ://www.exampledepot.com/egs/javax.swing/LookFeelNative.html](http://www.exampledepot.com/egs/javax.swing/LookFeelNative.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:47:01.507

```
 UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); 
```

当它在 WINDOWS 中时，上面将给出窗口的外观和感觉。如果在 Linux 中，那么 Linux 的外观和感觉。使用它的最佳位置是在您的主要方法中，如下所示

```
 */
public class MyPhoneBookApp {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) 
    {
        try
        {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
            new MainForm();
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
    }
} 
```

如果您需要一个不会因操作系统而改变的外观，以及一些非常好的东西，请查看以下包含外观 Jars 的链接

[http://www.javootoo.com/](http://www.javootoo.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:17:34.937

**-** `AWT`具有**平台相关的外观和感觉**，但`Swing`没有。

**-**如果您在您的 GUI 中编写代码`AWT`，**无需**额外的努力，您的代码将具有`native look and feel.`

**-**您可以`setNativeLookAndFeel`在 Swing 程序中使用。

**请参阅此链接：**

[http://www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-LAF​​.html](http://www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-LAF.html)

# c# - 已安装 VS 2012 但未安装 .Net 4.5

> ID：12805025
> 
> 赞同：3
> 
> 时间：2012-10-09T17:12:59.643
> 
> 标签：c#, .net, visual-studio-2012

当我安装 VS 2012 时，会自动安装 .Net 4.5。我不想安装 4.5。是否可以在只有 .NET 4.0 的机器上运行 VS 2012？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:15:04.097

> 是否可以在只有 .NET 4.0 的机器上运行 VS 2012？

如果是这样的话，我会感到非常惊讶，因为 Visual Studio 的大部分都是用 .NET 编写的。我还没有检查过，但我完全希望他们引用 .NET 4.5 程序集并使用仅在 .NET 4.5 中可用的功能。

我建议您使用单独的虚拟机进行 .NET 4 测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T05:36:59.380

我将不得不卸载 VS 2012 和 Windows 8，因为 4.5 第一次取代了 4.0，而不是并行运行。我认为一旦安装 2012 或切换到 Windows 8，就不可能运行正版 4.0。安装 4.5 后，请自行检查 c:\windows\microsoft.net\framwork 文件夹。4.5 dll 替换 4.0。

可能需要长时间使用 Windows 7 和 .net 4.0，就像 IE 6.0 用于商业用途一样。

# android - Google Academy Android 谷歌地图自动完成示例

> ID：12805029
> 
> 赞同：0
> 
> 时间：2012-10-09T17:13:11.850
> 
> 标签：android, eclipse, google-maps, autocomplete, filter

正如标题所说，我正在尝试在我的应用程序中添加一个自动完成字段，以显示可能的地址，因为用户不断输入（如在谷歌地图上搜索）。好吧，我是新手。我在此页面 [https://developers.google.com/academy/apis/maps/places/autocomplete-android](https://developers.google.com/academy/apis/maps/places/autocomplete-android)上找到了如何执行此操作的示例。问题是在尝试在 Eclipse 中实现它之后，我得到了与过滤器相关的错误。我在导入区域和代码中都遇到错误。有没有人有这个例子的解决方法，并设法使它工作？？？

具体来说：

```
import android.widget.Filter.FilterResults; 

@Override

public Filter getFilter() {
        Filter filter = new Filter() {

@Override
             protected FilterResults performFiltering(CharSequence constraint) {
                FilterResults filterResults = new FilterResults();
                if (constraint != null) {
                    // Retrieve the autocomplete results.
                    resultList = autocomplete(constraint.toString());

                    // Assign the data to the FilterResults
                    filterResults.values = resultList;
                    filterResults.count = resultList.size();
                }
                return filterResults;
            }

  protected void publishResults(CharSequence constraint, FilterResults results) {
                if (results != null && results.count > 0) {
                    notifyDataSetChanged(); 
```

这段代码给了我错误。它们都与 Filter 和 FilterResults 有关

导入给了我一个错误“android.widget.Filter.FilterResults 类型不可见”，但在代码的后面我得到了一些不同的错误，例如 (1)Filter“返回类型与 ArrayAdapter.getFilter() 不兼容”。有任何想法吗？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:27:42.470

对于那些仍然被卡住的人，事情是要搭上这个进口：

```
import android.view.LayoutInflater.Filter; 
```

您必须改用这个：

```
import android.widget.Filter; 
```

# c# - 如何将文件从数据库保存到服务器

> ID：12805030
> 
> 赞同：0
> 
> 时间：2012-10-09T17:13:15.517
> 
> 标签：c#, asp.net-mvc

问题很简单，我理解有些毫无意义，但仍然......

当然，数据库在服务器上，我需要一个操作，当启动时从数据库中抓取该文件并将其保存到我的`AppSettings["Active"]`配置属性中的文件夹中。

基本上，

```
public ActionResult Activate(int id)
{
    Project project = db.Projects.Find(id);

    var activeProjectData = project.XML; // project.XML returns byte[] type
    //For download (not in this method of course) i'm using something like return File(activeProjectData, "text/xml"); and that works ok

} 
```

现在我想将该文件保存到`AppSettings["Active"]`路径。不知道该怎么做。我试过使用`System.IO.File.Create()`，但结果不太好。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:17:05.887

只需创建一个 FileStream 并使用它来写入数据：

```
string fileName = ConfigurationManager.AppSettings["Active"];
using(var fs = new FileStream(fileName, FileMode.Create, FileAccess.Write) )
{
    fs.Write(project.XML, 0, project.XML.Length);
} 
```

如果你不需要更多的控制，类上有一个[简单的辅助方法](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)`File`：

```
File.WriteAllBytes(fileName, project.XML); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:19:05.627

您需要使用 FileStream

```
SqlCommand ("select fileBin from SomeTable", connection);
byte[] buffer = (byte[]) command.ExecuteScalar ();
connection.Close();
FileStream fs = new FileStream(@"C:\filename.pdf", FileMode.Create);
fs.Write(buffer, 0, buffer.Length);
fs.Close(); 
```

# python - QIcon.fromTheme 在 PyQt 中不显示图标

> ID：12805036
> 
> 赞同：12
> 
> 时间：2012-10-09T17:13:37.037
> 
> 标签：python, pyqt, icons, pyqt4, qt-designer

我无法显示从当前图标主题中选择的 QAction 图标。我用 Qt 设计器制作了 ui 并用`pyuic4 sample.ui > sample.py`. 使用 设置主题中的图标后`self.actionSample.setIcon(QtGui.QIcon.fromTheme(_fromUtf8("document-open")))`，我得到以下源代码：

```
from PyQt4 import QtCore, QtGui
import sys

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName(_fromUtf8("MainWindow"))
        MainWindow.resize(800, 600)
        self.centralwidget = QtGui.QWidget(MainWindow)
        self.centralwidget.setObjectName(_fromUtf8("centralwidget"))
        MainWindow.setCentralWidget(self.centralwidget)
        self.statusbar = QtGui.QStatusBar(MainWindow)
        self.statusbar.setObjectName(_fromUtf8("statusbar"))
        MainWindow.setStatusBar(self.statusbar)
        self.toolBar = QtGui.QToolBar(MainWindow)
        self.toolBar.setObjectName(_fromUtf8("toolBar"))
        MainWindow.addToolBar(QtCore.Qt.TopToolBarArea, self.toolBar)
        self.actionSample = QtGui.QAction(MainWindow)
        self.actionSample.setObjectName(_fromUtf8("actionSample"))
        self.actionSample.setIcon(QtGui.QIcon.fromTheme(_fromUtf8("document-open")))
        self.toolBar.addAction(self.actionSample)

        QtCore.QMetaObject.connectSlotsByName(MainWindow)

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    window = QtGui.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(window)
    window.show()
    app.exec_() 
```

当我执行它时，工具栏不显示“文档打开”图标。这是一个错误还是我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-10T18:21:13.823

使用的图标查找过程`QIcon.fromTheme`有些复杂。

图标主题仅在 X11 平台上直接支持 GNOME 和 KDE 桌面环境。对于其他平台/桌面，有必要与应用程序一起安装主题，或者以各种方式调整用户的环境。

要查找 GNOME 的当前系统主题，Qt 将查询 gconf（如果 gtk 样式可用），否则默认为“gnome”主题。对于 KDE，Qt 将检查`kdeglobals`设置文件，否则默认为“oxygen”（或 KDE 早期版本的“crystalsvg”）。此外，“hicolor”主题始终可以用作后备。

一旦确定了系统主题名称，Qt 将在各种预先确定的位置查找包含图标的目录，这又取决于所使用的平台和桌面。在 X11 上，这包括`$HOME/.icons`和`$XDG_DATA_DIRS/icons`。所有平台/桌面通用的唯一位置是资源路径`:/icons`。

图标主题目录必须包含一个`index.theme`文件，该文件（除其他外）指定可以包含图标的子目录。仅使用带有`png`或`svg`扩展名的图标文件。

该类`QIcon`有一些静态方法，可以准确显示 Qt 在哪里寻找主题图标：

```
>>> from PyQt4 import QtGui
>>> app = QtGui.QApplication([])
>>> for path in QtGui.QIcon.themeSearchPaths():
...     print "%s/%s" % (path, QtGui.QIcon.themeName())
... 
/home/ekhumoro/.icons/hicolor
/usr/local/share/icons/hicolor
/usr/share/icons/hicolor
:/icons/hicolor 
```

如果“文档打开”图标没有显示，Qt 要么在“错误”的地方寻找，要么图标完全丢失。

**更新：**

正如我上面所说：默认情况下，Qt 在 X11 平台上只支持 GNOME 和 KDE。它对 FluxBox WM 一无所知，因此无法检测到当前的图标主题。这意味着它将回退到使用最小的“hicolor”主题，它可能没有所有必需的图标。

解决此问题的一种方法是创建一个指向您要使用的主题的“hicolor”符号链接。理想情况下，这应该位于 Qt 搜索路径列表中的第一个位置：

```
$ ln -s icon/theme/directory $HOME/.icons/hicolor 
```

**更新 2**：

Qt5 在默认情况下仍然只支持 kde 和 gnome，但[Qt 平台抽象层](http://doc.qt.io/qt-5/qpa.html)至少可以创建自定义主题插件（[LXQT](http://lxqt.org/)是一种利用这一点的桌面环境）。还有几个 DE 现在被视为 gtk/gnome：X-CINNAMON、UNITY、MATE、XFCE 和 LXDE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-19T21:32:34.573

前提是`self`指向一些东西`QWidget`- 比如你可以使用这个丑陋的黑客：

```
openIcon = self.style().standardIcon(QStyle.StandardPixmap.SP_FileDialogStart)
openAction(openIcon, 'Open', self) 
```

或者，您也可以`.style()`在`QApplication`实例上访问，即`icon = app.style().standardIcon(...)`.

# android - 如何为服务设置计时器？

> ID：12805038
> 
> 赞同：0
> 
> 时间：2012-10-09T17:13:38.217
> 
> 标签：android, service, timer

在我的应用程序中，当我打开我的应用程序（通过 onCreate 方法）时，我有一个服务运行，它只显示一个简单的通知，所以我希望服务每 60 秒关闭并重新打开`( stopService > startService )`一次，这是由计时器设置的。我如何设置计时器来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:44:37.993

请查看并使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)

> 使用 AlarmManager，您将能够允许服务在固定时间启动，也可以使用 setrepeating alarm 安排警报在一定时间后响起，然后根据需要不断重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:55:57.887

使用`AlarmManager`每分钟被戳。然后在您`BroadcastReceiver`的`onReceive()`poke 服务中通过即`startService()`有特殊意图来完成这项工作。

# android - 如何在gridlayout中显示二维数组

> ID：12805040
> 
> 赞同：1
> 
> 时间：2012-10-09T17:13:50.087
> 
> 标签：android, android-gridlayout

我有`Array [] [] myArray = new Array [5] [5]`, 或`Array [] [] myArray = new Array [7] [9]`, 或`new Array [12] [13]`

我想在`GridLayout`. 我发现了很多例子，但没有二维数组。

告诉我我应该延长`BaseAdapter`吗？我不知道如何解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:24:15.713

您可以做的简单事情是，您可以将 2D 数组转换为简单的 1D 数组（使用 for 循环）并照常进行。如果您需要动态设置项目（我的意思是，如果您事先不知道数组的尺寸），那么您可以使用 setColumnCount() 来设置您需要的列数（5,9,13 in你的例子）。您不必担心行数，因为 Android 会处理行数。是的，您应该使用 BaseAdapter。

# c++ - C++ 等价于 Java 的 BlockingQueue

> ID：12805041
> 
> 赞同：45
> 
> 时间：2012-10-09T17:13:50.960
> 
> 标签：c++, multithreading

我正在将一些 Java 代码移植到 C++ 中，其中一个特定部分使用 BlockingQueue 将消息从许多生产者传递给单个消费者。

如果您不熟悉 Java BlockingQueue 是什么，它只是一个具有硬容量的队列，它向队列中的 put() 和 take() 公开线程安全方法。如果队列已满，put() 阻塞，如果队列为空，则 take() 阻塞。此外，还提供了这些方法的超时敏感版本。

超时与我的用例相关，因此提供这些的建议是理想的。如果没有，我可以自己编写一些代码。

我用谷歌搜索并快速浏览了 Boost 库，但没有找到类似的东西。也许我在这里是盲人......但有人知道一个好的推荐吗？

谢谢！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-10-09T17:56:40.910

它不是固定大小，也不支持超时，但这是我最近使用 C++ 2011 构造发布的队列的简单实现：

```
#include <mutex>
#include <condition_variable>
#include <deque>

template <typename T>
class queue
{
private:
    std::mutex              d_mutex;
    std::condition_variable d_condition;
    std::deque<T>           d_queue;
public:
    void push(T const& value) {
        {
            std::unique_lock<std::mutex> lock(this->d_mutex);
            d_queue.push_front(value);
        }
        this->d_condition.notify_one();
    }
    T pop() {
        std::unique_lock<std::mutex> lock(this->d_mutex);
        this->d_condition.wait(lock, [=]{ return !this->d_queue.empty(); });
        T rc(std::move(this->d_queue.back()));
        this->d_queue.pop_back();
        return rc;
    }
}; 
```

扩展和使用定时等待弹出应该是微不足道的。我没有这样做的主要原因是我对到目前为止所想到的界面选择不满意。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-09-01T12:27:01.353

[这是具有关闭请求](https://github.com/srogatch/TextMatching/blob/master/TextMatching/MatchText/BlockingQueue.h)功能的阻塞队列的示例：

```
template <typename T> class BlockingQueue {
  std::condition_variable _cvCanPop;
  std::mutex _sync;
  std::queue<T> _qu;
  bool _bShutdown = false;

public:
  void Push(const T& item)
  {
    {
      std::unique_lock<std::mutex> lock(_sync);
      _qu.push(item);
    }
    _cvCanPop.notify_one();
  }

  void RequestShutdown() {
    {
      std::unique_lock<std::mutex> lock(_sync);
      _bShutdown = true;
    }
    _cvCanPop.notify_all();
  }

  bool Pop(T &item) {
    std::unique_lock<std::mutex> lock(_sync);
    for (;;) {
      if (_qu.empty()) {
        if (_bShutdown) {
          return false;
        }
      }
      else {
        break;
      }
      _cvCanPop.wait(lock);
    }
    item = std::move(_qu.front());
    _qu.pop();
    return true;
  }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-28T07:15:18.207

你应该先写信号量的类

```
#ifndef SEMEPHORE_H
#define SEMEPHORE_H
#include <mutex>
#include <condition_variable>

class semephore {
public:
    semephore(int count = 0)
        : count(count),
          m(),
          cv()
    {

    }

    void await() {
        std::unique_lock<std::mutex> lk(m);
        --count;
        if (count < 0) {
            cv.wait(lk);
        }
    }

    void post() {
        std::unique_lock<std::mutex> lk(m);
        ++count;
        if (count <= 0) {
            cv.notify_all();
        }
    }

private:
    int count;
    std::mutex m;
    std::condition_variable cv;
};

#endif // SEMEPHORE_H 
```

现在blocked_queue可以使用信号量来处理它

```
#ifndef BLOCKED_QUEUE_H
#define BLOCKED_QUEUE_H
#include <list>
#include "semephore.h"

template <typename T>
class blocked_queue {
public:
    blocked_queue(int count) 
        : s_products(),
          s_free_space(count),
          li()
    {

    }

    void put(const T &t) {
        s_free_space.await();
        li.push_back(t);
        s_products.post();
    }

    T take() {
        s_products.await();
        T res = li.front();
        li.pop_front();
        s_free_space.post();
        return res;
    }
private:
    semephore s_products;
    semephore s_free_space;
    std::list<T> li;
};

#endif // BLOCKED_QUEUE_H 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-27T21:39:39.887

好的，我参加聚会有点晚了，但我认为这更适合 Java 的`BlockingQueue`实现。在这里我也使用一个互斥锁和两个条件来照顾不满不空。IMO a`BlockingQueue`在容量有限的情况下更有意义，我在其他答案中没有看到。我也包括一个简单的测试场景：

```
#include <iostream>
#include <algorithm>
#include <queue>
#include <mutex>
#include <thread>
#include <condition_variable>

template<typename T>
class blocking_queue {
private:
    size_t _capacity;
    std::queue<T> _queue;
    std::mutex _mutex;
    std::condition_variable _not_full;
    std::condition_variable _not_empty;

public:
    inline blocking_queue(size_t capacity) : _capacity(capacity) {
        // empty
    }

    inline size_t size() const {
        std::unique_lock<std::mutex> lock(_mutex);
        return _queue.size();
    }

    inline bool empty() const {
        std::unique_lock<std::mutex> lock(_mutex);
        return _queue.empty();
    }

    inline void push(const T& elem) {
        {
            std::unique_lock<std::mutex> lock(_mutex);

            // wait while the queue is full
            while (_queue.size() >= _capacity) {
                _not_full.wait(lock);
            }
            std::cout << "pushing element " << elem << std::endl;
            _queue.push(elem);
        }
        _not_empty.notify_all();
    }

    inline void pop() {
        {
            std::unique_lock<std::mutex> lock(_mutex);

            // wait while the queue is empty
            while (_queue.size() == 0) {
                _not_empty.wait(lock);
            }
            std::cout << "popping element " << _queue.front() << std::endl;
            _queue.pop();
        }
        _not_full.notify_one();
    }

    inline const T& front() {
        std::unique_lock<std::mutex> lock(_mutex);

        // wait while the queue is empty
        while (_queue.size() == 0) {
            _not_empty.wait(lock);
        }
        return _queue.front();
    }
};

int main() {
    blocking_queue<int> queue(5);

    // create producers
    std::vector<std::thread> producers;
    for (int i = 0; i < 10; i++) {
        producers.push_back(std::thread([&queue, i]() {
            queue.push(i);
            // produces too fast
            std::this_thread::sleep_for(std::chrono::milliseconds(100));
        }));
    }

    // create consumers
    std::vector<std::thread> consumers;
    for (int i = 0; i < 10; i++) {
        producers.push_back(std::thread([&queue, i]() {
            queue.pop();
            // consumes too slowly
            std::this_thread::sleep_for(std::chrono::milliseconds(1000));
        }));
    }

    std::for_each(producers.begin(), producers.end(), [](std::thread &thread) {
        thread.join();
    });

    std::for_each(consumers.begin(), consumers.end(), [](std::thread &thread) {
        thread.join();
    });

    return EXIT_SUCCESS;
} 
```

# python-3.x - Python 控制台：ImportError PyUnicodeUCS4_FromString

> ID：12805044
> 
> 赞同：1
> 
> 时间：2012-10-09T17:14:05.170
> 
> 标签：python-3.x, importerror, undefined-symbol

谁能帮我弄清楚发生了什么以及如何解决这个错误？

当我尝试导入之前编译的模块时，会出现以下消息：

```
Python 3.1.4 (default, Mar  8 2012, 09:13:26)
[GCC 4.3.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import pypt
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: /usr/local/lib/python3.1/site-packages/pypt.so: undefined symbol: PyUnicodeUCS4_FromString 
```

# jquery - 在jquery mobile中动态更改li的内容

> ID：12805048
> 
> 赞同：0
> 
> 时间：2012-10-09T17:14:29.260
> 
> 标签：jquery, jquery-mobile

试图建立一个 ajax 评论系统。我有一个从 MYSQL 数据库填充的列表。并且显示该列表工作正常。但是当用户添加他的评论时，整个数据库都会附加到我已经打印的列表中。是否有另一种方法可以先清空列表？因为追加只会追加到已经创建的列表。我想先清除列表，然后再添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:20:16.477

利用`.empty()`

```
selector.empty().append(data); 
```

而不仅仅是

```
selector.append(data); 
```

# ios - 从通知中心删除通知重新访问

> ID：12805050
> 
> 赞同：1
> 
> 时间：2012-10-09T17:14:32.977
> 
> 标签：ios

之前关于从通知中心删除通知的帖子声称无法删除单个通知，只能删除所有通知。

但是，提醒应用程序确实会删除个别通知 - 设置 3 个提醒在几分钟内触发，当它们触发时转到通知中心，现在选择一个，在提醒应用程序启动后返回通知中心和该特定通知已被删除，但其他人仍然存在。那么这是如何实现的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:11:26.777

提醒应用程序可能会触发本地通知。可以使用`cancelLocalNotification:`on撤销本地通知`UIApplication`。

（此外，使用增强调用（第一个字节为 1）发送的推送通知支持到期参数（发送时，不在 JSON 有效负载内），这应该意味着如果未在某个日期之前发送此通知，则不应有可能该参数也以类似的方式用于隐藏收到的通知。

苹果自己的应用程序也很有可能随心所欲。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T04:20:24.407

当用户点击通知时：

*   如果应用程序在后台运行，您可以使用 AppDelegate 的方法 didReceiveLocalNotification 检索它。
*   如果它没有运行，则可以使用 didFinishLaunchingWithOptions 方法获取通知。您只需要在 launchOptions 字典中搜索 UIApplicationLaunchOptionsLocalNotificationKey。

如果你想删除已经触发的特定通知，特别是当用户没有通过点击通知进入应用程序时，那么最好将它们存储在 NSUserDefaults 中，以便以后仍然可以获取它们。[此处](https://stackoverflow.com/a/32389835/2829102)解释了该方法。

# r - 从 R 中的 4 暗矩阵创建频率矩阵

> ID：12805054
> 
> 赞同：0
> 
> 时间：2012-10-09T17:14:54.300
> 
> 标签：r

我有一个 k*4 维度的矩阵，每一行是`(1:20,1:20,1:20,1:20)`quadruplet node 的组合和指定类型之一。例如，对于`k=3`我有 3 个四面体，这种类型的节点在这里

```
X <- matrix(c(1,  3, 1 ,4,
              2,  5, 6 ,1,
              12,20,15 ,3),   3,4,byrow=T) 
```

现在我想从中创建一个暗淡 20*8000 的频率表，记录每个节点与其余三个节点接触的频率。另一方面，我想知道四联体中的每个节点都与哪种类型的节点接触。

例如，对于第一行，我在 F 的 1,(1,3,4)th 以及 3,(1,1,4) 和 4,(1,1,3) 中都有一个。

我希望我能很好地解释我的问题。请帮助我完成此转换的代码

注意：由于我的 X 矩阵的第一行是 1、3、1、4，输出矩阵（F）应该在

```
F[1,which(colnames(F)=="1 3 4") <- F[1,which(colnames(F)=="1 3 4") +1
F[1,which(colnames(F)=="1 3 4") <- F[1,which(colnames(F)=="1 3 4") +1
F[3,which(colnames(F)=="1 1 4") <- F[3,which(colnames(F)=="1 1 4") +1
F[4,which(colnames(F)=="1 1 3") <- F[4,which(colnames(F)=="1 1 3")+1 
```

这意味着每行将 4 个 1 添加到它的第 4 行中的频率矩阵中，并且它的 2,3 或 4 可能相同。例如因为一个在第一行重复，添加两条记录到 F[1,which(colnames(F)=="1 3 4")

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T22:56:52.283

我不确定我是否理解，如果我理解了，那么您没有正确执行此操作，因为您没有正确订购三胞胎，所以这是一个猜测。我在想向量 c(3,1,4) 应该不同于向量 c(1,3,4)。如果我错了，请纠正我。

我认为尝试使用 20^4 数组是相当过分的，所以我构建了一个适合 5^4 数组的输入矩阵：

```
X <- matrix(c(1,  3, 1 ,4,
              2,  5, 2 ,1,
              3,  2, 5 ,4),   3,4, byrow=T) 
```

我们从每行生成 4 个项目的组合，一次取 3 个，并以列主要方式排列：

```
 array(  apply( X, 1, function(x) combn(x, 3) ), dim=c(3,4,3) )
, , 1

     [,1] [,2] [,3] [,4]
[1,]    1    1    1    3
[2,]    3    3    1    1
[3,]    1    4    4    4

, , 2

     [,1] [,2] [,3] [,4]
[1,]    2    2    2    5
[2,]    5    5    2    2
[3,]    2    1    1    1

, , 3

     [,1] [,2] [,3] [,4]
[1,]    3    3    3    2
[2,]    2    2    5    5
[3,]    5    4    4    4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T13:52:27.663

我找到了我的问题的基本答案。但我认为它并不像它应该的那样快。

例如，我有一个暗淡 (3*4) 的矩阵，为简单起见，我想我只有 5 种类型。所以为了找到这种情况的频率表，我写了下面的代码：

```
 n <- 5
    k <- dim(X)[1]
    F <- matrix(0,n,n^3)
    colnames(F) <- simplify2array(apply(expand.grid(1:n,1:n,1:n ), 1, paste, collapse =" ", sep = ""))
    for(i in 1:k)
    {
for(j in 1:4){
per <- simplify2array(permn(X[i,-j]))
pert_charac <- apply(per,2,paste,sep="",collapse=" ")
num <- sapply(pert_charac,f <- function(x) which(colnames(F)==x))
F[X[i,j],num] <- F[X[i,j],num]+1
    }
 } 
```

# java - 缺少“导出为可运行 JAR”选项

> ID：12805059
> 
> 赞同：2
> 
> 时间：2012-10-09T17:15:04.143
> 
> 标签：java, eclipse

从字面上看，按钮不见了。我右键单击我的项目 -> 导出 -> ...这里只有 JAR 文件和 Javadoc。

我做错什么了？

编辑：我正在使用的程序是 Eclipse。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:45:29.837

使用最新版本的 Eclipse。Export as Runnable Jar 出现在 3.4 或 3.5 左右。

# facebook - Blogger 的 Facebook 开放图形标签

> ID：12805062
> 
> 赞同：0
> 
> 时间：2012-10-09T17:15:22.103
> 
> 标签：facebook, facebook-opengraph, blogger

几个月来我一直在努力解决这些问题。

我刚刚更改了它们，Facebook 调试器认为一切都很好，除了管理员和应用程序 ID，我希望我不必进入。

但是，当单击“赞”按钮时，有些帖子会显示我的通用网站图标，有些帖子会显示旧帖子的图像，有些则根本不显示图像，而极少数会显示帖子中的图像。

其中一些显示了博客文章的正确标题，一些显示了链接，有些什么也不显示。

我希望帖子中的一小段文字会显示出来，但这永远不会发生。

这一切似乎完全是随机的。这是我的[网站](http://speechnotrecognised.blogspot.com/)代码：

```
<!-- BEGIN Open Graph tags -->
<meta expr:content='data:blog.metaDescription' name='description' property='og:description'/>
<meta expr:content='data:blog.pageTitle' name='keywords'/>
<b:if cond='data:blog.pageType == &quot;item&quot;'>
<meta content=blog' property='og:type'/>
<meta content='http://speechnotrecognised.blogspot.com.au/2012/08/our-second-first-post_28.html' property='article:author'/>
<meta expr:content='data:blog.url' property='og:url'/>
<meta expr:content='data:blog.pageName' property='og:title'/>
<b:if cond='data:blog.postImageThumbnailUrl'>
<meta expr:content='data:blog.postImageThumbnailUrl' property='og:image'/>
<b:else/>
<meta content='http://i1252.photobucket.com/albums/hh569/speechnotrecognised/snricon4_zpsde4bdf38.jpg' property='og:image'/>
</b:if>
<b:else/>
<meta expr:content='data:blog.title' property='og:title'/>
<meta expr:content='data:blog.homepageUrl' property='og:url'/>
<meta content='blog' property='og:type'/>
<meta content='http://i1252.photobucket.com/albums/hh569/speechnotrecognised/snricon4_zpsde4bdf38.jpg' property='og:image'/>
</b:if>
<meta expr:content='&quot;en_US&quot;' property='og:locale'/>
<!-- END Open Graph tags --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:12:04.460

我发现您的代码存在几个问题： - 您正在使用博客标题生成关键字？！- 对于个人博客文章 og：类型应该是“文章”而不是“博客”；- 我不认为你可以使用文章的 URL：作者；- 您没有指定您的 Facebook 管理员 ID 或应用 ID；- 您应该使用规范 URL 而不是 data:blog.homepageUrl 来解决博主的国家/地区重定向问题。

这是我的解决方案：[为 Blogger 开放图形标记 [版本 3]](http://exde601e.blogspot.ro/2012/10/open-graph-markup-for-blogger-version-3.html)

# delphi - 使用“HNetCfg.NATUPnP”Ole 对象进行端口转发失败

> ID：12805067
> 
> 赞同：2
> 
> 时间：2012-10-09T17:15:45.360
> 
> 标签：delphi, port, ole, forwarding

我正在使用代码转发端口。此代码在我的 Windows 7 上运行良好；但我不能在 Windows XP 上使用它。

**问题更新 1(2012-10-17 07:32:00Z)**

这是我的源代码：

```
uses
  ActiveX, oleAuto;

Procedure AddUPnPEntry(Port: Integer; const Name: ShortString; LAN_IP: string);
Var
  Nat: Variant;
  Ports: Variant;
  SavedCW: Word;
Begin
  if NOT(LAN_IP = '127.0.0.1') then
  begin
    try
      Nat := CreateOleObject('HNetCfg.NATUPnP');
      Ports := Nat.StaticPortMappingCollection;

      // Error Raized From Here!!!
      ShowMessage(inttostr(Ports.count));

      Ports.Add(Port, 'TCP', Port, LAN_IP, True, name);
    except
      ShowMessage('An Error occured with adding UPnP Ports. The ' + name +
        ' port was not added to the router. Please check to see if  your ' +
        'router supports UPnP and has it enabled or disable UPnP.');
    end;
  end;
End;

procedure TForm1.Button2Click(Sender: TObject);
begin
  AddUPnPEntry(1234, 'Hello3', '192.168.1.1');
end; 
```

AV 错误信息：

```
Project Project1.exe raised exception class $C0000005 with message 'access violation at 0x00504876: read of address 0x00000000'. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-09T18:29:56.737

如果您遇到访问冲突，当您访问 count 属性时，这意味着该方法[`IStaticPortMappingCollection`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366147%28v=vs.85%29.aspx)返回的接口是哪个，这可能是由于您的设备不支持 UPnP 的多种原因，设备上未启用 UPnP， UPnP 用户界面未安装/未激活，等等。[`IUPnPNAT.get_StaticPortMappingCollection`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366184%28v=vs.85%29.aspx)`nil`

无论如何，为了防止这种异常（访问冲突），您必须在使用它之前检查属性或方法返回的值，在这种情况下，您可以[`VarIsClear`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.Variants.VarIsClear)像这样使用函数：

```
try
  Nat := CreateOleObject('HNetCfg.NATUPnP');
  Ports := Nat.StaticPortMappingCollection;

  if not VarIsClear(Ports) then
  begin
    //do something
    ShowMessage(inttostr(Ports.count));
    Ports.Add(Port, 'TCP', Port, LAN_IP, True, name);
  end;

except on E:Exception do
  ShowMessage('An Error occured with adding UPnP Ports. '+E.Message);
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-01T16:00:05.617

对于任何看到这一点的人来说，UPnP 功能对于 XP 来说是不同的，这是我使用的：

```
TWindowsName = ( WINXP, WINVISTA, WIN7, WIN80, WIN81 );

var
  fWindowsName : TWindowsName;

procedure InitializeWindowsName;
var
  WinVersion  : TOSVersionInfo;

begin

  WinVersion.dwOSVersionInfoSize := sizeof ( WinVersion );
  GetVersionEx ( WinVersion );

  if WinVersion.dwMajorVersion = 5 then
    fWindowsName := WINXP    
  else if WinVersion.dwMajorVersion = 6 then
    fWindowsName := TWindowsName ( WinVersion.dwMinorVersion + 1 );

end;

procedure AddPortThroughUPnP ( const APort: WORD; const AProtocol, ALocalIP, AName: String );
var
  NAT      : Variant;
  Profile  : Variant;
  Ports    : Variant;
  Protocol : Integer;

begin

  if not fEnableUPnP then exit;

  if fWindowsName = WINXP then
  begin

    NAT      := CreateOleObject ( 'HNetCfg.FwMgr' );
    Profile  := NAT.LocalPolicy.CurrentProfile;

    if not VarIsClear ( Profile ) then
    begin

      if AProtocol = 'UDP' then Protocol := 17
      else if AProtocol = 'TCP' then Protocol := 35; 

      Ports          := CreateOLEObject('HNetCfg.FWOpenPort');
      Ports.Name     := AName;
      Ports.Port     := APort;
      Ports.Scope    := 0;
      Ports.Protocol := Protocol;
      Ports.Enabled  := True;

      Profile.GloballyOpenPorts.Add ( Ports );

    end;

  end
  else
  begin

    NAT   := CreateOleObject ( 'HNetCfg.NATUPnP' );
    Ports := NAT.StaticPortMappingCollection;

    if not VarIsClear ( Ports ) then
       Ports.Add ( APort, AProtocol, APort, ALocalIP, True, AName );

  end;

end; 
```

可以跳过windows名称的初始化，而是使用自己的校验算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T17:00:17.897

使用此代码测试您的显示消息

Showmessage(VarToStrDef(Ports.Count,'nothing');

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-10T13:33:11.573

如果你没有解决问题，这里是答案：

删除“Showmessage ...”，因为当您在路由器上没有任何记录时，您会遇到错误。我测试过，它有效。

# html - 如何将按钮移动到第一个文本列的中间？

> ID：12805069
> 
> 赞同：1
> 
> 时间：2012-10-09T17:15:45.703
> 
> 标签：html, css

我想移动 facebook 和 twitter 按钮，让它们在我的临时网站上更明显：

[gaberivers.com](http://gaberivers.com/)

现在它们位于页脚下方，没有人可以看到它们。我想将它移到第一个文本列旁边。在那个文本框之外......这样人们会更好地看到它。

演示：

[http://jsfiddle.net/ZWq8g/](http://jsfiddle.net/ZWq8g/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:07:20.833

好的，如果我理解正确，您是在尝试将 Facebook 和 Twitter 图像移到列的左侧。因此，让我们创建一个新列，`columnSocial`在 CSS 中调用和：

```
#columnSocial {
line-height:120px;
background-color:#394046;/*background: url(black.jpg) no-repeat 0 0;*/
width:64px;
height:250px;
float:left;
position:relative;} 
```

我从您现有的列中复制了大部分内容 - 请务必向下编辑其他列之一的宽度以容纳（您的列容器仅允许 900 像素，因此您需要在其他地方剃掉 36 像素）这个新列。该`line-height`属性对于获得一些垂直间距很有用，因为我们不能`vertical-align`在 div 元素上使用。

在您的 HTML 中，您需要添加：

```
<div id="columnSocial">
     ...
</div> 
```

在您的容器开始之后和 column1 开始之前。随意切换任何你喜欢的数字，但这应该得到类似于你所要求的东西。

作为一般的设计说明，拥有良好的结构（如列的容器）需要大量的工作来完成这样的更改——移动图像最终变得微不足道，因为我们所要做的就是制作一个新的柱子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:00:00.223

这是您需要的：-您的页脚应该像

```
<div id="footer" style="text-align: center;">
<p>&copy; 2012 Angloesfera. Todos los derechos reservados.</p>
<div id="snetworks">
        <a class="show" href="https://www.facebook.com/pages/Academ%C3%ADa-AngloEsfera/190496871000029"> <!--a http-vel kell a link...vagy          kulonben az en oldalamon belul fogja keresni a linket-->
        <img width="36" height="36" rel="" title="" alt="facebook" src="images/facebook.png"></a>

        <a class="show" href="https://twitter.com/GoE_Shop">
        <img width="36" height="36" rel="" title="" alt="facebook" src="images/twitter.png"></a>
</div>
</div> 
```

和 #snetworks 的 css

```
#snetworks {
    left: 100px;
    position: absolute;
    top: 2px;
} 
```

# ruby-on-rails - respond_with - 如何用文本回复

> ID：12805071
> 
> 赞同：6
> 
> 时间：2012-10-09T17:15:55.343
> 
> 标签：ruby-on-rails

我在rails应用程序中使用respond_to和respond_with，但在一个用例中，我只需要响应其中一种资源格式（：json）的文本......但我找不到如何做到这一点...

我想要这样的东西（我知道这行不通）

```
def create
    ...
    respond_with(:json, render :text => "Successfully Done!")
end 
```

任何想法？？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-09T17:42:25.987

看来这可能是您正在寻找的：

```
def create
  respond_to do |format|
    format.html
    format.json { render :text => "Successfully Done!" }
  end
end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-09T17:30:59.290

安德烈斯，

解决方案是这样的：

```
class TextController < ApplicationController
  respond_to :json, :text

  def index
    respond_with do |format|
      format.json {
        render :text => "I'm a text provided by json format"
      }
      format.text {
        render :text => "I'm a text"
      }
    end
  end
end 
```

在您的 routes.rb 中：

```
match '/text' => 'text#index', defaults: { format: 'text' } 
```

# python - 让 django 使用 wsgi 在 apache 上工作的问题。获取内部服务器错误页面

> ID：12805072
> 
> 赞同：1
> 
> 时间：2012-10-09T17:15:56.117
> 
> 标签：python, django, installation, mod-wsgi, wsgi

Django 和 wsgi 都已安装，但在浏览路径时出现内部服务器错误页面。

我在 django 上创建了一个名为 hello 的项目。

> /网站可用/你好

```
ServerName hello.djangoserver
DocumentRoot /srv/www/hello

<Directory /srv/www/hello>
    Order allow,deny
    Allow from all
</Directory>

WSGIDaemonProcess hello.djangoserver processes=2 threads=15 display-name=%{GROUP}
WSGIProcessGroup hello.djangoserver

WSGIScriptAlias / /srv/www/hello/apache/django.wsgi 
```

/srv/www/hello/apache/apche.wsgi

```
import os
import sys
path = '/srv/www'
if path not in sys.path:
    sys.path.insert(0, '/srv/www')

os.environ['DJANGO_SETTINGS_MODULE'] = 'hello.settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

当我在浏览器中打开它时，我没有遇到什么问题。

# c# - 如何手动计算已使用的内存

> ID：12805073
> 
> 赞同：-2
> 
> 时间：2012-10-09T17:15:59.940
> 
> 标签：c#, memory-management

有什么方法可以手动计算数组将要消耗的内存。

我在 64 位操作系统中使用 languaje C#

假设我有下一个数组：

```
int number[][]= new int[2][2];
number[0][0]=25;
number[0][1]=60;
....
... 
```

所以我的第一个问题是，数组的每个维度都有相同的位分配？可以说 number[0][0] 有一个 12 位的 asing（如果 12 位是正确的答案，我现在不知道）所以这将使第一行成为 24 位的内存 asing？

每个维度需要多少财政和虚拟内存？

如果我对数组使用 int、double 或 string，是否有任何不同的内存要使用？

最后，如果我使用 GC.GetTotalMemory，我会得到与数组使用的内存总量相同的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:22:49.323

您需要使用 sizeof 函数来获取分配给您的类型的字节数。

```
int number[][] = new int[2][];
for (int i = 0; i < number.Length; i++)
{
    number[i] = new int[2];
}

int size = sizeof(int) * number.Length * number[0].Length; 
```

# objective-c - 仅在特定设备上部署 iOS

> ID：12805074
> 
> 赞同：4
> 
> 时间：2012-10-09T17:16:00.980
> 
> 标签：objective-c, ios, cocos2d-iphone

我正在开发一款针对 iPhone 4/iPad 及更高版本的游戏……我的问题是，我可以“以某种方式”设置部署目标，使其无法在 3GS 或更旧的设备上运行吗？

我所有的纹理都是高清的（iPhone 4 分辨率），如果它在 3GS 上运行，所有的位置都会出错并且所有的图像都过大。

关于如何解决这个问题有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T17:23:07.437

需要 SDK 中的前置摄像头。3GS 将被排除在外。

[在此处](https://stackoverflow.com/questions/9760238/ios-front-camera-only-app)查看执行此操作的步骤。

# c# - Linq To SQL 选择动态列

> ID：12805075
> 
> 赞同：10
> 
> 时间：2012-10-09T17:16:02.983
> 
> 标签：c#, sql, linq

是否可以动态限制从 LINQ to SQL 查询返回的列数？

我有一个超过 50 列的数据库 SQL 视图。我的应用程序有一个具有 50 多个属性的域对象，每列一个。在我的 winforms 项目中，我将域对象列表绑定到网格。默认情况下，只有少数列是可见的，但是用户可以打开/关闭任何列。

用户抱怨网格加载时间过长。我捕获了 LINQ 生成的 SQL 查询，然后在 SQL Server Management Studio 中执行它并验证了它的缓慢性。如果我更改 SQL 语句，删除所有不可见的列，它几乎会立即运行。性能与查询中的列数直接相关。

我想知道是否可以动态更改从 LINQ 生成的 SQL 查询返回的列数？例如，这是我的代码当前的样子：

```
public List<Entity> GetEntities()
{
    using (var context = new CensusEntities())
    {
        return (from e in context.Entities
            select e).ToList();
    }
} 
```

context.Entities 对象是从包含超过 50 列的 SQL 视图生成的，因此当执行上述操作时，它会生成类似“SELECT Col1, Col2, Col3, ... Col50 FROM Entity INNER JOIN ...”的 SQL。我想将方法​​签名更改为如下所示：

```
public List<Entity> GetEntities(string[] visibleColumns)
{
    using (var context = new CensusEntities())
    {
        return (from e in context.Entities
            select e).ToList();
    }
} 
```

我不确定如何更改此方法的主体以将生成的 SQL 语句更改为仅返回我关心的列值，其他所有值都可以为 NULL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T21:04:17.293

像这样的东西应该工作：

```
 List<string> columns = new List<string>();
 columns.Add("EmployeeID");
 columns.Add("HireDate");
 columns.Add("City"); 
```

将列添加到您的列表 ^。

```
var result = Class.ReturnList(columns); 
```

将列表传递给方法 ^。

```
public static List<Entity> ReturnList(List<string> VisibleColumns)
        {
            StringBuilder SqlStatement = new StringBuilder();
            SqlStatement.Append("Select ");
            for (int i = 0; i < VisibleColumns.Count; i++)
            {
                if (i == VisibleColumns.Count - 1)
                {
                    SqlStatement.Append(VisibleColumns[i]);
                }
                else
                {
                    SqlStatement.Append(VisibleColumns[i]);
                    SqlStatement.Append(",");
                }
            }
            SqlStatement.Append(" FROM Entity");
            using (var ctx = new DataClasses1DataContext())
            {
                var result = ctx.ExecuteQuery<Entity>(SqlStatement.ToString());
                return result.ToList();
            }

        } 
```

这基本上只是对`SELECT`您在列表中传递的所有字段进行声明`VisibleColumns`。

在这种情况下，列表中的字符串将生成的 SQL 语句`VisibleColumns`为：

```
Select EmployeeID, HireDate, City From Employee 
```

（注意：我使用 Northwind 数据库进行了尝试，因此使用了 EmployeeID 等列名。显然，您应该将它们替换为您自己的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T20:21:26.017

尝试这样的事情

```
using (var context = new CensusEntities())
{
    var q = from e in context.Entities
        select e.myfield1,e.myfield2;
    return q.Tolist();
} 
```

生成的查询应该更轻，并且所有的数据转换都在下面。

但是如果你真的需要构建动态输入，我认为应该涉及一些动态sql。所以

1.  构建动态SQL并获取数据表
2.  使用数据表到动态对象的转换，如此处所示 [如何将数据表转换为动态对象？](https://stackoverflow.com/questions/7794818/how-can-i-convert-a-datatable-into-a-dynamic-object)

BTW 辛苦了，我认为你应该考虑使用第一块代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:55:22.077

动态执行此操作并非易事，但如果您想要检索的列组合有限，则可以执行如下显式选择：

```
public List<Entity> GetEntities()
{
    using (var context = new CensusEntities())
    {
        return (from e in context.Entities
            select new
            {
                col1 = e.col1,
                col4 = e.col4,
                col5 = e.col5,
            }
        ).ToList()
        .Select(x=>new Entity{col1 = x.col1, col4 = x.col4, col5 = x.col5}).ToList();
    }
} 
```

额外的选择步骤是必要的，因为 LINQ2SQL 不会为您创建部分实体。

为用户想要检索的每个常见的列组合（尤其是初始列）创建一个方法。

但是，为了使这种动态化，您可以使用存储为匿名类中的属性的实体构建查询，并在同一匿名类的第二个属性中收集另一个匿名类中的结果属性。最后，您从收集的对象中选择您的实体到正确类型的对象中。

```
public List<Entity> GetEntities()
{
    using (var context = new CensusEntities())
    {
        var combinedResult = (from e in context.Entities
            select new {
                Entity = e,
                CollectedValues = new
                                  {
                                      // Insert default values of the correct type as placeholders
                                      col1 = 0, // or "" for string or false for bool
                                      col2 = 0, // or "" for string or false for bool
                                      // ...
                                      col49 = 0, // or "" for string or false for bool
                                      col50 = 0, // or "" for string or false for bool
                                  }
        );

        // Then copy each requested property

        // col1
        if (useCol1)
        {
            var combinedResult = (from e in combinedResult
                select new {
                    Entity = e,
                    CollectedValues = new
                                      {
                                          col1 = e.Enitity.col1, // <-- here we update with the real value
                                          col2 = e.CollectedValues.col2, // <-- here we just use any previous value
                                          // ...
                                          col49 = e.CollectedValues.col49, // <-- here we just use any previous value
                                          col50 = e.CollectedValues.col50, // <-- here we just use any previous value                                          }
            );
        }

        // col2
        if (useCol2)
        {
         // same as last time
                                          col1 = e.CollectedValues.col1, // <-- here we just use any previous value
                                          col2 = e.Enitity.col2, // <-- here we update with the real value
                                          // ...
        }

        // repeat for all columns, update the column you want to fetch

        // Just get the collected objects, discard the temporary
        // Entity property. When the query is executed here only
        // The properties we actually have used from the Entity object
        // will be fetched from the database and mapped.
        return combinedResult.Select(x => x.CollectedValues).ToList()
        .Select(x=>new Entity{col1 = x.col1, col2 = x.col2, ... col50 = x.col50}).ToList();
    }
} 
```

会有很多代码，维护起来很痛苦，但它应该可以工作。
如果你要走这条路，我建议你构建一个代码生成器，用你的 LINQ 上下文的反射来构建这个代码。

# sql-server - SQL Server 2012 卸载错误

> ID：12805081
> 
> 赞同：10
> 
> 时间：2012-10-09T17:16:21.053
> 
> 标签：sql-server, uninstallation, sql-server-2012

从 SQL Server 2012 卸载一个实例后，我尝试卸载第二个实例，但这次弹出一个错误，说我不符合要求，因为我之前使用的是 SQL，所以这是不正确的。

有没有人遇到过这个问题？

系统规格：

Intel Core i3-2300 @ 3.10 GHz
2.00GB（1.82 GB 可用）
32 位操作系统

SQL Server 版：企业版

**错误：此计算机上的操作系统不满足 SQL Server 2012 的最低要求。对于 Windows Vista 或 Windows Server 2008 操作系统，需要 Service Pack 2 或更高版本。对于 Windows 7 或 Windows Server 2008 R2，需要 Service Pack 1 或更高版本。有关详细信息，请参阅安装 SQL Server 2012 的硬件和软件要求，网址为：**

[http://go.microsoft.com/fwlink/?LinkID=195092](http://go.microsoft.com/fwlink/?LinkID=195092)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-31T20:10:20.490

这篇文章作为评论更合适，但我不能发表评论，所以就这样吧。

我曾经也有过一样的问题。我运行带有 SP1 的 Windows 7。我不小心在我的 64 位系统上安装了 SQL Server Express 2012 SP1 的 32 位版本而不是 64 位版本，并且由于上述错误而无法将其删除。

我听从了 John S 的建议，将 setup.exe 的兼容模式更改为 Vista SP2。在我的机器上，该文件位于：C:\Program Files (x86)\Microsoft SQL Server\110\Setup Bootstrap。

之后，我能够成功地从控制面板运行“删除”选项。

***另一个修复：（***因为这对我不起作用）-您需要带有 SP3 安装介质的 SQL2012 用于您已安装的版本。SP3 的安装程序没有该错误，因此只需安装 ISO 或浏览到提取的媒体并运行 F:\setup.exe /ACTION=uninstall - 经过大量搜索后，这对我来说非常有效。这篇文章帮助我到达那里 - 谢谢。（我正在编辑，因为我没有声誉！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-26T11:49:50.800

我不知道您是否解决了问题..我通过以下方式解决了问题：这是我尝试过的详细信息：

您需要转到 C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\SQLServer2012

然后单击 setup.exe 并转到属性上的兼容性选项卡并选中 Run this program in compatible mode for Windows X（您的 Windows 版本）。

现在，如果您可以正确卸载它。

# c# - 没有产品类的基类/接口的构建器设计模式

> ID：12805082
> 
> 赞同：2
> 
> 时间：2012-10-09T17:16:22.767
> 
> 标签：c#, .net, design-patterns, builder

GoF 书中指出，构建器模式中的产品类不一定需要从基类继承。具体的构建器类可能会产生完全不同的产品，它们共享相同的抽象构建步骤。

使用构建器模式的客户端需要实例化具体的构建器类并将对象与 Director 对象相关联。导演将使用构建器来构建对象并最终返回完整的对象。

我的问题是，如果产品类不共享相同的基类，导演将如何设计？在 C# 中，这可以通过使用泛型轻松实现，但设计模式不依赖于语言特性。为每种类型的具体产品定义单独的方法似乎不是一个好主意，因为它会将主管与产品类紧密耦合，并且任何新产品类都需要更改主管类。

请让我知道你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:22:37.000

该模式不关心产品的性质，因此如果您有生成不同类型产品的构建器，您当然可以只返回 Object。结果不再是静态类型的，但这现在是消费者的问题，因为他们要求主管使用可以生产任意产品的构建器。

# c# - 如何使用 aspx 页面将数据从数据库写入 xml？

> ID：12805083
> 
> 赞同：0
> 
> 时间：2012-10-09T17:16:26.407
> 
> 标签：c#, asp.net, .net, xml, xmlhttprequest

我有一些从数据库获取数据的存储过程。我做了一些数据访问层类来从 sql db 中获取数据我有一些 Xml 文件应该用这些数据填充。我应该使用 aspx 页面在它们之间进行链接。现在，我想知道如何从 xml 文件中读取 aspx 页面上的数据以将其发送到服务器，以及如何将数据从 db 写入 xml 文件。

我曾经使用过 json，但是有没有一种方法可以在不使用 json 而只使用 XML 的情况下发送和接收数据？

这是我的 XML 文件：

```
<allNews>
<news>
    <gNews>
        <flag>List of categories IDs this article linked to</flag>
        <title>news title goes here</title>
        <description>news description goes here</description>
        <date>news date goes here</date>
    </gNews>
</news> 
```

这是从数据库中检索列表的函数：

```
XDataContext XDB = new XDataContext();

    public getCategoryContentListResult GetCategoryContentList(int contentID)
    {
        return XDB.getCategoryContentList(contentID).SingleOrDefault<getCategoryContentListResult>();
    } 
```

我想知道如何使用 aspx 连接这两个文件。

当我使用 Json 时，我曾经这样做：[我从 javascript 文件的 ajax 调用中读取数据）

```
 private getCategoryContentListResult GetCategoryList()
        {     
              int ContentID = int.parse(Request.QueryString["country"]);     
              int res = getCategoryContentListResult(ContentID);
              JsonResponse = JsonConvert.SerializeObject(res);
        }
        Response.Clear();
        Response.ContentType = "application/json";
        Response.ContentEncoding = System.Text.Encoding.UTF8;
        Response.Write(Request.QueryString["jsoncallback"] + "(" + JsonResponse + ");");
        Response.End(); 
```

现在我不能使用Json，我只需要使用XML。那么有什么方法可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T05:31:44.120

尝试相应地修改以下代码

```
protected void Page_Load(object sender, EventArgs e)
    {
        XmlTextWriter writer = new XmlTextWriter("your.xml", System.Text.Encoding.UTF8);
        writer.WriteStartDocument(true);
        writer.Formatting = Formatting.Indented;
        writer.Indentation = 2;
        writer.WriteStartElement("AllNews");
        writer.WriteStartElement("News");
        //Loopthrough your dataset/datatable/Or datareader here
        //Call the CreateNode Method from here 
        //End of loop
        writer.WriteEndElement();
        writer.WriteEndElement();
        writer.WriteEndDocument();
        writer.Close();

    }

    private void createNode(string flag, string title, string desc, string date, XmlTextWriter writer)
    {
        writer.WriteStartElement("GNEWS");
        writer.WriteStartElement("flag");
        writer.WriteString(flag);
        writer.WriteEndElement();
        writer.WriteStartElement("title");
        writer.WriteString(title);
        writer.WriteEndElement();
        writer.WriteStartElement("description");
        writer.WriteString(desc);
        writer.WriteStartElement("date");
        writer.WriteString(date);
        writer.WriteEndElement();
        writer.WriteEndElement();
    } 
```

希望这会有所帮助。

# c++ - DLL 中的 Qt GUI 环境（VST 插件）

> ID：12805084
> 
> 赞同：19
> 
> 时间：2012-10-09T17:16:30.213
> 
> 标签：c++, qt, user-interface, dll, vst

我想使用 Qt GUI 库作为 VST 插件的用户界面。VST 插件是 Windows 上的 DLL。主机应用程序调用 DLL 上的各种函数，包括`openGUI()`.

我想知道如何从 DLL 中使用 Qt GUI；我已经做了一些研究来看看可能的选择，但我不完全确定这些限制。

主要问题是在哪里创建`QApplication`对象并调用`exec()`它（这是一个在应用程序退出之前不会返回的函数）。

我已经查看了[这篇文章](https://stackoverflow.com/questions/11054087/starting-qt-gui-from-dll-in-dllstart-function)中给出的解决方案，但是在进一步阅读之后，看起来这个解决方案将无法在 Mac OS X 上运行，因为 Cocoa 对 GUI 可以运行的特定线程有更多限制。这真的有点骇人听闻。

我也看到[了这个解决方案](https://stackoverflow.com/questions/1678937/dllmain-and-qt-mfc-migration)，但它依赖于Qt 库，`QMfcApp`并且`QWinWindow`它似乎不再是 Qt 库的一部分。

让我的 DLL 自己生成一个新应用程序是唯一的方法吗？大概我可以通过调用`QProcess`并使用一些共享内存在 GUI 应用程序和我的 VST DLL 之间共享？有没有人遇到过这种类型的问题？我是不是走上了一条糟糕的道路，还是我还没有想到什么？

**更新**

经过进一步的研究，我遇到了这个[`QAbstractEventDispatcher`](http://qt-project.org/doc/qt-4.8/qabstracteventdispatcher.html)班级。我看过[这篇文章](http://qt-project.org/doc/qt-4.8/qabstracteventdispatcher.html)，它似乎说可以`QApplication::processEvents()`从您自己的（我的插件的主机）事件循环中调用，而不是调用`QApplication::exec()`. 有没有人试过这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T11:59:20.460

似乎您的实际问题是在 mac 上将 Qt 用于 VST 插件，因为据报道它可以在 Windows 上工作 - 请参阅[此处](http://matt.eifelle.com/2009/12/01/vst-plugin-again-reloaded-with-a-qt-gui/)（[完整源代码树](https://github.com/mbrucher/QtVST)）和[此处](http://vokicodder.blogspot.co.il/2009/04/vst-plugins-with-qt-user-interface.html)。

[在 Qt 论坛中](http://qt-project.org/forums/viewthread/14098)有一个成功的报告在 mac 上使用 Qt for VST 插件，但另一方面，在同一问题上存在一个[未解决的错误。](https://bugreports.qt-project.org/browse/QTBUG-11934)

我知道它不能回答您的问题，但我建议使用更适合 VST 插件的其他 UI 库，例如[JUCE](http://www.rawmaterialsoftware.com/jucefeatures.php)和[WDL](http://www.cockos.com/wdl/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-13T10:45:14.893

您是否因此而走上了一条糟糕的道路？不一定，如果您正在开发免费的 VST 插件；或者是成功的商业插件开发人员。然而，尽管我喜欢 Qt 用于一般软件开发，但它并不是特别适合 VST 开发。它的许可是这样的，除非您付费，否则您不能将 DLL 与其库静态链接以用于商业用途；而且相当昂贵。当他们把它做成 LGPL 时，它做到了，所以你可以将所有依赖项（这些依赖项很容易运行到十几个 DLL 中）用于目标程序或 DLL 目录中的独立商业程序，它会运行并且你可以出售它商业上；无需购买许可证。

VST 用户习惯于随意移动 DLL 以移动效果；而且他们不能只有一个在 LGPL 下移动。使用大量额外 DLL 扫描的乱扔目录会使扫描过程变慢。在你的 VST 插件的文件夹中有很多依赖项对于商业插件来说不会像其他商业插件那样工作得很好；因为您不能在单个 DLL 中生成插件并将其与 Qt 库静态链接，而无需为 Qt 支付很多费用，或者使其成为 GPL 或类似的东西。

编辑：反对它的一个论点是 Qt 对其信号和插槽进行字符串比较。使用新的连接重载处理信号和插槽的新方法不依赖于字符串。

在本地录音室，在安装 Waves 插件时，我注意到在 {Waves Install Directory}/Application 目录中，有包含 Qt 库的 WavesQtLibs 文件夹。看起来他们正在将 Qt 用于他们的应用程序，但如果他们将 Qt 用于他们自己的插件，他们要么是静态链接，要么不使用它们。由于 Waves 支持针对多个平台的应用程序和插件，我可以看到 Qt 对他们的吸引力。大概他们可以负担得起 Qt 许可证来进行开发。看来他们正在为他们的应用程序使用带有 DLL 的 Qt，这将更容易在操作系统之间移植。我不知道他们是否有使用 LGPL 的必要通知。我不知道他们是否在为他们的插件本身使用 Qt 静态链接，

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T15:56:42.923

从 VST DLL 执行 Qt 进程，然后使用 IPC 在它们之间共享内存（或使用消息传递等）。

# c# - 如何让 JavaScriptSerializer 忽略 [ScriptIgnore] 标签？

> ID：12805086
> 
> 赞同：2
> 
> 时间：2012-10-09T17:16:41.757
> 
> 标签：c#, javascriptserializer, scriptignore

我需要让[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)忽略`[ScriptIgnore]`标签。我想我可以使用自定义[JavaScriptConverter](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.registerconverters.aspx)来做到这一点。但是，我不太确定。我需要做的就是忽略该属性，其余的可以通过基本定义来完成。您可以在[此处查看](http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/ndp/fx/src/xsp/System/Extensions/Script/Serialization/JavaScriptSerializer@cs/1305376/JavaScriptSerializer@cs)[代码`JavaScriptSerializer`](http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/ndp/fx/src/xsp/System/Extensions/Script/Serialization/JavaScriptSerializer@cs/1305376/JavaScriptSerializer@cs)。

我担心实现自定义转换器（例如[此示例](http://www.asp.net/ajax/documentation/live/ViewSample.aspx?sref=System.Web.Script.Serialization/cs/App_Code/ListItemCollectionConverter.cs)）最终会无法正确序列化复杂的自定义对象图。

回顾微软的 JavaScriptSerializer 代码，上线`252-253`代码：

```
// Ignore all fields marked as [ScriptIgnore]
if (fieldInfo.IsDefined(typeof(ScriptIgnoreAttribute), true /*inherits*/)) 
 continue; 
```

是我真正需要绕过的唯一部分。我只需要注释掉那行代码。不幸的是，这实际上是不可能的，所以我需要一些方法来忽略整个过程的那一部分。

我怎样才能忽略那行代码，或者以某种方式提供一个不忽略`[ScriptIgnore]`属性的自定义实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:26:19.560

我最终不得不模仿 JavaScriptSerializer 类并在模仿的类中提供一些自定义。不知道我会建议这样做，或者它是非常可读的。另一方面，它有效，我喜欢它。

# java - 休眠 max() 查询

> ID：12805090
> 
> 赞同：0
> 
> 时间：2012-10-09T17:17:26.103
> 
> 标签：java, hibernate

我需要选择我给出的 extId == 参数的记录，并从这些记录中选择我想要最新的日期（`createDate`属性）。我正在尝试这个：

```
select r from Record r where r.extId=:eid and r.createDate=(select max(r.createDate) from r where r.id=r.id) 
```

只需返回最新记录。请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:23:31.597

你可以试试这个查询，它对我有用。

```
from Record r where r.extId=:eid and r.createDate IN (select max(r2.createDate) from Recordr2) 
```

# android - “@id”与“@+id”在相对布局中的定位问题

> ID：12805091
> 
> 赞同：19
> 
> 时间：2012-10-09T17:17:27.157
> 
> 标签：android

美好的一天，我对相对布局有一个小问题，我不知道为什么。通常，当您尝试相对于其他视图定位时，您使用“@id”，但它似乎根本没有定位。只有当我使用值“@+id”时它才会正确运行。在下面的示例中，我在水平方向上有 4 个视图，我希望将带有“percentage_id”的 TextView 定位在 imageviews 之间，但更接近最后一个。

```
<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/sales_id"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="10dp"
        android:text="£0.00"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="#AADDEE"
        android:textSize="18sp"
        android:textStyle="bold" >
    </TextView>

    <ImageView
        android:id="@+id/arrow_id"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:layout_toRightOf="@id/sales_id"
        android:baselineAlignBottom="true"
        android:src="@drawable/rightarrow" >
    </ImageView>

    <TextView
        android:id="@+id/percentage_id"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/imagearrow_id"
        android:layout_toRightOf="@id/arrow_id"
        android:text="0.00%"
        android:textColor="#606090"
        android:textSize="18sp" >
    </TextView>

    <ImageView
        android:id="@+id/imagearrow_id"
        android:layout_width="20dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_marginLeft="2dp"
        android:layout_weight="0"
        android:gravity="right"
        android:padding="5dp"
        android:src="@drawable/rightarrow" >
    </ImageView>

</RelativeLayout> 
```

现在，无论我做什么，它都会转到相对布局中的默认位置，只有当我使用“@+id”而不是“@id”时，它才会转到正确的位置。我知道有时如果尚未声明要引用的视图可能会出错，但即使我将文本视图放在最后，在我使用“@+id”之前我仍然无法将它放在我想要的位置。

这是一个也适用于相对布局的新事物吗？因为我不知道为什么它不能与“@id”一起使用。我这样好吗？有人遇到同样的问题吗？在网上看到一些教程也使用“@+id”进行定位。谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-09T17:31:48.400

尽管您*可以引用*层次结构中稍后声明的视图，但仍按顺序解析 XML 文档。第一次引用特定 ID 时，*必须*在其前面加上`@+id`. 实际上，您可以在每个对 ID 的引用前加上前缀`@+id`，一切都会正常工作——事实上，如果您使用图形编辑器设计界面，就会发生这种情况。为了安全起见，所有内容都以`@+id`. 只是告诉它在当且仅当它尚未被定义时才`+`生成一个 ID 。`R.java`如果您尝试多次定义它，它只会看到它已经被定义并正常继续。

在您的 XML 中，您`imagearrow_id`从`percentage_id`TextView 中引用。但是，此时`imagearrow_id`尚未定义。对于这种情况，您可以简单地`layout_toLeftOf=@+id/imagearrow_id`在 TextView 中添加前缀，然后在下面定义 ImageView ( `imagearrow_id`) 时，您将*不需要*属性中`+`的。`android:id`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T17:25:24.940

`@+id`第一次声明ID时使用，在元素的定位中不要使用。它应该只用于`android:id`属性。

`@id`另一方面，用于引用现有 ID。

在 a`RelativeLayout`中，您不能引用当前代码中引用视图下方的视图。因此，如果您有以下布局：

```
LayoutRoot
    View1
    View2
    View3 
```

View1 不能，或者更确切地说，不应该使用 View2 和 View3 来定义它的位置。View2 应该只使用 View1 来定义它的位置，而 View3 可以同时使用 View1 和 View2。

本质上，`@id`只要您通过它引用的视图已在布局文件中的引用视图上方声明，您就可以使用它。

因此，只需切换最后两个小部件的代码块位置，您就可以使用`@id`：

```
<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/sales_id"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="10dp"
        android:text="£0.00"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textColor="#AADDEE"
        android:textSize="18sp"
        android:textStyle="bold" >
    </TextView>

    <ImageView
        android:id="@+id/arrow_id"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:layout_toRightOf="@id/sales_id"
        android:baselineAlignBottom="true"
        android:src="@drawable/rightarrow" >
    </ImageView>

    <ImageView
        android:id="@+id/imagearrow_id"
        android:layout_width="20dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_marginLeft="2dp"
        android:layout_weight="0"
        android:gravity="right"
        android:padding="5dp"
        android:src="@drawable/rightarrow" >
    </ImageView>

    <TextView
        android:id="@+id/percentage_id"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/imagearrow_id"
        android:layout_toRightOf="@id/arrow_id"
        android:text="0.00%"
        android:textColor="#606090"
        android:textSize="18sp" >
    </TextView>

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-16T09:02:12.607

在尝试了 ConstraintLayout 之后，检查下面的代码片段，**两个视图都包含在 constraintLayout 中**，我将粘贴案例代码：

```
<android.support.v4.widget.ContentLoadingProgressBar
            android:id="@+id/progress"
            android:layout_width="150dp"
            android:layout_height="150dp"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintTop_toTopOf="parent"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintVertical_bias="0.3"
            style="?android:attr/progressBarStyleLarge"
            android:visibility="@{safeUnbox(viewmodel.isLoading) ? View.VISIBLE : View.INVISIBLE}"
            />

        <TextView
            android:id="@+id/click_load"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginTop="10dp"
            android:gravity="center_horizontal"
            android:text="@{viewmodel.text}"
            android:textSize="22sp"
            android:visibility="@{safeUnbox(viewmodel.isLoading) ? View.INVISIBLE : View.VISIBLE}"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toBottomOf="@id/progress"
            tools:text="ojoooihoihohoihiohhoihio" /> 
```

该行：

```
 app:layout_constraintTop_toBottomOf="@id/progress" 
```

在编辑器中显示固定到视图窗口顶部的文本视图，运行时一切看起来都很好，但这仍然令人困惑，现在如果你这样写

```
 app:layout_constraintTop_toBottomOf="@+id/progress" 
```

按预期在 UI 编辑器的进度下方显示 textview，通读 kcoppock 解释我发现它与案例相符。

# android - 使用 Android 的 NFC Mifare Ultralight C 身份验证超时

> ID：12805092
> 
> 赞同：1
> 
> 时间：2012-10-09T17:17:30.247
> 
> 标签：android, authentication, nfc, mifare

我正在尝试按照这些步骤使用 Android 手机（Samsung Galaxy Nexus）对 Mifare Ultralight C 标签进行身份验证。如果步骤之间没有延迟，则身份验证工作正常。但是如果有延迟，比如在响应消息前等待 200ms，就会抛出 IOException。

我尝试了 Android API 提供的 setTimeout 方法，但似乎没有什么不同。

我不认为这是标签问题，因为我可以使用连接到我的 Macbook 的不同阅读器对其进行身份验证，即使有一些延迟。（实际上我能够单步执行代码并且标签没有抱怨）。

这是 Android API 限制吗？任何解决方法？在这种情况下是否应该使用 setTimeout 方法？我怀疑我可能会错误地使用该方法。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:18:11.863

每当您不与标签通信时，Android 都会持续检查标签是否存在。它如何做到这一点取决于标签的技术（NfcA/B/F/V 或 IsoDep），但对于 MIFARE Ultralight，这将通过重新选择标签来完成。这实质上会重置它，因此任何身份验证上下文都将丢失，并且标签将无法继续进行身份验证。

这种行为与典型的桌面阅读器的行为完全不同。因此，在这种情况下，您需要注意这一点。最好的办法是通过与标签持续通信来防止自动存在检查启动。（当您在调试器中单步执行代码时，状态检查也将开始，顺便说一句。）

# c++ - 将运算符 ^ 与 `double` 操作数一起使用会产生编译器错误

> ID：12805095
> 
> 赞同：0
> 
> 时间：2012-10-09T17:17:45.050
> 
> 标签：c++

我想出了一些代码，但它无法编译。

错误 1 ​​错误 C2296：“^”：非法，左操作数的类型为“双”
2 IntelliSense：表达式必须具有整数或枚举类型

我能够想出的代码如下：

```
#include<iostream>
#include<cmath>
using namespace std;

void getnumbers();
void showmean();
void showdev();

double x1, x2, x3, mean, dev;

void getnumbers()
{
    cout<<"Please enter three numbers\n";
    cin>>x1,x2,x3;
}

void showmean()
{
    mean=(x1+x2+x3)/3;

    cout<<"The mean of"<<x1<<", "<<x2<<", "<<x3<<" is "<<mean<<endl;
}

void showdev()
{
    dev=sqrt((x1 - mean)^2) + (x2 - mean)^2 + (x3 - mean)^2/3;

    cout<<"The standard deviation of"<<x1<<", "<<x2<<", "<<x3<<" is "<<dev<<endl;
}

int main()
{
    getnumbers();
    showmean();
    showdev();

    system("pause");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T17:22:48.897

1.  你不能在 C++ 中获得这样的权力

    *   使用`std::pow()`or`x*x`表示数学 x ²
2.  对于多个输入，它是`cin >> x1 >> x2 ...etc`

3.  在你的 SD 等式中，我认为你的接近的括号在数学上是错误的。

    *   它应该是`SD = sqrt( (x*x + y*y) / z )`。你的密切括号使它成为 x + y*y/3 （或 y ^(2/3)，忘记优先级）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:30:06.063

除了用于平方值的不正确的运算符和缺少括号外，给定的程序没有完成赋值部分，即函数应该*返回*计算值。例如：

```
double calculate_mean()
{
    return (x1+x2+x3)/3;
} 
```

# c#-4.0 - 在表中插入带有实体框架的行，具有没有主键的标识列

> ID：12805097
> 
> 赞同：0
> 
> 时间：2012-10-09T17:17:52.770
> 
> 标签：c#-4.0, entity-framework-4

我这里有不同的情况，

![在此处输入图像描述](../Images/de5e73406416c157b9a14a3b7d84128a.png)

其中**FromUserId**和**ToUserId**是主键，**InvitationId**是标识列，

现在我正在尝试插入

```
Invitation newInvitation = context.Invitations.CreateObject();                        
newInvitation.FromUserId = 100;
newInvitation.ToUserId = 1111;
newInvitation.AcceptToken = "stringvalue";
newInvitation.RejectToken = "stringvalue";
newInvitation.InvitedDate = DateTime.Now
newInvitation.ExpireDate = DateTime.Now.AddDays(30f);
newInvitation.Status = "active";
context.SaveChanges(); 
```

我们都知道在这里我们会得到 Exception like

```
"Modifying a column with the 'Identity' pattern is not supported. Column: 'InvitationId'. Table: 'Invitation'." 
```

**可能的解决方案** 将**InvitationId**更改为主键并刷新 edmx 文件。

但是有什么方法可以插入具有整体框架保持正确结构的对象吗？

# xml - Datacash 的 DataCashConf 文件的文档在哪里？

> ID：12805103
> 
> 赞同：1
> 
> 时间：2012-10-09T17:18:14.190
> 
> 标签：xml, datacash

Datacash 支付提供商使用一个名为的配置文件`DataCashConf.xml`，我无法找到相关文档。

该文件看起来像这样（我自己添加了评论）

```
<?xml version="1.0" encoding="utf-8" ?> 
<Configuration>
    <!-- Indicates the server to point at (test or live) -->
    <host>https://mars.transaction.datacash.com/Transaction</host>

    <!-- Transaction timeout value in milliseconds -->
    <timeout>500</timeout>

    <!-- Log file location -->
    <logfile>c:\Program Files\DataCash\DataCash_log.txt</logfile>

    <!-- ??? -->
    <logging>5</logging>
</Configuration> 
```

我想关闭日志记录（我将自己记录所有内容，但 123-Reg 不允许我登录到他们的服务器 C 驱动器），并假设我将日志记录的值从 5 更改为其他值以执行此操作，但我不知道要做什么，也找不到有关此文件格式的任何文档。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T06:44:46.330

这会有用[https://datacash.custhelp.com/app/answers/detail/a_id/213](https://datacash.custhelp.com/app/answers/detail/a_id/213)吗？

# forms - 带有重力形式附加组件的 WooCommerce 变体

> ID：12805106
> 
> 赞同：1
> 
> 时间：2012-10-09T17:18:26.187
> 
> 标签：forms, wordpress, gravity, woocommerce

我将 WooCommerce 与 WooCommerce Gravity Forms Extension 一起使用。

我创建了一个多页重力表来从用户那里收集与产品相关的测量信息。

我的产品还有多个属性，我用作产品变体（颜色、带扣类型等）

这里是问题...

当您选择非默认的变体选项时，填写该页面的表单元素，然后单击下一步按钮，它会转到表单的第 2 页，但变体的下拉菜单不会保留所选选项。

它们被重置为默认值。

有没有人遇到过类似的问题？我不热衷于弄乱 Woo-Commerce 的核心文件来完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T06:51:16.990

你可能需要这个

[页面产品上的 WooCommerce 变体详细信息 - 插件](http://wordpress.org/extend/plugins/woocommerce-variation-details-on-page-product/)

# java - HttpUrlConnection：如何将 XML 响应转换为字符串？

> ID：12805107
> 
> 赞同：3
> 
> 时间：2012-10-09T17:18:35.843
> 
> 标签：java, rest, gwt

我正在使用`HttpURLConnection`发布到 REST API。我仍然没有成功发布任何东西，所以我试图取回应该来自 API 的 XML 响应。

这是我放在一起的代码段，它给我带来了问题：

```
// Process response - need to get XML response back.
InputStream stream = connection.getInputStream();
connection.disconnect();

BufferedReader br = new BufferedReader(stream);
String result;
String line;
while ((line = br.readLine()) != null) {
    System.out.println(line);
    result += line;
}
br.close(); 
```

编译器对这一行不满意（建议的修复是“将流类型更改为阅读器”）：

```
BufferedReader br = new BufferedReader(stream); 
```

有人对我如何正确执行此操作有任何建议吗？任何帮助表示赞赏。

完整代码在这里：

```
package com.gwt.HelpDeskTest.server;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;

import com.google.gwt.user.server.rpc.RemoteServiceServlet;
import com.gwt.HelpDeskTest.client.HelpDeskTestService;
import com.gwt.HelpDeskTest.shared.HelpDeskTestException;

@SuppressWarnings("serial")
public class HelpDeskTestImpl extends RemoteServiceServlet implements HelpDeskTestService {

    @Override
    public String postToRemoteServer(String serviceUrl) throws HelpDeskTestException {
        try {
            final String serverPath= "http://helpdesk.rmi.org/sdpapi/request/";     
            final String serverParameters = "OPERATION_NAME=ADD_REQUEST&TECHNICIAN_KEY=D4ADD3A3-9CD4-4307-932B-29E96BCFA5B6&INPUT_DATA=%3C?xml%20version=%25221.0%2522%20encoding=%2522utf-8%2522?%3E%3COperation%3E%3CDetails%3E%3Crequester%3EBetsy%20Leach%3C/requester%3E%3Csubject%3ETest%3C/subject%3E%3Cdescription%3ETesting%20curl%20input%20again%3C/description%3E%3C/Details%3E%3C/Operation%3E"; // Put parameters here for testing.

            // trying HttpURLConnection instead of a plain URLConnection

            URL url = new URL(serverPath); 
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();           
            connection.setDoOutput(true);
            connection.setDoInput(true);
            connection.setInstanceFollowRedirects(false); 
            connection.setRequestMethod("POST"); 
            connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded"); 
            connection.setRequestProperty("charset", "utf-8");
            connection.setRequestProperty("Content-Length", "" + Integer.toString(serverParameters.getBytes().length));
            connection.setUseCaches (false);

            DataOutputStream wr = new DataOutputStream(connection.getOutputStream());
            wr.writeBytes(serverParameters);
            wr.flush();
            wr.close();

            // Process response - need to get XML response back.
            InputStream stream = connection.getInputStream();
            connection.disconnect();

            // Put output stream into a String
            BufferedReader br = new BufferedReader(stream);
            String result;
            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
                result += line;
            }
            br.close();

            System.out.println(result);
            return result;
        } 
        catch (final Exception e) {
            System.out.println(e.getMessage());
            throw new HelpDeskTestException();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T17:30:46.110

我有两个观察。

1.  向最后移动`connection.disconnect();`，即在该`br.close();`行之后完成阅读。

2.  遵循以下顺序：

    ```
    InputStream stream = connection.getInputStream();
    InputStreamReader isReader = new InputStreamReader(stream ); 

    //put output stream into a string
    BufferedReader br = new BufferedReader(isReader ); 
    ```

希望有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:27:18.080

缓冲阅读器不直接接受输入流，它只接受阅读器对象。将输入流包装在输入流阅读器中并将其传递给缓冲阅读器。

BufferedReader br = new BufferedReader(new InputStreamReader(stream));

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:23:09.657

**-**请参阅此方法，它来自我的工作项目。

**-**我以形式发送**请求**`xml`并**接收**数据`xml`并将**其转换为字符串。**

```
public String postData(String url, String xmlQuery) {

        final String urlStr = url;
        final String xmlStr = xmlQuery;
        final StringBuilder sb  = new StringBuilder();

        Thread t1 = new Thread(new Runnable() {

            public void run() {

                HttpClient httpclient = DefaultHttpClient();

                HttpPost httppost = new HttpPost(urlStr);

                try {

                    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(
                            1);
                    nameValuePairs.add(new BasicNameValuePair("xml", xmlStr));

                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                    HttpResponse response = httpclient.execute(httppost);

                    Log.d("Vivek", response.toString());

                    HttpEntity entity = response.getEntity();
                    InputStream i = entity.getContent();

                    Log.d("Vivek", i.toString());
                    InputStreamReader isr = new InputStreamReader(i);

                    BufferedReader br = new BufferedReader(isr);

                    String s = null;

                    while ((s = br.readLine()) != null) {

                        Log.d("YumZing", s);
                        sb.append(s);
                    }

                    Log.d("Check Now",sb+"");

                } catch (ClientProtocolException e) {

                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                } 
            }

        });

        t1.start();
        try {
            t1.join();
        } catch (InterruptedException e) {

            e.printStackTrace();
        }

        System.out.println("Getting from Post Data Method "+sb.toString());

        return sb.toString();
    } 
```

# java - f:ajax onerror 被触发。为什么？

> ID：12805110
> 
> 赞同：4
> 
> 时间：2012-10-09T17:18:50.013
> 
> 标签：java, ajax, jsf, tomahawk

我有一个带有 af:ajax 的 h:commandLink 如下

```
<h:commandLink id="submitAjaxSearch" value="Submit Search" >
<f:ajax execute="searchForm" listener="#{dcjsEarthSearchBean.doAjaxSearch}" 
 render="searchForm" onevent="handleOutcome" onerror="handleError"/>
</h:commandLink> 
```

支持 bean 方法 doAjaxSearch 被触发并且没有抛出任何错误，我可以看到表单中的值正在更新。

```
public void doAjaxSearch(AjaxBehaviorEvent event){
doSearch();
} 
```

搜索只是创建一些虚拟值并将它们放入管道分隔的字符串中。这些值被转换为谷歌地图地标。当页面从搜索页面加载正常时，这有效。但是在地图页面上，我有一个表单，用户可以使用它来优化搜索并通过单击上面代码中的命令链接进行 ajax 搜索。javascript看起来像

```
function handleOutcome(data){
var status = data.status; // Can be "begin", "complete" or "success".

switch (status) {
    case "begin": // Before the ajax request is sent.
        alert("begin");
        break;

    case "complete": // After the ajax response is arrived.
        alert("complete");
        break;

    case "success": // After update of HTML DOM based on ajax response..
        alert("success");
        break;
}

}

function handleError(data){
alert(data.status);
} 
```

当我单击 commandLink 时，我收到一条提示“开始”的警报，然后我看到支持 bean 代码在 Eclipse 控制台中执行，然后我收到一条提示“完成”的警报，然后当不知何故出现 onerror 时，我收到一条提示“clientError”的提示事件被触发。麻烦的是我不确定具体的客户端错误是什么或如何解决它。我怀疑问题是我的表单位于 Tomahawk 选项卡式窗格中，并且以某种方式部分更新丢失了 Tomahawk 自己创建的封闭表单名称？不一定都在一起。但是在 Firebug 中，我在 handleError 部分中的数据对象上放了一个手表，我得到了一些包含这个的东西。

```
responseXML
Document
serverErrorMessage
"C._mfInternal is undefined"
serverErrorName 
"TypeError"
source
a#j_id_b:searchForm:submitAjaxSearch #  
status  
"clientError"   
type    
"error" 
data
Object { type=
"error"
, status=
"clientError"
, serverErrorName=
"TypeError"
, more...} 
```

我怀疑“C._mfInternal 未定义”是问题的症结所在。但是我不知道那是什么，当我查看页面源时我找不到任何命名的东西。有人见过这样的问题吗？

# android - 由于数据连接不良，适配器出现异常

> ID：12805111
> 
> 赞同：0
> 
> 时间：2012-10-09T17:18:50.353
> 
> 标签：android, nullpointerexception, android-adapter

每当有调用从我的 MySQL 数据库中获取数据时，我的应用程序中都有几个堆栈跟踪，如下面的那些。如果连接中断并且超时，我会得到以下堆栈跟踪：

例子：

```
java.lang.NullPointerException
at android.widget.ArrayAdapter.init(ArrayAdapter.java:310)
at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:128)
at com.---.---.profile.MyReviewAdapter.<init>(MyReviewAdapter.java:20)
at com.---.---.profile.UserFragmentActivity$CommentFragment$MyCommentTask.onPostExecute(UserFragmentActivity.java:559)
at com.---.---.profile.UserFragmentActivity$CommentFragment$MyCommentTask.onPostExecute(UserFragmentActivity.java:1)
at android.os.AsyncTask.finish(AsyncTask.java:631)
at android.os.AsyncTask.access$600(AsyncTask.java:177)
at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4745)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
at dalvik.system.NativeStart.main(Native Method) 
```

例子：

```
java.lang.NullPointerException
at android.widget.ArrayAdapter.init(ArrayAdapter.java:310)
at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:128)
at com.---.---.master.TopItemAdapter.<init>(TopItemAdapter.java:18)
at com.---.---.master.MainFragmentActivity$TopFrag$TopTask.onPostExecute(MainFragmentActivity.java:961)
at com.---.---.master.MainFragmentActivity$TopFrag$TopTask.onPostExecute(MainFragmentActivity.java:1)
at android.os.AsyncTask.finish(AsyncTask.java:631)
at android.os.AsyncTask.access$600(AsyncTask.java:177)
at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4745)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
at dalvik.system.NativeStart.main(Native Method) 
```

这是第二个 LogCat 调用的示例代码：

```
class TopTask extends AsyncTask<String, String, Void> {
            private MyProgressDialog progressDialog = new MyProgressDialog(
                    getActivity());
            InputStream is = null;
            String result = "";

            protected void onPreExecute() {

                    progressDialog.setMessage("Loading...");
                    progressDialog.show();
                    progressDialog.setOnCancelListener(new OnCancelListener() {

                        public void onCancel(DialogInterface dialog) {
                            TopTask.this.cancel(true);

                        }
                    });

            }

            @Override
            protected Void doInBackground(String... params) {
                String url_select = "http://www.---.com/---/master_cat_items.php";

                HttpClient httpClient = new DefaultHttpClient();
                HttpPost httpPost = new HttpPost(url_select);
                ArrayList<NameValuePair> param = new ArrayList<NameValuePair>();
                param.add(new BasicNameValuePair("Sort", Sort));

                try {
                    httpPost.setEntity(new UrlEncodedFormEntity(param));
                    HttpResponse httpResponse = httpClient.execute(httpPost);
                    HttpEntity httpEntity = httpResponse.getEntity();

                    // read content
                    is = httpEntity.getContent();

                } catch (Exception e) {

                    Log.e("log_tag", "Error in http connection " + e.toString());
                }
                try {
                    BufferedReader br = new BufferedReader(
                            new InputStreamReader(is));
                    StringBuilder sb = new StringBuilder();
                    String line = "";
                    while ((line = br.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    result = sb.toString();

                } catch (Exception e) {
                    // TODO: handle exception
                    Log.e("log_tag", "Error converting result " + e.toString());
                }

                return null;

            }

            protected void onPostExecute(Void v) {

                String item, cat;
                try {
                    JSONArray jArray = new JSONArray(result);
                    JSONObject json_data = null;
                    for (int i = 0; i < jArray.length(); i++) {
                        json_data = jArray.getJSONObject(i);
                        item = json_data.getString("item");
                        cat = json_data.getString("category");

                        items.add(item);
                        cats.add(cat);

                    }
                } catch (JSONException e1) {

                } catch (ParseException e1) {
                    e1.printStackTrace();
                } catch (Exception e) {
                                   e.printStackTrace(); 
                                   // toast to notify user to reload

                            }

                TopItemAndTrendingObject[] mco = new TopItemAndTrendingObject[items
                        .size()];
                int index = 0;

                for (@SuppressWarnings("unused")
                String i : items) {
                    mco[index] = new TopItemAndTrendingObject(items.get(index),
                            cats.get(index));
                    index++;
                }

                adapter = new TopItemAdapter(getActivity(), mco); // this is what is referenced in LogCat
                setListAdapter(adapter);

                progressDialog.dismiss();

            }
        } 
```

所以我的问题是：

1.  这个异常是什么意思（是的，我知道 NullPointerException 是什么）？
2.  **更重要的是，我该如何防止这种情况发生？** 即使它就像连接断开时举杯一样基本（任何东西而不是强制关闭？

**编辑：`TopItemAdapter`按要求提供代码**

```
public class TopItemAdapter extends ArrayAdapter<TopItemAndTrendingObject> {
    private final Context context;

    public TopItemAdapter(Context context, TopItemAndTrendingObject[] items) {
        super(context, 0, items);
        this.context = context;

    }

    static class ViewHolder {
        public TextView tv1;
        public TextView tv2;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        View rowView = convertView;
        if (rowView == null) {
            LayoutInflater inflater = ((Activity) context).getLayoutInflater();
            rowView = inflater
                    .inflate(R.layout.master_cat_all_time, null, true);

            holder = new ViewHolder();
            holder.tv1 = (TextView) rowView.findViewById(R.id.myMastCat_Cat);
            holder.tv2 = (TextView) rowView.findViewById(R.id.myMasterCat_Item);

            rowView.setTag(holder);
        } else {
            holder = (ViewHolder) rowView.getTag();
        }

        TopItemAndTrendingObject mco = getItem(position);
        String item = mco.item;
        String cat = mco.cat;

        holder.tv2.setText(String.valueOf(position + 1) + ". " + item);
        holder.tv1.setText(cat);

        return rowView;

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:31:04.020

1.  NullPointer Exception 是什么，您可以[在此处阅读](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/NullPointerException.html)
2.  我认为，首先，您应该正确初始化对象，而不是使用 null。例如：

    ```
    InputStream is = null; 
    ```

像这样做：

```
InputStream is = new InputStream(); 
```

你有不止一个用 null 初始化的对象！

**编辑：**

我认为问题出在这里：

```
try {
                JSONArray jArray = new JSONArray(result);
                JSONObject json_data = null;
                for (int i = 0; i < jArray.length(); i++) {
                    json_data = jArray.getJSONObject(i);
                    item = json_data.getString("item");
                    cat = json_data.getString("category");

                    items.add(item);
                    cats.add(cat);

                }
            } catch (JSONException e1) {

            } catch (ParseException e1) {
                e1.printStackTrace();
            } 
```

像这样做：

```
try {
                JSONArray jArray = new JSONArray(result);
                JSONObject json_data = null;
                for (int i = 0; i < jArray.length(); i++) {
                    json_data = new JSONOBject(jArray.getJSONObject(i).toString());
                    item = json_data.getString("item");
                    cat = json_data.getString("category");

                    items.add(item);
                    cats.add(cat);

                }
            } catch (JSONException e1) {

            } catch (ParseException e1) {
                e1.printStackTrace();
            } 
```

并捕获所有异常，不仅是 JSONException 和 ParseException。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:36:06.490

如果您主要关心的是强制关闭并且您希望您的应用永远不会显示强制关闭，那么您可以使用 UncaughtExceptionHandler。

```
public class UncaughtExceptionHandler implements java.lang.Thread.UncaughtExceptionHandler
{
    private final Context myContext;

public UncaughtExceptionHandler(Context context) {
    myContext = context;
}

public void uncaughtException(Thread thread, Throwable exception) {

    StringWriter stackTrace = new StringWriter();
    exception.printStackTrace(new PrintWriter(stackTrace));
    System.err.println(stackTrace);

    Intent intent = new Intent(myContext, AnyActivity.class);
    myContext.startActivity(intent);

    Process.killProcess(Process.myPid());
    System.exit(10);
}
} 
```

并在您的**活动中的****setContentView**之前写下这一行

 **```
Thread.setDefaultUncaughtExceptionHandler(new UncaughtExceptionHandler  (this)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T11:29:08.760

> 这个异常是什么意思

正如我在评论中已经说过的那样，`NullPointerException`由于数据库连接失败（在这种情况下会发生不同的错误并且速度更快）而没有出现，它出现是因为您没有考虑 Android 使用活动和片段的方式（更准确地说是它们的生命周期）。

我不知道您是否有关于这些异常的更多详细信息，我的猜测是当用户进入有问题的地方`Fragment`看到`ProgressDialog`（并且任务已启动）然后旋转手机时会出现异常。此时，Android 将重新创建活动以及任何包含的片段。这应该由您的代码处理，但相反，您做了一些特别糟糕的事情，这将抛出`NullPointerException`.

查看您声明`TopTask`该类的方式可以肯定地说它是`Fragment`. 作为一个内部类意味着它与封闭`Fragment`实例有一个“连接”，允许它使用片段的方法（如`getActivity()`）。所以用户去`Fragment`，任务开始，然后旋转手机。此时将重新创建活动和片段，但您的任务（仍在运行）将保留对初始片段（现在已死）的特殊引用。旋转后，这个初始片段引用将与活动分离，其`getActivity`方法将返回`null`。传递`null`给一个`ArrayAdapter`（在你的情况下通过`super`调用）将抛出你看到的异常（来自一个设备`ICS`）。您传递给适配器的数组不能`null`像您在适配器初始化上方声明的那样。这也会引发不同的异常。

> 更重要的是，我该如何防止这种情况发生？即使它就像连接断开时举杯一样基本（任何东西而不是强制关闭？

最简单的做法是不要随着配置更改而破坏片段。这是通过使用 a 的[`setRetainInstance(true)`](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)方法来完成的，`Fragment`因此对 的引用`Fragment`将保持有效（例如在`onCreate`回调中`Fragment`）。我还会将该`TopTask`类设为静态类，并`Fragment`在`TopTask`. 这应该被测试。

您还可以将应用程序上下文的引用从 发送`Fragment`到`TopTask`类似这样（但也许您应该避免它），这将是有效的：

```
// in the onActivityCreated method
new TopTask(getActivity().getApplicationContext()).execute(/*parameters*/); 
```

还要保留对的引用，`ProgressDialog`但在`onPreExecute`回调中对其进行初始化。**

# java - 获取最新的 Maven 依赖项。

> ID：12805115
> 
> 赞同：3
> 
> 时间：2012-10-09T17:18:55.580
> 
> 标签：java, maven

> **可能重复：**
> [如何告诉 Maven 使用最新版本的依赖项？](https://stackoverflow.com/questions/30571/how-do-i-tell-maven-to-use-the-latest-version-of-a-dependency)

获取 Maven 依赖项。我要最新版本。现在我的 pom 中有我公司的 Dependecy 项目，如下例所示。我们正在尝试找到一种不需要版本标签的方法，它只会采用最新版本。这可以做到吗？

```
<dependency>
  <groupId>org.xxxx.maven.test</groupId>
  <artifactId>MavenJARTest</artifactId>
  <version>0.0.1-SNAPSHOT</version>
</dependency> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T17:26:49.993

> 我们正在尝试找到一种不需要版本标签的方法，它只会采用最新版本

你真的不想这样做。仅仅因为某个库的新的、有缺陷的版本出现了，您的构建将变得无法重现和不稳定。您永远无法确定您对半年前生产应用程序的修复是否只更改了一行代码，或者可能还升级了 10 个依赖项。其中一个不再工作，一个不兼容，一个有新的安全漏洞。你真的想冒这个险吗？

事实上，它曾经像插件一样工作（版本可以被跳过），但是从 maven 3.0 开始，设计者认为即使获取最新版本的插件也太危险了。

不过，还是有希望的。跑：

```
mvn versions:display-dependency-updates 
```

并手动发现新版本。仅当您知道自己在做什么时才撞到它们。

# c - C-预处理器和在低内存中实现字符串表

> ID：12805116
> 
> 赞同：1
> 
> 时间：2012-10-09T17:19:03.203
> 
> 标签：c, string, storage, c-preprocessor

我有一些预处理器定义，可以轻松地将 UI 文本存储在单个数组中（见下文）。也使支持其他语言变得不那么麻烦。

```
#define DECLARE_STRING_ENUM_FST(name, value) name
#define DECLARE_STRING_ENUM_SND(name, value) value
#define DECLARE_STRING_ENUM(name, macro) \
    typedef enum name { macro(DECLARE_STRING_ENUM_FST) } name; \
    static const char* name##_sztable[] = { macro(DECLARE_STRING_ENUM_SND) }; \

// this is a string table usage 
#define MSG_ENUM_(X) \
    X(STR_ONE, "One"), \
    X(STR_TWO, "Two"), \
    X(STR_THREE, "Three"), \
    X(STR_PRESS_ENTER, "Press Enter")

// the actual declaration is here
DECLARE_STRING_ENUM(menu, MSG_ENUM_) 
```

结果是一个字符串数组和一个表示数组索引的枚举。

但是，由于它是一个指向常量 char* 的指针数组，因此它占用了在该设备上非常稀缺的 ram。程序中的几个大字符串表占用了大约 30% 的可用 RAM。所以这一点不容忽视。

如果枚举值是存储在代码空间中的一个大 const char 字符串中以 null 结尾的子字符串的起始位置，则 RAM 的依赖性将变为零。

IE：

```
menu_sztable[] = "One\0Two\0Three\0Press Enter\0";
STR_ONE -> 0
STR_TWO -> 4
STR_Three -> 8
STR_PressEnter -> 14 
```

有没有一种聪明的方法来使用 C 预处理器来做这个？我想避免手动构建枚举或必须编写一个转换数组的预构建命令程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:49:47.073

如果您将指针`const`数组设为大多数（全部？）工具链，则会将该数组放入 ROM/flash 中，这通常不会出现空间问题：

```
static const char* const name##_sztable[] = /* ... */
//                 ^^^^^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:51:44.320

这不是一个完整的解决方案，也许是一半......

```
#include <stdlib.h>
#include <stddef.h>
static struct foo {
    char arr0[5];
    char arr1[4];
    char arr2[4];
} tmp = { "Zero","One","Two"};
enum {
   ARR0 = offsetof(struct foo, arr0),
   ARR1 = offsetof(struct foo, arr1),
   ARR2 = offsetof(struct foo, arr2)
};

int main()
{
      printf("%d %d %d\n",ARR0,ARR1,ARR2);
      return 0;
} 
```

不记得链接器选项，但是在反汇编时，我会得到：

```
 .file   "tst.c"
    .data     // manually replace with .text
_tmp:
    .ascii "Zero\0"
    .ascii "One\0"
    .ascii "Two\0"  // manually insert .data here, recompile and run...
    .def    ___main;        .scl    2;      .type   32;     .endef 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:07:48.373

您可以首先定义一大堆编译时间常量来保存字符串的位置，例如

```
#define DEFINE_LENGTH(NAME, STR) NAME ## _POS,       \
      NAME ## _DUMMY = (NAME ## _POS + sizeof(STR)) 
```

在枚举声明中

```
enum {
  ... your macro expansion goes here ...
}; 
```

然后你通过连接创建一个长字符串

```
#define DEFINE_COMPONENT(NAME, STR) STR "\0" 
```

在长字符串的初始化里面

```
char const table[] = ... your macro expansion goes here ...; 
```

现在您的字符串指针是通过

```
#define DEFINE_VARIABLE(NAME, STR) *const NAME = &table[NAME ## _POS] 
```

在以下设置中：

```
char const  ... your macro expansion goes here ...; 
```

（也许这里和那里仍然存在一些语法错误，但我希望你能明白。）

如果您使用诸如 boost 或 P99 之类的宏元包，这一切都会变得更简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T18:18:39.720

为什么不这样做：

```
#if ENGLISH
#define STR_ONE "one"
#define STR_TWO "two"
...
#elif SPANISH
#define STR_ONE "uno"
#define STR_TWO "dos"
...
#endif 
```

是否有理由需要偏移量而不是字符串指针本身？

# soap - 返回错误的 JAX-WS 服务器端 SOAPHandler 在 WebSphere v8 上获得“内部错误”

> ID：12805119
> 
> 赞同：16
> 
> 时间：2012-10-09T17:19:05.997
> 
> 标签：soap, websphere, jax-ws, websphere-8

我有一个服务器端 JAX-WS `SOAPHandler`（在 WebSphere v8 上），在某些情况下需要使用它在 String 变量中的 SOAP 响应来响应客户端（我们称之为它`responseXml`）。

当`responseXml`包含成功（即非故障）SOAP 消息时，JAX-WS 将正确地发送响应给客户端。但是，当`responseXml`包含 SOAP 错误消息时，会发生“内部错误”，并且客户端会收到与 中的错误响应不同的错误响应`responseXml`，如下所示：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
   <soapenv:Body>
      <soapenv:Fault xmlns:axis2ns1="http://schemas.xmlsoap.org/soap/envelope/">
         <faultcode>axis2ns1:Server</faultcode>
         <faultstring>Internal Error</faultstring>
         <detail/>
      </soapenv:Fault>
   </soapenv:Body>
</soapenv:Envelope> 
```

以下错误被写入控制台：

```
[10/9/12 12:21:04:177 EDT] 00000025 AxisEngine    E org.apache.axis2.engine.AxisEngine receive An error was detected during JAXWS processing
                             org.apache.axis2.AxisFault: An error was detected during JAXWS processing
at org.apache.axis2.jaxws.server.JAXWSMessageReceiver.receive(JAXWSMessageReceiver.java:208)
at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:198)
at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
at com.ibm.ws.websvcs.transport.http.WASAxis2Servlet.doPost(WASAxis2Servlet.java:1466)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:595)
... 
```

`SOAPHandler`这是说明此问题的简化版。（请注意，`responseXml`此处显示的值只是一个示例。在我的实际`SOAPHandler`中，响应不是硬编码的，而是从数据库中读取的。我只是想展示最简单的示例代码。）

```
package simplified.demo;

import java.io.ByteArrayInputStream;
import java.util.Set;

import javax.xml.namespace.QName;
import javax.xml.soap.MessageFactory;
import javax.xml.soap.SOAPMessage;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;

public class FaultyHandler implements SOAPHandler<SOAPMessageContext> {

    @Override
    public boolean handleMessage(SOAPMessageContext context) {
        Boolean outbound = (Boolean) context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);

        if (!outbound) {
            String responseXml = "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"><soapenv:Header></soapenv:Header><soapenv:Body><soapenv:Fault><faultcode>soapenv:Server</faultcode><faultstring>ORA-01031: insufficient privileges</faultstring><detail/></soapenv:Fault></soapenv:Body></soapenv:Envelope>";
            try {
                SOAPMessage newMsg = createSOAPMessage(responseXml);
                context.setMessage(newMsg);
            } catch (Exception e) {
                throw new RuntimeException(e);
            }
        }

        return (outbound);
    }

    private SOAPMessage createSOAPMessage(String responseXml) {
        try {
            ByteArrayInputStream in = new ByteArrayInputStream(responseXml.getBytes());
            MessageFactory messageFactory = MessageFactory.newInstance();
            return messageFactory.createMessage(null, in);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public boolean handleFault(SOAPMessageContext context) {
        return true;
    }

    @Override
    public Set<QName> getHeaders() {
        return null;
    }

    @Override
    public void close(MessageContext context) {
    }
} 
```

`SOAPHandler`当我编写代码以创建一个`SOAPFault`对象（使用 a `SOAPFactory`）并将其扔进a时，我得到了完全相同的错误`SOAPFaultException`。

根据堆栈跟踪，我查看了 的源代码[`JAXWSMessageReceiver`](https://svn.apache.org/repos/asf/axis/axis2/java/core/trunk/modules/jaxws/src/org/apache/axis2/jaxws/server/JAXWSMessageReceiver.java)，它看起来像在幕后，Axis2 正在寻找一个 CauseByException，但在这种情况下当然没有。

有谁知道为什么会发生这种情况或如何解决？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-08-19T09:27:15.343

我遇到了同样的问题，并且能够通过禁用*统一故障处理*来解决它（这不是错误，这是一个功能！）。

在 WAS 开发者控制台上

```
https://<yourhost>/<yourport>/ibm/console/login.do 
```

按照[此处](http://www-01.ibm.com/support/knowledgecenter/SSEQTP_8.0.0/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/xrun_jvm.html)所述进行操作（对于 WAS8）：

> 单击服务器 > 服务器类型。，以及 WebSphere 应用程序服务器 > server_name 或 WebSphere 代理服务器 > server_name。接下来，在 Server Infrastructure 部分中，单击 Java and process management > Process definition ，然后选择 Control、Servant 或 Adjunct。然后单击 Java 虚拟机 > 自定义属性。

在那里，添加一个新属性`webservices.unify.faults`并将值设置为`false`。

[![在此处输入图像描述](../Images/3cfec801f5c0d5892329463791922703.png)](https://i.stack.imgur.com/jjnno.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T13:01:15.753

实际问题不是异常导致的丢失，而是websphere中统一的故障处理：

[http://www-01.ibm.com/support/docview.wss?uid=swg1PM58524](http://www-01.ibm.com/support/docview.wss?uid=swg1PM58524)

使用描述的解决方法或安装至少 8.0.0.4

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-11T13:58:33.530

从版本 8 开始的 WebSphere 具有默认启用的安全特性，只是返回消息“内部错误”。这样做是为了“[防止将有关入站消息处理失败原因的详细信息返回给消息发送者](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/topic/com.ibm.websphere.nd.multiplatform.doc/ae/xrun_jvm.html#webservices.unify.faults)”。搜索“webservices.unify.faults”

要禁用此功能，请将 -Dwebservices.unify.faults=false 添加到您的 JVM 定制属性中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-20T05:02:27.103

可以通过禁用 IBM Websphere Application Server 上的通用故障处理功能来解决此错误。

要禁用此属性，请导航到管理控制台 > 服务器 > 应用程序服务器 > > 进程定义 > Java 虚拟机 > 自定义属性。

将密钥输入为“webservice.unify.faults”，将值输入为“false”。

更新后重新启动服务器并安装 EAR 以获取 SOAP 事务的自定义 WSDL 错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-06T23:11:34.777

将 WAS FP **8.5.5.10**升级到**8.5.5.12**后，我遇到了同样的问题。我们有两个方法名称完全相同但*targetNameSpace*不同的服务，例如 DomainService1 有**'get'**方法，而 DomainService2 也有**'get'**方法，但是 WAS **8.5.5.12**抛出此异常并且没有提供任何线索来找到根本原因。显然，在最近的版本中，WAS 对方法的命名更加严格。

**这是异常：** *org.apache.axis2.jaxws.wrapper.impl.JAXBWrapperException：发生内部断言错误。com.xxx.web.myapp.services.jaxws.GetResponse JAXB 对象没有 xxxxxStatus xml*

更改特定于每个服务“getABC”和“getPQR”的方法名称后，它起作用了！！！

希望这有效！

# ruby-on-rails-3.2 - 嵌套表单域

> ID：12805121
> 
> 赞同：1
> 
> 时间：2012-10-09T17:19:22.287
> 
> 标签：ruby-on-rails-3.2

我使用 Ryan Bates railscast 教程来制作这个。但我遇到了一个问题，我试图效仿他的例子，但没有运气。

第一部分是让我的项目表访问问卷属性。

```
class Project < ActiveRecord::Base
 attr_accessible :pid, :name, :qheader, :questionaires_attributes
 has_many :questionaires
 accepts_nested_attributes_for :questionaires, allow_destroy: true

 pid_regex = /\d+/

 validates :pid, presence: true, format: { with: pid_regex}, uniqueness: true
 validates :name, presence: true
 # validates :qheader, presence: true

end 
```

我对我的问卷模型做同样的事情，请忽略问卷拼写错误的事实，因为我已经检查了所有地方以确保它的拼写方式相同。

```
class Questionaire < ActiveRecord::Base
 attr_accessible :content, :project_id
 belongs_to :project
end 
```

然后我为视图/项目构建了 new.html.erb

```
<%= form_for @project do |f| %>
 <%= render 'shared/error_msgs' %>
 <div class="field">
  <%= f.label :pid %><br />
  <%= f.text_field :pid %>
 </div>
 <div class="field">
  <%= f.label :name %><br />
  <%= f.text_field :name %>
 </div>
 <%= f.fields_for :questionaires do |builder| %>
   <%= render "questions", f: builder %>
 <% end %>

 <div class="actions">
  <%= f.submit "Add New Project" %>
 </div>
<% end %> 
```

根据 Ryan Bates 的说法，从我所看到的情况来看，它是有效的，

```
 <%= f.fields_for :questionaires do |builder| %> 
```

应该是复数，但是当它是复数时，位于渲染部分的字段集消失了，但是当 :questionaires 是单数时它会重新出现。但是如果我提交它，它会告诉我它不能批量分配给受保护的属性：questionaires。

谁能告诉我如何解决这个问题。

# node.js - 从 Node.js vm 模块中的 console.log() 访问日志

> ID：12805125
> 
> 赞同：9
> 
> 时间：2012-10-09T17:19:29.117
> 
> 标签：node.js, virtual-machine

在[node.js vm 模块](http://nodejs.org/api/vm.html)中，我可以在另一个 node.js 进程中执行一些 javascript。我想要实现的是能够捕获在 vm 运行的脚本中执行的日志。

例如，我想捕获“foobar”日志：

```
var vm = require('vm')

vm.runInThisContext('console.log("foobar");', 'myfile.vm');

// how can i get the "foobar" log? 
```

提前致谢

编辑：下面的答案效果很好，虽然有一个较短的版本：

```
function captureStdout(callback) {
    var output = '', old_write = process.stdout.write

    // start capture
    process.stdout.write = function(str, encoding, fd) {
        output += str
    }

    callback()

    // end capture
    process.stdout.write = old_write

    return output
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:55:10.873

您可以直接包装console.log：

```
function hook_consolelog(callback) {
    var old_log = console.log;

    console.log = (function(write) {
        return function() {
            write.apply(console, arguments)
            callback.apply(null, arguments);
        }
    })(console.log)

    return function() {
        console.log = old_log;
    }
}

var result;
var unhook = hook_consolelog(function(v) {
    result = v;
});

console.log('hello');
unhook();
console.log('goodbye');
console.log('the result is ', result);​ 
```

由于`console.log`只是调用`process.stdout`，另一种方法是使用[如下包装魔术](https://gist.github.com/729616)来捕获标准输出事件：

```
var util = require('util')

function hook_stdout(callback) {
    var old_write = process.stdout.write

    process.stdout.write = (function(write) {
        return function(string, encoding, fd) {
            write.apply(process.stdout, arguments)
            callback(string, encoding, fd)
        }
    })(process.stdout.write)

    return function() {
        process.stdout.write = old_write
    }
}

var unhook = hook_stdout(function(string, encoding, fd) {
    util.debug('stdout: ' + util.inspect(string))
    if( string == 'foobar' ) { unhook(); }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2021-06-16T07:31:08.600

也许最好将当前控制台转发到新创建的上下文对象：

```
let contextObj = {
    console: console
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-01-28T00:14:36.947

我找到了另一个更简单的解决方案，恕我直言：我们只需要覆盖`console.log()`VM 上下文中的函数即可使用外部上下文中的函数。

```
import { Script, createContext } from 'vm';

let contextObj = {
    console: {
        log: (...args) => {
            console.log(...args);
        }
    }
};

const vmContext = createContext(contextObj);
const script = new Script("console.log('hello from the other side');");
script.runInContext(vmContext); 
```

希望它可以帮助任何寻找愚蠢简单的解决方案的人！

# matlab - Matlab - 在同一窗口中显示两个具有原始尺寸的图像

> ID：12805130
> 
> 赞同：5
> 
> 时间：2012-10-09T17:19:49.383
> 
> 标签：matlab

我有两个灰度图像，大小为 (w1,h1) 的 I1 和大小为 (w2,h2) 的 I2。我希望 Matlab 将它们显示在同一个图中，如下所示：

```
figure;
subplot(2,1,1), imshow(I1);
subplot(2,1,2), imshow(I2); 
```

此代码使图像调整大小以便以相同的宽度显示。

我想保持图像的原始大小（每个图像的每个像素在屏幕上占用一个像素）。有什么选项我可以传递给 subplot 或 imshow 来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:45:00.007

使用[`truesize`](http://www.mathworks.com/help/images/ref/truesize.html)：

```
figure
subplot(2,1,1), imshow(I1)
subplot(2,1,2), imshow(I2)
truesize 
```

如果它不适合屏幕，您将收到警告。喜欢：

```
Warning: Image is too big to fit on screen; displaying at 66% scale. 
```

* * *

**编辑：**它对我有用，因为我使用的两个图像大小相同。显然，一般情况下不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:27:36.707

尝试这个：

```
figure;
subplot(2,1,1), imshow(I1); axis equal;
subplot(2,1,2), imshow(I2); axis equal; 
```

您也可以尝试使用`axis image`.

[http://www.mathworks.com/help/matlab/ref/axis.html](http://www.mathworks.com/help/matlab/ref/axis.html)

# c# - Page_Load 上的 ASP 下拉菜单

> ID：12805133
> 
> 赞同：0
> 
> 时间：2012-10-09T17:19:59.503
> 
> 标签：c#, asp.net

我想使用 Aspx 创建一个下拉列表，它将列出数据源中包含的所有项目，但它会有一个额外的默认值“选定”。

在 aspx 文件中，我有：

```
<aspx:DropDownList
    ID="ddl1"
    runat="server"/> 
```

在我的 aspx.cs 文件中，我有一个 page_load，其中包含：

```
protected void Page_Load(object sender, EventArgs e)
{
  ddl1.DataSource = LocationofData;
  ddl1.DataBind();
} 
```

让我们假设 LocationofData 将填充值“a,b,c,etc...”。我希望默认值为“--selected--”

我应该如何处理这个？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:21:10.537

您可以添加此代码

```
ddl1.Items.Add("--selected--"); //After your bind 
```

所以 ：

```
ddl1.DataSource = LocationofData;
ddl1.DataBind();
ddl1.Items.Add("--selected--"); //After your bind 
```

链接：http: [//msdn.microsoft.com/en-us/library/e7s6873c.aspx](http://msdn.microsoft.com/en-us/library/e7s6873c.aspx)

你也可以使用`Insert method`

链接：http: [//msdn.microsoft.com/en-us/library/ffx2x2y2.aspx](http://msdn.microsoft.com/en-us/library/ffx2x2y2.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:22:06.160

试试这个

```
protected void Page_Load(object sender, EventArgs e)
{
   if(!Page.IsPostBack)
   {
      ddl1.DataSource = LocationofData;
      ddl1.DataBind();

      //first item in the list
      ddl1.Items.Insert(0, new ListItem("-- Select--",""));
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:29:47.667

我认为最佳做法是使用 ondatabound 调用 BaseDataBoundControl.DataBound 事件： ASP.NET 控件：

```
<asp:DropDownList runat="server" ID="ddl1"
  ondatabound="MyListDataBound"></asp:DropDownList> 
```

后面的代码：

```
protected void MyListDataBound(object sender, EventArgs e)
{
    ddl1.Items.Insert(0, new ListItem("- Select -", ""));
} 
```

# .net - WinForms 事件是否在任何地方都被详尽地定义了？

> ID：12805135
> 
> 赞同：0
> 
> 时间：2012-10-09T17:20:15.703
> 
> 标签：.net, winforms

我似乎在 WinForms 中花费了我大部分的事件处理时间，通过实验和反复试验来了解它的事件。

例如 Control.Resize 事件的定义（来自 MSDN 的[.NET 4.0 - Control.Resize Event page](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.resize%28v=vs.100%29.aspx)）：

**“在调整控件大小时发生。”**

事实证明，“调整大小”在 WinForms 用语中似乎有一个相当具体的定义。每当控件更改大小时，都不会触发该事件（为此，您必须侦听[SizeChanged 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.sizechanged%28v=vs.100%29.aspx)）。

这在 MSDN 文档中并不是很明显，并且摸索这些事件和“特殊定义”会导致大量时间浪费和意外行为。是否有一个完整的 WinForms 事件定义的中央存储库（当它们触发时，当它们不触发但您可能期望它们会触发时，触发顺序等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:26:41.013

我认为 MSDN 是最接近你会来的参考，不幸的是，确切的信息有点分散。

也许阅读一本关于该主题的好书将为您提供足够的 WinForms 背景知识，以便能够更快地找到正确的定义和参考/或理解怪癖。一个好的可能是[Petzold 的 Programming Microsoft Windows Forms](https://rads.stackoverflow.com/amzn/click/com/0735621535)。它可能有点老了，但自从 WinForms 出现以来，并没有发生什么真正的新事物。我之所以推荐这本书，是因为 Petzold 是 Programming Windows 的作者，它是 C/Win32 API 的对应物，而这本书通常被认为是Windows 程序员*的*书。

# toggle - 延迟和动画切换jQuery

> ID：12805139
> 
> 赞同：5
> 
> 时间：2012-10-09T17:20:28.807
> 
> 标签：toggle, jquery

我正在尝试玩 arround，我完全是 jquery 的新手！所以我肯定需要一些帮助:)

```
$(function() {
        $('#switch').on('click', function() {
            $('#customOverlay').toggle();
        });
    }); 
```

我做了一个灯切换器，我试图通过添加 customOverlay 来打开/关闭灯。

它工作得很好，但并不像预期的那样。我想将它延迟 1000 毫秒，并且我想为它设置动画，因为这样它只会快速打开和关闭可见性。这可能是因为我什至无法延迟它，而且我不知道如何为切换设置动画。

先感谢您！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-09T17:25:37.870

尝试[.fadeToggle()](http://api.jquery.com/fadeToggle/)：

```
$(function() {
        $('#switch').on('click', function() {
            $('#customOverlay').delay(1000).fadeToggle();
        });
}); 
```

或者

```
$(function() {
        $('#switch').on('click', function() {
            $('#customOverlay').fadeToggle(1000);
        });
}); 
```

仅使用`.delay()`并且`.toggle`不起作用的其他答案，因为`.delay()`仅适用于动画队列并且`.toggle()`不动画，而`.fadeToggle()`确实如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:21:32.920

尝试使用`.delay()`

```
$('#customOverlay').delay(1000).fadeToggle(); 
```

# c# - 在 C# 中包含表格的消息框

> ID：12805142
> 
> 赞同：-3
> 
> 时间：2012-10-09T17:20:46.357
> 
> 标签：c#, .net, wpf, winforms

```
IEnumerable<string> peopleWithInvalidAge =
                    (from age in User
                     where age < 0
                     select name ).Distinct();

MessageBox.show("The people who have invalid age are {0}" , string.Join(", ", peopleWithInvalidAge) ) 
```

这会将输出显示为 string 。但我想要的是输出应该以表格形式显示。调用 MessageBox.show 时带有名称和年龄。

如果我们可以在消息框内突出显示，那也很棒

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:29:00.900

在 WPF 中，您必须创建 Window

Xaml

```
<my:Datagrid x:Name="test" xmlns:my="http://schemas.microsoft.com/wpf/2008/toolkit" CanUserAddRows="True" ItemsSource="{Binding}" AutoGenerateColumns="False">  
    <my.DataGrid.Columns> 
        <my:DataGridTextColumn Header="Your Collection" Binding="{Binding}"/>  
    </my.DataGrid.Columns> 
</my:Datagrid> 
```

代码隐藏

```
public Window()  
{  
    InitializeComponent();  

    test.DataContext = peopleWithInvalidAge ;  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:32:18.060

您可以为此使用窗口，使用 showdialg，使用您想要的按钮和数据网格（使其像 MessageBox）并使用 Dialog 结果，

只是一个想法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:58:52.317

这是针对 WPF

对于格式化可以使用 Window。
您可以在 ctor 中传递 IEnumerable。
Window.ShowDialog 是模态的。

[Window.ShowDialog 方法](http://msdn.microsoft.com/en-us/library/system.windows.window.showdialog%28v=vs.100%29.aspx)

```
Window1 win = new Window1(new List<string> { "john", "susan" });
win.ShowDialog();

public Window1(IEnumerable<string> names)
{
    Names = names;
    InitializeComponent();
}
public IEnumerable<string> Names { get; private set; }

<Window x:Class="ListViewUpdate.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        DataContext="{Binding RelativeSource={RelativeSource self}}"
        Title="Window1" Height="300" Width="300">
<Grid>
    <ListView ItemsSource="{Binding Path=Names}" />
</Grid>
</Window> 
```

版主有三个部分要提问。
模态、传递数据和格式化。
另一个答案没有解决模态或将数据传递到窗口。
我在创建传递和格式化示例时发布。

# ios - 减慢 UIScrollView / 限制最大速度

> ID：12805145
> 
> 赞同：2
> 
> 时间：2012-10-09T17:20:56.030
> 
> 标签：ios, performance, uiscrollview, cap

我有一个 pagingEnabled 滚动视图，当用户接近它的最后时，它会动态添加更多内容。启用分页允许我强制用户一次只能滚动一项。

问题是添加额外的内容需要时间。如果用户滚动浏览我的内容的速度太快（即使使用 pagingEnabled = TRUE，您仍然可以非常快地进行操作），滚动尝试将导致我的滚动视图偶尔“弹跳”，就好像它到达终点一样。如果用户尝试再次滚动，紧接着，他们可以继续滚动。我希望以用户友好的方式防止这种反弹发生。

我认为这种反弹正在发生，因为 iPod/iPhone 无法及时加载滚动视图内容。我想这实际上是一个相当耗费资源的过程（添加到滚动视图的每个子视图都是一个 UIImageView，其中添加了一个 UITextView 子视图）。

我需要一种方法来限制滚动视图的速度。我试着玩减速，但我没有注意到任何区别。我能做些什么？

# sql - 为什么要使用完整版的 Visual Studio？

> ID：12805146
> 
> 赞同：3
> 
> 时间：2012-10-09T17:20:55.420
> 
> 标签：sql, visual-studio, ide

我正在尝试了解有关 Visual Studio、SQL Server 和托管的一些想法。

我了解 Visual Studio Express 和 Ultimate（或其他完整版本）之间的唯一区别是您使用的 sql 服务器在 Express 版本中受到限制。因此，如果您想创建下一个 facebook 或 linkedin，express 将永远无法工作（假设您将使用 ASP.NET 进行此操作），因为它永远无法扩展到数百万占用 TB 数据的用户。

但是我知道您在开发中使用的 sql server 与托管期间使用的 sql server 不同，因为托管公司不允许您的许可证在他们的服务器上运行。因此，如果您最终通过托管公司支付 sql server 费用，该公司显然运行完整版本的 sql server 并因此可以扩展，为什么您在开发过程中需要完整的 sql 许可证？在visual studio express上开发所有东西（因为它是免费的）然后通过托管公司扩展你的sql需求不是更有意义吗？

为我确定是一个愚蠢的问题道歉，但我只是想理解。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-09T17:44:35.643

实际上，没有什么能阻止您使用 Notepad++ 或 Emacs 开发下一个 facebook，因为 .NET 编译器是平台的一部分，并且 API 有很好的文档记录。那么为什么人们不使用 Notepad++ 呢？这是因为在使用通用工具进行开发时，生产力并没有那么好。

MS 使 VS Express 免费提供，但某些功能受到限制，例如使用不同类型解决方案的能力。当然，也可能有用于 .NET 开发的开源工具（但我自己从未使用过）可以为您提供所需的东西。

但是专业开发软件的公司想要的不仅仅是代码编辑器。他们需要源代码控制、自动化测试、代码指标、架构图等。这些是公司购买 Visual Studio Professional 和 Ultimate 的原因。

我也很确定，无论版本如何，您都不允许使用您通过 VS 获得的 SQL Server 版本为最终用户投入生产。因此，VS Express 中对 SQL 的任何限制实际上都没有实际意义。

也就是说，Express 版本非常适合不进行全职专业开发或喜欢在业余时间进行开发的用户（例如学生）。我认为 Express 的创建是为了给这些用户一个真正为 .NET 开发优化的开发工具的优势，但限制了功能，使其对专业组织的吸引力降低。

所以我认为你应该继续使用 Express，直到你需要完整版本的功能。有关详细信息，请参阅[http://www.microsoft.com/visualstudio/eng/products/compare 。](http://www.microsoft.com/visualstudio/eng/products/compare)

# asp-classic - 随机数和数据库检查

> ID：12805147
> 
> 赞同：0
> 
> 时间：2012-10-09T17:20:56.000
> 
> 标签：asp-classic

我在生成唯一 ID 时遇到了一些问题，并且还要检查以确保生成的 ID 不在数据库中。我写了两个简单的函数，但每次运行时，都会出现内存不足的错误。

有没有更好的方法来做到这一点？

这是我的代码：

```
uniqueID = getID()

function getID()
Dim id : id = getUniqueID 'simple random number generator
    if checkForID(id) = 0 then
        return id
    else
        id = getID()
    end if
end function

function checkForID(id)
    SQL="SELECT * FROM userOrderDxTest WHERE orderID =" & id
    set rs=Server.CreateObject("ADODB.recordset")
    rs.Open SQL,DB,adOpenStatic
    if not rs.EOF then
        checkForID = 1   'ID already exists
        rs.close
        set rs = nothing
    else
        checkForID = 1    'ID doesn't exist
    rs.CLOSE
    end if
end function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:28:43.927

你总是将 checkForID 设置为 1。它应该是：

```
if not rs.EOF then
    checkForID = 1   'ID already exists
    rs.close
    set rs = nothing
else
    checkForID = 0    'ID doesn't exist 
```

# php - 如何使用 JSON 编码的表单值在 AJAX 中发布表单

> ID：12805149
> 
> 赞同：1
> 
> 时间：2012-10-09T17:21:04.250
> 
> 标签：php, jquery, ajax, json

在“成功”时，我需要提交`data`给 PayPal。我知道这`$.post('https://www.paypal.com/cgi-bin/webscr', data);`是错误的，因为我需要它提交，就好像那是表单操作一样，进入带有表单值的 PayPal 页面。所有数据都在返回的 JSON 数据中存储并正确格式化。我用`alert(data.cmd)`. 我只是不知道如何从这里模拟 HTML POST 动作。

```
function process(plan_id) {
        var data = {'plan_id' : plan_id};
        $.ajax({
                type: "POST",
                url: "process_paypal.php",
                data: data,
                dataType: "json",
                success: function (data) { 
                alert(data.cmd);
                    $.post('https://www.paypal.com/cgi-bin/webscr', data);
            },
             error: function(jqXHR, textStatus, errorThrown) { 
                console.log(arguments); 
                alert(jqXHR + '-' + textStatus + '-' + errorThrown);
                return false;        
            }
        });
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:31:13.347

您可以通过以下方式将 json 对象转换为 key1=value1&key2=value2.. 等参数字符串

```
var result = decodeURIComponent($.param(data)); 
```

然后您可以将此结果传递给贝宝

```
$.ajax({
    type:'POST',
    ...
    data: result,
    ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:33:05.547

在将数据发送到 PayPal 之前，您需要使用[$.serialize()序列化数据，如下所示：](http://api.jquery.com/serialize/)

```
var data = {'plan_id' : plan_id};
$.ajax({
    ...
    data: $(data).serialize(),
    ...
}); 
```

通过序列化数据，您可以将其从对象转换为 PayPal 服务可以读取的编码字符串。

我希望这有帮助！

# c# - 在 ArrayList c# 中的某个位置插入

> ID：12805155
> 
> 赞同：1
> 
> 时间：2012-10-09T17:21:18.380
> 
> 标签：c#, c#-4.0, arraylist

```
ArrayList ArrAcc = new ArrayList(); 
string ArrValue = ClsContractAccount.GetAccount(LngContract, "R"); 
ArrAcc.Insert(1, ArrValue); 
```

当我尝试执行这个查询时得到一个 ArgumentOutOfRangeException 我的执行有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T17:23:20.253

您必须从 0 索引开始

```
ArrAcc.Insert(0, ArrValue); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:23:34.503

`ArrayList`索引是从 0 开始的，...所以你应该使用

```
ArrAcc.Insert(0, ArrValue); 
```

.... 或更好

```
ArrAcc.Add(ArrValue); 
```

顺便说一句，....您应该使用ArrayList的[通用](http://msdn.microsoft.com/en-us/library/512aeb7t.aspx)[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)版本：（ .NET 2.0+ 支持）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:38:48.743

来自[MSDN](http://msdn.microsoft.com/en-au/library/system.argumentoutofrangeexception%28v=vs.90%29.aspx)

> 当调用方法并且传递给该方法的至少一个 ?arguments 不为 null 且不包含有效值时，将引发 ArgumentOutOfRangeException。

可以使用您的代码如下：

```
ArrayList ArrAcc = new ArrayList(2) {"","" };
    string ArrValue = "Salam";
    ArrAcc.Insert(1, ArrValue) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T17:23:56.073

您不能插入未被占用的位置。您可以添加该项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T17:24:27.553

您的索引应该小于 Count 并且在 C# 中一切都是基于 0 的索引。所以，你应该有`ArrAcc.Insert(0, ArrValue);`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-09T17:30:46.267

必须从 0 开始。可以使用以下代码：

```
 if (index <= arr.Count)
            arr.Insert(index, "something");
        else
            arr.Add("something"); 
```

# codeigniter - 如何让 form_validation 在 Code Igniter 中正常工作

> ID：12805163
> 
> 赞同：0
> 
> 时间：2012-10-09T17:22:01.970
> 
> 标签：codeigniter, error-handling, validation

我非常接近放弃 Code Igniter 中的本机表单验证错误功能，因为我很难让它们正常工作。我的逻辑看起来像一个箭头，但是错误构成的行为确实让我陷入了基于我的逻辑的循环。

所以这里列出了正在发生的事情。

*当我在未填写任何字段的情况下提交表单时 = 无效的电子邮件和密码错误应该构成

*当我输入正确的电子邮件并将密码字段留空时=正确的无效密码错误构成，因为它应该

*当我输入正确的电子邮件和错误的密码时=页面加载为白色

*当我只输入密码字段=无效的电子邮件出现

*当我输入乱码电子邮件并将密码留空=无效电子邮件出现

有许多假罩组合正在发生。

如果正在输入的电子邮件在数据库中不存在，我还想让这些电子邮件在它识别的位置上是唯一的。

我已经被困在这个问题上太久了，真的需要一些帮助。我是代码点火器的新手，我真的很困惑为什么会发生这种情况。任何帮助是极大的赞赏。

这是我的代码：

形式：

```
<?php
echo form_open('auth/validate_credentials_login');
echo "<span class='errors_login'>";
echo form_error('email_login');
echo "</span>";
echo form_label('', 'Email', 'email_login');
$data = array( 'name' => 'email_login', 'class' => 'input', 'placeholder' => 'Email');
echo form_input($data, set_value('email_login'));
echo "<span class='errors_login'>";
echo form_error('password_login');
echo "</span>";
echo form_label('', 'Password;', 'password_login');
$data = array( 'name' => 'password_login', 'class' => 'input', 'placeholder' => 'Password');
echo form_password($data, set_value('sha1(password_login)'));
echo form_submit('submit_login', 'Login');
echo form_close();
?> 
```

控制器：

```
function validate_credentials_login()
        {
            $this->load->library('session');
            $this->load->helper(array('form','url'));
            $this->load->model('user_model', 'um');
            $this->load->library('encrypt');
            $this->load->library('form_validation');
            $this->form_validation->set_rules('email_login', 'Email', 'required');
            $this->form_validation->set_rules('password_login', 'Password', 'required');
            $login = $this->input->post('submit_login');

            if($login) {
                if($this->form_validation->run() == FALSE)
                {
                    $data['main_content'] = 'home/home_page';
                    $this->load->view('includes/templates/home_page_template', $data);
                }
                else 
                {
                    $user = $this->um->validate_home_login(array('email' => $this->input->post('email_login')));

                        if($user->password == $this->encrypt->sha1( $user->salt .           $this->encrypt->sha1($this->input->post('password_login')))) {
                            $this->session->set_userdata(array(
                                'email' => $this->input->post('email_login')
                                    ));
                                redirect('account/edit');
                                exit;
                            }
                        }
                    }
                } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T17:29:38.887

> 当我输入正确的电子邮件和错误的密码时=页面加载为白色

那是因为你在这里没有`else`条件：

```
if($user->password == $this->encrypt->sha1($user->salt.$this->encrypt->sha1($this->input->post('password_login')))) {
        $this->session->set_userdata(array(
            'email' => $this->input->post('email_login')
        ));
        redirect('account/edit');
        exit;
    }
}
// do nothing? 
```

您列表中的其他所有内容听起来都像是预期的行为，但您可能需要确保它`$this->um->validate_home_login()`正在做它应该做的事情。

附带说明一下，`exit`在调用之后无需`redirect()`这样做，它会为您执行此操作。

另外，`set_value('sha1(password_login)')`对我来说看起来很可疑，我认为它不像你想的那样。它将密码值设置为文字字符串`sha1(password_login)`。我不建议您预先填充密码字段 - 只需将其留空即可。

CI 的表单验证绝对没有被破坏，它实际上工作得很好，所以不要沮丧。[查看文档](http://codeigniter.com/user_guide/libraries/form_validation.html)并尝试一些更简单的东西可能是一个好主意，直​​到你可以让一切正常工作。

> 如果正在输入的电子邮件在数据库中不存在，我还想让这些电子邮件在它识别的位置上是唯一的。

查看`is_unique`规则：

[http://ellislab.com/codeigniter/user_guide/libraries/form_validation.html#rulereference](http://ellislab.com/codeigniter/user_guide/libraries/form_validation.html#rulereference)

```
$this->form_validation->set_rules(
    'email_login',
    'Email',
    'required|is_unique[your_table.your_email_field]'
); 
```

# magento - Magento：将其用作通用框架/CMS（BareBone Magento）

> ID：12805167
> 
> 赞同：2
> 
> 时间：2012-10-09T17:22:22.240
> 
> 标签：magento

我敢肯定我不是第一个这么想的人，但是......

1.  可以使用 magento 作为 FrameWork 吗？（肯定是的）
2.  为什么我不应该？
3.  我应该禁用什么我不应该禁用的模块？
4.  **如何破解安装程序**以仅安装某些模块（足以禁用它们 /etc/modules/ ...）？

这个想法是使用布局/模板和 MVC Magento 作为另一个应用程序的基础。

* * *

**更新**：这个想法是将 Magento 架构重用于购物车的其他目的：

1.  为新功能编写新模块。
2.  删除我不需要的模块

问题的重点是：

1.  **我可以删除哪个模块**以获得一种 BareBone Magento ？（只是带有布局/模板+ CMS的后端和前端）
2.  有**什么方法可以破解安装程序**以避免创建表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T21:28:00.633

我将支持芬奇的回答。Magento 的“CMS”功能充其量只是功能性的。如果您想管理内容，这确实是一个糟糕的 CMS。

Enterprise 在 CMS 方面有一些附加功能，但仍然不足以保证它是一个合适的 CMS。

当然，它当然可以扩展，并且可以构建自定义小部件，这将使它成为一个更加用户友好、客户端验证类型的网站（他们可以简单地填写表格来填充页面）。这需要更多的劳动，并且最终会奏效，但使用 Expression Engine 或其他适当的 CMS 会更容易。

如果您想走这条路，集成了 Wordpress 的 Magento 的 Fishpig 扩展也可以很好地工作。

与 Vinci 的评论相反，它很难用于电子商务以外的其他东西，这并不完全正确。类别/产品模型可以很容易地重新用于其他概念，特别是考虑到 Magento 支持虚拟产品。

您可以轻松地使用它来构建一个在线学习中心，其中“产品”只是附有一些文档/视频/等的虚拟产品。或者您可以关闭购物车/添加购物车/等并进入 PrestaShop 所谓的“目录模式”，在这种模式下没有任何东西可供购买，但您仍然有一个项目库。我已经通过我家的苗圃业务做到了这一点，该网站本质上是一个植物目录，以及大量的属性和分类等。按气候带、成熟高度等搜索。

每周至少有几次我会想到一个可以用 Magento 构建的新想法，但这并不一定意味着它是一个电子商务网站。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T22:03:15.213

我同意 Vinci 和 pspahn 的观点。我原以为 Magento 会做一个非常可怕的通用 CMS。然而，今年有两次我被委托这样做，两个 Magento 网站根本没有电子商务。

他们的理由是，他们将其视为比其他一些开源 CMS 更安全、更强大的企业级平台。如果/当他们开始在线销售时，它还可以轻松添加严肃的电子商务（而不是限制百出的插件）。

您还内置了非常好的用户帐户管理功能，API，自动备份......当您考虑它时，有很多好东西。

对于 Fishpig 的模块 +1，它会变得越来越好。

**编辑**

看看 Magento Lite，这就是你要找的；

[https://github.com/colinmollenhour/magento-lite](https://github.com/colinmollenhour/magento-lite)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T19:13:00.017

使用 Magento 作为框架 / CMS 将是一种矫枉过正，说实话 Magento 没有很好的 CMS 功能。如果你真的想要一个 CMS / 框架去 Drupal 或 Modx。Magento 的核心仍然是一个非常电子商务的应用程序，除了电子商务网站之外，它很难用于其他任何事情

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T10:01:23.373

我最近遇到了这家公司的销售代表[http://www.tangora.com/CMS.1580.aspx](http://www.tangora.com/CMS.1580.aspx) ，他说公司与大客户关系很好，因为他们有强大的基本 cms 并且能够满足客户的需求。

但是，即使您请求为您定制的东西并且有“秘密”实践，他们似乎也会对 saas 功能收费。

在与那个人交谈时，我认为 magento 对这些大公司来说会更好，因为他们在选择开发人员以及如何为产品付费等方面具有更大的灵活性。

也许你也应该观看这个视频，他谈到了 magento 1 和 2 中的耦合及其影响 [http://www.youtube.com/watch?v=Db7BW_RZ_0o](http://www.youtube.com/watch?v=Db7BW_RZ_0o)

# r - 扁平化列表列表的快速方法，同时仅保留每个子列表中的第一个元素

> ID：12805168
> 
> 赞同：4
> 
> 时间：2012-10-09T17:22:34.050
> 
> 标签：r

考虑创建列表列表的命令，如下所示：

```
myList <- list(a = list(1:5), b = "Z", c = NA) 
```

这会产生类似的东西：

```
 $a
 $a[[1]]
 [1] 1 2 3 4 5

 $b
 [1] "Z"

 $c
 [1] NA 
```

现在，当我不列出这个时，

```
unlist(myList, recursive = FALSE) 
```

我明白了

```
 $a
 [1] 1 2 3 4 5

 $b
 [1] "Z"

 $c
 [1] NA 
```

而我真正要寻找的是每个子列表中的第一个元素，即

```
 1
 "Z"
 NA 
```

循环非常慢。请不要循环。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T17:25:49.613

我想这取决于你认为什么是循环。例如，我将其称为循环，但也许对您来说没问题？

```
> sapply(unlist(myList, recursive=FALSE), "[", 1)
  a   b   c 
"1" "Z"  NA 
```

如果你不想要名字

```
> sapply(unlist(myList, recursive=FALSE, use.names=FALSE), "[", 1)
[1] "1" "Z" NA 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-09T17:48:42.397

@GSee 的解决方案可能是最常见的解决方案，但也有实现您正在寻找的`rapply()`功能（“*递归”）：`lapply()`*

```
rapply(myList, function(x) x[1], how = "unlist")
#   a   b   c 
# "1" "Z"  NA 
unname(rapply(myList, function(x) x[1], how = "unlist"))
# [1] "1" "Z" NA 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-09T17:26:32.240

尝试这个：

```
 rapply(myList, function(x) head(x,1) )
  a   b   c 
"1" "Z"  NA 
```

# oracle - oracle触发日志

> ID：12805181
> 
> 赞同：1
> 
> 时间：2012-10-09T17:23:26.500
> 
> 标签：oracle, logging, triggers

我有一个触发器，它应该测试打卡的人是否在过去 5 分钟内打卡。如果他们没有他们的信息，则应将其信息留在表 clk_data 中，否则应在日志表 utl_logbook 中进行记录，并且应中止对 clk_data 的插入。

当我打好一拳时，插件会像宣传的那样工作。当它是一个坏的一拳（最后一拳的 5 分钟内）时，我收到以下错误：

```
SQL Error: ORA-20101: Too Soon
ORA-06512: at "TRUTRACK.INSERT_CLK_DATA", line 14
ORA-04088: error during execution of trigger 'TRUTRACK.INSERT_CLK_DATA' 
```

事务已停止，但我在 utl_logbook 中没有记录。

```
The trigger code:
create or replace
TRIGGER "INSERT_CLK_DATA" 
BEFORE INSERT ON clk_data 
FOR EACH row 

BEGIN
  DECLARE qty INTEGER := 0;
  BEGIN
    SELECT COUNT(*)
    INTO qty
    FROM clk_data
    WHERE clk_time BETWEEN (:new.clk_time - 5/(24*60)) AND (:new.clk_time + 5/(24*60))
    AND :new.payroll = clk_data.payroll;

    IF qty > 0 THEN

      INSERT INTO utl_logbook (time, source, message) VALUES (sysdate, 'INSERT_CLK_DATA', 'Clock punch within restricted window. Payroll ID:' || :new.payroll || ' Time: ' || :new.clk_time || ' Type: ' || :new.type);

      RAISE_APPLICATION_ERROR(-20101, 'Too Soon');

    END IF;

  END;
END; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:58:57.730

这可能是您可以雇用的极少数情况之一`pragma autonomous_transaction`。它将允许您提交而不影响您的主要事务。谨慎使用。了解有关[自主事务](http://docs.oracle.com/cd/E11882_01/server.112/e10713/transact.htm#i7733)和[自主事务编译指示的更多信息](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/autonotransaction_pragma.htm)

这是一个例子：

```
 -- our error logging table 

   create table tb_log(
      msg varchar2(123)
    )
    /

   -- our working table
   create table tb_table(
     col11 number
    )
    /

-- procedure that is going to log errors

NK@XE> create or replace procedure log_error(p_msg in varchar2)
  2    is
  3      pragma autonomous_transaction;
  4    begin
  5      insert into tb_log(msg)
  6        values(p_msg);
  7      commit;
  8    end;
NK@XE> /

Procedure created.

NK@XE> create or replace trigger tr_tb_table
  2    before insert on tb_table
  3    for each row
  4    begin
  5      if mod(:new.col1, 2) != 0
  6      then
  7         log_error('Error!');
  8         raise_application_error(-20000, 'Error has ocurred!');
  9      end if;
 10    end;
 11  /

Trigger created.

NK@XE> select * from tb_log;

no rows selected

NK@XE> select * from tb_table;

no rows selected

NK@XE> insert into tb_table(col1) values(1);

insert into tb_table(col1) values(1)
            *
ERROR at line 1:
ORA-20000: Error has ocurred!
ORA-06512: at "NK.TR_TB_TABLE", line 5
ORA-04088: error during execution of trigger 'NK.TR_TB_TABLE'

NK@XE> select * from tb_log;

MSG
--------------------------------------------------------------------------------
Error! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:43:40.947

@nicholas-krasnov 提供了解决方案，只是为了详细说明推理-您在触发器主体中引发了异常：

```
RAISE_APPLICATION_ERROR(-20101, 'Too Soon'); 
```

这会导致事务回滚。可以找到完整的详细信息：

[http://psoug.org/reference/exception_handling.html](http://psoug.org/reference/exception_handling.html)

> 如果语句失败，Oracle 将回滚到保存点。通常，只是回滚失败的 SQL 语句，而不是整个事务。但是，如果语句引发未处理的异常，主机环境将确定回滚的内容。

# iphone - 用于制作全景图的 iOS API？

> ID：12805182
> 
> 赞同：1
> 
> 时间：2012-10-09T17:23:30.353
> 
> 标签：iphone, ios6, panoramas

有没有一种方法可以轻松地以编程方式在 iOS 中创建全景图？我想在我的 iPhone 应用程序中包含一种创建全景图的方法，利用 iOS6 的新全景图功能，所以我不必从头开始实现它。如果苹果不提供和API，有没有好的第三方库可以帮助制作全景图？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T13:23:08.770

你也可以试试这个 OpenCV 图像拼接项目：

[https://github.com/foundry/OpenCVStitch](https://github.com/foundry/OpenCVStitch)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T12:05:57.320

尝试使用相机使用计时器捕获图像并使用opencv缝合图像后

[openCV 2.4.3 iOS 框架编译器无法识别一些 C++ 头文件](https://stackoverflow.com/questions/13905471/opencv-2-4-3-ios-framework-compiler-trouble-recognising-some-c-headers)

# c# - 使用 dataadapter 从强类型数据列中检索单个单元格值

> ID：12805188
> 
> 赞同：0
> 
> 时间：2012-10-09T17:23:38.367
> 
> 标签：c#, asp.net, data-access-layer, dataadapter

我有一个数据适配器，它的方法接受一个变量并返回与该变量匹配的所有条目：

例如

```
TableAdaptor ta = new TableAdaptor();
DataTable dt = ta.GetUserByUserID(UserID); 
```

但我无法终生弄清楚如何从该方法返回单个单元格值。因为它是一个强类型的数据表，所以列名成为数据表的一个属性，所以我可以这样做：

```
dt.UserIDColumn.ToString(); 
```

但这会返回列的名称，而不是单元格的值。如果我尝试：

```
dt.Rows[0] 
```

根据 VS10 的智能感知，没有列属性。我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:46:03.453

好的，我假设您并没有真正声明 DataTable 类型的变量来保存您的强类型数据表，因为作为基类，它不会包含所有强类型列等。

试试这个：

```
StronglyTypedDataTable dt = ta.GetUserByUserID(UserID);   
StronglyTypedRow row = dt[0];
var value = row.ColumnName; 
```

如果没有记忆，强类型表将是可索引的，并且您将能够访问强类型数据行。这些将具有按名称表示单个单元格的强类型属性。

# actionscript-3 - Action Script 3.0 从另一个类中移动movieclip？

> ID：12805191
> 
> 赞同：1
> 
> 时间：2012-10-09T17:23:52.283
> 
> 标签：actionscript-3, class, object, multiple-instances

我有一个“Charselection”和“Charname”（与一个电影剪辑链接 - 扩展为字符选择）和“Charname2”（与另一个电影剪辑链接 - 扩展为字符选择）我有一些鼠标事件和东西，但我想知道，如何制作代码，以知道点击了哪一个。我尝试`var charname1 = this.name`然后跟踪它，它工作，但我想选择它作为对象，不知道名称。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:52:43.453

您可以通过以下方式进行：

假设您有一个`stage`链接到显示对象的变量，后者是“Charname”和“Charname2”的基础容器，您可以通过以下方式将鼠标事件侦听器分配给基础容器：

```
var stage:DisplayObject = new DisplayObject();
stage.addEventListener(MouseEvent.MOUSE_DOWN, select); 
```

...然后用于`event.target`获取被触发的对象：

```
function select(e:MouseEvent):void {
    trace(e.target);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:33:04.207

您可以使用发送到鼠标侦听器的 mouseEvent 对象，并获取事件目标。

# java - Mig 布局：对齐错误

> ID：12805195
> 
> 赞同：3
> 
> 时间：2012-10-09T17:24:04.940
> 
> 标签：java, swing, layout, miglayout

我对 Mig 布局有疑问。我已经开始重新创建 JFrame 的主 JPanel，我过去在其中使用了绝对布局。最初一切都很顺利（cfr 第二张图片）。控制台面板（带有选项卡面板的 Box 的一部分）具有良好的对齐方式，但仍然是绝对布局。当我开始将单个 JPanel 的布局转换为 Mig 布局时，它看起来像第一个图像（没有左对齐）。同样的结果也适用于我将绝对布局更改为 Mig 布局的其他 JPanel。

[http://i.stack.imgur.com/97Yop.png](https://i.stack.imgur.com/97Yop.png) [不好] [http://i.stack.imgur.com/KTLGK.png](https://i.stack.imgur.com/KTLGK.png) [好]

[http://i.stack.imgur.com/p3qWZ.png](https://i.stack.imgur.com/p3qWZ.png) [调试 1000 对齐]

这是我的框架类的简化版本。这个结构看起来很奇怪，因为我试图尽可能地减少它。我还删除了 ControlConsolePanel，因为我的问题甚至出现在带有 MigLayout 的默认 JPanel 上。

```
import java.awt.Color;
import java.awt.EventQueue;
import java.awt.Font;

import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTextArea;
import javax.swing.border.Border;
import javax.swing.border.TitledBorder;
import net.miginfocom.swing.MigLayout;

public class MainControll extends JFrame{

    private static final long serialVersionUID = 14L;
private JPanel configurationPane;
private JPanel feedbackPane;
private JTextArea feedback;
private JTabbedPane plotTabPane;
private JPanel consolePane;

public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run(){
            try {
                MainControll frame = new MainControll();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

public MainControll(){
    setTitle("test");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 860, 660);
    initiateComponents();
}

private Box rightPanel;

private void initiateComponents() {
        JPanel mainPanel = new JPanel();
        mainPanel.setLayout(new MigLayout("insets 0, debug 1000", "", ""));

            this.configurationPane = new JPanel();
            this.configurationPane.setBorder(getTitleBorder("Configuration"));
            this.configurationPane.setLayout(new MigLayout());

        this.plotTabPane = new JTabbedPane();
            this.plotTabPane.add("Tab1", new JPanel());
            this.consolePane = new JPanel(new MigLayout("","",""));
            // --> The MigLayout ruins the frame.
            // --> change it to this and look at the difference:
            //                  this.consolePane = new JPanel();
            this.consolePane.setBorder(getTitleBorder("Console"));

            this.feedback = new JTextArea();
        this.feedbackPane = new JPanel();
        this.feedbackPane.setBorder(getTitleBorder("Status"));
        this.feedbackPane.setLayout(new MigLayout());
        JScrollPane sbrText = new JScrollPane(this.feedback);
        this.feedbackPane.add(sbrText, "push, grow");

        this.rightPanel = new Box(BoxLayout.Y_AXIS);
        this.rightPanel.add(this.plotTabPane);
            this.rightPanel.add(this.consolePane);

        mainPanel.add(this.configurationPane, "shrinky, top, w 450!");
        mainPanel.add(this.rightPanel, "spany 5, wrap, grow, pushx, wmin 400");
        mainPanel.add(this.feedbackPane, "pushy, growy, w 450!");

        JScrollPane contentScrollPane = new JScrollPane(mainPanel);
        contentScrollPane.setBorder(BorderFactory.createEmptyBorder());
        setContentPane(contentScrollPane);
}

private Border getTitleBorder(String title){
    return BorderFactory.createTitledBorder(null, title, TitledBorder.LEFT,       TitledBorder.TOP, new Font("null", Font.BOLD, 12), Color.BLUE);
}
 } 
```

目标：关键是我希望控制台面板和绘图面板适合右侧面板而没有间隙（完美的边框对齐），根据右侧面板的增长和收缩行为进行扩展和收缩。

编辑：我最近发现了一个。如果我将 Mig 布局面板放在 JTabbedPane 中，它会起作用。如果我将 Mig 布局面板放在单独的 JPanel 中，它将不起作用。但是如何以及为什么，我没有一个线索。 ![在此处输入图像描述](../Images/086b7c2df618c0072db6f868536adc06.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T14:23:41.020

我认为问题`BoxLayout`在于您仍在使用。我添加了更多 MigLayout，现在它看起来像你想要的。

* * *

```
import java.awt.Color;
import java.awt.EventQueue;
import java.awt.Font;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTextArea;
import javax.swing.border.Border;
import javax.swing.border.TitledBorder;
import net.miginfocom.swing.MigLayout;

public class MainControl extends JFrame {

    private static final long serialVersionUID = 14L;
    private JPanel configurationPane;
    private JPanel feedbackPane;
    private JTextArea feedback;
    private JTabbedPane plotTabPane;
    private JPanel consolePane;
    private JPanel rightPanel;

    public MainControl() {
        setTitle("test");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 860, 660);
        initiateComponents();
    }

    private void initiateComponents() {
        JPanel mainPanel = new JPanel();

        configurationPane = new JPanel();
        configurationPane.setBorder(getTitleBorder("Configuration"));
        configurationPane.setLayout(new MigLayout());

        plotTabPane = new JTabbedPane();
        plotTabPane.add("Tab1", new JPanel());

        consolePane = new JPanel(new MigLayout("", "", ""));
        consolePane.setBorder(getTitleBorder("Console"));

        feedback = new JTextArea();
        feedbackPane = new JPanel();
        feedbackPane.setBorder(getTitleBorder("Status"));
        feedbackPane.setLayout(new MigLayout());
        JScrollPane sbrText = new JScrollPane(feedback);
        feedbackPane.add(sbrText, "push, grow");

        rightPanel = new JPanel(new MigLayout("fill"));
        rightPanel.add(plotTabPane, "grow, wrap");
        rightPanel.add(consolePane, "grow");

        mainPanel.setLayout(new MigLayout("insets 0, debug 1000", "", ""));
        mainPanel.add(configurationPane, "shrinky, top, w 450!");
        mainPanel.add(rightPanel, "spany 5, wrap, grow, pushx, wmin 380");
        mainPanel.add(feedbackPane, "pushy, growy, w 450!");

        JScrollPane contentScrollPane = new JScrollPane(mainPanel);
        contentScrollPane.setBorder(BorderFactory.createEmptyBorder());
        setContentPane(contentScrollPane);
    }

   private static Border getTitleBorder(String title) {
        return BorderFactory.createTitledBorder(null, title, TitledBorder.LEFT, TitledBorder.TOP, new Font("null", Font.BOLD, 12), Color.BLUE);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    MainControl frame = new MainControl();
                    frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }
} 
```

# c# - 将 Crystal Report 的数据源设置为 .dll 中的类

> ID：12805199
> 
> 赞同：0
> 
> 时间：2012-10-09T17:24:16.717
> 
> 标签：c#, crystal-reports

我正在使用 C#、Visual Studio 2008 和 Framework 2.0。

我的解决方案中有两个项目——一个 winform 项目和一个类库。我在winform项目中添加了一个水晶报表文件。但不能将其数据源设置为类库中的自定义对象。我还使用“数据-> 添加新数据源”从类库中添加了对象。

在水晶报表中，数据库字段-> 数据库专家-> .Net 对象不显示我的自定义对象。

有什么解决办法吗？？

问候， SK保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T18:02:39.547

您可以通过将水晶报表添加到类库中来显示数据对象，然后从该报表的数据库专家创建与数据对象的连接。当您返回应用程序并调出报告的数据库专家时，连接应该在那里。它们显示在“我的连接”而不是“项目 Data.NET 对象”下，但您仍然应该能够将它们添加到报告中。

# android - 在活动的片段中访问文本视图

> ID：12805203
> 
> 赞同：5
> 
> 时间：2012-10-09T17:24:30.847
> 
> 标签：android, android-fragments, communication

我想在 ActionBar 中使用 Fragments。不幸的是，它看起来真的很复杂。我的片段有文本视图，我希望能够在我的活动之外与它们进行交流。在我开始使用 Fragments 之前，我可以使用

```
private EditText editText = (EditText) findViewById(R.id.editTextName); 
```

因此，当用户单击保存时，我能够接收到 editText 值。我应该如何以片段方式执行此操作？

活动：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_add_recipe);
    getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    getSupportActionBar().setDisplayOptions(0, com.actionbarsherlock.app.ActionBar.DISPLAY_SHOW_HOME | com.actionbarsherlock.app.ActionBar.DISPLAY_USE_LOGO | com.actionbarsherlock.app.ActionBar.DISPLAY_SHOW_TITLE);

    ActionBar.Tab newTab0 = getSupportActionBar()
            .newTab()
            .setText(R.string.fragment_general)
            .setTabListener(
            new MyTabListener<GeneralFragment>(this, "general",
                            GeneralFragment.class));

    getSupportActionBar().addTab(newTab0);

}
public static class MyTabListener<T extends Fragment> implements
        TabListener {
    private Fragment mFragment;
    private final Activity mActivity;
    private final String mTag;
    private final Class<T> mClass;

    /**
     * * Constructor used each time a new tab is created. * * @param
     * activity * The host Activity, used to instantiate the fragment * @param
     * tag * The identifier tag for the fragment * @param clz * The
     * fragment's Class, used to instantiate the fragment
     */

    public MyTabListener(Activity activity, String tag, Class<T> clz) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
    }

    /* The following are each of the ActionBar.TabListener callbacks */

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        // Check if the fragment is already initialized
        if (mFragment == null) {
            // If not, instantiate and add it to the activity
            mFragment = Fragment.instantiate(mActivity, mClass.getName());
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            // If it exists, simply attach it in order to show it
            //ft.setCustomAnimations(android.R.animator.fade_in, R.animator.animationtest);
            ft.attach(mFragment);
        }
    }

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            //ft.setCustomAnimations(android.R.animator.fade_in, R.animator.test);
            ft.detach(mFragment);
        }
    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-09T17:49:20.553

您应该在 Fragment 上调用 getView()，然后在返回的视图上使用 findViewById()。

当然，在创建视图之前它不会返回任何内容，因此您可能必须在 onCreate 之外的其他地方调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:34:38.117

好吧，您需要扩充一个 xml 文件，或者从头开始创建一个，尽管我不推荐它，除非您喜欢额外的工作 :) 但是使用 Activity 会`setContentView()`扩充您的 xml 文件，然后`onCreate()`您可以访问它你习惯的方式。请注意，如果您尝试在没有父视图的情况下访问 onCreate 之外的布局视图，您将遇到同样的问题。除非你做了一个全局变量。由于 onCreate 是开发人员通常开始的地方，Android 可以轻松地从`findViewById`.

假设您有一个名为 edit.xml 的 xml 文件：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
//this method is found within your Fragment, which you must ovverride
View view = inflater.inflate(R.layout.edit, container, false);
private EditText editText = (EditText) view.findViewById(R.id.editTextName);
//...
} 
```

随意查看有关 Fragments 的 Android 文档，以更好地了解我为什么选择使用该方法而不是 Fragments`onCreate`等。

# sql - 如何包含此 SQL 子查询以获取绝对数字的值？

> ID：12805207
> 
> 赞同：1
> 
> 时间：2012-10-09T17:24:52.920
> 
> 标签：sql, ms-access

我为 Access DB 编写了这个查询。

```
queryText = "SELECT Technicians.ID, firstName, lastName, Technicians.[Zone],
COUNT(technicianAssignedId) AS JobsDone, 
MAX(Faults.timeCompleted) AS LastJobTime,
MIN(Technicians.[Zone] - & faultZone &) AS Distance ' MIN has no use
FROM Technicians LEFT OUTER JOIN Faults ON
Technicians.ID = Faults.technicianAssignedID 
WHERE Specialization = '" & specialization & "'
`AND Availability = 'available' 
GROUP BY Technicians.ID, firstName, lastName, Availability,` Technicians.[Zone], Specialization 
ORDER BY 7 DESC" 
```

我有这个来获得绝对值

```
SELECT CASE
WHEN value < 0 THEN value * -1
ELSE number *1 END
AS VALUE
FROM DB; 
```

现在，具有距离别名的列可能会以负数结束，我需要使用 (* -1) 作为正数，但我不知道如何将它们组合在一起。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T17:26:50.330

尝试

```
ABS(Technicians.[Zone] - & faultZone &) AS Distance 
```

参见[ABS 文档](http://office.microsoft.com/en-us/access-help/abs-funktion-HA001228718.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T17:27:10.077

为什么不能只使用绝对函数，`ABS`？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T19:37:04.753

ABS() 适用于所有 SQL 版本

# java - 没有重复的组合

> ID：12805211
> 
> 赞同：0
> 
> 时间：2012-10-09T17:25:46.007
> 
> 标签：java, permutation, combinations

首先，我非常抱歉我没有代码。那只是因为我还没有完全理解这个概念。

我希望能够编写一个小的 java 程序，它可以采用任何数字的有序列表，使得列表是 1 到数字。比如说我的数字是 9。我希望这个列表是`123456789`然后我想创建一个程序来创建这 9 个数字的每一个可能的组合。比如说另一个组合是`923456781`.

老实说，我不知道如何处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:32:54.767

我将第一个数字生成为字符串 123456789，然后对其进行置换。

有关排列，请参见[https://stackoverflow.com/a/12252782/509840](https://stackoverflow.com/a/12252782/509840)。

# javascript - document.createElement('script').src = 变量？可能吗？

> ID：12805212
> 
> 赞同：6
> 
> 时间：2012-10-09T17:25:46.967
> 
> 标签：javascript, javascript-events

是否可以创建类似于：

```
var jsfile = "code....";
(a=(b=document).createElement('script')).src=jsfile;
b.body.appendChild(a); 
```

其中 'jsfile' 就像一个外部 js 文件，但在我们的例子中是一个变量？

我所有的测试都失败了，我成功地获得了“jsfile”的输入，但是如果 obj 内部有函数（记住我希望它像外部 js 文件一样执行）它们没有执行。

测试示例：

```
var jsfile = "code....";
(a=(b=document).createElement('script')).text=(jsfile);
b.body.appendChild(a); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T17:34:39.610

Try setting a type on the script element, like so (taken from [Can't append <script> element](https://stackoverflow.com/questions/610995/jquery-cant-append-script-element)):

```
var script   = document.createElement("script");
script.type  = "text/javascript";
script.src   = "path/to/your/javascript.js";    // use this for linked script
script.text  = "alert('voila!');"               // use this for inline script
document.body.appendChild(script); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-09T17:36:20.573

是的，您可以，实际上，该`src`属性仅用于 javascript 文件路径，如果您想呈现代码，您可以使用该`innerText`属性：

```
var code = 'alert("working!")';
var script = document.createElement('script');
script.innerText = code;

document.body.appendChild(script); 
```

# wpf - 在 WPF 控件上复制背景颜色

> ID：12805215
> 
> 赞同：2
> 
> 时间：2012-10-09T17:25:51.440
> 
> 标签：wpf, styles

我编写了一个用户控件，它由一个 ListBox 和几个额外的控件组成。我想使用与标准 ListBox 相同的画笔将整个内容包裹在边框中。

[MSDN](http://msdn.microsoft.com/en-us/library/cc278062%28v=vs.95%29.aspx)有一个页面为 ListBox 提供了标准样式，但它具有硬编码的颜色，而标准 ListBox 在不同的平台上使用不同的样式或具有不同的主题。如何在我自己的控件中重新创建 ListBox 的边框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:39:03.390

我使用 Microsoft Expression Blend 创建了标准 ListBox 模板的副本。这就是我从中得到的...

```
<SolidColorBrush x:Key="ListBorder" Color="#828790"/>
<Style x:Key="ListBoxStyle2" TargetType="{x:Type ListBox}">
    <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
    <Setter Property="BorderBrush" Value="{StaticResource ListBorder}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ListBox}">
                <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="1" SnapsToDevicePixels="true">
                    <ScrollViewer Focusable="false" Padding="{TemplateBinding Padding}">
                        <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </ScrollViewer>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                    </Trigger>
                    <Trigger Property="IsGrouping" Value="true">
                        <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

您应该能够在此默认样式中使用相同的画笔来获取与当前主题相关的画笔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T14:57:21.837

我所做的是编写一个函数来提取控件的默认样式，以及该样式中的相关属性：

```
private static TReturn ExtractStyleProperty<TReturn, TFromControl>(string name, TReturn defVal)
{
  var style = Application.Current.FindResource(typeof(TFromControl)) as Style;
  if (style == null){
    return defVal;
  }
  var setter = style.Setters.Where(s => s is Setter).Cast<Setter>().First(s => s.Property.Name.Equals(name));
  if (setter == null){
    return defVal;
  }
  return (TReturn)setter.Value;
} 
```

有了它，我可以为要重新创建的每个属性创建一个属性：

```
public Brush ListBoxBorderBrush {
  get {
    return ExtractStyleProperty<Brush, ListBox>("BorderBrush", new SolidColorBrush(Color.FromRgb(130, 135, 144)));
  }
} 
```

然后将我的控件属性绑定到这些属性。这将获得适合系统和 WPF 主题的值。

# javascript - JavaScript 更改 bgcolor 和文本

> ID：12805216
> 
> 赞同：0
> 
> 时间：2012-10-09T17:25:50.947
> 
> 标签：javascript, text, background

我正在尝试更改整个文档的背景颜色，这应该可以。改变文字应该是一样的吧？我一直在弄乱代码，但我还没有找到一种简单的方法来编写更改代码。

```
<style>
function bgPick()
{
    if(document.displayOptions.value == 1){
        body.background-color:blue;
    }
    else if(document.displayOptions.value == 2){
        body.background-color:cyan;
    }
    else{
        body.background-color:white;
    }
}
</style>

<form name="displayOptions">
<select name="colorPick" onchange="bgPick()">
<option value=0>Background Color</option>
<option value=1>Blue</option>
<option value=2>Cyan</option>
<option value=3>White</option>
</select>
<select name="textPick">
<option value=0>Font Color</option>
<option value=1>Black</option>
<option value=2>Red</option>
<option value=3>Silver</option>
</select>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:27:19.717

你不应该在`<style>`标签之间插入脚本

在这里，有两个链接可以帮助您入门：

*   [CSS教程](http://www.w3schools.com/css/)
*   [Javascript教程](http://www.w3schools.com/js/default.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:11:06.217

RASG 是对的，你应该先阅读 JavaScript 教程，然后再尝试实现类似的东西......

```
<script>
function bgPick() {
    var select = document.querySelector("select[name='colorPick']"),
        color;
    switch (select.value) {
        case "1":  color = "blue";  break;
        case "2":  color = "cyan";  break;
        default:   color = "white"; break;
    }
    document.body.style.backgroundColor = color;
}
</script> 
```

# postgresql - EclipseLink 分区注释

> ID：12805221
> 
> 赞同：0
> 
> 时间：2012-10-09T17:26:12.130
> 
> 标签：postgresql, eclipselink

我正在用 EclipseLink 尝试@RoundRobinPartitioning。我看到一个奇怪的问题。我有一个在 Postgres 9.2 中插入模拟数据的测试（我有两个正在运行的 Postgres 9.2 实例）。复制工作正常（我已将 replicateWrites 设置为 true）。但是当我在集群上运行测试查询时 - 相同的查询在一个实例上运行比另一个实例更慢。当我查看查询计划时，两个数据库都为完全相同的数据/索引等生成了不同的查询计划。

任何想法为什么会发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T03:44:50.820

没关系 - 在桌子上运行分析和重新索引解决了这个问题。

# asp.net-mvc-3 - 将模型传递给表单中的动作方法

> ID：12805230
> 
> 赞同：1
> 
> 时间：2012-10-09T17:26:53.380
> 
> 标签：asp.net-mvc-3, razor, viewmodel, actionmethod

我有一个看起来像这样的视图

```
 @model UI.Models.BidOnAuctionViewModel

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@{
    var disableButton = Model.AuctionOpen ? "" : "bid-btn-disabled";         
}

@using (Html.BeginForm("ConfirmBid", "Lot"))
{
    <fieldset>
        @Html.HiddenFor(model => model.AuctionId)

        <p>
            <label >&pound;@Model.NextBidAmount</label>
        </p>
        <p>
            @if (Model.AuctionOpen)
            {
                 <input type="submit" value="Place bid" class="bid-btn @disableButton" />
            }
        </p>
    </fieldset>
} 
```

当我点击 Place bid 按钮时，我会转到 confirmBid 操作方法

```
[Authorize]
[HttpPost]
public ActionResult ConfirmBid(BidOnAuctionViewModel model) 
```

问题是即使在视图中模型不为空，但由于某种原因，它在此操作方法中为空。为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:49:41.990

分析您的代码后，我发现了问题。实际上，您只是在显示`NextBidAmount`. 当表单再次发布时，模型对象失去了它的价值。

要在模型中保留其值，只需为它创建一个隐藏字段，就像您已经完成的那样`AuctionId`

```
@Html.HiddenFor(model => model.NextBidAmount) 
```

这将解决您的问题。

# wordpress - Wordpress 没有显示 the_title()

> ID：12805233
> 
> 赞同：-1
> 
> 时间：2012-10-09T17:27:08.193
> 
> 标签：wordpress, wordpress-theming

```
<?php $loop = new WP_Query(array('post_type' => 'portfolio', 'posts_per_page' => 10)); ?>

<?php while ( $loop->have_posts() ) : $loop->the_post(); ?>
         <?php

              $post = get_post_meta($post->ID);
              $img = $post['image_url'][0];
              $web = $post['website_url'][0];
              echo get_the_title();
              the_title();
              the_content();

          ?>
<?php endwhile; ?> 
```

我正在尝试显示标题，内容显示正常，但标题有问题。我尝试过`the_title();`， `get_the_title();`但都不起作用。

**问题出在：**

```
$post = get_post_meta($post->ID); 
                  $img = $post['image_url'][0];
                  $web = $post['website_url'][0]; 
```

如果我删除，帖子标题显示正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T13:40:49.277

它不起作用，因为您在使用 get_post_meta 时会产生错误。您仅向该功能提供帖子 ID，您还需要提供密钥。

你应该像这样使用它：

```
$meta_values = get_post_meta($post_id, $key, $single); 
```

# debugging - 经典 ASP 中的 Server.GetLastError 返回什么？

> ID：12805236
> 
> 赞同：0
> 
> 时间：2012-10-09T17:27:13.467
> 
> 标签：debugging, asp-classic, getlasterror

我想知道函数 Server.GetLastError 在经典 ASP 中返回了什么样的对象。

如果这是一个 .net 或 JavaScript 函数，我只需附加一个调试器并查看返回的内容，但我没有任何工具可以在我工作的环境中使用 Classic ASP 代码执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T17:28:18.837

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms524846%28v=vs.90%29.aspx)：

> GetLastError 方法返回描述发生的错误情况的[ASPError 对象。](http://msdn.microsoft.com/en-us/library/ms524942%28v=vs.90%29.aspx)此方法仅在 .asp 文件向客户端发送任何内容之前可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:28:37.173

`Server.GetLastError`返回最后一个[`ASPError`对象](http://msdn.microsoft.com/en-us/library/ms524942%28v=vs.90%29.aspx)，表示服务器上发生的最后一个 ASP 错误。您可以在 MSDN 链接中查看对象的定义。

一般来说，您仍然可以在 MSDN 上查找 ASP 和 VBScript 对象和语法。

# java - 连接到外部数据库 - Android 应用程序

> ID：12805240
> 
> 赞同：18
> 
> 时间：2012-10-09T17:27:27.107
> 
> 标签：java, android, sql, database

我正在为我的第三年项目写一份申请。该应用程序将需要与外部 mySQL 数据库交互。应用程序将从数据库中检索数据并在 ListView 中将其显示给用户。

我很清楚应用程序将具有什么样的功能。我也花了很多时间使用 ListViews 和本地 SQLite 数据库。我还对 HttpUrlConnection 类做了一些研究。

我只是想知道是否有人能够就如何访问这个外部数据库向我提供更多指导？

是否需要我编写一个 Web 服务来处理交易？如果是这样，那会涉及什么，因为我还没有在我的课程中遇到过 Web 服务。

任何建议将不胜感激。此外，我的应用程序旨在用于 ICS v4.0.4。

感谢大家！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-09T17:40:41.197

是的，您必须创建 Web 服务才能与外部数据库（在您的情况下为 MySql）进行交互。在 PHP 中创建 Web 服务非常容易，因为它具有一个将您的数据库数据转换为 JSON 的功能，您可以轻松地解析 JSON 数据并将其显示在 Listview 中或相应地显示您的要求。

以下是一些有用的链接，可帮助您获取更多详细信息：-

[http://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/](http://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/) - 最好的

[http://www.coderzheaven.com/2011/04/08/android-phpmysql-connection/](http://www.coderzheaven.com/2011/04/08/android-phpmysql-connection/)

[http://blog.sptechnolab.com/2011/02/10/android/android-connecting-to-mysql-using-php/](http://blog.sptechnolab.com/2011/02/10/android/android-connecting-to-mysql-using-php/)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:35:23.363

I would recommend that your android application talks to a restful service (intermediary service that is talking to your database) that will return the database objects you require. so its not a direct connection to a database but its a good example on this type of connectivity.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:34:56.263

`Will it involve me having to write a web service to handle the transactions?`

Yes, if the database is not on the device, you will have to access it with network requests, which will have to handled by something.

`what would that involve?`

That depends on a lot of things. You can write a web service in pretty much any language you want as long as the server hosting it supports it. You could you Python, Ruby, PHP, Perl, Java, or .NET (if you have the framework) to name a few. Handling the actual database requests would have to be done on the server, which would return data back to your app - probably as JSON.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-17T21:57:25.050

[这个](http://androidhive.info/2012/05/how-to-connect-android-with-php-mysql)链接肯定很有帮助。完全按照此链接进行操作，但请确保按照此链接的[说明](http://www.mobitechie.com/android-2/how-to-access-localhost-on-android-over-wifi/)对**WAMP**服务器的`httpd.config`文件进行以下更改

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-31T21:40:32.197

您需要有一个虚拟主机来在线存储脚本。您可以在例如 php 中编写此脚本以在数据库中插入用户数据。在您的应用程序中使用 Volley 来处理脚本。获取用户数据后，调用脚本并收听结果：

*   这是用户第一次登录
*   用户已经注册
*   发生了错误

[例子](http://promote-your-app.com/blog/saving-user-data-external-database-android-php/)**

# php - 我的 .htaccess 文件有什么问题才能在 linux 上运行？

> ID：12805241
> 
> 赞同：0
> 
> 时间：2012-10-09T17:27:27.730
> 
> 标签：php, linux, .htaccess, codeigniter

我在 codeigniter 中有一个项目，我有一个 .htaccess 文件，用于向用户隐藏 index.php 页面。在本地机器上是当项目在 Windows 操作系统中时，但是当我在 linux（ubuntu 发行版）中测试时，.htaccess 功能不起作用。任何关于我可以为 linux 做什么的建议都非常感谢。我的 .htaccess 文件：

```
<IfModule mod_rewrite.c>

    RewriteEngine On
    RewriteBase /myproject/

    ### Canonicalize codeigniter URLs

    # If your default controller is something other than
    # "welcome" you should probably change this
    RewriteRule ^(platform(/index)?)/?$ / [L,R=301]
    RewriteRule ^(.*)/index/?$ $1 [L,R=301]

    # Removes trailing slashes (prevents SEO duplicate content issues)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)/$ $1 [L,R=301]

    # Enforce www
    # If you have subdomains, you can add them to
    # the list using the "|" (OR) regex operator
   RewriteCond %{HTTP_HOST} !^(localhost|myproject) [NC]
   RewriteRule ^(.*)$ http://localhost/myproject/$1 [L,R=301]

    # Removes access to the system folder by users.
    # Additionally this will allow you to create a System.php controller,
    # previously this would not have been possible.
    # 'system' can be replaced if you have renamed your system folder.
    RewriteCond %{REQUEST_URI} ^system.*
    RewriteRule ^(.*)$ /index.php/$1 [L]

    # Checks to see if the user is attempting to access a valid file,
    # such as an image or css document, if this isn't true it sends the
    # request to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L]

</IfModule>

<IfModule !mod_rewrite.c>

    # Without mod_rewrite, route 404's to the front controller
    ErrorDocument 404 /index.php

</IfModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:38:55.783

这有很多原因，但我总是首先检查的原因：

**允许覆盖**

检查您的主要 Apache 配置。默认情况下，您的文档根目录的 AllowOverride 指令可能设置为 none。在这种情况下，Apache 将忽略 htaccess 文件。

[http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride](http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride)

**模块缺失**

由于您的命令包含在 IfModule 语句中。如果您的 Linux 机器没有该模块，则不会执行该命令。

**小费**

要查看是否正在读取 htacess，只需在任何 ifmodule 语句之外的文件顶部添加一些废话，例如“dkdkwei239d”或任何不是合法指令的内容。

您应该收到 500 服务器错误。如果不是，则 Apache 没有读取 .htaccess 文件。

如果您确实收到 500 错误，则 Apache 正在读取该文件。

尝试删除 Ifmodule 语句。如果错误返回，那么您可能缺少重写模块。

# iphone - UIPageViewController 中可爱而又隐蔽的翻页效果

> ID：12805244
> 
> 赞同：1
> 
> 时间：2012-10-09T17:27:34.007
> 
> 标签：iphone, ios, cocoa-touch

我正在使用 UIPageViewController 在 iPhone/iPad 应用程序中显示一些页面。现在，当用户按下按钮时，我想转到某个随机页面；这里重要的是我想向正在浏览“几个”页面的用户“展示”。我确实在 Stackoverflow 中查找了几个答案并尝试了它们。能够模拟的最好的和唯一的事情是通过这个片段以编程方式打开“一个”页面（即用户看到一个页面翻页）：

```
[self.pageViewController 
         setViewControllers:[NSArray arrayWithArray:array]  
   direction:UIPageViewControllerNavigationDirectionForward 
         animated:YES completion:nil]; 
```

现在，我想显示“几个”翻页；即表示用户在第 2 页；然后，当转到第 5 页时，目前它只显示一页，尽管第 2 页和第 5 页之间有“3”页。

我尝试引入具有周期性延迟的 NSTimer。计时器会转到一页，然后延迟，然后转到另一页，然后延迟（重复，例如，3 次），以便用户获得“几页”翻页的“效果”。

```
[NSTimer scheduledTimerWithTimeInterval:0.2f target:self selector:@selector(goToRandomPage) userInfo:nil repeats:NO]; 
```

但这只会显示“最后”一页。也就是说，假设计时器被触发一次以显示第 8 页，然后延迟 0.2，然后显示第 3 页，然后延迟 0.2，然后显示第 6 页。实际显示的内容（即用户看到的内容）又是只翻了一页，即最后一页（翻到第 6 页）。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:04:32.510

一种选择是动态设置`array`一次一页，并在`completion`块中尝试调用相同的`setViewControllers`方法。每次`setViewControllers`调用`array`对象时都应修改为仅具有下一页。`Completion`块应确保当前动画已完成，您可以开始下一个动画。`completion`一旦到达所需的页面，在块内添加一些条件检查以打破这一点。我还没有尝试过，但这应该会引导你走向正确的方向。

```
[self.pageViewController 
         setViewControllers:[NSArray arrayWithArray:array]  
   direction:UIPageViewControllerNavigationDirectionForward 
         animated:YES completion:^{/* call the same method and modify array */}]; 
```

# c++ - 链接 Fortran 和 C++ 库时优化丢失？

> ID：12805245
> 
> 赞同：1
> 
> 时间：2012-10-09T17:27:35.920
> 
> 标签：c++, optimization, linker, fortran

我们在 Visual Studio 2010 中有一个大型解决方案，其中包括一个 Fortran exe 和多个 Fortran 和 C++ 静态库项目：

```
FORTRAN EXE --> MY_LIB (C++)
--> MY_LIB_2 (C++)
--> MY_LIB_3 (Fortran) 
```

在修改 C++ 静态库依赖项后，我们遇到了 EXE 的运行时性能下降约 50% 的问题。

一切都运行良好，直到我们在其中一个 C++ 库中引用了一些额外的头文件。这些头文件包含在一个项目中，该项目不包含任何源文件，仅包含 C++ 头文件，因此不会产生任何自己的编译输出：

```
FORTRAN EXE --> MY_LIB (C++, now includes headers from headers-only project)
--> MY_LIB_2 (C++)
--> MY_LIB_3 (Fortran) 
```

仅标头方面很重要的原因是，除非它包含源代码（.c/.cpp 文件）并产生一些输出，否则无法在项目属性中为 C++ 项目设置优化。但是，当包含在其他地方时，标头将受到与包含项目相同的优化。我们没有在禁用优化的代码中做任何事情（例如使用编译指示）。

更改后，我们的代码现在运行速度慢了大约 50%。我们只在新包含的标头中调用了一个函数，该函数的开销很小，并且不考虑减速。AQTime 中的分析表明，整个代码的减速是一致的。

我认为可能导致这种情况的原因是无意中禁用了优化。在链接 Fortran EXE 时，我们收到大量 C4748 警告，关于在新包含的标头中定义的各种功能中禁用优化，以及其他 cpp 文件也包含它们（我们没有收到这些在包括附加标题之前）：

```
------ Build started: Project: FortranEXEProject, Configuration: Release Win32 ------
Linking...
   Creating library D:\Source\Release\FortranEXEProject.lib and object D:\Source\Release\FortranEXEProject.exp
Generating code
c:\program files (x86)\microsoft visual studio 10.0\vc\include\memory(620) : warning C4748: /GS can not protect parameters and local variables from local buffer overrun because optimizations are disabled in function
d:\Source\CPPHeaderLibrary\header1.hpp(3231) : warning C4748: /GS can not protect parameters and local variables from local buffer overrun because optimizations are disabled in function
d:\Source\CPPSourceLibrary\source.cpp(54) : warning C4748: /GS can not protect parameters and local variables from local buffer overrun because optimizations are disabled in function 
```

所有项目都启用了优化并使用链接时代码生成 (/LTCG)。

进程资源管理器显示 Fortran 链接器 XLink.exe 正在调用 C++ 链接器 LINK.exe。

谁能解释这里发生了什么，以及如何确保在 Fortran 中维护链接 C++ 代码中的优化？

我们正在使用英特尔 Fortran Composer XE 2011。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T12:49:09.147

最后，我们注意到在我们的几个 C++ 静态库项目中禁用了优化，在调用图的下方，包括新的标头。这发生在添加新标头之前的一段时间，但显然只有在链接新代码时才会发现性能损失。重新开启优化已经解决了这个问题；让我们分心的是 LINK.EXE 被 XLINK 调用 - 原来 link.exe 只是 windows 链接器 - 它不是 C++ 特定的。

# c# - Fluent NHibernate 的 Length 属性在更新时不起作用

> ID：12805248
> 
> 赞同：4
> 
> 时间：2012-10-09T17:27:37.247
> 
> 标签：c#, nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我有下一个映射，我在其中指定一些字符串字段的长度：

```
public ResolutionMap()
{
  Schema("dbo");
  Table("Resolution");
  Id(x => x.IdResolution, "resolution_id").UnsavedValue(0).GeneratedBy.Identity();
  Component(x => x.Store, m =>
    {
      m.Map(y => y.StoreCodeId, "store_code_id");
      m.Map(y => y.StoreCode, "store_code").Length(10);
    }
  );
  Map(x => x.ResolutionData, "resolution_data").Length(42);
} 
```

但是，当我观察在 SQL Server Profiler 上执行的更新查询时，我发现在映射上设置的长度在参数声明中根本没有得到尊重：

```
exec sp_executesql
  N'UPDATE dbo.Resolution SET resolution_data = @p0, store_code_id = @p1, store_code = @p2 WHERE resolution_id = @p3',
  N'@p0 nvarchar(4000),@p1 int,@p2 nvarchar(4000),@p3 int',
  @p0=N'Test',@p1=89,@p2=N'ST000003',@p3=275 
```

为什么会发生这种情况？我需要设置长度，因为这会减慢更新过程。

我目前在 .NET Framework 3.5 上使用 Fluent NHibernate 1.3.0.733 和 NHibernate 3.3.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:37:44.220

显然，`Length(x)`仅当您从映射生成数据库模式时才使用。

NHibernate 不会让您将属性保存到涉及截断的列中，将引发异常。

`"String or binary data would be truncated. The statement has been terminated."`

字符串的基本类型是什么？字符串总是相同的长度还是不同？`varchar(x)`例如。

您可以指定长度，例如：

`Map(x => x.StoreCode).CustomSqlType("varchar (512)");`等等

或者可以创建一个约定来设置默认字符串长度：

```
public class DefaultStringLengthConvention: IPropertyConvention
{
  public void Apply(IPropertyInstance instance)
  {
    instance.Length(250);
  }
} 
```

有关更多信息，请参阅：

[为长文本字符串覆盖流利的 NHibernate nvarchar(MAX) 而不是 nvarchar(255)](https://stackoverflow.com/questions/2343105/override-for-fluent-nhibernate-for-long-text-strings-nvarcharmax-not-nvarchar)

[http://marcinobel.com/index.php/fluent-nhibernate-conventions-examples/](http://marcinobel.com/index.php/fluent-nhibernate-conventions-examples/) - StringColumnLengthConvention

[https://github.com/jagregory/fluent-nhibernate/wiki/Auto-mapping](https://github.com/jagregory/fluent-nhibernate/wiki/Auto-mapping)

[https://github.com/jagregory/fluent-nhibernate/wiki/Conventions](https://github.com/jagregory/fluent-nhibernate/wiki/Conventions)

# ios - Monotouch.Dialog IOS 6拆分视图旋转问题

> ID：12805250
> 
> 赞同：2
> 
> 时间：2012-10-09T17:27:42.417
> 
> 标签：ios, xamarin.ios, ios6, monotouch.dialog, autorotate

BUMP .. 还没有弄清楚，东西在旋转，但不在视线范围内。太奇怪了。我可以提供更好的信息以获得帮助吗？

仍然有这个问题！真的很糟糕，我无法解决这个问题:(请帮助

BUMP ..请我死在这里！任何人！:)

所以，我正在使用`Monotouch.Dialog`并且从 IOS 6 开始，我的 splitview 控制器的旋转行为很奇怪。

它实际上是在旋转，但我的详细视图占据了整个屏幕，而主视图似乎被旋转出了屏幕框架。也就是说，当它旋转时我可以看到主视图一秒钟然后它就消失了，而细节视图占据了整个屏幕。

我已经添加了必要的`ShouldAutorotate`功能并设置了`GetSupportedInterfaceOrientations`自 IOS 6 以来。就像我说的它旋转，但有些东西刚刚关闭。

我试过IOS 5模拟器，它可以工作，所以这绝对是IOS 6的问题。

任何人都知道我应该在哪里寻找问题？

编辑：我在调试时注意到它不会进入我的主视图和详细视图的 ShouldAutorotate 覆盖，只有在我的拆分视图控制器中才会进入。在 iOS 5 中，它会正确进入 ShouldAutorotateToInterfaceOrientation。

这是我在详细视图和主视图中使用的代码：

```
public override bool ShouldAutorotate()
    {
        return true;
    }
    [Obsolete]
    public override bool ShouldAutorotateToInterfaceOrientation       (MonoTouch.UIKit.UIInterfaceOrientation toInterfaceOrientation)
    {
        return true;
    } 
```

这是我的 SplitViewController 中的代码：

```
public override bool ShouldAutorotate()
    {
        return true;
    }

    [Obsolete]
    public override bool ShouldAutorotateToInterfaceOrientation(UIInterfaceOrientation requested)
    {
        return requested == UIInterfaceOrientation.LandscapeRight || requested == UIInterfaceOrientation.LandscapeLeft;
        //return requested == UIInterfaceOrientation.Portrait || requested == UIInterfaceOrientation.PortraitUpsideDown;

    }

    public override bool ShouldAutomaticallyForwardRotationMethods {
        get {
            return true;
        }
    } 
```

请问有人吗？我的工作需要这个，但我无法解决这个问题！任何想法都会有所帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:08:55.573

不看代码本身就很难猜出哪里出了问题。它很可能在 iOS 5.x 上运行，因为它将调用旧的[`shouldAutorotateToInterfaceOrientation:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/UIViewController/shouldAutorotateToInterfaceOrientation%3a)选择器（并且因为您的应用程序和/或 MonoTouch.Dialog 已经支持它）。

这在 iOS6 中已被**弃用**- 但仍会调用它**以实现向后兼容性**，除非您实现它的替换。注意 Apple 文档中的复数形式*replaces*：

> 改写supportedInterfaceOrientations 和preferredInterfaceOrientationForPresentation 方法。）

弃用通知并不意味着 iOS6 不能与旧 API 一起使用。剩下的就是添加了一些新的、更好的 API，并且旧的 API*可以*在未来的一些 iOS 版本中删除（到目前为止，删除非常少见）。

注意：我鼓励您停止使用您不支持的 iOS 版本的旧 API（例如，在 iOS 4.0 中不推荐使用的东西应该在仅支持 5.0 及更高版本的应用程序中使用）。然而，复制代码以支持 5.0 和 6.0的*最佳*API 可能不是一个好主意，除非您从中获得一些东西（例如新功能）。

大多数新 API（弃用旧 API）都是为了让您的生活更轻松，而不是更难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T14:12:37.497

也不要忘记设置`window.rootViewController`（否则旋转在 iPad 上不起作用）。

# jquery - Javascript 包括使用 Rails 3.1 和 JQuery 放置

> ID：12805252
> 
> 赞同：0
> 
> 时间：2012-10-09T17:27:50.577
> 
> 标签：jquery, ruby-on-rails-3, twitter-bootstrap

我似乎无法找到一个明确的答案，我相信我不是第一个或最后一个为此烦恼的人。

当前的最佳实践建议将 javascripts 放在页面底部。但是，任何使用正确触发的块`$(function() {...});`都将无法找到 $。

虽然它不仅仅针对 twitter 引导程序，但我将其用于我的布局等。twitter 生成的应用程序布局将脚本移到了底部。

因此，在处理块之前，JQuery 需要存在于页面中。

仅将 JQuery 库分开并通过页面末尾的 application.js 将其包含在头部和其余部分中更好，还是允许资产管道创建一个文件并一次发送所有文件更好？

显然，存在权衡，但普遍的共识是什么？

答案：将您的 javascript 从 html 中移出并放入外部文件中……这并不是我所希望的 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:50:48.363

资产管道应该将所有必要的 JavaScript 编译成尽可能少的文件，为这些文件提供服务。这些文件应包含 jQuery，并应放置在`head`布局的标签中。

也许[资产管道指南](http://guides.rubyonrails.org/asset_pipeline.html)会有所帮助？

# objective-c - 对象释放后保留计数和零值

> ID：12805264
> 
> 赞同：-1
> 
> 时间：2012-10-09T17:28:53.970
> 
> 标签：objective-c

> **可能重复：**
> [引用计数在 [obj 释放] 之后仍为 1，此时应将其释放](https://stackoverflow.com/questions/5204986/reference-count-is-still-1-after-obj-release-when-it-should-be-deallocated)

1.当我写这段代码时。

```
UILabel *label = [[UILabel alloc]initWithFrame:CGRectMake(10, 10, 100, 30)];
[self.view addSubview:label];
label.text =@"label Text";

 [label release];
 [label release];

 NSLog(@"LableRetainCount = %i \n",lable.retainCount); 
```

输出：LableRetainCount 1.Lable 保留计数不从 1 减少，为什么？

2.当我写这段代码时。

```
 UILabel *label = [[UILabel alloc]initWithFrame:CGRectMake(10, 10, 100, 30)];
   [self.view addSubview:lable];
   label.text =@"lable Text";

  label = nil;
  NSLog(@"LabelRetainCount = %i \n",label.retainCount); 
```

输出：LabelRetainCount = 0 当我设置“label = nil”时，它的保留计数变为 0 为什么？这意味着该对象的内存释放了吗？

2.  对象是否释放？
3.  现在我们不是需要发布了吗？
4.  retainCount 方法永远不能返回 0。这是否意味着释放后对象还活着？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:35:00.993

在＃2中它返回0，因为您将标签指针设置为nil，即0，当您在nil上调用函数时，它返回nil，即0。所以它并没有真正返回retainCount，它只是返回nil。将 label 设置为 nil 后，您必须了解它不再指向您的 UILabel ...

在 #1 上，如果您想正确释放它，就像一直到 0 一样，首先您将在 .text 行之后执行此操作：

```
[label removeFromSuperview]; // remove the view that you added, view will release it
[label release]; 
```

然后你的保留计数应该是 0 并且对象将被释放。

# javascript - 如何在 CRM Dynamics 中使用外部 Javascript 库？

> ID：12805267
> 
> 赞同：0
> 
> 时间：2012-10-09T17:29:12.537
> 
> 标签：javascript, dynamics-crm-2011, datajs

我将做一些 REST-ing 和 oData-ing，所以我从[DataJS project](http://datajs.codeplex.com/wikipage?title=OData%20Code%20Snippets&referringTitle=Using%20OData)获得了可执行文件。我已将该文件添加`datajs-1.0.3.min.js`为 Web 资源，并将我自己的文件添加`qwerty.js`为另一个。所以，我最终得到了两个名为：

1.  CRMKonsulterna_MyOwnStuff
2.  CRMKonsulterna_TheCoolStuff

现在的问题是，当我从我在[他们的网站](http://datajs.codeplex.com/wikipage?title=OData%20Code%20Snippets&referringTitle=Using%20OData)上找到的网络资源 1 执行下面的代码片段时，我得到一个崩溃告诉我：

领域：窗户

事件：加载

错误：“OData”未定义

```
var shazoo = function () {

  alert("Commenced...");

  OData.read(
    "http://services.odata.org/Northwind/Northwind.svc/Categories",
    function (data) {
      var html = "";
        $.each(data.results, function (l) { 
          html += "<div>" + l.CategoryName + "</div>";
        });
        $(html).appendTo($("#target-element-id"));
    }
  );

  alert("Completed.");

} 
```

如何从 Web 资源 1 中的方法引用 Web 资源 2 中的方法？我找到[了这个讨论](https://stackoverflow.com/questions/4994083/how-do-you-have-multiple-javascript-libraries-in-dynamics-crm-2011)，但它并没有给我太多。我什至不知道**如果**一个人理解他们在说什么是否有帮助。

编辑

我已经进行了一些更改，并尝试`OData`了我的方法是否知道这样的方法。

```
alert(OData); 
```

期待一个`null`值，我惊讶地发现它给了我 {Object object} 。所以，我猜测网络资源之间的联系已经建立。是这样吗？另外，我怎样才能打电话给我一些 oData 格式的数据？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:54:47.467

您是否将**两个**库都添加到实体中？仅将它们添加为 Web 资源是不够的。

1.  设置 -> 解决方案 ->
2.  {pick the solution} ->**或**自定义 -> 自定义系统 ->
3.  组件 -> 实体 -> {选择实体} -> 表单 -> {选择表单类型}
4.  表单属性 -> 表单库

# sql - 将 datetime 存储过程参数转换为动态 T-SQL 查询中的过滤器（在 WHERE 子句中）

> ID：12805269
> 
> 赞同：2
> 
> 时间：2012-10-09T17:29:16.670
> 
> 标签：sql, sql-server-2008, tsql, datetime, dynamic-sql

下面我有一段来自我试图动态化的存储过程的代码。这意味着我想运行`EXEC('select * from table_name WHERE filter=something')`以将结果集返回到我的 Web 服务。我正在查询的表中的 week_start_date 字段是日期时间字段，而不是日期字段。如何正确地将 datetime 参数附加到动态 SQL，以便它在查询中正确解释它？另外，如果您对如何使代码更清洁有任何建议，我会接受建议。

**当我查看数据时，我的值如下所示：**

```
2012-08-10 00:00:00.000 
```

**不工作的 T-SQL 代码：**

```
ALTER PROCEDURE [dbo].[logged_time_by_week]
    @week_start_date_filter datetime = null
AS
BEGIN 
```

……

```
 DECLARE @select_clause nvarchar(4000);
    DECLARE @from_clause nvarchar(4000);
    DECLARE @where_clause nvarchar(4000);
    DECLARE @order_clause nvarchar(4000);

    SET @select_clause = 
        ' SELECT '
        + ' [sunday_hours],'
        + ' [monday_hours],'
        + ' [tuesday_hours],'
        + ' [wednesday_hours],'
        + ' [thursday_hours],'
        + ' [friday_hours],'
        + ' [saturday_hours]'

    SET @from_clause =
        ' FROM '
        + ' [timesheet_row] '

    SET @where_clause = ''

    IF @week_start_date_filter IS NOT NULL AND @week_start_date_filter != ''
    BEGIN 
        IF @where_clause != ''
        BEGIN
            SET @where_clause = @where_clause + ' AND ' 
        END
        SET @where_clause = @where_clause + ' [week_start_date] = ' + CONVERT(nvarchar, @week_start_date_filter)
    END

    IF @where_clause != '' 
    BEGIN
        SET @where_clause = ' WHERE ' + @where_clause
    END

    SET @order_clause = ' ORDER BY [' + @sort_column + '] ' + @sort_direction

    EXEC(@select_clause + @from_clause + @where_clause + @order_clause) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:14:34.233

我认为这应该让你走上正确的道路：

```
declare @dtValue datetime = '2012-10-02 15:34:53'
declare @CRLF    char(2)  = char(0x0D) + char(0x0A)
declare @QT1     char(1)  = ''''
declare @dtFrom  datetime      = convert(date,@dtValue,112)
declare @dtThru  datetime      = dateadd(ms,-3,dateadd(day,1,@dtFrom))
declare @sql     varchar(8000)

select @sql = 'select *'            + @CRLF
            + 'from sys.objects so' + @CRLF
            + 'where so.create_date between '
            + quotename( convert(varchar,@dtFrom,126) , @QT1 )
            + ' and '
            + quotename( convert(varchar,@dtThru,126) , @QT1 )

select sqlCommand = @sql

exec ( @sql ) 
```

上面的代码会生成这个sql：

```
select *
from sys.objects so
where so.create_date between '2012-10-02T00:00:00' and '2012-10-02T23:59:59.997' 
```

奇怪的上限是由于 SQL Server 奇怪的时间概念，其中一分钟的最后一个“滴答”是 997 毫秒，任何大于该值的毫秒值都会向上舍入到下一分钟（所以 2012 年 10 月 2 日 23:59:59.999实际上是 2012 年 10 月 3 日 00:00:00.000)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T17:56:16.667

解决此类错误的最简单方法是打印生成的 sql 以查看其失败的原因。

只需查看您的查询，我相信您只需要修复 @week_start_date_filter 变量周围的引号。

```
declare @week_start_date_filter datetime = getdate();
print ' [week_start_date] = ''' + CONVERT(nvarchar, @week_start_date_filter) + ''''; 
```

另外作为旁注，如果您必须使用动态 sql，我建议改为使用参数化 sql。这是一个使用 sys.objects 的示例，因为我不知道您的表的架构。

```
DECLARE
    @week_start_date_filter datetime    = (SELECT TOP(1) [create_date] FROM sys.objects),
    @sort_column            sysname     = N'create_date',
    @sort_direction         nvarchar(3) = N'ASC';

    DECLARE @select_clause nvarchar(4000);
    DECLARE @from_clause nvarchar(4000);
    DECLARE @where_clause nvarchar(4000);
    DECLARE @order_clause nvarchar(4000);

    SET @select_clause = 
        ' SELECT TOP(1) '
        + ' *';

    SET @from_clause =
        ' FROM '
        + ' sys.objects'

    SET @where_clause = ''

    IF @week_start_date_filter IS NOT NULL AND @week_start_date_filter != ''
    BEGIN 
        IF @where_clause != ''
        BEGIN
            SET @where_clause = @where_clause + ' AND ' 
        END
        SET @where_clause = @where_clause + ' [create_date] = @date_filter'
    END

    IF @where_clause != '' 
    BEGIN
        SET @where_clause = ' WHERE ' + @where_clause
    END

    SET @order_clause = ' ORDER BY [' + @sort_column + '] ' + @sort_direction

    DECLARE
        @SQL    nvarchar(max) = @select_clause + @from_clause + @where_clause + @order_clause,
        @Params nvarchar(200) = N'@date_filter datetime';

    EXEC sp_executesql
        @stmt        = @SQL,
        @params      = @Params,
        @date_filter = @week_start_date_filter; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T18:20:06.123

我认为这应该适用于 where 子句..

```
SET @where_clause = @where_clause + 
' [week_start_date] = CONVERT(datetime, ' + @week_start_date_filter + ')' 
```

如果你的 week_start_date 列不是日期时间类型，那么它也需要像上面那样转换..

# c# - 如何使用 FormsAuthentication 检测经过身份验证的用户？

> ID：12805275
> 
> 赞同：-3
> 
> 时间：2012-10-09T17:29:41.490
> 
> 标签：c#, asp.net, .net

如何判断用户是否使用 FormsAuthentication 进行了身份验证（登录）？

```
<authenticaion mode="Forms">
   <forms protection="All" cookieless="UseCookies"/>
</authentication> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T17:35:50.713

To check whether the user is logged in you can use `HttpContext.Current.User.Identity.IsAuthenticated`.

Authentication type can be found out by `HttpContext.Current.User.Identity.AuthenticationType` to know the authentication type used

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:38:20.377

您可以使用此代码 - 基于`FormsIdentity`类

链接：http: [//msdn.microsoft.com/fr-fr/library/system.web.security.formsidentity.aspx](http://msdn.microsoft.com/fr-fr/library/system.web.security.formsidentity.aspx)

```
if (HttpContext.Current.User != null)
  {
    if (HttpContext.Current.User.Identity.IsAuthenticated)
    {
     if (HttpContext.Current.User.Identity is FormsIdentity)
     {
         .....
     }
    }
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:37:29.320

一种可能的方法是在 web.config中使用***FormsAuthenticationModule模块并创建表单身份验证 cookie。***

您可以参考[解释：ASP.NET 2.0 中的表单身份验证](http://msdn.microsoft.com/en-us/library/ff647070.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T17:36:12.113

不确定这就是您的意思，但是在服务器端代码上：

Page.User.Identity.IsAuthenticated

# vba - 将 URL 插入文本框

> ID：12805279
> 
> 赞同：0
> 
> 时间：2012-10-09T17:29:55.953
> 
> 标签：vba, excel

我在将 url 插入我的 TextBox 时遇到问题。

这是我的代码：

```
Sub GetOpenFile()

Dim fileStr As String

fileStr = Application.GetOpenFilename()
TextBox1.Text = fileStr

End Sub 
```

我想浏览一个文件，浏览后我希望该文件的名称出现在 TextBox 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:49:15.760

我错过了指定一张纸。

```
Sub GetOpenFile()

Dim fileStr As String

fileStr = Application.GetOpenFilename()
Worksheets("Sheet2").TextBox1.Value = fileStr

End Sub 
```

# tridion - 如何从 SDL Tridion Anguilla 框架中的 ID 中获取用户的姓名和描述

> ID：12805280
> 
> 赞同：6
> 
> 时间：2012-10-09T17:29:57.527
> 
> 标签：tridion, tridion-2011

我为 SDL Tridion 2011 SP1 编写了一个 GUI 扩展。GUI 包含一个额外的功能区按钮和在保存组件时触发的事件处理程序。

我的事件处理程序注册如下：

```
PowerTools.Commands.ItemCommenting.prototype._execute = function (selection) {
    var item = $display.getItem();
    $evt.addEventHandler(item, "save", this.getDelegate(this._onItemSaved));
    $cme.getCommand("SaveClose")._execute(selection);
}; 
```

事件处理程序如下所示：

```
PowerTools.Commands.ItemCommenting.prototype._onItemSaved = function (eventitem) {

    var comment = prompt("Please enter a comment", "");

    $messages.registerNotification("Saving user comments...");

    var commentitemid = eventitem.source.getId();
    var commenterid = eventitem.source.getCreatorId();
    var commenter = $tcm.getItem(commenterid);
    var commentername = commenter.getDescription();
    var commentdate = eventitem.source.getLastModifiedDate();
    var commentversion = eventitem.source.getVersion();

    //Call the service to update 
    PowerTools.Model.Services.AppDataServices.Append("ext:ItemCommenting", commentitemid, "<comment><user>" + commenterid + "</user><message>" + comment + "</message><datetime>" + commentdate + "</datetime><version>" + commentversion + "</version></comment>", null, null, null, false);

}; 
```

这工作正常，除了变量`commentername`始终未定义。是否有更好的方法来获取用户的名称和描述？

此外，有谁知道返回的值`eventitem.source.getCreatorId()`实际上是 Reviser 还是创建该项目的人？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T18:13:32.227

我通常在安圭拉遵循这种方法：

1.  用于`$models.getItem(item Id)`加载对象，从某人（@puf？）那里听说这是缓存的。
2.  检查 object.isLoaded() 是否存在，如果是，则执行我的事件处理程序
3.  如果对象未加载，则监听事件

这一切都归结为这样的事情：

```
p.keyword = $models.getItem(p.keywordUri);
if (p.keyword.isLoaded()) {
    this._onReleaseKeywordLoaded();
} else {
    $evt.addEventHandler(p.keyword, "load", this.getDelegate(this._onReleaseKeywordLoaded));
    p.keyword.load();
} 
```

然后，您将从事件处理程序中调用模型的 Web 服务，因为您确定届时将加载该对象。

在您当前的代码中，您可能试图在加载对象之前阅读描述，因此未定义。我倾向于将我需要的变量放在`this.properties`var 中的多个函数中（`p`在我的示例中），然后在每个函数的开头执行类似的操作：

```
var p = this.properties;
var whatever = p.whatever; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T10:05:45.650

正如 Nuno 所说，您可能正在读取尚未加载的属性。

但是，无论如何，您都不应该接受客户端发送的名称。您应该在 Web 服务中获取当前用户的 ID 和名称。日期/时间等其他一些参数也是如此。

基本上，您的 Web 服务不应该信任传入的数据。因此，它可以自行发现的任何内容甚至都不应该成为该方法的参数，并且它确实需要的任何内容都应该被视为恶意内容并在您使用它之前进行清理。

# asp.net-mvc-3 - 从哪里获得所有 html helper 的剃须刀文档

> ID：12805281
> 
> 赞同：1
> 
> 时间：2012-10-09T17:30:03.113
> 
> 标签：asp.net-mvc-3, razor, html-helper

我想知道所有的 html 助手。也许我需要一个描述所有辅助函数的参数和所有重载的文档。

我希望你们中的任何人都可以提供链接或任何书籍参考。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:12:09.927

像这样的东西：[msdn](http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper%28v=vs.108%29.aspx)？

`HtmlHelper Class - Represents support for rendering HTML controls in a view.`

# java - 春季休眠错误

> ID：12805285
> 
> 赞同：2
> 
> 时间：2012-10-09T17:30:21.913
> 
> 标签：java, spring, hibernate, jpa

我的 spring.xml 中有以下代码可以正常工作...

```
<beans:bean id="sessionFactory"
        class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <beans:property name="annotatedClasses">
            <beans:list>
                <beans:value>org.assessme.com.entity.User</beans:value>
            </beans:list>
        </beans:property>
        <beans:property name="dataSource" ref="dataSource" />
                <beans:property name="packagesToScan"
        value="org.assessme.com.entity.*" />
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect
                </beans:prop>
                <beans:prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory
                </beans:prop>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
                <beans:prop key="hibernate.hbm2ddl.auto">update</beans:prop>
            </beans:props>
        </beans:property>
    </beans:bean> 
```

正如您从 beans:list 中看到的那样，我只让 User 对象首先工作。

我所有的实体都在同一个文件夹中，如下所示

![实体](../Images/49c8d9e606708643b1945cd294f75e53.png)

问题是，当我在这个列表中添加另一个类时，例如......

org.assessme.com.entity.Campaign

启动Tomcat时出现以下异常...

```
 Caused by: org.hibernate.AnnotationException: No identifier specified for entity: org.assessme.com.entity.Campaign
    at org.hibernate.cfg.InheritanceState.determineDefaultAccessType(InheritanceState.java:272)
    at org.hibernate.cfg.InheritanceState.getElementsToProcess(InheritanceState.java:227)
    at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:712)
    at org.hibernate.cfg.AnnotationConfiguration.processArtifactsOfType(AnnotationConfiguration.java:636)
    at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:359)
    at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1206)
    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:717)
    at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 132 more 
```

如果需要，下面的实体代码...

Campaign.java

```
package org.assessme.com.entity;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.Table;

@Entity
@Table(name = "campaigns")
public class Campaign {

    @Column(name = "name")
    private String name;

    @Column(name = "id")
    private String id;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }
} 
```

用户.java

```
package org.assessme.com.entity;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name = "users")
public class User {

    @Column(name = "firstName")
    private String firstName;

    @Column(name = "lastName")
    private String lastName;

    @Column(name = "email")
    private String email;

    @Column(name = "password")
    private String password;

    @Column(name = "username")
    private String username;

    @Column(name = "access")
    private Integer access;

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Column(name = "id")
    private long id;

    public String getFirstName() {
        return firstName;
    }
    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }
    public String getLastName() {
        return lastName;
    }
    public void setLastName(String lastName) {
        this.lastName = lastName;
    }
    public String getEmail() {
        return email;
    }
    public void setEmail(String email) {
        this.email = email;
    }
    public long getId() {
        return id;
    }
    public void setId(long id) {
        this.id = id;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public Integer getAccess() {
        return access;
    }
    public void setAccess(Integer access) {
        this.access = access;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T17:40:29.683

我认为问题在于`Campaign`没有用`@Id`. 像这样修复它：

```
@Id
@Column(name = "id")
private String id; 
```

# c# - 是否可以在 linq 中使用 OfType 在哪里？

> ID：12805287
> 
> 赞同：3
> 
> 时间：2012-10-09T17:30:31.260
> 
> 标签：c#, linq, entity-framework

我有一个名为 source 的表，该表具有多个派生表，例如帐户等。我有第二个表，该表具有该表的导航属性，称为 Source。

我想做的是通过 Source 的类型过滤 ActionItemState 的结果，然后根据继承表的属性进行过滤。

这是我正在尝试做的一个例子。当我尝试下面的代码时，我得到“。LINQ to Entities 仅支持转换 EDM 基元或枚举类型”。有谁知道使用 OfType 或类似方法的方法？

```
 query = from a in _actionItemRepository.GetTable()
         where a.ActionItemStates.Any(ais => ais.Source is AccountSource && ((AccountSource)ais.Source).AccountId == id)
         select a; 
```

![在此处输入图像描述](../Images/e3954b85338c3d172f6817882f9e6db5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:35:08.447

Try going the other way with it:

```
var accountSources = db.Sources.OfType<AccountSource>();
var actionItemStates = accountSources.SelectMany(a => a.ActionItemStates); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:34:18.260

You can use this code

```
Source.OfType<AccountSource>() 
```

You apply before Where operator

```
 OfType<AccountSource>().Where(....) 
```

# sql - 如何从具有未知行数的 XML 中获取 XML 属性

> ID：12805295
> 
> 赞同：0
> 
> 时间：2012-10-09T17:31:04.190
> 
> 标签：sql, xml, sql-server-2008

我有以下查询，可让我从指定列的一行 xml 中获取 xml 数据。

但是，产品可以有 1 个 UPC 子级，或者很多。

如何更改查询以返回 Product 的所有现有子项？

```
DECLARE @MyXML XML
SET @MyXML =
    (SELECT ProductsXML
     FROM Products
     WHERE ProductId= 1)
SELECT 
    a.b.value('Product[1]/UPC[1]/@upccode','DATE') as UPC,
    a.b.value('Product[1]/UPC[1]/@dateadded','DATE') as DateAdded
    FROM @MyXML.nodes('xml')a(b) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:40:13.227

```
DECLARE @MyXML XML;
SET @MyXML =
    N'<xml>
        <Product>
            <UPC upccode="1237" dateadded="10/9/2012"/>
            <UPC upccode="1236" dateadded="10/8/2012"/>
            <UPC upccode="1235" dateadded="10/7/2012"/>
            <UPC upccode="1234" dateadded="10/6/2012"/>
        </Product>
    </xml>';

SELECT 
    a.b.value('@upccode','int') as UPC,
    a.b.value('@dateadded','date') as DateAdded
FROM
    @MyXML.nodes('xml/Product/UPC')a(b); 
```

# c# - 如何在 WCF 中解码多部分/相关响应？

> ID：12805296
> 
> 赞同：2
> 
> 时间：2012-10-09T17:31:10.320
> 
> 标签：c#, .net, wcf, web-services, soap

我有一个返回结果的网络服务`multipart/related`：

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Type: multipart/related; boundary=MIMEBoundaryurn_uuid_FCAC227A0F1D534C2D1349803588825;
type="application/soap+xml"; start="<0.urn:uuid:FCAC227A0F1D534C2D1349803588826@apache.org>"; action="urn:MyServiceAction"
Date: Tue, 09 Oct 2012 17:26:28 GMT
Content-Length: 2961

--MIMEBoundaryurn_uuid_FCAC227A0F1D534C2D1349803588825
Content-Type: application/soap+xml; charset=UTF-8
Content-Transfer-Encoding: 8bit
Content-ID: <0.urn:uuid:FCAC227A0F1D534C2D1349803588826@apache.org>

<?xml version='1.0' encoding='UTF-8'?>
<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope">
[... snipped ...]
</soapenv:Envelope>
--MIMEBoundaryurn_uuid_FCAC227A0F1D534C2D1349803588825-- 
```

WCF 似乎不支持这一点。我正在使用自定义绑定，并显示`TextMessageEncodingBindingElement`一条消息告诉我不支持该内容类型。`MtomMessageEncodingBindingElement`也抱怨，因为它不期望`application/soap+xml`但是`application/xop+xml`。

是否有可以正确处理的`multipart/related`MessageEncoder `application/soap+xml`？还是有一种简单的方法可以让我挂接到管道中并在有效负载被发送到之前提取它`TextMessageEncodingBindingElement`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T22:24:38.277

有一个将 SOAP 与 MIME 相结合的标准，称为 SOAP With Attachments（SwA，[http](http://en.wikipedia.org/wiki/SOAP_with_Attachments) ://en.wikipedia.org/wiki/SOAP_with_Attachments ）。如果这是您正在使用的，这里有一个自定义编码器：[http](http://wcfswaencoder.codeplex.com/) ://wcfswaencoder.codeplex.com/ 即使它不是 SwA，自定义编码器代码也可能是您的一个很好的起点。

# java - API 设计中的响应/回复模式与方法重载

> ID：12805299
> 
> 赞同：3
> 
> 时间：2012-10-09T17:31:17.263
> 
> 标签：java, design-patterns

我最近设计了一个 API 来包装数据存储实现，并允许其他开发人员使用这个 API 来索引他们的数据并根据关键字查询数据。我在查询方法中使用了响应/回复模式，因为 Jaroslav Tulach 提到它可以避免在需要添加参数时不断更改 API 接口（Practical API Design 中的第 97 页）。其他开发人员认为使用方法重载是更好的方法。你能分享你在设计中使用两种不同方法的经验吗？以下是我和其他开发人员之间的对话。

我：响应/回复模式看起来是一种简洁的方式，因为随着 API 的发展，越来越多的参数可以添加到 API 接口中。在接口中拥有超过 10 种以上的重载方法可能会让其他开发人员感到困惑。他们如何确定使用哪种方法？

其他开发者的论点：随着 API 的发展，您不应该继续添加参数。如果您在 API 接口中不断添加参数，则说明您的 API 设计存在问题。结果，重载方法的数量很少，因此不会打扰开发人员。更重要的是，Java框架中经常看到大量的重载方法实现。

我：管理以前版本的 API 的向后兼容性很容易。您不必更改界面。更改界面会破坏其他开发人员的现有代码。

其他开发人员的论点：如果我更改实现并添加参数，其他开发人员应该根据新的 API 更新他们的代码。如果新参数是可选的，为什么还要添加它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T08:27:47.907

> 其他开发者的论点：随着 API 的发展，您不应该继续添加参数。如果您在 API 接口中不断添加参数，则说明您的 API 设计存在问题。

这是一种相当幼稚的看法。所有 API 都在发展。这不是我们想要的，但请告诉我一个客户/客户第一次就完成了规范……

请求/回复类型的参数很棒，因为它很容易获得向后可比性。一旦创建了 api 的第二个版本，我们也不必修改现有代码。

考虑一下：

```
public class GetUserRequest
{
    string Id;
}

public class GetUserReply
{
  string Id;
  string DisplayName;
} 
```

以及API接口：

```
public class MyCoolApi
{
    GetUserReply GetUser(GetUserRequest request);
} 
```

（API 的结构取决于实现的类型）

现在我们得到一个新要求：所有用户都应该包含年龄。

我们就按照开闭原则，继承回复类：

```
public class GetUserReply2 : GetUserReply
{
  string Id;
  string DisplayName;
  int Age;
} 
```

所有版本 1 用户将反序列化版本 1，而版本 2 用户将其反序列化为版本 2。

传入参数也是如此。您可以使服务（API）类成为代理（代理模式），它只是根据请求类版本在后台调用正确的 api 实现。

结论：请求/回复为我们提供了更多的灵活性，而不是方法重载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T08:14:49.680

I believe we are comparing

```
 invoke( int param1, string param2) { ... }

   invoke ( string param3, int param4, int param5) { ... } 
```

and so on for all valid parameter combinations

with

```
 invoke(requestClass theRequest) 
```

which is used like this

```
 request.set("param1", value);
   request.set("param2", value);
   invoke(request); 
```

There are several trades-off here.

A downside of the request approach is that the caller can provide an invalid combination of parameters and will receive no compile time warning - errors are not uncovered until runtime.

But the ever-growing interface may get completely out of hand, you can get a combinatorial explosion in the number of methods you need.

You can view SQL as an example of a very rich request - it seems clear to me that there are situations where a well structured query language or request object is preferable to a parameter-by-parameter method overloading approach.

My personal rule of thumb: if you're heading for 10 different overloaded methods a request object should be considered.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:35:13.970

没有本质的区别，也不能降低内在的复杂性。当然，我们总能找到任何一种选择的支持用例；在不了解您的具体问题领域的情况下，其他人不能仅仅根据一些抽象原则选择一个最喜欢的。

不过，我会建议选择一个对今天来说简单的解决方案。不要担心“未来的变化”

# java - 无法从 String 取回原始字节数组

> ID：12805304
> 
> 赞同：2
> 
> 时间：2012-10-09T17:31:43.720
> 
> 标签：java

我有一个字节数组并使用`new String(array)`. 当我使用 将它转换回字节数组`.getBytes()`时，它不会返回原始字节数组。是什么赋予了？

```
String text = "two hats";
boolean t1 = Arrays.equals(text.getBytes(), text); // true

byte[] barray = {(byte)0x8f, (byte)0xd5, (byte)0xaf, (byte)0x30, (byte)0xb9};        

String test1 = new String(barray); 
boolean t2 = Arrays.equals(barray.getBytes(), test1); // false

// I tried setting an encoding but that didn't help.

Charset cs = Charset.forName("UTF-8"); 
String test2 = new String(barray, cs);       
boolean t3 = Arrays.equals(barray, test2, cs); // false 
```

这是我实际使用的代码。

```
// test byte array vs string
public static void testEqual(byte[] bytes, String str) {
    byte[] fromString = str.getBytes();        

    printBytes(bytes);        
    printBytes(fromString);        
    System.out.println(Arrays.equals(bytes, fromString));        
}

// test byte array vs string, with charset
public static void testEqual(byte[] bytes, String str, Charset charset) {
    byte[] fromString = str.getBytes(charset);        

    printBytes(bytes);        
    printBytes(fromString);        
    System.out.println(Arrays.equals(bytes, fromString));
}

// prints bytes as hex string
public static void printBytes(byte[] bytes) {
    for (byte b: bytes) {
        System.out.print(String.format("%02X ", b));
    }        
    System.out.println();
}

public static void main(String[] args) {
    String text = "two hats";
    testEqual(text.getBytes(), text); // works fine

    byte[] barray = {(byte)0x8f, (byte)0xd5, (byte)0xaf, (byte)0x30, (byte)0xb9};        

    String test1 = new String(barray); // breaks      
    testEqual(barray, test1);

    Charset cs = Charset.forName("UTF-8"); // breaks too
    String test2 = new String(barray, cs);       
    testEqual(barray, test2, cs);
} 
```

**演示：http: [//ideone.com/IRHlb](http://ideone.com/IRHlb)**

PS：我不想使用 Base64 之类的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T17:34:24.610

您似乎试图通过使用平台默认编码将其转换为字符串来存储*任意二进制数据*。不要那样做。使用 base64 或 hex 将任意二进制数据表示为文本。base64 转换有很多类；我喜欢[这个公共领域之一](http://iharder.net/base64)。

如果数据确实*是*某些文本的二进制编码形式，则应明确指定该编码 - 但这*仅*适用于原始数据是文本的情况。（使用平台默认编码几乎*总是*一个坏主意。）

二进制数据和文本数据有很大的不同。将不透明的二进制数据任意转换为字符串就像期望能够将任意文件加载到图像编辑器中并看到有用的东西。

# java - 如何将 JUnit 测试套件嵌入到另一个套件中

> ID：12805305
> 
> 赞同：0
> 
> 时间：2012-10-09T17:31:47.373
> 
> 标签：java, unit-testing, junit, junit4

我有一个正在尝试升级的旧 Junit3 TestSuite。我在设置中看到了这个...

套件.addTest(AllSubTests.suite());

Junit 4 中的等价物是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:32:35.170

您可以像添加其他测试一样添加套件类...

```
@Suite.SuiteClasses({
  AllSubTests.class
}) 
```

# excel - 如何使用vba计算工作表中的单元格数

> ID：12805308
> 
> 赞同：0
> 
> 时间：2012-10-09T17:31:54.813
> 
> 标签：excel, vba

我是 Vba 的新手，我有 5 个不同的工作表，名为工作表 1 到 5，第一个工作表有一个按钮和标签，所以我想选择工作表 3 中的所有内容，当我按下按钮时，我希望它显示单元格的数量我在标签中选择

```
Sub Button2_Click()

Dim rngCell As Range, arrArray() As Variant, i As Integer

ReDim arrArray(1 To Selection.Cells.Count)

i = 1
For Each rngCell In Selection

    arrArray(i) = rngCell.Value
    i = i + 1

Next

ActiveSheet.Shapes("Label 1").Select
Selection.Characters.Text = i

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:58:06.337

我认为这比你想象的要简单得多......

```
Option Explicit

Sub CaptureSelectionCount()

' Keyboard Shortcut: Ctrl+Shift+E '-> adjust to make sure this doesn't overwrite an existing function in your workbook
Dim lngCnt as Long

lngCnt = ActiveSheet.Selection.Cells.Count

Sheets("Sheet1").Shapes("Label 1").TextFrame.Characters.Text = lngCnt

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T11:13:24.173

这会做到这一点，但它不是一种非常优雅的做事方式 - 虽然我看不到任何替代方案。您需要利用事件来捕获先前选择的工作表。由于确定工作表上选择范围的唯一方法是激活该工作表，因此您必须关闭屏幕更新跳转到工作表，然后跳回原始工作表并重新打开屏幕更新。

将以下代码放入新模块中： Option Explicit

```
'Global variables (avoid using globals if you can)
Public wsLast As Worksheet
Public iSelectedCells As Integer

'Link this sub to your button
Public Sub CountCells()
    If Not wsLast Is Nothing Then
        Sheets("Sheet1").Shapes("Label 1").TextFrame.Characters.Text = "There " & IIf(iSelectedCells = 1, " is " & iSelectedCells & " cell selected ", " are " & iSelectedCells & " cells selected ") & "in " & wsLast.Name
    End If
End Sub 
```

以下代码需要进入电子表格的“ThisWorkbook”模块：

```
Option Explicit

Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)
    Dim wsThisWorksheet As Worksheet

    'Turn off events to avoid triggering a loop
    Application.EnableEvents = False

    'Set this worksheet so we can come back to it
    Set wsThisWorksheet = ActiveSheet

    'Record the deactivated sheet as a global variable
    Set wsLast = Sh

    'Turn off screen updating, go back to the last sheet, count the selection
    Application.ScreenUpdating = False
    wsLast.Activate
    iSelectedCells = Selection.Cells.Count

    'Then come back to the original and turn screen updating back on
    wsThisWorksheet.Activate
    Application.ScreenUpdating = True

    'Restore events
    Application.EnableEvents = True

    'Set the local variable to nothing
    Set wsThisWorksheet = Nothing
End Sub 
```

您可以通过检查是否使用按钮停用工作表来进一步增强代码，如果是则忽略它。

# javascript - Javascript库d3调用函数

> ID：12805309
> 
> 赞同：91
> 
> 时间：2012-10-09T17:32:01.210
> 
> 标签：javascript, d3.js

我无法理解 d3.call() 如何工作以及何时何地使用它。[这](http://alignedleft.com/tutorials/d3/axes/)是我正在尝试完成的教程链接。

有人可以具体解释一下这件作品在做什么吗

```
var xAxis = d3.svg.axis()
              .scale(xScale)
              .orient("bottom");

svg.append("g").call(xAxis); 
```

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-10-09T20:34:52.453

我认为这里的技巧是要理解 xAxis 是一个生成一堆 SVG 元素的函数。其实就是返回的函数`d3.svg.axis()`。scale 和 orient 函数只是链接语法的一部分（在此处阅读更多内容：http: [//alignedleft.com/tutorials/d3/chaining-methods/](http://alignedleft.com/tutorials/d3/chaining-methods/)）。

因此，`svg.append("g")`将 SVG 组元素附加到 svg 并以选择的形式返回对自身的引用（此处使用相同的链语法）。当您`call`在选择上使用时，您正在调用在`xAxis`选择元素上命名的函数`g`。`xAxis`在这种情况下，您正在新创建和附加的组上运行轴函数, `g`。

如果这仍然没有意义，上面的语法相当于：

```
xAxis(svg.append("g")); 
```

或者：

```
d3.svg.axis()
      .scale(xScale)
      .orient("bottom")(svg.append("g")); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2020-08-18T12:39:25.247

IMO 所接受的答案`.call()`是[D3 API 函数](https://github.com/d3/d3-selection/blob/v1.4.1/README.md#selection_call)，不要与[Function.prototype.call()混淆](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)

`selection.call(function[, arguments…])`

> 只调用一次指定的函数，并传入此选择以及任何可选参数。返回此选择。这相当于手动调用函数，但有助于方法链接。例如，要在可重用函数中设置多个样式：

现在说：

```
d3.selectAll("div").call(name, "John", "Snow"); 
```

这大致相当于：

```
name(d3.selectAll("div"), "John", "Snow"); 
```

其中 name 是一个函数，例如

```
function name(selection, first, last) {
  selection
      .attr("first-name", first)
      .attr("last-name", last);
} 
```

唯一的区别是 selection.call*总是返回选择而不是被调用函数*name 的返回值。

# php - Zend 数据库，使用类型转换错误加入查询（我认为）

> ID：12805310
> 
> 赞同：0
> 
> 时间：2012-10-09T17:32:02.177
> 
> 标签：php, zend-framework, postgresql, zend-db

我想知道是否有某种方法可以将预先配对的语句放入 Zend 数据库类，并使用它而不是使用`->select()`, `->from()`, `->where()`。我已经尝试过以下查询，`->query()`但没有成功。我只问因为即使在 zend 文档中我发现的所有参考资料也只针对 mysqli。我发现 DB 类对于更复杂的查询非常烦人（即使这样也不是那么复杂）。

我有这个查询

```
SELECT 
org.orgid, 
org.roleid, 
users.userid, 
users.email, 
users.firstname, 
users.lastname, 
users.contact, 
users.state, 
users.ts, 
users.alternate_delivery_email, 
users.unbound, 
users.blocked 
FROM my_mapping AS org 
INNER JOIN my_users AS users ON org.userid = users.userid
WHERE (org.orgid = 'generated-id')
AND (org.roleid::text LIKE 'partner-%'); 
```

我一直在尝试使其符合匹配的 zend DB 版本

```
$select = $db->select()
        ->from(array('org' => 'my_mapping'),
            array(
                'orgid' => 'org.orgid',
                'roleid' =>'org.roleid',
                'userid' =>'users.userid',
                'email' =>'users.email',
                'firstname' =>'users.firstname',
                'lastname' =>'users.lastname',
                'contact' =>'users.contact',
                'state' =>'users.state',
                'ts' =>'users.ts',
                'alternate_delivery_email' =>'users.alternate_delivery_email',
                'unbound' =>'users.unbound',
                'blocked' =>'users.blocked'
            ))
        ->join(array('my_users' => 'users'),'org.userid = users.userid',array())
        ->where('org.orgid = ?',$mspID)
        ->where('org.roleid::text LIKE ?', 'partner-%'); 
```

这给我带来的只是问题。无论我尝试以哪种方式将其更改为工作。然而，进入终端并使用直接查询工作正常，我得到了结果和其他一切。因此，我开始着手查看是否可以找到一种方法来使用传递给 Zend DB 类的确切查询，这样我就可以像处理输出一样处理实际与 Zend DB 类一起使用的查询。但是我在那个庄园中找到的所有参考资料都是特定于 mysql 或 mysqli 的，所以我不确定它是否会起作用，如果它会起作用，我该如何将它们串在一起？

另外值得一提的是“org.roleid”是一个“枚举”，因此`::text`，roleid 和 userid 也是“uuid”。

我得到的错误是：

```
Warning: PDO::quote() expects parameter 1 to be string, object given in ........ on line ...
SQLSTATE[42601]: Syntax error: 7 ERROR: syntax error at end of input LINE 1: SELECT "my_users".* FROM "my_users" WHERE ( ^ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T06:10:35.490

您需要使用 Zend_Db_Statement 在 Zend 框架中执行准备好的语句 - [http://framework.zend.com/manual/1.12/en/zend.db.statement.html](http://framework.zend.com/manual/1.12/en/zend.db.statement.html)

此外，这里是另一个讨论相同问题的 stackoverflow 线程 - [How to useprepared statements in Zend Framework](https://stackoverflow.com/questions/10104093/how-to-use-prepared-statements-in-zend-framework)

# objective-c - Objective C使用类成员函数对NSArray进行排序

> ID：12805311
> 
> 赞同：0
> 
> 时间：2012-10-09T17:32:02.723
> 
> 标签：objective-c, nsarray

我有一个 NSArray，我需要根据存储在对象内的变量进行排序（在这种情况下，我的类名是 SchedView，它是一个 UIViewController）。我在想 NSArray 会让我传递一个“成员函数”（不确定这是否是 Objective-C 中使用的术语，我是这种语言的新手）。看来我只能传递一个静态/C风格的函数，所以这就是我最终得到的：

```
- (NSInteger) BuildGridSortCompare :(id) r1 :(id) r2 :(void*) context
{
    // Have compare code here, and can use class scope variables...

    return NSOrderedSame;
}

NSInteger _BuildGridSortCompare(id r1,id r2,void *context)
{
    SchedView *sv = (__bridge SchedView*) context;
    return [sv BuildGridSortCompare:r1 :r2 :NULL];
}

- (void)BuildGrid
{
    Records = [Records sortedArrayUsingFunction:_BuildGridSortCompare context:(__bridge void *)(self)];
} 
```

BuildGrid 和 BuildGridSortCompare 是我的 SchedView 类（选择器？）的成员函数。_BuildGridSortCompare 基本上是一个 C 风格的函数，它只是一个调用我的成员函数的包装器。

我以前在 C/C++ 代码中使用过这种设计，但没有在 Java 和 C# 等现代平台中使用过，所以认为 Objective-C 可能有更好的方法？

我也不确定一些类型转换，主要是 __bridge。

我在做什么是安全的，还是有另一个类似于 sortedArrayUsingFunction 的函数可以让我使用成员函数？我确实看到了 sortedArrayUsingSelector，但这似乎在我正在排序的类上调用了一个函数。在这种情况下，我希望该功能由自己实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:39:31.600

我认为您的代码还可以，但是您可以使用*blocks*更优雅地做到这一点：

```
records = [records sortedArrayUsingComparator:^NSComparisonResult(id a, id b) {
    // compare code here, can use self etc.
    return ...;
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:46:53.253

你的代码看起来不错。我发现使用这两种方法中的任何一种在 iOS 中对数组进行排序更有用：

1.  `sortedArrayUsingSelector`：这意味着您将选择器作为参数传递。如果您使用它，您可以在数组类型上已经存在的比较方法上使用选择器。例如，如果您有一个 NSNumber 数组，您可以传递 @selector(compare) 这将调用您的 NSSNumber 对象上的 compare 方法。如果这不是预定义类型，您可能需要为您的对象实现自己的比较方法。

2.  `sortedArrayUsingComparator`：这意味着您将一个块作为参数传递，我认为它更闪亮。

# c++ - 从文本文件中读取输入并提取它 - C++

> ID：12805312
> 
> 赞同：4
> 
> 时间：2012-10-09T17:32:05.267
> 
> 标签：c++, parsing

我正在尝试逐行读取文本文件并将数据提取到我的程序中。本质上，C++ 程序将读取一个已经生成的输入文件，该文件格式如下：

```
 Republican Senator John McMahon
     Democrat Mayor Steven Markel
     Republican Judge Matt Stevens
     Democrat Senator Anthony Quizitano
     S R
     M D
     J R
     ...
     ..
     .. 
```

格式基本上是前 3 行，包括 Party、Position 和 Name，接下来的几行表示“结果”，其形式为：

[第一封立场信] [政党投票]

因此，例如，如果您看到 SR，则意味着 1 票投给了参议员，并且投给了共和党候选人。

这是我到目前为止所拥有的：

```
 #include<fstream>
            int main()
            {
            std::ifstream input("file.txt");
            } 
```

我的理解是，这将允许我输入文件，并逐行浏览它，但我不确定我应该如何从这里开始实现这一目标......有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:39:28.927

为了好玩和荣耀，这里是一个基于 Boost Spirit 的实现。我添加了更多的虚假投票输入，以便可以显示一些东西。

*   我不确定候选人和选票之间是否存在 1:1 的关系（我不是美国公民，我不知道列出的候选人是否会投票或被投票）。所以我决定只使用假数据。

    ```
    const std::string input = 
        "Republican Senator John McMahon\n"
        "Democrat Senator Anthony Quizitano\n"
        "S R\n"
        "S R\n"
        "S R\n"
        "Democrat Mayor Steven Markel\n"
        "Republican Judge Matt Stevens\n"
        "M D\n"
        "J R\n"
        "S R\n"
        "S R\n"; 
    ```

    然而，该代码可用于这两种目的。

*   我让输入出现的顺序变得不重要。
*   但是，您可以选择断言单个字母 (S,M,J) 实际上对应于该点之前列出的位置。通过取消注释检查启用此功能`posletter_check`

**[在http://liveworkspace.org/code/d9e39c19674fbf7b2419ff88a642dc38](http://liveworkspace.org/code/d9e39c19674fbf7b2419ff88a642dc38)**上查看演示

```
#define BOOST_SPIRIT_USE_PHOENIX_V3
#define BOOST_RESULT_OF_USE_DECLTYPE
#include <boost/fusion/adapted.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <iomanip>

namespace qi    = boost::spirit::qi;
namespace phx   = boost::phoenix;

struct Candidate { std::string party, position, name; };

BOOST_FUSION_ADAPT_STRUCT(Candidate, (std::string, party)(std::string, position)(std::string, name))

typedef std::map<std::pair<char, char>, size_t> Votes;
typedef std::vector<Candidate> Candidates;

template <typename It>
    struct parser : qi::grammar<It>
{
    mutable Votes _votes;
    mutable Candidates _candidates;

    parser() : parser::base_type(start)
    {
        using namespace qi;
        using phx::bind; using phx::ref; using phx::val;

        start = (line % eol) >> *eol >> eoi;

        line = 
              vote      [ phx::bind(&parser::register_vote, phx::ref(*this), _1) ]
            | candidate [ phx::push_back(phx::ref(_candidates), _1) ]
            ;

        vote %= graph   
                        // Comment the following line to accept any single
                        // letter, even if a matching position wasn't seen
                        // before:
                        [ _pass = phx::bind(&parser::posletter_check, phx::ref(*this), _1) ]  
            >> ' ' 
            >> char_("RD")
            ;

        candidate = (string("Republican") | string("Democrat"))
            >> ' ' 
            >> as_string [ +graph ]
            >> ' ' 
            >> as_string [ +(char_ - eol) ]
            ;
    }

  private:
    bool posletter_check(char posletter) const
    {
        for (auto& c : _candidates)
            if (posletter == c.position[0])
                return true;
        return false;
    }
    void register_vote(Votes::key_type const& key) const
    {
        auto it = _votes.find(key);
        if (_votes.end()==it)
            _votes[key] = 1;
        else
            it->second++;
    }

    qi::rule<It, Votes::key_type()> vote;
    qi::rule<It, Candidate()> candidate;
    qi::rule<It> start, line;
};

int main()
{
    const std::string input = 
        "Republican Senator John McMahon\n"
        "Democrat Senator Anthony Quizitano\n"
        "S R\n"
        "S R\n"
        "S R\n"
        "Democrat Mayor Steven Markel\n"
        "Republican Judge Matt Stevens\n"
        "M D\n"
        "J R\n"
        "S R\n"
        "S R\n";

    std::string::const_iterator f(std::begin(input)), l(std::end(input));

    parser<std::string::const_iterator> p;

    try
    {
        bool ok = qi::parse(f,l,p);
        if (ok)   
        {
            std::cout << "\ncandidate list\n";
            std::cout << "------------------------------------------------\n";
            for (auto& c : p._candidates)
                std::cout << std::setw(20) << c.name << " (" << c.position << " for the " << c.party << "s)\n";

            std::cout << "\nVote distribution:\n";
            std::cout << "------------------------------------------------\n";
            for (auto& v : p._votes)
                std::cout << '(' << v.first.first << "," << v.first.second << "): " << v.second << " votes " << std::string(v.second, '*') << "\n";
        }
        else std::cerr << "parse failed: '" << std::string(f,l) << "'\n";

        if (f!=l) std::cerr << "trailing unparsed: '" << std::string(f,l) << "'\n";
    } catch(const qi::expectation_failure<std::string::const_iterator>& e)
    {
        std::string frag(e.first, e.last);
        std::cerr << e.what() << "'" << frag << "'\n";
    }
} 
```

输出：

```
candidate list
------------------------------------------------
        John McMahon (Senator for the Republicans)
   Anthony Quizitano (Senator for the Democrats)
       Steven Markel (Mayor for the Democrats)
        Matt Stevens (Judge for the Republicans)

Vote distribution:
------------------------------------------------
(J,R): 1 votes *
(M,D): 1 votes *
(S,R): 5 votes ***** 
```

# .net - 应用程序尝试加载错误版本的程序集

> ID：12805313
> 
> 赞同：2
> 
> 时间：2012-10-09T17:32:09.703
> 
> 标签：.net, assemblies, version

我正在使用一对未签名的第 3 方程序集库，其中包含我创建派生类的 Windows 控件和基本类型。dll 位于安装我的应用程序的子文件夹中。在我的控制之外，具有相同名称但针对更高版本的 .Net 运行时构建的新版本库安装在与我的可执行文件相同的目录中。

这会导致我的应用程序抛出 BadImageFormatException 说：

> 无法加载文件或程序集“sharedlibA”[...] 此程序集由比当前加载的运行时更新的运行时构建，无法加载。

这是我正在使用的文件系统结构：

```
[MyappFolder]
   |--Myapp.exe
   |--sharedlibA.dll (wrong version)
   |--sharedlibB.dll (wrong version)
   |--bin
       |--sharedlibA.dll (need to use this)
       |--sharedlibB.dll (need to use this) 
```

我一直在阅读有关不同的程序集加载上下文并创建单独的 AppDomain 的信息，但这些似乎都不起作用。

**编辑**

我已经按照 Hans 的建议从配置文件中删除了探测信息，并订阅了 AssemblyResolve 事件，所以现在所有其他依赖程序集都会触发该事件，除了 sharedlibA 和 sharedlibB。它们仍然会导致 BadImageFormatException。尽管发生了变化，但 AppBase 文件夹似乎仍在被探测。

这是融合日志：

```
=== Pre-bind state information ===
LOG: User = ...
LOG: DisplayName = sharedlibA, Version=1.0.0.0, Culture=neutral, PublicKeyToken=643d95c7ce242296
 (Fully-specified)
LOG: Appbase = file:///C:/[MyappFolder]
LOG: Initial PrivatePath = NULL
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\[MyappFolder]\Myapp.exe.Config
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Post-policy reference: sharedlibA, Version=1.0.0.0, Culture=neutral, PublicKeyToken=643d95c7ce242296
LOG: Attempting download of new URL file:///C:/[MyappFolder]/sharedlibA.DLL.
ERR: Failed to complete setup of assembly (hr = 0x8013101b). Probing terminated. 
```

**编辑#2**

我已经解决了我的具体问题。下面回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:20:12.243

`<codeBase>`我通过向应用程序配置文件添加元素来指定每个 dll 的确切位置来解决这个问题。显然这是有效的，因为`<codebase>`在每次需要加载程序集时，在探测启发式开始之前进行检查。

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <dependentAssembly>
      <assemblyIdentity name="sharedlibA" culture="neutral" publicKeyToken="..." />
      <codeBase version="1.0.0.0" href="bin\sharedlibA.dll" />
    </dependentAssembly>
    <dependentAssembly>
      <assemblyIdentity name="sharedlibB" culture="neutral" publicKeyToken="..." />
      <codeBase version="1.0.0.0" href="bin\sharedlibB.dll" />
    </dependentAssembly>
  </assemblyBinding>
</runtime> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:49:09.143

这真的应该用“停止这样做！”来解决。一个非常具体的解决方法是删除`<probing>`.exe.config 文件中的元素，这样 CLR 就无法再找到 DLL。并实施 AppDomain.CurrentDomain.AssemblyResolve 事件以返回受祝福的人。

# c# - 将SqlDataReader对象传递给需要IDataReader接口的方法时丢失数据

> ID：12805319
> 
> 赞同：0
> 
> 时间：2012-10-09T17:32:40.213
> 
> 标签：c#, casting, sqldatareader, idatareader

我有一个需要 SqlDataReader 对象作为参数的方法，并且我在模拟该对象的地方进行了测试，并且一切正常。

但是，现在我需要改变这种方法。它现在应该只调用具有 IDataReader 作为参数的新方法，这是一个问题，因为当我将模拟的 SqlDataReader 作为新方法的参数传输时，它会丢失他的数据，我不知道为什么。

像这样的东西：

```
void method(SqlDataReader mockedObject)
{
   // example property
   mockedObject.FieldCount; // for example the value is 1;
   newMethod(mockedObject);
}

void newMethod(IDataReader newObject)
{
   // example property
   newObject.FieldCount // here value is 0;
} 
```

我观察到，如果我只是将 SqlDataReader 对象复制到 IDataReader 类型的新变量，数据也会被清除。

像这样的东西：

```
void method(SqlDataReader mockedObject)
{
   IDataReader variable = mockedObject;
} 
```

正确的代码：

```
=========================================================================================
        [TestMethod()]
    [DeploymentItem("IICMS.dll")]
    public void CheckNullableDateTimeTest_SqlDataReader_Valid()
    {
        MockRepository mocks = new MockRepository();
        SqlDataReader reader = mocks.DynamicMock<SqlDataReader>();
        string column = "test";
        DateTime? expected = new DateTime(2, 1, 1);
        Nullable<DateTime> actual;

        reader.Stub(r => r[column]).Return(expected);
        reader.Stub(r => r.FieldCount).Return(1);
        mocks.ReplayAll();

        actual = Utility_Accessor.CheckNullableDateTime(reader, column);
        Assert.AreEqual(expected, actual);
    }
======================================================================================
        public static DateTime? CheckNullableDateTime(SqlDataReader read, string column)
    {
        return GetValue<DateTime?>(read, column, null);
    }
======================================================================================
public static T GetValue<T>(IDataReader reader, string columnName, T defaultValue)
    {
        try
        {
            for (int i = 0; i < reader.FieldCount; i++)
            {
                if (reader.GetName(i) == columnName)
                {
                    object value = reader[i];
                    return Convert.IsDBNull(value) ? defaultValue : (T)value;
                }
            }

            return defaultValue;
        }
        catch
        {
            return defaultValue;
        }
    } 
```

所以有代码，第二种和第三种方法在其他dll中，但它对任何东西都没有影响。对象在 RhinoMocks 中被模拟 ;)

将 SqlDataReader 对象（读取）传输到 GetValue 方法后数据丢失（即 FieldCount 等于 0，在 Check.. 方法中它具有正确的值 = 1）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T07:55:21.210

我无法解释这一点，但将测试方法更改为以下形式，使得所有对象字段在每种方法中都是可用的（CheckNullString 和 GetValue）：

```
 [TestMethod()]
    [DeploymentItem("IICMS.dll")]
    public void CheckNullableDateTimeTest_SqlDataReader_Valid()
    {
        MockRepository mocks = new MockRepository();
        SqlDataReader reader = mocks.DynamicMock<SqlDataReader>();
        IDataReader reader2 = reader;
        string column = "test";
        DateTime? expected = new DateTime(2,1,1);
        DateTime? actual;

        reader.Stub(r => r[column]).Return(invalidValue);
        reader.Stub(r => r[0]).Return(invalidValue);
        reader.Stub(r => r.FieldCount).Return(1);
        reader.Stub(r => r.GetName(0)).Return(column);

        reader2.Stub(r => r[column]).Return(invalidValue);
        reader2.Stub(r => r[0]).Return(invalidValue);
        reader2.Stub(r => r.FieldCount).Return(1);
        reader2.Stub(r => r.GetName(0)).Return(column);
        mocks.ReplayAll();

        actual = Utility_Accessor.CheckNullString(reader, column);
        Assert.AreEqual(expected, actual);
    } 
```

# java - IndexOutOfBoundsException 为什么？

> ID：12805320
> 
> 赞同：0
> 
> 时间：2012-10-09T17:32:51.140
> 
> 标签：java, sorting

好的...我正在尝试实现我自己的 bin 排序版本，通常称为桶排序。我运行程序，我得到一个 indexOutOfBounds 错误。我不知道为什么。有人可以解释为什么。请注意，binsort 算法没有完成。int n 是数组的长度，m 是随机数生成器生成的列表的上限，范围为 0 到 100。

```
public static void binSort (int []array, int n, int m)
{
//create upperbounds
int x = m / 3;                    //33
int y = n - x;                    //67
int z = n;                        //100

int []temp1 = new int [n-1];
int []temp2 = new int [n-1];
int []temp3 = new int [n-1];

for (int i: array)
{
    if(array[i] < x)
    {
        temp1[i] = array[i];
    }
    else if(array[i] < y)
    {
        temp2[i] = array[i];
    }
    else
    {
        temp3[i] = array[i];     
    }
}

for ( int j = 0; j <= x; j++)
    array[j] = temp1[j];
for ( int k = x + 1; k <= y; k++)
    array[k] = temp2[k];
for ( int l = y + 1; l <= z; l++)
    array[l] = temp3[l];

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T17:38:50.377

`enhanced for`那里有轻微的循环滥用。

```
for (int i: array) 
```

这里，`i`不是索引，而是 的一个元素`array`。每次`for`迭代时，它都会自动为您执行此操作：

```
for(int index = 0; index < array.length; index++) {
    int i= array[index]; 
```

长话短说，`for`为你处理迭代，你只需要使用`i`元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:40:43.880

**-**第一个错误

```
 for (int i: array) 
```

在上述`for-each`循环中，在每次迭代中，数组的连续索引值进入 i。**所以 i 是值 Not index。**

**所以 array[i] 是错误的。**

使用这样的东西...

```
for(int index = 0; index < array.length; index++) {
    int i= array[index] 
```

**-**其次我认为`for ( int j = 0; j <= x; j++)`应该是`j < x`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:44:25.673

`temp3[]`有大小`n-1`。这意味着最后一个元素将位于 index `n-2`。因为`z = n`，这将与 相同`temp3[z-2]`。但是，在您的最后一个 for 循环`l`中将达到 value `z`，这意味着`temp3[l]`将引发 IndexOutOfBounds 异常。

```
 int z = n;                        //100
 int []temp3 = new int [n-1];      //last element of temp3 will be at tempt3[z-2]
 for ( int l = y + 1; l <= z; l++) //l will iterate from y + 1 to z
   array[l] = temp3[l];     // temp3[l] will throw indexOutOfBounds when z>=l>z-2 
```

**编辑：**另外，正如其他人已经指出的那样，`for (int i: array)`可能不会做你认为它做的事情......

# java - 这个字符串格式化程序行有什么问题？

> ID：12805321
> 
> 赞同：1
> 
> 时间：2012-10-09T17:32:51.680
> 
> 标签：java, string.format

```
String result = String.format( "% % % | %-20s| %25s | $%,8.2f | %5d | %-s", thisYear, thisMonth, thisDay, 
                    eventName, eventVenue, ticketPrice, ticketsRemaining, eventType); 
```

ints：thisYear，thisMonth，thisDay，ticketRemaining。

字符串：事件名称、事件地点、事件类型。

双：ticketPrice。

我已经验证所有字段都已正确初始化。此行应输出为以下格式：

```
2012-01-20 | Penguins-Capitals    |      CONSOL Energy Center | $   92.35 |    15 | NHL
2012-08-05 | Chickenfoot          |    Riverplex Amphitheatre | $   62.50 | 1,273 | Concert 
```

格式化程序不完整，但是当我尝试运行它时会失败，所以那里有一些语法错误。我对格式化程序不是很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:36:41.567

您应该确保始终在之后添加类型`%`，在这种情况下，它`%d`

```
String result = String.format( "%4d-%02d-%02d | %-20s| %25s | $%.3f | %5d | %s", thisYear, thisMonth, thisDay, 
                eventName, eventVenue, ticketPrice, ticketsRemaining, eventType); 
```

为了制作一个`,`而不是`.`手表这个[线程](https://stackoverflow.com/questions/4553633/java-float-formatting-depends-on-locale)。

# arrays - 冒泡排序的外环N值

> ID：12805330
> 
> 赞同：1
> 
> 时间：2012-10-09T17:33:16.873
> 
> 标签：arrays, algorithm, sorting

我只是在学习排序（不是第一次）。在冒泡排序中，我们有以下代码。

```
int bubble_sort(int *arr, size_t n) {

    size_t i, j;
    for (i = 0; i < n; i++) {
        for (j = 0; j < n - 1; j++) {
            if (arr[j] > arr[j + 1]) {
                int temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }

    return 0;
} 
```

如您所见，内循环有`n-1`时间（在for循环中），这是可以理解的（`a[i],a[i-1]`都涉及一次迭代），但外循环有`i < n`，但它也适用于`i < n-1`. 但是互联网中的大多数实现都具有 `n`外循环值。对于最坏的情况，执行外循环`n-1`效果很好`5 4 3 2 1`。`n-1`只是想知道，是否有任何一组输入在外循环期间不起作用。如果有请发帖并说明。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:43:47.700

N-1也不错。正如您所描述的，最坏的情况需要 N-1 交换（因为最后一个必须成为第一个，反之亦然）。如果您将 i 变量的打印添加到 if 语句的内部，您将看到它在最后一次迭代中从未被调用。这意味着循环的最后一次迭代永远不会导致任何交换。

不过，更高效的冒泡排序实现不使用 for 循环作为外循环。看看下面的代码。你能看出执行的不同吗？

```
int bubble_sort(int *arr, size_t n) {
    size_t i,j;
    int flag = 1;
    while (flag) {
        flag = 0;
        for(j=0;j<n-1;j++) {
            if(arr[j] > arr[j+1]) {
                int temp = arr[j];
                arr[j] = arr[j+1];
                arr[j+1] = temp;
                flag = 1;
            }
        }
    }
    return 0;
} 
```

通过仅在发生实际交换时设置标志，当您处于平均情况时，您最终会更快地跳出循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:49:22.923

不，没有这样的输入。

理性在冒泡排序的证明中。`i`回想一下，在冒泡排序的第 ' 次（外部）迭代中证明这一点时-`i`最后一个元素就位并排序。

因此，在`n-1`迭代之后，最后一个`n-1`元素就位并排序，只留下剩余的第一个元素——它只能在其正确的位置，即数组中的第一个位置。

（因此，使用这种方法我们可以**证明**冒泡排序`n-1`最多需要外部迭代）

* * *

另请注意：经典冒泡排序只需要`n-i`内部循环中的迭代（因为我上面提到的理性），而不是`n-1`。

# php - 从选择上传的多个图像中，错误的图像被缩略图

> ID：12805331
> 
> 赞同：0
> 
> 时间：2012-10-09T17:33:19.203
> 
> 标签：php, codeigniter, codeigniter-2

在这里有一个带有一堆输入**文本**字段的表单和一个只能接受**多个图像的****文件上传**输入。

 ****需要发生的事情：**

选择一堆图像并单击**提交**按钮后 - 控制器应将文本数据插入一个表中，然后上传所有图像并将其文件名添加到**images**表中，并使用外键链接到插入的文本数据，最后使被选中的第一张图像变成了缩略图，并将其名称和链接到文本数据行的外键也上传到**缩略图**表中。

**发生什么了：**

图像+缩略图被正确上传（或放入上传文件夹而没有任何重复等），但由于某种原因，**最后一张**被选中的图像被缩略图，而不是第一个。

此外，虽然只有**一个**图像被缩略图 - 数据库最终将选择/上传的每个图像的名称添加到缩略图表中，并`_thumb`在其名称中。

**crud.php** *（控制器）*

```
function add()
        {
            //Set validation properties
            $this->_set_fields();

            //Set common properties
            $data['title'] = 'Add new data row';
            $data['message'] = '';
            $data['action'] = site_url('crud/addDataRow');
            $data['link_back'] = anchor('crud/index', 'Back to list', array('class' => 'back'));

            //Load the view
            $this->load->view('templates/header', $data);
            $this->load->view('pages/crud_edit', $data);
            $this->load->view('templates/footer');
        }

        function addDataRow()
        {
            //Set common properties
            $data['title'] = 'Add new data row';
            $data['action'] = site_url('crud/addDataRow');
            $data['link_back'] = anchor('crud/index/', 'Back to list', array('class' => 'back'));

            //Set validation properties
            $this->_set_fields();
            $this->_set_rules();

            //Run validation
            if($this->form_validation->run() == FALSE)
            {
                $data['message'] = '';
            }
            else
            {
                //Get the text data from $_POST
                $data_row = array(
                    'title' => $this->input->post('title'),
                    'text' => $this->input->post('text'),
                    'price' => $this->input->post('price'),
                    'status' => $this->input->post('status'),
                    'type' => $this->input->post('type')
                );

                //Insert text data into table
                $id = $this->crud_model->save($data_row);

                //Now move on to image processing
                //original image upload settings
                $config['allowed_types'] = 'gif|jpg|png';
                $config['max_size'] = '6000';
                $config['max_width']  = '1680';
                $config['max_height']  = '1050';
                $path_to_uploads= './assets/upload';
                $config['upload_path'] = $path_to_uploads;
                $this->load->library('upload', $config);

                $arr_files = @$_FILES['images'];

                $_FILES = array();
                foreach(array_keys($arr_files['name']) as $h){
                    $_FILES["file_{$h}"] = array(
                        'name' => $arr_files['name'][$h],
                        'type' => $arr_files['type'][$h],
                        'tmp_name' => $arr_files['tmp_name'][$h],
                        'error' => $arr_files['error'][$h],
                        'size' => $arr_files['size'][$h]
                    );
                }

                //add this
                $this->upload->initialize($config);

                foreach(array_keys($_FILES) as $h) {

                    if (!$this->upload->do_upload($h)){
                        $error = $this->upload->display_errors();
                        //echo "<script>alert($error);</script>";
                        print($error); die;
                    }else{

                        $upload_data=$this->upload->data();
                        $file_name=$upload_data['file_name'];
                        $full_file_path = $path_to_uploads.'/'.$file_name;

                        $image_row = array(
                        'id_path' => $file_name,
                        'id_data_row' => $id
                        );

                        //Upload original image
                        $this->crud_model->save_image($image_row);

                        if(current($_FILES) == $_FILES['file_0']){
                            //Thumbnail config
                            $config['image_library'] = 'gd2';
                            $config['source_image'] = $full_file_path;
                            $config['create_thumb'] = TRUE;
                            $config['maintain_ratio'] = TRUE;
                            $config['width'] = 150;
                            $config['height'] = 150;

                            $this->load->library('image_lib', $config);

                            $this->image_lib->resize();

                            $thumbnail_row = array(
                            'id_path' => str_replace(".", "_thumb.", $file_name),
                            'id_data_row' => $id
                            );

                            $this->crud_model->save_thumbnail($thumbnail_row);
                        }       
                    }
                }
                //Set form input name="id"
                $this->form_validation->id = $id;

                //Set user message
                $data['message'] = '<div class="success">New data row added!</div>';
            }

            $this->load->view('templates/header', $data);
            $this->load->view('pages/crud_edit', $data);
            $this->load->view('templates/footer');
        } 
```

**crud_model.php** *(模型)*

```
//Add new data row
        function save($data)
        {

            $this->db->insert($this->tbl_data, $data);
            return $this->db->insert_id();
        }

        //Add the original image
        function save_image($data)
        {
            $this->db->insert($this->tbl_images, $data);
            return $this->db->insert_id();
        }

        //Add the thumbnail upload path and id of the row in data table to link them
        function save_thumbnail($data)
        {
            $this->db->insert($this->tbl_thumbnails, $data);
            return $this->db->insert_id();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:48:36.793

您的检查似乎失败了，因此循环每次都一直运行，并用循环的最后一个图像覆盖缩略图。

尝试更改您的支票

```
if(current($_FILES) == $_FILES['file_0']){ 
```

到

```
if($h=='file_0'){ 
```**

# c++ - 点后不带数字打印双

> ID：12805332
> 
> 赞同：0
> 
> 时间：2012-10-09T17:33:33.737
> 
> 标签：c++, double, printf

```
long double ans = fact(n);
fprintf(out,"%lg",ans); 
```

打印点后没有数字的长双精度的最佳（和最短的变体）是什么？我不知道。格式化标志 %lg 不能在这个任务中使用，我应该打印完整的数字。

//对不起我的英语不好，我希望你能理解主要思想..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:38:56.263

`printf ("%.0lg", var)`用于打印小数点后没有数字的`long double`变量。`var`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:38:58.187

如果您不想要小数部分，如何将其打印为 int（或 long）？：

```
fprintf(out,"%d",(int)ans); 
```

# git - git filter-branch duplicated commits

> ID：12805333
> 
> 赞同：5
> 
> 时间：2012-10-09T17:33:40.633
> 
> 标签：git, branch, commit, git-filter-branch

I was rewriting my git repository's author history like explained [here](https://stackoverflow.com/a/392356/1732520), however my original structure turned from

```
D (user 2) <-- master
|
C (user 2)                E (user 1) <-- branch 1
|                         |
+-------------------------+
|
B (user 1)
|
A (user 1) 
```

into

```
D (user 1) <-- master     G (user 2, original/refs/heads/master)
|                         |
C (user 1)                F (user 2)                E (user 1) <-- branch 1
|                         |                         |
+-------------------------+-------------------------+
|
B (user 1)
|
A (user 1) 
```

So the question is, how can I get rid of F and G altogether? `original/refs/heads/master` does not appear to be a branch, but I am also not entirely sure what it is.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:00:40.750

解决了：

```
git update-ref -d refs/original/refs/heads/master 
```

# iphone - How To Implement Custom keyboard with UISearchBar?

> ID：12805334
> 
> 赞同：0
> 
> 时间：2012-10-09T17:34:05.543
> 
> 标签：iphone, xcode, keyboard, uisearchbar

In My application i develope a custom keyboard in one of local language.Now this keyboard works fine with UITextField and UITextView.For both these i implement the Custom keyboard like this.

```
textField.inputView = Customkeyboard;
textView.inputView = Customkeyboard; 
```

But when i implement its for UISearchBar

```
searchBar.inputView = Customkeyboard; 
```

its gives me Following Error.

> error: object cannot be set - either readonly property or no setter found

i also set its property and Synthesis,but unable to solve this problem.Can any one help me to solve this problem.Thanx.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:48:04.657

根据[UIResponder的类文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/cl/UIResponder)

> 该属性的值为 nil。需要自定义视图以从用户那里收集输入的响应程序对象应将此属性重新声明为读写并使用它来管理其自定义输入视图。当接收者随后成为第一响应者时，响应者基础结构会自动呈现指定的输入视图。同样，当视图放弃其第一响应者状态时，响应者基础结构会自动关闭指定的视图。

好的，创建一个继承自 UISearchBar 的类，如下 .h 和 .m 文件。在您的 .h 文件广告中，以下行

> @interface SearchBar : UISearchBar
> @property (readwrite, retain) UIView *inputView;
> @结尾

在您使用它的当前控制器中，将 UISearchBar 替换为 SearchBar。

> searchBar.inputView = 自定义键盘；// 其中 searchBar 是 SearchBar 的对象，而不是 UISearchBar

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:47:40.883

您将无法为搜索栏设置它，也不能从 UIResponder 继承，它的属性 UIView 为只读，但是 UITextField 会覆盖该属性`UITextField`并`UISearchBar`使其成为`readAndWrite`，但 searchBar 不会。

您当然可以创建 UISearchBar 的子类并重新声明该属性，它*可能会*起作用。

# haskell - What's wrong with GHC Haskell's current constraint system?

> ID：12805335
> 
> 赞同：42
> 
> 时间：2012-10-09T17:34:09.603
> 
> 标签：haskell, typeclass

I've heard that there are some problems with Haskell's "broken" constraint system, as of GHC 7.6 and below. What's "wrong" with it? Is there a comparable existing system that overcomes those flaws?

For example, both edwardk and tekmo have run into trouble (e.g. [this comment from tekmo](http://www.reddit.com/r/haskell/comments/113a0n/pipes24_proxy_transformers_extra_categories/c6j3nzx)).

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-11T15:29:44.423

好的，在发帖之前，我与其他人进行了几次讨论，因为我想把这件事做好。他们都向我表明，我描述的所有问题都归结为缺乏多态约束。

这个问题最简单的例子就是`MonadPlus`类，定义为：

```
class MonadPlus m where
    mzero :: m a
    mplus :: m a -> m a -> m a 
```

...具有以下法律：

```
mzero `mplus` m = m

m `mplus` mzero = m

(m1 `mplus` m2) `mplus` m3 = m1 `mplus` (m2 `mplus` m3) 
```

请注意，这些是`Monoid`法律，其中`Monoid`类由下式给出：

```
class Monoid a where
    mempty :: a
    mappend :: a -> a -> a

mempty `mplus` a = a

a `mplus` mempty = a

(a1 `mplus` a2) `mplus` a3 = a1 `mplus` (a2 `mplus` a3) 
```

那么我们为什么还要`MonadPlus`上课呢？原因是因为 Haskell 禁止我们编写形式的约束：

```
(forall a . Monoid (m a)) => ... 
```

因此 Haskell 程序员必须通过定义一个单独的类来处理这种特殊的多态情况来解决类型系统的这个缺陷。

然而，这并不总是一个可行的解决方案。例如，在我自己的`pipes`库工作中，我经常遇到需要对表单提出约束：

```
(forall a' a b' b . Monad (p a a' b' b m)) => ... 
```

与`MonadPlus`解决方案不同，我无法将`Monad`类型类切换到不同的类型类来解决多态约束问题，因为这样我的库的用户会丢失`do`符号，这是要付出高昂的代价。

这在编写转换器时也会出现，包括单子转换器和我的库中包含的代理转换器。我们想写这样的东西：

```
data Compose t1 t2 m r = C (t1 (t2 m) r)

instance (MonadTrans t1, MonadTrans t2) => MonadTrans (Compose t1 t2) where
    lift = C . lift . lift 
```

第一次尝试不起作用，因为`lift`不会将其结果限制为`Monad`. 我们实际上需要：

```
class (forall m . Monad m => Monad (t m)) => MonadTrans t where
    lift :: (Monad m) => m r -> t m r 
```

...但是 Haskell 的约束系统不允许这样做。

随着 Haskell 用户转向更高种类的类型构造函数，这个问题将变得越来越明显。您通常会有以下形式的类型类：

```
class SomeClass someHigherKindedTypeConstructor where
    ... 
```

...但你会想要约束一些低种类的派生类型构造函数：

```
class (SomeConstraint (someHigherKindedTypeConstructor a b c))
    => SomeClass someHigherKindedTypeConstructor where
    ... 
```

但是，如果没有多态约束，则该约束是不合法的。我最近一直是抱怨这个问题的人，因为我的`pipes`库使用了非常高级的类型，所以我经常遇到这个问题。

有几个人向我提出的使用数据类型的解决方法，但我（还没有）有时间评估它们以了解它们需要哪些扩展或哪个扩展正确解决了我的问题。更熟悉这个问题的人可能会提供一个单独的答案，详细说明解决方案及其工作原理。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-11T19:43:12.820

**[加布里埃尔冈萨雷斯回答的后续]**

Haskell 中约束和量化的正确表示法如下：

```
<functions-definition> ::= <functions> :: <quantified-type-expression>

<quantified-type-expression> ::= forall <type-variables-with-kinds> . (<constraints>) => <type-expression>

<type-expression> ::= <type-expression> -> <quantified-type-expression>
                    | ...

... 
```

kinds 可以省略，`forall`rank-1 类型的 s 也可以省略：

```
<simply-quantified-type-expression> ::= (<constraints-that-uses-rank-1-type-variables>) => <type-expression> 
```

例如：

```
{-# LANGUAGE Rank2Types #-}

msum :: forall m a. Monoid (m a) => [m a] -> m a
msum = mconcat

mfilter :: forall m a. (Monad m, Monoid (m a)) => (a -> Bool) -> m a -> m a
mfilter p ma = do { a <- ma; if p a then return a else mempty }

guard :: forall m. (Monad m, Monoid (m ())) => Bool -> m ()
guard True = return ()
guard False = mempty 
```

或没有`Rank2Types`（因为我们这里只有 rank-1 类型），并使用`CPP`(j4f)：

```
{-# LANGUAGE CPP #-}

#define MonadPlus(m, a) (Monad m, Monoid (m a))

msum :: MonadPlus(m, a) => [m a] -> m a
msum = mconcat

mfilter :: MonadPlus(m, a) => (a -> Bool) -> m a -> m a
mfilter p ma = do { a <- ma; if p a then return a else mempty }

guard :: MonadPlus(m, ()) => Bool -> m ()
guard True = return ()
guard False = mempty 
```

“问题”是我们不能写

```
class (Monad m, Monoid (m a)) => MonadPlus m where
  ... 
```

或者

```
class forall m a. (Monad m, Monoid (m a)) => MonadPlus m where
  ... 
```

**也就是说，`forall m a. (Monad m, Monoid (m a))`可以用作独立约束，但不能使用新的类型的单参数类型类来别名`*->*`。**

这是因为类型类定义机制是这样工作的：

```
class (constraints[a, b, c, d, e, ...]) => ClassName (a b c) (d e) ... 
```

即**rhs**端引入类型变量，而不是lhs 或`forall`lhs。

相反，我们需要编写 2 参数类型类：

```
{-# LANGUAGE MultiParamTypeClasses, FlexibleContexts, FlexibleInstances #-}

class (Monad m, Monoid (m a)) => MonadPlus m a where
  mzero :: m a
  mzero = mempty
  mplus :: m a -> m a -> m a
  mplus = mappend

instance MonadPlus [] a
instance Monoid a => MonadPlus Maybe a

msum :: MonadPlus m a => [m a] -> m a
msum = mconcat

mfilter :: MonadPlus m a => (a -> Bool) -> m a -> m a
mfilter p ma = do { a <- ma; if p a then return a else mzero }

guard :: MonadPlus m () => Bool -> m ()
guard True = return ()
guard False = mzero 
```

缺点：我们每次使用时都需要指定第二个参数`MonadPlus`。

问题：如何

```
instance Monoid a => MonadPlus Maybe a 
```

`MonadPlus`如果是单参数类型类可以写吗？`MonadPlus Maybe`来自`base`：

```
instance MonadPlus Maybe where
   mzero = Nothing
   Nothing `mplus` ys  = ys
   xs      `mplus` _ys = xs 
```

不像`Monoid Maybe`：

```
instance Monoid a => Monoid (Maybe a) where
  mempty = Nothing
  Nothing `mappend` m = m
  m `mappend` Nothing = m
  Just m1 `mappend` Just m2 = Just (m1 `mappend` m2) -- < here 
```

：

```
(Just [1,2] `mplus` Just [3,4]) `mplus` Just [5,6] => Just [1,2]
(Just [1,2] `mappend` Just [3,4]) `mappend` Just [5,6] => Just [1,2,3,4,5,6] 
```

* * *

类似地，`forall m a b n c d e. (Foo (m a b), Bar (n c d) e)`如果我们想要`*`类型，则产生 (7 - 2 * 2)-parametric typeclass，类型产生 (7 - 2 * 1)-parametric typeclass，`* -> *`类型产生 (7 - 2 * 0) `* -> * -> *`。

# c++ - How are some applications made in several programming languages?

> ID：12805337
> 
> 赞同：1
> 
> 时间：2012-10-09T17:34:13.017
> 
> 标签：c++

It's been always a question for me how some (web, desktop) applications are made in couple of programming languages. For example, I hear (or read) that some apps such as firefox, photoshop or even amazon.com (logical codes of course) are written in C++ or that blah-blah app core is C++. To get to the point, I wonder how a programmer(s) can integrate some programming languages or modules written in those to build an application in one piece? What exactly is the idea?

Thanks in advance,

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T17:40:14.260

用不同的技术或语言构建应用程序的不同部分可能是有意义的。一些原因可能是：

*   特定组件的性能要求；因此，当其他组件从高级语言中受益更多时，使用低级语言，可以提高开发人员的生产力。
*   “工作的最佳工具” - 呈现表格的技术堆栈可能不适合处理数字。
*   迁移遗留应用程序 - 如果您需要迁移大型代码库，迁移小部分而不是进行一次大爆炸集成（这些往往会失败）可能是有意义的。

如果您使用可以在同一运行时环境中运行的两种不同语言，则组合起来可能很简单。例如，一个同时利用 C# 和 F# 程序集的 .NET 应用程序，或者一个带有链接的部件程序集代码的 C 应用程序。

但是，对于当今的大型应用程序，最常见的情况是通过服务或消息总线技术连接软件组件；将数据和事件从一个组件移动到另一个组件。进程外通信也可以简单到两个组件共享一个数据库或一个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:05:42.197

如果您使用 C++ 工作，您实际上很可能一直在使用用不同语言编写的程序。标准库中的许多函数，例如`operator new`，都是用 Assmebly 语言实现的，以提高速度。

@driis 已经解决了用不同语言编写的组件可以交互的两种主要方式。至少还有一个。

单个应用程序可以由用不同语言编写的多个组件组成。例如，我处理的一个程序有部分是用 C++ 编写的，而其他部分是用汇编编写的。我研究过用 FORTRAN + C 甚至 VB 和 C++ 编写的程序（Ick，不好玩）。

这个想法在概念上很简单。您需要做的就是确保一方知道另一方的函数在内存中的位置，并且双方使用相同的[调用约定](http://en.wikipedia.org/wiki/Calling_convention)进行调用。

调用约定是关于将哪些订单参数和返回地址推送到堆栈以及其他类似内容的协议。

获取函数的地址可能是小菜一碟，也可能是一场噩梦。例如，在 Windows C++ DLL 中，这很容易。只需链接到 .lib 就可以了。让 VB 调用 C 或 C++ 函数有点棘手，因为 VB 不知道如何使用这些 .lib 文件——至少它在过去不知道。你必须做一些棘手的事情，比如[这里](http://www.dreamincode.net/forums/topic/287584-calling-a-function-in-c-dll-from-vb60/)发布的内容。您必须直接加载 DLL，然后分配一个指向函数地址的指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:54:28.493

要回答如何：

最终，所有编译语言和脚本语言都必须转换为给定机器的本机机器代码才能执行。

编译器编程语言在从源代码到可执行二进制文件的过程中通常会经历几个转换阶段——而在这条道路上迈出的一步就是二进制库。

现在，如果有一个标准化的 ABI（应用程序二进制接口）在这样一个级别上标准化函数调用的方式（参数传递、堆栈行为等），那么就有可能编译一组不同的语言来集中在这个 ABI 上，并让链接器将它们链接起来以生成一个可执行的二进制文件，该二进制文件由最初混合多种语言形成。

但是，您不能只在给定平台上选择多种语言。为了支持这个方案，需要有一个前端编译器会聚在这个通用的后端上。

脚本语言也可能对编译语言有所谓的“绑定”，允许它们以相同的方式集成，但在运行时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T17:55:29.460

Firefox 和 Photoshop 具有语言绑定，并具有允许使用其他语言的各种运行时插件。这些是在可扩展性和易于开发性更好并允许进行第三方添加的情况下。

这方面的例子是：

*   Lua 绑定
*   脚本绑定

Amazon 的另一个示例和混合语言允许使用在该特定领域更有意义的语言编写其系统的分布式部分。该部分是否需要很高的速度？C++。是不是有很多逻辑，但你会招致很多回电？节点JS。有很多问题可以用其他语言更容易和更快地解决，而不是坚持使用 Java 或 C++。

这是如何完成的示例：

*   消息传递
*   数据库
*   RPC 调用
*   远程 API

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-10-09T18:00:19.583

我会让我的答案变得简单。

考虑一个 Web 应用程序。它通常用 HTML、Javascript、CSS 和 PHP 编写。其中可能还使用了 SQL。

我将假设您不需要我给出这个极其常见场景的代码示例，而是让您思考考虑这个场景如何回答您的问题。:)

# sql - Working out top 5 places of residence from a normalised live/work relationship table

> ID：12805340
> 
> 赞同：2
> 
> 时间：2012-10-09T17:34:22.853
> 
> 标签：sql

I have a three column table and the column headers are: place of work, place of residence and number of commuters (geocode, geocode, number). For each place of work, I would like to know the top 5 most common places of residence along with the number of commuters. Any ideas on how to do this in SQL?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:10:39.130

不确定您使用的是哪个 RDBMS，但这应该适用于 SQL Server：

```
with MyCTE AS
(
    select *, RANK() OVER (PARTITION BY placeOfWork ORDER BY NumberOfCommuters DESC) AS Rank
    from PlacesOfWorkWork
)
select * from MyCTE where Rank <= 5 
```

# tsql - 如何从 table1 中选择在某些日期之间没有 table 2 记录的记录

> ID：12805342
> 
> 赞同：0
> 
> 时间：2012-10-09T17:34:27.393
> 
> 标签：tsql

我有一个客户表和另一个用于与他们相关的销售活动（电话、电子邮件 ecc）。我需要知道的是，例如，在过去 30 天内，哪些客户没有被联系（没有活动）。

这是我正在尝试做的事情：

```
SELECT crm_customers.id, crm_ customers.companyname
FROM crm_ customers 
LEFT JOIN crm_activities on crm_customers.id = crm_ activities. Customerid
WHERE crm_ activities.createddate < (getDate() – 30) 
```

问题是它会返回活动超过 30 天的客户，即使他们有最近的活动。我只需要获取过去 30 天内没有任何销售活动的客户 感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:38:45.593

这可能会对您有所帮助：使用子查询：

```
select 
    cust.id, cust.compayname
from
    crm_customers as cust
    left join (
        select 
            * 
        from 
            crm_activities 
        where 
            createddate >= (getDate() - 30)
    ) as act on cust.id = act.customerId
where
    act.customerId is null 
```

这样您就可以*排除*在过去 30 天内有活动的所有客户。

* * *

您可能希望通过执行以下操作来进一步清理它：

```
select 
    cust.id, cust.compayname
from
    crm_customers as cust
    left join (
        select distinct 
            customerId 
        from 
            crm_activities where createddate >= (getDate() - 30)
    ) as act on cust.id = act.customerId
where
    act.customerId is null 
```

这是相同的基本思想......唯一的事情是第二个选项只返回带有活动的客户的 ID。我认为这可能会优化外部`where`子句，但它可能会对子查询产生性能影响（没有免费的午餐）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:05:48.480

```
SELECT crm_customers.id, crm_customers.companyname
FROM crm_customers 
LEFT JOIN crm_activities 
  on crm_customers.id = crm_activities.Customerid
 and DATEDIFF(DD, crm_activities.createddate, getdate()) < 30
where crm_activities.Customerid is null 
```

这是连接中的条件与 where 中的条件不同的情况

为了速度，我会怀疑子查询的连接。它为查询优化器提供了更多优化选项。不需要一个独特的。假设 crm_activities.Customerid 已编入索引，这将加入索引。对于子查询，它将使用索引来创建列表，但子查询的输出没有被索引。

将取决于你的数据。我有一张大桌子要测试。

查询计划不同。

在循环连接上它是死热在哈希连接上快两倍在合并连接上快十倍

如果没有一个被排除在外，那将是一场死胡同。
如果许多人被排除在外（在过去 30 年中已联系过），它将出现在哪里。

# c# - Send combination of keystrokes to background window

> ID：12805345
> 
> 赞同：9
> 
> 时间：2012-10-09T17:34:43.033
> 
> 标签：c#, hook

After a lot of research on Stackoverflow and google, it seems that it's difficult to send a combination of keystroke to a background window using it's handle. For example, I want to send CTRL + F. It seems that Sendmessage doesn't work, and sendinput isn't effective because the window needs the focus.

So the my last thought is about hooking: is there anyway to use that way to send combination?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T20:43:22.803

好的，我找到了一种解决方法，但它不适用于所有应用程序。否则，它可以与我想用按键组合控制的程序 puTTY 一​​起使用。即使应用程序没有重点，它也可以工作。所以我现在完成了！

```
class SendMessage
{
[DllImport("user32.dll")]
public static extern IntPtr PostMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

public static void sendKeystroke()
{
    const uint WM_KEYDOWN = 0x100;
    const uint WM_KEYUP = 0x0101;

    IntPtr hWnd;
    string processName = "putty";
    Process[] processList = Process.GetProcesses();

    foreach (Process P in processList)
    {
        if (P.ProcessName.Equals(processName))
        {
            IntPtr edit = P.MainWindowHandle;
            PostMessage(edit, WM_KEYDOWN, (IntPtr)(Keys.Control), IntPtr.Zero);
            PostMessage(edit, WM_KEYDOWN, (IntPtr)(Keys.A), IntPtr.Zero);
            PostMessage(edit, WM_KEYUP, (IntPtr)(Keys.Control), IntPtr.Zero);
        }
    }                           
}

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-22T18:48:11.163

我编写了几个将击键发送到后台窗口的程序，我通常实现 PostMessage/SendMessage。我[在这里](http://dailyoverdose.wordpress.com/2009/10/28/postmessage-and-sendmessage/)记录了我的所有发现！

但是您基本上将使用低级别的 c 调用将消息放入 Windows 消息队列，以允许应用程序获取按键。

[留言](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644944%28v=vs.85%29.aspx)

[发信息](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx)

如果您有任何问题，请告诉我，我的库是用 C# 编写的，我很乐意分享。此方法还允许在背景窗口中使用鼠标:)

所有代码都签入 GitHub：[https ://github.com/EasyAsABC123/Keyboard](https://github.com/EasyAsABC123/Keyboard)

# sql - Avoiding unnecessary joins in an Oracle SQL query

> ID：12805346
> 
> 赞同：2
> 
> 时间：2012-10-09T17:34:44.720
> 
> 标签：sql, oracle, lazy-evaluation

Suppose you have a table as follows:

```
Table Name:  CUSTOMER
Primary Key: CUSTOMER_ID
+-------------+---------------+
| CUSTOMER_ID | CUSTOMER_NAME |
+-------------+---------------+
| 1           | Bill          |
| 2           | Tom           |
+-------------+---------------+

```

Now, suppose you have a `CUSTOMER_ATTRIBUTE` table that lets you tie key/value pairs to a particular `CUSTOMER`:

```
Table Name:  CUSTOMER_ATTRIBUTE
Primary Key: (CUSTOMER_ID, ATTRIBUTE_TYPE_ID)
+-------------+-------------------+-----------------+
| CUSTOMER_ID | ATTRIBUTE_TYPE_ID | ATTRIBUTE_VALUE |
+-------------+-------------------+-----------------+
| 1           | FAVORITE_FOOD     | Pizza           |
| 1           | FAVORITE_COLOR    | Blue            |
| 2           | FAVORITE_FOOD     | Taco            |
| 2           | NAME_OF_PET       | Fido            |
+-------------+-------------------+-----------------+

```

Now, suppose you create a view that represents a customer with some of its possible attributes:

```
CREATE VIEW CUSTOMER_VIEW AS
SELECT
    CUSTOMER.CUSTOMER_ID,
    CUSTOMER.CUSTOMER_NAME,
    FAVORITE_FOOD_ATTRIBUTE.ATTRIBUTE_VALUE AS FAVORITE_FOOD,
    FAVORITE_COLOR_ATTRIBUTE.ATTRIBUTE_VALUE AS FAVORITE_COLOR
FROM
    CUSTOMER

    LEFT OUTER JOIN CUSTOMER_ATTRIBUTE favorite_food_attribute
        ON customer.customer_id = favorite_food_attribute.customer_id
           AND favorite_food_attribute.attribute_type_id = FAVORITE_FOOD

    LEFT OUTER JOIN CUSTOMER_ATTRIBUTE favorite_color_attribute
        ON customer.customer_id = favorite_color_attribute.customer_id
           AND favorite_color_attribute.attribute_type_id = FAVORITE_COLOR 
```

Now, suppose you query this view:

```
SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    FAVORITE_COLOR
    -- Notice: I did not ask for the FAVORITE_FOOD column
FROM
    CUSTOMER_VIEW 
```

According to the explain plan, Oracle is still joining `favorite_food_attribute`, even though its value is not needed and it does not affect the query's cardinality (because it's `LEFT OUTER JOIN`ing to a table's primary key).

Is there a way to force Oracle to avoid these unnecessary joins?

***Update: Example DDL***

Here is some DDL to create the example schema:

```
CREATE TABLE CUSTOMER
(
    CUSTOMER_ID   NUMBER NOT NULL,
    CUSTOMER_NAME VARCHAR2(100)
);

CREATE UNIQUE INDEX CUSTOMER_PK_INDEX
    ON CUSTOMER(CUSTOMER_ID);

ALTER TABLE CUSTOMER
    ADD CONSTRAINT CUSTOMER_PK
    PRIMARY KEY (CUSTOMER_ID)
    USING INDEX CUSTOMER_PK_INDEX;

CREATE TABLE CUSTOMER_ATTRIBUTE
(
    CUSTOMER_ID       NUMBER NOT NULL,
    ATTRIBUTE_TYPE_ID NUMBER NOT NULL,
    ATTRIBUTE_VALUE   VARCHAR2(1000)
);

CREATE UNIQUE INDEX CUSTOMER_ATTRIBUTE_PK_INDEX
    ON CUSTOMER_ATTRIBUTE(CUSTOMER_ID, ATTRIBUTE_TYPE_ID);

ALTER TABLE CUSTOMER_ATTRIBUTE
    ADD CONSTRAINT CUSTOMER_ATTRIBUTE_PK
    PRIMARY KEY (CUSTOMER_ID, ATTRIBUTE_TYPE_ID)
    USING INDEX CUSTOMER_ATTRIBUTE_PK_INDEX;

CREATE OR REPLACE VIEW CUSTOMER_VIEW AS
SELECT
    CUSTOMER.CUSTOMER_ID,
    CUSTOMER.CUSTOMER_NAME,
    favorite_food_attribute.attribute_value AS favorite_food,
    favorite_color_attribute.attribute_value AS favorite_color
FROM
    CUSTOMER

    LEFT OUTER JOIN CUSTOMER_ATTRIBUTE favorite_food_attribute
        ON customer.customer_id = favorite_food_attribute.customer_id
           AND favorite_food_attribute.attribute_type_id = 5

    LEFT OUTER JOIN CUSTOMER_ATTRIBUTE favorite_color_attribute
        ON customer.customer_id = favorite_color_attribute.customer_id
           AND favorite_color_attribute.attribute_type_id = 6; 
```

Now, I run the explain plan on this query:

```
SELECT CUSTOMER_ID FROM HFSMMM.CUSTOMER_VIEW 
```

The plan is:

```
SELECT STATEMENT, GOAL = ALL_ROWS           Cost=1  Cardinality=1   Bytes=65
 NESTED LOOPS OUTER         Cost=1  Cardinality=1   Bytes=65
  NESTED LOOPS OUTER            Cost=1  Cardinality=1   Bytes=39
   INDEX FULL SCAN  Object owner=HFSMMM Object name=CUSTOMER_PK_INDEX   Cost=1  Cardinality=1   Bytes=13
   INDEX UNIQUE SCAN    Object owner=HFSMMM Object name=CUSTOMER_ATTRIBUTE_PK_INDEX Cost=0  Cardinality=1   Bytes=26
  INDEX UNIQUE SCAN Object owner=HFSMMM Object name=CUSTOMER_ATTRIBUTE_PK_INDEX Cost=0  Cardinality=1   Bytes=26

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:06:53.563

不要使用外连接，而是对您希望在视图中看到的每个属性值使用子查询。这是假设您的数据是结构化的，因此没有一个子查询可以返回多行。

```
CREATE VIEW CUSTOMER_VIEW AS
SELECT CUSTOMER_ID,
       CUSTOMER_NAME,
       (SELECT ATTRIBUTE_VALUE FROM CUSTOMER_ATTRIBUTE ca1
          WHERE ca1.CUSTOMER_ID = c.CUSTOMER_ID
          AND ATTRIBUTE_TYPE_ID = 'FAVFOOD')  FAVORITE_FOOD,
       (SELECT ATTRIBUTE_VALUE FROM CUSTOMER_ATTRIBUTE ca2
          WHERE ca2.CUSTOMER_ID = c.CUSTOMER_ID
          AND ATTRIBUTE_TYPE_ID = 'PETNAME')  PET_NAME,
       (SELECT ATTRIBUTE_VALUE FROM CUSTOMER_ATTRIBUTE ca3
          WHERE ca3.CUSTOMER_ID = c.CUSTOMER_ID
          AND ATTRIBUTE_TYPE_ID = 'FAVCOLOR') FAVORITE_COLOR
       FROM CUSTOMER c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:44:58.560

虽然这种方法只是移动处理而不是消除它，但它使 SQL 更清晰。
创建用户函数

```
GET_TYPE(customer_id_in NUMBER, attribute_type_id IN NUMBER) RETURN VARCHAR 2
IS
/*  TO DO:  Assertions, error handling */
attribute_name VARCHAR2(300);
BEGIN
SELECT attribute_value
INTO attribute_name
FROM CUSTOMER_ATTRIBUTE
WHERE customer_id = customer_id_in
and attribute_type_id - attribute_type_in;

RETURN attribute_name;

END GET_TYPE; 
```

然后你的观点是

```
CREATE VIEW CUSTOMER_VIEW as
SELECT  
    CUSTOMER.CUSTOMER_ID,  
    CUSTOMER.CUSTOMER_NAME,  
    GET_TYPE(1, CUSTOMER.CUSTOMER_ID) AS FOOD,
    GET_TYPE(2, CUSTOMER.CUSTOMER_ID) AS COLOR
FROM  
    CUSTOMER; 
```

Adam 正确地指出，在切换上下文时会产生开销，我每天都将其用于视图。我宁愿让数据库提前完成工作以准备视图和查询，而不是让应用程序发送必须构建和缓存的多连接查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:54:34.997

如果您确定每个客户 ID 和属性类型只会有一个条目，则可以执行标量子查询：

```
SELECT
    CUSTOMER.CUSTOMER_ID,
    CUSTOMER.CUSTOMER_NAME,
    (select ATTRIBUTE_VALUE from CUSTOMER_ATTRIBUTE where customer_id = CUSTOMER.CUSTOMER_ID
        and ATTRIBUTE_TYPE_ID='F') AS FAVORITE_FOOD
FROM
    CUSTOMER 
```

# c# - Error while generating CSR and creating .pfx file

> ID：12805351
> 
> 赞同：0
> 
> 时间：2012-10-09T17:35:15.577
> 
> 标签：c#, cryptography

I'm using xenroll to generate CSR, send to CA, create pfx file and make it password protected. It's working in one of the environments but in another I'm getting an error...

My app is hosted on IIS and on webpage I get waiting message and after some time it gives me session time out error (which is normal behavior of any asp.net app), it seems that it displays some popup window and that is hidden somewhere which is not visible to us.

> Description:
> 
> Application popup: Security Warning : You are about to install a certificate from a certification authority (CA) claiming to represent:
> 
> My CA Name
> 
> Windows cannot validate that the certificate is actually from "My CA Name". You should confirm its origin by contacting "My CA Name". The following number will assist you in this process:
> 
> Thumbprint (sha1):
> 
> Warning:
> 
> If you install this root certificate, Windows will automatically trust any certificate issued by this CA. Installing a certificate with an unconfirmed thumbprint is a security risk. If you click "Yes" you acknowledge this risk.
> 
> Do you want to install this certificate?
> 
> For more information, see Help and Support Center at go.microsoft.com/.../events.asp.

Any idea?

# watir - Watir - Span elements

> ID：12805353
> 
> 赞同：2
> 
> 时间：2012-10-09T17:35:19.073
> 
> 标签：watir, html

```
<span id="olLabelCUSTOMERSALL">Text - ALL 
```

In the GUI I see `All` and I can select this via

```
browser_ie.span(:id, "olLabelCONTACTSALL").click 
```

I then tried to set this to a variable like

```
text1 = browser_ie.span(:id, "olLabelCONTACTSALL") 
```

and I thought I would get `ALL` but I don't.

In the html screen shot what is `Text - ALL`? Is that an attribute of the Span element? How would I capture the text `ALL` from this

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:10:24.950

当您这样做时，您将获得 watir span 元素：

```
text1 = browser_ie.span(:id, "olLabelCONTACTSALL") 
```

如果您想要文本，请使用元素的`text`方法：

```
text1 = browser_ie.span(:id, "olLabelCONTACTSALL").text 
```

# paypal - Retrieving PayPal MassPay transaction status with the original correlation ID

> ID：12805354
> 
> 赞同：7
> 
> 时间：2012-10-09T17:35:19.497
> 
> 标签：paypal, masspay

We have a system that sends money to our users via the PayPal MassPay API and it works fine, but here is the problem: **I can't find a way to retrieve the status of the MassPay transaction through PayPal's API**.

The first thing I looked into was using the PayPal 'GetTransactionDetails' API call, but that requires the transaction ID, which is not returned by the original PayPal MassPay API call. When a MassPay is issued, here is the PayPal response: [https://gist.github.com/3860194](https://gist.github.com/3860194)

As you can see in the response, PayPal issues me a correlation ID, but no transaction ID. My next thought was to use the 'TransactionSearch' API call, but that does not accept a correlation ID either. I even tried doing a broad TransactionSearch based on the TransactionClass parameter ('MassPay') and StartDate, but the responses don't contain any information (email or correlation ID) that allows me to know for certain which search result is my original request.

Has anyone worked with PayPal's API to search/retrieve a transaction ID through the correlation ID?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T00:06:40.593

发送 MassPay 后是否正在监听 IPN（即时付款通知）？IPN 响应将包含您已发送的单笔付款的 PayPal 交易 ID。一旦您从 IPN 中获取 trxn ID，您应该能够调用 GetTransactionDetails API - 并获取当前状态。

请注意，IPN 还将包含发送 IPN 时的当前交易状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-19T09:06:18.233

啊Mass Pay 的缺点是它只转到帐户上设置的IPN Url，即使通过API（NVP/Soap）发送Mass Pay 也不能自定义IPN Url

您可以使用 TransactionSearch 和 TransactionClass => MassPay 来查找批量付款的 TransactionId，然后从那里获取详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-22T22:04:10.873

我有时会为我的 masspays 获得 IPN，上面写着

```
payment_status=Denied 
```

和

```
status_1=Failed
status_2=Failed
status_3=Failed 
```

和

```
masspay_txn_id_1=
masspay_txn_id_2=
masspay_txn_id_3= 
```

（假设我在这个集体工资中支付了 3 个人）

虽然我可以使用没有关联 ID 将此 IPN 与我提出的原始批量支付请求相匹配。我在我的系统中遇到了这些幻象付款，而贝宝从未发送给收件人。有没有人有任何建议将批量支付 API 调用的相关 ID 与整个批量支付与其中的个人交易的 NVP 匹配？

# javascript - 我应该用 .prop 还是 .attr 设置标题

> ID：12805356
> 
> 赞同：5
> 
> 时间：2012-10-09T17:35:23.910
> 
> 标签：javascript, jquery

我看到一个评论说

> 最好设置“title”属性，`.prop()`而不是`.attr()`使用至少 1.6 版的 jQuery。

有人可以解释这是为什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T17:39:37.907

我想你很熟悉 和[之间的](https://stackoverflow.com/q/5874652/1048572)[区别`prop``attr`](https://stackoverflow.com/q/5874652/1048572)。

由于[`title`属性](http://www.w3.org/TR/html5/global-attributes.html#the-title-attribute)是由属性[反映](http://www.w3.org/TR/html5/common-dom-interfaces.html#reflect)`title`的，因此实际上没有区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:39:16.280

这取决于。

`prop`用于获取 HTML 对象的属性

`attr`用于获取属性。

jQuery的[prop 文档](http://api.jquery.com/prop/)很好地解释了这一点。

# php - 如何在我的 Linux 服务器中禁用自动文件压缩

> ID：12805363
> 
> 赞同：3
> 
> 时间：2012-10-09T17:35:50.283
> 
> 标签：php, linux, apache, ftp, cpanel

我的客户站点之一托管在基于 linux 的服务器中（使用 CPanel 管理）。当我发布该网站时，我遇到了一个奇怪的问题。

服务器中的所有文件（对于某些特定文件夹）都被压缩。我不是在谈论 GZIP 或相关压缩。即使我上传文件并从服务器打开文件，每个空格和换行符都会被删除。

去除所有空格和换行符会产生几个代码错误（主要是注释）。所以我需要停止这种行为。

请帮助我通过某种方式解决此问题。我通过 CPanel 进行服务器控制（控制有限）。让我通知您，此问题仅对某些文件夹可见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:52:51.193

听起来您的 FTP 程序处于文本模式，并且由于某种原因它正在删除所有空格。这不正常，但请尝试以二进制模式上传，看看是否可以解决问题。

# c++ - 用于检测引用计数智能指针的内存泄漏的设计模式

> ID：12805366
> 
> 赞同：0
> 
> 时间：2012-10-09T17:36:05.603
> 
> 标签：c++, memory-leaks, smart-pointers

我们有自己的智能指针类，它使用基本的 AddRef 和 Release 进行引用计数。

在调试时，我可以看到很多对象没有被正确释放。我可以看到哪些对象没有被释放，但很难找出它们是从哪个位置分配的。

有没有好的设计模式来解决这个问题？

我已经放置了调试语句和 ADDREF 和 RELEASE，当调用 release 时我可以看到引用计数。在某些情况下它大于 1，这意味着指针没有被删除。

如果我开始在 shared_ptr const 上放置断点，那么它将被调用数百次并且很难查明内存泄漏。

似乎创建了一些导致这些泄漏的循环引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:39:03.290

不要为此使用设计模式。不要仅仅为了检测泄漏而添加代码膨胀。

使用记忆工具。我想到了 Valgrind，还有一些用于 Windows 的商业产品。

还...

> 我可以看到哪些对象没有被释放，但很难找出它们是从哪个位置分配的。

为什么？在对象的构造函数中设置断点。或者使用标准指针 ( `std::shared_ptr`, `std::unique_ptr`)。

### 根据您的编辑：

> 我已经放置了调试语句和 ADDREF 和 RELEASE，当调用 release 时我可以看到引用计数。在某些情况下它大于 1，这意味着指针没有被删除。

您是否考虑了复制省略 (RVO/NRVO)？这似乎更有可能是原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:23:26.560

几年前，之前`auto_ptr`，我编写了自己的智能指针类，我们在代码库中广泛使用了它。当然，里面塞满了虫子。

我有完全相同的问题。虽然我无法向您展示我用来识别资源泄漏源的调用站点的实际代码（因为代码不再存在），但我可以告诉您我做了什么。

第一件事是我写了一个`#define`宏 >SHUDDER<，类似于我[在这里](https://stackoverflow.com/a/4196475/241536)概述的那个，我可以用它来代替`new`分配我的对象。宏向智能指针发送附加参数，指示调用站点的文件和行号。智能指针会保留这个。

然后`new`，当我说出`#defines`打开此功能的神奇咒语时，我用我的宏替换了全局。显然，这应该在所有 Releasse 版本中禁用，并且仅在您实际调试*this*时在 Debug 版本中使用。

然后我让我的程序运行，直到我想查看所有呼叫站点。我会`dump_call_sites()`在那里的智能指针上执行一个方法，它将`static` `vector`调用站点字符串转储到标准输出。因此发现了问题，我会恢复所有那些神奇的咒语来关闭所有这些 hokus pokus。

这是真正的 hack-n-slash 编码。它远非优雅，它引入了它自己的一系列问题。但随着`printf`调试，它也有它的位置。如果您不想或无法加载您的 Rational Purify 或 Bounds Checker 类型的产品，这可以帮助您快速确定泄漏的来源。

# python - 无法在两个 boto.cfg 文件之间切换

> ID：12805370
> 
> 赞同：3
> 
> 时间：2012-10-09T17:36:13.780
> 
> 标签：python, amazon-s3, boto

我有两个*boto.cfg*文件，一个用于 QA，另一个用于生产。我可以动态选择要选择的*boto.cfg*。当我选择 QA 并打电话时，`get_all_buckets()`我会得到所有的 QA。但是当我更改为生产时，它仍会返回 QA 存储桶。我的脚本在 python 中。

有没有办法可以禁用 boto 连接？我试图退出 Python 并创建一个新对象，但它仍然返回 QA 存储桶，尽管*boto.cfg*已更新为生产凭据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:37:15.593

您确定要获取不同的凭据吗？在不同的 Python 会话中没有保留状态。尝试使用每个配置文件运行这个小脚本：

```
>>> import boto
>>> print boto.config.get_value('Credentials', 'aws_access_key_id') 
```

每次打印的值都不同吗？如果没有，您可以尝试使用两个配置文件，boto1.cfg 和 boto2.cfg，然后将环境变量 BOTO_CONFIG 设置为指向其中一个。

# java - Java 模运算符

> ID：12805373
> 
> 赞同：3
> 
> 时间：2012-10-09T17:36:34.313
> 
> 标签：java, modulo

> **可能重复：**
> [浮点不准确示例](https://stackoverflow.com/questions/2100490/floating-point-inaccuracy-examples)

在 java 中使用模运算符时，我没有得到我期望得到的数字。

这是我在做什么：

```
double input = 5.59;
System.out.println("Output: " + (input % 2)); 
```

我希望看到 1.59 作为结果，但它打印出 1.5899999999999999。关于为什么会这样的任何线索？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T17:40:39.180

这来自浮点不准确性，[这是一个很好的 SO 答案，准确地解释了正在发生的事情。](https://stackoverflow.com/a/2100502/874257)

如果您希望它四舍五入您需要使用如下格式的数字：

```
double input = 5.59;
System.out.format("Output: %.2f%n", (input % 2)); 
```

*   “%”告诉格式化程序用第一个数字参数替换自己。您可以根据需要添加任意数量的这些。
*   “.2”告诉格式化程序将数字格式化为小数点后两位。
*   “f”只是告诉格式化程序它是一个浮点数。
*   “%n”是适用于运行应用程序的平台的换行符。您应该始终使用“%n”，而不是“\n”。

[这是所有这一切的一些很好的文档。](http://docs.oracle.com/javase/tutorial/java/data/numberformat.html)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:46:57.967

这是因为 Double 的精度。您需要对其进行格式化以实现所需的输出。

```
double input = 5.59;
System.out.println("Output: " + new DecimalFormat("00.00").format(input % 2)); 
```

它将打印输出：1.59

# gcc - 如何通过汇编预处理器传递--defsym？

> ID：12805375
> 
> 赞同：1
> 
> 时间：2012-10-09T17:36:40.103
> 
> 标签：gcc, assembly, arm

这是关于一些使用通用 makefile 的 arm 汇编代码，但对于需要预处理的文件 (xxx.S) 和不需要预处理的文件 (xxx.s) 的行为不同。在我的makefile中，我有这个：

```
ASFLAGS += --defsym BACKDOOR_ADDR=0xC0004000 
```

这似乎适用于所有未预处理的旧程序集文件（xxx.s）。现在我有一个确实需要预处理（xxx.S），我收到以下错误：

> ```
> arm-none-eabi-gcc: error: unrecognized option '--defsym' 
> ```

我试过这个：

```
ASFLAGS += -Wa,--defsym,BACKDOOR_ADDR=0xC0004000 
```

它适用于 xxx.S 文件，但不适用于 xxx.s 文件。我从 xxx.s 文件的汇编程序中收到以下错误：

> 汇编程序消息：致命错误：无效的列表选项“，”

有没有办法对这两种情况都有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T22:46:07.603

调整你的makefile，以便“旧”xxx.s 文件也使用gcc 组装，然后第二个选项（使用-Wa）应该可以工作。

# activemq - ActiveMQ 的用途是什么——我们可以使用数据库应用消息传递概念吗？

> ID：12805377
> 
> 赞同：117
> 
> 时间：2012-10-09T17:36:42.213
> 
> 标签：activemq

我查了一下，它曾经在两个系统之间发送消息。
但为什么？你为什么不直接使用 a `Database`？
一定有一些`ActiveMQ`没有的功能`Databases`？

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2012-10-09T18:34:56.880

它用于在两个分布式进程之间进行可靠的通信。

是的，您可以将消息存储在**数据库**中以在两个进程之间进行通信，但是，一旦收到消息，您就必须接收`DELETE`消息，*这意味着一行`INSERT`和`DELETE`每条消息。*
当您尝试**扩大**每秒传达数千条消息的规模时，**数据库往往会崩溃**。

`ActiveMQ`另一方面，面向消息的中间件 [MOM] 就是为处理这些用例而构建的。
他们假设健康系统中的消息将**很快被删除，并且可以进行优化以避免开销**。

它还可以将消息推送给消费者，而不是消费者必须通过执行 SQL 查询来轮询新消息。
这进一步减少了处理发送到系统的新消息所涉及的延迟。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2012-10-09T18:24:52.490

`ActiveMQ`，或者一般来说，所有面向消息的中间件 (MOM) 实现都是为了在两个应用程序之间或一个应用程序内的**两个组件之间发送消息而设计的。**

从本质上讲，MOM 和数据库共享一个共同的基础，因为它们提供可以读取和写入的事务性和持久性数据存储。
最大的区别在于使用模式 - 数据库非常通用并且针对多个表的复杂搜索进行了优化，MOM 针对读取消息进行了优化，一次一个，以类似 FIFO 的方式 [Queue]。

`JMS`是 ActiveMQ 实现的 API，是 Java 企业应用程序的重要基石。这使得消息共享一种相当通用的格式和语义，这使得不同应用程序之间的集成更容易。

当然，还有很多只有 ActiveMQ 才有的更详细的特性，像`OpenWire`,`STOMP`和`MQTT`,这样的有线协议`JMS`，以及`EIP`Apache Camel，像“请求/回复”和“发布/订阅”这样的消息模式，JMS 桥接，集群（“经纪人网络”），它允许扩展和分发等。
如果您有兴趣，您应该阅读这些主题，因为它们相当大。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-01-23T17:54:24.900

`ActiveMQ`具有出色的**调度程序**支持，这意味着您可以**安排在特定时间发送您的消息**。

我们已使用此功能向在医疗保健场景中上传药物详细信息的患者发送药物提醒。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-03-28T13:17:17.913

使用 RDBMS，当您处理一行数据时，您通常会更新一个指示该行已被处理的标志，以便不再重复处理。

但是，使用消息队列，您只需确认一条消息，下一个消费者将处理下一个消息。

不同之处在于，与 activmeq`UPDATE`中的相比，RDBMS 中的语句是一个非常慢的操作`acknowledge`。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-02-22T15:52:32.960

来自[维基百科](https://en.wikipedia.org/wiki/Apache_ActiveMQ)

> Apache ActiveMQ 是一个用 Java 编写的开源消息代理以及完整的 Java 消息服务 (JMS) 客户端。它提供“企业功能”，在这种情况下，这意味着促进来自多个客户端或服务器的通信

关于您的查询：

> 为什么不使用数据库？

您应该将数据库用于持久数据，而不是用于临时数据。假设您必须从 Sender 向 Receiver 发送消息。接收消息时，接收者执行一项操作（接收、处理和忘记）。处理完该消息后，您根本不需要该消息。在这种情况下，将消息存储在持久数据库中并不是一个正确的解决方案。

如果您使用数据库而不是消息传递系统，我完全同意*@Hiram Chirino关于在数据库中插入和删除消息的回答。*

[这篇文章](https://dzone.com/articles/what-activemq)和这篇[文章](http://blog.christianposta.com/activemq/what-is-activemq/)的好处

1.  **企业集成**：允许使用不同语言和不同操作系统构建的应用程序相互集成
2.  **位置透明性**：客户端应用程序不需要知道服务应用程序的位置
3.  **可靠的通信**——消息的生产者/消费者不必同时可用
4.  **扩展**——可以通过添加更多服务来水平扩展
5.  **异步通信**——客户端可以触发消息并继续其他处理，而不是阻塞，直到服务发送响应；
6.  **减少耦合**——由于前面的 5 个好处，客户和服务所做的假设大大减少。服务可以更改有关其自身的详细信息，包括其位置、协议和可用性，而不会影响或中断客户端。

> ActiveMQ 一定有数据库没有的功能吗？

有许多。查看[文档](http://activemq.apache.org/features-overview.html)页面了解更多详细信息。也看看[用例](http://activemq.apache.org/use-cases.html)。

查看此[演示文稿](http://www.slideshare.net/rajdavies/enterprise-integration-patterns-with-activemq)以了解 ActiveMQ 的内部结构。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-09-25T07:14:29.910

我想强调以下几点：

**解耦**：系统能够在不连接的情况下进行通信。队列位于系统之间，一个系统故障永远不会影响另一个系统，因为通信是通过队列完成的。系统在启动时继续工作。

**恢复支持**：队列本身中的消息保持不变。如果队列失败，消息可以稍后恢复。

**可靠通信**：考虑一个处理客户请求的系统。在正常情况下，系统每分钟接收 100 个请求。当请求数量超过平均水平时，该系统是不可靠的。在这种情况下，Queue 可以管理请求，并且可以根据系统吞吐量定期推送消息而不会破坏它。

**异步**：客户端服务器通信是非阻塞的。一旦客户端向服务器发送请求，它就可以在不等待响应的情况下执行其他操作。当收到响应时，客户端可以随时处理。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-12-09T16:41:51.917

假设您有一个同时在多个位置使用的应用程序。还假设您的应用程序必须每分钟处理 1000 次请求或类似的操作，因此正常的数据库操作无法处理此类操作，Activemq 充当消息处理，它将所有消息放入队列中，因此即使您的应用程序之一在一个位置崩溃其他位置不会受到影响。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-11T06:57:04.793

考虑以下通用用户场景

**用户场景**

*   客户上传文本文档
*   您的应用程序将文本文档转换为 PDF
*   您的应用程序通过电子邮件将 PDF 发送回客户

**基于队列的系统的数据库** 在这种情况下，您可能会考虑为您的 PDF 作业线使用数据库。通常，您会创建一个数据库表，其中包含一行与 PDF 需求相关的记录。那时你会在表中打个招呼，说明任务处于哪个状态以及任务是否完成。

```
INSERT INTO pdf_job_queue (name, status, email) VALUES ("White paper", "NEW", "myemail@example.com");

SELECT * FROM pdf_job_queue WHERE queue = 'resize_queue' AND handled = false ORDER BY date_recived limit 1; 
```

您需要编写代码将新请求插入数据库。从数据库获取输入的代码，可能会更改状态列，例如“ `NEW`”和“ `PROCESSING`”值，处理请求的代码，再次将数据库状态字段更新为“ `FINISHED`”的代码，以及删除来自队列的请求。

```
update pdf_job_queue set Status="FINISHED" where Id = 'SomeId'; 
```

为了有效地操作，您可能需要快速且频繁地轮询数据库。当然，这会给数据库和您的应用程序增加很大的负载。

**消息队列** 当您尝试通过使用消息队列来实现相同目的时。

**实时** 推送来自消息行的消息是实时推送的，而不是偶尔从数据库中调查。可以熟练地使用消息行来支持更大数量的并发消息。消息行中的消息在被获取后自然会被清理。

**ACKNOWLEDGMENT** 一个确认从worker发回，告诉消息队列一个特定的消息已经被接收和处理并且消息队列可以自由地删除它。如果工作人员在没有发送确认的情况下死亡，消息队列将了解消息未完全处理并将其重新传递到队列和另一个工作人员。这样您就可以确保不会丢失任何消息。

对于消息队列系统，我总是推荐[ActiveMQ](https://www.openlogic.com/blog/what-apache-activemq)，因为它易于安装、配置并且非常易于扩展。

# php - 在 PHP 中将日期作为 XML 节点访问

> ID：12805378
> 
> 赞同：1
> 
> 时间：2012-10-09T17:36:42.630
> 
> 标签：php, rss

> **可能重复：**
> [PHP SimpleXML 命名空间问题](https://stackoverflow.com/questions/6027398/php-simplexml-namespace-problem)

我正在编写一个 PHP 脚本来将 RSS 提要解析到网页。问题是访问日期节点。我认为 PHP 很困惑，因为`date()`它是一个 PHP 函数。

```
<?php 

  $streamData = simplexml_load_file('http://www.naps.org/index.php/rss/','SimpleXMLElement', LIBXML_NOCDATA);

  foreach ($streamData->channel->item as $item){
      $itemTitle = ($item->title);
      $itemLink = ($item->link);
      $itemDate = date_parse($item->date);
      $itemYear = $itemDate[year];
      $itemMonth = $itemDate[month];
      $itemDay = $itemDate[day];
      $itemOutputDate = $itemYear.'-'.$itemMonth.'-'.$itemDay;
      echo $itemOutputDate;
  }
?>
// echos...
--
--
--
--
-- 
```

如何访问`$item->date`节点？

编辑

它实际上是`<dc:date>`我试图访问的节点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:53:54.420

日期在`dc`我们可以看到指向的命名空间下`http://purl.org/dc/elements/1.1/`，例如：

```
$streamData = simplexml_load_file('http://www.naps.org/index.php/rss/','SimpleXMLElement', LIBXML_NOCDATA);

foreach ($streamData->channel->item as $item)
{
    $dc = $item->children('http://purl.org/dc/elements/1.1/');

    $itemDate = date_parse($dc->date);
    $itemYear = $itemDate['year'];
    $itemMonth = $itemDate['month'];
    $itemDay = $itemDate['day'];

    $itemOutputDate = $itemYear.'-'.$itemMonth.'-'.$itemDay;

    echo $itemOutputDate;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:58:30.190

```
$streamData->registerXPathNamespace("dc", "http://purl.org/dc/elements/1.1/");
$nodes = $streamData->xpath("//item/dc:date"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:44:36.377

如果您的数据源没问题，那么这对我来说适用于 simplexml：

（字符串）$项目->日期

# php - CakePHP Validation::naturalNumber() 不工作

> ID：12805379
> 
> 赞同：0
> 
> 时间：2012-10-09T17:36:47.150
> 
> 标签：php, validation, cakephp, cakephp-2.1

早上好（至少在亚利桑那州）。

我正在对模型进行简单的验证检查。没有什么花哨。

```
$this->loadModel('Something');
$data = array(
    'foo_id' => '1',
    'bar' => 'John'
); 
$this->Something->save($data);

----------------------------------------

class Something extends AppModel {
    public $validate = array(
        'foo_id' => array(
            'notEmpty' => array(
                'rule' => 'notEmpty',
                'message' => 'Foo id is missing',
                'required' => true
            ),
            'naturalNumber' => array(
                'rule' => 'naturalNumber',
                'message' => 'Foo id must be greater than 0',
                'required' => true
            )
        )
    );
} 
```

这应该很容易，但`Something.foo_id`总是无法通过自然数验证。注意`Something.id`没有定义，所以`save()`应该运行一个`INSERT`. 我已经确认该值大于 0，甚至强制它为整数。我没有想法，如果有人能冒险猜测发生了什么，我将不胜感激。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:48:13.023

如果您查看文档 ( [http://book.cakephp.org/2.0/en/models/data-validation.html#Validation::naturalNumber](http://book.cakephp.org/2.0/en/models/data-validation.html#Validation::naturalNumber) ) 或升级指南 ( [http://book.cakephp.org /2.0/en/appendices/2-2-migration-guide.html](http://book.cakephp.org/2.0/en/appendices/2-2-migration-guide.html)）你应该能够注意到这个规则已经被添加到 2.2

所以要么升级或手动将此规则添加到您的应用模型

# c++ - 浮点除法和隐式舍入

> ID：12805380
> 
> 赞同：2
> 
> 时间：2012-10-09T17:36:58.920
> 
> 标签：c++, casting, floating-point

我在我编写的一段代码中发现了一个奇怪的行为，当我尝试从程序中重现它时（即使用 MATLAB）不会发生这种行为。

我正在对数组进行如下操作：

```
a[i] = a[i] / (sqrt(b[i]) * sqrt(c[i])); 
```

其中`a`和是浮点类型`b`的`c`数组。的值`a`和之前`b`的`c`除法范围从`2000`到`6000000`

运算的结果对于数组的所有元素都是零，但是分别看分子和分母的值，对于给定的元素，运算`89509.0 / 90240,375`是等于`0,991895258`。

所以，我想知道为什么程序中使用 float 的完整操作不起作用，并且它按预期单独工作。可能是由于数小时的混淆调试？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T17:48:28.963

当我遇到类似的情况时，我发现将其分解为多个步骤并查看哪些步骤运行正常而哪些不正常通常会有所帮助。例如，为此，它可以分解为以下内容：

```
float sqrtb = sqrt(b[i]);
float sqrtc = sqrt(c[i]);
float divisor = srqtb * sqrtc;
float dividend = a[i];
float quotient = dividend / divisor;
a[i] = quotient; 
```

现在我可以遍历每个项目并查看失败的地方（如果失败）。事实是，当我这样做时，我经常在创建步骤时发现问题，然后将其修复。

# asp.net - 将 asp:Label 文本绑定到 appSetting

> ID：12805383
> 
> 赞同：1
> 
> 时间：2012-10-09T17:37:11.967
> 
> 标签：asp.net, web-config, webforms

我已经接管了一个 ASP.NET WebForms 项目的维护工作，我不知道以前的开发人员是如何实现一些功能的。基本上他在母版页中有一个空的 Label 控件：

```
<asp:Label ID="MyLabelControl" runat="server"></asp:Label> 
```

这作为 Web.Config 中的 applicationSetting：

```
<setting name="MyLabelControl" serializeAs="String">
    <value>Test</value>
</setting> 
```

并且不知何故，标签填充了应用程序设置的值。我到处搜索，找不到他将设置值绑定到标签的位置。如果是我，我会在母版页的 Page_Load 方法中执行此操作，但这是空的。有什么我不知道的特殊绑定吗？

我以前做过一些基本的 WebForms 工作，但在此之前，我的大部分 ASP.NET 工作都是在 MVC 和 Razor 中完成的。是的，我正在倒退:)。在理解他是如何做到这一点时，你能给我的任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:43:33.287

您可以搜索此代码

```
NameValueCollection appSettings = ConfigurationManager.AppSettings;
MyLabelControl.Text = appSettings[MyLabelControl]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:53:53.830

如果 Aghilas 的建议没有给你任何东西，我会先看看这个答案：[Get value from web.config applicationSettings into ASP.NET markup](https://stackoverflow.com/questions/6073914/get-value-from-web-config-applicationsettings-into-asp-net-markup)

您可能需要在系统范围内进行一些搜索，就好像该站点较旧一样，它也可能仍在使用不推荐使用的方法来读取配置文件。在这种情况下，您可能想要搜索类似以下内容的内容：

ConfigurationSettings.AppSettings.Get("我的设置")

并尽快升级那只小狗以使用 ConfigurationManager！

（不过，我确实在 CodeProject 上看到了一篇有趣的文章，该文章警告不要在课堂上使用它……没有通读它，但可能是一种“友好警告”之类的东西：[http://www.codeproject.com/Articles/196563/Don-t-use-ConfigurationManager](http://www.codeproject.com/Articles/196563/Don-t-use-ConfigurationManager)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:07:06.517

也许更改标签的名称，看看是什么崩溃？你知道，引入一个错误，看看弹出什么不再工作......

# macos - 忽略文件....libgcc.a，文件是为存档而构建的，它不是被链接的架构（x86_64）

> ID：12805384
> 
> 赞同：0
> 
> 时间：2012-10-09T17:37:13.680
> 
> 标签：macos, linker, x86-64, llvm-gcc

基本上，我想运行一个 .cpp 并链接几个 .a 文件和 gcc、fortran。命令如下

> g++ -L/Users/myhome/Ipopt-3.10.0/build/lib -lipopt -L/Users/myhome/lcoinmumps -lpthread -framework vecLib **-L/Developer/usr/llvm-gcc-4.2/lib/gcc/i686 -apple-darwin11/4.2.1** -L/usr/local/gfortran/lib -lgfortran **-lgcc_static -lcc_kext -lgcc** -lSystem -framework vecLib -framework vecLib -lm -ldl -o cpp_example cpp_example.cpp

错误显示为

> ld：警告：ld：警告：忽略文件**/Developer/usr/llvm-gcc-4.2/lib/gcc/i686-apple-darwin11/4.2.1/libgcc_static.a**，**文件是为存档而构建的，这不是架构链接（x86_64）**：/Developer/usr/llvm-gcc-4.2/lib/gcc/i686-apple-darwin11/4.2.1/libgcc_static.a 忽略文件/Developer/usr/llvm-gcc-4.2/lib/gcc/ i686-apple-darwin11/4.2.1/libgcc.a，文件是为存档而构建的，它不是被链接的架构（x86_64）：/Developer/usr/llvm-gcc-4.2/lib/gcc/i686-apple-darwin11 /4.2.1/libgcc.a

架构 x86_64 的未定义符号：“MyNLP::MyNLP()”，引用自：ccY99KRH.o 中的 _main ld：未找到架构 x86_64 的符号 collect2：ld 返回 1 个退出状态

如粗体文本所示，错误似乎是我在 32 位内核或 CPU 上运行。但是我使用的是 x86_64：我已经根据[此处](http://arstechnica.com/apple/2009/08/mac-os-x-10-6/5/)更改了 boost.plist，并且“关于 mac”清楚地证明了我现在使用的硬件和软件都是 64 位的。

[这里](https://stackoverflow.com/questions/1455720/mac-osx-10-6-compiler-a-puzzling-experience-with-32-vs-64-bit)似乎已经解释了mac架构（？）以某种方式无法识别64位。

但是当我将文件（.a .cpp .h）添加到 Xcode 并一起运行项目时，它工作正常。

任何人都知道为什么命令行不起作用？为什么我的 libgcc(i686-apple-darwin11-llvm-gcc-4.2) 无法识别为 64 位版本？最重要的是，如何让命令发挥作用？

顺便说一句，我的系统是狮子 10.7.4

# java - 在 Callable 中处理 Thread.interrupted() 的正确方法？

> ID：12805391
> 
> 赞同：8
> 
> 时间：2012-10-09T17:38:06.653
> 
> 标签：java, multithreading, future, callable

在 Callable 中处理 Thread.interrupted() 的正确方法是什么？我猜这个callable应该抛出一个InterruptedException；例如：

```
public class MyCallable implements Callable<Object> {
    public Object call() {
        Object result = null;

        // Simulate long-running operation that calculates result
        while (true) {
            ...
            if (Thread.interrupted()) {
                throw new InterruptedException();
            }
        }

        result = ... // something produced by the long-running operation    

        return result;
    }
} 
```

这是正确的，还是有更合适的方法来处理它？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T17:40:36.517

**编辑**：

经过一番来回之后，您似乎希望能够中断您的 IO 例程。`InterrutibleChannel`对于某些 NIO类来说，这似乎是一项不错的工作。例如，从以下内容读取`BufferedReader`是可中断的并且会抛出`InterruptedIOException`. [有关NIO 代码的更多示例，](http://www.forward.com.au/javaProgramming/HowToStopAThread.html)请参见此处。

```
BufferedReader in = new BufferedReader(new InputStreamReader(
    Channels.newInputStream((new FileInputStream(
        new File(...))).getChannel()))); 
```

然后，您可以调用`future.cancel()`which 将中断您的线程并导致 IO 抛出`InterruptedIOException`. 如果发生这种情况，您将*无法*捕获`IOException`并让它从`call()`方法中流出。

* * *

如果您想传回`Future`该`call()`方法被中断的情况，那么我认为投掷`InterruptedException`很好。另一种选择是仅使用您的方法中`return null;`的其他标记对象或其他标记对象。`call()`如果线程被中断，这通常是我所做的。

要记住的一件事是，如果`call()`抛出`InterruptedException`，当您执行 a 时，`future.get()`它会抛出 a`ExecutionException`并且该异常的*原因*将是 a `InterruptedException`。不要混淆，如果超时，`future.get()`它也会抛出一个`InterruptedException`自身`get(long timeout, TimeUnit unit)`。

```
 try {
     result = future.get();
 } catch (ExecutionException e) {
     if (e.getCause() instanceof InterruptedException) {
        // call() method was interrupted
     }
 } catch (InterruptedException e) {
     // get was interrupted
 } 
```

但是，如果`future.cancel(true)`被调用，`future.get()`则将改为抛出 a `CancellationException`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:46:32.877

这实际上取决于您希望线程如何等待`get()`。如果您*不*希望等待线程抛出异常，那么您不希望`throw new InterruptedException`

想象

```
try{
  future.get();
}catch(ExecutionException ex){

}catch(InterruptedException em){

} 
```

如果发生任何异常，您希望它是什么？在你的情况下，它是一个`ExecutionException`. 如果你不想要一个`ExecutionException`那么你不应该重新抛出 InterruptedException。

# php - mhash_keygen_s2k() 的替代方案

> ID：12805393
> 
> 赞同：1
> 
> 时间：2012-10-09T17:38:16.937
> 
> 标签：php, hash, mcrypt, s2k, mhash

[`mcrypt_encrypt`手册页](http://php.net/manual/en/function.mcrypt-encrypt.php)说：

> **建议使用`mhash`函数从字符串创建密钥。**

但是手册的[介绍`mhash`](http://php.net/manual/en/intro.mhash.php)说：

> **注意：**此扩展已被 Hash 淘汰。

然而，我能找到的最接近这个相当有用[`mhash_keygen_s2k()`](http://php.net/manual/en/function.mhash-keygen-s2k.php)的功能的是[`hash_pbkdf2()`](http://php.net/manual/en/function.hash-pbkdf2.php)函数。但是，我什至不确定它是否适合这份工作，因为它只存在于 SVN 中。

那么，我可以依赖`mhash`扩展，否则它最终会被弃用和丢弃？如果是这样，是否有任何替代的内置函数或者我必须自己实现 Salted S2K 算法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:57:40.960

我最终窥视了将其移植到 PHP 的 mhash 源代码：

```
function keygen_s2k($hash, $password, $salt, $bytes)
{
    $result = false;

    if (extension_loaded('hash') === true)
    {
        foreach (range(0, ceil($bytes / strlen(hash($hash, null, true))) - 1) as $i)
        {
            $result .= hash($hash, str_repeat("\0", $i) . str_pad(substr($salt, 0, 8), 8, "\0", STR_PAD_RIGHT) . $password, true);
        }

        $result = substr($result, 0, intval($bytes));
    }

    return $result;
} 
```

如果有人知道任何替代的内置功能，我仍然想听听。

# python - 运行“pip install -r requirements.txt”时未激活 virtualenv

> ID：12805396
> 
> 赞同：2
> 
> 时间：2012-10-09T17:38:33.173
> 
> 标签：python, virtualenv, pip

我在 AWS ec2 上运行 ubuntu 10.04 虚拟机。

以下是发生在我身上的事情：

```
source bin/activate
(env)$ pip install -r requirements.txt
(env)$ yolk -l  # no package was installed in my env
deactivate
$ yolk -l  # all packages were installed into /usr/lib and /usr/local

source bin/activate
(env)$ pip install simplejson==2.3.0
(env)$ yolk -l  # simplejson was installed in my env 
```

一个附带问题是如何删除不在我的环境中的所有包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-07T16:56:17.130

我遇到了同样的问题，激活了 virtualenv 和 pip install -r requirements.txt 安装在 env 之外（在我的基本 python 安装的站点包中）。原来是所有权导致了这个问题，我试图安装到的 virtualenv 是由 root 拥有的，而不是当前活动的用户。换句话说，检查您要安装到的 virtualenv 的所有者。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-09T17:43:07.213

尝试

```
workon env
pip install -r requirements 
```

`env`应该是您的虚拟环境的名称

# c# - 通过跨域 XML 使用 jquery 进行 post webservices 调用

> ID：12805408
> 
> 赞同：1
> 
> 时间：2012-10-09T17:39:01.907
> 
> 标签：c#, web-services, jquery-mobile, cross-domain

我正在尝试从基于 ASP.NET 的 jQuery 移动网站进行 Web 服务调用。Web 服务采用 post 参数并返回 XML。我无法更改网络服务端。

我面临跨域问题，据我了解，我需要使用代理。

我正在考虑使用通用处理程序，但我不知道该怎么做。

我的服务方法如下所示：

```
https://myserver.com/WCF/Info.svc/MyMehod1
https://myserver.com/WCF/Info.svc/MyMehod2 
```

并取 Post 参数

在 c# 中这样做的好方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:17:24.023

看看这个问题：[Accessing web Service from jQuery - cross domain](https://stackoverflow.com/questions/2697557/accessing-web-service-from-jquery-cross-domain)

作为替代方案，您还可以创建一个使用 jQuery Ajax 调用的 HttpHandler。然后，处理程序可以调用 Web 服务并将输出写入 Http 响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T15:54:55.920

我终于让它工作了。

对于那些有同样问题的人，

在客户端，我使用了一个通用处理程序来进行 Web 服务调用并公开结果。

处理程序示例：

```
public void ProcessRequest(HttpContext context)
{
    string method = context.Request.QueryString["method"].ToString().ToLower();

    if (method == "MyMethod1")
    {
        context.Response.ContentType = "text/plain";
        context.Response.Write(CallWebService(method, param));
        context.Response.Cache.SetCacheability(HttpCacheability.NoCache);
    }
    else if (method == "MyMethod2")
    {
        context.Response.ContentType = "text/plain";
        string param = "myparam";
        context.Response.Write(CallWebService(method, param));
        context.Response.Cache.SetCacheability(HttpCacheability.NoCache);
    }
    else
    {
    //context.Response.ContentType = "text/plain";
    //context.Response.Write("Hello World");
    }

}

private string CallWebService(string method, string param)
{
    string ServeurURL = "https://myserver.com"; 

    System.Net.WebRequest req = System.Net.WebRequest.Create(ServeurURL + method);
    req.Method = "POST";

    byte[] byteArray = System.Text.Encoding.UTF8.GetBytes(param);
    req.ContentType = "text/xml";
    req.ContentLength = byteArray.Length;
    System.IO.Stream reqstream = req.GetRequestStream();
    reqstream.Write(byteArray, 0, byteArray.Length);
    reqstream.Close();

    System.Net.WebResponse wResponse = req.GetResponse();
    reqstream = wResponse.GetResponseStream();
    System.IO.StreamReader reader = new System.IO.StreamReader(reqstream);
    string responseFromServer = reader.ReadToEnd();

    return responseFromServer;
} 
```

jQuery/Ajax 调用：

```
jQuery(function() {
        $('#btn1').click(function (e) {
            e.preventDefault();
            jQuery.ajax({
                type: "GET",
                url: "MyHandler.ashx",
                data: "method=MyMethod1",
                success: function (data) {
                    $('#display').html("<h1>" + data.toString() + "</h1>");
                }
            });
        });
        $('#btn2').click(function (e) {
            e.preventDefault();
            jQuery.ajax({
                type: "GET",
                url: "MyHandler.ashx",
                data: "method=MyMethod2",
                success: function (data) {
                    $('#display').html("<h1>" + data.toString() + "</h1>");
                }
            });
        });
    }); 
```

现在它正在工作:)

# django - 有没有办法让 django i18n 将视图中的字符串标记为可翻译并将其放入语言文件？

> ID：12805411
> 
> 赞同：0
> 
> 时间：2012-10-09T17:39:13.043
> 
> 标签：django, internationalization

在 Holovaty 的 django 书中，他说，django 无法翻译标记为的字符串

urgettext('blahblah')

在代码中并使用“makemessage”命令将其放入 .po 文件中？

您如何解决需要翻译的字符串的问题？

有没有办法做到这一点：让 django 在视图中检测 urgettext() 中的字符串并使其可与 .po 文件一起翻译？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:01:30.643

我的错误是将 ugettext 作为别名导入

```
from django.utils.translation import ugettext as ut 
```

django 识别字符串时

```
from django.utils.translation import ugettext 
```

用来...

# google-app-engine - user.nickname 给出一个 URL 而不是昵称 python GAE

> ID：12805418
> 
> 赞同：2
> 
> 时间：2012-10-09T17:39:51.817
> 
> 标签：google-app-engine, python-2.7, openid

我有以下代码

```
 def get(self):
    user = users.get_current_user()
    if user:  # signed in already
        self.response.out.write("User Id =" + user.user_id() + " - User federated identity = " +  user.federated_identity() + " - User IdentityProvider = "+user.federated_provider() + " - User Email" + user.email() + "USer Nickname = " + user.nickname())
    else:     # let user choose authenticator
        self.response.out.write('Hello world! Sign in at: ')
        for name, uri in providers.items():
            self.response.out.write('[<a href="%s">%s</a>]' % (
                users.create_login_url(federated_identity=uri), name)) 
```

我尝试使用 google 和 yahoo 作为开放 ID 提供程序，但是每当我尝试访问用户属性（例如用户联合身份或用户昵称）时，它会输出 URL 而不是昵称，谁能告诉我我做错了什么这里。

这是我看到的输出

```
User federated identity = https://me.yahoo.com/a/JHqoh95mg8UqmFeDWlzSxKLW_SnNIOTlOcplbGQ

and user.nickname() also outputs this 
```

PS：我已经将我的应用程序配置为使用应用程序仪表板中的开放 ID，并且我的代码正在运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:18:51.497

这是记录在案的行为：

> nickname() 返回用户的“昵称”，一个可显示的名字。对于 Google 帐户用户，如果地址与应用程序在同一个域中，则昵称是用户电子邮件地址的“名称”部分，否则是用户的完整电子邮件地址。对于 OpenID 用户，昵称是 OpenID 标识符。

（从[这里](https://developers.google.com/appengine/docs/python/users/userclass#User_nickname)）

OpenID 和用户 API 都没有真正昵称的概念；如果你想要一个，你必须向用户要一个并存储它。

# c++ - C++ 删除指针

> ID：12805420
> 
> 赞同：1
> 
> 时间：2012-10-09T17:39:59.513
> 
> 标签：c++, arrays, int, concatenation

我有一个包含医生类的程序，每个医生对象都有一个“患者”的链接列表。这些患者是使用以下代码行创建的

```
Patient * patient = new Patient(string firstname, string ailment); 
```

然后将该患者添加到医生的链接列表中。Doctor 类中有一个指针，用于指向并遍历列表并获取每个患者。当我想删除这些患者时，我必须从列表的开头开始遍历每个患者。我的问题是，我可以通过在遍历它们时简单地调用它们的析构函数来删除 eacg 患者吗？

```
Patient::~Patient(){

} 
```

还是我需要在指针指向每个员工时实际调用 delete ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-09T17:41:56.797

你打电话`delete`删除东西。 `delete`反过来，将导致调用对象的析构函数。

直接调用类的析构函数是 C++ 支持的，实际上在一些罕见的场景中很有用，但它实际上并没有释放内存。这不是你想在这里做的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-09T17:42:06.423

首先，`new`返回一个指针，所以我猜你的意思是`Patient* patient = ...`.

除此之外，是的，您需要调用`delete`您分配的所有内容，`new`并且将调用析构函数。

**或**(drumroll) 使用 a`std::unique_ptr`代替。我希望当你说你有一个病人名单时，你的意思是你有一个`std::list`病人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T17:42:00.397

调用`delete`实际上将调用对象的析构函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T17:43:09.807

由于您正在为每个 Patient 对象动态分配内存（应该是`Patient* patient`...），您还需要手动释放每个对象...

查看此[wiki](http://en.wikipedia.org/wiki/New_%28C++%29#Releasing_dynamically_allocated_memory)页面以获取更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-09T17:43:47.707

据我所知，您必须分别在每个指针上调用 delete 。从 Patient 析构函数中删除指向 Patient 的指针似乎违反了使用类的目的（即它们是自包含的，无法访问外部世界）。

# web-services - 使用 CXF 的 Java 抢先式认证 Web 服务消费

> ID：12805427
> 
> 赞同：4
> 
> 时间：2012-10-09T17:40:13.510
> 
> 标签：web-services, authentication, cxf, soapui

我想使用一个使用 CXF 保护的网络服务。（http://host:port/test/ws?wsdl）。下面是我的代码。但它给出了下面给出的例外。在 SoapUI 中，我测试了 web 服务。我在“aut”选项卡下的 SoapUI 中提供了凭据。它正在工作。您能告诉我如何使用 CXF 使用安全的 Web 服务吗？

```
ProcessService proxy = new ProcessService(wsdlURL, SERVICE_NAME);       
try {       
  IProcessService port = proxy.getBinding1IProcessService();
  Client client = ClientProxy.getClient(port);
  HTTPConduit http = (HTTPConduit) client.getConduit();
  http.getAuthorization().setUserName("username");
  http.getAuthorization().setPassword("password");

  System.out.println("Result=" + port.startReturnDDCStatusForAC(""));
} catch (Exception e) {
 e.printStackTrace();
} 
```

例外：

```
 Okt 09, 2012 7:23:50 PM org.apache.cxf.service.factory.ReflectionServiceFactoryBean buildServiceFromWSDL
    INFO: Creating Service {http://tempuri.org/}ProcessService from WSDL: http://sn000333.tauri.ch:61527/WS/Process?wsdl
    Okt 09, 2012 7:24:02 PM org.apache.cxf.ws.policy.AssertionBuilderRegistryImpl handleNoRegisteredBuilder
    WARNING: No assertion builder for type {http://schemas.microsoft.com/ws/06/2004/policy/http}BasicAuthentication registered.
    org.apache.cxf.ws.policy.PolicyException: None of the policy alternatives can be satisfied.
        at org.apache.cxf.ws.policy.EndpointPolicyImpl.chooseAlternative(EndpointPolicyImpl.java:165)
        at org.apache.cxf.ws.policy.EndpointPolicyImpl.finalizeConfig(EndpointPolicyImpl.java:145)
        at org.apache.cxf.ws.policy.EndpointPolicyImpl.initialize(EndpointPolicyImpl.java:141)
        at org.apache.cxf.ws.policy.PolicyEngineImpl.createEndpointPolicyInfo(PolicyEngineImpl.java:549)
        at org.apache.cxf.ws.policy.PolicyEngineImpl.getEndpointPolicy(PolicyEngineImpl.java:295)
        at org.apache.cxf.ws.policy.PolicyEngineImpl.getClientEndpointPolicy(PolicyEngineImpl.java:278)
        at org.apache.cxf.ws.policy.PolicyDataEngineImpl.getClientEndpointPolicy(PolicyDataEngineImpl.java:61)
        at org.apache.cxf.transport.http.HTTPConduit.updateClientPolicy(HTTPConduit.java:318)
        at org.apache.cxf.transport.http.HTTPConduit.<init>(HTTPConduit.java:303)
        at org.apache.cxf.transport.http.HTTPTransportFactory.getConduit(HTTPTransportFactory.java:250)
        at org.apache.cxf.binding.soap.SoapTransportFactory.getConduit(SoapTransportFactory.java:228)
        at org.apache.cxf.binding.soap.SoapTransportFactory.getConduit(SoapTransportFactory.java:235)
        at org.apache.cxf.endpoint.AbstractConduitSelector.getSelectedConduit(AbstractConduitSelector.java:103)
        at org.apache.cxf.endpoint.UpfrontConduitSelector.selectConduit(UpfrontConduitSelector.java:77)
        at org.apache.cxf.endpoint.ClientImpl.getConduit(ClientImpl.java:842)
        at com.test.TestWS.main(TestWS.java:66) 
```

SOAPUI 测试：

在 aut tab 下，我在下面给出了详细信息，它正在工作。授权类型：抢占用户名：用户名密码：密码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:08:18.407

也许您可以尝试通过扩展**HttpBasicAuthSupplier**并覆盖**getPreemptiveUserPass**来制作自己的**MyBasicAuthSupplier**。然后，您可以使用**setAuthSupplier**方法将新类的实例设置为**HTTPConduit**。

 ******这可能会更有用。

[http://alvinalexander.com/java/jwarehouse/apache-cxf/rt/transports/http/src/test/java/org/apache/cxf/transport/http/HTTPConduitTest.java.shtml](http://alvinalexander.com/java/jwarehouse/apache-cxf/rt/transports/http/src/test/java/org/apache/cxf/transport/http/HTTPConduitTest.java.shtml)

干杯。******

# android - 将受信任的 SSL 证书添加到为 API 8 设计的应用程序

> ID：12805428
> 
> 赞同：0
> 
> 时间：2012-10-09T17:40:15.133
> 
> 标签：android, ssl, ssl-certificate, android-2.2-froyo

我想使用 SSL 在我的 android 应用程序和托管我的 Web 服务的服务器之间建立连接。

我想使用自签名证书，然后使用`SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER`

但是会有一个中间人攻击的漏洞，所以我决定使用受信任的证书。

我打算买一个证书，但我想知道哪些 CA 是最受信任的以及如何生成 BKS

我检查了这个[链接](https://stackoverflow.com/questions/4065379/how-to-create-a-bks-bouncycastle-format-java-keystore-that-contains-a-client-c)和[这个](https://stackoverflow.com/questions/12382342/creating-keystore-bks-for-https-android-connection)链接并选择了第一个链接中描述的解决方案，即使用充气城堡库生成它并将其作为原始资源加载到应用程序中。这是一种安全的方法吗？它是否可以安全地与使用 android 2.2 的设备一起使用？

我正在尝试了解所有这些工作的原理，但这是我第一次使用证书。

非常感谢你 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:50:31.483

自签名证书本身并不容易受到中间人攻击。虽然使用的`ALLOW_ALL_HOSTNAME_VERIFIER`是，所以你不应该使用它。只要您正确设置您的应用程序以信任您的自签名证书，并正确验证其有效性，就真的没有安全问题。

如果您想购买证书，只需从与 Android 2.2 捆绑的 CA 处获取证书，您就不必处理自定义信任存储和额外代码：它会正常工作，因为系统信任颁发 CA。

# javascript - HTML5-Audio/Mozilla 音频数据 API 中的多个帧缓冲区

> ID：12805429
> 
> 赞同：0
> 
> 时间：2012-10-09T17:40:15.453
> 
> 标签：javascript, html, firefox, html5-audio

[这篇文章](https://stackoverflow.com/questions/9746841/how-to-do-panning-in-html5-audio-mozilla-audio-data-api/9993094#9993094)对如何使用[Mozilla Audio API](https://wiki.mozilla.org/Audio_Data_API)平移音频数据提供了一些很好的见解。但是我想知道如果我有多个音频元素并且想要每个音频元素都有一个帧缓冲区可以做什么？下面的代码将所有音频元素的最终混合存储在全局变量“数据”中。

```
var data; // global

for (ch=0; ch<channel_max; ch++)
{
    a1[ch].addEventListener('MozAudioAvailable', audioAvailable, false);
}

function audioAvailable(event) {
    // how to pass 'ch' such that 'data' is specific to its eventlistener?
    data = event.frameBuffer;
} 
```

是否可以分别为每个音频元素存储一个数组缓冲区？这可能就像重组我如何调用事件监听器一样简单，但也许不是。在这一点上，我不确定firefox API是否能够做到这一点，但我很想知道。

# c - 我可以访问内存中的任何内容吗？

> ID：12805447
> 
> 赞同：7
> 
> 时间：2012-10-09T17:41:46.043
> 
> 标签：c, pointers, memory-management

免责声明：我是 C/C++ 的新手。

如果我要[手动将内存地址分配给](https://stackoverflow.com/questions/4532000/how-to-assign-pointer-address-manually-in-c-programming-language)C 中的变量，然后尝试回显该值……我是否可以不受限制地访问内存中的**任何内容**，或者是否存在限制？

例如：

```
char * p = (char *)0x28ff44;
printf("Memory value: %c", *p); 
```

我猜如果该地址的内容不适合 char 类型的大小，那将会严重崩溃，但这只是一个示例。我真正好奇的是，如果这样的事情是可能的，或者操作系统是否施加限制并且只允许您访问给定内存空间中的内存？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T17:45:33.143

哦，天哪，好吧。

从技术上讲，是的，你可以。在不使用 MMU 或任何形式的保护（或者，您知道，实模式下的 x86）的嵌入式设备中，您可以完全按照您在此处发布的内容进行操作。您也可以在任何操作系统上以用户模式执行此操作，但您实际访问有效内存的机会非常小。

实际上，不，你不能那样做。考虑到虚拟内存和内存保护，您尝试访问的区域很可能没有被映射，因此会失败。此外，如果您访问受保护的内存（例如属于操作系统的任何内容），您的访问将失败。这两种情况都是导致分段错误的原因。

您的声明是有效的（对于有效的不同定义），程序将尝试访问您请求的内存。只是它实际上可能没有映射到任何东西。

还值得注意的是，这就是内存映射 I/O 的工作方式。假设我有一个硬件控制寄存器，当写入它时，它会在附加的 UART/串行线路上写入一个字节（并且，为简单起见，它就像魔术一样工作，不需要设置任何其他寄存器）。在 C 中，对于我过于简化的设备，这将被编写如下：

```
#define UART1_OUT 0xFC56   

volatile char* uart = UART1_OUT;   // Definition of pointer to variable.
                                   // volatile is required here. Look it up, but
                                   // it basically stops your compiler optimising
                                   // anything to do with this variable

*uart = 'A';                       // Write an A character to the serial line 
```

当然，现实世界的设备要复杂一些；）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:43:02.350

这取决于您的程序运行的计算机体系结构和操作系统。现代操作系统具有[受保护](http://en.wikipedia.org/wiki/Memory_protection)和[虚拟](http://en.wikipedia.org/wiki/Paged_virtual_memory)内存的概念。对于虚拟内存，内存地址不是指物理内存，而是指分配给当前应用程序的虚拟内存空间。在这些情况下，尝试在分配的内存空间之外读取或写入内存将导致程序错误（通常是分段错误或保护错误）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:45:13.270

具有内存管理单元 (MMU) 的系统很可能不允许您访问任意内存。任何现代操作系统都使用内存保护。但是在嵌入式领域，有许多操作系统没有采用内存保护，并且确实可以访问任何可寻址的内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T17:47:50.477

> 如果我要手动将内存地址分配给 C 中的变量，然后尝试回显该值...我是否可以不受限制地访问内存中的任何内容，或者是否存在限制？

C 语言很乐意让您尝试这样做，但大多数操作系统不允许您访问进程内存空间之外的内存。如果您正在为嵌入式系统编写代码，而您的代码和硬件之间没有太多的联系，那么您可能能够从您喜欢的任何位置读取和写入。但是，如果您正在为具有受保护内存的系统编写代码，那么就没有那么多了。

> 我猜如果该地址的内容不适合 char 类型的大小，那将会严重崩溃

不...编译器不关心在任何给定地址存储什么类型的数据。当你说`(char *)0x28ff44`你告诉它`0x28ff44`是 a`char *`时，这对编译器来说已经足够好了。但是，您的代码可能仍会因其他原因而崩溃，例如 if`0x28ff44`不是有效地址。

# jquery - 作业完成时向客户端发送通知

> ID：12805448
> 
> 赞同：0
> 
> 时间：2012-10-09T17:41:47.777
> 
> 标签：jquery, spring, spring-mvc, long-polling

我正在使用 Spring MVC 编写一个内部 Web 应用程序，其中用户将提交一组作业以通过 RESTful Web 服务完成。每个作业只需几秒钟即可完成，但用户可以提交数十个作业。我希望在每个作业完成时通知用户的选项。这将部署到 Tomcat 6 安装，这在一定程度上限制了我的选择，因为我将无法访问 Servlet 3。

我以前从来没有写过这样的东西，我也不完全确定该怎么做。我在想我想做某种长轮询，但是，虽然它在概念上看起来很容易，但我不确定如何用 Spring 来实现它。

我最初的计划是简单地保持连接打开（如果用户设置了接收通知的选项），在单独的线程中启动作业，当作业完成时通过 BlockingQueue 向请求线程发送消息并将消息转发到用户。但是，我认为让连接保持打开那么长时间可能不是一个好主意。我也没有看到 jQuery 在完成之前开始处理 AJAX 响应的方法。

另一种选择是长轮询。我看到 Spring 3.2 引入了一个新功能来执行这里描述的操作[，](http://blog.springsource.org/2012/05/13/spring-mvc-3-2-preview-adding-long-polling-to-an-existing-web-application/)但是 1）我不确定这是否依赖于 Servlet 3 中的异步支持，2）我不清楚如何从该示例中使用它（如果有人能指出我更彻底的信息，将不胜感激），以及 3）[这](https://stackoverflow.com/questions/12238750/spring-3-2-long-polling-causing-spring-security-context-to-be-cleared)可能会出现问题，因为我将使用 Spring Security 来锁定这个应用程序。

所以，我可以实现自己的长轮询机制。有没有关于如何处理这个问题的最佳实践？我在想我可以保留一个单例 ConcurrentMap ，其中会话 id 作为键和 BlockingQueue 中的消息作为值。工作线程会将消息放入适当的 BlockingQueue 中，并且当消息请求进入会话时，它将从阻塞队列中删除，直到发布一些终端消息。但是还有一个问题，如果客户端永远不会回来耗尽消息队列怎么办。怎么会被清理掉？我有一种直觉，认为有更好的方法来实现这一点，但我不确定那是什么。有人可以在这里给我一些指导吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T10:05:49.770

请参阅我昨天发布的以下帖子。

[如何显示堆栈溢出站点中的更新消息](https://stackoverflow.com/questions/12802220/how-the-update-messages-in-stack-overflow-site-are-being-shown)

在回复中，@Werner Vesterås 提到了[DWR](http://directwebremoting.org/dwr/index.html)

在另一个回复中@Nambari 也提到了**彗星**。

似乎对你有用。

我也遇到了[Kaazing](http://kaazing.com/)

这也在做类似推送通知的事情

希望能帮助到你

# npapi - 如何在嵌套的javascript函数NPAPI中获取插件对象

> ID：12805449
> 
> 赞同：0
> 
> 时间：2012-10-09T17:41:47.640
> 
> 标签：npapi

提前致谢 ！！！！！

```
var pluginObject = null;
function init()
{
    var pluginObject = document.getElementById('pluginObj'); //This is  object for my Plugin.
    pluginObject.onstartevent = handleEvent(); // This is working

    //now i am calling one function in plugin that will return NPObject  using invoke default
    pluginObject.startEvent(function(e) {
        e.onstartEvent = handleEvent(); //This is not working ......how to make it work  
    });
}
function handleEvent(e)
{
    if(e)
    {
        alert(e);
    }
}
<body onload = "init()" > </body> 
```

在这里，我从 body 调用 init 函数，然后创建插件对象，然后调用我在插件内部处理的一个属性 onstartEvent。问题是“e.onstartEvent”如何捕获这个对象并在这里调用。我不明白。对于 PluginObject，我使用 NPNVPlUGINOBJECT，然后检查属性“onstartEvent”（如果存在），然后检查 has 方法，最后在 PLUGIN 对象上调用。

//我的插件代码如下：

```
bool ScriptablePluginObject::Invoke(NPIdentifier name, const NPVariant *args, uint32_t argCount, NPVariant *result)
{
    char *pFunc = NPN_UTF8FromIdentifier(name);
    if(!strcmp("startEvent",pFunc))
    {
        NPObject * argsVal = args[0].value.objectValue;  
        NPVariant valueToSend;
        NPVariant returnValue;
        valueToSend.type = NPVariantType_Object;
        valueToSend.value.objectValue = this; 
        NPN_InvokeDefault(mNpp,argsVal,&valueToSend,1,&returnValue); 
        return true;
    }
    return false;
} 
```

现在在 HasProperty 中检查名为“onstartEvent”的当前类属性

```
bool ScriptablePluginObject::HasProperty(NPIdentifier name)
{
    char *pProp = NPN_UTF8FromIdentifier(name);
    //Check which Properties are available
    if( !strcmp( "onstartEvent", pProp ) )
    {
        return true;
    }
    return false;
} 
```

现在在 GetProperty 我终于检查并返回一些整数值到 //handleEvent 函数

```
bool ScriptablePluginObject::GetProperty(NPIdentifier name, NPVariant *result)
{
    VOID_TO_NPVARIANT(*result);
    char *pProp = NPN_UTF8FromIdentifier(name);
    //onstartEvent

    if(!strcmp("onstartEvent", pProp))
    {
        //Calling e.onstartEvent will come here in GetProperty
        NPObject * pluginObj = NULL;   
        NPN_GetValue(mNpp,NPNVPluginElementNPObject,&pluginObj);
        NPIdentifier id = NPN_GetStringIdentifier("onstartEvent");
        bool val  = NPN_HasMethod(mNpp,pluginObj,id);
        NPVariant value;
        NPVariant retVal;
        value.type = NPVariantType_Int32; //now returning some value if val is true.
        value.value.intValue = 20;
        if(val==true)
        {
            //Finally returning value to the handle Event function in JavaScript
            NPN_Invoke(mNpp,pluginObj,id,&value,1,&retVal); 
        }
        return true;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T03:45:25.453

我不确定我是否真的遵循您想要做的事情；但是，从事物的外观来看，当您在插件上调用方法 startEvent 时，您会向它传递一个函数（NPObject），该函数将使用单个参数“e”（使用 InvokeDefault）被调用

然后您希望“e”成为插件？如果是这种情况，那么您需要做的就是将插件的 NPObject 包装在 NPVariant 中，并将其作为第一个参数发送到使用 InvokeDefault 的函数调用。

* * *

编辑：

所以你已经发布了你的 NPAPI 代码；您在回调中执行了以下行：

```
e.onstartEvent = handleEvent(); 
```

你的意思是这样做吗？您正在执行 handleEvent 并将结果分配给插件 DOM 元素上的“onstartEvent”。您的意思是要将函数分配给“onstartEvent”吗？在这种情况下，您不应该在末尾添加 ()；这会导致函数被调用（并且没有有效的 e 值）。

此外，您尝试在 DOM 元素上调用“onstartEvent”，但最好使用 GetProperty 获取函数的 NPObject，然后在其上调用 InvokeDefault；当然，因为你永远不会得到属性 GetProperty 永远不会被调用，因此你的代码永远不会*运行*。

哦，由于你从 HasProperty 中为“onstartEvent”返回 true，你不能在 DOM 元素的同名属性上设置函数；DOM 元素可以声明该属性，或者您的插件可以声明该属性，但您正试图以两种方式使用它，但这是行不通的。因此，由于您没有 SetProperty，因此您的分配将在您的函数被调用且没有参数的情况下失败。

希望有帮助

# eclipse - 如何使用 SVN 在 Eclipse 中查看合并分支的历史记录？

> ID：12805460
> 
> 赞同：0
> 
> 时间：2012-10-09T17:42:26.907
> 
> 标签：eclipse, svn, subversive

我正在使用带有 Subversive 的 Eclipse Helios 作为 SVN 连接器。当我将分支合并回主干时，我无法再访问分支内发生的历史记录。我仍然可以在 Windows 资源管理器中使用 TortoiseSVN 看到它，因此历史仍然可以在 SVN 本身中获得。但是有没有办法从 Eclipse 中显示项目的完整“合并”历史？subclipse 会提供这样的功能吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:20:27.170

我这里没有 Subversive，但是使用 Subclipse，您通常会在 SVN 存储库视图中看到所有分支，除非您明确删除它们。但即便如此，您也可以通过在该分支被删除之前为该分支的最后一个修订创建一个新分支来恢复它，然后您可以浏览它并在 SVN 存储库视图中查看历史记录。

# mysql - 将两列从一个表复制到另一个，但只有唯一值

> ID：12805461
> 
> 赞同：1
> 
> 时间：2012-10-09T17:42:30.853
> 
> 标签：mysql, sql

我`table1`有

```
MBID   |    Artist
__________________

123321   The Beatles
123214   Led Zeppelin
123321   The Beatles 
```

如何将所有**distinct** `MBID's`及其相应的`Artist`名称复制到一个新表中，以便新表只有 distinct`MBID`的

```
 MBID   |    Artist
__________________

123321   The Beatles
123214   Led Zeppelin 
```

我试过了

```
 insert into table2 (MBID,artist) 
 select distinct(table1.MBID),table1.artist 
 FROM danktable 
```

但这给了我奇怪的组合，而不仅仅是不同的 MBID

当我创建`MBID`主索引时，此查询出现错误，因为我得到非唯一`MBID`值。

有人可以帮我吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:48:28.307

你可以这样做：

```
 insert into table2 (MBID,artist) 
 select MBID,max(artist)
 from table1
 group by MBID 
```

# css - ">" 在 CSS 中的作用

> ID：12805462
> 
> 赞同：-6
> 
> 时间：2012-10-09T17:42:31.373
> 
> 标签：css

> **可能重复：**
> [CSS 规则中的“>”是什么意思？](https://stackoverflow.com/questions/3225891/what-does-mean-in-css-rules)

我在一些 CSS 中看到了这一点

> 正文 > .navid

我想知道的是，“>”符号在这段 CSS 代码中有什么作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T17:48:03.020

它是孩子的​​选择器（不仅仅是任何后代）。

选择器`body > .navid`将`.navid`使用以下内容选择 div：

```
<body>
    <div class="navid"></div>
</body> 
```

但它不会选择`.navid`下面的 div，因为它是孙子

```
<body>
    <div>
        <div class="navid"></div>
    </div>
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:45:52.027

它指向元素的直接子元素，因此例如您可以拥有

> 身体 > .something

它仅指向 body 元素中的“某物”类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:43:42.120

它被称为[后代选择器](http://www.w3.org/TR/css3-selectors/#descendant-combinators)，它选择

> E 元素的 F 元素子元素

参考：[http ://www.w3.org/TR/css3-selectors/](http://www.w3.org/TR/css3-selectors/)

# apache - Apache别名/重写重定向循环

> ID：12805463
> 
> 赞同：0
> 
> 时间：2012-10-09T17:42:40.743
> 
> 标签：apache, mod-rewrite, redirect, alias, infinite-loop

我想为我的 apache 使用一些别名，使用 mod_rewrite，因为别名不适用于`.htaccess`.

例如，我想要一个`article/?id=1`别名`about/`

当然，做一件简单的事：

```
RewriteRule ^about\/$ "article\/\?id=1" [L] 
```

但是，与此同时，我不希望任何人再访问`article/?id=1`，并进行 301 重定向`about/`以保留页面值和果汁。（因为否则搜索引擎会认为这是两个不同的页面，并会自行判断。）

所以换句话说，我希望这个 url 只能通过它的别名使用，如果有人请求实际页面 - 然后 301 重定向到别名。

这就是问题开始的地方，当我编写另一个重写规则时，我最终得到了错误 310（重定向循环）：

```
RewriteRule ^article\/\?id=1$ "about\/" [L,R=301] 
```

有什么办法可以解决这个问题...？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:55:33.820

您需要匹配实际请求而不是 URI，因为其他规则将简单地在内部重写它并触发重定向，从而导致循环。此外，您无法匹配 a 中的查询字符串`RewriteRule`。

```
RewriteCond %{THE_REQUEST} ^(GET|POST|HEAD)\ /article/\?id=1&?([^\ ]*)
RewriteRule ^ /about/?%2 [L,R=301] 
```

# php - 当输入 id 值为空时，如何隐藏 div 类？

> ID：12805466
> 
> 赞同：0
> 
> 时间：2012-10-09T17:42:46.403
> 
> 标签：php, jquery, wordpress, html, hide

我已经坚持了好几天了，所以如果有人可以帮助我解决这个问题，我将不胜感激。

我正在做一个 Wordpress 主题，我有一个选项面板，用户可以在其中输入他们的 Twitter 用户名。如果他们输入用户名，我希望 Twitter 图标出现在页脚中，如果他们将该字段留空并且不输入用户名，我希望 Twitter 图标消失。

Twitter 图标图像在名为“.twitter”的 div 类中调用，目前，即使输入 id 值为空，Twitter 图标也始终存在。所以我想要做的是当输入id值为空时隐藏这个div类，以便图标消失。

当我在有人说要使用这个 jQuery 之前问这个问题时：

```
<script type="text/javascript">
$(document).ready(function() {

    if($('#mytheme_twitter').val() == '' ){$('.twitter').hide();}  

    $('#mytheme_twitter').on('change' , function() {

         if( this.value != ''){

               $('.twitter').show(); 
          }
          else{
               $('.twitter').hide(); 
         }
    });
  });
</script> 
```

我把这个 jQuery 放在我的 header.php 中，但由于某种原因它不起作用。div 类的名称肯定是“.twitter”，那么输入 id 的选择器会不会是错误的？我进入了 Firefox 的选项面板，并用 Firebug 突出显示了输入框，它肯定是“#mytheme_twitter”。我也尝试过“input#mytheme_twitter”，但这也不起作用。

选项面板位于另一个 php 文件中，而不是 index.php 文件中。这可能是它不起作用的原因......因为该输入ID尚未在index.php中定义？我自己对此不太了解，因为我是一个 jQuery 菜鸟，而且我最近才开始掌握 php 的窍门。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:58:26.027

JavaScript 工作正常：http: [//jsfiddle.net/XdeHP/](http://jsfiddle.net/XdeHP/)

你的问题一定在别处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:02:11.477

尝试

```
$("#mytheme_twitter").change(function(){
if( $(this).val() != ''){

        $('.twitter').show(); 
    }else{
        $('.twitter').hide(); 
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:06:13.990

看起来您的 JS 正在调用管理员中的一个框。`.twitter`除非它和位于同一页面上（没有一些过度杀伤功能），否则它无法提取该值。

你最好在 PHP 中这样做：像这样

```
if(get_option('twitter', 'your-page')) !=='') { //show div } 
```

这将被放置在你的 footer.php

# c# - C# SqlMethods 不工作

> ID：12805467
> 
> 赞同：4
> 
> 时间：2012-10-09T17:42:48.160
> 
> 标签：c#, linq

我是使用 Linq 的新手，无法使用 SqlMethods.Like 函数。

这是我的简化示例：

```
 List<string> mylist = new List<string>();
        mylist.Add("100");
        mylist.Add("101");
        mylist.Add("102");
        mylist.Add("103");
        mylist.Add("104");
        mylist.Add("105");
        mylist.Add("106");
        mylist.Add("107");

        var filtered = mylist.Where(x => SqlMethods.Like(x, "10%"));
        foreach (var record in filtered)
        {
            textBox1.Text += record + "\n";
        } 
```

我的名为过滤的变量返回为空。我错过了什么？

如果我使用 x.Equals("100") 我会得到结果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T17:45:40.977

[SqlMethods.Like](http://msdn.microsoft.com/en-us/library/bb355235.aspx)

> 确定特定字符串是否与指定模式匹配。此方法目前仅在 LINQ to SQL 查询中受支持。

您的查询不是 LINQ to SQL 查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:49:18.917

你可以使用**包含**例如

```
var filtered = mylist.Where(x => x.Contains("10")); 
```

如果你***真的***想要 SQL `LIKE`，你可以使用[`System.Data.Linq.SqlClient.SqlMethods.Like(...)`](http://msdn.microsoft.com/en-us/library/system.data.linq.sqlclient.sqlmethods.like.aspx)LINQ-to-SQL 映射到`LIKE`SQL Server 中的 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:47:21.770

在你的情况下使用：

```
var filtered = mylist.Where(x => x.Contains("10")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T17:48:00.690

您可以`Contains operator`改用 Like

# .net - 使用 dotTrace 分析 Excel 插件

> ID：12805470
> 
> 赞同：1
> 
> 时间：2012-10-09T17:42:58.697
> 
> 标签：.net, excel, dottrace

我正在尝试使用 dotTrace 分析用 C# 编写的 Excel 插件。

当我在 dottrace 中选择“附加到进程”时，我能够连接到 excel 并分析我的代码，但是当我想使用“独立应用程序”模式（允许更多选项）时，dottrace 似乎认为 excel 是加载.Net v.2，所以它看不到我的插件。

关于如何强制 dottrace 分析 .net 4.0 插件的任何想法？

编辑：我发现在我的插件加载 v4 之前，其他一些插件正在加载 .NET v2，并且 dottrace 采用第一个。有什么办法可以强制追踪哪一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T16:14:01.627

您可以在具有相同名称和 ID 的两个进程之间切换，但在控制器窗口（控制器按钮上方）中具有 2 个不同的 CLR 版本。

# mysql - mysql更新选择行号

> ID：12805475
> 
> 赞同：6
> 
> 时间：2012-10-09T17:43:13.173
> 
> 标签：mysql, sql-update

我有下一个代码：

```
SET @rownum=0;
UPDATE product_images AS t, (SELECT @rownum:=@rownum+1 rownum, id, rel 
FROM product_images WHERE product_id='227') AS r
SET t.rel = r.rownum
WHERE t.id = r.id 
```

这在 phpmyadmin 中运行良好

但是...下一个代码（女巫实际上是一样的）但是放在php代码中

```
mysql_query ("
SET @rownum=0; 
UPDATE product_images AS t, 
(SELECT @rownum:=@rownum+1 rownum, product_images.* 
FROM product_images WHERE product_id='$pid') AS r
SET t.rel = r.rownum WHERE t.id = r.id ") or die(mysql_error()); 
```

给我错误：`"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UPDATE product_images AS t, (SELECT @rownum:=@rownum+1 rownum, product_images.* ' at line 1"`

请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-09T17:44:30.010

这些是您尝试一次执行的 2 个查询。这不适用于`mysql_query`PHP 方法。

您实际上不需要第一个语句。尝试

```
UPDATE product_images AS t
JOIN
(
    SELECT @rownum:=@rownum+1 rownum, id, rel
    FROM product_images
    CROSS JOIN (select @rownum := 0) rn
    WHERE product_id='227'
) AS r ON t.id = r.id
SET t.rel = r.rownum 
```

即时初始化`@rownum`变量。

[简化的 SQLFiddle 示例](http://sqlfiddle.com/#!2/aa3ef/44)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:45:20.180

MySQL 的 PHP 驱动程序不允许在单个 query() 调用中进行多个查询，以作为针对某些形式的 SQL 注入攻击的安全措施。您必须将多查询拆分为多个单独的 query() 调用。

# java - 在 Matlab 中生成向量的 Hashmap

> ID：12805476
> 
> 赞同：5
> 
> 时间：2012-10-09T17:43:25.110
> 
> 标签：java, matlab, hashmap, hashtable

我在 Matlab 中需要类似 hashmap 的功能，其中 hashmap 将向量映射到其他向量，并且向量的数量（范围在数十万）是事先不知道的。

我尝试了 Matlab 的内置[Containers.Map](http://www.mathworks.nl/help/matlab/map-containers.html)，但它不接受向量作为键。然后我尝试了 java.util.HashMap：

```
>> map = java.util.HashMap;
>> map.put(1:3,zeros(2,1));
>> map.get(1:3)

 ans =

 [] 
```

因此，由于某种原因，这似乎不起作用，即使 Java 的 HashMap 应该能够将数组映射到数组。

另一种选择是保留两个单独的矩阵，一个用于键，一个用于值，并逐步增长它们。但我真的不想这样做，因为 Matlab 中增量增长的痛苦（即使是块大小增量等，例如[这里](http://www.mathworks.com/matlabcentral/newsreader/view_thread/102704)）。

问题： 1\. 为什么Java的HashMap在这里不起作用？2\. 还有其他方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:37:01.660

这是一个可以做你想做的事情。. .

```
map = java.util.HashMap;    
key = java.util.Vector;

matKey = 1:3;
for nn=1:numel(matKey)  
    key.add(matKey(nn));
end

map.put(key,zeros(2,1));
map.get(key) 
```

..无论如何，这是一个起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T11:39:36.810

我将带有 char 键的 container.Map（感谢 Andrew Janke）与带有包装器对象作为键的 java.util.HashMap 进行了比较（在[这篇文章](https://stackoverflow.com/questions/1352553/how-can-i-use-matlab-arrays-as-keys-to-the-hashmap-java-objects)中，也感谢 Andrew Janke，并感谢 Rasman 指出）：

```
numvec = 10^5;
S = round(rand(numvec,10)*40);

matmap = containers.Map();
%pick a random vector
idx = ceil(rand()*numvec);
s1 = S(idx,:);

%put it in the map
matmap(char(s1)) = zeros(1,4);
for i=1:5*10^5

  if i==10^3 tic; end %allow some time for getting up to speed before timing

  %pick a random vector and put it in the map
  idx = ceil(rand()*numvec);
  s2 = S(idx,:);
  matmap(char(s2)) = zeros(1,4);

  %retrieve value of previous vector
  v = matmap(char(s1));

  %modify it randomly and put it back
  v( ceil(rand()*4) ) = rand();
  matmap(char(s1)) = v;

  s1 = s2;
end
toc

javaaddpath('/Test/bin');
import test.ArrayKey;
javmap = java.util.HashMap;

idx = ceil(rand()*numvec);
s1 = S(idx,:);

%also convert value to ArrayKey so we can retrieve it by ref -- saves a put
%operation
javmap.put(ArrayKey(s1), ArrayKey(zeros(1,4)));
for i=1:5*10^5

  if i==10^3 tic; end

  idx = ceil(rand()*numvec);
  s2 = S(idx,:);
  javmap.put(ArrayKey(s2), ArrayKey(zeros(1,4)));
  v = javmap.get(ArrayKey(s1));
  v.x( ceil(rand()*4) ) = rand();
  s1 = s2;
end
toc 
```

结果：

```
>> testmaps
Elapsed time is 58.600282 seconds.
Elapsed time is 97.617556 seconds. 
```

container.Map 是赢家。

* * *

编辑：我重新运行了 numvec = 10^6 的测试，其他一切都一样。container.Map 方法在 59 秒内运行。HashMap 方法在 5 分钟后未完成，导致 Matlab 无响应。

* * *

Edit2：我还尝试预先分配两个单独的矩阵并使用`ismember`. 性能比 HashMap 差。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-02T15:59:59.793

我最近不得不处理一个类似的问题，不是向量而是数组。

Matlab 有一个函数 mat2str 函数，可以将矩阵转换为字符串。如果您不需要向量在 HashMap 中动态增长，则可以将向量表示为字符串并将其用作键/值。在某些情况下，这可能不是很有帮助，但如果事情是静态的，它是一个快速而肮脏的解决方案。

# java - 关于在java中对字符数组进行排序

> ID：12805479
> 
> 赞同：-4
> 
> 时间：2012-10-09T17:43:26.983
> 
> 标签：java, arrays

我有一个数组可以说有值

```
Char Arr[] ={A,B,A,C,D,B,A,F,G,B,A}; 
```

我想以形式对这个数组进行排序

```
Arr[] = {A,A,A,A,B,B,B,C,D,F,G} 
```

请告知如何在java中实现这一点，..!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:45:28.013

尝试使用方法 sort()..

`Arrays.sort(Arr);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:50:11.690

有一个[Arrays.sort()](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28char%5b%5d%29)方法可以为您完成工作。

```
Arrays.sort(Arr); 
```

这将按顺序对您的对象进行排序，没有返回类型，因为引用的副本被传递并用于操作数组。

# javascript - Firefox 用户禁用 cookie 并因此禁用 localStorage 的解决方案 - 无法使用 polyfill

> ID：12805487
> 
> 赞同：10
> 
> 时间：2012-10-09T17:44:01.960
> 
> 标签：javascript, firefox, local-storage

在我们的一位用户提出投诉并运行了一些测试后，似乎 Firefox 15 和 16（可能还有旧版本）可以做到这一点，因此如果您禁用 cookie，您也会禁用 localStorage。您甚至无法为它创建一个 polyfill，因为每当您尝试访问时，`window.localStorage`您都会得到`Error: The operation is insecure.`

抛出一个 try catch 可以让您检查它是否被禁用，但不会让您用自己的解决方案替换变量。以下快速填充将不起作用，因为 FF 忽略设置变量并在尝试访问它时会抛出相同的错误：

```
try{
       window.localStorage;
}catch(err){
        window.localStorage = {
              getItem: function(k){
                   return this.k;
              },
              setItem: function(k,v){
                   this.k = v;
              }
        };
} 
```

唯一的解决方案似乎是将“假” localStorage 移动到另一个变量，但这会很烦人，因为我们有很多代码和一个依赖于访问这个变量的 js 库。有什么解决办法吗？

**编辑：**仅弹出警报告诉用户需要 cookie 并不是最佳选择。如果访问者只想查看网站而不是注册，那么他们真的不需要 cookie。但是作为一个backbone.js 应用程序并传递大量数据，我们确实在localStorage 中存储了很多东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T15:53:39.520

你有两个选择：

1）利用词法范围和查找如何工作......例如，如果您的代码在闭包中运行，那么在该闭包内您可以运行以下内容：

```
var localStorage = window.localStorage || {... polyfill here...}; 
```

然后在您的代码中使用 localStorage 而不是完全限定的 window.localStorage。这里的优势只是词法变量查找的工作方式，它将找到您更“紧密”范围的版本而不是全局版本。PS ...无论如何，您可能应该在闭包中运行，所以这应该是可能的。

2）只是变量重命名，类似于人们删除供应商前缀的相反操作。

```
window.pLocalStorage = window.localStorage || {... polyfill here...}; 
```

然后只需将您的代码更改为使用 pLocalStorage 而不是 localStorage ...如果他们的浏览器支持它，那么它将使用本机，否则使用 polyfill。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-22T18:40:50.213

由于`localStorage`是一个保留变量，除了使用具有不同名称的包装器之外，您没有其他明智的选择。将您自己的代码和真正的 localStorage 包装在此变量下，并替换`localStorage`为您的包装器的名称。烦人，但比丢失更改更烦人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T11:32:01.260

我们将其用作本地存储的库。

```
(function (window, $, undefined) {
    var store = window.store = {};

    function deserialize(val) {
        if (!val) return null;
        var obj = $.parseJSON(val);
        return obj;
    };

    function processRequest(loc, key, value) {
        var obj;
        // if value is not specified at all assume we are doing a get.
        if (value === undefined) {
            // GET
            obj = loc.getItem(key);
            return deserialize(value);
        } else {
            // SET
            loc.setItem(key, JSON.stringify(value));
        }
    }

    store.Local = function(key, value) {
        return processRequest(window.localStorage, key, value);
    };

    store.Session = function(key, value) {
        return processRequest(window.sessionStorage, key, value);
    };
} (window, jQuery)); 
```

您可以轻松添加一些测试代码以回退到非持久数组。

# alfresco - 如何让 Freemarker 在 Alfresco 中使用 java.util.Date 而不是 org.mozilla.javascript.NativeDate？

> ID：12805490
> 
> 赞同：1
> 
> 时间：2012-10-09T17:44:07.513
> 
> 标签：alfresco, freemarker

对于接近 Alfresco 的人来说，这可能是一个问题，因为它有点具体。

我在创建网站时添加了一个自定义方面，它拥有一个日期类型的属性：

`<type>d:date</type>`

现在，我正在扩展**site.lib.ftl**文件以显示此日期：

`"startdate": "<#if site.node.hasAspect("my:customAspect")>${siteNode.properties["my:customAspectDate"]?string("yyyy-MM-dd")}</#if>",`

由于无法访问宏本身中的 site.node，因此我扩展了宏参数列表：

`<#macro siteJSONManagers site siteNode roles>`

所以我可以从**site.get.json.ftl**和**person.sites.get.json.ftl**调用它：

`<@siteLib.siteJSON site=site siteNode=siteNode />`

现在，对于 site.get.js，我在 javascript 中准备了 sitenode：

`model.siteNode = site.node; // or the same with site.getNode;`

我的日期被正确解析。**但是，当从person.sites.get.json.ftl**调用宏时，我无法在 javascript 控制器中准备 site.node ，所以我在 freemarker 中执行它（通过直接调用它）：

`<@siteLib.siteJSONManagers site=site siteNode=site.node roles=roles/>`

在使用这种形式时，我得到了这个异常：

`"09090011 Wrapped Exception (with status template): 09090096 Error during processing of the template 'Expected method. siteNode.properties[\"my:customAspectDate\"]?string evaluated instead to freemarker.template.SimpleScalar on line 59, column 71 in org\/alfresco\/repository\/site\/site.lib.ftl.'. Please contact your system administrator."`

如果我只显示这个标量 (${siteNode.properties["my:customAspectDate"]})，我会在生成的 JSON 中得到 org.mozilla.javascript.NativeDate 作为字符串：

`"startdate": "org.mozilla.javascript.NativeDate@7a6e5e2e",`

我可以通过在 site.get.json.ftl 中为 siteNode 设置相同的参数来重复这**一点**。如果我使用 siteNode.properties["cm:created"]，我什至可以重复它。

在我看来，当 javascript 控制器从节点创建模型对象时，创建的日期道具被创建为 java.util.Date 或 Freemarker 使用的任何内容，并且当 Freemarker 本身创建该属性时，它将变成 org. mozilla.javascript.NativeDate。

有人可以指出如何改进我的代码以显示日期吗？我可以使用什么来使我的调用获得相同的值？

如果有任何不同，我正在使用 SVN HEAD 的 Alfresco。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T21:56:44.210

如果人们经常在 Alfresco 与 Rhino 一起工作，那么这应该在那里解决。发生的事情是这样的：FreeMarker 模板不直接`java.util.Date`用于日期，它们使用`freemareker.template.TemplateDateModel`. FreeMarker 有一个名为 的设置`object_wrapper`，它是将对象转换为`freemareker.template.Template{Something}Model`-s 的对象。显然，Alfresco 使用的对象包装器不知道`org.mozilla.javascript.NativeDate`，它`TemplateScalarModel`使用`toString()`. 因此`yourDate?string`， where `yourDate`is a FreeMarker 字符串 ( `TemplateScalarModel`) 将评估为与 相同的字符串`yourDate`，因此`(...)`after 它将失败（您不能调用字符串）。何时`yourDate`是 FreeMarker 日期（`java.util.Date`正确转换为`TemplateDateModel`），`yourDate?string`评估为格式化程序方法，因此`(...)`之后就可以调用了。

因此，如果在 Alfresco 中使用 Rhino (JavaScript) 对象很常见，它们应该扩展它们`ObjectWrapper`以识别 Rhino 对象。也许他们需要做的就是混进去`freemarker.ext.rhino.RhinoWrapper`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T12:10:16.590

嗨，您可以在 Freemarker 中使用以下内容：

```
${siteNode.properties["my:customAspectDate"]?date?string("yyyy-MM-dd")} 
```

Alfresco 在活动 Dashlet 中执行此操作：

> 活动列表.get.html.ftl

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:57:33.583

Aaaaaand 回答我自己的问题，以防其他人也撞到这堵墙两天：

```
<#assign nodeR=companyhome.childByNamePath["Sites/" + site.shortName] />
"startdate": "<#if nodeR.hasAspect("my:customAspect")>${nodeR.properties["my:customAspectDate"]?string("yyyy-MM-dd")}</#if>", 
```

就像我在[论坛](https://forums.alfresco.com/en/viewtopic.php?f=36&t=46643)上所说的那样，我不知道为什么它以这种方式工作而不是其他方式。

# android - 来自多个活动的 Android TTS

> ID：12805491
> 
> 赞同：3
> 
> 时间：2012-10-09T17:44:11.380
> 
> 标签：android, android-activity

我想从几个活动中节省使用 TTS（一个主要活动可以启动多个其他活动）。

我意识到除了通过 Application 和`Activity.getApplication()`. 它几乎没有用，因为它`null`在 Activity 的`onCreate()`方法或构造函数中返回。这似乎是因为在对象完全构造之前，Activity 没有“附加”到 Application 上下文。

必须有一种不完全愚蠢的方法来做到这一点，比如在每个活动中重新实现 TTS。

替代方案：我使用 Intent 并`startActivity()`启动每个新 Activity，那么有没有办法通过 Activity 传递对顶层 Activity 的引用`Intent.putExtras()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:46:56.740

`TextToSpeech` is tied to a `Context` (Activity), so you can't really make a 'global' object you can just use anywhere. If you don't want to duplicate code, create an base `TtsActivity` and put common code there. Or, create a `TtsManager` or similar class that takes care of initializing, etc. TTS and put it in all activities that need it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:44:31.630

`getApplication()`如果从您的活动`onCreate()`方法中调用，则始终返回有效引用。如果在活动的构造函数中调用它将返回`null`，但无论如何您都不应该为活动定义构造函数。你想给自己打电话`onCreate()`吗？

如果要在`Application`实例中存储数据，则需要子类`Application`化，并且需要在清单中提供子类的名称为

```
<application android:name="fully.qualified.name.of.my.application.subclass"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:46:18.400

您可以创建一个继承自 Object 的常规 Java 类，并将所需的方法放入其中。

**编辑：** 我从未使用过 android TTS，但它应该看起来像这样，我会收集

```
public class SpeechHelper {

   public static void speak(String text, Context con)
   {
        TextToSpeech tts = new TextToSpeech(con, TextToSpeech.onInitListener {
             private void onInit(int status){
                 tts.speak(text, TextToSpeech.QUEUE_ADD, new HashMap<String, String>());
             }
        });
   }
} 
```

# javascript - 变量范围的简单点 - Javascript

> ID：12805493
> 
> 赞同：2
> 
> 时间：2012-10-09T17:44:26.357
> 
> 标签：javascript, global-variables, scope

> **可能重复：**
> [JavaScript 变量范围](https://stackoverflow.com/questions/500431/javascript-variable-scope)

我（显然）对 Javascript 很陌生，我在其他线程上看到了关于全局和局部变量使用的几个不同点，但我试图在一个地方锁定一些关于该主题的基本点。

以下在函数外部声明（或在内部使用）有什么区别？

var 事物 = 1;

东西=1；

我了解使用 var 在其当前范围内声明变量。因此，省略 var 使其成为全局变量。有哪些可能出现的陷阱？有人可以举一个简单的例子来说明在这种情况下变量可能会相互影响吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:27:04.810

1.  如果您已经在全局范围内，则差异很小，您不必担心

2.  想象一下你有两个`for`循环，你想用它们做点什么。

.

```
for (i = 0; i < elements.length; i++) {
    element = elements[i];
    for (i = 0; i < items.length) {
        item = items[i];
        element.add(item);
    }
} 
```

这段伪代码可以在许多不同的语言中正常工作。该程序会看到一个内循环和一个外循环，并且可以看出这`i`不是指同一件事。

在 JavaScript 中，它们是相同的`i`.
那是因为其他语言有块作用域——任何时候你输入新的花括号，程序都会把变量当作新变量来对待。

在 JavaScript 中只有函数作用域，这意味着函数内部的变量被视为新变量，但在控制语句（`if`, `for`, `switch`）内部，它们是具有相同值的相同变量。
所以外循环设置`i`为0，然后进入内循环。
内部循环遍历它的所有项目列表，并`i`随着它的进行而建立......
然后它回到外部循环，`i`仍然等于`items.length - 1`......
如果它小于`elements.length`然后它添加一个到`i`现在更高的比`items`长度，所以在内循环中什么也没有发生，不再...
...如果`items.length`大于`elements.length`而不是，那么外循环只会在一次之后结束。

现在，我相信您可以开始考虑在整个程序中多次使用`x`or `name`or `value`or `el`or `sum`or `i`or or `default`or `src`or `url`or `img`or`script`等​​的时间（甚至数万行），然后您可以开始考虑类似上面循环的情况，如果你尝试用相同的名称调用两个不同的东西，事情可能会出错。

***这与 var-fallthrough 的问题相同***

如果你有一个函数使用一个名为的变量`x`，而另一个函数使用另一个名为 的变量`x`，那就太好了……除非你忘记声明变量。

```
// no problems!
function func1 () { var x = 0; }
function func2 () { var x = "Bob"; }

// big problems!
function func1 () { x = 0; }
function func2 () { x = "Bob"; } 
```

`func1`集集`window.x = 0;` `func2`_`window.x = "Bob";`

...如果`window.x`应该等于 42，为了让其他程序正常工作，现在您有可能拥有 3 个损坏的应用程序，只是因为缺少一些`var`s。

不过，它不会立即设置全局变量。它实际上做的是通过函数链。如果您在另一个函数中创建一个函数，那么未声明的 var 将查找其父级的 var，然后是其祖父母的 var，然后是其曾祖父母的
var `window`...名称，然后它会在 . 上创建一个具有该名称的名称`window`。

```
function func1 () {
    var x = 0;

    function func2 () {
        var y = 1;
        x = 2;
        z = 3;
    }

    func2();
} 
```

当你调用 func1 时，它会将自己设置`x`为 0，然后调用 func2。func2 将其自身设置`y`为 1。然后将 func1's 设置`x`为 2。然后，因为 func2 没有，`z`而 func1 没有`z`也`window`没有`z`，所以它设置`window.z`为 3。

这只是混乱的开始，为什么它是一个非常非常好的主意，以确保您正在定义需要在该函数内部可用的变量（以及在该函数内部创建的任何函数）......。 ..当您引用预先存在的变量时，请仔细引用它们，并知道该变量在您的代码中应该在哪里（哪个函数定义了它......所以程序将在链上的哪个位置在它到达之前停止寻找`window`），以及为什么要从另一个函数内部更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:49:52.753

一个常见的陷阱是循环计数器——它们总是被命名`i`并且会发生冲突。例子：

```
function a() {
    for (i = 0; i < 5; i++)
        b();
}
function b() {
    for (i = 0; i < 3; i++)
        ; // something
    // now, the /global/ i is reset to 3
    // … and the condition in function a will never be met
}
// so
a();
// is an infine loop instead of executing something 15 times 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:18:14.657

与许多 C 风格的语言不同，JavaScript 支持块语法但不支持块作用域，因此以下代码可能无法按您的预期运行：

```
var foo = 'bar';

{
  var foo = 'baz';
}

console.log(foo); // 'baz' 
```

这在其他支持块的 JavaScript 结构中也很明显，例如`if`：

```
var foo = 'bar';

if (true) {
  var foo = 'baz';
}

console.log(foo); // 'baz' 
```

此外，正如 Bergi 指出的那样，您`i`的 s 计数器`for`将相互覆盖，因为 a`for`不会创建新范围。

Crockford 认为 JavaScript 缺少块作用域是该语言的[“糟糕的部分”](https://rads.stackoverflow.com/amzn/click/com/0596517742)。相反，JavaScript 有[词法作用域](http://en.wikipedia.org/wiki/Lexical_scoping#Lexical_scoping_and_dynamic_scoping)，所以只有函数会创建一个新的作用域：

```
var foo = 'bar';

(function() {
  var foo = 'baz';
  console.log(foo); // 'baz'
}());

console.log(foo); // 'bar' 
```

JavaScript 中的每个函数都可以访问包含它的函数中的变量；内部可以访问外部，但反之则不行。在上面的示例中，[IIFE](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)（立即调用的函数表达式）可以访问`foo = 'bar';`全局范围内的定义，但我们选择`foo`使用本地`var`声明覆盖并将其设置为等于`'baz'`。

奖励点：Shog9 发现`with`可以使用对象字面量模拟块范围，如下所示：

```
var foo = 'bar';

with ({foo: 'baz'}) {
  console.log(foo); // 'baz'
}

console.log(foo); // 'bar' 
```

Crockford[不鼓励`with`](http://yuiblog.com/blog/2006/04/11/with-statement-considered-harmful/)由于其模棱两可，但如果你真的想要块范围，我认为`with`解决方法没有什么害处。

# objective-c - iOS 6 - (BOOL) shouldAutorotate 有什么意义？

> ID：12805499
> 
> 赞同：12
> 
> 时间：2012-10-09T17:44:36.563
> 
> 标签：objective-c, uiviewcontroller, ios6

据我所知，iOS 6 上的正确做法是编写这样的代码来处理自动旋转：

```
// iOS 6
- (BOOL)shouldAutorotate {
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskPortrait;
} 
```

而不是写

```
// pre-iOS 6 support
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation {
    BOOL retVal = UIInterfaceOrientationIsLandscape(toInterfaceOrientation);
    return retVal;
} 
```

老实说，我认为 iOS 6 之前的版本要清楚得多：我不明白有两种方法来处理自动旋转的意义，特别是因为我在所有示例中都看到了`-(BOOL) shouldAutorotate`返回。`YES`我错过了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T17:54:45.387

新的 API 让您可以保存调用以获取当前设备方向：两个问题，即

*   无论新方向如何，应用程序是否应自动旋转，以及
*   设备支持的方向是什么

最常见的是静态应答，无需调用检查当前方向。当屏幕具有由单独的视图控制器控制的多个视图时，节省变得更加重要。

由于 iOS 正在调用您的应用程序`shouldAutorotate`以响应来自加速度计的事件，因此它已经知道新的方向；如果您的应用回答“是”，则 iOS 可以根据支持的列表检查当前方向，并在您的应用不查询当前方向的情况下做出决定。

在极少数情况下，您的应用需要根据新方向决定自动旋转，新 API 并不比旧 API 差，因此这是一种“双赢”的情况。

# post - 什么是 UrlFetch 帖子大小限制？

> ID：12805510
> 
> 赞同：1
> 
> 时间：2012-10-09T17:45:37.260
> 
> 标签：post, google-apps-script, urlfetch

我试图找出[`UrlFetchApp`](https://developers.google.com/apps-script/class_urlfetchapp#fetch)POST 大小限制是什么？脚本将一些电子邮件附件上传到 Web 服务，并返回以下错误：

> “超出限制：UrlFetch 帖子大小。（第 XX 行）”。

除了向它发送一堆不同大小的文件之外，我无法解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:38:10.217

您可以发布的最大大小为 10 MB 请参阅[https://docs.google.com/macros/dashboard](https://docs.google.com/macros/dashboard)，您可以在其中获取记录的 Apps 脚本配额和限制信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-02-18T11:06:26.093

更新信息：现在是 50MB [https://developers.google.com/apps-script/guides/services/quotas#current_limitations](https://developers.google.com/apps-script/guides/services/quotas#current_limitations)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-01T03:49:14.543

可以在此处找到配额详细信息：[https ://developers.google.com/apps-script/guides/services/quotas#current_limitations](https://developers.google.com/apps-script/guides/services/quotas#current_limitations)

它是 10MB 最大 URL Fetch POST 大小

# ajax - 是否可以异步重新渲染头部（JSF2/Ajax/Richfaces）

> ID：12805515
> 
> 赞同：1
> 
> 时间：2012-10-09T17:46:24.330
> 
> 标签：ajax, jsf, jsf-2, ajax4jsf

我动态地将一些复合组件包含到我的页面中，这些组件在单独的文件中包含 css 声明。我的问题是该页面仅通过 ajax 调用部分呈现，因此头部不会重新呈现或更新，但当我包含组件时，我不会每次都重新呈现整个页面。

如果尝试`<h:head id="head"/>`在我的模板和/或我的 facelet 根页面中重新渲染头部并重新渲染此部分，`<a4j:ajax render="head"/>`但这似乎不起作用。

是否有可能在不重新加载整个页面的情况下重新渲染头部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T14:05:06.153

直接渲染 HEAD 标记意味着重新渲染 AJAX-Script jsf.js 本身。这将导致不希望的结果，例如脚本循环。

有一个 AJAX 扩展来跟踪每个视图上的标题脚本并动态插入它们。该解决方案是扩展“JSF Ext”的一部分。

# ruby-on-rails-3 - 在 Rails 中通过电子邮件激活用户

> ID：12805523
> 
> 赞同：3
> 
> 时间：2012-10-09T17:46:51.240
> 
> 标签：ruby-on-rails-3

我还在学习 Rails，我有一个简单的项目，用户通过提供他们的电子邮件和密码来注册。我希望用户在单击电子邮件链接之前处于非活动状态。我按照 RailCasts 的示例重置密码，这就是我想出的：

我在我的用户模型中添加了两个新字段：

*   激活令牌：字符串
*   活动：布尔

在里面`User.rb`我有以下两种方法：

```
def send_activation
  generate_token(:activation_token)
  UserMailer.activation(self).deliver
end

def generate_token(column)
  begin
    self[column] = SecureRandom.urlsafe_base64
  end while User.exists?(column => self[column])
end 
```

我创建了一个名为的新控制器`ActivationsController`，其中包含一个方法：

```
 def update
    @user = User.find_by_activation_token(params[:id])

    @user.update_attribute(:active, true)
    flash[:success] = "Your account is now activated."
    redirect_to root_path
  end 
```

在里面`routes.rb`我添加了这条路线：

```
resources :activations, only: [:update] 
```

`UserMailer`我用以下方法创建了一个：

```
def activation(user)
  @user = user
  mail to: user.email, subject: "Account Activation"
end 
```

`rake routes`说：

```
activation PUT  /activations/:id(.:format)  activations#update 
```

在里面`activation.text.erb`我有这个：

```
To activate your account, please click the link below:
<%= link_to activation_url(@user.activation_token), method: :put %> 
```

现在，当我尝试注册用户时，我在发送电子邮件之前收到此错误：

```
No route matches {:method=>:put} 
```

有任何想法吗？

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:43:23.300

您缺少链接文本：

```
<%= link_to 'TEXT', activation_url(@user.activation_token), method: :put %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-19T19:39:04.067

我知道这已经很老了，但我也遇到了这个问题。我想回答它以帮助其他人。

我认为问题出在使用activation#update 操作，您应该使用activation#edit 操作，因为该操作使用GET 请求而不是PATCH 请求。由于用户是通过电子邮件接收的（因此在 Rails 服务器之外），它应该是一个普通的旧 GET link_to。

此外，至少在 RAILs 4 中（这个问题可能早于这个问题），您可以将参数添加到您的 url 路径中，并在初始变量之后使用哈希。所以...

`<%= link_to "TEXT", edit_account_activation_url(@user.activation_token, email: @user.email)`

（如果您想使用用户的电子邮件对 activation_token 进行身份验证。）

我不确定您的其余代码是如何设置的，但是关于您对第一个答案的最后评论，这是 railstutorial.org/book 中我发现有用的内容...

> 因为我们使用 Account Activations 资源对激活进行建模，所以令牌本身可以作为命名路由的参数出现

此外，这本书指出（在脚注中）为什么我们要使用编辑操作而不是更新...

> 使用更新操作可能更有意义，但激活链接需要在电子邮件中发送，因此应该涉及常规浏览器点击，它发出 GET 请求而不是更新操作所需的 PATCH 请求。

来源：[Rails 教程：第 10 章](https://www.railstutorial.org/book/account_activation_password_reset#cha-10_footnote-3)

# php - 需要帮助循环查询结果

> ID：12805525
> 
> 赞同：0
> 
> 时间：2012-10-09T17:46:54.080
> 
> 标签：php, codeigniter, mysqli

# 模型

```
 $data   =   array();
    $session_id = $this->session->userdata('id'); 

    $q = $this->db->get_where('cust_orders', array('cust_id' => $id));

        foreach ($q->result() as $row)
        {
            $data['id'] = $row->cust_id; 
            $data['orders'] = $row->cart; 

        }
            return $data; 
```

# 控制器

传递`data`给视图

# 看法

```
<?php foreach($_orders as $key => $item) : ?>
<tr>

    <td>
    <?php 
        $price = $item['price']; #change this to order status 

        switch ($price) 
        {
        case (64); $UPSTrack = '1Z12345E1512345676'; #Shipped add tracking number
              echo 'Shipped <br> <a href="http://wwwapps.ups.com/WebTracking/track?track=yes&trackNums='.$UPSTrack.'">Track My Order</a>'; 
              break;

        case (88);
              echo 'Shipped'; 
              break;

        default;
              echo 'Processing'; 
              break;
        }
    ?>

    </td>

    <td>
    <?php foreach ($item['options'] as $option => $value) 
            {
            echo '<span class="option">'.$option . ': </span> <span class="options">' . $value . '</span>';
            } 
    ?>
    </td>

    <td><?php echo $item['id']; ?></td>

    <td><?php echo $item['qty'];  ?></td>

    <td><?php echo number_format($item['price'],2); ?></td>

</tr>    

<?php endforeach; ?> 
```

**选项是一个数组**

包含一个`foreach`循环遍历`array`包含在变量中的`$data['orders'] = $row->cart;`

在数据库中，我正在查找一个客户的`cust_orders`表，`cust_id`可能有多个`1`行，这意味着多个订单。

问题是我只循环最后一行。我需要遍历`cust_id`is = to 的所有行`$session_id`。

我觉得问题出在我身上，`MODEL`因为如果我更改 `$data['id'] = $row->cust_id;`为 `echo $row->cust_id;' I am able to see all of the rows which match the customers id, but it breaks my`foreach` 代码。

如何正确分配查询`values`中的返回值，`MODEL`以便显示所有 cust_orders == to `$session_id`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:51:04.150

现在，您正在用每个客户值覆盖您的数组，因此您需要多维数组。

它应该如下所示

**编辑：更改模型中的 foreach 如下**

```
 foreach ($q->result() as $row)
    {
        $data['id'] = $row->cust_id; 
        $data['orders'][] = $row->cart; 

    } 
```

# vb.net - VB中变量的地址

> ID：12805527
> 
> 赞同：1
> 
> 时间：2012-10-09T17:46:57.670
> 
> 标签：vb.net, string-concatenation

这在 C 中很容易，我将如何在 VB 中做到这一点？
这就是我现在正在尝试的。

```
Dim a As String = "a"
Dim b As String = "b"
Dim c As String = "c"
Dim d As String = "d"

For Each i in {a, b, c, d}
    i = "blah" & i
End For 
```

这不起作用，因为这只是修改`i`而不是基础变量。

我真正需要的是一个指针！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:59:28.057

VB 的`For Each`循环不支持这样的结构。这很遗憾，但无论如何都有更好的方法。一般尽量避免循环：

```
Dim items = {a, b, c, d}.Select(Function (s) "blah" & s) 
```

如果这不是有效的 VB（将集合初始化程序与方法调用相结合......），以下确实有效：

```
Dim items = (New List(Of String)() From {a, b, c, d}).Select(Function (s) "blah" & s) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:55:01.993

在这里，使用数组中变量的地址，而不是内存中变量的地址：

```
Dim a As String = "a"
Dim b As String = "b"
Dim c As String = "c"
Dim d As String = "d"
Dim items = {a,b,c,d}

For i As Integer = 0 To items.Length - 1
   items(i) = "blah" & items(i) 
```

# xcode - EventKit RequestAccess 无法在 iOS 模拟器中重置以进行测试

> ID：12805529
> 
> 赞同：1
> 
> 时间：2012-10-09T17:47:00.837
> 
> 标签：xcode, xamarin.ios, ios6, xamarin

我正在测试 iOS 6 中日历（EventKit）集成的新请求访问要求。测试中的问题是，一旦出现提示，它将永远不会再次出现，即使在 iOS 模拟器中或从设备中删除应用程序也不会。iOS 模拟器中还有其他问题，因为您从未在设置/隐私/日历中看到创建条目，因此我无法验证 sim 中的功能。

有人知道如何重置访问请求系统，以便我可以查看和测试提示和各种条件吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:01:25.437

我看到在设备上重置它们的位置（不是 sim） - 转到设置 / 常规 / 重置 / 重置位置和隐私，这样就可以了。

谢谢@poupou 的sim 信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:54:31.957

您可以尝试重置模拟器本身。您可以从**iOS 模拟器**菜单中执行此操作，然后选择**重置内容和设置...**

请注意，这将删除当前正在执行的模拟器版本的所有应用程序、数据（和设置）。

OTOH 可能无法正常工作，因为模拟器上的隐私检查不完整。来自 Apple [iOS6 SDK 发行说明](http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html#//apple_ref/doc/uid/TP40012166-CH1-SW19)：

> 模拟器
> 
> *   对于访问照片、通讯录、日历和提醒的应用程序，iOS 模拟器中不会显示任何隐私警报。

# javascript - 单击按钮而不是键位时执行脚本

> ID：12805532
> 
> 赞同：1
> 
> 时间：2012-10-09T17:47:09.557
> 
> 标签：javascript, count, onclick, words

我正在尝试将以下内容转换为通过单击按钮而不是在 keyup 事件上执行。这是一个文本限制器。用户输入文本，我想通过单击按钮将此文本限制（修剪）为 75 个字符。

```
<p>Type something in the textbox below: </p>
<textarea id="message" name="message" rows="4" cols="30"></textarea>
<div class="charLeft" id="countCharacter">75 characters left</div>

<script>
  function CountLeft(field, max) {
      if (field.val().length > max) 
          field.val(field.val().substring(0, max));
      else 
          jQuery(".charLeft").html((max - field.val().length) + " characters left");
  }

  jQuery("#message").keyup(

  function(event) {
      CountLeft(jQuery(this), 75); // you can increase or derease the number      depend on your need.
  }); 
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:52:05.937

假设您的 html 中某处有一个按钮（未出现在您的问题中），例如：

```
<div id="your-button">Click Me</div> 
```

那么这将达到我*认为*你想要的效果。现在*只有*在用户单击时才会修剪输入`your-button`。

```
$('#your-button').click(function() {
    CountLeft($('#message'),75);
}); 
```

如果您也想保留原始行为（这是一个好主意，IMO），您可以这样做：

```
function CheckLength(input_selector,length) {
    return function() {
        CountLeft($(input_selector),length);
    }
}

var input_selector = '#message';
var input_length = 75;
$('#your-button').click(CheckLength(input_selector,input_length));
$('#message').keyup(CheckLength(input_selector,input_length)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:56:51.960

我认为您不想使用按钮...您想检查每种键类型...`keyup`释放键盘按钮时引发的事件，如果我理解正确您的问题，您希望在何时引发事件您单击按钮，为此，您可以使用`keydown`此处描述的事件：http: [//api.jquery.com/keydown/](http://api.jquery.com/keydown/)

```
$('#message').keydown(function(e) {
  CountLeft(jQuery(this), 75);
}); 
```

# asp.net - CodeFile OK，CodeBehind 给出“未声明”错误

> ID：12805533
> 
> 赞同：1
> 
> 时间：2012-10-09T17:47:09.887
> 
> 标签：asp.net, code-behind

我有一个使用 CodeFile 的 asp 项目，但是当我将其更改为 CodeBehind 时，在 aspx 文件中无法识别 vb 函数，从而在 aspx 文件中给出“名称...未声明”错误。

为了使用 CodeBehind，除了在第一行更改`codefile`为之外，还有其他事情要做吗？`codebehind`

以下代码在 aspx 文件中收到错误“未声明名称 'connex'”。

```
<%@ Page Language="vb" AutoEventWireup="false" Codebehind="browse.aspx.vb" Inherits="_browse" %> <!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head runat="server"> <title>Test</title> </head> 
<body> 
<form id="form1" runat="server">
<div>
<%
  Dim s As String = connex()  
  Response.Write(s)
%>
</div>
</form>
</body>
</html> 
```

===================

```
Imports System
Imports System.Web

Partial Public Class _browse
Inherits System.Web.UI.Page

Function connex() As String
  Return "OK"
End Function

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:27:44.357

检查你的

```
Inherits="_browse" 
```

确保包含正确的命名空间。

```
Inherits="MyNameSpace._browse" 
```

# java - 将数组初始值设定项直接传递给方法参数不起作用

> ID：12805535
> 
> 赞同：5
> 
> 时间：2012-10-09T17:47:12.550
> 
> 标签：java, arrays

```
package arraypkg;

import java.util.Arrays;

public class Main
{
    private static void foo(Object o[])
    {
        System.out.printf("%s", Arrays.toString(o));
    }

    public static void main(String[] args)
    {
       Object []o=new Object[]{1,2,3,4,5};
       foo(o);                     //Passing an array of objects to the foo() method.

       foo(new Object[]{6,7,8,9}); //This is valid as obvious.

       Object[] o1 = {1, 2};      //This is also fine.
       foo(o1);

       foo({1,2});               //This looks something similar to the preceding one. This is however wrong and doesn't compile - not a statement.
    }
} 
```

在前面的代码片段中，除最后一个之外的所有表达式都已编译并运行良好。尽管最后一条语句看起来与它的直接语句相似，但编译器会发出编译时错误 - 表达式的非法开始 - 而不是语句。为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-09T17:48:49.347

```
foo({1,2}); 
```

{1, 2} 这种数组初始化只在你声明数组的地方起作用。在其他地方，你必须使用`new`关键字来创建它。

因此： -

```
Object[] obj = {1, 2}; 
```

很好..这是因为数组的类型隐含在`reference`我们在 LHS 上使用的类型中。但是，当我们在其他地方使用它时，编译器无法找出类型（就像你的情况一样）..

尝试使用： -

```
 foo(new Object[]{1,2}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T17:49:58.887

`foo({1,2});` 不知道它是什么类型的数组。因此，编译器无法理解语法。所有其他声明指定数组的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:53:05.783

`foo({1,2});`不是数组。

由于您的`foo()` 方法采用**数组类型参数**，因此失败。

# java - 带有关键字的Java拆分字符串

> ID：12805536
> 
> 赞同：3
> 
> 时间：2012-10-09T17:47:18.557
> 
> 标签：java, regex, string, split

我在拆分以下字符串时遇到问题。

```
String str = "eat big mac .at East MacDonald .from onwards"; 
```

我希望结果在

```
[ eat big mac, .at, East MacDonald, .from, onwards] 
```

我不能按空格或点分割，有什么办法可以分割成那个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:11:02.423

您可以使用特殊标记（或分隔符）包装关键字，然后使用此分隔符进行拆分：

```
String str = "eat big mac .at East MacDonald .from onwards";
String[] arr = str.replaceAll("(\\.\\w+)", "DELIMITER$1DELIMITER").split("DELIMITER"); 
```

这会产生输出：

`[eat big mac , .at, East MacDonald , .from, onwards]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:53:14.297

您始终可以对使用的每个字符串使用 split() 方法。

```
String str = "eat big mac .at East MacDonald .from onwards";
String[] spaceDelimitedStr = str.split(" ");
String[] dotDelimitedStr = str.split("\\.");
String[] commaDelimitedStr = str.split(","); 
```

并且因为 split 函数的输入是一个正则表达式，所以您可以提供各种分隔符

对于你正在寻找的结果，它很难得到你想要的东西，我能问一下你为什么需要这样吗？

# jquery - 使用 jQuery 显示部分滑动内容

> ID：12805537
> 
> 赞同：1
> 
> 时间：2012-10-09T17:47:20.980
> 
> 标签：jquery, slider, slidetoggle

我有一个元素，我想默认显示一部分（比如 100px），然后通过单击链接显示其余部分。我发现这个[网站](http://sim.plified.com/2008/09/15/sliding-content-from-a-partial-height-with-jquery/)有一个解决方案，因为 jQuery 的内置 slideToggle 似乎无法实现。此解决方案有效（如下面的代码所示），但不适用于同一页面上的多个滑块。我知道我需要以某种方式用特定滑块的 id 切换“.slider”，但不知道该怎么做。我需要获取当前 ID，但是将其与 openSlider 和 closeSlider 函数一起使用是行不通的。任何人都可以帮忙吗？我确定这是一个相当简单的问题，我似乎无法弄清楚。

**HTML**

```
<ul class="slider" id="1-slider">
  <li><img src="http://dummyimage.com/490x340" alt="#" /></li>
  <li><img src="http://dummyimage.com/490x340" alt="#" /></li>
  <li><img src="http://dummyimage.com/490x340" alt="#" /></li>
</ul> <!-- .images -->

<div class="slider_menu"></div> 
```

**jQuery**

```
var sliderHeight = "100px";
$('.slider').each(function() {
    var current = $(this);
    current.attr("box_h", current.height());
});

$('.slider').css("height", sliderHeight);
$(".slider_menu").html('<a href="#" class="expand">Expand</a>');
$(".slider_menu a").click(function() {
    openSlider();
    return false;
});

function openSlider() {
    var open_height = $('.slider').attr("box_h") + "px";
    $('.slider').animate({
        "height": open_height
    }, {
        duration: "slow"
    });
    $(".slider_menu").html('<a href="#" class="expand">Collapse</a>');
    $(".slider_menu a").click(function() {
        closeSlider();
    });
    return false;
}

function closeSlider() {
    $('.slider').animate({
        "height": sliderHeight
    }, {
        duration: "slow"
    });
    $(".slider_menu").html('<a href="#" class="expand">Expand</a>');
    $(".slider_menu a").click(function() {
        openSlider();
    });
    return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:08:20.117

脚本应该是这样的：

```
var sliderHeight = "100px";
$('.slider').each(function() {
    var current = $(this);
    current.attr("box_h", current.height());
});

$('.slider').css("height", sliderHeight);
$(".slider_menu").html('<a href="#" class="expand">Expand</a>');
$(".slider_menu a").click(function() {
    openSlider($(this).parent().prev("ul.slider"), $(this).parent());
    return false;
});

function openSlider(obj, slideMenu) {
    var open_height = $(obj).attr("box_h") + "px";
    $(obj).animate({
        "height": open_height
    }, {
        duration: "slow"
    });
    $(slideMenu).html('<a href="#" class="expand">Collapse</a>');
    $(slideMenu).children("a").click(function() {
        closeSlider(obj, slideMenu);
    });
    return false;
}

function closeSlider(obj, slideMenu) {
    $(obj).animate({
        "height": sliderHeight
    }, {
        duration: "slow"
    });
    $(slideMenu).html('<a href="#" class="expand">Expand</a>');
    $(slideMenu).children("a").click(function() {
        openSlider(obj, slideMenu);
    });
    return false;
} 
```

希望这能解决您的问题！

# database - 根据使用经典 ASP 从下拉列表中选择的选项填充网页中的字段

> ID：12805539
> 
> 赞同：0
> 
> 时间：2012-10-09T17:47:28.793
> 
> 标签：database, asp-classic, combobox

我有一个包含下拉组合框的页面，其值来自数据库。组合框旁边是两个文本框。

现在基于从下拉列表中选择的选项，我需要转到数据库并从数据库中获取相关数据并填充两个文本框。

页面中还有其他字段是直截了当的，但我不知道如何处理这种情况。

任何链接/示例代码/阅读材料/或任何其他形式的帮助将不胜感激。

谢谢，

好的，我在这里大声思考，这是示例代码

```
 <%
    While not rsRecordSet.EOF
    %>
    <OPTION VALUE="<%=rsRecordSet("FldID")%>"><%=rsRecordSet("FldName")%></OPTION>
    <%
    rsRecordSet.MoveNext
    Wend
    Set rsRecordSet= nothing
    %> 
```

我需要值，即 FldID 作为对所选数据的引用，但如果我可以在某处标记其余数据。例如，其他两个字段需要显示 FldAge 和 FldGender。我可以在 rsRecordSet 中获取它们，并且当我填充选项时，我可以填充一些标签以及稍后根据从组合中选择的选项如何调用它。只是在这里大声思考。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T21:40:53.117

当然有很多方法可以做到这一点。此示例将在您选择一个选项时提交表单，然后显示年龄和性别。（查询、连接等需要更改以适合您的对象）

```
<form action="" method="get">
    <select name="id" onchange="this.form.submit()">
<%
While not rsRecordSet.EOF
%>
        <OPTION VALUE="<%=rsRecordSet("FldID")%>"><%=rsRecordSet("FldName")%></OPTION> 
<% 
    rsRecordSet.MoveNext 
Wend 
Set rsRecordSet= nothing 
%>
    </select> 
</form>
<%
If Request.QueryString("id") <> "" Then
'Open recordset to retrieve age and gender
rsRecordSet2.Open "SELECT FldAge, FldGender FROM table WHERE FldID = " & CInt(Request.QueryString("id")), connection
If Not rsRecordSet2.EOF Then
%>
    Age: <%= rsRecordSet2("FldAge") %><br />
    Gender: <%= rsRecordSet2("FldGender") %><br />
<%
End If
rsRecordSet2.Close
Set rsRecordSet2 = Nothing
%> 
```

最好用 AJAX 做这种事情，即使在经典 ASP 中也很容易做到，特别是如果你可以使用 jQuery。如果您想这样做，我可以发布一个示例。

**使用 AJAX 解决方案更新：**

好的，这是一个使用 jQuery 的示例，我建议您使用它，因为在 JavaScript 中执行 Ajax 将花费我太长时间...

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#id").change(function() {
            $.get('ajax.asp?id='+$("#id").val(), function(data) {
                var fields = data.split(',');
                $("#age").html(fields[0]);
                $("#gender").html(fields[1]);
            }); 
        });
    });
</script>

<select id="id">
<%
While not rsRecordSet.EOF
%>
    <OPTION VALUE="<%=rsRecordSet("FldID")%>"><%=rsRecordSet("FldName")%></OPTION>
<%
    rsRecordSet.MoveNext
Wend
Set rsRecordSet= nothing
%>
</select>
<div id="age"></div>
<div id="gender"></div> 
```

创建一个名为 ajax.asp 的脚本。您将需要在其中添加所有数据库连接内容。然后根据传递的 ID 打开一个记录集，并将年龄和性别作为逗号分隔的字符串返回，如下所示：

```
<%
'Open recordset to retrieve age and gender 
rsRecordSet2.Open "SELECT FldAge, FldGender FROM table WHERE FldID = " & CInt(Request.QueryString("id")), connection 
If Not rsRecordSet2.EOF Then 
    Response.Write(rsRecordSet2("FldAge") & "," & rsRecordSet2("FldGender"))
End If 
rsRecordSet2.Close 
Set rsRecordSet2 = Nothing 
%> 
```

# google-chrome - 如何监控 chrome.storage 条目？

> ID：12805541
> 
> 赞同：1
> 
> 时间：2012-10-09T17:47:38.323
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-devtools

chrome 开发人员窗口（用于运行扩展页面）中的资源选项卡有一个部分用于监视 localStorage 变量的当前状态。是否没有类似的部分来监视存储在较新的 chrome.storage 下的变量/对象（本地和同步）？

# coffeescript - 相当于咖啡脚本中的 ruby Hash#reject

> ID：12805543
> 
> 赞同：0
> 
> 时间：2012-10-09T17:47:45.513
> 
> 标签：coffeescript

与 ruby​​ 的 Hash#reject/delete_if 方法最接近的等价物是什么？

```
{a:1, b:2, c:3, d:4}.reject { |k,v| v > 2 }
=> {:a=>1, :b=>2} 
```

这个快速版本使用`key, value of <Object>`但它并不优雅，并且缺乏传递任意条件的能力（作为一个块或其他）

```
params = {a:1, b:2, c:3}
filter = (hash)->
    result = {}
    (result[key] = value unless value > 2) for key, value of params
    result

console.log(filter(params)) 
```

underscore 有类似的`_.omit`方法，但只适用于键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:06:15.577

不幸的是，CoffeeScript 推导总是生成数组。您可以使用 Underscore 的[`object`](http://underscorejs.org/#object)方法将`[key, value]`数组转换为对象：

```
obj = {a:1, b:2, c:3, d:4}
_.object([k, v] for k, v of obj when v <= 2) # -> {a:1, b:2} 
```

我建议您为此特定目的编写自己的方法：

```
reject = (obj, predicate) ->
  res = {}
  res[k] = v for k, v of obj when not predicate k, v
  res

reject {a:1, b:2, c:3, d:4}, (k, v) -> v > 2 # -> {a:1, b:2} 
```

# c# - 一个正则表达式有效，另一个无效

> ID：12805548
> 
> 赞同：1
> 
> 时间：2012-10-09T17:48:03.003
> 
> 标签：c#, .net, regex

我正在寻找看起来像`abc/def`. 任何地方的文本周围都可能有空格，因此以下所有内容都是有效的：`abc__/_def`或`__abc/__def__`. （使用下划线来可视化空间。）

我想出了这个正则表达式：

```
(?<=\s*)abc\s*\/\s*def(?=\s*|^) 
```

这可以找到匹配项。我最近才拿起前瞻并尝试使用此表达式`/`从匹配中排除空格（因此`abc__/_def`会产生匹配`abc/def`）：

```
(?<=\s*)abc(?=\s*)\/(?=\s*)def(?=\s*|^) 
```

这个表达式不起作用 - 我显然误解了一些关于前瞻的东西。有人能解释一下这两种表达方式的区别吗？（这甚至可能是我想要做的吗？在阅读了 Regex 文档后，我认为是的，但也许我错了。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:12:28.593

当您尝试查找某些内容并将其从结果中排除时，会使用前瞻等。

如果斜杠和 abc 之间有空格，例如前瞻会找到它们，但是它不能选择空格作为结果，因为您排除了它们。没有与您的表达式匹配的连续字符串，因此没有选择任何字符串。

你想从选择中排除空格，据我所知你不能这样做。

如果你愿意，你可以只选择 abc。

```
(?<=\s*)abc(?=(\s*\/\s*def(\s*|^))) 
```

但是您不能将您的选择分散到不同的区域。

如果您必须在之后过滤您的选择，我建议使用字符串生成器并像这样遍历结果（出于速度原因）。

```
 public Boolean TryRegexMatchRemovedWhiteSpace(string input, string expr, out String matched)
    {

        Match m = Regex.Match(input, expr);
        if (m.Success)
        {
            StringBuilder r = new StringBuilder(m.Value.Length);
            foreach (var c in m.Value)
            {
                if (!char.IsWhiteSpace(c))
                {
                    r.Append(c);
                }
            }
            matched = r.ToString();
        }
        else
        {
            matched = "";
        }
        return m.Success;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:55:00.677

任何 .NET 正则表达式返回的匹配都是原始字符串的连续子字符串。这意味着您无法摆脱“/”字符周围的空格。不过，您可以摆脱外部空间。

一个好的方法是匹配`abc`和`def`使用命名组，并使用

```
Match m = ...;
var part1 = m.Groups["part1"].Value;
var part2 = m.Groups["part2"].Value; 
```

尝试这个：`^\s*(?<part1>\w+)\s*/\s*(?<part2>\w+)\s*$`

通常，正则表达式对于命名组和没有环视更自然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:59:40.880

这是因为它向前看，但在尝试匹配时不包括它。所以，如果你使用

**abc(?=\s*)**

它将匹配 **abc** 或**abc___**

但对于这两种情况，匹配组 [0] 都是“abc”。

因此，您的第二个正则表达式将仅匹配 abc/def，但不匹配 abc__/_def

读者

# css - 将 nth-child 伪选择器应用于特定的行类

> ID：12805552
> 
> 赞同：7
> 
> 时间：2012-10-09T17:48:16.857
> 
> 标签：css, css-selectors

我有一个问题，我不确定是浏览器问题还是 CSS3 问题。

我有一个使用标准 HTML 表的数据网格：

```
<table>
    <thead>
        ...
    </thead>
    <tbody>
        <tr class="found">
            <td>...</td>
            <td>...</td>
            <td>...</td>
        </tr>
        <tr class="found">
            <td>...</td>
            <td>...</td>
            <td>...</td>
        </tr>
        <tr class="found">
            <td>...</td>
            <td>...</td>
            <td>...</td>
        </tr>
    </tbody>
</table> 
```

我有一个搜索 TD 元素内容的 jQuery 函数。如果找到，它会维护找到的类。如果未找到，则删除找到的类并添加未找到的类。自然， not-found 只是设置 display: none

所以搜索功能正在按照我想要的方式工作。班级被适当分配。但是，我使用 CSS 伪选择器将样式应用于交替行。

```
tr.found:nth-child(even) {
    background: #fff;
}
tr.found:nth-child(odd) {
    background: #000;
} 
```

这在搜索发生之前效果很好。但是，在搜索和应用未找到的类之后，伪选择器似乎只适用于元素而不是元素和类。要么，要么在页面加载期间应用伪选择器，并在此时保持静态。

我可以通过我的 jQuery 搜索并重新分配特定的偶数和奇数类，但这会变得混乱。这没什么大不了的，但我的列标题是可排序的，所以我必须在该事件上重新应用类，同时创建一种低效的方法来做我正在做的事情。如果数据样本太大，您可能会看到类的迭代变化，这是我试图避免的。

有什么解决办法吗？

编辑

根据要求，我设置了一个 JSFiddle，以便天才可以玩弄它：http: [//jsfiddle.net/bDePR/](http://jsfiddle.net/bDePR/)

搜索总裁或秘书将产生该行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:37:25.983

这是我能想到的最简单的方法，使用 jQuery :visible 选择器来查找所有可见的 tr 元素（在它们被排序之后），然后简单地将 CSS 应用于交替的元素！

```
// reset the background
$j('tr').css('background', '#ccc');
$j('tr:visible').each(function(i){
    if((i % 2) == 0) {
        // apply background to every other one
        $j(this).css('background', 'yellow');
    }
}); 
```

例如[http://jsfiddle.net/bDePR/1/](http://jsfiddle.net/bDePR/1/)

**编辑：**

这一点，@amustill 的做法相同，但更高效/简洁

```
// reset the background
$j('tr').css('background', '#ccc');
$j('.found').filter(':odd').css({ background: 'yellow' }); 
```

# solr - Solr 4 索引创建一个没有名称但所有字段值连接为该字段值的字段

> ID：12805553
> 
> 赞同：0
> 
> 时间：2012-10-09T17:48:19.027
> 
> 标签：solr

我在 Solr 中有几个 text_en 字段，它们是“索引的”但不是“存储的”。我将文档的这些大文本值存储在 MongoDb 中。但是，当我查看 Solr 索引时，每个文档都有一个没有名称的字段。但是文档的所有字段（包括已索引但未存储的）都存储在该字段中。

这个字段是什么，我该如何消除它。它正在增加我的索引的大小。

```
 <fields>
  <dynamicField indexed="true" name="*_i" stored="true" type="int"/>
  <dynamicField indexed="true" name="*_s" stored="true" type="string"/>
  <dynamicField indexed="true" name="*_l" stored="true" type="long"/>
  <dynamicField indexed="true" name="*_t" stored="true" type="text_en"/>
  <dynamicField indexed="true" name="*_b" stored="true" type="boolean"/>
  <dynamicField indexed="true" name="*_f" stored="true" type="float"/>
  <dynamicField indexed="true" name="*_d" stored="true" type="double"/>
  <dynamicField indexed="true" name="*_tiled" stored="false" type="double"/>
  <dynamicField indexed="true" name="*_dt" stored="true" type="date"/>
  <dynamicField indexed="true" name="*_p" stored="true" type="location"/>
  <dynamicField name="random_*" type="random"/>
  <dynamicField indexed="true" multiValued="true" name="attr_*" stored="true" type="string"/>
  <dynamicField indexed="true" multiValued="true" name="*" stored="true" type="text_en"/>
  <dynamicField indexed="true" multiValued="true" name="attr_*" stored="true" type="string"/>
  <!-- My Custom Fields -->
  <uniqueKey>id</uniqueKey>
  <defaultSearchField>text_all</defaultSearchField>
  <solrQueryParser defaultOperator="AND"/>

  <copyField dest="author_display" source="author"/>
  <copyField dest="keywords_display" source="keywords"/>

  <copyField dest="text_all" source="id"/>
  <copyField dest="text_all" source="url"/>
  <copyField dest="text_all" source="title"/>
  <copyField dest="text_all" source="description"/>
  <copyField dest="text_all" source="keywords"/>
  <copyField dest="text_all" source="author"/>
  <copyField dest="text_all" source="body"/>
  <copyField dest="text_all" source="*_t"/>

  <copyField dest="spell" source="title"/>
  <copyField dest="spell" source="body"/>
  <copyField dest="spell" source="description"/>
  <copyField dest="spell" source="author"/>

  <copyField dest="autocomplete" source="title"/>
  <copyField dest="autocomplete" source="body"/>
  <copyField dest="autocomplete" source="description"/>
  <copyField dest="autocomplete" source="author"/>
</fields> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:03:58.257

由于 schema.xml 文件中的以下条目，您会看到此行为

```
<dynamicField indexed="true" multiValued="true" name="*" stored="true" type="text_en"/> 
```

这是您在架构中定义的通用捕获所有字段。如果您将任何文档传递给与架构中其他字段不匹配的索引字段名称，无论是按照约定（通过您的其他 dynamicField 设置）还是特定字段名称，Solr 将“即时”创建该字段作为`text_en`可以具有的类型多个条目，因为它设置为`multiValued="true"`. 由于设置，这些字段也都被存储了`stored="true"`。我建议从您的 schema.xml 中删除此字段并重新索引您的数据。

有关此文件中设置的更多详细信息，请参考 - Solr Wiki 上的[SchemaXml 。](http://wiki.apache.org/solr/SchemaXml)

# iphone - 延迟 TableView 图像加载 Malloc 错误

> ID：12805556
> 
> 赞同：0
> 
> 时间：2012-10-09T17:48:26.670
> 
> 标签：iphone, objective-c

我试图将图像延迟加载到我的 tableview 中，但是当我尝试将一个特定图像插入到我的图像数组中时，我得到了一个双重免费 malloc 错误。

这是错误：“标志（8079,0xa0258540）malloc：*** 对象 0x6a51b40 的错误：double free ***在 malloc_error_break 中设置断点进行调试”。

这是我的代码：

```
#import "ViewController.h"
#import "ASync.h"

@implementation ViewController
@synthesize tableView;
@synthesize countryNamesArray;
@synthesize receivedData; 
@synthesize flagImage;
@synthesize flagImagesArray;
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle
-(void)issueRequest:(NSString *)fullCountryImageURL{

    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:fullCountryImageURL]
                                              cachePolicy:NSURLRequestUseProtocolCachePolicy
                                          timeoutInterval:60.0];
    // create the connection with the request
    // and start loading the data
    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (theConnection) {
        // Create the NSMutableData to hold the received data.
        // receivedData is an instance variable declared elsewhere.
        receivedData = [NSMutableData data];                                    
    } 
    else {
        // Inform the user that the connection failed.
    }
}

- (void)viewDidLoad
{   
    flagImagesArray = [[NSMutableArray alloc]init];
    for(int x=0; x<16; x++){
        [flagImagesArray insertObject:[UIImage imageNamed: @"jollyroger_poisonflag.jpg"] atIndex:x];

    }
    countryNamesArray=[[NSArray alloc] initWithObjects:@"India",@"USA",@"Antarctica",@"Brazil",@"Canada",@"China",@"France",@"Germany",@"Italy",@"Japan",@"Kenya",@"Malaysia",@"Mexico",@"South Africa",@"United Kingdom",@"Vietnam",nil];

    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
    } else {
        return YES;
    }
}

-(NSInteger)tableView:(UITableView *)tableview numberOfRowsInSection:(NSInteger)section{
    return 16;
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    // This method is called when the server has determined that it
    // has enough information to create the NSURLResponse.

    // It can be called multiple times, for example in the case of a
    // redirect, so each time we reset the data.

    // receivedData is an instance variable declared elsewhere.
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    // Append the new data to receivedData.
    // receivedData is an instance variable declared elsewhere.
    [receivedData appendData:data];
}
- (void)connection:(NSURLConnection *)connectiondidFailWithError:(NSError *)error
{
    // release the connection, and the data object
    // receivedData is declared as a method instance elsewhere

    // inform the user
    NSLog(@"Connection failed! Error - %@ %@",
          [error localizedDescription],
          [[error userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    // do something with the data
    // receivedData is declared as a method instance elsewhere
    NSLog(@"Succeeded! Received %d bytes of data",[receivedData length]);
    flagImage = [UIImage imageWithData: receivedData];
    if([receivedData length]==19935){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==0)
                [flagImagesArray replaceObjectAtIndex:0 withObject:flagImage];
        }
    }
    else if([receivedData length]==9280){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==1)
                [flagImagesArray replaceObjectAtIndex:1 withObject:flagImage];
        }
    }
    else if([receivedData length]==9567){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==2)
                [flagImagesArray replaceObjectAtIndex:2 withObject:flagImage];
        }
    }
    else if([receivedData length]==12152){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==3)
                [flagImagesArray replaceObjectAtIndex:3 withObject:flagImage];
        }
    }
    else if([receivedData length]==10903){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==4)
                [flagImagesArray replaceObjectAtIndex:4 withObject:flagImage];
        }
    }
    else if([receivedData length]==11298){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==5)
                [flagImagesArray replaceObjectAtIndex:5 withObject:flagImage];
        }
    }
    else if([receivedData length]==8682){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==6)
                [flagImagesArray replaceObjectAtIndex:6 withObject:flagImage];
        }
    }
    else if([receivedData length]==6865){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==7)
                [flagImagesArray replaceObjectAtIndex:7 withObject:flagImage];
        }
    }
    else if([receivedData length]==10567){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==8)
                [flagImagesArray replaceObjectAtIndex:8 withObject:flagImage];
        }
    }
    else if([receivedData length]==9423){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==9)
                [flagImagesArray replaceObjectAtIndex:9 withObject:flagImage];
        }
    }
    else if([receivedData length]==820){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==10)
                **[flagImagesArray replaceObjectAtIndex:10 withObject:flagImage];**
        }
    }
    else if([receivedData length]==12238){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==11)
                [flagImagesArray replaceObjectAtIndex:11 withObject:flagImage];
        }
    }
    else if([receivedData length]==5980){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==12)
                [flagImagesArray replaceObjectAtIndex:12 withObject:flagImage];
        }
    }
    else if([receivedData length]==10562){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==13)
                [flagImagesArray replaceObjectAtIndex:13 withObject:flagImage];
        }
    }
    else if([receivedData length]==9690){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==14)
                [flagImagesArray replaceObjectAtIndex:14 withObject:flagImage];
        }
    }
    else if([receivedData length]==11590){
        for (NSIndexPath *indexPath in [tableView indexPathsForVisibleRows]){
            if(indexPath.row==15)
                [flagImagesArray replaceObjectAtIndex:15 withObject:flagImage];
        }
    }

    [tableView reloadData];
}

-(UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *cellIdentifier = @"countryCell";
    static int numberOfRequests=0;
    UITableViewCell *cell=(UITableViewCell *) [self.tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell==nil){
        cell=[[UITableViewCell alloc] initWithStyle: UITableViewCellStyleSubtitle reuseIdentifier:cellIdentifier];
    }

    // Create the request.

    NSString *flagImageURLPartOne = @"http://www.imageslink/";
    NSString *countryNumber = [NSString stringWithFormat:@"%i", indexPath.row];
    NSString *flagImageURLPartTwo = @".png";
    NSString *fullCountryImageURL = [NSString stringWithFormat:@"%@%@%@", flagImageURLPartOne, countryNumber, flagImageURLPartTwo];
    [self issueRequest:fullCountryImageURL];
    numberOfRequests++;

    cell.imageView.image=[flagImagesArray objectAtIndex:indexPath.row];
    cell.textLabel.text= [countryNamesArray objectAtIndex:indexPath.row];

    return cell;
}

-(void) tableView:(UITableView *) tableview didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
}

@end 
```

引发错误的行以粗体显示 - 它位于代码行下方：“[flagImagesArray replaceObjectAtIndex:10 withObject:flagImage];”。当我将此行注释掉时，所有其他图像都可以正常加载。有人对问题所在有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:53:20.273

Only for completion's sake.

The problem is most probably with the image. The image might be corrupted. Using break points inside the 820 bracket will tell us where the error has occurred.

In cases like these. I always suggest doing a count on the data just to be sure about the data transferred from the server.

And John solved the problem. The problem was

> I had one link that was pulling in a "Page Not Found" rather than an image.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:00:27.140

转到断点选项卡，在左下角单击添加按钮并选择“添加异常断点”并单击完成。

再次运行您的代码，您将准确找到崩溃的时间和地点，以及所有调试信息

# windows-phone-7 - wp7中图像控件中的图像未从http url刷新

> ID：12805559
> 
> 赞同：0
> 
> 时间：2012-10-09T17:48:31.067
> 
> 标签：windows-phone-7

我有一个带有以下代码的应用程序

```
 url = "http://mywebsite/image.jpg";
    Uri uri = new Uri(url, UriKind.Absolute);
    image1.Source = new BitmapImage(uri); 
```

问题是图像在一次又一次加载后不刷新，它总是一样的。我怎样才能刷新它？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:00:28.880

这是因为 Windows Phone“Mango”中的图像控件的默认行为是缓存图像。

如果您添加这样的图像：

```
<Image Source="http://domain/image.png" /> 
```

它将具有如下默认行为：

```
<Image>
    <Image.Source>
        <BitmapImage CreateOptions="DelayCreation" UriSource="http://domain/image.png" />
    </Image.Source>
</Image> 
```

正如您在此处看到的，这是由[BitmapImage.CreateOptions](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.createoptions%28v=VS.95%29.aspx)属性控制的。

在您的情况下，您应该将默认行为更改为如下所示：

```
<Image>
    <Image.Source>
        <BitmapImage CreateOptions="DelayCreation,IgnoreImageCache" UriSource="http://domain/image.png" />
    </Image.Source>
</Image> 
```

# ruby - Gemfile - 将生产 gem 与开发 gem 分开

> ID：12805569
> 
> 赞同：4
> 
> 时间：2012-10-09T17:48:55.077
> 
> 标签：ruby, ruby-on-rails-3, bundler, gemfile

所以我知道在 Gemfile 中我可以做这样的事情：

```
group :development, :test do
  gem 'gem1'
  gem 'gem2'
end 
```

我想要完成的是这样的：

```
group :production do
  gem 'gem1'
  gem 'gem2'
end

group :development, :test do
  gem 'gem1', :path => '/Documents/Code/gem1/'
  gem 'gem2', :path => '/Documents/Code/gem2/'
end 
```

所以我们的应用程序使用了 2 个我们也在本地开发的 gem。为了缩短在本地机器上开发的时间，我们希望能够将我们的开发环境指向 gem 的本地副本——这样它就可以在不需要重新启动我们的 rails 服务器的情况下获取所有更改。否则，我们将不得不重建 gem，重新安装 gem，并在 gem 中的每次开发更改时重新启动 rails。

但是，这样做会给我以下错误：

```
You cannot specify the same gem twice coming from different sources. You specified that gem1 (>= 0) should come from an unspecfied source and source at /Documents/Code/gem1 
```

我什至尝试过运行类似的东西`bundle install --without production`，但我得到了同样的错误。

有谁知道是否可以做我想做的事？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T19:41:23.707

我认为有一种支持的方法可以做到这一点，并且有一些技巧可以解决它。

支持方式：

`bundle config`与此处所述的`local`选项一起使用：http: [//bundler.io/v1.3/man/bundle-config.1.html](http://bundler.io/v1.3/man/bundle-config.1.html)

哈克方式：

在生产中使用之前使用环境变量并执行捆绑程序：http: [//www.cowboycoded.com/2010/08/10/using-2-sources-for-a-gem-in-different-environments-with-bundler/](http://www.cowboycoded.com/2010/08/10/using-2-sources-for-a-gem-in-different-environments-with-bundler/)

在 github 上有一个针对此问题的功能请求，其中包含几个相关问题和大量评论：[https ://github.com/carlhuda/bundler/issues/396](https://github.com/carlhuda/bundler/issues/396)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-04T14:22:34.293

phoet 链接到的 github 问题已解决，并且与支持的方式一致。

我翻遍了文档，您需要设置配置变量并更新您的 gemfile 以引用分支。

例如

编辑您的 Gemfile：

```
gem <gem_name>, git: <git_url>, branch: <branch> 
```

在命令行上：

```
bundle config local.<gem_name> <local_path_to_gem> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-29T23:38:01.307

我通过创建一个新的 Gemfile 来解决这个问题，除了目标 gem 的源之外，它与原始文件相同。然后，在 config/boot.rb 中，我使用了：

`require 'rails' if Rails.env.development? ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../../DevGemfile', __FILE__) else ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../../ProdGemfile', __FILE__) end`

# pdf - 使用 iTextSharp 提取文本时如何跳过 PDF 的空白页？

> ID：12805570
> 
> 赞同：0
> 
> 时间：2012-10-09T17:48:57.043
> 
> 标签：pdf, full-text-search, itextsharp, itext, invalidoperationexception

我的程序通读 PDF 并提取文本。当它到达空白页时，我收到错误*"System.InvalidOperationException: Unable to handle Content of type iTextSharp.text.pdf.PdfDictionary"*，程序停止。

在尝试阅读之前如何检查页面是否为空白？如果我的程序确实遇到空白页，我该如何继续？

代码：

```
for (int i = 1; i <= reader.NumberOfPages; i++)
     output.WriteLine(PdfTextExtractor.GetTextFromPage(reader, i, new SimpleTextExtractionStrategy())); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T11:12:09.737

像这样的东西？

```
for (int i = 1; i <= reader.NumberOfPages; i++)
{
    string tmp = PdfTextExtractor.GetTextFromPage(reader, i, 
                     new SimpleTextExtractionStrategy());
    if(!string.IsNullOrEmpty(tmp))
        output.WriteLine(tmp);
} 
```

# c# - 在 EF Code First 中，Foo 可以拥有 Bars 的集合以及“FavouriteBar”吗？

> ID：12805572
> 
> 赞同：2
> 
> 时间：2012-10-09T17:49:04.573
> 
> 标签：c#, entity-framework, ef-code-first, entity-framework-5

为了说明我的问题，假设我有一个数据模型，其中有一组书籍，每本书都有一个或多个草稿，还有一个“当前”草稿。我希望我的模型看起来像这样：

```
class Book
{
    public int Id { get; set; }

    public string Title { get; set; }

    public virtual ICollection<Draft> Drafts { get; set; }

    public virtual Draft CurrentDraft { get; set; }
}

class Draft
{
    public int Id { get; set; }

    public virtual int BookId { get; set; }
    public virtual Book Book { get; set; }

    public string Description { get; set; }
} 
```

我有一个看起来像这样的 DbContext：

```
class TestDbContext : DbContext
{
    public DbSet<Book> Books { get; set; }
    public DbSet<Draft> Drafts { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();
        modelBuilder.Conventions.Remove<ManyToManyCascadeDeleteConvention>();

        base.OnModelCreating(modelBuilder);
    }
} 
```

...还有一个像这样的简单程序：

```
static void Main(string[] args)
{
    Database.SetInitializer<TestDbContext>(new DropCreateDatabaseAlways<TestDbContext>());

    using (var db = new TestDbContext())
    {
        var book = new Book() { Title = "War and Peace", Drafts = new List<Draft>() };

        var draft1 = new Draft() { Book = book, Description = "First Draft" };

        book.Drafts.Add(draft1);

        var draft2 = new Draft() { Book = book, Description = "Second Draft" };

        book.Drafts.Add(draft2);

        book.CurrentDraft = draft2;

        db.Books.Add(book);

        db.SaveChanges();

        foreach (var b in db.Books)
        {
            Console.WriteLine("Book {0}: {1}", b.Id, b.Title);

            foreach (var d in book.Drafts)
                Console.WriteLine("\tDraft ID {0}: {1} from Book ID {2}", d.Id, d.Description, d.BookId);

            Console.WriteLine("Current draft has ID {0}", b.CurrentDraft.Id);
        }

        Console.ReadKey();
    }
} 
```

当数据库由 EF 创建时，它看起来像这样：

![数据库模式](../Images/856d283929923fa140aa3feef232fa42.png)

[我对额外的 Book_Id 列并不感兴趣，但如果它有效，我可以接受它。]

可悲的是，当我运行测试程序时，它在调用时失败了`SaveChanges`，但有一个例外：

> 保存不为其关系公开外键属性的实体时发生错误。EntityEntries 属性将返回 null，因为无法将单个实体标识为异常源。通过在实体类型中公开外键属性，可以更轻松地在保存时处理异常。有关详细信息，请参阅 InnerException。

我尝试在 OnModelCreating 中使用流利的 API，但是当我尝试以这种方式配置它时，它会因为 Books 和 Drafts 之间有两个 FK 关系而感到困惑。我对流利的东西（或一般的EF）不够熟悉，不知道如何正确地做到这一点。

这甚至可能首先在 EF 代码中实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:59:44.357

如果我是你，我会在 Draft 中再添加一个属性`bool IsCurrent{get;set;}`。和

```
public Draft CurrentDraft { get{return Drafts.SingleOrDefault(c=>c.IsCurrent)} } 
```

在这种情况下，书籍和草稿之间将有一个外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:15:17.730

您的内部例外是 EF 无法确定将内容保存到数据库以正确创建内容的顺序。如果您在多个地方调用 save changes 来强制您的测试应用程序工作的顺序：

```
 var book = new Book() { Title = "War and Peace", Drafts = new List<Draft>() };
            db.Books.Add(book);
            db.SaveChanges();
            var draft1 = new Draft() { Book = book, Description = "First Draft" };
            book.Drafts.Add(draft1);
            var draft2 = new Draft() { Book = book, Description = "Second Draft" };
            book.Drafts.Add(draft2);
            book.CurrentDraft = draft2;
            db.SaveChanges(); 
```

关于第二个 book_id - 你可以使用这个流利的：

```
 modelBuilder.Entity<Book>()
            .HasMany(b => b.Drafts)
            .WithRequired(d => d.Book)
            .HasForeignKey(d => d.BookId);

        modelBuilder.Entity<Book>()
            .HasOptional(b => b.CurrentDraft)
            .WithOptionalDependent()
            .Map(m => m.MapKey("CurrentDraftId")); 
```

产生这个数据库：

![在此处输入图像描述](../Images/87d1bb6ede4af7e02a2277cd496dbaff.png)

# dictionary - 如何在方案中编写 reduce-per-key 函数？

> ID：12805577
> 
> 赞同：2
> 
> 时间：2012-10-09T17:49:18.420
> 
> 标签：dictionary, mapreduce, scheme, helper

“定义一个过程'reduce-per-key'，其中一个过程reducef和一个关联列表，其中每个键与一个列表配对。输出是一个相同结构的列表，除了每个键现在与结果相关联将 reducef 应用于其关联列表"

我已经写了 'map-per-key' 和 'group-by-key' ：

```
(define (map-per-key mapf lls)
  (cond
    [(null? lls) '()]
    [else (append (mapf (car lls))(map-per-key mapf (cdr lls)))])) 
```

* * *

```
(define (addval kv lls)
  (cond
    [(null? lls) (list (list (car kv)(cdr kv)))]
    [(eq? (caar lls) (car kv)) 
     (cons (list (car kv) (cons (cadr kv) (cadar lls)))(cdr lls))]
    [else (cons (car lls)(addval kv (cdr lls)))]))

(define (group-by-key lls)
  (cond
    [(null? lls) '()]
    [else (addval (car lls) (group-by-key (cdr lls)))])) 
```

我将如何编写下一步“reduce-per-key”？我也很难确定它是否需要两个或三个参数。

到目前为止，我想出了：

```
(define (reduce-per-key reducef lls)
  (let loop ((val (car lls))
             (lls (cdr lls)))
    (if (null? lls) val
        (loop (reducef val (car lls)) (cdr lls))))) 
```

但是，对于测试用例，例如：

```
(reduce-per-key
   (lambda (kv) (list (car kv) (length (cadr kv))))
   (group-by-key
     (map-per-key (lambda (kv) (list kv kv kv)) xs))) 
```

我收到不正确的参数计数，但是当我尝试使用三个参数编写它时，我也收到此错误。有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:42:25.090

您的解决方案*比*它需要的复杂得多，并且有几个错误。事实上，正确的答案很简单，不需要定义新的辅助程序。尝试研究这个解决方案的框架，只需填写空白：

```
(define (reduce-per-key reducef lls)
  (if (null? lls)        ; If the association list is empty, we're done
      <???>              ; and we can return the empty list.
      (cons (cons <???>  ; Otherwise, build a new association with the same key 
                  <???>) ; and the result of mapping `reducef` on the key's value
            (reduce-per-key <???> <???>)))) ; pass reducef, advance the recursion 
```

请记住，有一个用于将函数映射到列表的内置过程。像这样测试它：

```
(reduce-per-key (lambda (x) (* x x))
                '((x 1 2) (y 3) (z 4 5 6)))

> '((x 1 4) (y 9) (z 16 25 36)) 
```

请注意，每个关联都由一个键（`car`部分）和一个作为其值的列表（`cdr`部分）组成。例如：

```
(define an-association '(x 3 6 9))
(car an-association)
> 'x       ; the key
(cdr an-association)
> '(3 6 9) ; the value, it's a list 
```

作为最后的想法，这个名字`reduce-per-key`有点误导，`map-per-key`会更合适，因为这个过程可以很容易地用`map`... 来表达，但这留给读者作为练习。

**更新：**

既然您已经找到了解决方案，我可以建议使用更简洁的替代方案`map`：

```
(define (reduce-per-key reducef lls)
  (map (lambda (e) (cons (car e) (map reducef (cdr e))))
       lls)) 
```

# php - 用于“修复”电子邮件标题的正则表达式，使它们成为单行

> ID：12805580
> 
> 赞同：-2
> 
> 时间：2012-10-09T17:49:25.167
> 
> 标签：php, regex, preg-replace

> **可能重复：**
> [如何展开 RFC 822](https://stackoverflow.com/questions/4227783/how-to-do-unfolding-rfc-822)
> [Parsing e-mail-like headers（类似于 RFC822）](https://stackoverflow.com/questions/12804880/parsing-e-mail-like-headers-similar-to-rfc822)

我有一些类似于电子邮件数据的输入数据，因为长行被换行到下一行。例如：

```
robot-useragent: ABCdatos BotLink/1.0.2 (test links)
robot-language: basic
robot-description: This robot is used to verify availability of the ABCdatos
                   directory entries (http://www.abcdatos.com), checking
                   HTTP HEAD. Robot runs twice a week. Under HTTP 5xx
                   error responses or unable to connect, it repeats
                   verification some hours later, verifiying if that was a
                   temporary situation. 
```

该`robot-description`字段对于一行来说“太长”，并且被换行到下一行。为了帮助解析这些数据，我想提出一个正则表达式，可用于`preg_replace()`替换以下条件：

*   换行符后跟空格
*   **不**替换换行符后跟其他换行符

示例输出：

```
robot-description: This robot is used to verify availability of the ABCdatos directory entries (http://www.abcdatos.com), checking HTTP HEAD. Robot runs twice a week. Under HTTP 5xx error responses or unable to connect, it repeats verification some hours later, verifiying if that was a temporary situation. 
```

我是 RegEx 的新手。我怎样才能建立这样的表达？如果您选择回答，请在表达式中包含对组件的简要说明。我真的很想学习如何做这些。

我从这个开始： `\n([^\S])*` 它很接近。 [http://codepad.org/iMObpgFX](http://codepad.org/iMObpgFX)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:57:24.843

也许你可以尝试：

`(\r|\n)\s+`

```
(\r|\n) # matches both newline and carriage return 
\s+     # any whitespace (tabs, spaces, new lines) 
```

[试试看](http://regexr.com?32dhf)！

# php - 未正确执行权限

> ID：12805585
> 
> 赞同：2
> 
> 时间：2012-10-09T17:49:56.007
> 
> 标签：php

我不确定为什么这不起作用，但我想在下面的代码中说的是，如果用户未登录`if ((!isset($username)) && (!isset($userid))){`，则查看其他表单（如果他们已登录），然后显示消息说明他们必须注销查看页面。

问题是即使用户登录，它仍然显示表单而不是消息。

下面是代码：

```
 <?php
ini_set('display_errors',1); 
 error_reporting(E_ALL);
        session_start();

        include('member.php');

  $user = (isset($_POST['user'])) ? $_POST['user'] : '';
  $email = (isset($_POST['email'])) ? $_POST['email'] : '';

        if ((!isset($username)) && (!isset($userid))){

            echo "<form action='./forgotpass.php' method='post'>
            <table>
            <tr>
            <td></td>
            <td id='errormsg'>$errormsg</td>
            </tr>
            <tr>
            <td>Username</td>
            <td><input type='text' name='user' /></td>
            </tr>
            <tr>
            <td>Email</td>
            <td><input type='text' name='email' /></td>
            </tr>
            <tr>
            <td></td>
            <td><input type='submit' name='resetbtn' value='Reset Password' /></td>
            </tr>
            </table>
            </form>";

        }
        else
        {
        echo "Please Logout to view this Page.";    
        }
        ?> 
```

在上面的代码中，我包含了 member.php 页面，我不知道这是否有很大的不同，但 member.php 页面的代码如下：

```
<?php

if (isset($_SESSION['teacherforename'])) {

$_SESSION['teacherforename'] = $_SESSION['teacherforename'];

}

if (isset($_SESSION['teachersurname'])) {

$_SESSION['teachersurname'] = $_SESSION['teachersurname'];

}

if (isset($_SESSION['teacherid'])) {

      $userid = $_SESSION['teacherid'];

  }

if (isset($_SESSION['teacherusername'])) {

      $username = $_SESSION['teacherusername'];

  }

        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:58:57.793

检查它是否已设置并且它是否有任何值。

```
if ( (!isset($username) && empty($username)) && (!isset($userid) && empty($userid)) ){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:03:02.737

[检查这个你试过](http://codepad.org/NSqopNjq)

```
<?php    
$user = (isset($_POST['user'])) ? $_POST['user'] : '';
  $email = (isset($_POST['email'])) ? $_POST['email'] : '';

        if ((!isset($username)) && (!isset($userid))){
       echo 'empty set';
} 
```

以上将输出空集，这意味着 $user 和 $email 已设置

为了使它正确也使用`empty()`

正确一个

```
$user = (isset($_POST['user'])) ? $_POST['user'] : '';
  $email = (isset($_POST['email'])) ? $_POST['email'] : '';

        if ((!isset($username)) && !empty($username) &&  (!isset($userid) && !empty($email ))){
       echo 'empty set';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:56:03.490

```
$user = (isset($_POST['user'])) ? $_POST['user'] : NULL;
$email = (isset($_POST['email'])) ? $_POST['email'] : NULL; 
```

我相信将变量设置为 '' 将返回 true`isset()`

[伊塞特（）](http://www.php.net/manual/en/function.isset.php) `Returns TRUE if var exists and has value other than NULL, FALSE otherwise.`

# filter - ZF2：如何实现自定义过滤器？

> ID：12805592
> 
> 赞同：5
> 
> 时间：2012-10-09T17:50:16.090
> 
> 标签：filter, zend-framework2

几周以来，我一直在使用 Zend Framework 2，尽管在线文档非常不完整，但我还是设法建立了我的网站的初稿。

不幸的是，我在尝试实现 Zend\Filter\File\Rename 过滤器的自定义版本时遇到了困难；在这里我总结一下我所做的：

1）在我的名为“库”的模块中，创建了文件

src\Library\Filter\File\Rename.php

```
namespace Library\Filter\File;

use Traversable;
use Zend\Filter;
use Zend\Filter\Exception;
use Zend\Stdlib\ArrayUtils;

class Rename extends Filter\AbstractFilter {
    static $uploadDir = '/srv/default/htdocs/public/uploads/';

    public function filter($value) {
        do {
            $newname = md5(uniqid(time()));
        } while(file_exists(self::uploadDir . $newname);

        if (rename($value, self::uploadDir . $newname) !== true)
            throw new Exception\RuntimeException(sprintf("File '%s' could not be renamed. An error occurred while processing the file.", $value));

        return self::uploadDir . $newname;
    }
} 
```

如您所见，非常简单。这是模块配置：

模块.config.php

```
<?php
    return array(
        'controllers' => array(
            // Invokables don't support dependencies
            'invokables'    => array(
                'myFileRename'    => 'Library\Filter\File\Rename',
            ),
    )); 
```

虽然形式是：

```
[...]
    public function getInputFilterSpecification() {
        return array(
            'file' => array(
                'required'  => false,
                'filters'   => array(
                    // Custom Renamer
                    array('name' => 'myFileRename'),
                ),
            )
        );
    }
 }

?> 
```

但这不起作用，因为我总是遇到异常：

```
Fatal error:  Uncaught exception 'Zend\ServiceManager\Exception\ServiceNotFoundException' with message 'Zend\ServiceManager\ServiceManager::get was unable to fetch or create an instance for myFileRename' in /srv/default/vendor/ZF2/library/Zend/ServiceManager/ServiceManager.php:420
Stack trace:
#0 /srv/default/vendor/ZF2/library/Zend/ServiceManager/AbstractPluginManager.php(108): Zend\ServiceManager\ServiceManager->get('myfilerename', true)
#1 /srv/default/vendor/ZF2/library/Zend/Filter/FilterChain.php(179): Zend\ServiceManager\AbstractPluginManager->get('myfilerename', NULL)
#2 /srv/default/vendor/ZF2/library/Zend/InputFilter/Factory.php(263): Zend\Filter\FilterChain->attachByName('myfilerename', Array)
#3 /srv/default/vendor/ZF2/library/Zend/InputFilter/Factory.php(171): Zend\InputFilter\Factory->populateFilters(Object(Zend\Filter\FilterChain), Array)
#4 /srv/default/vendor/ZF2/library/Zend/InputFilter/Factory.php(237): Zend\InputFilter\Factory->createInput(Array)
#5 /srv/default/vendor/ZF2/library/Zend/Form/Form.php(672) in /srv/default/vendor/ZF2/library/Zend/ServiceManager/ServiceManager.php on line 420 
```

不幸的是，我在整个互联网上找不到任何文章可以帮助我解决这个问题，即使将我的过滤器别名为工厂，我仍然会收到此错误：/ 我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T13:21:04.387

您加载过滤器，就好像它是一个控制器（因此，`controller`您的模块配置中的键）。过滤器有一个插件管理器，但对于这个过滤器，您不需要插件管理器。过滤器插件管理器中也没有与 MVC 配置的链接。

最简单的方法是自己实例化过滤器。它应该是这样的：

```
use Library\Filter\File\Rename as RenameFilter;

public function getInputFilterSpecification()
{
    return array(
        'file' => array(
            'required'  => false,
            'filters'   => array(
                new RenameFilter,
            ),
        )
    );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-31T10:13:58.977

只需使用：

```
'name' => 'file',
'required' => false, 
'filters' => array(
     array('name' => 'Library\Filter\File\Rename'),
), 
```

有同样的问题...这是我的解决方案...

# windows - 具有可扩展行的 Infragistics UltraGrid

> ID：12805595
> 
> 赞同：2
> 
> 时间：2012-10-09T17:50:25.280
> 
> 标签：windows, winforms, infragistics, expand, ultrawingrid

我正在向我的用户展示 UltraGrid 中来自数据库的项目列表。现在，我有一个需求，我找不到任何有用的东西或任何清晰的文档，也没有可以学习的教程。

我需要扩展这个网格的功能，设置一个（+）扩展功能，当用户按下该按钮（+）时，该行会扩展并显示历史记录中的项目。

世界上任何人都可以帮助我解决这个问题或指出我可以学习的适当文档吗？

很感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T21:32:23.067

诀窍很简单。您只需要将网格绑定到包含两个（或更多）表和将表粘合在一起的正确 DataRelation 对象的 DataSet。
您还需要确保属性**grid.DisplayLayout.ViewStyle**设置为**MultiBand**（它是默认设置，因此应该已经设置）。

因此，例如，在这个伪代码中，我加载了两个表并将它们添加到数据集，然后定义所涉及的列之间的假定关系，最后将数据集绑定到网格。

```
DataSet ds = new DataSet();
DataTable dtItems = YourLoadDataTableMethodHere("Items");
ds.Tables.Add(dtItems);
DataTable dtHistory = YourLoadDataTableMethodHere("History");
ds.Tables.Add(dtHistory);
DataRelation rel = new DataRelation("Items_History_Relation",
                        dtItems.Columns["IDItem"],
                        dtHistory.Columns["IDItem"]);
ds.Relations.Add(rel);
grid.DataSource = ds; 
```

这将自动强制 UltraGrid 创建两个 Bands (grid.DisplayLayout.Bands[])，在第一个 Band (Band[0]) 中，您将找到 Items 数据表的行，每行都有其 [+] 按钮可单击并展开第二个波段 (Band[1])，您将在其中看到与第一个波段中的行相关的历史记录行

# sql - 跨多个用户的本地数据库的连接字符串

> ID：12805597
> 
> 赞同：2
> 
> 时间：2012-10-09T17:50:57.107
> 
> 标签：sql, database, vb.net

如何在本地数据库上使用连接字符串，以允许您将项目文件夹从一台计算机传输到另一台计算机，而无需修改连接字符串？

**不像这样**

```
connection_String As String = "Data Source=C:\Users\Kyle\Desktop\CSCI_388_Group_Project\CSCI_388_Group_Project\CSCI_388_Group_Project\CSCI_388_Group_Project_Database.sdf" 
```

**更像这样**

```
connection_String As String = "Data Source=|DataDirectory|\CSCI_388_Group_Project_Database.sdf" 
```

如果我尝试将第二个示例输入到数据库属性下的连接字段中，则会收到非法字符错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:57:10.977

[Environment](http://msdn.microsoft.com/en-us/library/system.environment.aspx)类包含您需要的大部分路径。

你可以打电话[`Environment.GetFolderPath`](http://msdn.microsoft.com/en-us/library/14tx8hby.aspx)来获取一个特殊的目录。例如，要获取*My Documents*目录，请调用`Environment.GetFolderPath(Environment.SpecialFolder.Personal)`.

您可以在此处浏览所有特殊文件夹：http:
[//msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

具体而言，在您的示例中，您将使用以下内容：

```
connection_String As String = _
    "Data Source=" & 
    Path.Combine(
        Environment.GetFolderPath(Environment.SpecialFolder.Desktop),
        "CSCI_388_Group_Project_Database.sdf" ) 
```

*替代方案：*
是否可以只询问用户？如果它在他们的桌面上，他们可能会移动它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:10:13.367

如果您决定将`sdf`文件保存在您将驻留的同一文件夹中`exe`，那么您可以这样做。

```
Dim ExeFolder As String = AppDomain.CurrentDomain.BaseDirectory
Dim connection_String As String = "Data Source=" & ExeFolder & "CSCI_388_Group_Project_Database.sdf" 
```

希望能帮助到你 ！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:59:32.030

一种简单的方法是使用环境变量来指定文件夹的路径。

然后在您的 VB 程序中使用[Environ 函数](http://msdn.microsoft.com/en-us/library/0fx287h4%28v=vs.80%29.aspx)获取环境变量设置并使用字符串操作来构建您的连接字符串。

如果未设置环境变量，您将需要有一个默认值。

但是，当您启动应用程序时，您可以在设置环境变量的脚本中执行此操作。

第二种方法是在应用程序命令行上指定路径名，这样当应用程序启动时，它将使用命令行指定路径。

第三种方法是拥有一个您使用的 Windows 注册表项。然后，与环境变量类似，您在 Windows 注册表中查询文件夹路径，然后从中构建您的连接字符串。

使用第三种方法，您可以让应用程序安装程序插入注册表项。

第四种方法是使用包含文件夹路径条目的 .ini 文件。

# android - android-创建数据库时出错

> ID：12805598
> 
> 赞同：0
> 
> 时间：2012-10-09T17:51:00.023
> 
> 标签：android, android-sqlite

下面是我正在使用的代码..以及它显示的错误..我已经浏览了每一行代码，但我无法弄清楚..请帮助我..

```
public class CenterCollectionDatabase extends Activity {

public static final String KEY_ID = "id";
public static final String KEY_ROUNDID = "round";
public static final String KEY_PLAYERID = "playerid";
public static final String KEY_MAAL = "maal";
public static final String KEY_POINT = "point";
public static final String KEY_WON = "won";
private static final String DATABASE_NAME ="center_collection";
private static final String DATABASE_TABLE= "transaction";
private static final int DATABASE_VERSION = 1;
private DbHelper ourHelper;
private final Context ourContext;
private SQLiteDatabase ourDatabase;

private static class DbHelper extends SQLiteOpenHelper{

    public DbHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub

        db.execSQL("CREATE TABLE " + DATABASE_TABLE +" ("+
                KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "+
                KEY_ROUNDID + " INTEGER, "+
                KEY_PLAYERID + " INTEGER, "+
                KEY_POINT + " INTEGER, "+
                KEY_MAAL + " INTEGER, "+
                KEY_WON+ " INTEGER );"          
            );
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        onCreate(db);
    }

}

public CenterCollectionDatabase(Context c)
{
    ourContext = c;
}

public CenterCollectionDatabase open() throws SQLException{
    ourHelper = new DbHelper(ourContext);
    ourDatabase = ourHelper.getWritableDatabase();
    return this;

}
public void close()
{
    ourHelper.close();
}

public long add_score(int round, int playerid, int point, int maal, int won) {

    ContentValues cv = new ContentValues();
    cv.put(KEY_ROUNDID, round);
    cv.put(KEY_PLAYERID, playerid);
    cv.put(KEY_POINT, point);
    cv.put(KEY_MAAL, maal);
    cv.put(KEY_WON, won);

    return ourDatabase.insert(DATABASE_TABLE, null, cv);
}
   } 
```

下面是用于在数据库中保存数据的代码

```
if(counter>0)
            {
                Toast.makeText(getApplicationContext(), "Oops Mike! please fill all fields", Toast.LENGTH_SHORT).show();
            }else{

                CenterCollectionDatabase db = new CenterCollectionDatabase(ScoreEntry.this);
                db.open();

                for(int i=0; i<number_of_player; i++)
                {
                    int round = 1;
                    int playerid = i;
                    int point = Integer.parseInt(Spoint[i]);
                    int maal = Integer.parseInt(Smaal[i]);
                    int won_who = 0;

                    db.add_score(round, playerid, point, maal, won_who);

                }
                db.close();

                Toast.makeText(getApplicationContext(), "Record Sucessfully Saved", Toast.LENGTH_SHORT).show();

                Intent intent = new Intent(ScoreEntry.this, ScoreBoard.class);
                startActivity(intent);

            } 
```

下面是错误

```
10-09 23:25:52.342: E/AndroidRuntime(584): FATAL EXCEPTION: main
10-09 23:25:52.342: E/AndroidRuntime(584): android.database.sqlite.SQLiteException: near "transaction": syntax error: CREATE TABLE transaction (id INTEGER PRIMARY KEY AUTOINCREMENT, round INTEGER, playerid INTEGER, point INTEGER, maal INTEGER, won INTEGER );
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.database.sqlite.SQLiteDatabase.native_execSQL(Native Method)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1727)
10-09 23:25:52.342: E/AndroidRuntime(584):  at com.vivek.marriage_center_collection.CenterCollectionDatabase$DbHelper.onCreate(CenterCollectionDatabase.java:41)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:106)
10-09 23:25:52.342: E/AndroidRuntime(584):  at com.vivek.marriage_center_collection.CenterCollectionDatabase.open(CenterCollectionDatabase.java:68)
10-09 23:25:52.342: E/AndroidRuntime(584):  at com.vivek.marriage_center_collection.ScoreEntry$1.onClick(ScoreEntry.java:133)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.view.View.performClick(View.java:2408)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.view.View$PerformClick.run(View.java:8816)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.os.Handler.handleCallback(Handler.java:587)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.os.Handler.dispatchMessage(Handler.java:92)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.os.Looper.loop(Looper.java:123)
10-09 23:25:52.342: E/AndroidRuntime(584):  at android.app.ActivityThread.main(ActivityThread.java:4627)
10-09 23:25:52.342: E/AndroidRuntime(584):  at java.lang.reflect.Method.invokeNative(Native Method)
10-09 23:25:52.342: E/AndroidRuntime(584):  at java.lang.reflect.Method.invoke(Method.java:521)
10-09 23:25:52.342: E/AndroidRuntime(584):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
10-09 23:25:52.342: E/AndroidRuntime(584):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
10-09 23:25:52.342: E/AndroidRuntime(584):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:03:57.027

我认为问题是你的桌子的名字。那是sqlite中的关键字，因此不能将其用作表名。

来自链接：“...... SQL 标准指定了大量的关键字，这些关键字可能不能用作表的名称......”

[SQLite 文档](http://www.sqlite.org/lang_keywords.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:55:04.003

不确定这是不是它

```
public static final String KEY_ID = "id"; 
```

应该

```
public static final String KEY_ID = "_id"; 
```

在 sqlite 世界中。

# java - 从文本文件中计算 * 的数量

> ID：12805601
> 
> 赞同：0
> 
> 时间：2012-10-09T17:51:09.120
> 
> 标签：java, count

我有这个代码来计算输入字符串中 * 的数量。但我需要从文本文件中找到它。任何的想法？

```
import java.lang.String;
import java.io.*;
import java.util.*;

public class CountStars {

  public static void main(String args[]) throws IOException {
      BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
      System.out.println("Enter the String:");
      String text = bf.readLine();

      int count = 0;
      for (int i = 0; i < text.length(); i++) {
          char c = text.charAt(i);
          if (c=='*' ) {
              count++;
          }
      }
      System.out.println("The number of stars in the given sentence are " + count);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:54:59.320

一起使用 a`FileInputStream`和 a `InputStreamReader`，同时指定[character-encoding](/questions/tagged/character-encoding "显示标记为“字符编码”的问题")。`"UTF-8"`是一个相当安全的赌注。然后阅读每一行并`'*'`像你已经做的那样计算字符数。然后创建一个总计，之后不要忘记关闭文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:54:30.177

用下面的行替换 BufferedReader 行。

```
Path path = Paths.get(aFileName);
BufferedReader bf = Files.newBufferedReader(path, ENCODING) 
```

其中 aFileName 是文件路径，您可以使用 args 或创建一个函数。

更新1：感谢owlstead。如果版本 < 7，请使用以下行。

```
BufferedReader bf = new BufferedReader (new FileReader (aFileName)); 
```

问候， 塔穆尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:15:32.063

我们可以写一些简单的东西，如下所示：

```
 int count= 0;
            FileReader fr = new FileReader("test.txt");
            BufferedReader br = new BufferedReader(fr); 
            String text; 
            while((text= br.readLine()) != null) { 
                   for (int i = 0; i < text.length(); i++) {
                      char c = text.charAt(i);
                      if (c=='*' ) {
                           count++;
                      }
                   }                
                } 

                System.out.println("Count Stars = "+ count); 
```

# java - 为什么我们需要一个数据库驱动程序？

> ID：12805607
> 
> 赞同：2
> 
> 时间：2012-10-09T17:51:52.563
> 
> 标签：java, database, jdbc

谁提供这个数据库驱动程序？如果我使用的是 oracle 数据库，oracle 是否提供此驱动程序。为什么我们需要一个数据库驱动管理器，谁来提供这个？你能为Java环境解释一下吗？编辑：我在中间使用了一个休眠层，它使我的代码独立于我正在使用的数据库，那么在这种情况下数据库驱动程序会做什么？它会拦截来自休眠的调用并转换成 oracle 可以理解的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:52:38.963

是的，每个数据库供应商都提供自己的数据库驱动程序。

为什么？

因为数据库也是一个软件，你的程序应该有一种与数据库通信的方式。

# java - Java 库，具有解析来自不同主要电子邮件客户端的转发电子邮件的解决方案

> ID：12805611
> 
> 赞同：1
> 
> 时间：2012-10-09T17:52:00.850
> 
> 标签：java, parsing, email, forward

我正在寻找一个 java 库，它具有解析来自不同主要电子邮件客户端的转发电子邮件的解决方案。有人可以指点我找到一个的方向，或者有人可以与我分享一个例子吗？

# iphone - 限制 UITableView 的滚动

> ID：12805615
> 
> 赞同：5
> 
> 时间：2012-10-09T17:52:23.360
> 
> 标签：iphone, objective-c, ios, xcode, interface-builder

我有一个 TableViewController：

![在此处输入图像描述](../Images/21561301d5f1967bbae9cb4c61236e13.png)

如您所见，我在顶部有自己的自定义栏。UITable View 只是`static`一个，我在 UITableView 的顶部添加了一个视图。

问题是当我将 TableView 滚动到顶部时，它变得像下面的图像，我不想要它。有什么简单的代码可以限制tableView的滚动吗？

![在此处输入图像描述](../Images/1f638b120d8d63f201603ab967e4be48.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-09T18:42:03.937

由于 UITableView 是 UIScrollView 的子类，因此您可以使用此 UIScrollViewDelegate 方法来禁止在顶部边框上方滚动

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    if (scrollView == self.tableView) {
        if (scrollView.contentOffset.y < 0) {
            scrollView.contentOffset = CGPointZero;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T18:38:41.853

你需要将uitableview的bounce属性设置为NO

```
 UITableView  *tableView;
    tableView.bounces = NO; 
```

编辑：请注意，您也可以取消选中界面生成器的反弹

请查看此答案以获取更多详细信息[滚动时禁用 UITableView 垂直反弹](https://stackoverflow.com/questions/2768673/disable-uitableview-vertical-bounces-when-scrolling)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-06T13:15:01.033

我遇到了同样的问题，问我们的 UX 设计师，怎么做会更好。他说，两种严格的解决方案（防止弹跳或允许弹跳）都是不好的。最好允许弹跳，但仅限于一些空间

我的解决方案是：

```
override func scrollViewDidScroll(_ scrollView: UIScrollView) {
    if scrollView == self.tableView {
        if scrollView.contentOffset.y < -64 {
            scrollView.scrollRectToVisible(CGRect(origin: CGPoint(x: 0, y: -64), size: scrollView.frame.size), animated: false)
            scrollView.scrollRectToVisible(CGRect(origin: CGPoint.zero, size: scrollView.frame.size), animated: true)
        }
    }
} 
```

`64`对我来说，那个“空间”在哪里。代码从顶部停止 tableView`-64`并用动画显示它。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T18:08:44.087

如果我理解正确，您已将自定义栏设置为表格视图的一部分。设置视图时，将您`custom bar`的视图放在单独的视图中，而不是在表格视图中，并将您的表格视图放在自定义栏下方。您需要创建自定义视图控制器，该控制器将具有您的自定义栏和静态表格视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T18:15:52.903

您需要将视图控制器对象创建为 type`UIViewController`而不是`UITableViewController`. 然后将自定义栏作为子视图添加到`self.view`. 创建一个单独的`UITableView`并将其添加到自定义栏下方。这应该使自定义栏静态和表格视图可滚动。

**更新：**

为了使表格视图静态，您需要将其设置为

```
tableView.scrollEnabled = NO: 
```

让我知道这是否适合您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-24T16:13:56.750

Mattias 回答的 Swift 版本：

```
func scrollViewDidScroll(_ scrollView: UIScrollView) {
        if (scrollView == self.ordersTable) {
            if (scrollView.contentOffset.y < 0) {
                scrollView.contentOffset = CGPoint.zero;
            }
        }
    } 
```

# regex - htaccess 查询字符串

> ID：12805617
> 
> 赞同：1
> 
> 时间：2012-10-09T17:52:33.860
> 
> 标签：regex, apache, .htaccess, mod-rewrite

搜索引擎使用参数抓取网站

```
/?p=([0-9]+)
/?cat=([0-9]+)
/?do=([a-z]+) 
```

ETC

如何在 .htaccess 中通知搜索引擎此类页面不再存在？

我只有 /?page=([0-9]+)

谢谢。

我试过

```
RewriteCond %{QUERY_STRING} ^(p|cat|do)(.*)$
RewriteRule ^$ http://test.com/simple [R=301,L] 
```

但

```
http://test.com/?p=23 give me http://test.com/test?p=23 (not http://test.com/test)
http://test.com/?cat=11 give me http://test.com/test?cat=11 (not http://test.com/test) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T10:44:05.957

我建议您遵循 301（永久重定向）规则：

```
RewriteCond %{QUERY_STRING} !^page=.*$ [NC]
RewriteRule ^$ http://test.com/test? [R=301,L] 
```

这会将每个`/?p=([0-9]+)`or `/?do=([0-9]+)`or `/?foo=([0-9]+)`or `/?bar=([0-9]+)`etc（除 之外的任何查询字符串`/?page=`）重定向到原始查询字符串`http://test.com/test`并`R=301`删除原始查询字符串（注意`?`在目标 URL 的末尾）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:56:25.420

您可以将这些页面添加到您的[robots.txt](http://www.robotstxt.org)文件中以防止索引。

但是，搜索引擎会在某个地方*找到*这些链接。你应该确保你没有在你的网站上使用它们。

如果页面*不再存在*，您可能会考虑相应地[重定向](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#redirect)（301）它们。

后者或其中的某种组合应该可以解决您的问题。

# knockout.js - 在视图模型中从淘汰赛的 applyBindings() 调用中获取关联的 dom 元素

> ID：12805629
> 
> 赞同：1
> 
> 时间：2012-10-09T17:53:27.237
> 
> 标签：knockout.js

我有一个视图模型，它有各种可以通过 ajax 工作的方法。我想使用这个库[spin.js](http://fgnass.github.com/spin.js/)在调用 ko.applyBindings() 期间应用视图模型的同一元素上显示微调器。我没有看到任何允许在我的视图模型中检索 dom 元素的 Knockout.js 方法，我想知道是否有办法获得它。我确信这以某种方式跨越或跨越了 MVVM 的纯度，所以如果有其他方法可以做到这一点，请告诉我。

我可以将 dom 元素作为参数传递给我的视图模型，但是我现在想要使用的每个视图模型都必须跟踪该元素，这是多余的，因为 Knockout 已经在跟踪它。

// 启动脚本

```
var _paymentMethodViewModel;
$(function () {
   _paymentMethodViewModel = new ViewModels.PaymentMethodViewModel("/Customer");
   ko.applyBindings(_paymentMethodViewModel, $("#PaymentMethodsList").get(0));
   // spinner should show up over the PaymentMethodsList dom element when this is called and when the ajax call is complete it should disappear
   _paymentMethodViewModel.getAllPaymentMethods();
}); 
```

// 视图模型

```
self.getAllPaymentMethods = function () {
    // ******************
    // start spinner here
    // ******************
    var spinner = new Spinner(_spinnerOpts).spin(/* <need dom element here> */);

    $.ajax({
        url: self.rootUrl + "/GetAllPaymentMethods",
        type: "POST",
        data: {},
        context: self,
        success: function (result, textStatus, jqXHR) {
        },
        error: function (jqXHR, textStatus, errorThrown) {
        },
        complete: function (jqXHR, textStatus) {
            // ******************
            // stop spinner here
            // ******************
            spinner.stop();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T21:09:09.010

Ok, I came up with a custom binding handler solution that I'm happy with.

[http://jsfiddle.net/StrandedPirate/UbFZT/](http://jsfiddle.net/StrandedPirate/UbFZT/)

# ruby-on-rails - Ruby on Rails 初始控制器设置

> ID：12805632
> 
> 赞同：0
> 
> 时间：2012-10-09T17:53:32.347
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller

我开始使用 Ruby on Rails 并且有一些问题。我目前有一个用 Perl/HTML/Javascript 等编写的网站。我的目标是将这个网站转换为使用 Rails。我遇到了如何开始的绊脚石。

以下是当前网站的总体概述： 主页有 3 个选择列表，在页面加载时填充（通过 SQL）。用户可以从这些列表之一中选择一个选项（比如一个日期作为列表之一存储日期）。目前，使用 AJAX，这会调用 Perl CGI 脚本，该脚本使用所选日期查询数据库并返回包含适当记录的表（填写选择列表旁边的分区）。网站上没有其他页面（除了变更日志），因为一切都发生在主页上。由于 AJAX，选择列表不会在每次选择后刷新。

我的问题是，我是否有一个名为 Selection 的控制器来填充列表，另一个名为 Output 来创建记录表？这样的设置有意义吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:17:00.320

这是我对您的要求的理解。

1）您有一个页面，其中有三个选择框

2）如果用户更改了任何一个选择框，那么您正在将数据发布到后端以根据选择获取输出（使用 Perl CGI 脚本）

在您从后端获得响应后加载输出。

如果我的理解是正确的，以下是我的建议。

**建议 ：**

你不需要为每个动作设置不同的控制器，在 Rails 中你可以在一个控制器中有多个动作。

假设您可以如下命名您的控制器和操作

`Selection Controller`（下面可以有多个动作，您可以在控制器中为每个动作定义自定义名称并在`app/config/routes.rb`文件中添加路由信息）

```
 - GenerateList
 - CustomAction1
 - CustomAction etc., 
```

编辑 ：

您不应该对网站中的所有操作使用单个控制器，您需要对功能进行分类并相应地创建多个控制器/操作。

如果您在创建和运行自定义操作时遇到任何困难，请告诉我。

# c++ - 添加 xml-stylesheet 处理指令以提升 property_tree

> ID：12805633
> 
> 赞同：3
> 
> 时间：2012-10-09T17:53:36.027
> 
> 标签：c++, xml, boost-propertytree

我正在使用 boost/property_tree 创建一个 XML 文件。不幸的是，我无法弄清楚如何将 xml-stylesheet 处理指令添加到文件中。

理想的输出：

```
<?xml version="1.0" encoding="utf-8"?> <-- This is added automatically
<?xml-stylesheet type="text/xsl" href="report.xsl"?> <-- How to add this line
<report>
...
</report> 
```

boost/property_tree/ptree 有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:20:59.700

boost/property_tree xml writer 似乎不支持 xml 样式表处理指令。第一行（xml 版本）只是在 write_xml_internal 函数中硬编码。

所以我刚刚编写了自己的 write xml 函数，它的作用完全一样，还添加了 xml 样式表。

```
void WriteXML(std::ostream &output, ptree &root)
{
 boost::property_tree::xml_writer_settings<char> settings('\t', 1);

 output << "<?xml version=\"1.0\" encoding=\"";
 output << settings.encoding;
 output << "\"?>\n";
 output << "<?xml-stylesheet type=\"text/xsl\" href=\"report.xsl\"?>\n";

 write_xml_element(output, std::basic_string<ptree::key_type::value_type>(), root, -1, settings);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-18T09:05:32.220

我的技巧是使用编写器设置：

```
boost::property_tree::xml_writer_settings<char> settings('\t', 1, "utf-8\"?>\n<?xml-stylesheet type=\"text/xsl\" href=\"report.xsl");
boost::property_tree::write_xml(yourAbsolutePath, yourPropertyTree, std::locale(), settings); 
```

结果：

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="report.xsl"?> 
```

# javascript - 从地图外部调用 FusionTable 标记图标

> ID：12805636
> 
> 赞同：1
> 
> 时间：2012-10-09T17:53:52.393
> 
> 标签：javascript, google-fusion-tables

我有一个 FusionTable，它显示三种不同类型的位置（小学、初中和高中），每个位置都有不同的标记。我已经成功创建了一个显示所有 3 个的地图，并允许用户通过以下方式打开和关闭它们：

```
<input type="checkbox" value="2" onclick="changeMap(this.value)" checked="checked" />Elementary Schools 
```

有没有一种方法可以让我使用的标记显示在复选框旁边但在它标记的东西的名称之前？即它会显示 [ ] small_red Elementary Schools（small_red 是地图上实际的小红点）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:14:45.877

我能找到的最简单的方法是从这个线程： [https ://groups.google.com/forum/?fromgroups=#!topic/fusion-tables-users-group/Zwoq9xivyXs](https://groups.google.com/forum/?fromgroups=#!topic/fusion-tables-users-group/Zwoq9xivyXs)

请参阅 Nick S. 的回复。刚刚做了一个标准的html IMG。如果有另一种方法可以做到这一点，仍然会感兴趣。

# c - C访问内存位置

> ID：12805641
> 
> 赞同：2
> 
> 时间：2012-10-09T17:54:00.613
> 
> 标签：c, memory

我的意思是物理内存，RAM。

在 C 语言中，您可以访问任何内存地址，那么操作系统如何防止您的程序更改不在程序内存空间中的内存地址？

它是否将特定的内存地址设置为每个程序的开始和结束，如果是，它如何知道需要多少。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:56:00.807

您的操作系统内核与内存管理 (MMU) 硬件密切合作，当硬件和操作系统都支持这一点时，您将无法访问您被禁止访问的内存。

一般来说，这也意味着您访问的地址不是物理地址，而是虚拟地址，硬件执行适当的转换以执行访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:58:08.480

这就是所谓的内存保护。它可以使用不同的方法来实现。我建议您从有关此主题的 Wikipedia 文章开始 — [http://en.wikipedia.org/wiki/Memory_protection](http://en.wikipedia.org/wiki/Memory_protection)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T17:55:42.427

实际上，您的程序被分配了**虚拟内存**，这就是您使用的。操作系统为您提供了一部分 RAM，您无法访问其他进程的内存（除非它是共享内存，请查找它）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T17:55:58.293

这取决于架构，在某些情况下甚至无法防止程序崩溃系统，但通常平台提供了一些保护内存和分离不同进程的地址空间的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T19:29:34.510

大多数计算机（以及自 386 以来的所有 PC）都有称为内存管理单元（或 MMU）的东西。它的工作是将程序使用的本地地址*转换*为从实际内存中获取实际字节所需的物理地址。对 MMU 进行编程是操作系统的工作。

因此，程序可以加载到内存的任何区域，并且在执行时从该程序的角度来看，可以是任何其他地址。通常会发现所有程序的代码（本地）出现在同一个地址，并且它们的数据总是（本地）出现在同一个地址，即使它们在物理上位于不同的位置。每次访问内存时，MMU 都会透明地从本地地址空间转换为物理地址空间。

如果程序试图访问尚未映射到其本地地址空间的内存地址，硬件会产生异常并通常被标记为“分段违规”，然后强制终止程序。这可以防止访问其他进程的内存。

但事实并非如此！在具有“虚拟内存”且当前对 RAM 的资源需求超过物理内存量的系统上，一些页面（只是普通大小的内存块，通常在 4-8kB 的数量级）可以写出到磁盘并给出作为试图分配和使用新内存的程序的 RAM。稍后，当拥有该页面的任何程序需要该页面时，内存访问会导致异常，并且操作系统会换出其他一些内存页面并从磁盘重新加载所需的页面。发生这种情况时，“页面错误”的程序会延迟，否则什么也不会注意到。

MMU/OS 还可以做很多其他的技巧，比如在进程之间共享内存，使磁盘文件看起来是可直接访问内存的，将某些页面设置为“NX”，因此它们不能被视为可执行文件代码，使用逻辑内存空间的任意部分，无论物理内存使用多少以及在哪个地址，等等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-09T18:34:36.440

逻辑地址由 CPU 生成，由内存映射单元映射到物理地址。与物理地址空间不同，逻辑地址不受内存大小的限制，您只需使用逻辑地址空间即可。地址绑定由 MMU 完成。所以你永远不会直接处理物理地址。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-09T17:56:42.723

操作系统执行“内存管理”，通常与 TLB（Translation Lookaside Buffers）和虚拟内存相结合，将任何地址转换为*页面*，操作系统可以在当前进程上下文中标记可读或可执行。

在当前上下文中，对处理器 MMU 或内存管理单元的最低要求是将可访问内存限制在只能在超级用户模式下（与用户模式相反）在处理器寄存器中设置 *的*范围*内*。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-09T17:56:48.287

这与 CPU 本身提供的称为“分页”的东西有关。在旧操作系统中，您有“实模式”，您可以在其中直接访问内存地址。相比之下，分页为您提供“虚拟内存”，因此您不会访问原始内存本身，而是访问您的程序看起来是整个内存映射的东西。

# android - 清晰的图标清晰的Android应用程序

> ID：12805643
> 
> 赞同：2
> 
> 时间：2012-10-09T17:54:05.060
> 
> 标签：android, android-layout

嗨下午好关于如何提高我的图标的 png 质量的任何想法？我使用了来自 android 开发者页面的工具包，但我无法获得清晰的图像，我的意思是水晶般清晰，我是否需要以不同的方式加载此图标，而不仅仅是拖入我的布局？谢谢

我使用这个布局：

```
 <!-- Rightend Arrow -->
<ImageView android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/arrow"
    android:layout_alignParentRight="true"
    android:layout_centerVertical="true"/>
</RelativeLayout> 
```

例如，您可以在 eclipse sharp 中看到右箭头图标，但在模拟器和设备中看起来很模糊：

![您可以看到 eclipse 中的右箭头看起来很锐利，但在模拟器和设备中看起来很模糊](../Images/f97ef95c81a45ed431bc906108ad227b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:16:52.360

您需要为所有密度提供资源。如果您只在其中放置一个图标`res/drawable`，则该资源将被使用并按上述密度进行缩放`mdpi`。因此，对于一个`hdpi`设备，您将看到您的可绘制对象的放大 (150%) 版本，而对于`xhdpi`，您将看到图形的 200% 放大版本。

**这是不好的。**

您需要使用 3:4:6:8 的比例创建更大版本的图形，其中 mdpi 是密度 (4)。您几乎可以忽略`ldpi`，但只需在`res/drawable`. 你的 hdpi 图标应该大 1.5 倍，你的 xhdpi 图标应该大 2 倍。因此，例如，您想要以 48x48dp（与设备无关的像素）显示的图像应该以 48x48px 的 mdpi（放置`res/drawable-mdpi`在`res/drawable-hdpi`xhdpi）。如果您已将其设为可用，Android 将自动为您的密度选择正确的版本，并且不会对其进行扩展。

请记住，图形仍将与您最初设计的一样清晰。

有关更多信息，请参阅[本文](http://developer.android.com/guide/practices/ui_guidelines/icon_design.html#icon-sets)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-27T03:14:09.200

我使用 MobiOne 软件编写 android 应用程序，当我遵循 36、48、72 和 96 像素图标大小规则时，我遇到了同样的图标模糊问题。你猜怎么了？我用 300 像素的图像替换了 96 像素的图像，当在三星 Galaxy S4 上查看时，生成的图标变得清晰而清晰。后来我用 200 像素的图像替换了 72 像素的图像。

# c - 如何在不更改内容的情况下更新文本文件

> ID：12805646
> 
> 赞同：0
> 
> 时间：2012-10-09T17:54:25.857
> 
> 标签：c, file, file-io

您好我想知道是否可以更新文本文件，我的意思是在不更改内容的情况下向所有行添加一些文本。假设一个像这样的文本文件。

```
A
B
C
D
E
F
G 
```

我想这样更新（在所有行的第一个字符附近添加另一个字符）

```
A   H
B   I
C   J
D   K
E   L
F   M
G   N 
```

当我以附加模式打开一个文本文件并`fseek()`以各种方式使用函数时，即使它可以在行中添加一些数据，最后的一些数据每次都会丢失。

我希望它清楚地理解这个问题，如果你能提供帮助，我将不胜感激。不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:28:15.437

通过 C 和 POSIX 文件操作访问的文件模型将文件呈现为字节序列，并且没有插入操作。您只能覆盖现有字节（替换它们）、在末尾添加新字节或截断文件。

要创建您想要的输出，您必须写入一个新文件。读取完输入文件后，您可以将新文件移动到旧文件的路径，从而用新输出替换旧文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:30:08.263

最好的办法是简单地将所有数据读入内存，然后以所需格式写出文件。有时为了可读性和可维护性牺牲一点效率会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T17:59:06.150

文本文件中“行”的概念实际上只是意味着文件中有换行符（“\n”）。

要在文本文件中一行的第一个元素之后添加数据，请找到要在其后附加的字符，然后将数据放在该字符和下一个换行符之间。

# facebook - facebook测试刮缓存

> ID：12805660
> 
> 赞同：0
> 
> 时间：2012-10-09T17:55:07.587
> 
> 标签：facebook, facebook-opengraph

有人知道在 Facebook 上分享链接时“测试抓取缓存”是什么意思吗？

[![测试抓取缓存](../Images/b0947babf1f3f77fbd48100c49c81849.png "测试抓取缓存")](https://i.stack.imgur.com/vzlw4.png "测试抓取缓存")
[（来源：[zao.com](http://blog.zao.com/wp-content/themes/zaotheme/test.png)）]

我的用户尝试共享和重新共享链接（来自 facebook） - 在第一次共享时，当有人尝试重新共享链接时，一切似乎都很好（文本和图像工作正常） - 有时 facebook 会显示带有文本的共享

我的页面使用 OpenGraph 标签正确编码。

# sql-server - MS SQL Server - 为用户创建唯一密钥

> ID：12805662
> 
> 赞同：0
> 
> 时间：2012-10-09T17:55:14.597
> 
> 标签：sql-server

我有一个员工表，其中包含同一个人的多个条目。使用他们的 SIN 号码，您可以确定他们是否是同一个人。

例子：

```
Id  Name    SIN
1   John Smith  1234
2   John Smith  1234
3   Jess Jones  4321 
```

我希望能够将这个表中的每个人都复制到一个新表中。我想创建一个新列（UserKey [GUID]），该列对于多次出现在表中的用户来说是唯一的。我想使用这个新的 UserKey [GUID] 而不是 SIN 号码。

```
Example:
Id  Name        UserKey (Guid)
1   John Smith  1234DFKJ2328LJFD
2   John Smith  1234DFKJ2328LJFD
3   Jess Jones  9543SLDFJ28EKJFF 
```

我不知道如何处理这个查询。任何帮助都会很棒。

我正在使用 MS SQL Server 2008。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:07:33.940

您可以创建一个临时表，将 SIN 映射到新的 GUID。然后您可以将原始表与映射表连接起来，并从中创建新表。

```
# Create a table called #temp with the mappings SID => new GUID
SELECT SIN, newid() UserKey INTO #temp FROM (SELECT DISTINCT SIN FROM Table1) a

# ...and join that and the original table to a new table.
SELECT id, name, userkey
INTO NewTable
FROM Table1 t1
JOIN #temp t2
ON t1.SIN = t2.SIN 
```

SQLFiddle[在这里](http://sqlfiddle.com/#!3/45866/5)。

# php - 从 Heroku 外部连接到 cPanel 服务器上的 MySQL 数据库？

> ID：12805664
> 
> 赞同：1
> 
> 时间：2012-10-09T17:55:15.777
> 
> 标签：php, mysql, heroku, cpanel

我正在使用 Heroku 应用程序来托管一个 facebook 应用程序，因为 Facebook 再次改变了他们设置应用程序的方式。但是，我需要从我的 cPanel VPS 外部连接到 MySQL，但我无法正确连接。我尝试过使用`darkprospect.net`（主机域）、`ultimate-battle-online.com`（用户的主域）`184.154.20.170`以及那些加上添加端口`3306`和无端口的组合。我以前需要确保将正确的域添加到正确的文件中，但现在它只是没有连接。现在使用`mysql_connect()`函数时出现此错误：

```
Lost connection to MySQL server at 'reading initial communication packet', system error: 110 
```

再次感谢您提出的任何想法！

**编辑**：我发现这是 PHP 应用程序默认的 buildpack 的一个问题，因为我使用 PHP 5.4.7 开发 VPS香草 PHP 和 Apache。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T15:55:23.500

我能够创建一个新的 Heroku buildpack，它能够支持我的应用程序所需的所有功能。因为我在我的 VPS 上使用 PHP 5.4.7 进行开发，所以我的配置是为更多新功能而设计的，并且 Heroku 的基本 Buildpack 只有 PHP 5.3.10，所以后台日志中出现了看不见的错误，这些错误正在停止连接过程。此外，CSF Firewall 仅针对 UDP 收入 3306 进行了配置，我也能够将其添加到 UTP 中，这似乎解决了 Connection Timed Out 错误，这是我为自己制作了更好的 buildpack 后的最后一个错误。

# c# - Entity Framework 4 - 添加自定义字段好不好？

> ID：12805668
> 
> 赞同：2
> 
> 时间：2012-10-09T17:55:33.987
> 
> 标签：c#, .net, entity-framework-4

我使用 C# + EF 4.0 创建了一个桌面应用程序。我知道使用部分类向 Entity Framework EntityObject添加自定义**方法是正常的：**

```
public partial class EntityModel: EntityObject{
   public void MyMethod() { ... }
} 
```

但是我需要添加一个自定义字段来存储我不想保存在数据库中的信息。

那么这是正常的还是有什么办法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T17:57:06.273

只要它与班级有关并且不真正属于其他地方，那是完全正常的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T17:57:37.647

当然，只需添加您需要的属性，例如：

```
public string MyCustomField { get; set; } 
```

但是请记住，它对于该对象是有状态的，因此除非您自己这样做，否则它不会在**任何地方**持续存在，并且它将为每个对象保留不同的值，除非您当然将其设为静态，但我***强烈***建议您不要这样做。

# c++ - 如果一个新的重载但没有加载相应的删除会发生什么？

> ID：12805671
> 
> 赞同：4
> 
> 时间：2012-10-09T17:55:45.293
> 
> 标签：c++, new-operator

任何人都可以解释如果一个新的重载但相应的删除没有在 C++ 中加载会发生什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:01:11.263

这只是对象构造引发异常时的问题，在 C++11 5.3.4/18 中有描述：

> 如果找不到明确匹配的解除分配函数，则传播异常不会导致对象的内存被释放。[注：这适用于被调用的分配函数不分配内存的情况；否则，很可能导致内存泄漏。——尾注]

例子：

```
T * p = new (true, 'x', Blue) T("Jim"); 
```

如果`T`throws 的构造函数，我们需要一个重载`operator delete(void *, bool, char, enum Color)`，无论是在命名空间范围内还是作为 的静态成员`T`，如果这个函数不存在，那么就不会调用释放函数。

正如注释所说，对于本质上是无操作的放置新功能，这可能不是问题。但是，如果分配函数做了不平凡的工作，那么将没有匹配的清理函数。

# android - android：xml中的广告编码，执行时无法显示任何广告

> ID：12805673
> 
> 赞同：0
> 
> 时间：2012-10-09T17:55:53.967
> 
> 标签：android, admob, tablelayout

我尝试将 com.google.ads.AdView 添加到 xml 部分，xml 编码如下：

```
<TableLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:id="@+id/tableLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/background_color"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:padding="5dp"
    android:stretchColumns="*" >
<TableRow
    <Button android:id="@+id/equal" 
        style="@style/Eq_button_style"
        android:text="=">   
    </Button>
</TableRow>

  <com.google.ads.AdView 
      android:id="@+id/adView"                         
      android:layout_width="wrap_content"                         
      android:layout_height="wrap_content"                         
      ads:adUnitId="a123123123123c"      //this ID is confirmed correct                   
      ads:adSize="BANNER"                         
      ads:testDevices="TEST_EMULATOR, xxxxxxxxxxxxxxxxx"   //this ID is confirmed correct                      
      ads:loadAdOnCreate="true"/>

</TableLayout> 
```

但是，即使应用程序在运行时没有崩溃，底部也没有显示广告。日志如下：

```
10-10 01:45:16.360: I/GATE(16797): <GATE-M>DEV_ACTION_COMPLETED</GATE-M>
10-10 01:45:16.365: D/webviewglue(16797): nativeDestroy view: 0x3ef6f0
10-10 01:45:16.365: E/Ads(16797): An error occurred while destroying an AdWebView:
10-10 01:45:16.365: E/Ads(16797): java.lang.NullPointerException
10-10 01:45:16.365: E/Ads(16797):   at android.webkit.WebView.setWebViewClient(WebView.java:5168)
10-10 01:45:16.365: E/Ads(16797):   at com.google.ads.internal.AdWebView.destroy(SourceFile:252)
10-10 01:45:16.365: E/Ads(16797):   at com.google.ads.internal.c$e.run(SourceFile:191)
10-10 01:45:16.365: E/Ads(16797):   at android.os.Handler.handleCallback(Handler.java:605)
10-10 01:45:16.365: E/Ads(16797):   at android.os.Handler.dispatchMessage(Handler.java:92)
10-10 01:45:16.365: E/Ads(16797):   at android.os.Looper.loop(Looper.java:137)
10-10 01:45:16.365: E/Ads(16797):   at android.app.ActivityThread.main(ActivityThread.java:4511)
10-10 01:45:16.365: E/Ads(16797):   at java.lang.reflect.Method.invokeNative(Native Method)
10-10 01:45:16.365: E/Ads(16797):   at java.lang.reflect.Method.invoke(Method.java:511)
10-10 01:45:16.365: E/Ads(16797):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
10-10 01:45:16.365: E/Ads(16797):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
10-10 01:45:16.365: E/Ads(16797):   at dalvik.system.NativeStart.main(Native Method)
10-10 01:45:16.365: I/Ads(16797): onReceiveAd()
10-10 01:45:16.460: D/dalvikvm(16797): GC_CONCURRENT freed 424K, 6% free 9580K/10119K, paused 2ms+11ms
10-10 01:45:16.460: W/Ads(16797): Not enough space to show ad! Wants: <480, 75>, Has: <464, 708> 
```

如何解决？该程序不会强制关闭，它仍然可以执行，但广告无法显示。另外，最后一行 Logcat 说没有足够的空间？如何为其添加更多空间？我已经为它预留了很多空间。

提前谢谢了！

# 修改后的logcat：

应用程序仍然可以在没有任何错误的情况下执行，但是这些“E”部分在某些情况下对应用程序的正确执行有影响吗？

```
10-11 00:52:30.330: E/Ads(10023): An error occurred while destroying an AdWebView:
10-11 00:52:30.330: E/Ads(10023): java.lang.NullPointerException
10-11 00:52:30.330: E/Ads(10023):   at android.webkit.WebView.setWebViewClient(WebView.java:5168)
10-11 00:52:30.330: E/Ads(10023):   at com.google.ads.internal.AdWebView.destroy(SourceFile:252)
10-11 00:52:30.330: E/Ads(10023):   at com.google.ads.internal.c$e.run(SourceFile:191)
10-11 00:52:30.330: E/Ads(10023):   at android.os.Handler.handleCallback(Handler.java:605)
10-11 00:52:30.330: E/Ads(10023):   at android.os.Handler.dispatchMessage(Handler.java:92)
10-11 00:52:30.330: E/Ads(10023):   at android.os.Looper.loop(Looper.java:137)
10-11 00:52:30.330: E/Ads(10023):   at android.app.ActivityThread.main(ActivityThread.java:4511)
10-11 00:52:30.330: E/Ads(10023):   at java.lang.reflect.Method.invokeNative(Native Method)
10-11 00:52:30.330: E/Ads(10023):   at java.lang.reflect.Method.invoke(Method.java:511)
10-11 00:52:30.330: E/Ads(10023):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
10-11 00:52:30.330: E/Ads(10023):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
10-11 00:52:30.330: E/Ads(10023):   at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:17:08.997

问题确实是：

```
W/Ads(16797): Not enough space to show ad! Wants: <480, 75>, Has: <464, 708> 
```

对于该设备，您需要整个屏幕宽度才能纵向展示广告。部分问题出`android:padding="5dp"`在您的 TableLayout 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:29:01.270

应该是布局问题。试试这个。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TableLayout
        xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
        android:id="@+id/tableLayout"
        android:layout_width="match_parent"
        android:layout_height="0dp"
            android:background="@color/background_color"
        android:layout_weight="1"
        android:gravity="center_horizontal"
        android:orientation="vertical"
        android:padding="5dp"
        android:stretchColumns="*" >

        <TableRow>

            <Button
                android:id="@+id/equal"
                    style="@style/Eq_button_style"
                android:text="=" >
            </Button>
        </TableRow>
    </TableLayout>

    <com.google.ads.AdView
        android:id="@+id/adView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        ads:adSize="BANNER"
        ads:adUnitId="a123123123123c"
        ads:loadAdOnCreate="true"
        ads:testDevices="TEST_EMULATOR, xxxxxxxxxxxxxxxxx" />

</LinearLayout> 
```

# mshtml - 如何从 Web 浏览器控件或文档中获取 IViewObjectPresentSite

> ID：12805674
> 
> 赞同：0
> 
> 时间：2012-10-09T17:55:54.717
> 
> 标签：mshtml

根据[http://msdn.microsoft.com/en-us/library/jj206442(v=vs.85).aspx，IViewObjectPresentSite](http://msdn.microsoft.com/en-us/library/jj206442(v=vs.85).aspx)是 MSHTML(IE9?) 的一部分。我正在尝试在 webBrowser2 对象（通过查询 IID_IWebBrowser2 接收）上运行 IID_IViewObjectPresentSite 的 QueryInterface，但它返回失败。我尝试在 htmlDoc2 对象（通过查询 IID_IHTMLDocument2 接收）上查询相同的内容，但也失败了。我可以在这两个对象上成功查询 IID_IViewObject 并取回 IViewObject。

有人可以告诉我如何在浏览器或文档上获取 IID_IViewObjectPresentSite 吗？我正在使用最新的 Windows 8 SDK 和 VS2010 并在 Windows 8 上运行。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T15:19:40.807

在函数 SetClientSite 的实现中，我能够从 ActiveX 代码中获取它。
就像是：

```
SetClientSite( IOleClientSite *pClientSite ) {  
  CComQIPtr<IViewObjectPresentSite, &IID_IViewObjectPresentSite> spIViewObjectPresentSite;  
  HRESULT hr;  
  hr = pClientSite->QueryInterface(IID_IViewObjectPresentSite, (void **) &spIViewObjectPresentSite);  
} 
```

# android - 为什么我在使用 WebView 时会在 Android 上获得 SIGSEGV？

> ID：12805681
> 
> 赞同：0
> 
> 时间：2012-10-09T17:56:03.380
> 
> 标签：android, android-webview, segmentation-fault

> **可能重复：**
> [Android 2.1 WebView 中的 SIGSEGV](https://stackoverflow.com/questions/10897744/sigsegv-in-android-2-1-webview)

当 WebView 似乎正在尝试加载某些内容时（页面通常已经加载了某些内容并正在显示它），我的应用程序崩溃了。

我在日志猫上得到以下输出...

它似乎发生在垃圾收集器运行之后......

10-14 14:43:45.451: D/dalvikvm(27679): GC_CONCURRENT freed 827K, 16% free 8966K/10567K, paused 12ms+14ms,总共74ms

10-09 10:52:36.428: A/libc(19260): 致命信号 11 (SIGSEGV) 在 0x00000000 (code=1), 线程 19311 (FP_DoPlay)

知道如何调查这个吗？

# javascript - 如何使此功能继续进行表单提交

> ID：12805682
> 
> 赞同：1
> 
> 时间：2012-10-09T17:56:07.027
> 
> 标签：javascript, jquery, submit

这是功能，我只是希望它仅在提交表单时提交或激活。目前，我必须添加`onclick="ShowProgressAnimation();"`到每个表单，我想在单击提交时进行，全局设置

```
function ShowProgressAnimation() {
  $("#loading-div-background").css({ opacity: 0.8 });
  $("#loading-div-background").show();
  $(".button-2").hide();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T17:59:45.637

为简单起见，假设您的表单有一个 ID `#myForm`：

```
form = document.getElementById('myForm');
form.onsubmit = ShowProgressAnimation; 
```

如果没有，可以从`document.forms`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:00:11.053

您可以将其绑定到`submit`表单的事件：

```
$('.form-selector').on('submit', function(eventObject) {
    ShowProgressAnimation();
} 
```

请注意您的表单将被提交，不是吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:01:50.007

```
$('#my_form').submit(function(){
            ShowProgressAnimation();
            submit(this);
            return false;
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T18:09:10.670

由于您希望在提交时将其应用于所有表单，您可以将以下内容添加到`.js`每个页面包含的文件中：

```
$(function(){
    $("form").submit(function(){
        ShowProgressAnimation();
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T14:16:35.927

添加此创建此功能，提交按钮上有 Onclick="Showprogressanimation"。但想添加检查错误，如果不是表单错误然后提交...

```
 $(function  ShowProgressAnimation(){

            $("form").submit(function(){

            $("#loading-div-background").css({ opacity: 0.8 });
            $("#loading-div-background").show();
            $('input[type="submit"]').addClass("disabled");
            $('input[type="submit"]').attr('disabled','disabled');

                });
            }); 
```

这是要在语句中组合的验证代码，我想添加这两个标签以查看它们是否显示错误然后不要提交，但如果好的goahead 提交。

我怎么写

```
 jQuery("#TxtAccountUserId").validate({

             });

            jQuery("#TxtAccountPassword").validate({

             }); 
```

# javascript - 从对象返回数据时如何检查间接匹配？

> ID：12805687
> 
> 赞同：3
> 
> 时间：2012-10-09T17:56:27.497
> 
> 标签：javascript, object

我想检查我的数组中的变量。如果数字直接与我的值匹配，它就可以工作。如果它低于匹配项，我怎样才能让它与以前的值匹配。从我的代码：

```
var assassin_bp = {
    fhr: { 7:8, 15:7, 27:6, 48:5, 86:4, 200:3 },
    fcr: { 8:15, 16:14, 27:13, 42:12, 65:11, 102:10, 174:9 }
}
var char_fhr = 48;
var fhr_frames = assassin_bp[ 'fhr' ][ [char_fhr] ] 
```

**如果 char_fhr**值48 **，** fhr_frames**返回**5 **，**如果
char_fhr**值**47 **（**或 27 到 47 之间的任何数字），**fhr_frames**应该返回**6**，
如果**char_fhr**值**49**（或 48 到 85 之间的任何数字），**fhr_frames**应该返回**5**

我不知道从哪里开始。对象可以包含范围吗？我应该有一个功能检查它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:07:35.857

您需要遍历对象属性并将它们的名称与您的目标值进行比较。请参阅[`for...in` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)和[使用对象*^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects)。

```
function valueForClosestKey(obj, target) {
    // get all keys smaller than or equal to `target`
    var keys = [];
    for(var k in obj) {
        if(k <= target) {
            keys.push(k);
        }
    }

    // order keys in ascending order
    keys.sort(function(a, b) {
        return a - b;
    }); 
    // e.g. `keys` is now [7, 15, 27, 48]      

    // get the "closest" key, which is the last one in the array
    if(keys.length > 0) {
        return obj[keys.pop()];
    }
    // if there are no keys smaller than `target` (i.e. `keys` is empty),
    // we just don't return anything (implicitly returns `undefined`)
}

var value = valueForClosestKey(assassin_bp[ 'fhr' ], char_fhr); 
```

有必要以这种方式提取和排序键，因为迭代对象的顺序取决于实现。即不能保证属性的数字顺序正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:58:50.630

[http://jsfiddle.net/aquinas/QP6aF/](http://jsfiddle.net/aquinas/QP6aF/)

怎么样：

```
var assassin_bp = {
    fhr: { 7:8, 15:7, 27:6, 48:5, 86:4, 200:3 },
    fcr: { 8:15, 16:14, 27:13, 42:12, 65:11, 102:10, 174:9 }
}

var arr = [];

for (var prop in assassin_bp.fhr){
    if (assassin_bp.fhr.hasOwnProperty(prop)){
        arr.push(parseInt(prop));
    }
}

arr.sort(function(a,b){return a-b;});

function calcScore(val){
    if (arr[0] > val){
        return assassin_bp.fhr[arr[0]];
    }

    for (var i=arr.length; i>=0; i--){
        if (val >= arr[i]){
            return assassin_bp.fhr[arr[i]];
        }
    }
}

//test to see if this works:
for (var i=0; i<300; i++){
    document.write(i + " - " + calcScore(i) + "<br/>");
}                    
        ​ 
```

# sql - SQL Server 存储过程从 RPC 时没有运行任何语句

> ID：12805692
> 
> 赞同：1
> 
> 时间：2012-10-09T17:56:43.123
> 
> 标签：sql, sql-server, stored-procedures

我有一个带有存储过程的 SQL Server 2000 数据库，它根据其 ID 从特定表中删除一行。当我从 VB.NET 调用存储过程时，它不会删除该行，而是通过 SSMS 直接在数据库上运行相同的脚本，它可以工作。

这是我的一系列事件：

1.  启动 SQL Server Profiler 以监视对数据库的所有调用。我设置它来跟踪存储过程何时启动、完成，甚至在该存储过程中启动/完成 SQL 语句。
2.  通过 VB.NET dll 调用存储过程。
3.  停止探查器跟踪以避免挖掘过多的数据。
4.  从表中选择，并查看该行仍然存在。
5.  查看分析器跟踪，它只显示 RPC:Starting、SP:Starting、RPC:Completed。没有跟踪内部语句，这验证了为什么没有删除该行，因为删除语句从未触发。
6.  直接从 RPC 复制/粘贴 EXEC 调用：从通过 VB.NET 调用它时开始的跟踪条目到 SQL Server Management Studio 查询窗口，该窗口指向具有相同凭据的相同数据库。
7.  再次启动分析器。
8.  执行 SSMS 中项目符号 6 中的 EXEC 语句。
9.  停止探查器。
10.  从表中选择，并看到该行 GOT DELETED 应该是这样。
11.  查看分析器跟踪，其中显示 SP:Starting、所有开始/完成的语句（包括 DELETE 语句）和 SP:Completed。

为什么通过 RPC 运行它会使其不执行 proc 中的任何语句，而是直接运行它应该执行的操作？

编辑：下面是我的 VB.NET 代码。这是我们在其他 100 多个地方使用的相同代码：

`Dim paramRowID As New SqlParameter("@RowID", sRowID)` `Microsoft.ApplicationBlocks.Data.SqlHelper.ExecuteNonQuery(oConn, "spDeleteRow", paramRowID)`

[请参阅此处](http://www.sharpdeveloper.net/source/SqlHelper-Source-Code-cs.html)的SqlHelper 源代码。

**编辑：我现在讨厌自己。:) SQL 抛出异常“nvarchar 与图像不兼容”关于我传递 NULL 的另一个参数。SSMS 不担心类型，但 VB.NET 担心，因为我没有明确告诉它它是 image 类型。一旦我定义了那个参数，它就起作用了。我希望分析器会告诉我有一个错误。**

任何帮助，将不胜感激，

格雷格

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:45:45.817

那是因为 SSMS 不调用 RPC，而是调用批处理。事实上，没有办法从 SSMS 调用 RPC，因为您不能声明*参数*，这就是 RPC 调用与[TDS](http://msdn.microsoft.com/en-us/library/dd304523%28prot.20%29.aspx)中的批处理调用的区别：

> [2.2.1.3 SQL Batch](http://msdn.microsoft.com/en-us/library/dd357447%28prot.20%29.aspx)发送一条SQL 语句或一批SQL 语句，将用Unicode 字符串表示的SQL 批处理复制到TDS 数据包的数据段，然后发送到支持SQL 的数据库服务器。一个 SQL 批处理可能跨越多个 TDS 数据包。有关详细信息，请参阅第 2.2.6.6 节
> 
> [2.2.1.5 远程过程调用](http://msdn.microsoft.com/en-us/library/dd303353%28prot.20%29.aspx)为了在服务器上执行远程过程调用（RPC），客户端向服务器发送一个RPC消息数据流。这是一个包含 RPC 名称或数字标识符、选项**和参数**的二进制流。RPC 必须在单独的 TDS 消息中，并且不能与 SQL 语句混合。一条消息中可以有多个 RPC。有关详细信息，请参阅第 2.2.6.5 节。

因此，请改为监视该[`SQL:BatchCompleted`](http://msdn.microsoft.com/en-us/library/ms176010.aspx)事件，您将看到您的 SSMS 语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:41:52.910

应用程序用来连接 sql 的用户是否有权执行存储过程？这是我要验证的第一件事。

# java - 为什么抽象方法不能同步？

> ID：12805698
> 
> 赞同：27
> 
> 时间：2012-10-09T17:57:03.077
> 
> 标签：java, multithreading, inheritance, synchronized, abstraction

我正在阅读[CodeRanch 的一个线程，](http://www.coderanch.com/t/455033/java-programmer-SCJP/certification/abstract-synchronized-methods-not-allowed)说抽象方法无法同步，因为抽象类无法实例化，这意味着没有对象可以锁定。

这是没有意义的，因为抽象类是子类的定义（契约）。同步方法的抽象定义不需要锁，子进程需要。所有抽象标题都表明孩子**必须**同步此方法。我对此的逻辑正确吗？如果没有，有人可以解释为什么我错了吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-09T18:05:28.197

关于无法实例化抽象类的评论是垃圾。鉴于它必须是抽象的实例方法，所以肯定*有*一个可以锁定的引用。抽象类中的具体方法仍然可以引用`this`. 但是，这仍然不意味着抽象类应该能够同步。

方法是否同步是该方法的*实现细节*。同步并没有*在任何地方*指定为声明性合同——你也不能在接口中同步。

一个类如何实现它提供的任何线程安全保证取决于它。如果一个抽象类想要*强制*使用特定的方法，它应该使用模板方法模式：

```
// I hate synchronizing on "this"
private final Object lock = new Object();

public final void foo() {
    synchronized(lock) {
        fooImpl();
    }
}

protected abstract void fooImpl(); 
```

不过，这本身就很危险，因为它有效地调用了锁中的“未知”代码，这是导致死锁等的秘诀。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-09T18:02:56.913

不应该使用抽象方法或接口方法来指定锁定行为，因为它不应该是契约的一部分。

可能的想法是锁定行为从根本上是实现的一部分——不同的实现会希望以不同的方式执行锁定——并且在该抽象级别指定它会适得其反。

请记住，该关键字`synchronized`专门用于实现隐式锁定（获取调用实例方法的对象上的锁定），并且有一些方法可以使用 ReentrantLock 等替代方法进行锁定，其中该关键字不适用，或者可能使用 CAS 或否则完全避免锁定。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-09T18:06:29.140

```
synchronized void foo()
{
    body
} 
```

被定义为等价于

```
void foo()
{ 
    synchronized(this)
    {
        body
    }
} 
```

（如果是静态的，则在类上同步而不是`this`）

由于抽象方法没有主体，`synchronized`因此方法上的关键字未定义。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-09T18:06:37.743

我认为这背后的一个逻辑可能是是否同步该方法应该由实现类决定。意思是，它让实现者可以自由选择是否提供同步或非同步实现。另外，如果线程安全不是问题，客户端还可以选择非同步版本以避免同步开销。

# python - Python：使用模块 laspy 的列表理解问题

> ID：12805699
> 
> 赞同：1
> 
> 时间：2012-10-09T17:57:04.407
> 
> 标签：python, list, list-comprehension

最近我明白了使用列表理解的巨大优势。我正在处理以特殊格式 *.las 文件存储的数百万个点 (x,y,z)。在 python 中，有两种方法可以使用这种格式：

```
Liblas module  [http://www.liblas.org/tutorial/python.html][1] (in a C++/Python)
laspy module [http://laspy.readthedocs.org/en/latest/tut_part_1.html][2] (pure Python) 
```

我对 liblas 有几个问题，我想测试一下 laspy。

在 liblas 中，我可以将列表理解用作：

```
from liblas import file as lasfile
f = lasfile.File(inFile,None,'r') # open LAS
points = [(p.x,p.y) for p in f] # read in list comprehension 
```

在 laspy 中，我无法弄清楚如何做同样的事情：

```
from laspy.file import File
f = file.File(inFile, mode='r')
f
<laspy.file.File object at 0x0000000013939080>
(f[0].X,f[0].Y)
(30839973, 696447860) 
```

我尝试了几种组合：

```
points = [(p.X,p.Y) for p in f] 
```

但我收到了这条消息

```
Traceback (most recent call last):
 File "<interactive input>", line 1, in <module>
AttributeError: Point instance has no attribute 'x' 
```

我尝试了大写和非大写，因为 Python 区分大小写：

```
>>> [(p.x,p.y) for p in f]
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
AttributeError: Point instance has no attribute 'x'
>>> [(p.X,p.Y) for p in f]
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
AttributeError: Point instance has no attribute 'X' 
```

这是在交互式提示中：

```
C:\Python27>python.exe
Python 2.7.3 (default, Apr 10 2012, 23:24:47) [MSC v.1500 64 bit (AMD64)] on win
32
Type "help", "copyright", "credits" or "license" for more information.
>>> from laspy.file import File
>>> inFile="C:\\04-las_clip_inside_area\\Ku_018_class.las"
>>> f = File(inFile, None, 'r')
>>> f
<laspy.file.File object at 0x00000000024D5E10>
>>> points = [(p.X,p.Y) for p in f]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: Point instance has no attribute 'X'
>>> 
```

列表后的打印 p 是：

```
print dir(p) 
['__doc__', '__init__', '__module__', 'make_nice', 'pack', 'packer', 'reader', 'unpacked'] 
```

在循环格式中我总是有同样的错误

```
>>> for p in f:
...     print dir(p)
...     print p.X,p.Y
...     
['__doc__', '__init__', '__module__', 'make_nice', 'pack', 'packer', 'reader', 'unpacked']
Traceback (most recent call last):
  File "<interactive input>", line 3, in <module>
AttributeError: Point instance has no attribute 'X' 
```

使用 nneonneo 建议的此代码

```
import numpy as np
for p in f:
...   points = np.array([f.X, f.Y]).T 
```

我可以存储在数组中

```
points
array([[ 30839973, 696447860],
       [ 30839937, 696447890],
       [ 30839842, 696447832],
       ..., 
       [ 30943795, 695999984],
       [ 30943695, 695999922],
       [ 30943960, 695999995]]) 
```

但错过了创建列表理解的方式

```
points = [np.array(p.X,p.Y).T for p in f]
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
AttributeError: Point instance has no attribute 'X' 
```

提前感谢您的帮助。詹尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:01:57.567

Python 区分大小写。对我来说，看起来你要求属性`x`，但它应该是大写`X`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:26:42.600

尝试

```
import numpy as np
...
points = np.array([f.X, f.Y]).T 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T18:27:38.613

看起来`Point`有一种`make_nice()`方法可以显示更多属性。

```
for p in f: p.make_nice() 
```

现在您的列表组合应该可以工作（使用大写的 X 和 Y——请参阅下面的评论）。

```
[(p.X,p.Y) for p in f] 
```

注意：此答案未经测试。它基于阅读源代码[`laspy.util.Point`](http://laspy.readthedocs.org/en/latest/_modules/laspy/util.html)。

相关来源：

```
def make_nice(self):
    '''Turn a point instance with the bare essentials (an unpacked list of data)
    into a fully populated point. Add all the named attributes it possesses, 
    including binary fields.
    '''
    i = 0
    for dim in self.reader.point_format.specs: 
            self.__dict__[dim.name] = self.unpacked[i]
            i += 1

    # rest of method snipped 
```

# html - HTML5 AppCache 和普通浏览器缓存有什么区别？

> ID：12805701
> 
> 赞同：12
> 
> 时间：2012-10-09T17:57:07.820
> 
> 标签：html, html5-appcache

我不明白 HTML5 AppCache 的意义。我们已经有了一个普通的缓存。如果您第一次访问一个网站，它已经缓存了所有资产。AppCache 提供了哪些额外价值？它只是一个文件列表，以便浏览器知道要下载哪些资产，即使它们现在没有被 HTML 引用？浏览器是否确保缓存是“全有或全无”，即它是否确保清单引用的所有内容都被缓存，或者什么都没有？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T00:04:41.247

我认为您缺少的一点`AppCache`是专门设计用于允许离线使用网络应用程序（和网站），尽管当用户在线时，普通浏览器缓存提供的相同速度优势也由`AppCache`.

与浏览器缓存的主要区别在于，您可以指定浏览器应缓存在清单文件（可能是您的整个站点）中的所有资产，而浏览器缓存将仅存储您实际访问过的页面（和相关资产）。

我不是这方面的专家`AppCache`，但我知道它并非没有问题。[这里](http://www.alistapart.com/articles/application-cache-is-a-douchebag/)有一篇非常好的文章，来自一个曾经`AppCache`允许他的移动网站的部分内容可以离线使用的小伙子。它包括他们决定使用它的一些理由以及他们在这样做时遇到的一些问题。

这篇关于这个主题的[HTML5 Rocks 文章](http://www.html5rocks.com/en/tutorials/appcache/beginner/)也有一些很好的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-08T12:14:50.503

AppCache 实际上使用浏览器缓存来支持其操作。它相当于下载应用程序以在本地运行的浏览器。

用户第一次访问该页面时，该页面的资源将从服务器加载并存储在普通缓存中。如果页面指定了 appcache 清单，浏览器将下载清单并获取其中的所有资源（即使它们没有出现在嵌入清单的页面上）。然后将它们存储在 appcache 中。

用户第二次访问该页面时，浏览器将检查其应用缓存。如果该 URL 存在条目，它将根据清单中指定的规则从 appcache 而不是从服务器加载页面（清单可以将某些资源显式标记为从网络获取）。

浏览器从appcache加载页面后，会联系服务器查看是否有更新的manifest。如果清单被更新，它将从清单中获取资源。这些获取是使用普通浏览器缓存规则完成的，因此其中一些资源实际上可能最终从常规浏览器缓存而不是从服务器中获取（这允许您在使用 appcache 开发离线应用程序时进行差异更新）。新版本的 appcache 与旧版本是分开的。获取新版本后，用户继续与旧版本中的资源交互，直到他们刷新主页，然后加载新版本并丢弃旧版本。

另一个重要的一点是，appcache 对于何时丢弃资源有不同的规则。Appcache 基本上从不丢弃最新的一组资源，并将它们作为一个整体进行缓存。为了防止滥用，它对站点缓存的大小实施了存储限制（有时低至 5 MB）。相比之下，浏览器缓存没有每个站点的限制，但如果达到全局缓存限制，则会丢弃站点中的单个资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-24T06:24:44.023

HTML 5 应用程序缓存的重要特性是它使 Web 应用程序**离线**可用。普通浏览器缓存没有给出。

除了这个应用程序缓存将提供

**速度**- 由于指定页面的全部内容将被缓存到浏览器，因此它将提供比浏览器缓存更好的速度

**减少服务器负载**- 不需要一直回发，因为所有内容都在缓存中，直到清单文件中有任何更改

**缓存清单**：- 缓存清单文件是 HTML5 应用程序缓存的核心。我们可以指定哪些页面不需要缓存，哪些不应该缓存，甚至我们可以重用这个作为**错误处理技术**，因为我们可以在**FALLBACK**部分指定自定义错误页面来显示用户是否请求内容需要网络连接

有关应用程序缓存的基本了解，您可以[查看本教程](http://www.w3schools.com/html/html5_app_cache.asp)

# utf-8 - JBoss 5.1 - 如何以 UTF-8 发送 HTTP 响应？

> ID：12805702
> 
> 赞同：0
> 
> 时间：2012-10-09T17:57:08.180
> 
> 标签：utf-8, character-encoding, jboss, jboss5.x

我们正在从 JBOSS 4.x 迁移到 5.1，并且遇到了字符编码问题。

扩展 ASCII 范围内的某些字符在以前的 JBoss 版本下是可以的，但是对于新的 JBoss，它们会导致问题（例如，不完整的 http 响应）。

解决方案似乎是使用 UTF-8，但我发现导致 JBoss 在 Content-Type 标头中发送 charset=UTF-8 的唯一方法是在每个 JSP 页面的页面指令中指定这一点。否则，http 响应中的字符集被指定为 ISO-8859-1。我想找到一个将字符集设置为 UTF-8 的全局解决方案。

我见过其他几个关于 JBoss 字符编码的问题，但似乎都没有解决 http 响应的编码问题。

我试过没有成功：

*   在 jboss/bin/run.bat 中，设置 set "JAVA_OPTS=-Dfile.encoding=utf-8 %JAVA_OPTS%"
*   在 jboss/server//deploy/jbossweb.sar/server.xml 设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:52:18.710

我使用弹簧编码过滤器来设置编码：

```
<filter>
 <filter-name>encodingFilter</filter-name>  
 <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>  
 <init-param>  
    <param-name>encoding</param-name>  
    <param-value>UTF-8</param-value>  
 </init-param>  
 <init-param>  
    <param-name>forceEncoding</param-name>  
    <param-value>true</param-value>  
 </init-param>  
</filter>  
<filter-mapping>  
 <filter-name>encodingFilter</filter-name>  
 <url-pattern>/*</url-pattern>  
</filter-mapping> 
```

如果您不使用 spring，则需要一个设置编码的 servlet 过滤器。

# algorithm - 检查无向图中是否存在边缘的好方法

> ID：12805705
> 
> 赞同：1
> 
> 时间：2012-10-09T17:57:12.783
> 
> 标签：algorithm, data-structures

我正在使用邻接表表示。

基本上

```
 A:[B,C,D] means A is connected to B,C and D 
```

现在我正在尝试添加一个方法（在 python 中）以在图中添加边。

但在我添加边缘之前。我想检查两条边是否连接。因此，例如，我想在两个节点 D 和 A 之间添加一条边（不知道 A 和 D 是连接的事实）。

因此，由于哈希/字典中没有键“D”，它将返回 false。

现在，非常天真地，我可以检查 D 和 A，然后也检查 A 和 D.. 但这很不合时宜。或者每当我连接两个节点时，我总是可以复制..

即当连接 A 和 E.. A:[E] 创建 E:[A]

但这不是很节省空间。

基本上我想让这个图形方向独立。

是否有任何数据结构可以帮助我解决这个问题。

我希望我的问题是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:01:51.420

对于无向图，您可以使用一个简单的*边列表*来存储所有边对。这将节省空间并降低性能，但您应该知道您不能同时拥有两者，因此您始终必须做出权衡。

否则，您可以使用三角形*邻接矩阵*，但为了避免浪费一半空间，您必须以特定方式存储它（通过开发一种有效的方式来检索边缘存在而不浪费空间）。你确定这是值得的，而且不仅仅是过早的优化吗？

邻接表大部分都很好，即使您必须将每个无向边存储两次，您的图有多大？

看看我的答案：[Graph representation benchmarking](https://stackoverflow.com/questions/2656641/graph-representation-benchmarking/2656667#2656667)，所以你可以选择你喜欢的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:03:44.073

您遇到了经典的空间与时间权衡。

如您所说，如果没有找到D->A，则可以搜索A->D。这将使您的执行时间最多增加一倍。或者，当插入 A->D 时，也创建 D->A，但这是以额外空间为代价的。

最坏的情况，为了时间权衡，您将进行 2 次查找，仍然是 O(N)（使用更好的数据结构更快）。对于空间权衡，您将（在最坏的情况下）在每组节点之间创建一个链接，大约为 O(N^2)。因此，我只会进行 2 次查找。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T18:06:11.923

假设每种`contains()`方法都非常广泛，并且您希望不惜一切代价避免这样做，可以使用**[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)**，并检查是否存在边缘 - 从而减少`contains()`调用次数。

这个想法是：每个节点都将拥有自己的布隆过滤器，它将指示哪些边连接到它。检查布隆过滤器相当容易且便宜，并且在添加边缘时也可以对其进行修改。

如果您检查了布隆过滤器 - 它说“不” - 您可以安全地添加边缘 - 它不存在。
然而，布隆过滤器有误报——所以，如果布隆过滤器说“边缘存在”——你必须检查列表是否确实存在。

* * *

注意：
（1）如果使用布隆过滤器，去除边缘将是一个问题。
(2) 布隆过滤器为您提供了很好的时间/空间折衷——因为误报的数量随着过滤器大小的增加而减少。
(3) 但是，当边缘确实存在时 - 无论过滤器的大小是多少，您都必须使用该`contains()`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T21:07:06.070

假设可以比较您的节点名称，您可以简单地始终存储边，以便第一个端点小于第二个端点。然后，您只需执行一次查找。这绝对适用于字符串。

# java - 将对象声明为接口有什么好处？

> ID：12805713
> 
> 赞同：7
> 
> 时间：2012-10-09T17:58:07.497
> 
> 标签：java, interface, polymorphism

> **可能重复：**
> [“编程到接口”是什么意思？](https://stackoverflow.com/questions/383947/what-does-it-mean-to-program-to-an-interface)

我注意到有些人喜欢将一个对象声明为它实现的接口之一，**即使在变量的范围内，没有必要将其视为接口**，例如，没有期望接口的外部 API。

例如：

```
Map<String, Object> someMap = new HashMap<String, Object>(); 
```

或者你可以做

```
HashMap<String, Object> someMap = new HashMap<String, Object>(); 
```

并完全避免进口`java.util.Map`。

通过接口（上面第一个）而不是类本身（上面第二个）声明它有什么优点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:00:05.733

诸如声明对象可以做*什么*的*接口。*另一方面，诸如定义对象*如何*执行接口声明的操作的*类。*`Map<A, B>`**`HashMap<A, B>`**

 ***如果您声明一个变量（或字段，或其他） a `Map<A, B>`，则说明您的代码仅依赖于该接口定义的*合同*，它不依赖于实现的细节。

如果您将其声明为 a `HashMap<A, B>`，则可以理解为您需要*该特定版本的地图*（无论出于何种原因），并且不能用其他东西替换它。

我倾向于不喜欢诸如“因为您可以更改实现”之类的常见答案，这仅仅是因为，经过多年的实践，您会发现它不会像那样频繁地发生，而且主要的好处确实如此微妙（但是明确）表达你的意图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T18:02:48.520

由于它不是 API 的一部分，因此它是实现细节。最好是具体的实现，这里没有抽象的意义。

我的上一个答案

[在java中使用接口或类型定义变量？](https://stackoverflow.com/questions/3768869/use-interface-or-type-for-variable-definition-in-java/3774026#3774026)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T18:01:41.097

如果以后不使用该变量，则没有优势/劣势。使用接口而不是对象的原因是为了提供更大的灵活性，但如果不使用该变量，则与性能方面没有区别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T18:02:04.060

如果您使用`Map<String, Object> someMap`，则您正在设计一个接口而不是实现..因此您可以轻松地在其他实现之间切换..

因此，您`Map`可以指向`HashMap`、`LinkedHashMap`或任何其他对象，即 . 的子类`Map`。

**所以，如果你有： -**

```
Map<String, Integer> someMap = new HashMap<>(); 
```

您可以稍后（如果需要）更改实现以指向`LinkedHashMap`：-

```
someMap = new LinkedHashMap<>(); 
```

而如果你`HashMap`在 LHS 上使用，你只能让它指向一个`HashMap`..类型的对象。

但是，因此在性能上没有区别..但建议始终`design`使用`interface`而不是`implementation`..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-09T18:02:53.953

接口定义了类必须实现的方法。这样——如果你想调用一个接口定义的方法——你不需要知道一个对象的确切类类型，你只需要知道它实现了一个特定的接口。

例子：

```
interface Printer {
    public void print(String text);
}

class FilePrinter implements Printer {
    public void print(String text) {
       //append the text to a file
    }
}

class ScreenPrinter implements Printer {
    public void print(String text) {
       //write the text on the screen
    }
}

class SomeClass {
    public printSomething(Printer myPrinter) {
        myPrinter.print("Hello");
    }
} 
```

如果您调用 SomeClass.printSomething(...)，则传递 FilePrinter 或 ScreenPrinter 的实例并不重要，因为该方法并不关心。它知道对象实现了接口 Printer 并实现了它的方法。

关于接口的另一个重要点是一个类可以实现多个接口。***

# algorithm - 快速排序的实现

> ID：12805715
> 
> 赞同：0
> 
> 时间：2012-10-09T17:58:07.977
> 
> 标签：algorithm, quicksort

以下**快速排序**代码来自[编程珍珠](http://www.cs.bell-labs.com/cm/cs/pearls/sort.cpp)

```
void qsort3(int l, int u)
{   int i, j;
    DType t;
    if (l >= u)
        return;
    t = x[l];
    i = l;
    j = u+1;
    for (;;) {
        do i++; while (i <= u && x[i] < t);
        do j--; while (x[j] > t);
        if (i > j)
            break;
        swap(i, j);
    }
    swap(l, j);
    qsort3(l, j-1);
    qsort3(j+1, u);
} 
```

在双向划分部分，有一行：

```
if (i > j) 
```

**我的问题**是我可以将此行更改为：

```
if(i >= j) 
```

我认为可以这样做的原因是： `(i==j)`<=>`(x[i] == t)`这样我们就不需要交换 x[i] 和 x[j]。我们只是打破`for`循环。

`for`循环的以下代码是`swap(l, j)`. 由于 x[j] == t == x[l]，`swap(l, j)`与分区无关。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:12:51.597

我会说，是的，你可以做出改变：

当 i == j 时，swap(i, j) 是没有回报的，并且 i == j 之后的下一次迭代无条件地递增 i 并递减 j，因此将导致循环终止而不会改变数组。

# windows-8 - 黑白相机捕捉 WinJS

> ID：12805724
> 
> 赞同：1
> 
> 时间：2012-10-09T17:59:03.767
> 
> 标签：windows-8, microsoft-metro, photo, winjs

是否可以打开相机捕获并强制它拍摄黑白照片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:02:10.993

CameraCaptureUI API 不提供更改相机颜色/BW 的功能，但您可以添加媒体捕获过滤器来进行更改。

此 SDK 示例应该为您提供所需的内容...请注意，添加灰度过滤器需要 C++ 项目（包含在示例中）：

[http://code.msdn.microsoft.com/windowsapps/Media-Capture-Sample-adf87622](http://code.msdn.microsoft.com/windowsapps/Media-Capture-Sample-adf87622)

# python - 防止脚本滥用网络应用程序的最简单方法？

> ID：12805732
> 
> 赞同：4
> 
> 时间：2012-10-09T17:59:31.660
> 
> 标签：python, security, flask, spam-prevention

我正在运行flask/memcached，并且正在寻找一种精简/高效的方法来防止自动脚本向我提出请求和/或过快地提交新帖子。

我曾想过在会话 cookie 中包含一个“last_action”时间并检查每个请求，但无论我设置什么时间，脚本都可以设置为延迟那么长时间。

我还想过要获取 IP，如果在 x 时间内发出了太多的请求，请再拒绝这么长时间，但这需要像 redis 这样的东西才能有效运行，我想避免为此付费.

我更喜欢基于 cookie 的解决方案，除非像 redis 这样的东西可以证明它是值得的。

处理这类情况的“行业标准”是什么？哪些方法具有最少的成本/性能权衡？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:26:19.897

使用 cookie 无法实现此目的，因为恶意脚本可以静默地删除您的 cookie。由于您必须支持用户首次访问的情况（即没有设置任何 cookie），因此仅考虑存储在客户端上的状态无法区分真正的新用户和恶意脚本。

您需要在服务器端跟踪您的用户以实现您的目标。这可以像基于 IP 的过滤器一样简单，可防止同一 IP 快速发布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:45:42.243

你应该坐下来决定在你的应用场景中你的“核心”问题到底是什么，以及你的潜在用户是谁。这将帮助您指导正确的解决方案。

根据我的经验，这个主题有很多不同的问题和解决方案——没有一个是“一刀切”的

*   如果您对匿名用户有疑问，您可以尝试尽可能多地迁移“帐户墙”后面的功能。
*   如果您不能使用帐户墙，那么您最好使用一些基于 IP 的跟踪以及其他一些标头/javascript 内容。由于公司代理、家庭路由器等，单独使用 IP 可能是一场灾难。您将面临太多误报的风险。如果你添加浏览器信息，讨厌的用户仍然可以伪造它——但你会惩罚更少的真实用户。
*   您可能希望帐户墙仅用作强制执行 cookie 的一种方式，或者它可能会嵌入到拥有站点身份的想法中，其中经验可以获得特权。
*   您可能需要一个可以映射到另一个受信任站点的帐户的帐户。例如，我通常信任与 Facebook 绑定的第 3 方帐户——他们在处理虚假帐户方面相当不错。我不相信与 Twitter 绑定的第 3 方帐户——这主要是垃圾邮件。
*   您可能只需要网站“注册”来解决验证码，或者其他稍微不方便的东西来清除最令人讨厌的访问。但是，如果对不良行为的奖励足够高，您将无法解决任何问题。

我可以整天谈论这个。从我的角度来看，您必须首先解决业务逻辑和用户体验概念 - 然后技术解决方案要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T14:14:10.410

我以前使用过的一个非常简单的方法是在注册表中添加一个使用 CSS 隐藏的附加输入（即具有显示：无）。大多数表单机器人会填写此字段，而人类不会（因为它不可见）。然后，在您的服务器端代码中，您可以拒绝任何填充了输入的 POST。

# git - 更改 git repo 的远程，丢失一些数据？

> ID：12805734
> 
> 赞同：3
> 
> 时间：2012-10-09T17:59:41.877
> 
> 标签：git

我有一个使用 BitBucket 在线的 git repo。大约是。大小为 31 MB。我决定把它搬到一个新的地方。所以我创建了一个新的远程仓库，一个空的。

然后我将旧的 repo 克隆到我的计算机上，将远程 URL（在 .git/config 中）更改为我刚刚创建的空 repo 的新位置，然后我用这行代码检查了所有分支：

```
for remote in `git branch -r | grep -v master `; do git checkout --track $remote ; done 
```

完成后，我运行：

```
git push --all 
```

在所有这些上传之后，我检查了新的 repo，正如预期的那样，所有的源似乎都在那里，所有的分支也都在那里。

但是新的 repo 大小只有 8.5 MB。

我所有的内容似乎都在那里，但一定是忘记了给我超过 20MB 的释放空间。

在这个过程中可能遗漏了什么？

* * *

**细节**

克隆我的“苗条”回购，这里有一些统计数据，正在运行`git count-objects -v`：

```
count: 0
size: 0
in-pack: 4727
packs: 1
size-pack: 7998
prune-packable: 0
garbage: 0 
```

原始仓库的新克隆给了我这个：

```
count: 0
size: 0
in-pack: 4727
packs: 1
size-pack: 7945
prune-packable: 0
garbage: 0 
```

`size-pack`实际上比原始的 31MB 存储库更小

澄清一下，当我说大小不同时，在磁盘上我有 18.8MB 和 18.7MB，但在 BitBucket 上，概述页面报告的是 31MB 和 8.5MB。这会改变什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:25:15.453

尝试在本地存储库上运行 git gc，它可能会变小而不会丢失任何东西。（垃圾除外：D）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T22:19:46.953

有一个关于[如何比较两个本地存储库](https://git.wiki.kernel.org/index.php/GitTips#How_to_compare_two_local_repositories)的 Git 提示：

或者这可能会有所帮助：[获取两个存储库之间的差异](https://stackoverflow.com/questions/1968512/git-getting-the-difference-between-two-repositories)

# php - 创建将从 url 中提取图像名称的 javascript RegEx

> ID：12805737
> 
> 赞同：3
> 
> 时间：2012-10-09T17:59:53.580
> 
> 标签：php, javascript, regex

我希望你能帮助我创建一个正则表达式，它将从 URL 中提取图像名称。几天来我一直在尝试创建正则表达式，但我无法让它工作。

**案例：** 我有一个使用 phpThumb 创建的图像 url，如下所示： `\bla\thumb\phpThumb.php?src=/bla/images/thisistheimage.jpg&amp;fltr[]=wmt|40|B|FFFFFF|georgia.ttf|35&amp;hash=b7412f04f09cd6b488435231651d61453`

不，我需要提取以下内容：**thisistheimage.jpg**

一些事实：

*   图像名称前总是有一个“ **/** ”；
*   图像名称后始终跟一个 amp ( **&** )；
*   图片扩展名也可以是：jpeg、JPG、png、PNG、gif；

我设法抓住的只是图像扩展名`(?:png|jpg|gif)`。

你能帮我在这种情况下我必须使用什么正则表达式吗？

我可以在 javascript 或 PHP 中使用正则表达式，你在哪里推荐它？（我使用 javascript 提交表单，表单操作是在 PHP 中完成的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:02:58.707

```
/\/([A-Z0-9_-]{1,}\.(?:png|jpg|gif|jpeg))/i 
```

我认为这应该有效。i 标记不区分大小写

*   匹配斜线 /
*   字母数字、,*和 - 一个或多个 [A-Z0-9* -]{1,}
*   时期 。
*   扩展名 (?:png|jpg|gif|jpeg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:06:16.377

既然你已经标记了[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")，为什么不通过`document.images`并获得你想要的图像呢？

像这样：

```
// add a proxy to all images in the page

var proxy = 'https://proxytea.appspot.com/'

for (var x=0; x<document.images.length; x++) {
    imagem = document.images[x];
    imagem.src = imagem.src.replace(location.protocol + '//', proxy);
} 
```

# php - PHP curl从图像创建函数上传

> ID：12805739
> 
> 赞同：0
> 
> 时间：2012-10-09T18:00:02.707
> 
> 标签：php, image, post, curl, multipart

如何通过图像创建函数（imgpng、imagecreatefromstring、..）使用 curl 上传图像

这就是我目前在没有创建功能的情况下正常执行的方式

```
curl_setopt($ch, CURLOPT_POST, true);
$post = array(
  "Filedata"=>"@{$file_location}"
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post); 
```

如何使用图像功能做同样的事情，让我们说`imagecreatefromstring(file_get_contents($image_link));`
并将其与 curl 链接，**而无需保存文件**，直接通过功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:08:14.770

```
$data = curl_exec($ch);
imageceratefromstring($data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:26:59.770

这里是[如何](https://stackoverflow.com/questions/3085990/post-a-file-string-using-curl-in-php)。请注意，在代码中，您可以避免任何编码，只需像这样使用它：

```
$postFields['my_image'] = someFunctionForCreatingImage(); 
```

# facebook-graph-api - Facebook SDK 3.1 - 错误：HTTP 状态代码：400

> ID：12805743
> 
> 赞同：6
> 
> 时间：2012-10-09T18:00:11.863
> 
> 标签：facebook-graph-api, facebook-ios-sdk

我收到以下错误（“错误：HTTP 状态代码：400”），因为我已于昨天 10 月 9 日更新到 facebook SDK 3.1。但就与 facebook 的连接而言，一切都完全正常，每次我在我的应用程序上启动 facebook 会话时，我都会看到这个错误消息。我看到一些人对此发表评论，但我无法从他们那里确定这是否会成为一个真正的问题。有谁确切地知道这是否会导致问题？如果是这样，如何解决？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T11:04:25.690

最初的问题在 3.1 SDK 发布后由 Facebook 解决。

但是有些仍然有问题，如果您遇到此问题，您应该检查登录流程，并查看 facebooks 示例，然后如果您仍然遇到问题，这可能是解决方案的提示。

当我无权获取我的信息时，我收到了 400 错误。奇怪的是，我得到了一个 accessToken，甚至是一个有效的登录名（这是因为我在根据 Scrumptious 示例的帮助下构建了我的代码，并在会话状态打开时进行了有效的登录）。

FBSessionState 仅打开一秒钟，然后更改为关闭并出现 400 错误。

使用 iOS6 本地登录，您会在请求时收到权限警报，然后手机会在 24 小时内记住该选择。但是，如果用户登录到 facebook 主页然后删除应用程序的权限，手机将不会识别用户已删除权限 24 小时，因为它记得手机已经询问并批准了它（ 24 小时窗口内），无论您是否重新安装应用程序。

经过几个小时的调试，我发现了这一点，因为我从 iOS 的“设置”中允许了该应用程序，但我无法发布，并且因为我从 facebook 隐私中删除了权限，并且警报不会再次显示，所以我无能为力只能通过调试工具手动授予我权限或等待 24 小时，以便我可以再次接受 facebook 权限警报。

# spring - WSServletContainerInitializer 和 SpringBeanAutowiringSupport

> ID：12805745
> 
> 赞同：4
> 
> 时间：2012-10-09T18:00:25.420
> 
> 标签：spring, jax-ws, tomcat7

关于上述类，我有一些集成问题，但仅限于“太新”的 tomcat 版本。

基本设置：web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
                             http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    id="FooService" version="2.5" metadata-complete="true">

    <display-name>FooService</display-name>

    <servlet>
        <servlet-name>jax-ws</servlet-name>
        <servlet-class>com.sun.xml.ws.transport.http.servlet.WSServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            classpath:/applicationContext.xml
        </param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <listener>
        <listener-class>com.sun.xml.ws.transport.http.servlet.WSServletContextListener</listener-class>
    </listener>
</web-app> 
```

FooServiceImpl：

```
@WebService(serviceName = ServiceInfo.SERVICENAME, targetNamespace = ServiceInfo.TARGETNAMESPACE, endpointInterface = "bar.FooService")
@HandlerChain(file = "/handler-chain.xml")
public class FooServiceImpl extends SpringBeanAutowiringSupport implements FooService {

    @Autowired
    private Bar bar;

    << some methods using the injected bar singleton >> 
```

JAX-WS 依赖：编译 'com.sun.xml.ws:jaxws-rt:2.2.7' Spring 版本：3.1.2.RELEASE

使用 Tomcat 7.0.22 我没有问题。web.xml 中声明的 webapp 版本是 2.5。Tomcat 7.0.22 不处理 WSServletContainerInitializer。因此，正如 web.xml 中所声明的，首先初始化 ContextLoaderListener，因此在 WebApplicationContext 中将提供一个 Bar 的实例。然后 WSServletContextListener 实例化 FooServiceImpl，自动布线工作，每个人都很高兴。

但是...我的同事用 Tomcat 7.0.30 进行了尝试，但自动装配不起作用（7.0.32 给出了同样的问题，目前这是最新的）。实在不行，因为新的Tomcat版本已经处理了WSServletContainerInitializer，没有考虑到2.5的webapp版本（和metadata-complete="true"）。

我找到了一个可能的解决方案。我注释掉了 web.xml 的主体，将 webapp 版本更改为 3.0 并创建了一个 WebapplicationInitializer：

```
public class MyInitializer implements WebApplicationInitializer {

    @Override
    public void onStartup(ServletContext servletContext) throws ServletException {
        ContextLoader loader = new ContextLoader();
        loader.initWebApplicationContext(servletContext);
    }

} 
```

这对我来说非常有效。但不适用于我的同事......如果他试图运行应用程序，WSServletContainerInitializer 首先触发，这会产生与上述完全相同的布线问题。

显然，我们可以“破解”这个问题，摆脱 SpringBeanAutowiringSupport 并从 getter 或 web 方法或任何类似方式手动注入 Bar。但是 SpringBeanAutowiringSupport 会更清晰，所以如果对上述问题有好的解决方案，我们愿意使用它。

更新：这会导致问题：[https ://issues.apache.org/bugzilla/show_bug.cgi?id=53619](https://issues.apache.org/bugzilla/show_bug.cgi?id=53619)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T08:53:03.753

对我来说，解决方案是在自动装配引用为空时调用以下内容

```
processInjectionBasedOnCurrentContext(this); 
```

我希望它对所有人都有帮助。

# tinymce - tinymce + 本地存储

> ID：12805750
> 
> 赞同：3
> 
> 时间：2012-10-09T18:00:40.640
> 
> 标签：tinymce, local-storage

我的工作有问题。该网站由一家公司管理，他们不想在 TinyMCE 上激活插件自动保存。因此，为了避免人们从 tinyMCE 中丢失文本，我们决定使用 localStorage 来保存工作。我们可以在网站上编写javascripts。无论如何，localStorage 是否将文本保存在 tinyMCE 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T07:42:31.040

是的，这是可能的。

要设置包含编辑器内容的变量，请使用：

```
localStorage.setItem('your_editor_content', tinymce.get('your_editor_id').getContent() ); 
```

您可以使用超时或其他 tinymce 事件以这种方式将内容存储到 localStorage。

在编辑器初始化时设置localStorage中内容的编辑器内容

```
function myCustomOnInit() {
        var content =  localStorage.getItem('your_editor_content');
        tinymce.get('your_editor_id').setContent(content)
}

tinyMCE.init({
        ...
        oninit : myCustomOnInit
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-11T06:43:18.103

只需在 tinymce.init 中添加以下代码

设置：功能（编辑）{

```
 ed.onChange.add(function() {
            localStorage.setItem(key, tinymce.get('id').getContent());
      }); 
```

}

如果 RTE 中的任何值发生更改，它将存储在本地存储中，然后您可以使用密钥获取相同的值。

# magento - 我需要一个 Magento 页面，可用于按 sku / 产品 ID 和数量快速购买

> ID：12805752
> 
> 赞同：1
> 
> 时间：2012-10-09T18:00:42.703
> 
> 标签：magento, shopping-cart, product

在 Magento 中，我需要一个使用产品 sku 或 id 和数量来购买产品的页面。

例如，我想要一个页面：

2 个输入和 1 个提交按钮。一种用于输入产品 id/sku，一种用于输入产品数量。提交后，它将带我到 Magento 购物车页面进行进一步处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:46:39.417

您需要查看 Magento Connect，解决方案很少，例如查看这个[http://www.magentocommerce.com/magento-connect/fast-order-add-to-cart-by-sku-6156.html](http://www.magentocommerce.com/magento-connect/fast-order-add-to-cart-by-sku-6156.html) .

# css - Rails 中数字的 Excel 样式条件格式

> ID：12805756
> 
> 赞同：3
> 
> 时间：2012-10-09T18:00:56.897
> 
> 标签：css, ruby, ruby-on-rails-3, formatting, conditional

我正在编写一个销售应用程序，其中项目的 :savings 属性范围从 0 到 100 (%)。我希望将显示该属性的单元格的背景颜色设置为有条件的颜色，就像您在 Excel 中所做的那样。

Excel 条件格式的基本思想是它计算出您正在处理的范围 (0-100)，当您为每个极端分配一种颜色时，它会自动计算出项目之间的颜色应该是什么。所以 100 可能是鲜绿色，80 淡绿色，60 黄色，40 橙色，20 淡红色，0 鲜红色。等等。

我想我可以在详尽的意义上弄清楚如何做到这一点——只需创建一个助手，为 0 到 100 之间的每个整数可能性分配一个具有不同十六进制背景颜色的 CSS 类。但这似乎非常低效，我交叉手指寻求某种 Rails 技术、宝石或预先存在的帮助程序，可以使这更容易和更优雅。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:06:20.897

我编写了一个 jQuery 插件来执行此操作： [jQuery Hottie](https://github.com/DLarsen/jquery-hottie)。我用过很多次。似乎是在 Rails 中做这件事的一个很好的选择。

[JSFiddle 示例](http://jsfiddle.net/hnSBm/)。

传入自定义颜色数组以将高/中/低值映射到特定颜色是相当简单的。

# asp.net-mvc - 异步在我的页面上不起作用

> ID：12805762
> 
> 赞同：1
> 
> 时间：2012-10-09T18:01:26.100
> 
> 标签：asp.net-mvc, asp.net-ajax

我正在使用剃须刀引擎来构建我的页面。我想从我的数据库中选择项目并让它异步显示。每次单击该链接时，它都会显示来自数据库的正确结果，但会将部分视图加载到另一个页面而不是同一页面中。LoadingElementId="progress" 也不显示

我的索引页面中的相关代码

```
@Ajax.ActionLink("Click to view product List","Reviewed", new AjaxOptions
        {
            UpdateTargetId = "_LatestReview",                   
            InsertionMode = InsertionMode.Replace,
            HttpMethod="GET",
            LoadingElementId="progress"
        })

<div id="_LatestReview">

</div> 
```

Home 控制器的局部视图

```
public PartialViewResult Reviewed()
        {
            Thread.Sleep(10000);
            var reviewed = ctx.Items.ToList();
            return PartialView("_LatestReview",reviewed);
        } 
```

视图的局部视图

```
@model IEnumerable<BigDream.Item>

<div >
<table>
<tr>
    <th>
        Item_ID
    </th>
    <th>
        Item_name
    </th>
    <th>
        Item_Value
    </th>
    <th>
        image_url
    </th>

    <th>
        Item_Description
    </th>
    <th>
        Category_ID
    </th>
    <th></th>
</tr>

@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.Item_ID)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Item_name)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Item_Value)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.image_url)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Item_Description)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Category_ID)
    </td>

</tr> 
```

}

我觉得这个问题与页面生命周期有关，我不知道该怎么做。有人可以帮我解决这个问题吗

# asp.net - ASP .Net 成员和成员类

> ID：12805763
> 
> 赞同：0
> 
> 时间：2012-10-09T18:01:27.103
> 
> 标签：asp.net, aspnetdb

几个问题：

我在 app_data 文件夹下创建了一个数据库。无论如何将此数据库与同一个文件夹下的现有 aspnetdb 相关联？如果是这样，有人可以指导我吗？

如果不是，那么在 APP_CODE 文件夹下创建我自己的数据库的最佳方法是什么，该文件夹也将利用 asp .net 成员资格？我的意思是我可以在代码中检查用户名和角色（如果 User.IsinRole("........") 等，并使用项目内的图标打开会员页面并添加/修改/删除用户？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:05:20.973

您可以创建一个 MembershipProvider。[代码项目Custom Membership Providers](http://www.codeproject.com/Articles/165159/Custom-Membership-Providers)中提供了一个示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:22:14.143

您需要做的就是将连接字符串更改为指向同一个数据库。当然，您必须将架构从一个复制到另一个，以及您需要的任何数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:25:26.510

您可以创建自定义`Membership Provider`，因为您有自定义数据库，而不是使用 aspnet_regsql 生成的数据库。

```
public class CustomMembershipProvider : MembershipProvider
{   
    public override MembershipUser CreateUser(string username, 
       string password, string email, string passwordQuestion, 
       string passwordAnswer, bool isApproved, 
       object providerUserKey, out MembershipCreateStatus status)
    {
        throw new NotImplementedException();
    }

    public override MembershipUser GetUser(string username, bool userIsOnline)
    {
        throw new NotImplementedException();
    }

    public override bool ValidateUser(string username, string password)
    {
        throw new NotImplementedException();
    }

    public override int MinRequiredPasswordLength
    {
        get { throw new NotImplementedException(); }
    }

    public override bool RequiresUniqueEmail
    {
        get { throw new NotImplementedException(); }
    }
} 
```

您注册您的会员服务提供商

```
<connectionStrings>
    <add name="ApplicationServices" 
      connectionString="Server=your_server;Database=your_db;
                         Uid=your_user_name;Pwd=your_password;"
      providerName="System.Data.SqlClient" />
</connectionStrings>

<authentication mode="Forms">
  <forms loginUrl="~/Account/LogOn" timeout="2880" />
</authentication>

<membership defaultProvider="CustomMembershipProvider">
  <providers>
    <clear/>
    <add name="CustomMembershipProvider" 
        type="CustomMembership.Models.CustomMembershipProvider"
        connectionStringName="AppDb"
        enablePasswordRetrieval="false"
        enablePasswordReset="true"
        requiresQuestionAndAnswer="false"
        requiresUniqueEmail="false"
        maxInvalidPasswordAttempts="5"
        minRequiredPasswordLength="6"
        minRequiredNonalphanumericCharacters="0"
        passwordAttemptWindow="10"
        applicationName="/" />
  </providers> 
```

# c++ - 比较使用不同分配器的 STL 字符串

> ID：12805771
> 
> 赞同：60
> 
> 时间：2012-10-09T18:02:09.487
> 
> 标签：c++, string, memory-management, stl

我想比较使用**不同分配器**`std::string`分配的 STL 字符串，例如使用*自定义 STL 分配器*的普通字符串。不幸的是，在这种情况下似乎通常`operator==()`不起作用：

```
// Custom STL allocator to allocate char's for string class
typedef MyAllocator<char> MyCharAllocator;

// Define an instance of this allocator
MyCharAllocator myAlloc;

// An STL string with custom allocator
typedef std::basic_string
<
    char, 
    std::char_traits<char>, 
    MyCharAllocator
> 
CustomAllocString;

std::string s1("Hello");
CustomAllocString s2("Hello", myAlloc);

if (s1 == s2)  // <--- ERROR: doesn't compile
   ... 
```

特别是，MSVC10 (VS2010 SP1) 发出以下错误消息：

> 错误 C2678：二进制“==”：未找到采用“std::string”类型的左侧操作数的运算符（或没有可接受的转换）

因此，像这样的*较低级别*（可读性较差）的代码：

```
if (strcmp(s1.c_str(), s2.c_str()) == 0)
   ... 
```

应该使用。

（这在某些情况下也特别烦人，例如，有`std::vector`不同分配的字符串，在这种情况`v[i] == w[j]`下不能使用通常的简单语法。）

这对我来说似乎不是很好，因为自定义分配器改变了请求字符串内存的方式，但是字符串类的*接口*`operator==()`（包括与 比较）独立于字符串分配其内存的特定方式。

我在这里缺少什么吗？在这种情况下是否可以保留 C++ 高级接口和运算符重载？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-09T18:07:12.787

用于[`std::lexicographical_compare`](http://en.cppreference.com/w/cpp/algorithm/lexicographical_compare)小于比较：

```
bool const lt = std::lexicographical_compare(s1.begin(), s1.end(),
                                             s2.begin(), s2.end()); 
```

对于相等比较，您可以使用[`std::equal`](http://en.cppreference.com/w/cpp/algorithm/equal)：

```
bool const e = s1.length() == s2.length() &&
               std::equal(s1.begin(), s1.end(), s2.begin()); 
```

或者，您可以按照您的建议重新使用`strcmp`（或者实际上`memcmp`，因为它具有正确的语义；请记住，C++ 字符串比 C 字符串更通用），这可能会使用一些较低级别的魔法，比如比较整个一次机器字（尽管上述算法也可能因此而专门化）。衡量和比较，我会说。对于短字符串，标准库算法至少可以很好地自我描述。

* * *

基于@Dietmar 下面的想法，您可以将这些函数包装到模板化重载中：

```
#include <string>
#include <algorithm>

template <typename TChar,
          typename TTraits1, typename TAlloc1,
          typename TTraits2, typename TAlloc2>
bool operator==(std::basic_string<TChar, TTraits1, TAlloc1> const & s1,
                std::basic_string<TChar, TTraits2, TAlloc2> const & s2)
{
    return s1.length() == s2.length() &&
           std::equal(s1.begin(), s1.end(), s2.begin());
} 
```

使用示例：

```
#include <ext/malloc_allocator.h>
int main()
{
    std::string a("hello");
    std::basic_string<char, std::char_traits<char>, __gnu_cxx::malloc_allocator<char>> b("hello");
    return a == b;
} 
```

事实上，您可以为大多数标准容器定义这样的重载。您甚至可以在模板上对其进行模板化，但这太极端了。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-10-09T18:33:19.640

该标准仅定义使用同质字符串类型的运算符，即所有模板参数都需要匹配。但是，您可以在定义分配器的命名空间中定义一个合适的相等运算符：依赖于参数的查找将在那里找到它。如果您选择实现自己的赋值运算符，它看起来像这样：

```
bool operator== (std::string const& s0,
                 std::basic_string<char, std::char_traits<char>, MyCharAllocator> const& s1) {
    return s0.size() == s1.size() && std::equal(s0.begin(), s0.end(), s1.begin()).first;
} 
```

（加上一些其他的重载）。将此提升到一个新的水平，甚至可以根据容器要求定义各种关系运算符的版本而不限制模板参数：

```
namespace my_alloc {
    template <typename T> class allocator { ... };
    template <typename T0, typename T1>
    bool operator== (T0 const& c0, T1 const& c1) {
        return c0.size() == c1.size() && std::equal(c0.begin(), c0.end(), c1.end);
    }
    ...
} 
```

显然，操作符可以被限制在特定的容器类型中，不同之处仅在于它们的分配器模板参数。

关于为什么标准没有定义混合类型比较，不支持混合类型比较的主要原因可能是您实际上不想首先在程序中混合分配器！也就是说，如果您需要使用分配器，您将使用封装动态多态分配策略的分配器类型，并始终使用生成的分配器类型。这样做的原因是，否则您将获得不兼容的界面，或者您需要将所有内容都制作为模板，即，您希望保留某种级别的正在使用的词汇类型。当然，即使只使用一种额外的分配器类型，您也会有两种词汇字符串类型：默认实例化和特殊分配的实例化。

也就是说，不支持混合类型比较还有另一个潜在的原因：如果`operator==()`真的成为两个值之间的比较，就像分配器不同的情况一样，它可能会引发更广泛的值相等定义：应该`std::vector<T>() == std::deque<T>`支持吗？如果不是，为什么在具有不同分配器的字符串之间进行比较是特殊的？当然，分配器是一个不显着的属性，`std::basic_string<C, T, A>`它可能是忽略它的好理由。我不确定是否应该支持混合类型比较。`operator==()`对于仅在分配器类型上有所不同的容器类型，支持运算符（这可能扩展到除 之外的其他运算符）可能是合理的。

# javascript - 如何从子类调用超类中的 getter/setter？

> ID：12805777
> 
> 赞同：2
> 
> 时间：2012-10-09T18:02:45.837
> 
> 标签：javascript

我想从子类 Camera 中的覆盖设置器中调用超类 SceneNode 中的设置器“转换”。

这些类看起来像这样：

场景节点：

```
function SceneNode(){
    this._transform = M4x4.I;
}

SceneNode.prototype.__defineSetter__("transform", 
    function(transform){
        this._transform = transform;
    }       
);

SceneNode.prototype.__defineGetter__("transform", 
    function(){
        return this._transform;
    }   
); 
```

相机：

```
function Camera(){

}

Camera.prototype = new SceneNode();
Camera.base = SceneNode.prototype;

Camera.prototype.__defineSetter__("transform",
    function(transform){
        Camera.base.transform.call(this, transform);
        this.updateViewMatrix();
    }       
);

Camera.prototype.__defineGetter__("transform", 
    function(){
        return this._transform;
    }   
); 
```

这不起作用，因为“Camera.base.transform”没有根据 Firefox 定义。我以前叫“Camera.base.setTransform.call(this, transform);” 之前，这行得通，但是自从我了解了 setter 和 getter 后，我试图摆脱 setXXX 函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T22:44:28.493

getter 和 setter 隐藏了底层的功能，所以需要一种绕过属性直接获取 setter 的方法。（它是未定义的，因为它实际上正在访问 'getter 的返回值`SceneNode.prototype`，它没有从中获取值的实例。）对应的[`__defineSetter__`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineSetter)是[`__lookupSetter__`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/lookupSetter)：

```
Camera.prototype.__defineSetter__("transform",
    function(transform){
        Camera.base.__lookupSetter__("transform").call(this, transform);
        this.updateViewMatrix();
    }
); 
```

但是这些方法已被弃用，因此正确的（ECMAScript 5）方法是使用[`Object.defineProperty`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)and [`Object.getOwnPropertyDescriptor`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor)：

```
Object.defineProperty(Camera.prototype, 'transform', {
    set: function(transform){
        Object.getOwnPropertyDescriptor(Camera.base, 'transform').set.call(this,
                transform);
        this.updateViewMatrix();
    },

    get: function(){
        return this._transform;
    }
}); 
```

# c# - 使用反射设置索引属性的值

> ID：12805792
> 
> 赞同：3
> 
> 时间：2012-10-09T18:03:45.340
> 
> 标签：c#, sharepoint, reflection, indexed-properties, sharepoint-userprofile

我尝试使用反射复制以下 c# 代码：

```
UserProfileManager userProfileManager = new UserProfileManager(ServerContextGoesHere);
UserProfile userProfile = null;

userProfile = userProfileManager.GetUserProfile(@"somedomain\someuser");

userProfile["PictureUrl"].Value = "This is where I want to update the value using reflection!";

userProfile.Commit(); 
```

使用反射我可以让一切工作，除了我试图在 UserProfile 对象上设置“PictureUrl”索引属性的行。使用反编译器时，该索引属性如下所示：

```
public UserProfileValueCollection this[string strPropName] 
```

这是我使用反射实现与上述相同的事情的代码，请注意我需要设置 PictureUrl 索引属性值的 TODO 注释：

```
 Assembly userProfileAssembly;

    var windowsFolderPath = Environment.GetEnvironmentVariable("windir");
    var pathToServerAssembly = string.Format(@"{0}\assembly\GAC_MSIL\Microsoft.Office.Server.UserProfiles\14.0.0.0__71e9bce111e9429c\Microsoft.Office.Server.UserProfiles.dll", windowsFolderPath);

    try
    {
        userProfileAssembly = Assembly.LoadFrom(pathToServerAssembly);
    }
    catch (FileNotFoundException)
    {
        // Assembly wasn't found, so eject.
        return;
    }

    var userProfileManagerClass = userProfileAssembly.GetType("Microsoft.Office.Server.UserProfiles.UserProfileManager");
    if (userProfileManagerClass == null) return;

    var userExistsMethod = userProfileManagerClass.GetMethod("UserExists");
    if (userExistsMethod == null) return;

    var getUserProfileMethod = userProfileManagerClass.GetMethod("GetUserProfile", new[]{typeof(string)});
    if (getUserProfileMethod == null) return;

    var instantiatedUserProfileManagerClass = Activator.CreateInstance(userProfileManagerClass);
    var result = (bool)userExistsMethod.Invoke(instantiatedUserProfileManagerClass, new object[] { SPContext.Current.Web.CurrentUser.LoginName });

    if (!result) return;

    var userProfileClass = userProfileAssembly.GetType("Microsoft.Office.Server.UserProfiles.UserProfile");
    var userProfile = getUserProfileMethod.Invoke(instantiatedUserProfileManagerClass, new object[] { SPContext.Current.Web.CurrentUser.LoginName });

    //userProfile["PictureUrl"].Value = userPictureUrl;
    //TODO: HOW DO I SET THE PICTUREURL PROPERTY USING REFLECTION?

    var commitMethod = userProfileClass.GetMethod("Commit");
    commitMethod.Invoke(userProfile, null); 
```

提前致谢，

瑞安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:15:08.780

假设您只有一个索引器`UserProfile`：

```
PropertyInfo indexProperty = typeof(UserProfile)
    .GetProperties()
    .Single(p => p.GetIndexParameters().Length == 1 && p.GetIndexParameters()[0].ParameterType == typeof(string)); 
```

您现在可以获取索引器的值并设置其`Value`属性：

```
object collection = indexProperty.GetValue(userProfile, new object[] { "PictureUrl" });

PropertyInfo valueProperty = collection.GetType().GetProperty("Value");
valueProperty.SetValue(collection, userPictureUrl, null); 
```

如果您有多个匹配的索引属性，您可以通过以下方式找到它：

```
PropertyInfo indexProperty = (from p in t.GetProperties()
                              let indexParams = p.GetIndexParameters()
                              where indexParams.Length == 1 && indexParams[0].ParameterType == typeof(string)
                              select p).Single(); 
```

# r - 使用 AR(1) 项的 OLS 估计

> ID：12805793
> 
> 赞同：1
> 
> 时间：2012-10-09T18:03:46.213
> 
> 标签：r

由于我无法解释的原因（因为我不能，不是因为我不想），我办公室使用的流程需要在 Eviews 上运行一些回归。

Eviews 上使用的方程规范是：

```
dependent_variable c independent_variable ar(1) 
```

此外，使用的过程是“NLS 和 ARMA”。

我不使用 Eviews，但据我了解，该方程表示具有常数、一个自变量和 AR(1) 项的 OLS 回归。我尝试在 R 中运行它：

```
result <- lm(df$dependent[2:48] ~ df$independent[1:47] + df$dependent[1:47]) 
```

其中 df 是包含因变量和自变量（均跨越 48 个观测值）的 data.frame。

我做对了吗？因为参数估计虽然相似，但在 Eviews 中是不同的。足够不同，我无法使用它们。

我已经在互联网上彻底搜索了这意味着什么。我已经阅读了 ARIMA 和 ARMAX 模型，但我认为不是这样。对不起，我对统计知识并不了解。顺便说一句，估计 ARMAX 模型似乎非常复杂，并且是由 ML 完成的，而不是 LS，所以我真的希望不是这样。

编辑：我不得不再次编辑模型索引*，*因为我又把它们搞砸*了*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:08:24.803

您需要`arima`功能，请参阅`?arima`

一些数据的例子

```
y <- lh  # lh is Luteinizing Hormone in Blood Samples in datasets package (Base)
set.seed(001)
x <- rnorm(length(y), 100, 10)
arima(y, order = c(1,0,0), xreg=x)

Call:
arima(x = y, order = c(1, 0, 0), xreg = x)

Coefficients:
         ar1  intercept       x
      0.5810     1.8821  0.0053
s.e.  0.1153     0.6991  0.0068

sigma^2 estimated as 0.195:  log likelihood = -29.08,  aic = 66.16 
```

请参阅`?arima`以查找有关其论点的帮助。

# android - 如何在 Android 4.0.3 中以编程方式接听电话？

> ID：12805796
> 
> 赞同：0
> 
> 时间：2012-10-09T18:03:58.190
> 
> 标签：android, broadcastreceiver, adb, runtime.exec

因此，正如主题所述，我需要能够在 HTC OneX 上的 Android 4.0.3 中以编程方式接听电话。我已经阅读了几个地方的`MODIFY_PHONE_STATE`许可已被谷歌撤销，所以要完成这项任务，你需要解决这个问题。

到目前为止，我已经研究了两种途径：

(1) 关注 Guy 的帖子[并](https://stackoverflow.com/questions/11648587/incoming-call-auto-answer-in-android-4-0-3/11722866#comment17316838_11722866)使用 BroadcastReceiver

(2) 使用下面的代码尝试通过shell命令点击一个按键事件。

```
final Runtime r = Runtime.getRuntime();
    try {
        Process process = r.exec("input keyevent 5");
        InputStream stream = process.getErrorStream();
        log.v("Process Error Stream: " +stream.toString());
        log.v("Sending shell command to Answer Call");
    } catch (Exception e) {
        log.v("Stack Trace: " + e.getStackTrace().toString());
        e.printStackTrace();
    } 
```

我使用它是因为 keyevent 5 是根据 Google 的 KeyEvent.CALL 并且它在 adb 中使用

```
adb shell input keyevent 5 
```

我的问题是，我做错了什么？因为从逻辑上讲，这两种方法都是有意义的，但它们都不起作用，甚至都不会产生任何类型的运行时错误。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-10T15:58:25.383

经过几天的研究，我发现同时使用广播接收器路由和`runtime.exec()`路由在 Android 4.0.3 中使用 Android API 根本不可能接听电话。

`adb`对于那些仍然想知道的人，我确实找到了一些有用的信息...您可以通过使用命令来接听电话`adb shell input keyevent 5`5 是通话按钮的键码，在 Android 中它是`KEYEVENT_CALL`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T14:51:13.037

这适用于 Android 2.2 到 4.0，现在在将 try catch 添加到最后一行后，它适用于 4.1.2 和 4.2 坦率地说不知道它是如何工作的，但它对我有用。

> ```
>  Log.d(tag, "InSecond Method Ans Call");
>     // froyo and beyond trigger on buttonUp instead of buttonDown
>     Intent buttonUp = new Intent(Intent.ACTION_MEDIA_BUTTON);
>     buttonUp.putExtra(Intent.EXTRA_KEY_EVENT, new KeyEvent(
>             KeyEvent.ACTION_UP, KeyEvent.KEYCODE_HEADSETHOOK));
>     sendOrderedBroadcast(buttonUp, "android.permission.CALL_PRIVILEGED"); 
> ```

```
 Intent headSetUnPluggedintent = new Intent(Intent.ACTION_HEADSET_PLUG);
    headSetUnPluggedintent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY);
    headSetUnPluggedintent.putExtra("state", 0);
    headSetUnPluggedintent.putExtra("name", "Headset");
    try {
        sendOrderedBroadcast(headSetUnPluggedintent, null);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

这在 Android 4.1.2 中对我有用，并且我已经在 4.2 上进行了测试。这仍然会给出一个已处理的异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T18:22:50.273

这里有几个有用的链接，检查它们：

1.  [自动接听来电](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/9oXZVihlaMI)
2.  [如何以编程方式自动接听电话](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/FnpCpPcAgrM)
3.  [自动应答](http://code.google.com/p/auto-answer/source/browse/trunk/src/com/everysoft/autoanswer/AutoAnswerIntentService.java)

# c# - 从类库程序集中设置 ASP.NET 页面控件

> ID：12805798
> 
> 赞同：0
> 
> 时间：2012-10-09T18:04:00.740
> 
> 标签：c#, asp.net, mvp

我对 ASP.NET 网站使用模型视图演示器方法。演示部分在单独的类库中编译，其中定义了视图契约和演示者：

```
MyPresentation assembly
IMyView
{
     DisplayText(string text);
}
MyPresenter
{
     public IMyView View { get; set; }
     public DisplayText()
     {
         string text = Generate();
         View.DisplayText(text);   
     } 
}

MyWebApplication assembly
public partial class MyForm : System.Web.UI.Page, IMyView
{
    public void DisplayText(string text)
    {
        this.myLabel.Text = text;  
    }
    ...
    protected void myButton_Click(object sender, EventArgs e) 
    {
        Presenter.DisplayText(); // calls this.DisplayText()     
    }        
} 
```

但是，在退出`Presenter.DisplayText()`Text 属性后，`myLabel`再次变为 null，就好像没有完成任何分配一样。`myButton`无论如何，如果您将单击事件中的唯一行替换为直接设置`myLabel`Text 属性，则所有内容都将保持分配状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:23:15.973

该`Generate`方法是否返回非空字符串？在这种情况下，这似乎是唯一的罪魁祸首。它也可以解释为什么设置`myLabel`直接起作用。

要进行诊断，请将文字字符串传递给`View.DisplayText`而不是调用`Generate`.

# php - 用php在变量名中使用变量内容？

> ID：12805799
> 
> 赞同：1
> 
> 时间：2012-10-09T18:04:03.770
> 
> 标签：php, variables, syntax

> **可能重复：**
> [将变量的值附加到变量名？](https://stackoverflow.com/questions/1774975/appending-a-value-of-a-variable-to-a-variable-name)

我根本无法弄清楚语法，并进行了广泛的搜索。

我想这样做：

```
$uni = "ntu";
$selectedntu = "something";

echo $selected$uni;
// output should be the same as
echo $selectedntu; 
```

换句话说，我想使用第二个变量 $uni 的内容来加入第一个变量的名称。$selectedntu 已经设置了一个 foreach 循环，但我不知道如何在 php.ini 中同时引用这两个变量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:05:46.620

构造字符串并使用变量变量`$$`

```
$uni = "ntu";
$selected = "something";

$new_variable = $selected . $uni; 
echo $$new_variable; 
```

// 或者..根据你的 googleing..纯粹供以后参考

```
$uni = "ntu";
$selected = "something";

echo ${$selected . $uni}; 
```

# clojure - clojure quote-paren `( ... ) 宏的问题

> ID：12805800
> 
> 赞同：7
> 
> 时间：2012-10-09T18:04:05.880
> 
> 标签：clojure, macros, quote, parentheses

为了练习，我定义了

```
(defmacro quote-paren
  "body -> `(body)"
  [& body]
  `(~@body)) 
```

它具有预期的转换`(quote-paren body)`=> ``(body)`。它似乎满足了一些基本测试：

```
user=> (macroexpand-1 `(quote-paren 3 4 5))
(3 4 5)
user=> (macroexpand-1 `(quote-paren println "hi"))
(clojure.core/println "hi") 
user=> (macroexpand-1 `(quote-paren (println "hi")))
((clojure.core/println "hi")) 
```

但是，我一直在使用这个 do-while 宏（从[此处](https://stackoverflow.com/a/8676342/1732572)修改）对其进行测试：

```
(defmacro do-while
  [test & body]
  (quote-paren loop [] 
    ~@body
    (when ~test
      (recur))))

(def y 4)
(do-while (> y 0)
  (def y (dec y))) 
```

但结果是

```
IllegalStateException Attempting to call unbound fn: #'clojure.core/unquote-splicing  clojure.lang.Var$Unbound.throwArity (Var.java:43) 
```

我不明白这一点，因为从我可以看到“quote-paren”宏工作正常（插入〜@body）：

```
user=> (macroexpand-1 
         `(quote-paren loop [] 
            (def y (dec y))
            (when ~test
              (recur))))

(clojure.core/loop [] (def user/y (clojure.core/dec user/y)) (clojure.core/when #<core$test clojure.core$test@1f07f672> (recur))) 
```

但是尝试进行宏扩展`do-while`会导致“ `unbound fn`”。我错过了什么微妙的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:36:36.757

之前缺少语法引用`quote-paren`

```
user> (defmacro do-while
  [test & body]
  `(quote-paren loop [] 
    ~@body
    (when ~test
      (recur))))
#'user/do-while 
```

然后正确扩展：

```
user> (macroexpand '(do-while (> y 0)
                      (def y (dec y))))
(loop* [] (def y (dec y)) (clojure.core/when (> y 0) (recur))) 
```

并且似乎有效：

```
user> (def y 4)
#'user/y
user> (do-while (> y 0)
  (def y (dec y)))
nil
user> 
```

# windows - 带有 64 位 Outlook 的 32 位 MAPI 应用程序

> ID：12805802
> 
> 赞同：5
> 
> 时间：2012-10-09T18:04:22.063
> 
> 标签：windows, outlook, mapi, mapisendmail

我们的应用程序的 32 位版本无法在`MAPISendMail`安装了 64 位 Outlook 的情况下发送电子邮件。它返回一个错误 0x80004005，除了它似乎是一个 MAPI 初始化错误之外，我几乎找不到关于它的信息。

根据[这个 MSDN 文档](http://msdn.microsoft.com/en-us/library/dd941355%28office.14%29.aspx)，`MAPISendMail`是 32 位应用程序不能使用 64 位 MAPI 规则的一个例外。然而它不起作用（至少在 XP 和 Vista 上——我们还没有测试过 Win7/8）。

任何人都可以对此有所了解吗？

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:27:05.547

没有例外：32 位进程无法加载 64 位 dll。当您拥有 64 位版本的 Outlook 时，64 位版本的 mapi32.dll 包含实际实现。mapi32.dll 的 32 位版本是一个存根，它只返回一个错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-18T11:49:03.863

这不是完全正确的@DmitryStreblechenko， - 至少不是`MAPISendMail`功能。为此，也只有为此，才有可能建立一个“Outlook64 Bridge”。这会将 32 位`MAPISendMail`呼叫重定向到 64 位 Outlook。那座桥可能看起来像：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Mail\Outlook64Bridge]
@="Outlook64Bridge"
"DLLPathEx"="c:\\Windows\\winsxs\\x86_microsof t-windows-mapi_31bf3856ad364e35_6.1.7600.16385_none_ab239772 7b134496\\MAPI32.DLL"
"DLLPath"="c:\\Windows\\winsxs\\x86_microsoft-windows-mapi_31bf3856ad364e35_6.1.7600.16385_none_ab239772 7b134496\\MAPI32.DLL" 
```

**重要**，-您首先要检查您的 32 位**路径是否正确**`mapi32.dll`！

将这些行添加到 reg 后，您必须通过以下方式将其设置`Outlook64Bridge`为默认邮件客户端：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Clients\Mail]
@="Outlook64Bridge" 
```

它被证实适用于真正**只**使用*MAPISendMail*功能的简单 32 位应用程序。

更多信息可以在[这里找到](http://www.techtalkz.com/ms-office-help/55384-can-t-send-mail-32-bit-applications-office-2010-64-bit-r.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-20T08:49:24.100

几年前我也有同样的问题。我试了又试，但没有办法……微软阻止了 32 位和 64 位应用程序之间的一些交互：你甚至不能在 32 位应用程序中使用 64 位 OCX/OLE。

上面的*Outlook Bridge*解决方案 (@VMAtm) 在开始时工作，然后微软*修复它*，它停止工作。

最后，我实现了一个 64 位应用程序，我的*桥应用程序*，将主要的 32 位应用程序与 64 位前景连接起来：

1.  主 32 位应用程序正在运行...
2.  主要32位调用桥接64位应用；邮件数据（发件人、收件人、标题、正文...）存储在 xml 文件中。xml 文件通过命令行传递。
3.  64桥应用程序启动，并调用MAPI函数。
4.  64 位 Outlook 完成剩下的工作。

这个解决方案运行良好，我很确定我不必为 MAPI 库而苦恼。

# javascript - 在 HTML 输入字段中禁用复制粘贴？

> ID：12805803
> 
> 赞同：50
> 
> 时间：2012-10-09T18:04:24.540
> 
> 标签：javascript, html, security, passwords, copy-paste

> **可能重复：**
> [使用 Javascript 禁用复制/粘贴到 HTML 表单](https://stackoverflow.com/questions/1226574/disable-copy-paste-into-html-form-using-javascript)

[我的银行](https://www.mizrahi-tefahot.co.il/he/bank/Pages/Default.aspx)似乎禁用了用户名和密码的复制粘贴功能。

它是如何完成的？它提高了安全性吗？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-10-09T18:17:50.847

您可以在输入中禁用粘贴，如下所示：

**html:**

```
<input type="text" value="" id="myInput"> 
```

**javascript:**

```
window.onload = () => {
 const myInput = document.getElementById('myInput');
 myInput.onpaste = e => e.preventDefault();
} 
```

谈到安全性，我不会说这会产生任何影响。您通常会使用客户端和服务器端验证用户提交的数据。

# php - 我想禁用 magento 上的全局消息

> ID：12805805
> 
> 赞同：0
> 
> 时间：2012-10-09T18:04:27.353
> 
> 标签：php, magento, popup

有谁知道如何在 magento 1.12 上禁用全局消息？

我不能让它们按我想要的方式工作，所以我宁愿禁用它们，直到我能让它们正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:50:17.777

我建议您从布局中删除它们。您需要将以下代码放入任何布局 xml 文件中

```
<default>
   <remove name="global_messages" />
   <remove name="messages" />
</default> 
```

# c# - 为什么不更新数据库？

> ID：12805807
> 
> 赞同：1
> 
> 时间：2012-10-09T18:04:30.420
> 
> 标签：c#, asp.net-mvc, linq-to-entities

我有以下代码：

 `````
model = new Option();
model.val1 = newVal1;
model.val2 = newVal2;
model.val3 = newVal3;

//this saves new record just fine
if (recordCount < 1)
{
    context.Options.AddObject(model);
    context.SaveChanges();
}
else
{
    var tempID = from s in context.Options where (s.val1 == newVal1 && s.val2 == newVal2) select s.ID;
    var resultsID = tempID.First();
    model = context.Options.Single(m => m.ID == resultsID);
    if (TryUpdateModel(model, new[] { "val3" }))
    {
       //this isn't updating the record
       context.SaveChanges();
    }
} 
````  `数据库添加了一个新条目就好了，但没有更新它。我错过了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:15:15.867

查看这段代码，首先创建一个新模型并在其上设置一些属性：

```
model = new Option();  // <- A
model.val1 = newVal1;
model.val2 = newVal2;
model.val3 = newVal3; 
```

然后，假设您正在沿着“其他”路径前进，您可以这样做：

```
var tempID = from s in context.Options where (s.val1 == newVal1 && s.val2 == newVal2) select s.ID;
var resultsID = tempID.First();
model = context.Options.Single(m => m.ID == resultsID);  // <- B
if (TryUpdateModel(model, new[] { "val3" }))
{
   //this isn't updating the record
   context.SaveChanges();
} 
```

它出去并找到`context.Options`具有匹配ID的条目。

所以，现在`model`，您通过`new()`调用创建的 （我已用注释“A”标记）现在被抛在了一边，而您得到了另一个 - 您通过调用 检索到的那个`context.Options.Single()`，我已经标有注释“B”。它的属性基于上下文中的内容，而不是您制作的对象中的内容。那个 A 对象现在消失了。您已经从数据库中检索到了一个新对象 B。

所以现在，您在这个检索到的对象上调用 TryUpdateModel，告诉它 val3 已更新，但值没有改变，对吧？这是您从上下文中提取的任何内容。

所以，它不会更新任何东西，因为模型对象不是你认为的那个......你更新的那个正在等待被垃圾收集。您检索的那个尚未更新，因为它仍然具有该属性的任何值`val3`。

假设我遵循您在此处尝试执行的操作，这就是您在上下文中看不到任何更新值的原因。

如果要更改已检索到的`val3`该对象的属性值，则`model`需要在检索后对其进行设置，否则将被覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:19:20.067

如果您使用的是全局上下文，则必须更新上下文本身，因为它不是到数据库的软链接。

```
 context.SaveChanges();
 DbContext context = new DbContext(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:25:01.753

检查是否`Configuration.AutoDetectChangesEnabled = true`；``

# php - 即使 'return false' 运行，删除也不会停止

> ID：12805808
> 
> 赞同：1
> 
> 时间：2012-10-09T18:04:30.793
> 
> 标签：php, jquery, forms, submit, confirm

我已经在我的应用程序中实现了从数据库中删除用户的功能。用户选择用户（复选框）并单击提交。将显示一个确认框，询问用户是否要删除*username*。一切正常，除了如果单击取消，用户仍然会被删除。

为什么会这样以及如何防止它（我检查并**返回错误**运行）

**来自 usercontroller.php：**

```
if ($userView->TriedToRemoveUser()) {
  $userIds = $userView->GetUsersToRemove();

  if ($userIds != 0) {
    $removeTry = $userHandler->RemoveUser($userIds);

    if ($removeTry) {
      $xhtml = \View\UserView::USER_REMOVED;
    }
    else {
      $xhtml = \View\UserView::FAILED_TO_REMOVE_USER;
    }
  }
} 
```

**来自 userview.php：**

```
public function TriedToRemoveUser() {
  if (isset($_POST[$this->_submitRemove])) {
    return true;        
      }
      else {
        return false;
      }
} 
```

**来自 js.file：**

```
$('#form3').submit(function() {
  $('input[type=checkbox]').each(function () {
    if( this.checked ) {
      var username = $(this).attr('user');

      var confirmBox = confirm('Do you really want to remove the user ' + username + ' ?');

      if (!confirmBox) {
        return false;
      }
      }
  });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:07:52.817

`false`从 中返回`.each()`不会停止提交，将该值存储在变量中并返回该变量。

```
$('#form3').submit(function() {
    var submit = true;
    $('input[type=checkbox]').each(function () {
        if( this.checked ) {
            var username = $(this).attr('user');

            var confirmBox = confirm('Do you really want to remove the user ' + username + ' ?');

            if (!confirmBox) {
                submit = false;
                return false;
            }
        }
    });
    return submit;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:21:01.007

（警告：所有代码都在我的脑海中，并且没有经过适当的测试）

假设您正在谈论`return false;`javascript 中的语句：

`return false;`不会阻止提交方法，因为它只是破坏了该方法`.each()`。所有这一切都会停止对复选框的迭代。

尝试类似：

```
$('#form3').submit(function () {
    var doDelete = true;

    $('input[type=checkbox]').each(function () {
       // ...

       if (!confirmBox) {
           doDelete = false;
           return false; // Deletion has been cancelled so there is no need to continue the iteration
       }
    });

    if (!doDelete) {
        return false;
    }
}); 
```

如果用户取消任何选定的用户，这将阻止提交整个表单。如果您打算继续提交任何已确认的用户，您可以尝试以下操作：

```
$('#form3').submit(function () {
    $('input[type=checkbox]').each(function () {
       // ...

       if (!confirmBox) {
           $(this).attr('checked', false); //Uncheck this box so that it isn't submitted
       }
    });
}); 
```

# javascript - 有没有办法检查对框架的访问？

> ID：12805809
> 
> 赞同：2
> 
> 时间：2012-10-09T18:04:32.317
> 
> 标签：javascript, iframe, frame

我想将事件绑定到父窗口中的某些帧。但是如果一个框架有不同的 url，我就无法访问它。有没有办法获取子框架的 url 或检查对它们的访问。我使用这样的方法：

```
for (var i = 0; i<window.frames.length; i++)
{
    try 
    {
        if (window.frames[i].document);
        ...
    } 
    catch (err) 
    {
    }
} 
```

PS我也想知道有没有办法区分window.frames元素中的frame和iframe？

# uitableview - NSFetchedResultsController“乱序部分名称”

> ID：12805813
> 
> 赞同：0
> 
> 时间：2012-10-09T18:04:51.167
> 
> 标签：uitableview, core-data, nsfetchrequest, nsfetchedresultscontroller, magicalrecord

我`MagicalRecord`用来获取我的数据。在我的应用程序中，我有一个联系人列表，这些联系人被分组到联系人组中。我在分组中显示这些联系人组`UITableView`。

例如，我有以下（这是我所期望的）：

```
Default Groups  // section header
[Everyone]      // cell row
[Favourites]    // cell row

My Group        // section header
[Coworkers]     // cell row 
```

有时我的小组会混淆：

```
Default Groups  // section header
[Everyone]      // cell row
[Coworkers]     // cell row

My Group        // section header
[Favourites]    // cell row 
```

我用来排序和分组的每个联系人组名称和组类型。组类型是整数。当我检查他们的属性时，他们实际上确实具有正确的组类型。

我的 FRC 看起来像这样：

```
fetchedResultsController = [ContactGroup fetchAllSortedBy:@"groupName"
                                                ascending:YES
                                            withPredicate:nil
                                                  groupBy:@"groupType"
                                                 delegate:self]; 
```

我看到以下错误：

```
CoreData: error: (NSFetchedResultsController) The fetched object at index 2 has an out of order section name '1\. Objects must be sorted by section name'
+[MagicalRecord(ErrorHandling) defaultErrorHandler:](0x2eefb8) Error: The fetched object at index 2 has an out of order section name '1\. Objects must be sorted by section name'
+[MagicalRecord(ErrorHandling) defaultErrorHandler:](0x2eefb8) Error Message: The operation couldn’t be completed. (Cocoa error 134060.)
+[MagicalRecord(ErrorHandling) defaultErrorHandler:](0x2eefb8) Error Domain: NSCocoaErrorDomain
+[MagicalRecord(ErrorHandling) defaultErrorHandler:](0x2eefb8) Recovery Suggestion: (null) 
```

如果我需要提供更多详细信息，请告诉我，此时我有点难过，不能 100% 确定该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:13:32.170

没用过MagicalRecord，你能设置多个排序标准吗？

我假设它使用 groupBy: 作为部分名称，所以在这种情况下，我将有两个排序描述符，一个用于“groupType”，第二个用于“groupName”。

这将以正确的顺序对部分进行排序，然后在部分内以正确的顺序对所有内容进行排序。

# vb.net - 文件 I/O 功能通常在“Microsoft.VisualBasic”命名空间中可用，但目标平台不支持它

> ID：12805817
> 
> 赞同：-1
> 
> 时间：2012-10-09T18:05:04.643
> 
> 标签：vb.net, visual-studio-2010

我想打开我的 .txt 文件，但出现此错误

错误 1 ​​未声明“打开”。文件 I/O 功能通常在“Microsoft.VisualBasic”命名空间中可用，但目标平台不支持它。

我正在使用 vb2010，我认为代码是错误的，因为它适用于 vb6。如何将其更改为在vb2010中工作？

```
Private Sub zapisz_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles zapisz.Click
    Open "C:\Plik.txt" For Append As #1 'zapis
    print #1, "a" & a.Text 
    Print #1, "b" & b.Text
    Print #1, "c" & c.Text
    Print #1, "d" & d.Text
Close #1 
End Sub

Private Sub wczytaj_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles wczytaj.Click
    Dim strText As String, strIndex As String
Open "C:\Plik.txt" For Input As #1
    Do Until EOF(1)
        Input #1, strText
        strIndex = Left(strText, 1)
        strText = Right(strText, Len(strText) - 1)
        Select Case strIndex
            Case "a" : a = strText
            Case "b" : b = strText
            Case "c" : c = strText
            Case "d" : d = strText
        End Select
    Loop
Close #1
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:40:31.743

.NET 框架中的工具使这类事情比旧的 VB6 文件访问语句更简洁直观：

```
Private Sub zapisz_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles zapisz.Click
    Using writer As New StreamWriter("C:\Plik.txt", True)
        writer.WriteLine("a" & a.Text)
        writer.WriteLine("b" & b.Text)
        writer.WriteLine("c" & c.Text)
        writer.WriteLine("d" & d.Text)
    End Using
End Sub

Private Sub wczytaj_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles wczytaj.Click
    For Each line As String In File.ReadAllLines("C:\Plik.txt")
        Dim index As String = line.Substring(0, 1)
        Dim text As String = line.Substring(1)
        Select Case index
            Case "a"
                a = text
            Case "b"
                b = text
            Case "c"
                c = text
            Case "d"
                d = text
        End Select
    Next
End Sub 
```

# c# - SetEntryInHash 与 SetEntryInHashIfNotExists

> ID：12805818
> 
> 赞同：3
> 
> 时间：2012-10-09T18:05:12.527
> 
> 标签：c#, redis, servicestack

我在几个地方读到 Redis 是幂等的，所以重复调用`SetEntryInHash()`不会有任何效果，对吧？

有什么好的使用案例`SetEntryInHashIfNotExists()`吗？这可以比盲目调用更快的结果`SetEntryInHash()`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:24:43.607

[幂等](http://en.wikipedia.org/wiki/Idempotence)意味着您可以多次重播相同的操作，并且会产生相同的副作用。只有像[SADD](http://redis.io/commands/sadd)这样的幂等操作是幂等的，即在调用 1 次或 1 次以上之后，您最终会得到相同的结果，即集合中的单个项目。

添加到 redis 列表，例如[LINSERT](http://redis.io/commands/linsert)相比之下不是幂等的，因为每个新项目都会向 redis 列表中添加一个新项目。

如果你想知道[ServiceStack 的 Redis Client](https://github.com/ServiceStack/ServiceStack.Redis)中的操作是如何实现的，只需查看源代码即可。[SetEntryInHash 和 SetEntryInHashIfNotExists 在这里](https://github.com/ServiceStack/ServiceStack.Redis/blob/master/src/ServiceStack.Redis/RedisClient_Hash.cs#L51-59)。它们都分别调用[HSET](http://redis.io/commands/HSET)和[HSETNX](http://redis.io/commands/HSETNX)。请参阅 redis 中的文档以了解每个操作的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-10T17:41:28.783

@mythz 是对的，手头有源代码，可以快速找到真正的答案，更不用说还包括指向 redis 文档的链接。我自己对差异感到好奇，并认为我会在这里为其他人发布澄清。

**HSETNX**：***仅当字段尚不存在***时，才将存储在键中的哈希中的字段设置为值。如果 key 不存在，则创建一个包含哈希的新 key。如果字段已存在，则此操作***无效***。

**HSET**：将存储在键中的哈希中的字段设置为值。如果 key 不存在，则创建一个包含哈希的新 key。如果字段已存在于哈希中，***则将其覆盖***。

# css - CSS 两个 div 相互重叠

> ID：12805820
> 
> 赞同：0
> 
> 时间：2012-10-09T18:05:21.980
> 
> 标签：css, html

我试图让两个 div 相互浮动，像这样：

```
__________
|.menutop|
|        |
----------
|.menu   |
|        |
---------- 
```

我该怎么做？我试过：

```
.menutop{
position: absolute;
width:7%;
height:30px;
float:left;
margin-top:97px;

}
.menu{ 
position:relative;
width:7%; 
height:auto; 
float:left;
margin-top:107px;
} 
```

但它使 .menu 位于 .menutop 之上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:08:16.713

您可以将它们放入容器中并使其浮动：

```
<div class="menucontainer" style="float: left">
   <div class="menutop"></div>
   <div class="menu"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:15:33.423

```
.menutop
{
  width:7%;
  height:30px;
  float:left;
  margin-top:97px;
}

.menu
{ 
  clear: left;
  width:7%; 
  height:auto; 
  float:left;
  margin-top:107px;
} 
```

# php - 当用户输入 something.com/myid 作为 url 时，如何显示 something.com/view.php?id=myid 的访问者内容

> ID：12805824
> 
> 赞同：0
> 
> 时间：2012-10-09T18:05:30.177
> 
> 标签：php, apache, url, iis, webserver

当用户输入something.com/myid 作为url 时，如何显示something.com/view.php?id=myid 的访问者内容？请注意，我不希望 url 在用户面前发生视觉变化。我为 apache 找到了一些解决方案，但我猜客户端需要 IIS。让我知道 apache 的解决方案，以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:08:15.017

您必须编辑 .htaccess 文件。看看[这里](http://roshanbh.com.np/2008/03/url-rewriting-examples-htaccess.html)

编辑：没有注意到你提到了 IIS。查看[此处](http://www.iis.net/learn/application-frameworks/install-and-configure-php-applications-on-iis/translate-htaccess-content-to-iis-webconfig)以便将 .htaccess 转换为 Web.Config 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:09:53.283

Mod-rewrite 将解决您的问题

# javascript - 您可以为 Bootstrap 指定一个“数据目标”，它引用同级 DOM 元素而不使用 ID 吗？

> ID：12805825
> 
> 赞同：37
> 
> 时间：2012-10-09T18:05:31.380
> 
> 标签：javascript, twitter-bootstrap, jquery-selectors

我正在向页面动态添加可折叠元素。Bootstrap 使用“data-target”属性来指定折叠切换适用于哪个元素。

从文档：

```
The data-target attribute accepts a css selector 
```

有没有办法编写一个选择器来指定父元素的下一个兄弟？文档中的所有示例似乎都使用 ID 选择。

具体来说，HTML 看起来像：

```
<div class="accordion-group">
<div class="accordion-heading">
  <a class="accordion-toggle" data-toggle="collapse" data-target="#collapseOne">
    Generated Title
  </a>
</div>
<div id="collapseOne" class="accordion-body collapse in">
  <div class="accordion-inner">
    Generated Content... this is big and sometimes needs collapsing
  </div>
</div>
</div> 
```

我想写类似（非法使用jquery语法的伪代码）：

```
<a class="accordion-toggle" data-toggle="collapse" data-target="$(this).parent().next()"> 
```

但我开始怀疑 CSS 选择器可能无法做到这一点。

现在，作为一种解决方法，我在创建元素时生成了一个新的 ID（一个递增的数字附加到一个字符串）。

使用选择器有更好的方法吗？我应该使用一些创建后的 javascript 来设置 data-target 属性吗？为动态内容生成 ID 是标准方法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-09T23:18:55.713

虽然`data-target`属性中的选择器确实是一个 jQuery 选择器，但该插件的 data-api 规范没有提供`this`在执行范围内引用的方法（参见[bootstrap-collapse.js 中的第 147-153 行以](https://github.com/twitter/bootstrap/blob/master/js/bootstrap-collapse.js#L147)了解其使用）。

但是，我想提供另一种替代方法，即使用您自己的自定义切换说明符扩展 data-api。我们称它为**collapse-next**。

### JS ^(（见更新说明）)

```
$('body').on('click.collapse-next.data-api', '[data-toggle=collapse-next]', function (e) {
  var $target = $(this).parent().next()
  $target.data('collapse') ? $target.collapse('toggle') : $target.collapse()
}) 
```

### HTML

```
<a class="accordion-toggle" data-toggle="collapse-next"> 
```

## [JSFiddle（更新）](http://jsfiddle.net/mmfansler/6KffS/)

这里的缺点是它是一种相当紧密耦合的方法，因为 JS 假定了标记的特定结构。

* * *

## 关于 IE 问题的注意事项

正如[@slhck 在他的回答中指出的那样，](https://stackoverflow.com/a/15551027/570918)当使用我的答案的早期版本时，IE9 及以下版本在第一次点击时显然会失败。原因实际上根本不是 IE 问题，而是 Bootstrap 问题。如果调用`.collapse('toggle')`一个`Carousel`对象未​​初始化的目标，该`toggle()`方法将被调用两次——一次在初始化期间，然后在初始化后再次显式调用。这绝对是一个 Bootstrap 错误，希望能得到修复。没有*出现的唯一原因*作为 Chrome、FF、IE10 等中的一个问题，是因为它们都支持 CSS 转换，因此当第二次调用时它会短路，因为第一个调用仍然处于活动状态。上面更新的解决方法只是通过首先检查初始化并以不同方式处理它来避免双重调用问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T14:59:58.493

@merv 的解决方案在 IE9 及更低版本中对我不起作用，因为除非您单击每个项目一次，否则可折叠状态不可用。不过，它在 Firefox 和 Chrome 中运行良好。因此，单击两次后，一切正常。

我所做的是为触发元素设置一个类，然后使用set to`.collapse-next`强制它们的`ul`兄弟姐妹折叠：`toggle``false`

```
$(".collapse-next").closest('li').each(function(){
  if ($(this).hasClass('active')) {
    // pop up active menu items
    $(this).children("ul").collapse('show');
  } else {
    // just make it collapsible but don't expand
    $(this).children("ul").collapse({ toggle: false });
  }
}); 
```

这是为了实际切换菜单状态：

```
$('.collapse-next').click(function(e){
  e.preventDefault();
  $(this).parent().next().collapse('toggle');
}); 
```

似乎使用`data-`属性是一种更现代、更简洁的方法，但对于使用类和 jQuery 的旧浏览器来说似乎也能胜任。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-07-09T10:59:23.997

**没有 javascript**解决方案或解决方案依赖于 bootstrap 的 JS 已经在使用，只是利用 DOM 结构-

见`data-target=""`...

避免笨重的解决方案并且不需要 ID 或额外的 JS 的提示，使用标记放置的技巧 -

```
<button data-toggle="collapse" data-target=".dropdown-toggle:hover + .more-menu" type="button" class="btn btn-primary dropdown-toggle" >
  Show More Menu +
</button>
<div class="collapse more-menu">More menu here...</div> 
```

这个 CSS 选择结构将选择所需的 DOM `.dropdown-toggle:hover + .more-menu`，我们可以在其中应用所需的 CSS。有更多的方法可以利用我们所拥有的。`:hover`或`:active`许多其他方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-30T11:58:35.380

是的，你可以轻松做到！

**只需将以下代码添加到您的脚本中即可享受：**

```
$('body').on('click','[data-toggle="collapse"][data-mytarget^="$("]',function(){
     eval($(this).data('mytarget')).collapse('toggle');
}); 
```

现在，您可以在代码中的每个位置通过内部的**完全动态 jQuery 命令****`data-mytarget`**设置折叠目标。

**现在像这样使用它：**

```
<a data-toggle="collapse" data-mytarget="$(this).parent().next()">Link</a> 
```

或者

```
<a data-toggle="collapse" data-mytarget="$('#TopMenuBar').closest('ul')">Link</a> 
```

或者

```
<a data-toggle="collapse" data-mytarget="[ EACH IDEAl JQUERY CODE OF YOU STARTED WITH $( ]">Link</a> 
```

**演示：**

```
$('body').on('click','[data-toggle="collapse"][data-mytarget^="$("]',function(){
     eval($(this).data('mytarget')).collapse('toggle');
});
```

```
a{
  padding:10px;
  cursor:pointer;
  margin:20px;
}
```

```
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle btn btn-info" data-toggle="collapse" data-mytarget="$(this).parent().next()">Collapse It</a>
    </div>
    <div id="collapseOne" class="accordion-body collapse ">
      <div class="accordion-inner">
        Generated Content... this is big and sometimes needs collapsing
      </div>
    </div>
</div>
```

> 我用`data-mytarget`而不是`data-target`. 如果您使用`data-target`它也可以，但 jQuery 库会引发如下错误：`Uncaught Error: Syntax error, unrecognized expression: $(this).parent().next()`.
> 
> 所以我用**`data-mytarget`**名字定义了我的不同属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-09T18:22:45.343

我认为最好的方法是迭代所有`accordion-toggle`元素并`data-target`通过 jquery 动态设置它们的属性，然后放置 bootstrap 中提到的手风琴代码。

**例子 ：**

```
$(function(){
    $("a.accordion-toggle").each(function(index) {
        $(this).attr("data-target", "#" + $(this).parent().next().attr("id"));
    });

    // accoridon code
}); 
```

希望这会有所帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-06T10:50:24.593

## TYPO3 FCE 和 Bootstrap 手风琴

我在这个问题上也遇到了一些麻烦，我在 TYPO3 中将它用于希望能够向手风琴添加无限数量的元素的客户。所以我创建了一个灵活的内容元素并映射了这些元素。

那个 data-toggle="collapse-next" 的想法并没有像预期的那样对我有用，因为它没有关闭打开的元素。我创建了一个新的 javascript 函数，请在此处找到代码。希望有人发现这些东西有用。

# Javascript

```
$(document).on('click.collapse-next.data-api', '[data-toggle=collapse-next]', function (e) {
  var $container = $(this).parents(".accordion");
  var $opencontainers = $container.find(".in");
  var $target = $(this).parent().next();
  $target.data('collapse') ? $target.collapse('toggle') : $target.collapse();
  $opencontainers.each(function() {$(this).collapse('toggle')});
}) 
```

# HTML

```
<html>
    <div class="accordion">
        <div class="accordion-section">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse-next">
                        Collapsible Group Item #1
                    </a>
                </div>
                <div class="accordion-body collapse">
                    <div class="accordion-inner">
                        Anim pariatur cliche...
                    </div>
                </div>
            </div>
        </div>
    </div>
</html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-03T02:47:06.920

这是一种避免需要唯一 ID 并避免特定 html 结构的方法。

这将折叠触发器和目标的每个实例包含在 html 的“部分”中。我喜欢使用类选择器，尤其是对于多个实例。在这种情况下，它避免了创建人为的唯一 ID。

借用@merv 的出色答案，我将 data-toggle 命名为`collapse-section`类似于他的`collapse-next`，并添加了一个 data-section 属性。这不是 parent().next()，而是查找最接近的 () 部分名称，然后查找给定的目标名称。他们可以是兄弟姐妹或任何其他级别。

（我有一个命名约定，使用“id ...”作为用作 jquery 选择器的类名的前缀，以避免与样式混合。）

### HTML

```
<div class="accordion-group idCollapseSection">
  <div class="accordion-heading">
    <a class="accordion-toggle" data-toggle="collapse-section"
       data-section=".idCollapseSection" data-target=".idCollapseTarget">
      Generated Title
    </a>
  </div>
  <div>Any other html, at various depths.
    <div class="accordion-body collapse in idCollapseTarget">
      <div class="accordion-inner">
        Generated Content... this is big and sometimes needs collapsing
      </div>
    </div>
  </div>
</div> 
```

### JS

```
//------------------------------
// Bootstrap Collapse.
//------------------------------
// Extend collapse to contain trigger and target within an enclosing section.
$('body').on('click.collapse-section.data-api', '[data-toggle=collapse-section]', function (e) {
  var thisTrigger = $(this);
  var sectionSelector = thisTrigger.data("section");
  var targetSelector = thisTrigger.data("target");
  var target = thisTrigger.closest(sectionSelector).find(targetSelector);
  target.data('bs.collapse') ? target.collapse('toggle') : target.collapse();
}); 
```

# ruby-on-rails-3 - 在两个应用程序中查询时使用回形针的照片 url 不一致

> ID：12805828
> 
> 赞同：0
> 
> 时间：2012-10-09T18:05:41.613
> 
> 标签：ruby-on-rails-3, paperclip

我正在使用回形针在共享一个数据库的两个 Rails 应用程序中上传照片。现在的问题是，例如，如果我在 app-a 中上传照片，回形针会给我一个 url：

[http://s3.amazonaws.com/testing-item-photos-akiajbfjoiwfjzd6aypa/Users/yujunwu/app-a](http://s3.amazonaws.com/testing-item-photos-akiajbfjoiwfjzd6aypa/Users/yujunwu/) /public/item_19/created_at_2012-09-29%2021:52:02%20UTC/large.jpg?1348955522 **_**

这是我在项目模型中设置的内容：

```
class Item < ActiveRecord::Base

  attr_accessible :photo, :photo_url, :poll_id, :brand, :number_of_votes

    has_attached_file :photo,
                    :styles => { :thumbnail => "100x100#",
                                   :small => "150x150>",
                                   :medium => "250x250>",
                                   :large => "400x400>" },
                    :storage => :s3,
                    :s3_credentials => S3_CREDENTIALS,
                    :url=>"/item_:id/created_at_:created_at/:style.jpg"

  Paperclip.interpolates :created_at do |attachment, style|
    attachment.instance.created_at
  end

end 
```

在另一个应用程序 app-b 中，当我使用 item.photo.url(:large) 查询 url 时，它给了我：

[http://s3.amazonaws.com/testing-item-photos-akiajbfjoiwfjzd6aypa/Users/yujunwu/app-b](http://s3.amazonaws.com/testing-item-photos-akiajbfjoiwfjzd6aypa/Users/yujunwu/) **/public/item_19/created_at_2012-09-29%2021:52:02%20UTC/large.jpg?1348955522** _

因此我得到了一个错误的网址。

有什么方法可以通过配置回形针来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:40:59.763

如此处所述：[https://github.com/thoughtbot/paperclip#defaults](https://github.com/thoughtbot/paperclip#defaults)，您可以更改默认配置，在您的情况下，我猜您想更改它，`:local_root`因此它不包含应用程序名称。

# delphi - 模块中的错误：Uses 子句丢失或不正确

> ID：12805832
> 
> 赞同：2
> 
> 时间：2012-10-09T18:05:50.937
> 
> 标签：delphi, exception, web-applications, delphi-xe

我正在尝试在 RAD Studio Delphi XE 下创建一个 Web 服务器应用程序。

当我点击`New -> others`. 我得到一个带有选项的对话框窗口。我为 Web 选择了 VCL。然后，我得到另一个带有“独立应用程序”和“ISAPI”选项的对话框窗口。

如果我选择独立应用程序选项，编译器没有任何问题，但如果我选择 ISAPI，我会在创建项目之前收到“模块中的错误：Uses 子句丢失或不正确”异常。

有谁知道为什么以及如何解决这个问题？

# java - 打印输入与数组元素匹配的整行

> ID：12805833
> 
> 赞同：2
> 
> 时间：2012-10-09T18:05:56.613
> 
> 标签：java, arrays

如何打印输入与数组元素匹配的整行？请看看我的代码我哪里出错了...... :(

```
package scanner;
import java.util.Arrays;
import java.util.Scanner;

public class EmployeeInformation {

    static Scanner sc = new Scanner(System.in);

    static String info[][] = {{"09-001", "Ja Gb", "100", "10", },
                        {"09-002", "Justine", "200", "20", ""},
                        {"09-003", "Ja Ja", "150", "15", ""}};

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        System.out.print("     - MENU -\n");
        System.out.print("A. Search Record\nB. Payroll Summary\n------------------\nEnter choice: ");
        String choice = null;
        choice = sc.nextLine();

        if (choice.equalsIgnoreCase("a")) {
            System.out.print("Enter Employee #: ");
            String EmpNum = sc.nextLine();
            SearchRecord(EmpNum);
        }
        else {
                PayrollSummary();
            }
    }

    private static void SearchRecord(String employeeNumber) {
        // TODO Auto-generated method stub
        String row[] = new String[3];
        int i = 0;
        while(i <= info.length) {
            int j = 0;
            while(j <= info.length) {
                if(employeeNumber.equals(info[i][j])) {
                    for (int a = 0; a <= row.length; a++) {
                        row[a] = info[i][j];
                        System.out.print(row[a]);
                        a++;
                    }
                }
                else {
                    System.out.print("Invalid employee number.");
                    System.exit(0);
                }
                j++;
            }
            i++;
        }
    }

    private static void PayrollSummary() {

        System.out.println("Employee #:\tEmployee Name\tRate per Hour\tTotal Hours Worked\tGross Pay");
        int r = 0;
        while ( r <= info.length - 1) {
            int c = 0;
            while ( c <= info.length ) {
                System.out.print(info[r][c] + "\t\t");
                if (c == 3) {
                System.out.print("\n");
                }
                c++;
            }
            r++;
        }

        //for (int a = 0; a <= info.length -1; a++) {
        //      Integer.parseInt(info[a][4]) = Integer.parseInt((info[a][3]) *  (info[a][4]));

        //}
    }
} 
```

当输入匹配一个元素时我应该怎么做？请给我一个提示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:26:22.987

看起来您始终将员工编号作为二维数组中的第一个元素。在这种情况下，您根本不需要嵌套循环：

```
String[] matchedRow;
for(int i=0; i<info.length; i++)
{
    String[] oneRow = info[i];
    if(oneRow[0].equals(employeeNumber))
    {
        matchedRow = oneRow;
        break
    }
}

for(int i=0; i<matchedRow.length; i++)
{
    System.out.println(matchedRow[i]);
} 
```

也就是说，在现实生活中，您很少会像您那样将员工记录放在数组中。您将创建一个`Employee`类并拥有一个`List`对象`Employee`。如果`Employee`类的设计正确且正确实现了[`equals`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#equals%28java.lang.Object%29),[`hashCode`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#hashCode%28%29)和[`toString`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#toString%28%29)，则 match 方法将非常简单：

```
employee = employeeList.get(employeeList.indexOf(employee));
System.out.println(employee);
//Do whatever with employee 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:44:40.790

尝试这个 ：

```
class Employee {

     static String info[][] = {{"09-001", "Ja Gb", "100", "10", },
            {"09-002", "Justine", "200", "20", ""},
            {"09-003", "Ja Ja", "150", "15", ""}};

     private static void search(String employeeNumber) {

        for (String s[] : info ) {
            if(employeeNumber.equals(s[0])) {
                for (String row : s) {
                    System.out.println (row) ; 
                }
                return ;
            }       
        }

        System.out.println ("Nothing found") ; 

    }

    public static void main(String args[]) {
        search ("09-003");
    }//end of main

} 
```

# perl - 为什么 perl 在读取文件并写入另一个文件时将“％x”打印为数值？

> ID：12805842
> 
> 赞同：1
> 
> 时间：2012-10-09T18:06:42.833
> 
> 标签：perl, printf

我在文件 1 中有这个文本：

```
printf ("integer value is %x \n", a); 
```

我想从文件 1 中读取数据并写入文件 2。当我到达这一特定行时，文件 2 如下所示：

```
printf ("integer value is 0 \n", a); 
```

为什么会这样？我怎样才能避免这种情况？

这是我的 Perl 代码的外观：

```
while ($line = <$in_fh>) {
    printf $out_fh $line;
} 
```

在这里，$in_fh 和 $out_fh 是输入和输出文件句柄。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:08:26.223

因为这就是这样[`printf`](http://perldoc.perl.org/functions/printf.html)做的。你想要[`print`](http://perldoc.perl.org/functions/print.html)。

```
while ($line = <$in_fh>) {
    print $out_fh $line;
} 
```

如果你想继续使用`printf`，你需要使用

```
while ($line = <$in_fh>) {
    printf $out_fh "%s", $line;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T18:08:44.363

因为`printf`解释`$line`为格式字符串，并发现`%x`它看起来像一个标记。改为使用`print`。

# ruby-on-rails - 安装 PostgreSQL 后发现 ruby 、rails、git 的问题

> ID：12805848
> 
> 赞同：1
> 
> 时间：2012-10-09T18:07:22.973
> 
> 标签：ruby-on-rails, ruby, git, postgresql, rvm

我的 rails 工作了好几个星期，但我尝试安装 PostgreSQL 以匹配 Heroku，但它没有工作。现在，当我打开终端时，它假装 rails 不存在并将默认 ruby​​ 设置为 1.8.7。当我启动 RVM 时，它会找到正确版本的 ruby​​ 并再次找到 rails 并可以启动服务器，但是每次我打开一个新的 shell 时，它又会回到没有找到任何东西。另外，即使在启动 rvm 之后，git 命令也不起作用。

我已经将 rvm 设置为默认启动，但这也不起作用，它必须手动启动，它仍然无法解决 git 问题。

更多详情

我正在安装在山狮上。这已经有 Postgres，但我使用的教程建议使用 Homebrew 安装新的。问题是 Homebrew 安装安装到 /usr/local/var/postgres，而安装的 ppstgres 安装到 usr/var/postgres。系统自动使用 usr/var/postgres 版本，所以按照教程我在 etc/paths 中更改了 usr/local/bin 和 usr/bin 的顺序。这没有帮助，所以我把它改回来了。然后一切都变了，所以我重新安装了 Mountain Lion，但没有任何改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:36:00.717

加载 RVM 和默认 ruby​​ 有两个已知问题：

1.  登录外壳：转到终端模拟器首选项并启用登录外壳，有时可能需要使用它`/bin/bash --login`。

2.  ZSH (+ Oh-My-ZSH)：去`~/.zshrc`注释掉任何以: `PATH=`or开头的行`path=(`，仍然可以使用这些行，但它们需要引用自身，例如：`PATH=$PATH:HOME/.rvm/bin`or `path+=( $HOME/.rvm/bin )`- which update 而不是 reset `PATH`。这可能是终端模拟器或 ZSH 中的错误...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T21:01:55.477

git 问题是由重新安装 Mountain Lion 解释的，它没有自动安装命令行工具。现在可以了。唯一的痛苦是现在每次都必须加载 rvm。

# bash - 从最新文件的文件名中提取字符

> ID：12805850
> 
> 赞同：1
> 
> 时间：2012-10-09T18:07:31.867
> 
> 标签：bash, shell

我正在编写一个 bash 脚本，我需要在其中检查现有文件的目录，并在将新文件添加到目录时查看文件名第一段的最后 4 位数字以设置计数器。

命名结构：

```
yymmddHNAZXLCOM0001.835 
```

我需要将示例 0001 中的部分放入 CTR 变量中，以便它放入目录的下一个文件将是

```
yymmddHNAZXLCOM0002.835 
```

等等。

什么是最简单和最短的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:20:43.313

你可以这样做`sed`：

```
filename="yymmddHNAZXLCOM0001.835"
first_part=$(echo $filename | sed -e 's/\(.*\)\([0-9]\{4,4\}\)\.\(.*\)/\1/')
counter=$(echo $filename | sed -e 's/\(.*\)\([0-9]\{4,4\}\)\.\(.*\)/\2/')
suffix=$(echo $filename | sed -e 's/\(.*\)\([0-9]\{4,4\}\)\.\(.*\)/\3/')
echo "$first_part$(printf "%04u" $(($counter + 1))).$suffix"
=> "yymmddHNAZXLCOM0002.835" 
```

所有三个`sed`调用都使用相同的正则表达式。唯一改变的是选择返回的组。可能有一种方法可以在一个电话中完成所有这些操作，但我的`sed`-fu 已经生锈了。

替代版本，使用 Bash 数组：

```
filename="yymmddHNAZXLCOM0001.835"
ary=($(echo $filename | sed -e 's/\(.*\)\([0-9]\{4,4\}\)\.\(.*\)/\1 \2 \3/'))
echo "${ary[0]}$(printf "%04u" $((${ary[1]} + 1))).${ary[2]}"
=> "yymmddHNAZXLCOM0002.835" 
```

注意：此版本假定文件名中没有空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:22:16.593

```
f() {
    if [[ $1 =~ (.*)([[:digit:]]{4})(\.[^.]*)$ ]]; then
        local -a ctr=("${BASH_REMATCH[@]:1}")
        touch "${ctr}$((++ctr[1]))${ctr[2]}"
        # ...
    else
        echo 'no matches'
    fi
}

shopt -s nullglob
f * 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:22:29.987

尝试这个...

```
current=`echo yymmddHNAZXLCOM0001.835 | cut -d . -f 1 | rev | cut -c 1-4 | rev`
next=`echo $current | awk '{printf("%04i",$0+1)}'` 
```

# facebook - 检索安装了特定应用程序的 facebook 页面列表

> ID：12805861
> 
> 赞同：1
> 
> 时间：2012-10-09T18:08:09.150
> 
> 标签：facebook, facebook-graph-api, facebook-fql

> **可能重复：**
> [我可以获得已安装我的 Tab 应用程序的页面列表吗？](https://stackoverflow.com/questions/9738150/can-i-get-a-list-of-pages-that-have-installed-my-tab-app)

我正在尝试获取一些表格，我可以在其中找到将应用程序与应用程序页面选项卡出现的页面相关联的信息，我正在使用 Facebook API，但我不知道从哪里获取我的表格或信息有这么多的需要，我已经浏览了这个页面，到目前为止没有结果：

[http://developers.facebook.com/docs/reference/api/page/](http://developers.facebook.com/docs/reference/api/page/)

[http://developers.facebook.com/docs/reference/fql/application/](http://developers.facebook.com/docs/reference/fql/application/)

[http://developers.facebook.com/docs/reference/fql/page/](http://developers.facebook.com/docs/reference/fql/page/)

我打算使用使用 fql 的查询来检索它，或者您认为可以使用的任何其他方法。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T23:17:51.457

FQL 没有直接的方法，但是 Pages API（通过 Graph API）在这里为您提供了一个解决方案：[https ://developers.facebook.com/docs/reference/api/page/#tabs](https://developers.facebook.com/docs/reference/api/page/#tabs)

您可以传入 /PAGE_ID/tabs ，它将返回一个包含每个应用程序 ID 的页面选项卡数组。

# r - 在 emacs ess 中更改缩进

> ID：12805873
> 
> 赞同：20
> 
> 时间：2012-10-09T18:08:36.453
> 
> 标签：r, emacs, ess

我想知道如何更改 emacs ess 中的缩进。我通常喜欢默认的（ess-set-style 'C++'quiet）但有时它的格式真的很奇怪。例如，这是我想要的，如果它不是函数的一部分，这将是默认格式：

```
 ggplot(data = overtime.by.month,
         aes(x="",
             y=Percent,
             fill = Overtime)) +
  geom_bar(width = 1) +
  xlab('') +
  ylab(sub.txt) +
  labs(title = title.txt) +
  facet_wrap(~Year.Month) +
  geom_text(aes(y = txt.pos, label = Per.txt)) +
  coord_polar(theta = "y") +
  scale_fill_manual(values = c('green', 'red')) +
  theme(axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.text.x = element_blank()) 
```

如果我把它放在函数内部，这就是我用当前的缩进样式得到的。

```
a <- function(){

    a <- ggplot(data = overtime.by.month,
                aes(x="",
                    y=Percent,
                    fill = Overtime)) +
                        geom_bar(width = 1) +
                            xlab('') +
                                ylab(sub.txt) +
                                    labs(title = title.txt) +
                                        facet_wrap(~Year.Month) +
                                            geom_text(aes(y = txt.pos, label = Per.txt)) +
                                                coord_polar(theta = "y") +
                                                    scale_fill_manual(values = c('green', 'red')) +
                                                        theme(axis.ticks = element_blank(),
                                                              axis.text.y = element_blank(),
                                                              axis.text.x = element_blank())
} 
```

更新：我遵循了 VitoshKa 和 Dirk 的建议，重新安装后，更新 .emacs 问题就消失了。感谢你们

UPDATE2：问题又回来了。我认为现在它对所有人都可以重现。我试图在两台不同的机器上。当您将代码放入函数中时会发生这种情况。我更新了帖子以反映更改。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-09T18:22:08.827

我明白了

```
ggplot(data = overtime.by.month,
       aes(x="",
           y=Percent,
           fill = Overtime)) +
    geom_bar(width = 1) +
    xlab('') +
    ylab(sub.txt) +
    labs(title = title.txt) +
    facet_wrap(~Year.Month) +
    geom_text(aes(y = txt.pos, label = Per.txt)) +
    coord_polar(theta = "y") +
    scale_fill_manual(values = c('green', 'red')) +
    theme(axis.ticks = element_blank(),
          axis.text.y = element_blank(),
          axis.text.x = element_blank()) 
```

我直接使用 R 手册中的默认值。

```
;; R-internals manual
;;; ESS
(add-hook 'ess-mode-hook
      (lambda ()
        (ess-set-style 'C++ 'quiet)
        ;; Because
        ;;                                 DEF GNU BSD K&R C++
        ;; ess-indent-level                  2   2   8   5   4
        ;; ess-continued-statement-offset    2   2   8   5   4
        ;; ess-brace-offset                  0   0  -8  -5  -4
        ;; ess-arg-function-offset           2   4   0   0   0
        ;; ess-expression-offset             4   2   8   5   4
        ;; ess-else-offset                   0   0   0   0   0
        ;; ess-close-brace-offset            0   0   0   0   0
        (add-hook 'local-write-file-hooks
              (lambda ()
            (ess-nuke-trailing-whitespace)))))
;;(setq ess-nuke-trailing-whitespace-p 'ask)
;; or even
(setq ess-nuke-trailing-whitespace-p t)
;; Perl
(add-hook 'perl-mode-hook
      (lambda () (setq perl-indent-level 4))) 
```

您可以在评论中修改这些值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-09T18:43:58.797

我也没有看到你的问题。尝试更新，它可能是一个老错误。

在任何情况下都`C-c C-e s`允许您动态更改缩进样式。推荐的是RRR。

# html - CSS：调整正文填充而不影响背景填充？

> ID：12805875
> 
> 赞同：0
> 
> 时间：2012-10-09T18:08:40.273
> 
> 标签：html, css

目前我有：

```
body
{
    background-image:url('images/background');
    background-color:#000;
    background-position:center; 
    background-repeat:repeat-y;
    padding-right: 75px;
    padding-left: 75px; 
} 
```

我怎样才能让背景更像这样：

```
body
{
    background-image:url('images/background');
    background-color:#000;
    background-position:center; 
    background-repeat:repeat-y;
} 
```

同时在身体内除了背景之外还有填充物？

基本上，我希望背景不受填充设置的影响，这与正文中设置的文本、图像等不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:11:45.073

稍微重新安排一下，这样你的身体里就有了一个新的顶级容器，这样......

```
<body ...background goes here ...>
  <div id="therealbody" ... padding goes here ...> ... content here ... </div>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:12:00.083

使用[Box-sizing](http://css-tricks.com/box-sizing/)属性来处理填充和边距

# networking - 启动脚本执行顺序（rc.local）？

> ID：12805878
> 
> 赞同：0
> 
> 时间：2012-10-09T18:08:44.843
> 
> 标签：networking, startup, boot, xen, rc

在其他用户的帮助下，我设法创建了一个脚本，该脚本编写了必要的网络配置，`/etc/network/interfaces`并允许公共访问 DomU 服务器。

我已将此脚本放在`/etc/rc.local`文件中，并执行`chmod u+x /etc/rc.local`以启用它。

服务器是主机 (Dom0) 上的 DomU Ubuntu 服务器。并且`rc.local`在启动/创建时启动网络之前似乎没有执行。

因此，正在对`/etc/network/interfaces`文件进行配置更改，但在启动过程完成后就不再活动。在更改生效之前，我必须再次重新启动。

我尝试添加`/etc/init.d/networking restart`到`rc.local`脚本的末尾（之前`exit 0`），但没有任何乐趣。

我也尝试将脚本添加到`S35networking`文件中，但再次没有成功。

任何有关在网络设备启动之前执行此脚本的建议或建议将不胜感激。

# linq-to-sql - Linq 在多个数据上下文上

> ID：12805882
> 
> 赞同：0
> 
> 时间：2012-10-09T18:09:03.847
> 
> 标签：linq-to-sql

我有一个查询，可能写得不好，因为我对此完全不确定，它试图在 (2) 上下文中加入 (3) 表，因为我们已将数据库拆分为不同的逻辑区域。我收到以下错误消息“查询包含对在不同数据上下文中定义的项目的引用。”

```
 Dim _db As DBML.XDataContext
    _db = New DBML.XDataContext(ConfigurationManager.ConnectionStrings("TempConnectionString").ToString)
    Dim _db1 As DBML.YDataContext
    _db1 = New DBML.YDataContext(ConfigurationManager.ConnectionStrings("TempConnectionString").ToString)

    Dim FAL = (From r In _db.SendingD _
                Join e In _db1.Entity On r.USR_FA Equals e.FANo _
                And r.USR_HomeD Equals e.OANo _
                Join b In _db1.Buildings On e.OBNo Equals b.BuildNo
                Where r.USR_FA = FA _
                Select b.BuildNo, b.BuildName).ToList()
    For Each ab In FAL
        list.Add(New ListItem(ab.BuildNo & "-" & ab.BuildName, ab.BuildNo))
    Next
    Return list 
```

我需要做什么才能加入表格以获得结果。SendingD 与 Entity 相关`USR_FA = FAno`，`USR_HomeD = OANo`然后 Entity 与 Buildings on`OBNo = BuildNo`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:16:29.220

如果那是同一台服务器，那么我们在表名前加上：

```
<DatabaseName>.<SchemaName>.<YourTableName> 
```

如果它们在链接服务器上，那么您必须在其前面加上服务器名称

```
<ServerName>.<DatabaseName>.<SchemaName>.<YourTableName> 
```

# angularjs - AngularJS 与 Webstorm 一起设置

> ID：12805891
> 
> 赞同：3
> 
> 时间：2012-10-09T18:09:50.727
> 
> 标签：angularjs, webstorm

我开始使用 Angularjs 并遇到了第一个障碍:-(

我已经安装了节点（Windows 安装程序）和 webstorm ide。在 webstorm 中，我安装了 angularjs 插件，并且在 html 中键入“ng”会在下拉列表中提示所有 ng 模板，所以这看起来不错。

在演示 html5 中剪切和粘贴（在[http://angularjs.org/](http://angularjs.org/)的“基础知识”标题下）并在 webstorm 中运行并导航到文件 url（在 firefox 或 chrome 中）但是 angular 语句'{{yourName} }' 根本没有约束力——它被渲染为文字。任何人都知道我要去哪里错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T20:03:04.640

主页上的示例使用无协议（或协议相对）URL（[http://www.paulirish.com/2010/the-protocol-relative-url/](http://www.paulirish.com/2010/the-protocol-relative-url/)）。`file://`虽然这些非常方便，但在这种情况下，与协议相关的 URL 不能很好地与协议配合使用。只是您的浏览器正试图从本地文件系统中检索 AngularJS 库。要修复它，您需要添加协议：

```
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T14:25:29.707

尝试在 ng 标签前加上 data-ng-model 之类的数据。

# tsql - TSQL：可以根据环境引用不同的数据库吗？

> ID：12805893
> 
> 赞同：3
> 
> 时间：2012-10-09T18:09:54.933
> 
> 标签：tsql, stored-procedures

所以我们有这样的情况，我们有两个不同的数据库，存储过程需要引用另一个数据库来获取信息。我们通常会将查询编写为如下所示

```
select * from Mercury.dbo.MyTable a join Purchasing.dbo.OtherTable b on a.a = b.a 
```

在生产环境和开发环境中这对我们来说效果很好，但最近我们将开发分为 Dev/QA/ST，并且我们有不同版本的数据库来匹配环境。

```
Example
Purchasing, PurchasingQA, PurchasingST
Mercury, MercuryQA, MercuryST 
```

所以现在我们在推广代码时遇到了问题，因为 QA 中的存储过程将引用用于开发的数据库。

所以我的问题是如何根据环境变量更改正在访问的数据库？我已经开始为此使用 DynSQL，但这会导致代码更难维护。

也许有办法创建一个数据库范围的“数据库别名”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T08:55:04.647

您可以考虑为此使用[同义词。](http://msdn.microsoft.com/en-us/library/ms177544.aspx)在您的情况下，只需创建一个引用其他数据库表的同义词，例如：

为 Mercury.dbo.MyTable 创建同义词 MyTable

每个数据库都有自己的同义词，但其余的脚本和存储过程将是相同的。

# amazon-ec2 - 自动缩放 AWS

> ID：12805901
> 
> 赞同：0
> 
> 时间：2012-10-09T18:10:29.160
> 
> 标签：amazon-ec2, amazon-web-services, amazon, amazon-cloudfront

我是否必须仅基于 API 或命令行为 Amazon 配置 Auto Scaling 策略？亚马逊不提供用于配置它的 GUI 控制台是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:25:52.840

不对。转到控制台中的 CloudWatch。只需创建一个警报，例如 CPU > 50，然后选择一个操作来添加服务器。您不能做的是创建自动缩放组和策略，您需要该 AFAIK 的命令行。

但是根据我的经验，值得学习命令行，一旦你需要多次执行它，它实际上会更容易，并且你可以记录你所做的事情。

# asp-classic - 如何将经典 ASP 会话的全部内容传递给 .net 代码？

> ID：12805902
> 
> 赞同：0
> 
> 时间：2012-10-09T18:10:35.457
> 
> 标签：asp-classic

我知道如何从经典 ASP 站点（Server.CreateObject、gacutil 和所有其他站点）调用 .net 代码的练习。我说的是从 VBScript 代码调用 .net DLL。（这与 ASP.net 无关）

我想知道的是，如何将整个 Classic ASP 会话的内容传递给 .net 代码。我想我想传递`Session.Contents`给 .net 代码，但我不知道如何编写一个可以接受该对象的接口。

如果您还可以告诉我如何传递对象的全部内容，则可以加`Request.Form`分`ASPError`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:44:04.443

假设您的意思是`Set invokedNetDLL = CreateObject("MyNamespace.MyType")`当您说“从 VBScript 代码调用 .net DLL”时，我会尝试以下操作：

```
<%
    Dim key
    Dim serializedSession
    Dim invokedNetDLL

    For Each key in Session
        serializedSession = key & "=" & Session(key) & "&"
    Next

    'Trim last &
    serializedSession = Left(serializedSession, Len(serializedSession) - 1)

    Set invokedNetDLL = CreateObject("MyNamespace.MyType")
    invokedNetDLL.MyMethod(serializedSession)

%> 
```

就目前`Request.Form`而言，可以应用相同的方法：

```
<%
    Dim key
    Dim serializedSession
    Dim serializedRequestForm
    Dim invokedNetDLL

    For Each key in Request.Form
        serializedRequestForm = key & "=" & Request.Form(key) & "&"
    Next

    'Trim last &
    serializedRequestForm = Left(serializedRequestForm, Len(serializedRequestForm) - 1)

    For Each key in Session
        serializedSession = key & "=" & Session(key) & "&"
    Next

    'Trim last &
    serializedSession = Left(serializedSession, Len(serializedSession) - 1)

    Set invokedNetDLL = CreateObject("MyNamespace.MyType")
    invokedNetDLL.MyMethod(serializedRequestForm, serializedSession)

%> 
```

我还没有测试过这段代码，但这是我要开始的地方。

# c# - 使用 XSD 生成 CS 文件产生更大的类

> ID：12805904
> 
> 赞同：1
> 
> 时间：2012-10-09T18:10:53.943
> 
> 标签：c#, xml, xsd, xsd.exe

我正在尝试更新 XML 以接受 currentYear 值。

所以我`<xsd:element name="currentYear" type="xsd:string"/>`在 .xsd 文件中添加了：

然后我运行 xsd 并生成了一个文件。

该文件是前一个 .cs 文件大小的 10 倍。

在生成之前：运行时版本：4.0.30319.239 我生成的新文件使用的是：运行时版本：4.0.30319.269

这会有很大的不同吗？

使用我生成的新 .cs 文件，我无法再编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:57:41.643

问题最终是我用来创建文件的命令。我正在使用 xsd /dataset /language:CS XSDSchemaFile.xsd，一旦我尝试 xsd /classes /language:CS XSDSchemaFile.xsd，一切正常

# openxml - 如何在 Open Xml 中拆分表格单元格？

> ID：12805905
> 
> 赞同：2
> 
> 时间：2012-10-09T18:10:53.970
> 
> 标签：openxml, openxml-sdk

我有一张带桌子的文件。我需要能够将列添加到特定行，同时保持原始表格宽度。

本质上我需要拆分表格单元格。我怎样才能使用打开的 xml 作为 word 文档来做到这一点？我试过

```
 var tc = new TableCell();
                    tc.Append(new Paragraph(new Run(new Text("Hi"))));
                    row.Append(tc); 
```

我尝试只添加更多单元格，但是它充当新列并增加了表格的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T11:01:17.260

首先在 microsoft word 中创建一个表格并在那里拆分单元格。现在在 OpenXML SDK 开发工具中打开您的 word 文档，该工具可以从[这里](http://www.microsoft.com/en-us/download/details.aspx?id=5124)下载。如果您查看 OpenXML 中的相关单元格，您会找到问题的答案。只需从 OpenXML 复制代码并根据您的要求进行任何必要的更改。

# asp.net-mvc - ASP.NET MVC 和类似 Excel 的网格控件？

> ID：12805912
> 
> 赞同：0
> 
> 时间：2012-10-09T18:11:35.013
> 
> 标签：asp.net-mvc, spreadsheet

我查看了 Spire、Spreadsheet Gear 和 GrapeCity（以及 Web 搜索引擎），以找到一个类似于网格的控件，该控件将允许本地数据操作，看起来/感觉像 Excel 和 Access。特别是需要“填充句柄”，因此可以在一个框中编辑一组 50,000 个项目，然后用户可以简单地更改其下方的列。

任何人都可以推荐一些东西吗？如果 HTML5 或经典 JS 不可用，Silverlight 或 Flash 也可以。

填充手柄的这个要求是一个杀手......

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T04:32:08.283

尝试使用[Handsontable](http://handsontable.com/)。使用 Html 和 jquery 可以提供更好的结果。

也试试[jqgrid](http://www.trirand.com/blog/jqgrid/jqgrid.html)。

# gwt - 如何在 GWT 中禁用和启用水平面板的可见性？

> ID：12805913
> 
> 赞同：0
> 
> 时间：2012-10-09T18:11:37.390
> 
> 标签：gwt, panel

首先，我必须禁用`Horizontal panel`. 我尝试使用以下代码，但面板已禁用。

```
public void hideNavigaton(){
    pagination.removeFromParent();
} 
```

但是在以下方法定义中禁用后，我还必须启用上面的面板：

```
public void showNavigation(){
    // Add definition to enable the visibility.
} 
```

如果有任何问题，那么将编写什么或适当的方法来启用和禁用水平面板的可见性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:14:06.573

隐藏你打电话

```
pagination.setVisible(false) 
```

并展示

```
pagination.setVisible(true) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T23:47:35.907

如果您想简单地隐藏和显示面板，请按照 Daniel 的建议使用 setVisible()。在这种情况下，面板会出现/消失，但会保留其在布局中的位置。

如果您希望面板完全消失并将其空间留给另一个小部件，则必须将其从父级中删除。然后，您可以在需要时将其添加回来。

```
public void hideNavigaton(){
    pagination.removeFromParent();
}
public void showNavigation(){
    myParentWidget.add(pagination);
    // Set position of pagination widget if you don't do it through CSS
} 
```

# javascript - ASP.NET TreeView 可以向上扩展而不是向下扩展吗？

> ID：12805915
> 
> 赞同：1
> 
> 时间：2012-10-09T18:11:53.513
> 
> 标签：javascript, asp.net, treeview, orgchart

当您单击 + 号时，ASP.NET TreeView 是否可以向上展开而不是向下展开？这样“孩子”节点就会出现在他们的“父母”之上。

本质上，我想在逻辑上采用通常是单个叶节点的东西，使其成为我树的根，并将逻辑上它的父节点变成我树上的子节点，但是当子节点仍然显示在父节点上方时父级得到扩展。

想想一个公司的 OrgChart，但从员工（叶节点）开始并向上发展。

我似乎在 MSDN 上找不到任何指定方向的内容。我想避免重新编写 TreeView 的 Javascript 的工作方式，但如果没有其他方法，我会对其开放。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:30:17.643

不，您不能对`TreeView`组件执行此操作。
尝试这样做将涉及从 TreeView 继承并编写您的自定义`Render`函数。

不过，有一种更简单的方法。您可以将所有数据写入 json 对象，并使用众多 javascript 数据可视化库之一来呈现它。

我真的很喜欢[javascript InfoVis 工具包](http://philogb.github.com/jit/)。您可以使用它制作非常详细的图表。

# java - 从 jaxb 对象获取 xpath

> ID：12805916
> 
> 赞同：2
> 
> 时间：2012-10-09T18:11:59.107
> 
> 标签：java, xpath, jaxb

是否有一个内置库允许从 jaxb 属性中获取 xpath 表达式或值。

例如，如果我下面的类是由 jaxb 生成的（注释被删除）

```
@ ... 
public Person {
  private Address address;
  private String name;
} 
```

我想找出地址属性映射到的 xpath 表达式。

是否有现有的库可以做到这一点（不使用反射）？

# function - Vim vmap，将选定的文本作为参数发送给函数

> ID：12805922
> 
> 赞同：3
> 
> 时间：2012-10-09T18:12:11.097
> 
> 标签：function, vim

简而言之，在编写了一些函数来保存输入后，我正在尝试设置一个 vmap[ping]，它允许我选择我输入的内容，并将这个选择传递给一个函数（因为在命令行上键入函数调用，输入参数（带引号），转义反斜杠等......抵消了调用函数节省的大部分时间）

对于（一个简单的）示例，假设我具有以下功能

```
func Test(iStr)
if a:iStr[0] =~ [a-zA-z]
    echo "hello"
else
    echo "hello world"
endif
endfunc 
```

我希望能够直观地选择一些文本，然后使用一些键映射，F2 说，它将调用 Test(iStr) 并将选择用作参数 iStr

我相信，通过更多的工作（即某种方式来指定我选择的内容应该在 Test() 中），以下

```
vmap <F2> :call Test() 
```

是我所追求的。事情是我尝试了许多变体（猜测加上来自 :help map 的一些狡猾的推断），但我没有得到任何有用的东西。更新，我尝试使用辅助函数 Test2()

```
call Test(<C-W>) 
```

作为它的主体......不知何故，我认为我需要抓住光标下的单词（不知何故）然后我就完成了 - 因为我可以从 Test2 中将它传递给 Test(...)

* * *

至于我要调用的函数的实际示例，以下（不完整的）函数（和辅助函数）将允许我转换表单的表达式，例如，

```
f_k^{(j)}g 
```

至

```
f_1^{(j)}g, f_2^{(j)}g, \dots, f_{n-1}^{(j)}g, f_n^{(j)}g 
```

就我想要的程序而言

```
a) type the repeated term in vim
b) visually select it
c) hit some mapping key that will call SumOrSequence(iExpression, iIndex)
d) provide "k" as a parameter
e) press enter
f) see the change made by SumOrSequence(...) 
```

SumOrSequence(...) 的代码如下：

```
func SumOrSequence(iExpression, iIndex)
"need to check validity of these - maybe set a default
let default = Interrogate("do with defaults? yes [y] (2,1,n,0,\",\"), yes but specify last term [d[a-Z]], no [n]")
if default == "y"
    let leftTerms = 2
    let rightTerms = 1
    let lastTermIndex = "n"
    let firstTermIndex = 0
    let operator = ","
    let dotType = "\\dots"
elseif default =~ 'd[a-zA-Z]'
    let leftTerms = 2
    let rightTerms = 1
    let lastTermIndex = default[1]
    let firstTermIndex = 0
    let operator = Interrogate("what separates terms? add [+], subtract [-], times [*], comma [,], ampersand [&]?")
    let dotType = "\\cdots"
else "so n or anything else
    let leftTerms = InterrogateNumber("how many terms before dots? ")
    let rightTerms = InterrogateNumber("how many terms after dots? ")
    let lastTermIndex = Interrogate("what is last term index?")
    let firstTermIndex = Interrogate("what is first term index?")
    let operator = Interrogate("what separates terms? add [+], subtract [-], times [*], comma [,], ampersand [&]?") "need to check only any of these provided
    let dotType = "\\cdots"
endif
if operator == ","
    let dotType = "\\dots"
endif
if operator == "*"
    let operator = "\\times"
endif
let leftCount = 0
let oExpression = ""
while leftCount < leftTerms
    if leftCount > 0
        let oExpression .= operator . " "
    endif
    let oExpression .= ReplaceIndex(a:iExpression, a:iIndex, leftCount,1)
    let leftCount += 1
endwhile
let oExpression .= operator . " " . dotType . " "
let rightCount = rightTerms-1
while rightCount > 0
    "here we are going to be counting backwards from some number denoting number of terms - may need to know if we actually have a number!
    echo "decrement: " . HandleDecrement(lastTermIndex, rightCount)
    let oExpression .= operator . " " . ReplaceIndex(a:iExpression, a:iIndex, HandleDecrement(lastTermIndex, rightCount),1)
    let rightCount -= 1
endwhile
let oExpression .= operator . " " . ReplaceIndex(a:iExpression, a:iIndex, lastTermIndex,0)
echo oExpression
endfunc

func ReplaceIndex(iExpression, iIndex, iReplacement, iInsertBraces)
"the game we play here is to search for iIndex in such form that it is not part of any other string
"We should expect this to be the case if the character to the left or right of the index is not in [A-z] (or just to the right if a greek char)
let oExpression = ""
let strEndPosition = strlen(a:iExpression) - 1
let currPosition = 0
let indexLen = strlen(a:iIndex)
while currPosition <= strEndPosition
    let indexCounter = 0
    let foundIndex = 1
    while indexCounter < indexLen
        if a:iExpression[currPosition + indexCounter] == a:iIndex[indexCounter]
            if a:iExpression[currPosition + indexLen] =~ '[a-zA-Z]'
                let foundIndex = 0
                let indexCounter = indexLen
            elseif a:iExpression[currPosition -1] =~ '[a-zA-Z]' && a:iExpression[currPosition] != "\\"
                let foundIndex = 0
                let indexCounter = indexLen
            else
               let indexCounter+=1
            endif
        else
            let indexCounter = indexLen
            let foundIndex = 0
        endif
    endwhile
    if foundIndex == 0
        let oExpression .= a:iExpression[currPosition]
        let currPosition+=1
    else
        if a:iInsertBraces == 1
            let oExpression .= "{" . a:iReplacement . "}"
        else
            let oExpression .= a:iReplacement
        endif
        let currPosition+=indexLen
    endif
endwhile
    echo "oExpression: " . oExpression
return oExpression
endfunc

func HandleIncrement(iExpression, iIncrement)
"and what about negative numbers for iExpression!??? not handling these yet :[
let oExpression = ""
if !(a:iExpression[0] =~ '[0-9]') || a:iExpression < 10 && strlen(a:iExpression) > 1
    let oExpression = a:iExpression . " + " . a:iIncrement
else
    let oExpression = a:iExpression + a:iIncrement
endif
echo oExpression
return oExpression
endfunc

func HandleDecrement(iExpression, iIncrement)
"TODO and what about negative numbers for iExpression!??? not handling these yet :[
let oExpression = ""
if !(a:iExpression[0] =~ '[0-9]') || a:iExpression < 10 && strlen(a:iExpression) > 1
    let oExpression = a:iExpression . " - " . a:iIncrement
else
    let oExpression = a:iExpression - a:iIncrement
endif
echo oExpression
return oExpression
endfunc

func Interrogate(iQuestion)
    call inputsave()
    let answer = input(a:iQuestion)
    call inputrestore()
    return answer
endfunc

func InterrogateNumber(iQuestion)
    call inputsave()
    let answer = input(a:iQuestion)
    call inputrestore()
    "TODO what if negative number??
    if !(answer[0] =~ '[0-9]')
        let answer = InterrogateNumber(a:iQuestion . " you didn't enter a numerical value ")
    endif
    return answer
endfunc 
```

关于映射位，我知道看起来我没有做太多工作，但假设我还有更多的工作要自己找到答案，有人可以帮忙吗？

* * *

更新。好的，我有一些以笨拙的方式工作的东西，即如果我定义以下辅助函数：

```
func SumOrSequenceHelper()
    let oIndex = Interrogate("index variable? ")
    "go to last thing visually selected (I think!), yank it (putting it in the " register), then fetch it via oParam. Then pass this off to SumOrSequence
    execute "normal! gvy"
    let oExpression = getreg('"')
    call SumOrSequence(oExpression, oIndex)
endfunc

vnoremap <F6> :call SumOrSequenceHelper() 
```

那么一切都很好，我可以执行一个执行命令，将我选择的内容替换为从 SumOrSequence(...) 获得的内容

将不胜感激任何改进，但出于所有意图和目的，这个问题已解决：]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T11:44:46.030

您可以使用这样的辅助函数：

```
func! GetSelectedText()
  normal gv"xy
  let result = getreg("x")
  normal gv
  return result
endfunc

vnoremap <F6> :call MyFunc(GetSelectedText())<cr> 
```

还有`:com -range`, 它可以注册一个对选择进行操作的自定义命令，但界面是面向行的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T16:21:22.757

使用选择寄存器来调用您在视觉上选择的任何功能。

```
vnoremap <F6> :call Test(@*)<CR> 
```

如果您只想在普通模式下抓住光标下的单词，您可以使用它，它会拉到选择寄存器然后使用该值。（您可以改为拉到任何命名的寄存器，例如`a`带有`"ay`and的寄存器`@a`。）

```
noremap <S-F6> "*yaw:call Test(@*)<CR> 
```

* * *

顺便说一句，这些不适用于您的 Test 函数，但只是调用它似乎也不起作用？

```
:call Test("fred")
Error detected while processing function Test:
line    1:
E121: Undefined variable: a
E15: Invalid expression: a:iStr[0] =~ [a-zA-z] 
```

他们使用这个测试功能：

```
function Test(iStr)
    echo a:iStr
endfunction 
```

# ejb-3.1 - 使用 Arquillian 运行多个测试时尝试注入远程 ejb-ref 的异常

> ID：12805923
> 
> 赞同：2
> 
> 时间：2012-10-09T18:12:12.447
> 
> 标签：ejb-3.1, jboss-arquillian

我有许多使用“arquillian-glassfish-embedded-3.1”容器（1.0.0.CR3）使用Arquillian（1.0.2.Final）运行的测试类。

如果我单独运行任何测试类，它们会按预期运行，如果我尝试运行多个测试类 (TestSuite)，我会遇到将 EJB 注入类的问题。

> java.lang.RuntimeException：无法注入成员
> 
> 原因：java.lang.IllegalStateException：尝试注入远程 ejb-ref name=PackageManagerBean，远程 3.x 接口=com.dcp.pkg.PackageManager 解析为模块测试中的应用内 EJB PackageManagerBean 的异常，ejb-link=PackageManagerBean ,lookup=,mappedName=,jndi-name=PackageManagerBean,refType=Session 进入类 com.dcp.transmission.TransmissionManagerBeanTest: 在 SerialContext[myEnv={java.naming.factory.初始=com.sun.enterprise.naming.impl.SerialInitContextFactory，java.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl，java.naming.factory.url.pkgs=com。 sun.enterprise.naming}
> 
> 原因：com.sun.enterprise.container.common.spi.util.InjectionException：尝试注入远程 ejb-ref name=PackageManagerBean，远程 3.x 接口=com.dcp.pkg.PackageManager 解析为应用内 EJB 的异常模块测试中的 PackageManagerBean，ejb-link=PackageManagerBean，lookup=，mappedName=，jndi-name=PackageManagerBean，refType=Session 进入类 com.dcp.transmission.TransmissionManagerBeanTest：在 SerialContext 中查找 'java:comp/env/PackageManagerBean' 失败[myEnv={java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory，java.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl，java。命名.factory.url.pkgs=com.sun.enterprise.naming}
> 
> 原因：javax.naming.NamingException：在 SerialContext [myEnv={java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory, java.naming 中查找“java:comp/env/PackageManagerBean”失败.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl, java.naming.factory.url.pkgs=com.sun.enterprise.naming} [根异常是 javax.naming.NamingException: Exception为 'Remote ejb-ref name=PackageManagerBean,Remote 3.x interface =com.dcp.pkg.PackageManager 解析 Ejb 在模块测试中解析为应用内 EJB PackageManagerBean,ejb-link=PackageManagerBean,lookup=,mappedName=,jndi-名称=PackageManagerBean,refType=Session' 。用于查找的实际（可能是内部）远程 JNDI 名称是 'PackageManagerBean#com.dcp.pkg.PackageManager' [根异常是 javax.naming.NamingException：
> 
> 引起：javax.naming.NamingException: Exception resolve Ejb for 'Remote ejb-ref name=PackageManagerBean,Remote 3.x interface =com.dcp.pkg.PackageManager 在模块测试中解析为应用内 EJB PackageManagerBean,ejb-link= PackageManagerBean,lookup=,mappedName=,jndi-name=PackageManagerBean,refType=Session' 。用于查找的实际（可能是内部）远程 JNDI 名称是“PackageManagerBean#com.dcp.pkg.PackageManager”[根异常是 javax.naming.NamingException：在 SerialContext 中查找“PackageManagerBean#com.dcp.pkg.PackageManager”失败[ myEnv={java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory, java.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl, java.naming .factory.url.pkgs=com.sun.enterprise.naming} [根例外是 javax.naming。
> 
> 原因：javax.naming.NamingException：在 SerialContext [myEnv={java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory, java 中查找 'PackageManagerBean#com.dcp.pkg.PackageManager' 失败.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl, java.naming.factory.url.pkgs=com.sun.enterprise.naming} [根异常是 javax.naming.NamingException ：远程业务接口com.dcp.pkg.PackageManager的ejb ref解析错误[根异常是java.lang.IllegalArgumentException：参数类型不匹配]]
> 
> 原因：javax.naming.NamingException：远程业务接口com.dcp.pkg.PackageManager的ejb ref解析错误[根异常是java.lang.IllegalArgumentException：参数类型不匹配]
> 
> 引起：java.lang.IllegalArgumentException：参数类型不匹配

包管理器 Bean 定义如下：

```
@Stateless(mappedName = "PackageManagerBean")
@Remote({ PackageManager.class })
@Local({ PackageManagerLocal.class })
public class PackageManagerBean implements PackageManager {

} 
```

包管理器被注入到几个测试类中，如下例所示：

```
@RunWith(Arquillian.class)
public class TransmissionManagerBeanTest {

      @Deployment
      public static Archive<?> createDeployment() {
                WebArchive war = ShrinkWrap.create(WebArchive.class, "test.war")
                                    .addPackages(true, TransmissionManager.class.getPackage(), Search.class.getPackage(), PackageManager.class.getPackage(), SiteManagerBean.class.getPackage())
                                    .addAsResource("test-persistence.xml", "META-INF/persistence.xml").addAsWebInfResource(EmptyAsset.INSTANCE, "beans.xml");
                return war;
      }

  @EJB
  TransmissionManager transmissionManager;

  @EJB
  PackageManager packageManager;

  @EJB
  SiteManager siteManager;

  @PersistenceContext
  EntityManager entityManager;

  @Inject
  UserTransaction userTransaction;

} 
```

我似乎没有遇到任何其他 EJB 的问题。

有谁知道问题是什么以及我如何才能让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-27T03:14:23.190

据我所知，清理每个测试类之间的嵌入式 Glassfish 容器中部署的资源似乎是一个问题。在这一点上，我不知道是 Arquillian、嵌入式 Glassfish 容器还是我的代码导致了问题。

我找到了一种解决方法。通过在它自己的 JVM 中运行每个测试类，我避免了上述问题。它确实增加了一些额外的开销，例如，而不是为所有测试类重新使用嵌入式容器，容器被拆除并为每个测试类重新启动，但它确实允许我一次性运行所有单元测试。

我使用 maven 运行测试并使用以下 maven-surefire-plugin 配置来确保每个测试类都在它自己的 JVM 中运行：

`<configuration><forkCount>1</forkCount><reuseForks>false</reuseForks>....</configuration>`

对于早于 2.14 的 maven-surefire-plugin 版本，您可以使用 forkMode=false

# php - MySql 没有更新

> ID：12805924
> 
> 赞同：1
> 
> 时间：2012-10-09T18:12:13.423
> 
> 标签：php

请帮忙。。我放弃了。。

试图更新MySql表..文件是settings.php（自行提交）表单代码是：

```
<form method="POST" action="settings.php">
  First Name <input type="text" name="fname" id="set_fname"  />
  Last name <input type="text" name="lname" id="set_lname"  />
  Email: <input type="text" name="email" id="set_email"  />
  mobile <input type="text" name="mobile" id="set_mobile" />
  Bio: <textarea name="bio" id="set_bio"  cols="" rows="5" maxlength="1000" ></textarea>
  <input type="submit" id="personal_submit" value="Update" />
</form> 
```

php部分

```
$id=$_SESSION['id'];   

$fname_update =$_POST['fname'];
$lnam_update = $_POST['lname'];
$email_update = $_POST['email'];
$mobile_update =$_POST['mobile'];
$bio_update =$_POST['bio'];

$db_host="localhost";
$db_uname="admin";
$db_pass="mypass";
$db_db="main_db";
$db_table="mebers_general";

mysql_connect("$db_host","$db_uname","$db_pass") or die (mysql_error());
mysql_select_db("$db_db") or die("no database by that name");

if($_POST['fname']){

  $sql_personal_update=mysql_query("UPDATE members_general SET first_name='$fname_update' WHERE id='$id' ") or die (mysql_error()) ;
    if($sql_personal_update){
      echo "should be ok but no record is updated....Heeelppp";
      }else{
      echo "Smth is Wrong";
      }  
} 
```

我没有错误..

结果我得到了回显字符串“应该没问题，但没有更新记录....Heeelppp”；所以它检测到更新没有问题我在 phpMyadmin 中尝试了相同的查询 - 工作得很好。我检查了变量-它们不是空的..一切似乎都应该如此。请帮忙..在这里已经堆了 2 天//

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:13:46.200

```
 $sql_personal_update=mysql_query("UPDATE members_general SET firs_name='".$fname_update."' WHERE id='".$id."' ") or die (mysql_error()) ; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T18:14:05.667

您实际上并没有运行您的查询：

```
$sql_personal_update=("UPDATE members_general SET firs_name='$fname_update' WHERE id='$id' ") or die (mysql_error()) ;
                     ^^^^^--- where's mysql_query()? 
```

它应该是

```
$sql_personal_update = mysql_query(blah blah blah) or die(mysql_error()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-09T18:14:06.673

我想这是因为您实际上并没有调用该`mysql_query`函数！

对于初学者，尝试

```
$sql_personal_update=mysql_query("UPDATE members_general SET firs_name='$fname_update' WHERE id='$id' ") or die (mysql_error()) ; 
```

另外，是`firs_name`拼写错误，还是您真的将您的数据库列称为？

编辑：正如 JoachimIsaksson 建议的那样，不推荐使用 mysql_connect 等。请改用 mysqli，如下所示：

```
$mysqli = new mysqli($db_host,$db_uname,$db_pass, $db_db) or die (mysql_error());
if($_POST['fname']){
    $sql_personal_update=$mysqli->query("UPDATE members_general SET first_name='$fname_update' WHERE id='$id' ") or die (mysql_error()) ;
    if($sql_personal_update) {
        echo "should be ok but no record is updated....Heeelppp";
    } else {
        echo "Smth is Wrong";
    }  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T18:17:04.750

Thanks for everything, guys, i just recoded all page from blank and it worked..have no idea what was the reason..maybe the 20th hour in a row of coding..thanx..

# java - Java Web应用程序中的主要方法？

> ID：12805929
> 
> 赞同：4
> 
> 时间：2012-10-09T18:12:38.163
> 
> 标签：java, multithreading, web, main

我正在使用 servlet 创建一个 Web 应用程序，我需要一个线程不断更改数字，当客户端发出请求时，它会获取当前数字。

我尝试使用 main 方法创建一个类并从那里启动线程，然后从 servlet 获取线程正在运行的实例（这可能吗？），但应用程序永远不会进入 main 方法。

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:19:35.870

Servlet 在 Web 容器中运行，而 Web 容器的主要方法不受您的控制。

如果要执行任何启动操作，则 servlet 框架提供 可以向框架注册的[上下文侦听器。](http://docs.oracle.com/javaee/5/api/javax/servlet/ServletContextListener.html)这些侦听器在您的 Web 应用程序启动时被调用。

或者，如果您想对每个传入请求或传出响应执行一些操作，那么您可以使用[servlet 过滤器](http://www.oracle.com/technetwork/java/filters-137243.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:17:39.600

您应该有一个在您的网络服务器上运行的计划任务，该任务会更新该数字。Web 应用程序中没有“main”方法（如应用程序入口点），因为每个 servlet 都是一个独立的入口点。

# xcode - 产品的 iTunes 连接配置中的 MKStoreKit 问题：

> ID：12805930
> 
> 赞同：1
> 
> 时间：2012-10-09T18:12:45.450
> 
> 标签：xcode, itunes

我正在尝试配置 MKStoreKit 5 插件。但是当应用程序启动时我收到了这条消息。

产品的 iTunes 连接配置问题：com.website.app.feature1 产品的 iTunes 连接配置问题：com.website.app.feature2

我的 Bundle 名称 ID 在 Itunes connect 和项目属性中完全相同。

我还在 Itunes 上添加了 2 个应用内购买（非消耗品）与此产品 ID 连接：

com.website.app.feature1 我也试过 feature2

这 2 个应用内购买也在 MKStoreKitConfigs.plist 文件中。

```
<plist version="1.0">
<dict>
    <key>Consumables</key>
    <dict/>
    <key>Non-Consumables</key>
    <array>
        <string>com.website.app.feature1</string>
        <string>com.website.app.feature2</string>
    </array>
    <key>Subscriptions</key>
    <dict/>
</dict>
</plist> 
```

我找不到任何更新的教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T11:08:44.697

固定的。

等一下。应用内购买可能需要几个小时才能可用。

# modx-revolution - Modx - 按电视日期获取资源过滤器

> ID：12805934
> 
> 赞同：0
> 
> 时间：2012-10-09T18:12:59.913
> 
> 标签：modx-revolution

我正在尝试使用 getResources 根据日期类型的电视进行过滤。我想创建一个过滤器，让我可以显示未来事件和过去事件。

电视名称 =`voucherdate`

**我所做的是：**

使用以下内容创建当前日期片段：

```
<?php
return date('Y-m-d H:i:s'); 
```

然后我创建了以下getResource：

**现在发生的事**

```
[[!getResources?
  ...
  &tvFilters=`voucherdate>=[[curDate]]`
]] 
```

**过去的事件**

```
 [[!getResources?
      ...
      &tvFilters=`voucherdate<<[[curDate]]`
    ]] 
```

但它似乎不起作用。`[[curDate]]`我已经通过仅在模板中调用并显示当前日期来测试狙击手的工作位置。

任何人都可以提供一些建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:32:39.033

您所有的模板变量都存储为字符串，因此您将不得不进行一些字符串比较......这可能在 getresources 调用中不起作用......

最好的办法是将日期字符串值传递给一个片段并在那里进行日期比较，例如：

```
[[!getResources? ...
&tvFilters=`[[!DateCompare? &date=`[[*voucherdate]]` &range=`future|past` ]]  == 'true']]
]] 
```

将您的日期转换为纪元或 DateCompare 片段中的某些内容并返回真或假...然后 getResources 〜应该〜返回正确的资源...我认为，未经测试...我想不出更简单的方法我的头顶。除非您最初想将日期存储为纪元值……[无论如何都会更好]然后您尝试的字符串比较将“正常工作”

# javascript - 将 MVC 模型数据传递给客户端 TypeScript 代码

> ID：12805938
> 
> 赞同：14
> 
> 时间：2012-10-09T18:13:30.680
> 
> 标签：javascript, asp.net-mvc, razor, model, typescript

在使用 MVC 时，我有时会通过将 Razor 注入到 JavaScript 中，将服务器的模型数据传递给客户端 JavaScript，如下所示：

```
<script type="text/javascript">
    var myClientGuid = '@Model.MyServerGuid';
</script> 
```

这会设置一个名为`myClientGuid`服务器端模型属性值的JavaScript 变量`MyServerGuid`。当它到达客户端时，代码在浏览器中看起来像这样：

```
<script type="text/javascript">
    var myClientGuid = 'EF0077AB-0482-4D91-90A7-75285F01CA6F';
</script> 
```

这允许外部 JavaScript 文件使用此变量。

我的问题是，在 TypeScript 中，由于 必须通过外部文件引用*所有代码，将服务器端字段传递给 TypeScript 代码的最佳方法是什么？*外部代码文件不能包含 Razor 代码。我是否应该在视图中使用与上述相同的技术，在项目中混合 JavaScript 和 Typescript？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-09T18:19:01.760

TypeScript 编译器只需要知道你的服务器端字段是否存在。最简单的方法是使用环境声明（参见规范的第 10 节）。例如，如果您有一个需要使用 myClientGuid 的 .ts 文件，您可以这样做

```
declare var myClientGuid: string; 
```

在您的主 .ts 文件的顶部。编译器不会为这个 var 声明生成代码，所以你不会破坏任何东西。现在，任何引用该 .ts 文件的文件都将知道在全局范围内有一个 myClientGuid 字符串可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-08T11:24:54.070

另一种解决方案（避免全局变量）是将 TypeScript 代码包装在一个函数中，该函数将所需的服务器端字段作为参数：

在 TypeScript 文件中：

```
function setupMyPage(myGuid:string) {
   ...
} 
```

在 .cshtml 中：

```
<script src='@Url.Content("<path-to-typescript>")'></script>
<script>
    setupMyPage('@Model.MyServerGuid');
</script> 
```

如果您使用的是 RequireJS，您还可以将`setupMyPage`函数导出为模块，以避免将函数添加到全局命名空间：

在 TypeScript 文件中：

```
export = setupMyPage; 
```

在 .cshtml 中：

```
<script>
    require(['@Url.Content("<path-to-typescript>")'], function(setupMyPage) {
        setupMyPage('@Model.MyServerGuid');
    };
</script> 
```

# javascript - 在 iOS 6 上以编程方式触发文件输入对话框

> ID：12805940
> 
> 赞同：2
> 
> 时间：2012-10-09T18:13:33.393
> 
> 标签：javascript, ios, safari, mobile-safari, ios6

如何以编程方式在 iOS 6 上为 DOM 中的输入元素触发选择文件对话框？（即使用Javascript）

```
<input type="file" id="foo"> 
```

*笔记：*

*   *移动 Safari 和 Safari 的行为似乎不同。我已经让它`document.querySelector("input[type=file]").click()`在 safari 中使用。*
*   *如果它在本地点击处理程序中，即由用户启动，它似乎可以工作，但我想触发对话。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T11:19:53.953

经过一些更多的研究，这似乎是不可能的。至少我还没有找到有效的方法。

**我决定使用`<input type='file'>`按钮顶部的定位来解决这个问题，不透明度为 0.01 以使按钮可见。**

# ember.js - emberjs 绑定数据属性

> ID：12805942
> 
> 赞同：13
> 
> 时间：2012-10-09T18:13:36.557
> 
> 标签：ember.js

我想知道在调用视图时是否有办法在模板中绑定数据属性。

例如（这不起作用）：

```
 {{ view App.SomeView data-dateBinding="currentDate" }} 
```

我最终这样做了：

```
<a {{bindAttr data-date="currentDate"}}></a> 
```

调用视图时一定有办法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-08-27T15:50:15.447

更多来自@kurt-ruppel 的出色回答。

一个`:`用于描述属性绑定的示例，完全从视图中完成。

```
App.SomeView = Ember.View.extend({
  attributeBindings: ["date:data-date"],
  date: function() { return '1642-12-06' }
  .... rest of view
}) 
```

更清洁的模板。

```
{{view App.SomeView}} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-10T08:16:30.807

您必须在 App.SomeView 中定义要放入 HTML 中的属性。

```
App.SomeView = Ember.View.extend({
  attributeBindings: ["data-date"]
  .... rest of view
}) 
```

现在`data-dateBinding`应该工作：

```
{{view App.SomeView data-dateBinding="currentDate" }} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T08:47:48.213

FWIW - 这是对@sly7_7 来自顶级答案的评论的回应 - 可以在视图本身中指定 data-* 属性绑定，而不是在模板中设置它。

与 类似`classNameBindings`，您可以在属性前添加一个首选值，并使用“:”连接这些值。看到这一点的最佳位置可能是在[相关的 ember.js 测试](https://github.com/emberjs/ember.js/blob/6a8137902da56b8b1060fcd0bdb748d5e7ae0092/packages/ember-views/tests/views/view/attribute_bindings_test.js)中。相信良好测试的价值，看看它有时如何作为最好的文档。

# python - 列表列表：查找元素的组合

> ID：12805944
> 
> 赞同：3
> 
> 时间：2012-10-09T18:13:47.943
> 
> 标签：python, list

假设我有一个包含 n 个列表的列表。有没有一种巧妙的方法来获得长度为 n 的列表的所有可能组合，每个元素保持它的位置。

这是一个例子：

```
lists=[[1],[2,3],[4,5]] 
```

输出：

```
[[1,2,4],
 [1,3,4],
 [1,2,5],
 [1,3,5]] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-09T18:17:48.713

您可以[`itertools.product`](http://docs.python.org/library/itertools.html#itertools.product)为此使用：

```
>>> import itertools
>>> lists = [[1], [2, 3], [4, 5]]
>>> list(itertools.product(*lists))
[(1, 2, 4), (1, 2, 5), (1, 3, 4), (1, 3, 5)] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:22:43.750

这是首先想到的：

```
def find_permutations(lists, context):
    if len(lists) == 1:
        for item in lists[0]:
            yield context + [item]
    else:
        for item in lists[0]:
           for permutation in find_permutations(lists[1:], context + [item]):
               yield permutation 
```

# binary - 二进制到基数 4

> ID：12805946
> 
> 赞同：-2
> 
> 时间：2012-10-09T18:14:01.970
> 
> 标签：binary

如何将数字从二进制转换为基数 4 `without using extra space`？例如，如果二进制是 1010，那么它会以 4 为底数为 22？我想要算法而不是通过一些内置函数来做，如果我添加一个不需要生成任何字符串作为输出的条件怎么办。我必须使用给定的字符串空间来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:20:54.407

Java 的 Integer 类内置了此功能（查看此[SO 答案](https://stackoverflow.com/a/2858122/16959)）。[它被称为parseInt()](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#parseInt%28java.lang.String,%20int%29)和[toString()](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#toString%28int,%20int%29)的基数属性。请注意，重要的是要了解这仅限于[Character类中](http://docs.oracle.com/javase/6/docs/api/java/lang/Character.html)[MIN](http://docs.oracle.com/javase/6/docs/api/java/lang/Character.html#MIN_RADIX)和[MAX](http://docs.oracle.com/javase/6/docs/api/java/lang/Character.html#MAX_RADIX)基数值之间的基数值，因此不要期望毫不费力地将数字转换为基数 1024。

对于您的问题，您可以这样做：

```
int value = Integer.parseInt("1010", 2); //From Binary
String base4value = Integer.toString(value, 4); //To base 4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:41:36.147

是的，二进制的 1010 是以 4 为底的 22。这很简单，因为 4 是 2 的幂，因此转换很简单 10 = 2, 10 = 2 -> 22。就像一个字节是两个十六进制数字一样。

# c++ - DirectX 背景图像

> ID：12805947
> 
> 赞同：1
> 
> 时间：2012-10-09T18:14:05.153
> 
> 标签：c++, directx

我尝试按照我的 3D directx 书中的教程进行一些修改。我遇到的问题是我想绘制图像但无法正常工作。该示例使用相机，因为它基于一个小游戏，但我只想加载图像而不需要任何花哨的相机转换。（按原样绘制图像，无需调整大小+ alpha 混合）。

这是我的代码，应该包含相关部分。

。H

```
class Screen
{
private:
    IDirect3DTexture9* m_BGImage;
    ID3DXSprite* m_Sprite;

    IDirect3DDevice9* m_Device;

public:
    Screen();
    ~Screen();

    void setDevice(IDirect3DDevice9* device);  
    void setBGImage(std::string path);

    void Draw();
    void onLostDevice();
    void onResetDevice();

    void Clean();
}; 
```

.cpp

```
Screen::Screen() {}

Screen::~Screen()
{
    Clean();
}

void Screen::setDevice(IDirect3DDevice9* device) 
{
    m_Device = device;
    D3DXCreateSprite(m_Device, &m_Sprite);
}

void Screen::setBGImage(std::string path)
{
    D3DXCreateTextureFromFileA(m_Device, path.c_str(), &m_BGImage);
}

void Screen::Draw()
{
    m_Sprite->Begin(D3DXSPRITE_DONOTMODIFY_RENDERSTATE); // This is (so I believe) what causes the problem. If I use D3DXSPRITE_OBJECTSPACE|D3DXSPRITE_DONOTMODIFY_RENDERSTATE like described in the example from my book I only get a black screen.

    m_Sprite->Draw(m_BGImage, 0, &D3DXVECTOR3(256.0f, 256.0f, 0.0f), 0, D3DCOLOR_XRGB(255, 255, 255));
    m_Sprite->Flush();

    m_Sprite->End();
}

void Screen::Clean()
{
    ReleaseCOM(m_Sprite);
    ReleaseCOM(m_BGImage);
}

void Screen::onLostDevice()
{
    m_Sprite->OnLostDevice();
}

void Screen::onResetDevice()
{
    m_Sprite->OnResetDevice();

    m_Device->SetRenderState(D3DRS_ALPHAREF, 10);
    m_Device->SetRenderState(D3DRS_ALPHAFUNC, D3DCMP_GREATER);

    m_Device->SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_TEXTURE);
    m_Device->SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1);
    m_Device->SetRenderState(D3DRS_SRCBLEND, D3DBLEND_SRCALPHA);
    m_Device->SetRenderState(D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA);

    m_Device->SetTextureStageState(0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2);
} 
```

编辑：差点忘了：

```
#define ReleaseCOM(x) { if(x){ x->Release(); x = 0; } } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T03:25:47.407

调用函数“Begin”时应使用 D3DXSPRITE_ALPHABLEND 而不是 D3DXSPRITE_DONOTMODIFY_RENDERSTATE，指定 D3DXSPRITE_ALPHABLEND 并不意味着必须使用 alpha blend，如果不调用 Screen::onResetDevice()，alpha blend 将不起作用，所以这里是 D3DXSPRITE_ALPHABLEND只是使“开始”起作用的参数。如果您不想在调用函数“Begin”时指定任何标志，则可以将 0 传递给它。

```
 m_Sprite->Begin(0); 
 m_Sprite->Draw(m_BGImage, 0, &D3DXVECTOR3(256.0f, 256.0f, 0.0f), 0, D3DCOLOR_XRGB(255, 255, 255));
 m_Sprite->Flush();
 m_Sprite->End(); 
```

参考： http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb205466 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205466%28v=vs.85%29.aspx)

# playframework - 在java中填充@select下拉列表

> ID：12805954
> 
> 赞同：2
> 
> 时间：2012-10-09T18:14:25.313
> 
> 标签：playframework, playframework-2.0

我正在使用播放框架 2.0.4

在我的java文件中，

```
return ok(views.html.name.render(Name.all(),NameForm)); 
```

在我的 html 文件中，

```
@(name: List[Name],NameForm: Form[Name]) 
```

我想通过在@import helper 中使用@select 来对名称数组中的数据创建一个下拉列表（例如在纯HTML 中使用选择、选项标签）。
我对Play 很陌生，因此有人可以告诉我如何存档?
非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T13:02:47.963

一种方法是将您的选项定义为列表，由静态方法返回

创建一个 Java 类

```
public class ComboboxOpts {
    public static List<String> myCustomOptions(){
        List<String> tmp = new ArrayList();

        tmp.add("This is option 1");
        tmp.add("This is option 2");
        tmp.add("This is option 3");
        return tmp;
    }
....
} 
```

在您的 HTML 中，导入帮助程序

```
@import helper._ 
```

并尝试

```
 @select(
     myForm("myDropdownId"),
     options = options(ComboboxOpts.myCustomOptions),
     '_label -> "This is my dropdown label",
     '_showConstraints -> false
 ) 
```

另一种方法是定义一个自定义表单字段。看到这个[链接](http://www.playframework.org/documentation/2.0/JavaFormHelpers)

```
@helper.form(action = routes.Application.submit(), 'id -> "myForm") {
    <select>
        <option>This is option 1</option>
        <option>This is option 2</option>
        <option>This is option 3</option>
    </select>
} 
```

在您提出这些问题之前，请务必进行广泛的 Google 搜索。我确信有教程和/或已经被问过的相同问题

干杯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-13T09:46:31.310

```
Use String in List[String] (in your html) List<String> in your java file.
Or if you want both value and text of drop down to be different like :

    <option value="1">One</option>

Use Map<String, String> instead of List<String> and pass it to @select

    Java file:
    Map<String, String> options = new HashMap<String, String>();
        options.put("1", "One");
        options.put("2", "Two");
    return ok(views.html.name.render(options, NameForm));

    Html:
    @(name: Map<String, String>,NameForm: Form[Name]) 
```

# c - 金字塔分割 OpenCV

> ID：12805956
> 
> 赞同：3
> 
> 时间：2012-10-09T18:14:26.853
> 
> 标签：c, opencv

我有一个关于 OpenCV 的分割方法的问题，即[金字塔分割](http://opencv.willowgarage.com/documentation/c/imgproc_miscellaneous_image_transformations.html#pyrsegmentation)（在 中找到`opencv2/imgproc/imgproc_c.h`）

我不知道如何从分段区域访问点。

我目前正在做的是：

```
cvPyrSegmentation(image, image_seg, storage, &comp, level, threshold1, threshold2);

for (unsigned int cur_seg = 0; cur_seg < total_segments; ++cur_seg) {
      CvConnectedComp* cc = (CvConnectedComp*) cvGetSeqElem(comp, cur_seg);
      // Missing part to access points from this segment 
} 
```

我找不到太多关于如何从每个`cc`元素访问点的信息。建议将不胜感激。

谢谢你。

PS 出于某种原因，C++ 版本的金字塔分割在 OpenCV 的更高版本（>2.3）中不支持，因此需要 C 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T09:03:22.060

根据*Learning OpenCV*，您应该使用`CvRect rect`连接组件结构（`cc->rect`）的属性，它表示组件的边界框（否则`cc->area`会给出组件的区域，`cc->value`平均颜色并且`cc->contour`不为这种分割设置）。

它还精确地表明，您可以按照自己的方式使用此边界框，例如，您可能想要执行[cvFloodFill](http://dasl.mem.drexel.edu/~noahKuntz/openCVTut4.html)操作 - 以便可视化分段组件，将`rect`其用作布尔掩码来约束将被填充的区域。

# select - 删除暴露过滤器中的空选项

> ID：12805959
> 
> 赞同：1
> 
> 时间：2012-10-09T18:14:39.457
> 
> 标签：select, options, drupal-exposed-filter

我有一个带有选择选项下拉字段的公开过滤器，它收集当前视图中的所有实际值。不幸的是，它还在我的视图中收集并显示了空白字段。

我试图创建一个处理这个问题的模块，但我无法让它真正更新我当前暴露的过滤器。有什么建议么？

```
function remove_duplicated_publications_form_alter(&$form, &$form_state, $form_id) {
  if($form_id == 'views_exposed_form'){
    foreach($form as $tmp){
      if ($tmp["#type"]=="select"){
        foreach($tmp["#options"] as $tjek){
          if ($tjek==NULL){
            unset ($tmp["#options"][$tjek]);
          }
        }
      }
    }
  } 
} 
```

--- 找到解决方案！--- 我需要取消设置 $form 数组。以下代码有效：

```
function remove_duplicated_publications_form_alter(&$form) {
  foreach($form['#info'] as $field){
    $field_id = $field['value'];
    if ($form[$field_id]["#type"]=="select"){
      foreach($form[$field_id]["#options"] as $optionvalue){
        if ($optionvalue==NULL){
          unset ($form[$field_id]["#options"][$optionvalue]);
        }
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:16:38.597

将[array_walk()](http://php.net/manual/en/function.array-walk.php)与 unset() 结合使用

# blackberry - 在 JDE 中导入支付 SDK JAR

> ID：12805960
> 
> 赞同：2
> 
> 时间：2012-10-09T18:14:44.250
> 
> 标签：blackberry, blackberry-simulator

你能帮我吗？

我想`Payment SDK Jar v.18`在我的 Blackberry JDE 项目中导入。我遵循以下步骤：

1) 在 BlackBerry Java Development Environment 的文件窗格中，右键单击要添加库的项目，然后单击“属性”。

2) 打开构建选项卡

3）在部分：导入的jar文件：`Click Add`

4) 导航到您提取支付服务 SDK 的位置并双击该`paymentapi.jar`文件。

5) 点击确定

6）运行模拟器

在启动我的应用程序时，我看到了这个错误：

> 启动您的 GPS 应用程序时出错：模块“MODULE_NAME”存在验证错误。

你能告诉我为什么我会收到这个错误吗？-提前致谢。

# r - 删除重复项，保留具有最大绝对值的条目

> ID：12805964
> 
> 赞同：35
> 
> 时间：2012-10-09T18:15:07.473
> 
> 标签：r, duplicates, duplicate-removal

假设我有四个样本：id=1、2、3 和 4，每个样本都有一个或多个测量值：

```
> a <- data.frame(id=c(1,1,2,2,3,4), value=c(1,2,3,-4,-5,6))
> a
  id value
1  1     1
2  1     2
3  2     3
4  2    -4
5  3    -5
6  4     6 
```

我想删除重复项，每个 ID 只保留一个条目 - “值”列的绝对值最大的条目。即，这就是我想要的：

```
> a[c(2,4,5,6), ]
  id value
2  1     2
4  2    -4
5  3    -5
6  4     6 
```

我怎么能在 R 中做到这一点？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-10-09T18:24:30.173

第一的。按顺序排序，将不太需要的项目放在`id`组中的最后

```
 aa <- a[order(a$id, -abs(a$value) ), ] #sort by id and reverse of abs(value) 
```

然后：删除`id`组内第一个之后的项目

```
 aa[ !duplicated(aa$id), ]              # take the first row within each id
  id value
2  1     2
4  2    -4
5  3    -5
6  4     6 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-09T18:48:12.660

`data.table`如果您的数据集非常大，则可能需要一种方法：

```
library(data.table)

aDT <- as.data.table(a)
setkey(aDT,"id")

aDT[J(unique(id)), list(value = value[which.max(abs(value))])] 
```

或者一个不那么快但仍然很快的替代方案：

```
library(data.table)
as.data.table(a)[, .SD[which.max(abs(value))], by=id] 
```

此版本返回 的所有列`a`，以防真实数据集中有更多列。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-05-25T10:15:11.833

这是一种`dplyr`方法

```
library(dplyr)
a %>% 
        group_by(id) %>%
        top_n(1, abs(value))

# A tibble: 4 x 2
# Groups:   id [4]
#     id value
#  <dbl> <dbl>
#1     1     2
#2     2    -4
#3     3    -5
#4     4     6 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-09T18:19:05.163

签出`?aggregate`：

```
aggregate(value~id,a,function(x) x[which.max(abs(x))]) 
```

* * *

我喜欢@DWin 的答案，但我想展示这也可以与元数据一起使用：

```
aa<-merge(aggregate(value~id,a,function(x) x[which.max(abs(x))]),a)
# Fails if the max value is duplicated for a single id without next line.
aa[!duplicated(aa),] 
```

* * *

我情不自禁地创造了最后一个答案：

```
do.call(rbind,lapply(split(a,a$id),function(x) x[which.max(abs(x$value)),])) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-09T18:56:51.143

另一种方法（虽然代码可能看起来有点麻烦）是使用`ave()`：

```
a[which(abs(a$value) == ave(a$value, a$id, 
                            FUN=function(x) max(abs(x)))), ]
#   id value
# 2  1     2
# 4  2    -4
# 5  3    -5
# 6  4     6 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-09T18:21:45.360

```
library(plyr)
ddply(a, .(id), function(x) return(x[which(abs(x$value)==max(abs(x$value))),])) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-14T22:51:43.970

您可以使用 dplyr 执行此操作，如下所示：

```
library(dplyr)
a %>%
  group_by(name) %>%
  filter(n == max(n)) %>%
  ungroup() 
```

# silverlight - 在 Silverlight 中实现 MVVM：异步执行问题

> ID：12805968
> 
> 赞同：1
> 
> 时间：2012-10-09T18:15:22.433
> 
> 标签：silverlight, mvvm

嗨，我遇到了一个问题，找不到合适的解决方案。在我的视图中，我有几个需要从 Viewmodel 填充的组合框。视图的 DataContent 定义如下：

```
<navigation:Page.Resources>
    <viewModel:TheViewModel x:Key="viewModel"/>
</navigation:Page.Resources>

<navigation:Page.DataContext>
    <Binding Source="{StaticResource viewModel}"/>
</navigation:Page.DataContext> 
```

然后在 ViewModel 构造函数中，我有如下代码：

```
LoadOperation<ProducType> loadPT = context.Load(context.GetProducTypeQuery());
    loadPT.Completed += (sender1, e1) => {
        if (!loadPT.HasError) {
            LoadOperation<Client> loaC = context.Load(context.GetClientQuery());
                loaC .Completed += (sender2, e2) => {
                    if (!loaC.HasError) {
                        ProducTypes = loadPT.Entities;
                        Clients= loaC.Entities;   
                        Remitentes = loadr.Entities;
                     }
                  };
         }
    }; 
```

使用此配置时，我的组合框永远不会被填充，因为 Silverlight 的异步模型，当框架完成创建视图时，上面的代码尚未执行。我敢肯定这一定是我缺乏知识，我在porgamming方面不是新手，但在silverlight方面非常新，任何帮助将不胜感激Thanx Elio

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:25:46.263

我的 ViewModel 派生自实现 INotifyPropertyChanged 的​​基类。我将组合框绑定到 ViewModel 上的公共属性。进行异步调用以获取属性 getter 中的数据。

这是一个例子：

视图模型：

```
public class MyViewModel : BaseViewModel
{
    private List<MyObject> _myObjectlist;
    public List<MyObject> MyObjectList
    {
         get
         {
             if (_myObjectList == null)
             {
                  _ctx.Load(q=>{
                        _myObjectList = q.Value;
                        //INotifyPropertyChanged implementation
                        RaisePropertyChanged("MyObjectList"); 
                   },null);
             }
         }
    }
} 
```

# java - Maven 构建的 Java 格式字符串错误

> ID：12805969
> 
> 赞同：1
> 
> 时间：2012-10-09T18:15:28.653
> 
> 标签：java, maven

当我开始我的 Maven 构建时，它失败并出现此错误

> “转换 = s，标志 = #”

在下面的测试中。

```
public class Test {

    public static void main(String[] argv) {
        String a = String.format("%1$#" + (250 + 1) + "s", "");
        System.out.println("a = " + a);
    }
} 
```

请指教。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:21:06.380

所以这实际上完全取决于一个看起来像这样的调用：

```
String.format("%1$#251s", ""); 
```

如果您查看[`Formatter`](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html)文档，此格式字符串请求字符串转换 ( `s`)，宽度为 251，标志为`#`.

字符串转换的文档状态：

> 如果给出了 '#' 标志并且参数不是 Formattable ，则将抛出 FormatFlagsConversionMismatchException。

现在`java.lang.String`没有实现`Formattable`- 所以抛出异常，完全按照文档记录。

你*期望*这会做什么？

# iphone - UIImageWriteToSavedPhotosAlbum 未将图像保存到相册

> ID：12805970
> 
> 赞同：0
> 
> 时间：2012-10-09T18:15:31.383
> 
> 标签：iphone, uiscrollview, uiimageview, ios6, photo

当用户长按图像时，我试图将图像从滚动视图保存到相册，操作表显示保存照片按钮，当点击保存按钮时，它没有将图像保存到相册

```
 - (void)viewDidLoad

{    self.view.backgroundColor = [UIColor blackColor];
UIScrollView *imageScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
imageScrollView.pagingEnabled = YES;
NSInteger numberOfViews = 61;
for (int i = 0; i < numberOfViews; i++) {
    CGFloat xOrigin = i * self.view.frame.size.width;
    UIButton *myButton = [UIButton buttonWithType:UIButtonTypeCustom];

    [myButton addTarget:self action:@selector(dismissView:) forControlEvents:UIControlEventTouchUpInside];

    myButton.frame = CGRectMake(xOrigin, 10, 60, 35);

    //[myButton addGestureRecognizer:tap];

    [myButton.layer setMasksToBounds:YES];

    [myButton.layer setCornerRadius:10.0f];

    myButton.layer.borderWidth = 2;

    myButton.layer.borderColor = [[UIColor whiteColor] CGColor];

    [myButton setTitle:@"Done" forState:UIControlStateNormal];

    myButton.backgroundColor = [UIColor clearColor];

    NSString *imageName = [NSString stringWithFormat:@"image%d.png", i];
    UIImage *image = [UIImage imageNamed:imageName];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    _imageView.tag = 128;
    imageView.frame = CGRectMake(xOrigin, 0, self.view.frame.size.width, self.view.frame.size.height);

    UILongPressGestureRecognizer *gestureRecognizer = [[UILongPressGestureRecognizer alloc]
                                                       initWithTarget:self
                                                       action:@selector(handleLongPress:)];

    //imageScrollView.userInteractionEnabled = YES;
    [imageScrollView addGestureRecognizer:gestureRecognizer];
    gestureRecognizer.delegate = self;
    [gestureRecognizer release];

    [imageScrollView addSubview:imageView];
    [imageScrollView addSubview:myButton];

    //[imageView release];

}
imageScrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfViews, self.view.frame.size.height);

[self.view addSubview:imageScrollView];
[imageScrollView release];
 }

 -(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
switch (buttonIndex) {
    case 0:
    [_imageScrollView viewWithTag:128];
    UIImageWriteToSavedPhotosAlbum(_imageView.image, self, @selector(image: didFinishSavingWithError:contextInfo:), nil);//When i add breakpoint at this statement in result it shows storage zero but alert view says success photo got saved in photo album

        break;

    default:
        break;
}
}

- (void)image:(UIImage *)image didFinishSavingWithError:(NSError *)error contextInfo:(void *)contextInfo
 {
if (error != NULL)
{

    alert = [[UIAlertView alloc] initWithTitle:@"Error"
                                       message:@"Unable to save image to Photo Album."
                                      delegate:self cancelButtonTitle:@"Ok"
                             otherButtonTitles:nil];
     } else{
        alert = [[UIAlertView alloc] initWithTitle:@"Success"
                                           message:@"Image saved to Photo Album."
                                          delegate:self cancelButtonTitle:@"Ok"
                                 otherButtonTitles:nil];
    [alert show];
    [alert release];
   }
   } 
```

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:49:09.947

这可能是隐私设置的问题 - 人们一直在使用我的应用程序遇到此问题，并且没有报告错误消息。理论上，尝试保存照片应自动询问用户是否应允许该应用访问他们的照片，但在某些情况下，用户需要转到“设置”>“隐私”>“照片”并确保您的应用被允许。

# jquery - ColorBox 未加载 - 所有 JS 都正确通过

> ID：12805977
> 
> 赞同：0
> 
> 时间：2012-10-09T18:15:54.590
> 
> 标签：jquery, html, css, colorbox

我尝试设置一个颜色框（当您单击“注册我”按钮时），但它似乎没有启动。找不到任何 javascript 错误或控制台错误，只是似乎没有触发。

我已经链接了样式表、JS 文件并包含了标题脚本，它们都可以正常打开并且被正确地调用到页面中。

```
<link rel="stylesheet" href="css/colorbox.css" />
<script src="js/jquery.colorbox.js"></script>
    <script>
      $(document).ready(function(){
        //Examples of how to assign the ColorBox event to elements
        $(".inline").colorbox({inline:true, width:"50%"});
        $(".callbacks").colorbox({
          onOpen:function(){ alert('onOpen: colorbox is about to open'); },
          onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
          onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
          onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
          onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
        });

        //Example of preserving a JavaScript event for inline calls.
        $("#click").click(function(){ 
          $('#click').css({"background-color":"#f00", "color":"#fff", "cursor":"inherit"}).text("Open this window again and this message will still be here.");
          return false;
        });
      });
    </script> 
```

我已经创建了内联内容 div（隐藏）并正确链接了按钮。

```
<span class="btn"><a href="#inline_content">Sign Me Up!</a></span> 
```

这是内联内容：

```
<div style='display:none'>
  <div id='inline_content' style='padding:10px; background:#fff;'>
  <p><strong>This content comes from a hidden element on this page.</strong></p>
  <p>The inline option preserves bound JavaScript events and changes, and it puts the content back where it came from when it is closed.</p>
  </div>
</div> 
```

[现场演示](http://www.rubytuesdaycreative.co.uk/testsite/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:30:00.537

尝试将 .inline 类放在要打开颜色框的链接上。

```
<span class="btn"><a href="#inline_content" class="inline">Sign Me Up!</a></span> 
```

这将利用这个颜色框实例化：

```
$(document).ready(function(){
   $(".inline").colorbox({inline:true, width:"50%"});
}); 
```

您不需要所有这些回调来加载颜色框，因此我建议使用此颜色框实例化 (.inline) 而不是 .callbacks 之一。

*   克里斯

**编辑：**

到目前为止，您的 jQuery 无效，导致它中断：

```
 <script>
      $(document).ready(function(){
    $(".callbacks").colorbox({
      inline:true,
      onOpen:function(){ alert('onOpen: colorbox is about to open'); },
      onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
      onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
      onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
      onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
    });
}); <-- Extra closing tag
        }); <-- Extra closing tag

        //Example of preserving a JavaScript event for inline calls.
        $("#click").click(function(){ 
          $('#click').css({"background-color":"#f00", "color":"#fff", "cursor":"inherit"}).text("Open this window again and this message will still be here.");
          return false;
        });
      });
    </script> 
```

为了简单起见并修复您的错误，我建议将整个代码替换为以下代码：

```
<script>
    $(document).ready(function(){
       $(".inline").colorbox({inline:true, width:"50%"});
    });
</script> 
```

然后将 class="inline" 添加到您的链接中，它会像魅力一样工作=]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:31:19.810

您代码中的所有选择器都已损坏。试试这个代码：

```
<span class="btn"><a class="callbacks" href="#inline_content">Sign Me Up!</a></span> 
```

和jQuery：

```
$(document).ready(function(){
    $(".callbacks").colorbox({
      inline:true,
      onOpen:function(){ alert('onOpen: colorbox is about to open'); },
      onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
      onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
      onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
      onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
    });
}); 
```

演示：http: [//jsfiddle.net/a4urV/](http://jsfiddle.net/a4urV/)

# jsf - 在 JSF 1.2 中创建新会话

> ID：12805978
> 
> 赞同：0
> 
> 时间：2012-10-09T18:16:03.313
> 
> 标签：jsf, jsf-1.2

我有一个登录页面，在输入凭据并提交后，我正在复制当前会话的属性（比如说 A）并使用`((HttpSession) FacesContext.getCurrentInstance().getExternalContext().getSession(false)).invalidate()`. 之后，我正在创建一个新会话（比如说 B），使用`FacesContext.getCurrentInstance().getExternalContext().getSession(true)`并将属性设置回新会话。这样做是为了防止会话固定。

这在 JSF 2.0 中运行良好，但在 JSF 1.2 中，在执行上述逻辑并导航用户之后，新创建的会话在 RESTORE_VIEW 阶段之前丢失（未终止）并且 JSF 正在创建另一个会话（假设是 C）。我有一个自定义`HttpSessionListener`并且能够看到 B 和 C。如何在 JSF 1.2 中创建或处理会话？

# javascript - 使用 jQuery/Javascript 获取上周日期

> ID：12805981
> 
> 赞同：19
> 
> 时间：2012-10-09T18:16:10.870
> 
> 标签：javascript, jquery

我正在尝试在 JavaScript 中获取上周日期，但没有时间。

例如，`10-02-2012`, 而不是`10-02-12 13:34:56 GMT`。

有一个简单的解决方案吗？

谢谢！

**编辑：**

我正在尝试使这个动态化，以便生成的变量总是比当前日期早一周。这是我为计算今天变量所做的工作，如果这有帮助或可以使用！

```
var currentTime = new Date();
var month = currentTime.getMonth() + 1
var day = currentTime.getDate();
var year = currentTime.getFullYear();
var today = month + "-" + day + "-" + year;
alert(today) 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-10-09T18:21:12.757

我更喜欢这样的东西​</p>

```
function getLastWeek() {
  var today = new Date();
  var lastWeek = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);
  return lastWeek;
}

var lastWeek = getLastWeek();
var lastWeekMonth = lastWeek.getMonth() + 1;
var lastWeekDay = lastWeek.getDate();
var lastWeekYear = lastWeek.getFullYear();

var lastWeekDisplay = lastWeekMonth + "/" + lastWeekDay + "/" + lastWeekYear;
var lastWeekDisplayPadded = ("00" + lastWeekMonth.toString()).slice(-2) + "/" + ("00" + lastWeekDay.toString()).slice(-2) + "/" + ("0000" + lastWeekYear.toString()).slice(-4);

console.log(lastWeekDisplay);
console.log(lastWeekDisplayPadded);
```

如果您使用的是 jQuery UI，您可以这样做而不是手动步骤来构建字符串

```
var lastWeekDisplay = $.datepicker.formatDate('mm/dd/yy', getLastWeek()); 
```

或者今天

```
var todayDisplay = $.datepicker.formatDate('mm/dd/yy', new Date()); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-09T18:18:16.090

```
 var firstDay = new Date("2009/10/02");
 var previousweek= new Date(firstDay.getTime() - 7 * 24 * 60 * 60 * 1000); 
```

看看这个链接。它将有所帮助：- [http://code.google.com/p/datejs/](http://code.google.com/p/datejs/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-11-07T04:46:54.900

[如果不提及Moment.js](http://momentjs.com) ，我们就无法回答 JavaScript 日期问题。

```
moment().subtract('days', 7).format('MM-DD-YYYY') 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-11-23T11:51:12.367

可能没有外部依赖

```
 new Date().setDate(new Date().getDate() - 7) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T18:17:54.877

如果你真的想从像 10-02-12 13:34:56 GMT 这样的完整时间戳创建它，你可能想要这样做：

```
var time = '10-02-12 13:34:56 GMT';
document.write(time.substr(0,7)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-15T04:59:20.183

使用此代码减去任何天数，因为我选择了 9 它将给出包括今天在内的最后 10 天的结果

```
var date = new Date();
    var day=date.getDate();
    var month=date.getMonth() + 1;
    var year=date.getFullYear();
    var startDate=day+"/"+month+"/"+year;
    var dayBeforeNineDays=moment().subtract(9, 'days').format('DD/MM/YYYY');
    startDate=dayBeforeNineDays;
    var endDate=day+"/"+month+"/"+year; 
```

# php - 时间同步与高延迟

> ID：12805982
> 
> 赞同：9
> 
> 时间：2012-10-09T18:16:12.317
> 
> 标签：php, javascript, ajax, timer

我正在做一个拍卖脚本，访问者和服务器之间的时间同步是必要的（拍卖什么时候结束）。每次用户出价，拍卖结束时间都会延长几秒钟。我的问题是有几个用户抱怨他们的计时器跳过（几秒钟）并发现这是因为连接延迟很高。

我当前的算法有一个每秒运行的javascript函数，通过ajax请求为拍卖留出时间。有没有更好的方法来解决这个问题，特别是对于高延迟用户，以防止计时器跳过问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T09:10:17.160

### 自适应间隔

首先，我建议你减少轮询的数量。我不知道你的服务器实现，但是一旦你有几个用户，当前的设置会创建很多请求。

我建议您根据剩余时间调整轮询间隔。如果距离拍卖结束还有两个小时，我们可能并不真正关心额外的秒数是否仅每分钟从服务器获取，对吧？你可以这样做

```
pollingInterval = secondsLeft / 100 
```

间隔更短，结果在拍卖结束时更准确。

### 服务器发送事件

在最后一分钟左右，当您想要高精度时，如评论中所讨论的那样，在短时间内定期轮询并不是最佳解决方案。长轮询是一种选择，但您还应该查看 HTML5 [Server Sent Events](https://en.wikipedia.org/wiki/Server-sent_events)，它类似于长轮询的本机浏览器实现。对 Websockets有[很好的介绍和比较](http://www.html5rocks.com/en/tutorials/eventsource/basics/)。浏览器支持已经相当不错了，[有一个](https://github.com/remy/polyfills/blob/master/EventSource.js)针对不受支持的浏览器的 polyfill，它回退到……轮询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:02:18.467

你有没有研究过长轮询？使用您可以使用 jquery/javascript 倒计时时钟，然后在每次下新出价时更改倒计时时间。应该大幅减少你的 ajax 调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T08:14:59.727

> javascript function that runs every second

This the old way to do what you want.

I think you need to use web-sockets to ensure real-time delivery for all users. If you want to save time you can use any web-socket servers available instead of making it yourself.

I prefer Real-Time Pusher It's easy and you can use it free but with a limited number of users. Also you can upgrade for more users. [www.pusher.com](http://www.pusher.com)

Also, have good API documentation to help you to implement what you want fast and easy.

For any help with Pusher-or-websockets feel free to ask.

# jquery - 在 DataList 控件上实现 Jquery Sortable

> ID：12805983
> 
> 赞同：1
> 
> 时间：2012-10-09T18:16:19.680
> 
> 标签：jquery, jquery-ui

我是 Jquery 的新手，我正在尝试按照这篇文章[Jquery Example](http://wiki.asp.net/page.aspx/1715/how-to-implement-jquery-ui-sortable-in-datalist-control/ "例子")进行设置，但我无法拖动我的项目。我不确定我做错了什么。我的代码如下。谢谢，

```
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>

$(function () {
   $("#<%=dlProcessList.ClientID %> tbody").sortable({
       handle: ".handle",
       placeholder: 'ui-state-highlight',
       cursor: 'move',
       start: function (event, ui) {
           ui.placeholder.height(ui.helper.height());
       }
   }).disableSelection();
});        

<asp:DataList ID="dlList" runat="server" >
  <HeaderTemplate>
      <tbody>
  </HeaderTemplate>

  <ItemTemplate>
       // My Data to display
  </ItemTemplate>  

  <FooterTemplate>
      </tbody>
  </FooterTemplate>
</asp:DataList> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:53:32.287

Try this:

Add "//" to your script imports, like this:

```
<script src="//code.jquery.com/jquery-1.8.2.js"></script>
<script src="//code.jquery.com/ui/1.9.0/jquery-ui.js"></script> 
```

Also remove all the sortable options and just use the defaults to see if you can get it working...

Change this:

```
$(function () {
   $("#<%=dlList.ClientID %> tbody").sortable({
       handle: ".handle",
       placeholder: 'ui-state-highlight',
       cursor: 'move',
       start: function (event, ui) {
           ui.placeholder.height(ui.helper.height());
       }
   }).disableSelection();
}); 
```

To this:

```
$(function () {
    $("#<%=dlList.ClientID %> tbody").sortable();
}); 
```

See if that gets it working.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:29:07.787

看，这可能是你的问题...

[http://www.foliotek.com/devblog/make-table-rows-sortable-using-jquery-ui-sortable/](http://www.foliotek.com/devblog/make-table-rows-sortable-using-jquery-ui-sortable/)

[http://jsfiddle.net/bgrins/tzYbU/](http://jsfiddle.net/bgrins/tzYbU/)

# c# - EF推迟设置属性直到插入

> ID：12805984
> 
> 赞同：1
> 
> 时间：2012-10-09T18:16:23.893
> 
> 标签：c#, entity-framework, entity-framework-4

```
public class User {
    int Id { set; get; } // autogenerated on insert
    public string Username { set; get; }
} 
```

然后在我的代码中的一些地方我有以下内容：

```
var user = new User();
user.Username = string.Format("user{0}", user.Id);
dbContext.User.Add(user);
dbContext.SaveChanges();
Debug.WriteLine(user.Username); // outputs "User0" when the Id is ..not 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:20:01.567

您正在插入一个新创建的用户，而不是插入您创建的用户：

改变 ：

```
var user = new User();
user.Username = string.Format("user{0}", user.Id);
dbContext.User.Add(new User()); 
```

至：

```
var user = new User();
user.Username = string.Format("user{0}", user.Id);
dbContext.User.Add(user); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:27:42.443

这对您有用的唯一方法是，如果您的 User 首先有一个空`Username`属性，`.SaveChanges()`然后`user.Username = string.Format(...)`是 ，然后再次保存。即使您要通过直接 SQL 编写此代码，在 db 提交更改之前您也不知道行的 ID。

如果没有多次保存，您所要求的就无法**编辑。**

# linux - 我正在尝试在 ubuntu 中使用 c 实现计时器，但收到声明错误

> ID：12805990
> 
> 赞同：0
> 
> 时间：2012-10-09T18:16:33.853
> 
> 标签：linux, ubuntu, timer

请帮助我，我想在 ubunto 中使用 c 实现计时器。我已经编写了代码，但它给出了两个错误。我正在使用 gcc 的 -lrt 选项编译它。我得到的错误是：timer1.c：在函数'main'中：timer1.c:18:52：错误：'SIG'未声明（在此函数中首次使用）timer1.c:18:52：注意：每个未声明的标识符对于它出现在 timer1.c:21:23 中的每个函数只报告一次：错误：未声明“处理程序”（在此函数中首次使用）

我的代码是：

```
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <signal.h>
#include <time.h>

timer_t timerid;

int main(int argc, char *argv[])
{

           struct sigevent sev;
           struct itimerspec its;
           long long freq_nanosecs;
           sigset_t mask;
           struct sigaction sa;
    printf("Establishing handler for signal %d\n", SIG);

    sa.sa_flags = SA_SIGINFO;
    sa.sa_sigaction = handler;
    sigemptyset(&sa.sa_mask);

    sev.sigev_notify = SIGEV_SIGNAL;
    sev.sigev_signo = SIG;
    sev.sigev_value.sival_ptr = &timerid;

 printf("timer ID is 0x%lx\n", (long) timerid);
//    timer_create(CLOCKID, &sev, &timerid);
    /* Start the timer */

    its.it_value.tv_sec = 1000;
    its.it_value.tv_nsec =0;
    its.it_interval.tv_sec = its.it_value.tv_sec;
    its.it_interval.tv_nsec = its.it_value.tv_nsec;

    timer_settime(timerid,0, &its, NULL);
    sleep(10);

}

 static void handler(int sig, siginfo_t *si, void *uc)
{
   if(si->si_value.sival_ptr != &timerid)
    {
        printf("Stray signal\n");
        } 
  else 
    {
        printf("Caught signal from timer\n");
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:25:00.097

`SIG`未声明，因为您从未声明它，而且我们无法告诉您如何修复它，因为我们不知道它应该是什么。`handler`未声明，因为您忘记了前向声明。将函数签名的副本放在使用它的函数之前，后跟分号。

```
static void handler(int sig, siginfo_t *si, void *uc);

int main(int argc, char *argv[])
{
   ... 
```

# php - 分页：如何知道页面的评论属于哪里

> ID：12805992
> 
> 赞同：0
> 
> 时间：2012-10-09T18:16:44.317
> 
> 标签：php, mysql, pagination

我正在使用具有以下数据库结构的 php 和 mysql 开发一个博客系统：

```
Article
   -id
   -firstMessage
   -lastMessage
   -body

Comment
   - id
   - article_id
   - publiched_date
   - body 
```

这里的想法是利用分页，其中有很多评论的文章显示一个链接树`[first][1][2][3][last]`，如**10条** ***评论***一页。一切顺利，我创建了一个不错的 sql，它根据 url 的页码选择 10 条消息：

> example.com/?article=3&page=2

**问题出在哪里？**好吧，假设我的主页中有这个网址：

> example.com/?article=3&message=3565

根据上面的url，如何确定这条消息所在的页码？你有什么想法可以引导我走向正确的方向吗？

## 编辑

*   消息id不是连续的，例如一篇文章可以有评论：125、364、561、1522

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:19:28.563

如果您每页显示 10 条评论并请求消息 3565，您可以这样做：

```
$pageNumber = floor($_GET['message'] / 10) + 1; 
```

**编辑**

谢谢@Alix。

**编辑#2**

在对 OP 进行编辑后，如果没有看到数据库结构是什么样的，最坏的情况是，您必须获取整个评论列表，因为它会出现在网站上，并找到您的消息索引寻找。

我意识到这不一定是您想听到的，但是如果不查看您的数据库的外观，就没有其他真正的方法可以知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:06:20.203

基本上，从同一篇文章中选择评论，按 ID 排序（或者如果`id`可以*乱序*--non-consecutive 可以使用另一列），然后对结果进行一些数学运算。这是代码（[演示](http://sqlfiddle.com/#!2/984c7/19)）：

```
SELECT (
  SELECT CEILING((count(*) + 1) / 10)
  FROM `Comment`
  WHERE `id` < `comment`.`id`
  AND `article_id` = `comment`.`article_id`
) AS `page`
FROM `Comment`
WHERE `id` = ?
AND `article_id` = ? 
```

只需将评论 ID 和文章 ID 插入其中`?`（或者，更好的是，在准备好的语句中使用这个确切的代码）。如果您更改每页的评论数，请确保您也更改`10`了查询中的 。

对于这个查询，你只需要一个索引`article_id`（和一个`PRIMARY`索引`id`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T18:34:51.183

我想你必须进行查询，这样的事情应该可以工作：

```
SELECT CEIL((COUNT(id) + 1) / $nb_message_per_page) AS page_for_message
FROM comment
WHERE article_id = $article_id
AND published_date < (SELECT published_date FROM comment WHERE id = $message_id) 
```

根据显示评论的排序选择，您必须更改`<`for a `>`，该查询假定`published_date DESC`排序

PS：我不知道这是否是一个错字，但你已经`publiched_date`在你的数据库模式中写了

**编辑**
如果不进行排序，行可能按 PRIMARY KEY 排序，这就像`published_date DESC`排序

**编辑 2**
正如@bfrohs 所说，如果测试 ( `<`) 处于打开状态`published_date`（或任何其他包含非唯一数据的列）而不是`id`.
由于没有排序，因此使用`id`是更好的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T18:29:15.230

从消息编号返回页面是相当重要的。最简单的方法是简单地将页码传递给消息阅读脚本，因此您可以简单地将该页码嵌入到“返回”链接中，例如...

消息.php：

```
<a href="readmessage.php?messageID=1234&page=7">1234</a> 
```

readmessage.php：

```
<a href="messages.php?page={$_GET['page']}">Back</a> 
```

这将省去计算您来自哪个页面的麻烦，因为您只需随身携带页码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-09T18:18:59.030

您需要设置每页显示的项目数，并使用它来将消息分成页面

# javascript - 无法让我的 jquery 滑块与 Internet Explorer 一起使用

> ID：12805995
> 
> 赞同：1
> 
> 时间：2012-10-09T18:16:56.313
> 
> 标签：javascript, jquery, internet-explorer, slider

我试图编写我的 jQuery 滑块，但我无法让 Javascript 与 IE 一起使用。它适用于 Firefox 和 Safari

我的 CSS 样式：

```
<style type="text/css">
.slider {
    width:656px;
    height:390px;
    overflow:hidden;
    margin:30px auto;
    background-image:url(images/loading.gif);
    background-repeat:no-repeat;
    background-position:center;
}

.slider1 img {
    width:656px;
    height:390px;
    display:none;

}
</style> 
```

我的标题中的Javascript：

```
<script type="application/javascript">

function Slider(){
   $(".slider #1").show("fade",500);
   $(".slider #1").delay(5500).hide("slide", {direction: 'left'},500);

   var sc=$(".slider img").size();
   var count=2;

   setInterval(function(){
        $(".slider #"+count).show("slide",{direction: 'right'},500);
        $(".slider #"+count).delay(5500).hide("slide", {direction: 'left'},500);
        if(count ==sc){
            count=1;

        }else{
        count= count + 1;
        }
    },6500);
}
</script> 
```

html中的滑块：

```
<body onload="Slider();">
   <div class="slider">
       <img id="1" src="img/slider1.gif" border="0" />
       <img id="2" src="img/slider2.gif" border="0" />
       <img id="3" src="img/slider3.gif" border="0" />
   </div>
</body> 
```

谢谢如果有人可以帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:22:34.017

改变你的脚本标签

```
<script type="application/javascript"> 
```

到

```
<script type="text/javascript"> 
```

或者

```
<script> 
```

# javascript - 多页 jquerymobile 文档的第二页上的按钮的单击事件不会触发

> ID：12805997
> 
> 赞同：1
> 
> 时间：2012-10-09T18:17:11.193
> 
> 标签：javascript, jquery, jquery-mobile, jquery-events, jquery-click-event

我的简单移动应用程序有 3 个页面，所有页面都用 divs/ 划分，`data-role="page"`并且在同一个文档 (.html) 中。页面加载完美，但如果我导航到第二页，按钮上的一个非常简单的单击事件不起作用。

在我的脚本标签中有以下内容：

```
$('#igetdetails').click(function () {
    alert("hello");
}) 
```

`igetdetails`是按钮的 id。警报永远不会弹出。

但是，当我将此代码放在该页面的 pageinit 事件中时，它会立即弹出页面加载。

这告诉我一定有一些非常简单的事情我错过了，但经过 8 小时的紧张和痛苦，我正在寻求帮助。

这是完整的头部部分：

```
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
    </title>
    <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.css"
    />
    <link rel="stylesheet" href="my.css" />
    <style>
        /* App custom styles */
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
    </script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.1.1/jquery.mobile-1.1.1.min.js">
    </script>
    <script src="my.js">
    </script>
    <script>
  //  Invoice = new Object();
   $( '#page1' ).live( 'pageinit',function(event){
        //alert( 'This page was just enhanced by jQuery Mobile!' );

       // Ajax Called When Page is Load/Ready (Load Customers)
        jQuery.ajax({
            url: 'list_customers.php',
            global: false,
            type: "POST",
            dataType: "xml",
            async: false,    
            success: populateCustomers
        }); 

        jQuery.ajax({
            url: 'list_salesmen.php',
            global: false,
            type: "POST",
            dataType: "xml",
            async: false,    
            success: populateSalesmen
        }); 

        $("#iinv_customer").bind( "change", function(event, ui) {
            Invoice.CustomerID = $('#iinv_customer').val();                
        });
        $("#iinv_salesman").bind( "change", function(event, ui) {
            Invoice.SalesmanID = $('#iinv_salesman').val();                
        });
        $("#iinv_date").bind( "change", function(event, ui) {
            Invoice.Date = $('#iinv_date').val();                
        });
        $("#iinv_no").bind( "change", function(event, ui) {
            Invoice.invno = $('#iinv_no').val();                
        });
        $("#iinv_add").bind( "click", function(event, ui) {

            $('#iinv_customer').selectmenu('disable');
            $('#iinv_salesman').selectmenu('disable');
            $('#iinv_no').textinput('disable');
            $('#iinv_date').textinput('disable');                

            $.mobile.changePage("#page4");
        });
        $("#iinv_cancel").bind( "click", function(event, ui) {

            $('#iinv_customer').selectmenu('disable');
            $('#iinv_salesman').selectmenu('disable');
            $('#iinv_no').textinput('disable');
            $('#iinv_date').textinput('disable');                

            //$('#page1').reset();
            location.reload();
        });

    });

     $( '#page4' ).live( 'pageinit',function(event){
        //alert( 'This page was just enhanced by jQuery Mobile!' );

        //$('#iSelectedCustomer').html($('#iinv_customer').val());
        $('#iSelectedCustomer').html($("#iinv_customer option[value='" + $('#iinv_customer').val() +"']").text());
       // document.getElementById("iSelectedCustomer").innerHTML = $('#iSelectedCustomer').html();
            //var element = document.getElementById('iSelectedCustomer');
            //alert(element.value);
            //element.value = $('#iinv_customer').value;
            //alert(element.value);
    //    var selected = $(#iinv_customer).val;

     //   $('#iSelectedCustomer').val(selected);

       jQuery.ajax({
            url: 'list_products.php',
            global: false,
            type: "POST",
            dataType: "xml",
            async: false,    
            success: populateProducts
        }); 

     });

     $('#igetdetails').click(function () 
     {    
         alert("hello");
     //$("#ili_prod").bind( "change", function(event, ui) {
     //var data = { prod: 12};
     var data = { prod: $("#ili_prod").val()};
     // prodid = $(this).attr('value');

     jQuery.ajax({
        url: 'get_products_details.php',
        type: "POST",
        dataType: "xml",
        data:data,
        async: false,    
        success: populateProductsDetails

     });
     alert($("#ili_prod").val());
     alert("hello");
     });

    </script>
</head> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:33:23.913

您在 DOM 元素存在之前运行 JS 代码。由于您使用的是多页模板，因此您只需将问题中的代码放在`document.ready`事件处理程序**中（请注意，在使用单页模板时，这不是一个好主意，您应该使用委托的页面事件**）。

只需像这样包装您的代码：

```
$(function () {
    ...

    $('#igetdetails').click(function () {

    ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:15:02.903

老问题，但现在最好的方法是

[http://api.jquery.com/on/](http://api.jquery.com/on/)

```
$(document).on('click', '#igetdetails', function(event) {
    alert('hello')
});​ 
```

这将为文档绑定事件并侦听将来要绑定的匹配选择器。